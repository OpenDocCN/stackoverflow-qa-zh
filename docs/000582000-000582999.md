# StackOverflow 问答 000582000-000582999

# asp.net - 将数据源中的信息转换为链接

> ID：582002
> 
> 赞同：0
> 
> 时间：2009-02-24T14:45:45.463
> 
> 标签：asp.net, database, oracle, web-applications, hyperlink

我有一个 Web 应用程序，我在其中从 gridview 中的 oracle 数据库获取数据。

谁能告诉我如何将这些数据转换为我的 Web 应用程序上其他页面的链接？

例如，如果我正在获取有关具有自己 ID 的对象列表的数据，我希望能够单击 ID 并转到仅包含该对象信息的页面

这是我的 gridview 的所有代码，在 SystemGrid_Sorting 中，我从数据库中获取所有信息，因此我实际上无法定义列的属性。

提前致谢

asp:GridView ID="SystemGrid" runat="server" AllowSorting="True" Width="232px" OnSorting="SystemGrid_Sorting" >

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-24T14:52:11.127

本质上，给定 ID 1234，您需要将其转换为 HTML 链接，例如：

```
<a href="mydomain/myapp/mypage?id=1234">1234</a> 
```

不知道你的gridview工具有没有内置的方法为你构建这样的链接？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-24T14:54:07.970

这很容易：

```
<asp:HyperLinkField DataNavigateUrlFields="ID"
 DataNavigateUrlFormatString="DetailPage.aspx?id={0}"
                    DataTextField="CategoryName" NavigateUrl="DetailPage.aspx" /> 
```

现在只需设置 DetailPage.aspx 以使用查询字符串中的 ID 调用数据库并显示您喜欢的任何内容。

# git - 用于进行修改的 git 工作流，你永远不会推回原点

> ID：582015
> 
> 赞同：6
> 
> 时间：2009-02-24T14:48:04.023
> 
> 标签：git, vendor-branch

Git新手在这里。

我正在使用[PhoneGap](http://phonegap.com/)构建一个 iPhone 应用程序，它有一个 Git 存储库。我想在我自己的 Git 存储库中跟踪我对 PhoneGap 代码的更改（主要是将文件添加到 www 目录），同时能够从 PhoneGap 中提取最新和最好的。

这样做的最佳方法是什么？这是一个分支的目的吗？

另外，我如何让它忽略我删除了我不需要的文件夹的事实，比如 android/ 和 blackberry/ 文件夹？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-24T14:51:35.030

这正是分支的用途。您应该在您的分支上工作，并从主分支中提取更改，可能使用`--rebase`.

# c# - Eventhandler override?

> ID：582027
> 
> 赞同：1
> 
> 时间：2009-02-24T14:50:38.120
> 
> 标签：c#, .net, winforms

I'm trying to come up with a way to easilly detect if a change has been made to a control on a winform. This approach works but it provides no information about what controls have been changed. Is there a way to override the TextChanged event so it will pass and EventArg which contains the name of the control that fired the event? When AccountChangedHandler executed the sender paramter contains information about the textbox such as the current value of the '.Text' property but I don't see anything about which control raised the event.

```
private bool _dataChanged = false;

internal TestUserControl()
{
  InitializeComponent();

  txtBillAddress1.TextChanged += new System.EventHandler(AccountChangedHandler);
  txtBillAddress2.TextChanged += new System.EventHandler(AccountChangedHandler);
  txtBillZip.TextChanged += new System.EventHandler(AccountChangedHandler);
  txtBillState.TextChanged += new System.EventHandler(AccountChangedHandler);
  txtBillCity.TextChanged += new System.EventHandler(AccountChangedHandler);
  txtCountry.TextChanged += new System.EventHandler(AccountChangedHandler);

  txtContactName.TextChanged += new System.EventHandler(AccountChangedHandler);
  txtContactValue1.TextChanged += new System.EventHandler(AccountChangedHandler);
  txtContactValue2.TextChanged += new System.EventHandler(AccountChangedHandler);
  txtContactValue3.TextChanged += new System.EventHandler(AccountChangedHandler);
  txtContactValue4.TextChanged += new System.EventHandler(AccountChangedHandler);

}

private void AccountChangedHandler(object sender, EventArgs e)
{
  _dataChanged = true;
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-24T14:54:46.300

```
void AccountChangedHandler(object sender, EventArgs e)
{
   string n = ((TextBox)sender).Name;
   string t = ((TextBox)sender).Text;
   // or instead of cast
   TextBox tb = sender as TextBox; // if sender is another type, tb is null
   if(tb != null)
   {
     string n = tb.Name;
     string t = tb.Text;
   }
} 
```

您也可以尝试使用

```
foreach (Control c in this.Controls)
{
 c.TextChanged += new EventHandler(AccountChangedHandler);
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-24T14:56:47.403

sender 参数呢？

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-24T14:57:16.590

sender 是对引发事件的控件的引用。如果你这样做

```
TextBox tb = sender as TextBox;
string name = tb.Name; 
```

您会看到，现在您可以像使用“txtContractName”一样使用“tb”。如果你想做特定的逻辑，你可以做类似的事情

```
if(tb == txtBillAddress1) { ... } 
```

但是，此时您最好使用单独的事件处理程序。

# regex - 正则表达式教程，我该如何改进

> ID：582033
> 
> 赞同：1
> 
> 时间：2009-02-24T14:51:39.677
> 
> 标签：regex

今天早些时候我需要一个实用函数来从文件中删除一些数据，并编写了一个令人震惊的正则表达式来做到这一点。输入是一个包含很多行的文件，格式如下：

```
<address> <11 * ascii character value>      <11 characters>
00C4F244  75 6C 74 73 3E 3C 43 75 72 72 65  ults><Curre 
```

我想去掉最后 11 个字符之外的所有内容，并使用以下表达式：

```
"^[0-9A-F+]{8}[\\s]{2}[0-9A-F\\s]{34}" 
```

这与我不想要的位相匹配，然后我从原始字符串中删除了这些位。我想看看你会如何做到这一点，但我无法工作的特定领域是：

1：让正则表达式引擎返回我想要的字符而不是我没有的字符

2：找到一种在单个 ascii 值后跟空格重复匹配的方法（例如“75”= [0-9A-F]{2}[\s]{1}？）并重复 11 次而不是抓取 34 个字符。

再看一遍，最简单的方法是匹配每个输入行的最后 11 个字符，但这不是很灵活，为了学习正则表达式，我想看看如何从一开始就匹配序列。

编辑：谢谢大家，这就是我想要的：

```
"(?:^[0-9A-F]{8}  )(?:[0-9A-F]{2} ){11} (.*)" 
```

希望我能把你们中的不止一个变成绿色。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-24T14:56:13.240

由于文件具有固定格式，您可以使用此正则表达式来匹配最后 11 个字符。

```
^.{44}(.{11}) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-24T14:58:50.473

最后十一是：

```
...........$ 
```

或者：

```
.{11}$ 
```

匹配一个十六进制字节+空格并重复十一次：

```
([0-9A-Fa-f]{2} ){11} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-24T14:57:52.660

1) ^[0-9A-F+]{8}[\s]{2}[0-9A-F\s]{34}(.*)

Parens 用于通过提取进行分组。您如何检索它取决于您的语言上下文，但现在某种 $1 设置为初始模式之后的所有内容。

2) ^[0-9A-F+]{8}[\s]{2}(?:[0-9A-F\s]){11}\s(.*)

(?:) 是分组而不提取。因此 (?:[0-9A-F\s]){11} 将那里的子模式视为一个单元并查找它重复 11 次。

顺便说一下，我在这里假设 PCRE。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-24T14:57:03.503

地址和 ascii char 值都是十六进制的，所以：

^[0-9A-F\s]{42}

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-24T15:09:22.163

匹配行尾将是

```
.{11}$ 
```

为了只匹配结尾，您可以使用正面的外观。

```
"(?<=(^[0-9A-F+]{8}[\\s]{2}[0-9A-F\\s]{34}))(.*?)$" 
```

这将匹配任何字符直到行尾，前提是它前面有“look behind”表达式。

(?<=....) 定义了匹配之前必须满足的条件。

我的时间有点短，但是如果您在网上查找任何包含“regex”和“lookbehind”字样的教程，您会发现好东西（如果 regex 教程涵盖向前/向后看，通常会是相当完整和先进）。

另一个建议是获取一个正则表达式训练工具并使用它。看看这个优秀的正则[表达式设计师](http://www.radsoftware.com.au/regexdesigner/)。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-24T17:05:04.677

如果你使用`Perl`, 你也可以使用[`unpack()`](http://perldoc.perl.org/functions/unpack.html), 来获取每个元素。

```
my @data;

open my $fh, '<', $filename or die;
for my $line(<$fh>){
  my($address,@list) = unpack 'a8xx(a2x)11xa11', $line;
  my $str = pop @list;

  # unpack the hexadecimal bytes
  my $data = join '', map { pack 'H2',$_ } @list;

  die unless $data eq $str;

  push @data, [$address,$data,$str];
}
close $fh; 
```

我还继续将 11 个十六进制代码转换回字符串，使用[`pack()`](http://perldoc.perl.org/functions/pack.html).

# .net - Are there any .net equivalents to Rails fixtures?

> ID：582034
> 
> 赞同：3
> 
> 时间：2009-02-24T14:52:11.050
> 
> 标签：.net, unit-testing, yaml, fixture

I'm looking for a project/tool that will insert data into a database before a test and roll it back after a test has run.

I know that ruby on rails has yaml fixtures, so I was hoping there is a project out there for .net projects.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2011-10-27T00:40:44.723

有几种很好的方法可以为 .NET 中的测试提供数据。一种是使用 NUnit 内置的功能，例如参数化测试和理论。

# 参数化测试：

[TestCaseAttribute](http://www.nunit.org/index.php?p=testCase&r=2.5.8)允许您轻松地将硬编码数据提供给测试，如下面的 nunit.org 示例所示：

```
[TestCase(12,3, Result=4)]
[TestCase(12,2, Result=6)]
[TestCase(12,4, Result=3)]
public int DivideTest(int n, int d)
{
  return( n / d );
} 
```

[TestCaseDataAttribute](http://www.nunit.org/index.php?p=testCaseSource&r=2.5.8)让您在提供数据（例如从数据库中返回数据）方面更加花哨。

# 回滚事务

另一个经常使用的技巧是依赖交易。基本上，在测试之前启动一个事务，然后回滚。这甚至可以使用基类自动化，因此您的测试根本不处理事务本身。例如，您可能有一个用于测试夹具的基类，如下所示：

```
public class TestBase
{
    private TransactionScope _transacation;

    [SetUp]
    public virtual void InitializeTest()
    {
        //NOTE: Base class TestInitialize methods are called before test Initialize methods in derived class.

        // Setup a DB transcation to roll everything back after the tests.
        if (_transacation != null)
            throw new Exception("old transacation still exists");
        // Give a long timeout on this transacation for debugging...
        _transacation = new TransactionScope(TransactionScopeOption.RequiresNew, TimeSpan.FromSeconds(60));   
    }

    [TearDown]
    public virtual void CleanupTest()
    {

        // Roll all the changes made during the test back.
        _transacation.Dispose();
        _transacation = null;
    }
} 
```

由于基类上的 TestInitialize修饰方法在派生类中的 TestInitialize 方法*之前*被调用，因此您甚至可以在父类的 TestInitialize 方法中将一些数据添加到数据库中。

父类可能如下所示：

```
[TestFixture]
public class MyClassTests : TestBase
{
    [TestFixtureSetUp]
    public void InitializeUnit()
    {
            //Setup mocks...
    }

    [SetUp]
    public override void InitializeTest()
    {   
            base.InitializeTest();
            // Add test data to database
    }

    [Test]
    public void RealTest()
    {
            ...
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-24T14:59:05.573

我使用 Sql Server Compact Edition 并每次都重新生成一个新的数据库副本（只需复制一个初始数据库就可以了），如果在只读模式下使用，多个测试可以共享同一个数据库文件。

有一些陷阱，不支持可编程性，但它适用于我需要它的基础知识。它的速度也出奇的快。

# iphone - 在iphone上按完成时如何禁用输入板？

> ID：582038
> 
> 赞同：1
> 
> 时间：2009-02-24T14:52:56.680
> 
> 标签：iphone, user-input

按“完成”时，我想禁用 iphone 上的输入板。关于如何检测按钮按下事件的任何想法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-24T15:06:38.237

**程序化方法**

要注册按钮按下事件，您可以使用编程方法：

```
[button addTarget:self action:@selector(buttonPressed:) forControlEvents: UIControlEventTouchUpInside] 
```

其中 buttonPressed: 是“self”类中的一个方法：

```
-(void)buttonPressed:(id)sender; 
```

当然，您可以指定指向任何对象的指针而不是“self”，只要该对象具有 buttonPressed: 方法即可。

**界面生成器**

您还可以使用界面生成器。创建一个要执行的方法：

```
-(IBAction)buttonPressed:(id)sender; 
```

然后右键单击界面生成器中的按钮。您应该会看到一个操作列表。在“修饰”操作上，单击圆形按钮，然后将连接器拖到代表您放置 buttonPressed: 方法的类的对象上。

**禁用输入板**

我不确定你的意思。您是在谈论关闭键盘输入吗？如果是这样，您必须调用“resignFirstResponder:”方法。例如，因为您正在编辑文本字段而弹出键盘。要关闭键盘，请在文本字段上调用以下方法：

```
[textField resignFirstResponder]; 
```

# notifications - 如何让用户关注问题？

> ID：582040
> 
> 赞同：9
> 
> 时间：2009-02-24T14:53:39.797
> 
> 标签：notifications, warnings, usability

我们有时需要通知用户有关警告或问题的信息。但很多时候，特别是如果这是一个常见问题，用户只会忽略警告并继续。很多时候用户甚至不会记得看到警告，但我们检查他们的日志并看到显示了几个。那么，当你试图告诉他们一些重要的事情时，你如何让用户注意呢？

这不像强迫用户在允许他们保存之前解决所有问题那么简单。由于各种原因（通常是因为无法立即解决或根本无法解决的问题），他们经常需要保存我们的业务规则并不严格允许的数据。

我们有一个更好的警告/错误处理系统，我认为这将有很大帮助，但我想看看其他人做了什么。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-02-24T15:08:50.307

如果您希望用户注意警告，请适度使用它们！

Vista 中 UAC 的最大问题是人们收到太多通知，他们不再阅读到底是*谁*在请求访问*什么*，他们只是不假思索地给予许可。

另一个例子是将文件发送到回收站时资源管理器中的删除确认。我已经习惯了在按下“删除”后立即点击“确定”，以至于我错过了对话框告诉我文件不会被移动到垃圾箱，而是立即删除的事实，无论出于何种原因。

我的个人修复：我禁用了回收站的删除确认。如果有些东西不能移到垃圾箱，我仍然会收到一条消息，这一次我知道它可能很重要，所以我注意了。

**结论：**不要向用户发送垃圾邮件，否则重要的警告会在噪音中消失。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-02-24T14:59:09.287

您的警告质量不会阻止用户提交无效数据。如果您允许提交无效数据，它将是。

如果您有必须提交给规则系统的数据，那么该数据在提交之前*必须*是有效的。但是，允许用户保存他们的工作是一个单独的问题。您应该允许用户保存他们的工作，然后在数据有效时将数据提交给规则引擎。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-02-24T15:21:39.403

根本问题是用户不喜欢阅读，他们只想一个人呆着做他们的工作:)。

解决这个问题的最佳方法如下：

*   除非绝对必要，否则不要弹出窗口
*   如果这样做，请使错误或警告消息尽可能简短和简洁

长的错误/警告消息根本不会被阅读。用户将到达大约第五个单词并认为“这花费了太多时间，我只想回去工作”。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-02-24T16:06:23.507

我的建议归结为三件事。

1.  重新评估您认为对用户了解的重要内容。
2.  不要偷懒，并要求用户解决您的程序可以自行解决的问题。
3.  不要用愚蠢的（是的，他们很愚蠢）消息打断用户正在做的事情。

如果您有一个包含所需数据的表单，则将该字段颜色编码为红色或用星号突出显示它以指示它是必需的。禁用“确定”或“确认”按钮，直到他们填写所有必填字段。

对于数据不完整或不一致的字段，请显示工具提示或对字段进行颜色编码，以便用户知道可能有问题。您还可以在表单的某处显眼地显示警告列表。但不要停止数据输入。你只会让你的用户感到沮丧和愤怒。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-02-24T15:01:20.467

我必须承认，我经常点击“确定”或任何我习惯于做的事情，让对话不假思索地消失。通常当它们太多时会发生这种情况。

不自称是任何类型的心理学家，我认为关注不寻常的事情并过滤掉重复的事情是很自然的。
考虑到这一点，也许值得考虑减少不太重要的对话，让真正重要的对话得到更多关注。

我认为烤面包机消息和谷歌在其在线应用程序中处理消息的方式是如何通知用户无关紧要的事情的真正好例子。

**--编辑--**
现在我重新阅读了我的帖子，我记得在“不要让我思考”中读过这篇文章。一本很棒的小书（几十页），里面充满了很好的和易于理解的可用性的东西。有点侧重于在线可用性，但也适用于离线应用程序。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-02-24T16:33:25.237

这是我们已经计划好的。本质上，创建一些类似于 Bugzilla 的东西来存储这些错误/警告/任何东西。但它也与其他一些答案齐头并进。

不要使用简单的 MessageBox，而是在类似 Visual Studio 的错误窗口中显示警告/错误。只要有问题，就会显示在这个窗口中。

如果数据已保存，请将所有警告/错误保存到数据库中。现在任何人都可以看到当前的问题是什么 - 奖金！此外，这些问题可以从数据库中加载，而不是一直在应用程序中检测它们，这将有很大帮助——有些问题检测起来并不容易。

允许用户执行多项操作，例如：

*   确认问题，因此不再显示。
*   将问题分配给其他用户
*   将问题标记为“不是真正的问题”
*   设置“必须解决”日期
*   （可能是其他人，设计还没有完全考虑好）

将所有这些操作记录到数据库中，以便我们负责

简而言之就是这样。现在问题一直存在，所以它们一直存在于用户面前，直到它们得到解决。问题可以被跟踪，所以如果我们被咬了，我们就可以知道球掉在了哪里。我希望它有效！

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-02-24T15:14:19.623

虽然我从来没有在以前的站点上实现这一点，但我想创建一个自定义对话框，用户必须在其中选中一个框，说明他们已阅读并确认消息（然后记录该响应）。这是针对一家 ISO-xxxx 公司的，因此这种官僚作风是对此类错误的合乎逻辑的反应。

我的另一个更险恶的想法是让“否”或“取消”成为默认选项。最终，他们将按下 Tab-Enter 键击，然后您只需将其切换回来。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-02-24T16:05:13.307

破坏系统！

老实说，我的经验是，如果您不希望最终用户在没有明确理解的情况下做某事，请阻止他们这样做......

就像整个“Windows 错误/警告消息”一样令人讨厌，直到程序告诉我我不能做某事，我才注意到......然后我不得不问自己“为什么不”

是时候用谷歌搜索答案了……或 RTFM

我知道使用这种方法并不总是可行的，但如果可以的话……他们会听的！

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-02-24T16:08:17.700

我喜欢那些暗示存在问题的程序，同时尽可能长时间地忽略它——这听起来很像你正在努力争取的东西。我一直在考虑的一件事（但含糊不清，因为我没有使用它）是为错误/警告设置一个状态指示器（有点像网络浏览器无所不在的抖动，但用于错误）。这个图标会改变状态，有点像红绿灯，表明程序有问题迟早必须解决——如果数据问题可以稍后更正并且不会解决，则可能是黄色的警告导致任何重大问题，红色表示在完成当前工作之前必须解决的任何问题（对于表单数据，这意味着整个事务，而不是当前表单）。明显颜色不够用 必须有一些对色盲的人的支持，但你明白了。单击指示器将显示问题列表（可能还有关于*为什么*这是一个问题——这样人们可以指出代码的假设什么时候是无用的或错误的），并且选择一个问题可以让你跳到可以修复它的领域。

无论您最终采用哪种方法，您可能应该做的一件事是查看您的警告并确定它们是否真的有必要。我见过太多的程序警告我完全合理的输入然后被接受，或者警告我程序的通常行为。这就是帮助人们点击警告的那种东西。如果您有警告日志，您可能会从那里开始 - 为什么人们会点击它们？他们可能是有条件的，或者可能真的没有问题，并且没有人告诉你事情已经改变了。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-02-24T15:00:01.250

我非常喜欢安装插件时的 firefox 方法：ok 按钮被禁用并显示倒计时 5 秒。之后用户可以选择忽略它。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-02-24T15:00:12.887

对于 Web 应用程序，alert() 和 confirm() javascript 方法虽然有些基本，但可以达到阻止用户做某事或确保他们清楚地同意他们被警告过的某事的效果。

对于其他情况，如果该操作不会对业务流程造成相当大的干扰，我们通常会在提交表单后在页面顶部显示一个小警告框。

例如，我们的应用程序需要在多个地方（有效的城市/州/邮编）进行位置验证。

*   如果该位置是绝对关键的，我们将在表格上注明。

*   如果应用程序的某些方面需要位置，我们将使用 confirm() 来确保他们明白如果没有有效的位置，他们将无法使用某些功能。

*   在某些情况下，我们使用默认位置。在这种情况下，我们会在下一页顶部提供消息/警告框，指示正在使用默认位置。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-02-24T15:32:47.443

我发现如果您生成日志消息供自己使用（即使这种使用直接使用户自己受益），让用户报告问题的唯一方法是让应用程序为他们做这件事。

在处理可能错误的用户输入时，您是否考虑过使用诸如拼写检查使用的红色波浪线之类的东西，或者在用户工作时对问题区域进行某种突出显示？大多数用户都接受过使用有缺陷的软件来忽略对话框的培训，但这种消息可能会清楚地表明错误是用户需要修复的。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-02-24T15:41:29.217

您知道为什么会出现每种异常情况吗？您尝试通过以下每条消息实现什么目标：

*   让用户检查数据是否有明显的错别字或错误

*   当有更多信息可用时，让其他人在稍后阶段查看数据

*   通知该用户和任何其他在稍后阶段查看数据的人所做的任何假设

*   确保用户了解其行为的后果

能否以不同的方式更有效地实现这些目标？

一些想法（没有一个会自动成为灵丹妙药）：

*   保持消息简短和相关，排除任何不提供额外信息的语言（例如“请”等），告诉用户对他们的期望（即，而不是“邮政编码为空”使用“输入邮政编码”。）。

*   使用用户可以理解的语言，始终提供足够的信息，尽可能具体。

*   针对不同类型的警告和错误使用不同外观的消息（使用字体、颜色、图像，可能还有动画和声音）。

*   重新审视整个过程，以便稍后有人必须处理提交的任何带有警告的信息。

*   下次信息显示在屏幕上时可视化警告（即突出显示有问题的区域），以便稍后在有更多信息可用时解决它们。

*   为警告添加一个标志，例如，每次需要解除警告时要求用户输入密码。

*   使操作可撤消，因此您实际上不需要警告

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2009-02-26T15:41:04.083

不要试图用编程来解决。看看是否可以更改数据输入过程。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2009-07-29T01:46:08.833

使用颜色和图标。

绿色 - 一切正常（或确认发生了预期的事情）

黄色 - 警告。您的用户可能想也可能不想调查这个问题

红色 - 错误。需要用户交互才能解决的问题。

我还建议（正如其他人在此线程上所做的那样）谨慎使用。

# apache - 服务器日志上来自同一 IP 的多个请求

> ID：582041
> 
> 赞同：0
> 
> 时间：2009-02-24T14:53:44.900
> 
> 标签：apache, logging

我实现了一个客户端接口，它使用 JS 在 http GET 中对服务器进行服务调用。在检查我的访问日志时，我发现有时我会在一秒钟内收到多个请求，有时多达 6 个——发出相同的请求——来自同一个 ip——你认为这说明了什么？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-24T14:59:10.847

它可能表明他们在代理背后。（你看到的IP其实就是proxy的IP）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-24T15:00:45.723

它可能是一台路由器后面的 6 台不同的计算机，它们都在访问您的页面。或一台计算机的一个浏览器上的 6 个选项卡。还是您的 JavaScript 中的错误？

# python - 在python函数中获取参数名称列表

> ID：582056
> 
> 赞同：340
> 
> 时间：2009-02-24T14:56:42.973
> 
> 标签：python, parameters

> **可能重复：**
> [在 python 中获取方法参数名称](https://stackoverflow.com/questions/218616/getting-method-parameter-names-in-python)

有没有一种简单的方法可以进入 python 函数并获取参数名称列表？

例如：

```
def func(a,b,c):
    print magic_that_does_what_I_want()

>>> func()
['a','b','c'] 
```

谢谢

* * *

## 回答 #1

> 赞同：422
> 
> 时间：2010-10-29T11:40:54.973

好吧，我们实际上并不需要`inspect`这里。

```
>>> func = lambda x, y: (x, y)
>>> 
>>> func.__code__.co_argcount
2
>>> func.__code__.co_varnames
('x', 'y')
>>>
>>> def func2(x,y=3):
...  print(func2.__code__.co_varnames)
...  pass # Other things
... 
>>> func2(3,3)
('x', 'y')
>>> 
>>> func2.__defaults__
(3,) 
```

对于 Python 2.5 及更早版本，请使用`func_code`代替`__code__`和`func_defaults`代替`__defaults__`.

* * *

## 回答 #2

> 赞同：258
> 
> 时间：2009-02-24T15:03:39.087

[`locals()`](https://docs.python.org/library/functions.html#locals)返回具有本地名称的字典：

```
def func(a,b,c):
    print(locals().keys()) 
```

打印参数列表。如果您使用其他局部变量，这些变量将包含在此列表中。但是您可以在函数开始时制作副本。

* * *

## 回答 #3

> 赞同：184
> 
> 时间：2009-02-24T15:34:04.897

如果您还想要这些值，您可以使用该`inspect`模块

```
import inspect

def func(a, b, c):
    frame = inspect.currentframe()
    args, _, _, values = inspect.getargvalues(frame)
    print 'function name "%s"' % inspect.getframeinfo(frame)[2]
    for i in args:
        print "    %s = %s" % (i, values[i])
    return [(i, values[i]) for i in args]

>>> func(1, 2, 3)
function name "func"
    a = 1
    b = 2
    c = 3
[('a', 1), ('b', 2), ('c', 3)] 
```

* * *

## 回答 #4

> 赞同：132
> 
> 时间：2009-02-24T15:31:04.153

```
import inspect

def func(a,b,c=5):
    pass

inspect.getargspec(func)  # inspect.signature(func) in Python 3

(['a', 'b', 'c'], None, None, (5,)) 
```

# jquery - 使用 jQuery 将无序列表转换为表格

> ID：582082
> 
> 赞同：3
> 
> 时间：2009-02-24T14:59:51.077
> 
> 标签：jquery, html-lists, css-tables

我喜欢得到一个`<ul><li>`并使它成为一个漂亮的表格，我将使用 CSS 设置样式。

我喜欢用 jQuery 进行的转换

```
* Place|Name|Earning
* 1|Paul|200$
* 2|Joe|400$
* 3|James|100$
* 4|Carl|1000$ 
```

不断地......

并用表格单元格的第一行`<ul>`和其他表格单元格制作一个表格头......

页面上可能会有 4-5`<ul>`秒。

为了给蛋糕锦上添花，让我们从最大的收入者到最小的收入者排序！

* * *

我发现了这个问题：

> [如何使用 JQuery 将 HTML 表格转换为列表？](https://stackoverflow.com/questions/577669/how-to-transform-html-table-to-list-with-jquery)

恰恰相反……但也许是一个好的开始？我不知道，我会检查一下......但仍然让问题悬而未决。

* * *

我发现了这个问题：

> [如何使用 JQuery 将 HTML 表格转换为列表？](https://stackoverflow.com/questions/577669/how-to-transform-html-table-to-list-with-jquery)

恰恰相反……但也许是一个好的开始？我不知道，我会检查一下......但仍然让问题悬而未决。

* * *

与解决方案有关的另一个问题...

如果我想“删除”并用表格替换它..

我不喜欢做一张空桌子..

这是代码......也许没有“优化”但它有效

```
$('#texte').append('<div id="where_my_table_goes"></div>');
$('#where_my_table_goes').append(table);
$('#my_oddly_formatted_list').remove(); 
```

有什么更好的吗？

* * *

不不不，因为问题/答案变得和插件很棒......但不再起作用......

这是错误......我喜欢在点击事件切换时调用插件（tablerize）并用表格替换整个UL......它不这样做

这是一小段代码：

```
<script type="text/javascript">
    $(document).ready(function() {

        $('#texte > h1').next().hide(500);  
        $('#texte > h1').click(function() {
        $(this > ul).tablerize();
        $(this).toggle(500);
        });
    });
</script> 
```

毫不奇怪，它不起作用..我肯定会搞砸一些东西...而且我没有运气就修改了插件！...

我真的很喜欢保留该代码：

```
$("texte").append('<div id="where_my_table_goes"></div>');
$(#where_my_table_goes"></div>').append(table);
$('#my_oddly_formatted_list').remove(); 
```

可以变成：

```
remove the ul
append the div to (this)
put the table into that div 
```

我什至需要一个 div 吗？

帮助！

* * *

它不起作用；这是完整的页面，也许它会帮助你看看它应该做什么

[http://www.acecrodeo.com/new/04-classement.php](http://www.acecrodeo.com/new/04-classement.php)

我使用延迟隐藏只是为了看到数据在那里......

按下标题后.. tablerize 应该发生，删除旧的 ul 并用表格替换它，然后滑动切换它

* * *

好的..现在有状态...

我只知道编辑答案并发布它......任何地方都没有更新按钮......

我喜欢给你一个大拇指或任何可以帮助你评分的东西......我只是不知道如何

对于这个问题......我已经准确地发布了你给我的东西......它不起作用......让我们看看链接：[http ://www.acecrodeo.com/new/04-classement.php](http://www.acecrodeo.com/new/04-classement.php)

这是错误：它切换标题...

我迷路了！

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-02-24T15:16:22.363

如果您的 HTML 如下所示，您就是这样做的：

```
<ul id='my_oddly_formatted_list1' class='odd_list'>
    <li>Column A|Column B|Column C</li>
    <li>Value A1|Value B1|Value C1</li>
    <li>Value A2|Value B1|Value C2</li>
    <li>Value A3|Value B1|Value C3</li>
    <li>Value A4|Value B1|Value C4</li>
</ul>
<ul id='my_oddly_formatted_list2' class='odd_list'>
    <li>Column D|Column E|Column F</li>
    <li>Value D1|Value E1|Value F1</li>
    <li>Value D2|Value E1|Value F2</li>
    <li>Value D3|Value E1|Value F3</li>
    <li>Value D4|Value E1|Value F4</li>
</ul>
<ul id='my_oddly_formatted_list3' class='odd_list'>
    <li>Column G|Column H|Column I</li>
    <li>Value G1|Value H1|Value I1</li>
    <li>Value G2|Value H1|Value I2</li>
    <li>Value G3|Value H1|Value I3</li>
    <li>Value G4|Value H1|Value I4</li>
</ul> 
```

然后用 jQuery 你可以写一个这样的插件：

```
jQuery.fn.tablerize = function() {
        return this.each(function() {
                var table = $('<table>');
                var tbody = $('<tbody>');
                $(this).find('li').each(function(i) {
                        var values = $(this).html().split('*');
                        if(i == 0) {
                                var thead = $('<thead>');
                                var tr = $('<tr>');
                                $.each(values, function(y) {
                                        tr.append($('<th>').html(values[y]));
                                });
                                table.append(thead.append(tr));
                        } else {
                           var tr = $('<tr>');
                           $.each(values, function(y) {
                                   tr.append($('<td>').html(values[y]));
                           });
                           tbody.append(tr);
                        }
                });
                $(this).after(table.append(tbody)).remove();
        });
}; 
```

然后您可以调用以下任何一种方式：

```
// tablerize all UL elements in the page
$('ul').tablerize();

// only UL elements with class 'odd_list'
$('ul.odd_list').tablerize();

// individually tablerize all the lists
$('#my_oddly_formatted_list1').tablerize();
$('#my_oddly_formatted_list2').tablerize();
$('#my_oddly_formatted_list3').tablerize(); 
```

至于排序等，有许多[插件](http://plugins.jquery.com/project/Plugins/category/54)可用于为表格提供此功能。

## ** 编辑 **

您的代码的问题在于以下几行：

```
$(document).ready(function() {
    /*$('#texte > h1').next().hide(1000); */ 
    $('#texte > h1').click(function() {
        $(this).tablerize();
        /*$(this).next().toggle(500);*/
    });
}); 
```

`tablerize`我写的插件需要一个`<ul>`元素来表格化。当你传递它时，`this`你传递的`h1`是匹配的，而不是`<ul>`. 如果您替换此行：

```
$(this).tablerize(); 
```

使用这一行，它将在标题之后立即找到 UL 元素：

```
$(this).next('ul').tablerize(); 
```

它应该按您的意愿工作。

还：

*   要更新您的问题，您只需单击“编辑”并添加您想要的任何内容。
*   要接受答案，请单击此文本左侧的复选标记。

# .net - 在 .NET 中，如果 catch 块中发生故障，最终总是会被调用怎么办？

> ID：582095
> 
> 赞同：16
> 
> 时间：2009-02-24T15:03:28.993
> 
> 标签：.net, exception-handling

在 try/catch/finally 块中，例如：

```
try
{

}
catch()
{
   // code fails here
}
finally
{ 

} 
```

那么如果catch块中有异常，最终总是会被调用吗？

如果没有 finally，catch 块之后的代码会运行吗？

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2009-02-24T15:06:12.687

假设进程不会突然终止（当然也不会挂起），finally 块将始终被执行。

如果没有 finally 块，catch 块中的异常将被抛出堆栈。请注意，最初导致 catch 块执行的原始异常将被有效地丢失。

**堆栈溢出异常**

正如 Jared 所指出的，堆栈溢出将导致 finally 块不被执行。我相信这会突然终止程序，但我可能是错的。这是示例代码：

```
using System;

public class Test
{    
    static void Main()
    {
        // Give the stack something to munch on
        int x = 10;
        try
        {
            Main();
            Console.WriteLine(x);
        }
        finally
        {
            Console.WriteLine("Finally");
        }
    }  
} 
```

结果：

> 进程因 StackOverflowException 而终止。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-02-24T15:06:35.353

finally 块将始终被执行。如果您排除 finally 块，并且在 catch 块内发生异常，则在 catch 块之后不会执行任何代码，因为本质上您的 catch 块将失败并自身生成未处理的异常。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-02-24T15:06:56.630

是的，finally 将永远运行

不，catch 块之后的代码将不会运行。

即使使用 finally 块，finally 块之后的任何代码都不会运行。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-02-24T15:07:03.290

如果 catch 块中有异常，finally 会执行，但是会抛出一个新的异常。发生异常的 catch 块不会捕获异常，它会继续向上堆栈。

经验教训：如果你能帮助它，不要在 catch 块中做可以抛出的东西；如果必须，请嵌套一个 try/catch 块。

```
try
{

}
catch()
{
  try
  {
    // code fails here
  }
  catch
  {
    // handle that. Or not. 
  }
}
finally
{ 

} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-24T15:16:50.040

finally 块将始终被执行。来自[MSDN](http://msdn.microsoft.com/en-us/library/zwc8s4fz.aspx)：

> finally 块对于清理在 try 块中分配的任何资源以及运行任何必须执行的代码（即使存在异常）也很有用。不管 try 块如何退出，控制总是传递给 finally 块。
> 
> catch 用于处理语句块中发生的异常，而 finally 用于保证语句块的执行，而不管前面的 try 块如何退出。

顺便说一句，这是您可以通过编写一些代码、编译它并查看执行它时发生的情况来轻松测试自己的问题类型。

```
class Program {
    static void Main(string[] args) {
        try {
            Console.WriteLine("Trying!");
            throw new Exception();
        }
        catch (Exception e) {
            Console.WriteLine("Catching {0}!", e.Message);
            throw new Exception();
        }
        finally {
            Console.WriteLine("Finally!");
        }
    }
} 
```

这输出：

`Trying!`
`Catching Exception of type 'System.Exception' was thrown.!`

`Unhandled Exception: System.Exception: Exception of type 'System.Exception' was`
`thrown.`
`at TestFinally.Program.Main(String[] args) in C:\Documents and Settings\Me\My`
`Documents\Visual Studio 2008\Projects\TestFinally\TestFinally\Program.cs:line 15`
`Finally!`
`Press any key to continue . . .`

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-24T15:07:48.453

如果 catch 块中发生异常，finally 中的所有代码仍然会被执行。如果堆栈中有更高的异常处理程序（例如此函数的调用者），它将捕获此异常。否则会导致未处理的异常并关闭您的应用程序。

catch 块中异常点之后的代码不会被调用。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-01-29T18:13:32.377

只是想添加我知道的不允许 finally 和任何其他代码块执行的情况：

*   在运行时抛出 StackOverflowException 的情况下
*   System.Environment.FastFail
*   环境.退出
*   如果一个“后台”线程因为它所属的主程序正在结束而终止。
*   意外关机:)

# java - 接下来我应该学习什么 DI/IoC 框架？

> ID：582098
> 
> 赞同：2
> 
> 时间：2009-02-24T15:03:58.167
> 
> 标签：java, .net, dependency-injection, inversion-of-control

我已经使用过很多 Spring 和 Spring.NET，但我想看看还有什么。谁能推荐一个我可以尝试学习的好的 Java 或 .NET 框架？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-24T15:09:45.703

[这](http://www.hanselman.com/blog/ListOfNETDependencyInjectionContainersIOC.aspx)是来自优秀的 Hanselman 先生的 IoC 容器列表...

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-24T15:47:55.720

温莎城堡非常受欢迎，你可以做得比学习它更糟。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-02-24T15:09:49.307

在 .Net 方面，[Ninject](http://ninject.org/)可能是最有趣的，在 Java 方面，我想说看看 Google [Guice](http://code.google.com/p/google-guice/)。话虽如此，DI就是DI，它们或多或少都在做同样的事情。差异主要在于它们的配置方式。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-02-24T15:34:30.557

Google [Guice](http://code.google.com/p/google-guice/ "吉斯")非常好 - 除非你真的需要它，否则没有 .xml 配置文件 - 一切都是通过注释完成的，在理想的世界中，你可以避免 setter 方法，通过构造函数注入你的依赖项。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-25T00:18:31.233

我建议*JBoss Seam*。它具有与 Spring 非常不同的依赖注入模型。Seam 的 DI 是双向的，能够在对象生命的每个阶段（不仅仅是在初始化期间）注入值。

这当然不是对所有事情都有好处，但如果你想在 DI 中尝试不同的东西，这很有趣。

查看[Seam 的主页](http://www.seamframework.org/)。

* * *

## 回答 #6

> 赞同：-2
> 
> 时间：2009-10-11T19:35:52.333

因此，在广阔的软件世界中，您觉得需要了解什么是“假定管道”而不是扩大您的基础？您只需使用 IoC。对于任何认真的人来说，这甚至都不是可选的。这种情况现在已经持续了十年。

去掌握 F# 中的函数式编程。掌握 .NET 4.0 中的新 IObserver 和相关工作，作为与 IEnumerable 的概念配对。为您选择的领域编写特定领域的语言。创建新的抽象，不要简单地重新学习旧的。

# .net - .NET 程序集未从 NTVDM 加载

> ID：582099
> 
> 赞同：1
> 
> 时间：2009-02-24T15:04:45.560
> 
> 标签：.net, c++-cli, ntvdm

[我有一个 VDD dll，它由NTVDM](http://en.wikipedia.org/wiki/Virtual_DOS_machine)内运行的 DOS 程序加载。此 dll 使用 C++/CLI 并引用 .NET 程序集。

总而言之，加载过程是这样的：

```
 NTVDM runs:
    prntsr.com which uses VDD RegisterModule to load:
      prnvdd.dll which references .NET assembly:
         prnlib.dll 
```

和文件`prntsr.com`都在同一个文件夹中`prnvdd.dll`。`prnlib.dll`

但是，在加载它时，我得到以下异常：

```
Unhandled Exception: System.IO.FileNotFoundException: Could not load file or assembly 'PRNLib, Version=1.0.0.0, Culture=neutral, PublicKeyToken=ecf23cee305e91b7' or one of its dependencies. The system cannot find the file specified.
File name: 'PRNLib, Version=1.0.0.0, Culture=neutral, PublicKeyToken=ecf23cee305e91b7'
   at VDD_Initialise()

=== Pre-bind state information ===
LOG: User = DOMAIN\user
LOG: DisplayName = PRNLib, Version=1.0.0.0, Culture=neutral, PublicKeyToken=ecf2
3cee305e91b7
 (Fully-specified)
LOG: Appbase = file:///C:/WINDOWS/system32/
LOG: Initial PrivatePath = NULL
Calling assembly : (Unknown).
===
LOG: This bind starts in default load context.
LOG: No application configuration file found.
LOG: Using machine configuration file from C:\WINDOWS\Microsoft.NET\Framework\v2.0.50727\config\machine.config.
LOG: Post-policy reference: PRNLib, Version=1.0.0.0, Culture=neutral, PublicKeyToken=ecf23cee305e91b7
LOG: Attempting download of new URL file:///C:/WINDOWS/system32/PRNLib.DLL.
LOG: Attempting download of new URL file:///C:/WINDOWS/system32/PRNLib/PRNLib.DLL.
LOG: Attempting download of new URL file:///C:/WINDOWS/system32/PRNLib.EXE.
LOG: Attempting download of new URL file:///C:/WINDOWS/system32/PRNLib/PRNLib.EXE. 
```

它只搜索`C:\WINDOWS\system32\`程序集，我猜这是由于 NTVDM.EXE - 因为这是加载程序集的实际过程，它将其位置作为 AppBase。

任何想法如何更改 AppBase 或以其他方式解决此问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2011-01-07T05:46:29.657

尝试将 CLR 拉入 ntdvdm 的每个实例中确实不是一个好主意...

但是，如果您将程序集设为共享程序集，可能会更好，因为这些程序集存储在标准位置而不是相对于应用程序进行查找？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-01-07T05:57:43.910

您应该通过挂钩[AppDomain.AssemblyResolve](http://msdn.microsoft.com/en-us/library/system.appdomain.assemblyresolve.aspx)事件并自己进行解析来取得成功。

# c# - 如何将自定义枚举描述绑定到 DataGrid

> ID：582105
> 
> 赞同：2
> 
> 时间：2009-02-24T15:05:51.937
> 
> 标签：c#, asp.net, datagrid, enums

问题：我有一个枚举类型，它具有以下样式的描述标签： [URL="http://xml.indelv.com/data-binding-enum.html"]description tag tutorial[/URL] 。我有一个 Windows SQL Server 数据库，我从中提取数据（作为整数，然后转换为枚举），然后将其绑定到数据网格。我不想在枚举类型中拉出和封装枚举类型，而是在枚举类型中显示与其关联的描述标签。

这是 ASP -

```
<asp:GridView ID="StatementGrid" runat="server" AutoGenerateColumns="false" DataKeyNames="statementID" OnRowDeleting="StatementGrid_onDeleting" AllowSorting="False">
                <Columns>
                    <asp:BoundField HeaderText="Type" SortExpression="type" DataField="TypeOfStatement" />
                    <asp:HyperLinkField HeaderText="Statement" DataTextField="StatementText" DataNavigateUrlFormatString="~/Gateway/Statements/View.aspx?statementID={0}" SortExpression="statement" DataNavigateUrlFields="statementID" />
                    <asp:HyperLinkField DataNavigateUrlFields="statementID" DataNavigateUrlFormatString="~/Gateway/Statements/Update.aspx?statementID={0}" NavigateUrl="~/Gateway/Statements/Update.aspx" HeaderText="Edit" Text="<img src='../../Images/News/news_edit.gif' alt='Edit Statement'/>" />
                    <asp:TemplateField HeaderText="Delete">
                        <ItemTemplate>
                            <asp:ImageButton AlternateText="Delete Statement" ID="DeleteButton" ImageUrl="~/Images/News/news_delete.gif" runat="server" CommandName="Delete" OnClientClick="javascript:return confirm('Are you sure you want to delete this statement?');" />
                        </ItemTemplate>
                    </asp:TemplateField>
                </Columns>
                <EmptyDataTemplate>
                    There are no statements to display.
                </EmptyDataTemplate>
            </asp:GridView> 
```

这是绑定的代码 -

[代码]

```
private void BindData()
        {
            IStatementDao statementDao = DaoFactory.GetStatementDao();
            List<Statement> statements;

            if (Page.Request.RawUrl.Contains("Gateway"))
            {
                statements = statementDao.GetAll();

                StatementGrid.HeaderStyle.CssClass = "GatewayGridHeader";
                StatementGrid.AlternatingRowStyle.CssClass = "GatewayGridAlternatingRow";

            }
            else
            {
                // This should never be reached but it keeps the compiler happy!!
                statements = statementDao.GetAll();
            }

            StatementGrid.DataSource = statements;
            StatementGrid.DataBind();
            DisplayTypeDescriptors();
        } 
```

[/代码]

这是枚举类 -

[代码]

```
public enum TypeOfStatement 
        { 
            [EnumDescription("Dress Code")] DressCode = 1,
            [EnumDescription("Lunch Time")] LunchTime = 2,
            [EnumDescription("Footwarez")] Footware = 3,
            [EnumDescription("achtung")] Warning = 4,
            [EnumDescription("Banarna")] Banana = 5,
            [EnumDescription("Apfel")] Apple = 6
        };c# 
```

[/代码]

很明显，一个人可以编写一个广泛的方法来做我想做的事，但是有没有更简洁的方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-24T15:54:52.850

即时将它们包装起来并巧妙地更改您对 SelectedItem（或您正在使用的任何东西）的处理
我的示例使用已经存在的 Description 属性。

```
public class DescriptiveEnum<T> where T: struct
{
    private static readonly Dictionary<T,string> descriptions 
        = new Dictionary<T,string>();

    static DescriptiveEnum()
    {
        foreach (FieldInfo field in
            typeof(T).GetFields(BindingFlags.Static 
            | BindingFlags.GetField | BindingFlags.Public))
        {
        descriptions.Add((T)field.GetRawConstantValue(),
            LookupName(field));         
        }
    }

    public readonly T Value;

    public DescriptiveEnum(T value)
    {
        this.Value = value;     
    }

    public override string ToString()
    {
        string s;
        if (!descriptions.TryGetValue(this.Value, out s))
        {           
        // fall back for non declared fields
        s = this.Value.ToString();  
        descriptions[this.Value] = s;
        }
        return s;
    }

    private static string LookupName(FieldInfo field)        
    {
        object[] all = field.GetCustomAttributes(
             typeof(DescriptionAttribute), false);
        if (all.Length == 0)
            return field.Name; // fall back
        else
            return ((DescriptionAttribute)all[0])
                .Description; // only one needed
    }   

    public static BindingList<DescriptiveEnum<T>> Make(
        IEnumerable<T> source)
    {
        var list = new BindingList<DescriptiveEnum<T>>();
        foreach (var x in source)
        list.Add(new DescriptiveEnum<T>(x));
        return list;
    }
} 
```

示例用法：

```
public enum Foo
{
    [Description("flibble")]
    Bar,
    [Description("wobble")]
    Baz,
    // none present, will use the name
    Bat

}

Form f = new Form();
f.Controls.Add(new ListBox() 
{
    Dock = DockStyle.Fill,
    DataSource = DescriptiveEnum<Foo>.Make(
       new Foo[] { Foo.Bar, Foo.Baz, Foo.Bat }),
});
Application.Run(f); 
```

# delphi - PostMessage in service applications

> ID：582115
> 
> 赞同：1
> 
> 时间：2009-02-24T15:07:39.077
> 
> 标签：delphi, service, postmessage

There is a problem I am unable to solve. I created two service applications in Delphi and tried to post messages within them. Of course, there are no windows in such applications and PostMessage needs a window handle parameter to send a message.

Therefore, I created a window handle using the AllocateHWnd(MyMethod: TWndMethod) function and passed, as the 'MyMethod' parameter, a procedure I want to be called when a message is received. If it was a windowed application, PostMessage() called using the handle returned by the AllocateHWnd method would certainly send a message that would then be received by the 'MyMethod' procedure.

The situation, however, is different in my service applications. I do not understand why, but in one of them posting messages this way works fine, whereas in the second one it does not (the messages are not received at all). Only when the service is being stopped do I notice that two messages are received by 'MyMethod': WM_DESTROY and WM_NCDESTROY. The messages I send using PostMessage are never received by this procedure. On the other hand, the first service always receives all messages I send.

Could you please give me a clue that would help me find the reason of the second service not receiving my messages? I do not know in what way they can differ. I checked the settings of the services and they seem to be identical. Why then one of them works fine and the second one does not (as far as sending messages is concerned)?

Thanks for any advice. Mariusz.

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-24T15:14:41.510

Without more information it will be difficult to help you debug this, especially why it works in one service but not in the other. However:

Instead of trying to fix the problem in your code you might want to remove the windows altogether, and use [PostThreadMessage()](http://msdn.microsoft.com/en-us/library/ms644946(VS.85).aspx) instead of PostMessage(). For the posting of messages to work correctly you need a message loop, but not necessarily receiving windows.

**Edit:** I'm trying to reply to all your answers in one go.

First - if you want to make your life easy you should really check out [OmniThreadLibrary](http://otl.17slon.com/) by [gabr](https://stackoverflow.com/users/4997/gabr). I don't know whether it does work in a Windows service application, I don't even know whether that has been tried yet. You could ask in the forum. It has however a lot of great features and is worth looking into, if only for the learning effect.

But of course you can also program this for yourself, and you will have to for Delphi versions prior to Delphi 2007\. I will simply add some snippets from our internal library, which has evolved over the years and works in several dozen programs. I don't claim it to be bug-free though. You can compare it with your code, and if anything sticks out, feel free to ask and I'll try to clarify.

This is the simplified *Execute()* method of the worker thread base class:

```
procedure TCustomTestThread.Execute;
var
  Msg: TMsg;
begin
  try
    while not Terminated do begin
      if (integer(GetMessage(Msg, HWND(0), 0, 0)) = -1) or Terminated then
        break;
      TranslateMessage(Msg);
      DispatchMessage(Msg);

      if Msg.Message = WM_USER then begin
        // handle differently according to wParam and lParam
        // ...
      end;
    end;
  except
    on E: Exception do begin
      ...
    end;
  end;
end; 
```

It is important to not let exceptions get unhandled, so there is a top-level exception handler around everything. What you do with the exception is your choice and depends on the application, but all exceptions have to be caught, otherwise the application will get terminated. In a service your only option is probably to log them.

There is a special method to initiate thread shutdown, because the thread needs to be woken up when it is inside of *GetMessage()*:

```
procedure TCustomTestThread.Shutdown;
begin
  Terminate;
  Cancel; // internal method dealing with worker objects used in thread
  DoSendMessage(WM_QUIT);
end;

procedure TCustomTestThread.DoSendMessage(AMessage: Cardinal;
  AWParam: integer = 0; ALParam: integer = 0);
begin
  PostThreadMessage(ThreadID, AMessage, AWParam, ALParam);
end; 
```

Posting *WM_QUIT* will cause the message loop to exit. There is however the problem that code in descendant classes could rely on Windows messages being properly handled during shutdown of the thread, especially when COM interfaces are used. That's why instead of a simple *WaitFor()* the following code is used to free all running threads:

```
procedure TCustomTestController.BeforeDestruction;
var
  i: integer;
  ThreadHandle: THandle;
  WaitRes: LongWord;
  Msg: TMsg;
begin
  inherited;
  for i := Low(fPositionThreads) to High(fPositionThreads) do begin
    if fPositionThreads[i] <> nil then try
      ThreadHandle := fPositionThreads[i].Handle;
      fPositionThreads[i].Shutdown;
      while TRUE do begin
        WaitRes := MsgWaitForMultipleObjects(1, ThreadHandle, FALSE, 30000,
          QS_POSTMESSAGE or QS_SENDMESSAGE);
        if WaitRes = WAIT_OBJECT_0 then begin
          FreeAndNil(fPositionThreads[i]);
          break;
        end;
        if WaitRes = WAIT_TIMEOUT then
          break;

        while PeekMessage(Msg, 0, 0, 0, PM_REMOVE) do begin
          TranslateMessage(Msg);
          DispatchMessage(Msg);
        end;
      end;
    except
      on E: Exception do
        // ...
    end;
    fPositionThreads[i] := nil;
  end;
end; 
```

This is in the overridden *BeforeDestruction()* method because all threads need to be freed before the destructor of the descendant controller class begins to free any objects the threads might use.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-24T15:48:29.947

I'd suggest you consider using named pipes for IPC. That is what they are designed to do:

[Looking for an alternative to windows messages used in inter-process communication](https://stackoverflow.com/questions/360289/looking-for-a-replacement-for-windows-messages-used-in-inter-process-communicatio/360819#360819)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-24T17:38:23.257

As Mghie mentioned, you need a message processing loop. That's why PeekMessage returns the messages correctly. It's not that the messages aren't there, it's that you aren't processing them. In a standard application, Delphi creates a TApplication class and calls Application.Run. This IS the message processing loop for a normal app. It basically consists of:

```
 repeat
    try
      HandleMessage;
    except
      HandleException(Self);
    end;
  until Terminated; 
```

If you want your service application to handle messages, you'll need to perform the same kind of work.

There's an example of using a service and handling PostThreadMessage dispatches [here](http://www.mail-archive.com/twsocket@elists.org/msg04316.html). Keep in mind, as Mick mentioned, you cannot use message handling between applications of differing security contexts (particularly in Vista). You should use named pipes or similar. Microsoft discusses this [here](http://msdn.microsoft.com/en-us/magazine/cc163486.aspx#S11).

Edit:

Based on the code snippet that you posted, you may just be fighting a threading issue. AllocHWnd is not thread safe. See [here](http://17slon.com/blogs/gabr/2007/06/allocatehwnd-is-not-thread-safe.html) for a really detailed explanation of the issue and a version that works correctly in threads.

Of course, this still leads us back to why you aren't using PostThreadMessage instead. The way your code sample is structured, it would be trivial to make the message handling a function of the thread and then pass it down into the class for disposition.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-24T18:48:28.830

Thanks for all your answers. I think we can forget about the problem. I created a new service application and performed quick post message tests. The messages were delivered correctly, so I hope I can now state that normally everything works fine and something is wrong only with this one service I described. I know it is stupid, but I will just try to copy one fragment of code after another from the 'bad' service to a new one. Maybe this will help me find the reason of the problem.

I hope I can now consider the message-waiting loop unnecessary as long as everything works fine without it, can't I?

If it comes to the privileges, Microsoft says: "UAC uses WIM to block Windows messages from being sent between processes of different privilege levels.". My Vista's UAC is off and I did not set any privileges for those services I described. Apart from that I do not send messages between different processes. Messages are sent within one process.

To give you the idea of what I am doing, I'll show you a code snippet from a test service application.

```
uses ...;

type
  TMyThread = class;
  TMyClass = class
  private
    FThread: TMyThread;
    procedure ReadMessage(var Msg: TMessage);
  public
    FHandle: HWND;
    constructor Create;
    destructor Destroy; override;
  end;

  TMyThread = class(TThread)
  private
    FMyClass: TMyClass;
  protected
    procedure Execute; override;
    constructor Create(MyClass: TMyClass); reintroduce;
  end;

implementation

{ TMyClass }

constructor TMyClass.Create;
begin
  inherited Create;
  FHandle := AllocateHWnd(ReadMessage);
  FThread := TMyThread.Create(Self);
end;

destructor TMyClass.Destroy;
begin
  FThread.Terminate;
  FThread.WaitFor;
  FThread.Free;
  DeallocateHWnd(FHandle);
  inherited Destroy;
end;

procedure TMyClass.ReadMessage(var Msg: TMessage);
begin
  Log.Log('message read: ' + IntToStr(Msg.Msg));
end;

{ TMyThread }

constructor TMyThread.Create(MyClass: TMyClass);
begin
  inherited Create(True);
  FMyClass := MyClass;
  Resume;
end;

procedure TMyThread.Execute;
begin
  while not Terminated do
  begin
    //do some work and
    //send a message when finished
    if PostMessage(FMyClass.FHandle, WM_USER, 0, 0) then
      Log.Log('message sent')
    else
      Log.Log('message not sent: ' + SysErrorMessage(GetLastError));
    //do something else...
    Sleep(1000);
  end;
end; 
```

This is only an example, but functioning of my real code bases on the same idea. When you create an object of this class, it will create a thread that will start sending messages to that class. Log.Log() saves data into a text file. When I use this code in a new service application, everything works fine. When i put it into the 'broken' service, it does not. Please note that I do not use any message-waiting loop to receive messages. I created a new service and just put the code above into it, then created an object of the class. That's all.

If I get to know why this does not work in the 'broken' service, I'll write about it.

Thanks for the time you devoted me.

Mariusz.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-24T15:15:52.520

Here's what I would try:

*   Check the return value and GetLastError of PostMessage
*   Is this a Vista/2008 machine? If yes, check if the sending application have sufficient priviliges to do send the message.

I have to have more information to help you further.

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-25T14:18:26.287

I spent long hours trying to find the reason of the messages not being received. As I showed in my code snippet, the constructor of the class creates a window handle which I used to send messages to. As long as the class was constructed by the main thread, everything worked fine for the window handle (if I understand it correctly) existed in the context of the main thread which, by default, awaits messages. In the 'broken' service, as I called it by mistake, my class was created by another thread, so the handle must have existed in the context of that thread. Therefore, when I sent messages using this window handle, they were received by that thread, not by the main one. Because of the fact that this thread did not have any message-waiting loop, my messages were not received at all. I just did not know it worked this way. To solve the problem in an easy way, I create and destroy the class in the main thread even though I use it in the second one.

Thanks for your time and all the information you gave me.

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-25T16:31:05.373

Mghie, I think you are absolutely right. I implemented a message waiting loop this way:

```
procedure TAsyncSerialPort.Execute;
var
  Msg: tagMSG;
begin
  while GetMessage(Msg, 0, 0, 0) do
  begin
    {thread message}
    if Msg.hwnd = 0 then
    begin
      case Msg.message of
        WM_DATA_READ: Log.Log('data read');
        WM_READ_TIMEOUT: Log.Log('read timeout');
        WM_DATA_WRITTEN: Log.Log('data written');
        WM_COMM_ERROR: Log.Log('comm error');
      else
        DispatchMessage(Msg);
      end;
    end
    else
      DispatchMessage(Msg);
  end;
end; 
```

I'm doing it for the first time, so please, could you check the code whether it is correct? In fact, this is my real class code snippet (the logs will be substituted with a real code). It handles overlapped comm port. There are two threads that send thread messages to the thread above, informing it that they wrote or received some data from comm port, etc. When the thread gets such a message, it takes an action - it gets the received data from a queue, where the threads first put it and then calls an external method that, lets say, analyses the received data. I don't want to go into details for it is unimportant :). I send thread messages like this: PostThreadMessage(MyThreadId, WM_DATA_READ, 0, 0).

This code works properly as I checked, but I would like to be sure everything is correct, so I'm asking you about that. I would be grateful if you answered.

To free the thread I do the following:

```
destructor TAsyncSerialPort.Destroy;
begin
  {send a quit message to the thread so that GetMessage returns false and the loop ends}
  PostThreadMessage(ThreadID, WM_QUIT, 0, 0);

  {terminate the thread but wait until it finishes before the following objects 
  (critical sections) are destroyed for the thread might use them before it quits}
  Terminate;
  if Suspended then
    Resume;
  WaitFor;

  FreeAndNil(FLock);
  FreeAndNil(FCallMethodsLock);
  inherited Destroy;
end; 
```

I hope this is the proper way to end the message loop.

Thank you very much for your help.

BTW, I hope my English language is understandable, isn't it? :) Sorry if you have difficulties understanding me.

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2016-03-24T06:34:24.097

There's one trick in message loops in threads. Windows won't create a message queue for a thread immediately so there will be some time when posting messages to a thread will fail. Details are [here](http://msdn.microsoft.com/en-us/library/ms644946(v=VS.85).aspx). In my msg loop thread I use the technique MS proposes:

```
constructor TMsgLoopThread.Create;
begin
  inherited Create(True);
  FEvMsgQueueReady := CreateEvent(nil, True, False, nil);
  if FEvMsgQueueReady = 0 then
    Error('CreateEvent: '+LastErrMsg);
end;

procedure TMsgLoopThread.Execute;
var
  MsgRec: TMsg;
begin
  // Call fake PeekMessage for OS to create message queue for the thread.
  // When it finishes, signal the event. In the main app execution will wait
  // for this event.
  PeekMessage(MsgRec, 0, WM_USER, WM_USER, PM_NOREMOVE);
  SetEvent(FEvMsgQueueReady);

  ...
end;

// Start the thread with waitinig for it to get ready
function TMsgLoopThread.Start(WaitInterval: DWORD): DWORD;
begin
  inherited Start;
  Result := WaitForSingleObject(FEvMsgQueueReady, WaitInterval);
end; 
```

But in your case I'd strongly recommend using other means of IPC.

# c# - C# - LinkedList - 如何在指定节点后删除所有节点？

> ID：582122
> 
> 赞同：6
> 
> 时间：2009-02-24T15:10:18.650
> 
> 标签：c#, linked-list

我正在使用通用 LinkedList 实现撤消/重做缓冲区。

在这种状态下：
[Top] state4 (undo
)
state3 (undone)
state2 <-- 当前状态
state1
[bottom]

当我进行推送时，我想删除当前状态之后的所有状态，然后推送新状态。

我目前的旁路是要做的，`while (currentState != list.last), list.removeLast();`但它很烂

LinkedList 只支持 Remove、RemoveFirst 和 removeLast...

我想要像 RemoveAllNodesAfter(LinkedListNode ...) 这样的东西？

我怎样才能很好地编码，而不遍历所有节点？也许带有扩展名？...

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-24T15:15:43.800

我在标准中看不到任何`LinkedList<T>`可以让你这样做的东西。如果需要，您可以查看[PowerCollections](http://www.codeplex.com/PowerCollections)和[C5 集合](http://www.itu.dk/research/c5/)- 或者只是滚动您自己的`LinkedList`类型。它是实现起来更简单的集合之一，特别是如果您可以“及时”地添加功能。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-24T15:35:09.417

如果我要自己实现它，我会选择一种不同的方式来实现它。

`.RemoveAllNodesAfter(node)`我会选择创建一个方法来代替该方法，该`.SplitAfter(node)`方法返回一个新的链表，该链表从 after 的下一个节点开始`node`。这将成为一个更方便的工具，而不仅仅是能够砍掉尾巴。如果您想要您的`RemoveAllNodesAfter`方法，它只需要在`SplitAfter`内部调用该方法并丢弃结果。

天真的实现：

```
public LinkedList<T> SplitAfter(Node node)
{
    Node nextNode = node.Next;

    // break the chain
    node.Next = null;
    nextNode.Previous = null;

    return new LinkedList<T>(nextNode);
}

public void RemoveAllNodesAfter(Node node)
{
    SplitAfter(node);
} 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-02-24T15:26:04.323

链表（尤其是单链表）是最基本的集合结构之一。我确信您可以毫不费力地实现它（并添加您需要的行为）。

实际上，您实际上并不需要集合类来管理列表。您可以在没有集合类的情况下管理节点。

```
public class SingleLinkedListNode<T>
{
    private readonly T value;
    private SingleLinkedListNode<T> next;

    public SingleLinkedListNode(T value, SingleLinkedListNode<T> next)
    {
        this.value = value;
    }

    public SingleLinkedListNode(T value, SingleLinkedListNode<T> next)
        : this(value)
    {
        this.next = next;
    }

    public SingleLinkedListNode<T> Next
    {
        get { return next; }
        set { next = value; }
    }

    public T Value
    {
        get { return value; }
    }
} 
```

但是，如果您对可能的实现感兴趣，这里有一个简单的 SingleLinkedList 实现。

```
public class SingleLinkedList<T>
{
    private SingleLinkedListNode<T> head;
    private SingleLinkedListNode<T> tail;

    public SingleLinkedListNode<T> Head
    {
        get { return head; }
        set { head = value; }
    }

    public IEnumerable<SingleLinkedListNode<T>> Nodes
    {
        get
        {
            SingleLinkedListNode<T> current = head;
            while (current != null)
            {
                yield return current;
                current = current.Next;
            }
        }
    }

    public SingleLinkedListNode<T> AddToTail(T value)
    {
        if (head == null) return createNewHead(value);

        if (tail == null) tail = findTail();
        SingleLinkedListNode<T> newNode = new SingleLinkedListNode<T>(value, null);
        tail.Next = newNode;
        return newNode;
    }

    public SingleLinkedListNode<T> InsertAtHead(T value)
    {
        if (head == null) return createNewHead(value);

        SingleLinkedListNode<T> oldHead = Head;
        SingleLinkedListNode<T> newNode = new SingleLinkedListNode<T>(value, oldHead);
        head = newNode;
        return newNode;
    }

    public SingleLinkedListNode<T> InsertBefore(T value, SingleLinkedListNode<T> toInsertBefore)
    {
        if (head == null) throw new InvalidOperationException("you cannot insert on an empty list.");
        if (head == toInsertBefore) return InsertAtHead(value);

        SingleLinkedListNode<T> nodeBefore = findNodeBefore(toInsertBefore);
        SingleLinkedListNode<T> toInsert = new SingleLinkedListNode<T>(value, toInsertBefore);
        nodeBefore.Next = toInsert;
        return toInsert;
    }

    public SingleLinkedListNode<T> AppendAfter(T value, SingleLinkedListNode<T> toAppendAfter)
    {
        SingleLinkedListNode<T> newNode = new SingleLinkedListNode<T>(value, toAppendAfter.Next);
        toAppendAfter.Next = newNode;
        return newNode;
    }

    public void TruncateBefore(SingleLinkedListNode<T> toTruncateBefore)
    {
        if (head == toTruncateBefore)
        {
            head = null;
            tail = null;
            return;
        }

        SingleLinkedListNode<T> nodeBefore = findNodeBefore(toTruncateBefore);
        if (nodeBefore != null) nodeBefore.Next = null;
    }

    public void TruncateAfter(SingleLinkedListNode<T> toTruncateAfter)
    {
        toTruncateAfter.Next = null;
    }

    private SingleLinkedListNode<T> createNewHead(T value)
    {
        SingleLinkedListNode<T> newNode = new SingleLinkedListNode<T>(value, null);
        head = newNode;
        tail = newNode;
        return newNode;
    }

    private SingleLinkedListNode<T> findTail()
    {
        if (head == null) return null;
        SingleLinkedListNode<T> current = head;
        while (current.Next != null)
        {
            current = current.Next;
        }
        return current;
    }

    private SingleLinkedListNode<T> findNodeBefore(SingleLinkedListNode<T> nodeToFindNodeBefore)
    {
        SingleLinkedListNode<T> current = head;
        while (current != null)
        {
            if (current.Next != null && current.Next == nodeToFindNodeBefore) return current;
            current = current.Next;
        }
        return null;
    }
} 
```

现在你可以这样做：

```
public static void Main(string[] args)
{
    SingleLinkedList<string> list = new SingleLinkedList<string>();
    list.InsertAtHead("state4");
    list.AddToTail("state3");
    list.AddToTail("state2");
    list.AddToTail("state1");

    SingleLinkedListNode<string> current = null;
    foreach (SingleLinkedListNode<string> node in list.Nodes)
    {
        if (node.Value != "state2") continue;

        current = node;
        break;
    }

    if (current != null) list.TruncateAfter(current);
} 
```

事情取决于你的情况，它并不比这更好：

```
public static void Main(string[] args)
{
    SingleLinkedListNode<string> first =
        new SingleLinkedListNode<string>("state4");
    first.Next = new SingleLinkedListNode<string>("state3");
    SingleLinkedListNode<string> current = first.Next;
    current.Next = new SingleLinkedListNode<string>("state2");
    current = current.Next;
    current.Next = new SingleLinkedListNode<string>("state1");

    current = first;
    while (current != null)
    {
        if (current.Value != "state2") continue;
        current.Next = null;
        current = current.Next;
        break;
    }
} 
```

这完全消除了对集合类的需要。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-02-24T16:12:09.173

或者，您可以这样做：

```
while (currentNode.Next != null)
    list.Remove(currentNode.Next); 
```

实际上，链表是一种相当简单的数据结构，尤其是在托管代码中实现（阅读：没有内存管理麻烦）。

这是我破解的一个支持足够功能（阅读：[YAGNI](http://en.wikipedia.org/wiki/You_Ain't_Gonna_Need_It)）来支持您的撤消/重做操作的功能：

```
public class LinkedListNode<T>
{
    public LinkedList<T> Parent { get; set; }
    public T Value { get; set; }
    public LinkedListNode<T> Next { get; set; }
    public LinkedListNode<T> Previous { get; set; }
}

public class LinkedList<T> : IEnumerable<T>
{
    public LinkedListNode<T> Last { get; private set; }

    public LinkedListNode<T> AddLast(T value)
    {
        Last = (Last == null)
            ? new LinkedListNode<T> { Previous = null }
            : Last.Next = new LinkedListNode<T> { Previous = Last };

        Last.Parent = this;
        Last.Value = value;
        Last.Next = null;

        return Last;
    }

    public void SevereAt(LinkedListNode<T> node)
    {
        if (node.Parent != this)
            throw new ArgumentException("Can't severe node that isn't from the same parent list.");

        node.Next.Previous = null;
        node.Next = null;
        Last = node;
    }

    IEnumerator IEnumerable.GetEnumerator()
    {
        return ((IEnumerable<T>)this).GetEnumerator();
    }

    public IEnumerator<T> GetEnumerator()
    {
        var walk = Last;

        while (walk != null) {
            yield return walk.Value;
            walk = walk.Previous;
        }
    }

} 
```

然后你可以`SevereAt`在你的代码中使用这个方法来简单地“剪切”链表。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-24T15:47:00.793

想到的第一个想法是设置`Node.Next.Previous = null`（如果它是一个双向链表），然后`Node.Next = null`.

不幸的是，因为`LinkedListNode<T>.Next`和`LinkedListNode<T>.Previous`是链接列表的 .NET 实现中的只读属性，我认为您可能必须实现自己的结构才能实现此功能。

但正如其他人所说，这应该很容易。**如果您只是在 Google 中搜索链表 C#**，则可以使用大量资源作为起点。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2011-12-28T16:28:24.543

```
if(this.ptr != null && this.ObjectName != null)
{
    LinkedListNode<ObjectType> it = ObjectName.Last;
                for (; it != this.ptr; it = it.Previous) 
                {
                    this.m_ObjectName.Remove(it);
                }
} 
```

`this.ptr`仅供`LinkedListNode<ObjectType>`参考

`this.ptr`是指向您当前所在节点的指针，我假设您要删除它右侧的所有内容。

不要复制你的结构，这是有史以来最糟糕的主意。它是一个完整的内存猪，结构可能非常大。除非绝对必要，否则复制对象不是好的编程习惯。尝试进行就地操作。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-10-28T11:53:53.463

我为“删除特定节点之前的所有节点”和“删除特定节点之后的所有节点”做了两种扩展方法。但是，这些扩展方法是 LinkedListNode 的扩展，而不是 LinkedList 本身，只是为了方便：

```
public static class Extensions
{
    public static void RemoveAllBefore<T>(this LinkedListNode<T> node)
    {
        while (node.Previous != null) node.List.Remove(node.Previous);
    }

    public static void RemoveAllAfter<T>(this LinkedListNode<T> node)
    {
        while (node.Next != null) node.List.Remove(node.Previous);
    }
} 
```

使用示例：

```
void Main()
{
    //create linked list and fill it up with some values

    LinkedList<int> list = new LinkedList<int>();
    for(int i=0;i<10;i++) list.AddLast(i);

    //pick some node from the list (here it is node with value 3)

    LinkedListNode<int> node = list.First.Next.Next.Next;

    //now for the trick

    node.RemoveAllBefore();

    //or

    node.RemoveAllAfter();
} 
```

好吧，这不是最有效的方法，如果您发现自己在大型列表上或经常调用此方法，那么此处描述的其他方法可能更合适（例如编写您自己的链表类，它允许按照其他答案中的描述进行拆分）但是如果它只是偶尔的“在这里和那里删除节点”，而不是简单且非常直观。

# asp.net - 放置在用户控件内的数据列表

> ID：582123
> 
> 赞同：0
> 
> 时间：2009-02-24T15:10:42.923
> 
> 标签：asp.net, events, user-controls

我有一个usercontrol.Inside usercontrol我有一个datalist和sqldatasource.Sqldatasource需要一个参数来对datalist进行数据绑定。Usercontrol通过这种方式获取一个参数，

```
 private string _urunIDparam;
    public string urunIDparam
    {
        get { return _urunIDparam; }
        set {_urunIDparam = value; }
    } 
```

然后通过这种方式将这个参数添加到usercontrol的onprerender中的sqldatasource中，

```
protected override void OnPreRender(EventArgs e)
{
    SqlDataSourceHareketler.SelectParameters["urunID"].DefaultValue = urunIDparam;
    DataListHareketAna.DataBind();
    base.OnPreRender(e);
} 
```

并且 usercontrols 参数是从像这样放置 aspx 页面的按钮给出的，

```
protected void Button1_Click(object sender, EventArgs e)
{
    MyUserControl1.urunIDPARAM = urunID;
} 
```

按钮和用户控件被放置在像这样的 aspx 页面内的更新面板中，

```
<asp:UpdatePanel ID="UpdatePanel1" runat="server">
    <ContentTemplate>
        <uc2:MyUserControl ID="MyUserControl1" runat="server" /> 
         <asp:Button ID="Button1" runat="server" Text="Button" OnClick="Button1_Click"/>
    </ContentTemplate>
</asp:UpdatePanel> 
```

当我点击 datalist 内的按钮时，我的用户控件消失了（datalist 丢失了它的项目）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-24T16:14:31.227

听起来您可能需要围绕控件中的功能进行回发检查。我以前见过这个确切的问题，我认为这是我必须做的，但已经有一段时间了。

```
if (!IsPostback) {
  //LoadData
} 
```

# java - 从浏览器上传多个文件的最佳方式

> ID：582126
> 
> 赞同：37
> 
> 时间：2009-02-24T15:11:48.320
> 
> 标签：java, flash, silverlight, http, upload

我正在开发一个 Web 应用程序。用户可以在一处使用 HTTP 协议上传文件。可以在经典的 HTML 文件上传控件和用于上传文件的 Java 小程序之间进行选择。

经典的 HTML 文件上传不是很好，因为您一次只能选择一个文件，并且在实际上传期间很难获得任何进度指示（我最终使用计时器刷新进度指示器并从服务器通过 AJAX 调用）。优点：它总是有效的。

使用 Java 小程序，我可以做更多的事情：一次选择多个文件（甚至是一个文件夹）、压缩文件、获得真正的进度条、在小程序上拖放文件等等......
但是有一些缺点：

*   让它在 Mac Safari 和 Mac Firefox 上正常工作是一场噩梦（感谢 Liveconnect）
*   UI 并不完全是原生 UI，有些人注意到
*   小程序没有应有的响应（可能是我的错，但对我来说一切正常）
*   HTTPS的 Java 类存在 bug `UrlConnection`，所以我使用 Apache 通用 HTTP 客户端进行实际的 HTTP 上传。这是一个相当大的包，会减慢 .jar 文件的下载速度
*   Apache 通用 HTTP 客户端有时无法通过代理
*   Java 运行时相当大

我一直在维护这个 Java 小程序一段时间，但现在我厌倦了所有的缺点，并考虑编写/购买一个全新的组件来上传这些文件。

**问题**

如果您有以下要求：

*   通过 HTTP 或 HTTPS 从浏览器轻松上传多个文件
*   压缩文件以减少上传时间
*   上传应该可以在任何平台上使用本机 UI
*   必须能够上传大文件，至少2gb
*   你对技术有全权委托

**你会使用什么技术/组件？**

* * *

编辑 ：

*   在组件上拖放文件将是一个很好的加分项。
*   看起来有很多与 Flash Player 错误相关的问题（[swfupload known issues](http://demo.swfupload.org/Documentation/#knownissues)）。适当的 Mac 支持和通过具有身份验证的代理上传是我不能没有的选项。这可能会排除所有基于 Flash 的选项 :-( 。
*   我排除了所有 HTML/Javascript-only 选项，因为您不能使用经典 HTML 控件一次选择多个文件。当您想在一个文件夹中选择多个文件时，单击 n 次“浏览”按钮会很痛苦。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-24T23:07:01.563

我最近在 Silverlight 中实现了一些东西。

基本上使用 HttpWebRequest 将一大块数据发送到 GenericHandler。

在第一篇文章中，发送了 4KB 的数据。在第二块，我发送另一个 4K 块。

当收到第二个块时，我会计算第一个块和第二个块之间的往返行程，所以现在发送的第三个块会知道提高速度。

使用这种方法，我可以上传任何大小的文件，并且可以继续。

我发送的每个帖子都包含以下信息：

[参数] [文件数据]

此处，参数包含以下内容： [Chunk #] [Filename] [Session ID]

收到每个块后，我会向我的 Silverlight 发送回复，说明它需要多快，以便它现在可以发送更大的块。

没有代码很难解释我的解释，但这基本上就是我做的。

在某个时候，我会整理一篇关于我是如何做到这一点的快速文章。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-24T23:14:31.153

我从未将它用于 2GB 大小的文件，但[YUI 文件上传器](http://developer.yahoo.com/yui/uploader/)在以前的项目中运行良好。您可能也对这个[jQuery 插件](http://plugins.jquery.com/project/MultiFile/)感兴趣。

也就是说，我仍然认为 Java Applet 是要走的路。我认为您最终会遇到比您预期的更少的可移植性和 UI 问题，并且拖放效果很好。作为记录，Box.net 使用 Java Applet 进行多文件快速上传。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-02-27T16:33:38.783

**好的，这是我的看法**

我用 swfupload 做了一些测试，我以前有 Java 的经验，我的结论是，**无论使用什么技术，都没有完美的解决方案可以在浏览器上进行上传**：上传大文件时总是会遇到错误，通过代理，使用 ssl 等...

**但 ：**

*   Flash 上传器（la swfupload）非常轻量级，不需要用户授权，并且有一个非常酷的本机界面，我认为
*   java 上传者需要授权，但你可以对用户选择的文件做任何你想做的事情（如果需要，也可以压缩），并且拖放效果很好。不过，请为调试一些史诗般的错误做好准备。
*   只要我愿意，我就没有改变使用 Silverlight 可能是真正的答案，尽管这项技术还很年轻，所以……如果我有机会摆弄一下，我会编辑这篇文章与 Silverlight

感谢所有的答案 ！！

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-02-24T15:17:10.537

有许多免费的 Flash 组件具有很好的多文件上传功能。他们在服务器端使用带有 PHP（或其他）接收器的 ActionScripts FileReference 类。有些最近因 FP10 的推出而中断，但我确信[swfupload](http://swfupload.org/)会起作用 :)

希望这可以帮助！

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2010-12-30T20:42:31.717

这两个Jupload [http://jupload.sourceforge.net/](http://jupload.sourceforge.net/) 和 jumploader [http://jumploader.com/怎么样](http://jumploader.com/)

两者都是 java 小程序，但它们也都非常易于使用和实现。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-11-08T13:25:02.843

[谷歌齿轮](http://code.google.com/apis/gears/samples/hello_world_file_system.html)呢？

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-24T15:16:35.407

有允许多文件上传的 HTTP/HTTPS 上传控件。 [这](http://www.telerik.com/products/aspnet-ajax/upload.aspx#uploading-files)是 Telerik 的一个，我发现它是可靠的。最新版本似乎满足了您的大部分功能要求（如果不是全部的话）。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-02-24T15:19:57.020

正如 Dave 已经指出的那样，您也可以使用 HTTP 表单上传多个文件，但是如果您打算使用超出 HTTP 和 Javascript 提供的东西，我会大力考虑使用 Flash。甚至还有一些预先存在的解决方案，例如[**MultiPowUpload**](http://www.element-it.com/MultiPowUpload.aspx)，它提供了您正在寻找的许多功能。使用 Flash 客户端获取进度信息也比使用来自 Javascript 的 AJAX 调用更容易，因为您有更多的灵活性。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-02-24T17:49:17.847

您可以查看 Apache Commons FileUpload 包。它允许您上传多个文件、监控上传进度等。您可以在这里找到更多信息：http:

[//commons.apache.org/fileupload/](http://commons.apache.org/fileupload/)
[http://commons.apache.org/fileupload/using.html](http://commons.apache.org/fileupload/using.html)

祝你好运

# spring - 在 Spring 中拆分应用程序上下文文件

> ID：582127
> 
> 赞同：4
> 
> 时间：2009-02-24T15:12:27.053
> 
> 标签：spring, spring-mvc

我想获得有关以下方面的分步信息：

如何在 Spring 中通过一些示例将 ApplicationContext 文件（例如：myapp-servlet.xml）拆分为多个 XML 文件？

我尝试使用“ContextLoaderListener”配置 web.xml，并使用 contextConfigLocation 如下：

```
<init-param>
        <param-name>contextConfigLocation</param-name>
        <param-value> /WEB-INF/business-services.xml </param-value>
    </init-param> 
```

但它正在制造问题。

请给我详细解释如何做到这一点。

提前致谢 ！

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-03-04T04:58:20.987

如果我有多个上下文文件，我喜欢做的是让我的基本上下文类通过导入标记导入其他部分。

```
<import resource="applicationContext-otherStuff.xml"/> 
```

我们通常使用此模型，将数据源配置与 bean 实例化分开。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-24T15:18:51.937

例如：

```
 <param-value>classpath*:spring/persistence/*.xml, classpath*:spring/*.xml</param-value> 
```

路径取决于您拆分的 .xml 的位置

WEB-INF 目录示例

```
<param-value>/WEB-INF/daoContext.xml /WEB-INF/applicationContext.xml</param-value> 
```

旁注：似乎没有'，'

参考：

*   [春季文档](http://static.springframework.org/spring/docs/2.5.x/reference/beans.html)章节：**3.8.5。方便的 Web 应用程序的 ApplicationContext 实例化**

# php - 我的 php 架构可靠吗？

> ID：582129
> 
> 赞同：2
> 
> 时间：2009-02-24T15:12:47.100
> 
> 标签：php, architecture

我正在尝试设计一个可靠的服务器端架构并提出了这个：

[http://www.monsterup.com/image.php?url=upload/1235488072.jpg](http://www.monsterup.com/image.php?url=upload/1235488072.jpg)

客户端只与一个名为 process.php 的服务器文件对话，在该文件中检查用户权限；以及发送动作的位置。然后业务类处理业务逻辑并执行数据验证。它们都包含一个执行数据库操作的 DataAccessObject 类。

您能否指出这种架构可能存在的不同弱点？至于安全性、灵活性、广泛性……？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-24T15:40:44.023

你的架构并不完美。它永远不会是完美的。曾经。完美是不可能的。这是应用程序开发、编程和整个世界的本质。需要添加功能或更改业务逻辑，然后您将返回此架构并说“我到底怎么想这太糟糕了”。（希望......否则你可能没有学到任何新东西！）

盘点一下你的目标，应该是：

> 这个架构完美

或者改为：

> 这个架构在我需要的地方发挥作用，让我可以[完成工作](http://www.joelonsoftware.com/items/2007/06/05.html)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-24T16:03:04.513

您可以改进的一种方法是**添加一个视图层**，使用 Smarty 之类的模板引擎，甚至自己滚动。动作类将准备数据，将其分配给模板，然后显示模板本身。

这将帮助您将*业务逻辑与 HTML 分开*，使其更易于维护。

这是设计应用程序的常用方法。

您可以做的另一件事是**让另一个类处理动作委托**。不过，这实际上取决于您的应用程序的复杂性。

[PHP Objects, Patterns and Practice](https://rads.stackoverflow.com/amzn/click/com/1590599098)一书可以让您真正了解应用程序架构。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-24T16:12:31.527

我看到了几件事。

首先，我同意其他人的观点，即您应该添加某种视图层，尽管我不确定 Smarty（我经常使用它，这些天我真的很怀疑，但我离题了）。关键是您需要在模板中的某处分隔 HTML，以便轻松更改。如果您使用大量 AJAX，这一点不会动摇。AJAX 仍然需要您（通常）在页面周围放置 div 等。因此您的布局应该与处理代码分开。

我要抛出的第二件事是您的数据模型问题的复杂性。如果这是一个基于现有或相当扁平的数据库模型的简单 CRUD 应用程序，那么您可能对这些数据库访问类没问题。但是，一旦您的模型变得更加复杂，具有层次结构或以任何方式具有多态性，这就会崩溃。您将需要某种更强大的 ORM。

您的“控制器/调度程序”方法似乎合理。switch 语句避免了对任何类型的 URL -> 代码映射的需要，这些映射很难管理并且需要缓存来扩展。

那是我的 0.02 美元

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-24T16:15:59.833

从安全角度来看，您的类和操作来自您的帖子变量，这可能很危险，因为您**永远不**应该相信来自用户的任何东西。假设你的类/动作看起来像这样：

```
class1
{
  action1.1
  action1.2
  ...
  action1.N
}

class2
{
   action2.1
   action2.2
   ...
   action2.N
} 
```

作为攻击者，我首先要看的是进入一个动作与其适当的类不匹配的状态。我会尝试使用 action2.1 而不是 action1.1 提交 class1。

话虽如此，我的假设是你已经得到了某种形式的验证，所以这不会发生。这将我引向我原来的帖子：如果你的架构适合你，那么它就适合你。看看您所询问的内容：安全性、灵活性、可扩展性并自己评估它们。找出自己的缺陷。如果您不知道如何评估该主题的安全性/灵活性/其他阅读，请练习并应用它。

通过犯错误然后从中学习，您将成为更好的开发人员（导弹制导软件除外，您只能在那里尝试一次。）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-06T17:23:18.453

由于其他人提出了各种更改，例如添加视图层等，让我专注于良好架构的各种标准：

1.  可扩展性：通常，架构越抽象和松耦合，它的可扩展性就越高。这正是其他人建议您使用视图层的原因，该视图层会将每个类的表示层模板抽象出来：动作对到自己的文件中。

2.  可维护性：这与可扩展性密切相关。一般来说，架构的可扩展性越高，它的可维护性就越高（对此持保留态度，因为并非总是如此）。考虑在模型逻辑层下方添加模型层。这将帮助您从模型业务逻辑中交换数据访问逻辑。

3.  安全性：您提出的架构的缺点是您确实需要投资于安全测试。由于您所有的重定向/路由代码都在 process.php 中，因此该文件有很多责任，对它的任何更改都可能导致潜在的安全漏洞。这不一定是错误的，您只需要意识到风险。

4.  可扩展性：您的架构是平衡的，并且看起来非常可扩展。由于您已按 class:actions 对其进行分解，因此您可以在任何层添加缓存以提高性能。添加额外的数据访问模型层也将帮助您在最接近数据库的层进行缓存。

最后，尝试每种架构，不要害怕犯错误。看来您已经对 MVC 有了很好的理解。提高架构能力的唯一方法是在“现实世界”中实施和测试它。

# .net - 签署 VB.NET 应用程序

> ID：582131
> 
> 赞同：4
> 
> 时间：2009-02-24T15:12:50.360
> 
> 标签：.net, vb.net, visual-studio-2005

我必须签署我的 VB.NET 应用程序吗？

我收到一个错误：

```
SignTool reported an error 'Keyset does not exist' 
```

但是没有兴趣签署任何东西，因为项目很小，只会在我的部门内部使用。

我可以创建一个临时密钥。但我为什么要这样做？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-24T15:20:02.340

[这里](http://social.msdn.microsoft.com/Forums/en-US/winformssetup/thread/feb6bbe9-38af-4976-9a68-f1066bf5d23b/)的第二个帖子看起来可能会有所帮助......

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-22T13:00:21.817

我有同样的问题...

我转到“我的项目”的“签名”选项卡，取消选中并选中“签署 ClickOnce 清单”，然后选中“创建测试证书”。

我保存然后发布。在发布期间，它要求我确认新证书。“好的”

似乎奏效了。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-24T15:27:47.330

要回答您的第一个问题：不，不需要签名。默认情况下，您的项目未签名。

也许 Dave 的帖子会帮助您解决遇到的错误。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-24T15:30:19.443

使用强名称对程序集进行签名通常发生在程序集将被放置到 时`GAC`，因此强名称提供了安全引用。

只有组件制造商已指定`public key token`，因此在开发时从您的应用程序中引用组件，您可以确保用户将使用相同的组件。

因此，如果您的应用程序有`GUI`，我认为`not`不需要签名。如果是`library`, 可以公开使用, `yes`, 签名。

# javascript - 脚本语言中的变量是如何分配内存的？

> ID：582134
> 
> 赞同：6
> 
> 时间：2009-02-24T15:14:45.253
> 
> 标签：javascript, memory-management, scripting, variables

例如，在 javascript

我可以说

```
var x = 5; 
```

以后我可以

```
x = 'a'; 
```

进而

```
x = "hello"; 
```

那么，如何为变量分配内存呢？事实上，所有变量都有一个共同的类型“var”，变量的值可以在运行时改变，如上所示。为这些变量分配和管理内存不是一项艰巨的任务吗？确切地说，它是如何实现的？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-24T15:24:02.877

Python 使用一种称为[引用计数](http://en.wikipedia.org/wiki/Reference_counting)的技术，它基本上在值中放置一个计数器。每次创建对值的引用时，计数器都会递增。当对该值的引用丢失时（例如，当您将新值分配给“x”时），该值会递减。当计数器达到零时，这意味着不存在对该值的引用，并且可以将其释放。这是一个简化的解释，但这至少是基础。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-24T15:44:21.720

好吧，*这些*变量是对在编译时分配的不可变字符串的引用。

当然，这取决于虚拟机，但总的来说，我认为，大多数基于 C 的脚本语言会分配一大块内存，根据需要对其进行扩展并在其中进行自己的分配，很少会向 O/ S。特别是在几乎所有的词法范围语言中，变量都是在这个块内动态分配的，而不是在类似于 C 堆栈的任何东西上，并且它们通过引用计数或垃圾收集器被释放。

如果您的脚本语言在 JVM、.NET 或类似的东西（Parrot？）上运行，那么创建变量只是创建类似 Java 对象的东西。在不再引用该对象一段时间后，垃圾收集器将回收内存。

# php - php字符串格式化？

> ID：582135
> 
> 赞同：0
> 
> 时间：2009-02-24T15:14:53.833
> 
> 标签：php, string, formatting

这是代码

```
 $i=0;
while ($row = mysql_fetch_array($result)) 
    {
    $output.="idno".$i."=".urlencode($row['usr_id']).
    '&'."res".$i."=".urlencode($row['responce']).
    '&'."sex".$i."=".urlencode($row['sex']).
    '&'."com1".$i."=".urlencode($row['com1']).
    '&'."com2".$i."=".urlencode($row['com2']);
     $i++;

    } 
```

输出我得到 idno 是 com2 字符串的一部分，我如何将它们分开。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-24T15:18:52.187

您需要添加一个`&`when`$i`不为零：

```
 $i=0;
while ($row = mysql_fetch_array($result)) 
        {
    $output .= ($i ? '&' : '') . "idno".$i."=".urlencode($row['usr_id']).
        '&'."res".$i."=".urlencode($row['responce']).
        '&'."sex".$i."=".urlencode($row['sex']).
        '&'."com1".$i."=".urlencode($row['com1']).
        '&'."com2".$i."=".urlencode($row['com2']);
     $i++;

        } 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-24T15:23:08.683

另一种解决方案是使用数组并在之后加入其元素：

```
$array = array();
$i = 0;
while ($row = mysql_fetch_array($result)) {
    $array[] = "idno$i=".urlencode($row['usr_id']);
    $array[] = "res$i=".urlencode($row['responce']);
    $array[] = "sex$i=".urlencode($row['sex']);
    $array[] = "com1$i=".urlencode($row['com1']);
    $array[] = "com2$i=".urlencode($row['com2']);
    $i++;
}
$output .= implode('&', $array); 
```

此外，您可以使用PHP 在接收到此类请求查询字符串时将转换为数组的声明。*`argName`*`[]`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-24T15:36:21.147

或者你可以这样做：

```
$array = array();
$i = 0;
while ($row = mysql_fetch_array($result)) {
    $array["idno$i"] = $row['usr_id'];
    $array["res$i"] = $row['responce'];
    //etc.

    $i++;
}

$output = http_build_query($array); 
```

# javascript - 自由格式日期选择器 - 类似于 RTM

> ID：582146
> 
> 赞同：2
> 
> 时间：2009-02-24T15:17:25.047
> 
> 标签：javascript, ajax, dhtml

我正在寻找一种方法来拥有一个文本框，该文本框允许用户以任何格式输入日期并转身并以“mm/dd/yyyy”格式格式化该日期。因此，用户可以输入“今天”，它会将日期变为 02/24/2009，或者他们可以输入 2 月 24 日星期三，格式会自动恢复。请记住 Milk 会这样做（但我相信服务器端）。这是 asp.net，所以我可以通过 ajax Web 服务调用来实现，但我更愿意通过 Javascript 来实现。我正在寻找一种通用技术或现有库来帮助解决这个问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-24T15:30:03.347

查看[http://www.datejs.com/](http://www.datejs.com/)

# c# - XAML 中的 WPF 数据绑定

> ID：582147
> 
> 赞同：2
> 
> 时间：2009-02-24T15:17:28.913
> 
> 标签：c#, wpf, data-binding, xaml, itemssource

在我当前的项目中，我对数据绑定没有什么问题。我有一个要绑定到 ListBox 的 ObservableCollection。

```
public ObservableCollection<GeoDataContainer> geoList = new ObservableCollection<GeoDataContainer>(); 
```

...之后...

```
geoListBox.ItemsSource = geoList; 
```

这段代码工作正常。列表框有一个数据模板，一切看起来都很完美。

但我不想使用 C# 代码进行绑定。我想在 XAML 代码中进行绑定。我正在寻找几天，但我不明白。这是两行 C# 代码，但要在 XAML 中存档，如果不为我的集合创建自己的类或添加 DataProvider 或资源或其他任何东西，似乎是不可能的。

没有简单的方法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-24T15:24:16.060

您所要做的就是公开集合并绑定到它。例如，如果您将其公开为：

```
public ICollection<GeoDataContainer> GeoList
{
    get { return geoList; }
} 
```

您将能够绑定到它：

```
<ListBox ItemsSource="{Binding GeoList}"/> 
```

“技巧”是确保`DataContext`的`ListBox`是公开`GeoList`属性的类。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-24T19:06:08.803

另一种好方法是将 geoList 实例化为资源

```
<WindowResources>
  <l:GeoCollection x:Key="geoList"/>
</WindowResources> 
```

然后你有

```
GeoCollection geoList = FindResource("geoList") as GeoCollection; 
```

当然，这仅适用于数据仅与视图相关的情况。如果这与模型或模型视图有关，则使用 DataContext 并绑定到它的属性。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-24T16:02:47.400

肯特建议是要走的路...

进一步说明，如果您不希望将 DataContext 设置为列表，您还可以使用另一种形式的绑定检索该属性：

确保您的根控件有一个名称，即“根”

```
{Binding ElementName=Root, Path=GeoList} 
```

# java - AS3 是否有与 Java 的 NumberFormat 类似的类

> ID：582151
> 
> 赞同：0
> 
> 时间：2009-02-24T15:19:13.013
> 
> 标签：java, apache-flex, actionscript-3, number-formatting, pad

我一直使用 Java 中的 NumberFormat 类来进行简单的数字填充，即。将 1, 2, 3... 变成 0001, 0002, 0003....

ActionScript 中是否有类似的实用程序来进行填充，或者我是否必须编写自定义函数？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-24T15:41:17.373

似乎没有内置任何东西。这将做到：

```
function padZero (num:Number, digits:int):String {
  var ret:String = num.toString();
  while (ret.length < digits)
    ret = "0" + ret;
  return ret;
} 
```

虽然[com.adobe.utils.NumberFormatter](http://weblogs.macromedia.com/as_libraries/docs/corelib/com/adobe/utils/NumberFormatter.html)有`addLeadingZero(n:Number):String`，这听起来很有希望，但根据规范，它会将单个零填充到 -1 到 10 之间的数字。我猜该函数仅对时间输出有用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-10-18T21:37:46.733

Flash 现在将 NumberFormatter() 类作为 flash.globalization 的一部分。*

它将在用户区域设置中格式化数字

[http://help.adobe.com/en_US/FlashPlatform/beta/reference/actionscript/3/flash/globalization/NumberFormatter.html](http://help.adobe.com/en_US/FlashPlatform/beta/reference/actionscript/3/flash/globalization/NumberFormatter.html)

您还可以设置前导零或尾随零的数量

# apache - Apache Tomcat 是基于 Apache Web Server 平台构建的吗？

> ID：582156
> 
> 赞同：14
> 
> 时间：2009-02-24T15:20:14.383
> 
> 标签：apache, tomcat, webserver

最近，我们的软件分析提供商 ( [NETTRACKER](http://netinsight.unica.com/products/NetTracker.htm) ) 向我们发送了一个插件，以便能够以更好的方式捕获访问者。此插件适用于 Apache 1.x 和 Apache 2.x。他们说，我引用

> 因为 Apache Tomcat 是建立在 Apache HTTP 服务器上的，所以插件的配置应该是一样的。

我在我们的 tomcat 部署中查找了 httpd.conf，但找不到，唯一与该配置类似的配置是 /conf 目录下的 server.xml。

如果有人对这两个令人难以置信的产品（Apache HTTP 服务器和 Apache Tomcat）有更好的信息，我将不胜感激。

编辑：如果您好奇，我们知道 Apache Web 服务器和 Tomcat 可以使用 mod_jk 选项和其他代理一起工作。但这对于我们的部署来说太复杂了。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-02-24T15:24:39.863

Apache Tomcat 和 Apache HTTP 是完全不同的服务器技术。在 Tomcat 中使用 Apache HTTP 服务器插件是不可能的。

Apache HTTP 服务器是用 C 语言开发的，插件也是如此。相反，Tomcat 现在完全是用 Java 开发的。Tomcat 不仅提供静态内容，还可以提供 JSP 页面和 servlet。

Tomcat 用于托管 Java Web 应用程序。它可以确保提供静态内容 - 您可以仅使用 Tomcat 托管 Web 应用程序。支持安全连接，性能也非常好（与HTTP服务器的性能相当）。

Apache 的简单安装提供静态内容。使用适当的插件，可以将 HTTP 请求重定向到应用程序服务器（Tomcat、JBoss、Glassfish）或脚本语言解释器 (PHP)。通过这种方式，可以生成动态内容。Apache 的最大优势是可用的众多插件，它允许管理员以任何他们想要的方式配置和监控网站，这是可用的最广泛的服务器。这使其成为最安全的解决方案，因为它经过了彻底的测试，并且任何发现的缺陷都会很快得到纠正。

最好的解决方案是使用由 Apache 服务器代理的 Tomcat。设置起来并不难。如果你不能做到这一点，那么你就不能利用 Apache 的插件。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-02-24T22:04:53.710

你总是看到这种困惑。许多人认为 Apache 是一个 Web 服务器，实际上它是一个组织的名称，该组织拥有一个名为“ [Apache HTTP 服务器项目](http://httpd.apache.org/)”的 Web 服务器项目。简而言之，Web 服务器称为 HTTPD（D 作为守护程序或 Unix 进程）。

[Tomcat](http://tomcat.apache.org/)是另一个 Apache 项目。这个项目实现了一个 Java servlet 引擎来为 JSP 页面和 servlet 提供服务。Tomcat 和 HTTPD 没有任何关系。但是，您可以设置 HTTPD 和 Tomcat 以便它们一起工作。通过这种方式，您可以让 HTTPD 为所有静态内容提供服务，进行 URL 重写以及更多内置 Tomcat Web 服务器无法做到（或做得不好）的花哨的事情。每当请求 JSP 页面时，HTTPD 都会将该请求传递给 Tomcat。Tomcat 将处理请求并将输出返回给 HTTPD，然后将其发送给客户端。

Apache 有许多[有趣的项目](http://www.apache.org)。例如，还有一个名为[Geronimo](http://geronimo.apache.org/)的项目，它是一个 Java 企业服务器 (J2EE)。例如，您可以选择在 Geronimo 中嵌入 Tomcat 来处理对 JSP 和 servlet 的请求，在这些请求中 Geronimo 做的事情更多（LDAP、消息传递等）。您可能已经猜到了，您也可以将 HTTPD 用作 Geronimo 的静态内容服务器。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-24T15:27:32.243

完全是假的。Apache httpd 插件是用 C 编写的，Tomcat 是纯 Java 的。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-01T05:35:36.430

Tomcat 是一个 Java servlet 引擎。它可以托管在 Apache 或 IIS 或许多其他面向外部的 Web 服务器下。听起来您当前可能正在独立运行 Tomcat 实例...

如果您从端口 8080 为 JSP/servlet 提供服务，并让它在运行 Apache 的同一主机上独立执行操作，这可以让您将它们松散耦合。不建议使用多个 Web 服务器来处理独立的请求，特别是如果您想与 Apache 一起使用基于服务器的身份验证。通常，您有一个面向外部的服务器，它通过它来管理所有内容...... Apache 做得很好，并且您提到的插件可能依赖于这种类型的设置（一切都通过 Apache 连接）的特性/功能，基于您的对其进行简要说明。

如果您想在 Apache 下提供您的 Tomcat servlet，您可以配置 apache 以将一类 URI 转发到您的 Tomcat 服务器实例。您可以通过 mod_rewrite 实现这种类型的转发。在性能方面，这是一个较慢的选项，因为它会在您服务器上的所有内容上增加一些开销。您还可以通过类似的 CGI 机制代理传入请求，从 Apache 到 Tomcat。

*mod_jk* **将简化部署并提高**将 Tomcat 放入 Apache 服务器配置的性能。如果您遵循文档，配置起来非常轻松，所以我不确定您的部署“太复杂”是什么意思——如果您想要 Apache 并且已经拥有 Tomcat，这似乎只是一个轻微的配置更改问题*下载*并安装mod_jk 。

# c# - 为 Web 应用程序创建合理文件大小的缩略图

> ID：582162
> 
> 赞同：3
> 
> 时间：2009-02-24T15:22:18.450
> 
> 标签：c#, image, resize, thumbnails

我的源图像是 2288px x 1712px 和 816kb。当我创建 1024 x 768 的缩略图时，文件大小是高分辨率源的两倍多（1.13mb - 1.8mb，取决于使用的方法）。

创建的源图像和缩略图是 .jpg

即使创建 299 x 224 的缩略图也是 180kb，而我在 GIMP 中手动创建的缩略图是 14kb。

我需要图像看起来不错，因此不能在尺寸质量上妥协。

我试过 Image.GetThumbnailImage ，它创建了一个 1.13mb 的文件，但我读到它会产生意想不到的结果。

大多数文章都说像这篇文章那样写代码：http: [//www.codeproject.com/KB/GDI-plus/imageresize.aspx](http://www.codeproject.com/KB/GDI-plus/imageresize.aspx)

这给了我一个 1.83mb 的缩略图。

与使用桌面应用程序做同样的事情相比，我是否应该期待更大的文件大小？

我尝试了 16 位而不是 24 位，并注释掉了“高质量”值，但我仍然无法将其低于 1mb。有任何想法吗？

```
Bitmap bmPhoto = new Bitmap(destWidth, destHeight,PixelFormat.Format24bppRgb);
        bmPhoto.SetResolution(image.HorizontalResolution,image.VerticalResolution);

        Graphics grPhoto = Graphics.FromImage(bmPhoto);

        grPhoto.InterpolationMode = InterpolationMode.HighQualityBicubic;        
        grPhoto.SmoothingMode = SmoothingMode.HighQuality;
        grPhoto.PixelOffsetMode = PixelOffsetMode.HighQuality;
        grPhoto.CompositingQuality = CompositingQuality.HighQuality; 
```

**编辑答案**

我缺乏压缩。我的 1024 缩略图现在是 112kb。

```
Encoder qualityEncoder = Encoder.Quality;
//80L is the compression percentage
EncoderParameter ratio = new EncoderParameter(qualityEncoder, 80L);
// Add the quality parameter to the list
EncoderParameters codecParams = new EncoderParameters(1);
codecParams.Param[0] = ratio;

ImageCodecInfo jpegCodecInfo = GetEncoderInfo("image/jpeg");

bmPhoto.Save(Path.Combine(filepath, RenameImage(filename, appendName, replaceWholeString)), jpegCodecInfo, codecParams);

ImageCodecInfo GetEncoderInfo(string mimeType)    
{    
int j;    
ImageCodecInfo[] encoders;    
encoders = ImageCodecInfo.GetImageEncoders();

for(j = 0; j < encoders.Length; ++j)    
{    
if(encoders[j].MimeType.ToUpper() == mimeType.ToUpper())    
return encoders[j];    
}    
return null;    
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-24T15:29:40.273

这听起来像您没有使用压缩或非常弱的压缩（如 RLE）。尝试 PNG、JPG（或无损的 JPG2000）或 GIF。

编辑：如果您使用 JPG，请尝试降低图像质量。1024x768 的缩略图应该能够比 1 MB 小很多，而且看起来还不错。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-24T15:28:44.503

位图格式是您的主要问题。与其他格式相比，这将永远是巨大的。位图是游程编码和未压缩的。

如果您的图像是照片，JPEG 是您最好的选择。您可以通过很小的文件大小获得出色的视觉质量。如果它们是线条艺术并且没有很多颜色，GIF 也可能是一个不错的选择。有几个很好的图像处理库，例如[FreeImage](http://freeimage.sourceforge.net/sourcecode.html)。

编辑：注意到您将 JPEG 转换为 JPEG 的评论......缺乏良好的压缩可能是框架内置图像功能的限制。

# sql - Oracle SQL：LEAST() 返回多行...？

> ID：582163
> 
> 赞同：4
> 
> 时间：2009-02-24T15:22:54.360
> 
> 标签：sql, oracle, user-defined-functions

一位同事刚刚带着一个令人费解的 SQL 查询来找我：

（本质上）

```
SELECT LEAST(id) FROM tableA A, tableB B WHERE a.name = b.name(+) 
```

然而，返回的结果集列出了三个数字：

> 最少（id）
> --------------
> 621
> 644
> 689

（所有都是符合查询的 ID，就好像它一起缺少 LEAST 函数一样）

为什么？=)

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-02-24T15:28:00.060

[LEAST(x,y,...)](http://www.techonthenet.com/oracle/functions/least.php)不是聚合函数。它仅适用于其参数。您想要的函数是 MIN(x)。

对于每条记录，您都在运行 LEAST(id)，它将始终返回 id。如果您传递的参数最少，您会看到不同的结果。例如，`LEAST(5,6,7) = 5`。LEAST 总是返回**其参数**中的最小值，而 MIN 返回**每条记录**中的最小值。

# sql - 在调试期间观察 SSIS 中的变量

> ID：582166
> 
> 赞同：85
> 
> 时间：2009-02-24T15:23:22.287
> 
> 标签：sql, sql-server-2005, debugging, ssis, watch

我在 SSIS 中有一个项目，我添加了一个执行 SQL 任务，它将其结果发送到一个变量。我想确认这个值，因为我担心它会尝试将它写成一个结果集对象而不是一个实际的整数（在这种情况下我返回一个 COUNT）。

我的第一个想法就是在调试模式下运行它并将全局变量添加到我的 Watch 窗口中。不幸的是，当我右键单击监视窗口时，“添加变量”选项是灰色的。我在这里想念什么？

我已经四处确认我的变量设置正确，所以我对诸如放入脚本以执行带有值的 MsgBox 之类的方法不感兴趣。为了将来参考，我希望能够在调试模式下观察变量。如果对此有某种限制，那么如果有人知道，我想知道这一切的内容和原因。

我能找到的每个“教程”的帮助都非常不足，只是说“将变量添加到监视窗口并进行调试”，好像这样做永远不会有问题。

感谢您的任何见解！

* * *

## 回答 #1

> 赞同：87
> 
> 时间：2009-02-24T15:43:39.757

我相信您只能在调试器在断点处停止时将变量添加到 Watch 窗口。如果您在步骤上设置断点，您应该能够在断点被命中时将变量输入到 Watch 窗口中。您可以在 Watch 窗口中选择第一个空行并输入变量名称（您可能会或可能不会在此处获得一些 Intellisense，我不记得它的效果如何。）

* * *

## 回答 #2

> 赞同：57
> 
> 时间：2012-09-27T18:52:30.957

将变量从“变量”窗格拖到“观察”窗格，瞧！

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2017-01-19T16:18:45.767

我知道这已经很老了，可能在谈论旧版本的 Visual Studio，所以这可能不是一个选项，但无论如何，我的方式是在断点处使用本地窗口查看所有当前变量值（调试 > > Windows >> 本地人）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-12-28T10:55:38.367

Visual Studio 2013：在调试期间添加到监视窗口和拖动变量或在没有“user::”的情况下键入它们都是可以的。但在所有这些工作之前，我还需要转到工具 > 选项，然后是调试 > 常规，并且必须向下滚动到右侧窗格的底部才能勾选“使用托管兼容模式”。然后我不得不停止并重新开始调试。最后上面的建议奏效了。非常感谢以上内容和本文： [Visual Studio 2015 调试：无法扩展局部变量？](https://stackoverflow.com/questions/28730100/visual-studio-2015-debugging-cant-expand-local-variables)

# rest - 你会如何设计一个 RESTful 投票系统？

> ID：582184
> 
> 赞同：13
> 
> 时间：2009-02-24T15:29:13.723
> 
> 标签：rest

在我继续尝试将我的思想包裹在 RESTful 上的过程中，我来到了另一个我不确定如何进行的地方。我为自己设置了一个思想实验，我将为资源设计一个简单的投票系统，就像 SO 允许对问题进行投票一样。因此，假设我的资源是图像，我可以通过 ID 获取图像，如下所示：

```
http://www.mysite.com/images/123123 
```

在这个例子中，它返回一个图像的 JSON 表示，如下所示：

```
{
"URL":"http://www.mysite.com/images/123123.jpg",
"Rep":"100"
} 
```

我将如何设计一种在该图像上“投票”的方式？我想要两个操作；赞成票和反对票。客户端不应该知道每个承载多少重量，因为我希望在服务器级别决定赞成/反对票的奖励，以便我可以随时更改它。

我的第一个想法是有这样的东西：

```
http://www.mysite.com/vote/images?image=123123 
```

对于该 URL，可以发布如下内容：

```
{
"Vote":"UpVote"
} 
```

但我对此持谨慎态度——对我来说，RPC 是变相的。这会是一种糟糕的设计方式吗？如果是这样，我可以尝试哪些其他设计？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-24T18:02:36.350

为了安静，你应该返回这样的东西

```
{
"URL":"http://www.mysite.com/images/123123.jpg",
"Rep":"100"
"UpVoteLink":"http://blah, blah, blah",
"DownVoteLink":"http://blah, blah, something else blah",
} 
```

就 REST 而言，链接的格式是什么并不重要。只要您的客户知道它应该对“UpVoteLink”或“DownVoteLink”进行 POST，它就不会关心 URL 的格式是什么。

此外，如果您在两周内决定不喜欢您选择的 URL，您可以更改它们，没有人会在意！

好的，好的，如果你真的想要一个 url 设计的建议，怎么样

```
POST http://www.mysite.com/UpVotes?url=http://www.mysite.com/images/1234.jpg

POST http://www.mysite.com/DownVotes?url=http://www.mysite.com/images/1234.jpg 
```

这种设计的酷炫之处在于，您可以对甚至不在您网站上的图像进行投票！

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-25T07:57:11.367

就资源而言，图像是具有 URI 的东西（这就是使其成为资源的原因）。除此之外，它还有很多属性（大小、EXIF 数据等）。

当您考虑对图像的投票时，请质疑投票本身是否是一种资源。

很有可能，在 /images/23/votes 上执行 GET 将返回 UI 将用于在图像旁边显示的所有投票的摘要或列表。每当您想更改这些选票时，您要更改的资源就是选票。

为了保持安静，客户只需要了解您设计的媒体类型，而不是 URI 或投票遵循的流程。

在您的示例中，您将定义一种在您网站上随处使用的新格式。要重新制定 yoru 示例，GET /images/23/votes 将返回（在 xml 中，但您可以在 json 中重新制定它）：

```
<votes>
 <link href="/images/23" rel="subject" />
 <form action="/images/23/votes" mediatype="application/json">
   <submit name="Vote" value="Up">Vote up</submit>
   <submit name="Vote" value="Down">Vote down</submit>
 </form>
</votes> 
```

这种格式背后的想法是，您有一种通用的方式来定义客户端如何将数据发送到服务器并构建文档。之前正确显示的所有示例都使 URI 依赖于服务器。我建议您发送到服务器的内容应该以服务器发送的形式定义。

所以花更多的时间定义yoru json客户端将如何理解如何基于通用的表单语言构建json对象进行提交，你会发现一旦完成，cient和服务器之间的耦合非常低，并且服务器可以灵活地更改所有细节，而不会破坏您的客户端。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-24T17:03:38.580

REST API 应该代表名词，所以我认为您的第一部分是正确的：单个图像由单个 URL（例如`http://www.mysite.com/images/123123`）表示。`/up_vote`不过，我不确定是否`/down_vote is`继续前进。

`http://www.mysite.com/images/123123` *是*对象，您要修改它，而不是其他 URL（除非您正在这样做`http://www.mysite.com/votes/images/123123`）。我认为您应该只发布到`http://www.mysite.com/images/123123`. 这使得 GET 请求本质上是非破坏性的，因为它只是检索图像、保留 RESTful 设计并保持 URL 干净。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-02-24T15:43:05.203

如果您正在使用 Rails，我会选择这个 GET-URL：

```
http://www.mysite.com/images/123123/up_vote 
```

和

```
http://www.mysite.com/images/123123/down_vote 
```

**1.** 在您的图像控制器中定义动作“up_vote”和“down_vote”，并让它增加或减少您的图像模型对象的投票值。

**2.** 在config/routes.rb中设置如下路由：

```
map.resources :images, :member => { :up_vote => :get, :down_vote => :get } 
```

......你已经完成了（或多或少;-)）。

* * *

## 回答 #5

> 赞同：-3
> 
> 时间：2009-02-24T15:41:53.427

发布一个简单的响应，比如用 JSON 封装的响应，对我来说似乎很愚蠢

为什么不做这样简单的事情，你可以在 AJAX 调用中做到这一点，让它变得更好..

格式如下的 GET 请求

```
http://www.mysite.com/vote.php?image=123&vote=up 
```

或 POST（本示例使用 jQuery）

```
$.post("http://www.mysite.com/vote.php", {image:"123", vote:"up"}); 
```

（假设是 PHP，但无论如何适用）

# android - 如何在 Android 中禁用横向模式？

> ID：582185
> 
> 赞同：1015
> 
> 时间：2009-02-24T15:29:25.437
> 
> 标签：android, android-manifest, android-orientation

如何为我的 Android 应用程序中的某些视图禁用横向模式？

* * *

## 回答 #1

> 赞同：1762
> 
> 时间：2009-02-24T17:04:33.523

添加`android:screenOrientation="portrait"`到 AndroidManifest.xml 中的活动。例如：

```
<activity android:name=".SomeActivity"
          android:label="@string/app_name"
          android:screenOrientation="portrait" /> 
```

由于这已成为一个超级流行的答案，我感到非常内疚，因为强制肖像很少是解决它经常应用的问题的正确解决方案。
强制肖像的主要注意事项：

*   这并不能免除您必须考虑活动生命周期事件或正确保存/恢复状态的责任。除了应用程序轮换之外，还有很多事情可以触发活动破坏/重新创建，包括不可避免的事情，例如多任务处理。没有捷径；学习使用包和`retainInstance`片段。
*   请记住，与相当统一的 iPhone 体验不同，有些设备的纵向并不是明显流行的方向。当用户使用带有硬件键盘或游戏手柄的设备（例如 Nvidia Shield、[Chromebook](https://support.google.com/chromebook/answer/7021273?hl=en)、[可折叠](https://android-developers.googleblog.com/2018/11/get-your-app-ready-for-foldable-phones.html)设备或[Samsung DeX](https://www.samsung.com/global/galaxy/apps/samsung-dex/)）时，强制人像可能会使您的应用体验受到限制或极大的可用性麻烦。如果您的应用程序没有强大的 UX 参数会导致支持其他方向的负面体验，那么您可能不应该强制横向。我说的是“这是一款收银机应用程序，适用于始终用于固定硬件底座的特定型号平板电脑”。

因此，大多数应用程序应该让手机传感器、软件和物理配置自行决定用户希望如何与您的应用程序交互。但是，如果您对用例中的默​​认方向行为不满意，您可能仍需要考虑一些`sensor`情况：

*   如果您主要担心的是在您认为设备的传感器和软件无法很好应对的活动过程中意外的方向变化（例如，在基于倾斜的游戏中），请考虑支持横向和纵向，但使用`nosensor`用于方向。这会强制大多数平板电脑上的横向和大多数手机上的纵向，但我仍然不建议对大多数“普通”应用程序这样做（一些用户只是喜欢在手机上输入横向软键盘，而许多平板电脑用户以纵向阅读 - 和你应该让他们）。
*   如果由于某种原因*仍然*需要强制人像，`sensorPortrait`可能比`portrait`Android [2.3](https://en.wikipedia.org/wiki/Android_Gingerbread) (Gingerbread) 及更高版本更好；这允许倒置的肖像，这在平板电脑使用中很常见。

* * *

## 回答 #2

> 赞同：117
> 
> 时间：2010-10-18T14:53:15.503

在阅读这篇文章之前，我不知道`AndroidManifest.xml`文件切换，所以在我的应用程序中我使用了这个：

```
setRequestedOrientation(ActivityInfo.SCREEN_ORIENTATION_PORTRAIT); // Fixed portrait orientation 
```

* * *

## 回答 #3

> 赞同：49
> 
> 时间：2012-09-27T09:47:53.777

`android:screenOrientation="portrait"`在您声明活动的清单文件中添加。像这样：

```
<activity 
    android:name=".yourActivity"
    ....
    android:screenOrientation="portrait" /> 
```

如果您想使用 Java 代码执行此操作，请尝试：

```
setRequestedOrientation (ActivityInfo.SCREEN_ORIENTATION_PORTRAIT); 
```

在为您的活动调用`setContentView`方法之前`onCreate()`。

* * *

## 回答 #4

> 赞同：31
> 
> 时间：2013-08-21T14:41:33.673

这里的很多答案都建议`"portrait"`在您的 AndroidManifest.xml 文件中使用。这似乎是一个很好的解决方案 - 但如文档中所述，您正在挑选可能只有景观的设备。您还强制某些设备（在横向上效果最好）进入纵向，而不是获得正确的方向。

我的建议是`"nosensor"`改用。这将使设备使用其默认的首选方向，不会阻止 Google Play 上的任何购买/下载，并确保传感器不会弄乱您的（在我的情况下为 NDK）游戏。

* * *

## 回答 #5

> 赞同：16
> 
> 时间：2015-02-05T09:30:58.550

只需在您的清单中添加这一行：

```
android:screenOrientation="portrait" 
```

像：

```
<manifest
    package="com.example.speedtest"
    android:versionCode="1"
    android:versionName="1.0" >

    <application
        android:allowBackup="true"
        android:icon="@drawable/ic_launcher"
        android:label="@string/app_name"
        android:theme="@style/AppTheme" >

        <activity
            android:name="ComparisionActivity"
            android:label="@string/app_name"
            android:screenOrientation="portrait" >
        </activity>

    </application>

</manifest> 
```

* * *

## 回答 #6

> 赞同：15
> 
> 时间：2012-02-10T04:46:49.323

如果您想要用户设置，那么我建议您`setRequestedOrientation (ActivityInfo.SCREEN_ORIENTATION_PORTRAIT);`

您可以从设置菜单更改设置。

我需要这个，因为我的计时器必须与屏幕上的内容相对应，旋转屏幕会破坏当前的活动。

* * *

## 回答 #7

> 赞同：15
> 
> 时间：2015-03-16T05:25:50.040

如果您想禁用**`Landscape mode for your Android app`**（或单个活动），您需要做的就是添加：

**`android:screenOrientation="portrait"`**到*`AndroidManifest.xml`*文件中的活动标签。

像：

```
<activity 
    android:name="YourActivityName"
    android:icon="@drawable/ic_launcher"
    android:label="Your App Name"
    android:screenOrientation="portrait"> 
```

**另一种方式：程序化方法。**

如果您想以编程方式执行此操作，即使用 Java 代码。您可以通过在您不希望以横向模式显示的活动的 Java 类中添加以下代码来实现。

```
setRequestedOrientation(ActivityInfo.SCREEN_ORIENTATION_PORTRAIT); 
```

* * *

## 回答 #8

> 赞同：12
> 
> 时间：2018-04-05T09:28:42.990

您可以对整个应用程序执行此操作，而不必让所有活动都扩展一个公共基类。

诀窍是首先确保在项目中包含一个 Application 子类。在您的应用程序首次启动时调用的 onCreate() 中，您注册一个 ActivityLifecycleCallbacks 对象（API 级别 14+）以接收活动生命周期事件的通知。

这使您有机会在应用程序中的任何活动开始（或停止，或恢复，或其他）时执行自己的代码。此时，您可以对新创建的活动调用 setRequestedOrientation()。

并且不要忘记在清单文件中添加 app:name=".MyApp"。

```
class MyApp extends Application {

    @Override
    public void onCreate() {
        super.onCreate();  

        // register to be informed of activities starting up
        registerActivityLifecycleCallbacks(new ActivityLifecycleCallbacks() {

            @Override
            public void onActivityCreated(Activity activity, 
                                          Bundle savedInstanceState) {

                // new activity created; force its orientation to portrait
                activity.setRequestedOrientation(
                    ActivityInfo.SCREEN_ORIENTATION_PORTRAIT);
            }
            ....
        });
    }
} 
```

* * *

## 回答 #9

> 赞同：8
> 
> 时间：2014-01-03T06:04:00.097

您应该更改`android:screenOrientation="sensorPortrait"`AndroidManifest.xml

* * *

## 回答 #10

> 赞同：8
> 
> 时间：2015-05-06T09:59:31.527

在 Activity 的 onCreate() 中使用它

```
setRequestedOrientation(ActivityInfo.SCREEN_ORIENTATION_PORTRAIT); 
```

* * *

## 回答 #11

> 赞同：7
> 
> 时间：2013-10-01T07:00:13.207

只需在您的活动标签中添加此属性即可。

```
 android:screenOrientation="portrait" 
```

* * *

## 回答 #12

> 赞同：7
> 
> 时间：2014-01-26T09:30:04.750

添加`android:screenOrientation="portrait"`到要禁用横向模式的活动。

* * *

## 回答 #13

> 赞同：7
> 
> 时间：2017-04-22T17:51:53.213

如果您不想更好地在活动的每个清单条目中添加方向的麻烦，请创建一个 BaseActivity 类（继承“Activity”或“AppCompatActivity”），它将被应用程序的每个活动而不是“Activity”继承' 或 'AppCompatActivity' 并在您的 BaseActivity 中添加以下代码：

```
@Override
protected void onCreate(@Nullable Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setRequestedOrientation (ActivityInfo.SCREEN_ORIENTATION_PORTRAIT);
    // rest of your code......
} 
```

* * *

## 回答 #14

> 赞同：6
> 
> 时间：2016-04-28T06:24:30.057

**如何在某些视图中更改方向**

除了锁定整个活动的方向，您可以使用此类从任何视图中动态地锁定方向，实用：

让你的视野***风景***

```
OrientationUtils.lockOrientationLandscape(mActivity); 
```

使您的视图***纵向***

```
OrientationUtils.lockOrientationPortrait(mActivity); 
```

***解锁***方向

```
OrientationUtils.unlockOrientation(mActivity); 
```

方向实用程序类

```
import android.app.Activity;
import android.content.Context;
import android.content.pm.ActivityInfo;
import android.content.res.Configuration;
import android.os.Build;
import android.view.Surface;
import android.view.WindowManager;

/*  * This class is used to lock orientation of android app in nay android devices
 */

public class OrientationUtils {
    private OrientationUtils() {
    }

    /** Locks the device window in landscape mode. */
    public static void lockOrientationLandscape(Activity activity) {
        activity.setRequestedOrientation(ActivityInfo.SCREEN_ORIENTATION_SENSOR_LANDSCAPE);
    }

    /** Locks the device window in portrait mode. */
    public static void lockOrientationPortrait(Activity activity) {
        activity.setRequestedOrientation(ActivityInfo.SCREEN_ORIENTATION_PORTRAIT);
    }

    /** Locks the device window in actual screen mode. */
    public static void lockOrientation(Activity activity) {
        final int orientation = activity.getResources().getConfiguration().orientation;
        final int rotation = ((WindowManager) activity.getSystemService(Context.WINDOW_SERVICE)).getDefaultDisplay()
                .getRotation();

        // Copied from Android docs, since we don't have these values in Froyo
        // 2.2
        int SCREEN_ORIENTATION_REVERSE_LANDSCAPE = 8;
        int SCREEN_ORIENTATION_REVERSE_PORTRAIT = 9;

        // Build.VERSION.SDK_INT <= Build.VERSION_CODES.FROYO
        if (!(Build.VERSION.SDK_INT <= Build.VERSION_CODES.FROYO)) {
            SCREEN_ORIENTATION_REVERSE_LANDSCAPE = ActivityInfo.SCREEN_ORIENTATION_LANDSCAPE;
            SCREEN_ORIENTATION_REVERSE_PORTRAIT = ActivityInfo.SCREEN_ORIENTATION_PORTRAIT;
        }

        if (rotation == Surface.ROTATION_0 || rotation == Surface.ROTATION_90) {
            if (orientation == Configuration.ORIENTATION_PORTRAIT) {
                activity.setRequestedOrientation(ActivityInfo.SCREEN_ORIENTATION_PORTRAIT);
            } else if (orientation == Configuration.ORIENTATION_LANDSCAPE) {
                activity.setRequestedOrientation(ActivityInfo.SCREEN_ORIENTATION_LANDSCAPE);
            }
        } else if (rotation == Surface.ROTATION_180 || rotation == Surface.ROTATION_270) {
            if (orientation == Configuration.ORIENTATION_PORTRAIT) {
                activity.setRequestedOrientation(SCREEN_ORIENTATION_REVERSE_PORTRAIT);
            } else if (orientation == Configuration.ORIENTATION_LANDSCAPE) {
                activity.setRequestedOrientation(SCREEN_ORIENTATION_REVERSE_LANDSCAPE);
            }
        }
    }

    /** Unlocks the device window in user defined screen mode. */
    public static void unlockOrientation(Activity activity) {
        activity.setRequestedOrientation(ActivityInfo.SCREEN_ORIENTATION_USER);
    }

} 
```

* * *

## 回答 #15

> 赞同：5
> 
> 时间：2012-05-14T16:42:12.987

采用：

```
android:configChanges="keyboardHidden|orientation"
android:screenOrientation="portrait" 
```

* * *

## 回答 #16

> 赞同：5
> 
> 时间：2015-02-04T07:23:24.877

您必须设置每个活动的方向。

```
<activity
    android:name="com.example.SplashScreen2"
    android:label="@string/app_name"
    android:screenOrientation="portrait"
    android:theme="@android:style/Theme.Black.NoTitleBar" >
</activity>
<activity
    android:name="com.example.Registration"
    android:label="@string/app_name"
    android:screenOrientation="portrait"
    android:theme="@android:style/Theme.Black.NoTitleBar" >
</activity>
<activity
    android:name="com.example.Verification"
    android:label="@string/app_name"
    android:screenOrientation="portrait"
    android:theme="@android:style/Theme.Black.NoTitleBar" >
</activity>
<activity
    android:name="com.example.WelcomeAlmostDone"
    android:label="@string/app_name"
    android:screenOrientation="portrait"
    android:theme="@android:style/Theme.Black.NoTitleBar" >
</activity>
<activity
    android:name="com.example.PasswordRegistration"
    android:label="@string/app_name"
    android:screenOrientation="portrait"
    android:theme="@android:style/Theme.Black.NoTitleBar" >
</activity> 
```

* * *

## 回答 #17

> 赞同：5
> 
> 时间：2016-03-20T14:52:58.373

如果您使用的是*Xamarin* C#，其中一些解决方案将不起作用。这是我发现可行的解决方案。

```
[Activity(MainLauncher = true, Icon = "@drawable/icon", ScreenOrientation = ScreenOrientation.Portrait)] 
```

上面的类运行良好，类似于其他解决方案。此外，它不是全局适用的，需要放在每个活动标题中。

* * *

## 回答 #18

> 赞同：4
> 
> 时间：2016-01-02T04:54:42.240

在 oncreate() 方法中添加一个类：

```
setRequestedOrientation(ActivityInfo.SCREEN_ORIENTATION_PORTRAIT); 
```

* * *

## 回答 #19

> 赞同：4
> 
> 时间：2017-01-16T06:25:01.260

您可以通过在*manifest.xml*文件中写入以下内容来强制您的特定活动始终保持纵向模式：

```
<activity
    android:name=".MainActivity"
    android:screenOrientation="portrait"></activity> 
```

您还可以通过在活动的 onCreate() 方法中编写以下行来强制活动保持纵向模式：

```
@Override
protected void onCreate(Bundle savedInstanceState) {
    // TODO Auto-generated method stub
    super.onCreate(savedInstanceState);
    setContentView(R.layout.your_layout);
    setRequestedOrientation(ActivityInfo.SCREEN_ORIENTATION_PORTRAIT);
} 
```

* * *

## 回答 #20

> 赞同：4
> 
> 时间：2020-03-20T14:09:51.030

把它放到你的清单中。

```
<activity
    android:name=".MainActivity"
    android:label="@string/app_name"
    android:screenOrientation="sensorPortrait" /> 
```

方向将是纵向的，但如果用户的手机是倒置的，它也会显示正确的方向。（所以你的屏幕会旋转 180 度。）

* * *

如果活动在**多窗口模式下**运行，系统将**忽略**此属性。

 **更多：[https ://developer.android.com/guide/topics/manifest/activity-element](https://developer.android.com/guide/topics/manifest/activity-element)

* * *

## 回答 #21

> 赞同：3
> 
> 时间：2012-09-04T06:30:56.640

```
<android . . . >
    . . .
    <manifest . . . >
        . . .
        <application>
            <activity
                android:name=".MyActivity"
                android:screenOrientation="portrait"
                android:configChanges="keyboardHidden|orientation">
            </activity>
        </application>
    </manifest>
</android> 
```

* * *

## 回答 #22

> 赞同：3
> 
> 时间：2017-07-26T12:03:07.143

```
<?xml version="1.0" encoding="utf-8"?>
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
    package="in.co.nurture.bajajfinserv">
    <uses-permission android:name="android.permission.INTERNET"></uses-permission>

    <application

        android:allowBackup="true"
        android:icon="@mipmap/ic_launcher"
        android:label="@string/app_name"
        android:roundIcon="@mipmap/ic_launcher_round"
        android:supportsRtl="true"
        android:theme="@style/AppTheme">
        <activity android:name=".MainActivity" android:screenOrientation="portrait">

            <intent-filter>
                <action android:name="android.intent.action.MAIN" />

                <category android:name="android.intent.category.LAUNCHER" />
            </intent-filter>
        </activity>
    </application>
</manifest> 
```

我们可以通过使用属性 或 将 Activity 限制为纵向或横向模式`android:screenOrientation`。

如果我们的程序中有多个活动，那么我们可以自由地以任何一种模式限制任何一项活动，并且它永远不会影响您不想要的其他活动。

* * *

## 回答 #23

> 赞同：3
> 
> 时间：2018-05-13T17:23:06.730

在清单类中：

```
<activity android:name=".yourActivity"
    ....
    android:screenOrientation="portrait" /> 
```

或以编程方式：

```
setRequestedOrientation(ActivityInfo.SCREEN_ORIENTATION_PORTRAIT); 
```

**注意：**`setContentView`你应该为你的活动调用这个 before方法`onCreate()`。

* * *

## 回答 #24

> 赞同：3
> 
> 时间：2018-12-27T09:14:12.843

将以下命令添加到您的项目中，

```
npm install

npm i react-native-orientation-locker 
```

然后你使用像 *React_Native (Your Project Folder)/android/app/src/main/AndroidManifest.xml* **这样**的清单类：

```
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
  package="com.payroll_react">

  <uses-permission android:name="android.permission.INTERNET" />
  <uses-permission android:name="android.permission.SYSTEM_ALERT_WINDOW"/>

  <application
    android:name=".MainApplication"
    android:label="@string/app_name"
    android:icon="@mipmap/ic_launcher"
    android:allowBackup="false"
    android:theme="@style/AppTheme">
    <activity
      android:name=".MainActivity"
      android:label="@string/app_name"
      android:screenOrientation="landscape"
      android:configChanges="keyboard|keyboardHidden|orientation|screenSize"
      android:windowSoftInputMode="adjustResize">
      <intent-filter>
          <action android:name="android.intent.action.MAIN" />
          <category android:name="android.intent.category.LAUNCHER" />
      </intent-filter>
    </activity>
    <activity android:name="com.facebook.react.devsupport.DevSettingsActivity" />
  </application>

</manifest> 
```

* * *

## 回答 #25

> 赞同：2
> 
> 时间：2011-09-19T10:46:58.503

在`<apphome>/platform/android`目录中，创建`AndroidManifest.xml`（从生成的目录中复制它）。

然后添加`android:screenOrientation="portrait"`到*所有*活动元素。

* * *

## 回答 #26

> 赞同：2
> 
> 时间：2012-02-01T07:42:51.080

添加**AndroidManifest.xml**文件`android:screenOrientation="portrait"`。

 ****例如：**

```
<activity 
    android:name=".MapScreen"
    android:screenOrientation="portrait"></activity> 
```

* * *

## 回答 #27

> 赞同：2
> 
> 时间：2018-02-06T09:53:20.760

它对我有用。尝试在 AndroidManifest 文件中添加此代码：

```
<application
    android:allowBackup="true"
    android:icon="@mipmap/ic_launcher"
    android:label="@string/app_name"
    android:roundIcon="@mipmap/ic_launcher_round"
    android:supportsRtl="true"
    android:screenOrientation="portrait"
    android:theme="@style/AppTheme">
    ....
    ....
</application> 
```

* * *

## 回答 #28

> 赞同：1
> 
> 时间：2013-07-17T22:53:22.560

*AndroidManifest.xml中**Activity*的以下属性就是您所需要的：

 *```
android:configChanges="orientation" 
```

所以，完整的活动节点：

```
<activity
    android:name="Activity1"
    android:icon="@drawable/icon"
    android:label="App Name"
    android:configChanges="orientation"> 
```

* * *

## 回答 #29

> 赞同：1
> 
> 时间：2017-06-11T15:07:31.550

在[Kotlin](https://en.wikipedia.org/wiki/Kotlin_(programming_language))中，同样可以使用以下代码以编程方式实现：

```
requestedOrientation = ActivityInfo.SCREEN_ORIENTATION_PORTRAIT 
```

* * *

## 回答 #30

> 赞同：0
> 
> 时间：2016-09-22T15:14:09.610

如果您的活动与第一个设备方向状态相关，请在`onCreate`方法中获取当前设备方向，然后永久修复它：

```
int deviceRotation = ((WindowManager) getBaseContext().getSystemService(Context.WINDOW_SERVICE)).getDefaultDisplay().getOrientation();

if(deviceRotation == Surface.ROTATION_0) {
    setRequestedOrientation(ActivityInfo.SCREEN_ORIENTATION_PORTRAIT);
}
else if(deviceRotation == Surface.ROTATION_180)
{
    setRequestedOrientation(ActivityInfo.SCREEN_ORIENTATION_REVERSE_PORTRAIT);
}
else if(deviceRotation == Surface.ROTATION_90)
{
    setRequestedOrientation(ActivityInfo.SCREEN_ORIENTATION_LANDSCAPE);
}
else if(deviceRotation == Surface.ROTATION_270)
{
    setRequestedOrientation(ActivityInfo.SCREEN_ORIENTATION_REVERSE_LANDSCAPE);
} 
```

* * *

## 回答 #31

> 赞同：0
> 
> 时间：2020-07-02T06:46:12.843

添加`android:screenOrientation="portrait"`您的清单。如果您想为特定活动应用模式，请在所需的活动标签中定义它。或者在整个应用程序的*应用程序*标签中定义。像：

```
<application
    <!-- ... -->
    android:screenOrientation="portrait"
</application> 
```

# vb.net - 函数声明中的别名重载？

> ID：582187
> 
> 赞同：0
> 
> 时间：2009-02-24T15:29:44.190
> 
> 标签：vb.net, vb6

我有一些 VB6 代码，我正在转换为 VB.net 并遇到了这个部分

```
Declare Function TmSendByLen Lib "tmctl.dll"  Alias "TmSendByLength"(ByVal id As Integer, ByRef msg As Any, ByVal blen As Integer) As Integer
'snip'

Function TmSendByLength(ByVal id As Integer, ByVal msg As String, ByVal blen As Integer) As Integer
    TmSendByLength = TmSendByLen(id, msg, blen)
End Function 
```

我之前没有遇到过 Alias 术语，但我可以猜到它的作用。我不确定的是重载别名背后的原因。如果这是正在发生的事情。

我需要为 TmSendByLen 函数创建重载，因为 VB.net 不支持“As Any”，所以我不确定是应该删除别名还是应该保留它。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-24T16:06:41.293

Alias 没有指定该函数完全重载，但指定的名称实际上在被调用的 dll 中命名为其他名称。

由于您的示例有点混乱（因为重复的名称），我将使用稍微修改的版本来解释：

```
Declare Function TmSendByLen Lib "tmctl.dll" Alias "TmSendByLength" (ByVal id As Integer, ByRef msg As Any, ByVal blen As Integer) As Integer)

Function InternalVersion(ByVal id As Integer, ByVal msg As String, ByVal blen As Integer) As Integer
    InternalVersion = TmSendByLen(id, msg, blen)
End Function 
```

所以在这个修改后的版本中，这个`TmSendByLength`名字是被引用函数的入口点真正被调用的名字`tmctl.dll`。`TmSendByLen`是我们在代码中所指的内容，并且`InternalVersion`是包装函数的名称。

我想这是`InternalVersion`可以跨模块/类调用的，而该`TmSendByLen`版本是私有的。

为了回答您问题的第二部分，Alias 在 VB.NET 中仍然可用，但`As Any`不是。[（您可以在此处](http://msdn.microsoft.com/en-us/library/4zey12w5.aspx)找到有关它的信息。）是否要删除别名完全取决于您，但无论哪种方式，我怀疑您将需要使用`As IntPtr`（或 SafeHandle）而不是`As Any`.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-24T16:07:43.800

VB6 中的“Alias”关键字*可能*与您认为的一样，但是，关键字“alias”*后面*的引号中的函数名称是 DLL 中的实际函数名称（即 TmSendByLength）。“Declare Function”部分之后的函数名称（即 TmSendByLen）实际上是 VB6 代码将使用的别名。

正如您正确指出的那样，VB6 不允许“As Any”参数类型，因此从您发布的原始 VB6 代码中，开发人员声明了一个 VB6 函数，该函数顺便与 DLL 中的“真实”函数具有完全相同的名称，并更改此函数的参数以仅接受“msg”参数的字符串类型。

原样的 VB6 代码实际上并没有*重载*任何函数，而是用 VB6 特定的约束“msg”参数类型的函数来*包装DLL 函数。*

在 VB.NET 中，由于您不能指定“as any”，我相信您可以将其替换为“as object”，尽管这可能不是很有帮助，因为其他 VB.NET 调用代码几乎可以将任何内容传递给此参数。您更可能想要做的是在 VB.NET 中创建*真正的*重载函数，其中“msg”参数因您要接受的类型而异。这样，您可以允许多种不同的类型，但仍然对可以将哪些类型传递给函数保持一些约束。

这里有几个链接可能会有所帮助：

[VB.Net中的VB6“任意”](http://social.msdn.microsoft.com/Forums/en-US/vbinterop/thread/2c87df7c-48ad-4ab8-a6b8-e0e277eb74ec/)

[调用](http://www.pinvoke.net/)

# ruby-on-rails - Rails：在视图中计数变量

> ID：582188
> 
> 赞同：1
> 
> 时间：2009-02-24T15:29:57.120
> 
> 标签：ruby-on-rails

嘿！我用@lists.each do |list| 遍历一个散列。我在每个必须有 id 的循环中创建一个 div。我会在 PHP 中创建一个计数变量来获得明确的 id。在 Rails 视图中执行此操作的最佳方法是什么？谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-24T15:41:02.010

假设这些是 ActiveRecord 模型（即来自数据库），您可以只使用`dom_id`帮助程序，如下所示：

```
<% @lists.each do |list| %>
  <div id="<%= dom_id(list) %>">
    ... rest of list ...
  </div>
<% end %> 
```

这样每个 div 都会得到一个类似的 ID `list_49`，其编号对应于数据库中的 ID。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-24T15:47:49.950

另一种方法是使用`div_for`助手：

```
<% @lists.each do |list| %>
  <% div_for(list) do %>
    ... content in div ...
  <% end %>
<% end %> 
```

这将添加与卢克建议相同的 id 格式。请注意，它还会添加`list`. 您可以通过传入来添加其他类`:class => 'my-class'`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-24T15:54:36.953

为什么不直接获取列表的 id 呢？或者 id 必须是任何类型的“全球唯一”？

**更新**：我认为你应该接受卢克的回答。

# asp.net - 为什么使用 SSL 时 IE 中的文件上传速度很慢？

> ID：582191
> 
> 赞同：1
> 
> 时间：2009-02-24T15:30:37.870
> 
> 标签：asp.net, ssl, upload, file-upload

男孩，我有一个奇怪的错误。我有一个需要上传大文件的网站。我们使用的是标准的 ASPx FileUpload 控件。我们修改了 web.config 以允许非常大的文件。

我在 FireFox、IE6 和 IE7 中进行所有这些测试。对于我的测试，我使用了几个 20 MB 的文件（AVI、PDF、Excel）。文件类型不影响结果。我可以在所有浏览器中很好地上传这些文件，结果大致相同。每个文件需要 30 到 40 秒。如果我在我的网站上打开 SSL，代码仍然有效，但在 IE 中上传需要 5 到 10 倍的时间。一切正常，只是速度较慢。我使用了文件监视器，看起来 IE 正在读取文件 3 次。FireFox 只读取一次。我还注意到安装了 Office 2003 或 2007 的 PC 上会出现 IE 的这种缓慢情况。

IE 多久重新协商一次 SSL 密钥？我可以改变这个吗？为什么火狐会这么快？我的大多数用户都有 IE，所以这真的很痛苦。

有任何想法吗？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-24T15:38:33.480

我要做的第一件事是启动[fiddler](http://www.fiddlertool.com/fiddler)并观察服务器和浏览器之间的转换，看看行为是否有任何差异。

警告：Fiddler 实际上可以改变 SSL 的工作方式，因此它可能不是完全值得信赖的指南，但它可能会为您提供有关在哪里查看的线索。

# c++ - std::set_difference 中使用的 std:vector 中的断言错误

> ID：582199
> 
> 赞同：0
> 
> 时间：2009-02-24T15:32:47.643
> 
> 标签：c++, visual-studio-2008, stl

我试图找到两个向量的集合差异，所以我做了这样的事情：

```
std::vector<sha1_hash> first_vec, second_vec, difference_vec;

// populate first_vec and second_vec ...

std::sort(first_vec.begin(),first_vec.end());
std::sort(second_vec.begin(),second_vec.end());

std::set_difference(first_vec.begin(),first_vec.end(),
            second_vec.begin(),second_vec.end(),
            difference_vec.begin()); 
```

当我在调试中运行它时，我得到以下运行时断言失败（在“向量”中）：

```
_SCL_SECURE_VALIDATE_RANGE(_Myptr < ((_Myvec *)(this->_Getmycont()))->_Mylast); 
```

我正在使用 VS 2008。关于什么可以触发这个的任何想法？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-24T15:38:11.890

与大多数 c++ 算法一样，set_difference 不会在输出向量中创建以前不存在的新条目。您需要在输出中创建空间来保存结果。

编辑：或使用插入迭代器（未经测试）：

```
 back_insert_iterator< std::vector<sha1_hash> > bi( difference_vec ); 

std::set_difference(first_vec.begin(),first_vec.end(),
            second_vec.begin(),second_vec.end(),
            bi); 
```

# ruby - 使用 Ruby 在标准输入上设置非规范模式

> ID：582200
> 
> 赞同：1
> 
> 时间：2009-02-24T15:33:18.563
> 
> 标签：ruby, terminal, stdin, ioctl

我正在使用 Ruby 制作一个简单的基于终端的游戏，我目前正在尝试想出一种从终端读取输入的方法。

到目前为止，我一直在使用`gets`，但我想让游戏立即做出反应而不需要换行符（所以你不需要按一个键，然后输入）。

我发现我需要将终端置于非规范模式，我假设我可以通过调用`$stdin.ioctl`. 问题是，我不确定我应该传递什么参数或标志，文档和搜索只会导致有关底层 C 函数的信息。

谁能告诉我我应该打电话给我`$stdin.ioctl`吗？我在 OSX Leopard 上使用 Terminal.app/tcsh。

编辑：这就是我最终使用的，感谢 MarkusQ：

```
%x{stty -icanon -echo}
key = STDIN.read(1) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-25T07:15:47.660

您的问题不在红宝石范围内。

最简单的答案：将 IO 包装在 %x{stty -raw echo} 和 %x{stty -raw echo} 中以使用 stty 更改模式。

您可能需要确保退出处理程序以确保在退出时重新设置模式。

——马库斯

# sinatra - 为什么在使用 Rack 和 Phusion Passenger 重新启动 Sinatra 应用程序后第一次请求时出现错误？

> ID：582201
> 
> 赞同：1
> 
> 时间：2009-02-24T15:33:25.100
> 
> 标签：sinatra, passenger, rack, phusion

在我触摸 tmp/restart.txt 并且我的应用程序重新启动后，第一个请求会引发错误，通常是关于找不到 Haml::Engine 或其他一些 gem。第二个和后续请求都可以正常工作。我在运行 Rack 0.4.1 和 Sinatra 0.3.3 的 Dreamhost 上遇到了这个问题，但是在移动到我自己的主机并运行更新的 Rack (0.9.1) 和 Sinatra (0.9.0.4) 之后，我仍然看到了这个问题。

如果您不知道确切的答案，但有关于如何追踪它的提示，请告诉我。

这是我的 config.ru：

```
require 'rubygems'
require 'sinatra'

disable :run
set :environment, :production
set :raise_errors, true

require 'app.rb'
run Sinatra::Application 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-09T14:43:50.603

我会考虑确保您需要所有必要的宝石。也许您正在执行的命令有一些原因导致它第一次失败。你要求`rubygems`吗？

如果您发布了应用程序的机架配置 ( `config.ru`)，它也可能会有所帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-04-21T09:44:13.923

该错误是由 Sinatra gem 加载太晚引起的。这是解决方案：

```
#config.ru

ENV['GEM_HOME'] ||= `gem env path`.strip.split(':').first
ENV['GEM_PATH'] ||= `gem env path`.strip
Gem.clear_paths

需要'应用程序文件名-去这里'
设置：环境，：生产
运行 Sinatra::Application

```

# module - DotNetNuke：博客模块的社交链接

> ID：582209
> 
> 赞同：3
> 
> 时间：2009-02-24T15:34:55.643
> 
> 标签：module, dotnetnuke, blogs, social

为每个博客条目添加社交链接的最佳方法是什么？

我可以使用将链接添加到 ascx 文件的示例代码，或者我什至可以为能够做到这一点的模块支付一些费用。

我将拥有父门户和子门户。

编辑：我已经更新了模块并检查了社交书签选项。然而它没有出现？我错过了什么吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-24T15:39:52.650

我相信这已经内置到核心博客模块中。[DotNetNuke.com](http://www.dotnetnuke.com/Community/Blogs/tabid/825/Default.aspx)上的博客都有社交链接，Antonio 有[一篇博](http://www.dotnetnuke.com/Community/Blogs/tabid/825/EntryId/1865/Upcoming-Blog-Features-Part-1-Social-Bookmarks.aspx)文称它们将使用 3.4.1，当前版本为 3.5.1。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-24T18:49:18.703

您必须升级到博客模块的最新版本，然后在博客的模块选项下，您可以选中“启用社交书签”。或者，使用较旧版本的博客模块，您可以按照[此处](http://www.wwwcoder.com/parentid/224/tabid/68/type/art/site/6525/default.aspx)列出的说明进行操作。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-07-24T15:51:17.043

我使用 ADDTHIS.COM 并将它给我的代码片段放在容器中。

# .net - 如何在运行时更改 LINQ O/RM 表名/源？

> ID：582221
> 
> 赞同：6
> 
> 时间：2009-02-24T15:39:03.543
> 
> 标签：.net, linq, linq-to-sql

我有一个数据库和一个由 O/R-Mapper 创建的实体集，所有这些都与 LINQ 一起使用。

在 O/R-Mapper 中，我需要为每个表输入一个表名（源），该表用于 LINQ 生成的 SQL。在 .dbml 文件中，它看起来像这样：

```
<Table Name="dbo.Customers" Member="Customers"> 
```

现在我想在运行时更改这个表名，因此 SQL 将针对其他一些表运行（例如，customers2008 而不是 customer）。

有没有办法在运行时更改表名（源名）？

[更新]经过一些令我沮丧的测试后，我不得不发现 XmlMappingSource 确实呈现了无法访问数据库中未持久化的计算属性（是的，即使是 SqlMetal 创建的映射也会忽略所有未持久化的内容）。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-24T16:55:58.320

有点......你必须做这样的事情：

1.  在设计器中创建实体。
2.  使用 SqlMetal 从设计器生成的 .dbml 文件生成 xml 映射文件。
3.  更新 xml 文件中的表名。
4.  然后在您的代码中，使用接受使用 xml 映射文件创建的 XmlMappingSource 的 DataContext 构造函数重载。

这是一篇逐步解释此过程的博客文章： [http ://weblogs.asp.net/guybarrette/archive/2008/07/23/linq-to-sql-dynamic-mapping.aspx](http://weblogs.asp.net/guybarrette/archive/2008/07/23/linq-to-sql-dynamic-mapping.aspx)

我正在使用与 ERP 数据库类似的过程，该数据库具有像 ttccom001xxx 这样的表名，其中 xxx 是安装 ID（我知道这是一个可怕的模式，但我对此无能为力）。我们有多个安装，因此我为每个安装复制一次初始 xml 映射，然后将 xxx 替换为安装 ID。我编写了一个小型控制台应用程序，它使用 Regex 来处理替换并将其添加为我的构建过程的一部分。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-24T18:49:17.923

这是 Microsoft 的[External Mapping Reference](http://msdn.microsoft.com/en-us/library/bb386907.aspx)的链接。

> 外部映射覆盖基于属性的映射。

这是要领。

1.  创建一些代表您的映射的 xml。
2.  新建一个[XmlMappingSource](http://msdn.microsoft.com/en-us/library/system.data.linq.mapping.xmlmappingsource_members.aspx)并给它你的 xml。
3.  当您构造 DataContext 时，请使用接受 XmlMappingSource 的构造函数，例如[这个](http://msdn.microsoft.com/en-us/library/bb534562.aspx)。

# asp.net - 使用 HttpModule 访问后台服务中的 Session

> ID：582222
> 
> 赞同：0
> 
> 时间：2009-02-24T15:39:17.130
> 
> 标签：asp.net, background-service

我正在尝试在 asp.net 中创建一个后台服务，该服务检查会话超时并将用户重定向到超时页面（而不是登录页面）。我的代码是这样的

```
public class SessionTimeoutModule : IHttpModule
{
    private static Timer timer;
    //Test value
    private const int interval = 1000 * 1 * 10;

    public void Init( HttpApplication application )
    {
        if ( timer == null )
        {
            timer = new Timer( new TimerCallback( CheckSessionTimeout ),
                         application.Context, 0, interval );
        }
    }

    private void CheckSessionTimeout( object sender )
    {
        HttpContext ctx = (HttpContext)sender;

        if ( ctx.Session != null && ctx.Session.IsNewSession )
        {
            var cookie = ctx.Request.Headers["Cookie"];
            if ( cookie != null )
            {
                if ( cookie.ToUpper().IndexOf( "ASP.NET_SESSIONID" ) >= 0 )
                {
                    ctx.Response.Redirect( "" );
                }
            }
        }
    }

    public void Dispose()
    {
        timer = null;
    }
} 
```

这里的问题是我无法在 CheckSessionTimeout 方法中获取会话值。它始终为空。怎么能在这里得到Session。

我看过[这个](https://stackoverflow.com/questions/276355/can-i-access-session-state-from-an-httpmodule)解决方案，但它没有帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-24T16:21:36.233

恐怕你在这里走错了路。您不能像这样使用 HttpModule 实现后台服务。你传递的 HttpContext 绑定到一个 HTTP 请求，我很确定你不应该像你试图做的那样保留它。此外，即使您可以检测到会话超时，也无法在没有活动请求的情况下将用户重定向到新页面。
您可能会发现[此线程](https://stackoverflow.com/questions/140329/how-can-i-redirect-to-a-page-when-the-user-session-expires/140801#140801)很有帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-24T16:17:18.473

我认为这里有一个逻辑错误，即使您修复了代码，也永远不会结束会话。

如果您可以访问会话，它将有一个 sessionID。通过这种方式，您无法获得以超时结束的会话。

也许你应该使用 global.asax 的 session_end。但我不确定它会有所帮助。

同样[在这里](http://support.microsoft.com/kb/899918)您可以看到，直到 Session.Abandon 才替换 SessionID。

# xml - XSLT 映射算法

> ID：582223
> 
> 赞同：2
> 
> 时间：2009-02-24T15:39:50.640
> 
> 标签：xml, algorithm, xslt, abstract

我有一个特殊的问题，我不知道如何解决。在办公室，我们有一个庞大而笨拙的 XSLT，用于将一种类型的 XML 适配到另一种类型。问题是它不是很一致地编写并且很难遵循。在这个样式表的古老创作中，似乎忘记了它的确切作用。

有没有办法以人类可读的格式轻松绘制出巨型 XSLT 的功能？即每个可能的输入 -> 每个可能的输出。我们无法创建一个包罗万象的输入文档，因为适配器对不同的输入有不同的行为（我们估计需要 100 多个输入文档才能覆盖所有可能的输出）

任何建议都将受到欢迎。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-24T15:49:47.620

分解它——将 xsl 执行语句移动到文档内的 xsl 模板。通过这样做，您将自上而下地对文档有更合理的理解。

如果它是如此的巨大以至于让你无法理解它，这听起来就像你有一个重构决定摆在你面前：这个文档是否如此重要以至于我们需要知道它的作用（并了解它是如何工作的——因此需要一些返工），还是我们可以照原样接受它？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-24T15:49:50.037

你了解你的输入文件吗？

如果是，则跳过下一句否则否：-

那么您无法测试任何由此产生的 XSLT 重构，因此您需要回答这个问题，是的。

你了解你的输出文件吗？

如果是，则跳过下一句否则否：-

那么您就无法测试任何由此产生的 XSLT 重构，因此您需要回答这个问题，是的。

既然这两个问题的答案都是肯定的，那么放弃 XSLT 并构建您可以理解的东西。你知道输入是什么，你知道你想要什么输出，经典的冯纽曼（他们现在还教这个吗？）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-24T17:22:05.930

**通常这是不可能完成的任务——对于任何编程语言！**

[**这是由于停止问题**](http://en.wikipedia.org/wiki/Halting_problem)的不确定性。

因此，您可能会付出巨大的努力来尝试做一些被证明是不可能的事情。

**我的建议** **是编写自己的解决方案**，遵循最佳编程实践，使用单元测试，如果可能的话使用正确性证明。XSLT 作为一种函数式语言更适合证明正确性。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-24T15:49:27.403

这很可能不会对您有所帮助。但我会分享我的经验。

我只是在昨天才对 XSLT 进行自我治疗，当时我遇到了同样的问题，试图弄清楚 XSLT 规范在解析时所说的内容。为了帮助自己，我所做的是在原始 XSL 中添加了几个函数（xsl:template's，有点迂腐）。接下来，我通过浏览器运行它，瞧，我对 DFS 有了清晰的了解。

我创建了以下内容：

```
<xsl:template name="print">
<xsl:param name="message"/>
<xsl:param name="elem"/>
<div class="ArticleBody">
  <br/>
  <xsl:value-of select="$message"/>: <xsl:value-of select="$elem"/> ... <br/>
</div> 
```

模板是工作人员，`print`序言和尾声只是`print`使用自定义字符串调用。

我将原始 XSL 文件从以下位置更改：

```
<xsl:template match="db:para">
 <xsl:apply-templates/>
</xsl:template> 
```

到：

```
<xsl:template match="db:para">
 <xsl:call-template name="prologue">
   <xsl:with-param name="item" select="'para'"/>
 </xsl:call-template>
 <xsl:apply-templates/>
 <xsl:call-template name="epilogue">
  <xsl:with-param name="item" select="'para'"/>
 </xsl:call-template> 
```

现在，当每个节点都被处理时，我会得到一个输出：

```
start-processing: article ... 
```

当它完成时

```
end-processing: article ... 
```

我也加入了一些 CSS（在处理根节点时），只是为了让事情看起来不错。这让我很开心:)

# wpf - 可编辑组合框

> ID：582232
> 
> 赞同：6
> 
> 时间：2009-02-24T15:41:14.583
> 
> 标签：wpf, combobox, wpf-controls

我想创建具有以下属性的可编辑组合框：

1.  将文本属性绑定到我的数据模型。
2.  数据模型可能会覆盖 GUI 中的更改，即使在选择更改时也是如此。例如，我可以从 1、2、3 中进行选择，我选择 2，但下方的某些组件将其更改为 3。
3.  更新以下事件的数据模型：

    1.  选择已更改
    2.  失去焦点
    3.  按下 Enter（应该与失去焦点的行为相同）。

我已经能够创建这样的控件，但它非常丑陋（使用了许多 hack），我希望有一种更简单的方法……</p>

提前致谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-08T09:00:41.263

好的，这就是我所做的，它并没有那么难看：

```
 /// <summary>
/// Editable combo box which updates the data model on the following:
/// 1\. Select## Heading ##ion changed
/// 2\. Lost focus
/// 3\. Enter or Return pressed
/// 
/// In order for this to work, the EditableComboBox requires the follows, when binding:
/// The data model value should be bounded to the Text property of the ComboBox
/// The binding expression UpdateSourceTrigger property should be set to LostFocus
/// e.g. in XAML:
/// <PmsEditableComboBox Text="{Binding Path=MyValue, UpdateSourceTrigger=LostFocus}"
/// ItemsSource="{Binding Path=MyMenu}"/>
/// </summary>
public class PmsEditableComboBox : ComboBox
{
    /// <summary>
    /// Initializes a new instance of the <see cref="PmsEditableComboBox"/> class.
    /// </summary>
    public PmsEditableComboBox()
        : base()
    {
        // When TextSearch enabled we'll get some unwanted behaviour when typing
        // (i.e. the content is taken from the DropDown instead from the text)
        IsTextSearchEnabled = false;
        IsEditable = true;
    }

    /// <summary>
    /// Use KeyUp and not KeyDown because when the DropDown is opened and Enter is pressed
    /// We'll get only KeyUp event
    /// </summary>
    protected override void OnKeyUp(KeyEventArgs e)
    {
        base.OnKeyUp(e);

        // Update binding source on Enter
        if (e.Key == Key.Return || e.Key == Key.Enter)
        {
            UpdateDataSource();
        }
    }

    /// <summary>
    /// The Text property binding will be updated when selection changes
    /// </summary>
    protected override void OnSelectionChanged(SelectionChangedEventArgs e)
    {
        base.OnSelectionChanged(e);
        UpdateDataSource();
    }

    /// <summary>
    /// Updates the data source.
    /// </summary>
    private void UpdateDataSource()
    {
        BindingExpression expression = GetBindingExpression(ComboBox.TextProperty);
        if (expression != null)
        {
            expression.UpdateSource();
        }
    }

} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-11T12:14:00.773

最简单的方法是在绑定上使用 UpdateSourceTrigger 属性。您可能无法完全匹配您当前的行为，但您可能会发现它具有可比性。

UpdateSourceTrigger 属性控制绑定的目标何时更新源。不同的 WPF 控件在绑定时对该属性有不同的默认值。

以下是您的选择：

UpdateSourceTrigger.Default = 允许目标控件确定 UpdateSourceTrigger 模式。

UpdateSourceTrigger.Explicit = 仅在有人调用 BindingExpression.UpdateSource() 时更新源；

UpdateSourceTrigger.LostFocus = 每当目标失去焦点时自动更新绑定源。这样可以完成更改，然后在用户继续移动后更新绑定。

UpdateSourceTrigger.PropertyChanged = 每当目标上的 DependencyProperty 更改值时，源都会立即更新。大多数用户控件不默认使用此属性，因为它需要更多绑定更新（可能是性能问题）。

# html - 如何让绝对定位的 div 扩展到其相对定位的父级之外，该父级具有溢出：自动？

> ID：582233
> 
> 赞同：43
> 
> 时间：2009-02-24T15:41:16.877
> 
> 标签：html, css

我有一个相对定位的 div，它已经`overflow: auto`设置好了。在里面，我有一个 div ，它充当一种下拉菜单。我希望下拉 div 在需要时扩展到父级之外，但它正在被裁剪，因为父级有`overflow: auto`.

我意识到这是正确的行为，但我不确定如何实现我想要的。下面是一些说明问题的 HTML 示例：

```
<div style="position: relative; height: 100px; width: 100px; background: red; overflow: auto;">  

    <div style="position: absolute; top: 20px; left: 20px; height: 100px; width: 100px; background: green;">
    </div>

</div>
```

自己的 div 在上下文中与 div 中的其他内容相关`overflow: auto`，因此将它们放在一起是有意义的。我想我可以使用 javascript 将下拉 div 移动到 DOM 的另一部分，但如果可以避免的话，我宁愿不这样做。

* * *

## 回答 #1

> 赞同：58
> 
> 时间：2009-03-04T15:36:05.260

你的问题是位置：相对父母。由于您在元素上具有该定位，因此内部框将始终保持在溢出内（位置：绝对是相对于最近的定位父级）。

为避免此问题，您可以从外部 div 中删除“position:relative”，并添加一个带有“position:relative;”的包装 div。然后你必须添加“top:0;” 向您的内部 div 声明（实际上，您应该始终拥有它）。

最终结果是一个额外的 div，它看起来像这样：（你可以删除 "z-index:-1" 样式，我只是添加了这样你可以更好地看到结果）

```
<div style="position:relative;border:1px solid blue;">
    <div style="height: 100px; width: 100px; background: red; overflow: auto;">
        if there is some really long content here, it will cause overflow, but the green box will not
        <div style="position:absolute; z-index:-1; left: 20px; top:0; height: 200px; width: 200px; background: green;">
        </div>
    </div>
</div>
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-24T16:42:57.320

> 我不确定如何实现我想要的。

我也不是——更多关于你想要什么的信息？

将具有溢出的元素与具有“位置：相对”的元素分开可能是一个好主意，特别是如果它仅用于定位内部的绝对值。

```
<div style="position: relative;">
    <div style="height: 100px; width: 100px; background: red; overflow: auto;">...</div>
    <div style="position: absolute; top: 20px; left: 20px; height: 100px; width: 100px; background: green;">...</div>
</div> 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-03-04T14:02:47.950

鉴于您的规格，这是我能想到的最好的：

```
<div style="position: relative; height: 100px; width: 100px; background: red;">
    <div style="height: 100px; width: 100px; overflow: auto;">Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat.</div>
    <div style="position: absolute; top: 20px; left: 20px; height: 100px; width: 100px; background: green;"></div>
</div> 
```

那里有你的 div，`overflow: auto;`所以如果需要，滚动条会出现，下拉 div 看起来像是在“在它的父级之外”扩展。两者都保存在同一个父 div 下，正如您所说，它们在上下文中彼此相关。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-03-05T23:46:12.783

您使用内部 div 的绝对定位来相对于外部 div 定位它，但您不希望它的内容算作外部 div 内容。为此，您需要将内部 div 位置与内部 div 内容分开。您可以尝试通过将内容放入固定 div 来做到这一点。

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" xmlns:v="urn:schemas-microsoft-com:vml" xmlns:o="urn:schemas-microsoft-com:office:office">
<head> <title>Test</title> </head>

<body>

<div style="position: relative; height: 100px; width: 100px; background: red; overflow: auto;">
        <div style="position: absolute; top: 20px; left: 20px; height: 10px; width: 10px;">
            <div style="position: fixed; height: 100px; width: 100px; background: green;"></div>
        </div>
</div>

</body>
</html> 
```

诀窍是没有指定顶部/底部/左侧/右侧的固定 div 会将自身定位在其“静态”位置，这似乎是您所需要的。

您可能对 z-order 有疑问，但是，根据您的解释，您确实希望您的“菜单”高于一切。（我假设它来来去去）。您肯定会在打印页面时遇到问题 - 如果页面超过一页，固定元素会重复出现。

正如 jvenema 所指出的，这在 IE6 中不起作用。:(

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-03-06T02:38:59.357

这不可能。如果您`overflow:auto`在父 DIV 上进行设置，则会锁定任何子 DIV 以防跳出内容框。

您可以尝试摆弄`z-index`价值观，但这可能会导致您的左眼失明。

一个想法是用另一个 DIV 包装父 DIV，以便您要弹出的 DIV 将根据祖父 DIV 定位。但是这种方式会给你腕管，也不会工作，因为你必须知道你希望子 DIV 在父 DIV 流中的哪个位置。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-24T17:58:53.800

只需删除**overflow: auto**部分并使用结束标记正确关闭内部 div，这样它就可以在 IE6、IE7、Firefox 3 和 Opera => 可能所有浏览器中工作。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-04T15:18:57.407

我会说它对上下文敏感的事实是导致您出现问题的原因。也许你可以重组它的设置方式？我有一个父 div 类，它为这两个提供上下文，并让它们在这个 div 内彼此分开（使用相对定位来根据需要对齐它们？）

我的2c

* * *

## 回答 #8

> 赞同：-3
> 
> 时间：2009-02-24T17:33:23.470

尝试使用溢出：可见；反而。

# django - 在 Django 中，不能在 ManyToManyField 上使用字符串连接吗？ManyToMany 不只是一个列表吗？

> ID：582237
> 
> 赞同：5
> 
> 时间：2009-02-24T15:41:33.490
> 
> 标签：django, django-models

我的 Django 项目中有两个模型：

*   匹配
*   播放器

Match 有一个指向玩家的 ManyToMany 属性，因此多个玩家可以在一场比赛中竞争。我想在 Django 管理员中返回一个信息丰富的对象名称，例如“Richard Henry vs John Doe”，通过使用玩家全名的连接。但是以下失败：

```
class Match(models.Model):
    players = models.ManyToManyField(Player, verbose_name='Competitors')

    def __unicode__(self):
        return " vs ".join(self.players) 
```

ManyToManyFields 不只是列表吗？为什么我不能加入他们？任何输入表示赞赏。这是我的播放器模型，以防有帮助：

```
class Player(models.Model):
    full_name = models.CharField(max_length=30)

    def __unicode__(self):
        return "%s" % self.full_name 
```

谢谢！

**编辑**：我刚刚发现我可以使用`self.players.list_display`它作为列表返回。我不再吐出回溯，但由于某种原因，`__unicode__`名称现在返回`None`. 知道为什么会这样吗？

**编辑2**：更改代码：

```
class Match(models.Model):
    players = models.ManyToManyField(Player, verbose_name='Competitors')

    def __unicode__(self):
        return " vs ".join(self.players.list_display) 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2010-07-08T13:11:20.897

另一种选择是：

```
return " vs ".join(p.full_name for p in self.players.all()) 
```

注意：很抱歉把这个带回来——掘墓人:-)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-02-24T15:48:44.127

“ManyToManyFields 不只是列表吗？”

不。

它们是[查询集](http://docs.djangoproject.com/en/dev/ref/models/querysets/#queryset-api-reference)。哪些类似于列表，但实际上不是列表。

做这个。

```
return " vs ".join(list(self.players)) 
```

list 函数将强制评估查询集并返回一个列表对象。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-24T15:50:59.380

不，ManyToManyField 不是一个列表，它只是一个键，并且比赛中的每个玩家都会有一个 Match 实例。

您不想在 __unicode__() 方法中进行查询，因为它很可能会对性能造成很大影响。只需在模板中显示 X 与 Y。

# html - 是否有 W3C 有效的方法来禁用 HTML 表单中的自动完成功能？

> ID：582244
> 
> 赞同：430
> 
> 时间：2009-02-24T15:43:33.297
> 
> 标签：html, standards, forms, w3c

使用`xhtml1-transitional.dtd`doctype 时，使用以下 HTML 收集信用卡号

```
<input type="text" id="cardNumber" name="cardNumber" autocomplete='off'/> 
```

将在 W3C 验证器上标记警告：

> 没有属性“自动完成”。

是否有 W3C / 标准方法来禁用表单中敏感字段的浏览器自动完成功能？

* * *

## 回答 #1

> 赞同：426
> 
> 时间：2009-02-24T15:52:49.233

[这](https://developer.mozilla.org/En/How_to_Turn_Off_Form_Autocompletion)是 MDC 的一篇好文章，它解释了形成自动完成的问题（和解决方案）。微软也在[这里](http://msdn.microsoft.com/en-us/library/ms533032(VS.85).aspx)发布了类似的东西。

老实说，如果这对您的用户来说很重要，那么以这种方式“打破”标准似乎是合适的。例如，亚马逊使用了很多“自动完成”属性，它似乎运作良好。

如果要完全删除警告，可以使用 JavaScript 将属性应用到支持它的浏览器（IE 和 Firefox 是重要的浏览器），使用`someForm.setAttribute( "autocomplete", "off" ); someFormElm.setAttribute( "autocomplete", "off" );`

最后，如果您的网站使用 HTTPS，IE 会自动关闭自动完成功能（据我所知，其他一些浏览器也是如此）。

**更新**

由于这个答案仍然得到不少赞成，我只想指出，在 HTML5 中，您可以在表单元素上使用“自动完成”属性。请参阅 W3C 上的[文档](http://www.w3.org/wiki/HTML/Elements/input/text)。

* * *

## 回答 #2

> 赞同：64
> 
> 时间：2009-02-24T15:47:24.163

如果 W3C 会提出一种适用于 (X)HTML4 的方法，我会感到非常惊讶。自动完成功能完全基于浏览器，并且是在过去几年中引入的（远在编写 HTML4 标准之后）。

不过，如果 HTML5 有一个，也不会感到惊讶。

*编辑：*正如我所想，[HTML5**确实**具有该](http://www.w3.org/TR/html5/forms.html#attr-form-autocomplete)功能。要将您的页面定义为 HTML5，请使用以下文档类型（即：将其作为源代码中的第一个文本）。请注意，并非所有浏览器都支持此标准，因为它仍处于草稿形式。

```
<!DOCTYPE html> 
```

* * *

## 回答 #3

> 赞同：58
> 
> 时间：2009-02-24T15:55:51.707

**HTML 4**：否

**HTML 5**：是的

> autocomplete 属性是一个枚举属性。该属性有两种状态。**on**关键字映射到 on 状态，off**关键字** 映射到 off 状态。该属性也可以省略。缺失值默认为**开启**状态。**off**状态表示默认情况下，表单中的表单控件将其自动填充字段名称设置为**off**；on 状态表示默认情况下，表单中的表单控件将其`autofill`字段名称设置为“on”。

参考：[W3](http://www.w3.org/TR/html5/forms.html#attr-form-autocomplete)

* * *

## 回答 #4

> 赞同：32
> 
> 时间：2009-02-24T15:48:41.960

不会，但浏览器自动完成通常由与`name`之前填写的字段具有相同属性的字段触发。如果您可以设计一种巧妙的方法来获得**随机字段名称**，那么自动完成功能将无法提取该字段之前输入的任何值。

如果您要为输入字段命名为“ `email_<?= randomNumber() ?>`”，然后让接收此数据的脚本通过 POST 或 GET 变量循环查找与模式“ `email_[some number]`”匹配的内容，您可以将其取消，这将具有 (实际上）保证成功，**无论浏览器如何**。

* * *

## 回答 #5

> 赞同：31
> 
> 时间：2009-02-24T15:48:45.047

不，**[Mozila Wiki](https://wiki.mozilla.org/The_autocomplete_attribute_and_web_documents_using_XHTML)**中有一篇好文章。

我会继续使用无效的`attribute`. 我认为这是实用主义应该战胜验证的地方。

* * *

## 回答 #6

> 赞同：23
> 
> 时间：2009-02-24T15:57:49.533

用 JavaScript 设置它怎么样？

```
var e = document.getElementById('cardNumber');
e.autocomplete = 'off'; // Maybe should be false 
```

它并不完美，但您的 HTML 将是有效的。

* * *

## 回答 #7

> 赞同：19
> 
> 时间：2010-09-07T21:30:55.957

我建议捕获所有 4 种类型的输入：

```
$('form,input,select,textarea').attr("autocomplete", "off"); 
```

参考：

*   [http://www.w3.org/Submission/web-forms2/#the-autocomplete](http://www.w3.org/Submission/web-forms2/#the-autocomplete)
*   [http://dev.w3.org/html5/markup/input.html](http://dev.w3.org/html5/markup/input.html)

* * *

## 回答 #8

> 赞同：11
> 
> 时间：2010-08-10T16:44:08.433

如果你使用 jQuery，你可以这样做：

```
$(document).ready(function(){$("input.autocompleteOff").attr("autocomplete","off");}); 
```

并在你想要的地方使用 autocompleteOff 类：

```
<input type="text" name="fieldName" id="fieldId" class="firstCSSClass otherCSSClass autocompleteOff" /> 
```

如果您希望所有输入都是`autocomplete=off`，您可以简单地使用它：

```
$(document).ready(function(){$("input").attr("autocomplete","off");}); 
```

* * *

## 回答 #9

> 赞同：8
> 
> 时间：2012-05-15T08:21:29.857

另一种方法 - 也有助于提高安全性，是每次显示输入框时都给输入框起不同的名称：就像 captha 一样。这样，会话可以读取一次性输入，并且自动完成没有什么可继续的。

关于 rmeador 关于您是否应该干扰浏览器体验的问题的一点：我们开发联系人管理和 CRM 系统，当您将其他人的数据输入到表单中时，您不希望它不断地提示您自己的详细信息。

这可以满足我们的需求，但是我们可以告诉用户获得一个像样的浏览器:)

```
autocomplete='off' 
```

* * *

## 回答 #10

> 赞同：8
> 
> 时间：2014-07-11T21:16:28.660

`autocomplete="off"`这应该可以解决所有现代浏览器的问题。

```
<form name="form1" id="form1" method="post" autocomplete="off"
   action="http://www.example.com/form.cgi">
  [...]
</form> 
```

在当前版本的 Gecko 浏览器中，自动完成属性可以完美运行。对于较早的版本，回到 Netscape 6.2，它可以处理带有“地址”和“名称”的表单的例外情况

**更新**

在某些情况下，即使自动完成属性设置为关闭，浏览器也会继续建议自动完成值。这种意想不到的行为可能会让开发人员感到非常困惑。真正强制不自动完成的技巧是为**属性分配一个随机字符串**，例如：

```
autocomplete="nope" 
```

由于这个随机值不是 a `valid one`，浏览器会放弃。

[文档](https://developer.mozilla.org/en-US/docs/Mozilla/How_to_Turn_Off_Form_Autocompletion#How_to_Turn_Off_the_Autocompletion_Feature)

* * *

## 回答 #11

> 赞同：6
> 
> 时间：2012-01-22T21:05:22.163

使用随机的“名称”属性对我有用。

我在发送表单时重置了名称属性，因此在发送表单时您仍然可以通过名称访问它。（使用 id 属性存储名称）

* * *

## 回答 #12

> 赞同：5
> 
> 时间：2013-02-07T11:22:54.003

请注意，关于自动完成属性的位置存在一些混淆。它可以应用于整个 FORM 标记或单个 INPUT 标记，这在 HTML5 之前并没有真正标准化（明确允许[两个](http://www.w3.org/TR/html5/forms.html#the-autocomplete-attribute) [位置](http://www.w3.org/TR/html5/forms.html#the-form-element)）。较早的文档最值得注意的是这篇[Mozilla 文章](https://developer.mozilla.org/en-US/docs/Mozilla/How_to_Turn_Off_Form_Autocompletion)只提到了 FORM 标签。同时，一些安全扫描器只会在 INPUT 标签中寻找自动完成功能，并在它丢失时抱怨（即使它**在**父 FORM 中）。此处发布了对这种混乱的更详细分析：[混淆 HTML 表单中的 AUTOCOMPLETE=OFF 属性](http://ipsec.pl/node/1089)。

* * *

## 回答 #13

> 赞同：3
> 
> 时间：2009-02-24T15:49:54.077

不理想，但您可以在每次渲染时更改文本框的 id 和名称 - 您还必须在服务器端跟踪它，以便将数据取出。

不确定这是否可行，只是一个想法。

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2011-08-01T00:43:39.087

我认为有一个更简单的方法。使用随机名称（通过 javascript）创建一个隐藏输入并将用户名设置为该名称。重复密码。这样，您的后端脚本就可以准确地知道适当的字段名称是什么，同时保持自动完成功能在黑暗中。

我可能错了，但这只是一个想法。

* * *

## 回答 #15

> 赞同：2
> 
> 时间：2013-12-31T21:31:09.360

```
if (document.getElementsByTagName) {
    var inputElements = document.getElementsByTagName("input");
    for (i=0; inputElements[i]; i++) {
        if (inputElements[i].className && (inputElements[i].className.indexOf("disableAutoComplete") != -1)) {
            inputElements[i].setAttribute("autocomplete","off");
        }
    }
} 
```

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2020-10-21T21:14:59.390

我在 2020 年完成了这项工作！

我基本上创建了一个 css 类，将 -webkit-text-security 应用于我的输入。

这是最近讨论的链接： [https ://stackoverflow.com/a/64471795/8754782](https://stackoverflow.com/a/64471795/8754782)

* * *

## 回答 #17

> 赞同：-1
> 
> 时间：2018-10-18T03:08:04.517

此解决方案适用于我：

```
$('form,input,select,textarea').attr("autocomplete", "nope"); 
```

如果你想在这个区域使用自动填充：添加`autocomplete="false"`元素 ex：

```
<input id="search" name="search" type="text" placeholder="Name or Code" autcomplete="false"> 
```

* * *

## 回答 #18

> 赞同：-5
> 
> 时间：2010-04-09T15:31:48.090

## 有效的自动完成关闭

```
<script type="text/javascript">
    /* <![CDATA[ */
    document.write('<input type="text" id="cardNumber" name="cardNumber" autocom'+'plete="off"/>');
    /* ]]> */ 
</script> 
```

# java - 您如何管理 java webapps 中的嵌入式配置文件和库？

> ID：582248
> 
> 赞同：15
> 
> 时间：2009-02-24T15:44:53.060
> 
> 标签：java, deployment, jakarta-ee, web-applications, war

我目前正在从事一个已经处于测试阶段的 j2ee 项目。现在，我们只是在解决部署过程中的一些问题。具体来说，战争中嵌入了许多文件（一些 xml 文件和 .properties），需要根据您是在开发、测试还是生产环境中部署不同的版本。诸如日志级别、连接池等的东西。

所以我想知道这里的开发人员如何构建他们部署 web 应用程序的过程。您是否将尽可能多的配置卸载到应用程序服务器？您是否在部署之前以编程方式替换设置文件？在构建过程中选择一个版本？手动编辑战争？

此外，您在通过应用程序服务器的静态库提供依赖项方面走了多远，您自己在战争中投入了多少？所有这些只是为了了解目前常见的（或者可能是最佳的）实践是什么。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-24T15:50:40.567

我认为如果属性是特定于机器/部署的，那么它们属于机器。如果我要在战争中结束一切，它应该是可放置的，这意味着它没有特定于运行它的机器。如果战争中有机器相关的属性，这个想法就会被打破。

我喜欢做的是用 properties.example 文件构建一个项目，每台机器都有一个 .properties，它位于战争可以访问的地方。

另一种方法是使用 ant 任务，例如 dev-war、stage-war、prod-war，并将项目的属性集包含在 war-build 中。我不太喜欢这样，因为作为项目构建的一部分，您最终将在单个服务器上拥有诸如文件位置之类的东西。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-02-25T03:19:58.350

我在一个单独的服务器团队为我们的应用程序执行 QA 和生产服务器配置的环境中工作。每个应用程序通常部署在 QA 中的两台服务器和生产中的三台服务器上。我的开发团队发现，最好通过将尽可能多的配置放入战争（或耳朵）中来最大限度地减少服务器上所需的配置量。这使得服务器配置更容易，并且还最大限度地减少了服务器团队错误配置服务器的机会。

我们没有特定于机器的配置，但我们有特定于环境的配置（Dev、QA 和 Production）。我们将配置文件存储在按环境命名的 war 文件中（例如 dev.properties、qa.properties、prod.properties）。我们在服务器 VM 的 java 命令行上放置了一个 -D 属性来指定环境（例如 java -Dapp.env=prod ...）。应用程序可以查找 app.env 系统属性并使用它来确定要使用的属性文件的名称。

我想如果您有少量特定于机器的属性，那么您也可以将它们指定为 -D 属性。Commons Configuration 提供了一种将属性文件与系统属性结合起来的简单方法。

我们在服务器上配置连接池。我们为每个环境命名相同的连接池，并将分配给每个环境的服务器指向适当的数据库。应用程序只需要知道一个连接池名称。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-02-25T04:34:47.750

wrt 配置文件，我认为[史蒂夫的](https://stackoverflow.com/questions/582248/how-do-you-manage-embedded-configuration-files-and-libraries-in-java-webapps/582279#582279)答案是迄今为止最好的答案。我会添加使外部文件相对于 war 文件的安装路径的建议 - 这样您就可以在具有不同配置的一台服务器上安装多个 war。

例如，如果我`dev.war`的解压到`/opt/tomcat/webapps/dev`.，那么我将使用[`ServletContext.getRealPath`](http://java.sun.com/javaee/5/docs/api/javax/servlet/ServletContext.html#getRealPath(java.lang.String))来查找基本文件夹和 war 文件夹名称，因此配置文件将`../../config/dev`相对于 war 或`/opt/tomcat/config/dev`绝对存在。

我也同意[Bill](https://stackoverflow.com/questions/582248/how-do-you-manage-embedded-configuration-files-and-libraries-in-java-webapps/584589#584589)关于尽可能少地放入这些外部配置文件的观点。根据您的环境使用数据库或 JMX 来存储尽可能多的数据。Apache Commons Configuration 有一个[很好的对象](http://commons.apache.org/configuration/apidocs/org/apache/commons/configuration/DatabaseConfiguration.html)来处理由数据库表支持的配置。

关于库，我同意[unknown](https://stackoverflow.com/questions/582248/how-do-you-manage-embedded-configuration-files-and-libraries-in-java-webapps/584504#584504)将所有库都放在`WEB-INF/lib`war 文件（自打包）的文件夹中。优点是应用程序的每次安装都是自主的，并且您可能同时使用不同版本的库来构建不同的战争。

缺点是它将使用更多内存，因为每个 Web 应用程序都有自己的类副本，由其自己的类加载器加载。

如果这引起了真正的担忧，那么您可以将 jar 放在您的 servlet 容器（`$CATALINA_HOME/lib`用于 tomcat）的公共库文件夹中。但是，在同一台服务器上运行的所有 Web 应用程序安装都必须使用相同版本的库。（实际上，这并不完全正确，因为您可以在必要时将覆盖版本放在单个`WEB-INF/lib`文件夹中，但是维护起来非常麻烦。）

在这种情况下，我将为公共库构建一个自动安装程序，使用 InstallShield 或[NSIS](http://nsis.sourceforge.net/)或等效于您的操作系统。可以轻松判断您是否拥有最新的库集，以及升级、降级等。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-25T02:28:47.053

我通常制作两个属性文件：

*   一个用于嵌入在应用程序中的应用程序细节（消息、内部“神奇”词），
*   另一个用于环境细节（数据库访问、日志级别和路径......）在每个服务器的类路径上公开并“粘贴”（未随我的应用程序提供）。通常我“mavenise”或“anttise”这些以放置特定值，具体取决于目标环境。
*   很酷的家伙使用 JMX 来维护他们的应用程序配置（配置可以实时修改，无需重新部署），但它对我的需求来说太复杂了。

服务器（静态？）库：我强烈反对在我的应用程序中使用服务器库，因为它增加了对服务器的依赖：

1.  IMO，我的应用程序必须是“自打包的”：放弃我的战争，仅此而已。我见过有 20 Mbs 罐子的战争，这对我来说并不令人不安。
2.  一个常见的最佳实践是将您的外部依赖限制在 J2EE 教条所提供的范围内：J2EE API（使用 Servlet、Ejbs、Jndi、JMX、JMS...）。您的应用程序必须是“与服务器无关的”。
3.  将依赖项放入您的应用程序（war、ear、wathever）是自我记录：您知道您的应用程序依赖于哪些库。使用服务器库，您必须清楚地记录这些依赖关系，因为它们不太明显（很快您的开发人员就会忘记这个小魔法）。
4.  如果您升级您的应用服务器，您所依赖的服务器库也可能会发生变化。AppServer 编辑器不应该在其内部库上保持版本与版本之间的兼容性（而且大多数时候，他们不会）。
5.  如果您使用嵌入在您的 appServer 中的广泛使用的库（想到 jakarta commons logging，又名 jcl）并且想要升级它的版本以获得最新功能，您将承担 appServer 不支持它的巨大风险。
6.  如果您依赖于静态服务器对象（在服务器类的静态字段中，例如 Map 或日志），则必须重新启动应用服务器以清除此对象。您失去了热重新部署应用程序的能力（旧的服务器对象在重新部署之间仍然存在）。使用 appServer 范围的对象（J2EE 定义的对象除外）可能会导致细微的错误，特别是如果该对象在多个应用程序之间共享时。这就是为什么我强烈反对使用驻留在 appServer 库的静态字段中的对象。

如果您绝对需要“此应用程序服务器的 jar 中的此对象”，请尝试将 jar 复制到您的应用程序中，希望不依赖其他服务器的 jar，并检查您的应用程序的类加载策略（我习惯将“父级”放在最后一个类加载我所有应用程序的政策：我确信我不会被服务器的罐子“污染” - 但我不知道这是否是“最佳实践”）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-24T18:55:22.773

我将所有配置都放入数据库中。容器（Tomcat、WebSphere 等）让我可以访问初始数据库连接，从那时起，一切都来自数据库。这允许多个环境、集群和动态更改而无需停机（或至少无需重新部署）。特别好的是能够动态更改日志级别（尽管您需要管理屏幕或后台刷新来获取更改）。显然，这仅适用于启动应用程序不需要的东西，但通常，您可以在启动后很快进入数据库。

# asp.net - 我应该在 Page 对象中的哪里实现功能 - 构造函数或 OnPreInit？

> ID：582250
> 
> 赞同：3
> 
> 时间：2009-02-24T15:45:29.440
> 
> 标签：asp.net, constructor, onpreinit

我一直在思考的一个问题 - Stackoverflow 用户通常会在构造函数中实现重要的功能（特别是在派生自 System.Web.UI.Page 类的类中），还是应该让这里的逻辑尽可能简单并且而是在 OnPreInit 中实现功能（使用构造函数简单地实例化页面其余部分功能所需的对象/值）？这种情况是否有“最佳实践”方法？

这个问题的背景：

我正在处理的系统具有相当深的页面层次结构 - 实际页面派生自大约 10 个链接的页面对象：

```
-- System.Web.UI.Page
----- CustomPage1 : System.Web.UI.Page
-------- CustomPage2 : CustomPage1
-  -  -  -  -  ETC

```

每个页面都添加了一个特定的功能，并且通常依赖于自定义页面构造函数中运行的代码，或者功能本身在构建期间直接运行。

最能说明我的问题的示例是将自定义对象从我们的数据库加载到页面的页面，以便它们在页面生命周期中可用 - 在页面构建期间，与数据库建立连接，然后使用正确的值填充公共属性。

在我看来，这最好从 OnPreInit 事件中完成，主要是因为我们在父逻辑运行之前有更大的灵活性来执行一些页面级别的检查（例如，我们是否应该阻止调用此功能）（假设在构造函数中的顺序执行将在子类之前构造父类）。从 OO 的角度来看，OnPreInit 似乎是实现此功能的更合适的领域 - 页面构建应该处理页面的构建、设置任何默认值等，然后 OnPreInit 将用于执行在页面的生命周期。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-24T15:50:29.320

我认为您的推理非常合理-我同意这`OnPreInit`是这种逻辑的适当位置。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-24T16:02:45.810

根据实际功能，我建议使用 OnInit 或 OnLoad 而不是 OnPreInit。引入 OnPreInit 是为了支持动态设置主题或母版页，这是您在生命周期后期无法执行的操作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-24T16:09:45.683

请记住，如果是回发，则控件值尚未从 ViewState OnPreInit 恢复。

MSDN 给出[了事件使用的建议](http://msdn.microsoft.com/en-us/library/ms178472.aspx)。请参阅“生命周期事件”。例子：

*   PreInit - 创建或重新创建动态控件
*   Init - 使用此事件来读取或初始化控件属性。
*   Load - 使用 OnLoad 事件方法在控件中设置属性并建立数据库连接。

# wcf - 如何在生产期间保护 WCF 端点的开发期间避免 SSL 证书

> ID：582251
> 
> 赞同：8
> 
> 时间：2009-02-24T15:45:39.487
> 
> 标签：wcf, wcf-security

我们正在开发一些 WCF 服务。请求将跨越域边界；也就是说，客户端在一个域中运行，而处理请求的服务器在不同的（生产）域中。我知道如何使用 SSL 和证书保护此链接。我们将在生产域中向用户询问他们的用户名和密码，并在 SOAP 标头中传递这些信息。

我的问题是在开发和“beta”测试期间要做什么。我知道我可以获得一个临时证书并在开发过程中使用它。我想知道我的替代方法是什么。在这种情况下，其他人做了什么？

更新：我不确定我的问题是否得到了“好的”答案。我是一个由 50 多名开发人员组成的大型团队的一员。该组织相当敏捷。任何一位开发人员最终都可能在使用 WCF 的项目上工作。事实上，其他几个项目正在做类似的事情，但针对不同的网站和服务。我一直在寻找一种方法，我可以让任何人进来并在这个特定的项目上工作几天，而不必跳过很多圈子。安装开发证书就是其中之一。我完全理解在开发过程中“dogfooding”WCF 结构是最佳实践。大多数答案都给出了答案。我想知道除了“

乔恩

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-08-22T01:11:50.027

**更新：**我们现在实际上使用更简单的[Keith Brown 解决方案](http://www.pluralsight-training.net/community/blogs/keith/archive/2009/01/22/create-self-signed-x-509-certificates-in-a-flash-with-self-cert.aspx)而不是这个，请参阅他提供的源代码。优点：无需维护非托管代码。

如果您仍想了解如何使用 C/C++ 进行操作，请继续阅读...

当然只推荐用于开发，而不是生产，但是有一种低摩擦的方式来生成 X.509 证书（不求助于`makecert.exe`.

如果您可以在 Windows 上访问 CryptoAPI，那么您的想法是使用 CryptoAPI 调用来生成 RSA 公钥和私钥，对新的 X.509 证书进行签名和编码，将其放入仅限内存的证书存储中，然后用于`PFXExportCertStore()`生成然后您可以将其传递给`X509Certificate2`构造函数的 .pfx 字节。

一旦你有了一个`X509Certificate2`实例，你可以将它设置为适当的 WCF 对象的一个​​属性，然后事情就开始工作了。

我有一些我写的示例代码，当然不能保证，而且你需要一点 C 经验来编写必须是非托管的位（编写 P/ 会更痛苦）调用所有 CryptoAPI 调用，而不是让该部分使用 C/C++）。

使用非托管辅助函数的示例 C# 代码：

```
 public X509Certificate2 GenerateSelfSignedCertificate(string issuerCommonName, string keyPassword)
    {
        int pfxSize = -1;
        IntPtr pfxBufferPtr = IntPtr.Zero;
        IntPtr errorMessagePtr = IntPtr.Zero;

        try
        {
            if (!X509GenerateSelfSignedCertificate(KeyContainerName, issuerCommonName, keyPassword, ref pfxSize, ref pfxBufferPtr, ref errorMessagePtr))
            {
                string errorMessage = null;

                if (errorMessagePtr != IntPtr.Zero)
                {
                    errorMessage = Marshal.PtrToStringUni(errorMessagePtr);
                }

                throw new ApplicationException(string.Format("Failed to generate X.509 server certificate. {0}", errorMessage ?? "Unspecified error."));
            }
            if (pfxBufferPtr == IntPtr.Zero)
            {
                throw new ApplicationException("Failed to generate X.509 server certificate. PFX buffer not initialized.");
            }
            if (pfxSize <= 0)
            {
                throw new ApplicationException("Failed to generate X.509 server certificate. PFX buffer size invalid.");
            }

            byte[] pfxBuffer = new byte[pfxSize];
            Marshal.Copy(pfxBufferPtr, pfxBuffer, 0, pfxSize);
            return new X509Certificate2(pfxBuffer, keyPassword);
        }
        finally
        {
            if (pfxBufferPtr != IntPtr.Zero)
            {
                Marshal.FreeHGlobal(pfxBufferPtr);
            }
            if (errorMessagePtr != IntPtr.Zero)
            {
                Marshal.FreeHGlobal(errorMessagePtr);
            }
        }
    } 
```

`X509GenerateSelfSignedCertificate`函数实现可以是这样的（你需要`WinCrypt.h`）：

```
BOOL X509GenerateSelfSignedCertificate(LPCTSTR keyContainerName, LPCTSTR issuerCommonName, LPCTSTR keyPassword, DWORD *pfxSize, BYTE **pfxBuffer, LPTSTR *errorMessage)
{
    // Constants
#define CERT_DN_ATTR_COUNT    1
#define SIZE_SERIALNUMBER     8
#define EXPIRY_YEARS_FROM_NOW 2
#define MAX_COMMON_NAME       8192
#define MAX_PFX_SIZE          65535

    // Declarations
    HCRYPTPROV hProv = NULL;
    BOOL result = FALSE;

    // Sanity

    if (pfxSize != NULL)
    {
        *pfxSize = -1;
    }
    if (pfxBuffer != NULL)
    {
        *pfxBuffer = NULL;
    }
    if (errorMessage != NULL)
    {
        *errorMessage = NULL;
    }

    if (keyContainerName == NULL || _tcslen(issuerCommonName) <= 0)
    {
        SetOutputErrorMessage(errorMessage, _T("Key container name must not be NULL or an empty string."));
        return FALSE;
    }
    if (issuerCommonName == NULL || _tcslen(issuerCommonName) <= 0)
    {
        SetOutputErrorMessage(errorMessage, _T("Issuer common name must not be NULL or an empty string."));
        return FALSE;
    }
    if (keyPassword == NULL || _tcslen(keyPassword) <= 0)
    {
        SetOutputErrorMessage(errorMessage, _T("Key password must not be NULL or an empty string."));
        return FALSE;
    }

    // Start generating
    USES_CONVERSION;

    if (CryptAcquireContext(&hProv, keyContainerName, MS_DEF_RSA_SCHANNEL_PROV, PROV_RSA_SCHANNEL, CRYPT_MACHINE_KEYSET) ||
        CryptAcquireContext(&hProv, keyContainerName, MS_DEF_RSA_SCHANNEL_PROV, PROV_RSA_SCHANNEL, CRYPT_NEWKEYSET | CRYPT_MACHINE_KEYSET))
    {
        HCRYPTKEY hKey = NULL;

        // Generate 1024-bit RSA keypair.
        if (CryptGenKey(hProv, AT_KEYEXCHANGE, CRYPT_EXPORTABLE | RSA1024BIT_KEY, &hKey))
        {
            DWORD pkSize = 0;
            PCERT_PUBLIC_KEY_INFO pkInfo = NULL;

            // Export public key for use by certificate signing.
            if (CryptExportPublicKeyInfo(hProv, AT_KEYEXCHANGE, X509_ASN_ENCODING, NULL, &pkSize) &&
                (pkInfo = (PCERT_PUBLIC_KEY_INFO)LocalAlloc(0, pkSize)) &&
                CryptExportPublicKeyInfo(hProv, AT_KEYEXCHANGE, X509_ASN_ENCODING, pkInfo, &pkSize))
            {
                CERT_RDN_ATTR certDNAttrs[CERT_DN_ATTR_COUNT];
                CERT_RDN certDN[CERT_DN_ATTR_COUNT] = {{1, &certDNAttrs[0]}};
                CERT_NAME_INFO certNameInfo = {CERT_DN_ATTR_COUNT, &certDN[0]};
                DWORD certNameSize = -1;
                BYTE *certNameData = NULL;

                certDNAttrs[0].dwValueType = CERT_RDN_UNICODE_STRING;
                certDNAttrs[0].pszObjId = szOID_COMMON_NAME;
                certDNAttrs[0].Value.cbData = (DWORD)(_tcslen(issuerCommonName) * sizeof(WCHAR));
                certDNAttrs[0].Value.pbData = (BYTE*)T2W((LPTSTR)issuerCommonName);

                // Encode issuer name into certificate name blob.
                if (CryptEncodeObject(X509_ASN_ENCODING, X509_NAME, &certNameInfo, NULL, &certNameSize) &&
                    (certNameData = (BYTE*)LocalAlloc(0, certNameSize)) &&
                    CryptEncodeObject(X509_ASN_ENCODING, X509_NAME, &certNameInfo, certNameData, &certNameSize))
                {
                    CERT_NAME_BLOB issuerName;
                    CERT_INFO certInfo;
                    SYSTEMTIME systemTime;
                    FILETIME notBefore;
                    FILETIME notAfter;
                    BYTE serialNumber[SIZE_SERIALNUMBER];
                    DWORD certSize = -1;
                    BYTE *certData = NULL;

                    issuerName.cbData = certNameSize;
                    issuerName.pbData = certNameData;

                    // Certificate should be valid for a decent window of time.
                    ZeroMemory(&certInfo, sizeof(certInfo));
                    GetSystemTime(&systemTime);
                    systemTime.wYear -= 1;
                    SystemTimeToFileTime(&systemTime, &notBefore);
                    systemTime.wYear += EXPIRY_YEARS_FROM_NOW;
                    SystemTimeToFileTime(&systemTime, &notAfter);

                    // Generate a throwaway serial number.
                    if (CryptGenRandom(hProv, SIZE_SERIALNUMBER, serialNumber))
                    {
                        certInfo.dwVersion = CERT_V3;
                        certInfo.SerialNumber.cbData = SIZE_SERIALNUMBER;
                        certInfo.SerialNumber.pbData = serialNumber;
                        certInfo.SignatureAlgorithm.pszObjId = szOID_RSA_MD5RSA;
                        certInfo.Issuer = issuerName;
                        certInfo.NotBefore = notBefore;
                        certInfo.NotAfter = notAfter;
                        certInfo.Subject = issuerName;
                        certInfo.SubjectPublicKeyInfo = *pkInfo;

                        // Now sign and encode it.
                        if (CryptSignAndEncodeCertificate(hProv, AT_KEYEXCHANGE, X509_ASN_ENCODING, X509_CERT_TO_BE_SIGNED, (LPVOID)&certInfo, &(certInfo.SignatureAlgorithm), NULL, NULL, &certSize) &&
                            (certData = (BYTE*)LocalAlloc(0, certSize)) &&
                            CryptSignAndEncodeCertificate(hProv, AT_KEYEXCHANGE, X509_ASN_ENCODING, X509_CERT_TO_BE_SIGNED, (LPVOID)&certInfo, &(certInfo.SignatureAlgorithm), NULL, certData, &certSize))
                        {
                            HCERTSTORE hCertStore = NULL;

                            // Open a new temporary store.
                            if ((hCertStore = CertOpenStore(CERT_STORE_PROV_MEMORY, X509_ASN_ENCODING, NULL, CERT_STORE_CREATE_NEW_FLAG, NULL)))
                            {
                                PCCERT_CONTEXT certContext = NULL;

                                // Add to temporary store so we can use the PFX functions to export a store + private keys in PFX format.
                                if (CertAddEncodedCertificateToStore(hCertStore, X509_ASN_ENCODING, certData, certSize, CERT_STORE_ADD_NEW, &certContext))
                                {
                                    CRYPT_KEY_PROV_INFO keyProviderInfo;

                                    // Link keypair to certificate (without this the keypair gets "lost" on export).
                                    ZeroMemory(&keyProviderInfo, sizeof(keyProviderInfo));
                                    keyProviderInfo.pwszContainerName = T2W((LPTSTR)keyContainerName);
                                    keyProviderInfo.pwszProvName = MS_DEF_RSA_SCHANNEL_PROV_W; /* _W used intentionally. struct hardcodes LPWSTR. */
                                    keyProviderInfo.dwProvType = PROV_RSA_SCHANNEL;
                                    keyProviderInfo.dwFlags = CRYPT_MACHINE_KEYSET;
                                    keyProviderInfo.dwKeySpec = AT_KEYEXCHANGE;

                                    // Finally, export to PFX and provide to caller.
                                    if (CertSetCertificateContextProperty(certContext, CERT_KEY_PROV_INFO_PROP_ID, 0, (LPVOID)&keyProviderInfo))
                                    {
                                        CRYPT_DATA_BLOB pfxBlob;
                                        DWORD pfxExportFlags = EXPORT_PRIVATE_KEYS | REPORT_NO_PRIVATE_KEY | REPORT_NOT_ABLE_TO_EXPORT_PRIVATE_KEY;

                                        // Calculate size required.
                                        ZeroMemory(&pfxBlob, sizeof(pfxBlob));
                                        if (PFXExportCertStore(hCertStore, &pfxBlob, T2CW(keyPassword), pfxExportFlags))
                                        {
                                            pfxBlob.pbData = (BYTE *)LocalAlloc(0, pfxBlob.cbData);

                                            if (pfxBlob.pbData != NULL)
                                            {
                                                // Now export.
                                                if (PFXExportCertStore(hCertStore, &pfxBlob, T2CW(keyPassword), pfxExportFlags))
                                                {
                                                    if (pfxSize != NULL)
                                                    {
                                                        *pfxSize = pfxBlob.cbData;
                                                    }
                                                    if (pfxBuffer != NULL)
                                                    {
                                                        // Caller must free this.
                                                        *pfxBuffer = pfxBlob.pbData;
                                                    }
                                                    else
                                                    {
                                                        // Caller did not provide target pointer to receive buffer, free ourselves.
                                                        LocalFree(pfxBlob.pbData);
                                                    }

                                                    result = TRUE;
                                                }
                                                else
                                                {
                                                    SetOutputErrorMessage(errorMessage, _T("Failed to export certificate in PFX format (0x%08x)."), GetLastError());
                                                }
                                            }
                                            else
                                            {
                                                SetOutputErrorMessage(errorMessage, _T("Failed to export certificate in PFX format, buffer allocation failure (0x%08x)."), GetLastError());
                                            }
                                        }
                                        else
                                        {
                                            SetOutputErrorMessage(errorMessage, _T("Failed to export certificate in PFX format, failed to calculate buffer size (0x%08x)."), GetLastError());
                                        }
                                    }
                                    else
                                    {
                                        SetOutputErrorMessage(errorMessage, _T("Failed to set certificate key context property (0x%08x)."), GetLastError());
                                    }
                                }
                                else
                                {
                                    SetOutputErrorMessage(errorMessage, _T("Failed to add certificate to temporary certificate store (0x%08x)."), GetLastError());
                                }

                                CertCloseStore(hCertStore, 0);
                                hCertStore = NULL;
                            }
                            else
                            {
                                SetOutputErrorMessage(errorMessage, _T("Failed to create temporary certificate store (0x%08x)."), GetLastError());
                            }
                        }
                        else
                        {
                            SetOutputErrorMessage(errorMessage, _T("Failed to sign/encode certificate or out of memory (0x%08x)."), GetLastError());
                        }

                        if (certData != NULL)
                        {
                            LocalFree(certData);
                            certData = NULL;
                        }
                    }
                    else
                    {
                        SetOutputErrorMessage(errorMessage, _T("Failed to generate certificate serial number (0x%08x)."), GetLastError());
                    }
                }
                else
                {
                    SetOutputErrorMessage(errorMessage, _T("Failed to encode X.509 certificate name into ASN.1 or out of memory (0x%08x)."), GetLastError());
                }

                if (certNameData != NULL)
                {
                    LocalFree(certNameData);
                    certNameData = NULL;
                }
            }
            else
            {
                SetOutputErrorMessage(errorMessage, _T("Failed to export public key blob or out of memory (0x%08x)."), GetLastError());
            }

            if (pkInfo != NULL)
            {
                LocalFree(pkInfo);
                pkInfo = NULL;
            }
            CryptDestroyKey(hKey);
            hKey = NULL;
        }
        else
        {
            SetOutputErrorMessage(errorMessage, _T("Failed to generate public/private keypair for certificate (0x%08x)."), GetLastError());
        }

        CryptReleaseContext(hProv, 0);
        hProv = NULL;
    }
    else
    {
        SetOutputErrorMessage(errorMessage, _T("Failed to acquire cryptographic context (0x%08x)."), GetLastError());
    }

    return result;
}

void
SetOutputErrorMessage(LPTSTR *errorMessage, LPCTSTR formatString, ...)
{
#define MAX_ERROR_MESSAGE 1024
    va_list va;

    if (errorMessage != NULL)
    {
        size_t sizeInBytes = (MAX_ERROR_MESSAGE * sizeof(TCHAR)) + 1;
        LPTSTR message = (LPTSTR)LocalAlloc(0, sizeInBytes);

        va_start(va, formatString);
        ZeroMemory(message, sizeInBytes);
        if (_vstprintf_s(message, MAX_ERROR_MESSAGE, formatString, va) == -1)
        {
            ZeroMemory(message, sizeInBytes);
            _tcscpy_s(message, MAX_ERROR_MESSAGE, _T("Failed to build error message"));
        }

        *errorMessage = message;

        va_end(va);
    }
} 
```

我们已经使用它在启动时生成 SSL 证书，当您只想测试加密而不验证信任/身份时，这很好，并且只需要大约 2-3 秒即可生成。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-24T16:42:07.323

你真的希望你的开发环境尽可能地匹配生产。WCF 将在传输协商或签名检查和自签名证书期间检查吊销列表，或者使用 makecert 的伪造证书不支持 CRL。

如果您有备用机器，您可以使用 Windows 证书服务（Server 2003 和 2008 免费）。这提供了一个 CA，您可以从它请求证书（SSL 或客户端）。它需要是一台备用机器，因为它在默认网站下自行设置，如果您已经对其进行了调整，它就会完全混乱。它还发布 CRL。您需要做的就是在您的开发盒上安装 CA 的根证书，然后就可以离开了。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-24T16:45:19.797

您可以选择生成要在开发中使用的证书，或通过配置文件禁用证书的使用。我建议实际上也在开发中使用证书。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-09-25T01:29:04.697

扩展 Leon Breedt 的答案，生成内存 x509 证书，您可以使用[Keith Elder 的 SelfCert](http://www.pluralsight-training.net/community/blogs/keith/archive/2009/01/22/create-self-signed-x-509-certificates-in-a-flash-with-self-cert.aspx)的源代码。

```
using (CryptContext ctx = new CryptContext())
{
    ctx.Open();

    var cert = ctx.CreateSelfSignedCertificate(
        new SelfSignedCertProperties
        {
            IsPrivateKeyExportable = true,
            KeyBitLength = 4096,
            Name = new X500DistinguishedName("cn=InMemoryTestCert"),
            ValidFrom = DateTime.Today.AddDays(-1),
            ValidTo = DateTime.Today.AddYears(5),
        });

    var creds = new ServiceCredentials();
    creds.UserNameAuthentication.CustomUserNamePasswordValidator = new MyUserNamePasswordValidator();
    creds.ServiceCertificate.Certificate = cert;
    serviceHost.Description.Behaviors.Add(creds);
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-24T16:24:09.160

如何在开发和生产之间更改配置？

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-24T16:30:09.520

我的建议是考虑几种不同的方法：

对于开发 -> 有一些方法可以在本地生成 SSL 证书，以便可以在您完全控制的环境中使用 https 进行测试。

对于“beta”测试 -> 考虑为此获得第二个证书，因为可能需要在版本之间持续进行一些 beta 测试，以便可以反复使用它。

# c# - 限制用户从项目文件夹 dot.net 打开 XML 文件

> ID：582257
> 
> 赞同：0
> 
> 时间：2009-02-24T15:47:45.830
> 
> 标签：c#, asp.net, visual-studio, iis

我的解决方案文件中有一个“资源”文件夹，其中包含 xml 文件。它可供远程、未经身份验证的 Internet 用户使用，我想拒绝所有用户的访问。如果他们知道文件名，他们可以通过 url 访问它。

例如：example.com/common/resources/test.xml

因此，我想拒绝访问该文件夹或将其移动到 Web 服务器不作为内容提供的目录。

我正在使用 Visual Studio 2003 和 IIS。谁能帮助我如何限制所有用户查看文件？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-03T20:14:46.737

您可以改为将 XML 存储在 App_Data 文件夹中，因为默认情况下 IIS 将不允许访问它。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-24T21:04:50.873

如果这些文件仅由您的代码使用，那么您可以将这些文件的“构建操作”更改为“嵌入式资源”。然后，当您部署应用程序时，这些文件将作为资源添加到 DLL 文件本身中，这样您就不会再将它们放在 Web 服务器上。要访问它们，您将使用 System.Reflection.Assembly.GetExecutingAssembly().GetManifestResourceStream 方法。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-03T19:51:35.310

问题在于，默认情况下，IIS 将提供 xml 和其他静态内容，甚至不会告诉 ASP.NET。因此，您在 ASP.NET 中的身份验证完全被绕过。

因此，一种解决方案是强制 IIS 调用 ASP.NET 来处理 xml 内容。这样，您可以获得 ASP.NET 身份验证的好处，并使用本线程中讨论的 web.config 文件来控制访问。

抱歉，这些说明适用于 IIS 5 和 ASP.NET 2.0，但我想您可以在其他版本的 IIS 和 ASP.NET 中计算出等效的说明。在 IIS 中，为您的网站选择属性，然后选择配置，然后添加以添加新映射。选择 aspnet_asapi.dll 的路径，例如。Windows\Microsoft.Net\Framework\v2.0.5072。将 .xml 放入“扩展名”框中。选择所有动词，然后确定。

希望有帮助。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-24T15:52:34.680

我认为您回答了您自己的问题——将其移至 IIS 不提供服务的目录。根据您的描述，这听起来像是最简单的解决方案。

您的另一个选择是针对该文件夹启用身份验证。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-24T15:54:08.483

您可以将扩展名更改为 .config 以便轻松修复。IIS 不提供 .config 文件。

我确定您可以将该文件夹的权限设置为仅允许 ASP.Net 访问。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-24T15:58:25.570

您可以将 IIS 设置为不提供 xml 文件。但这将阻止所有 xml 文件，而不仅仅是资源文件夹中的那些。

或者，您可以将 web.config 文件添加到资源文件夹并设置访问权限，以便不允许用户从该文件夹下载文件。像这样的东西应该工作：

```
<authorization>
   <deny users="*"/>
</authorization> 
```

# jquery - 使用 jQuery 读取/写入文件

> ID：582268
> 
> 赞同：64
> 
> 时间：2009-02-24T15:49:30.180
> 
> 标签：jquery, file

有没有办法让 jQuery 从文件中获取信息？是否可以？如何？

* * *

## 回答 #1

> 赞同：79
> 
> 时间：2009-02-24T15:50:51.703

不，JavaScript 无权写入文件，因为这至少可以说是一个巨大的安全风险。但是，如果您想在服务器端获取/存储信息，您当然可以对 PHP/ASP/Python/etc 进行 Ajax 调用。然后可以在服务器中获取/存储数据的脚本。如果您的意思是在客户端计算机上存储数据，那么仅使用 JavaScript 是不可能的。我怀疑 Flash/Java 可能可以，但我不确定。

如果您只是尝试在不可靠的时间内存储有关特定用户的少量信息，我认为您需要[Web Storage API](https://developer.mozilla.org/en-US/docs/Web/API/Storage)或 cookie。不过，我不确定您要完成什么。

* * *

## 回答 #2

> 赞同：37
> 
> 时间：2009-11-23T14:44:46.907

是的，有可能。

该技术描述如下

[http://jquery.tiddlywiki.org/twFile.html](http://jquery.tiddlywiki.org/twFile.html)

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2009-02-24T16:22:21.300

HTML5 和 Google Gears 都添加了本地存储功能，主要是通过嵌入式 SQLite API。

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2012-07-20T16:09:23.557

## 使用 javascript 的`execCommand('SaveAs', false, filename);`功能

**编辑：不再有效。由于浏览器的安全考虑，这个 Javascript 函数过去可以在所有浏览器上工作，但现在只在 IE 上工作。它向通过浏览器运行此功能的用户显示“另存为”对话框，用户按确定，文件由服务器端的 javascript 保存。**

现在这个代码是一个罕见的古董零日收藏品。

```
// content is the data (a string) you'll write to file.
// filename is a string filename to write to on server side.
// This function uses iFrame as a buffer, it fills it up with your content
// and prompts the user to save it out.
function save_content_to_file(content, filename){
    var dlg = false;
    with(document){
     ir=createElement('iframe');
     ir.id='ifr';
     ir.location='about.blank';
     ir.style.display='none';
     body.appendChild(ir);
      with(getElementById('ifr').contentWindow.document){
           open("text/plain", "replace");
           charset = "utf-8";
           write(content);
           close();
           document.charset = "utf-8";
           dlg = execCommand('SaveAs', false, filename);
       }
       body.removeChild(ir);
     }
    return dlg;
} 
```

**像这样调用函数：**

```
msg =  "I am the president of tautology club.";
save_content_to_file(msg, "C:\\test"); 
```

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2009-02-24T15:55:12.363

您将需要通过 Web 编程语言（例如 PHP 或 ASP.net）处理您的文件访问。

要进行此设置，您将：

*   创建一个处理文件读写的脚本。这应该对浏览器可见。

*   向写入数据或读取数据的脚本发送 jQuery ajax 请求。您需要通过请求参数传递所有读/写信息。您可以在 jQuery ajax 文档中了解更多信息。

确保对存储的所有数据进行清理，因为这可能存在安全风险。但是，这实际上只是标准的平面文件数据存储，并不一定那么不寻常。

正如 Paolo 指出的那样，没有办法通过 jQuery 或任何其他类型的 javascript 直接读取/写入文件。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2009-02-24T15:54:41.790

饼干是你最好的选择。寻找 jquery cookie 插件。

Cookies 就是为这种情况而设计的——你想在客户端保留一些关于这个客户端的信息。请注意，cookie 在每个 Web 请求中来回传递，因此您无法在其中存储大量数据。但只是一个问题的简单答案应该没问题。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-02-24T18:18:31.117

如果您想在页面内不进行大量服务器端处理的情况下执行此操作，则将文本值放入隐藏字段（使用 PHP）可能是一个可行的想法。然后就可以使用 jQuery 来处理隐藏字段的值了。

无论你的船漂浮什么:)

# java - 如何计算两个 Java java.sql.Timestamps 之间的差异？

> ID：582278
> 
> 赞同：16
> 
> 时间：2009-02-24T15:50:35.200
> 
> 标签：java, timestamp

请包括纳米，否则将是微不足道的：

```
long diff = Math.abs(t1.getTime () - t2.getTime ()); 
```

[编辑] 我想要最精确的结果，所以没有双打；只有整数/长算法。此外，结果必须是积极的。伪代码：

```
Timestamp result = abs (t1 - t2); 
```

例子：

```
t1 = (time=1001, nanos=1000000), t2 = (time=999, nanos=999000000)
 -> diff = (time=2, nanos=2000000) 
```

是的，java.sql.Timestamp 中的毫秒在时间和纳秒标准中重复，所以 1001 毫秒意味着 1 秒（1000）和 1 毫秒，`time`因为`nanos`1 毫秒 = 1000000 纳秒）。这比看起来要狡猾得多。

我建议不要在没有实际测试代码或准备好工作代码示例的情况下发布答案:)

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-02-24T16:38:52.493

经过一小时和各种单元测试，我想出了这个解决方案：

```
public static Timestamp diff (java.util.Date t1, java.util.Date t2)
{
    // Make sure the result is always > 0
    if (t1.compareTo (t2) < 0)
    {
        java.util.Date tmp = t1;
        t1 = t2;
        t2 = tmp;
    }

    // Timestamps mix milli and nanoseconds in the API, so we have to separate the two
    long diffSeconds = (t1.getTime () / 1000) - (t2.getTime () / 1000);
    // For normals dates, we have millisecond precision
    int nano1 = ((int) t1.getTime () % 1000) * 1000000;
    // If the parameter is a Timestamp, we have additional precision in nanoseconds
    if (t1 instanceof Timestamp)
        nano1 = ((Timestamp)t1).getNanos ();
    int nano2 = ((int) t2.getTime () % 1000) * 1000000;
    if (t2 instanceof Timestamp)
        nano2 = ((Timestamp)t2).getNanos ();

    int diffNanos = nano1 - nano2;
    if (diffNanos < 0)
    {
        // Borrow one second
        diffSeconds --;
        diffNanos += 1000000000;
    }

    // mix nanos and millis again
    Timestamp result = new Timestamp ((diffSeconds * 1000) + (diffNanos / 1000000));
    // setNanos() with a value of in the millisecond range doesn't affect the value of the time field
    // while milliseconds in the time field will modify nanos! Damn, this API is a *mess*
    result.setNanos (diffNanos);
    return result;
} 
```

单元测试：

```
 Timestamp t1 = new Timestamp (0);
    Timestamp t3 = new Timestamp (999);
    Timestamp t4 = new Timestamp (5001);
    // Careful here; internally, Java has set nanos already!
    t4.setNanos (t4.getNanos () + 1);

    // Show what a mess this API is...
    // Yes, the milliseconds show up in *both* fields! Isn't that fun?
    assertEquals (999, t3.getTime ());
    assertEquals (999000000, t3.getNanos ());
    // This looks weird but t4 contains 5 seconds, 1 milli, 1 nano.
    // The lone milli is in both results ...
    assertEquals (5001, t4.getTime ());
    assertEquals (1000001, t4.getNanos ());

    diff = DBUtil.diff (t1, t4);
    assertEquals (5001, diff.getTime ());
    assertEquals (1000001, diff.getNanos ());

    diff = DBUtil.diff (t4, t3);
    assertEquals (4002, diff.getTime ());
    assertEquals (2000001, diff.getNanos ()); 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2019-01-21T06:23:43.640

我使用这种方法来获得2之间的差异`java.sql.Timestmap`

```
/**
 * Get a diff between two timestamps.
 *
 * @param oldTs The older timestamp
 * @param newTs The newer timestamp
 * @param timeUnit The unit in which you want the diff
 * @return The diff value, in the provided time unit.
 */
public static long getDateDiff(Timestamp oldTs, Timestamp newTs, TimeUnit timeUnit) {
    long diffInMS = newTs.getTime() - oldTs.getTime();
    return timeUnit.convert(diffInMS, TimeUnit.MILLISECONDS);
}

// Examples:
// long diffMinutes = getDateDiff(oldTs, newTs, TimeUnit.MINUTES);
// long diffHours = getDateDiff(oldTs, newTs, TimeUnit.HOURS); 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-24T15:58:33.073

在哪些单位？您上面的差异将给出毫秒，Timestamp.nanos() 返回一个 int，它将在（百万分之一？）毫秒。所以你的意思是例如

```
(t1.getTime () + (.000001*t1.getNanos()) - (t2.getTime () + (.000001*t2.getNanos()) 
```

还是我错过了什么？另一个问题是您需要这种级别的精度吗？AFAIK JVM 不能保证在这个级别上是精确的，除非你确定你的数据源是那么精确，否则我认为这并不重要。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-24T16:46:56.873

基于 mmyers 代码构建...

```
import java.math.BigInteger;
import java.sql.Timestamp;

public class Main
{
    // 1s == 1000ms == 1,000,000us == 1,000,000,000ns (1 billion ns)
    public final static BigInteger ONE_BILLION = new BigInteger ("1000000000");
    public static void main(String[] args) throws InterruptedException 
    {
        final Timestamp t1;
        final Timestamp t2;
        final BigInteger firstTime;
        final BigInteger secondTime;
        final BigInteger diffTime;

        t1 = new Timestamp(System.currentTimeMillis());
        Thread.sleep(20);
        t2 = new Timestamp(System.currentTimeMillis());

        System.out.println(t1);
        System.out.println(t2);
        firstTime  = BigInteger.valueOf(t1.getTime() / 1000 * 1000).multiply(ONE_BILLION ).add(BigInteger.valueOf(t1.getNanos()));
        secondTime = BigInteger.valueOf(t2.getTime() / 1000 * 1000).multiply(ONE_BILLION ).add(BigInteger.valueOf(t2.getNanos()));
        diffTime   = firstTime.subtract(secondTime);
        System.out.println(firstTime);
        System.out.println(secondTime);
        System.out.println(diffTime);
    }
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-24T16:02:35.450

（删除旧代码以缩短答案）

**编辑2：**新代码：

```
public class ArraySizeTest {
    public static void main(String[] args) throws InterruptedException {
        Timestamp t1 = new Timestamp(System.currentTimeMillis());
        t1.setNanos(t1.getNanos() + 60);
        Thread.sleep(20);
        Timestamp t2 = new Timestamp(System.currentTimeMillis());
        t2.setNanos(t2.getNanos() + 30);
        System.out.println(t1);
        System.out.println(t2);
        // The actual diff...
        long firstTime = (getTimeNoMillis(t1) * 1000000) + t1.getNanos();
        long secondTime = (getTimeNoMillis(t2) * 1000000) + t2.getNanos();
        long diff = Math.abs(firstTime - secondTime); // diff is in nanos
        System.out.println(diff);
        System.out.println(Math.abs(t1.getTime() - t2.getTime()));
    }
    private static long getTimeNoMillis(Timestamp t) {
        return t.getTime() - (t.getNanos()/1000000);
    }
} 
```

输出：

```
2009-02-24 10:35:15.56500006
2009-02-24 10:35:15.59600003
30999970
31
```

**编辑 3：**如果您更喜欢返回时间戳的内容，请使用：

```
public static Timestamp diff(Timestamp t1, Timestamp t2) {
    long firstTime = (getTimeNoMillis(t1) * 1000000) + t1.getNanos();
    long secondTime = (getTimeNoMillis(t2) * 1000000) + t2.getNanos();
    long diff = Math.abs(firstTime - secondTime); // diff is in nanoseconds
    Timestamp ret = new Timestamp(diff / 1000000);
    ret.setNanos((int) (diff % 1000000000));
    return ret;
}
private static long getTimeNoMillis(Timestamp t) {
    return t.getTime() - (t.getNanos()/1000000);
} 
```

此代码通过了您的单元测试。

# database - Oracle 触发器：raise_application_error

> ID：582280
> 
> 赞同：1
> 
> 时间：2009-02-24T15:50:50.770
> 
> 标签：database, oracle, triggers

我想使用 raise_application_error-procedure 来停止登录过程。我写了一个触发器，它检查 TERMINAL 字符串，如果它是正确的（我知道这并不安全，但一开始，它就足够了）所以触发器工作正常并且做我想要的，但是 raise_application_error 会导致回滚并且不发送我想要的异常。当我使用我的应用程序登录数据库时，raise_application_error 不会停止应用程序。第一个问题：这是停止使用错误应用程序登录数据库的正确方法吗？第二个问题：如果是，有什么问题？

```
create or replace
TRIGGER after_logon_on_database 
AFTER LOGON ON DATABASE
BEGIN
IF sys_context('USERENV', 'TERMINAL')='IAS' THEN
  INSERT INTO event_log
  (event_date, event_time, username, event_case, event_comment)
  VALUES
  (SYSDATE, to_char(sysdate, 'hh24:mi:ss'), USER, 'LOGON-SUCCESS', sys_context('USERENV', 'TERMINAL'));
ELSE
  INSERT INTO event_log
  (event_date, event_time, username, event_case, event_comment)
  VALUES
  (SYSDATE, to_char(sysdate, 'hh24:mi:ss'), USER, 'LOGON-FAILURE', sys_context('USERENV', 'TERMINAL'));
  RAISE_APPLICATION_ERROR(-20001, 'Access denied!');
END IF;
END after_logon_on_database; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-24T19:31:37.603

阅读这个问汤姆线程：[http ://asktom.oracle.com/pls/asktom/f?p=100:11:0::::P11_QUESTION_ID:3236035522926](http://asktom.oracle.com/pls/asktom/f?p=100:11:0::::P11_QUESTION_ID:3236035522926)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-24T16:59:59.980

In the second part of the IF/ELSE add a commit; statement between the Insert and the Raise. This will ensure that the Login failure message is inserted into the database correctly.

You are aware the the on-logon trigger won't stop the user from logging in if they are a DBA (have the DAB role). This is a feature to ensure that someone can always get access to the database to fix a broken on-logon trigger.

You are also correct in that the trigger won't raise (as the first error message returned by Oracle) the error -20001\. It will instead return a -604 (ORA-00604: error occurred at recursive SQL level 1). You are not directly executing the trigger at login, it's executed at a few steps removed. You will want your application to handle this error properly.

# .net - 有 .NET 3.0 或更高版本经验的开发人员，您会建议首先查看哪些功能？

> ID：582284
> 
> 赞同：3
> 
> 时间：2009-02-24T15:51:01.220
> 
> 标签：.net, .net-3.5, .net-2.0

.NET 开发人员需要掌握很多[功能](http://en.wikipedia.org/wiki/.NET_Framework#Versions)才能加快速度。

我仍在使用 2.0，可能是因为我工作的行业，银行倾向于阻止使用*前沿*技术（根据我的经验）。

有 .NET 3.0 或更高版本经验的开发人员，您会建议首先查看哪些功能（语言和框架）？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-02-24T15:53:13.273

恕我直言，最有影响力的特性是 LINQ 和 lambda 表达式

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-24T15:53:21.887

在 3.0 中，WCF 可能是最通用的一般用途。

WPF 很好，但特定于 Windows/UI。

在 3.5 中，LINQ 一路走来；-

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-02-24T15:59:40.543

取决于您的需要，但我会说 Lambdas 和 LINQ 非常有趣。

特别提到 LINQ-to-objects 和 LINQ-to-XML，因为它们表明您在 DB 之外也具有查询功能。

我也认为 WPF 真的很酷，而且 WCF 使进程间通信变得更加容易。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-02-24T16:06:30.263

查看**C# 自动属性**​​- 比 LINQ 或 lambda 表达式更简单的概念，但会为您节省大量时间和麻烦！

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-02-24T16:03:02.860

从 C# 3.0 开始：部分方法。它们是为编程语言增光添彩的唯一最重要的特性。

不，我在开玩笑：lambda 表达式和 LINQ 将改变你看待编码的方式。当您必须为没有它们的平台编写代码时，它们也会让您非常想念它们:(

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-24T15:52:54.617

首先也是最重要的：[LINQ](http://www.programmersheaven.com/2/CSharp3-4)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-02-24T15:52:54.740

LINQ，LINQ，哦，是的 LINQ

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-02-24T16:01:52.863

LINQ 很漂亮。关于 LINQ 要了解的一点是，它不仅仅是关于数据库，它是一种集合查询功能，将 ORM 与 LINQ to SQL 和 LINQ to Entities 结合在一起。

WPF 很有趣。

对象初始化器让生活变得如此简单......

```
MyObject foo = new MyObject() {prop1="foo",prop2="bar"} 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-02-24T16:30:33.747

如果您主要是在做“图形”的事情，那么[WPF](http://en.wikipedia.org/wiki/Windows_Presentation_Foundation)可能是最值得关注的事情。如果您正在进行基于 Web 的开发，请不要忘记它是“小弟” [Silverlight 。](http://en.wikipedia.org/wiki/Silverlight)

如果您以前使用过 .NET Remoting 或 Web 服务，那么[WCF](http://en.wikipedia.org/wiki/Windows_Communication_Foundation)绝对是未来的必经之路。

如果您正在做数据库类型的应用程序，那么[LINQ](http://en.wikipedia.org/wiki/Linq)（特别是 LINQtoSQL）就是您所追求的。不过，小心 LINQtoSQL，将来很可能会被 LINQtoENTITIES 取代（作为[Entity Framework](http://en.wikipedia.org/wiki/Entity_Framework)的一部分）。

请注意，LINQ 是一种更广泛的技术，并且可以应用于 XML、对象，事实上，如果您愿意，您可以编写自己的提供程序来允许 LINQ-to-anything！（例如，优秀书籍 Linq In Action 的作者在其中编写了一个 LINQ-to-Amazon）。

作为一项广泛的技术，LINQ 是通过[扩展方法](http://msdn.microsoft.com/en-us/library/bb383977.aspx)和[Lambda 表达式](http://msdn.microsoft.com/en-us/library/bb397687.aspx)等其他底层技术改进实现的，所以如果你想*真正*深入研究 LINQ，你也可以学习这些！当您想*真正*了解“幕后”发生的事情时，这反过来又会导致诸如[表达式树之类的事情。](http://msdn.microsoft.com/en-us/library/bb397951.aspx)

 *总的来说，我会说 LINQ 是最值得关注的事情。它有许多多重用途（即不专注于一个或两个特定的开发“领域”），建立在 .NET 语言的一大堆其他技术改进之上，而且，将来可能会建立在更多的基础之上（即 Lambda 表达式是在 C# 中引入更多“函数式”语言的开始！）

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-02-24T16:10:29.067

Lambda 表达式、扩展方法和对象/集合初始化器。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-02-24T16:34:47.823

- 对象和集合初始化
器 - 隐式变量
- 自动属性（爱 EM ！！）

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-02-25T17:07:03.650

Windows 工作流基础 (WF)

特别是如果您有业务喜欢更改的长时间运行的流程。

（需要注意的是，它正在使用 .NET 4 进行重大改进，但具有向后兼容性。）

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-03-28T19:14:09.780

有 4 个特别重要的新**语言**特性。语言是您作为开发人员可以（和不能）做的一切的基础，因此了解这 4 个重要的新语言特性非常重要。

我正在谈论的4个功能是：

1.  扩展方法
2.  Lambda 表达式
3.  隐式类型的局部变量
4.  匿名类型

（注意：还有其他新的语言特性，它们当然很重要。但这 4 个是我要开始的基础特性）。

现在，碰巧LINQ 主要基于这4 个特性。**但不要让这让你偏离正轨。**如果你真的想掌握 C# 3.0，**除了它们在 Linq 中的用法，你还需要深入理解这些语言的每一个特性。**

一旦你这样做了，你就可以做两件事了：

1.  利用 C# 3.0 编写一些强大的代码
2.  其实了解Linq。

好好享受！C# 3.0 是一个美丽的东西。

# c# - nunit 设置/拆卸不起作用？

> ID：582287
> 
> 赞同：3
> 
> 时间：2009-02-24T15:52:09.360
> 
> 标签：c#, unit-testing

好的，我有一个奇怪的问题。我正在测试一个用户控件并有这样的代码：

```
[TestFixture]
public myTestClass : UserControl
{
    MyControl m_Control;

    [Test]
    public void TestMyControl()
    {
        m_Control = new MyControl();
        this.Controls.Add(m_Control);

        Assert.That(/*SomethingOrOther*/)
    }
} 
```

这很好用，但是当我将其更改为：

```
[TestFixture]
public myTestClass : UserControl
{
    MyControl m_Control;

    [Setup]
    public void Setup()
    {
        m_Control = new MyControl();
        this.Controls.Add(m_Control);
    }

    [TearDown]
    public void TearDown()
    {
        this.Controls.Clear();
    }

    [Test]
    public void TestMyControl()
    {
        Assert.That(/*SomethingOrOther*/);
    }
} 
```

我得到一个未设置为对象实例的对象引用。我什至输出到控制台以确保设置/拆卸在正确的时间运行，它们是......但它仍然没有更新用户控件。

编辑> 确切的代码是：

```
[TestFixture]
public class MoneyBoxTests : UserControl
{
    private MoneyBox m_MoneyBox;
    private TextBox m_TextBox;

    #region "Setup/TearDown"
    [SetUp]
    public void Setup()
    {
        MoneyBox m_MoneyBox = new MoneyBox();
        TextBox m_TextBox = new TextBox();

        this.Controls.Add(m_MoneyBox);
        this.Controls.Add(m_TextBox);
    }

    [TearDown]
    public void TearDown()
    {
        this.Controls.Clear();
    }
    #endregion

    [Test]
    public void AmountConvertsToDollarsOnLeave()
    {
        m_MoneyBox.Focus();
        m_MoneyBox.Text = "100";
        m_TextBox.Focus();

        Assert.That(m_MoneyBox.Text, Is.EqualTo("$100.00"), "Text isn't $100.00");
    }

    [Test]
    public void AmountStaysANumberAfterConvertToDollars()
    {
        m_MoneyBox.Focus();
        m_MoneyBox.Text = "100";
        m_TextBox.Focus();

        Assert.That(m_MoneyBox.Amount, Is.EqualTo(100), "Amount isn't 100");
    }
} 
```

我在各自的 m_MoneyBox.Focus() 调用中得到异常。

解决了 - 见约瑟夫的评论

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-24T16:00:06.300

你还没有说你从哪里得到异常，这会有所帮助 - 堆栈跟踪是什么样的？

创建测试夹具时从 UserControl 派生是非常奇怪的 (IME)。除此之外，我不知道 NUnit 会在任何适当的时候为您调用 Dispose ......这里的目的是什么？你不能让你的测试用一个“普通”的测试夹具运行吗？

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-24T16:07:38.560

我创建了一个与您在此处展示的布局完全相同的测试用例，但使用的是 TextBox 而不是 MyControl。我还添加了一个构造函数和一个解构函数，并将所有不同的阶段输出到控制台以查看事件的顺序。但是，我从来没有遇到过对象引用异常。

如果您有兴趣，顺序是[构造函数调用]、[设置调用]、[测试调用]、[拆卸调用]。由于某种原因，解构从未向屏幕输出任何内容。

我最初的想法是 myTestClass 上的 Controls 属性不会被初始化，但在我的测试中它是，所以我认为它与您的 MyControl 构造有关。

编辑> 我在单元测试中也将焦点放在了我的 TextBox 上，但仍然没有例外。在 Focus 期间，您的 MoneyBox 是否在幕后进行任何事件处理？那可能是你的罪魁祸首。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-20T17:07:44.553

我有完全相同的问题，所以我很抱歉回答这个旧帖子。您的代码（和我的）中的问题是您正在为 MoneyBox 创建 2 个不同的实例，为 TextBox 创建另外 2 个实例。因此，Setup 内部的初始分配仅对测试方法中的 Setup 方法和 out_of_scope 有效。

在 Setup 方法中，您应该使用：

```
m_MoneyBox = new MoneyBox(); //GOOD
m_TextBox = new TextBox();  //GOOD 
```

代替

```
MoneyBox m_MoneyBox = new MoneyBox();  //BAD
TextBox m_TextBox = new TextBox();  //BAD 
```

只为任何可能再次需要它的人

# sql-server - 如何在 SSRS 2005 报告的每一页上放置超链接？

> ID：582288
> 
> 赞同：0
> 
> 时间：2009-02-24T15:52:15.023
> 
> 标签：sql-server, reporting-services

我正在构建一个可能有多个页面的 SSRS 2005 报告。我想放入一个超链接，以便它出现在每一页的顶部。超链接链接回同一个报告 - 基本上我有一个“摘要”和“详细”模式，并且希望有超链接可以在它们之间切换。
到目前为止，我尝试了两种方法：

*   在正文中放置一个文本框，然后在 Properties -> Navigation 中跳转到报告。这很好用，只是它只显示在第一页上。
*   在报告的标题中拖动相同的文本框。现在它出现在每个页面上，但单击它会导致错误消息：“尚未指定报告定义的来源”。

谷歌什么也没发现，现在怎么办？
谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-08-03T04:18:12.837

执行此操作的最佳方法是实施汇总报告以深入了解详细报告，并使用汇总报告表的详细信息行上的数据来访问该行的详细信息作为详细报告。例如，假设摘要报告是发票总额的列表，详细报告显示该发票上的项目。

1.  右键单击表详细信息行中的 InvoiceNumber 字段，然后选择 Properties
2.  单击导航选项卡
3.  单击跳转到报告单选按钮并从下拉列表中选择详细报告
4.  单击“参数”按钮并填写参数名称和值 - 在本示例中，参数名称可能是 InvoiceNumber，参数值可能是 =Fields!InvoiceNumber.Value
5.  单击“确定”两次，您现在有一个从摘要报告到详细报告的超链接，用户可以在其中向下钻取以获取每张发票的详细信息
6.  给出一个超链接的视觉指示也很好，所以我将颜色设置为 MediumBlue

如果您只想从摘要报告直接链接到完整的详细报告，反之亦然，您可以在导航设置上使用相同的样式，但这次在表格标题行的文本框上进行，并确保标题将 RepeatOnNewPage 属性设置为 True，以便它出现在每一页上。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-05-27T12:42:05.163

让您的报告返回主页

1.  右键单击表格详细信息行中的标题字段并选择属性
2.  单击导航选项卡
3.  单击书签 ID 并键入 =“主页” 单击确定两次现在有一个指向主页的超链接
4.  在正在创建页面的位置放置一个文本框，然后右键单击它并选择属性
5.  单击导航选项卡
6.  单击 Jump to report 单选按钮并输入 =“Home” 单击 OK 两次
7.  在框中键入单词 Home

# model-view-controller - 存储库模式：什么是“合适的大小”？

> ID：582289
> 
> 赞同：14
> 
> 时间：2009-02-24T15:52:26.490
> 
> 标签：model-view-controller, domain-driven-design, repository-pattern

我正在为 MVC 应用程序构建一些存储库，并且我正在尝试提出在存储库之间划分职责的正确方法。在大多数情况下，这是显而易见的。但是有一种特殊情况，我不确定正确的答案是什么。

此应用程序的用户需要为其员工跟踪多种类型的时间。为简单起见，我们只考虑两个。我称它们为“考勤卡”和“考勤”。这两者之间差异的确切性质并不重要，但您应该注意最终用户将它们视为完全独立的数据。不过，我认为，他们认为它们完全独立的数据的原因是他们过去从未真正有机会看到它们在一起。这两种类型的记录在编辑记录方面具有几乎完全不同的业务规则，但一般来说，它们也是员工在特定时间所处位置的两种记录。这两种时间记录有很多共同的属性，比如总小时数，以及为其收集时间的员工。这两种类型还具有一些完全独特的单个类型的属性。我们将这些“额外”属性保存在另一种类型的实例中。所以一般的结构是这样的：

```
class TimeRecord 
{ 
    Person Employee { get; set; }
    TimeSpan? Hours { get; set; }
}

class TimeCardData
{
     TimeRecord Record { get; set; }
     TProperty TimeCardProperty  { get; set; }
}

class AttendanceData
{
     TimeRecord Record { get; set; }
     TProperty AttendanceProperty  { get; set; }
} 
```

所以问题是，**这里需要多少个存储库？**

## 1 个存储库

只有一个存储库的设计将公开返回“时间卡”、“出勤”记录或在一个列表中返回两种类型的方法。这对于存储库的客户来说相当方便，但在我看来，它有成为一个非常胖的类的真正危险。我认为仅用于“考勤卡”的存储库已经成为系统中最大的存储库之一，即使由于涉及复杂的业务规则而无需处理“出勤”。

## 2 存储库

另一种设计将有一个“考勤卡”存储库和另一个“考勤”记录存储库。这样做的好处是，例如“考勤卡”的业务规则本身就在一个地方。但我也想有一种方法来获取所有时间记录的列表，无论类型如何。目前尚不清楚在这种情况下使用哪个存储库。两个都？

## 3 存储库

具有一个用于“时间卡”的存储库、另一个用于“出勤”记录的存储库以及提供所有时间记录的只读列表的第三个存储库的设计也是可能的。与 2 存储库设计一样，这具有优势，例如，“时间卡”的业务规则位于一个位置。现在很清楚从何处获取组合列表。但是我发现我可以从两个不同的存储库中获得相同的记录有点奇怪。

## 杂交种

混合方法将使用单个存储库，但将任何业务规则代码（包括记录选择）移动到单独的类型中。在此示例中，单个“时间记录存储库”将聚合“时间卡”和“出勤”时间的业务规则实现类的实例。我认为这是我现在喜欢的方法。

## 其他？

我错过了什么？一种设计优于另一种设计有什么令人信服的论据吗？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-02-24T21:22:14.560

1.  至少据我所知，存储库不是存放业务规则的地方。它们只是模仿系列的外观；在它们下面，它们基本上是纯数据访问（如果那是它们的工作，那么您可能也不会使用存储库来持久化任何东西）。因此，出于“业务规则”的原因，不应考虑使用单独的存储库。

2.  如果您的域对象确实是单独的对象，那么您应该有单独的存储库。记住什么是存储库：它是一个门面。它模仿您的域的集合。有关存储库的非常好的博客文章，请参见此处：http: [//devlicio.us/blogs/casey/archive/2009/02/20/ddd-the-repository-pattern.aspx](http://devlicio.us/blogs/casey/archive/2009/02/20/ddd-the-repository-pattern.aspx)

存储库是一个门面；一个抽象。

也就是说......我不认为你有单独的对象。您在这里遇到了一些与存储库无关的问题，而与域和域的设计有关。这两种“时间卡”实际上是两种不同的东西，还是真的相同？

你说，*“但是我发现我可以从两个不同的存储库中获得相同的记录有点奇怪。”*

这告诉我，它们实际上是*相同*的数据，以不同的方式表达。有办法处理这个问题。

如果情况确实如此，那么您在这里拥有的是公共基类的子类（例如，可以很容易地在 DB 中建模并使用 NHibernate 优雅地处理的东西）。

我会给你一个我正在做的项目的例子。我有一个叫做“广播”的东西。这是一个基类；抽象的。无法实例化。我有这个类的两个特定的具体类型：DeviceBroadcast 和 FileBroadcast。一个从设备（如 DirectX 采集卡）流式传输音频/视频，一个从文件源（如 .mp3）流式传输音频/视频。

我有一个返回广播对象的存储库。我可以将其转换为 FileBroadcast 以操作有关 FileBroadcast 的特定信息，或者出于同样的原因，我可以将其转换为 DeviceBroadcast - 如果它属于该类型。广播不能同时是 FileBroadcast 和 DeviceBroadcast 类型。它必须是其中之一。

在数据库中，我将通用广播参数存储在广播表中，然后将文件特定属性存储在 FileBroadcast 表中。DeviceBroadcast 表也是如此；分离。但是，当我通过存储库查询时，我只想要广播。那是我的根聚合对象，因此那是我的存储库。

Broadcast 基类具有两个子类都使用的通用方法（例如 GetCommand() 方法，该方法返回特定的命令行参数以启动 VLC 进程）。子类必须重写并实现该方法，因为它是抽象的。这样，FileBroadcast 特有的“业务逻辑”就包含在 FileBroadcast 类中了。DeviceBroadcast 特有的“业务逻辑”包含在 DeviceBroadcast 类中。两者共有的任何逻辑都包含在超类 Broadcast 中。

您似乎在这里有类似的情况，这就是我分享我的设计的原因。我想它可能对你有好处。

最重要的是，请考虑您的域和数据。如果您打算通过单独的存储库获取重复数据，那么您需要更多地考虑如何设计域。也不要让用户决定您的域设计。他们从自己的角度了解领域。您所要做的就是能够以他们理解的方式向他们展示数据。这并不意味着你必须有一个糟糕的设计。您可以在幕后进行良好的设计，因为您的代码是必须使用域的东西。

# c# - 将字符串分成子字符串

> ID：582297
> 
> 赞同：0
> 
> 时间：2009-02-24T15:53:35.380
> 
> 标签：c#, .net, string

我想将由一个或多个用逗号分隔的两个字母代码组成的字符串分隔成两个字母的子字符串，并将它们放入字符串数组或其他合适的数据结构中。结果是在某一时刻被数据绑定到组合框，因此需要考虑这一点。

我要操作的字符串可以是空的，仅由两个字母组成，也可以由多个用逗号分隔的两个字母代码（可能还有一个空格）组成。

我正在考虑使用一个简单的字符串数组，但我不确定这是否是最好的方法。

那么......你会推荐我使用什么数据结构，你将如何实现它？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-02-24T15:58:13.170

绝对至少从一个字符串数组开始，因为它的返回类型是`string.Split()`：

```
string MyCodes = "AB,BC,CD";
char[] delimiters = new char[] {',', ' '};
string[] codes = MyCodes.Split(delimiters, StringSplitOptions.RemoveEmptyEntries); 
```

更新：为分隔符添加空间。这将产生从结果字符串中修剪空格的效果。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-02-24T15:59:04.260

像这样的东西会起作用吗？

```
var list = theString.Split(", ".ToCharArray(), StringSplitOptions.RemoveEmptyEntries).ToList(); 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-24T15:58:50.483

我的回答是“正确的”，但我建议 Joel Coehoorn 的回答。

```
public static string[] splitItems(string inp)
{
    if(inp.Length == 0)
        return new string[0];
    else
        return inp.Split(',');
} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-24T15:56:02.877

如果您只是要绑定到结构，那么 a`String[]`应该没问题 - 如果您需要在将数据用作数据源之前处理数据，那么 a`List<String>`可能是更好的选择。

这是一个例子：

```
using System;
using System.Collections.Generic;

class Program
{
    static void Main()
    {
        String s = "ab,cd,ef";

        // either a String[]
        String[] array = s.Split(new Char[] {','});
        // or a List<String>
        List<String> list = new List<String>(s.Split(new Char[] { ',' }));
    }
} 
```

# windows - Windows 2003 Enterprise Edition x32 和内存上的 IIS6

> ID：582298
> 
> 赞同：0
> 
> 时间：2009-02-24T15:53:52.587
> 
> 标签：windows, memory, iis-6

我有 ASP.NET 2.0 应用程序在 32 位 Windows 2K3 标准版和 4GB RAM 上运行。我想将服务器升级到企业版并添加更多内存，总共 6GB。我假设我需要启用 PAE 扩展来执行此操作。

这个额外的 2GB 中有多少可以用于 W3WP 工作进程？根本问题是 2 个 WP 经常超过 900MB 并导致 OutOfMemory 异常。

另一种选择是我获得一台新服务器并将一半的应用程序移至该服务器，这是一个更昂贵且耗时的选择。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-23T13:22:58.713

为了使用额外的 2GB /PAE，必须在 boot.ini 中启用。然后，每个 WP 仍将被限制为 2GB 物理内存。

[http://support.microsoft.com/kb/283037](http://support.microsoft.com/kb/283037) [http://msexchangeteam.com/archive/2004/08/20/217772.aspx](http://msexchangeteam.com/archive/2004/08/20/217772.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-24T15:59:04.493

您将不需要 PAE 扩展。只要您没有自己需要超过 2GB 的 WP。

# jquery - 你知道 YUI 或任何其他丰富的 javascript 库的 GUI 设计器吗？

> ID：582299
> 
> 赞同：2
> 
> 时间：2009-02-24T15:54:03.757
> 
> 标签：jquery, yui, gui-designer

这个问题说明了一切......我们正在购买一个丰富的 javascript 库，并且即将选择 YUI。GUI 设计者（不）存在的问题将强烈影响我们的选择。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-24T15:58:33.853

[YUI CSS Grid Builder](http://developer.yahoo.com/yui/grids/builder/ "YUI CSS 网格生成器")是否满足您的需求？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-25T03:01:30.080

安迪，

Daniel 的回答对于 YUI CSS Grids 来说是一个很好的回答。没有支持 YUI 小部件 afaik 的所见即所得编辑器，但如果您是 Dreamweaver CS4 用户，可能会对这篇文章感兴趣：

[http://www.adobe.com/devnet/dreamweaver/articles/using_yui_widgets.html](http://www.adobe.com/devnet/dreamweaver/articles/using_yui_widgets.html)

YUI 的创始人 Thomas Sha 做了大量工作以使 Dreamweaver 用户更容易访问 YUI 的小部件。

Aptana 也做了很多工作来确保所有的大型 JS 套件都得到很好的支持。他们为 2.6.0 提供了一个很好的 YUI 插件，并且正在开发 2.7.0 更新：

[http://yuiblog.com/blog/2008/10/28/aptana/](http://yuiblog.com/blog/2008/10/28/aptana/)

-埃里克

# c++ - 是否有用于模板使用的优化 C++ 编译器？

> ID：582302
> 
> 赞同：23
> 
> 时间：2009-02-24T15:54:39.527
> 
> 标签：c++, templates, compiler-construction

C++ 模板因其强大的功能而成为我日常工作中的福音。但是不能忽略大量使用模板（hello 元编程和 Boost 库）导致的（非常非常非常长的）编译时间。我已经阅读并尝试了很多手动重组和修改模板代码以使其尽可能快地编译的可能性。

现在我想知道是否有任何 C++ 编译器尝试最小化解释模板类所需的时间。我可能错了，但我觉得我所知道的编译器只在他们以前的版本中添加了模板解释。

我的问题是：

*   c++ 模板代码是否难以解释以至于没有太多需要优化的地方？（我非常怀疑）
*   是否有真正优化“c++ 模板”解释的 c++ 编译器？
*   是否有项目可以开发新一代的 c++ 编译器来优化这一点？
*   如果你要参与这样一个项目，你的指导方针是什么？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-02-25T01:51:21.403

我希望通过可变参数模板/右值引用来加快编译模板代码的速度。今天，如果我们想编写在编译时做某事的模板代码，我们就会滥用语言的规则。我们创建了几十个重载和模板特化来产生我们想要的结果，但不是以一种告诉编译器我们的意图的方式。因此，编译器在构建时几乎没有捷径可走。请参阅[可变参数模板的动机](http://www.osl.iu.edu/~dgregor/cpp/variadic-templates.html#motivation)

> 是否有项目可以开发新一代的 c++ 编译器来优化这一点？

是的，有[CLang](http://clang.llvm.org/)，它是 LLVM 编译器基础架构的 C 语言前端。CLang 和 LLVM 都是使用 C++ 编码的。CLang 的开发者中有 Douglas Gregor，他是几个 C++1x 语言提案（如可变参数模板和概念）的作者。作为参考，请参阅 Douglas Gregor 对 GCC 的铿锵声测试

[![](https://i.stack.imgur.com/xlM2s.png)](https://i.stack.imgur.com/xlM2s.png)

> 以下是 Clang 和 GCC 4.2 中模板实例化的一些快速 n-dirty 性能结果。测试非常简单：测量通过模板元程序计算第 N 个斐波那契数的翻译单元的编译时间（仅 -fsyntax）。Clang 似乎随着实例化的数量线性（或接近）缩放。而且，尽管您在图表中看不到它，但 Clang 在开始时比 GCC 快 2 倍多一点（`Fibonacci<100>`）。

CLang 仍处于[早期阶段](http://clang.llvm.org/cxx_status.html)，但我认为它有很好的机会成为出色的 C++ 编译器。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-02-25T01:42:25.323

这真的不是你问题的答案。更多的是侧面观察。

我也不是 C++ 语言律师，所以我可能对一些细节有些偏离。

但是，粗略的想法应该是正确的。

C++ 编译器需要这么长时间来编译模板元程序的主要原因是模板元程序的指定方式。

它们没有直接指定为您希望编译器在编译时运行的代码。以计算类型列表的长度为例。

如果你能写出这样的代码：

```
compile_time size_t GetLength(TypeList * pTypeList)
{
    return DoGetLength(pTypeList, 0);
}

compile_time size_t DoGetLength(TypeList * pTypeList, size_t currentLength)
{
    if (pTypeList)
    {
        return DoGetLength(pTypeList->Next, ++currentLength);
    }
    else
    {
         return currentLength;
    }
} 
```

这是一些如何与使用它的代码分开编译的方式，并通过某种语法暴露给语言，然后编译器将能够非常快速地执行它。

这只是一个简单的递归函数调用。

可以设计允许这些事情的语言。大多数这样做的（如 lisp）都是动态类型的，但也可以使用静态类型。但是，它不太可能是您在 C++ 中看到的实现。

然而，C++ 中的问题是代码编写如下：

```
template <typename First,  typename Second>
struct TypeList
{
    typedef First Head;
    typedef Second Tail;
};

template <>
struct ListSize<NullType>
{
    enum {  size = 0  };
};

template <typename Head, typename Tail>
struct ListSize<TypeList<Head, Tail> >
{
    enum {  size = 1 + ListSize<Tail>::size  };
}; 
```

为了让编译器“执行”元程序，它必须：

1.  为“size”枚举值的初始值构造依赖图
2.  为图中的每条边构造一个模板类型
3.  绑定每个构造的模板类型引用的所有符号
4.  对依赖图进行拓扑排序
5.  遍历图形并计算常数

这比简单地运行 O(N) 递归算法要昂贵得多。

最坏的情况类似于 O(N * M * L)，其中 N 等于列表的长度，M 是范围嵌套的级别，L 是每个范围中的符号数。

我的建议是尽量减少您使用的 C++ 模板元编程的数量。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-02-25T01:56:33.793

模板的**主要问题**如下：

*您不能（通常）将模板类的定义与其声明分开并将其放在 .cpp 文件中。*

结果：**Everyting 在头文件中。**每当您包含头文件时，您都会包含大量代码，这些代码在正常情况下会很好地分离到 .cpp 文件中并单独编译。每个编译单元都包含一些头文件，因此，对于模板，每个编译单元都包含*大量*代码，或者通过包含的头文件包含几乎所有项目。

如果这是您的问题，那么请看这里，一个相关的问题：

*   [模板：使用前向声明来减少编译时间？](https://stackoverflow.com/questions/555330/templates-use-forward-declarations-to-reduce-compile-time)

它得到了一个[很好的答案](https://stackoverflow.com/questions/555330/templates-use-forward-declarations-to-reduce-compile-time/555349#555349)，它确实**解决了这个问题**。

基本上，它涉及将您需要的模板实例化一次，然后将它们编译成目标文件。稍后您可以链接它，并且您不必在任何地方都包含该代码。它被分成一个编译的目标文件。注意：仅当您只使用少数实例化类型的模板时才有意义（例如，您只需要在您的程序中使用`MyType<int>`and `MyType<double>`）。

它使用`g++`标志`-fno-implicit-templates`。

该技术非常有用，我认为应该将其合并到 C++ 常见问题解答中：[[35.12] 为什么我不能将模板类的定义与其声明分开并将其放入 .cpp 文件中？](http://www.parashift.com/c++-faq-lite/templates.html#faq-35.12)

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2010-04-19T11:44:50.357

似乎 g++ 4.5 在处理模板方面取得了巨大进步。这是两个不可避免的变化。

*   “在打印类模板特化的名称时，G++ 现在将省略任何来自默认模板参数的模板参数。” 这可以被认为是一个微妙的修改，但它会对使用 c++ 模板的开发产生巨大的影响（听说过不可读的错误消息......？不再有！）

*   “使用模板的代码的编译时间现在应该与实例化的数量成线性关系，而不是二次方。” 这将严重破坏反对使用 C++ 模板的编译时参数。

有关完整信息，请参见[gnu 站点](http://gcc.gnu.org/gcc-4.5/changes.html)

实际上，我已经想知道 C++ 模板是否还有问题！嗯，是的，有，但现在让我们专注于光明的一面！

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-02-24T16:00:29.887

这不会是您想要的答案，但 Walter Bright 是第一个本机 C++ 编译器的主要开发人员，也是一个优化的 C++ 编译器。毕竟他编写了自己的编程语言 D。它基本上是对 C++ 的改进，并且可以更好地处理模板。

我不知道它针对模板使用进行了优化的任何 c++ 编译器。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-07-31T12:57:58.450

黄金[链接器](http://en.wikipedia.org/wiki/Gold_%28linker%29)可以帮助将链接时间减少大约 5 倍，这可以减少整体编译时间。它特别有用，因为链接不能以与编译相同的方式并行化。

（不是直接的答案，但希望这会有所帮助）。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-02-24T16:57:13.683

尝试[Incredibuild](http://www.xoreax.com/)。它极大地减少了编译/构建时间。

该产品基本上使 Visual C++ 能够利用空闲周期跨组织中的多台计算机进行构建。我在包含大量模板代码的大型项目 (500 kloc) 上使用了 Incredibuild，并且在构建时间上得到了很好的加速。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-02-24T16:56:41.203

我认为模板本身并不复杂。我们将看到何时在 c++0x 等中引入概念，但目前，模板只是（几乎）作为宏，所以真正的问题不在于您是否为模板优化了 c++ 编译器。问题是模板在编译时确实会生成如此大量的代码，这会使编译速度变慢。

# xaml - 如何在 Blend 中使形状边缘模糊？

> ID：582307
> 
> 赞同：0
> 
> 时间：2009-02-24T15:55:29.913
> 
> 标签：xaml, expression-blend

我在另一个上面有一个矩形。

它们有锋利的边缘。

我想让它们模糊在一起。

似乎有一种方法可以使用“位图效果”来模糊它们，但我在 Blend 的 Rectangle 属性搜索中没有找到它。

如何模糊一个矩形的边缘，使两者在接触的地方没有锋利的边缘？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-24T15:57:12.750

添加具有半透明的边框。

**编辑：**

我在想不透明度会给你想要的效果。您可以使用 OpacityMask 和 BorderBrush 提供 ImageBrush 来实现您所追求的更高级的效果。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-25T10:13:09.247

在**Rectangle**属性窗口中，转到**Miscellaneous**部分，它们是一个**Effect**属性。选择**New**，你可以选择一个**BlurEffect**

您需要注意，这会对性能产生负面影响，尤其是在 PC 没有良好显卡的情况下。此外，目前Silverlight 不支持**BitmapEffect**，因此您必须在另一个图形程序中对其进行模糊处理并仅显示图像。

生成的 XAML 如下所示：

```
 <Rectangle Fill="#FFFFFFFF" Stroke="#FF000000" HorizontalAlignment="Left" Margin="56,172,0,0" VerticalAlignment="Top" Width="107" Height="36">
        <Rectangle.Effect>
            <BlurEffect/>
        </Rectangle.Effect>
    </Rectangle> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-14T11:01:35.160

如果您尚未在 Blend 中找到此效果，请执行以下操作。

1.  在 Blend 中选择您的矩形作为当前具有焦点的对象。
2.  **从“属性”选项卡中，选择“外观”选项卡下的展开器向下箭头。这将在 StrokeThickness 属性下。**
3.  展开区域中的第一项是 BitmapEffect。使用右侧的组合框，从组合框下拉菜单中选择模糊。
4.  您现在可以通过使用 Gaussian 或 Box 并调整模糊半径来调整模糊。

# vb.net - 如何在 RichTextBox 中隐藏插入符号？

> ID：582312
> 
> 赞同：10
> 
> 时间：2009-02-24T15:56:31.533
> 
> 标签：vb.net, .net-3.5

就像标题一样：我在网上搜索了答案，但我找不到在 VB.NET 中隐藏 RichTextBox 插入符号的方法。

我尝试将 RichTextBox.Enabled 属性设置为 False，然后将背景颜色和前景色更改为非灰色，但这并没有奏效。

提前致谢。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2011-09-09T13:07:38.783

解决方案：

来自：[http ://www.experts-exchange.com/Programming/Languages/C_Sharp/Q_21896403.html](http://www.experts-exchange.com/Programming/Languages/C_Sharp/Q_21896403.html)

```
using System;
using System.Windows.Forms;
using System.ComponentModel;
using System.Runtime.InteropServices;

public class ReadOnlyRichTextBox : System.Windows.Forms.RichTextBox
{

  [DllImport("user32.dll")]
  private static extern int HideCaret (IntPtr hwnd);

  public ReadOnlyRichTextBox()
  {
    this.MouseDown += new System.Windows.Forms.MouseEventHandler(this.ReadOnlyRichTextBox_Mouse);
    this.MouseUp += new System.Windows.Forms.MouseEventHandler(this.ReadOnlyRichTextBox_Mouse);
    base.ReadOnly = true;
    base.TabStop = false;
    HideCaret(this.Handle);
  }

  protected override void OnGotFocus(EventArgs e)
  {
    HideCaret(this.Handle);
  }

  protected override void OnEnter(EventArgs e)
  {
    HideCaret(this.Handle);
  }

  [DefaultValue(true)]
  public new bool ReadOnly
  {
    get { return true; }
    set { }
  }

  [DefaultValue(false)]
  public new bool TabStop
  {
    get { return false; }
    set { }
  }

  private void ReadOnlyRichTextBox_Mouse(object sender, System.Windows.Forms.MouseEventArgs e)
  {
    HideCaret(this.Handle);
  }

  private void InitializeComponent()
  {
    //
    // ReadOnlyRichTextBox
    //
    this.Resize += new System.EventHandler(this.ReadOnlyRichTextBox_Resize);

  }

  private void ReadOnlyRichTextBox_Resize(object sender, System.EventArgs e)
  {
    HideCaret(this.Handle);

  }
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2017-11-02T11:59:29.193

将richTextBox 控件放在窗体上

将表单名称设置为 Form1

将richTextBox 名称设置为richTextBox1

如果您不想让用户复制文本集richTextBox1 ShortcutsEnabled 属性为 False

转到 Project->Add Component，输入组件名称 ReadOnlyRichTextBox.cs

然后打开 ReadOnlyRichTextBox.cs 并粘贴以下代码：

```
using System;
using System.Runtime.InteropServices;
using System.Windows.Forms;

namespace <Replace with your app namespace>
{
    public partial class ReadOnlyRichTextBox : RichTextBox
    {
        [DllImport("user32.dll")]
        static extern bool HideCaret(IntPtr hWnd);

        public ReadOnlyRichTextBox()
        {
            this.ReadOnly = true;
        }

        protected override void WndProc(ref Message m)
        {
            base.WndProc(ref m);
            HideCaret(this.Handle);
        }
    }
} 
```

从解决方案资源管理器中打开您的“Form1.Designer.cs”并在此文件中替换以下行：

this.richTextBox1 = new System.Windows.Forms.RichTextBox();

和

this.richTextBox1 = new ReadOnlyRichTextBox();

和

私有 System.Windows.Forms.RichTextBox richTextBox1;

和

私有 ReadOnlyRichTextBox richTextBox1;

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-24T17:52:15.297

您可以使用 HideCaret API 函数，在 www.pinvoke.net 上查看。诀窍是知道何时调用它。一个非常简单而肮脏的解决方案是在 RTF 的 Enter 事件中启动一次性计时器。按照 nobugs 的建议在 WndProc 中捕获正确的消息会更好，不幸的是，捕获的消息是错误的......

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-07-08T00:25:05.537

这对我有用：

```
public class RichTextLabel : RichTextBox
{
    public RichTextLabel()
    {
        base.ReadOnly = true;
        base.BorderStyle = BorderStyle.None;
        base.TabStop = false;
        base.SetStyle(ControlStyles.Selectable, false);
        base.SetStyle(ControlStyles.UserMouse, true);
        base.SetStyle(ControlStyles.SupportsTransparentBackColor, true);

        base.MouseEnter += delegate(object sender, EventArgs e)
        {
            this.Cursor = Cursors.Default;
        };
    }

    protected override void WndProc(ref Message m) {
        if (m.Msg == 0x204) return; // WM_RBUTTONDOWN
        if (m.Msg == 0x205) return; // WM_RBUTTONUP
        base.WndProc(ref m);
    }
} 
```

我希望它有帮助

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2011-02-23T21:01:33.260

```
/// <summary>
/// Transparent RichTextBox
/// To change BackColor add a Panel control as holder of RichTextLabel
/// </summary>
public class RichTextLabel : RichTextBox
{
    public RichTextLabel()
    {
        base.Enabled = false;
        base.ReadOnly = true;
        base.ScrollBars = RichTextBoxScrollBars.None;
        base.ForeColor = Color.FromArgb(0, 0, 1);
    }

    override protected CreateParams CreateParams
    {
        get
        {
            CreateParams cp = base.CreateParams;
            cp.ExStyle |= 0x20;
            return cp;
        }
    }

    override protected void OnPaintBackground(PaintEventArgs e)
    {
    }
} 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2018-07-05T06:41:28.487

我知道它很旧，但我在这里看到了很多不同的选择。我必须为我补充一点，这成功了：

```
this.textRichBox.ReadOnly = false;
this.textRichBox.TabStop = false; 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-07-08T00:28:48.207

做一些事情来防止它获得“输入焦点”：它会有插入符号，并且是可编辑的，只有当它有焦点时。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2011-01-14T09:42:29.537

在这里，我有一个名为 txtMessage 的富文本控件，它的事件被处理以隐藏将显示它的事件上的插入符号。

```
<System.Runtime.InteropServices.DllImport("user32.dll")>
Private Shared Function HideCaret(ByVal hWnd As IntPtr) As Boolean
End Function

Public Sub New()
    txtMessage.ReadOnly = True
    txtMessage.TabStop = False
End Sub

Private Sub txtMessage_KeyUp(ByVal sender As Object, ByVal e As System.Windows.Forms.KeyEventArgs) Handles txtMessage.KeyUp
    HideCaret(txtMessage.Handle)
End Sub

Private Sub txtMessage_MouseDown(ByVal sender As Object, ByVal e As System.Windows.Forms.MouseEventArgs) Handles txtMessage.MouseDown
    HideCaret(txtMessage.Handle)
End Sub

Private Sub txtMessage_SelectionChanged(ByVal sender As Object, ByVal e As EventArgs) Handles txtMessage.SelectionChanged
    HideCaret(txtMessage.Handle)
End Sub 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2015-11-11T18:09:18.927

最小版本（优化）：

```
public class ReadOnlyRichTextBox : RichTextBox
{
    [DllImport("user32.dll")]
    static extern bool HideCaret(IntPtr hWnd);

    public ReadOnlyRichTextBox()
    {
        ReadOnly = true;
        SetStyle(ControlStyles.Selectable, false);
    }

    protected override void OnHandleCreated(EventArgs e)
    {
        base.OnHandleCreated(e);
        HideCaret(this.Handle);
    }

    protected override void OnEnter(EventArgs e)
    {
        base.OnEnter(e);
        HideCaret(this.Handle);
    }

    protected override void OnGotFocus(EventArgs e)
    {
        base.OnGotFocus(e);
        HideCaret(this.Handle);
    }

    protected override void OnMouseDown(MouseEventArgs e)
    {
        base.OnMouseDown(e);
        if (e.Button == MouseButtons.Left)
            HideCaret(this.Handle);
    }
} 
```

# php - 将嵌套讨论分隔在多个页面上的最佳方法是什么 - 对于 Web 应用程序？

> ID：582315
> 
> 赞同：2
> 
> 时间：2009-02-24T15:57:09.910
> 
> 标签：php, mysql, user-interface, comments, hierarchy

我正在为 PHP/MySQL 应用程序设计一个线程消息显示——比如 Slashdot 或 Youtube 上的评论——我想知道我应该如何对评论进行排序并将其分成页面，这样你就可以在一个页面上有 20 条评论但仍然让它们嵌套。

我的应用程序中的评论可以嵌套无限级别，并且此结构使用我认为的邻接关系表表示，这是一个单独的表，其中包含具有任何升序/降序关系的每一对的一行。该关系表具有 CHILDID、PARENTID 和 LEVEL，其中级别 2 表示“曾祖父母”，依此类推。

我的问题是最终用户的可用性和构建高效数据库查询的实用性之一。我考虑了这些选项：

*   无论在树中的位置如何，按日期将结果拆分为页面，以便特定日期范围内的所有评论将一起出现，即使它们没有与父母一起出现。任何在同一时间发布到其父级的评论都将出现在同一页面上，在这种情况下，我们可以将它们显示为“嵌套”，但会有来自其父级的孤立评论。这可能是可以接受的 - 这是 YouTube 评论中的处理方式 - 比其父级晚得多的评论不会与其父级出现在同一页面上（如果父级不在最新页面上），而是出现其他最新评论。

*   像遍历树一样按顺序检索节点。尽管兄弟姐妹仍然可以按日期排序，但这会优先考虑树结构而不是日期。这样做的好处是，即使该父级是最近评论的数页，回复总是与他们的父级（他们要回复的评论）一起放置。这就是 icanhascheezburger 博客等应用程序的处理方式。我不喜欢它的一些事情，比如每个人都想对最大的树枝添加回复的方式。

*   第三种选择是像 Slashdot 那样做，它不会将评论分成页面，而是有一棵大树 - 为了保持页面大小可管理，它开始剔除低评级的评论。

我认为第一个是给定我的关系表的最简单的数据库查询，但对其他想法持开放态度。

所有这三种系统中的一些这样的系统以某种方式限制了嵌套级别——这很容易做到，一旦我们递归了 X 级别，其他所有东西都可以组合在一起，就好像它们是兄弟姐妹一样。例如，YouTube 评论只呈现到一个级别。其他系统有时会在 5 个左右的级别后说“超出嵌套级别”。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-25T14:43:38.503

我认为您想要嵌套评论的原因是因为您的用户倾向于一次阅读一个感兴趣的线程。也就是说，您有理由相信用户会创建连贯的思想链，和/或在一个线程中讨论的内容会引起一些用户的兴趣，而其他用户则不会。

如果是这种情况，我不知道您为什么要按日期任意拆分页面（选项 1）。使用单页剔除低评分评论（选项 3）似乎有点苛刻，可能会阻止用户发表评论。如果您拥有像 SlashDot 这样的受众群体，这可能是一件好事，但对于具有更典型访问率的网站来说，这可能是不可取的。

也许你可以有类似选项 2 的东西，所有线程都在同一个页面上，但是如果一个线程开始变得太长，它会被卷成一个链接，将用户带到一个专用于该线程的页面。或者，可以减少长线程以仅显示其主题行和作者，每个主题行和作者又链接到线程专用页面中的适当位置。

我怀疑用户在最大线程中发布不相关评论的趋势是用户不想被滚动以找到线程末尾或找到更合适的线程的产物。通过自动压缩长线程，将所有线程的根显示在可管理长度的单个页面上，用户可以轻松扫描感兴趣的线程并在需要时添加到它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-24T19:10:52.177

我认为您需要将分层数据存储在数据库中。您应该从这篇文章开始： [sitepoint](http://www.sitepoint.com/article/hierarchical-data-database/) [上的文章 MySQL 网站上的文章](http://mikehillyer.com/articles/managing-hierarchical-data-in-mysql/)

# c++ - 有没有办法从保存类名的字符串中实例化对象？

> ID：582331
> 
> 赞同：152
> 
> 时间：2009-02-24T15:59:59.810
> 
> 标签：c++, inheritance, factory, instantiation

我有一个文件：Base.h

```
class Base;
class DerivedA : public Base;
class DerivedB : public Base;

/*etc...*/ 
```

和另一个文件：BaseFactory.h

```
#include "Base.h"

class BaseFactory
{
public:
  BaseFactory(const string &sClassName){msClassName = sClassName;};

  Base * Create()
  {
    if(msClassName == "DerivedA")
    {
      return new DerivedA();
    }
    else if(msClassName == "DerivedB")
    {
      return new DerivedB();
    }
    else if(/*etc...*/)
    {
      /*etc...*/
    }
  };
private:
  string msClassName;
};

/*etc.*/ 
```

有没有办法以某种方式将此字符串转换为实际类型（类），这样 BaseFactory 就不必知道所有可能的派生类，并且每个都有 if() ？我可以从这个字符串生成一个类吗？

我认为这可以通过反射在 C# 中完成。C ++中有类似的东西吗？

* * *

## 回答 #1

> 赞同：240
> 
> 时间：2009-02-24T16:30:29.393

不，没有，除非您自己进行映射。C++ 没有创建类型在运行时确定的对象的机制。不过，您可以使用地图自己进行映射：

```
template<typename T> Base * createInstance() { return new T; }

typedef std::map<std::string, Base*(*)()> map_type;

map_type map;
map["DerivedA"] = &createInstance<DerivedA>;
map["DerivedB"] = &createInstance<DerivedB>; 
```

然后你可以做

```
return map[some_string](); 
```

获取新实例。另一个想法是让类型自己注册：

```
// in base.hpp:
template<typename T> Base * createT() { return new T; }

struct BaseFactory {
    typedef std::map<std::string, Base*(*)()> map_type;

    static Base * createInstance(std::string const& s) {
        map_type::iterator it = getMap()->find(s);
        if(it == getMap()->end())
            return 0;
        return it->second();
    }

protected:
    static map_type * getMap() {
        // never delete'ed. (exist until program termination)
        // because we can't guarantee correct destruction order 
        if(!map) { map = new map_type; } 
        return map; 
    }

private:
    static map_type * map;
};

template<typename T>
struct DerivedRegister : BaseFactory { 
    DerivedRegister(std::string const& s) { 
        getMap()->insert(std::make_pair(s, &createT<T>));
    }
};

// in derivedb.hpp
class DerivedB {
    ...;
private:
    static DerivedRegister<DerivedB> reg;
};

// in derivedb.cpp:
DerivedRegister<DerivedB> DerivedB::reg("DerivedB"); 
```

您可以决定为注册创建一个宏

```
#define REGISTER_DEC_TYPE(NAME) \
    static DerivedRegister<NAME> reg

#define REGISTER_DEF_TYPE(NAME) \
    DerivedRegister<NAME> NAME::reg(#NAME) 
```

我敢肯定这两个有更好的名字。在这里使用可能有意义的另一件事是`shared_ptr`.

如果你有一组没有公共基类的不相关类型，你可以给函数指针一个返回类型`boost::variant<A, B, C, D, ...>`。就像你有一个类 Foo、Bar 和 Baz，它看起来像这样：

```
typedef boost::variant<Foo, Bar, Baz> variant_type;
template<typename T> variant_type createInstance() { 
    return variant_type(T()); 
}

typedef std::map<std::string, variant_type (*)()> map_type; 
```

A`boost::variant`就像一个工会。它通过查看用于初始化或分配给它的对象来知道其中存储了哪种类型。[在这里](http://www.boost.org/doc/libs/1_38_0/doc/html/variant.html)查看它的文档。最后，使用原始函数指针也有点陈旧。现代 C++ 代码应该与特定的函数/类型分离。您可能想研究[`Boost.Function`](http://www.boost.org/doc/libs/1_38_0/doc/html/function.html)以寻找更好的方法。它看起来像这样（地图）：

```
typedef std::map<std::string, boost::function<variant_type()> > map_type; 
```

`std::function`也将在下一版本的 C++ 中可用，包括`std::shared_ptr`.

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-02-24T16:08:48.917

不，没有。我对这个问题的首选解决方案是创建一个将名称映射到创建方法的字典。想要像这样创建的类然后向字典注册创建方法。[GoF 模式一书中](http://en.wikipedia.org/wiki/Design_Patterns_(book))对此进行了详细讨论。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-02-24T16:15:18.883

简短的回答是你不能。有关原因，请参阅这些 SO 问题：

1.  [为什么 C++ 没有反射？](https://stackoverflow.com/questions/359237/why-does-c-not-have-reflection)
2.  [如何向 C++ 应用程序添加反射？](https://stackoverflow.com/questions/41453/how-can-i-add-reflection-to-a-c-application)

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-02-24T16:10:50.207

我已经回答了关于 C++ 工厂的另一个 SO question。如果对灵活工厂感兴趣，请查看[那里。](https://stackoverflow.com/questions/410823/factory-method-implementation-c/534396#534396)我尝试从 ET++ 中描述一种使用宏的旧方法，这对我来说非常有用。

[ET++](http://www.ubilab.org/publications/wei94.html)是一个将旧的 MacApp 移植到 C++ 和 X11 的项目。在此过程中，Eric Gamma 等人开始考虑*设计模式*

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2013-08-15T13:25:00.167

boost::functional 有一个非常灵活的工厂模板：http: [//www.boost.org/doc/libs/1_54_0/libs/functional/factory/doc/html/index.html](http://www.boost.org/doc/libs/1_54_0/libs/functional/factory/doc/html/index.html)

不过，我的偏好是生成隐藏映射和对象创建机制的包装类。我遇到的常见场景是需要将某个基类的不同派生类映射到键，其中派生类都具有可用的公共构造函数签名。这是我到目前为止提出的解决方案。

```
#ifndef GENERIC_FACTORY_HPP_INCLUDED

//BOOST_PP_IS_ITERATING is defined when we are iterating over this header file.
#ifndef BOOST_PP_IS_ITERATING

    //Included headers.
    #include <unordered_map>
    #include <functional>
    #include <boost/preprocessor/iteration/iterate.hpp>
    #include <boost/preprocessor/repetition.hpp>

    //The GENERIC_FACTORY_MAX_ARITY directive controls the number of factory classes which will be generated.
    #ifndef GENERIC_FACTORY_MAX_ARITY
        #define GENERIC_FACTORY_MAX_ARITY 10
    #endif

    //This macro magic generates GENERIC_FACTORY_MAX_ARITY + 1 versions of the GenericFactory class.
    //Each class generated will have a suffix of the number of parameters taken by the derived type constructors.
    #define BOOST_PP_FILENAME_1 "GenericFactory.hpp"
    #define BOOST_PP_ITERATION_LIMITS (0,GENERIC_FACTORY_MAX_ARITY)
    #include BOOST_PP_ITERATE()

    #define GENERIC_FACTORY_HPP_INCLUDED

#else

    #define N BOOST_PP_ITERATION() //This is the Nth iteration of the header file.
    #define GENERIC_FACTORY_APPEND_PLACEHOLDER(z, current, last) BOOST_PP_COMMA() BOOST_PP_CAT(std::placeholders::_, BOOST_PP_ADD(current, 1))

    //This is the class which we are generating multiple times
    template <class KeyType, class BasePointerType BOOST_PP_ENUM_TRAILING_PARAMS(N, typename T)>
    class BOOST_PP_CAT(GenericFactory_, N)
    {
        public:
            typedef BasePointerType result_type;

        public:
            virtual ~BOOST_PP_CAT(GenericFactory_, N)() {}

            //Registers a derived type against a particular key.
            template <class DerivedType>
            void Register(const KeyType& key)
            {
                m_creatorMap[key] = std::bind(&BOOST_PP_CAT(GenericFactory_, N)::CreateImpl<DerivedType>, this BOOST_PP_REPEAT(N, GENERIC_FACTORY_APPEND_PLACEHOLDER, N));
            }

            //Deregisters an existing registration.
            bool Deregister(const KeyType& key)
            {
                return (m_creatorMap.erase(key) == 1);
            }

            //Returns true if the key is registered in this factory, false otherwise.
            bool IsCreatable(const KeyType& key) const
            {
                return (m_creatorMap.count(key) != 0);
            }

            //Creates the derived type associated with key. Throws std::out_of_range if key not found.
            BasePointerType Create(const KeyType& key BOOST_PP_ENUM_TRAILING_BINARY_PARAMS(N,const T,& a)) const
            {
                return m_creatorMap.at(key)(BOOST_PP_ENUM_PARAMS(N,a));
            }

        private:
            //This method performs the creation of the derived type object on the heap.
            template <class DerivedType>
            BasePointerType CreateImpl(BOOST_PP_ENUM_BINARY_PARAMS(N,const T,& a))
            {
                BasePointerType pNewObject(new DerivedType(BOOST_PP_ENUM_PARAMS(N,a)));
                return pNewObject;
            }

        private:
            typedef std::function<BasePointerType (BOOST_PP_ENUM_BINARY_PARAMS(N,const T,& BOOST_PP_INTERCEPT))> CreatorFuncType;
            typedef std::unordered_map<KeyType, CreatorFuncType> CreatorMapType;
            CreatorMapType m_creatorMap;
    };

    #undef N
    #undef GENERIC_FACTORY_APPEND_PLACEHOLDER

#endif // defined(BOOST_PP_IS_ITERATING)
#endif // include guard 
```

我通常反对大量使用宏，但我在这里做了一个例外。上面的代码生成一个名为 GenericFactory_N 的类的 GENERIC_FACTORY_MAX_ARITY + 1 个版本，每个 N 介于 0 和 GENERIC_FACTORY_MAX_ARITY 之间。

使用生成的类模板很容易。假设您希望工厂使用字符串映射创建 BaseClass 派生对象。每个派生对象都采用 3 个整数作为构造函数参数。

```
#include "GenericFactory.hpp"

typedef GenericFactory_3<std::string, std::shared_ptr<BaseClass>, int, int int> factory_type;

factory_type factory;
factory.Register<DerivedClass1>("DerivedType1");
factory.Register<DerivedClass2>("DerivedType2");
factory.Register<DerivedClass3>("DerivedType3");

factory_type::result_type someNewObject1 = factory.Create("DerivedType2", 1, 2, 3);
factory_type::result_type someNewObject2 = factory.Create("DerivedType1", 4, 5, 6); 
```

GenericFactory_N 类析构函数是虚拟的以允许以下操作。

```
class SomeBaseFactory : public GenericFactory_2<int, BaseType*, std::string, bool>
{
    public:
        SomeBaseFactory() : GenericFactory_2()
        {
            Register<SomeDerived1>(1);
            Register<SomeDerived2>(2);
        }
}; 

SomeBaseFactory factory;
SomeBaseFactory::result_type someObject = factory.Create(1, "Hi", true);
delete someObject; 
```

请注意，通用工厂生成器宏的这一行

```
#define BOOST_PP_FILENAME_1 "GenericFactory.hpp" 
```

假设通用工厂头文件名为 GenericFactory.hpp

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2015-12-29T13:50:49.747

注册对象的详细解决方案，并使用字符串名称访问它们。

`common.h`：

```
#ifndef COMMON_H_
#define COMMON_H_

#include<iostream>
#include<string>
#include<iomanip>
#include<map>

using namespace std;
class Base{
public:
    Base(){cout <<"Base constructor\n";}
    virtual ~Base(){cout <<"Base destructor\n";}
};
#endif /* COMMON_H_ */ 
```

`test1.h`：

```
/*
 * test1.h
 *
 *  Created on: 28-Dec-2015
 *      Author: ravi.prasad
 */

#ifndef TEST1_H_
#define TEST1_H_
#include "common.h"

class test1: public Base{
    int m_a;
    int m_b;
public:
    test1(int a=0, int b=0):m_a(a),m_b(b)
    {
        cout <<"test1 constructor m_a="<<m_a<<"m_b="<<m_b<<endl;
    }
    virtual ~test1(){cout <<"test1 destructor\n";}
};

#endif /* TEST1_H_ */

3\. test2.h
#ifndef TEST2_H_
#define TEST2_H_
#include "common.h"

class test2: public Base{
    int m_a;
    int m_b;
public:
    test2(int a=0, int b=0):m_a(a),m_b(b)
    {
        cout <<"test1 constructor m_a="<<m_a<<"m_b="<<m_b<<endl;
    }
    virtual ~test2(){cout <<"test2 destructor\n";}
};

#endif /* TEST2_H_ */ 
```

`main.cpp`：

```
#include "test1.h"
#include "test2.h"

template<typename T> Base * createInstance(int a, int b) { return new T(a,b); }

typedef std::map<std::string, Base* (*)(int,int)> map_type;

map_type mymap;

int main()
{

    mymap["test1"] = &createInstance<test1>;
    mymap["test2"] = &createInstance<test2>;

     /*for (map_type::iterator it=mymap.begin(); it!=mymap.end(); ++it)
        std::cout << it->first << " => " << it->second(10,20) << '\n';*/

    Base *b = mymap["test1"](10,20);
    Base *b2 = mymap["test2"](30,40);

    return 0;
} 
```

编译并运行它（已经用 Eclipse 完成了）

输出：

```
Base constructor
test1 constructor m_a=10m_b=20
Base constructor
test1 constructor m_a=30m_b=40 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-02-27T20:03:40.977

Tor Brede Vekterli 提供了一个增强扩展，它提供了您所寻求的功能。目前，它与当前的 boost 库配合有点尴尬，但在更改其基本命名空间后，我能够让它与 1.48_0 一起使用。

[http://arcticinteractive.com/static/boost/libs/factory/doc/html/factory/factory.html#factory.factory.reference](http://arcticinteractive.com/static/boost/libs/factory/doc/html/factory/factory.html#factory.factory.reference)

为了回答那些质疑为什么这样的事情（如反射）对 c++ 有用的人的回答——我将它用于 UI 和引擎之间的交互——用户在 UI 中选择一个选项，引擎采用 UI 选择字符串，并生成所需类型的对象。

在这里使用框架的主要好处（在某处维护一个水果列表）是注册函数在每个类的定义中（并且只需要一行代码调用每个注册类的注册函数） - 而不是包含的文件水果列表，必须在每次派生新类时手动添加。

我使工厂成为我的基类的静态成员。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-02-24T16:06:39.013

与Java中的反射一样。这里有一些信息：http: [//msdn.microsoft.com/en-us/library/y0114hz2 (VS.80).aspx](http://msdn.microsoft.com/en-us/library/y0114hz2(VS.80).aspx)

一般来说，在google上搜索“c++反射”

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-02-24T16:09:14.983

这是工厂模式。见维基百科（和[这个](http://en.wikipedia.org/wiki/Factory_method_pattern#C.2B.2B)例子）。如果没有一些令人震惊的黑客行为，您就无法从字符串创建类型本身。你为什么需要这个？

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2021-11-21T03:52:06.887

是的，可以不使用框架和宏，只获取类方法和构造函数的内存地址。当为此操作配置时，您可以从链接器生成的映射中检索它们。

访问这个网站

[https://ealaframework.no-ip.org/wiki/page/c.reference](https://ealaframework.no-ip.org/wiki/page/c.reference)

# sql-server - 加速 MS SQL 服务器的最佳方法

> ID：582333
> 
> 赞同：10
> 
> 时间：2009-02-24T16:00:13.477
> 
> 标签：sql-server, performance

我想知道是否有人对如何最好地设置 MS SQL 服务器以提高速度有一些一般的系统管理员问题。我已将日志文件放置在具有自己的控制器的不同驱动器上，并将索引移动到它们的驱动器上，但与主数据文件位于同一控制器上。

系统管理员还有什么其他方法可以设置 MS SQL 服务器来加快磁盘访问和查询时间？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-02-24T16:13:06.767

这个问题很笼统，所以一个笼统的答案将适合：

*   使用快速硬件。拥有尽可能多的 RAM。
*   如果使用 32 位操作系统，请让[AWE](http://technet.microsoft.com/en-us/library/ms175581.aspx)正常工作，尤其是在机器是专用数据库服务器的情况下。
*   如果使用 64 位操作系统 - 更好。可以充分利用更多的 RAM。
*   定期分析索引和应用程序性能。需要时，重建索引、创建新索引、删除旧索引等。
*   了解不同类型的索引 - 集群、分区等。
*   必要时，使用索引视图。
*   [DB Tuning advisor](http://msdn.microsoft.com/en-us/library/ms166575.aspx)可以提供帮助。
*   使用负载平衡解决方案让多台服务器运行数据库。
*   了解应用程序的性质 - OLAP 应用程序除了 DataWarehousing 应用程序还有其他需求。这会影响表的结构、磁盘跨度等。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-24T16:06:08.703

按照对性能影响的顺序，从最重要到最不重要：

*   使用适当的数据定义和索引编写更快的代码
*   使用更快的硬件
*   您在此处询问的那种配置技巧。

虽然配置不当或动力不足的服务器会降低性能，但典型的设置应该足够好，以至于从性能的角度来看，这种事情现在已经远远超出了您应该担心的问题。

当然，如果你有一个特定的无法解释的瓶颈，那么也许你需要配置一些东西。但你也应该分享这些信息。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-24T16:09:06.670

使用数据库引擎优化顾问

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-24T16:15:03.813

首先，我会尝试找出瓶颈；您可以改进最多的“事情”是什么/系统中最慢的部分是什么？

是你的代码吗？（适当的索引，基于集合的处理，尽可能避免游标，...）是硬件相关的吗？它与配置有关吗？- 在单独的文件组/单独的磁盘上登录 - 你可以将一些表移动到另一个文件组，以便在查询中经常连接在一起的表在单独的文件组中 - 你经常重建索引吗？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-24T16:05:03.060

快速的 RAID 配置和内存负载。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-24T16:13:33.460

小心 DTA（调整顾问）。这完全取决于工作量。

快速的事情：索引更好。查找长时间运行的查询或慢速查询，并在此处添加索引以支持。如果这是 OLTP，请注意添加太多索引。

编写更好的代码，在某处（此处或 SQLServerCentral.com）发布缓慢的查询，并获得加速它们的想法

更多内存

将日志与数据分离在物理上会有所帮助，但您必须受 IO 约束才能有所作为。

# python - 如何分析 Python 脚本？

> ID：582336
> 
> 赞同：1521
> 
> 时间：2009-02-24T16:01:26.610
> 
> 标签：python, performance, optimization, time-complexity, profiling

[Project Euler](http://en.wikipedia.org/wiki/Project_Euler)和其他编码竞赛通常有最长的运行时间，或者人们夸耀他们的特定解决方案运行速度有多快。使用 Python，有时这些方法有些笨拙 - 即，将计时代码添加到`__main__`.

什么是分析 Python 程序运行时间的好方法？

* * *

## 回答 #1

> 赞同：1590
> 
> 时间：2009-02-24T16:01:40.570

Python 包含一个名为[cProfile](https://docs.python.org/3/library/profile.html#module-cProfile)的分析器。它不仅给出了总运行时间，而且还分别计算了每个函数的时间，并告诉你每个函数被调用了多少次，从而很容易确定你应该在哪里进行优化。

您可以从代码中或从解释器中调用它，如下所示：

```
import cProfile
cProfile.run('foo()') 
```

更有用的是，您可以在运行脚本时调用 cProfile：

```
python -m cProfile myscript.py 
```

为了使它更容易，我制作了一个名为“profile.bat”的小批处理文件：

```
python -m cProfile %1 
```

所以我所要做的就是运行：

```
profile euler048.py 
```

我明白了：

```
1007 function calls in 0.061 CPU seconds

Ordered by: standard name
ncalls  tottime  percall  cumtime  percall filename:lineno(function)
    1    0.000    0.000    0.061    0.061 <string>:1(<module>)
 1000    0.051    0.000    0.051    0.000 euler048.py:2(<lambda>)
    1    0.005    0.005    0.061    0.061 euler048.py:2(<module>)
    1    0.000    0.000    0.061    0.061 {execfile}
    1    0.002    0.002    0.053    0.053 {map}
    1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler objects}
    1    0.000    0.000    0.000    0.000 {range}
    1    0.003    0.003    0.003    0.003 {sum} 
```

编辑：更新了来自 PyCon 2013 的优秀视频资源的链接，标题为 [***Python Profiling***](https://web.archive.org/web/20170318204046/http://lanyrd.com/2013/pycon/scdywg/)
[Also via YouTube](https://www.youtube.com/watch?v=QJwVYlDzAXs)。

* * *

## 回答 #2

> 赞同：487
> 
> 时间：2012-08-06T05:37:07.207

不久前，我做[`pycallgraph`](http://pycallgraph.slowchop.com/)了一个从你的 Python 代码生成可视化的工具。**编辑：**我已经更新了示例以使用 3.3，这是撰写本文时的最新版本。

在`pip install pycallgraph`安装[GraphViz](http://www.graphviz.org/)之后，您可以从命令行运行它：

```
pycallgraph graphviz -- ./mypythonscript.py 
```

或者，您可以分析代码的特定部分：

```
from pycallgraph import PyCallGraph
from pycallgraph.output import GraphvizOutput

with PyCallGraph(output=GraphvizOutput()):
    code_to_profile() 
```

其中任何一个都将生成`pycallgraph.png`类似于下图的文件：

![在此处输入图像描述](https://i.stack.imgur.com/aiNEA.png)

* * *

## 回答 #3

> 赞同：223
> 
> 时间：2009-12-17T16:30:34.247

值得指出的是，使用探查器（默认情况下）仅在主线程上有效，如果您使用它们，您将不会从其他线程获得任何信息。这可能有点棘手，因为在[分析器文档](http://docs.python.org/library/profile.html)中完全没有提到它。

如果您还想分析线程，则需要查看文档中的[`threading.setprofile()`函数](http://docs.python.org/library/threading.html#threading.setprofile "threading.setprofile() 函数")。

你也可以创建自己的`threading.Thread`子类来做到这一点：

```
class ProfiledThread(threading.Thread):
    # Overrides threading.Thread.run()
    def run(self):
        profiler = cProfile.Profile()
        try:
            return profiler.runcall(threading.Thread.run, self)
        finally:
            profiler.dump_stats('myprofile-%d.profile' % (self.ident,)) 
```

并使用`ProfiledThread`该类而不是标准类。它可能会给你更多的灵活性，但我不确定它是否值得，特别是如果你使用的第三方代码不会使用你的类。

* * *

## 回答 #4

> 赞同：170
> 
> 时间：2011-10-08T00:04:12.983

python wiki 是一个很好的资源分析页面： [http ://wiki.python.org/moin/PythonSpeed/PerformanceTips#Profiling_Code](http://wiki.python.org/moin/PythonSpeed/PerformanceTips#Profiling_Code)

和 python 文档一样： http: [//docs.python.org/library/profile.html](http://docs.python.org/library/profile.html)

如 Chris Lawlor 所示，cProfile 是一个很棒的工具，可以很容易地用于打印到屏幕上：

```
python -m cProfile -s time mine.py <args> 
```

或归档：

```
python -m cProfile -o output.file mine.py <args> 
```

PS> 如果您使用的是 Ubuntu，请确保安装 python-profile

```
apt-get install python-profiler 
```

如果您输出到文件，您可以使用以下工具获得漂亮的可视化效果

PyCallGraph：创建调用图图像的工具
安装：

```
 pip install pycallgraph 
```

跑：

```
 pycallgraph mine.py args 
```

看法：

```
 gimp pycallgraph.png 
```

*您可以使用任何您喜欢的方式查看 png 文件，我使用 gimp*
不幸的是我经常得到

点：图形对于 cairo-renderer 位图来说太大了。缩放 0.257079 以适应

这使我的图像变得无法使用。所以我一般会创建 svg 文件：

```
pycallgraph -f svg -o pycallgraph.svg mine.py <args> 
```

PS>确保安装graphviz（提供点程序）：

```
pip install graphviz 
```

通过 @maxy / @quodlibetor 使用 gprof2dot 进行替代绘图：

```
pip install gprof2dot
python -m cProfile -o profile.pstats mine.py
gprof2dot -f pstats profile.pstats | dot -Tsvg -o mine.svg 
```

* * *

## 回答 #5

> 赞同：149
> 
> 时间：2012-12-11T23:16:39.907

@Maxy 对[这个答案](https://stackoverflow.com/a/7693928/25616)的评论帮助了我，我认为它应该得到自己的答案：我已经有 cProfile 生成的 .pstats 文件，我不想用 pycallgraph 重新运行东西，所以我使用了[gprof2dot](https://github.com/jrfonseca/gprof2dot)，并且变得很漂亮SVG：

```
$ sudo apt-get install graphviz
$ git clone https://github.com/jrfonseca/gprof2dot
$ ln -s "$PWD"/gprof2dot/gprof2dot.py ~/bin
$ cd $PROJECT_DIR
$ gprof2dot.py -f pstats profile.pstats | dot -Tsvg -o callgraph.svg 
```

和责备！

它使用点（与 pycallgraph 使用相同的东西），因此输出看起来相似。我得到的印象是 gprof2dot 丢失的信息较少：

[![gprof2dot 示例输出](https://i.stack.imgur.com/JjSvt.png)](https://i.stack.imgur.com/JjSvt.png)

* * *

## 回答 #6

> 赞同：114
> 
> 时间：2018-03-08T13:03:07.013

**最简单**、**最快捷**的方式来查找所有时间的去向。

```
1\. pip install snakeviz

2\. python -m cProfile -o temp.dat <PROGRAM>.py

3\. snakeviz temp.dat 
```

在浏览器中绘制饼图。最大的一块是问题功能。非常简单。

* * *

## 回答 #7

> 赞同：99
> 
> 时间：2016-05-25T08:06:13.300

在研究这个主题时，我遇到了一个名为[SnakeViz的方便工具。](https://jiffyclub.github.io/snakeviz/)SnakeViz 是一个基于 Web 的分析可视化工具。它非常易于安装和使用。我使用它的常用方法是生成一个统计文件，`%prun`然后在 SnakeViz 中进行分析。

使用的主要可视化技术是如下所示的**Sunburst 图表，其中函数调用的层次结构被安排为弧层和以角宽度编码的时间信息。**

最好的事情是您可以与图表进行交互。例如，放大可以点击一个弧，弧及其后代将被放大为新的旭日形以显示更多细节。

[![在此处输入图像描述](https://i.stack.imgur.com/kCmSY.png)](https://i.stack.imgur.com/kCmSY.png)

* * *

## 回答 #8

> 赞同：87
> 
> 时间：2016-05-11T08:32:50.650

[`cProfile`](https://docs.python.org/2/library/profile.html)非常适合分析，同时[`kcachegrind`](https://kcachegrind.github.io/html/Home.html)非常适合可视化结果。中间[`pyprof2calltree`](https://pypi.python.org/pypi/pyprof2calltree)处理文件转换。

```
python -m cProfile -o script.profile script.py
pyprof2calltree -i script.profile -o script.calltree
kcachegrind script.calltree 
```

所需的系统包：

*   `kcachegrind`(Linux), `qcachegrind`(MacO)

在 Ubuntu 上设置：

```
apt-get install kcachegrind 
pip install pyprof2calltree 
```

结果：

[![结果截图](https://i.stack.imgur.com/1TFZe.png)](https://i.stack.imgur.com/1TFZe.png)

* * *

## 回答 #9

> 赞同：57
> 
> 时间：2018-08-04T07:27:37.643

我最近创建了[tuna](https://github.com/nschloe/tuna)用于可视化 Python 运行时和导入配置文件；这在这里可能会有所帮助。

[![在此处输入图像描述](https://i.stack.imgur.com/ZpP6M.gif)](https://i.stack.imgur.com/ZpP6M.gif)

安装

```
pip install tuna 
```

创建运行时配置文件

```
python3 -m cProfile -o program.prof yourfile.py 
```

或导入配置文件（需要 Python 3.7+）

```
python3 -X importprofile yourfile.py 2> import.log 
```

然后只需在文件上运行 tuna

```
tuna program.prof 
```

* * *

## 回答 #10

> 赞同：43
> 
> 时间：2015-02-22T16:18:05.447

另外值得一提的是 GUI cProfile 转储查看器[RunSnakeRun](http://www.vrplumber.com/programming/runsnakerun/)。它允许您进行排序和选择，从而放大程序的相关部分。图片中矩形的大小与所用时间成正比。如果您将鼠标悬停在一个矩形上，它会在表格和地图上的任何地方突出显示该调用。当您双击一个矩形时，它会放大该部分。它将向您显示谁调用了该部分以及该部分调用了什么。

描述性信息非常有用。它向您展示了该位的代码，这在您处理内置库调用时会很有帮助。它告诉你在哪个文件和哪一行找到代码。

还想指出 OP 说“分析”，但似乎他的意思是“时间”。请记住，程序在分析时运行速度会变慢。

![在此处输入图像描述](https://i.stack.imgur.com/2GahD.png)

* * *

## 回答 #11

> 赞同：36
> 
> 时间：2011-10-20T16:05:34.820

一个不错的分析模块是 line_profiler（使用脚本 kernprof.py 调用）。可以在[这里](http://packages.python.org/line_profiler/)下载。

我的理解是 cProfile 仅提供有关每个函数花费的总时间的信息。所以单独的代码行没有计时。这是科学计算中的一个问题，因为单行通常会花费很多时间。另外，我记得，cProfile 没有抓住我花在 numpy.dot 上的时间。

* * *

## 回答 #12

> 赞同：36
> 
> 时间：2015-03-02T11:36:47.300

# 个人资料

`line_profiler`（已在此处介绍）也受到启发 [`pprofile`](https://github.com/vpelletier/pprofile)，描述为：

> 行粒度、线程感知的确定性和统计纯 python 分析器

它提供行粒度`line_profiler`，是纯 Python，可以用作独立命令或模块，甚至可以生成可以轻松分析的 callgrind 格式文件`[k|q]cachegrind`。

# vprof

还有[vprof](https://github.com/nvdv/vprof)，一个 Python 包，描述为：

> [...] 为各种 Python 程序特征（例如运行时间和内存使用）提供丰富的交互式可视化。

[![热图](https://i.stack.imgur.com/uafO3.png)](https://i.stack.imgur.com/uafO3.png)

* * *

## 回答 #13

> 赞同：20
> 
> 时间：2015-08-21T11:59:43.567

有很多很好的答案，但他们要么使用命令行，要么使用一些外部程序来分析和/或排序结果。

我真的错过了一些我可以在我的 IDE (eclipse-PyDev) 中使用的方法，而无需触摸命令行或安装任何东西。所以就在这里。

# 没有命令行的分析

```
def count():
    from math import sqrt
    for x in range(10**5):
        sqrt(x)

if __name__ == '__main__':
    import cProfile, pstats
    cProfile.run("count()", "{}.profile".format(__file__))
    s = pstats.Stats("{}.profile".format(__file__))
    s.strip_dirs()
    s.sort_stats("time").print_stats(10) 
```

有关更多信息，请参阅[文档](https://docs.python.org/3.4/library/profile.html)或其他答案。

* * *

## 回答 #14

> 赞同：16
> 
> 时间：2019-08-07T19:37:56.947

仅终端（也是最简单）的解决方案，以防所有那些花哨的 UI 无法安装或运行：完全
忽略`cProfile`并将其替换为`pyinstrument`，这将在执行后立即收集并显示调用树。

安装：

```
$ pip install pyinstrument 
```

配置文件和显示结果：

```
$ python -m pyinstrument ./prog.py 
```

适用于 python2 和 3。

[编辑] API 的文档，仅用于分析部分代码，可以在[这里](https://github.com/joerick/pyinstrument#profile-a-specific-chunk-of-code)找到。

* * *

## 回答 #15

> 赞同：13
> 
> 时间：2011-11-09T12:59:04.463

按照 Joe Shaw 关于多线程代码无法按预期工作的回答，我认为`runcall`cProfile 中的方法只是在执行`self.enable()`并`self.disable()`调用已分析的函数调用，因此您可以自己简单地执行此操作，并在中间使用您想要的任何代码对现有代码的干扰最小。

* * *

## 回答 #16

> 赞同：10
> 
> 时间：2009-02-24T20:31:10.237

在 Virtaal 的[源代码](https://github.com/translate/virtaal/blob/master/devsupport/profiling.py)中，有一个非常有用的类和装饰器，可以使分析（即使对于特定的方法/函数）非常容易。然后可以在 KCacheGrind 中非常舒适地查看输出。

* * *

## 回答 #17

> 赞同：9
> 
> 时间：2019-09-11T19:52:11.423

如果你想制作一个累积分析器，意味着连续运行几次函数并观察结果的总和。

你可以使用这个`cumulative_profiler`装饰器：

它是 python >= 3.6 特定的，但您可以删除`nonlocal`它，因为它适用于旧版本。

```
import cProfile, pstats

class _ProfileFunc:
    def __init__(self, func, sort_stats_by):
        self.func =  func
        self.profile_runs = []
        self.sort_stats_by = sort_stats_by

    def __call__(self, *args, **kwargs):
        pr = cProfile.Profile()
        pr.enable()  # this is the profiling section
        retval = self.func(*args, **kwargs)
        pr.disable()

        self.profile_runs.append(pr)
        ps = pstats.Stats(*self.profile_runs).sort_stats(self.sort_stats_by)
        return retval, ps

def cumulative_profiler(amount_of_times, sort_stats_by='time'):
    def real_decorator(function):
        def wrapper(*args, **kwargs):
            nonlocal function, amount_of_times, sort_stats_by  # for python 2.x remove this row

            profiled_func = _ProfileFunc(function, sort_stats_by)
            for i in range(amount_of_times):
                retval, ps = profiled_func(*args, **kwargs)
            ps.print_stats()
            return retval  # returns the results of the function
        return wrapper

    if callable(amount_of_times):  # incase you don't want to specify the amount of times
        func = amount_of_times  # amount_of_times is the function in here
        amount_of_times = 5  # the default amount
        return real_decorator(func)
    return real_decorator 
```

**例子**

分析功能`baz`

```
import time

@cumulative_profiler
def baz():
    time.sleep(1)
    time.sleep(2)
    return 1

baz() 
```

`baz`运行 5 次并打印：

```
 20 function calls in 15.003 seconds

   Ordered by: internal time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
       10   15.003    1.500   15.003    1.500 {built-in method time.sleep}
        5    0.000    0.000   15.003    3.001 <ipython-input-9-c89afe010372>:3(baz)
        5    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects} 
```

指定次数

```
@cumulative_profiler(3)
def baz():
    ... 
```

* * *

## 回答 #18

> 赞同：8
> 
> 时间：2015-03-30T11:11:13.070

cProfile 非常适合快速分析，但大多数时候它以错误结束。函数 runctx 通过正确初始化环境和变量来解决这个问题，希望它对某人有用：

```
import cProfile
cProfile.runctx('foo()', None, locals()) 
```

* * *

## 回答 #19

> 赞同：8
> 
> 时间：2020-03-13T10:10:12.153

使用像[austin](https://github.com/P403n1x87/austin)这样的统计分析器，不需要检测，这意味着您可以简单地从 Python 应用程序中获取分析数据

```
austin python3 my_script.py 
```

原始输出不是很有用，但您可以将其通过管道传输到[flamegraph.pl](https://github.com/brendangregg/FlameGraph/blob/master/flamegraph.pl) 以获取该数据的火焰图表示，从而为您提供时间（以实时微秒为单位）花费的细分。

```
austin python3 my_script.py | flamegraph.pl > my_script_profile.svg 
```

或者，您也可以使用 Web 应用程序[Speedscope.app](http://speedscope.app/)快速查看收集的样本。如果您安装了[pprof](https://github.com/google/pprof)，您还可以获得[austin-python](https://github.com/P403n1x87/austin-python)（带有 eg `pipx install austin-python`）并使用`austin2pprof`来转换为 pprof 格式。

但是，如果您安装了 VS Code，您可以使用[Austin 扩展](https://marketplace.visualstudio.com/items?itemName=p403n1x87.austin-vscode)来获得更具交互性的体验，包括源代码热图、顶级函数和收集的调用堆栈

![奥斯汀 VS 代码扩展](https://github.com/P403n1x87/austin-vscode/raw/main/art/demo.gif)

* * *

## 回答 #20

> 赞同：7
> 
> 时间：2014-02-19T15:38:58.007

我的方法是使用 yappi ( [https://github.com/sumerc/yappi](https://github.com/sumerc/yappi) )。它与 RPC 服务器结合使用特别有用（即使只是为了调试），您可以注册方法来启动、停止和打印分析信息，例如以这种方式：

```
@staticmethod
def startProfiler():
    yappi.start()

@staticmethod
def stopProfiler():
    yappi.stop()

@staticmethod
def printProfiler():
    stats = yappi.get_stats(yappi.SORTTYPE_TTOT, yappi.SORTORDER_DESC, 20)
    statPrint = '\n'
    namesArr = [len(str(stat[0])) for stat in stats.func_stats]
    log.debug("namesArr %s", str(namesArr))
    maxNameLen = max(namesArr)
    log.debug("maxNameLen: %s", maxNameLen)

    for stat in stats.func_stats:
        nameAppendSpaces = [' ' for i in range(maxNameLen - len(stat[0]))]
        log.debug('nameAppendSpaces: %s', nameAppendSpaces)
        blankSpace = ''
        for space in nameAppendSpaces:
            blankSpace += space

        log.debug("adding spaces: %s", len(nameAppendSpaces))
        statPrint = statPrint + str(stat[0]) + blankSpace + " " + str(stat[1]).ljust(8) + "\t" + str(
            round(stat[2], 2)).ljust(8 - len(str(stat[2]))) + "\t" + str(round(stat[3], 2)) + "\n"

    log.log(1000, "\nname" + ''.ljust(maxNameLen - 4) + " ncall \tttot \ttsub")
    log.log(1000, statPrint) 
```

然后，当您的程序工作时，您可以随时通过调用 RPC 方法启动分析器，并通过调用（或修改 rpc 方法以将其返回给调用者）`startProfiler`将分析信息转储到日志文件并获得这样的输出：`printProfiler`

```
2014-02-19 16:32:24,128-|SVR-MAIN  |-(Thread-3   )-Level 1000: 
name                                                                                                                                      ncall     ttot    tsub
2014-02-19 16:32:24,128-|SVR-MAIN  |-(Thread-3   )-Level 1000: 
C:\Python27\lib\sched.py.run:80                                                                                                           22        0.11    0.05
M:\02_documents\_repos\09_aheadRepos\apps\ahdModbusSrv\pyAheadRpcSrv\xmlRpc.py.iterFnc:293                                                22        0.11    0.0
M:\02_documents\_repos\09_aheadRepos\apps\ahdModbusSrv\serverMain.py.makeIteration:515                                                    22        0.11    0.0
M:\02_documents\_repos\09_aheadRepos\apps\ahdModbusSrv\pyAheadRpcSrv\PicklingXMLRPC.py._dispatch:66                                       1         0.0     0.0
C:\Python27\lib\BaseHTTPServer.py.date_time_string:464                                                                                    1         0.0     0.0
c:\users\zasiec~1\appdata\local\temp\easy_install-hwcsr1\psutil-1.1.2-py2.7-win32.egg.tmp\psutil\_psmswindows.py._get_raw_meminfo:243     4         0.0     0.0
C:\Python27\lib\SimpleXMLRPCServer.py.decode_request_content:537                                                                          1         0.0     0.0
c:\users\zasiec~1\appdata\local\temp\easy_install-hwcsr1\psutil-1.1.2-py2.7-win32.egg.tmp\psutil\_psmswindows.py.get_system_cpu_times:148 4         0.0     0.0
<string>.__new__:8                                                                                                                        220       0.0     0.0
C:\Python27\lib\socket.py.close:276                                                                                                       4         0.0     0.0
C:\Python27\lib\threading.py.__init__:558                                                                                                 1         0.0     0.0
<string>.__new__:8                                                                                                                        4         0.0     0.0
C:\Python27\lib\threading.py.notify:372                                                                                                   1         0.0     0.0
C:\Python27\lib\rfc822.py.getheader:285                                                                                                   4         0.0     0.0
C:\Python27\lib\BaseHTTPServer.py.handle_one_request:301                                                                                  1         0.0     0.0
C:\Python27\lib\xmlrpclib.py.end:816                                                                                                      3         0.0     0.0
C:\Python27\lib\SimpleXMLRPCServer.py.do_POST:467                                                                                         1         0.0     0.0
C:\Python27\lib\SimpleXMLRPCServer.py.is_rpc_path_valid:460                                                                               1         0.0     0.0
C:\Python27\lib\SocketServer.py.close_request:475                                                                                         1         0.0     0.0
c:\users\zasiec~1\appdata\local\temp\easy_install-hwcsr1\psutil-1.1.2-py2.7-win32.egg.tmp\psutil\__init__.py.cpu_times:1066               4         0.0     0.0 
```

它对于短脚本可能不是很有用，但有助于优化服务器类型的进程，特别是考虑到该`printProfiler`方法可以随着时间的推移多次调用来分析和比较不同的程序使用场景。

在较新版本的 yappi 中，以下代码将起作用：

```
@staticmethod
def printProfile():
    yappi.get_func_stats().print_all() 
```

* * *

## 回答 #21

> 赞同：7
> 
> 时间：2019-07-19T13:59:17.617

**gprof2dot_magic**

`gprof2dot`用于在 JupyterLab 或 Jupyter Notebook 中将任何 Python 语句分析为 DOT 图的魔术函数。

[![在此处输入图像描述](https://i.stack.imgur.com/IE4Py.gif)](https://i.stack.imgur.com/IE4Py.gif)

GitHub 仓库：[https ://github.com/mattijn/gprof2dot_magic](https://github.com/mattijn/gprof2dot_magic)

**安装**

确保你有 Python 包`gprof2dot_magic`。

```
pip install gprof2dot_magic 
```

它的依赖项`gprof2dot`也`graphviz`将被安装

**用法**

要启用魔法功能，首先加载`gprof2dot_magic`模块

```
%load_ext gprof2dot_magic 
```

然后将任何线语句分析为点图，如下所示：

```
%gprof2dot print('hello world') 
```

[![在此处输入图像描述](https://i.stack.imgur.com/fiGeD.png)](https://i.stack.imgur.com/fiGeD.png)

* * *

## 回答 #22

> 赞同：7
> 
> 时间：2020-05-25T15:07:39.420

用于在 IPython 笔记本上快速获取个人资料统计信息。可以将**line_profiler**和**memory_profiler**直接嵌入到他们的笔记本中。

另一个有用的包是**Pymler**。它是一个强大的分析包，能够跟踪类、对象、函数、内存泄漏等。下面的示例，附带的文档。

## 得到它！

```
!pip install line_profiler
!pip install memory_profiler
!pip install pympler 
```

## 加载它！

```
%load_ext line_profiler
%load_ext memory_profiler 
```

## 用它！

* * *

# ％时间

```
%time print('Outputs CPU time,Wall Clock time') 
#CPU times: user 2 µs, sys: 0 ns, total: 2 µs Wall time: 5.96 µs 
```

给出：

*   CPU 时间：CPU 级执行时间
*   sys times：系统级执行时间
*   总计：CPU时间+系统时间
*   挂钟时间：挂钟时间

* * *

# %时间

```
%timeit -r 7 -n 1000 print('Outputs execution time of the snippet') 
#1000 loops, best of 7: 7.46 ns per loop 
```

*   在循环 (n) 次中给出给定运行次数 (r) 的最佳时间。
*   输出有关系统缓存的详细信息：
    *   当多次执行代码片段时，系统会缓存一些操作并且不会再次执行它们，这可能会影响配置文件报告的准确性。

* * *

# %修剪

```
%prun -s cumulative 'Code to profile' 
```

给出：

*   函数调用次数（ncalls）
*   每个函数调用都有条目（不同）
*   每次通话所用时间（每次通话）
*   直到该函数调用经过的时间（cumtime）
*   调用的函数/模块的名称等...

[![累积资料](https://i.stack.imgur.com/1IkgA.png)](https://i.stack.imgur.com/1IkgA.png)

* * *

# %memit

```
%memit 'Code to profile'
#peak memory: 199.45 MiB, increment: 0.00 MiB 
```

给出：

*   内存使用情况

* * *

# %lprun

```
#Example function
def fun():
  for i in range(10):
    print(i)

#Usage: %lprun <name_of_the_function> function
%lprun -f fun fun() 
```

给出：

*   行明智的统计

[![线型材](https://i.stack.imgur.com/rusPA.png)](https://i.stack.imgur.com/rusPA.png)

* * *

# sys.getsizeof

```
sys.getsizeof('code to profile')
# 64 bytes 
```

返回对象的大小（以字节为单位）。

* * *

# 来自pympler的asizeof()

```
from pympler import asizeof
obj = [1,2,("hey","ha"),3]
print(asizeof.asizeof(obj,stats=4)) 
```

pympler.asizeof 可用于调查某些 Python 对象消耗了多少内存。与 sys.getsizeof 相比，asizeof 递归地调整对象大小

[![pympler.asizeof](https://i.stack.imgur.com/8jxQX.png)](https://i.stack.imgur.com/8jxQX.png)

* * *

# pympler 的跟踪器

```
from pympler import tracker
tr = tracker.SummaryTracker()
def fun():
  li = [1,2,3]
  di = {"ha":"haha","duh":"Umm"}
fun()
tr.print_diff() 
```

跟踪函数的生命周期。

[![跟踪器输出](https://i.stack.imgur.com/SrRj9.png)](https://i.stack.imgur.com/SrRj9.png)

Pymler 包包含大量用于分析代码的高实用程序功能。所有这些都不能在这里涵盖。有关详细配置文件实现，请参阅随附的文档。

### 皮普勒[文档](https://readthedocs.org/projects/pympler/downloads/pdf/latest/)

* * *

## 回答 #23

> 赞同：7
> 
> 时间：2021-06-14T20:41:54.460

最近我为 PyCharm 创建了一个插件，您可以使用它`line_profiler`在 PyCharm 编辑器中轻松分析和可视化结果。

`line_profiler`在其他答案中也提到过，它是一个很好的工具，可以准确分析 python 解释器在某些行中花费了多少时间。

我创建的 PyCharm 插件可以在这里找到： [https ://plugins.jetbrains.com/plugin/16536-line-profiler](https://plugins.jetbrains.com/plugin/16536-line-profiler)

它需要在您的 python 环境中调用一个帮助程序包`line-profiler-pycharm`，可以使用 pip 或插件本身安装。

在 PyCharm 中安装插件后：

1.  `line_profiler_pycharm.profile`使用装饰器装饰您想要配置的任何功能
2.  使用“轮廓线”跑步者运行

结果截图： [![Line Profiler Pycharm 结果](https://i.stack.imgur.com/nj0LP.png)](https://i.stack.imgur.com/nj0LP.png)

* * *

## 回答 #24

> 赞同：5
> 
> 时间：2015-03-21T13:50:12.133

要添加到[https://stackoverflow.com/a/582337/1070617](https://stackoverflow.com/a/582337/1070617)，

我编写了这个模块，它允许您使用 cProfile 并轻松查看其输出。更多信息：[https ://github.com/ymichael/cprofilev](https://github.com/ymichael/cprofilev)

```
$ python -m cprofilev /your/python/program
# Go to http://localhost:4000 to view collected statistics. 
```

另请参阅：http: [//ymichael.com/2014/03/08/profiling-python-with-cprofile.html](http://ymichael.com/2014/03/08/profiling-python-with-cprofile.html)，了解如何理解收集的统计信息。

* * *

## 回答 #25

> 赞同：5
> 
> 时间：2015-04-28T22:50:08.213

在 Python 中处理分析的新工具是 PyVmMonitor：[http ://www.pyvmmonitor.com/](http://www.pyvmmonitor.com/)

它有一些独特的功能，例如

*   将探查器附加到正在运行的 (CPython) 程序
*   使用 Yappi 集成进行按需分析
*   另一台机器上的配置文件
*   多进程支持（多处理，django...）
*   实时采样/CPU 视图（带时间范围选择）
*   通过 cProfile/profile 集成进行确定性分析
*   分析现有的 PStats 结果
*   打开点文件
*   程序化 API 访问
*   按方法或线对样品进行分组
*   PyDev 集成
*   PyCharm 集成

注意：它是商业的，但对开源免费。

* * *

## 回答 #26

> 赞同：5
> 
> 时间：2017-04-19T19:42:32.280

这取决于你想从分析中看到什么。简单的时间度量可以由 (bash) 给出。

```
time python python_prog.py 
```

甚至 '/usr/bin/time' 也可以通过使用 '--verbose' 标志输出详细的指标。

要检查每个函数给出的时间指标并更好地了解函数花费了多少时间，您可以使用 python 中的内置 cProfile。

进入更详细的指标，如性能，时间不是唯一的指标。您可以担心内存、线程等。
分析选项：
1\. **line_profiler**是另一种通常用于逐行查找时序指标的分析器。
2\. **memory_profiler**是一个分析内存使用情况的工具。
3\. **heapy（来自项目 Guppy）**描述堆中的对象是如何使用的。

这些是我倾向于使用的一些常见的。但是，如果您想了解更多信息，请尝试阅读这[本书](http://shop.oreilly.com/product/0636920028963.do) 。这是一本很好的书，介绍了如何从性能开始。您可以转到有关使用 Cython 和 JIT（即时）编译的 python 的高级主题。

* * *

## 回答 #27

> 赞同：5
> 
> 时间：2020-02-12T12:03:16.613

我刚刚开发了自己的分析器，灵感来自 pypref_time：

[https://github.com/modaresimr/auto_profiler](https://github.com/modaresimr/auto_profiler)

通过添加一个装饰器，它将显示一个耗时的函数树

`@Profiler(depth=4, on_disable=show)`

```
Install by: pip install auto_profiler 
```

# 例子

```
import time # line number 1
import random

from auto_profiler import Profiler, Tree

def f1():
    mysleep(.6+random.random())

def mysleep(t):
    time.sleep(t)

def fact(i):
    f1()
    if(i==1):
        return 1
    return i*fact(i-1)

def show(p):
    print('Time   [Hits * PerHit] Function name [Called from] [Function Location]\n'+\
          '-----------------------------------------------------------------------')
    print(Tree(p.root, threshold=0.5))

@Profiler(depth=4, on_disable=show)
def main():
    for i in range(5):
        f1()

    fact(3)

if __name__ == '__main__':
    main() 
```

## 示例输出

```
 Time   [Hits * PerHit] Function name [Called from] [function location]
-----------------------------------------------------------------------
8.974s [1 * 8.974]  main  [auto-profiler/profiler.py:267]  [/test/t2.py:30]
├── 5.954s [5 * 1.191]  f1  [/test/t2.py:34]  [/test/t2.py:14]
│   └── 5.954s [5 * 1.191]  mysleep  [/test/t2.py:15]  [/test/t2.py:17]
│       └── 5.954s [5 * 1.191]  <time.sleep>
|
|
|   # The rest is for the example recursive function call fact
└── 3.020s [1 * 3.020]  fact  [/test/t2.py:36]  [/test/t2.py:20]
    ├── 0.849s [1 * 0.849]  f1  [/test/t2.py:21]  [/test/t2.py:14]
    │   └── 0.849s [1 * 0.849]  mysleep  [/test/t2.py:15]  [/test/t2.py:17]
    │       └── 0.849s [1 * 0.849]  <time.sleep>
    └── 2.171s [1 * 2.171]  fact  [/test/t2.py:24]  [/test/t2.py:20]
        ├── 1.552s [1 * 1.552]  f1  [/test/t2.py:21]  [/test/t2.py:14]
        │   └── 1.552s [1 * 1.552]  mysleep  [/test/t2.py:15]  [/test/t2.py:17]
        └── 0.619s [1 * 0.619]  fact  [/test/t2.py:24]  [/test/t2.py:20]
            └── 0.619s [1 * 0.619]  f1  [/test/t2.py:21]  [/test/t2.py:14] 
```

* * *

## 回答 #28

> 赞同：4
> 
> 时间：2012-10-13T15:21:22.260

> 想知道python脚本到底在做什么吗？进入检查外壳。Inspect Shell 允许您在不中断运行脚本的情况下打印/更改全局变量和运行函数。现在具有自动完成和命令历史记录（仅在 linux 上）。
> 
> Inspect Shell 不是 pdb 风格的调试器。

[https://github.com/amoffat/Inspect-Shell](https://github.com/amoffat/Inspect-Shell)

你可以使用它（和你的手表）。

* * *

## 回答 #29

> 赞同：3
> 
> 时间：2016-02-11T22:50:49.340

还有一个名为 的统计分析器[`statprof`](https://pypi.python.org/pypi/statprof/)。它是一个采样分析器，因此它为您的代码增加了最小的开销，并提供了基于行（而不仅仅是基于函数）的计时。它更适合游戏等软实时应用程序，但精度可能低于 cProfile。

[pypi](https://pypi.python.org/pypi/statprof/)中的版本有点旧，所以可以`pip`通过指定[git 存储库](https://github.com/bos/statprof.py)来安装它：

```
pip install git+git://github.com/bos/statprof.py@1a33eba91899afe17a8b752c6dfdec6f05dd0c01 
```

你可以像这样运行它：

```
import statprof

with statprof.profile():
    my_questionable_function() 
```

另请参阅[https://stackoverflow.com/a/10333592/320036](https://stackoverflow.com/a/10333592/320036)

* * *

## 回答 #30

> 赞同：1
> 
> 时间：2022-01-11T10:27:09.547

我发现 cprofiler 和其他资源更多地用于优化目的而不是调试。

我制作了自己的测试模块，而不是简单的 python 脚本速度测试。（在我的情况下，使用 ScriptProfilerPy 测试了 1K+ 行 py 文件，并在几分钟后将代码加速了 10 倍。

模块 ScriptProfilerPy() 将运行您的代码，并为其添加时间戳。我把模块放在这里： [https ://github.com/Lucas-BLP/ScriptProfilerPy](https://github.com/Lucas-BLP/ScriptProfilerPy)

采用：

```
from speed_testpy import ScriptProfilerPy

ScriptProfilerPy("path_to_your_script_to_test.py").Profiler() 
```

输出： [![测试后代码输出](https://i.stack.imgur.com/RkRZD.png)](https://i.stack.imgur.com/RkRZD.png)

* * *

## 回答 #31

> 赞同：0
> 
> 时间：2017-02-02T10:18:41.803

当我不是服务器上的 root 时，我使用 [lsprofcalltree.py](https://people.gnome.org/~johan/lsprofcalltree.py)并像这样运行我的程序：

```
python lsprofcalltree.py -o callgrind.1 test.py 
```

然后我可以使用任何与 callgrind 兼容的软件打开报告，例如[qcachegrind](https://sourceforge.net/projects/qcachegrindwin/)

# sql-server - SSRS 电子邮件订阅配置

> ID：582338
> 
> 赞同：2
> 
> 时间：2009-02-24T16:01:44.877
> 
> 标签：sql-server, reporting-services

我试图将 Sql Server Reporting Services 2008 配置为在创建订阅时发送电子邮件。我在本机模式下运行 SSRS。每当我尝试创建新的电子邮件订阅时，此错误消息都会出现在日志文件中：

```
library!ReportServer_0-3!14e4!01/30/2009-12:58:52:: Call to GetSystemPermissionsAction().
library!ReportServer_0-3!1684!01/30/2009-12:58:52:: Call to GetPermissionsAction(/Report Folder/Report Name).
library!ReportServer_0-3!14e4!01/30/2009-12:58:52:: e ERROR: Throwing Microsoft.ReportingServices.Diagnostics.Utilities.OperationNotSupportedNativeModeException: This operation is not supported on a report server that runs in native mode., ;
 Info: Microsoft.ReportingServices.Diagnostics.Utilities.OperationNotSupportedNativeModeException: This operation is not supported on a report server that runs in native mode.
extensionfactory!ReportServer_0-3!14e4!01/30/2009-12:58:52:: e ERROR: Exception caught instantiating Report Server DocumentLibrary report server extension: System.Reflection.TargetInvocationException: Exception has been thrown by the target of an invocation. ---> System.TypeInitializationException: The type initializer for 'Microsoft.ReportingServices.SharePoint.SharePointDeliveryExtension.DocumentLibraryProvider' threw an exception. ---> Microsoft.ReportingServices.Diagnostics.Utilities.OperationNotSupportedNativeModeException: This operation is not supported on a report server that runs in native mode. 
```

[网上](http://social.msdn.microsoft.com/Forums/en-US/sqlreportingservices/thread/ead32a3e-ebde-4e3b-8a36-d2b2e023e187/)的大部分[解决方案](http://www.eggheadcafe.com/software/aspnet/29844120/reporting--email-deliver.aspx)都提示问题是由

1.  接收 SMTP 服务器配置不当
2.  Reporting Services 配置管理器中的电子邮件设置配置不正确
3.  使用非域用户作为执行帐户

然而，这些解决方案都不适合我。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-24T16:03:32.423

我终于从[MSDN 页面](http://msdn.microsoft.com/en-us/library/ms159155.aspx)得到了查看 rsreportingservice.config 文件的想法。我注意到配置文件包含一个 SharePoint 交付扩展，即使 SSRS 进程在本机模式下运行，而不是 SharePoint 模式。

```
 <!--<Extension Name="Report Server DocumentLibrary" Type="Microsoft.ReportingServices.SharePoint.SharePointDeliveryExtension.DocumentLibraryProvider,ReportingServicesSharePointDeliveryExtension">
            <MaxRetries>3</MaxRetries>
            <SecondsBeforeRetry>900</SecondsBeforeRetry>
            <Configuration>
                <DocumentLibraryConfiguration>
                    <ExcludedRenderFormats>
                        <RenderingExtension>HTMLOWC</RenderingExtension>
                        <RenderingExtension>NULL</RenderingExtension>
                        <RenderingExtension>RGDI</RenderingExtension>
                    </ExcludedRenderFormats>
                </DocumentLibraryConfiguration>
            </Configuration>
        </Extension>--> 
```

一旦我从配置文件中删除了此代码并重新启动 SSRS，电子邮件订阅就会起作用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-10-18T13:49:17.153

如果您使用数据驱动订阅，请仔细检查“收件人”设置是否实际设置为包含您的电子邮件地址的列。我们将它神秘地更改为不同的列。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-11-16T06:05:17.807

如果您指向 Sharepoint 集成模式的 SOAP 端点（通常为“ReportService2006.asmx”），您也会看到此错误。如果您没有使用与 Sharepoint 集成的 SSRS，请确保您指向“ReportService2005.asmx”（是的，即使您使用的是 SQL 2008）。

参考： [http ://social.msdn.microsoft.com/Forums/en-US/sqlreportingservices/thread/8a40f90f-60e5-4130-984f-dc42032376d4/](http://social.msdn.microsoft.com/Forums/en-US/sqlreportingservices/thread/8a40f90f-60e5-4130-984f-dc42032376d4/)

# git - 使用 git-svn：拉取、合并还是变基？

> ID：582348
> 
> 赞同：24
> 
> 时间：2009-02-24T16:03:50.970
> 
> 标签：git, merge, git-svn

我一直在与 git/git-svn 学习曲线作斗争，昨晚，作为学习曲线的一部分，我做了一些非常非常糟糕的事情。我已经纠正了它，但我希望以我的方式理解错误。

我有一个 svn 存储库，我从中克隆了主干和分支（我忽略了标签，因为我们不处理这些标签）。使用 git，我为当前需要使用的每个分支创建了本地分支：

```
$ git checkout -b trunk svn/trunk
$ git checkout -b feature1 svn/branches/development/feature1
$ git checkout -b maint svn/branches/maintenance/previous-version 
```

我将 feature1 设为我的活动分支并进行了一些更改，然后才离开几天。我昨天回到它想整合对主干所做的任何更改，以便我使用最新和最好的。我所做的是首先通过**git svn rebase**对所有分支进行完整更新（没有其他人在 feature1 分支上工作过）。随着我的 svn 存储库中的所有内容都是最新的，我尝试重新设置基准。

使用 feature1 作为我的活动分支，我做了一个“git rebase trunk”，认为我会将更改从主干*拉到*feature1 分支。原来我是非常非常错误的。合并所有冲突后，我做了一个**git svn dcommit**并发现我的更改已应用于主干。

我的第一个问题是我思考过程中的核心错误在哪里？第二个是，在大量阅读和谷歌搜索之后，我看到人们支持拉取、合并和变基。鉴于我想将一个本地分支中应用的更改合并到另一个本地分支，我*应该*怎么做？这种情况的最佳做法是什么？

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-02-24T19:00:51.577

您遇到的问题是 rebase 的命令行语法与您（非常合理，IMO）的期望不符。

```
$ git checkout feature1
$ git rebase trunk 
```

此序列将未共享的 feature1 提交添加到主干的 HEAD 上，并且您期望它将新的主干提交放置到 feature1 的 HEAD 上。当您知道 Git 的数据模型是如何实现的时，该语法实际上是有一定意义的（这无疑就是它的原因）。但对我来说，这与我所期望的相反，在功能上。最好将它作为一个任意的结构来学习，而不是试图抱有期望。

没错，您了解如何使用 git-svn 与 SVN 存储库进行交互。所以忽略你在谷歌上搜索到的关于推拉和合并的内容——有很多人认为推拉和合并在 git 和 svn 中是相同的。几乎正确仍然是错误的。

* * *

## 回答 #2

> 赞同：-3
> 
> 时间：2009-02-24T16:06:57.827

您应该使用**git svn clone -s**克隆完整的 svn 树，包括所有分支。从那时起，在master中使用**git svn rebase** **和git svn dcommit**来处理svn，你可以创建常规的git分支供你私人使用。

# svn - svn externals 不添加所有文件

> ID：582350
> 
> 赞同：0
> 
> 时间：2009-02-24T16:04:16.930
> 
> 标签：svn, tortoisesvn

我们有一个在多个项目之间共享的外部 app_code 文件夹。我注意到，当我使用 tortoise svn 进行 svn 更新时，并非文件夹中的所有文件都添加到我的 app_code 工作文件夹中。如果我删除整个文件夹并进行更新，则会添加所有文件。这发生在所有外部文件夹上。有关如何解决此问题的任何帮助都会很棒。我们在这个文件夹中有很多文件，每次我们想要获取更新的文件时都必须删除它是很痛苦的。

外部定义：
app_code [http://yversion/repos/app_code/Trunk](http://yversion/repos/app_code/Trunk)
app_controls [http://yversion/repos/app_controls/Trunk](http://yversion/repos/app_controls/Trunk)
app_themes [http://yversion/repos/app_themes/Trunk](http://yversion/repos/app_themes/Trunk)
bin [http://yversion/repos/bin/ Trunk](http://yversion/repos/bin/Trunk)
pagesMaster [http://yversion/repos/Masterpages/Trunk](http://yversion/repos/Masterpages/Trunk)
App_WebReferences [http://yversion/repos/App_WebReferences/Trunk](http://yversion/repos/App_WebReferences/Trunk)

谢谢
皇家

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-24T19:11:32.300

确保所有存储库都有不同的 uuid。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-03-10T20:10:22.170

老问题，但万一有人在搜索中遇到它，我可以通过在项目的根文件夹上运行“svn cleanup”来解决这个问题。

# java - 如何在编写 XML 文件时忽略 DTD 验证但保留 Doctype？

> ID：582352
> 
> 赞同：2
> 
> 时间：2009-02-24T16:04:29.643
> 
> 标签：java, xml, dtd, doctype

我正在开发一个系统，该系统应该能够读取任何（或至少任何格式良好的）XML 文件，操作一些节点并将它们写回到同一个文件中。我希望我的代码尽可能通用，我不希望

*   在我的代码中的任何位置对 Schema/Doctype 信息的硬编码引用。doctype 信息在源文档中，我想准确地保留该 doctype 信息，而不是在我的代码中再次提供它。如果一个文档没有 DocType，我不会添加一个。我根本不关心这些文件的形式或内容，除了我的几个节点。
*   自定义 EntityResolvers 或 StreamFilters 以省略或以其他方式操作源信息（很遗憾，命名空间信息似乎无法从声明它的文档文件中访问，但我可以通过使用更丑的 XPaths 来管理）
*   DTD 验证。我没有引用的 DTD，我不想包含它们，并且在不知道它们的情况下完全可以进行节点操作。

目的是使源文件完全不变，除了通过 XPath 检索的已更改节点。我想摆脱标准的 javax.xml 东西。

到目前为止我的进展：

```
 DocumentBuilderFactory factory = DocumentBuilderFactory.newInstance();

    factory.setAttribute("http://xml.org/sax/features/namespaces", true);
    factory.setAttribute("http://xml.org/sax/features/validation", false);
    factory.setAttribute("http://apache.org/xml/features/nonvalidating/load-dtd-grammar", false);
    factory.setAttribute("http://apache.org/xml/features/nonvalidating/load-external-dtd", false);

    factory.setNamespaceAware(true);
    factory.setIgnoringElementContentWhitespace(false);
    factory.setIgnoringComments(false);
    factory.setValidating(false);
    DocumentBuilder builder = factory.newDocumentBuilder();
    Document document = builder.parse(new InputSource(inStream)); 
```

这会成功地将 XML 源加载到 org.w3c.dom.Document 中，而忽略 DTD 验证。我可以做我的替换，然后我使用

```
 Source source = new DOMSource(document);
    Result result = new StreamResult(getOutputStream(getPath()));

    // Write the DOM document to the file
    Transformer xformer = TransformerFactory.newInstance().newTransformer();
    xformer.transform(source, result); 
```

把它写回来。这几乎是完美的。但是无论我做什么，Doctype 标签都消失了。在调试的时候，看到解析后的Document对象中有一个DeferredDoctypeImpl [log4j:configuration: null]对象，但是不知怎么的，它是错误的，为空或被忽略。我测试的文件是这样开始的（但其他文件类型也是如此）：

<?xml 版本="1.0" 编码="UTF-8"?>

<!DOCTYPE log4j:配置系统“log4j.dtd”>

<log4j:配置 xmlns:log4j="http://jakarta.apache.org/log4j/" debug="false">

[...]

我认为有很多（简单的？）方法涉及黑客或将额外的 JAR 拉入项目。但我更愿意将它与我已经使用的工具一起使用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-24T16:29:03.920

抱歉，现在使用 XMLSerializer 而不是 Transformer 得到它...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-03-01T11:59:22.063

以下是使用 JDK 中的 LSSerializer 的方法：

```
 private void writeDocument(Document doc, String filename)
            throws IOException {
        Writer writer = null;
        try {
            /*
             * Could extract "ls" to an instance attribute, so it can be reused.
             */
            DOMImplementationLS ls = (DOMImplementationLS) 
                    DOMImplementationRegistry.newInstance().
                            getDOMImplementation("LS");
            writer = new OutputStreamWriter(new FileOutputStream(filename));
            LSOutput lsout = ls.createLSOutput();
            lsout.setCharacterStream(writer);
            /*
             * If "doc" has been constructed by parsing an XML document, we
             * should keep its encoding when serializing it; if it has been
             * constructed in memory, its encoding has to be decided by the
             * client code.
             */
            lsout.setEncoding(doc.getXmlEncoding());
            LSSerializer serializer = ls.createLSSerializer();
            serializer.write(doc, lsout);
        } catch (Exception e) {
            throw new IOException(e);
        } finally {
            if (writer != null) writer.close();
        }
    } 
```

需要进口：

```
import java.io.FileOutputStream;
import java.io.IOException;
import java.io.OutputStreamWriter;
import java.io.Writer;
import org.w3c.dom.Document;
import org.w3c.dom.bootstrap.DOMImplementationRegistry;
import org.w3c.dom.ls.DOMImplementationLS;
import org.w3c.dom.ls.LSOutput;
import org.w3c.dom.ls.LSSerializer; 
```

我知道这是一个已经回答的老问题，但我认为技术细节可能会对某人有所帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-11-16T18:55:25.547

我尝试使用 LSSerializer 库，但在保留 Doctype 方面无法使用它。这是 Stephan 可能使用的解决方案 *注意：这是在 scala 中，但使用 java 库，所以只需转换您的代码*

```
import com.sun.org.apache.xml.internal.serialize.{OutputFormat, XMLSerializer}
 def transformXML(root: Element, file: String): Unit = {
    val doc = root.getOwnerDocument
    val format = new OutputFormat(doc)
    format.setIndenting(true)
    val writer = new OutputStreamWriter(new FileOutputStream(new File(file)))
    val serializer = new XMLSerializer(writer, format)
    serializer.serialize(doc)

  } 
```

# sql-server - 调试 CLR proc 异常

> ID：582363
> 
> 赞同：0
> 
> 时间：2009-02-24T16:07:37.123
> 
> 标签：sql-server, sql-server-2005, visual-studio-2008

`transactionabortedexception`当我在调试模式下运行 CLR proc 并且没有行号信息或任何有助于异常所在位置的信息时，我得到一个。

我正在运行 VS2008 和 SQL 2005。

你如何调试它？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-24T16:16:54.467

您可能处于调试模式，但如果您无权访问所引用程序集的 PDB，您将无法获得行号。

堆栈跟踪应该可以帮助您找出异常在哪里。或者你是说你根本没有得到任何堆栈跟踪？

# linq-to-sql - 在具有 linq-To-sql 的 WebService 中，数据上下文可以是静态字段吗？

> ID：582365
> 
> 赞同：1
> 
> 时间：2009-02-24T16:07:39.107
> 
> 标签：linq-to-sql, datacontext

我正在创建一个将使用 Linq-To-Sql 执行仅选择查询的网络服务。在这方面，是否可以接受将 DataContext 作为静态字段/属性，因为操作永远不会是修改数据库或跟踪对象更改的操作？

如果不是，哪些替代方法是合适的？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-24T16:11:39.330

DataContext 不是线程安全的，因此将其存储在静态中不是一个好主意。

DataContext 的寿命并不长，只是在请求处理期间对其进行实例化。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-24T16:12:46.940

我会在每个方法调用上重新创建数据上下文，包装在 using 块中。这将有助于确保由于操作而创建的对象得到处置并减少内存占用。由于对象被序列化以被发回，因此不需要将数据上下文保持得比调用所需的时间长。数据上下文本身并不是一个特别重的对象，不应避免根据需要重新创建它。这实际上就是它的预期用途——作为一个工作对象单元。

# multithreading - 当事件模式不适用时，线程应该休眠多长时间？

> ID：582367
> 
> 赞同：3
> 
> 时间：2009-02-24T16:07:58.013
> 
> 标签：multithreading

*在必须*轮询以知道是否有工作要做的工作线程的主循环中，我让它休眠以便不忙等待。如何确定合适的睡眠长度？例如。如果我每毫秒醒来，那么睡觉可能根本没用。如果我每十分钟醒来一次，它可能会使应用程序看起来没有响应（取决于线程在做什么）。

我之前听说过 cadrian 在下面所说的，人类用户不会注意到大约 100 毫秒的时间跨度，但是从机器端接近它呢？在开始浪费之前，间隔可以变得多小？

我想，它归结为[这个问题](https://stackoverflow.com/questions/508208/what-is-the-impact-of-thread-sleep1-in-c)的更一般（即独立于平台）版本。

编辑：当然，首先应该将问题改写为“我怎样才能将其更改为事件模式而不是轮询”，但现在让我们假设我不能或不想这样做。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-24T16:23:24.560

**有时轮询*就是*答案**。

但是，它轮询的频率取决于线程在做什么，因此使其可配置。

我们有检查电子邮件的线程。他们可以检查外部邮箱，我们只每隔三十秒左右检查一次邮箱（但它是可配置的）。每张支票都是通过网络调用，每秒或 10 秒调用一次会破坏网络，30 秒是可以的，如果电子邮件没有被处理也没关系它落在收件箱的那一刻（但是一些客户网站每 5 分钟检查一次）。

我们还有其他线程轮询文件夹中的文件和/或添加到数据库表中的新请求。这些每隔 1 到 5 秒轮询一次工作（取决于他们在做什么）。

现在，无论您在轮询之间等待多长时间，我们都不会让任何线程休眠超过一秒。原因是，如果您尝试停止一个线程休眠 60 秒的 Windows 服务，您可能会在服务停止之前等待 60 秒。

如果您需要匆忙将机器放下，Rip Van Winkle 线将真正扭曲您的 mellon。

因此，将轮询间隔设置得尽可能远，但睡眠时间不要超过一秒钟。

希望这可以帮助

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-24T16:11:57.440

您知道手术需要多长时间吗？也许是一个范围？我假设你的线程基本上是这样做的：

```
while(!workComplete) {
  Thread.Sleep(n);
} 
```

如果它是一个 UI 工作线程，只要它们有某种进度指示器，任何地方最多半秒就足够了。UI 应该在操作期间做出响应，因为它是一个后台线程，并且您肯定有足够的 CPU 时间可以每 500 毫秒检查一次。当然，这取决于您的 UI 需要多少响应能力。但请记住，当涉及到 UI 时，这一切都与感知性能有关。

另一种方法是[指数退避](http://en.wikipedia.org/wiki/Exponential_backoff)。假设您在 200 毫秒后检查输入是否完成。如果还没有，下次休眠 400 毫秒。如果在那之后它还没有完成，则休眠 800 毫秒。等等。你应该确保在一段时间后你抛出一个 TimeoutException ，这样你就可以避免一些长时间的睡眠。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-24T16:11:27.770

如果同一应用程序的另一个线程为您的线程提供信息，那么您应该考虑使用事件模式而不是轮询。例如，在 Java 中，您将使用等待/通知。

否则，如果应用程序是面向用户的，那么每 100 毫秒左右进行一次轮询就足够了。用户不会注意到。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-24T16:11:31.997

你应该发出一个信号来提醒线程。如果您使用的是 c，则可以使用 p-threads 中的条件变量之类的东西。如果您使用的是较新的东西，例如 .NET，您可以使用 EventWaitHandle。我确信 java 和其他 4gl 具有与 EventWaitHandle 类似的类。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2009-02-24T16:09:07.353

让它永远沉睡，当有可用输入时唤醒它？

# c# - DataView.Sort - 不仅仅是 asc/desc（需要自定义排序）

> ID：582374
> 
> 赞同：14
> 
> 时间：2009-02-24T16:09:28.850
> 
> 标签：c#, asp.net

我有一个从数据集构建的报告。数据集使用 Sort 属性对数据进行排序。我知道我可以创建这样的排序表达式：

“字段描述，字段 2 递增”

但我现在需要的是一种进行自定义排序的方法。在 SQL 中，我可以通过执行以下操作来执行自定义排序：

```
order by 
    case when field = 'Some Value' then 0 end
    case when field = 'Another Value' then 1 end 
```

基本上重新定义我的排序（即，一些值出现在另一个值之前）。

是否可以对 DataView 执行类似于排序表达式的操作？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-02-24T16:43:30.453

好的，我只是快速完成了这个，并没有做所有必要的错误处理和空值检查，但它应该给你一个想法，应该足以让你开始：

```
public static class DataTableExtensions
{
    public static DataView ApplySort(this DataTable table, Comparison<DataRow> comparison)
    {

        DataTable clone = table.Clone();
        List<DataRow> rows = new List<DataRow>();
        foreach (DataRow row in table.Rows)
        {
            rows.Add(row);    
        }

        rows.Sort(comparison);

        foreach (DataRow row in rows)
        {
            clone.Rows.Add(row.ItemArray);
        }

        return clone.DefaultView;
    }

} 
```

用法：

```
 DataTable table = new DataTable();
    table.Columns.Add("IntValue", typeof(int));
    table.Columns.Add("StringValue");

    table.Rows.Add(11, "Eleven");
    table.Rows.Add(14, "Fourteen");
    table.Rows.Add(10, "Ten");
    table.Rows.Add(12, "Twelve");
    table.Rows.Add(13, "Thirteen"); 
```

//按字符串值排序：

```
 DataView sorted = table.ApplySort((r, r2) =>
        {
            return ((string)r["StringValue"]).CompareTo(((string)r2["StringValue"]));
        }); 
```

结果：

11 十一

14 十四

10 十

13 十三

12 十二

//按 IntValue 排序：

```
DataView sorted = table.ApplySort((r, r2) =>
            {
                return ((int)r["IntValue"]).CompareTo(((int)r2["IntValue"]));
            }); 
```

结果：

10 十

11 十一

13 十三

12 十二

14 十四

编辑：将其更改为扩展方法。

现在在您的 Lambda 中（或者您可以创建一个完整的比较方法），您可以执行您需要的任何类型的自定义排序逻辑。请记住，-1 小于，0 等于，1 大于。

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2009-02-24T22:39:09.977

我喜欢 BFree 的回答，尽管我担心我的代码最终会更新克隆表而不是真实表的风险。（如果您仅在`DataView`.

`DataTable`您可以通过向其添加计算值`DataColumn`（使用[`Expression`](http://msdn.microsoft.com/en-us/library/system.data.datacolumn.expression.aspx)属性）然后对其值进行排序来对原始对象执行此操作。

在您的情况下，它将类似于：

```
DataColumn c = myTable.Columns.Add("Sort", typeof(int));
c.Expression = "iif(field='SomeValue', 0, iif(field='AnotherValue', 1, 2))"; 
```

排序`SomeValue`第一，`AnotherValue`第二，以及之后的所有其他内容。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-05-11T15:14:31.823

我知道这篇文章有点老，但我通过实现 IComparable 来解决这个问题。在此示例中，我想按版本排序（格式为 0.0.0.0 作为字符串）。

这是实现 IComparable 的版本控制类：

```
public class Versioning : IComparable {
    string _version;

    int _major;
    public int Major { 
        get { return (_major); } 
        set { _major = value; } 
    }

    int _minor;
    public int Minor {
        get { return (_minor); }
        set { _minor = value; }
    }

    int _beta;
    public int Beta {
        get { return (_beta); }
        set { _beta = value; }
    }

    int _alpha;
    public int Alpha {
        get { return (_alpha); }
        set { _alpha = value; }
    }

    public Versioning(string version) {
        _version = version;

        var splitVersion = SplitVersion();
        if (splitVersion.Length < 4) {
            Major = Minor = Beta = Alpha = 0;
        }

        if (!int.TryParse(splitVersion[0], out _major)) _major = 0;
        if (!int.TryParse(splitVersion[1], out _minor)) _minor = 0;
        if (!int.TryParse(splitVersion[2], out _beta)) _beta = 0;
        if (!int.TryParse(splitVersion[3], out _alpha)) _alpha = 0;
    }

    string[] SplitVersion() {
        return (_version.Split('.'));
    }

    int GetCompareTo(Versioning versioning) {
        var greater = -1;
        var equal = 0;
        var less = 1;

        if (Major > versioning.Major) return (greater);
        if (Major < versioning.Major) return (less);
        if (Minor > versioning.Minor) return (greater);
        if (Minor < versioning.Minor) return (less);
        if (Beta > versioning.Beta) return (greater);
        if (Beta < versioning.Beta) return (less);
        if (Alpha > versioning.Alpha) return (greater);
        if (Alpha < versioning.Alpha) return (less);

        return (equal);
    }

    public int CompareTo(Versioning versioning) {
        return (GetCompareTo(versioning));
    }

    public override string ToString() {
        return (_version);
    }

    public int CompareTo(object obj) {
        if (obj == null) return (1);
        return (GetCompareTo((Versioning)obj));
    }
} 
```

当您将列添加到表中时，不是将 Version 添加为字符串，而是将其添加为 Versioning 类：

```
_table.Columns.Add("Version", typeof(Versioning));
_view = new View(_table); 
```

然后正常排序：

```
_view.Sort = "Version"; 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-24T16:14:04.393

我不这么认为。但是，您可以更改 SQL 以返回作为 case 语句结果的“CustomSort”列：

```
select
    (case when f = 'a' then 0 else 1 end) as CustomSort
from MyTable 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-24T16:14:09.683

您可以使用 if 或 switch 语句来获得与 select case 语句类似的功能：

```
 if (Something == "1")
                MyView.Sort = "Field1 ASC";
            else
                MyView.Sort = "Field2 ASC"; 
```

或者

```
 switch (MyProperty)
            {
                case 1:
                    MyView.Sort = "Field1 ASC";
                    break;
                case 2:
                    MyView.Sort = "Field2 ASC";
                    break;
                default:
                    MyView.Sort = "Field3 ASC";
                    break;
            } 
```

# iphone - “程序以状态 101 退出”

> ID：582380
> 
> 赞同：2
> 
> 时间：2009-02-24T16:11:19.987
> 
> 标签：iphone, objective-c, cocoa-touch, xcode

有人可以给我更多关于这个错误的信息吗？

控制台仅记录程序以状态值退出：101。

如果你想象我有一个 nsmutablearray：

![替代文字](https://farm4.static.flickr.com/3547/3301056092_8d3ab78225.jpg?v=0)

它拥有 TimeEntry 对象：

```
 #import <Foundation/Foundation.h>
#import "Constants.h"

/*
#define KTimeEntryInformationKey @"TEInformation"
#define KTimeEntryFromKey @"TEFrom"
#define KTimeEntryToKey @"TETo"
*/

@interface TimeEntry : NSObject <NSCopying, NSCoding> {

    NSDate *from;
    NSDate *to;

    NSString *information;

}

@property (nonatomic, retain) NSDate *from;
@property (nonatomic, retain) NSDate *to;

@property (nonatomic, copy) NSString *information;

@end 
```

仅当我将 15-20+ TimeEntry 对象添加到数组时，该应用程序才会给我错误，并在弹出上述 viewController（如图）时给我错误。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-24T17:03:29.457

我相信这是您的程序因使用过多内存而自动关闭时的结果代码。

这不是真正的崩溃，因此它不会停止执行或调用 gdb。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-24T17:05:42.133

感谢 Apple 讨论板上的 jerbeers：

101 是内存错误，导致内存不足。您可以尝试重新启动设备，然后运行仪器并查看发生了什么。这样您就可以确保问题不会从您拥有的先前应用程序或版本中遗留下来

我修复了我的应用程序！！！！呜呜呜！我离开了 XIB 的 cellidentifier。滚动表格分配了太多内存..和 Boom 崩溃怪异。

# database-design - 构建一个数据库，其中产品具有来自多个供应商的多种包装类型

> ID：582388
> 
> 赞同：3
> 
> 时间：2009-02-24T16:13:02.540
> 
> 标签：database-design, architecture

假设我有一张`Products`桌子，并且有一个出售产品的“默认”单位（`EA`比如说，单独出售）。该产品还可以从一些供应商处获得，例如`BX`(box) 和`CT`(carton)，每个都包含一定数量的“默认”单位（在我们的例子中，假设一个盒子是 6 个，一个纸盒是 12 个）。

该产品有一个与“默认”单位相关联的常规标价，然后是每个附加销售单位的另一个标价。产品的成本（即我们作为卖方支付的费用）因每个供应商的产品而异，我们打算实施一种方法来查看销售产品的供应商列表，以便我们可以选择最优惠的价格（例如，我们可能会选择 Vendor A 代表单个产品，供应商 B 代表纸箱，因为他们卖给我们的价格比供应商 A 便宜）。

业务规则要求我们为每个包装级别的产品维护一个单独的 SKU，但其余信息（例如销售副本、制造商、描述）是相同的。因此，给定带有 SKU 的产品，`ACM1234`它可能具有“可显示”的 SKU：

```
ACM1234 - 标价 5.00 美元的单个产品（默认）
ACM1234BX - 盒装（6 个），标价 $28.00
ACM1234CT - 纸箱包装（12 个），标价 50.00 美元

```

该产品可能由 3 个不同级别的供应商提供 - 其中一些可能不提供纸盒版本，但提供盒装和单件，而其他人可能三者都有。

此外，由于我们的主要客户是美国政府，并且我们有“合同”和“非合同”项目的概念，因此该产品需要被视为一个单独的实体；例如，我们可能只选择向政府出售产品的盒装和纸箱版本，而不是单件。然后，当我们收到订单时，我们需要按 SKU（例如 ）查找商品`ACM1234BX`并取回它的信息 - 例如我们出售它的目的。如果产品数据库具有“常规”SKU（例如，单个项目）但政府客户购买了盒装版本，这可能会遇到问题。

通常我会有一个“主”产品表，其中包含 SKU 和其他相关信息，如描述。然而，在这种情况下，创建一个模式来处理这个问题的最佳方法是什么？我可以做一个查找表，并在一个表中列出“常见”信息（销售副本、描述、是否回收等）并将其链接到另一个表，该表列出了产品及其包装级别以及具有显示 SKU 的“计算”列。也许是这样的：

```
# 产品表
id 描述 回收的销售副本
1 ACME(R) Widget Plus 1 您将永远需要的唯一 Widget...

# 包装表
product_id unit sell_sku list_price
1 EA ACM1234 5.00
1 CT ACM1234CT 50.00
1 BX ACM1234BX 28.00

```

但是我担心在查找或添加新产品时这会变得非常复杂和笨拙。我们从中接收产品信息的供应商包含的内容相当于一个包含所有相关信息的表格，并且不要假设您销售的产品采用多种包装类型（仅是主要类型）。他们还提供自己的人工 ID，将所有内容联系在一起。我正在考虑这样做的另一种方式是在 Products 表中有一行对应于常规产品实体（例如单个），然后将相关表与该产品的其他包级别以及 UI（我没有在我试图构建一个合适的数据模型时，还没有考虑过）做一个“自动建议”

我觉得我走在正确的轨道上，但我仍然认为我遗漏了一些东西，我的头开始旋转，因为我试图在精神上运行所有这些潜在的场景以提出一个可扩展的解决方案。它需要能够容纳可以从多个供应商以不同价格水平单独销售、装在盒子里和装在纸箱中的产品。

有什么建议或想法吗？

**编辑：**我使用 SQL Server 2005 Standard 作为数据库。

**编辑（2009 年 2 月 25 日）：**因此，请参考以下`awithrow`建议`David Aldridge`：

```
＃ 产品
id base_sku ...
1个ACM1234

# 供应​​商
身份证名称
1 联合供应公司
2 ACME 办公用品

# 产品包
id productID unit list价格
1 1 EA 5.00               
2 1 BX 15.00
3 1 克拉 40.00

# VendorsProductsPackages
vendorID packageID 成本          
1 1 3.45          
1 2 7.85
1 3 14.86
2 2 10.45

```

可能会创建一个表，其中包含每种类型单位的 SKU 后缀映射，以防我们添加更多。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-24T17:59:30.617

听起来你走在正确的轨道上，但看起来你的桌子需要再分解一点。这是我将如何做到这一点：

类似于您所拥有的产品表：

```
Products table

id    description             recycled  base_SKU     sales_copy
1     ACME(R) Widget Plus     1         ACM1243      The only Widget you will ever need... 
```

包装表

```
Packaging table:

id     unit     SKU_suffix
1      EA       ''
2      CT       'CT'
3      BX       'BX' 
```

最后是与两者相关的第三张表：

```
Packaged Product Table

id     product_id     package_id     price
1      1              1              $5
2      1              2              $50
3      1              3              $28 
```

现在您可以从第三个表中选择并使用 base_SKU 和 SKU_suffix 来创建“最终”SKU。这取决于您使用的数据库引擎。理想情况是它可以防止您将相同的信息复制到多个表中。

您还提到向不同的客户提供不同的包裹，即不向政府出售个别物品。您可以创建另一个名为“目录”的表或类似的表，它将打包产品 ID 映射到客户 ID。然后，您可以向客户发送自定义目录。您还可以通过执行以下操作为政府生成目录：

```
SELECT <fields> from Packaged_Products WHERE package_id != 1 
```

同样，这将取决于您的数据库

希望这可以帮助

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-25T00:59:20.763

在我看来，您需要以下表格：

*   产品：基础产品本身
*   Product_Package：它进来的包
*   供应商：供应商的完整列表
*   Product_Package_Vendor：将供应商与他们提供的产品包相关联的交集

# eclipse - 在 ECLIPSE_HOME/plugins 以外的目录中安装 Eclipse (3.4+) 插件

> ID：582391
> 
> 赞同：19
> 
> 时间：2009-02-24T16:13:29.403
> 
> 标签：eclipse, ide

曾经有一种方法可以做到这一点，但我在 Eclipse 3.4.1 安装中再也找不到这个了。有谁知道如何做到这一点？

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2009-02-24T16:22:54.590

2014 年 5 月更新，Eclipse 4.x

正如[oberlies在](https://stackoverflow.com/users/1523648/oberlies)[评论](https://stackoverflow.com/questions/582391/installing-eclipse-3-4-plugins-in-a-directory-other-than-eclipse-home-plugins/582430#comment36150639_582430)中指出的那样：

> Dropins 已弃用！不要使用它们！

即使它们仍然被记录在案（[例如在 Kepler 4.3 中](http://help.eclipse.org/kepler/index.jsp?topic=/org.eclipse.platform.doc.isv/reference/misc/p2_dropins_format.html)），[这个线程](https://community.oracle.com/thread/2513822)添加：

> Eclipse 不推荐使用 dropins 文件夹安装方法的原因之一是**如果出现问题没有反馈**。任何数量的事情都可能成为阻碍。
> 
> *   如果您使用的是安装 UI，您会在进行任何更改之前被告知问题。
> *   使用 dropins，Eclipse 会尝试尽可能多地安装和启动，而您并不真正知道发生了什么。

[如本教程所示，](http://www.vogella.com/tutorials/EclipsePlugIn/article.html#deployplugin)本地部署宁愿使用`File → Export → Plug-in Development → Deployable plug-ins and fragments`.

但最终目的地仍在`ECLIPSE_HOME/plugins`。

* * *

原始答案（2009，Eclipse 3.x）

您应该将插件添加到`ECLIPSE_HOME/dropins`.

如果要定义通用插件，使用**[捆绑池](http://ekkes-corner.blogspot.com/2008/06/eclipse-ganymede-p2-shared.html)**（[这里也有介绍](http://wiki.eclipse.org/Equinox_p2_Getting_Started#Bundle_pooling)）

![http://2.bp.blogspot.com/_Xv6Yjx9z9no/SGftQroKv6I/AAAAAAAAAJc/JcPTai4GhiU/s400/p2+shared+verzeichnisse.png](https://i.stack.imgur.com/a1jYJ.png)

您还可以使用自己的额外 dropins 文件夹：只需将参数添加到`eclipse.ini`：

```
-Dorg.eclipse.equinox.p2.reconciler.dropins.directory= /your_path/e34shared_dropin 
```

这个额外的 dropins 位置可以从多个 Eclipse 安装中使用 - 因此您可以将其用作共享的 dropins（监视目录）。

对于**Bundle Pool**，您在[这里有一个分步过程](http://parenthetical-thoughts.blogspot.com/2008/07/fun-with-p2.html)：

* * *

为了更好地解决您的问题，您可能会发现以下文章很有趣：

[**p2：我如何在扩展位置安装插件**](http://michaelscharf.blogspot.com/2009/02/p2-how-i-install-plugins-in-extension.html)（来自**[Michael Scharf 博客的 Eclipse 和 Java](http://michaelscharf.blogspot.com/)**博客）

> 以下过程说明了**如何将插件安装到不同的扩展位置，并使用****p2 更新管理器和链接文件**在不同的 eclipse 安装之间共享这些扩展位置。如需详细讨论，请参阅[错误 224145](https://bugs.eclipse.org/bugs/show_bug.cgi?id=224145)

（注意：p2是管理插件的“新”方式，链接是在eclipse安装目录之外引用插件的“旧”方式）

> 我保留了一组不同的扩展位置`C:\eclipse\extensions`（每个扩展位置都在该目录的子目录中）。
> 假设我想将 foo 安装到新的扩展位置`C:\eclipse\extensions\foo`。
> 
> 1.  我开始日食：

```
-configuration C:\eclipse\extensions\foo\eclipse\configuration 
```

> 2.  我使用更新管理器安装 foo。
>     
>     
> 3.  `foo.link`现在我可以通过在 eclipse 安装的 links 目录中创建一个文件来使用扩展（您可能必须**创建`[eclipse]\links`目录**），其中包含：

```
 path=C:/eclipse/extensions/foobar 
```

> 就是这样 ：-）
> 
> 笔记：
> 
> *   您必须在链接文件中的窗口上使用正斜杠。
> *   此过程适用于 eclipse 3.4 和 3.5。
> *   您不必创建由 -configuration 参数指定的任何目录。Eclipse 将为您做到这一点。
> *   遵循`EXTENSION_NAME/eclipse/configuration`" `-configuration`" 参数的模式很重要，因为 p2 会将插件放在配置目录之上的一个目录，并且**链接文件要求包含插件的目录称为 eclipse**。
> *   使用这种结构，我可以通过使用 -configuration 运行 eclipse 来将插件更新到扩展位置，然后进行更新。
> 
> 高级使用：如果我想基于我的 foo 扩展安装 bar，我在 bar 扩展位置 links 目录中创建一个指向 foo 的链接文件：

```
C:\eclipse\extensions\bar\eclipse\configuration\links\foo.link 
```

> 并按照我上面描述的标准程序（可以在第一次运行 eclipse 之前填充链接目录）...
> 
> eclipse 3.4 的注意事项：如果您使用的是 eclipse 3.4 并且想要使用 eclipse 默认更新站点，则必须在没有“ `-configuration`”的情况下运行 eclipse 并将它们导出（`Help->Software Updates->Available Software (tab)->Manage Sites->Export`），这样您就可以将它们导入到“ `-configuration`”eclipse 中。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-24T16:17:23.777

不确定这是否是您正在寻找的，但如果您手动获取插件（不是通过加载器，就像 jars 一样），您可以使用 dropins 机制。

转到 ECLIPSE_HOME/dropins

创建一个名为“SomeNameForFunctionality”的目录 在下面创建一个名为“eclipse”的子目录 在“Eclipse”下面创建一个名为“features”和“plugins”的子目录 将插件和特性 jar 移动到相应的子目录中。

重新启动 Eclipse 并确保加载需要几秒钟。您的插件应该仍然存在。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-24T17:37:27.517

如果您手动安装插件，Dropins 文件夹是一个很好的解决方案。如果您通过更新管理器安装插件，则无法通过 UI 选择插件的安装位置。不再。

顺便说一句，如果您喜欢在多个 Eclipse 安装之间共享插件，您可以创建一个链接文件，将其放在 Dropins 文件夹中，它的工作原理是一样的，无需修改 INI。

链接文件是纯文本文件，以 .link 扩展名结尾，其中包含一行：`path=/path/to/your/plugins`

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2011-10-21T12:10:53.053

我只是浪费了一个小时试图在 Eclipse 3.7 的 dropins/ 目录中部署一个插件，并认为我会分享。

事实证明，由 MacOS X 生成的预览文件（以 ._ 例如 .com.example.myplugin.jar 开头*）干扰了 P2 自动检测并导致它在到达我的插件之前失败。我搜索了所有 .* 文件并删除它们，插件终于加载了

# ios - iOS：didReceiveMemoryWarning 的帮助：

> ID：582401
> 
> 赞同：12
> 
> 时间：2009-02-24T16:15:41.630
> 
> 标签：ios, cocoa-touch, memory-management

我正在开发过程中跟踪崩溃和内存泄漏。作为一种策略，您是否将任何 NSLog 消息或通知放入其中`didReceiveMemoryWarning:`？此方法的文档相当稀少。准确地说，在崩溃发生之前，UIViewController 会触发该方法吗？在使用 Instruments 之前，这是一个起点吗？

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2009-02-24T17:20:20.290

好的，有几点需要注意：

*   didReceiveMemoryWarning 将在内存不足崩溃之前调用。不是其他崩溃。如果您正确处理警告并释放内存，那么您可以避免内存不足的情况并且不会崩溃。
*   您可以在硬件菜单下的模拟器中手动触发内存警告。强烈建议这样做以测试您对 didReceiveMemoryWarning 的处理。
*   Instruments 可以帮助您调试泄漏（尽管不是全部）——它对于崩溃并不是那么有用。
*   不，我个人不使用 NSLog - 我只是在调试时断点内存警告。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-06-25T10:41:13.107

**更新** 从 iOS 6 开始，`UIViewController`不再卸载视图以响应内存警告。`didReceiveMemoryWarning`相反，只要尽你最大的努力释放任何你可以在被调用时合理地重新创建的资源（例如缓存的数据） 。

**更新**
当我还是一个愤怒的年轻人时，我写了我的原始答案；时代变了，基本上，这是错误的。

如果您有一个带有单个视图控制器的应用程序并且您收到内存警告，那么您无能为力。但是，如果您有多个视图控制器，情况会发生巨大变化，因为您可以卸载与非最前端控制器关联的**所有状态。**事实上`[UIViewController didReceiveMemoryWarning]`，会通过为您卸载不可见的视图来促使您朝着正确的方向前进（惊喜！）。当最前面的视图控制器被关闭时，底层视图被重新加载，并且最多用户应该只知道延迟，即使您的应用程序内部可能已经完成了完全重启。

这不是您可以轻松改造的一些细节，您需要从一开始就牢记内存使用情况，并将您的多视图应用程序设计成完全可卸载的`UIViewController`部分。事实上，让你的代码与模拟器兼容只是为了使用它的内存警告功能是值得的。

当内存充足时，什么都没有卸载，一切都如丝般顺滑，当内存不足时，事情会继续工作，尽管速度会更慢。现在我想说，这种有限内存问题的解决方案是理想的。

为了利用这个内存客厅技巧，重载`UIViewController`方法 `viewDidLoad`,`viewDidUnload`和 `viewWillUnload`(iOS5，如果卸载状态需要您的视图仍然存在，例如，如果您不想泄漏 OpenGL 纹理和渲染缓冲区，则在 iOS4 上您可以模拟这是通过重载`didReceiveMemoryWarning`和跟踪视图的可见性来实现的）。

**原汁原味的答案**

`didReceiveMemoryWarning`绝对没用。

不能保证如果你释放内存（甚至是全部）你不会被杀死。

在我痛苦的经历中，它通常在 2.x/3.0 上这样工作：

1.  mediaserverd 泄漏了一堆内存

2.  我的应用程序被杀死

不幸的是，收割者从未想过要杀死 mediaserverd。

所以如果内存使用不是你的错，你真的只有两个选择：

1.  要求用户重新启动（用户认为这是你的错，写了严厉的评论）

2.  希望罪魁祸首崩溃（mediaserverd经常有义务！）

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2011-09-22T07:00:22.200

如果用户让某些应用程序处于打开状态，那么您可以使用的内存将非常少。所以有时`didReceiveMemoryWarning`只有 1 MB 的使用量才能被系统调用。

系统会在所有视图控制器上调用此方法，如果您在每个视图控制器中放置一个 NSLog，您会注意到这一点。

然后系统`viewDidUnload`将自动在您的所有视图控制器（不是`dealloc`）上调用该方法。所以你必须把你所有的释放指令放在那里。

您必须进行大量实验，因为如果您的应用程序很复杂，您将在管理它之前面临很多崩溃。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-02-24T18:34:31.280

didReceiveMemoryWarning 的目的是让您有机会释放内存或弹出视图以避免崩溃。您不会在任何可预测的时间收到它，因为它取决于用户在做什么。例如，如果用户正在收听 iPod，则可用内存较少，您将更快收到。

一般的经验法则是您有大约 8MB 的 RAM 可供使用。当您接近它时，您可以预期该事件会被引发。如果您故意占用这么多内存，您应该有一个计划来解决它。

# .net - System.Windows.Forms.Keys 枚举中的“OEM”键是什么？

> ID：582403
> 
> 赞同：23
> 
> 时间：2009-02-24T16:16:00.303
> 
> 标签：.net, keyboard

一位朋友在弄清楚如何将“Ctrl + +”作为快捷键分配给`ToolStripMenuItem`. 我指出该`Keys.OemPlus`键可以工作，并且需要设置快捷方式的显示字符串，但`Keys`枚举让我感到困惑。

这些“OEM”密钥是怎么回事？我做了一些搜索，似乎是因为这些键仅在 Win2k 或更高版本中受支持，但这似乎很荒谬，因为我确信在 Win2k 之前的几十年里人们一直在使用加键。为什么没有“OemEquals”？`Keys`枚举中是否还有其他完全不存在的键？

我主要是在寻找为什么这些特殊命名值存在的答案，但我很想听听关于其他问题的讨论。是否可以安全地假设，因为加号位于我键盘上的等号之上，所以使用`Keys.OemPlus`并检查 Shift 修饰键可以判断是否单击了 Ctrl + =？还有其他省略的键吗？

请注意，这*不是*WPF 问题，尽管`System.Windows.Forms.Keys`和`System.Windows.Input.Key`枚举看起来相同（尽管`Key`根据框架设计指南命名不正确；））

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2009-02-24T16:45:03.087

它们是随 Windows API 引入的，它们并不特定于 WPF。

首先，这些是**KEY**代码，而不是字符代码：它们标识键盘上的键，而不是字符 - 例如，“A”字符通常是通过在按住 SHIFT 键的同时按下 A 键或激活 CAPS LOCK 来生成的。

**OEM 键**是**随本地键盘而变化**的键。美式键盘有括号和大括号，德式键盘有变音符号。

它们被称为“OEM”，因为（键盘的）原始设备制造商负责定义它们的功能。

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2009-02-24T16:34:23.363

OEM 的意思是“原始设备制造商”（或相对接近的东西）。我认为这是 WPF 方面的一种尝试，它在某种程度上是平台中立的。不过，这只是一种意见。

# multithreading - Windbg 堆栈跟踪问题

> ID：582404
> 
> 赞同：1
> 
> 时间：2009-02-24T16:16:01.597
> 
> 标签：multithreading, crash, windbg, managed

我正在调试托管代码的崩溃转储，当使用 !threads 在这里显示所有线程时，几个线程具有 Exception 字段值和各种异常。

我的问题是如何快速识别哪个异常是导致进程崩溃的根异常？为什么这么多线程与异常值相关联的任何想法 - 我认为应该只有一个线程（具有未处理的异常）导致进程崩溃，为什么这么多线程显示异常？:-)

提前谢谢，乔治

这是！threads 的一部分的输出示例，FooException 和 GooException 是我的应用程序定义的异常类型。

48 f 14c4 000000001d8bc4a0 b020 Enabled 0000000000000000:0000000000000000 0000000000162080 0 MTA FooException (0000000093365da0) 49 10 17e8 000000001acc26d0 200b020 Enabled 0000000000000000:0000000000000000 0000000000162080 0 MTA FooException (0000000093364670) 50 11 135c 000000001acc3180 200b020 Enabled 0000000000000000:0000000000000000 0000000000162080 0 MTA FooException (00000000dd707f70) 51 12 1740 000000001aca2ec0 200b020 Enabled 0000000000000000:0000000000000000 0000000000162080 0 MTA FooException (00000000937e8a60) 52 13 814 000000001aca3970 b020 Enabled 0000000000000000:0000000000000000 0000000000162080 0 MTA GooException (000000009336c550) 53 14 6ac 000000001accb010 b020 Enabled 0000000000000000:0000000000000000 0000000000162080 0 MTA FooException (0000000093355f58) 54 15 1114 000000001accbac0 b020 Enabled 0000000000000000:0000000000000000 0000000000162080 0 MTA 56 16 d44 000000001accc570 200b020 Enabled 0000000000000000:0000000000000000 0000000000162080 0 MTA GooException (00000000933c0598) 58 17 ff4 000000001accd020 200b020 Enabled 0000000000000000:0000000000000000 0000000000162080 0 MTA FooException ( 00000000a8a39c48) 59 18 780 000000001accdad0 b020 Enabled 0000000000000000:0000000000000000 0000000000162080 0 MTA 60 19 8fc 000000001acce580 b020 Enabled 0000000000000000:0000000000000000 0000000000162080 0 MTA FooException (00000000abd5ff08) 61 1a 2e8 000000001accf030 b020 Enabled 0000000000000000:0000000000000000 0000000000162080 0 MTA FooException (00000000ac163ea0) 62 1b 11e8 000000001d8bd010 b020 Enabled 0000000000000000:0000000000000000 0000000000162080 0 MTA FooException (0000000093367c78) 63 1c 1520 000000001d8bd5e0 200b020 Enabled 0000000000000000:0000000000000000 0000000000162080 0 MTA 64 1d 1330 000000001d8be090 b020 Enabled 0000000000000000:0000000000000000 0000000000162080 0 MTA FooException ( 00000000937d9540) 65 1e 7f8 000000001d8beb40 b020 Enabled 0000000000000000:0000000000000000 0000000000162080 0 MTA FooException (000000009339a038) 66 1f a70 000000001d8bf5f0 b020 Enabled 0000000000000000:0000000000000000 0000000000162080 0 MTA FooException (00000000937d8b88) 67 20 150 000000001d8c00a0 b020 Enabled 0000000000000000:0000000000000000 0000000000162080 0 MTA 68 21 1628 000000001d8c0b50 b020 Enabled 0000000000000000:0000000000000000 0000000000162080 0 MTA FooException (0000000093355200) 69 22 1148 000000001d8c1600 200b020 Enabled 0000000000000000:0000000000000000 0000000000162080 0 MTA GooException (000000009380ada8) 70 23 16a8 000000001d8c20b0 b020 Enabled 0000000000000000:0000000000000000 0000000000162080 0 MTA FooException ( 0000000093365178) 71 24 1640 000000001d8c2b60 b020 Enabled 0000000000000000:0000000000000000 0000000000162080 0 MTA FooException (0000000093343a78) 72 25 1568 000000001d8c3610 b020 Enabled 0000000000000000:0000000000000000 0000000000162080 0 MTA FooException (000000009380cc08)0000000000000000 0000000000162080 0 MTA FooException (0000000093355200) 69 22 1148 000000001d8c1600 200b020 Enabled 0000000000000000:0000000000000000 0000000000162080 0 MTA GooException (000000009380ada8) 70 23 16a8 000000001d8c20b0 b020 Enabled 0000000000000000:0000000000000000 0000000000162080 0 MTA FooException (0000000093365178) 71 24 1640 000000001d8c2b60 b020 Enabled 0000000000000000:0000000000000000 0000000000162080 0 MTA FooException (0000000093343a78) 72 25 1568 000000001d8c3610 b020 已启用 0000000000000000:0000000000000000 0000000000162080 0 MTA Foo3008008 (000000cc09)0000000000000000 0000000000162080 0 MTA FooException (0000000093355200) 69 22 1148 000000001d8c1600 200b020 Enabled 0000000000000000:0000000000000000 0000000000162080 0 MTA GooException (000000009380ada8) 70 23 16a8 000000001d8c20b0 b020 Enabled 0000000000000000:0000000000000000 0000000000162080 0 MTA FooException (0000000093365178) 71 24 1640 000000001d8c2b60 b020 Enabled 0000000000000000:0000000000000000 0000000000162080 0 MTA FooException (0000000093343a78) 72 25 1568 000000001d8c3610 b020 已启用 0000000000000000:0000000000000000 0000000000162080 0 MTA Foo3008008 (000000cc09)0000000000000000 0000000000162080 0 MTA GooException (000000009380ada8) 70 23 16a8 000000001d8c20b0 b020 Enabled 0000000000000000:0000000000000000 0000000000162080 0 MTA FooException (0000000093365178) 71 24 1640 000000001d8c2b60 b020 Enabled 0000000000000000:0000000000000000 0000000000162080 0 MTA FooException (0000000093343a78) 72 25 1568 000000001d8c3610 b020 Enabled 0000000000000000:0000000000000000 0000000000162080 0 MTA FooException (000000009380cc08)0000000000000000 0000000000162080 0 MTA GooException (000000009380ada8) 70 23 16a8 000000001d8c20b0 b020 Enabled 0000000000000000:0000000000000000 0000000000162080 0 MTA FooException (0000000093365178) 71 24 1640 000000001d8c2b60 b020 Enabled 0000000000000000:0000000000000000 0000000000162080 0 MTA FooException (0000000093343a78) 72 25 1568 000000001d8c3610 b020 Enabled 0000000000000000:0000000000000000 0000000000162080 0 MTA FooException (000000009380cc08)00000000000000000000000000000000000000162080 0 MTA FOOEXCEPTION（0000000093343A78）72 25 25 1568 000000001D8C3610 B020 B020启用000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000162080CICCICTAFOO00000000000000000000000000000000000000162080 0 MTA FOOEXCEPTION（0000000093343A78）72 25 25 1568 000000001D8C3610 B020 B020启用000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000162080CICCICTAFOO

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-26T14:56:20.897

在调试转储时，可以使用**“~”**命令找到故障线程，然后查找**“.”。**旁边的线程之一。然后你切换到那个线程并运行**kb**。您应该在本机调用堆栈中看到对**RaiseException()**的调用。

一旦您知道感兴趣的线程， 您也可以运行**!clstack来获取托管调用堆栈。**

您还可以在线程上运行**!pe**以转储 (!PrintException) 输出。

这应该让你大部分时间..根据我概述的步骤随意评论和分享更多数据，我们应该能够快速解决这个问题

要回答您的问题，在线程上出现异常的一段时间内，!threads 输出将表明这一点。所以看起来你有很多异常需要追踪。

**另一种技术（值得另一个标签:-)**

要跟踪其他异常，您可以使用 Visual Studion 并在 UI 中启用对抛出异常的中断。如果你胆子大，可以运行 Mdbg 并运行以下命令来捕捉被抛出的异常

```
Open a VS.NET 2005/2008 Command Prompt
mdbg
>pro //Lists the processes
>a <PID> //attach to the processes
>ca ex //catches all exceptions
>g //go until break
//When it breaks on an exception
>where -v -c 200 // dumps the managed call stack (verbose) with a count of 200 frames
>print //prints out locals on the stack
>g //go to next exception
>de //Detach when done.. process stays running
>q //Quit the debugger 
```

MDbg 的**好处**是您可以进行源代码级调试。（也许我会为这些创建一个**MDbg**标签）

谢谢，亚伦

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-01-04T20:27:07.847

George2，您是否尝试过命令“！analyze -v”？你加载了 sos dot net 调试器扩展吗？（尝试 .chain 命令查看它是否在其中）。分析 -v 很有帮助。. .

# xcode - Xcode 调试器：代码窗口与堆栈窗口不匹配

> ID：582412
> 
> 赞同：2
> 
> 时间：2009-02-24T16:19:20.700
> 
> 标签：xcode, gcc

我正在尝试将基于[SDL](http://en.wikipedia.org/wiki/Simple_DirectMedia_Layer)和[WxWidgets](http://en.wikipedia.org/wiki/WxWidgets)的相当大的 Windows 项目移植到 Mac OS X。

我第一次在 Mac 上运行我的应用程序，但调试器似乎无法正常工作。当闯入我的应用程序时，堆栈视图似乎很有意义，但是当我单击调试器堆栈视图中显示的函数名称之一时，下面的代码视图向我显示了一段完全不同的代码。

例如，我在堆栈视图中单击“main”，但下面的代码窗口从 Mac OS X SDK 跳转到 stdexcept 的第 100 行。

我尝试将调试器与“hello world”项目一起使用，一切正常，所以问题一定与我的项目有关。我已经在项目选项中检查了以下设置：

> 生成调试符号：1 级
> 
> 调试符号：所有符号
> 
> 优化级别：无
> 
> 构建变体：调试

我还确保在调试器首选项中关闭了“Load Symbols Lazily”。

什么可能导致调试器出现故障？

**编辑：按照 sqook 的建议，我已经通过将所有 .cpp 和 .h 文件转换为 Unix 行结尾来排除 Windows 文件结尾。**

**第二次编辑：由于该问题仅发生在此特定项目中，因此我在此处发布从默认设置更改的所有设置（标题搜索路径除外）。也许其中之一可能是罪魁祸首？**

```
 ARCHS = $(NATIVE_ARCH)
    SDKROOT = macosx10.5
    VALID_ARCHS = i386 x86_64
    BUILD_VARIANTS = normal
    MACOSX_DEPLOYMENT_TARGET = 10.4
    COPY_PHASE_STRIP = NO
    DEAD_CODE_STRIPPING = NO
    OTHER_LDFLAGS = $(OTHER_LDFLAGS_LIBBOOST) $(OTHER_LDFLAGS_QUOTED_FOR_PROJECT_1) $(OTHER_LDFLAGS_QUOTED_FOR_PROJECT_2) $(OTHER_LDFLAGS_WXWIDGETS)
    PREBINDING = NO
    PRODUCT_NAME = Gemsweeper
    FRAMEWORK_SEARCH_PATHS = $(HOME)/Library/Frameworks /Library/Frameworks $(FRAMEWORK_SEARCH_PATHS)
    HEADER_SEARCH_PATHS = $(HEADER_SEARCH_PATHS_QUOTED_FOR_PROJECT_7) $(HEADER_SEARCH_PATHS_QUOTED_FOR_PROJECT_6) /usr/local/include $(HEADER_SEARCH_PATHS_QUOTED_FOR_PROJECT_1) $(HEADER_SEARCH_PATHS_QUOTED_FOR_PROJECT_2) $(HOME)/Library/Frameworks/SDL.framework/Headers /Library/Frameworks/SDL.framework/Headers $(HEADER_SEARCH_PATHS) /opt/local/var/macports/software/boost/1.37.0_0+darwin_9/opt/local/include $(HOME)/Library/Frameworks/SDL.framework/Headers /Library/Frameworks/SDL.framework/Headers $(HEADER_SEARCH_PATHS_QUOTED_FOR_PROJECT_3) $(HEADER_SEARCH_PATHS_QUOTED_FOR_PROJECT_4) $(HEADER_SEARCH_PATHS_QUOTED_FOR_PROJECT_5)
    LIBRARY_SEARCH_PATHS = /usr/local/lib /opt/local/lib
    GCC_DEBUGGING_SYMBOLS = full
    GCC_OPTIMIZATION_LEVEL = 0
    OTHER_CFLAGS = $(WX_CXX_FLAGS)
    OTHER_CPLUSPLUSFLAGS = -I/usr/local/lib/wx/include/mac-ansi-debug-2.8 -I/usr/local/include/wx-2.8 -D_FILE_OFFSET_BITS=64 -D_LARGE_FILES -D__WXDEBUG__ -D__WXMAC__
    GCC_PREPROCESSOR_DEFINITIONS = NO_BASS_SOUND _DEBUG XCODE __WXMAC__
    GCC_WARN_ABOUT_RETURN_TYPE = YES
    GCC_TREAT_NONCONFORMANT_CODE_ERRORS_AS_WARNINGS = YES
    GCC_WARN_UNUSED_VARIABLE = YES
    HEADER_SEARCH_PATHS_QUOTED_FOR_PROJECT_1 = '/Users/adriangrigore/Documents/Gemsweeper Mac'
    HEADER_SEARCH_PATHS_QUOTED_FOR_PROJECT_2 = "/Users/adriangrigore/Documents/Gemsweeper Mac/Finity Engine VS 2003/WxNonogram"
    HEADER_SEARCH_PATHS_QUOTED_FOR_PROJECT_3 = "/Users/adriangrigore/Documents/Gemsweeper Mac/Finity Engine VS 2003/Finity Engine VS 2003/myunits/resmanager"
    HEADER_SEARCH_PATHS_QUOTED_FOR_PROJECT_4 = "/Users/adriangrigore/Documents/Gemsweeper Mac/Finity Engine VS 2003/Finity Engine VS 2003/myunits"
    HEADER_SEARCH_PATHS_QUOTED_FOR_PROJECT_5 = "/Users/adriangrigore/Documents/Gemsweeper Mac/Finity Engine VS 2003/Finity Engine VS 2003"
    HEADER_SEARCH_PATHS_QUOTED_FOR_PROJECT_6 = "/Users/adriangrigore/Documents/Gemsweeper Mac/Finity Engine VS 2003/Finity Engine VS 2003/myunits/compiler-dependent"
    HEADER_SEARCH_PATHS_QUOTED_FOR_PROJECT_7 = '/Users/adriangrigore/Documents/Gemsweeper Mac/3rd party/AntiGrain/include'
    OTHER_LDFLAGS_LIBBOOST = /opt/local/lib/libboost_program_options-mt.a /opt/local/lib/libboost_filesystem-mt.a /opt/local/lib/libboost_serialization-mt.a /opt/local/lib/libboost_system-mt.a /opt/local/lib/libboost_thread-mt.a
    OTHER_LDFLAGS_QUOTED_FOR_PROJECT_1 = '/Users/adriangrigore/Documents/Gemsweeper Mac/3rd party/FreeImage/Dist/libfreeimage.a'
    OTHER_LDFLAGS_QUOTED_FOR_PROJECT_2 = '/Users/adriangrigore/Documents/Gemsweeper Mac/3rd party/cpuinfo-1.0/libcpuinfo.a'
    OTHER_LDFLAGS_WXWIDGETS = -L/usr/local/lib   -framework IOKit -framework Carbon -framework Cocoa -framework System -framework QuickTime -framework OpenGL -framework AGL  -lwx_macd_richtext-2.8 -lwx_macd_aui-2.8 -lwx_macd_xrc-2.8 -lwx_macd_qa-2.8 -lwx_macd_html-2.8 -lwx_macd_adv-2.8 -lwx_macd_core-2.8 -lwx_base_carbond_xml-2.8 -lwx_base_carbond_net-2.8 -lwx_base_carbond-2.8 
```

**希望最后一次编辑：**我刚刚发现问题实际上与 Xcode 调试器无关，而与底层 GDB 有关。通过命令行调试我的程序时，我看到了完全相同的问题。因此，我已将此问题移至*[GCC 调试器堆栈跟踪显示错误的文件名和行号](https://stackoverflow.com/questions/594782/gdb-stack-trace-displays-wrong-file-name-and-line-number)*。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-24T16:22:16.433

Xcode 有问题。非常非常有问题。即使是 3.x，我昨晚也遇到了同样的问题，因为它显示的循环超出了应有的范围。插入一些 printf() 表明是调试器 IDE 出了问题。

但是，您可以尝试一个干净的构建。并确保您使用的是调试版本。并且所有模块都已加载。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-24T16:24:15.510

我也注意到了这一点，并就此向 Apple 报告了一个错误。他们否认了这种行为，但暗示这可能是由文件中错误的行尾引起的。无论如何，尝试将行尾转换为 unix/mac 格式，完全清理，然后运行它。

**编辑**：我应该指定在 Xcode 中，有一个首选项可以保存行尾类型。您可以使用您选择的行尾重新保存所有文件。但是，这也有些不一致（grr），所以我建议使用[flip](http://ccrma.stanford.edu/~craig/utility/flip/flip.cpp)，并执行以下操作：

```
find /wherever -name "*.cpp" -print -exec flip -u {} \; 
```

同样，我不能保证这会解决问题，因为我接受了 Apple 的建议，但最终还是看到调试器在我的断点下方停止了几十行。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-03T09:58:46.140

[在此处](https://stackoverflow.com/questions/594782/gcc-debugger-stack-trace-displays-wrong-file-name-and-line-number/605744#605744)查看我的 SO 答案。SDL 重新定义`main`为`SDL_main`

# printing - 您可以在没有硬件的情况下打印到打印机驱动程序并查看输出吗？

> ID：582413
> 
> 赞同：2
> 
> 时间：2009-02-24T16:19:41.167
> 
> 标签：printing, hardware, testing

这是我们的情况。我们的软件可以选择打印卡片（信用卡大小的身份证）。我们有各种选项来设置图像的透明度、不同的字体、颜色以及一堆让卡片看起来漂亮的东西。问题似乎在于，并非每台证卡打印机在使用相同参数集的情况下都具有相同的功能。例如，某些边到边打印实际上似乎不是边到边，而在其他打印机上它似乎超出了边缘。

我认为我们需要的是一种方法来安装各种卡片打印机驱动程序，打印到它们，并将输出转到图像或 pdf 或我们可以在屏幕上查看的内容，以查看驱动程序打印到打印机时的样子.

但是，我不确定这是否真的有效。我不是硬件人，所以我不知道驱动程序如何真正与打印机硬件交互。

我们订购了另一台卡片打印机（不同的制造商）在另一台打印机上进行测试......问题是，每次客户来找我们并说“嗯，我们的乔的硬件卡片打印机”时，我们可能会花费很多钱工作不正常。”

任何有关如何处理此问题的建议表示赞赏。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-24T16:27:10.667

有一种东西叫`Print to File`。几乎所有应用程序都支持此功能。这会将 PDL 放在您的磁盘上，而不是将其发送到假脱机程序（在正常情况下，假脱机程序又会将其传递给设备）。

现在，如果你有一个 PS 驱动程序，你可以把 PS 放到你的磁盘上，你可以提取它（使用付费软件/Ghostscript）并查看输出。或者，如果您有 PDF 打印机，您可以获取 pdf，如果您有兴趣，还可以获取不同的平面。

此外，许多打印机会生成 tiff 文件（而不是生成 PS、PCL 或 PDF）。因此，请咨询您的供应商。

您的问题似乎主要是一个 tiff 比较问题。IMO，最好有一组光栅（tiff）用作基准，光栅比较工具，然后您可以随时使用任何打印机触发并运行差异。

确保如果差异很大，请自行检查这两个文件。您甚至可能会惊讶于这种差异是无形的。

但是，打印到设备**也**很重要。您在显示器上看到的内容以及在设备上打印的内容差异很大。这就是为什么他们有颜色配置文件之类的东西。和校准。所以，也要看看这些方面。但是我在胡说八道不重要的东西，所以...

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-24T16:31:38.940

我想说这是为什么许多专业软件供应商需要特定型号的硬件（无论是条形码扫描仪还是特殊打印机）的主要原因。我见过很多只支持某些型号的情况，并且购买软件的客户需要使用推荐的硬件，软件供应商不支持任何其他型号。

我使用的会计软件的要求之一是它需要一台兼容 PCL5 的打印机。大多数廉价箱打印机没有这种支持，我告诉许多客户，他们 75 美元的激光打印机无法与该软件一起使用，并且需要购买稍微贵一点的打印机。

由于打印机的特殊性，我不明白为什么制造商不会提供某种开发机器，因为他们愿意向您的客户群推荐他们的打印机。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-24T16:53:54.003

如果您愿意，请在这篇文章中添加评论，我将更新一个指向我们不久前开发的应用程序的链接，以通过 LPR 或 9100/RAW 捕获数据。这有助于您创建的队列不能很好地与“打印到文件”配合使用，或者它是操作系统上的一个应用程序，您几乎无法控制捕获输出。然后，您可以自己查看数据，或者如果它是 PS，您可以使用 gsview 或类似 PCLWorks 的东西，如果它是 PCL。话虽如此，如果它是专用设备，它可能有自己的语言（例如 Zebra 上的 ZPL），您可能必须简单地比较文件并反复试验才能看到是什么。

另一种选择是创建一个 Windows 队列（同样，如果打印到文件不起作用），暂停它，通过此队列发送数据，然后从 c:\windows\system32\spool\printers 获取 .spl 文件。只需确保您的 Windows 打印机的文件处理器未设置为 EMF（应为 RAW）

# bugzilla - 如何为 enter_bug.cgi 启用我的自定义格式？

> ID：582414
> 
> 赞同：0
> 
> 时间：2009-02-24T16:20:15.533
> 
> 标签：bugzilla

我已按照 Bugzilla 手册中的说明创建并测试了我自己的 enter_bug.cgi 自定义格式。我通过在 URL 中手动输入“format=xxx”进行了测试。现在我准备为其他用户推出这个。启用我的自定义格式作为默认格式的正确方法是什么？

我想出了一些对我来说似乎不太好的解决方案：

1.  破解 choose-classification.html.tmpl 或 choose-product.html.tmpl 强制格式
2.  用我的自定义版本替换现有的 create.html.tmpl
3.  破解 common-links.html.tmpl 以强制格式

似乎choose-classification.html.tmpl 和choose-product.html.tmpl 已经设置为正确处理传入的格式变量，但我似乎无法找出设置该变量的适当位置。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-04T14:04:46.417

我将此问题交叉发布到官方 bugzilla 支持新闻组 (mozilla.support.bugzilla) 并仅得到一个回复​​：

> 如果我是你，我会把它命名为 template/en/custom/bug/create/create.html.tmpl 以便它覆盖默认值。

我不想让我的自定义格式用于每个分类，因此，我只是修改了 choose-classification.html.tmpl 以手动将“format=xxx”强制输入到应用该格式的分类的 URL 中。不是最优雅的解决方案，但它有效。

# performance - Windows XP 性能监视器应用程序 (perfmon) 中缺少处理器/内存计数器

> ID：582415
> 
> 赞同：2
> 
> 时间：2009-02-24T16:20:16.017
> 
> 标签：performance, windows-xp, perfmon, performance-monitor

Perfmon 是一个 Windows 实用程序，可帮助开发人员通过测量系统计数器来发现其应用程序中的瓶颈。

我正在阅读[perfmon 教程](http://adminfoo.net/2007/04/windows-perfmon-top-ten-counters.html)，从这个基本计数器列表中，我在我的机器上找到了以下计数器：

1.  PhysicalDisk\Bytes/sec_Total
2.  网络接口\字节总数/秒\nic 名称

但我没有在任何地方找到以下计数器：

1.  Processor\% Processor Time_Total
2.  流程\工作集_总计
3.  内存\可用 MBytes

我在哪里可以找到它们？请注意，我的 Windows 是 pt-BR（而不是 en-US）。在哪里可以找到 PerfMon 等 Windows 工具的语言特定文档？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-03T14:58:48.337

我怀疑这与您的特定本地化版本的 Windows 无关。谷歌搜索“[缺少性能计数器](http://www.google.com/search?q=missing+perfmon+counters)”，你会发现很多人在所有版本的 Windows 上都遇到过类似的问题。

修复方法是按照[MS KB 300956](http://support.microsoft.com/kb/300956)中的说明进行操作。

还有许多其他好的资源可用于恢复某些*类型*的丢失计数器：

*   [频道 9 线程](http://channel9.msdn.com/forums/TechOff/59699-perfmon-counters-are-corrupted/ "频道 9")恢复丢失的 .Net 或 ASP.Net 计数器。遵循 KB 300956 的步骤也很好。
*   [MS KB 227662](http://support.microsoft.com/kb/227662)向您展示了如何恢复丢失的 SQL 性能计数器。
*   Exchange MVP 发布的关于恢复丢失的 Exchange 性能计数器[的博客。](http://msexchangetips.blogspot.com/2006/09/exchange-perfmon-exchange-counters.html)

现在，如果我误读了您的问题，而问题是*您无法阅读葡萄牙语*来确定哪些计数器与您实际想要的英语计数器等效，那么恐怕我无法帮助您。只需使用[谷歌翻译。](http://translate.google.com)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-24T17:03:19.907

您可以查看注册表`HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Perflib`。在我的德语 XP 系统上，该键有两个子键，分别命名为“007”用于德语条目和“009”用于英语条目。每个键都有一个名为“Counter”的 MULTI_SZ 值，其中包含一长串索引和相应的名称。如果您的系统有英语和葡萄牙语键，您可以通过查找匹配索引来找到您要查找的名称。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-03T14:05:30.317

运行以下命令行并重试：

```
lodctr /r 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-04-20T04:42:57.010

您可以启用禁用的计数器。使用注册表编辑器，将 HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\Service_name\Performance\Disable Performance Counters 下的值从 1（禁用）更改为 0（启用）或删除“禁用性能计数器”键。重新启动并重试。或者，如果您不想弄乱注册表，请从[http://www.hexagora.com/en_dw_davperf.asp](http://www.hexagora.com/en_dw_davperf.asp)下载“Performance Monitor”并安装它。它会在安装过程中自动启用您的 CPU 性能计数器（这将启用所有这些计数器）。这就是我所做的。

# java - 您知道免费或开源网站拼写检查器吗？

> ID：582418
> 
> 赞同：-2
> 
> 时间：2009-02-24T16:21:09.790
> 
> 标签：java, tomcat, web-applications, spell-checking, languagetool

我们正在寻找一种免费使用的网站软件，以便在我们的网站投入生产之前对其进行拼写检查。在线基本搜索将我带到以下页面： [Net MECHANIC](http://www.netmechanic.com/cobrands/FutureQuest/spell_check.htm) [Text Trust](http://www.texttrust.com/) [Orango](http://orangoo.com/spell/)

我在 NetMechanic 中进行了试用，我收到了一封没有结果的虚假电子邮件，并鼓励我购买他们的付费订阅。任何建议表示赞赏。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-26T22:29:37.110

我从事的一个项目即将实现[Jazzy](http://sourceforge.net/projects/jazzy)作为拼写检查器。它是免费的、开源的 (LGPL)，字典是简单的文本文件，也很容易添加您自己的单词。

**编辑添加：**
我们也在用它对 HTML 进行拼写检查，我认为它是“开箱即用”的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-24T18:08:16.477

[网络拼写检查器](http://sourceforge.net/projects/netspell/)。它是免费和开源的。

编辑：它不适用于 Java，但适用于 .NET；而且我认为将它移植到 Java 上并不难。

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2021-06-18T15:12:55.370

[试试](https://www.websitespellchecker.com)websitepellchecker.com ，它不是免费的，但很轻松。它扫描整个站点并提供一份 PDF 报告，显示错误所在。PDF 报告在您收到之前会经过检查，以确保您只收到您感兴趣的问题。此外，由于它是 PDF，因此很容易传递给需要解决问题的人。

# sql-server - 将 SSRS 报告导出到 Excel 时禁用超链接

> ID：582423
> 
> 赞同：2
> 
> 时间：2009-02-24T16:22:02.177
> 
> 标签：sql-server, reporting-services

我正在使用 ReportViewer 控件来呈现一些本地报告。这些报告有一些链接到上级报告的元素。其中一些元素包含大量数据（作为参数传递给子报表）。问题是当我将报告导出到 excel 时，由于单元格最大字符数限制，它不会在 excel 中打开。我想知道在导出到 excel 时是否可以从此报告中禁用/删除某些列。我曾尝试使用 DeviceInfo 设置并尝试禁用公式，但这并没有太大帮助。

非常感谢

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-20T18:16:09.743

虽然这个链接很旧，但我添加了这个答案，因为它可能会帮助其他人来到这里（就像我几天回来一样；）

下面是一个属性，它告诉类型在哪个报告中呈现。

> **Globals!RenderFormat.Name**

此属性可用于有条件地设置文本框上的操作，或者像我一样设置列的可见性。

请考虑这可能不适用于旧版本的 SSRS

下面是我详细介绍了在将报告导出到 SSRS 时如何使用此属性禁用超链接的链接。

[http://www.technicalsmile.blogspot.in/2012/10/disable-hyperlinksjavascript-when.html](http://www.technicalsmile.blogspot.in/2012/10/disable-hyperlinksjavascript-when.html) 谢谢

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-25T04:41:49.120

前段时间我问了一个类似的问题：[Reporting Services 2008：有没有办法根据报表的呈现方式来更改项目属性？](https://stackoverflow.com/questions/519565)

（当报表呈现为 Word 文档时，我想禁用某些项目）。

不幸的是，没有真正简单的答案，但是如果您愿意花一些时间在上面，一些自定义代码应该可以解决问题。（见 Gerrie Schenck 对我的帖子的回答）

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-25T15:48:30.517

好吧，我使用的是它的 winforms 版本，对此有两种可能的解决方案，一种是编写自己的渲染器（这对这个来说有点过头了），另一种是调整报告定义

我在 XmlDocument 中加载了报表定义并从中删除了所有 Action 节点，这将删除所有链接，然后在后台使用新定义重新运行报表并将其呈现到 Excel 中。虽然它需要更多的时间，但它完成了工作。

# visual-studio - Visual Studio 2008 SP1 和 Visual SourceSafe 2005

> ID：582424
> 
> 赞同：1
> 
> 时间：2009-02-24T16:22:15.560
> 
> 标签：visual-studio, visual-sourcesafe

我已经在我的台式计算机上安装了 Visua Studio 2008 Team System 2008 Architecture 和 Visual SourceSafe 2005。

Visual Studio 没有集成 Visual SourceSafe，如何在 Visual Studio 上集成 Visual SourceSafe。

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-24T16:25:32.510

工具->选项->源代码管理->插件选择。选择 Microsoft Visual SourceSafe

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-24T16:25:47.550

在 Visual Studio 2008 中，转到

工具 -> 选项 -> 源代码管理

并选择 Visual Sourcesafe 插件。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-24T16:42:08.803

您需要在[此页面](http://support.microsoft.com/kb/943847)上下载更新。然后 SourceSafe 应该可以作为插件使用（有时它不取决于您安装的 SourceSafe 版本）。

# perl - 如何处理 Moose 中的可选参数？

> ID：582427
> 
> 赞同：8
> 
> 时间：2009-02-24T16:22:39.087
> 
> 标签：perl, parameters, moose

我目前使用“Moose”包从 Perl OOP 开始。

编译器抱怨它“无法在 Parser.pm 第 16 行修改非左值子例程调用”。

我不太明白为什么我不能只分配一个新对象。我猜有更好或更有效的方法来使用 Moose 执行可选参数？

```
 #!/usr/bin/perl -w

package Parser;

use Moose;

require URLSpan;

require WWW::Mechanize;

has 'urlspan' => (is => 'rw', isa => 'URLSpan', required => 1);
has 'mech' => (is => 'rw', isa => 'WWW::Mechanize');

sub BUILD {
    my $self = shift;
    if(!$self->mech) {
        warn("no Mech set for " . $self->urlspan->name);
        $self->mech = WWW::Mechanize->new(agent => 'Mozilla/5.0 (Windows; U; Windows NT 6.0; de; rv:1.9.0.6) Gecko/2009011913 Firefox/3.0.4',
                                         stack_depth => 1
                                         ); #line 16
        }

} 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-02-24T17:09:00.440

`$self->mech`是一个方法调用；您不能真正将其视为 C 结构中的字段。如果要设置它，则需要将新对象传递给它。

```
 $self->mech( 
            WWW::Mechanize->new(
                agent => 'xyz',
                stack_depth => 1
            )
        ); 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-03-03T15:56:38.887

这样做的首选 Moose 方法可能是在属性上设置lazy_build：

```
has 'mech' => (is => 'rw', isa => 'WWW::Mechanize', lazy_build => 1);
sub _build_mech {
     warn("no Mech set for " . $self->urlspan->name);
     WWW::Mechanize->new(
           agent => 'Mozilla/5.0 (Windows; U; Windows NT 6.0; de; rv:1.9.0.6)'.
                    ' Gecko/2009011913 Firefox/3.0.4',
           stack_depth => 1
     );
} 
```

这将允许属性“mech”在第一次调用时被填充，除非由构造函数或访问器设置（因为它仍然是“rw”）。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-02-24T18:28:08.863

虽然 Perl 多年来一直提供使用属性的能力（通过所谓的 lvalue subs），但它不是第一个 OO Perl 版本中的东西，人们几乎学会了不用它. 特别是因为实施验证有点棘手（而且效率低下）。

您可以使用[MooseX::Meta::Attribute::Lvalue](http://search.cpan.org/perldoc/MooseX::Meta::Attribute::Lvalue)，但是（根据文档）以不对某些属性进行类型检查为代价。

我建议坚持使用 $self->attribute( "value" ) 风格。

# java - java.util.logging.Logger 和 log4j

> ID：582428
> 
> 赞同：3
> 
> 时间：2009-02-24T16:22:44.500
> 
> 标签：java, logging, netbeans, log4j

我正在尝试从这里编译代码：[http](http://www.brackeen.com/javagamebook/#download) ://www.brackeen.com/javagamebook/#download （第 6 章）并且遇到了麻烦。我不明白如何`java.util.logging.Logger`和 log4j 一起工作，但这似乎是问题所在。我得到的错误都在`log.error()`or`log.warn()`方法调用上。

这是 NetBeans 的输出：

```
在里面：
部门清理：
删除目录 C:\JB\NetBeansProjects\WRServer\build
删除目录 C:\JB\NetBeansProjects\WRServer\dist
干净的：
在里面：
deps-jar：
创建目录：C:\JB\NetBeansProjects\WRServer\build\classes
编译23个源文件到C:\JB\NetBeansProjects\WRServer\build\classes
C:\JB\NetBeansProjects\WRServer\src\com\hypefiend\javagamebook\server\GameServer.java:110：找不到符号
符号：方法错误（java.lang.String，java.lang.Exception）
位置：类 java.util.logging.Logger
            log.error("初始化ServerSocket错误", e);
               ^
C:\JB\NetBeansProjects\WRServer\src\com\hypefiend\javagamebook\server\GameServer.java:152：找不到符号
符号：方法警告（java.lang.String）
位置：类 java.util.logging.Logger
                log.warn("serverSocket select() 期间出错：" + ioe.getMessage());
                   ^
C:\JB\NetBeansProjects\WRServer\src\com\hypefiend\javagamebook\server\GameServer.java:155: 找不到符号
符号：方法错误（java.lang.String，java.lang.Exception）
位置：类 java.util.logging.Logger
                log.error("run() 中的异常", e);
                   ^
C:\JB\NetBeansProjects\WRServer\src\com\hypefiend\javagamebook\server\GameServer.java:187：找不到符号
符号：方法错误（java.lang.String）
位置：类 java.util.logging.Logger
            log.error("没有gameNameHash的游戏控制器：" + gameNameHash);
               ^
C:\JB\NetBeansProjects\WRServer\src\com\hypefiend\javagamebook\server\GameServer.java:203：找不到符号
符号：方法错误（java.lang.String）
位置：类 java.util.logging.Logger
            log.error("获取 GameController 目录时出错");
               ^
C:\JB\NetBeansProjects\WRServer\src\com\hypefiend\javagamebook\server\GameServer.java:223：找不到符号
符号：方法警告（java.lang.String）
位置：类 java.util.logging.Logger
                    log.warn("类文件没有扩展 GameController:" + file);
                       ^
C:\JB\NetBeansProjects\WRServer\src\com\hypefiend\javagamebook\server\GameServer.java:238: 找不到符号
符号：方法错误（java.lang.String，java.lang.Exception）
位置：类 java.util.logging.Logger
                log.error("从文件实例化 GameController 时出错：" + file, e);
                   ^
注意：某些输入文件使用未经检查或不安全的操作。
注意：使用 -Xlint:unchecked 重新编译以获取详细信息。
7 个错误
构建失败（总时间：0 秒）

```

这是直接来自书中的代码。我还没有尝试编辑它。

```
package com.hypefiend.javagamebook.server;

import com.hypefiend.javagamebook.common.*;
import com.hypefiend.javagamebook.server.controller.*;

import java.nio.channels.*;
import java.util.*;
import java.net.*;
import java.io.*;
import java.util.logging.Logger;
import org.apache.log4j.*;

/**
 * GameServer.java
 *
 * The heart of the framework, GameServer accepts
 * incoming client connections and hands them off to 
 * the SelectAndRead class.
 * GameServer also keeps track of the connected players
 * and the GameControllers.
 *
 * @author <a href="mailto:bret@hypefiend.com">bret barker</a>
 * @version 1.0
 */
public class GameServer extends Thread {
/** log4j Logger */
private Logger log = Logger.getLogger("GameServer");

/** ServerSocketChannel for accepting client connections */
private ServerSocketChannel sSockChan;

/** selector for multiplexing ServerSocketChannels */
private Selector selector;

/** GameControllers keyed by GameName */
private Hashtable gameControllers;

/** classname prefix used for dynamically loading GameControllers */
private static final String CONTROLLER_CLASS_PREFIX = 
"com.hypefiend.javagamebook.server.controller.";

/** players keyed by playerId */
private static Hashtable playersByPlayerId;

/** players keyed by sessionId */
private static Hashtable playersBySessionId;

private boolean running;
private SelectAndRead selectAndRead;
private EventWriter eventWriter;

private static long nextSessionId = 0;

/**
 * main. 
 * setup log4j and fireup the GameServer
 */
public static void main(String args[]) {
BasicConfigurator.configure();
GameServer gs = new GameServer();
gs.start();
}

/**
 * constructor, just initialize our hashtables
 */
public GameServer() {
gameControllers = new Hashtable();
playersByPlayerId = new Hashtable();
playersBySessionId = new Hashtable();
}

/**
 * init the GameServer, startup our workers, etc.
 */ 
public void init() {
log.info("GameServer initializing");

loadGameControllers();
initServerSocket();

selectAndRead = new SelectAndRead(this);
selectAndRead.start();

eventWriter = new EventWriter(this, Globals.EVENT_WRITER_WORKERS); 
}

/**
 * GameServer specific initialization, bind to the server port,
 * setup the Selector, etc.
 */
private void initServerSocket() {
try {
    // open a non-blocking server socket channel
    sSockChan = ServerSocketChannel.open();
    sSockChan.configureBlocking(false);

    // bind to localhost on designated port
    InetAddress addr = InetAddress.getLocalHost();
    log.info("binding to address: " + addr.getHostAddress());
    sSockChan.socket().bind(new InetSocketAddress(addr, Globals.PORT));

    // get a selector
    selector = Selector.open();

    // register the channel with the selector to handle accepts
    SelectionKey acceptKey = sSockChan.register(selector, SelectionKey.OP_ACCEPT);
}
catch (Exception e) {
    log.error("error initializing ServerSocket", e);
    System.exit(1);
}
}

/**
 * Here's the meat, loop over the select() call to 
 * accept socket connections and hand them off to SelectAndRead
 */
public void run() {
init();
log.info("******** GameServer running ********");
running = true;
int numReady = 0;

while (running) {
    // note, since we only have one ServerSocket to listen to,
    // we don't need a Selector here, but we set it up for 
    // later additions such as listening on another port 
    // for administrative uses.
    try {
    // blocking select, will return when we get a new connection
    selector.select();

    // fetch the keys
    Set readyKeys = selector.selectedKeys();

    // run through the keys and process
    Iterator i = readyKeys.iterator();
    while (i.hasNext()) {
        SelectionKey key = (SelectionKey) i.next();
        i.remove();

        ServerSocketChannel ssChannel = (ServerSocketChannel) key.channel();
        SocketChannel clientChannel = ssChannel.accept();

        // add to the list in SelectAndRead for processing
        selectAndRead.addNewClient(clientChannel);
        log.info("got connection from: " + clientChannel.socket().getInetAddress());
    }       
    }
    catch (IOException ioe) {
    log.warn("error during serverSocket select(): " + ioe.getMessage());
    }
    catch (Exception e) {
    log.error("exception in run()", e);
    }
}
}

/** 
 * shutdown the GameServer
 */
public void shutdown() {
selector.wakeup();
}

/**
 * Return the next available sessionId
 */
public synchronized String nextSessionId() {
return "" + nextSessionId++;
}

/**
 * finds the GameController for a given GameName
 */
public GameController getGameController(String gameName) {
return getGameControllerByHash(gameName.hashCode());
}

/**
 * finds the GameController for a given GameName hash code
 */
public GameController getGameControllerByHash(int gameNameHash) {
GameController gc = (GameController) gameControllers.get("" + gameNameHash);
if (gc == null) 
    log.error("no gamecontroller for gameNameHash: " + gameNameHash);
return gc;
}

/**
 *  Dynamically loads GameControllers
 */
private void loadGameControllers() {
log.info("loading GameControllers");

// grab all class files in the same directory as GameController
String baseClass = "com/hypefiend/javagamebook/server/controller/GameController.class";
File f = new File( this.getClass( ).getClassLoader().getResource(baseClass).getPath());
File[] files = f.getParentFile().listFiles( );

if (files == null) {
    log.error("error getting GameController directory");
    return;
}

for( int i = 0; ( i < files.length); i++) {
    String file = files[i].getName( );
    if (file.indexOf( ".class") == -1)
    continue;
    if (file.equals("GameController.class"))
    continue;

    try {
    // grab the class
    String controllerClassName = CONTROLLER_CLASS_PREFIX + file.substring(0, file.indexOf(".class"));
    log.info("loading class: " + controllerClassName);

    Class cl = Class.forName(controllerClassName);

    // make sure it extends GameController
    if (!GameController.class.isAssignableFrom(cl)) {
        log.warn("class file does not extend GameController: " + file);
        continue;
    }

    // get an instance and initialize
    GameController gc = (GameController) cl.newInstance();
    String gameName = gc.getGameName();
    gc.init(this, getGameConfig(gameName));

    // add to our controllers hash
    gameControllers.put("" + gameName.hashCode(), gc);

    log.info("loaded controller for gameName: " + gameName + ", hash: " + gameName.hashCode());
    } 
    catch (Exception e) {
    log.error("Error instantiating GameController from file: " + file, e);
    }
}
}

/**
 * pass the event on to the EventWriter
 */
public void writeEvent(GameEvent e) {
eventWriter.handleEvent(e);
}

/**
 * returns the GameConfig object for the given gameName
 */
public GameConfig getGameConfig(String gameName) {
// todo: implement getGameConfig()
return null;
}

/**
 * fetches the Player for a given playerId
 */
public static Player getPlayerById( String id) {
return (Player) playersByPlayerId.get(id);
}

/**
 * fetches the Player for a given sessionId
 */
public static Player getPlayerBySessionId(String id) {
return (Player) playersBySessionId.get(id);
}

/** 
 * add a player to our lists
 */
public static void addPlayer(Player p) {
playersByPlayerId.put(p.getPlayerId(), p);
playersBySessionId.put(p.getSessionId(), p);
}

/**
 * remove a player from our lists
 */
public static void removePlayer(Player p) {
playersByPlayerId.remove(p.getPlayerId());
playersBySessionId.remove(p.getPlayerId());
}

}// GameServer 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-24T16:30:43.997

[`java.util.logging.Logger`](http://java.sun.com/javase/6/docs/api/java/util/logging/Logger.html)没有`warn()`方法（尽管它确实有`warning()`方法）。

但是，[`org.apache.log4j.Logger`](http://logging.apache.org/log4j/1.2/apidocs/org/apache/log4j/Logger.html)确实有一个名为`warn()`.

您确定要导入正确的类吗？

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-24T16:49:53.340

在您的类中导入 java.util.logging.Logger 似乎会导致问题（编译器尝试针对该类进行编译，尽管其意图似乎是使用 log4j Logger 类）。

尝试从导入中删除 java.util.logging.Logger 并重新编译。

编辑：好吧，我刚刚从问题中链接的页面中链接的 ZIP 文件中检查了原始的 GameServer.java。它不包含任何 java.util.logging.Logger 的导入。我的猜测是：

*   您的项目的类路径中没有 log4j
*   您或您的 IDE 尝试以某种方式自动组织导入。这最终将 java.util.logging.Logger 添加到导入中，因为在项目的类路径中没有找到该名称的其他类。

因此，首先将 log4j 添加到类路径，然后从导入中删除 java.util.logging.Logger。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-24T16:32:48.640

你能格式化你的代码吗？Ti 会更具可读性...

您正在尝试在 java.util.logger.Logger 的实例上调用 error(String, String) 方法。没有这样的方法。您应该改用 Logger.log(Level.SEVERE, "mesage")，或者使用 log4J Logger 的实例。检查源文件的导入部分...

# ruby-on-rails - Rails：find_by_sql 和虚拟列

> ID：582431
> 
> 赞同：13
> 
> 时间：2009-02-24T16:23:20.643
> 
> 标签：ruby-on-rails

我想显示一个带有标签的列表以及每个标签的元素数量（在我的示例中为“任务”）。

为此，我在我的 Tag 模型中创建了以下方法：

```
def self.find_with_count
  find_by_sql 'SELECT
                 Tag.name,
                 COUNT(Tag.name) AS taskcount
               FROM
                 tags AS Tag
                 INNER JOIN tags_tasks tt ON tt.tag_id = Tag.id
                 INNER JOIN tasks t ON tt.task_id = t.id
               WHERE
                 t.finished = 0
                 AND t.deleted = 0
               GROUP BY
                 Tag.name
               ORDER BY
                 Tag.name'
end 
```

该方法返回正确的标签名称，但由于某种原因任务计数不在结果中。结果看起来像

```
[#<Tag name: "hello">, #<Tag name: "world">] 
```

由于这种方法似乎不起作用，我想知道 Rails 的方式是什么来完成这样的任务。谢谢！

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-02-24T21:08:56.790

计数就在那里，你只是看不到它，因为 taskcount 不是 Rails 为该类 Task 创建的属性，因为它不是它可以看到的列。您必须使用属性调用来找到它。样本：

```
class Tag < ActiveRecord::Base
  ...
  def taskcount
    attributes['taskcount']
  end
end

Tag.find_with_count.each do |t|
  puts "#{t.name}: #{t.taskcount}"
end 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-02-24T16:36:24.060

“Rails 方式”是使用`counter_cache`：

```
class Tag < ActiveRecord::Base
  has_many :tag_tasks
  has_many :tasks, :through => :tag_tasks
end

# the join model
class TagTask < ActiveRecord::Base
  belongs_to :tag, :counter_cache => true
  belongs_to :task
end

class Task < ActiveRecord::Base
  has_many :tag_tasks
  has_many :tags, :through => :tag_tasks
end 
```

这需要`tag_tasks_count`在“标签”表上添加一列。

如果您`named_scope`像这样添加到标签：

```
class Tag ...
  named_scope :active, lambda { { :conditions => { 'deleted' => 0, 'finished' => 0 } } }
end 
```

然后你可以`Tag.find_by_count`用`Tag.active`. 像这样使用它：

```
Tag.active.each do |t|
  puts "#{t.name} (#{t.tag_tasks_count})"
end 
```

# html - 如何挂钩 DOM 加载事件？

> ID：582437
> 
> 赞同：8
> 
> 时间：2009-02-24T16:24:41.983
> 
> 标签：html, dom, load

有人可以指出我挂钩 DOM 加载事件的方向吗？

基本上，我想在 dom 加载时显示一个加载器（我不是指 Ajax 请求 - 用户第一次点击页面）？

提前谢谢大家

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2012-05-09T15:47:03.450

如果您不使用框架，请使用 DOMContentLoaded 事件：

```
document.addEventListener('DOMContentLoaded', function() {
  // ...
}) 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-02-24T16:27:56.763

所有流行的 Javascript 库都有一个“DOM 加载”事件，您可以使用它。

本质上：

```
<html>
<head>
    <script>
    // if using jQuery
    $(document).ready(function() { $('#loading').hide(); });
    // if using Prototype
    document.observe("dom:loaded", function() { $('loading').hide(); });
    </script>
</head>
<body>
    <div id="loading">Loading...</div>
    <!-- rest of page -->
</body>
</html> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-24T16:53:28.917

只是为了提供 jQuery 的替代方案，YUI Event也为此目的提供了一个[onDomReady()函数。](http://developer.yahoo.com/yui/event/#ondomready "onDomReady()")这是他们网站上的示例：

```
 <script type="text/javascript">

 function init() {
    YAHOO.util.Dom.setStyle("hidden_element", "visibility", "");
 }
 YAHOO.util.Event.onDOMReady(init);

 </script> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-06-18T12:44:42.640

在没有库的情况下执行此操作的正确方法（实际上，即使使用库，因为您正在处理脚本阻塞和 IE 不可预测性）是将脚本放在页面的最后：

onLoaded = 函数（）{ ... }

onLoaded()

# c# - 使用 C# 和正则表达式解析源代码并查找带参数的函数调用

> ID：582439
> 
> 赞同：2
> 
> 时间：2009-02-24T16:25:13.527
> 
> 标签：c#, regex, parsing

我有一个存储在数据库中的函数调用列表，对于某些函数调用，我关心函数调用的参数是什么。我正在用我的程序（在 C# 中）解析 C 源代码。我正在尝试找到使用参数获取函数调用的最佳方法。我在解析之前将源代码读入了一个字符串（这样我就没有在文件上使用流阅读器）。我尝试使用一些正则表达式（这对我来说有点新）来解析源文件，但是在使用像这样的正则表达式字符串时检索的不仅仅是函数调用：functionCall + ".*\\)"; （我正在逃避开口（在函数调用中）

函数调用以下列格式存储在 DB 中

```
Function Call
============
some_Call( 
```

它们以这种方式存储是有原因的，并且不会改变。

有没有通过正则表达式做到这一点的好方法，还是我更适合浏览源代码内容？

让我知道是否需要任何澄清。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-24T16:37:38.673

您的解决方案失败的部分原因是您可能应该使用`.*?)`，而不是贪婪匹配。

一个完整的答案必须至少遵循以下几点：

忽略字符串和字符中的括号（你可以用正则表达式来做，虽然转义可能有点复杂）

```
functionCall("\")", ')') 
```

忽略注释中的括号（您可以使用正则表达式）

```
functionCall(/*)*/ 1, // )
2) 
```

不要匹配太多（您可以使用正则表达式）

```
functionCall(1) + functionCall(2) + (2 * 3) // Don't match past the first ) 
```

但它也必须忽略平衡括号

```
functionCall((1+(1))*(2+2)) 
```

最后一个是普通正则表达式无法做到的，因为它涉及计算括号，并且通常是正则表达式不适合的东西。但是，[.NET 似乎有办法做到这一点](http://blogs.msdn.com/bclteam/archive/2005/03/15/396452.aspx)。

（从技术上讲，您必须处理宏，我可以想象

```
#define close_paren ) 
```

会毁了你的一天...）

也就是说，您可能会想出一个幼稚的解决方案（类似于您所拥有的或其他一些海报推荐的解决方案），并且它适用于许多情况，尤其是在您使用已知输入的情况下。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-24T16:36:00.223

我已经编写了一个快速的正则表达式并对其进行了测试，请检查以下内容：

```
 string tst = "some_function(type<whatever> tesxt_112,type<whatever> tesxt_113){";

        Regex r = new Regex(".*\\((.*)\\)");
        Match m = r.Match(tst);
        if (m.Success)
        {
            string[] arguments = m.Groups[1].Value.Split(',');
            for (int i = 0; i < arguments.Length; i++)
            {
                Console.WriteLine("Argument " + (i + 1) + " = " + arguments[i]);
            }
        }

        Console.ReadKey(); 
```

所以上述字符串的输出将是：

参数 1 = type<whatever> tesxt_112

参数 2 = type<whatever> tesxt_113

希望这可以帮助：

安德鲁 ：-）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-24T16:37:17.053

不是为了恶化你，而是......在C语言中，我（模糊地）相信你可以做到这一点：

```
void secondFunction() { /* no-op */ }

void firstFunction()
{
    void* xyz = secondFunction;

    xyz(); // this should call secondFunction
} 
```

这是可能的情况吗？那么指针用法的其他变体呢？！？

说，类型转换功能风格？！？

```
int a;
float b = float(a); // call to the "float" function?!? NO! it's a type casting 
```

使用预定义类型列表？如果转换为自定义结构怎么办？ typedef 怎么办？现在你也必须解析这些！

说真的，使用解析器！已经有[几个可用的选项](http://www.google.co.th/search?&q=C+parser)可以解析 C。

我认为正则表达式对于这项工作来说是一个相当糟糕的工具。

# .net - Castle Windsor：抑制 Resolve() 抛出的异常

> ID：582440
> 
> 赞同：11
> 
> 时间：2009-02-24T16:25:19.720
> 
> 标签：.net, castle-windsor

解析 Windsor 容器找不到的组件时，会引发异常。

StructureMap 有一个 TryGetInstance 方法，它返回 null ，它找不到请求的组件。

温莎城堡有这样的东西吗？或者我是否被迫捕获这些异常（我不喜欢这样，因为抛出和捕获异常的性能开销）。

提前致谢，

雷姆科

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-02-24T16:36:19.613

您可以在调用 Windsor 容器的 Resolve 方法之前检查 MicroKernel 是否已注册组件的实例。

像下面这样的东西应该可以工作。

```
if ( windsor.Kernel.HasComponent( componentType ) )
{
    return windsor.Resolve( componentType );
}

return null; 
```

# cookies - 跨不同域的 SSO

> ID：582444
> 
> 赞同：2
> 
> 时间：2009-02-24T16:26:17.703
> 
> 标签：cookies, asp.net-membership, membership, single-sign-on, sqlmembershipprovider

如何实现跨域的单点登录？我有两个或多个域，我希望所有域都使用 SqlMembershipProvider（ASP.NET 2.0 成员数据库）通过一台服务器进行身份验证我有域 foo.com 托管 asp.net 成员数据库和另一个域 bar.com通过 foo.com 进行身份验证。我在互联网上找到了很多针对不同应用程序但在同一个域但不同域中的文章我没有找到完整的文章描述循环，我看到一些使用 FormsAuthenticationTicket 类或 FormsAuthentication 类。我知道 web.config 中的 machineKey 应该是一样的。我认为让 foo.com 一旦通过身份验证就可以很容易地复制身份验证 cookie 并将 cookie 的域从 foo.com 更改为 bar.com 但我发现我可以' t 控制其他域 cookie！那么有没有办法让它工作呢？

谢谢你和问候，艾哈迈德

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-24T20:58:54.430

这不是一个简单的问题，但我可以给你一些提示。

为了使用允许匿名访问或要求用户登录的 ASP.NET web.config 设置，您需要创建一个挂钩 HttpApplication.EndRequest 的模块，并检查 HTTP 错误 401（这意味着需要身份验证）。
重置错误代码并重定向到您的单点登录站点。在这里您可以照常登录。

现在开始最困难的部分：您需要以安全的方式通过线路将用户凭据传输到另一台服务器。您可以使用对称加密和共享密钥，或通过非对称加密交换密钥来实现此目的。

另一端的 HttpModule 现在从登录站点获取重定向，检查登录票是否有效，并替换 HttpContext.User（一定要封装现有用户，如果有的话，那么您可以路由 IsInRole打电话给那个 IPrincipal）。

# ruby-on-rails - Rails：通过 has_one 关系排序

> ID：582445
> 
> 赞同：1
> 
> 时间：2009-02-24T16:26:50.980
> 
> 标签：ruby-on-rails

我正在为表中的可排序列构建一种机制。每个表都代表一个数据列表，因此我将数据库表称为“列表”。除了列位置的排序之外，一切都有效。我想显示按字段“位置”排序的列位置，但即使删除 :order 语句也没有任何变化。

*   list.rb :has_many :columns
*   column.rb :has_one :columnposition, :order => "position ASC"
*   columnposition.rb <- 位置以简单整数的形式存储在这里。

我可以毫无问题地访问 list.column.columnposition.position ，因此关系本身似乎有效。

为什么列位置不按“位置 ASC”排序？

// 编辑：我使用 @lists = List.find 获取列表：all

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-24T22:54:03.183

该`:order => "position ASC"`选项在您的关系定义级别没有帮助，因为它是`lists`您想要按列位置排序的，而不是位置本身。

从模型中删除`:order => "position ASC"`，然后尝试：

```
@lists = List.find(:all, :joins => { :columns => :column_positions }, \
  :order => 'column_positions.position ASC') 
```

反而。查看在`development`模式下运行时生成的 SQL。

干杯，V。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-24T16:37:21.483

我假设您要订购的表达式是

```
list.column 
```

您希望该结果按位置排序吗？好吧，在这种情况下，查询并没有“查看”列位置关联，因此它不尊重它的任何 :order 子句。

我不知道为什么你需要让 columnposition 成为它自己的关联，特别是因为你有它作为一个：has_one，所以只有 1 个匹配的行。

我只是将该列位置数据作为列放在 Column 模型中，然后您可以在单个查询中按照您想要的方式对其进行排序。

# macos - 使用 MacPorts 在 Mac OS X 10.5 上安装 PostgreSQL 时出错

> ID：582447
> 
> 赞同：1
> 
> 时间：2009-02-24T16:27:20.087
> 
> 标签：macos, postgresql, macports

我已经在几台不同的计算机上使用 MacPorts 安装了 PostgreSQL，没问题，但是当涉及到我自己的笔记本电脑时，我无法构建它。

当我执行此命令时：

```
sudo port install postgresql83 
```

我收到此错误：

```
checking test program... failed
configure: error:
Could not execute a simple test program.  This may be a problem
related to locating shared libraries.  Check the file 'config.log'
for the exact reason.

Error: The following dependencies failed to build: postgresql83
Error: Status 1 encountered during processing. 
```

config.log 文件有 7000 行长，我看不到明显的问题（不过，它在最后一行显示“exit 1”！）。

我确实有开发者工具和没有安装的东西，我已经更新到最新版本的 MacPorts 并同步了我的端口树。我可以通过 MacPorts 安装其他东西。

我在 Google 上搜索了有关这意味着什么的详细信息，但徒劳无功。有什么建议么？谢谢！

更新：我*认为*这是导致它失败的原因（来自 config.log）：

```
configure:8307: ./conftest
dyld: Library not loaded: /opt/local/lib/libxml2.2
  Referenced from: /opt/local/lib/libxslt.1.dylib
  Reason: image not found 
```

我安装了 libxml2，但可能搞砸了。我卸载了 libxml2 和 libxslt 并重新安装它们，所以我们将看看会发生什么。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-24T16:55:15.497

这是关键：

```
configure:8307: ./conftest
dyld: Library not loaded: /opt/local/lib/libxml2.2
  Referenced from: /opt/local/lib/libxslt.1.dylib
  Reason: image not found 
```

这不在 config.log 的底部附近，大约在第 700 行。

尽管我已经将 libxml 升级到了适当的版本（这是我之前在安装 postgresql 时必须解决的一个问题），但它不能与 libxslt 一起使用。

我卸载了 libxml（我已经安装了两个版本）和 libxslt，然后再次安装了 postgresql，这一次它能够构建。

如果你在构建 postgresql 时遇到这样的错误，请查看库。

顺便说一句，config.log 文件可以在这样的位置找到：

```
/opt/local/var/macports/build/_opt_local_var_macports_sources_rsync.macports.org_release_ports_databases_postgresql83/work/postgresql-8.3.6/config.log 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-24T21:21:06.560

postgresql83 在 MacPorts 中的版本为 8.3.6。与您的副本正在使用的版本相同吗？“port info postgresql83” 如果它们不同，请执行“sudo port selfupdate && sudo port upgrade -u outdated && sudo port clean postgresql83”以更新所有内容，然后重试。

据我所知，postgresql83 应该依赖于 libxml2，而不是 libxml。这应该已经由 MacPorts 处理了。您可能希望以任何一种方式执行上述命令（确保更新依赖项并清理目录以重试）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-02T05:31:04.467

我意识到这是一个不能解决问题的答案，但是作为一个不喜欢 mac 端口的 mac 用户，我找到了另一种安装 postgres 的解决方案。不久前，postgres 网站[下载部分](http://www.postgresql.org/download/macosx)开始宣传[EnterpriseDB 的一键安装程序](http://www.enterprisedb.com/products/pgdownload.do#osx)。

我过去曾尝试通过mac端口安装它，最终决定从源头手动安装它，这很痛苦。这个安装程序很不错。它将可执行文件放在适合 mac 的位置，将其库放在 /Library 中，甚至包括一些额外的程序来帮助使用 postgres。试一试，当有高质量的安装程序可用时，无需安装易碎的 mac 端口。

# python - py2exe + sqlalchemy + sqlite 问题

> ID：582449
> 
> 赞同：19
> 
> 时间：2009-02-24T16:28:11.223
> 
> 标签：python, sqlite, sqlalchemy, py2exe

在我进入全速开发模式之前，我正在尝试让一些基本的东西在 Python 中工作。以下是具体情况：

```
Python 2.5.4
PyQt4 4.4.3
SqlAlchemy 0.5.2
py2exe 0.6.9
setuptools 0.6c9
pysqlite 2.5.1 
```

设置.py：

```
from distutils.core import setup
import py2exe

setup(windows=[{"script" : "main.py"}], options={"py2exe" : {"includes" : ["sip", "PyQt4.QtSql","sqlite3"],"packages":["sqlite3",]}}) 
```

py2exe 似乎可以正确生成 .exe 文件，但是当我执行 dist/main.exe 时，我在 main.exe.log 中得到了这个

```
Traceback (most recent call last):
  File "main.py", line 18, in <module>
  File "main.py", line 14, in main
  File "db\manager.pyc", line 12, in __init__
  File "sqlalchemy\engine\__init__.pyc", line 223, in create_engine
  File "sqlalchemy\engine\strategies.pyc", line 48, in create
  File "sqlalchemy\engine\url.pyc", line 91, in get_dialect
ImportError: No module named sqlite 
```

我一直在谷歌搜索，但似乎找不到任何解决方案。如果我现在不能让它工作，我希望在这个项目中使用 Python 的希望将破灭，我将重新开始使用 Ruby...（并不是说 Ruby 有什么问题，我只是想使用这个项目作为自学 Python 的好方法）

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2009-02-24T16:49:55.837

你需要包括 sqlalchemy.databases.sqlite 包

```
setup(
  windows=[{"script" : "main.py"}],
  options={"py2exe" : {
    "includes": ["sip", "PyQt4.QtSql"],
    "packages": ["sqlalchemy.databases.sqlite"]
}}) 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2011-02-24T10:43:19.180

您需要更改为 sqlalchemy.dialects.sqlite 包

设置（windows=[{"script" : "main.py"}], options={"py2exe" : { "includes": ["sip", "PyQt4.QtSql"], "packages": ["sqlalchemy. dialects.sqlite"] }})

# windows-installer - Inno Setup 中的 msi 返回码

> ID：582452
> 
> 赞同：8
> 
> 时间：2009-02-24T16:29:42.873
> 
> 标签：windows-installer, inno-setup

我想在静默模式下调用多个 .msi 文件，如果有任何失败，则停止整个安装。

是否可以从 [run] 部分调用 msiexec.exe 的返回码？

目前我只能在 windows 事件查看器中看到错误消息。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-24T17:03:05.867

目前无法检查*[Run]*条目是否成功执行。该代码仅记录进程退出代码并继续下一个条目（可以在 Inno Setup 源文件*Main.pas*中检查，函数是*ProcessRunEntry()*，从当前版本 5.2.3 中的第 3404 行开始）。

如果您需要确保 msiexec 的多次执行都成功，您将需要编写一个中间层。这可以像在 [Run] 条目中执行的小存根一样简单，并使用正确的参数启动 msiexec.exe，等待进程完成，然后将返回代码写入文件。

检查此类安装步骤是否成功的另一种方法是使用*AfterInstall*参数为每​​个*[Run]条目添加自定义过程调用。*例如，在这样的功能中，您可以检查 OCX 控件是否已成功安装：

 *```
[Run]
Filename: "{tmp}\MyInstallation1.exe"; Parameters: "/foo"; AfterInstall: AfterMyInstallation1

[Code]
var
  MyInstallation1Success: boolean;

procedure AfterMyInstallation1;
var
  V: Variant;
begin
  try
    V := CreateOleObject('MyInstallation.InstalledOcxControl.1');
    MyInstallation1Success := True;
  except
    MyInstallation1Success := False;
  end;
end; 
```

或者依赖项的目录和注册表项是否都在那里。

每个*[Run]*条目仅在其可选的*Check*参数返回 true 时才会执行。因此，根据您的需要，您可以一个接一个地启动所有静默安装，并在最后一个完成后执行脚本函数以检查所有依赖项是否已成功安装；或者您可以为每个依赖项安装编写一个检查函数，然后返回 false 并因此在第一次失败后跳过所有其他安装。

但是请注意，所有*[运行]*条目都是在文件复制、注册表写入等步骤完成后执行的，因此您基本上已经完成了安装。如果您只想在正确安装所有依赖项时才真正执行所有安装步骤，那么您必须在该过程的早期执行此操作，此时仍然可以取消安装。

**编辑：**查看问题[“如何使 Inno Setup 在执行长执行时看起来不冻结？”](https://stackoverflow.com/questions/591899/how-do-you-make-inno-setup-not-look-frozen-while-performing-a-long-exec) 其中给出了一些信息，并链接了一个示例脚本，以使用*Exec()*函数安装依赖项。因此，如果您不使用*[Run]*条目，则很有可能实现您想要的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-06-20T08:42:17.003

您可以使用[我](https://stackoverflow.com/a/24323119/2164198)对类似问题的回答在 [Run] 部分安全地运行命令，并提供适当的通知和错误回滚。

上面的链接提供了完整的解决方案，但想法如下：

1) 使用 InnoSetup 的 BeforeInstall 参数将错误消息写入临时文件 {tmp}\install.error。

2) 使用 Windows 命令外壳“cmd.exe /s /c”运行所需程序。还可以使用带有“&&”的“del”命令的条件执行 - [http://www.microsoft.com/resources/documentation/windows/xp/all/proddocs/en-us/ntcmds_shelloverview.mspx?mfr=true](http://www.microsoft.com/resources/documentation/windows/xp/all/proddocs/en-us/ntcmds_shelloverview.mspx?mfr=true)。因此，如果命令成功（退出代码 0），错误消息文件将被删除。请注意“cmd.exe /s /c”中的特殊引号处理。

3) 使用 InnoSetup 的 AfterInstall 参数检查错误消息文件 {tmp}\install.error 的存在，并通过适当的通知或确认（以及可选的日志文件显示）中止安装并使用 Exec(ExpandConstant('{uninstallexe}') 执行回滚， ...

4) 应该做一些额外的步骤，比如覆盖 InnoSetup 的 ShouldSkipPage(PageID: Integer) 函数以隐藏最终页面等。

# jquery - ASP.NET MVC jQuery 从 1.2.6 迁移到 1.3.2

> ID：582460
> 
> 赞同：1
> 
> 时间：2009-02-24T16:31:06.740
> 
> 标签：jquery, asp.net-mvc, intellisense

我的项目中 jQuery 从 1.2.6 迁移到 1.3.2 时遇到问题。VS 中 jQuery 的智能感知不起作用。

为了测试这个问题，我创建了新项目，将 jQuery 添加到母版页，构建了解决方案并检查了智能感知 - 工作正常。

在此之后，我在解决方案中删除了这些文件：

*   jquery-1.2.6.js
*   jquery-1.2.6.min.js
*   jquery-1.2.6.min-vsdoc.js
*   jquery-1.2.6-vsdoc.js

并添加了这个：

*   jquery-1.3.2.js
*   jquery-1.3.2.min.js
*   jquery-1.3.2.min-vsdoc.js
*   jquery-1.3.2-vsdoc.js

我已经更正了母版页中的 jQuery 链接并构建了解决方案 - jQuery 的智能感知不起作用。

我错过了什么？

我使用 VS2008 SP1，MVC RC1。

**更新：** 现在一切正常。我不确定解决方案，但我认为当我在 VS 中打开所有 js 文件时，智能感知已经修复。

**解决方案** 原因是 jquery 和 jquery.ui 之间的冲突我为 jquery.ui 创建了空的 vsdoc 文件，问题就解决了。我在这里找到了这个解决方案：http: [//arahuman.blogspot.com/2009/02/error-updating-jscript-intellisense.html](http://arahuman.blogspot.com/2009/02/error-updating-jscript-intellisense.html)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-24T17:38:43.880

实际上，您必须安装一个新的智能感知文件。看看[这个](http://blogs.ipona.com/james/archive/2009/01/14/jquery-1.3-and-visual-studio-2008-intellisense.aspx)。

# php - WAMP - PHP shell_exec() 问题

> ID：582462
> 
> 赞同：0
> 
> 时间：2009-02-24T16:31:58.657
> 
> 标签：php, svn, command-line, permissions, wamp

我使用 WAMP 作为服务器，我需要执行 svn，可以在我的 Windows 目录中找到：C:/Program Files/Subversion/bin/

问题是，当我从服务器启动 php 程序时，它不会产生输出。它可以从命令行运行，这让我认为这是 WAMP 的权限问题。然而，在赋予它无限的权力之后，它仍然不会执行 svn 命令，除非我从命令行调用它。

我试过用 svn 的完整路径来调用它，它是常规路径。诸如“dir”之类的其他命令可以正常工作。

澄清我的问题：如何通过 WAMP 从 php 执行 svn？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-24T16:34:12.880

PHP 有[一大堆](http://php.net/svn)函数可以显式处理 svn 存储库，并且不需要您使用任何 system() 类型的函数。

既然您说您不能使用各种 svn 功能，请尝试以下操作：

```
<?php
    $cmd = 'set PATH';
    echo '<pre>' , shell_exec( $cmd ) , '</pre>';
?> 
```

查看返回的内容（查找 PATH 环境变量）。查看 PATH 包含的内容。

您可能必须将 Subversion 文件夹添加到 PATH：

```
<?php
    $cmd = 'set PATH=%PATH%;"C:\Program Files\Subversion\bin\"; svn up';
    shell_exec( $cmd );
?> 
```

希望设置 PATH 可以解决您的问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-09-30T04:03:03.240

我也发现了这个问题并且可以解决这个问题，请确保您使用用户名和密码（如果需要）

例如。svn update *"\my\project\"* --username *[myusername]* --password *[mypassword]*

如果没有，没有输出，svn 还在等你输入。

PS当我登录并在cmd上运行svn时，它不要求用户名和密码，但是当我在PHP上运行时你需要它。希望它能解决您的问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-24T18:26:04.967

改用免费的 svn 类，它们不需要 svn 模块： [http :](http://www.phpclasses.org/browse/package/3427.ht) [//www.phpclasses.org/browse/package/3427.ht http://code.google.com/p/phpsvnclient/](http://code.google.com/p/phpsvnclient/)

# c# - Alternate UniqueId generation technique

> ID：582473
> 
> 赞同：2
> 
> 时间：2009-02-24T16:34:46.497
> 
> 标签：c#, .net, algorithm

In the application, when special types of objects are created, I need to generate a unique-id for each of them. The objects are created thro' a factory and have a high possibility of being created in a 'bulk' operation. I realize that the "Random" from the framework is not so 'random' after all, so I tried appending the time-stamp as follows:

```
private string GenerateUniqueId()
{
    Random randomValue = new Random();
    return DateTime.Now.Ticks.ToString() + randomValue.Next().ToString();
} 
```

Unfortunately, even this does not work. For objects that are created in rapid succession, I generate the same Unique Id :-(

Currently, I am implementing it in a crude way as follows:

```
private string GenerateUniqueId()
{
    Random randomValue = new Random();
    int value = randomValue.Next();
    Debug.WriteLine(value.ToString());
    Thread.Sleep(100);
    return DateTime.Now.Ticks.ToString() + value.ToString();
} 
```

Since this is not a very large application, I think a simple and quick technique would suffice instead of implementing an elaborate algorithm.

Please suggest.

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-02-24T16:38:06.613

A [GUID](http://msdn.microsoft.com/en-us/library/system.guid.aspx) is probably what you're looking for:

```
private string GenerateUniqueId()
{
    return Guid.NewGuid().ToString("N");
} 
```

If you want a smaller, more manageable ID then you could use something like this:

```
private string GenerateUniqueId()
{
    using (var rng = new RNGCryptoServiceProvider())
    {
        // change the size of the array depending on your requirements
        var rndBytes = new byte[8];
        rng.GetBytes(rndBytes);
        return BitConverter.ToString(rndBytes).Replace("-", "");
    }
} 
```

Note: This will only give you a 64-bit number in comparison to the GUID's 128 bits, so there'll be more chance of a collision. Probably not an issue in the real world though. If it is an issue then you could increase the size of the `byte` array to generate a larger id.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-24T17:55:14.200

Assuming you do not want a GUID, First option would be a static field, and interlocked:

```
private static long lastId = 0
private static long GetNextId() {
  return Interlocked.Increment(ref lastId);
} 
```

If you want something based on time ticks, remember the last value and if the same manually increment and save; otherwise just save:

```
private static long lastTick = 0;
private static object idGenLock = new Object();
private static long GetNextId() {
  lock (idGenLock) {
    long tick = DateTime.UtcNow.Ticks;
    if (lastTick == tick) {
      tick = lastTick+1;
    }
    lastTick = tick;
    return tick;
  }
} 
```

(Neither of these approaches will be good with multiple processes.)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-24T18:04:13.927

In your comments Codex you say use the unique ID as a file name. There is a specific function for generating cryptographically secure file names, Path.GetRandomFileName()

As it's cryptographically secure these would be unique even in batch operations. The format is a little horrible though as they're optimised for filenames, but it may work for other references as well.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-24T18:22:51.167

Why can't your factory (which is presumably single-threaded) generate sequential unique integers? If you expected Random() to work, why not Guid() (or whatever is equivalent)?

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-24T19:49:58.090

If you're going to resort to coding your own UUID-generator, make sure you salt the generator.

I suggest you check out the [open source package ossp-uuid](http://www.ossp.org/pkg/lib/uuid/), which is an ISO-C API and CLI for generating Universally Unique Identifiers.

# winforms - 在 WinForms 中设置下拉方向

> ID：582491
> 
> 赞同：1
> 
> 时间：2009-02-24T16:39:57.093
> 
> 标签：winforms, user-interface, menu

默认情况下，winforms 下拉菜单总是从下拉按钮/菜单项向右延伸。但是，我有一个工具箱按钮（类似于 chrome 的选项按钮），它位于窗口的最右侧；单击时，默认菜单将始终延伸到窗口之外。

是否有任何内置方法可以使菜单从下拉按钮向左下拉，还是我必须手动设置菜单的位置并手动显示/隐藏？

编辑：有两种情况，这种行为不是最佳的：

*   如果它不是全屏的，或者靠近右端，它将从应用程序的窗口中挂出；和

*   在多显示器环境中，它会下降到下一个显示器上

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-01-06T05:46:16.970

看看这个：

[http://msdn.microsoft.com/en-us/library/system.windows.forms.toolstripdropdowndirection.aspx](http://msdn.microsoft.com/en-us/library/system.windows.forms.toolstripdropdowndirection.aspx)

假设您使用的是 .NET 和 ToolStripMenuItems，您可以将一个 DropdownDirection 属性设置为这些枚举之一。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-24T16:44:59.203

IIRC，它实际上检查*屏幕*（而不是窗口）的大小，并将其放到左边以避免离开屏幕。这样就够了吗？

# .net - 在 2.0sp1/AJAX Extesnion 1.0 服务器上使用 VS2008/3.5 ASP AJAX 站点？

> ID：582492
> 
> 赞同：1
> 
> 时间：2009-02-24T16:40:23.583
> 
> 标签：.net, asp.net, asp.net-ajax, scriptmanager

我目前正在开发 3.5（在使用 LINQ 时构建到 3.5）并将我的代码部署到 2.0 服务器。到目前为止，我在这方面取得了成功，但现在我正在尝试利用一些 ASP AJAX 工具，但我遇到了一个似乎无法解决的错误。

首先我收到

“未知的服务器标签‘asp:ScriptManager’。”

我将此添加到我的 web.config 控件部分：

"添加 tagPrefix="asp" 命名空间="System.Web.UI" 程序集="System.Web.Extensions, 版本=1.0.61025.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35"

这产生了以下错误，我不确定如何纠正：

"The base class includes the field 'ScriptManager1', but its type (System.Web.UI.ScriptManager) is not compatible with the type of control (System.Web.UI.ScriptManager)."

Any thoughts or ideas on this one?

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-24T17:07:36.217

Your project, when it was built was referencing the version of System.Web.Extensions for .NET 3.5, which when it is trying to work now it has issues.

You will need to ensure that all references are pointing to the 1.0.61025.0 version, and that NO references to the .NET 3.5 ones are included.

# c# - Linux 上的 C# - 有人根据使用单声道的经验发表意见吗？

> ID：582493
> 
> 赞同：10
> 
> 时间：2009-02-24T16:40:50.353
> 
> 标签：c#, java

如果您是 Linux 用户，是否值得学习 C#？有 Mono，但如果他们开始赔钱，它似乎注定总是落后于 MS 行动的持续威胁。

目前我更倾向于 Java，因为它是完全 GPL 的，并且没有软件专利的重大威胁。它背后已经有一个庞大的 oss 社区，并且在服务器上享有盛誉，而 C# 仍然需要在那里证明自己。

C# 程序员的一大优势是他们比 Java 开发人员更便宜。我也想知道 C# 代码的可移植性到底如何。是否可以简单地采用针对 Mono 编写的 C# 应用程序并在 Windows 上运行它？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-02-24T16:46:49.993

我编写了许多 C# 命令行程序，专门用于作为分布式仿真引擎运行，它们是针对 Ubuntu 的。它们在那里或在 Windows 上完美运行。

很难说未来会怎样，但 C# 是一门强大的语言，我认为它值得学习，即使只是为了我们的个人成长。我自己鄙视 Windows，但一直在编写 C# 一段时间（主要是为 Windows），因为它支付了账单。

Novell 将 Mono 广泛用于他们的 Linux 应用程序，我认为他们与 Microsoft 的关系增加了 .NET for Linux 将继续存在的想法。

[以下是](http://www.mono-project.com/Companies_Using_Mono)一些使用 Mono 的公司的列表。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-24T16:53:58.323

> “在服务器上，而 C# 仍然需要在那里证明自己”

您知道 MySpace 是建立在 ASP.NET 之上的，对吧？每天有数百万次点击 C# 后端。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-25T16:09:32.790

对不起，火焰诱饵，但我个人在单声道方面取得了比java更多的可移植性成功。不是一概而论，只是我的经验。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-24T17:08:19.303

这个问题已经在 SO 上被问过并回答了很多次。

[Mono 准备好迎接黄金时段了吗？](https://stackoverflow.com/questions/18450/is-mono-ready-for-prime-time)

[为什么使用单声道？](https://stackoverflow.com/questions/573982/why-use-mono)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-24T16:46:06.267

鉴于您的情况，**我个人**会学习 Java，因为您会发现进一步过渡到 C# 非常顺利。拥有 Java 也是一件非常好的事情。我会说 Java 比 C# 更便携，尽管您可以选择使用 Compact Framework，它可以更快地引导您的程序。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-24T16:59:27.610

我在一家同时使用 Java 和 C# 的公司工作。我更喜欢 C#，因为我认为 Visual Studio 击败了 Eclipse，而且我更喜欢这种语言。但是，我认为在您的情况下，您可能会更好地学习 Java。您的项目和职业生涯都具有更大的灵活性。您可以随时学习 C#。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-24T17:07:41.550

C# 是一门很好的语言，我发现它比 C/C++ 更容易使用，特别是对于 GTK 应用程序。

我还认为学习 C# 会比学习 Java 更好的投资。我这么说只是出于我个人的喜好，但我也诚实客观地相信 C# 将拥有比 Java 更好的未来。

至于在 Windows 上运行 Mono 应用程序，您通常可以毫不费力地做到这一点，但如果它是一个 GUI 应用程序，您要么必须创建使用 Winforms 的 Windows 版本，要么您的用户必须安装 GTK for Windows。无论哪种方式，您的应用程序在两个平台上都将比 Java 应用程序具有更好的外观和感觉。

最后，我认为 M$ 不会很快对 Mono 采取法律行动。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-02-25T16:22:50.900

它工作得很好。恕我直言，您应该使用开发站点 ( [www.go-mono.com](http://www.go-mono.com) ) 中的 Mono，而不是随您的发行版提供的版本。

您也可以尝试使用官方网站上也提供的 VMWare 机器干运行它。

# c# - 绑定到 Singleton 的 TextBlock 数据未在 WPF 中更新

> ID：582497
> 
> 赞同：1
> 
> 时间：2009-02-24T16:42:19.757
> 
> 标签：c#, wpf

我为新手问题道歉，但我正在努力解决这个问题。我定义了以下 TextBlock：

```
<TextBlock Text="{Binding Source={x:Static local:DeviceManager.Instance},
 Path=Player.CurrentArtist}"></TextBlock> 
```

DeviceManager 是一个单例，用作其他类的外观。例如，是表示音乐播放应用程序`Player`的类型属性。`IPlayer`我希望 TextBlock 显示当前正在播放的艺术家，该艺术家会在`Player.CurrentArtist`属性中定期更新。

`CurrentArtist`不幸的是，当属性更新时，我无法更新 TextBlock 。`DeviceManager`和implement ，但是当我单步执行应用程序时，`IPlayer`没有附加事件处理程序。`INotifyPropertyChanged``DeviceManager`

有没有人建议如何在保留单例外观的同时更新文本块？

下面是 DeviceManager 和 IPlayer 子类中 INotifyPropertyChanged 成员的代码：

```
public sealed class DeviceManager : INotifyPropertyChanged
{
    // Singleton members omitted

    public IPlayer Player
    {
        get { return player; }
        set
        {
            this.player = value;
            player.PropertyChanged += new PropertyChangedEventHandler(device_PropertyChanged);
        }
    }

    #region INotifyPropertyChanged Members

    public event PropertyChangedEventHandler PropertyChanged;

    private void device_PropertyChanged(object sender, PropertyChangedEventArgs e)
    {
        PropertyChangedEventHandler handler = PropertyChanged;
        if (handler != null)
        {
            handler(sender, e);
        }
    }

    #endregion
}

class MediaPlayer : IPlayer
{
    private string artist;
    private string title;

    public event PropertyChangedEventHandler PropertyChanged;

    public void Play(string artist, string title)
    {
        this.artist = artist;
        this.title = title;
        OnPropertyChanged("Player:Song");
    }

    private void OnPropertyChanged(string p)
    {
        PropertyChangedEventHandler handler = PropertyChanged;
        if (handler != null)
        {
            handler(this, new PropertyChangedEventArgs(p));
        }
    }

    public string CurrentTitle
    {
        get { return title; }
    }

    public string CurrentArtist
    {
        get { return artist; }
    }

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-24T17:27:33.873

问题是 WPF 永远不会通知`CurrentArtist`属性值的变化。您可以为该属性实现一个私有 setter ，`CurrentArtist`这将触发`PropertyChanged`事件，或者在.`PropertyChanged``CurrentArtist``MediaPlayer.Play()`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-24T16:53:29.980

UI 如何知道您何时更改了 Player 属性？从该代码来看，它看起来不像向我提出 PropertyChanged。您可以发布问题的完整工作示例吗？否则我们只能猜测。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-24T17:45:42.630

如果您传入的名称（即现在的“Player:Song”）与您绑定的属性相同，WPF 仅响应 PropertyChanged - 将 PropertyChanged 更改为“CurrentArtist”，您会看到它正确更新。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-25T09:54:17.763

您没有引发 PropertyChanged 事件，您需要的是：

```
public sealed class DeviceManager : INotifyPropertyChanged
{
    // Singleton members omitted

    public IPlayer Player
    {
        get { return player; }
        set
        {
            this.player = value;
            OnPropertyChanged(this, new PropertyChangedEventArgs("Player"));
        }
    }

    #region INotifyPropertyChanged Members

    public event PropertyChangedEventHandler PropertyChanged;

    private void OnPropertyChanged(object sender, PropertyChangedEventArgs e)
    {
        PropertyChangedEventHandler handler = PropertyChanged;
        if (handler != null)
        {
            handler(sender, e);
        }
    }

    #endregion
} 
```

# c# - 在 ASP.Net 中引用我的自定义网格视图

> ID：582505
> 
> 赞同：0
> 
> 时间：2009-02-24T16:45:23.040
> 
> 标签：c#, asp.net, gridview

我有一个继承自基本 System.Web.UI.WebControls.GridView 的自定义网格视图对象。代码在类文件中。如何在我的 aspx 页面中引用此类文件？

我尝试使用：

```
<%@ Register Namespace="SRC.Web.Common" TagPrefix="custom"%> 
```

但我的智能感知不会选择我的新参考。我宁愿不创建用户控件。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-24T17:01:44.170

[在这里，](http://www.dotnetcurry.com/ShowArticle.aspx?ID=72&AspxAutoDetectCookieSupport=1)他说在 web.config 中注册您的控件将获得智能感知支持。

您可以将自定义控件注册为：

```
<configuration>

  <system.web>

    <pages>
      <controls>
        <add tagPrefix="custom" assembly="SRC.Web.Common"/>
      </controls>
    </pages>

  </system.web>

</configuration> 
```

希望这可以帮助 ！

# sql-server - MSSQL 记录日期/时间自动删除

> ID：582506
> 
> 赞同：15
> 
> 时间：2009-02-24T16:45:57.203
> 
> 标签：sql-server, datetime, records

我想根据每条记录的时间戳从数据库表中删除记录。我想让它自动删除与日期/时间间隔相比的记录，而无需用户干预或管理员干预。

解决此问题的最佳方法是什么，我可以创建一个在后台运行的进程来进行检查，但这是我想避免的额外工作？有没有我可以用作模板的库/网络服务？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-02-24T16:51:56.097

[SQL Server 代理](http://msdn.microsoft.com/en-us/library/ms189237.aspx)可以为您执行此操作。

只需创建一个具有定期计划和您要运行的 SQL 的作业。有一个易于使用的向导界面来创建工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-12-26T09:03:37.730

使用以下查询创建一个 sql JOB：

UPDATE [dbo].[User] WITH (ROWLOCK) SET active_flag=0 where lastlogindt < DATEADD(Day,-90,GETDATE())

# iphone - iPhone CoreLocation：如何获得最准确的速度

> ID：582511
> 
> 赞同：7
> 
> 时间：2009-02-24T16:47:16.093
> 
> 标签：iphone, cocoa-touch, core-location

我正在尝试将 GPS 功能添加到我的 iPhone 应用程序中。这是一个锻炼应用程序，将在步行或跑步时使用。所以我想用 GPS 来显示这个人以 Mph 和分钟/英里为单位移动的速度。

我应该如何配置 CLLocationManager 以获得最佳结果？我应该设置什么desiredAccuracy 和distanceFilter？

我试过：

distanceFilter = 10 和desiredAccuracy = kCLLocationAccuracyNearestTenMeters

和阅读

CLLocation.speed 属性

在我的车里四处行驶时进行测试，与车速表相比，准确性似乎不错，尽管更新需要一段时间。我意识到更新延迟很可能是查询 GPS 位置所需的时间，但我不确定更改上述两个参数是否会产生更好的结果。

我应该为 distanceFilter 使用 kCLLocationAccuracyBest 和其他一些值吗？

我很想听听其他人使用 CoreLocation 来提高速度。你在做什么来获得更准确的结果？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-10T15:20:28.843

为获得最佳结果，您应该使用 kCLLocationAccuracyBest。您放入距离过滤器的内容取决于您愿意放入哪些故障。基本上，您将不得不根据准确性与可用性做出决定。也就是说，在没有最准确答案的时期，您将显示什么？

一种方法是让电话提供不太准确的答案，并使用对上次您获得最准确信息时发生的情况的预测，看看您所掌握的是否有意义。

也就是说，假设我以每小时 6 英里的速度向北慢跑。你沿着 A 点、B 点、C 点绘制我……然后你得到一个低准确度的答案（可能是 kCLLocationAccuracyNearest100Meters。）看看它说我所在的位置并弄清楚“我能做到吗如果我继续沿着当前的路径，对可能的速度变化进行合理的调整，从 C 点开始？” 如果是这样，那么新点就在可能的范围内。（如果没有，那就扔掉它。）然后以我最后一次知道的速度从 C 点投射，并从弹道上找出你认为我可能在哪里。将其保存为弹道点-D。

当然，您使用加速度计来获得某种惯性感，以了解我走了哪条路，对吗？因此，您无法知道方向（您不知道手机指向什么方向），但您可以在远处进行合理的刺伤。

使用所有这些信息，绘制出你认为我可能在的最有可能的位置。

注意：测试时，不要只在良好的小区覆盖区域开车。了解您的应用在远离手机的山丘上的表现如何。很多人喜欢骑自行车和慢跑这些地区！

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-24T17:28:36.557

免责声明：我只玩了一点CoreLocation，我没有非常仔细地测试过准确性。

我希望您通过使用默认的 distanceFilter 和 desiredAccuracy 获得最准确的结果。不那么频繁的更新只会给你更少的数据来处理。

您可能会遇到的一个问题是位置修复丢失了一段时间，然后又回来了。计算行进距离的天真、点点滴滴的方法往往会低估跑步者的实际速度。与使用 CLLocation.speed 不同，您可能会根据跑步者实际遵循的路线的一些启发式近似来计算速度，从而获得更好的结果。

# sql - SQL中无表达式CASE中的多个WHEN？

> ID：582514
> 
> 赞同：3
> 
> 时间：2009-02-24T16:48:44.093
> 
> 标签：sql, case

```
 DECLARE @TestVal int
SET @TestVal = 5

SELECT
    CASE
        WHEN @TestVal <=3 THEN 'Top 3'
        ELSE 'Other'
    END 
```

我在网上看到了这个示例代码，但是我找不到没有表达式并且它有多个 WHEN 的示例，所以我想知道这种类型的东西是否可以：

```
 DECLARE @TestVal int
SET @TestVal = 5

SELECT
    CASE
        WHEN @TestVal <=3 THEN 'Top 3'
                WHEN (select ...) = 1 THEN 'Other Value'
                WHEN (select ...) = 2 THEN 'Other Value 2'
        ELSE 'Other'
    END 
```

还是我需要为每一行说 CASE WHEN？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-24T16:53:23.583

是的，这很好，但我会垂直排列“WHEN”并更像这样解释：

```
SELECT
    CASE
        WHEN @TestVal <=3  THEN 'Top 3'
        WHEN @TestVal <=10 THEN 'Top 10'
        WHEN @TestVAl <=25 THEN 'Top 25'
        ELSE 'Other'
    END 
```

格式可能只是一个降价故障，但`(select...)`在您的示例中，应该是一个更简单的片段。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-24T16:52:33.507

[案例](http://msdn.microsoft.com/en-us/library/ms181765.aspx)采用以下形式

```
CASE WHEN Condition THEN Result
     WHEN Condition2 THEN Result2
ELSE Default
END 
```

# 编辑

这假设您使用 Microsoft SQL Server 其他 DBMS 可能不同

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-11T20:40:49.017

```
 SELECT
       CASE
          WHEN @TestVal <=3  THEN 'Top 3'
          WHEN @TestVal <=10 THEN 'Top 10'
          WHEN @TestVAl <=25 THEN 'Top 25'
          ELSE 'Other'
       END 
```

关于嵌套 case 语句，也可以这样做（sql 中最多允许 10 个嵌套 case 语句）

[http://msdn.microsoft.com/en-us/library/ms181765.aspx](http://msdn.microsoft.com/en-us/library/ms181765.aspx)

# visual-studio-2008 - Visual Studio 2008 中的自述 HTML 文件

> ID：582515
> 
> 赞同：1
> 
> 时间：2009-02-24T16:48:51.643
> 
> 标签：visual-studio-2008

我正在创建一个示例 C# 项目来演示一些模式。除了项目，我还想包含一个“Readme.mht”，其中包含示例概述、一些图表以及如何测试它的说明。

1.  在 Visual Studio 中打开项目时，我希望显示此文件。
2.  默认情况下，MHT 文件当前显示在文本编辑器视图中。我希望它改为使用 Visual Studio 的内置 Web 浏览器打开。

我似乎记得 Visual Studio 中的项目模板就是这样做的，但我找不到任何模板。任何指针将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-26T11:08:37.623

复制测试项目模板，这会迫使你面对那个愚蠢的文本文件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-09-04T04:38:17.747

一年半后，我偶然发现了这个页面：

[http://msdn.microsoft.com/en-us/library/ms364046(VS.80).aspx](http://msdn.microsoft.com/en-us/library/ms364046(VS.80).aspx)

它很简单：

```
<ProjectItem OpenInWebBrowser="true" 
```

# objective-c - Cocoa NSArray/NSSet: -makeObjectsPerformSelector: vs. 快速枚举

> ID：582521
> 
> 赞同：14
> 
> 时间：2009-02-24T16:50:07.053
> 
> 标签：objective-c, cocoa, macos

我想对存储在`NSSet`.

我的第一次尝试是使用快速枚举：

```
for (id item in mySetOfObjects)
    [item action]; 
```

效果很好。然后我想到了：

```
[mySetOfObjects makeObjectsPerformSelector:@selector(action)]; 
```

而现在，我不知道什么是最好的选择。据我了解，这两种解决方案是等效的。但是，是否存在偏爱一种解决方案而不是另一种解决方案的论据？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-02-24T17:07:23.517

我会主张使用`makeObjectsPerformSelector`，因为它允许 NSSet 对象处理自己的索引、循环和消息调度。编写 NSSet 代码的人最有可能知道实现该特定循环的最佳方式。

在最坏的情况下，他们会简单地实现完全相同的循环，而您所获得的只是稍微干净的代码（不需要封闭循环）。充其量，他们进行了一些内部优化，代码实际上会运行得更快。

[在 Apple 的Code Speed Performance](http://developer.apple.com/documentation/performance/Conceptual/CodeSpeed/Articles/CriticalCode.html)文档中，标题为“展开循环”的部分中简要提到了该主题。

如果您关心性能，最好的办法是设置一个快速程序，该程序对集合中的对象执行一些选择器。让它运行几百万次，计算两种不同情况之间的差异。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2011-03-11T17:12:22.827

我也被提出了这个问题。我在“[集合：对象的无序集合](http://developer.apple.com/library/mac/#documentation/Cocoa/Conceptual/Collections/Articles/Sets.html)”下的 Apple 文档“集合编程主题”中找到以下内容：

> NSSet 方法 objectEnumerator 让您可以一一遍历集合中的元素。并且 makeObjectsPerformSelector: 和 makeObjectsPerformSelector:withObject: 方法提供用于向集合中的单个对象发送消息。在大多数情况下，应该使用快速枚举，因为它比使用 NSEnumerator 或 makeObjectsPerformSelector: 方法更快、更灵活。有关枚举的更多信息，请参阅“枚举：遍历集合的元素”。</p>

这让我相信快速枚举仍然是这个应用程序最有效的方法。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-02-26T22:00:34.047

我不会使用 makeObjectsPerformSelector 的原因很简单，因为它是您不经常看到的那种调用。例如，这就是为什么 - 我需要在枚举数组时添加调试代码，而你真的不能用 makeObjectsPerformSelector 做到这一点，除非你改变代码在发布模式下的工作方式，这是一个真正的不。

```
for (id item in mySetOfObjects)
{
    #if MY_DEBUG_BUILD
    if ([item isAllMessedUp])
        NSLog(@"we found that wily bug that has been haunting us"); 
    #endif

    [item action];
} 
```

——汤姆

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-24T17:53:37.090

`makeObjectsPerformSelector:`可能会稍微快一些，但我怀疑 99% 的时间里不会有任何实际差异。虽然它更简洁易读，但我会出于这个原因使用它。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-08-13T23:21:52.240

如果纯粹的速度是唯一的问题（即您正在创建一些渲染引擎，其中每个微小的 CPU 周期都很重要），那么迭代任何 NSCollection 对象（从 iOS 5.0 ~ 6.0 开始）的最快方法是各种“enumerateObjectsUsingBlock”方法。我不知道为什么会这样，但我测试了它，这似乎是这种情况......

我编写了一个小测试，创建了数十万个对象的集合，每个对象都有一个方法，该方法对一个简单的整数数组求和。这些集合中的每一个都被迫执行各种类型的迭代（for 循环、快速枚举、makeObjectsPerformSelector 和 enumerateObjectsUsingBlock）数百万次，并且几乎在每种情况下，“enumerateObjectsUsingBlock”方法都在测试过程中轻松获胜。

The only time when this wasn't true was when memory began to fill up (when I began to run it with *millions* of objects), after which it began to lose to "makeObjectsPerformSelector".

I'm sorry I didn't take a snapshot of the code, but it's a very simple test to run, I highly recommend giving it a try and see for yourself. :)

# iphone - 以与 iPhone 上的应用程序类似的方式排列 WPF 中的 GUI 元素

> ID：582523
> 
> 赞同：4
> 
> 时间：2009-02-24T16:50:31.360
> 
> 标签：iphone, wpf, drag-and-drop

我想以与 iPhone 上的应用程序类似的方式在 WPF 中安排 UIControls。它们应该位于网格上，但用户应该能够将它们拖动到其他位置，在释放鼠标按钮（或在 iPhone 的情况下为手指）后，选定的 UIControl 应该快速回到网格中的下一个位置。其他 UIElements 应该自动重新排列。

此外，用户还应该用一条线或其他东西连接两个元素。

我对 WPF 没有经验。第一个问题是是否有适合某些东西的容器（System.Windows.Controls.Grid？），或者我是否必须为此扩展画布或其他东西。

我想知道可以使用 WPF 框架中的哪些元素以及我必须自己编写哪些元素。

对于没有 iPhone 的人：[http ://www.youtube.com/watch?v=3omhu2AUWC8](http://www.youtube.com/watch?v=3omhu2AUWC8)

更新

我在 BangOTricks 示例中查看了 AnimatedTilePanel（见下文），这个解释了如何创建自己的面板以及如何让它在那里安排东西。但是我仍然需要知道如何在这个示例中正确实现拖放..

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-25T01:43:17.367

不幸的是，您必须自己编写很多东西，因为 WPF 不会自动执行您要查找的内容。

对于定位控件，您可以使用 UniformGrid 或 Grid。假设它很像您展示的 iPhone 视频，您可以使用具有 4 列的 UniformGrid 以及您需要的任意多行。

对于拖动动画，布局方面，您可以首先在被拖动的任何内容上操作 RenderTransform 属性，但是您必须设置一个处理程序来检查一旦您达到了移动到另一个“单元格”所需的任何阈值-- 此时，您将不得不更改树中项目的顺序。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-25T10:15:16.293

看看 Kevin 的 Bag-o-Tricks 中的 AnimatedTilePanel：

[http://j832.com/bagotricks/](http://j832.com/bagotricks/)

它不会做你想做的一切，但它会向你展示如何编写一个面板，在更改大小或顺序时为其子级设置动画。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-27T08:41:09.870

09 年对这篇旧帖子的新输入。今年早些时候（2012 年），有人编写了[FluidWrapPanel](http://www.codeproject.com/Articles/244134/WPFSpark-3-of-n-FluidWrapPanel)并将其开源。我试过了，它就像一个魅力 - 就像 iPhone 菜单上的那样。

您还可以应用于其他 UI 元素或用户控件。

# keyboard - 常用粘贴操作的地图键盘

> ID：582524
> 
> 赞同：1
> 
> 时间：2009-02-24T16:50:34.290
> 
> 标签：keyboard, paste

我想在键盘上编写一个键，以便在按下时粘贴某些静态文本。

例如，我想对 F12 键进行编程，以便每次按下时都会粘贴我的电子邮件地址。是否有捷径可寻？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-24T16:53:45.640

有一些优秀的免费软件产品允许您重新映射键和创建宏。对于 Windows，您可以使用[AutoHotKey](http://www.autohotkey.com/)。我以前用过它，它对于这类事情非常方便。

这是一个非常强大的工具，刚开始使用可能有点吓人，但值得花时间去了解它。[快速入门](http://www.autohotkey.com/docs/Tutorial.htm)指南非常有帮助。

如果您的意思是使用 C++ 或 .NET 或其他东西在您自己的程序中执行此操作的能力，请提供更多详细信息。

# java - Hibernate 不尊重 MySQL auto_increment 主键字段

> ID：582526
> 
> 赞同：22
> 
> 时间：2009-02-24T16:50:52.387
> 
> 标签：java, mysql, hibernate

我正在尝试了解 Hibernate 的工作原理，但我遇到了几乎无法接受的学习曲线。我看不到如何让 Hibernate 尊重我的对象的 auto_increment 策略。相反，它使用现有 ID 覆盖数据库中的条目，从 1 开始。

我有一个简单的`Foo`对象，由这样定义的 MySQL 表支持：

```
CREATE TABLE `Foo` (
  `fooId` int(11) NOT NULL AUTO_INCREMENT,
  PRIMARY KEY (`fooId`),
) 
```

我已经确认使用 SQL ( `insert into Foo values();`) 手动插入多个 Foo 对象是正确的。

我的 Java 类具有使用如下注释指定的 ID：

```
@Id
@GeneratedValue(strategy=GenerationType.AUTO)
@Column(name="fooId")
private Integer id; 
```

然后我执行一些简单地实例化 Foo 对象并将它们保存到数据库的测试代码（使用`session.save(obj)`）。好像是用自己的主键序列，从一开始，不看表的键策略。它会覆盖那里的所有内容。

我已经尝试了`@GeneratedValue`一些变化（使用所有可能的策略，省略括号）。甚至有人建议完全放弃`GeneratedValue`。似乎没有任何效果。

我是不是遗漏了什么？我错过了什么？Hibernate真的这么难吗？

（如果有人有其他 Java 数据库持久性选项，请提出一个建议。我正在制作原型，而不是持久的 mondo 工程项目。）

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2009-02-24T17:06:02.490

相信你想要`GenerationType.IDENTITY`。MySql 不使用表或序列来生成 Id 值。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-03T15:51:08.073

我在接受的答案下的评论中写了这个，但默认情况下不显示这些，所以我会重新发布它作为答案。

我在某个家伙的网站上使用了一个 hibernate.cfg.xml 文件，它有这个：

```
<property name="hibernate.hbm2ddl.auto">create</property> 
```

这使得系统在我每次运行我的应用程序时都重新创建我的表。评论出来解决了这个问题。

关于创建 ID 的各种方法的其他两个答案是正确的。我最初的问题的**症状**似乎与 ID 生成有关，但实际原因是配置错误。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-02T16:28:46.260

我认为 GenerationType.AUTO 和 <id ...><generator class="native" /></id> 一样正确

为特定数据库选择适当的策略。

[http://www.hibernate.org/hib_docs/ejb3-api/javax/persistence/GenerationType.html](http://www.hibernate.org/hib_docs/ejb3-api/javax/persistence/GenerationType.html)

[http://www.hibernate.org/hib_docs/reference/en/html/mapping.html](http://www.hibernate.org/hib_docs/reference/en/html/mapping.html)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-03T00:26:35.190

我将以下内容与 auto_increment 一起使用，效果很好：

```
@Id
@GeneratedValue(strategy = IDENTITY)
@Column(name = "db_id", unique = true, nullable = false)
public Long getDbId() {
    return this.dbId;
}

public void setDbId(Long dbId) {
    this.dbId = dbId;
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-17T15:58:28.247

你可能想看看： [http ://hibernatepojoge.sourceforge.net/](http://hibernatepojoge.sourceforge.net/)

它声称只需将其指向数据库即可创建一个完全工作的应用程序（spring、hibernate、junit 测试等）。

# .net - 获取 ClickOnce 文件关联的路径

> ID：582528
> 
> 赞同：3
> 
> 时间：2009-02-24T16:51:36.800
> 
> 标签：.net, wpf, shell, clickonce

我一直在使用 ClickOnce，但我正在为文件关联而苦苦挣扎。我可以建立协会。双击关联文件甚至可以启动应用程序。

...然而...

我不知道如何访问***单击***以启动应用程序的文件的路径。

有没有人遇到过这个？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-24T17:10:38.627

官方的 .NET 方式（没有注册表）是看

AppDomain.CurrentDomain.SetupInformation.ActivationArguments.ActivationData

启动后。它是一个字符串[]

# c# - 如何将数据绑定到 Run 的内容？

> ID：582542
> 
> 赞同：1
> 
> 时间：2009-02-24T16:54:21.753
> 
> 标签：c#, wpf, binding, textblock

我想构造一个`TextBlock`由多个`Run`元素组成的元素，它们的内容绑定到`string`变量，但 Visual Studio 抱怨说只能绑定到依赖属性，但事实`Run.Text`并非如此。

有什么可以做的吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-24T17:23:12.997

查看[BindableRun](http://fortes.com/2007/03/bindablerun/)类 - 这可能应该做你想要的。

# ruby-on-rails - 使用 Rails 渲染多行文本？

> ID：582547
> 
> 赞同：4
> 
> 时间：2009-02-24T16:55:39.117
> 
> 标签：ruby-on-rails, ruby, text, render, multiline

我想在 Rails 中渲染多行文本，操作如下：

```
def mutli_text
  render :text => 'Word1\nWord2'
end 
```

我希望得到的回应是：

```
Word1
Word2 
```

不幸的是我得到了 Word1\nWord2

任何帮助，将不胜感激

（该操作必须呈现多行响应才能使自动完成 jquery 插件正常工作）

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-02-24T16:58:04.680

```
"Word1\nWord2" 
```

您必须使用双引号才能使用转义字符。

但是如果你想让它成为浏览器中的换行符，你需要让它成为一个真正的 html 标签。

```
'Word1<br/>Word2' 
```

甚至：

```
"Word1<br/>\nWord2" 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2010-07-14T23:47:02.877

你实际上可以做这样的事情：

`(render :text => "line1\nline2").gsub("\n",'<br />')`

它至少适用于视图中的#render（使用 HAML）。我没有在控制器动作中尝试过。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-05-16T16:29:00.430

只需将文本渲染为`plain`. 如果您愿意，您甚至可以将内容类型更改为 csv。

```
render :plain => 'Word1\nWord2', :content_type => "text/csv" 
```

# ruby-on-rails - Rails 的时间比较问题

> ID：582548
> 
> 赞同：1
> 
> 时间：2009-02-24T16:55:43.437
> 
> 标签：ruby-on-rails, ruby, datetime, logic

我手头有一个非常简单的任务。如果上次更新记录的时间超过 15 分钟，则显示一个按钮。否则，不显示按钮。

该字段是日期时间。

我的查看代码：

```
<% if @object.display_button? -%>
  my button
<% end -%> 
```

我在该对象上的显示按钮方法：

```
def display_button?
  return false if last_updated.nil?
  if Time.now - last_updated > 15.minutes
    true
  else
    false
  end
end 
```

我也对这个单元进行了测试，它正在通过，但是在实现方面，它似乎不起作用。

我的逻辑是正确的还是有更好的方法来实现这一点？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-24T17:01:44.373

```
if last_updated < 15.minutes.ago 
```

分钟方法返回一个我相信的整数，减去时间对象会产生另一个时间对象。因此，您的表达式将 int 与时间进行比较，并执行您不期望的操作。

`15.minutes.ago`产生一个可以直接与另一个时间对象进行比较的时间对象。

* * *

另外，永远不要`if (something) return true; else; return false`用红宝石做。您的方法将返回在其中执行的最后一个表达式的值，因此您可以大大简化整个方法：

```
def display_button?
  last_updated && last_updated < 15.minutes.ago
end 
```

这不是更容易阅读吗？

# c# - C# Begin/EndReceive - 如何读取大数据？

> ID：582550
> 
> 赞同：12
> 
> 时间：2009-02-24T16:56:21.563
> 
> 标签：c#, networking, sockets, asynchronous

当以 1024 块读取数据时，如何继续从接收大于 1024 字节的消息的套接字读取数据，直到没有数据为止？我是否应该只使用 BeginReceive 来读取数据包的长度前缀，然后一旦检索到，使用 Receive() （在异步线程中）来读取数据包的其余部分？还是有其他方法？

## 编辑：

我认为 Jon Skeet 的链接有解决方案，但该代码有一点减速带。我使用的代码是：

```
public class StateObject
{
    public Socket workSocket = null;
    public const int BUFFER_SIZE = 1024;
    public byte[] buffer = new byte[BUFFER_SIZE];
    public StringBuilder sb = new StringBuilder();
}

public static void Read_Callback(IAsyncResult ar)
{
    StateObject so = (StateObject) ar.AsyncState;
    Socket s = so.workSocket;

    int read = s.EndReceive(ar);

    if (read > 0) 
    {
        so.sb.Append(Encoding.ASCII.GetString(so.buffer, 0, read));

        if (read == StateObject.BUFFER_SIZE)
        {
            s.BeginReceive(so.buffer, 0, StateObject.BUFFER_SIZE, 0, 
                    new AyncCallback(Async_Send_Receive.Read_Callback), so);
            return;
        }
    }

    if (so.sb.Length > 0)
    {
        //All of the data has been read, so displays it to the console
        string strContent;
        strContent = so.sb.ToString();
        Console.WriteLine(String.Format("Read {0} byte from socket" + 
        "data = {1} ", strContent.Length, strContent));
    }
    s.Close();
} 
```

现在这个更正的工作大部分时间都很好，但是当*数据包的大小是 buffer 的倍数*时它会失败。这样做的原因是，如果缓冲区在读取时被填满，则假定有更多数据；但同样的问题发生在以前。例如，一个 2 字节缓冲区在 4 字节数据包上被填充两次，并假设有更多数据。然后它会阻塞，因为没有什么可读取的了。**问题是接收函数不知道数据包何时结束。**

* * *

这让我想到了两种可能的解决方案：我可以有一个数据包结束分隔符，或者我可以读取数据包标头以找到长度，然后准确接收该数量（正如我最初建议的那样）。

但是，这些都有问题。我不喜欢使用分隔符的想法，因为用户可以以某种方式将其放入应用程序输入字符串中的数据包中并将其搞砸。在我看来，这也有点草率。

长度标头听起来不错，但我打算使用协议缓冲区 - 我不知道数据的格式。有长度标题吗？它是多少字节？这会是我自己实现的吗？ETC..

我该怎么办？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-02-24T17:00:28.760

否 -`BeginReceive`从回调处理程序再次调用，直到`EndReceive`返回 0。基本上，您应该继续异步接收，假设您想要充分利用异步 IO。

如果您查看 MSDN 页面，[`Socket.BeginReceive`](http://msdn.microsoft.com/en-us/library/dxkwh6zw.aspx)您会看到一个示例。（诚​​然，这并不像它可能的那么容易。）

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-03-01T07:46:13.933

当。鉴于政要们已经参与进来，我什至都不愿回答这个问题，但这里就可以了。温柔，哦伟大的人！

如果没有阅读 Marc 博客的好处（由于公司互联网政策，它在此处被屏蔽），我将提供“另一种方式”。

在我看来，诀窍是***将数据的接收与数据的处理分开***。

我使用这样定义的 StateObject 类。它与 MSDN StateObject 实现的不同之处在于它不包含 StringBuilder 对象，BUFFER_SIZE 常量是私有的，并且为了方便，它包含一个构造函数。

```
public class StateObject
{
    private const int BUFFER_SIZE = 65535;
    public byte[] Buffer = new byte[BUFFER_SIZE];
    public readonly Socket WorkSocket = null;

    public StateObject(Socket workSocket)
    {
        WorkSocket = workSocket;
    }
} 
```

我还有一个 Packet 类，它只是一个缓冲区和时间戳的包装器。

```
public class Packet
{
    public readonly byte[] Buffer;
    public readonly DateTime Timestamp;

    public Packet(DateTime timestamp, byte[] buffer, int size)
    {
        Timestamp = timestamp;
        Buffer = new byte[size];
        System.Buffer.BlockCopy(buffer, 0, Buffer, 0, size);
    }
} 
```

我的 ReceiveCallback() 函数看起来像这样。

```
public static ManualResetEvent PacketReceived = new ManualResetEvent(false);
public static List<Packet> PacketList = new List<Packet>();
public static object SyncRoot = new object();
public static void ReceiveCallback(IAsyncResult ar)
{
    try {
        StateObject so = (StateObject)ar.AsyncState;
        int read = so.WorkSocket.EndReceive(ar);

        if (read > 0) {
            Packet packet = new Packet(DateTime.Now, so.Buffer, read);
            lock (SyncRoot) {
                PacketList.Add(packet);
            }
            PacketReceived.Set();
        }

        so.WorkSocket.BeginReceive(so.Buffer, 0, so.Buffer.Length, 0, ReceiveCallback, so);
    } catch (ObjectDisposedException) {
        // Handle the socket being closed with an async receive pending
    } catch (Exception e) {
        // Handle all other exceptions
    }
} 
```

请注意，此实现绝对不处理接收到的数据，也不期望接收到多少字节。它只是接收套接字上碰巧出现的任何数据（最多 65535 字节）并将该数据存储在数据包列表中，然后立即将另一个异步接收排队。

由于处理不再发生在处理每个异步接收的线程中，数据显然会由*不同*的线程处理，这就是为什么 Add() 操作通过 lock 语句同步的原因。此外，处理线程（无论是主线程还是其他一些专用线程）需要知道***何时***有数据要处理。为此，我通常使用 ManualResetEvent，这就是我上面展示的内容。

这是处理的工作原理。

```
static void Main(string[] args)
{
    Thread t = new Thread(
        delegate() {
            List<Packet> packets;
            while (true) {
                PacketReceived.WaitOne();
                PacketReceived.Reset();
                lock (SyncRoot) {
                    packets = PacketList;
                    PacketList = new List<Packet>();
                }

                foreach (Packet packet in packets) {
                    // Process the packet
                }
            }
        }
    );
    t.IsBackground = true;
    t.Name = "Data Processing Thread";
    t.Start();
} 
```

这是我用于所有套接字通信的基本基础设施。它在数据接收和数据处理之间提供了很好的分离。

至于您遇到的另一个问题，请务必记住，使用这种方法，每个 Packet 实例不一定代表应用程序上下文中的完整消息。一个 Packet 实例可能包含部分消息、一条消息或多条消息，并且您的消息可能跨越多个 Packet 实例。我已经解决了如何知道您何时收到您在[此处](https://stackoverflow.com/questions/586819/how-to-detect-when-a-protocol-buffer-message-is-fully-received/599309#599309)发布的相关问题中的完整消息。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-24T17:03:25.993

您将首先阅读长度前缀。一旦你有了它，你就可以继续读取块中的字节（并且你可以做到这一点异步，正如你所推测的那样），直到你用尽了你知道的从网络中传入的字节数。

请注意，在某些时候，在读取最后一个块时，您不会想要读取完整的 1024 个字节，具体取决于长度前缀表示的总数以及您已读取的字节数。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2011-06-08T02:58:14.560

我也遇到了同样的问题。

当我多次测试时，我发现有时会多次`BeginReceive - EndReceive`导致丢包。（此循环未正确结束）

就我而言，我使用了两种解决方案。

首先，我定义了足够的数据包大小，只做 1 次`BeginReceive() ~ EndReceive();`

其次，当我收到大量数据时，我使用`NetworkStream.Read()`了`BeginReceive() - EndReceive()`.

异步socket不好用，需要对socket有很多了解。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-24T20:45:55.520

有关信息（一般开始/结束使用），您可能希望查看[此博客文章](http://marcgravell.blogspot.com/2009/02/async-without-pain.html)；这种方法对我来说效果很好，并且节省了很多痛苦......

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-11-08T20:35:41.273

围绕这一点似乎有很多困惑。MSDN 网站上使用 TCP 进行异步套接字通信的示例具有误导性，并且没有得到很好的解释。如果消息大小是接收缓冲区的整数倍，则 EndReceive 调用确实会阻塞。这将导致您永远不会收到您的消息并且应用程序挂起。

只是为了澄清 - 如果您使用 TCP，您必须为数据提供自己的分隔符。阅读以下内容（这是来自非常可靠的来源）。

> 应用程序数据定界的需要
> 
> TCP 将传入数据视为流的另一个影响是应用程序使用 TCP 接收的数据是非结构化的。对于传输，数据流进入一个设备上的 TCP，在接收时，数据流返回到接收设备上的应用程序。即使流被分成段以供 TCP 传输，这些段也是对应用程序隐藏的 TCP 级别的详细信息。因此，当一个设备想要发送多条数据时，TCP 没有提供机制来指示这些数据之间的“分界线”在哪里，因为 TCP 根本不检查数据的含义。应用程序必须提供执行此操作的方法。
> 
> 例如，考虑一个正在发送数据库记录的应用程序。它需要从员工数据库表中传输记录#579，然后是记录#581 和记录#611。它将这些记录发送到 TCP，TCP 将它们统称为字节流。TCP 会将这些字节打包成段，但应用程序无法预测。有可能每个都将在不同的段中结束，但更有可能它们都将在一个段中，或者每个段中的一部分将在不同的段中结束，具体取决于它们的长度。记录本身必须有某种明确的标记，以便接收设备可以知道一个记录在哪里结束，下一个记录在哪里开始。
> 
> 来源：[http ://www.tcpipguide.com/free/t_TCPDataHandlingandProcessingStreamsSegmentsandSequ-3.htm](http://www.tcpipguide.com/free/t_TCPDataHandlingandProcessingStreamsSegmentsandSequ-3.htm)

我在网上看到的大多数使用 EndReceive 的示例都是错误的或具有误导性的。在示例中它通常不会导致任何问题，因为只发送一条预定义的消息然后关闭连接。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2019-02-02T22:57:09.287

这是一个非常古老的话题，但我来到这里寻找其他东西并发现了这个：

> 现在这个更正的工作大部分时间都很好，**但是当数据包的大小是缓冲区的倍数时它会失败。**这样做的原因是，如果缓冲区在读取时被填满，则假定有更多数据；但同样的问题发生在以前。例如，一个 2 字节缓冲区在 4 字节数据包上被填充两次，并假设有更多数据。然后它会阻塞，因为没有什么可读取的了。问题是接收函数不知道数据包何时结束。

我遇到了同样的问题，因为似乎没有一个回复可以解决这个问题，所以我这样做的方式是使用[Socket.Available](https://docs.microsoft.com/en-us/dotnet/api/system.net.sockets.socket.available?view=netframework-4.7.2)

```
public static void Read_Callback(IAsyncResult ar)
{
    StateObject so = (StateObject) ar.AsyncState;
    Socket s = so.workSocket;

    int read = s.EndReceive(ar);    
    if (read > 0) 
    {
        so.sb.Append(Encoding.ASCII.GetString(so.buffer, 0, read));

        if (s.Available == 0)
        {
            // All data received, process it as you wish
        }
    }
    // Listen for more data
    s.BeginReceive(so.buffer, 0, StateObject.BUFFER_SIZE, 0, 
                new AyncCallback(Async_Send_Receive.Read_Callback), so);
} 
```

希望这对其他人有帮助，所以已经帮助了我很多次，谢谢大家！

# tfs - TFS 试用版许可问题

> ID：582552
> 
> 赞同：0
> 
> 时间：2009-02-24T16:56:52.920
> 
> 标签：tfs, licensing

我的 Team Foundation Server 试用版已过期。为什么我不能在另一台服务器上安装一个新副本并再使用 90 天？

1.  我正在使用相同的源代码。
2.  我不想这样做，但我的老板正试图让我这样做。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-24T17:02:19.880

除了这是非法的，我认为每 90 天切换到新服务器的麻烦将超过为软件付费的成本。

所以你有3个选择

*   支付软件费用并获得合法权益
*   保持每 90 天更换一次服务器
*   切换到免费的开源系统（颠覆？）

还有第四个选择：您可以参加所有 Microsoft 活动，并希望他们在其中一个活动中向 TFS 发放免费许可证 :)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-24T18:15:18.893

假设您的雇主希望您这样做以延长您的评估期，并且不使用违反许可条款的软件，那么您可能想尝试在以下帖子底部发布的实用程序：

[http://blogs.msdn.com/bharry/archive/2008/01/15/checking-your-tfs-version-and-extending-trials.aspx](http://blogs.msdn.com/bharry/archive/2008/01/15/checking-your-tfs-version-and-extending-trials.aspx)

TFS 目前不能很好地迁移到另一个 TFS 实例，因此如果您每 90 天不断地迁移到新的 TFS 服务器，您将不会有很好的体验。此外，您违反了 EULA，因此在大多数法律制度下都犯了某种形式的软件盗版行为。

如果您这样做是为了延长试用期，那么上面的工具会给您额外的 30 天，如果您与当地的 Microsoft 代表交谈得很好，那么您可能可以获得更长的延期。

顺便说一句 - [Microsoft BizSpark](http://www.microsoft.com/BizSpark/)是 Microsoft 运行的一个优秀程序，它提供了他们所有的开发工具（包括 TFS），专为资金紧张的初创企业而设计。如果您想了解有关该计划的更多信息，请联系您当地的 Microsoft 办事处。

祝你好运，

马丁。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-24T17:10:59.953

您使用的是 VS 团队版吗？这包括 TFS 工作组，它适用于最多 5 个用户，无需进一步许可。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-24T17:13:34.907

你**可以**这样做，但我确信就业法规（无论你住在哪里）中都有关于被迫违法的规定，这实际上就是你要做的。

# windows - 如何以编程方式更改文件的创建、修改和访问日期？

> ID：582553
> 
> 赞同：17
> 
> 时间：2009-02-24T16:56:55.587
> 
> 标签：windows, command-line

我需要更改 Windows 上文件的修改日期，以免弄乱我的排序顺序。我怎样才能用脚本来做到这一点（我将来可能也需要对文件这样做）？

顺便说一句：我不想安装应用程序来做到这一点。

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2009-02-24T17:17:39.513

如果你有 PowerShell：

```
$(Get-Item ).creationtime=$(Get-Date "mm/dd/yyyy hh:mm am/pm")
$(Get-Item ).lastaccesstime=$(Get-Date "mm/dd/yyyy hh:mm am/pm")
$(Get-Item ).lastwritetime=$(Get-Date "mm/dd/yyyy hh:mm am/pm") 
```

请注意，要使用的正确日期格式字符串取决于您的本地化，例如在英国，正确的格式字符串应该是`dd/mm/yyyy`.

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2016-04-28T14:58:14.507

使用 PowerShell，命令将是：

```
PS C:\temp> (Get-Item Notes.txt).lastwritetime=$(Get-Date "1/2/2016 12:34 am")

PS C:\temp> (Get-Item Notes.txt).creationtime=$(Get-Date "1/2/2016 12:34 am")

PS C:\temp> (Get-Item Notes.txt).lastaccesstime=$(Get-Date "1/2/2016 12:34 am") 
```

[![在此处输入图像描述](https://i.stack.imgur.com/QcRwU.png)](https://i.stack.imgur.com/QcRwU.png)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-24T17:10:46.147

以下是更改修改日期的 VBScript 示例：

```
Sub ChangeModifiedDate(strFolder, strFile, dteNew)

    Dim oShell
    Dim objFolder

    Set oShell = CreateObject("Shell.Application")
    Set oFolder = oShell.NameSpace(strFolder)
    oFolder.Items.Item(strFile).ModifyDate = dteNew
End Sub 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2018-08-28T23:05:40.893

在 PowerShell 中，您可以列出文件并使用它在一行中设置其属性。

例如使用通配符：

```
(ls yourF*).lastWriteTime = (get-date).AddDays(-60) 
```

对于单个文件：

```
(ls yourFile.doc).creationTime = (get-date).AddDays(-60) 
```

*（上面的命令假设你已经 cd'd 到文件的目录。）*

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-24T17:07:24.470

使用 Java，您可以执行以下操作：

```
File file = new File("someFile");
file.setLastModified(long time); 
```

# c# - 使用 Linq To SQL 对密码进行加盐和哈希处理

> ID：582556
> 
> 赞同：10
> 
> 时间：2009-02-24T16:58:25.257
> 
> 标签：c#, .net, database, linq-to-sql

我需要对一些密码进行加盐和哈希处理，以便可以将它们安全地存储在数据库中。您对如何最好地使用 Linq To SQL 有任何建议或想法吗？

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2009-02-24T17:08:44.950

在这种情况下，LINQ to SQL 没有太大的相关性。您可以使用任何您想要的机制，因为您不会在 SQL 中进行散列和加盐。

保存密码的步骤如下：

1.  以明文形式接收密码以及用户 ID。
2.  生成（并记住）盐。
3.  将盐与密码文本结合起来，例如添加或附加。
4.  使用散列函数对结果文本进行散列
5.  将用户 ID、哈希和盐存储在您的数据库中。

验证密码的步骤如下：

1.  以明文形式接收密码以及用户 ID。
2.  从数据库中检索提供的用户 ID 的散列值和盐值。
3.  将盐与提供的密码文本结合起来。
4.  使用散列函数对结果文本进行散列。
5.  将函数的哈希值与从数据库中检索到的哈希值进行比较。
6.  如果它们相等，则提供的密码是正确的。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-24T18:11:59.417

由于您使用的是 .NET 和 C#，因此可以使用[System.Security.Cryptography.SHA512Managed](http://msdn.microsoft.com/en-us/library/system.security.cryptography.sha512managed.aspx)命名空间来生成盐值和密码哈希

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-24T17:54:49.970

基本上正如[@Vojislav](https://stackoverflow.com/questions/582556/salt-and-hash-password/582611#582611)所说。

您可能想查看[bcrypt](http://www.usenix.org/events/usenix99/provos/provos_html/node1.html)的散列 - 它被认为非常好。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-19T05:14:46.393

如果是用于用户帐户登录，您不希望只是盐+密码散列，您还希望根据 RFC2898 文档中的 PBKDF2 使用密钥拉伸。

这是使用示例用法执行您需要的 API： [https ://sourceforge.net/projects/pwdtknet](https://sourceforge.net/projects/pwdtknet)

还创建指定长度的加密随机盐

# c# - 我可以按类型找到逻辑孩子吗

> ID：582557
> 
> 赞同：1
> 
> 时间：2009-02-24T16:58:36.330
> 
> 标签：c#, wpf

我知道我可以使用`LogicalTreeHelper`类来查找每个按名称搜索的元素的子节点。但是有没有可能按类型找到子节点？例如，如果我想在我的 Window 中找到一个 ListBox 元素而不知道它的 Name 属性怎么办？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-24T17:22:09.147

我认为没有内置的方法可以做到这一点。可能最好的方法是递归调用`LogicalTreeHelper.GetChildren()`，直到找到指定类型的子控件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-24T20:36:27.103

请注意，干净地下降逻辑树实际上有点棘手，这是一篇关于视觉树和逻辑树错综复杂的好[文章](http://www.codeproject.com/KB/WPF/WpfElementTrees.aspx)。

我认为不存在任何帮助代码来为您执行此操作，因此需要在树上实现递归遍历。

# vb.net - 使用 Web 服务 - 从手动方法变为使用第三方提供的 WSDL 的自动方法

> ID：582564
> 
> 赞同：0
> 
> 时间：2009-02-24T16:59:53.800
> 
> 标签：vb.net, web-services, datatable

有点长，但比初稿短:)

我们有一个小型 VB.net 应用程序，它基本上从我们的 dBase 中提取信息，然后将这些信息导出到一个 .xls 文件。从这个 .xls 文件中，内部代理然后使用其中包含的信息手动更新第三方列表服务（维护我们当前的库存）。该信息非常基本，为便于讨论，由“零件编号”、“描述”和“现有数量”组成。

通常我们每周更新一次此信息，但是，与此列表服务的新修订合同现在需要每天更新以保持我们的“白金”供应商状态。

问题是手动更新此信息可能需要相当长的时间。因此，迫切需要自动化过程。而且我已经完成了大部分基础工作和编码 - 到了一定程度。因此问题，因此我卡住了。

列表服务为我们提供了以下 WSDL：一种用于增加我们的库存，一种用于减少我们的库存，一种用于添加库存，一种用于移除库存。

到目前为止，我已经重新编写了一个生成导出信息的存储过程。该 SP 现在进行一些内部数学运算，以确定“昨天”发生的交易结果是“增加”、“减少”、“添加”还是“删除”。然后将这些结果添加到名为“SERVICE”的新创建列下的结果表中。然后使用 vb.net 从 dBase 中提取这些新信息，并将其导入数据表中进行分析。

有了这个数据表，我现在可以遍历每一行，查看“SERVICE”列，并根据该单元格中包含的信息，调用适当的 Web 服务。

我已将所有 Web 引用添加到我的项目中，并为每个 Web 服务创建了代理类。

第二个问题是，我不知道如何实际调用实际的 Web 服务。以下是一小段代码

```
' loads data into the 'AviationDataBaseResult.ILS_ARRAY_2' table. 
Me.ILS_ARRAY_2TableAdapter.Fill(Me.AviationDataBaseResult.ILS_ARRAY_2)

' Start the looping process
For Looper = 0 To RowCount - 1 
    If Me.AviationDataBaseResult.ILS_ARRAY_2.Rows(Looper).Item("Service") = _
        "Increase" Then
        ' Call Appropriate Web service
    End If
' More If..Then's ensue, one for each service
Next

' More code ensues 
```

我意识到这已经变得很啰嗦，主要是因为在任何一天我都打开了 25 个 FF 标签，但没有一个是相互同意的。添加另一个皱纹; 有问题的 WSDL 在复杂类型中使用了很多复杂类型，您猜对了，其他复杂类型交织在一起。我查看了许多示例，但还没有找到一个处理复杂类型以及如何处理它们的示例。非常感谢任何有关“去哪里找到我需要知道的东西”的正确方向的帮助。

如果需要任何其他信息，我将非常乐意为您提供尽可能多的信息。如果我的思维过程和逻辑不适合做我需要做的事情，我也很高兴听到这一点。作为 vb.net 的新手，我已经非常擅长消费谦逊派。

谢谢你的时间。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-24T17:20:33.377

如果您已经导入了 WSDL 并生成了代理，那么只需实例化代理（您应该会看到在生成代理时提示您输入的新名称空间）然后调用方法。

您将不得不在您的数据和 Web 服务期望的类型之间执行映射，虽然很乏味，但一点也不难。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-24T17:31:22.977

我必须查看实际的 WSDL 才能具体了解如何调用这些服务。但是，一般来说，如果您将 Web 引用命名为“WebRef”，并且如果服务称为“服务”，并且操作是“操作”，那么您将执行以下操作：

```
Using svc As New WebRef.Service
    Dim parameter As New ComplexType
    parameter.Property1 = value1
    parameter.Property2 = New Property2Type
    parameter.Property2.SubProperty1 = value12
    ' ...
    svc.Operation(parameter)
End Using 
```

# ruby-on-rails - Ruby On Rails - Myspace app development

> ID：582571
> 
> 赞同：2
> 
> 时间：2009-02-24T17:02:16.743
> 
> 标签：ruby-on-rails, ruby, myspace

Which gem or plugin should I use for building Myspace applications using Ruby on Rails?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-24T17:06:04.830

MySpace provides a REST API Ruby Library:

[http://developer.myspace.com/community/libs/ruby.aspx](http://developer.myspace.com/community/libs/ruby.aspx)

I don't know if it's any good.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-24T17:08:05.903

There's also a Spacer gem. I wasn't able to get it working, however.

[http://www.railslodge.com/ruby_gems/18-spacer-](http://www.railslodge.com/ruby_gems/18-spacer-)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-24T17:18:59.917

Here's a snippet of code for the OAUTH gem:

[http://developer.myspace.com/Community/forums/p/3626/15947.aspx](http://developer.myspace.com/Community/forums/p/3626/15947.aspx)

I was unable to get it working.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-24T17:19:41.803

Another snippit of code for the OAUTH gem:

[http://developer.myspace.com/Community/forums/p/804/12424.aspx](http://developer.myspace.com/Community/forums/p/804/12424.aspx)

Also unable to get it working.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-03-09T11:22:54.760

您可以使用 myspace-ruby-sdk [http://code.google.com/p/myspaceid-ruby-sdk/](http://code.google.com/p/myspaceid-ruby-sdk/)

有一个 Rails 应用程序示例（2.2.2 版本）进入

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-24T17:54:43.717

在 myspace 上开发的很大一部分必须通过 myspace 提供的 REST api 以及用于导入响应的 ajax 调用来完成。不幸的是，在 OpenSocial 0.9 之前，你不能使用 iFrame，它暂时不会出现。在此之前熟悉 MySpace 的 API 和 ajax。

# visual-studio - Can't "go to declaration" in *.ashx files (Visual Studio 2008)

> ID：582573
> 
> 赞同：0
> 
> 时间：2009-02-24T17:02:20.457
> 
> 标签：visual-studio, visual-studio-2008

When I open *.ashx files in Visual Studio, I don't have the helpful "Go to Declaration" context menu when right-clicking on a function.

How can I restore this functionality (this is a new install)?

Thanks very much.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-24T20:23:14.217

单击要转到的文本，如果没有显示，请按**F12 。**

就像 Windows 操作系统在出现问题时需要重新启动一样，如果这不起作用，Studio 有时需要重新启动。

显然，这不会让您的菜单项返回，但您可能更喜欢从右键单击鼠标菜单中选择它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-01T02:19:27.727

这是在黑暗中拍摄的，因为我不使用与 ASP 相关的东西。

## 简答

如果您的 *.ashx 文件属于某个项目，请先打开该项目。

## 更长的答案

我在 Visual Studio 2008 中的大部分工作都是使用 C++ 和 C# 代码。如果我在 VS2008 中打开一个独立于它所属项目的 .cpp 文件或 .cs 文件，VS2008 也不会给我*Go To Declaration*上下文菜单。当我打开独立于它们所属项目的文件时，VS2008（或任何 Visual Studio 版本）只不过是一个美化的编辑器。为了获得*Go To Declaration*和其他功能（例如 Intellisense）的好处，我必须先打开项目，然后从 VS2008 中打开文件。

## 替代答案

如果您已经这样做了，您可以尝试删除项目目录中的 .suo 文件并让 VS2008 重新创建它。

## 道歉

对不起，如果这只是说明显而易见的。我知道当我在项目上下文之外打开一个文件时，我有时会感到沮丧，只是为了意识到我想要做的事情无论如何都需要我打开项目。刚接触 Visual Studio 的人可能没有意识到有时需要该项目。

# sql - Pro*Fortran 可以在 windows 上连接到 Oracle 10g 吗？

> ID：582574
> 
> 赞同：0
> 
> 时间：2009-02-24T17:02:24.403
> 
> 标签：sql, oracle, fortran77

有没有人在连接到 Oracle 10g 的 windows 上成功编译了 pro*fortran 程序？

我似乎只能找到表明可以针对 Oracle 8i 及更早版本预编译嵌入式 sql 的信息。

如果您已经这样做了，请您发布您对编译器、oracle 下载/文章等的任何链接，因为他们将不胜感激。

（顺便说一句，如果我使用的任何术语有点偏离，因为我在今天之前从未见过 fortran）

亲切的问候，

保罗

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-24T21:55:48.427

“针对 Oracle 8i 及更早版本，可以预编译嵌入式 sql。” 没听说过。但是，至少从 Pro*C 的角度来看，预编译器从 Oracle 8 开始就没有得到增强，因此为 8i 添加的许多语法以及后来的无法编译（例如标量子查询）。认为这也适用于数据类型。

可以通过动态 SQL 使用较新的 SQL。

此外，10g（或者可能是 10gR2）服务器拒绝来自旧客户端库的连接。我认为这与 8.1.7 之前的客户有关。

10gR2 文档集中有一个 Pro*Fortran 指南，所以必须有一些工作

```
http://download.oracle.com/docs/cd/B19306_01/appdev.102/b14352/toc.htm 
```

# .net - 将对象设置为空

> ID：582575
> 
> 赞同：2
> 
> 时间：2009-02-24T17:02:26.400
> 
> 标签：.net, vb.net

每次我问开发人员时，我似乎都会得到不同的答案。所以我认为溢出来看看每个人都做了什么是一个很好的问题。

如果您有一个 sqlClient.sqlconnection 对象，那么在清理代码中（最终阻止等）您是处理该对象还是将其设置为空，或两者兼而有之？

我一直*只是*调用 dispose，并允许垃圾收集器做它的事情......

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-24T17:08:06.747

看看[我对类似问题的回答](https://stackoverflow.com/questions/574019/calling-null-on-a-class-vs-dispose/574659#574659)。很少需要将变量设置为 null/Nothing。调用 Dispose*是*必要的。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-24T17:06:15.377

你基本上做对了。调用 .Dispose() 后，可以确保连接分配的资源被清理干净。然后，一旦您在代码中声明的 SqlConnection 对象超出范围，GC 也会清理该内存。

如果你想刺激 GC，你可以随时调用它的 .Collect() 方法。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-24T17:05:58.577

您不需要将变量设置为 Nothing，只需处理即可。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-24T17:05:58.857

杰夫阿特伍德[最近](http://www.codinghorror.com/blog/archives/001211.html)有一篇关于这个的博客文章......

除非您不信任垃圾收集器，否则似乎没有必要。我已经完全停止这样做，并且最常使用干净且易于理解的“使用”语法。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-24T17:07:26.747

如果您在反射器中使用“= Nothing”打开代码，您将看到编译器（通常）已删除/优化了该语句。

现在，如果您进行这样的检查。

```
If myObject IsNot Nothing Then
  myObject = Nothing
End If 
```

编译器可能不会对此进行优化，这将导致您持有对 myObject 的引用超过必要的时间，从而导致对象等待的时间超过必要的时间才能获得 GC 资格。

理想情况下，您应该尽快处理该对象并让它不理会。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-24T17:07:55.810

如果该类型有 Dispose 使用它。

如果该类型没有 Dispose，并且它持有大量内存，那么在执行一些缓慢的操作之前将引用设置为空（而不是持有它）可以帮助避免“中年危机”。

然而，编译器在优化这种情况并在块结束之前释放引用方面变得更好。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-24T17:09:06.120

我总是确保通过使用“使用”块来处理它们，但从不将它们设置为空。[MSDN](http://msdn.microsoft.com/en-us/library/system.data.sqlclient.sqlconnection.aspx)也没有要求我们这样做。

我很乐意了解其他人必须明确将 ref 设置为 null 的任何原因。在处置后使用该对象无论如何都会引发“ObjectDisposedException”，因此处置后的意外使用不能成为原因。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-02-24T18:47:22.857

我同意，只要对象实现了 dispose() 方法，就必须调用它，因为当某个对象实现 dispose() 方法时，这意味着他不能指望 GC 来释放他的资源在这种情况下一直在使用（即他正在使用非托管资源），是的，您必须调用 dispose 才能释放这些非托管资源。关于设置对 null 的引用，这不是必需的，但毫无疑问它仍然是一个很好的编程习惯。这里真正有趣的是，任何人都可以使用已处置的对象或没有引用的对象（即死（或者说即将死）的对象可以复活吗？看看以下内容：

公共类员工{

```
 public static Employee emp;

    public string Name { get; set; }
    public string Position { get; set; }

    public override string ToString() {
        return String.Format("{0} works as {1}", Name, Position);
    }

    ~Employee() {
        emp = this;
    }
} 
```

# sql - SQL Server Procedure returns multiple tables - Insert results into tables

> ID：582578
> 
> 赞同：3
> 
> 时间：2009-02-24T17:03:17.147
> 
> 标签：sql, sql-server, tsql, stored-procedures

I have a procedure that returns multiple tables; eg:

```
PROCEDURE Something AS
BEGIN
 SELECT 1,2,3
 SELECT 4,5
 SELECT 9,10,11
END 
```

I would like to take each table from the result and insert it into a series of tables/temp tables - one for each record set.

Is this possible?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-24T17:04:46.270

if you Union the results together they would come out as one result set.

your second query only has 2 columns but this would need to be resolved either way as you put it into a table.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-24T17:08:12.737

You could create the temporary tables within the stored proc and push the records into that. If you are using the same session , the table would be available after the stored proc is finished.

Or you could create the temp tables before hand and call the sp to populate them.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-24T19:19:46.617

查看多个活动结果集 (MARS)。它可能会满足您的需求。

[http://www.sqlteam.com/article/multiple-active-result-sets-mars](http://www.sqlteam.com/article/multiple-active-result-sets-mars)

[http://blogs.msdn.com/sqlprogrammability/archive/2006/05/01/MARSIntroduction1.aspx](http://blogs.msdn.com/sqlprogrammability/archive/2006/05/01/MARSIntroduction1.aspx)

# sql-server-2005 - SSIS 部署实用程序 - 在 MSDB 中指定不同的文件夹

> ID：582587
> 
> 赞同：0
> 
> 时间：2009-02-24T17:04:57.377
> 
> 标签：sql-server-2005, deployment, visual-studio-2005, ssis

我正在通过配置部署实用程序并在 Visual Studio (2005) 中创建清单文件来将我的 SSIS 包部署到 MSDB。

在集成服务中，我创建了一个新文件夹来隔离我的包。创建部署实用程序时，有没有办法为我的包指定此文件夹？

如果没有，安装后如何将包移动到新文件夹中？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-04T15:40:43.923

我认为无法更改部署实用程序中的目标文件夹，因为它可用于 MSDB 和文件系统部署。这将是您在选择 SQL Server 部署后在部署向导中指定的内容 - 但未显示该选项。

部署后，您可以使用 dtutil.exe 实用程序移动包，使用 /move 子命令

```
dtutil /Sources *serverName* /SQL *packageName* /move SQL;*folderName\packageName* 
```

由于您还可以使用它在文件系统和 MSDB 存储之间复制包，DTutil 首先提供了另一种部署文件的方法。

# asp.net - 基类包含字段“X”，但其类型（System.Web.UI.ScriptManager）与控件类型（System.Web.UI.ScriptManager）不兼容

> ID：582596
> 
> 赞同：24
> 
> 时间：2009-02-24T17:06:55.250
> 
> 标签：asp.net, asp.net-ajax

完整的错误是

> 基类包含字段“ScriptManager1”，但其类型（System.Web.UI.ScriptManager）与控件类型（System.Web.UI.ScriptManager）不兼容。

还有其他人遇到这个错误吗？

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2009-08-05T00:34:20.393

我设法通过将其添加到 web.config 来修复它：

```
<runtime>
    <assemblyBinding xmlns="urn:schemas-microsoft-com:asm.v1">
        <dependentAssembly>
            <assemblyIdentity name="System.Web.Extensions" publicKeyToken="31bf3856ad364e35"/>
                <bindingRedirect oldVersion="1.0.0.0-1.1.0.0" newVersion="3.5.0.0"/>
        </dependentAssembly>
        <dependentAssembly>
            <assemblyIdentity name="System.Web.Extensions.Design" publicKeyToken="31bf3856ad364e35"/>
            <bindingRedirect oldVersion="1.0.0.0-1.1.0.0" newVersion="3.5.0.0"/>
        </dependentAssembly>
    </assemblyBinding>
</runtime> 
```

我相信它会强制 .net 运行时使用这些程序集的新版本。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-04-28T04:31:18.677

在将 Web 应用程序从 .NET 2.0 升级到 3.5 时，我遇到了这个问题。

检查您的 web.config 是否为 .NET 3.5 正确设置。我添加/更改了以下内容：

```
 <configSections>
    <sectionGroup name="system.web.extensions" type="System.Web.Configuration.SystemWebExtensionsSectionGroup, System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35">
      <sectionGroup name="scripting" type="System.Web.Configuration.ScriptingSectionGroup, System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35">
        <section name="scriptResourceHandler" type="System.Web.Configuration.ScriptingScriptResourceHandlerSection, System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35" requirePermission="false" allowDefinition="MachineToApplication"/>
        <sectionGroup name="webServices" type="System.Web.Configuration.ScriptingWebServicesSectionGroup, System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35">
          <section name="jsonSerialization" type="System.Web.Configuration.ScriptingJsonSerializationSection, System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35" requirePermission="false" allowDefinition="Everywhere"/>
          <section name="profileService" type="System.Web.Configuration.ScriptingProfileServiceSection, System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35" requirePermission="false" allowDefinition="MachineToApplication"/>
          <section name="authenticationService" type="System.Web.Configuration.ScriptingAuthenticationServiceSection, System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35" requirePermission="false" allowDefinition="MachineToApplication"/>
          <section name="roleService" type="System.Web.Configuration.ScriptingRoleServiceSection, System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35" requirePermission="false" allowDefinition="MachineToApplication"/>
        </sectionGroup>
      </sectionGroup>
    </sectionGroup>
  </configSections>

      <assemblies>
        <!--<add assembly="System.Web.Extensions, Version=1.0.61025.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35"/>-->
        <add assembly="System.Core, Version=3.5.0.0, Culture=neutral, PublicKeyToken=B77A5C561934E089"/>
        <add assembly="System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35"/>
        <add assembly="System.Xml.Linq, Version=3.5.0.0, Culture=neutral, PublicKeyToken=B77A5C561934E089"/>
        <add assembly="System.Data.DataSetExtensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=B77A5C561934E089"/>
      </assemblies>

   <httpHandlers>
        <remove verb="*" path="*.asmx"/>
        <add verb="*" path="*.asmx" type="System.Web.Script.Services.ScriptHandlerFactory, System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35" validate="false"/>
        <add verb="*" path="*_AppService.axd" validate="false" type="System.Web.Script.Services.ScriptHandlerFactory, System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35"/>
        <add verb="GET,HEAD" path="ScriptResource.axd" type="System.Web.Handlers.ScriptResourceHandler, System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35" validate="false"/>
   <httpHandlers>

        <pages enableSessionState="true" validateRequest="true">
            <controls>
        <add tagPrefix="asp" namespace="System.Web.UI" assembly="System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35"/>
        <add tagPrefix="asp" namespace="System.Web.UI.WebControls" assembly="System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35"/>
            </controls>
        </pages>

    <httpModules>
  <add name="ScriptModule" type="System.Web.Handlers.ScriptModule, System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35"/>
    </httpModules> 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2010-06-22T12:05:38.063

添加`<runtime>`上面的部分解决了我们的开发机器和测试服务器上的问题，但不是我们的实时服务器。

事实证明，如果您的`web.config`文件包含 xmlns 属性，`xmlns="http://schemas.microsoft.com/.NetConfiguration/v2.0"`那么您将遇到 GAC 冲突：

```
BAD.web.config
<?xml version="1.0"?>
<configuration xmlns="http://schemas.microsoft.com/.NetConfiguration/v2.0">
etc 
```

但是来自 devt 机器的这个版本很好：

```
GOOD.web.config
<?xml version="1.0"?>
<configuration>
etc 
```

因此，请确保从`web.config`文件顶部删除 2.0 引用。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-10-09T03:56:09.960

我们有一个非常相似的问题。开发平台运行良好，但是一旦将站点部署到测试站点，它就会中断，并显示与上面原始海报相同的消息。我们的控件目录下有子目录，用于将用户控件组合在一起。问题似乎是子目录中的控件试图使用其上方目录中的控件。我们的第一个修复是将顶层控件克隆到子目录。然后我们想到了创建一个并行的兄弟子目录并将控件停在那里。这解决了问题，而不必求助于 (a) 扁平化我们的控件目录结构或 (b) 在各个子目录中克隆相同的控件。

所以我们的解决方案是永远不要从子目录中的用户控件引用父目录中的控件。

我希望这会有所帮助。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-09-15T00:47:40.993

你也可以在 .vbproj 文件中解决这个问题（在我的例子中）。检查这些条目：

```
<Reference Include="System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35">
  <RequiredTargetFramework>3.5</RequiredTargetFramework>
</Reference>
<Reference Include="System.Web.Extensions.Design, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35">
  <RequiredTargetFramework>3.5</RequiredTargetFramework>
</Reference> 
```

这似乎也强制使用 3.5 版本的 DLL。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-02-03T20:42:06.163

这也可以通过将项目引用更改为 System.Web.Extensions 1.0.61025 或其他版本来解决，确保项目引用、Web 配置和 ajax 工具包都匹配相同的版本。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2010-08-06T04:39:43.850

在使用“应用程序可更新”标志从命令行预编译我们的应用程序时，我们遇到了同样的问题：

```
aspnet_compiler.exe -u 
```

删除 -u 标志解决了这个问题。不要问我为什么！

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2011-06-29T18:41:39.793

非常相似的问题。“基类包括字段'WebUserControl1'，但其类型（common_WebUserControl）是......”将标记文件从更改`CodeFile=`为`CodeBehind=`

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2011-11-09T03:22:35.450

就我而言，只是将构建框架从 2.0 切换到 3.5。

这是通过右键单击项目名称（解决方案资源管理器的顶部）并选择“属性页面”来完成的。从那里，选择构建选项并更改框架。

它应该更新 web.config 和所有需要的引用。

高温高压

戴夫

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2012-03-09T14:40:36.317

从 3.5 更新到 4.0 时遇到了类似的问题。在我的例子中，有一个根网站，以及它下面的虚拟 IIS 应用程序目录。

该代码在我的开发和暂存区域中运行良好。

一旦它进入生产服务器，它就崩溃了。即使代码相同。

我的解决方案是删除虚拟目录并重新创建它。确保应用程序池正确，并且 asp.net 版本正确。（我的服务器是带有 IIS6 的 Windows server 2003）。

另一个重要注意事项 - 您不能在同一个应用程序池中运行多个 asp.net 版本。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2013-07-25T18:47:43.230

> “基类包含字段'ScriptManager1'，但其类型（System.Web.UI.ScriptManager）与控件类型（System.Web.UI.ScriptManager）不兼容。”
> 
> 还有其他人遇到这个错误吗？

我曾多次遇到过这种错误，但不是专门针对 scriptmanager 的。基本上，当您在页面上控制一种类型时，就会发生这种情况。假设你闲置了一段时间。但是随后您删除了该控件并将另一个具有相同 ID 的控件放在它的位置，即它可能发生的时候。我相信它与过时的 aspx.designer.cs 有关或由其创建。

解决问题。我要么不得不更改控件 ID 的名称，要么重建解决方案。我想还有另一种方式。我认为如果您有一个 aspx.designer.cs 文件，该文件的名称为 aspx 文件，您也可以在其中更改它。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2018-10-10T16:41:52.253

在这里阅读答案后，我认为问题在于 IIS 如何使用错误的版本编译控件。我通过更新生产 web.config 解决了这个问题：在`<system.web>` 添加 下`<httpRuntime targetFramework="4.5.1" />`

# html - 可以将 HTML 表格设置为百分比最大值或特定像素数吗？

> ID：582604
> 
> 赞同：0
> 
> 时间：2009-02-24T17:07:50.553
> 
> 标签：html

我希望我的 HTML 表格的列是屏幕一定百分比的最大值或最小像素数，所以如果用户有 1024x768 显示器，表格列不会全部被卷起（并且可能需要一些滚动) 如果用户拥有 1920x1600 的屏幕，他们可以获得更多信息。这可能使用 html 表结构吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-24T17:23:42.807

我会考虑使用最小宽度、最大宽度等。这样的东西[会](http://www.quirksmode.org/css/width.html)很棒。

注意：如评论中所述，IE6 不适用于这些选项。

# ruby - 根据其中的条纹对 Ruby 数组进行分块

> ID：582615
> 
> 赞同：8
> 
> 时间：2009-02-24T17:10:16.787
> 
> 标签：ruby

**总结：**这里的基本问题是，我发现，您是否可以将代码块传递给 Ruby 数组，这实际上会将该数组的内容减少到另一个数组，而不是单个值（**注入**的方式）。最简洁的答案是不”。

我正在接受这样说的答案。感谢 Squeegy 提供了一种出色的循环策略，可以从数组中获取条纹。

**挑战：**在不显式循环遍历数组的情况下减少数组元素。
**输入：**从 -10 到 10（0 除外）的所有整数随机排序。
**所需输出：**表示正数或负数条纹的数组。例如，a -3 表示三个连续的负数。A 2 表示两个连续的正数。

示例脚本：

```
original_array = (-10..10).to_a.sort{rand(3)-1}
original_array.reject!{|i| i == 0} # remove zero

streaks = (-1..1).to_a # this is a placeholder.  
# The streaks array will contain the output.
# Your code goes here, hopefully without looping through the array

puts "Original Array:"
puts original_array.join(",")
puts "Streaks:"
puts streaks.join(",")
puts "Streaks Sum:"
puts streaks.inject{|sum,n| sum + n} 
```

示例输出：

```
Original Array:
3,-4,-6,1,-10,-5,7,-8,9,-3,-7,8,10,4,2,5,-2,6,-1,-9
Streaks:
1,-2,1,-2,1,-1,1,-2,5,-1,1,-2
Streaks Sum:
0

Original Array:
-10,-9,-8,-7,-6,-5,-4,-3,-2,-1,1,2,3,4,5,6,7,8,9,10
Streaks:
-10,10
Streaks Sum:
0 
```

注意几点：

*   条纹数组具有交替的正负值。
*   元素 streaks 数组的总和始终为 0（与原始数组的总和一样）。
*   条纹数组的绝对值之和始终为 20。

希望这很清楚！

**编辑：**我确实意识到拒绝这样的结构！实际上是在后台循环遍历数组。我不排除循环，因为我是一个卑鄙的人。只是想学习语言。如果需要显式迭代，那很好。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-02-24T19:48:13.380

好吧，这是一个单行版本，如果你更喜欢的话：

```
streaks = original_array.inject([]) {|a,x| (a.empty? || x * a[-1] < 0 ? a << 0 : a)[-1] += x <=> 0; a} 
```

如果即使注入对你来说太循环了，这里有一个非常愚蠢的方法：

```
 streaks = eval "[#{original_array.join(",").gsub(/((\-\d+,?)+|(\d+,?)+)/) {($1[0..0] == "-" ? "-" : "") + $1.split(/,/).size.to_s + ","}}]" 
```

但是我认为很明显，您最好使用更简单的方法：

```
streaks = []
original_array.each do |x|
  xsign = (x <=> 0)
  if streaks.empty? || x * streaks[-1] < 0
    streaks << xsign
  else
    streaks[-1] += xsign
  end
end 
```

除了更容易理解和维护之外，“循环”版本的运行时间大约是注入版本的三分之二，大约是 eval/regexp 版本的六分之一。

PS：这是另一个可能有趣的版本：

```
a = [[]]
original_array.each do |x|
  a << [] if x * (a[-1][-1] || 0) < 0
  a[-1] << x
end
streaks = a.map {|aa| (aa.first <=> 0) * aa.size} 
```

这使用了两遍，首先构建一个条纹数组的数组，然后将数组的数组转换为一个有符号大小的数组。在 Ruby 1.8.5 中，这实际上比上面的注入版本稍快（尽管在 Ruby 1.9 中它会慢一些），但无聊的循环仍然是最快的。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-02-24T17:49:07.223

```
new_array = original_array.dup
<Squeegy's answer, using new_array> 
```

达达！没有循环遍历原始数组。虽然在 dup 内部它是一个 MEMCPY，但我想它可能被认为是汇编程序级别的循环？

[http://www.ruby-doc.org/doxygen/1.8.4/array_8c-source.html](http://www.ruby-doc.org/doxygen/1.8.4/array_8c-source.html)

**编辑：** ;)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-02-24T17:38:26.250

```
original_array.each do |num|
  if streaks.size == 0
    streaks << num
  else
    if !((streaks[-1] > 0) ^ (num > 0))
      streaks[-1] += 1
    else
      streaks << (num > 0 ? 1 : -1)
    end
  end
end 
```

这里的神奇之处在于`^`xor 运算符。

```
true ^ false  #=> true
true ^ true   #=> false
false ^ false #=> false 
```

因此，如果数组中的最后一个数字与正在处理的数字在零的同一侧，则将其添加到条纹中，否则将其添加到条纹数组中以开始新的条纹。请注意，正弦`true ^ true`返回`false`我们必须否定整个表达式。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-03-26T04:26:05.537

更多的字符串滥用，格伦麦克唐纳，只是不同：

```
runs = original_array.map do |e|
  if e < 0
    '-'
  else
    '+'
  end
end.join.scan(/-+|\++/).map do |t|
  "#{t[0..0]}#{t.length}".to_i
end

p original_array
p runs
# => [2, 6, -4, 9, -8, -3, 1, 10, 5, -7, -1, 8, 7, -2, 4, 3, -5, -9, -10, -6]
# => [2, -1, 1, -2, 3, -2, 2, -1, 2, -4] 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2016-02-17T01:49:00.537

从 Ruby 1.9 开始，有一种更简单的方法可以解决这个问题：

```
original_array.chunk{|x| x <=> 0 }.map{|a,b| a * b.size } 
```

[Enumerable.chunk](http://ruby-doc.org/core-2.3.0/Enumerable.html#method-i-chunk)将通过块的输出将数组的所有连续元素组合在一起：

```
>> original_array.chunk{|x| x <=> 0 }
=> [[1, [3]], [-1, [-4, -6]], [1, [1]], [-1, [-10, -5]], [1, [7]], [-1, [-8]], [1, [9]], [-1, [-3, -7]], [1, [8, 10, 4, 2, 5]], [-1, [-2]], [1, [6]], [-1, [-1, -9]]] 
```

这几乎正​​是 OP 所要求的，除了需要对结果组进行计数以获得最终的条纹数组。

# vb.net - EditingControlShowing 事件触发多次

> ID：582625
> 
> 赞同：1
> 
> 时间：2009-02-24T17:13:14.360
> 
> 标签：vb.net, visual-studio-2008, datagridview, event-handling, editcontrol

我在 VB.Net 2008 中有一个连接到 Access DB 表的 DGV。DGV 不是只读的，而是充满了只读列，除了一个包含组合框的列。组合框允许用户选择特定行的结果，然后程序根据组合框中选择的项目将预先计算的值复制到“利润”列中。然后用户点击保存按钮和数据库更新（当前通过 XSD 中的 SQL 方法）。

到目前为止很容易。

这是代码。

```
Private Sub DGUserBets_EditingControlShowing(ByVal sender As Object, ByVal e As System.Windows.Forms.DataGridViewEditingControlShowingEventArgs) Handles DGUserBets.EditingControlShowing

    Dim combo As ComboBox = CType(e.Control, ComboBox)

    If (combo IsNot Nothing) Then

         // Remove an existing event-handler, if present, to avoid 
         // adding multiple handlers when the editing control is reused.
        RemoveHandler combo.SelectedIndexChanged, _
            New EventHandler(AddressOf DGUBStake_SelectedIndexChanged)

        // Add the event handler. 
        AddHandler combo.SelectedIndexChanged, _
            New EventHandler(AddressOf DGUBStake_SelectedIndexChanged)

    End If

End Sub

Private Sub DGUBStake_SelectedIndexChanged(ByVal sender As Object, ByVal e As EventArgs)

    Dim myStatus As ComboBox = CType(sender, ComboBox)

    Dim row = DGUserBets.CurrentRow

    Select Case myStatus.SelectedIndex
        Case 0
            row.Cells("DGUBProfit").Value = 0
            // pending. no action
        Case 1
            row.Cells("DGUBProfit").Value = row.Cells("DGUBIfWin").Value
            // win
        Case 2
            // loses
            row.Cells("DGUBProfit").Value = row.Cells("DGUBIfLose").Value
        Case 3
            // void
            row.Cells("DGUBProfit").Value = 0
    End Select

End Sub 
```

我遇到的问题是，如果用户从组合框中选择了所需的结果但没有按 Enter，而只是将鼠标悬停在不同的组合框上以再次选择不同行的结果，则第一个事件处理程序未断开连接因此事件会触发多次。然后，这会导致各种默认 MsgBox 错误，并在用户尝试将所有更改提交到 DB/exit 程序等时引发问题。

我需要做什么？我是否需要 .EndEdit 在适当的地方强制该行保存更改？我应该在哪里称呼它？

谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-24T17:22:57.880

快速浏览一下代码会提出这个问题：如果您在删除现有的 EventHandler 时创建一个新的 EventHandler，它是同一个吗？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-24T17:29:08.223

我遇到了类似的问题，`CellLeave`如果要退出的单元格是您要查找的单元格（IE `e.ColumnIndex = myEditableColumn.Index`），请添加一个处理程序，然后调用 gv.EndEdit()

此外，我建议为分配和删除创建处理程序成员变量，因为它似乎比总是说 Remove New 和 Add New 更好。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-24T17:57:32.320

CKRet/Quintin，感谢您的快速回复。

快速尝试使用此代码似乎更好，断点和单步执行代码似乎可以正确触发事件。我对 .NET 相当陌生，因为我做的最后一个真正的 VB 编程是 VB6，所以我不确定这是否是解决问题的最优雅的方法。

另外需要注意的是，当 LastEventHandler = Nothing 时，调用 RemoveHandler 不会抛出异常，这非常好。

也许我应该向 MS 建议他们应该更新那篇文章。

```
Private Sub DGUserBets_EditingControlShowing(ByVal sender As Object, ByVal e As System.Windows.Forms.DataGridViewEditingControlShowingEventArgs) Handles DGUserBets.EditingControlShowing

    Dim combo As ComboBox = CType(e.Control, ComboBox)

    Static LastEventHandler As EventHandler

    If (combo IsNot Nothing) Then

        // Remove an existing event-handler, if present, to avoid 
        // adding multiple handlers when the editing control is reused.
        RemoveHandler combo.SelectedIndexChanged, _
            LastEventHandler

        LastEventHandler = New EventHandler(AddressOf DGUBStake_SelectedIndexChanged)

        // Add the event handler. 
        AddHandler combo.SelectedIndexChanged, _
            LastEventHandler

    End If

End Sub 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-24T18:30:42.180

正如 CKRet 所建议的，更简单的代码似乎也能很好地工作：

```
 Dim combo As ComboBox = CType(e.Control, ComboBox)

    If (combo IsNot Nothing) Then

       RemoveHandler combo.SelectedIndexChanged, AddressOf DGUBStake_SelectedIndexChanged

       AddHandler combo.SelectedIndexChanged, AddressOf DGUBStake_SelectedIndexChanged

    End If 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-14T19:20:01.223

我知道这是一篇过时的帖子，但是在解决同样的问题半天后，我找到了另一种方法来解决这个问题，所以我认为它值得分享。

添加第二个处理程序来处理组合框的离开事件，然后删除选择值更改的处理程序。看起来工作起来很流畅，并且与我发现的另一个选项不同，它给出了所需的结果操作（与在实际处理事件中删除值更改处理程序不同，如果您从同一个组合框中重新选择则不会触发）

```
Private LastEventHandler As EventHandler = AddressOf Me.ComboBoxValueChanged

Private Sub dgvThisDatagrid_EditingControlShowing(sender As Object, e As System.Windows.Forms.DataGridViewEditingControlShowingEventArgs) Handles dgvOutstandingReminders.EditingControlShowing

    If TypeOf (e.Control) Is ComboBox Then
        Dim cboThisComboBox = DirectCast(e.Control, ComboBox)

        AddHandler cboThisComboBox.SelectedValueChanged, LastEventHandler

        AddHandler cboThisComboBox.Leave, AddressOf RemoveValueChangedHandler

    End If

End Sub

Private Sub ComboBoxValueChanged(ByVal sender As Object, ByVal e As System.EventArgs)

    If TypeOf (sender) Is ComboBox Then
        Dim cboThisComboBox = DirectCast(sender, ComboBox)

        MessageBox.Show("Value = " & cboThisComboBox.SelectedValue.ToString() & Environment.NewLine & "Text = " & cboThisComboBox.Text) ' Display index
    End If

End Sub

Private Sub RemoveValueChangedHandler(ByVal sender As Object, ByVal e As System.EventArgs)

    If TypeOf (sender) Is ComboBox Then
        Dim cboThisCombobox = DirectCast(sender, ComboBox)

        RemoveHandler cboThisCombobox.SelectedValueChanged, LastEventHandler
    End If

End Sub 
```

# c# - C# .NET 3.5：如何调用事件处理程序并等待它完成

> ID：582627
> 
> 赞同：4
> 
> 时间：2009-02-24T17:13:43.487
> 
> 标签：c#, .net, asynchronous, events, worker

我有一个包含一个工作线程的类，它从一个循环中的队列接收数据。

应用程序的另一部分从此类接收一个事件，该类为每个队列项引发该事件。

这些事件是异步触发的，因此在繁忙时间应用程序的其他部分可以同时处理多个事件。

这应该没问题，但我们发现了一个可能导致问题的场景。

在解决主要问题时，我们需要一个快速的解决方案。该框架是否提供了一种简单的方法，我可以强制工作线程在处理每个事件时等待（因此它们是按顺序处理的）？如果没有，实现这一点的最简单方法是什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-24T17:26:16.203

一个简单的答案是 lock() 在事件处理程序中的单个对象上。所有的tads都将等待获得锁。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-24T17:19:18.480

除非我不理解您的问题，否则 ManualResetEvent 类可能会对您有所帮助[。](http://msdn.microsoft.com/en-us/library/system.threading.manualresetevent(VS.71).aspx)您可以使用它来阻止下一个事件的触发，直到最后一个事件完成。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-24T17:19:16.563

我的猜测是，您只想通过引发事件并直接调用方法来避免触发操作。

AFAIK 事件将是异步的，我不知道有任何“简单”的方法来改变它。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-25T22:31:36.770

原来还有另一个答案。您可以将以下属性添加到方法中。

```
[System.Runtime.CompilerServices.MethodImpl(System.Runtime.CompilerServices.MethodImplOptions.Synchronized)] 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-24T17:18:43.070

没有通用的方法。

最后，处理程序需要提供一种跟踪机制。

如果您使用 BeginInvoke，而不是直接引发事件，则可以使用包装器，在其中同步调用真实事件处理程序，然后异步引发包装器。包装器可以维护一个计数器（具有互锁操作）或根据您的需要设置一个事件。

就像是：

```
TheDelegate realHandler = theEvent;
var outer = this;
ThreadPool.QuereUserWorkItem(x => {
  // Set start of handler
  realHandler(outer, eventArgs);
  // Set handler finished
}; 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-24T17:18:54.300

所有接收队列读取工作线程引发的事件的事件处理程序都在队列读取工作线程中调用。只要事件处理程序不产生自己的线程，您就应该能够通过在队列读取工作线程上调用 Thread.Join() 来等待事件处理程序完成。

# django - 使用 mod_python 设置 Django，使用 Alias 在 SuSE 上设置 Apache

> ID：582631
> 
> 赞同：3
> 
> 时间：2009-02-24T17:14:30.070
> 
> 标签：django, apache, apache2, mod-python

我在让 Django 使用我的 Apache 配置时遇到了重大问题。我没有创建服务器，所以我对服务器的工作方式没有太多的余地。本质上存在三个虚拟主机：

board.site.org、students.site.org 和 Insider.site.org

Insider.site.org 是我关心的主要网站。我负责它下面的一个小站点（最好是 insider.site.org/tech）。我决定将我的文件与原始目录分开，以免弄乱那里的东西（因为已经有一个非 python 站点）。无论如何，我的虚拟主机是在 /etc/apache2/vhosts.d/ 的单独文件中定义的

这是 insider.site.org 的配置的样子

Insider.conf

```
LoadModule python_module /usr/lib64/apache2/mod_python.so

<VirtualHost 10.10.1.1:80>
ServerName insider.site.org
DocumentRoot /media/nss/VWEB/docs
   <Directory /media/nss/VWEB/docs>
      Options Indexes Multiviews
      AllowOverride None
      Order Allow,Deny
      #Allow from 10.11.0.78
      Allow from all
   </Directory>

Alias /tech  /srv/www/Tech

   <Directory /srv/www/Tech>
      SetHandler python-program
      PythonPath "['/srv/www/Tech'] + sys.path"
      PythonHandler django.core.handlers.modpython
      SetEnv DJANGO_SETTINGS_MODULE Tech.settings
      PythonDebug On
   </Directory>

Alias /media /srv/www/Media

   <Directory /srv/www/Media>
      SetHandler None
   </Directory>

</VirtualHost> 
```

*   请注意，当说 site.org 时，我指的是我的网站，而不是实际的“site.org”网址。

现在，这似乎对我来说应该是正确的，但由于某种原因，访问[http://insider.site.org/tech/](http://insider.site.org/tech/)给了我这个错误：

> Mod_python 错误：“PythonHandler mod_python.publisher”
> 
> 回溯（最近一次通话最后）：
> 
> 文件“/usr/lib64/python2.4/site-packages/mod_python/apache.py”，第 299 行，在 HandlerDispatch 结果 = object(req)
> 
> 文件“/usr/lib64/python2.4/site-packages/mod_python/publisher.py”，第 98 行，在处理程序路径 = [路径]）
> 
> 文件“/usr/lib64/python2.4/site-packages/mod_python/apache.py”，第 454 行，在 import_module f, p, d = imp.find_module(parts[i], path)
> 
> ImportError：没有名为索引的模块

而[http://insider.site.org/tech](http://insider.site.org/tech)（没有尾部正斜杠）会导致 403 错误。我在这个目录中确实有 Django，但它根本没有被执行（我在 tech 文件夹下的所有目录中都有 _ *init* _.py，这是我自己的个人计算机的副本（它从 django 中运行）测试服务器））所以我认为这不是问题。这根本行不通:-(

任何帮助表示赞赏，谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-24T18:43:01.353

对于您的第一个问题，您确定在您指定的 PythonPath 中有 Django 吗？在我的服务器上，我的 PythonPath 中的列表包括包含顶级 django 目录的目录，该目录本身包含 bin、contrib、admin、core 等目录，此外还有 __init__.py。（还要确保您的 Apache 用户对这些文件和目录具有读取和执行权限，尽管我确信这很明显。）这是我的设置：

```
<Location "/myapp">
   SetHandler python-program
   PythonHandler django.core.handlers.modpython
   SetEnv DJANGO_SETTINGS_MODULE LogFileAnalyzer.settings
   PythonDebug on
   PythonPath "['/srv/www/dir_containing_django_dir', '/srv/www/myapp_dir'] + sys.path"
</Location> 
```

请注意，我在这里使用位置而不是目录，因此您的里程可能会有所不同。

对于您的第二个问题，这听起来像是 mod_rewrite 的问题。见[这里](http://httpd.apache.org/docs/2.0/misc/rewriteguide.html)。您可以通过定义重写规则让服务器自动附加您需要的斜线：

```
RewriteEngine  on
RewriteBase    /~quux/
RewriteRule    ^foo$  foo/  [R] 
```

希望有帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-05T08:31:06.633

`Alias /tech /srv/www/Tech` 应删除，并 `<Directory /srv/www/Tech>`应转换为位置。

请记住，您并不是要让 Apache 提供您的 Python 文件，而是告诉它在到达特定位置时启动某个 Python 进程。

另外，我是否可以建议您使用子域，而不是将 Django 应用程序放在主域的“文件夹”中。在我看来，它倾向于简化事情。

也供您考虑的是[`mod_wsgi`](http://code.google.com/p/modwsgi/)。我最近开始将它用于我的 Django 应用程序，它们在性能和稳定性方面取得了巨大的飞跃:)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-05T13:21:07.137

可能对 mod_python 问题没有帮助，但实际上，mod_python 是部署 Django 的最差方式（实际上是部署任何类型 Python 的最差方式）。

请考虑至少使用 mod_wsgi，它对性能和其他一些原因更好。此外，您将在 freenode 上的#django 上获得该 mod 开发人员的出色支持。

Spawning/FastCGI 甚至更好，因为您根本不用 Apache。

# asp.net - asp.net: explicit localization & combining strings

> ID：582635
> 
> 赞同：0
> 
> 时间：2009-02-24T17:16:13.217
> 
> 标签：asp.net, visual-studio-2008, localization

This seems like it should be a simple thing to do, but I can't figure it out.

I have a localized resource that I'm using in two places - one as a col. header in a datagrid, and then as a descriptor beside a field when the user edits a row.

The text of the label looks like:

```
Text="<%$Resources:Global,keyName%>" 
```

However, I'd like to add a trailing : to the label - except if I change the above to

```
Text="<%$Resources:Global,keyName%>:" 
```

then the : is the only thing that shows up! I've tried it with simple strings, so there's nothing special about the colon char that causes this.

Surely I don't have to have 2 different resources?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-24T17:19:33.893

Have you tried Text="<%$Resources:Global,keyName%>" + ":" ? You'd basically be concatenating two strings. Or treat them as two strings

```
StringBuilder t;
t.append(<%$Resources:Global,keyName%>)
t.append(":")
Text = t; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-24T18:10:10.637

假设您出于样式原因需要将 : 保持在一起，请将标签替换为跨度：<%=Resources.Global.keyName %>：

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-24T18:34:29.330

好吧，有时在其他人看到之前，显而易见的事情并不那么明显：

```
Text="<%$Resources:Global,keyName%>" /> : 
```

只需将 : 移到标签标签之外，一切都很好。

# sharepoint - Sharepoint 和自定义登录可能是 FBA

> ID：582636
> 
> 赞同：0
> 
> 时间：2009-02-24T17:16:17.240
> 
> 标签：sharepoint, sharepoint-2007, moss

我们有一个面向 moss 的发布网站，我们需要限制来自另一个特定网站的人访问这个网站（使用 http 标头引用属性）。

这必须是一个自动过程（用户不应该点击“登录”或类似的东西）。

这该怎么做？非常感谢任何建议。

我真的不想尝试编写自定义会员提供程序；这似乎是一项巨大的工作。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-25T04:37:15.857

我认为 HTTP-REFERRER 不够可靠，不能用作安全的基础。修改或伪造 HTTP-REFERRER 服务器变量是非常可能/容易的。有些浏览器甚至不发送它。

如果您想在 SharePoint 中完成这一切，我认为最好的办法是在母版页上安装一个服务器控件，该控件检查确定请求的来源（令您满意）并在访问者来自违规位置时重定向.

另一种方法可能是实现 ISAPI 过滤器或 HTTP 模块来验证请求来源。您可以让这个模块在 MOSS 过滤器和模块之前运行。这对 SharePoint 的影响为 0。

基本上，我认为首先要做的是验证 HTTP-REFERRER 是否足够强大，可以满足您的安全需求。我更喜欢后一种选择，但我认为前者会更容易实现。

# sql - 相当于 COUNTIF 聚合函数的 Sql Server

> ID：582637
> 
> 赞同：179
> 
> 时间：2009-02-24T17:17:19.047
> 
> 标签：sql, sql-server-2005

我正在使用一个`GROUP BY`子句构建一个查询，该子句需要能够仅根据特定条件计算记录（例如，仅计算某个列值等于 1 的记录）。

```
SELECT  UID, 
        COUNT(UID) AS TotalRecords, 
        SUM(ContractDollars) AS ContractDollars,
        (COUNTIF(MyColumn, 1) / COUNT(UID) * 100) -- Get the average of all records that are 1
FROM    dbo.AD_CurrentView
GROUP BY UID
HAVING  SUM(ContractDollars) >= 500000 
```

该`COUNTIF()`行显然失败了，因为没有调用本机 SQL 函数`COUNTIF`，但这里的想法是确定 MyColumn 的值为“1”的所有行的百分比。

关于如何在 MS SQL 2005 环境中正确实现这一点的任何想法？

* * *

## 回答 #1

> 赞同：378
> 
> 时间：2009-02-24T17:20:23.410

您可以将`SUM`(not `COUNT`!) 与`CASE`语句结合使用，如下所示：

```
SELECT SUM(CASE WHEN myColumn=1 THEN 1 ELSE 0 END)
FROM AD_CurrentView 
```

注意：在我自己的测试`NULL`中不是问题，尽管这可能取决于环境。您可以处理空值，例如：

```
SELECT SUM(CASE WHEN ISNULL(myColumn,0)=1 THEN 1 ELSE 0 END)
FROM AD_CurrentView 
```

* * *

## 回答 #2

> 赞同：57
> 
> 时间：2009-02-24T17:38:29.370

我通常会按照 Josh 的建议去做，但集思广益并测试了一个我觉得想分享的稍微有点做作的替代方案。

您可以利用 COUNT(ColumnName) 不计算 NULL 的事实，并使用以下内容：

```
SELECT COUNT(NULLIF(0, myColumn))
FROM AD_CurrentView 
```

NULLIF - 如果传入的两个值相同，则返回 NULL。

优点：表达您对 COUNT 行的意图，而不是使用 SUM() 表示法。缺点：不清楚它是如何工作的（“魔法”通常很糟糕）。

* * *

## 回答 #3

> 赞同：25
> 
> 时间：2010-03-03T23:25:18.893

我会使用这种语法。它与 Josh 和 Chris 的建议相同，但优点是它符合 ANSI 并且不依赖于特定的数据库供应商。

```
select count(case when myColumn = 1 then 1 else null end)
from   AD_CurrentView 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2017-07-25T11:04:21.193

怎么样

```
SELECT id, COUNT(IF status=42 THEN 1 ENDIF) AS cnt
FROM table
GROUP BY table 
```

短于`CASE`:)

之所以有效，是因为`COUNT()`不计算 null 值，并且`IF`/`CASE`在不满足条件且不存在`ELSE`.

我认为这比使用`SUM()`.

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2015-10-29T15:54:59.897

加上乔希的回答，

```
SELECT COUNT(CASE WHEN myColumn=1 THEN AD_CurrentView.PrimaryKeyColumn ELSE NULL END)
FROM AD_CurrentView 
```

对我来说效果很好（在 SQL Server 2012 中），无需将“计数”更改为“总和”，并且相同的逻辑可移植到其他“条件聚合”。例如，基于条件求和：

```
SELECT SUM(CASE WHEN myColumn=1 THEN AD_CurrentView.NumberColumn ELSE 0 END)
FROM AD_CurrentView 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2014-09-05T14:34:36.107

不是特定于产品的，但 SQL 标准提供

```
SELECT COUNT() FILTER WHERE <condition-1>,
       COUNT() FILTER WHERE <condition-2>, ...
  FROM ... 
```

以此目的。或者与它非常相似的东西，我完全不知道。

当然，供应商更愿意坚持使用他们的专有解决方案。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2014-10-30T14:46:46.780

为什么不这样？

```
SELECT count(1)
FROM AD_CurrentView
WHERE myColumn=1 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2017-11-27T05:41:57.730

在我的案例中，我必须使用 COUNTIF() 作为我的 SELECT 列的一部分，并模拟每个项目出现在我的结果中的次数的百分比。

所以我用这个...

```
SELECT COL1, COL2, ... ETC
       (1 / SELECT a.vcount 
            FROM (SELECT vm2.visit_id, count(*) AS vcount 
                  FROM dbo.visitmanifests AS vm2 
                  WHERE vm2.inactive = 0 AND vm2.visit_id = vm.Visit_ID 
                  GROUP BY vm2.visit_id) AS a)) AS [No of Visits],
       COL xyz
FROM etc etc 
```

当然，您需要根据您的显示要求格式化结果。

* * *

## 回答 #9

> 赞同：-2
> 
> 时间：2018-12-10T16:01:52.223

```
SELECT COALESCE(IF(myColumn = 1,COUNT(DISTINCT NumberColumn),NULL),0) column1,
COALESCE(CASE WHEN myColumn = 1 THEN COUNT(DISTINCT NumberColumn) ELSE NULL END,0) AS column2
FROM AD_CurrentView 
```

# perl - 如何在不阻塞的情况下轮询 Web 请求？

> ID：582651
> 
> 赞同：3
> 
> 时间：2009-02-24T17:20:48.680
> 
> 标签：perl

我有两个网络请求，我需要轮询它们以了解它们何时返回。理想情况下，我不想在一个紧密的循环中继续测试它们。我想释放 CPU，以便其他进程可以执行。

我目前正在使用 Perl 的 Time::HiRes::sleep(0.100) 函数在测试 Web 请求是否返回之前释放 CPU。

在负载测试期间，我可以看到睡眠持续时间“延长”。理想情况下，我想确保遵守睡眠持续时间但释放 CPU。我应该调用不同的函数来实现这一点吗？

我在 Linux 2.6 上编写 Perl。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-02-24T17:24:27.237

与其轮询，不如看看您是否无法获取文件描述符并进行选择调用。

然后，一旦发生任何事情，您就会重新获得控制权，而完全不占用 CPU。

web-request 中的某处将是一些套接字，并且附加到套接字的将是您可以在 select 中使用的文件描述符。

在任何情况下，您的程序都可以在任何时间点被中断；如果这是一个真正的问题，您需要一个实时操作系统，但由于您正在处理网络请求，我怀疑您是否需要那种级别的响应能力。

事实上，您想要的是一个高级接口，它为您执行选择调用。正如评论中所建议的那样：[http](http://search.cpan.org/dist/HTTP-Async/) ://search.cpan.org/dist/HTTP-Async/看起来它会完全满足您的需求。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-24T18:27:48.177

听起来你真的想要一个事件循环。两者之上都有 [POE](http://search.cpan.org/perldoc?POE)、 [EV](http://search.cpan.org/perldoc?EV)和[抽象层](http://search.cpan.org/perldoc?AnyEvent)。

无论哪种方式，都不要自己实现。这个轮子已经被发明出来了。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-24T17:31:00.340

我认为在常规 Linux 上无法保证睡眠持续时间。这几乎就是“实时”操作系统的重点，而普通的 Linux 不是“实时”。

我同意@Douglas Leeder：使用选择调用让内核在发生变化时通知您。您还可以通过 select 调用模拟亚秒级睡眠，但 Time::HiRes 是一个更简洁的界面（您仍然无法避免延长等待时间）。

# javascript - 表明我的 JS 脚本已加载的最佳方式

> ID：582652
> 
> 赞同：3
> 
> 时间：2009-02-24T17:21:19.710
> 
> 标签：javascript, dom-events, unobtrusive-javascript

我有一个 JS 脚本，它将托管在我的服务器上，其他人将嵌入到他们的 html 中，即

```
...<code for http://yoursite.example.com />
<script type="text/javascript" src="http://mysite.example.com/awesome.js" />
...<code for http://yoursite.example.com /> 
```

我的脚本声明了一个具有一堆可用作 Javascript 的属性的对象`Object()`，即

```
<script type="text/javascript">
//From http://mysite.example.com/awesome.js
alert(Awesome.Name);
</script> 
```

由于加载时间差异，我似乎需要表明我的脚本中的“真棒”对象已准备好。我需要它独立存在，因此不依赖于特定的 JS 框架。

我是否需要发布我自己的自定义 JS 事件，或者我的脚本已加载这一简单事实是否被现有页面级事件之一捕获？我还应该怎么做？

更新：作为参考，如果我将 JS 包含在从 运行的 HTML 页面中`http://mysite.example.com`，则 Awesome 对象可用并已填充。当 JS 文件包含在另一个域中时，该对象在运行时未定义。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-24T17:37:34.473

标签的javascript内容`<script>`是按程序执行的，所以这个

```
<script type="text/javascript" src="http://mysite.com/awesome.js" />
<script type="text/javascript">
    alert(Awesome.Name);
</script> 
```

`Awesome.Name`如果在任何*以前*的脚本标签中找到，只会提醒内容。

要了解页面上是否所有内容都已完全加载，您必须使用 DOMContentLoaded（对于 firefox）和“onreadystatechange”（对于 ie）。如果您不关心检查 DOM，您也可以简单地检查**窗口对象上的***加载*事件（可能更容易）。

 **```
if ( document.addEventListener ) {
    document.addEventListener( "DOMContentLoaded", function(){
         doSomething();   
    }, false );
} else if ( document.attachEvent ) { // IE        
    document.attachEvent("onreadystatechange", function(){
        if ( document.readyState === "complete" ) {
            doSomething();
        }
    });
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-24T17:27:43.517

如果您的脚本需要在实例化对象之前加载 DOM，您应该查看一些框架并了解它们如何处理此问题，然后在您的代码中实现它。如果您不需要加载 DOM，那么我会让用户根据加载时间担心使用对象的时间。通常，一旦您的脚本被加载，您的对象应该可以使用，这意味着该对象应该在`script`包含它的标签之后立即可用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-02T07:17:44.430

在全局范围内可访问的任何内容都可以通过该`window`范围进行访问。因此，你可以使用这个：

```
if (window["Awesome"] != null) { /* do something */ } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-24T17:32:04.910

一种）。你意识到脚本请求被阻塞了吗？您对此是否满意，或者您想解决这个问题，因为您的问题的答案取决于它。

乙）。赤裸裸的防弹机制和简单的机制是调用可以保证页面上存在的指定方法。让该方法的实现由用户来做。存在许多其他方法，但我们需要知道代码的生命周期和意图到底是什么来推荐任何东西。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-01T15:29:48.647

你可以像这样简单地使用它：

```
<script type="text/javascript" src="myfunction.js"></script>
<script type="text/javascript" src="iwannaloadthis.js?onload=executeThis"></script> 
```

请记住，如前所述，执行 this 必须在 myfunction.js 中定义（或在尝试加载 iwannaloadthis.js 之前）。

希望这可以帮助！！

# r - 在 R 中处理时间的最佳做法是什么？

> ID：582653
> 
> 赞同：14
> 
> 时间：2009-02-24T17:21:30.490
> 
> 标签：r, datetime

我正在使用调查数据集。它有两个字符串`vectors`,`start`和`finish`，分别表示采访开始和结束的时间。

它们是`character`看起来像：`"9:24 am"`、、`"12:35 pm"`等等的字符串。我正在尝试根据这两个计算面试的持续时间。这样做的最佳方法是什么？

我知道，对于日期，有很多`classe`s 或`function`s，如`as.date()`、`as.Date()`、`chron()`或`as.POSIXct()`。所以我一直在寻找类似的东西`as.time()`，但找不到。我是否应该只附加一个虚构的日期并将整个内容转换为`POSIX()`date-time `class`，然后使用`difftime()`？

处理时间的最佳做法是`R`什么？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-02-25T21:28:11.730

您需要使用`strptime()`将字符串转换为日期。例如：

```
strptime("9:24 am",format="%I:%M %p") 
```

然后，您可以通过将一个与另一个分开来消除差异：

```
strptime("9:24 am",format="%I:%M %p")-strptime("12:14 am",format="%I:%M %p")
Time difference of 9.166667 hours 
```

您可以存储它，然后`as.numeric()`如果您只想输出数字，则可以执行操作，否则您可以传递时间对象。

希望这可以帮助！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-25T02:51:45.920

一种选择是使用正则表达式。如果您不熟悉它们，它们用于使用模式解析字符串。我会研究正则表达式，然后[这里是 r 中的函数](http://www.regular-expressions.info/rlanguage.html)

希望能帮助到你

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-06-27T07:41:50.320

最佳实践是使用 lubridate 包

[https://www.rdocumentation.org/packages/lubridate/versions/1.5.6/topics/hm](https://www.rdocumentation.org/packages/lubridate/versions/1.5.6/topics/hm)

```
hm(c("09:10", "09:02", "1:10"))
## [1] "9H 10M 0S" "9H 2M 0S"  "1H 10M 0S 
```

然后使用 difftime 来区分上面创建的日期时间格式 [https://stat.ethz.ch/R-manual/R-devel/library/base/html/difftime.html](https://stat.ethz.ch/R-manual/R-devel/library/base/html/difftime.html)

```
difftime(time1, time2, tz,
         units = c("auto", "secs", "mins", "hours",
                   "days", "weeks")) 
```

# postgresql - 如何发现 PostgreSQL 数据库的结构？

> ID：582657
> 
> 赞同：43
> 
> 时间：2009-02-24T17:22:27.913
> 
> 标签：postgresql

我需要编写一个脚本，该脚本将从我不知道其结构的 PostgreSQL 数据库中输出数据。什么查询将返回数据库中所有表的名称？什么查询会列出表中所有列的名称？

* * *

## 回答 #1

> 赞同：53
> 
> 时间：2012-05-29T02:49:45.477

数据库查询工具**`psql`**是 PostgreSQL 发行版的一部分，提供*表描述*功能。

```
# psql postgres postgres
psql (9.1.0)
Type "help" for help.

postgres=# -- list all tables:
postgres=# \d
           List of relations
 Schema |   Name    | Type  |  Owner   
--------+-----------+-------+----------
 public | my_table  | table | postgres
 public | my_table2 | table | postgres
(2 rows)

postgres=# -- describe table:
postgres=# \d my_table
   Table "public.my_table"
 Column |  Type   | Modifiers 
--------+---------+-----------
 col1   | integer | 
 col2   | text    | 
```

* * *

您可以获得的其余**psql**`\?`命令：

```
postgres=#   \?
General
  \copyright             show PostgreSQL usage and distribution terms
  \g [FILE] or ;         execute query (and send results to file or |pipe)
  \h [NAME]              help on syntax of SQL commands, * for all commands
  \q                     quit psql

Query Buffer
  \e [FILE] [LINE]       edit the query buffer (or file) with external editor
  \ef [FUNCNAME [LINE]]  edit function definition with external editor
  \p                     show the contents of the query buffer
  \r                     reset (clear) the query buffer
  \s [FILE]              display history or save it to file
  \w FILE                write query buffer to file

Input/Output
  \copy ...              perform SQL COPY with data stream to the client host
  \echo [STRING]         write string to standard output
  \i FILE                execute commands from file
  \o [FILE]              send all query results to file or |pipe
  \qecho [STRING]        write string to query output stream (see \o)

Informational
  (options: S = show system objects, + = additional detail)
  \d[S+]                 list tables, views, and sequences
  \d[S+]  NAME           describe table, view, sequence, or index
  \da[S]  [PATTERN]      list aggregates
  \db[+]  [PATTERN]      list tablespaces
  \dc[S]  [PATTERN]      list conversions
  \dC     [PATTERN]      list casts
  \dd[S]  [PATTERN]      show comments on objects
  \ddp    [PATTERN]      list default privileges
  \dD[S]  [PATTERN]      list domains
  \det[+] [PATTERN]      list foreign tables
  \des[+] [PATTERN]      list foreign servers
  \deu[+] [PATTERN]      list user mappings
  \dew[+] [PATTERN]      list foreign-data wrappers
  \df[antw][S+] [PATRN]  list [only agg/normal/trigger/window] functions
  \dF[+]  [PATTERN]      list text search configurations
  \dFd[+] [PATTERN]      list text search dictionaries
  \dFp[+] [PATTERN]      list text search parsers
  \dFt[+] [PATTERN]      list text search templates
  \dg[+]  [PATTERN]      list roles
  \di[S+] [PATTERN]      list indexes
  \dl                    list large objects, same as \lo_list
  \dL[S+] [PATTERN]      list procedural languages
  \dn[S+] [PATTERN]      list schemas
  \do[S]  [PATTERN]      list operators
  \dO[S+] [PATTERN]      list collations
  \dp     [PATTERN]      list table, view, and sequence access privileges
  \drds [PATRN1 [PATRN2]] list per-database role settings
  \ds[S+] [PATTERN]      list sequences
  \dt[S+] [PATTERN]      list tables
  \dT[S+] [PATTERN]      list data types
  \du[+]  [PATTERN]      list roles
  \dv[S+] [PATTERN]      list views
  \dE[S+] [PATTERN]      list foreign tables
  \dx[+]  [PATTERN]      list extensions
  \l[+]                  list all databases
  \sf[+] FUNCNAME        show a function's definition
  \z      [PATTERN]      same as \dp

Formatting
  \a                     toggle between unaligned and aligned output mode
  \C [STRING]            set table title, or unset if none
  \f [STRING]            show or set field separator for unaligned query output
  \H                     toggle HTML output mode (currently off)
  \pset NAME [VALUE]     set table output option
                         (NAME := {format|border|expanded|fieldsep|footer|null|
                         numericlocale|recordsep|tuples_only|title|tableattr|pager})
  \t [on|off]            show only rows (currently off)
  \T [STRING]            set HTML <table> tag attributes, or unset if none
  \x [on|off]            toggle expanded output (currently off)

Connection
  \c[onnect] [DBNAME|- USER|- HOST|- PORT|-]
                         connect to new database (currently "postgres")
  \encoding [ENCODING]   show or set client encoding
  \password [USERNAME]   securely change the password for a user
  \conninfo              display information about current connection

Operating System
  \cd [DIR]              change the current working directory
  \timing [on|off]       toggle timing of commands (currently off)
  \! [COMMAND]           execute command in shell or start interactive shell

Variables
  \prompt [TEXT] NAME    prompt user to set internal variable
  \set [NAME [VALUE]]    set internal variable, or list all if no parameters
  \unset NAME            unset (delete) internal variable

Large Objects
  \lo_export LOBOID FILE
  \lo_import FILE [COMMENT]
  \lo_list
  \lo_unlink LOBOID      large object operations 
```

* * *

## 回答 #2

> 赞同：41
> 
> 时间：2009-02-24T17:39:20.523

```
SELECT table_name 
    FROM information_schema.tables 
WHERE table_type = 'BASE TABLE' 
    AND table_schema NOT IN 
        ('pg_catalog', 'information_schema'); 

SELECT column_name 
    FROM information_schema.columns 
WHERE table_name = 'YourTablesName'; 
```

这个页面有一些关于从 information_schema 中检索信息的重要信息：[http ://www.alberton.info/postgresql_meta_info.html](http://www.alberton.info/postgresql_meta_info.html)

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-02-24T17:27:50.707

使用 ANSI information_schema 视图

```
select * from information_schema.tables

select * from information_schema.columns 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2014-09-11T03:12:27.023

我知道这是线程启动 5 年后，但我想对迄今为止提出的解决方案添加一些细微的变化，以防它帮助其他人（最终，这是我必须想出的）。

上述的潜在问题是，如果对具有数百个表和数千个字段的数据库天真地实施，开发人员可能首先查询表集，然后在循环中查询每个表的所有字段。这会打击数据库服务器。我知道没有人特别建议使用循环，但也没有人警告过它。坦率地说，答案的结构方式有点隐含，因为它们实际上是说“首先查询所有表，然后查询所有字段”。翻译成代码，这个过程实际上只能是一个循环。

完成原始问题的更好方法（imo）是运行如下查询：

```
SELECT table_schema, table_name, column_name 
    FROM information_schema.columns 
WHERE table_schema in ('a', 'b', 'c', 'd') 
```

其中 a,b,c,d, ... 是您想要表达的带有表的模式。

这为您提供了一个未标准化的数据集，但这并不重要，因为无论如何您都在使用应用程序使用它 - 以您需要的方式在应用程序层解析结果是微不足道的，而且您只是命中具有一个超轻量级查询的数据库服务器，而不是一个循环中可能有数百个查询。

无论如何，希望对某人有所帮助！

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-02-24T17:38:55.797

如果您有权访问**psql**，则可以使用**`\d`**和**`\d table`**。在 SQL 方面，first 等价于

```
SELECT table_name FROM information_schema.tables WHERE table_schema = 'public' 
```

第二

```
SELECT column_name FROM information_schema.columns WHERE table_name ='table' 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2019-07-25T16:04:25.110

`psql`有这个`-E, --echo-hidden`选项，它会打印出`psql`命令所做的所有查询。

例如：

`psql -h localhost -U postgres -p 5432 postgres -E`

```
postgres=# \d
******** QUERY *********
SELECT n.nspname as "Schema",
  c.relname as "Name",
  CASE c.relkind WHEN 'r' THEN 'table' WHEN 'v' THEN 'view' WHEN 'm' THEN 'materialized view' WHEN 'i' THEN 'index' WHEN 'S' THEN 'sequence' WHEN 's' THEN 'special' WHEN 'f' THEN 'foreign table' WHEN 'p' THEN 'table' WHEN 'I' THEN 'index' END as "Type",
  pg_catalog.pg_get_userbyid(c.relowner) as "Owner"
FROM pg_catalog.pg_class c
     LEFT JOIN pg_catalog.pg_namespace n ON n.oid = c.relnamespace
WHERE c.relkind IN ('r','p','v','m','S','f','')
      AND n.nspname <> 'pg_catalog'
      AND n.nspname <> 'information_schema'
      AND n.nspname !~ '^pg_toast'
  AND pg_catalog.pg_table_is_visible(c.oid)
ORDER BY 1,2;
************************** 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2017-01-03T02:59:00.777

```
\d <table_name> 
```

例子 ：

```
\d authors 
```

* * *

## 回答 #8

> 赞同：-6
> 
> 时间：2009-02-25T08:47:51.917

[不要自己写](http://en.wikipedia.org/wiki/Not_Invented_Here)。使用[phpPgAdmin](http://phppgadmin.sourceforge.net/) - 它会更容易、更快且更不容易出错。

# c# - 反射和必须重建解决方案 C#

> ID：582661
> 
> 赞同：1
> 
> 时间：2009-02-24T17:23:20.610
> 
> 标签：c#

我在一个类上使用反射来获取它的自定义属性。我注意到，当我修改类的属性时，我需要在反射给我新值之前重建整个解决方案。

看来重建项目并不能解决问题。这是因为元数据被缓存了吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-24T17:27:00.663

如果您重新构建解决方案的单个项目，则引用该项目的其他项目将不会选择新的 DLL，直到您也构建它们。

这可能是您所看到的原因。

# c++ - How to Manage COM Objects in .Net Web Application

> ID：582663
> 
> 赞同：0
> 
> 时间：2009-02-24T17:23:25.227
> 
> 标签：c++, com, memory-leaks, com-interop, .net-1.1

A legacy c++ applications with sometimes notorious memory leak issues has to be called from a .Net server based windows application. .Net garbage collection times are not determinable and sometime the c++ object are destroyed or not destroyed "on time" producing unpredictable results and generally crashing the c# web app. What is the best way to push the c++ objects onto the garbage collection stack as frequently as possible, but not so often as to remove the .Net reference to the COM object. Keep in mind that the COM objects can spawn sub-objects so the .Net reference count of the COM objects can change with just a function call and not necessarily an instantiation.

As the memory leaks occur and the COM objects are not cleaned up, performance degrades until it is so slow that IIS trips on itself a few times and then crashes. Restarting IIS fixes the issue until the next time. Periodic restarts help, but a busy day can cause this during the business day.

I had to resolve this using .Net 1.1 a couple of years ago. Wondering if someone else had my solution or a better one. This is NOT ASP.NET. It is a .Net dll.

The final result was not completely satisfactory and the web server crashes every few months.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-26T12:41:35.573

您问“尽可能频繁地将 c++ 对象推送到垃圾收集堆栈的最佳方法是什么”，但 c++ 对象永远不会被垃圾收集。也许这样看...

您有一个实例化一堆 c++ 对象的进程。其中一些 c++ 对象实现了 COM 对象，因此它们的生命周期通过 AddRef/Release 进行管理。其中一些 COM 对象被导入 .NET 世界，并使用 RCW（运行时可调用包装器）进行包装。只有 RCW 是 .NET 对象并进入垃圾收集堆。

在没有您的任何干预的情况下，RCW 最终将被 GC 处理，并且当这种情况发生时，它将针对其底层 COM 对象执行 Release。如果要立即释放 COM 对象，无需等待 GC，可以调用...

System.Runtime.InteropServices.Marshal.ReleaseComObject

...甚至 FinalReleaseComObject 如果您确定这是您想要的。

回到您的问题：您想知道如何在不释放 .NET 对 COM 对象的引用的情况下删除 c++ 对象。由于 .NET 堆中不存在 c++ 对象，因此无法直接实现这一点。您可以从您的 COM 对象中公开一个删除其所有 c++ 对象的方法，然后简单地从您的 .NET 代码中调用它。但我猜你的 COM 对象是否有可能识别出你已经在做的所有泄露的 c++ 对象。

希望我已经解释了为什么无法实现您在问题中的建议，但是有很多工具可以帮助您查找和修复内存泄漏。我建议使用 LeakDiag 之类的工具（在 StackOverflow 上搜索它）来找出你的 c++ 代码在哪里泄漏内存。

如果您使用的是 IIS6 或更高版本，实用的解决方案是配置应用程序池回收。您可以调整这些数字，以便在进程泄漏足够的内存造成问题之前杀死并重新启动进程，并且它通常以用户不会注意到任何停机时间的方式工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-26T12:49:16.977

创建一个 COM+ 应用程序并将您使用的 COM 类放入该应用程序中。这样，所有 COM 对象都在一个单独的进程中实例化。您可以定期释放所有 COM 对象，然后重新启动 COM+ 应用程序进程。

# c++ - 为什么我的 64 位 C++ 应用程序崩溃？

> ID：582665
> 
> 赞同：1
> 
> 时间：2009-02-24T17:24:25.210
> 
> 标签：c++, visual-studio-2008, visual-c++

我编写了一个非常小的 64 位应用程序，它在 Windows Vista x64 的全新安装时崩溃。它在我安装了 Visual Studio 2008 的开发机器（Windows 7 64 位）上运行顺畅。

64 位 C++ 应用程序（非托管）由 32 位 .NET 应用程序启动，然后立即崩溃并出现访问冲突错误。这就是事件查看器所说的：

```
Faulting application MaxTo64.exe, version 0.0.0.0, time stamp 0x49a41d9e, 
faulting module USER32.dll, version 6.0.6001.18000, time stamp 0x4791adc5, 
exception code 0xc0000005, fault offset 0x00000000000236d6, process id 0x82c, 
application start time 0x01c996a346a3e805.

MaxTo64.exe 
0.0.0.0 
49a41d9e 
USER32.dll 
6.0.6001.18000 
4791adc5 
c0000005 
00000000000236d6 
82c 
01c996a346a3e805 
```

我已经安装了 VC2008 可再发行组件（2008 x86、2008 x64、2008 SP1 x86 和 2008 SP1 x64），所以这应该不是问题。*编辑*：值得一提的是，在安装 vcredist-package 之前，它以不同的方式崩溃，并出现并行配置错误。

我是 C++ n00b，所以我真的不知道下一步该往哪里看。

*编辑*：Windows 调试工具的输出。

```
CommandLine: "C:\Program Files (x86)\MaxTo\MaxTo64.exe" maxto_a_do_run_run
Symbol search path is: *** Invalid ***
****************************************************************************
* Symbol loading may be unreliable without a symbol search path.           *
* Use .symfix to have the debugger choose a symbol path.                   *
* After setting your symbol path, use .reload to refresh symbol locations. *
****************************************************************************
Executable search path is: 
ModLoad: 00000001`3f2f0000 00000001`3f30b000   MaxTo64.exe
ModLoad: 00000000`77160000 00000000`772e0000   ntdll.dll
ModLoad: 00000000`77030000 00000000`7715b000   C:\Windows\system32\kernel32.dll
ModLoad: 00000001`80000000 00000001`80011000   C:\Program Files (x86)\MaxTo\Hooker.dll
ModLoad: 00000000`76f60000 00000000`7702d000   C:\Windows\system32\USER32.dll
ModLoad: 000007fe`fed70000 000007fe`fedd3000   C:\Windows\system32\GDI32.dll
ModLoad: 000007fe`fea20000 000007fe`feb28000   C:\Windows\system32\ADVAPI32.dll
ModLoad: 000007fe`fe850000 000007fe`fe98f000   C:\Windows\system32\RPCRT4.dll
ModLoad: 000007fe`fd8b0000 000007fe`fe502000   C:\Windows\system32\SHELL32.dll
ModLoad: 000007fe`fef70000 000007fe`ff00c000   C:\Windows\system32\msvcrt.dll
ModLoad: 000007fe`feee0000 000007fe`fef53000   C:\Windows\system32\SHLWAPI.dll
(3a4.964): Break instruction exception - code 80000003 (first chance)
*** ERROR: Symbol file could not be found.  Defaulted to export symbols for ntdll.dll - 
ntdll!DbgBreakPoint:
00000000`771a4ea0 cc              int     3
0:000> g
ModLoad: 000007fe`fe780000 000007fe`fe7ad000   C:\Windows\system32\IMM32.DLL
ModLoad: 000007fe`ff010000 000007fe`ff111000   C:\Windows\system32\MSCTF.dll
ModLoad: 000007fe`feed0000 000007fe`feedd000   C:\Windows\system32\LPK.DLL
ModLoad: 000007fe`fede0000 000007fe`fee7a000   C:\Windows\system32\USP10.dll
ModLoad: 000007fe`fc150000 000007fe`fc349000   C:\Windows\WinSxS\amd64_microsoft.windows.common-controls_6595b64144ccf1df_6.0.6001.18000_none_152e7382f3bd50c6\comctl32.dll
(3a4.964): Access violation - code c0000005 (first chance)
First chance exceptions are reported before any exception handling.
This exception may be expected and handled.
*** ERROR: Symbol file could not be found.  Defaulted to export symbols for C:\Windows\system32\USER32.dll - 
USER32!DisableProcessWindowsGhosting+0x1a:
00000000`76f836d6 66f2af          repne scas word ptr [rdi]
*** ERROR: Module load completed but symbols could not be loaded for MaxTo64.exe
*** ERROR: Symbol file could not be found.  Defaulted to export symbols for C:\Windows\system32\kernel32.dll - 
```

此时的调用堆栈是：

```
USER32!DisableProcessWindowsGhosting+0x1a
USER32!ChangeWindowMessageFilter+0x12d
USER32!RegisterClassExW+0x25
MaxTo64+0x11e4
MaxTo64+0x1075
MaxTo64+0x1920
kernel32!BaseThreadInitThunk+0xd
ntdll!RtlUserThreadStart+0x21 
```

它似乎在 MyRegisterClass 中，如下所示：

```
ATOM MyRegisterClass(HINSTANCE hInstance)
{
WNDCLASSEX wcex;

wcex.cbSize = sizeof(WNDCLASSEX);

wcex.style          = CS_HREDRAW | CS_VREDRAW;
wcex.lpfnWndProc    = WndProc;
wcex.cbClsExtra     = 0;
wcex.cbWndExtra     = 0;
wcex.hInstance      = hInstance;
wcex.hIcon          = LoadIcon(hInstance, MAKEINTRESOURCE(IDI_MAXTO64));
wcex.hCursor        = LoadCursor(NULL, IDC_ARROW);
wcex.hbrBackground  = (HBRUSH)(COLOR_WINDOW+1);
wcex.lpszClassName  = szWindowClass;
wcex.hIconSm        = LoadIcon(wcex.hInstance, MAKEINTRESOURCE(IDI_SMALL));

return RegisterClassEx(&wcex);
} 
```

*编辑*：原来问题是我自己的愚蠢错误。显然，WNDCLASSEX 结构中有一个字段未正确初始化。这在 Vista 上崩溃了，但在 Windows 7 上却没有，奇怪的是。添加这个可以解决问题。

```
wcex.lpszMenuName   = NULL; 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-24T17:31:38.593

说真的，我们无法从您的数据中推断出太多信息：

我建议至少做以下一项

*   Vista 64机器上安装VS
*   设置远程调试会话[http://msdn.microsoft.com/en-us/library/y7f5zaaa.aspx](http://msdn.microsoft.com/en-us/library/y7f5zaaa.aspx)
*   使用 OutputDebugString 打印程序所在位置的信息，并使用 DebugView 观察它以缩小程序崩溃的位置。

***编辑***：只看了你的调试跟踪后，我发现了两个可能的问题：

*   你没有ZeroMemory WNDCLASSEX，所以也许Vista 正在尝试使用lpszMenuName。
*   Win7 是测试版，可能隐藏了一个错误。

但是您仍然没有显示太多代码并且跟踪不完整，因此很难在没有[通灵](http://blogs.msdn.com/oldnewthing/archive/2005/03/21/399688.aspx)的情况下断言某些东西。

如果将 VS 生成的 .pdb 复制到 Vista 机器上，在 .exe 所在的同一文件夹中，您将获得更有意义的跟踪。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-24T17:34:44.293

安装适用于 Windows 的调试工具并获得真正的回溯 - 这应该会引导您了解正在发生的事情

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-24T17:27:52.517

调试器怎么样？一些代码到它崩溃的地方？

另外，不要做一些愚蠢的事情，比如将指针存储在 int 中——它不再适合了。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-24T17:28:16.620

您有访问冲突，您很可能试图读取或写入无效内存。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-24T17:52:56.263

异常代码 0xc0000005 是访问冲突：您的程序很可能试图写入或读取不属于它的内存。在 C/C++ 中这样做的常见原因是使用空指针。由于异常发生在 USER32.dll 中，您可能传递了一个空指针。由于您使用的是 C++，它可能涉及对象而不是结构，或者包含 USER32.dll 函数的某些对象/类中的方法。

# msbuild - 让 MsBuild 在子文件夹中构建所有解决方案

> ID：582667
> 
> 赞同：2
> 
> 时间：2009-02-24T17:25:37.623
> 
> 标签：msbuild

我有一个包含多个 VS 解决方案的目录。有定期添加的解决方案，我不希望维护包含所有其他解决方案的解决方案。有没有办法让 msbuild 找到给定文件夹的子文件夹中的所有解决方案文件并构建每个解决方案？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-24T17:52:50.820

我有一段时间没有玩 msbuild，所以我不知道它是否可以自己完成，但你可以尝试一些 hacky 的批处理文件。像这样：

```
FOR /D %%i IN (*.*) DO CALL makedir.bat %%i 
```

makedir.bat 为目录中的解决方案调用 msbuild。

# c# - C# 使用各种图片制作一张图片

> ID：582669
> 
> 赞同：2
> 
> 时间：2009-02-24T17:26:31.600
> 
> 标签：c#, windows-mobile, picturebox

想象一下，我有一个 2x2 或 3x3 图片的矩阵，我想用这 4 或 9 张图片制作一张大图片。我想在图片框上显示这张图片。

我正在开发一个 Windows Mobile 应用程序。

我怎样才能做到这一点？

编辑：将评论移至问题以进行澄清..

通常，您将图像作为这样的图片框`pictureBox.image = myImage`。我想使用 4 个图像构建 myImage 。想象一下，我有一个图像并将其切成四个正方形。我想用这 4 张图像重新组合原始图像。

谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-24T17:46:36.527

像这样的东西：

```
Bitmap bitmap = new Bitmap(totalWidthOfAllImages, totalHeightOfAllImages);
using(Graphics g = Graphics.FromBitmap(bitmap))
{
    foreach(Bitmap b in myBitmaps)
        g.DrawImage(/* do positioning stuff based on image position */)
}

pictureBox1.Image = bitmap; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-24T17:34:47.307

要么将 4 och 9 个 PictureBox 并排放置，要么使用 Panel 而不是 PictureBox，并使用 Graphics.DrawImage 在 Panles Paint 事件中绘制所有图像。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-24T17:50:18.563

这应该有效，但未经测试：

```
private Image BuildBitmap(Image[,] parts) {
    // assumes all images are of equal size, assumes arrays are 0-based
    int xCount = parts.GetUpperBound(0) + 1;
    int yCount = parts.GetUpperBound(0) + 1;

    if (xCount <= 0 || yCount <= 0)
        return null; // no images to join

    int width = parts[0,0].Width;
    int height = parts[0,0].Height;

    Bitmap newPicture = new Bitmap(width * xCount, height * yCount);
    using (Graphics g = Graphics.FromImage(newPicture)) {
        for (int x = 0; x < xCount; x++)
            for (int y = 0; y < yCount; y++)
                g.DrawImage(parts[x, y], x * width, y & height); 
    }

    return newPicture;
} 
```

# c - Is there a cheaper way to find the depth of the call stack than using backtrace()?

> ID：582673
> 
> 赞同：0
> 
> 时间：2009-02-24T17:27:11.520
> 
> 标签：c, linux, stack, backtrace

My logging code uses the return value of [backtrace()](http://linux.die.net/man/3/backtrace) to determine the current stack depth (for pretty printing purposes), but I can see from profiling that this is a pretty expensive call.

I don't suppose there's a cheaper way of doing this? Note that I don't care about the frame addresses, just how many of them there are.

edit: These logging functions are used all over a large code-base, so manually tracking the stack depth isn't really an option.

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-24T17:59:42.020

Walking the stack yourself is pretty quick - most of the slowness in `backtrace()` is from looking up symbol names. On x86, you can do the following:

```
inline uint32_t get_ebp(void)
{
    __asm__ __volatile__("mov %%ebp, %%eax");
}

int get_stack_depth(void)
{
    uint32_t ebp = get_ebp();
    int stack_depth = 0;
    while(ebp != 0)
    {
        ebp = *(uint32_t *)ebp;
        stack_depth++;
    }
    return stack_depth;
} 
```

This will walk the chain of `ebp` pointers. Keep in mind that this is extremely non-portable. Also note that this will not count any functions which have been inlined or tail-call optimized (of course, `backtrace()` has the same problem).

Another important issue is the termination condition -- once you backtrace up to `main()`, there often aren't guarantees about what you'll find in the stack. So, if libc doesn't put a null frame pointer, you'll very likely segfault. You can get the termination value by looking at it at the very beginning of `main()`.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-24T17:42:15.807

If your pretty-printing functions are reasonably contained, then pass in the indent (or indent size) as a parameter, and just increment it when you call other display functions.

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-24T17:42:22.497

Can't you just carry a [TLS](http://en.wikipedia.org/wiki/Thread-local_storage) variable around with you called "depth" and increment it / decrement it every function? While you could write your own code to walk the stack quicker, it's still going to be slower than just carrying the variable around with you.

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-27T11:42:03.260

For arm architectures :

```
register unsigned long *rfp asm("fp");
unsigned long *fp = rfp;
unsigned long depth = 0;

while(fp)
{
    fp = (unsigned long *)(*(fp -3));
    depth++;
}

return depth; 
```

# c# - C# 通过单个赋值设置多个属性

> ID：582680
> 
> 赞同：1
> 
> 时间：2009-02-24T17:28:16.370
> 
> 标签：c#, properties

我有一个属性被分配为：

```
public string propertyA{get;set;} 
```

当此属性设置为在类中分配另一个属性时，我想自动调用一个方法。触发通话的最佳方式？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-02-24T17:32:01.087

您不必使用只是简写的语法。如果你扩展它，你可以在 setter 中做任何你喜欢的事情。

```
 public string PropertyA
 {
       get { return a; }
       set 
       {
            a = value;
            doStuff(); 
       }
 } 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-24T17:32:21.243

我认为您将不得不回到老式的方式来处理您的财产。

```
private string _PropertyA;

public string propertyA
{
    get
    {
       return _PropertyA;
    }
    set
    {
       _PropertyA=value;
       //Set other parameter
    }
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-24T17:31:06.393

展开属性设置器并分配其他属性。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-24T17:32:08.870

手动添加支持字段并提供一些代码以在设置器中执行您想要的操作。

```
private string propertyA;
public string PropertyA
{
    get { return this.propertyA; }
    set
    {
         this.propertyA = value;
         this.propertyB = value + "B";
    }
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-24T17:32:37.577

定义二传手。

在它里面要么触发一个事件，要么直接分配另一个属性。

# theory - 真的有解决问题的“最佳”方法吗？

> ID：582682
> 
> 赞同：1
> 
> 时间：2009-02-24T17:28:17.990
> 
> 标签：theory

我一直在研究很多这样的问题，询问执行此操作的“最佳”方式或执行此操作的“最佳”方式。

*   一个人的最佳方式是否会成为每个人的最佳方式？
*   真的有一种“最好”的方法来做一个特定的算法或解决一个问题吗？

*   **寻找最好的方法而不是以*任何*方式解决问题有什么危险？**

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-24T17:33:10.087

杰夫 - 这是我和我的同事反复讨论的事情。他们一直在寻找技术实施和最佳实践方面的最佳方法，而作为业务分析师，我更关注交付和解决手头的问题。

这当然是一个价值主张的问题，我认为它归结为可维护性和性能。如果所做的更改或代码不可维护或易于更改，那么它就会成为一个问题，应该重新评估最佳实践。如果有问题的代码运行缓慢并且性能是一个问题，那么它可能应该被修改。

虽然有 10 多种方法可以给猫剥皮或编写算法，但不一定有最好的，但几乎总是有更好和更坏的。查看代码气味的主题，可能是一个不错的起点。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-24T17:32:10.370

不。

这是古代哲学家的问题。完美不可能存在，就好像它存在一样，它不会是完美的。由于我们世界的不完美，现实中的任何事物都永远不会完美，风化（无论是自然的还是人为的）都会立即发生，使其不完美。

最好的不存在。“更好”确实如此，但“更好”取决于上下文。EG“xyz 更适合这种情况”。

权衡是您要寻找的词。每个决定都有其权衡，“更好”的权衡取决于您的上下文。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-24T17:35:50.033

在其他条件相同的情况下，最好的解决方案是解决该问题的团队能够充分理解以正确实施的解决方案。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-24T17:36:13.573

“最佳”可以表示计算机编程中的许多事情，例如

*   最快的
*   最低的内存使用率
*   最简单的

甚至这些东西也可能意味着很多东西，例如“最快”可能意味着“最低延迟”或“最高吞吐量”，甚至可能意味着“最低摊销延迟”之类的东西，这可能会考虑到可能的最佳和最坏情况方法，以及两者之间的分布。

因此，如果该方法的每个方面对于“最佳”及其组成部分的所有可能定义都是最佳的，那么是的，存在最佳方法。但这对于除了最简单的情况之外的所有情况都非常罕见。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-24T17:32:17.157

应该评估解决方案的所有替代方案，并且选择的解决方案应该是最能以最低价格满足所有要求的解决方案。一个人最好的不是另一个人最好的。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-24T17:33:24.657

不，对于任何合理的复杂问题，你会得到大量的解决方案，这可能是最好的，具体取决于具体情况但是

在许多情况下，有一个最好的默认解决方案应该被认为是最好的解决方案，直到您了解为什么不是这种情况的原因。

示例：有数百种方法可以对集合进行排序。但是，如果您对问题一无所知，那么 api 提供的方法是一个很好的猜测。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-24T17:39:02.350

我认为它们都是“在这种情况下最好”的意思，当然没有普遍的最好。如果有，它只是在等待下一个最好的出现并取而代之！

# apache-flex - Flex 中的安全性——是否可以操作下载的代码并执行 Web 服务

> ID：582684
> 
> 赞同：1
> 
> 时间：2009-02-24T17:29:00.970
> 
> 标签：apache-flex, web-services, security, flex3, decompiling

我正在设计 Flex 中的应用程序，该应用程序连接到一些 Web 服务以执行一些金融交易。Web 服务使用 https 协议进行保护，并要求在每个请求登录时创建用户令牌。这用于对用户进行身份验证和授权。到现在为止还挺好。

诀窍在于，并非我们所有的 Web 服务都是粗粒度的。举个例子，我们可以有两种 Web 服务方法：EnoughFounds 和 Transfer。因此，只有在 EnoughFounds 方法回复“true”后，我才会执行 Transfer。此逻辑在 Flex 应用程序代码中进行编程。

我所呈现的场景如下：如果有人下载应用程序并对其进行反编译怎么办。比修改代码，因此不执行步骤 EnougFunds。或者也许编写一个全新的客户端，甚至可能在其他技术中执行 Transfer 而无需通过 EnoughFunds 步骤。执行 Transfer 时，用户将在服务器上获得授权和身份验证；但由于他使用的是他的真实凭据，他将能够执行转移。他跳过的检查属于业务逻辑，而不是安全域。我需要以某种方式确保执行应用程序的代码是我编写和用户下载的未经修改的 Flex 代码。我怎样才能做到这一点？我知道我可以重写服务，以便在服务器上执行序列，

在我看来，必须有一些安全机制可以解决这个特定问题。

请注意，我不是在寻找有关最佳实践的建议。我的要求是不要更改服务器端的任何内容。如何在不更改服务的情况下保护协议级别的序列？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-02-24T17:34:51.283

这是一个大错误。必须在服务中检查任何重要到重要的业务规则。必须是这样的，无论客户端做什么，服务都不会让任何不好的事情发生。

特别是，进行 EnoughFunds 操作是有意义的，因为如果 EnoughFunds 返回 false，您可以告诉用户他没有足够的资金。但是，转账操作必须检查是否有足够的资金，而不是依赖客户进行如此重要的检查。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-02-24T17:41:22.920

让我补充一点——我让孩子们反编译我的游戏并更改/编辑通过操纵 http 通信的工具来回发送的消息——这仅适用于*没有*外部价值的游戏。我的用户实际上加载了 fiddler 和 firefox 标头工具来操纵服务调用，只是为了在每天都会自行重置的游戏板上获得高分。

如果我把钱或“真正的”价值投入其中，我不禁想到会发生什么。

不要*相信*客户端发送给您的任何数据...使用“足够的资金”调用来更新您的用户界面，但是在执行“传输”阶段时，您需要纯粹在服务器端重新评估该调用 - 不要相信那只是因为客户要求转移，您应该接受它。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-03-05T08:54:36.390

如果不更改服务器端，您将无法解决此问题，因为正如所有其他答案所指出的那样，这就是问题所在。此外，不会有不涉及更改服务器端的合适协议。

将其与银行柜台的人进行比较是非常合适的。该人已向银行员工提供了一些凭据，以验证她是谁以及她实际上拥有某个帐户 X。这就是登录。

现在这个人想要从账户 X 到 Y 的转账。无论她对可用资金说什么都无关紧要。如果她出示银行行长签署的文件说她有足够的资金，银行仍然需要在转账之前进行检查，因为钱必须在那里。

这意味着，即使您在协议中获得了一个安全的序列逻辑，以确保在“Transfer”之前调用了“EnoughFunds”，并且仅在不久前调用了一次，并且使用了正确的参数，它仍然是客户端告诉银行“没关系，我有足够的资金”。这永远不会削减它。

你能得到的最接近的情况相当于银行客户俯身在柜台上，指着员工的屏幕说“看，这里，*在你的系统中*，它说交易可以完成，因为有足够的资金”，即客户端可以可验证地重现*服务器刚刚发出的*对 EnoughFunds 的调用的时间、输入和输出，这没问题，但毫无意义。

所以**解决方案是让 Transfer 在内部调用 EnoughFunds ， period**。如果客户需要知道，您可以返回描述性异常/错误以防资金不足。

[![就像这样。](https://i.stack.imgur.com/A6z51.gif)](https://i.stack.imgur.com/A6z51.gif)
[（来源：[userfriendly.org](http://www.userfriendly.org/cartoons/archives/09mar/uf012514.gif)）]

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-03-06T18:36:36.823

老实说，我认为您需要*认真*重新评估您的发展计划。正如其他人在这里正确地指出的那样，您*不能*依赖客户的完整性。

简而言之，在您可以控制的环境（即服务器——即使那样，它还是有争议的）之外，*没有“安全、受信任的代码”之类的东西。*你不知道你实际上正在与之交谈的软件，所以无论你如何“调整”应用层协议，你仍然不能保证一个坏演员不会简单地用逆向工程的实现来欺骗你你的“调整”协议。

您的“信任域”仅扩展到 Web 服务 api，仅此而已。如果您的服务无法验证其操作的完整性，那么它就是设计不佳的服务。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-03T14:32:12.677

我认为你应该考虑以下几点：

*   [防篡改 URL](http://aspnet.4guysfromrolla.com/articles/083105-1.aspx)
*   [即将过期的网页](http://aspnet.4guysfromrolla.com/articles/090705-1.aspx)
*   将您的 EnoughFunds 和 Transfer 逻辑组合到一个调用中。正如 John Saunders 所说，无论如何，您必须在转移之前检查 EnoughFunds，因此检查一次更有意义。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-01T19:16:50.077

首先，我同意其他答案——客户绝对是你的敌人，永远不应该被信任。还要扩展您放置的一些评论——即使“足够的资金”返回某种加密令牌，有什么保证它仍然没有被黑客以 10 的数量调用，并且随后的转移以 10000000 的数量被激活。

方法必须是将原子业务逻辑放在一起，例如“足够的资金和转移”。

我建议也为每个服务器调用添加一个序列，以便永远不会重新执行旧的服务器调用，因为它们现在不按顺序进行。服务器应将“下一个序列令牌”作为某种“加密”数字返回。这可以很简单，只需生成随机数并作为响应的一部分返回，同时也将其置于服务器会话中并在该客户端的任何后续调用中重新确认它。

同样，这个技巧不是一种安全措施，而是简单地试图帮助避免过于简单的“摆弄”情况。

这可以与混淆您的 API 结合使用。如果您以 Web 服务的名称来称呼它们（例如：EnoughFunds 服务将被这样称呼），逆向工程变得容易得多。相反，做一些像枚举服务这样简单的事情，然后通过中央控制器 - activateTask=12?param1=200 。不过，这仍然很容易进行逆向工程......如果您可以投资于完全加密每个请求，看起来会更好：SFASDFsdq1231sd4DFGTRsdf2rDF

当然，任何这样好的请求加密，都应该部分基于 session-id（又名：登录身份验证令牌，通常）

# ruby - 我应该在我的 ruby 脚本中定义一个 main 方法吗？

> ID：582686
> 
> 赞同：50
> 
> 时间：2009-02-24T17:29:12.467
> 
> 标签：ruby, main-method

在 python 中，一个模块不必*有*一个 main 函数，但通常的做法是使用以下成语：

```
def my_main_function():
    ... # some code

if __name__=="__main__":  # program's entry point
    my_main_function() 
```

我知道 Ruby 也不*必有*方法`main`，但是我应该遵循某种最佳实践吗？我应该命名我的方法`main`还是什么？

[关于主要方法的维基百科页面](http://en.wikipedia.org/wiki/Main_function_(programming)#Ruby)并没有真正帮助我。

* * *

作为旁注，我还在 python 中看到了以下成语：

```
def my_main_function(args=[]):
    ... # some code

if __name__=="__main__":  # program's entry point
    import sys
    sys.exit(my_main_function(sys.argv)) 
```

* * *

## 回答 #1

> 赞同：78
> 
> 时间：2009-02-24T17:31:21.277

我通常使用

```
if __FILE__ == $0
  x = SweetClass.new(ARGV)
  x.run # or go, or whatever
end 
```

所以是的，你可以。这取决于你在做什么。

* * *

## 回答 #2

> 赞同：51
> 
> 时间：2009-05-14T03:25:25.210

我总是发现`$PROGRAM_NAME`比使用`$0`. 有一半的时间我看到像这样的“类 Perl”全局变量，我必须去查找它们。

```
 if __FILE__ == $PROGRAM_NAME
  # Put "main" code here
end 
```

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2011-01-26T21:15:03.683

您应该将库代码放在 lib/ 中，将需要库代码的可执行文件放在 bin/ 中。这具有与 RubyGems 的打包方法兼容的额外优势。

一个常见的模式是 lib/application.rb（或者最好是更适合您的域的名称）和 bin/application，其中包含：

```
require 'application'
Application.run(ARGV) 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-02-24T22:00:58.197

我个人的经验法则是：当下

```
if __FILE__ == $0
    <some code>
end 
```

超过 5 行，我将其提取到`main`功能。这适用于 Python 和 Ruby 代码。没有这些代码，看起来结构很差。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2009-02-24T17:32:14.597

不。

为什么要增加一层额外的复杂性却没有真正的好处？Rubyists 没有使用它的约定。

我会等到您第二次需要使用它（这可能会比您想象的要少）然后重构它以使其可重用，这可能涉及像上面这样的构造。

# .net - CI：Hudson with .Net vs CruiseControl.Net

> ID：582687
> 
> 赞同：26
> 
> 时间：2009-02-24T17:29:16.100
> 
> 标签：.net, continuous-integration, cruisecontrol.net, hudson

我在一家希望集成 CI 服务器的 .net 商店工作。从我所见，Hudson 似乎是最受欢迎的选择。考虑到我们是一家仅限 .net 的商店，Hudson 会不会出现 CC.NET 不会遇到的任何障碍？

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2009-02-24T17:45:29.870

我想不出 Hudson 无法为我们的 C# 开发做的一件事，即使使用基于 MSTest 的测试，您现在也可以使用[新插件](http://wiki.hudson-ci.org/display/HUDSON/MSTest+Plugin)（仅在您测试 ONE 程序集时有效）或[我的方法](https://stackoverflow.com/questions/352703/integrating-hudson-with-ms-test/512092#512092)在它们上运行和趋势图它适用于多个程序集。

我想唯一会好的是生成代码覆盖率数据并报告它，不确定 CC.net 是否这样做。

此外，哈德逊似乎有更强大的社区支持。如果他们有选择的话，我从未听说有人选择 CC.net 而不是 Hudson。

我们用它来

*   部署windows服务
*   部署网络服务
*   运行 MSTests 并显示与任何 junit 测试一样多的信息
*   跟踪低、中、高任务
*   趋势图警告和错误

这些事情对 Hudson 来说可能不是什么新鲜事，但我觉得有必要再次强调 Hudson 可以通过 .net 项目来处理这个问题，没问题。

以下是 Hudson 支持的一些内置 .net 内容

*   [微软构建](http://wiki.hudson-ci.org/display/HUDSON/MSBuild+Plugin)
*   [南安特](http://wiki.hudson-ci.org/display/HUDSON/NAnt+Plugin)
*   MSTest（两种方法，上面链接）
*   [单位](http://wiki.hudson-ci.org/display/HUDSON/NUnit+Plugin)
*   [团队基础服务器](http://wiki.hudson-ci.org/display/HUDSON/Team+Foundation+Server+Plugin)
*   [外汇警察](http://wiki.hudson-ci.org/display/HUDSON/Violations)
*   [风格警察](http://wiki.hudson-ci.org/display/HUDSON/Violations)
*   [编译器警告](http://wiki.hudson-ci.org/display/HUDSON/Warnings+Plugin)
*   [代码任务](http://wiki.hudson-ci.org/display/HUDSON/Task+Scanner+Plugin)

另外，上帝禁止你使用安全的视觉源，[它也支持](http://wiki.hudson-ci.org/display/HUDSON/Visual+SourceSafe+Plugin)。我建议你看看[Redsolo 关于使用 Hudson 构建 .net 项目的文章](http://redsolo.blogspot.com/2008/04/guide-to-building-net-projects-using.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-15T04:32:14.917

哈德逊对于初学者来说要容易得多。我们使用它来自动构建和打包 C++ Builder dll 和 exe。考虑一下！它不是 Java 也不是 C#。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-24T18:27:02.187

我对哈德森几乎一无所知。我会说，由于 CC.NET 基于 .NET，它往往有许多与 .NET 生态系统相关的内置和社区贡献的任务和报告：

MSBuild Visual Studio NCover NUnit FxCop 等等等等等等。

因此，如果您使用这些工具，您应该仔细检查 Hudson “开箱即用”对它们的支持程度。此外，如果您最终不得不编写自定义插件（我已经为 CCNET 编写了一些插件），那么能够使用您用于“正常”开发的开发语言和 IDE 通常是有利的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-08-24T16:52:03.133

我检查了 hudson 对 xunit 测试框架的支持，下面包含一个简短的摘要：

*   [MBUnit/Gallio](http://www.gallio.org/)：有一个插件，但开发似乎不太活跃，使用它的社区也不太活跃。例如，只添加了一个[问题](http://issues.hudson-ci.org/browse/HUDSON-6245)。它在四月的报道中被报道，但尚未触及（八月）。（Gallio 团队支持 CC.Net 的插件，他们的响应时间看起来更好）
*   MSTest：有同样的问题。问题跟踪系统中只有两个问题，平均响应延迟为 6 个月。（看起来 CC.Net 对 mstest 有本机支持，但需要一些配置）
*   nUnit：hudson 对 nunit 的支持似乎相当不错。开发团队的响应速度更快，并且报告了更多错误（目前有 8 个）。

所以我想我要试试 CC.Net。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2011-02-13T18:24:38.203

我无法理解为什么 .Net 开发人员会使用 Java CI 工具。CruiseControl 是一个很好的以Java 为中心的工具。这就是创建 CruiseControl.NET 的原因。.NET 为中心的持续集成。

如果您想设置一个紧密集成的系统，您将为系统编写自己的插件，以使其完全按照您的意愿行事。

例如，将您关心的所有版本信息汇总在一起，然后写出 AssemblyInfo.cs 文件以及其中的版本。

# linq-to-sql - 生成 LINQ-to-SQL 数据层

> ID：582688
> 
> 赞同：3
> 
> 时间：2009-02-24T17:29:28.677
> 
> 标签：linq-to-sql, code-generation, sqlmetal, data-layers

我通常将[Codesmith](http://www.codesmithtools.com/)和[NetTiers](http://nettiers.com/)用于我的数据层，因为它们可以从命令行运行，所以只要对数据库进行更改，它只需要一个简单的批处理文件来重新生成/重建所有内容。

现在我正在研究 LINQ-to-SQL，但我发现 WYSIWYG 实体设计器并不方便。还有哪些其他方法可用于生成 LINQ-to-SQL 类？有没有人有使用 SQLMetal 的经验？

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-24T17:50:24.770

SQLMetal 非常适合生成模型类。我不太喜欢 LINQ 设计器，所以通常我会在初始设计阶段使用设计器，然后通过手动编辑 dbml 文件对数据模型进行添加或更改。

我使用这个简单的命令来构建我的 LINQ-to-SQL 类，为了最大的方便，我将其放入批处理文件中：

```
sqlmetal /code:YourCodeFile.designer.cs /namespace:Desired.Namespace YourModel.dbml 
```

SQLMetal 方法对我来说效果很好，并且是生成代码的可靠方法。对生成的类的任何手写添加，当然应该保存在单独的代码文件中的部分类声明中。

# installation - InstallAware 数据库回滚

> ID：582696
> 
> 赞同：0
> 
> 时间：2009-02-24T17:31:34.833
> 
> 标签：installation, installation-package, installaware, database-installation

有谁知道当用户单击“取消”时如何使 InstallAware 回滚数据库？与 InstallShield 不同，我没有看到任何方法来指定单个脚本何时运行。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2010-05-17T18:36:47.857

我不认为 InstallAware 能够回滚数据库事务。我没有在他们的 MS SQL Server 命令中看到对 SQL Server 回滚的任何内在支持。如果可能的话，您需要编写自己的回滚脚本。

如果用户在初始对话框中取消安装，则 MSICode 中通常有一个部分具有 IF 块。它看起来像这样

```
if variable WIZARD Equals CANCEL
    Terminate Installation
end 
```

这发生在 Windows Installer 引擎实际执行安装之前。如果您尚未执行数据库脚本，则无需执行任何操作。如果您在此之前应用了数据库脚本，则需要提供回滚脚本（如果可能）并在该块中执行它，但在终止安装之前。

如果您在安装时取消安装，您将获得另一次回滚更改的机会。当用户在安装过程运行时（即在用户做出任何选择之后）按下取消按钮时，InstallAware 变量 SUCCESS 将被设置为 CANCEL。您可以检查该条件并执行回滚脚本。通常有一个代码块根据 SUCCESS 的值做各种事情，你可以在那里添加你的代码。

您总是可以让您的 SQL 脚本成为 InstallAware 在安装过程中执行的最后一个命令。这将消除处理取消的需要。

# debugging - 了解符号调试器

> ID：582698
> 
> 赞同：0
> 
> 时间：2009-02-24T17:32:00.120
> 
> 标签：debugging, debug-symbols

我想了解符号调试器是如何工作的？什么是调试符号表以及它如何促进源代码级调试。我完全没有注意到调试器的幕后操作……当我为 gcc 提供“-g”选项时实际发生了什么，写入目标文件的内容以及此类复杂性。如果 SO 社区可以解释并指导我获取更多信息的来源，我会很高兴

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-24T17:38:59.743

符号文件只是所有已定义的全局变量和函数的列表，以及它们与模块开头的偏移量。它还列出了所有结构并描述了它们的字段。

这样，当 GDB/WinDbg 加载时，它能够查看 EIP（当前指令）并将地址映射到类似 (SomeFunc+0x25) 的地址。当然，大多数符号也有行信息编码，所以它可以更进一步说，“SomeFunc+0x25 最接近 foo.cpp 第 57 行”。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-07-17T22:31:37.547

查看 DWARF 调试规范，深入了解 gcc 生成的所有调试信息以及调试器如何使用它。

[DWARF 3 调试规范](http://dwarfstd.org/Dwarf3.pdf)

# c# - 如何给 ASP.Net 自定义控件一个新的自定义事件

> ID：582707
> 
> 赞同：4
> 
> 时间：2009-02-24T17:32:28.123
> 
> 标签：c#, asp.net, events

我觉得这是谷歌应该能够为我解决的问题，但我几乎找不到我真正理解的例子。

我有这个名为 UserControlTask​​ 的自定义控件。我希望向它添加一个 OnHide 事件，顾名思义，我希望在隐藏用户控件时抛出它。

我似乎找到了很多像 OnClick 这样的覆盖事件的示例，但没有一个添加全新事件的示例。

我真正知道的是我需要声明 EventHandler ......

```
public event EventHandler Hide; 
```

然后我相信将 OnHide 添加到我的 CreateChildControls 方法中的属性中。我认为无论如何都是准确的。除此之外，我什么都不知道。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-24T17:45:02.787

您的问题不在于添加事件（这很简单：

```
public event EventHandler Hide;

// this is the function that raises the event
private void OnHide() {
    if (Hide != null)
        Hide(this, new EventArgs());
} 
```

您的问题是知道何时调用`OnHide()`（引发事件） - 因为无法知道用户何时隐藏控件（我假设您正在谈论客户端发生的事情），所以您没有时间应该引发这个事件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-24T17:43:25.833

您可能混淆了引发事件的方法和事件本身。

`Control.OnClick`是引发`Control.Click`事件的方法。在覆盖 OnClick（并调用 base.OnClick）的子类中，无需通过处理程序即可进行处理。

另一方面，组成的控件必须直接使用事件。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-24T17:51:22.600

真的是两件简单的事。

在自定义控件中要做的第一件事是声明一个事件对象：

```
public event System.EventHandler EmployeeSelected; 
```

然后从那里，在您希望引发事件的代码中，您执行以下操作：

```
protected void btnSelectEmployee_Click(object sender, EventArgs e)
{        
    if (!string.IsNullOrEmpty(txtSearchEmployeeId.Text)) 
    {
       EmployeeSelected(this, new EventArgs());
    }       
} 
```

然后在您的主调用类中，您根据需要使用事件和处理。

如果您还想传递事件参数，还可以做一些额外的事情。

*注意：我从自己的应用程序中添加了一些代码。我认为你可以很容易地推断出你自己的应用程序。*

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-07-19T12:16:11.330

这只是解决方案的一个插件。如何在VB中解决这个问题。将以下内容添加到控件中；

```
Delegate Sub OnCompleted()

Public Event Completed As OnCompleted 
```

需要时在控件中引发事件

```
RaiseEvent Completed() 
```

然后在父页面中，您可以像这样 cacth 该事件

```
<asp:somecontrol OnCompleted="SomeControl_OnCompleted"... 
```

然后像这样在后面的代码中处理

```
Protected Sub SomeControl_OnCompleted() Handles SomeControl.Completed 
```

简单，只需确保您的事件处理程序与您的委托声明相同。

# delphi - 为什么不应该在组件创建或流式传输期间使用句柄？

> ID：582721
> 
> 赞同：4
> 
> 时间：2009-02-24T17:35:38.847
> 
> 标签：delphi, custom-controls, sdl, vcl

我想制作一个通过 SDL_CreateWindowFrom 函数包装 SDL 渲染表面的自定义 VCL 控件。SDL_CreateWindowFrom 采用现有的 HWND 句柄并将高性能渲染上下文（它有多个可用的后端，包括 DirectX 和 OpenGL）放到它上面。

帮助文件显示“不要在组件创建或流式传输期间引用 Handle 属性。” 但它没有说明原因。它表示当您第一次尝试访问 Handle 属性时，它将调用 HandleNeeded 以确保存在有效的句柄。

所以我有两个问题。1：在组件创建过程中不应该引用Handle属性的原因是什么？2\. 如果控件的全部目的是包装需要初始化 HWND 的渲染表面，那么何时可以安全地执行（理想情况下）应该在创建/流式传输期间进行的初始化？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-02-24T17:59:33.080

在它的核心，它是一个性能的东西。在流式传输过程中，可能还会发生其他“不良”副作用。事情处于“建设中期”，通常预期的一切可能都没有。

当您引用“句柄”属性时，这将启动句柄创建过程。这是因为读取Handle实际上调用了GetHandle。在流式传输过程中过早地执行此操作，您可能最终会得到最好的流式传输性能，更糟糕的是，部分配置的“句柄”。

如果您需要从属性设置器中正确引用句柄，则应通过检查 HandleAllocated 来检查句柄是否已创建，然后才引用它。如果您需要对句柄进行一些标志更改，例如调用 SetWindowLong() 或其他内容，那么您应该在组件实例中“缓存”该状态，然后覆盖 CreateWnd 并在此时应用这些设置。另一种选择是在流式传输时推迟所有句柄访问（如果 csLoading 在 ComponentState 中），直到调用 Loaded 虚拟方法。

最后，您需要注意可能需要重新创建句柄的情况。如果周围的表单或父组件的句柄经过重新创建过程，就会发生这种情况。直到最近的 Windows 版本，更改某些窗口标志的唯一方法是销毁句柄并在 CreateWindowEx() 调用中使用新标志重新创建。有许多组件仍然可以做到这一点。您可以通过检查 (csRecreating in ControlState) 了解您是否处于重新创建状态。

所以要直接回答你的问题，最好的地方是覆盖 CreateWnd 并在那里做你的工作。CreateWnd 只会在创建句柄时被调用。一个设计合理的组件在显示之前应该只调用一次 CreateWnd。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-24T17:48:47.880

要回答您的第二个问题：假设您的控件是*TCustomControl*您可能应该覆盖*CreateWindowHandle()*。这样做的好处是，每次为控件创建新的窗口句柄时，都会正确重复所有初始化。这允许更改一些在不重新创建窗口的情况下无法设置或重置的窗口样式标志。它还允许通过在不需要句柄时释放句柄并在以后重新创建它来节省资源。

# python - 如何导入在 __init__.py 中定义的类

> ID：582723
> 
> 赞同：123
> 
> 时间：2009-02-24T17:35:55.930
> 
> 标签：python, packages

我正在尝试组织一些模块供我自己使用。我有这样的事情：

```
lib/
  __init__.py
  settings.py
  foo/
    __init__.py
    someobject.py
  bar/
    __init__.py
    somethingelse.py 
```

在`lib/__init__.py`中，我想定义一些在导入 lib 时要使用的类。但是，如果不将类分成文件并将它们导入`__init__.py`.

而不是说：

```
 lib/
      __init__.py
      settings.py
      helperclass.py
      foo/
        __init__.py
        someobject.py
      bar/
        __init__.py
        somethingelse.py

from lib.settings import Values
from lib.helperclass import Helper 
```

我想要这样的东西：

```
 lib/
      __init__.py  #Helper defined in this file
      settings.py
      foo/
        __init__.py
        someobject.py
      bar/
        __init__.py
        somethingelse.py

from lib.settings import Values
from lib import Helper 
```

有可能，还是我必须将类分成另一个文件？

## 编辑

好的，如果我从另一个脚本导入 lib，我可以访问 Helper 类。如何从 settings.py 访问 Helper 类？

[此处](http://docs.python.org/tutorial/modules.html)的示例描述了包内引用。我引用“子模块经常需要相互引用”。就我而言，lib.settings.py 需要 Helper，而 lib.foo.someobject 需要访问 Helper，那么我应该在哪里定义 Helper 类？

* * *

## 回答 #1

> 赞同：93
> 
> 时间：2009-02-24T18:52:35.090

1.  '`lib/`的父目录必须在`sys.path`.

2.  您的 ' `lib/__init__.py`' 可能如下所示：

    ```
    from . import settings # or just 'import settings' on old Python versions
    class Helper(object):
          pass 
    ```

那么下面的例子应该可以工作：

```
from lib.settings import Values
from lib import Helper 
```

### 回答问题的编辑版本：

`__init__.py`定义您的包裹从外部看起来如何。如果您需要使用`Helper`in`settings.py`然后`Helper`在不同的文件中定义，例如，' `lib/helper.py`'。

```
.
| `-- import_submodule.py
    `--库
    |-- __init__.py
    |-- 富
    | |-- __init__.py
    | `--someobject.py
    |-- 助手.py
    `-- 设置.py

2个目录，6个文件

```

命令：

```
$ python import_submodule.py 
```

输出：

```
settings
helper
Helper in lib.settings
someobject
Helper in lib.foo.someobject

# ./import_submodule.py
import fnmatch, os
from lib.settings import Values
from lib import Helper

print
for root, dirs, files in os.walk('.'):
    for f in fnmatch.filter(files, '*.py'):
        print "# %s/%s" % (os.path.basename(root), f)
        print open(os.path.join(root, f)).read()
        print

# lib/helper.py
print 'helper'
class Helper(object):
    def __init__(self, module_name):
        print "Helper in", module_name

# lib/settings.py
print "settings"
import helper

class Values(object):
    pass

helper.Helper(__name__)

# lib/__init__.py
#from __future__ import absolute_import
import settings, foo.someobject, helper

Helper = helper.Helper

# foo/someobject.py
print "someobject"
from .. import helper

helper.Helper(__name__)

# foo/__init__.py
import someobject 
```

* * *

## 回答 #2

> 赞同：25
> 
> 时间：2015-06-30T14:27:43.993

如果`lib/__init__.py`定义了 Helper 类，那么在 settings.py 中你可以使用：

```
from . import Helper 
```

这有效，因为 . 是当前目录，从设置模块的角度来看，它是 lib 包的同义词。请注意，不必通过 导出 Helper `__all__`。

（用 python 2.7.10 确认，在 Windows 上运行。）

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-02-24T17:42:59.033

您只需将它们放在 __init__.py 中。

所以 test/classes.py 是：

```
class A(object): pass
class B(object): pass 
```

...和 ​​test/__init__.py 是：

```
from classes import *

class Helper(object): pass 
```

您可以导入测试并访问 A、B 和 Helper

```
>>> import test
>>> test.A
<class 'test.classes.A'>
>>> test.B
<class 'test.classes.B'>
>>> test.Helper
<class 'test.Helper'> 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2014-06-03T09:39:20.687

添加这样的东西`lib/__init__.py`

`from .helperclass import Helper`

现在您可以直接导入它：

`from lib import Helper`

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-02-24T17:42:24.900

编辑，因为我误解了这个问题：

只需将`Helper`课程放入`__init__.py`. 那是完美的pythonic。来自 Java 等语言的感觉很奇怪。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-02-24T17:49:28.830

是的，有可能。您可能还想`__all__`在`__init__.py`文件中定义。这是您执行时将要导入的模块列表

```
from lib import * 
```

* * *

## 回答 #7

> 赞同：-7
> 
> 时间：2011-01-04T15:09:22.667

也许这可以工作：

```
import __init__ as lib 
```

# c# - Array 的通用替代方案是什么？

> ID：582725
> 
> 赞同：3
> 
> 时间：2009-02-24T17:36:38.253
> 
> 标签：c#, .net, arrays, generics

在 C# 中，一些集合（例如`ArrayList`和）`HashTable`具有通用替代项，即`List<T>`和`Dictionary<TKey, TValue>`。

**Array 是否也有通用的替代方案？**

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-24T17:37:54.553

不 - 只需使用强类型数组，例如`int[]`. 首先使用“弱类型”相对较少`Array`- 事实上，我不相信您真的可以创建一个。Every`Array`确实是一个强类型的，即使你没有那样引用它。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-24T17:39:18.557

Array 在特殊的编译器支持下一直是通用的。

例如 System.Array 允许对象进入，但 int[] 不允许。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-02-24T17:45:02.070

如果您正在寻找与数组最相似的通用集合类型，那么您可能需要一个`List<T>`. 但这不是一回事。

扩展其他人所说的：拥有泛型类型的目的是让程序员可以根据当前程序的需要使用这些泛型类型*的特定于类型的实例。*数组*已经*是特定类型的。你总是可以只拿一个`T[]`.

例如，看看这个简单的函数定义：

```
void SomeFunction(int[] x) 
```

你也可以这样想：

```
void SomeFunction<T>(T[] x) 
```

程序员只是选择使用`int`类型参数调用它：

```
SomeFunction<int>(myIntArray) 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-24T17:40:16.887

扩展乔恩的答案

数组没有通用的替代品，因为拥有一个通用的数组是非常好的。

```
public static T[] CreateArray<T>(T item1, T item2) {
   T[] array = new T[2];
   array[0] = item1;
   array[1] = item2;
   return array;
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-25T02:20:44.327

不需要通用替代方案，因为当您定义数组时，您会声明数组的类型。您提到的所有类都是简单的集合类。aray 是一种完全不同的数据结构。

# bash - 无需在 bash 中按 ctrl+r 即可触发反向 i-search 的替代方法

> ID：582726
> 
> 赞同：3
> 
> 时间：2009-02-24T17:37:16.207
> 
> 标签：bash, search, keyboard-shortcuts, history

bash 中的 reverse-i-search 工具很有用，但它与大多数其他 bash 命令不同，它似乎绑定到键绑定 ( `Ctrl`+ `R`)。用户如何使用别名或键入命令来触发此功能？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-24T20:59:17.500

reverse-i-search 函数实际上是一个 readline 函数 (reverse-search-history) 而不是 bash 内置函数（man builtin 或参见[bash 参考手册中的内置命令](http://www.gnu.org/software/bash/manual/bashref.html#Shell-Builtin-Commands)）。据我所知，除了将它绑定到一个键之外，没有办法调用 readline 函数。

您可以使用“”查看所有与这些功能的 readline 键绑定`bind -l -p`。[可绑定的 readline 命令](http://www.gnu.org/software/bash/manual/bashref.html#Bindable-Readline-Commands)列表也可以在参考手册中找到。

您始终可以使用该`history`命令获取历史列表并使用它`grep`来查找您要查找的内容。我自己觉得这很有用：

```
alias hists="history | grep -v '^ *[0-9]* *hists' | grep $@" 
```

当我运行时，`hists something`我会得到所有匹配的命令列表`something`。我所要做的就是执行 !# 来运行命令。例如：

```
bash-3.2$ hists emacs
   30 emacs
  128 emacs
  129 emacs
  204 emacs
  310 emacs .bash_history
  324 emacs Documents/todo.txt
bash-3.2$ !324 
```

这不完全是您正在寻找的东西，但它已经尽可能接近了。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-11T03:34:05.053

如果您查看“历史扩展 > 事件指示符”下的 bash 或历史 (3readline) 手册页，您会看到执行此类操作的命令。

```
!?prof? 
```

会调出包含“prof”的最新命令并立即执行。如果你想打印命令而不执行它，你可以附加“:p”

```
!?prof?:p 
```

为了在命令行编辑命令，使用上面的例子，输入：

```
!?prof 
```

（不要按回车）然后按 M-^

这些使用 bash 的扩展工具。他们只得到最近的比赛。

如果您想编写脚本或别名，请查看 bash 手册页的内置命令“fc”和“history”（-p 或 -s）。还有“shopt -s histreedit”。

这是一个示例别名：

```
alias dothis='`history -p "!?jpg?"`' 
```

（那些是单引号内的反引号）。

你也可以用这些命令做一些很酷的“s/old/new”和其他东西。

# entity-framework - E2L：您如何处理参与多个关系的外键？

> ID：582742
> 
> 赞同：2
> 
> 时间：2009-02-24T17:40:36.497
> 
> 标签：entity-framework, database-design, linq-to-entities

我有一个这样的数据库模型

FlowObject
FlowObjectID (PK)
描述
Active

ProcessObject
FlowObjectID (PK, FK)
HasSubmit

DecisionObject
FlowObjectID (PK, FK)
YesFlowObjectID (FK)
NoFlowObjectID (FK)
YesCaption
NoCaption

当我尝试使用创建我的实体模型时，我在我的项目中收到此警告。

存储模型中省略了外键约束“FK_ProcessObject_FlowObject1”。表 'Investigations.Store.ProcessObject' 的列 'FlowObjectID' 是参与多个关系的外键。一对一的实体模型将不会验证，因为数据不一致是可能的。

？？？

为什么它丢弃了我的外键？因为“一对一的实体模型将无法验证，因为可能存在数据不一致。”

所以听起来好像是因为数据不一致而放弃了 FK，但放弃 FK 实际上会降低日期一致性？

我应该重新设计我的数据库吗？L2E 是否有办法处理参与多个关系的 FK？让 FK 参与多个关系是否被认为是糟糕的数据库设计？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-13T05:01:05.037

您所描述的转换为面向对象的术语是，FlowObject 包含一个可选的 ProcessObject 和一个可选的 DecisionObject。如果这是您真正的意思，那么数据库架构是正确的。

如果您尝试让 ProcessObject 和 DecisionObject*扩展*FlowObject，则可能会出现不一致，因为 ProcessObject 和 DecisionObject 行都可能存在。为了消除不一致，联合子类建模技术是合适的：只有 ProcessObject 和 DecisionObject 表存在，每个表都包含所有相关字段，而 FlowObject 作为一个抽象基类，成为一个视图，由公共基础字段之间的联合组成。两张桌子。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2011-02-09T11:59:38.680

我在尝试重构时遇到了同样的[错误](https://stackoverflow.com/questions/4876493/need-to-refactor-ef-4-model-with-complex-tpt-inheritance)。在 EFv1 (.NET 3.5) 中，这[无法解决](http://social.msdn.microsoft.com/Forums/en-US/adodotnetentityframework/thread/0e875afc-afec-4438-bae3-80cc37a8ba08/)。在 EFv4 (.NET 4.0) 中，您可以将独立关联（EFv1 中唯一可用的关联/关系）更改为外键关联，它将起作用。但是 FK 协会还有一些其他的缺点，所以它不是灵丹妙药。

# asp.net - 如何从 ASPX.VB 函数内部调用 ASHX？

> ID：582748
> 
> 赞同：1
> 
> 时间：2009-02-24T17:41:32.373
> 
> 标签：asp.net, vb.net, ashx

我需要从我用 ASHX 制作的 API 中获取一个值，通常它是从 javascript 调用的，但我需要在 ASP.NET 中直接调用它我认为这应该不是问题，但我不确定语法。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-24T17:44:58.233

那么你有几个选择

1.  您可以将 ASHX 中的代码重构为共享库中，这样您就可以直接访问方法和处理程序。
2.  如果成员不是私有的，您可以实例化处理程序并调用它们。
3.  您可以向处理程序创建 webrequest 并处理响应。

这些只是一些简单的方法。

我个人喜欢第一种方法，因为它促进了代码重用，但根据场景你可以做你喜欢的事情。

编辑以提供评论中问题的答案。

本质上是的...不是在您的处理程序中包含一堆代码，而是创建一个在上下文中对您有意义的类。在该类中，您可以放置​​处理程序中的逻辑。然后从您的处理程序中，您可以创建一个实例或调用该类的静态版本（取决于您如何实现它）将 HttpContext 对象或该逻辑正确运行所需的任何内容传递给它。在您的 ASPX 页面中执行相同的操作。您现在可以从应用程序中的任何位置调用包含逻辑的对象，而不是将其单独驻留在处理程序中。

前任：

```
Public Class MyCommonLogic
    Public Shared Function ReturnSomethingCommon(context As HttpContext) As String
        Return "Hello World!"
    End Function
End Class 
```

然后从处理程序或aspx页面..

```
Dim something As String = MyCommonLogic.ReturnSomethingCommon(...) 
```

我将函数设为静态，但这只是一个示例，当然我会实现它，但在您的场景中会更有意义。

将代码更改为 VB 对此感到抱歉。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-24T17:45:53.737

如果 ASHX 在同一台服务器上，尤其是在同一个 Web 应用程序中，您应该将 ashx 中的逻辑重构为 aspx 和 ashx 都可以调用的公共类。

否则你可以看看使用： System.Net.WebClient

# asp-classic - SMTP 配置 SendUsing 配置值对 ASP-Classic 无效

> ID：582756
> 
> 赞同：10
> 
> 时间：2009-02-24T17:44:28.530
> 
> 标签：asp-classic, email

我正在尝试使用 ASP 经典发送电子邮件，但在 SMTP 配置方面遇到了问题。

错误：

> CDO.Message.1 错误“80040220”“SendUsing”配置值无效。

代码（用于电子邮件本身）：

```
Set objMsg = Server.CreateObject("CDO.Message")  
objMsg.From     = "name@name.com"  
objMsg.To       = "themetatron@gmail.com"  
objMsg.Subject  = "Procurement Ally Update"  
objMsg.TextBody = strBody 
```

我尝试使用（pt 1）配置的代码：

```
sch = "http://schemas.microsoft.com/cdo/configuration/"  
Set cdoConfig = CreateObject("CDO.Configuration")   
    With cdoConfig.Fields   
        .Item(sch & "smtpserver") = "127.0.0.1"   
        .update   
    End With 
```

那没有用，所以我尝试了：

```
objMsg.Configuration.Fields.Item("http://schemas.microsoft.com/cdo/configuration/smtpserver") = "localhost"  
objMsg.Configuration.Fields.Item("http://schemas.microsoft.com/cdo/configuration/smtpserverport") = 25  
objMsg.Configuration.Fields.Update 
```

那也没用。

（是的，我没有展示它，但最后有一个电话到`objMsg.Send`）

据我所知，本地邮箱 SMTP 服务正在运行并准备好履行职责。

任何人都可以帮忙吗？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2009-02-24T18:21:54.960

如果您指定 smptserver，请务必将您的“ [sendusing](http://msdn.microsoft.com/en-us/library/ms873037(EXCHG.65).aspx) ”字段也设置为 2（或 cdoSendUsingPort）：

```
objMsg.Configuration.Fields.Item("http://schemas.microsoft.com/cdo/configuration/sendusing") = 2
objMsg.Configuration.Fields.Item("http://schemas.microsoft.com/cdo/configuration/smtpserver") = "localhost"
objMsg.Configuration.Fields.Item("http://schemas.microsoft.com/cdo/configuration/smtpserverport") = 25
objMsg.Configuration.Fields.Update 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2020-03-22T18:57:52.897

由于 SMTP 服务位于本地主机上，因此使用 SendUsingPickup (1) 发送到分拣目录更有意义。这将比通过网络发送到端口 25 更有效。

```
objMsg.Configuration.Fields.Item("http://schemas.microsoft.com/cdo/configuration/sendusing") = 1
objMsg.Configuration.Fields.Item("http://schemas.microsoft.com/cdo/configuration/smtpserverpickupdirectory") = "C:\Inetpub\mailroot\Pickup"
objMsg.Configuration.Fields.Update 
```

# c# - 无法将图像渲染到 HttpContext.Response.OutputStream

> ID：582766
> 
> 赞同：8
> 
> 时间：2009-02-24T17:45:41.787
> 
> 标签：c#, asp.net, gdi+, system.drawing

基本上我试图在 ASP.NET 处理程序中呈现一个简单的图像：

```
public void ProcessRequest (HttpContext context)
{
    Bitmap image = new Bitmap(16, 16);
    Graphics graph = Graphics.FromImage(image);

    graph.FillEllipse(Brushes.Green, 0, 0, 16, 16);

    context.Response.ContentType = "image/png";
    image.Save(context.Response.OutputStream, ImageFormat.Png);
} 
```

但我得到以下异常：

```
System.Runtime.InteropServices.ExternalException: A generic error
occurred in GDI+.
    at System.Drawing.Image.Save(Stream stream, ImageCodecInfo encoder,
    EncoderParameters encoderParams) 
```

解决方案是使用它而不是将图像写入 OutputStream：

```
MemoryStream temp = new MemoryStream();
image.Save(temp, ImageFormat.Png);
byte[] buffer = temp.GetBuffer();
context.Response.OutputStream.Write(buffer, 0, buffer.Length); 
```

所以我只是好奇为什么第一个变体有问题？

编辑：HRESULT 是 80004005，它只是“通用”。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-25T03:24:01.337

作者确实需要寻求正确地写入流。

但是在您最后的源代码中，请确保您确实使用 MemoryStream.ToArray() 来获取正确的数据，或者，如果您不想复制数据，请使用 MemoryStream.GetBuffer() 和 MemoryStream.Length 而不是长度返回的数组。

GetBuffer 将返回 MemoryStream 使用的内部缓冲区，其长度一般大于已写入流的数据长度。

这将避免您在流的末尾发送垃圾，并且不会弄乱一些不会容忍尾随垃圾的严格图像解码器。（并且传输更少的数据......）

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2010-05-16T15:50:22.923

Image.Save(MemoryStream stream) 确实需要一个可以查找的 MemoryStream 对象。context.Response.OutputStream 是只转发的，不支持搜索，所以你需要一个中间流。但是，您不需要字节数组缓冲区。您可以直接从临时内存流写入 context.Response.OutputStream：

```
/// <summary>
/// Sends a given image to the client browser as a PNG encoded image.
/// </summary>
/// <param name="image">The image object to send.</param>
private void SendImage(Image image)
{
    // Get the PNG image codec
    ImageCodecInfo codec = GetCodec("image/png");

    // Configure to encode at high quality
    using (EncoderParameters ep = new EncoderParameters())
    {
        ep.Param[0] = new EncoderParameter(Encoder.Quality, 100L);

        // Encode the image
        using (MemoryStream ms = new MemoryStream())
        {
            image.Save(ms, codec, ep);

            // Send the encoded image to the browser
            HttpContext.Current.Response.Clear();
            HttpContext.Current.Response.ContentType = "image/png";
            ms.WriteTo(HttpContext.Current.Response.OutputStream);
        }
    }
} 
```

此处提供了功能齐全的代码示例：

[使用 ASP.NET 自动生成抗锯齿文本图像](http://www.dlssoftwarestudios.com/blog/?p=63)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-24T18:01:58.580

我认为问题在于 Response.OutputStream 不支持搜索。为了保存 PNG（或 JPEG），图像对象需要能够非顺序地写入输出。如果我没记错的话，如果您将图像保存为 BMP 就可以了，因为可以在不查找流的情况下写入该图像格式。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-24T21:45:04.053

好的，我使用了 Stream 的包装器（实现 Stream 并将调用传递给底层流）以确定 Image.Save() 调用 Position 和 Length 属性而不检查返回 false 的 CanSeek。它还尝试将 Position 设置为 0。

所以似乎需要一个中间缓冲区。

# sql - 为 SQL 插入生成 ID 的最佳方法是什么？

> ID：582770
> 
> 赞同：3
> 
> 时间：2009-02-24T17:47:47.400
> 
> 标签：sql, rdbms-agnostic

生成将在 INSERT 语句中立即使用的 ID 号的最佳、独立于 DBMS 的方法是什么，使 ID 大致按顺序排列？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-02-24T17:51:55.017

DBMS 独立？那是个问题。两种最常见的方法是自动递增列和序列，大多数 DBMS 只做其中之一，但不会同时做这两个。因此，独立于数据库的方法是让另一个表具有一个具有一个值的列，您可以锁定、选择、更新和解锁。

通常我会说“与 DBMS 无关”，并使用 PostgreSQL 中的序列或 MySQL 中的自动增量列来做到这一点。就我的目的而言，支持两者都比试图找出一种适用于任何地方的方法要好。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-02-24T17:56:09.843

如果您可以使用您选择的编程语言创建[全局唯一标识符](http://en.wikipedia.org/wiki/Globally_Unique_Identifier)(GUID) - 将其视为您的 id。

在进行故障排除时，它们更难使用（输入`where`INT 条件要容易得多），但也有一些优点。通过在本地将 GUID 分配为您的键，您可以轻松地建立父子记录关系，而无需先将父级保存到数据库并检索 id。并且由于 GUID，根据定义，是唯一的，您不必担心增加服务器上的密钥。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-24T17:56:00.313

有自动递增或顺序

这有什么意义，这是你最不担心的？

您将如何处理 SQL 本身？MySQL有限制，

SQL Server 有顶级，

甲骨文有等级

然后还有一百万个其他的东西，比如触发器、改变表语法等

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-24T17:59:03.097

是的，原始 SQL 中的明显方法（以及我的偏好顺序）是 a) 序列 b) 自增字段。更好、更现代、更独立于 DBMS 的方法是根本不接触 SQL，而是使用（好的）ORM。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-24T18:05:20.820

没有通用的方法可以做到这一点。如果有，每个人都会使用它。从定义上讲，SQL 厌恶这个想法 - 它是基于集合的逻辑的反模式（尽管在许多实际情况下是有用的）。

您尝试从其他地方插入标识值的最大问题是当 SQL 语句涉及多条记录时，必须同时生成多个值。

如果您需要它，请将其作为您的选择要求的一部分，以便数据库与您的应用程序一起使用。任何严肃的 DBMS 产品都会提供自己的使用机制，并且很容易围绕 DML 中的差异进行编码。变化几乎都在 DDL 中。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-24T18:31:09.260

我总是选择数据库特定的解决方案，但如果你真的*必须*这样做的通常方法是实现你自己的序列。您的 RDBMS 必须支持事务。

您创建一个包含 int 列的序列表并使用第一个数字作为种子，然后您的事务逻辑看起来像这样

```
开始交易
更新 tblSeq 设置 intID = intID + 1
从 tblSeq 中选择 @myID = intID

插入 tblData (intID, ...) 值 (@myID, ...)
结束交易

```

事务强制写锁，这样下一个排队的插入不能在记录插入到 tblData 之前更新 tblSeq 值。只要所有插入都通过此事务，那么您生成的 ID 就是按顺序排列的。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-24T17:50:25.677

使用自动递增的 id 列。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-02-24T17:56:22.790

他们真的有理由必须按顺序排列吗？如果您只是将其用作 ID，那么您应该只能使用 UUID 的一部分或 md5(now()) 的前几个数字。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-02-24T17:57:38.577

你可以花时间按摩它。它相当于类似的东西

```
DateTime.Now.Ticks 
```

所以它就像 YYYYMMDDHHMMSSSS

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-02-24T20:22:23.377

它可能有点横向方法，但一个好的 ORM 类型库可能至少能够隐藏差异。例如，在 Ruby 中有 ActiveRecord（通常用于但不只与 Ruby the Rails Web 框架相关联），它具有迁移功能。在与平台无关的代码中声明的表定义中，数据类型、顺序 id 生成和索引创建等实现细节被推到您的视野之下。

我在 SQLite 上透明地开发了一个模式，然后在 MS SQL Server 上实现了它，后来移植到了 Oracle。无需更改生成我的架构定义的代码。

正如我所说，它可能不是您想要的，但封装变化的最简单方法是使用已经为您完成封装的库。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2011-03-08T08:24:12.290

仅使用 SQL，以下可能是方法之一：

1.  创建一个表以包含您需要的起始 id
2.  首次部署应用程序时，应用程序应读取其上下文中的值。
3.  此后，根据需要递增 id（以线程安全方式） 3.1 将 id 写入数据库（以线程安全方式）始终保持更新值 3.2 不要将其写入数据库，只需在内存中递增（线程- 安全的方式）
4.  如果由于任何原因服务器出现故障，请将当前 id 值写入数据库
5.  当服务器再次启动时，它将从上次离开的位置进行选择。

# user-interface - 寻找一些具有出色设计的 GUI 应用程序示例

> ID：582772
> 
> 赞同：6
> 
> 时间：2009-02-24T17:48:34.200
> 
> 标签：user-interface

我将在大约一个月后开始开发我的下一个桌面应用程序。过去，我交付的功能性软件在可用性或美学部门没有让任何人惊叹，包括我自己。

有没有人知道可以展示桌面软件中良好设计示例的任何资源或指南甚至书籍？

Web 应用程序的资源似乎很多，但桌面应用程序的此类资源相当少。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-24T17:55:07.210

我很喜欢[Mark Miller 在 The Science of a Great User Experience 上的这些 dot net rock 电视视频，这](http://www.dnrtv.com/default.aspx?showNum=112)真的让我想到了好的 ui：

[http://www.dnrtv.com/default.aspx?showNum=112](http://www.dnrtv.com/default.aspx?showNum=112)

[http://www.dnrtv.com/default.aspx?showNum=123](http://www.dnrtv.com/default.aspx?showNum=123)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-24T17:56:17.863

如果您正在解决 GUI 中难以理解的概念，那么您真正可以对 GUI 设计产生影响的地方。

当您这样做时，创造力至关重要。在处理复杂的硬件配置时（我不得不做很多事情，但可能不适用于您），我很幸运能够阅读技术手册和技术支持人员并尝试完全理解问题。然后我采用了他们向我展示的方法（手册中的图表、白板图纸等）并尝试将它们编码到 GUI 中。

在这方面取得了一些巨大的成功。

迭代也很关键。快速制作原型，然后求你看到的每个人都尝试一下。让他们解决问题，然后看看他们先去哪里，看看他们有什么问题。

解决每一个问题和绊脚石。

不要害怕把它全部扔掉并重新开始，它只是原型代码。

将您的 GUI 与您的实现分开，以便在找到更好的方法时可以更换 GUI。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-24T17:57:51.587

如果您只想专注于一项功能，请查看 iTunes 的搜索框，该框会在您键入时进行过滤。其他软件可能以前有过这个，但我认为这是我第一次遇到它。

就可读性而言，这与经典搜索之间的区别让我大开眼界。

您在很多地方看到的自动完成是另一种。我推荐 IntelliJ IDEA，因为它采用了 emacs、Visual Studio 等多年来的自动完成方式，并以一种在你第一次遇到它时几乎看起来很灵异的方式为变量名和方法名添加了自动完成功能。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-24T18:00:26.777

你可以看看[Thirteen23 Experiences](http://www.thirteen23.com/experiences/)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-24T18:01:24.247

为了使事情可用，您需要确保遵循目标平台和应用程序类型的现有约定。

例如，如果您正在开发 Windows 应用程序，您最好确保 control-c 复制、control-v 粘贴、control-s 保存等。File 菜单最好是菜单栏中最左侧的项，而通过最右边的项目更好地帮助菜单。

如果你不遵循现有的约定，用户很快就会对你的应用程序感到厌烦。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-24T18:04:48.107

谷歌搜索HIG。人机界面指南通常包括对用户界面最佳实践的大量研究，并详细解释如何设计程序的各个方面。另外，有一个谷歌搜索“用户界面耻辱大厅”或类似的东西。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-02-24T18:06:41.317

在[这个问题](https://stackoverflow.com/questions/556478/top-tips-for-designing-guis)中，我提到了[GUI bloopers](http://www.gui-bloopers.com/)。伟大设计的一部分是知道什么是糟糕的设计以及为什么。这实际上是一本很棒的书，虽然我不知道网站上有多少。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-07-13T09:25:03.700

您可以在 GUI 公司的网站上查看案例研究。我在[www.puzzlehead.com上资助的很少](http://www.puzzlehead.com)

检查那里和其他网站。

# django - 将内容推送到手机

> ID：582782
> 
> 赞同：0
> 
> 时间：2009-02-24T17:50:40.590
> 
> 标签：django

我在一个照片网站上工作，一位更活跃的用户询问有关将内容推送到手机的问题。该站点建立在 django 上，我想知道是否有人知道**允许用户在手机上下载和存储内容（图像）的好方法**？

作为一个附带问题...是否可以通过手机接受内容付款，还是必须在网站上进行？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-24T18:21:06.257

检查您希望支持的电话的用户代理是否在 request.META['HTTP_USER_AGENT'] 中。如果是这样，请呈现移动友好的模板。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-25T07:55:51.573

向移动用户提供内容的最佳方式是将它们转发到移动特定站点。很多地方通过将用户转发到[http://m.mydomain.com/](http://m.mydomain.com/)来做到这一点。正如 Harold 所说，您可以通过检查他们的 UserAgent 字符串来判断他们是否正在使用手机。在以下位置查找更多信息：[基于用户代理更改 Django 模板](https://stackoverflow.com/questions/164427/change-django-templates-based-on-user-agent)

在下载方面，这非常依赖手机。例如，在我的 iPhone 上，我不知道我可以直接从互联网上保存图像。（然而，这可能只是我的无知）。我认为您会在不同移动设备之间的浏览器上遇到很多差异。有多少提供照片下载与不提供等。

对于付款，我建议将其保存在浏览器中。有很多东西可以在手机上发疯，而金钱不是我喜欢冒险的地方之一。话虽如此，您可能会研究某种短信小额支付系统（抱歉，我没有任何建议）或查看与 Verison 等运营商的合作伙伴关系。除此之外，我会说将其保留在应用程序中。

希望能帮助到你。

# scroll - YUI 菜单栏上方的标题，没有滚动问题？

> ID：582786
> 
> 赞同：0
> 
> 时间：2009-02-24T17:51:36.190
> 
> 标签：scroll, yui, menubar

YUI MenuBar 似乎在标题下方存在问题。

HTML：

```
<body class="yui-skin-sam">
    <a id="headerStyle"><img href="/" src="/images/Header.jpg" alt="Home"/></a>
    <div id="menuPanel" style="padding:1px"> 
```

CSS：

```
#headerStyle {
  position:relative;
  width:600px;
  height:100px;
} 
```

Javascript：

```
var oMenu = new YAHOO.widget.MenuBar("mymenu");
oMenu.addItems([
    {
        text: "Main",
        submenu: {
            id: "menu1",
            itemdata: [
               { text: "1" },
               { text: "2" },
               { text: "3" },
               { text: "4" },
               { text: "5" },
               { text: "6" },
               { text: "7" },
               { text: "8" }
    ]
        }
    }
]);
oMenu.render($("#menuPanel").get(0));
oMenu.show(); 
```

第一次单击MenuBar，它只显示3 个滚动项。第一次点击后问题就消失了。

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-24T20:13:06.910

在 CSS 文件中指定 height 属性似乎会导致此问题。简单地删除它就可以让它发挥应有的作用。

# javascript - jQuery UI Draggable - 拖动时需要修改元素

> ID：582789
> 
> 赞同：3
> 
> 时间：2009-02-24T17:51:55.533
> 
> 标签：javascript, jquery, jquery-ui, drag-and-drop

我第一次玩拖放功能，所以我不完全确定我在做什么！

我需要在拖动时向“portlet”添加一个类。我不想使用克隆功能，因为我希望用户拖动实际元素，我只想在拖动元素时对元素进行 nodify，并在删除元素时将其重置。

有人可以帮忙吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-24T18:09:51.277

也许您可以绑定某种“ **beforedrag ”事件？**在用户实际开始拖动它之前将类添加到元素会更容易，而不是在此期间。

如果您使用的是 jQuery UI，您可以使用可拖动的“**开始”事件：**

[http://docs.jquery.com/UI/Draggable#events](http://docs.jquery.com/UI/Draggable#events)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-25T12:41:38.843

此外，您可以像这样使用“助手”选项：

```
helper : function(ev, el) {
  return ($(el).clone().addClass("beingDragged"));
} 
```

如果您的 portlet 将来变得过于重量级而无法拖动，您可以使用它来构建简化版本，同时拖动以使事情变得顺畅 :)

# wpf - WPF RichTextBox 和特定的文化问题

> ID：582794
> 
> 赞同：1
> 
> 时间：2009-02-24T17:53:01.880
> 
> 标签：wpf, richtextbox, language-features, spell-checking

我试图将 System.Windows.Control.RichTextBox 的语言设置为“es-PE”，但我发现
了一些问题，例如在某些计算机中，工作正常，并且 SpellChecker 启用
了“es-PE”语言，但在其他计算机中它只适用于“en-US”，所以我不知道
该控件有什么问题，我在 XAML 和 C# 中使用了以下代码：

这是用户从 GridView 中选择行然后显示附加屏幕截图时的代码

```
 private void dlstInformes_MouseDoubleClick(object sender, MouseButtonEventArgs e)
        {
            if (!dlstInformes.SelectedItem.ToString().Equals(""))
            {
                var source_ = dlstInformes.SelectedItems;
                InformeMedico demo = new InformeMedico(); //New Window

                foreach (informeMedico item in source_)
                {
                    numeroinforme = item.numeroinforme.ToString();
                    nombreinforme = item.nombreinforme;
                    fechainforme = item.fechainforme.ToString();
                    nombreMedico = item.medicoCompleto.ToString();
                    turnoMedico = item.turno.ToString();
                    nombrePaciente = item.pacienteCompleto.ToString();
                    nombreExamen = item.nombreinforme.ToString();

                }
                demo.Language = XmlLanguage.GetLanguage("es-PE");
                demo.txtNombreExamen.Text = nombreinforme;
                demo.lblNroInforme.Content = numeroinforme;
                demo.lblMedicoNombre.Content = nombreMedico;
                demo.lblNombrePac.Content = nombrePaciente;
                demo.lblTurnoMedico.Content = turnoMedico;
            using (DB db = new DB())
            {
                var lstTM = (from ea in db.EXAMENXATENCIONs where ea.turnomedico.Trim() != " " select ea.turnomedico).Distinct().ToList();
                string tm = (from ea in db.EXAMENXATENCIONs where ea.codigo == Convert.ToInt32(numeroinforme) select ea.turnomedico).FirstOrDefault();
                demo.cboTurnoMed.ItemsSource = lstTM;
                demo.cboTurnoMed.SelectedItem = tm;
                demo.cboTurnoMed.SelectedValue = tm;
                demo.cboTurnoMed.Text = tm;
                if (tm.Equals("RE/ES") || tm.Equals("RE/HS") || tm.Equals("RE/HT") || tm.Equals("RE/KV") || tm.Equals("HH/CS") || tm.Equals("HH/ES") || tm.Equals("HH/HS") || tm.Equals("HH/HT") || tm.Equals("HH/KV"))
                {
                    demo.FirmaUnoDefault.Content = "DEN51";
                    demo.FirmaDosDefault.Content = tm;
                }
                else if (tm.Equals("HH/AO") || tm.Equals("IU/AO") || tm.Equals("RE/AO") || tm.Equals("HH/JA") || tm.Equals("RR/JA") || tm.Equals("IU/JA"))
                {
                    demo.FirmaUnoDefault.Content = "DEN51";
                    demo.FirmaDosDefault.Content = "AOY20";
                }
                else if (tm.Equals("IU/CS") || tm.Equals("IU/ES") || tm.Equals("IU/HT") || tm.Equals("IU/KV"))
                {
                    demo.FirmaUnoDefault.Content = "IUU17";
                    demo.FirmaDosDefault.Content = tm;
                }
                else if (tm.Equals("RD/DE"))
                {
                    demo.FirmaUnoDefault.Content = "REE";
                    demo.FirmaDosDefault.Content = "DEN51";
                }
                else if (tm.Equals("RE/JC"))
                {
                    demo.FirmaUnoDefault.Content = "REE";
                    demo.FirmaDosDefault.Content = "JCCH25";
                }
                else if (tm.Equals("RE/CS"))
                {
                    demo.FirmaUnoDefault.Content = "DEN51";
                    demo.FirmaDosDefault.Content = "REE";
                }
            }
            demo.lblCodigoClase.Visibility = Visibility.Hidden;
            demo.lblCodigoEstudio.Visibility = Visibility.Hidden;
            demo.lblCodigoPaciente.Visibility = Visibility.Hidden;
            demo.FirmaUnoDefault.Visibility = Visibility.Hidden;
            demo.FirmaDosDefault.Visibility = Visibility.Hidden;
            demo.rtbHallazgo.Language = XmlLanguage.GetLanguage("es-PE");
            demo.rtbConclusion.Language = XmlLanguage.GetLanguage("es-PE");
            demo.rtbTecnica.Language = XmlLanguage.GetLanguage("es-PE");

            demo.rtbHallazgo.SpellCheck.IsEnabled = true;
            demo.rtbTecnica.SpellCheck.IsEnabled = true;
            demo.rtbConclusion.SpellCheck.IsEnabled = true;
            demo.rtbConclusion.SpellCheck.SpellingReform = SpellingReform.PreAndPostreform;

            demo.ResizeMode = ResizeMode.NoResize;

            demo.Closing += new System.ComponentModel.CancelEventHandler(notClosing_CancelEventArgs);

            demo.ShowDialog();
        }
        else
        {
            MessageBox.Show("Seleccione un item", "Error", MessageBoxButton.OK, MessageBoxImage.Asterisk);
        }
    } 
```

[![替代文字](https://i.stack.imgur.com/DJ3xq.jpg)](https://i.stack.imgur.com/DJ3xq.jpg)

我还尝试从 SO 中配置和删除“en-US”语言，当拼写检查器完全停止时，当我为键盘重新添加该语言时，拼写检查器重新出现。

剧照不使用“es-PE”或仅使用西班牙语作为父级

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-09-08T21:39:14.313

我不确定这是否会有所帮助，但可能值得一试。

在 Application.StartUp 事件中添加以下代码

```
FrameworkElement.LanguageProperty.OverrideMetadata(
            typeof(FrameworkElement),
            new FrameworkPropertyMetadata(
                XmlLanguage.GetLanguage(
                CultureInfo.CurrentCulture.IetfLanguageTag))); 
```

或者您可以修改它以指定 es-PE 而不是当前区域性。

这篇文章可能会提供更深入的详细信息：[Getting a WPF application to pick up the correct region settings](http://www.nbdtech.com/blog/archive/2009/03/18/getting-a-wpf-application-to-pick-up-the-correct-regional.aspx)

# sql-server - 您应该在 SQL Server 中选择 MONEY 还是 DECIMAL(x,y) 数据类型？

> ID：582797
> 
> 赞同：507
> 
> 时间：2009-02-24T17:54:38.850
> 
> 标签：sql-server, types

`money`我很好奇数据类型和类似的东西之间是否存在真正的区别`decimal(19,4)`（我相信这是钱在内部使用的东西）。

我知道这`money`是特定于 SQL Server 的。我想知道是否有令人信服的理由选择其中一个；大多数 SQL Server 示例（例如 AdventureWorks 数据库）使用`money`而不是`decimal`用于价格信息等内容。

我应该继续使用 money 数据类型，还是改用小数有好处？金钱是更少的字符输入，但这不是一个正当的理由:)

* * *

## 回答 #1

> 赞同：376
> 
> 时间：2009-02-24T17:57:57.437

你永远不应该用钱。不精确，纯属垃圾；始终使用十进制/数字。

运行这个看看我的意思：

```
DECLARE
    @mon1 MONEY,
    @mon2 MONEY,
    @mon3 MONEY,
    @mon4 MONEY,
    @num1 DECIMAL(19,4),
    @num2 DECIMAL(19,4),
    @num3 DECIMAL(19,4),
    @num4 DECIMAL(19,4)

    SELECT
    @mon1 = 100, @mon2 = 339, @mon3 = 10000,
    @num1 = 100, @num2 = 339, @num3 = 10000

    SET @mon4 = @mon1/@mon2*@mon3
    SET @num4 = @num1/@num2*@num3

    SELECT @mon4 AS moneyresult,
    @num4 AS numericresult 
```

输出：2949.0000 2949.8525

对于一些说你不要用钱来分钱的人：

这是我计算相关性的查询之一，将其更改为金钱会产生错误的结果。

```
select t1.index_id,t2.index_id,(avg(t1.monret*t2.monret)
    -(avg(t1.monret) * avg(t2.monret)))
            /((sqrt(avg(square(t1.monret)) - square(avg(t1.monret))))
            *(sqrt(avg(square(t2.monret)) - square(avg(t2.monret))))),
current_timestamp,@MaxDate
            from Table1 t1  join Table1 t2  on t1.Date = traDate
            group by t1.index_id,t2.index_id 
```

* * *

## 回答 #2

> 赞同：295
> 
> 时间：2009-02-24T18:09:44.227

SQLMenace 说钱是不准确的。但是你不要用钱乘/除钱！3 美元乘以 50 美分等于多少？150美分？你用标量乘/除钱，标量应该是十进制的。

```
DECLARE
@mon1 MONEY,
@mon4 MONEY,
@num1 DECIMAL(19,4),
@num2 DECIMAL(19,4),
@num3 DECIMAL(19,4),
@num4 DECIMAL(19,4)

SELECT
@mon1 = 100,
@num1 = 100, @num2 = 339, @num3 = 10000

SET @mon4 = @mon1/@num2*@num3
SET @num4 = @num1/@num2*@num3

SELECT @mon4 AS moneyresult,
@num4 AS numericresult 
```

结果是正确的结果：

```
金钱结果数字结果
--------------------- ----------------- ----------
2949.8525 2949.8525
```

`money`只要您不需要超过 4 位十进制数字，并且确保您的标量（不代表金钱）是`decimal`s，就可以了。

* * *

## 回答 #3

> 赞同：80
> 
> 时间：2013-02-26T18:31:39.710

**如果你不知道自己在做什么，一切都是危险的**

即使是高精度的十进制类型也无法挽救这一天：

```
declare @num1 numeric(38,22)
declare @num2 numeric(38,22)
set @num1 = .0000006
set @num2 = 1.0
select @num1 * @num2 * 1000000 
```

1.000000 <- 应该是 0.6000000

* * *

**`money`类型是整数**

`smallmoney`和的文本表示`decimal(10,4)`可能看起来很相似，但这并不能使它们互换。当您看到日期存储为 时，您会畏缩`varchar(10)`吗？这是同一件事。

在幕后，`money`/`smallmoney`只是一个`bigint`/`int` 的文本表示中的小数点`money`是视觉上的绒毛，就像 yyyy-mm-dd 日期中的破折号一样。SQL 实际上并不在内部存储这些内容。

关于`decimal`vs `money`，选择适合您需求的任何内容。存在这些`money`类型是因为将记帐值存储为单位的 1/10000 的整数倍是很常见的。此外，如果您要处理的不是简单的加减法，而是实际的金钱和计算，*那么您不应该在数据库级别这样做！* 使用支持[银行家舍入 (IEEE 754)的库在应用程序级别执行此操作](https://stackoverflow.com/questions/311696/why-does-net-use-bankers-rounding-as-default)

* * *

## 回答 #4

> 赞同：46
> 
> 时间：2012-08-13T00:28:10.547

我意识到 WayneM 曾表示他知道金钱是特定于 SQL Server 的。然而，他问是否有任何理由使用十进制的钱，反之亦然，我认为仍然应该说明一个明显的原因，那就是使用十进制意味着如果你不得不改变你的 DBMS，那就少了一件担心的事情- 这可能发生。

使您的系统尽可能灵活！

* * *

## 回答 #5

> 赞同：34
> 
> 时间：2013-04-29T05:29:17.633

嗯，我喜欢`MONEY`！它比 便宜一个字节`DECIMAL`，并且计算执行得更快，因为（在幕后）加法和减法运算本质上是整数运算。@SQLMenace 的示例（对不知情的人来说是一个很好的警告）同样适用于`INT`egers，结果为零。但这不是不使用整数的理由——*在适当*的情况下。

`MONEY`因此，当您正在处理的内容是`MONEY`并根据它遵循的数学规则（与`INT`eger 相同）使用它时，它是完全“安全”的并且适合使用。

如果 SQL Server 促进`MONEY`s 到`DECIMAL`s（或`FLOAT`s？）的除法和乘法会更好——可能，但他们没有选择这样做；他们也没有选择在划分他们时将`INT`egers提升为`FLOAT`s。

`MONEY`没有精度问题；在计算期间`DECIMAL`使用更大的中间类型只是使用该类型的“特征”（我实际上不确定该“特征”延伸多远）。

要回答具体问题，“令人信服的理由”？好吧，如果您想要绝对最大的性能，`SUM(x)`其中`x`可能是`DECIMAL`or `MONEY`，那么`MONEY`将具有优势。

此外，不要忘记它是较小的表亲，`SMALLMONEY`只有 4 个字节，但它确实最大`214,748.3647`- 这对于金钱来说非常小 - 所以通常不适合。

为了证明使用更大的中间类型的观点，如果将中间显式分配给变量，则会`DECIMAL`遇到同样的问题：

```
declare @a decimal(19,4)
declare @b decimal(19,4)
declare @c decimal(19,4)
declare @d decimal(19,4)

select @a = 100, @b = 339, @c = 10000

set @d = @a/@b

set @d = @d*@c

select @d 
```

产生`2950.0000`（好吧，所以至少`DECIMAL`舍入而不是`MONEY`截断 - 与整数相同。）

* * *

## 回答 #6

> 赞同：16
> 
> 时间：2011-10-25T09:18:51.200

我们刚刚遇到了一个非常相似的问题，我现在非常喜欢 +1，因为除了在顶级演示中之外从不使用 Money。由于历史原因，我们有多个表（实际上是销售凭证和销售发票），每个表都包含一个或多个 Money 字段，我们需要执行按比例计算以计算出总发票 Tax 与每个表相关的比例销售凭证上的一行。我们的计算是

```
vat proportion = total invoice vat x (voucher line value / total invoice value) 
```

这导致现实世界的货币/货币计算导致除法部分的比例错误，然后乘以不正确的增值税比例。当随后添加这些值时，我们最终得到增值税比例的总和，这些总和不等于发票总价值。如果括号中的任何一个值都是小数（我将要转换其中一个），那么增值税比例将是正确的。

当括号最初不存在时，这曾经起作用，我猜是因为涉及的值更大，它有效地模拟了更高的比例。我们添加了括号，因为它首先进行乘法运算，这在极少数情况下会破坏可用于计算的精度，但现在这导致了这个更常见的错误。

* * *

## 回答 #7

> 赞同：14
> 
> 时间：2015-08-13T18:48:22.697

作为对其他答案的总体主旨的反驳。了解*金钱的诸多好处……数据类型！*在[SQLCAT 的关系引擎指南中](http://blogs.msdn.com/b/sqlcat/archive/2013/10/24/sqlcat-com-ebook-downloads.aspx)

具体来说，我会指出以下几点

> 在处理客户实现时，我们发现了一些关于货币数据类型的有趣的性能数据。例如，当 Analysis Services 设置为货币数据类型（从双精度）以匹配 SQL Server 货币数据类型时，处理速度（行/秒）提高了 13%。为了在 SQL Server Integration Services (SSIS) 中获得更快的性能以在 30 分钟内加载 1.18 TB，如 SSIS 2008 中所述 - 世界记录 ETL 性能，观察到将四个十进制 (9,2) 列的大小更改为TPC-H LINEITEM 表中的 5 个字节到钱（8 个字节）提高了 20% 的批量插入速度......性能提高的原因是因为 SQL Server 的表格数据流（TDS）协议，它的关键设计原则是以紧凑的二进制形式传输数据，并尽可能接近 SQL Server 的内部存储格式。根据经验，这在 SSIS 2008 中观察到 - 使用 Kernrate 的世界纪录 ETL 性能测试；当数据类型从十进制转换为货币时，协议显着下降。这使得数据传输尽可能高效。与固定宽度类型相比，复杂数据类型需要额外的解析和 CPU 周期来处理。

所以这个问题的答案是“这取决于”。您需要对某些算术运算更加小心以保持精度，但您可能会发现性能方面的考虑让这很值得。

* * *

## 回答 #8

> 赞同：7
> 
> 时间：2016-09-26T08:09:09.507

我想对 MONEY 与 NUMERICAL 给出不同的看法，主要基于我自己的专业知识和经验......我的观点是 MONEY，因为我已经使用它很长时间了，并且从未真正使用过 NUMERICAL.. .

钱临：

*   **本机数据类型**。它使用与 CPU 寄存器（32 位或 64 位）相同的本机数据类型（*整数*），因此计算不需要不必要的开销，因此它**更****小**更快...... MONEY 需要 8 个字节和 NUMERICAL(19, 4 ) 需要 9 个字节（大 12.5%）...

     **只要它被用于它的本意（作为货币），它就会更快。多快？我对 100 万个数据的简单`SUM`测试表明，MONEY 是 275 毫秒，NUMERIC 是 517 毫秒……这**几乎快了一倍**……为什么要进行 SUM 测试？查看下一个*专业*点** 
***   **最好的钱**。MONEY 最适合存储资金和进行操作，例如会计。在 SUM 操作完成后，单个报表可以运行数百万次加法 (SUM) 和几次乘法。对于非常大的会计应用程序，它的*速度几乎是原来的两倍*，而且非常重要……*   **货币精度低**。现实生活中的金钱不需要非常精确。我的意思是，很多人可能关心 1 美分美元，但 0.01 美分美元呢？事实上，在我国，银行不再关心美分（小数点逗号后的数字）；我不知道美国银行或其他国家...**

 **金钱骗局：

*   **有限的精度**。MONEY 只有四位数（在逗号之后）的精度，所以在进行除法等操作之前必须先转换它......但又`money`不需要那么精确，它是用来作为货币使用的，而不仅仅是一个数字...

但是...很大，但是这里甚至是您的应用程序涉及真实货币，但不要在很多 SUM 操作中使用它，例如在会计中。如果您使用大量除法和乘法，那么您不应该使用 MONEY...

* * *

## 回答 #9

> 赞同：6
> 
> 时间：2018-07-18T20:14:29.913

之前的所有帖子都带来了有效的观点，但有些帖子并没有准确回答这个问题。

问题是：当我们已经知道它是一种不太精确的数据类型并且如果用于复杂的计算会导致错误时，为什么有人会更喜欢它呢？

当您不会进行复杂的计算并且可以用这种精度来满足其他需求时，您就会使用金钱。

例如，当您不必进行这些计算，并且需要从有效的货币文本字符串中导入数据时。此自动转换仅适用于 MONEY 数据类型：

```
SELECT CONVERT(MONEY, '$1,000.68') 
```

我知道您可以制定自己的导入程序。但有时您不想重新创建具有全球特定语言环境格式的导入例程。

另一个例子，当您不必进行这些计算（您只需要存储一个值）并且需要保存 1 个字节（money 需要 8 个字节，而 decimal(19,4) 需要 9 个字节）时。在某些应用程序（快速 CPU、大 RAM、慢 IO）中，例如读取大量数据，这也可以更快。

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2014-01-21T11:49:00.783

我找到了在准确性主题中使用小数而不是金钱的原因。

```
DECLARE @dOne   DECIMAL(19,4),
        @dThree DECIMAL(19,4),
        @mOne   MONEY,
        @mThree MONEY,
        @fOne   FLOAT,
        @fThree FLOAT

 SELECT @dOne   = 1,
        @dThree = 3,    
        @mOne   = 1,
        @mThree = 3,    
        @fOne   = 1,
        @fThree = 3

 SELECT (@dOne/@dThree)*@dThree AS DecimalResult,
        (@mOne/@mThree)*@mThree AS MoneyResult,
        (@fOne/@fThree)*@fThree AS FloatResult 
```

* * *

## 十进制结果 > 1.000000

## 金钱结果 > 0.9999

## 浮点结果 > 1

只需测试它并做出决定。

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2015-08-13T15:36:53.010

当您需要对值进行乘法/除法时，您不应该使用金钱。货币的存储方式与存储整数的方式相同，而十进制存储为小数点和小数位。这意味着货币在大多数情况下会降低准确性，而小数只有在转换回其原始比例时才会这样做。金钱是定点的，所以它的规模在计算过程中不会改变。但是，由于它在打印为十进制字符串时是固定点（而不是作为以 2 为底的字符串中的固定位置），因此可以精确表示高达 4 的值。所以对于加法和减法，钱是可以的。

小数在内部以 10 为基数表示，因此小数点的位置也基于以 10 为基数的数字。这使得它的小数部分准确地代表了它的价值，就像金钱一样。不同之处在于 decimal 的中间值可以保持高达 38 位的精度。

对于浮点数，该值以二进制形式存储，就好像它是一个整数一样，十进制（或二进制，嗯）点的位置是相对于表示该数字的位的。因为它是二进制小数点，所以以 10 为基数的数字在小数点后失去精度。1/5 或 0.2 不能以这种方式精确表示。金钱和小数都不受此限制。

很容易将货币转换为十进制，执行计算，然后将结果值存储回货币字段或变量中。

从我的 POV 来看，我希望发生在数字上的事情会发生，而不必考虑太多。如果所有计算都将转换为十进制，那么对我来说，我只想使用十进制。我会保存钱字段以用于显示目的。

从尺寸上看，我没有看到足以改变主意的差异。Money 占用 4 - 8 个字节，而十进制可以是 5、9、13 和 17。这 9 个字节可以覆盖 8 个字节的 money 可以覆盖的整个范围。索引方式（比较和搜索应该是可比较的）。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2009-10-19T03:31:55.930

我刚刚看到这个博客条目：*[Money vs. Decimal in SQL Server](http://thavash.spaces.live.com/blog/cns!CF6232111374DFD2!223.entry)*。

这基本上是说钱有一个精度问题......

```
declare @m money
declare @d decimal(9,2)

set @m = 19.34
set @d = 19.34

select (@m/1000)*1000
select (@d/1000)*1000 
```

对于该`money`类型，您将获得 19.30 而不是 19.34。不知道有没有把钱分成1000份进行计算的应用场景，但是这个例子确实暴露了一些限制。

# .net - .Net Framework 版本如何处理向后兼容性

> ID：582798
> 
> 赞同：3
> 
> 时间：2009-02-24T17:54:40.893
> 
> 标签：.net, backwards-compatibility

我知道 XP 没有附带 .NET Framework 版本，而且我相当肯定 .NET 2.0 附带 Vista。我的问题是，在 XP 上安装 .Net 2.0 是否也会安装对 .Net 1.1 应用程序的支持？此外，vista 1.1 开箱即用兼容。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-24T17:59:14.750

第一个问题“不是真的”。.NET 1.1 与 2.0 相比是一个独立的框架。他们可以愉快地并排坐在同一台机器上。Vista 不包括 1.1。如果您尝试使用 2.0 运行 1.1 应用程序，可能会[出现问题](http://msdn.microsoft.com/en-us/library/ms994381.aspx)。对第二个问题是：[可以安装](http://www.microsoft.com/downloads/details.aspx?FamilyId=262D25E3-F589-4842-8157-034D1E7CF3A3&displaylang=en)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-24T18:00:30.987

Vista 包括 .NET Framework 2.0 和 3.0 版。正如其他人所说，2.0 可以运行 1.1 应用程序，但[2.0 更改了一些可能会破坏您的 1.1 应用程序的东西](http://searchwindevelopment.techtarget.com/tip/0,289483,sid8_gci1191117,00.html)。

# java - 使用 Java 发送 RTP

> ID：582803
> 
> 赞同：2
> 
> 时间：2009-02-24T17:55:35.650
> 
> 标签：java, rtp

使用 Java 通过 RTP 发送/接收音频数据的最佳方式是什么？我已经阅读了一些关于[JMF](http://en.wikipedia.org/wiki/Java_Media_Framework)的内容，但它似乎已经过时了。是否有其他可行的替代方案。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-24T20:12:42.900

[JMF](http://java.sun.com/javase/technologies/desktop/media/jmf/)仍然是规范的来源，由 Sun 维护。不过，还有很多其他可用的软件包：试试[voip-info.org](http://www.voip-info.org/wiki-Open+Source+VOIP+Software)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-19T20:34:57.543

您可以尝试基于 netty [https://github.com/brunodecarvalho/efflux的 efflux 堆栈](https://github.com/brunodecarvalho/efflux)

# c# - 在运行时将 byte[] 加载到图像中

> ID：582805
> 
> 赞同：12
> 
> 时间：2009-02-24T17:56:04.180
> 
> 标签：c#, wpf, image

我有一个`byte[]`由`Image`. 我正在`Image`通过`WebClient`. 当`WebClient`下载图片并使用它的 URL 引用它时，我得到一个`byte[]`. 我的问题是，如何将 a 加载`byte[]`到`Image`WPF 中的元素中？谢谢你。

*注意*：这是对我在这里提出的问题的补充：[在运行时生成图像](https://stackoverflow.com/questions/580359/generate-image-at-runtime)。我似乎无法让这种方法发挥作用，所以我正在尝试一种不同的方法。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-02-24T18:00:16.510

`BitmapImage`从以下创建一个`MemoryStream`：

```
MemoryStream byteStream = new MemoryStream(bytes);
BitmapImage image = new BitmapImage();
image.BeginInit();
image.StreamSource = byteStream;
image.EndInit(); 
```

在 XAML 中，您可以创建一个`Image`控件并将上述内容设置`image`为**`Source`**属性。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-24T18:02:28.610

您可以使用[`BitmapImage`](http://msdn.microsoft.com/en-us/library/system.windows.media.imaging.bitmapimage.aspx), 并将其设置[`StreamSource`](http://msdn.microsoft.com/en-us/library/system.windows.media.imaging.bitmapimage.streamsource.aspx)为包含二进制数据的流。如果您想`stream`从 a制作 a `byte[]`，请使用 a [`MemoryStream`](http://msdn.microsoft.com/en-us/library/system.io.memorystream.aspx)：

```
MemoryStream stream = new MemoryStream(bytes); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-03-15T09:44:22.117

在 .Net 框架 4.0 中

```
using System.Drawing;
using System.Web;

private Image GetImageFile(HttpPostedFileBase postedFile)
{
   if (postedFile == null) return null;
   return Image.FromStream(postedFile.InputStream);
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2016-03-02T15:44:14.710

我想出如何做到这一点以使其既快速又线程安全的一种方法如下：

```
 var imgBytes = value as byte[];
 if (imgBytes == null)
  return null;
 using (var stream = new MemoryStream(imgBytes))
   return BitmapFrame.Create(stream,BitmapCreateOptions.None, BitmapCacheOption.OnLoad); 
```

在将图像作为数据库中的 Varbinary 运行后，我将其放入 WPF 应用程序的转换器中。

# c# - 查找与机器地址匹配的源代码

> ID：582821
> 
> 赞同：0
> 
> 时间：2009-02-24T17:58:36.810
> 
> 标签：c#, crash-dumps

我正在调试一个故障转储，我很清楚进程在哪个地址崩溃。源代码是用 C# 编写的。我的问题是找到与崩溃地址相关的匹配源代码的任何快速方法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-24T20:09:19.727

[这个博客](http://www.dumpanalysis.org/blog)是一个关于故障转储分析的有用信息的宝库。

这是它开始调试[托管应用程序崩溃转储](http://www.dumpanalysis.org/blog/index.php/2007/07/20/crash-dump-analysis-patterns-part-17/)的地方，值得注意的是，它引用了以前的文章并假设您已阅读并理解它们。它还假设您稍微熟悉 Son of Strike，这是一个非常有用但有点神秘的调试扩展，用于处理托管代码。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-24T18:01:51.733

任何包含调试器的体面的 IDE 都会自动执行此操作。否则，您通常需要在启用调试信息（调试符号）的情况下构建项目（不建议将其用于生产，因为它会使您的程序更大且更容易进行逆向工程），并且调试器命令（如 where 或 trace）将列出程序你所在的行。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-24T18:07:10.440

您需要构建中的符号文件 (.pdb)。

还可以使用 MS 的符号服务器，这样 VS 和 WinDBG 将自动获取正确的符号文件。

# date - 数据参数的默认值，SSRS

> ID：582831
> 
> 赞同：0
> 
> 时间：2009-02-24T17:59:33.627
> 
> 标签：date, reporting-services, parameters, default-value

在我的 SSRS 报告中，我想将日期参数默认为执行日期。我默认日期参数为`=DateValue(Globals!ExecutionTime)` or `=today`。我的报告中确实有 5 个其他参数。

在报告管理器中，每当我选择另一个参数值时，它都会刷新页面。这是为什么？我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-30T15:35:28.190

希望这可以帮助仍然需要的人。

为避免在更改参数时刷新，请避免在参数默认值中使用表达式。

例如，不要指定`=TODAY()`表达式，而是使用 SQL 查询（例如`SELECT getdate() = DefaultDate`，从参数创建数据集），使用查询来引用此数据集以获取默认值。

检查这些：

[http://blog.summitcloud.com/2009/12/fix-refresh-of-parameters-in-ssrs/](http://blog.summitcloud.com/2009/12/fix-refresh-of-parameters-in-ssrs/)

[http://social.msdn.microsoft.com/Forums/en-US/sqlreportingservices/thread/6e5c4137-092f-4d54-a1a1-27730744074d/](http://social.msdn.microsoft.com/Forums/en-US/sqlreportingservices/thread/6e5c4137-092f-4d54-a1a1-27730744074d/)

希望能帮助到你。

# sql-server-2005 - 如何在 T-SQL 中将多行作为单行返回？

> ID：582840
> 
> 赞同：4
> 
> 时间：2009-02-24T18:01:31.517
> 
> 标签：sql-server-2005, tsql

几个月前，我们的供应商为我们的票务系统添加了一项功能，使我们可以向票证添加任意数量的自定义字段。我想查询这些字段以及其他呼叫信息以用于报告目的，但每个可扩展字段都作为一行存储在数据库中。所以基本上你有这样的东西：

```
ext_doc_no    call_record    value
1             1001           Test
2             1001           test2
3             1001           moretest 
```

我想要回查询：

```
1001    Test    test2    moretest 
```

我尝试过使用 PIVOT，但这对使用聚合函数之类的东西要求很高。关于如何做到这一点的任何其他想法？

编辑：我还尝试将每一行分别查询到主查询中，并使用一个函数......但这两种方法都太慢了。我需要一些东西来一次获取所有行，PIVOT 它们然后加入主查询。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-24T18:18:10.960

试着看看[这个答案](https://stackoverflow.com/questions/488020/what-is-your-most-useful-sql-trick-to-avoid-writing-more-code/488897#488897)。

它完全符合您的要求。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-24T18:10:36.750

请参阅此处 [将多行中的值连接到一列有序](http://wiki.lessthandot.com/index.php/Concatenate_Values_From_Multiple_Rows_Into_One_Column_Ordered)SQL 2005+

或者对于 2000 版本，将 [多行中的值连接到一列中](http://wiki.lessthandot.com/index.php/Concatenate_Values_From_Multiple_Rows_Into_One_Column)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-24T18:05:13.393

您想要做的是枢轴（某些系统称其为交叉表查询）。这应该可以帮助您在 google 上获取更多帮助，但通常您需要在编写查询*之前*知道您期望的列。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-24T18:10:46.673

[http://www.sqlservercentral.com/scripts/Miscellaneous/32004/](http://www.sqlservercentral.com/scripts/Miscellaneous/32004/)

使用上面页面的脚本。

```
    声明 @Values VARCHAR(1000)

    选择 @Values = COALESCE(@Values + ', ', '') + 值
    从 .....
    在哪里 ....

    选择@ValuesEND

```

编辑：我不想粗鲁。但是您可以通过搜索“将多行组合为一个”来找到它。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-24T18:16:18.970

以 XML 形式返回数据

```
SELECT ...
FROM ...
...JOIN....
FOR XML AUTO 
```

# compact-framework - .NET Framework Compact Edition 的内存占用量是多少？

> ID：582850
> 
> 赞同：0
> 
> 时间：2009-02-24T18:04:52.740
> 
> 标签：compact-framework, memory-footprint

.NET Framework Compact Edition 的内存占用量是多少？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-24T18:08:14.573

根据[这个 wikipedia page](http://en.wikipedia.org/wiki/.NET_Micro_Framework)，它大约是 12MB

但是话又说回来，[这个页面](http://msdn.microsoft.com/en-us/library/s6x0c3a4.aspx)说它将以 128KB 到 1MB 运行。

我的猜测是，它会根据您有多少可用内存而有所不同，并且它会根据情况在内存中交换碎片。引用第二个链接：

*随机存取存储器 (RAM) 用于存储动态数据结构和 JIT 编译代码。.NET Compact Framework 使用可用 RAM（达到设备指定的限制）来缓存生成的代码和数据结构，然后在适当的时候释放内存。*

*公共语言运行时使用代码调整技术在内存不足的运行时释放 JIT 编译的代码块。这使得更大的程序能够在 RAM 受限的系统上运行而性能损失最小。*

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-24T18:07:54.650

虽然[本文](http://en.wikipedia.org/wiki/.NET_Micro_Framework)不是关于紧凑型框架（它是关于微型版本），但它显示了微型和紧凑型框架之间的比较，并指出 .NET 紧凑型框架的内存占用为**12 MB**。

# html - 删除垂直 div 之间的空间

> ID：582851
> 
> 赞同：6
> 
> 时间：2009-02-24T18:05:08.073
> 
> 标签：html, css

我有三个垂直对齐的 div 彼此重叠。顶部和底部只是在播放器的顶部和底部显示图像。因此协调变成这样

```
<div>
 <img>top</img>
<div>
<div>
  <div></div>
  <div></div>
  <div></div>
</div>
<div>
 <img>bottom</img>
</div> 
```

现在在其顶部和底部的中间 div 之间有白线/空格。但是我明确地将边距和待处理以及边框设置为零，但仍然没有解决方案。

这个问题不会出现在 IE6/IE7/IE8 等，而是所有其他浏览器中。

感谢 bobince，它通过制作垂直对齐：底部但不适用于底部图像，它在顶部图像侧工作。我试图把谁放在首位。

好的，这是详细代码

```
<div id="top" >
    <img alt="topimage" style="vertical-align:bottom">
      <xsl:attribute name="src">
        <xsl:value-of select="TopImage"/>
      </xsl:attribute>
    </img>
  </div>
  <div id="container" style="clear:both;display:block;margin: 0 0 0 0;padding: 0 0 0 0;text-align:left;border:0 none;">
    <div id="left" style="margin: 0 0 0 0;padding: 0 0 0 0;float: left;">
      <img alt="left image"  style="margin: 0 0 0 0;padding: 0 0 0 0;vertical-align:bottom">
        <xsl:attribute name="src">
          <xsl:value-of select="LeftImage"/>
        </xsl:attribute>
      </img>
    </div>

    <div id="flashde260252-c874-4c67-b1aa-64ebe80bb701"  style="margin: 0 0 0 0;padding: 0 0 0 0;float:left;border:0;vertical-align:bottom">
      <embed id="flashde260252-c874-4c67-b1aa-64ebe80bb7010" height="308" width="512" allowfullscreen="true" wmode="transparent" quality="high" bgcolor="#ffffff" name="flashde260252-c874-4c67-b1aa-64ebe80bb7010" style="margin: 0 0 0 0;padding: 0 0 0 0;"  type="application/x-shockwave-flash">
        <xsl:attribute name="src">
          <xsl:value-of select="Movie"/>
          <xsl:text>?flvfile=</xsl:text>
          <xsl:value-of select ="Destination"/>
          <xsl:text >&amp;lang=e&amp;environment=PROD</xsl:text>
        </xsl:attribute>
      </embed>
    </div>

    <div id="rightimage" style="margin: 0 0 0 0;padding: 0 0 0 0;float:left;">
      <img alt="rightimage"  style="vertical-align:bottom">
        <xsl:attribute name="src">
          <xsl:value-of select="RightImage"/>
        </xsl:attribute>
      </img>
    </div>
  </div>
  <!-- <div id="bcontainer" style="margin: 0 0 0 0;padding: 0 0 0 0;text-align:left;border-left:0;border-right:0;border-top:0;border-bottom:0px;border:none;">-->
  <div id="bottom" style="clear:both;display:block;margin: 0 0 0 0;padding: 0 0 0 0;vertical-align:top;text-align:left;border:0 none">
    <img alt="subscribe" src="IRBBottom.jpg" usemap="#promomap" border="0" style="vertical-align:top">
      <xsl:attribute name="src">
        <xsl:value-of select="BottomImage"/>
      </xsl:attribute>
    </img>
  </div>
  <!-- </div> -->
  <div id="toc" style="clear:both;display:block;text-align:left;">
    <ol style="list-style:none;font-size:small;font-weight:bold">
      <li>* Includes all matches from main pitch, plus selected matches from pitch 2 - see FAQ for details.</li>
      <li>** Includes all matches on Finals Day, March 7th from main pitch - see FAQ for details.</li>
      <li>*** All matches on main pitch will be live and matches on pitch 2 will be on demand - see FAQ for details.</li>
    </ol>
  </div>
  <map name="promomap">
    <area shape="rect" coords="229,46,350,137" href="index.html" alt="Subscribe or Login" title="Subscribe or Login"/>
    <area shape="rect" coords="410,47,528,137" href="XXX.html" alt="R Video" title="Ro"/>
  </map>
  <script type="text/javascript">
    <xsl:text disable-output-escaping="yes">
  function showMovie(player,movie,endthumb,destination){
    var so = new SWFObject(player+'?flvfile='+movie+'&amp;endthumb='+endthumb +'&amp;endlink='+destination,'flashde260252-c874-4c67-b1aa-64ebe80bb7010','512','308','8', '#ffffff', 'high','');
    so.addParam('wmode', 'transparent');so.addParam('allowfullscreen', 'true');so.write('flashde260252-c874-4c67-b1aa-64ebe80bb701');
  }
  </xsl:text>
    <xsl:text> showMovie('</xsl:text>
    <xsl:value-of select="Player"/>
    <xsl:text>','</xsl:text>
    <xsl:value-of select="Movie"></xsl:value-of>
    <xsl:text>','</xsl:text>
    <xsl:value-of select="EndThumb"/>
    <xsl:text>','</xsl:text>
    <xsl:value-of select="Destination"/>
    <xsl:text>');</xsl:text>
  </script>
</div> 
```

:) 现在除了 IE 的 lol 之外，它在设置 line-height 之后都可以工作

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-02-24T18:46:53.433

只需将`line-height`顶部和底部 div 的属性设置为`0`.

示例代码：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
    <title>Test</title>
    <style type="text/css">
        #top {
            background-color: #f00;
            line-height: 0px;
        }
        #middle {
            background-color: #0f0;
        }
        #bottom {
            background-color: #00f;
            line-height: 0px;
        }
    </style>
</head>
<body>
    <div id="top">
        <img src="http://i.stackoverflow.com/Content/Img/stackoverflow-logo-250.png"
            alt="Stackoverflow" />
    </div>
    <div id="middle">
        <div>This is the first middle div child.</div>
        <div>This is the second middle div child.</div>
        <div>This is the third middle div child.</div>
    </div>
    <div id="bottom">
        <img src="http://www.gravatar.com/avatar/ae3e50c947379163d74b6de6fa01d509?s=32&amp;d=identicon&amp;r=PG"
            alt="Gripsoft avatar" />
    </div>
</body> 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-02-24T22:55:25.083

如果它在除 IE 之外的所有设备中都能正常工作，那么如果图像标记后有空格，则会出现 IE 错误。尝试这个：

```
<div>
    <img /></div> 
```

而不是这个：

```
<div>
    <img />
</div> 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-02-24T18:09:36.677

图像位于内联框的文本基线上。在图像的左侧和右侧添加文本以验证这一点。文本基线下方有空间为字母的下行（'g'、'y' 等）以及行距腾出空间。

将图像的 CSS 样式“vertical-align”设置为“top”或“bottom”（视情况而定），使其与文本行的边缘而不是基线对齐。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-24T18:54:06.723

你可以给形象`display: block`。或者，您可以跟随图像`<br/>`或将其包装在 div 中（确保没有空格）。`display: block`在这种情况下，除非您出于某种原因需要将 2 个图像放在一起，否则我更愿意使用。

# php - 使用 PHP imagettftext() 将东亚字符呈现为正方形

> ID：582855
> 
> 赞同：1
> 
> 时间：2009-02-24T18:06:08.993
> 
> 标签：php, unicode, fonts

我正在尝试使用 PHP imagettftext 函数渲染带有 verdana 文本的图像。但是，所有东亚字符都没有正确呈现。我尝试使用其他字体，如 tahoma 和 Lucida Grande，但都不起作用。然而，Arial Unicode 可以完美运行。

问题是我不想使用 Arial 作为我的字体。有什么方法可以使用像 Verdana 这样的字体进行渲染？

（不是 unicode 和/或字体专家；所以对问题的解释会有所帮助）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-24T18:22:53.587

Verdana、Tahoma 或 Lucida Grande 都不包含中文/日文/韩文字符，因此它们永远无法“正确”呈现它们。没有字体包含*每个*Unicode 代码点的字形，因此无论您选择哪种字体，最终都会在某些时候丢失字形。

有*一种*字体类似于 Verdana，包含一些 CJK 字符——特别是日文汉字。也许这足以涵盖您正在尝试做的事情？它被称为 Meiryo，并带有 Windows Vista/7。你也可以在[这里](http://www.microsoft.com/downloads/details.aspx?FamilyID=f7d758d2-46ff-4c55-92f2-69ae834ac928&displaylang=en)得到它。但是它是一个 TrueType Collection (.ttc) 文件，我不确定 PHP/GD 是否可以直接处理；许多东亚字体以 .ttc 文件的形式出现，因为它们通常包含基于相同字形形状的比例字体和等宽字体。

如果 PHP 无法处理 .ttc，您可能需要使用字体编辑器或简单的“breakttc.exe”命令行工具将其中的 Meiryo 比例字体转换为单独的 .ttf 文件。 TrueType SDK（ttsdk.zip，从 microsoft.com 神秘消失，但使用 Google 很容易找到）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-24T18:10:30.043

IIRC 您的 truetype 字体中必须包含 unicode 字符。

您可以在 Windows 的字符映射工具中查看某种字体有多少个字符。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-24T20:14:08.903

我之前用**imagettftext**渲染过日文字符，直接使用东亚字体。有一些随 Windows 一起提供的：“simsun”（中文）“MS Gothic”（日文）“Ms Mincho”（日文） 最后两个相当于日文文本的 sans serif 和 serif。我觉得中国人也有这两种风格。在我的旧 php 代码中，它使用带有“.ttc”扩展名的字体文件，不知道为什么。也许 TTF 是定义，而实际字体是 TTC 文件？（那是很久以前的事了）

无论如何，至于在 Windows 上使用 Arial 等，至少它的工作方式是系统检测到“西方”Unicode 范围之外的字符，并将自动切换到默认安装的“亚洲”字体之一来呈现这些。这会导致一些用户获取中文字符而不是日文，反之亦然，因为这些字符中的许多字符共享相同的 unicode 范围，但根据使用的字体，您可以使用“中文”样式或日文样式。

混合两种字体看起来不太好。使用纯日文字体会将字母字符呈现为“等宽”字体，这看起来不太好。

如果一切都失败了，您可以尝试将字符串拆分为单独的西部/东部字符范围子字符串（循环字符并测试 unicode 范围），然后使用适当的字体渲染每个部分。请记住，东方字体是等宽的（至少是中文/日文，我不知道韩文等）。

# perl - 在 Perl 中发出并发 Web 请求的最快方法是什么？

> ID：582856
> 
> 赞同：6
> 
> 时间：2009-02-24T18:06:27.573
> 
> 标签：perl, concurrency

我需要在 Perl 中进行一些并发的 XML 提要请求。*最快*的方法是什么？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-02-24T18:22:53.650

我可能会使用[AnyEvent](http://search.cpan.org/dist/AnyEvent/)，可能是这样的：

```
use AnyEvent;
use AnyEvent::HTTP;

sub get_feeds {
    my @feeds = @_;
    my $done = AnyEvent->condvar;
    my %results;
    $done->begin( sub { $done->send(\%results) } );

    for my $feed (@feeds){
        $done->begin;
        http_get $feed, sub { $results{$feed} = \@_; $done->end };
    }

    $done->end;
    return $done;
}

my $done = get_feeds(...);
my $result = $done->recv; # block until all feeds are fetched 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-26T12:25:42.663

[HTTP::Async](http://search.cpan.org/dist/HTTP-Async/)非常快并且非常容易编码。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2011-03-05T23:59:53.053

实际上，[AnyEvent::Curl::Multi](http://search.cpan.org/perldoc?AnyEvent%3A%3ACurl%3A%3AMulti)是一个建立在 libcurl 之上的非阻塞库。非常快并且有大量的并发可用。比 AnyEvent::HTTP、IMO 强大得多。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-02-24T18:26:56.307

我将[LWP::Parallel::UserAgent](http://search.cpan.org/~marclang/ParallelUserAgent/)用于类似的东西。来自 POD 的示例：

```
require LWP::Parallel::UserAgent;
$ua = LWP::Parallel::UserAgent->new();
...

$ua->redirect (0); # prevents automatic following of redirects
$ua->max_hosts(5); # sets maximum number of locations accessed in parallel
$ua->max_req  (5); # sets maximum number of parallel requests per host
...
$ua->register ($request); # or
$ua->register ($request, '/tmp/sss'); # or
$ua->register ($request, \&callback, 4096);
...
$ua->wait ( $timeout ); 
...
sub callback { my($data, $response, $protocol) = @_; .... } 
```

# c# - 如何取消注册匿名处理程序？

> ID：582860
> 
> 赞同：4
> 
> 时间：2009-02-24T18:07:54.183
> 
> 标签：c#, .net, events, anonymous-methods

C# 2.0 有一个简洁的特性，称为匿名函数。这主要用于事件：

```
Button.Click += delegate(System.Object o, System.EventArgs e)
                   { System.Windows.Forms.MessageBox.Show("Click!"); }; 
```

现在，假设 Button 是一个静态成员，那么向它添加委托将被视为非托管资源。通常，我必须在重新注册之前取消注册处理程序。这是 GUI 编程的一个非常常见的用例。

匿名函数的准则是什么？框架会自动注销吗？如果有，什么时候？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-02-24T18:13:34.217

不，匿名函数不会自动注销。如果在应用程序的整个生命周期内不应关联事件，则应确保自己执行此操作。

当然，要做到这一点，您必须存储委托引用，以便能够取消注册它。就像是：

```
EventHandler handler = delegate(System.Object o, System.EventArgs e)
               { System.Windows.Forms.MessageBox.Show("Click!"); };
Button.Click += handler;
// ... program code

Button.Click -= handler; 
```

另外，请参阅[这个问题](https://stackoverflow.com/questions/183367/unsubscribe-anonymous-method-in-c)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-24T18:13:52.843

如果我没记错的话（我记得我在哪里读到这个）内联匿名代表不能被删除。

您需要分配给（静态）委托字段。

```
private static EventHandler<EventArgs> myHandler = (a,b) => { ... }

myButton.Click += myhandler;
...
myButton.Click -= myHandler; 
```

# vb.net - VB.Net 启动窗口根据 App.config 设置变化，它是如何变化的？

> ID：582865
> 
> 赞同：0
> 
> 时间：2009-02-24T18:08:51.250
> 
> 标签：vb.net, .net-1.1

我有这个 VB.Net 1.1 项目，我必须对其进行一些更改。App.config 文件中有一个标志。如果为 false，则页面仅加载启动画面并正常运行程序。如果是真的，它首先会打开一个登录窗口。

VB.Net 不是我以前使用过的东西。我一生都无法弄清楚选择启动对象的逻辑在哪里。在属性页中，Main.vb 始终设置为启动对象，但这甚至不是标志为 false 时加载的窗口，它始终位于启动屏幕之后。

我已经通过代码搜索了所有关于创建登录窗口的新实例以显示它但找不到它的参考。我已经搜索了它检查标志设置的位置，但我发现的任何内容都不是关于加载登录窗口的参考。

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-24T18:16:56.020

登录窗口类的名称是什么？您可以在整个解决方案中进行搜索以查找该名称的所有出现（例如，通过按 Ctrl+Shift+F）或将光标放在类名上并按 Shift+F12。后者将找到登录窗口类的所有引用。现在在搜索结果窗口中查找新的 MyLoginWindow 以查看它的实例化位置。

从那个位置，您可以再次使用相同的方法来查找被调用者，并可能在代码中检查配置标志的位置（或者您可以放置​​一个断点，调试并遍历调用堆栈以查看您来自哪里- 这可能更容易）。

# c++ - 为什么 boost 的模板化程度如此之高？

> ID：582878
> 
> 赞同：7
> 
> 时间：2009-02-24T18:12:52.207
> 
> 标签：c++, boost

在 boost 中有很多地方我看到了一个模板化的类，并且不禁想到为什么编写它的人使用模板。

例如，互斥锁类。所有互斥锁概念都是作为模板实现的，在模板中可以简单地创建几个基类或抽象类，其接口与该概念相匹配。

回答后编辑：我考虑过虚拟功能的成本，但有时为了更好地理解而放弃很少的性能损失不值得吗？我的意思是有时（尤其是使用 boost），由于滥用模板，很难理解模板化代码和解密编译器错误。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-02-24T18:15:15.570

模板可以在编译时进行高度优化，无需虚函数。许多模板技巧可以被认为是编译时多态性。既然你在编译时就知道你想要什么样的行为，为什么你每次使用这个类时都要为虚函数调用付费。作为奖励，许多模板化代码可以轻松内联，以消除最基本的函数调用开销。

此外，C++ 中的模板非常强大和灵活——它们本身已被证明是一种图灵完备的语言。有些事情很容易用模板完成，但需要更多的运行时多态性工作。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-24T18:20:00.347

模板允许您执行算法的通用版本。容器的通用版本。您不再需要担心类型，并且您生成的内容不再需要与类型绑定。Boost 是一个库集合，旨在满足在日常生活中使用 C++ 的各种人的需求。

# c++ - 将 OpenGL 基元转换为 OpenGLES

> ID：582879
> 
> 赞同：1
> 
> 时间：2009-02-24T18:12:56.840
> 
> 标签：c++, iphone, opengl-es, opengl-to-opengles

我正在尝试从 OpenGL 1.5 规范转换以下代码。OpenGLES 1.1 规范

```
(num_x and num_y are passed into the function by arguments)

::glBegin(GL_LINES);
for (int i=-num_x; i<=num_x; i++) 
{
    glVertex3i(i, 0, -num_y);
    glVertex3i(i, 0,  num_y); 
}

for (int i=-num_y; i<=num_y; i++) 
{
    glVertex3i(-num_x, 0, i);
    glVertex3i( num_x, 0, i);
}

::glEnd(); 
```

这是我相应的转换代码：（忽略我循环的低效率，我试图让转换首先正常工作）

我正在尝试在这里构建两件事：

*   绘制网格所需的所有 x、y、z 坐标的浮点数组
*   所有需要的顶点的索引数组。
*   然后将两个数组传递给渲染它们的 OpenGL。

数组应如下所示的示例：

```
GLshort indices[] = {3, 0, 1, 2, 
                     3, 3, 4, 5, 
                     3, 6, 7, 8, };
GLfloat vertexs[] = {3.0f, 0.0f, 0.0f,
                     6.0f, 0.0f, -0.5f ,
                     0,    0,     0,
                     6.0f, 0.0f,  0.5f,
                     3.0f, 0.0f,  0.0f,
                     0,    0,     0,
                     3,    0,     0,
                     0,    0,     0,
                     0,    6,     0}; 
```

```

```
int iNumOfVerticies = (num_x + num_y)*4*3;
int iNumOfIndicies = (iNumOfVerticies/3)*4;

GLshort* verticies = new short[iNumOfVerticies];
GLshort* indicies = new short[iNumOfIndicies];
int j = 0;
for(int i=-num_x; j < iNumOfVerticies &&  i<=num_x; i++,j+=6)
{
    verticies[j] = i;
    verticies[j+1] = 0;
    verticies[j+2] = -num_y;

    verticies[j+3] = i;
    verticies[j+4] = 0;
    verticies[j+5] = num_y;
 }

 for(int i=-num_y; j < iNumOfVerticies && i<=num_y;i++,j+=6)
 {
     verticies[j] = i;
     verticies[j+1] = 0;
     verticies[j+2] = -num_x;

     verticies[j+3] = i;
     verticies[j+4] = 0;
     verticies[j+5] = num_x;
 } 
```

如果要传递的指标，我还需要构建一个数组。我从 iphone 'teapot' 示例中“借用”了数组结构。

在每一行中，我们都有索引的数量，然后是引用的索引。

```
 int k = 0;
 for(j = 0; j < iNumOfIndicies; j++)
 {
      if (j%4==0)
      {
         indicies[j] = 3;
      }
      else
      {
         indicies[j] = k++;
      }

 }
 ::glEnableClientState(GL_VERTEX_ARRAY);
 ::glVertexPointer(3 ,GL_FLOAT, 0, verticies);

 for(int i = 0; i < iNumOfIndicies;i += indicies[i] + 1)
 {
       ::glDrawElements(  GL_LINES, indicies[i], GL_UNSIGNED_SHORT, &indicies[i+1] );
 }

 delete [] verticies;
 delete [] indicies; 
```

**请将代码问题添加为评论，而不是答案**

            回答 #1

赞同：1

时间：2009-03-04T16:31:19.747

我可以看到您转换的代码有几个问题：

1.- 对变量*verticies*使用错误的类型，它应该是：

```
GLfloat* verticies = new float[iNumOfVerticies]; 
```

2.- 不正确地填充*顶点*，第二个循环应该是：

```
for(int i=-num_y; j < iNumOfVerticies && i<=num_y;i++,j+=6)
{
    verticies[j] = -num_x;
    verticies[j+1] = 0;
    verticies[j+2] = i;

    verticies[j+3] = num_x;
    verticies[j+4] = 0;
    verticies[j+5] = i;
} 
```

*3.-索引*填写不正确，我认为您应该删除以下行：

```
if (j%4==0)
{
     indicies[j] = 3;
}
else 
```

4.- *glDrawElements*使用不正确，用这一行替换循环：

```
::glDrawElements(  GL_LINES, iNumOfIndicies, GL_UNSIGNED_SHORT, indicies); 
```

        design-patterns - 使用复合模式时查找节点的选项有哪些？

ID：582881

赞同：1

时间：2009-02-24T18:13:20.410

标签：design-patterns, composite

除了递归查询每个节点之外，还有其他选项可以搜索给定某个标识符的节点吗？

            回答 #1

赞同：1

时间：2009-02-24T18:20:04.530

访问者对于检查复合对象中的节点总是很有趣。  

如果它们具有唯一的 id，您可能希望通过直接引用复合结构的每个部分来累积一个索引。

另一方面，如果标识符可以在复合结构中重复使用，您可能不得不求助于类似 XPath 的搜索。

            回答 #2

赞同：1

时间：2009-02-24T18:20:05.700

好吧，如果您使用的是树，递归是最自然的事情。除此之外，您可以在树之外维护一个列表或集合，这似乎是多余的，或者您可以简单地线性迭代树节点列表，这可能会更慢，但至少删除任何特定于遍历来自节点的代码，如果有任何价值的话。

我看不出任何类型的特定树查询（例如 xpath）正在寻找 abc 形式的所有节点，而不仅仅是在级别 a 上遍历 b，并在 b 上遍历 c，换句话说，某种过滤的递归树遍历。

            回答 #3

赞同：0

时间：2009-02-24T18:15:37.037

只有当你实现它。:-(

（模式本身很少提及它的实现，不同的工具/平台会产生很大的不同。）

            回答 #4

赞同：0

时间：2009-02-24T18:19:14.717

您可以使用任何您想要的搜索。  

复合模式唯一说的是 1 个对象或这些对象的集合应该实现相同的接口。

该实现内部发生的事情与复合模式无关。

        .net - 当引用的按钮被禁用时，Windows 窗体 AcceptButton 行为是否有效？

ID：582892

赞同：0

时间：2009-02-24T18:16:01.980

标签：.net, winforms, acceptbutton

具有以下内容：

```
this.AcceptButton = this.OKButton;
this.OKButton.Enabled = false; 
```

...当用户按下 Enter 时，是否仍会调用 OK 按钮单击处理程序？

            回答 #1

赞同：5

时间：2009-02-24T18:21:07.600

不，它不会被调用。

            回答 #2

赞同：3

时间：2009-02-24T18:23:03.897

不，当按钮被禁用时，它不会激活并触发该事件。

-亚当

            回答 #3

赞同：1

时间：2009-02-24T18:28:44.180

AcceptButton/CancelButton 只需调用按钮的 PerformClick() 方法...如果控件被禁用，则该方法不会运行。

        .net - 用于安装或卸载 .NET Windows 服务的批处理脚本

ID：582896

赞同：19

时间：2009-02-24T18:16:36.957

标签：.net, installation, service, batch-file, windows-server-2003

我没有编写批处理脚本的经验，但我想知道是否有办法`installutil.exe`使用这样的脚本安装 .NET Windows 服务，或者如果已经安装了该服务，则卸载该服务，理想情况下，我确实会进行某种确认喜欢执行卸载（例如按 y 卸载）。

以下是一些细节：

*   服务的 .exe 位于`C:\Program Files\Data Service`目录中
*   该脚本应与服务的 .exe 位于同一目录中
*   安装服务后，最好在日志文件中添加一个简单的行（我们将调用它`program.log`，也在此目录中）
*   机器正在运行 Windows Server 2003，默认目录中安装了 .NET Framework`C:\WINDOWS\Microsoft.NET\Framework\v2.0.50727`

如果您觉得这可以以更好的方式完成，那么很高兴听到其他建议。我总是可以编写服务安装程序，但这不是优先事项。

            回答 #1

赞同：32

时间：2009-02-24T18:30:44.847

这是我用来安装的批处理文件。

```
@ECHO OFF

REM The following directory is for .NET 2.0
set DOTNETFX2=%SystemRoot%\Microsoft.NET\Framework\v2.0.50727
set PATH=%PATH%;%DOTNETFX2%

echo Installing MyService...
echo ---------------------------------------------------
InstallUtil /i MyService.exe
echo ---------------------------------------------------
echo Done.
pause 
```

要卸载我使用了以下内容：

```
@ECHO OFF

REM The following directory is for .NET 2.0
set DOTNETFX2=%SystemRoot%\Microsoft.NET\Framework\v2.0.50727
set PATH=%PATH%;%DOTNETFX2%

echo Uninstalling MyService...
echo ---------------------------------------------------
InstallUtil /u MyService.exe
echo ---------------------------------------------------
echo Done 
```

            回答 #2

赞同：26

时间：2011-02-10T18:57:08.807

只做自安装服务更容易。实现此功能后，您可以使用（/i 或 /u 开关）直接运行服务 exe，或者如果您愿意，可以将调用包装在批处理文件中。

```
static void Main(string[] args)
{
    if (args.Length > 0)
    {
        //Install service
        if (args[0].Trim().ToLower() == "/i")
        { System.Configuration.Install.ManagedInstallerClass.InstallHelper(new string[] { "/i", Assembly.GetExecutingAssembly().Location }); }

        //Uninstall service                 
        else if (args[0].Trim().ToLower() == "/u")
        { System.Configuration.Install.ManagedInstallerClass.InstallHelper(new string[] { "/u", Assembly.GetExecutingAssembly().Location }); }
    }
    else
    {
        System.ServiceProcess.ServiceBase[] ServicesToRun;
        ServicesToRun = new System.ServiceProcess.ServiceBase[] { new MyService() };
        System.ServiceProcess.ServiceBase.Run(ServicesToRun);
    }
} 
```

            回答 #3

赞同：15

时间：2009-02-24T18:22:32.947

您可以使用命令行参数（-i -u 等）设置您的服务 exe 以支持自我注册/注销，而不是编写批处理文件来做同样的事情。

有关在 .NET 中创建自安装服务的信息

[http://anotherlab.rajapet.net/2006/06/self-installing-services-in-net.html](http://anotherlab.rajapet.net/2006/06/self-installing-services-in-net.html)

[http://www.gotnet.biz/WindowsServiceSelfInstaller.ashx](http://www.gotnet.biz/WindowsServiceSelfInstaller.ashx)

此外，将安装项目添加到您的解决方案并让 Visual Studio 构建安装包可能会更快。

如何在 Visual Basic .NET 或 Visual Basic 2005 中为 Windows 服务创建安装项目

(VB) [http://support.microsoft.com/kb/317421](http://support.microsoft.com/kb/317421)

(C#) [http://support.microsoft.com/kb/816169](http://support.microsoft.com/kb/816169)

            回答 #4

赞同：6

时间：2010-12-22T08:13:20.557

这是我使用的那个。我找到并使用它。感谢创作者..

```
@echo off

SET PROG="YourServiceHere.exe"
SET FIRSTPART=%WINDIR%"\Microsoft.NET\Framework\v"
SET SECONDPART="\InstallUtil.exe"
SET DOTNETVER=2.0.50727
  IF EXIST %FIRSTPART%%DOTNETVER%%SECONDPART% GOTO install
SET DOTNETVER=1.1.4322
  IF EXIST %FIRSTPART%%DOTNETVER%%SECONDPART% GOTO install
SET DOTNETVER=1.0.3705
  IF EXIST %FIRSTPART%%DOTNETVER%%SECONDPART% GOTO install
GOTO fail
:install
  ECHO Found .NET Framework version %DOTNETVER%
  ECHO Installing service %PROG%
  %FIRSTPART%%DOTNETVER%%SECONDPART% %PROG%
  GOTO end
:fail
  echo FAILURE -- Could not find .NET Framework install
:param_error
  echo USAGE: installNETservie.bat [install type (I or U)] [application (.exe)]
:end
  ECHO DONE!!!
  Pause 
```

            回答 #5

赞同：4

时间：2012-09-26T21:20:27.097

我发现最好使用一个好的安装项目来使用批处理文件来安装应用程序。虽然有些时候是做不到的。工作中的几个项目是在 Windows NT 和早期的 Windows XP 时代编写的，并使用简单的批处理文件进行安装。在那些时候，将批处理文件转换为安装包比简单的调整更麻烦。通过大量搜索，我发现[http://ss64.com/nt/](http://ss64.com/nt/)是一个非常好的 Windows 批处理文件参考。（感觉很奇怪，随着我们在软件技术方面的所有进步，不得不写最后一句话。）

无论如何，快乐编码！- 无论“语言”如何。

            回答 #6

赞同：2

时间：2009-02-24T18:23:30.120

我不知道为什么你需要一个批处理文件。这就是我要使用的。

C:\WINDOWS\Microsoft.NET\Framework\v2.0.50727\InstallUtil.exe /i ServiceAssembly.dll

            回答 #7

赞同：0

时间：2009-02-24T18:22:45.410

建议：

*   利用环境，C:上可能没有安装Windows。但是你可以使用 %WinDir%。
*   您可以重定向 echo 以附加到文件：

    回显消息>> logfile.txt

*   在 cmd.exe 中跟踪所有内容并转换所有边缘情况可能具有挑战性，它不是一个丰富的环境。

*   文档没有一致的地方。但是关于“cmd”、“if”、“for”、“set”和“call”的帮助（来自命令行）涵盖了大部分可用的语法。
*   在开始时设置 echo off 以查看执行的命令。

            回答 #8

赞同：0

时间：2009-02-24T18:31:25.937

我用一个老式的批处理文件做到了这一点......

将 installutil.exe 复制到与可执行文件相同的目录中（为了使事情更容易）以下是必要的批处理文件内容的通用示例：（我的只是名称 instal.bat）

```
installutil MyService.exe 
sc config MyService type= interact type= own
sc failure MyService reset= 6000  actions= restart/5000/restart/5000/restart/5000
sc start MyService 
```

有关 installutil.exe 命令行选项的更多信息，[请参见此处](http://msdn.microsoft.com/en-us/library/50614e95.aspx)。

要卸载该服务，请使用具有以下内容的不同批处理文件：

```
installutil MyService.exe /u 
```

            回答 #9

赞同：0

时间：2009-02-24T18:36:06.487

创建一个扩展名为 .bat 的文件并将其放入文件中

installutil -uc:\YourServiceLocation\Service.exe

            回答 #10

赞同：0

时间：2014-05-30T11:44:58.927

```
@echo off

SET PROG="c:\YourServiceLocation\Service.exe" SET FIRSTPART=%WINDIR%"\Microsoft.NET\Framework\v" SET SECONDPART="\InstallUtil.exe" SET DOTNETVER=4.0.30319 IF EXIST %FIRSTPART%%DOTNETVER%%SECONDPART% GOTO install

GOTO fail :install ECHO Found .NET Framework version %DOTNETVER% ECHO Installing service %PROG% %FIRSTPART%%DOTNETVER%%SECONDPART% %PROG% GOTO end :fail echo FAILURE -- Could not find .NET Framework install :param_error echo USAGE: installNETservie.bat [install type (I or U)] [application (.exe)] :end ECHO DONE!!! Pause 
```

以管理员身份运行此 bat 文件

        delphi - CreateWnd 和 CreateWindowHandle 有什么区别？

ID：582903

赞同：24

时间：2009-02-24T18:19:26.700

标签：delphi, components

Delphi 组件有`CreateWnd`and `CreateWindowHandle`(and `DestroyWnd`and `DestroyWindowHandle`)。他们都打算被后代覆盖，对吧？并且不打算被底层 VCL 实现调用？

它们之间有什么区别；什么时候应该覆盖它们中的任何一个？

            回答 #1

赞同：42

时间：2009-02-24T21:44:54.333

到目前为止，这里的大多数答案都差不多，你最好听从他们的建议。但是，这个故事还有更多内容。对于您何时会覆盖其中一个或另一个的具体问题，我将尝试简要介绍一下。

**创建参数（）；**

一般来说，大多数时候你真正需要做的就是重写 CreateParams()。如果您只想对现有控件类进行子类化（还记得 Windows 风格的“子类化吗？”请参阅 Petzold 关于 Windows 编程的开创性工作）并将其包装在 VCL 控件中，您可以从 CreateParams 执行此操作。您还可以控制设置的样式位和其他各种参数。我们使创建“子类”的过程变得非常简单。只需从您的 CreateParams() 方法调用 CreateSubClass()。有关 TCheckBox 或 TButton 等示例，请参阅核心 VCL 控件。

**CreateWnd();**

如果您需要在创建窗口句柄后对其进行更多操作，您将覆盖这个。例如，如果您的控件是某种列表、树或其他需要创建后配置的控件，您可以在此处执行此操作。调用继承的 CreateWnd，当它返回时（如果您从 CreateWnd 返回，您知道您有一个有效的句柄，因为如果出现问题，它将引发异常），只需应用您的额外魔法。一个常见的场景是获取缓存在实例 TStrings 列表中的数据，并将其实际移动到底层窗口控件中。TListBox 就是一个典型的例子。

**创建窗口句柄（）；**

我不得不去刷新我对这个的记忆，但似乎这是一个很少，如果有的话，被覆盖。在 VCL 本身内部的少数情况下，它似乎用于使用某些控件（例如 TEdit 和 TMemo）来解决特定的 Windows 版本和区域设置异常。另一个更明确的案例是 TCustomForm 本身。在这种情况下，它支持旧的 MDI（多文档接口）模型。在这种情况下，无法使用普通的 CreateWindowEx() API 创建 MDI 子项，您必须向 MDI 父框架发送消息才能实际创建句柄。因此，覆盖此方法的唯一原因是，如果创建句柄的实际过程是通过与旧的久经考验的 CreateWindowEx() 完全不同的方式完成的。

我确实注意到您的问题只是询问创建过程，但在某些情况下，对于句柄破坏和有时围绕句柄重新创建的“巫毒”，有相应的方法被覆盖。但这些是应该单独讨论的其他主题:-)。

            回答 #2

赞同：4

时间：2009-02-24T18:29:06.893

CreateWnd 首先调用 CreateParams，然后使用创建的 Params 调用 CreateWindowHandle。通常，您将覆盖 CreateWnd 和 CreateParams 而不是 CreateWindowHandle。

我希望这有帮助！

            回答 #3

赞同：3

时间：2009-02-24T20:39:20.670

**谁做什么：**

**CreateWnd**是为 WinControl 创建完整窗口的总承包商。

首先，它必须通过调用**CreateParams**为 WindowClass 设置所需的属性，并确保它已正确注册。

然后它通过调用从操作系统返回结果句柄的**CreateWindowHandle来获取实际创建的窗口。**

之后，我们有一个能够处理消息的有效窗口，**CreateWnd**进行最后的修饰，调整不同的视觉方面，如大小、字体等。  

**CreateWnd 完成后， CreateHandle**还完成了稍后的步骤，以帮助 VCL 管理其窗口（标识、亲子关系……）。  

            回答 #4

赞同：0

时间：2009-02-24T20:08:38.573

我敢肯定，最终答案只能来自参与创建 VCL 的人员（Allen？），但恕我直言，应该覆盖调用链中责任最小/最低的虚拟方法。这就是为什么我总是覆盖*CreateParams()*和*CreateWindowHandle()*。这看起来很合适，因为它们都由*CreateWnd()*调用，并且都只做一件特殊的事情。

最后，这可能是一个偏好问题。

        configuration-files - 关系数据库与配置文件与电子表格的使用

ID：582911

赞同：1

时间：2009-02-24T18:21:02.780

标签：configuration-files, spreadsheet, relational-database

我以前听过一些关于使用关系数据库与电子表格的真正争论。关系数据库提供快速报告和（相对而言）可靠的数据仓库，其中电子表格是轻量级的、快速复制的，并且易于在组织中浮动到不同的受众。尽管我注意到两者的优点，但我很少能区分在哪种情况下哪个更好，并且总是最终使用数据库。

在开发中，当可以将配置设置放在数据库中时，很容易忘记考虑其他选项。我遇到过很多应用程序，其中用户菜单、工作流程及其顺序以及常量是在数据库级别定义的。如果最终用户从应用程序级别更改这些实体，这很好，但情况并非如此。

那么，您对数据库、配置文件和电子表格的角色有何看法？

            回答 #1

赞同：2

时间：2009-02-24T18:27:05.730

古老的格言是这样的。

当您使用电子表格解决问题时，您现在遇到了两个问题。

数据库用于记录业务。持久的。永恒的。  

其他配置文件用于其他配置信息——不是持久的业务记录。当前设置和其他设置不是持久的业务记录，它们是处理业务记录的特定软件配置的一部分。

电子表格是——嗯——它们就是它们。一个简单的配置文件太复杂了。作为一个真正的数据库太简单了。

由于它们（几乎）无法控制，因此您需要在数据库中有一个标准的、正确的、幂等的结果。您应该能够从该受控源重建电子表格。

同样，如果您接受电子表格进行上传，则必须提取数据，并且永远不要再次参考（几乎无法控制的）源文档。

            回答 #2

赞同：1

时间：2009-02-24T18:40:38.583

对我来说，我希望所有核心数据都存储在数据库中。两个原因：

*   允许临时报告访问数据
*   允许应用程序共享数据。

数据库应该包含所有领域数据，偶尔也会包含一些动态数据（例如用户偏好）。关系数据库最受欢迎，但对于某些应用程序还有其他选择。

另一方面，配置文件应包含您要在系统中更改的所有“参数”；那些没有迅速改变的（即时）。配置项很灵活，但并不容易，而且通常不是来自界面。如果它是您只希望编码器可能更改的参数，那应该在代码中正确（因此没有其他人可以访问）。

如果您想摆弄数据挖掘，请提供一些通用机制，将带有 SQL 查询结果的 CSV 文件直接下载到 Excel 中。这样人们就可以摆弄数据透视表，而不必改变应用程序的模式。

            回答 #3

赞同：1

时间：2009-02-24T18:50:06.190

电子表格是文档，数据库是信息存储库，配置文件存储应用程序特定实例的行为规则。如果你这样想，打电话通常不难。

        c# - StructureMap 注入问题

ID：582918

赞同：1

时间：2009-02-24T18:21:35.710

标签：c#, .net, dependency-injection, structuremap

我正在尝试使用 StructureMap 并且基本上具有 3 个抽象级别。我有一个服务库和数据库接口。所以 IService 依赖于 IRepo 而 IRepo 依赖于 IDatabase。我的问题是我的 IDatabase 具体类型接受了数据库连接信息。我将动态创建这些，尝试使用 ObjectFactory.Configure()。  

所以我有一个用户，并且该用户链接到一家公司，我查找公司连接信息，我想根据这些信息创建正确的 IDatabase 具体类型。我在启动代码中配置了具体类型。我只想从外部使用 IService 对象...所以我想创建一个以公司名称命名的命名 IService 对象。尝试动态创建这些类型时遇到问题。任何信息都会有帮助...

我基本上希望能够在不知道具体类型的情况下创建一个命名实例并在运行时设置属性或将特定参数传递给构造函数。我在配置文件中有具体的类型设置。我尝试使用 ObjectFactory.GetInstance 并尝试在 Configure 方法中设置属性，但得到了 StackOverflow 异常...HOW IRONIC

            回答 #1

赞同：0

时间：2009-02-25T14:01:42.177

在 Jeremy Miller（StructureMap 的作者）的指导下找到了答案。这是他指给我看的地方：

[http://structuremap.sourceforge.net/RetrievingServices.htm#section5](http://structuremap.sourceforge.net/RetrievingServices.htm#section5) 

这是我使用的示例：

```
IDatabaseRepository repo =
                ObjectFactory.With("server").EqualTo("servername").
                With("database").EqualTo("dbName").
                With("user").EqualTo("userName").
                With("password").EqualTo("password").
                GetInstance<IDatabaseRepository>(); 
```

            回答 #2

赞同：0

时间：2012-12-19T21:19:10.697

Structuremap 的 ObjectFactory 似乎不支持注入命名实例

        c - “内联”何时无效？（在 C 中）

ID：582919

赞同：15

时间：2009-02-24T18:21:50.453

标签：c, inline

有些人喜欢使用`inline`关键字 in `C`，并把大函数放在*标题*中。你什么时候认为这是无效的？我有时甚至认为它很烦人，因为它不寻常。

我的原则是`inline`应该用于非常频繁访问的小函数，或者为了进行真正的类型检查。无论如何，我的品味指导我，但我不知道如何最好地解释为什么`inline`对大型功能没有那么有用的原因。

在[这个问题](https://stackoverflow.com/questions/280173/c-inline-functions-and-memory-use)中，人们建议编译器可以更好地猜测正确的事情。这也是我的假设。当我尝试使用这个参数时，人们回答它不适用于来自不同对象的函数。好吧，我不知道（例如，使用 GCC）。

感谢您的回答！

            回答 #1

赞同：26

时间：2009-02-24T18:25:27.260

`inline`做两件事：

1.  使您免于“单一定义规则”（见下文）。这*始终*适用。
2.  为编译器提供避免函数调用的提示。编译器可以随意忽略这一点。

#1 可能非常有用（例如，如果很短，则将定义放在标题中）即使 #2 被禁用。

在实践中，编译器通常会更好地确定要内联的内容（尤其是在配置文件引导优化可用的情况下）。

[编辑：完整参考文献和相关文本]

以上两点均遵循 ISO/ANSI 标准（ISO/IEC 9899:1999(E)，俗称“C99”）。

在第 6.9 节“外部定义”第 5 段中：

外部*定义*是一个外部声明，它也是函数（内联定义除外）或对象的定义。如果用外部链接声明的标识符在表达式中使用（而不是作为结果为整数常量的 sizeof 运算符的操作数的一部分），则在整个程序的某处，该标识符应该只有一个外部定义；否则，不得超过一个。

虽然 C++ 中的等价定义明确命名为单一定义规则 (ODR)，但它的用途相同。外部（即不是“静态的”，因此对于单个翻译单元来说是本地的——通常是单个源文件）只能定义一次*，除非*它是一个函数*和*内联。

在第 6.7.4 节“函数说明符”中，定义了 inline 关键字：

使函数成为内联函数意味着对函数的调用尽可能快。^([118])此类建议的有效程度由实施定义。

和脚注（非规范），但提供说明：

例如，通过使用通常的函数调用机制的替代方法，例如“内联替换”。内联替换不是文本替换，也不会创建新函数。因此，例如，在函数体中使用的宏的扩展使用它在函数体出现时的定义，而不是调用函数的位置；标识符指的是正文出现的范围内的声明。同样，该函数具有单个地址，而不管除外部定义之外出现的内联定义的数量。

总结：大多数 C 和 C++ 用户对内联的期望并不是他们得到的。它明显的主要目的是避免函数调用开销，是完全可选的。但是为了允许单独编译，需要放宽单一定义。

（标准中引用的所有重点。）

编辑2：一些注意事项：

*   外部内联函数有各种限制。函数中不能有静态变量，也不能引用静态 TU 范围对象/函数。
*   刚刚在VC++的“[整个程序优化](http://blogs.msdn.com/vcblog/archive/2009/02/24/quick-tips-on-using-whole-program-optimization.aspx "使用整个程序优化的快速提示")”上看到了这个，这是一个编译器自己做内联事情的例子，而不是作者。

            回答 #2

赞同：5

时间：2009-02-24T18:26:41.423

内联声明的重要之处在于它不一定做任何事情。在许多情况下，编译器可以自由决定内联未声明的函数，以及链接声明为内联的函数。

            回答 #3

赞同：5

时间：2009-02-24T21:27:42.253

一个例子来说明内联的好处。sinCos.h：

```
int16 sinLUT[ TWO_PI ]; 

static inline int16_t cos_LUT( int16_t x ) {
    return sin_LUT( x + PI_OVER_TWO )
}

static inline int16_t sin_LUT( int16_t x ) {
    return sinLUT[(uint16_t)x];
} 
```

当进行一些繁重的数字运算并且您希望避免在计算 sin/cos 上浪费周期时，您将 sin/cos 替换为 LUT。

当您在没有内联的情况下编译时，编译器*不会优化循环*，输出 .asm 将显示以下内容：

```
;*----------------------------------------------------------------------------*
;*   SOFTWARE PIPELINE INFORMATION
;*      Disqualified loop: Loop contains a call
;*----------------------------------------------------------------------------* 
```

当您使用内联编译时，编译器了解循环中发生的事情并将进行优化，因为它确切地知道发生了什么。

输出 .asm 将有一个优化的“流水线”循环（即，它将尝试充分利用所有处理器的 ALU 并尝试在没有 NOPS 的情况下保持处理器的流水线满）。

在这种特定情况下，我能够将我的性能提高大约 2 倍或 4 倍，这使我能够满足我的实时截止日期所需。

ps 我正在使用定点处理器......任何浮点运算，如 sin/cos 都会影响我的性能。

            回答 #4

赞同：5

时间：2009-02-25T09:56:35.683

不应将内联用于大型函数的另一个原因是库。每次更改内联函数时，您可能会失去 ABI 兼容性，因为针对旧标头编译的应用程序仍然内联了旧版本的函数。如果将内联函数用作类型安全宏，则很有可能函数在库的生命周期中永远不需要更改。但对于大型函数，这很难保证。

当然，只有当函数是公共 API 的一部分时，此参数才适用。

            回答 #5

赞同：4

时间：2009-02-24T18:26:17.073

使用指针函数时，内联无效。

            回答 #6

赞同：3

时间：2009-02-24T19:07:13.200

内联在一种情况下是有效的：当您遇到性能问题时，使用真实数据运行分析器，并发现一些小函数的函数调用开销很大。

除此之外，我无法想象你为什么要使用它。

            回答 #7

赞同：2

时间：2009-02-24T18:26:58.443

这是正确的。对大函数使用内联会增加编译时间，并且不会给应用程序带来额外的性能。内联函数用于告诉编译器无需调用即可包含函数，并且应该是重复多次的小代码。换句话说：对于大函数，调用的成本与自己的函数实现的成本相比是可以忽略不计的。

            回答 #8

赞同：2

时间：2009-02-24T18:27:30.907

内联可用于小型且经常使用的函数，例如 getter 或 setter 方法。对于大型函数，不建议使用内联，因为它会增加 exe 大小。同样对于递归函数，即使您进行内联，编译器也会忽略它。

            回答 #9

赞同：2

时间：2009-02-24T18:28:30.030

我主要使用内联函数作为类型安全的宏。很长一段时间以来，人们一直在谈论向 GCC 添加对链接时优化的支持，尤其是在 LLVM 出现之后。不过，我不知道它实际上已经实施了多少。

            回答 #10

赞同：2

时间：2009-02-24T19:20:23.713

就我个人而言，我不认为你应该内联，除非你首先在你的代码上运行了一个分析器并且已经证明该例程存在一个可以通过内联部分缓解的重大瓶颈**。**

这是 Knuth 警告过的另一个过早优化案例。

            回答 #11

赞同：1

时间：2009-02-24T18:26:16.543

1.  `inline`仅作为提示。
2.  仅在最近添加。因此仅适用于最新的标准兼容编译器。

            回答 #12

赞同：1

时间：2009-02-25T12:28:05.897

内联函数应该是大约 10 行或更少，取决于您选择的编译器。

你可以告诉你的编译器你想要内联的东西..这取决于编译器。没有我知道编译器不能忽略的 -force-inline 选项。这就是为什么您应该查看汇编器输出并查看您的编译器是否**确实**内联了该函数，如果没有，为什么不呢？许多编译器只是默默地说“去你的！” 在这方面。

因此，如果：

静态内联 unsigned int foo(const char *bar)

.. 并没有改善静态 int foo() 的事情，它是时候重新审视你的优化（和可能的循环）或与你的编译器争论了。请特别注意首先与您的编译器争论，而不是与开发它的人争论。或者当您第二天打开收件箱时，您只是在商店中阅读大量不愉快的内容。

同时，当做一些东西（或试图做一些东西）内联时，这样做真的证明膨胀是合理的吗？您真的希望**每次**调用该函数时都扩展它吗？跳转成本高吗？，您的编译器通常正确 9/10 次，检查中间输出（或 asm 转储）。

        c# - 如何在 C# 中调试不一致的空引用？

ID：582924

赞同：0

时间：2009-02-24T18:22:51.293

标签：c#, debugging, virtualization

我有一个`Animal`在一些模拟程序中使用的基类。在这种情况下，一次运行可能长达 500`Animal`秒。每次运行都设置为让`Animal`每个“时间步”都做一些事情。所以我只是遍历动物列表，调用`DoTimeStep`每一个，直到完成所有时间步骤。  

每个`Animal`类都有自己的记录器类，用于为模拟中的每个“时间步”写出数据。这样每个`Animal`人都有自己的日志文件。它一直运行良好（3 年），直到我们尝试在虚拟机上运行它。然后出于某种原因，记录器引用每隔一段时间就会在“时间步”中为空，然后下一次它将在那里。真正奇怪的部分是`StreamWriter`记录器内部似乎永远不会忘记其文件的位置。它只是跳过写出该时间步的行。并且错误日志显示`NullReferenceException`在`Logger`类上。

我找不到这种行为的任何模式。该类`Animal`没有被销毁和重新创建。记录器在`Animal`构造函数中创建并在`IDispose`. 关于如何开始调试此问题的任何想法？

编辑：我只能重新创建 3 只动物，所以 500 个打开的文件不应该是它。但是感谢您的尝试。

编辑：当我发现 Null Exception 的错误时，我不确定我应该做什么。我已经抓住了它，但我不知道如何找出它发生的原因。抱歉显得迟钝。顺便说一句，我确实尝试了 Thread.Sleep(300) 10000 次循环，看看是否有某种我不知道的比赛正在进行。它在循环中从未变为非空。但是 3 秒后，当我骑车穿过其他两只动物并回来时，它不再为空。

            回答 #1

赞同：5

时间：2009-02-24T18:29:56.970

我会做以下事情。  

1.  设置 VS 在调试器下运行你的程序
2.  为空引用异常启用第一次机会异常
3.  调试器 -> 异常 -> 展开公共语言运行时 -> 检查 System.NullReferenceException
4.  启动程序
5.  等待

如果复制需要很长时间，我会启动它并回家过夜。它会在早上等你;）

            回答 #2

赞同：2

时间：2009-02-24T18:28:02.653

听起来像一个竞争条件......你是否正确锁定线程之间共享的数据？

编辑：如果这不是竞争条件，我的第二个猜测是虚拟机可能不喜欢同时打开 500 个文件......你调查过吗？

            回答 #3

赞同：0

时间：2009-02-24T18:26:19.397

您是否有可能遇到可能与延迟初始化有关的多线程问题？

            回答 #4

赞同：0

时间：2009-02-24T18:33:36.523

听起来像一个比赛条件。我想出的解决此类问题的最简单的修补程序是：

查找分配空变量的位置。无论它从哪里获取数据，偶尔都会提供空值，对吧？

所以检查那里，如果它返回 null，睡眠 300 毫秒然后再试一次，直到它不为 null。

如果失败超过 10 秒，则以错误退出。不要让它继续处于无效状态。

            回答 #5

赞同：0

时间：2009-02-25T04:10:28.417

这可能与VM有关...我已经看到VMWare与本机c ++应用程序类似的内存问题，其中内存无缘无故地被弄乱了，并且IT表示他们没有对VM做任何事情... （我们都知道这意味着他们正在对 VM 做一些事情）

当虚拟机在未关闭电源的情况下主动从一台服务器移动到另一台服务器时，我看到了奇怪的行为（它基本上重复了几个字节的代码两次，这会导致各种有趣的错误，尤其是在首先关闭资源的情况下）。

但无论如何，如果它只能在虚拟机上重现，我会尝试使用专用资源（不共享或分数处理器或任何东西）将它隔离在开发虚拟机服务器上，看看你是否可以重现它。然后从那里开始......重新添加相同类型的环境，直到你可以重现它。

        c# - C# 代码生成

ID：582934

赞同：7

时间：2009-02-24T18:25:42.847

标签：c#, build-process, code-generation

我正在为一个项目创建一个小型类生成器。我一直在阅读有关 CodeDOM 的内容，因此创建类的语义似乎不是问题，但我不确定如何最好地将生成集成到开发和部署过程中。

1.  我应该如何触发类的创建？我已经读过它应该是构建过程的一部分，我应该怎么做？

2.  应该在哪里创建类？我读到文件不应该手动编辑，并且永远不要检查源代码控制。我是否应该担心这一点并将类生成到与生成器引擎相同的目录中？    

            回答 #1

赞同：8

时间：2009-02-24T18:35:01.437

看看 T4 模板（它内置于 VS2008）。它允许您创建为您生成代码的“模板”类。  [Oleg Sych](http://www.olegsych.com/)是这方面的宝贵资源。

[Oleg 的代码生成教程链接](http://www.olegsych.com/2008/03/code-generation-with-visual-studio-templates/)。

            回答 #2

赞同：0

时间：2009-02-24T18:35:49.937

您的问题的答案部分取决于您生成的类的目的。  

如果这些类是作为*开发*的一部分生成的，那么它们应该作为文本文件生成并像任何其他类一样签入您的 SCM。

如果您的类是作为系统操作的一部分在*运行时*动态生成的，那么我根本不会使用 CodeDOM。我会使用反射。

            回答 #3

赞同：0

时间：2009-10-16T16:40:30.703

我知道 T4 模板的存在（并且知道很多人使用它们），但我自己没有使用它们。除此之外，您还有两个主要选择：

1.  使用 SingleFileGenerator 在项目内部转换源。每当您保存您编辑的文档时，它都会自动重新生成代码文件。如果您使用源代码管理，生成的文件将作为项目的一部分签入。这有一些限制：

    *   您只能为每个输入生成一个输出。

    *   由于您无法控制生成文件的顺序，并且文件不是在构建时生成的，因此您的输出只能有效地从单个输入文件中派生。

    *   *如果他们计划编辑输入文件，则*必须在开发人员的机器上安装单个文件生成器。由于生成的代码在源代码控制中，如果他们不编辑输入，那么他们就不需要重新生成输出。

    *   由于仅在保存输入时才生成输出，因此输出不应依赖于输入文件的确切内容（甚至系统时钟）以外的任何状态。

2.  生成代码作为构建的一部分。为此，您编写了一个 MSBuild 目标文件。为此，您可以完全控制输入和输出，因此可以处理依赖关系。系统状态在必要时可以被视为输入依赖项，但请记住，每个需要代码生成的构建都比使用先前生成的结果的构建花费更长的时间。结果（生成的源文件）通常放在*obj*目录中，并添加到输入列表中`csc`（C# 编译器）。此方法的局限性：

    *   编写目标文件比 SingleFileGenerator 更难。

    *   构建取决于生成输出，无论用户是否将编辑输入。

    *   由于生成的代码不是项目的一部分，因此查看生成的代码以设置断点等操作会有些困难。

        sql - 当一种替代方法微不足道时，sql'OR'条件的性能影响？

ID：582940

赞同：3

时间：2009-02-24T18:26:28.087

标签：sql, sql-server, optimization, stored-procedures

我正在创建一个存储过程，用于根据用户输入的一些标准在我的数据库中搜索一些数据。

我的 sql 代码如下所示：

```
Create Procedure mySearchProc
(
@IDCriteria bigint=null,
...
@MaxDateCriteria datetime=null
)
as
select Col1,...,Coln from MyTable 
where (@IDCriteria is null or ID=@IDCriteria)
...
and (@MaxDateCriteria is null or Date<@MaxDateCriteria) 
```

**编辑**：我有大约 20 个可能的参数，并且 n 个非空参数的每个组合都可能发生。

编写这种代码在性能方面可以吗？（我使用的是 MS SQL Server 2008）

生成仅包含所需 where 子句的 SQL 代码会明显更快吗？

            回答 #1

赞同：3

时间：2009-02-24T18:32:36.167

OR 子句因导致性能问题而臭名昭著，主要是因为它们需要表扫描。如果您可以在没有 OR 的情况下编写查询，那么您的情况会更好。

            回答 #2

赞同：2

时间：2009-02-24T18:58:11.537

```
where (@IDCriteria is null or ID=@IDCriteria)
  and (@MaxDateCriteria is null or Date<@MaxDateCriteria) 
```

如果您编写此条件，那么 SQL Server 将不知道使用 ID 的索引还是 Dates 的索引更好。

为了进行适当的优化，最好为每种情况编写单独的查询并使用 IF 来指导您找到正确的查询。

```
IF @IDCriteria is not null and @MaxDateCriteria is not null

  --query
  WHERE ID = @IDCriteria and Date < @MaxDateCriteria

ELSE IF @IDCriteria is not null

  --query
  WHERE ID = @IDCriteria

ELSE IF @MaxDateCriteria is not null

  --query
  WHERE Date < @MaxDateCriteria

ELSE

  --query
  WHERE 1 = 1 
```

如果您希望优化器需要不同的计划，您需要编写不同的查询来获取它们！

生成仅包含所需 where 子句的 SQL 代码会明显更快吗？

是的 - 如果您希望优化器在不同的计划之间进行选择。

编辑：

```
DECLARE @CustomerNumber int, @CustomerName varchar(30)

SET @CustomerNumber = 123
SET @CustomerName = '123'

SELECT * FROM Customers
WHERE (CustomerNumber = @CustomerNumber OR @CustomerNumber is null)
  AND (CustomerName = @CustomerName OR @CustomerName is null) 
```

CustomerName 和 CustomerNumber 已编入索引。优化器说：“并行化的聚集索引扫描”。您不能编写更糟糕的单表查询。

编辑：我有大约 20 个可能的参数，并且 n 个非空参数的每个组合都可能发生。

我们的数据库中有类似的“搜索”功能。当我们查看实际发出的查询时，其中 99.9% 使用了 AccountIdentifier。在您的情况下，我怀疑要么总是提供一列，要么总是提供两列之一。这将分别导致 2 或 3 个案例。

从整个结构中删除 OR 并不重要。从您希望优化器用来访问索引的列中删除 OR 非常重要。

            回答 #3

赞同：1

时间：2009-02-24T22:52:26.340

所以，总结一下上面的评论：

为每个最流行的特定参数组合变体创建一个单独的子过程，并在调度程序过程中从 IF ELSE 结构中调用适当的子过程，其中倒数第二个 ELSE 子句动态构建查询以覆盖其余情况。

一开始可能只对一两个案例进行专门编码，但随着时间的推移，特定的参数组合被确定为具有统计学意义，可以编写实施程序，扩展主 IF ELSE 构造以识别这些案例并调用适当的子程序。

            回答 #4

赞同：0

时间：2009-02-24T19:01:05.583

关于“生成仅包含所需 where 子句的 SQL 代码会明显更快吗？”

我不这么认为，因为这样可以有效地消除查询计划缓存的积极影响。

            回答 #5

赞同：0

时间：2009-02-24T19:41:44.833

您可以按照最常见/最有效（索引等）、参数的顺序执行选择性查询，并将 PK(s) 添加到临时表

这将创建一个（希望很小！）数据子集

然后将该临时表与主表连接起来，使用完整的 WHERE 子句

```
SELECT ...
FROM @TempTable AS T
    JOIN dbo.MyTable AS M
        ON M.ID = T.ID
WHERE (@IDCriteria IS NULL OR M.ID=@IDCriteria)
...
AND (@MaxDateCriteria IS NULL OR M.Date<@MaxDateCriteria) 
```

样式来细化（小）子集。

            回答 #6

赞同：0

时间：2009-02-24T22:21:12.750

如果这样的结构被替换了怎么办：

```
WHERE (@IDCriteria IS NULL OR @IDCriteria=ID)
AND (@MaxDateCriteria IS NULL OR Date<@MaxDateCriteria)
AND ... 
```

像这样的：

```
WHERE ID = ISNULL(@IDCriteria, ID)
AND Date < ISNULL(@MaxDateCriteria, DATEADD(millisecond, 1, Date))
AND ... 
```

或者这只是在语法糖中涂上相同的不可优化查询？

            回答 #7

赞同：0

时间：2009-02-24T22:34:18.600

优化器很难选择正确的索引。IMO，这是动态 SQL 是最佳选择的少数情况之一。

            回答 #8

赞同：0

时间：2009-02-24T23:03:17.140

这是我为每个搜索选项使用代码构建或存储过程的情况之一。因为您的搜索非常复杂，所以我会使用代码构建。您可以在代码中或使用动态 sql 执行此操作。请注意 SQL 注入。

            回答 #9

赞同：0

时间：2009-02-24T23:13:51.670

我建议比其他一些建议更进一步——考虑在更高的抽象级别进行去概括，最好是 UI 结构。通常这似乎是在数据模式而不是用户域模式下考虑问题时发生的。

在实践中，我发现几乎每个这样的查询都有一个或多个非空的、相当有选择性的列，如果指定了一个（或多个），这些列将是可合理优化的。此外，这些通常是用户可以理解的合理假设。

示例：按客户查找订单；或按日期范围查找订单；或按销售人员查找订单。

如果这种模式适用，那么您可以将您的超通用查询分解为对用户也有意义的更有目的的子查询，并且您可以合理地提示所需的值（或范围），而不必担心为子列设计有效的表达式。

您可能仍会以“所有其他”类别结束。但至少，如果您提供的内容本质上是一个开放式的“示例查询”表单，那么用户就会对他们正在进入的内容有所了解。做你描述的事情真的让你扮演着试图超越查询优化器的角色，这是愚蠢的恕我直言。

            回答 #10

赞同：0

时间：2009-02-25T02:04:46.627

我目前正在使用 SQL 2005，所以我不知道 2008 优化器的行为是否不同。话虽如此，我发现你需要做几件事......

1.  确保您使用 WITH (RECOMPILE) 进行查询

2.  使用 CASE 语句导致逻辑短路。至少在 2005 年，这不是用 OR 语句完成的。例如：

.

```
SELECT
     ...
FROM
     ...
WHERE
     (1 =
          CASE
               WHEN @my_column IS NULL THEN 1
               WHEN my_column = @my_column THEN 1
               ELSE 0
          END
     ) 
```

CASE 语句将使 SQL Server 优化器认识到它不需要继续超过第一个 WHEN。在这个例子中，这没什么大不了的，但在我的搜索过程中，一个非空参数通常意味着通过子查询在另一个表中搜索匹配行的存在，这很昂贵。一旦我做了这个改变，搜索过程开始运行得更快。

            回答 #11

赞同：0

时间：2009-02-25T03:13:55.820

我的建议是构建 sql 字符串。您将从索引和重用执行计划中获得最大性能。

```
DECLARE @sql nvarchar(4000);
SET @sql = N''

IF @param1 IS NOT NULL
    SET @sql = CASE WHEN @sql = N'' THEN N'' ELSE N' AND ' END + N'param1 = @param1';
IF @param2 IS NOT NULL
    SET @sql = CASE WHEN @sql = N'' THEN N'' ELSE N' AND ' END + N'param2 = @param2';
...
IF @paramN IS NOT NULL
    SET @sql = CASE WHEN @sql = N'' THEN N'' ELSE N' AND ' END + N'paramN = @paramN';

IF @sql <> N''
    SET @sql = N' WHERE ' + @sql;
SET @sql = N'SELECT ... FROM myTable' + @sql;

EXEC sp_executesql @sql, N'@param1 type, @param2 type, ..., @paramN type', @param1, @param2, ..., @paramN; 
```

            回答 #12

赞同：0

时间：2009-02-26T10:36:03.957

每次调用过程时，传递不同的参数，都会有不同的最佳执行计划来获取数据。问题是，SQL 已经为您的过程缓存了一个执行计划，并将使用一个次优（读起来很糟糕）的执行计划。

我会推荐：

1.  为每个场景优化的频繁运行的执行路径（即传递的参数集）创建特定的 SP。
2.  为边缘情况保留主要的通用 SP（假设它们很少运行），但使用 WITH RECOMPILE 子句在每次运行过程时创建一个新的执行计划。

我们使用 OR 子句检查可选参数的 NULL 以产生很大的影响。只要不通过传递不同的参数来彻底改变执行路径，它就可以在没有 RECOMPILE 选项的情况下工作得很好。

        google-search-appliance - 谷歌：禁用设备托管的搜索页面？

ID：582948

赞同：1

时间：2009-02-24T18:27:59.160

标签：google-search-appliance

有没有办法禁用或密码保护托管在 Google Mini 设备上的搜索页面？我指的是选项 1 中描述的[页面](http://code.google.com/apis/searchappliance/documentation/46/help_mini/home_quickstart.html#basic_make)。

我基本上想防止有人偶然发现此 URL 并在此处搜索，而不是通过使用该设备的实际站点之一。

            回答 #1

赞同：0

时间：2009-02-25T11:38:39.133

尝试其中一些：

*   删除默认前端
*   删除默认集合
*   将默认集合的 Follow 和 Crawl URL 设置为空白
*   在 Serving > Front Ends > Output format 下编辑 XSLT 样式表。

我的经验是使用 Google Search Applicance，所以我希望这也适用于 Mini。

        hosting - 是否可以租用 CPU 周期？

ID：582952

赞同：9

时间：2009-02-24T18:28:09.783

标签：hosting

我有一个需要几天时间来处理数据的应用程序。有没有一项服务可以让我在功能强大的计算机上运行我的应用程序？

我没有运行网站或网络服务。这需要大量的数据文件，通过大型自定义应用程序运行它们，并输出结果。

在我的 PC 上需要几天的时间，并且需要每隔一段时间就完成一次，但不是持续进行。

成本并不是真正的问题，因为我的公司会为此买单，但当然它应该比我们自己购买一台大机器便宜。

            回答 #1

赞同：18

时间：2009-02-24T18:31:09.137

您是否考虑过[Amazon EC2](http://aws.amazon.com/ec2/)？您按小时为您使用的东西付费。不多也不少。您可以一次租用多台服务器来分担工作量。

我不确定这是否满足您对“功能强大的计算机”的要求，因为它们只是普通的服务器，但至少它会为您提供在您自己的计算机上运行程序的现收现付解决方案。

            回答 #2

赞同：4

时间：2009-02-24T18:32:56.870

Amazon 的 EC2 服务是满足您需求的绝佳解决方案。您只需为使用的时间付费，并且可以根据需要扩展到任意数量的机器。

根据他们的[信息](http://aws.amazon.com/ec2/)：

弹性 – Amazon EC2 使您能够在几分钟内而不是几小时或几天内增加或减少容量。您可以同时调试一个、数百甚至数千个服务器实例。当然，因为这一切都是由 Web 服务 API 控制的，所以您的应用程序可以根据需要自动向上和向下扩展。

灵活——您可以选择多种实例类型、操作系统和软件包。Amazon EC2 允许您选择最适合您选择的操作系统和应用程序的内存、CPU 和实例存储配置。例如，您选择的操作系统包括众多 Linux 发行版、Microsoft Windows Server 和 OpenSolaris。

            回答 #3

赞同：1

时间：2010-02-17T11:55:22.443

如果您的应用程序不是并行的，那么在“大机器”上运行它不会获得很多优势，除非瓶颈在于虚拟内存交换。即使是 Top500 超级计算机，在处理顺序工作负载方面也不比任何 PC 都快。

如果您的应用程序可以利用并行性，那么您可以更有效地利用公司现有的资源，而不是仅将其部署在一台 PC 上。如果你有几十台计算机，你可以建立一个松散耦合的异构集群（或本地网格，术语随着时尚而变化）。

            回答 #4

赞同：0

时间：2013-03-26T14:53:13.690

我推荐 CPUsage。

它是网格计算中的“初创公司”。它的特点是任何人都可以用空闲的 cpu 周期加入网格。这使得电网管理便宜，因此电网使用价格也非常便宜。他们有一个 API，如果您将其集成到您的程序中，它将能够在系统上运行。

        xslt - 使用 xsl 获取文件名

ID：582957

赞同：16

时间：2009-02-24T18:28:44.010

标签：xslt, xslt-1.0

如何使用 xsl 1.0 获取文件名？

我试过

```
<xsl:value-of select="base-uri()" /> 
```

但得到**“致命错误！找不到函数：base-uri”**

            回答 #1

赞同：35

时间：2009-02-24T18:41:56.630

**`base-uri()`是一个标准的 XPath 2.0 函数**，所以在运行 XSLT 1.0 时这个函数将不可用。

**在 XSLT 1.0 中，文件名（什么？）可以作为**转换的参数传递。

**请注意**，并非总是可以为样式表或 XML 文档生成文件名——其中一个或两者都可能驻留在内存中而没有相关文件。

从问题中不清楚必须生成哪个文件名。

**以下是在 XPath 2.0 / XSLT 2.0 中查找文件名的方法**：

当前文档的文件名：

```
 base-uri() 
```

当前样式表模块的文件名：

```
 base-uri(document('')) 
```

            回答 #2

赞同：17

时间：2009-02-24T18:34:49.453

在 XSLT v1/XPath v1 中没有这样的 XPath 函数或 XPath 函数的 XSLT 扩展来执行此操作。

很可能没有文件，即使 XSLT 引擎没有理由拥有该文件名（考虑将文件内容加载到缓冲区中，将缓冲区解析为 DOM，然后将 DOM 传递给XSLT 处理器）。

您需要将文件名传递给处理器，以便在转换中作为参数使用。

        algorithm - 这个算法叫什么？

ID：582959

赞同：3

时间：2009-02-24T18:28:49.063

标签：algorithm

我正在尝试查找这个问题，但我不知道它叫什么。前提是这样的：

给定 m 台机器和 j 个作业，其中每个作业只能分配给机器 i 到 j，我需要将作业分配给机器，以便我一次最大化繁忙的机器。我只关心它们在时间 0 是如何分配的。我不关心在作业完成后我将如何安排剩余的作业。

一旦一个作业和一台机器相互分配，其他作业或机器就不能作用于任何一个成员。

            回答 #1

赞同：17

时间：2009-02-24T18:30:54.113

[调度算法](http://en.wikipedia.org/wiki/Scheduling_algorithms)

            回答 #2

赞同：3

时间：2009-02-24T18:34:15.773

正如其他人所说，您描述的是一个问题，而不是算法。您可以使用许多技术来解决您的问题。您应该选择哪一种取决于您的需求。如果您需要*最优解*，则必须使用一种称为整数规划的技术。如果您想要一个*非常好的解决方案*，不一定是最佳解决方案，您可以使用许多启发式方法。

            回答 #3

赞同：1

时间：2009-02-24T18:50:54.843

就像他们说的那样，您基本上是在编写“调度程序”。

由于您的“j”个工作似乎具有相同的优先级，您可能正在查看[“循环 - 时间切片调度算法”。](https://stackoverflow.com/questions/79389/what-is-round-robin-scheduling)

            回答 #4

赞同：1

时间：2009-02-25T17:33:09.673

这个问题是装箱问题的一个变体，它比处理器调度有更广泛的文献。

典型的现实世界 OS 多处理器调度算法不会在知道长时间作业将花费多少时间的情况下运行，并且不会考虑其他问题，例如内存关联性，以及用调度程序的复杂性来换取调度程序的好处。

我在模块化航空电子系统中遇到过此类问题，您将作业分配给节点，并且在作业执行之前您确实知道其作业的预期时间和内存要求。

            回答 #5

赞同：0

时间：2009-02-24T18:30:57.060

听起来像一个调度程序。

            回答 #6

赞同：0

时间：2009-02-24T18:43:34.893

正如其他人所说，它是一个调度程序。

这也是一个用于演示 OOPS 开发的经典问题，特别是它曾经被用作 Smalltalk 编程的一个非常常见的示例应用程序。

        iphone - iPhone 内存泄漏期间会发生什么样的奇怪行为？

ID：582963

赞同：1

时间：2009-02-24T18:30:20.730

标签：iphone, cocoa, cocoa-touch, memory-management

我已经能够在我正在开发的 iPhone 应用程序上始终如一地复制错误。只要我的 UIViewController 的 didReceiveMemoryWarning 方法被调用，该错误就会出现。我看到的一些问题如下：

 *   UITextField 的 text 属性被淘汰。
 *   UITextField 中的先前数据被多次附加到字符串中，因此当我向服务器发送 HTTP 时将损坏的数据返回给我

一旦我在 didReceiveMemoryWarning 上的断点命中，就会发生这种情况，否则一切似乎都工作得很好。我的问题是，在内存泄漏期间发生这种奇怪的行为听起来正常吗？如果是这样，那么 UIViewController 发生了什么会导致以前的 UITextField 中的数据出现这种临时重复（这是 UITableViewCell 的 contentView 的一部分，所以我认为单元格的出列会发生一些奇怪的事情）

还是很有趣的。

谢谢！

            回答 #1

赞同：1

时间：2009-02-24T18:37:09.510

当 iPhone 内存不足时，操作系统会尝试智能地做一些事情来减少内存开销。在少数情况下，我看到这会导致奇怪的行为，例如文本内容丢失或键盘无法显示。

但是，您可能希望专注于寻找记忆问题的根源而不是结果。

            回答 #2

赞同：-1

时间：2009-02-24T18:47:36.960

通常，不是很多，只要您的应用程序没有使用硬件中的所有内存。但是内存泄漏会堆积起来，接下来你就会知道你的物理 RAM 已经用完了。随着虚拟内存的启动以及应用程序的某些部分开始分页到速度慢得多的闪存磁盘存储，您可能会看到性能突然下降。这是你的控制器可能会收到内存不足警告的时候，UIKit 可能会删除一些它认为你不需要的东西（比如没有超级视图的视图，可能还有其他的东西）。不久之后，整个应用程序将崩溃，因为 iPhone 操作系统会因为它使用太多内存而强制它退出。

简短的版本：内存泄漏导致崩溃。但是删除它认为你不需要的对象也可能会导致一些奇怪的行为。

        .net - 从 vb6 调用 .net 程序集会导致运行时错误 424

ID：582980

赞同：1

时间：2009-02-24T18:33:49.287

标签：.net, vb6, regasm

我在从 vb6 调用 .net 程序集时遇到了一些麻烦，希望 SO 能提供帮助。

在 VB.net 中，我构建了一个 ComClass 并保留了默认构造函数和 GUID。部署时，我 REGASM.exe dll，它与 VB6 exe 位于同一文件夹中。.net dll 引用了另外两个 .net dll，它们都在同一个文件夹中。

我正在尝试使用 VB6 函数 CreateObject() 加载 .net 程序集。运行 VB6 exe 时，出现以下错误

```
 Run-time rror '424':
    Object required 
```

这发生在 Windows 2000 服务器上。我能够在 XP 盒子上创建对象，但是我不确定这两个盒子的状态到底有多么不同。

如果有人有任何想法，将不胜感激。谢谢

            回答 #1

赞同：1

时间：2009-02-24T18:36:10.467

试试 REGASM /CODEBASE。这允许您将 dll 加载到它所在的位置，而不是 GAC。

        sql - 插入后，更新触发器未运行

ID：582987

赞同：1

时间：2009-02-24T18:35:10.280

标签：sql, sql-server, triggers

我在插入或更新之后有两个触发器，而不是插入。似乎 after 触发器没有运行或发送正确的数据。

我已经验证了 Z_UpdateStageTable 存储过程的正确操作和 Insert 触发器的替代。删除而不是插入触发器没有任何影响。插入后更新触发器一次正常工作，我没有对其进行任何更改。我已经尝试删除它并添加它，但它仍然没有运行或没有正确的数据。

有任何想法吗？

而不是插入：

```
ALTER TRIGGER [DeleteExistingFilter]
   ON  [dbo].[Z_MobileSyncFilters]
INSTEAD OF INSERT
AS 
BEGIN
SET NOCOUNT ON;
DELETE FROM Z_MobileSyncFilters WHERE UserID = (SELECT UserID FROM INSERTED);
INSERT INTO Z_MobileSyncFilters
SELECT *
FROM INSERTED;
END 
```

插入后，更新：

```
TRIGGER [UpdateStageTable] 
   ON  [dbo].[Z_MobileSyncFilters]
   AFTER INSERT,UPDATE
AS 
BEGIN
SET NOCOUNT ON;
DECLARE @AllWos AS VARCHAR(5000);
DECLARE @PmWos AS VARCHAR(5000);
DECLARE @RepWos AS VARCHAR(5000);
SET @AllWos = (SELECT AllWos FROM INSERTED);
SET @RepWos = (SELECT AllWos FROM INSERTED);
SET @PmWos = (SELECT AllWos FROM INSERTED);
EXEC Z_UpdateStageTable @AllWos;
EXEC Z_UpdateStageTable @RepWos;
EXEC Z_UpdateStageTable @PmWos;
END 
```

            回答 #1

赞同：2

时间：2009-02-24T18:47:17.333

您可以将`PRINT`语句添加到触发器并从 ManagementStudio/Enterprise Manager 手动插入以查看触发器失败的位置。

当您在单个语句中插入多条记录时，我看到了一个问题，因为`SELECT FROM Inserted`它将返回多条记录。

您还可以将`SET`语句更新为`SELECT @Var = AllWos FROM Inserted`

            回答 #2

赞同：2

时间：2009-02-24T18:47:59.720

触发器`SET`部分是否有错字？`AFTER`您将同一事物选择为三个不同的变量。

我不会确认 的行为`Z_UpdateStageTable`，而是尝试用一些简单的东西（比如无参数的 sql 语句）替换它来测试是否调用了触发器。存储过程可能没有被你认为被调用的东西所调用。

            回答 #3

赞同：1

时间：2009-02-24T18:43:59.027

稍等一下，如果 userid 是你的 PK 那么 Z_MobileSyncFilters 还没有数据，这也是一个代替触发器

这整个块并没有真正做任何事情，你为什么需要这个触发器？

```
DELETE FROM Z_MobileSyncFilters WHERE UserID = (SELECT UserID FROM INSERTED);
INSERT INTO Z_MobileSyncFilters
SELECT *
FROM INSERTED; 
```

您的第二个触发器有缺陷，因为如果您进行多行操作，它将失败

为什么这张表上有 2 个插入触发器（之后是 1 个而不是 1 个）？

        .net - 你能解释一下为什么 DirectoryInfo.GetFiles 会产生这个 IOException 吗？

ID：582988

赞同：16

时间：2009-02-24T18:35:39.157

标签：.net, windows, networking, ioexception, novell

我有一个在 Novell 网络上运行的 WinForms 客户端-服务器应用程序，在连接到网络上的唯一 Windows 2003 Server 时会产生以下错误：

```
TYPE: System.IO.IOException
MSG: Logon failure: unknown user name or bad password.

SOURCE: mscorlib
SITE: WinIOError

  at System.IO.__Error.WinIOError(Int32 errorCode, String maybeFullPath)
  at System.IO.Directory.InternalGetFileDirectoryNames(String path,
    String userPathOriginal, String searchPattern, Boolean includeFiles, 
    Boolean includeDirs, SearchOption searchOption)
  at System.IO.DirectoryInfo.GetFiles(String searchPattern, 
    SearchOption searchOption)
  at System.IO.DirectoryInfo.GetFiles(String searchPattern)
  at Ceoimage.Basecamp.DocumentServers.ClientAccessServer.SendQueuedFiles(
    Int32 queueId, Int32 userId, IDocQueueFile[] queueFiles)
  at Ceoimage.Basecamp.ScanDocuments.DataModule.CommitDocumentToQueue(
    QueuedDocumentModelWithCollections doc, IDocQueueFile[] files) 
```

客户的网络管理员通过手动将工作站用户名和密码与服务器上的本地用户同步来管理 Windows Server 连接。该错误的奇怪之处在于，用户可以在错误之前和之后都写入服务器，而无需显式登录。

您能解释为什么会发生错误并提供解决方案吗？

            回答 #1

赞同：49

时间：2009-02-26T21:00:44.330

尝试访问不同域中的 Windows 服务器的文件系统时，我遇到了同样的问题。问题是运行程序的用户帐户无权访问远程服务器。当您使用 Windows 资源管理器时，Windows 在幕后做了额外的工作以使其看起来无缝，因为它猜测您的远程凭据将与您的本地凭据匹配。

如果您将驱动器本地映射到远程服务器，然后在代码中使用本地映射的驱动器，则应该没有问题。如果您无法映射驱动器，但可以硬编码用于远程服务器的凭据，则可以使用以下代码：

```
using System;
using System.ComponentModel;
using System.Runtime.InteropServices;
using System.Security.Principal;

namespace Company.Security
{
    public class ImpersonateUser : IDisposable
    {
        [DllImport("advapi32.dll", SetLastError=true)]
        private static extern bool LogonUser(string lpszUsername, string lpszDomain, string lpszPassword, int dwLogonType, int dwLogonProvider, out IntPtr phToken);

        [DllImport( "kernel32", SetLastError = true )]
        private static extern bool CloseHandle(IntPtr hObject);

        private IntPtr userHandle = IntPtr.Zero;
        private WindowsImpersonationContext impersonationContext;

        public ImpersonateUser( string user, string domain, string password )
        {
            if ( ! string.IsNullOrEmpty( user ) )
            {
                // Call LogonUser to get a token for the user
                bool loggedOn = LogonUser( user, domain, password,
                    9 /*(int)LogonType.LOGON32_LOGON_NEW_CREDENTIALS*/,
                    3 /*(int)LogonProvider.LOGON32_PROVIDER_WINNT50*/,
                    out userHandle );
                if ( !loggedOn )
                    throw new Win32Exception( Marshal.GetLastWin32Error() );

                // Begin impersonating the user
                impersonationContext = WindowsIdentity.Impersonate( userHandle );
            }
        }

        public void Dispose()
        {
            if ( userHandle != IntPtr.Zero )
                CloseHandle( userHandle );
            if ( impersonationContext != null )
                impersonationContext.Undo();
        }
    }
} 
```

然后您可以通过执行以下操作访问远程服务器：

```
using ( new ImpersonateUser( "UserID", "Domain", "Password" ) )
{
    // Any IO code within this block will be able to access the remote server.
} 
```

            回答 #2

赞同：3

时间：2011-04-06T07:49:24.833

对于 VB.Net 开发人员（如我），这里是 VB.Net 版本：

```
Imports System
Imports System.ComponentModel
Imports System.Runtime.InteropServices
Imports System.Security.Principal

Namespace Company.Security
    Public Class ImpersonateUser
        Implements IDisposable

        <DllImport("advapi32.dll", SetLastError:=True)> _
        Private Shared Function LogonUser(ByVal lpszUsername As String, ByVal lpszDomain As String, ByVal lpszPassword As String, ByVal dwLogonType As Integer, ByVal dwLogonProvider As Integer, ByRef phToken As IntPtr) As Integer
        End Function

        <DllImport("kernel32", SetLastError:=True)> _
        Private Shared Function CloseHandle(ByVal hObject As IntPtr) As Boolean
        End Function

        Private userHandle As IntPtr = IntPtr.Zero
        Private impersonationContext As WindowsImpersonationContext

        Public Sub New(ByVal user As String, ByVal domain As String, ByVal password As String)
            If Not String.IsNullOrEmpty(user) Then
                Dim loggedOn As Integer = LogonUser(user, domain, password, 9, 3, userHandle)
                If Not loggedOn = 1 Then
                    Throw New Win32Exception(Marshal.GetLastWin32Error())
                End If
                impersonationContext = WindowsIdentity.Impersonate(userHandle)
            End If
        End Sub

        Public Sub Dispose() Implements System.IDisposable.Dispose
            If userHandle <> IntPtr.Zero Then
                CloseHandle(userHandle)
            End If
            If impersonationContext IsNot Nothing Then
                impersonationContext.Undo()
            End If
        End Sub

    End Class
End Namespace 
```

并像这样使用它：

```
using New ImpersonateUser( "UserID", "Domain", "Password" ) 
    ' ... your code here
End Using 
```

            回答 #3

赞同：1

时间：2009-03-05T08:58:27.393

我认为您应该尝试重现该问题，而不是使用数据包监视器查看网络流量并查看失败情况和成功情况之间的差异。

然后编写一个应用程序，它使用来自 windows (P/Invokes) 的原始 api 来重现您的失败情况并尝试找出哪些参数导致错误发生。如果您能够解决问题，那么只需找到如何让组件完成您想要的事情。

您可以查看的其他方向（在您可以稳定地重现问题之后）：

*   使用[Process Monitor](http://technet.microsoft.com/en-us/sysinternals/bb896645.aspx)记录所有 api 调用并查看错误来自何处。
*   在干净的虚拟机/机器上尝试并尝试在那里重现它
*   禁用病毒扫描程序
*   更新 Novell 客户端

            回答 #4

赞同：1

时间：2009-03-05T09:19:52.677

恕我直言，这似乎是刷新过期的身份验证令牌（或类似的东西）的某种副作用。

我的情况是，作为通过代理（squid）访问 Internet 的 Active Directory 用户，我浏览时没有问题，直到我（以随机时间间隔）收到有关缺少凭据的错误，这可以通过浏览器中的页面刷新来解决，然后一切正常，直到下一个错误。

            回答 #5

赞同：0

时间：2018-02-27T14:58:37.973

此地址有一个 Microsoft 示例：[https ://msdn.microsoft.com/en-us/library/system.security.principal.windowsimpersonationcontext(v=vs.110).aspx](https://msdn.microsoft.com/en-us/library/system.security.principal.windowsimpersonationcontext(v=vs.110).aspx)

但在他们的示例中确实说：“在 Windows Vista 及更高版本上，此示例必须以管理员身份运行。”

因此，只有在大多数平台上运行代码的用户是管理员时，此解决方案才有效。

        sas - 基于统计的营销活动测量工具

ID：582989

赞同：1

时间：2009-02-24T18:35:40.140

标签：sas, business-objects, cognos

目前使用 SAS 作为测量引擎，Business Objects 作为显示层。希望开发一种新的、更快、更流畅的解决方案。是否有人开发或购买了活动测量报告系统？这个解决方案应该衡量从电子邮件统计、网络统计、客户活动、提升、投资回报率等方面的所有内容。

好的..我正在研究和寻找nada...我们正在与来自印度的团队合作，他们想从头开始重写所有内容..有什么解决方案吗？

            回答 #1

赞同：3

时间：2009-03-02T17:50:38.997

如果您已经在使用 SAS，您是否看过他们的[营销自动化软件](http://www.sas.com/solutions/crm/mktauto/index.html#section=1)？

**更新：**
刚刚看到SAS[发布的关于新的“软件即服务”活动管理解决方案的新闻稿](http://www.sas.com/news/preleases/campaignmanagementSGF09.html)。可能值得一试。

            回答 #2

赞同：1

时间：2009-03-01T01:41:01.003

当我还是一名顾问时，我们要么推出自己的产品，要么使用 SAS（或两者的组合）。  

            回答 #3

赞同：0

时间：2009-03-05T22:25:22.600

另一个投票支持你自己，这个地区服务不足真是太疯狂了。从头开始构建您自己的解决方案的费用，以及管理远程团队的麻烦，让我认为您可以通过集成一些现有工具走得更远。

用于网络使用的谷歌分析有一个 API，有许多网络日志工具，然后你需要从你的事情结束时输入客户数据。

            回答 #4

赞同：0

时间：2009-03-09T08:10:11.780

我真的怀疑在这方面你能比 SAS 做得更好。特别是如果你拿起他们的一些专家包。

你可以看看 R，它是一个非常漂亮的开源统计包。不幸的是，它并没有太多地用于营销；大多数示例和免费提供的代码都是针对生物化学、遗传学等的。

        appliance - 是否可以编写基于 Windows 的设备？

ID：582993

赞同：7

时间：2009-02-24T18:36:48.887

标签：appliance

开源社区正在生产大量的软件设备，因为它们能够分发操作系统，基本上是免费的。因此，您可以非常轻松地下载应用程序的虚拟映像并在几分钟内运行它，而无需进行配置和设置。这对于降低设置和配置成本以及为客户提供演示软件是一个很大的优势。

对于设备来说甚至更好，因为基于 oss 的应用程序可以轻松地使操作系统适应嵌入式设备的有限资源，而这在 Windows 中是不可能的，例如摆脱 GUI 界面，从内核中删除不必要的代码等。

可以用windows做类似的事情吗？如果是这样，怎么做？

            回答 #1

赞同：5

时间：2009-02-24T18:37:58.400

查看[Windows 嵌入式](http://www.microsoft.com/windowsembedded/en-us/products/westandard/default.mspx)；它做了您提到的一些事情（例如，让您定制包含的内容、省略 GUI 等）

            回答 #2

赞同：4

时间：2009-02-24T18:39:30.177

看看[.NET Micro Framework——](http://en.wikipedia.org/wiki/.NET_Micro_Framework)它的内存占用只有 300kb，而且非常精简。它可以在有或没有操作系统的情况下运行。

*   大约 300 KB 的内存占用；作为比较，下一个最小的 .NET 实现，在 Windows CE 上运行的 .NET Compact Framework，需要大约 12 MB
*   无需操作系统即可直接“在金属上”运行；在操作系统上运行也是可能的
*   支持常见的嵌入式外设和互连，包括闪存、EEPROM、GPIO、I2C、SPI、USB
*   针对电池供电设备的能效进行了优化
*   不需要内存管理单元
*   即使在单线程操作系统上运行也提供多线程支持
*   硬件抽象层允许移植到其他架构
*   托管设备驱动程序模型允许使用 C# 编写许多设备的驱动程序
*   捕获设备锁定和崩溃的执行约束
*   透明支持将对象存储在非易失性存储器中

            回答 #3

赞同：0

时间：2009-02-24T18:45:26.870

可以做，但不能定制那么多。Windows Embedded 需要 40MB，Embedded Linux 可能需要（远）少于 10MB，这取决于您想要/需要什么，如果需要，您可以进一步削减它，或者在不同的方向进一步构建它，如果需要的话，给定必要的资源技能/时间/等

            回答 #4

赞同：0

时间：2012-03-23T14:09:30.013

不可以。但是您可以妥协，获得具有适当许可和限制但仍符合您的需求的东西。

        database - NHibernate：使用拦截器或触发器审计日志记录？

ID：582994

赞同：3

时间：2009-02-24T18:37:08.623

标签：database, nhibernate, hibernate, orm, triggers

触发器似乎是审计日志记录的简单解决方案。为什么要使用拦截器？

1.  数据库可移植性是触发器之一...

别人是什么？

            回答 #1

赞同：2

时间：2009-02-24T19:39:22.810

使用除触发器之外的任何东西的缺点是并非所有数据更改都可能通过 GUI 发生，因此可能不会被记录。您必须考虑从许多来源更改数据库，包括数据导入和来自查询窗口的基于集合的查询（例如，当有人被要求将所有价格更新 10% 时）。如果您使用另一种方法，您最好确保它可以捕获任何可以更改数据的方式。如果您完全使用动态 sql，那么您的所有表都对用户开放，可以直接在数据库中进行更改，包括旨在从公司窃取的欺诈性更改。实施欺诈的用户是审计触发器旨在捕获的关键内容之一。如果您认为您的审计解决方案没问题，因为它从用户界面捕获了所有内容，并且它需要捕获所有内容，那么您就大错特错了。我不知道拦截器是如何工作的，但是在您认为该解决方案将起作用之前，您最好使用查询窗口中的 SSIS（或 DTS）导入和查询进行测试。此外，如果它仅从 GUI 工作，请记住可能有多个 GUI 连接到数据库。

            回答 #2

赞同：1

时间：2009-03-05T23:19:42.643

我认为使用拦截器的原因有两个：

1.  这样您就不会将自己绑定到特定的数据库。移植到不同的 DBMS 要容易得多。

2.  这样您的域模型就不会渗入代码的其他区域。即数据库需要知道记录是否已更改。

但这一切都取决于上下文。如果必须对特定记录进行所有更改，那么我认为 HLGEM 是正确的。触发器最适合处理这种类型的场景。

            回答 #3

赞同：1

时间：2009-03-21T02:55:56.333

我同意 HLGEM。除了拥有触发器和 DBMS 的可移植性优势之外，一个很好的替代方法是使用一些审计工具： 给定审计计划：为适当的 DBMS 生成触发器

巴勃罗·哈维尔

            回答 #4

赞同：0

时间：2009-02-24T18:53:02.327

另一个小问题是触发器执行任何 DML。nHibernate 使用受影响的行数来确定其许多操作是否成功。如果您正在执行任何插入/更新/等。在触发器内部，那么您需要在触发器内部打开 NOCOUNT 以防止那些错误的行数冒泡。  

无论如何，这并不是说这会阻止您使触发器工作，但是我已经花了足够的时间来重构这个问题，我认为这是值得一提的。拦截器或事件监听器是满足审计要求的一种简单、可移植的方式。

另外，不再有讨厌的 T-SQL 代码......

            回答 #5

赞同：0

时间：2009-07-08T13:27:18.957

触发器不容易测试，而且它们实际上很难正确编写。而且，如果您的审计数据要由业务用户使用，通常很难将数据库行级操作转换回域模型。

我认为数据库实际上只是应用程序的持久性区域。单个应用程序。换句话说，我不认为其他系统应该直接使用我的数据库，所以我认为审计应该在数据库之外完成（即不使用触发器）。

```***********