# StackOverflow 问答 10014000-10014999

# java - 从一个 git 服务器获取并使用 Jenkins 推送到另一台服务器

> ID：10014004
> 
> 赞同：5
> 
> 时间：2012-04-04T15:11:14.940
> 
> 标签：java, git, jenkins, jenkins-plugins

我有一个本地 git 服务器 (centOS)，每个人都将他们的工作推送到该存储库。Jenkins 设法在一夜之间构建了该存储库中的任何内容。最近我有了一个 Git Enterprise 帐户。我一直想知道是否有任何方法可以强制 Jenkins 1）只从本地服务器中提取代码，2）每当构建成功时，将代码发送到 git 企业远程存储库。

我正在使用 Jenkins v. 1.458

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-04T16:37:46.913

好吧，一种选择是只创建一个从 bash 执行此操作的脚本......但是......

**安装[Multiple SCMs 插件](https://wiki.jenkins-ci.org/display/JENKINS/Multiple+SCMs+Plugin)**后，您可以在“源代码管理”部分下添加两个 git 存储库，然后指定您要构建 REPOLOCALNAME/branch，然后在“Git publisher”下指定您要合并和推送到远程分支。（即 BranchToPush=branchname 和 TargetRemoteName=REMOTEREPONAME）

*请记住，当您在 SCM 部分下添加存储库时，会在存储库的高级选项下指定名称。

*我没有对此进行测试，它有可能只允许您从同一个存储库中拉取和推送。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-04T16:34:07.463

您可以将推送到 Github 设置为仅在其他所有操作成功后运行的最后一个构建步骤，并使用正常机制从本地 git 存储库中检索代码。目前没有具有此功能的插件。

# android - 在android中启用/禁用振动功能？

> ID：10014005
> 
> 赞同：0
> 
> 时间：2012-04-04T15:11:26.060
> 
> 标签：android, service, vibration, android-vibration

我已经使用振动器实现了振动。在我的应用程序中，当用户按下按钮时，振动会起作用。对于某些用户不喜欢应用程序中的振动，所以我有一个切换按钮作为振动开/关。我只需要知道如何实现启用/禁用振动功能。这是我的振动器课

```
 Vibrator vib = (Vibrator) getSystemService(Context.VIBRATOR_SERVICE);  
     vib.vibrate(500);
      Toast.makeText(this, "vib started", Toast.LENGTH_LONG).show(); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-04T15:25:28.713

使用布尔标志来切换

```
if(isVibrate){
Vibrator vib = (Vibrator) getSystemService(Context.VIBRATOR_SERVICE);  
     vib.vibrate(500);
      Toast.makeText(this, "vib started", Toast.LENGTH_LONG).show();
}

else{

// do nothing

} 
```

# mercurial - 如何将两个 Mercurial 存储库合并为一个

> ID：10014012
> 
> 赞同：0
> 
> 时间：2012-04-04T15:12:02.550
> 
> 标签：mercurial, branch

我必须分离 Mercurial 存储库。一个是项目的主干，另一个是带有一组附加更改的分支。

项目存储库有一个中心位置，我希望主干和分支都可用。我想做的是将两个存储库合并为一个，但仍然允许通过标签或类似的东西访问分支。这将允许开发人员检查主代码，但如果需要进一步更改，也可以切换到在分支上工作。我还想确保主干中的任何代码都不会意外进入分支。对分支的任何更改都应该是明确的和有意的。

实现这一目标的最佳方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-04T20:44:42.477

正如 Brandon 所说，只需从分支 repo 推送到主干，或将分支拉入主干。

然后，您可以选择是否要将分支和主干合并在一起，或者将它们分开。如果您从分支推送到主干，您可能会收到有关多头的警告。如果您想将它们分开，只需执行 push -f 即可。（拉动可能不会给出警告）

您可以将分支更改合并到主干，如果需要，以后仍然可以在分支上做进一步的工作。一般来说，我会标记每个版本，这样我就可以轻松地回到任何已经发布的内容。

创建分支时，是否将其克隆到另一个目录？如果是这样，将分支拉入主干仓库后将更难找到分支。您可能需要阅读[书签](http://mercurial.selenic.com/wiki/Bookmarks)以标记分支。还要看看[多头是如何工作的。](http://mercurial.selenic.com/wiki/MultipleHeads)

注意：另一个选项是使用[命名分支](http://mercurial.selenic.com/wiki/NamedBranches)来永久标记分支。你不需要做任何额外的事情来稍后切换到它。

# c# - Reportviewer 报告过滤器 - 检查日期是否为空

> ID：10014014
> 
> 赞同：3
> 
> 时间：2012-04-04T15:12:08.423
> 
> 标签：c#, visual-studio, visual-studio-2010, reportviewer, report-viewer2010

我正在使用带有 vs2010 和本地数据库的 ac# windows 应用程序。在我的一个表单中，我使用 ReporViewer 来显示报告。

只有当特定字段（女巫是日期）不为空时，我才希望能够在此报告中显示记录的结果。我创建了一个表并添加了一个过滤器，但似乎我使用的表达式是错误的。

我在**Tablix 属性**- 过滤器中使用了类似的东西：

表达 `=IsNothing(Fields!payed.Value)`

操作员 `=`

价值 `=true`

有什么想法吗？提前致谢！也许我忘记了值输入中的 = 。它现在正在工作！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-05T20:13:28.433

表达`=IsNothing(Fields!payed.Value)`

操作员`=`

价值`= true`

支付的地方是日期字段

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-04T15:51:34.927

请尝试以下

```
=IIF(IsNothing(Fields!payed.Value),"Show_your_desired_value",Fields!payed.Value) 
```

应在 IsNothing() 函数中检查日期字段。我在这里问一个问题，是否支付是日期变量？

# java - 由 SQL 查询填充的 Java Jtree

> ID：10014015
> 
> 赞同：4
> 
> 时间：2012-04-04T15:12:17.043
> 
> 标签：java, swing, hashtable, jtree, treemodel

我想从我将从 SQL 查询中导入的二维对象数组创建一个 JTree。这是 SQL 表的样子：

这是对象的示例：

```
 Object[][] table = {
        {1, 0, "Root"}, //i=0
        {2, 1, "Node2"}, //i=1
        {3, 1, "Node3"}, //i=2
        {4, 1, "Node4"}, //i=3
        {5, 4, "Node5"}, //i=4
        {6, 4, "Node6"}, //i=5
        {7, 4, "Node7"}, //i=6
        {8, 1, "Node8"}, //i=7
        {9, 1, "Node9"}, //i=8
        {10, 9, "Node10"},}; //i=9 
```

这是我用来对数组进行排序的逻辑：

```
 for (int i = 0; i < table.length; i++) {
        for (int j = i; j < table.length; j++) {
            if (table[i][0] == table[j][1]) {
                System.out.println(table[i][2].toString() + " is parent of " + table[j][2].toString());
            }
        }
    } 
```

这是上面在控制台中显示的内容：

```
 Root is parent of Node2
 Root is parent of Node3
 Root is parent of Node4
 Root is parent of Node8
 Root is parent of Node9
 Node4 is parent of Node5
 Node4 is parent of Node6
 Node4 is parent of Node7
 Node9 is parent of Node10 
```

我正在努力创建可用于创建 JTree 的 TreeModel、HashTable、Object 等。

我已经在这个问题上停留了一个多星期，现在我真的可以借鉴其他人的经验。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-04T16:31:25.253

将您的数据组织到这些列中：

```
CREATE TABLE tree_node
(NodeID int,
ParentID int,
Value varchar(250)
...) //as many values per node as you want 
```

这将允许您遍历记录集并填充您的 JTree。

看看[深度优先](http://en.wikipedia.org/wiki/Tree_traversal#Depth-first_traversal)和[广度优先](http://en.wikipedia.org/wiki/Tree_traversal#Breadth-first_traversal)树遍历。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-07T21:36:41.217

我是 Java 新手，所以我不得不对这个问题进行一些研究。研究真的很费时间。我发现以下链接具有从 SQL 数据创建 JTree 的最佳解决方案。

[https://forums.oracle.com/forums/thread.jspa?threadID=2225475](https://forums.oracle.com/forums/thread.jspa?threadID=2225475)

这是我用来解决问题的代码

```
class myTree extends JPanel {

private DefaultMutableTreeNode rootNode;
private DefaultTreeModel treeModel;

public myTree() {

    super(new GridLayout(1, 1)); //Set the layout for the panel that the jtree.

    //The following object is a sample from a database and was used to validate 
    //the solution below. Make sure the table is properly sorted before you create the 
    //the object from the query.
    Object[][] table = {
        {1, null, "Root"}, //i=0
        {2, 1, "Node2"}, //i=1
        {3, 2, "Node3"}, //i=2
        {4, 3, "Node4"}, //i=3
        {5, 4, "Node5"}, //i=4
        {6, 5, "Node6"}, //i=5
        {7, 6, "Node7"}, //i=6
        {8, 1, "Node8"}, //i=7
        {9, 1, "Node9"}, //i=8
        {10, 9, "Node10"},};    //i=9

    //Create as many nodes as there are rows of data.
    DefaultMutableTreeNode[] node = new DefaultMutableTreeNode[table.length];
    for (int i = 0; i < table.length; i++) {
        node[i] = new DefaultMutableTreeNode(table[i][2].toString());
    }

    rootNode = node[0];   //Set the root node

    //Cycle through the table above and assign nodes to nodes
    for (int i = 0; i < table.length; i++) {
        for (int j = 1; j < table.length; j++) {
            if (table[i][0] == table[j][1]) {
                System.out.println(table[i][2].toString() + " is parent of " + table[j][2].toString());
                node[i].add(node[j]);
            }
        }
    }
    //Creating the tree model. setting the root node.
    treeModel = new DefaultTreeModel(rootNode);
    //Setting the tree model to the JTree
    JTree tree = new JTree(treeModel);
    //adding the tree to the JPanel
    add(tree);
} 
```

# eclipse - Phonegap：如何在构建期间/之后从 apk 文件中删除文件？

> ID：10014019
> 
> 赞同：2
> 
> 时间：2012-04-04T15:12:25.263
> 
> 标签：eclipse, cordova, apk

当我在 Eclipse 中运行（并构建）Phonegap 应用程序时，我想随后从构建的 apk 中删除所有不必要的文件（临时文件、*.php 文件等）

我制作了一个 PHP 脚本，它可以做到这一点（使用 ZipArchive），它在单独执行时完美运行，但不是在我制作的自定义构建器中。我将此构建器添加到构建器列表的末尾，但我猜在部署 apk 时它仍然被锁定，所以我无法对其进行更改。

从 Eclipse 运行/构建时，有什么方法可以从 Phonegap apk 中删除文件？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-06-05T20:10:52.330

您可以使用'hook'...编写一个脚本来删除不需要的文件并将其放在“{projectFolder}/hook/after_build/”文件夹下。

# objective-c - performSelector 在类别类方法上

> ID：10014022
> 
> 赞同：1
> 
> 时间：2012-04-04T15:12:30.333
> 
> 标签：objective-c, ios, categories

我有一个名为 EventEntry 的 NSManagedObject 子类，它由 Xcode 自动生成，我尽量不要触摸（以防我更改模型并想要重新生成）。因此，我将任何添加的功能放入名为 EventEntry+Extended 的类别中。

一个这样的功能是一个名为 eventEntriesByUser 的类方法。我已经订阅了这个类方法以定期调用并使用 performSelector 来调用它。

EventEntry+Extended.h

```
@interface EventEntry (Extended)

    + (void)eventEntriesByUser;

@end 
```

EventEntry+Extended.m

```
@implementation EventEntry (Extended)

    + (void)eventEntriesByUser
    {
        trace(@"%s", __PRETTY_FUNCTION__);
    }

@end 
```

但是，当我尝试这样做时，我会崩溃。

```
[EventEntry performSelector:@selector(eventEntriesByUser)]; 
```

错误...

```
+[EventEntry eventEntriesByUser]: unrecognized selector sent to class 0xbda08 
```

如果我将此方法移动到 EventEntry 中，它将按预期工作。我还尝试在我调用 performSelector 的文件中包含 EventEntry+Extended.h ，但没有成功。有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-04T15:18:21.660

不知何故，目标成员在类别文件上被关闭了，这就是没有添加方法的原因。我可能会删除这个问题。

# ios - UITableViewCell 右侧有一张图片

> ID：10014025
> 
> 赞同：0
> 
> 时间：2012-04-04T15:12:38.877
> 
> 标签：ios, image, uitableview, cgrect

我想在 UITableViewCell 的右侧显示图像。我正在使用此代码来执行此操作：

```
CGRect imageRect = {80,0,225,44};
UIImageView *uiv = [[UIImageView alloc] initWithFrame:imageRect];
[uiv setImage:[UIImage imageNamed:[NSString stringWithFormat:@"star%@.png", [[self reataurant] valueForKey:@"stars"]]]];
[uiv setClipsToBounds:YES];
[cell addSubview:uiv]; 
```

我的问题是，当我滚动表格视图时，图像显示在其他单元格中。我做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-04T15:23:54.160

可能发生的情况是，您不希望重复使用已经有图像的单元格。查看

a）当您重新使用一个单元格时，如果它有星形图像，则将其删除。

b）在返回单元格之前，在该点添加星号（使用任何测试来确定星号是否应该出现）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-11T08:00:37.187

您可以轻松地将图像视图作为附件视图添加到表格单元格以获得相同的效果。

以下是示例代码，供您理解：

```
UIImageView *imageView = [[UIImageView alloc] initWithImage:[UIImage imageNamed:@"fileName"]];
cell.accessoryView = imageView;
[imageView release]; 
```

并确保您通过使用单元格标识符在 cellForRowAtIndexPath 方法中重用表格视图的单元格空间，以便消除覆盖问题；）

```
NSString *CellIdentifier = [NSString stringWithFormat:@"S%1dR%1d",indexPath.section,indexPath.row]; 

UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier];

if (cell == nil) 
{
   cell = [[[UITableViewCell alloc] initWithStyle:UITableViewCellStyleDefault reuseIdentifier:CellIdentifier] autorelease];
} 
```

希望这可以消除您的图像相互显示的问题，谢谢:)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-04T15:22:16.017

那些 UITableViewCells 被重用。在你的 cellForRowAtIndexPath 中查找

```
UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:cellIdentifier]; 
```

如果您只希望一个或一组单元格具有此特定布局，则可以为这些单元格传递不同的 cellIdentifier。

# c# - 单个 schema.ini 定义能否涵盖多个文件

> ID：10014026
> 
> 赞同：6
> 
> 时间：2012-04-04T15:12:40.413
> 
> 标签：c#, csv, schema

我已经为 CSV 文件定义了一个 schema.ini 文件，但是我有多个 CSV，我想对它们使用相同的定义，因为它们是一个序列。

IE

```
File0.csv
File1.csv
File2.csv
File.etc.csv 
```

我的架构将类似于：

```
[File*.csv]
Format=Delimited(,)
ColNameHeader=True
col1="Brand Code" Text
col2=Description Text
col3="Display Sequence" Text 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-20T16:05:49.823

据我所知这是不可能的

- ***** ** *** ****** 其实这是可能的，你可以这样做。

```
[file1.csv]
FORMAT = Delimited(#)
ColNameHeader = True
MaxScanRows=10
Col1=...
Col2=...
ColN=...

[File2.csv]
FORMAT = Delimited(#)
ColNameHeader = True
MaxScanRows=10
Col1=...
Col2=...
ColN=... 
```

问候！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-15T09:34:25.363

您可以根据要上传的文件格式在模块/子例程中定义和编写模式。在运行上传之前，必须运行/调用此模块/子例程以创建模式。（我的示例使用的是 VB6）

注意： - Filenametxt 是要上传的文件名

```
IntFileHandleLog = FreeFile
Open App.Path & "schema.ini" For Output As #IntFileHandleLog
Print #IntFileHandleLog, "[" & FileNameTxt & "]"
Print #IntFileHandleLog, "Format=FixedLength"
Print #IntFileHandleLog, "MaxScanRows = 0"
Print #IntFileHandleLog, "CharacterSet = OEM"
Print #IntFileHandleLog, "Col1=" & """" & "Name" & """" & "Text Width 20"
Print #IntFileHandleLog, "Col2=" & """" & "PHONE_NUM" & """" & " Text Width 30"
Print #IntFileHandleLog, "Col3=" & """" & "PHONE_TYPE" & """" & " Text Width 20"
Print #IntFileHandleLog, "col4=" & """" & "UserName" & """" & " Text Width 20"
Print #IntFileHandleLog, "col5=" & """" & "A_STAT" & """" & " Text Width 10"
Print #IntFileHandleLog, "col6=" & """" & "B_STAT" & """" & " Text Width 10"
Print #IntFileHandleLog, "col7=" & """" & "RETRY" & """" & "integer width 2"
Print #IntFileHandleLog, "col8=" & """" & "Birth_Date" & """" & " double width 14"
Print #IntFileHandleLog, "Col9=" & """" & "Joint_Date" & """" & " double width 14"
Close #IntFileHandleLog 
```

# javascript - jQuery Mouseover / Mouseout 不适用于 Live

> ID：10014027
> 
> 赞同：0
> 
> 时间：2012-04-04T15:12:46.133
> 
> 标签：javascript, jquery

我有代码，当我进行 ajax 调用时，它会刷新一列，但鼠标悬停不再起作用。我曾经将它内联在 div 中，但出于其他原因想将其移至 jQuery。这是我的代码。

```
$(".statusbox").live({mouseover:function(){
    wal_id = parseInt(this.id.replace("statuscontainer_", ""));
    $('#rm_'+wal_id).show();
},mouseout:function(){
    wal_id = parseInt(this.id.replace("statuscontainer_", ""));
    $('#rm_'+wal_id).hide();}
}); 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-04T15:18:53.490

这是 live 的正确语法：

```
$(".statusbox").live( 'mouseover', function() {} ); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-04T15:21:47.873

尝试

```
$(".statusbox").live( 'mouseover', function() {
    wal_id = parseInt(this.id.replace("statuscontainer_", ""));
    $('#rm_'+wal_id).show();
}).live('mouseout', function() {
    wal_id = parseInt(this.id.replace("statuscontainer_", ""));
    $('#rm_'+wal_id).hide();}
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-04T15:16:10.153

尝试这个：

```
$(".statusbox").live("hover", function(){
   ...
}, function(){
   ...
}); 
```

# svg - 向 Raphael SVG 对象添加力导向算法

> ID：10014030
> 
> 赞同：1
> 
> 时间：2012-04-04T15:13:10.280
> 
> 标签：svg, raphael, d3.js

我正在使用 Raphael JS 构建用户界面。目前我有一个`.js`脚本，可以根据需要使用 Raphael JS 2.1 绘制所有内容。但是，由于绘图是由动态数据驱动的，因此对象很可能会重叠。将 d3.js 强制布局添加到对象会导致它们自动分散，因此各种 ux 组件不会重叠。但是，我无法将 d3.js 强制布局应用于 Raphael 绘制的 SVG 对象。

[我在这里](http://jsfiddle.net/brockness/pagHh/)使用 JSFiddle 创建了一个基本示例。我使用[d3.js 碰撞检测示例](http://mbostock.github.com/d3/talk/20111018/collision.html)作为“模板”。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-05T21:03:42.443

我已经修复了您的示例并将结果发布在[http://jsfiddle.net/gn6tZ/6/](http://jsfiddle.net/gn6tZ/6/)。您的碰撞函数（`- y`而不是`- r`）中有一个小错字，当您想在强制布局运行后更新节点时，您需要为更新函数提供新数据。

```
var nodes = circleHolder.nodes();

force.on("tick", function(e){
  var q = d3.geom.quadtree( nodes ),
      i = 0,
      n = nodes.length;

  while( ++i < n ) {
    q.visit(collide( nodes[i]));
  }

  d3.selectAll('circle')
       .data(nodes)
       .attr("cx", function(d) { return d.x; })
       .attr("cy", function(d) { return d.y; });

}); 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-04-04T19:41:49.090

[d3](http://mbostock.github.com/d3/)

示例之一：[力有向图](http://mbostock.github.com/d3/ex/force.html)

# c# - Visual Studio c# Telerik 报告

> ID：10014039
> 
> 赞同：1
> 
> 时间：2012-04-04T15:13:54.267
> 
> 标签：c#, visual-studio-2010, telerik, telerik-reporting

我刚刚下载了 Telerik，在互联网上找不到太多帮助。我希望能够生成一个华丽的报告，而 Telerik 看起来像是要走的路。话虽如此，我不想使用所有的向导和垃圾来构建我的报告。是否有某种“report_load”函数可以在报告加载时使用。我需要能够配置连接字符串，并且让用户输入一些生成报告的值。

这是生成报告的代码：

```
private void GenerateReport()
    {
        DBaseConn.Open();
        SqlCommand = new SqlCommand("SELECT Gate, Weight, Date_Created FROM Backrib_Manifest " +
                                    "WHERE Date_Created >= '" + fromddate + "'" + 
                                    "AND Date_Created <= '" + todate + "'", DBaseConn);
        DataReader = SqlCommand.ExecuteReader();

        while (DataReader.Read())
        {
            switch (Convert.ToInt32(DataReader["Gate"]))
            {
                case 1:
                    gatecount[0]++;
                    gate1weight += double.Parse(DataReader["Weight"].ToString());
                    break;
                case 2:
                    gatecount[1]++;
                    gate2weight += double.Parse(DataReader["Weight"].ToString());
                    break;
                case 3:
                    gatecount[2]++;
                    gate3weight += double.Parse(DataReader["Weight"].ToString());
                    break;
                case 4:
                    gatecount[3]++;
                    gate4weight += double.Parse(DataReader["Weight"].ToString());
                    break;
                case 5:
                    gatecount[4]++;
                    gate5weight += double.Parse(DataReader["Weight"].ToString());
                    break;
                case 6:
                    gatecount[5]++;
                    gate6weight += double.Parse(DataReader["Weight"].ToString());
                    break;
                case 7:
                    gatecount[6]++;
                    gate7weight += double.Parse(DataReader["Weight"].ToString());
                    break;
                case 8:
                    gatecount[7]++;
                    gate8weight += double.Parse(DataReader["Weight"].ToString());
                    break;
                case 0:
                    gatecount[8]++;
                    gate0weight += double.Parse(DataReader["Weight"].ToString());
                    break;
                default:
                    break;
            }
        }
        DBaseConn.Close();

        int totalcount = gatecount[0] + gatecount[1] + gatecount[2] + gatecount[3] + gatecount[4] +
                         gatecount[5] + gatecount[6] + gatecount[7] + gatecount[8];

        lblCount1.Text = gatecount[0].ToString();
        lblCount2.Text = gatecount[1].ToString();
        lblCount3.Text = gatecount[2].ToString();
        lblCount4.Text = gatecount[3].ToString();
        lblCount5.Text = gatecount[4].ToString();
        lblCount6.Text = gatecount[5].ToString();
        lblCount7.Text = gatecount[6].ToString();
        lblCount8.Text = gatecount[7].ToString();
        //lblCount0.Text = gatecount[8].ToString();
        if (totalcount != 0)
        {
            lblPct1.Text = (gatecount[0] / totalcount).ToString("P2");
            lblPct2.Text = (gatecount[1] / totalcount).ToString("P2");
            lblPct3.Text = (gatecount[2] / totalcount).ToString("P2");
            lblPct4.Text = (gatecount[3] / totalcount).ToString("P2");
            lblPct5.Text = (gatecount[4] / totalcount).ToString("P2");
            lblPct6.Text = (gatecount[5] / totalcount).ToString("P2");
            lblPct7.Text = (gatecount[6] / totalcount).ToString("P2");
            lblPct8.Text = (gatecount[7] / totalcount).ToString("P2");
            //lblPct0.Text = (gatecount[8] / totalcount).ToString("P2");
        }

        lblWeight1.Text = (gate1weight / gatecount[0]).ToString();
        lblWeight2.Text = (gate2weight / gatecount[1]).ToString();
        lblWeight3.Text = (gate3weight / gatecount[2]).ToString();
        lblWeight4.Text = (gate4weight / gatecount[3]).ToString();
        lblWeight5.Text = (gate5weight / gatecount[4]).ToString();
        lblWeight6.Text = (gate6weight / gatecount[5]).ToString();
        lblWeight7.Text = (gate7weight / gatecount[6]).ToString();
        lblWeight8.Text = (gate8weight / gatecount[7]).ToString();
        //lblWeight0.Text = (gate0weight / gatecount[8]).ToString();
    } 
```

有没有办法在报告本身中做到这一点？当然，我实际上会将这些值放在报告中定义的位置。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-23T21:41:05.310

我要做的是为您的报表类创建一个（或多个）属性，并在 NeedDataSource （即“report_load”正在询问）事件处理程序。在那里，您可以使用这些内部属性值简单地绑定或设置报表上的值。这样，连接字符串与您的报表类无关，您只需设置属性（例如考虑 DataSource），然后让报表类负责在内部设置其控制值。

注意：有 2 个类与 Telerik 报告相关联。具有所有报表控件等的设计器部分类，以及报表类（您的自定义子类）本身。后者是 NeedDataSource 的去向。

# c++ - C++11 和 C++03 之间的库兼容性

> ID：10014042
> 
> 赞同：11
> 
> 时间：2012-04-04T15:14:00.843
> 
> 标签：c++, c++11

我正在使用 g++-4.7 和 -std=c++0x 在 C++11 中开发应用程序。
我的应用程序链接到一些使用 g++-4.7 编译的共享库，但没有 -std=c++0x 指令。

不幸的是，没有任何效果，这意味着我在使用外部库类和方法时有一些奇怪的行为。（当然编译我的应用程序没有 -std=c++0x 工作正常）。

1.  这是预期的行为还是编译器错误？

2.  任何解决方法（类似于`extern`C 关键字）？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-04-04T15:20:19.267

标准库已更改，`-std=c++0x`编译器标志将确定正在使用库的哪个部分。通过尝试在同一程序中使用这两个版本，您违反了一个定义规则（对于标准库中的每个使用的元素，您有两个相同标识符的定义）。

我认为没有什么简单的方法可以克服这个限制。您必须确保只使用一个版本的库（即在包含标准头文件之前定义适当的宏以禁用这些库中的 C++11），即使这样我也不确定生成的代码是否仍然不会打破 ODR（如果 C++11 扩展以不同方式编译 C++03 库代码）。

# iphone - 苹果开发者统计

> ID：10014044
> 
> 赞同：5
> 
> 时间：2012-04-04T15:14:03.543
> 
> 标签：iphone, ios, app-store, app-store-connect

在 iTunes Connect 中的下载统计信息下，使用兑换码完成的下载是否包含在这些统计信息中？

感谢您的任何回答，对不起我的英语！！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-06T00:47:30.487

我很确定他们会这样做。无论是免费、付费还是促销，任何类型的下载仍然算作“销售”。计算使用 Edu 促销代码下载的教育应用程序。我会假设定期促销也是如此。

# jquery-mobile - 在 jQuery Mobile li 元素中对齐图像

> ID：10014050
> 
> 赞同：0
> 
> 时间：2012-04-04T15:14:28.360
> 
> 标签：jquery-mobile

我有一个 li 元素，其中包含两个链接和一个图像。两个链接位于角落，而图像应与第二个图像的左侧对齐。以下是我想要的结构：

```
-----------------------------------------
link                                              image|link
----------------------------------------- 
```

有什么建议么？如果简单地将代码放在上面，则图像位于左侧链接元素的底部。

# c# - 如何对日期进行数字排序

> ID：10014052
> 
> 赞同：-4
> 
> 时间：2012-04-04T15:14:35.070
> 
> 标签：c#, datetime, sorting

我想对一些日期进行数字排序（不是 Date.compare()）

我应该将日期转换成什么类型​​，这样我就可以**在客户端（JS）上**对表格进行排序？

诠释？时间戳？

如何？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-04T15:16:31.710

使用`DateTime.Ticks`它是`long`类型。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-04T15:22:00.903

使用[Ticks 属性](http://msdn.microsoft.com/en-us/library/system.datetime.ticks.aspx)获取 DateTime 的数字表示。这是一个按 Ticks 对它们进行排序的示例程序：

```
 static void Main(string[] args)
    {
        var dates = new List<DateTime> { new DateTime(2011, 5, 31), new DateTime(2012, 7, 31), new DateTime(2010, 1, 31) };
        dates.OrderBy(d => d.Ticks).ToList().ForEach(d => Console.WriteLine(d.ToString()));

        Console.WriteLine("Press ENTER to exit...");
        Console.ReadLine();
    } 
```

产生这个输出：

```
1/31/2010 12:00:00 AM
5/31/2011 12:00:00 AM
7/31/2012 12:00:00 AM
Press ENTER to exit... 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-04T15:16:55.067

您无需将日期转换为任何内容即可对其进行排序：

```
new[] { DateTime.Now, DateTime.Now.AddDays(-1) }.OrderBy(d => d); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-04T15:17:41.967

像这样排序

```
Array.Sort(datetimearr[]); 
```

使用此[如何按降序对 DateTime 对象的 ArrayList 进行排序？](https://stackoverflow.com/questions/844251/how-to-sort-arraylist-of-datetime-objects-in-descending-order)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-04T15:24:32.420

只需将它们添加到基于`IEnumerable<DateTime>`并使用**LINQ**对它们进行排序的集合中，例如：

```
using System.Collections.Generic;
using System.Linq

...

List<DateTime> dates = new List<DateTime>();

dates.Add(new DateTime(2012, 04, 01));
dates.Add(new DateTime(2012, 04, 05));
dates.Add(new DateTime(2012, 04, 04));
dates.Add(new DateTime(2012, 04, 02));
dates.Add(new DateTime(2012, 04, 03));

List<DateTime> orderedDates = dates.OrderBy(d => d); 
```

您不需要使用`DateTime.Ticks`，因为日期是可比较的。

# git - Git-2-SVN 迁移？

> ID：10014054
> 
> 赞同：10
> 
> 时间：2012-04-04T15:14:38.970
> 
> 标签：git, svn, migration, git-svn

是的，我知道。为什么要从 Git 迁移到 SVN？

好吧，我碰巧遇到了需要将一个巨大的 Git 存储库迁移到 Subversion 的情况！这是我根据 Edwin 的评论尝试的一个工作流程：

首先创建一个本地SVN repo： `svnadmin create svn_repo`

接下来我查看我的 Git 存储库： `git clone git:myNameSpace/myProject`

`cd`进入`myProject`并运行：

`git svn init -s --prefix=svn/ file:///home/myHome/svn_repo/myProject`

`git svn fetch`

`git rev-list --parents master | grep '^.\{40\}$'`查找您的根提交的哈希，并只提供一个应有的提交。

接下来是获取空主干提交的哈希： `git rev-parse svn/trunk`

不幸的是，这个失败了：

`fatal: ambiguous argument 'svn/trunk': unknown revision or path not in the working tree. Use '--' to separate paths from revisions`

好吧，在这之后我不能走太多......

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-12T15:03:10.307

我建议您通过几个简单的步骤使用 SubGit 进行迁移。

```
$ svnadmin create svn.repo
$ subgit configure svn.repo
$ nano svn.repo/conf/subgit.conf #edit path to your (bare!) Git repository (you may use "git clone --bare <URL> bare.git.repo" if you don't have it locally)
$ subgit install 
```

就这样。虽然翻译 SubGit 将尽可能保留所有提交（甚至是临时的）、分支、合并、忽略、日期、EOL 设置、标签等。

翻译后存储库将同步（每次推送到 Git 都会翻译为 SVN 修订版，反之亦然）。中断同步（如果你不需要它）运行

```
$ subgit uninstall svn.repo 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-04T15:24:40.463

---添加细节后编辑---

你做了一个空的初始提交`svn/trunk`吗？如果不是，那么它将解释为什么您会收到在历史记录中找不到的错误。

评论（组合）

```
The --prefix gives you remote tracking branches like "svn/trunk" which
is nice because you don't get ambiguous names if you call your local
branch just "trunk" then. 
```

和

```
Then get the hash of the empty trunk commit: 
```

倾向于暗示他们做出`svn/trunk`承诺以防止 svn 与预先存在的`trunk`目录发生冲突。如果是这样，也许您唯一的失误是没有提交 a`svn/trunk`以便以后找到？

--- 原帖如下---

你试过[这个](http://kerneltrap.org/mailarchive/git/2008/10/26/3815034)吗？在线性化主干（或分支）历史之前，dcommit 将无法正常工作。

请发布您尝试迁移的详细信息。虽然您发布的是有用的错误消息，但与您用来解决该错误的步骤列表相比，它的用处会高出十倍。

# ruby-on-rails - bundle exec rake db:migrate >> 路由错误

> ID：10014055
> 
> 赞同：1
> 
> 时间：2012-04-04T15:14:42.393
> 
> 标签：ruby-on-rails, routing, bundle, ruby-on-rails-3.2, dbmigrate

我遇到了一个小问题。我是新手，正在阅读有关如何构建**demo_app**的指南。
我从**'$ rails generate scaffold User name:string email:string'**
开始， 成功生成scaffold命令后；
我使用**'$bundle exec rake db:migrate'**
我启动 Rails 服务器，然后转到**localhost:3000**；
我尝试访问**localhost:3000/users**并显示*[ROUTING ERROR -- No route matches [GET] "/users"]*

我做错了什么？
我已经按照指南中的所有步骤进行操作，并且应该显示“用户列表”
非常感谢任何帮助..

问候，
马克

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-04T16:07:17.513

如果您的服务器在生成脚手架之前正在运行，那么您应该尝试重新启动服务器。除此之外，请确保以下行出现在您的*config/routes.rb 中*

`resources :users`

我希望它有所帮助。

# grails - 如何解析错误数组列表并将其显示为验证错误

> ID：10014060
> 
> 赞同：2
> 
> 时间：2012-04-04T15:15:03.987
> 
> 标签：grails, grails-orm, gsp, grails-2.0, grails-controller

嗨解析一个验证错误的数组列表并对其进行调整。我有一个数组列表

```
[passwordinsufficientuniquechar, passwordmaxrepeat, passwordinsufficientuniqueno, passwordnotenoughnumbers] 
```

我在 message.properties 中有相应的消息，例如

```
passwordcontainsusername=Your new password cannot contain your user name.
passwordtooshort=Your new password must be at least 8 characters long.
passwordtoolong=Your new password cannot exceed 50 characters.
password.change.different=The new password and the confirmed password values do not match.
passwordmaxrepeat=Your new password cannot contain more than 4 instances of the same character.
passwordequalsoldpassword=Your new password cannot be a previously used password.
passwordnotenoughnumbers=Your new password must contain at least 1 number or punctuation character.
passwordnotallowedchar=Your new password contain one or more characters that are not allowed.
password.change.validateerror=The account password and the current password do not match.
passwordnotenoughchars=Your new password must contain at least 2 letters.
passwordlessthan24hours=You cannot change your password more than three times in 24 hours.
passwordinsufficientuniquechar = Your new password must contain at least 5 unique characters.
passwordinsufficientuniqueno =Your new password must contain at least 2 unique numbers (symbols count as numbers). 
```

我正在使用网络流。那么如何将这些消息解析为 o/p 以显示来自我的属性文件的消息。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-04T15:37:58.680

grails 约定是将您的消息放入`grails-app/i18n/messages.properties`. 然后在您的视图中，您可以使用`g:message`标签：

```
<g:message code="passwordtooshort"/> 
```

如果你有一组消息代码，你可以这样做：

```
<g:each in="${messageCodes}">
    <g:message code="${it}"/>
</g:each> 
```

视图通常是执行此操作的最佳位置，但如果您需要在控制器内部进行翻译，您可以这样做：

```
def translation = message(code: 'passwordtooshort')  // single code
def translations = messageCodes.collect { message(code: it) } // list of codes 
```

# asp.net - Validator.RenderControl 返回一个空字符串

> ID：10014063
> 
> 赞同：0
> 
> 时间：2012-04-04T15:15:12.183
> 
> 标签：asp.net, custom-controls, render

我已经面临以下问题并与之抗争了将近 2 天。我有以下代码。

```
 protected override void Render(HtmlTextWriter writer)
    {
        string controlOutput;
        string validatorOutput;
        string allOutput;
        StringWriter controlStringWriter = new StringWriter();
        HtmlTextWriter controlHtmlWriter = new HtmlTextWriter(controlStringWriter);

        StringWriter validatorsStringWriter = new StringWriter();
        HtmlTextWriter validatorsHtmlWriter = new HtmlTextWriter(validatorsStringWriter);

        base.Render(controlHtmlWriter);
        controlOutput = controlStringWriter.ToString();

        this.renderValidators(validatorsHtmlWriter);
        validatorOutput = validatorsStringWriter.ToString();

        allOutput = String.Format("{0}&nbsp;{1}", controlOutput, validatorOutput);
        writer.Write(allOutput);
    } 
```

renderValidators 函数是：

```
 private void renderValidators(HtmlTextWriter writer)
        {
            foreach (BaseValidator validator in this.ValidatorsCollection)
            {
                validator.RenderControl(writer);
            }
        } 
```

渲染函数返回一个空字符串。集合中的 Validator 的 Visible 属性设置为 true。

我在 OnInit 函数中添加验证器。在第一次渲染期间 validator.RenderControl(writer); 返回一个空字符串，回发后它开始返回一个 html 输入......

也许有人遇到过这样的问题？？？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-04T21:44:26.210

据我了解，您需要在呈现验证器之前检查控件是否已添加到页面中。

```
 Page page = Page;
        if (page == null || page.Request == null) {
            return false;
        } 
```

可以在[MSDN中找到一个非常有用的示例](http://msdn.microsoft.com/en-us/library/aa719624%28v=vs.71%29.aspx)

# css - Magento - 获取 2 列产品登陆页面（网格视图）

> ID：10014067
> 
> 赞同：0
> 
> 时间：2012-04-04T15:15:17.690
> 
> 标签：css, magento

我想在我的网格视图中有一个两列的产品登录页面。所以说两列，可能会将行限制为 4。

我可以更改后端的设置以实现此目的吗？或者也许改变 catalog.xml 来达到这个效果？

寻呼机和分拣机也可以修改/styled 看起来像这样 ![寻呼机/分拣机](../Images/a74a6577139351304038fd2cea433683.png)

任何帮助表示赞赏。希望这是非常简单的事情，但我不知道。

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-04T18:37:49.177

是的，寻呼机工具栏可以通过使用`CSS`

**限制行数（产品）**

行（产品）可以在 Magento 后端**完成**

转到**系统**>**配置**>**目录**>**前端（展开选项卡）**

寻找这些：

```
Products per Page on Grid Allowed Values 
Products per Page on Grid Default Value 
```

要限制总共 8 个产品（2 行和 4 列），请将您的数字（在本例中为 8）添加到两组值中。

**限制列**

首先我会尝试这种方法：[http ://www.eliasinteractive.com/blog/magento-quick-change-in-column-count-for-products-displaying-in-category-listing-grid-view/](http://www.eliasinteractive.com/blog/magento-quick-change-in-column-count-for-products-displaying-in-category-listing-grid-view/)

它的布局很好，很容易理解。

**如果由于某种原因这不起作用，请尝试以下操作：**

转到**app/design/frontend/[package]/[yourtheme]/template/catalog/product/list.phtml**
*将**list.phtml**文件复制到您的（`theme`如果还没有的话）*

向下滚动约 1/2 并找到此部分

```
<?php // Grid Mode ?> 
```

现在找到这一行：

```
<?php $_columnCount = $this->getColumnCount(); ?> 
```

并将其替换为：

```
<?php //$_columnCount = $this->getColumnCount(); ?>
<?php $_columnCount = 2; ?> 
```

这应该会得到您想要的结果！不要忘记在 CSS中编辑**列宽**

# android - android倒计时强制关闭错误

> ID：10014070
> 
> 赞同：0
> 
> 时间：2012-04-04T15:15:23.567
> 
> 标签：android

我有这个代码：

```
import android.app.Activity;     
import android.os.Bundle;     
import android.os.CountDownTimer;     
import android.widget.TextView;       

 public class MActivity extends Activity {      

 TextView start;    

 public void onCreate(Bundle savedInstanceState) {    

      super.onCreate(savedInstanceState);    
      setContentView(R.layout.main);    

      start = (TextView)findViewById(R.id.start_me);    

        CountDownTimer aCounter = new CountDownTimer(100000 , 1000) {    
              public void onTick(long millisUntilFinished) {    
                  start.setText("Remaining: " + millisUntilFinished / 1000);    
              }    

                public void onFinish() {    
                    start.setText("Finished");     
                }     
             };      
           aCounter.start();     
   }     
 } 
```

但是当我运行它时，它会因强制关闭错误而崩溃。你能帮我看看问题出在哪里吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-04T15:18:47.780

`CountDownTimer`不在 UI 线程上运行，因此当它尝试修改属于 UI 的内容时会引发致命异常。

[CountDownTimer 如何在 OnTick 方法中访问 UI？](https://stackoverflow.com/questions/6354740/how-is-countdowntimer-accessing-ui-inside-ontick-method)

编辑：

似乎@blackbelt 评论者是对的。我继续制作了一个 android 项目，您的代码运行良好（Android 2.3.3）。

也许你愿意给我们例外？就像你的 logcat 的摘录？

# sencha-touch-2 - SenchaTouch 2 如何在每个列表行上设置不同的颜色

> ID：10014076
> 
> 赞同：0
> 
> 时间：2012-04-04T15:15:42.970
> 
> 标签：sencha-touch-2

我正在使用 SenchaTouch 2 如何在每个列表行上设置不同的颜色。

SenchaTouch 小提琴示例：

[http://www.senchafiddle.com/#MfLkR#wqVi1#eqWct](http://www.senchafiddle.com/#MfLkR#wqVi1#eqWct)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-04T21:13:26.397

您可以使用 css 为每一行添加特定颜色

```
.x-list-item:nth-child(1n){
/* First Row */
background-color: Green;

}
.x-list-item:nth-child(2n){
/* Second Row */
background-color: Blue;

}
.x-list-item:nth-child(3n){
/* third Row */
background-color: Yellow;

} 
```

创建一个css文件，随意命名。将我的答案中的代码粘贴到该 css 文件中。在 index.html 中引用该 css 文件。或者您可以将样式标签放在 css 代码周围，并将其直接放在 index.html 的头部。

```
<link rel="stylesheet" type="text/css" href="touch2/resources/css/apple.css">
<link rel="stylesheet" type="text/css" href="newCssCode.css"> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T13:15:47.057

@bork

更改“x-list-item-label”的填充，使其使用 css 为 0

然后创建一个新的 div，它将成为模板中项目的一种新容器，更改此 div 的背景颜色。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-04T16:51:42.407

您可以在数据中添加“bgcolor”字段并更改 itemTpl：

```
 items: [ {
   xtype: 'list',
   itemTpl: '<div style="height:35px; background: {bgcolor};">{title}</div>',
      data: [
         { title: 'Red BackGround', bgcolor : 'red' } // same thing for all the other items 
```

# css - 为移动浏览器制作由向下箭头触发的纯 CSS 可折叠菜单

> ID：10014077
> 
> 赞同：1
> 
> 时间：2012-04-04T15:15:48.153
> 
> 标签：css, sass

我正在尝试制作菜单的移动版本。所以我有一个项目清单。仅显示具有类 nav-current 的 li。在伪 :after 的帮助下，我在该 li 的链接之后创建了一个箭头。单击箭头时，我尝试显示所有 li 项目。

我的 html ：

```
<ul class="top-nav">
  <li>
    <a href=#>Textbla</a>
  </li>
  <li class="nav-current">
    <a href=#>Textlpops</a>
  </li>
  <li>
    <a href=#>Google Res</a>
  </li>
</ul> 
```

和我时髦的 CSS：

```
$depends:none;

  .top-nav { 
    float: none; 
    margin: 10px;
    li,li.user-tools {

    display:$depends;

    float:none!important;
    border-bottom: 1px solid #666;
    &:last-child {
     border-bottom:0 none;
    }
    &.nav-current {
     display:block;
     border-bottom:0 none;
     a:after {
       content:'arrow';
       color:#1a1a1a;
       position:absolute;
       top:10px;
       right:20px;
       height:12px;
       background: transparent url(../images/custom/arrow_down.png) no-repeat left top;
      }

     a:target:after {
       $depends:block;
     }

     }
   }   
} 
```

我不想使用任何 javascript，所以我搜索了一个唯一的 css 解决方案。这可以在 sass 中完成吗？或者有什么我可以利用的 css3 技巧来实现它吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-04T18:07:15.070

选择`target`器[不能按照我认为的方式工作](http://reference.sitepoint.com/css/pseudoclass-target)。据我所知，您所描述的在 css 中是不可能的。

## 新答案

我重读了您的问题，并意识到您正在为移动浏览器寻找这个。他们可能也不认识`pointer-events`。[这种新的解决方案](http://jsfiddle.net/67qH9/86/)不依赖于`pointer-events`增强功能，但确实需要更多的标记。到目前为止，我已经在 FF、Chrome 和 IE8/9 中进行了测试，并且运行良好。（我很好奇我的零不透明度`hover-shield`在某些浏览器中是否需要为 0.01）。您必须测试您的移动应用程序。

**HTML**

```
<div class="hidden-nav">  
    <div class="nav-expander"></div>
    <div class="hover-shield"></div>  
    <ul class="top-nav">
      <li>
        <a href=#>Textlinks Adv</a>
      </li>
      <li class="nav-current">
        <a href=#>Textlinks Publ</a>
      </li>
      <li>
        <a href=#>Google Shopping</a>
      </li>
    </ul>
</div> 
```

**CSS**

```
.hidden-nav {
    position: relative; 
    display: inline-block;
}

.nav-expander { /* the activator arrow container */
    width: 16px;
    height: 8px;
    position: absolute;
    top: 5px;
    right: 2px;
    z-index: 4;
}

.nav-expander:before { /* the activator arrow */
    content: '';
    display: block;
    width: 0;
    height: 0;
    border-left: 8px solid transparent;
    border-right: 8px solid transparent;
    border-top: 8px solid blue;
    position: absolute;
    top: 0;
    left: 0;
}

.hover-shield { /* keep activation by the arrow only */
    position: absolute;
    top: 0;
    right: 0;
    bottom: 0;
    left: 0;
    z-index: 2;
    background-color: white; /* needs background to act as hover shield */
    filter: alpha(opacity=0); /* no opacity needed */
    -moz-opacity: 0;
    opacity: 0;
}

.nav-expander:hover + .hover-shield {
    z-index: 0;
}

.top-nav {
    padding-right: 20px; /* make space for arrow */
    background-color: yellow;
    position: relative;    
    z-index: 1;
}

.top-nav:hover {
    z-index: 3;
}

.top-nav li {
    display: block; /*not "none" as we want widest li to size the nav*/
    visibility: hidden;
    height: 0; 
    white-space: nowrap; /*keep the link text in one line*/
}

.top-nav .nav-current {
    visibility: visible; 
    height: auto;
    pointer-events: none; /* for browsers that recognize it, the user is prevented from reclicking the page they are on */
}

.nav-expander:hover ~ .top-nav,
.top-nav:hover {
    height: auto; /*once triggered, let it be its height*/
}

/*show the nav if expander is hovered, or once that is done, the nave itself is hovered */
.nav-expander:hover ~ .top-nav li,
.top-nav:hover li {
    visibility: visible;
    height: auto;
} 
```

## 原始答案

***但是***，[我已经使用`hover`箭头](http://jsfiddle.net/67qH9/69/)设计了一个纯 CSS 解决方案，该解决方案在 FF 和 Chrome（已测试）中运行良好，在 IE8/9 中运行良好（它无法识别 上的`pointer-events`属性`nav-current`，因此它在悬停时打开导航`nav-current`） ; IE7 像 IE8/9 一样工作，只是没有箭头，因为`:after`无法识别。

需要一个额外`li`的。

**HTML**

```
<ul class="top-nav">
  <li class="nav-expander"></li>  
  <li>
    <a href=#>Textlinks Adv</a>
  </li>
  <li class="nav-current">
    <a href=#>Textlinks Publ</a>
  </li>
  <li>
    <a href=#>Google Shopping</a>
  </li>
</ul> 
```

**CSS**

```
.top-nav {
    float: left; /*fit to width of longest li*/
    padding-right: 20px; /*make space for arrow*/
    position: relative;
    background-color: yellow;
    height: 0; /*do not want expand on hover of nav-current*/
}
.top-nav li {
    display: block; /*not "none" as we want widest li to size the nav*/
    visibility: hidden;
    height: 0;
    white-space: nowrap; /*keep the link text in one line*/
    position: relative;
}
.top-nav .nav-current {
    visibility: visible;
    height: auto;
    z-index; 0;
    pointer-events: none; /*don't want hover on this to open nav*/
    background: inherit; /*show background to collapsed nav*/
}

.nav-current:after { /*fake background to collapsed nav*/
    content: '';
    position: absolute;
    width: 20px; /*= top-nav right padding*/
    top: 0;
    bottom: 0;
    left: 100%;
    background: inherit;
}
.nav-current a {
    color: red;
}
.top-nav a:hover {
    color: #555555;
}
.top-nav .nav-expander {
    visibility: visible;
    display: block;
    position: absolute;
    top: 0;
    right: 0;
    z-index: 1; /*cover nav-current when open*/
}

.top-nav .nav-expander:hover {
    left: 0; /*these cause coverage of nav-current on expansion*/
    bottom: 0;
}

.top-nav:hover {
    height: auto; /*once triggered, let it be its height*/
}

.nav-expander:after { /*the activator arrow*/
    content: '';
    display: block;
    width: 0;
    height: 0;
    border-left: 8px solid transparent;
    border-right: 8px solid transparent;
    border-top: 8px solid blue;
    position: absolute;
    top: 5px;
    right: 2px;
}

/*show the nav if expander is hovered, or once that is done, any li is hovered*/
.top-nav:hover li,
.nav-expander:hover ~ li {
    visibility: visible;
    height: auto;
    z-index: 2;
}

/*keeps z-index 0 on current; would use the :not(nav-current) selector to the above code, but IE8 does not recognize that*/
.top-nav:hover li.nav-current,
.nav-expander:hover ~ li.nav-current {
    z-index: 0;
} 
```

# javascript - 验证 DOM 元素

> ID：10014079
> 
> 赞同：0
> 
> 时间：2012-04-04T15:15:52.380
> 
> 标签：javascript, jquery

我有一些输入 HTML 元素，我想验证它们是否已填满。基本上，它们是强制性的。我正在做这样的事情：

```
 var displayNames new Array();
    displayNames[0] = "Name";
    displayNames[1] = "Address";
    displayNames[2] = "Age";

function validForm() {
    var Name = document.getElementById(txtName).value;
    if(!Name) {
      alert(displayName[0] is required);
    }} 
```

我应该如何在 JS 中简化验证？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-04T15:18:12.260

使用[jquery 验证](http://bassistance.de/jquery-plugins/jquery-plugin-validation/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-04T15:21:14.140

> 我应该如何在 JS 中简化验证？

这取决于。它们都是字符串吗？或者有些可以是数字？或者有些需要正则表达式（如电子邮件地址）？哎呀，有些甚至可以是空字符串或空白？

如果我们谈论的字段少于 12 个，那么我会考虑滚动我自己的验证。但是，如果我们谈论的是跨多个页面和项目的大量字段，那么我会考虑使用验证插件，例如[http://bassistance.de/jquery-plugins/jquery-plugin-validation/](http://bassistance.de/jquery-plugins/jquery-plugin-validation/)

# magento-1.5 - 主页加载 Magento 上 Ajax 弹出框中的登录页面

> ID：10014080
> 
> 赞同：0
> 
> 时间：2012-04-04T15:15:52.873
> 
> 标签：magento-1.5

我们如何在 Magento 的主页加载时在 Ajax 弹出框中显示登录页面，弹出框只需要出现一次，直到浏览器关闭，我还需要将 FB 连接到同一个弹出框。请尽快回复我

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-04T19:25:08.350

嗨，您可以使用任何灯箱插件来显示代码，并在弹出窗口中显示登录，您可以像这样覆盖客户 AccountController.php

```
 protected $_validActions = array('create','login','logoutSuccess','forgotpassword','forgotpasswordpost','confirm','confirmation','resetpassword','resetpasswordpost');
  protected $_customActions = array('signupformpopup','ajaxLogin','ajaxCreate');

 public function preDispatch()
 {

         // a brute-force protection here would be nice

       $action = $this->getRequest()->getActionName();

       if (preg_match('/^('.$this->_getCustomActions().')/i', $action))
       {
        $this->getRequest()->setActionName($this->_validActions[1]);
       }

       parent::preDispatch();

       if ($action != $this->getRequest()->getActionName())
       {
        $this->getRequest()->setActionName($action);
       }

       if (!$this->getRequest()->isDispatched()) {
        return;
       }

       if (!preg_match('/^('.$this->_getValidActions().')/i', $action)) {
        if (!$this->_getSession()->authenticate($this)) {
         $this->setFlag('', 'no-dispatch', true);
        }
       } else {
        $this->_getSession()->setNoReferer(true);
       }

 }
  protected function _getValidActions()
  {
  return implode("|", array_merge($this->_validActions, $this->_customActions));
  }

 protected function _getCustomActions()
 {
  return implode("|", $this->_customActions);
 }

/**
 * Login post action
 */
public function ajaxLoginAction() {

    if ($this->_getSession()->isLoggedIn()) {
        $this->_redirect('*/*/');
        return;
    }
    $session = $this->_getSession();
    $result=array();

    if ($this->getRequest()->isPost()) {
        $login = $this->getRequest()->getPost('login');
        if (!empty($login['username']) && !empty($login['password'])) {
            try {
                $session->login($login['username'], $login['password']);
                if ($session->getCustomer()->getIsJustConfirmed()) {
                    $this->_welcomeCustomer($session->getCustomer(), true);
                }
                $result['success'] = true;
                $result['redirecturl'] = Mage::getUrl('customer/account/edit');

            } catch (Mage_Core_Exception $e) {
                switch ($e->getCode()) {
                    case Mage_Customer_Model_Customer::EXCEPTION_EMAIL_NOT_CONFIRMED:
                        /*$message = Mage::helper('customer')->__('This account is not confirmed. <a href="%s">Click here</a> to resend confirmation email.', Mage::helper('customer')->getEmailConfirmationUrl($login['username']));*/
                        $result['success'] = false;
                        $result['message'] = Mage::helper('customer')->__('This account is not confirmed.');
                        break;
                    case Mage_Customer_Model_Customer::EXCEPTION_INVALID_EMAIL_OR_PASSWORD:
                        $message = $e->getMessage();
                        $result['success'] = false;
                        $result['message'] = Mage::helper('customer')->__($message);
                        break;
                    default:
                        $message = $e->getMessage();
                        $result['success'] = false;
                        $result['message'] = Mage::helper('customer')->__($message);
                }
                //$session->addError($message);
                $session->setUsername($login['username']);
            } catch (Exception $e) {
                // Mage::logException($e); // PA DSS violation: this exception log can disclose customer password
            }
        } else {
            //$session->addError($this->__('Login and password are required.'));
            $result['success'] = false;
            $result['message'] = Mage::helper('customer')->__('Login and password are required.');
        }
    }
    $this->getResponse()->setBody(Zend_Json::encode($result));
    //$this->_loginPostRedirect();
}

/**
 * Login post action
 */
public function ajaxCreateAction()
{
    $session = $this->_getSession();
    if ($session->isLoggedIn()) {
        $this->_redirect('*/*/');
        return;
    }
    $session->setEscapeMessages(true); // prevent XSS injection in user input
    if ($this->getRequest()->isPost()) {
        $errors = array();

        if (!$customer = Mage::registry('current_customer')) {
            $customer = Mage::getModel('customer/customer')->setId(null);
        }

        /* @var $customerForm Mage_Customer_Model_Form */
        $customerForm = Mage::getModel('customer/form');
        $customerForm->setFormCode('customer_account_create')
            ->setEntity($customer);

        $customerData = $customerForm->extractData($this->getRequest());

        if ($this->getRequest()->getParam('is_subscribed', false)) {
            $customer->setIsSubscribed(1);
        }

        /**
         * Initialize customer group id
         */
        $customer->getGroupId();

        if ($this->getRequest()->getPost('create_address')) {
            /* @var $address Mage_Customer_Model_Address */
            $address = Mage::getModel('customer/address');
            /* @var $addressForm Mage_Customer_Model_Form */
            $addressForm = Mage::getModel('customer/form');
            $addressForm->setFormCode('customer_register_address')
                ->setEntity($address);

            $addressData    = $addressForm->extractData($this->getRequest(), 'address', false);
            $addressErrors  = $addressForm->validateData($addressData);
            if ($addressErrors === true) {
                $address->setId(null)
                    ->setIsDefaultBilling($this->getRequest()->getParam('default_billing', false))
                    ->setIsDefaultShipping($this->getRequest()->getParam('default_shipping', false));
                $addressForm->compactData($addressData);
                $customer->addAddress($address);

                $addressErrors = $address->validate();
                if (is_array($addressErrors)) {
                    $errors = array_merge($errors, $addressErrors);
                }
            } else {
                $errors = array_merge($errors, $addressErrors);
            }
        }

        try {
            $customerErrors = $customerForm->validateData($customerData);
            if ($customerErrors !== true) {
                $errors = array_merge($customerErrors, $errors);
            } else {
                $customerForm->compactData($customerData);
                $customer->setPassword($this->getRequest()->getPost('password'));
                $customer->setConfirmation($this->getRequest()->getPost('confirmation'));
                $customerErrors = $customer->validate();
                if (is_array($customerErrors)) {
                    $errors = array_merge($customerErrors, $errors);
                }
            }

            $validationResult = count($errors) == 0;
            $result = array();
            if (true === $validationResult) {
                $customer->save();

                if ($customer->isConfirmationRequired()) {
                    $customer->sendNewAccountEmail('confirmation', $session->getBeforeAuthUrl());
                   // $session->addSuccess($this->__('Account confirmation is required. Please, check your email for the confirmation link. To resend the confirmation email please <a href="%s">click here</a>.', Mage::helper('customer')->getEmailConfirmationUrl($customer->getEmail())));
                    //$this->_redirectSuccess(Mage::getUrl('*/*/index', array('_secure'=>true)));
                    //return;
                    $result['success'] = true;
                    $result['message'] = $this->__('Account confirmation is required. Please, check your email for the confirmation link. To resend the confirmation email please <a href="%s">click here</a>.', Mage::helper('customer')->getEmailConfirmationUrl($customer->getEmail()));
                } else {
                    $session->setCustomerAsLoggedIn($customer);
                    $url = $this->_welcomeCustomer($customer);
                    //$this->_redirectSuccess($url);
                    //return;
                    $result['success'] = true;
                    $result['message'] = $this->__('You are successfully registered');
                }
            } else {
                $session->setCustomerFormData($this->getRequest()->getPost());
                if (is_array($errors)) {
                    $result['success'] = false;
                    foreach ($errors as $errorMessage) {
                        //$session->addError($errorMessage);
                        $result['message'] .= $errorMessage;
                    }
                } else {
                    //$session->addError($this->__('Invalid customer data'));
                    $result['success'] = false;
                    $result['message'] = $this->__('Invalid customer data');
                }
            }
        } catch (Mage_Core_Exception $e) {
            $session->setCustomerFormData($this->getRequest()->getPost());
            if ($e->getCode() === Mage_Customer_Model_Customer::EXCEPTION_EMAIL_EXISTS) {
                $url = Mage::getUrl('customer/account/forgotpassword');
                $result['success'] = false;
                $result['message'] = $this->__('There is already an account with this email address. If you are sure that it is your email address.');

            } else {
                $result['success'] = false;
                $result['message'] = $e->getMessage();

            }
            //$session->addError($message);
        } catch (Exception $e) {
           // $session->setCustomerFormData($this->getRequest()->getPost())
             //   ->addException($e, $this->__('Cannot save the customer.'));
            $result['success'] = false;
            $result['message'] = $this->__('Cannot save the customer.');
        }
    }

    //$this->_redirectError(Mage::getUrl('*/*/create', array('_secure' => true)));
    $this->getResponse()->setBody(Zend_Json::encode($result));
} 
```

}

# bash - shell 脚本中是否有办法确定其输出的重定向位置？

> ID：10014083
> 
> 赞同：5
> 
> 时间：2012-04-04T15:15:56.830
> 
> 标签：bash, shell

我们有以下性质的脚本（在 cron 中）

`someScript.sh > /tmp/cronlog/somescript.$(date +%Y%m%d).log 2>&1`

现在有没有一种方法`someScript.sh`可以让我找出输出进入的文件？

该脚本发送带有摘要的电子邮件。同时我想提一下，可以在某某输出文件中找到详细信息 - 在电子邮件中。

我知道`if [ -t 1 ]`检测标准输出等的构造，但如何获取输出文件名？请注意，我希望这是通用的，以便有人可以更改 cron 中的输出文件并且不需要修改脚本。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-04-04T15:31:51.037

我能想到的最简单的事情是：

```
readlink -f /proc/$$/fd/1 
```

$$ 是脚本的 PID（在脚本内部）。在大多数 unix 系统上，/proc/[pid] 是包含进程 [pid] 信息的伪目录。

/proc/[pid]/fd 是一个目录，其中包含进程的打开文件描述符的符号链接列表。fd/0 是输入，fd/1 是脚本的输出，等等。

如果您不重定向输出，readlink 然后会为您提供目标文件或 tty。

当然，如果你想显示它，你必须在标准输出之外的地方显示它，否则它会被重定向！要调试，请尝试 std 错误 (2)。

各种调用在我的盒子上给出了这些结果（script.sh 只是调用 readlink -f /proc/$$/fd/1 >&2）

```
# ./script.sh
/dev/pts/0

# ./script.sh > /var/tmp/foo
/var/tmp/foo

# ./script.sh | more
/proc/12132/fd/pipe:[916212] 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-04T15:49:12.900

与其试图找到一个黑客（而且太依赖于平台），不如在这里采取稍微不同的方法。

像这样设置你的 cron 工作：

```
someScript.sh /tmp/cronlog/somescript.$(date +%Y%m%d).log 
```

即没有和`>`或`2>&1`（stdout/stderr 流重定向），只需传递具有所需`logfile`名称的参数。

现在在 someScript.sh 中将流重定向到您的日志文件，如下所示：

```
LOGFILE=$1
exec &>${LOGFILE} 
```

最后，您可以向您的客户发送消息：

```
"output details could be found in ${LOGFILE}" 
```

# oracle11g - 名字和姓氏相同的记录

> ID：10014090
> 
> 赞同：0
> 
> 时间：2012-04-04T15:16:07.753
> 
> 标签：oracle11g

我有包含以下列的 EMP 表：

```
EmpID
firstName
LastName
Age
DOB
status 
```

如何获得具有相同名字和姓氏的所有员工

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-04T15:51:26.710

It depends what you want your output to look like

```
SELECT firstName, lastName, count(*)
  FROM emp
 GROUP BY firstName, lastName
HAVING COUNT(*) > 1 
```

will show you all the firstName and lastName pairs that are duplicated. If you want to get the empID of both duplicated rows (assuming neither firstName nor lastName can be NULL)

```
SELECT a.empID, b.empID
  FROM emp a,
       emp b
 WHERE a.firstName = b.firstName
   AND a.lastName  = b.lastName
   AND a.rowid     > b.rowid 
```

# c - 如何将三维动态字符数组写入和读取到文件中？

> ID：10014094
> 
> 赞同：2
> 
> 时间：2012-04-04T15:16:13.903
> 
> 标签：c, multidimensional-array, fwrite, dynamic-arrays

我有这个数组

```
char ***three_dim=0; 
```

**three_dim**被分配并填充了数据。在此之后，我必须将其内容写入文件并回读。我尝试了以下方法来编写它，但它失败了。

```
FILE *temp;
temp=fopen("temp","w");
fwrite(three_dim,outer_dim*ROWS*COLUMNS,1,temp);
fclose(temp); 
```

编辑：

以下是它的分配方式：

```
three_dim=new char**[outer_dim];
         for(int i=0;i<outer_dim;++i)
            {
                three_dim[i]=new char*[ROWS];
                for(int k=0;k<ROWS;++k)
                    three_dim[i][k]=new char[COLUMNS];
            } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-04T15:37:02.947

您不能通过单个将其写入文件`fwrite()`，因为您的数组未分配为紧凑的`outer_dim * ROWS * COLUMNS`字节区域。

当您在 for 循环中分配它时，您还必须在 for 循环中输出它。

```
for (i = 0; i < outer_dim; i++)
    for (j = 0; j < ROWS; j++)
        fwrite(three_dim[i][j], COLUMNS, 1, temp); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-04T15:46:15.850

正如其他人所说，最可能的问题是内存没有连续分配。

如果您的 ROWS 和 COLUMNS 是编译时常量，您可以执行以下操作：

```
char (*three_dim)[ROWS][COLUMNS]; // declare three_dim as a pointer to a 
                                  // ROWSxCOLUMNS array of char
...
three_dim = malloc(sizeof *three_dim * outer_dim); 
```

然后，您可以`three_dim`作为 3-D 数组访问：

```
three_dim[i][j][k] = something(); 
```

这将连续分配数据，您应该能够在一次`fwrite`调用中将其编写为

```
fwrite(three_dim, sizeof *three_dim * outer_dim, 1, temp); 
```

否则，小鬼的解决方案就是要走的路。

# c# - 为什么在 C# 中使用 MSN 示例的 SqlConnection 的 ConnectionString 失败？

> ID：10014095
> 
> 赞同：0
> 
> 时间：2012-04-04T15:16:17.163
> 
> 标签：c#, sqlconnection, northwind

我正在逐字使用以下教程示例：

[http://msdn.microsoft.com/en-us/library/system.windows.forms.datagridviewcomboboxcolumn.aspx](http://msdn.microsoft.com/en-us/library/system.windows.forms.datagridviewcomboboxcolumn.aspx)

错误消息是连接失败。“修改它以连接到您的系统可访问的 Norhtwinf=d 数据库。”

```
string connectionString =
     "Integrated Security=SSPI;Persist Security Info=False;" +
     "Initial Catalog=Northwind;Data Source=localhost";

SqlConnection northwindConnection = new SqlConnection(connectionString);
     northwindConnection.Open(); 
```

至于 Northwind 数据库，我从这个网站下载并运行它。

[http://www.microsoft.com/download/en/details.aspx?id=23654](http://www.microsoft.com/download/en/details.aspx?id=23654)

你能说出我做错了什么吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-04T15:30:11.100

确保该帐户有权访问该数据库，并尝试使用此连接字符串：

```
connectionString="Server=MACHINE-NAME\SQLEXPRESS;Database=Northwind;Trusted_Connection=True;" 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-04T15:21:30.993

`Data Source`属性需要指向你的 SQL 实例名称，如果你的 SQL 实例是默认的。

我知道下一个建议有点奇怪，看起来和你使用的一样，但试着让我知道发生了什么：

```
string connectionString =
     "Integrated Security=SSPI;Persist Security Info=False;" +
     "Initial Catalog=Northwind;Data Source=."; 
```

请注意，我已将数据源值从**“localhost”**修改为（点）。

# search - 如何从 emac 中的交互式正则表达式搜索中突出显示以保持突出显示直到停用？

> ID：10014096
> 
> 赞同：2
> 
> 时间：2012-04-04T15:16:25.867
> 
> 标签：search, emacs, highlighting

如何从 emac 中的交互式正则表达式搜索中突出显示以保持突出显示直到停用？例如，使用提供的文本并使用输入“文件”运行 MC（Regexp I-Search）将突出显示下面文本中的 3 个“文件”单词。

```
;; This buffer is for notes you don't want to save, and for Lisp evaluation.
;; If you want to create a file, visit that file with C-x C-f,
;; then enter the text in that file's own buffer.

Regexp I-Search %> file 
```

但是，一旦我开始编辑文件，突出显示就会消失。我想保持高亮显示一段时间——直到我运行另一个命令将其关闭。我怎么能这样做？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-04T15:36:49.663

如果将变量设置`lazy-highlight-cleanup`为`nil`，则突出显示将一直保留到下一次搜索：

```
(setq lazy-highlight-cleanup nil) 
```

或者，直到您手动调用`M-x lazy-highlight-cleanup`.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-04T15:30:19.370

您正在寻找`highlight-regexp`绑定到`M-s h r`. `M-s h u`不突出。

[highlight-symbol](http://nschum.de/src/emacs/highlight-symbol/)提供了一个很好的包装。

# php - PHPDOCX 中的中心表

> ID：10014099
> 
> 赞同：0
> 
> 时间：2012-04-04T15:16:33.180
> 
> 标签：php, ms-word, phpdocx

我正在使用[PHPDocx](http://www.phpdocx.com/)（免费版）在 PHP 中动态创建一个 msword 文档。

我无法让表格在页面中居中对齐。我已尝试按照[文档](http://www.phpdocx.com/documentation/api-documentation/insert_table_word_document)中的说明传递样式参数，但没有任何乐趣。

有想法该怎么解决这个吗？

我当前的代码是；

```
$docx = new CreateDocx();

$valuesTable = array(
    array(
        11,
        12
    ),
    array(
        21,
        22
    ),
);

$paramsTable = array(
    'jc' => 'center',
    'border' => 'single',
    'border_sz' => 20
);

$docx->addTable($valuesTable, $paramsTable);

$docx->createDocx('example_table'); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-28T15:15:47.327

我有同样的问题。如果您查看 CreateTable 源代码，您会发现从未调用过用于对齐 generateJC() 的方法，因此传递“jc”参数没有效果（大多数选项都是如此）。

您可以覆盖它创建一个新类，如：

```
class SmCreateTable extends CreateTable{
    public function createTable()
    {
        $this->_xml = '';
        $args = func_get_args();

        if (is_array($args[0])) {
            $this->generateTBL();
            $this->generateTBLPR();

            if(!empty($args[1]['jc'])){
                $this->generateJC($args[1]['jc']);
            }

            $this->generateTBLW();
            if (!empty($args[1]['border'])) {
                $this->generateTBLBORDERS();
                $this->generateTBLBOTTOM();
                $this->generateTBLLEFT();
                $this->generateTBLTOP();
                $this->generateTBLRIGHT();
                $this->generateTBLINSIDEH();
                $this->generateTBLINSIDEV();
            }

            $this->generateTBLLOOK();
            $this->generateTBLOVERLAP();
            $intLine = 0;
            foreach ($args[0] as $datDepth) {
                $this->generateTR();
                $intLine++;
                foreach ($datDepth as $cont) {
                    $this->generateTC();
                    $this->generateP();
                    $this->generateR();
                    if ($args[1]['font'] != '') {
                        $this->generateRPR();
                        $this->generateRFONTS($args[1]['font']);
                    }
                    $this->generateT($cont);
                }
                $this->cleanTemplateR();
            }
        }
    }

    private function cleanTemplateR()
    {
        $this->_xml = preg_replace('/__GENERATETR__/', '', $this->_xml);
    }
} 
```

然后调用：

```
$table = new SmCreateTable();
$table->createTable($valuesTable, $paramsTable); 
```

# iphone - 带有多个孩子的 Cocos2d CCSprite 动画

> ID：10014104
> 
> 赞同：1
> 
> 时间：2012-04-04T15:16:50.460
> 
> 标签：iphone, animation, cocos2d-iphone, ccsprite

这个问题纯粹是概念性的，因为我还没有创建我所指的精灵表。如果您有针对我的问题的不同方法的建议，我将不胜感激。

我在脑海中创建的精灵表包含一组不同的人体、发型、衬衫、裤子、鞋子等。这个想法是用户将在运行时选择与他们的播放器一起使用的服装以及每一件小时候，衣服会被添加到 CCSprite 中。

问题：这些玩家需要动画，例如当玩家四处走动时。我曾计划为每个可能的动画帧将每个服装项目添加到精灵表中的单独图像。在创建玩家移动所需的 CCAnimation 对象时，如何创建一个 CCSpriteFrame 以添加到包含所有必要的自定义服装项目以匹配原始 CCSprite 的动画？如果您有其他可以解决我的问题的建议，我很乐意听到。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T05:38:38.607

嗨，这是一个奇怪的问题，这样做会很有趣。根据我对 Cocos2d 的理解，我会为所有部分学习不同的课程。就像我的身体分为 3 个部分（头、身体和腿）。我会为它们创建不同的自定义类，它们是 CCSprite 的子类，并为它们的每种类型保留枚举和动画。在 GameScene 中，将不同的对象作为主要 Sprite 的子对象，并同步动画。希望这可以帮助。:)

# c# - 创建与 javascript 函数一起使用的 ActionLink

> ID：10014111
> 
> 赞同：2
> 
> 时间：2012-04-04T15:17:27.147
> 
> 标签：c#, javascript, asp.net-mvc

我有一个数据表，在该数据表上我设置了一个 Html.ActionLink。当我单击该操作链接时，我想将项目的 id 发送到 javascript 函数，并在下面显示一个新的数据表，其所有内容都属于上面数据表中的选定项目。因此，例如，如果我单击表中的学生姓名，我希望所有学生的成绩和测试都显示在下面的单独数据表中。我从来没有使用过javascript，所以我不确定我该怎么做。如果有人可以指出我正确的方向或提供一些提示，我将不胜感激。

原始第一个数据表：

```
@foreach (var item in ((List<Epic>) ViewData["selectedestimate"]))
{
    <tr>
        <td>
            @*   @Html.ActionLink(@item.Name, "action", "controller", new {id = item})*@

            <a href="#" onclick="StoryClick(@item.Id);">@item.Name</a>
        </td> 
```

Javascript 调用：

```
<script type="text/javascript">
function StoryClick(story) {
    $.get("@Url.Action("action", "controller")", function (response) {
        $('#stories').accordion({ collapsible: true });
    });
}
</script> 
```

动作控制器：

```
public List<EpicDetails> getEpicDetails(int id)
{
    return eRepository.getItemsById(id).tolist();
} 
```

还是我需要一个 ActionResult？

```
public Actionresult Details(int id)
{

} 
```

我意识到我现在还没有接近，但它只是 b/c 我不确定要采取什么步骤来做到这一点。最终我会制作一架手风琴并将桌子放在手风琴中。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-04T15:42:42.420

`<a>`在这种情况下，我喜欢实际保留`ActionLink`生成，只需添加 JavaScript 以增强链接的行为。所以您的视图不会真正改变（我确实添加了一个类，以便我们稍后可以将事件处理程序绑定到它）：

```
@Html.ActionLink(@item.Name, "action", "controller", new {id = item, @class = "item-link" }) 
```

然后编写一些 jQuery（看起来你已经依赖于 jQuery。如果没有，我可以修改答案以使用 vanilla JavaScript）将事件处理程序绑定到与 class 的链接`item-link`：

```
<script type="text/javascript">
    $(document).ready(function () {
        $("a.item-link").click(function (event) {
            event.preventDefault(); // Stop the browser from redirecting as it normally would
            $.get(this.href, function (response) {
                // Do whatever you want with the data.
            });
        });
    });
</script> 
```

而且，是的，您在控制器中的操作方法应该返回一个`ActionResult`. 在不知道你想在客户端使用什么类型的数据的情况下，我很难说`ActionResult`你应该返回什么类型，但是如果你想将 HTML 注入页面，你可以这样写：

```
public ActionResult Details(int id)
{
    var itemDetails = /* Get details about the item */;
    return PartialView("Details", itemDetails);
} 
```

然后在你的 JavaScript 中你会写：

```
$("a.item-link").click(function (event) {
    event.preventDefault(); // Stop the browser from redirecting as it normally would
    $.get(this.href, function (response) {
        $("element_to_populate").html(response);
    });
}); 
```

Where`element_to_populate`将是一个选择器，它指向您要注入 HTML 的位置。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-04T16:00:11.177

我强烈建议在客户端使用 javascript 模板（我更喜欢[handlebars.js](http://handlebarsjs.com/)）并将您的学生数据作为 JsonResult 返回。这将使您的带宽使用量降至最低。

但是，因为您似乎更喜欢剃须刀，所以您可以将它用于所有模板，从控制器/视图返回纯 html，然后改用这个 javascript

```
<script type="text/javascript">
$(function() {
    $("a.item-link").click(function (event) {
        event.preventDefault(); // Stop the browser from redirecting as it normally would
        $("#gradesContainer").load(this.href, function (response) {
            //Do whatever you want, but load will already have filled up 
            //#gradesContainer with the html returned from your grades view
        });
    });
});
</script> 
```

在您的主页中，在学生列表下方，您只需添加

```
<div id="gradesContainer"></div> 
```

你的另一个控制器看起来像这样

```
public ActionResult TestGrades(int id) {
    var model = getTestGradesModel(id);
    return View(model);
} 
```

如果您为客户端 javascript 模板返回 JSON，它看起来像

```
public ActionResult TestGrades(int id) {
    var model = getTestGradesModel(id);
    return new JsonResult() {Data = model}; //no view here!
} 
```

# c# - 使用 WCF 数据服务进行全文搜索

> ID：10014115
> 
> 赞同：1
> 
> 时间：2012-04-04T15:17:38.277
> 
> 标签：c#, .net, entity-framework, entity-framework-4.1, wcf-data-services

是否可以使用实体框架作为后备源将全文搜索与 WCF 数据服务一起使用？

我目前的方法是有一个单独的 WCF Web 服务方法，该方法执行全文搜索并返回键列表然后匹配，但这意味着必须从 WCF 服务检索数据，然后再上传回服务器匹配键。

有没有更好的方法来做到这一点？

我看过： http: [//manfred-ramoser.blogspot.co.uk/2009/09/full-text-search-for-entity-framework.html](http://manfred-ramoser.blogspot.co.uk/2009/09/full-text-search-for-entity-framework.html)但它似乎不适用于 WCF 数据服务环境。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-04T19:04:04.323

在WCF中实现全文搜索请参考以下链接：

[http://code.msdn.microsoft.com/windowsazure/Azure-Library-for-83562538](http://code.msdn.microsoft.com/windowsazure/Azure-Library-for-83562538)

# algorithm - 将一个序列划分为最多 K 个大小的连续集合

> ID：10014116
> 
> 赞同：0
> 
> 时间：2012-04-04T15:17:38.623
> 
> 标签：algorithm

将 N 个数的序列划分为最大为 K 的连续集合，使得没有两个集合是彼此相邻的（即，两个集合之间至少有一个数字）以及所有集合中所有元素的总和集得到最大化。

例如，如果序列是 1,2,3,4,5。我们可以将其分为集合 (1,2) 和 (4,5)，因为 3 在它们之间，但不能分为集合 (2,3) 和 (4,5)。

我已经完成了这个 O(NK)。请提出更好的算法。

我已经使用了带有回溯的动态编程。我的代码是：

```
#include<cstdio>
using namespace std;

long long int max(long long int a,long long int b){
     if(a>b) return a;
     else return b;
}

int main(){
    int n,k;
    int p[100000];
    long long int v[100001];
    scanf("%d %d",&n,&k);
    int i,j;
    for(i=0;i<n;i++)
        scanf("%d",&p[i]);  
    v[0]=0;
    v[1]=p[n-1];
    int l=1;
    for(i=n-2;i>-1;i--){
        long long int temp=v[l];
        l=(n-i)>k?k:(n-i);
        int m=(k-i)>1?(k-i):1;
        for(j=l;j>=m;j--)
            v[j]=max(p[i]+v[j-1],temp);
        v[0]=temp;
    }
    printf("%lld\n",v[k]);
    return 0;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-04T16:59:14.203

既然这听起来像家庭作业，我只会给你一个线索。使用具有函数的动态规划： F(x,i,k) 其中 x 是序列，您正在考虑前 i 个元素，k 是不相交子序列的数量。

# jquery - Uploadify IO 错误 2038 用于大图像

> ID：10014119
> 
> 赞同：1
> 
> 时间：2012-04-04T15:17:42.520
> 
> 标签：jquery, uploadify

我正在使用 jquery Uploadify 在我的应用程序中上传图像。它早些时候工作正常，但在最近几天我收到报告说某些图像没有上传，它给出了“IO 错误”。

在我的分析中，我发现当我尝试上传大于 100 - 120 kb 的图像时会导致问题。

早些时候它工作正常并上传更大的图像，但现在它突然停止了更大的图像。

我一次上传一张图片有什么帮助吗？

# mercurial - hg 自动与 diff3 合并

> ID：10014124
> 
> 赞同：1
> 
> 时间：2012-04-04T15:18:12.243
> 
> 标签：mercurial, merge, diff3

考虑一个具有两个中心分支/克隆的 Hg 项目 - 例如 DEV 和 PRD。当有人将修补程序推送到 PRD 时，中央服务器上的自动脚本会转到 DEV 并提取新更改。然后它会尝试将修补程序合并到 DEV 中。

问题是集成到 Hg 中的合并工具很糟糕——一旦对同一个文件进行并行更改，它就会失败。举个例子：

```
parent:3,7c
 four
 five
 six

 seven

child1:3,7c
 four
 five5
 six6

 seven7

child2:3,7c
 fourmore
 five
 six
 more
 seven 
```

如您所见，这里没有实际的冲突。如果我们在本地使用 kdiff 进行合并，它可以解决这个简单的情况而无需用户输入！

我想要一种让中央服务器来管理这些案例的方法。我想过在静默模式下使用 kdiff3，但我无法在其上安装 kdiff3（这是一个仅 CLI 的系统，我们甚至没有管理员访问权限），但也许有一种方法可以将 diff3 插入 hg merge 所以它可以解决这样的简单案例吗？我尝试在 hgrc 中设置“[ui] /n merge = diff3”，但它只是将三个版本吐出到标准输出。我错过了一些额外的配置吗？还是有更简单/更好的工具？

非常感谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-12T16:07:29.137

要`diff3`用作合并工具，您需要添加

```
[merge-tools]
diff3.args = $local $base $other -m > $output 
```

到你的配置文件。如果需要，您可以设置优先级，请参阅[wiki](http://mercurial.selenic.com/wiki/MergeToolConfiguration)。您还可以找到更复杂[的](http://mercurial.selenic.com/wiki/MergingManuallyInEditor)[使用方法`diff3`](http://mercurial.selenic.com/wiki/MergingManuallyInEditor)。

但是，我测试了如何`diff3`通过编辑相邻行来处理您的场景，就像 Mercurial 一样，它也拒绝干净地合并它。不同的合并工具对于他们认为的“冲突”有不同的阈值，似乎 KDiff3 比 Mercurial 和`diff3`.

我建议您让制作修补程序的开发人员`PRD`负责将其合并到`DEV`本地，在那里他可以访问 KDiff3 等工具。服务器上的自动合并通常被认为是不好的——在你提交合并之前，应该由人工稍微验证一下。进行修补程序后，这并没有太多额外的工作。

# c# - 在 Windows 服务中使用计时器

> ID：10014126
> 
> 赞同：1
> 
> 时间：2012-04-04T15:18:16.783
> 
> 标签：c#, multithreading, windows-services, timer

我想在应该以恒定间隔执行操作的 Windows 服务中使用计时器而不是睡眠。

可以说我有以下课程。

```
class MailManagerClient
{

    //fields
    string someString

    //Constructor
    public MailManagerClient()
    { 
          aTimer = new System.Timers.Timer(30000);
          aTimer.Elapsed += new ElapsedEventHandler(OnTimedEvent);
          aTimer.Enabled = true
    }
    //methode

    public bool DoSomthingIncConstantInterval()
    {
        //Do Somthing
        return true;
    }

    private static void OnTimedEvent(object source, ElapsedEventArgs e)
    {
       DoSomthingIncConstantInterval()
    }
} 
```

而且我也有一个带有该`OnStart`方法的Windows服务。

我知道在`OnStart`方法中我需要为 type 启动一个新线程`MailManagerClient`。

但是我该如何启动线程呢？哪个方法应该是新线程的入口点？

线程应该如何保持活力？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-04T15:41:51.920

在 OnStart 方法中，您可以拥有 -

```
MailManagerClient m;
var th = new Thread(()=>m=new MailManagerClient());
th.Start(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-04T15:42:19.847

因为您在构造函数中启动计时器，所以您真正需要做的就是实例化 a `MailManagerClient`in `OnStart`。您不需要手动创建线程，因为`System.Timers.Timer`在.`Elapsed``ThreadPool`

```
public class MyService : ServiceBase
{
  private MailManagerClient mmc = null;

  protected void OnStart(string[] args)
  {
    mmc = new MailManagerClient();
  }

} 
```

我应该指出，对于下一个查看`MailManagerClient.ctor`实际上正在执行任何操作的代码的程序员来说，这并不明显。最好定义一个`Start`方法或类似的东西来启用内部计时器。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-04T16:59:45.410

您也可以考虑定义一个 Windows 任务，如这个 SO 答案中所述：[什么是 Windows 版本的 cron？](https://stackoverflow.com/questions/132971/what-is-the-windows-version-of-cron). Windows 操作系统将负责调度和线程。

# php - Twitter 类型从数据库加载数据

> ID：10014129
> 
> 赞同：0
> 
> 时间：2012-04-04T15:18:29.720
> 
> 标签：php, ajax

所以基本上我需要类似于 twitter 的东西——当用户向下滚动到页面底部时，数据库中的新信息会自动加载。任何建议如何创建它或任何示例？我知道它可以用 AJAX 来完成，但是你能举一个例子，或者一个示例代码吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-04T15:25:20.950

它被称为无限滚动（或[无尽滚动](http://uipatternfactory.com/p=endless-scrolling/)）。我认为最普遍的解决方案是使用 Paul Irish 的[Infinite Scroll jQuery plugin](http://www.infinite-scroll.com/infinite-scroll-jquery-plugin/)。[此外，您可以在无限滚动](http://www.infinite-scroll.com)页面中找到相关信息、文档和演示。

# google-app-engine - 为什么不对所有对 Rest API 的请求只使用一个 HttpServlet

> ID：10014130
> 
> 赞同：0
> 
> 时间：2012-04-04T15:18:35.047
> 
> 标签：google-app-engine, jakarta-ee, rest, servlets

假设我有一个可以通过例如访问的 Rest API：mypage.com/v1/users/1234 我正在使用 Java EE 和 HttpServlets 作为这个 api。

将所有 v1 请求发送到单个 servlet，然后将其传递给我自己的结构以更加独立并且以后可能更容易地从 HttpServlets 切换到其他东西，这是一个好主意吗？或者更好地为所有类型的资源创建和注册一个 servlet，一个用于 mypage.com/v1/users，一个用于 mypage.com/v1/cars，依此类推

只使用一个 servlet 会慢得多，还是效率低下，或者只是不方便？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-04T15:36:08.900

维护将很快变得非常困难。看看 Jersey 或 Resteasy。学习曲线很小，而且 jax-rs 可以处理您必须在 vanilla servlet 中编写的大量样板代码。

# android - Android地图视图上的实时流量

> ID：10014131
> 
> 赞同：0
> 
> 时间：2012-04-04T15:18:35.520
> 
> 标签：android, google-maps, android-mapview

我正在开发一个带有地图视图的应用程序。[我已经从http://developer.android.com/resources/tutorials/views/hello-mapview.html](http://developer.android.com/resources/tutorials/views/hello-mapview.html)实现了地图视图引用的覆盖 ，效果很好。现在，我想显示 Google 显示的实时流量。我还设置了`mapView.setTraffic(true);`我的应用程序显示的地图视图属性，如下所示，

![在此处输入图像描述](../Images/0a1bdc75b8c75d6911f3415b07660f76.png)

是要做所有的事情还是可以像下面这样显示

![在此处输入图像描述](../Images/4e1473f42ae0228268135b282919cf0e.png)

我正在寻找一些关于此的示例、链接或教程。请指导我。

提前致谢...

华丽的

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-04T15:54:19.043

第二张图片是所谓的“街景”。谷歌确实有一个 API，但你仅限于~~每位观众 1000~~谷歌的配额和它只是一张图片，所以不会出现在 Android 地图视图中。

请参阅此处：[https](https://developers.google.com/maps/documentation/streetview/) ://developers.google.com/maps/documentation/streetview/了解更多详情。

# iphone - 解码 URLEncoded 非标准字符

> ID：10014136
> 
> 赞同：1
> 
> 时间：2012-04-04T15:18:50.793
> 
> 标签：iphone, objective-c, ios, urlencode

我正在尝试解码从 URLEncoded 的服务器发送的一些文本，这是我设法找到的最佳方法。

我将这些标准函数用于 URLEncododing：

```
NSString* encodeToPercentEscapeString(NSString *string) {
    return (__bridge NSString *)
    CFURLCreateStringByAddingPercentEscapes(NULL,
                                        (__bridge CFStringRef) string,
                                        NULL,
                                        (CFStringRef) @"!*'();:@&=+$,/?%#[]",
                                        kCFStringEncodingUTF8);
}

NSString* decodeFromPercentEscapeString(NSString *string) {
    return (__bridge NSString *)
    CFURLCreateStringByReplacingPercentEscapesUsingEncoding(NULL,
                                                        (__bridge CFStringRef) string,
                                                        CFSTR(""),
                                                        kCFStringEncodingUTF8);
} 
```

如果我对特殊字符进行编码：

```
NSString* encoded = encodeToPercentEscapeString(@"ąśżźćęółń"); 
```

我得到@"%C4%85%C5%9B%C5%BC%C5%BA%C4%87%C4%99%C3%B3%C5%82%C5%84"

没关系。

但如果我尝试解码它：

```
NSString* original = decodeFromPercentEscapeString(encoded); 
```

我得到：@“ńÖŇõŇľŇļńáńô√≥ŇāŇĄ”。

为什么？

有没有更好的方法来解码 URLEncoded 文本？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-04T15:47:42.370

你试过`-[NSString stringByReplacingPercentEscapesUsingEncoding:]`吗？

此外，您使用的桥接演员阵容不正确。创建的字符串会泄漏，因为 ARC 不知道它拥有它们。使用 CFBridgingRelease()。这很好，因为它是 CFRelease() 的变体，通常是平衡核心基础“创建”功能所必需的，但它与 ARC 合作。

# c# - 如何在 WPF 中使用绑定验证文本框，在无效输入后切换回最后一个有效值？

> ID：10014140
> 
> 赞同：5
> 
> 时间：2012-04-04T15:19:10.347
> 
> 标签：c#, wpf, validation, binding, mvvm

在`WPF`中，我想制作一个`TextBox`验证用户输入以仅允许解析为双精度的输入。当框失去焦点（和`Binding`更新）时，如果用户输入了无效输入，我希望框切换回之前的状态。

这似乎应该很简单，但我无法让它工作。无论我尝试了什么，`TextBox`都会继续显示用户输入的无效字符串，即使该属性正在正确验证输入并且除非有效否则不会保存。我觉得在解析失败时通知属性更改应该会导致`TextBox`重置为旧值，但事实并非如此。

我的视图模型有一个属性：

```
private double _doubleDisplayValue;
public string DoubleDisplayValue
{
    get { return _doubleDisplayValue.ToString(); }
    set
    {
        double result;
        bool success = double.TryParse(value, out result);
        if(success)
        {
            if(_doubleDisplayValue != result)
            {
                _doubleDisplayValue = result;
                NotifyPropertyChanged("DoubleDisplayValue");
            }
        }
        else
        {
            // I feel like notifying property changed here should make the TextBox
            // update back to the old value (still in the backing variable), but
            // it just keeps whatever invalid string the user entered.
            NotifyPropertyChanged("DoubleDisplayValue");
        }
    }   
} 
```

我设置了我的`TextBox`（我在后面的代码中工作）：

```
// . . .
TextBox textBox = new TextBox();
Binding b = new Binding("DoubleDisplayValue");
b.Mode = BindingMode.TwoWay;
// assume the DataContext is properly set so the Binding has the right source
textBox.SetBinding(TextBox.TextProperty, b);
// . . . 
```

我也尝试过将属性修改为此，但它仍然不起作用：

```
private double _doubleDisplayValue;
public string DoubleDisplayValue
{
    get { return _doubleDisplayValue.ToString(); }
    set
    {
        double result;
        bool success = double.TryParse(value, out result);
        if(success)
        {
            // got rid of the if
            _doubleDisplayValue = result;
            NotifyPropertyChanged("DoubleDisplayValue");                
        }
        else
        {
            // Figured maybe I need to retrigger the setter
            DoubleDisplayValue = _doubleDisplayValue;
        }
    }   
} 
```

实现我的目标的最佳方式是什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-04T15:42:37.083

如果您真的想重置 TextBox 中显示的值，您必须在 DoubleDisplayValue 的 setter else 中执行以下操作：

```
Application.Current.Dispatcher.BeginInvoke(new Action(() =>
    {
        _doubleDisplayValue = originalValue;
        NotifyPropertyChanged("DoubleDisplayValue");
    }), DispatcherPriority.ContextIdle, null); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-04T15:27:36.410

我会使用框架的绑定验证系统（请参阅[如何实现绑定验证](http://msdn.microsoft.com/en-us/library/ms753962.aspx)）。

当用户键入无效的内容时，最好将无效输入留在控件中，以便用户可以将其编辑为有效的内容。这比强迫他们从头开始重新输入数据更加用户友好。

例如，如果值为 0.0，并且用户键入“4.252w35326”，我们是否应该强制用户再次键入“4.25235326”，而不是简单地删除“w”？

# php - 通过 Drush 运行时 Cron 失败，并调用 node_load()

> ID：10014142
> 
> 赞同：3
> 
> 时间：2012-04-04T15:19:14.450
> 
> 标签：php, drupal, drupal-6, drush

我有一个 Drupal 6 站点，并且我有一个自定义模块，可以在运行 cron 时在某些节点上执行一些维护操作。

我的代码非常简单：

```
function mymodule_cron() {
  // get all the nodes that need maintenance
  $result = db_query("SELECT * FROM {mymodule_nodes}");

  while ($row = db_fetch_object($result)) {
    // load the node
    $node = node_load($row->nid); // Causes Drush Error

    // Perform Maintenance Tasks
  }
} 
```

问题是，当我使用 drush core-cron 运行 cron 时，它失败并显示：“drush command 由于不可恢复的错误而异常终止”

使用一些基本的调试技巧，我将问题追溯到 node_load 调用。为什么以这种方式在 cron 中调用 node_load 会导致 drush core-cron 失败？

```
-sh-4.1$ drush status
 Drupal version         :  6.17
 Database               :  Connected
 Drupal bootstrap       :  Successful
 Drush version          :  4.5
 Drush configuration    :
 Drush alias files      :
-sh-4.1$ php -v
PHP 5.3.6 (cli) (built: Mar 17 2011 20:56:13)
Copyright (c) 1997-2011 The PHP Group
Zend Engine v2.3.0, Copyright (c) 1998-2011 Zend Technologies
-sh-4.1$ httpd -v
Server version: Apache/2.2.17 (Unix)
Server built:   Oct 27 2010 10:04:21 
```

从 Web 界面运行 Cron 作业可以正常工作而不会出错。这个问题似乎与 drush 相关。

我检查了看门狗，每当我尝试从 drush 运行它时，看门狗都会在 cron 类型下显示一条新消息，说“Cron 运行超出了时间限制，并且已中止”。奇怪的是，从 CLI 中按回车后，我几乎立即收到错误消息，而在我当前的实现中，我只是尝试调试 node_load，所以我的维护任务被注释掉了。我只是想将列表中第一个的节点标题转储到屏幕上，然后返回 true，所以它应该只循环一次。

之所以会出现这样的问题，是因为我们能够让 cron 从 crond 运行的唯一方法是使用 drush。但是如果 drush 不能执行这个命令，那我就陷入了僵局。

即使使用 Drush 5 也不能解决问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-22T03:27:50.877

您是否启用了 PHP 过滤器模块？我敢打赌有人在你的一个节点中放了一些糟糕的代码。这是永远不应该使用 php 模块的众多原因之一......

# - 延伸

> ID：10014146
> 
> 赞同：0
> 
> 时间：2012-04-04T15:19:23.157
> 
> 标签：

extends 是几种编程语言中的一个关键字，用于表示实现继承

# php - 使用准备好的语句在 MySQL 上使用 LIMIT 关键字

> ID：10014147
> 
> 赞同：23
> 
> 时间：2012-04-04T15:19:29.107
> 
> 标签：php, mysql, prepared-statement, limit

```
SELECT id, content, date
FROM comment
WHERE post = ?
ORDER BY date DESC
LIMIT ?, ? 
```

使用 PDO（我正在使用具有 Apache 2.2.21、PHP 高达 5.3.6 和 MySQL 5.5.9 的 MAMP 2.0.5）准备好的语句，如果我用

```
LIMIT 0, 10 
```

有用。

我在 MySQL 的错误中看到这是以前版本中的错误，但我不明白这是否仍有待修复。

如果这仍然是一个问题，有没有办法以另一种方式选择一系列行？

代码：

```
$comments = $db->prepare($query); 
/* where $db is the PDO object */ 
$comments->execute(array($post, $min, $max)); 
```

* * *

## 回答 #1

> 赞同：49
> 
> 时间：2012-04-04T15:22:47.017

这是问题所在：

```
$comments = $db->prepare($query); 
/* where $db is the PDO object */ 
$comments->execute(array($post, $min, $max)); 
```

[PDOStatement::execute()](http://php.net/manual/en/pdostatement.execute.php)的手册页说（强调我的）：

> **参数**
> 
> `input_parameters`一个包含与正在执行的 SQL 语句中的绑定参数一样多的元素的值数组。**所有值都被视为 PDO::PARAM_STR**。

因此，您的参数将作为字符串插入，因此最终的 SQL 代码如下所示：

```
LIMIT '0', '10' 
```

这是 MySQL 不会强制转换为数字但会触发解析错误的特殊情况：

```
mysql> SELECT 1 LIMIT 0, 10;
+---+
| 1 |
+---+
| 1 |
+---+
1 row in set (0.00 sec)

mysql> SELECT 1 LIMIT '0', '10';
ERROR 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ''0', '10'' at line 1 
```

[文档](https://dev.mysql.com/doc/refman/5.7/en/select.html#idm140469743390096)必须说什么：

> 该`LIMIT`子句可用于限制`SELECT`语句返回的行数。`LIMIT`接受一个或两个数字参数，它们都必须是非负整数常量，但以下情况除外：
> 
> *   在准备好的语句中，`LIMIT`可以使用 ? 指定参数 占位符标记。
>     
>     
> *   在存储的程序中，`LIMIT`可以使用整数值的例程参数或局部变量来指定参数。

您的选择包括：

*   一个个绑定参数，这样就可以设置类型了：

    ```
    $comments->bindParam(1, $post, PDO::PARAM_STR);
    $comments->bindParam(2, $min, PDO::PARAM_INT);
    $comments->bindParam(3, $min, PDO::PARAM_INT); 
    ```

*   不要将这些值作为参数传递：

    ```
    $query = sprintf('SELECT id, content, date
        FROM comment
        WHERE post = ?
        ORDER BY date DESC
        LIMIT %d, %d', $min, $max); 
    ```

*   禁用模拟准备（MySQL 驱动程序有一个错误/功能会使其引用数字参数）：

    ```
    $db->setAttribute(PDO::ATTR_EMULATE_PREPARES, FALSE); 
    ```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-04-04T15:23:14.770

您可以声明一个特定的属性来解决问题。

```
$dbh->setAttribute( PDO::ATTR_EMULATE_PREPARES, false ); 
```

另一个答案说明了它是如何工作的。默认情况下，PDO 仅模拟准备，并且当您静默绑定变量时，无需设置类型，PDO 默认将它们视为字符串。SQL 中的字符串必须被引用和转义——因此您的 LIMIT 子句中有引号和语法错误。而当使用本机准备好的语句时，数据库可以设法整理出适当的类型。

# android - MultiAutoCompleteTextView 不支持键盘 NEXT

> ID：10014148
> 
> 赞同：1
> 
> 时间：2012-04-04T15:19:46.613
> 
> 标签：android, android-widget, android-edittext, textview

我正在使用 MultiAutoCompleteTextView，它似乎可以与以下异常一起工作：在 MultiAutoCompleteTextView 中，点击软键盘上的“NEXT”键不会将焦点移动到下一个字段，即 EditView。这有一个已知问题吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-04T23:54:55.577

我在此处发布最终结果以供记录 - 这是在 SO 之外的“办公时间”聊天中讨论的。

罗恩的`MultiAutoCompleteTextView`样子：

```
<MultiAutoCompleteTextView  
            android:id="@+id/etCreateMessageTo"
            android:layout_width="fill_parent"
            android:layout_height="wrap_content"
            android:singleLine="true"
            android:inputType="textEmailAddress"
            android:hint=""
            android:background="@drawable/edittext_rounded_corners"
        /> 
```

他正在默认`android:imeOptions`并看到这种行为。我建议他明确添加`android:imeOptions="actionNext"`，事实证明这可以解决问题。

# powershell - 从powershell运行时出现mysqldump错误

> ID：10014149
> 
> 赞同：1
> 
> 时间：2012-04-04T15:19:47.437
> 
> 标签：powershell, scripting, mysqldump

我有一个包含以下内容的脚本...

```
$conn = "C:\Program Files\xxx xxx\xxx xxx\MySQLConfig\MySQL Server 5.0\bin\mysqldump.exe"

$sqlargs = @("--verbose", "--user=xxx", "--password=xxx", "--port=xxx", "--add-drop-database", "--routines", "--single-transaction", "--databases", "xxx")

$bak_file = "C:\backups\bak040312.sql"

$log_file = "C:\backups\logs\L040312.log"

(&$conn $sqlargs | out-file bak_file -Encoding UTF8) 2>>$log_file 
```

我已经使用 echoargs 来确定我的参数是否正确传递给了 exe

```
PS C:\scripts> echoargs $sqlargs
Arg 0 is <--verbose>
Arg 1 is <--user=xxx>
Arg 2 is <--password=xxx>
Arg 3 is <--port=xxx>
Arg 4 is <--add-drop-database>
Arg 5 is <--routines>
Arg 6 is <--single-transaction>
Arg 7 is <--databases>
Arg 8 is <xxx> 
```

备份似乎按预期运行，但是 mysqldump 在连接到 mysql 服务器后立即抛出错误。

```
mysqldump.exe : -- Connecting to localhost...
At line:1 char:3
+ (& <<<< $mysqlconn $sqlargs | out-file $bak_file -Encoding UTF8) 2>>$log_file
    + CategoryInfo          : NotSpecified: (-- Connecting to localhost...:String) [], RemoteException
    + FullyQualifiedErrorId : NativeCommandError

-- Retrieving table structure for table agentactivity...
...
...
...
...
-- Retrieving rows...
-- Disconnecting from localhost... 
```

我尝试过调用表达式而不是 &... 我不知道为什么会收到此错误。任何帮助将不胜感激。

**更新** 我的目标是在日志文件中包含来自 mysqldump 的详细输出和错误。

谢谢

# c - 进程是否可以更改自己的线程堆栈大小？

> ID：10014152
> 
> 赞同：1
> 
> 时间：2012-04-04T15:19:49.917
> 
> 标签：c, makefile, stack

在终端中，我得到了这个：

```
manu@work:ulimit -s
manu@work:8192 
```

现在在 Makefile 中，我有

```
test:
echo `ulimit -s` 
```

在同一终端中运行 make 给出：

```
manu@work:make test
manu@work:unlimited 
```

为什么 ？make 进程是否改变了它自己的线程堆栈大小？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-04T15:25:24.457

`setrlimit(R_LIMIT_STACK, ...);`或者，Linux 还提供了`prlimit`which 可以充当`getlimit`、`setrlimit`或两者。

# php - shell_exec() 语句到 pdftotext 整个目录？

> ID：10014153
> 
> 赞同：0
> 
> 时间：2012-04-04T15:20:04.073
> 
> 标签：php, foreach, pdftotext

我不知道如何`pdftotext`通过`shell_exec()`语句为整个目录构建循环。

就像是 ：

```
$pdfs = glob("*.pdf");

foreach($pdfs as $pdfs) {
    shell_exec('pdftotext '.$pdfs.' '.$pdfs'.txt');
} 
```

但我不确定如何在第二次调用`$pdfs`我的`shell_exec()`声明时删除 .pdf 扩展名并将其替换为`.txt`

也不确定这个循环是否正确......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-04T15:24:46.923

```
$pdfs = glob("*.pdf");

$fmt='/path/to/pdftotext "%s" "%s.txt"';

foreach($pdfs as $thispdf) {
    shell_exec(sprintf($fmt, $thispdf, basename($thispdf, ".pdf")));
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-04T15:25:00.577

尝试

```
foreach(glob("*.pdf") as $src) {

  // Manually remove file extension because glob() may return a dir path component
  $parts = explode('.', $src);
  $parts[count($parts) - 1] = 'txt';
  $dest = implode('.', $parts);

  // Escape shell arguments, just in case
  shell_exec('pdftotext '.escapeshellarg($src).' '.escapeshellarg($dest));

} 
```

基本上，循环目录中的 PDF 文件并为每个文件执行命令，仅使用文件名的名称部分~~（用 提取[`pathinfo()`](http://php.net/manual/en/function.pathinfo.php)）~~^(查看)输出文件的编辑（因此`test.pdf`变为`test.txt`）。

`glob()`直接使用 in的结果可以`foreach`轻松避免上面代码中的变量命名冲突。

**编辑**

我已更改上述代码以在生成输出文件名时手动删除文件扩展名。这是因为`glob()`可能会返回路径字符串的目录组件，以及文件名。使用`pathinfo()`or`basename()`将删除它，并且由于我们知道`.`文件名中将出现 a （传递给的规则`glob()`规定了这一点），我们可以安全地删除最后一个之后的所有内容。我还添加`escapeshellarg()`了一个很好的措施 - 已经存在的文件名极不可能（如果不是不可能的话）会违反这一点，但最好是安全的。

# windows - 如何测试我的 DNS 和站点配置

> ID：10014158
> 
> 赞同：1
> 
> 时间：2012-04-04T15:20:16.517
> 
> 标签：windows, webserver, dns

我收到了一些来自我网站用户的消息，他们无法在家中访问它。

他们可以通过 IP 访问服务器，但不能通过域名访问。

我认为这与我的 DNS 配置方式有关。大约 4 年前，我在我的服务器上设置了自己的 DNS 服务器，我可能不应该这样做，而且我不确定一切是否配置正确。有很多人可以毫无问题地访问该站点，但有些用户会得到“找不到服务器”。

服务器详细信息：Windows 2003 服务器位于一家小型本地托管公司。

是否有可以测试和提供配置建议的好工具或网站？当它对我和许多其他用户都很好时，我如何测试这个问题？我应该向无法访问该网站的用户询问哪些类型的问题？

如果第一台服务器不工作，我可以提供/指向另一个可以使用的 DNS 服务器吗？

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-04T15:35:08.100

不过这里有一些指示：

您可以向用户提出的问题：

1.  运行以下命令：`nslookup test.company.com`. 结果应该是他们可以通过IP访问的IP。如果它是错误的 IP 或没有 IP，则此主机名`A`/`CNAME`记录不会正确传播到外部世界。

2.  可能是 ipv4/v6 问题。也许 DNS 通过记录解析为 ipv6 IP，`AAAA`而您的 ISP（或介于两者之间的任何提供商）尚未正确支持 ipv6。在 Windows 下，您可以`ping -6`或`ping -4`查看它是否可以解决任何问题。

可能的解决方法：

告诉您的用户将您的服务器的 IP 硬编码到他们的 HOSTS 文件中......

不过，DNS 问题通常出在公司基础设施上（例如，没有正确传播 DNS 通知、注册商的 DNS 服务器错误、DNS 服务器上的 DNS 配置错误……）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-04T17:19:51.827

有一个很好的在线资源来验证您的 DNS 设置： intoDNS.com

如果您认为问题出在您的 DNS 服务器上，并且您不需要这种方式，您可以将您的 DNS 转换为任何 DNS 托管 - 请参阅我的[偏见列表](http://talkdns.info)。使用任何 DNS 提供商从头开始设置您的 DNS 记录，并告诉您的域注册商使用该提供商的名称服务器。通常，注册商自己也提供 DNS 服务器。

至于要问用户的问题，Khoi 解释了一切。

# python - Python 类型为字符串

> ID：10014160
> 
> 赞同：1
> 
> 时间：2012-04-04T15:20:19.473
> 
> 标签：python

我正在尝试显示一个提供给定变量类型的字符串。

当我尝试以下操作时：

```
'This is a '+str(type(somevariable)) 
```

输出是`"This is a <type 'float'>"`, 而不是`"This is a float"`.

如何获得我想要的输出？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-04T15:21:47.217

```
'This is a ' + type(somevariable).__name__ 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-04T15:21:43.800

```
somevariable.__class__.__name__ 
```

是一种方式。

# http - 将一个资源附加到另一个资源的 RESTful 方式是什么？

> ID：10014161
> 
> 赞同：3
> 
> 时间：2012-04-04T15:20:20.657
> 
> 标签：http, rest, nosql

这是我在这个地方找不到相同问题的少数时刻之一，所以我试图描述我的问题并希望得到一些帮助和想法！

**比方说...**

我想为域模型设计一个 RESTful API，它可能具有如下实体/资源：

```
class Product
{
    String id;
    String name;
    Price price;
    Set<Tag> tags;
}

class Price
{
    String id;
    String currency;
    float amount;
}

class Tag
{
    String id;
    String name;
} 
```

API 可能如下所示：

```
GET /products
GET /products/<product-id>
PUT /prices/<price-id>?currency=EUR&amount=12.34
PATCH /products/<product-id>?name=updateOnlyName 
```

在更新参考文献时：

```
PATCH /products/<product-id>?price=<price-id>
PATCH /products/<product-id>?price= 
```

可以将产品的价格参考设置为另一个现有价格，或删除此参考。

但是如何将现有标签的新引用添加到产品中？

如果我想将该引用存储在关系数据库中，我需要一个用于多对多关系的关系表“products_tags”，这为我们带来了一个明确的解决方案：

```
POST /product_tags [product: <product-id>, tag: <tag-id>] 
```

但是基于文档的 NoSQL 数据库（如 MongoDB）可以将其存储为每个产品的一对多关系，因此我不需要为必须创建以保存关系的“新资源”建模。

但

```
POST /products/<product-id>/tags/ [name: ...]
    creates a new Tag (in a Product),

PUT /products/<product-id>/tags/<tag-id>?name=
    creates a new Tag with <tag-id> or replaces an existing 
    Tag with the same id (in a Product),

PATCH /products/<product-id>?tags=<tag-id>
    sets the Tag-list and doesn't add a new Tag, and

PATCH /products/<product-id>/tags/<tag-id>?name=... 
    sets a certain attribute of a Tag. 
```

所以我可能想说一些链接这个：

```
ATTACH /products/<product-id>?tags=<tag-id>
ATTACH /products/<product-id>/tags?tag=<tag-id> 
```

**所以重点是：**

我不想创建新资源，

我不想设置资源的属性，但是

我想将资源添加到另一个资源属性，这是一个集合。^^

**由于一切都与资源有关，因此可以说：**

我想将资源附加到另一个资源。

我的问题：**哪种方法是正确的，URL 应该是什么样子？**

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-05T10:36:16.063

您的 REST 是应用程序状态驱动程序，并非旨在反映您的实体关系。

因此，在 REST 中没有“如果数据库中是这种情况”。也就是说，你有很好的 URI。

你谈论身份证。什么是标签？标签不是一个简单的字符串吗？为什么它有一个id？为什么它的 id 不是它的名称字符串？

为什么没有`PUT /products/<product-id>/tags/tag_name=`？

PUT 是幂等的，因此您基本上是在断言`product-id`. 如果您多次发送此请求，您将获得`201 Created`第一次和`200 OK`下一次。

### 如果您正在构建一个简单的系统，其中单个并发用户在单个 Web 服务器上运行，请求中没有并发，您现在可能会停止阅读

如果中间有人删除了该标签，您的下一个 put 请求将重新创建该标签。这是你想要的吗？

使用乐观并发控制，您将每次传递文档的 ETag **a**`409 Conflict` ，如果您在服务器上有更新的版本**b**并且 diff`a..b`无法协调，则返回。在标签的情况下，您只是使用 PUT 和 DELETE 动词；所以你不必区分/查看和解。

### 如果你正在构建一个中等先进的并发系统，具有先写者获胜的语义，在单个服务器上运行，你现在可以停止阅读

也就是说，我认为您没有考虑过您的交易边界。你在修改什么？资源？**不**，您正在修改`product`资源的值对象；它的标签。那么，根据您的资源模型，您应该使用`PATCH`. 你关心并发吗？那么，关于 PATCH，您还有更多需要考虑的事情：

*   您如何表示[分层](https://stackoverflow.com/questions/8108666/jquery-javascript-json-object-comparison)[JSON](https://stackoverflow.com/questions/2253750/compare-two-json-objects-in-java)[对象](http://ajaxian.com/archives/json-diff-released)的[差异](https://stackoverflow.com/questions/1200562/difference-in-json-objects-using-javascript-jquery)[？](https://www.google.com/search?hl=en&q=diff%20json%20object&aq=f&aqi=)
*   您如何知道哪些 PATCH 请求以[语义方式](http://scholar.google.com/scholar?q=semantic%20data%20conflict%20resolution&hl=en&as_sdt=0&as_vis=1&oi=scholart&sa=X&ei=53R9T9t9o4TiBMnS8ZAN&ved=0CCoQgQMwAA)[发生冲突](http://pl.atyp.us/wordpress/index.php/2010/03/conflict-resolution/)- 即我们可能不关心标签上的 DELETE，但其他两个属性可能会在语义上[交互](http://www.cis.upenn.edu/%7Ezives/research/recon.pdf)。

HTTP PATCH 的 RFC 是这样说的：

> 然而，对于 PATCH，封闭的实体包含一组指令，描述如何**修改当前驻留在源服务器上的资源以生成新版本**。PATCH 方法会影响 Request-URI 标识的资源，也可能对其他资源产生副作用；即，可以通过应用 PATCH 创建新资源或修改现有资源。
> 
> 正如 [RFC2616] 第 9.1 节所定义的那样，PATCH**既不安全也不幂等。**

我现在可能不会再把奇怪的想法放在你的脑海里了。如果您希望我继续沿着这条路走更长的时间，请发表评论；）。可以说，还有更多的考虑可以做。

# adsense - Google 自定义搜索元素：样式化广告

> ID：10014162
> 
> 赞同：3
> 
> 时间：2012-04-04T15:20:23.147
> 
> 标签：adsense, google-custom-search

我在我的网站上添加了一个 Google 自定义搜索元素。我已经将 CSE 的外观修改为我的网站，但我无法修改**ads 元素**的外观，因为它位于**iframe**中。

有人知道如何设置广告 iframe 的样式吗？我想输入背景颜色并更改字体。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-15T21:39:32.220

此功能似乎仅适用于[Google Site Search](http://www.google.com/enterprise/search/products_gss.html)客户。如果您是其中之一，您将能够以 XML 提要的形式接收搜索结果，并在原始数据上应用表示层。有关如何执行此操作的所有详细信息，请访问[官方 Google 自定义搜索站点](https://developers.google.com/custom-search/docs/snippets)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-11T06:30:55.887

您可以尝试使用此 api 进行 AdSence 搜索 - [https://developers.google.com/custom-search-ads/docs/implementation-guide?hl=en](https://developers.google.com/custom-search-ads/docs/implementation-guide?hl=en)，但您不能像搜索结果一样显示广告。

# android - Android ksoap2 可空类型

> ID：10014164
> 
> 赞同：2
> 
> 时间：2012-04-04T15:20:43.427
> 
> 标签：android, web-services, wsdl, ksoap2

我正在尝试使用 Ksoap2 库从 Android 设备连接到 WCF .Net Web 服务。一切正常，到目前为止我已经能够发送和接收复杂的对象（经过大量的故障排除）。但是，我现在遇到了可空类型的问题。在服务器端，我要发送的许多属性都可以为空。当我尝试从 Android 端将这些作为 null 发送时，我收到一个反序列化错误，因为 ksoap 将 null=true 而不是 nil=true。这是来自测试驱动程序的一些工作 SOAP XML 以及来自 Android 客户端的当前 XML。

工作测试驱动程序 XML

```
<s:Envelope xmlns:s="http://schemas.xmlsoap.org/soap/envelope/">
<s:Body>
    <AddNullables xmlns="http://TJIsGhey/Tester">
        <NumbersToAdd xmlns:i="http://www.w3.org/2001/XMLSchema-instance">
            <Input1>7</Input1>
            <Input2 i:nil="true" />
        </NumbersToAdd>
    </AddNullables>
</s:Body>
</s:Envelope> 
```

Android 客户端 XML

```
<v:Envelope xmlns:i="http://www.w3.org/2001/XMLSchema-instance" xmlns:d="http://www.w3.org/2001/XMLSchema" xmlns:c="http://schemas.xmlsoap.org/soap/encoding/" xmlns:v="http://schemas.xmlsoap.org/soap/envelope/">
    <v:Header />
    <v:Body>
        <AddNullables xmlns="http://TJIsGhey/Tester" id="o0" c:root="1">
            <NumbersToAdd i:type="n0:NullablesIn" xmlns:n0="http://TJIsGhey/Tester">
                <Input1 i:type="d:int">6</Input1>
                <Input2 i:null="true" />
            </NumbersToAdd>
        </AddNullables>
    </v:Body>
</v:Envelope> 
```

这是我收到的错误消息：

反序列化 Tester.NullablesIn 类型的对象时出错。值 '' 无法解析为类型 'Int32'。

任何帮助将不胜感激！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-25T11:35:09.897

我遇到过同样的问题。在我钻入 Ksoap2 源代码之后，我发现了这个问题。您有 2 个可能的解决方案，第一个也是简单的解决方案是在 SoapSerializationEnvelope 使用 VER12。由于 Ksoap2 自 VER12 及更高版本以来仅使用 nil 属性。但是，您可能会受到此更改的影响，因此您有另一个选择：继承 SoapSerializationEnvelope 并覆盖此类的 writeProperty 方法。像这样：

```
public class ExtendedSoapSerializationEnvelope extends
    SoapSerializationEnvelope {

public ExtendedSoapSerializationEnvelope(int version) {
    super(version);
}

@Override
protected void writeProperty(XmlSerializer writer, Object obj,
        PropertyInfo type) throws IOException {
    if (obj == null) {

        if (!(obj instanceof SoapObject)) {
            // assuming object implements KvmSerializable or other type of
            // Serialization interface
            writer.attribute(xsi, version >= VER11 ? "nil" : "null", "true");

        } else {
            // assuming SoapObject being used with VER12 and up
            writer.attribute(xsi, version >= VER12 ? "nil" : "null", "true");
        }
        return;
    }
    super.writeProperty(writer, obj, type);
}} 
```

如果您知道您的 webService 始终与 nil 一起使用，您可以完全跳过此检查并使用：

```
 @Override
protected void writeProperty(XmlSerializer writer, Object obj,
        PropertyInfo type) throws IOException {
    if (obj == null) {
        writer.attribute(xsi, "nil", "true");
        return;
    }

    super.writeProperty(writer, obj, type);

} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-03-29T03:54:12.563

解决方法是`"<element type>"`使用如下参数忽略`skipNullProperties`此：

```
SoapSerializationEnvelope envelope = new SoapSerializationEnvelope(SoapEnvelope.VER11);
envelope.skipNullProperties=true; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-12-16T07:15:50.473

问题已解决

```
import android.os.AsyncTask;
import android.support.v7.app.AppCompatActivity;
import android.os.Bundle;
import android.widget.TextView;
import org.ksoap2.SoapEnvelope;
import org.ksoap2.serialization.SoapObject;
import org.ksoap2.serialization.SoapSerializationEnvelope;
import org.ksoap2.transport.HttpsTransportSE;
import java.net.URISyntaxException;

public class MainActivity extends AppCompatActivity {
    private static final String URL = "https://services.rs.ge/WayBillService/WayBillService.asmx?WSDL";

    TextView tv;

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        tv = new TextView(this);
        String[] params = new String[]{"save_waybill","s22:12345678910","123456"};
        new MyAsyncTasc().execute(params);
        setContentView(tv);
    }

    class MyAsyncTasc extends AsyncTask<String,Void,String> {
        @Override
        protected String doInBackground(String... params) {
            String SOAP_ACTION="http://tempuri.org/"+params[0];
            int timeOut = 60000;
            SoapSerializationEnvelope __envelope=new SoapSerializationEnvelope(SoapEnvelope.VER11);
            SoapObject request = new SoapObject("http://tempuri.org/", params[0]);
            __envelope.dotNet = true;
            __envelope.setOutputSoapObject(request);
            request.addProperty("su", params[1]);
            request.addProperty("sp", params[2]);

            //------------------ SoapObject
            SoapObject waybill1 = new SoapObject("", "WAYBILL");
            SoapObject goods1 = new SoapObject("", "GOODS");
            SoapObject good_list1 = new SoapObject("", "GOODS_LIST");
            waybill1.addProperty("SELER_UN_ID", 1149251);
            waybill1.addProperty("ID", 0);
            waybill1.addProperty("TYPE", 1);
            waybill1.addProperty("STATUS", 1);
            waybill1.addProperty("START_ADDRESS", "START_ADDRESS");
            waybill1.addProperty("END_ADDRESS", "END_ADDRESS");
            waybill1.addProperty("DRIVER_TIN", "61007004242");
            waybill1.addProperty("CAR_NUMBER", "AAA000");
            waybill1.addProperty("CHEK_DRIVER_TIN", 1);
            waybill1.addProperty("TRANSPORT_COAST", 0);
            waybill1.addProperty("TRAN_COST_PAYER", 2);
            waybill1.addProperty("TRANS_ID", 1);

            goods1.addProperty("ID", 0);
            goods1.addProperty("W_NAME", "W_NAME");
            goods1.addProperty("UNIT_ID", 1);
            goods1.addProperty("QUANTITY", 2);
            goods1.addProperty("PRICE", 1);
            goods1.addProperty("AMOUNT", 2);
            goods1.addProperty("BAR_CODE", "1");

            good_list1.addProperty("GOODS", goods1);

            goods1 = new SoapObject("", "GOODS");
            goods1.addProperty("ID", 0);
            goods1.addProperty("W_NAME", "W_NAME2");
            goods1.addProperty("UNIT_ID", 1);
            goods1.addProperty("QUANTITY", 4);
            goods1.addProperty("PRICE", 1);
            goods1.addProperty("AMOUNT",4);
            goods1.addProperty("BAR_CODE", "2");

            good_list1.addProperty("GOODS", goods1);

            waybill1.addProperty("GOODS_LIST", good_list1);
            SoapObject wib_send = new SoapObject("", "waybill");
            wib_send.addProperty("WAYBILL", waybill1);
            request.addProperty("waybill", wib_send);

            java.net.URI uri = null;
            try {
                uri = new java.net.URI(URL);
            } catch (URISyntaxException e) {
                e.printStackTrace();
            }
            int port=uri.getPort()>0?uri.getPort():443;
            HttpsTransportSE httpTransport= new HttpsTransportSE(uri.getHost(), port, uri.getPath(), timeOut);
            httpTransport.debug = true;
            try {
                httpTransport.call(SOAP_ACTION, __envelope);
                SoapObject resultRequestSOAP = (SoapObject) __envelope.bodyIn;
                return resultRequestSOAP.toString();
            } catch(Exception exp){
                return "Error";
            }
        }
        @Override
        protected void onPostExecute(final String result) {
            tv.setText(result);
        }
    }
}
```

# sublimetext - Sublime Text 2 代码格式化

> ID：10014165
> 
> 赞同：54
> 
> 时间：2012-04-04T15:20:49.963
> 
> 标签：sublimetext, prettify, sublimetext2

首先让我说我来自微软背景，Visual Studio 是我的生计。它有一个自动格式化*任何*代码语法的命令（键绑定是任意的）。相同的命令适用于 HTML、CSS、Javascript、C# 等。

我已经尝试过 ST2 的插件，到目前为止，我发现大多数插件都不能在 Windows 机器上工作，如果它们能工作，那么它就像 Javascript 一样用于非常特定的目的。

我已经尝试过（并在适当的地方打开了问题）：

[https://github.com/victorporof/Sublime-HTMLPrettify](https://github.com/victorporof/Sublime-HTMLPrettify)

[https://github.com/jdc0589/JsFormat](https://github.com/jdc0589/JsFormat) （这个确实有效）

[https://github.com/welovewordpress/SublimeHtmlTidy](https://github.com/welovewordpress/SublimeHtmlTidy)

是否有任何 ST2 的 Windows 用户发现任何可以格式化 CSS/HTML/Javascript 的东西，最好是一次性找到？

**编辑：**由于这个问题得到了很多没有活动的视图，我会说我*仍在*寻找一个可以在同一命令中格式化各种脚本类型的插件。

**2013 年 10 月** 仍然没有找到任何可以很好地涵盖 JS+CSS+HTML 的内容，但是我已经确定[JsFormat](https://github.com/jdc0589/JsFormat)是迄今为止最有效且无错误的，并且仅针对 JavaScript 的配置量最少。

* * *

## 回答 #1

> 赞同：111
> 
> 时间：2013-01-22T02:08:36.187

Sublime Text 中的一个类似选项是内置的`Edit->Line->Reindent`. 您可以将此代码放入`Preferences -> Key Bindings User`：

```
{ "keys": ["alt+shift+f"], "command": "reindent"} 
```

我使用`alt`++因为我是 Netbeans 用户`shift`。`f`

要格式化您的代码，请按`ctrl`+`a`和“您的组合键”全选。请原谅我的英语不好。

* * *

或者，如果您不想在格式化之前全选，请在命令中添加一个参数：

```
{ "keys": ["alt+shift+f"], "command": "reindent", "args": {"single_line": false} } 
```

（根据下面[@Supr](https://stackoverflow.com/users/1171043)的评论）

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2013-04-25T13:25:33.110

[Sublime CodeFormatter](https://github.com/akalongman/sublimetext-codeformatter)具有对 PHP、JavaScript/JSON/JSONP、HTML、CSS、Python 的格式支持。虽然我使用 CodeFormatter 的时间不长，但它的 JS、HTML 和 CSS “美化”功能给我留下了深刻的印象。我没有尝试将它与 PHP（我不进行任何 PHP 开发）或 Python（我没有经验）一起使用，但是这两种语言在`.sublime-settings`文件中都有很多选项。

但是请注意，这些设置并不是很容易找到。在 Windows 上，您需要转到您的`%AppData%\Roaming\Sublime Text #\Packages\CodeFormatter\CodeFormatter.sublime-settings`. 由于我没有 Mac，我不确定设置文件在 OS X 上的位置。

至于快捷键，我将此键绑定添加到我的“ `Key Bindings - User`”文件中：

```
{
    "keys": ["ctrl+k", "ctrl+d"],
    "command": "code_formatter"
} 
```

我使用`Ctrl`+ `K`，`Ctrl`+`D`因为这是 Visual Studio 用于格式化的。当然，您可以更改它，只需记住您选择的内容可能与其他功能的键盘快捷键冲突。

**更新：**

似乎 Sublime Text CodeFormatter 的开发人员使访问`.sublime-settings`文件变得更加容易。如果您使用 Package Control 插件安装 CodeFormatter，您可以通过 访问设置并使用菜单项`Preferences -> Package Settings -> CodeFormatter -> Settings - Default`覆盖这些设置。`Preferences -> Package Settings -> CodeFormatter -> Settings - User`

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2012-04-24T13:46:58.017

我不能说第二或第三，但如果你先安装 Node，Sublime-HTMLPrettify 工作得很好。安装后，您必须设置自己的快捷键。我在 Windows 上注意到的一件事是，如果 %PATH% 变量已经很长，您可能需要编辑 Node 的路径（我认为 %PATH% 变量的限制是 1024，之后的任何内容都将被忽略。）

有一个 Windows 错误，但在问题中有一个修复它。您需要编辑 HTMLPrettify.py 文件 - [https://github.com/victorporof/Sublime-HTMLPrettify/issues/12](https://github.com/victorporof/Sublime-HTMLPrettify/issues/12)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-08-01T18:44:53.757

也许这个答案不是你要找的，但它会用相同的键盘快捷键格式化任何语言。解决方案是[特定语言的键盘快捷键](https://stackoverflow.com/questions/38791826/sublime-text-3-language-specific-goto-definition-keyboard-shortcut)。

对于您要格式化的每种语言，您必须找到并下载一个插件，例如 html 格式化程序和 C# 格式化程序。然后将每个插件的命令映射到相同的键，但上下文不同（参见链接）。

问候

# c - 文件系统基准测试工具如何测量时间？

> ID：10014166
> 
> 赞同：1
> 
> 时间：2012-04-04T15:20:54.510
> 
> 标签：c, linux, iozone

我想测量特定系统调用的运行时间，例如，我想知道`pread`需要多少时间在 CPU 和 I/O 上。

我应该使用哪个功能？

现在我使用`times`，它可以工作。

`gettimeofday`是获取当前时间，那可能不只是计算特定进程的运行时间吧？

`clock`是返回这个程序到目前为止使用的 CPU 时间，这是否包括 I/O 时间？如果还有其他程序在运行，会不会影响这个功能的时间？我的意思是切换运行过程。

`getrusage`看起来很理想，但它也返回`CPU`特定过程的时间。

有谁知道像iozone这样的基准工具如何计算`system calls`时间？我已经阅读了它的代码，但仍然不知道。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-04T15:38:21.690

你正在寻找`times(2)`.

# php - 当值 IN 逗号分隔字符串（或数组）Javascript 时检查复选框

> ID：10014170
> 
> 赞同：-2
> 
> 时间：2012-04-04T15:21:01.993
> 
> 标签：php, javascript, checkbox

我将如何更改此 JS 函数以仅检查具有逗号分隔字符串中的值的复选框？使用 MySQL，我可以使用“IN”函数来做到这一点，在 Javascript 中是否有类似的函数？好像找不到。。

我想选择一个“组”复选框，值为1,2,3,4,5 ......然后检查时，请检查以下“单个”复选框，单个值为1 ....或...2....或....3....等。

例子：

（复选框 1）组 1 值="1,2,3"

（复选框 2）项目 1 值="1"

（复选框 3）项目 2 值 =“2”

（复选框 4）项目 3 值 =“3”

（复选框 5）项目 4 值 =“4”

因此，如果选中复选框 1，则会选中复选框 2、3、4。

```
function SetAllCheckBoxes(FormName, FieldName, CheckValue) {
    if (!document.forms[FormName]) return;

    var objCheckBoxes = document.forms[FormName].elements[FieldName];  
    if (!objCheckBoxes) return;

    var countCheckBoxes = objCheckBoxes.length;
    if (!countCheckBoxes) {
        objCheckBoxes.checked = CheckValue;
    }
    else {
        // set the check value for all check boxes
        for(var i = 0; i < countCheckBoxes; i++) {
            objCheckBoxes[i].checked = CheckValue;
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-04T15:28:50.550

好的，根据这个问题的神秘性质更新了我的问题。所以你想看看一个对象是否有一个存在于逗号分隔字符串中的值？如果是这样：

```
function SetAllCheckBoxes(individualCheckbox,values) {
   if(!individualCheckbox||!values) {
      return; 
   } else {
     var array = values.split(',');  
     for(var i = 0; i <= array.count(); i++) {
        if(individualCheckbox.value == array[i]) {
           return true;
        } 
     }
   }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-04T15:38:45.870

1）天哪，使用大括号。

2）这是关于什么的：

```
if(!countCheckBoxes)
    objCheckBoxes.checked = CheckValue; 
```

...如果您没有任何复选框，为什么要将空数组设置为 CheckValue？

3）您在页面中获得 1 个表单，然后在该表单中查找具有特定名称的元素。您真的期望获得超过 1 个复选框吗？如果是这样，您的 html 已损坏。您是在谈论一组单选按钮吗？

4）你的问题不清楚。但答案可能与字符串函数有关，拆分：

```
var vals = "a,b,c".split(","); // vals == ["a", "b", "c"] 
```

好的，所以在澄清问题的基础上，我相信您需要以下内容：

```
function SetAllCheckBoxes(FormName, FieldNames, CheckValue) {
    var form = document.forms[FormName];
    if (!form) {
        return;
    }

    var checkboxNames = FieldNames.split(",");
    for (var i=0, l=checkboxNames.length; i<l; i++) {
        var checkboxName = checkboxNames[i].trim(); // needed if your comma separated string may contain spaces
        var checkbox = form.elements[checkboxName];
        checkbox.checked = CheckValue
    }
} 
```

# vb.net - OrderBy Linq.Expression 作为参数 = (Of Func(Of T,IComparable)) 来执行 LinqToEntity 不起作用

> ID：10014174
> 
> 赞同：1
> 
> 时间：2012-04-04T15:21:13.537
> 
> 标签：vb.net, linq, entity-framework-4, lambda

我想让这个工作：

DBSet 构造函数：

```
dbset = DataContext().[Set](Of T)() 
```

调用：（Count & Page 用于分页，例如 Count = 20 和 Page = 1，对于前 20 个值）。排序应该按名称

```
LeverancierService.GetLeveranciers(Function(el) el.Name, Count, Page) 
```

c# 中的等价物：LeverancierService.GetLeveranciers(el=> el.Name, Count, Page)

给出错误的方法（如上所示的参数）：

```
 Public Overridable Function GetAllPaged(orderby As Expression(Of Func(Of T, IComparable)), ByVal Count As Integer, ByVal Page As Integer) As IEnumerable(Of T)
      Return dbset.OrderBy(orderby).Skip((Page - 1) * Count).Take(Count).ToList()
 End Function 
```

已经尝试将其更改为此，但它给出了相同的错误：

```
 Public Overridable Function GetAllPaged(Of TOrderBy)(orderby As Expression(Of Func(Of T, TOrderBy)), ByVal Count As Integer, ByVal Page As Integer) As IEnumerable(Of T)
        Return dbset.OrderBy(orderby).Skip((Page - 1) * Count).Take(Count).ToList()
 End Function 
```

错误：

```
 Unable to cast the type 'System.String' to type 'System.IComparable'. LINQ to Entities only supports casting Entity Data Model primitive types. 
```

知道怎么做吗？

额外信息：

我在一个 DDD 分层的应用程序中，所以参数应该保持不变，因为被调用的方法是一个被覆盖的接口（例如，如果我改变这个，我必须这样做 200 次左右，因为它在 VB.Net而不是在 C# 中（= 1 更改））

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-04T17:27:39.160

*这是我的样本。我希望它能解决你的问题：*

如果您的**dbset 类型未定义**：

```
Public Function Test(Of TEntity As Class, TKey) _
    (keySelector As Expression(Of Func(Of TEntity, TKey))) As IList(Of TEntity)
    Return DataContext.Set(Of TEntity).OrderBy(keySelector).ToList
End Function 
```

用法：

```
Repository.Test(Function(obj As MyEntity) obj.Name) 
```

如果您的**dbset 类型已定义**，您可以使用此其他示例：

```
 Public Function Test2(Of TKey) _
        (keySelector As Expression(Of Func(Of MyEntity, TKey))) _
        As IList(Of MyEntity)
        Return DataContext.Set(Of MyEntity).OrderBy(keySelector).ToList
    End Function 
```

像这样使用：

```
Repository.Test(Function(obj) obj.Name) 
```

# report - X++ 在报表中传递当前选定的记录

> ID：10014177
> 
> 赞同：5
> 
> 时间：2012-04-04T15:21:31.680
> 
> 标签：report, axapta, x++

我试图让这个问题听起来尽可能清楚。

基本上，我已经创建了一个报告，它现在作为一个 menuitem 按钮存在，以便报告可以在表单之外运行。

我想做的是能够多选记录，然后当我点击我的按钮运行我的报告时，当前选择的记录被传递到出现的对话框表单（过滤屏幕）中。

我尝试使用与 SaleLinesEdit 表单相同的方法来执行此操作，但没有成功。

如果有人能指出我正确的方向，我将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-04T18:16:56.120

看看[Axaptapedia 在表单之间传递值](http://www.axaptapedia.com/Passing_values_between_forms)。这应该可以帮助你。您可能必须修改您的报表以使用对话框的表单，而不是使用报表的基本对话框方法[这是一个很好的起点！](http://mscerts.programming4.us/application_server/microsoft%20dynamics%20ax%202009%20%20%20working%20with%20forms%20-%20creating%20dialogs.aspx)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-30T20:03:37.080

只是想添加这个

您可以使用 MuliSelectionHelper 类非常简单地执行此操作：

```
MultiSelectionHelper selection = MultiSelectionHelper::createFromCaller(_args.caller());
MyTable myTable = selection.getFirst();
while (myTable)
{
    //do something
    myTable = selection.getNext();
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-10T12:38:43.920

这是我用于此问题的解决方案；

报表上有两种方法，以便在表单上多选字段时，将值传递给过滤器对话框；

```
private void setQueryRange(Common _common)
    {
    FormDataSource              fds;

    LogisticsControlTable       logisticsTable;

    QueryBuildDataSource        qbdsLogisticsTable;
    QueryBuildRange             qbrLogisticsId;
    str                         rangeLogId;

    set                         logIdSet    = new Set(Types::String);

    str addRange(str _range, str _value, QueryBuildDataSource _qbds, int _fieldNum, Set _set    =       null)
    {
        str             ret = _range;
        QueryBuildRange qbr;
        ;

        if(_set && _set.in(_Value))
        {
            return ret;
        }

        if(strLen(ret) + strLen(_value) + 1 > 255)
        {
            qbr = _qbds.addRange(_fieldNum);
            qbr.value(ret);
            ret = '';
        }

        if(ret)
        {
            ret += ',';
        }

        if(_set)
        {
            _set.add(_value);
        }

        ret += _value;
        return ret;
    }
    ;

    switch(_common.TableId)
    {
        case tableNum(LogisticsControlTable):

            qbdsLogisticsTable = element.query().dataSourceTable(tableNum(LogisticsControlTable));
            qbrLogisticsId     = qbdsLogisticsTable.addRange(fieldNum(LogisticsControlTable, LogisticsId));

            fds = _common.dataSource();

            for(logisticsTable = fds.getFirst(true) ? fds.getFirst(true) : _common;
                logisticsTable;
                logisticsTable = fds.getNext())
            {
                rangeLogId = addrange(rangeLogId, logisticsTable.LogisticsId, qbdsLogisticsTable, fieldNum(LogisticsControlTable, LogisticsId),logIdSet);
            }

            qbrLogisticsId.value(rangeLogId);
            break;
    }
} 
```

// 这会设置查询并获取将它们传递给范围的值，即“SO0001, SO0002, SO000£...

第二种方法如下；

```
private void setQueryEnableDS()
{
    Query           queryLocal = element.query();
    ;
} 
```

在 init 方法上也是必需的；

```
public void init()
{
    ;
    super();

    if(element.args() && element.args().dataset())
    {
        this.setQueryRange(element.args().record());
    }
} 
```

希望这对将来遇到我遇到的问题的其他人有所帮助。

# html - Internet Explorer 中的萤火虫替代品

> ID：10014178
> 
> 赞同：2
> 
> 时间：2012-04-04T15:21:31.807
> 
> 标签：html, css

我正在寻找 Internet Explorer 8 的萤火虫替代品。我尝试了萤火虫精简版。只需将 java 脚本代码嵌入到我的 hmtl 文件中，但它不能有效地工作。

我的网站 way2enjoy.com 在除 internet explorer 8 之外的所有浏览器中都能正常工作。当用户登录到他们的帐户时，中间部分会消失。中间和侧面有三列，但中间在 ie8 中消失了。我无法检查，因为我不知道如何在 IE8 中调试 css。我通过减小 CSS 宽度尝试了各种操作，但无法解决问题。

示例登录 ID 和密码是

用户名演示

密码演示

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-04T15:25:42.617

您可以使用 IE8 开发人员工具。按`F12`，这个工具是嵌入的

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-04T15:22:26.893

IE8 包含它自己的内置开发者工具，您可以通过点击`F12`或工具>开发者工具来访问它。它不如 ff 中的 firebug 好，但它对调试很有用。

如果您正在寻找一种与 Firebug for Firefox 一样强大的客户端调试工具，您将找不到它，因为它不存在。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-04T15:27:46.793

有一个名为[Firebug Lite](http://getfirebug.com/firebuglite)的 Firebug 小书签。它适用于几乎所有浏览器。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-04T15:33:03.000

你可以试试微软的[开发者工具栏](http://www.microsoft.com/download/en/details.aspx?id=18359)。

# mongodb - 如何在mongo中有效地通过查询删除文档？

> ID：10014181
> 
> 赞同：15
> 
> 时间：2012-04-04T15:21:40.417
> 
> 标签：mongodb

我有一个查询，它选择要删除的文档。现在，我手动删除它们，就像这样（使用 python）：

```
for id in mycoll.find(query, fields={}):
  mycoll.remove(id) 
```

这似乎不是很有效。有没有更好的办法？

**编辑**

好的，我应该为忘记提及查询详细信息而道歉，因为这很重要。这是完整的python代码：

```
def reduce_duplicates(mydb, max_group_size):
  # 1\. Count the group sizes
  res = mydb.static.map_reduce(jstrMeasureGroupMap, jstrMeasureGroupReduce, 'filter_scratch', full_response = True)
  # 2\. For each entry from the filter scratch collection having count > max_group_size
  deleteFindArgs = {'fields': {}, 'sort': [('test_date', ASCENDING)]}
  for entry in mydb.filter_scratch.find({'value': {'$gt': max_group_size}}):
    key = entry['_id']
    group_size = int(entry['value'])
    # 2b. query the original collection by the entry key, order it by test_date ascending, limit to the group size minus max_group_size.
    for id in mydb.static.find(key, limit = group_size - max_group_size, **deleteFindArgs):
      mydb.static.remove(id)
  return res['counts']['input'] 
```

那么，它有什么作用呢？它将重复键的数量减少到`max_group_size`每个键值最多，**只留下最新的记录**。它是这样工作的：

1.  MR 数据`(key, count)`对。
2.  遍历所有对`count > max_group_size`
3.  按 查询数据`key`，同时按时间戳升序排序（最早的在前）并将结果限制为`count - max_group_size`最旧的记录
4.  删除每一条找到的记录。

如您所见，这完成了将重复项减少到最多 N 个最新记录的任务。所以，最后两个步骤是`foreach-found-remove`，这是我的问题的重要细节，它改变了一切，我必须更具体 - 抱歉。

现在，关于集合删除命令。它确实接受查询，但我的包括排序和限制。我可以用删除来做吗？好吧，我试过了：

```
mydb.static.find(key, limit = group_size - max_group_size, sort=[('test_date', ASCENDING)]) 
```

这次尝试惨败。此外，它似乎搞砸了 mongo。观察：

```
C:\dev\poc\SDR>python FilterOoklaData.py
bad offset:0 accessing file: /data/db/ookla.0 - consider repairing database 
```

不用说，foreach-found-remove 方法有效并产生了预期的结果。

现在，我希望我已经提供了足够的背景信息，并且（希望）已经恢复了我失去的荣誉。

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2012-04-04T15:24:45.103

您可以使用查询来删除所有匹配的文档

```
var query = {name: 'John'};
db.collection.remove(query); 
```

但是要小心，如果匹配文档的数量很高，您的数据库可能会变得不那么响应。通常建议以较小的块删除文档。

假设您有 100k 个文档要从集合中删除。执行 100 次删除 1k 文档的查询比执行 1 次删除所有 100k 文档的查询要好。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2012-04-04T15:24:04.597

您可以使用 MongoDB 脚本语言直接删除它：

```
db.mycoll.remove({_id:'your_id_here'}); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2017-11-09T01:05:31.407

会`deleteMany()`更有效率吗？我最近发现，`remove()`对于 100m 文档集合中的 6m 文档，这非常慢。文档位于（[https://docs.mongodb.com/manual/reference/method/db.collection.deleteMany](https://docs.mongodb.com/manual/reference/method/db.collection.deleteMany)）

```
db.collection.deleteMany(
   <filter>,
   {
      writeConcern: <document>,
      collation: <document>
   }
) 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2019-11-20T17:49:18.657

如果有大量记录，我建议分页。

第一：获取要删除的数据数量：

```
-------------------------- COUNT --------------------------
var query= {"FEILD":"XYZ", 'DATE': {$lt:new ISODate("2019-11-10")}};
db.COL.aggregate([
    {$match:query},
    {$count: "all"}
  ]) 
```

第二：开始逐块删除：

```
-------------------------- DELETE --------------------------
var query= {"FEILD":"XYZ", 'date': {$lt:new ISODate("2019-11-10")}};
var cursor = db.COL.aggregate([
    {$match:query},
    { $limit : 5 }
  ])
cursor.forEach(function (doc){
    db.COL.remove({"_id": doc._id});
}); 
```

这应该更快：

```
var query={"FEILD":"XYZ", 'date': {$lt:new ISODate("2019-11-10")}};
var ids = db.COL.find(query, {_id: 1}).limit(5);
db.tags.deleteMany({"_id": { "$in": ids.map(r => r._id)}}); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-01-17T12:28:20.203

运行此查询`cmd`

> db.users.remove({"_id": ObjectId("5a5f1c472ce1070e11fde4af")});

如果您使用的是 node.js，请编写此代码

```
User.remove({ _id: req.body.id },, function(err){...}); 
```

# asp.net-mvc-3 - 在 ASP.NET MVC 中路由后找不到 CSS 和图像文件

> ID：10014183
> 
> 赞同：1
> 
> 时间：2012-04-04T15:21:45.583
> 
> 标签：asp.net-mvc-3, asp.net-mvc-routing

在我的 ASP.NET MVC (3) 应用程序中，我在 global.asax.cs 中设置了以下路由：

```
routes.MapRoute(
    "UniqueId",
    "{uniqueId}",
    new { controller = "Book", action = "DownloadBook" },
    new { uniqueId = "[0-9a-zA-Z]{5}" }
); 
```

DownloadFile 操作方法是：

```
public ActionResult DownloadBook(string uniqueId)
{
    string path = Server.MapPath(String.Format("~/App_Data/Books/{0}/index.htm", uniqueId));
    if (System.IO.File.Exists(path))
    {
        return File(path, "text/html");
    }
    return new EmptyResult();
} 
```

该方法正确地为 /App_Data/Books 目录中的子目录中的 index.htm 文件提供服务，该文件的名称与路由中定义的 uniqueId 对应。但是，无法找到 index.htm 文件中的 CSS 和图像文件，因为浏览器会尝试在原始 URL 位置（例如[http://localhost/3Yru3/](http://localhost/3Yru3/)）中找到它们。

对此我能做些什么吗？我可能忽略了什么？

**编辑**（另请参阅我的问题答案中的评论）：
这些书籍存储为 HTML 文件（而不是 MVC 视图，这将使引用 CSS 和图像不成问题），因为：
1\. 它们将被上传像这样的用户。
2\. 我想将 index.htm 文件及其使用的资源存储在 HTML5 appcache 中，以便离线使用。

**编辑 2**我找到了解决我自己问题的方法，并想知道您对此有何看法。在下面的答案中查看我自己的答案。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-04T15:26:41.537

这一定会发生，因为您以错误的方式（相对）引用您的文件，这意味着它将根据您当前页面的根目录提供服务。

前任：

```
<link rel="Stylesheet" href="/Styles/site.css" /> 
```

或者

```
<link rel="Stylesheet" href="../../Styles/site.css" /> 
```

* * *

而不是这种方式，使用以下语法来链接你的 CSS 文件和你的图像

```
<link rel="Stylesheet" href="<%=Url.Content("~/Styles/site.css")%>" /> 
```

这应该可以正常工作，并且可以从任何页面正确评估，无论其位置如何。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-04T19:20:21.650

你可以做一些事情，但它更像是一种黑客行为。为 css 链接放置占位符，然后在提供文件时进行替换，类似这样。

```
public ActionResult DownloadBook(string uniqueId)
{
string path = Server.MapPath(String.Format("~/App_Data/Books/{0}/index.htm", uniqueId));
if (System.IO.File.Exists(path))
{
   var file=File.ReadAllText(path);
   //this needs a bit more refining, it's just a proof of concept
     //you can use Razor templating, there is a library for that
    file=file.Replace("{CssHref}",UrlHelper.GenerateContentUrl("~/Content/site.css",HttpContext));
   return Content(file);
}
return new EmptyResult();
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-07T08:35:36.597

我想我可能已经找到了一个非常优雅的解决我的问题的方法，但我想听听你的看法。当它尝试获取 App_Data 子文件夹中 index.htm 文件所引用的 CSS 文件和图像文件时（已成为长句，我希望它有意义;-)。

首先，我尝试在应用程序的 global.asax.cs 的 BeginRequest 事件处理程序中使用 Context.RewritePath。这产生了一些意想不到的副作用。然后我创建了一个**自定义路由**类，它涵盖了我上面的问题中描述的原始路由以及 CSS 和图像文件请求的 URL 重写。自定义路由使用的事实是，在这些请求期间，Request.UrlReferrer 属性包含 index.htm 文件位置的 URL。由于这将成为一个很长的故事，因此我参考了我就该主题撰写的[一篇博客文章以了解技术细节。](http://buildingwebapps.blogspot.fr/2012/04/serving-html-files-from-appdata-folder.html)我希望这些信息可以为其他人节省一些宝贵的时间。

# qt - Qt 信号/插槽连接不起作用

> ID：10014186
> 
> 赞同：1
> 
> 时间：2012-04-04T15:21:49.433
> 
> 标签：qt, qt-signals

我在`QObject::connect`方法上有一个非常奇怪的问题。首先请看一下这个非常简单的代码：

```
class B : public QWidget {
  Q_OBJECT
public:
  explicit B(QWidget* parent = 0) : QWidget(parent) { }
signals:
  void event();
}

class A : public QObject {
  Q_OBJECT
public:
  explicit A(QWidget* parent = 0) : QObject(parent) { b = new B(parent); init(); }
  void init() { QObject::connect(b, SIGNAL(event()), this, SLOT(handler())); }
public slots:
  void handler() { /*spit out some text*/ }
private:
  B* b;
} 
```

的对象`A` *不*响应从 的对象发出的信号`B`。我相信信号会按预期发出。`QObject::connect`方法返回`true`表示成功。我跑了*qmake*，*moc*并且*moc_* .cpp* 文件似乎是正确的。

我想知道我在哪里犯错了？

**编辑我：**

这是我正在处理的代码，它被剥离，所以只显示相关部分：

```
class ListController : public QObject {
  Q_OBJECT
public:
  explicit ListController(Model* model, QWidget* parent = 0) : QObject(parent) { compositeView = new CompositeView(parent); initConnections(); }
  void initConnections() { QObject::connect(compositeView->getListView(), SIGNAL(event()), this, SLOT(handler())); }
public slots:
  void handler() { qDebug()<<"signal is received ..."; }
private:
  CompositeView* view;
};

class CompositeView: public QGroupBox {
  Q_OBJECT
public:
  explicit CompositeView(QWidget* parent = 0) : QGroupBox(parent) { listView = new ListView(this); }
  ListView* getListView() const { return listView; }
private:
  ListView* listView;
};

class ListView : public QListWidget {
  Q_OBJECT
public:
  explicit ListView(QWidget* parent = 0) : QListWidget(parent) { }
protected:
  void dropEvent(QDropEvent *event) { emit signal(); }
signals:
  void signal();
}; 
```

我在子类中创建一个新`ListController`对象，`QWidget`将自身作为父对象传递并提供适当的`Model`对象。

**编辑二**

将对象`ListController`返回`CompositeView`到主小部件。主小部件将复合视图添加到其布局中。此时， 的父级`CompositeView`及其子级发生了变化。这可能是问题的根源。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-04T21:25:12.600

这个问题的答案比我预期的要容易得多。

我认为我在执行以下步骤时犯了一个错误：

1.  `ListController`在**堆栈**上创建。
2.  该`CompositeView`对象被返回并添加到主窗口小部件布局中。
3.  `ListController`对象默默地超出范围并被破坏，因此连接。

顶部的评论 13 实际上是解决方案。[非常](https://stackoverflow.com/users/1214731/tmpearce)感谢您的建议。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-04T20:07:35.420

```
singals:
  void signal(); 
```

我怀疑，如果它是您正在工作的实际代码，那么请检查拼写错误。

# r - 在 ggplot2 生成的图下方显示文本

> ID：10014187
> 
> 赞同：36
> 
> 时间：2012-04-04T15:21:53.350
> 
> 标签：r, ggplot2

我试图在**ggplot2**中创建的图下方显示一些有关数据的信息。我想使用绘图的 X 轴坐标绘制 N 变量，但 Y 坐标需要距离屏幕底部 10%。事实上，所需的 Y 坐标已经作为 y_pos 变量存在于数据框中。

我可以想到 3 种使用**ggplot2**的方法：

1）在实际图下方创建一个空图，使用相同的比例，然后使用 geom_text 在空白图上绘制数据。[这种方法](http://learnr.wordpress.com/2009/04/29/ggplot2-labelling-data-series-and-adding-a-data-table/)有点工作，但非常复杂。

2）`geom_text`用于绘制数据，但以某种方式使用 y 坐标作为屏幕的百分比（10%）。这将强制数字显示在图下方。我无法弄清楚正确的语法。

3) 使用 grid.text 显示文本。我可以轻松地将其设置在屏幕底部的 10% 处，但我不知道如何设置 X 坐标以匹配绘图。我尝试使用 grconvert 来捕获初始 X 位置，但无法使其正常工作。

下面是带有虚拟数据的基本图：

```
graphics.off()      # close graphics windows   

library(car)
library(ggplot2)  #load ggplot
library(gridExtra) #load Grid
library(RGraphics) # support of the "R graphics" book, on CRAN

#create dummy data
test= data.frame(
  Group = c("A", "B", "A","B", "A", "B"), 
  x = c(1 ,1,2,2,3,3 ),
  y = c(33,25,27,36,43,25),
  n=c(71,55,65,58,65,58),
  y_pos=c(9,6,9,6,9,6)
  )

#create ggplot
p1 <- qplot(x, y, data=test, colour=Group) +
  ylab("Mean change from baseline") + 
  geom_line()+
  scale_x_continuous("Weeks", breaks=seq(-1,3, by = 1) ) +
  opts( 
        legend.position=c(.1,0.9))

#display plot
p1 
```

下面修改后的 gplot 显示了主题的数量，但是它们显示在图中。他们迫使 Y 尺度扩大。我想在图下方显示这些数字。

```
 p1 <- qplot(x, y, data=test, colour=Group) +
  ylab("Mean change from baseline") + 
  geom_line()+
  scale_x_continuous("Weeks", breaks=seq(-1,3, by = 1) ) +
  opts( plot.margin = unit(c(0,2,2,1), "lines"),
        legend.position=c(.1,0.9))+
  geom_text(data = test,aes(x=x,y=y_pos,label=n))

p1 
```

显示数字的另一种方法是在实际图下方创建一个虚拟图。这是代码：

```
graphics.off()      # close graphics windows   

library(car)
library(ggplot2)  #load ggplot
library(gridExtra) #load Grid
library(RGraphics) # support of the "R graphics" book, on CRAN

#create dummy data
test= data.frame(
  group = c("A", "B", "A","B", "A", "B"), 
  x = c(1 ,1,2,2,3,3 ),
  y = c(33,25,27,36,43,25),
  n=c(71,55,65,58,65,58),
  y_pos=c(15,6,15,6,15,6)
  )

p1 <- qplot(x, y, data=test, colour=group) +
  ylab("Mean change from baseline") + 
  opts(plot.margin = unit(c(1,2,-1,1), "lines")) +
  geom_line()+
  scale_x_continuous("Weeks", breaks=seq(-1,3, by = 1) ) +
  opts(legend.position="bottom",
       legend.title=theme_blank(),
       title.text="Line plot using GGPLOT") 
p1

p2 <- qplot(x, y, data=test, geom="blank")+
  ylab(" ")+
  opts(     plot.margin = unit(c(0,2,-2,1), "lines"),
            axis.line = theme_blank(), 
            axis.ticks = theme_segment(colour = "white"),           
            axis.text.x=theme_text(angle=-90,colour="white"),
            axis.text.y=theme_text(angle=-90,colour="white"),
            panel.background = theme_rect(fill = "transparent",colour = NA), 
            panel.grid.minor = theme_blank(),      
            panel.grid.major = theme_blank()
            )+
  geom_text(data = test,aes(x=x,y=y_pos,label=n)) 
p2

grid.arrange(p1, p2, heights = c(8.5, 1.5),             nrow=2 ) 
```

但是，这非常复杂，并且很难针对不同的数据进行修改。理想情况下，我希望能够以屏幕百分比的形式传递 Y 坐标。

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2016-03-16T13:01:45.327

当前版本 (>2.1) 有一个`+ labs(caption = "text")`，它在图下方显示一个注释。这是可主题化的（字体属性，...左/右对齐）。有关示例，请参见[https://github.com/hadley/ggplot2/pull/1582](https://github.com/hadley/ggplot2/pull/1582)。

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2012-05-03T02:59:38.617

**已编辑** `opts`已弃用，由`theme`;代替 `element_blank`已更换`theme_blank`；并`ggtitle()`用于代替`opts(title = ...`

桑迪 - 非常感谢你！！！！这正是我想要的。我真希望我们可以控制 geom.text 或 geom.annotate 中的剪辑。

如果其他人有兴趣，我将以下程序放在一起。

```
 rm(list = ls())     # clear objects  
 graphics.off()      # close graphics windows   

library(ggplot2)
library(gridExtra)

#create dummy data
test= data.frame(
  group = c("Group 1", "Group 1", "Group 1","Group 2", "Group 2", "Group 2"), 
  x = c(1 ,2,3,1,2,3 ),
  y = c(33,25,27,36,23,25),
  n=c(71,55,65,58,65,58),
  ypos=c(18,18,18,17,17,17)

  )

p1 <- qplot(x=x, y=y, data=test, colour=group) +
  ylab("Mean change from baseline") + 
  theme(plot.margin = unit(c(1,3,8,1), "lines")) +
  geom_line()+
  scale_x_continuous("Visits", breaks=seq(-1,3) ) +
  theme(legend.position="bottom",
       legend.title=element_blank())+
   ggtitle("Line plot") 

# Create the textGrobs 
for (ii in 1:nrow(test))
{
  #display numbers at each visit
  p1=p1+ annotation_custom(grob = textGrob(test$n[ii]),  
                           xmin = test$x[ii], 
                           xmax = test$x[ii], 
                           ymin = test$ypos[ii], 
                           ymax = test$ypos[ii])

    #display group text
    if (ii %in% c(1,4)) #there is probably a better way 
      {
    p1=p1+ annotation_custom(grob = textGrob(test$group[ii]),  
                             xmin = 0.85, 
                             xmax = 0.85, 
                             ymin = test$ypos[ii], 
                             ymax = test$ypos[ii])
    }

  }

  # Code to override clipping
  gt <- ggplot_gtable(ggplot_build(p1))
  gt$layout$clip[gt$layout$name=="panel"] <- "off"
  grid.draw(gt) 
```

![在此处输入图像描述](../Images/59f9321e471955ec0af886797b6d03fb.png)

* * *

## 回答 #3

> 赞同：18
> 
> 时间：2012-04-27T07:46:53.700

**更新** `opts()`已替换为`theme()`

在下面的代码中，绘制了一个基础图，图底部的边距较宽。创建了 textGrob，然后使用 annotation_custom() 将其插入到绘图中。除了文本不可见，因为它在绘图面板之外 - 输出被剪切到面板。[但是从这里](https://stackoverflow.com/questions/9690648/point-clipped-on-x-axis-in-ggplot)使用 baptiste 的代码，剪辑可以被覆盖。位置以数据单位表示，两个文本标签都居中。

```
library(ggplot2)
library(grid)

# Base plot
df = data.frame(x=seq(1:10), y = seq(1:10))
p = ggplot(data = df, aes(x = x, y = y)) + geom_point() + ylim(0,10) +
    theme(plot.margin = unit(c(1,1,3,1), "cm"))
p

# Create the textGrobs
Text1 = textGrob(paste("Largest x-value is", round(max(df$x), 2), sep = " "))
Text2 = textGrob(paste("Mean = ", mean(df$x), sep = ""))

p1 = p + annotation_custom(grob = Text1,  xmin = 4, xmax = 4, ymin = -3, ymax = -3) +
        annotation_custom(grob = Text2,  xmin = 8, xmax = 8, ymin = -3, ymax = -3)
p1

# Code to override clipping
gt <- ggplotGrob(p1)
gt$layout$clip[gt$layout$name=="panel"] <- "off"
grid.draw(gt) 
```

![在此处输入图像描述](../Images/6e57cea79da823e4ae2d12096e980d8f.png)

或者，使用`grid`函数来创建和定位标签。

```
p
grid.text((paste("Largest x-value is", max(df$x), sep = " ")),
   x = unit(.2, "npc"), y = unit(.1, "npc"), just = c("left", "bottom"), 
   gp = gpar(fontface = "bold", fontsize = 18, col = "blue")) 
```

![在此处输入图像描述](../Images/e84a148beb10eb91b21db651748729ef.png)

**编辑** 或者，使用 gtable 函数添加文本 grob。

```
library(ggplot2)
library(grid)
library(gtable)

# Base plot
df = data.frame(x=seq(1:10), y = seq(1:10))
p = ggplot(data = df, aes(x = x, y = y)) + geom_point() + ylim(0,10) 

# Construct the text grob
lab = textGrob((paste("Largest x-value is", max(df$x), sep = " ")),
   x = unit(.1, "npc"), just = c("left"), 
   gp = gpar(fontface = "bold", fontsize = 18, col = "blue"))

gp = ggplotGrob(p)

# Add a row below the 2nd from the bottom
gp = gtable_add_rows(gp, unit(2, "grobheight", lab), -2)

# Add 'lab' grob to that row, under the plot panel
gp = gtable_add_grob(gp, lab, t = -2, l = gp$layout[gp$layout$name == "panel",]$l)

grid.newpage()
grid.draw(gp) 
```

[![在此处输入图像描述](../Images/05b5804809f8101c2ef5389a0c2402d8.png)](https://i.stack.imgur.com/mEo6M.png)

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2016-01-04T02:10:18.347

实际上最好的答案和最简单的解决方案是使用 cowplot 包。

版本 0.5.0 的 cowplot 包（在 CRAN 上）使用 add_sub 函数处理 ggplot2 字幕。

像这样使用它：

```
 diamondsCubed <-ggplot(aes(carat, price), data = diamonds) + 
  geom_point() + 
  scale_x_continuous(trans = cuberoot_trans(), limits = c(0.2, 3),
                     breaks = c(0.2, 0.5, 1, 2, 3)) + 
  scale_y_continuous(trans = log10_trans(), limits = c(350, 15000),
                     breaks = c(350, 1000, 5000, 10000, 15000)) +
  ggtitle('Price log10 by Cube-Root of Carat') +
  theme_xkcd()

  ggdraw(add_sub(diamondsCubed, "This is an annotation.\nAnnotations can span multiple lines.")) 
```

# javascript - 简单的javascript问题

> ID：10014191
> 
> 赞同：0
> 
> 时间：2012-04-04T15:22:04.690
> 
> 标签：javascript, jquery

事实证明，这正是我想要做的。但是 HTML 不会用值替换函数调用，这就是我感到困惑的原因。但是，正确的值被传递到数组中。我把这个问题留在这里，以防其他人有同样的问题。

我有一些javascript：

```
<script type="text/javascript">
    var $SAT = $SAT || [];
    $SAT.push(['setContent','subtype','sub']);
    $SAT.push(['setUser', '1234']);
</script> 
```

但我想用函数调用替换“sub”以通过其他方式检索值，如下所示：

```
<script type="text/javascript">
    function getValue() {
        return 'Some Value';
    }
    var $SAT = $SAT || [];
    $SAT.push(['setContent','subtype',getValue()]);
    $SAT.push(['setUser', '1234']);
</script> 
```

但是，生成的代码不会像我预期的那样将 getValue() 函数调用替换为“Some Value”。有谁知道为什么，我需要做什么来解决这个问题？

非常感激！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-04T15:36:08.433

你可以在这里看到你的代码做了你想要的 [http://jsfiddle.net/SGBYY/](http://jsfiddle.net/SGBYY/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-04T15:25:42.443

这是一个未经验证的想法：

```
...
var get_val = function() {
    return "Hi.";
};
$SAT.push(['setContent', 'subtype', get_val()]);
// $SAT now has ['setContent', 'subtype', 'Hi.']
$SAT.push(['setUser', '1234']);
... 
```

# java - Maven exec-plugin pom.xml 定义：激活字符的 shell 解释

> ID：10014192
> 
> 赞同：1
> 
> 时间：2012-04-04T15:22:14.337
> 
> 标签：java, shell, plugins, maven, character

我使用 Maven 插件 exec 并在我的 pom.xml 的配置文件中定义了它，如下所示：

```
<profile>
    <id>optimizepng</id>
    <build>
        <plugins>
            <plugin>
                <groupId>org.codehaus.mojo</groupId>
                <artifactId>exec-maven-plugin</artifactId>
                <executions>
                    <execution>
                        <phase>prepare-package</phase>
                        <goals>
                            <goal>exec</goal>
                        </goals>
                    </execution>
                </executions>
                <configuration>
                    <executable>optipng</executable>
                    <arguments>
                        <argument>src/main/webapp/images/*.png</argument>
                    </arguments>
                </configuration>
            </plugin>
        </plugins>
    </build>
</profile> 
```

现在，如果我将此代码示例中定义的参数设置为`<argument>-h</argument>`，终端调用`mvn org.codehaus.mojo:exec-maven-plugin:exec -P optimizepng`将按预期工作并打印出 optipng 的帮助。

我发现，星号可能不会被解释为 shell 字符。这可能是它的原因吗？如果是这样，是否有一个我可以在任何地方应用的标签来切换 shell 解释？

首先是关于我的计划的附加信息：我想使用 optipng 优化 src/main/webapp/images/ 文件夹中的所有 png 文件。我将用作 shell 命令的是`optipng src/main/webapp/images/*.png`.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-10T22:47:57.277

好的，现在这很快。我发现，我可以直接启动 shell 并让它解释我想要执行的终端调用。

```
<configuration>
    <executable>sh</executable>
    <arguments>
        <argument>-c</argument>
        <argument>optipng src/main/webapp/images/*.png</argument>
    </arguments>
</configuration> 
```

这个代码示例是我必须修复的，所以它完成了工作。

# jquery - jQuery.draggable() - 按钮点击恢复

> ID：10014196
> 
> 赞同：5
> 
> 时间：2012-04-04T15:22:35.300
> 
> 标签：jquery, jquery-ui-draggable, revert, jquery-ui-droppable

我的页面上有几个[可拖放的](http://jqueryui.com/demos/draggable)[元素](http://jqueryui.com/demos/droppable)，它们具有`accept`属性。

目前我的代码设置如下：

```
$(".answer." + answer).draggable({
    revert: "invalid"
    , snap: ".graph"
});
$(".graph." + graph).droppable({
    accept: ".answer." + answer
}); 
```

因此，如果答案不正确，则将其恢复到原来的位置。

用户还需要能够重置页面上的所有内容。我尝试了以下方法，但它不起作用：

```
$("btnReset").click(function(){
   $(".graph.A").draggable({revert:true});
}); 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-04-04T16:13:47.490

由于没有内置方法可以满足您的需求，因此您必须自己模拟还原行为。您可以存储每个可拖动元素的原始位置，然后在单击重置按钮时将它们动画化回这些位置。

这是一个简化的**[jsFiddle 示例](http://jsfiddle.net/j08691/Xdvc5/1/)**。

jQuery：

```
$("#draggable").draggable({
    revert: "invalid"
});
$("#draggable2").draggable({
    revert: "invalid"
});
$("#droppable").droppable({
});
$("#btnReset").click(function() {
    $("#draggable, #draggable2").animate({
        "left": $("#draggable").data("left"),
        "top": $("#draggable").data("top")
    });
});
$(".ui-widget-content").data("left", $(".ui-widget-content").position().left).data("top", $(".ui-widget-content").position().top); 
```

HTML：

```
<div id="draggable" class="ui-widget-content">
    <p>I revert when I'm dropped</p>
</div>
<div id="draggable2" class="ui-widget-content">
    <p>I revert when I'm dropped</p>
</div>
<button id="btnReset">Reset</button>
<div id="droppable" class="ui-widget-header">
    <p>Drop me here</p>
</div>​ 
```

# php - 知道记录是否已显示 3 条记录，如果是，则将另外 3 条记录放在新行中

> ID：10014198
> 
> 赞同：1
> 
> 时间：2012-04-04T15:22:39.077
> 
> 标签：php, html

好的，我有这个代码：

```
<?
$name=$_POST['name'];

$con = mysql_connect("localhost","root","");
if (!$con)
  {
  die('Could not connect: ' . mysql_error());
  }

mysql_select_db("juliver", $con);

$result = mysql_query("SELECT * FROM items WHERE id='$name'");
$ss = ""
while($row = mysql_fetch_array($result))
{   
    $ss .= "<div style='border:1px solid red; float:left; width:100px;'><img src="Images/media'.$row['name'].'" />";
    $ss .= "<p>".$row['title']."</p>";
    $ss .= "<p>".$row['description']."</p>";
    $ss .= "<a href='".$row['link']."'>".$row['link']."</a></div>";

}

mysql_close($con);
?>

<? echo $ss; ?> 
```

现在，我想组织显示，因此，我希望记录设置为 3，但我卡住的唯一问题是我不知道如何让它以 3 组显示。我愿意提出建议，请帮我。谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-04T15:26:20.433

一个函数

```
function sqlArr($sql){
  $ret = array();
  $res = mysql_query($sql) or trigger_error(mysql_error()." ".$sql);
  if ($res) {
    while($row = mysql_fetch_array($res)){
      $ret[] = $row;
    }
  }
  return $ret;
} 
```

一个代码

```
mysql_connect("localhost","root","");
mysql_select_db("juliver");

$name = mysql_real_escape_string($_POST['name']);
$data = sqlArr("SELECT * FROM items WHERE id='$name'");
$data = array_chunk($data,3);
include 'template.tpl.php'; 
```

一个模板

```
<table border='1'>
<? foreach ($data as $row): ?>
  <tr>
<?   foreach ($row as $cell): ?>
    <td><?=$cell['id']?><?=$cell['title']?></td>
<?   endforeach ?>
  </tr>
<? endforeach ?>
</table> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-04T15:33:02.037

在 while 循环中，您可以将条件设​​置为知道它何时执行 3 次，然后它将自动转到另一行。看一看

```
int $a=0;
    while($row = mysql_fetch_array($result))
    {

        if($a%3==0){
    this will executes only if when the no of record dividable by 3\. means 3,6,9,12..
                do this..
    }else {
     do this..
    }

    $a++;
    } 
```

# java - 来自外部 jar 的接缝 i18n 属性文件

> ID：10014199
> 
> 赞同：0
> 
> 时间：2012-04-04T15:22:43.910
> 
> 标签：java, jsf, properties, internationalization, seam

我正在尝试通过`core:bundle-names`seam `components.xml`conf 文件中的标签加载 i18n 属性文件。如果我在 war 项目中引用一个属性文件，它最终会被加载，我可以使用`#{messages['theKeyValue']}`EL 访问来自 facelets 的值。但是，我想从外部 ejb.jar（我打包）加载一个，但没有运气。有没有人找到解决方案？我不想将此文件粘贴到使用此 ejb jar 的所有项目中。

PS：我正在使用 Seam 2.2.2-Final 和 JSF 1.2_12

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-04T15:46:05.100

如果你使用facelets，你可以在页面中声明bundle

```
<f:loadBundle basename="path.in.the.jar" var="messages"/> 
```

# php - 如何在 symfony 2 中最好地构建应用程序

> ID：10014209
> 
> 赞同：3
> 
> 时间：2012-04-04T15:23:17.890
> 
> 标签：php, symfony, bundles

在使用过 Zend、CodeIgniter、Fuel、Yii 和 Cake 等 5 个 php 框架后，我开始使用 Symfony 2。我对如何尽可能好地构建我的项目感到非常困惑。首先，我对使用捆绑包感到困惑。捆绑包是其他框架中使用的某种模块吗？基本上我有我的应用程序，直到现在所有的东西都存储在一个包中。如果我想创建一些辅助函数以及一些库和抽象类，我只需为它们创建一个新包？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-04T15:33:47.743

有关捆绑包结构的基本概念，请参阅[*捆绑包结构和最佳实践*](http://symfony.com/doc/current/cookbook/bundles/best_practices.html)食谱条目。

我建议只使用一个*特定于应用程序的*捆绑包。我称之为`AppBundle`。

此外，您不必将所有东西都捆绑在一起。检查[此问题](https://stackoverflow.com/questions/9999433/should-everything-really-be-a-bundle-on-symfony-2)以获取详细信息。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-04T16:51:58.383

关于这个问题的许多其他讨论：

*   [Symfony 2 上的所有东西都应该是一个捆绑包吗？](https://stackoverflow.com/questions/9999433/should-everything-really-be-a-bundle-on-symfony-2)
*   [对 symfony2 包感到困惑](https://stackoverflow.com/questions/8804831/confused-with-symfony2-bundles)

# html - 如何使用内容长度不同的文本创建左/右 div？

> ID：10014211
> 
> 赞同：0
> 
> 时间：2012-04-04T15:23:31.103
> 
> 标签：html, css, css-float

我想做这个：

![在此处输入图像描述](../Images/a0e69f6b96a6af81447409b17fbb03b1.png)

这是我到目前为止的 HTML/CSS，但是在尝试了浮动、绝对/相对位置、左边、左边距、清除、溢出等的各种组合之后。我无法让它处理不同的长度。

```
<!DOCTYPE html> 
<html>
<head>
    <style>
        .container {
        }
        .leftColumn {
            float:left;
        }
        .rightColumn {
            float:left;
            left:120px;
            position:absolute;
        }
        .clear {
            clear:both;
        }
    </style>
</head>
<body>
  <div class="container">
        <div class="leftColumn">Apr 14: Title: </div>
        <div class="rightColumn">This is a text that will have a variable width, sometimes short and sometimes very, very long, sometimes short and sometimes very, very long.</div>
        <div class="clear"></div>
  </div>
  <div class="container">
        <div class="leftColumn">Apr 15: Another Title: </div>
        <div class="rightColumn">This is a text that will have a variable width, sometimes short and sometimes very, very long, sometimes short and sometimes very, very long.</div>
        <div class="clear"></div>
  </div>
  <div class="container">
        <div class="leftColumn">Apr 16: A Still Longer Title: </div>
        <div class="rightColumn">This is a text that will have a variable width, sometimes short and sometimes very, very long, sometimes short and sometimes very, very long.</div>
        <div class="clear"></div>
  </div>

</body>
</html> 
```

**我必须对上面的 CSS 进行什么更改，以便它处理两列中的可变长度文本，如上面的屏幕截图所示？**

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-04T15:27:14.060

看到这个小提琴：http: [//jsfiddle.net/UHMtW/](http://jsfiddle.net/UHMtW/)

1）删除所有那些可怕的空div以清除浮动（只需使用`easyclearing`或其他一些非结构等效技术）

2）你错过了所有`</div>`的关闭`.rightColumn`

3）使用这个css代码[更新]

```
.container {
     height: auto; overflow: hidden; width: 100%;
     margin : 0 0 20px 0;
 }
 .leftColumn {
     float:left;
     width : 120px;
 }
 .rightColumn {
     margin-left: 120px;   
 } 
```

当然可以根据需要更改元素的宽度并为元素留出一些`.container`边距

（顺便说一句，我建议改用描述列表`<dl>`，但这需要为左列设置最大高度。或者，也许您可​​以`<div>ification`正确使用标题和段落来避免所有这些）

# sql - 将单元格转换为时间戳 w 时区作为 Excel 2007 中 SQL 查询的参数

> ID：10014212
> 
> 赞同：1
> 
> 时间：2012-04-04T15:23:36.147
> 
> 标签：sql, excel

所以我的查询有

> 哪里 date_trunc('DAY', mh.end) > ？

但是，当我尝试在单元格中输入“3/31/2012 12:00:00 AM”或“2012-01-31”之类的内容时，它会抱怨它不是 TIMEZONE 格式的时间戳。我怎样才能让它接受日期？我一直在尝试搜索，但没有发现其他人遇到此问题（我的搜索词可能已关闭）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T15:32:31.427

好的，我想通了。我不得不将日期转换为文本使用`=TEXT(B1,"yyyy-mm-dd hh:mm:ss")`之后它工作正常

# python - 如何在 Pygame 中移动精灵

> ID：10014213
> 
> 赞同：-1
> 
> 时间：2012-04-04T15:23:38.440
> 
> 标签：python, sprite, pygame

我有以下课程：

```
class Enemy(pygame.sprite.Sprite):
def __init__(self):
    pygame.init()
    pygame.sprite.Sprite.__init__(self)
# Basic variables
    self.speed = [2,2]

# Sets up the image and Rect
    self.bitmap = pygame.image.load("badguy.png")
    self.bitmap.set_colorkey((0,0,0))
    self.shipRect = self.bitmap.get_rect()
    self.shipRect.topleft = [100,200]

def move(self, x, y):
    self.shipRect.center = (x,y)

def render(self):
    screen.blit(self.bitmap, (self.shipRect)) 
```

现在，我想让它在我按下箭头键时移动。但是，我的移动功能存在很大问题。它只是将船的中心移动到输入函数的坐标。如果您没有看到问题，那是我试图这样称呼它：

```
if event.key == K_RIGHT:
    enemy.x += 5
if event.key == K_LEFT:
    enemy.move(-5,0)
if event.key == K_UP:
    enemy.move(0,5)
if event.key == K_DOWN:
    enemy.move(0,-5) 
```

我期待它能够将我的五人朝我击中的键的方向移动。但是，它会射到屏幕的左上角，因为我将中心设置在一个轴上为零，而在另一轴上设置为 +- 5。

可以使用什么方法使它朝着正确的方向移动，并且仍然可以让我将精灵放置在我选择的屏幕上的起始位置。

任何帮助深表感谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-04T15:49:49.120

更改`move`为：

```
def move(self, x, y):
    self.shipRect.center[0] += x
    self.shipRect.center[1] += y 
```

这样，它只会将位置增加您指定的移动量。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-09T18:44:13.553

`move_ip`和`centerx`/`y`是你想要的：

```
if event.key == K_RIGHT:
    enemy.centerx.move_ip(5,0)
if event.key == K_LEFT:
    enemy.centerx.move_ip(-5,0)
if event.key == K_UP:
    enemy.centerx.move_ip(0,5)
if event.key == K_DOWN:
    enemy.centerx.move_ip(0,-5) 
```

# jquery - jQueryeaseIn/Out 用于无限循环？

> ID：10014214
> 
> 赞同：0
> 
> 时间：2012-04-04T15:23:47.643
> 
> 标签：jquery, infinite-loop

如何将easeIn/Out 添加到无限动画循环中？

目前，加速到全速的速度非常慢；而不是一个快速的 500 毫秒easeIn。

EaseIn/Out - [http://jsfiddle.net/53quf/1/](http://jsfiddle.net/53quf/1/)

线性 - [http://jsfiddle.net/NJXwH/](http://jsfiddle.net/NJXwH/)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-04T16:11:46.157

如果你想要一个带有缓动的无限循环（甚至是一个长度不确定的很长的动画），你需要将动画分成三个部分：

1.  一开始就缓过来
2.  动画一段时间/永远
3.  最后缓和

您的 easeIn 如此缓慢的原因是它的长度基于 60 秒的完整动画时间。jQuery 没有单独内置的缓动或缓动功能，因此您需要某种[jQuery Easing 插件](http://gsgd.co.uk/sandbox/jquery/easing/)才能使其工作。这是一个显示缓入的jsfiddle，缓出留给读者作为练习。

[http://jsfiddle.net/6ntJm/](http://jsfiddle.net/6ntJm/)

# mysql - 如何使用 codeigniter 创建另一个数据库连接

> ID：10014216
> 
> 赞同：0
> 
> 时间：2012-04-04T15:23:49.057
> 
> 标签：mysql, codeigniter

我需要连接到我正在执行的另一个 mysql 数据库

```
 $dsn = "{$dbdriver}://$vars[username]:$vars[password]@$vars[hostname]/$vars[database]";

    $db2 = $this->EE->load->database($dsn, true);
    $res = $db2->from('categories')->get()->result_array(); 
```

但我收到错误消息`Fatal error: Call to a member function result_array() on a non-object`

那是第三方脚本，所以数据库连接已经很早了。然后该脚本应该连接到另一个数据库，但已经创建了第一个数据库连接

`$dsn`包含正确的数据。为什么我会收到此错误？谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-04T15:30:39.617

也写入第二个数据库的参数`confid/database.php`。

```
$db['second_db']['hostname'] = 'localhost'; 
$db['second_db']['username'] = 'foo'; 
... 
```

和

```
$db2 = $this->EE->load->database('second_db', true); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-11T14:31:29.030

我已经想通了。查询应包含附加参数`db_debug=1`，因此 dsn 字符串应如下所示

```
$dsn = "mysql://$vars[username]:$vars[password]@$vars[hostname]/$vars[database]?db_debug=1"; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-10T05:49:19.407

如果您阅读 codeigniter 用户指南，您会很容易找到答案。标题是

连接到多个数据库

[https://www.codeigniter.com/user_guide/database/connecting.html](https://www.codeigniter.com/user_guide/database/connecting.html)

# visual-studio - 有没有人将 NUnit 与 Visual Studio 2010 集成？

> ID：10014223
> 
> 赞同：12
> 
> 时间：2012-04-04T15:24:05.470
> 
> 标签：visual-studio, nunit

有没有人将 NUnit 与 Visual Studio 集成？我正在尝试建立一个[像这样](http://machinesareus.blogspot.mx/2012/03/build-pipeline-for-net-apps-using-open.html)的构建管道。但是，我对 .NET 还是很陌生，而且我仍然了解事情是如何工作的。互联网上有很多关于 NUnit + VS 的资源，我很困惑。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-04-04T15:49:17.180

我建议您使用[Resharper](http://www.jetbrains.com/resharper/)。
正如一些人所说，“它只是工作”。
在您的情况下，这种选择的缺点/副作用可能是：
1\. Resharper 不是免费的；
2\. 运行单元测试是 Resharper 的一小部分——它还包括大量其他功能，您现在可能不需要这些功能（但您可以在设置中禁用大部分功能）。

免费解决方案是 - [Visual Nunit 2010](http://visualstudiogallery.msdn.microsoft.com/c8164c71-0836-4471-80ce-633383031099) Visual Studio 扩展。免费并完全按照您的意愿行事。

* * *

**更新**
如何将 NUnit 添加到您的项目中。
我找到[了这个教程](http://weblogs.asp.net/aghausman/archive/2009/08/08/getting-started-with-unit-testing-in-c.aspx)。一步一步地跟着它，我发现它对 .NET 新手很有帮助而且很完整。

唯一的区别是，在`Running Unit-Tests`运行测试部分，作者使用分布在 NUnit 本身内的测试运行器工具，但您可以使用[JetBrains 文档中描述的ReSharper 运行器](http://www.jetbrains.com/resharper/features/unit_testing.html)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-08-02T13:56:05.740

我正在使用这个：http: [//visualstudiogallery.msdn.microsoft.com/c8164c71-0836-4471-80ce-633383031099](http://visualstudiogallery.msdn.microsoft.com/c8164c71-0836-4471-80ce-633383031099)

这对我来说效果很好。您可以在 VS2010 中从 View->Other Windows->Visual NUnit 访问它

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-14T13:58:17.407

我使用了 TestDriven，直到它不再免费，我使用了 Resharper，但觉得它太慢了我的机器，我尝试了 VisualNUnit 扩展，但它似乎产生了多个自身的进程，这些进程会保留我的一些 DLL，我补充说NUnit 本身作为 Visual Studio 工具下的命令（并且还带有工具栏按钮和 Visual Studio 中的一些宏来启动当前测试和附加），但是设置起来需要一些努力，并且在被工具宠坏后感觉不够流畅像测试驱动。最终我尝试**[了 NCrunch](http://www.ncrunch.net/)** ......从那以后我就迷上了它，我什至开始喜欢它而不是 TestDriven！我的“NUnit 存储桶列表”中的下一个工具将是[Visual Studio 11 的 NUnit 扩展](http://nunit.org/index.php?p=vsTestAdapter&r=2.6)。

PS：NCrunch 应该可以在您的 Visual Studio 2010 上运行，并且主页上有一个非常不错的演示视频。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-10-22T06:26:27.400

首先下载并安装 NUnit

第 1 步：打开 Visual Studio

第 2 步：打开您的项目

步骤 3：从解决方案资源管理器中选择属性

第 4 步：在属性窗口中选择 Debug 选项

第 5 步：选择“启动操作”部分下的“启动外部程序”

第六步：选择NUnit文件的路径

第七步：保存。

之后，当您调试项目时，NUnit 将打开。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-04-04T16:04:55.267

Visual Studio 2011(BETA) 与 2010 兼容，并提供开箱即用的测试运行器。请参阅[Visual Studio 11 Beta 单元测试 - 新增功能](http://www.dotnetcurry.com/ShowArticle.aspx?ID=790)和[Visual Studio 11 Beta - 单元测试插件列表](http://blogs.msdn.com/b/visualstudioalm/archive/2012/03/02/visual-studio-11-beta-unit-testing-plugins-list.aspx)。对于持续集成 (CI) 服务器，U 可以使用[TeamCity](http://www.jetbrains.com/teamcity/)并在服务器上运行这些测试。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-04-04T16:09:18.787

原始且仍然相当不错的测试运行器。

[测试驱动的.net](http://testdriven.net/)

以前是免费的，但现在要收取少量费用，除非您是学生或开源开发人员。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-04-04T15:54:06.193

[使用 NUnit 设置 Visual C#2010 Express](http://joger.net/?p=88 "使用 NUnit 设置 Visual C#2010 Express")

# c# - C# 使用部分值计算存在的注册表项

> ID：10014225
> 
> 赞同：0
> 
> 时间：2012-04-04T15:24:09.280
> 
> 标签：c#, registry, registrykey

```
Microsoft.Win32.RegistryKey registryPath = Microsoft.Win32.Registry.LocalMachine.OpenSubKey(@"SOFTWARE\Wow6432Node\Testing");

Microsoft.Win32.RegistryKey entryKey = registryPath.OpenSubKey("Entry Point"); 
```

我在测试中有很多键，格式为：“入口点 011”、“入口点 123” - 所以入口点后面有随机数。

我可以搜索上面的 registryPath 变量并计算包含“入口点”关键字的键的数量吗？假设还存在其他没有此关键字的键。

目前，我一直在使用 for 循环并循环所有可能的组合以获取所有键的计数，检查键是否存在，但是由于键高达“入口点 9000”，因此具有 for 循环执行 9000 次是非常低效的。

```
 for (int i = 0; i <= highestEntryPointValue; i++)
 {
     Microsoft.Win32.RegistryKey entryKey = steamApps64.OpenSubKey("Entry Point " + Convert.ToString(i));

     if (entryKey != null)
     {
         count++;
     }
 } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-04T15:29:17.233

此示例效率不高，因为它将计数（例如）直到 9000，但是如果只有 3 个键 EntryPoint 011、EntryPoint 123、EntryPoint 9000 怎么办。

单线答案

```
int count = Microsoft.Win32.Registry.LocalMachine.OpenSubKey(@"SOFTWARE\Wow6432Node\Testing").GetSubKeyNames().Where(s => s.StartsWith("EntryPoint")).Count(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-04T15:31:46.293

Microsoft.Win32.RegistryKey 有一个名为 GetSubKeyNames() 的方法，它返回一个带有名称的字符串数组。

```
string[] keys = registryPath.GetSubKeyNames(); 
```

现在您可以循环访问这些键并检查它们的名称，而不会徒劳地打开注册表

```
var subKeys = Array.FindAll(keys, key => key.Substring(0, 11) == "Entry Point"));
int count = subKeys.Lenght;
foreach(string s in subKeys)
..... 
```

# ios - iOS Provisioning Portal：如何使用 Xcode 创建企业分发证书？

> ID：10014229
> 
> 赞同：4
> 
> 时间：2012-04-04T15:24:18.627
> 
> 标签：ios, xcode, enterprise, ios-provisioning

对于企业帐户，创建分发证书的*推荐方式是什么？*如果我查看 iOS 配置门户中的分发选项卡，我会在顶部看到此免责声明：

> 重要提示：Xcode 是请求和自动安装此证书的首选方法。在继续之前，请阅读[iOS 工具工作流程指南](https://developer.apple.com/library/ios/documentation/Xcode/Conceptual/ios_development_workflow/00-About_the_iOS_Application_Development_Workflow/introduction.html#//apple_ref/doc/uid/TP40007959)。

我在该指南中没有看到任何讨论企业分发或 Xcode 如何为您生成和提交 CSR 的内容。

我当然可以手动创建和提交 CSR，但如果 Xcode 现在处理这类事情，我更愿意这样做。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-04T15:30:01.540

当你创建一个新的配置文件时，XCode 会自动为你做这件事，假设一个有效的证书还不存在。

如果您进入 XCode Organizer，您应该会在窗口底部看到一个“新建”按钮（在“导入”和“导出”旁边）。

当您选择“新建”时，系统会要求您提供开发者帐户详细信息 - 如果您的计算机上**没有**安装现有证书，XCode 会询问它是否应该请求新证书。分发证书的过程相同 - 但是，您用于通过 XCode 登录的帐户*必须*是团队分发者。

这一切都很好，但根据 Apple 的文档：

> Xcode 不下载分发配置文件。您必须通过 Web 浏览器下载分发配置文件并将它们拖到 Dock 中的 Xcode 图标上。

因此，虽然它对开发非常有用，但对分发却没有那么有用：您当然可以在 XCode 中请求证书，但您仍然必须前往供应门户下载配置文件！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-28T05:54:46.420

但是在配置文件中：在分发选项卡下：Apple 说：Xcode 是请求和自动安装此证书的首选方法。

因此，这也应该适用于分发。

# .net - .NET 中的多个设置文件

> ID：10014239
> 
> 赞同：1
> 
> 时间：2012-04-04T15:24:42.617
> 
> 标签：.net, settings, settings.settings

我目前正在使用 My.Settings/Properties.Settings 来存储各种用户设置。其中许多设置都绑定到各种表单中的控件。

但是我想要更大程度的控制——特别是我希望能够重新加载或保存特定的设置组。使用内置的 Settings.settings 文件，我只能将这些设置作为一个组来处理。

我知道我可以创建其他设置文件，[这篇文章](http://www.dondraper.com/2011/01/easily-save-and-retrieve-application-and-user-settings-in-vb-net-or-c-apps/)（摘要部分）建议如果 Settings.settings 不存在，应用程序将在项目根目录中查找其他 .settings 文件，但这似乎不是对我来说（除非我做错了什么）：

> 它们提供了巨大的力量和灵活性。例如，您可以将自定义设置文件添加到项目中，以管理不同组中的设置。这允许您将一组或一组值的设置保存在单独的文件中，从而节省保存和加载时间。

我正在构建自己的 Settings 类并自己完成这一切，但这将是一种耻辱 - 内置功能非常适合我 - 只要我可以有多个设置文件。

**更新**： [本文](http://msdn.microsoft.com/en-us/library/aa730869%28v=vs.80%29.aspx#settingscs_topic5)建议您可以添加其他设置文件并将它们拖到“属性”文件夹中。不幸的是，我目前的项目是在 VB.Net 中，并且这种行为似乎没有被复制。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-05T08:11:57.727

看来，解决方案是根据需要添加尽可能多的额外 .settings 文件。在每个属性中，添加一个客户工具名称——在我的例子中，我选择了“我的”来匹配内置的 Setting.settings。

此后，您可以单独访问每个设置文件，如下所示：

```
My.Options1.Default.Foo = "bar"
My.Options2.Default.Foo = "bar"

My.Options1.Default.Save()
My.Options2.Default.Reload() 
```

*.default*是一个小麻烦，但除此之外，这似乎像我希望的那样工作。

# msbuild - 删除目录中的所有内容，除了 MSBuild 中的一个隐藏目录

> ID：10014240
> 
> 赞同：4
> 
> 时间：2012-04-04T15:24:43.917
> 
> 标签：msbuild

除了一个（隐藏的）子目录之外，删除目录全部内容的最佳方法是什么？谢谢！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-04T21:45:07.410

```
<Target Name="DeleteMe">
   <ItemGroup>
      <DeleteMe
         Include="$(PathRoot)/FolderToDelete/**/*.*"
         Exclude="$(PathRoot)/FolderToDelete/DoNotDeleteThisHiddenFolder/**/*.*"
         />
   </ItemGroup>
   <Delete Files="@(DeleteMe)" />
</Target> 
```

# svn - Jenkins CI：如何在 SVN 提交上触发构建

> ID：10014252
> 
> 赞同：79
> 
> 时间：2012-04-04T15:25:27.623
> 
> 标签：svn, continuous-integration, jenkins, jenkins-plugins

我需要设置哪些插件和插件功能才能让我的 Jenkins 工作在任何时候将代码提交到 SVN 项目时触发构建？

我已经安装了标准 SVN 插件和 SVN 标记插件，但我没有看到任何允许配置触发器的新功能。

* * *

## 回答 #1

> 赞同：86
> 
> 时间：2012-04-04T15:32:48.850

有两种方法可以解决这个问题：

我最初推荐第一个选项，因为它易于实施。一旦你的构建过程成熟，切换到第二个。

1.  轮询存储库以查看是否发生更改。如果两个提交在同一个轮询间隔内出现，这可能会“跳过”一个提交。 [关于如何在此处执行此操作的说明](https://dzone.com/articles/polling-subversion-jenkins)，请注意第四个屏幕截图，其中您在作业中配置了基于轮询存储库的“构建触发器”（使用类似 crontab 的配置）。

2.  将您的存储库配置为具有一个提交后挂钩，该挂钩通知 Jenkins 需要开始构建。 [此处插件的描述](https://plugins.jenkins.io/subversion/)，在“提交后挂钩”部分

SVN 标签功能不是轮询的一部分，它是将源代码的当前“头”提升为标签的一部分，以快照构建。这允许您将 Jenkins buid #32 称为 SVN 标签 /tags/build-32 （或类似的东西）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2017-10-18T06:31:13.587

您只需要一个插件，即 Subversion 插件。

然后简单地进入 Jenkins → job_name → *Build Trigger*部分 → (i) Trigger build remote (ie, from scripts) Authentication token: Token_name

转到 SVN 服务器的 hooks 目录，然后在触发以下命令后：

1.  `cp post-commit.tmpl post-commit`
2.  `chmod 777 post-commit`
3.  `chown -R www-data:www-data post-commit`
4.  `vi post-commit`

    **注意：**所有行都应注释 *最后添加以下行*

语法（适用于 Linux 用户）：

```
/usr/bin/curl http://username:API_token@localhost:8081/job/job_name/build?token=Token_name 
```

语法（适用于 Windows 用户）：

```
C:/curl_for_win/curl http://username:API_token@localhost:8081/job/job_name/build?token=Token_name 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-08-19T14:50:44.850

我使用带有一些 bash 的 Python 制作了一个工具来触发 Jenkins 构建。基本上，当提交到达 SVN 服务器时，您必须从提交后收集这两个值：

```
REPOS="$1"
REV="$2" 
```

然后你使用“svnlook dirs-changed $1 -r $2”来获取刚刚提交的路径。然后，您可以从中检查要构建的存储库。想象一下，您有数十万个项目。你不能检查整个存储库，对吧？

你可以从 GitHub 查看[我的脚本](https://github.com/dolphyvn/jenkinsci)。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2016-04-01T11:56:04.207

您可以使用提交后挂钩。

将提交后挂钩脚本放入`hooks`文件夹中，在您的 C:\ 驱动器中创建一个`wget_folder`，并将`wget.exe`文件放入此文件夹中。在名为的文件中添加以下代码`post-commit.bat`

```
SET REPOS=%1   
SET REV=%2

FOR /f "tokens=*" %%a IN (  
'svnlook uuid %REPOS%'  
) DO (  
SET UUID=%%a  
)  

FOR /f "tokens=*" %%b IN (  
'svnlook changed --revision %REV% %REPOS%'  
) DO (  
SET POST=%%b   
)

echo %REPOS% ----- 1>&2

echo %REV% -- 1>&2

echo %UUID% --1>&2

echo %POST% --1>&2

C:\wget_folder\wget ^   
    --header="Content-Type:text/plain" ^   
    --post-data="%POST%" ^   
    --output-document="-" ^   
    --timeout=2 ^     
    http://localhost:9090/job/Test/build/%UUID%/notifyCommit?rev=%REV% 
```

其中测试 = 工作名称

`echo`用于查看值，您也可以`exit 2`在末尾添加以了解问题以及提交后挂钩脚本是否正在运行。

# node.js - 您如何运行一个在循环中提取数据并在循环结束时获取数据的函数？

> ID：10014259
> 
> 赞同：1
> 
> 时间：2012-04-04T15:25:52.130
> 
> 标签：node.js, loops

这是我想要做的。我的第一个函数循环遍历一组用户 ID，并构建一组用户名以在控制台中显示。这是使用 node.js。

```
function Function1(){
    for (var i = 0; i < array.length; i++){
        if (array[i] !== '') {
                GetUserName(votelog[i]);
        }
    }
    console.log(array2);
    }
}

function GetUserName(userid){
    client.query("SELECT `username` FROM " + config.database.tablenames.user + " WHERE `userid` = '" + userid + "'",
                function selectCb(err, results, fields) {
                    if (err) { throw err; }
                    console.log(results);
                    console.log(fields);
                    client.end();
                    array2.push(results.username);
                });
} 
```

然而`array2`是空白。我已经看到 JavaScript 在调用函数时不会像 C# 那样停止。我将如何重写它以使其按预期工作？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-04T16:49:50.580

对此有几个答案，可能“正确”的方法是不要像那样单独获取每个用户名，而是编写查询以一次返回所有用户名。如果要保留单个用户名查询，可以执行以下操作：

```
function Function1(){
    for (var i = 0; i < array.length; i++){
        if (array[i] !== '') {
            GetUserName(array[i], function(result) {
                array2.push(result);
                //  Verify that all of the results have come back
                if(array2.length == array.length) {
                    console.log(array2);
                }
            });
        }
    }
}

function GetUserName(userid, callback){
    client.query("SELECT `username` FROM " + config.database.tablenames.user + " WHERE     `userid` = '" + userid + "'",
    function selectCb(err, results, fields) {
        if (err) { throw err; }
        console.log(results);
        console.log(fields);
        client.end();
        callback(results.username);
    });
} 
```

我添加的是对 console.log 回调的条件，仅当返回的用户名数量等于原始数组中的用户 ID 数量时。这表明所有查询都已完成。

您还必须处理 GetUserName 中存在错误的情况，因为这可能会导致 console.log() 永远不会被调用，假设您计划处理错误而不只是让它崩溃您的应用程序。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-04T16:00:38.293

免责声明；我自己不太习惯 JavaScript（或 Node）。无论如何，我的看法可能是这样的：

```
function Function1(){
    for (var i = 0; i < array.length; i++){
        if (array[i] !== '') {
            GetUserName(votelog[i], function(result) {
                array2.push(result);
            });
        }
    }
    console.log(array2);
}

function GetUserName(userid, callback){
    client.query("SELECT `username` FROM " + config.database.tablenames.user + " WHERE     `userid` = '" + userid + "'",
                function selectCb(err, results, fields) {
                    if (err) { throw err; }
                    console.log(results);
                    console.log(fields);
                    client.end();
                    callback(results.username);
                });
} 
```

# sql - SQLite - 选择表达式很慢

> ID：10014262
> 
> 赞同：2
> 
> 时间：2012-04-04T15:25:56.203
> 
> 标签：sql, sqlite

我在 SQLite 中的查询遇到了一些严重的性能问题。目前，表 activity_tbl 中有大约 20000 个条目，表**activity_data_tbl****中**有大约 40个条目。我对下面查询中使用的两列都有一个索引，但它似乎对性能没有任何影响。

 **```
SELECT a._id, a.start_time + b.length AS time 
FROM activity_tbl a INNER JOIN activity_data_tbl b 
       ON a.activity_data_id = b._data_id 
WHERE time > ? 
ORDER BY 2 
LIMIT 1 
```

如您所见，我选择一列和一个通过将两列相加而创建的值。我想这是导致性能低下的原因，因为如果我只选择 a.start_time 或 b.length，查询会非常快。

你们对我如何优化这个有什么建议吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-04T15:51:05.130

This query is not optimizable using indexes for the filter part since you are filtering and ordering on a calculated value. To optimize the query you will either need to filter on one of the actual table columns (starttime or length) or pre-compute the time values before querying.

The only place an index will help, and I assume you have one, is on b.data_id.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-04T15:32:23.877

尝试在时间列上放置一个索引。这应该加快查询

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-12-02T17:00:58.843

复合索引可能会有所帮助。根据其文档，如果索引有足够的信息，SQLite 会尝试避免访问该表。因此，如果引擎完成了它的作业，它将认识到索引足以计算 where 子句的值并节省一些时间。如果它不起作用，则只有预计算会起作用。

如果你经常遇到类似的任务，请阅读：[http ://www.sqlite.org/rtree.html](http://www.sqlite.org/rtree.html)**

# javascript - 删除 jquery/zepto 对主干路由器和视图的依赖

> ID：10014263
> 
> 赞同：5
> 
> 时间：2012-04-04T15:26:01.197
> 
> 标签：javascript, jquery, web-applications, backbone.js, client-side

是否有一个分叉/维护版本的主干完全消除了 jquery 或 zepto 使用路由器和视图的需要？

我不介意使用主干，但是我没有办法在我的页面上强制使用 jquery 依赖项来使用它。

如果不存在解决方案，有人可以发布需要准确更改的要点吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-04-04T17:42:07.103

如果您希望 Backbone 处理 DOM 操作、DOM 事件和 AJAX 请求，那么您将需要另一个库来执行此操作。它不必是 jQuery 或 Zepto - Backbone 也支持 Ender，理论上你可以使用任何可以进行 DOM 选择并支持 jQuery 样式方法子集的库。快速浏览带[注释的源代码](http://documentcloud.github.com/backbone/docs/backbone.html)表明您需要以下方法：

*   `$(selector)`
*   `$.ajax()`
*   `$(selector).find()`
*   `$(selector).bind()`
*   `$(selector).unbind()`
*   `$(selector).delegate()`
*   `$(selector).remove()`
*   `$(selector).attr()`
*   `$(selector).html()`

如果您不希望 Backbone 处理这些东西，您可以通过覆盖使用它们的方法来轻松删除需求 - 例如，您可以省去`.attr()`并`.html()`通过设置`Backbone.View.prototype.make = function() {}`. 或者只是不使用`Backbone.View`- 这消除了对所有内容的需要，但是`$.ajax()`（除非您正在使用`pushState`，在这种情况下您也需要事件绑定）。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-07-13T17:43:09.483

是的，这是一个：[https](https://github.com/inkling/backbone.native) ://github.com/inkling/backbone.native 。它是一个微型适配器，允许 Backbone 在仅依赖本机 DOM API 的同时工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-11-13T10:24:57.970

您可以尝试使用[jBone](https://github.com/kupriyanenko/jbone)，这是现代浏览器中用于 DOM 操作的库，jBone 专门为 Backbone 开发，只有 2kb gzipped 和类似 jQuery 的 API。

# c++ - 布尔总是评估为真

> ID：10014264
> 
> 赞同：3
> 
> 时间：2012-04-04T15:26:05.323
> 
> 标签：c++, boolean

我正在制作一个程序，您需要使用 bool 函数来确定三个数字在用户输入时是否按升序排列。但是，bool 函数的计算结果始终为真。我错过了什么？这是我的代码：

```
#include <iostream>
#include <string>

using namespace std;

bool inOrder(int first, int second, int third)
{
    if ((first <= second) && (second <= third))
    {
        return true;
    }

    else
    {
        return false;
    }
}

int main()
{
    int first, second, third;

    cout << "You will be prompted to enter three numbers." << endl;
    cout << "Please enter your first number: ";
    cin >> first;
    cout << "Please enter your second number: ";
    cin >> second;
    cout << "Please enter your third and final number: ";
    cin >> third;
    cout << endl;

    inOrder(first, second, third);

    if (inOrder)
    {
        cout << "Your numbers were in ascending order!" << endl;
    }

    else
    {
        cout << "Your numbers were not in ascdending order." << endl;
    }

    return 0;
} 
```

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-04-04T15:28:04.920

您需要实际调用该函数：

```
if (inOrder(first, second, third)) 
```

这

```
if (inOrder) 
```

总是评估为真，因为它确实检查函数指针是否为非空。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-04-04T15:27:38.100

您必须存储函数的返回值，并对其进行测试——或者直接测试函数。所以：

```
bool result = inOrder(first, second, third);

if (result)
{
(...) 
```

或者：

```
if (inOrder(first, second, third)
{
(...) 
```

总是评估为真的原因`if(inOrder)`是它检查`inOrder()`函数的地址，该地址非零。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-04T15:28:30.757

可能是你的意思

```
if (inOrder(first, second, third)) 
```

代替

```
inOrder(first, second, third);

if (inOrder) 
```

当你说`if (inOrder)`你实际上没有调用函数并检查结果时，而是使用变量 inOrder 作为条件，它只不过是指向函数入口点的指针，它总是评估为真。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-04-04T15:35:13.113

试试这个：

```
bool b = inOrder(first, second, third);
if(b){.....} 
```

你没有从`inOrder`函数中获取结果

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-04-04T15:29:45.450

这总是`true`因为您将函数的地址传递给您的 if 条件。由于函数永远不会位于地址 0，因此条件始终为真。您需要存储函数的返回值：

```
bool ordered = inOrder(first, second, third); 
```

或在 if 中调用函数：

```
if (inOrder(first, second, third)) 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-04-04T15:37:04.843

这是工作副本。您需要存储函数调用中的 o/p。

```
#include <iostream>
#include <string>

using namespace std;

bool inOrder(int first, int second, int third)
{
    if ((first <= second) && (second <= third))
    {
        return true;
    }

    else
    {
        return false;
    }
}

int main()
{
    int first, second, third;

    cout << "You will be prompted to enter three numbers." << endl;
    cout << "Please enter your first number: ";
    cin >> first;
    cout << "Please enter your second number: ";
    cin >> second;
    cout << "Please enter your third and final number: ";
    cin >> third;
    cout << endl;
    bool isordered;
    isordered = inOrder(first, second, third);

    if (isordered)
    {
        cout << "Your numbers were in ascending order!" << endl;
    }

    else
    {
        cout << "Your numbers were not in ascdending order." << endl;
    }

    return 0;
} 
```

# php - 如果 else 语句在 PHP 代码中间打开了一个 alert() 函数，我该如何继续？

> ID：10014267
> 
> 赞同：0
> 
> 时间：2012-04-04T15:26:29.700
> 
> 标签：php, if-statement, alert

我有一个申请许可证的系统，当他们选择他们想申请的许可证时，他们将提交表格，系统将检查他们是否有任何与先决条件相同的先前申请的许可证。

一般来说：如果他们不满足先决条件，系统应该会弹出一个窗口并告诉他们'对不起，您没有预先要求的许可证'。

其他系统将检查他们之前是否完成了医疗问卷。如果他们确实有一份现有的医疗问卷，系统将存储申请详细信息并转到 apply_successful.php 页面。否则系统会将他们带到 medical_questions.php 进行问卷调查。

我试着把代码写出来，但在某个时候卡住了。

到目前为止我试过这个：

```
<?php
session_start();
include'Connections/database.php';
$conn = dbConnect ();
    if (! $conn)
    die("Couldn't connect to MySQL");

    $user = $_SESSION['eid'];
    $selectedPermit=$_POST['cat'];
    //print_r($selectedPermit);
    foreach($selectedPermit as $permit)
    {
        $query="SELECT t.PREREQ1, t.PREREQ2, (CASE WHEN (t.PREREQ1 IS NOT NULL) AND (p1.PTYPE IS NULL) THEN 1 ELSE 0 END) AS missing1, (CASE WHEN (t.PREREQ2 IS NOT NULL) AND (p2.PTYPE IS NULL) THEN 1 ELSE 0 END) AS missing2 FROM type AS t LEFT JOIN permit AS p1 ON (t.PREREQ1=p1.ptype) AND ( p1.EID = '$user' ) AND (p1.STATUS='approved') LEFT JOIN permit AS p2 ON (t.PREREQ2=p2.ptype) AND ( p2.EID = '$user' ) AND (p2.STATUS='approved') WHERE t.PTYPE = '$permit' ";
        $result=mysql_query($query,$conn);
        $row=mysql_fetch_assoc($result);
        $missing1=$row['missing1'];
        $missing2=$row['missing2'];

        if($missing1=='1' or $missing2=='1')
        {
            echo '<script>alert("Sorry. You did have not met the Pre-Requisites for '.$permit .'");</script>';
            header ('Location:s_apply2.php');
        }
   }

   foreach($selectedPermit as $permit)
   {
       $query="SELECT PTYPE FROM permit WHERE EID=$user";
       $result=mysql_query($query);

       while($row=mysql_fetch_assoc($result))
       {

          if($row['PTYPE'] == $permit)
          {
              //echo"You have applied for this permit.";
              echo '<script>alert("You have applied for '.$permit .'");</script>';
              header ('Location:s_apply2.php');
          }
       }
   }

  foreach($selectedPermit as $permit)
  {
      $query="SELECT MED FROM emp WHERE EID='$user'";
      $result=mysql_query($query,$conn);
      $row=mysql_fetch_assoc($result);
      $med=$row['MED'];

      if ($med == 'yes')
      {
          $query = "INSERT INTO permit (EID, PTYPE) VALUES ('$user','$permit' )";
          header('Location:s_apply_success.php'); 
      }
      else
      {
          header('Location:medical_question.php');
      }
      mysql_query($query);
  }
  dbDisconnect($conn);  

?> 
```

我重组了整个页面并使其在逻辑上正确。但是我不确定我用来回显脚本的方式是否正确。

我想知道是否有人可以评论这段代码？

非常感谢...非常感谢您的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-04T15:32:25.293

我猜你的意思是javascript alert() 函数？在这种情况下，您应该只回显一些这样的 javascript：

```
echo '<script>alert("error");</script>'; 
```

不过，请注意您在 HTML 中的回显位置，因为它当然不会在每个地方都有效。最好的部分在标签内。

# javascript - 生成人类可区分的随机颜色

> ID：10014271
> 
> 赞同：67
> 
> 时间：2012-04-04T15:26:39.543
> 
> 标签：javascript, jquery

我正在尝试在 javascript 中随机生成十六进制颜色。

然而，生成的颜色几乎无法相互区分。
有没有办法改进它？

* * *

这是我正在使用的代码：

```
function randomColor(){
   var allowed = "ABCDEF0123456789", S = "#";

   while(S.length < 7){
       S += allowed.charAt(Math.floor((Math.random()*16)+1));
   }
   return S;
} 
```

* * *

我听说了一些有关*HSL*和*HSV*颜色模型的信息，但无法让它在我的代码中工作。请帮忙。

提前致谢

* * *

## 回答 #1

> 赞同：67
> 
> 时间：2013-11-21T18:55:29.000

选择最大不同颜色的最简单方法是使用 HSL 值而不是 RGB，然后操纵色调，因为它的值从 0 到 360 值并环绕（0 是红色，360 也是如此）；

如果您需要 10 种可区分的颜色，您可以将 360 除以 10，然后通过将值乘以索引（从零开始）来选择单个颜色。这是一个示例函数，可让您从中选择颜色：

```
function selectColor(colorNum, colors){
    if (colors < 1) colors = 1; // defaults to one color - avoid divide by zero
    return "hsl(" + (colorNum * (360 / colors) % 360) + ",100%,50%)";
} 
```

这样，您可以通过随机化索引来随机化颜色选择，但颜色将始终位于同一调色板中。

这将从 10 个调色板中选择一种随机颜色：

```
var color = selectColor(Math.floor(Math.random() * 10), 10); 
```

这也将是：

```
var color = selectColor(Math.floor(Math.random() * 999), 10); 
```

或者您可以从调色板中选择特定颜色，例如 13 种调色板中的第 9 种颜色（索引 8）：

```
var color = selectColor(8, 13); 
```

这是一个可以玩的小提琴：http: [//jsfiddle.net/2UE2B/](http://jsfiddle.net/2UE2B/)

**2020-02-23 更新：**

所以，今天我需要解决同样的问题。在这里谷歌搜索这个答案（我知道，在 SO 上寻找东西的一种非常奇怪的方式）我遇到了[黄金角](https://en.wikipedia.org/wiki/Golden_angle)的概念。它会使上面的例子更加简单，并且不需要提供预定数量的颜色：

```
function selectColor(number) {
  const hue = number * 137.508; // use golden angle approximation
  return `hsl(${hue},50%,75%)`;
} 
```

这回答了@netoperator-wibby 的问题

* * *

## 回答 #2

> 赞同：32
> 
> 时间：2015-08-04T19:33:24.553

[![例子](../Images/93d869f362c48950656a1f563c4353de.png)](https://i.stack.imgur.com/8hAI6.png)

我知道我参加这个聚会已经很晚了，但我写了一个更精细的函数来为另一个项目生成一组对比鲜明的随机颜色。它们都（至少在某种程度上）有吸引力且真正随机（不是基于预定义的颜色），但我的代码比其他一些响应要复杂一些（所以它不仅仅是为了获得基础知识）

这适用于希望在其页面上拥有一种以上随机颜色并希望确保没有两种颜色过于相似的用户。

[小提琴](http://jsfiddle.net/Scelesto/09xq97bo/4/)

```
var generateRandomColors=function(number){
/*
This generates colors using the following algorithm:
Each time you create a color:
    Create a random, but attractive, color{
        Red, Green, and Blue are set to random luminosity.
        One random value is reduced significantly to prevent grayscale.
        Another is increased by a random amount up to 100%.
        They are mapped to a random total luminosity in a medium-high range (bright but not white).
    }
    Check for similarity to other colors{
        Check if the colors are very close together in value.
        Check if the colors are of similar hue and saturation.
        Check if the colors are of similar luminosity.
        If the random color is too similar to another,
        and there is still a good opportunity to change it:
            Change the hue of the random color and try again.
    }
    Output array of all colors generated
*/
    //if we've passed preloaded colors and they're in hex format
    if(typeof(arguments[1])!='undefined'&&arguments[1].constructor==Array&&arguments[1][0]&&arguments[1][0].constructor!=Array){
        for(var i=0;i<arguments[1].length;i++){ //for all the passed colors
            var vals = /^#?([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})$/i.exec(arguments[1][i]); //get RGB values
            arguments[1][i]=[parseInt(vals[1], 16),parseInt(vals[2], 16),parseInt(vals[3], 16)]; //and convert them to base 10
        }
    }
    var loadedColors=typeof(arguments[1])=='undefined'?[]:arguments[1],//predefine colors in the set
        number=number+loadedColors.length,//reset number to include the colors already passed
        lastLoadedReduction=Math.floor(Math.random()*3),//set a random value to be the first to decrease
        rgbToHSL=function(rgb){//converts [r,g,b] into [h,s,l]
            var r=rgb[0],g=rgb[1],b=rgb[2],cMax=Math.max(r,g,b),cMin=Math.min(r,g,b),delta=cMax-cMin,l=(cMax+cMin)/2,h=0,s=0;if(delta==0)h=0;else if(cMax==r)h=60*((g-b)/delta%6);else if(cMax==g)h=60*((b-r)/delta+2);else h=60*((r-g)/delta+4);if(delta==0)s=0;else s=delta/(1-Math.abs(2*l-1));return[h,s,l]
        },hslToRGB=function(hsl){//converts [h,s,l] into [r,g,b]
            var h=hsl[0],s=hsl[1],l=hsl[2],c=(1-Math.abs(2*l-1))*s,x=c*(1-Math.abs(h/60%2-1)),m=l-c/2,r,g,b;if(h<60){r=c;g=x;b=0}else if(h<120){r=x;g=c;b=0}else if(h<180){r=0;g=c;b=x}else if(h<240){r=0;g=x;b=c}else if(h<300){r=x;g=0;b=c}else{r=c;g=0;b=x}return[r,g,b]
        },shiftHue=function(rgb,degree){//shifts [r,g,b] by a number of degrees
            var hsl=rgbToHSL(rgb); //convert to hue/saturation/luminosity to modify hue
            hsl[0]+=degree; //increment the hue
            if(hsl[0]>360){ //if it's too high
                hsl[0]-=360 //decrease it mod 360
            }else if(hsl[0]<0){ //if it's too low
                hsl[0]+=360 //increase it mod 360
            }
            return hslToRGB(hsl); //convert back to rgb
        },differenceRecursions={//stores recursion data, so if all else fails we can use one of the hues already generated
            differences:[],//used to calculate the most distant hue
            values:[]//used to store the actual colors
        },fixDifference=function(color){//recursively asserts that the current color is distinctive
            if(differenceRecursions.values.length>23){//first, check if this is the 25th recursion or higher. (can we try any more unique hues?)
                //if so, get the biggest value in differences that we have and its corresponding value
                var ret=differenceRecursions.values[differenceRecursions.differences.indexOf(Math.max.apply(null,differenceRecursions.differences))];
                differenceRecursions={differences:[],values:[]}; //then reset the recursions array, because we're done now
                return ret; //and then return up the recursion chain
            } //okay, so we still have some hues to try.
            var differences=[]; //an array of the "difference" numbers we're going to generate.
            for(var i=0;i<loadedColors.length;i++){ //for all the colors we've generated so far
                var difference=loadedColors[i].map(function(value,index){ //for each value (red,green,blue)
                    return Math.abs(value-color[index]) //replace it with the difference in that value between the two colors
                }),sumFunction=function(sum,value){ //function for adding up arrays
                    return sum+value
                },sumDifference=difference.reduce(sumFunction), //add up the difference array
                loadedColorLuminosity=loadedColors[i].reduce(sumFunction), //get the total luminosity of the already generated color
                currentColorLuminosity=color.reduce(sumFunction), //get the total luminosity of the current color
                lumDifference=Math.abs(loadedColorLuminosity-currentColorLuminosity), //get the difference in luminosity between the two
                //how close are these two colors to being the same luminosity and saturation?
                differenceRange=Math.max.apply(null,difference)-Math.min.apply(null,difference),
                luminosityFactor=50, //how much difference in luminosity the human eye should be able to detect easily
                rangeFactor=75; //how much difference in luminosity and saturation the human eye should be able to dect easily
                if(luminosityFactor/(lumDifference+1)*rangeFactor/(differenceRange+1)>1){ //if there's a problem with range or luminosity
                    //set the biggest difference for these colors to be whatever is most significant
                    differences.push(Math.min(differenceRange+lumDifference,sumDifference));
                }
                differences.push(sumDifference); //otherwise output the raw difference in RGB values
            }
            var breakdownAt=64, //if you're generating this many colors or more, don't try so hard to make unique hues, because you might fail.
            breakdownFactor=25, //how much should additional colors decrease the acceptable difference
            shiftByDegrees=15, //how many degrees of hue should we iterate through if this fails
            acceptableDifference=250, //how much difference is unacceptable between colors
            breakVal=loadedColors.length/number*(number-breakdownAt), //break down progressively (if it's the second color, you can still make it a unique hue)
            totalDifference=Math.min.apply(null,differences); //get the color closest to the current color
            if(totalDifference>acceptableDifference-(breakVal<0?0:breakVal)*breakdownFactor){ //if the current color is acceptable
                differenceRecursions={differences:[],values:[]} //reset the recursions object, because we're done
                return color; //and return that color
            } //otherwise the current color is too much like another
            //start by adding this recursion's data into the recursions object
            differenceRecursions.differences.push(totalDifference);
            differenceRecursions.values.push(color);
            color=shiftHue(color,shiftByDegrees); //then increment the color's hue
            return fixDifference(color); //and try again
        },color=function(){ //generate a random color
            var scale=function(x){ //maps [0,1] to [300,510]
                return x*210+300 //(no brighter than #ff0 or #0ff or #f0f, but still pretty bright)
            },randVal=function(){ //random value between 300 and 510
                return Math.floor(scale(Math.random()))
            },luminosity=randVal(), //random luminosity
                red=randVal(), //random color values
                green=randVal(), //these could be any random integer but we'll use the same function as for luminosity
                blue=randVal(),
                rescale, //we'll define this later
                thisColor=[red,green,blue], //an array of the random values
                /*
                #ff0 and #9e0 are not the same colors, but they are on the same range of the spectrum, namely without blue.
                Try to choose colors such that consecutive colors are on different ranges of the spectrum.
                This shouldn't always happen, but it should happen more often then not.
                Using a factor of 2.3, we'll only get the same range of spectrum 15% of the time.
                */
                valueToReduce=Math.floor(lastLoadedReduction+1+Math.random()*2.3)%3, //which value to reduce
                /*
                Because 300 and 510 are fairly close in reference to zero,
                increase one of the remaining values by some arbitrary percent betweeen 0% and 100%,
                so that our remaining two values can be somewhat different.
                */
                valueToIncrease=Math.floor(valueToIncrease+1+Math.random()*2)%3, //which value to increase (not the one we reduced)
                increaseBy=Math.random()+1; //how much to increase it by
            lastLoadedReduction=valueToReduce; //next time we make a color, try not to reduce the same one
            thisColor[valueToReduce]=Math.floor(thisColor[valueToReduce]/16); //reduce one of the values
            thisColor[valueToIncrease]=Math.ceil(thisColor[valueToIncrease]*increaseBy) //increase one of the values
            rescale=function(x){ //now, rescale the random numbers so that our output color has the luminosity we want
                return x*luminosity/thisColor.reduce(function(a,b){return a+b}) //sum red, green, and blue to get the total luminosity
            };
            thisColor=fixDifference(thisColor.map(function(a){return rescale(a)})); //fix the hue so that our color is recognizable
            if(Math.max.apply(null,thisColor)>255){ //if any values are too large
                rescale=function(x){ //rescale the numbers to legitimate hex values
                    return x*255/Math.max.apply(null,thisColor)
                }
                thisColor=thisColor.map(function(a){return rescale(a)});
            }
            return thisColor;
        };
    for(var i=loadedColors.length;i<number;i++){ //Start with our predefined colors or 0, and generate the correct number of colors.
        loadedColors.push(color().map(function(value){ //for each new color
            return Math.round(value) //round RGB values to integers
        }));
    }
    //then, after you've made all your colors, convert them to hex codes and return them.
    return loadedColors.map(function(color){
        var hx=function(c){ //for each value
            var h=c.toString(16);//then convert it to a hex code
            return h.length<2?'0'+h:h//and assert that it's two digits
        }
        return "#"+hx(color[0])+hx(color[1])+hx(color[2]); //then return the hex code
    });
} 
```

请注意，尽管在我的示例中我没有这样做，但这也可以用于向集合添加新的不同的随机颜色：

```
generateRandomColors(1,generateRandomColors(10)) 
```

* * *

## 回答 #3

> 赞同：31
> 
> 时间：2012-04-04T16:03:23.553

您可以使用一组固定的颜色，例如[jquery.color.js 插件](https://github.com/jquery/jquery-color)中列出的颜色。

jquery.color.js 插件的颜色列表：

```
Colors = {};
Colors.names = {
    aqua: "#00ffff",
    azure: "#f0ffff",
    beige: "#f5f5dc",
    black: "#000000",
    blue: "#0000ff",
    brown: "#a52a2a",
    cyan: "#00ffff",
    darkblue: "#00008b",
    darkcyan: "#008b8b",
    darkgrey: "#a9a9a9",
    darkgreen: "#006400",
    darkkhaki: "#bdb76b",
    darkmagenta: "#8b008b",
    darkolivegreen: "#556b2f",
    darkorange: "#ff8c00",
    darkorchid: "#9932cc",
    darkred: "#8b0000",
    darksalmon: "#e9967a",
    darkviolet: "#9400d3",
    fuchsia: "#ff00ff",
    gold: "#ffd700",
    green: "#008000",
    indigo: "#4b0082",
    khaki: "#f0e68c",
    lightblue: "#add8e6",
    lightcyan: "#e0ffff",
    lightgreen: "#90ee90",
    lightgrey: "#d3d3d3",
    lightpink: "#ffb6c1",
    lightyellow: "#ffffe0",
    lime: "#00ff00",
    magenta: "#ff00ff",
    maroon: "#800000",
    navy: "#000080",
    olive: "#808000",
    orange: "#ffa500",
    pink: "#ffc0cb",
    purple: "#800080",
    violet: "#800080",
    red: "#ff0000",
    silver: "#c0c0c0",
    white: "#ffffff",
    yellow: "#ffff00"
}; 
```

剩下的就是简单地[从 Javascript 对象中挑选一个随机属性](https://stackoverflow.com/questions/2532218/pick-random-property-from-a-javascript-object)。

```
Colors.random = function() {
    var result;
    var count = 0;
    for (var prop in this.names)
        if (Math.random() < 1/++count)
           result = prop;
    return result;
}; 
```

使用`Colors.random()`可能会为您提供人类可读的颜色。我什至在下面提供了一个示例。

```
(function(){
    Colors = {};
    Colors.names = {
        aqua: "#00ffff",
        azure: "#f0ffff",
        beige: "#f5f5dc",
        black: "#000000",
        blue: "#0000ff",
        brown: "#a52a2a",
        cyan: "#00ffff",
        darkblue: "#00008b",
        darkcyan: "#008b8b",
        darkgrey: "#a9a9a9",
        darkgreen: "#006400",
        darkkhaki: "#bdb76b",
        darkmagenta: "#8b008b",
        darkolivegreen: "#556b2f",
        darkorange: "#ff8c00",
        darkorchid: "#9932cc",
        darkred: "#8b0000",
        darksalmon: "#e9967a",
        darkviolet: "#9400d3",
        fuchsia: "#ff00ff",
        gold: "#ffd700",
        green: "#008000",
        indigo: "#4b0082",
        khaki: "#f0e68c",
        lightblue: "#add8e6",
        lightcyan: "#e0ffff",
        lightgreen: "#90ee90",
        lightgrey: "#d3d3d3",
        lightpink: "#ffb6c1",
        lightyellow: "#ffffe0",
        lime: "#00ff00",
        magenta: "#ff00ff",
        maroon: "#800000",
        navy: "#000080",
        olive: "#808000",
        orange: "#ffa500",
        pink: "#ffc0cb",
        purple: "#800080",
        violet: "#800080",
        red: "#ff0000",
        silver: "#c0c0c0",
        white: "#ffffff",
        yellow: "#ffff00"
    };
    Colors.random = function() {
        var result;
        var count = 0;
        for (var prop in this.names)
            if (Math.random() < 1/++count)
               result = prop;
        return { name: result, rgb: this.names[result]};
    };
    var $placeholder = $(".placeholder");
    $placeholder.click(function(){
        var color = Colors.random();
        $placeholder.css({'background-color': color.rgb});
        $("#color").html("It's " + color.name);
    });
})();
```

```
.placeholder {
    width: 150px;
    height: 150px;
    border: 1px solid black;
}
```

```
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<div class="placeholder"></div>
<span id="color">Click the square above.</span>
```

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2012-04-04T15:34:33.993

试试这个：

```
function getRandomColor() {
    var letters = '0123456789ABCDEF'.split('');
    var color = '#';
    for (var i = 0; i < 6; i++ ) {
        color += letters[Math.round(Math.random() * 15)];
    }
    return color;
} 
```

看看它在行动：http: [//jsfiddle.net/3wjgG/1/](http://jsfiddle.net/3wjgG/1/)

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2012-04-04T22:01:07.973

你说的是你不想生成随机颜色，你是说你想生成不同的颜色。
你可以在这里找到一个很好的教程：http: [//krazydad.com/tutorials/makecolors.php](http://krazydad.com/tutorials/makecolors.php)。

我使用教程中的相关代码制作了这个小提琴，演示了如何生成非重复颜色：

[http://jsfiddle.net/rGL52/](http://jsfiddle.net/rGL52/)

与教程代码的唯一区别是 makegradient() 函数返回一个颜色数组，您以后可以在页面中随意应用这些颜色。

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2012-04-04T15:41:46.290

对于随机生成的颜色，我倾向于采用如下简单的方法：

```
​function randomColor () {
    var max = 0xffffff;
    return '#' + Math.round( Math.random() * max ).toString( 16 );
}
​ 
```

我不知道你说的无法识别是什么意思。这种方法没有提供太多的定制，但至少可以很容易地防止数字太亮或太暗。

如果您想在生成的颜色之间提供更大的差距，您可以尝试减少允许的字符数。我过去使用过类似的方法，我只用作`0369cf`从中提取的字符池。将此与重复检查相结合往往会提供更多可区分的颜色，并且仅使用`#fff`3 字符语法。

这是修改为使用此方法的原始函数：

```
function randomColor(){
    var allowed = "0369cf".split( '' ), s = "#";
    while ( s.length < 4 ) {
       s += allowed.splice( Math.floor( ( Math.random() * allowed.length ) ), 1 );
    }
    return s;
} 
```

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2021-02-05T02:30:26.340

[![独特的色板](../Images/062d245a70fe90cf061f8a2bbad45f13.png)](https://i.stack.imgur.com/cdEu5.png)

我今天需要为我正在写的一门新课程解决这个问题，所以这是我的解决方案：

```
function getUniqueColor(n) {
    const rgb = [0, 0, 0];

  for (let i = 0; i < 24; i++) {
    rgb[i%3] <<= 1;
    rgb[i%3] |= n & 0x01;
    n >>= 1;
  }

  return '#' + rgb.reduce((a, c) => (c > 0x0f ? c.toString(16) : '0' + c.toString(16)) + a, '')
} 
```

它通过 RGB 值向后“传播”输入数字中的位。它并不完美，但代码紧凑且相邻颜色可区分。这是[小提琴](https://jsfiddle.net/smeans/6sok87y0/37/)。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2012-04-04T23:31:31.347

我同意所有的答案，我们真的不知道你在这里期望什么......

这是一种可能性，可以让您在 css 元素的 rgb(r, g, b) 输出和十六进制输出之间进行选择...

这是一个简单的例子，你只需要修改这个草稿，但它在 Firefox 上可以正常工作：

```
<script type="text/javascript">
    //<![CDATA[
        function RndColor(){
        var maximum = 255;
        var minimum = 100;
        var range = maximum - minimum;
        var red = Math.floor(Math.random()*range)+minimum;
        var green = Math.floor(Math.random()*range)+minimum;
        var blue = Math.floor(Math.random()*range)+minimum;
        var redToHex = red.toString(16);
        var greenToHex = green.toString(16);
        var blueToHex = blue.toString(16);
        this.rgbValue = "rgb(" + red + "," + green + "," + blue + ")";
        this.hexValue = "#" + redToHex + "" + greenToHex + "" + blueToHex;
    }
    RndColor.prototype.getRGB = function(){
        return this.rgbValue;
    }
    RndColor.prototype.getHex = function(){
        return this.hexValue;
    }
    //]]>
</script> 
```

然后您可以在下面检索值：

```
<script type="text/javascript">
//<![CDATA[
    rndCol = new RndColor();
    document.write("<div style = width:150px;height:100px;background-color:" + rndCol.getHex() + ">" + rndCol.getHex() + "</div><br /><br />");
    document.write("<div style = width:150px;height:100px;background-color:" + rndCol.getRGB() + ">" + rndCol.getRGB() + "</div>");
//]]>
</script> 
```

我希望这可以帮助你。最好的祝福。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2012-04-04T16:30:20.087

首先，为什么要从字符串构建十六进制值？只需使用数字作为值，然后输出类似`yourNumber.toString(16)`.

然后，为了使颜色更加鲜明，不要对每个颜色分量使用 0 到 255 的全部范围，而是可以使用 10 或 20 的跳跃，或者任何你需要产生足够大的差异的东西。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2018-09-24T01:06:37.223

我编写了一个名为 SwitchColors.js 的小脚本，可以在这里找到：[https ://github.com/akulmehta/SwitchColors.js](https://github.com/akulmehta/SwitchColors.js)

该脚本会产生更饱和的颜色，并且可以控制亮度。虽然它可能不会产生视觉上可区分的颜色，但它会产生高饱和度和明亮的颜色，这也很有吸引力。

# asp.net-mvc - Ninject/.NET MVC3 - 范围？

> ID：10014274
> 
> 赞同：0
> 
> 时间：2012-04-04T15:26:49.093
> 
> 标签：asp.net-mvc, asp.net-mvc-3, ninject

我是 .NET MVC 和 Ninject 的初学者。

这里我如何获得我的 Ninject 内核：使用 Ninject；

```
public class NinjectKernel
{
    private static IKernel _Instance = new StandardKernel();

    public static IKernel getInstance()
    {
            return _Instance;
    }
} 
```

以下是我如何保存我想要重用的对象的实例：

```
(...) NK = NinjectKernel.getInstance();
private Game getGameInstance() {
    IGame iGame;
    try
    {
        iGame = NK.Get<IGame>(DefaultGameName);
    }
    catch
    {
        NK.Bind<IGame>().To<Game>().InSingletonScope().Named(DefaultGameName)
            .WithConstructorArgument("ColorChoiceCount", 12)
            .WithConstructorArgument("CodeLength", 6)
            .WithConstructorArgument("TurnsToBePlayed", 8)
            .WithConstructorArgument("DoubleColorAllowed", true)
            ;
        iGame = NK.Get<IGame>(DefaultGameName);
    }
    return (Game)iGame;
} 
```

我希望 Game 对象在使用“会话”中可重用，这意味着如果他离开站点，则不会再次使用此实例。但是在当前情况下，在调试时，当我关闭应用程序并重新启动它时，我总是重新获取我之前的“会话”的实例。我还想知道我是否不会为多个用户获得相同的实例，因为我不想要这个。（用户可能经过身份验证，也可能未经过身份验证，现在他们根本没有）。

（您可能还建议我比在那里使用 try/catch 更好的解决方案，因为我确信必须有一个，但由于它有效，所以现在不是优先事项。）

谢谢您的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-04T15:48:18.793

你不必做任何这些。只需使用 Nuget 安装 Ninject.MVC3。这将自动设置项目以使用 MVC DependencyResolver API，并将创建一个 NinjectMVC3.cs 文件来创建您的映射。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-15T15:31:22.447

1.  您可以查看这篇出色且易于遵循的帖子，了解 Ninject 与 MVC 3 / 4 的用法：http: [//dotnetfever.com/implementing-dependency-injection-in-asp-net-mvc-4-using-ninject-di -容器/](http://dotnetfever.com/implementing-dependency-injection-in-asp-net-mvc-4-using-ninject-di-container/)

2.  我建议您重新设计您的 Web 应用程序并避免在“会话”中重用游戏对象。原因是 Web 应用程序被设计为“无状态”，这意味着它不会跨多个请求记住用户的数据。无状态特性可以帮助您的 Web 应用程序获得更好的性能和更好的可扩展性。

如果您确实需要记住一个用户的游戏对象，只要他在您的站点中，那么请尝试在每个请求上构建游戏对象。如果建筑物非常昂贵（例如连接到数据库），则使用 asp.net 缓存来存储对象以供以后重用。

总之，使用缓存而不是 Ninject 来保存游戏对象。

# visual-c++ - 如何在 windows mobile 6.53 上增加 sip qwerty 键盘的大小？(VC++)

> ID：10014275
> 
> 赞同：1
> 
> 时间：2012-04-04T15:26:50.823
> 
> 标签：visual-c++, windows-mobile-6.5

在输入文本字段中，用户点击软输入面板键盘将其调出。不幸的是，钥匙太小了！VC++（VS2008）有没有办法调整它的大小，使按钮更大？

我不知道人们是如何使用它的——按键太小了，即使使用手写笔，最终也会键入错误的按键。我不知道如何将 SIP 面板的大小从默认的 80 像素增加到更大的值。我找到了这个 SIP 示例，但它没有设置大小 C:\Program Files\Windows Mobile 6 SDK\Samples\PocketPC\CPP\win32\HandleSIP

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-24T16:24:36.293

这并不简单，但您可以提供自定义软输入面板 (SIP)。

MSDN 有一篇名为[Programming a Software-Based Input Panel](http://msdn.microsoft.com/en-us/library/aa929815.aspx)的文章详细介绍了该技术。

# sql - DB2 控制中心：显示现有表的 SQL

> ID：10014278
> 
> 赞同：0
> 
> 时间：2012-04-04T15:27:01.353
> 
> 标签：sql, db2

我在 DB2 Control Center 中直观地创建了一个表。在创建表之后，DB2 中是否有方法或命令显示创建表的 SQL 源代码？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-04T16:32:49.977

有一个名为 db2look（命令行）的 DB2 工具可以生成用于创建所有数据库对象（表、视图、约束...）的 DDL 脚本。查看命令选项以使其仅创建 1 个表及其约束的 DDL。

```
db2look -d YourDatabaseName -e -t YourTableName -o YourTableName.sql 
```

# c# - LINQ 相交但将结果添加到新列表

> ID：10014279
> 
> 赞同：2
> 
> 时间：2012-04-04T15:27:01.490
> 
> 标签：c#, linq, intersect

我有一个名为 DiscountableObject 的列表。列表中的每个项目依次都有一个 Discounts 集合。我需要的是所有 DiscoubtableObjects 中常见的折扣列表。

代码：

```
List<Discount> IntersectionOfDiscounts = new List<Discount>();
foreach(var discountableItem in DiscoutableObject)
{
    IntersectionOfDiscounts = IntersectionOfDiscounts.Intersect(discountableItem.Discounts);    
} 
```

这无疑会返回一个空列表，因为 IntersectionOfDiscounts 在第一个实例中是空的。

我想要的是取 DiscountableObject 的第 1 项，将其与 DiscountableObject 的下一项进行比较，依此类推。

我知道我正在尝试做的事情是错误的，因为我正在同时做交叉和添加到列表中......但是还有什么让我感到困惑？

我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-04T15:29:54.953

初始化`IntersectionOfDiscounts`为第一个折扣列表（如果有多个）而不是一个空列表。然后，您还可以跳过“foreach”循环中的第一项。

```
// add check to ensure at least 1 item.
List<Discount> IntersectionOfDiscounts = DiscoutableObject.First().Discounts; 
foreach(var discountableItem in DiscoutableObject.Skip(1))
{
    IntersectionOfDiscounts = IntersectionOfDiscounts.Intersect(discountableItem.Discounts);    
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-04T15:57:24.003

可能更优雅的方式：

```
var intersection = discountableObject
   .Select(discountableItem => discountableItem.Discounts)
   .Aggregate( (current, next) => current.Intersect(next).ToList()); 
```

错过了你的 6 分钟最后期限，但我还是喜欢它……

# actionscript-3 - 覆盖另一个类的函数

> ID：10014281
> 
> 赞同：1
> 
> 时间：2012-04-04T15:27:09.297
> 
> 标签：actionscript-3, apache-flex

我在我的一个类中定义了这个函数：

```
public function onUse():void {}; 
```

然后在我的另一个类（我们称之为“class2”）中，我创建了这个类的一个对象，然后想用另一个覆盖这个函数。经过一些 Google-Fu 之后，我找到了这个，并使用了它......

```
button.onUse {
    variable = value;
} 
```

...但它会立即执行，而不是在调用 onUse() 时执行 - 这似乎总是一个空函数。

我没有找到更多的东西 - 我自己尝试了一些东西，比如在 class2 和 using 中指定一个函数`button.onUse = function();`，但它总是抛出错误。

谁能告诉我我正在尝试做的事情是否真的可能，如果是，我该怎么做？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-04T15:33:12.657

您只能在扩展类时覆盖函数：

```
public class A {
    public function foo():void {
        doStuff();
    }
}

public class B extends A {
    override public function foo():void {
        doOtherStuff();
    }
}

var n:A = new A(); 
n.foo(); // => calls doStuff();

var o:B = new B();
o.foo(); // => calls doOtherStuff(); 
```

因此，在运行时不可能将不同的函数分配给实例的类方法。

但是，您可以让您的原始类包含一个*type 字段`Function`*，然后简单地为其分配一个不同的闭包。

```
public class A {
    public var foo:Function;
}

var n:A = new A();
n.foo = function ():void { 
    doStuff();
};
n.foo(); // => calls doStuff();

var o:A = new A();
o.foo = function ():void {
    doOtherStuff();
}
o.foo(); // => calls doOtherStuff(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-04T15:43:30.490

检查语法

```
button.onUse {
    variable = value;
} 
```

一个函数将被定义为

公共函数 onUse():void {};

并被覆盖

```
override public function onUse():void {
} 
```

在不同的班级

您尝试执行此操作的方式并不构成覆盖功能。

我在类似情况下所做的是在类中创建一个 onClickFunction 函数

```
public var onClickFunction:Function = null; 
```

然后在 CLICK 事件监听函数中添加

```
if(onClickFunction != null){
    onClickFunction();
} 
```

然后你可以通过做这样的事情来分配你的点击功能

button.onClickFunction = function():void{ variable = value; // 做东西 }

这不是最好的方法，但可能是实现功能的最简单方法。理想情况下，您会按照太空海盗建议的方式使用继承。

# c - C中的空函数指针是什么意思？

> ID：10014284
> 
> 赞同：2
> 
> 时间：2012-04-04T15:27:20.107
> 
> 标签：c, function, pointers

假设我们有一个函数指针：

```
void (*func0)(void); 
```

这也被定义：

```
void func0(void) { printf( "0\n" ); } 
```

但是说，在某些时候我们尝试以某种方式访问​​函数指针，那么如果 MS VS 调试器在我进入代码时显示 func0 实际上指向 0x0000，这意味着什么？另外，请让我知道最好的解决方法是什么？谢谢。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-04T15:28:12.837

取消引用空指针是未定义的行为。修复只是为了确保指针指向适当的函数。

在你的情况下，你想要这样的东西：

```
void MyFunction(void)
{
    printf( "0\n" ); 
} 
```

然后你可以分配给`func0`：

```
func0 = &MyFunction; 
```

请注意，我为函数指针变量和实际函数使用了不同的名称。

现在您可以通过函数指针调用该函数：

```
func0(); 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-04-07T18:07:27.040

我认为您正在混淆*命名*和*定义*函数指针。我会指出，如果你写

```
void func0(void) { printf( "0\n" ); }
void (*func0)(void); 
```

你实际上有两个完全不相关的同名对象`func0`。第一个`func0`是*函数*，第二个`func0`是函数指针类型的*变量*。

假设您全局声明了*变量* `func0`（在任何函数之外），它将自动初始化为零，因此编译器将读取您的行

```
void (*func0)(void); 
```

作为

```
void (*func0)(void) = NULL; 
```

所以变量`func0`将被初始化为值`NULL`，并且在大多数系统`NULL`上实际上是`0`。

您的调试器现在告诉您*变量* `func0`的值为`0x0000`，即`0`. 所以这真的不足为奇。

对于您关于“修复”的问题-好吧，我假设您想要一个指向您的函数的函数指针`func0`，因此您可以执行以下操作：

```
void func0(void) { printf( "0\n" ); }
void (*pFunc)(void) = func0; 
```

甚至更好（尽管在大多数编译器上不是必需的）你可以写

```
void (*pFunc)(void) = &func0; 
```

所以你初始化你的变量`pFunc`（我强烈建议重命名它！）指向`func0`. 更精确一点：您获取`&...`函数的地址`func0`并将此值分配给您的变量`pFunc`。

现在您可以通过以下方式“调用”函数指针（这意味着调用函数指针指向的函数）：

```
pFunc(); //will call function func0 
```

# objective-c - Xcode 4 'QuartzCore/CIColor.h' 文件未找到

> ID：10014286
> 
> 赞同：0
> 
> 时间：2012-04-04T15:27:26.220
> 
> 标签：objective-c, xcode, cocoa

我正在运行 Xcode 4 并尝试按照 Apple 的 Image Kit Programming Guide（为 Xcode 3 编写）中的步骤来了解如何使用 Image View 和 IKImageView 类。*我刚刚使用File > Add Files to...*菜单将 Quartz 和 Quartz Core 框架（从 /System/Frameworks 目录）导入到我的空白*Cocoa 应用程序*项目中，但是当我尝试**运行**我的应用程序时出现此错误： **Lexical or Preprocessor找不到****问题***“QuartzCore/CIColor.h”文件*

 ******有谁知道可能是什么原因？

> *彼得霍西 回复*:
> 
> 您不应该直接导入特定的标头，尤其是不要从子框架（例如 Core Image，QuartzCore 的子框架）中导入。仅导入框架的整体标头，通常与框架同名。

我没有直接导入任何特定的标题，我只是选择 File>Add Files to... 然后选择 /system/Frameworks 并选择两个包含这些框架的***文件夹***，之后它们应该出现在我的项目导航器视图中，但是该代码将不再编译。它显示了在*AppKit 框架中找到的**NSColor.h*文件，指向这一行：*#import*并说**Lexical or Preprocessor Issue** *'QuartzCore/CIColor.h' file not found*。我不知道为什么它不会编译。CI 代表核心图像。我现在正在阅读有关 Core Image 的指南，也许这会有所帮助。我想发布屏幕截图，但我不能（还没有足够的权利）。

 ****** * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-04T18:46:58.447

> 我刚刚使用 File > Add Files to... 菜单将 Quartz 和 Quartz Core 框架（从 /System/Frameworks 目录）导入到我的空白 Cocoa 应用程序项目中，...</p>

那不是进口；那只是将它添加到项目中（希望是目标）。导入是您对`#import`指令所做的事情。

> …但是当我尝试运行我的应用程序时，我收到了这个错误：Lexical or Preprocessor Issue 'QuartzCore/CIColor.h' file not found

您不应该直接导入特定的标头，尤其是不要从子框架（例如 Core Image，QuartzCore 的子框架）中导入。仅导入框架的整体标头，通常与框架同名。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-24T16:47:32.467

问题是我使用的指南是为 Xcode 3 编写的，所以当我尝试使用“文件>添加文件”菜单将一些框架导入/添加到我的项目时，它确实添加了这些框架，我可以在项目中看到它们导航器，但出了点问题。在 Xcode 4 中，您应该使用不同的方式添加/导入框架，方法是使用项目编辑器>摘要选项卡>链接的框架和库>单击“+”，然后选择所需的框架。这解决了这个问题。***********

# google-app-engine - GAE for iOS 上的 Gzip/zlib 压缩：CPU 与带宽成本是否有利？

> ID：10014292
> 
> 赞同：0
> 
> 时间：2012-04-04T15:27:35.527
> 
> 标签：google-app-engine

根据 Google 的 App Engine 成本结构，CPU 比带宽更昂贵，为您的 iOS 应用启用 gzip 压缩是否有益？有没有人启用 gzip 并看到实际的成本节省（或成本增加！）？

**背景**：我们的应用程序将主要向 iOS 提供文本内容。iOS 支持 gzip 压缩，但必须通过以下方式在客户端中打开接受编码和用户代理标头： [https ://developers.google.com/appengine/kb/general#compression](https://developers.google.com/appengine/kb/general#compression)

但是，如果发送 gzip 压缩的内容，iOS 会自动对其进行解码： [NSURLConnection/NSURLRequest gzip support](https://stackoverflow.com/questions/2682483/nsurlconnection-nsurlrequest-gzip-support)

由于我们编写了 iOS 应用程序，因此是否使用压缩取决于我们。在我过去的生活中，显着的带宽节省与 CPU 使用量的轻微增加是很值得的。看看 GAE 中的 CPU 与带宽成本，情况还不是很清楚。实际上，启用压缩可能会花费我们的钱。

那么有没有人尝试过他们的 iOS 应用程序并查看 gzip 支持是否能省钱？我们的应用程序还没有上线，所以我只能在 dev 中进行非常模糊的成本比较，不幸的是，这使得压缩看起来要花费更多的钱。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-05T05:21:43.543

如果客户端发送正确的 Accept-Encoding 标头和可识别的 User-Agent，App Engine 基础架构将为您压缩内容，而无需您的应用参与。压缩 HTTP 响应几乎总是一个好主意，除非您要发送自然不可压缩的数据。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-04T15:38:07.993

减少应用程序的加载时间比其他任何事情都值得。即使在高速 wifi 连接上，您的应用程序中的延迟也是来自下载数据。解压速度非常快。

# java - 使用按钮不断降低我的媒体音量

> ID：10014295
> 
> 赞同：1
> 
> 时间：2012-04-04T15:27:41.777
> 
> 标签：java, android, events, button, listener

当检测到“OnLongClickEvent”时，我想降低（或提高）我的应用程序中的媒体音量。

这是我的消息来源：

```
buttongauche.setOnLongClickListener(new OnLongClickListener() {

            @Override
            public boolean onLongClick(View v) {
                playSound(R.raw.volumevoixdiminue);
                audio.adjustStreamVolume(AudioManager.STREAM_MUSIC,AudioManager.ADJUST_LOWER,AudioManager.FLAG_SHOW_UI);
                return true;
            }
        }); 
```

实际上，它是有效的：当我在我的“buttongauche”上做一个longClick时，音量减1。现在我想知道如果我想连续降低声音我该怎么做（例如，每次减1声音按钮按下时 2 秒）。

我的按钮“buttongauche”已经有一个“onClickEvent”，它可以做其他事情（更改菜单的索引）。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-04T16:00:27.380

声明`boolean touching = false;`表示您是否正在触摸按钮并用于`OnTouchListener`更改它的字段。当您开始触摸时也会开始`volumeThread`，每 1 秒降低一次音量，并在您停止触摸时死亡。

```
buttongauche.setOnTouchListener(new View.OnTouchListener() {       

    public boolean onTouch(View v, MotionEvent event) {            
        switch (event.getAction()) {                               
        case MotionEvent.ACTION_DOWN:                              
            touching = true;                                       
            Thread volumeThread = new Thread() {                   
                public void run() {                                    
                    while (touching) {                             
                        audio.adjustStreamVolume(                  
                                AudioManager.STREAM_MUSIC,         
                                AudioManager.ADJUST_LOWER,         
                                AudioManager.FLAG_SHOW_UI);     
                        try {                                      
                            sleep(1000);                           
                        } catch (InterruptedException e) {         
                            e.printStackTrace();                   
                        }                                          
                    }                                              
                }                                                  
            };                                                     
            volumeThread.start();                                  
            break;                                                 
        case MotionEvent.ACTION_UP:                                
            touching = false;                                      
            break;                                                 
        }                                                          
        return false;                                              
    }                                                              
}); 
```

# html - Paypal url 显示有趣的字符

> ID：10014298
> 
> 赞同：1
> 
> 时间：2012-04-04T15:27:54.500
> 
> 标签：html, paypal

我有一个 payPal 网址，`&currency_code=CAD`当它显示在网站上时，它在网址中说明了`¤cy_code=CAD`为什么要这样做，我该如何解决？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-04T15:40:33.103

只是一个想法，`&curren;`是`¤`. 如果您显示的 URL 不包含网页本身的代码，那么它将显示为`¤`. 您可以使用`&amp;curren`正确显示 url。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-04T15:46:52.563

听起来您需要在显示 url 之前对其进行编码：

```
url_encode($url) 
```

# android - Android FileNotFoundException，为什么？

> ID：10014300
> 
> 赞同：0
> 
> 时间：2012-04-04T15:28:04.880
> 
> 标签：android, filenotfoundexception

我想触摸设备中的文件。文件名为 /data/misc/wifi/wpa_supplicant.conf。我可以用 adb shell 看到它。如果我尝试使用下面的代码打开它，我会收到 FileNotFoundException。为什么？？？

```
private void touchFile(String fileName) {

    BufferedWriter bufferedWriter = null;
    try {
        bufferedWriter = new BufferedWriter(new FileWriter(fileName));
        bufferedWriter.append(' ');
    } catch (FileNotFoundException ex) {
        ex.printStackTrace();
    } catch (IOException ex) {
        ex.printStackTrace();
    } finally {
        try {
            if (bufferedWriter != null) {
                bufferedWriter.flush();
                bufferedWriter.close();
            }
        } catch (IOException ex) {
            ex.printStackTrace();
        }
    }

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-04T15:30:23.067

该路径`/data/misc/`只能通过 root 权限访问。这可能就是您收到此异常的原因。

# java - 如何在Windows环境下使用Java语言判断文本文件还是二进制文件？

> ID：10014302
> 
> 赞同：0
> 
> 时间：2012-04-04T15:28:06.327
> 
> 标签：java, file, text, binary

我正在计算文本文件的总数，一个文件夹中有很多文件，包括文本文件和其他二进制文件。

如何判断文件是文本文件还是使用Java语言的二进制文件？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-04T15:56:39.183

如果您在谈论纯文本，那么文本文件中有哪些字符？9（制表符）、10（换行）、13（回车）、32到126（可读字符）

文本文件在此集中应具有接近 100% 的 char 比率。

另一方面，二进制文件使用整个字符集，因此应该具有较低的比率。此外，二进制文件通常包含很多 0 值。

这不是确定文件类型的 100% 确定方法，但我认为应该足够了。

# c++ - 如何确定调用堆栈的结束？

> ID：10014307
> 
> 赞同：4
> 
> 时间：2012-04-04T15:28:16.393
> 
> 标签：c++, callstack

所以我写了两个简单的类——X86StackFrame 和 X86CallStack：

```
class X86StackFrame {
public:
    X86StackFrame(void *frmAddr, void *retAddr);

    inline void *GetFrameAddress() const 
        { return frmAddr_; }
    inline void *GetReturnAddress() const 
        { return retAddr_; }

private:
    void *frmAddr_;
    void *retAddr_;
};

class X86CallStack {
public:
    X86CallStack();

    inline std::deque<X86StackFrame> GetFrames() const {
        return frames_;
    }

private:
    std::deque<X86StackFrame> frames_;
}; 
```

这里的关键方法是 X86CallStack 的 ctor：

```
static inline void *GetReturnAddress(void *frmAddr) {
    return *reinterpret_cast<void**>(reinterpret_cast<char*>(frmAddr) + 4);
}

static inline void *GetNextFrame(void *frmAddr) {
    return *reinterpret_cast<void**>(frmAddr);
}

X86CallStack::X86CallStack()
    : frames_()
{
    void *frmAddr;
    void *retAddr;

    #if defined _MSC_VER
        __asm mov dword ptr [frmAddr], ebp
    #elif defined __GNUC__
        __asm__ __volatile__(
            "movl %%ebp, %0;" : "=r"(frmAddr) : : );
    #endif  

    do {
        if (frmAddr == 0) {
            break;
        }
        retAddr = GetReturnAddress(frmAddr);
        if (retAddr == 0) {
            break;
        }
        frmAddr = GetNextFrame(frmAddr);
        frames_.push_back(X86StackFrame(frmAddr, retAddr));
    } while (true);
} 
```

问题是......我该如何结束那个循环？我的意思是，根据 0 检查帧/返回地址有时会奏效，但并非总是如此（至少在 Windows 上是这样）。

有什么建议么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-04T15:42:56.320

在 Windows 上，读取[线程信息块](http://en.wikipedia.org/wiki/Win32_Thread_Information_Block)可以为您提供堆栈的顶部和底部，因此您可以在读取超出该范围的任何内容之前停止。不过，我不知道如何在其他操作系统上获得类似的信息。

# sass - 指南针智能精灵布局

> ID：10014311
> 
> 赞同：0
> 
> 时间：2012-04-04T15:28:32.110
> 
> 标签：sass, css-sprites, compass-sass

根据文档[http://compass-style.org/help/tutorials/spriting/sprite-layouts/](http://compass-style.org/help/tutorials/spriting/sprite-layouts/) 有一种方法可以创建“智能”精灵布局，因为我对垂直布局不满意。

你好.sass

```
@orange-layout:smart
@import "orange/*.png"
@include all-orange-sprites 
```

我会尝试通过命令生成它`compass compile test`

但这对我不起作用。我仍然收到“垂直”精灵。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-12T19:40:11.413

问题在于使用 @ 而不是 $。工作版本 $orange-layout:smart

# php - PHP DOMXpath 没有拾取任何东西

> ID：10014313
> 
> 赞同：0
> 
> 时间：2012-04-04T15:28:37.593
> 
> 标签：php, dom, xpath, web-scraping

我正在尝试编写一个脚本，从该网站获取第一张图片的 URL：[http ://www.slothradio.com/covers/?adv=&artist=pantera&album=vulgar+display+of+power](http://www.slothradio.com/covers/?adv=&artist=pantera&album=vulgar+display+of+power)

这是我的脚本：

```
$content = file_get_contents($url);
$doc = new DOMDocument();
$doc->loadHTML($content);
$xpath = new DOMXpath($doc);

$elements = $xpath->query("*/div[@class='album0']/img");
echo '<pre>';print_r($elements);exit; 
```

当我运行它时，它会输出

```
DOMNodeList Object
(
) 
```

即使我将查询更改为`$xpath->query("*/img")`，我仍然一无所获。我究竟做错了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-04T15:30:59.460

> 我究竟做错了什么？

您正在使用`print_r`，但 `DOMNodeList`没有为该函数提供任何输出（因为它是一个内部类）。例如，您可以从输出项目数开始。最后，您需要遍历节点列表并自行处理每个节点。

```
printf("Found %d element(s).\n", $elements->length); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-04T15:39:14.713

`$doc->loadHTMLFile($content);`接受 FILE PATH 而不是 HTML 内容，请参阅文档

[http://php.net/manual/en/domdocument.loadhtmlfile.php](http://php.net/manual/en/domdocument.loadhtmlfile.php)

采用

```
$doc = new DOMDocument();
$doc->loadHTMLFile($url); 
```

输出元素使用

```
var_dump(iterator_to_array($elements)); 
//Or
print_r(iterator_to_array($elements)); 
```

谢谢

:)

# asp.net-mvc-3 - 在同一解决方案中使用 ASP.NET Web 窗体和 MVC 应用程序

> ID：10014318
> 
> 赞同：1
> 
> 时间：2012-04-04T15:28:54.077
> 
> 标签：asp.net-mvc-3, integration, asp.net-4.0

我在一个项目中有一个 ASP.NET **Web 窗体应用程序。**在同一个解决方案下，我有两个不同的项目：一个**Repository**层和一个**Service**层。

最终我将在**MVC中****重写**我的 ASP.NET Web 窗体应用程序，因此我想通过使用 MVC 来实现所有新功能。

 **我必须为客户创建一个**注册表单**，如果条件得到验证，我必须将客户带到另一个表格，然后再返回注册表。

如果我在**同一个解决方案**中创建一个 MVC 应用程序项目，它会起作用吗？该应用程序还将使用服务和存储库层。**Session 对象**呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-09T18:33:37.087

只需将 MVC 控制器/视图添加到您的 Web 窗体应用程序。他们可以并排运行。这将允许您将网站的某些部分升级到 MVC，同时保持现有的 Web 表单页面运行。

Web 层（同时具有 MVC 和 Web 窗体）仍然可以访问您的所有应用程序框架逻辑（存储库、服务、会话等......）

Scott Hanselman 创建了一个 Nuget 包，用于轻松将您的 Web 表单应用程序升级到 Mvc 3： [http://nuget.org/packages/AddMvc3ToWebForms](http://nuget.org/packages/AddMvc3ToWebForms)**

# gwt - Gwt rpc AsyncCallbak 之后的代码不会被执行？

> ID：10014319
> 
> 赞同：1
> 
> 时间：2012-04-04T15:28:58.120
> 
> 标签：gwt, rpc

不明白为什么gwt rpc AsyncCallback之后的代码不会被执行？

例如，我有接口 AppService 扩展 RemoteService，所以我将有 AsyncAppService 来执行异步调用。

以下代码

```
 AppServiceAsync service = GWT.create (AppService.class);
        service.getCurrentUser(new AsyncCallback<Employee>(){

            public void onFailure(Throwable caught) {

            }

            public void onSuccess(Employee result) {
                currentUser = result;
            }

        });
 // if i have the code after the above call, these code will not be execute, what is the problem
//code following will not be executed if they are in the same function.
    boolean isAdmin = false;
        if(currentUser!=null){
            if(currentUser.getUserRole().equals("ROLE_ADMIN") ||
                    currentUser.getUserRole().equals("ROLE_MANAGER")){
                isAdmin = true;
            }
        } 
```

谢谢你的解释

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-04T16:19:39.187

您应该了解 Async 调用的性质。调用时程序执行不会等待`service.getCurrentUser`。程序将继续到下一行（`boolean isAdmin = false`），并且**在一段时间内**直到`(currentUser == null)`方法`getCurrentUser`正在执行。您应该将未执行的代码块移动到`onSuccess`处理程序中

此示例应如下所示：

```
service.getCurrentUser(new AsyncCallback<Employee>(){

    public void onFailure(Throwable caught) {

    }

    public void onSuccess(Employee result) {
        currentUser = result;
        if (currentUser != null) {
            if (currentUser.getUserRole().equals("ROLE_ADMIN") ||
                currentUser.getUserRole().equals("ROLE_MANAGER")) {
                isAdmin = true;
            }
        }

    }

}); 
```

我假设 currentUser 和 isAdmin 是类字段，但不是局部变量。如果`isAdmin`是本地的，则可以将此变量包装到最终数组中：`final boolean[] isAdmin = new boolean[1]`并像这样调用它`isAdmin[0]`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-05T02:32:29.080

想象一下，您是过去非计算机化股票/商品市场的经纪人。让我们假设它以下列方式运行。

现在是星期一上午 9.30。您按顺序计划了这些。事实上，你是如此有经验，它被编入你的程序：

程序 BuyAlBanySteel(500)：

1.  您想打电话购买 500 AlbanySteel。
2.  通过将在交易大厅内流通的呼叫板。
3.  当呼叫板返回要约并且您同意要约时，请联系要约人购买股票。

程序喝咖啡

1.  倒咖啡
2.  喝咖啡。

您必须处理的警告：获得呼叫响应至少需要 10 分钟，甚至一个小时。它是异步的。您知道需要多长时间，但不确定。

所以这是你早上的计划：

1.  执行 BuyAlBanySteel(500)
2.  喝咖啡。

让我问你，你会如何组织你的工作流程？你会这样构造吗？假设每个任务需要你一分钟的时间来执行。

```
9.31 am
Send offer(
  buy = 500 AlbanySteel
  messenger = annie
  When annie comes back, analyse offer.
  Pour Annie a cup of tea.
)

9.32 am
if (annie has an agreeable offer) buy 500 AlbanySteel.

9.33 am
Pour Coffee.

9.34
Drink Coffee. 
```

你当然不能。原因是以下行

```
9.32 am
if (annie has an agreeable offer) buy 500 AlbanySteel. 
```

将无法正确执行。它似乎没有被执行，因为安妮还没有回来提供报价。她可能需要再过 10 分钟或一个小时才能收到报价。

所以，这就是你必须如何执行你的工作流程

```
9.31 am
Send offer(
  buy = 500 AlbanySteel
  messenger = annie
  when annie comes back,
  analyse offer.
  Pour Annie a cup of tea.
  if (annie has an agreeable offer) buy 500 AlbanySteel.
)

9.33 am
Pour Coffee.

9.34
Drink Coffee. 
```

那么，在 GWT 伪代码中，您会选择执行哪一个？

你会执行这个：

```
BuyAlbanySteelAsync albanyService = GWT.create(BuyAlbanySteel.class);

albanyService.getOffer(
  new Task<Annie>(){
    onFailure(Annie){Do nothing}

    OnSuccess(Annie){
       analyse offer.
       Pour Annie a cup of tea.
    }
  }
);

if(Annie has agreeable offer)
  buy the stock. 
```

或这个：

```
BuyAlbanySteelAsync albanyService = GWT.create(BuyAlbanySteel.class);

albanyService.getOffer(
  new Task<Annie>(){
    onFailure(Annie){Do nothing}

    OnSuccess(Annie){
       analyse offer.
       Pour Annie a cup of tea.
       if(Annie has agreeable offer)
         buy the stock.
    }
  }
); 
```

# facebook - 使用 cron 更新即将到期的 access_tokens

> ID：10014320
> 
> 赞同：2
> 
> 时间：2012-04-04T15:28:59.617
> 
> 标签：facebook, facebook-php-sdk, access-token

我正在研究在我的所有用户即将到期之前从 cron 作业自动更新 Facebook access_tokens，作为其中的一部分，我一直在阅读以下有关离线访问的链接：[https ://developers.facebook.com /roadmap/offline-access-removal/](https://developers.facebook.com/roadmap/offline-access-removal/)在链接中它显示以下内容：“注意：用户必须先访问您的应用程序，然后您才能获得有效的“授权码”才能进行服务器端 OAuth 调用再次。应用程序将无法设置尝试自动延长到期时间的后台/cron 作业，因为“授权码”是短暂的并且已经到期。”

为什么这里提到了授权代码，为什么如果相关的 access_tokens 仍然有效，为什么不能从 cron 作业中为我的用户自动更新 access_tokens？根据链接，以下是刷新access_token需要进行的调用：

```
https://graph.facebook.com/oauth/access_token?             
client_id=APP_ID&
client_secret=APP_SECRET&
grant_type=fb_exchange_token&
fb_exchange_token=EXISTING_ACCESS_TOKEN 
```

无需提供授权码。唯一需要的客户端特定信息是 EXISTING_ACCESS_TOKEN 参数。APP_ID 等其他参数只是应用程序特定的。任何关于我需要做什么来完成这项工作的建议都将不胜感激。

我浏览了有关此问题的现有帖子，并找到了一个解释，即当令牌已过期时，无法使用 cron 作业更新 access_tokens。但是，我的 access_tokens 仍然有效，因此不适用于我。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-21T07:27:53.473

> 为什么这里提到了授权代码，为什么如果相关的 access_tokens 仍然有效，为什么不能从 cron 作业中为我的用户自动更新 access_tokens？

因为否则offline_access 的弃用将毫无用处，因为每个应用程序仍然可以永远代表其用户行事。

> 我已经浏览了有关此的现有帖子

很好，因为这不像你问的同一件事之前没有被解释过多次。不好，虽然你不明白。

> 我找到了一个解释，说明当令牌已经过期时，无法使用 cron 作业更新 access_tokens。

正确的。

> 但是，我的 access_tokens 仍然有效，因此不适用于我。

您只能将短期访问令牌交换为长期访问令牌。你**不能**延长一个已经存在的长寿的。

# c# - 复制目录的性能

> ID：10014322
> 
> 赞同：0
> 
> 时间：2012-04-04T15:29:03.550
> 
> 标签：c#, performance, copy

我正在使用 C# 将文件从一个目录复制到另一个目录。我正在使用来自 msdn 的代码，但复制几个演出需要一分钟左右的时间非常慢。在资源管理器中只需几秒钟。 [http://channel9.msdn.com/Forums/TechOff/257490-How-Copy-directories-in-C](http://channel9.msdn.com/Forums/TechOff/257490-How-Copy-directories-in-C) Surly 有更快的方法..:)

```
 private static void Copy(string sourceDirectory, string targetDirectory)
    {
        DirectoryInfo diSource = new DirectoryInfo(sourceDirectory);
        DirectoryInfo diTarget = new DirectoryInfo(targetDirectory);

        CopyAll(diSource, diTarget);
    }

    private static void CopyAll(DirectoryInfo source, DirectoryInfo target)
    {
        // Check if the target directory exists, if not, create it.
        if (Directory.Exists(target.FullName) == false)
        {
            Directory.CreateDirectory(target.FullName);
        }

        // Copy each file into it's new directory.
        foreach (FileInfo fi in source.GetFiles())
        {
            fi.CopyTo(Path.Combine(target.ToString(), fi.Name), true);
        }

        // Copy each subdirectory using recursion.
        foreach (DirectoryInfo diSourceSubDir in source.GetDirectories())
        {
            DirectoryInfo nextTargetSubDir =
                target.CreateSubdirectory(diSourceSubDir.Name);
            CopyAll(diSourceSubDir, nextTargetSubDir);
        }
    } 
```

* * *

使用 Parallel，我能够在不到一分钟的时间内复制 6gigs，比 explorer 和 xcopy 快。

* * *

```
private static void CopyAll(string SourcePath, string DestinationPath)
{
    string[] directories = System.IO.Directory.GetDirectories(SourcePath, "*.*", SearchOption.AllDirectories);

    Parallel.ForEach(directories, dirPath =>
    {
        Directory.CreateDirectory(dirPath.Replace(SourcePath, DestinationPath));
    }); 

    string[] files = System.IO.Directory.GetFiles(SourcePath, "*.*", SearchOption.AllDirectories);

    Parallel.ForEach(files, newPath =>
    {
        File.Copy(newPath, newPath.Replace(SourcePath, DestinationPath));
    }); 
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-04T15:50:14.667

你正在使用的是递归。它总是减慢系统速度。

使用它，因为它没有递归。

```
void CopyAll (string SourcePath, string DestinationPath)
{
    //Now Create all of the directories
    foreach (string dirPath in Directory.GetDirectories(SourcePath, "*.*", 
    SearchOption.AllDirectories))
    Directory.CreateDirectory(dirPath.Replace(SourcePath, DestinationPath));

    //Copy all the files
    foreach (string newPath in Directory.GetFiles(SourcePath, "*.*", 
    SearchOption.AllDirectories))
    File.Copy(newPath, newPath.Replace(SourcePath, DestinationPath));
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-04T15:35:48.087

您的问题可能出在文件的 *overwriteé 上。我看到你打电话

```
fi.CopyTo(Path.Combine(target.ToString(), fi.Name), true); 
```

where`true`表示如果文件存在则覆盖该文件。

基于此，我*想*这是您的应用程序中覆盖现有文件的情况。

如果你的话，这些东西应该会更快

*   首先用一些临时唯一名称重命名目标目录
*   在将源复制到目标之后（所以没有覆盖）

如果*成功*删除临时目录，如果*失败*删除所有复制的文件并将临时重命名为其原始名称。

*应该*更快。

祝你好运。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-04T15:42:33.213

我怀疑@Oded 是正确的，您正在将副本与移动进行比较。

如果您想确保您所做的与 shell 相同，您可以查看[`SHFileOperation`](http://msdn.microsoft.com/en-us/library/windows/desktop/bb762164.aspx), 或 (在 Vista 或更新版本上) [`IFileOperation`](http://msdn.microsoft.com/en-us/library/windows/desktop/bb775771.aspx)。至少据我所知，您必须`SHFileOperation`通过 P/Invoke 使用。IFileOperation 是一个 COM 接口。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-09-18T11:39:36.853

在创建目录时使用 Parallel.ForEach 循环存在一个大问题，您需要注意的第一件事是嵌套在其他目录中的子目录，如果 Parallel 创建目录乱序，代码可能会因为试图创建目录级别 8，而目录级别 6 甚至还没有创建。

# c# - 关于什么可能导致 System.Timers.Timer.set_Enabled 属性抛出 System.NullReferenceException 的任何想法？

> ID：10014326
> 
> 赞同：4
> 
> 时间：2012-04-04T15:29:14.767
> 
> 标签：c#, .net, vb.net, winforms

这是堆栈跟踪：

> 2012-03-16 19:15:09Z E System.NullReferenceException：对象引用未设置为对象的实例。
> 在 System.Timers.Timer.set_Enabled（布尔值）
> 在 System.Timers.Timer.Stop()

这是代码：

定时器声明为私有成员变量。

```
Private _myTimer As System.Timers.Timer 
```

初始化定时器方法。

```
Private Sub InitializeMyTimer()

    _myTimer = New System.Timers.Timer

    _myTimer.Interval = My.Settings.TimeoutSeconds * 1000
    _myTimer.Start()

    AddHandler _myTimer.Elapsed, AddressOf MyTimer_Elapsed

End Sub 
```

计时器经过的方法。WsMethodAsync 调用 .asmx Web 服务方法。

```
Private Sub MyTimer_Elapsed(ByVal sender As Object, ByVal e As     System.Timers.ElapsedEventArgs)

    Try

        _myTimer.Stop()

        Using thisWSHelper As New WSHelper

            thisWsHelp.WsMethodAsync()

        End Using

        _myTimer.Start()

    Catch ex As Exception

      LogAndShowException(ex)

    End Try

End Sub 
```

计时器必须有一个值，否则 Timer.Stop() 调用将引发异常。这是一个零星的错误，我只是想看看是否有人以前经历过这种情况，或者是否有人对可能导致它的原因有任何想法。它发生在 WinForms 应用程序中 Timer 的 Elapsed 事件的事件处理程序中，但它只是偶尔在用户计算机上发生。我自己无法重现该错误。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-04T17:32:38.187

好吧，让我们假设您意识到 System.Timers.Timer 类实现了 IDisposable 并且您编写了代码来正确处置计时器，就像您应该做的那样：

```
Private Sub OnDisposed(ByVal sender As Object, ByVal e As EventArgs) Handles MyBase.Disposed
    If myTimer IsNot Nothing Then
        myTimer.Dispose()
        myTimer = Nothing
    End If
End Sub 
```

是的，那会偶尔发生一次。Elapsed 事件由线程池线程引发，并且可以在任何奇数时间开始运行。如果线程池特别忙，可能需要几秒钟。处理计时器不会*阻止*事件运行，tp 线程已经在运行。因此，使用此特定代码，您很可能会获得 NRE。只是有时，永远不会在您调试代码时。

以受控方式停止 System.Timers.Timer 非常困难，您永远无法确定在禁用后 Elapsed 事件不会触发。防御性地写作，并记住这是可能的。并支持 System.Threading.Timer。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-04T21:45:15.410

首先，您看到这些随机异常的原因：

A`System.Timers.Timer`用作[System.Threading.Timer](http://msdn.microsoft.com/en-us/library/system.threading.timer.aspx)，并且正如 Hans Passant 所说，每次迭代都是在另一个线程上完成的。这使得您的`Elapsed`事件可以在禁用计时器后引发，因为可以在前一个迭代完成之前开始新的迭代。

工作方式`System.Timers.Timer`，禁用它会处理底层`System.Threading.Timer`并将其设置为 Nothing。在罕见的（这个词是多余的吗？）竞争条件下，您的计时器将尝试`Dispose`在其设置为 Nothing 时在其底层计时器上运行，从而导致`NullReferenceException`.

* * *

一种解决方案是将`Timer.AutoReset`属性设置为 False 并在您的`Elapsed`事件中重新启动计时器。

# php - Symfony 2 - 多服务器配置

> ID：10014327
> 
> 赞同：20
> 
> 时间：2012-04-04T15:29:15.003
> 
> 标签：php, configuration, symfony

我们开始在工作中的项目中采用 Symfony 2，这很棒，但是我正在努力解决一个我几乎已经遇到的挑战，但还不是完全。

Symfony 将环境的概念视为单个服务器上的单独运行时。这很棒，因为您可以使用不同的前端控制器 (web) 在运行时之间切换，或者随心所欲地使用 env 开关 (cli)。

但是，作为开发过程的一部分，我们的代码部署在许多服务器上。每个人都有一个本地虚拟机，然后代码通过集成、QA、暂存，最后是生产传播。

因此，我们的环境概念是服务器（虚拟或物理）。以下是此自定义配置的目标

1.  在运行时环境切换方面维护 Symfony 的 ootb 功能
2.  允许每个服务器的公共（即开发人员控制）配置
3.  维护每个服务器的私有（即 sysad 控制的）配置
4.  适用于 web 和 cli

这意味着我们不能仅仅 100% 依赖**parameters.ini**或任何静态命名的文件，因为开发人员需要控制每个服务器的配置，而且所有这些文件都将在 git 中彼此相邻。

所以，我想做*的*就是这个。向设置服务器环境的 parameters.ini 添加一个新值。像这样的东西

**应用程序/配置/参数.ini**

```
[parameters]
    server="int" 
```

然后，在内核中，根据该值加载一个附加配置文件。例如，我希望它可以工作，但它没有（因为在此步骤中容器还不存在）

**应用程序/AppKernel.php**

```
public function registerContainerConfiguration(LoaderInterface $loader)
{
  $loader->load(__DIR__.'/config/config_'.$this->getEnvironment().'.yml');

  // Per-server config
  $server = $this->getContainer()->getParameter( 'server' );        
  if ( $server )
  {
    $loader->load(__DIR__.'/config/server/'.$server.'.yml');
  }
} 
```

这将使开发人员可以使用**app/config/server/int.yml**之类的文件来控制非私有（即，不是 parameters.ini）配置值。

感谢您的阅读，如果有什么令人困惑的地方，请告诉我。

## 编辑

为了澄清，我*不能*使用或依赖的东西

*   *nix 环境变量来自用户的配置文件或通过`export`. 为什么？集成、QA 和暂存可能都在同一个盒子上
*   vhost 配置中的任何内容（不适用于 cli）
*   静态命名的文件（即，刚刚命名为**server.ini**的文件不起作用）

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2012-04-04T18:54:11.723

好的，我终于想出了该怎么做。真的只需要对 AppKernel 进行基本修改

**应用程序/AppKernel.php**

```
public function registerContainerConfiguration(LoaderInterface $loader)
{

  // Symfony environment config
  $loader->load(__DIR__.'/config/config_'.$this->getEnvironment().'.yml');

  // Load server config, if it exists
  $parameters = parse_ini_file( __DIR__.'/config/parameters.ini', true );
  if ( $parameters && isset( $parameters['parameters']['server.env'] ) )
  {
    $serverConfig = __DIR__.'/config/server/'.$parameters['parameters']['server.env'].'.yml';
    if ( file_exists( $serverConfig ) )
    {
      $loader->load( $serverConfig );
    } else {
      error_log( 'Server config defined, but no config file found. Looked for ' . $serverConfig );
    }
  }
} 
```

**应用程序/配置/参数.ini**

```
[parameters]
    # ...
    server.env="int"
    server.title="Integration"
    server.name="Int 1" 
```

现在我可以根据需要在**app/config/server/中创建****%server.env%.yml**文件。

 **感谢那些阅读本文的人 - 我最初在想一些更复杂的东西，这使得这个简单的解决方案在一段时间内不可见；）**

# asp.net - 如何在 MVC 3 中以横向打印 webgrid

> ID：10014332
> 
> 赞同：0
> 
> 时间：2012-04-04T15:29:35.410
> 
> 标签：asp.net

任何人都可以帮助我在横向打印 webgrid

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-04T15:47:20.963

一种常见的方法是创建**自定义打印 CSS 样式表**。它可以很简单。

[这篇简短的文章](http://www.onextrapixel.com/2009/05/05/how-to-create-a-simple-print-css-for-your-site/)将引导您完成一个简单的示例。

一旦掌握了所涉及的概念，您就可以为您的网页添加特定的 CSS。

以下是基本步骤：

1）重置所有填充和边距：

```
body {margin:0; padding:0; line-height: 1.4em; word-spacing:1px; 
letter-spacing:0.2px; font: 13px Arial, Helvetica,"Lucida Grande", serif;
 color: #000;} 
```

2) 删除您不想打印的元素，例如页眉、徽标、菜单等。在您的情况下，您可能希望隐藏除网格之外的所有内容。

```
#logo, #catnavi, .topnavi, .more-link, .navigation, #sidebartop, #related, #social,
#sponsors, .tabs, #allpost, .toolbar, .splitbox, #commentform, #commentabs .idTabs, 
.postmeta-content .comments, #respond h3, .tag, .footerlinks {display:none;} 
```

3) 可选地，在打印文档中显示 URL（隐藏链接将隐藏 URL）

4) （可选）插入分页符

```
#comments {page-break-before: always;} 
```

5)`<link>`在页面顶部添加一个标签以包含该`.css`文件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-04T15:32:01.783

您必须在 CSS 中执行此操作，定义适合打印的样式表。您无法从浏览器控制打印机首选项。

换句话说，由用户来选择他想要使用的纸张方向。您只能使用适当的打印样式“帮助它”一点。[在这里阅读。](http://www.w3.org/TR/CSS2/media.html)

# android - 强制 SQLite 3.7 以旧模式运行？

> ID：10014333
> 
> 赞同：0
> 
> 时间：2012-04-04T15:29:42.163
> 
> 标签：android, sqlite

我的 Android 应用程序适用于 SQLite 数据库。它们是在 SQLite v3.6（传统模式）中创建的，因此它们与所有 Android 设备兼容。但是，一小部分运行 SQLite v3.7 的设备会自动将 SQLite 数据库升级到 v3.7，这使得它们与旧设备不兼容。

有没有办法告诉运行 v3.7 的设备不要升级数据库？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-04T23:21:55.673

```
PRAGMA legacy_file_format = 1 
```

根据[SQLite 网站](http://www.sqlite.org/pragma.html#pragma_legacy_file_format)：

> 此编译指示设置或查询 legacy_file_format 标志的值。当这个标志打开时，新的 SQLite 数据库将以一种文件格式创建，该文件格式可由所有 SQLite 版本（回到 3.0.0）读写。当该标志关闭时，将使用最新的文件格式创建新数据库，该文件格式可能无法被 3.3.0 之前的 SQLite 版本读取或写入。

# swing - NullPointerException 在 actionPerformed 中摆动

> ID：10014350
> 
> 赞同：0
> 
> 时间：2012-04-04T15:30:47.587
> 
> 标签：swing

`This is a login form for a slot machine game which will evoke a "NextPage" object. I` `don't think this LoginDemo.java code has to do anything with the error but I prefer to` `post the entire code. Thanks in advance..`

```
 //LoginDemo.java
import javax.swing.*;
import java.awt.*;
import java.awt.event.*;

class Login extends JFrame implements ActionListener
{
     JButton SUBMIT;
     JPanel panel;
     JLabel label1,label2;
     final JTextField  text1,text2;
    Login()
    {
        label1 = new JLabel();
        label1.setText("Username:");
        label1.setBounds(50,50,100,30);
        text1 = new JTextField(15);
        text1.setBounds(250,50,100,30);
        label2 = new JLabel();
        label2.setText("Password:");
        label2.setBounds(50,250,100,30);
        text2 = new JPasswordField(15);
        text2.setBounds(250,250,100,30);
        //this.setLayout(new BorderLayout());

        SUBMIT=new JButton("SUBMIT");
        SUBMIT.setBounds(350,350,100,30);

         //     panel=new JPanel(new GridLayout(3,1));
            panel=new JPanel(null);
        panel.setBounds(50,50,1000,1000);
        //  panel.setLayout(new FlowLayout());
        panel.add(label1);
        panel.add(text1);
        panel.add(label2);
        panel.add(text2);
        panel.add(SUBMIT);
            add(panel,BorderLayout.CENTER);
                SUBMIT.addActionListener(this);
                setTitle("LOGIN FORM");
    }
    public void actionPerformed(ActionEvent ae)
    {
        String value1=text1.getText();
        String value2=text2.getText();
        if (value1.equals("a") && value2.equals("a")) 
        {
            NextPage page=new NextPage();
            page.setVisible(true);
            //JLabel label = new JLabel("Welcome:"+value1);
                // page.getContentPane().add(label);
            setVisible(false);
        }
        else
        {
            //System.out.println("enter the valid username and password");
            JOptionPane.showMessageDialog(this,"Incorrect login or password","Error",JOptionPane.ERROR_MESSAGE);
        }
    }
}   
class LoginDemo
{
    public static void main(String arg[])
{
    try
    {
        Login frame=new Login();
        frame.setSize(1000,1000);
        frame.setVisible(true);
    }
    catch(Exception e)
    {
        JOptionPane.showMessageDialog(null, e.getMessage());
    }

    }
}

    //NextPage.java

import javax.swing.*;
import java.awt.*;
import java.awt.event.*;
import java.applet.*;
import java.util.Random; 
import java.sql.*;
import java.lang.*;
import java.awt.image.*;
import java.awt.image.BufferedImage;
import javax.imageio.ImageIO;
import java.io.*;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;

public class NextPage extends JFrame implements Runnable, ActionListener
{
        BufferedImage  img1,i0,i1,i2,i3,i4,i5,i6,i7,i8,i9,i10,i11,i12,star1;
    JFrame f1;
    Thread t1,t2,t3;
    int x1,y1,i,j,k,l,m,n,r1,r2,r3;
    JButton b1;
    Random r=new Random();
    TextField tf1;
        JPanel p1;

    NextPage()
    {
        setBounds(50,50,1000,1000);
        p1=(JPanel)(getContentPane());
        p1.setBounds(50,50,1000, 1000);
        p1.setLayout(null);
        //tf1=new TextField(20);
        //tf1.setBounds(50,50,100,30);
        setDefaultCloseOperation(javax.swing.WindowConstants.DISPOSE_ON_CLOSE);
        setTitle("Welcome");

        b1=new JButton("START");

        //p1.add(tf1);  

        b1.setBounds(150,400,100,30);
        //try{
        b1.addActionListener(this);
        //}
        /*catch(Exception e)
        {
            System.out.println(""+e);
        }*/
        add(b1);
        setVisible(true);
        try
        {       
            i0=ImageIO.read(new File("tea.jpg"));   
                 i1=ImageIO.read(new File("coffee.jpg"));
             i2=ImageIO.read(new File("bhel.jpg")); 
            i3=ImageIO.read(new File("pizza.jpg")); 
             i4=ImageIO.read(new File("icecream.jpg")); 
             i5=ImageIO.read(new File("dosa.jpg")); 
             i6=ImageIO.read(new File("idli.jpg")); 
             i7=ImageIO.read(new File("panipuri.jpg")); 
             i8=ImageIO.read(new File("orange.jpg"));   
             i9=ImageIO.read(new File("watermelon.jpg"));   
             i10=ImageIO.read(new File("pavbhaji.jpg"));    
             i11=ImageIO.read(new File("noodles.jpg")); 
             i12=ImageIO.read(new File("sandwich.jpg"));    
         }
        catch (IOException ie) 
        {
            System.out.println("Error:"+ie.getMessage());   
        }

        j=0; m=0; n=0;

        r1= r.nextInt(13);
        r2= r.nextInt(13);
        r3= r.nextInt(13);

    }
    public void init()
    {
        t1=new Thread(this);
        t2=new Thread(this);
        t3=new Thread(this);
    }   

    public void start()
    {
        t2.start();
        t3.start();
    }
    public void run()
    {
        try
        {
            if(Thread.currentThread()==t1)
            for(j=0; j<150; j++)
            //for(i=0; i<=150; i+=20)
            {   
                r1= r.nextInt(13);
                repaint();  
                t1.sleep(10);
            }

            if(Thread.currentThread()==t2)
            for(m=0; m<160; m++)
            //for(k=0; k<=150; k+=20)
            {   
                r2= r.nextInt(13);
                repaint();
                t2.sleep(10);
            }
            if(Thread.currentThread()==t3)
            for(n=0; n<170; n++)
            //for(l=0; l<=150; l+=20)
            {   
                r3= r.nextInt(13);
                repaint();
                t3.sleep(10);
            }
        }
        catch(Exception e)
        {
            System.out.println(""+e);
        }

    }

    public void paint(Graphics g)
    {
        g.setColor(Color.blue);

        g.drawRect(50,300,150,80);
        g.drawRect(200,300,150,80);
        g.drawRect(350,300,150,80);

            switch(r1)
            {
                case 0: g.drawImage(i0,65,300,this);
                break;
                case 1: g.drawImage(i1,65,300,this);
                break;
                case 2: g.drawImage(i2,65,300,this);
                break;
                case 3: g.drawImage(i3,65,300,this);
                break;
                case 4: g.drawImage(i4,65,300,this);
                break;
                case 5: g.drawImage(i5,65,300,this);
                break;
                case 6: g.drawImage(i6,65,300,this);
                break;
                case 7: g.drawImage(i7,65,300,this);
                break;
                case 8: g.drawImage(i8,65,300,this);
                break;
                case 9: g.drawImage(i9,65,300,this);
                break;
                case 10: g.drawImage(i10,65,300,this);
                break;
                case 11: g.drawImage(i11,65,300,this);
                break;
                case 12: g.drawImage(i12,65,300,this);
                break;
            }   

            switch(r2)
            {
                case 0: g.drawImage(i0,215,300,this);
                break;
                case 1: g.drawImage(i1,215,300,this);
                break;
                case 2: g.drawImage(i2,215,300,this);
                break;
                case 3: g.drawImage(i3,215,300,this);
                break;
                case 4: g.drawImage(i4,215,300,this);
                break;
                case 5: g.drawImage(i5,215,300,this);
                break;
                case 6: g.drawImage(i6,215,300,this);
                break;
                case 7: g.drawImage(i7,215,300,this);
                break;
                case 8: g.drawImage(i8,215,300,this);
                break;
                case 9: g.drawImage(i9,215,300,this);
                break;
                case 10: g.drawImage(i10,215,300,this);
                break;
                case 11: g.drawImage(i11,215,300,this);
                break;
                case 12: g.drawImage(i12,215,300,this);
                break;
            }

            switch(r3)
            {
                case 0: g.drawImage(i0,365,300,this);
                break;
                case 1: g.drawImage(i1,365,300,this);
                break;
                case 2: g.drawImage(i2,365,300,this);
                break;
                case 3: g.drawImage(i3,365,300,this);
                break;
                case 4: g.drawImage(i4,365,300,this);
                break;
                case 5: g.drawImage(i5,365,300,this);
                break;
                case 6: g.drawImage(i6,365,300,this);
                break;
                case 7: g.drawImage(i7,365,300,this);
                break;
                case 8: g.drawImage(i8,365,300,this);
                break;
                case 9: g.drawImage(i9,365,300,this);
                break;
                case 10: g.drawImage(i10,365,300,this);
                break;
                case 11: g.drawImage(i11,365,300,this);
                break;
                case 12: g.drawImage(i12,365,300,this);
                break;
            }
        }
        public void actionPerformed(ActionEvent ae)
        {
            if(ae.getSource()==b1)
            t1.start();
        }

        /*public static void main(String args[])
        {
            NextPage o=new NextPage();
        }*/
    }   
} 
```

`Here are the exceptions that I get-`

`F:\java\jdk\bin>java LoginDemo` `Exception in thread "AWT-EventQueue-0" java.lang.NullPointerException` `at NextPage.actionPerformed(NextPage.java:235)` `at javax.swing.AbstractButton.fireActionPerformed(AbstractButton.java:1995)` `at javax.swing.AbstractButton$Handler.actionPerformed(AbstractButton.java:2318)` `atjavax.swing.DefaultButtonModel.fireActionPerformed(DefaultButtonModel.java:387)` `at javax.swing.DefaultButtonModel.setPressed(DefaultButtonModel.java:242)` `at` `javax.swing.plaf.basic.BasicButtonListener.mouseReleased(BasicButtonListener.java:236)` `at java.awt.Component.processMouseEvent(Component.java:6289)` `at javax.swing.JComponent.processMouseEvent(JComponent.java:3267)` `at java.awt.Component.processEvent(Component.java:6054)` `at java.awt.Container.processEvent(Container.java:2041)` `at java.awt.Component.dispatchEventImpl(Component.java:4652)` `at java.awt.Container.dispatchEventImpl(Container.java:2099)` `at java.awt.Component.dispatchEvent(Component.java:4482)` `at java.awt.LightweightDispatcher.retargetMouseEvent(Container.java:4577)` `at java.awt.LightweightDispatcher.processMouseEvent(Container.java:4238)` `at java.awt.LightweightDispatcher.dispatchEvent(Container.java:4168)` `at java.awt.Container.dispatchEventImpl(Container.java:2085)` `at java.awt.Window.dispatchEventImpl(Window.java:2478)` `at java.awt.Component.dispatchEvent(Component.java:4482)` `at java.awt.EventQueue.dispatchEventImpl(EventQueue.java:644)` `at java.awt.EventQueue.access$000(EventQueue.java:85)`

`at java.awt.EventQueue$1.run(EventQueue.java:603)`

`at java.awt.EventQueue$1.run(EventQueue.java:601)`

`at java.security.AccessController.doPrivileged(Native Method)`

`at` `java.security.AccessControlContext$1.doIntersectionPrivilege(AccessControlContext.java:87`

`at`

`java.security.AccessControlContext$1.doIntersectionPrivilege(AccessControlContext.java:98`

`at java.awt.EventQueue$2.run(EventQueue.java:617)`

`at java.awt.EventQueue$2.run(EventQueue.java:615)`

`at java.security.AccessController.doPrivileged(Native Method)`

`at` `java.security.AccessControlContext$1.doIntersectionPrivilege(AccessControlContext.java:87`

`at java.awt.EventQueue.dispatchEvent(EventQueue.java:614)`

`at java.awt.EventDispatchThread.pumpOneEventForFilters(EventDispatchThread.java:269)`

`at java.awt.EventDispatchThread.pumpEventsForFilter(EventDispatchThread.java:184)`

`at java.awt.EventDispatchThread.pumpEventsForHierarchy(EventDispatchThread.java:174)` `at java.awt.EventDispatchThread.pumpEvents(EventDispatchThread.java:169)` `at java.awt.EventDispatchThread.pumpEvents(EventDispatchThread.java:161)` `at java.awt.EventDispatchThread.run(EventDispatchThread.java:122)`

`Can't get any solution.. I am a learner..please help..`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-04T15:35:11.770

您不调用该`init`方法，因此当您输入该方法时您的`t1`变量仍然存在。`null``actionPerformed`

这在堆栈跟踪中相当明显（只有一件事可以`null`在该行上），如果从堆栈跟踪中不明显，调试器会立即显示这一点。比用数百行不相关代码创建帖子要快得多

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-04T15:46:37.597

您使用该变量`t1`来启动应该分配给该变量的线程。然而`init()`，创建分配给该变量的线程实例的函数永远不会被调用。存在`t1`并且`null`调用`null`对象上的任何函数都会导致`NullPointerException`.

只需调用该`init()`函数。我认为最初的想法是在构造函数中调用它，而您只是忘记插入它。

对于未来的问题，请考虑仅在 StackTrace 报告错误的位置附近发布行。要找到感兴趣的点，请查看 StackTrace 并在您编写的类中查找条目。在这种情况下`NextPage.actionPerformed(NextPage.java:235)`是一个兴趣点。在您的问题中最好标记这些点以快速获得良好的解决方案。

# emacs - Emacs：gethash 在哈希表中看不到键

> ID：10014352
> 
> 赞同：5
> 
> 时间：2012-04-04T15:30:49.777
> 
> 标签：emacs, elisp, hashtable

我在 ielm 中评估了以下 elisp 代码：

```
(setq foo-hash (make-hash-table))

(puthash "location" "house" foo-hash)

(defun foo-start ()
  (interactive)
  (message (gethash "location" foo-hash))) 
```

但是，当我跑步`(foo-start)`或`(gethash "location" foo-hash)`我只`nil`得到回声时。只`foo-hash`在 ielm 回声中输入：`#s(hash-table size 65 test eql rehash-size 1.5 rehash-threshold 0.8 data ("location" "house"))`

这是一个错误还是我做错了什么？

Emacs 版本：24.0.95.1

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-04-04T15:43:45.417

elisp 中的哈希表`eql`默认用于比较。`eql`除非它们是同一个对象，否则字符串不会等于。您可能想要使用`equal`比较字符串的内容。用这个创建你的哈希表：

```
(make-hash-table :test 'equal) 
```

# objective-c - （初学者）尝试将数组从 ViewController 传递给 DetailController

> ID：10014353
> 
> 赞同：1
> 
> 时间：2012-04-04T15:30:50.910
> 
> 标签：objective-c, xcode, arrays

我在 RootViewController 类中加载了一个数组（recordArray），我需要将它传递给 DetailViewController 类，以便我可以访问其中的任何变量。我可以成功传递一个值，但我不知道如何传递整个数组。

我在 DetailsViewController.h 中创建了第二个 NSMutableArray recordArray，添加了 @property 语句（带有保留），并在 DetailsViewController.m 中合成。然后我在 DetailsViewController.m 中添加了以下行

```
recordArray = [[NSMutableArray alloc] initWithArray:self.recordArray]; 
```

但这只是在详细视图中给了我一个空数组。

我已经阅读了一些关于此的帖子，但没有找到任何我理解足以能够实施的东西。我希望我做错了这一切....

提前感谢您的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-04T15:37:21.113

请参考这段代码：

[iPhone SDK：如何将一组值从 ViewController 传递到其他 ViewController？](https://stackoverflow.com/questions/5076878/iphone-sdk-how-do-i-pass-an-array-of-values-from-a-viewcontroller-onto-other-vi)

在那里你可以参考**Satya**的回答。

如果您需要更多帮助，请告诉我

**编辑：**

让我们假设有一个`NSArray`被调用的`secondArray`声明`SecondViewController`

在 SecondViewController 中定义一个方法：

```
-(void)setValue:(NSArray *)array
{
    secondArray = array;
} 
```

希望这可以帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-04T15:33:54.923

问题在于：

```
recordArray = [[NSMutableArray alloc] initWithArray:self.recordArray]; 
```

您只是分配了相同的属性`recordArray`，这可能是`nil`在这一点上，您想要做的是依赖注入。所以每当你实例化你的`DetailController`，你可以这样做：

```
myDetailController.recordArray = myRecordArray 
```

`myRecordArray`您要在详细视图控制器中传递或“注入”的值在哪里。

# wpf - 如何在具有预定义 WPF 主题的对话框上添加控件？

> ID：10014355
> 
> 赞同：0
> 
> 时间：2012-04-04T15:31:06.843
> 
> 标签：wpf, dialog, styles, themes, resourcedictionary

我是 WPF 的新手。我想做这样的事情：我在一个应用程序中有多个对话框。我已经为所有对话框创建了一个具有所需背景、标题栏和关闭按钮的主题。然而，所有对话框的大小和控件都会有所不同。例如：DialogWindow 是我为 Window 控件创建的主题。

在 MainWindow（我应用这个 DialogTheme 的地方）上，我可以看到这个主题。但是当我尝试在其上添加控件时，它们不会出现在主题上。

```
<Window x:Class="Example.MainWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    Height="391" Width="616"
    Style="{DynamicResource DialogWindow}">
    <Window.Resources>        
        <ResourceDictionary>
            <ResourceDictionary.MergedDictionaries>
                <ResourceDictionary Source="Themes/DialogsTheme.xaml" />
            </ResourceDictionary.MergedDictionaries>
        </ResourceDictionary>
    </Window.Resources>
</Window> 
```

我不确定，出了什么问题。任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-17T14:55:22.397

您需要将这些行添加到您创建的每个窗口以实现样式...

```
<Window...Style="{DynamicResource DialogWindow}">
<Window.Resources>        
    <ResourceDictionary>
        <ResourceDictionary.MergedDictionaries>
            <ResourceDictionary Source="Themes/DialogsTheme.xaml" />
        </ResourceDictionary.MergedDictionaries>
    </ResourceDictionary>
</Window.Resources> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-16T17:46:35.877

终于得到了答案，ContentPresenter 是必需的，它作为窗口主题的客户区。

```
<ContentPresenter Grid.Row="1" Grid.ColumnSpan="2" x:Name="ClientArea" /> 
```

# android - 检测到未闭合的光标

> ID：10014357
> 
> 赞同：1
> 
> 时间：2012-04-04T15:31:12.617
> 
> 标签：android, mapactivity

即使以最基本的形式启动 MapActivity 时，我也会“检测到未关闭的光标”：

```
protected void onCreate(Bundle icicle) {
    super.onCreate(icicle); // <--- The Exception occurs here
    setContentView(R.layout.layout_map);
} 
```

异常之后，地图**启动并且运行良好**，但是每次启动活动时的异常都让我很困扰。

# 例外：

> 04-04 12:02:22.858：W/Cursor(14122)：检测到未关闭的光标 04-04 12:02:22.866：W/Cursor(14122)：在 android.content.ContentResolver.query(ContentResolver.java:258) 04-04 12:02:22.866: W/Cursor(14122): at com.google.common.android.AndroidConfig.getSetting(Unknown Source) 04-04 12:02:22.866: W/Cursor(14122): at com .google.common.android.AndroidConfig.getDistributionChannelInternal(Unknown Source) 04-04 12:02:22.866: W/Cursor(14122): at com.google.common.Config.init(Unknown Source) 04-04 12:02 ：22.866：W/Cursor（14122）：在 com.google.common.android.AndroidConfig.（未知来源）04-04 12：02：22.866：W/Cursor（14122）：在 com.google.common.android。 AndroidConfig.(Unknown Source) 04-04 12:02:22.866: W/Cursor(14122): at com.google.android.maps.MapActivity.onCreate(MapActivity.java:405) 04-04 12:02:22.866:W/Cursor(14122): 在 com.myapp.activity.MyMapActivity.onCreate(MyMapActivity.java:25) 04-04 12:02:22.874: W/Cursor(14122): 在 android.app.Instrumentation.callActivityOnCreate(Instrumentation .java:1047) 04-04 12:02:22.874: W/Cursor(14122): 在 android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2717) 04-04 12:02:22.874: W/Cursor(14122 ): 在 android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2769) 04-04 12:02:22.874: W/Cursor(14122): 在 android.app.ActivityThread.access$2500(ActivityThread.java:129) 04 -04 12:02:22.874: W/Cursor(14122): 在 android.app.ActivityThread$H.handleMessage(ActivityThread.java:2117) 04-04 12:02:22.874: W/Cursor(14122): 在 android .os.Handler.dispatchMessage(Handler.java:99) 04-04 12:02:22.874: W/Cursor(14122): 在 android.os.Looper.loop(Looper.java:143) 04-04 12:02:22.874: W/Cursor(14122): 在 android.app.ActivityThread.main(ActivityThread.java:4717) 04-04 12:02:22.874: W/Cursor(14122) : 在 java.lang.reflect.Method.invokeNative(Native Method) 04-04 12:02:22.882: W/Cursor(14122): 在 java.lang.reflect.Method.invoke(Method.java:521) 04- 04 12:02:22.882: W/Cursor(14122): 在 com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:858) 04-04 12:02:22.882: W/Cursor(14122) : 在 com.android.internal.os.ZygoteInit.main(ZygoteInit.java:616) 04-04 12:02:22.882: W/Cursor(14122): 在 dalvik.system.NativeStart.main(Native Method)invokeNative（本机方法）04-04 12:02:22.882：W/Cursor（14122）：在 java.lang.reflect.Method.invoke（Method.java:521）04-04 12:02:22.882：W/Cursor (14122): 在 com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:858) 04-04 12:02:22.882: W/Cursor(14122): 在 com.android.internal.os。 ZygoteInit.main(ZygoteInit.java:616) 04-04 12:02:22.882: W/Cursor(14122): at dalvik.system.NativeStart.main(Native Method)invokeNative（本机方法）04-04 12:02:22.882：W/Cursor（14122）：在 java.lang.reflect.Method.invoke（Method.java:521）04-04 12:02:22.882：W/Cursor (14122): 在 com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:858) 04-04 12:02:22.882: W/Cursor(14122): 在 com.android.internal.os。 ZygoteInit.main(ZygoteInit.java:616) 04-04 12:02:22.882: W/Cursor(14122): at dalvik.system.NativeStart.main(Native Method)主要（本机方法）主要（本机方法）

我在网上搜索但一无所获......额外信息：

*   我使用谷歌 API 2.2
*   在设备和 AVD 上对其进行了测试
*   让其他地图项目使用 Google API 2.1（当然没有那个例外）
*   我的 AndroidManifest 没有遗漏任何东西（因此在引发异常后地图开始并工作）

帮助表示赞赏！

# 编辑：

我更新了 Google API 级别 7 和 8（问题从 8 开始）现在它也发生在 API 级别 7 上......

绣球花帮助我注意到我的 MapActivity ( icicle ) 中的 Bundle 变量名称**与**“标准” ( **savedInstanceState** ) 不同，这可能与问题有关吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-04T17:14:13.817

我在 2.2 设备上运行它，并没有收到任何此类错误。您的活动中是否发生了其他可能导致它的事情？也许捆绑包中的某些东西会导致 super.onCreate() 出现问题？

```
public class HelloGoogleMapsActivity extends MapActivity {
    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);
    }

    @Override
    protected boolean isRouteDisplayed() {
        // TODO Auto-generated method stub
        return false;
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-04T15:39:46.730

从数据库中获得信息后，您需要关闭游标。

例子：

```
cursor.close(); 
```

您确定问题不存在于其他班级吗？你的代码对我来说看起来不错。

# c# - 创建通用扩展方法时我们在扩展什么？

> ID：10014364
> 
> 赞同：9
> 
> 时间：2012-04-04T15:31:43.190
> 
> 标签：c#

```
public static class MyClass
{
    public static void Print<T>(this T theObject)
    {
        Console.WriteLine("The print output is " + theObject.ToString());
    }
} 
```

在给定的类中，我指定了一个泛型作为通过`this`关键字扩展的类型。由于我已经将类型的定义延迟到编译时，智能感知（以及其他相关的）如何知道我正在扩展什么类型？C# 是否只是默认为顶层`System.Object`？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-04T15:32:31.900

是的，`System.Object`除非您添加类型约束。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-04T16:54:24.303

> 由于我已经将类型的定义延迟到编译时，智能感知（以及其他相关的）如何知道我正在扩展什么类型？C# 是否只是默认为顶级 System.Object？

那些说这是扩展的`System.Object`人是错误的。一方面，此方法不会将值类型输入框起来，而是将定义的扩展方法`System.Object`。

您定义的扩展方法是一个通用参数化扩展方法。它可以应用于任何**作为泛型类型参数有效的类型**。

如果您还没有考虑以下方式的扩展方法，这可能会帮助您更好地理解它们。扩展方法只是语言规范让我们侥幸逃脱的一个技巧。扩展方法实际上只是静态类中的静态方法，我们可以像调用实例方法一样调用它们。所以

```
static class Foo {
    public static void M(this object obj) { }
} 
```

只是静态类中的静态方法。你可以这样称呼它：

```
Foo.M(obj); 
```

但我们可以将其称为实例方法：

```
obj.M(); 
```

因此，当你有一个通用的扩展方法时，停下来想想它是一个静态类中的静态方法

```
static class Foo {
    public static void M<T>(this T obj) { }
} 
```

你可以这样称呼它：

```
object obj;
Foo.M(obj); 
```

或者你可以这样称呼它：

```
obj.M(); 
```

您编写的编译器没有区别。

因此，现在您将其视为常规的通用方法。但是当您从这个角度考虑它时，您肯定会理解编译器将允许您在任何作为泛型类型参数有效的类型上调用此方法。因此，您现在明白了为什么它可以被认为是任何类型的扩展方法，它可以作为泛型类型参数有效。

# ruby-on-rails - 在rails中动态设置动态查找器

> ID：10014369
> 
> 赞同：0
> 
> 时间：2012-04-04T15:32:02.160
> 
> 标签：ruby-on-rails, activerecord, ruby-on-rails-3.1

我有 rake 任务从几个不同的来源和格式导入数千条记录，我希望在解析后干掉我的代码，他们目前使用 find_or_initialize_by_* 动态查找器创建或更新模型记录。

本质上，我希望能够传入 find_or_initialize_by_* 方法的 * 部分。

这是一些 sudo 代码来尝试解释我想要实现的目标。

```
def create_or_update_record(*args)
  model = args[0].classify.constantize
  identifier = args[1]
  attributes = args.extract_options!

  XXX = identifier

  record = model.find_or_initialize_by_XXX(identifier.to_sym => @identifier_value)

  attributes.each do |attribute|
   #set value of attribute here
  end

  record.save
end 
```

然后我会在产品导入中使用类似这样的东西从 rake 任务中调用...

```
 create_or_update_record('Product', 'product_id',{ 
    "product_id" => "1",
    "product_price" => "2.99"
  }) 
```

以及类别导入中的类似内容...

```
 create_or_update_record('Category', 'category_id',{ 
    "category_id" => "1",
    "category_name" => "Gloves"
  }) 
```

我猜我需要覆盖和扩展底层的method_missing。从我发现的这篇博文中看起来很复杂。[http://blog.hasmanythrough.com/2006/8/13/how-dynamic-finders-work](http://blog.hasmanythrough.com/2006/8/13/how-dynamic-finders-work)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-04T15:42:30.843

像这样的东西会起作用：

去创造

```
#record = model.find_or_initialize_by_XXX(identifier.to_sym => @identifier_value) 
```

我们将动态查找器发送到对象，并使用缺少的现有方法

```
identifier = "XXX"
record = model.send("find_or_initialize_by_#{identifier}", identifier.to_sym => @identifier_value) 
```

# url - Chrome 扩展跳转到 URL

> ID：10014372
> 
> 赞同：0
> 
> 时间：2012-04-04T15:32:22.990
> 
> 标签：url, google-chrome

我想做一个谷歌浏览器扩展。我想添加一个功能，所以当我点击它的图标时，它会打开一个带有特定 URL 的新标签。我怎样才能做到这一点？抱歉英语不好，我只是在学习那种语言；）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-06T19:46:22.353

如果您想在单击页面操作图标时在新选项卡中打开链接，可以使用 pageAction 的 onClicked 方法：[http ://code.google.com/chrome/extensions/pageAction.html#event-onClicked](http://code.google.com/chrome/extensions/pageAction.html#event-onClicked)

因此，在后台页面或脚本中添加以下行：

```
    chrome.pageAction.onClicked.addListener(function(tab) {
        windowObjectReference = window.open("http://google.com/", "DescriptiveWindowName", "resizable=yes,scrollbars=yes,status=yes");  
});

```

请注意，当页面操作具有在单击页面操作时显示的弹出页面时，不会触发 onClicked 事件。因此，为了使用 onCLicked 事件，您不应该有页面操作弹出页面

# autofac - Autofac：使用工厂委托解析具有可选参数的通用接口

> ID：10014378
> 
> 赞同：1
> 
> 时间：2012-04-04T15:32:46.153
> 
> 标签：autofac

我正在尝试使用 Autofac 执行以下操作：

我有一个班级 UnitOfWork：

```
public class UnitOfWork : IUnitOfWork
  {
  IContext contextA { get; set ;}
  IContext contextB { get; set ;}

  public UnitOfWork(IContext contextA, IContext contextB)
    {
    this.contextA = contextA;
    this.contextB = contextB;
    }

  public void Save()
    {
    this.contextA.Save();
    this.contextB.Save();
    }

  ...
  } 
```

我还有一个通用类 GenericRepo：

```
public class GenericRepo<T> : IRepo<T>
  {
  private IContext context;

  public GenericRepo(IContext context)
    {
    this.context = context;
    }
  } 
```

没有输入接口，但它们就在那里。

然后我有这些代表：

```
public delegate IUnitOfWork IUnitOfWorkFactory();

public delegate IRepo<T> IRepoFactory<T>(IUnitOfWork unitOfWork = null); 
```

现在问题是这样的：

我需要能够创建存储库。根据通用存储库的类型，它必须使用不同的上下文。我不希望调用代码必须知道 repo 正在使用什么上下文，所以我不能使用上下文作为参数，它必须是 UnitOfWork。

但是因为通用 repo 是通用的，它不知道从 UnitOfWork 获取什么上下文，所以它必须通过其构造函数获取上下文，而不是通过 UnitOfWork。

此外，有时调用代码并不关心 UnitOfWork（因为它不必保存），在这种情况下，必须动态创建 UnitOfWork - 它仍然需要从中获取数据。

所以我需要这个工作：

```
public void TestCode(IRepoFactory<TypeA> repoFacA, IRepoFactory<TypeB> repoFacB, IUnitOfWorkFactory uowFactory)
  {
  IRepo<TypeA> repoA = repoFacA(); //repoA has contextA from a new UnitOfWork
  IRepo<TypeB> repoB = repoFacB(); //repoB has contextB from a new (different) UnitOfWork

  IUnitOfWork uow = uowFactory();
  IRepo<TypeA> repoA_2 = repoFacA(uow); //repoA_2 has contextA from uow
  IRepo<TypeB> repoB_2 = repoFacB(uow); //repoB_2 has contextB from uow
  } 
```

换句话说，我需要能够使用参数调用泛型委托，并且根据类型，它需要使用该参数的属性构造一个类。

它还需要在没有参数的情况下工作，在这种情况下，Autofac 必须自己解析和使用参数。

关于如何在 AutoFac 中注册所有这些的任何想法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-05T08:10:42.733

好的，我自己找到的。

这就是我注册代表的方式：

```
 builder.Register((b, p) => new GenericRepo<TypeA>(((((p.First() as ConstantParameter)).Value as UnitOfWork) ?? b.Resolve<IUnitOfWork>()).ContextA)).As<IRepo<TypeA>>();
      builder.Register((b, p) => new GenericRepo<TypeB>(((((p.First() as ConstantParameter)).Value as UnitOfWork) ?? b.Resolve<IUnitOfWork>()).ContextB)).As<IRepo<TypeB>>(); 
```

编辑：

或者更好的是，以通用方式为第一个：

```
 builder.RegisterGeneric(typeof(GenericRepository<,>)).WithParameter((pi, icc) => true, (pi, icc) => (((((icc as IInstanceLookup).Parameters.First()) as ConstantParameter).Value as IUnitOfWork) ?? icc.Resolve<IUnitOfWork>()).ContextA).As(typeof(IEntityRepository<,>)); 
```

'WithParameter()' 的第一个参数必须存在，并且必须返回 true。我想如果我想过滤给出的参数，我必须在那里做。

反正。如果您有很多类型需要 ContextA，并且只有一些需要 contextB，这使得可以为 A 进行通用注册，然后为 B 添加异常。

总是欢迎有关如何使眼睛更干净或更容易的建议:-)

# android - 屏幕密度相同分辨率

> ID：10014382
> 
> 赞同：0
> 
> 时间：2012-04-04T15:33:00.493
> 
> 标签：android, screen

我有两个屏幕分辨率（800x480）和尺寸相同的安卓设备。不同之处在于一个屏幕是低密度 (120 dpi) 而另一个是正常密度 (160 dpi)。

我不明白为什么相同的 200x200 像素图像在屏幕上更小，密度更小，如果我写一个 200x200 像素的矩形在两个屏幕上是相同的。

任何人都可以解释我的原因吗？

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-04T15:45:30.920

ldpi 的 90 像素图像变成 120 px a mdpi、180 像素 hdpi 和 240 ad xhdpi。

您可以在此处找到有关它的更多信息（搜索“屏幕像素密度”）：[Dev Android Ressources](http://developer.android.com/guide/topics/resources/providing-resources.html#AlternativeResources)

关于密度的另一个好链接：[屏幕支持 - 密度](http://developer.android.com/guide/practices/screens_support.html)

# java - 如何更改用于 livetribe SLP 的端口？

> ID：10014385
> 
> 赞同：1
> 
> 时间：2012-04-04T15:33:05.013
> 
> 标签：java, slp

我正在尝试使用 LiveTribe SLP 模块 (http://livetribe.codehaus.org/LiveTribe-SLP) 为应用程序提供 SLP 服务。我想将端口从 427 完全更改为其他端口。文档很少，更令人困惑的是，在常见问题解答中，它声称链接到一个示例，该示例可以准确地向我展示我正在寻找的内容。不幸的是，它没有（除非我忽略了某些东西）。有谁知道如何做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-04T16:42:27.337

~~这里有一个客户端和服务器示例：http: [//livetribe.org/SLP-Examples-JMX](http://livetribe.org/SLP-Examples-JMX)~~
（链接断开。）

这些是服务器端的重要行：

```
// Allow this code to be run by non-root users on Linux/Unix
Settings settings = new MapSettings();
settings.put(Keys.PORT_KEY, 4427);

// Create the SLP ServiceAgent that advertises the JMX service
ServiceAgent serviceAgent = SLP.newServiceAgent(settings); 
```

在客户端：

```
 // Allow this code to be run by non-root users on Linux/Unix
Settings settings = new MapSettings();
settings.put(Keys.PORT_KEY, 4427);

// Create the SLP UserAgentClient that discovers services
UserAgentClient userAgentClient = SLP.newUserAgentClient(settings); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-05T14:37:19.070

对不起，糟糕的文档。自从我们将网站的 L&F 更改为使用 Twitter Bootstrap 后，我们就遇到了问题。
~~该页面现在应该完全呈现： http:
[//livetribe.org/SLP-Examples-JMX](http://livetribe.org/SLP-Examples-JMX)~~
链接已损坏。

# ruby-on-rails - 如何从 Ruby 运行非阻塞命令？

> ID：10014388
> 
> 赞同：1
> 
> 时间：2012-04-04T15:33:09.693
> 
> 标签：ruby-on-rails, ruby

*   用户进入页面 A 以创建新的多人游戏
*   页面 A 中的脚本为游戏生成一个唯一 ID，并为其创建一个工作器。类似于：rails runner GameWorker.new(:game_id => game_id).start_game
*   页面 A 中的脚本将用户重定向到页面 B，在那里他可以看到新创建的游戏，其他人也可以加入。

工人应该活着直到游戏结束。

运行启动工人的命令的正确方法是什么？它必须是非阻塞的，并且最好将输出重定向到日志文件，以防出现问题。

如果重要的话，我正在使用 Rails 3。

**更新** 我要改写我的问题：如何从 ruby​​ 中运行 linux 命令并且不等待命令结束？我的意思是 &>> 的等价物。例如，在 php 中，&>> 工作正常，我不需要使用任何特殊的 php 函数，但在 ruby​​ 中，它似乎被覆盖，脚本等待命令结束并获取输出。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-05T02:01:35.417

我强烈建议不要在每个游戏中运行一个进程。如果您想要一个非回合制的非阻塞游戏，那么您可能想要查看事件机器，或者类似[https://github.com/celluloid/celluloid-io](https://github.com/celluloid/celluloid-io)

无论使用哪种方式，您都将创建将在未来时间点处理的线程。

但是 - 如果您确实想在 ruby​​ 中启动一个进程，那么您就去吧.. 从[如何启动并忘记一个子进程？](https://stackoverflow.com/questions/806267/ruby-how-to-fire-and-forget-a-subprocess)

```
pid = Process.fork
if pid.nil? then
  # In child
  exec "whatever --take-very-long"
else
  # In parent
  Process.detach(pid)
end 
```

# entity-framework - 同时具有 FK 关系和 Navigation 属性

> ID：10014392
> 
> 赞同：0
> 
> 时间：2012-04-04T15:33:24.000
> 
> 标签：entity-framework

我正在使用 EF 4.1 模型优先方法

同一类型是否可以同时具有外键关系和导航属性。

例如，我有一个`Job`实体和一个`PaymentType_ID`与实体有外键关系的字段`PaymentType`。当我进行插入时，它工作正常。

然后我使用与 FK 相同的关联添加导航属性，当我尝试插入时，我收到以下错误“无效的列名`'PaymentType_PaymentTypeID'`”。

即使 FK 已经存在，EF 似乎出于某种原因自行添加了另一列。

这是可能的还是我做错了什么

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-04T15:39:41.577

是的，这是可能的，但您的属性不遵循默认命名约定，因此您必须手动将 FK 与导航属性配对，例如通过数据注释：

```
[ForeignKey("PaymentType_ID")] // Name of FK property
public virtual PaymentType PaymentType { get; set; } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-02-20T18:53:22.093

是的，有可能您应该清除导航属性和关系，请参阅：[https ://msdn.microsoft.com/en-us/data/jj713564](https://msdn.microsoft.com/en-us/data/jj713564)

# ruby-on-rails - 判断一个字符串是否为英文

> ID：10014394
> 
> 赞同：0
> 
> 时间：2012-04-04T15:33:29.617
> 
> 标签：ruby-on-rails, ruby, string

是否有一个库，我可以在其中简单地调用字符串上的方法来确定它是否是非英语的？我试图只保存英文字符串，而传入的字符串流中有很多非英文字符串。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-04T16:03:19.553

您可以尝试使用[linguo](https://github.com/NARKOZ/linguo#readme)。

```
"your string".lang
# will return "en" for english strings 
```

*免责声明：我是这颗宝石的创造者。*

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-04T15:43:52.730

您可以使用带有 RailsBridge 的 GoogleTranslate API - [http://code.google.com/apis/gdata/articles/gdata_on_rails.html](http://code.google.com/apis/gdata/articles/gdata_on_rails.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-04T15:38:17.383

不是我知道...但是您可以将此列表放入一个数组（http://www.langmaker.com/wordlist/basiclex.htm），然后将字符串的单词与之匹配...确定某个百分比一样好，然后从那里开始。

您甚至可以在这里使用贝叶斯算法将这些词标记为“好”并从那里学习，但这可能有点矫枉过正。

# ios - 重置 UIKeyboard 状态

> ID：10014396
> 
> 赞同：1
> 
> 时间：2012-04-04T15:33:46.760
> 
> 标签：ios, uitextfield, uitextview, uikeyboard

我有一个键盘输入值的 UITextView。但是，如果您清除文本值（即 uitextview.text = @""），则键盘的状态不会重置为小写字母键盘。

也就是说，如果我正在输入“hello..”并且文本视图被清除，键盘仍然显示符号，而不是返回字母。

有没有办法解决这个问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-05T05:27:23.753

事实证明

```
[textview resignFirstResponder] 
```

紧接着

```
[textview becomeFirstResponder] 
```

成功了。虽然它看起来确实有点“hacky”，但由于 Apple 没有提供对键盘的任何直接访问，这似乎是唯一的方法。

# c# - 如何定义通用约束以便我可以使用 ?? 合并算子

> ID：10014400
> 
> 赞同：3
> 
> 时间：2012-04-04T15:33:59.780
> 
> 标签：c#, generics

我正在尝试定义一个泛型类

```
public abstract class RepositoryBase<TDatabase, TKey, T> : IRepository<TKey, T> 
    where T : class
    where TDatabase : IDatabase
{
    private TDatabase db;

    private readonly IDbSet<T> dbset;

    protected IDatabaseFactory<TDatabase> DatabaseFactory { get; private set; }

    protected TDatabase Database
    {
        get
        {
            return db ?? (db = DatabaseFactory.Get());
        }
    }
    ...
} 
```

在线上`return db ?? (db = DatabaseFactory.Get());`，编译器抱怨“'??'的左操作数 运算符应该是引用或可为空的类型”

我理解错误，但不知道如何对 TDatabase 类型参数施加约束，以便编译器知道它是引用或可为空的类型。

如何让编译器满意？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-04T15:36:17.430

您必须指出这`TDatabase`是一个引用类型

```
where TDatabase : class, IDatabase 
```

* * *

[MSDN，类型参数的约束（C# 编程指南）](http://msdn.microsoft.com/en-us/library/d5x73970%28v=vs.100%29.aspx)

> **其中 T : class** 类型参数必须是引用类型；这也适用于任何类、接口、委托或数组类型。

[微软，?? 运算符（C# 参考）](http://msdn.microsoft.com/en-us/library/ms173224.aspx)：

> 这 ？？运算符称为空值合并运算符，用于为可空值类型或引用类型定义默认值。如果操作数不为空，则返回左侧操作数；否则返回正确的操作数。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-04T15:37:55.400

您可以将约束更改为包含`class`吗？

```
public abstract class RepositoryBase<TDatabase, TKey, T> : IRepository<TKey, T>  
    where T : class 
    where TDatabase : class, IDatabase 
{
    //... 
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-04T15:37:07.487

```
where TDatabase : class, IDatabase 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-04T15:40:29.470

尝试这个

```
public abstract class RepositoryBase<TDatabase, TKey, T> : IRepository<TKey, T>
    where T : class
    where TDatabase : class, IDatabase
{
} 
```

# actionscript-3 - AS3 数学：数组中的最近邻

> ID：10014401
> 
> 赞同：3
> 
> 时间：2012-04-04T15:34:05.990
> 
> 标签：actionscript-3, math

所以假设我有`T`，`T = 1200`。我还有`A`,`A`是一个包含 1000 个条目的数组，这些是数字条目，范围从`1000-2000`但不包括`1200`.

找到最近邻居（最接近的值）的最快方法是什么，假设我们 ceil 它，所以它会匹配`1201`，而不是`1199`in `A`。

**注意：**这将在`ENTER_FRAME`.

**另请注意：** `A`是静态的。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-04T16:34:47.793

`Vector.<int>`使用而不是`Array`做一个简单的for循环也非常快：

```
var vector:Vector.<int> = new <int>[ 0,1,2, /*....*/ 2000];

function seekNextLower( searchNumber:int ) : int {
    for (var i:int = vector.length-1; i >= 0; i--) {
        if (vector[i] <= searchNumber) return vector[i];
    }
}

function seekNextHigher( searchNumber:int ) : int {
    for (var i:int = 0; i < vector.length; i++) {
        if (vector[i] >= searchNumber) return vector[i];
    }
} 
```

使用任何数组方法都将比迭代更昂贵`Vector.<int>`- 它针对这种操作进行了优化。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-04T16:06:12.897

如果您希望在每个`ENTER_FRAME`事件上运行它，您可能会从一些额外的优化中受益。

如果您在将条目写入数组时跟踪它们，则不必对它们进行排序。

例如，您有一个数组，其中`T`的索引，它会有一个对象，该对象包含一个数组，该数组的所有索引都包含`A`该值。您还可以将最接近的值的索引作为该对象的一部分，因此当您每帧检索它时，您只需要访问该值，而不是搜索。

当然，这只有在你读的比写的多时才有帮助，因为重新创建对象非常昂贵，所以它真的取决于使用情况。

您可能还想查看链表，对于某些操作，它们要快得多（虽然排序较慢）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-04T16:20:35.613

由于您的数组已排序，因此您可以采用简单的二进制搜索（例如[在此答案](https://stackoverflow.com/questions/249392/binary-search-in-array)中解释）以找到“枢轴”，其中左细分和右细分在递归步骤中括号您正在“搜索”的值。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-04T15:47:23.963

您必须读取每个值，因此复杂性将是线性的。这很像在数组中找到最小的 int。

```
var closestIndex:uint;
var closestDistance:uint = uint.MAX_VALUE;
var currentDistance:uint;
var arrayLength:uint = A.length;

for (var index:int = 0; index<arrayLength; index++)
{
  currentDistance = Math.abs(T - A[index]);
  if (currentDistance < closestDistance || 
        (currentDistance == closestDistance && A[index] > T)) //between two values with the same distance, prefers the one larger than T
  {
    closestDistance = currentDistance;
    closestIndex = index;
  }
}

return T[closestIndex]; 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-04T16:21:55.150

只是我的一个想法......对A进行排序（因为它是静态的，你可以在开始之前对其进行一次排序），然后猜测开始猜测的索引（比如A的长度为100，你想要1200、100* (200/1000) = 20) 所以从那个猜测开始猜测，然后如果 A[guess] 高于 1200，则检查 A[guess-1] 处的值。如果它仍然更高，请继续向下，直到找到一个更高的和一个更低的。一旦你发现确定什么更接近。如果您最初的猜测太低，请继续向上。

这不会很好，也可能不是最好的性能，但它比检查每个值要好得多，并且如果 A 在 1000 和 2000 之间均匀分布，它将工作得很好。

祝你好运！

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-02-11T16:32:41.923

```
public function nearestNumber(value:Number,list:Array):Number{
    var currentNumber:Number = list[0];
    for (var i:int = 0; i < list.length; i++) {
        if (Math.abs(value - list[i]) < Math.abs(value - currentNumber)){
            currentNumber = list[i];
        }
    }
    return currentNumber;
} 
```

# mysql - (SQL) 如何根据另一个表的 ID 将值添加到表中？

> ID：10014402
> 
> 赞同：0
> 
> 时间：2012-04-04T15:34:06.123
> 
> 标签：mysql, sql, variables, insert, declare

每次将新用户添加到我的系统中时，我都需要能够将一组值添加到表中。

添加用户后，我想查看我的“标签”表，并在“标签”表中的每个 ID 的“标签分数”表中插入一个新条目。

我根据我在网上找到的东西尝试了以下方法，但虽然逻辑看起来很合理，但它似乎不起作用

```
DECLARE @LoopVar INTEGER
SET @LoopVar = ( SELECT MIN(Tag_Score.T_ID) 
FROM Tags ) WHILE @LoopVar IS NOT NULL 
BEGIN 
INSERT INTO  `a3360218_DD`.`Tag_Score` (
`A_ID` ,
`T_ID` ,
`Score` ,
`Visits`
)
VALUES (
'" . $accountID . "', @LoopVar ,  '0',  '0'
)
SET @LoopVar = ( SELECT MIN(Tag_Score.T_ID) 
FROM TheTable
WHERE @LoopVar < T_ID ) 
END 
```

给出的错误是：

```
#1064 - You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'WHILE @LoopVar IS NOT NULL 
BEGIN 
INSERT INTO  `a3360218_DD`.`Tag_Score` (

' at line 2 
```

提前致谢

马特

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-04T15:45:04.243

你还没有发布任何表格布局，所以我在这里在黑暗中拍摄，但这种查询应该适合你：

```
INSERT INTO Tag_Score (A_ID, T_ID, Score, Visits)
SELECT A_ID, T_ID, 0,  0
FROM Tags
WHERE A_ID = $accountID; 
```

注意删除所有不必要的反引号（即```），只有当您有一个保留字的模式名称时才需要，看看它现在的可读性如何！

保持简单 - 如果可以，请避免使用复杂的 SQL。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-04T15:47:17.163

我想您可能想要 CROSS JOIN，或者可能只是来自...的常规插入

```
insert into Tag_Score
select accountID, t.ID, 0, 0
from tags t
-- optional order by
-- order by t.ID 
```

# jquery - jQuery 对话框在长页面上的位置

> ID：10014406
> 
> 赞同：0
> 
> 时间：2012-04-04T15:34:20.037
> 
> 标签：jquery, jquery-ui

我有一个页面，上面有一个带有打开对话框的超链接的表格。这些页面很长，每一行都有一个链接，可以打开一个加载外部页面的对话框。

如果我在滚动之前单击任何链接，则对话框会在屏幕中间打开。如果我向下滚动页面，然后单击链接，则对话框会在页面中间打开，但浏览器会自动滚动到页面顶部。因此，根据您在页面上的位置，您根本看不到对话框。

我试图将对话框的位置设置为顶部，如下所示`$('.selector').dialog({ position: 'top' });`：我也尝试通过将位置设置为绝对来做到这一点，如下所示：`.ui-widget { position: absolute; }`

这些都没有奏效。我似乎无法让它工作。我可以在页面顶部或中间打开对话框，但我需要页面不要滚动离开对话框。

这是正在发生的事情的一个小例子 -[对话测试](http://dev.ziacorp.com/dialog_test.cfm)

我已经在 Firefox、chrome、safari 和 IE 中对此进行了测试。他们都做几乎相同的事情。

对此的任何帮助都会很棒。

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-04T15:37:15.350

当`href`锚点的 是 ID 选择器 ( `#<id>`) 时，浏览器会导航到具有该 ID 的元素。如果没有指定 ID，浏览器会转到页面顶部。

通过在处理程序中返回 false 来取消锚点的默认行为：

```
$(".vd").click(function(){
    $("#detailWin").dialog("open");
    return false;
}); 
```

通常避免这种情况的另一种解决方案是`href`将`javascript:void(0)`

```
<a href='javascript:void(0)'>Open dialog</a> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-04T15:38:55.310

尝试将 href='#' 更改为 href=' ' 。锚点会将您带到页面的开头。

# entity-framework-4 - 实体框架 4、TPH（按层次结构表）和注释

> ID：10014410
> 
> 赞同：2
> 
> 时间：2012-04-04T15:34:27.813
> 
> 标签：entity-framework-4, data-annotations

我目前尝试将我的应用程序从数据集迁移到 EF4。所以我有一个现有的数据库。根据列的值，其中一个表映射到 2 个类。因此，我处于具有现有表和现有鉴别器的 TBH 模式中。有没有办法使用注释来描述这个？

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-04T15:36:58.517

不能。TPH 鉴别器只能通过 Fluent-API 进行控制。

# java - TableModel 中的 JTable - 将按钮添加到每一行

> ID：10014412
> 
> 赞同：1
> 
> 时间：2012-04-04T15:34:34.093
> 
> 标签：java, jtable, tablemodel

我有一个学校项目，我需要为数据库创建一个 gui。该数据库包含 3 个表：

1.  披萨桌

2.  浇头表

3.  还有一个表，其中包含比萨饼和配料的外键。基本上这张表声明了披萨有什么配料。

`JTable`我现在可以通过自定义显示比萨表`TableModel`（表模型与数据库通信）。

但现在我想为表格添加两列。这些列将在每一行中包含两个按钮，一个用于删除实际行，一个用于打开一个对话框，该对话框可以编辑当前的比萨饼（添加配料、更改属性等）。

如果我从自定义表模型“馈送”JTable，如何添加这些列？我需要修改表模型，还是`JTable`？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-04T16:20:06.253

在' 单元格中添加（对和`JButton`使用正确的解决方法）是,`TableCellRenderer``TableCellEditor``JTable``Swing`

1) @camickrs[表格按钮栏](http://tips4java.wordpress.com/2009/07/12/table-button-column/)

2) 将[带有 JComponents 的 JPanel](https://stackoverflow.com/a/9726701/714968)添加到`JTable`' 列

# c++ - 添加需要管理员启动的程序

> ID：10014416
> 
> 赞同：1
> 
> 时间：2012-04-04T15:35:03.903
> 
> 标签：c++, windows, batch-file, registry, startup

> **可能重复：**
> [如何在 Windows 启动时以管理员身份自动运行程序？](https://stackoverflow.com/questions/5427673/how-to-run-a-program-automatically-as-admin-on-windows-startup)

我有一个用 C++ 编写的程序，需要管理员运行它（它不能以用户身份运行）。每当用户登录时，我都会尝试运行该程序，我尝试将“字符串”添加到

```
HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Run 
```

和

```
HKEY_CURRENT_USER\SOFTWARE\Microsoft\Windows\CurrentVersion\Run 
```

但它仅适用于不需要管理员权限的应用程序，它对我的​​程序没有影响。

我设法通过创建一个 BAT 文件将其添加到注册表来解决它，这会启动我的程序。但是，它会启动要求管理员访问权限的对话框。因此我们可以理解我无法使用这种方法启动它。

我想应该有一些方法，例如防病毒软件具有管理员权限。但它可以找到任何关于它的东西。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-04T17:52:44.063

考虑使用任务调度程序，查看此处了解详细信息：

[http://www.techrepublic.com/blog/window-on-windows/make-vista-launch-uac-restricted-programs-at-startup-with-task-scheduler/616](http://www.techrepublic.com/blog/window-on-windows/make-vista-launch-uac-restricted-programs-at-startup-with-task-scheduler/616)

# vb.net - 如何按长度对字符串数组进行排序

> ID：10014417
> 
> 赞同：2
> 
> 时间：2012-04-04T15:35:04.007
> 
> 标签：vb.net, arrays, sorting

我有一个字符串数组，例如“blue”、“green”、“red”，我希望对它们进行排序，以便最长的字符串排在第一位，最短的排在最后。

目前，我正在创建另一个数组，其中数组中每个字符串的长度位于相同的索引位置，并使用该数组作为键数组进行排序，如下所示，但我认为这可能优化为一行？

```
Dim colours() As string = {"blue", "green", "red"}
Dim colourslength() As Integer
For i As Integer = 0 To colours.Length - 1
 colourslength(i) = colours(i).Length
Next
Array.Sort(colourslength, colours)
Array.Reverse(colours) 
```

编辑：刚刚意识到我在示例代码中将颜色定义为一个列表，它是我实际代码中的一个数组。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-04T15:45:45.523

另一个 Linq 解决方案（警告，从 C# 转换而来）

```
Dim Sorted = From p In colours Order By p.Length Descending Select p 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-04T15:41:35.977

在我看来，这是短裤的方式。使用 linq。

```
Dim strs = New String() {"", "333", "22", "4444", "55555", "1"}
Dim sorted = strs.OrderBy(Function(x) x.Length).ThenBy(Function(x) x).ToArray() 
```

**编辑**

如果你想要一个相反的顺序，只需摆脱额外的方法调用，并以相反的顺序进行排序

```
Dim strs = New String() {"", "333", "22", "4444", "55555", "1"}
Dim sorted = strs.OrderByDescending(Function(x) x.Length).ThenByDescending(Function(x) x).ToArray 
```

干杯。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-04T15:43:00.833

```
Dim colours = {"blue", "green", "red"}
Dim coloursSortedByLength = colours.OrderByDescending(Function(c) c.Length) 
```

输出顺序为：绿、蓝、红。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-04T15:49:04.570

最好的简单方法是将每个字符串与列表中的所有其他字符串进行比较：

在 Java 中：

```
for(int i=0; i<list.length-1; i++){
    for(int j=i+1; j<list.length; j++){
        if(list[i].length() < list[j].length()){
            tmp = list[i];
            list[i] = list[j];
            list[j] = tmp;
        }
    }
} 
```

# php - 提供密码时的 MySQL 连接问题

> ID：10014418
> 
> 赞同：-1
> 
> 时间：2012-04-04T15:35:07.057
> 
> 标签：php, mysql, bash

当我尝试连接到本地 MySQL 数据库时，我从这三种方法中得到不同的结果：

1.  当我从提示连接以下内容时，它可以工作：

    mysql -u 根目录 -p

这种方式会提示我输入密码，一旦输入，我就会连接。

1.  当我连接 PHP 并提供服务器（localhost）、用户名（root）和密码时，它可以工作。

2.  当我连接 PHP 以运行如下命令时，它**不起作用：**

    exec('mysql -P 3306 -u root -p'.$password.' databasename < '.$scriptfilename);

当我在第一行提供密码时，我也无法让它从提示中工作。

当我查询用户 root 的 mysql.user 表时，有 3 个条目：

root@:: root@127.0.0.1 root@localhost

在同一行中提供密码时出现的错误是：

> 错误 1045 (28000): 用户 'root'@'localhost' 的访问被拒绝（使用密码：是）

有人知道发生了什么吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-04T16:08:17.663

如果您的密码包含 shell 将解释的特殊字符，除非您对它们进行转义，否则您将遇到问题。例如，大量标点符号会导致问题，例如`!`, `>`,`<`等等`|`。

不过，一般来说，如果可能的话，不要将密码放在命令行上！

引用 MySQL 的**[5.3.2.2。最终用户密码安全指南](http://dev.mysql.com/doc/refman/5.6/en/password-security-user.html)**文档：

> 在命令行上使用 -pour_pass 或 --password=your_pass 选项。
> 
> 这很方便但不安全，因为您的密码对系统状态程序（例如 ps）可见，其他用户可能会调用这些程序来显示命令行。

另一种选择是将密码存储在只有相关用户才能读取的文件中，并使用客户端配置文件：

> 将密码存储在选项文件中。

```
[client]
password=your_pass 
```

那么命令行将是：

```
mysql --defaults-file=/path/to/file_with_password 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-04T15:36:49.127

只需像这样添加主机参数：

```
exec('mysql -P 3306 -h localhost -u root -p'.$password.' databasename < '.$scriptfilename); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-04T15:38:34.413

您可以尝试使用--password= 而不是-p，我发现它更可靠

# gwt - ant gwt 编译器任务失败

> ID：10014421
> 
> 赞同：4
> 
> 时间：2012-04-04T15:35:09.117
> 
> 标签：gwt, compiler-construction, ant

我正在按照本[教程](http://www.rubiconred.com/blog/build-package-a-gwt-app-to-war-using-ant/)创建 java 编译的我的 ant 构建文件，而不是 GWT 编译而不是执行正确的操作来构建我的 .war 文件。

我使用 Eclipse 和 GWT-compile 工作，当我运行开发模式时它工作。我也成功部署在tomcat上。

事情是当我运行我的脚本时，编译工作但它在 gwt-compiler 任务上失败。我的蚂蚁构建脚本如下：

```
<project name="vlp" default="gwt.compile" basedir=".">
    <tstamp />
    <!-- ################# PROPERTIES ################ -->
    <!-- directory properties -->
    <!-- source -->
    <property name="projectName" value="VirtualLabPortal" />
    <property name="src.dir" location="src" />
    <property name="build.dir" location="bin" />
    <property name="src.build.dir" location="${build.dir}/src" />
    <property name="gwt.build.dir" location="${build.dir}/gwt" />
    <property name="gwt.unitCache.dir" location="gwt-unitCache" />
    <!-- libraries -->
    <property name="src.lib.dir" location="war/WEB-INF/lib" />

    <!-- ___________________________________________________________________
        |                                                                   |
        |               Configure path source/test                          |
        |___________________________________________________________________| 
    -->
    <path id="compile.path">
        <fileset dir="${src.lib.dir}" includes="*.jar" />
        <fileset dir="${src.lib.dir}/gwt" includes="*.jar" />
    </path>
    <!-- ___________________________________________________________________
        |                                                                   |
        |               Clean old compiled source/test/war                  |
        |___________________________________________________________________| 
    -->
    <target name="clean" description="Clean all the old build files.">
        <delete dir="${build.dir}" />
        <delete dir="${gwt.unitCache.dir}" />
        <delete file="${projectWar}" />
        <delete file="${src.lib.dir}/${projectJar}" />
    </target>
    <!-- ___________________________________________________________________
        |                                                                   |
        |                       Compile the source                          |
        |(should exclude gwtview code which is compiled by the gwt compiler)|   
        |___________________________________________________________________| 
    -->
    <target name="src.compile" depends="clean" description="Compile the source code when everything has been cleaned.">
        <mkdir dir="${src.build.dir}" />
        <javac encoding="utf-8" destdir="${src.build.dir}" nowarn="true">
            <src path="${src.dir}" />
            <classpath refid="compile.path" />
        </javac>
    </target>
    <!-- ___________________________________________________________________
        |                                                                   |
        |                       Invoke the GWT compiler                     |
        |___________________________________________________________________| 
    -->
    <property name="module.gwt.xml" location="${src.dir}/com/banctecmtl/ca/vlp" />
    <target name="gwt.compile" depends="src.compile">
        <java failonerror="true" fork="true" classname="com.google.gwt.dev.Compiler">
            <classpath>
                <!-- src dir is added to ensure the module.xml file(s) are on the classpath -->
                <pathelement location="${module.gwt.xml}" />
                <path refid="compile.path" />
            </classpath>
            <jvmarg value="-Xmx512m" />
            <arg line="${projectName} -logLevel ALL -style OBF -war ${build.dir}" />
        </java>
    </target>
    <!-- ___________________________________________________________________
        |                                                                   |
        |           Copy the config files in the war directory              |
        |___________________________________________________________________| 
    -->
    <property name="config.dir" location="war/config" />
    <target name="copy-resources">
        <copy todir="war/config" preservelastmodified="true">
            <fileset dir="${config.dir}">
                <include name="**.*" />
            </fileset>
        </copy>
    </target>
    <!-- ___________________________________________________________________
        |                                                                   |
        |           Create a Jar to be included in the war                  |
        |___________________________________________________________________| 
    -->
    <property name="projectJar" value="${projectName}.jar" />
    <property name="gwt.client.dir" location="com/banctecmtl/ca/vlp/view/webview" />
    <target name="jar" depends="src.compile">
        <!-- should also depend on gwt.compile -->
        <jar jarfile="${src.lib.dir}/${projectJar}" basedir="${src.build.dir}/">
            <!-- Don't wrap any of the client only code into the JAR
                <exclude name="${gwt.client.dir}/**/*.class"/> -->
            <exclude name="${gwt.client.dir}/**/*.class" />
        </jar>
    </target>
    <!-- ___________________________________________________________________
        |                                                                   |
        |                   Create a War from the source                    |
        |___________________________________________________________________| 
    -->
    <property name="projectWar" value="${projectName}.war" />
    <target name="war" depends="jar,copy-resources">
        <war basedir="war" destfile="${projectWar}" webxml="war/WEB-INF/web.xml">
            <exclude name="WEB-INF/**" />
            <webinf dir="war/WEB-INF/">
                <include name="lib/*.jar" />
                <include name="classes/*.properties" />
                <exclude name="**/gwt-dev.jar" />
                <exclude name="**/gwt-user.jar" />
            </webinf>
        </war>
    </target>

    <!-- ___________________________________________________________________
        |                                                                   |
        |                   Deploy to the production server                 |
        |___________________________________________________________________| 
    -->
    <!-- It is possible you can't run this from eclipse,
     you need to edit the run configurations and add the 
     latest jsch library to the classpath -->
    <property name="user" value="root" />
    <property name="password" value="Banctec01" />
    <property name="prodHost" value="vlp" />
    <property name="dest" value="/usr/share/tomcat6/webapps/ROOT.war" />
    <target name="deploy" depends="war">
        <echo message="Copying to : ${user}@${prodHost}:${dest}" />
        <scp file="${projectWar}" remoteTofile="${user}@${prodHost}:${dest}" password="${password}" trust="true" />
    </target>
</project> 
```

它失败并出现以下错误：

```
Buildfile: D:\workspace\vlp\build.xml
clean:
   [delete] Deleting directory D:\workspace\vlp\war\WEB-INF\classes
src.compile:
    [mkdir] Created dir: D:\workspace\vlp\war\WEB-INF\classes
    [javac] D:\workspace\vlp\build.xml:42: warning: 'includeantruntime' was not set, defaulting to build.sysclasspath=last; set to false for repeatable builds
    [javac] Compiling 134 source files to D:\workspace\vlp\war\WEB-INF\classes
    [javac] Note: D:\workspace\vlp\src\com\banctecmtl\ca\vlp\controller\schedule\ScheduledTaskManager.java uses unchecked or unsafe operations.
    [javac] Note: Recompile with -Xlint:unchecked for details.
gwt.compile:
     [java] Checking for updates
     [java]    First launch was 134c3e23387
     [java]    Last ping was Mon Apr 23 14:42:48 EDT 2012, min wait is 86400000ms
     [java] Module location: file:/D:/workspace/vlp/src/com/banctecmtl/ca/vlp/VirtualLabPortal.gwt.xml
     [java] Loading inherited module 'com.google.gwt.user.User'
     [java]    Module location: jar:file:/D:/workspace/vlp/war/WEB-INF/lib/gwt/gwt-user.jar!/com/google/gwt/user/User.gwt.xml
     [java]    Loading inherited module 'com.google.gwt.animation.Animation'
     [java]       Module location: jar:file:/D:/workspace/vlp/war/WEB-INF/lib/gwt/gwt-user.jar!/com/google/gwt/animation/Animation.gwt.xml
     [java]       Loading inherited module 'com.google.gwt.core.Core'
     [java]          Module location: jar:file:/D:/workspace/vlp/war/WEB-INF/lib/gwt/gwt-user.jar!/com/google/gwt/core/Core.gwt.xml
     [java]          Loading inherited module 'com.google.gwt.dev.jjs.intrinsic.Intrinsic'
     [java]             Module location: jar:file:/D:/workspace/vlp/war/WEB-INF/lib/gwt/gwt-dev.jar!/com/google/gwt/dev/jjs/intrinsic/Intrinsic.gwt.xml
     [java]             Loading inherited module 'com.google.gwt.lang.LongLib'
     [java]                Module location: jar:file:/D:/workspace/vlp/war/WEB-INF/lib/gwt/gwt-dev.jar!/com/google/gwt/lang/LongLib.gwt.xml
     [java]          Loading inherited module 'com.google.gwt.emul.Emulation'
     [java]             Module location: jar:file:/D:/workspace/vlp/war/WEB-INF/lib/gwt/gwt-user.jar!/com/google/gwt/emul/Emulation.gwt.xml
     [java]             Loading inherited module 'com.google.gwt.logging.LogImpl'
     [java]                Module location: jar:file:/D:/workspace/vlp/war/WEB-INF/lib/gwt/gwt-user.jar!/com/google/gwt/logging/LogImpl.gwt.xml
     [java]          Loading inherited module 'com.google.gwt.xhr.XMLHttpRequest'
     [java]             Module location: jar:file:/D:/workspace/vlp/war/WEB-INF/lib/gwt/gwt-user.jar!/com/google/gwt/xhr/XMLHttpRequest.gwt.xml
     [java]             Loading inherited module 'com.google.gwt.core.Core'
     [java]                Module 'com.google.gwt.core.Core' has already been loaded and will be skipped
     [java]          Loading inherited module 'com.google.gwt.core.CompilerParameters'
     [java]             Module location: jar:file:/D:/workspace/vlp/war/WEB-INF/lib/gwt/gwt-user.jar!/com/google/gwt/core/CompilerParameters.gwt.xml
     [java]          [...]
     [java]    Loading inherited module 'com.google.gwt.user.User'
     [java]       Module 'com.google.gwt.user.User' has already been loaded and will be skipped
     [java] Public resources found in...
     [java] Translatable source found in...
     [java] Persistent unit cache dir set to: D:\workspace\vlp\war\..\gwt-unitCache
     [java] Compiling module VirtualLabPortal
     [java] Looking for previously cached Compilation Units in D:\workspace\vlp\war\..\gwt-unitCache
     [java] Loaded 0 units from persistent store.
     [java] Starting UnitWriteThread.
     [java]    Found 0 cached units.  Used 0 / 2413 units from cache.
     [java] [ERROR] Unexpected internal compiler error
     [java] java.lang.RuntimeException: Exception processing units
     [java]     at com.google.gwt.dev.javac.CompilationStateBuilder$CompileMoreLater.compile(CompilationStateBuilder.java:248)
     [java]     at com.google.gwt.dev.javac.CompilationStateBuilder.doBuildFrom(CompilationStateBuilder.java:447)
     [java]     at com.google.gwt.dev.javac.CompilationStateBuilder.buildFrom(CompilationStateBuilder.java:370)
     [java]     at com.google.gwt.dev.cfg.ModuleDef.getCompilationState(ModuleDef.java:360)
     [java]     at com.google.gwt.dev.Precompile.precompile(Precompile.java:252)
     [java]     at com.google.gwt.dev.Precompile.precompile(Precompile.java:233)
     [java]     at com.google.gwt.dev.Precompile.precompile(Precompile.java:145)
     [java]     at com.google.gwt.dev.Compiler.run(Compiler.java:232)
     [java]     at com.google.gwt.dev.Compiler.run(Compiler.java:198)
     [java]     at com.google.gwt.dev.Compiler$1.run(Compiler.java:170)
     [java]     at com.google.gwt.dev.CompileTaskRunner.doRun(CompileTaskRunner.java:88)
     [java]     at com.google.gwt.dev.CompileTaskRunner.runWithAppropriateLogger(CompileTaskRunner.java:82)
     [java]     at com.google.gwt.dev.Compiler.main(Compiler.java:177)
     [java] Caused by: java.lang.NoSuchMethodError: com.google.gwt.dev.jjs.ast.JProgram.serializeTypes(Ljava/util/List;Ljava/io/ObjectOutputStream;)V
     [java]     at com.google.gwt.dev.javac.CompilationUnitImpl.<init>(CompilationUnitImpl.java:68)
     [java]     at com.google.gwt.dev.javac.SourceFileCompilationUnit.<init>(SourceFileCompilationUnit.java:48)
     [java]     at com.google.gwt.dev.javac.CompilationUnitBuilder$ResourceCompilationUnitBuilder.makeUnit(CompilationUnitBuilder.java:154)
     [java]     at com.google.gwt.dev.javac.CompilationUnitBuilder.build(CompilationUnitBuilder.java:266)
     [java]     at com.google.gwt.dev.javac.CompilationStateBuilder$CompileMoreLater$1.run(CompilationStateBuilder.java:223)

BUILD FAILED
D:\workspace\vlp\build.xml:60: Java returned: 1

Total time: 36 seconds 
```

我发现将 gwt-compiler 类名更改为 DevMode 正在成功构建。使用 :`classname="com.google.gwt.dev.DevMode"`而不是`classname="com.google.gwt.dev.Compiler"`.

编辑：我重构了上面的 XML。build.xml 清除所有 bin 目录。我还将指向`javac`目录`bin/src`和 Google Web Toolkit 编译器输出的指针指向 : `bin/gwt`。编译器还是不行...

编辑：我立即从谷歌开发者网站下载了最新的 SDK，并覆盖了在我的类路径和我的 Eclipse 插件中找到的旧库。仍然无法使用 ant 构建脚本。

有人知道这里可能是什么问题吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-30T21:10:18.220

我只能说该方法`com.google.gwt.dev.jjs.ast.JProgram.serializeTypes(Ljava/util/List;Ljava/io/ObjectOutputStream;)V`仅在[gwt-dev 2.4.0](http://grepcode.com/file/repo1.maven.org/maven2/com.google.gwt/gwt-dev/2.4.0/com/google/gwt/dev/jjs/ast/JProgram.java#JProgram.serializeTypes%28java.util.List,java.io.ObjectOutputStream%29)中引入。[它在gwt-dev 2.3.0](http://grepcode.com/file/repo1.maven.org/maven2/com.google.gwt/gwt-dev/2.3.0/com/google/gwt/dev/jjs/ast/JProgram.java#JProgram)中不存在。

这意味着在类路径中的某个地方，有两个 gwt-dev 版本。其中之一是 2.4.0，这就是`com.google.gwt.dev.javac.CompilationUnitImpl`寻找该方法的原因。另一个是 2.3.0 或更早版本，这就是找不到该方法的原因（`JProgram`编译器使用旧版本加载了类）。

尝试彻底查找它们。或者尝试开始一个新的环境，在其中你密切关注正在发生的事情。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-02T23:21:27.690

**tl;dr：这是由于在类上下文不充分或不正确的情况下提供的`Compiler`链接器存在差异`DevMode`**

## 追踪问题

我注意到您拥有的复制品存在于当前[GWT 主干](http://code.google.com/p/google-web-toolkit/source/browse/#svn/trunk)中。具体来说，它在这段代码中失败了：

```
ArrayList<CompilationUnit> resultUnits = new ArrayList<CompilationUnit>();
      do {
        // Compile anything that needs to be compiled.
        buildQueue = new LinkedBlockingQueue<CompilationUnitBuilder>();
        final ArrayList<CompilationUnit> newlyBuiltUnits = new ArrayList<CompilationUnit>();
        final CompilationUnitBuilder sentinel = CompilationUnitBuilder.create((GeneratedUnit) null);
        final Throwable[] workerException = new Throwable[1];
        Thread buildThread = new Thread() {
          @Override
          public void run() {
            try {
              do {
                CompilationUnitBuilder builder = buildQueue.take();
                if (builder == sentinel) {
                  return;
                }
                // Expensive, must serialize GWT AST types to bytes.
                CompilationUnit unit = builder.build(); // <-- Right here.
                newlyBuiltUnits.add(unit);
              } while (true);
            } catch (Throwable e) {
              workerException[0] = e;
            }
          }
        }; 
```

展开堆栈比您的跟踪更远，我们通过一个工厂和十层代码反弹，直到我们最终点击[UnifyAst.java](http://code.google.com/p/google-web-toolkit/source/browse/trunk/dev/core/src/com/google/gwt/dev/jjs/impl/UnifyAst.java)。而且，你瞧：

```
...
mapApi(enclosingType);

// Now the method should be there.
method = methodMap.get(sig);
if (method == null) {
  // TODO: error logging
  throw new NoSuchMethodError(sig);
}
assert !method.isExternal();
return method;
... 
```

`NoSuchMethodError`这是GWT 的预编译阶段调用的唯一实例。

## Compiler 和 DevMode 链接的差异

凉爽的。既然我们已经深入研究了为什么会爆炸，那么让我们弄清楚为什么会`DevMode`起作用，而`Compiler`不会起作用。我们注意到两者都导入了[Util.java](http://code.google.com/p/google-web-toolkit/source/browse/trunk/dev/core/src/com/google/gwt/dev/util/Util.java)的相同副本，因此*从技术上讲*，这两种类型都可以静态地用于我们的 Java 编译器（只是不是 GWT 编译器）。

检查链接器，我们注意到直接[`Compiler`](http://code.google.com/p/google-web-toolkit/source/browse/trunk/dev/core/src/com/google/gwt/dev/Compiler.java)使用[`Link.link`](http://code.google.com/searchframe#T04cSGC7sWI/trunk/dev/core/src/com/google/gwt/dev/Link.java)：

```
Link.link(logger.branch(TreeLogger.TRACE, logMessage), module,
          generatedArtifacts, allPerms, resultFiles, options.getWarDir(),
          options.getDeployDir(), options.getExtraDir(), precompileOptions); 
```

而[`DevMode`](http://code.google.com/p/google-web-toolkit/source/browse/trunk/dev/core/src/com/google/gwt/dev/DevMode.java)使用更简洁的静态调用，并使用单独的传递填充以下实例[`StandardLinkerContext`](http://code.google.com/p/google-web-toolkit/source/browse/trunk/dev/core/src/com/google/gwt/core/ext/linker/impl/StandardLinkerContext.java)：

```
link(loadLogger, module);

...

@Override
protected synchronized void produceOutput(TreeLogger logger, StandardLinkerContext linkerStack,
      ArtifactSet artifacts, ModuleDef module, boolean isRelink) throws UnableToCompleteException {

    ...
    linkerStack.produceOutput(linkLogger, artifacts, Visibility.Public, outFileSet);
    linkerStack.produceOutput(linkLogger, artifacts, Visibility.Deploy, deployFileSet);
    linkerStack.produceOutput(linkLogger, artifacts, Visibility.Private, extraFileSet);
    ...
} 
```

## 伟大的！那么，我该如何解决呢？

正如在写这篇文章的中间所接受的那样，yair[为这个问题提供了一个这样的诊断，](https://stackoverflow.com/a/10390620/517815)并指出在两个版本的 GWT 的上下文中，预编译步骤对于冲突的类身份是非鲁棒的。`precompilation.getGeneratedArtifacts();`拉入错误或不足对象的其他类可见性问题也可能导致此重现。

鉴于 yair 已获得接受的答案状态，我将假设问题现已解决。但是对于其他在这篇文章中运行的人来说，可以想象其他类路径或可见性问题可能会导致这个确切的问题再次发生。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-04T16:43:11.737

GWT 编译器不支持 java.io.ObjectOutputStream 类。在使用 Java 类之前，
您必须参考[https://developers.google.com/web-toolkit/doc/latest/RefJreEmulation#Package_java_io以确保 GWT 支持它。](https://developers.google.com/web-toolkit/doc/latest/RefJreEmulation#Package_java_io)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-26T22:12:39.833

你 fork 一个 JVM 来运行 Gwt Compiler 并且`bin`目录在 ClassPath 中。

由于 Eclipse 在开发模式下编译，剩余的类`bin`可能会阻止编译器正确处理某些源文件。

在调用 Ant 目标之前，您应该确保 bin 目录为空。到时可能会过去。

我建议您使用两个目标目录：一个用于从 Java 源编译的类，另一个用于 GWT 生成的文件。然后目标`war`将两者都收集到 WAR 中。

# ruby-on-rails-3 - 放置许多控制器和视图将使用的 Rails 功能的最佳位置在哪里

> ID：10014426
> 
> 赞同：0
> 
> 时间：2012-04-04T15:35:22.377
> 
> 标签：ruby-on-rails-3

我有很多需要在控制器和视图中访问的功能。

放置这些功能的最佳位置在哪里？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-04T15:49:04.367

用于在整个应用程序中进行视图格式化的函数属于 . `ApplicationHelper`，但是这些辅助函数不应执行它们自己的任何控制器逻辑。换句话说，他们不应该负责调用模型实例或对它们做任何事情。

调用模型的函数，或提供将由其他控制器使用的对象或数据并对其进行操作的函数更合适地存储在`ApplicationController`. 例如，这些功能类似于在其他控制器中访问应用程序范围的登录状态所需的功能。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-04T15:38:27.897

此类常用函数的最佳位置是 application_controller.rb。我用它来放置代码来检查用户是否已登录以确定他/她是否需要再次登录。

# php - 将 HTML5 地理定位与 PHP 和 MySql 结合使用

> ID：10014427
> 
> 赞同：0
> 
> 时间：2012-04-04T15:35:23.390
> 
> 标签：php, mysql, html, geolocation

我正在为一个需要使用 PHP 和 MySql 的大学项目构建一个 Web 应用程序。我计划使用 HTML5 Geolocation 来请求访问表单上已登录用户的位置。一旦他们接受并提交了表单，我希望将位置信息存储在 MySql 数据库中，然后以谷歌地图的形式在另一个页面上调用，并在提交表单的区域有一个图钉。

我进行了搜索，但找不到任何确凿的证据表明这将是一种可行的方法。所以我的问题是这（相对）简单易做，更重要的是它是捕获用户位置数据的可靠方法吗？

这个想法是用户将使用该应用程序来报告他们所在区域的问题，例如坑洼。用户可以通过允许使用 Geolocation 登录并报告问题和位置。然后将问题记录在“问题”页面上，市议会可以在该页面上查看并查看报告的来源。

任何提示都会很棒！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-04T15:39:39.937

这是一种非常合理的方法。查看谷歌地图示例：[https ://google-developers.appspot.com/maps/documentation/javascript/examples/map-geolocation](https://google-developers.appspot.com/maps/documentation/javascript/examples/map-geolocation)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-04T15:40:31.873

那么它的准确性差异很大。有时它可以精确到几米，而其他时候则在几公里之外。这种检测大部分基于网络和跟踪路由，因此您永远无法保证完全准确。

我建议为您的项目使用地址。谷歌可以轻松地在地址上投射大头针，而且这很可能是城市内部使用的。

# jquery - 需要先点击页面才能点击任何链接

> ID：10014430
> 
> 赞同：1
> 
> 时间：2012-04-04T15:35:29.120
> 
> 标签：jquery, asp.net-mvc-3, razor

我在一个项目中使用 JQuery 和 MVC3 剃须刀，我有一个相当奇怪的鼠标点击问题。发生的情况是，当页面加载时，我被迫在鼠标/浏览器/网页识别出我正在单击链接之前单击页面中的某个位置。这发生在每个页面上，无论我单击什么链接、按钮、输入等。

我可以发布一些代码，但我不确定要发布哪个代码，因为这个问题渗透到整个网站，而且我在一篇帖子中可能无法找到更多的代码。我相信它与 jquery/javascript 有关，但我不确定。

我不知道在哪里寻找问题，以前有人遇到过这个问题吗？如果是这样，你是如何纠正这个问题的？

提前感谢您的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-04T15:44:06.943

我很确定这一定是一个表现问题，可能与一些 CSS 问题有关，你能[JSFiddle](http://jsfiddle.net/)吗？

或者也许在没有任何 CSS 的情况下测试您自己的页面？（只需注释掉 CSS 链接标签）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-05T04:12:16.883

我的建议是在您的整个解决方案中搜索所有`.click(`和`bind('click'`几乎所有 jquery 点击事件，并查看您在项目中定义的所有点击事件是否合法。此外，我建议开始剥离脚本和 CSS 层，看看是否可以复制问题；注释掉所有的 CSS，看看你是否注意到了这个问题，然后开始注释掉所有的核心 JS。我认为您在 CSS 或 Java Script 中所做的一些微妙的事情导致了这个问题，您需要回过头来找出它是什么。

# jquery - 如何在 WCF 中设置 cookie 并在调用 Ajax 的成功函数（或其他地方）中读取它

> ID：10014432
> 
> 赞同：2
> 
> 时间：2012-04-04T15:35:41.683
> 
> 标签：jquery, ajax, wcf, cookies, httpresponse

我有一些 jQuery JavaScript 调用一个简单的 WCF Web 服务。对我来说，在 JavaScript 中设置一个 cookie 并在服务器端读取它是相当容易的。

这是那个代码。

客户端（JavaScript）：

```
document.cookie = "father=christmas"; 
```

服务器端（WCF 中的 C#）：

```
var cookieHeader = WebOperationContext.Current.IncomingRequest.Headers[System.Net.HttpRequestHeader.Cookie];
if (!String.IsNullOrEmpty(cookieHeader))
{
    var match = cookieHeader.Split(';').Select(cookie => cookie.Split('=')).FirstOrDefault(kvp => kvp[0] == "father");
    if (match != null)
    {
        result = match[1]; // result now equals "christmas"
    }
} 
```

但我也想在服务器上的 WCF 中设置一个 cookie 并在客户端读取它。这是我的代码未能做到这一点。

服务器端（WCF 中的 C#）：

```
WebOperationContext.Current.OutgoingResponse.Headers[System.Net.HttpResponseHeader.SetCookie] = "cloud=lonely"; 
```

客户端（jQuery JavaScript）：

```
$(document).ready(function () {
    $.ajax({
        url: "/ScratchpadSite/Service.svc/Hallo",
        type: "POST",
        success: function (data, textStatus, jqXHR) {
            var xrh = jqXHR.getAllResponseHeaders();
            $('body').html('<p>Father ' + data.d + '<\/p>');
        },
        error: function (jqXHR, textStatus, errorThrown) {
            $('body').html('<p>' + textStatus + ': ' + errorThrown + '<\/p>');
        }
    });
}); 
```

但是 xhr 的值（我希望包含我的 'cloud=lonely' cookie 的变量）是

```
服务器：ASP.NET 开发服务器/10.0.0.0
日期：格林威治标准时间 2012 年 4 月 4 日星期三 15:29:27
X-AspNet-版本：4.0.30319
内容长度：17
缓存控制：私有
内容类型：应用程序/json；字符集=utf-8
连接：关闭

```

（注意我的网页（包括 JavaScript）和 WCF 服务驻留在同一台服务器上，因此应该没有跨域问题。）

我是否正确设置了响应标头 cookie？如果是这样，我应该在哪里寻找返回给客户的价值？如果不是，我应该怎么做？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-05T11:03:29.393

我希望这不是答案，但对[这个问题](https://stackoverflow.com/q/7197455/575530)有一些有趣的评论。[Jfriend00](https://stackoverflow.com/users/816620/jfriend00)指出，根据[此 W3 规范](http://www.w3.org/TR/XMLHttpRequest/#the-getresponseheader-method)getAllResponseHeaders() 将返回除 Set-Cookie 标头之外的所有标头。[Dan Tao](https://stackoverflow.com/users/105570/dan-tao)解释说，虽然浏览器会（可能？）在浏览器处理响应后复制 cookie 信息，但直到调用回调之后才会发生这种情况！Dan 建议“在完整的回调中进行某种 setTimeout 交易”。

[Drew Marsh](https://stackoverflow.com/users/185859/drew-marsh)在对[他对“WCF -> ASMX 和 Cookies”的回答](https://stackoverflow.com/a/1604300/575530)的评论中建议的另一个可能的选项（我没有尝试过）是在 WCF 代码中使用消息检查器。

我不愿意设置超时（感觉像 hack），我发现 WCF 代码更难遵循消息检查器的部分逻辑，所以在等待另一个答案时，我将写入响应标头本身（而不是cookie）在 WCF 代码中，如下所示：

```
WebOperationContext.Current.OutgoingResponse.Headers.Add("cloud", "lonely"); 
```

然后在 JavaScript/jQuery/Ajax 完整处理程序中读取它，然后将其写入 cookie，如下所示：

```
$(document).ready(function () {
    $.ajax({
        url: "/ScratchpadSite/Service.svc/Hallo",
        type: "POST",
        success: function (data, textStatus, jqXHR) {
            $('body').html('<p>Father ' + data.d + '<\/p>');
        },
        error: function (jqXHR, textStatus, errorThrown) {
            $('body').html('<p>' + textStatus + ': ' + errorThrown + '<\/p>');
        },
        complete: function (jqXHR, textStatus) {
            var cloudsFeeling = jqXHR.getResponseHeader("cloud");
            if (cloudsFeeling) {
                document.cookie = "cloud=" + cloudsFeeling;
            }
        },
    });
}); 
```

我不喜欢使用 HTTPResponseHeader 代替 cookie，我认为它是为此用途而设计的，所以请提出更好的答案。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-25T19:18:12.547

[您可以使用$.cookie 插件](https://github.com/carhartl/jquery-cookie)以非常智能的方式处理 cookie，该插件允许您读取、写入和删除 cookie

希望对你有帮助。。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-03T17:40:52.387

之前由您发送 HTTP 请求的同一域设置的所有 cookie 都应在您的请求中自动发送，换句话说，所有 cookie 都在 HTTP 请求中自动发送，以便 HTTP 请求前往的域之前设置了该 cookie . 在响应方式中，如果您想在客户端设置 cookie，您可以添加名为“Set-Cookie”的响应标头

# php - self::__construct() 和 new self() 之间的确切区别

> ID：10014436
> 
> 赞同：6
> 
> 时间：2012-04-04T15:35:47.810
> 
> 标签：php, class, constructor, instance

`return self::__construct()`你能告诉我和之间的确切区别`return new self()`吗？

似乎一个人实际上可以在创建对象时`self::__construct()`从`__construct()`调用中返回 a ，返回对象本身，就好像第一个`__construct()`从未被调用过一样。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-04T15:48:55.603

这在代码中得到了最好的说明：

```
class MyClass {

   public $arg;

   public function __construct ($arg = NULL) {
     if ($arg !== NULL) $this->arg = $arg;
     return $this->arg;
   }

   public function returnThisConstruct () {
     return $this->__construct();
   }

   public function returnSelfConstruct () {
     return self::__construct();
   }

   public function returnNewSelf () {
     return new self();
   }

}

$obj = new MyClass('Hello!');
var_dump($obj);
/*
  object(MyClass)#1 (1) {
    ["arg"]=>
    string(6) "Hello!"
  }
*/

var_dump($obj->returnThisConstruct());
/*
  string(6) "Hello!"
*/

var_dump($obj->returnNewSelf());
/*
  object(MyClass)#2 (1) {
    ["arg"]=>
    NULL
  }
*/

var_dump($obj->returnSelfConstruct());
/*
  string(6) "Hello!"
*/ 
```

`return self::__construct()`返回由 objects方法返回的*值。*`__construct`它还会再次运行构造函数中的代码。当从类`__construct`方法本身调用时，返回`self::__construct()`实际上将返回构造的类本身，就像该方法通常所做的那样。

`return new self();`返回调用对象类*的新实例*。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-04-04T15:40:05.013

我相信这`new self()`会创建一个新的类实例，而`self::__construct ()`只调用类`__construct`方法。

# javascript - 您可以在文档之外的元素上运行 execcommand 吗？

> ID：10014441
> 
> 赞同：1
> 
> 时间：2012-04-04T15:35:58.790
> 
> 标签：javascript, contenteditable, execcommand

你可以`execcommand`在文档之外的元素上做吗？

我想知道你是否可以编写这样的代码：

```
contentDiv.execCommand() 
```

代替：

```
document.execCommand() 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-04T16:04:31.177

No.`execCommand()`仅限于`HTMLDocument`节点（请参阅[进行中的 HTML 编辑规范](http://dvcs.w3.org/hg/editing/raw-file/tip/editing.html#execcommand%28%29)），除了 IE，它们的专有`TextRange`和`ControlRange`对象[也支持`execCommand()`](http://msdn.microsoft.com/en-us/library/ms536419%28v=vs.85%29.aspx).

# css - 如果 CSS 样式元素不包含其他特定类型的元素

> ID：10014443
> 
> 赞同：1
> 
> 时间：2012-04-04T15:24:39.323
> 
> 标签：css, image, anchor

我的 CSS 包括以下内容：

```
#mainbody a[href ^='http']      {
        background:transparent url('/images/icons/external.svg') no-repeat top right;
        padding-right: 12px;
} 
```

这会在以“http”开头的链接旁边放置一个“外部”图标（所有内部站点链接都是相对的）。工作得很好，除非我链接一个图像，它也会得到这个图标。

例如：`<a href='http://example.com'><img src='whatever.jpg'/></a>`还会在图像旁边获得“外部”图标。如有必要，我可以忍受这个，但想消除它。

这必须在 CSS（无 JS）中实现；不得要求图像的 html 中的任何特殊 ID、类、样式或图像周围的锚点。这可能吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-04T15:34:19.097

您可以：-

*   仅对图像使用相对链接
*   链接到图像的裸域（例如[http://domain.com](http://domain.com)）并将外部链接过滤器修复为 www。而不是http。

不需要 CSS - 您基本上需要使用不太常见的过滤器。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-04T16:55:18.057

它区分大小写。只需将所有封顶的 HTTP: 用于图像链接。

# jquery - 缩略图上的悬停暂停

> ID：10014457
> 
> 赞同：0
> 
> 时间：2012-04-04T15:36:36.650
> 
> 标签：jquery, pagination, slideshow, thumbnails

[我正在使用在http://slidesjs.com](http://slidesjs.com)找到的 slidesjs jquery 幻灯片，我需要能够使用 ul.pagination 而不是幻灯片容器作为暂停。这样它会在将鼠标悬停在缩略图而不是幻灯片上时暂停幻灯片。

这是我用于此幻灯片的标准 js 文件 的[链接。](https://docs.google.com/open?id=0BygiprsMTsKTZGdSeGxzbjBUdWlwejh2RzZQN01qQQ)

**如果您对手头的问题没有洞察力，请不要更正语法错误。我是来寻求编码而不是语法的帮助。

# c# - ASP.NET MVC 3 使用升序、降序选项对 WebGrid 进行自定义排序

> ID：10014460
> 
> 赞同：3
> 
> 时间：2012-04-04T15:36:46.370
> 
> 标签：c#, asp.net-mvc-3, sorting, webgrid

Helo，我正在开发一个 ASP.NET MVC 3 应用程序。

我有一个观点

```
var grid = new WebGrid(rowsPerPage: 10, ajaxUpdateContainerId: "GridDiv",canPage: true,canSort: true);
grid.Bind(source: Model);
grid.Pager(WebGridPagerModes.All);
@grid.GetHtml(htmlAttributes: new { id="grid" },
    columns: grid.Columns(
    grid.Column("Name"),
    grid.Column("Age"),
    grid.Column("Sex")
) 
```

在控制器中，我有一个自定义的排序算法来对数据进行排序。我有自定义升序排序和自定义降序排序。

当用户单击列标题时，我希望按照我的自定义排序算法而不是内置排序算法对行进行排序。

为此，我尝试了以下方法（我采用“sortdir”并相应地处理它）

控制器

```
public ActionResult Persons(string sortdir)
{    
    PersonsListModel = GetAllPersonsList();
    if(sortdir=="ASC")
        return View(MyAscendingCustomSortAlgorithm(PersonsListModel ));
    else
        return View(MyDescendingCustomSortAlgorithm(PersonsListModel ));
} 
```

`MyAscendingCustomSortAlgorithm`并且`MyDescendingCustomSortAlgorithm`是返回按我的自定义算法排序的列表的函数。

页面加载时，列表排序正确，但是当我单击标题时，排序混乱。我进行了调试，一切正常。

我的问题是我怎样才能使它工作，并且仍然保持正确的分页

我也尝试过设置`canSort: false`，但后来我不能再点击标题了。

非常感谢您的帮助

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-12T16:17:07.503

您是否尝试过在 Bind() 方法中关闭 autoSortAndPage 参数？

```
grid.Bind(source: Model, autoSortAndPage : false); 
```

我知道你想保留现有的分页，但我不确定有没有办法同时拥有这两者。您可能需要在您的操作方法中手动进行分页。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-12T02:11:38.107

我会在您的方法参数中添加页码、行数、排序列和排序方向。它也应该只返回 json 数据。您应该在 javascript 中处理该数据以更新您的视图。

您可以将自己的排序 css 类添加到标题并链接到 ajax 操作。可能可以在 javascript 中处理您的网格并只需更改数据行。

```
public JsonResult Persons(int pagenumber,int rows, string sortcol, string sortdir)
{    

if(sortdir=="ASC")
    return DataSource(pagenumber,rows,sortcol,MyAscendingCustomSortAlgorithm);
else
    return DataSource(pagenumber,rows,sortcol,MyDescendingCustomSortAlgorithm);

} 
```

您可以将排序函数传递给数据源调用并使用它来返回 json 数据。您可以使用 linq 查询来行

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-10T00:12:32.660

你应该这样搜索：

1.  禁用排序
2.  将自定义样式添加到列标题（.GetHtml html 属性中的“headerStyle：customStyle”）。检查章节[样式化你的网格](http://weblogs.asp.net/andrebaltieri/archive/2010/11/02/asp-net-mvc-3-working-with-webgrid-part-2.aspx)
3.  使用 jquery 为具有此样式的所有元素添加**实时**单击处理程序，当用户单击时检查它是哪一列并相应地发布到您的控制器，该控制器将刷新页面

此外，您可以在 css 中添加一些链接到您的 customStype 的样式，即“光标：手”，以便用户看到标题是可点击的。

# css - 为什么在 CSS3 中启用硬件加速会降低性能？

> ID：10014461
> 
> 赞同：84
> 
> 时间：2012-04-04T15:36:46.477
> 
> 标签：css, performance, css-transitions, css-transforms

我在 css3 实验中将 10,000 个小 div 元素从浏览器视口的顶部移动到底部。对于这个测试，我使用了 2 种不同的方法：

1.  使用 GPU 加速`translate3D(x, y, z)`或`translateZ(0)`
2.  `top`只需调整css中的属性即可无需GPU加速

使用**无**硬件加速在 Google Chrome 上运行相当流畅。

如果我启用硬件加速性能会变得更糟。太糟糕了，盒子甚至不再均匀分布：

### 使用 GPU/硬件加速：

* * *

![](../Images/10025d186516a7e9f466a235acc78cde.png)

* * *

### 没有 GPU/硬件加速：

* * *

![](../Images/bbab6ca9f5b0089d3e45d668224c8bba.png)

* * *

### 问题

为什么呢？不应该使用 GPU 来提高性能吗？

### 演示应用

[https://www.timo-ernst.net/misc/hwtest/](https://www.timo-ernst.net/misc/hwtest/)

### 来源

[https://github.com/valnub/hwtest](https://github.com/valnub/hwtest)

### 我用于测试的硬件

*   Apple Macbook Pro 15" 2015 型号
*   CPU 2,8 GHz 英特尔酷睿 i7
*   16 GB 内存
*   macOS 大苏尔 11.2

* * *

***更新**（2014-11-13）：由于这个问题仍然引起关注，我想指出问题本身似乎仍然存在，尽管在提供**的现代硬件**演示中可能不再看到提到​​的口吃。较旧的设备可能仍会出现性能问题。*

***更新 II** (2021-02-17)：问题仍然存在，但您必须根据使用的硬件增加演示中移动的盒子数量。我更改了演示应用程序的 UI，因此您现在可以调整移动框的数量，为您的特定硬件创建口吃动画。为了重现这个问题，我建议创建足够的框来查看启用 GPU/硬件加速的卡顿。然后勾选该框并再次运行测试而不加速。动画应该更流畅。

* * *

## 回答 #1

> 赞同：100
> 
> 时间：2012-04-13T00:22:16.167

我总是添加：

```
-webkit-backface-visibility: hidden;
-webkit-perspective: 1000; 
```

使用 3d 变换时。甚至是“假”的 3D 变换。经验告诉我，这两条线总是能提高性能，尤其是在 iPad 上和 Chrome 上。

我确实对您的示例进行了测试，据我所知，它有效。

至于你问题的“为什么”部分......我不知道。3D 变换是一个年轻的标准，因此实施起来很不稳定。这就是为什么它是一个前缀属性 : 用于 beta 测试。有人可以填写错误报告或问题并让团队进行调查。

**2013 年 8 月 19 日编辑**：

这个答案有规律的活动，我刚刚失去了一个小时，发现 IE10 也需要这个。所以不要忘记：

```
backface-visibility: hidden;
perspective: 1000; 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2015-06-25T02:14:54.673

[添加空变换 hack](https://aerotwist.com/blog/on-translate3d-and-layer-creation-hacks/) ( )时动画变慢的原因`translateZ(0)`是每个空 3D 变换都会创建一个新层。当这些层太多时，渲染性能会受到影响，因为浏览器需要向 GPU 发送大量纹理。

该问题于 2013 年在 Apple 的主页上被发现，该主页滥用了 null 转换 hack。见[http://wesleyhales.com/blog/2013/10/26/Jank-Busting-Apples-Home-Page/](http://wesleyhales.com/blog/2013/10/26/Jank-Busting-Apples-Home-Page/)

OP 也正确地注意到了[他们评论](https://stackoverflow.com/questions/10014461/why-does-enabling-hardware-acceleration-in-css3-slow-down-performance#comment22070776_10014461)中的解释：

> 使用 3D 加速时，移动少量大对象比移动大量小项目更高效，因为所有 3D 加速层都必须传输到 GPU 并返回。因此，即使 GPU 做得很好，许多对象的传输也可能是一个问题，因此使用 GPU 加速可能不值得。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-04-11T22:41:02.987

有趣的。我尝试使用 中的一些选项`about:flags`，特别是这些选项：

> **所有页面上的GPU 合成 在所有页面上**使用 GPU 加速合成，而不仅仅是包含 GPU 加速层的页面。
> 
> **GPU 加速绘图**在启用合成时启用页面内容的 GPU 加速绘图。
> 
> **GPU Accelerated Canvas 2D**通过使用图形处理器单元 (GPU) 硬件进行渲染，使具有 2D 上下文的画布标签性能更高。

启用这些，尝试它并在启用复选框的情况下惨遭失败（就像您所做的那样）。但后来我注意到另一个选择：

> **FPS 计数器**显示页面的实际帧速率，以每秒帧数为单位， *当硬件加速处于活动状态时*。

鉴于标志描述中的突出显示，我推测硬件加速实际上对我来说是启用的，即使没有勾选复选框，因为我看到上面选项打开的 FPS 计数器！

**TL;DR：**硬件加速归根结底是用户偏好；用 dummy 强制它`translateZ(0)`会引入冗余处理开销，从而导致性能降低。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-09T01:51:17.497

在 chrome 中检查 chrome://flags。它说

> “启用线程合成后，加速的 CSS 动画会在合成线程上运行。但是，即使没有合成线程，运行加速的 CSS 动画也可能会提高性能。”

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-15T23:16:27.973

我的经验是，GPU 对于所有类型的图形通常都不是更快。对于非常“基本”的图形，它们可能会更慢。

如果你旋转图像，你可能会得到不同的结果——这就是 GPU 擅长的事情

还要考虑 translateZ(0) 是 3 维操作，而改变顶部或左侧是 2 维操作

* * *

## 回答 #6

> 赞同：-2
> 
> 时间：2013-01-23T03:46:22.287

看了你们两个demo，我想我知道你们困惑的原因了：</p>

1.  动画元素不要使用left或者top来改变位置，尽量使用-webkit-transform；
2.  所有子元素都需要开启硬件加速如使用 translateZ() 或 translate3D；
3.  FPS 衡量动画流畅度，你的演示 FPS 平均只有 20FPS。

以上，仅代表个人意见，谢谢！

# c++ - DirectX 渲染

> ID：10014465
> 
> 赞同：0
> 
> 时间：2012-04-04T15:36:58.023
> 
> 标签：c++, directx

所以我创建了这个程序来使用 DirectX 渲染到一个窗口。它有一个`init()`需要一个`HWND`对象的方法，以便它可以将 DirectX 初始化到窗口，然后`render()`是一个在无限循环内调用的方法，最后是一个`cleanup()`释放 DirectX 对象和设备的方法。但是，DirectX 将渲染旋转立方体的几帧（可能足够半旋转），然后屏幕会变黑。然后立方体会重新亮起，但在黑色期间它仍在旋转。这继续以开...关...开...关的模式。DirectX 是否可能无法正确渲染到窗口？怎么了？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2017-01-13T08:23:07.570

根据我的经验，我认为您很有可能需要为您的窗口显式实现背景擦除事件的处理（[请参阅此页面](https://msdn.microsoft.com/en-us/library/windows/desktop/ms648055(v=vs.85).aspx)），否则，默认实现将启动并妨碍您（有时会擦除 DirectX 刚刚按照其他人的建议呈现）。

但是，正如大家已经提到的那样：这只是一个小理论，我们需要一些代码来进一步检查:-)。

# biztalk - 执行 BizUnit 4.0 XML 测试用例

> ID：10014479
> 
> 赞同：1
> 
> 时间：2012-04-04T15:37:45.197
> 
> 标签：biztalk, biztalk-2010, bizunit

嗨，我在 bizunit 4.0 中创建了一个名为 test1.xml 的 xml 测试用例

我遇到的问题是如何运行测试。我找到的所有示例都适用于 bizunit 2.0 和 3.0，但不适用于 4.0。在示例中，我发现它说要这样做：

```
 BizUnit.BizUnit bizUnit = new BizUnit.BizUnit("testl.xml");
 bizUnit.RunTest(); 
```

但我收到一张纸条，说它已被弃用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-09T19:39:51.343

我正在使用 .net 单元测试并从代码中调用 bizunit

这是一个例子

```
 // create list of files
    TestGeneratedFiles = new System.Collections.Generic.List<String>();

    var TestCase = new BizUnit.Xaml.TestCase { Name = "Interface128UnitTestSetup" };

    //Create the file validate step
    var testStep = new FileReadMultipleStep
    {
        DirectoryPath = inputPath,
        SearchPattern = InputTemplate,
        ExpectedNumberOfFiles = 1,
        Timeout = 3000,
        DeleteFiles = false
    };

    //Create an XML Validation step
    //This will check against the XSD for the document
    var validation = new XmlValidationStep();
    var schemaSummary = new SchemaDefinition
    {
        // test deployment copies this file to test directory
        XmlSchemaPath = @"Publish_Employee.xsd",
        XmlSchemaNameSpace = "http://AMC.Oracle.Employee"
    };
    validation.XmlSchemas.Add(schemaSummary);

    TestCase.ExecutionSteps.Add(testStep);

    // run the test case
    var bizUnit = new BizUnit.BizUnit(TestCase);
    bizUnit.RunTest(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-03-12T14:56:02.550

对我来说这有效（没有警告）：

```
TestCase tc = TestCase.LoadFromFile("test1.xml");
BizUnit.BizUnit bizUnit = new BizUnit.BizUnit(tc);
bizUnit.RunTest(); 
```

# python - Python 线程挂起

> ID：10014481
> 
> 赞同：13
> 
> 时间：2012-04-04T15:37:53.607
> 
> 标签：python, multithreading, multiprocessing, python-multithreading

我有一个遵循标准范例的简单线程 Python 程序：

```
class SearchThread(threading.Thread):
    def __init__(self, search_queue):
        threading.Thread.__init__(self)
        self.search_queue = search_queue

    def run(self):
        while True:
            try:
                search_url = self.search_queue.get(timeout=15)
                # <do Internet search and print output/>
            except Queue.Empty:
                self.search_queue.task_done()
                break
            except Exception, e:
                print e

if __name__ == '__main__':
    search_queue = Queue.Queue()    
    for i in range(200):
        t = SearchThread(search_queue)
        t.setDaemon(True)
        t.start()
    search_queue.join() 
```

队列中填充了大约 1000 个 url，并且`HTTP GET`在`<do Internet search and print output/>`. 问题是，在处理了大约 500-700 个条目（只需要几秒钟）之后，程序总是永远挂起，没有输出，没有异常，什么都没有。

我试过`requests`, `urllib2`, `urllib3`,`httplib2`但`HTTP GET`没有任何改变。

如何调试挂起的线程 Python 程序？

顺便说一句，我在 Ubuntu 11.10（64 位）下使用 Python 2.7。

### 编辑

当盯着挂起进程的gdb跟踪时，我和以前一样一无所知——

```
sudo gdb python 9602
GNU gdb (Ubuntu/Linaro 7.3-0ubuntu2) 7.3-2011.08
...
(gdb) where
#0  0x00007fc09ea91300 in sem_wait () from /lib/x86_64-linux-gnu/libpthread.so.0
#1  0x00000000004ed001 in PyThread_acquire_lock ()
#2  0x00000000004f02de in ?? ()
#3  0x00000000004b6569 in PyEval_EvalFrameEx ()
#4  0x00000000004bcd2d in PyEval_EvalCodeEx ()
#5  0x00000000004b6a5b in PyEval_EvalFrameEx ()
#6  0x00000000004b6d77 in PyEval_EvalFrameEx ()
#7  0x00000000004bcd2d in PyEval_EvalCodeEx ()
#8  0x00000000004bd802 in PyEval_EvalCode ()
#9  0x00000000004dcc22 in ?? ()
#10 0x00000000004dd7e4 in PyRun_FileExFlags ()
#11 0x00000000004de2ee in PyRun_SimpleFileExFlags ()
#12 0x00000000004ee6dd in Py_Main ()
#13 0x00007fc09d86030d in __libc_start_main () from /lib/x86_64-linux-gnu/libc.so.6
#14 0x000000000041cb69 in _start () 
```

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-07-19T11:13:52.347

我编写了一个模块，它打印出在一个地方挂起超过 10 秒的线程。 [hang_threads.py](https://gist.github.com/niccokunzmann/6038331)（[包](https://pypi.python.org/pypi/hanging_threads)）

这是一个示例输出：

```
--------------------    Thread 5588     --------------------
  File "C:\python33\lib\threading.py", line 844, in _exitfunc
        t.join()
  File "C:\python33\lib\threading.py", line 743, in join
        self._block.wait()
  File "C:\python33\lib\threading.py", line 184, in wait
        waiter.acquire() 
```

当您忘记将另一个线程设置为守护进程时，这会在主线程退出时发生。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-08-13T23:13:24.490

似乎您面临与此线程中提到的相同的问题。

[python多处理：某些函数完成后不返回（队列材料太大）](https://stackoverflow.com/questions/11854519/python-multiprocessing-some-functions-do-not-return-when-they-are-complete-que)

关键是这是一个未解决/关闭的错误吗？[http://bugs.python.org/issue8237](http://bugs.python.org/issue8237)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-02-22T13:50:55.060

我不确定你是否还有问题（问题有点老了......）。

它看起来像一个经典的死锁（因为它似乎挂在某个互斥锁上）。

对于 GDB，有一些不错的 Python 脚本可以使 C 回溯与 Python 调用的信息更加丰富。即它显示了实际的 Python 调用：

```
#3  0x00000000004b6569 in PyEval_EvalFrameEx ()
#4  0x00000000004bcd2d in PyEval_EvalCodeEx ()
#5  0x00000000004b6a5b in PyEval_EvalFrameEx ()
#6  0x00000000004b6d77 in PyEval_EvalFrameEx ()
#7  0x00000000004bcd2d in PyEval_EvalCodeEx ()
#8  0x00000000004bd802 in PyEval_EvalCode () 
```

我认为这些 GDB Python 脚本甚至包含在原始 Python 发行版中。去看一下。

然后，有一个很棒的[faulthandler 模块](https://pypi.python.org/pypi/faulthandler/)，它为您提供了一些打印 Python 回溯的功能（例如在信号处理程序中）。在[我的 MusicPlayer 项目](https://github.com/albertz/music-player)中，我对它们进行了一些扩展，并大量使用它们进行调试。

例如，我添加了这个功能：

```
// This is expected to be called only from signal handlers (or in an evironment where all threads are stopped).
__attribute__((visibility("default")))
void _Py_DumpTracebackAllThreads(void) {
    PyInterpreterState* interp = NULL;
    PyThreadState* tstate = NULL;

    // The current active Python thread (that might not be us).
    tstate = _PyThreadState_Current;

    // No Python state is currently active. Try to get our own, if we have one assigned.
    if(!tstate)
        tstate = PyGILState_GetThisThreadState();

    // No thread found so far. Try the interpreter head.
    if(!tstate)
        interp = PyInterpreterState_Head();

    if(!interp && tstate)
        interp = tstate->interp;

    if(!interp) {
        printf("_Py_DumpTracebackAllThreads: no Python interpreter found\n");
        return;
    }

    _Py_DumpTracebackThreads(STDOUT_FILENO, interp, tstate);
} 
```

现在，当我在 GDB 或 LLDB 中并想知道当前的 Python 线程时，我只需键入`p _Py_DumpTracebackAllThreads()`它就会打印在标准输出上。

除此之外，您对所有当前线程的 C 回溯感兴趣，即`t apply all bt full`应该打印 GDB 中的所有回溯。

如果那是它挂起的 Python GIL，则可能有一些其他活动的 Python 线程因为其他事情而挂起。那是实际的错误。它应该在此之前发布 Python GIL。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-04T18:25:48.457

这个调试器可以调试多线程python程序：[http ://winpdb.org/](http://winpdb.org/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-04T16:19:31.703

您的 while 循环是无限的。即使队列为空，线程也永远不会完成执行。您应该检查队列是否有新任务或通知线程（例如使用事件）不需要任务。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-04-04T20:28:43.020

还有一件事是滥用 Queue.get。第一个参数是一个布尔值“块”。您应该输入如下内容：

```
self.search_queue.get(timeout=15) 
```

而且，正如我上面写的，避免使用无限循环。当您的超时到期时，Queue.get 会引发“Empty”异常，该异常会被“except Exception”（另一种应避免使用的构造）捕获。所以你的循环真的是无限的。您将“例外”更改为

```
except Queue.Empty:
    self.search_queue.task_done()
    break 
```

**编辑**

最初的问题代码如下

```
self.search_queue.get(15) 
```

# java - 带有 Hibernate-Java 或 Ms SQL Server 的 Apache Solr

> ID：10014483
> 
> 赞同：1
> 
> 时间：2012-04-04T15:37:56.523
> 
> 标签：java, hibernate, solr

由于大量计算查询，我遇到了 SQl 服务器性能问题，因此我们决定将 Solr 作为中间数据，并索引来自休眠或直接来自 SQl 服务器的所有数据，

那么有人可以建议/帮助我吗？请为此建议任何教程链接。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T07:15:17.727

您可以使用[DataImportHandler](http://wiki.apache.org/solr/DataImportHandler)传输数据，您可以使用[DataImportScheduler](http://wiki.apache.org/solr/DataImportHandler#Scheduling)进行调度。

我遇到了类似的问题，SQL Server SP 花了 12 个小时来更新对象（行）之间的关系，所以我们最终使用了[Neo4j](http://neo4j.org/)（开源图形数据库），它与我们的数据模型完全匹配。

我们需要在 Solr 搜索中反映对象关系，例如，给我所有名称以“obj”开头且其父对象类型为“typ”的对象。

# android - 无法使微调器的滚动条始终可见（Android）

> ID：10014485
> 
> 赞同：7
> 
> 时间：2012-04-04T15:37:58.927
> 
> 标签：android, scrollbar, spinner

我有这样一个问题 - 我想让微调器的滚动条始终可见。但是对于微调器功能

```
setScrollbarFadingEnabled(false); 
```

在绘制 GUI 期间导致 NullExceptionPointer 崩溃。

XML 标签也不能解决这个问题——似乎 spinner 只是忽略了它们。

也许还有其他移动方式？例如，使用自定义滚动条？如果是，我该怎么做？

谢谢你的回答，德米特里。

正如我被问到的，这里是简单项目的 LogCat 错误消息，其中只有一个微调器：

```
AndroidRuntime(2252): FATAL EXCEPTION: main
AndroidRuntime(2252): java.lang.NullPointerException
AndroidRuntime(2252): at android.view.View.onDrawScrollBars(View.java:5836)
AndroidRuntime(2252): at android.view.View.draw(View.java:6799)
AndroidRuntime(2252): at android.view.ViewGroup.drawChild(ViewGroup.java:1640)
AndroidRuntime(2252): at android.view.ViewGroup.dispatchDraw(ViewGroup.java:1367)
AndroidRuntime(2252): at android.view.ViewGroup.drawChild(ViewGroup.java:1638)
AndroidRuntime(2252): at android.view.ViewGroup.dispatchDraw(ViewGroup.java:1367)
AndroidRuntime(2252): at android.view.View.draw(View.java:6796)
AndroidRuntime(2252): at android.widget.FrameLayout.draw(FrameLayout.java:352)
AndroidRuntime(2252): at android.view.ViewGroup.drawChild(ViewGroup.java:1640)
AndroidRuntime(2252): at android.view.ViewGroup.dispatchDraw(ViewGroup.java:1367)
AndroidRuntime(2252): at android.view.ViewGroup.drawChild(ViewGroup.java:1638)
AndroidRuntime(2252): at android.view.ViewGroup.dispatchDraw(ViewGroup.java:1367)
AndroidRuntime(2252): at android.view.View.draw(View.java:6796)
AndroidRuntime(2252): at android.widget.FrameLayout.draw(FrameLayout.java:352)
AndroidRuntime(2252): at com.android.internal.policy.impl.PhoneWindow$DecorView.draw(PhoneWindow.java:2078)
AndroidRuntime(2252): at android.view.ViewRoot.draw(ViewRoot.java:1433)
AndroidRuntime(2252): at android.view.ViewRoot.performTraversals(ViewRoot.java:1175)
AndroidRuntime(2252): at android.view.ViewRoot.handleMessage(ViewRoot.java:1753)
AndroidRuntime(2252): at android.os.Handler.dispatchMessage(Handler.java:99)
AndroidRuntime(2252): at android.os.Looper.loop(Looper.java:123)
AndroidRuntime(2252): at android.app.ActivityThread.main(ActivityThread.java:4632)
AndroidRuntime(2252): at java.lang.reflect.Method.invokeNative(Native Method)
AndroidRuntime(2252): at java.lang.reflect.Method.invoke(Method.java:521)
AndroidRuntime(2252): at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:871)
AndroidRuntime(2252): at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:629)
AndroidRuntime(2252): at dalvik.system.NativeStart.main(Native Method) 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-09-28T17:17:49.973

Spinner 没有滚动条，因此您得到 NullPointerException。

微调器显示的弹出窗口有一个滚动条。所以需要修改 spinner 显示的 ListView 的属性。但是 ListView 本身并没有被 Spinner 通过任何公共方法公开。

即使你通过反射得到ListPopupWindow，也会出现另一个问题，即ListPopupWindow的ListView只有在你点击Spinner之后才会创建。

但是 Spinner 的 OnClickListener 不能注册，显示后设置 ListView 属性。

您可以创建一个覆盖 performClick 的自定义微调器，然后通过反射获取 mPopup。并使用`mPopup.getListView().setScrollbarFadingEnabled(false)`

但是，如果您要创建一个自定义 Spinner，我相信实现整个弹出窗口以满足您的需要比使用反射更容易。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-11-25T16:01:44.310

感谢*@nandeesh*的回答，也感谢*@Eng.Fouad*[在另一页上的](http://stackoverflow.com/a/19820350/597657)回答。

```
public class VisibleScrollbarSpinner extends Spinner {
    @Override public boolean performClick() {
        final boolean superResult = super.performClick();

        try {
            final Field mPopupField = Spinner.class.getDeclaredField("mPopup");
            mPopupField.setAccessible(true);
            //noinspection ConstantConditions
            ((ListPopupWindow) mPopupField.get(this)).getListView().setScrollbarFadingEnabled(false);
            mPopupField.setAccessible(false);
        } catch (NoSuchFieldException | IllegalAccessException e) {
            Log.e(TAG, e.toString(), e);
        }

        return superResult;
    }

    public VisibleScrollbarSpinner(Context context) { super(context); } 
    public VisibleScrollbarSpinner(Context context, int mode) { super(context, mode); } 
    public VisibleScrollbarSpinner(Context context, AttributeSet attrs) { super(context, attrs); } 
    public VisibleScrollbarSpinner(Context context, AttributeSet attrs, int defStyleAttr) { super(context, attrs, defStyleAttr); } 
    public VisibleScrollbarSpinner(Context context, AttributeSet attrs, int defStyleAttr, int mode) { super(context, attrs, defStyleAttr, mode); }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-28T11:47:44.003

经过初步调查，我认为不可能调用`setScrollbarFadingEnabled(false);`Spinner。

我已经阅读了 Class 的实现`Spinner.java`和`View.java`（最后一个实现`setScrollbarFadingEnabled(boolean)`了 API16 的，问题是这一行：

```
cache.scrollBar.setAlpha(255); 
```

此时可能`cache.scrollBar`为空，我没有找到任何方法来强制对该属性进行一些初始化。

管理此属性的大多数方法都是受保护的或私有的，因此我们不能只调用它们。

我将继续研究这个问题以找到可能的解决方案，但就目前而言，考虑到还没有人回答这个问题，我认为这是不可能的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-11-23T06:41:28.223

我注意到“setScrollbarFadingEnabled”java 方法和“fadeScrollbar”xml 方法都不会对微调器产生任何影响，因为微调器的列表视图包含在对话框（弹出窗口）中，因此这些属性不会到达列表视图。

但实际上到达微调器列表视图的是主题。

所以只需创建一个这样的自定义主题：

```
<style name="App_SpinnerStyle" >
        <item name="android:fadeScrollbars">false</item>
</style> 
```

并将其添加到微调器中，如下所示：

```
android:popupTheme="@style/App_SpinnerStyle" 
```

久经考验！

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-09-12T09:05:56.527

在您的应用主题或活动中：

```
 <item name="android:dropDownListViewStyle">@style/SpinnerStyle1</item> 
```

声明 SpinnerStyle1：

```
<style name="SpinnerStyle1" parent="Widget.AppCompat.ListView.DropDown">
        <item name="android:divider">@color/blackText</item>
        <item name="android:dividerHeight">1px</item>
          <item name="android:scrollbarAlwaysDrawVerticalTrack">true</item>
</style> 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2020-12-05T23:03:40.180

由于访问`ListView`微调器的底层并不容易，我为此找到了一个简单的解决方案。

在styles.xml 中创建一个样式，并设置`scrollbarFadeDuration`为一些无穷无尽的值。

```
<style name="AlwaysEnableScrollBar" parent="Widget.AppCompat.ListView.DropDown">
    <item name="android:scrollbarFadeDuration">10000000</item>
</style> 
```

然后在微调器主题中设置它：

```
<Spinner
    ...
    android:theme="@style/AlwaysEnableScrollBar"/> 
```

# jquery - ajax 调用在我的机器上工作正常，但在服务器上不行

> ID：10014489
> 
> 赞同：0
> 
> 时间：2012-04-04T15:38:12.327
> 
> 标签：jquery, ajax, call

以下代码在我的开发机器上运行时工作正常 -

```
 $.ajax({
            url: 'services/chatEngine.asmx/addUser',
            type: "POST",
            data: {
                UN: from,
                chatapplicationId: '222'
            },
            dataType: "xml",
            async: false,
            cache: false,
            beforeSend: function () {
                usersScrollLocation = document.getElementById('userList').scrollTop;
                //alert('before');
            },
            fail: function () { alert('Error'); },
            complete: function () { alert('Done'); },
            success: function (a, b, c) {
                alert('success');
                if (window.DOMParser) {
                    parser = new DOMParser();
                    try {
                        xmlDoc = parser.parseFromString(c.responseXML.lastChild.lastChild.data, "text/xml");
                    }
                    catch (e) { alert(e.Message) }
                }
                else // Internet Explorer
                {
                    xmlDoc = new ActiveXObject("Microsoft.XMLDOM");
                    xmlDoc.async = false;
                    xmlDoc.loadXML(c.responseXML.lastChild.lastChild.data);
                }
                //alert('b4 If');
                if (xmlDoc.getElementsByTagName('user')[0].childNodes[0].nodeValue != 'Error') {
                    var el = xmlDoc.getElementsByTagName('user')[0].childNodes[0].nodeValue;
                    var t;
                    //if (el != from) {
                    t = '<span  style="cursor:pointer" onclick="newPrivateChat(\'' + el + '\');">' + el + '</span>' + '<br>';
                    //}
                    //else {
                    //    t = '<span><b>' + el + '</b></span>' + '<br>';
                    //}
                    $('#userList').append(t);
                    userok = true;

                }
            }

        }); 
```

代码在我的机器上运行良好，但是在服务器上运行时，ajax.success 函数永远不会被调用......

我看不出问题是什么，请帮忙。

谢谢，

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-04T15:40:37.867

我认为问题在于服务器上的路径与本地路径不同，因为应用程序/虚拟文件夹名称。在 Chrome 上打开它，然后使用开发人员工具，您可以在网络选项卡上检查它试图访问的真实 URL 是什么，也许您会发现您缺少什么

# objective-c - 如何在 QuickDialog 项目中修复此构建错误？

> ID：10014490
> 
> 赞同：1
> 
> 时间：2012-04-04T15:38:13.873
> 
> 标签：objective-c, ios, quickdialog

我打算在我的项目中使用 QuickDailog，我在[这里](https://github.com/escoz/quickdialog)从 github 克隆了项目。

我正在尝试运行示例，但是当我构建项目时出现以下错误

```
file:///QuickDialog/quickdialog/QuickDialogTableView.m: 
error: Semantic Issue: Second   argument to 'va_arg' is 
of non-POD type 'QElement *' 
```

这是导致此错误的代码段。

```
- (void)reloadCellForElements:(QElement *)firstElement, ... {
    va_list args;
    va_start(args, firstElement);
    NSMutableArray *indexes = [[NSMutableArray alloc] init];
    QElement * element = firstElement;
    while (element != nil) {
        [indexes addObject:[self indexForElement:element]];

        //Below line generates the error
        element = va_arg(args, QElement *);
    }
    [self reloadRowsAtIndexPaths:indexes withRowAnimation:UITableViewRowAnimationNone];

    va_end(args);
} 
```

有什么建议可以解决这个错误吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-04T15:56:39.403

你怎么称呼这个方法？你在调用什么对象？您是否发送空终止的对象列表？

我无法重现该问题，但谷歌搜索我发现了这个：

[http://builderror.com/article/47/Second-argument-to-vaarg-is-of-non-POD-type](http://builderror.com/article/47/Second-argument-to-vaarg-is-of-non-POD-type)

您可以尝试使用该解决方法并查看它是否可以解决问题吗？

# asp.net - asp:HyperLink 运行时修改

> ID：10014491
> 
> 赞同：0
> 
> 时间：2012-04-04T15:38:14.043
> 
> 标签：asp.net, hyperlink

```
<asp:HyperLink ID="HyperLink5" runat="server" CssClass="RegAgenda" 
     NavigateUrl='<%#"http://www.mysite.com/store/" & 
                  DataBinder.Eval(Container.DataItem,"DESCRIPTION")& "?ALID=" & 
                  DataBinder.Eval(Container.DataItem,"TransID")%>' 
     Target="_blank" Text="Info/Buy Now">
</asp:HyperLink> 
```

在上面的 asp:HyperLink 代码中，我想测试当前页面的路径中是否有 Chuy2，如果有，将基本 url 更改为[http://www.mysite2.com](http://www.mysite2.com)

我该怎么做？我是一个 PHP 人，不知道 ASP.Net。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-04T15:47:54.023

像这样的东西应该工作：

```
<asp:HyperLink ID="HyperLink1" runat="server"
    NavigateUrl='<%# string.Format("{0}/{1}?alid={2}", Request.Url.AbsoluteUri.Contains("Chuy2") ? "http://www.mysite2.com" : "http://www.mysite.com/store", Eval("Description"), Eval("TransID")) %>' 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-04T15:49:08.027

我不会尝试在标记/模板中将其拼凑在一起，而是在后面的代码中构建 url，或者查看模型，然后绑定该值。标记可能看起来像这样

```
NavigateUrl='<%#Eval("Url")%>' 
```

# vb.net - 计算列表框中的选定项目

> ID：10014493
> 
> 赞同：0
> 
> 时间：2012-04-04T15:38:17.413
> 
> 标签：vb.net, listbox

您如何计算列表框中被选中的值的数量，而不是列表框中的所有值？

我需要得到这个数字，然后把它变成一个字符串。一旦我有了数字，我就可以轻松地将其更改为字符串

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-17T12:11:00.143

我已经使用 ListBox1.GetSelectedIndices.Length

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-04T15:44:38.813

yourlistbox.SelectedItems.Count

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-04T16:53:10.067

您可以像这样遍历列表框中的项目：

```
 For Each item As ListItem In MyListBox.Items
        If item.Selected Then
           'Do something               
        End If
    Next 
```

# c - 如何列出C中正在运行的进程？

> ID：10014497
> 
> 赞同：1
> 
> 时间：2012-04-04T15:38:30.860
> 
> 标签：c, windows

我想编写一个基于控制台的进程管理器。在第一步中，我认为我应该有一个正在运行的进程列表。我正在使用 Windows。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-04T15:59:11.940

[您可以在 MSDN 上](http://msdn.microsoft.com/en-us/library/windows/desktop/ms682623%28v=vs.85%29.aspx)查看此示例。[这](https://www.google.ro/search?client=opera&rls=en&q=win32%20enum%20processes&sourceid=opera&ie=utf-8&oe=utf-8&channel=suggest)也可能有帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-04T16:02:32.283

您可以使用[CreateToolhelp32Snapshot](http://msdn.microsoft.com/en-us/library/windows/desktop/ms682489%28v=vs.85%29.aspx)函数来创建当前正在运行的进程的快照。然后你可以使用[Process32First](http://msdn.microsoft.com/en-us/library/windows/desktop/ms684834%28v=vs.85%29.aspx)和[Process32Next](http://msdn.microsoft.com/en-us/library/windows/desktop/ms684836%28v=vs.85%29.aspx)来枚举这个列表。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-04T16:01:50.240

好吧，既然您想知道如何在 mac 上执行此操作，这不会有什么坏处：

```
struct ProcessList {
    pid_t value;
    struct ProcessList *next;
};

struct ProcessList *getProcesses()
{
    struct ProcessList *process = malloc(sizeof(struct ProcessList));
    struct ProcessList *next = process;
    ProcessSerialNumber psn = { 0, kNoProcess };

    GetProcessPID(&psn, &process->value);

    while (noErr == GetNextProcess(&psn)) {
        pid_t pid;
        if (noErr == GetProcessPID(&psn, &pid)) {
            next = next->next = malloc(sizeof(struct ProcessList));
            next->value = pid;
        }
    }

    next->next = NULL;
    return process;
} 
```

显然，这将返回一个正在运行的进程的链接列表，直到您为进程列表点击 NULL。

# django - 如何在模板中从 Django social-auth 获取特定的提供者？

> ID：10014501
> 
> 赞同：2
> 
> 时间：2012-04-04T15:38:44.110
> 
> 标签：django, django-socialauth

在安装和设置了 social-auth 之后，我正在玩一会儿，试图掌握它。我已阅读文档，并已使用示例项目使其运行。

但直到现在我不知道如何获取某个提供商的信息。在示例项目中，模板标签总是以这种方式使用：

```
{% for type, accounts in social_auth.associated.items %}
    {% for account in accounts %}
        {{account.provider}} is connected.
    {% endfor %}
{% endfor %} 
```

我现在要做的不是列出所有提供商，而是检查是否有人将他的帐户连接到（即）facebook。这样我就可以做这样的事情：

```
if user==connected_to_facebook
    provide some functionality
endif 
```

从上面的示例中，我知道 social_auth.associated.items 包含 的元组`(type,account)`，其中“facebook”将在一个包含所有值的列表中`account.provider`。

我想到的是这样的：

```
{% if "facebook" in social_auth.associated.items.accounts.provider %} 
```

显然，这是行不通的。我认为这个会起作用，但不会返回我想要的结果：

```
{% if "facebook" in social_auth.associated.items[1].provider %} 
```

Django中是否有一些我可以使用的功能？也许我缺少一些特殊的模板标签？或者这个功能是否已经内置在 social_auth 中，我不知何故错过了文档？或者，我最怀疑的是，它真的很明显吗，我只是......

非常欢迎任何帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-04T16:35:05.283

“social_auth”不是元组中的一些元组，它是一个字典：

```
{'not_associated': {}, 'backends': {'oauth2': ['facebook']},
 'associated': {'oauth2': [<UserSocialAuth:testuser>]}} 
```

这当然更有意义，但仍然没有导致任何地方。因此，我查看了一个尚未关联其帐户的用户，该字典如下所示：

```
{'not_associated': {'oauth2': ['facebook']}, 'backends': {'oauth2': ['facebook']},
 'associated': {}} 
```

现在我发现了一些有用的东西：

```
{% if "facebook" in social_auth.not_associated.oauth2 %}
{% else %}
    provide facebook functionality
{% endif %} 
```

这样可行。您只需要知道您正在寻找的后端使用什么类型的身份验证，然后确保它不在 social_auth 的 not_associated 字段中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-29T20:27:43.840

如果有人需要创建断开连接的 URL，这是我想出的 hack-y 代码，`providers`我传入的列表在哪里`["Facebook", "Twitter"]`

```
{% for p in providers %}
    <h2>Link {{ p }} Account</h2>
    <p>Use your {{ p }} account to log in
    {% if p|lower in social_auth.not_associated %}
        <a href="{% url socialauth_associate_begin p|lower %}?next={{ request.path }}" class="off">No</a>
    {% else %}
        {% for item in social_auth.associated.all %}{% if item.provider == p|lower %}
        <a href="{% url socialauth_disconnect_individual p|lower item.id %}" class="on">Yes</a>
        {% endif %}{% endfor %}
    {% endif %}
    </p>
{% endfor %} 
```

似乎应该有一个关联帐户的字典而不是这样做，但我想不通。不确定如果用户成功授权他们的帐户两次会发生什么。

# r - 如何在 org-mode 中转义双括号 [[ in-line

> ID：10014504
> 
> 赞同：12
> 
> 时间：2012-04-04T15:38:53.480
> 
> 标签：r, emacs, org-mode

我需要在行内显示一些包含双括号的 R 代码。例如，`=x[[1]]=`并被 `src_R{x[[1]]}`评估为链接。

如何转义这些双括号，或者使用内联代码块禁用链接？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-05T09:13:15.527

也许您可以自定义变量`org-activate-links`来解决此问题。

的默认值`org-activate-links`包括`bracket`激活双括号作为某些链接。如果您从`org-activate-links`下面删除此符号，它们将不会在 org-mode 中自动显示为链接。

```
(setq org-activate-links '(angle plain radio tag date footnote)) 
```

# php - php中的小时计算

> ID：10014507
> 
> 赞同：2
> 
> 时间：2012-04-04T15:39:01.423
> 
> 标签：php, datetime, time

我有一个项目，在该项目中，用户获得了与其订阅相关的每月特定小时数，如果他在月底还有一些小时数，他的剩余小时数将在下个月的小时数中添加。例如，如果用户订阅了 1400 小时的订阅，并且他在月底还有 20 小时的剩余时间，那么在下个月他将获得 1420 小时。但是，在我的数据库中，小时数以 1400:00:00 的形式存储，所以我得到值 20:00:00 我如何添加 1400:00:00。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-04T15:42:12.373

```
$string = '1400:00:00';

$explode = explode(':',$string);

$hours = $explode[0];

$new_hours = $hours + 20; 
```

# php - PHP 的独特情况。在发送到循环内的函数之前从数组中删除重复项

> ID：10014510
> 
> 赞同：0
> 
> 时间：2012-04-04T15:39:21.207
> 
> 标签：php, arrays, function, loops

所以我有多个帖子。两大类。作者发表的某些帖子仅属于一个类别。但其他作者的帖子可能属于这两个类别。我需要删除重复项。我一次只能有一个作者帖子。所以我只是要默认到两者中更重要的（商店帖子而不是服务帖子）类别并列出该帖子。

但我不知道如何去做。

以下是我获取数据并处理它以输出的方式：

```
 $allPosts = get_post_type_data('archive', 'all');   
        for($i = 0; $i < count($allPosts); $i++){
            if($allPosts[$i]['post_type'] == 'antique-shops'){
                $shopData[] = $allPosts[$i];
            }
            if($allPosts[$i]['post_type'] == 'member-dealers'){
                $memberData[] = $allPosts[$i];
            }
            if($allPosts[$i]['post_type'] == 'services'){
                $serviceData[] = $allPosts[$i];
            }
        }
        $business = array_merge((array)$shopData, (array)$serviceData);
        function cmp($a, $b){
            return strcmp(rewrite_name($a['custom']['wpcf-business-contact'][0]), rewrite_name($b['custom']['wpcf-business-contact'][0]));
        }
        usort($business, "cmp");
        for($i = 0; $i < count($business); $i++){
            if($i % 2){
                $className = 'odd';
            } else{
                $className = 'even';
            }
            $check = check_member($business[$i]['custom']['wpcf-business-contact'][0], $memberData);
            if($check[0] == 'true'){
                echo display_listing('member-dealers', $check[1], $business[$i], $className);
            }
        } 
```

因此，在获取所有数据后，我将 Antique Shops 和 Services 合并到一个数组中，并让成员拥有自己的数据数组。

然后对于每个业务数据项，我检查业务联系人以查看它是否与成员数据匹配。

`$check`返回数组值。`$check[0]`= true/false `$check[1]`= 与特定成员有关的数据数组。

`display_listing()`只需获取每个企业/成员输入的数据并将其输出。

我想我需要在根据成员数据检查业务或服务之前检查重复项。

每个古董店或服务都有一个业务联系人：`$business[$i]['custom']['wpcf-business-contact'][0]`用于检查该业务联系人是否作为会员存在。

因此，如果`$business[$i]['custom']['wpcf-business-contact'][0]`同时属于古董店和服务，则从数组中删除与该人有关的服务数据。

我试过这个（在循环内）：

```
if(($key = array_search($business[$i]['custom']['wpcf-business-contact'][0], $business)) !== false){
    unset($business[$key]);
} 
```

在这种情况下删除重复项有什么有用的指导吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-06T16:26:51.167

我添加了一个名为的函数，该函数`check_contact()`从数组中获取每个联系人姓名，`$serviceData`并根据所有`$shopData`数组联系人姓名对其进行检查。如果找到匹配项，则*返回 true*。

在合并到一个数组中供以后使用之前，从数组中删除所有*真正的匹配项。*`$business`

`$shopData`我在and合并之前放置了以下代码`$serviceData`：

```
 function check_contact($name, $data){
            for($i = 0; $i < count($data); $i++){
                if($name == $data[$i]['custom']['wpcf-business-contact'][0]){
                    $return = 'true';
                }
            }
            return $return;
        }
        for($i = 0; $i < count($serviceData); $i++){
            $contact = check_contact($serviceData[$i]['custom']['wpcf-business-contact'][0], $shopData);
            if($contact == 'true'){
                unset($serviceData[$i]);
            }
        } 
```

# android - 互联网上的 Android P2P（直接连接）（在 NAT 之后）

> ID：10014515
> 
> 赞同：24
> 
> 时间：2012-04-04T15:39:37.333
> 
> 标签：android, sockets, connection, p2p

我正在开始一个小项目，基本上是经典战舰游戏的多人游戏（如两个以上玩家）变体。

在我深入编码之前，我试图解决的一个问题是多个玩家之间的通信问题。当前的一种可能性是使用中央 HTTP 服务器作为通信的中央集线器（与 Android C2DM API 结合以允许从 HTTP 服务器到设备的推送通信）。这似乎是一个不错的解决方案，因为理论上只要您可以访问 Internet，无论您是否在 NAT 后面，它都应该可以正常工作。

然而，所提出的解决方案具有存在单点故障/额外负载（网络服务器）的缺点。所以我想尝试其他选择。我曾想过在客户端之间使用套接字进行直接连接（网络服务器仅用作初始会面点），但是只有在所有设备都在同一个网络中时这才能正常工作。考虑到今天我们几乎总是在路由器的 NAT 后面，我怎样才能实现直接通信？我一直在阅读有关打孔的信息，但我找不到任何有据可查的好库（包含好的使用示例）并且肯定可以在 Android 上运行。此外，大多数（如果不是全部）广泛使用的打孔技术（STUN、ICE 等）仅适用于 UDP，这对于可能丢失一些消息的音频/视频和实时多人游戏来说很好，

那么任何想法如何在 NAT 后面的**Android**设备之间实现可靠的打孔（最好通过 TCP） ？它不一定适用于 100% 的情况（可能不支持一些陌生的 NAT），但如果它适用于大多数情况会很好。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-04-04T15:46:42.647

通过 smack 在 gtalk 上使用 xmpp。您不必担心服务器和单点故障。让谷歌担心吧！我编写了俄罗斯方块，让它与使用 gtalk 作为通信层的两个玩家对战。[http://code.google.com/p/tetrads-drop-lite/](http://code.google.com/p/tetrads-drop-lite/)如果您想要更多播放器，可以尝试 MUC。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-06-15T10:04:31.863

UDP 不是可靠的传递，但是您可以通过要求发送 UDP 数据包需要返回确认来使其可靠。这与其他一些要求一起，使 TCP 在 IP 上可靠（从一开始就不可靠）。

请注意，这是可以实施的，但可能会很耗时，而且成本/收益可能无法在您的情况下发挥作用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-04T15:47:59.797

你几乎被迫使用中介。您可以在 Natblaster 中查找可用于在某些 NATed 设备之间建立 TCP 连接的机制，但它不是您可以在 Android 中使用的东西，而无需生根两个设备。即便如此，它也是实验性的。

最好的可能是使用现有的联合消息传递系统，如 jabber。

# oracle - 错误：PLS-00801：内部错误 [*** ASSERT at file pdw4.c

> ID：10014519
> 
> 赞同：0
> 
> 时间：2012-04-04T15:39:44.603
> 
> 标签：oracle, plsql, oracle11g

```
CREATE OR REPLACE  procedure abc
IS
TYPE abc is table of varchar2(200);
v_nt abc; 

BEGIN

select 'update emp_test set ename=''gaurav'' ' bulk collect into v_nt from emp;

forall i in v_nt.first..v_nt.last
execute immediate v_nt(i);

END; 
/ 
```

嗨，我正在创建上述过程并获得编译时错误，如下所示：

`Compilation errors for PROCEDURE SCOTT.ABC`

`Error: PLS-00801: internal error [*** ASSERT at file pdw4.c, line 586; Unknown expression Expr = 283.; ABC__SCOTT__P__53497[11, 1]] Line: 11 Text: execute immediate v_nt(i);`

我该如何解决这个问题，因为我需要批量进行此交易。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-13T11:13:44.810

下面应该工作

```
CREATE OR REPLACE procedure abc IS
  TYPE abc is table of varchar2(200);
  v_nt abc;
BEGIN
  select 'gaurav' bulk collect into v_nt from emp;
  forall i in v_nt.first .. v_nt.last 
  execute immediate 'update emp_test set ename=:1' using v_nt(i);
END;
      / 
```

虽然下面也达到了同样的结果

```
CREATE OR REPLACE procedure abc IS
 BEGIN
     execute immediate 'update emp_test set ename=''gaurav'' ';
 END;
       / 
```

# php - 如何使我的模型尽可能干燥（相同的表连接和字段选择）

> ID：10014521
> 
> 赞同：0
> 
> 时间：2012-04-04T15:39:51.427
> 
> 标签：php, model-view-controller, codeigniter, model, dry

在我的模型中，我通常至少有 2 个“获取”例程`$model->get_one()`，`$model->get_where()`并且我的模型经常扩展一个`version_model`处理数据库记录版本的例程，并具有类似`get_record_history()`.

所有这些例程都选择相同的数据库字段并执行相同的表连接。因此，为了使连接干燥，我在每个模型`$model->create_joins()`中定义了一个例程，然后由`$model->get()`上面提到的其他模型使用。

我也在考虑添加`$model->select_fields()`以使字段选择干燥，但我想我会在这里发帖，看看其他人如何处理这个问题，或者是否有更好的方法？

**编辑：**问题：是否有比上述方法更好的方法来避免在例程中重复表连接，这些例程在我的模型中选择具有不同标准的相同数据。这是像 PDO 这样的库处理的东西吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-04T16:13:49.980

对此有一条经验法则，称为[“三法则”](http://en.wikipedia.org/wiki/Rule_of_three_%28programming%29)，由 Martin Fowler 引入并归功于 Don Roberts。来自维基百科：

> 它指出代码可以复制一次，但是当相同的代码复制三次时，它应该被提取到一个新的过程中。

应用 DRY 原则时很容易迷失方向，[抽象](http://en.wikipedia.org/wiki/Abstraction_principle_%28computer_programming%29)出你能找到的一切，导致应用程序过于复杂。

在进行抽象以应用 DRY 时，考虑成本/收益比是一个好主意。

抽象通用逻辑需要时间，并且使代码更复杂（在某种程度上）。但结果是，你得到了更清晰的代码。

如果您正在处理不需要维护的快速修复，只需复制粘贴即可。但是，如果您正在构建一个需要维护的复杂应用程序，请尝试进行必要的抽象，因为它可能会在将来为您节省更多时间。

进一步阅读：

[你不会需要它的。](http://en.wikipedia.org/wiki/You_Ain%27t_Gonna_Need_It)

[亲吻原则。](http://en.wikipedia.org/wiki/KISS_principle)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-04T16:10:45.167

DRY 也适用于设计，但您写道，您的模型有时是从某个关心版本控制的类扩展而来的。

可能您应该将所有处理持久性和版本控制的模型移出，这样您就可以创建其他可以处理这些问题的对象，这样您的代码就会更加 DRY。

# javascript - 当字符串被异常分隔时检测字符串是否包含另一个字符串

> ID：10014522
> 
> 赞同：23
> 
> 时间：2012-04-04T15:39:51.490
> 
> 标签：javascript, jquery, string

我有一个这样分隔的字符串（它不是一个数组，它是一个直字符串）

string = " [美国] [加拿大] [印度] ";

我想做下面的事情。

```
if( string contains "Canada" ) {
 //Do Canada stuff here
} 
```

感谢您的任何提示

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-04T15:42:45.260

```
var string = '[United States][Canada][India]';
var search = 'Canada';
if (string.indexOf('[' + search + ']') !== -1) {
  // Whatever
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-04T16:01:14.283

只需扩展 String 方法...作为奖励，我添加了不区分大小写的匹配

```
// Only line you really need 
String.prototype.has = function(text) { return this.toLowerCase().indexOf("[" + text.toLowerCase() + "]") != -1; };

// As per your example
var Countries = " [United States] [Canada] [India] ";

// Check Spain
 if (Countries.has("Spain")) {
   alert("We got Paella!");
} 
// Check Canada
if (Countries.has("Canada")) {
   alert("We got canadian girls!");
}
// Check Malformed Canada
 if (Countries.has("cAnAdA")) {
   alert("We got insensitive cAnAdiAn girls!");
}
// This Check should be false, as it only matches part of a country
if (Countries.has("Ana")) {
   alert("We got Ana, bad, bad!");
} 
```

**演示：http:** [//jsfiddle.net/xNGQU/2/](http://jsfiddle.net/xNGQU/2/)

# android - 有没有一种有效的方法来确定图像在指定颜色范围内的百分比？（在 Android 的 OpenCV 中）

> ID：10014529
> 
> 赞同：0
> 
> 时间：2012-04-04T15:40:17.287
> 
> 标签：android, opencv

我编写了一个应用程序，它将视频帧捕获为 RGBA 格式，将其转换为 HSV（以便于阈值处理），然后对图像进行阈值处理。（基本上，在相机“看到”指定颜色的地方，它会将这些元素变成白色，如果没有，它会将这些元素变成黑色。）

我想做的是确定图像的百分比落在指定的颜色范围内。我最初的想法是扫描阈值垫的每个单独元素，并计算白色元素的数量以查看检测到颜色的位置。我有两个问题——首先，这是解决这个问题的有效方法吗？还是我错过了一些明显的东西？其次，我将如何访问 Mat 的元素（如果这是最有效的解决方案）？我已经查看了几个问题以及 Mat 文档，但这有点超出我的想象。

这是我现在用来确定图像中白色元素数量的伪代码。

```
// Loop through height
   // Loop through width 
       // If Mat element (height, width) is white, add 1 to the total 

// Compare total to the total number of elements in the image (height * width) 
```

**编辑：**我找到了如何访问 Mat 的各个元素（我想多了，并且在我找到的教程中查看一些不相关的信息时让自己感到困惑。我在下面包括了如何做到这一点，但是我会欢迎任何关于更有效的方法的想法，或者我已经尽可能有效地这样做的知识，如果我是的话！谢谢！

```
for(int h=0; h<mHSVThreshed.height(); h++){
    for(int w=0; w<mHSVThreshed.width(); w++) {
        double element = mHSVThreshed.get(h, w)[0]; 
        }
} 
```

要访问具有多个通道的 Mat，您可以使用`mHSV.get(h, w)[1] mHSV.get(h, w)[2]`etc.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-04T19:33:19.910

为了速度，我会这样做。

```
unsigned int accumulator=0;
for(int i=0;i<yourMat.rows;i++){
    unsigned char *row=yourMat.ptr(i);
    for(int j=0;j<yourMat.cols;j++)
        accumulator+=row[j];
}
accumulator/=(yourMat.cols*yourMat.rows); 
```

这假设您已将阈值设置为 1 而不是 255 或其他值。它应该比`Mat::get()`函数快得多，因为它只担心每行一次的宽度步长。

# jquery - 使用 loadmask jquery 插件时，loading.gif 没有动画

> ID：10014530
> 
> 赞同：0
> 
> 时间：2012-04-04T15:40:18.473
> 
> 标签：jquery, image, jquery-plugins

在加载下一页时，我使用了 Jquery 插件[loadmask来屏蔽表。](http://code.google.com/p/jquery-loadmask/)

一切都很好，但是当掩码显示时，loading.gif 是静态的（不旋转），这是什么原因造成的？它发生在 FF 和 IE 中，所以我认为这不是浏览器问题。

如果我单击 gif 文件本身，它会正确动画。

任何帮助，将不胜感激！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-18T19:12:48.117

奇怪的是，这现在正在工作，不确定是什么导致 gif 最初是静态的。

# c# - Nancy：HttpBasic Authentication - 注册成功后，用户可以立即登录吗？

> ID：10014532
> 
> 赞同：0
> 
> 时间：2012-04-04T15:40:24.510
> 
> 标签：c#, .net, basic-authentication, nancy

我希望新用户在成功注册后自动进行身份验证。

**当前流量**

1.  用户注册提供用户名和密码
2.  用户被重定向到受保护的内容
3.  用户受到质疑，必须重新输入其注册凭据。

**所需流量**

1.  用户注册提供用户名和密码
2.  用户已成功重定向到受保护的内容

我在 NancyFX、C# .NET 堆栈上使用*HttpBasic 身份验证*（加上 SSL）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-04T15:43:14.400

您需要的似乎是**Forms Authentication**的一种形式。

您不必**使用**ASP.NET 表单身份验证，但可以使用 cookie 进行模拟。因此，不是浏览器挑战，而是显示一个表单，并在成功输入时设置一个 cookie。

* * *

或者，在浏览器质询之后，在服务器上设置 cookie 并在后续调用中检查它。

# java - 可以使用麦克风录制一次声音，但无法第二次启动麦克风

> ID：10014537
> 
> 赞同：1
> 
> 时间：2012-04-04T15:40:36.413
> 
> 标签：java, audio, cmusphinx, sphinx4

我正在使用 CMU sphinx 库来录制声音。当我开始我的 java 应用程序时，我只分配了一次识别器和配置管理器，如下所示：

```
 cm = new ConfigurationManager(soundPart.class.getResource("hellongram.config.xml"));
        recognizer = (Recognizer) cm.lookup("recognizer");
        recognizer.allocate(); 
```

此外，我的应用程序中有一个录制声音按钮。当用户点击它时，我使用下面的代码来录制声音：

```
 Microphone microphone = (Microphone)MR.sp.cm.lookup("microphone");
    if (!microphone.startRecording()) {
        System.out.println("Cannot start microphone.");
        MR.sp.recognizer.deallocate();

        System.exit(1);
    }
    //MR.sp.pleaseStartSpeaking.setVisible(true);
    while(true){
    Result result = MR.sp.recognizer.recognize();
    if(result!=null){
        String resultText = result.getBestFinalResultNoFiller();
        MR.sp.lblYouSearched.setVisible(true);
        MR.sp.lblNewLabel.setVisible(true);
        MR.sp.lblNewLabel.setText(resultText);
        MR.textQuery = resultText.toLowerCase();
        break;
    }
    } 
```

这是我第一次这样做的时候。但是，如果用户第二次单击录制按钮，则会引发错误“无法启动麦克风”。我在这里做错了什么。为什么我第二次无法获取麦克风

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-04T16:01:36.467

[您可能想在此处](http://cmusphinx.sourceforge.net/sphinx4/javadoc/edu/cmu/sphinx/frontend/util/Microphone.RecordingThread.html)查看麦克风的 RecordingThread并重新阅读您在[此处](http://cmusphinx.sourceforge.net/sphinx4/doc/ProgrammersGuide.html)获得该代码的页面，因为您使用的代码与您想要做的代码之间的区别在于您使用的代码不会启动和停止麦克风，它正在连续录制。RecordingThread 看起来就是您所追求的，因为您可以轻松调用 start() 和 stop() 来获得您所追求的。

# ember.js - Ember.Select 未正确设置默认值

> ID：10014538
> 
> 赞同：0
> 
> 时间：2012-04-04T15:40:36.913
> 
> 标签：ember.js

我已经阅读了所有测试两次，文档阅读了三遍，但我仍然不确定我是否了解如何使用 Ember。选择正确的方式。我有一个我认为非常简单的案例：

我在模型对象（goal_type）中有一个字符串值，我想双向绑定到一个选择，并将该选择默认为目标类型字段的起始值。几个问题：

1.  我无法让选择接受模型的初始目标类型。
2.  所有这些似乎都太复杂了——必须有一种比设置观察者来修改原始控制器的状态更简单的方法。

帮助-我想弄清楚这一点我快疯了。

```
Azul.goalController = Ember.Object.create({

     加载目标：函数（数据）{
       this.set('content', Azul.store.loadAll(Azul.Goal, data));
     },

     新目标：函数（）{
       目标 = Azul.store.createRecord(Azul.Goal, {goal_type: "type2"});
       this.set('内容', 目标);
       Azul.selectedGoalTypeController.selectGoalType(goal.get('goal_type'));
     }

    });

    Azul.selectedGoalTypeController = Ember.Object.create({
      选定目标类型：空，

      selectedGoalTypeChanged：函数（）{
         Azul.goalController.content.set('goal_type', this.selectedGoalType.value);
      }.observes('selectedGoalType'),

      选择目标类型：函数（目标类型）{
         Azul.goalTypesController.content.forEach(function(item, index, self) {
           if (goal_type == item.value) {
               self.set('selectedGoalType', item);
           }
         });
      }
    });

    Azul.goalTypesController = Ember.ArrayController.create({
        内容： [
            {值：'type1'，标签：'Type 1'}，
            {值：'type2'，标签：'Type 2'}
        ]
    });

```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-04T19:22:59.613

您必须将值设置为绑定到选择选项的对象，而不是值。这里：

```
Azul.selectedGoalTypeController.selectGoalType(goal.get('goal_type')); 
```

做就是了：

```
Azul.selectedGoalTypeController.set('selectedGoalType', goal); 
```

顺便说一句，你的问题似乎有点混乱。对不起，如果我误解了你。我做了一个如何使用 Select 的简单示例，这里是小提琴：http: [//jsfiddle.net/Qpkz5/300/](http://jsfiddle.net/Qpkz5/300/)

# user-profile - 如何为房地产推荐引擎创建用户配置文件（属性）

> ID：10014540
> 
> 赞同：0
> 
> 时间：2012-04-04T15:40:41.017
> 
> 标签：user-profile, recommendation-engine

我想知道，**关于用户**（已注册或未注册）的哪些信息对于能够为**真实状态**网站显示房地产（房屋、公寓等）的推荐很有用。

例如，年龄、收入、用户看到或点击的轨迹等，以及根据这些信息，可以应用什么**样的推荐算法。**

预先感谢您的帮助

# winapi - 桌面图标文件路径

> ID：10014544
> 
> 赞同：1
> 
> 时间：2012-04-04T15:40:58.440
> 
> 标签：winapi, windows-7, windows-xp, desktop

有没有办法检索放置在桌面上的项目的文件路径，这是光标下的？

由于桌面区域是列表视图，可以获取光标下的项目索引（ListView_GetHotItem宏），但是如何检索项目元信息（文件路径）？

不幸的是，Win7 已将文件列表容器从 ListView 更改为另一个未记录的实现。

如果文件路径匹配某些规则并隐藏原始工具提示，目标是执行一些系统操作。

谢谢

# .net - Windows Web Server 2008 R2 x64 上的 BEX 错误

> ID：10014545
> 
> 赞同：1
> 
> 时间：2012-04-04T15:41:03.890
> 
> 标签：.net, windows-server-2008, buffer-overflow

我在 Windows Web Server 2008 R2 x64 上构建了一个导致缓冲区溢出异常的应用程序，具有以下签名

> 问题签名：
> 
> > 问题事件名称：BEX
> > 
> > 应用程序名称：AlgorithmEvaluation.exe
> > 
> > 应用程序版本：1.0.0.0
> > 
> > 申请时间戳：4f7c6063
> > 
> > 故障模块名称：clr.dll
> > 
> > 故障模块版本：4.0.30319.1
> > 
> > 故障模块时间戳：4ba1d9ef
> > 
> > 异常偏移量：002b5b8c
> > 
> > 异常代码：c0000409
> > 
> > 异常数据：00000000
> > 
> > 操作系统版本：6.1.7600.2.0.0.1296.17
> > 
> > 区域设置 ID：1033
> > 
> > 附加信息 1：5044
> > 
> > 附加信息2：50442b9f233457091c25e076784708c8
> > 
> > 附加信息 3：3eea
> > 
> > 附加信息 4：3eeac65aee1d9241f0a9b0ca3bae03d6

该应用程序是用 C# 编写的，并调用一个 .NET dll（用 C++/CLI 编写），而后者又包装了一个本机 C++ dll。由于我没有 x86 C++ dll 的源代码，因此我已将所有其他代码设置为构建为 x86。C# 应用程序是多线程的，使用 Microsoft 的 CCR，它读取和写入 SQL Server 2008 Express 数据库。

[按照MSDN](http://support.microsoft.com/kb/2279689)的这些说明，我已将 C++/CLI 项目设置为 TSAWARE，据此[，](http://support.microsoft.com/kb/2229865)我认为我的 C# 项目默认情况下应该已经是 TSAWARE（我正在使用远程桌面访问 Web 服务器机器，如果这很重要） . 我也读过这篇[technet](http://technet.microsoft.com/en-us/library/cc738483.aspx)文章。我考虑按照[MSDN](http://support.microsoft.com/kb/2279689)的建议关闭 DEP，但我担心这可能会导致更糟糕的事情发生

该应用程序在我运行 Windows 7 Home x64 的笔记本电脑上没有问题。

不幸的是，我没有硬件可以在合理的时间内在我的笔记本电脑上运行它。有人有想法吗？谢谢

# xcode - 项目名称更改时删除的文件

> ID：10014546
> 
> 赞同：1
> 
> 时间：2012-04-04T15:41:17.270
> 
> 标签：xcode, version-control, xcode4

我有一个工作应用程序。我通过目标部分更改了项目名称。弹出一个关于更改引用的窗口。我没有仔细阅读并接受更改。现在我的项目中缺少 2 个文件，我在项目文件夹或垃圾箱中都看不到它们。

我怎样才能找到它们？撤消不是一种选择。时间机器不是一种选择。然而，我在我的实际 iPhone 上确实有一个“好”的版本。我可以恢复那个项目吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-04T15:46:02.267

恐怕它看起来不太好。首先，您将无法从 iPhone 中恢复文件，*除非*它们是资产（即图形、媒体等）。如果是实际代码，那就不行了。

其次，当你重命名一个项目时，XCode 会询问你是否要对项目进行快照——你启用了吗？如果您这样做了，您将能够回滚到进行更改之前的项目状态。

当然，也许项目文件仍然存在并且它们只是隐藏在您的项目中：在这种情况下，如果您可以记住文件中的某些内容，则可以`grep`在项目目录中找到它们（`grep`是一个命令行实用程序，可让您在文件中搜索：如果您不熟悉它，可以[查看本指南](http://www.unixref.com/guides/grepGuide.html)）。

如果这些都不起作用，请将此视为版本控制中的一课。XCode 现在已经内置了对 Git 的支持——如果你从未使用过 Git 或版本控制，这可能是一个学习的好时机。版本控制可让您保留所做更改的历史记录并酌情回滚（例如，如果您不小心删除了文件或进行了变坏的更改）。我简化了很多，但是网上有很多关于使用 Git 的优秀资源，现在它与 XCode 完全统一，没有不使用它的真正借口。

# dojo - Dojo 1.7.2 不适用于本地文件

> ID：10014548
> 
> 赞同：2
> 
> 时间：2012-04-04T15:41:33.033
> 
> 标签：dojo

我是 dojo 的新手，所以我遵循了一个示例： http: [//livedocs.dojotoolkit.org/dijit/layout](http://livedocs.dojotoolkit.org/dijit/layout)

这工作正常...

现在，如果我使用在我的 domino 服务器上下载的 src 1.7.2，我会收到一个错误：无法加载类 'dijit/layout/BorderContainer

如果我查看 firebug，dojo.js 会与其他 .js 和 .css 文件一起加载。

我不明白为什么它不起作用......

HTML 文件位于服务器的根目录，包含以下代码：

```
<!DOCTYPE html>
<html >
<head>
<link rel="stylesheet" href="./dojo-release-1.7.2-src/dijit/themes/claro/claro.css">
<script src='./dojo-release-1.7.2-src/dojo/dojo.js' data-dojo-config='parseOnLoad: true'></script>
<script>require(["dojo/parser", "dijit/layout/BorderContainer", "dijit/layout/TabContainer", "dijit/layout/AccordionContainer", "dijit/layout/ContentPane", "dijit/layout/AccordionPane"]);</script>
</head>
<body class="claro">
<div data-dojo-type="dijit/layout/BorderContainer" style="width: 100%; height: 100%;">
 <div data-dojo-type="dijit/layout/ContentPane" data-dojo-props="region:'top'">Top pane</div>
 <div data-dojo-type="dijit/layout/AccordionContainer" data-dojo-props="region:'leading'">
      <div data-dojo-type="dijit/layout/AccordionPane" title="pane #1">accordion pane #1</div>
      <div data-dojo-type="dijit/layout/AccordionPane" title="pane #2">accordion pane #2</div>
      <div data-dojo-type="dijit/layout/AccordionPane" title="pane #3">accordion pane #3</div>
 </div>
 <div data-dojo-type="dijit/layout/TabContainer" data-dojo-props="region:'center'">
      <div data-dojo-type="dijit/layout/ContentPane" title="tab #1">tab pane #1</div>
      <div data-dojo-type="dijit/layout/ContentPane" title="tab #2">tab pane #2</div>
      <div data-dojo-type="dijit/layout/ContentPane" title="tab #3">tab pane #3</div>
 </div>
 <div data-dojo-type="dijit/layout/ContentPane" data-dojo-props="region:'trailing'">Trailing pane</div>
 <div data-dojo-type="dijit/layout/ContentPane" data-dojo-props="region:'bottom'">Bottom pane</div>
</div>
</body>
</html> 
```

很确定我错过了一些……欢迎大家帮忙:)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-04T17:05:28.887

require 语句使用斜杠，但标记应使用句点。

在整个示例中进行更改。

```
<div data-dojo-type="dijit/layout/BorderContainer" 
```

应该

```
<div data-dojo-type="dijit.layout.BorderContainer" 
```

# javascript - javascript：带有回调和“this”的原型

> ID：10014552
> 
> 赞同：11
> 
> 时间：2012-04-04T15:41:51.827
> 
> 标签：javascript, callback, websocket, prototype

我创建了一个基于原型的类`Person`，它打开一个 WebSocket 连接并将回调函数定义为原型方法。

因为在回调内部`this`将引用 WebSocket 对象，所以我使用了另一个变量来保留`Person`. `this`但是，当我处理多个实例时，变量会被覆盖。

这是一个显示问题的小片段：

```
function Person(name){
    self = this
    self.name = name
}

Person.prototype = {
    getName : function(){
        return self.name
    },

    openConnection : function(host, port){
        self.pointCount = 0
        self.ws = new WebSocket("ws://" + host + ":" + port)
        self.ws.onopen = self.onOpenConnection
    },

    onOpenConnection : function()   {
        console.log(this) // prints the websocket
        console.log(self) // prints the person
        self.ws.send(self.name) // works only if one person exists
    }
}

var p1 = new Person("Jonh")
var p2 = new Person("Adam")

console.log(p1.getName()) // Prints Adam
console.log(p2.getName()) // Prints Adam

p1.openConnection("localhost", 7000) // opens connection for p1
p2.openConnection("localhost", 7000) // opens another connection for p1 
```

如果`Person`创建了多个，则在尝试通过套接字发送消息时出现以下错误：

> 未捕获的错误：INVALID_STATE_ERR：DOM 异常 11

所以它似乎`self`是全局定义的，我试图在回调中获取`Person`' 的句柄失败了。`this`关于如何实现这一目标的任何建议？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-04-04T15:48:55.620

当你这样做时：

```
self = this 
```

您正在隐式创建一个全局变量，该变量（因为它是全局的）对于所有实例都具有相同的值。局部变量，必须有`var`，`let`或`const`在它们前面，如以下之一：

```
var self = this;
const self = this;
let self = this; 
```

但是，这不是您的解决方案。您需要改为使用`this`。而且，如果您要为 websocket 提供回调并且您希望与此关联的人，我建议您只需在 websocket 上放置对 Person 对象的引用，然后您就可以从那里检索它。而且，每条语句的结尾都缺少分号是怎么回事？无论如何，这里有一些固定的代码：

```
function Person(name){
    this.name = name;
}

Person.prototype = {
    getName : function(){
        return this.name;
    },

    openConnection : function(host, port){
        this.pointCount = 0;
        this.ws = new WebSocket("ws://" + host + ":" + port);
        // save person reference on the web socket
        // so we have access to the person from web socket callbacks
        this.ws.person = this;   
        this.ws.onopen = this.onOpenConnection;
    },

    onOpenConnection : function()   {
        // "this" will be the websocket
        // "this.person" is the person object
        console.log(this); // prints the websocket
        console.log(this.person); // prints the person
        this.send(this.person.name); // works only if one person exists
    }
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-04-04T16:12:40.150

在 Javascript 中声明变量时，如果您不将 a`var`放在前面，它将被视为全局变量，这会在您的情况下导致一些问题。

当构造函数按预期运行时，您可能希望执行以下操作，因此`name`保存到您正在创建的 Person 实例中：

```
// Constructor
function Person(name){
    // You don't need to reference "self" here. It's already implied.
    this.name = name;
} 
```

此外，在 WebSocket.onopen 中，“this”从 Person 的实例变为 WebSocket 的实例。您需要保留“Person”以便在 WebSocket.onopen 中引用它。

```
// Prototype
Person.prototype = {
    getName : function(){
        // 'this' in this case refers to an instance of Person. 
        // So, when creating John, this.name will be John. 
        return this.name;
    },

    openConnection : function(host, port) {
        // Similar to getName(...), this refers to an instance of Person.
        // In your example, this.pointCount is NOT shared between John and Adam
        this.pointCount = 0;
        this.ws = new WebSocket("ws://" + host + (port ? ':' + port : ''));

        // In WebSocket.onopen below, you're working with a new scope, so you 
        // won't have access to 'this' as the Person anymore. You need to save 
        // 'this' somewhere, so you can reference it in the new scope.
        // *****
        var self = this;   

        this.ws.onopen = function() {
            // In this function, a new scope has been created. 'this' no 
            // longer refers to John/Adam (The instance of Person), but to 
            // WebSocket instead.

            console.log(this); // 'this' references the WebSocket instance
            console.log(self); // 'self' references the 'self' in the outer 
                               // scope. See *****

            // Since this = WebSocket in this scope, all we need to do
            // is this.send(...). If you'd like to obtain the refer
            // to the instance of the Person you worked with, you can
            // use the 'self' variable
            this.send(self.name); 
        };
    }
}; 
```

希望这可以帮助！这是一个与之配套的 JSFiddle：http: [//jsfiddle.net/WFdbe/](http://jsfiddle.net/WFdbe/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-04T15:45:00.317

`self = this`

您创建了一个全局变量，这就是您的代码被破坏的原因。

尝试`self`在原型内部引用也不起作用，请使用`this`

```
function Person(name){
    this.name = name
}

Person.prototype = {
    openConnection : function(host, port){
        this.pointCount = 0
        this.ws = new WebSocket("ws://" + host + ":" + port)
        this.ws.onopen = this.onOpenConnection.bind(this)
    },
    constructor: Person,    
    onOpenConnection : function()   {
        console.log(this) // prints the person
        this.ws.send(this.name) // works only if one person exists
    }
} 
```

# eclipse - Eclipse 远程调试到在同一主机上的 VM 上运行的 glassfish 服务器

> ID：10014554
> 
> 赞同：1
> 
> 时间：2012-04-04T15:42:04.277
> 
> 标签：eclipse, glassfish

我想在eclipse中调试我的项目。我在同一台机器上的虚拟机（运行 solaris）中有一个 glassfish 服务器。我应该指定哪些端口，以便它可以识别服务器。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-04T16:17:02.560

以调试模式启动服务器 asadmin start-domain --debug 这将以调试模式启动 glassfish，端口为 9009。在 eclipse 的远程调试器配置中提及 vm 的 IP 地址和端口号。

# iphone - iphone - 图像加载

> ID：10014566
> 
> 赞同：0
> 
> 时间：2012-04-04T15:42:36.897
> 
> 标签：iphone, ios, xcode4.2

嗨，我在将图像快速加载到屏幕时遇到问题。我第一次看到视图时似乎有延迟：

这是我加载图像的方式：

```
for (int i = 1; i < 19; i++)
{
    UIImage *image = [UIImage imageNamed:[NSString stringWithFormat:@"%@_Hole%d_", courseName, i]];
    imageView = [[UIImageView alloc] initWithImage:image];
    frame.origin.x = cx;
    imageView.frame = frame;
    [scrollView addSubview:imageView];
    cx += scrollView.frame.size.width;
    imageView = nil;
} 
```

每张图像为 640 x 820。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-04T16:11:46.837

正如其他人所指出的，您遇到了图像处理的一个基本问题：设备的有限 I/O 速度。

顺便说一句，`imagedNamed:`内部缓存图像，这可能解释了为什么后续加载速度很快。

如果平铺不是一个选项（如@Krio 推荐的那样），您可以尝试在需要查看之前将图像预加载到后台线程上的缓存中。例如，如果此视图通常是从另一个视图访问的，则您可以启动一系列`imageNamed:`调用，`dispatch_async`或者`NSOperationQueue`在较早的视图加载时进行。但是，这只会在某些情况下有所帮助：

- 你知道你的图像视图几乎总是下一个被请求的 UI 元素。

-您提前知道要加载哪些资产。

- 你的图像集足够小，你不会填满所有内存，迫使框架驱逐你刚刚填满的缓存

请注意，这也会给您的应用程序设计带来相当多的复杂性，因此除非绝对必要，否则最好避免。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-04T15:46:46.207

我不认为你可以做很多其他事情来加快速度。

但是，您确实存在内存管理问题，这可能会在一定程度上加快进程。

```
for (int i = 1; i < 19; i++)     {
     UIImage *image = [UIImage imageNamed:[NSString stringWithFormat:@"%@_Hole%d_", courseName, i]];
     imageView = [[UIImageView alloc] initWithImage:image];
     frame.origin.x = cx;
     imageView.frame = frame;
     [scrollView addSubview:imageView];
     cx += scrollView.frame.size.width;
     [imageView release];
 } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-04T15:48:18.753

是的，加载图像需要一些时间。你有大量的大图像，所以这是预期的结果。尝试考虑平铺层而不是将 UIImages 添加到滚动视图。CATiledLayer 可以帮助你

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-04T16:25:25.723

嗨图像加载冻结 UI。您可以在后台执行此任务，这样 UI 就不会被冻结。试试下面的代码。

```
 -(void)loadImages{
        [self performSelectorInBackground:@selector(loadImagesInBackGround) withObject:nil];
   } 

  -(void)loadImagesInBackGround{

        for (int i = 1; i < 19; i++)
  {
        UIImage *image = [UIImage imageNamed:[NSString stringWithFormat:@"%@_Hole%d_", courseName, i]];
       imageView = [[UIImageView alloc] initWithImage:image];
       frame.origin.x = cx;
       imageView.frame = frame;
       [scrollView addSubview:imageView];
       cx += scrollView.frame.size.width;
       imageView = nil;
  }

} 
```

您应该调用 loadImages: 从您要加载图像的位置。或者，您可以尝试使用 Grand Central Dipatch (GCD) 在后台加载图像。

# python - Python - 打开pdf文件到特定页面/部分

> ID：10014572
> 
> 赞同：7
> 
> 时间：2012-04-04T15:42:58.393
> 
> 标签：python, pdf

是否可以从 Python 中打开 pdf 以使其转到特定页面或部分？我在想的是让它打开一个帮助文件（pdf）并跳转到请求帮助的部分。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-04T16:11:24.873

这里有两个基本的想法

## 案例1：你想用Python打开文件

```
from pyPdf import PdfFileReader, PageObject

pdf_toread = PdfFileReader(path_to_your_pdf)

# 1 is the number of the page
page_one = pdf_toread.getPage(1)

# This will dump the content (unicode string)
# According to the doc, the formatting is dependent on the
# structure of the document
print page_one.extractText() 
```

至于部分，你可以看看这个[答案](https://stackoverflow.com/a/1851011/493211)

## 案例2：您想调用acrobat在特定页面打开文件

从此[Acrobat 帮助文档](http://www.adobe.com/content/dam/Adobe/en/devnet/acrobat/pdfs/pdf_open_parameters.pdf)中，您可以将其传递给子进程：

```
import subprocess
import os

path_to_pdf = os.path.abspath('C:\test_file.pdf')
# I am testing this on my Windows Install machine
path_to_acrobat = os.path.abspath('C:\Program Files (x86)\Adobe\Reader 10.0\Reader\AcroRd32.exe') 

# this will open your document on page 12
process = subprocess.Popen([path_to_acrobat, '/A', 'page=12', path_to_pdf], shell=False, stdout=subprocess.PIPE)
process.wait() 
```

只是一个建议：如果要在特定部分打开文件，可以使用参数`search=wordList`where`wordlist`是由空格分隔的单词列表。文档将被打开并执行搜索，它的第一个结果被突出显示。这样，作为一个`wordlist`，你可以尝试把部分的名称。

# powershell - 如何修改我的服务器以在 Powershell 中轻松调用远程命令

> ID：10014574
> 
> 赞同：0
> 
> 时间：2012-04-04T15:43:00.547
> 
> 标签：powershell, powershell-2.0, powershell-remoting, remote-server

当我可以通过简单地输入远程会话时，我有服务器（使用*Microsoft Windows Server 2003 R2 SE ；手动安装 WinRM）：*

> 输入-PSSession *computername_here*

或（在远程会话之外）调用远程命令：

> Get-Process -ComputerName *computername_here*

不幸的是，在另一个（使用*Microsoft Windows Server 2008 R2 SE*）上它不起作用（尽管我使用相同的配置）。我需要输入（根据第一个示例）：

> 输入-PSSession `IP address`-Credential "域\用户名"

然后给出用户名和密码。我知道可以将凭据保存到外部文件，但我不想像连接第一台服务器那样简单地连接到远程服务器？我应该检查防火墙还是以特殊方式配置我的服务器？

==================================================== =================

谢谢你的答案。我说的是“Microsoft Windows Server 2008 R2 Standard”操作系统
（“*gwmi win32_operatingsystem |select name*”命令告诉我）。

> WSManConfig：Microsoft.WSMan.Management\WSMan::localhost\Client

包含属性*TrustedHosts*设置为 *，所以我认为它是正确的。

有趣的是，虽然我在两台机器上都有管理员权限，但是当我尝试检查“localhost”包含的内容时，我收到了一条错误消息，而不是直接从服务器，而是从我的本地计算机：

> PS WSMan:\localhost> ls
> 访问被拒绝。+ CategoryInfo : + FullyQualifiedErrorId : System.InvalidOperationException,Microsoft.PowerShell.Commands.GetChildItemCommand

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-05T07:05:35.987

要检查的是您当前的用户是否有权访问目标服务器，服务器是否与客户端在同一个域中？

您能否澄清一下您使用的是什么服务器？AFAIK Microsoft Windows Server 2008 R2 SE 不存在。是2008年还是2003年？

这可能与客户端的`TrustedHosts`设置`Authentication`有关。您可以这样设置： `WinRM set winrm/config/client @{TrustedHosts="*"}` 在此处阅读更多信息：http: [//blogs.dirteam.com/blogs/sanderberkouwer/archive/2008/02/23/remotely-managing-your-server-core-using-winrm-a​​nd -winrs.aspx](http://blogs.dirteam.com/blogs/sanderberkouwer/archive/2008/02/23/remotely-managing-your-server-core-using-winrm-and-winrs.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-05-05T21:06:07.180

我知道这是几年后的事了，但这有帮助吗？

```
#this is TEST computer IP
# $computer = "xxx.xxx.xxx.xxx"

# if(test-wsman $computer -ErrorAction SilentlyContinue){
    # Remoting is enabled, continue
    # Write-Host "remoting is enabled"
# } else {
    # Something is wrong. 
    # throw "remoting is not enabled"
# } 
```

# grails - Grails log4j 版本与第三方 java API 冲突

> ID：10014584
> 
> 赞同：1
> 
> 时间：2012-04-04T15:43:31.250
> 
> 标签：grails, log4j

我必须使用 Cisco 的第三方 Java API，它使用旧版本的 Log4J 即 1.1.3 独立运行时，显然 API 工作正常，但从 Grails (1.3.7) 运行时，它会因“找不到操作”而崩溃Log4j 初始化期间的异常。

我该如何解决这种冲突？

这是包含 lib 文件夹中的 cisco lib 的 BuildConfig 实际插件。

```
grails.project.class.dir = "target/classes"
grails.project.test.class.dir = "target/test-classes"
grails.project.test.reports.dir = "target/test-reports"
//grails.project.war.file = "target/${appName}-${appVersion}.war"
grails.plugin.location.'advoss-orm-core' = "../../../advoss-orm-core-grails-plugin/branches/ShahbazORMPlugin"

grails.project.dependency.resolution = {
    // inherit Grails' default dependencies
    inherits("global") {
        // uncomment to disable ehcache
        // excludes 'ehcache'
    }
    log "warn" // log level of Ivy resolver, either 'error', 'warn', 'info', 'debug' or 'verbose'
    repositories {
        grailsPlugins()
        grailsHome()
        grailsCentral()

        // uncomment the below to enable remote dependency resolution
        // from public Maven repositories
        mavenLocal()
        mavenCentral()

        flatDir  name:"lib", dirs:"lib"
        //mavenRepo "http://snapshots.repository.codehaus.org"
        //mavenRepo "http://repository.codehaus.org"
        //mavenRepo "http://download.java.net/maven/2/"
        //mavenRepo "http://repository.jboss.com/maven2/"
    }
    dependencies {
        runtime('mysql:mysql-connector-java:5.1.16') {
            transitive = false
        }
        compile ':command:1.0',
                ':commons-codec:1.3',
                ':commons-httpclient:3.1',
                ':commons-logging:1.1.1',
                ':deltawing:1.0',
                ':deltaxml:1.0',
                ':isorelax:1.0',
                ':jhall:1.0',
                ':jing:1.0',
                ':junit-dep:4.9b2',
                ':marklogic-xcc:4.2.2',
                ':metadata-extractor:2.3.1',
                ':msv:1.0',
                ':resolver:1.0',
                ':saxon:9pe',
                ':tagsoup:1.2',
                ':xep:1.0',
                ':xmlunit:1.3'
    }
} 
```

现在这里是包含上述插件的项目的构建配置，并且无法执行 Cisco 库调用并出现 Log4j 错误：

```
grails.project.class.dir = "target/classes"
grails.project.test.class.dir = "target/test-classes"
grails.project.test.reports.dir = "target/test-reports"
grails.plugin.location.'adv-provisioning-server' = "../../../adv-provisioning-server/branches/AlamSher_AdvProvisioningServer"
grails.plugin.location.'advoss-orm-core' = "../../../advoss-orm-core-grails-plugin/branches/ShahbazORMPlugin"
//grails.plugin.location.'advoss-trouble-ticket' = "../../../advoss-trouble-ticket-grails-plugin/branches/ShahbazTroubleTicketPlugin"

//grails.project.war.file = "target/${appName}-${appVersion}.war"

grails.project.dependency.distribution = {
    remoteRepository(id: "release", url: "http://192.168.0.2:8080/artifactory/plugins-release-local") {
        authentication username: "maven_user", password: "mav3nus3r"
    }
}

grails.project.dependency.resolution = {

    pom true

    // inherit Grails' default dependencies
    inherits("global") {
        // uncomment to disable ehcache
        // excludes 'ehcache'
    }
    log "warn" // log level of Ivy resolver, either 'error', 'warn', 'info', 'debug' or 'verbose'
    repositories {

        mavenLocal()
        mavenCentral()
        mavenRepo "http://repository.codehaus.org"
        mavenRepo "http://download.java.net/maven/2/"

        grailsPlugins()
        grailsHome()
        grailsCentral()
    }

    dependencies {
        runtime('mysql:mysql-connector-java:5.1.16') {
            transitive = false
        }
        compile 'jaxfront:jaxfront-html:1.0',
                'jaxfront:jaxfront-pdf:1.0',
                'jaxfront:jaxfront-core:1.0',
                'advoss-voms:VomsWSClient:1.0',
                'com.lowagie:itext:2.1.7',
                'freemarker:freemarker:2.3.9',
//                'net.sourceforge.barbecue:barbecue:1.5-beta1',
//                'net.sf.jasperreports:jasperreports-fonts:4.0.0',
//                'net.sf.jasperreports:jasperreports-javaflow:3.7.5',
                'commons-httpclient:commons-httpclient:3.1',
                'commons-net:commons-net:20030805.205232'
//        compile('net.sf.jasperreports:jasperreports:4.0.1') {
//            transitive = false
//        }
        compile('net.sf.jasperreports:jasperreports:4.1.2') {
            excludes 'poi-ooxml', 'antlr', 'commons-beanutils',
                    'commons-collections', 'commons-logging',
                    'ant', 'mondrian', 'commons-javaflow',
                    'barbecue', 'xml-apis-ext', 'xml-apis',
                    'xalan', 'groovy-all', 'hibernate',
                    'saaj-api', 'servlet-api', 'xercesImpl', 'xmlParserAPIs',
                    'spring-core', 'bsh', 'spring-beans', 'jaxen',
                    'barcode4j', 'batik-svg-dom', 'batik-xml',
                    'batik-awt-util', 'batik-dom', 'batik-css',
                    'batik-gvt', 'batik-script', 'batik-svggen',
                    'batik-util', 'batik-bridge', 'persistence-api',
                    'jdtcore', 'bcmail-jdk14', 'bcprov-jdk14', 'bctsp-jdk14'
        }
    }

    plugins {
        compile ':jsecurity:0.4.1',
                ':message-digest:1.1',
                ':quartz:0.4.2',
                ':export:0.7',
                ':jquery:1.4.4.1',
                ':jquery-ui:1.8.2',
                ':xml-validator:0.1',
                ':advoss-orm-core:1.0.2.0',
        compile (':adv-provisioning-server:1.0.0.1') {
            excludes('commons-httpclient')
        }
        runtime(':jasper:1.2') { excludes 'jasperreports' }
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-06T19:17:52.627

如果我理解正确，您将遇到相互冲突的依赖关系。

假设第三方 Cisco 库是使用此工件字符串从 maven 解析的：`"com.cisco.foo"`. `BuildConfig.groovy`您可以在排除 Log4J 传递依赖的部分之后添加一个闭包，如下所示：

```
dependencies {
  // ... other dependencies
  compile("com.cisco.foo") {
    excludes "log4j"
  }
} 
```

这将有效地排除 Cisco lib 包含的 Log4J 1.1.3。

编辑：如果 JAR 只是在`lib/`而不是上面的位，IIRC 您可以执行以下操作：

```
dependencies {
  // ... other dependencies
  inherits("global") {
    excludes "log4j"
  }
} 
```

但是，在这种情况下，`lib/`目录中的 log4j 1.1.3 也是如此，或者 Cisco JAR 是带有 Log4J 类的胖 jar。后一种情况可能更棘手，如果是这样，您应该将其添加到您的问题中。

# c# - 只需要表格中的字段中的日期，而不需要完整的日期时间

> ID：10014586
> 
> 赞同：-1
> 
> 时间：2012-04-04T15:43:36.503
> 
> 标签：c#, asp.net

我正在从数据库中读取信息，我真的只是对它的显示/排序方式有疑问。我想阅读日期时间，但我只想显示日期，我希望它从现在到未来排序。

```
nextreview.DataType = System.Type.GetType("System.DateTime"); 
```

这就是我现在拥有的，但这包括时间，但我不需要它并且希望它消失。

以前有这个：

```
nextreview.DataType = System.Type.GetType("System.String"); 
```

并在阅读时...将字符串转换为我想要的显示

```
ToString("MM/dd/yyyy") 
```

除了分类之外，这是完美的。

那么关于如何让它显示为“mm/dd/yyyy”但仍被视为日期时间的任何帮助？将 c# 和 asp.net 用于网页

这是感兴趣的人的代码[http://pastebin.com/WQBUyrQT](http://pastebin.com/WQBUyrQT)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-04T15:59:39.027

您可能希望分两步进行：

1.  保留数据`DateTimes`并对其进行排序（您可以使用 LINQ`OrderBy`或`OrderByDescending`）。
2.  现在信息已排序，您可以使用`ToString("MM/dd/yyyy")`每个成员的方法将其转换为仅“日期”字符串。您可以使用 LINQ 的`Select`方法来执行此操作。

例如：

```
var myData = // get info from DB;
var sortedData = myData.OrderBy(a => a.DateProperty);
var stringData = sortedData.Select(a => a.ToString("MM/dd/yyyy"); 
```

`stringData`现在是一个`IEnumerable<string>`包含按升序排列的格式化日期值。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-04T17:20:06.750

格式化是一种*显示*功能，而不是*业务逻辑*。因此，格式化逻辑*属于 UI*。

既然您已经标记了这个问题`asp.net`，我建议您调查[DataFormatString 属性](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.boundfield.dataformatstring.aspx)（或者，在 xml 中，属性）。我认为您正在寻找的具体价值是`"{0:d}"`.

从您的示例代码中，您可以将此代码添加到`Page_Load()`处理程序底部附近的某个位置：

```
((BoundField)gvEmployeeReview.Columns[1]).DataFormatString = "{0:d}"; //date hired column
((BoundField)gvEmployeeReview.Columns[8]).DataFormatString = "{0:d}"; //next review column 
```

（当然，添加任何其他有日期的列！）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-04T15:57:15.377

好吧，没有 System.Date 类型，所以不幸的是你必须让它与 System.DateTime 一起工作。然而，这不是一个新问题，并且有已知的解决方案。

也许需要更多信息；你到底用什么来从表中提取记录，你用什么来保存这些记录，以及你是如何在检索背后构建数据库查询的？

如果您不关心日期/时间值的时间元素，您可以做的第一件事是将其截断为数据库查询的一部分。T-SQL 中的公式类似于：

```
 SELECT CONVERT(datetime, CONVERT(varchar(20), GetDate(), 101)) as Today 
```

有些操作可以在不返回字符串的情况下为您提供相同的结果，在 SQL Server 2008 及更好的版本中，您可以转换为 Date 类型，但上述查询相对简洁，适用于任何 SQL Server 版本从 2000 年开始。

其次，如果您不能这样做（例如，您正在使用无法更改的存储过程），则 System.DateTime 上有一个可用的 Date 属性，它返回时间分量为零的值（例如，`DateTime.Now.Date == DateTime.Today`） . 如果您使用可以接受 lambda 的排序方法，例如 Linq 的 OrderBy() 或 List.Sort()，您可以投影该值而无需更改它。或者，如果您从不想处理该值，只需通过向下查看表并将列中的每个字段设置为其 Date 属性的值来更改它。如果其他人可能关心时间戳，请不要将这些值保存回数据库。

编辑评论：

System.DateTime 将始终具有时间组件。.NET 中的日期时间基于单个 Int64“Ticks”值。一个“滴答声”~= 100ns。您看到的所有与时间相关的属性，如小时、分钟、秒等，都是基于该刻度值计算的，“日期”组件的年、月和日也是如此。例如，可以通过从 Ticks 值开始计算 Seconds 属性，取模除以每分钟的 Ticks 数（6 亿），然后将结果除以每秒的 Ticks 数（1000 万）。

因此，根本不可能切断“日期”和“时间”的概念，因为它们都存储在相同的数值中。您可以做的最好的事情是指定一个 DateTime，它的 Ticks 数量可以被 864,000,000,000（24 小时内的 Ticks 数量）整除，以便时间属性的计算结果都为零。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-12T14:20:59.960

我只是重做了页面并在gridview中构建了表格，而不是在代码中构建它......最后它更容易......不得不更改一些代码......但结果一切都很好......感谢所有的投入

# android - System.out.println("控制台消息") 不起作用

> ID：10014590
> 
> 赞同：0
> 
> 时间：2012-04-04T15:43:52.090
> 
> 标签：android, android-layout, android-emulator

我尝试使用 System.out.println("Console message") 打印消息，但消息没有在控制台中打印。这有什么具体原因吗？那么如何打印控制台消息呢？

我可以看到另一个名为 DDMS 的窗口。它有什么用？

请帮忙

问候，邦蒂

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-04T15:44:39.547

使用`Log.d("Title", "Message");`代替控制台，您可以在**logcat**窗口中看到结果

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-04T15:45:35.270

标准输出自动进入 logcat
，您可以使用“adb logcat”命令访问它

或在 Eclipse 中使用 logcat 视图

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-04T15:56:50.970

这里有一些[阅读材料](http://developer.android.com/reference/android/util/Log.html)给你。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-04T15:58:08.840

你必须先搜索然后去问问题，这是关于它的教程的android开发者链接：

*   [http://developer.android.com/guide/developing/tools/logcat.html](http://developer.android.com/guide/developing/tools/logcat.html)
*   [http://developer.android.com/guide/developing/debug-tasks.html](http://developer.android.com/guide/developing/debug-tasks.html)

# java - 在 Objectify 中持久化类文字

> ID：10014593
> 
> 赞同：0
> 
> 时间：2012-04-04T15:44:00.610
> 
> 标签：java, google-app-engine, objectify

如果我有一个带有类文字作为字段的 POJO，我可以将它保存在 Objectify 中吗？

```
private Class<Foo> fooType; 
```

这些文档似乎另有建议，但我想我只需检查一下即可：

[http://code.google.com/p/objectify-appengine/wiki/IntroductionToObjectify](http://code.google.com/p/objectify-appengine/wiki/IntroductionToObjectify)

[https://developers.google.com/appengine/docs/java/datastore/entities#Properties_and_Value_Types](https://developers.google.com/appengine/docs/java/datastore/entities#Properties_and_Value_Types)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-04T16:28:37.987

默认情况下，没有。但是，您可以相当容易地添加一个翻译器，它将一个类作为一个字符串本地存储在数据存储中。您在保存时使用 Class.getName()，在加载时使用 Class.forName()。

以下是在 Objectify3 中执行操作的示例：

[http://code.google.com/p/objectify-appengine/source/browse/tags/3.1/src/com/googlecode/objectify/impl/conv/joda/DateTimeZoneConverter.java](http://code.google.com/p/objectify-appengine/source/browse/tags/3.1/src/com/googlecode/objectify/impl/conv/joda/DateTimeZoneConverter.java)

请注意，如果类型与转换器无关，则在单个转换器中返回 null。此处描述了如何启用它：

[http://code.google.com/p/objectify-appengine/source/browse/tags/3.1/src/com/googlecode/objectify/impl/conv/joda/JodaTimeConverters.java](http://code.google.com/p/objectify-appengine/source/browse/tags/3.1/src/com/googlecode/objectify/impl/conv/joda/JodaTimeConverters.java)

这是 Objectify4 中的等价物：

[http://code.google.com/p/objectify-appengine/source/browse/trunk/src/com/googlecode/objectify/impl/translate/opt/joda/DateTimeZoneTranslatorFactory.java](http://code.google.com/p/objectify-appengine/source/browse/trunk/src/com/googlecode/objectify/impl/translate/opt/joda/DateTimeZoneTranslatorFactory.java)

此处描述了如何启用它：

[http://code.google.com/p/objectify-appengine/source/browse/trunk/src/com/googlecode/objectify/impl/translate/opt/joda/JodaTimeTranslators.java](http://code.google.com/p/objectify-appengine/source/browse/trunk/src/com/googlecode/objectify/impl/translate/opt/joda/JodaTimeTranslators.java)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-04T16:20:11.183

Objectify 只能持久[化 GAE Datastore 支持的类型](https://developers.google.com/appengine/docs/java/datastore/entities#Properties_and_Value_Types)。Java 类型`Class`不是其中之一。

此外，由于[类型擦除](http://docs.oracle.com/javase/tutorial/java/generics/erasure.html)，字段`fooType`不包含通用参数信息。

现在，有几种存储`Class`类型的方法：

1.  只存储类的长名称，通过@PrePersist/@PostLoad 转换。这样做的好处是您将获得一个可以查询的普通字符串属性。

    ```
    @Transient // tells Objectify to ignore field
    public Class<Foo> fooType;

    @PrePersist
        public prePersist(Entity entity){
        entity.setProperty("fooType", fooType.getName())
    }

    @PostLoad
    public postLoad(Entity entity){
       fooType = Class.forName(entity.getProperty("fooType"));
    } 
    ```

2.  [序列化](http://code.google.com/p/objectify-appengine/wiki/IntroductionToObjectify#@Serialized)（`Class`因为它实现`Serializable`了这是允许的）。这将使用 Java 序列化将字段保存为 Blob（最大 1Mb 大小）。这是一个简单的解决方案，但缺点是该属性没有被索引并且不能在查询中使用。

    ```
    @Serialize
    private Class<Foo> fooType; 
    ```

# c# - 使用特定方法从 IDataReader 获取价值有什么好处吗？

> ID：10014596
> 
> 赞同：1
> 
> 时间：2012-04-04T15:44:09.300
> 
> 标签：c#, database

有多种方法可以从 IDataReader 获取值。

```
reader["FirstName"]; // by column name array style.
reader[0];           // by index array style.
reader.GetValue(0);  // by index method style.
reader.GetString(0); // by index using specific method. 
```

其中一个比另一个更好吗？它们中的任何一个都有性能缺陷吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-04T16:01:52.383

`reader.GetValue(0)`是最快的方法。

使用`reader["FirstName"]`调用`reader.GetOrdinal("FirstName")`然后调用`reader.GetValue(0)`。`reader[0]`只需调用`reader.GetValue(0)`它的吸气剂。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-04T16:43:34.107

在极少数情况下您不应该使用列名。从技术上讲，列名被转换为索引，因此直接使用索引会稍微快一些。但是，与数据库调用本身相比，该余量将相形见绌，因此它确实无关紧要。并且 - 假设您已将语义含义赋予要返回的列，并且没有实现某种通用数据处理器 - 使用索引使您将来更有可能在查询中的数据发生更改时意外引入错误.

# c# - Assembly.GetTypes() - 获取加载失败的类型

> ID：10014601
> 
> 赞同：2
> 
> 时间：2012-04-04T15:44:19.983
> 
> 标签：c#, typeloadexception

当存在无法加载的类型时，Assembly.GetTypes() 会引发 ReflectionTypeLoadException。

该异常有一个 Types[] 属性列出了成功加载的类型，还有一个 LoaderExceptions[] 属性列出了加载失败的类型的异常。

我的问题：如何获得与 LoaderExceptions 对应的类型本身？

编辑：我实际上正在寻找无法加载的类型的**名称。**很抱歉有任何混乱。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-04T15:46:46.727

这是不可能的。CLR 未能创建`Type`对象，这就是您获得一组`LoaderExceptions`. 根本没有`Type`对象可以描述`Type`加载失败的对象。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-11-18T08:55:22.363

当您从某个位置加载的 Dll 已在您的应用程序或父应用程序中引用时，通常会发生此错误。如果 Dll 已经在引用中，则循环通过您的应用程序的`Assemblies`.

```
foreach (var asm in AppDomain.CurrentDomain.GetAssemblies())
{
      if (asm.ManifestModule.FullyQualifiedName.EndsWith("YourDllName.dll"))
      {
            foreach (var Type in asm.GetTypes())
            {
                  // Apply your logic here
            }                
            break;
      }
} 
```

# java - 无法为 cookie 设置值

> ID：10014603
> 
> 赞同：2
> 
> 时间：2012-04-04T15:44:25.150
> 
> 标签：java, android, cookies

对不起我的英语。我在我的 Android 智能手机上创建了一个简单的应用程序。该应用程序必须将来自一个站点的 cookie 替换为具有不同值的 cookie，但其他参数必须相同。所以我以这种方式得到了那个 Cookie：

```
Cookie c = httpclient.getCookieStore().getCookies().get(0); 
```

现在我想改变价值。问题从这里开始，因为我不能使用这样的方法：

```
c.setValue(newValue); 
```

我不断收到错误“Cookie 类型的方法 setValue(String) 未定义”，但我看到了在各种代码中使用该方法的示例，例如：[http ://www.javadrive.jp/servlet/cookie/index4 .html](http://www.javadrive.jp/servlet/cookie/index4.html)。我究竟做错了什么？请向我解释清楚，因为我是Java新手。谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-04T15:49:40.077

该[`Cookie`](http://developer.android.com/reference/org/apache/http/cookie/Cookie.html)接口没有定义任何`setXXX()`方法。你需要创建一个新的实例`Cookie`来改变它的状态（或者你可以强制转换它，但这需要你知道它的底层类型）。

也许您应该考虑创建一个实例[`BasicClientCookie`](http://developer.android.com/reference/org/apache/http/impl/cookie/BasicClientCookie.html)并将其状态设置为 cookie 的状态，使其与您已经拥有的 cookie 的状态相同，但您想要更改的值除外。

# inheritance - 为什么我的@MappedSuperClass 不起作用？

> ID：10014608
> 
> 赞同：1
> 
> 时间：2012-04-04T15:44:55.287
> 
> 标签：inheritance, ejb, entity, openjpa, mappedsuperclass

我有以下 @MappedSuperClass 和 @Entity ：

```
@MappedSuperclass 
public class SuperClass implements Serializable {....}

@Entity
@Inheritance(strategy=InheritanceType.TABLE_PER_CLASS)
@Table(name = "TABLE1")
public class Table1 extends SuperClass implements Serializable {...}

@Entity
@Inheritance(strategy=InheritanceType.TABLE_PER_CLASS)
@Table(name = "TABLE2")
public class Table2 extends SuperClass implements Serializable {...} 
```

在数据库中，两个表都有相同的列，所以我的所有属性都在 SuperClass 中：

```
@Id
private String attr1;

@Id
private String attr2;

@Column(name="DATA")
private String data;

// getters and setters 
```

但是当我尝试使用@entity（table1 或 table2）之一执行查询时，我得到一个 OpenJPA ERROR ：

```
Error pre-processing class table1 with weblogic.deployment.PersistenceUnitInfoImpl$ClassPreProcessorImpl@205c54b'
<openjpa-1.1.0-r422266:657916 fatal user error> 
org.apache.openjpa.util.MetaDataException: Type "class SuperClass" with application identity and no superclass does not declare an id class.  
This type is not eligible for builtin identity, so it must declare an id class. 
```

我不明白为什么在@Entity 类中找不到属性@Id。

如果有人有任何想法，请随时帮助我:)

问候，

Cytemax

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-11-13T15:41:53.237

感谢您在评论中回答这个 Cytemax。[我在这里找到了更多澄清信息： http](http://openjpa.apache.org/builds/1.0.0/apache-openjpa-1.0.0/docs/manual/manual.html#jpa_overview_pc_identitycls) ://openjpa.apache.org/builds/1.0.0/apache-openjpa-1.0.0/docs/manual/manual.html#jpa_overview_pc_identitycls

The example given doesn't use annotations but you mentioned them in your comments. Kind of an odd thing for openJPA to need but as I view the table and java object hierarchy in my mind it sort of makes sense.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-11-06T14:49:04.203

My @Entity class must have an @IdClass(SuperClassPK.class), because my primary key contains two properties (attr1 & attr2).

This @IdClass declare the two properties and must override the "equals" and "hashcode" method.

Maybe this will help someone else ;).

# jquery-mobile - 如何阻止 JQM 设置页面样式？

> ID：10014609
> 
> 赞同：12
> 
> 时间：2012-04-04T15:45:00.280
> 
> 标签：jquery-mobile

我有一个 JQM 应用程序，其中包含一个我不想设置样式的特定页面。

到目前为止，我发现的只是`data-role='none'`-但我不想将其应用于页面上的每个元素...如果仅针对这一页关闭，有没有办法关闭？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-04-04T17:58:43.247

您可以`data-enhance="false"`结合使用`$.mobile.ignoreContentEnabled=true`来停止 jQuery Mobile 对伪页面所做的自动增强：

```
<link rel="stylesheet" href="http://code.jquery.com/mobile/1.1.0-rc.1/jquery.mobile-1.1.0-rc.1.min.css" />
<script src="http://code.jquery.com/jquery-1.7.1.min.js"></script>
<script>
$(document).on('mobileinit', function () {
    $.mobile.ignoreContentEnabled = true;
});
</script>
<script src="http://code.jquery.com/mobile/1.1.0-rc.1/jquery.mobile-1.1.0-rc.1.min.js"></script>

<div data-enhance="false" data-role="page">
    ...
</div>​ 
```

您必须更改`ignoreContentEnabled`标志的原因是因为在父元素中搜索 是 CPU 密集型的`data-attribute`，因此默认情况下它是关闭的。

这是一个演示：http: [//jsfiddle.net/ZtJyL/1/](http://jsfiddle.net/ZtJyL/1/)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2014-10-27T14:44:12.430

[正如我在这里](https://stackoverflow.com/questions/15987014/how-to-remove-jquery-mobile-styling)已经指出的那样，您还可以使用专门为允许设计自定义主题而构建的官方、[无主题版本的 CSS 。](http://jquerymobile.com/download/)

以我的经验，使用像结构性的、非主题的 CSS 一样的hack`data-enhance="false"`并且经常破坏事物。`data-role="none"`

使用这种方法，您可以保留所有 jQuery Mobile 基本功能，您不必一直与 hacks 和覆盖作斗争，并且您可以获得更轻的 CSS 作为奖励。

# javascript - 在 Javascript 中调用函数

> ID：10014612
> 
> 赞同：0
> 
> 时间：2012-04-04T15:45:05.667
> 
> 标签：javascript, jquery

我已经声明了一个在 jQuery 中显示对话框的函数

```
<script type="text/javascript">
function showDialog(str,strtitle)
 {
if(!strtitle) strtitle='Error message';
$('#dialog').dialog('destroy');
$('#dialog').show();
$('#dialog').html(str);
$("#dialog").dialog({
    resizable: false,
    width: 400,
    color: '#BF5E04',
      open: function () {
                    $(this).parents(".ui-dialog:first").find(".ui-dialog
                                titlebar").addClass("ui-state-error");},

    buttons: {"Ok": function() { 
    $(this).dialog("close");    }},

    overlay: { opacity: 0.2, background: "cyan" },title:strtitle});}
   </script> 
```

我在另一个javascript代码中调用了这个函数：

```
 <script type="text/javascript">
    var myFile = document.getElementById('myfile');
    //binds to onchange event of the input field
    myFile.addEventListener('change', function() {
    //this.files[0].size gets the size of your file.
     var  size = this.files[0].size;
     document.write(showDialog('size','File Size Exceeds')); 
      });
     </script> 
```

当我执行该函数时，它会写入未定义，为什么没有显示对话框。第一个功能在头部，第二个在身体部分。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-04T15:49:55.163

`document.write()`正在写返回的内容`showDialog()`。由于该函数没有返回任何内容，因此它将写入`Undefined`.

document.write() 不是必需的，只需调用 showDialog()。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-04T15:48:34.970

您没有在 showDialog() 函数中返回任何值。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-04T15:50:31.880

只需摆脱`document.write()`， 没有返回任何内容`showDialog()`，因此出现未定义的错误。

```
<script type="text/javascript">  

  var myFile = document.getElementById('myfile');     
  //binds to onchange event of the input field     
  myFile.addEventListener('change', function() {     
  //this.files[0].size gets the size of your file.      
    var  size = this.files[0].size;      
    showDialog('size','File Size Exceeds');        
  });     

</script> 
```

# netbeans - 使用 glassfish 部署更新的 .ear 项目

> ID：10014614
> 
> 赞同：0
> 
> 时间：2012-04-04T15:45:12.230
> 
> 标签：netbeans, glassfish

我正在使用一个 netbeans EE 项目，该项目创建一个必须使用 glassfish 部署的 .ear 文件，它包含一个 ejb 和一个战争模块。

但是当我在 war 或 ejb 中编辑任何 .java 文件时，然后我单击构建，它不会更改我的 .ear 文件（我可以注意到，因为它仍然具有旧的保存日期）。

应该怎么做才能使更改对正在部署的 .ear 文件生效？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-08T09:30:30.440

答案是，如果您在 WAR 或 EJB 文件夹中构建项目（如果打开项目时单击“打开相关项目”，则会在 netbeans 中打开），它将仅构建该文件夹。

所以应该做的事情真的很简单：

*   单击 netbeans 侧边栏上的主 EE 文件夹 - 名为“项目”的文件夹

*   构建（或清理并构建）

您会注意到编译器将创建 .EAR 文件以部署在 glassfish 中，如果您想创建企业应用程序，也就是正确的文件。

# cakephp - 通过 shell 脚本将我的蛋糕核心从 1.3 升级到 2.1 时，我的核心路径还需要做什么？

> ID：10014616
> 
> 赞同：3
> 
> 时间：2012-04-04T15:45:18.270
> 
> 标签：cakephp

我已经从 1.3 升级到 2.1.1，现在我似乎遇到了路径错误。关于运行升级外壳后需要进行哪些更改，是否有很好的参考指南？

我尝试更新核心路径以查看“lib/Cake”，

```
define('CAKE', CORE_PATH . DS.'lib'.DS. 'Cake' . DS); 
```

但后来我开始收到包含错误。

> > 致命错误：在第 143 行的 C:\inetpub\wwwroot\phpDev\lib\Cake\bootstrap.php 中找不到类“配置”<<

通过 App::uses() 在 bootstrap.php 中添加的核心组件失败（即使 App.php 需要 6 行以上）。

```
require CAKE . 'basics.php';
require CAKE . 'Core' . DS . 'App.php';  // App::uses() should work
require CAKE . 'Error' . DS . 'exceptions.php';

spl_autoload_register(array('App', 'load'));

App::uses('ErrorHandler', 'Error');
App::uses('Configure', 'Core');  //configure is included
App::uses('CakePlugin', 'Core');
App::uses('Cache', 'Cache');
App::uses('Object', 'Core');
App::$bootstrapping = true;

Configure::bootstrap(isset($boot) ? $boot : true); //this fails (line 143) 
```

我在想我遗漏了一些东西，因为一旦我弄清楚核心路径，bootstrap、Configure.php、App.php 和 core.php 引用应该是一个全有或全无的修复。任何见解将不胜感激。

*** 更新 ****

在做了更多研究以查看其他人是否遇到过之后，我希望这是一个缓存问题。已清除持久性缓存文件但未缓存...

经过多次迭代要求 App::uses() 无法提供的文件后，我的 lib/Cake/bootstrap.php 代码如下所示

```
require CAKE . 'basics.php';
require CAKE . 'Core' . DS . 'App.php';
require CAKE . 'Core' . DS . 'Object.php';
require CAKE . 'Error' . DS . 'exceptions.php';
require CAKE . 'Error' . DS . 'ErrorHandler.php';
require CAKE . 'Error' . DS . 'ErrorHandler.php';
require CAKE . 'Core' . DS . 'Configure.php';
require CAKE . 'Core' . DS . 'CakePlugin.php';
require CAKE . 'Cache' . DS . 'Cache.php';
require CAKE . 'Routing' . DS . 'Dispatcher.php';
require CAKE . 'Utility' . DS . 'Debugger.php';
require CAKE . 'Utility' . DS . 'Set.php';
require CAKE . 'Utility' . DS . 'String.php';

spl_autoload_register(array('App', 'load'));

/*App::uses('ErrorHandler', 'Error');
App::uses('Configure', 'Core');
App::uses('CakePlugin', 'Core');
App::uses('Cache', 'Cache');
App::uses('Object', 'Core');*/ 
```

> 警告 (4096)：传递给 Dispatcher::dispatch() 的参数 1 必须是 CakeRequest 的实例，没有给出，在第 84 行的 C:\inetpub\wwwroot\phpDev\app\webroot\index.php 中调用并定义 [CORE \lib\Cake\Routing\Dispatcher.php，第 69 行]
> 
> 警告 (4096)：传递给 Dispatcher::dispatch() 的参数 2 必须是 CakeResponse 的实例，没有给出，在第 84 行的 C:\inetpub\wwwroot\phpDev\app\webroot\index.php 中调用并定义 [CORE \lib\Cake\Routing\Dispatcher.php，第 69 行]
> 
> 注意（8）：未定义变量：request [CORE\lib\Cake\Routing\Dispatcher.php，第 70 行]
> 
> 注意（8）：试图获取非对象的属性 [CORE\lib\Cake\Routing\Dispatcher.php，第 70 行]
> 
> 注意 (8)：未定义变量：响应 [CORE\lib\Cake\Routing\Dispatcher.php，第 70 行]
> 
> 警告 (4096)：传递给 Dispatcher::asset() 的参数 2 必须是 CakeResponse 的实例，给定 null，在第 70 行的 C:\inetpub\wwwroot\phpDev\lib\Cake\Routing\Dispatcher.php 中调用并定义[CORE\lib\Cake\Routing\Dispatcher.php，第 236 行]
> 
> 注意（8）：未定义变量：request [CORE\lib\Cake\Routing\Dispatcher.php，第 70 行]
> 
> 致命错误：在第 70 行的 C:\inetpub\wwwroot\phpDev\lib\Cake\Routing\Dispatcher.php 中的非对象上调用成员函数 here()

所以我什至没有得到蛋糕请求对象？App::uses() 被破坏也没有任何意义，因为我看到它实际包含在哪里，并且该方法的代码在那里。

我在想我忽略了一些东西。我对核心不是很熟悉，因为到目前为止我只是一个即插即用的开发人员。1.3 就像一个魅力，但我想在添加更多开发之前升级。我感谢所有建议。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-01-31T10:44:44.027

(Answered in a question edit. Converted to a community wiki answer. See [Question with no answers, but issue solved in the comments (or extended in chat)](https://meta.stackoverflow.com/questions/251597/question-with-no-answers-but-issue-solved-in-the-comments) )

The OP wrote:

> The upgrade shell did not replace index.php in the app/webroot folder... I knew that the upgrade shell didn't come close to converting the code over to 2.0, but replacing *that* file was in line with what it actually did. I was surprised to find my old index file, and replacing *it* was what I needed to get the new framework operational (to the point where cake was at least generating it's own errors!) Thanks for the suggestions and comments.
> 
> As a side note, the upgrade shell was successful in renaming the files to match the new naming conventions, but didn't upgrade much of anything else outside of the framework folder.

# android - ZXing 使用 IntentIntegrator 启动 BarcodeScanner 纵向布局

> ID：10014617
> 
> 赞同：3
> 
> 时间：2012-04-04T15:45:20.297
> 
> 标签：android, google-play, zxing

我想以纵向布局启动 BarcodeScanner（因为我的整个应用程序都是纵向布局）。我还想知道，是否可以从 Google Play 一次安装两个应用程序（您在清单文件中添加某种依赖项到 Barcode Scanner - 我在我的应用程序中使用它 - 并且 Google Play 会自动在我的应用程序旁边安装 Barcode Scanner） .

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-01T01:20:41.307

如果您需要在纵向模式下扫描条码，我建议您将 ZXing 库合并到您的应用程序中并进行适当的更改，以使其在纵向模式下工作。

在此处获取源代码：[zxing](http://code.google.com/p/zxing/)

您正在库中查找 Android 示例代码以及 core.jar 文件以进行条码扫描。

有关如何让它在肖像中工作的说明，请按照以下步骤操作：[Issue 178 - zxing - Running ZXing in Portrait](http://code.google.com/p/zxing/issues/detail?id=178#c46)

我强烈建议阅读该线程以获取有关更改的背景信息，但这里是它的基础知识：

> 1.  为了使屏幕纵向工作，为活动设置纵向方向（例如在清单中），然后配置相机：使用 CameraConfigurationManager.setDesiredCameraParameters(Camera camera) 中的 camera.setDisplayOrientation(90)。但请注意：
>     
>     
>     *   setDisplayOrientation(int) 需要 Android 2.2
>     *   setDisplayOrientation(int) 不影响 PreviewCallback.onPreviewFrame 中传递的字节数组的顺序。（有关更多信息，请参阅 JavaDoc）
> 2.  因为预览帧总是在“横向”，我们需要旋转它们。我使用注释#c11 提供的顺时针旋转。不要忘记在旋转后交换宽度和高度参数。DecodeHandler.java，在 decode(byte[] data, int width, int height) 中 buildLuminanceSource 之前旋转数据
>     
>     
>     
>     ```
>     rotatedData = new byte[data.length];
>     for (int y = 0; y < height; y++) {
>         for (int x = 0; x < width; x++)
>             rotatedData[x * height + height - y - 1] = data[x + y * width];
>     }
>     int tmp = width; // Here we are swapping, that's the difference to #11
>     width = height;
>     height = tmp; 
>     ```
>     
>     
> 3.  我还按照#c11 的建议修改了 CameraManager.java、getFramingRectInPreview()：
>     
>     
>     
>     ```
>     rect.left = rect.left * cameraResolution.y / screenResolution.x;
>     rect.right = rect.right * cameraResolution.y / screenResolution.x;
>     rect.top = rect.top * cameraResolution.x / screenResolution.y;
>     rect.bottom = rect.bottom * cameraResolution.x / screenResolution.y; 
>     ```

zxing 库很容易适应您的应用程序，使其成为更流畅和集成的用户体验。强烈推荐。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T07:25:52.463

嗨，请按照以下步骤解决我尝试过的 Zxing 条码扫描仪中的肖像问题，它工作正常......

有4个相关文件：

```
1, manifest.xml, you need to make CaptureActivity portrait. 
```

2、DecodeHandler.java，在buildLuminanceSource之前旋转数据，因为在YCbCr_420_SP和YCbCr_422_SP中，Y通道是平面的，首先出现

```
byte[] rotatedData = new byte[data.length];
for (int y = 0; y < height; y++) {
    for (int x = 0; x < width; x++)
        rotatedData[x * height + height - y - 1] = data[x + y * width];
 } 
```

## 3、CameraManager.java、getFramingRectInPreview()需要修改。

```
rect.left = rect.left * cameraResolution.y / screenResolution.x;
rect.right = rect.right * cameraResolution.y / screenResolution.x;
rect.top = rect.top * cameraResolution.x / screenResolution.y;
rect.bottom = rect.bottom * cameraResolution.x / screenResolution.y; 
```

4、CameraConfigurationManager.java，在setDesiredCameraParameters()使用中设置相机方向为纵向

```
parameters.set("orientation", "portrait"); 
```

在 getCameraResolution() 中，您需要交换 x 和 y，因为相机预览尺寸类似于 480*320，而不是 320*480。

```
int tmp = cameraResolution.x;
cameraResolution.x = cameraResolution.y;
cameraResolution.y = tmp;
return cameraResolution; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-04T22:14:11.730

条码扫描仪不支持纵向布局，因此您将无法执行此操作。（[Barcode Scanner+](https://play.google.com/store/apps/details?id=com.srowen.bs.android)可以，但你不能依赖它的安装。）没有办法强制从 Market 安装另一个应用程序，不。

# java - 抄写员 - 当申请已经被接受时不要请求许可

> ID：10014618
> 
> 赞同：0
> 
> 时间：2012-04-04T15:45:30.580
> 
> 标签：java, oauth, scribe

我正在使用 Scribe 登录 google 和 Twitter。它工作得很好，但如果他已经接受了它，我希望允许应用程序直接连接而无需用户干预。

Scribe 可以吗？如果是，我该怎么做？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-05T01:25:21.640

是的。您可以将`access_token`and保存在`access_token_secret`任何地方（数据库、键值存储、会话等）并使用它们直到它们过期（它们对于大多数提供者来说是长期存在的）。

### 编辑（回答评论）

我猜您有一种识别用户的方法，假设这被称为`user_id`，我会将其存储在**持久性**介质（不是会话）中，如下所示：

`user_id`

`access_token`

`access_token_secret`

然后，从介质中获取令牌和秘密，并使用以下命令重新创建令牌：

`new Token(access_token, access_token_secret);`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-04T16:15:27.863

是的。使用 twitter 的授权 url 的以下值：

```
Scribe scribe = new ServiceBuilder()
                .provider(org.scribe.builder.api.TwitterApi.class)
                .apiKey(...)
                .apiSecret(...)
                .callback(...);
Token requestToken = scribe.getRequestToken();
String authorizationUrl = "https://twitter.com/oauth/authenticate?oauth_token="
      + requestToken.getToken();
// and redirect user to the authorization URL
// twitter will redirect it back to the callback URL if 
// the user has already been authorized your app. 
```

# node.js - 什么会导致 Expressjs 中出现此错误？

> ID：10014623
> 
> 赞同：0
> 
> 时间：2012-04-04T15:45:41.123
> 
> 标签：node.js, mongodb, express

我正在使用 expressjs 和 mongoskin 连接到数据库，并且在我的 mongskin 调用中引发 expressjs 错误时遇到问题。我无法追踪问题，因为错误太笼统了。

我的代码：

```
db.collection('users').find(data, {limit:1}).toArray(function(err, result) {
    if(result) throw new noData('No results found');        
}); 
```

错误：

```
node.js:201
        throw e; // process.nextTick error, or 'error' event on first tick
              ^
Error
    at /home/jmoney/workspace/blog/app.js:238:15
    at /home/jmoney/workspace/blog/node_modules/mongoskin/node_modules/mongodb/lib/mongodb/cursor.js:129:9
    at /home/jmoney/workspace/blog/node_modules/mongoskin/node_modules/mongodb/lib/mongodb/cursor.js:171:11
    at /home/jmoney/workspace/blog/node_modules/mongoskin/node_modules/mongodb/lib/mongodb/cursor.js:452:35
    at Cursor.close (/home/jmoney/workspace/blog/node_modules/mongoskin/node_modules/mongodb/lib/mongodb/cursor.js:660:5)
    at Cursor.nextObject (/home/jmoney/workspace/blog/node_modules/mongoskin/node_modules/mongodb/lib/mongodb/cursor.js:452:17)
    at [object Object].<anonymous> (/home/jmoney/workspace/blog/node_modules/mongoskin/node_modules/mongodb/lib/mongodb/cursor.js:440:12)
    at [object Object].g (events.js:156:14)
    at [object Object].emit (events.js:88:20)
    at Db._callHandler (/home/jmoney/workspace/blog/node_modules/mongoskin/node_modules/mongodb/lib/mongodb/db.js:1274:25) 
```

关于为什么这可能会破坏的任何想法？或者如何获得更深入的错误报告？多谢你们！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-18T19:33:39.120

除非您知道自己在做什么，否则永远不要抛出 node.js 函数调用。没有“堆栈”可以展开，因为它发生在 toArray 中。这导致异常成为未处理的异常。

唯一的方法是使用

[http://nodejs.org/api/process.html#process_event_uncaughtexception](http://nodejs.org/api/process.html#process_event_uncaughtexception)

将其记录到您的日志文件或使用 console.log()/dir() 或类似的东西。

# javascript - 如何检测 Javascript 中的 Google+“共享任务完成”并关闭 Chrome 书签？

> ID：10014626
> 
> 赞同：0
> 
> 时间：2012-04-04T15:45:46.867
> 
> 标签：javascript, google-chrome, dom-events, bookmarklet

我正在使用一个书签，它可以让我在 Google Plus 上共享当前 URL。

这是JavaScript：

```
javascript:(function(){var w=480;var h=380;var x=Number((window.screen.width-w)/2);
var y=Number((window.screen.height-h)/2);
window.open('https://plusone.google.com/_/+1/confirm?hl=en&url='+encodeURIComponent(location.href)+'&title='+encodeURIComponent(document.title),'','width='+w+',height='+h+',left='+x+',top='+y+',scrollbars=no');})(); 
```

有没有办法检测“共享成功”事件并调用`window.close()`？我在这个 JS 中如何称呼它？即使是这个方向的指针也会受到赞赏。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-04T16:15:08.450

> 有没有办法检测“共享成功”事件并调用 window.close()？

不，你不能。

浏览器安全性阻止您在一个页面上使用 Javascript 与不同域上的另一个页面进行交互。这就是为什么我不能建立一个在 iframe 中打开你银行网站然后控制它的网站。

小书签中的 Javascript 被视为您执行时打开的页面的一部分。因此，代码成为您添加到 Google Plus 的页面的一部分，并且它无法与来自 Google 的页面交互，因为它位于不同的域中；反之亦然。代码可以打开窗口，仅此而已。

要执行您想要的操作，需要创建附加组件、扩展程序或用户脚本。

# mysql - 在这个查询的帮助下，我想要一些空结果

> ID：10014627
> 
> 赞同：2
> 
> 时间：2012-04-04T15:45:48.097
> 
> 标签：mysql, case

询问

```
SELECT
  CASE
  WHEN `tomato_rating` = 0 THEN 'NULL'
  WHEN `tomato_rating` != 0 THEN `tomato_rating`
  END `tomato_rating`,
  ur.`user_rating`, 
  ABS(tomato_rating - ur.`user_rating`) AS avg_guess_error  
FROM user_rating ur
  LEFT JOIN videos v
    ON ur.vid_id = v.id
WHERE ur.user_id = '1' 
```

查看结果截图进行验证

![在此处输入图像描述](../Images/88613d063f285d04491a2d522f838474.png)

结果必填

```
NULL - 50 NULL
50   - 30 20
65   - 33 32
NULL - 16 NULL 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-04T15:50:13.840

如果我理解你的问题，你想返回`NULL`if `tomato_rating = 0`。

为此，您可以使用以下[`NULLIF`](http://dev.mysql.com/doc/refman/5.0/en/control-flow-functions.html#function_nullif)功能：

```
SELECT
  NULLIF(`tomato_rating`, 0) AS `tomato_rating`,
  ur.`user_rating`, 
  ABS(NULLIF(`tomato_rating`, 0) - ur.`user_rating`) AS avg_guess_error  
FROM user_rating ur
  LEFT JOIN videos v
    ON ur.vid_id = v.id
WHERE ur.user_id = '1' 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-04T15:50:56.883

I think this is what you're looking for:

```
SELECT
  IF (`tomato_rating` = 0, 'NULL', `tomato_rating`) as `tomato_rating`,
  ur.`user_rating`,
  IF (`tomato_rating` = 0, 'NULL', ABS(tomato_rating - ur.`user_rating`))
    as avg_guess_error  
FROM user_rating ur
LEFT JOIN videos v ON ur.vid_id = v.id
WHERE ur.user_id = '1' 
```

Notice that you're using string `'NULL'` instead of `NULL`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-04T15:50:14.630

这是你要找的吗？

```
SELECT
CASE
WHEN `tomato_rating` = 0 THEN 'NULL'
WHEN `tomato_rating` != 0 THEN `tomato_rating`
END `tomato_rating`,
ur.`user_rating`, 
CASE
WHEN `tomato_rating` = 0 THEN 'NULL'
WHEN `tomato_rating` != 0 THEN ABS(tomato_rating - ur.`user_rating`) 
END `avg_guess_error`,  
FROM user_rating ur
LEFT JOIN videos v
ON ur.vid_id = v.id
WHERE ur.user_id = '1' 
```

# c++ - 求矩阵的平均值

> ID：10014629
> 
> 赞同：0
> 
> 时间：2012-04-04T15:45:55.913
> 
> 标签：c++, image-processing, opencv, matrix, average

我试图找到矩阵的平均值。我创建了一个 4800 x 5 矩阵，现在想通过查找矩阵中每一行的平均值将其变成一个 4800 x 1 矩阵。我知道这意味着我将每行中的所有元素相加并除以 5。我正在考虑函数 cvAvg 但到目前为止，我找不到它的使用示例。下面是我的代码，其中我将 5 个图像转换为 4800 x 1 的矩阵并将它们组合起来以创建 4800 x 5 的超矩阵。下一步是找到超矩阵的平均值。请，如果有人可以帮助我，我将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-04T16:37:11.753

除非我不理解某些事情，否则您不能这样做：

```
CvMat* avgMat = cvCreateMat(4800, 1, CV_8UC1);

for(int i = 0; i < 4800; ++i)
{
    CV_MAT_ELEM( *avgMat , float, i, 0 ) = ( CV_MAT_ELEM( *col0, float, i, 0 ) + 
                                             CV_MAT_ELEM( *col1, float, i, 0 ) + 
                                             CV_MAT_ELEM( *col2, float, i, 0 ) + 
                                             CV_MAT_ELEM( *col3, float, i, 0 ) +
                                             CV_MAT_ELEM( *col4, float, i, 0 )
                                            ) / 5;
} 
```

如果您使用 cvAvg() ，则需要为每个平均元素设置一个自定义掩码，这似乎是做同样事情的一种非常全面的方式。

# java - 计算移动圆中的每个笛卡尔点

> ID：10014631
> 
> 赞同：-1
> 
> 时间：2012-04-04T15:46:01.143
> 
> 标签：java, algorithm, multidimensional-array, geometry

我有一个数组： int[][] 草坪 = new int[980][1280]; 它将刀片高度的值存储在虚拟“草坪”中。

在我的模拟中，我有一个机器人绕着草坪走并切割刀片。

我的机器人具有直径 (rDiameter) 的圆形形状。坐标系是用 Double 完成的，我的草坪是 Integer。

我必须开发一种算法，将机器人四处移动时接触到的所有单元格设为 0。

我有运动的起点和终点，它们以 Line2D.Double 形式存储，我想将机器人接触的所有单元格设置为 0（图像）。有任何想法吗？

[（这是我上一个关于圆中每个笛卡尔点](https://stackoverflow.com/questions/9863310/calculating-every-cartesian-point-in-a-circle)的相同论点的问题

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-04T16:19:26.970

将问题分解为 3 个部分。第 1 部分是将半圆中的所有点设置为 0。第 2 部分是将矩形中的所有点设置为 0。第 3 部分是将路径分成两个半圆（在末端）和一个矩形（连接它们）。

请注意，半圆和矩形通常具有不轴对齐的线。有很多关于光栅化多边形和圆的参考资料。你可以查看 Jack Bresenham 的算法。或者您可以翻开任何经典的计算机图形文本。

# ruby-on-rails - Rails 路线不工作 - 不知道为什么

> ID：10014636
> 
> 赞同：0
> 
> 时间：2012-04-04T15:46:20.857
> 
> 标签：ruby-on-rails, rails-routing

遇到路由问题，应该很简单，但看起来很简单，只是不起作用：

```
match '/api/get-locations-by-distance/:latitude/:longitude' => 'api#get_locations_by_distance' 
```

用这个电话：

```
http://localhost:3000/api/get-locations-by-distance/34.035645/-118.233434 
```

谢谢你的任何想法

**编辑 #1**
如果我将其更新为以下内容：

```
match '/api/get-locations-by-distance/:latitude/:longitude/:stub' => 'api#get_locations_by_distance' 
```

和

```
http://localhost:3000/api/get-locations-by-distance/34.035645/-118.233434/stub 
```

它仍然不起作用。

**编辑#2**
我尝试添加 :format => false 但这似乎也无济于事。

匹配 '/api/get-locations-by-distance/:latitude/:longitude' => 'api#get_locations_by_distance', :format => false

和

```
http://localhost:3000/api/get-locations-by-distance/34.035645/-118.233434 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-04T15:50:18.163

它认为这`.233434`是格式

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-04T17:04:21.503

就像 Mik_Die 说的 - . 是 Rails 中格式的分隔符。

这是一种解决方法：您可以指定自己的分段约束。

```
match '/api/get-locations-by-distance/:latitude/:longitude' => 'api#get_locations_by_distance' , 
       :constraints => { :latitude => /\d+\.\d+/ , :longitude  => /\d+\.\d+/ } 
```

也可以看看：

[http://x3ro.de/rails-3-routing-parameters-dots/](http://x3ro.de/rails-3-routing-parameters-dots/)

# java - 换一张图片一秒

> ID：10014637
> 
> 赞同：0
> 
> 时间：2012-04-04T15:46:24.307
> 
> 标签：java, android

```
 ImageView image = (ImageView) findViewById(R.id.imageview);

     image.setImageResource(drawable.image1);
     SystemClock.sleep(1000);
     image.setImageResource(drawable.image2); 
```

我正在尝试更改图像一秒钟，我上面的代码不起作用但不知道为什么？我应该使用线程吗？或者有没有人有更好的想法？

编辑为了澄清这个问题：

显示为“drawable.image2”的图像我希望“drawable.image1”显示一秒钟，然后更改为“drawable.image2”。

编辑2：

此代码在 onClick 中使用。当用户单击图像时，它需要更改一秒钟

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-04T15:53:02.160

I'd recommend using a `TimerTask` with a `Timer`. You can set it up like this:

```
protected void showDelayedImages() {

    mImageView.setImageResource(resId1);

    Timer timer = new Timer();
    timer.schedule( new MyTimerTask(), 1000 );
}

private class MyTimerTask extends TimerTask {
    @Override
    public void run() {

        runOnUiThread( new Runnable() {

            @Override
            public void run() {

                mImageView.setImageResource(resId2);
            }
        } ); 
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-04T15:51:16.923

It looks like you're performing the "switch" in an onCreate() method, the `sleep` will probably just make your Activity load slower since at this stage there isn't actually anything written to the page.

To have your image change you need to perform the switch on the UI thread and you need to perform it after the image has been inflated and added to the page.

Try adding this code in an "onClick" event.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-04T15:48:47.950

```
Thread.sleep(1000); 
```

应该这样做。虽然也有更好的方法。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-04T15:49:22.757

使用调试模式并在每次调用时设置断点`setImageResource`。逐步检查是否每个都被调用以查看您的图像是否正确更改。

在实际情况下，您可能希望根据某些用户操作更改图像，或者例如在线程处理时更改图标，然后在完成时更改它。对于此示例，请查看`AsyncTask`.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-04T15:49:48.360

使用`R.drawable.image1`而不是`drawable.image1`

# database - NLP 处理应该在什么时候进行？

> ID：10014641
> 
> 赞同：0
> 
> 时间：2012-04-04T15:46:34.293
> 
> 标签：database, statistics, nlp, artificial-intelligence

在一个完美的世界里，我可以随时获得大量数据，而无需花费任何时间来请求和接收它。但是在实际应用程序的上下文中，例如 google 或 facebook，您将大量数据存储在需要时间查询的数据库中，然后您尝试处理这些数据以得出有意义的结论/关系。

在 sql 中对大量数据进行计数和排序的上下文中，您会将数据存储在汇总表中以避免处理......并且只需使用 cron 更新这些表。但是统计分析和nlp似乎有所不同。

问题是，实际统计/nlp/etc 分析应该在数据生命周期的哪个时间点发生？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-04T18:15:33.037

您通常这样做的方式是收集数据，将其放入某种数据库（SQL 或 NoSQL），然后在处理大量数据时将其转储到 hadoop 网格中；否则做你通常做的任何事情。然后你有工作分析这些数据并将结果反馈给你。

获取数据 -> 存储 -> 转储 -> 分析 -> 使用离线分析结果

在实际数据库上处理数据并不能很好地工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-04T16:50:37.910

当你说 NLP 时，这取决于你的想法。当几十条推文/状态更新存储在某个地方时，您就可以开始阅读和分析它们了。在 NLP 发生时重复查询您唯一的生产服务器可能不是一个好主意——您可能希望转储所有数据并从那里工作。

# c - 寻求对 Visual Studio C 运行时库链接行为的更深入了解

> ID：10014653
> 
> 赞同：2
> 
> 时间：2012-04-04T15:46:57.533
> 
> 标签：c, visual-studio, static-linking, msvcrt

这是我只是盲目地接受并遵循“它的方式”的东西。我试图更深入地了解其背后的“原因”。

*   静态库 LibA - 使用一些 C 运行时调用
*   静态库 LibB - 利用一些 C 运行时调用
*   可执行应用程序 - 利用 LibA、LibB 和一些 C 运行时调用

[这里](http://msdn.microsoft.com/en-us/library/2kzt1wy3%28v=vs.100%29.aspx)有很好的记录，还有很多其他地方，所有传递给链接器的给定调用的模块都必须使用相同的运行时库编译器选项进行编译。

如果所有符号解析都是在[此处](https://stackoverflow.com/a/9624535/781509)和[此处](https://stackoverflow.com/a/7842014/781509)讨论的 App 的最终链接期间执行的，为什么会出现这种情况？为什么 LibA 和 LibB 在构建时甚至需要指定要使用的特定运行时库？他们使用的 C 运行时调用不应该只解决 App 为其链接指定的任何运行时调用吗？

这是其他 C 开发环境中的问题还是 Visual Studio 特有的问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-12T01:24:22.153

正如 Hans Passant 在他的评论中提到的，有一些全局状态项必须在 DLL 运行时和静态链接运行时之间进行更改。比他的示例更糟糕的是，类型的大小根据创建它的运行时而改变。但是，还有几个原因：

**调试与发布：**
调试运行时将在动态分配的内存周围放置保护字节。这允许他们的内存分配和释放代码进行额外检查，以帮助您发现内存问题，例如双重释放和在分配的缓冲区之外写入。发布运行时不使用额外的检查来支持优化。因此，如果内存分配给一个并释放另一个，您可能会得到不可预知的结果。

**DLL 与静态链接：**
在 Windows 中，经验法则是您必须在分配它的同一模块中释放内存。换句话说，如果您在 msvcrt.dll 中分配了内存，您还必须在那里释放它。因此，如果应用程序的某些部分链接到静态运行时，而某些部分链接到运行时 DLL，则可能违反此规则。发生这种情况时，您还会得到不可预测的结果，包括异常。

**多线程与单线程：**
这两种运行时类型之间潜在的冲突应该是显而易见的。单线程版本不是线程安全的，因此将它与期望线程安全的东西混合起来会在以后进行有趣的调试。这种区别主要只存在于较旧的 MS 编译器中，因为在较新的版本中唯一的选择是多线程的。

另请参阅此类似问题：[混合从不同版本的 Visual Studio 2002 和更高版本构建的 C 代码的静态库](https://stackoverflow.com/questions/462768/mixing-static-libraries-of-c-code-built-from-different-versions-of-visual-studio)

# objective-c - FB请求输出在iOS中不起作用

> ID：10014654
> 
> 赞同：0
> 
> 时间：2012-04-04T15:47:03.430
> 
> 标签：objective-c, ios, facebook-graph-api

我的 FB 请求输出在 iOS 中不起作用。它向控制台输出两次。它第一次输出正确的信息，然后立即用 (null) 而不是正确的数据做同样的事情。

这是我的代码：

```
- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions 
```

{

```
facebook = [[Facebook alloc] initWithAppId:@"fbKEY....." andDelegate:self];

NSUserDefaults *defaults = [NSUserDefaults standardUserDefaults];
if ([defaults objectForKey:@"FBAccessTokenKey"] 
    && [defaults objectForKey:@"FBExpirationDateKey"]) {
    facebook.accessToken = [defaults objectForKey:@"FBAccessTokenKey"];
    facebook.expirationDate = [defaults objectForKey:@"FBExpirationDateKey"];
}

//FB check for valid session

if (![facebook isSessionValid]) {
    NSArray *permissions = [[NSArray alloc] initWithObjects:
                            @"user_likes", 
                            @"read_stream",
                            @"user_location",
                            @"user_checkins",
                            //    @"publish_actions",
                            //    @"user_activities",
                            //    @"friends_birthday",
                            nil];

    [facebook authorize:permissions];

}

[facebook requestWithGraphPath:@"me" andDelegate:self];

// get the posts made by the "platform" page
[facebook requestWithGraphPath:@"platform/posts" andDelegate:self];

// get the logged-in user's friends
[facebook requestWithGraphPath:@"me/friends" andDelegate:self];

[facebook dialog:@"feed" andDelegate:self];

// Override point for customization after application launch.
return YES; 
```

}

```
- (void)request:(FBRequest *)request didLoad:(id)result { 

NSDictionary *userData = (NSDictionary *)result; // The result is a dictionary

NSString *name = [userData objectForKey:@"name"];
NSString *location = [[userData objectForKey:@"location"] objectForKey:@"name"];
NSString *gender = [userData objectForKey:@"gender"];

NSLog(@"name is %@", name);
NSLog(@"location is %@", location);

NSLog(@"gender is %@", gender);

// NSLog(@"%@",result); 

} 
```

这是我的 NSLog 输出：

```
2012-04-04 16:42:56.440 Whatto[86350:15803] name is John Doe
2012-04-04 16:42:56.441 appName[86350:15803] location is London
2012-04-04 16:42:56.441 appName[86350:15803] gender is male
2012-04-04 16:42:56.688 appName[86350:15803] name is (null)
2012-04-04 16:42:56.688 appName[86350:15803] location is (null)
2012-04-04 16:42:56.689 appName[86350:15803] gender is (null)
2012-04-04 16:42:58.696 appName[86350:15803] name is (null)
2012-04-04 16:42:58.697 appName[86350:15803] location is (null)
2012-04-04 16:42:58.697 appName[86350:15803] gender is (null) 
```

谢谢你的帮助

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-04T16:02:52.067

您正在提出 3 个不同的请求并将结果视为每个答案都是用户...第二个结果将是帖子列表，第三个结果将是朋友列表。

祝你好运！

# asp.net-mvc - 如何在两个视图模型之间建立验证依赖关系？

> ID：10014655
> 
> 赞同：1
> 
> 时间：2012-04-04T15:47:04.647
> 
> 标签：asp.net-mvc, validation, data-annotations

我向上帝发誓，我在一篇 MSDN 文章中看到过类似（下）的内容，但我在任何地方都找不到此属性文档。

```
public class MyViewModel{
   [Required]
  public bool Important {get;set;}

 [ValidationDependsOn("Important")]
  public bool HasVIPAccess {get;set;}

} 
```

如果您查看上面的代码（可能是一个不好的示例），我正在尝试以这样一种方式建立两个属性之间的关系，即 HasVIPAccess 属性的验证取决于名为 Import 的属性的验证。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-04T16:18:07.313

执行类似操作的内置验证属性`[Compare("OtherProperty")]`意味着您放置此属性的属性必须等于`OtherProperty`

前任

```
public class MyViewModel{
   [Required]
  public bool Important {get;set;}

 [Compare("Important")]
  public bool HasVIPAccess {get;set;}

} 
```

**注意：需要 MVC 3+**

如果你想要其他验证属性，你可以检查[Mvc.ValidationTookit](http://blogs.msdn.com/b/simonince/archive/2011/09/29/mvc-validationtookit-alpha-release-conditional-validation-with-mvc-3.aspx)

* * *

如果你想了解它背后的科学

这是 mvc3 的新功能，您可以在 mvc3 中轻松实现这样的自定义属性

因为 IsValid 现在接收一个 ValidationContext 参数，该参数包含有关正在执行的验证的信息，例如模型的类型和与之关联的元数据，因此您可以使用反射来获取其他属性及其值，CompareAttribute 使用了此功能

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-04T19:28:08.613

[FluentValidation.NET](http://fluentvalidation.codeplex.com/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-04T19:26:34.330

您可以通过编写自定义验证属性来做到这一点（这仅启用服务器端验证）......这是一个相关的帖子[在 MVC 中创建新的数据注释验证属性](http://www.howmvcworks.net/OnModelsAndViewModels/CreatingDataAnnotationValidationAttributes)

但是...如果您想让客户端不显眼的验证也能正常工作，那么您需要做一些 javascript 工作...这是另一篇关于创建不显眼的客户端验证的帖子...[使用 MVC 3进行不显眼的客户端验证](http://duncanmcintyre.net/programming/mvc3-razor-unobtrusive-jquery)

# windows - ImpersonateLoggedOnUser 在同一台机器上的共享文件夹上失败

> ID：10014656
> 
> 赞同：1
> 
> 时间：2012-04-04T15:47:11.560
> 
> 标签：windows, security, winapi

我正在使用 ImpersonateLoggedOnUser 从我的应用程序访问共享文件夹。当共享文件夹在另一台机器上时，一切都按预期工作。当*\\MyComputer\myshare*中的计算机与我运行应用程序的计算机相同时，访问失败。当路径为*d:\myshare*时，一切正常，因此这里没有权限问题。还有什么可以做的？

# class - 如何重写magento core-cache-model (Mage_Core_Model_Cache)

> ID：10014657
> 
> 赞同：4
> 
> 时间：2012-04-04T15:47:15.350
> 
> 标签：class, caching, magento, rewrite, core

我必须重写核心缓存模型。这是行不通的。我第一次尝试解决这个问题是尝试用另一个模型重写......在我的 config.xml 中，我声明了以下内容

```
<global>         
  <models>          
    <core>
      <rewrite>
        <**layout**>MyCompany_MyModule_Model_Core_Cache</**layout**>
      </rewrite>
    </core>
  </models>
  .... 
```

在我的课堂上，我死于构造函数。

这完美！所以我重写模型的可能性是正确的。

但是，如果我不使用 xml 中的布局节点而是使用缓存节点，这将不起作用。

所以我的尝试如下，这是行不通的：

```
<global>         
  <models>          
    <core>
      <rewrite>
        <cache>MyCompany_MyModule_Model_Core_Cache</cache>
      </rewrite>
    </core>
  </models>
  .... 
```

我现在的问题：有没有办法重写/重载“缓存核心模型”？？？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-05T09:55:35.130

缓存将在加载模块配置 (config.xml) 之前初始化。缓存模型使用 Mage::getModel 实例化，它将模型名称缓存在注册表中。因此，以后所有尝试获取自定义缓存模型也将失败。

解决方法：把这个rewrite语句放在etc/local.xml中。这有点脏，因为 local.xml 应该只包含与模块无关的东西。但这比将核心文件复制到本地要好。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-11-12T21:21:31.573

我有同样的问题，但我的解决方案与你的有点不同;-)

Magento 会先从 /app/etc/*.xml 加载 XML 文件（这些文件不会被缓存），然后再加载 magento 中的所有其他内容。所以我在这里创建了自己的文件“cache.xml”，内容是

```
<?xml version="1.0"?>
<config>
    <global>
        <models>          
            <core>
                <rewrite>
                    <cache>MyCompany_MyModule_Model_Core_Cache</cache>
                </rewrite>
            </core>
        </models>
    </global>
</config> 
```

在 1.6、1.7 和 1.8 中完美运行

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-10T00:46:39.907

我也在尝试做同样的事情，我认为这是不可能的。如果你在方法中 var_dump 输出 $this->_xml->group->models: getGroupedClassName (app/code/core/Mage/Core/Model/Config.php) 你会注意到你的重写它还不可用，因此为什么它被跳过。

如果您尝试覆盖 translate 或 layout: your_class_model 您会注意到 $this->_xml... 转储了初始核心类（没有重写）并且您会看到您的重写远远超过了核心/缓存. 因此，它可能已被覆盖，但该类已被实例化、设置和使用；所以它真的不会触发任何东西。

因此，我认为不可能覆盖核心/缓存。您必须将其移动到应用程序/代码/本地。可怜。

# mysql - 您将如何创建服装尺寸数据库结构？

> ID：10014663
> 
> 赞同：1
> 
> 时间：2012-04-04T15:47:34.933
> 
> 标签：mysql, sql, database-design, data-modeling

我需要在电子商务网站上设计服装尺寸的结构。
我们正在使用 mysql

现在，我们有这样的东西：

```
product(product_id, name, size_id)  
(12, 'formal shoes', 2)  
(224, 'pants', 16)  

size(size_id, gender, category_id)  
(2, 'm', 5)  
(16, 'm', 8)  
(17, 'm', 8)  
(18, 'm', 8)  

category(category_id, category_name)  
(5, 'shoes'),  
(8, 'pants')

size_chart(size_id, country_code, value)  
(2, 'US', '7')  
(2, 'UK', '5')  
(16, 'US', '33w34l')  
(17, 'US', '33w32l')  
(18, 'US', '33')  
(16, 'EU', '48')  
(17, 'EU', '48')  
(18, 'EU', '48') 
```

现在，如您所见，问题在于 EU 48 有 3 个美国等价物（它们在美国有所不同），因此根据欧盟输入大小进行排序/过滤会很麻烦。
我注意到许多在线商店都犯了这个错误，他们要么将转换留给用户，要么简单地列出每个国际尺寸以供搜索/过滤器使用。

因此，例如，如果用户搜索 US 33w34l 裤子，我想向他展示 size_id 为 16,17 或 18 的裤子。

您将如何构建所有内容？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-04T15:53:35.923

我会给一个物理尺寸一个 id，然后有一个与实际物理尺寸相匹配的尺寸和国家/地区列表.. 所以

（随机数据与现实毫无相似之处）

```
SizeID 1 = 
country US  size = 33w 41l
country UK size 16
country uk size 18

SizeID 2 = 
country US size = 34w 41l
country UK size 18
country EU size 14 
```

然后他们在哪个国家，他们选择他们的大小，然后你可以搜索具有该 sizeID 的所有项目。

# ios - 如何限制我的应用程序仅适用于 iPhone，不包括 iPod touch？

> ID：10014664
> 
> 赞同：9
> 
> 时间：2012-04-04T15:47:36.650
> 
> 标签：ios, xcode, itunes, device

如何限制我的应用程序仅适用于 iPhone，不包括 iPod touch？

我不希望我的应用程序在 iPod Touch 上可用，info.plist 中是否有一个属性可以用来指定这个，或者这是我在 itunesconnect 设置过程中会遇到的？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-04-04T15:50:23.793

您可以将**gps**添加为所需的设备功能，以排除没有 GPS 硬件的设备，这将排除 iPod touch。

**编辑：**实际上，执行此操作的正确方法是为**UIRequiredDeviceCapabilities**条目（字典）包含值为**YES的****电话**键，这意味着只有支持电话的设备才能使用该应用程序。

 **此外，请查看哪些键可用于**UIRequiredDeviceCapabilities**[的完整参考](https://developer.apple.com/library/ios/#documentation/General/Reference/InfoPlistKeyReference/Articles/iPhoneOSKeys.html)。

 *** * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-04-04T15:53:35.567

上述解决方案不是 Apple 建议的方式，应该在他们的网站上完成。我目前知道有两种方法。

在最新版本的 Xcode 中创建项目时，它允许您选择设备系列。不要选择universal或ipod。只需选择 iPhone。

另一种选择是在应用程序的构建设置中将目标设备系列更改为 iPhone，而不是 iPhone/iPad。****

# c++ - 循环逻辑，加密数组 C++

> ID：10014672
> 
> 赞同：1
> 
> 时间：2012-04-04T15:48:02.870
> 
> 标签：c++, arrays, encryption, for-loop, uppercase

我正在尝试对数组执行一些操作，最终目标是进行简单的加密。但无论如何，我的数组长度为 458 个字符，主要由字母和一些逗号、句点等组成。我试图从数组的最后一个字符开始，转到第一个字符并将数组中的所有字母大写。它正确读取了最后一个字符 ""，但是 for 循环中的下一步就像是 4 个字符并跳过了几个字母。我的控制逻辑有问题吗？

```
void EncryptMessage (ofstream& outFile, char charArray[], int length)
{
    int index;
    char upperCased;
    char current;

    for (index = length-1; index <= length; --index)
    {
        if (charArray[index] >= 'A' && charArray[index] <= 'Z')
        {
            upperCased = static_cast<char>(charArray[index]);
            current = upperCased;
            outFile << current;
        }
        else
        {
            charArray[index]++;
            current = charArray[index];
        }

    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-04T15:56:47.087

改变：

```
for (index = length-1; index <= length; --index) 
```

至：

```
for (index = length-1; index >= 0; --index) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-04T15:56:26.577

在`else`你的`if`语句的部分，你设置的值`current`，但从不写出来，所以写出来的都是以大写字母开头的（而且，正如其他人指出的那样，你的循环条件不正确） .

如果我这样做，我的结构会有所不同。我会写一个小函子来加密一个字母：

```
struct encrypt { 
    char operator()(char input) { 
        if (isupper(input))
            return input;
        else
            return input+1;
    }
}; 
```

然后我将输入放入一个`std::string`，并使用它进行操作`std::transform`：

```
std::string msg("content of string goes here.");

std::transform(msg.rbegin(), msg.rend(), 
               std::ostream_iterator<char>(outFile, ""), 
               encrypt()); 
```

# php - 使用 jquery 克隆元素

> ID：10014677
> 
> 赞同：0
> 
> 时间：2012-04-04T15:48:20.267
> 
> 标签：php, javascript, jquery, html

以这种方式使用克隆功能：

```
$(document).ready(function(){
    var emptyPedido = $("#pedido").clone();

    $("#clonar").live('click' , function(e){
        e.preventDefault();
        $("#listing").append(emptyPedido.clone());
    });
}); 
```

可以克隆具有原始外观的元素，但我的问题是：我需要将一些 jQuery 代码应用于原始#pedido，然后在将文本写入包含#pedido 表的字段之前应用克隆。

```
$("#persiana").click(function () {
    $("#persianaver").toggle("slow");
  });
$("#persiana").click(function () {
    $("#persiaops").toggle("slow");
  }); 

$(".comment")
  .focus(function() {
        if (this.value === this.defaultValue) {
            this.value = '';
        }
  })
  .blur(function() {
        if (this.value === '') {
            this.value = this.defaultValue;
        }
}); 
```

# asp.net - 无法连接到亚马逊 EC2 上的 SQL 数据库 - microsoft project server 数据库

> ID：10014678
> 
> 赞同：2
> 
> 时间：2012-04-04T15:48:25.223
> 
> 标签：asp.net, amazon-ec2, connection-string

我正在使用在 Amazon EC2 机器上运行的 SQL 管理工作室 2008。我无法连接到我的 asp.net 应用程序中的数据库。EC2 实例已设置为接受通过 SQL 端口的连接。我还可以远程控制机器以及查看服务器上托管的网站。下面列出的是与此实例相关的连接字符串的一部分。当程序运行并调用此连接字符串时，它返回 tcp 错误 0 - 无返回响应。它只是超时。

```
<add name="ProjectServer" connectionString="Data Source=*IP ADDRESS HERE*,1433;Initial Catalog=*Catalog Name*;User ID=IP-0A6ED514\Administrator;"/> 
```

我删除了示例的 ip 和目录名称，但我确信它们是正确的。

我唯一认为可能会导致错误的是用户 ID 和服务器名称之间的名称差异 - 服务器名称是 ip-0A6ED514\sharepoint 但用户名是 ip-0A6ED514\administrator 当我登录到EC2 实例上的 sql 服务器管理器。不使用密码。不确定我是否需要为密码保留一个空白字符串 - 也不确定服务器名称和登录用户 ID 之间的差异是否会产生影响。任何帮助表示赞赏。谢谢你。

更新 - 当这个连接字符串在没有端口的情况下使用时，我得到 tcp 提供程序错误 40 - 当端口在那里时，我得到错误 0

编辑- sql server 正在使用 Windows 身份验证- 这有什么不同吗？通常我总是使用 SQL Server 身份验证

编辑 2-现在在同一位置运行 sql express，我需要一个 \SQLEXPRESS 标签吗？环顾四周后，我觉得可能是什么错误，是我可以到达机器，但它没有将我指向数据库，有什么建议吗？

# java - 如何在java中包装类并保存接口？

> ID：10014680
> 
> 赞同：12
> 
> 时间：2012-04-04T15:48:28.543
> 
> 标签：java, class, wrapper, inheritance

我有这样的课：

```
MyClass extends MyAbstractClass implement myInterface1, myInterface2,... 
```

我需要创建带有附加字段的新类：

```
MyType1 field1;
MyType2 field2;
....... 
```

似乎正确创建了将包装 MyClass 的新类，例如：

```
MyWrapClass {
 MyClass myClass=new MyClass(...);
 MyType1 field1;
 MyType2 field2;
 ..... 
```

但是 MyWrapClass 用作 myInterface1 或 myInterface2 类型！

所以问题是：我应该在 MyWrapClass 中声明接口 myInterface1、myInterface2 所需的所有方法吗？还是以另一种方式存在？谢谢。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-04-04T16:10:43.810

基本上，有两种方法。第一个是扩展基类：

```
public class MySubClass extends MyClass {
     private MyType1 field1;
     private MyType2 field2;
.... 
```

第二种选择是使用组合：

```
public class MySubClass implements myInterface1, myInterface2 {
      private MyClass delegate;
      private MyType1 field1;
      private MyType2 field2;

      // for all methods in myInterface1, myInterface2
      public SomeType method1() {
         return delegate.method1();
      }
      ... 
} 
```

许多 Java 大师推荐第二个选项：

乔什·布洛赫 (Josh Bloch) 的《有效 Java 第 2 版》一书

*   第 16 条：优先组合而不是继承
*   第 17 项：设计和文件继承或禁止继承

好的面向对象设计不是自由扩展现有的类。你的第一直觉应该是作曲。

另见[http://en.wikipedia.org/wiki/Composition_over_inheritance](http://en.wikipedia.org/wiki/Composition_over_inheritance)

> 组合优于继承可以简化业务域类的初始设计，并在长期内提供更稳定的业务域。与继承相比，它的优势在于对利益的隔离比由后代类的层次结构描述的更彻底。此外，继承模型通常是在定义业务域类时设计的，以便理解问题域中的信息，并且不一定反映各种系统对象的真实关系。

PS：一些现代 IDE 支持自动生成合成代码

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-04T15:50:44.070

不要包装，只是子类：

```
class MySubClass extends MyClass {
    MyType1 field1;
    MyType2 field2;
    ... 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-04T15:58:51.183

假设您不能扩展 MyClass，那么没有其他方法可以拥有 MyWrapClass 并像 MyClass 一样使用它。例如，我碰巧必须实现 Map 才能包装实际地图。它具有许多功能，并且必须实现您打算使用的每一个功能。这里有一点余地，如果你不打算将它传递给你没有编写的函数，你可以添加所有必需的方法并只实现你需要的方法。尽管通常情况并非如此。

或者，您可以编写一个虚拟类，该类实现调用包装器的接口的所有方法。然后你可以用你自己的实现覆盖这个类，允许你回收一个包装类，而不必每次都实现所有的方法。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-04-04T16:03:09.867

听起来代理可能会解决问题： http: [//docs.oracle.com/javase/1.5.0/docs/guide/reflection/proxy.html](http://docs.oracle.com/javase/1.5.0/docs/guide/reflection/proxy.html)

请注意，它很慢（使用反射）

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-04-04T16:13:27.680

假设您不能扩展 MyClass，并且您希望能够使用 MyWrapClass 作为类型 myInterface1 或 myInterface2。您可以执行以下操作：

```
MyWrapClass implement myInterface1, myInterface2,...{
   MyClass myClass=new MyClass(...);
   MyType1 field1;
   MyType2 field2;

   methodInInterface1 () {
      myClass.methodInInterface1 ()
   }

   .... 
```

您将 myInterface1 和 myInterface2 中的所有方法实现委托给 MyClass。我相信这被称为作曲。

# c++ - Objective-C - 与 C++ 桥接的缺点？

> ID：10014684
> 
> 赞同：25
> 
> 时间：2012-04-04T15:48:44.260
> 
> 标签：c++, objective-c, ios, cocoa, objective-c++

所以，我今天很无聊，决定搞乱 C++/Obj-C 插值，我找到了一种方法来创建一个非常有趣的设置。

```
@protocol NSCPPObj <NSObject>

-(id) init;
-(id) initWithInt:(int) value;
-(int) somethingThatReturnsAValue;
-(void) doSomething;

@end

class NSCPPObj : objc_object {
public:    
    static Class cls();

    int iVar;

    NSCPPObj();
    NSCPPObj(int);

    int somethingThatReturnsAValue();
    void doSomething();
}; 
```

如您所见，界面非常简单明了，易于理解。我们创建了两个（几乎）相同的接口，一个用于 C++ 对象，另一个用于 Obj-C 协议。

现在，我找到了实现这一点的方法，但要振作起来，这会变得很难看：

```
// NSCPPObj.mm
#import <objc/runtime.h>
#import <iostream>

#import "NSCPPObject.h"

Class NSCPPObj_class = nil;

__attribute__((constructor))
static void initialize()
{
    NSCPPObj_class = objc_allocateClassPair([NSObject class], "NSCPPObj", 0);

    class_addMethod(NSCPPObj_class->isa, @selector(alloc), imp_implementationWithBlock(^(id self) {
        return class_createInstance(NSCPPObj_class, sizeof(struct NSCPPObj));
    }), "@@:");

    class_addMethod(NSCPPObj_class, @selector(init), imp_implementationWithBlock(^(id self) {
        return self;        
    }), "@@:");

    class_addMethod(NSCPPObj_class, @selector(initWithInt:), imp_implementationWithBlock(^(id self, int value) {
        ((struct NSCPPObj *) self)->iVar = value;

        return self;
    }), "@@:i");

    class_addMethod(NSCPPObj_class, @selector(doSomething), imp_implementationWithBlock(^(id self) {
        ((struct NSCPPObj *) self)->doSomething();
    }), "v@:");
    class_addMethod(NSCPPObj_class, @selector(somethingThatReturnsAValue), imp_implementationWithBlock(^(id self) {
        return ((struct NSCPPObj *) self)->somethingThatReturnsAValue();
    }), "i@:");

    objc_registerClassPair(NSCPPObj_class);
}

Class NSCPPObj::cls()
{
    return NSCPPObj_class;
}

NSCPPObj::NSCPPObj()
{
    this->isa = NSCPPObj_class;
    [((id<NSCPPObj>) this) init];
}

NSCPPObj::NSCPPObj(int value)
{
    this->isa = NSCPPObj_class;
    [((id<NSCPPObj>) this) initWithInt:value];
}

void NSCPPObj::doSomething()
{
    std::cout << "Value Is: " << [((id<NSCPPObj>) this) somethingThatReturnsAValue] << std::endl;
}

int NSCPPObj::somethingThatReturnsAValue()
{
    return iVar;
} 
```

我将总结它的作用：

1.  分配一个类对
2.  将所有类和实例方法添加到对象
3.  注册类 Pair

现在，正如您所看到的，这不是很灵活，但它确实有效，而且它是一条双向街道：

```
id<NSCPPObj> obj = [[NSCPPObj::cls() alloc] initWithInt:15];
[obj doSomething];

NSLog(@"%i", [obj somethingThatReturnsAValue]);
NSLog(@"%@", obj);

NSCPPObj *objAsCPP = (__bridge NSCPPObj *) obj;

objAsCPP->doSomething();
std::cout << objAsCPP->somethingThatReturnsAValue() << std::endl; 
```

您也可以使用创建对象`new NSCPPObj(15)`，但记得删除它！显然，这可以在 ARC 或非 ARC 环境中工作，但 ARC 需要一些额外的桥接演员。

所以，我来了一个真正的问题：
这种设计结构的优点/缺点是什么？我可以在脑海中列出一些：

优点：

1.  C++ 中的运算符重载
2.  与 ObjC 的动态方法绑定
3.  可以以 C++ 或 ObjC 方式构建

缺点：

1.  难以阅读的实现
2.  必须为添加到接口的每个 C++ 实现添加选择器和绑定
3.  类对象不能直接引用

那么，毕竟，*您会在应用程序中推荐这种设计结构吗？*以及为什么。

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2012-04-04T16:39:45.017

> 那么，毕竟，您会在应用程序中推荐这种设计结构吗？以及为什么。

不。

这是一段非常好的代码；我特别喜欢 imp_implementationWithBlock() 的使用（但我承认我可能偏爱运行时的特定功能；）。当然，像这样的探索总是一种非常有价值的学习工具。

在“现实世界付费项目”使用的上下文中，问题是您正在有效地创建一个相对通用的桥，然后必须在两端有特定的桥来与典型的 C++ 库或典型的 Objective-C API/图书馆。换句话说，您有效地创建了一个从两个现有运行时的合并派生的新运行时。

而且，正如您在缺点中指出的那样，您几乎必须在要引入此模式的每个 C++ 类之上触摸、包装、修改和/或调试 shim。

在过去的 20 多年里，在处理大量 Objective-C++ 代码时，像这样的桥通常比它的价值更麻烦。你可能会更好——花更少的时间编写和调试代码——围绕 C++（或者坦率地说是 C）API 创建简单的 Objective-C 包装器，然后可以与目标系统的 Objective-C 框架集成并使用它们。

# java - 使用 XPath 2 验证自日期以来的时间

> ID：10014687
> 
> 赞同：2
> 
> 时间：2012-04-04T15:48:53.663
> 
> 标签：java, xpath-2.0

如何（使用哪个 XPath 表达式）验证格式为“yyyy-MM-dd HH:mm:ss”的日期是否早于特定小时数？我需要使用 Saxon 的 XPathExpression（XPath 2.0，Java 1.7）进行验证。打电话时...

```
xpathExpression.evaluate(doc, XPathConstants.BOOLEAN) 
```

...如果日期比例如 5 小时更新，我希望它返回 true。

假设日期在此 XML 的 dt 属性中：

```
<msgs>
    <msg dt="2012-04-04 12:13:14"/>
</msgs> 
```

谢谢马库斯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-07T18:17:20.587

**真正的 XPath 2.0 解决方案是使用这样的 XPath 2.0 表达式**：

```
 current-dateTime() - xs:dateTime('2012-04-04T12:13:14')
 lt
   xs:dayTimeDuration('PT5H') 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-04T16:20:58.360

如果您想深入了解细节，可以使用 substring 自己计算时间，然后将时间值与当前日期时间进行比较：

您正在分析的时间：

```
boolean(100*number(substring(//msgs/msg/@dt,12,2)) + 10*number(substring(//msgs/msg/@dt,15,2)) + 1*number(substring(//msgs/msg/@dt,18,2)) > (current time + t*100)) 
```

其中当前时间的计算方式相同，t 是您正在检查的小时数。但这是考虑到这两次是在同一天，所以如果你想同时检查两者，你必须对日期值做同样的事情，所以你最好使用 Slanec 的内容建议。

# asp.net - listview itemcommand在后退按钮后未触发

> ID：10014691
> 
> 赞同：0
> 
> 时间：2012-04-04T15:49:02.507
> 
> 标签：asp.net, back-button

我有使用多视图的页面。每个视图都包含一个单独的用户控件。其中一个用户控件有一个带有图像按钮的列表视图，该按钮会导致在多视图中加载不同的视图。到目前为止一切都很好。当用户点击后退按钮时，他们将被带回包含列表视图的用户控件。然后用户单击另一个图像按钮以查看不同的数据，并使用与以前相同的数据返回到详细用户控件。在调试时，我看到点击后退按钮后项目命令事件没有触发。

我尝试替换多视图并将每个用户控件放入单独的面板中。这根本没有改变结果。

我尝试设置一个在页面加载后 5 秒过期的 cookie。当用户继续到下一页，然后点击返回（已经超过 5 秒），我强制表单再次提交。这将再次加载下一个控件，而不是重新加载页面。

我尝试将可缓存性设置为无缓存。这会导致“页面过期”消息，并且用户必须刷新页面。这对用户来说是丑陋的，并且肯定会影响用户体验。

我正在为用户寻找最干净的方式来单击返回并重新加载页面，以便项目命令事件再次正确触发。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-05T16:05:44.030

找到这个答案需要大量研究，所以希望其他人偶然发现这个问题并找到我的答案。我很惊讶我居然能找到这个。好吧，够幸灾乐祸了。

因为当用户单击后退按钮时页面不会回发，所以事件不会正确触发，从而导致下一页出现问题。必须发生的是您需要能够处理浏览器的导航按钮（即后退和前进）。为此，您必须在脚本管理器中将 EnableHistory 设置为 true，并从脚本管理器处理 Navigate 事件。然后，您可以使用保存在状态对象中的信息重新加载控件。

我使用 DotNetSlackers.com 上 Dino Esposito 的这些文章作为参考。[服务器端历史管理](http://dotnetslackers.com/articles/aspnet/AFirstLookAtASPNETExtensions35HistoryPoints.aspx)和[客户端历史管理](http://dotnetslackers.com/articles/ajax/clienthistorypointsinaspnet35extensions.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-04T16:56:10.817

原因是 Back 不会影响页面生命周期。这肯定是因为页面被缓存并且缓存的页面不在服务器上执行。您可以尝试使用此代码来解决此问题。

> Response.Cache.SetCacheability(HttpCacheability.NoCache);
> Response.Cache.SetNoStore();

# mysql - 如何将结果集行转换为列

> ID：10014692
> 
> 赞同：0
> 
> 时间：2012-04-04T15:49:03.087
> 
> 标签：mysql

我得到这样的结果集

```
user_id
57
83
71
40
96
58
99
27 
```

现在我想将这八行存储到八列中，所以任何人都可以告诉我如何将行转换为列

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-04T15:58:19.860

这是一个数据透视表。

这是一个关于如何在 MySQL 中旋转的教程的链接：[http ://www.artfulsoftware.com/infotree/queries.php#78](http://www.artfulsoftware.com/infotree/queries.php#78)

关于这个主题也有很多问题/答案。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-04T16:30:32.613

试试下面：

```
 SELECT
    if(user_id=57, 57, '') as user57,
    if(user_id=57, 83, '') as user83,
    if(user_id=57, 71, '') as user71,
    if(user_id=57, 40, '') as user40,
    if(user_id=57, 96, '') as user96,
    if(user_id=57, 58, '') as user58,
    if(user_id=57, 99, '') as user99,
    if(user_id=57, 27, '') as user27,
    FORM tablename 
```

假设您的行已修复。

# mvvm - 使用 MVVM 和 Unity 使用其 ViewModel 实例化/调用其他视图（WPF 表单）

> ID：10014695
> 
> 赞同：3
> 
> 时间：2012-04-04T15:49:05.957
> 
> 标签：mvvm, dependency-injection, unity-container, ioc-container

我正在使用 MVVM 和 Unity，我了解了如何显示 shell 视图（带有 MainViewModel 的 MainView），但我找不到实例化其他窗口的正确方法，例如：Details Button that opens a new form and show其他详情。

因此，我正在寻找一种通用方法，如何使用 MVVM 和 Unity 使用其 ViewModel 实例化/调用其他视图（WPF 窗口）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-04T18:36:56.393

这个[答案](https://stackoverflow.com/questions/5498989/datatemplate-in-resource-sets-viewmodel-to-view-but-then)可能有助于理解如何将多个视图/视图模型链接在一起。我通常不会发现自己需要打开其他窗口，只是在当前窗口中显示不同的视图。

如果您正在寻找专门用于打开新窗口的 MVVM 解决方案，请告诉我们。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-04T18:18:36.740

看看这个答案：[在 MVVM 中处理用户交互](https://stackoverflow.com/questions/6275352/mvvm-popup-window-with-view-model-parameter-and-result/6275466#6275466)。您可以利用交互服务来实例化新的 WPF 窗口，但仍将保持分离状态。

您还可以在 WPF 中提供间接通信，方法是利用中介者模式从视图模型发布消息，从而实例化新视图。这个答案[Simple Mediator implementation](https://stackoverflow.com/questions/4328660/sql-wpf-xaml-c-binding-data-dynamic-resource-accessing-to-non-static-data/4329444#4329444)给出了一个快速的概述。

我建议您阅读[用户交互模式](http://msdn.microsoft.com/en-us/library/gg405494%28v=PandP.40%29.aspx#sec10)指南，因为它涵盖了您在使用 MVVM 时将面临的许多场景。

# php - Transact-SQL 和 PHP 问题

> ID：10014697
> 
> 赞同：0
> 
> 时间：2012-04-04T15:49:08.720
> 
> 标签：php, sql, tsql, odbc

在 SQLManagement Studio 中运行此查询会返回 162 行的结果集

```
SELECT order_num, 
       status, 
       ship_date, 
       cust_ord_num, 
       weight, 
       carrier_desc, 
       consignee, 
       cases 
FROM   v1oemf 
WHERE  ACCOUNT = 'NESTLE' 
       AND status LIKE '%Shipped%' 
       AND ( ship_date BETWEEN '20120327' AND '20120403' ) 
```

我从`echo`我的 PHP 页面上的这段代码的结果中得到的

```
echo "SELECT Order_num,Status,Ship_date,Cust_ord_num,Weight,Carrier_desc,Consignee,Cases FROM V1OEMF  WHERE Account = '" . $_POST['account'] . "' AND Status LIKE '%". $_POST['custstat'] ."%' AND (Ship_date BETWEEN '".$_POST['start_date']."' AND '".$_POST['end_date']."')";
$rs=odbc_exec($link,"SELECT Order_num,Status,Ship_date,Cust_ord_num,Weight,Carrier_desc,Consignee,Cases FROM V1OEMF WHERE Account = '" . $_POST['account'] . "' AND Status LIKE '". $_POST['custstat'] ."' AND Ship_date BETWEEN '".$_POST['start_date']."' AND '".$_POST['end_date']."'"); 
```

基于 PHP 的查询的结果集是 0 行，我一辈子都看不到这个问题......

这是应该建立结果表的整个部分

```
$rs=odbc_exec($link,"SELECT Order_num,Status,Ship_date,Cust_ord_num,Weight,Carrier_desc,Consignee,Cases FROM V1OEMF WHERE Account = '" . $_POST['account'] . "' AND Status LIKE '". $_POST['custstat'] ."' AND Ship_date BETWEEN '".$_POST['start_date']."' AND '".$_POST['end_date']."'");
                                $num = odbc_num_rows($rs);
                                echo $num;
                                echo "<table>";
                                echo "<thead><tr class='header'>";
                                echo "<td>Order #</td><td>Status</td><td>Ship Date</td><td>Sales Order #</td><td>Consignee</td><td>Carrier</td><td>Cases</td><td>Weight</td>";
                                echo "</tr></thead>";
                                while (odbc_fetch_row($rs)) {
                                                         echo "<tr><td id='f1'><a class='ow' href='' id='" . odbc_result($rs,'Order_num') . "'>" . odbc_result($rs,'Order_num') . "</a></td><td id='f2'>" . odbc_result($rs,'Status') . "</td><td id='f3'>" . odbc_result($rs,'Ship_date') . "</td><td id='f5'>" . odbc_result($rs,'Cust_ord_num') . "</td><td id='f6'>" . odbc_result($rs,'Consignee') . "</td><td id='f7'>" . odbc_result($rs,'Carrier_desc') . "</td><td id='f8' align='right'>" . odbc_result($rs,'Cases') . "</td><td id='f9' align='right'>" . odbc_result($rs,'Weight') . "</td></tr>";
                                                         }
                                echo "</table>"; 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-04T15:50:25.240

如果您希望它`%`在您的第一个 SQL 语句中执行，您将需要它。`$_POST['custstat']``LIKE`

您在 中拥有它们`echo`，但在实际 SQL 中却没有。

# c# - 适用于 Android 的 Mono：ListView 删除项目 NotifyDataSet 已更改

> ID：10014699
> 
> 赞同：4
> 
> 时间：2012-04-04T15:49:13.217
> 
> 标签：c#, android, for-loop, mono, xamarin.android

我正在尝试从列表视图中删除行。当我单击删除时，该行被删除。但是，ListView 无法更新。我必须单击后退按钮并回来查看已删除的项目。有没有办法在删除项目后刷新页面？这是我的代码：

```
public class OrderHistoryAdapter : BaseAdapter
{
    private List<Order> _orders;
    private Activity _context;

    public OrderHistoryAdapter(Activity context, List<Order> orders)
    {
        _context = context;
        _orders = orders;
    }

    public override View GetView(int position, View convertView, ViewGroup parent)
    {
        var item = _orders.ElementAt(position);

        var view = (convertView ??
                this._context.LayoutInflater.Inflate(
                Resource.Layout.OrderHistoryDetailsRow,
                parent,
                false)) as RelativeLayout;

        TextView orderHistoryText = view.FindViewById<TextView>(Resource.Id.orderHistoryText);
        orderHistoryText.Text = ((Order)item).Date.ToShortDateString();
        view.FindViewById<TextView>(Resource.Id.btnDeleteOrder).Click += delegate
        {
            OrderRepository orderRepo = new OrderRepository();
            orderRepo.Delete(((Order)item).Id);
            //Item has been deleted, yet list fails to update
            NotifyDataSetChanged();
        };

        //Finally return the view
        return view;
    }

    public override int Count
    {
        get { return _orders.Count(); }
    }

    public Order GetOrder(int position)
    {
        return _orders.ElementAt(position);
    }

    public override Java.Lang.Object GetItem(int position)
    {
        return null;
    }

    public override long GetItemId(int position)
    {
        return position;
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-04T22:08:21.083

即使您在存储库中删除它，该对象仍位于适配器 ( `_orders`) 中存储的订单列表中。在调用之前尝试从该列表中删除对象`NotifyDataSetChanged()`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-06-10T23:43:37.203

更新 ListView

```
 private ListView lvAnuncios= null;

   ....
   {
        this.lvAnuncios = this.FindViewById<ListView>(Resource.Id.MisAnuncios_lvAnuncios);
   }

   private void ReloadListView()
   {
        if (this.lvAnuncios.Adapter == null)
        {
            this.lvAnuncios.Adapter = new adAnuncio(this, Resource.Layout.FilaListViewAnuncio, csVariable.objUsr.lstAnuncios);
        }
        else
        {
            ((BaseAdapter)this.lvAnuncios.Adapter).NotifyDataSetChanged();
        }
   } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-04T15:55:23.453

尝试`NotifyDataSetChanged()`在您的`OrderHistoryAdapter`实例上调用（或类似的）。

# jquery - jquery在鼠标悬停时将图像设置为单元格

> ID：10014705
> 
> 赞同：0
> 
> 时间：2012-04-04T15:49:39.190
> 
> 标签：jquery, image, hover, cell

我有一张桌子，我想在鼠标悬停的单元格中显示一张图片。我环顾四周，发现的示例似乎过于复杂。

我应该在每个单元格中都有图像并隐藏/显示它们吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-04T15:53:16.157

众所周知，为表格单元格使用背景图像非常困难，因此您将需要使用 div 来实现背景图像效果。给它这个CSS：

```
td.class td {
   width:100%;
   height:100%;
   display:none;
} 
```

并使用这个 jQuery：

```
$(function(){
   $('td.class').hover(function() {
      $(this).children('img').show();
   },function(){
      $(this).children('img').hide();
   });
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-04T15:56:02.770

此处使用 jQuery 的示例：http: [//jsfiddle.net/rEETW/](http://jsfiddle.net/rEETW/)

```
$(document).ready(function ()
{
        var image;
        $('td').hover(function()
          {
            image = $('<img/>').attr('src', 'http://maps.google.com/images/experiments/nav_logo78.png');
            $(this).append(image);
          }, function ()
          {
            $(image).remove();
          }); 
    });​ 
```

只有css，但您必须先将图像放在表格中[http://jsfiddle.net/rEETW/1/](http://jsfiddle.net/rEETW/1/)

```
td img
{
 display:none;   
}

td:hover img
{
 display: block;   
} 
```

# android - 每次我从另一个 Activity 回来时，ExpandableListView 都会折叠所有组项

> ID：10014707
> 
> 赞同：2
> 
> 时间：2012-04-04T15:49:42.257
> 
> 标签：android, expandablelistview

我需要有人指导我找出错误。当我接到一个电话或去另一个活动时，当我回来时，所有的组都被折叠了。系统没有销毁活动，所以我无法在onRestoreInstanceState中保存和恢复状态，因为该方法从未被调用（活动只是暂停和停止，但没有被销毁）。

Activity 扩展 ExpandableListActivity，我使用的适配器是 SimpleCursorTreeAdapter。

在哪些情况下可展开列表折叠？我快疯了，我找不到解决办法。

提前致谢。

编辑：这是
第一次启动 Activivy 时我的 Activity 的生命周期：
**onCreate() -> onStart() -> onResume()**
当我转到其他 Activity 时：
**onPause() -> onStop()**
和当我回来时:
**onRestart -> onStart() -> onResume()**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-04T16:46:06.647

不幸的是，无论何时失去焦点，展开状态总是会重置，并且当它再次获得焦点时不会调用 onCreate()，而是调用 onStart()。所以我现在的解决方法是手动存储所有展开项目的 ID 并再次在 onStart() 中展开它们。我实现了 ExpandableListActivity 的子类来重用该行为。

```
public class PersistentExpandableListActivity extends ExpandableListActivity {

private long[] expandedIds;

@Override
protected void onStart() {
    super.onStart();
    if (this.expandedIds != null) {
        restoreExpandedState(expandedIds);
    }
}

@Override
protected void onStop() {
    super.onStop();
    expandedIds = getExpandedIds();
}

@Override
protected void onSaveInstanceState(Bundle outState) {
    super.onSaveInstanceState(outState);
    this.expandedIds = getExpandedIds();
    outState.putLongArray("ExpandedIds", this.expandedIds);
}

@Override
protected void onRestoreInstanceState(Bundle state) {
    super.onRestoreInstanceState(state);
    long[] expandedIds = state.getLongArray("ExpandedIds");
    if (expandedIds != null) {
        restoreExpandedState(expandedIds);
    }
}

private long[] getExpandedIds() {
    ExpandableListView list = getExpandableListView();
    ExpandableListAdapter adapter = getExpandableListAdapter();
    if (adapter != null) {
        int length = adapter.getGroupCount();
        ArrayList<Long> expandedIds = new ArrayList<Long>();
        for(int i=0; i < length; i++) {
            if(list.isGroupExpanded(i)) {
                expandedIds.add(adapter.getGroupId(i));
            }
        }
        return toLongArray(expandedIds);
    } else {
        return null;
    }
}

private void restoreExpandedState(long[] expandedIds) {
    this.expandedIds = expandedIds;
    if (expandedIds != null) {
        ExpandableListView list = getExpandableListView();
        ExpandableListAdapter adapter = getExpandableListAdapter();
        if (adapter != null) {
            for (int i=0; i<adapter.getGroupCount(); i++) {
                long id = adapter.getGroupId(i);
                if (inArray(expandedIds, id)) list.expandGroup(i);
            }
        }
    }
}

private static boolean inArray(long[] array, long element) {
    for (long l : array) {
        if (l == element) {
            return true;
        }
    }
    return false;
}

private static long[] toLongArray(List<Long> list)  {
    long[] ret = new long[list.size()];
    int i = 0;
    for (Long e : list)  
        ret[i++] = e.longValue();
    return ret;
}
} 
```

也许有人有更好的解决方案。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-04T15:58:38.200

您可以通过覆盖 Activity 中的 onPause() 和 onResume() 来保存任何状态信息。

您应该能够保留所选项目，然后在 Activity 恢复时重新选择该项目。您也可以在 onStop() 和 onStart() 中添加它。

如果 Activity 只是被暂停/停止，那么所有的都`Views`应该保持它们的状态，因为它们没有被销毁和重新创建。尝试为每个“大”生命周期方法添加更多日志记录：

```
 protected void onCreate(Bundle savedInstanceState);

 protected void onStart();

 protected void onRestart();

 protected void onResume();

 protected void onPause();

 protected void onStop();

 protected void onDestroy(); 
```

创建一个您扩展的日志记录活动应该是您跟踪生命周期不一致时的第一步。

# switch-statement - 如何让脚本重新运行？

> ID：10014712
> 
> 赞同：0
> 
> 时间：2012-04-04T15:49:50.667
> 
> 标签：switch-statement, calculator

我知道这很模糊，但我对 C++ 很陌生。我第一次做一个计算器项目，我想做的是，如果用'y'回复，让脚本从头开始重新运行......基本上。

```
#include <iostream>
#include <stdio.h>
#include <math.h>

using namespace std;
int main()
    {
        cout << "Hello and Welcome to the Test Calculator!\n";
        signed char choice;
        char resp;
        cout << "Choose your problem:\n a)Addition\n b)Subtraction\n c)Multiplication\n d)Division\n e)Square Root\n f)Hypotenuse\n";
        scanf ("%c", &choice);
        switch (choice)
        {
            case 'a':
            {
                int a;
                int b;
                cout << "Addition\n";
                cout << "Please enter a number:\n";
                cin >> a;
                cout << "Please enter your second number:\n";
                cin >> b;
                cin.ignore();
                int result = a + b;
                cout << "Calculating...\n";
                cout << "Your total is:\n"<<"  "<<result;
                cin.get();
                break;
            }
            case 'b':
            {
                int c;
                int d;
                cout << "Subtraction\n";
                cout << "Please enter a number:\n";
                cin >> c;
                cout << "Please enter your second number:\n";
                cin >> d;
                cin.ignore();
                int result2 = c - d;
                cout << "Calculating...\n";
                cout << "Your total is:\n"<<"  "<<result2;
                cin.get();
                break;
            }
            case 'c':
            {
                int e;
                int f;
                cout << "Multiplication\n";
                cout << "Please enter a number:\n";
                cin >> e;
                cout << "Please enter your second number:\n";
                cin >> f;
                cin.ignore();
                int result3 = e * f;
                cout << "Calculating...\n";
                cout << "Your total is:\n"<<"  "<<result3;
                cin.get();
                break;
            }
            case 'd':
            {
                int g;
                int h;
                cout << "Division\n";
                cout << "Please enter a number:\n";
                cin >> g;
                cout << "Please enter your second number:\n";
                cin >> h;
                cin.ignore();
                int result4 = g / h;
                cout << "Calculating...\n";
                cout << "Your total is:\n"<<"  "<<result4;
                cin.get();
                break;
            }
            case 'e':
            {
                int x;
                #define square ((x)*(x))
                cout << "Square Root\n";
                cout << "Please enter a number:\n";
                cin >> x;
                cin.ignore();
                cout << "Calculating...\n";
                cout << "Your total is:\n"<<"  "<<square;
                cin.get();
                break;
            }
            case 'f':
            {
                int i;
                int j;
                cout << "Hypotenuse\n";
                cout << "Enter your smaller side:\n";
                cin >> i;
                cout << "Please enter the longer side:\n";
                cin >> j;
                cin.get();
                int hypotenuse = ((i*i)+(j*j));
                cout << "Calculating...\n";
                cout << "The hypotenuse is the square root of:\n"<<"  "<<hypotenuse;
                cin.ignore();
                cout << "Would you like to do another problem?\n y)Yes\n n)No\n";
                cin >> resp; //this is where im trying to test this at
            }
            default:
            {
                cout << " \n";
                cout << "Error: Undefined response\n";
                cout << "Contact the source programmer for details\n";
            }
    }
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-04T16:02:10.043

您可以添加另一个选项来继续计算器。像这样的东西：

```
 while(doContinue == true){

    switch{.....}

} 
```

也就是说，将代码的切换部分包含在一个while循环中。首先将 doContinue 设置为 true，然后根据用户输入在最后更改它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-04T15:55:20.893

如果您将开关置于 while 循环中，以检查 char == 'n' 是否会继续，直到找到它为止。

```
while(choice != 'n')
{
    switch (choice)
    {
        case 'a':
        {
            int a;
            int b;
            cout << "Addition\n";
            cout << "Please enter a number:\n";
            cin >> a;
            cout << "Please enter your second number:\n";
            cin >> b;
            cin.ignore();
            int result = a + b;
            cout << "Calculating...\n";
            cout << "Your total is:\n"<<"  "<<result;
            cin.get();
            break;
        }
        case 'b':
        {
            int c;
            int d;
            cout << "Subtraction\n";
            cout << "Please enter a number:\n";
            cin >> c;
            cout << "Please enter your second number:\n";
            cin >> d;
            cin.ignore();
            int result2 = c - d;
            cout << "Calculating...\n";
            cout << "Your total is:\n"<<"  "<<result2;
            cin.get();
            break;
        }
        case 'c':
        {
            int e;
            int f;
            cout << "Multiplication\n";
            cout << "Please enter a number:\n";
            cin >> e;
            cout << "Please enter your second number:\n";
            cin >> f;
            cin.ignore();
            int result3 = e * f;
            cout << "Calculating...\n";
            cout << "Your total is:\n"<<"  "<<result3;
            cin.get();
            break;
        }
        case 'd':
        {
            int g;
            int h;
            cout << "Division\n";
            cout << "Please enter a number:\n";
            cin >> g;
            cout << "Please enter your second number:\n";
            cin >> h;
            cin.ignore();
            int result4 = g / h;
            cout << "Calculating...\n";
            cout << "Your total is:\n"<<"  "<<result4;
            cin.get();
            break;
        }
        case 'e':
        {
            int x;
            #define square ((x)*(x))
            cout << "Square Root\n";
            cout << "Please enter a number:\n";
            cin >> x;
            cin.ignore();
            cout << "Calculating...\n";
            cout << "Your total is:\n"<<"  "<<square;
            cin.get();
            break;
        }
        case 'f':
        {
            int i;
            int j;
            cout << "Hypotenuse\n";
            cout << "Enter your smaller side:\n";
            cin >> i;
            cout << "Please enter the longer side:\n";
            cin >> j;
            cin.get();
            int hypotenuse = ((i*i)+(j*j));
            cout << "Calculating...\n";
            cout << "The hypotenuse is the square root of:\n"<<"  "<<hypotenuse;
            cin.ignore();
            cout << "Would you like to do another problem?\n y)Yes\n n)No\n";
            cin >> choice; //this is where im trying to test this at
        }
   }
} 
```

# c++ - 使用可变参数模板构建元组

> ID：10014713
> 
> 赞同：7
> 
> 时间：2012-04-04T15:49:54.820
> 
> 标签：c++, templates, c++11

所以我有一些在 C++11 之前编写的代码，它们根据模板参数解析字符串。我不想为每个数量的参数定义一个定义，而是想使用可变参数模板，但我不知道如何正确初始化元组。请参阅我想要的简化代码，这是针对 2 个参数的特殊情况：

```
template <typename Arg1, typename Arg2>
struct parser
{
  static tuple<Arg1, Arg2> parse(const string& str) 
  {
    Arg1 arg1;
    Arg2 arg2;
    // do the parsing with for example stringstream
    return tuple<Arg1, Arg2>(arg1, arg2);             
  }
}; 
```

我在将参数放在可变参数情况下的元组中时遇到问题。我可以构造返回值持有者：

```
tuple<Args...> retVal; 
```

但我不知道是否有办法遍历参数并将它们放在一个元组中。我已经看到了一些递归魔法来获取例如`printf`函数，但我不知道它是否适用于这种情况。

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2012-04-04T16:07:05.777

你不需要帮助类。用函数代替。

```
template <typename T> std::tuple<T> parse(std::istream& is) 
{
  T t; is >> t;
  return std::tuple<T>(std::move(t));
}

template <typename T, typename Arg, typename... Args>
std::tuple<T, Arg, Args...> parse(std::istream& is) 
{
  T t; is >> t;
  return std::tuple_cat(std::tuple<T>(std::move(t)),
                        parse<Arg, Args...>(is));
}

template <typename... Args>
std::tuple<Args...> parse(const std::string& str) 
{
  std::istringstream is(str);
  return parse<Args...>(is);
} 
```

**编辑**：今天，我知道如何使用扩展以非常简单的方式做到这一点：

```
template <typename T> T read(std::istream& is)
{
  T t; is >> t; return t;
}

template <typename... Args>
std::tuple<Args...> parse(std::istream& is) 
{
  return std::make_tuple(read<Args>(is)...);
}

template <typename... Args>
std::tuple<Args...> parse(const std::string& str) 
{
  std::istringstream is(str);
  return parse<Args...>(is);
} 
```

# .net - 禁止“资源名称不是有效标识符”

> ID：10014716
> 
> 赞同：8
> 
> 时间：2012-04-04T15:49:56.550
> 
> 标签：.net, visual-studio, visual-studio-2010, embedded-resource

我有一个包含 5000 多个资源字符串的项目。几乎所有人的标识符中都有句点。

我们正在切换到自动生成强类型类，当然，由于句号，我们会看到几千条警告

> 资源名称“blah”不是有效标识符。

我知道不是，生成器将句点更改为下划线，一切都很好。

我可以抑制警告吗？它似乎没有与#pragma away 相关的号码。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-16T19:34:05.527

我想我可以复制，尽管问题并不明确。Project + Properties, Resources 并键入一个字符串资源名称，如“foo.bar”会触发此警告。

是的，您不能取消此警告，它是由 IDE 中的资源设计器生成的。当它从 Properties\Resources.resx 文件自动生成代码到 Properties\Resources.Designer.cs 文件时。查看 .resx 文件并检查`<data>`元素的“名称”属性。属性值中的句点将触发警告。

用正则表达式精心设计的搜索和替换可以通过将句点变成下划线来解决这个问题。这给我个人带来了两个问题，我只需要编写一个使用 XDocument 的小程序。还要检查你是否仍然需要这个自动生成的代码，听起来你正在替换它。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-19T19:32:22.170

这里一个非常糟糕的解决方法是将生成的代码与 Resource 工具分离：

假设您的资源文件的名称是**Resources.resx**

1.  通过双击 Visual Studio 中项目中的 Resources.resx 打开资源工具。

2.  设置适合您正在使用的生成代码范围的访问修饰符。

3.  在 Windows 资源管理器中，转到包含**Resources.resx**和**Resources.Designer.cs**代码的目录。（手动浏览或右键单击您的项目/命名空间文件夹并选择“在 Windows 资源管理器中打开文件夹”）

4.  **将Resources.Designer.cs**重命名为**Resources.cs**

5.  回到 Visual Studio 中的资源工具，将访问修饰符设置为“无代码生成”

6.  保存，关闭资源工具

7.  单击解决方案资源管理器窗口顶部的“显示所有文件”图标。**Resources.cs**文件应以幻影形式出现在与**Resources.resx**相同的文件夹中

8.  右键单击**Resources.cs**并选择“包含在项目中”

警告现在应该消失了。当然，这项工作的不便之处在于，您必须在任何时候修改资源文件时执行所有这些步骤。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-04T16:13:05.263

这将抑制给定 .cs 文件的所有警告

```
#pragma warning disable 
```

您还应该能够右键单击警告，然后单击“显示错误帮助”。它应该给出准确的警告编号，以便您可以通过进入项目属性，然后进入构建页面并将其输入到 Suppress Warnings 文本框来抑制整个项目的警告。

经过进一步研究，似乎无法抑制某些警告。请参阅 msdn 上有关 /nowarn C# 编译器选项的详细信息[http://msdn.microsoft.com/en-us/library/7f28x9z3.aspx](http://msdn.microsoft.com/en-us/library/7f28x9z3.aspx)

其中之一是编译器警告（级别 1）CS2029，它指的是您收到的“不是有效标识符”警告。您可以通过访问此处的编译器警告 (level1) CS2029 的详细信息来进一步确认它不能被抑制[http://msdn.microsoft.com/en-us/library/878y1894.aspx](http://msdn.microsoft.com/en-us/library/878y1894.aspx)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-10T09:49:16.197

如果资源名称不是有效标识符（例如，它包含空格或“-”），并且为文件打开了强类型资源生成，则会出现此警告。这是一个警告而不是错误，因为强类型资源名称将更改为有效名称（例如，“a b”将更改为“a_b”），但资源名称将保持为“a b”。

**纠正这个错误**

如果可能，您应该首先将资源的名称更改为有效的标识符。如果这不是有效选项，请禁用此 .resx 文件的强类型资源代码生成。为此，请在解决方案资源管理器中选择 .resx 文件并清除自定义工具属性。

来源： http: [//msdn.microsoft.com/en-us/library/ms228672 (v=vs.80).aspx](http://msdn.microsoft.com/en-us/library/ms228672(v=vs.80).aspx)

# wpf - 如何在 WPF 中水平分布对象数组？

> ID：10014721
> 
> 赞同：2
> 
> 时间：2012-04-04T15:50:06.180
> 
> 标签：wpf, itemscontrol

我想列出一组对象，并让这些项目水平均匀分布。如果它不是一个数据绑定数组，我只需创建一个具有正确列数的网格并将每个项目分配给一列。问题是我不知道如何使用数据绑定列表控件来做到这一点。

作为一种廉价的替代方案，我使用堆栈面板作为 ItemsPanel 水平列出项目，用于 ItemsControl，如下所示：

```
 <ItemsControl ItemsSource="{Binding Path=ValveSettings}" Grid.Row="0">
        <ItemsControl.ItemsPanel>
            <ItemsPanelTemplate>
                <StackPanel Orientation="Horizontal" />
            </ItemsPanelTemplate>
        </ItemsControl.ItemsPanel>
        <ItemsControl.ItemTemplate>
            <DataTemplate>
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="auto" />
                        <RowDefinition />
                        <RowDefinition Height="auto" />
                    </Grid.RowDefinitions>
                    <Label Content="{Binding Path=Name}" Grid.Row="0" />
                    <ScrollBar Orientation="Vertical" Grid.Column="0" Grid.Row="1" Minimum="0" Maximum="100000" Value="{Binding Path=DelayInMicroseconds}" SmallChange="100" LargeChange="1000" />
                    <TextBox Text="{Binding Path=DelayInMicroseconds}" Grid.Row="2" />
                </Grid>
            </DataTemplate>
        </ItemsControl.ItemTemplate>
    </ItemsControl> 
```

有没有办法让它们均匀分布？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-04T20:41:57.013

这是 CodeWarrior 的评论结果，效果非常好：

```
 <ItemsControl ItemsSource="{Binding Path=Settings.Valves}" Grid.Row="0">
        <ItemsControl.ItemsPanel>
            <ItemsPanelTemplate>
                <UniformGrid Rows="1" />
            </ItemsPanelTemplate>
        </ItemsControl.ItemsPanel>
        <ItemsControl.ItemTemplate>
            <DataTemplate>
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="auto" />
                        <RowDefinition />
                        <RowDefinition Height="auto" />
                    </Grid.RowDefinitions>
                    <TextBlock Text="{Binding Path=Name}" Grid.Row="0" TextAlignment="Center" />
                    <ScrollBar Orientation="Vertical" Grid.Column="0" Grid.Row="1" Minimum="0" Maximum="100000" Value="{Binding Path=DelayInMicroseconds}" SmallChange="100" LargeChange="1000" />
                    <TextBox Text="{Binding Path=DelayInMicroseconds}" Grid.Row="2" TextAlignment="Center" />
                </Grid>
            </DataTemplate>
        </ItemsControl.ItemTemplate>
    </ItemsControl> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-04T15:54:36.097

我通常将列表项分开，并在 ItemTemplate 上留出一个边距。将边距放在非起始侧（即，如果列表从左侧填充，则将边距放在右侧）。这样，每个连续的项目将被放置在前一个项目的 x 像素处。

在上面的示例中，我为 Grid 元素添加了边距。

```
 <DataTemplate>
            <Grid Margin="0 0 8 0">
                <Grid.RowDefinitions>
                    <RowDefinition Height="auto" />
                    <RowDefinition />
                    <RowDefinition Height="auto" />
                </Grid.RowDefinitions>
                <Label Content="{Binding Path=Name}" Grid.Row="0" />
                <ScrollBar Orientation="Vertical" Grid.Column="0" Grid.Row="1" Minimum="0" Maximum="100000" Value="{Binding Path=DelayInMicroseconds}" SmallChange="100" LargeChange="1000" />
                <TextBox Text="{Binding Path=DelayInMicroseconds}" Grid.Row="2" />
            </Grid>
        </DataTemplate> 
```

# visual-studio-2010 - Sql Project Publish 替换 Deploy - 如何抑制版本控制和挂钩到 tfs 构建

> ID：10014723
> 
> 赞同：8
> 
> 时间：2012-04-04T15:50:10.627
> 
> 标签：visual-studio-2010, sql-server-2012, sql-data-tools

我们正在使用 Sql Server 2012 SSDT，它删除了 Visual Studio 中数据库项目（现在是 sql 项目）的部署选项。我们希望像部署一样自动化发布步骤，但不清楚如何执行此操作。所以有几个问题：

1.  我已将 .publish.xml 添加到项目中（在第一次手动发布后，检查添加到项目）。即使在那之后，并将其设置为默认值，当我双击它时，它会构建，但总是会弹出设置窗口，我需要单击“发布”按钮才能继续。是否有可以跳过此提示并使用当前值的设置？

2.  似乎每次发布都会生成一个版本的 sql 输出。我怎样才能抑制这个 - 即每次都覆盖基本文件？

3.  最后，任何更新构建以使用新项目类型和自动构建发布命令的指针将不胜感激。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-18T18:10:41.283

**如何恢复 Deploy 选项：（** *仅限 Visual Studio 2010/2012 -- Visual Studio 2013 不再支持此功能）*

部署选项仍然存在，但由于某种原因，它在菜单中不可用。（被诅咒的 Visual Studio 团队！）我通过将部署选项添加到工具栏之一来解决此问题，如下所示：

1.  单击工具栏右侧的箭头。
2.  单击“添加或删除按钮”，然后单击自定义。
3.  在自定义对话框中单击添加命令。
4.  选择“构建”类别，然后选择“部署选择”命令。
5.  保存您的选择后，“部署 [项目名称]”选项将出现在工具栏上。*您需要在解决方案资源管理器中选择您的项目才能启用该按钮。*

请注意，部署设置与发布设置不同。部署设置在“调试”选项卡上的项目属性中进行配置。

* * *

要回答有关“发布”选项的问题：

**1）如何默认使用特定的发布文件，避免烦人的提示**

我不认为有办法解决这个问题。

**2）如何发布整个数据库，而不仅仅是更改**

在文本编辑器中打开 .publish.xml 文件并添加`<AlwaysCreateNewDatabase>true</AlwaysCreateNewDatabase>`.

例如：

```
<?xml version="1.0" encoding="utf-8"?>
<Project ToolsVersion="4.0" xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
  <PropertyGroup>
    <TargetDatabaseName>MyDatabase</TargetDatabaseName>
    <DeployScriptFileName>MyDatabaseProject.sql</DeployScriptFileName>
    <TargetConnectionString>Data Source=localhost\SQL2012;Integrated Security=True;Pooling=False</TargetConnectionString>
    <PublishDependentProjects>False</PublishDependentProjects>
    <ProfileVersionNumber>1</ProfileVersionNumber>
    <AlwaysCreateNewDatabase>true</AlwaysCreateNewDatabase>
  </PropertyGroup>
</Project> 
```

**3) 自动化构建的命令行语法**

首先像往常一样使用 msbuild 构建项目，以便在 bin 中创建 .dacpac 文件。

然后使用`sqlpackage.exe`您的 .publish.xml 文件进行发布：

`C:\Program Files\Microsoft Visual Studio 10.0\Microsoft SQL Server Data Tools\sqlpackage.exe /Action:Publish /SourceFile:C:\[path to my project]\bin\Debug\MyDatabaseProject.dacpac /Profile:C:\[path to my project]\MyDatabaseProject.publish.xml`

请注意，sqlpackage.exe 的路径可能不同。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-05-12T14:47:49.590

我承认，聚会有点晚了，但也许这会帮助其他偶然发现这个讨论的人。我的公司目前正在转向 VS2012，我们遇到了与 Keith 相同的三个问题。我找到了#1 和#2 的解决方法。

对于#1，我使用[AutoHotKey](http://www.autohotkey.com/)来监视发布窗口的存在，并自动单击“创建脚本”按钮。您当然可以让脚本自动单击“发布”按钮。在此示例中，如果发布配置文件不是“XYZ”（我总是更喜欢手动干预生产服务器部署），则继续发送 Alt+G 以生成脚本。

```
#Persistent
SetTimer, ClosePopups, 5000

return

ClosePopups:
if WinExist("Publish Database ")
{
    WinActivate, Publish Database
    WinGetTitle, TitleText, A
    If not TitleText = "Publish Database XYZ.publish.xml" {
        Send, !G
    }
}
return 
```

对于#2，每次我们发布它时，文件名都会增加一个数字后缀，最终我们的部署文件夹中有很多文件。我只是在构建之前使用预构建事件来清除 .sql 和 .txt 文件：

```
if exist "$(ProjectDir)$(OutputPath)*.publish.sql" del $(ProjectDir)$(OutputPath)*.publish.sql
if exist "$(ProjectDir)$(OutputPath)*.txt" del $(ProjectDir)$(OutputPath)*.txt 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-04-06T16:09:22.973

我发现自动化 SSDT 数据库项目部署的最佳方法是使用 msbuild。最初我们使用 VSTSDB 并针对 *.dbproj 文件使用 msbuild。事实证明，部署 sqlproj 文件的参数完全相同。

因为旧的参数列表对我们有用，所以我没有改用 public.xml 文件样式。针对 dbproj 的 vsdbcmd.exe 和 msbuild 有相当多的文档。我会用它作为参考。

这是我们为 FinalBuilder 执行定义的参数列表和执行输出

```
[ MSBuild Project [ C:\xx\xxx\xx\xx\MyProject.sqlproj ] ]
  Configuration : Release
  OutDir : C:\Builds\1\xxxxx\builddefname\Binaries\Release\
  DeployToDatabase : True
  TargetDatabase : ExistingDatabaseName
  TargetConnectionString : Data source=.;Integrated Security=SSPI;**
  Build started 3/23/2012 2:17:08 PM.
  Deployment script generated to:
  C:\Builds\1\xxxx\builddefname_FB\Binaries\Release\MyProject.sql
  Dropping FK_at_lusys_assetCategory_at_lusys_image...
  Creating FK_dcb28374eeabe8e715038984419...
  Creating FK_d82897e4acd966d4b136c242cef...
  Checking existing data against newly created constraints
  Update complete.
  Done Building Project "C:\xxx\xxxxxxx\xxxxxxxxx\MyProject.sqlproj" (Deploy target(s)).
  Build succeeded.
  0 Warning(s)
  0 Error(s) 
```

并将 msbuild 命令行放在一起如下所示：

```
msbuild XXX.sqlproj /target:Deploy /p:Configuration=xxx;OutDir=xxx;DeployToDatabase=True;TargetDatabase=xxxx;TargetConnectionString="xxxxx";AlwaysCreateNewDatabase=True 
```

# android - Matlab/simulink udp 通道

> ID：10014724
> 
> 赞同：1
> 
> 时间：2012-04-04T15:50:11.870
> 
> 标签：android, matlab, udp, simulink

我有一个 Matlab/simulink 日志文件，我想将日志文件发送到我的 android 应用程序。我想构建一个 simulink 模型来将此信息作为 UDP 数据包发送到无线路由器，然后路由器可以将其广播到 Eclipse 或我的平板电脑或其他任何东西。我应该补充一点，android 应用程序需要实时信息（Matlab 日志文件）。

你有什么建议我该怎么做？或者实际上是否可以这样做，因为我是这个领域的新手并且没有太多信息。

我可以用其他方式吗？就像在 matlab 中编写服务器以在 eclipse 中向路由器和客户端发送信息？

我完全糊涂了！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-04T19:28:29.727

[Matlab natively supports ftp protocol](http://www.mathworks.com/help/techdoc/ref/ftpclass.html). [There exists a FTP server for Java](https://stackoverflow.com/questions/1567601/android-ftp-library), which could easily be imported to Android, and can be downloaded [from apache](http://mina.apache.org/ftpserver/). Set your Android device as an FTP server, send data from Matlab to the Android phone, and you're set.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-02-03T13:04:17.190

您可以使用[Simulink Support Package for Samsung GALAXY 设备](http://www.mathworks.com/hardware-support/android-programming-simulink.html)中提供的 UDP 模块将数据从 Simulink 发送到您的 Android 设备。

# qt - Qt否定按钮不起作用

> ID：10014729
> 
> 赞同：2
> 
> 时间：2012-04-04T15:50:20.503
> 
> 标签：qt, symbian, qt4.7

在我的 Qt symbian 应用程序中，我已经覆盖了带有返回的负退出按钮以返回主屏幕，然后再次覆盖它并退出以关闭应用程序，我的应用程序在模拟器上运行良好，但是当我在设备上测试它时显示退出按钮而不是返回，有时它也会显示回来，但如果我两次进入同一页面，它会再次开始显示退出按钮，令人沮丧的部分是应用程序在 Qt 模拟器上运行良好，但在设备上运行良好。有人知道问题是什么吗。我在用

```
back->setSoftKeyRole(QAction::NegativeSoftKey);
this->addAction(back); 
```

在加载屏幕之前越过退出按钮和

```
back->setSoftKeyRole(QAction::NegativeSoftKey);
this->removeAction(back); 
```

返回主窗口时删除后退按钮。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-09T12:28:19.273

创建垂直布局和小部件，您将在滚动区域上添加父类作为该类，例如

```
QVBoxLayout *vlay = new QVBoxLayout(this); 
QWidget *area = new QWidget(this) 
```

并向其添加小部件这将使其成为父类的子类。对我来说很好。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-25T18:34:45.700

我认为`QAction`在这里添加和删除对象是有问题的。您应该尝试重新设计您的应用程序以使用 a[`QStateMachine`](http://qt-project.org/doc/qt-4.8/qstatemachine.html)来处理状态之间的转换。看看[这里](http://qt-project.org/doc/qt-4.8/statemachine-api.html)的介绍性文档。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-27T18:16:38.493

请参阅此[链接](http://www.developer.nokia.com/Community/Wiki/Qt_Softkeys)以获取自定义软键..

```
QAction* myAction= new QAction(tr("My Action"), this);
myAction->setSoftKeyRole(QAction::NegativeSoftKey);
addAction(myAction); 
```

# c - 为 AVL 树生成密钥

> ID：10014735
> 
> 赞同：0
> 
> 时间：2012-04-04T15:50:39.847
> 
> 标签：c, data-structures, avl-tree

我有一个使用 AVL 树快速搜索 IP 地址的大型系统：

```
struct avl_node
{
   struct avl_node *left;
   struct avl_node *right;
   ...
   void *info; /* point to nhlfe_entry describing nexthop */
}

struct nhlfe_entry
{
  u_int32_t nhlfe_ix;
  u_char opcode;
  ...
  struct nhlfe_key key;
}

/* defines a search key. */
struct nhlfe_key
{
  struct in_addr nh_addr;
  u_int32_t oif_ix;
  u_int32_t out_label;
} 
```

所以搜索基于'struct nhlfe_key'，即AVL树中的比较器函数如下所示：

```
static int
mpls_cmp_nhlfe_ipv4_key (void *data1, void* data2)
{
   struct nhlfe_entry *nh1, *nh2;
   struct nhlfe_key *key1, *key2;
   int ret;

   nh1 = (struct nhlfe_entry *) data1;
   nh2 = (struct nhlfe_entry *) data2;

   key1 = (struct nhlfe_key *) nh1->nkey;
   key2 = (struct nhlfe_key *) nh2->nkey;

   ret = memcmp (&key1->nh_addr, &key2->nh_addr, sizeof (struct in_addr));
   if (ret != 0)
     return ret;

   if (key1->oif_ix > key2->oif_ix)
     return 1;
   else if (key1->oif_ix < key2->oif_ix)
     return -1;

   if (key1->out_label > key2->out_label)
     return 1;
   else if (key1->out_label < key2->out_label)
     return -1;

   return 0;
} 
```

现在，我要做的是添加对多个下一跳的支持，即我在 nhlfe_entry 中添加一个链表：

```
struct nhlfe_entry
{
  u_int32_t nhlfe_ix;
  u_char opcode;
  ...
  struct list *nhkey_list;
} 
```

每个'struct list'都是struct listnode，它嵌入'void *data'指针到调用者的私有数据，这就是'struct nhlfe_key'。

所以我的问题是——如何基于列表中的多个元素生成密钥以存储/搜索树中的节点（因为否则现在在引入列表之后，将不可能仅基于*一个* 下一跳地址）。此外，他们同样的问题适用于搜索。

另外，在列表中添加新节点后，是否需要重新构建树，因为我认为此操作会更改键，因此树可能会变得不平衡？（或者正确实现的AVL树自然不需要重建？）

我正在考虑在每个列表节点上生成 CRC，然后进行总结。这可以保证密钥的唯一性吗？（缺点是每当我添加/删除列表节点时，我必须重新生成密钥，从树中删除节点并使用新密钥重新添加）。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-04T23:47:59.473

*我有一个使用 AVL 树快速搜索 IP 地址的大型系统：*

对于大量 IP 地址，您通常需要一个基数树。二叉树可以工作，但您无法使用前缀存储地址范围，例如`10.*`. 如果您没有将它用于任何类似于路由的东西，或者您不需要节省空间将整个子网映射到某些东西。

*所以我的问题是——如何根据列表中的多个元素生成密钥以存储/搜索树中的节点（因为否则现在在引入列表之后，将不可能仅基于一个下一跳来获得密钥地址）。此外，他们同样的问题适用于搜索。*

您的`mpls_cmp_nhlfe_ipv4_key`函数只需比较可能是地址列表的键。显然`(1 2 3)`比较等于`(1 2 3)`。此外，`(1 2 3)`比较大于`(1 2)`，但小于`(1 3)`或`(1 2 4)`。

*另外，在列表中添加新节点后，是否需要重新构建树...*

如果要更新平衡搜索树中的节点以使键发生变化，最好的办法可能是删除它并重新插入它。

可能有优化它的方法。例如，假设一个键发生了变化，但它在树中仍然具有完全相同的后继者和前任者。在这种情况下，它可以就地完成。或者密钥可以以这样一种方式改变，即节点只需要与前任或后继者交换。在尝试这样的技巧之前，我会做对的。

*[a CRC] 可以保证密钥的唯一性吗？*

不，CRC 是一个散列函数。它比被散列的对象具有更少的位，因此多个对象可以散列到相同的 CRC。（例外情况是为一组元素找到“完美散列函数”，但动态数据很少发生这种情况：完美散列函数是为某些静态数据集设计的。）使用散列方法，您可能会很好地使用哈希表。CRC 上的排序关系可能毫无意义。当必须通过键上的排序关系对集合进行排序时，使用二叉搜索树。

# c# - Pass dynamic datamember of type array in WCF

> ID：10014738
> 
> 赞同：3
> 
> 时间：2012-04-04T15:50:49.800
> 
> 标签：c#, wcf

Before you begin sorry for the length of this post...

Does anyone know why I can't pass an array of the class as a dynamic property through WCF ?

I have a ServiceOperationResponse class which is used to pass messages around my solution as shown below.

The message details datamember is a dynamic type allowing any object to be passed simply. This works fine under nearly all circumstances as I can set the ServiceKnownType for each of the WCF server interfaces.

However if I try to pass a ServiceOperationResponse object through WCF when the MessageDetails property is itself an array or list of type ServiceOperationResponse I get the following error:

> The InnerException message was 'Error in line 1 position 576\. Element 'http://schemas.datacontract.org/2004/07/Library:MessageDetails' contains data from a type that maps to the name 'http://schemas.datacontract.org/2004/07/Library:ArrayOfServiceOperationResponse'. The deserializer has no knowledge of any type that maps to this name.

This occurs when I have set the ServiceKnownType to any of the following, ServiceOperationResponse[], List.

Other types of lists or arrays can be passed with no problems, also if I create another property of type ServiceOperationResponse[], i.e. an array of responses, in the main ServiceOperationResponse and populate this instead then all data is properly deserialized. However I would prefer if at all possible not to have to add this property just for 1 particular case.

```
/// <summary>
/// Class used to pass details between services
/// </summary>
[DataContract]
public class ServiceOperationResponse
{
    /// <summary>
    /// the originating hostname or keyname
    /// </summary>
    [DataMember]
    public string HostName { get; set; }

    /// <summary>
    /// the operation name
    /// </summary>        
    public string OperationName { get; set; }

    /// <summary>
    /// the particular message details
    /// </summary>
    [DataMember]
    public dynamic MessageDetails { get; set; }
} 
```

shown below is some sample code that will trigger a failure if I try to pass back from WCF to a client

```
var responseList = new List<ServiceOperationResponse>();
        for (int i = 0; i < 3; i++)
        {
            var responseElement = new ServiceOperationResponse()
            {
                HostName = Environment.MachineName,
                MessageDetails = "this is a test"
            };
          responseList.Add(responseElement);
        }

        var response = new ServiceOperationResponse()
        {
            HostName = Environment.MachineName,
            OperationName = "Get a list of service responses",
            MessageDetails = responseList
        }; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-04T17:58:38.017

WCF 使用合同的概念进行通信。除其他事项外，合同指定了正在传输的数据的形状。这意味着您的运营合同必须具有明确定义的形状；动态（或更准确地说是对象，因为它在元数据中表示）没有明确定义的形状。

您可以通过将 KnownTypeAttribute 添加到 DataContract 类来解决此问题，指定可以传输但未明确包含在合同类定义中的数据类型。但这只有在您提前知道动态属性中可能存在的每个对象的每种可能类型时才有效。

我首先要问为什么你在 DataContract 中有一个动态属性。

# dotnetnuke - Unexpected Error in content staging DNN6 Enterprise

> ID：10014742
> 
> 赞同：0
> 
> 时间：2012-04-04T15:51:00.620
> 
> 标签：dotnetnuke, dotnetnuke-module, dotnetnuke-6

guys! I've got a very strange error when trying to connect two portals.

When I press whatever 'connect portals' or 'test connection' buttons a red error appears sayin' "An unexpected Error has occurred while validating your request". Yikes!

So, I ensured the similar workflow is running on both sites. Next, I've done some debugging and discovered the malfunctioning method in

DotNetNuke.Enterprise.ContentStaging.StagingClientController.cs

`public bool PingServer(string address, int portalId, Guid token) { /*====somecode====*/
client.PairService(request);
/*====somecode====*/
return true; }`

So, the pair service. After some more advanced debugging I've found a root of evil:

The INSERT statement conflicted with the FOREIGN KEY constraint "FK_PortalSettings_Portals". The conflict occurred in database "MyDNNDatabase", table "dbo.Portals", column 'PortalID'. The statement has been terminated. Gosh!

So, I've removed the specified constraint and saw a strange thing in my database. DNN tried to add another LocalServerToken with testing site ID though a targetServerAddress and TargetServerToken with Production site ID were expected to be added.

So, I've deleted a site and created a new one using the template. No luck as I expected.

THe last thing I did was manual adding a targetServerAddress & TargetServerToken in my database. The sites seemed to be connected but when I couldn't authenticate as Host and publishing content caused the same unexpected Error.

Anyone know the damn module so deep?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-05T00:59:30.953

如 DNN 社区交流中所述，请打开支持票以解决此问题。这就是 PE 和 EE 的付费支持；）

# linux - How to run Jprofiler from Windows machine to Remote Linux JVM

> ID：10014744
> 
> 赞同：8
> 
> 时间：2012-04-04T15:51:12.373
> 
> 标签：linux, jprofiler

Kindly let me know how to run Jprofiler from Windows machine to Remote Linux JVM.

Thanks a lot in advance.

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-15T14:15:06.520

1) 进入[下载页面](http://www.ej-technologies.com/download/jprofiler/files.html)，下载 .tar.gz 发行版并在远程 Linux 机器上解压。

2) 在远程 Linux 机器上，启动命令行实用程序`bin/jpintegrate`，然后按照命令行向导中的步骤操作。

3) 将生成的 JProfiler 配置文件传输到本地 Windows 机器。

4) 在本地 Windows 机器上，启动 JProfiler GUI 并使用 Session->Import Session Settings 导入配置文件

5) 在远程 Linux 机器上启动已分析的 JVM，并在 Windows 机器上的 JProfiler GUI 中启动导入的会话。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2019-09-21T14:02:48.020

**用于使用远程机器 JVM（Centos 7）远程连接到 Windows 上的 jprofiler**

1.  在 centos 上下载（.tar.gz）Linux 版本的 jprofiler。Windows 和远程机器 jprofiling 代理的版本相同。如果机器人不是同一版本，那么它不会在 Windows 上使用 jprofiler 创建。

2.  解压 .tar.gz 文件。

    tar xvzf 文件夹名称

3.  转到 /bin 路径。

    cd 文件夹名称/bin

4.  运行以下命令以启用分析代理以连接特定端口上的 JVMTI 数据。

    ./jpenable

5.  在运行上述命令时，它会给出在 JVM 上运行的所有进程列表。选择分析所需的进程。（例如，让我必须从 8 个进程中流式传输第 6 个进程。然后输入 6）。

6.  选择 GUI 模式或离线模式。输入 1。（旧版本不存在此选项）。

7.  输入您要侦听的端口。（例如 33668）

8.  现在您的 VM 已准备好从 Windows jprofiler 连接。

* * *

**窗口 jprofiler 上的连接设置**

1.  点击开始中心。

2.  选择一个新的会话。

3.  单击附加并选择“附加到远程计算机”单选按钮。

4.  从下拉列表中设置 ssh 隧道。

5.  光滑的编辑按钮并配置直接 ssh 隧道连接。

6.  单击下一步并提供 VM 凭据。

7.  手动配置分析端口。它应该在配置分析代理时定义。

16.点击完成。

17.选择“确定”按钮并输入您通过邮件收到的密钥。

18.  如果凭据正确，将显示以下提示。点击“配置”按钮。选中“CPU 数据”、“调用跟踪器”和“分配堆栈”复选框。单击确定。

19.  单击“确定”按钮。恭喜！！现在您的远程 VM 已与您的 Windows jprofiler 连接。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2017-03-07T06:04:18.590

对于远程连接到 jprofiler，您可以按照以下步骤操作：

1.  下载 jprofiler 的 linux 版本。
2.  安装在linux系统上。
3.  转到文件夹 bin 并运行 ./jpenable。按照向导选择要分析的 jvm 的进程 ID。之后它会给你一个端口号。
4.  在 Windows 等本地机器上安装 jprofiler。
5.  在开始中心菜单中选择快速附加并选择另一台计算机。在步骤“3”中输入主机地址和端口号，然后您可以远程连接到 jprofiler

# io - The correct way to use FileVisitor in java

> ID：10014746
> 
> 赞同：6
> 
> 时间：2012-04-04T15:51:19.373
> 
> 标签：io, java-7, filevisitor

I am trying to step through an entire path and its single layer of sub directories. For each file, I need to read five data fields and output them to a delimited text file. I'm able to read from a **single** text file and validate my output on screen; after that I'm stuck. I cannot seem to to find the right parameters for FileVisit. Some specific questions are comments in my code posted below. And although I'm no nearly that far yes, I'd like to get some idea for writing to an output file, namely whether the place I wish to put it is the most logical one.

I've reviewed the [https://stackoverflow.com/questions/9913/java-file-io-compendium](https://stackoverflow.com/questions/9913/java-file-io-compendium) and JavaDocs' info on the File Visitor
[http://docs.oracle.com/javase/7/docs/api/index.html?java/nio/file/FileVisitor.html](http://docs.oracle.com/javase/7/docs/api/index.html?java/nio/file/FileVisitor.html) . However, I'm still not able to get FileVisitor working properly.

@Bohemian suggested changing `interface` to `class` which I've done.

```
 import java.nio.files.*;
 public class FileVisitor<T> 
 {
      Path startPath = Paths.get("\\CallGuidesTXT\\");
      Files.walkFileTree(startPath, new SimpleFileVisitor(startPath))
      \\             ^^^^^^    
      \\ errors out, <identifier expected>          
          { 
          @Override
          public FileVisitResult visitFile(Path file, BasicFileAttributes attrs)
              throws IOException
          {
              Files.list(file);
              return FileVisitResult.CONTINUE;
          }
        // do my file manipulations here, then write the delimited line 
        // of text to a CSV fle...is this the most appropriate place for that 
        // operation in this sample? 
      }  
 } 
```

SSCCE below...but comments in the version above point to specific questions I'm having.

```
 import java.nio.*;
 import java.util.*;
 public class FileVisitor<T>
 {
    Path startPath = Paths.get("\\CallGuidesTXT\\");
 }
 Files.walkFileTree(startPath, new SimpleFileVisitor(startPath)  {
      @Override
      public FileVisitResult visitFile(Path file, BasicFileAttributes attrs)
          throws IOException {
          Files.list(file);
          return FileVisitResult.CONTINUE;
      } 
 }); 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-04-04T16:41:35.457

我对 Java 有点生疏，但我认为你要去的地方有一个粗略的想法：

```
import java.nio.files.*;
public class MyDirectoryInspector extends Object 
{
    public static void main(String[] args) {
        Path startPath = Paths.get("\\CallGuidesTXT\\");
        Files.walkFileTree(startPath, new SimpleFileVisitor<Path>() { 
            @Override
            public FileVisitResult visitFile(Path file, BasicFileAttributes attrs)
                throws IOException
            {
                String firstLine = Files.newBufferedReader(file, Charset.defaultCharset()).readLine();
                System.out.println(firstLine);
                return FileVisitResult.CONTINUE;
            }
        }); // <- you were missing a terminating ");"
    }
} 
```

那应该遍历目录并将每个文件的第一行打印到标准输出。我从 1.6 开始就没有接触过 Java，所以 JDK7 的东西对我来说也有点新。我认为您对什么是类和什么是接口感到困惑。在我的示例中，我们从一个名为 MyDirectoryInspector 的基本类开始，以避免混淆。给我们一个程序入口点就足够了，这是我们开始检查的主要方法。对 Files.walkFileTree 的调用需要 2 个参数，一个开始路径和一个我已内联的文件访问者。（如果您不习惯这种风格，我认为内联可能会让某些人感到困惑。）这是一种在您希望使用它的地方定义实际类的方法。您还可以单独定义 SimpleFileVisitor 并为您的调用实例化它，如下所示：

```
import java.nio.files.*;
public class MyDirectoryInspector extends Object 
{
    public static void main(String[] args) {
        Path startPath = Paths.get("\\CallGuidesTXT\\");
        Files.walkFileTree(startPath, new SimpleFileVisitor<Path>());
    }
}

public class SimpleFileVisitor<Path>()) { 
            @Override
            public FileVisitResult visitFile(Path file, BasicFileAttributes attrs)
                throws IOException
            {
                String firstLine = Files.newBufferedReader(file, Charset.defaultCharset()).readLine();
                System.out.println(firstLine);
                return FileVisitResult.CONTINUE;
            }
        } 
```

如果您刚刚开始，将所有事情分开可能更有意义。在没有内联的情况下定义你的类，一步一步来，并确保你单独理解每一部分。我的第二个示例为您提供了 2 个单独的部分，一个自定义文件访问器，可用于打印它访问的每个文件的第一行，以及一个将其与 JDK Files 类一起使用的程序。现在让我们看看另一种省略语法的方法：

```
import java.nio.files.*;
public class MyDirectoryInspector extends Object 
{
    public static void main(String[] args) {
        Path startPath = Paths.get("\\CallGuidesTXT\\");
        Files.walkFileTree(startPath, new SimpleFileVisitor());
    }
}

public class SimpleFileVisitor()) { 
            @Override
            public FileVisitResult visitFile(Object file, BasicFileAttributes attrs)
                throws IOException
            {
                String firstLine = Files.newBufferedReader((Path)file, Charset.defaultCharset()).readLine();
                System.out.println(firstLine);
                return FileVisitResult.CONTINUE;
            }
        } 
```

在不使用泛型的情况下，您必须将文件参数声明为 Object 类型，并在以后选择使用它时对其进行转换。通常，您不想用类定义替换接口定义或混淆两者，因为它们用于完全不同的目的。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-04-04T15:55:11.493

Java`interface`不能**有**任何实现（即代码）——只有方法*签名*。

尝试更改`interface`为`class`：

```
public class FileVisitor<T> {
    ... 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-04T16:11:42.577

现在回答您修改后的帖子...

你有一个错误的地方括号：

```
Files.walkFileTree(startPath, new SimpleFileVisitor(startPath) { 
      @Override
      public FileVisitResult visitFile(Path file, BasicFileAttributes attrs)
          throws IOException {
          Files.list(file);
          return FileVisitResult.CONTINUE;
      }
  }); 
```

之后我移动了括号`new SimpleFileVisitor(startPath)`以包含该`visitFile`方法。您在这里拥有的是一个[匿名类](http://docstore.mik.ua/orelly/java-ent/jnut/ch03_12.htm)- 您可以在其中“即时”提供实现。

# javascript - jQuery arrange li order by clicking on a link

> ID：10014752
> 
> 赞同：7
> 
> 时间：2012-04-04T15:51:30.237
> 
> 标签：javascript, jquery, html, sorting

Need to change li position by clicking to move up or to move down.

```
<div>
  <ul>
    <li>Item1  <a class="moveUp">Move Up</a> <a class="moveDown">Move Down</a></li>
    <li>Item2  <a class="moveUp">Move Up</a> <a class="moveDown">Move Down</a></li>
    <li>Item3  <a class="moveUp">Move Up</a> <a class="moveDown">Move Down</a></li>
    <li>Item4  <a class="moveUp">Move Up</a> <a class="moveDown">Move Down</a></li>
    <li>Item5  <a class="moveUp">Move Up</a> <a class="moveDown">Move Down</a></li>
  </ul>
</div> 
```

So what should happen here, for example, if we click Move up on Item2, the Item 2 will move up before Item 1.

I tryed to do like this, but it doesn't work:

```
$(".moveUp").click(function () {
    var thisLine = $(this).parent();
    var prevLine = thisLine.prev();
    prevLine.insertAfter(thisLine);
}); 
```

Hope some one can help me...

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-04T15:55:44.003

尝试这个：

```
$(".moveUp").click(function () {
    var thisLine = $(this).parent();
    var prevLine = thisLine.prev();
    prevLine.before(thisLine);
});

$(".moveDown").click(function () {
    var thisLine = $(this).parent();
    var prevLine = thisLine.next();
    prevLine.after(thisLine);
}); 
```

[在这里](http://jsfiddle.net/qGFfU/)工作 jsFiddle 。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-04T15:56:31.553

尝试这个。

```
$(".moveUp").click(function () {
    var $parent = $(this).parent();
    $parent.prev().before($parent);
});
$(".moveDown").click(function () {
    var $parent = $(this).parent();
    $parent.next().after($parent);
}); 
```

工作演示 - [http://jsfiddle.net/vQmHU/](http://jsfiddle.net/vQmHU/)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-04T16:12:18.537

这应该有效，并且当您尝试在顶部向上或在底部向下移动元素时，也不会将元素移动到 UL 之外：

```
$('.moveUp').click(function(){
    var liItem = $(this).parent();
    if (liItem.prev().is('li'))
    {
        liItem.insertBefore(liItem.prev())
    }
});

$('.moveDown').click(function(){
    var liItem = $(this).parent();
    if (liItem.next().is('li'))
    {
        liItem.insertAfter(liItem.next())
    }
}); 
```

工作示例：http: [//jsfiddle.net/BDecp/](http://jsfiddle.net/BDecp/)

此外，您的代码应该用这个包装：

```
$(document).ready(function () {
    //Code Here
}); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-14T16:05:35.507

这仅重新排列列表项：

```
$(".moveUp").click(function () {
  var $parent = $(this).parent().closest("li");
  $parent.prev().before($parent);
});

$(".moveDown").click(function () {
  var $parent = $(this).parent().closest("li");
  $parent.next().after($parent);
}); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-04T16:08:41.143

[http://jsfiddle.net/j7xtS/2/](http://jsfiddle.net/j7xtS/2/)

```
$('ul').on('click', 'a', function(){
    var $this = $(this),
        $li = $this.parent();

    if ($this.hasClass('moveUp') &&  $li.prev().length>0){
        $li.prev().before($li[0]);
    }
    else if ($this.hasClass('moveDown') && $li.next().length>0){
        $li.next().after($li[0]);
    }
});​ 
```

# eclipse - 您在哪里可以找到 JDBCProvider 接口？

> ID：10014762
> 
> 赞同：0
> 
> 时间：2012-04-04T15:52:04.130
> 
> 标签：eclipse, xpages, lotus-domino

作为我正在进行的 JDBC/Oracle 传奇的一部分，我请求了我们的一位 Java/JDBC 专家的帮助，并在通过我的最后一个问题“[对于 XPages 中的 JDBC，服务器如何知道连接信息？](https://stackoverflow.com/questions/9979248/for-jdbc-in-xpages-how-does-the-server-know-the-connection-information) ”收到更多输入后，我们开始了在为我的 ojdbc14.jar 文件创建插件时。我们创建了插件并尝试编译它。它抱怨找不到 JDBCProvider 接口。我的问题是我在哪里可以找到这个？这部分是服务器上的扩展库文件还是完全不同的东西？

与往常一样，我们将不胜感激任何帮助。

谢谢，

乔丹

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-04T20:17:07.327

您需要`com.ibm.commons.Extension`在“扩展点”对话框中进行选择，然后将类型设置为`com.ibm.commons.jdbcprovider`. 将类设置为您的 JDBC 驱动程序提供程序类（`com.ZetaOne.JDBC.drivers.DB2.DB2DriverProvider`例如命名），我在下面提供了示例代码，如下所示（针对您的特定驱动程序定制等）

```
package com.ZetaOne.JDBC.drivers.DB2;

import java.sql.Driver;
import java.sql.SQLException;

import com.ibm.commons.jdbc.drivers.IJDBCDriverAlias;
import com.ibm.commons.jdbc.drivers.JDBCProvider;

public class DB2DriverProvider implements JDBCProvider {
    public DB2DriverProvider() {
    {

    public Driver loadDriver(String className) throws SQLException {
      if(classNmae.equals(com.ibm.db2.jcc.DB2Driver.class.getName())) {
        return new com.ibm.db2.jcc.DB2Driver();
      }
      return null;
    }
} 
```

假设您已完成插件所需的所有其他操作，您应该能够导出/创建更新站点并安装驱动程序。

顺便说一句，您将能够在我们即将出版的书“XPages 扩展库：下一代 XPage 控件的分步指南”中阅读如何在 ExtLibX 中设置和部署和使用 JDBC 包 - 可在亚马逊预订在[http://www.amazon.com/XPages-Extension-Library-Step---Step/dp/0132901811](https://rads.stackoverflow.com/amzn/click/com/0132901811)

希望这可以帮助。

# sql-server - SQL2008 Express Edition: two instances on same computer?

> ID：10014765
> 
> 赞同：0
> 
> 时间：2012-04-04T15:52:14.457
> 
> 标签：sql-server, sql-server-2008-express

Can we installed two instances of Express edition? I have one instance installed and when I try to install 2nd one, Product Key page/optionbs is grayed out (Specify Free Eidtion / Enter Prod. Key)

Is it by design or due to something I am missing here? Thanks.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-04T16:01:54.890

是的，您可以为多个实例安装 Sql Express。

要安装新实例，请确保执行自定义安装并为新实例设置不同的名称。

可以在[此处](http://msdn.microsoft.com/en-us/library/cc645993%28v=sql.100%29.aspx)找到完整的 Sql Express 功能。如您所见，Multi-Instance support 设置为 YES

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-04T16:01:05.780

SQL Server Express 实例数的最大限制是同一台计算机上的 16 个。为了识别它们，这些实例必须被唯一命名。

# css - CSS - 使外部 背景扩展到内部 宽度

> ID：10014766
> 
> 赞同：0
> 
> 时间：2012-04-04T15:52:18.223
> 
> 标签：css, background, expand

看看这个简单的页面：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
   <style type="text/css">
      body {padding:20px;}
      #outer {background-color:#ff0000;}
      #inner {width:500px; border:1px solid #0000ff;}   
   </style>
</head>
<body>
   <div id="outer">
      <div id="inner">
         <p>Why the hell outer div bg color does not expand?</p>
         <p>Why the hell outer div bg color does not expand?</p>
         <p>Why the hell outer div bg color does not expand?</p>
      </div>
   </div>
</body>
</html> 
```

**`<div id="inner">`**当浏览器页面缩小到（即`500px`本例中）**的宽度以下，****然后向右滚动浏览器页面时**，您会看到内部 div 的右侧不再有红色背景：

![在此处输入图像描述](../Images/ace73fb2916fad4aeace7ac89eb424dc.png)

**您知道如何修复背景`outer <div>`以使其永远不会缩小到`inner <div>`宽度以下吗？？？**（我仍然需要将`outer div`背景扩展到完整的浏览器宽度，因此不能设置为`width:500px;`太多）。

**编辑：**换句话说，我希望看到外部 div 的红色背景颜色来填充内部 div 的总 500px 宽度，而不是缩小到浏览器大小，使内部 div 的右侧没有红色背景。为了做到这一点，我不能简单地将外部 div 设置为 500px，因为当浏览器展开时，我也需要红色背景颜色来展开。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-04T16:20:22.713

将此添加到您的CSS

```
#outer {background-color:#ff0000; min-width: 500px;} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-04T16:04:24.833

那是因为您的内部`div`从外部 div 溢出，而不是使其扩展。添加`overflow: hidden`到您的外部`div`，将通过隐藏溢出的内部部分来防止这种情况发生`div`。

您可以在此处查看该行为的演示：http: [//jsfiddle.net/p6BQg/](http://jsfiddle.net/p6BQg/)

更多关于 CSS 溢出属性的信息：http: [//www.w3schools.com/cssref/pr_pos_overflow.asp](http://www.w3schools.com/cssref/pr_pos_overflow.asp)

**编辑：**要保持内部 div 的背景颜色，请参阅此示例：http: [//jsfiddle.net/p6BQg/1/](http://jsfiddle.net/p6BQg/1/)

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-04-04T15:58:53.957

`body { padding: 20px }`

导致您看到的问题。删除它将防止您所说的“缩小”。

例如：http: [//jsfiddle.net/MvJTa/](http://jsfiddle.net/MvJTa/)

# html - Why can't I center my menubar?

> ID：10014770
> 
> 赞同：0
> 
> 时间：2012-04-04T15:52:20.667
> 
> 标签：html, css, position, center, menubar

I'm pretty new to HTML and CSS. I'm making a menu bar horizontal and I can't seem to align it to center of screen. I have tried `margin:0 auto;` and `<body align=center>` but neither seems to work.

Here is my code:

```
<html>
<head>

<style>

#menu {
margin:0 auto;
float:left;
list-style:none;
padding:0;
border-top:1 solid #ccc;
border-left:1 solid #ccc;
border-bottom:1 solid #ccc;
}

#menu li {
float:left;
background-color:#f2f2f2;
}

#menu li a {
display:block;
padding:10px 80px;
text-decoration:none;
color:#069;
border-right:1px solid #ccc;
font-weight:bold;
}   

#menu li a:hover {
color:#c00;
background-color:#fff;
}

</style>

</head>

<body>

<ul id="menu">
<li><a href="#">Home</a></li>
<li><a href="#">Gallery</a></li>
<li><a href="#">Contact</a></li>
<li><a href="#">FAQs</a></li>
<li><a href="#">Donate</a></li>
</ul>

</body>
</html> 
```

As you can see, I'm using `margin:0 auto;`, but it doesn't work.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-04T16:01:02.160

你有`float`元素。除非您的容器被视为块或内联块，否则浮动元素将不会遵循该居中。

要达到预期的结果，您需要执行类似于[此示例](http://jsfiddle.net/j9Wcn/)中的操作。

通过添加容器、居中边距并在其上使用`display: inline-block`，`#menu`它们将像正常内容一样居中。请注意，这在 IE 中可能不起作用，在这种情况下，您应该添加一行`*display: inline;`.

[示例](http://jsfiddle.net/j9Wcn/)| 代码

HTML

```
<div class='container'>
    <ul id="menu">
        <li><a href="#">Home</a></li>
        <li><a href="#">Gallery</a></li>
        <li><a href="#">Contact</a></li>
        <li><a href="#">FAQs</a></li>
        <li><a href="#">Donate</a></li>
    </ul>
</div> 
```

CSS

```
.container{
    text-align: center;
    width: auto;
    margin: 0 auto;
}

#menu {
    margin:0 auto;
    display: inline-block;
    list-style:none;
    padding:0;
    border-top:1 solid #ccc;
    border-left:1 solid #ccc;
    border-bottom:1 solid #ccc;
}

#menu li {
    float: left;
    background-color:#f2f2f2;
}

#menu li a {
    display:block;
    padding:10px 10px;
    text-decoration:none;
    color:#069;
    border-right:1px solid #ccc;
    font-weight:bold;
}   

#menu li a:hover {
    color:#c00;
    background-color:#fff;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-04T15:56:11.917

如果您想在其父元素（在本例中为主体）内居中，请给您的菜单一个宽度。此外，删除您的浮动 - 如果您将其浮动到一个方向或另一个方向，它不会居中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-04T16:01:10.617

你需要给你一个宽度`menu`并删除`float:left`

例如。

```
#menu {
margin:0 auto;    
list-style:none;
padding:0;
border-top:1 solid #ccc;
border-left:1 solid #ccc;
border-bottom:1 solid #ccc;
width:900px;
display:block;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-04T15:56:55.823

你可以给菜单一个宽度`width: 400px;`或者你想要的宽度。然后，您可以将左右边距设置为自动`margin-left: auto; margin-right: auto;`

# c# - 我应该如何使用 velX,velY 信息来获取当前帧和前一帧之间的 X 和 Y 位移？

> ID：10014776
> 
> 赞同：0
> 
> 时间：2012-04-04T15:53:11.807
> 
> 标签：c#, c#-4.0, opencv, opticalflow

我在 C# 中使用 openCV 库中的 Lucas Kanade 光流算法；有一系列帧，我想在每两个帧中找出什么是光流并将其显示在图片框中。

我可以从以下函数中获取 velX 和 velY：

```
Emgu.CV.OpticalFlow.LK(imGrayCurrent, imGrayNext, windSize, velX, velY); 
```

现在，我应该如何使用这两个来显示两个帧之间的流？或者换句话说，我应该如何获得像素的位移？

肿瘤坏死因子

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-10T21:24:12.197

一种常见的方法是使用 HSV 到 RGB 的转换，请参阅[Middlebury Flow Dataset](http://vision.middlebury.edu/flow/)。所以：

1.  将运动向量转换为极坐标：

    长度 = sqrt(velx² + vely²)

    angle = acos(vely / length) [注意额外检查例如无穷大]

2.  将角度归一化为 [0,360]（对于 OpenCV，或 [0,1]，具体取决于您稍后使用的函数）并将长度归一化为 [0,1]。创建一个 hsv 空间（具有第一个通道 H（色调）、第二个通道 S（饱和度）和第三个通道 V（值）的 3 通道图像）并设置：H = 角度、S = 长度和 V = 1。

3.  将 HSV 颜色空间转换为 RGB，例如使用 cv::cvtColor(hsv, rgb, HSV2BGR);

生成的图像现在显示运动矢量场 (velx,vely)，其中颜色决定运动的方向，饱和度决定运动的长度或速度。

# android - 在Android中的自定义视图上添加按钮

> ID：10014780
> 
> 赞同：6
> 
> 时间：2012-04-04T15:53:26.643
> 
> 标签：android, button, view

我有以下课程

```
public class GameActivity extends Activity {
   @Override
   public void onCreate(Bundle savedInstanceState) {
      super.onCreate(savedInstanceState);
      View gameView = new GameView(this);
      setContentView(gameView);
   }
} 
```

现在我想在我的 GameView 类中添加一个 Button。

```
public GameView(Context context) {
        super(context);
// Code ...
} 
```

我在玩游戏时需要这个按钮，所以它应该在我正在绘制的所有其他画布的前面。
我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-04T16:01:36.623

你想创建一个新按钮吗？

```
Button b = new Button(context);
b.setLayoutParams(new LayoutParams(LayoutParams.WRAP_CONTENT, 
                                   LayoutParams.WRAP_CONTENT)); 

gameView.addView(b); 
```

用作简单视图`ViewGroup`的`GameView`父级

```
ViewGroup gameView = new GameView(this);

public class GameView extends ViewGroup { //... 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-04-04T16:57:35.583

```
View gameView = new GameView(this); 
```

用下面的行替换上面的行::

```
View gameView = new GameView(this).createView(); 
```

现在在游戏视图中使用按钮等创建视图。

```
 public class GameView extends View {
    private Activity _activity;
    public GameView (Activity _activity) {
        super(_activity);
        // TODO Auto-generated constructor stub
        this._activity = _activity; 
    }
public View createView(){
        LinearLayout l = new LinearLayout(_activity);
        l.setOrientation(LinearLayout.VERTICAL);
        Button btn = new Button(_activity);
        btn.setId(1);
            btn.setText("btn"+(i+1));
        l.addView(btn);
        return l;
    }
} 
```

试试这个工作代码:::

# .net - 使用内联对象创建减少 .Net 代码

> ID：10014781
> 
> 赞同：0
> 
> 时间：2012-04-04T15:53:32.607
> 
> 标签：.net, vb.net, visual-studio-2010

我已经设法为此编写了几行代码

```
For Each gal In galleries
   With New HtmlGenericControl("div")
                .ID = gal.Header
                .Controls.Add(New HtmlImage() With {.Src = "http://p.com/pic.jpg"})

                galleryContent.Controls.Add(**Me**)
   End With
Next 
```

我找不到任何地方如何引用我当前正在**使用**的对象以将控件添加回“galleryContent”-使用普通`me`会使整个Web服务器崩溃...哎呀。

使用并没有提供仅使用的短手`.` - 但它使用唯一的方法来做到这一点？我很期待某种`.Me` 或类似的东西`this`

有任何想法吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-04T16:00:56.503

你不能。至少不是那样。

试试这个：

```
For Each gal In galleries 
   Dim obj as New HtmlGenericControl("div") 
   With obj
        .ID = gal.Header 
        .Controls.Add(New HtmlImage() With {.Src = "http://p.com/pic.jpg"}) 

        galleryContent.Controls.Add(ojb) 
   End With 
Next 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-04T16:23:18.687

Mystere Man 是对的，但想想看……这会影响代码的可读性。

“阅读代码的频率远高于编写代码的频率，因此请做好相应的计划”

我建议避免在 VB 中使用“With”……除非你真的“必须”。

希望能帮助到你。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-04T15:58:18.843

您可以执行以下操作：

```
For Each gal in galleries
    galleryContent.Controls.Add(New HtmlGenericControl("div") With { .ID = gal.Header })
    galleryContent.Controls[galleryContent.Controls.Count - 1].Controls.Add(New HtmlImage() With {.Src = "http://p.com/pic.jpg"})
Next 
```

但这纯粹是为了减少线路。它严重降低了可读性，因此在任何正常情况下，您都不应该仅仅以减少代码行为目标。可读性远比“行效率”重要。

# excel - Excel - 计数（）

> ID：10014782
> 
> 赞同：0
> 
> 时间：2012-04-04T15:53:33.303
> 
> 标签：excel, excel-formula

我在使用 excel 函数 Countif 时遇到问题。

我有 2 列 A 和 B，它们应该包含（几乎）相同的条目 - 这是我正在测试的内容，我需要知道哪些条目不同。顺序无所谓。

列实际上是股票代码，看起来像这样 [http://pastebin.com/zHdJ5ndp](http://pastebin.com/zHdJ5ndp)

好的，所以我使用 countif 来识别不在 A 列中的 B 列条目。

```
Countif(A:A;B1)
Countif(A:A;B2)
... 
```

结果是一列全为零，这是不正确的。

其他简单的测试，如

```
a a 1
b b 1
c c 1
d d 1
e e 1
f f 1
g g 2
g h 0 
```

工作就好了！

我在这里做错了什么？

提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-07T12:17:00.587

您确定 A 列和 B 列中的数据相同（没有多余的空格等）吗？

# javascript - 分数 - 显示分数

> ID：10014783
> 
> 赞同：0
> 
> 时间：2012-04-04T15:53:33.983
> 
> 标签：javascript, jquery, html

[http://jsfiddle.net/q8P7Y/](http://jsfiddle.net/q8P7Y/)

我在最后显示最终分数时遇到了问题，我有很多方法可以做到，但我不确定哪种方法最好。

如您所见，下一个按钮只是显示/隐藏 div 而不是页面。分数是一个 id，所以显然只出现一次，它在显示/隐藏之外。

我将如何隐藏最后一个 div 上的 id 并在结尾段落中显示分数？

我想过将分数跨度更改为一个名称，然后将分数放在除最后一个以外的每个 div 中，但是即使使用时分数也没有更新

```
document.getElementsByName("score").innerHTML = score; 
```

代替

```
document.getElementById("score").innerHTML = score; 
```

但没有运气。

关于如何解决这个问题的任何想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-04T16:04:19.713

为什么不简单地更新两个字段，使用 2 个不同的 id？我的意思是，最后一页中的分数摘要可能类似于

```
<table class="widthOneHundredPercent">
  <p>Your score is:<span id="finalScore"></span></p>
</table> 
```

你可以在每次更新总是可见的时更新它，就像这样

```
$("#score").html(score);
$("#finalScore").html(score); 
```

[您可以在此处](http://jsfiddle.net/q8P7Y/3/)找到工作示例

它回答了你的问题吗？

**编辑：**

您还可以使用更短的方法来更新这两个值：

```
$("#score, #finalScore").html(score); 
```

**Edited2：** 对于隐藏较高分数部分（您称为 scoreBoard）的问题，对于您的最后一个“下一步”按钮，请使用以下代码：

```
<input type="button" value="next" onclick="$('#scoreBoard').hide();pagechange(3,4); scrollToTop(); "/> 
```

您可以在[此处找到工作示例](http://jsfiddle.net/q8P7Y/10/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-04T16:06:06.217

只需将您的 HTML 更改为：

```
<p>Your score is: <span id="finalscore"></span></p> 
```

和你的javascript：

```
$("#score").html(score);
$("#finalscore").html(score); 
```

要隐藏最后一页顶部的分数，请更改：

```
 <input type="button" value="next" onclick="pagechange(3,4); scrollToTop();"/></center> 
```

到：

```
 <input type="button" value="next" onclick="pagechange(3,4); scrollToTop(); hideScoreBoard();"/></center> 
```

然后添加这些做你的javascript：

```
function hideScoreBoard() {
  $("#scoreBoard").hide();
}

function scrollToTop() {
} 
```

注意我添加了一个空`scrollToTop()`来停止错误，以便上述更改起作用。

# iphone - 有没有人创建一个垂直的 UIToolBar？还是某种带有 UIButtons 的垂直菜单？

> ID：10014789
> 
> 赞同：1
> 
> 时间：2012-04-04T15:53:47.033
> 
> 标签：iphone, objective-c, ios, xcode, uitoolbar

我正在尝试创建一个垂直菜单（在屏幕左侧），我可以使用手势识别器显示和隐藏它。

我发现了一个与此类似的帖子，它略有帮助，但它所做的只是将 UIToolBar 旋转到垂直位置而不改变宽度或位置。

如果有人成功地创建了类似的东西并愿意提供帮助，我将不胜感激！

另外，如果有人能指出我正确的方向，可能会指向一些示例代码，我也希望如此。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-04T16:04:29.637

您可以`UIToolBar`通过应用 90 度旋转变换来做到这一点，然后将所有图标旋转 90 度以匹配 - 您只需调整`UIToolBar`框架即可更改宽度和位置。但是，您需要创建自己的工具栏来执行此操作，而不是使用通过导航控制器获得的内置工具栏。

另一种选择是简单地自己滚动：这将允许您进行更多定制，因此也许是更好的选择。有许多不同类型的第三方实现，其中一些基于当前的 Facebook 应用程序侧边栏，一个开始寻找的好地方是[http://cocoacontrols.com](http://cocoacontrols.com) - 它们的质量各不相同。

另一方面，推出自己的产品并不太难，因此这是一个不错的选择。

# delphi - Delphi 自定义 TTreeNode

> ID：10014791
> 
> 赞同：2
> 
> 时间：2012-04-04T15:53:50.417
> 
> 标签：delphi, treeview, treenode

我正在尝试制作我的自定义 TTreeNode 类

例如

```
TCustomTreeNode = class(TTreeNode)
  private
  public
    Comment:string;
  end; 
```

我在树视图中创建并添加节点，如下所示：

```
var
  NewCustomTreeNode:TCustomTreeNode;
begin
  NewCustomTreeNode:= TCustomTreeNode.Create(TreeView.Items);
  NewCustomTreeNode.Comment:='blqblq';
  TreeView.Items.AddChild(NewCustomTreeNode,'NodeText'); 
```

当我尝试访问自定义创建的树节点错误弹出。例如我这样做：

```
TCustomTreeNode(TreeNode).Comment:='asdadssadas'; 
```

请帮忙

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-04-04T16:00:08.197

您的代码的问题是调用`AddChild`导致树视图创建一个新节点。而且由于您没有告诉树视图创建子类的节点，因此它创建了一个普通的`TTreeNode`. 然后，当您尝试将其转换为 a`TCustomTreeNode`时，世界就结束了。

您需要使用该`OnCreateNodeClass`方法来确保树视图能够创建新节点。像这样：

```
type
  TCustomTreeNode = class(TTreeNode)
  protected
    procedure Assign(Source: TPersistent); override;
  public
    Comment: string;
  end;

procedure TCustomTreeNode.Assign(Source: TPersistent);
begin
  if Source is TCustomTreeNode then
    Comment := TCustomTreeNode(Source).Comment;
  inherited;
end;

procedure TForm1.FormCreate(Sender: TObject);
var
  NewNode: TCustomTreeNode;
begin
  NewNode := TreeView1.Items.Add(nil, 'Node1') as TCustomTreeNode;
  NewNode.Comment := 'A comment';
  NewNode := TreeView1.Items.Add(nil, 'Node2') as TCustomTreeNode;
  NewNode.Comment := 'Another comment';
end;

procedure TForm1.TreeView1Click(Sender: TObject);
var
  Node: TCustomTreeNode;
begin
  Node := TreeView1.Selected as TCustomTreeNode;
  if Assigned(Node) then
    ShowMessage(Node.Comment);
end;

procedure TForm1.TreeView1CreateNodeClass(Sender: TCustomTreeView; var NodeClass: TTreeNodeClass);
begin
  NodeClass := TCustomTreeNode;
end; 
```

我不能声称自己是世界上最伟大的 Delphi 树视图专家，但根据我的经验，您永远不会自己创建树节点。您应该始终调用其中一种`AddXXX`方法`TTreeView.Items`来创建新节点。

# objective-c - 在 Xcode、Objective-C 和 Sqlite3 中查找表名

> ID：10014792
> 
> 赞同：0
> 
> 时间：2012-04-04T15:53:59.613
> 
> 标签：objective-c, xcode, sqlite, compilation

我必须从已编译的语句中找到一个表名（由`sqlite3_prepare_v2`sqlite3 库的方法返回）。

我不能使用该方法`const char *sqlite3_column_table_name(sqlite3_stmt*,int);`，因为此方法需要使用 option 编译的 dylib `[SQLITE_ENABLE_COLUMN_METADATA]`。

我想知道如何使用该选项重新编译 dylib（我可以在哪里找到要编译的代码以及如何使用哪个命令和标志来编译？），或者是否存在另一种方法来细化表名。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-04T16:18:40.700

如果您知道您的语句可能构建的查询类型，您可以使用此方法，

```
/*
** CAPI3REF: Retrieving Statement SQL
**
** ^This interface can be used to retrieve a saved copy of the original
** SQL text used to create a [prepared statement] if that statement was
** compiled using either [sqlite3_prepare_v2()] or [sqlite3_prepare16_v2()].
*/
SQLITE_API const char *sqlite3_sql(sqlite3_stmt *pStmt); 
```

检索用于构建语句的查询。获得查询后，您可以解析查询以获取表名。

例如，如果您的语句是插入，您会得到

```
INSERT INTO TABLE_NAME... 
```

现在第三个词是你的表名。您可以使用 ，

```
componentSeperatedByString 
```

但我更喜欢使用正则表达式。

# c# - WCF/REST 将图像放入图片框？

> ID：10014793
> 
> 赞同：3
> 
> 时间：2012-04-04T15:54:01.580
> 
> 标签：c#, wpf, web-services, rest

所以我有 wcf 休息服务，它成功地从控制台应用程序运行，如果我导航到：[http://localhost:8000/Service/picture/300/400](http://localhost:8000/Service/picture/300/400)我的图像会显示注意 300/400 设置宽度和高度html页面正文中的图像。

代码如下所示：

```
namespace WcfServiceLibrary1
{
    [ServiceContract]
    public interface IReceiveData
    {
        [OperationContract]
        [WebInvoke(Method = "GET", BodyStyle = WebMessageBodyStyle.Wrapped, ResponseFormat = WebMessageFormat.Xml, UriTemplate = "picture/{width}/{height}")]
        Stream GetImage(string width, string height);
    }
    public class RawDataService : IReceiveData
    {
        public Stream GetImage(string width, string height)
        {
                int w, h;

                if (!Int32.TryParse(width, out w))
                {
                    w = 640;
                }
                // Handle error
                if (!Int32.TryParse(height, out h))
                {
                    h = 400;
                }
            Bitmap bitmap = new Bitmap(w, h); 
            for (int i = 0; i < bitmap.Width; i++)
            {
                for (int j = 0; j < bitmap.Height; j++)
                {
                    bitmap.SetPixel(i, j, (Math.Abs(i - j) < 2) ? Color.Blue : Color.Yellow);
                }
            }
            MemoryStream ms = new MemoryStream();
            bitmap.Save(ms, System.Drawing.Imaging.ImageFormat.Jpeg);
            ms.Position = 0;
            WebOperationContext.Current.OutgoingResponse.ContentType = "image/jpeg";
            return ms;
        }
    }
} 
```

我现在要做的是使用客户端应用程序“我的 Windows 窗体应用程序”并将该图像添加到图片框中。我有点不知道如何实现这一点，因为我希望我的 wcf 休息服务中图像的宽度和高度由图片框的宽度和高度设置。我已经尝试过了，但是其中两行有错误，我什至不确定它是否可以工作，因为我的 wcf 休息服务的代码用“/”分隔宽度和高度，如果你在 url 中注意到的话。

```
 string uri = "http://localhost:8080/Service/picture";
    private void button1_Click(object sender, EventArgs e)
    {

        StringBuilder sb = new StringBuilder();
        sb.AppendLine("<picture>");
        sb.AppendLine("<width>" + pictureBox1.Image.Width + "</width>");
        // the url looks like this http://localhost:8080/Service/picture/300/400 when accessing the image so I am trying to set this here
        sb.AppendLine("<height>" + pictureBox1.Image.Height + "</height>");
        sb.AppendLine("</picture>");
        string picture = sb.ToString();
        byte[] getimage = Encoding.UTF8.GetBytes(picture); // not sure this is right
        HttpWebRequest req = WebRequest.Create(uri); //cant convert webrequest to httpwebrequest
        req.Method = "GET";
        req.ContentType = "image/jpg";
        req.ContentLength = getimage.Length; 
        MemoryStream reqStrm = req.GetRequestStream(); //cant convert IO stream to IO Memory stream
        reqStrm.Write(getimage, 0, getimage.Length); 
        reqStrm.Close();
        HttpWebResponse resp = req.GetResponse(); // cant convert web respone to httpwebresponse
        MessageBox.Show(resp.StatusDescription);
        pictureBox1.Image = Image.FromStream(reqStrm);
        reqStrm.Close();
        resp.Close();
    } 
```

所以只是想知道是否有人可以帮助我完成这种徒劳的尝试，将我的休息服务中的可变图像大小添加到按钮单击的图片框。

这也是主机应用程序：

```
namespace ConsoleApplication1
{
    class Program
    {
        static void Main(string[] args)
        {
            string baseAddress = "http://" + Environment.MachineName + ":8000/Service";
            ServiceHost host = new ServiceHost(typeof(RawDataService), new Uri(baseAddress));
            host.AddServiceEndpoint(typeof(IReceiveData), new WebHttpBinding(), "").Behaviors.Add(new WebHttpBehavior());
            host.Open();
            Console.WriteLine("Host opened");
            Console.ReadLine(); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-04T17:27:41.090

获取具有可变宽度和高度的图像的基于 WinForms 的方法如下所示：

```
public Image GetImage(int width, int height)
{
    string uri = string.Format("http://localhost:8000/Service/picture/{0}/{1}", width, height);
    HttpWebRequest request = (HttpWebRequest)WebRequest.Create(uri);

    using (HttpWebResponse response = (HttpWebResponse)request.GetResponse())
    {
        using (Stream stream = response.GetResponseStream())
        {
            return new Bitmap(stream);
        }
    }
} 
```

您可以像这样将图像放到 PictureBox 中：

```
private void Form1_Load(object sender, EventArgs e)
{
    pictureBox.Image = GetImage(400, 500); // or any other size here
} 
```

在 WPF 中，你会做这样的事情：

```
public ImageSource GetImage(int width, int height)
{
    string uri = string.Format("http://localhost:8000/Service/picture/{0}/{1}", width, height);
    return BitmapFrame.Create(new Uri(uri));
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-04T17:48:46.320

WRT 您对请求 URL 中由“/”分隔的宽度和高度参数的评论，一种更 RESTful 的方法是将它们作为参数传递，例如 URL 如下所示：

```
http://localhost:8000/Service/picture?width=480&height=640 
```

你的 WebInvoke 看起来像：

```
[WebInvoke(Method = "GET", BodyStyle = WebMessageBodyStyle.Wrapped, ResponseFormat = WebMessageFormat.Xml, UriTemplate = "picture?width={width}&height={height}")] 
```

GetImage 方法无需更改，参数将与原始 UriTemplate 一样填充。

# android - Android - 如何检查活动是否已加载？

> ID：10014798
> 
> 赞同：1
> 
> 时间：2012-04-04T15:54:35.597
> 
> 标签：android, android-activity, onload

当我的活动完全加载时，我需要执行操作吗？Android 是否有类似 onLoaded 方法的活动？到目前为止，我只能找到小部件的 onLoaded 方法。

谢谢

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-04-04T16:45:37.600

我不确定这一点，但看看[Activity LifeCycle](http://developer.android.com/reference/android/app/Activity.html)我会说你需要覆盖 onStart() 或 onResume() 来做你想做的事。

```
@Override
public void onResume(){
    super.onResume();
    //Your code here
} 
```

希望这可以帮助。

# objective-c - 从 UI 中删除图像

> ID：10014800
> 
> 赞同：0
> 
> 时间：2012-04-04T15:54:44.893
> 
> 标签：objective-c, ios, xcode, image

我正在开发一个行为类似于照片库的应用程序，并且我正在实现让用户从他们的画廊中删除照片的选项。为此，我决定在每张图片上放置一个隐形按钮。当用户点击“编辑”按钮时，每张图片上隐藏的删除按钮将变为活动状态。为了简单起见，我在每个隐藏按钮上使用了相同的 IBOutlet，并且我在 Interface Builder 中适当地标记了每个按钮。当用户点击图片上的按钮时，会出现一个警告视图，询问他们是否真的要删除它。如果他们单击“是”，我将调用 removeObjectAtIndex。这是我正在使用的代码：

```
- (IBAction)deleteButtonPressed:(id)sender {
    NSLog(@"Sender is %@", sender);
    UIAlertView *deleteAlertView = [[UIAlertView alloc] initWithTitle:@"Delete"
                                                              message:@"Are you sure you want to delete this photo?"
                                                             delegate:self
                                                    cancelButtonTitle:@"No"
                                                    otherButtonTitles:@"Yes", nil];
    [deleteAlertView show];
    int imageIndex = ((UIButton *)sender).tag;
    deleteAlertView.tag = imageIndex;

}

- (void)alertView: (UIAlertView *) alertView 
clickedButtonAtIndex: (NSInteger) buttonIndex
{

    if (buttonIndex != [alertView cancelButtonIndex]) {
        NSLog(@"User Clicked Yes. Deleting index %d of %d", alertView.tag, [array count]);

        [self.array removeObjectAtIndex: alertView.tag];
        NSLog(@"After deleting item, array count  = %d", [array count]);
        alertView.tag.image = nil;
    }

    [self.user setObject:self.array forKey:@"images"];
} 
```

这里的问题是`alertView.tag.image`。我有一个错误，指出“成员引用基类型 NSInteger（又名 int）不是结构或联合。这段代码可以很好地从数组中删除图像，但我仍然需要从 UI 中删除图像。我想那`alertView.tag.image`本来可以解决问题的。我不知道该怎么做，我对Objective-C还是新手，我读的书根本没有涵盖任何内容。我还想知道如何在之后刷新UI删除图像？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-04T15:59:08.173

您正在尝试访问不存在的属性：

`alertView.tag.image = nil;`

你`alertView`是一个`UIAlertView`- 并且`tag`是一个整数属性，它代表你分配给视图的 int 值（假设你已经这样做了）。`tag`只是一个普通的旧 int - 它是一个原始的。

相反，您需要做的是获取标签值并调用`viewWithTag`保存图像的超级视图：这将为您提供对图像视图的引用，然后您可以`removeFromSuperview`根据需要进行引用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-04T15:59:18.370

标签只是 NSInteger。它没有称为图像的属性。你应该使用，

```
((UIImageView *)[self.view viewWithTag:alertView.tag]).image =nil; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-04T16:00:04.600

您如何将图像添加到 UI？将 UIImageView 中的图像设置为另一个图像或将其从视图中删除。

您不能在`.image`之后添加`.tag`。标签是一个整数实例字段，用于表示另一个视图（除其他外）。标签本身，除了它的值外，没有任何属性。

# windows - 将批处理文件 ECHO 传递到 PUSHD 命令提示符命令中

> ID：10014801
> 
> 赞同：2
> 
> 时间：2012-04-04T15:54:46.360
> 
> 标签：windows, command, pipe, prompt

我有一个 Windows 批处理文件，它输出目录路径，例如：

```
@echo c:\windows 
```

我想将此字符串“c:\windows”传递给 PUSHD 命令。我试过这个：

```
path.bat | PUSHD 
```

但它出错了“进程试图写入不存在的管道。”。

请帮忙。

已解决的命令提示符日志如下所示：

```
c:\>path.bat | PUSHD
c:\Windows> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-04T16:00:48.593

基本思路（需要做适当的调整）：

```
for /f %i in ('path.bat') do pushd %i 
```

# macos - 在命令行上将 Mac iWork 文件批量转换为 PDF

> ID：10014807
> 
> 赞同：4
> 
> 时间：2012-04-04T15:55:22.960
> 
> 标签：macos, pdf, cups, iwork

我正在尝试在命令行上将一堆分类的 iWork 文件（Numbers、Pages、Keynote）批量转换为 PDF。

我一直在尝试 cups-filter 但 iWork 类型没有 MIME 类型的过滤器。然后我研究了使用 qlmanage 生成预览图像并使用它，但这似乎不适用于多文件 Keynote 文档，因为它们生成为 HTML 而不是 PDF。

有什么建议么？我宁愿不求助于 AppleScript。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-06T08:44:15.673

这就是我最终要使用的，因为我真的想避免使用 AppleScript。

保存 iWork 文档时，有一个“在文档中包含预览”复选框。选中此项会在 iWork 文档包（实际上是一个 zip 文件）中创建一个“QuickLook/Preview.pdf”。幸运的是，我检查了大多数 zip 文件，所以这只是解压缩到 NSTemporaryDirectory 并抓取该文件的情况。

对于那些没有的人，我整理了一个脚本来运行 qlmanage 来创建文档预览。对于一些创建 PDF 的人，对于其他人，它会创建一个 HTML 文件。然后，您可以使用[http://code.google.com/p/wkhtmltopdf/](http://code.google.com/p/wkhtmltopdf/)将此 HTML 转换为 PDF。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2017-05-23T12:19:50.573

我创建了一个`.applescript` [脚本](https://github.com/gitmalong/pages2docx)，将`.pages`文件夹中的所有文件转换为`.docx`. `.pdf`可以轻松添加支持。在`pages2docx.applescript`你只需要替换`Microsoft Word`为`PDF`.

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-04T17:42:58.057

嗯...你需要的东西

1.  了解 iWork 文件格式，
2.  可以渲染文档然后创建 PDF。

除非你想重新发明 iWork 套件……听起来更简单，只是告诉 iWork 应用你想从它们那里得到什么。

您可以通过[Scripting Bridge做到这一点](https://developer.apple.com/library/mac/#documentation/Cocoa/Conceptual/ScriptingBridgeConcepts/Introduction/Introduction.html)

我会使用 Applescript，但也许您可以将[Ruby 和 Python](https://developer.apple.com/library/mac/#documentation/Cocoa/Conceptual/RubyPythonCocoa/Introduction/Introduction.html#//apple_ref/doc/uid/TP40004936)与 Scripting Bridge一起使用[来完成您需要的工作](https://developer.apple.com/library/mac/#documentation/Cocoa/Conceptual/RubyPythonCocoa/Articles/UsingScriptingBridge.html#//apple_ref/doc/uid/TP40005424-SW1)

> 借助 Scripting Bridge，RubyCocoa 和 PyObjC 脚本可以做 AppleScript 脚本可以做的事情：控制可编写脚本的应用程序并与它们交换数据。

我有一段时间没有使用 Scripting Bridge，但我相信您可以告诉应用程序打印文档。任何可以在 OS X 中打印的应用程序都可以将其发送到 PDF。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2014-12-13T16:35:38.493

这里有几个命令可以帮助那些想不假思索地让它工作的人。它适用于我的 ppt 文件。

确保从[这里](http://wkhtmltopdf.org/downloads.html)获取 wkhtmltopdf 。

```
qlmanage -p -o /tmp /path/of/file.ppt
wkhtmltopdf /tmp/file.ppt.qlpreview/Preview.html /output/to/file.pdf 
```

如果您希望原始页面保持一致，您可能不得不摆弄尺寸，因为我使用以下参数的 ppt 完成了这项工作：

```
wkhtmltopdf --page-width 200 --page-height 145 Preview.html file.pdf 
```

编辑：我编写了一个 Python 脚本来进行批量转换。希望人们可以做出贡献，使其更加强大：

[https://github.com/matthewfitch23/DocToPdf](https://github.com/matthewfitch23/DocToPdf)

# c# - 可以将 Delphi 4 和/或 Delphi 5 可执行文件集成到 C# 应用程序中吗？

> ID：10014810
> 
> 赞同：1
> 
> 时间：2012-04-04T15:55:24.643
> 
> 标签：c#, delphi, integration, compatibility, legacy

可以将 Delphi 4 和\或 5 应用程序功能 (.exe) 集成到 C# 应用程序中吗？

我的任务是重写一个新的应用程序，该应用程序将基于现有的 Delphi 4/5 编写的应用程序，这些应用程序目前与我公司没有人理解的批处理脚本一起保存。

作为中间解决方案，我被要求调查是否可以将 C# GUI\wrapper 放在顶部，以便更容易维护和运行。

我知道可以使用反射在 C# 应用程序中调用 Delphi 6 应用程序，但我不完全确定如何。

那么回到我最初的问题，可以在 C# 应用程序中调用 Delphi 4/5 应用程序功能吗？

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-04T17:21:22.923

Delphi .exe 可以从 C# 运行。但我想这不是你的重点。

您可以使用标准的 COM 服务器，但需要在计算机上注册 COM 对象（通过运行`regsrv32.exe`）。不是那么容易部署。

[或者您可以将 Delphi 代码定义为库，然后从 C# 代码](http://msdn.microsoft.com/en-us/magazine/cc301501.aspx)加载并执行 .dll 。

如果您更喜欢从 Delphi 4 或 5 访问 C# 对象（即访问 C# RTTI），则必须使用一些低级单元，例如[VCL 的托管扩展 - Delphi Win32 的 .Net interop](http://www.managed-vcl.com/)。[这是相当完整的，并且可以与旧版本的 Delphi 一起使用（遗憾的是，比Hydra](http://www.remobjects.com/hydra/default.aspx)更高级的东西不支持 Delphi 4 或 5）。

*编辑*

另一种可能的简单通信是 GDI 消息。您可以从 C# 代码发送 GDI 命令来控制 Delphi 应用程序，但使用 PostMessage() API 调用。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-04T22:24:02.237

该问题的基本前提似乎是围绕 Delphi 核心的 C# 包装器更易于维护和运行，如果这不是真的，那么创建包装器的想法就变得不是很有用。我认为这是一个错误的概念。

想象一下，我做了一个可以与望远镜对话的应用程序。它完美地做到了。在这种情况下，我可以只提取望远镜通信部分并将其放入 DLL 中，然后用 C# 编写一个用户界面，使用 Delphi DLL 来执行与望远镜通信的任务。但是，除非您的 Delphi 应用程序已经以一种很好的方式构建，并且除非已经存在像这个望远镜通信库这样的任务，否则您将发现提取 Delphi 应用程序的任何部分并从 C# 中使用它并不容易。如果存在这种情况，我将使用本机 Delphi DLL 函数导出并从 C# 调用它们。这不使用现有的 delphi 可执行文件，并且需要花费大量时间将 Delphi 应用程序的一部分重构为可以从 C# 中使用的东西。

另一个答案提到了 COM 服务器，虽然这是可能的，但它不会让事情变得更容易；就像关于正则表达式的老笑话一样；当您遇到问题并尝试使用正则表达式解决时，现在您遇到了两个问题。当您尝试使用 COM 服务器来隐藏现有应用程序并使用 C# 在其上编写全新的 UI 时，情况也是如此。实际上，以这种方式改进、调试和继续开发它需要更多的技术技能，而不是纯粹用 delphi 或纯粹用 C# 继续开发它。这是一种消极的努力。

您没有提供有关 Delphi 应用程序做什么的信息，但我们假设它是一个业务线或垂直市场应用程序，它读取某种文件格式，或执行某种通信协议，甚至连接到您不知道的某个旧数据库不想重写。

如果通过制作 C# UI 的意思是永远不要显示 Delphi 应用程序用户界面并用 C# 替换它，那么几乎可以肯定你的想法不会让任何事情变得更好，只会让事情变得更糟。您的僵局要么来自没有熟练的 delphi 开发人员，要么来自没有聪明的开发人员能够弄清楚现有应用程序的功能。

在这种情况下，解决方案通常是人工解决方案；要么聘请熟练的 delphi 开发人员并将应用程序带入现代 Delphi 时代（Delphi XE2），要么聘请熟练的非 delphi 开发人员并将应用程序移植到其他语言。任何建议在 delphi 应用程序之上编写“包装器”并认为这会使其“更容易”的人显然无法重写现有应用程序。

可以肯定的是，我对您的 delphi 应用程序的功能知之甚少，但在我看来，这听起来确实像是“恐惧驱动”的决定。包装旧代码几乎从来都不是一个好主意，而且通常只会产生更多问题。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-04T16:09:32.063

Delphi 5 支持实现 COM 服务器功能（不知道早期版本，D2 肯定没有）。

如果你有可用的资源，

*   添加类型库和类型库中定义的接口的 COM 实现，

*   注册可执行文件（通常在启动时自动完成，这要归功于 Delphi 魔法）

*   按照 MSDN 上的步骤操作：[将 COM 组件暴露给 .NET Framework](http://msdn.microsoft.com/en-us/library/z6tx9dw3%28v=vs.80%29.aspx)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-04T15:59:35.190

当然。C# 可以调用任何 .exe。只需使用 Process.Start：

[http://www.dotnetperls.com/process-start](http://www.dotnetperls.com/process-start)

[http://msdn.microsoft.com/en-us/library/system.diagnostics.process.aspx](http://msdn.microsoft.com/en-us/library/system.diagnostics.process.aspx)

# jakarta-ee - JSF2：使用 commandLink 不会将页面重新加载为 commandButton

> ID：10014812
> 
> 赞同：0
> 
> 时间：2012-04-04T15:55:31.180
> 
> 标签：jakarta-ee, jsf-2, richfaces

我正在尝试通过使用 . 使用时效果很好。如果我使用并导航到另一个页面（使用操作），它也可以工作。自然，我不想在更改语言时导航到另一个页面。我的理解是 commandLink 的工作方式应该与 commandButton 类似。我尝试了不同的方法（在互联网上找到），但似乎可以让它工作。我在这里想念什么？

我还应该补充一点，当我看到控制台中的跟踪显示时，我正在输入方法（请参见下面的 printIt()）。

语言链接位于标题页 (header.xhtml) 中。我正在使用包含 header.xhtml 和正文内容的模板 (template.xhtml)。template.xhtml 中没有表单。

此外，我正在使用 JSF 2、richFaces 并在 tomcat 6 上进行部署，但也在 tomcat 7 上进行了尝试。默认浏览器是 IE9。

这是header.xhtml：

```
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
    xmlns:h="http://java.sun.com/jsf/html"
    xmlns:f="http://java.sun.com/jsf/core"
    xmlns:ui="http://java.sun.com/jsf/facelets"
    xmlns:a4j="http://richfaces.org/a4j"
    xmlns:rich="http://richfaces.org/rich">

    <div class="Header">
        <div class="Headerleft">
            <h:graphicImage library="images" name="logo.png" />
        </div>
        <div class="HeaderTopNav">
            <f:view>
                <h:form id="header">
                    <h:commandButton actionListener="#{localeChanger.printIt}" value="kkk" />
                    <h:commandLink actionListener="#{localeChanger.printIt}" value="jjj" />
                | <a href="#">#{msg['header.about']}</a> 
                | <a href="#">#{msg['contact.webmaster']}</a>
                </h:form>
            </f:view>
        </div>
    </div>
</ui:composition> 
```

这是我的template.xml：

```
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
    xmlns:h="http://java.sun.com/jsf/html"
    xmlns:f="http://java.sun.com/jsf/core"
    xmlns:ui="http://java.sun.com/jsf/facelets"
    xmlns:a4j="http://richfaces.org/a4j"
    xmlns:rich="http://richfaces.org/rich">

<f:view locale="#{localeChanger.locale}">
<h:head>

    <meta http-equiv="pragma" content="no-cache" />
    <meta http-equiv="cache-control" content="no-cache" />
    <meta http-equiv="expires" content="0" />
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <meta http-equiv="x-ua-compatible" content="IE=8" />

    <title>#{msg['header.title']}</title>

    <h:outputStylesheet library="css" name="style.css" />
    <h:outputStylesheet library="css" name="jquery.css" />

    <h:outputScript library="js" name="jquery-1.7.1.js" target="head" />
    <h:outputScript library="js" name="jquery.cookie.js" target="head" />
    <h:outputScript library="js" name="jquery.ui.core.js" target="head" />
    <h:outputScript library="js" name="jquery.ui.widget.js" target="head" />
    <h:outputScript library="js" name="jquery.ui.tabs.js" target="head" />

    <script>
    $(function() {
        $( "#tabs" ).tabs({
            cookie: {
                // store cookie for a day, without, it would be a session cookie
                expires: 1
            }
        });
    });
    </script>
</h:head>

<h:body>

        <div id="Wrap">
            <div class="MainContent">

                <!-- HEADER -->
                <div id="header">
                    <ui:insert name="header">
                        <ui:include src="/templates/cie/header.xhtml" />
                    </ui:insert>
                </div>

                <div class="container">
                    <ui:insert name="body" />
                </div>

            </div>
        </div>
</h:body>
</f:view>
</html> 
```

这是我的页面：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html 
    xmlns="http://www.w3.org/1999/xhtml" 
    xmlns:h="http://java.sun.com/jsf/html" 
    xmlns:f="http://java.sun.com/jsf/core"
    xmlns:ui="http://java.sun.com/jsf/facelets" 
    xmlns:a4j="http://richfaces.org/a4j">

<body>
    <ui:composition template="/templates/cie/template.xhtml">

        <ui:define name="title">RichFaces Sample</ui:define>

        <ui:define name="body">
            <h:form prependId="false">
                <h:outputLabel value="Name:" for="nameInput" />
                <h:inputText id="nameInput" value="#{richBean.name}">
                    <a4j:ajax event="keyup" render="output" />
                </h:inputText>
                <h:panelGroup id="output">
                    <h:outputText value="Hello #{richBean.name}!"
                        rendered="#{not empty richBean.name}" />
                </h:panelGroup> 
            </h:form>
        </ui:define>
    </ui:composition>
</body>
</html> 
```

我的 web.xml 是（使用 Richfaces 原型生成）：

```
<?xml version="1.0" encoding="UTF-8"?>
<web-app version="2.5" xmlns="http://java.sun.com/xml/ns/javaee" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-app_2_5.xsd">

    <display-name>Sample RichFaces 4 Application</display-name>

    <context-param>
        <param-name>javax.faces.PROJECT_STAGE</param-name>
        <param-value>Development</param-value>
    </context-param>

    <context-param>
        <param-name>javax.faces.SKIP_COMMENTS</param-name>
        <param-value>true</param-value>
    </context-param>

    <servlet>
        <servlet-name>Faces Servlet</servlet-name>
        <servlet-class>javax.faces.webapp.FacesServlet</servlet-class>
        <load-on-startup>1</load-on-startup>
    </servlet>
    <servlet-mapping>
        <servlet-name>Faces Servlet</servlet-name>
        <url-pattern>*.jsf</url-pattern>
    </servlet-mapping>
    <servlet-mapping>
        <servlet-name>Faces Servlet</servlet-name>
        <url-pattern>/faces/*</url-pattern>
    </servlet-mapping>
    <servlet-mapping>
  <servlet-name>Faces Servlet</servlet-name>
  <url-pattern>*.xhtml</url-pattern>
</servlet-mapping>

    <!-- Resource Servlet - serves static resources and resources for specific components -->
    <servlet>
        <servlet-name>Resource Servlet</servlet-name>
        <servlet-class>org.richfaces.webapp.ResourceServlet</servlet-class>
        <load-on-startup>1</load-on-startup>
    </servlet>
    <servlet-mapping>
        <servlet-name>Resource Servlet</servlet-name>
        <url-pattern>/org.richfaces.resources/*</url-pattern>
    </servlet-mapping>

    <!-- Resource Mapping - resources will be served compressed and packed in production -->
    <context-param>
        <param-name>org.richfaces.resourceMapping.enabled</param-name>
        <param-value>true</param-value>
    </context-param>

    <session-config>
        <session-timeout>30</session-timeout>
    </session-config>

    <welcome-file-list>
        <welcome-file>faces/index.xhtml</welcome-file>
    </welcome-file-list>

    <login-config>
        <auth-method>BASIC</auth-method>
    </login-config>

</web-app> 
```

还有我的面部配置：

```
<?xml version="1.0"?>
<faces-config version="2.0" xmlns="http://java.sun.com/xml/ns/javaee"
    xmlns:xi="http://www.w3.org/2001/XInclude" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-facesconfig_2_0.xsd">

    <application>
        <locale-config>
            <default-locale>fr_CA</default-locale>
        </locale-config>
        <resource-bundle>
            <base-name>ca.cie.template.msgs.messages</base-name>
            <var>msg</var>
        </resource-bundle>
    </application>
</faces-config> 
```

最后我的 LocaleChanger 是：

```
@ManagedBean
@SessionScoped
public class LocaleChanger implements Serializable, ActionListener {

    private static final long serialVersionUID = 1L;
    final Logger logger = LoggerFactory.getLogger(LocaleChanger.class);

    public void setLocale(String locale1) {
        FacesContext context = FacesContext.getCurrentInstance();
        context.getViewRoot().setLocale(getLocaleFromString(locale1));
    }

    public Locale getLocale() {
        return FacesContext.getCurrentInstance().getViewRoot().getLocale();
    }

    public String i18nAction() {
        System.out.println("Hello JCL...");
        FacesContext context = FacesContext.getCurrentInstance();
        logger.info("i18nAction Locale={}", context.getViewRoot().getLocale().toString());

        Locale lang = Locale.CANADA;
        if (context.getViewRoot().getLocale() == lang) {
            lang = Locale.CANADA_FRENCH;
        }           
        context.getViewRoot().setLocale(lang);

        return lang.toString();
    }

    private static Locale getLocaleFromString(String localeString) {
        if (localeString == null) {
            FacesContext context = FacesContext.getCurrentInstance();
            context.getViewRoot().getLocale();
        }

        localeString = localeString.trim();
        if (localeString.toLowerCase().equals("default")) {
            return Locale.getDefault();
        }

        // Extract language
        int languageIndex = localeString.indexOf('_');
        String language = null;
        if (languageIndex == -1) {
            // No further "_" so is "{language}" only
            return new Locale(localeString, "");
        } else {
            language = localeString.substring(0, languageIndex);
        }

        // Extract country
        int countryIndex = localeString.indexOf('_', languageIndex + 1);
        String country = null;
        if (countryIndex == -1) {
            // No further "_" so is "{language}_{country}"
            country = localeString.substring(languageIndex + 1);
            return new Locale(language, country);
        } else {
            // Assume all remaining is the variant so is
            // "{language}_{country}_{variant}"
            country = localeString.substring(languageIndex + 1, countryIndex);
            String variant = localeString.substring(countryIndex + 1);
            return new Locale(language, country, variant);
        }
    }

    public void printIt(ActionEvent event){
        System.out.println("This is an action JCL...");
        i18nAction();
    }

    @Override
    public void processAction(ActionEvent event) throws AbortProcessingException {
        System.out.println("In process ActionEvent?");
        i18nAction();

    }
} 
```

jc

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-31T13:49:46.587

如果您的侦听器方法有效 - 您可以添加 `onclick="window.location.reload"` 到 commandLink 属性并通过 javascript 重新加载页面

# c# - 在实体框架（C#.Net）中的客户端和服务器之间共享数据库访问方法

> ID：10014815
> 
> 赞同：0
> 
> 时间：2012-04-04T15:55:41.103
> 
> 标签：c#, .net, entity-framework, architecture, client-server

这是一种客户端-服务器架构问题。

我的解决方案中有 2 个项目：一个用于客户端的项目使用 Entity Framework 和 SQL Server Compact 数据库，另一个用于服务器端的项目也使用 Entity Framework 但使用真正的 SQL Server 数据库。两个数据库具有完全相同的数据库架构，因此尽管它们使用不同的 .edmx 文件，但生成的实体看起来相同，只是名称空间不同。顺便说一句，我正在使用 ADO.NET DbContext Generator 来生成持久性无知实体类。到现在为止还挺好。现在我编写了一个（相当大的）类，其中包含所有服务器数据库访问方法，例如：

```
 public User CreateUser(string userId, string username, bool isGlobalAdmin)
    {
        using (var context = new ServerEntities())
        {
            try
            {
                var user = new User
                {
                    UserID = userId,
                    Username = username,
                    IsGlobalAdmin = isGlobalAdmin
                };

                context.User.Add(user);
                context.SaveChanges();

                return user;
            }
            catch (Exception ex)
            {
                HandleEfException(ex);
            }
        }

        return null;
    } 
```

问题是我需要在客户端使用相同的类和相同的方法。所以我会将这个类复制到客户端项目，将 ServerEntities 重命名为 ClientEntities 并更改命名空间以使用客户端实体。这很丑陋，因为如果发生变化，我需要维护这两个类。有没有办法抽象整个事物并在双方（客户端和服务器）上使用相同的类（位于其他两个项目引用的单独项目中）？

我将衷心感谢您的帮助。

最好的，

安东尼

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-04T16:17:25.600

您可以执行以下操作：

```
#if SERVER
    using (var context = new ServerEntities())
#elif CLIENT
    using (var context = new ClientEntities())
#endif 
```

然后，在两个项目的项目属性中，在 Build 和 Conditional Compliation Symbols 框下，您可以为每个项目添加令牌。因此，在服务器项目中添加`SERVER`，在客户端中添加`CLIENT`. 如果那里已经有标记，用分号 ( `;`) 分隔。

无论您将课程放入哪个项目，都将其作为链接添加到第二个项目。例如，如果类文件位于服务器项目中，则在客户端项目中，转到添加 -> 现有项目。选择文件，然后单击箭头`Open`并单击“添加为链接”。这将确保只有一个副本链接到两个项目。

当每个都被编译时，编译器将查看令牌，评估它们，并将使用`ClientEntities`客户端项目和`ServerEntities`服务器项目中的行。

如果需要，您可以对命名空间执行相同的预处理器指令。这是[一篇](http://msdn.microsoft.com/en-us/library/ew2hz0yd%28v=vs.80%29.aspx)解释指令的 MSDN 文章。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-04T16:37:33.237

如果保证数据库是相同的，为什么需要两组实体？只需使用一套，它们就可以互操作。

# android - Android TextView 文本不会居中

> ID：10014819
> 
> 赞同：11
> 
> 时间：2012-04-04T15:55:45.933
> 
> 标签：android, layout, textview

我正在尝试进行 PIN 输入活动，但有一件小事对我不太有效。我无法让文本在屏幕截图顶部的 TextView 中居中：

![固定截图](../Images/748dfb3f546f644a10d699af71c10f91.png)

它的工作方式是当用户输入 PIN 时，我将在每个 TextView 中放置一个星号以获得可见的反馈。问题是，我希望星星居中。我已经尝试过 layout_gravity="center"，但这并没有什么不同。这是我目前的布局：

```
 <?xml version="1.0" encoding="utf-8"?>
 <LinearLayout
   xmlns:android="http://schemas.android.com/apk/res/android"
   android:orientation="vertical"
   android:layout_width="match_parent"
   android:layout_height="match_parent">
     <TextView 
     android:textAppearance="?android:attr/textAppearanceLarge" 
     android:layout_height="wrap_content" 
     android:id="@+id/textView1" 
     android:text="PIN Required" 
     android:layout_width="wrap_content" 
     android:layout_gravity="center_horizontal" 
     android:layout_marginBottom="12sp"
     ></TextView>
     <LinearLayout 
     android:layout_width="match_parent" 
     android:id="@+id/linearLayout1" 
     android:layout_height="wrap_content" 
     android:layout_marginBottom="12sp" 
     android:layout_gravity="center_horizontal"
     >
         <TextView 
       android:id="@+id/text1" 
       android:layout_height="32sp" 
       android:layout_width="48sp" 
       android:layout_weight="1" 
       android:layout_marginRight="2sp" 
       android:layout_marginLeft="48sp" 
       android:background="#FFFFFF" 
       android:text="X" 
       android:layout_gravity="center"
       ></TextView>
         <TextView 
       android:id="@+id/text2" 
       android:layout_height="32sp" 
       android:layout_width="48sp" 
       android:layout_weight="1" 
       android:layout_marginRight="2sp" 
       android:layout_marginLeft="2sp" 
       android:background="#FFFFFF"
       ></TextView>
         <TextView 
       android:id="@+id/text3" 
       android:layout_height="32sp" 
       android:layout_width="48sp" 
       android:layout_weight="1" 
       android:layout_marginRight="2sp" 
       android:layout_marginLeft="2sp" 
       android:background="#FFFFFF"
       ></TextView>
         <TextView 
       android:id="@+id/text4" 
       android:layout_height="32sp" 
       android:layout_width="48sp" 
       android:layout_weight="1" 
       android:layout_marginRight="48sp" 
       android:layout_marginLeft="2sp" 
       android:background="#FFFFFF"
       ></TextView>
     </LinearLayout>
     <LinearLayout 
     android:layout_width="match_parent" 
     android:id="@+id/linearLayout2" 
     android:layout_height="wrap_content" 
     android:layout_marginBottom="12sp"
     >
         <Button 
       android:text="1" 
       android:textColor="#FFFFFF" 
       android:id="@+id/button1" 
       android:layout_height="32sp" 
       android:layout_width="64sp" 
       android:layout_weight="1" 
       android:editable="false" 
       android:layout_marginRight="2sp" 
       android:layout_marginLeft="48sp" 
       android:background="@drawable/action_background_gradient" 
       android:onClick="ButtonClicked"
       ></Button>
         <Button 
       android:text="2" 
       android:textColor="#FFFFFF" 
       android:id="@+id/button2" 
       android:layout_height="32sp" 
       android:layout_width="64sp" 
       android:layout_weight="1" 
       android:editable="false" 
       android:layout_marginRight="2sp" 
       android:layout_marginLeft="2sp" 
       android:background="@drawable/action_background_gradient" 
       android:onClick="ButtonClicked"
       ></Button>
         <Button 
       android:text="3" 
       android:textColor="#FFFFFF" 
       android:id="@+id/button3" 
       android:layout_height="32sp" 
       android:layout_width="64sp" 
       android:layout_weight="1" 
       android:editable="false" 
       android:layout_marginRight="48sp" 
       android:layout_marginLeft="2sp" 
       android:background="@drawable/action_background_gradient" 
       android:onClick="ButtonClicked"
       ></Button>
     </LinearLayout>

     <!--... and so on for the rest of the buttons ... -->
 </LinearLayout> 
```

我在第一个 textview 中有那个 android:text="X" ，这样我就可以看到它是否正常工作。当我完成调整布局时，它就会消失。我错过了什么简单的事情？

* * *

## 回答 #1

> 赞同：42
> 
> 时间：2012-04-04T15:58:53.840

利用`android:gravity="center"`

尽管我在您的代码中没有看到任何 EditText 元素。你确定你发布了正确的代码？

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2012-04-04T16:01:33.160

```
<TextView 
   android:id="@+id/text1" 
   android:layout_height="32sp" 
   android:layout_width="48sp" 
   android:layout_weight="1" 
   android:layout_marginRight="2sp" 
   android:layout_marginLeft="48sp" 
   android:background="#FFFFFF" 
   android:text="X" 
   android:layout_gravity="center"
   android:gravity="center"
/> 
```

`android:layout_gravity="center"`与此视图在其父视图中的位置有关。 `android:gravity="center"`与此视图的内容所在的位置有关。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-04T16:33:45.233

而不是 android:layout_gravity 在文本视图中使用`android:gravity="center_horizontal"`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-04T15:59:20.587

要使文本居中，请`android:gravity`在 TextView 上使用，而不是 layout_gravity：

```
<TextView 
   android:id="@+id/text1" 
   android:layout_height="32sp" 
   android:layout_width="48sp" 
   android:layout_weight="1" 
   android:layout_marginRight="2sp" 
   android:layout_marginLeft="48sp" 
   android:background="#FFFFFF" 
   android:text="X" 
   android:gravity="center" /> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-06-05T13:30:11.650

当然，这也可以通过编程方式完成：

```
textView.setGravity(Gravity.CENTER); 
```

# firefox - CakePHP 在 FireFox 中命名参数导致问题

> ID：10014820
> 
> 赞同：0
> 
> 时间：2012-04-04T15:55:47.030
> 
> 标签：firefox, url, cakephp, encoding, named-parameters

我们有一个在 2.0 上运行的 cakephp 应用程序，我们似乎在使用 Firefox 时遇到了一些编码问题。

我们正在访问的 URL 是 /newcms/core/users/index/conditions[User][group_id]:6 以在 out cms 系统中应用过滤器。

在除 FireFox 之外的所有内容中，我们在请求对象上得到以下内容

```
[params] => Array
        (
            [plugin] => core
            [controller] => users
            [action] => newcms_index
            [named] => Array
                (
                    [conditions] => Array
                        (
                            [User] => Array
                                (
                                    [group_id] => 6
                                )

                        )

                )

            [pass] => Array
                (
                )

            [prefix] => newcms
        ) 
```

这是正确的，一切正常，如果我们在 FireFox 中访问相同的 URL，我们会得到

```
[params] => Array
        (
            [plugin] => core
            [controller] => users
            [action] => newcms_index
            [named] => Array
                (
                    [conditions%5BUser%5D%5Bgroup_id%5D] => 6
                )

            [pass] => Array
                (
                )

            [prefix] => newcms
        ) 
```

我尝试过对命名条件值进行 URL 编码，但没有运气..

有什么建议么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-04T16:02:20.863

在 URL 中使用方括号和数组结构可能不是一个好主意。

为什么不只使用这样的东西？：

```
/newcms/core/users/index/user_group:6 
```

然后处理控制器中的数据。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-07T00:04:00.463

好吧，在 GitHub 中对最新版本的 cake 进行了一些挖掘和玩耍之后，已经修复了这个 FF 问题（https://github.com/cakephp/cakephp/commit/e6905b44c3d4512b6989c59a1489bc983d88bcdc）。

在 URI 中传递方括号并没有错，这只是 FF 对它们的编码方式与其他浏览器不同的问题。

# c# - C++ DLL 不使用 AppDomain 卸载

> ID：10014821
> 
> 赞同：14
> 
> 时间：2012-04-04T15:55:51.163
> 
> 标签：c#, appdomain

我有一个使用单独的 C++ DLL 的 C# 插件。对该 DLL 的唯一引用来自插件本身。父应用程序在自己的 AppDomain 中加载所有插件，并在卸载插件时卸载此 AppDomain。

我已经检查过了，当我卸载插件时，我肯定会看到应用程序的内存下降。我还能够删除所有已加载的托管程序集。问题是，当我尝试删除本机 DLL 时，我只会一直拒绝访问，直到我关闭整个应用程序。

我已经研究了一段时间，但我仍然无法弄清楚为什么只有这个 DLL 留在内存中。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-04-04T16:27:54.957

AppDomain 是纯托管代码构造。本机代码中不存在类似的东西，Windows 也不知道它。因此，加载的本机 DLL 的范围是进程。从技术上讲，pinvoke marshaller 可以引用 DLL 计数并准确跟踪哪个 AppDomain 触发了 DLL 的加载。但是，它无法判断是否有任何使用该 DLL 的本机代码正在运行。本机代码可以通过从*另一个*AppDomain 中的代码进行调用来启动，可能间接通过编组委托。

如果 AppDomain 管理器卸载以这种方式使用的 DLL，那么显然会发生灾难，这是一个令人讨厌且无法诊断 AccessViolation 的问题。特别讨厌，因为它可以在 AppDomain 卸载后很长时间触发。

所以编组器没有实现那种计数，DLL 保持加载状态。只有您可以保证这不会发生，您可以对在 DLL 中运行的代码及其启动方式进行一定程度的控制。您*可以*强制 DLL 卸载，但它需要 hack。自己调用 LoadLibrary() 以获取 DLL 的句柄。并 pinvoke FreeLibrary()**两次**以强制卸载它。Windows 和 CLR 都看不到您在作弊。您*必须*确保在此之后不能使用 DLL。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-04-04T16:03:30.223

AFAIK （幕后）本机 DLL 需要通过 Win32 API 加载...直接将它们加载到进程内存中 - 如果 .NET 应用程序[`LoadLibrary`](http://msdn.microsoft.com/en-us/library/windows/desktop/ms684175%28v=vs.85%29.aspx)不是特定于`AppDomain`...纯粹特定于.NET）......因此卸载不一定卸载本机DLL......`LoadLibrary``AppDomain``AppDomain`

关于这种情况的有趣讨论：

*   [http://clrinterop.codeplex.com/discussions/61817](http://clrinterop.codeplex.com/discussions/61817)
*   [http://www.mofeel.net/61-microsoft-public-dotnet-framework-interop/1940.aspx](http://www.mofeel.net/61-microsoft-public-dotnet-framework-interop/1940.aspx)

如果您可以更改相应插件的实现，那么您将实现“后期本机绑定”，这将解决您看到的问题：

*   [http://blogs.msdn.com/b/junfeng/archive/2004/07/14/181932.aspx](http://blogs.msdn.com/b/junfeng/archive/2004/07/14/181932.aspx)
*   [http://www.codeproject.com/KB/cs/dyninvok.aspx](http://www.codeproject.com/KB/cs/dyninvok.aspx)
*   [http://pinvoke.net/default.aspx/kernel32/GetPROcAddress.html](http://pinvoke.net/default.aspx/kernel32/GetPRocAddress.html)
*   [http://www.pinvoke.net/default.aspx/kernel32.loadlibrary](http://www.pinvoke.net/default.aspx/kernel32.loadlibrary)

# java - 支持循环依赖的 Guice 代理

> ID：10014825
> 
> 赞同：13
> 
> 时间：2012-04-04T15:56:12.927
> 
> 标签：java, dependency-injection, guice

启动时我的代码中出现以下错误：

> 尝试代理 com.bar.Foo 以支持循环依赖，但它不是接口。

这个代理究竟是如何工作的？如果我只是在接口后面抛出足够多的类，一切都会好吗？

（我知道循环依赖通常是一种代码味道，但我认为在这种情况下没关系。）

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-04-05T05:36:34.007

虽然“注入接口”方法是完全有效的，在某些情况下甚至可能是更好的解决方案，但通常，您可以使用更简单的解决方案：Providers。

对于每个“A”类 guice 可以管理，guice 还提供了一个“ `Provider<A>`”。这是 javax.inject.Provider 接口的内部实现，其`get()`消息将“ `return injector.getInstance(A.class)`”。您不必自己实现接口，它是“guice 魔法”的一部分。

因此，您可以将 A->B, BA 示例缩短为：

```
public class CircularDepTest {

static class A {
    private final Provider<B> b;
    private String name = "A";

    @Inject
    public A(Provider<B> b) {
        this.b = b;
    }
}

static class B {

    private final Provider<A> a;
    private String name = "B";

    @Inject
    public B(Provider<A> a) {
        this.a = a;

    }
}

@Inject
A a;

@Inject
B b;

@Before
public void setUp() {
    Guice.createInjector().injectMembers(this);
}

@Test
public void testCircularInjection() throws Exception {
    assertEquals("A", a.name);
    assertEquals("B", a.b.get().name);
    assertEquals("B", b.name);
    assertEquals("A", b.a.get().name);
}} 
```

我更喜欢这个，因为它更具可读性（您不会误以为构造函数已经拥有“B”的实例）并且由于您可以自己实现提供程序，它仍然可以在 guice 上下文之外“手动”工作（例如用于测试）。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-04-04T16:02:49.023

我对这个概念很陌生，但这是我的理解。

假设你有接口`A`和`B`，和实现`Ai`和`Bi`。

如果`Ai`对 有依赖关系`B`，并且`Bi`对 有依赖关系`A`，那么 Guice 可以创建一个代理实现`A`（称为它`Ap`），它将在将来的某个时候被赋予一个`Ai`委托给。Guice 给出`Ap`了`Bi`它对 的依赖`A`，允许`Bi`完成实例化。然后，既然`Bi`已经实例化了，Guice 就可以`Ai`用`Bi`. 然后，既然`Ai`现在可以做，Guice 告诉`Ap`委派给`Ai`.

如果`A`and`B`不是接口（而你只是有`Ai`and `Bi`）这是不可能的，因为创建`Ap`需要你扩展`Ai`，而扩展已经需要一个`Bi`.

以下是代码的样子：

```
public interface A {
    void doA();
}

public interface B {
    void doB();
}

public class Ai implements A {

   private final B b;

   @Inject
   public Ai(B b) {
       this.b = b;
   }

   public void doA() {
       b.doB();
   }
}

public class Bi implements B {
   private final A a;

   @Inject
   public Bi(A a) {
       this.a = a;
   }

   public void doB() {
   }
} 
```

Guice 制作的代理类如下所示：

```
public class Ap implements A {
    private A delegate;
    void setDelegate(A a) {
        delegate = a;
    }

    public void doA() {
        delegate.doA();
    }
} 
```

这一切都将使用这个基本思想进行连接：

```
Ap proxyA = new Ap();
B b = new B(proxyA);
A a = new A(b);
proxyA.setDelegate(a); 
```

这就是如果你只有`Ai`and `Bi`，没有接口`A`和`B`.

```
public class Ap extends Ai {
    private Ai delegate;

    public Ap() {
       super(_); //a B is required here, but we can't give one!
    }
} 
```

> 如果我只是在接口后面抛出足够多的类，一切都会好吗？

我猜想在构造函数中如何与代理进行交互有严格的限制。换句话说，如果 B 在 Guice 有机会用真正的 A 填充 A 的代理之前尝试调用 A，那么我会期待 RuntimeException。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2016-08-09T02:05:54.643

这是@jan-galinski 的答案，在 Scala 中重做：

```
import javax.inject.Inject
import com.google.inject.{Guice, Injector, Provider}
import net.codingwell.scalaguice.InjectorExtensions._

/** Demonstrates the problem by failing with `Tried proxying CircularDep1$A to support a circular dependency, but it is not an interface.
  while locating CircularDep1$A for parameter 0 at CircularDep1$B.<init>(CircularDep.scala:10)
  while locating CircularDep1$B for parameter 0 at CircularDep1$A.<init>(CircularDep.scala:6)
  while locating CircularDep1$A` */
object CircularDep1 extends App {
  class A @Inject() (val b: B) {
    val name = "A"
  }

  class B @Inject() (val a: A) {
    val name = "B"
  }

  val injector: Injector = Guice.createInjector()
  val a: A = injector.instance[A]
  val b: B = injector.instance[B]

  assert("A" == a.name)
  assert("B" == a.b.name)
  assert("B" == b.name)
  assert("A" == b.a.name)
  println("This program won't run!")
}

/** This version solves the problem by using `Provider`s */
object CircularDep2 extends App {
  class A @Inject() (val b: Provider[B]) {
    val name = "A"
  }

  class B @Inject() (val a: Provider[A]) {
    val name = "B"
  }

  val injector: Injector = Guice.createInjector()
  val a: A = injector.instance[A]
  val b: B = injector.instance[B]

  assert("A" == a.name)
  assert("B" == a.b.get.name)
  assert("B" == b.name)
  assert("A" == b.a.get.name)
  println("Yes, this program works!")
} 
```

# ios - 在 iphone/ipad 扬声器中录制音频

> ID：10014826
> 
> 赞同：-2
> 
> 时间：2012-04-04T15:56:18.960
> 
> 标签：ios, audio, record, speaker

我想知道是否存在录制 iphone/iPad 扬声器中音频的解决方案。

我尝试制作一个能够在对话期间录制音频的应用程序。

谢谢你的帮助，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-04T16:01:05.287

有两个原因导致创建应用程序来执行此操作是不可能或不切实际的。

#1) Apple**不会**批准可能侵犯客户隐私权的应用程序。如果您可以录制对话，那可能是隐私问题，也可能是非法的。

#2）当一个呼叫正在进行时（或者，至少在开始时，直到你退出它），你不能在前台有另一个应用程序。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-04T16:00:58.073

[http://www.recordertheapp.com/](http://www.recordertheapp.com/)

（第一个 google 搜索结果来自：record audio in iphone）

# javascript - jQuery点击操作只执行一次

> ID：10014827
> 
> 赞同：1
> 
> 时间：2012-04-04T15:56:24.940
> 
> 标签：javascript, jquery

```
$("#button_title_delete").click(function(){
    jQuery.ajax({type:'POST', 
            url:'delete.php',
            data: 'id='+$("bid").val(), 
            success: function(veri) { $("#delete_result").html(veri);}
        });
    }); 
```

当我单击带有“button_title_delete” id 的按钮时，此功能仅工作一次。我究竟做错了什么？我应该如何解决这个问题？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-04T15:58:11.717

可能是因为您要替换`success`AJAX 函数回调上的按钮。您需要使用 jQuery 的[`.on()`](http://api.jquery.com/on/)方法来附加点击事件。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-04T15:59:04.010

我的猜测是按钮在`$("#delete_result")`. 当您这样做时`$("#delete_result").html(veri)`，您将删除按钮（及其事件），然后制作一个新按钮。

您需要使按钮具有“实时”事件。像这样：

```
$("#delete_result").on("click", "#button_title_delete", function(){
    jQuery.ajax({type:'POST', 
            url:'delete.php',
            data: 'id='+$("bid").val(), 
            success: function(veri) { $("#delete_result").html(veri);}
        });
    }); 
```

演示：http: [//jsfiddle.net/pujr8/](http://jsfiddle.net/pujr8/)

# android - 获取用于访问电话联系人的帐户类型的联系人表

> ID：10014832
> 
> 赞同：1
> 
> 时间：2012-04-04T15:56:45.487
> 
> 标签：android

我有一个要求，我必须将联系人添加到电话联系人中。我有华为安卓手机，我的手机联系人帐户类型为“com.android.huawei.phone”，帐户名称为“PHONE”。使用此数据，我成功插入了联系人，电话联系人中也出现了相同的内容。但是，这将使我的应用程序设备特定。有什么方法可以让应用程序在每台设备上运行吗？是否有任何标准应该声明联系表的帐户类型和名称？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T17:41:55.827

我的问题已经解决了。如果我们将帐户名称和帐户类型分配为**null**，那么我们可以轻松地在电话联系人中添加联系人。

# android - 使用 while 循环检查数据库问题中的条目

> ID：10014834
> 
> 赞同：0
> 
> 时间：2012-04-04T15:56:48.380
> 
> 标签：android, database, sqlite, cursor, rows

```
 Integer c=0;

 DatabaseHelper dbh1 = new DatabaseHelper(this);
 Cursor ca = dbh1.getReadableDatabase().query(DatabaseHelper.TABLE_NAME, null, null, null, null, null, null);

 while (ca.moveToNext()) 

 { 
     String Ans6 = ca.getString(ca.getColumnIndex(DatabaseHelper.VALUE6));
     if ( Ans6.equals("Automatic"))
      {
       c+=1;
      }  
 }
 String strI = Integer.toString(c);

 Toast toast=Toast.makeText(this, strI, 2000);
 toast.show(); 
```

我在 android 中有一个 SQlite 数据库设置。该表已成功设置，我正在尝试检查列 VALUE6 中的值是否与自动匹配。游标必须遍历每一行并检查该行中 VALUE6 的值并返回有多少行具有自动。我的代码对吗？有任何想法吗？每次运行代码时，strI 都会返回 0。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-04T16:38:33.640

这是一种蛮力的做法。为什么不查询该值，然后获取返回游标中的行数？

```
Cursor ca = dbh1.getReadableDatabase().query(DatabaseHelper.TABLE_NAME, null, DatabaseHelper.VALUE6 + "='AUTOMATIC'", null, null, null, null);
int count = ca.getCount(); 
```

希望这可以帮助！

# r - 在 R 中，如何创建另一个变量，其值基于 FAVECTOR

> ID：10014837
> 
> 赞同：0
> 
> 时间：2012-04-04T15:56:59.947
> 
> 标签：r, categories

变量 EVENT 是以分钟为单位的事件发生的时间。

例如，`EVENT[1] = 15, EVENT[100]= 3400`。

现在我想创建一个新变量 TIME。

如果 EVEN[n] 在区间`(34*(i-1)+1, 34*i], then TIME[n] = i`.

如何创建新变量 TIME？

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T01:47:09.990

对于每个 n > 1，我们有 TIME[n] = EVENT[n] %/% 34（整数除法）。

因此，产生 TIME 的代码是：

```
TIME <- EVENT %/% 34 
```

# android - 什么代码抛出空指针异常？

> ID：10014838
> 
> 赞同：0
> 
> 时间：2012-04-04T15:57:06.000
> 
> 标签：android, nullpointerexception

我也是 Java 和 Android 开发的新手，在我的 Wildfire S 上制作一个简单的游戏已经有一段时间了，一切进展顺利，除了每当我得到一个空指针异常时，我似乎无法找到究竟是什么导致了它。

我搜索过的所有论坛都详细说明了空指针异常是什么或如何先发制人地克服它们，但这不是我需要的。

我在这里面临的问题是 Eclipse 似乎引起我注意的部分代码似乎完全没问题，而我根本没有编辑它。所以我可能在某个地方错误地改变了一些东西。不知道哪个区域已被编辑，我似乎无法找出引发错误的原因。

日志似乎告诉我错误发生在 GoalieMenu.java 中的 onCreate 方法中，该方法已经很长时间没有被编辑了。它只是一个使用 mainmenu.xml 作为其布局的 Activity，其中包含三个按钮（开始、howToPlay 和 Exit），每个按钮都有自己的 XML，它们看起来都很好......

我担心这将是一件非常愚蠢和明显的事情，但我对我正在看的东西不是很熟悉，所以我花了很长时间才找到它！gr

这是日志：

```
04-04 16:27:57.277: ERROR/AndroidRuntime(2831): FATAL EXCEPTION: main
04-04 16:27:57.277: ERROR/AndroidRuntime(2831): java.lang.RuntimeException: Unable 
to  start activity     
ComponentInfo{com.luk.games.Goalie/com.luk.games.Goalie.GoalieMenu}:
java.lang.NullPointerException
04-04 16:27:57.277: ERROR/AndroidRuntime(2831):     at 
android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1830)
04-04 16:27:57.277: ERROR/AndroidRuntime(2831):     at 
android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:1851)
04-04 16:27:57.277: ERROR/AndroidRuntime(2831):     at 
android.app.ActivityThread.access$1500(ActivityThread.java:132)
04-04 16:27:57.277: ERROR/AndroidRuntime(2831):     at 
android.app.ActivityThread$H.handleMessage(ActivityThread.java:1038)
04-04 16:27:57.277: ERROR/AndroidRuntime(2831):     at 
android.os.Handler.dispatchMessage(Handler.java:99)
04-04 16:27:57.277: ERROR/AndroidRuntime(2831):     at 
android.os.Looper.loop(Looper.java:150)
04-04 16:27:57.277: ERROR/AndroidRuntime(2831):     at 
android.app.ActivityThread.main(ActivityThread.java:4277)
04-04 16:27:57.277: ERROR/AndroidRuntime(2831):     at 
java.lang.reflect.Method.invokeNative(Native Method)
04-04 16:27:57.277: ERROR/AndroidRuntime(2831):     at 
java.lang.reflect.Method.invoke(Method.java:507)
04-04 16:27:57.277: ERROR/AndroidRuntime(2831):     at 
com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:839)
04-04 16:27:57.277: ERROR/AndroidRuntime(2831):     at 
com.android.internal.os.ZygoteInit.main(ZygoteInit.java:597)
04-04 16:27:57.277: ERROR/AndroidRuntime(2831):     at 
dalvik.system.NativeStart.main(Native Method)
04-04 16:27:57.277: ERROR/AndroidRuntime(2831): Caused by: 
java.lang.NullPointerException

04-04 16:27:57.277: ERROR/AndroidRuntime(2831):     at 
com.luk.games.Goalie.GoalieMenu.onCreate(GoalieMenu.java:34)
04-04 16:27:57.277: ERROR/AndroidRuntime(2831):     at 
android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1072)
04-04 16:27:57.277: ERROR/AndroidRuntime(2831):     at 
android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1794)
04-04 16:27:57.277: ERROR/AndroidRuntime(2831):     ... 11 more 
```

这是 GoalieMenu.java：

```
package com.luk.games.Goalie;

import android.app.Activity;
import android.content.Intent;
import android.os.Bundle;
import android.view.View;
import android.view.View.OnClickListener;
import android.view.Window;
import android.view.WindowManager;
import android.widget.Button;

public class GoalieMenu extends Activity {

private Button startGameButton;
private Button howToPlayButton;
private Button exitButton;

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
       requestWindowFeature(Window.FEATURE_NO_TITLE);
       getWindow().setFlags(WindowManager.LayoutParams.FLAG_FULLSCREEN, 
               WindowManager.LayoutParams.FLAG_FULLSCREEN);
       setContentView(R.layout.mainmenu);

      this.startGameButton = (Button)this.findViewById(R.id.startGameButton);
      this.startGameButton.setOnClickListener(new OnClickListener() {
      public void onClick(View v) {
          startActivity(new Intent("com.luk.games.Goalie.GameActivity"));       
          }
      });

       this.howToPlayButton = (Button)this.findViewById(R.id.howToPlayButton);
       this.howToPlayButton.setOnClickListener(new OnClickListener() {
           public void onClick(View v) {
              startActivity(new Intent("com.luk.games.Goalie.HowToPlayActivity"));              
            }
        });

       this.exitButton = (Button)this.findViewById(R.id.exitButton);
       this.exitButton.setOnClickListener(new OnClickListener() {
           public void onClick(View v) {
               finish();
           }
       });
}
} 
```

主菜单.xml

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout 
    xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:background="@drawable/mainmenuscreen"
    android:layout_height="match_parent" android:orientation="vertical">
<Button 
    android:id="@+id/startGameButton"
    android:background="@layout/startgamebutton"
    android:layout_height="50dp" 
    android:layout_width="180dp"
    android:layout_gravity="center"
    android:layout_marginTop="100dip"/>
<Button 
    android:id="@+id/howToPlayButton"
    android:background="@layout/howtoplaybutton"
    android:layout_height="50dp" 
    android:layout_width="180dp"
    android:layout_gravity="center"/>
<Button
    android:id="@+id/exitButton"
    android:background="@layout/exitbutton"
    android:layout_height="50dp"
    android:layout_width="180dp"
    android:layout_gravity="center"/>
</LinearLayout> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-04T16:01:05.763

GoalieMenu.java:34，我想是这个这个`howToPlayButton.setOnClickListener`

howToPlayButton 可能为空。

调试和使用`try`以及`catch`您怀疑的地方。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-04T16:06:53.397

我最好的猜测是您的其中一个`findViewById`陈述有问题 - 检查 R.id 是否引用了该元素。实际上存在于您的布局 xml 中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-04T17:17:13.980

对您的代码进行细微更改并尝试以下操作::::

```
public class GoalieMenu extends Activity {

private Button startGameButton;
private Button howToPlayButton;
private Button exitButton;

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
       requestWindowFeature(Window.FEATURE_NO_TITLE);
       getWindow().setFlags(WindowManager.LayoutParams.FLAG_FULLSCREEN, 
               WindowManager.LayoutParams.FLAG_FULLSCREEN);
       setContentView(R.layout.mainmenu);

      findViewById(R.id.startGameButton).setOnClickListener(new OnClickListener() {
      public void onClick(View v) {
          startActivity(new Intent("com.luk.games.Goalie.GameActivity"));       
          }
      });

      findViewById(R.id.howToPlayButton).setOnClickListener(new OnClickListener() {
           public void onClick(View v) {
              startActivity(new Intent("com.luk.games.Goalie.HowToPlayActivity"));              
            }
        });

       findViewById(R.id.exitButton).setOnClickListener(new OnClickListener() {
           public void onClick(View v) {
               finish();
           }
       });
}
} 
```

尝试这个....

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-04T16:03:42.900

尝试如下开始一个新活动：

```
startActivity(new Intent(getApplicationContext(), 
        GameActivity.class)); 
```

同样对于`HowToPlayActivity`

# networking - 在 mongodb 中获取更改文档的通知

> ID：10014839
> 
> 赞同：12
> 
> 时间：2012-04-04T15:57:06.780
> 
> 标签：networking, mongodb, configuration

我正在尝试使用 mongodb 作为网络范围的配置存储。这个相同的应用程序在网络上的多台机器上运行，每台机器都从其本地 mongodb 中提取其配置。mongodbs 已同步。如果一个应用程序更改了任何配置值，我想要的是在所有 n-1 个应用程序中获得回调/通知。这种设置可能吗？

（这将使我免于自己进行网络传输/同步等。）

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2017-11-08T16:24:26.507

从 mongodb 3.6 开始，您现在可以将操作挂钩到更改流。这为您提供了一个可尾光标，您可以使用它来监听特定集合上的更改（例如 crud 操作）。

变更流建立在 oplog 之上，任何使用 oplog 的东西都可以访问。更改流是可恢复的，也可以与聚合运算符一起使用，例如 $match、$project...

更多信息（Java 示例）： http: [//mongodb.github.io/mongo-java-driver/3.6/driver/tutorials/change-streams/](http://mongodb.github.io/mongo-java-driver/3.6/driver/tutorials/change-streams/)

这是来自[https://www.mongodb.com/mongodb-3.6](https://www.mongodb.com/mongodb-3.6) (Java) 的片段：

```
// 1\. The database for reactive, real-time applications
 MongoClient mongoClient;

// Create a new MongoClient with a MongoDB URI string.
if (args.length == 0) {
// Defaults to a localhost replicaset on ports: 27017, 27018, 27019
  mongoClient = new MongoClient(new
  MongoClientURI("mongodb://localhost:27017,localhost:27018,localhost:27019"));
} else {
  mongoClient = new MongoClient(new MongoClientURI(args[0]));
}

// Select the MongoDB database.
MongoDatabase database = mongoClient.getDatabase("testChangeStreams");
database.drop();
sleep();

// Select the collection to query.
MongoCollection<Document> collection = database.getCollection("documents");

// Create the change stream cursor.
MongoCursor<Document> cursor = collection.watch().iterator(); 
```

如果您使用 C#，可以在[此处](https://github.com/mongodb/mongo-csharp-driver/blob/master/tests/MongoDB.Driver.Examples/ChangeStreamExamples.cs)找到示例：

```
 var inventory = database.GetCollection<BsonDocument>("inventory");

    var document = new BsonDocument("x", 1);
    inventory.InsertOne(document);
    new Thread(() =>
    {
        Thread.Sleep(TimeSpan.FromMilliseconds(100));
        var filter = new BsonDocument("_id", document["_id"]);
        var update = "{ $set : { x : 2 } }";
        inventory.UpdateOne(filter, update);
    })
    .Start();

    // Start Changestream Example 2
    var options = new ChangeStreamOptions { FullDocument = ChangeStreamFullDocumentOption.UpdateLookup };
    var enumerator = inventory.Watch(options).ToEnumerable().GetEnumerator();
    enumerator.MoveNext();
    var next = enumerator.Current;
    enumerator.Dispose();
    // End Changestream Example 2

    var expectedFullDocument = document.Set("x", 2);
    next.FullDocument.Should().Be(expectedFullDocument); 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-04-04T17:19:22.513

MongoDB 还没有触发器，但是您可以挂钩您的应用程序以终止 oplog 集合，并在每次删除（或更新或插入等）文档时执行一些操作

此处的 3 部分博客文章可能对如何执行此操作有所帮助： [http ://www.kchodorow.com/blog/2010/10/12/replication-internals/](http://www.kchodorow.com/blog/2010/10/12/replication-internals/)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-04T18:57:43.610

你是什​​么意思mongodbs是同步的？他们真的在彼此之间复制数据吗？我认为不会，因为这听起来好像您想管理该同步。

过去，我用 MongoDB 和 asp 完成了类似的事情，这需要一个集中的 mongo 实例（副本对等）。基本上，每次对本地实例进行更改时，中央实例上的上限集合也会使用新版本的配置值以及该值上次更新时间和哪个服务器更新该值的时间戳进行更新。

然后在各个服务器上运行一个单独的线程，该线程使可尾游标对中央实例保持打开状态。每当游标检索到新记录时，都会将新值与本地实例的时间戳进行比较，并相应地更新（或不更新）。在比较那些时间戳和进行更改的“权威”服务器时必须小心，以确保您不会遇到更新风暴。您还需要知道更新是因为有人实际更改了值还是因为该值被“复制”了 - 如果更新是复制更新，您不想更新中央实例。

# php - PHP IOS 推送通知（权限被拒绝）

> ID：10014844
> 
> 赞同：0
> 
> 时间：2012-04-04T15:57:47.227
> 
> 标签：php, ios, apple-push-notifications

从昨晚开始，我一直在寻找答案，但似乎找不到遇到完全相同问题的人。类似但不是。我正在尝试通过 stream_socket_client 连接到 Apples APNS。我在 LAMP 环境中工作，并打开了 2195 端口。我的 errorString 说**（权限被拒绝）**。我的麻烦是找到发布了很多关于此错误的信息的人。我从错误报告中得到的警告是**警告：stream_socket_client（）：无法连接到 ssl://gateway.sandbox.push.apple.com:2195（权限被拒绝）**

至于好东西。我写了一个类来处理这个推送通知。这是设置连接的未完成方法。

```
 public function setConnection() {

        $apnsHost = 'gateway.sandbox.push.apple.com';
        $apnsPort = 2195;
        $apnsCert = '../model/apns-dev.pem';

        $streamContext = stream_context_create();
        stream_context_set_option($streamContext, 'ssl', 'local_cert', $apnsCert);
        stream_context_set_option($streamContext, 'ssl', 'passphrase', "********");
        stream_context_set_option($streamContext, 'ssl', 'verify_peer', true);

        $apns = stream_socket_client('ssl://'.$apnsHost.':'. $apnsPort, $error, $errorString, 20, STREAM_CLIENT_CONNECT , $streamContext);

    } 
```

对我来说，这看起来是对的，但很明显，这是不对的。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2015-05-04T16:46:45.957

这是一个 SELinux 会议

问题出`httpd_can_network_connect`在 Fedora 12 中默认开启的 SELinux 设置。

在 shell 控制台中，以 root 身份运行：

```
/usr/sbin/setsebool httpd_can_network_connect=1 
```

参考：[http ://www.rkrishardy.com/2009/12/permission-denied-13-when-opening-socket-in-php-apache/](http://www.rkrishardy.com/2009/12/permission-denied-13-when-opening-socket-in-php-apache/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-05T09:07:30.870

以下教程中的 simplepush.php 代码对我来说效果很好。 [http://www.raywenderlich.com/3443/apple-push-notification-services-tutorial-part-12](http://www.raywenderlich.com/3443/apple-push-notification-services-tutorial-part-12)

```
$ctx = stream_context_create();
stream_context_set_option($ctx, 'ssl', 'local_cert', 'ck.pem');
stream_context_set_option($ctx, 'ssl', 'passphrase', $passphrase);

// Open a connection to the APNS server
$fp = stream_socket_client(
    'ssl://gateway.sandbox.push.apple.com:2195', $err,
    $errstr, 60, STREAM_CLIENT_CONNECT|STREAM_CLIENT_PERSISTENT, $ctx); 
```

# ruby-on-rails - 在 Rails（本地）开发环境中并行运行 HTTP 和 HTTPS

> ID：10014846
> 
> 赞同：2
> 
> 时间：2012-04-04T15:57:49.307
> 
> 标签：ruby-on-rails, apache, ssl, https, thin

我有一个 Rails 应用程序，其中包含一些必须使用 HTTPS/SSL 保护的 URL，以及一些必须通过 HTTP 访问的 URL。

我正在使用 Thin，并以 --ssl 标志开头意味着它只支持 HTTPS，并且不处理任何 HTTP 请求。我正在使用 force_ssl 在特定 URL 上强制使用 ssl。据我了解，我需要以某种方式修改 Apache。

如何让 HTTP 和 HTTPS 在我的（本地）开发环境中工作？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-04T16:11:18.693

我记得不可能在一个站点上运行 https 和 http - 一开始它们正在侦听不同的端口，因此实际上您正在考虑将您的内容分成两个不同的部分，一个用于 http 站点，另一个用于对于 https。您可以将两个站点指向同一个应用程序（因此两者的主目录相同），但如果您选择这样做，则需要非常小心，以确保您检查受保护的文件是否只能通过 HTTPS 访问，并且很容易意外引入安全问题。好处是您的资产可以在两个位置都可用，这样您就不必弹出有关安全区域中不安全内容的警告等等。如果您需要足够的安全性来证明 HTTPS 的合理性，那么值得了解两种访问单个位置的方式所带来的风险。另外，我记得（自从我使用这个已经有几年了，所以有人可能会纠正我）在常规和安全区域之间不会保留任何客户端身份验证，因为浏览器将它们视为两个不同的站点.

[将 Apache 配置为为同一地址提供 HTTP 和 HTTPS](http://lookit.typepad.com/lookit/2010/04/how-to-get-apache-to-do-both-http-and-https-on-one-ip-address.html)

# android - Android EditText 标题（标题），如 android 指南

> ID：10014848
> 
> 赞同：2
> 
> 时间：2012-04-04T15:57:52.563
> 
> 标签：android, android-layout, android-edittext

我想让每个 EditText 对象都有自己的标题，就像纯 Android 指南（[截图](http://cl.ly/122i293L1b3O090R1f1q)）

这个东西有原生支持吗？我想他们也可能会使用带有部分的列表视图，但这对于本机应用程序来说似乎很奇怪。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-04T17:25:59.250

没有本机支持，但我们有几个解决方案。1）创建一个布局文件，因为您需要在edittext等上方的textview，并且每次只需将此布局包含在您的XML文件中。

可以使用以下语法将布局包含在其他布局中：

```
<include layout = "@layout/dependent_care" android:layout_height="wrap_content" 
 android:layout_width="fill_parent" android:id="@+id/include_dependent_care"/> 
```

2) 正如 Josephus Villarey 建议的那样，扩展 EditText 并根据需要为其提供该功能..

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-04T16:02:21.463

不，没有对此类的本机支持。尽管扩展 EditText 并为其提供该功能非常容易，但您始终可以在 EditText 上方使用 TextView。

# java - 尝试使用“http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd”实体解析文档时出现 java.net.MalformedURLException

> ID：10014849
> 
> 赞同：1
> 
> 时间：2012-04-04T15:57:58.080
> 
> 标签：java, entity, html-parsing, xerces

我正在使用 Java 6 并尝试解析以

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"> 
```

我下载了实体 DTD，“http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd”，并将它放在我的类路径中。但是，当我尝试使用（注意使用自定义实体解析器）解析文档时......

```
 DocumentBuilderFactory factory = DocumentBuilderFactory.newInstance();
    factory.setValidating(false);
    factory.setExpandEntityReferences(false);
    final DocumentBuilder builder = factory.newDocumentBuilder();
    builder.setEntityResolver(new EntityResolver() {
        @Override
        public InputSource resolveEntity(String publicId, String systemId) {
            InputSource inputSource = null;
            try {
                final String resource = systemId.substring(systemId.lastIndexOf("/") + 1);
                final InputStream inputStream = getClass().getClassLoader().getResourceAsStream(resource);
                inputSource = new InputSource(inputStream);
            } catch (Exception e) {
                // No action; just let the null InputSource pass through
            }
            return inputSource;
        }
    });
    final InputSource s = new InputSource(new StringReader(str));
    org.w3c.dom.Document result = builder.parse(s); 
```

我在“builder.parse(s)”行上得到以下异常。我怎样才能毫无例外地解析文档，或者至少我怎样才能弄清楚这个东西在抱怨什么 URL？

```
java.net.MalformedURLException
    at java.net.URL.<init>(URL.java:601)
    at java.net.URL.<init>(URL.java:464)
    at java.net.URL.<init>(URL.java:413)
    at com.sun.org.apache.xerces.internal.impl.XMLEntityManager.setupCurrentEntity(XMLEntityManager.java:650)
    at com.sun.org.apache.xerces.internal.impl.XMLEntityManager.startEntity(XMLEntityManager.java:1315)
    at com.sun.org.apache.xerces.internal.impl.XMLEntityManager.startDTDEntity(XMLEntityManager.java:1282)
    at com.sun.org.apache.xerces.internal.impl.XMLDTDScannerImpl.setInputSource(XMLDTDScannerImpl.java:283)
    at com.sun.org.apache.xerces.internal.impl.XMLDocumentScannerImpl$DTDDriver.dispatch(XMLDocumentScannerImpl.java:1194)
    at com.sun.org.apache.xerces.internal.impl.XMLDocumentScannerImpl$DTDDriver.next(XMLDocumentScannerImpl.java:1090)
    at com.sun.org.apache.xerces.internal.impl.XMLDocumentScannerImpl$PrologDriver.next(XMLDocumentScannerImpl.java:1003)
    at com.sun.org.apache.xerces.internal.impl.XMLDocumentScannerImpl.next(XMLDocumentScannerImpl.java:648)
    at com.sun.org.apache.xerces.internal.impl.XMLDocumentFragmentScannerImpl.scanDocument(XMLDocumentFragmentScannerImpl.java:511)
    at com.sun.org.apache.xerces.internal.parsers.XML11Configuration.parse(XML11Configuration.java:808)
    at com.sun.org.apache.xerces.internal.parsers.XML11Configuration.parse(XML11Configuration.java:737)
    at com.sun.org.apache.xerces.internal.parsers.XMLParser.parse(XMLParser.java:119)
    at com.sun.org.apache.xerces.internal.parsers.DOMParser.parse(DOMParser.java:235)
    at com.sun.org.apache.xerces.internal.jaxp.DocumentBuilderImpl.parse(DocumentBuilderImpl.java:284)
    at com.myco.myproject.util.XmlUtilities.getStringAsDocument(XmlUtilities.java:147)
    at com.myco.myproject.util.NetUtilities.getUrlAsDocument(NetUtilities.java:67)
    at com.myco.myproject.parsers.impl.InstitutoCervantes.parsePage(InstitutoCervantes.java:84)
    at com.myco.myproject.parsers.impl.InstitutoCervantes.getEvents(InstitutoCervantes.java:52)
    at com.myco.myproject.domain.EventFeed.refresh(EventFeed.java:81)
    at com.myco.myproject.domain.EventFeed.getEvents(EventFeed.java:72)
    at com.myco.myproject.parsers.impl.InstitutoCervantesParserTest.testParser(InstitutoCervantesParserTest.java:24)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
    at java.lang.reflect.Method.invoke(Method.java:597)
    at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:44)
    at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:15)
    at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:41)
    at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:20)
    at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:28)
    at org.springframework.test.context.junit4.statements.RunBeforeTestMethodCallbacks.evaluate(RunBeforeTestMethodCallbacks.java:74)
    at org.springframework.test.context.junit4.statements.RunAfterTestMethodCallbacks.evaluate(RunAfterTestMethodCallbacks.java:83)
    at org.springframework.test.context.junit4.statements.SpringRepeat.evaluate(SpringRepeat.java:72)
    at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.runChild(SpringJUnit4ClassRunner.java:231)
    at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:50)
    at org.junit.runners.ParentRunner$3.run(ParentRunner.java:193)
    at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:52)
    at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:191)
    at org.junit.runners.ParentRunner.access$000(ParentRunner.java:42)
    at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:184)
    at org.springframework.test.context.junit4.statements.RunBeforeTestClassCallbacks.evaluate(RunBeforeTestClassCallbacks.java:61)
    at org.springframework.test.context.junit4.statements.RunAfterTestClassCallbacks.evaluate(RunAfterTestClassCallbacks.java:71)
    at org.junit.runners.ParentRunner.run(ParentRunner.java:236)
    at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.run(SpringJUnit4ClassRunner.java:174)
    at org.eclipse.jdt.internal.junit4.runner.JUnit4TestReference.run(JUnit4TestReference.java:50)
    at org.eclipse.jdt.internal.junit.runner.TestExecution.run(TestExecution.java:38)
    at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.runTests(RemoteTestRunner.java:467)
    at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.runTests(RemoteTestRunner.java:683)
    at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.run(RemoteTestRunner.java:390)
    at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.main(RemoteTestRunner.java:197) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-04T16:13:23.200

检查“资源”的值是什么，并确保它指向本地机器中的正确文件。

# c# - Linq to SQL C#获取所有子/子子类别中的产品太慢

> ID：10014855
> 
> 赞同：5
> 
> 时间：2012-04-04T15:58:15.417
> 
> 标签：c#, asp.net, linq, linq-to-sql

获取所选主类别的所有子类别中的所有产品的最佳方法是什么？试图在大约 80 个子类别中获取 10000 个产品，但这种方法太慢了。有什么建议么？使用 c# 和 Linq to SQL

```
//list for the child categories
private List<int> catsChildList = new List<int>();

GetChildCats(123);

//get all the child categories of main category '123'

private void GetChildCats(int _parentCat)
{
    var cats = (from c in db2.tbl_cart_categories
                where c.ParentID == _parentCat
                select new { c.CategoryID });
    if (cats.Count() > 0)
    {
        foreach (var cat in cats)
        {
            int _cat = Convert.ToInt32(cat.CategoryID);
            catsChildList.Add(_cat);
            GetChildCats(_cat);
        }
    }
}

//Get the products
var products = (from p in db2.products_infos
            where  p.IsEnabled == true
            group p by p.ProdID
            into g where g.Any(x => catsChildList.Contains(Convert.ToInt32(x.CategoryID))) 
```

返回结果大约需要 6 秒

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-04T17:11:12.767

和有什么区别

```
var products = 
    (
     from p in db2.products_infos
     where  p.IsEnabled == true
     group p by p.ProdID
     into g where g.Any(x => catsChildList.Contains(Convert.ToInt32(x.CategoryID)))
     select g
    ); 
```

和

```
 var tmpList = 
    (
     from p in db2.products_infos
     where  p.IsEnabled == true 
            && catsChildList.Contains(Convert.ToInt32(p.CategoryID))) 
     select p
    ).ToList();

 var products = 
     (from r in tmpList group p by r.ProdID into g select g); 
```

?

也许我的架构不同，但是当我使用 Linq2Sql 尝试此操作时，它似乎返回相同的结果，但后者在一次数据库命中中返回所有结果，而前者发出多个请求。（如果返回的产品数量是 10000，它将执行 10001 个数据库请求）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-04T16:06:39.730

根据提供的统计信息和代码，您应该通过删除此行来节省 3 秒：

```
if (cats.Count() > 0) 
```

...因为它使枚举加倍（并且鉴于这意味着您将数据库调用加倍，这完全是糟糕的）*并且*几乎毫无意义，因为如果 Count == 0 之后没有任何东西会崩溃。

如果您使用的是 MS SQL Server，那么他们提供的 Profiler 就是您的朋友，因为您可能会看到额外的数据库命中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-04T16:28:59.120

一种。以下代码行是通过 GetChildCats() 方法替换第一行的 lambda 表达式。

```
var findCatList = (List<int> parent) => {        
    from c in db2.tbl_cart_categories
            where  & c.ParentID == _parentCat
            select (db2.tbl_cart_categories.Any(cat=> cat.ParentID == c.CategoryID) ?
                findCatList(c.CategoryID)
                :new { c.CategoryID }                    
                )}

var catList = findCatList(123); 
```

但即使这样也会进行递归，但会在内部完成。请检查一下。当然，它只是基于您的对象的未经测试的代码。

湾。其他认为您可以尝试的是，您可以尝试将 db2.tbl_cart_categories 替换为 db2.tbl_cart_categories.AsParallel()。我不确定对象上下文/数据上下文如何处理这个问题。但是 db2 不是上下文对象，那么我相信它会提高性能。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-04T16:32:43.283

首先，虽然你没有具体说明，但我假设你使用的是 Linq to Sql。请更新您的问题以包含该信息。

首先添加一些基本的分析。哪个查询运行时间最长？

```
g.Any(x => catsChildList.Contains(Convert.ToInt32(x.CategoryID))) 
```

这绝对是可疑的。如果catsChildList 有很多值，您可能会生成一个巨大的IN 子句，该子句总是运行缓慢。您可以通过检查正在运行的实际 SQL 语句来验证这一点。

事实是，当您尝试在应用程序中执行每次迭代时，像这样的递归层次结构遍历永远不会有效。使用存储过程将获得更好的性能。

# bean-validation - 重用验证器

> ID：10014861
> 
> 赞同：1
> 
> 时间：2012-04-04T15:58:39.183
> 
> 标签：bean-validation, hibernate-validator

我想创建自己的 Annatotation 约束，因为我有一个字符串，其中包含用逗号分隔的电子邮件列表。

我从这里关注文档：http: [//docs.jboss.org/hibernate/validator/4.1/reference/en-US/html/validator-customconstraints.html](http://docs.jboss.org/hibernate/validator/4.1/reference/en-US/html/validator-customconstraints.html)

在我的项目中，我使用 Hibernate Validator 作为 Bean 验证的提供者。我注意到 Hibernate 提供了一个`@Email`约束。

是否可以从我自己的 Validator 类中调用 org.hibernate.validator.constraints.impl.EmailValidator::isValid ？

我做了以下及其工作：

```
public class EmailsValidator implements ConstraintValidator<Emails, String> {

private EmailValidator emailValidator = new EmailValidator();

@Override
public void initialize(Emails constraintAnnotation) {
}

@Override
public boolean isValid(String value, ConstraintValidatorContext context) {
    System.out.println("EmailsValidator::isValid");
    if (value == null || value.isEmpty()) {
        return true;
    }
    final String[] emails = value.split(",\\s*");
    for (String anEmail : emails) {
        System.out.println("anEmail = " + anEmail);
        if (!emailValidator.isValid(anEmail, context)) {
            return false;
        }
    }
    return true;
} 
```

}

这是最有效的方法吗？

再见。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-12T20:32:44.643

I think this approach generally works, but you should be aware that you're relying on an internal class of Hibernate Validator, which might be changed in future releases. An indeed it will be moved to [another package](http://docs.jboss.org/hibernate/validator/4.3/api/index.html?org/hibernate/validator/internal/constraintvalidators/EmailValidator.html) in HV 4.3\. Alternatively you might just copy the regular expressions into your own validator.

# android - OpenGL ES 2.0 - 绘制平行线

> ID：10014862
> 
> 赞同：0
> 
> 时间：2012-04-04T15:58:42.810
> 
> 标签：android, ios, opengl-es, opengl-es-2.0

我非常精通 OpenGL 和 GLSL，尽管我目前只用 C++ 编写了 OpenGL / GLUT 或 GLMan 编写 GLSL。我一直在研究移动设备上的 OpenGL，特别是 Android，并且有几个问题。

首先，我知道你必须在 ES 2.0 中“对整个管道进行编程”，但我相信这就是我一直在做的事情，在 GLSL 中，对吧？创建`.vert`和`.frag`文件，等等？

其次，我一直在看[这个](http://developer.android.com/resources/tutorials/opengl/opengl-es20.html)教程，它似乎很有帮助，但首先让我感到困惑的是顶点/片段着色器代码。有没有办法将其指定为文件？我无法想象必须以那种可怕的字符串连接格式编写着色器。

接下来，首先，查找事物/学习事物的最佳参考是`precision mediump float`什么'更习惯，喜欢`uniform float x`和`varying vec3 y`？

最后，考虑到我至少应该具备一些并行知识，任何人都可以推荐一本学习 OpenGL ES 2.0 的好书吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-04T18:24:15.837

回复：对整个管道进行编程；这可能是您一直在使用着色器所做的事情，但不一定是。当他们在桌面上引入着色器时，他们放置了一大堆向后兼容的东西，例如`ftransform`. 在 ES 2.0 中并非如此。除其他差异外，没有任何矩阵堆栈，也没有预定义的属性或制服。因此，您必须编写比在桌面 GL 2.0 下严格需要的更多的管道，尽管不一定比您要多。

回复：将着色器保存在单独的文件中；这绝对不是问题。`String`只需从文件中加载您的 s。任何旧的 Java 方法都可以，例如[这个](http://snippets.dzone.com/posts/show/1335)。

回复：参考资料；绝对最好的是[OpenGL ES 2.0 API 快速参考卡](http://www.google.com/url?sa=t&rct=j&q=gl%202.0%20reference%20card&source=web&cd=1&ved=0CC0QFjAA&url=http://www.khronos.org/opengles/sdk/docs/reference_cards/OpenGL-ES-2_0-Reference-card.pdf&ei=-5B8T8ukEManiQLYg9ysDQ&usg=AFQjCNG9uvcWPofGVAfGfHe89qy0jgv0jw)（PDF）。OpenGL ES 2.0 的全部内容只有四页。关于您要求的具体内容，请参阅第三页（这是 GLSL 部分的第一页）上的精度限定符。我不知道直接用于绘制平行线的资源，但只需在该文档中搜索任何意外的语法就可以了。不寻常的事情，比如精度限定符，都是微小的调整，你可以通过查看它们本身来轻松理解。

回复：一本书；我没有直接意识到任何事情。我猜默认推荐是[蓝皮书](http://opengles-book.com/)。

# couchdb - 在 CouchDB View Map 函数中使用“limit”参数

> ID：10014870
> 
> 赞同：6
> 
> 时间：2012-04-04T15:59:02.957
> 
> 标签：couchdb, mapreduce

我知道通过 REST API，可以指定“限制”参数（例如 ?limit=5），以限制从 CouchDB 中给定视图返回的结果数量。

我的问题是是否有办法在视图内部的地图功能本身内执行此操作......？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-05T02:57:52.950

您的具体问题的答案是“不”。

map 函数应用于数据库中的每个文档，reduce 函数（如果已定义）应用于每个 reduce 结果。考虑预计算。

您在 URL 中提供的查询参数将应用于您的 MapReduce 函数构建的 B+Tree。例如，如果您说`?limit=5`树中最左边的五个叶子用作结果。或者，如果您说`?limit=5&descending=true`，则将树中最右边的五个叶子用作结果。

但是，您试图通过`?limit=5`在 Map 函数中执行的操作可能会以不同的方式完成。例如，您的应用程序可以在文档中包含一些内容，使它们有条件地包含在结果中。或者强制仅将五个文档标记为索引中，尽管这很麻烦，并且根据您的数据库的大小，成本很高。

干杯。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-07T22:20:42.990

如果您的 UUID 是顺序的（您可以检查您的配置），您可能能够利用它本身来查看前五个文档。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-07-28T04:22:20.170

功能是不可能的`map`。因为 map 将分别处理每个文档，并且可能同时在任何单独的节点上处理。它根本无法了解其他文件

但我认为你想要的将是可能的`reduce`。reduce 将在 map 函数完成所有操作并显示所有结果后运行。所以你可以`map`以任何方式修改结果

简而言之，您可以使用`reduce`相同的键对行进行分组，然后您可以将每个组修剪为只有 5 个结果（`rereduce`如果我没记错的话）

# tsql - 搜索字段上的 TSQL 索引，我应该包括 Id

> ID：10014871
> 
> 赞同：3
> 
> 时间：2012-04-04T15:59:03.733
> 
> 标签：tsql, database-indexes

假设我有一个典型的客户表；

```
Id Int Identity Primary Key, 
FirstName varchar(255), 
LastName varchar(255), 
Phone VarChar(30) 
```

所以主键在 Id 上创建了一个聚集唯一索引。

为了使搜索更快，我想为名称字段添加索引。

我的问题是我是否应该将 Id 添加到这些索引中，或者这些索引是否会与主键相关联。

例如;

```
Create Index IX_Customer_FirstLastName On Customers(FirstName, LastName, Id) 
```

……是不是太过分了？

以下是或多或少有效吗？

```
Create Index IX_Customer_FirstLastName On Customers(FirstName, LastName) 
```

TIA

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-04T16:01:33.923

`ID`将其添加到您的其他索引是没有意义的。只有当您有大量具有相同`firstName` `lastName`组合的行并且您已经知道`ID`...

但是，如果您已经知道`ID`要搜索的记录，则可以使用聚集索引进行搜索。

此外，每个非聚集索引都已包含聚集索引的值，以便在使用非聚集索引找到行后，它可以使用聚集索引查找行。 [如果您想让非聚集索引成为字段的覆盖索引（](http://www.simple-talk.com/sql/learn-sql-server/using-covering-indexes-to-improve-query-performance/)[,](http://www.simple-talk.com/sql/learn-sql-server/using-covering-indexes-to-improve-query-performance/) [,](http://www.simple-talk.com/sql/learn-sql-server/using-covering-indexes-to-improve-query-performance/) [） ，则](http://www.simple-talk.com/sql/learn-sql-server/using-covering-indexes-to-improve-query-performance/)[不必包含在非聚集索引中`ID``FirstName``LastName``Id`](http://www.simple-talk.com/sql/learn-sql-server/using-covering-indexes-to-improve-query-performance/)

最后注意，如果您使用`FirstName`and创建单个索引`LastName`，则该索引将仅用于包含`FirstName`索引前沿的搜索。如果您计划使用 just`LastName`或 just执行搜索`FirstName`，请创建两个索引，每列一个。

# jquery - 滚动条逐步滚动 (html/css/jquery)

> ID：10014874
> 
> 赞同：3
> 
> 时间：2012-04-04T15:59:10.930
> 
> 标签：jquery, html, css, scroll, scrollbar

我做了一个水平滚动条，里面有产品。但是，如果我向右和向后滚动，我只能看到一半的产品，是否可以使用 html/css/jquery 以 200px 的步长滚动？这是产品照片的宽度大小。

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-04T16:03:33.203

您可以使用**[jQuery.ScrollTo 插件](http://demos.flesler.com/jquery/scrollTo/)**

有很多方法可以指定目标，包括像素值。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-04T16:03:19.853

你为什么不使用类似[jCarousel](http://sorgalla.com/jcarousel/)的东西来水平滚动你的产品。

这种类型的示例可能适合您：[http ://sorgalla.com/projects/jcarousel/examples/static_simple.html](http://sorgalla.com/projects/jcarousel/examples/static_simple.html)

# jquery - Rails 中的 Fancybox 表单无法正常工作

> ID：10014876
> 
> 赞同：1
> 
> 时间：2012-04-04T15:59:13.993
> 
> 标签：jquery, ruby-on-rails, forms, tabs, fancybox

我知道我是 Rails 的新手，但这是我要浪费的第二天。有人可以帮我弄清楚我做错了什么吗？

我希望我的用户从主页注册。点击“注册”按钮，一个花式框出现，框内有两个选项卡，因为他们可以在两种不同的注册形式之间进行选择。一切都设置正确，因为幻想框出现了，但里面有一条错误消息。

在**主页中**：

```
<ul class='nav pull-right'>
   <%= render 'devise/menu/registration_items' %>
</ul> 
```

在**registration_items**：

```
<% if society_signed_in? %>
  <li>
    <%= link_to('Edit registration', edit_society_registration_path) %>
  </li>
<% else %>
  <li>
    <%= link_to('Register', regist_setup_path)  %>
  </li>
<% end %> 
```

然后在设置中：

```
<div class="fancybox">
  <h2>Sign up</h2>

  <ul class="nav nav-tabs">
    <li class="active"><a data-toggle="tab" href="#society">Society</a></li>
    <li><a data-toggle="tab" href="#collaborator">Collaborator</a></li>
  </ul>

  <div class="tab-content">
    <div class="tab-pane active" id="society">  
      <%= render :partial => 'societies/form' %>  
    </div>
    <div class="tab-pane" id="collaborator">Collaborator
      <%= render :partial => 'collaborators/form' %>
    </div>
  </div>
</div> 
```

两个 render :partial 只是正确显示表单。**然后在application.js**
中的 Jquery 在所有 //= 之后都需要 blablabla.js

 **```
$(document).ready(function() {
  $(".fancybox").fancybox();
}); 
```

我试图在我的应用程序控制器中设置 @society = Society.new 和 @collaborator = Collaborator.new 但它仍然不起作用

编辑：
发生的情况是我单击注册按钮，出现设置页面，当我单击每个选项卡时，出现以下框：
无法加载请求的内容。请稍后再试。错误信息

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-04T18:55:33.530

我不认为这与 rails 相关——Fancybox 和其他类似的 javascript 插件附加到链接元素，因此当它们被点击时，它将根据链接的 href 加载内容。

您的 jquery 调用应该是（在窗口加载中）

```
$(document).ready(function() {
  $("a.fancybox").fancybox();
}); 
```

所以我想你会想要这个：

```
<%= link_to('Register', "#popup-signup", :class=>"fancybox")  %> 
```

然后弹出的内容：

```
<div id="#popup-signup">
  <h2>Sign up</h2>
  ..more stuff here 
```**

# objective-c - 在 Cocoa 中读取带有进度条的文件

> ID：10014884
> 
> 赞同：2
> 
> 时间：2012-04-04T15:59:37.450
> 
> 标签：objective-c, multithreading, macos, cocoa, grand-central-dispatch

我想创建一个显示文件读取状态的进度条。我使用包含变量 _progress 的 C++ 类阅读器读取文件。

我如何告诉 Cocoa 用 reader._progress 的值更新进度条而不在 Reader 类中编写任何 ObjC 代码？

任何帮助，将不胜感激。

```
ProgressController *pc = [[ProgressController alloc] init];
[pc showWindow:sender];

// Create the block that we wish to run on a different thread
void (^progressBlock)(void);
progressBlock = ^{
    [pc.pi setDoubleValue:0.0];
    [pc.pi startAnimation:sender];

    Reader reader("/path/to/myfile.txt");
    reader.read();

    while (reader._progress < 100.)
    {
        dispatch_async(dispatch_get_main_queue(), ^{
            [pc.pi setDoubleValue:reader._progress];
            [pc.pi setNeedsDisplay:YES];
        });
    }
}; // end of progressBlock

// Finally, run the block on a different thread
dispatch_queue_t queue = dispatch_get_global_queue(0, 0);
dispatch_async(queue, progressBlock); 
```

* * *

所以这是我的第二次尝试。

阅读器代码：

```
class PDBReader
{
public:
Reader(const char *filename);
Reader(string filename);
~Reader();

int read();

string _filename;
float _progress;

void setCallback(void (^cb)(double))
{
    if (_cb)
    {
        Block_release(_cb);
        _cb = Block_copy(cb);
    }
}
void (^_cb)(double);

protected:
private:
};

int Reader::read()
{
string buffer;
unsigned atomid = 0;
ifstream file;
file.open(_filename.c_str(), ifstream::in);

if (!file.is_open())
{
    return IOERROR;
}

file.seekg(0, ios_base::end);
float eof = (float) file.tellg();
file.seekg(0, ios_base::beg);

while (getline(file, buffer))
{
    _progress = (float) file.tellg() / eof * 100.;
    if (_cb)
    {
        _cb(_progress);
    }
        // some more parsing here...
    }
file.close();
return SUCCESS;
}

PDBReader::~PDBReader()
{
if (_cb)
{
    Block_release(_cb);
}
} 
```

还有可可部分：

```
-(IBAction) test:(id) sender
{
ProgressController *pc = [[ProgressController alloc] init];
[pc showWindow:sender];

Reader reader("test.txt");

reader.setCallback(^(double progress) 
{
    dispatch_async(dispatch_get_main_queue(), ^{
        [pc.pi setDoubleValue:progress]; 
        [pc.pi setNeedsDisplay:YES];
    });
});

reader.read();
} 
```

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-04T17:02:07.000

仅仅因为你不想让 Reader 包含 Objective-C 代码并不意味着你只能从外部观察它。它可以通过传入的函数指针调用 C 函数。它可以使用更通用的函子（函数对象）机制。它甚至可以占用一个块。

你绝对不想做那个`while (reader._progress < 100.)`循环。这是一个繁忙的循环。它将以计算机尽可能快的速度旋转更新进度。它将以 100% 的利用率固定 CPU 内核。事实上，它可能会将任务排队到主调度队列的速度快于它们的运行速度。

您只想在 Reader 更新其`_progress`成员时更新进度指示器，这需要 Reader 类的某种合作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-24T09:32:58.470

最后！！！！！

不将其放入队列时效果很好。

```
ProgressController *pc = [[ProgressController alloc] init];
[pc showWindow:sender];
[pc.pi setUsesThreadedAnimation:YES];

Reader reader("test.txt");  
reader.setCallback(^(double progress) 
{
    [pc.pi setDoubleValue:progress]; 
    [pc.pi setNeedsDisplay:YES];
});

reader.read(); 
```

但是你为什么说“这很糟糕，因为它阻塞了主线程”？因为基本上我的程序必须等待文件被读取才能执行其他任何操作。我在这里想念一些基本的优化吗？

非常感谢您的帮助。

# xml - 如何编写允许部分序列不到位的xml架构

> ID：10014887
> 
> 赞同：0
> 
> 时间：2012-04-04T15:59:43.007
> 
> 标签：xml, xsd

我需要编写一个接受 XML 的 XML 模式，例如：

```
<?xml version="1.0" encoding="utf-8"?>
<Data>
  <NodeA>something</NodeA>
  <NodeB>something</NodeB>
  <NodeC>something</NodeC>
  <NodeD>something</NodeD>
</Data>

<?xml version="1.0" encoding="utf-8"?>
<Data>
  <NodeA>something</NodeA>
  <NodeC>something</NodeC>
  <NodeB>something</NodeB>
  <NodeD>something</NodeD>
</Data> 
```

所以总的来说，我希望列表中的元素是有序的，除了列表的一部分可以以任何顺序出现。

但是我为 xsd 文件尝试了几种方法，但它们都不起作用，例如

```
<xs:complexType name="Data">
  <xs:sequence>
    <xs:element name="NodeA"/>
    <xs:all xmlns:xs="">
      <xs:element name="NodeB"/>
      <xs:element name="NodeC"/>
    </xs:all>
    <xs:element name="NodeD"/>
  </xs:sequence>
</xs:complexType> 
```

将 NodeB 和 NodeC 放在一个组中也不起作用。

我用谷歌搜索了这些错误消息，但找不到任何有用的信息……为什么这些 xsds 失败了，我应该如何编写它？谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-04T16:09:12.517

这个怎么样？

```
<?xml version="1.0" encoding="UTF-8"?>
<xs:schema xmlns:xs="http://www.w3.org/2001/XMLSchema">
    <xs:element name="Root">
        <xs:complexType>
            <xs:sequence>
                <xs:element name="NodeA"/>
                <xs:choice>
                    <xs:sequence>
                        <xs:element name="NodeB"/>
                        <xs:element name="NodeC"/>
                    </xs:sequence>
                    <xs:sequence>
                        <xs:element name="NodeC"/>
                        <xs:element name="NodeB"/>
                    </xs:sequence>
                </xs:choice>
                <xs:element name="NodeD"/>
            </xs:sequence>
        </xs:complexType>
    </xs:element>
</xs:schema> 
```

# salesforce - Salesforce/Apex 参数在报告循环中传递

> ID：10014892
> 
> 赞同：1
> 
> 时间：2012-04-04T15:59:56.827
> 
> 标签：salesforce, visualforce, soql

我有一个问题，我似乎无法找到解决方案。

我正在为客户制作一个作为 PDF 格式的 VisualForce 页面，这基本上是一个格式整齐的报告，没有输入文本框等，而且我在访问某些数据（即附件）时遇到了麻烦。

附件通常是机会的一部分，但是，这是一个相当定制的设置，所以我们有两个自定义对象挂在存储数据的机会表上。除了图像附件，我已经检索了所有常规数据。

基本上，Opportunities 有一个自定义对象 SFDC_520_Quote__c，客户称之为“房间”，然后每个房间都有一个选择的 SFDC_520_QuoteLine__c 附加到它的对象，这些对象具有产品等的链接，我可以这样做。

但是，附加在这个“房间”级别的图像被赋予了 SFDC_520_Quote__c.id 字段的 ParentID，这使得我很难将 SOQL 语句放在一起来读取数据，因为 SFDC_520_Quote__c 和附件之间没有定义的关系。

我意识到我可以添加一个字段，但我不知道在我从其他人离开时如何在可用的时间内更新现有数据。

理想情况下，我在visualforce页面中需要做的是在重复循环期间将参数传递给控制器​​类，然后调用另一个可以对其进行操作的getter，但我无法在控制器端设置变量。

示例（严重截断）：

```
<apex:page renderAs="pdf" standardController="Opportunity" extensions="myController">
  <apex:repeat value="{!allRooms}" var="room">
    <h1>{!room.Name}</h1>
    <apex:repeat value="{!room.QuoteLines__r}" var="ql">
      <p>{!ql.Product2__r.Name}: {!ql.Product2__r.Description} - {!ql.Description__c}</p>
    </apex:repeat>
  </apex:repeat>
</apex:page> 
```

我的控制器：

```
public class myController {
  public List<SFDC_520_Quote__c> getAllRooms() {
    List<SFDC_520_Quote__c> roomWithQuoteList = [select id, Name, Quote_Amount__c, Quote__c, 
        (select Item_Order__c, Product2__r.ProductCode, Product2__r.Name, Product2__r.Description, Description__c from QuoteLines__r order by Item_Order__c) 
        from SFDC_520_Quote__c where Opportunity__c =: ApexPages.currentPage().getParameters().get('id')];

    return roomWithQuoteList;    
  }

} 
```

以上工作正常，但在第一个内部之后我需要获取附件。附件基于 room.id，所以理想情况下，我需要将 room.id 传递给像“getAttachments”这样的吸气剂，除非你不能将参数从 visualforce 传递给吸气剂。

所以，它可能看起来像：

```
<apex:page renderAs="pdf" standardController="Opportunity" extensions="myController">
  <apex:repeat value="{!allRooms}" var="room">
    --> something to call a setter with value from {!room.id} <--
    <h1>{!room.Name}</h1>
    <apex:repeat value="{!room.QuoteLines__r}" var="ql">
      <p>{!ql.Product2__r.Name}: {!ql.Product2__r.Description} - {!ql.Description__c}</p>
    </apex:repeat>
    <apex:repeat value="{!allAttachments}" var="attachment">
      <apex:image height="200px" value="{!URLFOR($Action.Attachment.Download, attachment.Id)}"/>
    </apex:repeat>
  </apex:repeat>
</apex:page> 
```

然后添加到控制器：

```
private String oppParentID;

public void setParentID(string theID) {
  oppParentID = theID;
}

public List<Attachment> getAllAttachments() {
  List<Attachment> theAttachments = [select Id, Name, ContentType, .... from Attachment where parentiD =: oppParentID];
  return theAttachments;
} 
```

那，或者修改我原来的 getAllRooms() 方法以一次性完成上述操作的方法，没有关系字段，我无法弄清楚如何使用正确编译的 WHERE 进行子选择。

我见过大量的例子，它们都在谈论使用查询字符串参数，但是没有涉及到表单，没有刷新，只是调用了一个 VF 页面。

请帮忙。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T03:34:48.400

詹姆斯B，

看起来您已经在方法中使用的 SOQL 查询中找到了解决方案`getAllRooms`！

这是你写的：

```
List<SFDC_520_Quote__c> roomWithQuoteList = [select id, Name, Quote_Amount__c, Quote__c, 
        (select Item_Order__c, Product2__r.ProductCode, Product2__r.Name, Product2__r.Description, Description__c from QuoteLines__r order by Item_Order__c) 
        from SFDC_520_Quote__c where Opportunity__c =: ApexPages.currentPage().getParameters().get('id')]; 
```

在我看来，您所要做的就是在 SOQL 查询中添加一个额外的元素：

```
List<SFDC_520_Quote__c> roomWithQuoteList = [select id, Name, Quote_Amount__c, Quote__c, 
        (select Item_Order__c, Product2__r.ProductCode, Product2__r.Name, Product2__r.Description, Description__c from QuoteLines__r order by Item_Order__c),
        (select Id, Name, ContentType from Attachments)
        from SFDC_520_Quote__c where Opportunity__c =: ApexPages.currentPage().getParameters().get('id')]; 
```

这应该允许您的嵌套重复与第二次重复的细微调整一起工作：

```
<apex:page renderAs="pdf" standardController="Opportunity" extensions="myController">
  <apex:repeat value="{!allRooms}" var="room">
    <h1>{!room.Name}</h1>
    <apex:repeat value="{!room.QuoteLines__r}" var="ql">
      <p>{!ql.Product2__r.Name}: {!ql.Product2__r.Description} - {!ql.Description__c}</p>
    </apex:repeat>
    <apex:repeat value="{!room.Attachments}" var="attachment">
      <apex:image height="200px" value="{!URLFOR($Action.Attachment.Download, attachment.Id)}"/>
    </apex:repeat>
  </apex:repeat>
</apex:page> 
```

# android - TextView 的 onDraw 是否支持图形绘制？

> ID：10014897
> 
> 赞同：1
> 
> 时间：2012-04-04T16:00:09.033
> 
> 标签：android

我试图继承一个 textView 并向它添加一个位图。这没用。使用相同的子类，我通过画一条线进行实验。它仍然不起作用。我试着画文字。有用。

当我将基类从 textView 更改为 View 时。一切正常。

我想知道 textView 是否不支持除文本之外的任何其他内容的绘制？有人可以展示一个关于如何在具有 textView 基类的视图的 onDraw() 中使用 drawLine() 绘制线条的工作代码示例吗？

```
package com.main.test;

import android.content.Context;
import android.graphics.Canvas;
import android.graphics.Color;
import android.graphics.Paint;
import android.util.AttributeSet;
import android.view.View;
import android.widget.TextView;

public class Display extends TextView{

    Paint p;

    public Display (Context context) {
       super(context);
       init();
    }

    public Display (Context context, AttributeSet attrs) {
       super(context, attrs);
       init();
    }

    private void init()
    {
       p = new Paint();
       p.setColor(Color.WHITE);
    }

    @Override
    protected void onDraw(Canvas canvas) {
   // TODO Auto-generated method stub
       super.onDraw(canvas);
       canvas.drawLine(0, 0, this.getMeasuredWidth(), this.getMeasuredHeight(), p);
    }
} 
```

主要活动的代码包com.main.test；

```
import android.app.Activity;
import android.os.Bundle;
import android.widget.TextView;

public class main extends Activity {
    Display input;

    /** Called when the activity is first created. */
    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);
        initcomponents();
    }

    private void initcomponents()
    {
        input = (Display)findViewById(R.id.rateInput);
    }
} 
```

如果我将它从 TextView 更改为 View。有用。

```
package com.main.test;

import android.content.Context;
import android.graphics.Canvas;
import android.graphics.Color;
import android.graphics.Paint;
import android.util.AttributeSet;
import android.view.View;
import android.widget.TextView;

public class Display extends View{

    Paint p;

    public Display (Context context) {
       super(context);
       init();
    }

    public Display (Context context, AttributeSet attrs) {
       super(context, attrs);
       init();
    }

    private void init()
    {
       p = new Paint();
       p.setColor(Color.WHITE);
    }

    @Override
    protected void onDraw(Canvas canvas) {
   // TODO Auto-generated method stub
       super.onDraw(canvas);
       canvas.drawLine(0, 0, this.getMeasuredWidth(), this.getMeasuredHeight(), p);
    }
} 
```

主要活动的代码包com.main.test；

```
import android.app.Activity;
import android.os.Bundle;
import android.view.View;
import android.view.Window;

public class main extends Activity {
    View input;

    /** Called when the activity is first created. */
    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);
        initcomponents();
    }

    private void initcomponents()
    {
        input = (View)findViewById(R.id.rateInput);
    }
} 
```

好的，这个系统暂时不允许我发布照片。所以我不能向你展示第二个代码的结果。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T17:05:28.100

好的，我找到了绘图线不起作用的原因。

当我在清单 XML 中删除这一行时。可以画线。

android:inputType="numberDecimal"

但为什么...？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-05T16:39:45.927

[记事本示例](http://developer.android.com/resources/samples/NotePad/index.html)在作为 TextView 的子类的 EditText 上绘制线条，因此它必须是可能的。我不确定为什么您的代码不起作用，但请参阅`LinedTextEdit`此[文件](http://developer.android.com/resources/samples/NotePad/src/com/example/android/notepad/NoteEditor.html)。

# f# - F#功能接口

> ID：10014901
> 
> 赞同：0
> 
> 时间：2012-04-04T16:00:26.403
> 
> 标签：f#

给定功能：

```
let doTrue = fun(x) -> true
let doFalse = fun(x) -> false 
```

我想重用函数签名以便我可以得到

```
let myFunDefinition = ??? // <-- this is the function signature that i am trying to reuse
let doTrue = myFunDefinition -> true // <-- now i don't have to type fun(x) any more
let doFalse = myFunDefinition -> false 
```

是否可以定义重用函数签名？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-04T16:20:25.037

我不确定我是否正确理解了您的问题，因为测试与您的示例`x = 1`不同，而在您的第二个块中似乎相同。`x = 3``myFunDefinition`

假设您只想在某个谓词为真或为假时做一些不同的事情（例如`x = 1`），我将编写以下 OCaml 代码（您可能需要稍微调整语法）。

```
let doIfPredicate p a deflt = if p then a else deflt
let predicate x = (x = 1)
let doTrue x = doIfPredicate (predicate x) true false
let doFalse x = doIfPredicate (not (predicate x)) false true
let doTrue2 x = doIfPredicate (predicate x) (print_string "true") () 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-04T18:03:37.723

即使在编辑之后，您的问题对我来说也没有任何意义。首先， and 的签名*与*`doTrue`您编写`doFalse`的`'a -> bool`一样，但我认为这与您的问题并不真正相关，因为我不明白“重用”签名意味着什么。相反，您似乎想要某种形式的文本宏，它允许您键入`myFunDefinition`并将其替换为 text `fun (x)`。除了您的替换文本比原始文本长之外，这里有一些想法：

*   F# 没有文本替换宏，因此，如果这正是您想要的功能，那么您就不走运了。
*   如果你想节省打字，你至少可以使用更简洁的公式`let doTrue x = ...`，而不是`let doTrue = fun x -> ...`
*   如果你真的想要`doTrue`and`doFalse`成为 and 的一些其他函数的应用，*那么*这很容易：`true``false`

    ```
    let myFunDefinition b = {{some function of b}}
    let doTrue = myFunDefinition true
    let doFalse = myFunDefinition false 
    ```

    在这种情况下，也许这就是您要寻找的：

    ```
    let myFunDefinition b _ = b
    ... 
    ```

    (?) 这只是忽略了第二个参数（它成为 and 的第一个参数，`doTrue`因为`doFalse`它们分别部分适用于or`myFunDefinition`的第一个参数）。`true``false`

*   如果您想要某种其他类型的抽象，那么其他答案会对这可能意味着什么做出一些合理的猜测。一般来说，如果您花更多时间阐明您的问题，以便清楚地传达您正在尝试做的事情，您将获得更多有用的答案。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-04T16:52:50.403

```
let myFunDefinition funcP ret =
  fun (x) -> if funcP x then ret else not ret
let doTrue = myFunDefinition ((=) 1) true
let doFalse = myFunDefinition ((=) 3) false 
```

# licensing - 使用 MAC 地址作为机器 ID：如果用户安装 vmware，这会改变吗？

> ID：10014909
> 
> 赞同：1
> 
> 时间：2012-04-04T16:01:01.650
> 
> 标签：licensing, vmware

我想使用网络 MAC 地址作为唯一的机器 ID 用于许可目的。我认为这有一些缺点，尽管这是标准的做法（如果客户交换网卡，我可以处理客户必须要求额外的解锁代码）。

但是，如果客户在他们的机器上安装了 vmware，这不会添加虚拟网络接口吗？有没有办法区分这些和真实的？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-04T16:04:40.630

是的，但虚拟 MAC 地址在特定范围内。另外，如果他们把它放在一个 vmware 盒子里，然后移动它，通常默认情况下这也想改变他们的 mac 地址。他们需要意识到这一点。

我在这台机器上没有要查找的 vmware，但它以特定代码开头。就像虚拟机也有特定的代码一样

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-04T16:06:17.463

我认为如果您告诉您的程序始终访问第一张网卡，那么他是否添加更多（无论是真实的还是虚拟的）都没有关系，除非他将其设置为他的第一张网卡。

将软件锁定到硬件对用户来说确实很不方便，并且可能导致他们停止使用您的软件。

您是否考虑过使用网络服务授权您的软件？

如：

客户端 --> Web 服务 --> 数据库

Web 服务检查用户是否输入了正确的用户名/密码，并返回真/假。

无论如何，如果您真的想将其锁定到硬件，我建议您实际上混合使用硬件 ID，如主板/cpu/硬盘驱动器。

您可以在这里找到更多信息：

[http://www.codeproject.com/Articles/17973/How-To-Get-Hardware-Information-CPU-ID-MainBoard-I](http://www.codeproject.com/Articles/17973/How-To-Get-Hardware-Information-CPU-ID-MainBoard-I)

# php - 一个元素在表中重复多少次

> ID：10014911
> 
> 赞同：0
> 
> 时间：2012-04-04T16:01:04.610
> 
> 标签：php, algorithm

我有一个包含许多记录的表。我正在寻找一种有效的方法来计算元素重复的次数。

示例表：

```
id     name
1      ana
2      john
3      tom
4      ana 
5      john 
```

到目前为止，我已经完成了，但效率低下。

```
$number  = 0;
for ($i =1 ; $i <= mysql_num_rows($query) ; $i++)
       for ($j = 1 ; $j <=mysql_num_rows($query); $j++)
           if ( $table[$i] == $table[$j])
                  $number++;
if ($number > 2 ) 
    echo $number; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-04T16:03:12.300

您可以直接在 SQL 中执行此操作

```
SELECT `name`, COUNT(*) AS `count`
FROM `table`
GROUP BY `name` 
```

这会更有效率，因为您不必将每一行都传输到 PHP。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-04T16:03:15.597

```
select count(1), name from table group by name;

count(1) name
2        ana
2        john
1        tom 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-04T16:04:22.003

你可以做到查询端

```
select count(id), name from table group by name 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-04T16:07:29.693

在这里，您可以获得最低的 id、名称以及它存在的次数：

```
select min(id),name,count(*) as cnt from table group by name 
```

在一个 php 数组中：

```
$newarray= array_count_values ( $table ); 
```

见[http://php.net/manual/en/function.array-count-values.php](http://php.net/manual/en/function.array-count-values.php)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-07T10:51:09.000

```
function check_number_of_times_elements_occur_in_array($a)//returns values of array as keys,associating values being their total occurences in the array
{
$r=array();
foreach($a as $v)
    ++$r[$v];
return $r;
} 
```

根据您的需要访问返回的数组。

# java - 如何在 NetBeans 中将 jButton 网格用作二维数组

> ID：10014918
> 
> 赞同：-1
> 
> 时间：2012-04-04T16:01:21.887
> 
> 标签：java, netbeans, jbutton

我制作了一个 8*8 jButton 的网格。我想在二维数组中使用这些按钮。我将如何进行？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-04T16:02:53.580

您可以像处理任何其他数组一样进行操作：

```
JButton[][] buttonGrid = new JButton[cols][rows]; 
```

# triggers - Apex - SalesForce - 为触发器编写测试用例

> ID：10014919
> 
> 赞同：0
> 
> 时间：2012-04-04T16:01:25.513
> 
> 标签：triggers, salesforce, apex-code, testcase

**大家好，我是 Apex 开发的新手，目前正在尝试为此触发器编写测试用例。任何形式的帮助都非常感谢！**

```
trigger Milestone1_Expense_Trigger on Milestone1_Expense__c (before insert, before update) 
{
    if(Trigger.isBefore)
    {
        Milestone1_Expense_Trigger_Utility.handleExpenseBeforeTrigger(Trigger.new);
    }
} 
```

**提前致谢！**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-04T16:15:57.130

查看[Apex 代码测试方法](http://wiki.developerforce.com/page/An_Introduction_to_Apex_Code_Test_Methods)介绍，并查找具有`http://wiki.developerforce.com/page/An_Introduction_to_Apex_Code_Test_Methods`. 该代码部分是测试 Apex 触发器的示例。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-10T05:36:16.057

看看提供的链接 matthew。这应该让您了解需要做什么以及如何断言和确认您正在尝试做的事情是否真的发生了。如果我用一种简单的方式来解释它。

当在 Milestone1_Expense__c 中插入/更新记录时，您的触发器将被触发。因此，在您的测试类中，您只需为 Milestone1_Expense__c 创建一个测试数据并给出一个插入语句。

如果我要举一个 Account 的例子

```
 Account a = new Account(Name = 'test', Company__c = 'test');
    insert a; 
```

而不是 Account 在这里，您可以使用您的自定义对象并使用该自定义对象中的字段

# asp.net - Response.Write and UpdatePanel

> ID：10014920
> 
> 赞同：14
> 
> 时间：2012-04-04T16:01:26.417
> 
> 标签：asp.net, updatepanel, httpresponse, response.write

I generate a vcard that I send to the client using the following code snippet:

```
Response.AddHeader("Content-Disposition", string.Format("attachment; filename={0}", fileNameOnly));
Response.ContentType = "text/x-vcard";
Response.ContentEncoding = Encoding.GetEncoding("ISO-8859-1");
Response.Write(vCard.ToString());
Response.End(); 
```

However, I need to use vCards on a page that has the control inside and UpdatePanel. Unfortunately, according to [Update panel and Response write](http://weblogs.asp.net/leftslipper/archive/2007/02/26/sys-webforms-pagerequestmanagerparsererrorexception-what-it-is-and-how-to-avoid-it.aspx) this does not work and causes an error. I am wondering what are some alternative ways to send the contents of the vcard/file to the client's browser and have it display "open/save" dialog that don't involve Response.Write?

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2012-04-04T16:15:02.933

You can't use `Response.Write` during an asynchronous postback. Whatever control executes that code needs to be added as a `PostBackTrigger` in the update panel:

```
<Triggers>        
    <asp:PostBackTrigger ControlID="Button1" />
</Triggers> 
```

You can also do it in code-behind, if you prefer:

```
ScriptManager.GetCurrent().RegisterPostBackControl(Button1); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-04T18:49:29.620

**[Response.Write will not work under Asynchronous Events](http://www.codeproject.com/Articles/24178/The-magical-effects-of-the-UpdatePanel-control-in)**. My suggestion is to remove the Update Panel in case it is specifically being used for VCard point of view only.

Alternatively - Place a control inside the Update Panel and initialize it's value under asynchronous event. Now it will work.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-26T10:09:01.443

Why don't you consider the use of a separate handler/page to serve the vcard?

This is maybe the easiest and cleaner way to do that and it doesnt interfere any other (async or not) postback related to the updatepanel.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-07T22:11:26.287

I had a similar problem with `Response.Write`. I found a workaround or maybe even a solution to this problem. Capture the `TextWriter` given to the `RenderBeginTag` of a server control and write to that.

I blogged with an example here: [http://timscyclingblog.wordpress.com/2013/03/07/asp-net-web-forms-response-write-in-an-updatepanel-dev-web/](http://timscyclingblog.wordpress.com/2013/03/07/asp-net-web-forms-response-write-in-an-updatepanel-dev-web/)

# authentication - CakePHP 2.0 Auth 登录不起作用

> ID：10014928
> 
> 赞同：0
> 
> 时间：2012-04-04T16:01:48.640
> 
> 标签：authentication, cakephp-2.0

我已经和这个斗争了一段时间。我有一个需要身份验证的 CakePHP 2.0 应用程序，由于它必须使用另一种语言，我放弃了具有“用户名”和“密码”约定的自动“用户”，并制作了自己的数据库表：

```
utilizatori('id', 'nume', 'parola') 
```

在我的**AppController**中，我定义了以下内容，如果我理解正确，应该覆盖默认的 CakePHP 关联并使其使用我的新结构：

```
class AppController extends Controller {
    var $components = array('Session',
    'Auth' => array('Form' => array(
        'userModel' => 'Utilizator',
        'fields' => array('username' => 'nume', 'password' => 'parola'),
        'loginAction' => array('controller' => 'utilizatori', 'action' => 'login'),
        'loginRedirect' => array('controller' => 'categorii', 'action' => 'admin_index'))));

    function beforeFilter() { }
} 
```

在我的**UtilizatoriController**我有以下登录功能：

```
function login() 
{
    $this->layout = 'admin'; 
    debug($this->data);
    debug(Security::hash($this->data['Utilizator']['parola']));
    debug($this->Auth->login());
    /*more here but don't think it's important*/ 
```

**数据调试**得出预期值，让我们假设：

```
**data['Utilizator']['nume']** = 'Cosmin'
**data['Utilizator']['parola']** = 'Cosmin' 
```

**密码哈希调试**产生了我也手动插入数据库的预期哈希，但登录函数返回**false**。

我不确定下一步该做什么，任何反馈将不胜感激。另外，有没有办法访问发送到**$this->Auth->login()**的内容？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-04T19:36:02.063

事实证明， $this->Auth->login() 失败的原因是我在**AppController中声明了****AuthComponent**。经过一些更多的研究和一篇[关于如何在 CakePHP 2.0.4 中为 Auth 组件使用不同模型的文章出奇地小但很有帮助？](https://stackoverflow.com/questions/8996162/how-can-i-use-different-model-for-auth-component-in-cakephp-2-0-4)我查看了我的代码，现在它似乎正在工作。

 **我将在此处发布评论，以防有人遇到此问题。

```
public $components = array(
    'Session',
    'Auth' => array(
        'authenticate' => array(
            'Form' => array(
                'userModel' => 'Utilizator',
                'fields' => array(
                    'username' => 'nume',
                    'password' => 'parola'
                )
            )
        ),
        'loginAction' => array('controller' => 'utilizatori', 'action' => 'login'), //Not related to the problem
        'loginRedirect' => array('controller' => 'utilizatori', 'action' => 'index'), //Not related to the problem
        'logoutRedirect' => array('controller' => 'utilizatori', 'action' => 'index') //Not related to the problem
    )
); 
```**

# maven - Maven - 关闭特定 pom 的警告

> ID：10014929
> 
> 赞同：0
> 
> 时间：2012-04-04T16:01:48.653
> 
> 标签：maven, maven-2

我有一个有时无法解决的依赖项（不要解决它......没关系）

```
<dependency>
<groupId>com.g.g</groupId>
<artifactId>art123</artifactId> 
<version>1</version>
<type>rar</type>  
<scope>system</scope
    <systemPath>some location</systemPath>
</dependency> 
```

当我清理安装整个项目时，我会收到有关此依赖项的警告（当它无法解决时）。有什么办法可以关闭这个警告吗？我试图添加

```
<optional>true</oprional> 
```

到依赖项，但仍然收到警告。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-04T21:20:45.180

我认为您误解了[可选依赖项](http://maven.apache.org/guides/introduction/introduction-to-optional-and-excludes-dependencies.html#How_do_optional_dependencies_work)的工作原理。

为了解决您的问题，我建议您创建两个具有不同依赖项的[配置文件](http://maven.apache.org/guides/introduction/introduction-to-profiles.html)（另请参阅[https://stackoverflow.com/a/167284/303598](https://stackoverflow.com/a/167284/303598)）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-05T07:31:32.067

您永远不应该使用系统范围的依赖项。将此依赖项放入存储库管理器并将您的依赖项更改为通常的依赖项。我建议真正使用存储库管理器（字母顺序：[archiva](http://archiva.apache.org/)，[artifactory](http://www.jfrog.com/products.php)，[nexus](http://www.sonatype.org/nexus/)）。

# asp.net - Unity.Mvc - UnityDependencyResolver 问题

> ID：10014936
> 
> 赞同：2
> 
> 时间：2012-04-04T16:02:02.550
> 
> 标签：asp.net, asp.net-mvc, asp.net-mvc-3, asp.net-mvc-4

当前项目是一个 Mvc4 应用程序，我让 Ioc 工作，最近它刚刚停止。

```
DependencyResolver.SetResolver(New UnityDependencyResolver(RegisterIocServices())) 
```

那条线正在工作，现在我收到以下错误：

> 用户代码未处理 ArgumentException
> 
> Unity.Mvc3.UnityDependencyResolver 类型似乎没有实现 Microsoft.Practices.ServiceLocation.IServiceLocator。参数名称：commonServiceLocator

有人遇到这种情况吗？有什么想法或建议吗？

提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-21T19:58:35.210

使用 MVC 4.0

我遇到的问题是 IDependencyResolver 有两个版本

```
 //using System.Web.Http.Dependencies;  //wrong version for me

 using System.Web.Mvc; //correct version for me. 
```

使用 System.Web.Mvc 是我的 Web API 项目所需的版本。

我正在使用统一，但下面的博客文章帮助我直截了当地解决了这个问题。

[http://www.strathweb.com/2012/05/using-ninject-with-the-latest-asp-net-web-api-source/](http://www.strathweb.com/2012/05/using-ninject-with-the-latest-asp-net-web-api-source/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-25T14:59:56.963

卸载/重新安装 Unity MVC 包并没有解决问题。我最终不得不在项目中对 Microsoft.EnterpriseLibrary.Common 库进行硬引用，这似乎在一两个星期内清理干净。然后我开始看到错误间歇性地再次出现，做一个完整的解决方案清理并偶尔构建解决它。它会起作用，然后突然恢复到错误消息。

所以今天早上我终于放弃了 Unity.Mvc，转而实现了 Autofac。一旦我为 Autofac 设置了我的引导程序文件，它就在第一次编译时工作，并且整个早上都保持稳定。

这是 Autofac 的 boostrapper 文件，以防有人需要样本。注意：我使用 WebActivator 让我的所有引导类在启动前运行，而不是在 Global.asax.vb 文件中放置一堆代码。

```
#Region "Imports"

Imports System.Reflection
Imports Autofac
Imports Autofac.Integration.Mvc
Imports MyCompany.Data.Repositories
Imports MyCompany.Services
Imports MyCompany.Web.Mvc.Public.Bootstrap
Imports MyCompany.Web.Mvc.Public.Services

#End Region

#Region "Assembly Meta"

' This tells the app to run the "Start" method prior to running the App_Start method in Global.asax
<Assembly: WebActivator.PreApplicationStartMethod(GetType(AutofacDI), "Initialize")> 

#End Region

Namespace MyCompany.Web.Mvc.Public.Bootstrap

    ''' <summary>
    ''' Class to setup dependency injection and register types/services.
    ''' </summary>
    ''' <remarks></remarks>
    Public NotInheritable Class AutofacDI

        ''' <summary>
        ''' Method to register the Unity dependency injection component.
        ''' </summary>
        ''' <remarks>
        ''' This line of code below could alternatively be placed in Global.asax App_Start(), doing
        ''' so in this manner ensures that this gets run "PreStart".
        ''' </remarks>
        Public Shared Sub Initialize()

            ' Create Unity dependency container.
            Dim dependencyContainer = BuildIocContainer()

            ' Set DI resolver
            DependencyResolver.SetResolver(New AutofacDependencyResolver(dependencyContainer))

        End Sub

        ''' <summary>
        ''' Registers the IOC types/services.
        ''' </summary>
        ''' <returns></returns>
        ''' <remarks></remarks>
        Private Shared Function BuildIocContainer() As Autofac.IContainer

            Dim builder = New ContainerBuilder

            With builder
                ' Register Controllers
                .RegisterControllers(Assembly.GetExecutingAssembly())

                ' Custom MyCompany/Mvc objects
                .RegisterType(Of FormsAuthenticationService)().As(Of IFormsAuthenticationService)().InstancePerHttpRequest()
                .RegisterType(Of AccountMembershipService)().As(Of IMembershipService)().InstancePerHttpRequest()

                '***************************************************************
                '*  MyCompany service objects.
                '***************************************************************
                ' This is auto registration, it replaces all the individual registration lines of code below.
                builder.RegisterAssemblyTypes(GetType(CatalogCodeService).Assembly).
                    Where(Function(t) t.Name.EndsWith("Service")).AsImplementedInterfaces().InstancePerHttpRequest()

                '***************************************************************
                '*  MyCompany repository objects (used by service objects above)
                '***************************************************************
                ' This is auto registration, it replaces all the individual registration lines of code below.
                builder.RegisterAssemblyTypes(GetType(CatalogCodeRepository).Assembly).
                    Where(Function(t) t.Name.EndsWith("Repository")).AsImplementedInterfaces().InstancePerHttpRequest()
            End With

            Return builder.Build()

        End Function

    End Class

End Namespace 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-21T03:39:06.503

虽然不是这个特定问题的答案，但我也收到了上述错误消息，这个问题是谷歌搜索该消息时的第一个问题。`System.Web.Mvc.DependencyResolver`我遇到了这个问题，因为如果只是实现接口，我会愚蠢地继承，例如：

```
// wrong
public class MyDependencyResolver : System.Web.Mvc.DependencyResolver
{ ... }

// correct
public class MyDependencyResolver : System.Web.Mvc.IDependencyResolver
{ ... } 
```

我花了一段时间才解决这个问题，所以我希望这可以为其他人省去麻烦。

# c++ - 失踪 ';' 在'<'之前

> ID：10014939
> 
> 赞同：-1
> 
> 时间：2012-04-04T16:02:10.443
> 
> 标签：c++, templates

我正在做一些练习，并试图将一个简单的类转换为模板类。更改代码后，我遇到了一堆链接器错误，因此我从实现中删除了头文件包含语句，现在将实现文件包含在头文件的底部。从那以后我得到这个奇怪的语法错误：缺少';' 在'<'之前。我看不出我做错了什么。

这是我的头文件：

```
#ifndef STACK_H
#define STACK_H

#include <iostream>

template<class T>
class Stack
{
    T* buffer;
size_t count;
public:
Stack();
~Stack();
void push(T value);
void pop();
T top() const;
size_t size() const;
};

#include "Stack.cpp"

#endif 
```

这是实现文件：

```
template<class T>
Stack<T>::Stack() : count(0)
{
buffer = new T;
}

template<class T>
Stack<T>::~Stack()
{
delete[] buffer;
}

template<class T>
void Stack<T>::push( T value )
{
if(size() == 0) *(buffer) = value;
else
{
    T* newBuffer = new T[count+1];

    for(size_t i=0; i <= size(); ++i)
        newBuffer[i] = buffer[i];

    newBuffer[count] = value;
    buffer = newBuffer;
}
++count;
}

template<class T>
void Stack<T>::pop()
{
if(size() <= 0) return;

 buffer[size()-1]=0;
 --count;
}
template<class T> 
typename T Stack<T>::top() const
{
if(size() <= 0) 
{
std::cout << "the stack is empty" << std::endl;
return -1;
}
else
{
    return buffer[size()-1];
}
}

template<class T>
size_t Stack<T>::size() const
{
return count;
} 
```

任何帮助，将不胜感激 ！！！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-04T16:11:29.973

我的猜测是您正在尝试编译该`.cpp`文件。尽管文件扩展名令人困惑，但它不是一个完整的翻译单元，因此无法自行编译。只需包含使用该类的任何文件的标头即可。

就个人而言，我会将实现移到头文件中；其他人可能会给它一个不同的文件扩展名，看起来不像是可编译的源文件（我已经看到`.tcc`并`.inl`用于此类文件，但没有通用约定）。

还：

```
template<class T> 
typename T Stack<T>::top() const
^^^^^^^^^ 
```

删除那个`typename`；您只需将其放在依赖于模板参数的类型名称之前。

# entity-framework-4 - DbContext - 忽略 DbUpdateException 并继续

> ID：10014948
> 
> 赞同：1
> 
> 时间：2012-04-04T16:02:38.887
> 
> 标签：entity-framework-4, ravendb, dbcontext

我需要编写一个将数据从 RavnDB 迁移到 SQL 的应用程序。我正在将数据从 ravenDB 中提取出来，同时它仍在接收大量写入。这意味着我通常会提取过时的数据。在 SQL 端，我有一个主键，它实际上是乌鸦生成的 GUID ID。由于我正在提取陈旧的数据 - 有时相同的实体会返回。这很好，但是因为我在尝试保存更改时正在使用 EF，所以我得到了一些 DbUpdateException。所以我想知道是否有办法告诉 DbContext 忽略 DbUpdateException 并继续插入？

非常欢迎任何想法或意见，谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-08T11:46:02.867

首先我必须说你的解决方案有问题（忽略错误通常是不好的做法） - 也许你应该考虑重新设计你的解决方案。
无论如何，如果您确实需要使用实体框架，则可以选择为您[在本文中](http://msdn.microsoft.com/en-us/data/gg699321)阅读的 CRUD 操作设置自定义存储过程， 您可以为插入创建 SP：

```
 INSERT INTO tragetTable
 SELECT @id,@val1,@Val2
 WHERE @Id NOT IN(select id from tragetTable) 
```

这可能会
成功

# php - PHP 从字面上看，在 If 语句中取一个变量

> ID：10014951
> 
> 赞同：0
> 
> 时间：2012-04-04T16:02:50.060
> 
> 标签：php

我想知道是否可以这样做：

```
$var = '$something == $somethingelse';

if ($var) { // Say hello } 
```

并让它的意思与此相同：

```
if ($something == $somethingelse) { // Say hello } 
```

我知道这目前不起作用，因为`if ($var)`检查是否`$var`已设置。但我要问的是：有没有允许这样做的方法？将不胜感激。

编辑：基本上我觉得我应该解释我为什么要这样做。我希望用户能够根据他们的“频道”之一保存的一些数据来控制他们何时收到通知。

例如，用户只想在他们收集的数据大于 60 时收到通知。所以我会让他们选择两个字段：

他们的数字的第一个字段输入（int或float）

第二个字段选择（等于、<、>、=<、=>）

这个 if 语句中的最后一件事是他们的“通道”收集的数据。

然后，我希望能够以某种方式将他们的选择保存在数据库中，然后根据他们的选择采取行动。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-04T16:05:48.773

[eval()](http://php.net/manual/en/function.eval.php)语言结构非常危险，因为它允许执行任意 PHP 代码。因此不鼓励使用它。如果您已仔细验证除了使用此构造之外别无选择，请特别注意不要将任何用户提供的数据传入其中，而无需事先正确验证。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-04T17:01:24.987

如果您提出这个问题，那么您的设计就有问题。

将代码与数据混合（您实际上在做什么）是程序员可以做的最糟糕的事情之一。这将使您的代码无法维护和不安全。

您必须重新设计您的应用程序以使您的代码可靠而不可变。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-04T16:08:21.350

为什么不直接使用`if ($something == $somethingelse) { // Say hello }`？这不是更多的代码。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-04-04T16:26:04.533

你说这个字符串是你在别处生成的。我建议，而不是生成一个字符串，生成一个数组。

像这样：`array('something','==','somethingelse')`。

现在，当您要处理此问题时，可以将变量替换为它们的值，然后检查运算符并运行正确的操作。

像这样的东西：

```
$x = array('something','==','somethingelse');
list($valA, $operation, $valB) = $x;

// Replace values
$valA = $$valA;
$valB = $$valB;

// Run operation
$result = false;
switch($operation){
    case '==':
        $result = $valA == $valB;
        break;
    default:
        break;
}
if($result) echo ":-)"; 
```

演示：[http ://codepad.org/vaELABEm](http://codepad.org/vaELABEm)

你甚至可以用它来做其他事情，通过`case`在`switch`.

# jquery - 如何在 iframe 中选择 div id onClick 事件？

> ID：10014953
> 
> 赞同：0
> 
> 时间：2012-04-04T16:02:52.527
> 
> 标签：jquery, iframe

这是我的代码。我正在尝试在 iframe 中加载网站。加载网站后，我想在 iframe 中单击以选择 div id（我单击的位置）

```
 <iframe name="frameID" id="frameID" src="http://www.test.com" style="width:100%;height:400px;"></iframe>

$(document).ready(function(){
$('#frameID').load(function(){

    $('#frameID').contents().bind("click", function () {
        var a = $(this).id;
        alert (a);
        return false;
    });
}); 
```

});

例如，如果我单击 iframe 中加载的网站的页脚，我想显示 div id“页脚”。

但是，我无法这样做，它一直让我不确定。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-04T16:04:20.600

你可以试试

```
$('#frameID').contents().find('body').on("click", "div",  function () {
    var a = this.id;
    alert (a);
    return false;
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-04T16:07:25.050

您无法在 iframe 中访问跨域的文档对象。即使它适用于您的本地，它也不会适用于网站。

# java - 如何在 Primefaces 数据表过滤器上保持会话

> ID：10014957
> 
> 赞同：2
> 
> 时间：2012-04-04T16:02:58.243
> 
> 标签：java, filter, datatable, primefaces, refresh

我有一个使用 Primefaces 数据表的页面，基本上 ManagedBean 查询数据库并将数据表中的信息显示为报告，我使用选项 filterBy 进行过滤。

信息会自动更新，通过页面刷新，我的问题是当系统重新加载页面时，系统会丢失在过滤器中输入的信息，然后用户必须再次在过滤器中输入信息。

我需要保留用户输入的信息，然后我认为我需要保留我页面的过滤器的会话，我认为它可以解决我的问题。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-04T18:13:39.133

此时 PrimeFaces 似乎不支持保存数据表的过滤器值（从 PF 3.2 开始）。

相反，建议您为该列实现一个标题方面，并在其中添加一个输入字段，该字段绑定到将执行过滤器的支持 bean 上的方法。这样，您就可以将过滤器字段的值存储在 View Scope 中（使用 View Scope 托管 bean 或 Tomahawk 的 saveState 组件）。请注意，输入字段可以（并且可能应该）使用 ap:ajax 组件设置，以便当用户更改字段上的值时，将调用支持 bean 方法，以便过滤器将执行完全相同的操作您使用 p:column 的 filterBy 属性实现了它。

当我想要一个过滤器时，我已经完成了上述操作，使用弹出日历作为日期并且效果很好。

# php - 如何在php中获取值[]？

> ID：10014958
> 
> 赞同：0
> 
> 时间：2012-04-04T16:03:03.220
> 
> 标签：php, jquery, html, forms

我有这个代码

**HTML**

```
<ul style="list-style:none;" id="listing">
<li>
<table id="pedido" action="post.php">
<form method="POST" >
<tr>
<td>
<select name="product[]">
    <option value="0">Perfil:</option>
    <option value="68mm 5 Cámaras AD rendszer egyenes szárny, ütköző tömítéssel">68mm 5 Cámaras 7001AD, con dos juntas</option>
    <option value="68mm 7 K AD rendszer íves szárny, ütköző tömítéssel">68mm 7 Cámaras 7001AD con dos juntas</option>
    <option value="80 mm 6 K Tok + 7 K íves szárny  AD rendszer, ütköző tömítéssel">80 mm Marco 6 Cámaras  + Hoja de 7 Cámaras 7001AD con dos juntas</option>
    <option value="68mm 7 K  MD rendszer ütköző és középtömítéses, íves szárny">68mm 7 Cámaras 7001MD con tres juntas</option>
    <option value="80 mm 8 K MD rendszer ütköző és középtömítéses, íves szárny">80 mm 8 Cámaras 7001MD con tres juntas</option>
</select>
</td>
</tr>
<tr>
<td>
<input name="h[]" value="Horizontal" class="comment" /> x
<input name="v[]" value="Vertical" class="comment" />
uds:
<input name="uds[]" style="width:60px;"/>
</td>
</tr>
<tr>
<td>
<select>
<option>Color</option>
</select>

Persiana <input type="checkbox" name="persiana[]" id="persiana"/> <div id="persianaver" style="float:right; display:none">Con motor<input type="radio" name="f[]" value="auto" /> Manual<input type="radio" name="f[]" value="manual" /></div>
</td>
<tr></tr>
<tr>
<td style="width:435px;">
<div id="persiaops" style="float:right; display:none">IMPORTANTE: En caso de haber seleccionado la opción persiana usted tiene que especificar el tamaño de la tapa del cajón (Lugar donde se sitúa la caja de persiana) Puede especificarlo en el campo comentario <a id="pregunta" href="images/demo.jpg"><img alt="pregunta" src="images/ask.jpg"  height="15" width="15"/></a> </div>
</td>
</tr>
<tr>
<td>
<textarea name="comment[]" rows="5" cols="59" class="comment">Comentario</textarea>
</td>
</tr>
</form>
</table>
</li>
</ul> 
```

每个元素都称为 name[] 因为我想多次克隆表然后填写信息。但我的问题是：我怎样才能在 php 中获得这些 vales？我的意思是 $_POST['hello'] 如果已提交，我可以获得 hello 字段的内容，但是 $_POST['hello[]'] 呢？它将被存储为一个数组对象.. 但是我如何检查所有带有 name="hello" 的字段是否都正确填写？或者我需要将值存储为一个数组，然后在 post.php 中检查数组包含的所有元素是否正确？有没有简单的方法？

谢谢 ;）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-04T16:08:36.387

*命名为product[]*的字段可以在 PHP 中使用 $_POST["product"][0] 访问（对于第一个）。

您还可以遍历此数组：

```
foreach($_POST["product"] as $key => $product) {
    echo $product;
} 
```

要检查是否所有字段都已填写，您应该添加一个运行时变量，每次克隆输入字段时都会对其进行计数：

```
<select name="product[0]">...
...
<select name="product[1]">...
... 
```

然后您可以再次循环浏览产品：

```
foreach($_POST["product"] as $key => $product) {
    //check whether h is also filled:
    if($_POST["h"][$key] != "") {
        ...
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-04T16:07:40.773

当 PHP 解析请求数据时，它们将被解释为数组。所以：

```
<input name="v[]" value="Vertical" class="comment" />
<input name="v[]" value="Horizontal" class="comment" /> 
```

将在 PHP 中可用，`$_POST['v']`如下所示：

```
Array
(
    [0] => Vertical
    [1] => Horizontal
) 
```

它与 PHP 隐式数组推送的基本语法相同：

```
$v[] = 'Vertical';
$v[] = 'Horizontal'; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-04T16:06:01.757

您可以将它们作为数组获取：

```
echo $_POST['product'][0]; 
```

要查看您的`$_POST`数组结构，只需编写：

```
print_r($_POST); 
```

# android - 包括 android 库不适用于 Eclipse 中的 ant

> ID：10014967
> 
> 赞同：0
> 
> 时间：2012-04-04T16:03:21.537
> 
> 标签：android, eclipse, ant, adt

我有 2 个`Android`图书馆项目。*图书馆 A*和*图书馆 B*。

我有一个名为*project1*的项目，它需要引用*LibraryA*和*LibraryB*中的类和东西。

我正在使用`Ant`内部自动生成的脚本`eclipse`来构建所有项目。注意：我已经从每个项目中删除了所有其他构建器，并且只使用了`Ant`构建器。

当我使用以下目标“清理，调试”运行*project1*的构建脚本时，`eclipse's`控制台说`BUILD SUCCESSFUL`。**但是**，如果我查看 eclipse 中的代码，代码中有很多错误行和 x 表示`imports cannot be resolved`以及许多其他错误。基本上它告诉我对图书馆项目的引用不存在。它也告诉我`R's`也无法解决。

**我以为 ADT17 会解决这个问题，但它仍然存在。难道我做错了什么？我该如何解决这个问题，以便 eclipse 允许引用并且一切正常？**

在手机上运行应用程序正在运行。

* * *

```
# The project.properties file for project1
target=android-10
android.library.reference.1=../LibraryA
android.library.reference.2=../LibraryB 
```

* * *

我有一个肮脏的修复程序可以解决这个问题，但我想要一个更干净的解决方案，它是自动的，不需要编辑 android 生成的自动生成的 build.xml。似乎这种类型的东西应该开箱即用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-04T16:58:04.443

我解决了这个问题。`gen`未包含`src`在项目的文件夹中。一旦我将`gen`其作为源文件夹包含在内，所有`R`引用都开始工作。

**我的`libs`文件夹中没有项目的罐子。**

我之前提到的我的“肮脏解决方案”是添加一个`post-compile`目标并获取`classes.jar`在构建期间生成的目标并将其重命名为`"TheProjectName".jar`，然后项目将看到 jar 文件引用。

“肮脏的解决方案”是我在 ADT17 之前所做的，并希望在 ADT17 中避免，但似乎这个问题仍未解决。如果有人对如何解决该问题有任何建议，请告诉我。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-04T16:06:50.557

您是否尝试将 jar 库放入`libs`文件夹中？在 adt17 中，您的罐子必须放入其中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-20T15:00:44.140

要么通过 Eclipse 创建一个 Android 项目，要么在控制台中输入“android create project”（不要忘记额外的参数，如 -n、-t 和其他参数）。如果您已经使用 Eclipse 创建了 Android 项目，但缺少 build.xml 文件（可能还有其他文件），请运行“android update project -p”。在项目的根文件夹中更新它并添加丢失的文件。如果您通过 Eclipse 或命令行创建 Android 项目，则应正确设置像“gen”（和其他）这样的文件夹。

# wordpress - 以 root 用户身份运行 Wordpress、Drupal 或 Joomla

> ID：10014968
> 
> 赞同：-2
> 
> 时间：2012-04-04T16:03:23.470
> 
> 标签：wordpress, drupal, ubuntu

是否建议在 ubuntu 服务器上以 root 身份运行 wordpress/drupal 或 joomla 生产网站？

以非 root 身份运行它有什么缺点吗？

我不知何故觉得我不应该让我的 ubuntu 的 root 访问 wordpress 站点。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T02:04:18.647

您是否在询问Wordpress 和 Joomla 文件和文件夹的和`owners`？`groups`

见[http://codex.wordpress.org/Changing_File_Permissions](http://codex.wordpress.org/Changing_File_Permissions) 这解释了谁需要拥有 Wordpress 文件，即 FTP 帐户所有者：

> 通常，所有文件都应由您的 Web 服务器上的用户 (ftp) 帐户拥有，并且应可由该帐户写入。在共享主机上，文件永远不应该归网络服务器进程本身所有（有时是 www、apache 或nobody 用户）。

# c# - 使用 RegisterStartupScript、RegisterScriptBlock 等注册的脚本多久执行一次？

> ID：10014970
> 
> 赞同：1
> 
> 时间：2012-04-04T16:03:25.920
> 
> 标签：c#, javascript, asp.net, ajax, updatepanel

假设我有一个按钮可以修改更新面板中的一些内容：

```
protected void Button1_Click(object sender, EventArgs e)
{
    Label1.Text = "New Text";
} 
```

在 UpdatePanel 更新后，我*还想*在客户端执行一些代码。我的第一个想法是执行`ScriptManager.RegisterClientScriptBlock`或`RegisterStartupScript`：

```
protected void Button1_Click(object sender, EventArgs e)
{
    Label1.Text = "New Text";

    var x = getSomeDatabaseQueryResultBasedOn(TextBox1.Text, ...);

    ScriptManager.RegisterStartupScript(this, typeof(WebForm1), "SomeKey",
        "/* this is my script, using `x` */", true)
} 
```

但是，[RegisterStartupScript 的文档](http://msdn.microsoft.com/en-us/library/bb338357.aspx)说：

> 您可以使用此方法注册一个启动脚本块，每次发生异步回发时都会包含该脚本块。

我不希望这段代码执行*“每次发生异步回发”*。我希望它*现在*才执行（在浏览器重新控制之后）。如果单击 Button2，我不希望执行任何脚本，如果再次单击 Button1，`x`可能会有所不同，我希望执行一个*新*脚本。不幸的是，我没有找到`ScriptManager.ExecuteOnce`方法。

有没有这样的方法？还是我只是误解了 的文档`RegisterStartupScript`？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-04T19:09:43.260

当您在异步回发期间包含 StartupScript 时，它只会存在于从服务器发送的*部分*响应中。

如果你做这样的事情：

```
if(ScriptManager.IsInAsyncPostBack)
{
  myDiv.InnerText = "partial response";
  ScriptManager.RegisterStartupScript(Page, Page.GetType(), DateTime.Now.ToString("ssfff"), "alert(0);"), true);
} 
```

您的回复将如下所示：

```
|blabla|blabla|updatePanel_ctrl00|someparams
<div>partial response</div>
<script> alert(0); </script> 
```

因此，一旦收到响应，那段 javascript 就会执行。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-04T16:24:57.360

该文档的下一行说：

> “要为 UpdatePanel 控件内的控件注册脚本块，以便仅在更新 UpdatePanel 控件时注册脚本，请使用此方法的 RegisterClientScriptBlock(Control, Type, String, String, Boolean) 重载。”

这不是你想要的吗？

# storage - 在笔记本电脑中模拟 Iscsi 磁盘（学习 VCP）

> ID：10014973
> 
> 赞同：-2
> 
> 时间：2012-04-04T16:03:32.113
> 
> 标签：storage, vmware, esxi, iscsi

你如何模拟一个iscsi磁盘。我尝试了许多软件，但无法将存储（iscsi 磁盘）添加到我的 VMwork 工作站。即使在创建虚拟磁盘后，它也无法识别该磁盘以将其指定为 iSCSI 磁盘。我有两个网卡，我也模拟了 2 个 esxi 4.0 服务器。只是无法整理存储。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-05T11:23:47.533

你可以试试freenas。 [http://www.freenas.org/](http://www.freenas.org/)

将其安装在 VM 上并将 iSCSI 连接器添加到您的 nas。因此，您将有一个 iSCSI 磁盘用于您的 vcp 研究。

# javascript - 处理可拖动/可拖放的 iPad 触摸事件（未定义的 changedTouches）

> ID：10014974
> 
> 赞同：7
> 
> 时间：2012-04-04T16:03:32.613
> 
> 标签：javascript, jquery, jquery-ui, touch-event

我正在尝试让 jQuery 拖放与 iPad 触摸事件很好地配合使用。我在网上找到了这段代码：

```
function touchHandler(event)
{
    var touches = event.changedTouches,
        first = touches[0],
        type = "";
    switch (event.type)
    {
        case "touchstart": type = "mousedown"; break;
        case "touchmove": type = "mousemove"; break;
        case "touchend": type = "mouseup"; break;
        default: return;
    }

    //initMouseEvent(type, canBubble, cancelable, view, clickCount, 
    //           screenX, screenY, clientX, clientY, ctrlKey, 
    //           altKey, shiftKey, metaKey, button, relatedTarget);

    var simulatedEvent = document.createEvent("MouseEvent");
    simulatedEvent.initMouseEvent(type, true, true, window, 1,
                              first.screenX, first.screenY,
                              first.clientX, first.clientY, false,
                              false, false, false, 0/*left*/, null);

    first.target.dispatchEvent(simulatedEvent);
    event.preventDefault();
} 
```

如果我将 touchHandler 附加到 touchstart/move/end，它似乎工作正常`document`，但是不允许在 iPad 上进行本机缩放/滚动，所以我试图只将此处理程序附加到可拖动对象本身。

我看到的问题是`event.changeTouches`由于某种原因始终未定义，正如您可以在[http://jsfiddle.net/myLj2/1/](http://jsfiddle.net/myLj2/1/)中看到的那样。我想不出为什么触摸事件总是具有未定义`changeTouches`属性的原因，因此，此代码将不起作用。有什么想法吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-04-04T16:23:43.833

[在发现jQuery 是否保留触摸事件属性](https://stackoverflow.com/questions/3183872/does-jquery-preserve-touch-events-properties)后我想通了？.

事实证明，jQuery 事件不会复制该`changeTouches`属性，因此您必须使用 jQuery 的`originalEvent`属性或一起跳过 jQuery 并与类似的函数绑定`addEventListener`

# php - 如何使用带有单个 preg_replace 的 REGEX 从字符串中删除许多不同的括号 [] () {} 和内容？

> ID：10014976
> 
> 赞同：1
> 
> 时间：2012-04-04T16:03:38.837
> 
> 标签：php, regex, preg-replace

目前我正在使用

```
$str = preg_replace("/\([^\)]+\)/", "", $str); // Remove () and Content
$str = preg_replace("/\[[^\)]+\]/", "", $str); // Remove [] and Content
$str = preg_replace("/\{[^\)]+\}/", "", $str); // Remove {} and Content
$str = preg_replace("/[^a-zA-Z0-9]/", "", $str);  // Remove all non-alphanumeric characters 
```

我想知道是否有办法将这些组合成一个正则表达式

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-04T16:08:05.687

您可以使用`|`这些组合：

```
(\([^\)]+\)|\[[^\]]+\]|\{[^\}]+\})|[^A-Za-z0-9]) 
```

* * *

但在你的情况下，我通常只会遍历字符串并手动解析它。
使用“状态变量”（`$paren_open`, `$brace_open`, `$curly_open`）可以知道您是否忽略了字符。

即使它看起来不快（因为你必须遍历每个字符），它也比正则表达式快得多，因为正则表达式会做一些更复杂的事情。

* * *

**资源：**

*   [维基百科：状态模式](http://en.wikipedia.org/wiki/State_pattern)

# c - 在 C 中使用 drand48_r 作为随机数生成器

> ID：10014981
> 
> 赞同：2
> 
> 时间：2012-04-04T16:03:51.347
> 
> 标签：c, macos, random, openmp, gnu

所以我一直在用 C 编写一些应用程序并使用 OpenMP 进行并行化。我实现了一个 Monte-Carlo Pi 估计，发现正常的 rand() 函数不是可重入和线程安全的。建议使用 drand48_r 选项。

现在问题来了，我的应用程序在 Linux 上编译得很好，例如。Ubuntu、Fedora 和 CentOS，但不能在 Mac OS X 上编译。OS X 上的编译错误是。

> simple.c:7：错误：“randBuffer”的存储大小未知

用作简单示例的代码是：

```
#include <stdio.h>
#include <stdlib.h>

int main(int argc, char* argv[]) {

  double x;
  struct drand48_data randBuffer;

  srand48_r(time(NULL), &randBuffer);

  drand48_r(&randBuffer, &x);

  printf("Random number: %f\n", x);

  return EXIT_SUCCESS;
} 
```

我阅读了它，并在手册页中发现了一条注释，

> 这些函数是 GNU 扩展，不可移植。

这是它的链接：http: [//www.kernel.org/doc/man-pages/online/pages/man3/drand48_r.3.html](http://www.kernel.org/doc/man-pages/online/pages/man3/drand48_r.3.html)

所以我有很多问题；

1.  什么是 GNU 扩展，是什么使它不可移植？
2.  在 OS X 上生成随机数时，我有哪些替代方案，它也是线程安全的？

嗯，就是这样。

该示例使用 gcc 编译为，

> gcc simple.c -o 简单

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-04T16:14:16.403

我真的没有看到使用`drand48_r`over的好处`erand48`。`erand48`具有相同类型的随机生成器，`drand48`但与之相比，它接收随机生成器的状态作为函数参数，因此它完美地完成了这项工作。

扩展将`_r`结果存储在适当的位置（第二个参数）并返回一个始终保证为`0`. 我认为所有这些都没有多大用处。我会坚持使用 POSIX 接口（尤其是`erand48`）。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-04T16:15:37.287

使用 中的标准可重入函数`<stdlib.h>`。他们只是早于无处不在的`_r`后缀，所以他们的名字是：

```
 #include <stdlib.h>

 double drand48(void);

 double erand48(unsigned short xsubi[3]);

 long jrand48(unsigned short xsubi[3]);

 void lcong48(unsigned short param[7]);

 long lrand48(void);

 long mrand48(void);

 long nrand48(unsigned short xsubi[3]);

 unsigned short *seed48(unsigned short seed16v[3]);

 void srand48(long seedval); 
```

该`erand48()`函数将一个数据结构（实际上是一个由 3 个无符号短裤组成的数组）作为其状态。因此，您可以`drand48_r()`通过将其捆绑到本地定义的`drand48_data`结构中并进行`drand48_r()`call来实现 Mac OS X `erand48()`，或者您可以移植并使用[`erand48()`](http://pubs.opengroup.org/onlinepubs/9699919799/functions/erand48.html)POSIX 定义的并且自 1980 年代以来在大多数 Unix 系统上都可用。就个人而言，我会追求可移植性，但编写一个简单`drand48_r()`的代码也很简单，只是要找出声明它的标头。

# java - Solaris 上的内存压力会导致 JVM 中的 SIGSEGV 吗？

> ID：10014982
> 
> 赞同：0
> 
> 时间：2012-04-04T16:03:52.050
> 
> 标签：java, garbage-collection, solaris, segmentation-fault, jvm-crash

我在 Solaris 容器中的 Sun JVM 上运行了几个需要大量内存的 Java 服务器进程。最近我添加了更多进程，可能已经耗尽了总可用内存。Java 进程开始在负载下随机崩溃。在每种情况下，它都是 JVM 中线程 GCTaskThread 中的 SIGSEGV。有一次甚至`top`死于 SIGSEGV。

**当内存不足时，Solaris 是否会使用 SIGSEGV 杀死进程？**

而不是 SIGSEGV，我本来希望在随机位置获得 OutOfMemoryErrors。此外，我一直认为 JVM 中的段错误表示错误（除非涉及 JNI）。我需要知道我是否遇到了额外的 JVM 错误。

这是 Solaris 10 和 32 位 JRE 1.6u20。

* * *

```
#
# A fatal error has been detected by the Java Runtime Environment:
#
#  SIGSEGV (0xb) at pc=0xfeb6297c, pid=26468, tid=6
#
# JRE version: 6.0_20-b02
# Java VM: Java HotSpot(TM) Server VM (16.3-b01 mixed mode solaris-sparc )
# Problematic frame:
# V  [libjvm.so+0x76297c]
#
# If you would like to submit a bug report, please visit:
#   http://java.sun.com/webapps/bugreport/crash.jsp
#

---------------  T H R E A D  ---------------

Current thread (0x0003bc00):  GCTaskThread [stack: 0x8b300000,0x8b380000] [id=6]

siginfo:si_signo=SIGSEGV: si_errno=0, si_code=2 (SEGV_ACCERR), si_addr=0x8b828bfb

Registers:
 O0=0xf824d1d0 O1=0xdcdc43e8 O2=0xf824d1d3 O3=0x00000001
 O4=0xfee2d800 O5=0x00000003 O6=0x8b37f718 O7=0xfe546d18
 G1=0xfe55a854 G2=0x90d7f7b4 G3=0xfffffff4 G4=0x00000000
 G5=0xfee2dd5f G6=0x00000000 G7=0xfeed2200 Y=0x00000000
 PC=0xfeb6297c nPC=0xfeb62980

Top of Stack: (sp=0x8b37f718)
0x8b37f718:   8bc00000 00033158 fee3f000 fbc00000
0x8b37f728:   70000000 1c000000 8b3a2000 00033200
0x8b37f738:   fee3b800 00486bfb 00000011 00000003
0x8b37f748:   f824d1d3 dbc00000 8b37f778 fe55a854
0x8b37f758:   ed204000 00001000 00000000 00000032
0x8b37f768:   8737f7f0 0003c3a8 8b37f7ec 0191c568
0x8b37f778:   0003c3a8 00000010 00000003 00000003
0x8b37f788:   00000009 8b37f84c 00000004 8b37f84c

Instructions: (pc=0xfeb6297c)
0xfeb6296c:   ee 06 21 b8 b3 36 60 09 b4 10 20 11 ec 05 e0 4c
0xfeb6297c:   f4 2d 80 19 81 c7 e0 08 81 e8 20 00 9d e3 bf a0

Stack: [0x8b300000,0x8b380000],  sp=0x8b37f718,  free space=1fdfeb6297ck
Native frames: (J=compiled Java code, j=interpreted, Vv=VM code, C=native code)
V  [libjvm.so+0x76297c]
V  [libjvm.so+0x15a85c]
V  [libjvm.so+0x486acc]
V  [libjvm.so+0x169314]
V  [libjvm.so+0x16bda0]
V  [libjvm.so+0x24c2a4]
V  [libjvm.so+0x72a1a0]

---------------  P R O C E S S  ---------------

Java Threads: ( => current thread )
  0x027bf800 JavaThread "pool-3-thread-31" [_thread_blocked, id=1171, stack(0x90d00000,0x90d80000)]
  0x028df000 JavaThread "AWT-EventQueue-0" [_thread_blocked, id=1169, stack(0x91400000,0x91480000)]
  0x028dec00 JavaThread "AWT-Shutdown" [_thread_blocked, id=1168, stack(0x91700000,0x91780000)]
  0x00dd4800 JavaThread "Product-producer-thread-7" [_thread_blocked, id=1165, stack(0x90b00000,0x90b80000)]
  0x03a18400 JavaThread "Orbacus:GIOPConnectionThreaded:ReceiverThread" [_thread_in_native, id=580, stack(0x85100000,0x85180000)]
  0x00f83c00 JavaThread "BaseComTimerThread-9" daemon [_thread_blocked, id=287, stack(0x88d80000,0x88e00000)]
  0x014d5000 JavaThread "PACCommand_7" [_thread_blocked, id=105, stack(0x86500000,0x86580000)]
  0x0109b800 JavaThread "PACCommand_6" [_thread_blocked, id=104, stack(0x86600000,0x86680000)]
  0x0109b000 JavaThread "PACCommand_5" [_thread_blocked, id=103, stack(0x86700000,0x86780000)]
  0x00d75800 JavaThread "PACCommand_4" [_thread_blocked, id=102, stack(0x86800000,0x86880000)]
  0x0106ac00 JavaThread "PACCommand_3" [_thread_blocked, id=101, stack(0x86900000,0x86980000)]
  0x01529000 JavaThread "PACCommand_2" [_thread_blocked, id=100, stack(0x86a00000,0x86a80000)]
  0x0131e800 JavaThread "PACCommand_1" [_thread_blocked, id=99, stack(0x86b00000,0x86b80000)]
  0x01163400 JavaThread "BaseComSingleThread-1" daemon [_thread_blocked, id=91, stack(0x86d00000,0x86d80000)]
  0x002f6800 JavaThread "FailoverExecutorThread-0" daemon [_thread_blocked, id=90, stack(0x87500000,0x87580000)]
  0x00dd6800 JavaThread "Orbacus:GIOPConnectionThreaded:ReceiverThread" daemon [_thread_in_native, id=89, stack(0x86f00000,0x86f80000)]
  0x00b8fc00 JavaThread "NonGUI_5" [_thread_blocked, id=87, stack(0x86e00000,0x86e80000)]
  0x0091d000 JavaThread "NonGUI_4" [_thread_blocked, id=86, stack(0x87000000,0x87080000)]
  0x0191e800 JavaThread "NonGUI_3" [_thread_blocked, id=82, stack(0x87100000,0x87180000)]
  0x01fa0400 JavaThread "NonGUI_2" [_thread_blocked, id=81, stack(0x87200000,0x87280000)]
  0x018f6800 JavaThread "NonGUI_1" [_thread_blocked, id=80, stack(0x87300000,0x87380000)]
  0x00ef0400 JavaThread "Timer legends" [_thread_blocked, id=79, stack(0x87400000,0x87480000)]
  0x01179400 JavaThread "Orbacus:GIOPConnectionThreaded:ReceiverThread" daemon [_thread_in_native, id=75, stack(0x87600000,0x87680000)]
  0x009bd800 JavaThread "Orbacus:GIOPConnectionThreaded:ReceiverThread" daemon [_thread_in_native, id=73, stack(0x87700000,0x87780000)]
  0x00931800 JavaThread "Orbacus:GIOPConnectionThreaded:ReceiverThread" daemon [_thread_in_native, id=71, stack(0x88980000,0x88a00000)]
  0x00a6e400 JavaThread "Orbacus:GIOPConnectionThreaded:ReceiverThread" daemon [_thread_in_native, id=69, stack(0x88a80000,0x88b00000)]
  0x0113b400 JavaThread "Orbacus:GIOPConnectionThreaded:ReceiverThread" daemon [_thread_in_native, id=67, stack(0x88b80000,0x88c00000)]
  0x00c72000 JavaThread "Orbacus:GIOPConnectionThreaded:ReceiverThread" daemon [_thread_in_native, id=65, stack(0x87900000,0x87980000)]
  0x001bbc00 JavaThread "Orbacus:GIOPConnectionThreaded:ReceiverThread" daemon [_thread_in_native, id=63, stack(0x87a00000,0x87a80000)]
  0x00f45c00 JavaThread "Access Layer MDT Update Thread #0" daemon [_thread_blocked, id=60, stack(0x89900000,0x89980000)]
  0x00a70c00 JavaThread "Orbacus:GIOPConnectionThreaded:ReceiverThread" daemon [_thread_in_native, id=59, stack(0x87800000,0x87880000)]
  0x00a68800 JavaThread "AWT-XAWT" daemon [_thread_in_native, id=53, stack(0x87b00000,0x87b80000)]
  0x008ecc00 JavaThread "ProductTimer" [_thread_blocked, id=52, stack(0x87d00000,0x87d80000)]
  0x00030400 JavaThread "DestroyJavaVM" [_thread_blocked, id=2, stack(0xfe300000,0xfe380000)]
  0x00e34c00 JavaThread "Orbacus:GIOPConnectionThreaded:ReceiverThread" [_thread_in_native, id=48, stack(0x87e00000,0x87e80000)]
  0x00e32800 JavaThread "Orbacus:GIOPConnectionThreaded:ReceiverThread" daemon [_thread_in_native, id=47, stack(0x87f00000,0x87f80000)]
  0x00f68400 JavaThread "Proxy.cleaner" daemon [_thread_blocked, id=45, stack(0x88000000,0x88080000)]
  0x00f67400 JavaThread "Thread-10" [_thread_blocked, id=44, stack(0x88100000,0x88180000)]
  0x00f66400 JavaThread "Timer-1" [_thread_blocked, id=43, stack(0x88200000,0x88280000)]
  0x00f64c00 JavaThread "CORBA cleaner" daemon [_thread_blocked, id=42, stack(0x88300000,0x88380000)]
  0x00f64400 JavaThread "Timer-0" [_thread_blocked, id=41, stack(0x88400000,0x88480000)]
  0x0117e800 JavaThread "BaseComExecutorThread-4" [_thread_blocked, id=40, stack(0x88500000,0x88580000)]
  0x01fbd400 JavaThread "BaseComExecutorThread-3" [_thread_blocked, id=39, stack(0x88600000,0x88680000)]
  0x011ad400 JavaThread "BaseComExecutorThread-2" [_thread_blocked, id=38, stack(0x88700000,0x88780000)]
  0x011acc00 JavaThread "Product.scheduler.thread" [_thread_blocked, id=37, stack(0x88800000,0x88880000)]
  0x00a9f800 JavaThread "Java2D Disposer" daemon [_thread_blocked, id=35, stack(0x88e80000,0x88f00000)]
  0x00e95000 JavaThread "Orbacus:GIOPConnectionThreaded:ReceiverThread" [_thread_in_native, id=34, stack(0x89400000,0x89480000)]
  0x00c14400 JavaThread "BaseComExecutorThread-1" [_thread_blocked, id=32, stack(0x89500000,0x89580000)]
  0x00e92000 JavaThread "ConfigCacheCleaner4" daemon [_thread_blocked, id=31, stack(0x89600000,0x89680000)]
  0x00f4e400 JavaThread "ConfigCacheCleaner3" daemon [_thread_blocked, id=30, stack(0x89700000,0x89780000)]
  0x00cb6000 JavaThread "Orbacus:GIOPConnectionThreaded:ReceiverThread" daemon [_thread_in_native, id=29, stack(0x89800000,0x89880000)]
  0x00ba0800 JavaThread "BaseComTimerThread-1" daemon [_thread_blocked, id=25, stack(0x89a00000,0x89a80000)]
  0x00133000 JavaThread "TaskRouterThread-1" daemon [_thread_blocked, id=24, stack(0x89b00000,0x89b80000)]
  0x00f3c000 JavaThread "NINJO_CACHE_1333544439197_ScratchConfigCache1.3_2.data" daemon [_thread_blocked, id=23, stack(0x89c00000,0x89c80000)]
  0x00c00400 JavaThread "NINJO_CACHE_1333544439197_ScratchConfigCache1.3_1.data" daemon [_thread_blocked, id=22, stack(0x89d00000,0x89d80000)]
  0x00ed6c00 JavaThread "NINJO_CACHE_1333544439197_ScratchConfigCache1.3.data" daemon [_thread_blocked, id=21, stack(0x89e00000,0x89e80000)]
  0x00ba3c00 JavaThread "com.product.fwk.common.cache.impl.EHCacheManager@b02928" daemon [_thread_blocked, id=20, stack(0x89f00000,0x89f80000)]
  0x00aa3400 JavaThread "com.product.fwk.common.cache.impl.EHCacheManager@b02928" daemon [_thread_blocked, id=19, stack(0x8a000000,0x8a080000)]
  0x00ab5400 JavaThread "ConfigCacheCleaner2" daemon [_thread_blocked, id=18, stack(0x8a100000,0x8a180000)]
  0x00c0d800 JavaThread "ConfigCacheCleaner1" daemon [_thread_blocked, id=17, stack(0x8a200000,0x8a280000)]
  0x00e40000 JavaThread "ORB-Thread" [_thread_blocked, id=16, stack(0x8a300000,0x8a380000)]
  0x00e3e800 JavaThread "ORBacus:Server:StarterThread" [_thread_in_native, id=15, stack(0x8a400000,0x8a480000)]
  0x00127c00 JavaThread "Low Memory Detector" daemon [_thread_blocked, id=13, stack(0x8aa80000,0x8ab00000)]
  0x00126000 JavaThread "CompilerThread1" daemon [_thread_blocked, id=12, stack(0x8ab80000,0x8ac00000)]
  0x00123800 JavaThread "CompilerThread0" daemon [_thread_blocked, id=11, stack(0x8ac80000,0x8ad00000)]
  0x00122000 JavaThread "Signal Dispatcher" daemon [_thread_blocked, id=10, stack(0x8ad80000,0x8ae00000)]
  0x0010d000 JavaThread "Finalizer" daemon [_thread_blocked, id=9, stack(0x8ae80000,0x8af00000)]
  0x0010b800 JavaThread "Reference Handler" daemon [_thread_blocked, id=8, stack(0x8af80000,0x8b000000)]

Other Threads:
  0x00109400 VMThread [stack: 0x8b080000,0x8b100000] [id=7]
  0x0012ac00 WatcherThread [stack: 0x8a980000,0x8aa00000] [id=14]

=>0x0003bc00 (exited) GCTaskThread [stack: 0x8b300000,0x8b380000] [id=6]

VM state:at safepoint (normal execution)

VM Mutex/Monitor currently owned by a thread:  ([mutex/lock_event])
[0x0002f578] Threads_lock - owner thread: 0x00109400
[0x0002f988] Heap_lock - owner thread: 0x00dd4800

Heap
 PSYoungGen      total 457280K, used 83928K [0xdbc00000, 0xfbc00000, 0xfbc00000)
  eden space 391808K, 21% used [0xdbc00000,0xe0df6178,0xf3aa0000)
  from space 65472K, 0% used [0xf3aa0000,0xf3aa0000,0xf7a90000)
  to   space 61632K, 4% used [0xf7fd0000,0xf8254130,0xfbc00000)
 PSOldGen        total 1048576K, used 331538K [0x9bc00000, 0xdbc00000, 0xdbc00000)
  object space 1048576K, 31% used [0x9bc00000,0xaffc4b68,0xdbc00000)
 PSPermGen       total 49152K, used 45797K [0x8bc00000, 0x8ec00000, 0x9bc00000)
  object space 49152K, 93% used [0x8bc00000,0x8e8b9690,0x8ec00000)

Dynamic libraries:
0x00010000      /opt/product/release_1.6/server/jre/bin/java
0xff3a0000      /lib/libthread.so.1
0xff370000      /opt/product/release_1.6/server/jre/bin/../lib/sparc/jli/libjli.so
0xff350000      /lib/libdl.so.1
0xff200000      /lib/libc.so.1
0xff390000      /platform/SUNW,SPARC-Enterprise/lib/libc_psr.so.1
0xfe400000      /opt/product/release_1.6/server/jre/lib/sparc/server/libjvm.so
0xff1d0000      /lib/libsocket.so.1
0xff1f0000      /usr/lib/libsched.so.1
0xff1b0000      /lib/libm.so.1
0xff180000      /usr/lib/libCrun.so.1
0xff160000      /lib/libdoor.so.1
0xff080000      /lib/libnsl.so.1
0xfef80000      /lib/libm.so.2
0xff050000      /lib/libscf.so.1
0xff140000      /lib/libuutil.so.1
0xff030000      /lib/libgen.so.1
0xfef50000      /lib/libmd.so.1
0xfef30000      /lib/libmp.so.2
0xfeea0000      /opt/product/release_1.6/server/jre/lib/sparc/libverify.so
0xfee60000      /opt/product/release_1.6/server/jre/lib/sparc/libjava.so
0xfe3e0000      /opt/product/release_1.6/server/jre/lib/sparc/native_threads/libhpi.so
0xfe2e0000      /lib/nss_files.so.1
0xfe2b0000      /usr/lib/nss_vas4.so.1
0xfe280000      /opt/quest/lib/libvtsmartcache.so.1
0xfe180000      /opt/quest/lib/libvtutil.so.1
0xfe230000      /opt/quest/lib/libvtcacheipc.so.1
0xfe120000      /lib/libresolv.so.2
0xfe100000      /opt/product/release_1.6/server/jre/lib/sparc/libzip.so
0xfe0b0000      /usr/lib/locale/en_US.ISO8859-1/en_US.ISO8859-1.so.3
0x8ae50000      /opt/product/release_1.6/server/jre/lib/sparc/libnet.so
0x89200000      /opt/product/release_1.6/server/jre/lib/sparc/libawt.so
0x8ad20000      /opt/product/release_1.6/server/jre/lib/sparc/xawt/libmawt.so
0x8ae10000      /usr/openwin//lib/libXext.so.0
0x89080000      /usr/openwin//lib/libX11.so.4
0x8ac50000      /usr/openwin//lib/libXtst.so.1
0x8ac20000      /usr/openwin//lib/libXi.so.5
0x88f80000      /opt/product/release_1.6/server/jre/lib/sparc/libfontmanager.so
0x8b110000      /opt/product/release_1.6/server/jre/lib/sparc/libnio.so
0x8ab60000      /lib/librt.so.1
0x8ab40000      /lib/libaio.so.1
0x8af10000      /usr/lib/libsendfile.so.1
0x887d0000      /opt/product/release_1.6/server/jre/lib/sparc/libmanagement.so
0x887b0000      /usr/openwin/lib/locale/common/xlibi18n.so.2
0x886d0000      /usr/X11/lib/libXcursor.so.1
0x886a0000      /usr/openwin/sfw/lib/libXrender.so.1
0x8a850000      /opt/product/release_1.6/server/jre/lib/sparc/libdcpr.so

VM Arguments:
jvm_args: -Xmx1536M -Xms1536M -XX:MaxPermSize=256m -XX:-ReduceInitialCardMarks -Djava.ext.dirs=/opt/product/release_1.6/server/lib/ext -Djava.endorsed.dirs=/opt/product/release_1.6/server/lib/boot -Dorg.omg.CORBA.ORBClass=com.ooc.CORBA.ORB -Dorg.omg.CORBA.ORBSingletonClass=com.ooc.CORBA.ORBSingleton -Dcorba.port=23801 -Dserver.name=ProductServer -Dserver.basedir=/data/product -Dproduct.log.path=../../log -Dproduct.i18n.locale.language=en
java_command: /opt/product/release_1.6/server/lib/product/ProductMain.jar /opt/product/release_1.6/server/config.properties
Launcher Type: SUN_STANDARD

Environment Variables:
CLASSPATH=/opt/local/opkg/share/oracle/product/10.2.0/jdbc/lib/classes12.zip
PATH=/usr/bin:/usr/sbin:/usr/local/bin:/opt/local/opkg/bin:/opt/local/opkg/sbin:/home/ext/user/bin:/opt/local/opkg/share/oracle/product/10.2.0/bin:/usr/bin:/usr/sbin:/usr/local/bin:/opt/local/opkg/bin:/opt/local/opkg/sbin:/home/users/user/bin:/usr/bin:/home/users/user/bin
LD_LIBRARY_PATH=/opt/product/release_1.6/server/jre/lib/sparc/server:/opt/product/release_1.6/server/jre/lib/sparc:/opt/product/release_1.6/server/jre/../lib/sparc:/opt/local/opkg/share/oracle/product/10.2.0/lib32:/opt/local/opkg/share/oracle/product/10.2.0/lib:/opt/local/opkg/share/oracle/product/10.2.0/jdbc/lib32
SHELL=/bin/bash
DISPLAY=localhost:63.0

Signal Handlers:
SIGSEGV: [libjvm.so+0x84dd5c], sa_mask[0]=0xffbffeff, sa_flags=0x0000000c
SIGBUS: [libjvm.so+0x84dd5c], sa_mask[0]=0xffbffeff, sa_flags=0x0000000c
SIGFPE: [libjvm.so+0x1c0330], sa_mask[0]=0xffbffeff, sa_flags=0x0000000c
SIGPIPE: [libjvm.so+0x1c0330], sa_mask[0]=0xffbffeff, sa_flags=0x0000000c
SIGXFSZ: [libjvm.so+0x1c0330], sa_mask[0]=0xffbffeff, sa_flags=0x0000000c
SIGILL: [libjvm.so+0x1c0330], sa_mask[0]=0xffbffeff, sa_flags=0x0000000c
SIGUSR1: SIG_DFL, sa_mask[0]=0x00000000, sa_flags=0x00000000
SIGUSR2: SIG_DFL, sa_mask[0]=0x00000000, sa_flags=0x00000000
SIGQUIT: [libjvm.so+0x72c934], sa_mask[0]=0xffbffeff, sa_flags=0x00000004
SIGHUP: SIG_IGN, sa_mask[0]=0x00000000, sa_flags=0x00000000
SIGINT: SIG_IGN, sa_mask[0]=0x00000000, sa_flags=0x00000000
SIGTERM: [libjvm.so+0x72c934], sa_mask[0]=0xffbffeff, sa_flags=0x00000004
SIG39: [libjvm.so+0x730360], sa_mask[0]=0x00000000, sa_flags=0x00000008
SIG40: [libjvm.so+0x1c0330], sa_mask[0]=0xffbffeff, sa_flags=0x0000000c

---------------  S Y S T E M  ---------------

OS:                      Solaris 10 10/09 s10s_u8wos_08a SPARC
           Copyright 2009 Sun Microsystems, Inc.  All Rights Reserved.
                        Use is subject to license terms.
                           Assembled 16 September 2009

uname:SunOS 5.10 Generic_142909-17 sun4u  (T2 libthread)
rlimit: STACK 8192k, CORE infinity, NOFILE 8192, AS infinity
load average:7.79 3.58 3.31

CPU:total 4 has_v8, has_v9, popc, has_vis1, has_vis2, is_ultra3

Memory: 8k page, physical 15728640k(1399920k free)

vm_info: Java HotSpot(TM) Server VM (16.3-b01) for solaris-sparc JRE (1.6.0_20-b02), built on Apr 12 2010 14:27:21 by "" with Workshop 5.8

time: Wed Apr  4 13:50:18 2012
elapsed time: 2982 seconds 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-13T15:23:10.577

垃圾收集器线程正在遍历内存中的对象并尝试取消引用不存在的指针 0x8b828bfb。

我会调查任何创建对象并将对象返回给 jvm 的 jni 调用。
看来您正在使用 CORBA，它可能会为 jvm 生成对象。根据您使用 corba 的方式，数据流中可能存在某些内容或您使用它的方式会导致问题。

由于您对“顶部”有疑问，您可能还想验证内存是否良好。一个坏的内存芯片会使系统运行不稳定。sparc 系统的引导程序中有一个内存诊断例程。用于交换的磁盘也可能导致内存问题。

# c# - 当非只读类已经存在时的只读类设计

> ID：10014984
> 
> 赞同：13
> 
> 时间：2012-04-04T16:03:55.357
> 
> 标签：c#, readonly

我有一个类，它在构建时从数据库中加载它的信息。该信息都是可修改的，然后开发人员可以对其调用 Save() 以使其将该信息保存回数据库。

我还在创建一个将从数据库加载的类，但不允许对其进行任何更新。（只读版本。）我的问题是，我应该创建一个单独的类并继承，还是应该只更新现有对象以在构造函数中采用只读参数，还是应该完全创建一个单独的类？

现有的类已经在代码中的许多地方使用。

谢谢。

**更新：**

首先，这里有很多很棒的答案。很难只接受一个。谢谢大家。

**主要问题似乎是：**

*   满足基于类名和继承结构的期望。
*   防止不必要的重复代码

Readable 和 ReadOnly 之间似乎有很大的区别。Readonly 类可能不应该被继承。但是 Readable 类表明它也可能在某些时候获得可写性。

所以经过深思熟虑，这就是我的想法：

```
public class PersonTestClass
{
    public static void Test()
    {

        ModifiablePerson mp = new ModifiablePerson();
        mp.SetName("value");
        ReadOnlyPerson rop = new ReadOnlyPerson();
        rop.GetName();
        //ReadOnlyPerson ropFmp = (ReadOnlyPerson)mp;  // not allowed.
        ReadOnlyPerson ropFmp = (ReadOnlyPerson)(ReadablePerson)mp; 
          // above is allowed at compile time (bad), not at runtime (good).
        ReadablePerson rp = mp;
    }
}

public class ReadablePerson
{
    protected string name;
    public string GetName()
    {
        return name;
    }        
}
public sealed class ReadOnlyPerson : ReadablePerson
{
}
public class ModifiablePerson : ReadablePerson
{
    public void SetName(string value)
    {
        name = value;
    }
} 
```

不幸的是，我还不知道如何使用属性来执行此操作（请参阅 StriplingWarrior 对使用属性完成的回答），但我感觉它将涉及受保护的关键字和[非对称属性访问修饰符](http://newoldthing.wordpress.com/2007/09/02/c-property-access-modifier/)。

另外，对我来说幸运的是，从数据库加载的数据不必转换为引用对象，而是简单的类型。这意味着我真的不必担心人们会修改`ReadOnlyPerson`对象的成员。

**更新 2：**

请注意，正如 StriplingWarrior 所建议的那样，向下转换可能会导致问题，但这通常是正确的，因为将猴子转换为狗，将动物向下转换为狗可能很糟糕。然而，似乎即使在编译时允许强制转换，但在运行时实际上是不允许的。

包装器类也可以解决问题，但我更喜欢这个，因为它避免了必须深度复制传入的对象/允许修改传入的对象从而修改包装器类的问题。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-04-04T16:08:32.407

[Liskov 替换原则](http://en.wikipedia.org/wiki/Liskov_substitution_principle)说你不应该让你的只读类继承你的读写类，因为消费类必须知道他们不能在没有异常的情况下调用它的 Save 方法。

让可写类扩展可读类对我来说更有意义，只要可读类上没有任何内容表明其对象永远不会被持久化。例如，我不会调用基类 a `ReadOnly[Whatever]`，因为如果您有一个将 a`ReadOnlyPerson`作为参数的方法，那么该方法将有理由假设他们对该对象所做的任何事情都不可能对数据库，如果实际实例是`WriteablePerson`.

### 更新

我最初假设在您的只读类中，您只想阻止人们调用该`Save`方法。根据我在您对问题的回答中看到的内容（顺便说一句，这实际上应该是您问题的更新），这是您可能想要遵循的模式：

```
public abstract class ReadablePerson
{

    public ReadablePerson(string name)
    {
        Name = name;
    }

    public string Name { get; protected set; }

}

public sealed class ReadOnlyPerson : ReadablePerson
{
    public ReadOnlyPerson(string name) : base(name)
    {
    }
}

public sealed class ModifiablePerson : ReadablePerson
{
    public ModifiablePerson(string name) : base(name)
    {
    }
    public new string Name { 
        get {return base.Name;}
        set {base.Name = value; }
    }
} 
```

这确保了真正`ReadOnlyPerson`不能简单地转换为 ModifiablePerson 并进行修改。但是，如果您愿意相信开发人员不会尝试以这种方式降低参数，那么我更喜欢 Steve 和 Olivier 的答案中基于接口的方法。

另一种选择是让你`ReadOnlyPerson`只是一个`Person`对象的包装类。这将需要更多样板代码，但当您无法更改基类时它会派上用场。

最后一点，既然您喜欢学习 Liskov 替换原则：通过让 Person 类负责将自己从数据库中加载出来，您就违反了单一职责原则。理想情况下，您的 Person 类将具有表示包含“Person”的数据的属性，并且将有一个不同的类（可能是一个`PersonRepository`）负责从数据库中生成 Person 或将 Person 保存到数据库中。

### 更新 2

回复您的评论：

*   虽然您可以在技术上回答自己的问题，但 StackOverflow 主要是关于从其他人那里获得答案。这就是为什么在某个宽限期过去之前，它不会让您接受自己的答案。我们鼓励您完善您的问题并回复评论和答案，直到有人对您的初始问题提出适当的解决方案。
*   我开设这`ReadablePerson`门课`abstract`是因为您似乎只想创建一个只读或可写的人。即使两个子类都可以被认为是 ReadablePerson，但是`new ReadablePerson()`当您可以轻松地创建a 时，创建 a 的意义`new ReadOnlyPerson()`何在？使类抽象化要求用户在实例化它们时选择两个子类之一。
*   PersonRepository 有点像工厂，但“存储库”一词表示您实际上是从某个数据源中提取人员的信息，而不是凭空创建人员。
*   在我看来，Person 类只是一个 POCO，其中没有任何逻辑：只是属性。存储库将负责构建 Person 对象。而不是说：

    ```
    // This is what I think you had in mind originally
    var p = new Person(personId); 
    ```

    ...并允许 Person 对象进入数据库以填充其各种属性，您会说：

    ```
    // This is a better separation of concerns
    var p = _personRepository.GetById(personId); 
    ```

    然后 PersonRepository 将从数据库中获取适当的信息并使用该数据构造 Person。

    如果您想调用一个没有理由更改人员的方法，您可以通过将其转换为 Readonly 包装器来保护该人员免受更改（遵循 .NET 库对`ReadonlyCollection<T>`类遵循的模式）。另一方面，需要可写对象的方法可以`Person`直接给出：

    ```
    var person = _personRepository.GetById(personId);
    // Prevent GetVoteCount from changing any of the person's information
    int currentVoteCount = GetVoteCount(person.AsReadOnly()); 
    // This is allowed to modify the person. If it does, save the changes.
    if(UpdatePersonDataFromLdap(person))
    {
         _personRepository.Save(person);
    } 
    ```

*   使用接口的好处是您不会强制使用特定的类层次结构。这将在未来为您提供更好的灵活性。例如，假设您现在这样编写方法：

    ```
    GetVoteCount(ReadablePerson p);
    UpdatePersonDataFromLdap(ReadWritePerson p); 
    ```

    ...但是在两年后您决定更改为包装器实现。突然`ReadOnlyPerson`不再是 a `ReadablePerson`，因为它是一个包装类而不是基类的扩展。您是否更改`ReadablePerson`了`ReadOnlyPerson`所有方法签名？

    或者说您决定简化事情并将所有类合并到一个`Person`类中：现在您必须更改所有方法以仅获取 Person 对象。另一方面，如果您已经对接口进行了编程：

    ```
    GetVoteCount(IReadablePerson p);
    UpdatePersonDataFromLdap(IReadWritePerson p); 
    ```

    ...那么这些方法并不关心你的对象层次结构是什么样的，只要你给他们的对象实现了他们要求的接口。您可以随时更改实现层次结构，而无需更改这些方法。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-04-04T16:15:53.463

绝对不要让只读类继承自可写类。派生类应该扩展和修改基类的能力；他们永远不应该剥夺能力。

您也许可以使可写类继承自只读类，但您需要谨慎行事。要问的关键问题是，只读类的任何消费者是否会依赖它是只读的这一事实？如果消费者指望值永远不会改变，但可写派生类型被传入，然后值被改变，那么消费者可能会被破坏。

我知道，由于这两种类型的结构（即它们包含的数据）相似或相同，因此很容易认为一种应该从另一种继承。但情况往往并非如此。如果它们是为明显不同的用例而设计的，它们可能需要是单独的类。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-04-04T16:17:34.040

一个快速的选择可能是创建一个`IReadablePerson`（等）接口，它只包含 get 属性，不包括 Save()。然后，您可以让现有的类实现该接口，并且在您需要只读访问权限的地方，让使用代码通过该接口引用该类。

为了与模式保持一致，您可能还希望有一个`IReadWritePerson`接口，其中包含 setter 和`Save()`.

**编辑**进一步考虑，`IWriteablePerson`应该是`IReadWritePerson`，因为拥有只写类没有多大意义。

例子：

```
public interface IReadablePerson
{
    string Name { get; }
}

public interface IReadWritePerson : IReadablePerson
{
    new string Name { get; set; }
    void Save();
}

public class Person : IReadWritePerson
{
    public string Name { get; set; }
    public void Save() {}
} 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2012-04-04T16:38:22.033

问题是，“你想如何通过继承将可修改类变成只读类？” 通过继承，您可以扩展一个类，但不能限制它。通过抛出异常这样做会违反[Liskov 替换原则](http://en.wikipedia.org/wiki/Liskov_substitution_principle)(LSP)。

反过来，从只读类派生一个可修改类从这个角度来看是可以的；但是，您想如何将只读属性转换为读写属性？而且，是否希望能够在需要只读对象的地方替换可修改对象？

但是，您可以使用接口执行此操作

```
interface IReadOnly
{
    int MyProperty { get; }
}

interface IModifiable : IReadOnly
{
    new int MyProperty { set; }
    void Save();
} 
```

`IReadOnly`这个类也与接口兼容。在只读上下文中，您可以通过`IReadOnly`接口访问它。

```
class ModifiableClass : IModifiable
{
    public int MyProperty { get; set; }
    public void Save()
    {
        ...
    }
} 
```

* * *

更新

我对这个问题做了一些进一步的调查。

但是，有一点需要注意，我必须在其中添加一个`new`关键字`IModifiable`，您只能直接通过`ModifiableClass`或通过`IReadOnly`接口访问 getter，而不能通过`IModifiable`接口访问。

我还尝试使用两个接口`IReadOnly`，`IWriteOnly`分别只有一个 getter 或一个 setter。然后，您可以声明一个继承自它们的接口，并且`new`在属性前面不需要关键字（如`IModifiable`）。但是，当您尝试访问此类对象的属性时，您会遇到编译器错误`Ambiguity between 'IReadOnly.MyProperty' and 'IWriteOnly.MyProperty'`。

显然，正如我所料，不可能从单独的 getter 和 setter 合成一个属性。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-04T17:23:30.373

在为用户安全权限创建对象时我有同样的问题要解决，在某些情况下必须是可变的以允许高级用户修改安全设置，但通常是只读的以存储当前登录用户的权限信息不允许代码即时修改这些权限。

我想出的模式是定义一个可变对象实现的接口，它具有只读属性获取器。然后，该接口的可变实现可以是私有的，允许直接处理实例化和水合对象的代码这样做，但是一旦从该代码中返回对象（作为接口的实例），setter 将不再可访问.

例子：

```
//this is what "ordinary" code uses for read-only access to user info.
public interface IUser
{
   string UserName {get;}
   IEnumerable<string> PermissionStrongNames {get;}

   ...
}

//This class is used for editing user information.
//It does not implement the interface, and so while editable it cannot be 
//easily used to "fake" an IUser for authorization
public sealed class EditableUser 
{
   public string UserName{get;set;}
   List<SecurityGroup> Groups {get;set;}

   ...
}

...

//this class is nested within the class responsible for login authentication,
//which returns instances as IUsers once successfully authenticated
private sealed class AuthUser:IUser
{
   private readonly EditableUser user;

   public AuthUser(EditableUser mutableUser) { user = mutableUser; }

   public string UserName {get{return user.UserName;}}

   public IEnumerable<string> PermissionNames 
   {
       //GetPermissions is an extension method that traverses the list of nestable Groups.
       get {return user.Groups.GetPermissions().Select(p=>p.StrongName);
   }

   ...
} 
```

像这样的模式允许您以读写方式使用您已经创建的代码，同时不允许 Joe Programmer 将只读实例转换为可变实例。在我的实际实现中还有一些技巧，主要是处理可编辑对象的持久性（由于编辑用户记录是一项安全操作，无法使用 Repository 的“正常”持久性方法保存 EditableUser；它需要调用一个重载还需要一个必须具有足够权限的 IUser）。

您必须了解的一件事；如果您的程序可以在任何范围内编辑记录，那么无论是有意还是无意，这种能力都可能被滥用。有必要对对象的可变或不可变形式的任何用法进行定期代码审查，以确保其他编码人员没有做任何“聪明”的事情。这种模式也不足以确保公众使用的应用程序是安全的；如果您可以编写 IUser 实现，那么攻击者也可以，因此您需要一些额外的方法来验证您的代码而不是攻击者生成了特定的 IUser 实例，并且该实例在此期间没有被篡改。

# collections - Collection of objects in classic ASP using VBScript?

> ID：10014986
> 
> 赞同：4
> 
> 时间：2012-04-04T16:03:58.150
> 
> 标签：collections, asp-classic, vbscript

I have a class called 'Company' that has properties like 'CompanyName', 'CompanyCode' and 'IsActive'. This class is in VBScript. I want to store a collection of Company objects using VBScript in classic ASP. Is this possible, and if yes, then how would I do it?

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-04-04T17:25:04.633

You can use an array or a dictionary object:

**Array**

```
' create an array with a fixed size
dim companies(2) 

' fill the array with the companies
set companies(0) = Company1 
set companies(1) = Company2
set companies(2) = Company3

' iteration example 1
dim company
for each company in companies
    response.write company.CompanyName
next

' iteration example 2
dim i
for i = 0 to ubound(companies)
    response.write companies(i).CompanyName
next 
```

**Dictionary**

```
' create a dictionary object
dim companies
set companies = server.createObject("Scripting.Dictionary")

' add the companies
companies.add "Key1", Company1
companies.add "Key2", Company2
companies.add "Key3", Company3

' iteration example
dim key
for each key in companies.keys
    response.write key & " = " & companies.item(key).CompanyName
next 
```

# c# - 动态反序列化，或 LINQ to XML

> ID：10014987
> 
> 赞同：1
> 
> 时间：2012-04-04T16:03:58.370
> 
> 标签：c#, model-view-controller, xml-serialization, linq-to-xml

使用 C# Visual Studio 2008、MVC1。

我通过从 WebService 获取一个 xml 文件并向其中添加一些节点来创建一个 xml 文件。现在我想将它反序列化为一个类，该类是用于强类型化视图的模型。

首先，在不将 xml 存储在文件系统中的情况下，我遇到了问题，因为我不知道序列化和反序列化是如何工作的。我想有办法，而且只是时间问题。

但是，在网上搜索之前我遇到了 LINQ to XML，现在我怀疑是否更好地使用它。

xml 将由一些客户详细信息形成，基本上我将使用所有这些。

有什么提示吗？

谢谢！！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-04T16:33:28.573

试试这个：

```
XmlSerializer xmls = new XmlSerializer(typeof(XElement)); 
FileStream FStream;
try 
{             
   FStream = new FileStream(doctorsPath, FileMode.Open);
  _Doctors = (XElement)xmls.Deserialize(FStream); FStream.Close(); 
   FStream = new FileStream(patientsPath, FileMode.Open); 
  _Patients = (XElement)xmls.Deserialize(FStream)
   FStream.Close(); 
   FStream = new FileStream(treatmentsPath, FileMode.Open);
  _Treatments = (XElement)xmls.Deserialize(FStream);
    FStream.Close(); 
} 
catch 

{ } 
```

这会将所有 XML 文件加载到我们的 XElement 变量中。try-catch 块是一种异常处理形式，可确保如果 try 块中的某个函数抛出异常，程序将跳转到不会发生任何事情的 catch 部分。在处理文件时，尤其是读取文件时，使用 try-catch 是一个好主意。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-04T16:36:56.547

您可以将 XElement 保存到一个或从一个`MemoryStream`（无需将其保存到文件流）

```
 MemoryStream ms = new MemoryStream();
 XmlWriter xw = XmlWriter.Create(ms);
 document.Save(xw);
 xw.Flush(); 
```

然后，如果您将位置重置回 0，则可以使用 DataContractSerializer 对其进行反序列化。

```
 ms.Position = 0;
 DataContractSerializer serializer = new DataContractSerializer(typeof(Model));
 Model model = (model) serializer.ReadObject(ms); 
```

序列化的工作方式还有其他选项，所以如果这不是您所拥有的，请告诉我您正在使用什么，我会提供帮助。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-04T17:25:46.473

LINQ to XML 是一项出色的功能。你总是可以依靠它。您不需要从文件中写入或读取数据。您可以将字符串或流指定到 XDocument

有很多方法可以将 XML 元素加载到 XDocument 对象。[请参阅相应的加载函数](http://msdn.microsoft.com/en-us/library/system.xml.linq.xdocument.aspx)。加载内容后，您可以轻松添加/删除元素，以后可以根据需要保存到磁盘。

# sql - 选择带有 JOIN 的字段，其中列存在于具有较少字段的不同子查询中

> ID：10014995
> 
> 赞同：2
> 
> 时间：2012-04-04T16:04:26.527
> 
> 标签：sql, sql-server, join

这个问题可能已经被问过了，但我似乎找不到我的答案，所以这里是：

我从`JOIN`两个表中选择 10 个字段。结果是大约 1186 行数据。`ClassId`在这些行中，除了一个唯一字段 ( )之外，有几行在所有意图和目的上都是重复的。我需要这个领域，但它让我无法获得以及我定义为“独特”的东西。例如，仅查询`Code`、`TeacherDescrip`和`Term`会产生 1120 条记录。

我希望运行相同的查询，但添加一个`WHERE`带有子查询的子句，该子查询搜索一组更窄的字段，准确地说是上面列出的三个字段，排除了导致我的“重复”的唯一字段。当然，我收到的错误如下：

> “当不使用 EXISTS 引入子查询时，选择列表中只能指定一个表达式。”

当我尝试使用`EXISTS`而不是`ClassScedule.Code IN`我仍然得到了完整的 1186。

这是我的查询：

```
 SELECT DISTINCT ClassId
      ,Code
      ,Section
      ,Course
      ,Students
      ,ClassStart
      ,TeacherDescrip
      ,AdTeacherID
      ,email
      ,Term
      ,Campus
  FROM ClassScedule
  JOIN staff ON staff.StaffID = ClassScedule.AdTeacherID
  WHERE ClassStart BETWEEN '2012-03-01' AND '2012-03-30'
        AND ClassScedule.Code IN 
              (SELECT DISTINCT ClassScedule.Code, TeacherDescrip, Termcode 
               FROM ClassScedule 
              WHERE ClassStart BETWEEN '2012-03-01' AND '2012-03-30')
        AND TeacherDescrip IS NOT NULL 
  ORDER BY Instructor 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-04T16:31:43.143

如果您使用的是 SQL Server 2005 或更高版本，您可以为每个不同的（代码、教师描述、术语）选择一个结果，如下所示：

```
SELECT TOP (1) WITH TIES
       ClassId
      ,Code
      ,Section
      ,Course
      ,Students
      ,ClassStart
      ,TeacherDescrip
      ,AdTeacherID
      ,email
      ,Term
      ,Campus
  FROM ClassScedule
  JOIN staff ON staff.StaffID = ClassScedule.AdTeacherID
  WHERE ClassStart BETWEEN '2012-03-01' AND '2012-03-30'
  AND TeacherDescrip IS NOT NULL 
  ORDER BY ROW_NUMBER() OVER (
    PARTITION BY Code, TeacherDescrip, Term
    ORDER BY ClassID DESC
  ) 
```

在重复的（代码、教师描述、学期）值中，此查询为您提供具有最小 ClassID 的结果。如果您想要最大，请删除 DESC。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-04T16:15:59.823

好吧，肮脏的解决方案是：

```
 SELECT max(ClassId),
      ,Code ,Section ,Course ,Students ,ClassStart ,TeacherDescrip ,AdTeacherID
      ,email ,Term ,Campus
  FROM ClassScedule
  JOIN staff ON staff.StaffID = ClassScedule.AdTeacherID
  WHERE ClassStart BETWEEN '2012-03-01' AND '2012-03-30'
    AND TeacherDescrip IS NOT NULL 
  GROUP BY Code ,Section ,Course ,Students ,ClassStart ,TeacherDescrip
   ,AdTeacherID ,email ,Term ,Campus
  ORDER BY Instructor 
```

这将为您提供“重复”值的最大 ClassId。看起来子查询实际上正在获取这些日期之间的所有类代码，但外部查询已经获取了所有这些类代码，因此没有必要。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-04T16:16:24.993

首先，您不能在子查询中返回多个列来在 WHERE 子句中进行比较

```
 ClassScedule.Code IN 
              (SELECT DISTINCT ClassScedule.Code, TeacherDescrip, Termcode 
               FROM ClassScedule 
              WHERE ClassStart BETWEEN '2012-03-01' AND '2012-03-30') 
```

无论如何都对你没有帮助，因为你已经从你的主要 WHERE 中得到了它`clause`

由于该表具有多个`ClassId`您定义为“唯一”的内容，因此不返回多行的唯一方法是`ClassId`从`SELECT`. 否则 SQL Server 无法知道`ClassId`您想要哪个。

如果您只想要一个`ClassId`，您可以在其他所有内容上使用`MIN`or`MAX` `ClassId`和 group。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-04T16:18:54.600

通过以下方式将其变成一个大组：

```
SELECT DISTINCT
      min(ClassId) ClassId
     ,Code
     ,Section
     ,Course 
     ,Students
     ,ClassStart
     ,TeacherDescrip
     ,AdTeacherID
     ,email
     ,Term
     ,Campus
FROM ClassScedule
JOIN staff ON staff.StaffID = ClassScedule.AdTeacherID
WHERE ClassStart BETWEEN '2012-03-01' AND '2012-03-30'
  AND TeacherDescrip IS NOT NULL
GROUP BY
      Code
     ,Section
     ,Course 
     ,Students
     ,ClassStart
     ,TeacherDescrip
     ,AdTeacherID
     ,email
     ,Term
     ,Campus
ORDER BY Instructor 
```

不需要子查询。这些列可能需要稍微调整一下，如果没有表别名，就不可能知道它们来自哪个表。我选择了“第一个”ClassId，但您可以使用 max() 拉出“最后一个”。

# javascript - 您如何使用 Chrome 检查 cookie？

> ID：10014996
> 
> 赞同：74
> 
> 时间：2012-04-04T16:04:28.820
> 
> 标签：javascript, debugging, google-chrome, cookies, developer-tools

我正在测试一些通过 JavaScript 创建的 cookie。有没有办法检查 cookie 是否是在 Chrome 开发者工具或类似的东西中设置的？

* * *

## 回答 #1

> 赞同：109
> 
> 时间：2012-04-04T16:34:15.487

要使用 Chrome 检查当前页面的 cookie：

**选项1**

1.  打开开发者工具（通常是 F12）
2.  单击“应用程序”选项卡（以前是“资源”）
3.  展开“Cookies”列表项
4.  单击任何列表项。

您可以在此处详细查看 cookie，并将其清除（单击 cookie 下的任何列表项，然后单击表格左下方的取消图标）。

**选项 2**

使用 javascript 控制台，例如`document.cookie`. 不太复杂（以图形方式），但您可以使用 javascript 处理数据。请注意，结果将根据允许网站从其他网站访问本地数据的方式受到限制（[请参阅 MDN 同源策略](https://developer.mozilla.org/en-US/docs/Web/Security/Same-origin_policy)）。

**选项 3**

还有`chrome://settings/siteData`（以前是设置/cookies）。只需将 url 放入 Chrome 的地址字段即可。

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2012-04-04T16:06:18.170

在您的控制台中，键入`document.cookie`. 它将返回该页面的活动 cookie。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2016-08-10T17:19:55.287

最新版本的 Chrome (v52) 已将此功能移至“应用程序”选项卡。所以更新的步骤是：

1.  打开开发者工具
2.  单击“应用程序”选项卡
3.  Cookie 列在左侧边栏的“存储”列表项下

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2015-01-03T03:01:17.813

另一种方法是键入以下内容：

```
chrome://settings/cookies 
```

在地址栏中。

然后使用左键单击查看更多详细信息（内容、到期日期等）。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2018-01-03T18:45:37.733

在最新版本的 chrome`Chrome v85`上，url 是：

**铬：//设置/站点数据**

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2017-10-05T11:03:41.090

在 chrome 版本 61 上：

**chrome://settings/content/cookies**

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-12-28T15:28:00.230

您还可以使用网络开发工具，它不仅可以帮助您查看 cookie，还可以帮助您单独显示.删除（会话、域、路径）cookie。