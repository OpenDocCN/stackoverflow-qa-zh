# StackOverflow 问答 10266000-10266999

# java - 谷歌地图 api 没有在正确的位置放置标记

> ID：10266000
> 
> 赞同：6
> 
> 时间：2012-04-22T07:20:02.903
> 
> 标签：java, android, google-maps, geolocation, overlay

我的代码应该在进入应用程序时找出用户的位置并在地图上放置一个标记。我的位置值始终等于 null，并且永远不会收到值。

```
if (location != null) {
                lat = (int) (location.getLatitude() * 1E6);
                longi = (int) (location.getLongitude() * 1E6);
                GeoPoint ourLocation = new GeoPoint(lat, longi);
                OverlayItem overlayItem = new OverlayItem(ourLocation, "AYO",
                        "Whats good yo");
                CustomPinpoint custom = new CustomPinpoint(d, CampusMap.this);
                custom.insertPinpoint(overlayItem);
                overlayList.add(custom);

            } else {
                Toast.makeText(CampusMap.this, "Couldn't get provider",
                        Toast.LENGTH_SHORT).show();

            }

        } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-30T17:06:58.720

我正在研究的 GPS RPG 遇到了一个相对类似的问题，以下是我注意到的一些事情：

首先，最初找到您的位置可能需要一段时间，这会导致该问题，因为您只检查该位置是否为空。

您可能还需要确保在执行任何操作之前实际启用了设备的定位服务：

```
private boolean doLocationsCheck(){
    if(!checkLocationEnabled()){

        final CharSequence[] items = {"Yes", "No"};

        AlertDialog.Builder builder = new AlertDialog.Builder(mContext);
        builder.setCancelable(false);
        builder.setTitle("Location must be enabled to play this game! Would you like to enable it now?");
        builder.setItems(items, new DialogInterface.OnClickListener() {
            public void onClick(DialogInterface dialog, int item) {
                final int i = item;
                runOnUiThread(new Runnable() {
                    public void run() {                         
                        if(i == 0){
                            Intent intent = new Intent(Settings.ACTION_LOCATION_SOURCE_SETTINGS);
                            startActivity(intent);
                            quit();
                        }
                        else{
                            quit();
                        }

                    }
                });
            }

        }).show();
        AlertDialog alert = builder.create();

        return false;

    }
    else {
        return true;
    }
}

private boolean checkLocationEnabled(){

    LocationManager service = (LocationManager) getSystemService(LOCATION_SERVICE);
    boolean enabled = service.isProviderEnabled(LocationManager.GPS_PROVIDER) || service.isProviderEnabled(LocationManager.NETWORK_PROVIDER);

    return enabled;
} 
```

在我确定提供程序可用后，我设置了一个连接，如下所示：

```
 private void setupLocation() {

    LocationManager locationManager = (LocationManager) this.getSystemService(Context.LOCATION_SERVICE);

    LocationListener locationListener = new LocationListener() {
        public void onLocationChanged(final Location location) {
            runOnUiThread(new Runnable() {
                public void run() {
                    mLocation = location;
                    //Log.d(TAG, "Latitude: " + location.getLatitude() + " - Longitude: " + location.getLongitude());

                    saveLocation();
                }
            });   
        }

        public void onStatusChanged(String provider, int status, Bundle extras) {}

        public void onProviderEnabled(String provider) {}

        public void onProviderDisabled(String provider) {}
    };

            //Can set to GPS or network, whichever is available
    locationManager.requestLocationUpdates(LocationManager.GPS_PROVIDER, 0, 0, locationListener);
} 
```

然后在更新时将位置设置在全局变量中，然后保存到首选项中。这样，如果启用了提供程序，但需要一段时间来检索位置，用户仍然可以继续使用应用程序存储的最后一个已知位置（不适用于程序第一次正在运行）。

我知道我在那里遗漏了很多东西，但我认为这并不是真正必要的，因为它要么是不言自明的，要么已经在之前的答案中解释过。

干杯~

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-29T11:20:25.737

```
 /*
 * getting the best location using the location manager
 * Constants.MINIMUM_TIME_BETWEEN_UPDATES = 1000 Constants.MINIMUM_TIME_BETWEEN_UPDATES     = 1
 */
LocationManager mLocation;
private String mBestProvider;
 //   in your onCreate() do the following
    mLocation = (LocationManager) getSystemService(Context.LOCATION_SERVICE);
    Criteria criteria = new Criteria();
mBestProvider = mLocation.getBestProvider(criteria, false);
Location location = mLocation.getLastKnownLocation(mBestProvider);
mLocation.requestLocationUpdates(
            LocationManager.GPS_PROVIDER, 
            Constants.MINIMUM_TIME_BETWEEN_UPDATES, 
            Constants.MINIMUM_DISTANCE_CHANGE_FOR_UPDATES,
            new LocationListenerManager()
    );

// and use the following locationListener inner class

private class LocationListenerManager implements LocationListener {

    public void onLocationChanged(Location location) {
        String message = String.format(
                "New Location \n Longitude: %1$s \n Latitude: %2$s",
                location.getLongitude(), location.getLatitude()
        );
        latitude = location.getLatitude();
        longitude = location.getLongitude();
        Toast.makeText(MapViewActivity.this, message, Toast.LENGTH_LONG).show();
        Log.v("poiint=====", ""+message);

    }

    public void onStatusChanged(String s, int i, Bundle b) {
        Toast.makeText(MapViewActivity.this, "Provider status changed",
                Toast.LENGTH_LONG).show();
    }

    public void onProviderDisabled(String s) {
        Toast.makeText(MapViewActivity.this,
                "Provider disabled by the user. GPS turned off",
                Toast.LENGTH_LONG).show();
    }

    public void onProviderEnabled(String s) {
        Toast.makeText(MapViewActivity.this,
                "Provider enabled by the user. GPS turned on",
                Toast.LENGTH_LONG).show();
    }

} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-09T12:00:46.287

您必须在 oncreate 之前在 onstartActivity 中初始化 locationlistener，以便它在 onCreate 之前获取位置值。

# .net - 当 CreateOptions 不是 DelayCreation 时 WP7 BitmapImage 内存泄漏

> ID：10266003
> 
> 赞同：1
> 
> 时间：2012-04-22T07:20:24.963
> 
> 标签：.net, windows-phone-7

当 CreateOptions 是任何东西但 DelayCreation 并且放在可视树中（在 Image 或 ImageBrush 中）时，BitmapImage 会泄漏内存

我在带有 SDK 7.1 的模拟器和电话（HTC Titan）上看到了这个步骤：

1.  打开新的 WP 项目
2.  在 App.xaml.cs 中启动一个新的调度程序计时器，每秒打印一次内存使用情况 (DeviceStatus) 并执行 GC.Collect()。（考虑更新一个字节数组，其大小计算为略小于 (MemoryUsageLimit - CurrentMemoryUsage)）
3.  在 ContentPanel 中添加一个名为 ImagePanel 的 StackPanel
4.  在 ContentPanel 中添加 2 个按钮（1 个用于使用代码创建和添加 10 个图像到 ImagePanel，1 个用于清除 ImagePanel 的子项）
5.  查找高分辨率图像（以便轻松查看内存使用情况）并将其托管在本地 IIS 上
6.  单击按钮 1 时，写入：

    ```
    Random rand = new Random();
    for(int i=0 ; i<10 ; i++)
    {
       //use 192.168.55.100 instead of localhost when running on the phone
       //to be able to see traffic in fiddler.Change localhost to machinename for the emulator
       var uri = "http://localhost/images/bigimage.jpg?tc=" + rand.Next(Int32.MaxValue);
       var bitmap = new BitmapImage 
                        {
                          UriSource = new Uri(uri, UriKind.RelativeOrAbsolute),
                          CreateOptions = BackgroundCreation //or None or DelayCreation
                        };
      ImagePanel.Children.Add(new Image { Source = bitmap });
    } 
    ```

7.  单击按钮 2 时，写入：

    ```
    ImagePanel.Children.Clear();
    GC.Collect();
    GC.WaitForPendingFinalizers();
    GC.Collect(); 
    ```

尝试使用 CreateOptions 的所有变体并观察内存的差异。继续添加和删除元素，看看您将使用哪个 CreateOption 获得 OutOfMemoryException。

有人可以验证吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-23T14:13:28.500

因为 BitmapImage 依赖于 GDI+，所以这不是预期的行为吗？（因此本质上是非托管代码？） IIRC 这不是 ImagePanel 泄漏，而是 BitmapImage 一次又一次地创建。

如果您将该值分配给同一个 BitmapImage 对象，则不会出现问题。您确实需要在绘图线程上执行此操作，否则 GDI 会很合适）就个人而言，每当我在 WP7 中处理图像时，我都会使用[ImageTools](http://imagetools.codeplex.com/releases/view/53740)而不是本机类。输出可以直接分配给图像控件，但可以异步加载，使用更少的内存并且操作要快得多

# c# - 如何在 Sharepoint2010 (C#) 中使用代码隐藏创建自定义表单以列出

> ID：10266004
> 
> 赞同：2
> 
> 时间：2012-04-22T07:20:27.070
> 
> 标签：c#, sharepoint-2010

我在 Visual Studio (C#) 中为 Sharepoint2010 创建了一个列表定义和列表实例。还创建了应用程序页面，默认情况下存储在布局文件夹中。我的目标是使该页面成为我列表的新形式。据我了解，应该在列表模式的那部分完成：

```
<Forms>
  <Form Type="DisplayForm" Url="DispForm.aspx" SetupPath="pages\form.aspx" WebPartZoneID="Main" />
  <Form Type="EditForm" Url="EditForm.aspx" SetupPath="pages\form.aspx" WebPartZoneID="Main" />
  <Form Type="NewForm" Url="NewForm.aspx" SetupPath="pages\form.aspx" WebPartZoneID="Main" />
</Forms> 
```

我试过了：

1）添加标签`<New>_layouts/PIUVS/ProjectsNew.aspx</New>`。`<forms>`=> 然后什么也没发生

2）将SetupPath更改为“_layouts/PIUVS/ProjectsNew.aspx”=>部署时出现错误：*部署步骤'激活功能'发生错误：系统找不到指定的文件。（来自 HRESULT 的异常：0x80070002）*

PS 我不使用 SP Designer 或类似的程序。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-23T07:05:39.260

找到了解决方案。

这不应该完全在模式文件中完成。

要将自定义表单添加到 Sharepoint2010 中的列表，您应该修改内容类型。在`<ContentType>`标签中添加以下内容：

```
<XmlDocuments>
  <XmlDocument NamespaceURI="http://schemas.microsoft.com/sharepoint/v3/contenttype/forms/url">
    <FormsUrls xmlns="http://schemas.microsoft.com/sharepoint/v3/contenttype/forms/url">
      <New>_layouts/PIUVS/ProjectsNew.aspx</New>
    </FormsUrls>
  </XmlDocument>
</XmlDocuments> 
```

还要将其复制到列表架构中的 ContentType 引用中。

# ruby-on-rails - 在多部分 simple_form 中更新回形针头像

> ID：10266005
> 
> 赞同：13
> 
> 时间：2012-04-22T07:20:39.143
> 
> 标签：ruby-on-rails

我想为以下表单创建一个编辑页面。问题是，当用户浏览到编辑页面时，brand_name 和 name 已预先填写，但即使存在“样式”的头像，图像上传字段也会显示“未选择文件”。请让我知道是否有某种方法可以解决此问题。谢谢！

我的编辑表格：

```
<%= simple_form_for @style, :html => { :class => 'form-horizontal' }, :remote => true do |m| %>

    <%= m.input :brand_name, :label => 'Brand', :placeholder => 'Brand' %>    
    <%= m.input :name, :label => 'Style', :placeholder => 'Style' %>
    <%= m.input :avatar, :label => "Image" %>

    <div class="form-actions" style = "background:none">
      <%= m.submit nil, :class => 'btn btn-primary' %>
      <%= link_to 'Cancel', styles_path, :class => 'btn' %>
    </div>

<% end %> 
```

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-05-25T02:16:41.653

昨天刚刚实施。在 /app/inputs 中进行自定义输入

```
class AvatarInput < SimpleForm::Inputs::FileInput
def input
out = '' # the output string we're going to build
# check if there's an uploaded file (eg: edit mode or form not saved)
if object.send("#{attribute_name}?")
  # append preview image to output
  # <%= image_tag @user.avatar.url(:thumb), :class => 'thumbnail', id: 'avatar' %>
  out << template.image_tag(object.send(attribute_name).url(:thumb), :class => 'thumbnail', id: 'avatar')
  end
# append file input. it will work accordingly with your simple_form wrappers
    (out << @builder.file_field(attribute_name, input_html_options)).html_safe
  end
end 
```

然后你可以做

```
<%= f.input :avatar, :as => :avatar %> 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-06-05T00:25:58.350

这就是我工作所需要的（在haml中）：

```
=simple_form_for @user, :html => {:multipart => true } do |f|
  =f.file_field :image 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-25T02:12:04.667

[来自回形针的 github 页面](https://github.com/thoughtbot/paperclip)的新/编辑视图的代码如下所示：

```
<%= form_for :user, @user, :url => user_path, :html => { :multipart => true } do |form| %>
  <%= form.file_field :avatar %>
<% end %> 
```

所以也许你也应该尝试`m.file_field`包括在内`:html => { :multipart => true }`？虽然我个人更喜欢[Attachment-Fu](https://github.com/technoweenie/attachment_fu)。

# slimdx - SlimDX 处理窗口大小调整

> ID：10266008
> 
> 赞同：1
> 
> 时间：2012-04-22T07:21:30.317
> 
> 标签：slimdx

我正在尝试处理正在调整大小的程序窗口，而我在下面拼凑的（我认为效率低下的）代码似乎可以解决问题。

有没有更好的方法来做到这一点，最好是在调整窗口大小时不会产生卡顿并且不会持续使用 12-17% 的 CPU 的方法？我还怀疑`MessagePump.Run`可能会在再次完成设备设置之前以某种方式运行`form.Resize`，并引发错误。

谢谢！

```
using System;
using System.Drawing;
using System.Windows.Forms;

using SlimDX;
using SlimDX.Direct3D9;
using SlimDX.Windows;

namespace SlimDX_1
{
    struct Vertex
    {
        public Vector4 Position;
        public int Color;
    }

    static class Program
    {
        private static VertexBuffer vertices;
        private static Device device;
        private static RenderForm form;
        private static PresentParameters present;
        private static VertexDeclaration vertexDecl;
        private static VertexElement[] vertexElems;

        private static bool wasMinimized = false;

        /// <summary>
        /// The main entry point for the application.
        /// </summary>
        [STAThread]
        static void Main()
        {
            form = new RenderForm("Tutorial 1: Basic Window");

            init();

            form.Resize += (o, e) =>
                {
                    if (form.WindowState == FormWindowState.Minimized)
                    {
                        foreach (var item in ObjectTable.Objects)
                        {
                            item.Dispose();
                        }
                        wasMinimized = true;
                    }
                    else
                    {
                        foreach (var item in ObjectTable.Objects)
                        {
                            item.Dispose();
                        }
                        init();

                        device.SetRenderState(RenderState.FillMode, FillMode.Wireframe);
                        device.SetRenderState(RenderState.CullMode, Cull.None);

                        present.BackBufferHeight = form.ClientSize.Height;
                        present.BackBufferWidth = form.ClientSize.Width;

                        device.Reset(present);
                    }
                };

            MessagePump.Run(form, () =>
            {
                if (form.WindowState == FormWindowState.Minimized)
                {
                    return;
                }

                device.Clear(ClearFlags.Target | ClearFlags.ZBuffer, Color.Black, 1.0f, 0);
                device.BeginScene();

                device.SetStreamSource(0, vertices, 0, 20); // 20 is the size of each vertex
                device.VertexDeclaration = vertexDecl;
                device.DrawPrimitives(PrimitiveType.TriangleList, 0, 1);

                device.EndScene();
                device.Present();
            });

            foreach (var item in ObjectTable.Objects)
            {
                item.Dispose();
            }
        }

        private static void init()
        {
            present = new PresentParameters();
            //present.EnableAutoDepthStencil = false;
            //present.BackBufferCount = 1;
            //present.SwapEffect = SwapEffect.Discard;
            present.Windowed = true;
            present.BackBufferHeight = form.ClientSize.Height;
            present.BackBufferWidth = form.ClientSize.Width;
            //present.BackBufferFormat = Format.Unknown;

            device = new Device(new Direct3D(), 0, DeviceType.Hardware, form.Handle, CreateFlags.HardwareVertexProcessing, present);

            vertices = new VertexBuffer(device, 3 * 20, Usage.WriteOnly, VertexFormat.None, Pool.Managed);
            vertices.Lock(0, 0, LockFlags.None).WriteRange(new Vertex[]
            {
                new Vertex() { Color = Color.Red.ToArgb(), Position = new Vector4(400.0f, 100.0f, 0.5f, 1.0f) },
                new Vertex() { Color = Color.Blue.ToArgb(), Position = new Vector4(650.0f, 500.0f, 0.5f, 1.0f) },
                new Vertex() { Color = Color.Green.ToArgb(), Position = new Vector4(150.0f, 500.0f, 0.5f, 1.0f) }
            });
            vertices.Unlock();

            // specifies the layout of the vertexes
            vertexElems = new VertexElement[]
            {
                new VertexElement(0, 0, DeclarationType.Float4, DeclarationMethod.Default, DeclarationUsage.PositionTransformed, 0),
                new VertexElement(0, 16, DeclarationType.Color, DeclarationMethod.Default, DeclarationUsage.Color, 0),
                VertexElement.VertexDeclarationEnd
            };

            vertexDecl = new VertexDeclaration(device, vertexElems);
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T05:24:31.370

调整窗口大小时，您将远远超出您需要做的事情。您正在释放您创建的每个 DirectX 对象，包括图形设备，然后重新创建所有内容。这将需要相对较长的时间，这就是您看到性能问题的原因。

事实上，您的任何对象都不需要被释放。只需调用设备上的 Reset() 函数即可重新创建后缓冲区以匹配新的窗口大小。查看有关窗口大小调整的一些本机 Direct3D9 教程，以了解该过程的一般工作方式。

# c# - Spring.Net 中包含通用字典的通用字典

> ID：10266009
> 
> 赞同：4
> 
> 时间：2012-04-22T07:21:37.987
> 
> 标签：c#, spring, dictionary, spring.net

我有一个包含属性的对象：

```
public Dictionary<string, Dictionary<string, List<ContextMenuItemModel>>> ContextMenuModel { get; set; } 
```

如何使用 Spring.Net 配置此属性？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-22T08:37:12.087

好吧，在 xml 中配置它并不漂亮，考虑切换到 Spring.Net 代码配置以[在 C# 中配置你的 spring 上下文](http://www.springframework.net/codeconfig/refdoc/migration-example.html#d4e73)。

无论如何，要在 xml 中执行此操作，您需要使用通用 .net 集合的构造函数。例如，`List<T>`采用`IList<T>`构造函数，因此您可以配置字符串列表，如下所示：

```
<object id="list1" type="System.Collections.Generic.List&lt;string>">
  <constructor-arg>
    <list element-type="string">
      <value>abc</value> 
      <value>def</value> 
    </list>
  </constructor-arg>
</object> 
```

请注意，在 xml 中您必须使用`&lt;`，因为 using`<`不是合法的 xml。[Spring.net 文档](http://www.springframework.net/doc-latest/reference/html/objects.html#objects-generic-collections-values)中讨论了设置通用集合值。

可以以类似的方式配置泛型`Dictionary<string, System.Collections.Generic.List<string>>`，这也在[此答案](https://stackoverflow.com/a/5147812/322283)中进行了讨论：

```
<object id="dic1" type="System.Collections.Generic.Dictionary&lt;string, System.Collections.Generic.List&lt;string>>">
  <constructor-arg>
    <dictionary key-type="string" value-type="System.Collections.Generic.List&lt;string>">
      <entry key="keyToList1" value-ref="list1" />
      <entry key="keyToList2" value-ref="list2" /> 
    </dictionary>
  </constructor-arg>
</object> 
```

你可能会看到下一个即将到来：

```
<object id="dic0" type="System.Collections.Generic.Dictionary&lt;string, System.Collections.Generic.Dictionary&lt;string, System.Collections.Generic.List&lt;string>>>">
  <constructor-arg>
    <dictionary key-type="string" value-type="System.Collections.Generic.Dictionary&lt;string, System.Collections.Generic.List&lt;string>>">
      <entry key="keyToDic1 " value-ref="dic1" />
    </dictionary>
  </constructor-arg>  
</object> 
```

可以注入的：

```
<object id="MyObject" type="MyNamespace.MyClass, MyAssembly">
  <property name="ContextMenuModel" ref="dic0" />
</object> 
```

这不是很漂亮，但是您可以[使用 type aliases 稍微提高 xml 的可读性](http://www.springframework.net/doc-latest/reference/html/objects.html#objects-creation-generic-types)。

# android - android JSONArray 长度

> ID：10266010
> 
> 赞同：4
> 
> 时间：2012-04-22T07:21:39.253
> 
> 标签：android, arrays, logging

我有一个来自 json 提要的数组，我知道在 jArray 中有一个联赛，但我需要计算出该数组的计数，以防日后将第二个添加到提要中。目前 log cat 没有注销“teamFeedStructure”有没有人知道我做错了什么或者知道如何正确地将数组的长度转换为我可以在意图中使用的字符串？

这是代码

```
JSONObject obj = new JSONObject(json);
JSONObject objData = obj.getJSONObject("data");                      
JSONArray jArray = objData.getJSONArray("structure");
//String leagues = jArray.toString();
//Log.v("myapp", "structure" + leagues);
for (int i=0; i < jArray.length(); i++) {    
     JSONObject oneObject = jArray.getJSONObject(i);
     leaguecountArray = oneObject.getJSONArray("league_id");
     for (int l=0; l < leaguecountArray.length(); l++) {     
         if (leaguecountArray.length() == 1) {
             teamFeedStructure = "One";
         }
         if (leaguecountArray.length() == 2) {
              teamFeedStructure = "Two";
         }
         Log.v("myapp", teamFeedStructure);  
      }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-22T07:30:11.027

为什么需要在这里迭代：

```
for (int l=0; l < leaguecountArray.length(); l++)
{    
    if (leaguecountArray.length() == 1){

         teamFeedStructure = "One";
    }
    if (leaguecountArray.length() == 2){

        teamFeedStructure = "Two";
    }
    Log.v("myapp", teamFeedStructure);   
 } 
```

不管你做了多少次传球，结果仍然是一样的。

您也可以不使用英文单词，而是`String`持有您需要的数字。这样做：

```
teamFeedStructure = String.valueOf(leaguecountArray.length()); 
```

然后该值将变为`"2"`例如。在您的其他活动中，您可以再次将其解析为整数：`int number = Integer.parseInt(teamFeedStructure);`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-22T07:32:08.493

添加以下行

```
 teamFeedStructure = "greater two"; 
```

前

```
 if (leaguecountArray.length() == 1){ 
```

如果您收到**大于两个**的消息，则意味着您的数组长度超过两个。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-23T08:24:09.950

感谢大家的帮助，我发现我在提要中走得太远了，这就是为什么我在 Logcat 中没有得到任何东西的原因。现在它计算得很好。

# c# - 如何重构测试应用程序？

> ID：10266012
> 
> 赞同：4
> 
> 时间：2012-04-22T07:21:44.133
> 
> 标签：c#, testing, refactoring

我有一个测试应用程序，它有一个类 TestSeq 和一个方法 Go()，它由以下块组成：

```
 _writer.WriteLine("Doing foo action...");
            var stopwatch = Stopwatch.StartNew();
            // foo - some work here
            stopwatch.Stop();
            _writer.WriteDone("Results of foo action.", stopwatch.Elapsed); 
```

在“一些工作”中，我对 WCF 客户端（CRUD 操作、过滤器等）有不同的调用。

因此，大量代码重复，显然应该在这里进行一些重构。我考虑创建一个类TestAction，但我不知道将“一些工作”部分放入其中的最佳方式是什么。

在我看来，这是一个非常简单的问题，但我只是不知道我应该搜索什么关键字。因此，我很高兴看到仅包含关键字（模式名称或其他内容）或链接的答案。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-22T07:28:32.807

我敢肯定还有更多，但在我脑海中，你可能可以通过两种方式来编写这个样板代码。

**方法一**：使用 using 语法包装感兴趣的代码

```
class MeasuredOperation : IDisposable
{
    Stopwatch stopwatch;
    string message;

    public MeasuredOperation(string message)
    {
        Console.WriteLine("Started {0}", message);
        stopwatch = Stopwatch.StartNew();
        this.message = message;
    }

    public void Dispose()
    {
        stopwatch.Stop();
        Console.WriteLine("Results of {0} Elapsed {1}", this.message, this.stopwatch.Elapsed);
    }
}

    static void Main(string[] args)
    {
        using (new MeasuredOperation("foo action"))
        {
            // Do your action
        }
    } 
```

**方法 2**：创建一个新函数并作为委托传入您的代码块

```
static void MeasuredAction(string message, Action action)
{
    Console.WriteLine("Started {0}", message);
    var stopwatch = Stopwatch.StartNew();
    action();
    stopwatch.Stop();
    Console.WriteLine("Results of {0} Elapsed {1}", message, stopwatch.Elapsed);
}

static void Main(string[] args)
{
    MeasureAction(delegate()
    {
        // do work
    });
} 
```

# javascript - 在 iPhone Safari 上捕捉新标签事件

> ID：10266018
> 
> 赞同：0
> 
> 时间：2012-04-22T07:22:43.543
> 
> 标签：javascript, iphone, ios, ios5, safari

有没有办法在 iPhone 上捕捉新标签事件？

我有以下问题：

当我尝试通过单击 iPhone 上的选项卡图标移动到另一个选项卡时，由于某种原因显示为单击触发的覆盖。我希望捕获该事件并使 div 不可见，以便在选项卡之间移动时它不会在小页面显示中看起来打开。

任何想法？

谢谢。

# xml - 使用 xslt 删除基于 xml 中多个属性的重复节点

> ID：10266019
> 
> 赞同：3
> 
> 时间：2012-04-22T07:22:48.127
> 
> 标签：xml, xslt

我有这个需要用 xslt 转换的输入 XML

```
<root>
    <node id="a">
        <section id="a_1" method="run">
            <item id="0">
                <attribute>
                    <color>Red</color>
                </attribute>
            </item>
        </section>
        <section id="a_2">
            <item id="0">
                <attribute>
                    <color>Red</color>
                </attribute>
            </item>
        </section>
        <section id="a_1" method="run">
            <item id="0">
                <attribute>
                    <color>Red</color>
                </attribute>
            </item>
        </section>
    </node>
    <node id="b">
        <section id="b_1" method="create">
            <user id="b_1a">
                <attribute>
                    <name>John</name>
                </attribute>
            </user>
            <user id="b_1b">
                <attribute>a</attribute>
            </user>
        </section>
        <section id="b_1" method="create">
            <user id="b_1c">
                <attribute>a</attribute>
            </user>
        </section>
        <section id="b_2">
            <user id="b_1a">
                <attribute>
                    <name>John</name>
                </attribute>
            </user>
        </section>
    </node>
</root> 
```

预期输出：

```
<root>
    <node id="a">
        <section id="a_1">
            <item id="0">
                <attribute>
                    <color>Red</color>
                </attribute>
            </item>
        </section>
        <section id="a_2">
            <item id="0">
                <attribute>
                    <color>Red</color>
                </attribute>
            </item>
        </section>
    </node>
    <node id="b">
        <section id="b_1" method="create">
            <user id="b_1a">
                <attribute>
                    <name>John</name>
                </attribute>
            </user>
            <user id="b_1b">
                <attribute>a</attribute>
            </user>
        </section>

        <section id="b_2">
            <user id="b_1a">
                <attribute>
                    <name>John</name>
                </attribute>
            </user>
        </section>
    </node>
</root> 
```

淘汰哪个节点无关紧要，只要元素名称、id和方法相同，其中一个就会被淘汰。知道 xsl 是什么样子的吗？

注意：元素名称可以是任何东西，不必是，并且在整个文件中有多个元素名称；只要它具有相同的元素名称、id 和属性（例如 method=create），其中之一就会被淘汰。

非常感谢。干杯，约翰

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-22T14:32:41.090

**I. 这是一个简短而有效的（使用键）XSLT 1.0 转换：**

```
<xsl:stylesheet version="1.0"
 xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
 <xsl:output omit-xml-declaration="yes" indent="yes"/>
 <xsl:strip-space elements="*"/>

 <xsl:key name="kElemWithAttribs" match="*[@id and @method]"
  use="concat(name(), '+', @id, '+', @method)"/>

 <xsl:template match="node()|@*">
     <xsl:copy>
       <xsl:apply-templates select="node()|@*"/>
     </xsl:copy>
 </xsl:template>

 <xsl:template match=
  "*[@id and @method
    and
     not(generate-id()
        =
         generate-id(key('kElemWithAttribs',
                         concat(name(), '+', @id, '+', @method)
                         )[1]
                    )
         )
     ]"/>
</xsl:stylesheet> 
```

**当此转换应用于提供的 XML 文档时：**

```
<root>
    <node id="a">
        <section id="a_1" method="run">
            <item id="0">
                <attribute>
                    <color>Red</color>
                </attribute>
            </item>
        </section>
        <section id="a_2">
            <item id="0">
                <attribute>
                    <color>Red</color>
                </attribute>
            </item>
        </section>
        <section id="a_1" method="run">
            <item id="0">
                <attribute>
                    <color>Red</color>
                </attribute>
            </item>
        </section>
    </node>
    <node id="b">
        <section id="b_1" method="create">
            <user id="b_1a">
                <attribute>
                    <name>John</name>
                </attribute>
            </user>
            <user id="b_1b">
                <attribute>a</attribute>
            </user>
        </section>
        <section id="b_1" method="create">
            <user id="b_1c">
                <attribute>a</attribute>
            </user>
        </section>
        <section id="b_2">
            <user id="b_1a">
                <attribute>
                    <name>John</name>
                </attribute>
            </user>
        </section>
    </node>
</root> 
```

**产生了想要的正确结果：**

```
<root>
   <node id="a">
      <section id="a_1" method="run">
         <item id="0">
            <attribute>
               <color>Red</color>
            </attribute>
         </item>
      </section>
      <section id="a_2">
         <item id="0">
            <attribute>
               <color>Red</color>
            </attribute>
         </item>
      </section>
   </node>
   <node id="b">
      <section id="b_1" method="create">
         <user id="b_1a">
            <attribute>
               <name>John</name>
            </attribute>
         </user>
         <user id="b_1b">
            <attribute>a</attribute>
         </user>
      </section>
      <section id="b_2">
         <user id="b_1a">
            <attribute>
               <name>John</name>
            </attribute>
         </user>
      </section>
   </node>
</root> 
```

**说明**：

使用**[Muenchian 方法](http://www.jenitennison.com/xslt/grouping/muenchian.html)**使用复合键进行分组。在这里，我们忽略（删除）不是组中第一个的每个节点。

* * *

**二、XSLT 2.0 解决方案——甚至更短且效率不低**：

```
<xsl:stylesheet version="2.0"
    xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
    <xsl:output omit-xml-declaration="yes" indent="yes"/>

 <xsl:template match="node()|@*">
     <xsl:copy>
       <xsl:apply-templates select="node()|@*"/>
     </xsl:copy>
 </xsl:template>

 <xsl:template match="node">
  <xsl:copy>
    <xsl:apply-templates select="@*"/>

    <xsl:for-each-group select="*"
         group-by="concat(name(), '+', @id, '+', @method)">
      <xsl:apply-templates select="."/>
    </xsl:for-each-group>
  </xsl:copy>
 </xsl:template>
</xsl:stylesheet> 
```

**说明**：

正确使用**[`xsl:for-each-group`](http://www.w3.org/TR/xslt20/#xsl-for-each-group)**with`group-by`属性。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-22T08:37:59.713

**XSL 文件：**

```
<?xml version='1.0'?>
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">

<xsl:template match="/">
    <xsl:apply-templates/>
</xsl:template>

<xsl:template match="root">
    <root>
        <xsl:apply-templates/>
    </root>
</xsl:template>

<xsl:template match="node">
    <node>
        <xsl:copy-of select="@*"/>
        <xsl:apply-templates/>
    </node>
</xsl:template>

<xsl:template match="section[@id = 'b_1'][1]">  
    <section>
        <xsl:copy-of select="node()|@*"/>
    </section>  
</xsl:template>

<xsl:template match="section[@id != 'b_1']">
    <section>       
        <xsl:copy-of select="node()|@*"/>
    </section>
</xsl:template>

<xsl:template match="section[@id = 'b_1'][position() &gt; 1]"/> 

</xsl:stylesheet> 
```

**转变：**

```
<root>
        <node id="a">
            <section id="a_1">
                <item id="0">
                    <attribute>
                        <color>Red</color>
                    </attribute>
                </item>
            </section>
            <section id="a_2">
                <item id="0">
                    <attribute>
                        <color>Red</color>
                    </attribute>
                </item>
            </section>
        </node>
        <node id="b">
            <section id="b_1" method="create">
                <user id="b_1a">
                    <attribute>
                        <name>John</name>
                    </attribute>
                </user>
                <user id="b_1b">
                    <attribute>a</attribute>
                </user>
            </section>
            <section id="b_2">
                <user id="b_1a">
                    <attribute>
                        <name>John</name>
                    </attribute>
                </user>
            </section>
        </node>
    </root> 
```

* * *

希望这可以帮助。

[编辑] **在同一个输入文件上试试这个 XSL：**

```
<?xml version='1.0'?>
<xsl:stylesheet version="1.0"
 xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
 <xsl:output omit-xml-declaration="yes" indent="yes"/>

    <xsl:template match="/">
        <xsl:apply-templates/>
    </xsl:template>

    <xsl:template match="*[not(@id eq preceding::*[local-name() eq local-name(.)]/@id)]">
        <xsl:element name="{name()}">
            <xsl:copy-of select="node()|@*"/>
        </xsl:element>
    </xsl:template>

</xsl:stylesheet> 
```

**结果：**

```
<root>
  <node id="a">
    <section id="a_1">
      <item id="0">
        <attribute>
          <color>Red</color>
        </attribute>
      </item>
    </section>
    <section id="a_2">
      <item id="0">
        <attribute>
          <color>Red</color>
        </attribute>
      </item>
    </section>
  </node>
  <node id="b">
    <section id="b_1" method="create">
      <user id="b_1a">
        <attribute>
          <name>John</name>
        </attribute>
      </user>
      <user id="b_1b">
        <attribute>a</attribute>
      </user>
    </section>
    <section id="b_1" method="create">
      <user id="b_1c">
        <attribute>a</attribute>
      </user>
    </section>
    <section id="b_2">
      <user id="b_1a">
        <attribute>
          <name>John</name>
        </attribute>
      </user>
    </section>
  </node>
</root> 
```

[/编辑]

# java - 如何在列表中获取已安装的应用程序名称

> ID：10266022
> 
> 赞同：1
> 
> 时间：2012-04-22T07:22:57.240
> 
> 标签：java, android

我试过这个：

```
final Intent mainIntent = new Intent(Intent.ACTION_MAIN, null);
mainIntent.addCategory(Intent.CATEGORY_LAUNCHER);
final List pkgAppsList = context.getPackageManager().queryIntentActivities( mainIntent, 0); 
```

此代码为我提供了已安装应用程序包名称等的列表。但我只想要应用程序名称作为字符串类型列表。我该怎么办？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-22T07:25:48.970

您可以使用以下代码 ::: 请参阅此[链接](http://smartandroidians.blogspot.in/2010/07/getting-list-of-installed-application.html)

```
public class AppList extends Activity {
  ....
  private ArrayList results = new ArrayList();
  @Override
  public void onCreate(Bundle savedInstanceState) {
    .....
    PackageManager pm = this.getPackageManager();
    Intent intent = new Intent(Intent.ACTION_MAIN, null);
    intent.addCategory(Intent.CATEGORY_LAUNCHER);
    List list = pm.queryIntentActivities(intent, PackageManager.PERMISSION_GRANTED);
    for (ResolveInfo rInfo : list) {
       results.add(rInfo.activityInfo.applicationInfo.loadLabel(pm).toString());
       Log.w("Installed Applications", rInfo.activityInfo.applicationInfo.loadLabel(pm).toString());
  } 
 }
} 
```

在上面的代码中“结果”是安装的数组列表应用程序

# sql - 在 SQL 中选择日期之间的最小差异

> ID：10266029
> 
> 赞同：1
> 
> 时间：2012-04-22T07:25:45.510
> 
> 标签：sql, sql-server, tsql

如何使用 tSQL 获取两个日期列之间的差异并返回这两个日期之间的前 5 个最小差异？如果可能的话，我希望把它精确到分钟。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-22T07:28:02.063

```
 SELECT TOP 5 date1, date2, DATEDIFF(minute, date1, date2)
 FROM yourtable
 ORDER BY DATEDIFF(minute, date1, date2) 
```

# php - PHP中的“GLOBAL”和“STATIC”变量有什么区别？

> ID：10266038
> 
> 赞同：8
> 
> 时间：2012-04-22T07:26:53.453
> 
> 标签：php

PHP 中的 GLOBAL 和 STATIC 变量到底有什么区别？当我们想在多个函数中使用一个变量时，哪个更可取？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-22T07:31:08.377

静态变量只是意味着 var 属于一个类，但可以引用而不必实例化所述类。全局变量存在于全局命名空间中，并且可以被任何类中的任何函数引用。全局变量总是不受欢迎，因为它们很容易被滥用、覆盖、意外引用等。至少对于静态变量，您需要通过`Class::var;`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-22T07:37:51.857

Global 用于获取可能在其他脚本中定义或不在同一范围内的全局变量。

例如

```
<?php

$g_var = 1;

function test() {
   var_dump($GLOBAL['g_var']);

   global $g_var;
   var_dump($g_var);
} 
```

static 用于定义一个具有整个脚本生命周期的 var，并且只初始化一次。

例如

```
<?php

function test() {
    static $cnt = 0;
    $cnt ++;
    echo $cnt;
} 

$i = 10;

while (-- $i) {
    test();
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2019-08-09T02:48:12.257

全局变量是在作用域中定义的变量，可以跨越包含和必需的作用域。（*简单来说，范围是指 php 文件/函数/类*）

以下是全局变量如何工作的一些示例。

**示例 1：**在作用域中声明并在函数中使用`global`关键字的变量

```
<?php
$a = 1;

function add_a() {
    global $a;
    $a++;
}

add_a();

echo $a; 
```

在上面的示例中，我们声明了变量`$a`并在范围内为其赋值`1`。然后我们在同一范围内声明一个函数`add_a`并尝试增加`$a`变量值。该`add_a`函数被调用，然后我们期望显示结果`echo`的变量。`$a``2`

**示例 2：**在作用域中声明并在使用该变量的函数中使用的`$GLOBALS`变量

```
<?php
$a = 1;

function add_a() {
    $GLOBALS['a']++;
}

add_a();

echo $a; 
```

上面示例 2 的结果与示例 1 的结果完全相同。

> `global`使用关键字和 PHP 定义的特殊`$GLOBALS`数组变量没有区别。但是，它们都有其优点和缺点。
> 
> `$GLOBALS`在 PHP 官方网站[$GLOBALS](https://www.php.net/manual/en/reserved.variables.globals.php)上阅读更多信息

如果要将范围声明的变量跨越到包含或必需的范围，请参见下面的示例。

**示例 3：** 文件`a.php`

```
<?php
global $a;
$a = 1;

require 'b.php';

add_a();

echo $a; 
```

文件`b.php`

```
<?php
function add_a() {
    global $a;
    $a++;
} 
```

在上面的示例中，我们有文件`a.php`和`b.php`. 文件`b.php`中需要文件`a.php`，因为我们使用文件中声明的函数`b.php`。要使用`$a`文件中的变量，`b.php`我们必须首先声明`$a`为全局以在本地范围之外使用，我们首先调用来做到这一点`global $a`，然后我们定义一个像这样的值`$a = 1`。变量 $a 现在可以在任何包含的范围内的任何地方使用，方法是`global $a`在操作之前先调用。

**静态变量** 通常存在于类中，但在一些开发良好的 PHP 项目中，您可以在递归函数中找到它们。静态变量是一个可以记住其值并且可以在每次调用函数或方法时重用的变量。

以下是使用中的静态变量的一些示例。

**示例 1：**函数中的静态变量

```
function add() {
    static $a = 1;
    $a++;

    echo $a;
}

add(); //2
add(); //3
add(); //4 
```

**示例 2：**类中的静态变量

```
class A {
    public static $a = 1;

    public static function add() {
        self::$a++;
        echo self::$a;
    }
}

echo A::$a; //1
A::add(); //2

echo A::$a; //2
A::add(); //3

echo A::$a; //3
A::add(); //4 
```

> 请注意，您不能将函数的返回值分配给静态变量。例如你不能做`static $a = rand()`. 请参阅下面的示例 3，了解如何将返回值分配给静态变量。

**示例 3：**将返回变量从函数分配给静态变量

```
function add() {
    static $a;
    $a = rand();

    echo $a;
} 
```

> 在 PHP 官方网站上阅读更多关于全局和静态变量的信息[变量范围](https://www.php.net/manual/en/language.variables.scope.php)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-08-09T00:08:00.823

全局变量是在创建函数之前创建的，但是在函数中添加了global关键字

```
$g_var = 1;

function test() {
  var_dump($GLOBAL['g_var']);
  global $g_var;
  var_dump($g_var);
} 
```

static 在函数中创建并声明为静态

```
function test() {
  static $cnt = 0;
  $cnt ++;
  echo $cnt;
}

$i = 10;

while(--$i) test(); 
```

# jquery - 无法在 div 内动态创建多个 div

> ID：10266039
> 
> 赞同：0
> 
> 时间：2012-04-22T07:27:01.387
> 
> 标签：jquery, html, dom-manipulation

```
$.post("../../Handler/Topic.ashx", 
       { commentclob: commentClob, 
         commenttitle: commentTitle,
         topicId: id, 
         Button: buttoname },
       function (data) {
         obj = jQuery.parseJSON(data);
         var $table = $('<table/>').addClass('commentbox');

         $table.append('<tr><td>' + 
                       'Comment Id:' + 
                       obj.CommentId + 
                       '</td></tr>');

        var includeReply = "<input type='button' 
                                   class='btnReply' 
                                   value='Reply' 
                                   id='btnReply-" + obj.CommentId + "' />";

        $("#commentContainer").prepend(
          $('<div/>').attr('id', '#comment-' + obj.CommentId)
                     .append($table)
        );

        //This doesnt work         
        $("#comment-" + obj.CommentId).append(
          $('<div/>').attr('id', '#container-' + obj.CommentId)      
                     .append(includeReply)
        );
}); 
```

html

```
 <div id="commentContainer"></div> 
```

我能够成功地将带有#comment-id 的div 附加到comment-container，但我无法在#comment-id 中附加另一个div。

我试过了

```
 var str = $("<div>").attr("id", "#container-" + obj.CommentId)
               $(str).append(includeReply);
               $table.append('<tr><td>' + 'CommentDiv:' + str + '</td></tr>'); 
```

但它给

CommentDiv：[对象对象]

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-22T08:57:42.090

`str`是一个 HTML 对象，所以它可以像这样连接。您必须提取标记，`.html()`然后将其连接起来。

```
 var str = $("<div>").attr("id", "#container-" + obj.CommentId)
   $(str).append(includeReply);
   $table.append('<tr><td>' + 'CommentDiv:' + str.html() + '</td></tr>'); 
```

# java - 访问 xml 文件并在 Java 中更新它

> ID：10266044
> 
> 赞同：0
> 
> 时间：2012-04-22T07:27:47.853
> 
> 标签：java, xml, parsing

是否可以编写一个小`Java`程序来解析来自我的虚拟主机站点的 xml 文件并更新该文件？或者有更好的选择吗？我必须每 10 分钟更新一次文件，每行大约 10 行代码，所以我不想每次都写出来。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-22T07:35:01.460

你可以写一点java程序。顺便说一句，你可以写一个更大的一二:)。您可以使用任何您想要的语言编写程序。包括Java。用任何语言编写的程序都可以解析 XML。

好吧，现在我们解决了问题。当您说您希望从网站解析 XML 时，您的意思是什么？您的网站是否提供允许下载 XML 的 URL？在这种情况下，您可以下载它（例如使用 HTTP GET 方法）并解析。

下一个问题是如何更新站点*上的 XML。*您必须在站点本身上提供此类功能（例如，实现能够接收 XML 并存储它的服务。例如通过 HTTP GET。

完成后，您可以编写真正的小型 Java 程序，该程序使用 HTTP GET 下载文件、解析它、创建新文件并使用 HTTP POST 将其发送回站点。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-22T07:31:08.937

我会调查在您的服务器上运行此代码。更新是什么？它是否使用不在您服务器上的数据？您可以在 Java 中轻松完成此操作，但需要更多细节才能获得更好的答案。

好的，如果您的虚拟主机允许您执行 http PUT，您的想法很好，您可以使用 GET 获取文件，修改它，例如使用 DOM，然后将它放回去。你可能更喜欢做更多的服务器端脚本并在最后编写更新，例如，它允许你使用关系数据库而不是平面文件。在这种情况下，编写一个服务器端脚本来接受 POST 作为建议的另一个答案是一个好主意。

我在这里为您举了一个小例子：http: [//jcable.users.sourceforge.net/scores.php](http://jcable.users.sourceforge.net/scores.php)

这个网站上有三个文件：

分数 - 一个被更新的文本文件。score.php - 显示当前分数的脚本 add.php - 更新当前分数的脚本。

score.php 看起来像这样：

```
<html>
 <body>
  The current score is <?php readfile("scores"); ?>
 </body>
</html> 
```

add.php 看起来像这样：

```
<?php
if(isset($_POST["score"])) {
  $fh = fopen("scores", 'w') or die("can't open file");
  fwrite($fh, $_POST["score"]);
  fclose($fh);
}
else
{
?>
<HTML>
<BODY>
<FORM action="add.php" method="POST">
New Score: <INPUT type="text" name="score"/>
</FORM>
</BODY>
</HTML>
<?php 
```

} ?>

如果您获得 add.php，它将向您显示表单。但是，如果您的程序将其称为帖子，则不会打扰。希望这能给你一些想法——它是我能想到的最简单的 Web 应用程序，它具有持久的服务器端数据。您可以添加复杂性 - xml 或 json 等，但原则是存在的。

# maven - javax.validation 的 Spring MVC 问题

> ID：10266047
> 
> 赞同：2
> 
> 时间：2012-04-22T07:28:12.450
> 
> 标签：maven, spring-mvc, neo4j, spring-data

我想创建一个将 Neo4j 与 Spring Data 结合使用的 Web 应用程序。我正在使用 Maven 来处理依赖项和构建，但由于`spring-data-neo4j`.

当我包含 spring-data-neo4j 时，它包含`javax.validation`，但是当包含它时，我在使用`<mvc:annotation-driven />`@Controller 和 @RequestMapping 注释时遇到问题，这会导致此问题：

```
org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'org.springframework.validation.beanvalidation.LocalValidatorFactoryBean#0': Invocation of init method failed; nested exception is javax.validation.ValidationException: Unable to find a default provider 
```

如果我从 中排除`javax.validation`作为依赖项，则`spring-data-neo4j`在尝试访问时会收到验证器错误`Neo4jTemplate`：

```
org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'indexController': Injection of autowired dependencies failed; nested exception is org.springframework.beans.factory.BeanCreationException: Could not autowire field: private org.springframework.data.neo4j.support.Neo4jTemplate org.neuralsandbox.controllers.IndexController.neo4jTemplate; nested exception is java.lang.NoClassDefFoundError: javax/validation/Validator 
```

有没有办法解决这个问题？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-05-29T13:36:18.017

验证 API 似乎存在运行时依赖项。它通过简单地添加以下运行时依赖项解决了我的问题。

```
<dependency>
    <groupId>javax.validation</groupId>
    <artifactId>validation-api</artifactId>
    <version>1.1.0.Final</version>
    <scope>runtime</scope>
</dependency> 
```

希望这也能解决您的问题。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-22T09:00:51.857

一种可能的选择，尤其是当您真正需要`javax.validation`功能时，是将`javax.validation`（例如 Hibernate Validator）的实现添加到类路径中。

如果您不需要`javax.validation`，您应该能够通过创建一个虚拟对象`org.springframework.validation.Validator`并将其配置为`<mvc:annotation-driver validator = "..." />`.

# iphone - Sqlite 选择列并删除重复项

> ID：10266054
> 
> 赞同：2
> 
> 时间：2012-04-22T07:29:41.810
> 
> 标签：iphone, objective-c, sqlite

我有带有歌曲表的 sqlite 数据库，现在我想从这个表中获取艺术家列表，并且我想删除重复的匹配，所以如果我有一个艺术家 2 或 3 次，那么我只会得到它一次，有什么办法吗？

我没有使用：

```
SELECT artist FROM Songs ORDER BY name 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-22T07:36:00.833

[`distinct`](http://www.sqlite.org/lang_select.html#distinct)您可以使用一个关键字：

```
select distinct artist from songs order by artist; 
```

或者，如果您想要的不仅仅是艺术家姓名（例如，每位艺术家的条目数），您可以使用一个[`group by`](http://www.sqlite.org/lang_select.html#resultset)子句：

```
select artist, count(*) as entries from songs group by artist order by artist; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-22T07:32:43.330

SELECT DISTINCT 艺术家 FROM Songs ORDER BY name

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-04-22T07:39:08.220

```
DELETE FROM Songs WHERE id NOT IN
(SELECT MAX(id) FROM table GROUP BY id); 
```

# eclipse - 当我需要对属性文件进行资源过滤时，如何在 Eclipse 中运行 Maven webapp？

> ID：10266056
> 
> 赞同：2
> 
> 时间：2012-04-22T07:29:52.720
> 
> 标签：eclipse, debugging, tomcat, maven, m2e

我需要在这个问题上获得一些更新，我[在 2009 年在这里找到了这个线程](https://stackoverflow.com/questions/669639/how-can-i-run-a-maven-webapp-in-eclipse-when-i-use-profiles-to-populate-properti)，但答案是使用 maven 2，我不确定 Q4E 是否适用于 maven 3。我需要在 mvn 包阶段过滤一些属性文件，以使产生的战争起作用，资源过滤与 CLI mvn install 一起工作正常。但是当我执行“在服务器上运行/在服务器上调试”时，过滤不再起作用。上述线程作者最终使用了 q4e，声称 q4e 获得了资源过滤权。我也安装了 q4e 和 m2e，但仍然无法正常工作，所以我不知道 q4e 是否无法与 maven 3 一起使用，或者我做错了什么。谢谢，

大卫

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T23:34:34.240

更新到最新的 m2e-wtp 插件 0.15（自 0.12 以来的资源过滤错误修复），现在可以正常工作了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-22T07:35:39.793

我不确定这是否符合您的问题，但我想在构建期间使用来自 pom 的属性填充我的 web.xml 文件，并且我在 pom 中放置了一个 groovy 脚本来执行此操作。它很有效，也可能对你有用。它绝对可以在 eclipse 和命令行中使用。这是我的 pom 片段：

```
 <plugin>
<!-- Groovy script to set the description and version in the web.xml display name -->
    <groupId>org.codehaus.groovy.maven</groupId>
    <artifactId>gmaven-plugin</artifactId>
    <version>1.0</version>
    <executions>
      <execution>
        <id>groovy-magic</id>
        <phase>prepare-package</phase>
        <goals>
          <goal>execute</goal>
        </goals>
        <configuration>
          <source>
            def file = new File("src/main/webapp/WEB-INF/web.xml");
            def fileText = file.text;
            def match = "&lt;display-name>[^&lt;]*&lt;/display-name>";
            def replace = "&lt;display-name>"+project.description+" "+project.version+"&lt;/display-name>";
            fileText = fileText.replaceAll(match, replace);
            file.write(fileText);
            println "Updated web.xml"
          </source>
        </configuration>
      </execution>
    </executions>
  </plugin> 
```

# c# - 如何从sql函数中读取返回值

> ID：10266059
> 
> 赞同：2
> 
> 时间：2012-04-22T07:30:43.270
> 
> 标签：c#

> **可能重复：**
> [从 C# 中的存储过程获取返回值](https://stackoverflow.com/questions/706361/getting-return-value-from-stored-procedure-in-c-sharp)

我在 ac# winform 应用程序中使用以下 sql 函数

```
create function dbo.GetLookupValue(@value INT)
returns varchar(100)
as begin
  declare @result varchar(100)

  select
    @result = somefield
  from 
    yourtable
  where 
    ID = @value;

  return @result
end 
```

我的问题是：我如何在 c# 中读取返回的@result？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-22T08:07:13.723

您需要使用类似`SELECT dbo.(function)`检索值的语句 - 如下所示：

```
using(SqlConnection conn = new SqlConnection("server=.;database=TEST;Integrated Security=SSPI;"))
using (SqlCommand cmd = new SqlCommand("SELECT dbo.GetLookupValue(42)", conn))
{
    conn.Open();
    var result = cmd.ExecuteScalar();
    conn.Close();
} 
```

这将执行该函数并将结果值返回给您的 C# 应用程序。

# facebook - Facebook API 图表和上传照片

> ID：10266063
> 
> 赞同：0
> 
> 时间：2012-04-22T07:31:00.573
> 
> 标签：facebook, facebook-graph-api

我的网站上有 Facebook 的照片上传功能。请参阅下面的代码。

上传照片后，我会在 Facebook 上看到一个页面，其结果如下：

```
{
   "id": "3701830342510",
   "post_id": "1177996068_3701808141955"
} 
```

我想要的是上传者将被转移到相册。

```
 <?php
       $app_id = "233929";
       $app_secret = "9f3fa8e1e0be4254e0";
       $post_login_url = "http://";
       $album_name = 'My photos';
       $album_description = 'Photos submitted by the members of ';

       $code = $_REQUEST["code"];

       //Obtain the access_token with publish_stream permission 
       if(empty($code))
         {
           $dialog_url= "http://www.facebook.com/dialog/oauth?"
           . "client_id=" . $app_id 
           . "&redirect_uri=" . urlencode($post_login_url)
           . "&scope=publish_stream";
           echo("<script>top.location.href='" . $dialog_url . 
           "'</script>");
       } 
       else {
         $token_url= "https://graph.facebook.com/oauth/"
         . "access_token?"
         . "client_id=" .  $app_id 
         . "&redirect_uri=" . urlencode( $post_login_url)
         . "&client_secret=" . $app_secret
         . "&code=" . $code;
         $response = file_get_contents($token_url);
         $params = null;
         parse_str($response, $params);
         $access_token = $params['access_token'];

         // Get the new album ID
         $album_id = 3597407572006;

         //Show photo upload form and post to the Graph URL
         $graph_url = "https://graph.facebook.com/". $album_id
           . "/photos?access_token=" . $access_token;
         echo '<form enctype="multipart/form-data" action="'
         .$graph_url. ' "method="POST">';
         echo 'Adding photo to : ' . $album_name .'<br/><br/>';
         echo 'Please choose a photo: ';
         echo '<input name="source" type="file"><br/><br/>';
         echo 'Say something about this photo: ';
         echo '<input name="message" type="text"
            value=""><br/><br/>';
         echo '<input type="submit" value="Upload photo" /><br/>';
         echo '</form>';
      }
 ?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-22T07:42:38.837

该代码，我怀疑您从官方博客文章[How-To: Use the Graph API to Upload Photos to a user's profile](http://developers.facebook.com/blog/post/498/)中获取的代码使用 facebook graph api url 进行表单操作，因此当图片出现时您会看到该页面已上传。你无法控制它。

您可以做的是使用您自己的 url 作为表单操作，然后使用 php 将图片上传到 facebook 并将用户重定向到您想要的任何位置。类似的东西：[Facebook：php上传照片并张贴在墙上](https://stackoverflow.com/questions/5170852/facebook-php-upload-photo-and-post-on-wall)

# java - 设计数据库连接池

> ID：10266069
> 
> 赞同：1
> 
> 时间：2012-04-22T07:31:34.817
> 
> 标签：java, connection-pooling

如果在面试环境中问到这个问题，该怎么做。

> **您将如何设计数据库连接池。对将涉及的类和接口以及它们如何交互进行高级概述**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-22T07:36:24.480

你必须看看[对象池](http://www.oodesign.com/object-pool-pattern.html)设计模式

# vim - 如何将 \u7f51 更改为 vim 中的常用字符？

> ID：10266076
> 
> 赞同：4
> 
> 时间：2012-04-22T07:32:39.167
> 
> 标签：vim, encoding, utf-8

在 ruby​​ 中，因为它是在系统范围内编码的 utf-8。所以这很简单：

字符串 = "\u7f51\u5740\u4e0d\u80fd\u4e3a\u7a7a"

=>网址不能为空

谁能告诉我如何在vim中做到这一点？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-22T07:39:35.360

如果要插入 Unicode 字符，请参阅`utf-8-typing`帮助。

例如，`Ctrl-V` `u7f51`将插入网。

如果你想在 Vim 脚本中使用它，你可以像在 Ruby 中一样使用 Unicode 转义；该命令`echo "\u7f51\u5740\u4e0d\u80fd\u4e3a\u7a7a"`将回显您在问题中提供的字符串。

意识到这一点，`Ctrl-R`使用`"`和`=`寄存器；有关更多信息，`i_CTRL-R`请参阅文档。`i_CTRL-R_=`

给定以下内容，光标位于双引号字符串内：

```
string = "\u7f51\u5740\u4e0d\u80fd\u4e3a\u7a7a" 
```

应用这些击键：`c``i``"``Ctrl-R``=``"``Ctrl-R``"``"``Enter``Esc`

这将把它变成以下内容：

```
string = "网址不能为空" 
```

试着自己弄清楚它是如何工作的，但如果你不明白，我会解释更多。

# linux - bash screen 命令多窗口模式

> ID：10266079
> 
> 赞同：1
> 
> 时间：2012-04-22T07:33:26.003
> 
> 标签：linux, bash

我只是想知道我是否可以附加到几个不同的进程并在同一个会话中查看输出。

例如我在分离模式下启动几个进程

> 屏幕 -dm -S 进程“cp 111 222”
> 
> 屏幕 -dm -S 进程“cp 333 444”
> 
> 屏幕 -dm -S 进程“cp 666 777”

最后，我想在一个屏幕中附加所有这些和输出，就像*screen -r*
谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-22T07:58:34.803

`screen`您想通过使用类似的东西在单个会话中将它们作为单独的窗口启动

```
screen -dm -S process cp 111 222
screen -X -S process screen cp 333 444
screen -X -S process screen cp 666 777 
```

（注意没有引号；如果你引用它，你会发现创建的窗口报告错误`Cannot exec 'cp 333 444': No such file or directory`，因为它把引用的命令作为可执行文件的名称，而不是作为命令和参数。）

# javascript - 检查是否在 JavaScript 中覆盖了全局属性/函数

> ID：10266080
> 
> 赞同：5
> 
> 时间：2012-04-22T07:33:35.017
> 
> 标签：javascript, overwrite, global-object

JavaScript 使覆盖全局对象的属性和函数变得容易。我想找到一种方法来检查全局属性的原始版本是否已被替换。

考虑有人把它放在他们的 HTML 中：

```
<script type="text/javascript">
    window.encodeURIComponent = eval;
</script>
<script type="text/javascript" src="myscript.js"></script> 
```

如果 myscript.js 在某处调用 encodeURIComponent 函数，它现在的行为将无法预测。那么有没有一种方法可以在 myscript.js 内部检查是否有人在我使用之前覆盖了该函数？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-22T08:39:16.843

我唯一知道的是一种简单的方法，可以分析函数的字符串表示。通常，代码

```
window.encodeURIComponent.toString() 
```

应该产生这样的东西：

```
function encodeURIComponent() { [native code] } 
```

可以轻松解析关键信息`function encodeURIComponent`。

如果函数被 覆盖`eval`，如您的示例所示，您将获得：

```
function eval() { [native code] } 
```

一般来说，为了检查`window`属性，您可以创建一个假 iframe 并`window.[property].toString()`与`iframe.contentWindow.[property].toString()`. 如果比较给出`false`，则属性已更改。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-22T09:29:08.267

在一个脚本中执行此操作的一种有趣方法是比较函数原型

默认 -`typeof window.encodeURIComponent.prototype === "undefined"`

但是如果有人重新定义这个函数

`window.encodeURIComponent = function() { eval(); }` 我们将得到

`typeof window.encodeURIComponent.prototype === "Object"`

PS：这种方法比其他方法更可靠，但它不会给你100％的保证。JavaScript 是所有对象，并且都在运行时.. 只是忍受这个..

**更新** 你可以结合这两种方法..我的和@Stans..

这个例子不起作用，因为我没有使用`eval`- eval 默认情况下也有原型“未定义”..所以你可以这样做

```
window.encodeURIComponent.name === "encodeURIComponent" 
//to make shure that user won't use EVAL 
&& typeof window.encodeURIComponent.prototype === "undefined" 
//to make shure that user won't use self defined function 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-22T08:34:32.520

这是特定于浏览器的，绝对不适用于非功能，但是：

调用函数的`toString`方法应该产生类似的结果：

```
Chrome:

"function encodeURIComponent() { [native code] }"

Firefox:

"function encodeURIComponent() {
    [native code]
}"

IE 7/8/9:
"
function encodeURIComponent() {
    [native code]
}
" 
```

观察函数的名称与属性的名称匹配，并且它的主体被替换为“ `[native code]`”。想法是从该字符串中删除所有空格并将其与预期结果进行比较`"functionxxx(){[nativecode]}"`。

我不知道它是否适用于所有浏览器/功能，这是反复试验：

```
var pattern = 'function' + propertyName + '(){[nativecode]}';
var func = window[propertyName].toString();
if(func.replace(/\s+/g, '') !== pattern) {
    throw new Error("Property window." + propertyName + " has been modified!");
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-05-05T13:57:39.047

这个怎么样？

```
function isNativeWindowProperty(propertyName) {
    var result = false;
    var iframe = document.createElement('iframe');
    iframe.src = 'javascript:;';
    document.getElementsByTagName('body')[0].appendChild(iframe);
    if (window[propertyName].toString() === iframe.contentWindow[propertyName].toString()) {
        // check window[propertyName].toString override
        if (window[propertyName].toString.toString() === iframe.contentWindow[propertyName].toString.toString()) {
            result = true;
        }
    }
    iframe.parentNode.removeChild(iframe);
    return result;
};

console.log(isNativeWindowProperty('alert'));  // true

window.alert = function() {};
console.log(isNativeWindowProperty('alert'));  // false

window.alert.toString = function() {
    return 'function alert() { [native code] }';
};
console.log(isNativeWindowProperty('alert'));  // false 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-22T08:44:23.767

在 JavaScript 中有一种简单的方法 :) 但是您必须有权访问 HTML，因此您不能在一个脚本中使用此方法..

function 是一个 OBJECT.. 所以我们可以保存一个对象的链接并比较这些链接。把一个函数想象成一个简单的对象。你怎么能比较对象？

```
<script type="text/javascript">
    var a = window.encodeURIComponent;  // a === window.encodeURIComponent -> true
</script>
<script type="text/javascript">
    window.encodeURIComponent = eval; // a === window.encodeURIComponent -> false
</script>
<script type="text/javascript" src="myscript.js">
    if (a !== window.encodeURIComponent) 
    {
        throw new Error('Someone redefined function');
    }
</script> 
```

# sql - 查询时保留顺序

> ID：10266082
> 
> 赞同：2
> 
> 时间：2012-04-22T07:33:40.773
> 
> 标签：sql

我有这个查询，我想保留订单

```
SELECT a FROM TABLE WHERE id in (2,45, 87, 10,12, 41, 29) 
```

现在我想要按该顺序的a值我的意思是a for 2，然后是a for 45，然后是a for 87。我怎样才能在sql中完成这个

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-22T07:36:26.217

在 MySQL 中，您可以使用 ORDER BY [FIELD](http://dev.mysql.com/doc/refman/5.5/en/string-functions.html#function_field)：

```
SELECT a
FROM yourtable
WHERE id IN (2, 45, 87, 10, 12, 41, 29)
ORDER BY FIELD (id, 2, 45, 87, 10, 12, 41, 29) 
```

在不支持 FIELD 的数据库中，您可以改用 CASE 表达式：

```
SELECT a
FROM yourtable
WHERE id IN (2, 45, 87, 10, 12, 41, 29)
ORDER BY CASE
    WHEN id = 2 THEN 1
    WHEN id = 45 THEN 2
    WHEN id = 87 THEN 3
    WHEN id = 10 THEN 4
    WHEN id = 12 THEN 5
    WHEN id = 41 THEN 6
    WHEN id = 29 THEN 7
END 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-23T00:54:47.007

如果您的 id 值来自另一个查询，并且它们的顺序很重要，那么该查询必须有自己的 ORDER BY 子句，以正确的顺序生成 id。然后，您可以在此 ORDER BY 子句中使用联接而不是 IN 子句。这是执行此操作的标准 SQL 查询。

```
with SelectIDs(id,position) as (
  select 
    id,
    row_number() over (
      order by columnA, columnB
    )
  from table2
  where <your where condition>
)
  select T.*
  from yourTable as T
  join SelectIDs as I
  on I.id = T.id
  order by I.position; 
```

如果您匹配的 id 是不同的而不是 NULL，那么结果应该是您想要的。

# list - 进行破坏性逆转！方案中的功能

> ID：10266086
> 
> 赞同：1
> 
> 时间：2012-04-22T07:34:23.477
> 
> 标签：list, scheme, reverse

我需要创建一个会破坏性地反转列表的程序。例如让我们说..

```
scm> (define L (list 1 2 3 4))
scm> (reverse! L)
(4 3 2 1)
scm> L
(1) 
```

其中 L 成为反向列表的最后一个元素。我知道我应该使用 set-cdr！不知何故，但无法弄清楚如何实现它。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-22T14:53:02.343

因为这看起来像家庭作业，所以我不能给你一个直接的答案。我将向您展示解决方案的一般结构，以便您了解详细信息并填写空白：

```
(define (reverse! lst)
  (let loop ((lst lst)
             (acc '()))
    (if (null? lst)
        acc
        (let ((tail <?1?>))
          (set-cdr! <?2?> <?3?>)
          (loop tail lst)))))

(define lst (list 1 2 3 4))
lst
> (1 2 3 4)

(reverse! lst)
> (4 3 2 1)

lst
> (1) 
```

在上面的代码中：

*   为简单起见，使用命名遍历原始列表`let`，因为需要另一个参数
*   定义了一个新`acc`参数，作为反向列表的累加器
*   当递归结束时，返回累加器中的答案

现在，对于递归步骤：

*   我们`<?1?>`需要获取对列表其余部分的引用并保存它，因为我们要修改它
*   关键在于线`(set-cdr! <?2?> <?3?>)`。您必须将当前列表的*下一个元素设置为先前累积的反向列表*
*   最后，递归继续使用新的累加值

请注意，最后，`lst`引用已就地修改，现在指向列表的最后一个元素。如果您需要`lst`指向反向列表，那么只需执行以下操作：

```
(define lst (list 1 2 3 4))
lst
> (1 2 3 4)

(set! lst (reverse! lst))
lst
> (4 3 2 1) 
```

描述的过程破坏性地反转列表并且不创建新列表（不`cons`使用任何操作。）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-22T16:31:55.267

您应该阅读[The Scheme Programming Language](http://www.scheme.com/tspl3/)书中[关于 mutators 的部分](http://www.scheme.com/tspl3/start.html#./start%3ah9)。另外，查看Scheme 中的函数。本质上，您可以使用该函数从根本上更改定义并提供另一个输出。`case``set!`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-23T17:15:09.447

UCB 好家伙。

这是我为您的 HilAcke 提供的解决方案。

```
(define (reverse! L)
     (define (helper prev cur)
           (if (null? cur)
               prev
               (let ((next (cdr cur)))
                   (set-cdr! cur prev)
                   (helper cur next))))
     (helper '() L)) 
```

然后在定义后你可以用通常的方式检查

```
 (define L (list 1 2 3 4))
 (define LR (reverse! L))
 LR
 > (4 3 2 1) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-03-30T20:08:01.377

所以我想知道今天如何做到这一点，因为我需要它进行测试。对于每个包含超过 1 个元素的列表，我将`cons`参数中的第一个作为结果中的第一个。我做了一个新的缺点，用一个虚拟值保存新的最后一个值，然后我反转元素 2..n-1 的链接。最后我设置了第一`cons`和新的车`last`。结果是最后的结果`set-cdr!`。

```
(define (reverse! lst)
  (if (or (null? lst)
          (null? (cdr lst)))
      'soup ; an undefined value. You may use something else
      (let ((last (list 1)))
        (let loop ((prev last) (cur (cdr lst)))
          (let ((next (cdr cur)))
            (if (pair? next)
                (begin
                  (set-cdr! cur prev)
                  (loop cur next))
                (begin
                  (set-car! last (car lst))
                  (set-car! lst (car cur))
                  (set-cdr! lst prev)))))))) 
```

例子：

```
(define test '(() (2) (3 4) (5 6 7) (8 9 10 11 12 13 14 16)))
(for-each reverse! test)
test ; ==> (() (2) (4 3) (7 6 5) (16 14 13 12 11 10 9 8)) 
```

# php - 用于删除临时帐户的 Cronjob？

> ID：10266089
> 
> 赞同：0
> 
> 时间：2012-04-22T07:34:31.647
> 
> 标签：php, mysql

我有一小笔使用网络应用程序的费用。

我想让人们在付款前试用该应用程序。

为此，我想要一个创建临时用户帐户的系统，然后在 30 分钟左右后再次删除。

首先想到的是将 TINYINT 类型的列“isTemp”添加到 accounts 表中，然后设置一个 cronjob 以每 30 分钟执行一次查询“DELETE FROM accounts WHERE isTemp = 1”。

但是……我对此有点紧张。我害怕早上醒来发现整个账户表都是空的。我意识到这可能是一种不合理的恐惧，但我不喜欢预定的 DELETE 语句靠近帐户表。:)

对此有何想法？这是应该做的吗？还是我应该重新考虑一下？

在此先感谢您的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-22T07:42:16.107

最佳解决方案是 to`active`和`inactive`account。但是，如果您当前的编码不容易做到这一点，那么 a`DELETE`可能就足够了。我建议创建一个`datetime`用户帐户创建时间的字段。您可以创建一个简单的 cron 作业来继续检查`signup time + 30 mins`或类似的东西，然后`DELETE`. 如果这让您担心，请在最初几天手动将脚本通过电子邮件发送给您，然后手动执行操作以确保其正常工作。

使用`active`and的好处`inactive`是它只是一个简单的布尔更改，而不是丢失所有数据。

希望有帮助！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-22T07:43:36.773

问题是如果用户在第 29 分钟登录，您的系统将在第 30 分钟删除他们，他们的帐户将被删除，即使它只活动了 1 分钟。

您最好执行“从帐户中删除 isTemp = 1 AND account_created > {30 分钟前}

（插入代码以计算大于 30 分钟前的时间戳）

ps 30 分钟对于临时帐户来说不是很长 - 可能是 2 小时 -

# windows - 检查在 Linux 和 Windows 中保存文件的进程

> ID：10266094
> 
> 赞同：2
> 
> 时间：2012-04-22T07:35:06.123
> 
> 标签：windows, linux, io

是否有任何命令可以检查在 Linux 和 Windows 中保存文件的任何进程？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-22T07:40:11.580

[`lsof`](http://en.wikipedia.org/wiki/Lsof)并且[`fuser`](http://en.wikipedia.org/wiki/Fuser_(Unix))可以在 Linux（和其他类 Unix 系统）上使用。

对于 Windows，[Process Explorer](http://technet.microsoft.com/en-us/sysinternals/bb896653)可用于此目的，也可用于[`handle`](http://technet.microsoft.com/en-us/sysinternals/bb896655)命令行版本。

# c++ - 函数中的 C++ const 关键字

> ID：10266095
> 
> 赞同：2
> 
> 时间：2012-04-22T07:35:26.000
> 
> 标签：c++, function, constants

我在使用时理解如下：

```
int getX() const {...} 
```

意味着此函数不会修改其主体中使用的任何变量。但我不知道的是在 2 个地方使用 const，如下所示：

```
const int* getX () const {...} 
```

把`const`关键字放在前面有什么用`int*`？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-22T07:37:53.813

你的第一个解释是错误的。

```
int getX() const { ... } 
```

是一个成员函数，它不能修改任何数据成员或为具有该函数的类的给定实例调用任何非常量。

```
const int* getX() const { ... } 
```

返回 a `const int*`，因此它限制了您可以分配给使用它的内容。它是一个*指向 const int 的非 const 指针*，因此您不能修改它指向的 int，但您可以修改指针本身。例如：

```
const int* i = someInstange.getX(); // getX() returns const int*
i = someOtherFunction(); // another function returning const int*. OK to reassign i. 
```

所以`i`它本身不是`const`，但它指向的是：

```
(*i)++; // ERROR! 
```

如果你想返回一个*指向 const int 的 const 指针，*你需要这样的东西：

```
const int * const getX() {} 
```

整个问题更加复杂，因为您可以将第一个`const`放在不同的地方而不改变含义。有关这方面的更多信息，请查看[这个 SO question](https://stackoverflow.com/questions/1143262/what-is-the-difference-between-const-int-const-int-const-int-const)。

# mysql - 在 MySQL 上创建类型

> ID：10266101
> 
> 赞同：15
> 
> 时间：2012-04-22T07:36:17.650
> 
> 标签：mysql, sql, database, types

我无法在 MySQL 上创建新的数据类型。查询如下

```
CREATE TYPE PERSON AS OBJECT
(NAME       VARCHAR (30),
 SSN        VARCHAR (9)); 
```

我怎么能在 MySQL 上做到这一点

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2012-04-22T07:38:26.153

你不能。MySQL 没有用户定义的类型。（至少，不是在当前版本中。）

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2020-09-01T03:27:45.663

您现在可以使用 JSON 数据类型。MySQL 从 5.7 版本开始支持原生 JSON 数据类型。8.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-08-04T14:38:26.670

其他两个答案都是 100% 正确的，你不能定义新的标量元组值，而 JSON 作为原生类型让你几乎可以做到。

我有三个建议。首先，关于如何对值强制执行特定 JSON 模式的建议，由 getter/setter 支持。第二种可能的解决方案是 CTE，尽管这涉及到一些额外的写作工作，并且不能替代真正的自定义类型。第三种方法，在某种程度上是前两种建议的混合体，将涉及封装子查询查找的 getter/setter。

请在您进一步阅读之前，以下代表餐巾草稿质量草图。没有比这更好的了。自 2020 年底以来，我没有使用过 MySQL。

首先，构造函数/getter/setter 方法，尽管实现它可能需要一些工作，即使设计良好的索引也无法使其在查找性能上与本机列竞争，而且它总是会占用更多块/页面/磁盘中的空间，但它是 90% 的解决方案——就像在 C 中实现 struct 方法的方式一样，如果你这样做，它只是用于命名空间组织，而且会很笨拙。

```
delimiter $$;
create function contact_encode(fname text, lname text, phone text, email text)
returns JSON
deterministic
begin
    /* validation stuff here? like maybe you care that they're not null
       and/or sane values for names and phone numbers and email addresses?
     */
    return json_object(
        'firstName', fname,
        'lastName', lname,
        'contactMethod', json_array(
            json_object(
                'type','phone',
                'value',phone
            ),
            json_object(
                'type','email',
                'value',email
            )
        )
    );
end$$
delimiter ;$$
/*  Yep, this approach probably actually sucks

    I was going to suggest something like contact_decode(JSON)->values...,
    but I forgot that you can't return multiple values from a function.
    That's the irony; it'd be easier to use JSON for custom types in
    languages that already support return tuples and custom types as relations. 

    Grrrrr
 */ 
```

错，是的。这可能是您可以使用 MySQL 获得的最接近自定义类型的方法。假设一组像下面这样的 getter/setter 函数实际上可以改进现有的 MySQL 8 API for JSON 值/列。再次纯粹假设，这是一个具有编码行为的 setter 示例，它提供了某种程度的封装逻辑：

```
create function contact_get_name(contact JSON)
.....return concat(contact->>'firstName', ' ',contact->>'lastName')
.....
create function contact_set_name(contact JSON, value text)
....return json_replace(
        contact, 
        '$.firstName', substring_index(value, ' ', 1),
        '$.lastName'. substring_index(value, ' ', -1)
    )
..... 
```

问题比比皆是。如果有帮助，作为 MySQL 开发人员，打字从来都不是对我的严重限制。现在我与使用 PostgreSQL 作为默认值的装备一起工作，自定义类型非常棒（返回行类型，我在看着你），但是因为我们还没有从 MySQL 5.x 迁移到 8.x，所以我没有在 PostgreSQL 之前不能玩 CTE。也就是说，以下内容可能不会直接转换为 MySQL。

假设一个名为“blog_user”的表具有列（id、name、phone、email、username、password、blah-blah-blah.....），在表的查询中使用该表的“自定义类型”称为 post (id, author_id, title, ....) 可能如下所示：

```
with author as (
    select
        id,
        substring_index(name, ' ', 1) as first_name,
        substring_index(name, ' ', -1) as last_name,
        email,
        concat('###-###-', right(phone, 4)) as phone
    from blog_user
) select
    concat(first_name, ' ', left(last_name, 1), '.') as name,
    title,
    yada-yada.....
from author, post
where author.id = post.author_id
and case 
    when @requested_blog_post is not null
        then post.id = @requested_blog_post
    when @title_search_term is not null
        then post.title like concat('%',@title_search_term,'%')
    else false
end 
```

它实现了预期的影响，并且作为部分连接，它实际上将非常透明，性能方面......假设核心查询过滤器中使用的任何 CTE 源列都有良好的索引。

在性能方面，后一种方法，添加 CTE 来创建子查询以部分加入特定属性，将远远优于 JSON 方法，而 JSON 方法可以说对某些人来说更符合人体工程学，特别是如果你'无论如何都习惯于在 MySQL 中使用 JSON。

第三种解决方案是定义接收 id 的自定义 getter/setter 函数，并返回该 id 上列的值，如下所示：

```
create function post_get_author_name(requested_post int)
....
return (
    with author as (
        ....
    ) select 
        name 
    from author, post
    where author.id = post.author_id
    and post.id = requested_post
    limit 1 /*completely unnecessary in this case, but it's a thing I do anyway*/
)
.... 
```

这种方法的困难在于，它表明您将在同一个查询中调用一堆这些 getter。这在性能方面客观上比本地 CTE 解决方案更差，而且它的性能可能比使用行本地 JSON 的相同 getter/setter 方法更差。

要点如下：抱歉，您不能有自定义类型。有一些近似值，几个月前我什至无法理解你的痛苦，但我表示哀悼。有一些可能可行的近似值。

# php - 使用 YII 框架发送 HTTP Post 请求

> ID：10266104
> 
> 赞同：2
> 
> 时间：2012-04-22T07:36:30.883
> 
> 标签：php, httpwebrequest, yii, http-post

有办法从我的控制器发送 HTTP 发布请求吗？我想发布数据，结果将返回 JSON。我没有找到有关 yii 的扩展名和信息。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-22T08:53:13.810

下面的代码应该适合你，只要确保启用 php_curl 扩展。

```
<?php

// URL on which we have to post data
$url = "http://localhost/tutorials/post.php";

// Any other field you might want to post
$json_data = json_encode(array("name"=>"PHP Rockstart", "age"=>29));
$post_data['json_data'] = $json_data;
$post_data['secure_hash'] = mktime();

// Initialize cURL
$ch = curl_init();

// Set URL on which you want to post the Form and/or data
curl_setopt($ch, CURLOPT_URL, $url);
// Data+Files to be posted
curl_setopt($ch, CURLOPT_POSTFIELDS, $post_data);
// Pass TRUE or 1 if you want to wait for and catch the response against the request made
curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);
// For Debug mode; shows up any error encountered during the operation
curl_setopt($ch, CURLOPT_VERBOSE, 1);
// Execute the request
$response = curl_exec($ch);

// Just for debug: to see response
echo $response; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-23T05:34:59.977

我找到了解决方案： [http](http://www.yiiframework.com/extension/ehttpclient/) ://www.yiiframework.com/extension/ehttpclient/ 这是 Zend Framework 的 yii 扩展

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-02T17:17:04.890

[yii-curl](http://www.yiiframework.com/extension/yii-curl/)是您可以使用的另一个扩展，显然是[PHP 的 cURL](http://php.net/manual/en/book.curl.php)的包装器。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-22T07:42:05.750

你可以使用[curl](http://us.php.net/curl) PHP 扩展来做到这一点。

# android - 如何将值传递给 Android 上的 Facebook 对话框

> ID：10266105
> 
> 赞同：1
> 
> 时间：2012-04-22T07:36:37.653
> 
> 标签：android, facebook

我正在通过使用如下 img 的 Facebook 对话框来实现向 Wall 发布消息，如下所示 ![在此处输入图像描述](../Images/1c59efc52fae08d5f7e3b844c0618406.png)

任何人都知道如何将值从 Activity 传递到 FB 对话框，例如“在这里分享您的想法......”并将其作为 diablog 上文本框的提示？请帮助....

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-22T10:59:56.480

如果您询问如何将文本作为消息发送给用户，那么答案是您不能这样做。

过去可以添加“消息”参数，但应用程序滥用了该选项，因此 facebook 决定删除该选项。使用对话框时，用户可以完全控制进入消息字段的内容。

您可以这样做的唯一方法（我知道）是请求“publish_stream”权限，然后在不使用对话框的情况下以用户身份发布，在android上下文中它使用*[facebook.request](http://developers.facebook.com/docs/reference/androidsdk/request/)*（或[异步方式](http://developers.facebook.com/docs/reference/androidsdk/ayncrequest/)），例如：

```
Bundle parameters = new Bundle();
parameters.putString("link", "http://stackoverflow.com");
parameters.putString("message", "A user message..");
facebook.request("me/feed", parameters, "POST"); 
```

# asp.net-mvc - Layout.cshtml 上的 ASP.NET MVC 搜索框

> ID：10266106
> 
> 赞同：5
> 
> 时间：2012-04-22T07:36:57.763
> 
> 标签：asp.net-mvc

我从[http://www.asp.net/mvc/tutorials/getting-started-with-ef-using-mvc/sorting-filtering-and-paging-with-the-entity-创建了搜索表单和结果framework-in-an-asp-net-mvc-application](http://www.asp.net/mvc/tutorials/getting-started-with-ef-using-mvc/sorting-filtering-and-paging-with-the-entity-framework-in-an-asp-net-mvc-application)使用 PagedList Nuget 包处理分页和排序。

不过，我需要帮助的是如何将搜索表单放在我的母版页上？（_layout.cshtml）？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-22T08:16:04.933

放一个 from 包含一个文本框和一个按钮，表单的操作将是搜索操作

`_layout.cshtml`页面中的 Ex 代码

```
@using(Html.BeginForm("ActionName","ControllerName", FormMethod.Get))
{
    @Html.TextBoxFor(m => m.Query)

    <div>
        <input type="submit" value="Search" />
    </div>
} 
```

# jquery - 显示加载图像进度，直到在 ASP.Net 网络表单中下载实际图像

> ID：10266114
> 
> 赞同：0
> 
> 时间：2012-04-22T07:38:18.213
> 
> 标签：jquery, css, webforms

我正在开发一个功能，我可以使用动画图像显示加载进度，直到下载实际图像。

我有一个页面，其中有很多图像，我在记录中循环并使用中继器控件显示它们。下面是代码 HTML-CSS 的示例

```
<asp:Repeater ID="rpt4x42" runat="server" EnableViewState="False">
    <ItemTemplate>
         <asp:HyperLink ID="hylTopFour2" style=" text-decoration:none;" runat="server" 
                                   NavigateUrl='<%# getURL(Eval("ArticleID")) %>' BorderWidth="0px" meta:resourcekey="hylTopFour2Resource1">
          <div id="articleContainer2" class="articleContainer" >
               <div id="ArticleImgHP-container" >
                    <asp:Image ID="imgTopFourImg2" runat="server" width="170px" height="112px" CssClass="ArticleImgHP"
                                                    border="0" ImageUrl='<%# getImagePath(Eval("ArticleThumNailImage")) %>'  />
               </div>
               <div class="Details4x4">
               <div  class="Title4x4" >
                     <asp:Label ID="lblTopFourTitle" runat="server" Text='<%# getTitle(Eval("ArticleTitle")) %>'></asp:Label>
                </div>
                <div class="hLine4x4"></div>
                <div class="dateWrapper4x4">
                <div class="Date4x4">
                     <asp:Label ID="lblTopFourDate" runat="server"  
                                                               Text='<%# FormatDate(Eval("[ArticlePublishDate]")) %>'></asp:Label>
                </div>
               </div>

             </div>

           </div>
</asp:HyperLink>
                             </ItemTemplate>
                        </asp:Repeater>

                </div> 
```

CSS

```
 img.ArticleImgHP {
         /* Set the width and height to the size of its container */
        width : 100%;
        height : 100%; 
        visibility : hidden;
    }
    div.ArticleImgHP-container { 
        width : 170px;
        height : 112px;
        background-image: url('../images/loading-circle.gif');
        background-position: center center;
        background-repeat: no-repeat;
    } 
```

jQuery

```
 $(document).ready(function () {
        // $("img #MainContent_rpt4x42_imgTopFourImg2_1").bind("load", function () { $(this).show(); });
           $("img.ArticleImgHP").bind("load", function () { $(this).css("visibility", "visible"); });

     }); 
```

我已将实际图像包装在 div 标签内，我想显示此 div 标签的背景图像，直到下载实际图像。我无法让它工作。我将不胜感激这方面的帮助。

我试图让同样的事情在 jsFiddle 上运行它不工作[http://jsfiddle.net/t5d39/13/](http://jsfiddle.net/t5d39/13/)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-22T08:02:54.317

**通过将类添加到 div 标签来解决**它****

 **```
<div id="ArticleImgHP-container"  class="ArticleImgHP-container"> 
```**

# c# - 如何使用带有附加选项的 Gridview 分页进行设计

> ID：10266119
> 
> 赞同：0
> 
> 时间：2012-04-22T07:38:57.230
> 
> 标签：c#, asp.net

我有一个问题，我想设计一个带有附加选项的网格视图，以不同的方式进行分页，如下图所示。我可以在 GridView 中实现简单的分页概念，但不会像图像中那样显示我想要的。这也将显示每页记录选项。请建议我对此的任何解决方案。

提前致谢。

![在此处输入图像描述](../Images/7a474714a4f89b946f936e033522bb15.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-22T07:45:21.613

您可以通过制作一个样式化的下拉列表并将其放置在 gridview 下，使其看起来像 gridview 的一部分，然后使用下拉淹没文本更改事件更新 gridview 分页选项，来解决这个问题。

# language-agnostic - HEX RGB 颜色操作方法？

> ID：10266123
> 
> 赞同：2
> 
> 时间：2012-04-22T07:39:51.317
> 
> 标签：language-agnostic, colors, hex, rgb

这是我的情况：

我有一个包含大约 100 个颜色变量的文件（以十六进制值设置，例如`#FFFFFF`） - 让我们考虑一下**Theme**。

现在我想做的是：

*   将同一组属性应用于所有变量并相应地更改它们
*   例如反转所有颜色（转到`#FFFFFF`，`#000000`等等...）

我想知道的是：

*   是否有用于 HEX RGB 操作的此类方法/公式？
*   您能否指出（尽可能）**完整**的操作列表？（变暗，变亮，乘法，反转，等等 - 越多越好）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-22T08:44:20.993

我们先做问题2：

## 颜色操作列表

我认为你最好的选择是在网上搜索“颜色操作库”，而不是关心操作系统/平台/应用程序/工具出现了什么——只需检查文档以了解他们的 API 公开了什么。这是我发现的：

*   [Sass 中的颜色处理](http://nex-3.com/posts/89-powerful-color-manipulation-with-sass)

    *   调整色调
    *   饱和
    *   去饱和
    *   减轻
    *   变暗
    *   灰度
    *   补充
    *   混合（有趣！就像混合油漆颜色）
    *   不透明
    *   淡入
    *   消退
    *   透明化
*   [红宝石颜色工具](http://ruby-pdf.rubyforge.org/color-tools/doc/index.html)

    （上面的一些，加上......）

    *   调整亮度
    *   调整色调
    *   调整饱和度
    *   变暗
    *   lighten_by
*   [颜色，Javascript颜色库](https://github.com/qix-/color)

    （再次，忽略上面已经存在的内容......）

    *   更清晰
    *   不透明
    *   旋转（我认为，即在色彩空间中旋转）
*   [葡萄柚，Python颜色库](http://code.google.com/p/grapefruit/)

    令人讨厌的是，他们的文档可以[下载](http://code.google.com/p/grapefruit/downloads/detail?name=htmldoc-grapefruit-0.1a3.tar.gz)，但不能在线托管。

    *   ColorWithAlpha
    *   ColorWithWhiteRef
    *   有色有色
    *   色彩饱和度
    *   色彩与亮度
    *   WebSafeDither

所以这是一个很好的操作开始。找不到用于 Objective-C 的，抱歉。

## 这些操作的公式

坏消息：找不到一个只有一个很好的公式备忘单的地方。

好消息：上面几乎所有的库都是开源的。我相信你可以四处看看并弄清楚它的`ColorWithWhiteRef`实际工作原理。

祝你好运！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-01-17T05:59:27.737

如果您正在寻找一个 javascript 库，[xolor 库](https://github.com/fresheneesz/xolor)有很多颜色转换和组合：

两种颜色的组合：

*   blend - 将一种颜色覆盖在另一种颜色上，其中第一种颜色具有不透明度
*   combine - 用 XOR 组合两种颜色
*   add - 两种颜色的加法混合
*   减法 - 两种颜色的减法混合
*   减法 - 两种颜色的减法（与减法不同，非标准颜色函数）
*   乘法 - 两种颜色的乘法混合
*   平均 - 两种颜色之间的平均值
*   渐变 - 沿两种颜色之间的渐变返回颜色

相关颜色：

*   亮度 - 返回或更改亮度级别
*   饱和度 - 返回或更改饱和度
*   hue - 返回或更改色调
*   luminosity - 返回 WCAG 亮度
*   棕褐色过滤器
*   逆
*   grayFilter - 将颜色更改为灰度版本

相关颜色列表：

*   三合会
*   四分体
*   分裂补
*   单色
*   类似的
*   schemeByDegrees - 通过传入任意数量的色调角增量数组来创建一组任意数量的颜色

杂项

*   距离 - 得到一个
*   contrast - 获取两种颜色之间的 WCAG 对比度级别

# ios - 如果源代码来自书籍作者，如何在真正的 iPad 上编译和运行？

> ID：10266127
> 
> 赞同：1
> 
> 时间：2012-04-22T07:40:23.393
> 
> 标签：ios, xcode, code-signing

我有一本关于 iPad 编程的书，CD-ROM 中有源代码。当我编译它并在模拟器上运行时，一切正常。但是，如果我以新 iPad 为目标来查看应用程序的性能，它会给出：

> 检查依赖
> 项代码签名错误：身份“iPhone Distribution: Chen Li”与默认钥匙串中的任何有效、未过期的证书/私钥对不匹配

有没有办法解决这个问题？或者，另一种方法似乎是创建一个新项目并逐个添加这些源代码文件，但可能有更好的方法吗？

（因为我加入了苹果开发者计划，如果是我自己的代码，我可以在真iPad上运行程序……）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-22T07:42:14.637

您需要拥有 Apple iOS 开发者计划会员资格才能在真实设备上进行测试。此外，如果你有它，这需要几个设置步骤。

由于您已配置开发人员程序，因此您需要更新项目设置以使用您的配置文件。

转到项目设置 -> 构建设置 -> 代码签名并更新相应的设置。在 Xcode 4.3 中有一个自动选择选项。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-22T07:52:02.413

在 Xcode 4 中，在列出所有文件的左侧窗格中选择您的*项目。*
然后选择您的*目标*并转到*Build Settings*。
当您在那里时，搜索*Code Signing*。

确保在此处选择您的个人资料，而不是该书作者的个人资料，因为您的 Mac 上没有安装他的个人资料。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-22T07:52:41.930

这是因为 CD 中的源代码已经设置了一个`Code Signing Identify`，但在您的配置文件库中找不到，您必须将 更改`Code Signing Identify`为您的配置文件。

转到项目目标`Build Settings`并更改`Code Signing Identify`.

# .net - 实体框架左外连接和分组：ORA-00907：缺少右括号

> ID：10266128
> 
> 赞同：3
> 
> 时间：2012-04-22T07:40:48.760
> 
> 标签：.net, visual-studio-2010, entity-framework, oracle11g, ora-00907

我在基于实体框架的数据访问中使用实体框架来定位多个数据库。

我们是一个使用 Entity Framework 的团队，已经 2 年了，生成的代码与 sql server 2008 完美配合。现在，我们正在将数据库迁移到 Oracle 11 express r2g2 后测试相同的代码，以及所有使左外的指令加入或分组到显示此调用堆栈的选择抛出异常：

```
System.Data.EntityCommandExecutionException was unhandled by user code
Message=An error occurred while executing the command definition. See the inner exception for details.
Source=System.Data.Entity
StackTrace:
at System.Data.EntityClient.EntityCommandDefinition.ExecuteStoreCommands(EntityCommand entityCommand, CommandBehavior behavior)
at System.Data.Objects.Internal.ObjectQueryExecutionPlan.Execute[TResultType](ObjectContext context, ObjectParameterCollection parameterValues)
at System.Data.Objects.ObjectQuery`1.GetResults(Nullable`1 forMergeOption)
at System.Data.Objects.ObjectQuery`1.System.Collections.Generic.IEnumerable<T>.GetEnumerator()
at System.Collections.Generic.List`1..ctor(IEnumerable`1 collection)
at System.Linq.Enumerable.ToList[TSource](IEnumerable`1 source)
at Futura.BusinessLogic.Services.DemandeHospitalisationServices.DemandeHospitalisationService.GetMedecinList() in C:\Work\FuturaSmartDesign\Futura.BusinessLogic\Services\DemandeHospitalisationServices\DemandeHospitalisationService.cs:line 87
at GetMedecinList(DomainService , Object[] )
at System.ServiceModel.DomainServices.Server.ReflectionDomainServiceDescriptionProvider.ReflectionDomainOperationEntry.Invoke(DomainService domainService, Object[] parameters)
at System.ServiceModel.DomainServices.Server.DomainOperationEntry.Invoke(DomainService domainService, Object[] parameters, Int32& totalCount)
at System.ServiceModel.DomainServices.Server.DomainService.Query(QueryDescription queryDescription, IEnumerable`1& validationErrors, Int32& totalCount)
InnerException: Oracle.DataAccess.Client.OracleException
Message=ORA-00907: missing right parenthesis
Source=Oracle Data Provider for .NET
ErrorCode=-2147467259
DataSource=Calys
Number=907
Procedure=""
StackTrace:
at Oracle.DataAccess.Client.OracleException.HandleErrorHelper(Int32 errCode, OracleConnection conn, IntPtr opsErrCtx, OpoSqlValCtx* pOpoSqlValCtx, Object src, String procedure, Boolean bCheck, Exception innerException)
at Oracle.DataAccess.Client.OracleException.HandleError(Int32 errCode, OracleConnection conn, String procedure, IntPtr opsErrCtx, OpoSqlValCtx* pOpoSqlValCtx, Object src, Boolean bCheck, Exception innerException)
at Oracle.DataAccess.Client.OracleCommand.ExecuteReader(Boolean requery, Boolean fillRequest, CommandBehavior behavior)
at Oracle.DataAccess.Client.OracleCommand.ExecuteDbDataReader(CommandBehavior behavior)
at System.Data.Common.DbCommand.ExecuteReader(CommandBehavior behavior)
at System.Data.EntityClient.EntityCommandDefinition.ExecuteStoreCommands(EntityCommand entityCommand, CommandBehavior behavior)
InnerException:
Message=Oracle 11.2.0.2.0 ne prend pas en charge APPLY
InnerException: 
```

任何帮助将不胜感激，在此先感谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-18T11:26:57.343

这是由于实体框架生成的代码：CROSS/OUTER APPLY；甲骨文不支持。这是在 Connect 上报告的， [https://connect.microsoft.com/VisualStudio/feedback/details/739458/linq-query-whene-used-with-oracle-11-g2-getting-ora-00907-missing-right -插入语](https://connect.microsoft.com/VisualStudio/feedback/details/739458/linq-query-whene-used-with-oracle-11-g2-getting-ora-00907-missing-right-parenthesis)

在 MS Connect 平台上将不胜感激任何解决方法

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-01-08T14:53:03.843

当我的 EF 查询有太多“包含”时，我在 EF 5 和 Oracle 11g 中遇到了这个错误。在我的情况下 7 ".Include" 导致此错误。

```
 var myEntity = __DbContext.Get<MyEntity>()
            .Include("Property1")
            .Include("Property2")
            .Include("Property3")
            .Include("Property4")
            .Include("RelatedEntities.Property1")
            .Include("RelatedEntities.Property2")
            .Include("RelatedEntities.Property3")
            .First(c => c.Id == id); 
```

我将其更改为进行两个查询以获取我的数据：

```
 var myEntity = __DbContext.Get<MyEntity>()
            .Include("Property1")
            .Include("Property2")
            .Include("Property3")
            .Include("Property4")
            .First(c => c.Id == id);

        myEntity.RelatedEntities = __DbContext.Get<RelatedEntity>()
            .Include("Property1")
            .Include("Property2")
            .Include("Property3")
            .Where(re => re.MyEntityId == myEntity.Id)
            .ToList(); 
```

# html - HTML5 视频作为网页背景

> ID：10266130
> 
> 赞同：2
> 
> 时间：2012-04-22T07:41:43.750
> 
> 标签：html, video, background

我目前有一个视频循环作为我的网页背景，可以调用 mp4 或 ogg 或 webm 视频文件，具体取决于查看器使用的浏览器。在 chrome 和 IE 中，视频立即开始使用 mp4 文件，但在 Firefox 中，ogg 或 webm 视频文件大约需要 10 秒才能加载。然而，ogg 和 webm 文件的大小只有 mp4 的一半。为什么Firefox加载第一帧并在播放前等待加载？似乎很奇怪，它不会立即启动，尤其是因为它的大小只有 mp4 的一半？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-03T10:26:06.400

从 HTML5Doctor 检查这个解决方案：

> 通常 HTML5 音频和视频播放器将允许用户在媒体文件完全下载之前开始播放它（只要它确实有东西可以播放！）。有时，MP4 文件并非如此，浏览器会等待下载整个文件，然后才能播放。这是由于编码问题。
> 
> 有时 MP4 文件会使用位于媒体文件末尾而不是开头的文件索引（包含有关文件的信息，例如持续时间）进行编码。该索引包含浏览器提供渐进式下载所需的元数据。如果这个索引在最后，它对文件一无所知，因此必须等到它收到索引。
> 
> 如果您遇到这种情况，有一个由 Renaun Erickson 提供的名为 QTIndexSwapper 的简单修复程序，您可以将其下载到您的计算机并在文件上运行，它只需将索引移动到文件的开头并保存它。

# delphi - 如何获得透明的 SDL_Surface？

> ID：10266138
> 
> 赞同：1
> 
> 时间：2012-04-22T07:42:19.273
> 
> 标签：delphi, sdl, pascal

我正在尝试获得一个透明的 SDL_Surface （在其上粘贴半透明矩形），这就是我所做的：

```
surface := SDL_CreateRGBSurface(SDL_SWSURFACE, XMAX*TILE_SIZE,
YMAX*TILE_SIZE, BPP, 0, 0, 0, SDL_ALPHA_TRANSPARENT);
SDL_FillRect(surface, nil, SDL_MapRGBA(surface^.format, 0, 0, 0, 0)); 
```

这仍然不起作用，我得到的表面是黑色而不是透明的。任何想法？

奖励：为了避免多个半透明矩形相互重叠，有什么办法可以删除这些矩形，然后对新的矩形进行 blit（无需再次对背景进行 blitting ...）？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-04T17:50:48.680

From looking at the [docs for SDL_CreateRGBSurface](http://www.libsdl.org/cgi/docwiki.cgi/SDL_CreateRGBSurface), I think you need to replace `SDL_SWSURFACE` with `SDL_SRCALPHA`.

For the bonus part, you might try first to get hardware acceleration working... But if that's not an option and you're willing to spend some memory:

*   First, before drawing a rectangle, make a copy of the pixels underneath it.

*   To erase the topmost rectangle you simply re-blit the stored background image.

*   To erase any other rectangle, you re-blit its background, then redraw the overlapping portions of the rectangles on top of it from back to front.

# gson - GSON + HTC 欲望：冲突。可能的解决方案 jarjar.jar 导致错误

> ID：10266143
> 
> 赞同：1
> 
> 时间：2012-04-22T07:43:35.013
> 
> 标签：gson, android, jarjar

我正在尝试在 Android 应用程序中使用 GSON，但它会导致崩溃。经过一番阅读，HTC 似乎包含了 GSON，这会导致冲突。一种建议的解决方案是使用 jarjar.jar 重命名 gson 类来解决冲突。当我尝试这样做时，我收到此错误：

语法错误：第 1 行错误：[{\rtf1\ansi\ansicpg1252\cocoartf1038\cocoasubrtf360]

我正在执行的命令：

java -jar jarjar-1.2.jar 进程 rules.txt gson-2.1.jar myjson-2.1.jar

rules.txt：规则 com.google.gson.** com.google.myjson.@1

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-22T11:21:56.703

我在任何手机上使用 GSON 都没有问题。您面临哪些问题？

此外，您传递的 rules.txt 文件似乎实际上是一个 RTF 文件。如果您使用的是 Mac，请尝试将其再次保存为纯文本文件。

# c# - 在组合框中选择最后添加的列表项

> ID：10266145
> 
> 赞同：3
> 
> 时间：2012-04-22T07:44:04.440
> 
> 标签：c#, winforms, combobox

我使用组合框，不受 C# 中的数据源的限制。

```
cmbBox.Items.Add("apple");
cmbBox.Items.Add("orange");
cmbBox.Items.Add("banana"); 
```

现在我想将 SelectedIndex 设置为最终添加“香蕉”，但不能使用 cmbBox.SelectedIndex = cmbBox.Items.count -1; 由于组合框已排序！

请问有什么提示吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-27T12:05:21.393

好吧，我在参考文档后想通了。我应该做的就是捕获 cmbBox.Items.Add("something") 语句的返回值并将其设置为 cmbBox.SelectedIndex

```
nReturn = cmbBox.Items.Add("first");
...
nReturn = cmbBox.Items.Add("last");
cmbBox.SelectedIndex = nReturn; 
```

希望这对某人有所帮助。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-22T09:18:08.513

以下对我有用

```
ComboBox cb = new ComboBox();
cb.Sorted = true;
cb.SelectedIndex = cb.Items.Add("apple");
cb.SelectedIndex = cb.Items.Add("orange");
cb.SelectedIndex = cb.Items.Add("banana"); 
```

在选择最后一行`index = 1`之后`selected item = banana`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2022-01-10T07:30:24.697

很安静很容易。就用这个...

cb.SelectedIndex = cb.Items.Count - 1;

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-04-01T13:18:49.130

它甚至比这更简单。在您的情况下，列表的索引是“2”，因为列表是从零开始的，并且您添加了 3 个项目。因此，计算添加到列表中的项目数并减去 1。3 项，减 1 = 2。最后添加的项目的 selectedindex 为 2。

# php - php比较两个关联数组

> ID：10266148
> 
> 赞同：13
> 
> 时间：2012-04-22T07:45:06.607
> 
> 标签：php, compare, associative-array

我有这两个`associative arrays`

// 针数组

```
$a = array(
"who" => "you", 
"what" => "thing", 
"where" => "place",
"when" => "hour"
); 
```

// 干草堆数组

```
$b = array(
"when" => "time", 
"where" => "place", 
"who" => "you",
"what" => "thing"
); 
```

我想检查它是否与它精确`$a`匹配并且`b``key``value`

如果每个键和值`$a`在...中都完全匹配。`$b`我想将变量的值增加`$c`1，依此类推...

正如我们从上面看到的那样，有 3 个可能的匹配项......并且据说结果会使 的值增加`$c`3

`$c = "3";`

我希望有高手能帮助我...

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-04-22T07:47:19.400

## 编辑2

**OP 实际上用于[`array_intersect_assoc()`](https://www.php.net/manual/en/function.array-intersect-assoc.php)他们的特定用例。**（检查[评论](https://stackoverflow.com/questions/10266148/php-compare-two-associative-arrays/10266163?noredirect=1#comment13200932_10266163)）

最初的答案对他们的情况并没有真正有用！

* * *

您可以查看php的[**`array_diff_assoc()`**](https://www.php.net/manual/en/function.array-diff-assoc.php)函数或[**`array_intersect()`**](https://www.php.net/manual/en/function.array-intersect.php)函数。

## *编辑*

这是计算匹配值的示例：

```
<?php
  $a = array(
    "who" => "you", 
    "what" => "thing", 
    "where" => "place",
    "when" => "hour"
  );
  // the haystack array
  $b = array(
    "when" => "time", 
    "where" => "place", 
    "who" => "you",
    "what" => "thing"
  );
  $c = count(array_intersect($a, $b));
  echo $c;
?> 
```

[CODEPAD](http://codepad.org/RYo45dBO)链接。

# php - 任何人都可以建议在默认的zend框架项目中添加管理模块的分步指南吗？

> ID：10266149
> 
> 赞同：1
> 
> 时间：2012-04-22T07:45:17.290
> 
> 标签：php, zend-framework, zend-studio

我决定将 ZF 用于我的一个 PHP 项目。但是我对如何在我的网站上添加管理模块感到非常困惑？我读过一些像这样的文章 (http://www.amazium.com/blog/create-modular-application-with-zend) 和许多其他的。他们提出了一种不同的方式来做到这一点。**我想知道 Zend 是否有任何标准方法**（我相信他们知道几乎每个站点都需要一个管理模块）？

或者有人可以建议**一个关于如何在默认的zend框架项目中添加管理模块的分步指南。**

顺便说一句：我使用 zend studio 9.0 作为 IDE（如果重要的话）..

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-22T08:13:30.430

我假设 ZF 1.11：

在你的 application.ini 中确保这些行在这里（可能有点过头但它有效）：

```
resources.frontController.moduleDirectory = APPLICATION_PATH "/modules"
resources.frontController.moduleControllerDirectoryName = "controllers"
resources.frontController.params.prefixDefaultModule = ""
resources.modules = "" 
```

您的路径应如下所示：

```
/application
    /configs
    /controllers
    /forms
    /layouts
    /models
    /modules
        /admin
            /controllers
            /models
            /forms
            /views
                /filters
                /helpers
                /scripts
       Bootstrap.php //in your admin folder bootstrap extends Zend_Application_Module_Bootstrap
    /views
Bootstrap.php //application level bootstrap
/docs
/library
/public 
```

除了引导程序之外的路径要求可以通过运行 ZF Tool 命令来完成`zf create module admin`

要记住的真正重要的事情是每个模块都需要一个 Bootstrap.php 文件在它的根目录。这有助于（除其他外）自动加载器。

```
<?php
class Admin_Bootstrap extends Zend_Application_Module_Bootstrap {
    //put your code here
} 
```

这就是模块引导程序所需的全部内容。

[编辑]为控制器（例如管理员）选择不同的布局（创建第二个布局），简单的方法是在每个控制器中：

```
public function preDispatch() {

        $this->_helper->layout->setLayout('admin');
    } 
```

如果您需要更改大量控制器中的大量布局，您可能需要一个控制器插件（不是我的经验领域）。

# java - 如何在android中获取使用gps的已安装应用程序列表？

> ID：10266151
> 
> 赞同：1
> 
> 时间：2012-04-22T07:45:22.067
> 
> 标签：java, android

我有这个代码，它返回设备的所有已安装应用程序的列表：

```
PackageManager pm = this.getPackageManager();

Intent intent = new Intent(Intent.ACTION_MAIN, null);
intent.addCategory(Intent.CATEGORY_LAUNCHER);

List<ResolveInfo> list =pm.queryIntentActivities(intent,PackageManager.PERMISSION_GRANTED);
        for (ResolveInfo rInfo : list) {
            results.add(rInfo.activityInfo.applicationInfo.loadLabel(pm)
                    .toString());
            Log.w("Installed Applications", rInfo.activityInfo.applicationInfo
                    .loadLabel(pm).toString());
        } 
```

但是现在我只想在我的列表中获取那些使用 gps 服务的应用程序，据我所知，如果我可以过滤这些应用程序中获得的权限，那么我可以解决它，但不知道该怎么做。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-22T07:49:59.630

使用可以使用下面的代码片段:::

```
PackageManager packageManager=this.getPackageManager(); 
List<PackageInfo> applist=packageManager.getInstalledPackages(0);
Iterator<PackageInfo> it=applist.iterator();
while(it.hasNext()){
PackageInfo pk=(PackageInfo)it.next();
if(PackageManager.PERMISSION_GRANTED==packageManager.checkPermission(Manifest.permission.ACCESS_FINE_LOCATION, pk.packageName)) //checking if the package is having INTERNET permission
{
results.add(""+pk.applicationInfo.loadLabel(packageManager));
}
} 
```

# android - 我想创建一个有数字的圆圈？

> ID：10266157
> 
> 赞同：0
> 
> 时间：2012-04-22T07:46:14.027
> 
> 标签：android, box2d, andengine

我想在 Android andengine 中创建一个如下图所示的圆圈。它应该有 box2d 的主体。我怎样才能创建它？

![一只忙碌的猫](../Images/fe576830bf4b43d2d7d1c714d5143483.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-27T16:19:50.253

由于提供的答案与实际提出的问题完全无关，因此这里是实际答案：

1.  您可以简单地将文本实体附加到显示圆形的 Sprite。

2.  或者看看 BitmapTextureAtlasSourceDecorators： [https](https://github.com/nicolasgramlich/AndEngine/tree/GLES2/src/org/andengine/opengl/texture/atlas/bitmap/source/decorator) ://github.com/nicolasgramlich/AndEngine/tree/GLES2/src/org/andengine/opengl/texture/atlas/bitmap/source/decorator 。

    *   这个例子特别有用： [https ://github.com/nicolasgramlich/AndEngineExamples/blob/GLES2/src/org/andengine/examples/CanvasTextureCompositingExample.java](https://github.com/nicolasgramlich/AndEngineExamples/blob/GLES2/src/org/andengine/examples/CanvasTextureCompositingExample.java)

关于从实体创建主体，请看这里： [https ://github.com/nicolasgramlich/AndEngineExamples/blob/GLES2/src/org/andengine/examples/PhysicsExample.java#L179](https://github.com/nicolasgramlich/AndEngineExamples/blob/GLES2/src/org/andengine/examples/PhysicsExample.java#L179)

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-04-22T07:52:49.377

试试这个解决方案：

```
 public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);

        setContentView(demoview);
    }

    private class DemoView extends View{
        public DemoView(Context context){
            super(context);
        }

        @Override
        protected void onDraw(Canvas canvas) {
            super.onDraw(canvas);
            Paint p = new Paint();
            p.setColor(Color.RED);
            DashPathEffect dashPath = new DashPathEffect(new float[]{5,5}, (float)1.0);

            p.setPathEffect(dashPath);
            p.setStyle(Style.STROKE);
            canvas.drawCircle(100, 100, 50, p);
            Paint pp = new Paint();
            pp.setColor(Color.BLUE);
            canvas.drawText("kadir", 100, 100, pp);    
            invalidate();
        }
    }
} 
```

# entity-framework-4 - 我的 Code First 数据库在哪里？

> ID：10266160
> 
> 赞同：2
> 
> 时间：2012-04-22T07:46:44.783
> 
> 标签：entity-framework-4, ef-code-first

我有一个代码第一个 DbContext 应该是创建一个新的数据库，但是经过几次尝试，数据库不存在，并且我在`ctx.Statuses.ToList()`下面的代码中得到一个 Sequence contains no elements 错误：

```
static void Main(string[] args)
{
    var ctx = new EtbDbContext();
    EtbDbContext.Init();

    var s = ctx.Statuses.ToList();
    var l = ctx.Logins.ToList();
    var u = ctx.Users.ToList();
} 
```

该`Init()`方法说：

```
public static void Init()
{
    Database.SetInitializer(new DropCreateDatabaseAlways<EtbDbContext>());
} 
```

当我收到错误并在“立即”窗口中检查我的连接字符串时，它符合配置和预期：

> ?ctx.Database.Connection {System.Data.SqlClient.SqlConnection} .. ConnectionTimeout: 15 Database: "EtbCodeFirst" DataSource: "BRADY-PC" ServerVersion: 'ctx.Database.Connection.ServerVersion' 抛出了一个'System'类型的异常.InvalidOperationException' 状态：已关闭

数据源 BRADY-PC 上不存在这样的数据库，因此在尝试查询数据库之前我应该​​会遇到连接错误。我既生气又困惑，真的希望有人能在我今天回到 DB 第一开发之前提供帮助。

我还检查了我的（localdb），但仍然没有数据库。即使是流氓 EF 代码也没有其他地方可以创建该死的数据库。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-21T11:20:38.983

**在打开上下文之前**调用 .Init ...

```
static void Main(string[] args)
{
    EtbDbContext.Init();
    using (var ctx = new EtbDbContext())
    {
        var s = ctx.Statuses.ToList();
        var l = ctx.Logins.ToList();
        var u = ctx.Users.ToList();
    }
} 
```

# vb.net - 当数据库中有大量记录时，在vb.net中抛出错误“操作已被用户取消”

> ID：10266161
> 
> 赞同：0
> 
> 时间：2012-04-22T07:46:57.603
> 
> 标签：vb.net, db2

我想从 DB2 中检索记录并在 VB.net 的 DataGridView 中显示记录。如果记录数较少，则可以正常工作。

但如果数据库表有大量记录，则会抛出错误“操作已被用户取消”。谁能帮帮我...

我的代码是

```
 Dim strSQL As String

    Dim myConn, myCommand, rs As Object

    DataGridView1.DataSource = Nothing
    rs = CreateObject("ADODB.Recordset")
    Const DB_CONNECT_STRING = "Provider=MSDASQL.1;Persist Security Info=False;User ID=cpa5k;Data Source=NP1;DSN=NP1;UID=user;PASSWORD=pass;SDSN=Default;HST=sysplex.com;PRT=4101;Initial Catalog=QA1MM;"
    myConn = CreateObject("ADODB.Connection")
    myCommand = CreateObject("ADODB.Command")
    myConn.Open(DB_CONNECT_STRING)
    myCommand.ActiveConnection = myConn
    strSQL = " query "
    rs.Open(strSQL, myConn)
    Dim myDA As OleDb.OleDbDataAdapter = New OleDb.OleDbDataAdapter
    Dim myDS As DataSet = New DataSet
    myDA.Fill(myDS, rs, "MyTable")
    DataGridView1.DataSource = myDS.Tables(0)
    DataGridView1.Refresh()
    myConn.Close() 
```

显示的错误消息是：

> 有关调用即时 (JIT) 调试而不是此对话框的详细信息，请参阅此消息的末尾。
> 
> ****** *** ******异常文本******* *** ****** System.Runtime.InteropServices.COMException (0x800A0E80)：操作已被用户取消。*****
> 
>  *****在 Microsoft.VisualBasic.CompilerServices.LateBinding.InternalLateCall（对象 o，类型 objType，字符串名称，对象 [] 参数，字符串 [] 参数名，布尔 [] CopyBack，布尔 IgnoreReturn）
> 在 Microsoft.VisualBasic.CompilerServices.NewLateBinding.LateCall（对象Instance, Type Type, String MemberName, Object[] Arguments, String[] ArgumentNames, Type[] TypeArguments, Boolean[] CopyBack, Boolean IgnoreReturn) at WindowsApplication2.Form1.Button4_Click(Object sender, EventArgs e)
> at System.Windows.Forms .Control.OnClick(EventArgs e)
> 在 System.Windows.Forms.Button.OnClick(EventArgs e)
> 在 System.Windows.Forms.Button.OnMouseUp(MouseEventArgs 事件)
> 在 System.Windows.Forms.Control.WmMouseUp(Message& m, MouseButtons 按钮，Int32 点击）
> 在 System.Windows.Forms.Control.WndProc(Message& m)
> 在 System.Windows.Forms.ButtonBase.WndProc(Message& m)
> 在 System.Windows.Forms.Button.WndProc(Message& m)
> 在 System.Windows.Forms.Control .ControlNativeWindow.OnMessage(Message& m) 在 System.Windows.Forms.Control.ControlNativeWindow.WndProc(Message& m) 在 System.Windows.Forms.NativeWindow.Callback(IntPtr hWnd, Int32 msg, IntPtr wparam, IntPtr lparam)*****

 *****我正在运行的查询是：

```
SELECT   A.MVNDR_NBR                     
       ,A.MER_DEPT_NBR                  
      ,C.BYO_NBR                       
      ,B.MKT_NBR                       
      ,D.SKU_NBR                       
        ,A.STR_NBR                       
        ,B.BU_ID                         
        ,COALESCE(D.MIN_EFF_OH_QTY,0)    
        ,COALESCE(D.TRGT_OH_QTY,0)       
        ,D.THRH_BUOM_QTY_PCT             
        ,COALESCE(E.OH_QTY,0)            
        ,COALESCE(E.CHG_OH_QTY,0)        
        ,COALESCE(E.OO_QTY,0)            
        ,E.SKU_VLCTY_CD                  
        ,D.LEAD_TM_DAYS                  
        ,D.REV_TM_DAYS_CNT               
        ,COALESCE(D.SFTY_STK_DAYS,0)     
         ,D.ADJ_ASW_QTY                      
         ,D.MAX_INV_QTY                      
         ,D.TOT_PLNG_OVRD_DAYS               
         ,COALESCE(D.MIN_OH_QTY_DAYS,0)      
         ,F.CURR_DSVC_TYP_CD                 
         ,G.CURR_RMETH_CD                    
         ,F.DCHNL_DC_NBR                     
         ,COALESCE(F.BUY_MIN_QTY,0)          
         ,F.BUY_UOM_QTY                      
         ,COALESCE(E.CORD_ALLOC_QTY,0)       
         ,COALESCE(E.CORD_RSVD_QTY,0)          FROM     PO_AUTO_HORD_STRMV A               
         ,STR                B               
         ,MKT                C               
         ,MVNDR_SKU_STR      F               
         ,SKU_STR_LIST       G                
        ,PO_AUTO_HORD_PARM  D                   LEFT     OUTER JOIN                            
         STRSK_OH_EOO       E                   ON       E.STR_NBR        = D.STR_NBR           AND      E.SKU_NBR        = D.SKU_NBR           WHERE    A.PO_WK_DAY_NBR  = 4   AND      A.EFF_BGN_DT    <= '2011-09-22' AND      A.EFF_END_DT     > '2011-09-22'        AND      D.STR_NBR        = A.STR_NBR           AND      D.MVNDR_NBR      = A.MVNDR_NBR         AND      D.MER_DEPT_NBR   = A.MER_DEPT_NBR      AND      B.STR_NBR        = A.STR_NBR           AND      B.STR_OPEN_DT <= '2011-09-22'       AND      C.MKT_NBR        = B.MKT_NBR           AND      F.MVNDR_NBR      = A.MVNDR_NBR         AND      F.MER_DEPT_NBR   = A.MER_DEPT_NBR      AND      F.SKU_NBR        = D.SKU_NBR            AND      F.STR_NBR        = D.STR_NBR            AND      G.SKU_NBR        = D.SKU_NBR            AND      G.STR_NBR   
= D.STR_NBR            AND      F.OK_TO_ORD_FLG  = 'Y'                  AND      G.SKU_STAT_CD IN (100, 200)             AND      G.SOS_IND    IN ('V','B')           AND      F.CURR_DSVC_TYP_CD IN (1, 3)           ORDER BY A.MVNDR_NBR                            
        ,C.BYO_NBR                              
        ,B.MKT_NBR                              
        ,F.DCHNL_DC_NBR                         
        ,F.CURR_DSVC_TYP_CD                     
        ,D.SKU_NBR                              
        ,A.STR_NBR                               WITH  UR 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-24T13:24:07.220

我们以前遇到过这个问题，解决方法是在 DB2 Client 配置中增加 QUERYTIMEOUTINTERVAL 设置（或设置为零 - 这可能会产生其他问题）。

（参见[http://www.ibm.com/developerworks/forums/message.jspa?messageID=13894231](http://www.ibm.com/developerworks/forums/message.jspa?messageID=13894231)）

* * *

顺便说一句，HardCode 是对的，当 .NET 提供（上级，IMO）ADO.NET 和 OLEDB 时，真的没有理由使用 ADODB（尤其是通过 CreateObject 和后期绑定！）。*****

# java - 入队和出队程序运行只是无法弄清楚为什么输出不匹配

> ID：10266164
> 
> 赞同：1
> 
> 时间：2012-04-22T07:48:05.420
> 
> 标签：java, queue, command-line-arguments, deque

**这是帮助解决任何问题的 hwk 链接提示。请阅读以下内容以查看我的问题。这只是了解我的问题的信息**

[http://penguin.ewu.edu/cscd300/Spring_12/Assignments/prog2.html](http://penguin.ewu.edu/cscd300/Spring_12/Assignments/prog2.html)

使用队列和堆栈，以作业的形式，我给出了一个家庭作业，它基本上接受一个输入文件并编写一个命令参数来计算运行时间。我给出了如下所示的输入文件：

```
Media Player
100
Angry Birds
140 
```

然后我们在 jgrasp 中输入一个参数，例如“jobs.txt 50 1”，这意味着文本文件、时间片和延迟。（见上面的链接）这是基于上面显示的示例输入的程序执行示例：

```
C:\classes\cscd300\queues>java QueueSimulation jobs.txt 50 1

Time Slice: 50
Latency: 1

Adding Jobs to Queue
--------------------
Media Player, 100 milliseconds to execute
Angry Birds, 140 milliseconds to execute

Begin Job Processing
--------------------
Executing Media Player, 100 milliseconds remaining
Executing Angry Birds, 140 milliseconds remaining
Executing Media Player, 50 milliseconds remaining
*Media Player finished, total time to execute was 153 milliseconds
Executing Angry Birds, 90 milliseconds remaining
*Angry Birds finished, total time to execute was 244 milliseconds 
```

所有工作已完成！

这是我的代码：（下面有一个作业类、一个测试器和一个链接队列类，我用它来创建自己的入队和出队类（hwk 的一部分，我没有包括它，因为那是很多代码，只要知道入队和出队是方法）我的问题在测试仪中：

```
 public class Job {
    String jobName;
    int runTime;
    int remainTime;
    int startTime;

//constructures
    public Job() {
    jobName = "";
    runTime = 0;
    remainTime = 0;
    startTime = 0;
    }

    public Job(String _jobName, int _runTime) {
    jobName = _jobName;
    runTime = _runTime;
    remainTime = _runTime;
    startTime = 0;
    }
} 

public class QueueTester {
    public static void main(String[] args) {
        linkedQueue waitQ = new linkedQueue();
        linkedQueue runQ = new linkedQueue();
        String fileName = "no_fileName";
        int slice = 0, timeSW=0;
        if (args.length !=3) 
        throw new IllegalStateException("No command line arguments...\n");
        fileName = args[0];
        slice = Integer.parseInt(args[1]);
        timeSW = Integer.parseInt(args[2]); 
        System.out.println("\nTime Slice: " + slice);
        System.out.println("\nLatency: " +timeSW + "\n");
        Job job = null;
        try {
            FileInputStream fstream = new FileInputStream(fileName);
            DataInputStream in = new DataInputStream(fstream);
            BufferedReader br = new BufferedReader(new InputStreamReader(in));
            String strLine;
            System.out.println("adding jobs to queue");
            System.out.println("--------------------");
            boolean first = true;
            while ((strLine = br.readLine()) != null) {
                if (job == null)
                    job = new Job("", 0);

                strLine = strLine.trim();
                if (strLine.startsWith("#")) continue;
                if (strLine.length() == 0) continue;

                if (first) {
                    job.jobName = strLine;
                    first = false;
                } else {
                    job.runTime = Integer.parseInt(strLine);
                    job.remainTime = job.runTime;
                    job.startTime = 0;
                    System.out.println(job.jobName + ", " + job.runTime + "milliseconds to excecute.");
                    waitQ.enqueue(job); //enqueue
                    job = null;
                    first = true;
                }

            }
            in.close(); //close the input stream
        }
        catch (Exception e) {
            System.err.println("Error: " + e.getMessage());
        }
        Job waitJob;
        System.out.println("\nBegin Job Processing");
        System.out.println("---------------------");
        boolean done = false;
        int elapsed = 0;
        while (!done) {
            while(!waitQ.isEmpty()) {
                waitJob = (Job)waitQ.dequeue();//dequeue
                runQ.enqueue(waitJob); //enqueue
            }

            Job runJob;
            while (!runQ.isEmpty()) {
                runJob = (Job)(runQ.dequeue());
                System.out.println("excecuting [" +runJob.jobName + "] " + runJob.remainTime + "milliseconds remaining");
                if (slice < runJob.remainTime) {
                    runJob.remainTime -= slice;
                    if (runQ.isEmpty() && waitQ.isEmpty())
                        elapsed += slice;
                    else
                        elapsed += (slice + timeSW);

                    waitQ.enqueue(runJob);
                }else {
                    int num = runJob.runTime + timeSW + runJob.remainTime;
                    System.out.println("*" + runJob.jobName + ", total time to execute was " +num+ "milliseconds");

                    }
                }
            }
    }
} 
```

*我的程序有效，但我的输出结果如下。我的问题是为什么它输出不正确？如果您能帮助我更正我的测试程序类以使输出匹配，那就太棒了。只是帮助我找到我的错误或我需要添加的东西谢谢！:) **

```
Begin Job Processing
---------------------
excecuting [Media Player] 100milliseconds remaining
excecuting [Angry Birds] 140milliseconds remaining
excecuting [Media Player] 50milliseconds remaining
*Media Player, total time to execute was 151milliseconds
excecuting [Angry Birds] 90milliseconds remaining
excecuting [Angry Birds] 40milliseconds remaining
*Angry Birds, total time to execute was 181milliseconds 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-22T08:13:27.650

如果您在获得后查看代码，您会注意到您从未更新作业的运行时。从作业剩余时间中减去时间片后，您还应该更新作业已执行的时间。

“愤怒的小鸟”运行了 50 毫秒（当还剩 90 毫秒时），但是一旦您将该作业重新排入队列，您就会丢失该信息。

编辑：如果你基本上想让我给你答案。以下是您需要添加的缺失位。

```
runJob.runtime += slice 
```

（否则，您可以选择将每个作业的 elapsed 重新初始化为 0 并更改 `runJob.runtime += elapsed，因为 elapsed 已经包含延迟），然后再将作业排入队列。

# javascript - 在Javascript中拆分两行的字符串

> ID：10266166
> 
> 赞同：0
> 
> 时间：2012-04-22T07:48:18.420
> 
> 标签：javascript, html

在一个函数中，我得到一个字符串

```
'SHOWONLY_Clearance/Closeout
(21)' 
```

我想用'_'分割这个字符串。这是我的代码

```
function showResult(resStr)
{
    var substr = resStr.split('_');
    alert(substr[0]);
    alert(substr[1]);
} 
```

它不工作。任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-22T08:46:01.427

可能是您看不到导致换行的字符，它可能是换行符、回车符或换页符。尝试以下操作：

```
function showResult(resStr) {
    var re = /[\u000a\u000c\u000d]/g;
    var parts = resStr.replace(re, '').split('_');
    alert(substr[0] + '\n' + substr[1]);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-22T08:53:51.860

它工作正常，检查[小提琴](http://jsfiddle.net/gopi1410/yVV3s/)

# node.js - node.js connent modul错误信息

> ID：10266168
> 
> 赞同：0
> 
> 时间：2012-04-22T07:48:44.880
> 
> 标签：node.js

我使用 nodejs connent 模块代码作为示例。app.js 遵循这个：

```
var connect = require("connect");

connect(
  connect.static(__dirname + "/public"),
  // create a router to handle application paths
  connect.router(function(app) {
    app.get("/sayHello/:firstName/:lastName", function(req, res) {
      var userName = req.params.firstName + " " + req.params.lastName,
        html = "<!doctype html>" + "<html><head><title>Hello " + userName + "</title></head>" + "<body><h1>Hello, " + userName + "!</h1></body></html>";

      res.end(html); 
    });
  }) 
).listen(8000); 
```

node app.js 执行它，在控制台上打印错误消息：

```
node.js:201
        throw e; // process.nextTick error, or 'error' event on first tick
              ^
TypeError: Object function createServer() {
  function app(req, res){ app.handle(req, res); }
  utils.merge(app, proto);
  utils.merge(app, EventEmitter.prototype);
  app.route = '/';
  app.stack = [].slice.apply(arguments);
  return app;
} has no method 'router'
    at Object.<anonymous> (/Users/yangzhaojie/tech/nodejs/devsample/app4.js:6:10)
    at Module._compile (module.js:441:26)
    at Object..js (module.js:459:10)
    at Module.load (module.js:348:31)
    at Function._load (module.js:308:12)
    at Array.0 (module.js:479:10)
    at EventEmitter._tickCallback (node.js:192:40) 
```

操作系统：Mac OS X Lion 10.7.3

节点：0.6.11

内容：2.1.3

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-22T09:12:11.287

您必须使用旧教程或其他东西。路由器中间件前段时间从 Connect 中移除：[https ://github.com/senchalabs/connect/issues/262](https://github.com/senchalabs/connect/issues/262)

您可以使用像这样的另一个模块（[connect-router](https://github.com/crcn/connect-router)）或切换到 Express。

# xcode4 - Xcode重复行

> ID：10266170
> 
> 赞同：145
> 
> 时间：2012-04-22T07:49:36.097
> 
> 标签：xcode4, keyboard-shortcuts, xcode5, key-bindings, duplication

编辑菜单中有一个命令（默认*快捷*方式为`Duplicate``⌘</kbd>`D`), but it is (as [Halley](https://stackoverflow.com/users/1241690/halley) pointed out) meant for duplication in the Interface Builder part of Xcode.`

**那么，你如何（*轻松地*）在 Xcode 4 中复制一行？**

* * *

[Xcode 3 的相关问题](https://stackoverflow.com/questions/551383/xcode-duplicate-delete-line)（有一个有效的答案）......并且不适用于 Xcode 4。

* * *

## 为什么不直接复制粘贴？

因为它很乏味并且需要太多的手工杂技：

任**一（1）**：移动到行首然后按`⇧^E`，然后用复制`⌘C`，移动到新行，对齐光标，**最后**用粘贴`⌘V`；

或**(2)** : `^A`(设置光标到行首), `^SPACE`(设置标记), `^E`(设置光标到行尾), `⇧^W`( `Select to Mark`; 自定义), 复制, 换行等。

正如弗兰克施罗德（在[相关问题](https://stackoverflow.com/questions/551383/xcode-duplicate-delete-line)中）所说：

> 重点是不要使用 Cmd-C/Cmd-V 快捷方式。

* * *

## 回答 #1

> 赞同：189
> 
> 时间：2012-04-27T07:31:20.090

1.  转到包含力量黑暗面的文件夹：

    *   Xcode 4.2 或更早版本：`/Developer/Library/PrivateFrameworks/IDEKit.framework/Resources`
    *   Xcode 4.3 或更高版本：`/Applications/Xcode.app/Contents/Frameworks/IDEKit.framework/Resources`.
2.  打开`IDETextKeyBindingSet.plist`.

3.  添加一个新字典和一个新命令项，如下图所示（将它们命名为您想要的名称）： ![编辑 plist](../Images/a8cc5e1436c0c6a820728adf57398ad8.png)

    那是：`selectLine:, copy:, moveToEndOfLine:, insertNewline:, paste:, deleteBackward:`

4.  重新启动 Xcode 并转到 Preferences - Key Bindings，搜索您的命令。

5.  为命令设置组合键： ![键绑定](../Images/598ddfcc0303d76e4fd11ed61c0b365d.png)

6.  终于在 Xcode 上释放了键绑定的力量……尽情享受吧！

* * *

## 回答 #2

> 赞同：113
> 
> 时间：2015-12-10T06:51:26.447

# 2020 年更新

# 适用于 Xcode 版本：11.3.1 太

## 适用于 Xcode 版本：7.1、7.3、7.3.1、8.0、8.1、8.2、8.3、9.0、9.1、9.2、10.0、10.1、10.2.1

# 操作说明

1.  授予编辑以下文件的权限。大多数情况下，操作系统不允许您编辑文件。

对于 11.3.1 版本

```
sudo chmod 666 /Applications/Xcode.app/Contents/Frameworks/IDEKit.framework/Versions/A/Resources//IDETextKeyBindingSet.plist

sudo chmod 777 /Applications/Xcode.app/Contents/Frameworks/IDEKit.framework/Versions/A/Resources/ 
```

11.3以下版本

```
 sudo chmod 666 /Applications/Xcode.app/Contents/Frameworks/IDEKit.framework/Resources/IDETextKeyBindingSet.plist

sudo chmod 777 /Applications/Xcode.app/Contents/Frameworks/IDEKit.framework/Resources/ 
```

2.  通过编写以下命令来编辑文件：（如果可以，请在 sublime 或文本编辑器中打开它）

对于 11.3.1

```
open /Applications/Xcode.app/Contents/Frameworks/IDEKit.framework/Versions/A/Resources/IDETextKeyBindingSet.plist 
```

对于以下版本

```
open /Applications/Xcode.app/Contents/Frameworks/IDEKit.framework/Versions/A/Resources/IDETextKeyBindingSet.plist 
```

3.  附加以下 xml 片段：

```
<key>custom</key>
<dict>
    <key>Duplicate Current Line</key>
    <string>moveToBeginningOfLine:, deleteToEndOfLine:, yank:, insertNewline:, moveToBeginningOfLine:, yank:</string>
    <key>Duplicate Lines</key>
    <string>selectLine:, copy:, moveToEndOfLine:, insertNewline:, paste:, deleteBackward:</string>
    <key>Delete Line</key>
    <string>selectLine:, deleteBackward:</string>
</dict> 
```

* * *

# 截图

[![在此处输入图像描述](../Images/3101134ee71a5f6687bac442c56ab6f4.png)](https://i.stack.imgur.com/3yHeo.png)

并重新启动 Xcode 并转到`Preferences - Key Bindings`，搜索我们键入的命令（重复行和重复当前行）。

[![在此处输入图像描述](../Images/ce09a5c3020dbb93a922c72fb8228549.png)](https://i.stack.imgur.com/9YKVp.png)

就是这样。

对于unix人来说： -

```
sudo chmod 755 /Applications/Xcode.app/Contents/Frameworks/IDEKit.framework/Versions/A/Resources/ 
```

* * *

## 回答 #3

> 赞同：27
> 
> 时间：2016-12-13T12:40:57.420

好的，我想出了这个：

XCode 11 的版本：

```
selectParagraph:, delete:, undo:, moveRight:, yankAndSelect: 
```

*   不触摸剪贴板
*   适用于多行
*   选择添加的行，因此可以多次使用而无需重新选择
*   XCode 11 中的固定选择
*   撤消效果更好

由于我在每次 XCode 更新后应用此更改，因此我为此制作了一个脚本。可能它会造成一些损害，但我试图让它相对安全。它制作文件的副本，然后使用 perl 将 line 替换为其副本和附加命令。需要将 XCode 安装在`/Applications/Xcode.app`

```
cp /Applications/Xcode.app/Contents/Frameworks/IDEKit.framework/Resources/IDETextKeyBindingSet.plist ~/Desktop/IDETextKeyBindingSet.plist; sudo perl -pi -e 's/\<string\>selectWord:\<\/string>/'$'\<string\>selectWord:\<\/string\>\n\t\t\<key\>Duplicate Selection\<\/key\>\n\t\t\<string\>selectParagraph:, delete:, undo:, moveRight:, yankAndSelect:\<\/string>/g' /Applications/Xcode.app/Contents/Frameworks/IDEKit.framework/Resources/IDETextKeyBindingSet.plist 
```

旧版本（我不确定新版本是否与旧版本兼容，所以我会保留在这里）：

```
selectParagraph:, delete:, yank:, moveToBeginningOfLine:, setMark:, yank:, moveToBeginningOfLine:, moveLeft:, selectToMark: 
```

和旧版本的脚本以避免手动文件编辑：

```
cp /Applications/Xcode.app/Contents/Frameworks/IDEKit.framework/Resources/IDETextKeyBindingSet.plist ~/Desktop/IDETextKeyBindingSet.plist; sudo perl -pi -e 's/\<string\>selectWord:\<\/string>/'$'\<string\>selectWord:\<\/string\>\n\t\t\<key\>Duplicate Selection\<\/key\>\n\t\t\<string\>selectParagraph:, delete:, yank:, moveToBeginningOfLine:, setMark:, yank:, moveToBeginningOfLine:, moveLeft:, selectToMark:\<\/string>/g' /Applications/Xcode.app/Contents/Frameworks/IDEKit.framework/Resources/IDETextKeyBindingSet.plist 
```

编辑：次要修复编辑2：更改为段落选择编辑3：为XCode 11添加了版本

* * *

## 回答 #4

> 赞同：17
> 
> 时间：2013-11-20T15:13:32.420

今天我为 Xcode 5 编写了一个非常小的插件，可以删除和复制行和选择。

您可以从我的 GitHub 存储库下载它： [XcodeKit 插件 - https://github.com/ptfly/XcodeKit](https://github.com/ptfly/XcodeKit)

* * *

## 回答 #5

> 赞同：15
> 
> 时间：2016-03-30T17:29:13.460

**编辑：2020 年 7 月 12 日** 再次更新到 Xcode 11.5 后，我从文件中`duplicate line`输入的密钥消失了。`plist`我不得不再次添加它。键绑定仍然存在。

**编辑：2019 年 9 月 17 日** 再次更新到 Xcode 10.3 后，我从文件中`duplicate line`输入的密钥消失了。`plist`我不得不再次添加它。键绑定仍然存在。

**编辑：2019 年 5 月 28 日** 再次更新到 Xcode 10.2 后，我`duplicate line`的文件中的密钥条目`plist`消失了。我不得不再次添加它。键绑定仍然存在。

**编辑：2018 年 12 月 23 日** 更新到 Xcode 10.1 后，我的所有快捷方式再次损坏。但不同的是，在更新 plist 文件以进行行重复之后，我不必定义我的键绑定，它们已经存在。奇怪的。

**编辑：2018 年 10 月 14 日** Xcode 10：Apple 高层非常喜欢复制/粘贴，并确保在每个版本的 Xcode 更新中，从每个人的安装中删除行重复。我们开发人员一直对 Xcode 中发生的这种胡说八道感到非常沮丧，因为 Xcode 是唯一没有行重复选项的 IDE。我刚刚更新到 Xcode 10，正如您猜到的那样 - 我的所有快捷键都与我的行复制功能一起被删除。但是，它可以像原始答案一样修复。这次的细微差别是您将需要以下行：

```
<key>Duplicate Current Line</key>
<string>selectLine:, copy:, moveToBeginningOfLine:, paste:, moveToEndOfLine:</string> 
```

**编辑：** Xcode 9：我不得不重做我的快捷方式以及行重复和删除，但好在现在您可以再次编辑 IDETextKeyBindingSet.plist。当他们发布这个版本时，这个高高在上的苹果公司一定是在度假。

**编辑：** Xcode 8：Buggy，您根本无法修改 IDETextKeyBindingSet.plist 文件。Xcode 在启动时重置它。这位 Apple 的高手真的决心让我们使用复制/粘贴，而不是像所有其他 IDE 中那样简单的行复制。

**编辑：** Xcode 7.1 仍然没有行复制和删除的快捷方式。这是我使用过的唯一一个没有此类快捷方式的 IDE。如果没有这两条关键捷径，我无法想象开发人员的生活。

这是如何完成的：

首先我们需要修改一个位于 Xcode.app 包中的 plist 文件（需要 sudo 来编辑）

`/Applications/Xcode.app/Contents/Frameworks/IDEKit.framework/Resources/IDETextKeyBindingSet.plist`

然后查找`<key>Insertions and Indentations</key>`并在`<dict>`标签下添加以下内容：

```
<key>Insert New Line Below</key>
<string>moveToEndOfLine:, insertNewline:</string>
<key>Insert New Line Above</key>
<string>moveUp:, moveToEndOfLine:, insertNewline:</string>
<key>Duplicate Current Line</key>
<string>selectLine:, copy:, moveToEndOfLine:, insertNewline:, paste:, deleteBackward:</string> 
```

然后在标签`<key>Deletions</key>`下的部分中找到和这些：`<dict>`

```
<key>Delete Current Line</key>
<string>selectLine:, delete:</string>
<string>selectLine:, delete:</string> 
```

[![在此处输入图像描述](../Images/58e0c8298fe2b91e5cd621fc103b5b00.png)](https://i.stack.imgur.com/UqlRv.png)

现在打开/重新启动 Xcode，转到 Preferences 并转到“Key Bindings”选项卡。使用搜索栏过滤并查找新的快捷方式。然后在快捷方式描述前面单击，为其分配您喜欢的快捷方式。确保您的快捷方式与现有快捷方式不冲突。

[![在此处输入图像描述](../Images/074d7641292a2395ac59bf3e01379171.png)](https://i.stack.imgur.com/k3AZH.png)

* * *

## 回答 #6

> 赞同：14
> 
> 时间：2012-11-13T22:04:57.237

@Hailei 的回答非常好，但不幸的是，它破坏了剪贴板内容（让它填充了重复行的内容），这正是我试图避免的手动复制/粘贴方法的一部分.

因此，我将命令序列更改为：

```
moveToBeginningOfLine:,
deleteToEndOfLine:,
yank:,
insertNewline:,
moveToBeginningOfLine:,
yank: 
```

如果您设置了 2 以外的内容，则2`yank:`可能无法按预期工作，但我很确定这是默认设置，您必须做一些重要的工作来更改它（它需要添加一个条目）。`NSTextKillRingSize``1``1``~/Library/Preferences/.GlobalPreferences.plist`

* * *

## 回答 #7

> 赞同：9
> 
> 时间：2013-06-17T06:28:06.727

为什么要复制一行？复制整个段落更好。我的顺序：

**复制当前段落**

```
selectParagraph:,
delete:,
yank:,
moveToBeginningOfParagraph:,
yank:,
moveUp:,
moveToEndOfParagraph: 
```

**删除当前段落**

```
selectParagraph:,
delete:,
moveUp:,
moveToEndOfParagraph: 
```

在 Xcode 4.6 中运行良好

* * *

## 回答 #8

> 赞同：9
> 
> 时间：2013-10-09T16:56:01.720

我想知道为什么没有人提到使用`⌘</kbd> along with the arrow keys (`←</kbd>`↑</kbd>`→</kbd>`↓</kbd>) to both move the cursor and to select entire lines (by adding `⇧</kbd>).``````

我通过使用将光标移动到行首来定期复制整行（重复）`⌘</kbd>+`←</kbd> (instead of `ctrl`+`A`) and then use `⌘</kbd>+`⇧</kbd>+`→</kbd> (instead of `ctrl`+`⇧</kbd>+`E`) to select the whole line to the end and then copy/paste.``````

我遇到了其他似乎没有人使用这些键盘快捷键的线程。它们在 OS X 中是全局的，我一直在使用它们！少得多的手工杂技;)

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2012-08-24T19:05:29.513

我会考虑将命令序列修改为：

```
selectLine:,
copy:,
moveToEndOfLine:,
insertNewline:,
deleteToBeginningOfLine:,
paste:,
moveToBeginningOfLine:, 
deleteBackward: 
```

添加`deleteToBeginningOfLine`保持重复行的缩进。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2013-04-06T21:04:17.777

insertLineBreak 至少需要我在新行上制作副本，没有它我在同一行上得到副本

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2017-12-14T15:27:31.360

我在 MacOS Sierra 和 Xcode 9 上解锁 .plist 文件时遇到了很大的麻烦，即使 @Tim 的决定对我也不起作用。如果您有同样的问题，请转到终端并执行以下操作：

```
cd /Applications/Xcode.app/Contents/Frameworks/IDEKit.framework/Versions/A/Resources/
sudo chmod -R 777 *
nano IDETextKeyBindingSet.plist 
```

[此处](https://apple.stackexchange.com/questions/68646/how-do-i-unlock-a-plist-file-so-that-i-can-change-it#68648)还介绍了其他几种可能的方法。

然后在 nano 编辑器中单击`^W`并键入“插入”以跳转到“插入和缩进”部分。在`<dict>`标签下粘贴这个 xml 片段：

```
<key>Duplicate line</key>
<string>selectLine:, copy:, moveToEndOfLine:, insertNewLine:, paste:, deleteBackward:</string> 
```

按`control + X`, 然后`Y`, 然后`Enter`将文件保存在 nano 编辑器中。

UPD：我想出了一个更好的决定，它在复制之前添加了一个额外的行（当你想要复制一个在它下面有另一行的行时很有用）：

```
<key>Duplicate line</key>
<string>selectLine:, copy:, moveToEndOfLine:, insertLineBreak:, moveUp:, paste:, moveToBeginningOfLine:</string> 
```

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2013-04-03T04:02:52.257

这是我的 IDETextKeyBindingSet.plist 中的 Delete ( `CTRL`+ `D`) 和 Duplicate ( `CMD`++ `SHIFT`)`D`条目。（在 /Applications/Xcode.app/Contents/Frameworks/IDEKit.framework/Versions/A/Resources 中）

我只是在 Xcode 4.6.1 中设置了这些（基于上面和其他地方的 user570753 的回答）

```
 <key>Custimozed</key>
<dict>
    <key>Delete Current Line</key>
    <string>deleteToBeginningOfLine:, moveToEndOfLine:, deleteToBeginningOfLine:, deleteBackward:, moveDown:, moveToBeginningOfLine:</string>
    <key>Duplicate Current Line</key>
    <string>selectLine:, copy:, moveToEndOfLine:, insertNewline:, deleteToBeginningOfLine:, paste:, moveToBeginningOfLine:, deleteBackward:</string>
</dict> 
```

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2017-12-18T15:54:24.020

只是为了补充海雷的回答，最适合我的命令是：

```
selectLine:, copy:, moveRight:, moveLeft:, insertNewline:, paste:, deleteBackward: 
```

对我来说，他建议的命令是在下面两行复制所需的行。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2020-01-05T11:29:50.157

至于 Xcode 11，以上都不适合我。第一个答案有一个奇怪的行为，因为它在下一行之后插入该行。但是，以下答案对我有用。

```
<key>Duplication</key>
<dict>
    <key>Duplicate Current Line</key>
    <string>moveToBeginningOfLine:, deleteToEndOfLine:, yank:, insertNewline:, moveToBeginningOfLine:, yank:</string>
    <key>Duplicate Lines</key>
    <string>selectLine:, copy:, moveToEndOfLine:, insertNewline:, paste:, deleteBackward:</string>
    <key>Delete Line</key>
    <string>selectLine:, deleteBackward:</string>
</dict> 
```

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2016-06-05T21:35:24.947

任何想要在 XCode 中匹配 sublime 的**duplicateLineUp**和**duplicateLineDown**的 sublime 文本用户，请将以下内容添加到您的**IDETextKeyBindingSet.plist**文件中

```
<key>Line Duplications</key>
<dict>
    <key>Duplicate Current Line Above</key>
    <string>selectLine:, copy:, moveToEndOfLine:, insertNewline:, paste:, deleteBackward:, moveUp:</string>
    <key>Duplicate Current Line Below</key>
    <string>selectLine:, copy:, moveToEndOfLine:, insertNewline:, paste:, deleteBackward:</string>
</dict> 
```

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2017-06-21T14:41:34.233

如果其他人被拒绝编辑 IDETextKeyBindingSet.plist 您可以通过以下方式授予自己读/写权限：

```
sudo chmod 777 /Applications/Xcode.app/Contents/Frameworks/IDEKit.framework/Versions/A/Resources/IDETextKeyBindingSet.plist 
```

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2018-03-27T10:04:28.963

```
<key>Duplicate Lines</key>    
<string>selectLine:, copy:, moveToBeginningOfLine:, paste:</string> 
```

支持重复行。（这适用于 Xcode 9.2）

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2021-10-14T09:23:10.753

对于 XCode 13。

将“Vim 模式”映射到 ^⌘V。

然后：^⌘V yyp ^⌘V

# c# - 在 C# 中禁用异常

> ID：10266174
> 
> 赞同：-3
> 
> 时间：2012-04-22T07:50:22.950
> 
> 标签：c#, exception

我有 c# 程序，这个 Get Sql Query From Input 并执行这个。有时，此查询包含执行查询后返回***“除零异常”***的任何单词。

**我想在**执行查询之前禁用*SqlException* 并检查其他输入的单词，然后启用它。

 *** * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-22T07:52:59.080

您正在寻找的功能称为**Try...Catch**。

[在 MSDN 上](http://msdn.microsoft.com/en-us/library/0yd65esw%28v=vs.80%29.aspx)阅读它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2018-07-29T03:07:09.437

当他不寻找 try and catch 时，他可能正在寻找#pragma 来禁用异常

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-06-03T14:45:52.793

很多时候，根本不需要例外。

例如，如果我打开一个文件并使用错误的名称，或者它的繁忙或其他什么，

操作的返回为空。这对我来说是无用的，我要求了一些东西，但它没有用。

但是不，我必须用各种有趣的业务来围绕我的代码。

```
StreamReader streamReader=new StreamReader(filename);
if (streamReader==null)
  Console.WriteLine("File Not Ready To Be Read {0}!",filename)
else
  {
  //go on with your business
  } 
```

//与这个编译的对比只是因为我不得不什么都不做，什么也不做，最后做我所关注的事情。使用系统；使用 System.IO；

```
class ExceptionHandling
{
    public static void Main(string[] args)
    {
        StreamReader streamReader = null;
        try
        {
        streamReader = new StreamReader("C:\\bin\\C#\\readfil1e\\data.txt");//or @"c:\bin\c#\readfile\data.txt");
        }
        catch(Exception ex)
        {
        }
        finally
        {
        if (streamReader == null)
          {
            Console.WriteLine("FILE NOT READABLE");
            Console.ReadLine();
          }
        else
          {
          Console.WriteLine(streamReader.ReadToEnd());
          Console.ReadLine();
          streamReader.Close();
          }
        }//finally

    }
} 
```**

# android - 如何从 Android GPS 位置获取准确的时间戳

> ID：10266175
> 
> 赞同：6
> 
> 时间：2012-04-22T07:50:30.923
> 
> 标签：android, time, gps, location

我正在尝试在我的 requestLocationUpdates 中使用 GPS_PROVIDER 在位置侦听器上使用 location.getTime 获取位置的 GPS 时间。我期望提供的时间是 GPS 时钟的时间 - 精确到十亿分之一秒，但四舍五入到毫秒。我得到的取决于平台，但肯定不是我所期望的。
在 SGS 11 - Android 2.3.3 上，返回值始终为精确秒，毫秒部分始终为 0.000。根据我使用 GPS 的经验，在我看来，GPS 的每次轮询都不太可能恰好在整个第二个时间间隔内发生。
在 HTC-A7275 Android 2.3.3 上 - 我正在获取手机的系统时间，当然不是 GPS 时间。
我通过弄乱手机的时间并检查位置时间来确认这些发现。
SGS 11 上 NMEA 语句中的时间戳提供为 3 位小数秒，但在 HTC 上，它们都是 xxx.0。使用 NMEA 的问题在于，从 MNEA 获取日期和时间以及完整位置真的很麻烦：只有在 GPGGA 句子中才有高度，但它没有日期戳，所以在 UTC 午夜前后变得很棘手。
我正在寻找精确的时间——最好是我的曲目记录器的毫秒级，这样我就可以可靠地比较来自不同玩家的曲目。有没有人在这方面做更多的工作？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-22T10:44:43.333

昂贵的 GPS 单元使用“每秒脉冲”协议来实现亚毫秒级的精度，但是我还没有听说过这种协议或接口可用于我们手机中的廉价 GPS 接收器。因此，您可以通过 GPS 消息实现的最佳精度在 1-2 秒范围内。

Re:NTP 在 Android 上，它是更好的解决方案，但不太可能在当代无线网络上实现超过 50-100 毫秒的时钟精度。

# php - 根据字段值计算 num_rows

> ID：10266177
> 
> 赞同：2
> 
> 时间：2012-04-22T07:50:41.813
> 
> 标签：php, mysql

*实际问题比帖子标题复杂得多：S

假设我有桌子

```
ID | vote_id |  vote_type |  vote_user

1  ----  2  -----   up -------    Tom
2  ----  3  -----   up -------    John
3  ----  3  -----   down -----    Harry
4  ----  4  -----   up -------    Tom
5  ----  2  -----   down -----    John
6  ----  3  -----   down -----    Tom 
```

所以我想做的是

1.  通过特定的**vote_id查询表**
2.  然后从 1 的查询中统计有多少人投**了**赞成票，有多少人投**了反对票**
3.  然后我还想检查**John**是否为该 vote_id 投票。

而我的做法是。

```
$up=0;
$down=0;
$voted="no"; 
$r=mysql_query("SELECT*FROM table_name WHERE vote_id == 3");

 while($row=mysql_fetch_array($r){
   if($row["vote_type"]=="up"){ $up++;}else{$down++;}
   if($row["vote_user"=="John"){ $voted="yes";}
 } 
```

**但是有没有一种方法（等效代码）可以在不使用 WHILE LOOP 的情况下执行此操作，**因为实际表可能非常大，因此运行 while 循环可能非常详尽：S

**编辑** 我可以使用单个查询吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-22T07:57:42.790

使用两个单独的查询：

**计算所有选票**：

```
 `SELECT vote_type, COUNT(*) AS amount
    FROM table_name
    WHERE vote_id = 3
    GROUP BY vote_type` 
```

`将返回最多两行：`

 ````
vote_type | amount
----------+--------
up        | 1
down      | 2 
```

**找出约翰是否投票**：

```
 `SELECT vote_type
    FROM table_name
    WHERE vote_id = 3
    AND vote_user = 'John'` 
```

`将根据 John 的投票方式返回包含或`up`的行。假设他只能投票一次……`down``NULL``

 `请注意，添加索引`vote_type`可能`vote_user`会提高性能。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-22T08:11:37.263

在单个查询中

```
Select
  sum(case when vote_type = 'up' then 1 else 0 end) as up,
  sum(case when vote_type = 'down' then 1 else 0 end) as down,
  sum(case when vote_user = 'john' then 1 else 0 end) as john
from
  yourTable
where
  vote_id = 3 
```

或总和的任何变化（情况何时）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-22T07:55:55.740

您可以运行此查询来为您提供针对特定 vote_id 的上下投票表。

```
select vote_type, COUNT(*) from votes where vote_id = 2 AND group by vote_type 
```

我会运行另一个查询来检查 John 是否投票支持该 vote_id

```
select count(*) from votes where vote_id = 2 AND vote_user = 'John' 
`````

# html - 960gs 用于智能手机

> ID：10266178
> 
> 赞同：0
> 
> 时间：2012-04-22T07:50:49.193
> 
> 标签：html, css, smartphone, 960.gs

我正在使用 960 网格系统为我的应用程序设计 html 页面。在设计时，我在想，如果存在智能手机优化版本的 960 或类似的网格系统。然后我也更容易支持智能手机。

有人对智能手机的 960 gs 有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-22T09:12:25.923

[http://adapt.960.gs/](http://adapt.960.gs/)看起来它会给你你需要的功能。您仍然可以使用网格系统，但随着用户分辨率的变化，它将加载到正确的样式表中。一个 JavaScript 解决方案，而不仅仅是 CSS

# mysql - 如何在 MySQL 中跨多个表检索匹配记录

> ID：10266180
> 
> 赞同：2
> 
> 时间：2012-04-22T07:50:53.897
> 
> 标签：mysql, rows

我有两个相同的表，例如：

```
table1
col1    col2    col3    col4    col5

table2
col1    col2    col3    col4    col5 
```

我想比较表 1 和表 2，并在 2 个表之间找到相同的行（col1、col2、col3、col4 等）。

我认为我们需要使用 vtable 或类似的东西..

我试过

```
SELECT * FROM TABLE1 WHERE COL1, COL2, COL3, COL4 IN 
        (SELECT COL1, COL2, COL3, COL4 FROM TABLE2); 
```

它不起作用..请帮助:)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-22T08:08:34.287

```
SELECT * 
FROM TABLE1 t
WHERE EXISTS
      ( SELECT *
        FROM TABLE2 tt
        WHERE (COL1, COL2, COL3, COL4) 
            = (t.COL1, t.COL2, t.COL3, t.COL4)
      )
; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-22T08:04:30.540

Oracle 语法，我确信在 MySql 中几乎相同：

```
 SELECT *
   FROM TABLE1, TABLE2
  WHERE TABLE1.COL1 = TABLE2.COL1
    AND TABLE1.COL2 = TABLE2.COL2
    AND TABLE1.COL3 = TABLE2.COL3
    AND TABLE1.COL4 = TABLE2.COL4 
```

可能有一种更优雅、更聪明的方法，但它会找到你的重复项。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-22T08:05:24.160

怎么样：

```
SELECT table1.* FROM table1
  INNER JOIN table1 ON table2.col1 = table1.col1
  WHERE table1.col2 = table2.col2 AND table1.col3 = table2.col3
    AND table1.col4 = table2.col4 AND table1.col5 = table2.col5 
```

# objective-c - 如何使用多约束配置 NSPredicate

> ID：10266181
> 
> 赞同：0
> 
> 时间：2012-04-22T07:50:57.437
> 
> 标签：objective-c, core-data, nspredicate

现在我有一个过滤器类，例如：

```
@interface Filter:NSObject {
    NSString *a,
    NSString *b;

    BOOL aisset;
    BOOL bisset;
} 
```

我有一个从核心数据中获取对象的功能，例如：

```
(NSArray *)findObjs:(Filter *)filter; 
```

如何实现这个功能？对于这种情况，我知道答案：

```
...
if (!aisset && !bisset) {
}
else if (aisset && !bisset) {
    predicate = [NSPredicate predicateWithFormat:@"a==%@", a];
}
else if (!aisset && bisset) {
    predicate = [NSPredicate predicateWithFormat:@"b==%@", b];
}
else if (aisset && bisset) {
    predicate = [NSPredicate predicateWithFormat:@"a==%@ AND b==%@", a, b];
}
... 
```

但是如何处理三个变量，例如a，b，c？

我尝试过这种方式：

```
...
NSString *predicateStr = @"";
if (aisset) ...
if (bisset) ...
if (cisset) ...
predicate = [NSPredicate predicateWithFormat:@"%@", predicateStr];
... 
```

但是如果我使用这段代码运行，我会得到一个错误：'Unable to parse the format string "%@"'。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-22T08:09:03.090

你可以使用`predicate = [NSPredicate predicateWithFormat:@"%K == %@", predicateStr,valueToCheck];`

如果要结合这些条件，您可以使用`appendFormat`.

# 更新

你应该使用`NSCompoundPredicate`. 它让你结合这些谓词

```
NSMutableArray *subpredicates = [NSMutableArray array];

 if (aisset)
 [subpredicates addObject:[NSPredicate predicateWithFormat:@"a==%@", a]];
if (bisset)
 [subpredicates addObject:[NSPredicate predicateWithFormat:@"b==%@", b]];
...
NSPredicate *finished = [NSCompoundPredicate andPredicateWithSubpredicates:subpreds];//Your final predicate 
```

# eclipse - 将 Eclipse Indigo 用于 JSF 2.0 项目

> ID：10266182
> 
> 赞同：0
> 
> 时间：2012-04-22T07:51:11.560
> 
> 标签：eclipse, jakarta-ee, jsf-2, jstl, eclipse-indigo

我计划在 Eclipse Indigo 中做一个 JSF 2.0 项目。但是，在 HelloWorld 项目中，我遇到了一个问题。我已经包含了所有必需的库，但是服务器没有识别一些 jstl 类。有关更多信息，请查看以下快照，如果有人知道解决方案，请尽快回复![在此处输入图像描述](../Images/9133b2b9ad2077c4ef0f9648666f4a20.png)。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-22T09:26:36.943

尝试使用较新版本的 mojarra ..（您使用的是 2.0.0）从这里获取

[JSF 莫哈拉 2.1.7](https://maven.java.net/content/repositories/releases/org/glassfish/javax.faces/2.1.7/javax.faces-2.1.7.jar)

# iphone - 在 IOS 中将 NSArray 转换为 NSstring

> ID：10266190
> 
> 赞同：0
> 
> 时间：2012-04-22T07:53:01.293
> 
> 标签：iphone, ios, nsstring, nsarray

我有一个来自应用程序委托的名为 delegate.allSelectedVerseEnglish 的 NSMutableArray，它有一些值，我能够获取数组计数，并且可以在 UITableView 中正确显示它。但现在我想在文本视图中显示它。我的 UITableView 代码是这样的

```
- (NSInteger)numberOfSectionsInTableView:(UITableView *)tableView {
    return 1;
}

// Customize the number of rows in the table view.
- (NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section {

        return [delegate.allSelectedVerseEnglish count];
}

- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath {

    static NSString *CellIdentifier = @"Cell";
    readCell *cell = (readCell *)[tableView dequeueReusableCellWithIdentifier:CellIdentifier];

    if (cell == nil) {
        cell = [[[UITableViewCell alloc] initWithStyle:UITableViewCellStyleSubtitle reuseIdentifier:CellIdentifier] autorelease];
        NSArray *nib = [[NSBundle mainBundle] loadNibNamed:@"readCell" owner:self options:nil]; 
        cell = [nib objectAtIndex:0]; 

        cell.label.text = [NSString stringWithFormat:@"%d",indexPath.row+1];
        cell.textLabel.text =  [NSString stringWithFormat:@"  %@",[delegate.allSelectedVerseEnglish objectAtIndex:indexPath.row]];
        cell.textLabel.font = [UIFont fontWithName:@"Georgia" size:19.0];
    }
} 
```

它在单元格中显示正确的值，但我只需要在 textview 中显示这个 delegate.allSelectedVerseEnglish 数组，例如`textview.text = delegate.allSelectedVerseEnglish;`. 怎么做？

提前致谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-22T07:54:44.850

取决于您希望如何格式化文本。
出于记录目的，我会使用`[delegate.allSelectedVerseEnglish description];`while 向用户展示`[delegate.allSelectedVerseEnglish componentsJoinedByString:@"\n"];`可能合适的东西。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-22T07:57:21.577

你可以这样使用 -

```
NSString *stringToShow = nil;
for (NSString *stringObj in delegate.allSelectedVerseEnglish) {
    stringToShow = [stringToShow stringByAppendingString: [NSString stringWithFormat:@"%@",stringObj]];
}
cell.textLabel.text = stringToShow; 
```

# r - 在 3 维中绘制 SVM

> ID：10266195
> 
> 赞同：5
> 
> 时间：2012-04-22T07:54:03.713
> 
> 标签：r, machine-learning, data-visualization, svm

如何为 3D 数据集（使用 x、y、z 坐标）绘制 SVM？

我可以使用 绘制 3D 数据`scatterplot3d(data)`，但是使用 svm 结果时它是如何工作的？

编辑：从评论复制到答案。这应该是 OP 的编辑：

3组数据

```
data[1:10,1], data[1:10,2] and data[1:10,3] represent genuine data.
data[11:15,1], data[11:15,2] and data[11:15,3] represent userA data.
data[16:20,1], data[16:20,2] and data[16:20,3] represent userB data. 
```

然后我使用以下方法执行 SVM：

```
 labels <- matrix( c(rep(1,10), rep(-1, 10)) )
 svp <- ksvm(data,labels, type="C-svc" , kernel='rbfdot', C=0.4, 
               kpar=list(sigma=0.2)) 
```

然后我有一个数据测试：

```
 dataTest[1,1], dataTest[1,2], dataTest[1,3] 
 predLabels = predict(svp,dataTest) 
```

编者注：最后一点看起来有点奇怪，只有 3 个数据点。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-04-22T18:17:27.073

为了获得核变换 SVM 的决策边界，我通常只预测一个新数据网格，然后将轮廓（或 3D 中的等值面）拟合到该`decision value = 0`级别。在 3D 中，您可以使用出色`rgl`的绘图包，如 Ben 建议的那样，以及包中的`contour3d()`功能`misc3d`。这是一个例子：

```
library(e1071)
library(rgl)
library(misc3d)

n    = 100
nnew = 50

# Simulate some data
set.seed(12345)
group = sample(2, n, replace=T)
dat   = data.frame(group=factor(group), matrix(rnorm(n*3, rep(group, each=3)), ncol=3, byrow=T))

# Fit SVM
fit = svm(group ~ ., data=dat)

# Plot original data
plot3d(dat[,-1], col=dat$group)

# Get decision values for a new data grid
newdat.list = lapply(dat[,-1], function(x) seq(min(x), max(x), len=nnew))
newdat      = expand.grid(newdat.list)
newdat.pred = predict(fit, newdata=newdat, decision.values=T)
newdat.dv   = attr(newdat.pred, 'decision.values')
newdat.dv   = array(newdat.dv, dim=rep(nnew, 3))

# Fit/plot an isosurface to the decision boundary
contour3d(newdat.dv, level=0, x=newdat.list$X1, y=newdat.list$X2, z=newdat.list$X3, add=T) 
```

![在此处输入图像描述](../Images/113c1132372b12aaaf36e1099719fe33.png) ![在此处输入图像描述](../Images/2074490856d4628f47fa8fa4cca87265.png)

# javascript - 正则表达式替换用空格分隔的整数

> ID：10266196
> 
> 赞同：2
> 
> 时间：2012-04-22T07:54:04.103
> 
> 标签：javascript, html, regex

我正在用 JS 创建一个 MTG 卡片生成器，我想知道如何使用正则表达式替换卡片成本中的整数？（更多的是学习而不是出版）

card_cost 只是来自用户的输入文本值，我希望能够用空格分隔整数 IE：用户输入：“10 1 2”应该替换整数，但应该保留空格。

会这样开始：

```
if(card_cost)
{
card_cost=card_cost.replace(/INTEGER/g,"<span class='card_costnum' src='numsymbol.png' ></span>");
} 
```

这里的尝试是将整数替换为它们自己保存在一个跨度内，以显示每个数字的背景图像。

现在我有时间考虑这个问题，我假设我需要获取一个整数数组，以便我可以在一个跨度内将它们传回，替换不足以正确捕获多个整数我假设。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-22T08:36:37.483

在javascript`replace`函数中，`$&`指的是搜索字符串本身，所以你可以写

```
someStr = "12 34 foo 5 bar"
someStr.replace(/\d+/g, "<span whatever>$&</span>") 
```

返回

```
<span whatever>12</span> <span whatever>34</span> foo <span whatever>5</span> bar 
```

要单独替换每个数字，只需删除`+`：

```
someStr = "12 34 foo 5 bar"
someStr.replace(/\d/g, "<span whatever>$&</span>") 
```

返回

```
 <span whatever>1</span><span whatever>2</span> etc 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-22T07:58:58.577

要删除所有数字字符：

```
if(card_cost)
{
    card_cost=card_cost.replace(/\d/g,'');
} 
```

但是，正如评论中所指出的，我不知道为什么会`span`出现在 中`replace()`，所以我删除了它，现在上面所做的是匹配数字，并删除它们，用一个空的零字符字符串替换它们。

* * *

**编辑**以下关于问题意图的澄清：

```
if(card_cost)
{
    card_cost = card_cost.replace(/(\d)/g,function(a,b){
        return '<span class="card_costnum" src="numsymbol.png">' + a + '</span>';
    });
} 
```

[JS 小提琴演示](http://jsfiddle.net/davidThomas/NZ8Hv/3/)。

以上将在 中包含*所有*匹配的数字`span`，但它将匹配*所有*数字字符。

```
if(card_cost)
{
    card_cost=card_cost.replace(/\b(\d+)\b/g,function(a,b){
        return '<span class="card_costnum" src="numsymbol.png">' + a + '</span>';
    });
} 
```

[JS 小提琴演示](http://jsfiddle.net/davidThomas/NZ8Hv/2/)。

此版本将匹配（一个或多个）数字字符的字边界有界序列，并将这些匹配项包装在`span`s 中。

参考：

*   [常用表达](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/RegExp)
*   [`replace()`](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/String/replace)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-22T08:05:19.250

```
if(card_cost)
{
    card_cost=card_cost.replace(/\d+/g,"<span class='card_costnum' src='numsymbol.png' ></span>");
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-22T08:19:53.933

假设您正在使用 jQuery：

```
var theNumbers = card_cost.split(" ");
for (var i=0; i < theNumbers.length; i++) {
    $("#target_div").append("<span class='card_costnum'>"+theNumbers[i]+"</span>");
} 
```

我认为这实现了与您所要求的非常相似的东西，但我没有使用正则表达式。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-22T08:36:36.593

```
if (card_cost) {
    card_cost = card_cost.replace(/(\d+)/g, '<span class="card_costnum_$1">$1</span>');
} 
```

加上 CSS，例如：

```
.card_costnum_42 {
    background-image: url('card_costnum_42.png');
} 
```

# asp.net-mvc - 如果 MvcSiteMapProvider 的操作标记为 [Authorize(Roles = "Administrator")]，则在 MvcSiteMapProvider 中显示节点

> ID：10266197
> 
> 赞同：2
> 
> 时间：2012-04-22T07:54:23.417
> 
> 标签：asp.net-mvc, nodes, authorize-attribute, mvcsitemapprovider, asp.net-mvc-sitemap

目前，我有一个需要授权`Controller`的`Index()`操作方法：

```
public partial class CustomerController : BaseDocumentStoreController
{
    [Authorize(Roles = AccountController.Administrator)]
    public virtual ViewResult Index()
    {
        ...
    }

    ...
} 
```

有了这个，相应的节点`Mvc.sitemap`将不会显示在面包屑中：

```
<mvcSiteMapNode     title="Customer"         controller="Customer" action="Index"
                    resourceKey="Customers"  clickable="true" >

    <mvcSiteMapNode title="Customer Add"     controller="Customer" action="Add"
                    resourceKey="Add"  />
    <mvcSiteMapNode title="Customer Create"  controller="Customer" action="Create"
                    resourceKey="Add" />
    <mvcSiteMapNode title="Customer Edit"    controller="Customer" action="Edit"
                    resourceKey="Edit" />
    <mvcSiteMapNode title="Customer Update"  controller="Customer" action="Update"
                    resourceKey="Edit" />
    <mvcSiteMapNode title="Customer Delete"  controller="Customer" action="Delete"
                    resourceKey="Delete" />
    <mvcSiteMapNode title="Customer Details" controller="Customer" action="Details"
                    resourceKey="Details" />
    <mvcSiteMapNode title="Customer Search"  controller="Customer" action="Search"
                    resourceKey="Search" />

</mvcSiteMapNode> 
```

我想要的是无论如何都显示这个节点......

假设用户未通过身份验证。所以我希望面包屑显示这一点：

```
Home > Customers > Add 
```

目前它只显示：

```
Add 
```

如果用户单击“**客户**”节点，他将被重定向到登录视图……好的，没关系！

`SiteMapVisibilityProvider`我尝试按照以下[步骤](https://github.com/maartenba/MvcSiteMapProvider/wiki/Advanced-Node-Visibility)实现自己的：

```
public class SiteMapVisibilityProvider : ISiteMapNodeVisibilityProvider
{
   ...
} 
```

在调试时，我只能看到 Index 节点下方的节点，也就是说，在我目前的情况下，只有 Add 节点出现。表示 Index 操作方法的节点未显示在调试会话中。

有什么方法可以实现我想要的吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-22T22:24:09.760

问题很可能在于`DefaultAclModule`，它隐藏了当前用户无法访问的所有节点。如果您不想要该功能，可以通过`securitytrimming`在 web.config 的站点地图提供程序中设置为 false 来禁用它。

您还可以通过实现自定义来更改功能`AclModule`。

# java - 使用 Java，Web 应用程序变得非常慢

> ID：10266200
> 
> 赞同：0
> 
> 时间：2012-04-22T07:55:11.043
> 
> 标签：java, sql, jakarta-ee, tomcat

我正在开发一个 Java 通信网关 (CGW)，它从 GPS 设备获取数据包，对其进行处理并存储在一个名为 Live 表的表中（数据库在不同的服务器中运行 - 从 Java CGW 我通过连接池调用数据库连接并插入Live 表中的数据）。

另一方面，我们的 Web 应用程序也在从同一个 Live 表中读取数据。因此，当 Java CGW 应用程序启动时，Web 应用程序变得非常非常慢，甚至第一页也打不开。我正在使用 SQL Server 2005。

请告诉我为什么会这样。

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-26T22:40:57.933

200 线程是一个具有挑战性的数字。

*   什么是系统架构概述？
*   所有这些线程消耗了多少内存。
*   你如何在线程之间同步你的数据/通信。
*   什么是硬件配置。
*   有必要使用SqlServer吗？jdbc:odbc 网桥可能比 jdbc:mysql 慢。

通常在多线程场景中，通信开销相对于参与代理是指数级的。此外，数据的处理方式：许多数据的相同功能或多种数据类型的多个功能/阶段？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-22T08:32:58.653

看起来您的问题是线程优先级问题，因为读取/保存数据似乎需要比预期更多的处理器时间，您可以通过在当前线程中调用小于 5 的 setPriority 来降低线程优先级。

获取当前线程。

```
Thread.currentThread().setPriority(MIN_PRIORITY); 
```

要知道如何正确调用它，请查看[Set Priority 方法。](http://docs.oracle.com/javase/6/docs/api/java/lang/Thread.html#setPriority%28int%29)希望这可以帮助！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-22T08:53:13.420

你做过数据库服务器的性能分析吗？可能是数据库服务器的工作量太大。如果 Web 应用程序只读取数据，主/从数据库配置应该可以解决 DB 服务器工作量问题。

# c# - asp.net mvc中的分页

> ID：10266202
> 
> 赞同：0
> 
> 时间：2012-04-22T07:55:23.353
> 
> 标签：c#, asp.net-mvc, linq, entity-framework, pagination

我有类别和子类别。每个子类别都有一些产品。eg编程类有| C# , java , 基本子类别 | 其中 c# 有 c# 3 ， c# 3.5 产品 | java有java ee、java me等

我想从使用 linq to EF 的类别中选择 10 个产品。

问题是我不想从数据库中加载所有产品，然后对它们进行排序，然后选择其中的 10 个。

我想要一个解决方案，我可以只从数据库中获取 10 个产品，而无需将所有产品从数据库传输回 Web 服务器。

我知道 EF 很贪心，只会拿 10 种产品并跳过一些。但在我的情况下，我有类别和子类别，所以我认为我应该首先从属于一个类别的不同子类别中选择所有产品，并将它们附加到一个列表中，从而将所有产品带到服务器，然后选择其中的 10 个。

最好的做法是什么，这样我就不必将所有产品都转移到服务器上？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-22T08:19:12.640

您可以在一个查询中执行此操作：

```
var pagedProducts = _db.Categories.Join( 
    _db.Products,
    c => c.CategoryId,
    p => p.CategoryId,
    (Category, Products) =>
       new
       {
           CategoryType = Category,
           ItsProducts  = Products
       })
        .OrderBy(g => g.Category.Name)
        .Skip((CurrentPage - 1) * pageSize)
        .Take(pageSize); 
```

# asp.net - 在 ASP.NET 中实现命中计数器存储的最佳方法是什么？

> ID：10266205
> 
> 赞同：4
> 
> 时间：2012-04-22T07:55:39.440
> 
> 标签：asp.net

我正在创建一个命中计数器，用于跟踪有多少人访问了特定页面。保存此信息的表包含 page_id、ip_address 和时间戳（IP 地址访问页面的时间）。

我遇到的“问题”是保存这些信息的最佳方式。如果我每次用户访问页面时都存储它，它会影响网站性能，并且在保存过程中可能会出现问题。我希望可能使用文件`Application_End`中`Global.asax`的 将记录添加到计数器表中。但是我怎样才能保存这些记录呢？我是否使用`Application`变量？如果是，如何？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-22T08:30:25.257

```
which is the best way to save this information 
```

有三种方法可以帮助不影响页面显示的性能，并且只关心您要保存和保留的数据。

## 第一种方式

您可以使用从页面调用的处理程序作为图像，仅用于编写此统计计数器。在此处理程序中，您不使用会话，因此您甚至不会阻止其他页面。而且大多数蜘蛛都不会调用它，因此您只编写真实用户。

您可以通过以下方式在页面上拨打电话：

```
<img src="keepstats.ashx?Page=CurrentPage.aspx" height="1" width="1" alt="" > 
```

处理程序是

```
// 1x1 transparent GIF
private readonly byte[] GifData = {
    0x47, 0x49, 0x46, 0x38, 0x39, 0x61,
    0x01, 0x00, 0x01, 0x00, 0x80, 0xff,
    0x00, 0xff, 0xff, 0xff, 0x00, 0x00,
    0x00, 0x2c, 0x00, 0x00, 0x00, 0x00,
    0x01, 0x00, 0x01, 0x00, 0x00, 0x02,
    0x02, 0x44, 0x01, 0x00, 0x3b
};

public void ProcessRequest (HttpContext context) 
{
    // save here your stat counter

    // send the image
    context.Response.ContentType = "image/gif";
    context.Response.Buffer = false;
    context.Response.OutputStream.Write(GifData, 0, GifData.Length);
} 
```

## 第二种方式

不是从后面的代码而是从页面内部调用这个函数。这种情况的不利之处在于会话正在锁定页面并且页面必须完全加载以允许下一个请求继续进行。但是是最容易制作的。

```
<body>
... all the page here...

..bottom of the page..
<%
  // you send this part of the page and user all ready see it
  Response.Flush();
  // now you call the function that calculate the statistics
  // the page still show that is loading, but the user all ready see it
  CallTheStatisticSaveFunction();
%>
</body> 
```

## 第三种方式

我忘记了另一种方法，即创建一个线程以使工作与页面并行且不可靠。

## 遗言

在我的代码中，我使用了上述所有技巧，一个用于统计，第二个用于必须在页面上完成但可能需要更多时间的操作。我将线程用于在开始渲染页面之前必须完成的操作，并使用一些技巧，如果线程没有结束，我会渲染我所拥有的。

由于这个原因，我将避免使用会话来了解用户是否已经准备好查看该页面：

1.  如果用户不使用 cookie，则会话不起作用，并且所有蜘蛛都不使用会话
2.  如果用户开始看到很多页面，会话数据将会增长。

当`Application_End`您关闭 iis 或停止您的应用程序时，它只会被调用。全局和每次调用的点是，`Application_BeginRequest`但是你会影响性能，因为每个 asp.net 元素都会调用它，你需要检查它是否是一个页面，如果有别的东西，这个在页面的第一点，你会有延迟。在用户看到一些东西后，我们在这里搜索最后如何编写统计信息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-22T08:06:17.263

你有几个选择；您可以使用`Session`对象来存储点击，这样当同一个用户（IP地址）点击同一个页面时，它就不会被再次保存。

重要的是要记住，如果您在一台服务器上运行此选项是相关的（当然有网络场的解决方案 - 但我不认为这是您的情况，在这里详细说明它们可能是错误的）并且没有唯一访问者太多，因为 Session 会很快填满你的可用内存。

还有其他选项，例如使用 Redis - 但一开始，`Session`对于负载不是很高的站点，使用过滤重复点击是可以的。

# node.js - 使用 node-markdown 模块渲染 markdown 时输出不一致

> ID：10266209
> 
> 赞同：1
> 
> 时间：2012-04-22T07:56:36.473
> 
> 标签：node.js, express, markdown

我正在尝试编写一个控制器，`express`它需要一些降价并返回一些用于论坛帖子的 HTML。

我在命令行中得到了预期的行为：

```
> var md = require('node-markdown').Markdown;
undefined
> md("\n\ndon't mind me\n====")
'<h1>don\'t mind me</h1>' 
```

但是，如果我收到`HTTP POST`根据 Chrome 具有以下表单数据的请求

```
raw:\n\ndon't mind me\n==== 
```

我收到以下回复：

```
<p>\n\ndon't mind me\n====</p> 
```

它没有正确识别`H1`标签。

下面是解析markdown的代码：

```
var md = require('node-markdown').Markdown;

var parseMarkdown = (function () {
return function (raw_md) {
    return md(raw_md);
}
}()); 
```

这是我的控制器代码：

```
app.post('/render_markdown', function (req, res) {
    res.header('Access-Control-Allow-Origin', '*');
            res.header('Content-Type', 'application/json');
    var raw = req.body['raw'];
    res.send({ html: parseMarkdown(raw)});
}); 
```

有人知道这里可能发生了什么吗？在将输入传递给 Markdown 函数时，我尝试过转义和取消转义，但似乎没有帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-22T15:48:04.280

我认为您需要发送一个包含 json 的字符串，而不是响应中的实际对象。尝试这个：

```
res.send(JSON.stringify({ html: parseMarkdown(raw)}); 
```

# php - 如何使 Xpath 搜索不区分大小写

> ID：10266210
> 
> 赞同：13
> 
> 时间：2012-04-22T07:56:45.630
> 
> 标签：php, xml, xpath

我目前正在进行 xpath 搜索，我已经让搜索工作，但我需要让它不区分大小写。我正在使用的 xml 文件是 1.0，根据我的研究，这意味着我必须使用一些称为翻译功能的东西，但我不确定如何做到这一点。

这是我的搜索文件：

```
$holidayDoc = simplexml_load_file('holidays.xml');      

// fetch data from form
$txtSearch = $_GET['txtSearch'];

$qry = "//channel/item[contains(.,\"$txtSearch\")]";

$holidays = $holidayDoc->xpath($qry);   // do the xpath query 
// now loop through all the students

echo "Showing title search results for $txtSearch";

foreach ($holidays as $holiday) 
{

 echo "<p><a href=\"{$holiday->link}\">{$holiday->title}</a></p>
    <p><small>$holiday->pubDate</small></p>"; 
```

任何帮助将不胜感激，谢谢。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-04-22T08:09:05.377

XPath 1.0：

```
$qry = "//channel/item[contains(
 translate(., 'ABCDEFGHIJKLMNOPQRSTUVWXYZ', 'abcdefghijklmnopqrstuvwxyz'),  
 translate($search, 'ABCDEFGHIJKLMNOPQRSTUVWXYZ', 'abcdefghijklmnopqrstuvwxyz'))]" 
```

XPath 2.0：

```
$qry = "//channel/item[lower-case(.) = lower-case($search)]" 
```

两者都将所有大写字母替换为小写字母。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-22T15:14:43.563

**当前接受的答案是有缺陷的——因为没有任何东西可以保证 的第二个参数`contains()`已经转换为小写**。

此外，它使用`'$search'`-- 这实际上是字符串`"$search"`-- 而不是*变量* `$search`。

**这是一个正确的解决方案**：

```
//channel/item
   [contains(translate(., 
                       'ABCDEFGHJIKLMNOPQRSTUVWXYZ', 
                       'abcdefghjiklmnopqrstuvwxyz'),
             translate($txtSearch, 
                       'ABCDEFGHJIKLMNOPQRSTUVWXYZ', 
                       'abcdefghjiklmnopqrstuvwxyz')
             )
   ] 
```

**对应的 XPath 2.0 表达式**：

```
//channel/item[contains(lower-case(.), lower-case($txtSearch))] 
```

**更新**：

基于此解决方案，`@alain.janinm`已更正了他的答案。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-04-22T17:00:21.930

从技术上讲，要进行不区分大小写的比较，您应该使用不区分大小写的排序规则，除非您的文本恰好是英文；将两个操作数规范化为大写或小写并不能在所有情况下都给出正确的结果。不幸的是，排序规则名称（在 XPath 2.0 中）没有标准化，因此您必须查看产品文档以查看可用的排序规则。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-10-21T03:49:58.593

不区分大小写的搜索可以使用`matches`这样的函数

```
$qry = "//string[text() [matches(.,'^stringImTryingToFind$','i')]]" 
```

查询`//string[text() [matches(.,'^OK$','i')]]`部分使用正则表达式 (REGEX) 来确定匹配项。

# mysql - 如何在mysql中将两个大表合并为一个

> ID：10266212
> 
> 赞同：2
> 
> 时间：2012-04-22T07:56:47.567
> 
> 标签：mysql, sql, join

我有一桌人

```
 Name  Id            Age Sex  Country    
    Ankit ankitgautam24 17   M   India
    John  john321       71   M   France
    Will  willsmith     42   M   USA
    Arti  artisingh     67   F   Pakistan
   .....3.5 million records...... 
```

和另一个表限制

```
Country        Sex      Allow
France         F       Allowed
France         M       Restricted
India          F       Restricted
India          M       Allowed
Pakistan       F       Restricted
....for each country ...... 
```

现在我想将其转换为表 Useraccount 其结构应该是

```
 Name  Id            Age Sex  Country  Allow   
    Ankit ankitgautam24 17   M   India    Allowed
    John  john321       71   M   France   Restricted 
    Will  willsmith     42   M   USA      Allowed
    Arti  artisingh     67   F   Pakistan Allowed
   .....hundreds of thousands of record...... 
```

以最聪明的方式将这两个表连接到一个的正确查询是什么

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-22T08:00:40.543

您需要的只是一个简单、直接的`JOIN`，并且不会花费太多时间：

```
SELECT p.Name, p.Id, p.Age, p.Sex, p.Country,
       r.Allow 
FROM People p 
INNER JOIN Restriction r ON p.Country = r.Country 
```

`JOIN`这将是执行此操作的更有效方法，但要使其更有效，而不是在`Country`名称上连接两个表，您最好`CountryID`在此列上添加和连接它们。所以你的表`People`应该是这样的：

*   `Name`.
*   `Id`.
*   `Age`.
*   `CountryId`约束外键引用`Restrictions`表 ( `CountryId`)。

和`Restrictions`表：

*   `CountryID`.
*   `IsAllwoed`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-10-20T17:32:40.777

你也可以试试这个：

```
SELECT p.Name, 
       p.Id, 
       p.Age, 
       p.Sex, 
       p.Country, 
       r.Allow, 
       r.Country 
from people p, Restriction r 
where r.Country=p.Country 
```

# c# - 转换为空 到通用类型

> ID：10266220
> 
> 赞同：4
> 
> 时间：2012-04-22T07:57:51.807
> 
> 标签：c#, generics, exception, c#-4.0, nullable

假设这个方法：

```
public T GetParameterValue<T>(string ParamName) {

if(typeof(T) == typeof(Boolean?) && Request.QueryString.AllKeys.Contains(ParamName)) {

                Boolean? istrue = null;

                if(Request.QueryString.GetValues(ParamName).FirstOrDefault() == "1")
                    istrue = true;
                else if(Request.QueryString.GetValues(ParamName).FirstOrDefault() == "0")
                    istrue = false;

                return (T)Convert.ChangeType(istrue, typeof(T));
            }

//Other types implementation

} 
```

所以这个方法总是在返回行中引发异常：

```
Invalid cast from 'System.Boolean' to 'System.Nullable`1[[System.Boolean, 
mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089]]'. 
```

我不明白问题在哪里我不使用`Boolean`我使用`Boolean?`

这是我的电话：

```
Product.IsAllow= GetParameterValue<Boolean?>("IsAllow"); 
```

那么您对此有何想法？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-22T08:06:43.300

您可以使用

```
return (T)(object)istrue; 
```

不过，我根本不会使用这种代码。只需创建一个专门解析每种数据类型的方法（例如`bool? GetBooleanParameter(string name)`）。你在这里的泛型没有任何收获，只会让代码更麻烦。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-22T08:24:46.757

> 我不明白问题在哪里我不使用`Boolean`我使用`Boolean?`

是的，但是您在不知不觉中将其转换为`Boolean`之前`ChangeType`看到的。

第一个参数有类型`Object`。当可空值类型（在本例`bool?`中）转换为 时`object`，您将获得`null`或非可空类型的实例。因此，当`ChangeType`看到它时，它不再是可为空的布尔值。

真正的问题是它`Converter`不支持可为空的类型。充其量，您可以特殊情况，如果类型为`T?`，则检查参数是否为 null 或空字符串，如果是，则返回 null，否则，转换为`T`. 或者不使用`Converter`它不是最好的方法。

# .net - 为什么 TaskFactory.StartNew Task 没有立即启动？

> ID：10266221
> 
> 赞同：9
> 
> 时间：2012-04-22T07:58:09.360
> 
> 标签：.net, c#-4.0, .net-4.0, asynchronous

根据[MSDN 文档 TaskFactory.StartNew](http://msdn.microsoft.com/en-us/library/dd321439.aspx)它创建并启动一个任务。所以，对于下面的代码示例

```
class Program
{
    public static void Main()
    {
        var t =Task.Factory.StartNew(
                () => SomeLongRunningCalculation(10, Display)
            );
        var t1 = Task.Factory.StartNew(
                () => SomeLongRunningCalculation(20, Display)
            );
        Console.WriteLine("Invoked tasks");
        Task.WaitAll(t, t1);
        Console.ReadLine();
    }

    public static void Display(int value)
    {
        Console.WriteLine(value);
    }

    public static void SomeLongRunningCalculation(int j, Action<int> callBack)
    {
        Console.WriteLine("Invoking calculation for {0}", j);
        System.Threading.Thread.Sleep(1000);
        if (callBack != null)
        {
            callBack(j + 1);
        }
    }
} 
```

我的预期输出是

> ```
> Invoking calculation for 10
> Invoking calculation for 20
> Invoked tasks
> 11 
> 21 
> ```

但是，它正在显示

> ```
> Invoked tasks
> Invoking calculation for 20
> Invoking calculation for 10
> 21
> 11 
> ```

我乐意去学

1.  为什么在 StartNew 之后任务没有立即运行？
2.  我应该怎么做才能获得预期格式的输出？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-04-22T09:35:24.880

这在具有单核 CPU 的机器上很可能出现。或者可能在一个多核 cpu 上，它也忙于做其他事情。

创建一个任务或一个线程只建立一个允许代码运行的逻辑操作系统结构。如果内核很忙，操作系统调度程序不会*立即*开始执行它，线程必须与机器上运行的所有其他线程竞争。一个典型的 Windows 会话有上千个左右。每秒 64 次，内核生成一个中断，调度程序重新评估正在发生的事情，看看是否应该轮到另一个线程。任何未阻塞的线程（等待其他线程完成工作，例如读取文件或网络数据包）都有资格运行，调度程序会选择具有最高优先级的线程。调度程序中的一些附加代码会修改优先级值，以确保所有线程都有机会。

机会是这里的关键词。线程调度是*不确定的*。

请注意我从未说过任何关于 Thread 或 Task 或 ThreadPool 类的内容。他们没有能力对操作系统调度线程的方式做任何事情。唯一可能的是*阻止*线程运行，这是线程池调度程序的工作。

优先级很重要，您可以修改 Thread.Priority 或 Task.Priority 属性来影响结果。但是没有 slamdunk，操作系统调度程序会不断地从您使用该属性设置的基本优先级调整线程优先级。例如，您不能通过让另一个具有更高优先级的线程来阻止线程运行*。*

希望线程以可预测的顺序运行会导致最糟糕的错误，即线程竞争错误。第二个最坏的情况是僵局。它们极难调试，因为它们依赖于时间和可用的机器资源和负载。您只能通过编写明确处理它的代码来确保获得特定订单。您可以使用 Mutex 或*lock*关键字等线程原语来执行此操作。值得注意的是，当您尝试将此类代码添加到您的代码段时，您最终会得到一个不再具有并发性的程序。或者换句话说，您最终将不再使用任务。*一个线程或任务只有在你负担*得起它在不可预测的时间运行时才会有用。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-04-22T08:02:55.377

> 为什么在 StartNew 之后任务没有立即运行？

关于[MSDN](http://msdn.microsoft.com/en-us/library/dd321439.aspx) `StartNew()`会*安排*一个任务来执行。

> 调用 StartNew 在功能上等同于使用其构造函数之一创建一个 Task，然后调用 Start 来安排它的执行。但是，除非必须将创建和调度分开，否则出于简单性和性能考虑，建议使用 StartNew 方法。

由于 TPL 使用 ThreadPool 线程 - 有时它必须做一些工作才能为特定任务执行保留和启动 ThreadPool 线程。如果您需要在没有任何中间机制（如 TPL 的 TaskScheduler）的情况下显式运行一个单独的线程 - 手动创建和启动一个线程，显然您将不会拥有像 continuation 这样简洁的东西。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-10-24T11:43:27.747

> 请注意我从未说过任何关于 Thread 或 Task 或 ThreadPool 类的内容。他们没有能力对操作系统调度线程的方式做任何事情。唯一可能的是阻止线程运行，这是线程池调度程序的工作。

……任务与线程之战……这取决于所需的任务。

对于示例，我们需要从 Internet 加载 100 张图片，同时执行 100 个任务（一个客户端一个任务）来为 100 个客户端制作地图瓦片（一个客户端一个瓦片）。并且我们有一个共同的时间限制，一些加载任务的加载时间可以与共同的时间限制重叠。简单的测试表明，在有限的时间内同时执行 100 个线程（线程类）比执行 100 个任务（任务类）效率高得多。10 个线程与 10 个任务的结果相同。我的意思是，如果我们需要的不仅仅是“一些缓慢的”但稳健的任务，即在同时执行的任务中做更多的工作，那么我们应该使用 Thread 类。

# mongodb - 如何在没有 $pull 或 $pop 的情况下更新数组中的第 n 个元素？

> ID：10266228
> 
> 赞同：1
> 
> 时间：2012-04-22T07:59:08.657
> 
> 标签：mongodb, mongodb-.net-driver, mongodb-php, mongodb-java, mongodb-ruby

如何更新数组中第 n 个位置元素的值？

我想更新 category_id 的索引 2。

一种解决方案是 (`$pop`或`$pull`) 和`$addToSet`。

还有其他解决方案吗？

```
Array ( [_id] => MongoId Object ( [$id] => 4f93ae990c211da128000004 ) 
        [name] => UnderWater Photography Tips 
        [category_id] => Array ( 
                    [0] => MongoId Object ( [$id] => 4f93a5050c211da328000001 ) 
                    [1] => MongoId Object ( [$id] => 4f93a8860c211da128000003 ) 
                    [2] => ) 
        [user_id] => MongoId Object ( [$id] => 4f92565a0c211dd706000001 ) ) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-22T16:15:14.213

您可以通过使用[按位置排列的数组元素功能](http://www.mongodb.org/display/DOCS/Dot+Notation+%28Reaching+into+Objects%29#DotNotation%28ReachingintoObjects%29-ArrayElementbyPosition)来做到这一点。在 PHP 中，这看起来像：

```
$c->update(
    array( '_id' => new MongoID( '4f93ae990c211da128000004' ) ),
    array( '$set' => array(
        'category_id.2' => new MongoID( '4f93a5050c211da328009999' )
    ))
); 
```

在 shell 上，您将运行：

```
db.arraytest.update(
    { _id: ObjectId( '4f93ae990c211da128000004' ) },
    { $set: { 'category_id.2' : ObjectId( '4f93a5050c211da328009900' ) } }
); 
```

当我执行以下脚本时，它会准确显示发生的情况：

```
<?php
$m = new Mongo();
$c = $m->demo->arraytest;

$c->drop();
$c->insert( array(
    '_id' => new MongoID( '4f93ae990c211da128000004' ),
    'name' => 'Underwater',
    'category_id' => array(
        new MongoID( '4f93a5050c211da328000001' ),
        new MongoID( '4f93a5050c211da328000002' ),
        new MongoID( '4f93a5050c211da328000003' ),
        new MongoID( '4f93a5050c211da328000004' ),
    ),
    'user_id' => new MongoID( '4f92565a0c211dd706000001' )
) );

$c->update(
    array( '_id' => new MongoID( '4f93ae990c211da128000004' ) ),
    array( '$set' => array(
        'category_id.2' => new MongoID( '4f93a5050c211da328009999' )
    ))
);

var_dump( $c->findOne( array( '_id' => new MongoID( '4f93ae990c211da128000004' ) ) ) ); 
```

现在运行它：

```
$ php test.php
array(4) {
  ["_id"]=>
  object(MongoId)#6 (1) {
    ["$id"]=>
    string(24) "4f93ae990c211da128000004"
  }
  ["name"]=>
  string(10) "Underwater"
  ["category_id"]=>
  array(4) {
    [0]=>
    object(MongoId)#5 (1) {
      ["$id"]=>
      string(24) "4f93a5050c211da328000001"
    }
    [1]=>
    object(MongoId)#4 (1) {
      ["$id"]=>
      string(24) "4f93a5050c211da328000002"
    }
    [2]=>
    object(MongoId)#11 (1) {
      ["$id"]=>
      string(24) "4f93a5050c211da328009999"
    }
    [3]=>
    object(MongoId)#10 (1) {
      ["$id"]=>
      string(24) "4f93a5050c211da328000004"
    }
  }
  ["user_id"]=>
  object(MongoId)#12 (1) {
    ["$id"]=>
    string(24) "4f92565a0c211dd706000001"
  }
} 
```

# ruby-on-rails - Github：克隆存储库，对克隆进行更改，并提交到原始存储库

> ID：10266229
> 
> 赞同：4
> 
> 时间：2012-04-22T07:59:19.237
> 
> 标签：ruby-on-rails, heroku, github

我是使用 Github 的新手。

我正在使用计算机学习 Ruby on Rails，并成功地将所有内容推送到我的 github 存储库以及 Heroku。

现在我使用的计算机与我使用的第一台计算机不同。

问题是，我如何克隆我的 github 存储库，对代码进行更改，并将这些更改推送到 github 中的原始存储库，并希望将这些更改也带到 Heroku。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-22T08:20:21.717

当您从 github 克隆存储库（并且您以 github 形式登录）时，您有 3 个选项/链接可以“克隆”您的存储库。

1.  SSH
2.  HTTP
3.  GIT 只读

如果您未登录，则仅显示 2 个选项

1.  HTTP（只读）
2.  GIT 只读

在文件 .git/config 你可以看到你添加了哪个，主要在 [remote "origin"]

```
url = git@github.com:username/project.git (SSH)

url = https://username@github.com/username/project.git (HTTP)

url = https://github.com/username/project.git (HTTP Read only)

url = git://github.com/username/project.git (Git Read only) 
```

如果您选择只读，您能做的最好的就是删除该遥控器：

`git remote rm origin`

之后，您可以添加一个新的遥控器：

`git remote add origin https://username@github.com/username/project.git`（对于 http）

或者

`git remote add origin git@github.com:username/project.git`（对于 SSH）

HTTPS 是最容易设置的，但每次推送/拉取都必须输入密码（除非您想存储密码明文）

设置好遥控器后，就可以推送了`git push origin branchname`

更多信息可以在 git 手册页上找到：http: [//help.github.com/remotes/](http://help.github.com/remotes/)

# wifi - 通过 ADB 连接 wi-fi

> ID：10266230
> 
> 赞同：1
> 
> 时间：2012-04-22T07:59:38.877
> 
> 标签：wifi, connect, adb

如何在没有 root 访问权限的情况下通过 ADB 连接到 Wi-Fi？转到设置菜单和键事件对我不起作用。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-28T22:59:11.290

我这样做的方式...

`1) adb kill-server` `2) adb connect the-ip-of-your-device`

即使没有先连接 USB 电缆，我也可以连接，也没有 Root。我讨厌生根我的设备

使用华硕 TF300

# javascript - 如何停止 onbeforeunload 事件？

> ID：10266232
> 
> 赞同：0
> 
> 时间：2012-04-22T07:59:57.000
> 
> 标签：javascript, jquery

我试图停止默认的关闭事件， `event.stopPropogation()`但是`event.preventDefault()`，它并不能帮助我停止这个过程。

你们中的任何人都知道如何停止此默认关闭事件吗？

是否可以监听浏览器点击事件？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-22T08:02:31.183

出于显而易见的原因，您不能以编程方式阻止用户关闭页面。唯一的方法是让浏览器向用户询问确认问题（通过将关闭问题作为事件字符串返回）。

# html - HTML5 视频作为网页背景淡入

> ID：10266240
> 
> 赞同：1
> 
> 时间：2012-04-22T08:02:25.283
> 
> 标签：html, video, html5-video, jquery-animate

我目前有一个循环作为我的网页背景，并且想知道视频循环是否可以淡入*并且*也*不会重复淡入*而只是播放循环？循环是使用 HTML5 视频背景 jquery 脚本的完整背景，我希望它先淡入然后继续循环。

谢谢您的帮助！

```
<script type="text/javascript"> 
    $(document).ready(function() { 
        $("body").videoBG({ 
            mp4:"SiteBackgroundVideos/SiteBackgroundVideo.mp4",
            ogg:"SiteBackgroundVideos/SiteBackgroundVideo.ogv",
            webm:"SiteBackgroundVideos/SiteBackgroundVideo.webm", videoVolume:0.8,
            pattern:"images/pattern.png", patternOpacity:0.8 
        });
    });  
</script> 
```

* * *

**我在videoBG**中看到的唯一内容是 jquery.video-background.js 文件：

```
;(function($) {
$.fn.videoBG = function(settings) {

    //Default Variables
    var defaults = {
        autoplay:true,
        loop:true,
        //Video volume between 0 - 1
        videoVolume:1,
        //Aspect ratio
        aspectRatio:3,      //0:Normal, 1:Aspect, 2:Full, 3:Scale
        //Video Type
        mp4:false,
        webm:false,
        flv:false,
        ogg:false,
        //Mobile Video Type
        mp4Mobile:false,
        webmMobile:false,
        flvMobile:false,
        oggMobile:false,
        //Pattern
        pattern:"",
        patternOpacity:1,
        //Go to URL on video ended - You must set "loop:false" on top to run video ended event handler
        videoEndURL:""
    };

    //Settings
    var settings = $.extend({}, defaults, settings);        

    //HTML5
    var isHTML5 = false;

    //Mobile
    var isMobile = navigator.userAgent.match(/(iPad)|(iPhone)|(iPod)|(android)|(webOS)/i) ? true : false;
    var videoAutoPlay = navigator.userAgent.match(/(iPad)|(iPhone)|(iPod)/i) ? false : true;

    //Mobile Videos
    if (settings.mp4 && !settings.mp4Mobile) {settings.mp4Mobile = settings.mp4;}
    if (settings.webm && !settings.webmMobile) {settings.webmMobile = settings.webm;}
    if (settings.flv && !settings.flvMobile) {settings.flvMobile = settings.flv;}
    if (settings.ogg && !settings.oggMobile) {settings.oggMobile = settings.ogg;}

    //Variables
    var win = $(window);
    var winW, winH;     
    var container = $(this);
    var video, objVideo;
    var videoW=0, videoH=0;
    var videoMask = $('<div class="video-bg-mask" />');
    var videoHolder = $('<div class="video-bg-holder" id="video-bg-holder" />');
    var videoPattern = $('<div class="video-pattern" />');
    var videoPreloader = $('<div class="video-preloader" />');
    var hidden = false;

    //Video Mask
    container.append(videoMask);

    //Video Holder
    videoMask.append(videoHolder);  

    //Window resize handler
    win.resize(resizeVideo);    

    if (Modernizr.video && (settings.mp4 || settings.webm || settings.ogg)) {           
        //HTML5 Video
        createHTML5();
    } else {
        //Flash
        var playerVersion = swfobject.getFlashPlayerVersion();
        if(playerVersion.major>9) {
            createFlash();
        }
    }

    //Create HTML5 video tag
    function createHTML5() {
        var src = "", type = "", error = false;
        //Video type
        if (Modernizr.video.h264 && settings.mp4) {
            src = !isMobile ? settings.mp4 : settings.mp4Mobile; 
            type = "video/mp4";
        } else if (Modernizr.video.ogg && settings.ogg) {
            src = !isMobile ? settings.ogg : settings.oggMobile; 
            type = "video/ogg";
        } else if (Modernizr.video.webm && settings.webm) {
            src = !isMobile ? settings.webm : settings.webmMobile; 
            type = "video/webm";
        } else {
            error = true;   
        }
        //Preloader
        videoMask.append(videoPreloader);
        //Video tag
        if (!error) {
            var attr =' preload="'+(isMobile ? "auto" : "metadata")+'"';
            if (settings.autoplay) {
                attr += ' autoplay="autoplay"';
            }   
            if (settings.loop) {
                attr += ' loop="loop"';
            }               
            var videoCode = '<video class="video-container" \
                                width="100%" height="100%" \
                                src="'+src+'" type="'+type+'\
                                "'+attr+'\
                             />';
            videoHolder.html(videoCode);
            objVideo = videoHolder.find(".video-container");
            video = objVideo[0];
            video.addEventListener("ended", videoEnded, false);
            video.addEventListener("loadedmetadata", videoMetadata, false);
            video.addEventListener("waiting", videoWaiting);
            video.addEventListener("playing", videoPlaying);
            video.load();
            isHTML5 = true;
        }           
    }

    //Video meta data
    function videoMetadata(e) {
        video.removeEventListener("loadedmetadata", videoMetadata, false);
        //Video dimensions
        videoW = video.videoWidth;
        videoH = video.videoHeight;
        //Pattern
        if (settings.pattern!="") {
            createPattern();
        }
        //Resize video
        resizeVideo();
        //Show video holder
        videoHolder.stop().animate({"opacity":1}, 500);
        //Set video volume
        video.volume = settings.videoVolume;
        if(!videoAutoPlay){
            video.play();
        }
    }

    //Video ended
    function videoEnded(e) {
        //Redirect to URL
        if (settings.videoEndURL!="") {
            goToUrl();
        }
    }

    //Video waiting
    function videoWaiting(e) {
        videoPreloader.fadeIn();
    }

    //Video playing
    function videoPlaying(e) {
        videoPreloader.fadeOut();
    }

    //Pattern
    function createPattern() {
        videoPattern.css({"background-image":"url("+settings.pattern+")", "opacity":settings.patternOpacity});
        videoMask.append(videoPattern);
    }

    //Create Flash video player
    function createFlash() {
        var src = "", error = false;
        if (settings.mp4) {
            src = !isMobile ? settings.mp4 : settings.mp4Mobile;                
        } else if (settings.flv) {
            src = !isMobile ? settings.flv : settings.flvMobile;                
        } else {
            error = true;   
        }           
        if (!error) {
            //Resize video
            resizeVideo();
            //Create video SWF
            var flashvars = {
                videoUrl:"../"+src,
                fullSizeView:(settings.aspectRatio+1),
                defaultVolume:settings.videoVolume,
                pattern:settings.pattern,
                patternAlpha:settings.patternOpacity,
                loop:settings.loop,
                videoEndURL:settings.videoEndURL                
            };
            var params = {
                scale:"noscale",
                allowFullScreen:"true",
                menu:"false",
                bgcolor:"#000000",
                wmode:"transparent"
            };
            var attributes = {
                name: "video-bg-swf"
            };
            swfobject.embedSWF("flash/videobg.swf", "video-bg-holder", "100%", "100%", "9", null, flashvars, params, attributes, callbackFlash);
            //Show video holder
            videoHolder.stop().animate({"opacity":1}, 500);
        }
    }

    //Call back Flash
    function callbackFlash(e) {
        video = document.getElementById(e.id);
    }

    //Go to URL
    function goToUrl(){
        window.location = settings.videoEndURL;
    }

    //Resize video
    function resizeVideo(e) {
        winW = win.width();
        winH = win.height();
        var xScale = winW/videoW,
        yScale = winH/videoH, 
        scale=1, w=0, h=0, x=0, y=0;
        switch (settings.aspectRatio) {
            case 0: //Normal
                if (winW<videoW || winH<videoH) {
                    scale = Math.min(xScale, yScale);                       
                }                   
                w = Math.ceil(videoW*scale);
                h = Math.ceil(videoH*scale);                    
                x = Math.ceil((winW-w)/2);
                y = Math.ceil((winH-h)/2);
                break;  
            case 1: //Aspect
                scale = Math.min(xScale, yScale);
                w = Math.ceil(videoW*scale);
                h = Math.ceil(videoH*scale);
                x = Math.ceil((winW-w)/2);
                y = Math.ceil((winH-h)/2);      
                break;
            case 2: //Full
                w = winW;
                h = winH;
                x = 0;
                y = 0;      
                break;
            case 3: //Scale
            default:
                scale = Math.max(xScale, yScale);
                w = Math.ceil(videoW*scale);
                h = Math.ceil(videoH*scale);
                x = Math.ceil((winW-w)/2);
                y = Math.ceil((winH-h)/2);  
                break;
        }
        if (isHTML5) {
            objVideo.css({"width":w+"px", "height":h+"px"});
            videoHolder.css({"left":x+"px", "top":y+"px"});
            if (settings.pattern!="") {
                videoPattern.css({"left":x+"px", "top":y+"px", "width":w+"px", "height":h+"px"});   
            }
        } else {
            videoHolder.css({"width":winW+"px", "height":winH+"px"});
        }           
    }

    /***
    JS call back functions
    ***/
    //Play - Pause
    function isPlaying() {
        if(isHTML5) {
            return !video.paused;
        } else {
            return video.isPlaying();
        }
    }

    videoBg_play = function() {
        if(isHTML5) {
            video.play();
        } else {
            video.resume();
        }
    };

    videoBg_pause = function() {
        video.pause();
    };

    videoBg_toggle_play = function() {
        if(isPlaying()) {
            videoBg_pause();
        } else {
            videoBg_play();
        }
    };  

    //Rewind
    videoBg_rewind = function() {
        if(isHTML5) {
            video.currentTime = 0;
        } else {
            video.rewind();
        }
    };

    //Mute - Unmute
    function isMuted() {
        if(isHTML5) {
            return !(video.volume);
        } else {
            return video.isMute();

        }
    }

    videoBg_mute = function(){
        if(isHTML5) {
            video.volume = 0;
        } else {
            video.mute();
        }
    };

    videoBg_unmute = function(){
        if(isHTML5) {
            video.volume = settings.videoVolume;
        } else {
            video.unmute();
        }
    };

    videoBg_toggle_sound = function(){
        if(isMuted()) {
            videoBg_unmute();
        } else {
            videoBg_mute();
        }
    };

    //Show - Hide
    videoBg_show = function(){
        videoBg_play();
        videoMask.stop().fadeTo(600, 1);
        hidden = false;
    };

    videoBg_hide = function(){
        videoBg_pause();
        videoMask.stop().fadeTo(600, 0);
        hidden = true;
    };      

    videoBg_toggle_hide = function(){
        if(hidden) {
            videoBg_show();
        } else {
            videoBg_hide();
        }
    };

};

})(jQuery); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-22T09:22:55.450

因此，我做了一个快速原型，并且能够使用标准 JQuery 动画淡入 HTML5**视频**标签：

```
$("video").css('opacity', 0).animate( { opacity: 1 }, 'slow') 
```

**编辑**

也许“视频”选择器不起作用。试试这样：

```
$(document).ready(function() { 
    $("body").videoBG({ 
        mp4:"SiteBackgroundVideos/SiteBackgroundVideo.mp4",
        ogg:"SiteBackgroundVideos/SiteBackgroundVideo.ogv",
        webm:"SiteBackgroundVideos/SiteBackgroundVideo.webm", videoVolume:0.8,
        pattern:"images/pattern.png", patternOpacity:0.8 
    });
   $("body").css('opacity', 0).animate( { opacity: 1 }, 5000);
}); 
```

**编辑#2**

如果上面的方法不起作用，试试这个（这是源页面用来切换视频的方法）：

```
videoBg_toggle_hide(); 
```

# .net - Visual Studio 2010 GroupBox 中的文本？

> ID：10266247
> 
> 赞同：1
> 
> 时间：2012-04-22T08:03:11.493
> 
> 标签：.net, winforms, visual-studio, visual-studio-2010

当我尝试为 GroupBox 的标题写一个“&”符号时，我得到一个“_”。为什么会这样，我该怎么做才能得到'&'？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-22T08:05:26.157

使用双与号，所以用“&&”代替“&”。（& 是用于键盘快捷键的保留字符）

# java - 将两种不同类型的数组放入第一个数组

> ID：10266249
> 
> 赞同：1
> 
> 时间：2012-04-22T08:03:27.267
> 
> 标签：java, arrays, oop

我`ArrayList<Student>`在一个对象`StudentList list1`中创建了一个，即`saving[Serialization]`学生的信息 ( `name,id,age,gpa,etc`) 到 中，然后`list1`是`list1[0] = 1st student's info`，然后是`list1[1] = 2nd student's info`等等。

`ArrayList<Subject>`索引为 0 的学生的所有主题的对象中还有一个新对象`SubjectList list2`，例如`list2[0]=(java,math,etc)`[for first student] `list2[1]=(c++,english,etc)`[for second student] 保存在文件中。

我*想在学生信息旁边添加主题*：

> list1 index[0]=第一个学生信息，index[1]=第一个学生的科目。
> index[2]=第一个学生信息，index[3]=第一个学生的科目。

我被这个简单的问题困住了。请帮忙。

```
package studentPanel;

public class Main {
    public static void main(String[] args){     
        Student s = new Student(null, null, null, null);
        s.stulist.add(new Student("Smith", "1", "M", "3"));
        s.stulist.add(new Student("Jenny", "2", "F", "4"));
        s.stulist.add(new Student("Roger", "3", "M", "2"));     
        System.out.println(""+s.stulist);
        for(int i=0;i<s.stulist.size();i++){
            Student search = s.stulist.get(i);
            if(search.toString().contains("Jenny")){
                System.out.println("Found"+i);
                s.addSubject(s.new Subject("OOP","007"));
                s.addSubjects(s.sublist);
                System.out.println(""+s.stulist.get(i)+""+s.sublist);
            }
            else System.out.println("Not Found"+i);
        }
                System.out.println(""+s.stulist);
    }
}

package studentPanel;

import java.util.*;

public class Student {
    public String name, id, gender, cgpa;

    ArrayList<Subject> sublist = new ArrayList<Subject>();
    ArrayList<Student> stulist = new ArrayList<Student>();  
    public void addSubject(Subject new_subject) {
        sublist.add(new_subject);
    }
    public void addSubjects(List<Subject> subjects_list) {
        for (Subject s : subjects_list)
            addSubject(s);
    }   
    public Student(String name, String id, String gender, String cgpa) {
        this.name = name;
        this.id = id;
        this.gender = gender;
        this.cgpa = cgpa;
    }
    public String toString() {
        return "Name: " + name + "\tID: " + id + "\tGender: " + gender + "\tCGPA: " + 

cgpa+ "\n";
    }
    public class Subject {
        public String cname,cid;
        public Subject(String cname, String cid) {
            this.cname = cname;
            this.cid = cid;
        }
        public String toString() {
            return "Course: " + cname + "\tCode: " + cid;
        }
    }
} 
```

我只是做错了，它是假设添加主题`s.addSubject(s.new Subject

("OOP","007"));` 给学生珍妮。

输出应该是这样的：

> [姓名：史密斯 ID：1 性别：M CGPA：3
> 
> , 姓名：珍妮 ID：2 性别：F CGPA：4
> 
> , 姓名：罗杰 ID：3 性别：M CGPA：2 ]
> 
> 未找到0
> 
> 找到1
> 
> [姓名：Jenny ID：2 性别：F CGPA：4 ][课程：OOP，代码：007]
> 
> 未找到2
> 
> [姓名：史密斯 ID：1 性别：M CGPA：3
> 
> , 姓名: Jenny ID: 2 性别: F CGPA: 4 [课程: OOP,代码: 007]
> 
> , 姓名：罗杰 ID：3 性别：M CGPA：2 ]

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-22T08:31:46.283

我认为你有两个不同的问题。

**你的第一个问题：**

第一个是您有一个列表，并且您想在该列表中放置不同的对象（学生对象和主题对象）。您可以通过两种不同的方式执行此操作。第一种方法是简单地将列表与对象一起使用：`List<Object> list = new ArrayList<Object>();`之后您可以将所有内容添加到列表中，但您还必须强制转换所有内容 - 这不是一个好的解决方案。第二个更好的解决方案是为两个对象提供一个通用接口。例如 `IInformation`，你的类实现的东西。但是可能很难为学生对象和主题对象找到合适的接口。但这取决于你的创造力。

**你的第二个问题：**

现在到你的第二个问题。我认为你的设计、架构或只是你想做的方式是错误的。你有什么问题？为什么要将信息放在学生后面的列表中？有充分的理由吗？我认为有更好的解决方案。例如，您的学生对象可以保存主题信息。那将是合乎逻辑的。作为一名学生，我知道我正在学习的科目。另一种方法是创建第三个对象来保存学生和学科之间的映射（即关系）：

```
class Relation {

private Student student;
private Subject subject;
} 
```

然后，您可以将此类对象存储在列表中。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-22T09:44:52.103

我认为您应该采取的方法类似于：

```
class Student{ 
   private String name, ID;
   private int gpa, age;
   //More personalia stuff...

   private ArrayList<Subject> subjects;

   public void addSubject (Subject new_subject) { subjects.add(new_subject); }
   public void addSubjects (List <Subject> subjects_list) {
       for (Subject s : subjects_list) addSubject(s);
   }

   //Getters 
   public int getGPA() { return gpa; }
   public int getAge() { return age; }
   public String getName() { return name; }

   //.. More personalia getters

   //Setters 
   public void setGPA(int new_gpa) { gpa = new_gpa; }

 }

class Subject { 
    String description;
    String ID;

} 
```

* * *

现在，如果您有学生名单，请说：

```
 ArrayList <Student> all_students; 
```

在这里，您可以浏览列表并向其中的任何一个或全部添加主题。

编辑：添加了一些 getter 和 setter，让您更清楚地访问对象信息。

* * *

编辑 2 以解决您更新的帖子：您的代码存在许多问题。让我们从最高级的东西到低级的东西（与重要性不同）

**1) 类名** 一个类不应称为“Main”。目前尚不清楚该类是什么。取而代之的是，称其为：学生学科注册系统。`class StudentRegister`应该没问题。

**2) 类内容** 您将类`Subject`作为内部类包含在`Student`. 这是没有意义的，因为一门学科不是学生的一部分（在现实生活中的字面意思）。不过，这还不是最糟糕的部分；拥有`Subject`作为内部班级将使您为每个学生创建大量相同的科目。这是完全多余的。

现在，您还在每个 Student 对象中包含了所有学生的列表。这是故意的吗？如果是这样，这似乎有点误导。学生`A`不需要，也可能永远不会知道所有其他学生。更不用说，每次添加新学生 N 时，都需要添加`N`当前存在的所有学生对象。这也是多余的。

* * *

**建议的解决方案**

让我们想想你作为学生所知道的。你知道 ：

*   你的年龄（私人年龄）
*   你的 GPA（私人 int GPA）
*   您的 ID（私有字符串 ID）
*   你的名字（私人字符串名称）
*   您参加的科目清单（私人清单科目）

*请注意，您作为学生无法控制课程描述和 ID 是什么*

所有这些私有变量都是私有的，因为这些是您作为学生应某人要求披露的内容。这类似于有人问你“你叫什么名字？” 或“你几岁？” 等等。这就是你通过实现像`getName()`,之类的 getter 来完成的`getAge()`。

现在让我们考虑斜体部分。当有人问您正在学习什么课程时，您只需参考您和其他在大学就读的学生常见的课程列表。您不会创建别人不知道的自己的课程。因此，Subject 不应该是 Student 类中的内部类。相反，它是对大学提供的课程对象的引用（即指针）（继续阅读以获取进一步解释）

现在考虑一个课程对象。该课程对象不需要知道：

*   在给定年份注册的学生列表
*   任何其他科目

任何给定的课程对象都需要知道：

*   这是课程描述
*   课程编号
*   字符串表示形式（即您已实现为 toString() 的内容）

最后，在您的`StudentRegistry`班级中，您现在应该有两个列表： - 在大学注册的学生列表：`List <Student> all_students;` - 提供的所有科目/课程的列表：`List all_subjects;

Remember that each students have methods for adding subjects? You simply refer to the course objects that exist in the studentRegistry and ask each student to add those to their subject list. **No new subject objects will be created.** Any and all subjects in every student's study plan will refer to objects in the `all_subjects` list contained in the StudentRegistry class

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-22T08:07:31.693

您可以使用 List 类的 add 方法，该方法也采用索引。

看看[方法 javadocs](http://docs.oracle.com/javase/6/docs/api/java/util/List.html#add%28int,%20E%29)。

# ruby-on-rails-3 - 2012：rails 3.2 构建基于订阅的应用程序？

> ID：10266250
> 
> 赞同：0
> 
> 时间：2012-04-22T08:03:46.763
> 
> 标签：ruby-on-rails-3, ruby-on-rails-3.2, saas

任何人都可以建议基于 rails 3.2 的基于更新订阅的应用程序？我需要大本营 login.app.ltd、signup.app.ltd 之类的基本结构布局，例如保护数据免受多个用户在彼此帐户中流动。

似乎很难找到一个好的起点，任何有一些信息好的代码示例的人请分享

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-22T08:26:48.240

这是一个非常笼统的问题，但你看过 Devise 吗？

[https://github.com/plataformatec/devise](https://github.com/plataformatec/devise)

它有一个示例应用程序列表，您可以在其中查看它的使用方式：

[https://github.com/plataformatec/devise/wiki/Example-Applications](https://github.com/plataformatec/devise/wiki/Example-Applications)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-25T15:35:24.210

它不是免费的，但我的[SaaS Rails Kit](http://railskits.com/saas/)提供了你想要的东西。

# php - 更改通过表单上传的 tmp 文件的文件名

> ID：10266259
> 
> 赞同：4
> 
> 时间：2012-04-22T08:05:27.220
> 
> 标签：php, variables, file-io

就像标题一样，我想更改用户通过表单上传的文件的文件名。这是代码

**HTML**

```
 <form action="editprofile.php" method="POST" enctype="multipart/form-data">
         <p>Upload your image:<p /><input type="file" name="myfile"></p><br />
         <p><input type="radio" name="type" value="defaultDot">Use Default</p>
         <p><input type="submit" name="updateAvatar"></p>
    </form> 
```

这是我的 php 脚本，它将上传的文件移动到正确的目录
**PHP**

```
 $name = $_FILES['myfile']['name'];
    $tmp_name = $_FILES['myfile']['tmp_name'];
    $size = getimagesize($_FILES['myfile']['tmp_name']);
    if($name){
        //start upload process
        if($size != FALSE){
            $location = "images/avatars/$name";
            move_uploaded_file($tmp_name, $location);
            $query = mysql_query("UPDATE users SET avatar='$location' WHERE id=$id");
            $avaMessage = '<p><font size=2 color=aqua face=Tahoma>Avatar Updated - Uploaded Image!.</font></p>';
        }else{
            $avaMessage = '<p><font size=2 color=red face=Tahoma>Please only submit image files!</font></p>';
        }
    } 
```

我怎样才能给图像一个自定义名称？例如，我有一个名为**$username**的变量，它存储用户名的会话变量。如果我想将图像命名为具有相同文件扩展 名的**$username变量怎么办？**

**编辑：编辑：编辑：**
添加了你的 if 语句劳伦斯，我交换了 move_upload_files 中的变量，但它仍然不起作用......
**代码**

```
if($_SERVER['REQUEST_METHOD']=='POST' && isset($username) && is_numeric($id)
&& isset($_FILES['myfile']['error']) && $_FILES['myfile']['error']=='UPLOAD_ERR_OK'){
if($_POST['type'] != "defaultDot"){
    //$avaURL = $_POST['url'];
    //$updateURL = mysql_query("UPDATE users SET avatar='$avaURL' WHERE id=$id");
    //$avaMessage = '<p><font size=2 color=aqua face=Tahoma>Avatar Uploaded!</font></p>';
    $name    = basename($_FILES['myfile']['name']);
    $ext     = end(explode('.', $name));
    $move_to = "images/avatars/".preg_replace('/[^a-zA-Z0-9.-]/s', '_',$username).'.'.$ext;
    $info    = getimagesize($_FILES['myfile']['tmp_name']);

    if($name){
        //start upload process
            $allowed = array('image/png','image/jpg','image/gif');
            if($info[0]>0 && $info[1] > 0 && in_array($info['mime'],$allowed)){
                if($info[0]>200 || $info[1] > 200){
                    //File dimensions too large
                    $avaMessage = '<p><font size=2 color=red face=Tahoma>File dimensions too large.</font></p>';
                }else{
                    //File put contents will over write if file exsist
                    move_uploaded_file($_FILES['myfile']['tmp_name'], $move_to);
                    mysql_query("UPDATE users
                                SET avatar='".mysql_real_escape_string($move_to)."' 
                                WHERE id=".$id." AND owner='".$_SESSION['username']."'");
                    $avaMessage = 'Avatar Updated - Uploaded Image!.';
                }
            }else{
                $avaMessage = '<p><font size=2 color=red face=Tahoma>Please only submit image files!</font></p>';
            }   
    }else{
        $avaMessage = '<p><font size=2 color=red face=Tahoma>Please select a file!</font></p>';
    }

}else{
$avaURL = 'images/avatars/default.png';
$updateURL = mysql_query("UPDATE users SET avatar='$avaURL' WHERE id=$id");
$avaMessage = '<p><font size=2 color=aqua face=Tahoma>Avatar Updated - Default.</font></p>';
}
} 
```

即使使用固定的“POST”劳伦斯仍然无法工作......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-22T08:12:36.717

我认为[http://php.net/manual/en/function.pathinfo.php](http://php.net/manual/en/function.pathinfo.php)会做你需要的。解析 $location 并重建它，用您的 $username 替换 basename 字段。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-22T08:56:23.137

这是一种安全且安全的方法，发布请求需要检查，仅检查`$name`是不够的，`$username`需要去除任何特殊字符，`$id`需要检查其集合并且是数字，需要查找特定于文件的类型扩展名，还允许 mime 类型需要交叉匹配，加上宽度和高度大小需要检查，需要考虑很多，上传可能非常不安全，更不用说图像可以将 php 注入文件注释中，如果处理不当可能会被执行：

```
<?php 

if($_SERVER['REQUEST_METHOD']=='POST' && isset($username) && is_numeric($id)
&& isset($_FILES['myfile']['error']) && $_FILES['myfile']['error']=='UPLOAD_ERR_OK'){

    $name    = basename($_FILES['myfile']['name']);
    $ext     = end(explode('.', $name));
    $move_to = "images/avatars/".preg_replace('/[^a-zA-Z0-9.-]/s', '_',$username).'.'.$ext;
    $info    = getimagesize($_FILES['myfile']['tmp_name']);

    //not more then 200px
    if($info[0]>200 || $info[1] > 200){
        //file too large
    }

    $allowed = array('image/png','image/jpg','image/gif');
    if($info[0]>0 && $info[1] > 0 && in_array($info['mime'],$allowed)){
        move_uploaded_file($_FILES['myfile']['tmp_name'],$move_to);
        mysql_query("UPDATE users
                     SET avatar='".mysql_real_escape_string($move_to)."' 
                     WHERE id=".$id." AND owner='".$_SESSION['username']."'");
        $avaMessage = 'Avatar Updated - Uploaded Image!.';
    }else{
        //Not allowed
    }
}
?>

<form action="" method="POST" enctype="multipart/form-data">
     <!--1 MB = 1048576 bytes-->
     <input type="hidden" name="MAX_FILE_SIZE" value="1048576" />

     <p>Upload your image:<p /><input type="file" name="myfile"></p><br />
     <p><input type="radio" name="type" value="defaultDot">Use Default</p>
     <p><input type="submit" name="updateAvatar"></p>
</form> 
```

* * *

**更新编辑** 这是上传过程的 OOP 版本，也许你会觉得它很有趣，我也添加了所有可能的错误；p

```
<?php 
Class updateUserAvatar{
    public $upload_path;
    public $full_path;
    public $name;
    public $size;
    public $ext;
    public $output;
    public $input;
    public $prefix;
    private $allowed;

    function upload(){
        if($_SERVER['REQUEST_METHOD'] == 'POST'){
            if(isset($_FILES[$this->input]['error'])){
                if($_FILES[$this->input]['error'] == 0){
                    $this->name      = basename($_FILES[$this->input]['name']);
                    $file_p          = explode('.', $this->name);
                    $this->ext       = end($file_p);
                    $this->full_path = rtrim($this->upload_path,'/').'/'.preg_replace('/[^a-zA-Z0-9.-]/s', '_', $this->prefix).'.'.$this->ext;
                    $info            = getimagesize($_FILES[$this->input]['tmp_name']);
                    $this->size      = filesize($_FILES[$this->input]['tmp_name']);

                    if($info[0]>$this->allowed['dimensions']['width'] || $info[1] > $this->allowed['dimensions']['height']){
                        $this->output = 'File dimensions too large!';
                    }else{
                        if($info[0] > 0 && $info[1] > 0 && in_array($info['mime'],$this->allowed['types'])){
                            move_uploaded_file($_FILES[$this->input]['tmp_name'],$this->full_path);
                            $this->output = 'Upload success!';
                        }else{
                            $this->output = 'File not supported!';
                        }
                    }
                }else{
                    if($_FILES[$this->input]['error']==1){$this->output = 'The uploaded file exceeds the upload_max_filesize directive!';}
                    if($_FILES[$this->input]['error']==2){$this->output = 'The uploaded file exceeds the MAX_FILE_SIZE directive that was specified in our HTML form!';}
                    if($_FILES[$this->input]['error']==3){$this->output = 'The uploaded file was only partially uploaded!';}
                    if($_FILES[$this->input]['error']==4){$this->output = 'No file was uploaded!';}
                    if($_FILES[$this->input]['error']==6){$this->output = 'Missing a temporary folder!';}
                    if($_FILES[$this->input]['error']==7){$this->output = 'Failed to write uploaded file to disk!';}
                    if($_FILES[$this->input]['error']==8){$this->output = 'A PHP extension stopped the file upload!';}
                }
            }
        }
    }

    function setPath($var){
        $this->upload_path = $var;
    }
    function setAllowed($var=array()){
        $this->allowed = $var;
    }
    function setFilePrefix($var){
        $this->prefix = preg_replace('/[^a-zA-Z0-9.-]/s', '_', $var);
    }
    function setFormInput($var){
        $this->input = $var;
    }
}//END CLASS

if($_POST['type'] != "defaultDot"){
    //Setup
    $upload = new updateUserAvatar();
    $upload->setPath('./images/avatars/');
    $upload->setFilePrefix($username);
    $upload->setAllowed(array('dimensions'=>array('width'=>200,'height'=>200),
                              'types'=>array('image/png','image/jpg','image/gif')));
    $upload->setFormInput('myfile');
    $upload->upload();

    if($upload->output == 'Upload success!'){
        //do query
        $updateURL = mysql_query("UPDATE users SET avatar='$upload->full_path' WHERE id=$id");
    }
    //message
    $avaMessage = $upload->output;
}else{
    $avaURL = 'images/avatars/default.png';
    $updateURL = mysql_query("UPDATE users SET avatar='$avaURL' WHERE id=$id");
    $avaMessage = '<p><font size=2 color=aqua face=Tahoma>Avatar Updated - Default.</font></p>';
}
?> 
```

# php - 有什么方法可以在 PHP 中分离语法单词？

> ID：10266264
> 
> 赞同：2
> 
> 时间：2012-04-22T08:06:14.720
> 
> 标签：php, function

如果我有一个语法正确的 field_name。我想通过使用空间来分隔它。

例如，

1.  field_name 是**CylinderConfiguration**，我希望它像**Cylinder Configuration**
2.  field_name 是**NoofCylinders**，我希望它像**No of Cylinders**

请注意大写不是字符串中可识别的字符，整个字符串可能很小。

有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-22T08:12:39.580

> 有没有办法做到这一点？

是的。
此外，总是*有不止一种方法可以做到这一点。*其他数千个示例中的一个示例是可以拆分为或
的域名。`expertsexchange``experts exchange``expert sex change`

我建议不要为像打印字段名称这样的琐碎任务实现这种人工智能，而是将它们保持原样用于自动化目的，就像 PHPmyAdmin 所做的那样，或者在您的代码中创建一个硬编码的替换表。它将为您节省大量时间来完成这样一个琐碎的任务。

有人可能会建议您将命名约定更改为下划线作为单词分隔符的方式，这可以很容易地转换为空格，但我建议您不要这样做。数据库表名不打算在用户界面中使用。不要偷懒，手动创建输出字段名称。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-22T12:16:39.700

你可以通过使用字典来做到这一点`/usr/share/dict/words`（或者只是下载一个单词列表）。

伪代码中的算法将如下所示：

```
counter = 0
make input lowercase
loop i from 0 to length of input:
    if sub string from 0 to i of input is in dictionary:
        grammatical_words[counter] = sub string from 0 to i
        add one to counter

echo all words from grammatical_words 
```

这样做的缺点是任何以 a 或 i 开头的字符串基本上都会失败 - 一个类似的字符串`algorithm`将被拆分`a`，然后没有进一步的匹配。这意味着如果您确信自己不使用某些单词，则需要禁止使用它们。此外，复合词如`often`or`desktop`不会具有预期的行为。词根中有单词的单词，例如“平板电脑”、“手机”、“流行”等，也会失败。

通过一些调整，这可能会起作用。如果您知道使用哪些单词来加快速度并避免误报，我会制作一个自定义单词列表而不是使用系统词典。

# codeigniter - CodeIgniter - 私有函数

> ID：10266271
> 
> 赞同：11
> 
> 时间：2012-04-22T08:07:06.983
> 
> 标签：codeigniter

我现在开始玩 CodeIgniter。我使用他们的用户指南和其他可用于学习的第三方教程。我有点纠结于私有函数的命名。根据[用户指南](http://ellislab.com/codeigniter/user_guide/general/controllers.html#private)，我必须`_`在私有函数的名称中加上前缀 a。但[在本教程](http://www.jotorres.com/2012/03/create-user-login-with-codeigniter/)中，请检查**添加注销**部分。其中，有一个私有函数：`private function check_isvalidated()`. 在这里，它没有以字符 为前缀`_`。

所以这也是一个公认的命名约定？同时，还有一个叫`_output()`：[Processing Output](http://ellislab.com/codeigniter/user_guide/general/controllers.html#output)。这是一个具有私有函数命名约定的公共函数！

当我尝试以系统的方式学习时，这有点令人困惑。

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2012-04-22T08:35:15.877

`_`前缀是定义在`CONTROLLER`.

用户指南说：

> 在某些情况下，您可能希望对公共访问隐藏某些功能。要将函数设为私有，只需添加下划线作为名称前缀，它将不会通过 URL 请求提供。

[http://www.codeigniter.com/user_guide/general/controllers.html#private-methods](http://www.codeigniter.com/user_guide/general/controllers.html#private-methods)

添加 an`_`是 CodeIgniter 自己在控制器中（仅在控制器中）声明用户无法直接调用的函数的方式：

*   `Controller`函数映射到部分 URL ( `controller/function`)
*   控制器中有不应映射到 URL 的函数

    ```
    - they are declared as `private` (available since PHP5)
    OR
    - their names start with `_` (works also for PHP4) 
    ```

关于`_output`函数，它是公共的，但不能直接调用，因为它包含`_`.

为什么是公开的？

该函数由系统调用，因此需要从类外部访问，它不是私有函数。但是，它包含`_`确保不通过 URL 调用它。

总而言之，如果您的控制器中有不想通过 url 直接调用的函数，请添加`_`前缀或使用`private`访问运算符。其中任何一个都足够好。

仅供参考，其他框架，如 Yii 或 Zend 框架，`action`对所有可以通过 URL 调用（映射）的控制器函数使用前缀。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-22T08:41:55.653

虽然用户指南确实说您必须在**控制器**内的私有函数的函数名称前加上下划线，但这并不是强制性的。不过，遵循约定可能是个好主意，建议您这样做。

如果访问修饰符是`public`. 在这种情况下，如果您尝试通过 URL 访问该功能，则会出现`404`错误。但是在这种情况下，是否将访问修饰符设置为`private`它并不重要，是否在函数名称前加上下划线。

> 但在本教程中，请检查添加注销部分。其中，有一个私有函数：私有函数check_isvalidated()。在这里，它没有以字符 _ 为前缀。

在那个教程中，函数名没有下划线前缀，但它是一个私有函数，因为它被声明为一个。因此，尝试通过 URL 访问它是行不通的。

> 同时，还有一个叫_output()：处理输出。这是一个具有私有函数命名约定的公共函数！

我已经对此进行了解释，但我想指出，该`_output()`函数是那些将在脚本执行期间的某个时间点调用的特殊函数之一。在这种情况下，CodeIgniter 将在函数结束时调用此函数，就在需要向浏览器输出内容的时候。

# c++ - shared_ptr 空指针和赋值

> ID：10266272
> 
> 赞同：4
> 
> 时间：2012-04-22T08:07:07.063
> 
> 标签：c++, pointers, null, shared-ptr

我想使用 shared_ptr 就像使用实际指针一样。我希望能够做类似的事情

```
shared_ptr<int> a;
a = new int(5);
a = 0;
shared_ptr<int> foo()
    return 0; 
```

但默认情况下未实现。

我通过添加更改了 boost 库的 shared_ptr 的源代码

```
template<class Y> void operator=( int i )
{
    reset(i);
}
template<class Y> void reset(int i)
{
    this_type(i).swap(*this);
}
template<class Y> void operator=( Y * p )
{
    reset(p);
}
shared_ptr(int i): px(0), pn()
{
} 
```

唯一的事情是，如果我做 a = -1; 它会编译并给我一个空指针，这不应该是一个问题，因为通常你不能为指针分配一个整数值。

所以我的问题是，这是实现此功能的正确方法还是我忘记了可能使应用程序崩溃的情况？因为在我所见的任何地方，我看到为 shared_ptr 获取空指针的唯一方法是调用默认构造函数，与 ptr = 0; 相比，该构造函数在代码中不是很优雅。

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2012-04-22T08:14:17.380

不**，不要更改来源。**出于某种原因，非常聪明的人已经决定它的定义方式比你将要编辑的方式更好。

你所拥有的甚至没有意义。您不能将整数分配给指针，它们是两种不同的类型，但您已经赋予它这样的语义。你说：“......这不应该是一个问题，因为通常你不能为指针分配一个整数值”，但你还在问题的顶部说“我想像我一样使用 shared_ptr使用实际的指针”。好吧，它是什么？因为将整数分配给指针以将它们设置为 null 与您可以获得的实际指针差不多。

你需要退后一步，意识到你想要的并不总是最好的。您应该恢复这些更改并正确使用该类。我不想刻薄，但这真的不是你想走的路；它很危险，具有荒谬的语义，并且几乎无法维护。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-04-22T08:15:01.470

shared_ptr 实现了一个类似指针的接口，因此您可以使用`*`and`->`运算符。

默认构造的（空）shared_ptr 将在内部等于**nullptr**，因此您无需担心显式分配它。IE

```
std::shared_ptr<int> sh;
std::cout << ( sh.get() == nullptr ) << std::endl;

// Or alternatively:
std::cout << ( sh == nullptr ) << std::endl; 
```

* * *

此外，（在我看来）使用 shared_ptr 创建对象的最优雅的方法是`std::make_shared`函数。这还有一个额外的好处，即在某些编译器中（至少在 MSVC++ 上）效率更高一些，这是由于一些内部优化被称为*“我们知道你住在哪里成语”*

```
#include <memory>
#include <string>

class foo
{
public:
    foo(std::string s, int n) {}
};

int main()
{
    auto p = std::make_shared<int>();
    auto q = std::make_shared<foo>("hello", 2);
} 
```

# node.js - node.js、express 和不同的端口

> ID：10266276
> 
> 赞同：6
> 
> 时间：2012-04-22T08:07:29.617
> 
> 标签：node.js, express

我一直在玩 node.js，然后遇到了 express 框架。当使用不同的端口时，我似乎无法让它工作。

我在[http://localhost:8888](http://localhost:8888)上有我的 ajax，这是我在 Mac 上运行的 MAMP 服务器。

```
$.ajax({
    url: "http://localhost:1337/",
    type: "GET",
    dataType: "json",
    data: { }, 
    contentType: "application/json",
    cache: false,
    timeout: 5000,
    success: function(data) {
        alert(data);
    },
    error: function(jqXHR, textStatus, errorThrown) {
        alert('error ' + textStatus + " " + errorThrown);
    }
}); 
```

如您所见，我的 node.js 服务器正在[http://localhost:1337/](http://localhost:1337/)上运行。结果什么都没有返回，它抛出了一个错误。

有没有解决的办法？

谢谢

本

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-22T20:01:51.160

您遇到的问题是您正在尝试发出跨域请求，并且浏览器不允许这样做（是的，具有不同端口的相同主机名被视为不同的来源）。您在这里有三个选择：

**1\. 代理请求。**

如果可以的话，做这个。编写一些在 :8888 服务器上运行的代码，代理对 1337 的请求。你也可以通过在它们前面放置一个代理来做到这一点，像 Nginx 这样的东西非常擅长这一点并且易于设置

**2.使用CORS（跨域资源共享）**

请参阅：[http](http://en.wikipedia.org/wiki/Cross-origin_resource_sharing) ://en.wikipedia.org/wiki/Cross-origin_resource_sharing和[https://developer.mozilla.org/en/http_access_control](https://developer.mozilla.org/en/http_access_control)

这意味着在您的响应中添加一些标头来告诉浏览器跨域请求在这里是可以的。在您的 Express 服务器中添加如下中间件：

```
 function enableCORSMiddleware (req,res,next) {
     // You could use * instead of the url below to allow any origin, 
     // but be careful, you're opening yourself up to all sorts of things!
     res.setHeader('Access-Control-Allow-Origin',  "http://localhost:8888");
     next()
  }
 server.use(enableCORSMiddleware); 
```

**3.使用JSONP**

这是一种将“AJAX”响应编码为 Javascript 代码的技巧。然后您要求浏览器加载该代码，浏览器将愉快地跨域加载脚本，这样就解决了跨域问题。不过，它也可以让其他任何人绕过它，所以请确保这就是您想要的！

在服务器端，您需要将响应包装在 Javascript 函数调用中，如果您启用“jsonp 回调”选项，express 可以自动执行此操作，如下所示：

```
server.enable("jsonp callback"); 
```

然后使用“json()”响应方法发送您的响应：

```
server.get("/ajax", function(req, res) {
    res.json({foo: "bar"});
}); 
```

在客户端，您只需在 dataType 选项中将“json”更改为“jsonp”即可在 jQuery 中启用 JSONP：

```
dataType: "jsonp", 
```

# iphone - Xcode 4 和数据库

> ID：10266278
> 
> 赞同：2
> 
> 时间：2012-04-22T08:07:36.997
> 
> 标签：iphone, sql, xcode, database-server

我是编写 iPhone 应用程序的新手。

我几乎完成了界面的构建，并使用 Visual Studio 2008 构建了一个数据库。

现在我想将我的应用程序连接到该数据库，使用 SQL 服务器作为 Web 服务（充当我的应用程序和数据库之间的中间层）。稍后我将为数据库保留一个服务器。

**我的问题是：**我有一个登录视图，我要求输入用户名和密码，我如何使用来自 Xcode 的信息并将其发送到数据库进行验证？

您的帮助将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-22T19:59:14.310

根据您的描述，我不确定我是否理解，但如果您需要一个应用程序和一些包含数据的网络服务，您可以查看 Ray Wenderlich 的本教程： [http ://www.raywenderlich.com/2965/how-to -write-an-ios-app-that-uses-a-web-service](http://www.raywenderlich.com/2965/how-to-write-an-ios-app-that-uses-a-web-service)

此外，您可能会发现这个 SO 问题很有用： [iPhone app and web service](https://stackoverflow.com/questions/8620163/iphone-app-and-web-service)

# javascript - 如何设置选项以选择框

> ID：10266279
> 
> 赞同：3
> 
> 时间：2012-04-22T08:07:59.467
> 
> 标签：javascript, jquery, html, ajax

我的代码中有 2 个**选择**元素。一个用于美国各州 ( **#us_state** )，第二个用于城市 ( **#city_name** )。当我选择“州”时，第二个选择元素必须仅包含处于选定州的城市。我使用ajax，我完成了请求并得到了响应。响应格式为 id:name `{"26332":"Abbott Park","27350":"Addieville", ...}`。现在我想添加对选项**元素**的响应并将其附加到带有`#city_name id`. 但我不知道如何达到这个结果。`<option value="key">value</option>`

```
$('#us_state').bind('change', function() {
    var projectId = $("#inputtitle").val();     
    var stateId =  $(this).val(); 
    var arrayData = {"projectId": projectId, "stateId":stateId};
    $.ajax({
          type: "GET",
          url: "/bidboldly/projects/editproject/",        
          data: arrayData,
          success : function(response) {
             ............
             ..........                         
          },
          error: function(){
            alert("error");
          }
    })
}); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-22T08:22:03.933

遍历从响应中接收到的每个数组数据并在 var city 中获取城市名称。然后使用 jquery append 附加选项值（还记得使用清除迭代循环之外的选项`$('#city_name').html("");`）

```
$('#city_name').append('<option value="'+city+'">'+city+'</option>'); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-22T08:21:18.383

这是你要找的吗？

```
data = eval('( '+response' )'); //Parse the JSON data
for (zip in data) { //Iterate through each item in data
    $('#city_name').append('<option value="'+zip+'">'+data[zip]+'</option>'); //Append option to select element
} 
```

# python - 使用 Python 获取活动窗口

> ID：10266281
> 
> 赞同：45
> 
> 时间：2012-04-22T08:08:04.953
> 
> 标签：python, active-window

我想使用 python 在屏幕上获取活动窗口。

比如路由器的管理界面，输入用户名和密码为admin

该管理界面是我想使用 python 来自动输入用户名和密码来捕获的。

我需要什么进口才能做到这一点？

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2012-06-21T15:01:16.843

On windows, you can use the python for windows extensions ([http://sourceforge.net/projects/pywin32/](http://sourceforge.net/projects/pywin32/)):

```
from win32gui import GetWindowText, GetForegroundWindow
print GetWindowText(GetForegroundWindow()) 
```

Below code is for python 3:

```
from win32gui import GetWindowText, GetForegroundWindow
print(GetWindowText(GetForegroundWindow())) 
```

(Found this on [http://scott.sherrillmix.com/blog/programmer/active-window-logger/](http://scott.sherrillmix.com/blog/programmer/active-window-logger/))

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2019-10-12T14:15:39.713

**感谢 Nuno André 的回答，他展示了如何使用 ctypes 与 Windows API 进行交互。我使用他的提示编写了一个示例实现。**

该`ctypes`库自 v2.5 起包含在 Python 中，这意味着几乎每个用户都拥有它。而且它的界面比旧的和死的库`win32gui`（如撰写本文时最后更新于 2017 年）更干净。*（（2020 年末更新：死`win32gui`库已重命名为[pywin32](https://github.com/mhammond/pywin32)，因此，如果您想要一个维护的库，它现在又是一个有效的选择。但该库比我的代码慢 6%。））*

文档在这里：[https](https://docs.python.org/3/library/ctypes.html) ://docs.python.org/3/library/ctypes.html （如果你想编写自己的代码，你必须阅读它的使用帮助，否则会导致分段错误崩溃，呵呵。）

基本上，ctypes 包括最常见的 Windows DLL 的绑定。这是在纯 Python 中检索前景窗口标题的方法，无需外部库！只是内置的ctypes！:-)

ctypes 最酷的地方在于，您可以在*任何*Windows API 中搜索任何您需要的东西，如果您想使用它，您*可以*通过 ctypes 来实现！

**Python 3 代码：**

```
from typing import Optional
from ctypes import wintypes, windll, create_unicode_buffer

def getForegroundWindowTitle() -> Optional[str]:
    hWnd = windll.user32.GetForegroundWindow()
    length = windll.user32.GetWindowTextLengthW(hWnd)
    buf = create_unicode_buffer(length + 1)
    windll.user32.GetWindowTextW(hWnd, buf, length + 1)

    # 1-liner alternative: return buf.value if buf.value else None
    if buf.value:
        return buf.value
    else:
        return None 
```

性能非常好：`0.01`我的电脑上的 MILLISECONDS（`0.00001`秒）。

也可以在 Python 2 上进行非常小的更改。如果您使用的是 Python 2，我认为您只需要删除类型注释 ( `from typing import Optional`and `-> Optional[str]`)。:-)

享受！

**Win32技术说明：**

该`length`变量是*UTF-16（Windows 宽“Unicode”）字符中**实际*文本的长度。（这不是 BYTES 的数量。）我们必须添加以在 C 样式字符串的末尾为空终止符添加空间。如果我们不这样做，缓冲区中将没有足够的空间来容纳实际文本的最终真实字符，Windows 将截断返回的字符串（它这样做是为了确保它适合超级重要的最终字符串 Null -终结者）。*`+ 1`*

 *该`create_unicode_buffer`函数为那么多 UTF-16 CHARACTERS 分配空间。

大多数（或全部？总是阅读微软的 MSDN 文档！）与 Unicode 文本相关的 Windows API 将缓冲区长度作为字符，而*不是字节。*

还要仔细查看函数调用。有些以`W`（例如`GetWindowTextLengthW`）结尾。这代表“宽字符串”，它是 Unicode 字符串的 Windows 名称。执行这些`W`调用以获取正确的 Unicode 字符串（具有国际字符支持）非常重要。

PS：Windows 长期以来一直使用 Unicode。我知道 Windows 10*完全*是Unicode 并且只需要`W`函数调用。我不知道旧版本的 Windows 使用*其他*多字节字符串格式的确切截止日期，但我认为那是在 Windows Vista 之前，谁在乎呢？旧的 Windows 版本（甚至 7 和 8.1）已死且不受 Microsoft 支持。

再次......享受！:-)

**2020 年末更新，基准与`pywin32`图书馆：**

```
import time

import win32ui

from typing import Optional
from ctypes import wintypes, windll, create_unicode_buffer

def getForegroundWindowTitle() -> Optional[str]:
    hWnd = windll.user32.GetForegroundWindow()
    length = windll.user32.GetWindowTextLengthW(hWnd)
    buf = create_unicode_buffer(length + 1)
    windll.user32.GetWindowTextW(hWnd, buf, length + 1)

    return buf.value if buf.value else None

def getForegroundWindowTitle_Win32UI() -> Optional[str]:
    # WARNING: This code sometimes throws an exception saying
    # "win32ui.error: No window is is in the foreground."
    # which is total nonsense. My function doesn't fail that way.
    return win32ui.GetForegroundWindow().GetWindowText()

iterations = 1_000_000

start_time = time.time()
for x in range(iterations):
    foo = getForegroundWindowTitle()
elapsed1 = time.time() - start_time
print("Elapsed 1:", elapsed1, "seconds")

start_time = time.time()
for x in range(iterations):
    foo = getForegroundWindowTitle_Win32UI()
elapsed2 = time.time() - start_time
print("Elapsed 2:", elapsed2, "seconds")

win32ui_pct_slower = ((elapsed2 / elapsed1) - 1) * 100
print("Win32UI library is", win32ui_pct_slower, "percent slower.") 
```

在 AMD Ryzen 3900x 上多次运行后的典型结果：

我的函数：4.5769994258880615 秒

Win32UI 库：4.8619983196258545 秒

Win32UI 库慢 6.226762715455125%。

但是，差异很小，因此您可能想使用该库，因为它已经恢复了生机（它自 2017 年以来就已经死了）。但是您将不得不处理该库的奇怪的“前台没有窗口”异常，我的代码没有遇到这种情况（请参阅基准代码中的代码注释）。

不管怎样……享受吧！

* * *

## 回答 #3

> 赞同：21
> 
> 时间：2016-04-05T07:23:58.417

以下脚本应该可以在 Linux、Windows 和 Mac 上运行。目前仅在 Linux (Ubuntu Mate Ubuntu 15.10) 上进行了测试。

## 先决条件

**对于 Linux**：

安装`wnck`（`sudo apt-get install python-wnck`在 Ubuntu 上，请参阅[libwnck](https://developer-old.gnome.org/libwnck/stable/getting-started.html)。）

**对于 Windows**：

确保`win32gui`可用

**对于 Mac**：

确保`AppKit`可用

## 剧本

```
#!/usr/bin/env python

"""Find the currently active window."""

import logging
import sys

logging.basicConfig(format='%(asctime)s %(levelname)s %(message)s',
                    level=logging.DEBUG,
                    stream=sys.stdout)

def get_active_window():
    """
    Get the currently active window.

    Returns
    -------
    string :
        Name of the currently active window.
    """
    import sys
    active_window_name = None
    if sys.platform in ['linux', 'linux2']:
        # Alternatives: https://unix.stackexchange.com/q/38867/4784
        try:
            import wnck
        except ImportError:
            logging.info("wnck not installed")
            wnck = None
        if wnck is not None:
            screen = wnck.screen_get_default()
            screen.force_update()
            window = screen.get_active_window()
            if window is not None:
                pid = window.get_pid()
                with open("/proc/{pid}/cmdline".format(pid=pid)) as f:
                    active_window_name = f.read()
        else:
            try:
                from gi.repository import Gtk, Wnck
                gi = "Installed"
            except ImportError:
                logging.info("gi.repository not installed")
                gi = None
            if gi is not None:
                Gtk.init([])  # necessary if not using a Gtk.main() loop
                screen = Wnck.Screen.get_default()
                screen.force_update()  # recommended per Wnck documentation
                active_window = screen.get_active_window()
                pid = active_window.get_pid()
                with open("/proc/{pid}/cmdline".format(pid=pid)) as f:
                    active_window_name = f.read()
    elif sys.platform in ['Windows', 'win32', 'cygwin']:
        # https://stackoverflow.com/a/608814/562769
        import win32gui
        window = win32gui.GetForegroundWindow()
        active_window_name = win32gui.GetWindowText(window)
    elif sys.platform in ['Mac', 'darwin', 'os2', 'os2emx']:
        # https://stackoverflow.com/a/373310/562769
        from AppKit import NSWorkspace
        active_window_name = (NSWorkspace.sharedWorkspace()
                              .activeApplication()['NSApplicationName'])
    else:
        print("sys.platform={platform} is unknown. Please report."
              .format(platform=sys.platform))
        print(sys.version)
    return active_window_name

print("Active window: %s" % str(get_active_window())) 
```

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2019-06-13T02:43:54.950

对于这样的任务，确实不需要导入任何外部依赖项。Python 带有一个非常简洁的外部函数接口 - [`ctypes`](https://docs.python.org/3/library/ctypes.html)，它允许本地调用 C 共享库。它甚至包括最常见的 Win32 DLL 的特定绑定。

例如获取前景窗口的 PID：

```
import ctypes
from ctypes import wintypes

user32 = ctypes.windll.user32

h_wnd = user32.GetForegroundWindow()
pid = wintypes.DWORD()
user32.GetWindowThreadProcessId(h_wnd, ctypes.byref(pid))
print(pid.value) 
```

* * *

## 回答 #5

> 赞同：10
> 
> 时间：2017-02-22T23:10:48.497

对于 Linux 用户：提供的所有答案都需要像“wx”这样的附加模块，这些模块在安装时有很多错误（“pip”在构建时失败），但我能够很容易地修改这个解决方案 -> [original source](https://stackoverflow.com/questions/3983946/get-active-window-title-in-x)。原始版本中存在错误（[Python TypeError on regex](https://stackoverflow.com/questions/5184483/python-typeerror-on-regex)）

```
import sys
import os
import subprocess
import re

def get_active_window_title():
    root = subprocess.Popen(['xprop', '-root', '_NET_ACTIVE_WINDOW'], stdout=subprocess.PIPE)
    stdout, stderr = root.communicate()

    m = re.search(b'^_NET_ACTIVE_WINDOW.* ([\w]+)$', stdout)
    if m != None:
        window_id = m.group(1)
        window = subprocess.Popen(['xprop', '-id', window_id, 'WM_NAME'], stdout=subprocess.PIPE)
        stdout, stderr = window.communicate()
    else:
        return None

    match = re.match(b"WM_NAME\(\w+\) = (?P<name>.+)$", stdout)
    if match != None:
        return match.group("name").strip(b'"')

    return None

if __name__ == "__main__":
    print(get_active_window_title()) 
```

优点是它无需额外的模块即可工作。如果您希望它跨多个平台工作，只需更改命令和正则表达式字符串以根据平台获取所需的数据（使用上面显示的标准 if/else 平台检测**sys.platform**）。

附带说明：当使用“sudo apt-get install python-wnck”安装时，import wnck 仅适用于 python2.x，因为我使用的是 python3.x，唯一的选择是我没有测试过的 pypie。希望这对其他人有帮助。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2021-11-05T14:37:34.043

这仅适用于 Windows

```
import win32gui
import win32process

 def get_active_executable_name():
        try:
            process_id = win32process.GetWindowThreadProcessId(
                win32gui.GetForegroundWindow()
            )
            return ".".join(psutil.Process(process_id[-1]).name().split(".")[:-1])
        except Exception as exception:
            return None 
```

我建议查看[这个](https://stackoverflow.com/a/36419702/14258194)答案，以使其在 linux、mac 和 windows 上运行。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2021-06-19T22:19:16.010

在 X11 下的 Linux 中：

```
xdo_window_id = os.popen('xdotool getactivewindow').read()
print('xdo_window_id:', xdo_window_id) 
```

将以十进制格式打印活动窗口 ID：

```
xdo_window_id: 67113707 
```

注意`xdotool`必须先安装：

```
sudo apt install xdotool 
```

注意`wmctrl`窗口 ID 使用十六进制格式。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2020-09-10T03:21:41.433

我在linux界面（Lubuntu 20）上遇到了同样的问题。我所做的是使用 wmctrl 并使用来自 python 的 shell 命令执行它。

一、安装wmctrl `sudo apt install wmctrl`

然后，添加此代码：

```
import os
os.system('wmctrl -a "Mozilla Firefox"') 
```

参考 wmctrl： [https ://askubuntu.com/questions/21262/shell-command-to-bring-a-program-window-in-front-of-another](https://askubuntu.com/questions/21262/shell-command-to-bring-a-program-window-in-front-of-another)

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2016-01-08T15:00:23.907

只是想添加以防万一，我的程序有一个功能（它是我电脑照明的软件我有这个简单的几行功能：

```
def isRunning(process_name):
   foregroundWindow = GetWindowText(GetForegroundWindow())
   return process_name in foregroundWindow 
```

* * *

## 回答 #10

> 赞同：-10
> 
> 时间：2012-04-22T11:29:07.917

尝试使用 wxPython：

```
import wx
wx.GetActiveWindow() 
```*

# c# - 如何在 C# 中使用热键启动程序？

> ID：10266282
> 
> 赞同：3
> 
> 时间：2012-04-22T08:08:13.920
> 
> 标签：c#, .net, file, hotkeys, root

我正在使用 C# 制作程序，用户应该是盲人。我已经做了所有事情，但我记得盲人用户无法像任何人一样启动应用程序。

那么在C#中是否可以将程序添加到启动程序列表并将其发送到托盘，例如当用户按下Esc键时，程序启动。

谢谢..

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-22T08:12:55.903

它可以在没有任何连接到 c# 的情况下完成，请按照以下说明操作：

[http://windows.microsoft.com/en-US/windows-vista/Create-keyboard-shortcuts-to-open-programs?SignedIn=1](http://windows.microsoft.com/en-US/windows-vista/Create-keyboard-shortcuts-to-open-programs?SignedIn=1)

或教程：

[http://www.butterscotch.com/tutorial/Launch-A-Program-With-Windows-Hotkeys](http://www.butterscotch.com/tutorial/Launch-A-Program-With-Windows-Hotkeys)

# jmock - Jmock 完全匹配字符串参数

> ID：10266286
> 
> 赞同：0
> 
> 时间：2012-04-22T08:08:49.657
> 
> 标签：jmock

我从 Jmock 的主页上读到了 matchers [，](http://www.jmock.org/matchers.html)在最上面有一个关于字符串匹配器的例子。我不明白，因为根据示例，匹配字符串就像编写 import static org.hamcrest.Matchers.*; 一样容易。然后使用 stringContains 函数，但这对我的实现不起作用。

我想做的就是

```
new Expectations() {{
  mockedType.someFunction(with(   **match string here**    ) );
}}; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-26T08:44:17.773

```
new Expectations() {{
    allowing(mockedType).someFunction("My String"); when  ... ; will ... ; then ...
}}; 
```

必须工作

# android - NDK 构建仅限 C++ 的应用程序

> ID：10266291
> 
> 赞同：1
> 
> 时间：2012-04-22T08:09:05.687
> 
> 标签：android, android-ndk

我正在尝试在 Android 上构建本机守护程序。目的是控制一些特定的硬件，Java 应用程序将能够使用套接字与这个守护进程通信。

同时我一直在使用 cmake 来编译我的库、演示和真正的守护进程（顺便说一句，它工作得很好）。我现在正在尝试做两件不同的事情：

1.  使用`ndk-build`.
2.  通过使 JNI 调用与 c++ 守护程序的工作方式非常相似，将 C++ 守护程序移植到 Android 服务。

据我了解，`ndk-build`不能制作本机应用程序，而只能制作本机库，而这些库又可以由 Java GUI 加载……我正确吗？对于第 1 步，我真的不需要 java（并且我已经证明了这一点），但我还没有找到一种 `ndk-build`吐出精灵应用程序的方法。

供参考 - 我正在使用 cmake，如下所述：http: [//opekar.blogspot.com/2011/06/android-cmake-is-much-easier-in-ndk-r5b.html](http://opekar.blogspot.com/2011/06/android-cmake-is-much-easier-in-ndk-r5b.html)

这样我就可以为“普通”linux构建，也可以为android使用源代码构建。如果你问我，这是相当不错的 hack。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-07-22T19:16:36.607

另一种方法是使用与 NDK 捆绑在一起的脚本`make-standalone-toolchain.sh`来创建一个独立的工具链，然后使用它来编译您的项目。下面的 shell 代码说明了如何使用它：

```
# Assumed path to the NDK, change it to suit your environment.
NDK_HOME=$HOME/bin/android-ndk-r8e

# Desired API and NDK versions and destination folder of
# the stand-alone toolchain, change them to suit your needs.
api=14
ver=4.7
folder=$HOME/bin/android-$api-ndk-$ver

# Create folder if it doesn't already exist.
mkdir -p $folder

$NDK_HOME/build/tools/make-standalone-toolchain.sh \
    --toolchain=arm-linux-androideabi-$ver \
    --platform=android-$api --install-dir=$folder 
```

运行上面的行将在 处生成一个新的独立工具链`$HOME/bin/android-14-ndk-4.7`，然后您可以将其用作任何常规 C/C++ 交叉编译工具链。

使用独立工具链的优势在于，它使将 Linux 项目交叉编译到 Android 变得轻而易举；例如，请参阅我[将 Valgrind 移植到 Android ARMv7 的端口](https://github.com/xperroni/Valdroid)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-22T09:38:17.547

正如@Mārtiņš Možeik 在其中一条评论中提到的那样，这幅`Android.mk`作品将起作用：

```
LOCAL_PATH       := $(call my-dir)
include $(CLEAR_VARS)
LOCAL_MODULE     := my_daemon
LOCAL_C_INCLUDES := src
LOCAL_SRC_FILES  := src/daemon.c
include $(BUILD_EXECUTABLE) 
```

我注意到的一件事是，这个“makefile”生成的二进制文件是 130k，而 cmake 生成的二进制文件大约是 40 kb。这是因为我用作`-s`a`C_FLAG`然后 gcc 将动态剥离生成的对象。这可以稍后通过调用`$NDK/toolchains/arm-linux-androideabi-4.4.3/prebuilt/linux-x86/bin/arm-linux-androideabi-strip`或为您的拱门提供相应的条来完成。

由于我没有在互联网上找到有关此功能的文档，因此还有一些话：

*   这很好用，这里没问题:)
*   这必须保存在一个名为`jni/Android.mk`.
*   代码**必须**保存在 JNI 目录中
*   如果您的代码在`jni`目录之外，这会变得很难看，但并非不可能。您只需要在代码前面加上相应的前缀，不要忘记修改包含路径。这留给读者作为练习。
*   仍然不确定为什么从 Android 构建系统生成的代码比`cmake`. 我之前说过`strip`不调用 - 但是在将 *.so 复制到`lib`目录之前调用它。
*   仍然不知道如何将该二进制文件打包成一个 android 包，甚至不知道如何在不修改 Android 代码的情况下运行它（例如当系统启动时）。我假设我可以编写一个在启动时启动的 Java 服务，然后`execvp`是守护进程。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-22T08:16:45.980

您的选项 2 是 AFAIK 的唯一方法。

# sqlite - 使用 ContentValues 和 update() 更新 SQLite 中的外键字段

> ID：10266299
> 
> 赞同：1
> 
> 时间：2012-04-22T08:11:51.983
> 
> 标签：sqlite

我无法在我的 Android 应用程序中运行的 SQLite 表中获取要更新的外键。

我有两张表，CASHFLOW_TABLE 和 ACCOUNT_TABLE。CASHFLOW_TABLE 有一个引用 ACCOUNT_TABLE 的 _id 列的外键列。我想更新一行 CASHFLOW_TABLE 中的值，但是当我运行此代码时

```
String where = "_id=?";
String[] whereArgs = {"7"};

ContentValues cv = new ContentValues();
cv.put(CF_COL_PURPOSE, "Coffee");
cv.put(CF_COL_VALUE, 2.5);
cv.put(CF_COL_ACCOUNT_ID, 4);

myDatabase.update(CF_TABLE_NAME, cv, where, whereArgs); 
```

我收到错误消息：

E/Database(22962)：错误更新 ACCOUNT_ID=4 VALUE=2.5 PURPOSE=Coffee 使用 UPDATE CASHFLOW_TABLE SET ACCOUNT_ID=?, VALUE=?, PURPOSE=? 在哪里_id =？

我认为这与 CF_COL_ACCOUNT_ID 是外键这一事实有关的原因是，当我删除

```
 cv.put(CF_COL_ACCOUNT_ID, 4); 
```

并运行代码只是为了更新其他值，它工作正常。任何想法我做错了什么？

更新：当我尝试将更新作为 SQL 语句运行时，出现以下错误，这似乎表明问题出在外键约束上：

E/Database(24650)：执行“更新 CASHFLOW_TABLE set VALUE= 2.5, PURPOSE='coffee', ACCOUNT_ID=4 where _id = 7' 时在 0x314530 出现故障 19（外键约束失败）

下面是 onCreate() 中设置表和外键约束的代码。我在这里稍微简化了一点——还有其他列和一个其他外键（对于此处未显示的第三个表）。

```
db.execSQL("Create table " + A_TABLE_NAME + " (" + A_COL_ID             + " integer primary key autoincrement, " + A_COL_NAME
+ " text default ('" + A_DEFAULT_ACCOUNT + "'));");

db.execSQL("Create table " + CF_TABLE_NAME + " (" + CF_COL_ID
      + " integer primary key autoincrement, " + CF_COL_VALUE
      + " real not null, "
      + CF_COL_PURPOSE + " text not null, " + CF_COL_TIMESTAMP
      + " text not null default (strftime('%s','now')), "
      + CF_COL_ACCOUNT_ID
      + " integer not null default 1, foreign key ("
      + CF_COL_ACCOUNT_ID + ") references " + A_TABLE_NAME + " ("
      + A_COL_ID + ") on delete set default);"); 
```

# c++ - C++ 检查两个版本的函数

> ID：10266300
> 
> 赞同：2
> 
> 时间：2012-04-22T08:12:04.797
> 
> 标签：c++, arrays, function, pointers, point

我正在用 C++ 编写一个练习，我编写了一个在我看来是有效的代码，但我不确定，因为我还是一个初学者，有人可以检查它并告诉我它们是否是相同与否。

解决方案代码：

```
Point *PointArray::get( const int pos) {
    return pos >= 0 && pos < size ? points + pos : NULL;
} 
```

我的代码是：

```
Point* PointArray::get (const int position) {
    return &(data[position]);
} 
```

我意识到在我的代码中我必须检查条件以检查是否返回空指针，但除此之外，我的版本是否与`points + pos`

`points`&`data`是 Point 类的数组，我命名为 mine data，解决方案将其命名为 points。

编辑：

添加条件后我的代码：

```
Point* PointArray::get (const int position) {
    return ((position >= 0 && position < size) ? &(data[position]) : NULL);
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-22T08:16:10.507

简而言之，他们做同样的事情。不过还是有一些区别：

1) 解决方案代码检查数组边界。你的解决方案没有。

2）该解决方案使用指针算法并避免额外的取消引用/地址操作（大多数编译器会为您优化）。请参阅[效率：数组与指针](https://stackoverflow.com/questions/2305770/efficiency-arrays-vs-pointers)。

# javascript - 异步调用串行生成的函数

> ID：10266301
> 
> 赞同：1
> 
> 时间：2012-04-22T08:12:14.800
> 
> 标签：javascript, node.js, asynchronous

我在串行调用生成的函数时遇到问题。我正在使用异步库，当不需要深度回调调用时，代码似乎可以工作。当我添加真实场景时，它会引发错误。

这是有效的示例，返回 0 到 4 的数组：

```
Scrape.prototype.generatePageFunctions = function() {
  var functionList = new Array(), self = this;

  for (var i = 0; i < this.pageSet; i++) {
    (function(i) {
      functionList.push(function(cb) {
        // Inner functions which will be called in seriers
        var timeoutTime = parseInt(Math.random() * 5000 + 3000, 10);

        setTimeout(function() {
          self.setIndex(i);
          //self.getSite(function)

          cb(null, i);
        }, timeoutTime);
      });
    })(i);
  }
  return functionList;
}

Scrape.prototype.run = function() {
  var functionList = this.generatePageFunctions();

  async.series(functionList, function(err, results) {
    console.log('Job is completed ');
    console.log(results);
  });
} 
```

现在添加真实场景，例如下载站点然后放入回调：

```
Scrape.prototype.generatePageFunctions = function() {
  var functionList = new Array(), self = this;

  for (var i = 0; i < this.pageSet; i++) {
    (function(i) {
      functionList.push(function(cb) {
        // Inner functions which will be called in seriers
        var timeoutTime = parseInt(Math.random() * 5000 + 3000, 10);

        setTimeout(function() {
          self.setIndex(i);
          self.getSite(function(result) {
            // Async callback to pass the data
            cb(null, result);
          });
        }, timeoutTime);
      });
    })(i);
  }
  return functionList;
} 
```

错误是这样的，即使传递而不是结果迭代器变量 i：

```
/home/risto/scrape/node_modules/async/lib/async.js:185
            iterator(x.value, function (err, v) {
                      ^
TypeError: Cannot read property 'value' of undefined
    at /home/risto/scrape/node_modules/async/lib/async.js:185:23
    at /home/risto/scrape/node_modules/async/lib/async.js:108:13
    at /home/risto/scrape/node_modules/async/lib/async.js:119:25
    at /home/risto/scrape/node_modules/async/lib/async.js:187:17
    at /home/risto/scrape/node_modules/async/lib/async.js:491:34
    at /home/risto/scrape/scraper/scrape.js:114:13
    at /home/risto/scrape/scraper/scrape.js:64:16
    at Object.<anonymous> (/home/risto/scrape/scraper/engines/google.js:58:12)
    at Function.each (/home/risto/scrape/node_modules/cheerio/lib/api/utils.js:133:19)
    at [object Object].each (/home/risto/scrape/node_modules/cheerio/lib/api/traversing.js:69:12) 
```

// 编辑

只有添加到完整回调中的结果是第一个，其他函数永远不会被调用。此外，如果这很重要，函数会返回对象文字。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-22T08:27:28.360

您的代码没有任何问题。创建一个简单的测试用例表明了这一点。

我创建了一个模拟：

```
Scrape = function() {
  this.pageSet = 5;
}

Scrape.prototype.setIndex = function() {
}

Scrape.prototype.getSite = function(cb) {
  cb('works');
} 
```

并调用`run`它输出预期的方法：

```
[ 'works', 'works', 'works', 'works', 'works' ] 
```

所以问题出在其他地方。您是否尝试过检查方法中的`functionList`变量`run`？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-22T13:59:30.577

谢谢@KARASZI István，上面的所有代码都是正确的，问题似乎出在其他地方。最深的回调被多次调用，但最外层的回调只被调用一次。

# r - “近似”R中日期点的导数

> ID：10266308
> 
> 赞同：2
> 
> 时间：2012-04-22T08:13:09.057
> 
> 标签：r, function, for-loop, time-series, derivative

所以我有一个 MODIS NDVI 值的时间序列（非地理极客的植被值从 0 到 1），我试图通过使用`for`循环来近似导数。

这是我的数据样本：

```
> m2001
   date  value    valnorm
1     1 0.4834 0.03460912
2    17 0.4844 0.03664495
3    33 0.5006 0.06962541
4    49 0.4796 0.02687296
5    65 0.5128 0.09446254
6    81 0.4915 0.05109935
7    97 0.4664 0.00000000
8   113 0.5345 0.13864007
9   129 0.8771 0.83611564
10  145 0.9529 0.99043160
11  161 0.9250 0.93363192
12  177 0.9450 0.97434853
13  193 0.9491 0.98269544
14  209 0.9434 0.97109121
15  225 0.9576 1.00000000
16  241 0.8992 0.88110749
17  257 0.9115 0.90614821
18  273 0.8361 0.75264658
19  289 0.5725 0.21600163
20  305 0.5188 0.10667752
21  321 0.5467 0.16347720
22  337 0.5484 0.16693811
23  353 0.5427 0.15533388 
```

*   第 1 列是像素值的儒略日
*   第 2 列是原始 NDVI 值
*   第 3 列是从 0-1 延伸的 NDVI（这是一种标准化技术，因为 NDVI 实际上很少达到 1 或 0）。

我对编程和 R 还是很陌生，但我想我已经设法拼凑出对它的薄弱掌握。我要做的是创建一个新列，其值可以让我对数据点的局部斜率有所了解。

我想出的功能是这样的：

```
deriv <- function(x1=1:23, x2=1){
    for (i in x1){
    i1 <- c(x1[i-1], x1[i], x1[i+1])
    i2 <- c(x2[i-1], x2[i], x2[i+1])
        deriv.func <- lm(i2~i1, na.action=NULL)
    } return(deriv.func$coef[[2]])
} 
```

当我运行它时会发生什么：

```
> deriv <- function(x1=1:23, x2=1){
+ for (i in x1){
+     i1 <- c(x1[i-1], x1[i], x1[i+1])
+     i2 <- c(x2[i-1], x2[i], x2[i+1])
+ deriv.func <- lm(i2~i1, na.action=NULL)
+ } return(deriv.func$coef[[2]])
Error: unexpected symbol in:
"deriv.func <- lm(i2~i1, na.action=NULL)
} return"
> }
Error: unexpected '}' in "}"
> 
```

我不确定我做错了什么，因为当我为 i 填写一个值时，我可以解析它

```
> i=6
> x1=m2001$date
> x2=m2001$valnorm
>     i1 <- c(x1[i-1], x1[i], x1[i+1])
>     i2 <- c(x2[i-1], x2[i], x2[i+1])
> i1
[1] 33 49 65
> i2
[1] 0.06962541 0.02687296 0.09446254
> lm(i2 ~ i1)

Call:
lm(formula = i2 ~ i1)

Coefficients:
(Intercept)           i1  
  0.0256218    0.0007762  

> func <- lm(i2 ~ i1)
> func$coef[[2]]
[1] 0.0007761604 
```

有任何想法吗？万分感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-22T08:35:24.707

尝试将“return”放在新行上。

```
 } 
    return(deriv.func$coef[[2]])
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-23T07:22:54.970

好吧，在（更多地）研究`for`循环之后，我让它做我想做的事。

```
deriv <- function(x1=1:23, x2=1){
  n=length(x1)
  deriv.func <- character(length = n)
    for (i in 1:n) {
    i1 <- c(x1[i-1], x1[i], x1[i+1])
    i2 <- c(x2[i-1], x2[i], x2[i+1])
        derivate <- lm(i2~i1)
        deriv.func[i] <- derivate$coef[[2]]*
    }
  return(deriv.func)
} 
```

感谢@dbaseman 的帮助和正确方向的提示！
有所作为的想法：

*   确保我为迭代器分配了空间`deriv.func <- character(length = n)`。
*   确保中间变量没有覆盖输出。

# jquery - 多个 JQuery Accordian 菜单 - 使用 cookie 记住唯一状态（持久状态）

> ID：10266313
> 
> 赞同：2
> 
> 时间：2012-04-22T08:13:33.690
> 
> 标签：jquery, cookies, accordion, state

我是 jquery 的新手，在这里需要一些帮助。我正在使用基于 CSS、JavaScript 和 jQuery 的手风琴菜单，[请参阅原始版本](http://www.dynamicdrive.com/dynamicindex17/ddaccordionmenu-urban.htm)...我有一个问题希望这里的一些大师可以回答...我的经验来自 ASP 和 ActionScript，所以我需要一些指导或帮助！

我在设置和调整菜单并将其设置为保存其打开状态时没有问题，但是我正在处理的网站非常大，并且菜单确实从一个网站部分完全更改为另一个。问题是从一个菜单保存的打开状态被传递到网站其他部分的所有其他菜单。示例：如果菜单 1 中保存的打开状态是标题 2，那么用户使用菜单 2 导航到网站的另一个部分，菜单打开菜单 1 的保存状态，即标题 2，这变得非常奇怪。我知道这是通过在会话结束时过期的 cookie 完成的，并且为该 cookie 传递的值类似于 c0、c1、c2 等。c0 是标题 1，c1 是标题 2，依此类推。我也知道我可以在每个菜单请求中传递一个查询字符串来打开某个标题项，例如`www.example.com/company/?headerbar=2`但这并不理想。

问题是我对带有所有菜单的标题栏使用相同的类，并且 jQuery 核心和手风琴 JavaScript 和 CSS 都是服务器端包含的，它们在菜单出现的所有网站部分中加载。

**我的问题是：**有没有办法让 cookie 记住每个菜单打开的标题组是唯一的？可能是通过将其他内容附加到 cookie 中，例如菜单的 url 位置，以便每个独特的菜单都可以记住自己独特的保存状态？我的 javascript 技能正在提高，但我无法弄清楚 sidemenu.js 文件中实现的所有 cookie 函数和代码，以便进行必要的更改。

原始菜单在这里：[http ://www.dynamicdrive.com/dynamicindex17/ddaccordionmenu-urban.htm](http://www.dynamicdrive.com/dynamicindex17/ddaccordionmenu-urban.htm)

我正在使用 jQuery v1.7.2

### 菜单html

```
<div class="ws_sidemenu">
  <h3 class="headerbar"><a href="#">CSS Library</a></h3>
  <ul class="submenu">
    <li><a href="#">Horizontal CSS Menus?</a></li>
    <li><a href="#">Vertical CSS Menus</a></li>
    <li><a href="#">Image CSS</a></li>
    <li><a href="#">Form CSS</a></li>
    <li><a href="#">DIVs and containers</a></li>
    <li><a href="#">Links & Buttons</a></li>
    <li><a href="#">Other</a></li>
    <li><a href="#">Browse All</a></li>
  </ul>
  <h3 class="headerbar"><a href="#">JavaScript Kit</a></h3>
  <ul class="submenu">
    <li><a href="#" >Free JavaScripts</a></li>
    <li><a href="#">JavaScript tutorials</a></li>
    <li><a href="#">JavaScript Reference</a></li>
    <li><a href="#">DHTML & CSS</a></li>
    <li><a href="#">Web Design</a></li>
    <li><a href="#">Free Java Applets</a></li>      
  </ul>
</div> 
```

### 这是我的 CSS，它是菜单出现的每个部分中的服务器端包含

```
.ws_sidemenu{
  width:200px; /*width of menu*/
  padding-right:10px;
}
/* 1\. Side Menu Header Bar */
.ws_sidemenu .headerbar{
  font:bold 13px Verdana;
  color:white;
  background:#606060 url(/media/images/gui/arrows/arw_white_sm_sidemenu.png) no-repeat 4px 13px;; /*last 2 values are the x and y coordinates of bullet image*/
  margin-bottom:0px; /*bottom spacing between header and rest of content*/
  text-transform:uppercase;
  padding:7px 0px 7px 20px; /*last value is left indentation of header text*/
  cursor:pointer;
  margin-top:1px;
}
.ws_sidemenu .headerbar a{
  text-decoration:none;
  color:white;
  display:block;
  outline:none;
}
/* 2\. Side Menu Items */
.ws_sidemenu ul{
  list-style-type:none;
  margin:0;
  padding:0;
  margin-bottom:0; /*bottom spacing between each UL and rest of content*/
}
.ws_sidemenu ul li{
  padding-bottom:2px; /*bottom spacing between menu items*/
}
.ws_sidemenu ul li a{
  font:normal 12px Arial;
  color:black;
  background:#E0DDD8;
  display:block;
  padding:5px 0;
  line-height:17px;
  padding-left:8px; /*link text is indented*/
  padding-right:8px; /*link text is indented*/
  text-decoration:none;
  outline:none;
}
.ws_sidemenu ul li a:visited{
  color:black;
}
.ws_sidemenu ul li a:hover{ /*hover state CSS*/
  color:white;
  background:black;
} 
```

### HTML 头脚本（这是菜单出现的每个部分中的服务器端包含）

```
<!--SIDE MENU - BEGIN -->
<link rel="stylesheet" href="/css/sidemenu.css" type="text/css" media="screen" />
<script type="text/javascript" src="/js/sidemenu.js"></script>
<script type="text/javascript">
  sidemenu.init({
    headerclass: "headerbar", //Shared CSS class name of headers group
    contentclass: "submenu", //Shared CSS class name of contents group
    revealtype: "click", //Reveal content when user clicks or onmouseover the header? Valid value: "click", "clickgo", or "mouseover"
    mouseoverdelay: 200, //if revealtype="mouseover", set delay in milliseconds before header expands onMouseover
    collapseprev: true, //Collapse previous content (so only one open at any time)? true/false
    defaultexpanded: [], //index of content(s) open by default [index1, index2, etc] [] denotes no content - This can also be dobe by passing QS headerbar
    onemustopen: false, //Specify whether at least one header should be open always (so never all headers closed)
    animatedefault: false, //Should contents open by default be animated into view?
    persiststate: true, //persist state of opened contents within browser session?
    toggleclass: ["", "selected"], //Two CSS classes to be applied to the header when it's collapsed and expanded, respectively ["class1", "class2"]
    togglehtml: ["", "", ""], //Additional HTML added to the header when it's collapsed and expanded, respectively  ["position", "html1", "html2"] (see docs)
    animatespeed: "fast", //speed of animation: integer in milliseconds (ie: 200), or keywords "fast", "normal", or "slow"
    oninit:function(headers, expandedindices){ //custom code to run when headers have initialized - Highlighting headers that are expanded by default when the page loads
      for (var i=0; i<expandedindices.length; i++){
        var expandedindex=expandedindices[i] //index of current expanded header index within array
        headers[expandedindex].style.backgroundColor='#333333'
        headers[expandedindex].style.color='#fff'
      }
    },
    onopenclose:function(header, index, state, isuseractivated){
      //custom code to run whenever a header is opened or closed
      //do nothing
    }
  })
</script> 
```

### 菜单 JavaScript 文件（在菜单出现的每个部分中也包括服务器端）

```
/*
SIDE MENU
Version : 1.0
*/

var sidemenu={
    ajaxloadingmsg: '<img src="loading2.gif" /><br />Loading Content...', //customize HTML to output while Ajax content is being fetched (if applicable)

    headergroup: {}, //object to store corresponding header group based on headerclass value
    contentgroup: {}, //object to store corresponding content group based on headerclass value

    preloadimages:function($images){
        $images.each(function(){
            var preloadimage=new Image()
            preloadimage.src=this.src
        })
    },

    expandone:function(headerclass, selected, scrolltoheader){ //PUBLIC function to expand a particular header
        this.toggleone(headerclass, selected, "expand", scrolltoheader)
    },

    collapseone:function(headerclass, selected){ //PUBLIC function to collapse a particular header
        this.toggleone(headerclass, selected, "collapse")
    },

    expandall:function(headerclass){ //PUBLIC function to expand all headers based on their shared CSS classname
        var $headers=this.headergroup[headerclass]
        this.contentgroup[headerclass].filter(':hidden').each(function(){
            $headers.eq(parseInt($(this).attr('contentindex'))).trigger("evt_accordion")
        })
    },

    collapseall:function(headerclass){ //PUBLIC function to collapse all headers based on their shared CSS classname
        var $headers=this.headergroup[headerclass]
        this.contentgroup[headerclass].filter(':visible').each(function(){
            $headers.eq(parseInt($(this).attr('contentindex'))).trigger("evt_accordion")
        })
    },

    toggleone:function(headerclass, selected, optstate, scrolltoheader){ //PUBLIC function to expand/ collapse a particular header
        var $targetHeader=this.headergroup[headerclass].eq(selected)
        var $subcontent=this.contentgroup[headerclass].eq(selected)
        if (typeof optstate=="undefined" || optstate=="expand" && $subcontent.is(":hidden") || optstate=="collapse" && $subcontent.is(":visible"))
            $targetHeader.trigger("evt_accordion", [false, scrolltoheader])
    },

    ajaxloadcontent:function($targetHeader, $targetContent, config, callback){
        var ajaxinfo=$targetHeader.data('ajaxinfo')

        function handlecontent(content){ //nested function
            if (content){ //if ajax content has loaded
                ajaxinfo.cacheddata=content //remember ajax content 
                ajaxinfo.status="cached" //set ajax status to cached
                if ($targetContent.queue("fx").length==0){ //if this content isn't currently expanding or collapsing
                    $targetContent.hide().html(content) //hide loading message, then set sub content's HTML to ajax content
                    ajaxinfo.status="complete" //set ajax status to complete
                    callback() //execute callback function- expand this sub content
                }
            }
            if (ajaxinfo.status!="complete"){
                setTimeout(function(){handlecontent(ajaxinfo.cacheddata)}, 100) //call handlecontent() again until ajax content has loaded (ajaxinfo.cacheddata contains data)
            }
        } //end nested function

        if (ajaxinfo.status=="none"){ //ajax data hasn't been fetched yet
            $targetContent.html(this.ajaxloadingmsg)
            $targetContent.slideDown(config.animatespeed)
            ajaxinfo.status="loading" //set ajax status to "loading"
            $.ajax({
                url: ajaxinfo.url, //path to external menu file
                error:function(ajaxrequest){
                    handlecontent('Error fetching content. Server Response: '+ajaxrequest.responseText)
                },
                success:function(content){
                    content=(content=="")? " " : content //if returned content is empty, set it to "space" is content no longer returns false/empty (hasn't loaded yet)
                    handlecontent(content)
                }
            })
        }
        else if (ajaxinfo.status=="loading")
            handlecontent(ajaxinfo.cacheddata)
    },

    expandit:function($targetHeader, $targetContent, config, useractivated, directclick, skipanimation, scrolltoheader){
        var ajaxinfo=$targetHeader.data('ajaxinfo')
        if (ajaxinfo){ //if this content should be fetched via Ajax
            if (ajaxinfo.status=="none" || ajaxinfo.status=="loading")
                this.ajaxloadcontent($targetHeader, $targetContent, config, function(){sidemenu.expandit($targetHeader, $targetContent, config, useractivated, directclick)})
            else if (ajaxinfo.status=="cached"){
                $targetContent.html(ajaxinfo.cacheddata)
                ajaxinfo.cacheddata=null
                ajaxinfo.status="complete"
            }
        }
        this.transformHeader($targetHeader, config, "expand")
        $targetContent.slideDown(skipanimation? 0 : config.animatespeed, function(){
            config.onopenclose($targetHeader.get(0), parseInt($targetHeader.attr('headerindex')), $targetContent.css('display'), useractivated)
            if (scrolltoheader){
                var sthdelay=(config["collapseprev"])? 20 : 0
                clearTimeout(config.sthtimer)
                config.sthtimer=setTimeout(function(){sidemenu.scrollToHeader($targetHeader)}, sthdelay)
            }
            if (config.postreveal=="gotourl" && directclick){ //if revealtype is "Go to Header URL upon click", and this is a direct click on the header
                var targetLink=($targetHeader.is("a"))? $targetHeader.get(0) : $targetHeader.find('a:eq(0)').get(0)
                if (targetLink) //if this header is a link
                    setTimeout(function(){location=targetLink.href}, 200 + (scrolltoheader? 400+sthdelay : 0) ) //ignore link target, as window.open(targetLink, targetLink.target) doesn't work in FF if popup blocker enabled
            }
        })
    },

    scrollToHeader:function($targetHeader){
        sidemenu.$docbody.stop().animate({scrollTop: $targetHeader.offset().top}, 400)
    },

    collapseit:function($targetHeader, $targetContent, config, isuseractivated){
        this.transformHeader($targetHeader, config, "collapse")
        $targetContent.slideUp(config.animatespeed, function(){config.onopenclose($targetHeader.get(0), parseInt($targetHeader.attr('headerindex')), $targetContent.css('display'), isuseractivated)})
    },

    transformHeader:function($targetHeader, config, state){
        $targetHeader.addClass((state=="expand")? config.cssclass.expand : config.cssclass.collapse) //alternate btw "expand" and "collapse" CSS classes
        .removeClass((state=="expand")? config.cssclass.collapse : config.cssclass.expand)
        if (config.htmlsetting.location=='src'){ //Change header image (assuming header is an image)?
            $targetHeader=($targetHeader.is("img"))? $targetHeader : $targetHeader.find('img').eq(0) //Set target to either header itself, or first image within header
            $targetHeader.attr('src', (state=="expand")? config.htmlsetting.expand : config.htmlsetting.collapse) //change header image
        }
        else if (config.htmlsetting.location=="prefix") //if change "prefix" HTML, locate dynamically added ".accordprefix" span tag and change it
            $targetHeader.find('.accordprefix').html((state=="expand")? config.htmlsetting.expand : config.htmlsetting.collapse)
        else if (config.htmlsetting.location=="suffix")
            $targetHeader.find('.accordsuffix').html((state=="expand")? config.htmlsetting.expand : config.htmlsetting.collapse)
    },

    urlparamselect:function(headerclass){
        var result=window.location.search.match(new RegExp(headerclass+"=((\\d+)(,(\\d+))*)", "i")) //check for "?headerclass=2,3,4" in URL
        if (result!=null)
            result=RegExp.$1.split(',')
        return result //returns null, [index], or [index1,index2,etc], where index are the desired selected header indices
    },

    getCookie:function(Name){ 
        var re=new RegExp(Name+"=[^;]+", "i") //construct RE to search for target name/value pair
        if (document.cookie.match(re)) //if cookie found
            return document.cookie.match(re)[0].split("=")[1] //return its value
        return null
    },

    setCookie:function(name, value){
        document.cookie = name + "=" + value + "; path=/"
    },

    init:function(config){
    document.write('<style type="text/css">\n')
    document.write('.'+config.contentclass+'{display: none}\n') //generate CSS to hide contents
    document.write('a.hiddenajaxlink{display: none}\n') //CSS class to hide ajax link
    document.write('<\/style>')
    jQuery(document).ready(function($){
        sidemenu.urlparamselect(config.headerclass)
        var persistedheaders=sidemenu.getCookie(config.headerclass)
        sidemenu.headergroup[config.headerclass]=$('.'+config.headerclass) //remember header group for this accordion
        sidemenu.contentgroup[config.headerclass]=$('.'+config.contentclass) //remember content group for this accordion
        sidemenu.$docbody=(window.opera)? (document.compatMode=="CSS1Compat"? jQuery('html') : jQuery('body')) : jQuery('html,body')
        var $headers=sidemenu.headergroup[config.headerclass]
        var $subcontents=sidemenu.contentgroup[config.headerclass]
        config.cssclass={collapse: config.toggleclass[0], expand: config.toggleclass[1]} //store expand and contract CSS classes as object properties
        config.revealtype=config.revealtype || "click"
        config.revealtype=config.revealtype.replace(/mouseover/i, "mouseenter")
        if (config.revealtype=="clickgo"){
            config.postreveal="gotourl" //remember added action
            config.revealtype="click" //overwrite revealtype to "click" keyword
        }
        if (typeof config.togglehtml=="undefined")
            config.htmlsetting={location: "none"}
        else
            config.htmlsetting={location: config.togglehtml[0], collapse: config.togglehtml[1], expand: config.togglehtml[2]} //store HTML settings as object properties
        config.oninit=(typeof config.oninit=="undefined")? function(){} : config.oninit //attach custom "oninit" event handler
        config.onopenclose=(typeof config.onopenclose=="undefined")? function(){} : config.onopenclose //attach custom "onopenclose" event handler
        var lastexpanded={} //object to hold reference to last expanded header and content (jquery objects)
        var expandedindices=sidemenu.urlparamselect(config.headerclass) || ((config.persiststate && persistedheaders!=null)? persistedheaders : config.defaultexpanded)
        if (typeof expandedindices=='string') //test for string value (exception is config.defaultexpanded, which is an array)
            expandedindices=expandedindices.replace(/c/ig, '').split(',') //transform string value to an array (ie: "c1,c2,c3" becomes [1,2,3]
        if (expandedindices.length==1 && expandedindices[0]=="-1") //check for expandedindices value of [-1], indicating persistence is on and no content expanded
            expandedindices=[]
        if (config["collapseprev"] && expandedindices.length>1) //only allow one content open?
            expandedindices=[expandedindices.pop()] //return last array element as an array (for sake of jQuery.inArray())
        if (config["onemustopen"] && expandedindices.length==0) //if at least one content should be open at all times and none are, open 1st header
            expandedindices=[0]
        $headers.each(function(index){ //loop through all headers
            var $header=$(this)
            if (/(prefix)|(suffix)/i.test(config.htmlsetting.location) && $header.html()!=""){ //add a SPAN element to header depending on user setting and if header is a container tag
                $('<span class="accordprefix"></span>').prependTo(this)
                $('<span class="accordsuffix"></span>').appendTo(this)
            }
            $header.attr('headerindex', index+'h') //store position of this header relative to its peers
            $subcontents.eq(index).attr('contentindex', index+'c') //store position of this content relative to its peers
            var $subcontent=$subcontents.eq(index)
            var $hiddenajaxlink=$subcontent.find('a.hiddenajaxlink:eq(0)') //see if this content should be loaded via ajax
            if ($hiddenajaxlink.length==1){
                $header.data('ajaxinfo', {url:$hiddenajaxlink.attr('href'), cacheddata:null, status:'none'}) //store info about this ajax content inside header
            }
            var needle=(typeof expandedindices[0]=="number")? index : index+'' //check for data type within expandedindices array- index should match that type
            if (jQuery.inArray(needle, expandedindices)!=-1){ //check for headers that should be expanded automatically (convert index to string first)
                sidemenu.expandit($header, $subcontent, config, false, false, !config.animatedefault) //3rd last param sets 'isuseractivated' parameter, 2nd last sets isdirectclick, last sets skipanimation param
                lastexpanded={$header:$header, $content:$subcontent}
            }  //end check
            else{
                $subcontent.hide()
                config.onopenclose($header.get(0), parseInt($header.attr('headerindex')), $subcontent.css('display'), false) //Last Boolean value sets 'isuseractivated' parameter
                sidemenu.transformHeader($header, config, "collapse")
            }
        })
        //if (config["scrolltoheader"] && lastexpanded.$header)
            //sidemenu.scrollToHeader(lastexpanded.$header)
        $headers.bind("evt_accordion", function(e, isdirectclick, scrolltoheader){ //assign CUSTOM event handler that expands/ contacts a header
                var $subcontent=$subcontents.eq(parseInt($(this).attr('headerindex'))) //get subcontent that should be expanded/collapsed
                if ($subcontent.css('display')=="none"){
                    sidemenu.expandit($(this), $subcontent, config, true, isdirectclick, false, scrolltoheader) //2nd last param sets 'isuseractivated' parameter
                    if (config["collapseprev"] && lastexpanded.$header && $(this).get(0)!=lastexpanded.$header.get(0)){ //collapse previous content?
                        sidemenu.collapseit(lastexpanded.$header, lastexpanded.$content, config, true) //Last Boolean value sets 'isuseractivated' parameter
                    }
                    lastexpanded={$header:$(this), $content:$subcontent}
                }
                else if (!config["onemustopen"] || config["onemustopen"] && lastexpanded.$header && $(this).get(0)!=lastexpanded.$header.get(0)){
                    sidemenu.collapseit($(this), $subcontent, config, true) //Last Boolean value sets 'isuseractivated' parameter
                }
        })
        $headers.bind(config.revealtype, function(){
            if (config.revealtype=="mouseenter"){
                clearTimeout(config.revealdelay)
                var headerindex=parseInt($(this).attr("headerindex"))
                config.revealdelay=setTimeout(function(){sidemenu.expandone(config["headerclass"], headerindex, config.scrolltoheader)}, config.mouseoverdelay || 0)
            }
            else{
                $(this).trigger("evt_accordion", [true, config.scrolltoheader]) //last parameter indicates this is a direct click on the header
                return false //cancel default click behavior
            }
        })
        $headers.bind("mouseleave", function(){
            clearTimeout(config.revealdelay)
        })
        config.oninit($headers.get(), expandedindices)
        $(window).bind('unload', function(){ //clean up and persist on page unload
            $headers.unbind()
            var expandedindices=[]
            $subcontents.filter(':visible').each(function(index){ //get indices of expanded headers
                expandedindices.push($(this).attr('contentindex'))
            })
            if (config.persiststate==true && $headers.length>0){ //persist state?
                expandedindices=(expandedindices.length==0)? '-1c' : expandedindices //No contents expanded, indicate that with dummy '-1c' value?
                sidemenu.setCookie(config.headerclass, expandedindices)
            }
        })
    })
    }
}

//preload any images defined inside ajaxloadingmsg variable
sidemenu.preloadimages(jQuery(sidemenu.ajaxloadingmsg).filter('img')) 
```

提前感谢您的帮助！也欢迎替代解决方案！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-23T22:00:47.547

由于 cookie 本质上是名称-值对，因此您可以在其中存储任何您想要的数据。您通过使用 cookie 中的 URL 使每个 cookie 独一无二的想法听起来很完美（这是我阅读您的问题时的第一个想法）。

# .net - 2 具有相同名称和相同类型参数数量但没有来自.NET 编译器的投诉的泛型类？

> ID：10266315
> 
> 赞同：0
> 
> 时间：2012-04-22T08:13:44.920
> 
> 标签：.net, generics

我需要序列化 ​​KeyValuePair，我在这里找到了解决方案：

[.NET 中是否有可序列化的通用键/值对类？](https://stackoverflow.com/questions/83232/is-there-a-serializable-generic-key-value-pair-class-in-net)

所以我对那个问题使用了公认的答案，它说你只需要像这样定义类/结构

```
public class KeyValuePair<K,V>
{
  public K Key {get;set;}
  public V Value {get;set;}
} 
```

这可行，但现在有 2 个同名的泛型类。上面的自定义类和`System.Collections.Generics`命名空间中的一个。

那么当有这样的代码时，编译器如何知道使用哪一个

```
myList=new List<KeyValuePair<string, string>>(); 
```

一个有签名`KeyValuePair<K,V>`，另一个是`KeyValuePair<TKey,TValue>`，所以两者都有相同数量的类型参数。

为什么代码编译没有错误？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-22T08:22:31.020

当 C# 编译器看到它需要解析的名称时，它会遵循规范中的步骤 - 规则在第 3.8 节（“命名空间或类型名称”）和第 7.6.2 节（“简单名称”）中。

这一切都与上下文有关：

*   您所指名称的类型
*   您在其中引用名称的命名空间
*   代码中的 using 指令

我个人建议*不要*在常用名称空间中重用框架中的名称......这将使在同一代码段中引用这两种类型变得更加困难。但它实际上不会导致编译器出现任何问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-22T08:24:38.307

名称、命名空间和泛型类型参数对于每个程序集都是唯一的。没有什么能阻止您像您那样创建另一种类型，但是如果另一个项目同时使用两个程序集（系统一个和您的），编译器将无法确定使用哪一个。

当使用具有不同版本的两个相同程序集时，会发生相同问题的另一种变体，编译器将选择并绑定到一个，这可能会导致痛苦的调试体验（看起来好像类型应该匹配但它们不匹配 - 框架虽然它本身没有问题）。

请注意，您不能通过“重新定义”来替换另一个程序集中的类型，就像这样。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-22T08:17:50.240

查看文件中的“使用”指令。正如您所说，这些类驻留在不同的名称空间中，因此您的类可能显式使用其中之一，这使编译器摆脱了困境。

# websphere - Websphere Application Server 的应用管理控制台运行缓慢

> ID：10266321
> 
> 赞同：2
> 
> 时间：2012-04-22T08:15:30.040
> 
> 标签：websphere

这是对 Websphere Application Server 管理控制台性能的担忧。我可以顺利登录没有任何问题，但是在执行操作时响应非常慢，例如通过单击“系统管理”下的“节点”显示节点状态，通过单击“服务器”下的“应用程序服务器”显示 AppServer 状态等。然而，有趣的是远程节点上的问题比与 DmgrNode 位于同一框的本地节点更严重。所以我怀疑这应该是DmgrNode和远程节点之间的网络通信问题，但我不知道如何解决它。有人在这里遇到同样的问题吗？？？或者有什么想法可以解决？请帮我一个忙，拜托.......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-23T18:13:33.750

When the console gets the list of servers to display, it does make mbean calls to all of the servers, and if there is a network problem between the dmgr and the node, this could cause some delay in displaying the server page. The nodes page, however, should not have that issue. What is your topology? How many nodes/servers and how many are local/remote?

How can you tell the problem is more serious on the remote nodes than the local nodes?
Are other console operations slower, or only ones that display status? Do you have the same problem with wsadmin commands? The console issues a queryNames to search for the server mbeans. Does the following wsadmin command run much more slowly on the remote node than the local node? If so, how much more slowly?

```
print AdminControl.queryNames('WebSphere:type=Server,node=myNode') 
```

Replace myNode with either the local or remote node name.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-20T09:02:18.300

我假设您正在使用 IE 来启动控制台。从 Chrome 启动控制台，看看它是否有帮助。

# javascript - 每 x 秒执行一次 setTimeout 和 Ajax 时内存泄漏

> ID：10266332
> 
> 赞同：4
> 
> 时间：2012-04-22T08:17:34.130
> 
> 标签：javascript, jquery

我使用 jQuery Ajax 和 setTimeout() 每 x 秒获取一次新数据，这会导致内存泄漏。每次 Ajax 调用时，浏览器内存都会不断增加，直到浏览器崩溃。

```
$(document).ready(wp.state.init);

wp.state = {

    data: {},

    init: function () {
        $.PubSub('state:refresh').subscribe(function () {
            window.setTimeout(function () {
                wp.state.refresh();
            }, 1000);
        });

        this.refresh();
    },

    refresh: function () {

        $.ajax({
            url: 'http://url_here/',
            cache: false,
            dataType: "json",
            success: function (data) {
                wp.state.data = data;
                $.PubSub('state:refresh').publish();
            }
        });
    }
} 
```

**更新**（基于@dez 答案）

```
wp.state = {

    data: {},

    init: function () {
        $.PubSub('state:refresh').subscribe(function () {
            window.setTimeout(wp.state.refresh, 1000);
        });

        this.getState();
    },

    refresh: function () {
        wp.state.getState();
    },

    onSuccess: function (data) {
        wp.state.data = data;
        $.PubSub('state:refresh').publish();
    },

    getState: function () {

        $.ajax({
            url: 'http://url_here/',
            cache: false,
            dataType: "json",
            success: this.onSuccess
        });
    }
} 
```

笔记：

*   Publisher/Subscriber ( **$.PubSub** ) 实现采用[此处](https://gist.github.com/1321768)的形式。在实施 PubSub 之前也发生了 Mem 泄漏，因此它显然不相关。
*   **使用setTimeout**代替**setInterval**以便仅在旧的 Ajax 调用成功后执行新的 Ajax 调用。
*   当然还有其他函数可以监听' **state:refresh** '并使用**wp.state.data中的数据**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-22T23:20:03.553

我可以在这里看到几个问题，其中一些可能会导致您的内存泄漏。

首先，第一行：

```
$(document).ready(wp.state.init); 
```

这不会`init`在正确的范围内执行，因此该行的值`this`将是未定义的：

```
this.refresh(); 
```

你应该这样做：

```
$(document).ready(function(){wp.state.init();}); 
```

或修改你`this.refresh()`的明确`wp.state.refresh()`。

我认为可能导致泄漏的位是......

每次`$.ajax`调用时，`refresh`都会创建一个新函数来处理成功回调。您应该将回调定义为`wp.state`对象上的另一个函数，并以与当前传递给方法`success`的方式相同的方式传递它。`wp.state.init``ready()`

同样，每次您调用`window.setTimeout`订阅到您的 PubSub 的函数时，您也在创建一个函数来处理该回调。您应该在此处执行相同操作并将其提取到`wp.state`.

# html - 用于复制具有样式的页面元素的附加组件

> ID：10266334
> 
> 赞同：5
> 
> 时间：2012-04-22T08:17:54.270
> 
> 标签：html, css, google-chrome-extension, firefox-addon, browser-extension

我正在为任何浏览器寻找一个插件，它可以将任何特定网页元素及其所有样式复制到剪贴板以粘贴并显示给某人。

目的是有机会快速分享我的大项目的一小部分，或协助撰写有关此 HTML 和 CSS 技巧的文章或检查其他人的部分工作。

有任何想法吗？如果不存在这样的插件，我会尝试自己写。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2014-01-19T18:30:39.893

这可能为时已晚。但是，如果有人在那里寻找相同的东西，请使用**SnappySnippet**。它是由康拉德·兹维内尔（ [Konrad Dzwinel ）建造的](https://stackoverflow.com/users/1143495/konrad-dzwinel)

[火狐插件](https://addons.mozilla.org/en-uS/firefox/addon/scratchpad-snippets/)

[Chrome 扩展程序](https://chrome.google.com/webstore/detail/snappysnippet/blfngdefapoapkcdibbdkigpeaffgcil)

[更多细节](https://stackoverflow.com/questions/4911338/tools-to-selectively-copy-htmlcssjs-from-existing-sites#answer-18928130)

这是一个很棒的扩展。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-22T08:59:59.610

还没有看到有人提到过这样的扩展，并且*快速*搜索不会产生一个。您可能必须[自己构建一个](https://addons.mozilla.org/en-US/developers/builder)。

[优秀的 Firebug 插件已经收集了这些信息，制作一个 Firebug 插件](http://getfirebug.com/wiki/index.php/Firebug_Extensions)来增加按钮的便利性可能会更容易。

请注意，这个问题被标记为 Greasemonkey，但 Greasemonkey 并不是这项工作的最佳工具。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-22T08:30:51.717

您是否尝试过**Web Developer**插件（firefox/chrome）？不确定它是否完全符合您的要求，但它会在页面内显示源代码，允许您选择页面/源代码的特定部分。您可以使用此功能，然后复制粘贴您要使用的相关元素。那就是如果我了解您的需求。如果不是，请澄清...

# iphone - xcode - 定时本地通知（每天早上 6 点）

> ID：10266336
> 
> 赞同：4
> 
> 时间：2012-04-22T08:18:13.250
> 
> 标签：iphone, objective-c, xcode, uilocalnotification

我正在使用 Xcode 4.3.2，如何在每天早上 6 点设置此本地通知“dateToFire”？

```
-(void)notification
{
    UILocalNotification *localNotification = [[[UILocalNotification alloc] init] autorelease];

    if (!localNotification) 
        return;

    // Current date
    NSDate *date = [NSDate date]; 
    NSDate *dateToFire = //Everyday: 6AM;

    // Set the fire date/time
    [localNotification setFireDate:dateToFire];
    [localNotification setTimeZone:[NSTimeZone defaultTimeZone]];
    [localNotification setAlertBody:@"Notification" ];      

    [[UIApplication sharedApplication] scheduleLocalNotification:localNotification];
}

- (void)viewDidLoad
{
    [super viewDidLoad];
    [self notification];
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-22T08:22:35.917

使用**CalendarComponents**将小时设置为 6，并将**localNotification.repeatInterval**设置为 NSDayCalendarUnit

```
NSCalendar *calendar = [NSCalendar currentCalendar]; // gets default calendar
NSDateComponents *components = [calendar components:(NSYearCalendarUnit | NSMonthCalendarUnit |  NSDayCalendarUnit | NSHourCalendarUnit | NSMinuteCalendarUnit) fromDate:[NSDate date]]; // gets the year, month, day,hour and minutesfor today's date
[components setHour:18];
[components setMinute:0];

localNotification.fireDate = [calendar dateFromComponents:components]; 
```

# access-modifiers - “客户”一词在这里到底是什么意思？

> ID：10266337
> 
> 赞同：0
> 
> 时间：2012-04-22T08:18:37.960
> 
> 标签：access-modifiers

我正在读一本书，上面写着：“到目前为止，您看到的两个访问修饰符是公共的和私有的。如果基类的方法或属性公开为公共，则派生类和任何**客户端**都可以访问它派生类。如果将基类的属性或方法公开为私有，则派生类或**客户端**无法直接访问它。”

“客户”是什么意思？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-22T08:20:56.257

在这种情况下，客户端是指使用该类的类之外的一段代码*（**既不*是类的一部分，也不是派生类的一部分）。

 *就是这样，真的。就像银行的客户或会计师事务所的客户一样，它使用您正在讨论的事物（无论是银行、会计师事务所还是班级）。

公共和私有（以及其他变体）允许您控制您的类的内部有多少暴露给外部世界。最小化这种暴露被称为封装（信息隐藏），通常被认为是一件好事。*

# python - 带有注释的python构建图

> ID：10266345
> 
> 赞同：1
> 
> 时间：2012-04-22T08:20:31.763
> 
> 标签：python, graph, networkx

我想建立一个有向图并订阅边。

```
import os
import scipy as sc
import pylab
import networkx 
import matplotlib.pyplot as plt
from networkx import *
from numpy import *

G=networkx.DiGraph()
R=[('S0','S1'),('S1','S2'),('S1','S7'),('S2','S3'),('S2','S6'),('S3','S4'),('S3','S6'),('S4','S5'),('S5','S6'),('S6','S7'),('S7','S8'),('S7','S5'),('S8','Sk') ] 

G.add_edges_from([ (2,3,) ])
G.add_edges_from(R) 
networkx.draw_circular(G)

plt.show()
plt.savefig("path.png"); 
```

现在我已经做到了。我建立了一个图表，但我想不出如何订阅边。例如，我想标记`S0`和`S1`边缘喜欢`"565"`等。它会使其更具视觉性和示范性。提前致谢！

![在此处输入图像描述](../Images/a6998deeda0ba5e640f1b9f0c237fba4.png)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-22T12:59:59.177

`networkx.draw_circular(G)`您可以分别布局和绘制节点、边、节点标签和边标签，而不是一步完成布局和绘制 ( )。这是一个小例子：

```
import networkx as nx
import matplotlib.pyplot as plt

G=nx.DiGraph()
R=[('S0','S1'),('S1','S2'),('S1','S7'),('S0','S7')] 

G.add_edges_from(R)

# Calculate layout and get all positions
pos = nx.circular_layout(G)

# Draw everything
nx.draw_networkx_nodes(G, pos)
nx.draw_networkx_edges(G, pos)
nx.draw_networkx_labels(G, pos)
nx.draw_networkx_edge_labels(G, pos, 
    {
        ('S0', 'S1'): 'edge1',
        ('S1', 'S2'): 'edge2',
        ('S1', 'S7'): 'edge3',
        ('S0', 'S7'): 'edge4'
    }
)

plt.axis('off')
plt.savefig("path.png");
plt.show() 
```

有关可以将哪些参数传递给不同绘图函数的更多信息，[请查看文档](http://networkx.lanl.gov/reference/drawing.html)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-22T13:02:21.007

好吧，我想这样做：![在此处输入图像描述](../Images/92f50dc5c50234d42c1f60fa055efc0e.png) 我做到了。即我想标记边缘。这看起来很简单，但事实并非如此。真的。

完整图片在这里[http://s019.radikal.ru/i603/1204/2a/921bc6badfae.png](http://s019.radikal.ru/i603/1204/2a/921bc6badfae.png)

```
 import os
 import scipy as sc
 import pylab
 import networkx 
 import matplotlib.pyplot as plt
 from networkx import *
 from numpy import *

 G=networkx.DiGraph()
 R=[('S0','S1'),('S1','S2'),('S1','S7'),('S2','S3'),('S2','S6'),('S3','S4'),('S3','S6'),('S4','S5'),('S5','S6'),('S6','S7'),('S7','S8'),('S7','S5'),('S8','Sk') ] 
 G.add_edges_from(R) 
 label={R[1]:'a',R[2]:'b',R[3]:'c'}
 networkx.draw_networkx_edge_labels(G,pos=networkx.graphviz_layout(G),edge_labels=label)
 networkx.draw_graphviz(G)
 plt.show()
 plt.savefig("path.png"); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-22T08:37:04.207

您可以通过以下方式选择性地绘制节点和边缘：

```
# nodes
networkx.draw_networkx_nodes(graph, pos, nodelist=[list of the nodes])
# edges
networkx.draw_networkx_edges(graph, pos, edgelist=[list of edges]) 
```

[http://networkx.lanl.gov/reference/drawing.html#module-networkx.drawing.nx_pylab](http://networkx.lanl.gov/reference/drawing.html#module-networkx.drawing.nx_pylab)有更多选项

# c#-4.0 - List 意外的内存使用情况

> ID：10266346
> 
> 赞同：2
> 
> 时间：2012-04-22T08:20:33.520
> 
> 标签：c#-4.0

我一直认为 List 的默认构造函数会初始化一个容量为 4 的列表，并且在添加第 5 个元素时容量会翻倍，等等......

在我的应用程序中，我制作了很多列表（树状结构，其中每个节点可以有很多子节点），其中一些节点没有任何子节点，并且由于我的应用程序速度很快但也使用了一些内存，所以我决定使用我可以指定容量并将其设置为 1 的构造函数。

现在奇怪的是，当我以容量 1 开始时，内存使用量比我使用默认构造函数时高出大约 15%。这不可能是因为 4 更适合，因为加倍是 1,2,4。那么为什么会额外增加内存使用量呢？作为一项额外的测试，我尝试从容量 4 开始。这一次，内存使用量再次比不使用指定容量时高 15%。

现在这真的不是问题，但困扰我多年的一个非常简单的数据结构有一些我还不知道的额外逻辑。有没有人知道 List 在这方面的内部运作？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-22T08:30:07.617

这是因为如果您使用默认构造函数，内部存储数组将设置为一个空数组，但如果您使用具有设定大小的构造函数，则会立即设置正确大小的数组，而不是在第一次调用 Add 时生成。

您可以使用 JustDecompile 之类的反编译器看到这一点：

```
public List(int capacity)
{
    if (capacity < 0)
    {
        ThrowHelper.ThrowArgumentOutOfRangeException(ExceptionArgument.capacity, ExceptionResource.ArgumentOutOfRange_NeedNonNegNum);
    }
    this._items = new T[capacity];
}

public List()
{
    this._items = List<T>._emptyArray;
} 
```

如果您查看 Add 函数，它会调用 EnsureCapacity，如果需要，它将扩大内部存储阵列。显然，如果最初将数组设置为空数组，则第一次添加将创建默认大小的数组。

# nhibernate - NHibernate 复合 id 映射问题，双向/单向 OneToMany、ManyToOne 和 ManyToMany

> ID：10266347
> 
> 赞同：1
> 
> 时间：2012-04-22T08:20:36.557
> 
> 标签：nhibernate, mapping, one-to-many, hibernate-mapping, many-to-one

在我的项目中，所有实体都有复合主键[systemId as long，deviceId as long，id as long]。在我保存实体之前手动填充的值。我使用“代码优先”方法并提供简单参考 NHibernate.Mapping.Attributes 扩展来定义具有属性的模式，就像在基于 Java 的 Hibernate 中一样。

所有实体都有一个提供共享属性和功能的抽象基类型：

```
[Serializable]
public abstract class EntityBase
{

    [CompositeId(0, Name = "id", ClassType = typeof(EntityId))]
    [KeyProperty(1, Name = "systemId", Column = "restId")]
    [KeyProperty(2, Name = "deviceId", Column = "deviceId")]
    [KeyProperty(3, Name = "id", Column = "id")]
    private EntityId id = new EntityId(); // this is a component, see below

    [Property(Column = "isDeleted", NotNull = true)]
    private bool deleted = false;

    public EntityId Id 
    { 
        get { return id; }
        set { id = value; }
    }

    public bool Deleted 
    {
        get { return deleted; }
        set { deleted = value; }
    }

} 
```

在复合 id 后面有一个组件，它代表复杂的主键：

```
[Serializable]
[Component]
public class EntityId
{

    [Property(Column = "restId", NotNull = true)]
    private long systemId = 0;

    [Property(NotNull = true)]
    private long deviceId = 0;

    [Property(NotNull = true)]
    private long id = 0;

    public long SystemId 
    {
        get { return systemId; }
        set { systemId = value; } 
    }

    public long DeviceId 
    {
        get { return deviceId; }
        set { deviceId = value; } 
    }

    public long Id 
    {
        get { return id; }
        set { id = value; } 
    }

} 
```

我定义了两个名为 OTMList 和 OTMItem 的实体，它们彼此之间具有双向 OneToMany 和 ManyToOne 关联。

```
[Serializable]
[Class]
public class OTMList : EntityBase
{

    [List(0, Cascade = "none", Generic = true, Lazy = CollectionLazy.True)]
    [Key(1, Column = "id")]
    [Index(2, Column = "id")]
    [OneToMany(3, NotFound = NotFoundMode.Exception, ClassType = typeof(OTMItem))]
    private IList<OTMItem> otmItems = new List<OTMItem>();

    public IList<OTMItem> OTMItems
    {
        get { return otmItems; }
        set { otmItems = value; }
    }

}

[Serializable]
[Class]
public class OTMItem : EntityBase
{

    [ManyToOne(0, Name = "otmList", ClassType = typeof(OTMList), Column = "OTMListId", Cascade = "none", Lazy = Laziness.Proxy)]
    private OTMList otmList = null;

    public OTMList OTMList
    {
        get { return otmList; }
        set { otmList = value; }
    }

} 
```

hibernate 映射 xml 文件包含以下信息：

```
<?xml version="1.0" encoding="utf-8"?>
<hibernate-mapping default-access="field" auto-import="true" assembly="NHibernateTest, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null" xmlns="urn:nhibernate-mapping-2.2">
  <class name="NHibernateTest.ListTest.OTM.OTMList, NHibernateTest">
    <composite-id class="NHibernateTest.Domain.EntityId, NHibernateTest" name="id">
      <key-property name="systemId" column="restId" />
      <key-property name="deviceId" column="deviceId" />
      <key-property name="id" column="id" />
    </composite-id>
    <property name="deleted" column="isDeleted" not-null="true" />
    <list name="otmItems" lazy="true" cascade="none" generic="true">
      <key column="id" />
      <index column="id" />
      <one-to-many class="NHibernateTest.ListTest.OTM.OTMItem, NHibernateTest" not-found="exception" />
    </list>
  </class>
  <class name="NHibernateTest.ListTest.OTM.OTMItem, NHibernateTest">
    <composite-id class="NHibernateTest.Domain.EntityId, NHibernateTest" name="id">
      <key-property name="systemId" column="restId" />
      <key-property name="deviceId" column="deviceId" />
      <key-property name="id" column="id" />
    </composite-id>
    <property name="deleted" column="isDeleted" not-null="true" />
    <many-to-one name="otmList" class="NHibernateTest.ListTest.OTM.OTMList, NHibernateTest" column="OTMListId" cascade="none" lazy="proxy" />
  </class>
</hibernate-mapping> 
```

当我使用 NHibernate 的 SchemaValidator 验证架构时，出现以下异常：

```
Foreign key (FKF208BF0B9A2FCB3:OTMItem [OTMListId])) must have same number of columns as the referenced primary key (OTMList [restId, deviceId, id]) 
```

当我尝试创建单向多对一或双向/单向多对多关联时，问题也是一样的。

有人可以帮助我吗？

此处提供完整的源代码：

[NHibernateTest 源代码](http://www.4shared.com/zip/U_Eldzr8/NHibernateTest.html?)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-25T06:40:43.887

问题解决了，看看这个：

[http://jzo001.wordpress.com/category/nhibernate/](http://jzo001.wordpress.com/category/nhibernate/)

# c - C中字符串标记器的奇怪行为

> ID：10266349
> 
> 赞同：1
> 
> 时间：2012-04-22T08:21:06.803
> 
> 标签：c, string, pointers, strtok

我编写了以下程序来解析多个目录名称的路径

```
#include <stdio.h>
#include <string.h>
#include <stdlib.h>

char *
tokenizer(char *path, char **name){
  char s[300];
  char *buffer;
  memcpy(s, path, strlen(path)+1);
  printf("%s\n",s);    // PROBLEM
  int i=0;
  while(s[i] == '/'){
    i++;
  }
  if (i == strlen(path)){
    return NULL;
  }
  *name = strtok_r(s, "/", &buffer);
  return buffer;
}

int main(void){
  char str[300];
  char *token, *p;
  scanf("%s",str);
  p = tokenizer(str, &token);
  if (p != NULL)
    printf("%s\n",token);
  else
    printf("Nothing left\n");
  while((p=tokenizer(p, &token)) != NULL){
    printf("%s\n",token);
  }
} 
```

上述程序的输出

```
Input: a/b/c
Output: a/b/c
a/b/c
a
b/c
b
c
c 
```

如果我评论标有问题的行

```
Input: a/b/c
Output: Some garbage value 
```

有人可以解释一下这种奇怪行为的原因吗？

注意：我已经意识到这`s`是一个堆栈分配的变量，它不再存在于函数中`main()`，但是为什么我使用时程序可以工作`printf()`？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-22T08:26:03.930

您将指针返回到堆栈分配的字符串（`buffer`指向`s`）；的记忆在返回`s`后不再有意义。`tokenize`

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-22T08:32:36.553

除了 geekasaur 所说的：

`strtok_r`的第3个参数用错了，有两种方式：
1、第一次调用前应该初始化为NULL。
2\. 不应该以任何方式使用它（你将它返回给调用者）。它应该只传递给另一个`strtok_r`调用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-22T08:30:30.420

你不可以做这个

```
char s[300];
char *buffer;
...
*name = strtok_r(s, "/", &buffer);
return buffer; 
```

这`buffer`是一个指向`s[300]`位置的指针。`s[300]`是函数调用时分配在栈上的函数局部变量，函数返回时销毁。所以你没有返回一个有效的指针，你不能在函数之外使用那个指针。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-22T08:41:05.377

除了观察到您正在返回指向局部变量的指针外，我认为值得注意的是，您`tokenizer`几乎 100% 毫无意义。

您所做的大部分工作`tokenizer`是在调​​用之前跳过任何前导`/`字符`strtok_r`- 但您将 '/' 作为分隔符传递给`strtok_r`，这将自动跳过任何前导分隔符。

更简单的代码足以打印出没有分隔符的路径组件：

```
char path[] = "a/b/c";
char *pos = NULL;

char *component = strtok_r(path, "/", &pos);
while (NULL != component) { 
    printf("%s\n", component);
    component = strtok_r(NULL, "/", &pos);
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-22T17:26:24.770

试试这个：

```
char*
token(char * path, char ** name){

    static char * obuffer = NULL;
    char * buffer = NULL, * p, * q;

    if(path == NULL) {
        buffer = realloc(buffer, strlen(obuffer) + 1);
        p = obuffer;
    } else {
        buffer = malloc(257);
        p = path;
    }

    if(!buffer) return NULL;
    q = buffer; 

    if(!p || !*p) return NULL;

    while(*p != '\0') {
          if(*p == '/') { 
            p++; /* remove the / from string. */
            break;
          }
          *q ++ = *p++;
    }

    *q ++ = '\0';
    obuffer = p;
    *name = buffer;

    return buffer;
}

int main(void)
{

    char * s = "foo/baa/hehehe/";
    char * name = NULL;
    char * t = token(s, &name);
    while(t) {
        printf("%s\n", name);
        t = token(NULL, &name);
    }

    return 0;
} 
```

输出：

```
foo
baa
hehehe 
```

但是您基本上是在“重新发明轮子”的[`strtok()`](http://pubs.opengroup.org/onlinepubs/009604599/functions/strtok.html)功能..

# java - Java扫描仪检测空行？

> ID：10266350
> 
> 赞同：1
> 
> 时间：2012-04-22T08:21:13.703
> 
> 标签：java, file-io, java.util.scanner

我在尝试让扫描仪或缓冲阅读器尝试检测空行时遇到了很多麻烦。例如，如果我有一个文件包含：

```
there
cat
dog
(BLANK LINE) 
```

如果我这样做：

```
while( scan.hasNextLine() )
{
String line = scan.nextLine();
...
...
} 
```

扫描仪不拾取空白行。我也尝试使用缓冲阅读器，但遇到了这个问题。扫描仪是否有某种方法可以在找到这样的空行时返回一个“”？干杯

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-22T08:25:32.810

您输入的行数与`\n`字符数一样多。给定输入

```
"there\ncat\ndog\n" 
```

下一行将被正确划分为

```
"there\n"
"cat\n"
"dog\n" 
```

（换句话说，*没有第四个空行*，因为它不是由 a 终止的`\n`。）

换句话说，在`"dog\n"`读取之后，扫描仪（或缓冲读取器）已经到达 EOF，甚至没有空行可以返回。（请注意，当返回行时，换行符会被删除。）

所以，由于这是预期的行为，我不知道最简单的解决方法是什么。我怀疑解决此问题的最佳方法是将 a 附加`\n`到输入，以便循环运行额外的迭代。

# eclipse - 将 Eclipse Indigo 用于 JSF 2.0 组件

> ID：10266353
> 
> 赞同：0
> 
> 时间：2012-04-22T08:21:44.277
> 
> 标签：eclipse, jakarta-ee, jsf-2, eclipse-indigo

为 Eclipse 安装了 Web Tools Platform 3.3.0 插件，但组件在托盘中不可用。如何解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-22T08:26:54.260

您只需要安装[JBoss Tools 3.3](http://www.jboss.org/tools/download/installation/update_3_3) Web 和 Java EE Web Development

这就是它的样子... [Visual Web Tools](http://docs.redhat.com/docs/en-US/JBoss_Developer_Studio/4.1/html/Beginners_Guide/chap-Beginners_Guide-Java_Web_EE_and_Standard_Edition_SE_Plug_Ins.html#sect-Beginners_Guide-Java_Web_EE_and_Standard_Edition_SE_Plug_Ins-Visual_Web_Tools)

[这是一个带有屏幕截图的 BalusC 答案](https://stackoverflow.com/a/4057346/617373)

# java - java.lang.NullPointerException Hibernate 与 Ehcache 一起使用

> ID：10266359
> 
> 赞同：3
> 
> 时间：2012-04-22T08:22:38.973
> 
> 标签：java, hibernate, exception, servlets, ehcache

我将 Hibernate 4.1.2 与 Ehcache 2.4.3 一起使用（下载 hibernate 时与 hibernate 一起提供）。

我的 hibernate.cfg.xml ：

```
 <?xml version='1.0' encoding='utf-8'?>
  <!DOCTYPE hibernate-configuration PUBLIC
   "-//Hibernate/Hibernate Configuration DTD 3.0//EN"
    "http://www.hibernate.org/dtd/hibernate-configuration-3.0.dtd">

 <hibernate-configuration>
    <session-factory>
          <property name="hibernate.connection.driver_class">  com.microsoft.sqlserver.jdbc.SQLServerDriver </property>
          <property name="hibernate.connection.url"> jdbc:sqlserver://localhost:1433;databaseName=Stock_indices</property>
          <property name="hibernate.connection.username">xxx</property>
          <property name="hibernate.connection.password">xxx</property>
          <property name="hibernate.show_sql">true</property>
          <property name="hibernate.dialect">org.hibernate.dialect.SQLServerDialect</property>
          <property name="hibernate.hbm2ddl.auto">update</property>
          <property name="hibernate.c3p0.min_size">5</property>
          <property name="hibernate.c3p0.max_size">20</property>
          <property name="hibernate.c3p0.timeout">300</property>
          <property name="hibernate.c3p0.max_statements">50</property>
          <property name="hibernate.c3p0.idle_test_period">30</property> 

          <property name="hibernate.cache.use_second_level_cache">true</property>
          <property name="hibernate.cache.use_query_cache">true</property>
          <property  name="hibernate.cache.region.factory_class">org.hibernate.cache.ehcache.SingletonEhCacheRegionFactory              </property>
          <property name="net.sf.ehcache.configurationResourceName">ehcache-entity.xml</property>

          <mapping resource="mapping.xml"/>

      </session-factory>
</hibernate-configuration> 
```

ehcache-entity.xml：

```
<?xml version="1.0" encoding="UTF-8"?>
   <ehcache>

       <cache name="stockdata.StockDatabaseConnection" eternal="false"
        maxElementsInMemory="5" overflowToDisk="true" diskPersistent="false"
        timeToIdleSeconds="0" timeToLiveSeconds="300"
        memoryStoreEvictionPolicy="LRU" />

   </ehcache> 
```

映射.xml

```
 <?xml version="1.0"?>
  <!DOCTYPE hibernate-mapping PUBLIC
       "-//Hibernate/Hibernate Mapping DTD 3.0//EN"
      "http://hibernate.sourceforge.net/hibernate-mapping-3.0.dtd">    

       <hibernate-mapping package="stockdata">

            <class name="StockDatabaseConnection" table="STOCKINDEX"> 

               <cache usage="read-only" />
                  <composite-id name="CompositeIDConnection">
            <key-property name="ticker" column="TICKER"/>
            <key-property name="indexdate" column="INDEXDATE"/>
          </composite-id>

                  <property name="openprice"> <column name="OPENPRICE" /> </property>
                  <property name="closingprice"> <column name="CLOSEPRICE" /> </property>
                  <property name="highestprice"> <column name="HIGHPRICE" /> </property>
                  <property name="lowestprice"> <column name="LOWPRICE" /> </property>
                  <property name="volume"> <column name="VOLUME" /> </property>

            </class>
     </hibernate-mapping> 
```

但是，我得到了这个例外：

```
 java.lang.NullPointerException at   org.hibernate.cache.ehcache.internal.util.HibernateUtil.loadAndCorrectConfiguration(HibernateUtil.java:64)
  at  org.hibernate.cache.ehcache.SingletonEhCacheRegionFactory.start(SingletonEhCacheRegionFactory.java:91)
 at org.hibernate.internal.SessionFactoryImpl.<init>(SessionFactoryImpl.java:281)
 at org.hibernate.cfg.Configuration.buildSessionFactory(Configuration.java:1741)
          ............ 
```

好像hibernate不能加载配置？我该如何解决这个问题？（不使用 Ehcache 的 serlvet 工作正常）。

我的 servlet 类：

```
package stockdataservlet;

import java.io.IOException;
import java.math.BigDecimal;
import java.util.Iterator;
import java.util.List;

import javax.servlet.ServletException;
import javax.servlet.annotation.WebServlet;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

import org.hibernate.Query;
import org.hibernate.Session;
import org.hibernate.SessionFactory;
import org.hibernate.Transaction;
import org.hibernate.cfg.Configuration;
import org.hibernate.service.ServiceRegistry;
import org.hibernate.service.ServiceRegistryBuilder;

import com.google.gson.Gson;
import com.microsoft.sqlserver.jdbc.*;

 public class DataServlet extends HttpServlet {
     private static final long serialVersionUID = 1L;

     public static SessionFactory sessionfactory = null;
     public void init() {
         try {
             Class.forName("com.microsoft.sqlserver.jdbc.SQLServerDriver"); 
             Configuration conf = new Configuration();
             conf.configure();
             ServiceRegistry serviceRegistry = new ServiceRegistryBuilder().applySettings(conf.getProperties()).buildServiceRegistry();   
             sessionfactory = conf.buildSessionFactory(serviceRegistry);

               }
       catch(Exception e){

        e.printStackTrace();
               }
               }

     protected void doGet(HttpServletRequest request, HttpServletResponse response) {
          Session session = null;
       try{
           session = sessionfactory.openSession();
           Transaction transaction = session.beginTransaction();
           Query query = session.createSQLQuery("SELECT * FROM STOCKINDEX WHERE TICKER = :index ").addScalar("CLOSEPRICE");
           query.setParameter("index", "AAA");
           List list = query.list();
           transaction.commit();
           String json = new Gson().toJson(list);
           /*response.setContentType("application/json");
           response.setCharacterEncoding("UTF-8");
           response.getWriter().write(json);*/
         }
       catch(Exception e){
        e.printStackTrace();

       }
         finally{

        session.close();
       }    
} 
```

} ![在此处输入图像描述](../Images/5eb5e5999e5e8565f07f15e0f397cb59.png)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-24T12:43:01.343

最后我找到了我的代码不起作用的原因。感谢 Vinodn 的建议。

```
config.getDefaultCacheConfiguration().isTerracottaClustered() 
```

实际上，我没有在我的 ehcache-entity.xml 中配置**defaultCache**标签，结果

```
config.getDefaultCacheConfiguration() 
```

返回空值。所以添加**defaultCache**解决了这个问题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-24T21:10:29.457

放置`ehcache-entity.xml`在您的类路径中以由您的休眠配置加载。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-25T13:39:22.670

没关系。如果资源名为 ehcache.xml 并放置在类路径中，则不必显式指定属性“net.sf.ehcache.configurationResourceName”的值。当您有多个缓存管理器时，您可以选择此选项。

或者，您可以将所有资源文件从 lib 移动到 WEB-INF/resources 等目录，以便在类路径下更容易引用它。

> Ehcache 在类路径的顶层查找名为 ehcache.xml 的文件。未能在类路径中查找 ehcache-failsafe.xml。ehcache-failsafe.xml 打包在 Ehcache jar 中，应该始终可以找到。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-04-06T12:38:54.113

在 ehcache.xml 中添加 defaultCache 配置也对我有帮助。

# android - Android：Eclipse 不会运行 Android 项目

> ID：10266361
> 
> 赞同：1
> 
> 时间：2012-04-22T08:22:46.880
> 
> 标签：android, eclipse, compiler-errors

我有一个问题，每次我尝试运行一个项目（之前通常运行过）时，eclipse 都会告诉我我有编译错误。代码中没有错误，控制台是空的，并且我没有更改构建路径中的任何内容......最近。我实际上可以导出应用程序并将其安装在手机上，它运行良好，但如果由于某种原因损坏，可以从 Eclipse 播放。我希望我能提供更多信息，但没有什么可显示的：/

编辑：我什至不能运行一个新项目。我只是尝试制作一个 Hello World 应用程序，但它仍然说我有编译错误。我不知道这是否有帮助，所以我想我会添加它。

编辑 2：问题选项卡对此进行了统计：“生成最终存档的描述资源路径位置类型错误：调试证书已于 2012 年 3 月 30 日上午 10:10 过期 TestApp 未知的 Android 打包问题。”

已修复：[debug.keystore 问题修复程序上部](https://stackoverflow.com/questions/2194808/debug-certificate-expired-error-in-eclipse-android-plugins)

帮助？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-22T08:58:58.207

转到窗口 --> 首选项 --> Android --> 构建，查看 Eclipse 指向您的 debug.keystore 的位置，去那里删除它，然后重新启动 Eclipse。

# php - 循环突然停止迭代？

> ID：10266365
> 
> 赞同：0
> 
> 时间：2012-04-22T08:22:56.337
> 
> 标签：php, loops

我有这个 php 代码：

```
<?php
$numarray = trim($_GET['num']);
$i = strlen($numarray);
$result = "";
$numneedarray = array(
90 => 'ninety',
80 => 'eighty',
70 => 'seventy',
60 => 'sixty',
50 => 'fifty',
40 => 'forty',
30 => 'thirty',
20 => 'twenty',
19 => 'nineteen',
18 => 'eighteen',
17 => 'seventeen',
16 => 'sixteen',
15 => 'fifteen',
14 => 'fourteen',
13 => 'thirteen',
12 => 'twelve',
11 => 'eleven',
10 => 'ten',
9 => 'nine',
8 => 'eight',
7 => 'seven',
6 => 'six',
5 => 'five',
4 => 'four',
3 => 'three',
2 => 'two',
1 => 'one'
);
for ($v = 1; $v <= $i; $v++) {
if ($i > 10) {
exit("Has to be 10-digit or less.");
}
if ($i == 3) {
    $result .= ", " . $numneedarray[$numarray[strlen($numarray) - 3]] . " hundred";
    if ($numarray % 100 == 0) {
    echo "Hi95";
    break;
    }
} elseif ($i == 2) {
    if ($numarray[$v] == 1) {
        $othernum = $numarray[strlen($numarray) - 1];
        $othernum2 = $numarray[strlen($numarray) - 2] * 10;
        $othernum3 = $othernum2 + $othernum;
        if (strlen($numarray) > 2) {
        $result .= " and ";
        }
        $result .= $numneedarray[$othernum3];
        echo "Hi107";
    } else {
        $othernum = $numarray[strlen($numarray) - 2] * 10;
        $othernum2 = $numarray[strlen($numarray) - 1];
        $result .= " and " . $numneedarray[$othernum] . " " . $numneedarray[$othernum2];
        echo "Hi112";
    }
}
if ($i == 10) {
    $digit = substr($numarray, 0, 1);
    $result .= $numneedarray[$digit] . " billion";
    if ($numarray % 1000000000 == 0) {
    break;
    }
} elseif ($i == 9) {
    $number = substr($numarray, 1, 3);
    $digit1 = substr($number, 0, 1);
    $digit1con = $numneedarray[$digit1] . " hundred";
    $digit2 = substr($number, 1, 1);
    $noneed = false;
    if ($digit2 != 1) {
    $digit2con = $numneedarray[$digit2 * 10];
    } else {
    $digit23 = substr($number, 1, 2);
    $digit23con = $numneedarray[$digit23];
    $noneed = true;
    }
        $digit3 = substr($number, -1);
        $digit3con = $numneedarray[$digit3];
    if ($noneed == true) {
        $result .= ", " . $digit1con . " and " . $digit23con . " million";
    } else {
        $result .= ", " . $digit1con . " and " . $digit2con . " " . $digit3con . " million";
    }
    if ($numarray % 100000000 == 0) {
    echo "Hi";
    break;
    }
} elseif ($i == 6) {
    $number = substr($numarray, 4, 3);
    $digit1 = substr($number, 0, 1);
    $digit1con = $numneedarray[$digit1] . " hundred";
    $digit2 = substr($number, 1, 1);
    $noneed = false;
    if ($digit2 != 1) {
    $digit2con = $numneedarray[$digit2 * 10];
    } else {
    $digit23 = substr($number, 1, 2);
    $digit23con = $numneedarray[$digit23];
    $noneed = true;
    }
        $digit3 = substr($number, -1);
        $digit3con = $numneedarray[$digit3];
    if ($noneed == true) {
        $result .= ", " . $digit1con . " and " . $digit23con . " thousand";
    } else {
        $result .= ", " . $digit1con . " and " . $digit2con . " " . $digit3con . " thousand";
    }
    if ($numarray % 100000 == 0) {
    echo "Hi89";
    break;
    }
} 
echo $i;
$i = $i - 1;
}
if (strlen($numarray) == 1) {
    echo $numneedarray[$numarray];
}
echo $result;
?> 
```

该`num`值等于`1234567890`。当我刷新页面时， 的值`$i`只会从`10 -> 9 -> 8 -> 7 -> 6`然后突然停止。为什么循环会停止运行？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-22T08:47:03.233

我希望下面的帖子能帮助你实现你正在寻找的东西：

[http://www.karlrixon.co.uk/writing/convert-numbers-to-words-with-php/](http://www.karlrixon.co.uk/writing/convert-numbers-to-words-with-php/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-22T08:32:24.680

您尝试检查每个数字：

```
for ($v = 1; $v <= $i; $v++) { 
```

但随后你`$i`在循环中减少：

```
$i = $i - 1; 
```

这就是为什么您看到的循环比您预期的要少。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-22T08:33:56.143

不是最优的 - 但改变

```
 $i = strlen($numarray); 
```

至

```
 $i = strlen($numarray);
 $count = $i; 
```

和

```
 for ($v = 1; $v <= $i; $v++) 
```

至

```
 for ($v = 1; $v <= $count; $v++) 
```

# hadoop - 如何在不将输出保存到 hdfs 的情况下直接将 mapper-reducer 的输出发送到另一个 mapper-reducer

> ID：10266367
> 
> 赞同：6
> 
> 时间：2012-04-22T08:23:34.917
> 
> 标签：hadoop, mahout

**问题已解决最终**在底部检查我的解决方案

* * *

最近我正在尝试运行 Mahout in Action 的 chaper6（清单 6.1 ~ 6.4）中的推荐示例。但是我遇到了一个问题，我用谷歌搜索了一遍，但找不到解决方案。

这是问题所在：我有一对映射器减速器

```
public final class WikipediaToItemPrefsMapper extends
    Mapper<LongWritable, Text, VarLongWritable, VarLongWritable> {

private static final Pattern NUMBERS = Pattern.compile("(\\d+)");

@Override
protected void map(LongWritable key, Text value, Context context)
        throws IOException, InterruptedException {
    String line = value.toString();
    Matcher m = NUMBERS.matcher(line);
    m.find();
    VarLongWritable userID = new VarLongWritable(Long.parseLong(m.group()));
    VarLongWritable itemID = new VarLongWritable();
    while (m.find()) {
        itemID.set(Long.parseLong(m.group()));
        context.write(userID, itemID);
    }
}
}

public class WikipediaToUserVectorReducer
    extends
    Reducer<VarLongWritable, VarLongWritable, VarLongWritable, VectorWritable> {

public void reduce(VarLongWritable userID,
        Iterable<VarLongWritable> itemPrefs, Context context)
        throws IOException, InterruptedException {
    Vector userVector = new RandomAccessSparseVector(Integer.MAX_VALUE, 100);
    for (VarLongWritable itemPref : itemPrefs) {
        userVector.set((int) itemPref.get(), 1.0f);
    }
    context.write(userID, new VectorWritable(userVector));
}
} 
```

reducer 输出一个 userID 和一个 userVector，它看起来像这样：98955 {590:1.0 22:1.0 9059:1.0 3:1.0 2:1.0 1:1.0}

然后我想用另一对mapper-reducer来处理这个数据

```
public class UserVectorSplitterMapper
    extends
    Mapper<VarLongWritable, VectorWritable, IntWritable, VectorOrPrefWritable> {

public void map(VarLongWritable key, VectorWritable value, Context context)
        throws IOException, InterruptedException {
    long userID = key.get();
    Vector userVector = value.get();
    Iterator<Vector.Element> it = userVector.iterateNonZero();
    IntWritable itemIndexWritable = new IntWritable();
    while (it.hasNext()) {
        Vector.Element e = it.next();
        int itemIndex = e.index();
        float preferenceValue = (float) e.get();
        itemIndexWritable.set(itemIndex);
        context.write(itemIndexWritable, 
                new VectorOrPrefWritable(userID, preferenceValue));
    }
}
} 
```

当我尝试运行该作业时，它会显示错误

> org.apache.hadoop.io.Text 不能转换为 org.apache.mahout.math.VectorWritable

第一个 mapper-reducer 将输出写入 hdfs，第二个 mapper-reducer 尝试读取输出，映射器可以将 98955 转换为 VarLongWritable，但无法转换 {590:1.0 22:1.0 9059:1.0 3: 1.0 2:1.0 1:1.0} 到 VectorWritable，所以我想知道有没有办法让第一个 mapper-reducer 直接将输出发送到第二对，那么就不需要进行数据转换。我查看了 Hadoop 的运行情况，以及 hadoop：权威指南，似乎没有这样的方法可以做到这一点，有什么建议吗？

* * *

## 问题解决了

解决方案：通过使用**SequenceFileOutputFormat**，我们可以将第一个 MapReduce 工作流的 reduce 结果输出并保存到 DFS 上，然后第二个 MapReduce 工作流可以在创建映射器时使用**SequenceFileInputFormat类作为参数读取临时文件作为输入。**由于向量将保存在具有特定格式的二进制序列文件中，**SequenceFileInputFormat**可以读取它并将其转换回向量格式。

下面是一些示例代码：

```
confFactory ToItemPrefsWorkFlow = new confFactory
            (new Path("/dbout"), //input file path
             new Path("/mahout/output.txt"), //output file path
             TextInputFormat.class, //input format
             VarLongWritable.class, //mapper key format
             Item_Score_Writable.class, //mapper value format
             VarLongWritable.class, //reducer key format
             VectorWritable.class, //reducer value format
             **SequenceFileOutputFormat.class** //The reducer output format             

    );
    ToItemPrefsWorkFlow.setMapper( WikipediaToItemPrefsMapper.class);
    ToItemPrefsWorkFlow.setReducer(WikipediaToUserVectorReducer.class);
    JobConf conf1 = ToItemPrefsWorkFlow.getConf();

    confFactory UserVectorToCooccurrenceWorkFlow = new confFactory
            (new Path("/mahout/output.txt"),
             new Path("/mahout/UserVectorToCooccurrence"),
             SequenceFileInputFormat.class, //notice that the input format of mapper of the second work flow is now SequenceFileInputFormat.class
             //UserVectorToCooccurrenceMapper.class,
             IntWritable.class,
             IntWritable.class,
             IntWritable.class,
             VectorWritable.class,
             SequenceFileOutputFormat.class                                      
             );
     UserVectorToCooccurrenceWorkFlow.setMapper(UserVectorToCooccurrenceMapper.class);
     UserVectorToCooccurrenceWorkFlow.setReducer(UserVectorToCooccurrenceReducer.class);
    JobConf conf2 = UserVectorToCooccurrenceWorkFlow.getConf();

    JobClient.runJob(conf1);
    JobClient.runJob(conf2); 
```

**如果您对此有任何问题，请随时与我联系**

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-22T13:12:57.150

您需要显式配置第一个作业的输出以使用 SequenceFileOutputFormat 并定义输出键和值类：

```
job.setOutputFormat(SequenceFileOutputFormat.class);
job.setOutputKeyClass(VarLongWritable.class);
job.setOutputKeyClass(VectorWritable.class); 
```

在没有看到您的驱动程序代码的情况下，我猜您正在使用 TextOutputFormat 作为第一个作业的输出，并将 TextInputFormat 作为第二个作业的输入-并且此输入格式将成对发送`<Text, Text>`到第二个映射器

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-23T23:43:19.527

我是hadoop的初学者，这只是我对答案的猜测，所以请耐心等待/指出它是否看起来很幼稚。

我认为在不保存 HDFS 的情况下从减速器发送到下一个映射器是不合理的。因为“哪个数据拆分到哪个映射器”被优雅地设计为满足局部性标准。（转到本地存储数据的映射器节点）。

如果您不将其存储在 HDFS 上，则很可能所有数据都将通过网络传输，速度很慢并且可能会导致带宽问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-22T10:35:20.613

您必须暂时保存第一个 map-reduce 的输出，以便第二个可以使用它。

这可能会帮助您了解第一个 map-reduce 的输出如何传递给第二个。（这是基于[Apache nutch的](http://nutch.apache.org/)[Generator.java](http://www.docjar.com/html/api/org/apache/nutch/crawl/Generator.java.html)）。

这是第一个 map-reduce 输出的临时目录：

```
Path tempDir =
  new Path(getConf().get("mapred.temp.dir", ".")
           + "/job1-temp-"
           + Integer.toString(new Random().nextInt(Integer.MAX_VALUE))); 
```

设置第一个 map-reduce 作业：

```
JobConf job1 = getConf();
job1.setJobName("job 1");
FileInputFormat.addInputPath(...);
sortJob.setMapperClass(...);

FileOutputFormat.setOutputPath(job1, tempDir);
job1.setOutputFormat(SequenceFileOutputFormat.class);
job1.setOutputKeyClass(Text.class);
job1.setOutputValueClass(...);
JobClient.runJob(job1); 
```

观察在作业配置中设置了输出目录。在第二个工作中使用它：

```
JobConf job2 = getConf();
FileInputFormat.addInputPath(job2, tempDir);
job2.setReducerClass(...);
JobClient.runJob(job2); 
```

完成后记得清理临时目录：

```
// clean up
FileSystem fs = FileSystem.get(getConf());
fs.delete(tempDir, true); 
```

希望这可以帮助。

# c# - 流利的NHibernate；查询连接表属性

> ID：10266368
> 
> 赞同：0
> 
> 时间：2012-04-22T08:24:04.870
> 
> 标签：c#, nhibernate, fluent-nhibernate

我有以下数据库表

```
 Messages
  - ID
  - Name
  - Date
  - CategoryID

 Categories
   - ID
   - Name 
```

我制作了一个 Fluent Nhibernate 映射，它引用了 Messages 映射中的类别；

```
 public MessageMap()
    {
        Table("messages");
        Id(x => x.Id, "ID");
        Map(x => x.Name, "name");
        Map(x => x.Date, "date");
        References(x => x.Category).Column("categoryid");

    } 
```

现在我想选择具有特定类别名称的所有消息。我知道我可以按名称查找类别，然后使用 ID 选择所有消息。仍然可以将这 2 个单独的查找合并为一个，事实是在 Fluent NHibernate 中，我不知道如何。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-22T09:58:57.273

*这与Fluent* NHibernate无关。使用 LINQ，您可以这样做：

```
session.Query<Message>().Where(x => x.Category.Name == "<your name>"); 
```

# android - 如何在安卓应用上管理大数据？

> ID：10266370
> 
> 赞同：0
> 
> 时间：2012-04-22T08:24:17.993
> 
> 标签：android, database

我有一个在我的网站上使用的大型数据库，我想将它用于没有 Internet 连接的 android 应用程序。

我的数据库可以导出到 .db 文件。我应该如何将此文件用于我的 android 应用程序。

问候

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-22T08:47:07.917

将数据库副本保存在资产文件夹中，在第一次加载应用程序时将该数据库复制到**/data/data/your.package.name/databases中。**

如果您的数据库大于 1MB 将数据库分成小部分。

例如：如果大小 = 8 MB，则将 1MB 的 8 个部分组合在一起，而不是在复制时有问题地加入这些部分。

# c# - foreach 的新手性能问题...需要建议

> ID：10266372
> 
> 赞同：3
> 
> 时间：2012-04-22T08:24:34.523
> 
> 标签：c#, asp.net-mvc

本节仅从 Excel 电子表格中读取。这部分工作正常，没有性能问题。

```
IEnumerable<ImportViewModel> so=data.Select(row=>new ImportViewModel{
                  PersonId=(row.Field<string>("person_id")),
                  ValidationResult = ""
                  }).ToList(); 
```

在我传递给视图之前，我想设置 ValidationResult，所以我有这段代码。如果我将此注释掉，模型将快速传递给视图。当我使用 foreach 时，它需要一分钟多的时间。如果我硬编码 item.PersonId 的值，那么它运行得很快。我知道我做错了什么，只是不确定从哪里开始以及我应该遵循的最佳实践是什么。

```
foreach (var item in so)
                {
                    if (db.Entity.Any(w => w.ID == item.PersonId))
                    {
                        item.ValidationResult = "Successful";
                    }
                    else
                    {
                        item.ValidationResult = "Error:  ";
                    }
                 } 

return View(so.ToList()); 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-22T08:29:58.377

您现在正在对列表中的每个项目执行数据库调用。这对你的数据库和你的性能来说真的很困难。尝试遍历您的 Excel 结果，收集所有用户并在一个查询中选择他们。从此查询结果制作一个列表（否则每次访问该列表时都会执行查询调用）。然后在结果列表和您的 Excel 之间进行匹配。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-22T11:32:03.493

你需要做这样的事情：

```
var ids = so.Select(i=>i.PersonId).Distinct().ToList();
// Hitting Database just for this time to get all Users Ids
var usersIds = db.Entity.Where(u=>ids.Contains(u.ID)).Select(u=>u.ID).ToList();
foreach (var item in so)
                {
                    if (usersIds.Contains(item.PersonId))
                    {
                        item.ValidationResult = "Successful";
                    }
                    else
                    {
                        item.ValidationResult = "Error:  ";
                    }
                 } 

return View(so.ToList()); 
```

# c# - 下载/上传文件，过滤哪些字符c#

> ID：10266374
> 
> 赞同：1
> 
> 时间：2012-04-22T08:24:43.713
> 
> 标签：c#, asp.net-mvc-3, file, filtering

在我的应用程序中，当用户上传或下载文件时，我会构建一个静态字符串。在该字符串中，文件名是从该字符串中的前端传递的。通过这种方式，用户可以执行诸如 ..\..\another file.file 之类的操作来篡改并从其他用户那里获取数据。因此，我需要过滤我得到的文件名以防止这种情况。哪些字符需要过滤以防篡改？我现在有双点和反斜杠和正斜杠。还有什么我应该考虑的吗？在 C# 中是否有标准的方法可以做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-22T08:44:12.430

如果不同的用户使用相同的名称保存文件怎么办？您是否为每个用户创建一个文件夹？

您很可能应该做的是将它们提供的名称存储在数据库记录中，该记录还包含指向实际文件的指针（该文件使用您生成的文件名，可能是 guid）。如果您还想将文档保存在数据库中，也可以考虑使用文件流数据类型。

让您的用户确定您服务器上的文件名并没有什么好处：)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-22T08:35:23.317

我建议使用[`Path.GetInvalidFileNameChars`](http://msdn.microsoft.com/en-us/library/system.io.path.getinvalidfilenamechars.aspx)：

```
public static bool IsValidFileName(string fileName)
{
    return fileName.IndexOfAny(Path.GetInvalidFileNameChars()) == -1;
} 
```

`..`通常只有在 a`\`或之前和/或之后才是危险的`/`，这两者都包含在 . 返回的数组中`GetInvalidFileNameChars`。它本身`..`是无害的（除非您专门解析目录路径），并且您不应该禁止它，因为人们可能希望在他们的文件名中引入省略号（例如`The A...Z of Programming.pdf`）。

# iphone - 创建一个 UIViewController 的 iPad 版本 xib

> ID：10266378
> 
> 赞同：1
> 
> 时间：2012-04-22T08:25:29.503
> 
> 标签：iphone, ios, ipad

在 xcode4.2 中，我有一个与同名 xib 文件捆绑在一起的 UiViewController。在 UiViewController 中，我有一些如下所示的 IBOutlets 连接到 xib。

```
 @property (retain, nonatomic) IBOutlet UIButton *topButton;
    @property (retain, nonatomic) IBOutlet UIButton *hotButton;
    @property (retain, nonatomic) IBOutlet UIButton *newButton;
    @property (retain, nonatomic) IBOutlet UIButton *starredButton; 
```

现在，我想创建一个 iPad 版本的 UIViewController 的 xib 文件，我该怎么办？即如何将一个IBOutlet 连接到两个版本的xib。任何帮助将不胜感激！感谢先进！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-22T10:23:13.957

您只需要两个具有适当命名的笔尖

```
MyView~iphone.xib
MyView~ipad.xib 
```

然后只需确保它们都具有相同的文件所有者并连接您想要的连接。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-22T08:35:43.007

转到新文件->从左侧选择用户界面->选择空->在设备系列下拉列表中选择ipad。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-22T08:45:40.737

在 xcode 4 中，我们不能为单个 xib 执行此操作，但我们可以一次创建各自的 ipad 版本。右键单击目标并单击复制。然后选择“复制并过渡到 ipad”。新目标和新集的 xibs 被创建。这可能会帮助你。

# android - 无法在我的课堂上使用 Viewgroup

> ID：10266381
> 
> 赞同：1
> 
> 时间：2012-04-22T08:25:40.857
> 
> 标签：android, layout, view

如果我尝试使用 ViewGroup 我会收到此错误`"ViewHolder cannot be resolved to a type"`。目前没有具体的导入，如何使用？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-22T08:44:00.710

也许您应该定义一个名为 ViewHolder 的静态类。请参阅此示例。[http://developer.android.com/resources/samples/ApiDemos/src/com/example/android/apis/view/List14.html](http://developer.android.com/resources/samples/ApiDemos/src/com/example/android/apis/view/List14.html)

# wordpress - wordpress 查询（简码）总是返回第一个帖子

> ID：10266384
> 
> 赞同：0
> 
> 时间：2012-04-22T08:26:22.793
> 
> 标签：wordpress, shortcode

我在我的插件中制作了一个简码，效果很好。短代码需要接受一些参数并创建一个带有输出的自定义循环。

参数之一是为 ($markers) 输出循环的帖子数

```
$args=array(
                'meta_key'=>'_mykey',
                'post_status'=>'publish',
                'post_type'=>'post',
                'orderby'=>'date',
                'order'=>'DESC',
                'posts_per_page'=>$markers,

);

  $wp_query = new WP_Query();
           $wp_query->query($args);

if ($wp_query->have_posts()) : while (($wp_query->have_posts()) ) : $wp_query->the_post();

// do the loop using get_the_id() and $post->id

endwhile;endif;
wp_reset_query();//END query 
```

在某些情况下，我需要来自所有帖子的数据`($markers = '-1' )`，有时只有一个`($markers = '1' )`或多个`($markers = 'x')`。

所有这些在单页/帖子上都很好用 - 但我的问题是，当这个函数位于我有多个帖子（！is_single）和（`$ markers = '1'`）的地方时，它总是会返回最新帖子的数据，而不是对于正确的..（例如在默认的 wordpress 主题中，它将显示 10 个帖子 - 它们都是相同的数据）

这显然是一个问题`$post->ID`- 但是在 wp 循环之外进行自定义循环时，我怎样才能拥有正确的帖子 ID？

我试图通过

```
global $post;
 $thePostIDtmp = $post->ID; //get the ID before starting new query as temp id
 $wp_query = new WP_Query();
 $wp_query->query($args);
// Start Custom Loop

if (!is_single()){
$post_id_t = $thePostIDtmp;}
else {
$post_id_t = $post->ID;} 
```

然后使用 `$post_id_t`- 但它似乎不起作用，我不应该使用 get_the_id() 吗？还是我不应该使用查询（并使用 get_posts）？

任何想法/解决方案/想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-22T08:39:40.637

我会使用 query_posts(http://codex.wordpress.org/Function_Reference/query_posts) 而不是覆盖 $wp 对象。您应该能够在页面上包含任意数量的循环。如果您对此有疑问，可以在调用它之前使用： [http ://codex.wordpress.org/Function_Reference/wp_reset_query。](http://codex.wordpress.org/Function_Reference/wp_reset_query)

我发现这个：[http](http://blog.cloudfour.com/wordpress-taking-the-hack-out-of-multiple-custom-loops/) ://blog.cloudfour.com/wordpress-taking-the-hack-out-of-multiple-custom-loops/ 也减轻了一些痛苦。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-22T15:49:46.450

WordPress 中基本上有两种查询帖子：改变主循环的和不改变主循环的。如果您想更改主循环，例如用于显示类别存档页面的主循环，请使用[query_posts](http://codex.wordpress.org/Function_Reference/query_posts)。它让你做到这一点。删除、更改和附加默认查询的参数以更改典型页面的结果。query_posts 有一些[缺点](http://codex.wordpress.org/Function_Reference/query_posts#Caveats)。

然后有一些查询只是用来从数据库中取出东西来玩，例如在侧边栏中显示最新的帖子标题或当前帖子的附件。

为此，请创建一个新的 WP_Query 对象，该对象将独立于主循环构建您的自定义循环，如下所示：

```
// The Query
$the_query = new WP_Query( $args );

// The Loop
while ( $the_query->have_posts() ) : $the_query->the_post();
    echo '<li>';
    the_title();
    echo '</li>';
endwhile;

// Reset Post Data
wp_reset_postdata(); 
```

然后是[get_posts()](http://codex.wordpress.org/Template_Tags/get_posts)，它就像WP_Query 的小弟。在我看来，它有一个更简单的界面，并返回一个包含更易于使用的结果的数组。它看起来像这样：

```
$myposts = get_posts( $args );
foreach($myposts as $post) : setup_postdata($post);
     echo "<li>";
     the_title();
     echo "</li>";
endforeach; 
```

像 get_the_id() 这样的 foreach 模板标签将起作用。

# sql-server - Select * from Table where (动态条件)

> ID：10266386
> 
> 赞同：0
> 
> 时间：2012-04-22T08:26:41.420
> 
> 标签：sql-server, select

我的存储过程收到“@CategoryIDs varchar”

@CategoryIDs 包含一个或多个用“|”分隔的 ID，

我的存储过程如下所示：

```
Select R.ID,,CategoryID, (sum(C.Rating)/Count(R.ID)) as "Rating"
    from Table1  R
    left outer join Table2 C
    ON R.ID = C.ID
    GROUP BY R.ID
    having R.CategoryID = @CatergoryID
    RETURN 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-22T08:42:01.570

您应该可以使用`CHARINDEX`. 但是，这样效率很低，最好有`@CategoryID`一个表变量。

```
SET @CatergoryID = '|'+@CatergoryID+'|';
SELECT R.ID, R.CategoryID, (SUM(C.Rating)/COUNT(R.ID)) AS Rating
    FROM Table1 AS R
    LEFT OUTER JOIN Table2 AS C
    ON R.ID = C.ID
    WHERE CHARINDEX('|'+R.CategoryID+'|', @CatergoryID)>0 
    GROUP BY R.ID, R.CategoryID 
```

# java - JPA坚持多对多

> ID：10266390
> 
> 赞同：8
> 
> 时间：2012-04-22T08:27:04.023
> 
> 标签：java, mysql, jpa

我有一个非常标准的场景，其中我有一个以 user_id 作为 PK 的用户表和一个以 role_id 作为 PK 的角色表。这两个表通过多对多关系相关（即，用户可以有多个角色，一个角色可以应用于多个用户），随后我有一个名为 users_has_roles 的连接表。users_has_roles 中仅有的两列是 users_user_id 和 roles_role_id。

我已经生成了实体类（见下文），并且将数据持久保存到用户和角色表中没有问题，但是我失败了，将任何内容持久保存到 users_has_roles 加入表中，因此目前我的用户都没有被分配角色。在我发疯之前，有人可以让我摆脱痛苦并告诉我应该如何将带有相应角色角色标识的 users_user_id 添加到 users_has_roles 表中，以便我的用户可以拥有角色吗？

我的 Users.java 实体类：

```
@Entity
@Table(name = "users")
@XmlRootElement
@NamedQueries({
@NamedQuery(name = "Users.findAll", query = "SELECT u FROM Users u"),
@NamedQuery(name = "Users.findByUserId", query = "SELECT u FROM Users u WHERE u.userId = :userId"),
@NamedQuery(name = "Users.findByUsername", query = "SELECT u FROM Users u WHERE u.username = :username"),
@NamedQuery(name = "Users.findByPassword", query = "SELECT u FROM Users u WHERE u.password = :password")})
public class Users implements Serializable {
private static final long serialVersionUID = 1L;
@Id
@Basic(optional = false)
@NotNull
@Size(min = 1, max = 60)
@Column(name = "user_id")
private String userId;
@Basic(optional = false)
@NotNull
@Pattern(regexp="[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?", message="Invalid email")
@Size(min = 1, max = 45)
@Column(name = "username")
private String username;
@Basic(optional = false)
@NotNull
@Size(min = 1, max = 120)
@Column(name = "password")
private String password;
@JoinTable(name = "users_has_roles", joinColumns = {
    @JoinColumn(name = "users_user_id", referencedColumnName = "user_id")}, inverseJoinColumns = {
    @JoinColumn(name = "roles_role_id", referencedColumnName = "role_id")})
@ManyToMany
private Collection<Roles> rolesCollection;
@OneToMany(cascade = CascadeType.ALL, mappedBy = "usersUserId")
private Collection<UserAccount> userAccountCollection;
@OneToMany(cascade = CascadeType.ALL, mappedBy = "usersUserId")
private Collection<UserDetails> userDetailsCollection;

...

All the getter and setter methods etc. 
```

我的 Roles.java 实体类：

```
@Entity
@Table(name = "roles")
@XmlRootElement
@NamedQueries({
@NamedQuery(name = "Roles.findAll", query = "SELECT r FROM Roles r"),
@NamedQuery(name = "Roles.findByRoleId", query = "SELECT r FROM Roles r WHERE r.roleId = :roleId"),
@NamedQuery(name = "Roles.findByRoleName", query = "SELECT r FROM Roles r WHERE r.roleName = :roleName"),
@NamedQuery(name = "Roles.findByRolePermission", query = "SELECT r FROM Roles r WHERE r.rolePermission = :rolePermission"),
@NamedQuery(name = "Roles.findByRoleDescription", query = "SELECT r FROM Roles r WHERE r.roleDescription = :roleDescription")})
public class Roles implements Serializable {
private static final long serialVersionUID = 1L;
@Id
@Basic(optional = false)
@NotNull
@Size(min = 1, max = 60)
@Column(name = "role_id")
private String roleId;
@Basic(optional = false)
@NotNull
@Size(min = 1, max = 45)
@Column(name = "role_name")
private String roleName;
@Basic(optional = false)
@NotNull
@Size(min = 1, max = 45)
@Column(name = "role_permission")
private String rolePermission;
@Size(max = 45)
@Column(name = "role_description")
private String roleDescription;
@ManyToMany(mappedBy = "rolesCollection")
private Collection<Users> usersCollection;

...

All the getter and setter methods etc. 
```

谢谢

- - 更新 - -

```
// New Users
Users currentUser = new Users();
currentUser.setUserId(userId);
currentUser.setUsername(email);
currentUser.setPassword(password);
getUsersFacade().create(currentUser); 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-04-22T16:55:17.550

好的，首先感谢 Mikko 引导我找到答案。我只是想发布一个可能对可能处于我所处位置的任何其他人直接有帮助的答案。这也是基于 Eureka 时刻，所以它在技术上可能不正确，但这就是我的看法。

我面临的一个大问题是，在 MySQL 中，我可以将桥接表视为一个单独的表！（抱歉，我无法发布我的 EER 图的图像，但我目前似乎没有足够的权限）所以我假设 Java 也会将桥接表视为一个表！好吧，它没有。该桥接表在 Java 中并不像传统表那样真正存在，它实际上由与之关联的相对表集合类型表示。

对我来说，最简单的查看方法是完全忘记桥接表并专注于两个“真实”表并将其中的数据关联起来。以下代码不是最佳实践，因为我只是设置了 role_id，但这只是为了表明我的观点。

```
List<Roles> userRoleList = new ArrayList<Roles>();

Users currentUser = new Users();
currentUser.setUserId(userId);
currentUser.setUsername(email);
currentUser.setPassword(password);

Roles userRole = new Roles();
userRole.setRoleId("2");

userRoleList.add(userRole);
currentUser.setRolesCollection(userRoleList);

getUsersFacade().create(currentUser); 
```

希望这可以帮助其他在多对多关系中苦苦挣扎的人。

（注意。为了方便起见，我编辑了原始问题代码以使用 List 而不是 Collection，但您也可以使用任何其他适合您需要的类型。）

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-04-22T09:10:04.433

您的示例工作正常（EclipseLink 2.3，MySQL）。可能的问题在于您未显示的部分代码。例如在将元素添加到角色集合中。典型的错误是例如仅将元素添加到非拥有方。

为了持久化它，你必须关心拥有方的关系（没有mappedBy），为了保持内存中的对象图与数据库一致，你应该始终修改关系的双方。

我尝试了以下方法：

```
 // method to add element to rolesCollection
    public void addRoles(Roles r) {
        rolesCollection.add(r);
    }

    //first created new instances of Users and Roles
    // then:
    tx.begin();
    users.addRoles(r);
    //it is not needed for persisting, but here you can also
    //add user to roles.
    em.persist(users);
    em.persist(r);
    tx.commit(); 
```

# iphone - 如何在地图注释图钉上自动显示气泡而不使用拖放动画

> ID：10266392
> 
> 赞同：1
> 
> 时间：2012-04-22T08:27:17.270
> 
> 标签：iphone, objective-c, ios, mapkit

我有一个标准的注释针，放置在我的坐标上，自动显示带有标题/副标题的气泡。在移动中跟踪我的坐标时，针脚每次都会掉落动画。我尝试过，`annView.animatesDrop=FALSE`但在这种情况下，气泡不会自动出现（对于我使用的自动外观`selectAnnotation:addAnnotation animated:YES`）。需要做什么才能让图钉自动显示标题/副标题而不显示动画？

PS对不起我的英语不好。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-22T09:06:20.903

annView.animatesDrop=否；

它适用于我的代码。显示没有放置动画的图钉。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-22T10:06:49.787

您必须在正确的位置使用 annView.animatesDrop=FALSE。那将是在

```
- (MKAnnotationView *)mapView:(MKMapView *)mapView viewForAnnotation:(id < MKAnnotation >)annotation 
```

委托方法，在你创建了 annotationView 之后。

如果我没记错的话，您不能在添加它的同一运行循环中选择 annotationView。我用一个

```
- (void)performSelector:(SEL)aSelector withObject:(id)anArgument afterDelay:(NSTimeInterval)delay 
```

为此，将延迟设置为 0 以使其在新的运行循环中发生。

就我而言，我有

```
[self performSelector:@selector(selectPlace:) withObject:annotation afterDelay:0];

- (void)selectPlace:(id)<MKAnnotation>place{
//Lots of stuff for my precise case
    CLLocationCoordinate2D center;
    center.latitude = place.latitudeValue;
    center.longitude = place.longitudeValue;
    MKCoordinateSpan span;
    span.latitudeDelta = 4;
    span.longitudeDelta = 5;
    MKCoordinateRegion germany;
    germany.center = center;
    germany.span = span;
    [mapView setRegion:germany animated:YES];
// End of custom stuff

    [mapView selectAnnotation:(id)place animated:YES];  //This is what you're interested in
} 
```

# sql-server-2008 - 序列化表中的行

> ID：10266399
> 
> 赞同：1
> 
> 时间：2012-04-22T08:29:02.313
> 
> 标签：sql-server-2008, tsql, asp-classic

我有一个表，其中包含交易的标题信息。交易属于不同的项目。

在标题中我有列：

```
rhguid - uniqueidentifier
rhserial - int
rh_projectID - int 
```

首先我插入行（还有更多列）

然后我计算该项目的序列号：

```
update responseheader 
set rhSerial = 1 + (select isnull(max(rhSerial), 0) 
                    from responseheader 
                    where (rhstatus = 0) AND (rh_projectID = 1234)) 
where 
   (rhGUID = <preassignedGUID>); 
```

但是，当一个项目同时发生许多事务时，我会发现重复`rhserial`值。

我在带有 SQL Server 2008 的经典 ASP 中执行此操作。

有没有更好的办法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-22T14:01:30.497

从您的示例来看，您似乎没有使用交易。我的猜测是语句的 SELECT 部分作为**READ UNCOMMITTED**运行，否则您将看不到重复项。有多种方法可以使用 ADO 启动事务，但我更喜欢使用存储过程。

尝试实现这样的事情：

```
CREATE PROC dbo.ResponseHeader_Insert
  <more data to insert>,
  @ProjectID INT,
  @Status SMALLINT
as

insert responseheader (column names here)
select <param values here>, isnull(max(rhSerial), 0) + 1
from responseheader  
where (rhstatus = @Status) AND (rh_projectID = @ProjectID)) 
```

如果这对你不起作用，请尝试创建序列表（每个序列一个）。

```
create table <tablename> (
      SeqID int identity(1,1) primary key,
      SeqVal varchar(1)
) 
```

创建一个获取下一个身份的过程：

```
create procedure GetNewSeqVal_<tablename>
as
begin
      declare @NewSeqValue int

      set NOCOUNT ON

      insert into <tablename> (SeqVal) values ('a')
      set @NewSeqValue = scope_identity()
      delete from <tablename> WITH (READPAST)
return @NewSeqValue
end 
```

如果需要创建的序列表太多，或者您想即时创建序列，请尝试以下方法：

```
Create table AllSequences (
      SeqName nvarchar(255) primary key, -- name of the sequence
      Seed int not null default(1), -- seed value
      Incr int not null default(1), -- incremental
      Currval int 
)
Go

create procedure usp_CreateNewSeq
      @SeqName nvarchar(255),
      @seed int = 0,
      @incr int = 1
as

begin

      declare @currval int
      if exists (
            select 1 from AllSequences
            where SeqName = @SeqName )

      begin
            print 'Sequence already exists.'
            return 1    
      end

      if @seed is null set @seed = 1
      if @incr is null set @incr = 1
      set @currval = @seed

      insert into AllSequences (SeqName, Seed, Incr, CurrVal)
      values (@SeqName, @Seed, @Incr, @CurrVal)
end
go

create procedure usp_GetNewSeqVal

      @SeqName nvarchar(255)
as

begin
      declare @NewSeqVal int
      set NOCOUNT ON

      update AllSequences
      set @NewSeqVal = CurrVal = CurrVal+Incr
      where SeqName = @SeqName

      if @@rowcount = 0 begin
            print 'Sequence does not exist'
            return
      end
      return @NewSeqVal
end
go 
```

# url - 由于可能的配置错误，请求超出了 10 个内部重定向的限制

> ID：10266401
> 
> 赞同：3
> 
> 时间：2012-04-22T08:29:22.123
> 
> 标签：url, magento, url-rewriting

我试图从 Magento 网站的 URL 中删除 index.php：_打开“使用网络服务器重写”_为必要的文件和文件夹设置权限 755_确保模式重写是打开_配置 htaccess 文件。注释，取消注释允许符号链接，将重写基础从 /magento/ 更改为 / 或 /var/www/hosts/www.domainname.com/ 或 /hosts/www.domainname.com/ 或 /www.domainname.com/ _reindex，刷新缓存

但所有结果都会导致 500 服务器内部错误。在日志文件中我可以看到：

```
[Fri Apr 20 11:11:59 2012] [error] [client 88.87.40.140] client denied by server configuration: /var/www/hosts/www.nordocks.no/app/etc/local.xml
[Fri Apr 20 11:12:07 2012] [error] [client 117.5.178.168] Request exceeded the limit of 10 internal redirects due to probable configuration error. 
```

这是我的 .htaccess

```
############################################
## uncomment these lines for CGI mode
## make sure to specify the correct cgi php binary file name
## it might be /cgi-bin/php-cgi

#    Action php5-cgi /cgi-bin/php5-cgi
#    AddHandler php5-cgi .php

############################################
## GoDaddy specific options

#   Options -MultiViews

## you might also need to add this line to php.ini
##     cgi.fix_pathinfo = 1
## if it still doesn't work, rename php.ini to php5.ini

############################################
## this line is specific for 1and1 hosting

    #AddType x-mapp-php5 .php
    #AddHandler x-mapp-php5 .php

############################################
## default index file

    DirectoryIndex index.php

<IfModule mod_php5.c>

############################################
## adjust memory limit

#    php_value memory_limit 64M
    php_value memory_limit 256M
    php_value max_execution_time 18000

############################################
## disable magic quotes for php request vars

    php_flag magic_quotes_gpc off

############################################
## disable automatic session start
## before autoload was initialized

    php_flag session.auto_start off

############################################
## enable resulting html compression

    #php_flag zlib.output_compression on

###########################################
# disable user agent verification to not break multiple image upload

    php_flag suhosin.session.cryptua off

###########################################
# turn off compatibility with PHP4 when dealing with objects

    php_flag zend.ze1_compatibility_mode Off

</IfModule>

<IfModule mod_security.c>
###########################################
# disable POST processing to not break multiple image upload

    SecFilterEngine Off
    SecFilterScanPOST Off
</IfModule>

<IfModule mod_deflate.c>

############################################
## enable apache served files compression
## http://developer.yahoo.com/performance/rules.html#gzip

    # Insert filter on all content
    ###SetOutputFilter DEFLATE
    # Insert filter on selected content types only
    #AddOutputFilterByType DEFLATE text/html text/plain text/xml text/css text/javascript

    # Netscape 4.x has some problems...
    #BrowserMatch ^Mozilla/4 gzip-only-text/html

    # Netscape 4.06-4.08 have some more problems
    #BrowserMatch ^Mozilla/4\.0[678] no-gzip

    # MSIE masquerades as Netscape, but it is fine
    #BrowserMatch \bMSIE !no-gzip !gzip-only-text/html

    # Don't compress images
    #SetEnvIfNoCase Request_URI \.(?:gif|jpe?g|png)$ no-gzip dont-vary

    # Make sure proxies don't deliver the wrong content
    #Header append Vary User-Agent env=!dont-vary

</IfModule>

<IfModule mod_ssl.c>

############################################
## make HTTPS env vars available for CGI mode

    SSLOptions StdEnvVars

</IfModule>

<IfModule mod_rewrite.c>

############################################
## enable rewrites

    Options +FollowSymLinks
    RewriteEngine on

############################################
## you can put here your magento root folder
## path relative to web root

    #RewriteBase /

############################################
## workaround for HTTP authorization
## in CGI environment

    RewriteRule .* - [E=HTTP_AUTHORIZATION:%{HTTP:Authorization}]

############################################
## always send 404 on missing files in these folders

    RewriteCond %{REQUEST_URI} !^/(media|skin|js)/

############################################
## never rewrite for existing files, directories and links

    RewriteCond %{REQUEST_FILENAME} !-f
    RewriteCond %{REQUEST_FILENAME} !-d
    RewriteCond %{REQUEST_FILENAME} !-l

############################################
## rewrite everything else to index.php

    RewriteRule .* index.php [L]

</IfModule>

############################################
## Prevent character encoding issues from server overrides
## If you still have problems, use the second line instead

    AddDefaultCharset Off
    #AddDefaultCharset UTF-8

<IfModule mod_expires.c>

############################################
## Add default Expires header
## http://developer.yahoo.com/performance/rules.html#expires

    ExpiresDefault "access plus 1 year"

</IfModule>

############################################
## By default allow all access

    Order allow,deny
    Allow from all

###########################################
## Deny access to release notes to prevent disclosure of the installed Magento version

    <Files RELEASE_NOTES.txt>
        order allow,deny
        deny from all
    </Files>

############################################
## If running in cluster environment, uncomment this
## http://developer.yahoo.com/performance/rules.html#etags

    #FileETag none 
```

请给我一个有关如何处理此错误的说明。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2014-11-25T10:24:30.997

就我而言，这不是权限问题，而只是（您的 也是如此`.htaccess`）以下行：

```
RewriteBase / 
```

被评论了。取消注释它解决了这个问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-01-17T20:27:17.920

我有同样的问题。

我的 Ubuntu 服务器上的 Magento 网站的目录是：/var/www/magento

在运行 Magento 初始安装时，我为 Use Web Server Rewrites 选择了“No”。此设置位于管理面板 - 系统 - 常规 - Web 下。

在完成初始安装后，在根 magento 文件夹的 .htaccess 中： RewriteBase /magento/ 如前所述，我的文件夹是 /var/www/magento/

我将 Web 服务器重写更改为是。在 .htaccess 我改变了： RewriteBase /

现在工作正常。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-22T17:00:43.613

> 为必要的文件和文件夹设置权限 755

你在这件事上碰了壁。需要设置 755 以外的其他权限的项目的权限已更改。

[重置文件权限](http://devdocs.magento.com/guides/m1x/install/installer-privileges_after.html#privs-after)

需要注意的基本事项是必须可写的文件和目录：

```
- file: magento/var/.htaccess
- directory: magento/app/etc
- directory: magento/var
- all the directories under: magento/media 

chmod o+w var var/.htaccess app/etc
chmod -R o+w media 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-06-16T14:00:39.517

我也遇到了这个问题

添加

```
RewriteBase / 
```

.htaccess 让我更进一步。在此之后，我遇到了下一个问题：

```
Could not determine temp directory, please specify a cache_dir manually";i:1;s:4307:"#0 /XXX/XXX/lib/Zend/Cache/Backend.php(217): Zend_Cache::throwException('Could not deter...') 
```

解决方案是编辑

```
\lib\Zend\Cache\Backend\File.php 
```

在 file.php 中搜索

```
'cache_dir' => null, 
```

并替换为

```
'cache_dir' => "var/tmp/", 
```

我希望这可以节省其他人一些时间。

# sqlite - 播放框架 2 SQLite

> ID：10266403
> 
> 赞同：5
> 
> 时间：2012-04-22T08:29:41.623
> 
> 标签：sqlite, playframework-2.0

我试图让 SQLite 与 playframework 一起工作，但到目前为止还没有运气。

我已经下载了 sqlitejdbc-v056.jar 并将其放入 lib 文件夹中。

然后我更改了application.conf：

```
db.driver=org.sqlite.JDBC
db.url="jdbc:sqlite:/db/geolookup.sqlite"
db.default.user=sa
db.default.password=sa 
```

我创建了一个文件夹 db 并将我的 sqlite db 放入其中。

现在我开始玩 play run

一切似乎都可以编译，但是当我调用 url 时：http: [//127.0.0.1 :9000](http://127.0.0.1:9000)

我收到以下错误：

driver.url 具有类型 STRING 而不是 OBJECT 并突出显示以下行：

```
db.driver=org.sqlite.JDBC 
```

我错过了什么？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-04-22T12:11:24.140

尝试这个：

```
db.default.driver="org.sqlite.JDBC"
db.default.url="jdbc:sqlite:/home/tex/dbtest"
db.default.user="sa"
db.default.password="" 
```

注意db的文件夹必须是绝对路径！

（顺便说一句：使用这种配置，应用程序会启动，但是当我尝试运行进化时它会抛出异常，我认为这是一个“方言”问题......）

希望这可以帮助...

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-12-15T09:22:26.470

您可能使用了错误的方法从配置中获取数据。根据您的错误，我假设您像这样使用它：

```
configuration.getConfig("db.driver") 
```

但此方法需要路径“db.driver”下的 JSON 对象。由于在“db.driver”路径下你有一个字符串，你应该使用这种方法读取数据：

```
configuration.getString("db.driver") 
```

这将使“而不是对象”错误消失。

# java - 我可以为 4GB 和 8GB Ram 提及多少 -XX:MaxPermSize 大小并为此计算？

> ID：10266404
> 
> 赞同：1
> 
> 时间：2012-04-22T08:29:42.233
> 
> 标签：java, permgen, java-memory-model

对于 4GB 和 8GB Ram，我可以提到多少 -XX:MaxPermSize 大小。这是我系统的其他细节

操作系统：-window XP（32 位） RAM：-4 GB java_opt- -Xms1536m -Xmx1536m //（作为环境变量提及）：tomcat 版本：-6.0.26

我有另一个带有 8GB 内存的系统，其他细节完全相同。是的，操作系统是 64 位 Window 7。

除此之外，还让我知道两个系统的 -Xmx 参数的最大值是多少？

如果有人可以告诉我计算得出该数字，那将是很棒的，这样我们就不必填写这个数字，但我们可以根据 RAM 系统进行逻辑计算？

我确实看到人们遇到 permgen 错误或堆错误，但每个人都在不断地使用这个参数，直到他们想出解决问题的方法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-22T08:47:12.473

根据[IBM 文档](http://publib.boulder.ibm.com/infocenter/javasdk/tools/index.jsp?topic=/com.ibm.java.doc.igaa/_1vg00014884d287-11c3fb28dae-7ff6_1001.html)，应用程序以 40% 的最小堆使用率和 70% 的最大堆使用率运行。

参考此信息

**[为什么我不能使用 32 位 JVM 获得更大的堆？](http://www.oracle.com/technetwork/java/hotspotfaq-138619.html#gc_heap_32bit)**

**[Windows中每个java进程的最大内存量？](https://stackoverflow.com/questions/987219/max-amount-of-memory-per-java-process-in-windows/987576)**

**[调整 Java 堆的大小](http://publib.boulder.ibm.com/infocenter/javasdk/tools/index.jsp?topic=/com.ibm.java.doc.igaa/_1vg00014884d287-11c3fb28dae-7ff6_1001.html)**

# wcf - WCF 多个端点不起作用

> ID：10266405
> 
> 赞同：0
> 
> 时间：2012-04-22T08:29:43.050
> 
> 标签：wcf

我试图让我的 WCF 服务具有可以通过代理客户端和 REST 调用调用的操作，我正在使用以下配置：

```
<services>
  <service behaviorConfiguration="SecureBehavior" name="Payment">
    <endpoint address="" binding="wsHttpBinding"  bindingConfiguration="secureWS" contract="IPayment"/>
    <endpoint address="rest" binding="webHttpBinding" behaviorConfiguration="webBehavior" contract="IPayment"/>
    <endpoint address="mex" binding="mexHttpBinding" contract="IMetadataExchange"/>
  </service>
  <bindings>
    <mexHttpBinding>
      <binding name="userMex"/>
    </mexHttpBinding>
    <wsHttpBinding>
      <binding name="secureWS">
        <security mode="Message">
          <message clientCredentialType="Windows" negotiateServiceCredential="true" establishSecurityContext="true"/>
        </security>
      </binding>
      <binding name="publicWS">
        <security mode="None"/>
      </binding>
    </wsHttpBinding>
  </bindings>
  <behaviors>
    <serviceBehaviors>
      <behavior name="SecureBehavior">
        <serviceMetadata httpGetEnabled="true"/>
        <serviceDebug includeExceptionDetailInFaults="true"/>
        <serviceCredentials>
          <windowsAuthentication allowAnonymousLogons="false"/>
        </serviceCredentials>
      </behavior>
      <behavior name="PublicBehavior">
        <serviceMetadata httpGetEnabled="true"/>
        <serviceDebug includeExceptionDetailInFaults="true"/>
        <serviceCredentials>
          <windowsAuthentication allowAnonymousLogons="true"/>
        </serviceCredentials>
      </behavior>
    </serviceBehaviors>
    <endpointBehaviors>
      <behavior name="webBehavior">
        <webHttp/>
      </behavior>
    </endpointBehaviors>
  </behaviors>
</services> 
```

这是我的代码：

```
[ServiceContract]
public interface IPayment
{
    [OperationContract]
    PaymentResult Finalize(string TransactionID, string CertificatePath);

    [OperationContract]
    [WebGet(UriTemplate = "rest")]
    System.IO.Stream GetPayment();
} 
```

现在，每当我运行我的服务时，我都会收到此错误：

> 合约“IPayment”的“Finalize”操作指定要序列化的多个请求主体参数，而无需任何包装器元素。最多一个 body 参数可以在没有包装元素的情况下被序列化。删除额外的正文参数或将 WebGetAttribute/WebInvokeAttribute 上的 BodyStyle 属性设置为 Wrapped。

在这里，我希望仅通过 .NET 客户端调用 Finalize 操作，并通过任何浏览器调用 GetPayment 操作。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-23T19:41:56.110

如果您不希望从通过 webhttp 端点连接的客户端调用您的 Finalize 方法，并且您不希望从通过 wshttp 连接的客户端调用 GetPayments，您可以简单地将合同一分为二。

假设您在 IIS 中托管，您可能需要做一些小技巧来确保它正常工作。让我举一个例子，使用问题中的细节......

首先是这两个服务的代码......

```
[ServiceContract]
public interface IPayment
{
    [OperationContract]
    [WebGet(UriTemplate = "rest")]
    System.IO.Stream GetPayment();
}

[DataContract]
public class PaymentResult
{
}

[ServiceContract]
public interface IMakePayment
{
    [OperationContract]
    PaymentResult Finalize(string TransactionID, string CertificatePath);
}

// Maybe you really should have the two services separate but if you do
// want to implement them both in a single class you can do this
public abstract class PaymentBase : IMakePayment, IPayment
{
    // ... Implement both interfaces here
    public PaymentResult Finalize(string TransactionID, string CertificatePath)
    {
        return null;
    }

    public System.IO.Stream GetPayment()
    {
        return null;
    }
}

public class MakePayment : PaymentBase
{
    // Empty
}

public class Payment : PaymentBase
{
    // Empty
} 
```

现在创建两个 .svc 文件，如下所示：

**MakePayment.svc**

```
<%@ ServiceHost Language="C#" Debug="true" Service="WebApplication1.MakePayment"  %> 
```

**付款.svc**

```
<%@ ServiceHost Language="C#" Debug="true" Service="WebApplication1.Payment" %> 
```

最后是 system.servicemodel 配置：

```
<system.serviceModel>
  <services>      
    <service behaviorConfiguration="SecureBehavior" name="WebApplication1.MakePayment">        
      <endpoint binding="wsHttpBinding" bindingConfiguration="secureWS" contract="WebApplication1.IMakePayment"/>
      <endpoint address="mex" binding="mexHttpBinding" contract="IMetadataExchange" bindingConfiguration="userMex"/>
    </service>
    <service behaviorConfiguration="PublicBehavior" name="WebApplication1.Payment">
      <endpoint binding="webHttpBinding" behaviorConfiguration="webBehavior" bindingConfiguration="publicWS" contract="WebApplication1.IPayment"/>
    </service>      
  </services>
  <bindings>
    <mexHttpBinding>
      <binding name="userMex"/>
    </mexHttpBinding>
    <wsHttpBinding>
      <binding name="secureWS">
        <security mode="Message">
          <message clientCredentialType="Windows" negotiateServiceCredential="true" establishSecurityContext="true"/>
        </security>
      </binding>
    </wsHttpBinding>
    <webHttpBinding>
      <binding name="publicWS">
        <security mode="None"/>
      </binding>
    </webHttpBinding>
  </bindings>
  <behaviors>
    <serviceBehaviors>
      <behavior name="SecureBehavior">
        <serviceMetadata httpGetEnabled="true"/>
        <serviceDebug includeExceptionDetailInFaults="true"/>
        <serviceCredentials>
          <windowsAuthentication allowAnonymousLogons="false"/>
        </serviceCredentials>
      </behavior>
      <behavior name="PublicBehavior">
        <serviceMetadata httpGetEnabled="true"/>
        <serviceDebug includeExceptionDetailInFaults="true"/>
        <serviceCredentials>
          <windowsAuthentication allowAnonymousLogons="true"/>
        </serviceCredentials>
      </behavior>
    </serviceBehaviors>
    <endpointBehaviors>
      <behavior name="webBehavior">
        <webHttp/>
      </behavior>
    </endpointBehaviors>
  </behaviors>
  <serviceHostingEnvironment multipleSiteBindingsEnabled="true" />
</system.serviceModel> 
```

你去 - 如果你连接到 /MakePayment.svc，你将通过 WSHTTP 连接并能够调用 FinalizePayment，如果你转到 /Payments.svc/rest，它将调用 GetPayment 方法，你将在其中返回一个流。

# ascii - 错误检测码和汉明距离

> ID：10266406
> 
> 赞同：-1
> 
> 时间：2012-04-22T08:29:44.860
> 
> 标签：ascii, error-detection, hamming-distance

![在此处输入图像描述](../Images/5d5573a50875ea95cd9af406517f1d78.png)

**v 和 w 的汉明距离等于 2，但如果没有奇偶校验位，它只会是 1。**为什么会这样？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-23T05:43:45.250

[在 StackExchange 的理论计算机科学](https://cstheory.stackexchange.com/)部分会更恰当地提出这个问题，但既然你很诚实并将其标记为家庭作业......

ASCII 使用 7 位来指定一个字符。（在 ASCII 中，“X”由 7 位“1011000”表示。）如果您从任何 ASCII 序列开始，则需要翻转以获取另一个合法 ASCII 序列的位数仅为 1 位。因此，纯 ASCII 序列之间的汉明距离为 1。

但是，如果添加一个奇偶校验位（总共 8 个位 - 7 个 ASCII 位加上一个奇偶校验位，通常显示在最左边的位置），那么序列中的任何一位翻转都会导致结果具有不正确的奇偶校验. 按照示例，*偶数*奇偶校验“X”由 表示`11011000`，因为选择奇偶校验位以在序列中给出*偶数个 1。*如果您现在翻转该序列中的任何单个位，那么结果将是不可接受的，因为它将具有不正确的奇偶校验。为了达到一个可接受的具有偶校验的新序列，您必须至少更改两位。因此，当奇偶校验生效时，可接受序列之间的汉明距离为 2。

# jquery - 使用 jQuery 撤消调整窗口大小的前置操作

> ID：10266412
> 
> 赞同：0
> 
> 时间：2012-04-22T08:30:50.890
> 
> 标签：jquery, resize, width, prepend

`div`如果窗口是特定大小，我目前有这个 jQuery 来添加 a 。

```
if ( $(window).width() < 480) {

   $('nav').css("display","none");

   $('#container').prepend('<div id="nav-btn"></div>');  
} 
```

`<div id="nav-btn"></div>`当浏览器被调整大小时，如何让它“持续”检查和隐藏？

编辑：我想要它，以便当窗口宽度达到 481px 时，`<nav>`元素被设置为`display:block;`并且`#nav-btn`被隐藏。但是是动态的，所以它在调整大小后都可以调整大小，而不仅仅是一次。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-22T10:02:55.913

以下满足您的要求（据我所知）：

```
$(window).resize(function() {
    if ($(window).width() < 482){
       $('nav').css("display","none");
        if (!$('#nav-btn').length){ // makes sure there's only ever one nav-button div
           $('<div />', {'id' : 'nav-btn'})
               .text('This is text, in the nav button')
               .appendTo($('#container'));
        }
    }
    else {
        $('nav').css('display','block');
        $('#nav-btn').remove();
    }
});

$(document).ready(
    function(){
        $(window).trigger('resize'); // making sure the resize stuff happens on DOMReady
    });​ 
```

[JS 小提琴演示](http://jsfiddle.net/davidThomas/PhNwT/1/)。

参考：

*   [`appendTo()`](http://api.jquery.com/appendTo/).
*   [`text()`](http://api.jquery.com/text/).
*   [`trigger()`](http://api.jquery.com/trigger/).

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-22T08:37:53.367

```
$(window).resize(function(){
    if ($(window).width() >= 481) {
        $("#nav-btn").remove();
        $("nav").css("display", "block");
    }
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-22T08:40:31.743

```
$(window).resize(function() {
    // Type your code here
}); 
```

[http://api.jquery.com/resize/](http://api.jquery.com/resize/)

> 当浏览器窗口的大小改变时，resize 事件被发送到 window 元素：

# objective-c - Objective-C 对象数组

> ID：10266414
> 
> 赞同：0
> 
> 时间：2012-04-22T08:30:52.543
> 
> 标签：objective-c, arrays, exc-bad-access

虽然有 OOP 经验，但我绝对是 Objective-C 的新手。我有以下代码：

```
// header files have been imported before this statement...
CCSprite *treeObstacle;
NSMutableArray *treeObstacles;

@implementation HelloWorldLayer {
}

-(id) init
{
    // create and initialize our seeker sprite, and add it to this layer
    treeObstacles = [NSMutableArray arrayWithObjects: nil];        
    for (int i=0; i<5; i++) {
        treeObstacle = [CCSprite spriteWithFile: @"Icon.png"];
        treeObstacle.position = ccp( 450-i*20, 100+i*20 );
        [self addChild:treeObstacle];
        [treeObstacles addObject: treeObstacle];
    }
    NSLog (@"Number of elements in array = %i", [treeObstacles count]);
    return self;
}

- (void) mymethod:(int)i {
    NSLog (@"Number of elements in array = %i", [treeObstacles count]);
}

@end 
```

第一个 NSLog() 语句返回“数组中的元素数 = 5”。问题是（虽然 treeObstacles 是一个文件范围的变量）当调用方法“mymethod”时，我会得到一个 EXC_BAD_ACCESS 异常。

有人可以帮我吗？

非常感谢基督徒

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-22T08:36:37.107

你创建`treeObstacles`的

```
treeObstacles = [NSMutableArray arrayWithObjects: nil]; 
```

这将返回一个自动释放的对象，并且您没有保留它，因此它将很快被释放

你必须通过调用它来保留`retain`它

```
[treeObstacles retain]; 
```

简单的创建它

```
treeObstacles = [[NSMutableArray alloc] init]; 
```

你需要记住在完成后释放它

```
- (void)dealloc {
    [treeObstacles release];
    [super dealloc];
} 
```

您需要阅读有关 Objective-C 管理的更多信息 [https://developer.apple.com/library/mac/#documentation/General/Conceptual/DevPedia-CocoaCore/MemoryManagement.html](https://developer.apple.com/library/mac/#documentation/General/Conceptual/DevPedia-CocoaCore/MemoryManagement.html)

或使用 ARC，因此无需再担心保留/释放 [http://developer.apple.com/library/ios/#releasenotes/ObjectiveC/RN-TransitioningToARC/Introduction/Introduction.html](http://developer.apple.com/library/ios/#releasenotes/ObjectiveC/RN-TransitioningToARC/Introduction/Introduction.html)

* * *

另一个问题，你需要调用`[super init]`你的`init`方法

```
- (id)init {
    self = [super init];
    if (self) {
        // your initialize code
    }
} 
```

否则您的对象将无法正确初始化

# php - PHP和MYSQL时间相关查询

> ID：10266419
> 
> 赞同：0
> 
> 时间：2012-04-22T08:31:29.093
> 
> 标签：php, mysql, time, cron

我正在开发一个 Web 应用程序，其中剩余部分将在一天中的特定时间发送给订阅者。假设一个人 John 填写了一张表格，并要求在每天下午 12 点发送剩余的电子邮件。我为此目的开发了一个 cron 作业，但我遇到了与时间相关的问题。这是我的问题，如果约翰来自美国，那么电子邮件必须根据美国时间发送等等。现在我使用 MYSQL 来存储每个人的时区和时间。但是如何根据特定时区安排电子邮件。我的服务器时间设置为 UTC。因此，如果一个人的时区为 GMT +5，我必须在 UTC 中添加多少小时，以便在正确的时间发送电子邮件。
我不需要代码，只需给我一个通用公式来计算电子邮件的正确时间。非常感谢，艾哈迈尔。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-22T08:38:24.957

看一下[`convert-tz`](http://dev.mysql.com/doc/refman/5.1/en/date-and-time-functions.html#function_convert-tz)功能。

```
mysql> SELECT CONVERT_TZ('2004-01-01 12:00:00','GMT','MET');
        -> '2004-01-01 13:00:00'
mysql> SELECT CONVERT_TZ('2004-01-01 12:00:00','+00:00','+10:00');
        -> '2004-01-01 22:00:00' 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-22T08:39:32.803

不要计算它，使用数据库。Mysql 拥有任何主流 RDBMS 中最好的时区支持。就从 Olson 更新其数据库的明智方法而言，它甚至比 Oracle 更好。

[http://dev.mysql.com/doc/refman/5.5/en/date-and-time-functions.html#function_convert-tz](http://dev.mysql.com/doc/refman/5.5/en/date-and-time-functions.html#function_convert-tz)

应该给你一个线索。

# android - 如何在android中顺时针和逆时针旋转图像？

> ID：10266428
> 
> 赞同：2
> 
> 时间：2012-04-22T08:32:57.037
> 
> 标签：android

我想知道如何使用 android 中的 onTouch() 事件顺时针和逆时针旋转图像。以及如何通过 onTouchListener 找出是顺时针还是逆时针旋转？谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-22T09:13:35.470

基本上，您可以将图像放在您自己的类中，该类扩展 View 并像这样实现 OnClickListener：

```
public class CustomImageView extends View implements OnClickListener{
    ...
} 
```

覆盖 CustomImageView 类中的 onDraw 方法。旋转可以通过旋转画布对象在 onDraw 内部实现。

第三，实现 onClick 以获取点击事件并根据您的需要进行旋转。

基本布局可能如下所示：

```
public class CustomImageView extends View implements OnClickListener{

     public void onClick (View v){

        // process click here

        // invalidate after click processing in order to redraw
        this.invalidate();
    }

    protected void onDraw(Canvas canvas) {

        // draw your image here, might be bitmap or other stuff

        // rotate canvas now, your logic on clockwise or 
        //  counterclockwise rotation goes here
        canvas.rotate(-90.0f, centerx, centery);

    }        

} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-09-01T15:36:55.143

您可以尝试使用此函数从 MotionEvent 对象的 x 和 y 值中获取旋转。在那里，我仍然需要从给定的向量 x 和向量 y 的附加计算中找到方向。

```
 private int calculateAngle(float GETX, float GETY) {
    int direction = 1;

    double tx = (int) GETX - object_center.x;
    double ty = (int) GETY - object_center.y;
    double angleInDegrees = Math.atan2(ty, tx) * 180 / Math.PI;
    int area = 0;
    int ACTUAL_ANGLE = 270;

    if (angleInDegrees < 0 && angleInDegrees < -90) {
        // Need to add
        // 270+angle degrees
        // =================
        ACTUAL_ANGLE += (int) (180 + angleInDegrees) * direction;
    } else if (angleInDegrees < 0 && angleInDegrees > -90) {
        // Need to add
        //  90+angle degrees
        // =================
        ACTUAL_ANGLE = (int) (90 + angleInDegrees);
    } else if (angleInDegrees > 0)
        ACTUAL_ANGLE = 90 + (int) angleInDegrees;
    return ACTUAL_ANGLE;
} 
```

# drupal - 过去 24 小时的节点统计信息

> ID：10266431
> 
> 赞同：1
> 
> 时间：2012-04-22T08:33:27.513
> 
> 标签：drupal, drupal-6, drupal-views

我的 drupal 网站上有一个“最受欢迎”块，它在视图中使用核心“节点统计：今日视图”过滤器。

我希望它会在过去 24 小时内按节点视图进行过滤，但它会清除统计信息并每天使用 cron 运行一次从头开始。

这意味着每天下午 5 点（即 cron 首次运行时），该块会自行清除并显示 5 个非常古老的故事，然后在接下来的几分钟内快速变化，因为故事开始再次增加观看次数。

有没有办法按 24 小时而不是按天过滤？基本上我正在寻找这个：[http](http://drupal.org/project/node_extended_stats) ://drupal.org/project/node_extended_stats for Drupal 6，但似乎没有。

对不起，如果我是愚蠢的。我环顾四周，找不到其他人问这个问题，但我确定我不是唯一一个遇到这个问题的人。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-17T16:10:39.347

您是否尝试过 Statistics Pro 模块？

*   [http://drupal.org/project/statspro](http://drupal.org/project/statspro)

# javascript - 如何制作一个 以慢动作出现

> ID：10266432
> 
> 赞同：1
> 
> 时间：2012-04-22T08:33:30.293
> 
> 标签：javascript

我希望 javascript 代码以慢动作显示 div。

```
function showDiv(divID)
{
       if(document.getElementById(divID).style.display=='none')
       {
           document.getElementById(divID).style.display='block';  
       }
} 
```

这里 div 出现了，但不是慢动作。谁能帮忙？？提前致谢

开发..

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-22T10:42:33.057

这根本不需要 jQuery，它只是一个基本的我正在使用你的函数来解释它是如何完成的。

```
 function showDiv(divID)
   {
       if(document.getElementById(divID).style.display=='none')
       {
           document.getElementById(divID).style.display='block';  
       }
} 
```

您的功能所做的基本上是从 BOX 模型中删除整个元素（块和无的切换完全从 BOX 模型中删除元素，因此它不占用任何空间或任何东西，但这可能/可能不会导致一些布局问题）；

现在要以慢动作为它制作动画，您需要一个计时功能。

计时函数是一个简单的数学函数，它给出给定时间或取决于其他参数的属性值（在您的情况下为不透明度）。

除此之外，您还需要使用像 opacity 这样的属性来淡化它（Opacity 是一个 CSS 属性，它定义了元素及其子元素的透明度）

所以让我们从一个非常基本的显示/隐藏开始，在 JS 中使用 setTimeout 函数。

```
function getValue(t,dir){

  if( dir > 0){
   return 0.5*t; /* Y = mx + c  */
  }else{
   return 1-(0.5*t);
  }
  /* 
    Here the slope of line m = 0.5.
    t is the time interval.
  */
}

function animator(divID){
      if(!(this instanceof animator)) return new animator(divID); /* Ignore this */
  var Node = document.getElementById(divID),
      start = new Date.getTime(), // The initiation.
      now = 0,
      dir = 1,
      visible = true;
  function step( ){
    now = new Date.getTime();
    var val = getValue( now - start,dir)
    Node.style.opacity = val;
    if( dir > 0 && val > 1 || dir < 0 && val < 0 ){
      visible = !(visible*1);
      // Optionally here u can call the block & none 
      if( dir < 0 ) { /* Hiding  and hidden*/
        Node.style.display = 'none'; // So if were repositioning using position:relative; it will         support after hide 
      }
      /* Our animation is finished lets end the continous calls */
      return;
    }
    setTimeout(step,100); // Each step is executated in 100seconds
  }
  this.animate = function(){
    Node.style.display = 'block';
    dir *= -1;
    start = new Date.getTime();
    setTimeout(step,100);
  } 
} 
```

现在您可以简单地调用该函数

```
 var magician = new animator('divName'); 
```

然后切换它的动画

```
 magician.animate(); 
```

现在使用计时功能，您可以创建任何您想要的可能性，如

```
 return t^2 / ( 2 *3.23423 ); 
```

甚至更高的多项式方程，如

```
 return t^3+6t^2-38t+12; 
```

如您所见，我们的功能非常基本，但它解释了如何使用纯 js 制作动画的要点。您可以稍后使用 CSS3 模块进行动画并使用 javascript 触发这些类 :-)

或者也许在可用的情况下使用 CSS3 编写一个跨浏览器 polyfill（它更快），如果不是 JS :-) 希望有所帮助

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-22T09:30:50.360

**跨浏览器解决方案**（不带 jQuery）：

HTML：

```
<div id="toChange" ></div> 
```

CSS：

```
#toChange
{
    background-color:red;
    width:200px;
    height:200px;
    opacity:0;//IE9, Firefox, Chrome, Opera, and Safari
    filter:alpha(opacity=0);//IE8 and earlier
} 
```

Javascript：

```
var elem=document.getElementById("toChange");
var x=0;

function moreVisible()
{
    if(x==1)clearInterval(t);
    x+=0.05;
    elem.style.opacity=x;
    elem.style.filter="alpha(opacity="+(x*100)+")";
}
var t=setInterval(moreVisible,25); 
```

小提琴演示：http: [//jsfiddle.net/JgxW6/1/](http://jsfiddle.net/JgxW6/1/)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-22T09:29:15.957

因此，您有一些 jQuery 答案，但**如果您只想要淡化 div，我不推荐使用 jQuery**。

当然 jQuery 让事情变得更容易，但是对于一个简单的功能来说它是很多开销。

这是一个用纯 JS 做到的人：

[在纯javascript中淡入淡出](https://codereview.stackexchange.com/questions/7315/fade-in-and-fade-out-in-pure-javascript)

还有一个 CSS3 示例：

[如何使用 Javascript 触发 CSS3 淡入效果？](https://stackoverflow.com/questions/8126404/how-to-trigger-css3-fade-in-effect-using-javascript)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-22T08:38:46.047

你可以使用 jquery $.show('slow') 来做同样的事情，如果你想在不使用 jquery 的情况下做同样的事情，那么你可能需要编写一些代码来自己显示效果，你可以看看 jquery's show 的源代码功能[http://james.padolsey.com/jquery/#v=1.6.2&fn=show](http://james.padolsey.com/jquery/#v=1.6.2&fn=show)。或者，您也可以使用 fadein() 在 jquery 中淡入效果

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2012-04-22T08:39:26.187

是的，您可以使用 Jquery 来完成。这是我的示例

```
$('#divID').click(function() {
   $('#book').show('slow', function() {
// Animation complete.
  }); 
```

});

详情请[点击这里](http://api.jquery.com/show/) 谢谢。

# android - Android SetText空指针异常

> ID：10266433
> 
> 赞同：2
> 
> 时间：2012-04-22T08:33:33.307
> 
> 标签：android, settext

我刚刚开始 Android 开发，我相信你可以帮助解决这个问题（我很抱歉我的英语不好）

我有一个主要活动，并且在某个时刻我想调用另一个活动，其中想要更改带有一些消息的文本视图。此时如果我不放 setContentView(R.layout.register); ，我会得到一个空指针异常；

但是，当我输入该行时，我正确地看到了带有我的新文本“Android2”的注册活动一毫秒，然后再次跳转到没有文本的注册活动。我的意思是我画了两次。我希望我已经解释得够多了。

问题是我必须在哪里放置 setcontentview 以及使用什么布局。

非常感谢，丹尼尔

我给你看一些代码：

我的主要活动有这种方法：

```
 protected void onActivityResult(int requestCode, int resultCode, Intent data)
    {

        if (requestCode == REQUEST_CODE && resultCode == RESULT_OK)
        {
            Intent i = new Intent(this, register.class);
            startActivity(i);       

            setContentView(R.layout.register);
            TextView text = (TextView) findViewById(R.id.texto);

            try {
                text.setText("Android2");
                }catch(Exception e) {
                    Log.i("Log", e.getMessage()+"Error!"); // LogCat message
                }
        }
        //super.onActivityResult(requestCode, resultCode, data);
    } 
```

我的第二个活动课程叫做注册：

```
public class register extends Activity {
   @Override
   protected void onCreate(Bundle savedInstanceState) {
      super.onCreate(savedInstanceState);
      setContentView(R.layout.register);
   }
} 
```

注册接口为 register.xml

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:orientation="vertical" >

    <TextView
        android:id="@+id/about_content"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_gravity="center"
        android:text="@string/register" />

    <TextView
        android:id="@+id/texto"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_gravity="center"
        android:text="" />

    <LinearLayout
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:orientation="horizontal" >

        <Button
            android:id="@+id/continue_button"
            android:layout_width="match_parent"
            android:layout_height="wrap_content"
            android:layout_weight="1"
            android:text="@string/save" />

        <Button
            android:id="@+id/new_button"
            android:layout_width="match_parent"
            android:layout_height="wrap_content"
            android:layout_weight="1"
            android:text="@string/repeat" />
    </LinearLayout>

</LinearLayout> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-22T09:27:06.807

你基本上做的是以下几点：

1.  您准备开始另一项活动的意图
2.  您开始准备意图的活动
3.  您将当前活动的内容设置为 R.layout.register
4.  你得到了 textView （在当前活动上）
5.  您将 textView 的文本设置为 Android2

并且，此时新的活动出现在屏幕上。请注意，您的代码不正确，因为您在当前活动中操作 UI 元素，并且您希望新启动的活动发生变化。

移动此代码

```
TextView text = (TextView) findViewById(R.id.texto);

try {
    text.setText("Android2");
}catch(Exception e) {
    Log.i("Log", e.getMessage()+"Error!"); // LogCat message
} 
```

到注册活动的 onCreate() 方法。

顺便说一句，通常，当您创建一个类时，根据标准，它的名称应该以大写字母开头。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-22T08:35:56.593

你有两个不同的活动。其中之一是使用 register.xml 视图，第二个是尝试访问 register 视图。该视图仅存在于您的`"register"`活动中。其他activity好像没有view？这可能就是你得到`NULL`.

您应该将这两个类合并在一起，因为看起来您正试图`texto`从同一个视图访问。

因此，总而言之，`findViewById`应该从调用`setContentView`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-22T08:38:57.967

删除此行，它应该可以工作

```
 startActivity(i); 
```

不知道您为什么将其称为外部活动。

否则将下面的代码移动到您的注册类

```
setContentView(R.layout.register);
        TextView text = (TextView) findViewById(R.id.texto);

        try {
            text.setText("Android2");
            }catch(Exception e) {
                Log.i("Log", e.getMessage()+"Error!"); // LogCat message
            }
    } 
```

# actionscript-3 - AS3 生成动态 SWF？

> ID：10266437
> 
> 赞同：0
> 
> 时间：2012-04-22T08:34:36.643
> 
> 标签：actionscript-3, actionscript

是否可以使用 AS3 以编程方式生成 .swf 文件？我的小应用程序所做的是使用 FileReference 加载一堆图像，现在我想将它们编译成用户可以下载的独立 swf（swf 将是幻灯片）。

[编辑]

对我的要求似乎有一些误解。我想要一个编译好的 swf，用户可以从中选择一些图像并按下一个按钮，从而 swf 将创建并编译包含所述图像的第二个 swf。由于这是一个独立的应用程序，因此不会有服务器端交互。

我在想的是会有一个代表动态类的字符串。当用户选择他们的图像时，适当的嵌入标签被添加到这个字符串中，然后被编译并保存到用户的桌面。

所以我的问题是，一个已编译的 swf 能否生成并编译第二个 swf？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-24T12:05:52.517

Take a look at this library, this allows you to create a .swf at runtime. [https://github.com/claus/as3swf](https://github.com/claus/as3swf)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-22T09:18:14.610

通过生成相关代码并运行 as3 编译器，应该可以做服务器端。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-23T20:49:50.127

我没有彻底调查过这个包，但是[As3Eval](http://eval.hurlant.com/)库似乎正在做你所要求的 - 将 AS3 实时编译成可执行字节码（在没有服务器交互的客户端上）。查看[演示](http://eval.hurlant.com/demo/#)。

我不确定它是否支持图像嵌入 - 也许您可以在动态构建的源代码中将图像数据编码为 base64 字符串。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-22T23:56:37.753

您还可以使用[swfmill](http://swfmill.org/)，这是一个从 XML 文档创建 SWF 文件的命令行工具。

它没有很好的文档记录，但是对于基本用法（例如创建资产库），您应该找到所需的内容。

# collapse - LINQPad：无论如何要使 Dump() 结果最初折叠？

> ID：10266439
> 
> 赞同：15
> 
> 时间：2012-04-22T08:35:03.413
> 
> 标签：collapse, linqpad

在任何地方都找不到它（谷歌或stackoverflow）。

有没有办法强制 Dump() 的输出自动折叠？

## 更新：

更多信息，以使问题更加集中。
如下所述，可以在通过键盘快捷键（Alt+1、Alt+2、Alt+3）渲染输出后进行折叠，并且可以通过传递`int` **`depth`**参数来确定渲染深度，但这不允许扩展结果。

有没有办法改变 CSS 格式？我对CSS不太流利，所以这可能是解决方案。

## 为什么我需要这个：

我想要的是使输出“更干净”，并在感兴趣的东西出现时潜入。我重复运行一个查询，并且不需要所有的输出，但仍然使用我的人类能力来检测变化，而不是编码检测。

## 更新：2013 年 11 月

正如乔（作者本人！）在评论中提到的那样，LINQPad 不再具有所描述的限制。现在可以声明 0 并在呈现信息后折叠信息。

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2012-04-22T09:32:05.277

不，尽管您可以使用数字调用 Dump 以强制它显示到该嵌套深度：

```
.Dump(0) 
```

您还可以使用格式化快捷键（Alt+1、Alt+2、Alt+3）将整个显示折叠为一层、两层或三层。

另一种选择是转储到网格。调用 Dump(true) 或使用工具栏按钮。网格仅显示一个级别，后续级别会根据需要通过超链接显示。

# javascript - 浏览器存储 - 物理位置？

> ID：10266446
> 
> 赞同：3
> 
> 时间：2012-04-22T08:35:36.217
> 
> 标签：javascript, html, cookies, cross-browser, local-storage

根据 ：

```
localStorage.setItem( key , value ); // global - not per session
sessionStorage.setItem("username", "John"); //per session 
```

问题 ：

**它实际上将存储文件/项目保存在**哪里？****

 ***（多浏览器答案将不胜感激）。*

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-27T14:59:44.097

从谷歌上的几个快速搜索中：

对于铬：

[http://www.techskater.com/web-stuff/accessing-google-chrome-extension-local-storage-database/](http://www.techskater.com/web-stuff/accessing-google-chrome-extension-local-storage-database/)

对于火狐：

[https://developer.mozilla.org/en/DOM/Storage#Storage_location_and_clearing_the_data](https://developer.mozilla.org/en/DOM/Storage#Storage_location_and_clearing_the_data)

IE：

[IE8 将存储在 localStorage 中的值存储在文件系统的哪个位置？](https://stackoverflow.com/questions/1412083/where-in-the-filesystem-does-ie8-store-values-stored-in-localstorage)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-12-05T08:57:47.963

chrome 存储区的链接不再有效，Mozilla 网站上的信息也没有多大用处。

Windows 7：chrome 的物理位置在 AppData\Local\Google\Chrome\User Data\Default\Local Storage 内，而对于 Mozilla，它的 AppData\Roaming\Mozilla\Firefox\Profiles\uvsb3rxs.default\storage\persistent\moz-safe -关于+家

我还没有找到 Internet Explorer 的 localstorage 文件夹。如果有人知道它的下落，请告诉我。

问候

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-07-17T22:47:19.163

其他一些 stackoverflow 答案还有其他详细信息：

*   Chrome：[HTML5 WebStorage 数据是如何物理存储的？](https://stackoverflow.com/questions/9669184/how-is-html5-webstorage-data-physically-stored/14887525#14887525)
*   Firefox：Firefox[在哪里存储 javascript/HTML localStorage？](https://stackoverflow.com/questions/7079075/where-does-firefox-store-javascript-html-localstorage/14901354#14901354)
*   Opera：[sessionStorage 和 localStorage 存储在哪里？](https://stackoverflow.com/questions/8634058/where-the-sessionstorage-and-localstorage-stored/15711210#15711210)**

# v4l2 - v4l2_buffer->timestamp 值从哪里开始计算？

> ID：10266451
> 
> 赞同：5
> 
> 时间：2012-04-22T08:36:08.173
> 
> 标签：v4l2

我正在尝试使用 v4l2_buffer 的时间戳值（类型 timeval）将从*UVC*网络摄像头捕获的图像同步到外部事件。

但是时间戳与系统时间或正常运行时间等不同：

```
printf("image captured at %ld, %ld\n",
   buffer->timestamp.tv_sec, 
   buffer->timestamp.tv_usec);

struct timeval tv;
gettimeofday(&tv, 0);
printf("current time %ld, %ld\n", tv.tv_sec, tv.tv_usec); 
```

结果是

```
image captured at 367746, 476270
current time 1335083395, 11225 
```

我的正常运行时间是 10 天。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-22T17:03:47.013

根据[http://comments.gmane.org/gmane.linux.drivers.video-input-infrastructure/39892](http://comments.gmane.org/gmane.linux.drivers.video-input-infrastructure/39892)一些 v4l2 驱动程序（包括 UVC 驱动程序）不使用实时时钟（墙上时间），而是使用单调时钟从未指定的时间点开始计数。在 Linux 上，这是启动时间（即正常运行时间），但是（我怀疑这是您不匹配的原因）只是计算机实际运行的时间（即当计算机挂起时此时钟不运行）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2015-06-27T10:29:59.130

如果您遇到 OP 的问题，并且您正在尝试获取每个帧的纪元时间戳，您可以使用下面的代码片段来执行此操作。

```
#include <time.h>
#include <math.h>

//////////////////////
//setup: 

    long getEpochTimeShift(){
        struct timeval epochtime;
        struct timespec  vsTime;

        gettimeofday(&epochtime, NULL);
        clock_gettime(CLOCK_MONOTONIC, &vsTime);

        long uptime_ms = vsTime.tv_sec* 1000 + (long)  round( vsTime.tv_nsec/ 1000000.0);
        long epoch_ms =  epochtime.tv_sec * 1000  + (long) round( epochtime.tv_usec/1000.0);
        return epoch_ms - uptime_ms;
    }

    //stick this somewhere so that it runs once, on the startup of your capture process
    //  noting, if you hibernate a laptop, you might need to recalc this if you don't restart 
    //  the process after dehibernation
    long toEpochOffset_ms = getEpochTimeShift();

//////////////////////
//...somewhere in your capture loop: 

    struct v4l2_buffer buf;

    //make the v4l call to  xioctl(fd, VIDIOC_DQBUF, &buf)

    //then: 
    long temp_ms = 1000 * buf.timestamp.tv_sec + (long) round(  buf.timestamp.tv_usec / 1000.0);
    long epochTimeStamp_ms = temp_ms + toEpochOffset_ms ;

    printf( "the frame's timestamp in epoch ms is: %ld", epochTimeStamp_ms); 
```

# mysql - 从存储在表中的列表中选择每个表的计数

> ID：10266452
> 
> 赞同：0
> 
> 时间：2012-04-22T08:36:22.197
> 
> 标签：mysql, sql, count

我有一个包含表名称的`tbls`字段`name`的表。

我正在尝试形成一个语句来获取每个表的行数。

我应该使用存储过程还是有更简单的方法来做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-22T08:45:55.530

有一个线程讨论如何[获取 MySQL 数据库中所有表的记录计数](https://stackoverflow.com/questions/286039/get-record-counts-for-all-tables-in-mysql-database)。使用结果，您可以将结果集约束到 tbls 表中指定的表。

# jquery - 在 datePicker 中获取选定的值并对其进行格式化

> ID：10266456
> 
> 赞同：5
> 
> 时间：2012-04-22T08:36:42.260
> 
> 标签：jquery, jquery-ui, datepicker

在 datePicker 中选中`20.04.2012`。我想得到这个值，格式化它并存储在一个变量中。我使用这段代码：

```
var date = $("#scheduleDate").datepicker({ dateFormat: 'dd,MM,yyyy' }).val(); 
```

但结果是`20.04.2012`。另外，我尝试了这段代码：

```
var dateTypeVar = $('#scheduleDate').datepicker('getDate');
$.datepicker.formatDate('dd-MM-yy', dateTypeVar); 
```

结果是`Fri Apr 20 2012 00:00:00 GMT+0600`。

我想得到以下信息：`20, April, 2012`
如何正确格式化？
谢谢。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-04-22T10:56:46.787

### 如果要获取输入的格式化值，请执行以下操作：

```
$("input").datepicker({ dateFormat: 'dd, mm, yy' }); 
```

稍后在您的代码中设置日期后，您可以通过

```
dateVariable = $("input").val(); 
```

### 如果您只想使用 datepicker 获取格式化值，您可能需要使用该实用程序

```
dateString = $.datepicker.formatDate('dd, MM, yy', new Date("20 April 2012")); 
```

我已经更新了[jsfiddle](http://jsfiddle.net/drinchev/5bwjL/3/)来试验这个

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2016-05-19T06:22:30.250

```
var dateObject = $("#datePickerInput").datepicker('getDate');
$.datepicker.formatDate('dd MM, yy', dateObject); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-22T08:40:59.960

使用[jquery-dateFormat](https://github.com/phstc/jquery-dateFormat)。它会解决你的问题。

您需要在 html 文件中包含 jquery.dateFormat。

```
<script>
var date = $('#scheduleDate').val();
document.write($.format.date(date, "dd,MM,yyyy"));

var dateTypeVar = $('#scheduleDate').datepicker('getDate');
document.write($.format.date(dateTypeVar, "dd-MM-yy"));
</script> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-07-15T02:22:33.980

```
$('#scheduleDate').datepicker({ dateFormat : 'dd, MM, yy'});

var dateFormat = $('#scheduleDate').datepicker('option', 'dd, MM, yy');

$('#scheduleDate').datepicker('option', 'dateFormat', 'dd, MM, yy');

var result = $('#scheduleDate').val();

alert('result: ' + result); 
```

结果：2012 年 4 月 20 日

# c# - 我如何在 C# 中包装一个函数，就像在 C 中使用内联头函数一样

> ID：10266462
> 
> 赞同：0
> 
> 时间：2012-04-22T08:37:38.950
> 
> 标签：c#

我正在用 c# 编写一些具有函数的类

```
Print(string s) 
```

在上一个版本中，我发现这个函数是从多个线程调用的，并且每次调用这个函数时都应该锁定它。在 C 语言中，我可以将此函数重命名为

```
PrintA(string s) 
```

并将头文件更改为类似

```
#define Print(a) {Lock(PrintA) //
                  { //
                      PrintA(a) //
                  } //
                 } 
```

是否可以在 C# 中编写类似的内容？我只想在整个代码中更改一个地方而不是多个地方。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-22T08:45:34.670

C# 中没有宏。要将同步添加到方法中，您可以使用：

```
void Print(string s)
{
    lock (lockObject) { PrintA(s); }
} 
```

您需要定义一个锁定对象，只需将一个字段添加到您的类

```
private readonly object lockObject = new object(); 
```

*或者你可以使用*

```
[MethodImpl(MethodImplOptions.Synchronized)]
void Print(string s) { ... } 
```

这相当于添加`lock(this)`到方法中。前者更可取，因为锁定对象是私有的，只有您可以锁定它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-22T08:44:52.143

如果你想锁定整个一个方法，你可以用`[MethodImpl(MethodImplOptions.Synchronized)]`属性装饰它：

```
[MethodImpl(MethodImplOptions.Synchronized)]
public void Print(string s)
{
    ...
} 
```

对于更具体的控制，您必须`lock`在代码块上使用。

# android - Android查看登录布局管理器

> ID：10266464
> 
> 赞同：0
> 
> 时间：2012-04-22T08:37:50.743
> 
> 标签：android, logging, layout-manager

我扩展了一个视图，并希望在布局管理器中查看调试输出（无需在模拟器/设备上进行测试）。这可能吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-22T10:40:38.207

你在使用 Eclipse 吗？如果您的布局有问题，“问题”和“错误日志”选项卡将保存信息。

此致。

# javascript - 无法在身体负荷上显示 div

> ID：10266469
> 
> 赞同：2
> 
> 时间：2012-04-22T08:38:23.490
> 
> 标签：javascript, jquery, css, animation

这是我在[jsfiddle Demo 中发布的代码。](http://jsfiddle.net/jjfpy/4/)

正如您在单击

*   海得拉巴。
*   维沙卡帕特南。

然后显示一个水平图像滑块（您可以通过图片滑动）

现在我的要求是我还需要在身体负荷本身上显示图像滑块

我曾尝试使用 body`onload`函数来显示 div 以及在 Jquery`ready`函数中，并通过在 javascript 中注释所有`hide()`函数，但它们都没有真正起作用。

谁能告诉我这样做的方法是什么。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-22T08:59:45.250

我刚刚测试了它..首先我认为你应该这样做：

```
jQuery(document).ready(function() {
    $fp_galleries.first().click();
}); 
```

但糟糕的是，这只会显示第一张图像而不是所有图像。

我不知道为什么，但看起来你应该这样[做](http://jsfiddle.net/jjfpy/5/)。

```
$(window).load(function() {
    /* your code */
    $fp_galleries.first().click();
}); 
```

也许是因为您需要等到图像加载完毕。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-22T08:43:48.230

也许使用准备调用函数的文档：http: [//api.jquery.com/ready/](http://api.jquery.com/ready/)

```
$(document).ready(function() {
  openGallery(galleryname){
}) 
```

;

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-22T08:52:25.353

问题不在于它被隐藏，而在于内容仅在用户单击您的链接之一时由 som javascript 生成。

你可以添加类似的东西

```
$("li",$fp_galleries).first().click() 
```

在脚本的底部。

这将触发其中一个链接的点击事件。

# java - 没有 KSoap2 和其他 Jar 库的 Android 和 .Net WebServices

> ID：10266471
> 
> 赞同：0
> 
> 时间：2012-04-22T08:38:27.267
> 
> 标签：java, android, web-services, soap, parameters

我需要学习使用您知道的一些教程或网站来询问 .net webservices 以逐步学习 SOAP 协议和 WebServices，或者您能给我一个示例代码，其中包含对传递 SomeImput 参数的 .net WebService 的请求/响应。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-22T12:48:22.183

android没有提供任何内置库来调用webservice。但是在谷歌搜索之后，我找到了下面的链接，作者在其中描述了如何在不使用第三方库和android原生API的情况下调用soap webservices。

[http://android-pro.blogspot.in/2011/06/calling-soap-web-services-with-android.html](http://android-pro.blogspot.in/2011/06/calling-soap-web-services-with-android.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-22T12:57:49.507

使用 kSoap2，我可以像这样调用肥皂网络服务：

```
 SoapObject request = new SoapObject(AppConstants.NAMESPACE, AppConstants.METHOD_NAME_GetLiveCalls);

      SoapSerializationEnvelope envelope = new SoapSerializationEnvelope(SoapEnvelope.VER11);
      envelope.dotNet=true;
      envelope.setOutputSoapObject(request);

      HttpTransportSE androidHttpTransport = new HttpTransportSE(URL);
      //androidHttpTransport.debug = true;
      androidHttpTransport.call(AppConstants.SOAP_ACTION_GetLiveCalls, envelope);

      SoapPrimitive result = (SoapPrimitive)envelope.getResponse();
      response = result.toString(); 
```

# java - 将休眠与 java 控制台应用程序一起使用

> ID：10266480
> 
> 赞同：0
> 
> 时间：2012-04-22T08:39:45.910
> 
> 标签：java, mysql, hibernate, console-application

也许我的问题很基础，但遗憾的是我对 Java EE 应用程序的经验很少，对 Hibernate 的了解也很少。

我正在开发一个控制台 Java 应用程序（即非 Java EE 应用程序），我想为此配置 Hibernate 以对用于持久性数据的 MySQL 数据库执行 ORM。但是，我不知道该怎么做，也无法在网上找到任何关于它的来源。

所以基本上：

*   我已经下载并放入了我的 buildpath`hibernate-jpa-2.0-api-1.0.1.Final.jar`和库。`hibernate3.jar``mysql-connector-java-5.1.19-bin.jar`
*   我知道我需要`persistence.xml`文件来声明我的持久性单元。在普通的 Java EE 应用程序中，这将驻留在`src/META-INF/persistence.xml`. 但是，我不确定在 java 控制台应用程序的情况下应该将文件放在哪里。
*   我永远无法判断是否在构建路径中包含 jar 并添加`persistence.xml`是否足以让我使用 Hibernate，所以请说是否需要其他内容。

我希望对 Hibernate 有更多经验的人可以帮助我开始。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-22T08:43:25.357

查看这组视频教程：[http ://embedr.com/playlist/java-hibernate-tutorial](http://embedr.com/playlist/java-hibernate-tutorial)

我会帮你的。

# java - 在 WAS 7 中将类文件直接添加到展开的部署耳中的后果

> ID：10266481
> 
> 赞同：0
> 
> 时间：2012-04-22T08:39:47.330
> 
> 标签：java, deployment, cluster-computing, websphere-7

我想知道将 java 类文件注入或删除到部署在 WAS 7 中的分解的 ear 文件中的优点和缺点（如果有的话）。

当我们安装打包的ear文件时，它会被分解到某个临时目录中，我们实际上可以进入类文件的文件夹位置并将其替换为我们的新类文件并重新启动服务器以加载它。

如果我们对 WAS 7 中的每个节点都执行此操作，并为 HA 一个一个地重新启动它们。会不会有问题。

谢谢。赛义德...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T19:29:37.357

这是另一个需要担心的骗局。如果您替换节点上的文件而 DMGR 不知道，如果您执行完全同步，则 DMGR 中的文件将被推送到节点。

推荐的方法是在 EAR 中正确获取新文件并进行另一次部署。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-23T20:45:32.247

如果类包含注释，您可能会遇到问题，因为应用程序部署会缓存注释扫描的结果。否则，您也许可以让它工作，但我怀疑如果出现问题，您会得到 IBM 的支持。您尝试执行的操作所支持的机制可通过wsadmin 中的[AdminApp.update](http://publib.boulder.ibm.com/infocenter/wasinfo/v8r0/topic/com.ibm.websphere.nd.multiplatform.doc/info/ae/ae/txml_updatingapp.html)获得。

# haskell - 将 MonadReader/MonadError 实例添加到 Transformer 类型

> ID：10266483
> 
> 赞同：3
> 
> 时间：2012-04-22T08:40:01.477
> 
> 标签：haskell, monads, monad-transformers, happstack

与使用 Happstack 时通常一样，我一直在制作自己的服务器 monad 用于处理程序，以涵盖我的数据库和会话，以及一些错误处理。我最近发现[`happstack-clientsession`](http://www.happstack.com/docs/happstack-clientsession-7.0.0/doc/html/happstack-clientsession/Happstack-Server-ClientSession.html)-Package 有很大帮助，它阻止我编写自己的解决方案。

`ClientSessionT`虽然在我自己的单子中接线有点麻烦。事实证明，它没有`MonadReader`or`MonadError`实例，所以我不能在我的包装器 monad 中实例化它们。

这是模块的完整代码：

```
{-# LANGUAGE OverloadedStrings, GeneralizedNewtypeDeriving, DeriveDataTypeable, EmptyDataDecls, TemplateHaskell #-}
module Server where

import Control.Monad
import Control.Monad.Error
import Control.Monad.Reader
import Control.Monad.Trans
import Data.Data (Data, Typeable)
import Data.SafeCopy (base, deriveSafeCopy)
import Database.MongoDB as M
import Happstack.Server
import Happstack.Server.Error
import Happstack.Server.ClientSession
import System.IO.Pool
import System.IO.Error
import Web.ClientSession (getDefaultKey)

type MongoPool e = Pool e Pipe

data PonySession = PonySession -- TODO: Fill in User type when available
    deriving (Ord, Read,Show, Eq, Typeable, Data)
$(deriveSafeCopy 0 'base ''PonySession)

instance ClientSession PonySession where
    empty = PonySession

newtype PonyServerPartT e m a = PonyServerPart (ClientSessionT PonySession (ReaderT (MongoPool IOError) (ServerPartT (ErrorT e m))) a)
    deriving (Monad, MonadIO, MonadReader (MongoPool e), MonadError e, ServerMonad, MonadPlus)

type PonyServerPart = PonyServerPartT IOError IO

runServerT s = mapServerPartT' (spUnwrapErrorT errorHandler) $ do
    key <- liftIO getDefaultKey
    let sessConf = (mkSessionConf key) { sessionCookieLife = MaxAge $ 60 * 60 * 24 * 7 }
    pool <- liftIO mongoPool
    runReaderT (runClientSessionT s sessConf) pool
    where errorHandler = simpleErrorHandler . show

mongoPool :: IO (MongoPool IOError)
mongoPool = newPool fac 10
    where fac = Factory {
            newResource = connect $ M.host "127.0.0.1",
            killResource = close,
            isExpired = isClosed
        } 
```

我得到的错误很明显：源自`MonadError`并且`MonadReader`不起作用。但我需要那些，否则整个表演有点没用。

由于我一直无法弄清楚这些是如何完成的（并且依赖于`deriving`），我想要一个涵盖这个特定问题的答案，并告诉我它是如何完成的。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-23T07:19:39.440

理论上，你会写这样的东西，除了你不能因为`ClientSessionT`构造函数和'unClientSessionT`函数没有被导出：

```
instance (Monad m, MonadError e m) => MonadError e (ClientSessionT st m) where
    throwError = ClientSessionT . throwError
    catchError (ClientSessionT m) f =
        ClientSessionT $ ReaderT $ \r -> StateT $ \s ->
          (runStateT (runReaderT m r) s) `catchError` (\e -> runStateT (runReaderT (unClientSessionT (f e)) r) s)

instance (Functor m, Monad m, MonadReader r m) => MonadReader r (ClientSessionT st m) where
    ask = ClientSessionT $ lift $ lift ask
    local f (ClientSessionT m) = ClientSessionT $ mapReaderT (mapStateT (local f)) m 
```

手工编写这些类型的实例是非常机械的——你会看到一些模式一次又一次地出现。（这就是为什么编译器可以在大多数情况下自动弄清楚如何做到这一点）。

在这种情况下，最好的解决方法是向作者抱怨丢失的实例。

darcs 版本现在包括`MonadError`、`MonadReader`和更多。加上一些其他的改变，它们会稍微破坏一些东西，但总体上会让事情变得更好。

现在还有一个demo目录：

[http://patch-tag.com/r/mae/happstack/snapshot/current/content/pretty/happstack-clientsession](http://patch-tag.com/r/mae/happstack/snapshot/current/content/pretty/happstack-clientsession)

我可能会发布它，并在一两天内进行一些小的更改和更多的评论。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-22T10:57:04.230

`newtype`派生机制期望`ClientSessionT`具有所需类型类的实例。我没有在您链接到 where `ClientSessionT`has instances for `MonadError`or的黑线鳕文档中看到`MonadReader`。追逐类型类约束（例如 for `Happstack`）也不会显示 for`MonadError`或 MonadReader 的实例。

[GHC 用户指南的第 7.5 节](http://www.haskell.org/ghc/docs/latest/html/users_guide/deriving.html#newtype-deriving)记录了一般机制。这个想法是，对于类型类和数据类型的`CanBark`实例`Dog`（即`instance CanBark Dog where ...`），新类型包装器可以自动访问通过搜索和替换。`DomesticDog``Dog``CanBark Dog``Dog``DomesticDog`

# java - 使用makefile从单个命令运行java类

> ID：10266484
> 
> 赞同：1
> 
> 时间：2012-04-22T08:40:03.927
> 
> 标签：java, makefile

我有一个使用以下命令测试的 Java 家庭作业：

```
make
./<program_name> <arguments> 
```

我的make文件成功编译了我的java程序，但是不使用命令如何运行程序：

```
java <program_name> 
```

我研究了如何将 .jar 转换为 .exe，但我确信这不是我想要的答案。

我相信测试是在 Linux 机器上运行的。有什么我可以在make文件中包含的东西来导致命令

```
./<program_name> 
```

运行已编译的java 类？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-22T08:45:25.373

如果不将 java 程序转换为本机可执行文件，对于 linux、windows 和任何其他平台（因此您将失去 Java 可移植性），这将是不同的，您唯一能做的就是创建一个启动脚本。

在 *nix 系统上，您可以创建 bash 脚本，在 Windows 上可以创建批处理脚本。然后在这个脚本中你必须调用`java <program_name>`. 使用该脚本，您现在可以使用单个命令启动您的应用程序。

例如在 unix 上，您可以创建`myapp.sh`：

```
#!/bin/bash
java -classpath bin com.test.YourApp $* 
```

并使用命令使此脚本可运行

```
chmod a+x myapp.sh 
```

在此示例中，当您编写命令时，您使用该文件夹作为类路径来`myapp.sh`启动您的 Java 类。`com.test.YourApp``bin`

# scala - Play 2.0 - 模板中的辅助构造函数

> ID：10266486
> 
> 赞同：3
> 
> 时间：2012-04-22T08:40:37.950
> 
> 标签：scala, playframework-2.0

Play 2.0 模板中是否可以有辅助构造函数？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-22T11:14:08.987

通过“构造函数”，我假设您的意思是具有不同参数的参数列表。我不知道这样做的内置方法，但我才刚刚开始学习 Play。

但是，您可以使用*Enhance My Instance* ™ 模式来实现相同的效果：

使用[待办事项列表示例](http://www.playframework.org/documentation/2.0/ScalaTodoList)，假设您的`index.scala.html`模板开始：

```
@(tasks: List[Task], taskForm: Form[String]) 
```

在`Application.scala`你称之为

```
 def tasks    = Action { Ok(views.html.index(Task.all(), taskForm)) } 
```

如果您想省略任务列表：

```
 implicit def enhanceIndex(index: views.html.index.type) = new {
    def apply(f: Form[String]) = index(List.empty, f)
  } 
```

现在你可以这样称呼它：

```
 def tasks2   = Action { Ok(views.html.index(taskForm)) } 
```

这本质上只是 pimp-my-library 模式，`.type`用于将范围缩小到特定实例，在本例中为`views.html.index`对象。

# sql - 如何将这个表格中的信息变成一个易于使用的表格？

> ID：10266494
> 
> 赞同：3
> 
> 时间：2012-04-22T08:42:25.097
> 
> 标签：sql, sql-server, string, sql-server-2005

我有一个必须维护的遗留产品。其中一张表与以下示例有些相似：

```
DECLARE @t TABLE
(
 id INT,
 DATA NVARCHAR(30)
);

INSERT  INTO @t
        SELECT  1,
                'name: Jim Ey'
        UNION ALL
        SELECT  2,
                'age: 43'
        UNION ALL
        SELECT  3,
                '----------------'
        UNION ALL
        SELECT  4,
                'name: Johnson Dom'
        UNION ALL
        SELECT  5,
                'age: 34'
        UNION ALL
        SELECT  6,
                '----------------'
        UNION ALL
        SELECT  7,
                'name: Jason Thwe'
        UNION ALL
        SELECT  8,
                'age: 22'

SELECT  *
FROM    @t;
/*
You will get the following result
id          DATA
----------- ------------------------------
1           name: Jim Ey
2           age: 43
3           ----------------
4           name: Johnson Dom
5           age: 34
6           ----------------
7           name: Jason Thwe
8           age: 22
*/ 
```

现在我想以以下形式获取信息：

```
name           age
-------------- --------
Jim Ey         43
Johnson Dom    34
Jason Thwe     22 
```

最简单的方法是什么？谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-22T09:00:47.707

出于（有点病态）的好奇心，我试图想出一种方法来转换您提供的确切输入数据。

当然，更好的方法是正确构建原始数据。对于遗留系统，这可能是不可能的，但是可以创建一个 ETL 流程来将此信息带到一个中间位置，这样就不需要实时运行像这样的丑陋查询。

## 示例 #1

*此示例假定所有 ID 都是一致且连续的（否则，需要使用附加`ROW_NUMBER()`列或新的标识列来保证对 ID 进行正确的余数运算）。*

```
SELECT
    Name = REPLACE( Name, 'name: ', '' ),
    Age = REPLACE( Age, 'age: ', '' )
FROM
(
    SELECT
        Name = T2.Data,
        Age = T1.Data,
        RowNumber = ROW_NUMBER() OVER( ORDER BY T1.Id ASC )

    FROM @t T1 
        INNER JOIN @t T2 ON T1.id = T2.id +1 -- offset by one to combine two rows
    WHERE T1.id % 3 != 0 -- skip delimiter records
) Q1
 -- skip every other record (minus delimiters, which have already been stripped)
WHERE RowNumber % 2 != 0 
```

## 示例 #2：不依赖于顺序 ID

*这是一个更实际的示例，因为实际的 ID 值无关紧要，只有行序列。*

```
DECLARE @NumberedData TABLE( RowNumber INT, Data VARCHAR( 100 ) );

INSERT @NumberedData( RowNumber, Data )
    SELECT 
        RowNumber = ROW_NUMBER() OVER( ORDER BY id ASC ),
        Data
    FROM @t;

SELECT 
    Name = REPLACE( N2.Data, 'name: ', '' ),
    Age = REPLACE( N1.Data, 'age: ', '' ) 
FROM @NumberedData N1 
    INNER JOIN @NumberedData N2 ON N1.RowNumber = N2.RowNumber + 1
WHERE ( N1.RowNumber % 3 ) = 2;

DELETE @NumberedData; 
```

## 示例 #3：光标

同样，最好避免实时运行这样的查询并使用计划的事务性 ETL 过程。以我的经验，像这样的半结构化数据很容易出现异常。

虽然示例 #1 和 #2（以及其他人提供的解决方案）展示了处理数据的巧妙方法，但转换这些数据的更实用的方法是游标。为什么？它实际上可能执行得更好（没有嵌套查询、递归、旋转或行编号），即使速度较慢，它也为错误处理提供了更好的机会。

```
-- this could be a table variable, temp table, or staging table
DECLARE @Results TABLE ( Name VARCHAR( 100 ), Age INT );

DECLARE @Index INT = 0, @Data VARCHAR( 100 ), @Name VARCHAR( 100 ), @Age INT;

DECLARE Person_Cursor CURSOR FOR SELECT Data FROM @t;
OPEN Person_Cursor;
FETCH NEXT FROM Person_Cursor INTO @Data;

WHILE( 1 = 1 )BEGIN -- busy loop so we can handle the iteration following completion
    IF( @Index = 2 ) BEGIN
        INSERT @Results( Name, Age ) VALUES( @Name, @Age );
        SET @Index = 0;
    END
    ELSE BEGIN
            -- optional: examine @Data for integrity

        IF( @Index = 0 ) SET @Name = REPLACE( @Data, 'name: ', '' );
        IF( @Index = 1 ) SET @Age = CAST( REPLACE( @Data, 'age: ', '' ) AS INT );
        SET @Index = @Index + 1;
    END

    -- optional: examine @Index to see that there are no superfluous trailing 
    -- rows or rows omitted at the end.

    IF( @@FETCH_STATUS != 0 ) BREAK;
    FETCH NEXT FROM Person_Cursor INTO @Data;
END

CLOSE Person_Cursor;
DEALLOCATE Person_Cursor; 
```

## 表现

我创建了 100K 行的示例源数据，前面提到的三个示例似乎大致等同于转换数据。

我创建了一百万行源数据，并且类似于以下的查询在选择行子集时提供了出色的性能（例如将在网页或报告的网格中使用）。

```
-- INT IDENTITY( 1, 1 ) numbers the rows for us
DECLARE @NumberedData TABLE( RowNumber INT IDENTITY( 1, 1 ), Data VARCHAR( 100 ) );

-- subset selection; ordering/filtering can be done here but it will need to preserve
-- the original 3 rows-per-result structure and it will impact performance
INSERT @NumberedData( Data )
    SELECT TOP 1000 Data FROM @t;

SELECT
    N1.RowNumber,
    Name = REPLACE( N2.Data, 'name: ', '' ),
    Age = REPLACE( N1.Data, 'age: ', '' ) 
FROM @NumberedData N1 
    INNER JOIN @NumberedData N2 ON N1.RowNumber = N2.RowNumber + 1
WHERE ( N1.RowNumber % 3 ) = 2;

DELETE @NumberedData; 
```

我看到一组一百万条记录的执行时间为 4-10 毫秒（i7-3960x）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-22T09:13:21.007

鉴于该表，您可以这样做：

```
;WITH DATA
AS
(
    SELECT
        SUBSTRING(t.DATA,CHARINDEX(':',t.DATA)+2,LEN(t.DATA)) AS value,
        SUBSTRING(t.DATA,0,CHARINDEX(':',t.DATA)) AS ValueType,
        ID,
        ROW_NUMBER() OVER(ORDER BY ID) AS RowNbr
    FROM
        @t AS t
    WHERE
        NOT t.DATA='----------------'
)
, RecursiveCTE
AS
(
    SELECT
        Data.RowNbr,
        Data.value,
        Data.ValueType,
        NEWID() AS ID
    FROM
        Data
    WHERE
        Data.RowNbr=1
    UNION ALL
    SELECT
        Data.RowNbr,
        Data.value,
        Data.ValueType,
        CASE 
            WHEN Data.ValueType='age'
            THEN RecursiveCTE.ID
            ELSE NEWID()
        END AS ID
    FROM
        Data
        JOIN RecursiveCTE
            ON RecursiveCTE.RowNbr+1=Data.RowNbr
)
SELECT
    pvt.name,
    pvt.age
FROM
    (
        SELECT
            ID,
            value,
            ValueType
        FROM
            RecursiveCTE
    ) AS SourceTable
    PIVOT
    (
        MAX(Value)
        FOR ValueType IN ([name],[age])
    ) AS pvt 
```

**输出**

```
Name          Age
------------------
Jim Ey        43
Jason Thwe    22
Johnson Dom   34 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-22T09:43:46.630

一种没有自连接、递归和单次遍历来自的行的解决方案`@t`：

```
SELECT  *
FROM
(
        SELECT  
                CASE 
                    WHEN a.DATA LIKE 'name:%' THEN 'Name'
                    ELSE 'Age'
                END AS Attribute,
                CASE 
                    WHEN a.DATA LIKE 'name:%' THEN SUBSTRING(a.DATA, 7, 4000) --or LTRIM(SUBSTRING(...,6,...))
                    ELSE SUBSTRING(a.DATA, 6, 4000) --or LTRIM(SUBSTRING(...,5,...))
                END AS Value,
                (ROW_NUMBER() OVER(ORDER BY id) + 1) / 2 AS PseudoDenseRank
        FROM    @t a
        WHERE   a.DATA LIKE 'name:%' OR a.DATA LIKE 'age:%'
) b
PIVOT( MAX(b.Value) FOR b.Attribute IN ([Name], [Age]) ) pvt 
```

结果：

```
PseudoDenseRank Name        Age
--------------- ----------- ---
1               Jim Ey      43
2               Johnson Dom 34
3               Jason Thwe  22 
```

注1：派生表`b`将使用. 派生表的结果：`name:%``age:%``(ROW_NUMBER() OVER(ORDER BY id) + 1) / 2``b`

```
Attribute Value       ROW_NUMBER() OVER(ORDER BY id) PseudoDenseRank
--------- ----------- ------------------------------ ---------------
Name      Jim Ey      1                              1
Age       43          2                              1
Name      Johnson Dom 3                              2
Age       34          4                              2
Name      Jason Thwe  5                              3
Age       22          6                              3 
```

注意 2：**如果`id`列中的值没有间隙**（例如 (id 1, name:Jim Ey), (id 3 age: 43) ），那么您可以`(a.id + 1) / 2 AS PseudoDenseRank`使用`(ROW_NUMBER() OVER(ORDER BY id) + 1) / 2 AS PseudoDenseRank`.

注意 3：**如果您使用`(a.id + 1) / 2 AS PseudoDenseRank`解决方案**（对姓名和年龄行进行分组），则第一个 id 值应该是奇数。如果第一个 id 值是偶数，那么你应该使用这个表达式`a.id / 2 AS PseudoDenseRank`。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-23T01:32:56.237

如果您升级到 SQL Server 2012，这是另一个选项，它为聚合函数实现 OVER 子句。这种方法将允许您只选择那些您知道自己想要的标签并找到它们，而不管名称之间有多少行。

如果姓名和年龄在代表单个人的一组行中的顺序并不总是相同，这也将起作用。

```
with Ready2Pivot(tag,val,part) as (
  select
    CASE WHEN DATA like '_%:%' THEN SUBSTRING(DATA,1,CHARINDEX(':',DATA)-1) END as tag,
    CASE WHEN DATA like '_%:%' THEN SUBSTRING(DATA,CHARINDEX(':',DATA)+1,8000) END as val,
    max(id * CASE WHEN DATA LIKE 'name:%' THEN 1 ELSE 0 END)
    over (
      order by id
    )
  from @t
  where DATA like '_%:%'
)
  select [name], [age]
  from Ready2Pivot
  pivot (
    max(val)
    for tag in ([name], [age])
  ) as p 
```

如果您的旧数据有一个包含额外项目的条目（例如“altName：Jimmy”），则此查询将忽略它。如果您的旧数据没有针对某人年龄的行（也没有 ID 号），那么它将在该位置为您提供 NULL。它将所有信息与最接近的前一行相关联，并将“名称：...”作为数据，因此每组行都有一个“名称：...”行是很重要的。

# android - 如何在android中签署我的testapp？

> ID：10266495
> 
> 赞同：0
> 
> 时间：2012-04-22T08:42:30.527
> 
> 标签：android

我是 Robotium 测试的新手。我读过“apk 文件必须具有与您的测试项目相同的证书签名”。

如何签署我的测试项目？

问候，钱德拉

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-22T09:21:45.500

我假设您想签署您的应用程序，以便您可以将其上传到 Android 市场……对吗？

[这](http://mussharapp.blogspot.com/2011/08/creating-your-android-market-ready-apk.html)是有关如何签署您的 apk 文件以使其准备好 Android Market 的分步说明

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-25T05:43:11.363

请参阅此 wiki 页面以获取更多信息：

[http://code.google.com/p/robotium/wiki/RobotiumForAPKFiles](http://code.google.com/p/robotium/wiki/RobotiumForAPKFiles)

# visual-studio-2010 - 通过远程控制设置 Visual Studio 和 Umbraco

> ID：10266504
> 
> 赞同：0
> 
> 时间：2012-04-22T08:44:18.570
> 
> 标签：visual-studio-2010, installation, umbraco, remote-access, small-business-server

我是 umbraco 的新手，最近下载了 Visual Studio，目的是设置它并让它全部工作。但是，事实仍然是我没有成功，而且我无法在互联网上找到与该主题相关的任何帖子。

场景很简单：

* * *

我通过网关连接到 Windows Small Business Server：remote.mysite.com。

在那个连接中，我登录到另一台服务器，在那里我终于找到了 umbraco 安装的根目录。

* * *

我如何将 Visual Studio 与那个 Umbraco 文件夹同步，这样我就不必一直传输文件了？

任何帮助将不胜感激！

最好的祝福，

布林克10

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-22T08:57:45.617

如果您想避免将代码 XCOPY 部署到该远程服务器，Visual Studio 将需要有网络连接。

*   您可以通过 Small Business Server[设置 SSTP VPN 连接](http://blog.c7solutions.com/2009/03/configuring-sstp-vpn-on-small-business_31.aspx)并连接到 Umbraco 服务器
*   您还可以在 Umbraco 服务器上设置 FTP 服务器，但您还需要在办公室防火墙上设置例外。
*   您还可以[观看](http://www.hanselman.com/blog/WebDeploymentMadeAwesomeIfYoureUsingXCopyYoureDoingItWrong.aspx)Scott Hanselman 的这段视频。

# node.js - 如何在 Mongoose/Node.js 中同时保存多个文档？

> ID：10266512
> 
> 赞同：90
> 
> 时间：2012-04-22T08:45:35.503
> 
> 标签：node.js, mongodb, mongoose

目前我使用 save 添加单个文档。假设我有一组文档，我希望将它们存储为单个对象。有没有办法通过一个函数调用将它们全部添加，然后在完成后获得一个回调？我可以单独添加所有文档，但管理回调以解决所有问题。

* * *

## 回答 #1

> 赞同：101
> 
> 时间：2013-01-03T06:08:22.677

Mongoose 现在支持将多个文档结构传递给[Model.create](http://mongoosejs.com/docs/api.html#model_Model-create)。引用他们的 API 示例，它支持传递数组或可变参数对象列表，最后带有回调：

```
Candy.create({ type: 'jelly bean' }, { type: 'snickers' }, function (err, jellybean, snickers) {
    if (err) // ...
}); 
```

或者

```
var array = [{ type: 'jelly bean' }, { type: 'snickers' }];
Candy.create(array, function (err, jellybean, snickers) {
    if (err) // ...
}); 
```

**编辑：**正如许多人所指出的，这不会执行真正的批量插入 - 它只是隐藏了`save`自己多次调用的复杂性。下面有答案和评论，解释了如何使用实际的 Mongo 驱动程序来实现批量插入以提高性能。

* * *

## 回答 #2

> 赞同：79
> 
> 时间：2016-03-18T17:05:12.213

Mongoose 4.4 添加了一个名为[`insertMany`](http://mongoosejs.com/docs/api.html#model_Model.insertMany)

> 验证文档数组并将它们插入 MongoDB（如果它们都有效）的快捷方式。此函数比 .create() 更快，因为它只向服务器发送一个操作，而不是为每个文档发送一个操作。

引用问题[#723](https://github.com/Automattic/mongoose/issues/723#issuecomment-178866230)中的 vkarpov15 ：

> 权衡是 insertMany() 不会触发预保存挂钩，但它应该具有更好的性能，因为它只对数据库进行 1 次往返，而不是每个文档 1 次。

该方法的签名与以下内容相同`create`：

```
Model.insertMany([ ... ], (err, docs) => {
  ...
}) 
```

或者，通过承诺：

```
Model.insertMany([ ... ]).then((docs) => {
  ...
}).catch((err) => {
  ...
}) 
```

* * *

## 回答 #3

> 赞同：41
> 
> 时间：2012-04-22T09:38:16.863

Mongoose 还没有实现批量插入（参见[issue #723](https://github.com/LearnBoost/mongoose/issues/723)）。

由于您知道要保存的文档数量，因此可以编写如下内容：

```
var total = docArray.length
  , result = []
;

function saveAll(){
  var doc = docArray.pop();

  doc.save(function(err, saved){
    if (err) throw err;//handle error

    result.push(saved[0]);

    if (--total) saveAll();
    else // all saved here
  })
}

saveAll(); 
```

当然，这是一个权宜之计，我建议使用某种流控制库（我使用[q](https://github.com/kriskowal/q)，它很棒）。

* * *

## 回答 #4

> 赞同：26
> 
> 时间：2013-05-31T21:45:01.633

除非您需要访问中间件，否则可以使用 .insert() 在 Mongoose 中进行批量插入。

`Model.collection.insert(docs, options, callback)`

[https://github.com/christkv/node-mongodb-native/blob/master/lib/mongodb/collection.js#L71-91](https://github.com/christkv/node-mongodb-native/blob/master/lib/mongodb/collection.js#L71-91)

* * *

## 回答 #5

> 赞同：14
> 
> 时间：2013-04-17T19:02:35.730

使用[异步并行](https://github.com/caolan/async#paralleltasks-callback)，您的代码将如下所示：

```
 async.parallel([obj1.save, obj2.save, obj3.save], callback); 
```

由于 Mongoose 中的约定与 async (err, callback) 中的约定相同，因此您无需将它们包装在您自己的回调中，只需将您的保存调用添加到一个数组中，当一切完成时您将收到一个回调。

如果您使用 mapLimit，您可以控制要并行保存的文档数量。在这个例子中，我们并行保存 10 个文档，直到所有项目都成功保存。

```
async.mapLimit(myArray, 10, function(document, next){
  document.save(next);
}, done); 
```

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2013-05-09T10:11:29.843

我知道这是一个老问题，但我担心这里没有正确的答案。大多数答案只是谈论遍历所有文档并单独保存每个文档，如果您有多个文档，这是一个坏主意，并且即使是许多请求中的一个，该过程也会重复。

MongoDB 专门`batchInsert()`调用了插入多个文档，这应该从本机 mongodb 驱动程序中使用。Mongoose 是基于这个驱动构建的，它不支持批量插入。这可能是有道理的，因为它应该是 MongoDB 的对象文档建模工具。

解决方案：Mongoose 自带原生 MongoDB 驱动程序。您可以通过要求使用该驱动程序`require('mongoose/node_modules/mongodb')`（对此不太确定，但如果它不起作用，您可以随时再次安装 mongodb npm，但我认为应该）然后做一个适当的`batchInsert`

* * *

## 回答 #7

> 赞同：8
> 
> 时间：2014-08-14T16:49:39.430

较新版本的 MongoDB 支持批量操作：

```
var col = db.collection('people');
var batch = col.initializeUnorderedBulkOp();

batch.insert({name: "John"});
batch.insert({name: "Jane"});
batch.insert({name: "Jason"});
batch.insert({name: "Joanne"});

batch.execute(function(err, result) {
    if (err) console.error(err);
    console.log('Inserted ' + result.nInserted + ' row(s).');
} 
```

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2012-04-22T09:44:47.560

这是另一种不使用其他库的方法（不包括错误检查）

```
function saveAll( callback ){
  var count = 0;
  docs.forEach(function(doc){
      doc.save(function(err){
          count++;
          if( count == docs.length ){
             callback();
          }
      });
  });
} 
```

* * *

## 回答 #9

> 赞同：5
> 
> 时间：2018-01-28T07:57:49.480

使用`insertMany`函数插入许多文档。这只会向服务器发送一个操作，并`Mongoose`在访问 mongo 服务器之前验证所有文档。默认情况下`Mongoose`，按照它们在数组中存在的顺序插入项目。如果您可以不维护任何订单，请设置`ordered:false`。

**重要 - 错误处理：**

当`ordered:true`验证和错误处理发生在一个组中时，意味着如果一个失败，一切都会失败。

当`ordered:false`验证和错误处理单独发生时，操作将继续。错误将在一系列错误中报告。

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2015-06-16T19:31:35.823

您可以使用 mongoose 返回的 promise `save`，`Promise`在 mongoose 中并不具备所有功能，但您可以使用此模块添加功能。

创建一个模块来增强 mongoose 的承诺。

```
var Promise = require("mongoose").Promise;

Promise.all = function(promises) {
  var mainPromise = new Promise();
  if (promises.length == 0) {
    mainPromise.resolve(null, promises);
  }

  var pending = 0;
  promises.forEach(function(p, i) {
    pending++;
    p.then(function(val) {
      promises[i] = val;
      if (--pending === 0) {
        mainPromise.resolve(null, promises);
      }
    }, function(err) {
      mainPromise.reject(err);
    });
  });

  return mainPromise;
}

module.exports = Promise; 
```

然后将它与猫鼬一起使用：

```
var Promise = require('./promise')

...

var tasks = [];

for (var i=0; i < docs.length; i++) {
  tasks.push(docs[i].save());
}

Promise.all(tasks)
  .then(function(results) {
    console.log(results);
  }, function (err) {
    console.log(err);
  }) 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2013-03-01T22:43:05.037

添加一个名为 mongoHelper.js 的文件

```
var MongoClient = require('mongodb').MongoClient;

MongoClient.saveAny = function(data, collection, callback)
{
    if(data instanceof Array)
    {
        saveRecords(data,collection, callback);
    }
    else
    {
        saveRecord(data,collection, callback);
    }
}

function saveRecord(data, collection, callback)
{
    collection.save
    (
        data,
        {w:1},
        function(err, result)
        {
            if(err)
                throw new Error(err);
            callback(result);
        }
    );
}
function saveRecords(data, collection, callback)
{
    save
    (
        data, 
        collection,
        callback
    );
}
function save(data, collection, callback)
{
    collection.save
    (
        data.pop(),
        {w:1},
        function(err, result)
        {
            if(err)
            {               
                throw new Error(err);
            }
            if(data.length > 0)
                save(data, collection, callback);
            else
                callback(result);
        }
    );
}

module.exports = MongoClient; 
```

然后在您的代码更改中，您需要

```
var MongoClient = require("./mongoHelper.js"); 
```

然后何时保存通话（在您连接并检索集合之后）

```
MongoClient.saveAny(data, collection, function(){db.close();}); 
```

您可以更改错误处理以满足您的需要，在回调中传回错误等。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2015-07-26T15:23:45.547

这是一个老问题，但是当我搜索“猫鼬插入文档数组”时，它首先出现在谷歌结果中。

您可以使用两个选项 model.create() [mongoose] 和 model.collection.insert() [mongodb]。在此处查看有关每个选项的优缺点的更全面讨论：

[猫鼬（mongodb）批量插入？](https://stackoverflow.com/questions/16726330/mongoose-mongodb-batch-insert)

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2015-11-04T17:04:14.687

`Model.collection.insert()`这是直接在 Mongoose中使用 MongoDB 的示例。请注意，如果您没有那么多文档，比如少于 100 个文档，则不需要使用 MongoDB 的批量操作（[请参阅此](https://docs.mongodb.org/manual/core/bulk-write-operations/)）。

> MongoDB 还通过将文档数组传递给 db.collection.insert() 方法来支持批量插入。

```
var mongoose = require('mongoose');

var userSchema = mongoose.Schema({
  email : { type: String, index: { unique: true } },
  name  : String  
}); 

var User = mongoose.model('User', userSchema);

function saveUsers(users) {
  User.collection.insert(users, function callback(error, insertedDocs) {
    // Here I use KrisKowal's Q (https://github.com/kriskowal/q) to return a promise, 
    // so that the caller of this function can act upon its success or failure
    if (!error)
      return Q.resolve(insertedDocs);
    else
      return Q.reject({ error: error });
  });
}

var users = [{email: 'foo@bar.com', name: 'foo'}, {email: 'baz@bar.com', name: 'baz'}];
saveUsers(users).then(function() {
  // handle success case here
})
.fail(function(error) {
  // handle error case here
}); 
```

# powerpoint - 从ppt powerpoint文件中提取背景

> ID：10266513
> 
> 赞同：1
> 
> 时间：2012-04-22T08:45:36.277
> 
> 标签：powerpoint, extract

有谁知道如何从powerpoint ppt文件中提取背景？我一直在谷歌上搜索它，我读到了一些关于幻灯片大师的东西，但我在任何地方都看不到它。

我在 Mac 上运行 Microsoft PowerPoint 2008。

任何帮助，将不胜感激。

提前致谢，J

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-22T15:58:35.590

如果您打算自动完成这项工作，您可能必须使用 Applescript 来完成这项工作。PPT 2008 缺少 VBA。顺便说一下，MacTech 杂志在他们的网站上有一个通过 Applescript 自动化 Office 2008 的详尽指南。

在实践中，如果您知道要提取哪张幻灯片的背景，并假设您要将其提取为图像，您将创建幻灯片的副本，删除幻灯片上的所有形状（只留下背景图形），然后使用 Slide.Export 方法以您需要的任何分辨率保存图像文件，最大宽度为 3000 像素左右。

如果有任何方法可以将 2008 年装袋并改用 2011 年，那么生活会变得更简单，而且你会留下更多完整的头发。;-)

# internet-explorer - IE、Firefox、Chrome、Opera 和 Safari

> ID：10266517
> 
> 赞同：-1
> 
> 时间：2012-04-22T08:46:11.797
> 
> 标签：internet-explorer, firefox, google-chrome, opera

当我创建一个网页时，每次我开始在 photoshop 中创建布局时，我都会对图像进行切片，而不是在 Dreamweaver 中我开始对其进行编码 HTML、CSS 和 Javascript (Jquery) 并且我使用 PHP 如果我想使用数据库。

使用 HTML 和 CSS 对页面进行编码时，每次完成代码块（div、span 等）时，我都会使用 Firefox、Google Chrome、Opera、IE 和 Safari 进行检查。在 Firefox、Chrome 和 Opera 中一切正常，但在 IE 和 Safari 中，一些 div 是不可见的，图像浮动，不可见图像等。

这就是我创建网页的方式。您如何创建自己的网页？你从哪里开始？当这样的事情发生时我应该怎么做（IE 或 Safari 上的不可见元素）？我总是用谷歌搜索它，发现在旧版本的 Internet Explorer 或同一版本上我需要实现一些代码。我没有使用旧版本的经验，有时我不知道为什么会发生这种情况。我不知道在哪里搜索，或者我需要搜索什么关键字。

例如我需要使用边界半径，但在 IE 中它似乎被破坏了。有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-22T08:58:06.100

border-radius 在 IE9 中可用，应该可以正常工作。

关于我的工作方式：

1.  我收到了布局（来自设计师和切片图像）并正在对其进行编码 - 通常我使用 SublimeText 2。
2.  在 Firefox 和 Chrome（moz 和 webkit）中测试它。Web 开发工具真的很有帮助。
3.  在 Opera 中测试 - 它通常工作得很好
4.  为 IE 编写其他 CSS 文件（你知道，出于兼容性原因）

我建议使用一个好的 wordpres 主题并查看 CSS 文件。它可能会帮助你。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-22T08:56:13.013

当我开始一个网页时，我会布局网站的主要部分，例如页眉、菜单和页脚 div，然后按自己的方式进入。

不幸的是，对于 Web 开发人员来说，某些浏览器显示元素的方式存在差异。要调试这些问题，请使用诸如 firebug for FF 之类的开发人员工具包，这些对您有很大帮助，因为您可以将页面分开。Chrome 有一个非常好的内置工具包，IE 有点差，当你按 F12 时它会出现。

IE 不支持边框半径，我喜欢使用这个工具来生成我的边框半径 CSS，因为它适用于所有其他浏览器。

# ruby-on-rails - #<# 的未定义方法 `charities_path' :0x0000000344f220>

> ID：10266519
> 
> 赞同：1
> 
> 时间：2012-04-22T08:46:38.977
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, rubygems

我现在面临这个错误很长一段时间了，我尝试了很多解决方案，但都没有奏效。让我的场景清晰：1）我没有使用脚手架命令并手动创建整个东西 2）错误是在尝试创建新的 Charity 时生成的

**错误：**

```
Showing /home/hitesh/Rails/ReachOut/app/views/charity/_form.html.erb where line #1 raised:

undefined method `charities_path' for #<#<Class:0x000000035ab3f8>:0x0000000344f220>

Extracted source (around line #1):

1: <%= form_for(@charity) do |f| %>
2:   <% if @charity.errors.any? %>
3:     <div id="error_explanation">
4:       <h2><%= pluralize(@charity.errors.count, "error") %> THis is where i screwed prohibited this charity from being saved:</h2> 
```

**我的 _form.html.erb 看起来像这样：**

```
 <%= form_for(@charity) do |f| %>
    <% if @charity.errors.any? %>
       <div id="error_explanation">
         <h2><%= pluralize(@charity.errors.count, "error") %> THis is where i screwed prohibited this charity from being saved:</h2>

      <ul>
      <% @charity.errors.full_messages.each do |msg| %>
        <li><%= msg %></li>
      <% end %>
      </ul>
    </div>
  <% end %>

  <div class="field">
    <%= f.label :name %><br />
    <%= f.text_field :name %>
  </div> 
```

**MY routes.rb 包含慈善机构的条目**

```
ReachOut::Application.routes.draw do
  resources :charity

  # The priority is based upon order of creation:
  # first created -> highest priority. 
```

**我的慈善控制器：**

```
class CharityController < ApplicationController

        # GET /charity/new
        # GET /charity/new.json
        def new
                @charity = Charity.new

                respond_to do |format|
                        format.html #new.html.erb
                        format.json { render json: @charity}
                end
        end 
```

**和我的charity.rb（模型）：**确实包含一个慈善类

...

伙计们，我尝试了很多事情（更改@ => :)，但仍然无法消除此错误...希望你们中的任何人都可以帮助我...我在整个系统中搜索了 charities_path 并且可以一无所获:) :(。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-22T09:33:46.193

你需要`resources :charities`在 routes.rb

并且控制器必须命名为 CharitiesController

或者您必须手动设置路径辅助方法，但在这种情况下您可能会遇到另一个问题，最好遵循 rails 命名规则

# html - 在浏览器中保留离线消息。邮箱、YouTube 等

> ID：10266529
> 
> 赞同：1
> 
> 时间：2012-04-22T08:48:15.287
> 
> 标签：html, offline, offline-browsing

当互联网连接不可用时，我们尝试浏览到之前打开的 Gmail，可以看到一条消息：

> `Gmail The app is currently unreachable.`

Youtube 也是如此。

在 Gmail 离线消息中，我在 body 标记中看到了这个属性：

```
jstcache="0" 
```

当页面/浏览器离线时，我们如何实现这样的页面？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-22T09:06:32.837

他们正在使用离线浏览，这是 HTML5 规范中的另一个新功能。看看这里： [http ://diveintohtml5.info/offline.html](http://diveintohtml5.info/offline.html)

它使您能够使用清单在您的站点上定义可缓存的某些资产。只要用户离线，浏览器就会保存它们并相应地显示。

# python - Python中的分布式编程

> ID：10266531
> 
> 赞同：7
> 
> 时间：2012-04-22T08:48:43.200
> 
> 标签：python, distributed

我打算编写一个简单的数据流框架，它基本上由对象的惰性方法调用组成。如果我曾经考虑过分布式编程，那么在 Python 中启用它的最简单方法是什么？没有我做网络编程的任何透明解决方案？

或者首先，如何在 Python 中使用多核处理器？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-04-22T18:10:29.043

> 对象的惰性方法调用

真的可以是任何东西，所以让我们分解一下：

## 简单的 Let-Me-Call-That-Function (RPC)

好幸运你！python 拥有远程过程调用最伟大的实现之一： [RPyC](http://rpyc.sourceforge.net/)。

只需运行服务器（双击文件，请参阅教程），

打开解释器并：

```
import rpyc
conn = rpyc.classic.connect("localhost")
data_obj = conn.modules.lazyme.AwesomeObject("ABCDE")
print(data_obj.calculate(10)) 
```

还有一个惰性版本（异步）：

```
# wrap the remote function with async(), which turns the invocation asynchronous
acalc = rpyc.async(data_obj.calculate)
res = acalc(10)
print(res.ready, res.value) 
```

## 简单的数据分布

你有一个定义好的工作单元，比如说一个复杂的图像处理。您所做的是粗略地创建`Node`（s），它执行实际工作（也就是拍摄图像，进行操作并返回结果），收集结果的人（a `Sink`）和创建工作的人（the `Distributor`）。

看看[芹菜](http://celeryproject.org/)。

如果它的规模很小，或者只是想玩它，请查看包装`Pool`中的对象：`multiprocessing`

```
from multiprocessing import Pool
p = Pool(5)
def f(x):
     return x*x
print(p.map(f, [1,2,3])) 
```

而真正懒惰的版本：

```
print(p.map_async(f, [1,2,3])) 
```

它返回一个可以检查结果的 Result 对象。

## 复杂的数据分布

一些多层次的不仅仅是触发&忘记复杂的数据操作，或多步骤处理用例。

在这种情况下，您应该使用诸如[ZeroMQ](http://www.zeromq.org/)或[RabbitMQ](http://www.rabbitmq.com/)之类的消息代理。它们允许您轻松地跨多个服务器发送“消息”。

它们使您免于 TCP 领域的恐惧，但它们有点复杂（有些，如 RabbitMQ，需要一个单独的进程/服务器用于 Broker）。但是，它们可以让您对数据流进行更细粒度的控制，并帮助您构建真正可扩展的应用程序。

## 懒惰的任何东西

虽然本身不​​是数据分发，但它是 Web 服务器后端最热门的趋势：使用“绿色”线程（或事件或协程）将 IO 繁重的任务委托给专用线程，而应用程序代码正忙于最大化 -出CPU。

我非常喜欢[Eventlet](http://eventlet.net/doc/)，而[gevent](http://www.gevent.org/)是另一种选择。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-22T09:42:49.043

试试 Gearman [http://gearman.org/](http://gearman.org/)

> Gearman 提供了一个通用的应用程序框架，将工作外包给其他更适合完成工作的机器或进程。它允许您并行工作、负载平衡处理以及在语言之间调用函数。它可用于各种应用程序，从高可用性网站到数据库复制事件的传输。换句话说，它是分布式处理如何通信的神经系统。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-22T09:04:29.440

请先阅读 python.org 官方资源：

[http://wiki.python.org/moin/ParallelProcessing](http://wiki.python.org/moin/ParallelProcessing)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-01T11:00:01.120

您可能会考虑的另一个框架是[Versile Python](https://versile.com/products/vpy/)（完全披露：我是一名 VPy 开发人员）。文档[配方](https://versile.com/doc/vpy/current/recipes/index.html)有相关的代码示例。使用该框架，可以轻松设置和连接到服务，您可以为类定义显式公共方法接口或使用本[机 python](https://versile.com/doc/vpy/current/recipes/native.html)类型框架远程访问本地方法。

请注意，您必须将程序设置为在多个进程中运行才能利用多个内核（由于 python 全局解释器锁）。

# jquery - 将 div 动态附加到表中的 td

> ID：10266532
> 
> 赞同：2
> 
> 时间：2012-04-22T08:49:03.533
> 
> 标签：jquery

```
 var $table = $('<table/>').addClass('commentbox');

$table.append('<tr><td>' + 'Comment Id:'+ '</td></tr>');

var $wrap = $('<div/>').attr('id', 'container');

var $in = $('<input type="button" value="Reply"/>').attr('id', 'reply');
$wrap.append($in);
 $table.append(
                 $('<tr>')
                         .append($('<td>'),
                         $('<td>'))
                       );
      $table.append($wrap); 
```

我希望将 div id 容器添加到 td 中，但我正在获取 html

```
 <table>
   <tbody>
    <tr>
      <td>Comment</td>
     </tr>
     <tr>
        <td>
        </td><td></td>
     </tr>
  <tbody>
     <div id="container">
      <input type="button" value="Reply" id="reply">
     </div>
</table> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-22T09:00:59.580

您需要将`$wrap`对象附加到`<td>`元素，而不是`$table`.

尝试这样的事情：

```
var $table = $('<table/>').addClass('commentbox');

$table.append('<tr><td>' + 'Comment Id:'+ '</td></tr>');

var $wrap = $('<div/>').attr('id', 'container');
var $in   = $('<input type="button" value="Reply"/>').attr('id', 'reply');

$wrap.append($in);

$table.append(
    $('<tr>').append($('<td>').append($wrap), $('<td>').html('hello'))
); 
```

在这里演示：http: [//jsfiddle.net/umCDP/](http://jsfiddle.net/umCDP/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-22T09:06:52.663

您也可以直接使用 Javascript 来创建 HTML：

```
var table = document.createElement("table");

var tbody = document.createElement("tbody");
var tr_comment = document.createElement("tr");
var td_comment = document.createElement("td");
td_comment.appendChild(document.createTextNode("Comment"));
tr_comment.appendChild(td);
tbody.appendChild(tr_comment);

var tr_container = document.createElement("tr");
var td_container = document.createElement("td");
var div_container = document.createElement("div");
div_container.setAttribute("id", "container");
var input = document.createElement("input");
input.setAttribute("type", "button");
input.setAttribute("value", "Reply");
input.setAttribute("id", "reply");
div_container.appendChild(input);
td_container.appendChild(div_container);
tr_container.appendChild(td_container);
tbody.appendChild(tr_container);

table.appendChild(tbody); 
```

使用 Javascript 添加元素应该可以提高性能。

[使用 jQuery 创建 HTML 元素的最有效方法是什么？](https://stackoverflow.com/questions/327047/what-is-the-most-efficient-way-to-create-html-elements-using-jquery)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-22T09:07:43.260

您需要附加到 $('table tbody')。例子：

```
$('table tbody').append($('<tr><td>new row</td></tr>')); 
```

# ruby-on-rails - 如何测试黄瓜上的日期时间选择输入

> ID：10266533
> 
> 赞同：2
> 
> 时间：2012-04-22T08:49:13.417
> 
> 标签：ruby-on-rails, cucumber

我需要编写一个黄瓜测试来测试日期时间选择行为。

这是我的句子：当我选择“2012-4-30 15:00”作为“start_time”时

这是我的html视图：

```
 = form_tag time_off_requests_path do
      = label :time_off_request, :start_time, 'Start Time'
      = datetime_select :time_off_request, :start_time , :start_year => Time.current.year, :use_short_month => true

      = submit_tag 'Save Changes' 
```

我尝试了类似 When /^I select "([^"] *)" as the "([^"]* )"$/ do |date_time, label| select(date_time, from => label) end 但它不起作用。get 找不到 id，name for "select box" 真的需要帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-22T12:09:25.590

`datetime_select`助手生成一**组**选择，而不是单个表单字段。您应该编写一个自定义步骤来将日期时间（日、月、年、小时...）的每个部分分配给相应的字段。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-03-02T22:22:49.357

这是我为输入从 datetime_select 生成的字段而创建的黄瓜测试的自定义步骤：

```
When /^(?:|I )select datetime "([^ ]*) ([^ ]*) ([^ ]*) - ([^:]*):([^"]*)" as the "([^"]*)"$/ do |year, month, day, hour, minute, field|
  select(year,   :from => "#{field}_1i")
  select(month,  :from => "#{field}_2i")
  select(day,    :from => "#{field}_3i")
  select(hour,   :from => "#{field}_4i")
  select(minute, :from => "#{field}_5i")
end 
```

在您的测试中，您将其称为：

```
When I select datetime "2014 March 2 - 19:00" as the "start_time" 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-04-27T06:53:18.040

你可以使用 select_date 黄瓜助手

```
select_date '2014-01-01', from: 'Start Time' 
```

示例步骤：

```
When(/^I choose "([^"]*)" in "([^"]*)" date select$/) do |value, select_label|
  select_date value, from: select_label
end 
```

[http://www.rubydoc.info/github/cucumber/cucumber-rails/Cucumber/Rails/Capybara/SelectDatesAndTimes](http://www.rubydoc.info/github/cucumber/cucumber-rails/Cucumber/Rails/Capybara/SelectDatesAndTimes)

# eclipse - Eclipse 主题问题

> ID：10266534
> 
> 赞同：2
> 
> 时间：2012-04-22T08:49:42.073
> 
> 标签：eclipse, eclipse-plugin, themes, customization

Eclipse 主题仅适用于编辑器窗口和设置区域，如***项目浏览器、大纲、任务窗口等似乎没有改变。***我已经从 Eclipse 市场下载了主题，但没有效果。这是它假设的工作方式还是我的 Eclipse 在安装时出现了问题。

我已经设法从 Windows -> Presences -> Color and Fonts 手动更改 Java doc 和 Declaration Windows

另外，我尝试按照 Eric 在他的博客中的建议将 pref 文件放在工作区中：-

[http://blog.edwards-research.com/2009/10/color-schemes-for-eclipse-cdt/](http://blog.edwards-research.com/2009/10/color-schemes-for-eclipse-cdt/) 和主题生成器“blog.edwards-research.com/files/eclipse-gen/#”

我现在的 Eclipse 看起来像：- [http://www.flickr.com/photos/deamonm/7101439563/](http://www.flickr.com/photos/deamonm/7101439563/)

我想知道 Aptana studio 是如何设法在 Eclipse 插件中进行更改的

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-29T17:53:58.240

我认为除了编辑器窗口之外，没有办法改变 eclipse 的那些部分。[您可以从Eclipse Theme](http://www.eclipsecolorthemes.org/)下载大量主题。[另请注意，这里](http://marketplace.eclipse.org/content/eclipse-color-theme)有一个插件可用。它预装了许多主题。安装后，转到**窗口->首选项->搜索主题并从各种主题中进行选择。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-11-01T17:50:32.443

您可以使用 Eclipse 的 Aptana 插件来更改几乎所有面板的视图：

1.  点击链接[[Download Aptana Studio]](http://www.aptana.com/products/studio3/download)，选择“Eclipse Plug-in Version”，然后点击下载按钮。您将被重定向到安装页面。遵循该安装指南。
2.  在 Eclipse 菜单中选择 Preferences > Aptana Studio > Themes
3.  选择最适合您的任何主题（这只​​会更改编辑器视图）。
4.  单击下面的 3 个复选框：应用于所有（非 Studio）视图、应用于所有（非 Studio）编辑器、将编辑器字体应用于视图。
5.  单击应用或确定按钮。

瞧！主题在全球范围内应用。

更新。

不幸的是，此解决方案不适用于所有面板。某些 Perspectives 无法通过这些操作进行修改。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-05-19T06:20:14.907

[http://marketplace.eclipse.org/content/eclipse-moonrise-ui-theme](http://marketplace.eclipse.org/content/eclipse-moonrise-ui-theme) 转到此链接并仔细按照说明操作！*****安装插件；重新启动 Eclipse 并转到**Window > Preferences > General > Appearance**；选择 MoonRise（独立），或者，为了更好的标签装饰，从市场或从这里安装 Eclipse 4 Chrome 主题并选择 MoonRise；***** 这必须更改您的项目浏览器、大纲、任务窗口等。干杯！

# mysql - 加载数据不可用；fgetcsv 超时；备择方案？

> ID：10266540
> 
> 赞同：1
> 
> 时间：2012-04-22T08:50:53.437
> 
> 标签：mysql, csv, timeout, load, fgetcsv

我有一个网站，每周上传一次赛马数据的 CSV。CSV 包含目前在英国注册的约 19,000 匹赛马的详细信息，平均大小约为 1.3MB。我有一个脚本来处理该 csv 并且如果它存在并且评级数据已更改，则更新马，或者如果它不存在则添加它。如果一匹马没有变化，它会跳到下一匹马。该脚本有效，因为它在我用作测试的主机上运行。运行需要 5 或 6 分钟（我知道不太理想），但它奏效了。

但是，我们现在正在客户端主机的暂存版本上进行测试，它运行了 15 分钟，然后返回 504 超时。我们已经尽可能地调整了 htaccess 和 php.ini 设置……不高兴。

主机处于共享环境中，所以他们告诉我 MySQL 的 LOAD DATA 对我们不可用。

您会尝试哪些其他替代方法？或者，例如，有没有办法将 CSV 拆分成块并依次在每个块上运行一个进程？

# javascript - JavaScript：错误“对象不支持此操作”

> ID：10266543
> 
> 赞同：-2
> 
> 时间：2012-04-22T08:51:50.973
> 
> 标签：javascript, html

[计数器的代码](http://jsfiddle.net/w2JqT/)给出了错误

而[类似的片段](http://jsfiddle.net/W9L39/)没有

我想不出任何正当的理由...

正在考虑的线路是：

```
<input type=button name="but2" value="stop" onClick="window.clearTimeout(ID);"> 
```

完整的代码是：

```
<html>
        <head>
        <script language="JavaScript">
            var counter=0;
            ID=window.setTimeout("start();",2000);
            function start()
            {
                counter++;
                document.forms[0].elements[0].value=counter;
                ID=window.setTimeout("start();",2000);
            }
        </script>
        </head>
        <body>
            <form name="frm1">
                <input type="text" name="timer1">
                <input type="button" name="but1" value="start" onClick="counter=0; start();">
                <input type=button name="but2" value="stop" onClick="window.clearTimeout(ID);">
            </form>
        </body>
</html> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-22T11:33:20.717

关于该代码的所有内容都是错误的。以后请尽量避免使用该教程来源。

这是一个工作脚本：http: [//jsfiddle.net/teresko/qTJPx/](http://jsfiddle.net/teresko/qTJPx/)

**您的脚本**问题列表：

*   缺少文档类型
*   `language="JavaScript"`已弃用
*   变量`ID`并`counter`最终在全局范围内
*   使用 html 附加事件
*   不正确的使用`setTimeout`
*   `<script>``<head>`DOM 尚未准备好时使用的标记

..而且我什至不想重复那个“类似的片段”，它看起来像是完全应该被埋葬的东西。

添加 JavaScript 代码时，它应该在关闭之前`</body>`标记之前，因为在那个阶段 DOM 已经准备好，但页面还没有开始渲染。

我强烈建议您获取一些更新的学习 JavaScript 的材料。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-22T10:29:44.653

使用`window.start`而不是开始`onClick`事件。当您使用代码而不是处理程序的函数时，IE 可能不会创建窗口上下文。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-02-03T08:00:51.413

嗨，我认为在这一行中你得到了错误

```
ID=window.setTimeout("start();",2000); 
```

正确的 ？

把这段代码

```
var  ID=window.setTimeout("start();",2000); 
```

你不会得到这个 JavaScript: Error`Object doesn't support this action`错误。

# jquery - 如何使用 jQuery 找到父母？

> ID：10266544
> 
> 赞同：0
> 
> 时间：2012-04-22T08:51:56.007
> 
> 标签：jquery

> **可能重复：**
> [jQuery：查找所有父级到特定父级](https://stackoverflow.com/questions/2112822/jquery-find-all-the-parents-up-to-a-specific-parent)

我有以下内容：

```
<div class="modal-window block-border">
    <ul class="action-tabs right">
        <li><a title="Close window" href="#"><img width="16" height="16" src="images/icons/fugue/cross-circle.png"></a></li>
    </ul>
    <div class="block-content no-title">
        <div style="min-width: 200px; min-height: 40px; width: 300px; height: 221px;" class="modal-content modal-scroll">
            <h1>Admin</h1>
            <div class="block-header">
                Please login
            </div>
            <form novalidate="novalidate" action="/MyAccount/Access/JsonLogin" data-ajax="true" data-ajax-method="POST" data-ajax-mode="replace" data-ajax-success="dialogSuccess()" data-ajax-update="#update-message" name="login-form" id="login-form" method="post"> 
```

我参考了 $(this) 的形式。鉴于此参考，我如何找到对具有最高 div 的类的参考，称为“modal-window”？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-22T08:57:18.480

因为您可能不确定目标元素与当前元素的确切距离，并且假设您只想找到*一个*目标元素：

```
$(this).closest('.modal-window'); 
```

*   [`parent()`](http://api.jquery.com/parent/)选择 的直接父元素`$(this)`，返回一个 jQuery 对象，或者没有。
*   [`parents()`](http://api.jquery.com/parents/)选择*所有*匹配的祖先元素`$(this)`，返回一个、无或多个的 jQuery 对象。
*   [`closest()`](http://api.jquery.com/closest/)在 DOM '树' 中选择与选择器匹配的第一个元素，*返回*`$(this)`一个 jQuery 对象，或无。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-22T08:54:23.833

您可以使用该`.parents()`函数，并将选择器传递给它以获取匹配它的父母，这意味着如果指定的选择器被父母多次使用，它将返回所有匹配的父母。

```
$(this).parents('.modal-window'); 
```

[http://api.jquery.com/parents/](http://api.jquery.com/parents/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-22T08:56:59.343

```
$(this).parents('.modal-window'); 
```

它是父母而不是父母，因为您想要祖先而不是直接父母。

请参阅[http://api.jquery.com/parent/](http://api.jquery.com/parent/)和[http://api.jquery.com/parents/](http://api.jquery.com/parents/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-22T08:59:18.003

使用`.parent()`来自[jquery api](http://api.jquery.com/parent/)的函数。

# iphone - 由于未捕获的异常而终止应用程序，无法初始化类对象

> ID：10266548
> 
> 赞同：0
> 
> 时间：2012-04-22T08:52:54.620
> 
> 标签：iphone, ios, nsstring

我使用 SOAP 从网站获取时间，当执行以下源代码时，它会引发问题。我猜下面源代码的第 4 行有问题，但我不知道如何解决，请帮助。谢谢。

源代码：

```
-(void) parse:(NSXMLParser *)parser didEndElement:(NSString *) elementName namespaceURI:(NSString *)namespceURI qualifiedName:(NSString *)qName {
 if ([elementname isEqualToString:@"getOffesetUTCTimeResult"])
{
    greeting.text = [[[NSString init] strinWithFormat:@"The local time is:", nameInput.text] stringByAppending:soapResults];
    [soapResults release];
    soapResults = nil;
}
} 
```

引发错误： `*** Termination app due to uncaught exception 'NSInvalidArgumentException', reason: '** +[NSString <0x267fd8> init]: cnnot init a class object.' *** First throw call stack: ... terminate called throwing an exception`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-22T08:57:25.370

`alloc`如果没有对象的内存，就不能调用初始化程序。对于`NSString`，您可以执行以下操作：

```
greeting.text = [[NSString stringWithFormat:@"The local time is:", nameInput.text] stringByAppending:soapResults]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-22T08:56:44.913

您不必初始化`NSString`。

只需使用 

```
greeting.text = [[NSString strinWithFormat:@"The local time is:", nameInput.text] stringByAppending:soapResults]; 
```

# mysql - MySQL 是否支持 STORAGE 语法？

> ID：10266552
> 
> 赞同：2
> 
> 时间：2012-04-22T08:53:34.710
> 
> 标签：mysql, sql, database, storage

我有一个像这样的查询

```
CREATE TABLE EMPLOYEE_TBL
(EMP_ID        CHAR(9)         NOT NULL,
EMP_NAME       VARCHAR(40)     NOT NULL,
EMP_ST_ADDR    VARCHAR(20)     NOT NULL,
EMP_CITY       VARCHAR(15)     NOT NULL,
EMP_ST         CHAR(2)         NOT NULL,
EMP_ZIP        INTEGER(5)       NOT NULL,
EMP_PHONE      INTEGER(10)      NULL,
EMP_PAGER      INTEGER(10)      NULL)
STORAGE
    (INITIAL     20M
     NEXT        1M ); 
```

所以，我认为 STORAGE 正在创建某种无效的语法。我无法修复它。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-22T09:09:17.810

不，不是的。这是`Oracle`语法。

您可以将其替换为`Engine=InnoDB`or `Engine=MyISAM`（这是您可以控制单个表的最大存储选项）。

`MyISAM`not 根本不支持范围的概念（它是面向文件的），并且`InnoDB`您只能在服务器范围内控制自动扩展选项。

# mechanicalturk - Mturk 的参与者人数？

> ID：10266553
> 
> 赞同：0
> 
> 时间：2012-04-22T08:53:34.900
> 
> 标签：mechanicalturk

我绝对是 Mturk 的新手，而且我绝对不是一个懂编程的人。因此，对于我应该按哪个按钮和按哪里（这是我的计算机技能的上限）的问题，我将不胜感激。

问题如下：我要200人参与我的调查。我希望 1 pseron 只回答我的调查 1 次。我应该在哪里设置这些要求？我应该把数字 200 放在这里：每个 HIT 的作业数量，还是会有其他空间来指定我的参与者数量？

非常感谢提前！！！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-03T05:12:17.960

我认为您正在寻找 CreateHIT 操作的**MaxAssignments**选项。这是开发人员指南的附件图片 ![在此处输入图像描述](../Images/1e0502dfde44e04f77899112640ebd42.png)

它说每个工人只能完成一次 HIT，因此可以保证多个作业由多个工人完成。

希望这可以帮助

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-10-25T20:05:25.530

我已经看到工人不止一次地尝试完成我的 HIT，即使没有打算再次看到 HIT。以下是一些防止这种形式发生的解决方法。

1.  重新发布相同的 HIT。如果以不同的名称发布，工人可以访问相同的 HIT。
2.  您可以为已参加调查的每位工作人员添加资格。即使没有编程，这也相当简单。您可以下载您的工人列表，在电子表格中为所有工人添加资格，然后将电子表格上传到 MTurk。设置 HIT 时，您可以添加此资格。在这种情况下，您将添加：（您的资格名称）尚未授予。

祝你好运。

# intellij-idea - 验证每个公共类是否有 javadoc 注释的工具

> ID：10266554
> 
> 赞同：3
> 
> 时间：2012-04-22T08:53:40.910
> 
> 标签：intellij-idea, javadoc

请提出一些工具来验证每个公共类和成员是否有 javadoc 注释。我正在使用 IDEA 来编辑源代码，但还没有找到使 javadoc 必不可少的选项。

非常感谢你。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-22T09:10:54.673

IntelliJ IDEA 可以为您检查。您必须启用 Javadoc 检查。您可以设置各种参数。就像只检查公共类、成员和方法一样。

![在此处输入图像描述](../Images/4e63f545adc1ea5b6cacb4210fe5a66a.png)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-22T08:57:34.667

诸如[checkstyle](http://checkstyle.sourceforge.net/)之类的工具正是这样做的，在许多其他检查中。您可以使用它为您的代码库生成包含许多不同检查的完整报告。

通常将它与基于字节码的分析工具（例如[PMD](http://pmd.sourceforge.net/)或[findbugs](http://findbugs.sourceforge.net/)）一起使用，这些工​​具用于检测一些编码错误，例如死代码、错误的空值检查等等。

# mysql - 具有只读权限时克隆 MySQL 数据库

> ID：10266555
> 
> 赞同：1
> 
> 时间：2012-04-22T08:53:46.760
> 
> 标签：mysql, database, clone

我有`database1`（~500MB），可以通过只读模式访问`user1`。
我有空数据库`database2`，具有完全权限`user2`。

现在，我想克隆`database1`到`database2`.

我试过`mysqldump`了，但它说`access denied`。

有更好的办法吗？谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-22T10:08:31.033

默认情况下，mysqldump 在转储它们之前尝试锁定所有表 - 以便创建一致的快照。我认为那`user1`没有特权这样做。

您可以使用其中一个`--single-transaction`或`--skip-lock-tables`在命令行上使用。第一个选项对整个操作使用单个事务。如果所有表都是事务性的并且数据库很小，这将非常有效。如果数据库很大，这可能会对其他应用程序产生严重影响。

如果有疑问，请先尝试`--skip-lock-tables`。但是，如果其他应用程序在转储期间进行更改，则转储可能会不一致。

克隆数据库的完整示例：

```
mysqldump -h host1 -u user1 -ppass1 --single-transaction database1 |
mysql -h host2 -u user2 -ppass2 database2 
```

# php - PHP图像追踪功能

> ID：10266556
> 
> 赞同：1
> 
> 时间：2012-04-22T08:53:49.067
> 
> 标签：php, image

> **可能重复：**
> [将 JPG（位图）转换为 SVG（矢量）的源代码？](https://stackoverflow.com/questions/9575001/sourcecode-to-convert-jpg-bitmap-to-svg-vector)

是否存在可以执行[图像跟踪](http://en.wikipedia.org/wiki/Vectorization_%28image_tracing%29)功能的现有 php 库？如果没有，这将如何实现？是否有可以轻松移植到 php 的现有库？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-22T09:12:32.743

刚找到[这个](http://www.wikihow.com/Trace-an-Image-Using-Inkscape)，这是一个在 Inkscape 中跟踪位图的教程。您可能必须深入研究程序的内部结构才能在 PHP 中进行接口，但也许这可能会让您入门？

编辑：这在内部使用 Potrace，我怀疑它在命令行上工作。图像输入，SVG/PDF 输出 - 在 PHP 中轻松接口。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-22T09:15:39.697

您可以使用[OpenCV 的](http://opencv.willowgarage.com/) [特征检测](http://opencv.willowgarage.com/documentation/python/imgproc_feature_detection.html)功能来检测和跟踪边缘。OpenCV 非常擅长这类图像处理，并被广泛使用和开发。

还有一个与 OpenCV 交互的[PHP 库。](https://github.com/mgdm/OpenCV-for-PHP)

# c# - BlankPage 构造函数无法初始化组件

> ID：10266558
> 
> 赞同：13
> 
> 时间：2012-04-22T08:53:57.147
> 
> 标签：c#, xaml, windows-8, microsoft-metro

我开始[学习 XAML](http://msdn.microsoft.com/en-us/library/windows/apps/br211380.aspx)，并在我的 BlankPage 应用程序中添加了一些代码。突然一个正在初始化组件的构造函数：

```
 public BlankPage()
    {
        this.InitializeComponent();
    } 
```

停止工作。我现在有这个错误：

> “BlankApplication.BlankPage”不包含“InitializeComponent”的定义，并且找不到接受“BlankApplication.BlankPage”类型的第一个参数的扩展方法“InitializeComponent”（您是否缺少 using 指令或程序集引用？）

老实说我什么都没做，我什至没有看这部分代码，现在它不起作用。

截屏：

[![](../Images/51ccc859d123d9c2dc7f1ab97d479193.png)](https://i.stack.imgur.com/yqw1H.png)

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-01-03T21:18:13.563

只是为了提供更多关于如何解决这个问题的信息（因为这个解释有点含糊）..

这个问题（对我来说）是因为我在创建项目后更改了代码中的命名空间。为了解决这个问题，我不得不在几个位置进行一些更改：

1：在 App.xaml 中，我必须更改以下内容：

```
<Application
  x:Class="New.Namespace.App" 
```

2：在 MainPage.xaml 我必须更改以下内容：

```
<Page
  x:Class="New.Namespace.MainPage" 
```

您还需要确保更改 App.xaml.cs 以及 MainPage.xaml.cs 中的“命名空间”行。

最后，您还需要确保将 Package.appxmanifest 中的项目入口点更新为指向“New.Namespace.App”。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2018-08-08T12:56:34.193

如果您的 Main 类的**命名空间**与 .xaml 文件的**x:Class**属性不同，您将收到此错误。例如;

您的 MainPage.xaml.cs；

```
 namespace UWPControls
    {
        /// <summary>
        /// An empty page that can be used on its own or navigated to within a Frame.
        /// </summary>
        public sealed partial class MainPage : Page
        {
            public MainPage()
            {
                this.InitializeComponent();
            }
        }
    } 
```

您的 MainPage.xaml；

```
<Page
    x:Class="UWPControls_Different.MainPage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:local="using:UWPHelloWorld"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    mc:Ignorable="d">
</page> 
```

**在将x:class**更改为;之前，您将看到错误。

> x:Class="UWPControls.MainPage"

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2016-10-13T11:08:42.207

当您更改类的命名空间时会发生这种情况，您必须在 XAML 文件中执行相同操作。

XAML 文件中有两个位置具有旧的命名空间。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2019-04-29T14:38:10.557

对我来说，该项目是其他项目的内部解决方案。当此处的建议不起作用时，**从解决方案中简单地卸载和重新加载项目**就可以解决所有错误（当然是重建）。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2017-09-22T17:45:21.327

我的解决方案：对于我的“SomePage：ContentPage”，我更改了 XAML 属性：

*   生成器（自定义工具）：从`MSBuild:Compile`到`MSBuild:UpdateDesignTimeXaml`
*   BuildAction：从`Page`到`Embedded resource`

使用 Visual Studio 2017 企业版 15.3.4

* * *

## 回答 #6

> 赞同：-3
> 
> 时间：2012-04-23T13:58:04.173

问题解决了。原因：我忘记在 xaml 代码中更改自定义应用程序名称。解决方案：我在 XAML 中更改了应用程序名称，现在它运行良好。

# c - 在 C 中执行 OOP 时模拟“this”指针的优雅方式？

> ID：10266559
> 
> 赞同：1
> 
> 时间：2012-04-22T08:53:59.377
> 
> 标签：c, oop, polymorphism

我想在 C 中使用多态性进行一些面向对象风格的编程，其中我的接口类包含一个指向函数表的指针。示例如下：

```
/* Implement polymorphism in C, Linux kernel-style */
struct statement {
    const struct statement_ops *ops;
    struct list_head list;      /* when on master input list */
    void *private;          /* pointer to type-specific data */
};

struct statement_ops {
    int (*analyse)(void *private, int pc);
    int (*get_binary_size)(void *private);
};

void user(void)
{
    struct statement *s = make_a_statement();
    if (s->ops->analyse(s->private, foo))
        blah blah;
} 
```

我希望能够在不明确地将 s->private 传递给每个“方法”的情况下编写一些东西。有任何想法吗？也许一些宏观技巧？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-22T09:04:28.973

如果这是公共接口的一部分，您可以添加访问器函数。一个隐藏的好处是您可以在访问器中进行完整性检查和其他工作。（注意我将“this”指针称为“o”，就像在“object”中一样。为了保持一致性，我更喜欢这种方式。）

```
int statement_analyse (struct statement *o, int pc)
{
    assert(pc >= 0);

    int ret = o->ops->analyse(o->private, pc);
    assert(ret >= 0);

    return ret;
} 
```

您现在可以在没有显式传递“private”的情况下调用它。

```
void user(void)
{
    struct statement *s = make_a_statement();

    if (statement_analyse(s, foo))
        blah blah;
} 
```

虽然这似乎没有任何好处，因为您仍然必须实现访问器，假设您想要一个定义良好且健壮的接口，访问器函数是放置断言和接口文档的唯一明智的地方。事实上，如果你编写好的断言，断言本身有助于记录接口。一旦你在访问器中添加了完整性检查，你就不必在它们调用的实际方法中添加它们。

当然，这种方法只有在通过函数指针调用的函数是用户提供的东西时才有意义，或者以其他方式可以是不同的东西。如果有一个`analyse()`方法总是做同样的事情，你可以简单地实现一个`statement_analyse()`直接做它需要做的事情。

小提示：在进行 OOP 时，我更喜欢对结构进行 typedef 并给它们命名为 CamelCase 名称。我使用这个约定来说明结构是不透明的，并且只能通过其公共接口访问。它看起来也更好，尽管这是主观的。我也更喜欢让用户为结构本身分配内存，而不是构造函数分配它。这避免了必须处理 malloc 失败，并使程序更有效率。

```
typedef struct {
    ...
} Statement;

void Statement_Init (Statement *o);
int Statement_Analyse (Statement *o, int pc); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-22T08:59:53.860

不幸的是，编写方法以允许传递 a`self`或`this`对象是在 C 中实现此目的的唯一方法。

您可以使用宏技巧来隐藏它的一部分，但此时它不再是真正的 C。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-22T09:42:23.710

正如其他答案所说，如果不使用适当的指针调用函数，就无法做到这一点，但是（正如 Williham Totland 建议的那样）您可以使用宏来简化调用（需要具有[可变参数宏](https://en.wikipedia.org/wiki/Variadic_macro)支持的编译器）：

```
// macro_call.c

#define C_ARGS(stmnt, func, ...) (stmnt)->ops->func((stmnt)->private, ...)
#define C_NOARGS(stmnt, func) (stmnt)->ops->func((stmnt)->private)

C_ARGS(s, analyse, 1);

C_ARGS(s, lots_of_args, 1, 2, 3, 4);
C_NOARGS(s, no_args); 
```

（`C`用于“呼叫”。）

对其进行预处理（通过`gcc -E macro_call.c`）给出：

```
(s)->ops->analyse((s)->private, 1);

(s)->ops->lots_of_args((s)->private, 1, 2, 3, 4);
(s)->ops->no_args((s)->private); 
```

这类似于访问器函数版本：宏版本在某些方面稍微灵活一些，但也不太安全，可能会导致细微的错误和错误。

有两个宏，因为不传递额外的参数`C_ARGS`会导致`s->ops->func(s->private, )`，我认为可以解决这个问题，但它很尴尬并且需要更多的代码（`__VA_ARGS__`众所周知，空很难处理）。

# java - 调试无法检查变量

> ID：10266560
> 
> 赞同：3
> 
> 时间：2012-04-22T08:54:15.353
> 
> 标签：java, eclipse, debugging

在eclipse
中调试时，问题是： String.hashCode() line: 1489 [local variables available]
因此，无法检查变量的值 ![ECLIPSE 调试截图](../Images/bf7a6b08b2868a5e38ac86bcb6ffaea6.png)

请通过提供一些指示来帮助我

**嗨 Tomasz Nurkiewicz** 感谢您的努力，在了解了这些[如何在 ECLIPSE 中调试 .class 文件之后，我采用了一个新的 jdk（包含所有类详细信息）？](https://stackoverflow.com/questions/5288370/how-to-debug-class-files-in-eclipse)和[http://jdk6.java.net/download.html](http://jdk6.java.net/download.html)但也面临同样的问题...... ![更改后的eclipse调试图像](../Images/d113fac583ae4d9ce49bb95a58aed0f1.png)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-22T09:16:42.470

JDK 类没有使用调试信息进行编译，因此在调试期间您看不到局部变量。您必须重新构建 JDK 或使用开发版本，请参阅：[在 IntelliJ IDEA 中逐步执行 JDK 源代码](https://stackoverflow.com/questions/1313922)和[在 JRE 类中启用调试](http://www.javalobby.org/java/forums/t103334.html)。

# mongodb - 如何编码或直接使用版本控制系统，例如带有 Mongodb 的 Subversion？

> ID：10266563
> 
> 赞同：2
> 
> 时间：2012-04-22T08:54:47.947
> 
> 标签：mongodb, svn, version-control, nosql

我正在设置一个带有几个多个编辑器的简单在线 cms/编辑系统，并且想要一个简单的审计跟踪，其中包含少量文本的差异、历史记录、比较和回滚功能。

我们的编辑已经习惯了使用 XML / Svn 的好处，我真的很想在我的系统中创建一个简单的版本。

我意识到我可能可以使用这样的链接 id 创建自己的版本/历史数据库，但我想知道[这](https://stackoverflow.com/questions/4185105/ways-to-implement-data-versioning-in-mongodb)是否是最好的方法，或者是否有等效于 Svn api 样式的接口可用？

顺便说一句，我对 Mongodb 完全陌生，所以请放轻松:-)

干杯

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-22T16:34:56.927

放置创建数据库的数据不是一个好主意，因为它仅包含二进制数据。此外，这在开始时是相当大的，因为 MongoDB 为其分配了一些磁盘空间。因此，将数据文件夹置于版本控制之下没有任何好处。

如果要跟踪更改，可以将数据导出为其序列化形式并将其存储在 VCS 中。如果这越来越大，VCS 的优势也可能会下降，因为它会变得非常慢。

我假设您需要从数据中跟踪更改，但是由于您处理的是二进制数据，所以您不走运。

# ruby - ":w ! ruby " vim 命令无法使用 "require_relative" 运行 ruby 脚本

> ID：10266564
> 
> 赞同：2
> 
> 时间：2012-04-22T08:54:54.053
> 
> 标签：ruby, vim

这是我的红宝石脚本：

```
require_relative 'lib/say.rb' 
say("hello") 
```

我通过 macvim 运行它`:w ! ruby`并得到：

```
:w ! ruby
-:1:in `require_relative': cannot infer basepath (LoadError)
    from -:1:in `<main>'

shell returned 1 
```

虽然`! ruby %`vim 命令工作正常。并且也改变`require_relative...`to`require File.expand_path('../lib/say', __FILE__)`也有帮助......

但是......这些朋友实际上有什么问题：`require_relative`+ `:w ! ruby`？

为什么我需要这个？只是为了在 vim 中使用`⌘</kbd> + `R` shortkey from the vim-ruby-runner plugin which is based on `:w !ruby` vim command and have my code looks better with `require_relative`...`

PS我在SO上发现了以下问题：[为什么我的Ruby路径上没有当前目录？](https://stackoverflow.com/questions/4965556/why-isnt-current-directory-on-my-ruby-path) 似乎后一个来源也对应于我的问题......但我很难从那里得到我需要的所有答案。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-23T11:19:17.327

vim-ruby-runner 插件的所有者在[http://www.rodrigoalvesvieira.com/add-require-relative-to-irb/找到了解决方案](http://www.rodrigoalvesvieira.com/add-require-relative-to-irb/)

插件已修复，可在[https://github.com/henrik/vim-ruby-runner获取](https://github.com/henrik/vim-ruby-runner)

解决方案（并修复 vim-ruby-runner）也可以在[https://github.com/henrik/vim-ruby-runner/issues/5找到](https://github.com/henrik/vim-ruby-runner/issues/5)

# javascript - 无法在 IE 的特定行上设置断点

> ID：10266568
> 
> 赞同：1
> 
> 时间：2012-04-22T08:55:36.010
> 
> 标签：javascript, tinymce

我正在试验 TinyMCE 编辑器，以便在单击超链接时设置其内容。为此，我使用了他们自己的演示页面并尝试添加他们的链接。但是点击链接并没有设置编辑器的内容。所以我继续在IE9中调试它。我尝试在该行上放置断点，但很惊讶——我能够在除该行之外的任何地方切换断点。快照在这里：[http](http://s15.postimage.org/a7ntjabfv/Tiny_MCE_Debug.png) ://s15.postimage.org/a7ntjabfv/Tiny_MCE_Debug.png 为什么会这样？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-23T17:06:40.377

实际上，既然你提到了它......我想出了发生了什么。您尝试设置断点的行看起来像无效的 html，因此 IE 行为正确。

在您的示例中，html 属性（如`onclick`您所拥有的）由双引号 ( `"`) 分隔。但是您还有另一个由`"`属性内部分隔的字符串，这会导致语法错误。要解决这个问题，您必须用单引号分隔字符串：`'`. 所以你找到的解决方案是正确的。

# android - 数百个按钮的替代品

> ID：10266573
> 
> 赞同：0
> 
> 时间：2012-04-22T08:56:27.163
> 
> 标签：android, button

我打算写一些安卓应用程序，它基本上由两个活动组成。所以首先应该有很多按钮（100+），点击其中任何一个我都会得到一些特殊的 id 并转到第二个活动。但是有没有其他方法可以声明数百个按钮并将一段代码复制/粘贴到每个按钮设置几乎相同的onClickLister？有什么特殊的构造吗？谢谢

编辑：每个按钮实际上都是从 1 到 n 索引的。并在单击时启动第二个活动并获取该索引以显示它。我基本上不能使用任何微调器或其他东西，因为会有 3 行可点击的东西，每行都带有不同的图像

编辑2：所以，为了给你一个想法，当你实际选择你想要玩的关卡时，我会做一些按钮表，比如愤怒的小鸟菜单。因此，单击时您将获得按钮的 id 并开始第二个活动

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-22T09:13:11.487

您应该使用`ListView`.

ListViews 非常适合同时处理大量项目。它们对用户来说也是很自然的。此外，您仅使用一键式侦听器 - `OnItemClickListener`.

[在Android Reference](http://developer.android.com/resources/tutorials/views/hello-listview.html)中有一个关于如何使用 ListViews 的有用示例。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-22T09:14:30.600

调用方法添加按钮

```
private void addButton(){       
    LinearLayout view = (LinearLayout) findViewById(R.id.linear_layout_id_here);            
     Button btn  = null;
     int w = 50;
     int h = 25;
    for(int i=1; i<100; i++) {
        btn = new Button(this);
        btn.setLayoutParams(new LayoutParams(w,h));
        btn.setText("button " +i);
        btn.setTag(""+i);
        btn.setOnClickListener(onClickBtn);  
        view.addView(btn);
        btn = null;
    }           
} 
```

调用此方法处理 onclick on button

```
 private View.OnClickListener onClickBtn = new View.OnClickListener() {
    public void onClick(View view) {
        final int tag = Integer.parseInt(view.getTag().toString());
        switch (tag) {
        case 1:
            // Do stuff
            break;
        case 2:
            // Do stuff
            break;

        default:
            break;
        }
    }
}; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-22T09:17:10.583

您可以在代码中添加按钮，如下所示：

```
@Override
public void onCreate(Bundle savedInstanceState) {
    /*your code here*/

    GroupView gw =findViewById(R.id.pnlButtonscontainer);  //find the panel to add the buttons

    for(int i=0; i<100; i++) {
        Button b = new Button(this);
        b.setLayoutParameters(new LayoutParameters(w,h));
        b.settext = i+"";
        b.setOnClickListener(new OnClickListener(){
        });
    }
} 
```

我直接在浏览器中编码，所以我的代码中可能会出现一些语法错误，但这是添加 100 个按钮的重点，不是唯一的方法。

# javascript - CakePHP - 从视图中调用组件的函数并在单击按钮时执行它

> ID：10266574
> 
> 赞同：0
> 
> 时间：2012-04-22T08:56:33.740
> 
> 标签：javascript, cakephp

如何从视图中调用组件中的函数？（ctp文件）

我正在使用这样的东西：

```
App::import('Component', 'YourComponent');
$theComponent = new YourComponent();
$theComponent->yourMethod(); 
```

我希望在`$theComponent->yourMethod();`单击按钮时执行该行，而是在页面加载时执行...

这是代码的一部分：

```
<script type="text/javascript">
function assign()
{
    var links_list = [];
                var links =document.getElementById('unassignedUsers').getElementsByTagName('a');
                for(var a in links) {
                    if(typeof links[a] == undefined) continue;
                    links_list.push(links[a].innerHTML);} var str =links_list.toString();
                    var array = str.split(',');
                    alert(array);
                 }
   <?php App::import('Model', 'Account');
    $account = new Account();  
   $account->insertPos();?> 
} 

<button id="button" name="button" onClick="assign();"> Save Changes </button>  
//this is the button i need the function to be executed when i click.... 
```

请告诉我该怎么做才能使javascript中的php代码仅在单击按钮时才执行？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-22T09:17:41.753

```
echo $form->create('Account', array('action' => 'insertPos'));
echo $form->button('Save Changes', array('type' => 'submit'));
echo $form->end(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-22T11:09:21.157

cakephp 和互联网都适用于特定的架构。有了 Cakephp，就更容易“打破”架构并创建变通方案，这在 Internet 上非常困难。互联网使用客户端-服务器架构，其中 HTML、Javascript 和 CSS 在客户端运行，也称为浏览器，而 php（以及其他语言）在服务器端运行。服务器仅在加载 HTTPRequests（最简单的是 AJAX）后与客户端交互。只有 HTTPRequest 会触发服务器端运行，并且总是通过 URL 完成。因此，以下是您应该遵循的粗略模型。

客户端 <---- HTTPRequest ----> 服务器端

鉴于此并使用 Cakephp，为了遵循最佳实践并从 Cakephp 获得最大收益，您的保存请求应发送到具有以下 URL 的控制器：
`www.yoursite.com/controller-name/save`

从这里开始，假设所有值都在表单元素中，您的控制器将只会收到表单元素中的值。然后在控制器内应该发生以下情况
`$this->Account->insertPos();`

最好的建议，如果你想让你的网站动态。熟悉 AJAX。

# jquery - 双触发事件

> ID：10266578
> 
> 赞同：0
> 
> 时间：2012-04-22T08:56:47.960
> 
> 标签：jquery, events

我有一个投资组合项目清单。当我单击特定时，其相关的 div 会滑下，您可以通过单击关闭链接来关闭 (slideUp)。工作正常，但是当点击其他项目时，事件会双重触发，所以它会上下滑动两次，因为类名关系？我正在使用 index() 来获取元素，因此将 div ID 设置为 0、1、2、3、4、5、6...。

有人可以解释一个好的解决方法或更好的解决方案吗？

```
HTML Markup example:

<div style="display:none;" id="0" class="sliderwrapper">
   <div class="close"> <a href="#" title="Close"> Close </a></div>
   //SINGLE PORTFOLIO ITEM CONTENT
</div>

<div style="display:none;" id="1" class="sliderwrapper">
   <div class="close"> <a href="#" title="Close"> Close </a></div>
   //SINGLE PORTFOLIO ITEM CONTENT
</div>

<div style="display:none;" id="2" class="sliderwrapper">
   <div class="close"> <a href="#" title="Close"> Close </a></div>
   //SINGLE PORTFOLIO ITEM CONTENT
</div>

JS:

(function(){

    $('.close').on('click', function(){
      $('.sliderwrapper').slideUp(800);
    });

    $('.singleitems ul li').on('click', function(){
      var index = $(this).index();
      $('.sliderwrapper').slideUp(800, function(){

          $('#' + index).slideDown(800);
      });

    });

})(); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-22T09:20:07.417

如果您只是将 slideDown 更改为回调函数，它只会被调用一次。

此代码可防止动画重叠：

```
$(document).ready(function() {
    var selected = false;
    $('.close').on('click', function() {
        $(this).parent('.sliderwrapper').slideUp(800);
        selected = false;
    });

    $('.singleitems ul li').live('click', function() {
        var index = $(this).index();

        if(!selected) {
            $("#" + index).slideDown(800);
            selected = true;
        } else {
            $(".sliderwrapper").filter(":visible").slideUp(800, function() {
                $("#" + index).filter(":hidden").slideDown(800);
            });
        }
    });
});​
​ 
```

# actionscript-3 - 将照片添加到主页相册

> ID：10266579
> 
> 赞同：0
> 
> 时间：2012-04-22T08:56:50.970
> 
> 标签：actionscript-3, facebook-graph-api

我有一个名为“Foo”的页面。我有一个应用程序。我可以将照片发布到用户个人资料上的应用相册，效果很好。但我正在尝试将照片上传到“Foo”页面相册，但它不起作用。

我的 as3 代码：

```
values = {
  message:facebookMessage, 
  fileName:'Foo' + now.toDateString(), 
  image:bitmap_data
  };
Facebook.api('/333446003374785/photos', handleUploadComplete,
  values, 'POST'); 
```

任何想法 ？

# ios - Objective -c：如何避免两个球之间的碰撞？

> ID：10266583
> 
> 赞同：0
> 
> 时间：2012-04-22T08:57:23.027
> 
> 标签：ios

我是新来的，我应该用两个球编写一个游戏，第一个由用户控制，第二个应该编程。我不知道如何确保第二个球阻止用户的球？我是一个中间人。你能帮助我吗。我有一个代码要更改：`CGRect tableRect = self.view.bounds; CGRectenemyRect = self.enemy.frame;

```
if (CGRectGetMinX(enemyRect)<CGRectGetMinX(tableRect) ||
    CGRectGetMaxX(enemyRect)>CGRectGetMaxX(tableRect)) {
    playerValue++;
    playerlabel.text = [NSString stringWithFormat: @"%d", playerValue];
    enemylabel.text = [NSString stringWithFormat: @"%d", enemyValue];
    moveX = -moveX;

}
if (CGRectGetMinY(enemyRect)<CGRectGetMinY(tableRect) ||
    CGRectGetMaxY(enemyRect)>CGRectGetMaxY(tableRect)) {
    playerValue++;
    playerlabel.text = [NSString stringWithFormat: @"%d", playerValue];
    enemylabel.text = [NSString stringWithFormat: @"%d", enemyValue];
    moveY = -moveY;
}
CGPoint center = enemy.center;
center.x += moveX;
center.y += moveY;
enemy.center = center;
[self performSelector:@selector(move) withObject:nil afterDelay:timerIntervale];

if (CGRectIntersectsRect(enemyRect, player.frame)) {
    CGRect frame = [player frame];
    frame.origin.x = 137.0f;
    frame.origin.y = 326.0;
    [player setFrame:frame];

    CGRect frame2 = [enemy frame];
    frame2.origin.x = 137.0f;
    frame2.origin.y = 20.0;
    [enemy setFrame:frame2];
    enemyValue++;
    playerlabel.text = [NSString stringWithFormat: @"%d", playerValue];
    enemylabel.text = [NSString stringWithFormat: @"%d", enemyValue];

}` 
```

我想知道我是否更改代码或添加行。非常感谢你帮助我。

添加游戏

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-22T09:18:21.913

```
enemy.userInteractionEnabled = NO; 
```

# android - 无法安装 Android 软件包：由于连接而无法获取

> ID：10266584
> 
> 赞同：1
> 
> 时间：2012-04-22T08:57:23.057
> 
> 标签：android

我在安装 Android 软件包时遇到问题。我最初安装它没有问题。但决定切换路径并将其安装在其他位置。

现在我得到错误：

获取 URL：[https](https://dl-ssl.google.com/android/repository/repository-6.xml) ://dl-ssl.google.com/android/repository/repository-6.xml 获取 URL 失败[https://dl-ssl.google.com/android/repository/repository-6.xml](https://dl-ssl.google.com/android/repository/repository-6.xml)，原因：连接到[http://127.0.0.1:8520](http://127.0.0.1:8520)拒绝完成加载包。

在 Windows 7 Ultimate 中运行时，将 android-sdk_r18-windows 安装到 C:\Android 我尝试了 https 和 http。两者都不起作用。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-23T05:33:28.033

我删除了代理服务器和端口，然后下载将完成。

# windows-server-2008 - Windows 2008 64 位上的 Microsoft Office 文档成像

> ID：10266587
> 
> 赞同：4
> 
> 时间：2012-04-22T08:57:28.473
> 
> 标签：windows-server-2008, ocr, office-2007, modi

我在 Office 2007 中使用 MODI 在 windows 7 上完成了文档成像，并且成功。但是，当我将带有 MODI 的相同 office 2007 安装到 windows server 2008 上时，它不再适用于我的程序。它引发了“（0xc6c80001）：对象尚未初始化并且无法在MODI.IDocument.OCR中使用”的comexception。我根本没有更改任何代码。有人有什么想法吗？

# c# - 克隆控件 - C# (Winform)

> ID：10266589
> 
> 赞同：12
> 
> 时间：2012-04-22T08:57:39.220
> 
> 标签：c#, winforms

> **可能重复：**
> [是否可以复制某个控件的所有属性？（C# 窗口窗体）](https://stackoverflow.com/questions/3473597/it-is-possible-to-copy-all-the-properties-of-a-certain-control-c-window-forms)

我必须创建一些类似于作为设计时创建的控件的控件。创建的控件应该具有与预定义控件相同的属性，或者换句话说，我想复制一个控件。是否有任何单行代码用于此目的？或者我必须通过一行代码设置每个属性？我现在做的是：

```
 ListContainer_Category3 = new FlowLayoutPanel();
        ListContainer_Category3.Location = ListContainer_Category1.Location;
        ListContainer_Category3.BackColor = ListContainer_Category1.BackColor;
        ListContainer_Category3.Size = ListContainer_Category1.Size;
        ListContainer_Category3.AutoScroll = ListContainer_Category1.AutoScroll; 
```

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2012-04-22T10:47:51.977

一般来说，您可以使用反射将对象的公共属性复制到新实例。

但是，在处理控件时，您需要谨慎。一些属性，如 WindowTarget 仅由框架基础结构使用；所以你需要过滤掉它们。

过滤工作完成后，您可以编写所需的单行代码：

```
Button button2 = button1.Clone(); 
```

这里有一些代码可以帮助您入门：

```
public static class ControlExtensions
{
    public static T Clone<T>(this T controlToClone) 
        where T : Control
    {
        PropertyInfo[] controlProperties = typeof(T).GetProperties(BindingFlags.Public | BindingFlags.Instance);

        T instance = Activator.CreateInstance<T>();

        foreach (PropertyInfo propInfo in controlProperties)
        {
            if (propInfo.CanWrite)
            {
                if(propInfo.Name != "WindowTarget")
                    propInfo.SetValue(instance, propInfo.GetValue(controlToClone, null), null);
            }
        }

        return instance;
    }
} 
```

当然，您仍然需要调整命名、位置等。还可能处理包含的控件。

# java - 在 actionPerformed 和 Event Dispatch Thread (EDT) 问题中创建新线程

> ID：10266592
> 
> 赞同：0
> 
> 时间：2012-04-22T08:57:50.367
> 
> 标签：java, swing, actionlistener, event-dispatch-thread

正如 Sun 所说，来自 ActionListener 的 actionPerformed() 是在 EDT 中自动执行的，所以我决定在 actionPerformed() 方法中创建新线程，问题是这个线程没有在 EDT 中运行。有人可以解释一下吗？谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-22T09:02:52.097

如果您从 EDT 创建一个新线程，则该线程与 EDT 不同。这不是很清楚吗？
您应该通过 EDT 更新控件。
您可以为繁重的任务创建自己的后台线程，但控件的更新只能通过 EDT。您可以使用一些结构来简化您的代码，例如通过[SwingUtilities 调用 Runnable](http://docs.oracle.com/javase/7/docs/api/javax/swing/SwingUtilities.html#invokeAndWait%28java.lang.Runnable%29)`Runnable`传递由 EDT调用的 a 。你应该学习一下[Swing 中的并发性](http://docs.oracle.com/javase/tutorial/uiswing/concurrency/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-22T09:29:35.273

1) AWT 或 Swing GUI 调用并创建 EDT，此事件由（可能还有其他）方法 pack() 和 setVisible(true) 完成

2) 如果在 EDT 中等待的所有事件都已完成且 EDT 为空，则 if (EventQueue.isDispatchThread()) { 返回 false，但 EDT 线程存在直到当前 JVM 实例存在

3）如调用EDT队列所述，您可以使用invokeLater或invokeAndWait，注意invokeAndWait只有在isDispatchThread返回false时才能使用，否则返回异常

4) 通过从 Swing Listener 调用 Thread.sleep(int) 或其方法可以冻结和锁定 EDT，导致事件队列中的某些事件丢失，

用于测试 isDispatchThread() 以及如何从 Java 对象中激活 EDT 的两个代码示例

```
import java.awt.EventQueue;
import java.lang.reflect.InvocationTargetException;
import java.text.SimpleDateFormat;
import java.util.Date;
import java.util.concurrent.*;
import java.util.logging.Level;
import java.util.logging.Logger;
import javax.swing.*;

public class IsThereEDT {

    private ScheduledExecutorService scheduler;
    private AccurateScheduledRunnable periodic;
    private ScheduledFuture<?> periodicMonitor;
    private int taskPeriod = 30;
    private SimpleDateFormat sdf = new SimpleDateFormat("HH:mm:ss");
    private Date dateRun;
    private JFrame frame1 = new JFrame("Frame 1");

    public IsThereEDT() {
        scheduler = Executors.newSingleThreadScheduledExecutor();
        periodic = new AccurateScheduledRunnable() {

            private final int ALLOWED_TARDINESS = 200;
            private int countRun = 0;
            private int countCalled = 0;
            private int maxCalled = 10;

            @Override
            public void run() {
                countCalled++;
                if (countCalled < maxCalled) {
                    if (countCalled % 3 == 0) {
                        /*if (EventQueue.isDispatchThread()) {
                            SwingUtilities.invokeLater(new Runnable() {

                                @Override
                                public void run() {
                                    //some stuff
                                }
                            });
                        } else {
                            try {
                                SwingUtilities.invokeAndWait(new Runnable() {

                                    @Override
                                    public void run() {
                                        //some stuff
                                    }
                                });
                            } catch (InterruptedException ex) {
                                Logger.getLogger(IsThereEDT.class.getName()).log(Level.SEVERE, null, ex);
                            } catch (InvocationTargetException ex) {
                                Logger.getLogger(IsThereEDT.class.getName()).log(Level.SEVERE, null, ex);
                            }
                        }*/
                        SwingUtilities.invokeLater(new Runnable() {

                            @Override
                            public void run() {
                                System.out.println("Push a new event to EDT");
                                frame1.repaint();
                                isThereReallyEDT();
                            }
                        });
                    } else {
                        if (this.getExecutionTime() < ALLOWED_TARDINESS) {
                            countRun++;
                            isThereReallyEDT(); // non on EDT
                        }
                    }
                } else {
                    System.out.println("Terminating this madness");
                    System.exit(0);
                }
            }
        };
        periodicMonitor = scheduler.scheduleAtFixedRate(periodic, 0, taskPeriod, TimeUnit.SECONDS);
        periodic.setThreadMonitor(periodicMonitor);
        SwingUtilities.invokeLater(new Runnable() {

            @Override
            public void run() {
                isThereReallyEDT();
                frame1.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
                frame1.getContentPane().add(new JLabel("Hello in frame 1"));
                frame1.pack();
                frame1.setLocation(100, 100);
                frame1.setVisible(true);
            }
        });
        try {
            Thread.sleep(500);
        } catch (InterruptedException ex) {
            Logger.getLogger(IsThereEDT.class.getName()).log(Level.SEVERE, null, ex);
        }
        SwingUtilities.invokeLater(new Runnable() {

            @Override
            public void run() {
                JFrame frame2 = new JFrame("Frame 2");
                frame2.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
                frame2.getContentPane().add(new JLabel("Hello in frame 2"));
                frame2.pack();
                frame2.setLocation(200, 200);
                frame2.setVisible(true);
                isThereReallyEDT();
            }
        });
    }

    private void isThereReallyEDT() {
        dateRun = new java.util.Date();
        System.out.println("                         Time at : " + sdf.format(dateRun));
        if (EventQueue.isDispatchThread()) {
            System.out.println("EventQueue.isDispatchThread");
        } else {
            System.out.println("There isn't Live EventQueue.isDispatchThread, why any reason for that ");
        }
        if (SwingUtilities.isEventDispatchThread()) {
            System.out.println("SwingUtilities.isEventDispatchThread");
        } else {
            System.out.println("There isn't Live SwingUtilities.isEventDispatchThread, why any reason for that ");
        }
        System.out.println();
    }

    public static void main(String[] args) {
        IsThereEDT isdt = new IsThereEDT();
    }
}

abstract class AccurateScheduledRunnable implements Runnable {

    private ScheduledFuture<?> thisThreadsMonitor;

    public void setThreadMonitor(ScheduledFuture<?> monitor) {
        this.thisThreadsMonitor = monitor;
    }

    protected long getExecutionTime() {
        long delay = -1 * thisThreadsMonitor.getDelay(TimeUnit.MILLISECONDS);
        return delay;
    }
} 
```

和更简单的代码

.

.

```
import java.awt.EventQueue;
import java.text.SimpleDateFormat;
import java.util.Date;
import java.util.concurrent.*;
import java.util.logging.Level;
import java.util.logging.Logger;
import javax.swing.*;

public class IsThereEDT {

    private ScheduledExecutorService scheduler;
    private AccurateScheduledRunnable periodic;
    private ScheduledFuture<?> periodicMonitor;
    private int taskPeriod = 30;
    private SimpleDateFormat sdf = new SimpleDateFormat("HH:mm:ss");
    private Date dateRun;
    private JFrame frame1 = new JFrame("Frame 1");

    public IsThereEDT() {
        scheduler = Executors.newSingleThreadScheduledExecutor();
        periodic = new AccurateScheduledRunnable() {

            private final int ALLOWED_TARDINESS = 200;
            private int countRun = 0;
            private int countCalled = 0;
            private int maxCalled = 10;

            @Override
            public void run() {
                countCalled++;
                if (countCalled < maxCalled) {
                    if (countCalled % 3 == 0) {
                        SwingUtilities.invokeLater(new Runnable() {

                            @Override
                            public void run() {
                                System.out.println("Push a new event to EDT");
                                frame1.repaint();
                                isThereReallyEDT();
                            }
                        });
                    } else {
                        if (this.getExecutionTime() < ALLOWED_TARDINESS) {
                            countRun++;
                            isThereReallyEDT(); // non on EDT
                        }
                    }
                } else {
                    System.out.println("Terminating this madness");
                    System.exit(0);
                }
            }
        };
        periodicMonitor = scheduler.scheduleAtFixedRate(periodic, 0, taskPeriod, TimeUnit.SECONDS);
        periodic.setThreadMonitor(periodicMonitor);
        SwingUtilities.invokeLater(new Runnable() {

            @Override
            public void run() {
                isThereReallyEDT();
                frame1.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
                frame1.getContentPane().add(new JLabel("Hello in frame 1"));
                frame1.pack();
                frame1.setLocation(100, 100);
                frame1.setVisible(true);
            }
        });
        try {
            Thread.sleep(500);
        } catch (InterruptedException ex) {
            Logger.getLogger(IsThereEDT.class.getName()).log(Level.SEVERE, null, ex);
        }
        SwingUtilities.invokeLater(new Runnable() {

            @Override
            public void run() {
                JFrame frame2 = new JFrame("Frame 2");
                frame2.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
                frame2.getContentPane().add(new JLabel("Hello in frame 2"));
                frame2.pack();
                frame2.setLocation(200, 200);
                frame2.setVisible(true);
                isThereReallyEDT();
            }
        });
    }

    private void isThereReallyEDT() {
        dateRun = new java.util.Date();
        System.out.println("                         Time at : " + sdf.format(dateRun));
        if (EventQueue.isDispatchThread()) {
            System.out.println("EventQueue.isDispatchThread");
        } else {
            System.out.println("There isn't Live EventQueue.isDispatchThread, why any reason for that ");
        }
        if (SwingUtilities.isEventDispatchThread()) {
            System.out.println("SwingUtilities.isEventDispatchThread");
        } else {
            System.out.println("There isn't Live SwingUtilities.isEventDispatchThread, why any reason for that ");
        }
        System.out.println();
    }

    public static void main(String[] args) {
        IsThereEDT isdt = new IsThereEDT();
    }
}

abstract class AccurateScheduledRunnable implements Runnable {

    private ScheduledFuture<?> thisThreadsMonitor;

    public void setThreadMonitor(ScheduledFuture<?> monitor) {
        this.thisThreadsMonitor = monitor;
    }

    protected long getExecutionTime() {
        long delay = -1 * thisThreadsMonitor.getDelay(TimeUnit.MILLISECONDS);
        return delay;
    }
} 
```

# database - 违反唯一约束的行

> ID：10266593
> 
> 赞同：3
> 
> 时间：2012-04-22T08:57:50.430
> 
> 标签：database, postgresql, constraints, unique-constraint

我有一个 postgres 8.3.4 数据库。在三元组 UNIQ(name, id, age) 上存在一个具有唯一约束的名称表。不知何故，有几行已添加到数据库中，导致违反此约束。

我的问题是这怎么可能？当添加了违反约束的第一行时，数据库不应该抛出错误吗？

name : text
id : integer not null (fk to a id table)
age : integer

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-22T15:06:28.617

我的**猜测是你错过了****`NULL`价值观从不`UNIQUE`**的事实。
如果您多次输入，则不会出现唯一违规`(NULL, 1, 20)`。`(name, id, age)`两个`NULL`值永远不会被认为是“相同的”。

您可以设置所有涉及的列**`NOT NULL`**（在将 NULL 值替换为虚拟值之后）。

或者，您可以实现[**额外的部分索引**](http://www.postgresql.org/docs/current/interactive/indexes-partial.html)来覆盖 NULL（在使用 清除“dupes”之后`NULL`）。例如，如果您需要覆盖`name`NULL 列：

```
CREATE UNIQUE INDEX tbl_id_age_name_null_idx ON my_table (id, age)
WHERE name IS NULL; 
```

然后，您的表中可以有 ('pete', 1, 20) 和 ('jane', 1, 20) 和 (NULL, 1, 20) for (name, id, age)，但这些都不是第二次. 我最近[在 dba.SE 上为这个案例](https://dba.stackexchange.com/a/9760/3684)写了更详细的评估。

顺便说一句：您应该考虑更新您[的 PostgreSQL 版本](http://www.postgresql.org/support/versioning/)。最好到当前版本 9.1。或者至少到最新的版本 8.3.18。已经进行了许多修复。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-22T09:03:40.543

这几乎是不可行的。

很可能，您的名称中有额外的空格或类似的东西。

请发布确切的表定义。

另外，请运行此查询：

```
SELECT  q2.*
FROM    (
        SELECT  name, id, age
        FROM    mytable
        GROUP BY
                name, id, age
        HAVING  COUNT(*) > 1
        ) q
JOIN    mytable q2
ON      (q2.name, q2.id, q2.age) IS NOT DISTINCT FROM (q.name, q.id, q.age) 
```

并在此处发布一些返回的输出。

# google-maps - 基于距离的地图着色

> ID：10266594
> 
> 赞同：2
> 
> 时间：2012-04-22T08:57:54.607
> 
> 标签：google-maps, colors, rgb, contrast, cartography

我有一张谷歌地图，它显示了与特定位置的距离。

该地图由一组多边形组成，其中一个多边形环绕一个与该点距离相同的区域。因此，换句话说，我用一种颜色为距该点 0 到 5 分钟之间的区域着色，用另一种颜色为 5 到 10 分钟之间的区域着色，依此类推，直到 120 分钟。这给了我20种不同的颜色。

你会推荐我用什么 rgb 颜色在我的地图上形成一个很好的对比。也许有一个标准算法。否则我可以使用查找表，因为它只有 20 种不同的颜色。

谢谢，

巴里

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-22T09:15:59.200

~~一种可能性是选择一种颜色并设置不透明度，使圆圈随着半径的增加逐渐变暗。这是否是一个好的解决方案可能取决于信息的重要性。~~

更新：更好的解决方案是采用 MySociety 颜色，[如此地图](http://www.mysociety.org/2006/travel-time-maps/)所示，显示前往伦敦的旅行时间。他们已经做了很多这样的事情，如果你写信给他们，他们几乎肯定会让你拥有他们使用的秤。

# android - 如何制作圆形按钮？

> ID：10266595
> 
> 赞同：161
> 
> 时间：2012-04-22T08:57:57.100
> 
> 标签：android, android-button

我正在尝试制作圆形按钮，但我不知道该怎么做。我可以制作带圆角的按钮，但我怎样才能圆圆。这是不一样的。请告诉我，在Android上可以吗？谢谢你。

* * *

## 回答 #1

> 赞同：296
> 
> 时间：2012-04-22T10:27:11.883

`roundedbutton.xml`在drawable文件夹中创建一个xml文件

```
<?xml version="1.0" encoding="utf-8"?>
<shape xmlns:android="http://schemas.android.com/apk/res/android" 
android:shape="rectangle">
    <solid android:color="#eeffffff" />
    <corners android:bottomRightRadius="8dp"
        android:bottomLeftRadius="8dp"  
        android:topRightRadius="8dp"
        android:topLeftRadius="8dp"/>
</shape> 
```

最后将其设置为您的`Button`背景`android:background = "@drawable/roundedbutton"`

如果您想让它完全变圆，请更改半径并选择适合您的东西。

* * *

## 回答 #2

> 赞同：52
> 
> 时间：2015-06-17T11:30:13.057

如果使用 Android Studio，您可以使用：

```
<?xml version="1.0" encoding="utf-8"?>
    <shape xmlns:android="http://schemas.android.com/apk/res/android"
    android:shape="oval">
        <solid android:color="#FFFFFF"/>

    </shape> 
```

这对我来说很好，希望这对某人有所帮助。

* * *

## 回答 #3

> 赞同：35
> 
> 时间：2016-07-24T15:11:54.783

1.  创建一个 drawable/button_states.xml 文件，其中包含：

    ```
    <?xml version="1.0" encoding="utf-8"?>
    <selector xmlns:android="http://schemas.android.com/apk/res/android">
        <item android:state_pressed="false"> 
            <shape android:shape="rectangle">
            <corners android:radius="1000dp" />
            <solid android:color="#41ba7a" />
            <stroke
                android:width="2dip"
                android:color="#03ae3c" />
            <padding
                android:bottom="4dp"
                android:left="4dp"
                android:right="4dp"
                android:top="4dp" />
            </shape>
        </item>
        <item android:state_pressed="true"> 
            <shape android:shape="rectangle">
            <corners android:radius="1000dp" />
            <solid android:color="#3AA76D" />
            <stroke
                android:width="2dip"
                android:color="#03ae3c" />
            <padding
                android:bottom="4dp"
                android:left="4dp"
                android:right="4dp"
                android:top="4dp" />
            </shape>
        </item>
    </selector> 
    ```

2.  在任何布局文件的按钮标签中使用它

    ```
    <Button
        android:layout_width="220dp"
        android:layout_height="220dp"
        android:background="@drawable/button_states"
        android:text="@string/btn_scan_qr"
        android:id="@+id/btn_scan_qr"
        android:textSize="15dp"
    /> 
    ```

* * *

## 回答 #4

> 赞同：14
> 
> 时间：2014-09-02T05:43:18.767

**[Markushi 的 android circlebutton：](https://github.com/markushi/android-circlebutton)**

（这个库已被弃用，并且没有新的开发发生。考虑改用 FAB。）

![在此处输入图像描述](../Images/f9333270e1cd650515624797ba19a7c0.png)

* * *

## 回答 #5

> 赞同：10
> 
> 时间：2020-03-02T15:16:32.827

如果你想要一个看起来像 FAB 的圆形按钮，并且你正在使用官方的 Material Component 库，你可以像这样轻松地做到这一点：

```
<com.google.android.material.button.MaterialButton
    style="@style/Widget.MaterialComponents.ExtendedFloatingActionButton"
    app:cornerRadius="28dp"
    android:layout_width="56dp"
    android:layout_height="56dp"
    android:text="1" /> 
```

结果：

[![在此处输入图像描述](../Images/4fec58d1a6595fb4ea320b9024a7922c.png)](https://i.stack.imgur.com/qBlck.png)

如果更改按钮的大小，请注意将按钮大小的一半用作`app:cornerRadius`.

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2015-10-08T21:26:19.750

```
<?xml version="1.0" encoding="utf-8"?>
<shape xmlns:android="http://schemas.android.com/apk/res/android"
android:shape="oval">
<solid
    android:color="#ffffff"
    />
</shape> 
```

在您的 XML 可绘制资源上设置它，并使用您的可绘制作为背景，使用带有圆形图像的简单使用和图像按钮。

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2015-01-30T19:07:26.727

```
<corners android:bottomRightRadius="180dip"
    android:bottomLeftRadius="180dip"
    android:topRightRadius="180dip"
    android:topLeftRadius="180dip"/>

<solid android:color="#6E6E6E"/> <!-- this one is ths color of the Rounded Button --> 
```

并将其添加到按钮代码中

```
 android:layout_width="50dp"
    android:layout_height="50dp" 
```

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2014-05-24T20:30:33.900

使用形状为椭圆形。这使按钮呈椭圆形

```
<item>
    <shape android:shape="oval" >
        <stroke
            android:height="1.0dip"
            android:width="1.0dip"
            android:color="#ffee82ee" />

        <solid android:color="#ffee82ee" />

        <corners
            android:bottomLeftRadius="12.0dip"
            android:bottomRightRadius="12.0dip"
            android:radius="12.0dip"
            android:topLeftRadius="12.0dip"
            android:topRightRadius="12.0dip" />
    </shape>
</item> 
```

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2012-04-22T10:03:04.153

使用**ImageButton**而不是 Button....

**并制作具有透明**背景的圆形图像

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2012-04-22T09:04:53.197

[Android中的圆形按钮](https://stackoverflow.com/questions/3914329/round-button-in-android)

您可以制作`ImageButton`带有圆形背景的图像。

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2020-10-14T14:42:24.660

您可以使用`MaterialButton`：

```
 <com.google.android.material.button.MaterialButton
            android:layout_width="48dp"
            android:layout_height="48dp"
            android:insetTop="0dp"
            android:insetBottom="0dp"
            android:text="A"
            app:shapeAppearanceOverlay="@style/ShapeAppearanceOverlay.App.Rounded"
            /> 
```

并应用以下通知`ShapeAppearanceOverlay`：

```
<style name="ShapeAppearanceOverlay.App.rounded" parent="">
    <item name="cornerSize">50%</item>
</style> 
```

[![在此处输入图像描述](../Images/48d5e3f985428968dce2369f3f362c1c.png)](https://i.stack.imgur.com/Keplf.png)

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2014-07-23T11:38:20.713

对于圆形按钮，创建一个形状：

```
<?xml version="1.0" encoding="utf-8"?> 
```

```
<stroke
    android:width="8dp"
    android:color="#FFFFFF" />

<solid android:color="#ffee82ee" />

<corners
    android:bottomLeftRadius="45dp"
    android:bottomRightRadius="45dp"
    android:topLeftRadius="45dp"
    android:topRightRadius="45dp" /> 
```

将其用作按钮[链接的背景](http://www.pallandri.blogspot.com/2014/07/android-create-round-buttons.html)

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2012-04-22T09:04:12.323

是的，有可能，在谷歌上寻找 9-patch。好文章：

[http://radleymarx.com/blog/simple-guide-to-9-patch/](http://radleymarx.com/blog/simple-guide-to-9-patch/)

[http://ogrelab.ikratko.com/custom-color-buttons-for-android/](http://ogrelab.ikratko.com/custom-color-buttons-for-android/)

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2021-04-09T12:37:02.800

2021 年更新：

只需使用**MaterialButton**

```
<com.google.android.material.button.MaterialButton
    app:cornerRadius="30dp"
    android:layout_width="60dp"
    android:layout_height="60dp"
    android:text="test" /> 
```

*   宽度等于高度
*   cornerRadius 是宽度或高度的一半

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2020-11-29T09:33:38.057

我只是使用`FloatingActionButton`with`elevation = 0dp`去除阴影：

```
<com.google.android.material.floatingactionbutton.FloatingActionButton
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:src="@drawable/ic_send"
    app:elevation="0dp" /> 
```

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2012-04-22T09:16:23.767

这是

```
android.R.drawable.expander_ic_minimized 
```

查看内置的android drawables：

[http://androiddrawableexplorer.appspot.com/](http://androiddrawableexplorer.appspot.com/)

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2021-03-07T04:15:23.643

如果有人需要一个浮动动作按钮，但不想依赖于整个材质库，这里有一个看起来完全相同的最小实现，具有波纹动画、阴影和`show()`/`hide()`带有动画的方法。

[![在此处输入图像描述](../Images/0020da3035573e29c036c3bb7122d6eb.png)](https://i.stack.imgur.com/bQ284.png)

小部件代码：

```
class CircularImageButton @JvmOverloads constructor(
    context: Context,
    attrs: AttributeSet? = null,
) : AppCompatImageButton(context, attrs) {
    init {
        background = null
        outlineProvider = pillOutlineProvider
        clipToOutline = true
    }

    fun show() {
        if (visibility != VISIBLE) {
            visibility = VISIBLE
            startAnimation(showAnimation)
        }
    }

    fun hide() {
        if (visibility != INVISIBLE) {
            visibility = INVISIBLE
            startAnimation(hideAnimation)
        }
    }

    override fun setBackgroundColor(color: Int) {
        if (backgroundPaint.color != color) {
            backgroundPaint.color = color
            invalidate()
        }
    }

    private val backgroundPaint = Paint().apply { style = Paint.Style.FILL }

    override fun onDraw(canvas: Canvas?) {
        canvas?.drawPaint(backgroundPaint)
        super.onDraw(canvas)
    }
}

val pillOutlineProvider = object : ViewOutlineProvider() {
    override fun getOutline(view: View, outline: Outline) {
        outline.setRoundRect(0, 0, view.width, view.height, view.height.f / 2)
    }
}

private val animationDuration = applicationContext
        .resources.getInteger(android.R.integer.config_shortAnimTime).toLong()

val showAnimation = ScaleAnimation(
        0f, 1f, 0f, 1f,
        Animation.RELATIVE_TO_SELF, 0.5f,
        Animation.RELATIVE_TO_SELF, 0.5f)
        .apply { duration = animationDuration }

val hideAnimation = ScaleAnimation(
        1f, .5f, 1f, 0.5f,
        Animation.RELATIVE_TO_SELF, 0.5f,
        Animation.RELATIVE_TO_SELF, 0.5f)
        .apply { duration = animationDuration } 
```

还有 xml，其中 40dp 是 FAB 的“迷你”版本。

```
<CircularImageButton
    android:id="@+id/fab"
    android:layout_width="40dp"
    android:layout_height="40dp"

    android:src="@drawable/ic_your_drawable"
    android:scaleType="center"

    android:layout_margin="12dp"
    android:elevation="3dp"

    android:outlineAmbientShadowColor="#7000"
    android:outlineSpotShadowColor="#7000"
    android:foreground="?attr/selectableItemBackgroundBorderless" /> 
```

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2021-01-09T11:51:56.513

**全圆的圆形。**

```
<?xml version="1.0" encoding="utf-8"?>
<shape xmlns:android="http://schemas.android.com/apk/res/android"
    android:shape="rectangle">
    <solid android:color="#FFFFFF" />
    <stroke
        android:width="1dp"
        android:color="#F0F0F0" />
    <corners
        android:radius="90dp"/>
</shape> 
```

快乐编码！

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2016-06-18T21:35:37.783

你可以使用谷歌的 FloatingActionButton

xml:

```
<android.support.design.widget.FloatingActionButton
    android:id="@+id/fab"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:src="@android:drawable/ic_dialog_email" /> 
```

爪哇：

```
 @Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);

    FloatingActionButton bold = (FloatingActionButton) findViewById(R.id.fab);
    bold.setOnClickListener(new View.OnClickListener() {
        @Override
        public void onClick(View view) {
        // Do Stuff
        }
    });
} 
```

摇篮：

```
 compile 'com.android.support:design:23.4.0' 
```

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2020-11-24T08:53:07.180

我浏览了所有的答案。但是它们都不是初学者友好的。所以在这里我给出了一个非常详细的答案，并用图片进行了充分的解释。

打开安卓工作室。转到**项目窗口**并滚动到**res**文件夹下的**drawable**文件夹

 **[![在此处输入图像描述](../Images/29af825ccc9e9f8fbd995574dee74d86.png)](https://i.stack.imgur.com/A13Np.jpg)

右键单击，选择**新建**-->**可绘制资源文件夹**

[![在此处输入图像描述](../Images/7940218eaf265077902756b5acd169ca.png)](https://i.stack.imgur.com/lcuii.jpg)

在出现的窗口中，命名文件`rounded_corners`并单击**确定**

[![在此处输入图像描述](../Images/9503b3264961dc1dfbc89d5f8b9f210b.png)](https://i.stack.imgur.com/mTHtn.jpg)

`rounded_corners.xml`创建了一个新文件

打开文件。您将看到以下代码 -->

```
<?xml version="1.0" encoding="utf-8"?>
<selector xmlns:android="http://android.com/apk/res/android">

</selector> 
```

[![在此处输入图像描述](../Images/ef5d3a3ad0058e1d27a2fc907d76743a.png)](https://i.stack.imgur.com/FVDBU.jpg)

将其替换为以下代码 -->

```
<?xml version="1.0" encoding="utf-8"?>
<shape xmlns:android="http://schemas.android.com/apk/res/android">
    <corners android:radius="8dp" />
    <solid android:color="#66b3ff" />
</shape> 
```

[![在此处输入图像描述](../Images/c43ca23deb960b576aed15c09ee1e00c.png)](https://i.stack.imgur.com/oXiEw.jpg)

在这里可以在右侧看到设计视图

调整 in 的值`android:radius`以使按钮或多或少圆润。

然后去`activity_main.xml`

输入以下代码-->

```
<?xml version="1.0" encoding="utf-8"?>
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:app="http://schemas.android.com/apk/res-auto"
    xmlns:tools="http://schemas.android.com/tools"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    tools:context=".MainActivity"
    android:padding="10dp">

    <Button
        android:id="@+id/_1"
        android:text="1"
        android:textSize="25dp"
        android:textColor="#ffffff"
        android:background="@drawable/rounded_corners"
        android:layout_width="50dp"
        android:layout_height="wrap_content"
        android:layout_margin="20dp"
        android:layout_alignParentLeft="true"
        android:layout_alignParentTop="true"/>

</RelativeLayout> 
```

这里我放了`Button`里面一个`RelativeLayout`. 你可以使用任何`Layout`你想要的。

参考`MainActivity.java`代码如下-->

```
import android.app.Activity;
import android.os.Bundle;

public class MainActivity extends Activity {

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);
    }
} 
```

我安装了**Pixel 4 API 30** **avd**。运行**avd**中的代码后显示如下-->

[![在此处输入图像描述](../Images/9aef9854fab8f92bd0316d05d5684d31.png)](https://i.stack.imgur.com/LJJ0S.jpg)

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2017-07-27T08:22:32.723

1.  使用图像按钮并将背景设置为您想要的图像。
2.  从 android 资产工作室链接创建图像 -

" [https://romannurik.github.io/AndroidAssetStudio/icons-launcher.html#foreground.type=image&foreground.space.trim=0&foreground.space.pad=0.25&foreColor=rgba(94%2C%20126%2C%20142% 2C%200)&backColor=rgb(96%2C%20125%2C%20139)&crop=1&backgroundShape=circle&effects=none&name=ic_home](https://romannurik.github.io/AndroidAssetStudio/icons-launcher.html#foreground.type=image&foreground.space.trim=0&foreground.space.pad=0.25&foreColor=rgba(94%2C%20126%2C%20142%2C%200)&backColor=rgb(96%2C%20125%2C%20139)&crop=1&backgroundShape=circle&effects=none&name=ic_home) "

并下载它，提取它，在里面寻找 mipmap-hdpi 文件夹。

3.  从 mipmap-hdpi 文件夹中复制图像并将其粘贴到您的 android 项目的 drwable 文件夹中。

4.  现在将背景设置为该图像。

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2021-04-15T13:27:22.403

我喜欢这个解决方案

```
 <androidx.cardview.widget.CardView
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                app:cardCornerRadius="18dp"
                app:cardElevation="0dp"
                >
                <ImageButton
                        android:layout_width="35dp"
                        android:layout_height="35dp"
                        android:background="@null"
                       android:scaleType="centerCrop"
              android:src="@drawable/social_facebook"
                        />
            </androidx.cardview.widget.CardView> 
```**

# buildbot - 如何在不编译/构建项目的情况下使用 buildbot 运行测试

> ID：10266598
> 
> 赞同：1
> 
> 时间：2012-04-22T08:58:17.333
> 
> 标签：buildbot

嗨，我有 2 个关于 Buildbot 的问题：

1.  我想运行我编写的测试，而不编译项目（我有不同的编译/构建项目的机制），但我找不到任何配置它的方法。Buildbot 文档解释了如何构建然后才运行测试。我想跳过构建部分。有人试过这样做吗？

2.如何配置 buildbot 以使用本地存储库。我有一台计算机，它每天晚上将存储库与主存储库同步一次，我想在这台计算机上运行 Buildbot，并且 buildbot 应该在本地运行测试。（测试是同一解决方案中的一个单独项目）

我的环境是：Win7、Visual Studio、git 存储库、测试是同一解决方案中的一个单独项目。

感谢你的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-06T19:06:42.710

1) buildbot 只是运行一系列步骤。它们可以是你想要的任何东西。如果您没有构建步骤，那么您不需要运行它。

2）这`Git`一步只是传递`repourl`它被传递给`git clone`/ `git fetch`，所以如果存储库是本地的，你可以传递它的路径。

# c++ - 为什么在 Windows 7 中调用 Beep 功能后听不到任何声音？

> ID：10266599
> 
> 赞同：5
> 
> 时间：2012-04-22T08:58:25.833
> 
> 标签：c++, windows, winapi, audio, beep

我有以下代码：

```
#include <windows.h>
#include <stdio.h>

int main(void)
{
        Beep(523, 500);
        Sleep(1000);
        return 0;
} 
```

我正在使用 MinGW 和 Dev-C++ 编译它。我的问题是我什么都听不见，虽然我没有收到错误。我有 Windows 7。有什么想法吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-22T09:19:32.970

打开你的扬声器。如果它们已经打开，请调高音量。如果您的计算机上没有安装扬声器和声卡，请获取并安装它们，然后再次尝试运行该程序。

所有这些都是在 Windows 7 上听到该[`Beep`功能所必需的。](http://msdn.microsoft.com/en-us/library/windows/desktop/ms679277.aspx)[它不再从内置硬件系统扬声器播放声音。](http://blogs.msdn.com/b/larryosterman/archive/2010/01/04/what-s-up-with-the-beep-driver-in-windows-7.aspx)而是将声音传递给用户会话的默认声音设备。在标准的本地用户会话中，那将是您的声卡。文档在“备注”部分解释了这一重要细节：

> 很久以前，所有 PC 计算机共享一个通用的 8254 可编程间隔定时器芯片，用于生成原始声音。该`Beep`函数是专门为在该硬件上发出哔哔声而编写的。
> 
> `Beep`在这些较旧的系统上，静音和音量控制对;没有影响。你仍然会听到音调。要使音调静音，您使用了以下命令：
> 
> ```
> net stop beep  
> sc config beep start= disabled 
> ```
> 
> 从那时起，声卡已成为几乎所有 PC 计算机的标准设备。随着声卡变得越来越普遍，制造商开始从计算机中移除旧的计时器芯片。这些芯片也被排除在服务器计算机的设计之外。结果是在`Beep`没有芯片的所有计算机上都无法工作。这没关系，因为大多数开发人员已经开始调用使用默认声音设备而不是 8254 芯片的[`MessageBeep`函数。](http://msdn.microsoft.com/en-us/library/windows/desktop/ms680356.aspx)
> 
> 最终由于缺乏与之通信的硬件，`Beep`在 Windows Vista 和 Windows XP 64 位版本中不再支持。
> 
> 在 Windows 7 中，Beep 被重写以将哔声传递给会话的默认声音设备。这通常是声卡，除非在终端服务下运行，在这种情况下会在客户端上呈现哔声。

# javascript - 执行动态加载的 JS 文件

> ID：10266600
> 
> 赞同：3
> 
> 时间：2012-04-22T08:58:38.143
> 
> 标签：javascript

我知道 JS 是单线程和同步执行的。因此，当我将文件添加到浏览器头标记时，该文件会在遇到时立即执行。然后它转到下一个脚本标签并执行该文件。我的问题是当我将 js 文件动态添加到 HTML 头标记时。浏览器如何执行该文件？是否就像在当前执行所在的任何位置加载文件后立即执行文件一样。还是我们可以控制该文件的执行方式？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-22T12:22:23.290

脚本加载完毕后，会尽快执行。也就是说，如果其他一些 javascript 函数正在执行，比如 clickhandler 或其他什么，它将被允许首先完成 - 但这是给定的，因为正如你所说，在浏览器中 JavaScript 通常在单个线程中执行。

您无法控制脚本加载的那部分，但您可以使用这种模式 - 深受 JSONP 的启发：

*插入脚本：*

```
(function () {
    var module = {
        init: function () {
            /* ... */
        }
    }

    ready(module);  // hook into "parent script"
}()); 
```

*主页上的脚本：*

```
function ready(o) {
    // call init in loaded whenever you are ready for it...
    setTimeout(function () { o.init(); }, 1000);
} 
```

这里的关键是`ready`在您的页面上定义的函数，并从您动态插入的脚本中调用。`init`脚本不会立即开始执行，而是只会告诉父页面它已加载，然后父页面可以在想要开始执行时回调插入的脚本函数。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-22T13:34:24.270

动态加载 JavaScript 文件时会发生什么（非常简化，没有检查）：

1.  文件已加载；
2.  如果有函数调用，例如`doSomething()`or `(function(){...})()`，则执行代码（当然你必须有定义）；
3.  如果只有函数定义，则在函数调用之前什么都不会发生。

看这个[例子](http://zdravko.genov.me/demo/include-javascript-files.html)：3个文件被加载，2个立即执行，1个等待超时。

编辑：

脚本标签可以放置在页面的任何位置。实际上如果不使用onload事件最好放在页面末尾（[^(雅虎速度提示)](http://developer.yahoo.com/performance/rules.html#js_bottom)）。

使用 HTML5 JavaScript 有 web workers [^(MDN)](https://developer.mozilla.org/En/Using_web_workers) [^(MSDN)](http://msdn.microsoft.com/en-us/hh549259) [^(wikipedia)](http://en.wikipedia.org/wiki/Web_worker)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-22T12:19:36.207

考虑一种方法是

```
var js=document.createElement('script')
js.setAttribute("type","text/javascript")
js.setAttribute("src", filename)
document.getElementsByTagName("head")[0].appendChild(js); 
// ^ However this technique has been pointed to be not so trusworthy (Read the link in the comment by Pomeh) 
```

但是回答你的问题

> 浏览器如何执行该文件？

一旦脚本被添加到 DOM

> 是否就像在当前执行所在的任何位置加载文件后立即执行文件一样？

是的

> 还是我们可以控制该文件的执行方式？

如果您附加一个 onload 事件处理程序，而不是一个讨厌的技巧，它会更好。

* * *

## 回答 #4

> 赞同：-3
> 
> 时间：2012-04-22T12:16:08.097

这是一些您可以尝试回答问题的代码。

```
<script>
var s = document.createElement('script'), f = 1;
s.src="http://code.jquery.com/jquery-1.7.2.js";
document.head.appendChild(s)
s.onload = function(){
  console.log(2);
  f = 0    
}
while(f){
    console.log(1);
}
</script> 
```

理想情况下，此代码应在脚本加载时打印 2，但如果您注意到，这永远不会发生 ​</p>

注意：这会杀死你的浏览器！

# php - 在 Facebook 上链接的规范网址而不是真实网址。动态 OpenGraph 标记为空

> ID：10266604
> 
> 赞同：6
> 
> 时间：2012-04-22T08:59:07.113
> 
> 标签：php, facebook, tags, hyperlink, facebook-opengraph

我的网站是一个工作网站如果我现在分享一份工作，例如，网址可能是

[http://jobs.com/jobs/show-job/143/Jobit-flyers-put-up/Other/](http://jobs.com/jobs/show-job/143/Jobit-flyers-put-up/Other/)

但是 facebook 尝试抓取[http://jobs.com/jobs/show-job/](http://jobs.com/jobs/show-job/)因为那是规范的 url。

当有人在 facebook 上发布它时，这真的很糟糕，因为所有 OpenGraph 标签都是空的，所以链接会得到错误的缩略图和空白信息。谁知道如何解决这个问题？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-04-24T01:01:42.427

固定的！

在您正在创建的动态页面的标题内，只需使用 meta og 标签

```
 <meta property="og:url" content="<?php get_current_url(); ?>" > 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-22T10:07:26.407

规范 URL 是代表您的 OpenGraph 对象的 URL，它旨在以这种方式工作！

您可以查看[我对类似问题给出的答案以](http://facebook.stackoverflow.com/a/10025878/155033)了解更多详细信息。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-09-06T19:02:29.827

如果您要发布“文章”，请勿使用 og:type 的“网站”。

例如：

*   如果你说这个[http://jobs.com/show-job/](http://jobs.com/show-job/)
*   是 og:type = 网站

然后你告诉facebook：

*   [http://jobs.com/jobs/show-job/143/Jobit-flyers-put-up/Other/](http://jobs.com/jobs/show-job/143/Jobit-flyers-put-up/Other/)
*   是典型的表演工作/

简单地说：使用以下内容：

*   og:type = 网站 => [http://jobs.com/](http://jobs.com/)
*   og:type = 文章 => [http://jobs.com/show-job/](http://jobs.com/show-job/)
*   og:type = article => [http://jobs.com/jobs/show-job/143/Jobit-flyers-put-up/Other/](http://jobs.com/jobs/show-job/143/Jobit-flyers-put-up/Other/)

更多信息在这里： [https ://ogp.me/#type_article](https://ogp.me/#type_article)

# asp.net-mvc - 仅获取实体框架所需的内容

> ID：10266610
> 
> 赞同：2
> 
> 时间：2012-04-22T08:59:59.703
> 
> 标签：asp.net-mvc, entity-framework, linq-to-entities

`SELECT`通过与 SQL Server 的普通连接，您可以指定要在简单语句中返回的列。

使用英孚：

```
Dim who = context.Doctors.Find(3) ' Primary key is an integer 
```

以上返回实体拥有的所有数据......但是......我只想用 SQL 做你能做的，只得到我需要的。

这样做：

```
 Dim who= (From d In contect.Doctors
                     Where d.Regeneration = 3
                     Select New Doctor With {.Actor = d.Actor}).Single 
```

给我这个错误：

> 无法在 LINQ to Entities 查询中构造实体或复杂类型 XXXXX。

那么...如何仅从一个实体返回选定的数据？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-22T09:37:35.210

基本上，我不确定为什么，但 Linq 无法创建复杂类型。如果您正在创建一个匿名类型，例如（对不起 c# 代码），它会起作用

```
var who = (from x in contect.Doctors
           where x.Regeneration == 3
           select new { Actor = x.Actor }).Single(); 
```

然后你可以去

```
var doctor = new Doctor() {
    Actor = who.Actor
}; 
```

但它不能像您尝试使用的那样将其构建为强类型或复杂类型

```
var who = (from x in contect.Doctors
           where x.Regeneration == 3
           select new Doctor { Actor = x.Actor }).Single(); 
```

另外你可能要小心使用`single`，如果没有具有再生编号的医生或者有多个它会抛出异常，`singleordefault`更安全但如果有多个匹配它会抛出异常。`First`或者`Firstordefault`更好的选择`First`只会在不存在并且`Firstordefault`几乎可以处理任何事情的情况下抛出异常

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-22T11:49:51.360

最好的方法是在 ViewModel 中设置想要的属性“或 DTO，如果你正在处理更高级别”然后作为你的示例，ViewModel 将是：

```
public class DoctorViewModel{
public string Actor {get;set;}
// You can add as many properties as you want
} 
```

那么查询将是：

```
var who = (From d In contect.Doctors
                     Where d.Regeneration = 3
                     Select New DoctorViewModel {Actor = d.Actor}).Single(); 
```

抱歉，我用 C# 编写了代码，但我认为这个想法很清楚 :)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-22T09:36:56.763

你可以简单地这样做：

```
 Dim who= (From d In contect.Doctors
                     Where d.Regeneration = 3
                     Select d.Actor).Single 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-22T11:59:47.903

尝试这个

```
Dim who = contect.Doctors.SingleOrDefault(Function(d) d.Regeneration = 3).Actor 
```

# c# - 将 bindingsource 与 bindinglist 一起使用有什么好处 作为数据源？

> ID：10266611
> 
> 赞同：15
> 
> 时间：2012-04-22T09:00:36.303
> 
> 标签：c#, .net, winforms, bindingsource, bindinglist

我可以通过设置 DataSource 属性直接将我的 DataGridView 控件绑定到我的业务对象的绑定列表。我的业务对象实现了 INotifyPropertyChanged，因此当将新项目添加到绑定列表或更新现有项目时，DGV 会得到更新。

关于处理单个记录，我可以将我的业务对象绑定到文本框和其他相关控件。

我还可以从 BindingList 派生并创建一个 CustomBindingList 类来实现 IBindable 所需的方法，如下面的链接中所述：http: [//msdn.microsoft.com/en-us/library/aa480736.aspx](http://msdn.microsoft.com/en-us/library/aa480736.aspx)

或者，我看到人们推荐使用 BindingSource。BindingSource 的Datasource 是业务对象，DGV 的DataSource 是BindingSource。

无论如何，基于 BindingSource 并不能提供给我：

1.  过滤（过滤器不起作用）。实施需要由我提供。
2.  排序和搜索不起作用。实施需要由我提供。

那么，为什么推荐使用 BindingSource 方法呢？

更广泛的情况：我不熟悉 OOPS 概念和 C#。使用数据库应用程序。窗体。到目前为止只使用了DataSet/DataTable 的方法。现在尝试创建和使用我自己的自定义类。

通常有一个主/明细表。当我单击 DGV 中的详细信息行时，我想在单独的窗口中编辑该记录。因此，我需要获取 DGV 中该行表示的列表项的句柄。试图为此找到解决方案让我想到了这一点和这个疑问。

鉴于我想做什么，哪种方法更好，为什么？

这里的一些指针真的很有帮助，因为我对此很陌生。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-23T22:18:48.687

当窗体上的多个控件使用相同的数据源时，建议使用 BindingSource（[幕后：Windows 窗体数据绑定的改进](http://msdn.microsoft.com/en-us/library/aa480734.aspx)）

设计时：当数据绑定到控件时，我个人发现 BindingSource 在从我的业务对象中选择属性时非常有帮助。

要获取当前选定行的句柄，请尝试 bindingSource1.Current as MyBusinessObject;

至于过滤和搜索：我对已实现的网格使用第三方 dll。所以不能帮你，抱歉。

当您使用不同类型业务对象的列表时，不要直接使用该列表

```
List<IAnimal> animals = new List<IAnimal>();
animals.Add(new Cat());
animals.Add(new Dog());
bindingSource1.DataSource = animals; 
```

而是使用这样的 BindingList：

```
bindingSource1.DataSource = new BindingList<IAnimal>(animals); 
```

这将确保列表中所有访问的对象都是 IAnimal 类型，并为您节省一些例外情况。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-11T01:44:54.610

在处理仅显示一部分的大型集合时，绑定到 DataSource 可以为您带来好处。例如，如果您在这里查看 Telerik ListView [http://www.telerik.com/help/winforms/listview-databinding.html](http://www.telerik.com/help/winforms/listview-databinding.html)（这些组件包有很多，这只是我正在使用的最新一个从）。

该视图非常轻量级，可让您的滚动位置确定哪些对象需要实际显示。因此，如果您只查看前 10 个对象并且从不向下滚动，则只有 10 个被绑定和显示。这可能会避免大量不需要的数据访问。

它们的 GridView 功能相同。网格的显示部分与潜在的巨大底层网格分开。

作为奖励，您可以进行过滤、排序和分组。

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2014-01-15T04:04:45.373

据我所知，如果您正在使用**数据库**，则在中间使用**bindingSource**以在数据库和控件之间建立双边桥梁。**否则**，您可以只使用**bindingList**作为控件的源。

# c# - 与身份验证方法作斗争

> ID：10266612
> 
> 赞同：6
> 
> 时间：2012-04-22T09:00:40.937
> 
> 标签：c#, web-services, rest, authentication, encryption

我想不使用内置的 WCF/c# 组件，

1.  向 RESTful 服务验证客户端
2.  处理客户端中 API 调用的身份验证失败

这是一个教学练习：我意识到有内置的身份验证方法，我想从头开始这样做以了解它是如何工作的。

我有密码散列和检查逻辑以及验证密码的公开 REST 调用，但我不确定如何从那里开始。

### 背景

我正在努力为我的休息服务创建身份验证方法。

到目前为止，我已经成功地创建了密码、salt 的哈希值并存储了 salt，并且我已经成功地验证了用户身份。但是，我不确定您将如何封装我所有的 wcf REST 请求，以便如果有任何请求（GET、POST），它会要求您登录，如果您没有登录。

因为我使用了自己的身份验证技术，而且我是 Web 服务和 C# 的新手，所以我真的不知道从哪里开始？

因此，我将向任何可以提供解决方案的人提供 300 个代表。

### 代码

这是我的休息服务：

```
[ServiceContract(Namespace = "http://tempuri.org")]
[XmlSerializerFormat]
public interface IService
{
  .... all of my GET, POST, PUT and DELETE requests
{
[DataContract(Name="Student")]
[Serializable]
public class Student
{
    [DataMember(Name = "StudentID")]
    public string StudentID { get; set; }
    [DataMember(Name = "FirstName")]
    public string FirstName { get; set; }
    [DataMember(Name = "LastName")]
    public string LastName { get; set; }
    [DataMember(Name = "Password")]
    public string Password;
    [DataMember(Name = "Salt")]
    public byte[] Salt;
    //note the use of public datamembers for password and salt, not sure how to implement private for this. 
 }
[ServiceBehavior(InstanceContextMode = InstanceContextMode.Single)]
[Serializable]
public class Service: IService
{
    #region Authentication, hash and salt
    protected RNGCryptoServiceProvider random = new RNGCryptoServiceProvider();
    public byte[] GenerateSalt() //Generate random salt for each password
    {
        byte[] salt = new byte[10000]; 
        random.GetNonZeroBytes(salt);
        return salt;
    }
    public static byte[] Hash(string value, byte[] salt) //hash and salt the password 
    {
        return Hash(Encoding.UTF8.GetBytes(value), salt); 
    }

    public static byte[] Hash(byte[] value, byte[] salt) // create hash of password 
    {
        byte[] saltedValue = value.Concat(salt).ToArray();

        return new SHA256Managed().ComputeHash(saltedValue); //initialise new isntance of the crypto class using SHA-256/32-byte (256 bits) words  
    }
    public string AuthenticateUser(string studentID, string password) //Authentication should always be done server side 
    {
        var result = students.FirstOrDefault(n => n.StudentID == studentID);
        //find the StudentID that matches the string studentID 
        if (result != null)
        //if result matches then do this
        {
            byte[] passwordHash = Hash(password, result.Salt);
            string HashedPassword = Convert.ToBase64String(passwordHash);
            //hash salt the string password
            if (HashedPassword == result.Password)
            //check if the HashedPassword (string password) matches the stored student.Password
            {
                return result.StudentID;
                // if it does return the Students ID                     
            }

        }
        return "Login Failed";
        //if it doesnt return login failed 
    }
    #endregion 
```

我也是从控制台应用程序托管的，我没有 web.config 文件或 app.config 文件。而且因为我使用了自己的身份验证方法，所以我不确定基本身份验证是否可行。

我也不想为了保持服务 SOA 和无状态而保持会话。

控制台应用程序：

```
namespace ConsoleApplication1
{
    class Program
    {
        static void Main(string[] args)
        {
            string baseAddress = "http://" + Environment.MachineName + ":8000/Service";
            ServiceHost host = new ServiceHost(typeof(Service), new Uri(baseAddress));
            WebHttpBinding binding = new WebHttpBinding();
            binding.Security.Mode = WebHttpSecurityMode.Transport;
            host.AddServiceEndpoint(typeof(IService), new WebHttpBinding(), "").Behaviors.Add(new WebHttpBehavior());
            host.Open();
            Console.WriteLine("Host opened");
            Console.ReadLine();

        }
    }
} 
```

请注意，在我的客户端，我做了一些非常基本的事情来进行身份验证：

```
 private void Login_Click(object sender, RoutedEventArgs e)
    {

        //Authenticate user (GET Request)
        string uri = string.Format("http://localhost:8000/Service/AuthenticateUser/{0}/{1}", textBox1.Text, passwordBox1.Password);
        XDocument xDoc = XDocument.Load(uri);
        string UserAuthenticationID = xDoc.Element("string").Value;
        Int32 value;
        if (Int32.TryParse(UserAuthenticationID, out value))
        {
            MainWindow authenticatedidentification = new MainWindow(); 
            authenticatedidentification.SetLabel(UserAuthenticationID);
            authenticatedidentification.Show();
            this.Close();
        }
        else
        {
            label1.Content = UserAuthenticationID;
        }
    } 
```

因此，我不确定如果上述任何内容，还必须向主应用程序携带什么，以便主应用程序访问这些休息请求。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-02T14:14:15.213

为什么不为您的 REST 服务使用 OAuth 或 OpenID？！有 OAuth 2.0 或更早版本。也有客户端和服务器的实现。OAuth 通行证适用于 REST 服务

您不需要创建自己的机制。

OAuth 的主站点 - [http://oauth.net/code/](http://oauth.net/code/) 在那里您可以找到有关 OAuth 的工作原理、流程等的描述。还有实现的链接，例如[DotnetOpenAuth](http://www.dotnetopenauth.net/)

最新规范 - [https://datatracker.ietf.org/doc/html/draft-ietf-oauth-v2。](https://datatracker.ietf.org/doc/html/draft-ietf-oauth-v2)

[您可以在他们的 Github 存储库https://github.com/AArnott/dotnetopenid/tree/master/samples](https://github.com/AArnott/dotnetopenid/tree/master/samples)上找到很多 DotNetOAuth 的 OAuth 实现示例

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-02T07:06:07.053

所以通常这样做的方式是

1.  客户端通过身份验证服务调用提供一些凭据
2.  该服务验证这些凭据并交还一些身份验证令牌。
3.  随后的调用使用该令牌进行身份验证。

    这可以通过发送令牌（例如[http 摘要身份验证](http://en.wikipedia.org/wiki/Message_authentication_code)）或更安全的方式来完成，令牌是用于计算参数上的[消息身份验证代码](http://en.wikipedia.org/wiki/Message_authentication_code)的密钥。这可以防止任何人篡改请求。

[这里有一个关于如何在 WCF 中执行此](http://msdn.microsoft.com/en-us/library/dd203052.aspx)操作的不错的讨论。请参阅“安全注意事项”部分和“实施身份验证和授权”部分

因此，假设您已经完成了此操作（或者您在每个请求中都发送了用户名和密码——这是一个坏主意，但是嘿，这只是为了教育目的）并且您有一个 AuthenticateUser 方法，如果用户未通过身份验证，则该方法返回 false。现在在每个公开的 REST 方法中添加此调用（参数可以是用户名和密码，也可以是身份验证令牌）

```
if (!AuthenticateUser(/* auth params here */))

{

    WebOperationContext.Current.OutgoingResponse.StatusCode =

        HttpStatusCode.Unauthorized;

    return;
} 
```

这会导致请求失败，并且客户端将获得 HTTP 403 Forbiden 响应。

我假设您正在使用 HttpWebRequest 来调用 REST API。

因此，在您的客户端程序中，在您准备好请求后，添加您需要的任何参数，执行此操作

```
try
{
    var wResp = (HttpWebResponse)wReq.GetResponse();
    var wRespStatusCode = wResp.StatusCode;
}
catch (WebException we)
{
    var wRespStatusCode = ((HttpWebResponse)we.Response).StatusCode;
    if( wRespStatusCode == HttpStatusCode. Unauthorized)
    {
       // call to your sign in / login logic here
    } else{
        throw we;
    }
} 
```

您需要以某种方式在请求中包含身份验证令牌，作为 get 或 post 参数或在标头中。发布或获取只是将参数添加到请求数据的问题。标题有点困难，我相信它在我上面引用的 MSDN 链接中概述。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-04-30T22:42:07.073

@jbtule 和 @Damien_The_Unbeliever 在使用散列密码存储盐方面提出了很好的观点。

至于您如何实现它的问题，我不会将其作为单独的服务方法进行，而是将身份验证部分作为方法调用本身。然后由客户端通过服务调用传递凭据。

**[这个链接](http://codebetter.com/petervanooijen/2010/03/22/a-simple-wcf-service-with-username-password-authentication-the-things-they-don-t-tell-you/)**详细描述了如何完成它，从服务器和客户端看它是什么样子的，等等。

编辑：您可以传递登录令牌并在执行请求之前检查它在 Web 服务上是否有效，而不是像上面链接中那样在消息凭据中传递用户名和密码。

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2012-04-30T23:11:59.973

我最近（过去几周）的方式是通过 IDispatchMessageInspector。在消息检查器类中，我使用 securityContext.AuthorizationContext.ClaimSets 来检查客户端（调用者）的证书，但您可以使用自定义标头（用户、密码）并查看 OperationContext.Current.IncomingMessageHeaders。在 AfterReceiveRequest() 中，如果用户不是有效用户，我要么抛出错误，要么简单地返回 null 表示成功。

然后我创建了一个属性，将我的检查器 (MessageInspector) 添加到服务类：

```
[AttributeUsage(AttributeTargets.Class)]
public class AuthorizeAttribute : Attribute, IServiceBehavior
{
    public void AddBindingParameters(ServiceDescription serviceDescription, ServiceHostBase serviceHostBase, Collection<ServiceEndpoint> endpoints, BindingParameterCollection bindingParameters)
    {
    }

    public void ApplyDispatchBehavior(ServiceDescription serviceDescription, ServiceHostBase serviceHostBase)
    {
        foreach (ChannelDispatcherBase dispatcher in serviceHostBase.ChannelDispatchers)
        {
            var channelDispatcher = dispatcher as ChannelDispatcher;
            if (channelDispatcher != null)
            {
                foreach (EndpointDispatcher endpointDispatcher in channelDispatcher.Endpoints)
                {
                    var inspector = new MessageInspector();
                    endpointDispatcher.DispatchRuntime.MessageInspectors.Add(inspector);
                }
            }
        }

        //var config = new ServiceLayerConfiguration();
        //config.RequestProcessorImplementation = typeof(PassThruRequestProcessor);
        //config.Initialize();

    }

    public void Validate(ServiceDescription serviceDescription, ServiceHostBase serviceHostBase)
    {
    }
} 
```

最后在服务类中，我只需添加属性。

```
[AuthorizeAttribute]
public class OperaService : IMyService 
```

如有必要，我可以提供更多详细信息。我的盒子上还有客户端/服务应用程序。:)

# java - 你如何检测是否没有来自用户的输入（java）

> ID：10266616
> 
> 赞同：4
> 
> 时间：2012-04-22T09:00:59.750
> 
> 标签：java, input, compiler-errors, nullpointerexception, line

好的，所以我正在做这个项目，你必须对用户的输入做一些事情

让说如果他进入

“12 3”

但他没有输入第二个输入

假设我用

```
String something = in.readLine(); 
```

如果我打电话

```
String nextLine = in.readLine(); 
```

我得到错误。我如何检查是否没有第二个输入？

公共静态 void main(String [] args) 抛出 IOException{

```
 BufferedReader in = new BufferedReader(new InputStreamReader(System.in)); //ctr + shift + o

    String eachLine = in.readLine(); //ex. "12    5"" or "AB     12"

    String nextLine = in.readLine(); 
```

如果用户输入

“3 2”<<

但没有进入第二个..我得到nullpointerexception

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-22T09:16:54.813

这取决于您所说的“他没有输入第二个输入”的意思：

*   如果您的意思是用户输入了 EOF 字符（例如 Linux 上的 CTRL-D），那么该`readLine()`方法将返回 a `null`，您的应用程序可以（并且应该）显式测试它。

*   如果您的意思是用户什么都不输入，那么什么也不会发生。您的应用程序将坐在那里等待用户输入下一行。为了解决这个问题，你需要某种超时机制......

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-22T09:19:33.967

为此，您可以使用[Timer类。](http://docs.oracle.com/javase/1.4.2/docs/api/javax/swing/Timer.html)

看看[这里](https://stackoverflow.com/questions/5853989/time-limit-for-an-input)

就像是..

```
TimerTask task = new TimerTask(){
public void run(){
if( input is empty ){
System.out.println( "you input nothing. exit..." );
System.exit( 0 );
}
}
}; 
```

安排`Timer`..

```
Timer timer = new Timer();
timer.schedule( task, timeoutTime); 
```

//读取输入

```
String nextLine = in.readLine(); 
```

//取消定时器..

```
timer.cancel(); 
```

# ruby-on-rails - 无法更改 Rails 控制器中的值类型？

> ID：10266618
> 
> 赞同：0
> 
> 时间：2012-04-22T09:01:19.627
> 
> 标签：ruby-on-rails, controller

我想将整数更改为在 rails 控制器中显示值，但似乎我无法将 :status 值分配为字符串，但可以为其分配一个整数值。

如何输出 :status 显示值？

```
 @task = Task.find(params[:task_id])

  STATUS_HASH = {
    0 => 'todo',
    1 => 'doing',
    2 => 'done',
  }

  @tasks.each do |t|
    t[:status] = STATUS_HASH[t[:status]]
  end 
```

# html - 如何在不使用浏览器的情况下在本地显示 html 的内容？

> ID：10266619
> 
> 赞同：0
> 
> 时间：2012-04-22T09:02:38.320
> 
> 标签：html

我看到一些应用程序（例如 Read it later 或 instapaper）在他们自己的系统中本地显示清理 html。

我想知道怎么做？

在我看来，我认为软件本身包含一个像浏览器这样的显示模块，或者只是以常规文件格式显示它？我是新手，但想知道。

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-22T09:07:03.193

“浏览器”主要是围绕[*渲染引擎*](http://en.wikipedia.org/wiki/Layout_engine)进行装饰，其工作是渲染 HTML。该渲染引擎通常可由任何独立于浏览器的应用程序使用。就这样。

# video - SDL 中具有显着延迟的视频更新

> ID：10266621
> 
> 赞同：3
> 
> 时间：2012-04-22T09:02:52.667
> 
> 标签：video, sdl, latency

如果我没记错的话，我以前遇到过这个问题，但我不记得我是如何解决的。这是我的程序：

```
#include "SDL.h"

SDL_Surface *screen;
SDL_Event event;

int main(int argc,char *argv[])
{
    SDL_Init(SDL_INIT_VIDEO);
    atexit(SDL_Quit);
    screen = SDL_SetVideoMode(640,480,32,SDL_SWSURFACE);
    int x = 10,y = 10;
    while (1)
    {
        while (SDL_PollEvent(&event))
        {
            if (event.type == SDL_QUIT)
                exit(0);
        }
        int mx,my;
        Uint8 mstate = SDL_GetMouseState(&mx,&my);
        if (mstate & SDL_BUTTON(1)) x = mx,y = my;
        SDL_FillRect(screen,NULL,0);
        *(Uint32*)((Uint8*)screen->pixels+screen->pitch*y+x*sizeof(Uint32)) = 0xFFFFFFFF;
        SDL_UpdateRect(screen,0,0,0,0);
    }
} 
```

黑色背景中有一个白色像素，当您按下鼠标左键时，它会移动到鼠标光标的位置。问题是，像素出现在新位置之前需要很长时间。仅仅那个像素就不是问题。当我尝试移动程序窗口时，它也不会立即响应。如果我把它放在 while(SDL_PollEvent(&event)) 循环中的某个地方，函数 printf 也不会。另一方面，如果我对 SDL_SetVideoMode 做同样的事情，它会在事件发生的那一刻做出响应。此外，这仅在 FPS 和分辨率足够高时才会发生。如果我将视频模式设置为 320x200 而不是 640x480，或者限制 FPS，那么一切都会准时发生。顺便说一句，我使用带有 Mesa 图形驱动程序的 Ubuntu 11.10。那么这个问题是 SDL 或其他软件的错误还是我的错？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-29T13:27:53.000

它在我的电脑上也能正常工作（windows7），里面的执行时间`while (1)`不到 1 毫秒。

当您将视频模式设置为较低分辨率时，一切都会按时发生，这会导致您的计算机资源不足和/或`Ubuntu 11.10 with Mesa graphics drivers`.

您需要分析每个函数使用的 cpu 时间才能找到瓶颈。

一些想法：

*   将您的绘图/更新功能放在`if (mstate & SDL_BUTTON(1))`
*   更新改变的像素 ->`SDL_UpdateRect(screen,x,y,1,1);`
*   将旧的白色像素更新为黑色，而不是在整个屏幕上填充黑色。
*   `SDL_Delay(10);`在 while(1) 循环结束之前添加。

# objective-c - 如何将我的 objc 程序与 objc++ 库接口？

> ID：10266622
> 
> 赞同：4
> 
> 时间：2012-04-22T09:03:20.470
> 
> 标签：objective-c, cocoa, objective-c++, scintilla

我有一个 objc 程序，我想使用一个用 objc++ 编写的小部件（即[https://launchpad.net/scintilla-cocoa](https://launchpad.net/scintilla-cocoa)）。我该怎么做？基本上我想要一个新的窗口控制器对象来与这个 objc++ 库接口来定义一个闪烁的文本编辑器小部件。简单地创建一个新的“objc 类”并从那里访问库会产生一堆与 C++`class`关键字相关的错误等等。

提前致谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-23T05:31:35.467

由于我是让您陷入使用**Scintilla**的（希望是有益的:-)）麻烦的人，所以我来了。

* * *

假设我们创建了一个`ScintillaView`名为 的子类`ppScintillaEditor`。该文件应该有一个`.mm`扩展名（例如`ppScintillaEditor.mm`）

代码大概是这样的......

**界面**

```
#import "Scintilla/ScintillaView.h"

@interface ppScintillaEditor : ScintillaView
{
    // your iVars
}

// your properties / methods / whatever 
```

现在，至于**实现**部分，记得放一些初始化方法来正确设置视图（如随附的 Scintilla-cocoa 示例；我的意思是测试项目）

* * *

***旁注：**当然，您可以在类之上创建子类、类别或其他任何内容`ScintillaView`，这几乎取决于您的需要 - 例如，我创建了一个单独的类别只是为了将一些`ScintillaView`特定命令分组（迟早，你会注意到，对于一些更高级的 Scintilla 操作，虽然它在那里，但可能需要一些抛光才能对可可更友好，所以你去吧......）*

* * *

现在，最后但并非最不重要的...

要**解决**这个问题`"bunch of errors related to the C++ class keyword and so on"`，正如我在其他视频中对您的评论所做的回复所示，您所要做的就是：

*   转到项目的**构建设置**
*   Apple LLVM Compiler 3.0下**- 预处理**
*   选项**预处理器宏**
*   添加到**Debug**和**Release**：

    ```
    SCI_NAMESPACE SCI_LEXER 
    ```

就是这样。:-)

* * *

***提示：**上面是由 Scintilla 定义的，以避免 C 和非 C 元素之间的冲突，就像上面一样……所以，只需要通知预处理器，其余的就被处理了……*

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-22T09:10:19.777

您将创建一个 objc 类，该类具有您的应用程序所需的接口，然后实现并添加 ivars 并实现——所有这些都在编译防火墙之后，因此 objc++ 源不包含在标头中。您的实现将提供任何必要的转换。

就像您已经完成了一样，但是您从包装器的标头中删除了闪烁标头-它们仅对包装器的实现可见。

**更新**

为了说明一种可能的方法：

**MONScintillaWrapper.h**

```
// no c++/scintilla sources should be included in this header
#import <Foundation/Foundation.h>

@interface MONScintillaWrapper : NSObject

- (void)setBackgroundColor:(NSColor *)pColor;    

@end 
```

**MONScintillaWrapper.mm**

#import "MONScintillaWrapper.h"

```
@implementation MONScintillaWrapper
{
  scintilla::t_thing scintillaThing;
}

- (void)setBackgroundColor:(NSColor *)pColor
{
...convert pColor to a scintilla color and pass that to scintillaThing...
}

@end 
```

# javascript - window.onbeforeunload 未触发

> ID：10266623
> 
> 赞同：2
> 
> 时间：2012-04-22T09:03:21.307
> 
> 标签：javascript

我创建了一个相当重 ajax 的网络应用程序，我正在使用该`window.onbeforeunload`事件来检测用户是否有未保存的更改并阻止她离开页面。该代码由我的 init 函数加载，它曾经在支持该事件的所有浏览器上工作。然而，突然 onbeforeunload 事件无缘无故地停止在每个浏览器上触发。我正在使用 jquery 1.7.1，并且有很多事件附加到各种元素（通过委托或直接）。有谁知道这里可能是什么问题？这是一个代码片段：

```
$(document).ready( function() {
  window.onbeforeunload = function(e) {
    if($(window).data("confirm") > 0)
        return "You have unsaved changes";
    else
        return null;
  };
}); 
```

ps 即使我从回调中完全删除了检查并始终返回一个字符串，它应该每次都提示一条消息，它仍然不会触发。我已经检查了我的浏览器是否可以通过绑定回调的简单页面正确处理该事件。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-22T09:12:17.750

```
<script>
window.onbeforeunload = function (e) {
    e = e || window.event;

    // For IE and Firefox prior to version 4
    if (e) {
        e.returnValue = 'Any string';
    }

    // For Safari
    return 'Any string';
};
</script> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-26T08:09:45.343

造成这种情况的一个可能原因是使用了 jQuery UI 的自动完成功能。从 1.8.17 开始的版本 set `unbeforeunload`，它禁用现有的处理程序。

[http://bugs.jquery.com/ticket/12061](http://bugs.jquery.com/ticket/12061)声称该错误已得到修复，但在我的测试中它仍在 jQuery UI 1.9.2 中。

[http://bugs.jqueryui.com/ticket/8439](http://bugs.jqueryui.com/ticket/8439)提供了一种可能的解决方法。

# c# - 两个富文本框的相同滚动条

> ID：10266625
> 
> 赞同：4
> 
> 时间：2012-04-22T09:03:36.050
> 
> 标签：c#, .net, custom-controls, scrollbar

是否有任何第三方工具可用，它有两个富文本框，但两者只有一个共享滚动条。我需要用两种不同的语言实现一些文本，但两个文本框应该同时滚动。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-27T08:09:02.550

```
 public enum ScrollBarType : uint
    {
        SbHorz = 0,
        SbVert = 1,
        SbCtl = 2,
        SbBoth = 3
    }

    public enum Message : uint
    {
        WM_VSCROLL = 0x0115
    }

    public enum ScrollBarCommands : uint
    {
        SB_THUMBPOSITION = 4
    }

    [DllImport("User32.dll")]
    public extern static int GetScrollPos(IntPtr hWnd, int nBar);

    [DllImport("User32.dll")]
    public extern static int SendMessage(IntPtr hWnd, uint msg, IntPtr wParam, IntPtr lParam);
   // Set the dual scrolling on the richTextbox1 and affects richTextbox2

    private void richTextBox1_VScroll(object sender, EventArgs e)
    {
        int nPos = GetScrollPos(richTextBox1.Handle, (int)ScrollBarType.SbVert); 
        nPos <<= 16;
        uint wParam = (uint)ScrollBarCommands.SB_THUMBPOSITION | (uint)nPos;
        SendMessage(richTextBox2.Handle, (int)Message.WM_VSCROLL, new IntPtr(wParam), new IntPtr(0));
    } 
```

# ios - 在 iPhone 和 iPad 上，我们可以不使用 drawRect 绘制任何东西吗？

> ID：10266628
> 
> 赞同：0
> 
> 时间：2012-04-22T09:04:05.427
> 
> 标签：ios, uiview, uikit

似乎绘制点、线、圆和贝塞尔路径的标准方法是将它们绘制在`drawRect`. 我们不直接调用`drawRect`，而是让iOS调用它，我们可以用来告诉iOS在可以调用的时候`[self setNeedsDisplay]`尝试调用......`drawRect`

看来我们也不能依赖

```
[self setClearsContextBeforeDrawing: NO]; 
```

在调用之前不清除视图的背景`drawRect`。这个问题中有一些细节：[UIView：如何进行无损绘图？](https://stackoverflow.com/questions/865636/uiview-how-to-do-non-destructive-drawing)

直接在屏幕上绘图怎么样 - 无需将这些代码放入`drawRect`. 例如，在 中`ViewController.m`，有一些代码直接在屏幕上绘制点、线、圆。那可能吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T04:17:18.977

无需进入 OpenGL，您可以做的最接近擦除的方法是使用[CGBitmapContextCreateImage 之](https://developer.apple.com/library/mac/documentation/graphicsimaging/reference/CGBitmapContext/Reference/reference.html#//apple_ref/c/func/CGBitmapContextCreateImage)类的东西将上下文转换为图像。从那里，您可以将图像保留在内存中（或在必要时将其写入磁盘），然后在重绘视图时，首先将原始图像绘制到上下文中，然后用新内容覆盖它。

# c++ - 仅检索对象的类型

> ID：10266635
> 
> 赞同：0
> 
> 时间：2012-04-22T09:04:37.990
> 
> 标签：c++, oop, rtti, ogre

我正在使用 OGRE，但我遇到了一个与 ORGE 无关的问题，而是我正在处理的一个典型的 C++ 问题。ORGE 只是帮助解决问题的上下文。

有一个宏，例如

```
OGRE_DELETE_T(obj, ExternalClass); 
```

但是，为了调用 delete，我需要传入类的类型作为第二个参数。但是，比如说我有一个 base `class A`，然后`class B`, `class C`,`class D`等。如果我只存储一个`std::vector`指针`A`，但实际上我可能已经将它们实例化为`B`,`C`或 的一些衍生物`A`，我怎么能传递构造到这个宏中的实际类？当我去删除它时，我不知道派生对象是什么类型，我只知道有`class A`指针。

我想也许使用`dynamic_cast`，但是我不喜欢运行时性能，我还需要某种类型的查找表来检查。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-22T09:14:22.320

只需在宏中传递派生对象的类型。`virtual`如果您的基础有析构函数，它将正确删除您的指针。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-22T15:36:36.827

我知道这个问题很老，但这个答案可能对其他人有所帮助。

此宏用于跟踪您的内存，如果您需要在派生类型上使用它，您将不得不稍微妥协一下接口。您可以这样做的一种方法是创建一个适当地删除对象的虚拟函数。在使用 OGRE_ALLOC_T 或 OGRE_NEW_T 时，您必须调用特定的破坏宏，这样用户才能知道这种特殊情况。

```
class Parent
{
public:
    virtual void deleteSelf() = 0;
};

class A : public Parent
{
public:
    virtual void deleteSelf()
    {
        A* p = this;
        OGRE_DELETE_T(p, A);
    }
}; 
```

这样你就可以这样删除它：

```
Parent* p = OGRE_NEW_T(A);
p->deleteSelf(); 
```

# javascript - 总是转换成对象

> ID：10266636
> 
> 赞同：-1
> 
> 时间：2012-04-22T09:04:41.620
> 
> 标签：javascript, json

我可以在 Javascript 中做一些自动转换它的东西吗：

```
var x = 0; 
```

进入以下（但仅在内存中-我不想更改“查看源”）：

```
var x = {Value: 0}; 
```

举个例子：

```
var x = { Value: 0 };

function a(x)    //This function doesn't work if the parameter is not an object, and it would be better if I didn't have to write { Value: 0 }
{
    x.Value++;
}
a(x);
alert(x.Value); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-22T09:13:35.870

这个问题缺乏上下文和细节，但可能会这样做：

```
function transform(x) {
     return { Value : x };
} 
```

接着

```
x = transform(x); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-22T09:12:49.833

查看所有浏览器的[watch](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Object/watch)和[Object.watch() 吗？](https://stackoverflow.com/questions/1029241/javascript-object-watch-for-all-browsers)，例如：

```
var a = function (x) {
    x.value++;
};
var myVariables = {};
myVariables.watch("x", function (prop, oldval, newval) {
                     if (typeof newval !== 'object') {
                         return {"value": newval};
                     };
                 });
myVariables.x = 0;
a(myVariables.x);
alert(myVariables.x.value); 
```

# c++ - C++ 中的编译时间和运行时

> ID：10266637
> 
> 赞同：2
> 
> 时间：2012-04-22T09:04:51.080
> 
> 标签：c++

如果您在函数中创建了一个原始类型的变量，如 int、char、float，您是在运行时还是在编译时创建了该变量？

如果您在函数内部创建了一个对象，您是在运行时还是在编译时创建了该对象？

如果您通过堆分配内存来创建对象，您是在运行时还是在编译时创建该对象？

什么是静态内存分配和动态内存分配？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-22T09:12:11.837

> 如果您在函数内创建了一个原始类型的变量，例如 int、char、float。您是在运行时还是在编译时创建了该变量？

您在运行时创建变量，该变量在函数执行时创建，并在函数完成时销毁。

> 如果您在函数内部创建了一个对象。您是在运行时还是在编译时创建了该对象？

和上面一样。

> 如果您通过堆分配内存来创建对象。您是在运行时还是在编译时创建了该对象？

如果你在堆上创建一个对象，你实际上是在运行时分配内存并返回一个指向它的指针。使用此指针，您可以读取/写入此内存。

静态内存，是只能在运行时读取的内存。

动态内存分配，是指在堆上分配对象并通过指向内存的指针来改变它们。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-01-07T03:52:03.190

不，`const int a=42;`//a 是在编译时创建的，而不是在运行时创建的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-01-22T17:48:25.537

在 C++ 11 上

`constexpr`告诉编译器这是一个**编译**时常量，未分配，在需要时按值使用并进行优化，涉及`constexpr`和/或`const`值的表达式在编译时计算。编译器可以这样做，但我认为甚至不需要`constexpr`分配大对象。

`const`如果没有使用指针，可以在需要时使用 value 来优化在**编译**时分配的

函数内部的全局变量和静态变量在**编译**时分配

函数内的变量通常被放入**堆栈**内存，与传递参数相同，但它们可以驻留在内存中（我猜编译器是免费的）

`new`用运算符（或旧 C 风格）分配的东西`malloc`将驻留在**堆上**，直到被释放

# html - 将我的输入框设置为半透明

> ID：10266640
> 
> 赞同：3
> 
> 时间：2012-04-22T09:05:00.573
> 
> 标签：html, css

我找不到将输入框呈现为半透明的方法。我在背景中有一张图片。我的意思是只有我的输入框的背景必须是半透明的，而不是文本。

任何的想法？

这是我的html代码示例

```
<h2>Connexion</h2>
<div>
    <label for="UserName">Username</label>               
    <input data-val="true" data-val-required="Le nom d&amp;#39;utilisateur est requis" id="UserName" name="UserName" type="text" value="" />                             
</div>
<div>
    <label for="Password">Password</label>
    <input data-val="true" data-val-required="Le mot de passe est requis" id="Password" name="Password" type="password" />              
</div> 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-04-22T09:13:03.147

如果您的意思是您希望能够通过输入框看到背景图像，那么您可以`rgba()`在设置`background-color`时使用`input`：

```
input {
    background-color: rgba(255, 255, 255, 0.5);
} 
```

# client-side - 使用 Ember.js 开发的大型网站

> ID：10266641
> 
> 赞同：5
> 
> 时间：2012-04-22T09:05:01.763
> 
> 标签：client-side, ember.js, robustness

我正在考虑使用 Ember.js 来开发我的新网站。

我不确定社区在大型项目中使用它的稳定性和程度。

1.  你会推荐使用它吗？
2.  你知道使用它的大网站吗？

谢谢，里奥

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-22T10:18:18.137

一个简单的谷歌搜索会给你这些：

1：[Quora：使用 Ember.js 有什么好处？](http://www.quora.com/What-are-the-advantages-of-using-Ember-js)
2：[前 8 个最佳 SproutCore 网站](http://www.appnovation.com/top-8-best-looking-sproutcore-websites)（SproutCore 2.0 最近更名为 Ember.js -[参见 Wikipedia](http://en.wikipedia.org/wiki/SproutCore)）

# git - git clone 永远不会完成

> ID：10266644
> 
> 赞同：7
> 
> 时间：2012-04-22T09:05:33.513
> 
> 标签：git

我正在尝试在 Mac OS Snow Leopard 上使用 git clone。我所做的只是从文档/项目目录中“git clone https:// *** /project.git”。由于某种原因，操作永远不会完成并在“接收文件：”阶段的某个随机点停止（每次复制文件的百分比不同）。难道我做错了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-22T09:35:55.097

我通常在带有“资源锁定”问题的 repos 上看到这种症状，因为某些进程保持对其中一个 git 文件的句柄。

上次是 git repo 直接作为 Dropbox 共享目录的一部分。（这就是为什么我总是建议[在 Dropbox 目录中只共享捆绑包，而不是所有 git 存储库结构本身](https://stackoverflow.com/questions/3632723/git-with-dropbox/3633346#3633346)）

# security - 如何根据 URL 中的单页 ID 限制权限？

> ID：10266652
> 
> 赞同：6
> 
> 时间：2012-04-22T09:07:33.730
> 
> 标签：security, authentication, authorization, pylons, pyramid

我正在尝试在我的网站中实现 Pyramid 的安全功能，但在弄清楚如何使用它时遇到了一些麻烦。

我一直在阅读[本教程](http://docs.pylonsproject.org/projects/pyramid/en/1.3-branch/tutorials/wiki2/authorization.html)和[本示例](http://michael.merickel.org/projects/pyramid_auth_demo/index.html)以及 Pyramid 文档，但我不知道如何为单页 ID 实施授权策略。

例如，我有以下 URL 方案：

```
/pages
/pages/12 
```

`/pages`显然列出了可用的页面，并且`/pages/:id`您可以在页面上阅读/评论。

我读过的文档/示例表明，您可以通过提供`groupfinder`带有组列表的回调来实现组级 ACS。如`editor`、`admin`等。

如何不使用组来获取权限，而是使用基于页面 ID 的权限？

在我上面的 URL 方案中，当用户浏览到时，`/pages`他们必须登录。当他们浏览到时`/pages/:id`，他们必须被授予查看该特定 ID 的访问权限。或者，他们必须是该页面的所有者。

与评论相同。在`/page/:id`页面上，他们可能已被授予查看页面的权限，但无法对其发表评论。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-22T15:49:13.227

这里的基本原则是 Pyramid 的安全机制检查当前上下文的 ACL。在这种情况下，您的页面将是要使用的逻辑上下文。第一步是为页面设置上下文工厂。假设您使用的是 SQLAlchemy 和 URL 调度，这很容易做到。像这样注册您的路线：

```
config.add_route('page', '/pages/{id:\d+}', factory=page_factory) 
```

路径中有一个小技巧，使金字塔检查页面 id 必须是一个数字，因此您不必自己检查。请注意对 *page_factory* 方法的引用。让我们现在定义：

```
def page_factory(request):
    return DBSession.query(Page).get(int(request.matchdict['id'])) 
```

这会从路由中获取页面 id，并使用它在数据库中查找页面。请注意，我们在这里不检查 id 是否可以转换为整数：我们可以摆脱它，因为路由已经直接检查了它。

下一步是在页面上设置 ACL。最简单的方法是向您的 Page 类添加一个**acl**属性：

```
from pyramid import security

class Page(BaseObject):
    @property
    def __acl__(self):
        return [(security.Allow, self.userid, 'view')] 
```

此 ACL 告诉金字塔只有 ID 存储在 page.userid 中的用户才能查看该页面。这里需要意识到的是，每个页面的 ACL 都是不同的：它是根据数据库中的信息为每个页面单独生成的；在这种情况下使用 self.userid。

您现在可以在您的视图上使用*视图*权限：

```
@view_config(route_name='page', context=Page, permission='view')
def page_view(context, request):
    return 'I can see!' 
```

这个例子有一个非常小的页面 ACL，但您可以扩展它以满足您的需要。

还要注意 view_config 的 context=Page 参数：这告诉金字塔这个视图应该只用于上下文是一个页面。如果上下文工厂（本例中的 page_factory）没有找到匹配的页面，它将返回 None 而不是 Page 实例，因此金字塔不会使用此视图。结果金字塔会自动产生一个未找到的错误。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-22T14:48:16.797

*出于本次讨论的目的，我将假设您正在使用 SQLAlchemy 与您的数据库交互。*

如果您有`config.add_route('pages', '/pages/{id}')`，`__init__.py`您可以添加**自定义工厂**来替换/补充您的默认 ACL。例如：

您当前的 ACL 可能如下所示：

```
class RootFactory(object):
    __acl__ = [
        (Allow, Everyone, 'view'),
        (Allow, Authenticated, 'auth'),
    ]

    def __init__(self, request):
        self.request = request 
```

这将允许经过身份验证的用户访问具有“auth”权限的任何视图，并且任何访问您的站点的人都可以访问具有“视图”权限的任何视图。

通过使用**自定义工厂**，您可以绕过您的 RootFactory，或对其进行补充。

**要绕过**，请将原来的 config.add_route 更改为-->`config.add_route('pages', '/pages/{id}', factory=PageFactory)`并创建一个 PageFactory 类，如下所示：

```
class PageFactory(object):
    __acl__ = [
        (Allow, Everyone, 'view'),
        (Allow, Authenticated, 'auth'),
    ]

    def __init__(self, request):
        self.request = request

    from pyramid.security import authenticated_userid
    user_id = authenticated_userid(self.request)

    thispage = DBSession.query(Page).filter(Page.id==self.request.matchdict['id']).first()

    if thispage.user_id == user_id:
        ## Pyramid allows Everyone, Authenticated, and authenticated_userid
        ## (each of these is known as a Principal) to be in the second
        ## position of the ACL tuple
        acl.append((Allow, user_id, 'edit')) 
```

这是假设您的视图具有`permission='edit'`作为其参数之一。

现在，如果您想使用 RootFactory 并用您的**自定义工厂对其进行****补充**，那么您不必重复自己，只需像我在本文开头所展示的那样留下 RootFactory，并从 RootFactory 类继承， 像这样：

 **```
class PageFactory(RootFactory):
    @property
    def __acl__(self):
        acl = super(PageFactory, self).__acl__[:] ##[:] creates a copy

        from pyramid.security import authenticated_userid
        user_id = authenticated_userid(self.request)

        thispage = DBSession.query(Page).filter(Page.id==self.request.matchdict['id']).first()

        if thispage.user_id == user_id:
            acl.append((Allow, user_id, 'edit'))

        return acl 
```

顺便说一下，**groupfinder**非常*有用*，因为您可以简单地将用户放在组中，例如“admin”，并且 admin 组中的所有用户都可以访问您可能想要的视图`permission='whatever'`，`permission='whateverelse'`并且不需要工厂，只需要一个返回当前用户的组列表的 groupfinder。唉，我离题了，因为这不是你想要做的。希望这能回答你的问题。**

# mysql - 如何在mysql中保存链接？

> ID：10266654
> 
> 赞同：4
> 
> 时间：2012-04-22T09:07:45.690
> 
> 标签：mysql

我需要在 mysql 中保存一些链接，但有些链接较小，有些可能非常大。

我必须在 mysql ( varchar, TEXT, ecc ) 中使用什么字段？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-22T09:09:58.933

Varchar 是一个不错的选择。TEXT 用于非常大的数据并存储在表之外。有关更多信息，请阅读 [MySQL 中的 VARCHAR 与 TEXT](https://stackoverflow.com/questions/6404628/when-should-i-use-varchar-instead-of-text-and-vice-versa-in-mysql)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-22T09:12:35.440

大多数带有参数的 url 在 varchar(255) 上是不够的。使用可以占用 65535 个字节的文本就足够了。

```
TINYTEXT    256 bytes    
TEXT    65,535 bytes    ~64kb
MEDIUMTEXT   16,777,215 bytes   ~16MB
LONGTEXT    4,294,967,295 bytes ~4GB 
```

编辑：但是如果您使用 mysql 超过 5.0.3 varchar (255) 限制高于 65535，所以最好使用 varchar(20000) 之类的 url。

> VARCHAR 列中的值是可变长度字符串。在 MySQL 5.0.3 之前，长度可以指定为 0 到 255 之间的值，在 5.0.3 和更高版本中可以指定为 0 到 65,535 之间的值。MySQL 5.0.3 及更高版本中 VARCHAR 的有效最大长度取决于最大行大小（65,535 字节，所有列共享）和使用的字符集

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-22T09:10:33.957

```
varchar(255) 
```

应该可以正常工作。

# javascript - 有没有办法检查是否会发生 CSS 转换？

> ID：10266655
> 
> 赞同：3
> 
> 时间：2012-04-22T09:08:05.587
> 
> 标签：javascript, css, webkit, css-transitions, webkit-transition

我使用 Javascript 对对象进行了转换：

```
$(this).css('transition', 'all 1000ms'); 
```

我听过渡结束事件：

```
$(this).on('webkitTransitionEnd', function() { alert('Transition did finish.'); }); 
```

事件被触发，一切都按预期工作。但是，当元素开始时`left:100px`并且您尝试对其进行动画处理时，`left:100px`该事件永远不会触发，这会导致问题。我将如何解决这个问题？我无法真正检查新值的值，因为

```
$(this).css('transform', 'scale(0.1)'); //only when object is being displayed will return matrix value

scale(0.5) does not equal matrix(0.5, 0, 0, 0.5, 0, 0 ) 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-22T09:28:56.677

如果您的属性相等，则不会发生 webkit-transition，因此`webkitTransitionEnd`不会被解雇！

我做了一个帮手在这里解释：http: [//jsfiddle.net/JtLAX/](http://jsfiddle.net/JtLAX/)

所以你必须在这里为回调函数找到一种不同的方法。

每当触发转换的事件开始时，您可能想要添加一个 setTimeout(function() {}, 1000)。

或者你可以试试这个库，它对于管理转换和设置回调非常有效：

[http://ricostacruz.com/jquery.transit/](http://ricostacruz.com/jquery.transit/)

有了它，你可以简单地

```
$(this).transit({ left: '+=200' }, function() { alert('transition ends' } ); 
```

关于你的主要问题：

### 有没有办法检查是否会发生 CSS 转换？

恕我直言，我认为唯一的解决方案是手动检查样式元素的属性并将它们与过渡进行比较，这非常困难。

# php - 无法执行菜单项（内部错误）[异常] - 将 PHP 版本从 5.3.1 更改为 5.2.9 时

> ID：10266656
> 
> 赞同：44
> 
> 时间：2012-04-22T09:08:09.717
> 
> 标签：php, wampserver, system-error

我在我的 WAMP 服务器中安装了两个 PHP 版本。当我使用 5.3.10 时，我的 wamp 服务器运行良好。但是当我切换到旧版本的 PHP (5.2.9) 时，我的 wamp 服务器托盘图标显示为橙色图标。如果您单击“Put Online”，我会收到以下错误。

我试图将 httpd.conf 中的端口更改为 8855，但仍然遇到同样的错误。如何解决此错误？

> 无法执行菜单项（内部错误）[异常] 无法执行服务操作：服务尚未启动

![沼泽](../Images/e91925528ee60e1953c2a0ac0cf03b4e.png)

![Aestan 托盘菜单](../Images/a0e16ac80f7227990db91141ce539c69.png)

* * *

## 回答 #1

> 赞同：77
> 
> 时间：2012-11-29T06:36:50.617

默认情况下，WAMP 服务器将`80`作为其工作端口。

您可以根据需要更改该端口号...以下是执行此操作的步骤：

*   单击 WAMP 服务器托盘图标
*   点击**阿帕奇**
*   选择**http.conf**

这里记事本将打开...

*   向下滚动，您将看到 WAMP 服务器使用的端口号...
*   将该端口号更改为：

    ```
    #Listen x.x.x.x:8080
    Listen 8080 
    ```

*   保存该文件并重新启动服务...它将正常工作...

*   现在通过键入检查`http://localhost:8080/`。

* * *

## 回答 #2

> 赞同：27
> 
> 时间：2014-07-27T17:57:13.430

如果您使用的是**Windows** ，请尝试以下操作：

1.  按 (Windows+R)
2.  输入“services.msc”并单击“确定”
3.  定位名为“wampapache”的服务

并检查其状态是否为“正在运行”。如果没有，请右键单击>>开始。

希望这可以帮助！

* * *

如果您已从引导服务中删除 WAMP，它将无法正常工作 - 请尝试以下操作：

*   按 (Windows+R)
*   输入“services.msc”并单击“确定”
*   定位名为“wampapache”的服务
*   右键单击`wampapache`并`wampmysqld`单击“属性”
*   并将开始类型更改为`Manual`或`automatic`

这会奏效！

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2013-12-04T04:31:32.517

首先去 Wamp->Apache->Service->Test Port 80

如果它是 Microsoft HTTPAPI / 2.0 的用户

那么解决方法就是手动停止名为**web部署代理服务的服务**

如果您安装了 Microsoft Sql Server，即使 IIS 服务被禁用，它也会保持名为 httpapi2.0 的 Web 服务运行。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2015-09-20T10:59:07.070

可能没有从 Windows 卸载旧版本的服务

1.  卸载运行此命令行的旧版本

    > sc 删除 wampapache

2.  从 wamp 重新安装服务：

    Wamp 托盘图标 -> Apache -> 服务 -> 安装服务

它对我有用，享受！

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2012-06-01T13:43:47.923

1.  就像您安装旧版本的 PHP 一样，对 Apache 也一样。我选择了 2.0.63 版本，然后我能够使用 PHP 5.2.9 运行 WAMP 服务器，没有任何问题。

2.  我还读到 64 位版本的 WAMP 存在问题。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2015-08-31T13:18:04.860

问题是MySQL56服务正在运行，占用了WAMP MySQL的端口。MySQL56服务停止后，WAMP服务器启动成功。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2015-09-20T11:08:25.427

对于正在阅读本文的任何人-> 不再使用 php 5.3，请切换到较新版本的 php，因为 php 5.3 正在使用已弃用的函数。

以下是已弃用的 INI 指令列表。使用这些 INI 指令中的任何一个都会导致在启动时抛出 E_DEPRECATED 错误，因此我建议您使用更新版本进行开发。

```
define_syslog_variables
register_globals
register_long_arrays
safe_mode
magic_quotes_gpc
magic_quotes_runtime
magic_quotes_sybase
Comments starting with '#' are now deprecated in .INI files. 
```

不推荐使用的功能：

```
call_user_method() (use call_user_func() instead)
call_user_method_array() (use call_user_func_array() instead)
define_syslog_variables()
dl()
ereg() (use preg_match() instead)
ereg_replace() (use preg_replace() instead)
eregi() (use preg_match() with the 'i' modifier instead)
eregi_replace() (use preg_replace() with the 'i' modifier instead)
set_magic_quotes_runtime() and its alias, magic_quotes_runtime()
session_register() (use the $_SESSION superglobal instead)
session_unregister() (use the $_SESSION superglobal instead)
session_is_registered() (use the $_SESSION superglobal instead)
set_socket_blocking() (use stream_set_blocking() instead)
split() (use preg_split() instead)
spliti() (use preg_split() with the 'i' modifier instead)
sql_regcase()
mysql_db_query() (use mysql_select_db() and mysql_query() instead)
mysql_escape_string() (use mysql_real_escape_string() instead)
Passing locale category names as strings is now deprecated. Use the LC_* family of constants instead.
The is_dst parameter to mktime(). Use the new timezone handling functions instead. 
```

已弃用的功能：

```
Assigning the return value of new by reference is now deprecated.
Call-time pass-by-reference is now deprecated. 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2017-06-23T05:16:39.593

某些应用程序（如 Skype）使用 wamp 的默认端口：80，因此您必须找出哪个应用程序正在访问此端口，您可以使用[TCP View](https://technet.microsoft.com/en-us/sysinternals/tcpview.aspx)轻松找到它。结束访问该端口的服务并重新启动 wamp 服务器。现在它将起作用。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2019-12-23T08:24:14.830

*   打开**`Task Manager`**
*   转到**详细信息**
*   查找并杀死`Skype...`应用程序

重新启动`WampServer`它应该可以工作

# javascript - 如何打印链接的内容？

> ID：10266657
> 
> 赞同：-1
> 
> 时间：2012-04-22T09:08:36.500
> 
> 标签：javascript, jquery

我希望 jQuery 打印链接的内容。我该怎么办？

以下是我的代码：
**[演示：](http://jsfiddle.net/9zLGZ/)**

```
<a href="#" onclick="window.print(); return false;">Print</a> 
​
$(document).ready(function() {
    $('ul#tools').prepend('<li class="print"><a href="#print">Click me to print</a></li>');
    $('ul#tools li.print a').click(function() {
        window.open('www.google.com');
        window.print();
        return false;
    });
}); ​ 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-22T09:45:32.490

“打印链接的内容”听起来模棱两可。我猜你想要做的是打印另一个网页？如果您在新框架中打开页面并打印它可能会起作用，在我看来[这个问题可能会对您有所帮助](https://stackoverflow.com/questions/7440976/how-ti-print-the-part-of-web-page-using-jquery)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-22T09:50:15.513

您必须调用`print()`正在打开的窗口，而不是运行原始代码的窗口。

```
var foo = window.open(bar, 'bar');
foo.print(); 
```

（如果窗口没有时间加载文档，您可能会遇到时间问题）。

但是，在您的示例中，您似乎正在尝试打开第三方页面（尽管您忘记了`http://`）。[同源策略](http://en.wikipedia.org/wiki/Same_origin_policy)将阻止您访问远程文档的打印方法。

# jquery - jquery div子元素搜索

> ID：10266658
> 
> 赞同：2
> 
> 时间：2012-04-22T09:08:59.997
> 
> 标签：jquery, jquery-selectors

**html:**

```
<div id="a">
    <span></span>
    <img />
</div> 
```

**jQuery：**

```
var a = $("#a").children().find("img"); 
```

它的显示`a.length = 0`。这里有什么问题？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-22T09:10:50.777

用这个：

```
$("#a").find("img"); 
```

`find`搜索选择器`<img>`的后代，并且不是任何`<div id="a"`> 直接子代的后代。

`find` [文档](http://api.jquery.com/find/)：

> 描述：获取当前匹配元素集中每个元素的**后代**，由选择器、jQuery 对象或元素过滤。

[**现场演示**](http://jsfiddle.net/JPw9T/)

请注意，您可以使用更高效的选择器获得相同的结果：

```
$("#a img")... 
```

`descendant`选择器[文档](http://api.jquery.com/descendant-selector/)：

> 描述：选择作为给定祖先的后代的所有元素。

[**现场演示**](http://jsfiddle.net/JPw9T/1/)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-04-22T09:13:59.633

**children**函数获取 div的所有子节点，然后**find** one 尝试查找名为“img”的子节点的后代。显然那是不存在的。正如 gdoron 指出的那样，您需要省略 children() 部分。

如果您不知道，请查看 JQuery 文档，这是一个非常好的参考：

[http://api.jquery.com/category/traversing/](http://api.jquery.com/category/traversing/)

# android - 发送 JSON 请求 - JQuery 模拟

> ID：10266661
> 
> 赞同：1
> 
> 时间：2012-04-22T09:09:35.127
> 
> 标签：android, json

我需要发送一个类似于 jQuery 的 ajax 方法的 JSON 请求。

data 参数的官方 [文档](http://www.xyzws.com/Javafaq/how-to-use-httpurlconnection-post-data-to-web-server/139)引用说：

> 如果 value 是一个 Array，jQuery 会根据传统设置的 value 序列化多个具有相同 key 的值

所以我有同样的情况 - 一个映射到数组**"parameters":[123123, {"category":"123"}]的键**

完整的数据参数看起来像

```
$.ajax({
     url: "/api/",
     data: {"parameters":[123123, {"category":"123"}], "anotherParameter":"anotherValue"} 
```

您介意告诉如何在 Java 中实现相同的功能吗？

升级版：

我已经使它可以使用 gson + 集合 + 发布请求。

以下是一些指导方针：

*   在 JAVA 中发送[POST 请求。](http://www.xyzws.com/Javafaq/how-to-use-httpurlconnection-post-data-to-web-server/139)
*   您可能还需要考虑与不同类型的 json 解析器相关的[性能问题](http://martinadamek.com/2011/02/04/json-parsers-performance-on-android-with-warmup-and-multiple-iterations/)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-22T09:56:30.363

到目前为止，您尝试了什么，问题到底是什么？是您不知道如何创建连接，您不知道如何序列化您的对象，还是您不知道如何使事物异步运行？

我认为 Java 没有任何异步 HTTP 调用方法，您需要使用常规 URLConnection 并在单独的线程中运行它。连接本身是这样形成的：

```
URL url = null;
URLConnection urlConnection = null;
String myURL = "http://example.com/ajax.php?foo=bar";
try {
    url = new URL(myURL);
    urlConnection = url.openConnection();
} catch (Exception e) {
    e.printStackTrace();
    return;
}
InputStream responseStream = null;
try {
    responseStream = urlConnection.getInputStream();
} catch (IOException e) {
    e.printStackTrace();
    return; 
} 
```

然后，您必须使用[AsyncTask 类](http://developer.android.com/reference/android/os/AsyncTask.html)之类的东西来使其成为后台作业。

要将您的对象转换为 JSON，您可能需要使用[GSON 库](http://code.google.com/p/google-gson/)。

# c# - Silverlight 网站未完全加载

> ID：10266665
> 
> 赞同：0
> 
> 时间：2012-04-22T09:10:29.363
> 
> 标签：c#, javascript, .net, silverlight, browser

有一个名为[http://hattrick.cognizant.com](http://hattrick.cognizant.com)的站点，它由一个 Silverlight 应用程序组成。该站点在除我之外的所有其他系统中开放。

我收到以下异常：

```
Uncaught Error: Unhandled Error in Silverlight Application String was not recognized as a valid DateTime.
   at System.DateTimeParse.Parse(String s, DateTimeFormatInfo dtfi, DateTimeStyles styles)
   at System.Convert.ToDateTime(String value, IFormatProvider provider)
   at System.String.System.IConvertible.ToDateTime(IFormatProvider provider)
   at System.Convert.ToDateTime(Object value)
   at Hattrick.ViewModel.ScoreBoardViewModel.LoadMatchDetails(Object parameter)
   at Hattrick.ViewModel.DelegateCommand.Execute(Object parameter)
   at System.Windows.Interactivity.InvokeCommandAction.Invoke(Object parameter)
   at System.Windows.Interactivity.TriggerBase.InvokeActions(Object parameter)
   at System.Windows.Interactivity.EventTriggerBase.OnEvent(EventArgs eventArgs)
   at System.Windows.Interactivity.EventTriggerBase.OnEventImpl(Object sender, EventArgs eventArgs)
   at System.Windows.Controls.SelectionChangedEventHandler.Invoke(Object sender, SelectionChangedEventArgs e)
   at System.Windows.Controls.Primitives.Selector.OnSelectionChanged(SelectionChangedEventArgs e)
   at System.Windows.Controls.Primitives.Selector.InvokeSelectionChanged(List`1 unselectedItems, List`1 selectedItems)
   at System.Windows.Controls.Primitives.Selector.SelectionChanger.End()
   at System.Windows.Controls.Primitives.Selector.SelectionChanger.SelectJustThisItem(Int32 oldIndex, Int32 newIndex)
   at System.Windows.Controls.Primitives.Selector.OnSelectedValuePropertyChanged(Object value)
   at System.Windows.Controls.Primitives.Selector.OnSelectedValuePropertyChanged(DependencyObject d, DependencyPropertyChangedEventArgs e)
   at System.Windows.DependencyObject.RaisePropertyChangeNotifications(DependencyProperty dp, Object oldValue, Object newValue)
   at System.Windows.DependencyObject.UpdateEffectiveValue(DependencyProperty property, EffectiveValueEntry oldEntry, EffectiveValueEntry& newEntry, ValueOperation operation)
   at System.Windows.DependencyObject.RefreshExpression(DependencyProperty dp)
   at System.Windows.Data.BindingExpression.SendDataToTarget()
   at System.Windows.Data.BindingExpression.SourcePropertyChanged(PropertyPathListener sender, PropertyPathChangedEventArgs args)
   at System.Windows.PropertyPathListener.ReconnectPath()
   at System.Windows.PropertyPathListener.RaisePropertyPathStepChanged(PropertyPathStep source)
   at System.Windows.PropertyAccessPathStep.RaisePropertyPathStepChanged(PropertyListener source)
   at System.Windows.CLRPropertyListener.SourcePropertyChanged(Object sender, PropertyChangedEventArgs args)
   at System.Windows.Data.WeakPropertyChangedListener.PropertyChangedCallback(Object sender, PropertyChangedEventArgs args)
   at System.ComponentModel.PropertyChangedEventHandler.Invoke(Object sender, PropertyChangedEventArgs e)
   at Hattrick.ViewModel.ScoreBoardViewModel.RaisedPropertyChanged(String property)
   at Hattrick.ViewModel.ScoreBoardViewModel.hattrickClient_GetMatchDatesCompleted(Object sender, GetMatchDatesCompletedEventArgs e)
   at Hattrick.HattrickService.HattrickServiceClient.OnGetMatchDatesCompleted(Object state) 
```

我没有制作这个网站。我的系统配置有问题吗？

我的配置

```
 OS         : Windows 7
 Silverlight: Version 5 latest 64bit
 Browser    : Chrome (Not working in any browser) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-22T09:26:21.873

如果站点在您知道的所有系统上正常打开，但您的系统除外，并且错误消息如下：

Silverlight 应用程序字符串中的未处理错误未被识别为有效的 DateTime。

很可能我认为这可能是与日期和时间相关的当地文化环境的差异。可能开发人员不会使用您拥有的格式来排除日期时间字符串，因为您有其他或特定的文化设置

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-22T10:10:32.017

得到答案 OS Language is in English(India) 更改为 English(United States) 因此出现有关日期时间格式的异常

# freebsd - 回声打印服务器；无法从 python 连接

> ID：10266669
> 
> 赞同：1
> 
> 时间：2012-04-22T09:11:22.993
> 
> 标签：freebsd, audio-fingerprinting, echoprint

我正在尝试设置 Echoprint 服务器。像往常一样，我按照所有说明进行操作，但它不起作用。

我开始了`solr`，然后我开始了东京暴君。但是当我尝试通过 Python 脚本访问这个东西，或者当我启动 Python 服务器并尝试通过 HTTP 访问它时，我得到了同样的错误：

```
>>> 导入 fp
>>> fp.ingest（{“track_id”：“my_track_id”，“fp”：“123 40 123 60 123 80 123 90 123 110 123 130”，“长度”：“120”，“编码器”：“4.11” })
连接错误。还剩 4 次尝试；重试...
重新连接时出错。我要等一分钟让 solr 重新启动。如果它不回来，那就有问题了。
回溯（最近一次通话最后）：
  文件“”，第 1 行，在
  摄取中的文件“fp.py”，第 584 行
    host.add_many（文档）
  文件“solr.py”，第 798 行，在 add_many
    返回 self._update(xstr, addHandler=addHandler)
  _update 中的文件“solr.py”，第 923 行
    rsp = self._post(self.path + addHandler + self.invariant, request, self.xmlheaders)
  _post 中的文件“solr.py”，第 1043 行
    self._reconnect()
  _reconnect 中的文件“solr.py”，第 982 行
    self.conn.connect()
  文件“/usr/local/lib/python2.6/httplib.py”，第 720 行，在连接中
    自我超时）
  文件“/usr/local/lib/python2.6/socket.py”，第 561 行，在 create_connection
    引发错误，味精
socket.error：getsockaddrarg：坏家庭

```

有什么办法可以解决这个问题吗？

PS。我在 FreeBSD 8.2、Java 1.6、Python 2.6 上运行它

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-22T18:30:25.257

你运行 IPv6 吗？

你编译了支持 IPv6 的 python 吗？

似乎您正在通过 IPv6 连接到服务，但某些内容不支持 IPv6

# ios - 在 viewDidLoad() 和 eventmethod() 中调用 performSelectorOnMainThread() 有什么区别？(IOS)

> ID：10266687
> 
> 赞同：0
> 
> 时间：2012-04-22T09:13:26.713
> 
> 标签：ios, multithreading, performselector

```
//viewcontroller.m

-(void)viewdidLoad
{
   self.theOneViewController= [[TheOneViewController alloc]init];
  [contentsView addSubview:self.theOneViewController.view];
}

//theOneViewController

- (void)viewDidLoad
{          .
           .
           .
       //UI WORK
           .
           .
    //LONG WORK  
[self performSelectorOnMainThread:@selector(initAppList) withObject:nil waitUntilDone:NO]; 
```

}

这段代码，在 LONG WORK 结束之前查看显示 UI WORK。所以我可以有一个线程效果。

```
//viewcontroller.m

-(void) buttonPressed:(id)sender    -> event method
{
 self.theOneViewController= [[TheOneViewController alloc]init];
 [contentsView addSubview:self.theOneViewController.view];
}

 //theOneViewController
 - (void)viewDidLoad
 {         .
           .
           .
      //UI WORK
           .
           .
  //LONG WORK 
  [self performSelectorOnMainThread:@selector(initAppList) withObject:nil waitUntilDone:NO]; 
 } 
```

在此代码中，在 LONG WORK 结束后查看显示 UI WORK。所以我不能有线程效果。为什么？我使用 (performSelectorInBackground:withObject:) 而不是 (performSelectorOnMainThread withObject:waitUntilDone:) 。但这比不使用线程要慢。

我想在事件方法调用中产生线程效果。有什么好办法吗？请帮帮我！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-22T09:25:03.433

你的问题不是特别清楚，但我会尝试回答。

您正在`performSelectorOnMainThread:withObject:waitUntilDone:`从您的`viewDidLoad`或`buttonPressed`方法调用。这样做的问题是所有 UI 处理（`viewDidLoad`、UI 事件等）都是在主线程上完成的，这意味着调用`performSelectorOnMainThread`只会在主线程 runloop 上对方法进行排队。这可能意味着该方法将在调用方法完成后立即运行。

最终，与直接调用方法相比，您并没有真正获得太多收益，因为主线程将花费大约相同的时间来完成任何一种方式。

调用`performSelectorOnBackgroundThread:withObject:`将在单独的线程上运行该`initAppList`方法，从而允许主线程继续处理 UI。但是，正如您所注意到的，总体上这可能会慢一些，因为创建后台线程会产生开销。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-22T09:25:16.497

首先，`viewDidLoad`只会在主线程上调用，所以你不必调用`performSelectorOnMainThread:`

其次，如果你打算在后台做一些耗时的工作，那么在任何显式线程之前尝试[GCD](http://developer.apple.com/library/ios/#documentation/Performance/Reference/GCD_libdispatch_Ref/Reference/reference.html)

```
dispatch_async(dispatch_get_global_queue( DISPATCH_QUEUE_PRIORITY_HIGH, 0),^ {
    // long work
}); 
```

# jquery - 忽略来自 Mouseover 元素的子元素的 Mouseout 事件

> ID：10266694
> 
> 赞同：2
> 
> 时间：2012-04-22T09:14:43.613
> 
> 标签：jquery, mouseevent, mouseover, event-bubbling, dom-events

我需要在鼠标悬停时显示图像的工具提示。我为此编写了以下代码。我当前的问题是，当我将图像放入工具提示 div 时，该事件仅针对图像元素发生。如何忽略来自父工具提示 div 的子元素的 mouseover 和 mouseout 事件？

```
$("document").ready(function() {
        $('.tooltip').mouseover(function(e){
            var id = $(this).siblings('.tooltip-c').attr('id');
            $('.tp'+id).fadeIn(500);
            $('.tp'+id ).mouseout(function(event){
                $('.tp'+id).fadeOut(300);
            });
        });
    }); 
```

请大家帮帮我。我很无奈。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-04-22T12:43:03.813

尝试使用[.mouseenter()](http://api.jquery.com/mouseenter/)和[.mouseleave()](http://api.jquery.com/mouseleave/)代替。它们处理事件冒泡的方式与`.mouseover()`和不同`.mouseout()`。我认为它应该可以解决您的问题：

```
$("document").ready(function() {
  $('.tooltip').mouseenter(function(e){
    var id = $(this).siblings('.tooltip-c').attr('id');
    $('.tp'+id).fadeIn(500);
    $('.tp'+id ).mouseleave(function(event){
      $('.tp'+id).fadeOut(300);
    });
  });
}); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-22T09:32:42.917

您可以`.stopPropagation()`在事件处理函数中使用事件方法。

```
$("document").ready(function() {
    $('.tooltip').mouseenter(function(event){
        var id = $(this).siblings('.tooltip-c').attr('id');
        $('.tp'+id).fadeIn(500);
        event.stopPropagation(); 
     });
}); 
```

# javascript - 刷新浏览器客户端而不访问服务器

> ID：10266698
> 
> 赞同：1
> 
> 时间：2012-04-22T09:15:08.320
> 
> 标签：javascript

我想在不访问服务器的情况下刷新浏览器窗口，我猜 javascript 是一个好方法吗？我有以下代码，但我不确定它到底在做什么！

```
<body onload="JavaScript:AutoRefresh(5000);">

<script type="text/JavaScript">
<!--
        function AutoRefresh(t) {
            setTimeout("location.reload(true);", t);
        }
//   -->
</script> 
```

如果那只是刷新浏览器客户端，那很好，但如果不是，我应该怎么做？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-22T09:20:13.843

两者`<meta http-equiv="refresh" content="5" />`（每 5 秒刷新一次）和`window.location.reload`刷新浏览器客户端但从服务器获取数据。

在从服务器获取数据时，无法刷新或重新加载页面。如果您想像清除 HTML5 画布一样进行客户端刷新，您必须采用特定的方法，例如设置宽度用于清除画布，以及根据您的需要为其他对象设置其他方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-22T09:33:45.227

> 我想在不点击服务器的情况下刷新浏览器窗口

根据定义，你不能。刷新页面意味着从服务器请求新版本。

# wpf - 无法聚焦或选择属于 DataTemplate 的文本框

> ID：10266701
> 
> 赞同：2
> 
> 时间：2012-04-22T09:15:46.777
> 
> 标签：wpf, textbox

我正在尝试为办公室员工创建一个日程安排应用程序。所有有关 Time In 和 Time Out 的信息都将使用我正在尝试构建的界面来填充。这给我们带来了手头的问题。我有一个 DataTemplate，我将其用作 Reuseable ContentControl 的一部分。我创建了这些控件的列表并将它们添加到 StackPanel。最后，我将该堆栈面板放入另一个堆栈面板。我的问题是我无法聚焦或选择三个深度的文本框。有时我可以选择第一个内容控件的第一个 TextBox，然后我可以 TAB 到下一个 TextBox。但我不能直接选择第二个或第一个文本框之后的任何文本框。甚至第一个文本框也感觉有一半被阻止了，因为我必须单击其中心的左侧才能选择它。

我尝试将内容控件直接添加到 RootLayout 中，它可以工作。我还尝试通过将 ContentControl 直接添加到第一个堆栈面板（我的主窗口中的那个）中来删除第二层堆栈面板，它也可以工作（我认为）。

有什么想法吗？如果你们需要更多信息或代码的更多细节，请告诉我。

这是数据模板：

```
 <DataTemplate x:Key="scheach">
    <Grid Width="94" Background="#FF575A5E" HorizontalAlignment="Left" Height="58" VerticalAlignment="Top" MouseDown="Grid_MouseDown">
        <Grid.RowDefinitions>
            <RowDefinition Height="0.489*"/>
            <RowDefinition Height="0.511*"/>
        </Grid.RowDefinitions>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="0.514*"/>
            <ColumnDefinition Width="0.486*"/>
        </Grid.ColumnDefinitions>
        <TextBox Margin="3,2,2.299,0" TextWrapping="Wrap" Text="{Binding ATimeIn}" FontSize="13.333" BorderBrush="#FF1A2FE0" Height="24" VerticalAlignment="Top" HorizontalAlignment="Stretch" Width="Auto" IsEnabled="False"/>
        <TextBox Margin="0.701,2,0,0" TextWrapping="Wrap" Text="{Binding ATimeOut}" FontSize="13.333" BorderBrush="#FF1A2FE0" Width="43" HorizontalAlignment="Left" d:LayoutOverrides="Width" Height="24" VerticalAlignment="Top" IsEnabled="False" Grid.Column="1"/>
        <TextBox Margin="3,2.053,2.299,2.204" Grid.Row="1" TextWrapping="Wrap" Text="TextBox"/>
        <TextBox Margin="0.701,2.053,1.983,2.204" Grid.Row="1" TextWrapping="Wrap" Text="TextBox" Grid.Column="1"/>
    </Grid>
    </DataTemplate> 
```

下面是创建内容控件的代码：

```
public ContentControl GetEachInAndOut(EachSch sch,DateTime date)
    {
        ContentControl cont = new ContentControl();
        cont.DataContext = sch;
        cont.ContentTemplate = (DataTemplate)win.FindResource("scheach");
        return cont;
    } 
```

将此内容控件添加到堆栈面板的代码：

```
 //function called for each user
  public StackPanel GetWeek(DateTime start, DateTime end)
    {
        StackPanel stack = new StackPanel();
        stack.Orientation = Orientation.Horizontal;
        stack.Width = win.Width - 30;
        stack.Margin = new Thickness(2);

        while (true)
        {
            EachSch each = new EachSch();
            stack.Children.Add(GetEachInAndOut(each, temp));
            temp = temp.AddDays(1);
            if (temp == end.AddDays(1))
                break;

        }

        return stack;        
    }
  } 
```

主窗口中的最终代码：

```
this.stackPanel1.Children.Add(master.GetWeek(DateTime.Now, DateTime.Now.AddDays(6))); 
```

上面的函数在每个用户上调用，最后我有 1+ 个堆栈面板；我将这些添加到正在我的窗口中显示的另一个堆栈面板。

2012 年 4 月 22 日更新：仍然没有运气。我尝试在堆栈面板中创建多个 ItemsControl 而不是 ContentControls。我将该 ItemsControl 添加到我窗口中的包装面板中。现在我可以单击每个列表框的前两项，但所有其他项仍然不可单击且不可编辑。

2012 年 4 月 22 日下午 6:12 更新：计划 Q；我正在尝试使用以下模板解决我的问题。似乎实现了我的目标，我可以更改和编辑文本框，但我最初遇到的问题仍然存在。关于这个问题，我将其更改`ContentControl`为`UserControl`但没有运气。我终于在 Windows.Forms 应用程序中创建了一个用户控件，并使用 WindowsFormHost 导入到 WPF 中。它有效，但是..不...我不想走那条路。

```
<ListBox Height="271" HorizontalAlignment="Left" Margin="12,47,0,0" Name="listBox1" VerticalAlignment="Top" Width="814" >
            <ListBox.ItemTemplate>
                <DataTemplate>
                    <Grid>
                        <TextBlock Text="{Binding Barcode}" />
                        <ItemsControl ItemTemplate="{StaticResource scheach}" ItemsPanel="{StaticResource paneltemp}" ItemsSource="{Binding Days}">
                        </ItemsControl>
                    </Grid>
                </DataTemplate>
            </ListBox.ItemTemplate>
        </ListBox> 
```

# android - android中的getPackageInfo（packageName，0）返回没有信息的对象

> ID：10266704
> 
> 赞同：-1
> 
> 时间：2012-04-22T09:16:08.227
> 
> 标签：android, version

特别是我想检查的 versionName 和 versionCode。一个为空，另一个为0。包名是正确的。我验证了，有什么想法吗？

```
final PackageManager pm = getPackageManager();
        final String packageName = getPackageName();
        if (getMyApp().getURL() == URLS.PROD && getMyApp().IS_CHECK_VERSION == 1) {
            try {
                new Thread() {
                    public void run() {
                        HttpURLConnection conn = null;
                        String responseString = null;
                        try {
                            String versionName = "1.0";
                            try {
                                PackageInfo pi = pm.getPackageInfo(packageName, 0);
                                versionName = pi.versionName;
                            } catch (NameNotFoundException e) {
                                e.printStackTrace();
                            } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-23T12:58:50.510

好的，找到了。你们无法看到它，因为您没有我的清单……构建系统意外地将 android:versionName 更改为 android.versionName。所以没有定义 versionName。奇怪的是，连林特都没有看到。

:-( 愚蠢，仅此而已。

# content-management-system - CMS 变得简单，包括文件在内的麻烦

> ID：10266705
> 
> 赞同：2
> 
> 时间：2012-04-22T09:16:14.843
> 
> 标签：content-management-system, php, cmsmadesimple

在用户定义的标签中使用 php include() 我有一点问题。就像在 cmsms 手册中描述的那样，您可以通过用户定义的标签将 php 代码添加到您的 cmsms 页面中。我很努力，但它不起作用。这是我只想添加的代码：

```
<?php
    $site="true";
    include("/home/www/web23/html/wbt/index.php");
?> 
```

我收到此错误：

```
Warning: include(wp.php) [function.include]: failed to open stream:
   No such file or directory in 
    C:\xampp\htdocs\cmsms\lib\classes\class.usertagoperations.inc.php(260) :
     eval()'d code on line 1 
Warning: include() [function.include]: Failed opening 'wp.php' for inclusion 
   (include_path='.;C:\xampp\php\PEAR')
     in C:\xampp\htdocs\cmsms\lib\classes\class.usertagoperations.inc.php(260) :
      eval()'d code on line 1 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-22T10:00:37.833

尝试删除`/home/www/`

它不应该有任何区别。至少在 Windows 中没有

# php - 如何从日期获取当天的数字？

> ID：10266706
> 
> 赞同：6
> 
> 时间：2012-04-22T09:16:23.223
> 
> 标签：php, date, formula

如何从php中的日期获取当天的数字？
例如：给出日期格式：**2012**年 4 月 23 日，它输出**1**或**monday**或**mon** ...

谢谢你！

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-04-22T09:20:37.557

尝试类似：

```
<?php

$rawDate = '4/23/2012';

echo date('N', strtotime($rawDate));
?> 
```

在这里演示：http: [//ideone.com/jICqh](http://ideone.com/jICqh)

查看[PHP 的`date()`函数](http://php.net/manual/en/function.date.php)文档以了解更多格式化日期的方法。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-04-22T09:19:58.807

```
$date = '2007/08/30'; 
$weekday = date('l', strtotime($date)); // note: first arg to date() is lower-case L 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-22T09:19:02.643

[http://php.net/manual/en/function.date.php](http://php.net/manual/en/function.date.php)

```
echo date("l", mktime(0, 0, 0, 4, 23, 2012)); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-22T09:19:19.027

这取决于您想要的数字，当月的天数或实际年份的天数。有关详细信息，请参阅[日期功能](http://php.net/manual/en/function.date.php)。

# git - 在 Git 中管理并行版本的最佳方法是什么？

> ID：10266712
> 
> 赞同：9
> 
> 时间：2012-04-22T09:17:20.083
> 
> 标签：git, git-branch

我有一个完善的软件工具包，但通常需要进行一些小调整（主要是为了应对来自 3rd 方产品的兼容性问题）。我现在希望制作一个“新”版本（改进的 API），它将基于原始版本 - 随着时间的推移，这将与现有分支有所不同，但几年后，我需要保持原始的“实时”版本需要它以实现兼容性的现有客户。当然，我**还**需要确保*“调整”*也适用于“新”版本，因为这些问题（在**大多数**情况下！）也适用于“新”版本。

所以 - 我理想的（简单）工作流程是：

1.  在处理“新”版本时 - 更改仅适用于该版本。
2.  在处理“旧”版本时，一旦我对它们感到满意（当我提交、提交或其他方式时），所有产生的更改都会（尽可能自动地！）应用于两个版本。

我意识到偶尔需要手动干预，合并发生冲突，但根据过去手动更改的经验，我预计这种情况很少见。

目前，我希望放弃 VSS（是的 - 继续嘲笑我保留这么久！），我希望 Git 能让这变得简单，但到目前为止，似乎没有任何“简单“解决方案，我所看到的所有建议都是围绕“rebase”构建的，这对我来说似乎是“错误的”，因为 rebase 似乎做了许多其他事情，比如重写历史，而我所需要的只是一个简单、真实的“前进”基于来自另一个分支的更改。

*   我在这里错过了什么吗？
*   有没有更简单、正确定义的方法来做到这一点？
*   使用不同的源代码控制系统而不是 Git 会更好吗？

非常感谢所有想法！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-22T09:24:21.830

您可以将旧分支中的更改合并到新版本。

让我详细说明一下 rebase：除非您是唯一一个在代码库上工作的开发人员，否则我不建议您使用 rebase 来解决这个特定问题。请记住，仅在您重写历史记录后才建议将 rebase 用于**私有分支**，从而使任何以 rebase 提交作为祖先的提交无效。

如果您将旧版本分支更改重新定位到新版本，那么每次您需要将更改从旧版本带到新版本时，您将不断重写新版本分支的历史记录。这意味着在新版本中使用基础完成的任何工作，例如新版本独有的功能的功能分支将丢失，因为原始提交不再存在。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-22T19:13:56.463

看看[Git flow](http://nvie.com/posts/a-successful-git-branching-model/) - 一种使用支持​​它的工具来分支这些功能的方法。基本上，对于每一个新的“调整”，你都在一个新的分支上执行它，该分支植根于你正在维护的分支的共同祖先/之前，然后你将它合并到每个分支。

# django - Django 无法显示具有单独 CSS、JS 文件的页面

> ID：10266715
> 
> 赞同：0
> 
> 时间：2012-04-22T09:17:47.687
> 
> 标签：django

我已经阅读了一些与静态文件相关的文档，但无法使其正常工作。我在我的计算机上使用 runserver 进行测试。我的 html 位于此目录：C:\mytemplates\polls\t3.html。t3.html 使用放在 my_static_files 下的 js 和 css 文件。那么 Django 静态设置应该是什么，my_static_files 应该放在哪里？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-22T09:44:53.600

由于您没有确切指定，我将假设您的静态文件是 C:\my_static_files\

如果是这样，您的设置应如下所示：

```
STATIC_URL = '/static/'
STATIC_ROOT = 'C:\my_static_files\' 
```

在您的模板中，您可以使用 {{STATIC_URL}} 加载您的静态文件：

```
<link rel="stylesheet" type="text/css" href="{{STATIC_URL}}css/your_style.css" />
<script type = "text/javascript" src = "{{STATIC_URL}}/js/your_script.js"></script> 
```

如果您将子文件夹 js 和 css 命名为不同，请相应地更改链接。如果它仍然不起作用，请检查并仔细检查您的前导和尾随斜杠。

正如您提到的，使用 {{STATIC_URL}} 不会返回任何内容，我必须添加以下内容：为了能够使用 {{STATIC_URL}}，您必须将 RequestContext 传递给您的模板。您可以在从视图返回响应时执行此操作，方法是将它传递给这样的 context_instance（即）：

```
from django.template import RequestContext
from django.shortcuts import render_to_response

def some_view(request):
    # your view code here

    return render_to_response(template_name,
                              context, 
                              context_instance=template.RequestContext(request) ) 
```

# android - 如何使用搜索栏在列表视图中获取建议

> ID：10266716
> 
> 赞同：2
> 
> 时间：2012-04-22T09:17:50.787
> 
> 标签：android, android-layout

我已经创建了一个带有搜索栏（edittext）的列表视图，我想使用这个搜索栏从列表中选择项目。我使用了无法解决问题的自动完成文本视图。谢谢你的建议。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-22T09:50:42.863

看看这个：

[http://androidsearchfilterlistview.blogspot.pt/2011/06/android-custom-list-view-filter.html](http://androidsearchfilterlistview.blogspot.pt/2011/06/android-custom-list-view-filter.html)

[如何在 Android 上动态更新 ListView](https://stackoverflow.com/questions/1737009/how-to-make-a-nice-looking-listview-filter-on-android)

你需要的是一个文本过滤器......

希望这对您有所帮助。

# google-maps-api-3 - 是否有任何方法可以在少于定义的标记计数时禁用标记聚类器？

> ID：10266725
> 
> 赞同：1
> 
> 时间：2012-04-22T09:19:02.143
> 
> 标签：google-maps-api-3, markerclusterer

我想要我的标记聚类器；不要将少于 4 个或其他东西的标记聚集在一起。即使是 2 个标记，它也会对所有标记进行聚类。

有没有可能的方法来设置它？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-22T22:48:49.643

MarkerClusterer 没有您想要的选项，但如果您使用名为[MarkerClustererPlus](http://google-maps-utility-library-v3.googlecode.com/svn/trunk/markerclustererplus/docs/reference.html)的增强功能，它是一个选项。它本质上是原始 v2 MarkerClusterer 的 Google Maps v3 升级，然后由 Gary Little 进一步增强和扩展。它的功能与原始 MarkerClusterer 几乎相同，但提供了更多选项。

针对您的问题，您可以将一组选项传递给 MarkerClusterer 构造函数（使用 MarkerClustererPlus 时）并包含一个选项：**minimumClusterSize**。那会给你你想要的。

# javascript - WoopraTracker 未在自定义事件数据中定义

> ID：10266730
> 
> 赞同：0
> 
> 时间：2012-04-22T09:19:51.193
> 
> 标签：javascript, analytics

我正在尝试在页面加载时实现 Woopra 自定义事件数据，并且我正在使用他们的[指南](http://www.woopra.com/docs/tracking/custom-event-data/) 我试图在页面准备好推送事件但它总是让我没有定义 woopratracker，但是当我尝试使用它时 onclick如果它工作正常，我认为加载 woopra 库有延迟，但是我在页面就绪时调用它的函数，这意味着我的调用应该在执行之前等待页面就绪！我有 settimeout 并在 1 秒后调用了相同的函数，它工作正常，但仍然不合逻辑，有什么想法吗？谢谢 ：）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-03T00:31:07.953

你是对的 - 你在页面加载之前调用了 woopraTracker。他们网站上的最新片段是异步的，这意味着如果您在此代码之后立即调用 woopraTracker，它可能会失败，因为它会`wsc.async=true`告诉浏览器继续而不等待此脚本初始化。如果您提前知道要跟踪什么，请将该代码放入 woopraReady。

在这个例子中，这正是他们所做的：[http](http://www.woopra.com/docs/tracking/custom-event-data/) ://www.woopra.com/docs/tracking/custom-event-data/ 。看起来您已经找到了这个文档，但是您是否将代码放入`woopraReady`并使用局部`tracker`变量而不是全局变量`woopraTracker`？`woopraReady`脚本加载后将被调用，因此您不会遇到遇到的问题。

如果你有其他跟踪事件的东西，如果`woopraTracker.trackEvent()`脚本没有加载，因为用户真的很快或者因为 woopra 加载错误，包装起来也没有什么坏处。

您可以定义自己的包装器，而不是直接调用 woopraTracker：

```
var pushWoopraEvent = function(e) {
  // Don't screw us over if Woopra failed to load or hasn't loaded yet
  if (typeof woopraTracker === 'object') {
    woopraTracker.pushEvent(e);
  }
};
pushWoopraEvent({name: 'Rate Song', stars: 5}); 
```

# c# - C#：将字段定义为私有但在泛型中可修改

> ID：10266731
> 
> 赞同：2
> 
> 时间：2012-04-22T09:19:51.413
> 
> 标签：c#, generics, interface, encapsulation

`private`有没有办法使用包含类的泛型将字段定义为但仍可在方法中修改？

（为问题的长度道歉；我正在努力确定我在问什么）

具体来说，我目前有三个类`A`, `B`，`C`具有以下要求：

1.  `B`并`C`有一个名为 的字段`name`，但`A`没有
2.  `A`并且`C`有一个方法`Load()`，但`B`没有
3.  集合`B`并在自定义方法中使用，但`C`不使用此方法`name``Add()``A`

这是我目前的解决方案：

```
public class BaseClass
{
    public SomeType Load() { ... }
}

public interface IClass {
    string Name {get; set;}
}

public class MyList : SomeCollection<IClass>
{
    // Depends on x.Name, and may modify Name before adding x to the collection
    public new void Add(IClass x) { ... }
}

public class A : BaseClass { ... }

public class B : IClass { ... }

public class C : BaseClass, IClass { ... } 
```

如果`Name`有一个 public ，这个解决方案对我有用`set`。但是有什么方法可以正确封装`x.Name`以便`Add`可以修改`x.Name`，但`x.Name`不能在 and 的实例中`B`修改`C`？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-22T09:47:42.213

简短的回答是*否定*的。您不能选择性地将成员公开给特定的类，并且`MyList`与`IClass`. 但是，您可以做的是创建一个额外的*内部*接口（或可能使`IClass`内部接口）公开`Name`属性并*显式*实现它。这意味着为了读/写`Name`属性，您需要将一个实例强制转换为内部接口，这只有在它定义的程序集中才有可能。

```
internal interface IClassName { string Name { get; set; } }

public class MyList : Collection<IClass>
{
    protected override void InsertItem(int index, IClass item)
    {
        var className = item as IClassName;
        if (className != null)
        {
            // do something with className.Name ...
        }
        base.InsertItem(index, item);
    }
}

public class B : IClassName { string IClassName.Name { get; set; } } 
```

请注意，我没有使用**new**关键字来绕过基类的`Add`方法，因为这会覆盖多态性（例如，如果您将一个实例强制`MyList`转换`IList<IClass>`为将被调用的原始实现`Add`- 这很糟糕。）相反，我是覆盖`Collection<T>`类中的适当方法，该方法专为集合继承而设计。

# php - Netbeans PHP 项目属性：Web Root 做什么？

> ID：10266736
> 
> 赞同：1
> 
> 时间：2012-04-22T09:20:10.007
> 
> 标签：php, netbeans, project-properties

我有一个 Netbeans PHP 项目，其中代码从 subversion 存储库中检出。源文件文件夹位于我的本地 Web 服务器文档根目录之外。它有三个子文件夹trunk、branches 和tags。分支文件夹有一个子文件夹“我的分支”（比如说），其中包含我正在处理的代码（一个 CodeIgniter 项目）。

我已将项目属性设置为将文件从源文件夹复制到 Web 服务器文档根 (htdocs)。正如我所期望的那样，这会将主干、分支和标签文件夹复制到 htdocs 文件夹中。

但是我真的只想将branchs/my-branch 文件夹的内容复制到htdocs。我认为将“Web Root”属性（在 Project Properties | Sources 上）设置为“branches/my-branch”可能会实现这一点。但是，这似乎并没有像我希望的那样工作。

两个问题：

1.  “Web Root”属性的用途是什么？
2.  我如何（如果有的话）让 NetBeans 做我想做的事？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-22T10:03:15.820

我相信这里最好的选择是为主干和您要处理的每个分支创建一个不同的 Netbeans 项目。

该`Web Root`设置告诉 Netbeans 您的应用程序的根目录在哪里。一些应用程序具有不会在网络服务器上公开的文件夹和文件，但它们仍然是项目的一部分（在您的情况下，将 htdocs 文件夹视为项目中的子文件夹）。`Run`如果您在 Netbeans 中右键单击 PHP 文件并选择(Shift+F6) ，这只是为了让 Netbeans 知道要打开哪个 URL

假设您的项目中有这些文件夹：

```
myconfigfiles\
htdocs\
importantsecretdocuments\ 
```

如果将`Web Root`属性设置为`htdocs`文件夹，您会注意到对于其他两个目录中的任何文件，“右键单击 -> 运行”选项是灰色的。

说你`Project URL`是`http://localhost`。您在 htdocs 文件夹中右键单击的任何文件都将打开该页面`http://localhost/<selectedfile.php>/`。不设置`Web Root`this 会打开 `http://localhost/htdocs/<selectedfile.php>`

# javascript - 需要 javascript 验证器的 if / then 语句

> ID：10266741
> 
> 赞同：1
> 
> 时间：2012-04-22T09:20:41.503
> 
> 标签：javascript

使用 Jquery 验证器，我可以使用以下 if 语句来确保我的表单在继续使用 Ajax 之前有效：

```
var frm = $(this).closest('form');        
        if($(frm).valid()){ 
                 AJAX JQUERY POST INFORMATION GOES HERE
                  }; 
```

现在我正在使用来自[Javascript-Coder.com](http://www.javascript-coder.com/html-form/javascript-form-validation.phtml)的 Javascript 表单验证器。问题是没有任何文档描述了与 valid() 类似的功能或在继续之前检查表单是否有效的方法。我在 javascript 方面受到限制，并且可以真正利用社区的帮助来构建类似的 if 语句。

我运行验证很好，但即使验证失败，我的 ajax 脚本也会继续运行直到完成。在非 ajax 应用程序中，验证效果很好，并且在发布到 php 之前会自动停止。但是对于 ajax，当验证无法让我的用户更正他们的操作时，我似乎无法停止脚本。

[我试着从这里](https://stackoverflow.com/questions/4958773/javascript-input-validation)收集一些东西，但它并没有让我足够接近做一些有用的事情。我尝试了那里提供的一些变化，但我错过了一些东西。

我的验证效果很好，并且是：

```
<script  type="text/javascript">
    var frmvalidator = new Validator("send_message_frm");
    frmvalidator.EnableOnPageErrorDisplay();
    frmvalidator.EnableMsgsTogether();
    frmvalidator.addValidation("desc","alnum","Only numbers and letters are allowed");
    frmvalidator.addValidation("desc","req","Please enter a description");   
</script> 
```

我的 ajax 脚本也可以工作，但如果验证失败，我需要它不运行。这是：

```
$(document).ready(function(){
    //Validate form....what can I put here to test if validation is completed properly????

    //onclick handler send message btn
    $("#send-message").click(function(){
        $(this).closest('form').submit(function(){
            return false;
        });
        var frm = $(this).closest('form');        

            $("#ajax-loading").show();
            var data = $(frm).serialize();
            $(frm).find('textarea,select,input').attr('disabled', 'disabled');            
            $.post( 
                    "company_add.php", 
                    data, 
                    function(data){ 
                        $("#ajax-loading").hide();
                        $(frm).find('textarea,select,input').removeAttr('disabled');
                        $("#send_message_frm").prepend(data);
                    } 
           );
        }
    );
    });
</script> 
```

# php - 从 curl POST 响应中解析 XML

> ID：10266742
> 
> 赞同：3
> 
> 时间：2012-04-22T09:20:49.257
> 
> 标签：php, xml, post, curl, simplexml

我正在使用 curl 将 XML 文件发布到服务器。一切都完美无缺，但我不确定如何以最佳方式处理响应。我想用 simpleXML 解析它。有了这个要求：

```
$ch = curl_init(); 

curl_setopt($ch, CURLOPT_VERBOSE, 1); 
curl_setopt($ch, CURLOPT_URL, $url); 
curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1); 
curl_setopt($ch, CURLOPT_HTTPHEADER, Array("Content-Type: text/xml"));
curl_setopt($ch, CURLOPT_HEADER, 1);
curl_setopt($ch, CURLOPT_TIMEOUT, 40); 
curl_setopt($ch, CURLOPT_POSTFIELDS, $XPost);
curl_setopt($ch, CURLOPT_POST, 1);

$data = curl_exec($ch); 

if(curl_errno($ch))
print curl_error($ch);
else
print_r($data);
curl_close($ch); 
```

我将其作为响应字符串（浏览器源视图）

```
HTTP/1.1 200 OK
Server: Apache-Coyote/1.1
Expires: Sat, 6 May 1995 12:00:00 GMT
Cache-Control: no-store, no-cache, must-revalidate
Cache-Control: post-check=0, pre-check=0
Pragma: no-cache
Set-Cookie: JSESSIONID=5FD40C8D8F5EDC85E57AF39E877BE564; Path=/upp/; Secure; HttpOnly
Content-Type: text/xml;charset=UTF-8
Content-Length: 829
Date: Sun, 22 Apr 2012 08:59:10 GMT

<?xml version='1.0' encoding='UTF-8'?>
<authorizationService version='1'>
<body merchantId='635634545' status='accepted'>
<transaction refno='1234987' trxStatus='response'>
  <request>
    <amount>2000</amount>
    <currency>USD</currency>
  </request>
  <response>
    <responseCode>01</responseCode>
    <responseMessage>Authorized</responseMessage>
  </response>
</transaction> 
```

如何使用 simpleXML 正确解析 $data。我的意思是摆脱标题部分？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-22T09:25:00.020

如果您不需要标题，请设置`CURLOPT_HEADER`为`false`.

# android - 软键盘不显示

> ID：10266744
> 
> 赞同：1
> 
> 时间：2012-04-22T09:21:18.307
> 
> 标签：android, android-intent

我想在选择 EditText 时显示软键盘。我在 EditText 的 onclick 事件处理程序中尝试了这段代码，如下所示：

```
InputMethodManager imm = (InputMethodManager) getSystemService(Context.INPUT_METHOD_SERVICE);
    imm.showSoftInput(txtUserId, InputMethodManager.SHOW_IMPLICIT); 
```

但这没有用:(

请帮助完成单击 EditText 时显示软键盘所需的所有步骤。

问候，

# android - android:eclipse图形布局视图可以看到layer-list

> ID：10266746
> 
> 赞同：0
> 
> 时间：2012-04-22T09:21:28.070
> 
> 标签：android, android-layout, xml-drawable

我正在尝试为可绘制图层构建布局列表

这是我的代码：

```
<?xml version="1.0" encoding="utf-8"?>
<layer-list xmlns:android="http://schemas.android.com/apk/res/android"
android:layout_width="match_parent"
android:layout_height="match_parent" >

<item
    android:drawable="@drawable/sign"
    android:id="@+id/sign"/>
</layer-list> 
```

这是图形布局中的错误：

```
com.android.layoutlib.bridge.MockView cannot be cast to android.view.ViewGroup
Exception details are logged in Window > Show View > Error Log
The following classes could not be found:
- item (Fix Build Path, Edit XML)
- layer-list (Fix Build Path, Edit XML) 
```

请问有人吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-22T10:21:34.737

我将它粘贴到我当前项目的一个新文件中，保存并重建没有故障。您是否清理过项目并尝试重建？

# android - 应用程序在错误的活动上启动

> ID：10266748
> 
> 赞同：0
> 
> 时间：2012-04-22T09:21:48.240
> 
> 标签：android, android-intent, android-activity, launch

似乎我的 Android 应用程序在错误的活动上启动。

AndroidManifest.xml 中的重要部分：

“MainActivity”应该是在应用启动时启动的活动：

```
<activity android:name=".MainActivity" android:label="@string/app_name" >
    <intent-filter>
        <action android:name="android.intent.action.MAIN" />
        <category android:name="android.intent.category.LAUNCHER" />
    </intent-filter>
</activity>
<activity
    android:name="AnotherActivity"
    android:label="@string/app_name">
</activity> 
```

主要活动：

```
public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);

        //display into log that THIS activity is started
        Log.d("tag", "MainActivity");

        //start async task to install the database on first startup
        progressDialog = ProgressDialog.show([params...]);
        new InstallDatabaseTask().execute(this);
}

/**
 * 1\. Installs and initializes the database.
 * 2\. Opens another activity.
 */
private class InstallDatabaseTask extends AsyncTask {

        @Override
        protected Object doInBackground(Object... params) {
            progressDialog.show();

            //open database so it can be installed
            MyOpenHelper helper = new MyOpenHelper((Context) params[0]);
            helper.getWritableDatabase().close();

            //dismiss progress dialog
            MainActivity.this.progressDialog.dismiss();

            //start another activity
            Intent intent = new Intent(MainActivity.this, AnotherActivity.class);
            ((Context)params[0]).startActivity(intent);

            return null;
        }
} 
```

另一个活动：

```
 @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);

        //just make sure this activity was started
        Log.d("tag", "another activity started");   
    } 
```

但日志只显示“另一个活动开始”。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-24T18:07:59.783

从您的代码中，我了解到 android 正在启动正确的活动。

但是在您的 oncreate 方法中，您正在调用异步任务，因此一旦主要活动创建它就会启动异步任务，并且在您的异步任务中，您正在调用以下行

```
//start another activity
Intent intent = new Intent(MainActivity.this, AnotherActivity.class);
((Context)params[0]).startActivity(intent); 
```

因此，只要异步任务完成其任务，它就会启动另一个活动。所以你假设android正在启动错误的活动。但是在内部，您正在启动活动，并且您的异步仅在几微秒内完成，因此您假设启动了错误的活动..

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-22T10:03:34.357

您不能从`doInBackground()`不是 UI 线程的线程访问方法（和其他 UI 小部件）的进度对话框。你应该把它放在`onPostExecute()`.

就像是：

```
private class InstallDatabaseTask extends AsyncTask <Void, Void, Void>{

    @Override
    protected Object doInBackground(Object... params) {
        progressDialog.show();

        //open database so it can be installed
        MyOpenHelper helper = new MyOpenHelper((Context) params[0]);
        helper.getWritableDatabase().close();

        return null;
    }

    @Override
    protected void onPostExecute(Void result){

        //dismiss progress dialog
                    MainActivity.this.progressDialog.dismiss();

                    //start another activity
                    Intent intent = new Intent(MainActivity.this, AnotherActivity.class);
                    ((Context)params[0]).startActivity(intent);
    }

} 
```

我认为您需要在扩展 AsyncTask 时声明参数。

我不确定这是否能解决您的问题，但这是一个提示......

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-22T09:48:53.083

还有一件事，你在 Manifest 文件中声明的 AnotherActivity 有问题，不是吗？

```
<activity
    android:name="AnotherActivity"
    android:label="@string/app_name">
</activity> 
```

我认为它应该有一个点。像

> android:name=".AnotherActivity"

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-04-22T09:36:49.560

在清单中，确保将启动的活动而不是主活动设置为默认值。

类别 android:name="android.intent.category.DEFAULT"

```
 <intent-filter>
            <action android:name="com.game.test.DIRECTOR" />
            <category android:name="android.intent.category.DEFAULT" />
        </intent-filter> 
```

所以它不会作为主要启动。还要检查清单中的意图过滤器，看看它们是否正确或存在。

# mysql - mySql：如何创建具有未知数据类型的表？

> ID：10266749
> 
> 赞同：1
> 
> 时间：2012-04-22T09:22:10.240
> 
> 标签：mysql, types, csv

我希望您能帮助我解决一些我搜索了很多但还没有找到答案的问题。正如问题的标题所述，我正在尝试在 mySql 数据库中创建一个表，其中我不知道列的数据类型。基本上，我使用 php 从 csv 文件在我的数据库中创建新表。第一行包含列名。我知道它可以做到，因为我在 phpMyAdmin 中看到过它，我可以在其中选择一个 csv 文件并使用第一行生成表列名称，并且我不必指定每列的数据类型，

到目前为止，这是我的 php 代码：

```
$databaseName="myDatabase";
mysql_connect("localhost","xxxxxx","xxxxxxxx");
mysql_select_db($databaseName);

for($i = 0; $i < count($newFiles); $i++){//traverse the table that contains the file names
         $content = file($newFileLocation.$newFiles[$i]);

        //First line: $content[0];
        $firstLine=$content[0];//save first line which are the column names
        //echo  $firstLine;
        $tableName= str_replace('.txt','', $newFiles[$i]);//remove the .txt to use for table name
        //echo $tableName."\n";

        echo "\n\ncreating tables\n\n";
        /*mysql_query("load data local infile '$newFiles[$i]' 
               into table $tableName
                   fields terminated by ','
                   lines terminated by '\n'
                   ($firstLine) "); */

        mysql_close();
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-22T12:01:15.563

MySQL 中没有“未知”数据类型（也许 blob 类型最相似）。

如果您确实需要仅根据其名称自动定义表字段，并且不知道将在那里存储哪种类型的数据，请将它们创建为 blob 或文本，并在存储值时创建由其实际类型制成的文本表示形式标题加上值的文本表示。

或者也许你根本不需要那个。检查[使用 PHP 获取 CSV 文件的第一行并使用数据创建一个 MySQL 表，](https://stackoverflow.com/questions/173498/using-php-to-take-the-first-line-of-a-csv-file-and-create-a-mysql-table-with-the)也许您会在那里找到响应。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-22T17:36:02.453

这是问题的解决方案。首先，我们取文件的第一行来保存 cols 名称（以便我们知道如何创建表）。我们将它保存在一个字符串中，然后我们根据逗号字符将它们分开。之后，我们获取包含值的文件的第二行。我们将该行存储到一个字符串中，并根据逗号字符将字符串分隔为不同的值。我们将使用它来识别每列的类型。

所以，这就是代码。

```
$databaseName="myDatabase";
mysql_connect("localhost","xxxxxx","xxxxxxxx");
mysql_select_db($databaseName);

for($k = 0; $k < count($newFiles); $k++){//traverse the table that contains the file names
            $content = file($newFileLocation.$newFiles[$k]);

            //First line: $content[0];
             $firstLine=$content[0];
             $secondLine=$content[1];   
            //echo $firstLine."\n";
            $firstLine = str_replace("\r\n",'',$firstLine);
            $colNames=explode(',',$firstLine);
            $fieldList = explode(',',$secondLine);

            $dataType="";
            for($i = 0; $i < count($fieldList); $i++){
                if (is_numeric($fieldList[$i])){
                        if (strpos($fieldList[$i],'.') == false){
                            $fieldList[$i] = (int)$fieldList[$i];
                       }else{
                            $fieldList[$i] = (float)$fieldList[$i];
                        }
                    }

                switch(gettype($fieldList[$i])) {
                        case 'integer':
                            $typeInfo = 'int(11)';
                            break;
                        case 'float':
                        case 'double':
                                $typeInfo = 'float';
                                break;

                        case 'string':
                                $typeInfo = 'varchar(80)';
                            break;
                        default:
                                $typeInfo = 'varchar(80)';
                                break;
                        }

                if(gettype($fieldList[$i]) != NULL) {
                    $dataType= $dataType.'`'.$colNames[$i].'` '." ".$typeInfo.' NOT NULL';
                    if(($i)!=count($fieldList)-1){
                        $dataType= $dataType.",";
                    }
                }
            }   //end of for loop

             $tableName= str_replace('.txt','', $newFiles[$k]);
             //echo $tableName."\n";

            //
                //echo "\n".$dataType."\n";
                $succ=mysql_query("CREATE TABLE `$tableName` ($dataType)");
                if($succ)
                    echo "Table ".$tableName." was created Succesfully \n";

                //echo $databaseName;

                 $loadsql = 'LOAD DATA LOCAL INFILE "'.$newFileLocation.$newFiles[$k].'" INTO TABLE `'.$tableName.'` FIELDS TERMINATED BY ","  IGNORE 1 LINES ('.$firstLine.')';
                 mysql_query($loadsql);     

        }//end of for loop

     mysql_close(); 
```

# java - Hibernate UnknownServiceException：事务完成时请求的未知服务

> ID：10266750
> 
> 赞同：13
> 
> 时间：2012-04-22T09:22:16.420
> 
> 标签：java, hibernate, jpa, orm, transactions

我有一个简单的类，它启动 3 个线程并在每个线程中保存一个新对象。但是我遇到了我无法理解的异常。谁能帮我理解为什么会出现异常？

```
package test;

import java.util.Date;

import org.hibernate.Session;

import domain.Event;

import util.HibernateUtil;

public class EventBeanTest {

    public static void main(String [] args) {

        Event e1 = new Event();
        e1.setTitle("111");
        e1.setDate(new Date());

        Event e2 = new Event();
        e2.setTitle("222");
        e2.setDate(new Date());

        Event e3 = new Event();
        e3.setTitle("333");
        e3.setDate(new Date());

        Thread t1 = new Thread(new EventRunnable(e1));
        Thread t2 = new Thread(new EventRunnable(e2));
        Thread t3 = new Thread(new EventRunnable(e3));

        t1.setName("event - 111");
        t2.setName("event - 222");
        t3.setName("event - 333");

        t1.start();
        t2.start();
        t3.start();

    }

}

class EventRunnable implements Runnable {
    private Event event;

    public EventRunnable(Event event) {
        this.event = event;
    }

    public void run() {

        System.out.println("Starting thread : " + Thread.currentThread().getName());

        Session session = HibernateUtil.getSessionFactory().getCurrentSession();

        session.beginTransaction();

        session.saveOrUpdate(event);
        session.getTransaction().commit();

        HibernateUtil.getSessionFactory().close();

        System.out.println("Finishing thread : " + Thread.currentThread().getName());

    }
} 
```

这是显示异常的日志文件的相关部分：

```
Hibernate: select max(EVENT_ID) from test.EVENTS
Hibernate: insert into test.EVENTS (EVENT_DATE, TITLE, EVENT_ID) values (?, ?, ?)
Hibernate: insert into test.EVENTS (EVENT_DATE, TITLE, EVENT_ID) values (?, ?, ?)
Hibernate: insert into test.EVENTS (EVENT_DATE, TITLE, EVENT_ID) values (?, ?, ?)
Apr 22, 2012 2:46:55 PM org.hibernate.service.jdbc.connections.internal.DriverManagerConnectionProviderImpl stop
INFO: HHH000030: Cleaning up connection pool [jdbc:mysql://localhost:3306/test]
Finishing thread : event - 333
Apr 22, 2012 2:46:55 PM org.hibernate.engine.transaction.internal.jdbc.JdbcTransaction afterAfterCompletion
INFO: HHH000425: Could not close session; swallowing exception[org.hibernate.service.UnknownServiceException: Unknown service requested [org.hibernate.stat.spi.StatisticsImplementor]] as transaction completed
Exception in thread "event - 222" org.hibernate.service.UnknownServiceException: Unknown service requested [org.hibernate.stat.spi.StatisticsImplementor]
    at org.hibernate.service.internal.AbstractServiceRegistryImpl.getService(AbstractServiceRegistryImpl.java:126)
    at org.hibernate.internal.SessionFactoryImpl.getStatisticsImplementor(SessionFactoryImpl.java:1708)
    at org.hibernate.internal.SessionFactoryImpl.getStatistics(SessionFactoryImpl.java:1704)
    at org.hibernate.engine.transaction.internal.TransactionCoordinatorImpl.afterTransaction(TransactionCoordinatorImpl.java:140)
    at org.hibernate.engine.transaction.internal.jdbc.JdbcTransaction.afterTransactionCompletion(JdbcTransaction.java:138)
    at org.hibernate.engine.transaction.spi.AbstractTransactionImpl.commit(AbstractTransactionImpl.java:184)
    at test.EventRunnable.run(EventBeanTest.java:60)
    at java.lang.Thread.run(Thread.java:722)
Apr 22, 2012 2:46:55 PM org.hibernate.engine.transaction.internal.jdbc.JdbcTransaction afterAfterCompletion
INFO: HHH000425: Could not close session; swallowing exception[org.hibernate.service.UnknownServiceException: Unknown service requested [org.hibernate.stat.spi.StatisticsImplementor]] as transaction completed
Exception in thread "event - 111" org.hibernate.service.UnknownServiceException: Unknown service requested [org.hibernate.stat.spi.StatisticsImplementor]
    at org.hibernate.service.internal.AbstractServiceRegistryImpl.getService(AbstractServiceRegistryImpl.java:126)
    at org.hibernate.internal.SessionFactoryImpl.getStatisticsImplementor(SessionFactoryImpl.java:1708)
    at org.hibernate.internal.SessionFactoryImpl.getStatistics(SessionFactoryImpl.java:1704)
    at org.hibernate.engine.transaction.internal.TransactionCoordinatorImpl.afterTransaction(TransactionCoordinatorImpl.java:140)
    at org.hibernate.engine.transaction.internal.jdbc.JdbcTransaction.afterTransactionCompletion(JdbcTransaction.java:138)
    at org.hibernate.engine.transaction.spi.AbstractTransactionImpl.commit(AbstractTransactionImpl.java:184)
    at test.EventRunnable.run(EventBeanTest.java:60)
    at java.lang.Thread.run(Thread.java:722) 
```

**编辑 1**

```
<?xml version='1.0' encoding='utf-8'?> 
```

```
<session-factory>

    <!-- Database connection settings -->
    <property name="connection.driver_class">com.mysql.jdbc.Driver</property>
    <property name="connection.url">jdbc:mysql://localhost:3306/test</property>
    <property name="connection.username">vishnu</property>
    <property name="connection.password">con02305</property>

    <!-- JDBC connection pool (use the built-in) -->
    <property name="connection.pool_size">1</property>

    <!-- SQL dialect -->
    <property name="hibernate.dialect">org.hibernate.dialect.MySQLDialect</property>

    <!-- Enable Hibernate's automatic session context management -->
    <property name="current_session_context_class">thread</property>

    <!-- Disable the second-level cache  -->
    <property name="cache.provider_class">org.hibernate.cache.internal.NoCacheProvider</property>

    <!-- Echo all executed SQL to stdout -->
    <property name="show_sql">true</property>

    <!-- Drop and re-create the database schema on startup 
    <property name="hbm2ddl.auto">update</property> -->

    <property name="default_schema">test</property>
    <property name="show_sql">true</property>

    <mapping resource="domain/Event.hbm.xml"/>

</session-factory> 
```

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-04-22T18:13:23.730

Hibernate 中的 Session 对象不是线程安全的，你不应该在不同的线程中使用同一个 session，除非你同步访问 Session 对象。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-22T20:02:18.703

调用`.openSession()`而不是`.getCurrentSession()`after `getSessionFactory()`。
该`sessionFactory`对象是线程安全的，但每个`Session`对象都应该是单线程的。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2014-05-14T11:58:34.020

会话实际上是一个[工作单元](https://docs.jboss.org/hibernate/orm/3.3/reference/en/html/transactions.html#transactions-basics-uow)，应该绑定到当前正在执行的线程。一个工作单元将多个 DML 操作组合在一个事务中，只有在所有操作都成功时才能成功。所以会话是原子的，原子性意味着单个操作线程。

Session 也是一级缓存，所以在当前 Session 中，无论调用 session.get() 或 session.load() 多少次，都将始终获得相同的 Entity 对象引用。如果 Session 在刷新期间是线程安全的，则您可能会执行其他事务中介更改。所以一个 Session 必须与其他正在执行的 Session 隔离，隔离意味着一个单独的操作线程。

因此，一个 Session 并不意味着是线程安全的，以保持原子性和隔离要求。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-02-02T23:24:24.713

如果它对其他人有帮助，对我来说，这意味着“你在之前的单元测试中做了一个 mockito spy（数据库）”，它以某种方式破坏了休眠。去搞清楚。

# c# - C#：双精度的 Array.Sort 方法？

> ID：10266751
> 
> 赞同：1
> 
> 时间：2012-04-22T09:22:18.337
> 
> 标签：c#, arrays, sorting

我有一个数组（ double ）： ox_test 具有已知数量的元素。

当我编码时：

```
Array.Sort(ox_test); 
```

然后，只是看看它的数组是否排序：

```
for (int y = 1; y <= ox_test.Length; y++)
     MessageBox.Show(".x: " + ox_test[y]); 
```

.. 我得到 ... 0, 0, 0, 0, 0 （如果元素的数量是 5 ）。请帮忙，谢谢！

所以我修改了两个for循环：

```
for (int y = 0; y < ox_test.Length; y++)
    MessageBox.Show(".x: " + ox_test[y]);
    // HERE  i get the values not sorted but != 0

Array.Sort(ox_test);

for (int y = 0; y < ox_test.Length; y++)
    MessageBox.Show(".x s: " + ox_test[y]);
    // HERE i get only 0 values 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-22T09:27:33.590

```
// sort double array
double[] doubleArray = new double[5] { 8.1, 10.2, 2.5, 6.7, 3.3 };
Array.Sort(doubleArray);
// write array
foreach (double d in doubleArray) Console.Write(d + " ");  // output: 2.5 3.3 6.7 8.1 10.2 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-22T09:25:36.367

您应该从 0 而不是 1 开始。

```
for (int y = 0; y < ox_test.Length; y++)
    MessageBox.Show(".x: " + ox_test[y]); 
```

另外，请确保`ox_test`数组的初始化。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-22T09:32:48.547

试试这个代码：

```
Array.Sort(ox_test);

foreach (double i in ox_test)
{
    Console.Write(i + " ");
} 
```

# java - eclipse离线的javadoc位置

> ID：10266756
> 
> 赞同：9
> 
> 时间：2012-04-22T09:23:54.047
> 
> 标签：java, eclipse, javadoc

Eclipse 中的 Java（普通 Java 开发，而不是 Android）的帮助设置为 Oracle 服务器上的在线 URL，链接到[http://docs.oracle.com/javase/6/docs/api/](http://docs.oracle.com/javase/6/docs/api/)。但是，使用一台特定的计算机，我无法在我教的 Java 课程期间在线。所以我想使用本地帮助。

我尝试了以下方法：

*   打开`windows - preferences - java - installed jre`
*   选择 1.7 运行时，然后选择 rt.jar
*   按 Javadoc 位置。

在那里我看到了联机帮助的链接。我尝试改用源存档，`src.zip`即 JDK 目录中的文件夹。但这不起作用。无论如何，源不包含已编译的 Java 文档。

我必须下载 API 文档吗？如果，在哪里？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-23T16:53:14.107

当然，我已经安装了带有源代码的JDK。在机器上我找到了一个JRE7和JDK1.7xxx，项目使用的是JRE7。

1.  在 Window - Preferences - Java - Installed JRE 我找到了一个指向 JRE7 的链接，它不包含源代码或 Javadoc。

2.  所以我按下“编辑”并浏览到JDK1.7的目录，然后按下“恢复默认值”。这会将 JRE 系统库更改为 JDK。rt.jar 和其他 jar 的 Javadoc 位置现在位于 Oracle 中，但如果没有 Internet 连接，则会使用已安​​装的 src.zip。

或者，确实可以将 src.zip 文件（文件！）附加到 JRE7 的 rt.jar。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-22T09:56:21.520

您可以从以下位置下载 Java 7 javadoc

[http://www.oracle.com/technetwork/java/javase/documentation/java-se-7-doc-download-435117.html](http://www.oracle.com/technetwork/java/javase/documentation/java-se-7-doc-download-435117.html)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2018-08-08T02:55:03.403

我遇到了这个问题。这是因为我使用的 JRE 不是 JDK 的 JRE。

首先，更新您的默认 JRE：

*   在菜单中，Window > Preferences > Java > Installed JREs
*   确保使用 JDK 的 JRE。如果没有，请通过以下方式添加：
    *   添加 > 标准 VM > 点“JRE Home”到`<JDK directory, not ./bin>`> OK
    *   在菜单中，Window > Preferences > Java > Installed JREs > Execution Environment
    *   确保新添加的 JDK JRE 是所选 Java 环境的默认 JRE

然后，更新现有项目以使用该 JRE：

*   在菜单中，项目 > 属性 > Java 构建路径 > 库
*   滚动到底部，您可以在其中看到 JRE 系统库
*   单击它，然后单击编辑按钮
*   修改选择（执行环境或备用 JRE）以指向您的 JDK JRE
*   点击完成

您现在应该拥有 JRE 库的 JavaDocs！☕</p>

如果没有，您可能需要通过 Window > Preferences > Java > Compiler > Javadoc 刷新 JavaDoc 设置，然后取消选中/应用/重新选中/应用`Process Javadoc comments`复选框。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-22T12:07:24.213

`src.zip`如果我没记错的话，如果你有可用并设置，你根本不需要 API 文档。Eclipse 应该从源代码中获取 Javadoc，就像使用您自己的代码一样。

**编辑：如何设置`src.zip`：**

1.  打开“已安装的 JRE”首选项窗格
2.  单击 JRE 的“编辑...”
3.  对于每个所需的库，单击“源附件...”并选择您的`src.zip`文件。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-22T13:25:12.573

有不同的选择（正如@siegi 和@Thorbjorn_Ravn_Andersen 所说），这取决于你想要做什么：

*   如果您只想阅读您正在使用的 API 方法之一的 JavaDoc，则足以阅读源代码（如 @siegi 所述），或者打开 JavaDoc 视图并在那里阅读更精美的版本。
*   您可以浏览 @Thorbjorn 提到的下载的 JavaDoc API。

但是，在课堂上我想告诉人们一直使用他们的 IDE，所以我认为在线浏览源代码更加自然（对于 Java 开发人员），并且您很确定您看到的文档是写入您正在使用的来源。

如果您想了解包或类的一些概述，在浏览器中使用 API 可能更方便。

# python - 从 Gmail 下载子文件夹

> ID：10266759
> 
> 赞同：2
> 
> 时间：2012-04-22T09:24:18.473
> 
> 标签：python, r, gmail, web-scraping

我在[此博客](http://expansed.com/2011/08/sna-visualising-an-email-box-with-r)上的评论中发现的代码有问题，该代码是该帖子中代码的扩展。

```
mailSoc <- function(login,
                    pass,
                    serv = "imap.gmail.com", #specify IMAP server
                    ntore = 50, #ignore if addressed to more than
                    todow = -1, #how many to download
                    begin = -1, #from which to start
                    folder = ''){ #folder to download (default:inbox)

  #load rJython and Python libraries
  require(rJython)
  rJython <- rJython(modules = "imaplib")
  rJython$exec("import imaplib")

  #connect to server
  rJython$exec(paste("mymail = imaplib.IMAP4_SSL('",
                     serv, "')", sep = ""))
  rJython$exec(paste("mymail.login(\'",
                     login, "\',\'",
                     pass, "\')", sep = ""))

  #get number of available messages
  rJython$exec(paste("sel = mymail.select(\"", folder,"\")", sep=""))
  rJython$exec("number = sel[1]")
  nofmsg <- .jstrVal(rJython$get("number"))
  nofmsg <- as.numeric(unlist(strsplit(nofmsg, "'"))[2])

  #if 'begin' not specified begin from the newest
  if(begin == -1)
  {
    begin <- nofmsg
  }

  #if 'todow' not specified download all
  if(todow == -1)
  {
    end <- 1
  }
  else
  {
    end <- begin - todow
  }

  #give a little bit of information
  todownload <- begin - end
  print(paste("Found", nofmsg, "emails"))
  print(paste("I will download", todownload, "messages."))
  print("It can take a while")

  data <- data.frame()

  #fetching emails
  for (i in begin:end) {
    nr <- as.character(i)

    #get sender
    rJython$exec(paste("typ, fro = mymail.fetch(\'", nr, "\', \'(BODY[HEADER.FIELDS (from)])\')", sep = ""))
    rJython$exec("fro = fro[0][1]")
    from <- .jstrVal(rJython$get("fro"))
    from <- unlist(strsplit(from, "[\r\n, \"]"))
  from <- sub("from: ", "", from, ignore.case = TRUE)
                            from <- grep("@", from, value = TRUE)
  #get addresees
  rJython$exec(paste("typ, to = mymail.fetch(\'", nr, "\', \'(BODY[HEADER.FIELDS (to)])\')", sep = ""))
  rJython$exec("to = to[0][1]")
  to <- .jstrVal(rJython$get("to"))
  to <- unlist(strsplit(to, "[\r\n, \"]"))
  to <- sub("to: ", "", to, ignore.case = TRUE)
  from <- sub("\"", "", from, ignore.case = TRUE)
  to <- grep("@", to, value = TRUE)

  #get dates:
  rJython$exec(paste("typ, date = mymail.fetch(\'", nr, "\', \'(BODY[HEADER.FIELDS (date)])\')", sep = ""))
  rJython$exec("date = date[0][1]")
  date <- .jstrVal(rJython$get("date"))

  #add to data frame
  #vec <- rep(from, length(to))
  if(length(to)==0)
  to <- 'NA'
  if(length(from)==0)
  to <- 'NA'
  data <- rbind(data, data.frame(from, to, date))

  #give some information about progress
  #print(i)
    if((i - begin) %% 100 == 0)
    {
      print(paste((i - begin)*(-1), "/", todownload,
                  " Downloading...", sep = ""))
    }
  }
  names(data) <- c("from", "to", "date")
  data$from <- tolower(data$from)
  data$to <- tolower(data$to)

  #close connection
  rJython$exec("mymail.shutdown()")
  return(data)
} 
```

在我指定要从中下载电子邮件的文件夹后

```
maild <- mailSoc("login", "passowrd", serv = "imap.gmail.com",
                 ntore = 20, todow = 200, folder='anywhere') 
```

我收到错误消息：

```
[1] “Found NA emails”
[1] “I will download NA messages.”
[1] “It can take a while”
Error in begin:end : NA/NaN argument
In addition: Warning message:
In mailSoc(“xyz”, “xyz”, serv = “imap.gmail.com”, :
NAs introduced by coercion 
```

你知道我该怎么做吗？我想在我的 gmail 中选择接下来要下载的文件夹/子文件夹。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-23T06:10:58.070

我找到了解决我的问题的方法。我需要做的是更换

```
rJython$exec(paste("sel = mymail.select(\"", folder,"\")", sep="")) 
```

和

```
rJython$exec("sel = mymail.select('[Gmail]/All Mail')") 
```

但是我有另一个问题，我不能下载超过 2500 封电子邮件。也许您可以找到解决此问题的方法...

```
[1] “Found 17976 emails”
[1] “I will download 2500 messages.”
[1] “It can take a while”
[1] “0/2500 Downloading…”
[1] “100/2500 Downloading…”
[1] “200/2500 Downloading…”
[1] “300/2500 Downloading…”
....MORE LINES....
[1] “2400/2500 Downloading…”
Error in data.frame(vec, to) :
arguments imply differing number of rows: 0, 1 
```

# java - 文本收录器移动不流畅

> ID：10266761
> 
> 赞同：2
> 
> 时间：2012-04-22T09:24:39.367
> 
> 标签：java, game-physics

我实现的移动文本自动收录器移动不顺畅，当并行执行繁重的 GUI 操作时，问题更严重。
我通过创建自己的将要绘制的图像来使用手动双缓冲。
在数据更改时，我使用以下代码更新我的缓冲图像：

```
 public static BufferedImage createBufferedImage(int w, int h) {
      GraphicsEnvironment ge = GraphicsEnvironment.getLocalGraphicsEnvironment();
      GraphicsDevice gs = ge.getDefaultScreenDevice();
      GraphicsConfiguration gc = gs.getDefaultConfiguration();
      return gc.createCompatibleImage(w, h, Transparency.TRANSLUCENT);
    } 
```

然后我使用 drawText(..) 在其上绘制所需的文本，然后调用 repaint()。

并行地，每 10 毫秒，一个异步线程计算图像的下一个 X 位置，然后调用 repaint()。

我的主要组件扩展了 JComponet，并覆盖了paintComponent()，如下所述：

```
 @Override
    protected void paintComponent(Graphics g) {
      super.paintComponent(g);
      g.drawImage(baseImage, scrollTextX, 0, null);
    } 
```

有没有什么技巧可以让运动变得更好？
如何使代码移动不受其他 GUI 操作的影响？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-04T07:25:19.760

我猜这是在 Swing 应用程序中使用的？然后我认为你应该从 AWT 事件调度线程更新 UI。您可以通过使用[SwingUtilities](http://docs.oracle.com/javase/6/docs/api/javax/swing/SwingUtilities.html)类中的[invokeLater](http://docs.oracle.com/javase/6/docs/api/javax/swing/SwingUtilities.html#invokeLater%28java.lang.Runnable%29)方法来做到这一点。

# android - 安卓市场（谷歌播放）。获取买家信息

> ID：10266763
> 
> 赞同：1
> 
> 时间：2012-04-22T09:24:56.650
> 
> 标签：android, google-checkout, google-play

我想在市场上发布一个付费应用程序，但首先我想知道是否有可能至少看到每个购买我的应用程序的人的电子邮件地址。我想要一种可能与其中一些人联系的方式（不，我不想发送垃圾邮件等）。

这可能吗？有人告诉我，在 Google Checkout 中，您可以看到每个买家的详细信息，其中还包含一个电子邮件地址。这是真的？

请原谅这不是一个编程问题，但它仍然与软件开发有关。

非常感谢你，

安德烈

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-22T10:17:54.657

Google Checkout 通常会显示买家信息，包括电子邮件和注册街道地址，因此您可以发送电子邮件或普通邮件。

但是，显示的大部分时间配置文件都`Email Marketing: No`写在下面，在尝试随意与人联系之前，我会三思而后行。

# android - EditText 中 MotionEvent 的位置索引

> ID：10266764
> 
> 赞同：1
> 
> 时间：2012-04-22T09:24:56.807
> 
> 标签：android

给定一个`EditText`和它的`OnTouch`事件，我覆盖它，并返回真。这可以防止软键出现。但它也阻止了`EditText`. 那`myEditText.getSelectionStart()`将始终返回 0。

`MotionEvent`有没有办法根据事件的参数计算（或可以计算的Android函数）位置索引`OnTouch`？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-10-31T00:35:02.257

从 API 级别 14 开始，今天 Android 的 API 中有一个称为 getOffsetForPosition(float x,float y) 的解决方案，用于获取在编辑文本上进行触摸的字符位置。它基本上是一种您可以从您的一个侦听器内部为 edittext（onClick 或 onTouch）调用的方法，如下所示：

```
int click_position = <your_edittext>.getOffsetForPosition(event.getX(), event.getY()); 
```

其中 event 是传递给侦听器的 MotionEvent。这给出了在edittext视图上进行触摸的字符的位置，使用它可以定位光标使用

```
edittext.setSelection(click_position); 
```

但是，如果您希望它在使用早于 4.0 (ICS)（API 级别 13 或更低）的 Android 版本的设备上运行，则此 API 不可用。但是，您可以为低于 14 的 API 版本开发自己的方法，使用其他可用的 API（这基本上是 Google 从 API 级别 14 所做的）。我这样做了，并且能够从motionevent成功获取edittext上的位置索引。我基本上从 API 级别 1 的 Android 中可用的其他 API 调用编译了一个具有相同名称的静态方法。我不确定现在是否需要发布旧 API 级别的代码。如果有兴趣，我会在这里发布代码。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-11T17:54:15.790

我意识到这个问题已经有一年了，但我目前正在尝试做同样的事情。我的理由是我需要一个很好的解决方案来处理本地化的 numberDecimal EditText 输入，而 Android 本身并不能很好地做到这一点：[http](http://code.google.com/p/android/issues/detail?id=2626) ://code.google.com/p/android/issues/detail?id=2626和所有线程当像三星这样的制造商未能采用“数字”参数时，试图处理该问题的 SO 将不起作用。

这不是将字段中的 onTouch 事件转换为光标位置的最终代码，但我大约半小时前才开始，所以这就是我在研发中的工作所在。

它的工作量很小。我只需要弄清楚如何计算不同屏幕的除数参数。16 的值适用于我的小型旧手机，但不适用于更高密度的 7 英寸平板电脑。

[编辑：在我测试过的设备上运行良好。判断这是否适用于更多设备还为时过早。]

```
myField.setOnTouchListener(new View.OnTouchListener() {
        @Override
        public boolean onTouch(View v, MotionEvent me) {
            if (me.getAction() == MotionEvent.ACTION_DOWN) {
                try {
                    float dp = App.get().getResources().getDisplayMetrics().density;
                    int div = (int) (10 * dp);
                    int x = (int) me.getX();
                    int pos = (v.getWidth() - x) / div;
                    int strlen = ((EditText)v).getText().toString().length();
                    int curpos = strlen - pos;

                    v.requestFocus();

                    if (curpos < 0) {
                        ((EditText)v).setSelection(0);
                    } else {
                        ((EditText)v).setSelection(curpos);
                    }
                } catch (Exception e) {
                    Log.w(App.TAG, "onTouch exception " + e.toString());
                }
            }
            return true;
        }
    }); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-22T12:04:18.243

在搜索 SO 和谷歌搜索后，我明白解决方案尚不清楚。所以我通过妥协解决了它。

我在键盘上提供了右/左箭头，用户可以使用它来移动光标。如果用户在显示我的键盘时点击编辑文本，他会得到一个 Toast，告诉他使用键盘来完成他想做的事情。

# java - 如何使Java快速执行？

> ID：10266765
> 
> 赞同：-2
> 
> 时间：2012-04-22T09:24:58.037
> 
> 标签：java, jar, executable-jar

> **可能重复：**
> [如何制作可执行的 jar 文件？](https://stackoverflow.com/questions/5258159/how-to-make-an-executable-jar-file)

我想将我的 Java 程序分发给另一个想要查看该软件的人，但我不想透露代码，直到他提出要求。如何在一个文件夹中发送我的 Java 代码 + 几个 xml 文件？

我一直在考虑是否将 jar 用于分发程序的目的。如果是这样，它可以在我的情况下使用吗？其他简单的选择是什么？

警告：我没有太多时间花。所以我需要一些可以快速完成、简单且不需要学习的东西。此外，分步教程的任何链接都会有所帮助

更新：在 Eclipse 中制作可执行 jar 时，说：编译错误。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-22T09:31:08.143

没问题。您可以使用 IDE（例如 Eclipse）制作 JAR 文件。只需点击导出。您可以包含源文件，但不是必须的。您还可以像 XML 文件一样包含您的资源。

您还可以压缩已编译的类文件（例如 IDE 中的 bin 文件夹）。但 JAR 将是更好的解决方案。

但在发送之前测试 JAR 文件。如果这是您的第一次，则会出现一些问题，例如未创建资源或清单文件中缺少主类声明。但是，如果您使用 IDE，它应该会在一分钟内工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-22T09:39:10.277

要制作可执行的 jar 文件，请使用命令

罐子-cvfe

要测试它是否工作，只需双击 jar。请务必在 manifest.mf 文件中包含所有库。

或者您可以只使用您的 IDE 为您完成这项工作。

# scripting - 添加 Lua 函数语法

> ID：10266766
> 
> 赞同：-1
> 
> 时间：2012-04-22T09:24:59.520
> 
> 标签：scripting, syntax, lua

我正在使用 C++ 和 Lua 开发 MUD，并且正在尝试为表情创建一组函数。

我写过：

```
add_functions
{
   ['subject-bind-search say'] = 'none',
   ['player say string-type'] = function(player, msg)
      player_text(player, 'You say "' .. msg.string .. '".')
      witness_text(player, M('indefinite', player) .. ' says "' .. msg.string .. '".')
   end,
   ['subject-bind-search say-to'] = 'none',
   ['player say-to string-type thing'] = function(player, msg, thing)
      player_text(player, 'You say "' .. msg.string .. '" to ' .. M('definite',thing) .. '.')
      witness_text(player, M('indefinite', player) .. ' says "' .. msg.string .. '" to ' .. M('indefinite', thing) .. '.')
      end,
      ['player dance'] = function(player)
        player_text(player, 'You burst into dance.')
        witness_text(player, M('indefinite', player)..' bursts into dance.')
        add_atoms{dance='verb'}
        end 
} 
```

当我和其他人使用 telnet 连接到服务器时，我可以键入：

> 说“嗨”——>每个人都看到你想要的。

我可以打字：

> 对 playerBob 说“hi” --> playerBob 看到 hi 就好了

但是，如果我简单地键入：`dance` 当它无法识别任何动词时，我会收到一条错误消息。我以为已经`add_atoms{ dance = 'verb' }`解决了，但是...

有人碰巧知道为什么我不能跳舞吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-22T20:30:49.630

[解决了]

“add_atoms { dance = 'verb' }” 不在 add_functions 代码中。它必须或至少可以在 add_functions 方法之外进行。像这样：

```
add_atoms{[{'say', 'dance', 'apologize', 'bark', 'flex'}]='verb', to='preposition'}

add_functions
{
...
} 
```

# ios - cocos2d app中运行应用前的两张图

> ID：10266768
> 
> 赞同：0
> 
> 时间：2012-04-22T09:25:02.593
> 
> 标签：ios, ipad, cocos2d-iphone, launch

在 xCod 中，我可以在“启动图像”中添加一张图像。如何在运行应用程序之前添加两个图像？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-23T04:31:16.370

启动图像不应该是 cocos2d 应用程序的启动画面。请参阅[iOS 人机界面指南：自定义图标和图像创建指南](http://developer.apple.com/library/ios/#documentation/userexperience/conceptual/mobilehig/IconsImages/IconsImages.html)中的描述：

> 为了增强用户在应用程序启动时的体验，您必须提供至少一张启动图像。启动图像看起来与应用程序显示的第一个屏幕非常相似。当用户启动您的应用程序时，iOS 会立即显示此图像，直到应用程序完全准备好使用。一旦您的应用程序准备好使用，您的应用程序就会显示其第一个屏幕，替换启动占位符图像。
> 
> ...请记住，发布图片并不是为了提供艺术表达的机会；它仅旨在增强用户对您的应用程序的感知，使其可以快速启动并立即准备好使用。

我认为你需要的是 cocos2d 中的一个新场景。创建一个自定义的 CCLayer 类，例如 SplashLayer，并将其包装在 CCScene 中，以便以任何顺序和/或形式显示您的两个图像。您可以使用动画使演示文稿看起来更好。或者，您也可以为两个图像创建单独的场景，并使用过渡以特定顺序和效果呈现它们。

但是，您仍然需要启动图像。只需使用您要显示的第一张图像，以便在用户启动应用程序时无缝连接启动图像和启动场景。

# ruby - NoMethodError：nil 的未定义方法 `q='：NilClass：Mechanize；谷歌抓取

> ID：10266781
> 
> 赞同：0
> 
> 时间：2012-04-22T09:27:30.070
> 
> 标签：ruby, mechanize

我正在使用以下代码废弃谷歌

```
def google_search(query)
  page = @agent.get('http://www.google.com')
  google_form = page.form_with(:name => 'f')
  google_form.q = query
  page = @agent.submit(google_form)
  page
end 
```

但有时我得到`NoMethodError: undefined method`q=' for nil:NilClass` 错误。可能是什么问题？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-23T19:43:05.473

您正在使用文档中的示例代码，在 google 搜索中没有具有该名称的表单，请尝试“gbqf”，但它可能会因语言环境或各种设置而异。当您使用 mechanize 时，使用“pp”在开发过程中漂亮地打印元素，以查看您正在获取的内容和接下来的内容。

工作 .rb 示例（从[http://mechanize.rubyforge.org/EXAMPLES_rdoc.html](http://mechanize.rubyforge.org/EXAMPLES_rdoc.html)更新）通过查询获得前 10 个结果。

```
require 'rubygems'
require 'mechanize'

a = Mechanize.new { |agent|
  agent.user_agent_alias = 'Mac Safari'
}

a.get('http://google.com/') do |page|
  search_result = page.form_with(:name => 'gbqf') do |search|
    search.q = 'ruby mechanize'
  end.submit

  search_result.search(".//a[@class='l']").each_with_index.map do |link, i|
    puts "#{i} #{link.content}"
  end
end 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-22T09:32:07.067

该错误意味着您正在`q`调用`NilClass`. 如果`page.form_with(:name => 'f')`失败则会发生这种情况，因此`google_form`最终成为`nil`.

# c - 来自第二次调用的 recv() 块

> ID：10266785
> 
> 赞同：1
> 
> 时间：2012-04-22T09:27:58.027
> 
> 标签：c, linux, sockets, recv

我有一个简单的客户端-服务器应用程序，用于将文件从客户端发送到服务器。客户端以预定义大小的块（例如 512）发送文件。服务器也以相同大小的块接收文件。客户端的套接字直到服务器在接收到整个文件后发送一个 ack 才会关闭。

会发生什么：

1.  客户端设法发送（send() 调用）整个文件，意味着它的所有块。
2.  服务器设法仅获取（recv() 调用）第一个块，这意味着 recv() 调用在第一次调用时返回 512，而在第二次调用时它会阻塞。

这种行为的原因可能是什么？

以下是相关部分。

发送\接收功能：

```
int sendBuf(int sockFd, char* buf, int size){
    int bytesSent = 0;
    while (bytesSent < size){
        bytesSent += send(sockFd, buf, size, 0);
    }
    return bytesSent;
}

int sendInt(int sockFd, int num){
    uint32_t nbo_num = htonl(num);
    return sendBuf(sockFd, (char*)&nbo_num, sizeof(nbo_num));
}

int getBuf(int sockFd, char* buf, int size){
    int bytesRecv = 0;
    while (bytesRecv < size){
        bytesRecv += recv(sockFd, buf, size, 0);
    }
    return bytesRecv;
}

int getInt(int sockFd, int *num){
    int temp, bytesRecv;
    bytesRecv = getBuf(sockFd, (char*)&temp, sizeof(int));
    *num = ntohl(temp);
    return bytesRecv;
} 
```

服务器：

```
printf("%s     New file was created.\n",tStr);

/* get file data */
char buf[FILE_READ_CHUNK_SIZE] = {0}; // FILE_READ_CHUNK_SIZE is the maximal read amount
int bytesWritten = 0, bytesLeft = fileSize, _size=0, chunkNo=0;
bytesRecv = 0;

while (bytesLeft > 0){
    _size = (bytesLeft > FILE_READ_CHUNK_SIZE) ? FILE_READ_CHUNK_SIZE : bytesLeft;
    bytesRecv = getBuf(newsockfd, buf, _size);
    int _bytesLeft = bytesRecv;
    bytesWritten = 0;
    while (_bytesLeft > 0){
        bytesWritten = fileInfoWrite(fileInfo, buf, _bytesLeft);
        _bytesLeft -= bytesWritten;
    }
    chunkNo++;
    printf("%s     chunk #%d: received %d bytes\n",tStr , chunkNo, bytesRecv);
    bytesLeft -= bytesRecv;
}
printf("%s   Finished getting file #%d.\n",tStr ,i+1);

/* send ack to the client */
bytesSent = sendInt(newsockfd, 1);
printf("%s   Sent the client an  ack for file #%d.\n",tStr ,i+1); 
```

客户：

```
/* send the entire data of the file */
printf("  Sending file data\t\t... ");
char buf[FILE_READ_CHUNK_SIZE] = {0}; // FILE_READ_CHUNK_SIZE is the maximal read amount
int numOfChunks=0, bytesRead = 0, bytesLeft = filesArr[i]->fileSize ;
bool eof = false;
bytesSent = 1;

while (bytesLeft > 0){
    bytesRead = fileInfoRead(filesArr[i], buf, &eof);
    int _bytesLeft = bytesRead;
    while (bytesSent < _bytesLeft){
        bytesSent = sendBuf(sockFd, buf, _bytesLeft);
        _bytesLeft -= bytesSent;
    }
    //printf("    chunk #%d: sent %d bytes\n", numOfChunks+1, bytesRead);
    bytesLeft -= bytesRead;
    numOfChunks++;
}
printf("Success.\n");

/* get ack from server */
int ack=0;
bytesRecv = getInt(sockFd, &ack);
if (bytesRecv!=4 || ack!=1){
    printf("Server ack is invalid.\n");
}
printf("Finished sending file #%d.\n",i+1); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-22T10:14:13.647

你的发送代码是错误的，正常情况下它不会发送超过一个块（即一次写入一个完整的块）。这是因为您在内循环之后
没有重置。`bytesSent`很可能它会`== FILE_READ_CHUNK_SIZE`在第一个之后`sendBuf`，而 while 条件在那之后将永远为假。

所以你只发送一个缓冲区。

（您的代码中可能还有更多错误。例如，如果发生短写入（您将重新发送缓冲区的头部），您将发送缓冲区的错误部分。）

# python - 在 Tweepy 中以可读格式显示推文

> ID：10266786
> 
> 赞同：2
> 
> 时间：2012-04-22T09:28:13.437
> 
> 标签：python, django

我怎样才能让 tweepy 返回实际的推文，我的意思是它应该以人类可读的格式显示推文？

我不希望它返回这样的推文：

```
 <tweepy.models.Status object at 0x95F1ABPo> 
```

代码

```
 def tweetstream(request):
        consumer_key=""
        consumer_secret=""
        access_token=""
        access_token_secret=""
        auth=tweepy.OAuthHandler(consumer_key, consumer_secret)
        auth.set_access_token(access_token, access_token_secret)
        api=tweepy.API(auth)
        statuses=Cursor(api.list_timeline, owner='', slug='').pages()
        for status in statuses:
            print status
            return render_to_response('dash.html',{'statuses': statuses},context_instance=RequestContext(request)) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-22T09:36:39.153

tweepy.models.Status 只是一个类。它可能具有可用于访问推文内容的字段。`status.text`例如，尝试。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-09-27T14:50:25.693

API 调用返回调用的 JSON。Tweepy 将其解析为自己的模型，称为 Status。您可以获取推文的不同参数并将它们从这个状态模型呈现到 django 模板中。

将整个'statuses'作为上下文传递给django模板，并在for循环中运行它们，你可以在那里显示一些东西，比如显示推文'statuses.text'。

您可以使用 twitter 的标准模板并将您的推文呈现为或编写您自己的 html 并根据需要在其中显示推文。

视图.py：

```
def tweetstream(request):
        consumer_key=""
        consumer_secret=""
        access_token=""
        access_token_secret=""
        auth=tweepy.OAuthHandler(consumer_key, consumer_secret)
        auth.set_access_token(access_token, access_token_secret)
        api=tweepy.API(auth)
        statuses=Cursor(api.list_timeline, owner='', slug='').pages()
        context = {'statuses':statuses}
        return render(request, 'dash.html', context) 
```

在 Django 模板中渲染：

```
{% for tweets in statuses %}
tweets.text
{% endfor %} 
```

[https://dev.twitter.com/web/embedded-tweets](https://dev.twitter.com/web/embedded-tweets)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-22T17:47:47.713

访问包含推文的实际变量（例如 {{status.text}}）或在您的状态模型上定义一个**unicode**方法，如下所示：

```
class Status(models.Model):
    def __unicode__(self):
        return self.text 
```

假设 Status 是一个 Django 模型。

# ios - 对于 iPad 应用程序，如何构建一个应用程序，以便它可以在生产版本中看到它的最终速度？

> ID：10266788
> 
> 赞同：0
> 
> 时间：2012-04-22T09:28:27.897
> 
> 标签：ios, xcode

有没有办法为 iPad 应用程序的生产版本构建，这样`NSLog`就不会打印出任何东西，并且编译器使用了更高的优化级别，并且没有将调试信息放入代码等？

我尝试了`Product -> Build for -> Archiving`，也为`Profiling`，并选择了`Product -> Perform Action -> Run without building`，但我仍然看到来自的消息`NSLog`，它看起来像是一个调试版本。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-22T09:32:12.350

您应该编辑您的架构以进行发布，而不是调试。那会做的。但是 NSLog 即使在发布时也能工作，如果你不像这里那样自己切换它[我需要在发布应用程序之前禁用 NSLog 吗？](https://stackoverflow.com/questions/2025471/do-i-need-to-disable-nslog-before-release-application)

# php - filter_var($url, FILTER_VALIDATE_URL) 在 PHP 5.3.2 中表现怪异

> ID：10266794
> 
> 赞同：4
> 
> 时间：2012-04-22T09:30:11.607
> 
> 标签：php, ubuntu

出于某种奇怪的原因，下面的函数说这个 url “paradox-productions.net”在[http://alpha.shurl.be/](http://alpha.shurl.be/)上无效并且在我的 localhost 上有效。它是PHP中的错误还是可能导致这种情况的原因？谁能证实这一点？可以解决还是我需要在我的服务器上升级 PHP？

phpinfo：[http ://alpha.shurl.be/phpinfo.php](http://alpha.shurl.be/phpinfo.php)

功能：

 `````
<?php
function validUrl($url) {
    var_dump($url);
    if(strpos($url, ".") !== false) {
        var_dump($url);
        if(strpos($url, "://") === false) {
            $url = "http://" . $url;
            var_dump($url);
        }
    }

    if(filter_var($url, FILTER_VALIDATE_URL)) {
        echo "VALID\n";
    }
    else {
        echo "INVALID\n";
    }
    var_dump(filter_var($url, FILTER_VALIDATE_URL));

    return filter_var($url, FILTER_VALIDATE_URL);
}
?> 
````  `* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-22T09:42:04.960

这是 PHP 5.3.2 中的一个已知错误。它认为带有破折号的 URL 是无效的。请参阅[https://bugs.php.net/bug.php?id=51258](https://bugs.php.net/bug.php?id=51258)。您的本地 PHP 必须是不存在此错误的不同版本。

如果您可以升级到工作版本，那么这样做可能是个好主意。如果不能，您可以通过在验证之前从字符串中删除由其他有效 url 字符分隔的所有破折号来解决此问题。下面的正则表达式并不完美，但如果您知道破折号只会出现在字母、数字或下划线之间（通常是正确的，但请注意这不会处理某些不太可能的边缘情况），它应该可以工作。

```
$url_to_validate = preg_replace("/([\w\d])-(?=[\w\d])/", '\\1\\2', $url); 
```

`\w`表示“任何字母或下划线”并`\d`表示“任何数字”，因此`[\w\d]`表示任何字母、数字或下划线。第二个需要一个零宽度的正向超前断言（使用`(?=...)`）以确保它捕获序列中的所有破折号`a-b-c-d-e`（没有它，它将错过该序列中的所有其他破折号）。

这是错误报告的正文：

> ## 描述：
> 
> FILTER_VALIDATE_URL 不允许在主机名中使用破折号/连字符。这很愚蠢。
> 
> ## 测试脚本：
> 
> ```
> $ php -r 'var_dump(filter_var("http://www.something.com/",
> FILTER_VALIDATE_URL));'
> 
> $ php -r 'var_dump(filter_var("http://www.some-thing.com/",
> FILTER_VALIDATE_URL));' 
> ```
> 
> ## 预期结果：
> 
> ```
> $ php -r 'var_dump(filter_var("http://www.something.com/",
> FILTER_VALIDATE_URL));' string(25) "http://www.something.com/"
> 
> $ php -r 'var_dump(filter_var("http://www.some-thing.com/",
> FILTER_VALIDATE_URL));' string(26) "http://www.some-thing.com/" 
> ```
> 
> ## 实际结果：
> 
> ```
> $ php -r 'var_dump(filter_var("http://www.something.com/",
> FILTER_VALIDATE_URL));' string(25) "http://www.something.com/"
> 
> $ php -r 'var_dump(filter_var("http://www.some-thing.com/",
> FILTER_VALIDATE_URL));' bool(false) 
> `````

# python - Pyglet：Sprite.draw() 和 Batch.draw() 不起作用，但 Image.blit 可以

> ID：10266799
> 
> 赞同：0
> 
> 时间：2012-04-22T09:31:15.350
> 
> 标签：python, sprite, draw, pyglet

在我正在学习的 pyglet 中，Image.blit() 有效，但 Sprite.draw() 无效，Batch.draw() 也无效，即使在这个简单的代码中：

```
import pyglet

win = pyglet.window.Window()

img = pyglet.resource.image('test.png')
spr = pyglet.sprite.Sprite(img)

@win.event
def on_draw():
    win.clear()
    spr.draw()

if __name__ == '__main__':
    pyglet.app.run() 
```

窗口仍然是黑色的。但是，例如，我可以绘制标签。我发现的唯一解释是关于显卡和其中一些的“v2i”错误，但我害怕在不知道我在做什么的情况下接触 pyglet 的代码。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-28T22:22:50.447

[这个线程](https://stackoverflow.com/questions/9693934/cant-draw-sprites-in-pyglet)的第三个答案对我有用，即使我使用的是 Ubuntu 而不是 Windows。其实是硬件问题。我在 /usr/lib/pymodules/python2.7/pyglet/sprite.py 中找到的文件中的“v2i”中的第 368 和 372 行将“i”替换为“f”。然后我保存，运行我的代码，一切正常。

# c++ - 将对象指针转换为 char 数组

> ID：10266801
> 
> 赞同：3
> 
> 时间：2012-04-22T09:31:25.883
> 
> 标签：c++, inheritance, casting, polymorphism, ns-3

```
unsigned char *check = NULL;
check = (dynamic_cast<unsigned char *>( ns3::NetDevice::GetChannel() )); 
```

这就是我正在尝试的。但错误是：

```
error: cannot dynamic_cast ‘ns3::NetDevice::GetChannel() const()’ (of type ‘class       ns3::Ptr<ns3::Channel>’) to type ‘unsigned char*’ (target is not pointer or reference to class) 
```

我也试过：

```
reinterpret_cast 
```

但它根本不起作用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-22T12:12:49.363

的返回类型`ns3::NetDevice::GetChannel()`是某种自定义智能指针；在没有看到它的定义的情况下，我们只能猜测如何将它转换为原始指针。

也许它实现了一个转换运算符，`operator T*()`尽管这通常被认为是一个坏主意，因为它使得意外的转换很容易意外进行。在这种情况下，您可以这样做：

```
void * check = ns3::NetDevice::GetChannel(); 
```

否则，也许它有一个成员函数可以转换为原始指针。标准的智能指针通常称之为`get()`：

```
void * check = ns3::NetDevice::GetChannel().get(); 
```

如果它不提供，并且您确实想获得一个原始指针，那么您可以取消引用它并获取一个指向取消引用对象的指针（假设它支持取消引用；否则，将其称为指针有点奇怪全部）：

```
void * check = &*ns3::NetDevice::GetChannel(); 
```

一旦你有了一个`void *`，你可以用`static_cast`它来改变它`unsigned char *`，如果这是你想要的。使用它时要小心，因为弄乱对象的字节很容易导致未定义的行为。

更新：如果[此处](http://www.nsnam.org/doxygen-release/classns3_1_1_ptr.html)`ns3::Ptr`记录了模板，那么您可以使用以下方法获取原始指针：

```
void * check = PeekPointer(ns3::NetDevice::GetChannel()); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-22T11:28:09.977

最好使用两个`static_cast`而不是`reiterpret_cast`. 因为标准不保证不同的指针具有相同的大小。但是，该标准确实保证`void*`有足够的大小来容纳指向任何数据类型的指针（指向函数的指针除外）。

```
unsigned char *check = NULL;
check = static_cast<unsigned char*>(static_cast<void*>(ns3::NetDevice::GetChannel())); 
```

您`Ptr<Channel>`必须有重载的运算符，它返回保留的指针：

```
template<typename T>
class Ptr
{
public:
  operator T*() {return _p;}

private:
  T* _p;
}; 
```

# java - 在面板中设置图像图标

> ID：10266803
> 
> 赞同：3
> 
> 时间：2012-04-22T09:31:31.593
> 
> 标签：java, swing

我想在面板中设置一个图像图标。我正在尝试这样做；

```
 JLabel label = new JLabel(new ImageIcon("logo.jpg"))
 panelHeader.add(label);
 add(panelHeader); 
```

但图像没有显示。任何建议我做错了什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-22T09:38:45.410

构造`new ImageIcon()`函数只是创建一个未初始化的图像图标。您必须调用[`createImageIcon()`](http://docs.oracle.com/javase/tutorial/uiswing/components/icon.html)返回`ImageIcon`源的方法以分配给您还创建的`ImageIcon`对象。

```
ImageIcon icon = createImageIcon("logo.jpg", "my logo");
JLabel label = new JLabel(icon); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-22T09:57:57.817

```
new ImageIcon("logo.jpg") 
```

an的`String`基础构造函数`ImageIcon`假定字符串表示文件路径。由于这是添加到面板的图像，因此在运行时，它可能位于 Jar 内，并且无法作为`File`. 对于嵌入式应用程序资源，唯一可行的访问是通过`URL`. 该 URL 可能来自以下内容：

```
URL logoUrl = this.getClass().getResource("/logo.jpg"); 
```

注意前导`/`。这告诉 JRE 在相对于类路径的根的路径上搜索资源，而不是相对于加载它的类的包的路径。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-04-22T10:09:00.500

您在创建`ImageIcon`. 您还应该查看添加标签的容器的布局。此[示例](https://stackoverflow.com/a/4170233/230513)使用`FlowLayout`, 的隐式默认值`JPanel`。

# java - 将 ArrayList 放入 HashMap 后的 Java StackOverflowError

> ID：10266804
> 
> 赞同：5
> 
> 时间：2012-04-22T09:31:43.943
> 
> 标签：java, arraylist, hashmap, stack-overflow

您好，有人可以向我解释为什么这段代码不起作用吗？

```
ArrayList<Object> list = new ArrayList<Object>();
list.add(list);

HashMap<Object, Integer> map = new HashMap<Object, Integer>();
map.put(list, 1); 
```

在我将列表放入地图后，它会抛出 StackOverFlowError。

我知道这段代码没有任何意义，我只想知道为什么它不起作用。

谢谢！

编辑：

堆栈跟踪：

```
Exception in thread "main" java.lang.StackOverflowError
    at java.util.ArrayList.get(Unknown Source)
    at java.util.AbstractList$Itr.next(Unknown Source)
    at java.util.AbstractList.hashCode(Unknown Source)
    at java.util.AbstractList.hashCode(Unknown Source)
    ... 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-04-22T09:35:46.910

发生这种情况是因为您正在尝试计算`ArrayList`包含自身的哈希值。`ArrayList`通过计算它引用的所有对象的哈希值来计算它自己的哈希值。当它引用自己时，它会一遍又一遍地尝试计算自己的哈希值，从而导致堆栈溢出。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-22T09:40:53.083

首先：我不确定。但据我所知，HashMap 是否会询问其 HashCode 的密钥（在您的情况下为列表）。HashMap 将此 HashCode 存储在一个表中以更快地找到元素。这就是为什么它被称为HashMap。当 List 被询问它的 HashCode 时，它​​会尝试计算它。我认为这就是问题所在。为了计算 HashCode，列表将询问每个包含的元素的 HashCode。这就是你得到stackoverflow的地方。

1）看一下HashMap的put方法：

[http://www.docjar.com/html/api/java/util/HashMap.java.html](http://www.docjar.com/html/api/java/util/HashMap.java.html)

2）然后看一下AbstractList（ArrayList的超类）的hashCode()方法：

[http://www.docjar.com/html/api/java/util/AbstractList.java.html](http://www.docjar.com/html/api/java/util/AbstractList.java.html)

# c - 在这种情况下我需要同步吗？

> ID：10266813
> 
> 赞同：3
> 
> 时间：2012-04-22T09:32:58.857
> 
> 标签：c, linux, gcc, x86-64

我有两个线程共享一个循环队列。队列的内容是无符号数字（`unsigned long`在 x86_64 上）。一个线程是生产者，另一个是消费者。如果队列中元素的值为 0，则生产者仅写入队列中的元素，并且生产者始终产生非零值，而消费者仅在其值为非零时才使用它。此外，消费者在消费时将元素重置为 0，以便生产者知道消费者已经消费了它。

现在我的想法是，由于使用这种方案，队列中的元素有严格的访问顺序，我们不需要使用同步或原子变量。我的假设正确吗？或者我在这里遗漏了什么？请记住，x86_64 具有相对严格的一致性内存模型，并且只能将不相关的加载放在存储之前。它还具有缓存一致性，可以主动更新缓存。我还使用`volatile`变量来确保编译器不会缓存它们。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-22T09:39:09.863

是的，您需要同步，因为如果消费者赶上了生产者，生产者和消费者可能会同时尝试从同一位置读取和/或写入，*反之亦然*。

即使您的处理器对您正在使用的数据类型执行原子操作，您通常也需要显式请求原子操作（通过适当的 API）以获得适当的内存屏障并确保即使您的线程在不同的内核上运行也能保持一致性。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-22T09:42:47.613

我认为您不需要同步或原子变量。

一个生产者和一个消费者的两个线程不会与写入相同的条目发生冲突。

因为如果您的循环队列实现是正确的（例如，一个读取头变量，一个写入标签变量），这两个线程就不能在同一位置运行。无需限制条目结构。

阅读后似乎不需要重置条目。因为你应该移动你的读取头，生产者线程可以通过比较读取头变量和写入标签变量来知道是否可以写入一个条目。

可能对你有帮助:)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-22T09:45:51.430

如果生产者和消费者只访问一个变量，您似乎不需要同步。但是既然你说你使用循环缓冲区，你就使用索引。如果不同步，索引变量很容易受到攻击。

# php - 使用小型 XML 作为数据库 - 查询的最佳方式

> ID：10266814
> 
> 赞同：0
> 
> 时间：2012-04-22T09:33:13.427
> 
> 标签：php, xml, database, jquery

我正在做一个供个人使用的小型爱好项目，它需要一种存储一些值的方法。我能想到的三种方法是使用：**MySQL**数据库、**XML**文件或 HTML5 的**LocalStorage**（如果您能想到其他方便的方法，请发表评论）。

现在，由于我可能想从另一个浏览器（例如移动设备）访问相同的值，因此**LocalStorage**显然不是这样做的方法。现在谈到**XML**，我知道它只是作为传输数据的一种手段，而数据存储应该在**MySQL**中完成。然而，由于这是一个小项目，只需要一个不超过几千字节的 XML 文件，感觉在这种情况下使用 XML 比设置 MySQL 数据库更方便。我对吗？

假设我想使用 XML，我如何使用**a)** PHP 和**b)** JQuery 或其他方式附加一些节点？你认为哪一种方法最方便？

我发现很少有写得很好的例子来说明如何做到这一点（尤其是使用 JQuery，我无法找到如何以直接方式附加 XML 文件的例子），所以如果你可以附上一些示例代码进行比较，谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-22T10:29:12.633

首先 - jQuery 是客户端脚本库。这意味着使用 jQuery（包括 XML 文件操作）执行的操作是在客户端完成的，不会影响服务器端。有人可能会说 jQuery 可以通过使用 AJAX 在服务器端执行操作，但实际上执行操作的是服务器脚本 (php/perl/asp(x))。

因此，假设您有少量数据需要查询和更新。这可以通过使用“平面”文件系统或使用数据库来完成。

1.  使用平面文件 - CSV 或 XML 是简单的选择。
    *   CSV/XML 文件可以使用[file-get-contents](http://php.net/manual/en/function.file-get-contents.php)和[file_put_contents](http://www.php.net/manual/en/function.file-put-contents.php)进行操作。如果您选择使用 XML，您可以使用出色的[SimpleXML](http://php.net/manual/en/book.simplexml.php)库（可以在[此处](http://www.willfitch.com/simplexml-tutorial-part1.html)找到基于示例的指南）使用 XML 允许您创建高级日期结构，
    *   XML 和 [SimpleXML](http://php.net/manual/en/book.simplexml.php)（可以在[此处](http://www.willfitch.com/simplexml-tutorial-part1.html)找到基于示例的指南）非常棒。使用 XML 还允许您创建高级日期结构
    *   缺点是更新平面文件将意味着相当大的安全风险，因为您需要向网站的其中一个文件夹授予写入权限，这通常是个坏主意。
2.  DB - MySQL 或 SQLite（如 @garrett-albright 建议的那样）一开始似乎有些矫枉过正，但使用 SQL 实际上会节省您的时间（因为代码会更简单，您将使用经过良好测试和记录的对象）并且有许多[CRUD](http://en.wikipedia.org/wiki/Create,_read,_update_and_delete)生成器和类可以为您完成大部分工作。使用数据库，您可以使用
    *   MySQL - 很棒的数据库，似乎是 PHP 的 BFF，易于使用，文档非常详细，并且通常免费提供托管包。
    *   SQLite - 我在小型数据库中的首选武器，不需要服务即可运行，几乎是零配置数据库。
    *   这两个数据库选项都支持[PDO](http://jp.php.net/pdo)，这将允许您编写代码并自由更改数据库和平台。

# wcf - 如何通过 WCF 路由服务传递 STS 令牌？

> ID：10266815
> 
> 赞同：0
> 
> 时间：2012-04-22T09:33:13.730
> 
> 标签：wcf, wif, wcf-routing

我试图通过 WCF 路由服务调用 WCF 声明感知服务，但它给了我以下错误。

“从另一方收到不安全或不正确安全的故障。有关故障代码和详细信息，请参阅内部 FaultException。”

并且在内部异常“处理消息中的安全令牌时发生错误。”

我的猜测是，路由无法传递/识别客户端发送的令牌（由 STS 提供）。

请为我提供通过 WCF 路由服务调用 WIF 声明感知服务的可行配置。真的很需要这个。

谢谢

米赞

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-07T13:23:40.133

查看此[MSDN 论坛答案](http://social.msdn.microsoft.com/Forums/en-US/wcf/thread/a3368f21-5b14-4de3-ae68-18c95a770217)中的配置，了解如何将 RoutingService 配置为将消息“传递”到目的地。要获得更详细的答案，您需要发布 RoutingService 的当前配置。

# ios - iPhone 应用程序 - 使用预先填充的数据库或依赖网络服务？

> ID：10266822
> 
> 赞同：0
> 
> 时间：2012-04-22T09:34:25.457
> 
> 标签：ios, core-data, ios5

我正在开发一个允许用户浏览产品目录的 iPhone 应用程序。该目录可能包含 1000 多个项目。每个产品都与一个品牌相关，并具有一些属性，例如颜色、尺寸等。

我正在考虑预填充一个 SQLlite DB 并将其包含在我的应用程序包中，然后，就像在[CoreDataBooks 示例](http://developer.apple.com/library/ios/#samplecode/CoreDataBooks/Listings/ReadMe_txt.html#//apple_ref/doc/uid/DTS40008405-ReadMe_txt-DontLinkElementID_15)中一样，在第一次启动时，我将使用`NSPersistentStoreCoordinator`来检查数据库是否已创建，如果没有则复制默认值数据库到所需位置并继续。

但是产品目录需要更新，并且由于数据库将保存用户添加的其他信息 - 例如将产品添加到收藏夹等，我不想在数据库初始化后覆盖它（从默认值开始） .

所以我在考虑使用网络，调用网络服务，但这不会对网络造成负担吗？浏览产品应该很快，我担心依赖webservice会拖慢速度，无法接受？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-22T09:43:56.830

如果你想更新数据库，没有别的办法，只能从网上下载。但是您无需在用户浏览目录时立即下载它来使其变慢 - 相反，您只需在每次用户启动应用程序时或其他周期性时刻检查服务器上是否有新内容 - 以及当用户开始browsinh，你的商店已经是最新的。就是这样！

这是一篇关于使用 Core Data 在后台获取数据的精彩文章，作者 Marcus Zarra

[http://www.cimgf.com/2011/05/04/core-data-and-threads-without-the-headache/](http://www.cimgf.com/2011/05/04/core-data-and-threads-without-the-headache/)

# c# - 收藏 > 收藏 在一个 linq 语句中

> ID：10266824
> 
> 赞同：1
> 
> 时间：2012-04-22T09:34:47.553
> 
> 标签：c#, .net, linq

我有`List<List<Person>>`我希望它将以前集合中的所有人复制到`List<Person>`集合中。

我这样做了：

```
 var People = new List<List<Person>>{ new List<Person>{...},...  };
        var people = new List<Person>();
        People.ForEach(q => people.AddRange(q.People));
        return people; 
```

有没有更好的方法来做到这一点？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-22T09:44:51.787

```
var allPersons = People.SelectMany(p => p); 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-04-22T09:45:04.133

您应该为此使用[`SelectMany`](http://msdn.microsoft.com/en-us/library/bb534336.aspx)扩展方法：

```
var people = People.SelectMany(p => p) 
```

# javascript - 有没有办法在 javascript 中克隆本机函数，如 window.alert 或 document.write

> ID：10266825
> 
> 赞同：2
> 
> 时间：2012-04-22T09:35:00.950
> 
> 标签：javascript, function, clone, native-methods

我想要做的是将代码中的每个警报更改为自定义警报（“您使用警报”）；

```
var hardCodedAlert = alert; //I know this won't work.But what to do ?
window.alert=function(){
if(this.count == undefined)
this.count=0;
this.count=this.count+1;
if(this.count == 1)
hardCodedAlert("You used alert");
}; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-22T10:12:50.477

是的，您可以这样做（例如）：

```
var oldalert = window.alert;
window.alert= function alert(t){
  alert.count = !alert.count ? 1 : alert.count + 1;
  oldalert(t+' - That\'s alert nr '+alert.count);
}; 
```

看到[这个jsfiddle](http://jsfiddle.net/KooiInc/YK6ca/)

# entity-framework - 使用 EF 创建多对多引用

> ID：10266827
> 
> 赞同：0
> 
> 时间：2012-04-22T09:35:12.303
> 
> 标签：entity-framework, many-to-many, poco

在我当前的项目（非常小）中，我有 3 个表/ **POCO 实体**，我想使用 EF 进行操作。

这些表格是：

1.  *状态*（包含状态详细信息）
2.  *StatusStatusType*（由于多对多关系而需要）
3.  *StatusType*（用于按类型对状态进行分组的表）

我现在想在数据库和用户代码中创建一个新状态，如下所示

```
//Create new status (POCO) entity
var newStatus = new Status {
    StatusId = status.Id,
    UserId = user.Id,
    Text = status.text,
    CreateDate = DateTime.Now
};

// Persist need status to database
using (var db = new demoEntities())
{
    db.Statuses.AddObject(newStatus);
    db.SaveChanges();
} 
```

此代码工作正常，但我还想设置状态实体的*StatusType*。所有可能的状态类型都已包含在*StatusType*表中。我不想创建新状态只创建一个参考。

我想我应该使用类似的东西：

```
status.StatusTypes == "new"; 
```

## 更新 22-04-2012 13:31

该示例经过简化并跨越解决方案中的多个项目。因此，我不喜欢在创建部分中使用代码（例如 demoEntities）。但是我知道我需要参考的状态的 PK。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-22T10:13:25.437

如果您知道您的状态类型已经存在，那么您现在还必须使用它的主键。一旦你有一个主键值，你可以使用这种方法：

```
var newStatus = new Status {
    StatusId = status.Id,
    UserId = user.Id,
    Text = status.text,
    CreateDate = DateTime.Now
};

// Just dummy object for existing status type
var existingStatusType = new StatusType {
    Id = existingStatusTypeId
};

// Persist need status to database
using (var db = new demoEntities())
{
    db.Statuses.AddObject(newStatus);
    // First let EF know that the status type already exists
    // Attaching prior to making relation is important!
    db.StatusTypes.Attach(existingStatusType);
    // Now make relation between new and existing entity 
    newStatus.StatusTypes.Add(existingStatusType);
    db.SaveChanges();
} 
```

如果您不想在持久性代码中创建关系，则必须使用一些不同的方法。

```
var newStatus = new Status {
    StatusId = status.Id,
    UserId = user.Id,
    Text = status.text,
    CreateDate = DateTime.Now
};

// Just dummy object for existing status type
var existingStatusType = new StatusType {
    Id = existingStatusTypeId
};

newStatus.StatusTypes.Add(existingStatusType);

// Persist need status to database
using (var db = new demoEntities())
{
    // This will add both newStatus and existingStatusType as new entities
    db.Statuses.AddObject(newStatus);
    // You must fix it to make sure that existingStatusType is not inserted 
    // to database again
    status.StatusTypes.ForEach(st =>
        db.ObjectStateManager.ChangeObjectState(st, EntityState.Unchanged));
    db.SaveChanges();
} 
```

# android - 球移动到 android 中的 action_down 位置

> ID：10266828
> 
> 赞同：0
> 
> 时间：2012-04-22T09:35:12.880
> 
> 标签：android, canvas

我在屏幕上有一个球。我想当我实现 action_down 时，球会移动到这个位置。这是我的代码：

```
 public boolean onTouchEvent(MotionEvent event){

        if(event.getAction()==MotionEvent.ACTION_DOWN){
            x1 = (int) event.getX();
            y1 = (int) event.getY();

            float dx = x1-x;
            float dy = y1-y;
            float d = (float)Math.sqrt(dx*dx+dy*dy);
            vx = dx*4/d;
            vy = dy*4/d;
        }
} 
```

和 onDraw：

```
protected void onDraw(Canvas canvas) {
        canvas.drawColor(Color.BLACK);

        Matrix matrix = new Matrix();
        matrix2.postTranslate(x - bitmap.getWidth()/2, y - bitmap.getHeight()/2);
        x = x+vx ;
        y = y+vy ;

        canvas.drawBitmap(bitmap, matrix, null);
} 
```

什么时候，小球会移动到action_down的位置。但是为什么小球在action_down的位置，却没有停下来呢？

请帮我？谢谢？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-22T09:44:16.047

将vx、vy的类型改为int

```
 vx = (int)dx*4/d;
    vy = (int)dy*4/d; 
```

然后用这个

```
 if(Math.abs(x - x1) <= Math.abs(vx) 
        && Math.abs(y - y1) <= Math.abs(vy)){ 
            vx = 0; 
            vy = 0; 
            x = x1;
            y = y1;
    } 
```

# java - java 6 线程中断

> ID：10266834
> 
> 赞同：2
> 
> 时间：2012-04-22T09:35:37.703
> 
> 标签：java, multithreading

我有这段代码：

```
public class ThreadInteraction {
       public static void main(String[] argv) {
        System.out.println("Create and start a thread t1, then going to sleep...");
        Thread1 t1 = new Thread1();
        t1.start();

        try{
            Thread.sleep(1000);
        }
        catch(InterruptedException e) {
            System.out.println(e.toString());
        }

            //let's interrupt t1
            System.out.println("----------- Interrupt t1");
        t1.interrupt();

        for(int i =0; i<100; i++)
            System.out.println("Main is back");
     }
}

class Thread1 extends Thread {
      public void run() {
         for(int i =0; i<10000; i++)
              System.out.println(i + "thread1");
      }
 } 
```

似乎`t1.interrupt()`不起作用，因为在我的输出中出现了所有 10000 t1 打印。难道我做错了什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-22T09:42:41.820

`Thread.interrupt()`实际上并没有阻止任何事情。此方法仅用于设置线程的中断状态，但您必须检查它。这是您应该如何组织代码以使其工作的方式：

```
public void run() {
    for (int i = 0; i < 10000; i++) {
        if (interrupted()) break;
        System.out.println(i + "thread1");
    }
} 
```

`Thread.interrupted()`这里清除中断状态，这没关系，因为我们直接控制线程。如果您尝试检测中断，例如，在`java.util.concurrent. Callable`线程池的一个线程上运行，那么最好使用，`Thread.currentThread().isInterrupted();`因为您不知道线程中断策略。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-22T09:42:17.187

[`Thread.interrupt`](http://docs.oracle.com/javase/1.4.2/docs/api/java/lang/Thread.html#interrupt())只有在非常特定的状态下才会导致目标线程停止：

> 首先调用该线程的 checkAccess 方法，这可能会导致抛出 SecurityException。
> 
> 如果该线程在调用 Object 类的 wait()、wait(long) 或 wait(long, int) 方法或 join()、join(long)、join(long, int) 时被阻塞, sleep(long), or sleep(long, int), 这个类的方法，那么它的中断状态会被清除并且会收到一个InterruptedException。
> 
> 如果此线程在可中断通道上的 I/O 操作中被阻塞，则通道将关闭，线程的中断状态将被设置，并且线程将收到 ClosedByInterruptException。
> 
> 如果该线程在 Selector 中被阻塞，则线程的中断状态将被设置，并且它将立即从选择操作返回，可能带有非零值，就像调用了选择器的唤醒方法一样。
> 
> **如果前面的条件都不成立，则将设置该线程的中断状态。**

`isInterrupted`如果您希望线程提前退出该循环，则需要检查您的线程。

```
for(int i =0; i<10000 && !isInterrupted(); i++) 
```

# java - 为任何系统配置找到最大堆大小和最大永久代大小的程序/方法？

> ID：10266835
> 
> 赞同：0
> 
> 时间：2012-04-22T09:35:38.783
> 
> 标签：java, permgen, java-memory-model

要测试最大堆大小和最大 permgen 空间，根据 Gilli[在 Windows 中每个 java 进程的最大内存量中建议的回复？](https://stackoverflow.com/questions/987219/max-amount-of-memory-per-java-process-in-windows/987576)，我写了一个简单的java类，主要方法只是打印系统

当我使用以下参数从控制台运行该类时，它运行良好，但使用 2048 它给出了错误无法保留无法为对象堆保留足够的空间。这意味着对于我的系统，最大堆大小允许在 1536 到 2048 之间

```
 java -Xms1536m -Xmx1536m  TestJVMParam 
```

根据[http://publib.boulder.ibm.com/infocenter/javasdk/tools/index.jsp?topic=/com.ibm.java.doc.igaa/_1vg00014884d287-11c3fb28dae-7ff6_1001.html](http://publib.boulder.ibm.com/infocenter/javasdk/tools/index.jsp?topic=/com.ibm.java.doc.igaa/_1vg00014884d287-11c3fb28dae-7ff6_1001.html)的链接，据说

在运行 64 位 Java 时，操作系统提供给 Java 进程的内存空间非常大。因此，您可以假设由于 Java 堆和本机堆之间的内存资源争用，Java 堆的最大大小没有限制。

**所以我有 8 GB 的内存，为什么 VM 无法为对象堆保留足够的空间？**

现在我想要的第二件事是为我的系统找到最大 permgen 大小。所以我用以下参数运行了相同的程序

```
 java -Xms1536m -Xmx1536m -XX:PermSize=128m -XX:MaxPermSize=128m TestJVMParam 
```

**但它再次说无法为对象堆保留足够的空间。这怎么可能，因为我有 8GB RAM 和 windows7 64 位操作系统。而且它甚至不允许128m的permgen？**我确定我在这里遗漏了一些东西，但无法弄清楚？

# java - Apache POI Word 教程。

> ID：10266844
> 
> 赞同：9
> 
> 时间：2012-04-22T09:37:27.547
> 
> 标签：java, apache, apache-poi

有人知道有关使用 Apache POI 库使用 MS Word 的好教程吗？我想了解如何创建 word 文档*.doc*（或者我可能需要创建模板*.dot*）来创建像`${customer.name}`内部文档（模板）这样的变量，然后通过替换它`Range.replaceText("${customer.name}","Microsoft CO");` 或者可能`${customer.name}`不是变量，只是纯文本（为了更清楚起见，它被命名为变量名）？我也没有找到关于在 POI 中使用表格的教程。

事实上，我有 .doc 文档，我需要在其中替换一些变量，如姓名、姓氏，并且还需要用一些值填充表。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-06T21:12:11.137

您可以使用 Microsoft Word 在 Word 文档中使用书签。我一周前已经完成了。我通过选择要替换的文本在文档中插入书签，然后插入 -> 书签并输入新的书签名称。之后，在您的代码中，您应该在您的 util 类中实现类似的内容：

```
/** 
 * Inserts a value at a location within the Word document specified by a 
 * named bookmark. 
 * 
 * @param bookmarkName An instance of the String class that encapsulates 
 *        the name of the bookmark. Note that case is important and the case 
 *        of the bookmarks name within the document and that of the value 
 *        passed to this parameter must match. 
 * @param bookmarkValue An instance of the String class that encapsulates 
 *        the value that should be inserted into the document at the location 
 *        specified by the bookmark. 
 */ 
public final void insertAtBookmark(String bookmarkName, String bookmarkValue, Style style) { 
    List<XWPFTable> tableList = null; 
    Iterator<XWPFTable> tableIter = null; 
    List<XWPFTableRow> rowList = null; 
    Iterator<XWPFTableRow> rowIter = null; 
    List<XWPFTableCell> cellList = null; 
    Iterator<XWPFTableCell> cellIter = null; 
    XWPFTable table = null; 
    XWPFTableRow row = null; 
    XWPFTableCell cell = null; 

    // Firstly, deal with any paragraphs in the body of the document. 
    this.procParaList(this.document.getParagraphs(), bookmarkName, bookmarkValue, style); 

    // Then check to see if there are any bookmarks in table cells. To do this 
    // it is necessary to get at the list of paragraphs 'stored' within the 
    // individual table cell, hence this code which get the tables from the 
    // document, the rows from each table, the cells from each row and the 
    // paragraphs from each cell. 
    tableList = this.document.getTables(); 
    tableIter = tableList.iterator(); 
    while(tableIter.hasNext()) { 
        table = tableIter.next(); 
        rowList = table.getRows(); 
        rowIter = rowList.iterator(); 
        while(rowIter.hasNext()) { 
            row = rowIter.next(); 
            cellList = row.getTableCells(); 
            cellIter = cellList.iterator(); 
            while(cellIter.hasNext()) { 
                cell = cellIter.next(); 
                this.procParaList(cell.getParagraphs(), 
                        bookmarkName, 
                        bookmarkValue, style); 
            } 
        } 
    } 
}

/** 
 * Inserts text into the document at the position indicated by a specific 
 * bookmark. Note that the current implementation does not take account 
 * of nested bookmarks, that is bookmarks that contain other bookmarks. Note 
 * also that any text contained within the bookmark itself will be removed. 
 * 
 * @param paraList An instance of a class that implements the List interface 
 *        and which encapsulates references to one or more instances of the 
 *        XWPFParagraph class. 
 * @param bookmarkName An instance of the String class that encapsulates the 
 *        name of the bookmark that identifies the position within the 
 *        document some text should be inserted. 
 * @param bookmarkValue An instance of the AString class that encapsulates 
 *        the text that should be inserted at the location specified by the 
 *        bookmark. 
 */ 
private final void procParaList(List<XWPFParagraph> paraList, 
        String bookmarkName, String bookmarkValue,Style style) { 
    Iterator<XWPFParagraph> paraIter = null; 
    XWPFParagraph para = null; 
    List<CTBookmark> bookmarkList = null; 
    Iterator<CTBookmark> bookmarkIter = null; 
    CTBookmark bookmark = null; 
    XWPFRun run = null; 
    Node nextNode = null; 

    // Get an Iterator to step through the contents of the paragraph list. 
    paraIter = paraList.iterator(); 
    while(paraIter.hasNext()) { 
        // Get the paragraph, a llist of CTBookmark objects and an Iterator 
        // to step through the list of CTBookmarks. 
        para = paraIter.next(); 
        bookmarkList = para.getCTP().getBookmarkStartList(); 
        bookmarkIter = bookmarkList.iterator(); 

        while(bookmarkIter.hasNext()) { 
            // Get a Bookmark and check it's name. If the name of the 
            // bookmark matches the name the user has specified... 
            bookmark = bookmarkIter.next(); 
            if(bookmark.getName().equals(bookmarkName)) { 
                // ...create the text run to insert and set it's text 
                // content and then insert that text into the document. 
                run = para.createRun(); 
                run.setText(bookmarkValue); 
                //run.set
                /*CTR ctr = run.getCTR(); 
                CTRPr ctrPr = ctr.getRPr(); 

                if(ctrPr == null) { 
                    ctrPr = ctr.addNewRPr(); 
                } */
                if(defaultStyle != null || style != null){
                //ctrPr.addNewRFonts().setAscii("Calibri");
                    if(style != null){
                        applyStyleToRun(style, run);
                        if(style.isCenter()) para.setAlignment(ParagraphAlignment.CENTER);
                    }else{
                        if(defaultStyle.isCenter()) para.setAlignment(ParagraphAlignment.CENTER);
                        applyStyleToRun(defaultStyle, run);
                    }

                }

                // The new Run should be inserted between the bookmarkStart 
                // and bookmarkEnd nodes, so find the bookmarkEnd node. 
                // Note that we are looking for the next sibling of the 
                // bookmarkStart node as it does not contain any child nodes 
                // as far as I am aware. 
                nextNode = bookmark.getDomNode().getNextSibling(); 
                // If the next node is not the bookmarkEnd node, then step 
                // along the sibling nodes, until the bookmarkEnd node 
                // is found. As the code is here, it will remove anything 
                // it finds between the start and end nodes. This, of course 
                // comepltely sidesteps the issues surrounding boorkamrks 
                // that contain other bookmarks which I understand can happen. 
                while(nextNode != null &&  nextNode.getNodeName() != null &&  !(nextNode.getNodeName().contains("bookmarkEnd"))) { 
                    para.getCTP().getDomNode().removeChild(nextNode); 
                    nextNode = bookmark.getDomNode().getNextSibling(); 
                } 

                // Finally, insert the new Run node into the document 
                // between the bookmarkStrat and the bookmarkEnd nodes. 
                para.getCTP().getDomNode().insertBefore( 
                        run.getCTR().getDomNode(), 
                        nextNode); 
            } 
        } 
    } 
}

/**
 * Applique un style sur un XWPFRun 
 * @param style
 * @param run
 */
private void applyStyleToRun(Style style, XWPFRun run) {
    run.setFontSize(style.getFontSize());
    if(style.getFontFamily() != null){
        run.setFontFamily(style.getFontFamily());
    }
    run.setBold(style.isBold());
    run.setItalic(style.isItalic());
    if(style.getColorCode() != null){
        run.getCTR().addNewRPr().addNewColor().setVal(style.getColorCode());
    }

} 
```

原始代码在这里找到：http: [//apache-poi.1045710.n5.nabble.com/Replacing-the-value-of-the-bookmarks-td5710052.html](http://apache-poi.1045710.n5.nabble.com/Replacing-the-value-of-the-bookmarks-td5710052.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-05T05:53:17.723

你有机会尝试吗

[http://svn.apache.org/viewvc/poi/trunk/src/scratchpad/testcases/org/apache/poi/hwpf/](http://svn.apache.org/viewvc/poi/trunk/src/scratchpad/testcases/org/apache/poi/hwpf/)

我建议在您的 IDE 中将源代码作为一个单独的项目检出，并参考相关的测试用例。

# html - 图像不会填充 div

> ID：10266849
> 
> 赞同：8
> 
> 时间：2012-04-22T09:38:08.687
> 
> 标签：html, css, image

CSS/HTML 问题。

这太疯狂了——我只能假设我是个白痴。我无法让我的图像填充它所在的 div。图像下方始终有 5px 的“填充”。

这是html：

```
<!doctype html>

<head><link rel="stylesheet" href="style.css" type="text/css" /></head>

<body>
<div class="row">
<img src="pic2.jpg" />
</div>
</body> 
```

这是CSS：

```
body, .row, img {
padding: 0;
margin: 0;
border: none;
}

.row {
width: 80%;
background-color: orange;
}

img{
width: 50%;
} 
```

这是结果：

[http://imgur.com/yELMe](http://imgur.com/yELMe)

如您所见，（愚蠢的）蓝色和红色图像没有填充橙色 div。图像下方显示一致的 5px 橙色。这不受 div 或图像的 % 宽度更改或调整窗口大小的影响。

我可以用“margin: -5px;”来解决这个问题，但我想知道它为什么会发生（尤其是在不同的情况下，数量大于或小于 5px）。

感谢您的帮助（如果这对我来说是一个荒谬的错误，再次抱歉）。

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2012-04-22T09:46:59.913

为您的图像添加一个[垂直对齐](https://developer.mozilla.org/en-US/docs/Web/CSS/vertical-align)值（默认值`baseline`除外），例如：`top`，`middle`...

```
vertical-align: top; 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2019-04-09T08:16:17.587

我通过设置来解决这个`display`问题：`img``block`

```
display: block; 
```

# function - Ext.XTemplate 中的内联变量

> ID：10266850
> 
> 赞同：3
> 
> 时间：2012-04-22T09:38:10.403
> 
> 标签：function, templates, variables, extjs, sencha-touch-2

嗨，我使用的是 sencha touch 2，但 Ext.XTemplate 有一些问题。

当我使用下一个模板并且它工作正常时：

```
var template = new Ext.XTemplate(
    '<div title="{currentLocation:this.tr}">',
        '<img src="styles/css/img/locate.png" height="30px" width="30px" />',
    '</div>',
    {
        compiled: true,
        tr: function(value) {
            return 'translated ' + value;
        }
    }
);

template.apply({currentLoaction: 'Current location'});

<div title="Current Location">
    <img src="styles/css/img/locate.png" height="30px" width="30px" />
</div> 
```

但我更喜欢`'Current location'`在模板中设置变量，但它不能正常工作（`{\'Current location\':this.tr}`返回空值）：

```
var template = new Ext.XTemplate(
    '<div title="{\'Current location\':this.tr}">',
        '<img src="styles/css/img/locate.png" height="30px" width="30px" />',
    '</div>',
    {
        compiled: true,
        tr: function(value) {
            return 'translated ' + value;
        }
    }
);

template.apply();

<div title="">
    <img src="styles/css/img/locate.png" height="30px" width="30px" />
</div> 
```

我尝试使用`this.tr(currentLocation)`and`this.tr(\'Current location\')`而不是`currentLocation:this.tr`and `\'Current location\':this.tr`，但是在这两种情况下都返回模板`<div title="`。

谁能解释我做错了什么以及如何解决我的问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-22T18:45:25.687

如果括在方括号中，则可以执行任意代码，请参阅[Ext.XTemplate](http://docs.sencha.com/touch/2-0/#!/api/Ext.XTemplate)。所以在你的例子中：

```
var template = new Ext.XTemplate(
    '<div title="{[this.tr(\'Current location\')]}">',
        '<img src="styles/css/img/locate.png" height="30px" width="30px" />',
    '</div>',
    {
        compiled: true,
        tr: function(value) {
            return 'translated [' + value + ']';
        }
    }
);

document.write(template.apply()); 
```

# php - jQuery 将每个 PHP 响应视为具有状态 0

> ID：10266859
> 
> 赞同：2
> 
> 时间：2012-04-22T09:38:59.857
> 
> 标签：php, javascript, jquery, html

我一直在尝试获取 javascript 来检查用户是否存在于 MySQL 数据库中。

为此，我使用 jQuery 将用户详细信息发布到检查 MySQL 数据库的 PHP 脚本中。

jQuery POST 成功地将数据传递给 PHP 脚本。我已经检查过了：

*   通过让 PHP 脚本向我发送电子邮件，告诉我它已经获得了数据。
*   通过使用 Firebug 跟踪调用
*   通过使用 Wireshark 跟踪数据包交换

但是，jQuery 坚信每次从 PHP 脚本获得响应时，状态都是 0。

在 firebug 跟踪和 wireshark 跟踪中，来自 PHP 脚本的 HTML 响应中的状态始终为“200 OK”。

我尝试了许多想法（很多遇到类似问题的人建议），比如强制编码为 json 并将 jQuery POST 调用中的数据类型设置为“json”，比如在PHP 脚本，例如使用 GET 而不是 POST。

我已经将我的 HTML、javascript 和 PHP 简化到了最低限度，但我仍然无法让 jQuery 确定响应的状态不是 0。

我现在得到的：

HTML 代码：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org    /TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Untitled Document</title>
</head>

<SCRIPT SRC="Templates/nop_shopping_cart/jquery-1.7.2.js"></SCRIPT>
<script type="text/javascript">
function checkUser()
{
 alert("clicked");
    jQuery.post( 'http://solfacats.com/dsadmin/valUser2.php', {email: "test", password:  "test"}, function(data) { alert("returned"+data)}, "html" );

}
</SCRIPT>

<body>
<button onclick="Javascript: checkUser();"> "test" </button>
</body>
</html> 
```

PHP代码：

```
<?php 
echo "test";
?> 
```

注意 - 为了跟踪正在发生的事情，我在 jquery-1.7.2.js 的 done() 函数中使用了对 alert() 的调用。其中一个警报会弹出传递给 done() 的变量状态的值。这始终显示变量状态的值为零。

另外，请注意 - 如果我通过在该函数的早期添加行“status = 200”来破解 done() 函数，则调用 jQuery.post 中的回调函数，但它认为传递的数据变量的值它是空的。

我已经在 IE、Firefox 和 Safari 上尝试过这个，并且在它们上都遇到了同样的问题。

有没有人有一些关于我应该从这里去哪里让 jQuery 看到 PHP 响应成功并成功地从响应中提取数据的一些好的指示？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-22T11:05:54.267

不能说你是如何调试你的代码的，但对我来说，当我尝试使用你的代码时，显然[相同的来源策略](https://developer.mozilla.org/en/Same_origin_policy_for_JavaScript)会阻止你对不同域的 AJAX 请求。

您可以使用`JSON-P`with a`timeout`来验证是否真的调用了 AJAX。如果请求超时，则某些网络问题正在杀死它。可以通过以下代码进行跟踪：

```
function checkUser() {
     alert("clicked");
     var email = "test";
     var password=  "test";
     var url = "http://solfacats.com/dsadmin/valUser2.php";
     $.ajax({
         url: url,
         type: "post",
         data: "email="+ email + "&password=" + password,
         dataType: 'jsonp', //it helps you in cross-domain data transfer
         crossDomain : true,
         timeout : 2500, /* it is in milliseconds (i have greater timeout 
                         as my net is very slow, generally a timeout of
                         500 milliseconds will be sufficient)*/
         complete : function(xhr, responseText, thrownError) {
             if(xhr.status == "200") {
                alert(responseText); //yes response came
             }
             else{
                alert("No response"); //no response came
             }
         }
     });
 } 
```

这样你就可以得到回应。但它会在控制台中抛出 JS 错误。要使用 JSON-P 传递数据，您必须在服务器端生成格式正确的数据。一个有效的响应示例是：

```
parseResponse({"Name": "Foo", "Id" : 1234, "Rank": 7}); 
```

*   上面例子的 Demo 在[这里](http://jsfiddle.net/8b6Lm/1/)
*   [您可以在维基百科](http://en.wikipedia.org/wiki/JSONP)中找到更多信息

希望这可以帮助。快乐编码。:)

# python - 具有私有块功能的 Wiki 引擎

> ID：10266866
> 
> 赞同：1
> 
> 时间：2012-04-22T09:40:00.093
> 
> 标签：python, wiki

我正在寻找 wiki 引擎，最好用 python 编写（但不是必需的），具有一个特定功能 - 用户应该能够在页面上插入块，该块仅对一个用户可见，作者。玩龙与地下城需要这个 wiki。地下城主应该可以为自己插入一个标记。

*也许我应该在[https://rpg.stackexchange.com/](https://rpg.stackexchange.com/)上问这个？*

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-15T14:54:48.753

[我在这里](https://rpg.stackexchange.com/questions/13717/wiki-engine-for-dd)收到了答案

> [Moinmoin](http://moinmo.in/)非常适合该法案。它具有分层 ACL，可以做你想做的事，并且是用 Python 编写的

.

# linq-to-entities - LINQ To Entities 多次运行查询和超时过期

> ID：10266868
> 
> 赞同：1
> 
> 时间：2012-04-22T09:40:12.943
> 
> 标签：linq-to-entities

我有一个使用 LINQ To Entites 来处理数据库的站点。

我经常遇到一个异常：

> 过期超时异常

我检查了 SQL Profiler，发现某些查询似乎经常执行（而不是像预期的那样执行一次）。这些查询需要很长时间。

当我直接对数据库运行查询时，它执行得很快。

[我的查询截图](http://i.stack.imgur.com/JkU65.png)

这是什么原因，如何解决？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-23T18:53:27.667

对于分析器中选定的查询，持续时间为 30176 毫秒，超过 30 秒。这是你的超时时间。您需要查看数据库并弄清楚为什么应该花费 2 秒（看起来仍然很多）的查询需要 30 秒。

# mysql - 如何使用 Doctrine2 和 Symfony2 查看数据库模式更新的自动生成 SQL 查询？

> ID：10266874
> 
> 赞同：12
> 
> 时间：2012-04-22T09:41:30.933
> 
> 标签：mysql, sql, symfony, doctrine-orm

我在 Symfony2 项目中添加了一些数据库表。然后，我使用了以下命令：

```
php app/console doctrine:generate:entities Acme 
```

更新课程。然后，我尝试使用以下命令更新 MySQL 数据库：

```
php app/console doctrine:schema:update --force 
```

但是，我收到以下错误消息

```
[PDOException]                                                                              
SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; 
check the manual that corresponds to your MySQL server version for the right syntax to use near
'like TINYINT(1) NOT NULL, created_at DATETIME NOT NULL, INDEX IDX_8EA4B675A76ED3' at line 1 
```

如何查看哪个 SQL 查询错误？自动生成的 SQL 查询放在哪里？

提前致谢。

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2012-04-22T09:46:00.320

跑`php app/console doctrine:schema:update --dump-sql`

# regex - 用 if then else 重写 url 的正则表达式

> ID：10266875
> 
> 赞同：3
> 
> 时间：2012-04-22T09:41:47.020
> 
> 标签：regex, url-rewriting

鉴于这些网址：

```
1: http://site/page-name-one-123/
2: http://site/page-name-set2/
3: http://site/set20 
```

我写了这个表达式**，它将应用于最后一个 url 段**：

```
(?(?<=set[\d])([\d]+)|([^/]+)) 
```

我想要做的是仅当 url 段以 'set' 开头且紧随其后的数字时才捕获每个数字后跟 'set' ；否则我想使用整个段（不包括斜杠）。

当我写这个正则表达式时，它匹配任何不是'/'的字符。我认为我在测试语句中做错了什么。有人能指点我吗？

谢谢

**更新** 感谢[Josh](https://stackoverflow.com/users/733347/josh-davenport)的输入，我玩了一会儿，发现这个更适合我的需求：

```
set-(?P<number>[0-9]+)|(?P<segment>[^/]+) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-22T10:12:46.407

我希望这个模式可以帮助你，我根据你的要求把它放在一起。您可能想尝试将某些组设置为不捕获，以便仅获得所需的片段。但是，它确实会在开始时单独捕获您*设置*的 URL，而无需*设置*。

```
((?<=/{1})(((?<!set)[\w|-]*?)(\d+(?=/?))|((?:set)\d+))) 
```

如果需要，我建议使用[RegExr将其分开。](http://gskinner.com/RegExr/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-22T10:39:32.057

尝试这个：

`((?<=/)set\d+|(?<=/)[^/]+?set\d+)`

**解释**

```
<!--
Options: ^ and $ match at line breaks

Match the regular expression below and capture its match into backreference number 1 «((?<=/)set\d+|(?<=/)[^/]+?set\d+)»
   Match either the regular expression below (attempting the next alternative only if this one fails) «(?<=/)set\d+»
      Assert that the regex below can be matched, with the match ending at this position (positive lookbehind) «(?<=/)»
         Match the character “/” literally «/»
      Match the characters “set” literally «set»
      Match a single digit 0..9 «\d+»
         Between one and unlimited times, as many times as possible, giving back as needed (greedy) «+»
   Or match regular expression number 2 below (the entire group fails if this one fails to match) «(?<=/)[^/]+?set\d+»
      Assert that the regex below can be matched, with the match ending at this position (positive lookbehind) «(?<=/)»
         Match the character “/” literally «/»
      Match any character that is NOT a “/” «[^/]+?»
         Between one and unlimited times, as few times as possible, expanding as needed (lazy) «+?»
      Match the characters “set” literally «set»
      Match a single digit 0..9 «\d+»
         Between one and unlimited times, as many times as possible, giving back as needed (greedy) «+»
--> 
```

# jquery - 在 jquery animate 中，如何使用自定义对象而不是 div？

> ID：10266877
> 
> 赞同：3
> 
> 时间：2012-04-22T09:41:57.077
> 
> 标签：jquery

我的情况是这样开始的：我想为 div 的背景图像设置动画，但似乎使用 jquery 我无法检索背景图像的各个位置（背景位置）。所以我想为什么不创建一个对象并为其值设置动画，然后将这些值放入 css 中，但我不知道如何做到这一点。这是我尝试过的。

```
var obj={t:0};
                $("#wrapper").animate({
                    obj:100 //I tried obj.t & t as well
                },1000,'linear',function(){},function(){
                    $("#wrapper").css({
                            'background-position':obj.t+"% 0%"
                        });
                }); 
```

另外我需要问的一个问题是，如果图片真的很大，我的意思是大约4000x4000px，将它设置为背景图像并更改背景位置会更好，还是围绕div本身移动？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-22T10:06:55.723

您需要使用animate 方法的[`step`功能](http://api.jquery.com/animate/#step)`#wrapper`，更重要的是您需要为实际对象设置动画..而不是元素

```
var obj = {
    t: 0
};

$(obj).animate({ // call animate on the object
    t: 100 // specify the t property of the object to be animated
}, {
    duration: 1000,
    easing: 'linear',
    step: function(now) { // called for each animation step (now refers to the value changed)
        $("#wrapper").css({
            'background-position': now + "% 0%"
        });
    }
}); 
```

**演示在** [http://jsfiddle.net/gaby/yPq8s/1/](http://jsfiddle.net/gaby/yPq8s/1/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-22T10:03:27.647

如何为背景图像创建一个单独的 div，如果它有内容，然后将该 div 的内容放入另一个 z-index 更高的 div，然后为 div（带有背景图像）本身设置动画，而不是为背景位置设置动画?

我想你的第二个问题的答案与你想要达到的目标有关。虽然如果选择将带有 bg 图像的 div 分配给它自己的 z-index，那么我认为使用 div 的位置本身而不是背景图像的背景位置是值得的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-22T09:55:02.923

您可以使用以下方法检索背景图像的背景位置`.css()`：

```
$('#el').css('background-position'); 
```

我创建了一个简单的 JS Fiddle 动画背景图像：

[http://jsfiddle.net/yPq8s/](http://jsfiddle.net/yPq8s/)

# .net - 如何存储许多数据块的哈希，并通过哈希检索列表？

> ID：10266881
> 
> 赞同：0
> 
> 时间：2012-04-22T09:42:16.673
> 
> 标签：.net, performance, algorithm, low-level

我正在开发一个实现重复数据删除的开源项目。（有关该项目的链接，请参阅下面的两个超链接）该项目的性能目前还不错，但随着更多块写入磁盘而降级。这是由于 HashManager。对于每个写入的块，hashmanager 存储一个 Hash-BlockId 对。对于重复数据删除过程，需要具有给定哈希的块标识符列表。（使用的hash为Crc32）HashManager的接口见[源码](https://github.com/terwoord/overdrive/blob/master/Sources/Core/IHashManager.cs)。

该接口的当前[实现](https://github.com/terwoord/overdrive/blob/master/Sources/Core/Implementations/SimpleHashManager.cs)将列表存储在 256 个文件（crc & 0xFF）中，并将完整的列表加载到内存中。当需要另一个列表时，保存前一个列表并加载下一个列表。除了这可能导致内存耗尽这一事实之外，这还意味着性能下降。

有什么好的选择来克服这个问题？

（只是为了澄清：在去重之前完全检查块以查看它们是否匹配）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-22T19:50:01.103

我不是磁盘结构方面的专家，但我听说 B-Tree 通常用于实现存储在磁盘上的键值映射。所以我想你可以有一个 CRC 的 B-Tree 索引，然后将某种链接存储到块 ID 列表中。您还可以将列表组合到 B-Tree 结构中，方法是有效地拥有一个键，即 CRC 和块 ID 的串联，然后在 B-Tree 上执行有效的前缀/范围查询.

[Wikipedia Page on B-Trees](http://en.wikipedia.org/wiki/B-tree)：“在计算机科学中，B-tree 是一种树数据结构，它保持数据排序并允许在对数时间内进行搜索、顺序访问、插入和删除。B-tree 是二进制的概括搜索树，因为一个节点可以有两个以上的子节点。（Comer 1979, p. 123）与自平衡二叉搜索树不同，B 树针对读取和写入大块数据的系统进行了优化。它常用在数据库和文件系统中。”

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-01-02T22:35:48.180

如果您使用 256 个列表文件来存储 crcs，那么显而易见的第一步是将所有以字节 0 开头的 crcs 放入列表 0 中，将所有字节为 1 的 crcs 放入列表文件 1 中，等等。然后只存储每个文件中 crc 的最后三个字节。这将节省 25% 的密钥存储空间，或许还能加快处理速度。

第二件事是创建一个 4 gigaBIT 内存标志数组，以显示列表中是否已注册 4 字节 crc。这将大大加快向数组中添加新项目的速度，因为您将知道是否需要先查找现有条目 - 如果该位为零，则该 crc 尚未使用。

根据数据域开发人员的一篇论文，这种不必要的查找是最减慢摄取过程的原因（他们有不同的方法来避免它）。

我假设您正在保存列表，因为您正在修改它们。我建议不要重写整个列表，而是将所有更改放在文件末尾，这样您就可以追加到文件末尾而不是重写整个列表。使用了一个链表结构，该结构以文件尾端的指针开始，每次追加时将一个新标题写入文件末尾的列表。您可以通过在列表更高的位置写入一个带有删除标志的新条目来标记要删除的条目。然后，您可以定期对每个列表进行垃圾收集以减小列表大小（例如，每周或每月一次批处理）。您可以对列表修改执行相同的操作。只需编写一个新条目来替换旧条目，也许用一个标志。然后定期收集垃圾以删除旧条目。

您可以做的任何事情来构建列表，这样您就不需要每次都将整个内容加载到内存中，这会加快速度。尽可能少地移动数据。

这是我在 Stack Overflow 上写的第一件事，所以如果我的帖子不符合首选规范，请原谅。

我注意到我的回复编辑区域上方的说明，我不应该要求澄清，我想这是为了让我可以更有趣地猜测确切的问题是什么。我希望我的猜测很接近，并且我的答案包含有用的元素。

# java - JFormattedTextfield 仅在按下回车时验证

> ID：10266889
> 
> 赞同：1
> 
> 时间：2012-04-22T09:43:04.800
> 
> 标签：java, swing, jformattedtextfield

对于一项任务，我需要创建一个具有以下行为的 JFormattedTextField：

*   如果值被编辑并且不等于最后验证的值，则背景必须变为黄色。
*   价值验证可随时进行
*   如果焦点丢失，则不会发生任何事情（如果背景为黄色，则应保持黄色，...）
*   按下 Enter 时应采取措施

我似乎无法找到正确的侦听器组合来完成此操作。我尝试使用`KeyAdapter`，但这给了我非常丑陋的代码，仅适用于 80% `InputVerifier`。`PropertyChangeListener`

这应该怎么做？

编辑：我写了一个小例子：

```
import java.awt.BorderLayout;
import java.awt.Color;
import java.awt.Container;
import java.awt.event.ActionEvent;
import java.awt.event.KeyAdapter;
import java.awt.event.KeyEvent;
import java.text.ParseException;

import javax.swing.AbstractAction;
import javax.swing.InputVerifier;
import javax.swing.JButton;
import javax.swing.JComponent;
import javax.swing.JFormattedTextField;
import javax.swing.JFrame;
import javax.swing.JLabel;
import javax.swing.JPanel;

public class Test extends JPanel {

    private JFormattedTextField field;
    private JLabel label;
    private JButton btn;

    public Test() {
        super(new BorderLayout());

        label = new JLabel("Enter a float value:");
        btn = new JButton(new AbstractAction("Print to stdout"){

            @Override
            public void actionPerformed(ActionEvent e) {
                System.out.println(field.getValue());
            }

        });
        field = new JFormattedTextField(new Float(9.81));

        field.addKeyListener(new KeyAdapter(){

            @Override
            public void keyPressed(KeyEvent e){
                field.setBackground(Color.YELLOW);
            }

            @Override 
            public void keyTyped(KeyEvent e){
                if(e.getKeyCode() == KeyEvent.VK_ENTER){
                    try{
                        field.commitEdit();
                        field.setBackground(Color.WHITE);
                    }catch(ParseException e1){
                        field.setBackground(Color.RED);
                    }
                }
            }
        });

        field.setInputVerifier(new InputVerifier(){

            @Override
            public boolean verify(JComponent comp) {
                try{
                    field.commitEdit();
                    field.setBackground(Color.YELLOW);
                    return true;
                }catch(ParseException e){
                    field.setBackground(Color.RED);
                    return false;
                }
            }

        });

        add(label, BorderLayout.NORTH);
        add(field, BorderLayout.CENTER);
        add(btn, BorderLayout.SOUTH);
    }

    public static void main(String[] args) {
        JFrame window = new JFrame("InputVerifier test program");
        Container cp = window.getContentPane();
        cp.add(new Test());
        window.pack();
        window.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        window.setVisible(true);
    }
} 
```

这几乎可以满足我想要的一切。但问题是 ENTER 键永远不会被抓住。我认为它在到达我的 KeyListener 之前就被消耗掉了，但是我怎样才能防止这种情况呢？

即使可以避免这种情况，我仍然觉得应该更清楚为什么要完成上面的代码。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-22T10:54:01.067

试试这个代码示例，告诉我这是想要的行为，还是你期待别的东西，除了这个：

```
import java.awt.*;
import java.awt.event.*;
import java.text.NumberFormat;
import javax.swing.*;
import javax.swing.event.CaretEvent;
import javax.swing.event.CaretListener;

public class JFormattedExample
{
    private String lastValidValue;

    private void createAndDisplayGUI()
    {
        JFrame frame = new JFrame("JFormattedTextField Example");
        frame.setDefaultCloseOperation(JFrame.DISPOSE_ON_CLOSE);

        JPanel contentPane = new JPanel();
        contentPane.setBorder(BorderFactory.createEmptyBorder(5, 5, 5, 5));

        final JFormattedTextField ftf = new JFormattedTextField(
                            NumberFormat.getNumberInstance());
        ftf.setColumns(10);
        ftf.setFocusLostBehavior(JFormattedTextField.PERSIST);
        ftf.setValue(100);
        lastValidValue = "100";
        ftf.addCaretListener(new CaretListener()
        {
            public void caretUpdate(CaretEvent ce)
            {
                System.out.println("Last Valid Value : " + lastValidValue);
                if (ftf.isEditValid())
                {
                    String latestValue = ftf.getText();
                    System.out.println("Latest Value : " + latestValue);
                    if (!(latestValue.equals(lastValidValue)))
                        ftf.setBackground(Color.YELLOW.darker());
                    else
                    {
                        lastValidValue = ftf.getText();
                        ftf.setBackground(Color.WHITE);
                    }
                }
                else
                {
                    System.out.println("Invalid Edit Entered.");
                }
            }
        });

        contentPane.add(ftf);
        frame.setContentPane(contentPane);
        frame.pack();
        frame.setLocationByPlatform(true);
        frame.setVisible(true);
    }

    public static void main(String... args)
    {
        SwingUtilities.invokeLater(new Runnable()
        {
            public void run()
            {
                new JFormattedExample().createAndDisplayGUI();
            }
        });
    }
} 
```

# objective-c - xcode 目标 c - 当我调用 2 个方法时 - 只有最后一个调用的方法运行并且第一个被跳过

> ID：10266900
> 
> 赞同：2
> 
> 时间：2012-04-22T09:44:20.813
> 
> 标签：objective-c, ios, avfoundation, avaudioplayer

```
-(void)audioPlayerDidFinishPlaying:(AVAudioPlayer *)player successfully:(BOOL)flag
{

    [self NextHeading]; // this plays an mp3 file

    [self NextHeadingMeaning]; // this plays an Mp3 file

} 
```

只`[self NextHeadingMeaning]`调用`NextHeading`方法，每次都错过方法

```
-(IBAction) NextHeading{ 
    [audio stop]; 

    NSString *Filename = [[NSString alloc]initWithFormat:@"CH%@S%@",Heading,Meaning];
    Filepath = [[NSBundle mainBundle]pathForResource:Filename ofType:@"mp3"]; 

    audio = [[AVAudioPlayer alloc]initWithContentsOfURL:[NSURL fileURLWithPath:Filepath] error:NULL]; 

    audio.delegate = self; 
    [audio play]; 
    [Filename autorelease]; 
}

-(IBAction) NextHeadingMeaning { 
    [audio stop]; 

     NSString *Filename = [[NSString alloc] initWithFormat:@"CH%@S%@",bold**Chapter**bold, Meaning]; 
     Filepath = [[NSBundle mainBundle]pathForResource:Filename ofType:@"mp3"]; 

     audio = [[AVAudioPlayer alloc] initWithContentsOfURL:[NSURL fileURLWithPath:Filepath] error:NULL]; 

     audio.delegate = self; 
     [audio play]; 
     [Filename autorelease]; 
} 
```

为什么会发生这种情况，我该如何解决？

请指教，先谢谢了。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-22T09:57:38.817

没有办法跳过第一个调用，在其中放置一个断点或使用 NSLog() 输出一些东西，你会看到。最可能的原因是第一种方法没有达到您的预期，这可能是由于各种原因 - 例如条件或特定超时。

编辑：查看您的代码后，您似乎缺少一些基本的东西，如变量命名、变量范围等。要简单地使您的代码运行，只需替换`NSString *Filename..`第二种方法中的字符串，它可能会起作用。更好的选择是访问立即[开始开发 iOS 应用程序](https://developer.apple.com/library/ios/#referencelibrary/GettingStarted/RoadMapiOS/Introduction/Introduction.html)并遵循路线图。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-22T11:11:53.707

您只是使用单个 iVar ( `audio`) 作为播放器，当您发送`NextHeading`&`NextHeadingMeaning`消息时，首先`audio`使用您的文件初始化`sound_1.mp3`（如果 mp3 文件很大，则需要几秒钟），然后在下一刻（您的第一个 mp3 文件可能未初始化，或已初始化，但在下一条消息后停止），您使用另一个 mp3 文件（sound_2.mp3）重做初始化操作，最后，当第二个 mp3 文件初始化完成时，`audio`播放`sound_2.mp3`. 这就是您认为`NextHeading`跳过的原因。

因此，要解决这个问题，您可以使用`NSMutableArray`iVar（例如），并为两者`audioPlayers`创建一个本地& ，并将其推送到.`audio``NextHeading``NextHeadingMeaning``audioPlayers`

而且我认为如果可以的话，最好预加载声音文件。:)

* * *

编辑：

有一个`playAtTime:`方法代替`play`，你可以通过这个方法来延迟第二个音频播放器的播放时间，就像这样：

```
[audioPlayer playAtTime:(audioPlayer.deviceCurrentTime + delay)]; 
```

`delay`以秒为单位 ( `NSTimeInterval`)。

# android - 如何使字体大小在 webview 和 textview 中看起来相同？

> ID：10266906
> 
> 赞同：3
> 
> 时间：2012-04-22T09:44:59.090
> 
> 标签：android, webview, textview, font-size

我有 ListView，其中包含许多带有 TextViews 和 WebViews 的记录。我想让它们看起来一样。但是 TextView 和 WebView 中的字体大小在某些设备上看起来不同（取决于屏幕大小）。对于 TextView，我对 WebView 使用 sp 单位，我尝试使用 setDefaultFontSize 和 setTextSize。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-22T09:52:06.980

在您的 Android 应用程序中设置自定义字体

为此，只需在项目根目录中创建一个 assets/ 文件夹，然后将您的字体（以 TrueType 或 TTF 形式）放入资产中。例如，您可以创建 assets/fonts/ 并将您的 TTF 文件放在那里：

```
 TextView tv=(TextView)findViewById(R.id.custom); 
  Typeface face=Typeface.createFromAsset(getAssets(), "fonts/HandmadeTypewriter.ttf"); 
  tv.setTypeface(face); 
```

请参阅此[链接](https://stackoverflow.com/questions/3900658/how-to-change-font-face-of-webview-in-android)以更改 webview 中的字体。

# java - 找不到错误 org.apache.xerces.jaxp.DocumentBuilderFactoryImpl

> ID：10266907
> 
> 赞同：2
> 
> 时间：2012-04-22T09:45:02.443
> 
> 标签：java, build, jar, hadoop

我有一个问题，包括用于从 hadoop 读取文件的 jar。如果我从 netbeans 运行应用程序，它可以工作。但是，如果我从命令行运行它，它会成功构建 jar，但我无法运行它，并且出现以下异常。当我执行程序时，我还输入了罐子的路径。

> javax.xml.parsers.FactoryConfigurationError：未找到提供程序 org.apache.xerces.jaxp.DocumentBuilderFactoryImpl

如果我在 jars xercesImpl-2.9.1.jar 列表中添加，我会得到下一个异常。

> java.lang.NoClassDefFoundError: com/sun/security/auth/UnixPrincipal

有谁知道我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-22T10:09:07.707

这可能是因为您正在运行 IBM JVM。

*   切换到 Sun JVM，这是唯一经过严格测试的 Hadoop

    或者

*   访问 IBM 网站并下载与 JVM 配合使用的稍微修改过的 Hadoop 版本。

我认为这个问题可能会通过最新的 hadoop 修订版来解决。

Jira 问题：[一](https://issues.apache.org/jira/browse/HADOOP-7211)和[二](https://issues.apache.org/jira/browse/HADOOP-6941)。看[这个](http://hadoop-common.472056.n3.nabble.com/java-lang-NoClassDefFoundError-com-sun-security-auth-UnixPrincipal-td2989927.html)，[这个](http://hadoop-common.472056.n3.nabble.com/java-lang-NoClassDefFoundError-com-sun-security-auth-UnixPrincipal-td2989927.html)和[这个](http://mail-archives.apache.org/mod_mbox/hadoop-common-user/201105.mbox/%3C1306568727879-2995577.post@n3.nabble.com%3E)

# django - 从多个模型形成

> ID：10266910
> 
> 赞同：0
> 
> 时间：2012-04-22T09:45:09.120
> 
> 标签：django, django-models, django-forms

我需要创建一个表单，其中行是用户列表，列是用户的所有权限。这些模型是默认的 django 用户和 django 权限的模型。

我该怎么做？有没有办法通过 django 表单来完成，或者我必须手动使用 django 和 js？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-22T11:16:04.443

如果只想查看这些数据，提取相关信息（用户和权限实例），然后使用 django 模板生成表。Django 故意不“祝福”任何 css 或 js 框架，因此您需要自己编写 html（使用您选择的工具）。

我认为表格不会在这里帮助你。我建议你画出你想看到的东西，然后开始弄清楚 html 需要是什么样子。django 中的表单只是一种在 django 和用户之间传递数据的机制。您可以随意渲染它们。

# django - 如何在 Django 中对 2 个数据库（没有外键）应用查询？

> ID：10266917
> 
> 赞同：2
> 
> 时间：2012-04-22T09:46:16.817
> 
> 标签：django, django-models, foreign-key-relationship, cx-oracle

文件`myapp/models.py`有这个示例代码..

```
from django.db import models

# model for 'user' table in database oracle_dbuser1:user 
class User(models.Model):
    . . .
    customerid = models.BigIntegerField()

# model for 'customer' table in database oracle_dbuser2:customer
# Note that there is no Foreign key integrity among these legacy tables.
class Customer(models.Model):
    . . .
    customerid = models.BigIntegerField() 
```

该文件`myapp/admin.py`具有以下代码：

```
from maasusers.models import User, Customer
from django.contrib import admin

class UserAdmin(admin.ModelAdmin):
    # A handy constant for the name of the alternate database.
    db_one = 'dbuser1'
    db_two = 'dbuser2'

    # display in a list
    list_display = (. . .) # question 1

    def queryset(self, request):
        result = super(UserAdmin, self).queryset(request).using(self.db_one) # question 2
        return result

# Register the Poll class
admin.site.register(User, UserAdmin)
admin.site.register(Customer, UserAdmin) 
```

问题1：参考上面：我想显示两个表的列。我怎样才能做到这一点？例如。`Select usr.col1, usr.col2, cust.col1, cust.col10 from user usr, customer cust where usr.col2 = cust.col3;`

问题2：如何`queryset()`使用函数编写对应的`using`函数？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-22T11:11:57.347

[数据库路由器](https://docs.djangoproject.com/en/dev/topics/db/multi-db/#using-routers)可以帮助您避免在查询集上使用`using()`。您通知 django 哪些数据库用于哪些模型。我建议您彻底阅读有关路由器的文档，因为它们可能会很痛苦（我们在工作中使用它们）。

请注意以下几点：

> 如果 myapp 中的任何模型包含与其他数据库之外的模型的关系，则此示例将不起作用。跨数据库关系引入了 Django 当前无法处理的引用完整性问题。

Django 不处理跨数据库连接，无论您是否想使用键连接。如果您需要来自两个模型的数据，您可以执行两个单独的查询，并在代码中自己进行连接。我不知道这将如何适用于管理员。

另一种方法是创建一个视图，在数据库本身中加入跨数据库表。但是，您将无法保存实例。

希望这是您调查的良好起点。

# c# - 如何在保持控件可见的同时为 ac# 表单添加透明度？

> ID：10266920
> 
> 赞同：8
> 
> 时间：2012-04-22T09:47:00.337
> 
> 标签：c#, winforms, image, graphics, transparency

> **更新：**我花了几天时间来处理透明度的问题。我今晚又开始搞砸了。我使用 Hans Passant 的解决方案得到了一个新结果：http: [//img3.imageshack.us/img3/4265/icontransp.jpg](http://img3.imageshack.us/img3/4265/icontransp.jpg)[![新结果](../Images/4a139becf88c2495b83991f7a97c8a78.png)](https://i.stack.imgur.com/eNdFR.jpg)
> 
> Passant的解决方案确实解决了透明背景渐变的问题。但是，我的图标中的透明颜色与表单的 BackColor 混合仍然存在问题。您可以在上图中看到图标各个部分周围的紫红色。

**原创内容：**

我已经这样做了几个小时了，我没有太多的运气。我弄乱了 Control.Region、Form.TransparencyKey、Form.Opacity 和其他一些带有一些时髦效果的随机事物。

最近我一直在尝试自定义我的桌面并决定弄乱应用程序坞。在看到 Mac Dock 和一些第三方 Windows 实现所提供的功能后，我决定自己构建。

最终我想继续使用 Win32 API。现在，我只想使用尽可能多的 C# 和 .Net 框架功能来做一些事情。

**我希望在这个应用程序中能够做一些事情：**

*   显示带有渐变背景的表单/菜单。
*   允许表单/菜单具有透明度，同时保持图标不透明。
*   显示包含透明背景的图标。
*   菜单和图标应该能够接收与鼠标相关的事件（悬停、离开、单击、拖动、拖放等）。

这是我要拍摄的效果：http: [//img207.imageshack.us/img207/5716/desired.jpg](http://img207.imageshack.us/img207/5716/desired.jpg)[![所需效果](../Images/1feab20967ad42beac7617ef5e64e09c.png)](https://i.stack.imgur.com/mlQmc.jpg)

这张图片显示了我想要达到的视觉效果。这是我为名为 Rainmeter 的程序制作的皮肤。该图像显示了皮肤后面的 Notepad++，其中一些皮肤文件在编辑器中打开。菜单是透明的，但图标保持不透明。

**我的方法：**

使用表单作为菜单对我来说似乎是合乎逻辑的首选。我对事件有基本的了解。我不太确定如何创建我自己的点击事件，所以表单会让处理事件变得更容易一些。我考虑了一些图标选项。我决定将 PictureBoxes 用于图标，因为它们可以保存图像并接收事件。

一旦我完成了菜单的所有结构逻辑的代码，我就开始使用它来尝试获得我想要的视觉效果。Form.Opacity 影响表单上所有内容的透明度。因为我希望图标完全不透明，所以我不理会这个属性。我尝试将 BackColor 设置为 Color.Transparent，但这会产生错误。我玩了一些组合... [http://img204.imageshack.us/img204/757/effectsi.jpg](http://img204.imageshack.us/img204/757/effectsi.jpg)[![组合效果](../Images/5ea042c5ee04001a450d2c30858cb25d.png)](https://i.stack.imgur.com/cCglR.jpg)

我用 Drawing2D.LinearGradientBrush 将渐变绘制到位图中。然后将此位图作为 Form.BackgroundImage 或 PictureBox.Image 放置。如果使用，PictureBox 的大小将覆盖整个表单并发送到后面。

我注意到一些 Form.BackgroundColor 会与我的图标的轮廓混合在一起。图标沿边缘具有透明度，以使外观更平滑。由于图标正在获取表单的 BackgroundColor，这让我认为当图标加载到表单中时 PictureBoxes 正在创建新图像。当图像的半透明部分应该与表单后面的任何颜色合并时，它们会与表单的 BackgroundColor 合并。

[![白色桌面效果](../Images/496de9ee073b0513795431a7cc239dee.png)](https://i.stack.imgur.com/zL3n6.jpg) [http://img838.imageshack.us/img838/8299/whitedesktop.jpg](http://img838.imageshack.us/img838/8299/whitedesktop.jpg)

在此图像中，您可以看到图标中存在紫红色，即使表单的紫红色现在完全透明。我忘了指出在每种情况下都使用了相同的绿色到黄色渐变，Alpha 值为 150。在渐变看起来不是绿色的图像中，这是因为透明颜色与紫红色背景混合。

我真的不知道从这里做什么。我觉得如果我能以某种方式使表单完全透明，我就能得到我想要的东西。我还想我可能会更好地绘制图标而不是使用 PictureBoxes。那么问题将是设置图标以接收鼠标事件。（我从来没有自己的事件，我认为它会涉及一些 Win32 API 调用。）

我还能用 PictureBoxes 做些什么来获得我想要的效果吗？无论哪种情况，对于我想要达到的整体效果，我都愿意接受任何想法或建议。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-04-22T10:46:03.973

这在 Winforms 中很容易做到。你需要的是*两种*形式的三明治。底部应提供透明渐变背景，顶部应绘制图标并处理鼠标单击。一些示例代码：

```
public partial class Form1 : Form {
    public Form1() {
        InitializeComponent();
        this.TopMost = true;
        this.FormBorderStyle = FormBorderStyle.None;
        this.TransparencyKey = this.BackColor = Color.Fuchsia;
        this.Opacity = 0.3;
        var overlay = new Form();
        overlay.FormBorderStyle = FormBorderStyle.None;
        overlay.TransparencyKey = overlay.BackColor = Color.Fuchsia;
        overlay.StartPosition = FormStartPosition.Manual;
        overlay.Location = this.Location;
        overlay.MouseDown += HandleIconClick;
        this.Resize += delegate { overlay.Size = this.Size; };
        this.LocationChanged += delegate { overlay.Location = this.Location; };
        overlay.Paint += PaintIcons;
        this.Paint += PaintBackground;
        this.Load += delegate { overlay.Show(this); };
    }
    private void PaintBackground(object sender, PaintEventArgs e) {
        var rc = new Rectangle(0, 0, this.ClientSize.Width, this.ClientSize.Height);
        using (var br = new LinearGradientBrush(rc, Color.Gainsboro, Color.Yellow, 0f)) {
            e.Graphics.FillRectangle(br, rc);
        }
    }
    private void PaintIcons(object sender, PaintEventArgs e) {
        e.Graphics.DrawIcon(Properties.Resources.ExampleIcon1, 50, 30);
        // etc...
    }
    void HandleIconClick(object sender, MouseEventArgs e) {
        // TODO
    }
} 
```

看起来像这样，我选择了一些随机的颜色和图标：

![在此处输入图像描述](../Images/e019fbbc6343d8c1a1c8a56feac1b0c4.png)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-22T10:37:06.900

好的，我有点迷失了，但从原始段落中的描述来看，我会确保背景矩形不是图片框的视觉父级。使用 Panel.Zindex 使它们重叠兄弟姐妹，图片框在前面。

然后你可以改变矩形的不透明度，而不影响图标。还要确保图标源图像文件具有透明背景。

我认为应该工作。

# c# - 如何在多个实体数据模型之间共享连接字符串

> ID：10266923
> 
> 赞同：6
> 
> 时间：2012-04-22T09:47:32.817
> 
> 标签：c#, asp.net, linq, entity-framework, c#-4.0

我有一个具有 4 个实体数据模型的项目。为了构建它们，我不想在我的项目中保存连接字符串，我想将连接字符串存储在`app.config`文件中并在我的模型之间共享它。我该怎么做？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-21T13:56:30.700

首先假设 DbContext 和模型/数据库。

1.  保留 app.config 文件中生成的 EF 连接字符串不变。正如 Arthur 所说，它们包含 EF 元数据 (csdl/ssdl/msl) 的路径。它们也被模型设计者在开发过程中使用。
2.  添加一个名为“SharedConnection”的存储连接字符串。这是唯一需要在生产中修改的连接字符串。
3.  创建一个派生自 DbContext 的基类，并从该类派生所有上下文。
4.  在基类中显式创建默认 EF 连接。然后修改它以使用这样的共享连接字符串：

```
public class BaseContext : DbContext
{
    public BaseContext(string nameOrConnectionString)
        : base(CreateConnection(nameOrConnectionString), true)
    {
    }

    private static EntityConnection CreateConnection(string connectionString)
    {
        // Create a (plain old database) connection using the shared connection string.
        DbConnection dbConn = Database.DefaultConnectionFactory.CreateConnection(
            ConfigurationManager.ConnectionStrings["SharedConnection"].ConnectionString);

        // Create a helper EntityConnection object to build a MetadataWorkspace out of the
        // csdl/ssdl/msl parts of the generated EF connection string for this DbContext.
        EntityConnection wsBuilder = new EntityConnection(connectionString);

        // Merge the specific MetadataWorkspace and the shared DbConnection into a new EntityConnection.
        return new EntityConnection(wsBuilder.GetMetadataWorkspace(), dbConn);
    }
} 
```

派生上下文的代码不会改变，只是它们必须从 BaseContext 继承。这是一个更健壮的 CreateConnection 方法。它具有错误处理功能，并以添加应用程序设置为代价从代码中删除共享连接字符串的名称。

```
private static EntityConnection CreateConnection(string connectionString)
{
    // Find the name of the shared connection string.
    const string appSettingKey = "SharedConnectionStringName";

    string sharedConnectionStringName = ConfigurationManager.AppSettings[appSettingKey];
    if (string.IsNullOrEmpty(sharedConnectionStringName))
    {
        throw new Exception(string.Format(
            "Shared connection not configured. " +
            "Please add a setting called \"{0}\" to the \"appSettings\" " +
            "section of the configuration file.", appSettingKey));
    }

    // Create a (plain old database) connection using the shared connection string.
    ConnectionStringSettings backendSettings =
        ConfigurationManager.ConnectionStrings[sharedConnectionStringName];
    if (backendSettings == null)
    {
        throw new Exception(string.Format(
            "Invalid connection string name \"{0}\" in appSetting \"{1}\"",
            sharedConnectionStringName, appSettingKey));
    }

    System.Data.Common.DbConnection dbConn =
        Database.DefaultConnectionFactory.CreateConnection(
        backendSettings.ConnectionString);

    // Create a helper EntityConnection object to build a MetadataWorkspace out of the
    // csdl/ssdl/msl parts of the generated EF connection string for this DbContext.
    EntityConnection wsBuilder = new EntityConnection(connectionString);

    // Merge the specific MetadataWorkspace and the shared DbConnection into a new EntityConnection.
    return new EntityConnection(wsBuilder.GetMetadataWorkspace(), dbConn);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-22T15:22:28.010

您可以使用代码优先。您必须在代码中为每个模型编写映射，但是使用相同的连接字符串非常容易——只需传递`"name=MyConnectionStringName"`给 DbContext 构造函数即可。

将 Database First 与 EDMX 一起使用时，EF 连接字符串包含以下两者：

*   “存储连接字符串”提供有关如何连接到数据库的信息
*   描述模型的 EF 元数据的路径

由于每个模型的第二部分都不同，因此您将需要四个不同的连接字符串。

如果您只想拥有一个连接字符串，那么您需要： - 以其他方式存储元数据信息 - 编写代码以加载元数据并创建 MetadataWorkspace - 读取您的单个存储连接字符串并从中创建连接 -使用连接和 MetadataWorkspace 创建 EntityConnection - 使用 EntityConnection 创建 ObjectContext - 如果您使用 DbContext，则使用 ObjectContext 创建 DbContext

似乎很难相信编写所有这些重要的代码会比在 app.config 中仅包含四个连接字符串更好。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-23T04:34:53.063

您可以将 EF 连接字符串传递给 ObjectContext。如果您有多个模型，您可以将每个模型的连接字符串放在 app.config 中，给每个模型一个键，并在需要时查找它，并在实例化时将适当的字符串传递给上下文。

# jquery - 获取远程文件并填写下拉列表

> ID：10266925
> 
> 赞同：0
> 
> 时间：2012-04-22T09:47:58.000
> 
> 标签：jquery, asp.net, ajax

好吧，我有一个愚蠢的问题要问。我必须使用 jquery 函数获取此[页面](http://currencies.apps.grandtrunk.net/currencies)，并用 asp.net 表单中的数据填充下拉列表。有什么想法或例子吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-22T11:59:52.907

我会在您的代码隐藏中使用页面方法间接执行此操作，而不是直接使用 jquery，因为被 x-site 脚本保护阻止。

我会编写一个简单的类，它使用 .net 中的 webclient 来拉回页面内容并将响应解析为 a`List<string>`并以某种方式返回到您的控件。根据您是在 ASP.net 中使用 jquery/jscript 还是 updatepanel，您可以从代码隐藏方法中调用类方法，以防止完全回发并使用数据绑定/填充下拉列表。

示例代码在上一篇文章中标记为已回答的响应[中](https://stackoverflow.com/questions/1820991/how-to-get-the-webpage-source-in-asp-net-c)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-22T10:12:13.183

大多数浏览器都阻止了跨站点脚本。您可以在 ajax 请求中使用 jsonp 数据类型，但目标链接不提供此数据类型。所以， - 可能 - 不可能使用 javascript。

# php - 为什么没有正确评估 mysql 查询？

> ID：10266935
> 
> 赞同：-1
> 
> 时间：2012-04-22T09:50:49.197
> 
> 标签：php, mysql

请帮助我解决指定的问题：

代码部分：

```
 $result = mysql_query("SELECT *, UNIX_TIMESTAMP(eventdate) AS eventdate,    
 UNIX_TIMESTAMP(throughdate) AS throughdate FROM events where 
 id='$_GET[id]' ORDER BY eventdate");

 // the above query is not working   
 if (! $result) {
  echo mysql_errno() . ": " . mysql_error(). "\n";
 }

if ( mysql_num_rows($result) == 0 ) {  
   print "<p>No events right now.</p>\n";
   }
else {

    $lasteventmonth = '';
    while ($row = mysql_fetch_array($result)) { 
        $eventmonth="";
        $eventmonth = date("F Y",$row['eventdate']);

        if ($lasteventmonth != $eventmonth) {
            print "<p style='font-size: 18px;'><b>$eventmonth</b></p>";
        }
        $lasteventmonth = $eventmonth;

        showEvent($row);    
        }
    }
   ?>
........................
........................//other codes 
```

当代码评估如下： 现在没有事件。

但是特定的 id 存在于数据库中，如果 $_GET['id'] 在页面中回显，则显示该值。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-22T10:50:37.543

`id`一开始是什么`id='$_GET[id]'`？

如果您有查询`http:// ... ?id=123`，我会将 id 放在引号中。话虽如此，最好是这样：

```
$id = mysql_real_escape_string($_GET['id']); // safe against SQL injection

$sql = "SELECT *, UNIX_TIMESTAMP(eventdate) AS eventdate, UNIX_TIMESTAMP(throughdate) AS throughdate FROM events where id='$id' ORDER BY eventdate";

$result = mysql_query($sql); 
```

如果您仍然遇到问题，请在查询运行之前使用 echo 检查变量 $id 和 $result；那么您将更清楚地知道为什么它没有运行您期望的查询。

* * *

## 回答 #2

> 赞同：-3
> 
> 时间：2012-04-22T10:00:29.457

我确信`id=$_GET[id]`正在检查一个 int 与一个 int ，在那里你检查一个 int 与一个字符串。删除周围的单引号，`$_GET['id']`然后重试。单引号将其定义为字符串而不是 int。

# android - 如何修复android中的背景错误？

> ID：10266937
> 
> 赞同：4
> 
> 时间：2012-04-22T09:50:57.480
> 
> 标签：android, background

我想用重复图像设置线性布局的背景。我有 2 个文件。

**main_bg.xml**

```
 <?xml version="1.0" encoding="utf-8"?>
    <bitmap xmlns:android="http://schemas.android.com/apk/res/android"
    android:src="@drawable/bg"
    android:tileMode="repeat" /> 
```

和**main.xml**

```
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:orientation="vertical"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:background="@drawable/main_bg"
    > 
```

我在文件夹drawable上有bg.png图像。
但是 Eclipse 说有一个错误
**错误：错误：找不到与给定名称匹配的资源（在“背景”，值为“@drawable/main_bg”）。**

如何解决？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-22T09:54:10.880

将 main_bg.xml 放在 drawable 文件夹中。那是在 res/drawable 中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-22T09:53:24.447

main_bg.xml 应该在 drawable 文件夹中。查看错误，我猜它已保存在其他地方。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-22T09:54:04.283

看起来Android找不到可绘制资源。所有可绘制对象（包括由 XML 定义的对象）都应位于 res/drawable 中。

# c++ - 嵌套 if 或直接返回

> ID：10266939
> 
> 赞同：2
> 
> 时间：2012-04-22T09:51:05.703
> 
> 标签：c++, idioms

我参加了一门 C++ 课程，我们有一些作业要给老师看，里面有一些这样的 if 语句：

```
if (A != 10)
    return 1;

...snip logic ...
return 12; 
```

他不喜欢这样，并建议我像这样嵌套它，即使有不止一层嵌套：

```
if (A == 10) {
    ...snip logic ...
    return 12;
} else
    return 1; 
```

他无法真正向我解释他为什么要那样做。所以我的问题是，是否有任何理由包含这样的 if 语句？我认为在我的函数开始时有一些提前返回的条件既容易又干净。关于为什么这些想法之一更好/更快的任何想法或想法？之后编译的代码有什么大的不同吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-22T09:59:53.807

当谈到编码风格时，你可以听取意见，但最好是你自己的风格。第一个解决方案对我来说看起来更干净，更容易阅读，但这毕竟只是一个品味问题。至于性能，绝对没有区别。

# ios - iOS 方法调用

> ID：10266940
> 
> 赞同：-3
> 
> 时间：2012-04-22T09:51:19.133
> 
> 标签：ios

我有这两种方法。我怎么称呼他们？

```
 //to base 64 string
-(NSString *)getStringFromImage:(UIImage *)image{
    if(image){
        NSData *dataObj = UIImagePNGRepresentation(image);
        return [dataObj base64Encoding];
    } else {
        return @"";
    }
}

//Convert back 
//    NSData *dataObj = [NSData dataWithBase64EncodedString:beforeStringImage];
//  UIImage *beforeImage = [UIImage imageWithData:dataObj]; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-22T10:01:38.147

如果你想调用同一个类的方法，你可以像下面这样调用：

```
UIImage *image = [UIImage imageNamed:@"someimg.png"];
NSString *str = [self getStringFromImage:image]; 
```

否则，如果您想从不同的类调用方法，请执行以下操作：假设`clInstance`是具有该方法的类的实例，则

```
UIImage *image = [UIImage imageNamed:@"someimg.png"];
NSString *str = [clInstance getStringFromImage:image]; 
```

# c# - 如何通过 LINQ 获取两个数据表的笛卡尔映射？

> ID：10266942
> 
> 赞同：0
> 
> 时间：2012-04-22T09:51:41.333
> 
> 标签：c#, asp.net, linq, datatable, union

我有两个`datatables`，我想在`Cartesian mapping`两者之间做一个`datatables`，使用`LINQ`.

例如，如果我有两个数据表`DT1`，`DT2`：

# DT1：

```
1   A
2   B
3   C 
```

* * *

# DT2：

```
1   D
2   E
3   F 
```

* * *

我想要结果：

```
 A    D
    A    E
    A    F
    B    D
    B    E
    B    F
    C    D
    C    E
    C    F 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-22T09:55:26.960

试试这个：

```
var newDatatable = from p1 in dt1.AsEnumerable()
                   from p2 in dt2.AsEnumerable()
                   select new {p1, p2}; 
```

然后填入`newDatatable`一个新的`DataTable`.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-22T10:04:34.263

```
from d1 in DT1
from d2 in DT2
select new {d1.col1, d2.col1,} 
```

# java - java- 在 32 位窗口中使用大于 1Gb 的 java 堆空间文件

> ID：10266944
> 
> 赞同：0
> 
> 时间：2012-04-22T09:52:16.387
> 
> 标签：java

使用：-Xms1000M -Xmx4000M -mx1000m 我仍然得到 java.lang.OutOfMemoryError: Java heap space

我正在使用 jai-imageio 库读取 100Mb JPEG2000 文件，一旦被 imageio 库解压缩，它可能需要超过 1Gb 的堆空间。我使用的是 32 位 windows JVM，所以我不能创建超过 1G 的堆空间。

看到这篇文章：[java-OutOfMemoryError 和 -Xms1000M -Xmx4000M -mx1000m](https://stackoverflow.com/questions/10264123/java-outofmemoryerror-with-xms1000m-xmx4000m-mx1000m/10264438#10264438)

那么，有没有办法告诉 JVM 使用文件作为堆内存，而不是 ram 内存（即使在 32 位窗口中，堆空间也可以大于 1Gb）？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-22T09:57:58.740

这是操作系统的限制（以及地址中的位数）。您需要使用 64 位操作系统和 64 位 JVM。

当您添加到交换空间时，您允许 JVM 将此文件用作交换空间。注意：这样做会使您的性能降低 10 倍或更多。

您应该能够在 32 位 Windows 上获得 1.2 GB 到 1.5 GB 的堆。

一个类似的问题被问到here。[我可以为 4GB 和 8GB Ram 提及多少 -XX:MaxPermSize 大小并为此计算？](https://stackoverflow.com/questions/10266404/how-much-xxmaxpermsize-size-i-can-mention-for-4gb-and-8gb-ram-and-calculation)

# zend-framework - Zend 框架中基于动作的导航

> ID：10266946
> 
> 赞同：1
> 
> 时间：2012-04-22T09:53:15.080
> 
> 标签：zend-framework

我有导航菜单，根据控制器的某些操作向用户显示。这就是我正在做的事情。

```
//in each controller-action where i want "action navigation menu"
public function indexAction()
{
    $this->_helper->navigation()->renderActionNavigation();
}
public function newAction()
{
    $this->_helper->navigation()->renderActionNavigation();
} 
```

相应地显示导航菜单。这是我的navigation.xml 文件。

```
<?xml version="1.0" encoding="UTF-8"?>
<configdata>
    <item-index>
        <new-item>
            <label>New Item</label>
            <route>admin-item-new</route>
        </new-item>
        <delete-item>
            <label>Delete Item</label>
            <uri>#</uri>
        </delete-item>
    </item-index>
    <item-new>
        <publish-unpublish-item>
            <label>Save &amp; Close</label>
            <uri>#</uri>
        </publish-unpublish-item>
        <delete-item>
            <label>Save &amp; New</label>
            <uri>#</uri>
        </delete-item>
    </item-new>
</configdata> 
```

每个导航菜单的父元素代表上述navigation.xml文件中的命名约定，例如

```
`<item-index>` represents item{controller}index{action}
`<item-new>` represents item{controller}new{action}
//and so on 
```

这是动作助手。我正在使用的 Navigation.php

```
class Zend_Controller_Action_Helper_Navigation extends Zend_Controller_Action_Helper_Abstract
{
    private $_view = null;

    public function direct()
    {
        $this->_view = Zend_Layout::getMvcInstance()->getView();
        $this->_view->placeholder('action-navigation');
        return $this;
    }

    public function renderActionNavigation()
    {   
        $config = new Zend_Config_Xml(
            APPLICATION_PATH.'/configs/navigation.xml', strtolower(
                $this->getRequest()->getControllerName().'-'.
                $this->getRequest()->getActionName()
            )
        );
        $container = new Zend_Navigation($config);
        $this->_view->partial('partials/_action-navigation.phtml', array('container' => $container));
    }
} 
```

最后`_action-navigation.phtml`

```
<?php $this->placeholder('action-navigation')->captureStart(); ?>
<div class="statsRow">
    <div class="wrapper" >
        <?php foreach($this->container as $page): ?>
            <a href="<?php echo $page->getHref(); ?>" class="<?php echo $page->class; ?>" id="<?php echo $page->id; ?>"></a>
        <?php endforeach; ?>
     </div>
</div>
<?php $this->placeholder('action-navigation')->captureEnd(); ?> 
```

我的目录结构如下

```
/application
  /layouts
    admin.phtml
    default.phtml    
  /modules
    /admin
      /controllers
        /helpers
          /Navigation.php
        IndexController.php
      /views
        /helpers
        /scripts
          /partials
            _action-navigation.pthml
            sidebar.phtml
          /index
          /item 
```

我正在经历的奇怪行为是。在我的 Bootstrap.php 文件中有一个空的 _initView() 方法。如果此方法存在，我的应用程序将正常工作。请注意，此方法为空。但是当我删除它时，它会给我以下错误。

```
Application error

Exception information:

Message: script 'partials/_action-navigation.phtml' not found in path (./views/scripts/) 
```

我无法理解 Zend Framework 的这种行为。与 Bootstrap 中的 _initView 方法相关的操作导航代码如何？发生了什么，对此有何修复或对改进我的代码有任何建议？

**更新：** 问题出在这行代码上

```
$this->_view->partial('partials/_action-navigation.phtml', array('container' => $container)); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-23T06:15:47.530

您忘记添加`admin`模块的名称作为第二个参数：

```
$this->_view->partial('partials/_action-navigation.phtml', 'admin', array('container' => $container)); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-17T06:54:58.290

我建议你使用这种干净和轻量级的方式，消除你对通知实际模块的依赖，并在没有 captureStart 和 End 的情况下保持你的视图脚本干净（它使用 ob_start ...当你执行 captureStart-end 时）

```
$navigation = $this->view->navigation()->menu()->renderPartial($container, 'partials/_action-navigation.phtml');
// U can use placeholders `append` and `prepend` methods too, if u need more control in your placeholder content
$this->view->placeholder('action-navigation')->set($navigation); 
```

# c# - 错误：当我得到时间戳数据时，“字符串的格式不正确”......

> ID：10266953
> 
> 赞同：2
> 
> 时间：2012-04-22T09:54:39.320
> 
> 标签：c#, mysql

我有一个连接到 MySQL 数据库的 Windows 服务（C# .netframework 4.0）。当我尝试执行命令时抛出的错误如下所示：

```
var cmd= new MySqlCommand("SELECT CURRENT_TIMESTAMP", Common.RemoteConnDwReadol)
                {
                    CommandType = CommandType.Text 
                };
string strtime = cmd.ExecuteScalar().ToString(); 
```

该命令将返回 MySQL 服务器的当前时间戳。然后这里的错误详细信息：

> 在 System.Number.StringToNumber(String str, NumberStyles options, NumberBuffer& number, NumberFormatInfo info, Boolean parseDecimal)
> 在 System.Number.ParseInt32(String s, NumberStyles style, NumberFormatInfo info) 在 MySql.Data.Types.MySqlDateTime.ParseMySql(String s) 在 MySql.Data.Types.MySqlDateTime.MySql.Data.Types.IMySqlValue.WriteValue(MySqlPacket数据包，布尔二进制，对象值，Int32 长度）在 MySql.Data.MySqlClient.MySqlParameter.Serialize（MySqlPacket 数据包，布尔二进制，MySqlConnectionStringBuilder 设置）在 MySql.Data.MySqlClient.Statement.SerializeParameter（MySqlParameterCollection 参数，MySqlPacket 数据包，字符串 parmName ) 在 MySql.Data.MySqlClient.Statement.BindParameters() 在 MySql.Data.MySqlClient.Statement.Execute() 在 MySql.Data. MySqlClient.MySqlCommand。MySql.Data.MySqlClient.MySqlCommand.ExecuteScalar() 处的 ExecuteReader（CommandBehavior 行为）
> 在 TVC.Analytic.Service.Analytics.ClickView.Analyzing() 错误：输入字符串的格式不正确。
> 
> [有关详细信息，请参阅http://go.microsoft.com/fwlink/events.asp](http://go.microsoft.com/fwlink/events.asp)上的帮助和支持中心 。

**平台信息：** *机器开发：*

```
Windows 8 consumer preview x64.
.NET Framework 4.x (VS 2010)
MySQL Connector 6.5.4.0 
```

在另一台机器上运行：

```
Windows server 2003, x64
.NET Framework 4.x 
MySQL server 5.5 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-22T10:14:13.017

我尝试使用 mtsql 5.5 和连接器 6.2.5，它对我有用。

但也可以这样尝试：

```
SELECT cast(CURRENT_TIMESTAMP as char) 
```

# optimization - 在 Haskell 中优化部分计算

> ID：10266954
> 
> 赞同：8
> 
> 时间：2012-04-22T09:54:46.927
> 
> 标签：optimization, haskell, ghc

我很好奇如何优化这段代码：

```
fun n = (sum l, f $ f0 l, g $ g0 l)
  where l = map h [1..n] 
```

假设 , `f`, `f0`,`g`和`g0`都是`h`昂贵的，但创建和存储的`l`成本非常高。

如所写，`l`存储直到返回的元组被完全评估或垃圾收集。相反，`length l`,`f0 l`和`g0 l`应该在其中任何一个被执行时都被执行，但是`f`应该`g`被延迟。

看来这种行为可以通过编写来解决：

```
fun n = a `seq` b `seq` c `seq` (a, f b, g c)
  where
    l = map h [1..n]
    a = sum l
    b = inline f0 $ l
    c = inline g0 $ l 
```

或非常相似：

```
fun n = (a,b,c) `deepSeq` (a, f b, g c)
  where ... 
```

我们也许可以指定一堆内部类型来实现相同的效果，这看起来很痛苦。还有其他选择吗？

另外，我显然希望我`inline`的 s 编译器将`sum`, `f0`, 和融合`g0`到一个循环中，该循环逐项构造和`l`使用。我可以通过手动内联来明确这一点，但这很糟糕。有没有办法明确地阻止列表`l`被创建和/或强制内联？如果在编译期间内联或融合失败，可能会产生警告或错误的编译指示？

顺便说一句，我很好奇为什么`seq`, `inline`,`lazy`等都`let x = x in x`在 Prelude 中定义。这只是为了给他们一个定义让编译器覆盖吗​​？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-22T12:41:34.653

如果你想确定，唯一的办法就是自己做。对于任何给定的编译器版本，您可以尝试几种源代码公式并检查生成的核心/程序集/llvm 字节码/无论它是否符合您的要求。但这可能会因每个新的编译器版本而中断。

如果你写

```
fun n = a `seq` b `seq` c `seq` (a, f b, g c)
  where
    l = map h [1..n]
    a = sum l
    b = inline f0 $ l
    c = inline g0 $ l 
```

或其`deepseq`版本，编译器可能能够合并 的计算`a`，`b`并`c`在单次遍历期间并行执行（不是在并发意义上）`l`，但目前，我相当相信 GHC 不会t，如果 JHC 或 UHC 这样做，我会感到惊讶。`b`为此，计算结构`c`需要足够简单。

跨编译器和编译器版本可移植地获得所需结果的唯一方法是自己做。至少在接下来的几年里。

取决于`f0`and `g0`，它可能就像使用适当的累加器类型和组合函数进行严格的左折叠一样简单，例如著名的平均值

```
data P = P {-# UNPACK #-} !Int {-# UNPACK #-} !Double

average :: [Double] -> Double
average = ratio . foldl' count (P 0 0)
  where
    ratio (P n s) = s / fromIntegral n
    count (P n s) x = P (n+1) (s+x) 
```

但是如果`f0`和/或的结构`g0`不适合，比如一个是左折叠，另一个是右折叠，则可能无法在一次遍历中进行计算。在这种情况下，选择是在重新创建`l`和存储之间`l`。通过显式`l`共享（`where l = map h [1..n]`对于 GHC，标志`fno-cse`和`-fno-full-laziness`可以帮助避免不必要的共享。

# url - href 中的相对链接如何工作？

> ID：10266955
> 
> 赞同：0
> 
> 时间：2012-04-22T09:54:50.380
> 
> 标签：url, href, relative-path, relative-url

我有一个与 href 中的相对链接有关的问题。长话短说，我认为一个例子是了解正在发生的事情的最佳方式。

在**tinhte.vn/threads/300021/ 上**，这是一个论坛，要转到第 2 页，我们单击 [2]。

我查看了 [2] 的源代码，其内容为`<a href="threads/300021/page-2" class="">2</a>`. 如果我没有误解相对链接，这将附加`threads/30021/page-2`在当前链接之后，即**tinhte.vn/threads/30021/**，我们有这样的链接：

> tinhte.vn/threads/300021/threads/300012/page-2

但实际上，当我在浏览器中进行操作时，我的是 chrome，链接是：

> tinhte.vn/threads/300012/page-2

任何人请解释为什么？

抱歉，由于防止垃圾邮件，我无法发布直接链接。

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-22T10:06:46.960

如您所料，该链接将正确转到`tinhte.vn/threads/300021/threads/300012/page-2`。但是，查看对该 url 的请求的响应，我们可以看到页面*重定向*到另一个 url。我使用[web-sniffer](http://web-sniffer.net/)快速查看来自服务器的原始响应。

响应中有趣的部分是：

```
<input type="hidden" name="redirect" value="/threads/300021/page-2"/> 
```

浏览器将对此做出反应并导航到指定的 URL。因此观察到的行为。

[在此处](http://en.wikipedia.org/wiki/URL_redirection)阅读有关重定向的更多信息。

# c# - 将数组从php转换为asp.net c#和文件目录枚举

> ID：10266956
> 
> 赞同：0
> 
> 时间：2012-04-22T09:54:52.857
> 
> 标签：c#, php, asp.net

我有一个 PHP 脚本，我正在尝试将其转换为 ASP.NET C#

这是PHP：

```
<?php

/* Configuration Start */

$thumb_directory = 'img/thumbs';
$orig_directory = 'img/original';

$stage_width=600;   // How big is the area the images are scattered on
$stage_height=400;

/* Configuration end */

$allowed_types=array('jpg','jpeg','gif','png');
$file_parts=array();
$ext='';
$title='';
$i=0;

/* Opening the thumbnail directory and looping through all the thumbs: */

$dir_handle = @opendir($thumb_directory) or die("There is an error with your image directory!");

$i=1;
while ($file = readdir($dir_handle)) 
{
    /* Skipping the system files: */
    if($file=='.' || $file == '..') continue;

    $file_parts = explode('.',$file);
    $ext = strtolower(array_pop($file_parts));

    /* Using the file name (withouth the extension) as a image title: */
    $title = implode('.',$file_parts);
    $title = htmlspecialchars($title);

    /* If the file extension is allowed: */ 
    if(in_array($ext,$allowed_types))
    {
        /* Generating random values for the position and rotation: */
        $left=rand(0,$stage_width);
        $top=rand(0,400);
        $rot = rand(-40,40);

        if($top>$stage_height-130 && $left > $stage_width-230)
        {
            /* Prevent the images from hiding the drop box */
            $top-=120+130;
            $left-=230;
        }

        /* Outputting each image: */

        echo '
        <div id="pic-'.($i++).'" class="pic" style="top:'.$top.'px;left:'.$left.'px;background:url('.$thumb_directory.'/'.$file.') no-repeat 50% 50%; -moz-transform:rotate('.$rot.'deg); -webkit-transform:rotate('.$rot.'deg);">
        <a class="fancybox" rel="fncbx" href="'.$orig_directory.'/'.$file.'" target="_blank">'.$title.'</a>
        </div>';
    }
}

/* Closing the directory */
closedir($dir_handle);

?> 
```

我正在努力让阵列部分正常工作。PHP 是否设置了一个名为 file_parts 的数组？这是否意味着我已经枚举了 ASP.NET 中的目录？

这是我迄今为止尝试过的，仍在进行中：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Web;
using System.Web.UI;
using System.Web.UI.WebControls;

public partial class web_content_notes_Default : System.Web.UI.Page
{
    protected void Page_Load(object sender, EventArgs e)
    {
        /* Configuration Start */
        string thumb_directory;
        string orig_directory;

        thumb_directory = ("img/thumbs");  
        orig_directory = ("img/original");

        // How big is the area the images are scattered on
        int stage_width;
        int stage_height;
        stage_width = 600;
        stage_height = 400;
        /* Configuration end */

        // array of allowed file type extensions
        string[] allowed_types = { "bmp", "gif", "png", "jpg", "jpeg", "doc", "xls" };

        //declare the array
        string[] file_parts;
        string ext = "";
        string title = "";

        int i = 0;

        /* Opening the thumbnail directory and looping through all the thumbs: */
        string dir_handle;
        dir_handle = thumb_directory;

        string file;

        while (file = dir_handle);
        {
            Console.WriteLine(file_parts[i]);
        }

     //.....

    }
} 
```

如何循环遍历数组？有点困惑，因为在读取目录之前不会填充数组。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-22T10:03:21.840

您可以使用`System.IO.Directory`'`GetFiles`方法（[MSDN](http://msdn.microsoft.com/en-us/library/07wt70x2.aspx "目录.GetFiles")）来实现这一点；

```
for (string file in System.IO.Directory.GetFiles(thumb_directory)) {
  Console.WriteLine(file);
} 
```

值得一看`System.IO.Path`该类 ( [MSDN](http://msdn.microsoft.com/en-us/library/system.io.path.aspx "路径类") )，因为它为您提供了一些不错的方法，例如`GetFileNameWithoutExtension()`和`GetExtension()`。

编辑：完全转换；

```
 protected void Page_Load(object sender, EventArgs e) {
        /* Configuration Start */
        string thumb_directory = "img/thumbs";
        string orig_directory = "img/original";
        int stage_width = 600;
        int stage_height = 480;
        Random random = new Random();

        // array of allowed file type extensions
        string[] allowed_types = { "bmp", "gif", "png", "jpg", "jpeg", "doc", "xls" };

        /* Opening the thumbnail directory and looping through all the thumbs: */
        foreach (string file in Directory.GetFiles(thumb_directory)) {
            string title = Path.GetFileNameWithoutExtension(file);
            if (allowed_types.Contains(Path.GetExtension(file)) == true) {
                int left = random.Next(0, stage_width);
                int top = random.Next(0, 400);
                int rotation = random.Next(-40, -40);

                if ((top > stage_height - 130) && (left > stage_width - 230)) {
                    top -= 120 + 130;
                    left -= 230;
                }
            }
        }
    } 
```

# java - 让应用程序在其他应用程序之上运行

> ID：10266959
> 
> 赞同：9
> 
> 时间：2012-04-22T09:55:07.210
> 
> 标签：java, android, android-activity, dialog, multitasking

我想做一个可以在任何应用程序上方打开的活动。

通常，即使将活动设置为对话框，当您切换到我的应用程序时，您也会看到我的应用程序，并且在后台您会看到启动器：

![](../Images/8ee44fd0405eea4085e6f2fb3d382f77.png)

但是，我希望该应用程序能够超越任何这样的应用程序：（在 photoshop 中制作）：

![](../Images/6ef89adb0d5ca4543fa7a32932514d48.png)

我确实看到了这个问题[Creating a system overlay window (always on top)](https://stackoverflow.com/questions/4481226/creating-a-system-overlay-always-on-top-button-in-android)，但在 ICS 中，布局没有功能。此外，我想从我的应用程序中提供一个对话框而不最小化其他应用程序......

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2012-04-22T11:00:56.823

有很多应用程序在所有内容之上显示浮动视图，例如：airbrowser，LilyPad，Stick it，AirTerm，Smart Taskbar，aircalc ...

无论如何，为了实现这个功能，你必须有一个名为“android.permission.SYSTEM_ALERT_WINDOW”的特殊权限，并使用类似的东西：

```
final WindowManager.LayoutParams param=new WindowManager.LayoutParams();
param.flags=WindowManager.LayoutParams.FLAG_NOT_FOCUSABLE;
final View view=findViewById(R.id.my_floating_view);
final ViewGroup parent=(ViewGroup)view.getParent();
if(parent!=null)
  parent.removeView(view);
param.format=PixelFormat.RGBA_8888;
param.type=WindowManager.LayoutParams.TYPE_SYSTEM_ALERT;
param.gravity=Gravity.TOP|Gravity.LEFT;
param.width=parent!=null?LayoutParams.WRAP_CONTENT:view.getLayoutParams().width;
param.height=parent!=null?LayoutParams.WRAP_CONTENT:view.getLayoutParams().height;
final WindowManager wmgr=(WindowManager)getApplicationContext().getSystemService(Context.WINDOW_SERVICE);
wmgr.addView(view,param);
// TODO handle overlapping title bar and/or action bar
// TODO you must add logic to remove the view
// TODO you must use a special permission to use this method :android.permission.SYSTEM_ALERT_WINDOW
// TODO if you wish to let the view stay when leaving the app, make sure you have a foreground service running. 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2014-05-08T10:04:18.717

我是 Tooleap SDK 的开发人员之一，我们也处理过这个问题。基本上，您不需要使用`SYSTEM_ALERT_WINDOW`来在另一个活动之上显示活动。您可以只显示具有透明背景的常规“缩小”活动。

要制作“缩小的活动，请更改活动窗口布局的高度和宽度参数：

```
WindowManager.LayoutParams params = getWindow().getAttributes(); 
params.x = ...;
params.y = ...;
params.width = ...;
params.height = ...;

this.getWindow().setAttributes(params); 
```

要使透明背景添加到清单文件中的活动定义：

```
android:theme="@android:style/Theme.Translucent" 
```

这样，您可以创建浮动活动的错觉：

请注意，只有前台活动将恢复，而后台活动将暂停。但对于大多数应用程序来说，这应该不是问题。

现在剩下的就是何时启动浮动活动。

这是使用常规活动的“浮动”计算器应用程序的示例。请注意，计算器下方的活动属于另一个应用程序。

![Tooleap 计算器截图](../Images/fe1234c60549e6a4e451e2f3e9b82e72.png)

# r - 在文件夹之间移动文件

> ID：10266963
> 
> 赞同：57
> 
> 时间：2012-04-22T09:55:48.367
> 
> 标签：r, file-io, file-copying

我想使用 R 将文件从一个文件夹复制/粘贴到 Windows 中的另一个文件夹，但它不起作用。我的代码：

```
> file.rename(from="C:/Users/msc2/Desktop/rabata.txt",to="C:/Users/msc2/Desktop/Halwa/BADMASHI/SCOP/rabata.tx")

[1] FALSE 
```

* * *

## 回答 #1

> 赞同：66
> 
> 时间：2012-04-22T13:18:29.020

如果你想要一个类似`file.rename()`- 的函数来*创建*执行重命名所需的任何目录，你可以尝试这样的事情：

```
my.file.rename <- function(from, to) {
    todir <- dirname(to)
    if (!isTRUE(file.info(todir)$isdir)) dir.create(todir, recursive=TRUE)
    file.rename(from = from,  to = to)
}

my.file.rename(from = "C:/Users/msc2/Desktop/rabata.txt",
               to = "C:/Users/msc2/Desktop/Halwa/BADMASHI/SCOP/rabata.txt") 
```

* * *

## 回答 #2

> 赞同：37
> 
> 时间：2014-02-13T23:06:19.793

请注意，这`file.rename`实际上会从“来自”文件夹中删除文件。如果您只想制作副本并将原件留在原处，请`file.copy`改用。

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2019-09-13T18:43:01.433

# 使用`file.copy()` 或`fs::file_copy()`

```
file.copy(from = "path_to_original_file",
          to   = "path_to_move_to") 
```

然后您可以使用以下命令删除原始文件`file.remove()`：

```
file.remove("path_to_original_file") 
```

2021 年 10 月 8 日更新：您也可以使用`fs::file_copy()`. 我喜欢[`{fs}`](https://fs.r-lib.org/index.html)在 R 中进行一致的文件和目录管理。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2018-05-23T21:58:46.897

你可以试试`filesstrings`图书馆。此选项会将文件移动到目录中。示例代码：

首先，我们创建一个示例目录和文件：

```
dir.create("My_directory")
file.create("My_file.txt") 
```

其次，我们可以`My_file.txt`进入创建的目录`My_directory`：

```
file.move("My_file.txt", "My_directory") 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-11-05T15:30:47.900

您在第二个扩展名中缺少一个“t”字母。尝试这个：

```
file.rename(from="C:/Users/msc2/Desktop/rabata.txt",to="C:/Users/msc2/Desktop/Halwa/BADMASHI/SCOP/rabata.txt"). 
```

`file.copy()`此外，尝试该功能可能是值得的。它专门用于复制文件而不是重命名。

# php - 将用户输入过滤为 CSS

> ID：10266966
> 
> 赞同：1
> 
> 时间：2012-04-22T09:56:52.623
> 
> 标签：php, html, css

我正在为我的用户提供一种通过在他们的设置页面中输入一些 CSS 来更改其用户页面的 CSS 的方法。这是HTML：

```
<textarea class="code" name="Settings[css]"></textarea> 
```

在控制器中：

```
$model = new Profile;
$model->css = $_POST['Settings']['css']; 
```

我目前不验证 CSS 字段的输入。**我想知道我是否可以过滤 CSS，以便他们无法将有害代码放入页面。**例如，他们可以这样做：

```
</style>
Now I can put bad code in to your page 
```

我不认为用 HTMLpurifier 净化 css 是合适的，因为 CSS 通常包含特殊字符，但如果我错了，请纠正我。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-22T10:11:37.697

这与任何形式的 Yii 无关。

*如果您将用户 CSS*作为外部文件包含在内，则可以轻松删除您在示例中提供的“无效代码” 。

这还不是他们可以用 CSS 做的全部。您应该手动删除以下条目：

*   包含的行[`behavior: url( .. )`](http://msdn.microsoft.com/en-us/library/ms533503%28v=vs.85%29.aspx)
*   `!important`使用的所有实例
*   包含特定 ID 的选择器的条目，例如`#ads`和`#logo`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-22T10:11:57.027

`strip_tags()`可以从输入中删除 html 标签，尽管我认为这不是您唯一需要担心的事情。

一个更简单的解决方案可能是通过外部样式表 ( `<link rel="stylesheet" type="text/css" href="userstyle.php?uid=1235" />`) 而不是内联样式块加载此样式，这样就无法突破。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-22T10:08:17.500

您可以尝试这样的 php css 解析器：

[https://github.com/sabberworm/PHP-CSS-Parser](https://github.com/sabberworm/PHP-CSS-Parser)

但我无法告诉你它产生的代码质量或它如何处理输入问题。

我所知道的是，LESS 通常具有良好的调试功能。

如果您使用[LESS php 类](http://leafo.net/lessphp/)，您可以构建一个`$_POST['Settings']['css']`用于创建有效 CSS 的系统。或者，如果发生错误，您可以捕获它们并将其返回给浏览器。

是的，这有效地使您能够在该字段中使用[LESS 语法](http://leafo.net/lessphp/docs/)，但我不认为这样做有什么害处。LESS 在某些方面在 CSS 的语法中更加严格，无论它是否在列表中的最后一个属性和额外的字符也会触发错误，都需要分号。

虽然 javascript 版本的调试信息非常可靠，但我不能亲自担保 PHP 类，因为我只使用 JS，但据我所知，它是仅次于 JS 的第二好的东西。

*   [http://leafo.net/lessphp/](http://leafo.net/lessphp/)
*   [http://lesscss.org/](http://lesscss.org/)

# jquery-mobile - 在加载或清除 DOM 时刷新浏览器

> ID：10266968
> 
> 赞同：1
> 
> 时间：2012-04-22T09:57:33.107
> 
> 标签：jquery-mobile

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-22T16:34:08.833

摆脱：~~`$(function () {`~~

并将其替换为：`$(document).delegate('[data-role="page"]', 'pageinit', function () {`

请阅读本页顶部的大黄色部分：http: [//jquerymobile.com/demos/1.1.0/docs/api/events.html](http://jquerymobile.com/demos/1.1.0/docs/api/events.html)

您不能依赖`document.ready`或任何其他每页仅触发一次的事件。相反，您必须习惯于使用 jQuery Mobile 的自定义页面事件，`pageinit`这样当页面添加到 DOM 时，您的代码无论如何都可以工作（您不知道这何时会在 jQuery Mobile 网站中发生）。有很多事件，所以请再次阅读我上面链接到的文档。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-24T00:41:51.320

首先，使用服务器端模板引擎动态生成 html。我真的不明白人们在其中看到了什么价值。

我的猜测是，在 AJAX 流行之前 10 年前它曾经是有意义的，并且从那时起就一直存在，因为人们觉得它是“正确的方法”。它不是。特别是对于移动网络应用程序。

其次，看起来您正在尝试进行非常简单的搜索。所有这些 MVC4 垃圾让你很难看到真正发生的事情。对于像这样的简单表单提交，您不需要将参数附加到您的 URL。事实上，当您提交时，您的 TownId 应该已经是 POST 数据的一部分，因此您可以删除 URL 修改位。

或者，不要使用表单提交，而只是使用 GET 和 AJAX。我不知道你的应用在这里做什么，但我想你想以某种方式动态地在页面上显示结果，所以 GET 就足够了。

使用您的开发者浏览器工具 (F12) 查看提交时提交的具体内容 - 这确实很有帮助。对于您的下一个项目，请放弃 MVC4！“[完善的设计模式](http://www.asp.net/mvc/mvc4)”我的脚。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-26T16:13:23.750

我被这个问题困扰了很长时间我认为DOM中有相同的选择元素......我使用了 $('.SelectCSS:last').val() 它看起来效果很好。

我来自中国，英语很差...

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-15T11:43:50.023

我想这是面向未来的，MVC 和 jQuery Mobile 现在似乎还没有完全融合。也许 MS 对这个问题的回应是单页应用程序！

SPA也能满足丹尼尔？

# service - 将 Erlang Web 服务器用于 Web 应用程序的优势

> ID：10266971
> 
> 赞同：0
> 
> 时间：2012-04-22T09:57:50.253
> 
> 标签：service, erlang, high-availability, fault-tolerance, mochiweb

*注意：这个问题很大程度上受到我构建的 Web 应用程序的主要要求的影响：高可用性和容错性。所有其他要求（如可扩展性和用户数量）在这里都不是问题。*

我从这个社区的一位成员那里得到并[建议](https://stackoverflow.com/questions/8597128/using-otp-erlang-as-a-part-of-the-component-based-architecture-of-a-web-applicat)使用 Erlang Web 服务器作为我的 Web 应用程序的后端。

建议是我可以使用 Mochiweb 作为后端，使用 Django/Ruby on Rails 作为前端，使用 JSON 和面向服务的模型。

我能理解的这种方法的唯一明显优势是前端部分的开发“照常”——常规的 MVC 东西、Ru​​by on Rails 或任何其他人选择的通用框架。

但是其他优势呢？它们真的存在吗？

当然，Erlang/OTP 为所讨论的系统增加了容错能力，但是添加 Web 前端层不会将这个容错级别降低到低得多的水平吗？

难道我们不是通过将 Ruby on Rails 与 Mochiweb 耦合来引入“单点故障”吗？当然，Mochiweb 可以处理故障，但是如果前端出现问题怎么办？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T12:42:16.690

从技术上讲，Erlang/OTP 平台本身并没有做任何关于容错和高可用性的事情。它只是允许轻松实现并发和分布式软件。在一台机器上运行的 Erlang Web 服务器可能会像所有其他机器一样失败 - 只是因为硬件出现故障。

因此，对于 HA 站点，更重要的是为硬件和软件故障情况提供适当的冗余和回退方案，而不是使用任何特定的软件堆栈或平台。与其他平台相比，在 Erlang 中实现可能会稍微容易一些（当然，如果您熟悉它的话），但使用纯 Ruby/Python/Java/C 或几乎任何其他平台都可以实现完全相同的结果。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-22T11:28:44.410

网络行业在设置容错前端方面拥有大量经验。只需设置多个 Web 机器（通常是轻型反向代理）和某种 HA 管理器（内置于许多负载平衡解决方案中）。后端通常是较难的部分。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-24T23:42:20.920

如果后端是其他技术，我不会将 Erlang 用作前端 Web 服务器。

当后端也使用 Erlang 时，Erlang 作为 Web 服务器的许多好处就体现出来了。其中最大的是降低 I/O 成本。当您的前端和后端是完全独立的软件堆栈时，您将失去这种优势。

如果你打算在 Rails 上构建一些东西，你不妨使用一些你可以在前端获得更多帮助的东西，比如 nginx。

# arduino - 如何检查 Arduino Uno 上已存储的变量？

> ID：10266973
> 
> 赞同：1
> 
> 时间：2012-04-22T09:57:58.603
> 
> 标签：arduino

我有一个我想做的程序，它会询问变量是否已经存在。如果是，它会显示它，如果不是，它会创建它并使用 PROGMEM 命令将其存储在 Arduino 中。有人可以解释更多关于 PROGMEM 以及如何制作我正在谈论的程序吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-22T10:09:13.853

一般来说，如果您在函数中创建任何变量，它们仅在函数关闭时才存在，所有变量都会被删除。如果您想让它们保持活力，请尝试创建全局变量或在它之前使用静态；像这儿

```
static int myvariable; 
```

这是您问题的答案

```
 if (myvariable!=NULL)
    {
     printfucntion(myvariable);
    } 
```

eeprom的解决方案

EEPROM 读取 读取 EEPROM 的每个字节的值并将其打印到计算机。

```
#include <EEPROM.h>

// start reading from the first byte (address 0) of the EEPROM
int address = 0;
byte value;

void setup()
{
  Serial.begin(9600);
}

void loop()
{
  // read a byte from the current address of the EEPROM
  value = EEPROM.read(address);

  Serial.print(address);
  Serial.print("\t");
  Serial.print(value, DEC);
  Serial.println();

  //move to next address of the EEPROM
  address = address + 1;

  // there are only 512 bytes of EEPROM, from 0 to 511, so if you are
  // on address 512, wrap around to address 0
  // if you have arduinoMega probably there is more eeprom space
  if (address == 512)
    address = 0;

  delay(500);
} 
```

我希望我有所帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-06-29T06:25:35.423

这是一个相当陈旧的问题，而且不是那么受欢迎。但是是一个有效的问题。在 php 中，我一直在使用`isset()`来测试变量的存在。因此，也许 OP 正在从 php 的“不做爱”世界进入嵌入式 / C 编程，在这个世界中，任何事情都会发生，并且不习惯于 C 的极其文字和正式的国家。

正如[这里所指出的](http://cboard.cprogramming.com/c-programming/59173-how-check-if-variable-exists.html)，C 语言具有条件定义`#ifdef`，`#ifndef`通常用于测试是否定义了某些内容。为了更好地理解这种用法​​的细微差别，应该访问[Programmers.SE](https://softwareengineering.stackexchange.com/search?q=ifdef)并询问有关条件定义的专业哲学。

我？我正在通过 EEPROM 研究 Arduino 上的永久变量存储。这里有[两篇](http://tronixstuff.wordpress.com/2011/03/16/tutorial-your-arduinos-inbuilt-eeprom/)不同的[优秀](http://tronixstuff.wordpress.com/2011/05/11/discovering-arduinos-internal-eeprom-lifespan/)文章。而关于`#ifdef`'s? 我只是一名卑微的软件工程师，并将其留给软件架构师。;-) 我从来没有故意实现它们，只是看到了很多。

OP 问题的字面答案是：查询变量并尝试使用它。如果未定义，Arduino 的 IDE 编译器会尖叫。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-01-08T12:01:01.797

它很简单，只需要声明一个变量。只需与元素数组进行比较，你想与之比较。如果存在数组元素和输入元素，则使用 Serial.print() 语句显示，否则将其存储在缓冲区数组中累积它。显示它。

当你在做单链接列表时

# php - PHP 文档在 Aptana 中不起作用

> ID：10266978
> 
> 赞同：4
> 
> 时间：2012-04-22T09:58:33.090
> 
> 标签：php, aptana

我已经安装了**Aptana Studio 3**，将我的工作区设置为`C:\wamp\www`并将项目性质仅设置为`PHP - primary`. 一切正常（例如扩展类的自动完成），但 PHP 文档根本不起作用。我添加了一些功能，例如

```
/**
 * Test
 */
public function error($status_code, $message = null) {
    ....
} 
```

但是当我将它悬停时（我保存了文件）我得到了`No available documentation`？问题出在哪里？：/

我在 Windows 7 32 位。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-23T05:10:52.357

当您`error`在函数声明的单词上时，悬停将不起作用（一个错误）。

当您调用该`error`函数时，它应该对您有用。当您编写代码辅助时，您应该会看到文档悬停​​，当您悬停单词时也会看到类似的信息。

# php - 编辑查询不会更改数据库中的任何内容

> ID：10266979
> 
> 赞同：0
> 
> 时间：2012-04-22T09:58:57.087
> 
> 标签：php, sql

此代码应该使用在编辑网页上所做的更改来更新数据库中已经存在的文章，但它不起作用。它显示当前文章，但是当我进行更改并单击“保存”时，没有任何变化。

```
mysql_select_db("scms", $con );  
$show_world="show_world";
define("IMG_URL", "http://localhost/project/show/show_home/images/");
define("ABS_PATH",dirname(__FILE__));
define("IMG_PATH",dirname(__FILE__)."/");
$id = $_GET['id'];
$sql = "select * FROM $show_world where id = $id";
$result=mysql_query($sql);
$row = mysql_fetch_array($result);
if(isset($_POST['save'])) {
    $id = $_POST['id'];
    $topic = $_POST['topic'];
    $author = $_POST['author'];
    $content = $_POST['content'];
    $picture = $_POST['picture'];
    $date = $_POST['date'];
    $sql = "UPDATE $show_world SET topic='".$topic."',author='".$author."', content='".$content."', date='".$date."' "; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-22T10:02:42.077

尝试像这样封闭表名的变量：

```
$sql = "UPDATE {$show_world} SET topic='".$topic..... 
```

还有一件事：您的代码容易受到 sql 注入的影响！尝试转义用户输入，然后在数据库中更新它。

# javascript - JQuery 在不同的 div 上悬停淡入/淡出

> ID：10266984
> 
> 赞同：1
> 
> 时间：2012-04-22T09:59:24.323
> 
> 标签：javascript, jquery, html, css

我在一个名为 header 的 div 中有列表，我想在悬停在每个列表上时展开列表，但我希望所有悬停在上面的列表保持打开状态，直到鼠标移出标题 div。到目前为止，我为每个列表单独设置了淡入/淡出，或者我可以让每个列表淡入并保持打开状态，但在我移出 div 时不会淡出。

这是我正在使用的代码：http: [//jsfiddle.net/jTCdg/11/](http://jsfiddle.net/jTCdg/11/)

javascript 中注释掉的行是所有列表保持可见或悬停时列表淡入/淡出之间的变化。

这是我第一次使用 javascript，因此将不胜感激。谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-22T10:05:19.817

jQuery [hover](http://api.jquery.com/hover/)是[mouseenter](http://api.jquery.com/mouseenter/)和[mouseleave](http://api.jquery.com/mouseleave/)事件处理程序的快捷方式。您可以分别定义两者。

```
$(document).ready(function() {
    $("#header ul").mouseenter(function() {
        $(this).find("li").fadeIn();
    });
    $("#header").mouseleave (function() {
        $(this).find("li").fadeOut();
    });
}); 
```

另请参阅[更新的 jsfiddle](http://jsfiddle.net/jTCdg/12/)。

# aop - 如何将 context(ApplicationContext) 作为参数传递给 logBefore Method(Method of Aspect)？

> ID：10266985
> 
> 赞同：1
> 
> 时间：2012-04-22T09:59:29.363
> 
> 标签：aop, aspectj, eager-loading, pointcut, cross-cutting-concerns

我想实现一个方面来避免延迟加载问题。那么如何将上下文（应用程序上下文）作为 logBefore 方法的参数传递？什么是签名切入点定义了上面的方法（我制作“???”的地方），知道这个方法（logBefore）将在所有具有“Set”作为结果类型和“slm. aoa.buisiness.facade”作为包

```
 @Aspect
      public class EagerLoading {

    @Before("execution(???)")
    public void logBefore(JoinPoint joinPoint) {

        SessionFactory sessionFactory = (SessionFactory) context.getBean("sessionFactory");
          Session session = SessionFactoryUtils.getSession(sessionFactory, true);
          TransactionSynchronizationManager.bindResource(sessionFactory, new SessionHolder(session));
    } 
```

并感谢您的帮助。

# emacs - 如何仅为 *.el 文件启用 Show-Paren 模式

> ID：10266986
> 
> 赞同：4
> 
> 时间：2012-04-22T09:59:29.690
> 
> 标签：emacs, elisp

如何仅为 *.el 文件启用 Show-Paren 模式？

我试过了

```
(add-hook 'emacs-lisp-mode-hook '(lambda()
                                   (show-paren-mode 1)
                                   )) 
```

但它仍然为所有情况启用 Show-Paren 模式。即使在`*scratch*`缓冲区中，我也启用了 Show-Paren 模式。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-04-22T13:39:36.963

如前所述，`show-paren-mode`是一种全局次要模式。也就是说，一个人可能只能在一些缓冲区上运行它，例如：

```
(show-paren-mode)                       ;; activate the needed timer
(setq show-paren-mode ())                ;; The timer will do nothing if this is nil

(defun show-paren-local-mode ()
  (interactive)
  (make-local-variable 'show-paren-mode) ;; The value of shom-paren-mode will be local to this buffer.
  (setq show-paren-mode t))

(add-hook 'emacs-lisp-mode-hook 'show-paren-local-mode) 
```

它未经测试，它可能无法正常工作。查看文档可能有效，但查看代码可能有效。这可能仅适用于某些版本的 show-paren-mode。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-22T12:51:35.703

`show-paren-mode`是全局次要模式。这意味着它听起来如何。这在很大程度上是设计使然，因为大多数人（包括我自己）发现这种次要模式对所有缓冲区都有帮助。为什么要对任何文件禁用它？

从文档

> Show Paren 模式是一种全局次要模式。启用后，任何匹配的括号都会在`show-paren-style' after` Emacs 空闲时间的 show-paren-delay' 秒内突出显示。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-22T10:12:41.443

你的代码是正确的。但是，您应该考虑这样一个事实，即`*scratch*`缓冲区的主要模式`lisp-interaction-mode`源自`emacs-lisp-mode`（这几乎无关紧要）和模式的定义：

```
(define-minor-mode show-paren-mode
  "Toggle visualization of matching parens (Show Paren mode).
With a prefix argument ARG, enable Show Paren mode if ARG is
positive, and disable it otherwise.  If called from Lisp, enable
the mode if ARG is omitted or nil.

Show Paren mode is a global minor mode.  When enabled, any
matching parenthesis is highlighted in `show-paren-style' after
`show-paren-delay' seconds of Emacs idle time."
  :global t :group 'paren-showing
...) 
```

`:global t`是这里的关键 - 该模式是全局的，并且在所有缓冲区中都启用，无论它们的主要模式如何。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2022-01-09T17:47:27.350

我认为你可以使用

```
(setq-default show-paren-data-function #'ignore)
(show-paren-mode) 
```

正式启用该模式但保持安静。然后像

```
(defun set-up-emacs-lisp-mode ()
  (setq-local show-paren-data-function #'show-paren--default))

(add-hook 'emacs-lisp-mode-hook #'set-up-emacs-lisp-mode) 
```

在 Emacs Lisp 缓冲区中启用它。我没有测试过这个设置，只是相反（通常启用，仅在文本模式下禁用）。

我曾经使用过`(setq-local show-paren-mode nil)`，但这会使 Emacs 突出显示 Ido 提示符中的大括号，所以我更喜欢`(setq-default show-paren-data-function #'ignore)`.

# php - 如何使用 php 自动从贝宝退订用户（当他们升级到不同的订阅时）

> ID：10266987
> 
> 赞同：2
> 
> 时间：2012-04-22T09:59:30.537
> 
> 标签：php, paypal, subscription, paypal-ipn

当用户在我的网站上升级他们的订阅时，IPN 会联系我，然后我想使用 php 联系 paypal 以取消他们可能拥有的任何现有订阅。我该怎么做呢？我只能找到如何使用用户必须单击的按钮来做到这一点。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-12-23T15:02:40.663

这是我找到的最佳解决方案：

[http://thereforei.am/2012/07/03/cancelling-subscriptions-created-with-paypal-standard-via-the-express-checkout-api/](http://thereforei.am/2012/07/03/cancelling-subscriptions-created-with-paypal-standard-via-the-express-checkout-api/)

```
/**
 * Performs an Express Checkout NVP API operation as passed in $action.
 *
 * Although the PayPal Standard API provides no facility for cancelling a subscription, the PayPal
 * Express Checkout  NVP API can be used.
 */
function change_subscription_status( $profile_id, $action ) {

    $api_request = 'USER=' . urlencode( 'api_username' )
                .  '&PWD=' . urlencode( 'api_password' )
                .  '&SIGNATURE=' . urlencode( 'api_signature' )
                .  '&VERSION=76.0'
                .  '&METHOD=ManageRecurringPaymentsProfileStatus'
                .  '&PROFILEID=' . urlencode( $profile_id )
                .  '&ACTION=' . urlencode( $action )
                .  '&NOTE=' . urlencode( 'Profile cancelled at store' );

    $ch = curl_init();
    curl_setopt( $ch, CURLOPT_URL, 'https://api-3t.sandbox.paypal.com/nvp' ); // For live transactions, change to 'https://api-3t.paypal.com/nvp'
    curl_setopt( $ch, CURLOPT_VERBOSE, 1 );

    // Uncomment these to turn off server and peer verification
    // curl_setopt( $ch, CURLOPT_SSL_VERIFYPEER, FALSE );
    // curl_setopt( $ch, CURLOPT_SSL_VERIFYHOST, FALSE );
    curl_setopt( $ch, CURLOPT_RETURNTRANSFER, 1 );
    curl_setopt( $ch, CURLOPT_POST, 1 );

    // Set the API parameters for this transaction
    curl_setopt( $ch, CURLOPT_POSTFIELDS, $api_request );

    // Request response from PayPal
    $response = curl_exec( $ch );

    // If no response was received from PayPal there is no point parsing the response
    if( ! $response )
        die( 'Calling PayPal to change_subscription_status failed: ' . curl_error( $ch ) . '(' . curl_errno( $ch ) . ')' );

    curl_close( $ch );

    // An associative array is more usable than a parameter string
    parse_str( $response, $parsed_response );

    return $parsed_response;
} 
```

例子：

```
change_subscription_status( 'I-NARPL1C00000', 'Cancel' ); 
```

我希望它有帮助

# java - 如何使用 Getopt 解析参数而不使用前导连字符

> ID：10266988
> 
> 赞同：2
> 
> 时间：2012-04-22T09:59:42.953
> 
> 标签：java, c, command-line-arguments, option, getopt

我正在尝试使用`Getopt`.
但是，我的一些论点来自形式`host myhost server myserver`where`host`和`server`is constants 并且`myhost`and`myserver`是变化的论点。

我可以解析这样的选项吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-22T16:16:34.850

您可能能够预处理`argv`数组（最好将其复制到新位置，而不是尝试就地修改它）以符合预期的形式，然后使用`getopt`. 但是，这可能是值得做的更多工作，并且可能仍然存在打破的极端情况。`getopt`仅适用于选项符合 POSIX 准则的实用程序。我只想编写您自己的参数处理代码；实际上，即使`getopt`可以工作，这也是我的偏好，因为我通常更喜欢数据驱动（例如，描述可能的选项/参数、它们的类型以及它们应该如何存储的结构数组）命令行处理到代码驱动（`switch`带有显式代码的语句每个选项）。

# c# - 在带有 id 参数的 SQL 中选择

> ID：10266993
> 
> 赞同：0
> 
> 时间：2012-04-22T10:00:54.920
> 
> 标签：c#, sql

我在 sql 中有一个表，我使用此语句进行选择：

```
SELECT id, name, genre FROM table 
```

现在`genre`是 id (int)，我有一个名为 Genres 的表，我有：

```
id (int)
name (string) 
```

什么选择会给我流派的名称而不是ID。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-22T10:02:29.113

```
SELECT t.id, t.name, g.name 
FROM table t 
   JOIN genres g ON t.genre = g.id 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-22T10:04:12.840

```
SELECT t.id, t.name, g.name
FROM table t, genres g
WHERE t.genre = g.id 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-22T10:04:52.200

您需要使用[加入](http://www.w3schools.com/sql/sql_join.asp)

```
 select G.name 
    from table table1 T,Genres G
    where T.genre = G.id; 
```

# c# - 在 C# 中将 DataRow 对象添加到 DataTable

> ID：10266999
> 
> 赞同：1
> 
> 时间：2012-04-22T10:01:44.853
> 
> 标签：c#, datatable

我正在尝试遍历我的数据库以查找具有日期范围的特定行。每当我尝试使用 DataTable.Import(DataRow) 时，它都会添加一个内部没有值的新行。如何将 DataRow “导入”到 DataTable 中？这是循环，谢谢！

```
 public DataTable FilterDataTableByDates(DataTable td, DateTime from, DateTime to)
    {
        DataTable tempTd = new DataTable();
        foreach (DataRow dr in td.Rows)
        {
            long ticks = Convert.ToInt64(dr["cpd_date"].ToString());
            if (ticks > from.Ticks && ticks < to.Ticks)
            {
                tempTd.ImportRow(dr);
            }
        }
        return tempTd.Copy();
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-22T10:12:31.177

您可以使用 Add 方法将 DataRow 从一个数据表复制到另一个：

```
tempTd.Rows.Add(dr.ItemArray); 
```

甚至您的方法也可以工作，但您必须创建 DataTable 来应对来自原点的结构：

```
DataTable tempTd = td.Clone(); 
```

使用[Clone()](http://msdn.microsoft.com/en-us/library/system.data.datatable.clone.aspx)方法，您可以创建一个与原始数据表具有相同结构的新数据表，然后您可以在其中导入行。

所以你的完整方法将变为：

```
public DataTable FilterDataTableByDates(DataTable td, DateTime from, DateTime to)
{
    DataTable tempTd = td.Clone();
    foreach (DataRow dr in td.Rows)
    {
        long ticks = Convert.ToInt64(dr["cpd_date"].ToString());
        if (ticks > from.Ticks && ticks < to.Ticks)
        {
            tempTd.ImportRow(dr);
        }
    }
    return tempTd.Copy();
} 
```