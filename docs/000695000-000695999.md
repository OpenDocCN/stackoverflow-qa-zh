# StackOverflow 问答 000695000-000695999

# linux - /dev/input/by-path/pci-xxx-kbd 输出的格式是什么？

> ID：695000
> 
> 赞同：2
> 
> 时间：2009-03-29T17:22:53.703
> 
> 标签：linux

做完之后

```
$ cat /dev/input/by-path/pci-0000:00:02.0-usb-0:2:1.0-event-kbd > ~/test_kbd 
```

作为 root，我得到了一堆二进制代码（这是预期的）。现在，我想知道如何解释这个二进制代码来确定按下了什么键？输出的格式是什么？有没有我可以看的参考资料，它会告诉我每个二进制代码代表什么键？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-29T18:01:17.247

我猜他们是扫描码。 [此页面](http://www.computer-engineering.org/ps2keyboard/scancodes2.html)列出了现代键盘使用的按键的通断代码。有关 PS/2 键盘编程的更多信息，请参阅[Adam Chapweske 的资源](http://www.computer-engineering.org/index.html)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-29T11:15:57.237

此文件提供键盘事件（二进制格式）。采用

```
evtest /dev/input/by-path/pci-0000:00:02.0-usb-0:2:1.0-event-kbd 
```

获取一些信息。

# vim - 你如何在 Vim 中搜索所有源代码？

> ID：695024
> 
> 赞同：43
> 
> 时间：2009-03-29T17:46:43.600
> 
> 标签：vim, grep

使用 Vim 时，给定一个充满代码的目录（例如 ~/trunk/）和许多子目录，有没有办法在整个源代码中 grep/搜索文本/正则表达式的实例？

目前我使用：

```
:lcd ~/trunk
:grep "pattern" *.py */*.py */*/*.py */*/*/*.py 
```

（显然我将其限制为 Python 文件，这是一个不同的问题，但值得注意的是，理想情况下，我希望将搜索限制为具有特定扩展名的文件。）

* * *

## 回答 #1

> 赞同：44
> 
> 时间：2009-03-29T17:57:12.203

```
:vimgrep "pattern" ~/trunk/**/*.py
:copen 20 
```

如果你有一个相当大的项目，我建议你使用[cscope](http://cscope.sourceforge.net/)和[vim 插件](http://www.vim.org/scripts/script_search_results.php?keywords=cscope&script_type=&order_by=rating&direction=descending&search=search)。这是一个专为处理大型项目而设计的：[SourceCodeObedience](http://www.vim.org/scripts/script.php?script_id=1638)

有一个关于如何使用[SourceCodeObedience](http://www.vim.org/scripts/script.php?script_id=1638) [grep 文本](http://www.railmoon.com/sourcecodeobedience/cscope-text)的简要说明。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-03-29T17:57:43.167

我直接使用 grep 。

```
grep -IirlZ "pattern" .|xargs -0 vim

-I: ignore binary
-i: ignore case
-r: recursive
-l: print file name only
-Z: print \0 after each file name 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-03-29T18:01:51.770

您可能需要查看`:vimgrep`并查看`:grep`vim 文档。 `:vimgrep`使用 vim 自己的模式搜索功能并将所有文件读入 vim 缓冲区。 `:grep`默认情况下链接到系统上的外部`grep`实用程序，但您可以通过设置 `grepprg`选项来更改行为。这是在线文档的链接：

[http://vimdoc.sourceforge.net/htmldoc/quickfix.html#grep](http://vimdoc.sourceforge.net/htmldoc/quickfix.html#grep)

在 Vim Tips Wiki 的“在 Vim 中查找文件”的提示中有更多信息以及其他一些选项：

[http://vim.wikia.com/wiki/Find_in_files_within_Vim](http://vim.wikia.com/wiki/Find_in_files_within_Vim)

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-03-30T22:29:48.793

设置`grepprg`为[Ack](https://github.com/mileszs/ack.vim)，然后使用`:grep`Ack 进行搜索。

或者使用 ctags。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2015-06-14T07:04:45.670

`Ag`是递归搜索模式的好选择。

[https://github.com/rking/ag.vim](https://github.com/rking/ag.vim)

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-03-29T17:55:31.363

您可以使用[:vimgrep](http://vimdoc.sourceforge.net/htmldoc/quickfix.html#:vimgrep)即：

```
  :vimgrep /pattern/ **/*.py

```

检查这个 Vim 提示：

*   [在 Vim 中查找文件](http://vim.wikia.com/wiki/Find_in_files_within_Vim)

还可以看看[grep.vim](http://www.vim.org/scripts/script.php?script_id=311)，它是一个插件，将 grep、fgrep、egrep 和 agrep 工具与 Vim 集成在一起，允许您在一个或多个文件中搜索模式并跳转到它们...

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-03-29T21:14:57.343

[您可以使用ctags](http://ctags.sourceforge.net/)生成源代码索引，然后 VIM 可以[使用它](http://www.faqs.org/docs/ldev/0130091154_64.htm)在您的代码库中无缝导航。它具有源代码意识，您可以直接跳转到方法声明等。

您需要每隔一段时间重新生成 ctags 文件，但您可以将其作为 make 过程的一部分。除非您的代码库很大，否则它应该很快。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2020-09-14T12:41:00.713

没有人提到它，但我现在倾向于使用[ripgrep](https://github.com/BurntSushi/ripgrep)

# php - 此查询的可能 JOIN

> ID：695025
> 
> 赞同：0
> 
> 时间：2009-03-29T17:48:25.890
> 
> 标签：php, mysql

我有这个查询：

```
$sql = "SELECT 
      updates.u_id AS u_id,
      updates.date_submitted AS date_submitted,
      updates.deadline AS deadline,
      updates.description AS description,
      updates.priority AS priority,
      pages.page_name AS page_name,
      clients.fname AS fname,
      clients.lname AS lname,
      projects.p_url AS p_url,
      projects.p_title AS p_title
      FROM updates
      INNER JOIN projects ON updates.p_id = projects.p_id
      INNER JOIN clients  ON projects.c_id  = clients.c_id
      INNER JOIN pages    ON updates.page  = pages.page
      LEFT JOIN admin ON updates.a_id = admin.a_id
      WHERE u_id='$id' LIMIT 1"; 
```

给我一个问题的部分是：

```
 INNER JOIN pages    ON updates.page  = pages.page 
```

我正在使用此查询来显示某个项目的更新信息。我将页面存储在 PAGES 表中，当客户提交更新时，他们可以选择他们想要更新的页面。

我在我的 UPDATE 表中有这个：updates.page 在这种情况下存储为 INT 我的行之一是“1”

在我的 PAGES 表中，我有： pages.page_id 与：updates.page

知道我可以用我的查询做什么来解决这个问题吗？

错误：

“on 子句”中的未知列“pages.page”

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-29T17:52:19.327

尝试将其更改为：

```
INNER JOIN pages    ON updates.page  = pages.page_id 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-29T17:50:48.800

您自己告诉我们 - pages 中的关键列是 pages.page_id，而不是您在加入中使用的 pages.page。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-29T17:51:08.910

尝试用 pages.page_id 替换 pages.page

# java - 为什么我的 JFrame 不隐藏？

> ID：695027
> 
> 赞同：0
> 
> 时间：2009-03-29T17:48:46.077
> 
> 标签：java, multithreading, jframe, show-hide, netbeans6.1

我正在为我的高级设计项目在 Netbeans 6.1 中创建一个 GUI，但我遇到了一个烦人的障碍。当我告诉它时，像我的登录弹出窗口和其他临时窗口不会消失。我一直在研究如何解决这个问题大约 2 个月。我什至为我的弹出窗口创建了一个单独的线程，但它仍然无法工作......如果我真的不与任何其他 GUI 组件混淆，它会消失的唯一方法......我的示例代码应该有助于描述我的愤怒...不要介意影子代码，这是出于测试目的，这显然没有帮助。

```
//This method is called once a user presses the "first" login button on the main GUI
public synchronized void loginPopUpThread() {
    doHelloWorld = new Thread(){
        @Override
        public synchronized void run()
        {
            try
            {
                    loginPopUpFrame.pack();
                    loginPopUpFrame.setVisible(true);
                    System.out.println("waitin");
                    doHelloWorld.wait();
                    System.out.println("Not Sleepin..");
                    loginPopUpFrame.pack();
                    loginPopUpFrame.setVisible(false);
            }
            catch (InterruptedException e)
            {
            }
        }
    };
    doHelloWorld.start();

//This is called when the "second" loginB is pressed and the password is correct...
public synchronized void notifyPopUp() {
    synchronized(doHelloWorld) {

        doHelloWorld.notifyAll();
        System.out.println("Notified");
    }
} 
```

我也尝试过 Swing Utilities，但也许我实施错了，因为这是我第一次使用它们。它基本上与上面的代码做同样的事情，除了窗口在等待时冻结，上面的代码没有做：

```
javax.swing.SwingUtilities.invokeLater(new Runnable() {
        public synchronized void run() {
            try
            {
                    loginPopUpFrame.pack();
                    loginPopUpFrame.setVisible(true);
                    System.out.println("waitin");
                    wait();
                        System.out.println("Not Sleepin.");
                        loginPopUpFrame.pack();
                       loginPopUpFrame.setVisible(false);
            }
            catch (InterruptedException e)
            {
            }
        }
    }); 
```

请帮我！！！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-29T17:57:44.400

Swing 组件只能由 swing 事件调度线程操作。

SwingUtilites 类具有向调度线程提交任务的方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-29T19:58:27.153

经验法则：

*   不要在任意线程中操作 GUI 组件；总是安排在事件线程中操作它们
*   **永远不要在事件线程内等待或休眠** （因此，永远不要在发送到 invokeLater() 的代码内）

所以你如何解决这个问题的答案是“其他方式”......

稍微退后一步，*您实际上想要做什么？*如果您只想让登录对话框等待用户输入用户名和密码，是否有理由不只使用模态 JDialog（毕竟，这就是它的用途......）。

如果您确实希望某个任意线程等待关闭窗口/操作 GUI 的信号，那么您**需要在另一个线程中等待**，然后使用实际的 GUI 操作使*该*线程调用 SwingUtilities.invokeLater()代码。

PS 实际上有一些 GUI 操作方法可以安全地从其他线程调用，例如“只是设置标签”的调用通常是安全的。但是哪些调用是安全的并没有很好的定义，所以最好在实践中避免这个问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-29T19:57:31.787

很难诊断您的问题。我不确定你想用[等待](http://java.sun.com/javase/6/docs/api/java/lang/Object.html#wait())方法做什么，但我建议单独留下[等待](http://java.sun.com/javase/6/docs/api/java/lang/Object.html#wait())/[通知。](http://java.sun.com/javase/6/docs/api/java/lang/Object.html#notify())

此代码有两个框架 - 当您创建第二个框架时，第一个将隐藏，直到您关闭它。

```
public class SwapFrames {

  private JFrame frame;

  private JFrame createMainFrame() {
    JButton openOtherFrameButton = new JButton(
        "Show other frame");

    frame = new JFrame();
    frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
    Container contentPane = frame.getContentPane();
    contentPane.setLayout(new FlowLayout());
    contentPane.add(openOtherFrameButton);
    frame.pack();

    openOtherFrameButton
        .addActionListener(new ActionListener() {
          @Override
          public void actionPerformed(ActionEvent e) {
            onClickOpenOtherFrame();
          }
        });

    return frame;
  }

  private void onClickOpenOtherFrame() {
    frame.setVisible(false);

    JFrame otherFrame = new JFrame();
    otherFrame
        .setDefaultCloseOperation(JFrame.DISPOSE_ON_CLOSE);
    otherFrame.setContentPane(new JLabel(
        "Close this to make other frame reappear."));
    otherFrame.pack();
    otherFrame.setVisible(true);
    otherFrame.addWindowListener(new WindowAdapter() {
      @Override
      public void windowClosed(WindowEvent e) {
        frame.setVisible(true);
      }
    });
  }

  public static void main(String[] args) {
    JFrame frame = new SwapFrames().createMainFrame();
    frame.setVisible(true);
  }

} 
```

因为我在您的代码中没有看到任何证据，所以我建议您[阅读使用事件侦听器](http://java.sun.com/docs/books/tutorial/uiswing/events/index.html)而不是试图“等待”代码完成。

尚不完全清楚您要实现的目标，但使用模态对话框可能会更好：

```
public class DialogDemo {

  public JFrame createApplicationFrame() {
    JButton openDialogButton = new JButton("Open Dialog");

    final JFrame frame = new JFrame();
    frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
    Container container = frame.getContentPane();
    container.setLayout(new FlowLayout());
    container.add(openDialogButton);
    frame.pack();

    openDialogButton
        .addActionListener(new ActionListener() {
          @Override
          public void actionPerformed(ActionEvent e) {
            onOpenDialog(frame);
          }
        });

    return frame;
  }

  private void onOpenDialog(JFrame frame) {
    JDialog dialog = createDialog(frame);
    dialog.setVisible(true);
  }

  private JDialog createDialog(JFrame parent) {
    JButton closeDialogButton = new JButton("Close");

    boolean modal = true;
    final JDialog dialog = new JDialog(parent, modal);
    dialog
        .setDefaultCloseOperation(JDialog.DISPOSE_ON_CLOSE);
    Container container = dialog.getContentPane();
    container.add(closeDialogButton);
    dialog.pack();
    dialog.setLocationRelativeTo(parent);

    closeDialogButton
        .addActionListener(new ActionListener() {
          @Override
          public void actionPerformed(ActionEvent e) {
            dialog.setVisible(false);
          }
        });

    return dialog;
  }

  public static void main(String[] args) {
    new DialogDemo().createApplicationFrame().setVisible(
        true);
  }

} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-29T21:47:49.683

如何简单地做：

```
//This method is called once a user presses the "first" login button on the main GUI
public void loginPopUpThread() {
    SwingUtilities.invokeLater(new Runnable() {
        public void run() {
            loginPopUpFrame.pack();
            loginPopUpFrame.setVisible(true);
        }
    };
}

//This is called when the "second" loginB is pressed and the password is correct...
public void notifyPopUp() {
    SwingUtilities.invokeLater(new Runnable() {
        public void run() {
            loginPopUpFrame.setVisible(false);
        }
    };
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-29T22:29:07.510

您真正想要使用的是模态 JDialog。

请注意，其中的一些内容被忽略了。这是你的作业/项目。

```
public void actionPerformed(ActionEvent e)
{
   // User clicked the login button
   SwingUtilities.invokeLater(new Runnable()
   {
       public void run()
       {
         LoginDialog ld = new LoginDialog();
         // Will block
         ld.setVisible(true);
       }
   });
}

public class LoginDialog extends JDialog
{
    public LoginDialog()
    {
        super((Frame)null, "Login Dialog", true);

        // create buttons/labels/components, add listeners, etc
    }

    public void actionPerformed(ActionEvent e)
    {
       // user probably clicked login
       // valid their info
       if(validUser)
       {
          // This will release the modality of the JDialog and free up the rest of the app
          setVisible(false);
          dispose();
       }
       else
       {
          // bad user ! scold them angrily, a frowny face will do
       }
    }
} 
```

# cocoa - 有没有办法从 Cocoa WebView 对象中使用 WebKit Web 检查器？

> ID：695038
> 
> 赞同：36
> 
> 时间：2009-03-29T17:54:10.603
> 
> 标签：cocoa, webkit

我想在 OS X 上基于 WebKit 的自定义浏览器中使用 WebKit 网络检查器。是否可以在 webview 对象上使用网络检查器？如果是这样，怎么做？

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2012-02-23T00:05:32.590

一个非常简单的方法......在终端......⌘⬆☺</p **>**

`defaults write com.yourcompany.yourbundleid WebKitDeveloperExtras TRUE`

（对于 OSX 10.8，请`defaults write com.yourcompany.yourbundleid WebKitDeveloperExtras -bool true`改用）。

**注意：**您**必须**更改**`com.yourcompany.yourbundleid`**为您的特定“应用程序”（或任何公司的应用程序`bundle ID`）*才能*正常工作！**

关于这一点的好处...没有*办法*忘记*将其取出，将其关闭，将其注释掉等*...这是本地设置...并且可以为任何启用 webkit 的应用程序设置.. . 如果你没有看到开发者菜单，或者诸如此类.. 不用担心..

`Right``☝ (click)`在 Webview 上并转到“显示检查器”。

此外，按照同样的思路，以下可能也可以做*一些事情*..但我还没有尝试过，所以不确定..

`defaults write com.yourcompany.yourbundleid IncludeDebugMenu 1`

* * *

## 回答 #2

> 赞同：36
> 
> 时间：2009-03-29T18:21:27.010

发送时设置`WebKitDeveloperExtras`为`YES`默认用户默认值`-[NSUserDefaults registerDefaults:]`。当然，这适用于整个应用程序。

请记住，用户可以将其更改为`NO`，因此不要假设它是`YES`——如果它很重要（例如，在自定义上下文菜单时），请始终检查。

警告：此首选项不一定只启用元素检查器。Apple 可能会在未来扩展它以控制菜单栏中的调试菜单。您可能会发现这是不可接受的风险。

* * *

## 回答 #3

> 赞同：23
> 
> 时间：2013-05-10T13:16:35.683

苹果[建议](https://developer.apple.com/library/safari/documentation/AppleApplications/Conceptual/Safari_Developer_Guide/GettingStarted/GettingStarted.html#//apple_ref/doc/uid/TP40007874-CH2-SW1)：

```
defaults write com.example.myApp WebKitDeveloperExtras -bool true 
```

但是，据我所知，如果您在沙盒之外运行应用程序（在开发的某些阶段可能需要这样做），这可能不再有效。如果您遇到这个问题，对我有用的是在 NSGlobalDomain 中设置 WebKitDeveloperExtras 键的值：

```
defaults write NSGlobalDomain WebKitDeveloperExtras -bool true 
```

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2010-12-10T09:17:24.750

在我的情况下（MacOSX 10.6.5）它不起作用。

我必须在我的 webView WindowController 的 windowDidLoad 方法中执行以下操作：

```
/* 初始化 webInspector。*/
[[NSUserDefaults standardUserDefaults] setBool:TRUE forKey:@"WebKitDeveloperExtras"];
[[NSUserDefaults standardUserDefaults] 同步];

```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-12-09T17:34:44.993

我试过这样做，但看不到网络检查器。

不是一样`[[NSUserDefaults standarduserDefaults] registerDefaults:[NSDictionary dictionaryWithObject:[NSNumber numberWithBool:YES] forKey:@"WebKitDeveloperExtras"]]`吗？

# python - 帮助解决 Python 循环的怪异问题？

> ID：695040
> 
> 赞同：1
> 
> 时间：2009-03-29T17:54:24.847
> 
> 标签：python, csv, loops

我正在学习 Python 作为我的第二种编程语言（如果你不计算 HTML/CSS/Javascript，我的第一个真正的语言）。我正在尝试构建一些有用的东西作为我的第一个真正的应用程序——一个 IRC 机器人，当频道中发生某些事情时，它会通过 SMS 提醒人们。根据某人的请求，我正在（尝试）建立日程安排偏好，人们可以选择在一天中的 X 和 Y 小时之间不接收警报。

无论如何，这是我遇到问题的代码：

```
db = open("db.csv")
for line in db:
            row = line.split(",")  # storing stuff in a CSV, reading out of it 
            recipient = row[0]     # who the SMS is going to
            s = row[1]             # gets the first hour of the "no alert" time range
            f = row[2]             # gets last hour of above
            nrt = []               # empty array that will store hours
            curtime = time.strftime("%H")  # current hour
            if s == "no":          
                    print "They always want alerts, sending email"  # start time will = "no" if they always want alerts
                    # send mail code goes here
            else:
                    for hour in range(int(s), int(f)): #takes start, end hours, loops through to get hours in between, stores them in the above list 
                            nrt.append(hour)
                    if curtime in nrt: # best way I could find of doing this, probably a better way, like I said I'm new
                            print "They don't want an alert during the current hour, not sending"  # <== what it says
                    else:
                            # they do want an alert during the current hour, send an email
                            # send mail code here 
```

我遇到的唯一问题是脚本最终只循环通过其中一行（或类似的东西），因为我每次只得到一个结果，即使我在 CSV 文件中有多个条目。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-03-29T19:00:33.173

如果这是一个常规的 CSV 文件，您不应该尝试自己解析它。使用标准库[csv 模块](http://docs.python.org/library/csv.html)。

这是文档中的一个简短示例：

```
import csv
reader = csv.reader(open("some.csv", "rb"))
for row in reader:
    print row 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-03-29T19:02:11.470

您的程序中至少有两个错误：

```
curtime = time.strftime("%H")
...
for hour in range(int(s), int(f)):
    nrt.append(hour)
# this is an inefficient synonym for
# nrt = range(int(s), int(f))

if curtime in nrt:
    ... 
```

首先，curtime 是一个字符串，而 nrt 是一个整数列表。Python 是强类型的，因此两者不可互换，并且不会比较相等：

```
'4' == 4 # False
'4' in [3, 4, 5] # False 
```

修改后的代码解决了这个问题，并且比生成列表并在其中搜索当前时间更有效：

```
cur_hour = time.localtime().tm_hour
if int(s) <= cur_hour < int(f):
    # You can "chain" comparison operators in Python
    # so that a op1 b op2 c is equivalent to a op1 b and b op2c
    ... 
```

上面没有解决的第二个问题是，如果时间在午夜左右（例如 s = 22 和 f = 8），您的程序将无法正常运行。

这些问题都不一定与“脚本最终循环通过其中一行”有关，但是您没有给我们足够的信息来弄清楚为什么会这样。一个更有用的提问方式是发布一个**简短**但**完整**的代码片段，显示您正在观察的行为，以及示例输入和生成的错误消息（如果有）（以及回溯）。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-03-29T18:44:43.680

您是否尝试过更简单的方法？只是为了看看你的文件是如何被 Python 实际读取的：

```
db = open("db.csv")  
for line in db:  
    print line 
```

csv 文件的格式可能存在问题。例如，当您在 Windows 环境中打开 Unix 文件时，就会发生这种情况。在这种情况下，整个文件看起来像单个字符串，因为 Windows 和 Unix 具有不同的行分隔符。所以，我不知道你的问题的某些原因，但提议朝那个方向思考。

**更新：** 您有多种方式通过循环体：

1.  when `s`is `"no"`:`"They always want alerts, sending email"`将被打印。
2.  何时`s`不是`"no"`并且`curtime in nrt`:`"They don't want an alert during the current hour, not sending"`将被打印。
3.  when `s`is not `"no"`and `curtime in nrt`is false (the last `else`):**什么**都不会被打印，也不会采取其他行动。

您不应该在最后一个分支中放置一些`print`语句吗？`else`

另外，您的代码段的确切输出是什么？是`"They always want alerts, sending email"`吗？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-29T18:19:52.537

我会检查你的条件中的逻辑。您的循环构造应该可以工作。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-29T18:37:01.997

明确说明连续的内容。使用 0, 1, 2...n 实际上是您的错误，它使您或其他人将来很难阅读代码。因此，让我们使用方便的元组来显示我们对一行的期望。这种工作就像代码作为文档

```
db = open("db.csv")
for line in db.readlines():
    recipient, start_hour, end_hour = line.split(",")
    nrt = []
    etc... 
```

这向您的代码的读者展示了您期望一行包含的内容，并且它会在您第一次运行它时向您显示您的错误:)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-29T22:40:40.023

您可以使用 Python[下载现有的编写良好的 IRC 机器人](http://susam.in/downloads/pibby/pibby-0.0.3-alpha.tar.gz)

# math - 如何将世界坐标转换为相机坐标？

> ID：695043
> 
> 赞同：18
> 
> 时间：2009-03-29T17:55:54.733
> 
> 标签：math, opengl, 3d

我有一个输入 3D 矢量，以及相机的俯仰和偏航。任何人都可以描述或提供一个资源链接来帮助我理解和实现所需的转换和矩阵映射吗？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2009-03-29T18:10:30.797

世界到相机变换矩阵是相机到世界矩阵的逆矩阵。相机到世界矩阵是相机位置的平移和相机方向的旋转的组合。因此，如果*M*是对应于相机方向的 3x3 旋转矩阵，并且*t*是相机的位置，那么 4x4 相机到世界矩阵是：

```
米00米01米02吨x
米10米11米12吨
米20米21米22吨z _ [[[0 0 0 1]]] 
```

请注意，我假设向量是列向量，它们在右侧相乘以执行转换。如果您使用相反的约定，请确保转置矩阵。

要查找*M ，您可以使用*[Wikipedia](http://en.wikipedia.org/wiki/Euler_angles#Table_of_matrices)上列出的公式之一，具体取决于您对滚动、俯仰和偏航的特定约定。请记住，这些公式使用向量是在左侧相乘的行向量的约定。

代替计算相机到世界矩阵并将其反转，一种更有效（且数值稳定）的替代方法是直接计算世界到相机矩阵。为此，只需反转相机的位置（通过否定所有 3 个坐标）及其方向（通过否定滚动、俯仰和偏航角度，并将它们调整到适当的范围内），然后使用相同的计算矩阵算法。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-03-31T04:34:22.053

如果我们有这样的结构来描述一个 4x4 矩阵：

```
class Matrix4x4
{
public:
    union
    {
        struct
        {
            Type Xx, Xy, Xz, Xw;
            Type Yx, Yy, Yz, Yw;
            Type Zx, Zy, Zz, Zw;
            Type Wx, Wy, Wz, Ww;
        };

        struct
        {
            Vector3<Type> Right;
            Type XW;
            Vector3<Type> Up;
            Type YW;
            Vector3<Type> Look;
            Type ZW;
            Vector3<Type> Pos;
            Type WW;
        };

        Type asDoubleArray[4][4];
        Type asArray[16];
    };
}; 
```

如果您只有欧拉角，即表示偏航、俯仰和滚动的角度以及位置的 3d 空间中的一个点，您可以计算右、上和看向量。请注意，Right、Up 和 Look 只是 X、Y、Z 向量，但由于这是一台相机，我发现这样命名更容易。将旋转应用于相机矩阵的最简单方法是构建一系列旋转矩阵并将我们的相机矩阵乘以每个旋转矩阵。

一个很好的参考在这里：[http ://www.euclideanspace.com](http://www.euclideanspace.com/maths/algebra/matrix/orthogonal/rotation/index.htm)

一旦应用了所有需要的旋转，就可以将向量 Pos 设置为相机在世界空间中的位置。

最后，在你应用相机的变换之前，你需要取相机的逆矩阵。在开始绘制多边形之前，这就是您将模型视图矩阵乘以的内容。对于上面的矩阵类，逆计算如下：

```
template <typename Type>
Matrix4x4<Type> Matrix4x4<Type>::OrthoNormalInverse(void)
{
    Matrix4x4<Type> OrthInv;
    OrthInv = Transpose();
    OrthInv.Xw = 0;
    OrthInv.Yw = 0;
    OrthInv.Zw = 0;
    OrthInv.Wx = -(Right*Pos);
    OrthInv.Wy = -(Up*Pos);
    OrthInv.Wz = -(Look*Pos);
    return OrthInv;
} 
```

所以最后，我们所有的矩阵构造都​​没有影响，你会做这样的事情：

```
Matrix4x4<float> cameraMatrix, rollRotation, pitchRotation, yawRotation;
Vector4<float> cameraPosition;

cameraMatrix = cameraMatrix * rollRotation * pitchRotation * yawRotation;

Matrix4x4<float> invCameraMat;

invCameraMat = cameraMatrix.OrthoNormalInverse();

glMultMatrixf(invCameraMat.asArray); 
```

希望这可以帮助。

* * *

## 回答 #3

> 赞同：-15
> 
> 时间：2009-03-29T18:12:16.893

您所描述的内容称为“透视投影”，网络上有大量资源可以解释矩阵数学并提供执行此操作所需的代码。你可以从[维基百科页面开始](http://en.wikipedia.org/wiki/3D_projection#Perspective_projection)

# javascript - 使用变量作为名称向 JavaScript 对象添加属性？

> ID：695050
> 
> 赞同：314
> 
> 时间：2009-03-29T18:00:58.403
> 
> 标签：javascript, jquery, object, syntax

我正在使用 jQuery 从 DOM 中提取项目，并希望使用`id`DOM 元素在对象上设置属性。

### 例子

```
const obj = {}

jQuery(itemsFromDom).each(function() {
  const element = jQuery(this)
  const name = element.attr('id')
  const value = element.attr('value')

  // Here is the problem
  obj.name = value
}) 
```

如果`itemsFromDom`包含一个带有`id`“myId”的元素，我想要`obj`一个名为“myId”的属性。以上给了我`name`。

如何使用 JavaScript 使用变量命名对象的属性？

* * *

## 回答 #1

> 赞同：520
> 
> 时间：2009-03-29T18:02:24.437

您可以使用此等效语法：

```
obj[name] = value 
```

**示例**：

```
let obj = {};
obj["the_key"] = "the_value"; 
```

或者带有 ES6 特性：

```
let key = "the_key";
let obj = {
  [key]: "the_value",
}; 
```

在这两个示例中，`console.log(obj)`将返回：`{ the_key: 'the_value' }`

* * *

## 回答 #2

> 赞同：148
> 
> 时间：2015-06-24T11:02:46.133

使用[ECMAScript 2015](https://kangax.github.io/compat-table/es6/)，您可以使用括号符号直接在对象声明中执行此操作：

```
var obj = {
  [key]: value
} 
```

哪里`key`可以是返回值的任何类型的表达式（例如变量）：

```
var obj = {
  ['hello']: 'World',
  [x + 2]: 42,
  [someObject.getId()]: someVar
} 
```

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2014-02-14T06:55:55.157

你甚至可以制作这样的对象列表

```
var feeTypeList = [];
$('#feeTypeTable > tbody > tr').each(function (i, el) {
    var feeType = {};

    var $ID = $(this).find("input[id^=txtFeeType]").attr('id');

    feeType["feeTypeID"] = $('#ddlTerm').val();
    feeType["feeTypeName"] = $('#ddlProgram').val();
    feeType["feeTypeDescription"] = $('#ddlBatch').val();

    feeTypeList.push(feeType);
}); 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2018-05-10T07:07:05.557

有两种不同的符号来访问对象属性

*   **点**表示法：*myObj.prop1*
*   **括号**表示法：*myObj["prop1"]*

点表示法既快速又简单，但您*必须*明确使用实际的属性名称。没有替换，变量等。

括号符号是开放式的。它使用字符串，但您可以使用任何合法的 js 代码生成字符串。您可以将字符串指定为文字（尽管在这种情况下点符号会更容易阅读）或使用变量或以某种方式计算。

因此，这些都将名为*prop1的**myObj*属性设置为值*Hello*：

 **```
// quick easy-on-the-eye dot notation
myObj.prop1 = "Hello";

// brackets+literal
myObj["prop1"] = "Hello";

// using a variable
var x = "prop1"; 
myObj[x] = "Hello";                     

// calculate the accessor string in some weird way
var numList = [0,1,2];
myObj[ "prop" + numList[1] ] = "Hello"; 
```

陷阱：

```
myObj.[xxxx] = "Hello";      // wrong: mixed notations, syntax fail
myObj[prop1] = "Hello";      // wrong: this expects a variable called prop1 
```

**tl;dnr**：如果要计算或引用密钥，则*必须*使用*括号表示法*。如果您明确使用密钥，则使用*点符号表示*简单清晰的代码。

注意：还有一些其他好的和正确的答案，但我个人发现它们有点简短，因为对 JS on-the-fly 怪癖不熟悉。这可能对某些人有用。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2016-12-15T12:24:53.130

使用 lodash，您可以创建像这样的新对象[_.set](https://lodash.com/docs/#set)：

```
obj = _.set({}, key, val); 
```

或者您可以像这样设置为现有对象：

```
var existingObj = { a: 1 };
_.set(existingObj, 'a', 5); // existingObj will be: { a: 5 } 
```

如果你想在你的路径中使用点（“.”），你应该小心，因为 lodash 可以设置层次结构，例如：

```
_.set({}, "a.b.c", "d"); // { "a": { "b": { "c": "d" } } } 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2017-10-25T09:04:47.137

首先我们需要将 key 定义为变量，然后我们需要将 key 赋值为 object。例如

```
var data = {key:'dynamic_key',value:'dynamic_value'}
var key = data.key;
var obj = { [key]: data.value}
console.log(obj)
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2020-02-07T17:49:07.923

与主题相关，但并非专门针对 jquery。我在 ec6 react 项目中使用了它，也许可以帮助某人：

```
this.setState({ [`${name}`]: value}, () => {
      console.log("State updated: ", JSON.stringify(this.state[name]));
    }); 
```

PS：请注意引号字符。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2017-03-05T16:59:34.003

随着 ES2015 [Object.assign](http://devdocs.io/javascript/global_objects/object/assign)和[计算属性名称](http://devdocs.io/javascript/operators/object_initializer)的出现，OP 的代码归结为：

```
var obj = Object.assign.apply({}, $(itemsFromDom).map((i, el) => ({[el.id]: el.value}))); 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2017-08-10T06:35:19.583

如果要动态向对象添加字段，最简单的方法如下：

```
let params = [
  { key: "k1", value: 1 },
  { key: "k2", value: 2 },
  { key: "k3", value: 3 },
];
let data = {};

for (let i = 0; i < params.length; i++) {
  data[params[i].key] = params[i].value;
}

console.log(data); // -> { k1: 1, k2: 2, k3: 3 } 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2020-01-29T05:24:32.760

ajavascript 有两种类型的注释用于获取 javascript 对象属性：

对象 = {};

1) (.) 注释例如。Obj.id 这仅在对象已经具有名称为“id”的属性时才有效

2）（[]）注释例如。此处的 Obj[id] 如果对象没有任何名为“id”的属性，它将创建一个名为“id”的新属性。

所以对于下面的例子：

当您编写 Obj[name] 时，总是会创建一个新属性。如果该属性已经存在同名，它将覆盖它。

```
const obj = {}
    jQuery(itemsFromDom).each(function() {
      const element = jQuery(this)
      const name = element.attr('id')
      const value = element.attr('value')
      // This will work
      obj[name]= value;
    }) 
```

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2021-11-05T13:43:01.853

访问对象值的 3 种方式我们可以通过传入适当的键来输出对象值。因为我在示例中使用了表情符号作为键，所以有点棘手。所以让我们看一个更简单的例子。

```
let me = {
  name: 'samantha',
};

// 1\. Dot notation
me.name; // samantha

// 2\. Bracket notation (string key)
me['name']; // samantha

// 3\. Bracket notation (variable key)
let key = 'name';
me[key]; // samantha 
```

[了解更多](https://www.samanthaming.com/tidbits/37-dynamic-property-name-with-es6/)

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2019-08-15T16:22:05.807

如果您有对象，则可以创建键数组，而不是映射，并从以前的对象键和值创建新对象。

```
Object.keys(myObject)
.map(el =>{
 const obj = {};
 obj[el]=myObject[el].code;
 console.log(obj);
}); 
```

* * *

## 回答 #13

> 赞同：-2
> 
> 时间：2017-05-29T07:28:26.323

`objectname.newProperty = value;`

* * *

## 回答 #14

> 赞同：-3
> 
> 时间：2018-11-28T17:04:42.987

```
const data = [{
    name: 'BMW',
    value: '25641'
  }, {
    name: 'Apple',
    value: '45876'
  },
  {
    name: 'Benz',
    value: '65784'
  },
  {
    name: 'Toyota',
    value: '254'
  }
]

const obj = {
  carsList: [{
    name: 'Ford',
    value: '47563'
  }, {
    name: 'Toyota',
    value: '254'
  }],
  pastriesList: [],
  fruitsList: [{
    name: 'Apple',
    value: '45876'
  }, {
    name: 'Pineapple',
    value: '84523'
  }]
}

let keys = Object.keys(obj);

result = {};

for(key of keys){
    let a =  [...data,...obj[key]];
    result[key] = a;

} 
```

# c# - 什么是“静态”类？

> ID：695056
> 
> 赞同：43
> 
> 时间：2009-03-29T18:05:02.917
> 
> 标签：c#, static-classes

在 C# 中有什么区别：

```
public static class ClassName {} 
```

和：

```
public class ClassName {} 
```

* * *

## 回答 #1

> 赞同：70
> 
> 时间：2009-03-29T18:22:18.583

Firstly, a comment on an answer asked about what "static" means. In C# terms, "static" means "relating to the type itself, rather than an instance of the type." You access a static member (from another type) using the type name instead of a reference or a value. For example:

```
// Static method, so called using type name
Guid someGuid = Guid.NewGuid();
// Instance method, called on a value
string asString = someGuid.ToString(); 
```

Now, static classes...

Static classes are usually used as "utility" classes. The canonical example is probably [`System.Math`](http://msdn.microsoft.com/en-us/library/system.math.aspx). It doesn't make sense to create an instance of math - it just "is". A few rules (both "can" and "can't"):

*   Static classes always derive from `object`. You can't specify a different base type, or make the static class implement an interface.
*   Static classes can't have any instance members - all variables, methods etc must be static.
*   Static classes can't declare any instance constructors and the compiler *doesn't* create a parameterless constructor by default. (Before static classes came in C# 2.0, people would often create an abstract class with a private constructor, which prevented instantiation. No need here.)
*   Static classes are implicitly abstract (i.e. they're compiled to IL which describes an abstract class) but you can't add the `abstract` modifier yourself.
*   Static classes are implicitly sealed (i.e. they're compiled to IL which describes an sealed class) but you can't add the `sealed` modifier yourself.
*   Static classes *may* be generic.
*   Static classes *may* be nested, in either non-static or static classes.
*   Static classes *may* have nested types, either non-static or static.
*   Only static, top-level non-generic classes can contain extension methods (C# 3.0).

* * *

## 回答 #2

> 赞同：44
> 
> 时间：2009-03-29T18:09:40.033

静态类不能被实例化，并且只能包含静态成员。因此，对静态类的调用如下：`MyStaticClass.MyMethod(...)`或`MyStaticClass.MyConstant`。

非静态类可以被实例化并且可以包含非静态成员（实例构造函数、析构函数、索引器）。非静态类的非静态成员只能通过对象调用：

```
MyNonStaticClass x = new MyNonStaticClass(...);
x.MyNonStaticMethod(...); 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-03-29T18:33:29.323

```
public static class ClassName {} 
```

A static class is just like a global variable: you can use it anywhere in your code without instantiating them. For example: **ClassName. After the dot operator, you can use any property or function of it.**

```
 public class ClassName {} 
```

But if you have non-static class then you need to create an instance of this class. For example:

```
 ClassName classNameObject = new ClassName(); 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-03-29T18:08:42.690

静态类也不能被继承，而具有静态成员的非静态类可以被继承。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-03-29T18:07:25.780

静态类中的所有方法/属性都**必须**是静态的，而“普通”类可以包含实例和静态方法的混合。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-03-29T18:07:06.203

静态类只能包含静态成员。

可以在不先实例化类的情况下使用静态成员。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-03-29T18:08:05.407

您不能实例化（创建对象）静态类。它只能包含静态成员。

示例：System.Math

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-03-29T18:12:42.227

静态类和成员用于创建无需创建类的实例（使用`new`关键字，它们不能有构造函数）即可访问的数据和方法。

静态类可以在不依赖其自身的对象标识时声明，因此静态类必须只包含静态成员。

当加载包含该类的程序或命名空间时，CLR 会加载此类。

它们也是密封的，不能继承。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2010-08-19T11:33:05.353

[http://www.javaworld.com/javaworld/javaqa/1999-08/01-qa-static2.html](http://www.javaworld.com/javaworld/javaqa/1999-08/01-qa-static2.html) - very good article on this. This is for Java. But i think concept should should same in C# too.

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2013-10-06T17:41:47.260

**Static variable in c**

a variable local to a class as auto variables but static variable do not disappear as function is no longer active.Their values persist.If control comes back,static variables have same value

**static function in c** functions that are not visible to functions in other files.

**static data members in cpp ** data members can be variables or functions in cpp static applies to both data members the class itself can be static "There is only one copy of static data memberss shared by all objects in that class" static data members can access only static data members

**static class** this class cannot instantiate objects

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2022-02-17T03:58:28.793

Most importantly, "*A static constructor is only called one time, and a static class remains in memory for the lifetime of the application domain in which your program resides.*" - From [Microsoft](https://docs.microsoft.com/en-us/dotnet/csharp/programming-guide/classes-and-structs/static-classes-and-static-class-members#:%7E:text=A%20static%20class%20is%20basically,variable%20of%20the%20class%20type.)

# windows - 如何挂钩 Windows 中的 TCP 堆栈以嗅探和修改数据包？

> ID：695057
> 
> 赞同：12
> 
> 时间：2009-03-29T18:05:07.550
> 
> 标签：windows, sockets, packet-capture, winpcap, sniffer

我想为 Windows 编写一个数据包嗅探器和编辑器。我希望能够看到所有进出我的系统的数据包的内容，并可能修改它们。任何语言都可以，但我希望它运行得足够快，不会给系统带来负担。

我已经阅读了一些有关 WinPcap 的信息，但文档声称您不能使用 WinPcap 创建防火墙，因为它不能丢弃数据包。什么工具可以帮助我编写这个软件？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-03-29T21:42:32.723

去过那里，做到了 :-) 早在 2000 年，我的第一个 Windows 程序就是一个[过滤器挂钩驱动程序](http://msdn.microsoft.com/en-us/library/aa504969.aspx)。

我所做的是实现过​​滤器挂钩驱动程序并编写一个用户空间应用程序，该应用程序准备了一个过滤器表，说明允许什么和禁止什么。当您绕过最初的一组蓝屏时（请参阅下面的内核模式调试技巧），过滤模式驱动程序非常易于使用......它将每个数据包提供给您编写的函数，并根据返回代码丢弃它或者让它过去。

不幸的是，那个级别的数据包是相当原始的，片段没有重新组装，它看起来更像是“网卡”端的东西（但不再有以太网头）。因此，您将很难用该解决方案解码数据包以进行过滤。

还有防火墙挂钩驱动程序，如本[codeproject 文章](http://www.codeproject.com/KB/IP/FwHookDrv.aspx)中所述。

如果您在 Vista 或 Server 2008 上，您最好看看 WFP（[Windows 过滤平台](http://www.microsoft.com/whdc/device/network/wfp.mspx)），这似乎是编写防火墙的当天授权 API。除了谷歌几分钟前我搜索过滤器挂钩驱动程序时，我不知道它。

更新：忘记调试提示：

Sysinternals DbgView 显示内核模式 DbgPrint 输出，更重要的是 - 它还可以从您上次产生的蓝屏转储文件中读取它们。所以用 dbgprint 撒上你的代码，如果它蓝屏，只需将转储加载到 dbgview 中，看看它死前发生了什么......非常有用。使用它，我在没有内核调试器的情况下进行了管理。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-29T18:15:49.317

我很确定您需要编写过滤器驱动程序。 [http://en.wikipedia.org/wiki/Filter_driver](http://en.wikipedia.org/wiki/Filter_driver) 我不知道更多:)。它肯定是一个 C/C++ Win32 应用程序，您可能正在做一些内核方面的工作。首先下载 DDK 并找到一些示例过滤器驱动程序。

如果您只想监视进出 IIS 的内容，请考虑使用 ISAPI 过滤器。在 Win32 中仍然是 C/C++，但比编写设备驱动程序相对容易。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-29T18:18:11.560

执行此操作的 C# 代码在[这里](http://www.codeproject.com/KB/IP/CSNetworkSniffer.aspx)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-29T18:48:48.163

我实际上是在几年前这样做的。在这一点上我对细节很模糊，但我必须使用 Windows DDK 开发一个过滤器/直通/中间驱动程序。我从 pcausa 那里得到了很多很好的信息。这是一个指向他们的产品的网址：[http ://www.pcausa.com/pcasim/Default.htm](http://www.pcausa.com/pcasim/Default.htm)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-29T19:10:40.497

如果您这样做是出于实际原因，而不仅仅是为了好玩，那么您应该看看[Microsoft Network Monitor](https://connect.microsoft.com/site/sitehome.aspx?SiteID=216)。主页讨论的是 3.3 beta 版，但您可以从下载页面下载 3.2 版。还有一个用于 NM 的 SDK，以及为您自己的网络协议编写解析器的能力。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-29T21:50:12.000

你需要问一个你不知道你需要问的问题；您想知道套接字属于哪些应用程序吗？还是您很高兴被限制在 IP:port quad 进行连接？

如果您想了解应用程序，您需要编写一个 TDI 过滤器驱动程序，但这使得处理接收几乎不可能，因为您不能阻塞接收路径。

如果您对 IP:port 感到满意，请进入 NDIS 级别，我相信您可以阻止接收到您心中的内容。

一句警告；如果您之前没有内核经验，那么编写这些驱动程序中的任何一个（尽管 TDI 要困难得多）都需要大约两年的时间。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-30T10:37:01.813

这个：

TdiFw 是一个简单的基于 TDI 的开源个人防火墙，适用于 Windows NT4/2000/XP/2003

[http://tdifw.sourceforge.net/](http://tdifw.sourceforge.net/)

可以帮助你

# coordinates - 通过距离和方位从已知位置查找点坐标的地理算法

> ID：695065
> 
> 赞同：3
> 
> 时间：2009-03-29T18:10:52.137
> 
> 标签：coordinates, distance, bearing

我想使用谷歌地图静态 API 来显示带有指示边界的路径覆盖的地图。

AFAICT 静态 API 不支持多边形，所以我打算通过使用路径绘制边界来规避这个问题。

为此，我需要确定在它们之间绘制直线（路径）的点；所以我想要一种算法，它返回给定方位角和距已知点的距离的地理位置（即 WGS84 坐标）。

谁能指出我这样的算法。最好在 C# 中，但其他语言是否可以接受？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-19T18:49:51.613

我在 C# 中实现并测试了它，使用度数作为输入/输出而不是弧度：

```
 static readonly double FullCircleDegrees = 360d;
    static readonly double HalfCircleDegrees = FullCircleDegrees / 2d;
    static readonly double DegreesToRadians = Math.PI / HalfCircleDegrees;
    static readonly double RadiansToDegrees = 1 / DegreesToRadians;

    public LatLng GetPointGivenRadialAndDistance(LatLng center, double radius, double azimuth)
    {
        var lat1 = center.Lat * DegreesToRadians;
        var lng1 = center.Lng * DegreesToRadians;
        var lat = Math.Asin( (Math.Sin(lat1) * Math.Cos(radius)) + Math.Cos(lat1) * Math.Sin(radius) * Math.Cos(azimuth * DegreesToRadians));
        var lng = 0d;
        if (Math.Cos(lat) == 0)
        {
            lng = lng1;
        }
        else
        {
            lng = ((lng1 + Math.PI - Math.Asin(Math.Sin(azimuth * DegreesToRadians) * Math.Sin(radius) / Math.Cos(lat1))) % (2 * Math.PI)) - Math.PI;
        }
        return new LatLng(lat * RadiansToDegrees, lng * RadiansToDegrees);
    } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-29T18:27:02.303

您可以在 KML 文件上绘制多边形，然后在 Google 地图上显示 KML。

[这是 Google 地图上的 KML](http://maps.google.com/maps?f=q&hl=en&q=http%3A%2F%2Fkmlscribe.googlepages.com%2FSamplesInMaps.kml&ie=UTF8&ll=36.879621,-53.4375&spn=103.772916,208.476563&z=2&om=1)（来自 Google KML 示例），请查看内容中的*“Google Campus - Polygons”*部分。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-29T18:28:21.113

在（我认为）我知道的每一种语言中，弧度。请注意，我认为您的示例代码是基于球体而不是 WGS84 为您提供坐标。这是[用于在坐标系统之间进行转换的 Java 代码](http://www.i3s.unice.fr/~johan/gps/)。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-19T20:31:47.000

看看[Gavaghan Geodesy](http://www.gavaghan.org/blog/free-source-code/geodesy-library-vincentys-formula/) C# library，它应该是你要找的。它是免费的。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-31T16:39:01.250

找到这个（这里：[http](http://williams.best.vwh.net/avform.htm#LL) ://williams.best.vwh.net/avform.htm#LL ）：

**如果：**

```
lat=asin(sin(lat1)*cos(d)+cos(lat1)*sin(d)*cos(tc))
IF (cos(lat)=0)
    lon=lon1      // endpoint a pole
ELSE
    lon=mod(lon1-asin(sin(tc)*sin(d)/cos(lat))+pi,2*pi)-pi
ENDIF 
```

径向线是弧度还是度数？

**编辑：**

弧度 = 度 * PI / 180

# math - 如何旋转图像？

> ID：695080
> 
> 赞同：13
> 
> 时间：2009-03-29T18:21:55.997
> 
> 标签：math, image-processing

> 另请参阅：[为什么我的图像旋转算法不起作用？](https://stackoverflow.com/questions/697520/why-is-my-image-rotation-algorithm-not-working)

这个问题不是特定于语言的，而是一个数学问题。然而，我将使用一些 C++ 代码来解释我需要什么，因为我对数学不太感兴趣。

以下是图像的组成方式：

```
ImageMatrix image;
image[0][0][0] = 1;
image[0][1][0] = 2;
image[0][2][0] = 1;
image[1][0][0] = 0;
image[1][1][0] = 0;
image[1][2][0] = 0;
image[2][0][0] = -1;
image[2][1][0] = -2;
image[2][2][0] = -1; 
```

这是我要创建的函数的原型：

```
ImageMatrix rotateImage(ImageMatrix image, double angle); 
```

我只想旋转前两个索引（行和列），而不是通道。

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2009-03-29T18:48:11.643

解决这个问题的常用方法是倒着做。不是计算输入图像中的每个像素最终在输出图像中的位置，而是计算输出图像中的每个像素在输入图像中的位置（通过**在另一个方向上**旋转相同的量。这样你可以确定输出图像中的所有像素都有一个值。

```
output = new Image(input.size())

for each pixel in input:
{
  p2 = rotate(pixel, -angle);
  value = interpolate(input, p2)
  output(pixel) = value
} 
```

有不同的方法来做插值。对于旋转公式，我认为您应该检查[https://en.wikipedia.org/wiki/Rotation_matrix#In_two_dimensions](https://en.wikipedia.org/wiki/Rotation_matrix#In_two_dimensions)

但为了好看，这里是（点（x，y）角度/弧度的旋转）：

```
 newX = cos(angle)*x - sin(angle)*y
 newY = sin(angle)*x + cos(angle)*y 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-08T08:35:34.943

要旋转图像，您需要创建 3 个点：

```
A----B 
|
|
C 
```

并围绕A旋转。要获得新的旋转图像，请执行以下操作：

*   在 2D 中围绕 A 旋转 ABC，所以这是一个单欧拉旋转
*   以旋转状态从 A 遍历到 B。对于每个像素，您还要在原始图像的水平线上从左到右遍历。因此，如果图像是宽度为 100、高度为 50 的图像，您将在 100 步中从 A 遍历到 B，从 A 到 C 以 50 步遍历，在 ABC 旋转状态下形成的区域中绘制 50 条 100 像素的线.

这听起来可能很复杂，但事实并非如此。请看我前段时间写的这段 C# 代码： [rotoZoomer by me](http://weblogs.asp.net/fbouma/archive/2005/12/25/433976.aspx)

绘制时，我稍微改变了源指针以获得类似橡胶的效果，但如果禁用它，您会看到代码旋转图像没有问题。当然，在某些角度上，您会得到看起来略微失真的图像。源代码包含正在发生的事情的注释，因此您应该能够轻松掌握其背后的数学/逻辑。

如果你更喜欢 Java，我也做过一次 Java 版本，大约 14 年前 ;) -> [http://www.xs4all.nl/~perseus/zoom/zoom.java](http://www.xs4all.nl/~perseus/zoom/zoom.java)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-05T18:11:26.643

请注意，除了旋转矩阵之外，还有另一种解决方案，它不会通过混叠丢失图像信息。您可以将 2D 图像旋转分离为[倾斜和缩放](http://www.cs.dartmouth.edu/reports/TR96-301.pdf)，从而保持图像质量。

[这是一个更简单的解释](http://www.codeproject.com/KB/graphics/rotatebyshear.aspx)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-08T06:40:26.950

您提供的示例似乎是一些边缘检测内核。因此，如果您想要检测不同角度的边缘，您最好选择一些连续函数（在您的情况下可能是 x1 乘以 x2 的参数化高斯函数），然后根据 kigurai 提供的公式旋转它。因此，您将能够更有效地生成磁盘内核并且没有别名。

# xslt - 如何使用 XSLT 变量的值？

> ID：695082
> 
> 赞同：2
> 
> 时间：2009-03-29T18:22:24.840
> 
> 标签：xslt

我正在尝试学习 XSLT。我简直要疯了。变量应该在 xsl:variables 实体中声明，并用它们的名字实例化，在它们之前有 $ 符号（如 perl 变量），对吗？为什么这个代码：

```
<xsl:stylesheet version="1.0"  
 xmlns:xsl="http://www.w3.org/1999/XSL/Transform">

    <xsl:template match="/">
        <xsl:variable name="color" select="'red'" />
        <p>$color</p>
    </xsl:template>
</xsl:stylesheet> 
```

导致文字字符串：“$color”被写入使用 msxsl 解析器解析一个简单的非空 xml 文档？非常感谢

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-03-29T18:25:21.837

使用`<xsl:value-of select="$color"/>`而不是`$color`直接写入文档。

另请参阅[此问题](https://stackoverflow.com/questions/634295/why-arent-my-xslt-variables-substituting-their-values)。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-03-29T18:27:31.177

此外，在属性中，您可以像这样直接获取值：

```
<span style="color:{$color}" /> 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-29T18:53:32.783

> 为什么这个代码：...
> 
> `<xsl:variable name="color" select="'red'" /> <p>$color</p>`
> 
> 导致文字字符串： "$color" 被写入

**因为这段代码的意思是：输出字符串 $color 作为`<p>`元素**的文本节点子节点。

要输出`$color`xsl:variable 的值，请使用以下之一：

*   **`<xsl:value-of select="$color"/>`**
*   **`<xsl:copy-of select="$color"/>`**

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-29T19:29:00.703

xslt 的一个很好的经验法则：如果它不在`<xsl:foo>`标签中，则它不是代码。是输出。

# math - 如何标准化图像？

> ID：695084
> 
> 赞同：9
> 
> 时间：2009-03-29T18:23:51.357
> 
> 标签：math, image-processing

如果我有一系列像素，范围从 -500 到 +1000，我将如何标准化同一渐变上的所有像素，以使它们落在特定范围之间，例如 0 和 255？

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2009-03-29T18:31:40.137

像这样的一些伪代码会将值从一个范围线性缩放到另一个范围

```
oldmin=-500
oldmax=1000
oldrange=oldmax-oldmin;

newmin=0
newmax=255;
newrange=newmax-newmin;

foreach(oldvalue)
{
    //where in the old scale is this value (0...1)
    scale=(oldvalue-oldmin)/oldrange;

    //place this scale in the new range
    newvalue=(newrange*scale)+newmin
} 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-03-29T18:34:30.427

你的问题不是很清楚，所以我假设你正在做某种图像处理，你得到的结果是 -500 到 1000 之间的值，现在你需要将颜色保存到每个值的文件中需要在 0 到 255 之间。

你如何做到这一点真的非常依赖于应用程序，结果的真正含义是什么以及你想要做什么。两个主要选项是：

*   钳制值 - 任何低于 0 的值都替换为 0，高于 255 的任何值都替换为 255。例如，如果您的图像处理是某种插值，实际上不应该达到这些值
*   线性归一化 - 可以线性地将您的最小值设为 0，将最大值设为 255。当然，您首先需要找到最小值和最大值。你做：

    ```
    v = (origv - min)/(max - min) * 255.0 
    ```

这样做是首先将值映射到`[0,1]`，然后将它们拉伸回`[0,255]`.

第三种选择是混合和匹配这两个选项。您的应用程序可能要求您将负值视为不需要的值并将它们钳制为 0 并将正值线性映射到`[0,255]`.

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-29T18:32:32.430

首先让一切都变得积极。如果最小值为 -500，则将 500 添加到所有值。那么最小值为 0，最大值为 1500。

那么它只是一个三规则，你有它：

```
[value in 0,255] = 255*(Pixel/1500) 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-29T18:28:38.633

一些伪代码可能会有所帮助：

```
foreach( pixel_value in pixel_values): # between -500 and 1000

    position = (pixel_value + 500) / 1500 # gives you a 0 to 1 decimal
    new_value = int(postion * 255) # or instead of casting, you could round it off 
```

顺便说一句，那是python代码。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-29T18:41:25.887

创建两个变量，`MinInputValue`和`MaxInputValue`。初始化`MinInputValue`为一个非常大的正数（高于您期望看到的最大像素值）和`MaxInputValue`一个非常大的负数（低于您期望看到的最低像素值）。

循环遍历图像中的每个像素。对于每个像素，如果像素值`PixelValue`低于`MinInputValue`，则设置`MinInputValue`为`PixelValue`。如果像素值高于`MaxInputValue`，则设置`MaxInputValue`为`PixelValue`。

创建一个新变量 ，`InputValueRange`并将其设置为`MaxInputValue - MinInputValue`。

完成此操作后，再次遍历图像中的每个像素。对于每个像素`PixelValue`，将输出像素值计算为`255.0 * (PixelValue - MinInputValue) / InputValueRange`。您可以将此新值分配回原来的`PixelValue`，也可以在相同大小的输出图像中设置相应的像素。

# google-maps - 是否可以限制谷歌地图只显示给定的国家？

> ID：695087
> 
> 赞同：3
> 
> 时间：2009-03-29T18:27:00.383
> 
> 标签：google-maps

是否可以限制谷歌地图只显示给定的国家？

例如，我只希望英国在一片巨大的蓝色海洋中可见。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-29T18:40:37.823

简短的回答是“不”（因为他们有地图的位图图像，并且需要重新渲染以排除欧洲大陆等） - 您可以使用[Open Street Map](http://www.OpenStreetMap.org/)数据构建自己的一组图块，以实现一样。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-29T18:47:44.390

它可以使用覆盖来完成，[这](http://maps.forum.nu/gm_texas.html)是我见过的最接近的例子。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-29T18:45:02.960

使用 Javascript 可以限制视口，但实际上无法摆脱其他国家/地区的图像。

# php - PHP游戏更新

> ID：695092
> 
> 赞同：2
> 
> 时间：2009-03-29T18:30:08.520
> 
> 标签：php, auto-update

假设我有一个 PHP 游戏，这是一个赚钱的游戏，每天市场上的物品价格都在变化。

我将如何使数据库中的价格每天自动更新？我是否会在服务器上安装一个程序来检测它何时已经过了 24 小时然后运行一个 PHP 文件来进行更新？或者 os 还有其他方式吗？

编辑：问题是伙计们，我实际上并不拥有我从托管公司租用的服务器，所以我真的无法访问命令行：s

谢谢，斯坦尼

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-29T18:34:32.003

假设您在 Unix 系统上，您应该设置一个每日 cronjob。为此，请运行“crontab -e”并输入如下内容：

```
9 21 * * * /path/to/your/script 
```

这将在每天 21:09 运行。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-29T18:55:11.470

如果您无法访问命令行，您可以向网站添加 1x1 图像，该图像调用 php 脚本来检查是否需要更新某些内容。

就像是

```
<img style="width: 1px; height: 1px; visibility: hidden" src="cron.php"> 
```

在 cron.php 中，您检查数据是否需要更新。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-03-29T19:24:32.147

由于您可能无法访问 cron 或者我要做的是检查每次有人加载页面时已经过去了多少时间。如果 24 小时过去了，那么调用你的更新函数。如果 48 小时过去了，请调用两次。如果没有人加载页面，那么更新函数是否被调用都没有关系，因为没有人在看；）

或者您可以在家中设置一台计算机，每 24 小时远程调用一次 update.php。您可以使用 cron 作业和 wget 来执行此操作，或者如果您使用的是 Windows，则可以使用任务调度程序。

我认为第一个选项效果最好。每次页面加载时调用您的更新函数，并且仅在 24 小时标记过去后更新。如果你写得正确，它是否在准确的 24 小时标记处更新并不重要。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-03-29T18:35:43.780

您想设置一个“cron 作业”，或者一个以您设置的特定时间间隔运行的 PHP 文件。

查看[这篇文章](http://www.thesitewizard.com/general/set-cron-job.shtml)了解更多信息。

关于 cron 作业的最佳部分是，您不仅限于存储过程中可用的一小部分功能。你可以使用任何你喜欢的逻辑！:)

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-03-29T19:41:45.400

使用 webcron :) [http://www.webcron.org/index.php?lang=en](http://www.webcron.org/index.php?lang=en)

或者这里有一个很好的列表： [http ://www.onlinecronservices.com/](http://www.onlinecronservices.com/)

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-03-29T18:36:06.570

如果您有一个更新价格的脚本并且您只想每天运行它，请使用[Cron](http://en.wikipedia.org/wiki/Cron) (linux) 或[at 命令](http://en.wikipedia.org/wiki/At_(Windows))(windows)。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-03-29T19:11:07.000

我认为您可以创建一个在每次访问页面时都被调用的函数，并验证是否发生了更新，检查数据库。

所以在一个快速的伪代码中：

```
function verify_often(){
  if (last_update_in_db() != today() ){
    update_db();
    run_periodic_function(); 
  }
  return 0;
} 
```

这种方法只需要经典的 PHP & MySQL 组合。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-03-29T19:25:40.803

你怎么能不能“访问命令行”？我想不出任何不允许 ssh 访问的主机。访问 cron 是另一回事，但他们也应该允许这样做。如果他们不这样做 - 找到一个新的主机！

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-04-11T12:22:10.213

忘记这一切。没有理由做这样的事情。

您所要做的就是在每次有人调用该网页时进行检查。您跟踪日期，当当前日期不再与您的变量匹配时，您就会启动获取新数据的东西。砰！当然，这不是很好的可扩展性，但对于小型游戏来说很好。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2010-08-28T22:29:27.447

我不知道如何回复亚历克斯的回答，但我想提一下他们所说的话。当他们说“每次有人加载页面时检查经过了多少时间”时，我觉得您不需要每次加载页面时都检查它。更好的方法是检查用户何时登录。如果在用户仍然登录的情况下超过 24 小时，那么对于所描述的场景而言，这将无关紧要。下次有人登录时，商品的价格会发生变化。

# java - 在 Java 中，什么命令行使计算机点击屏幕？

> ID：695096
> 
> 赞同：1
> 
> 时间：2009-03-29T18:31:48.780
> 
> 标签：java, automation

我正在制作一个自动点击器，但我找不到让计算机点击屏幕的命令行。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-03-29T18:35:01.113

[您可以使用 Java 的Robot](http://java.sun.com/j2se/1.4.2/docs/api/java/awt/Robot.html)类模拟鼠标移动和点击。

# sql-server - 我应该如何估计 SQL Server 2005 数据库的硬件要求？

> ID：695118
> 
> 赞同：6
> 
> 时间：2009-03-29T18:40:15.173
> 
> 标签：sql-server, performance, architecture, hardware, performance-estimation

我们被要求为尚未构建的 ASP.NET Web 应用程序指定生产数据库硬件。

我们需要确定的规格是：

*   数据库 CPU
*   数据库 I/O
*   数据库内存

以下是我目前正在查看的指标：

*   预计未来网站点击次数 - 基于当前 IIS 日志。
*   估计网站的最坏情况峰值负载。
*   平均每页估计的数据库查询数。
*   Web 场中将访问数据库的服务器数量。
*   缓存来自数据库的轮询流量（使用 SqlCacheDependency）。
*   估计的数据缓存未命中。
*   估计的每日数据库事务数。
*   可接受的最大页面呈现时间。

我们应该考虑的任何其他指标？

此外，一旦我们有了所有这些指标，它们如何转化为硬件要求？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-29T19:42:16.287

我最近一直在做的服务器规划是使用 HP 提供的一些免费工具，这些工具统称为“服务器大小调整器”。这些是很棒的工具，因为它们确定了要使用的最佳 RAID 类型，以及处理负载的正确磁盘轴数（在规划好的数据库服务器时非常重要）和内存处理器等。我提供了下面的链接我希望这有帮助。

[http://h71019.www7.hp.com/ActiveAnswers/cache/70729-0-0-225-121.html?jumpid=reg_R1002_USEN](http://h71019.www7.hp.com/ActiveAnswers/cache/70729-0-0-225-121.html?jumpid=reg_R1002_USEN)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-29T19:01:24.480

我缺少的是对所需/要求/定义的可靠性水平的衡量。

虽然您可能会指定一台大型喇叭机器来处理所有负载，但根据您的可靠性要求，您可能更愿意投资购买更小但多台的机器，以及更安全的磁盘子系统 (RAID 5)。

马克

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-29T19:38:26.453

在我看来，为尚未构建和设计的应用程序估算硬件与其说是科学问题，不如说是政治问题。当您完成项目时，当前的硬件能力及其价格、功能要求、预期的并发用户数、外部系统和所有其他因素都会发生变化，而这种变化超出了您的控制范围。然而，这个问题经常出现，因为您需要在提案中输入数字或向您的经理提供报告。如果它是一个提案，那么您想要完成的是提出一个可以支持所提议的软件系统的规范。唯一的诀窍是提出一个既不会增加您的竞争力成本又不会让您自己面临性能低下的风险的系统。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-09-27T07:34:49.477

如果您可以根据页面点击量来描述当前的工作负载，那么您可以：1）计算每个页面将执行的典型查询类型 2）使用上述 2 条信息，估计数据库上的工作负载服务器

您还需要确定您的性能要求——您希望网站的最大和平均响应时间是多少？

给定工作负载和性能要求，然后您可以计算容量。进行此估计的最佳方法是使用一些现有硬件，在该硬件上的数据库上运行模拟的数据库工作负载，然后根据第一步中的数据推断您的硬件要求。

# php - 将两个字符串加在一起的最佳方法是什么？

> ID：695124
> 
> 赞同：21
> 
> 时间：2009-03-29T18:44:24.180
> 
> 标签：php, performance, string

我在某处读到（我想到了关于codinghorror），将字符串添加在一起就像它们是数字一样是不好的做法，因为像数字一样，字符串不能更改。因此，将它们加在一起会创建一个新字符串。所以，我想知道，在关注性能时，将两个字符串加在一起的最佳方法是什么？

这四个哪个更好，或者还有其他更好的方法？

```
//Note that normally at least one of these two strings is variable
$str1 = 'Hello ';
$str2 = 'World!'; 
$output1 = $str1.$str2; //This is said to be bad

$str1 = 'Hello ';
$output2 = $str1.'World!'; //Also bad

$str1 = 'Hello';
$str2 = 'World!';
$output3 = sprintf('%s %s', $str1, $str2); //Good?
//This last one is probaply more common as:
//$output = sprintf('%s %s', 'Hello', 'World!');

$str1 = 'Hello ';
$str2 = '{a}World!';
$output4 = str_replace('{a}', $str1, $str2); 
```

这还重要吗？

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2009-03-29T19:00:37.993

带点的字符串连接绝对是三种方法中最快的一种。无论您喜欢与否，您总是会创建一个新字符串。最有可能最快的方法是：

```
$str1 = "Hello";
$str1 .= " World";
```

不要将它们放在双引号中，`$result = "$str1$str2";`因为这会为解析字符串中的符号产生额外的开销。

如果您打算将其仅用于带有 echo 的输出，则使用 echo 的功能，您可以将多个参数传递给它，因为这不会生成新字符串：

```
$str1 = "Hello";
$str2 = " World";
echo $str1, $str2;
```

有关 PHP 如何处理内插字符串和字符串连接的更多信息，[请查看 Sarah Goleman 的博客](http://blog.libssh2.org/index.php?/archives/28-How-long-is-a-piece-of-string.html)。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-03-29T18:49:48.363

在将两个或多个字符串连接在一起时，您总是会创建一个新字符串。这不一定是“坏的”，但它在某些情况下可能会对性能产生影响（例如紧密循环中的数千/数百万个串联）。我不是一个 PHP 人，所以我不能就连接字符串的不同方式的语义给你任何建议，但是对于单个字符串连接（或只是几个），只要让它可读即可。你不会看到他们中的少数人对性能造成影响。

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2013-01-01T10:34:49.883

这是快速而肮脏的测试代码，以了解性能瓶颈。

## 单连接：

```
$iterations = 1000000;
$table = 'FOO';
$time = microtime(true);
for ($i = 0; $i < $iterations; $i++) {
        $sql = sprintf('DELETE FROM `%s` WHERE `ID` = ?', $table);
}
echo 'single sprintf,',(microtime(true) - $time)."\n";

$time = microtime(true);
for ($i = 0; $i < $iterations; $i++) {
        $sql = 'DELETE FROM `' . $table . '` WHERE `ID` = ?';
}
echo 'single concat,',(microtime(true) - $time)."\n";

$time = microtime(true);
for ($i = 0; $i < $iterations; $i++) {
        $sql = "DELETE FROM `$table` WHERE `ID` = ?";
}
echo 'single "$str",',(microtime(true) - $time)."\n"; 
```

我得到这些结果：

```
single sprintf,0.66322994232178
single concat,0.18625092506409 <-- winner
single "$str",0.19963216781616 
```

## 许多连接（10）：

```
$iterations = 1000000;
$table = 'FOO';
$time = microtime(true);
for ($i = 0; $i < $iterations; $i++) {
        $sql = sprintf('DELETE FROM `%s`,`%s`,`%s`,`%s`,`%s`,`%s`,`%s`,`%s`,`%s`,`%s` WHERE `ID` = ?', $table, $table, $table, $table, $table, $table, $table, $table, $table, $table);
}
echo 'many sprintf,',(microtime(true) - $time)."\n";

$time = microtime(true);
for ($i = 0; $i < $iterations; $i++) {
        $sql = 'DELETE FROM `' . $table . '`,`' . $table . '`,`' . $table . '`,`' . $table . '`,`' . $table . '`,`' . $table . '`,`' . $table . '`,`' . $table . '`,`' . $table . '`,`' . $table . '` WHERE `ID` = ?';
}
echo 'many concat,',(microtime(true) - $time)."\n";

$time = microtime(true);
for ($i = 0; $i < $iterations; $i++) {
        $sql = "DELETE FROM `$table`,`$table`,`$table`,`$table`,`$table`,`$table`,`$table`,`$table`,`$table`,`$table` WHERE `ID` = ?";
}
echo 'many "$str",',(microtime(true) - $time)."\n"; 
```

结果：

```
many sprintf,2.0778489112854
many concats,1.535336971283
many "$str",1.0247709751129 <-- winner 
```

作为结论，很明显通过点 (.) char 的单个 concat 是最快的。对于某些情况，当您有很多 concats 时，最好的执行方法是通过`"injection: $inject"`语法使用直接字符串注入。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-03-29T19:25:35.063

除非它的文本量真的很大，否则它真的没关系。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-03-29T18:58:20.683

正如其他人所说，`$str1 . $str2`在大多数情况下都可以，除了（大）循环。
请注意，您忽略了一些解决方案：

```
$output = "$str1$str2"; 
```

对于大量字符串，您可以将它们放在一个数组中，并使用 implode() 从中取出一个字符串。

哦，“添加字符串”听起来很糟糕，或者至少是模棱两可的。在大多数语言中，我们更喜欢谈论字符串连接。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-03-29T19:37:04.507

除非在 looong 循环中使用，否则没关系。在通常情况下，即使您丢失了几个处理器周期，也要关注代码的可读性。

**例 1 和例 2**类似，我认为应该没有太大区别，这将是所有的禁食。1 号可能会稍微快一些。

**示例 3**会更慢，因为需要解析 sprintf 格式 ('%s %s')。

**示例 4**进行了替换，这涉及在字符串中搜索 - 额外的事情要做，需要更多时间。

但首先，连接字符串是性能问题吗？这不太可能，您应该分析代码以测量运行它需要多少时间。然后，一次又一次地用不同的方法替换连接方法。

如果您认为这是一个问题，请尝试使用谷歌搜索 php 字符串构建器类（有一些可以找到）或编写您自己的。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2014-06-11T15:43:48.910

从谷歌找到这篇文章，并认为我会运行一些基准测试，因为我很好奇结果会是什么。（使用减去其自身开销的基准测试器对超过 10,000 次迭代进行基准测试。）

```
    其中 2 弦 10 弦 50 弦
    -------------------------------------------------- --------------
    $a[] 然后 implode() 2728.20 ps 6.02 μs 22.73 μs
    $一个。$一个。$a 496.44 皮秒 1.48 微秒 7.00 微秒
    $b .= $a 421.40 ps ★ 1.26 μs 5.56 μs
    ob_start() 和 echo $a 2278.16 ps 3.08 μs 8.07 μs
    "$a$a$a" 482.87 ps 1.21 μs ★ 4.94 μs ★
    sprintf() 1543.26 ps 3.21 微秒 12.08 微秒

```

所以里面的内容不多。可能很好避免`sprintf()`，`implode()`如果你需要一些东西来快速尖叫，但所有常用方法之间没有太大区别。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2011-11-30T21:32:27.270

有 3 种类型的字符串连接操作。

连接，取 2 个字符串，分配内存大小 length1+length2 并将每个复制到新内存中。最快的 2 个字符串。但是，连接 10 个字符串需要 9 个连接操作。使用的内存是第 1 个字符串 10 次、第 2 个字符串 10 次、第 3 个字符串 9 次、第 4 个字符串 8 次等。每个周期使用更多内存运行 X+1 +(X-1)*2 操作。

sprintf（array_merge，join等），将所有字符串放在一起，求和它们的长度，分配一个大小为sum的新字符串，然后将每个字符串复制到各自的位置。使用的内存是所有初始字符串的 2*length，操作是 2*X（每个长度，每个副本）

ob（输出缓冲区）分配一个通用的 4k 块并将每个字符串复制到它。内存 4k + 每个初始字符串，操作 = 2 + X。（开始，结束，每个副本）

选择你的毒药。OB 就像使用内存原子弹连接 2 个小字符串，但是当有很多连接、循环、条件或添加对于干净的 sprintf 来说过于动态时非常有效。concat 是连接几个固定字符串最有效的方法， sprintf 更适合一次用固定值构建字符串。

我不知道在这种情况下使用哪个例程 php：“$x $y $z”，可能只是简化为内联 $x 。“”。$y 。“”。$z

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-03-29T19:03:18.750

您阅读的建议可能与`echo`函数有关，使用逗号会更快，例如：

```
echo $str1, $str2; 
```

另一种方法是在变量中构建一个字符串（例如使用 . 运算符），然后在末尾回显整个字符串。

您可以使用 microtime 函数自行测试（您需要创建一个循环，例如重复 1,000 或 100,000 次以使数字有意义）。但是在您发布的四个中，第一个可能是最快的。它也是最易读的——其他的在编程上并没有真正的意义。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-03-29T19:36:11.653

这不是 2 个字符串的解决方案，但是当您考虑以最佳方式连接更多字符串时：

```
$tmp=srray();
for(;;) $tmp[]='some string';
$str=implode('',$tmp); 
```

创建数组元素并一次加入它们比加入它们数百次要快。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-12-27T08:30:22.937

我不是 PHP 大师，但是，在许多其他语言（例如 Python）中，用许多较小的字符串构建长字符串的最快方法是将要连接的字符串附加到列表中，然后加入它们使用内置的连接方法。例如：

```
$result = array();
array_push("Hello,");
array_push("my");
array_push("name");
array_push("is");
array_push("John");
array_push("Doe.");
$my_string = join(" ", $result); 
```

如果你在一个紧密的循环中构建一个巨大的字符串，最快的方法是附加到数组，然后在最后加入数组。

注意：整个讨论都取决于 array_push 的性能。您需要将字符串附加到**列表**中，以便对非常大的字符串有效。由于我对 php 的了解有限，我不确定这样的结构是否可用，或者 php 的数组是否能够快速添加新元素。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2011-10-19T22:57:05.713

在此线程的最后一篇文章之后近 2 年，我认为以下解决方案对于大量紧密循环可能是最快的：

```
ob_start();

echo $str1;
echo $str2;
.
.
.
echo $str_n;

$finalstr = ob_get_clean(); 
```

此方法确保所有字符串的平面存储，并且没有处理或连接开销。使用最后的代码行，您也可以获得整个缓冲区。您可以安全地运行循环而不是独立的回声。

# visual-studio - 为什么安装 TortoiseSVN 后 AnkhSVN 解决方案中的所有文件都标记为新文件？

> ID：695136
> 
> 赞同：13
> 
> 时间：2009-03-29T18:52:06.437
> 
> 标签：visual-studio, visual-studio-2008, svn, tortoisesvn, ankhsvn

安装 TortoiseSVN 1.6.0 后，加载到启用 AnkhSVN 的 Visual Studio 2008 项目中的所有文件都标记为新文件（蓝​​色 +）。

我尝试重新安装 AnkhSVN 2.0.6347 并将存储库检出到一个新的“干净”文件夹中。然而，似乎都没有解决问题。

我的问题有两个方面，这个问题是否有解决方案？如果两种产品之间不兼容（即不同的 SVN 绑定？）有没有办法判断 AnkhSVN 和 TortoiseSVN 的组合将发挥作用彼此很好。

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2009-03-29T18:58:22.820

几天前我也注意到了这一点。发生这种情况是因为 Tortoise 将您的工作副本转换为 1.6 版本，而 Ankh 不知道如何阅读它。

解决方案很简单：我安装了 Ankh 的最新**每日**版本（[http://ankhsvn.open.collab.net/daily/](http://ankhsvn.open.collab.net/daily/)），现在一切都像魅力一样运行。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-15T12:37:53.373

我可以验证这也有效。

我遇到的一件事是我在安装新的每日构建版本之前卸载了旧版本（我安装了 AnkhSvn-Daily-2.1.6649.29.msi），但是一旦我安装了新版本，我就没有***任何源***代码控制Visual Studio 2008 中的任何集成！

事实证明，当您卸载 AnkhSVN 时，您的源代码控制提供程序设置为“无”，您必须转到“工具|选项|源代码控制”并将其设置回 AnkhSVN。

一旦你这样做了，你就可以使用 Visual Studio 集成和 TortoiseSVN 1.6。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-09T01:27:41.750

遗憾的是，此解决方案不适用于使用 VS2003 的任何人，因为 AnkhSVN 的 1.x 分支没有每日构建（SVN 1.6）。

AnkhSVN 团队表示他们现在太忙了，无法更新 AnkhSVN 1.x（即 VS2002/VS2003 版本），所以看起来除非有人愿意帮助他们（它是开源的），否则可能不会暂时做VS2003的SVN1.6版本。

# android - 有没有办法以编程方式阅读/访问 Android 中的电子邮件或收件箱？

> ID：695137
> 
> 赞同：4
> 
> 时间：2009-03-29T18:53:09.540
> 
> 标签：android, email

有没有办法以编程方式阅读/访问 Android 中的电子邮件或收件箱？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-30T15:58:41.323

据我所知，无法通过默认的 Gmail 应用程序以编程方式访问电子邮件。您最好的选择是找到一些 POP 或 IMAP 库，并将其集成到您的应用程序中。通过输入他们的电子邮件信息，您可以在您自己的应用程序中获取该邮箱的电子邮件。

# language-agnostic - 如果不必与客户打交道，您会支付多少费用？

> ID：695139
> 
> 赞同：5
> 
> 时间：2009-03-29T18:54:07.790
> 
> 标签：language-agnostic

我的一个朋友向我提出了一个建议，我几乎完成了所有工作（设计/编程），他与客户打交道。他要求为推荐人提供合同的 50%，并且不必与客户打交道。

看起来很多，但与此同时，如果他不给我带来客户，我将一无所获。我想知道其他人在类似情况下会做什么或做过什么。谢谢

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-03-29T19:02:16.447

请记住，您*仍在*与客户打交道-您的朋友。当他被客户挤压时，他大概会处理你的案子。而且，鉴于您之前有过恋爱关系，这可能会让人很不舒服。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-29T19:16:53.867

如果您觉得这是您做得不好或不想做的事情，那么让某人处理与合同编程相关的业务问题可能是一个好主意。为它支付 50% 的合同似乎不合理，除非它实际上是合伙企业。如果您正在考虑建立合作伙伴关系，则需要更多地考虑您将如何合作以及对您每个人实际完成的工作量进行一些合理的估计。

就要求和优先级而言，就个人而言，我不想在客户和我自己之间放置任何人。我认为这只是构建错误应用程序的秘诀。我主张与客户建立更密切的关系，而不是孤立自己。

如果您的朋友愿意出去寻找业务并需要您实际完成工作，我建议您可能希望以对您的工作有意义的价格与他签订合同。也就是说，您的合同应该与他签订。他可以添加任何看起来合理且实际客户会接受的溢价。不过，就个人而言，我坚持能够直接与客户就技术细节打交道。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-29T19:03:12.107

我个人认为你应该接受这笔交易，并以平等的伙伴关系体验自己。

将来，您可以根据您当前的合作伙伴关系获得自己的项目。然后你可以在没有你朋友的情况下赚取 100%。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-29T19:17:10.217

就个人而言，这在很大程度上取决于客户需要多少牵手，我认为我的合作伙伴会转移多少，以及利润有多薄。

我经营了几年的小型自由咨询业务（让自己完成了大学学习），并且遇到过我是与客户的唯一接口的情况，以及其他人仅与客户打交道的情况。*这在很大程度上取决于情况，但在某些情况下，由于不必*与客户打交道，每小时的收入明显增加，即使其他人大幅削减，仅仅是因为我花了更多时间编写代码，而更少是时候弄清楚他们到底想要什么了。

到目前为止，我遇到的最好的情况是与一家设计公司合作，该设计公司与我签约，为一些电影宣传网站做后端编程。他们处理了与客户的所有互动，并给了我非常明确的定义，说明他们需要我做什么，并且能够清楚而立即地回答我所有的技术问题。

如果您的朋友可以为您提供这样的情况，那么您很可能会脱颖而出。但是，我怀疑考虑到您在进行设计工作以及编程时，您仍然需要在迭代设计时与客户端进行大量交互。我的怀疑是，您与客户的直接或间接互动将比您想象的要多得多。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-29T18:58:45.300

不要低估营销/公关/销售的麻烦。特别是考虑到目前的市场情况。当然，您确实需要一些法律建议来明确划分责任。另外，既然这是第一份这样的工作，我不介意多付一点钱。维护费用总是上涨。

# qt - 如何在 qt 中使用默认图标

> ID：695142
> 
> 赞同：3
> 
> 时间：2009-03-29T18:55:21.173
> 
> 标签：qt, qt4, pyqt, pyqt4, kde

我只使用Qt（虽然是PyQt）并且当我调用例如QMessageBox.warning() 时我没有得到图标。有没有办法使用平台的默认图标？目前我正在使用更完整的 QMessageBox 构造函数并调用 setIconPixmap。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-20T19:59:00.630

[http://doc.qt.io/qt-5/qmessagebox.html](http://doc.qt.io/qt-5/qmessagebox.html)

从上面的链接：

QMessageBox 支持四种预定义的消息严重性级别或消息类型，它们实际上仅在它们各自显示的预定义图标上有所不同。通过将 icon 属性设置为预定义的 Icons 之一来指定四种预定义的消息类型之一。

所以你应该使用 QMessageBox 构造函数：

```
QMessageBox ( Icon icon, const QString & title, const QString & text, StandardButtons buttons = NoButton, QWidget * parent = 0, Qt::WindowFlags f = Qt::Dialog | Qt::MSWindowsFixedSizeDialogHint ) 
```

您可以使用以下图标之一：

[http://doc.qt.io/qt-5/qmessagebox.html#Icon-enum](http://doc.qt.io/qt-5/qmessagebox.html#Icon-enum)

例如，您可以为图标传递此参数：QMessageBox::Warning

！打招呼

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-22T13:50:00.453

我不确定您是如何编写消息框的用法的，但我是这样使用它的：

```
from PyQt4 import QtGui
QtGui.QMessageBox.warning(parent, dialogTitle, dialogText) 
```

如果这不会在您的消息框中产生警告图标，那么您可能需要考虑将您的 PyQt 升级到最新版本，因为过去我在一些 PyQt 修订版中遇到过类似的小错误。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-31T16:28:20.090

我不太熟悉通过 Python 使用 Qt 或使用 QMessageBox。但是，快速浏览文档意味着警告将使用警告图标，如果它们没有被更改，它应该是平台的默认图标。您是否尝试过查看 Qt 的错误跟踪系统以查看它是否是错误？或者为它提交错误/功能请求？

# html - 数据协议 URL 大小限制

> ID：695151
> 
> 赞同：85
> 
> 时间：2009-03-29T19:01:26.290
> 
> 标签：html, css

“数据：” URL 方案值是否有大小限制？我对流行的网络浏览器的限制感兴趣。换句话说，可以`data:image/jpg;base64,base64_encoded_data`在`<img src="data:image/jpg;base64,base64_encoded_data" />`或中多长时间`background-image: url(data:image/jpg;base64,base64_encoded_data)`？

* * *

## 回答 #1

> 赞同：122
> 
> 时间：2017-01-20T03:19:23.887

# 简短回答：数据 URI 限制各不相同。

有很多答案。正如 5 多年前提出的问题一样，由于过时，大多数现在都不正确，但这个问题位于“数据 uri 限制”的谷歌搜索结果的顶部。数据 URI 现在[得到广泛支持](http://caniuse.com/#feat=datauri)，IE 7/8 不再是相关的浏览器。下面有很多参考资料，因为今天的答案很微妙。

## 数据 URI 限制

数据 URI 规范没有定义大小限制，但表示应用程序可能会施加自己的限制。

*   Chrome -当前文档为[2MB](https://craignicol.wordpress.com/2016/07/19/excellent-export-and-the-chrome-url-limit/)。否则限制是任意 blob 的内存存储限制：如果 x64 而不是 ChromeOS 或 Android，则为 2GB；否则，`total_physical_memory / 5`（[来源](https://stackoverflow.com/a/43816041/149428)）。
*   火狐 -[无限制](https://developer.mozilla.org/en-US/docs/Web/HTTP/Basics_of_HTTP/Data_URIs#Common_problems)
*   IE ≥ 9 & 边缘 - [4GB](http://caniuse.com/#feat=datauri)
*   Safari 和移动 Safari - ?

## 备择方案

一种具有[更高限制（Chrome 中为 500MiB）](https://stackoverflow.com/questions/28307789/is-there-any-limitation-on-javascript-max-blob-size)的技术可能是您的用例的替代方案，它是通过[URL.createObjectURL()](https://developer.mozilla.org/en-US/docs/Web/API/URL/createObjectURL)使用[URL API](https://developer.mozilla.org/en-US/docs/Web/API/URL)的 Blob URL 以及通过[File API](https://w3c.github.io/FileAPI/)的 Blob 。[*使用 URL.createObjectURL()*](https://chrisrng.svbtle.com/using-url-createobjecturl)中提供了一个示例。

[*如何编写文件/将其提供给用户*](https://stuk.github.io/jszip/documentation/howto/write_zip.html)中提到的其他一些替代方法是：[FileSaver.js](https://github.com/eligrey/FileSaver.js)、[StreamSaver.js](https://github.com/jimmywarting/StreamSaver.js)和[JSZip](https://github.com/Stuk/jszip)。

您可以使用 Modernizr 来检测对[超过 32kb 的数据 URI 的](https://modernizr.com/docs)支持。

## 相关问题

这些答案与这个问题几乎相同，但我提到它们是为了节省您阅读每个答案的时间。

*   [在 Javascript 中获取最大 Data-Uri 大小](https://stackoverflow.com/questions/17082286/getting-max-data-uri-size-in-javascript)
*   [当数据 uri 太大时“Aw, Snap”](https://stackoverflow.com/questions/16761927/aw-snap-when-data-uri-is-too-large)
*   [Base64 DataURL 图像的大小限制是多少？](https://stackoverflow.com/questions/12637395/what-is-the-size-limit-of-a-base64-dataurl-image)
*   [不同浏览器中 URL 的最大长度是多少？](https://stackoverflow.com/questions/417142/what-is-the-maximum-length-of-a-url-in-different-browsers)这个问题是关于 URL，而不是数据 URI，但有关于数据 URI 的相关答案和评论。
*   [是否可以以编程方式检测数据 url 的大小限制？](https://stackoverflow.com/questions/36918075/is-it-possible-to-programmatically-detect-size-limit-for-data-url)

* * *

## 回答 #2

> 赞同：44
> 
> 时间：2012-03-31T17:05:10.303

我刚刚做了一个快速检查，嵌入了 8 个不同的 Jpeg 图像，大小从 3,844 到**2,233,076 字节**不等。

**以下所有浏览器都能在我的Windows 7**（64 位）系统上正确显示每个图像：

*   铬 14.0.816.0
*   火狐11.0
*   谷歌浏览器 18.0.1025.142
*   Internet Explorer 9.0.5（64 位）
*   歌剧 11.62
*   Safari 5.1.5

* * *

## 回答 #3

> 赞同：18
> 
> 时间：2009-03-29T19:15:22.450

来自[http://www.ietf.org/rfc/rfc2397.txt](http://www.ietf.org/rfc/rfc2397.txt)：

> “数据：” URL 方案仅对短值有用。请注意，某些使用 URL 的应用程序可能会施加长度限制；例如，嵌入`<A>`在 HTML 中的锚点中的 URL 具有由 HTML [RFC1866] 的 SGML 声明确定的长度限制。LITLEN (1024) 限制可以出现在单个属性值文字中的字符数，ATTSPLEN (2100) 限制出现在标签中的所有属性值规范的所有长度的总和，TAGLEN (2100) 限制标签的总长度。

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2011-05-29T12:19:46.273

我读过 Safari 的数据 URI 限制为 128K：

[http://blog.clawpaws.net/post/2007/07/16/Storing-iPhone-apps-locally-with-data-URLs#c1989348](http://blog.clawpaws.net/post/2007/07/16/Storing-iPhone-apps-locally-with-data-URLs#c1989348)

而 Chrome 是 2M：

[http://code.google.com/p/chromium/issues/detail?id=44820#c1](http://code.google.com/p/chromium/issues/detail?id=44820#c1)

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2017-08-20T10:29:12.237

2017 年的答案是：将数据转换为具有功能的 blob：dataURLtoBlob

```
function dataURLtoBlob(dataurl) {
    var arr = dataurl.split(','), mime = arr[0].match(/:(.*?);/)[1],
        bstr = atob(arr[1]), n = bstr.length, u8arr = new Uint8Array(n);
    while(n--){
        u8arr[n] = bstr.charCodeAt(n);
    }
    return new Blob([u8arr], {type:mime});
} 
```

然后创建blob url

```
var temp_url = window.URL.createObjectURL(blob); 
```

如果需要，然后在新窗口中使用它。

```
var redirectWindow = window.open('');
redirectWindow.document.write('<iframe src="' + temp_url + '" frameborder="0" style="border:0; top:0px; left:0px; bottom:0px; right:0px; width:100%; height:100%;" allowfullscreen></iframe>') 
```

适用于 chrome/firefox 2017 中的大文件

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2009-03-29T19:11:08.170

它实际上是“[数据 URI 方案](http://en.wikipedia.org/wiki/Data_URI_scheme)”。

根据 Wikipedia 页面，IE7 缺乏支持，并且 IE8 测试版将其限制为 32kB 的数据。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-03-29T19:13:47.040

关于网络浏览器的限制，MSIE 6/7 不支持数据 url 方案...更多信息在[维基百科上](http://en.wikipedia.org/wiki/Data_URI_scheme)

每个浏览器的长度限制都不同——我相信 IE8 最多允许 32KB，Opera 是 4KB，但不能真正告诉其他浏览器......

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2009-10-23T19:48:49.817

仅供参考，我能够使用来自 JavaScript ajax 调用的 Firefox 3.5 中的数据 url 加载 130K 图像。它截断了 IE 8 中的图像，但整个事情都出现在 FF 中。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2010-03-08T05:07:53.430

似乎 Firefox 3.6 的限制是 600KB。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2017-10-06T21:03:39.587

我尝试了 waza123 中的代码，但该`charCodeAt`方法没有正确转换所有字符。这是我在浏览器中创建大量下载的解决方案。（我将它用于 JSON 数据）

```
function exportToFile(jsonData, fileName) {
    const u8arr = new TextEncoder('utf-8').encode(JSON.stringify(jsonData, null, 2));
    const url = window.URL.createObjectURL(new Blob([u8arr], { type: 'application/json' }));
    const element = document.createElement('a');
    element.setAttribute('href', url);
    element.setAttribute('download', fileName);
    element.style.display = 'none';
    document.body.appendChild(element);
    element.click();
    document.body.removeChild(element);
} 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2019-05-25T11:28:25.963

注意：IE 中有一些额外的限制。对于 iframe，限制为 4 kb。

> 在 IE9 中，删除了 DataURI 的 32kb 限制，尽管出于安全原因，它们的使用仍仅限于某些上下文（特别是，禁止创建安全上下文的场景，如 IFRAMES）

[MSDN](https://blogs.msdn.microsoft.com/ieinternals/2014/08/13/url-length-limits/)

# php - 在 PHP 模板系统中实现条件的最佳方法？

> ID：695159
> 
> 赞同：0
> 
> 时间：2009-03-29T19:10:10.967
> 
> 标签：php, regex, string, templates

我正在为自定义 CMS/新闻系统创建一个非常简单的 PHP 模板系统。每篇文章都有介绍和完整内容（如果适用）。我想有一个形式的条件：

```
{continue}click to continue{/continue} 
```

因此，如果可以继续，将显示文本“单击以继续”，否则，不显示整个字符串。到目前为止，它是这样工作的：如果我们可以继续，删除 {continue} 标签；否则，删除整个事情。

我目前`preg_match_all`用于匹配第二种情况下的字符串。删除匹配文本的最佳功能是什么？一个简单的`str_replace`，还是别的什么？

还是有更好的方法来实现这一点？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-29T19:12:28.900

为什么不使用[preg_replace_callback](http://au.php.net/preg_replace_callback)？

具体来说：

```
preg_replace_callback('!\{continue\}(.*)\{/continue\}!Us', 'replace_continue', $html);

function replace_continue($matches) {
  if (/* can continue */) {
    return $matches[1];
  } else {
    return '';
  }
} 
```

我发现 preg_replace_callback 非常有用。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-29T19:27:49.987

抱歉，我知道人们一直在嘲笑这种答案，但请使用 Smarty。它简单、稳定、聪明、免费、小巧且便宜。花一个小时学习如何使用它，你将永远不会回头。

访问[www.smarty.net](http://www.smarty.net)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-29T19:30:00.137

对于 PHP 模板系统，正确的方法是解析模板（使用状态机或至少`preg_split`），从中生成 PHP 代码，然后仅使用该 PHP 代码。然后，您将能够将 normal`if`用于条件表达式。

正则表达式不是实现模板的好主意。PITA 将处理嵌套并在基本情况之外强制执行正确的语法。性能会很差（你必须小心不要创建回溯表达式，即使那样你最终也会多次扫描和复制 KB 模板）。

# wpf - 如何让内容围绕展开/折叠的 WPF 扩展器重新对齐？

> ID：695164
> 
> 赞同：2
> 
> 时间：2009-03-29T19:11:52.913
> 
> 标签：wpf, layout, expander

现在我有一个 Stackpanel，其中包含一个折叠的扩展器和一个列表框。

折叠的扩展器下方的列表框被定位为好像扩展器已展开。StackPanel 是否可以根据 Expander 的折叠大小动态进行布局，然后在单击 Expander 后根据 Expander 的展开大小进行布局？

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-29T20:07:29.860

在阅读了一堆文档之后，我确定了我的问题所在。

如果您明确设置 Expander 的高度（在垂直布局中），那么它将始终在 StackPanel 中使用该大小。如果您将高度设置为“自动”，那么它将使用 Expander 的内容作为展开后的尺寸，并在展开时使用 Expander 的折叠尺寸。

# perl - perl GD 绘制形状

> ID：695173
> 
> 赞同：0
> 
> 时间：2009-03-29T19:19:11.677
> 
> 标签：perl, drawing, gdlib

我正在使用 GD 库来绘制图像。

我正在绘制的图像是这个[http://i39.tinypic.com/apd1f7.png](http://i39.tinypic.com/apd1f7.png)

我可以管理大部分图像，但是我不知道如何绘制图像的红色部分。红色部分两侧都有一个横向三角形......我如何使用 GD lib 来管理它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-29T19:35:01.750

您想要填充多边形，请参阅[https://metacpan.org/pod/distribution/GD/GD.pm](https://metacpan.org/pod/distribution/GD/GD.pm)。

# content-management-system - 有没有 cushycms 替代品？

> ID：695176
> 
> 赞同：1
> 
> 时间：2009-03-29T19:20:11.207
> 
> 标签：content-management-system

我需要一个免费的非常简单的 CMS，我可以将它托管在我自己的服务器上，就像 Cushy CMS www.cushycms.com 一样。有没有 ？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-07T14:26:23.350

我最近写了一个 CushyCMS 的替代品，因为我希望开源社区有一个免费的替代品。

[Mechedit](http://code.google.com/p/mechedit/)是一个类似于应用程序的开源 CushyCMS。仅在 PHP5 上运行。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-08-08T07:31:43.360

[Orbis CMS](http://www.novo-ws.com/orbis-cms)是 CushyCMS 的另一个开源替代品。它基于相同的原则（简单、易用）并具有时尚的界面，但它是自托管且免费的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-11-16T12:52:03.487

SnappySnippets 是一个免费且简单的替代方案；它是高度可定制的，并有一个桌面界面，您的客户会发现它易于使用。它是托管的，因此您无需安装任何东西

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-29T21:26:04.383

Stackover flow上有很多这样的问题，例如： [link text](https://stackoverflow.com/questions/618685/what-is-the-best-free-cms-for-my-needs)

只需搜索 CMS

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-28T12:24:44.707

我最近问自己的好问题。这是 CMS 领域中一个被忽视的角落。但是，我确实发现：

*   这个相当详细和智能的摘要列表： http: [//www.matthijskamstra.nl/blog/index.php/2011/02/16/lightweight-cms-for-simple-projects/](http://www.matthijskamstra.nl/blog/index.php/2011/02/16/lightweight-cms-for-simple-projects/)
*   一个简短但最近更新的 40 个轻量级 CMS 列表[http://www.abcphp.com/out/top-40-free-simple-lightweight-cms-|-vivalogo-resources/](http://www.abcphp.com/out/top-40-free-simple-lightweight-cms-%7C-vivalogo-resources/)

另外两个清单，都是 2012 年的，都没有建议对产品进行太多检查：

*   [http://webdesignledger.com/tools/10-simple-and-light-weight-cms-solutions](http://webdesignledger.com/tools/10-simple-and-light-weight-cms-solutions)
*   [http://speckyboy.com/2010/07/19/14-light-and-east-to-use-open-source-content-management-systems/](http://speckyboy.com/2010/07/19/14-light-and-east-to-use-open-source-content-management-systems/)

如果你想知道，我正在考虑使用其中一个的项目变得更复杂一些，我最终选择了一个更重量级的系统，上面有一个简化的界面。

那里有一个教训。许多可以应对复杂需求的系统（Drupal、MODX 等）仍然可以很快安装，并且随着时间的推移，用户的需求只会变得更加复杂。

也就是说，我仍然希望轻量级系统占有一席之地。让我们知道您选择了什么。

# identifier - 你不能用标识符做什么？

> ID：695179
> 
> 赞同：0
> 
> 时间：2009-03-29T19:21:28.583
> 
> 标签：identifier

我试图了解[标识符](http://en.wikipedia.org/wiki/Identifier)代表什么以及它们不代表什么。

据我了解，标识符是方法、常量、变量、类、包/模块的名称。它涵盖了很多。但是你不能用它做什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-29T19:24:31.010

每种语言在可以或不能在该语言中命名和重用的实体/抽象方面都不同。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2011-03-07T05:05:00.953

在大多数语言中，您不能将标识符用于中缀算术运算。

例如，`plus`是一个标识符，您可以创建一个名为`plus`. 但是 write you can write `a = b + c;`，没有办法定义一个命名的运算符`plus`来`a = b plus c;`工作，因为语言语法根本不允许在那里使用标识符。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-20T04:06:44.347

标识符允许您为某些数据分配名称，以便您以后可以引用它。这就是标识符所做的限制；除了对某些数据的引用之外，您不能“使用”它。

也就是说，这会产生很多影响，有些微妙。例如，在大多数语言中，函数在某种程度上被视为数据，因此函数名称是标识符。在函数是值而不是“一等”值的语言中，您不能在可以将标识符用于其他东西的地方使用函数的标识符。在某些语言中，函数和其他数据甚至会有单独的命名空间，因此文本上相同的标识符可能指代两个不同的事物，并且它们将通过使用它们的上下文来区分。

您通常（即在大多数语言中）不能使用标识符的一个示例是作为对语言关键字的引用。比如这种事情一般是做不到的：

```
let during = while;
during (true) { print("Hello, world."); } 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-29T19:31:13.897

您可以说它用于您想要多次引用的所有内容，甚至可能一次（但使用它来阐明所指对象的目的）。

可以/不能命名的内容因语言而异，恕我直言，它通常非常直观。

“匿名”实体是没有命名的东西，尽管以某种方式被提及。

```
#!/usr/bin/perl
$subroutine = sub { return "Anonymous subroutine returning this text"; } 
```

在 Perl 语言中，这是匿名的——子例程没有命名，但它被引用变量 $subroutine 引用。

**PS：**在 Perl 中，子程序的命名如下：

```
sub NAME_HERE {
    # some code...
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-29T19:36:34.303

说，在[Java](http://java.sun.com)中你不能写这样的东西：

```
Object myIf = if;
myIf (a == b) {
    System.out.println("True!");
} 
```

所以，你不能命名一些代码语句，给它一个别名。在[REBOL](http://www.rebol.com/)中，这是完全可能的：

```
myIf: if
myIf a = b [print "True!"] 
```

如您所见，什么可以命名，什么不能命名取决于语言。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-29T19:30:16.160

顾名思义，标识符用于标识某物。因此对于可以唯一标识的所有内容，您可以使用标识符。但是例如文字（例如字符串文字）不是唯一的，因此您不能为其使用标识符。但是，您可以创建一个变量并为其分配一个字符串文字。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-29T20:05:35.857

把它们煮成汤是相当肮脏的。

在诸如 Lisp 之类的语言中，标识符本身作为符号存在，而在不是自省的语言中，标识符在运行时中不存在。

您可以通过在其前面放一个单引号来编写文字标识符/符号：

```
[1]> 'a
A 
```

您可以创建一个变量并为其分配一个符号文字：

```
[2]> (setf a 'Hello)
HELLO
[3]> a
HELLO
[4]> (print a)

HELLO 
HELLO 
```

您可以将两个变量设置为相同的符号

```
[10]> (setf b a)
HELLO
[11]> b
HELLO
[12]> a
HELLO
[13]> (eq b a)
T
[14]> (eq b 'Hello)
T 
```

注意b和a绑定的值是一样的，值是字面符号'Hello

您可以将函数绑定到符号

```
[15]> (defun hello () (print 'hello))
HELLO 
```

并称之为：

```
[16]> (hello)

HELLO 
HELLO 
```

在 common lisp 中，变量绑定和函数绑定是不同的

```
[19]> (setf hello 'goodbye)
GOODBYE
[20]> hello
GOODBYE
[21]> (hello)

HELLO 
HELLO 
```

但在 Scheme 或 JavaScript 中，绑定在同一个命名空间中。

如果将标识符具体化为符号，您还可以对标识符进行许多其他操作。我怀疑在 Lisp 中比我更博学的人将能够证明存在您“无法使用标识符”的任何事情。

但即使是 Lisp 也无法制作标识符汤。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-06-20T04:12:26.423

有点左字段的想法，但 JSON 中包含所有这些引号，以消除 JavaScript 关键字弄乱解析的危险。

# html - html中的两种色调背景？

> ID：695180
> 
> 赞同：0
> 
> 时间：2009-03-29T19:23:58.077
> 
> 标签：html

所以我想让我的网站背景有两种色调。我的意思是在中心有一个深灰色，一直向下，但在两侧有一个浅灰色。可能是页面宽度的 80-85%。我会这样做吗？

所以我想要的是中间是一种颜色，两侧是另一种颜色。有没有办法设置 bgcolor 然后将其宽度设置为 80% 或类似的东西？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-29T19:31:02.460

你最好使用背景图片，伙计；假设您知道目标受众的主要显示器尺寸，您可以使用所需参数制作 1024x1 图像。但是，如果（更可能是这种情况），您正试图让它成为动态的，为什么不只使用一个`div`元素，如下所示：

```
<style type="text/css">
#main
 {
   width: 84%; 
   background-color: #666666;
   border: 1px solid #cccccc;
   border-width: 0 8% 0 8%;
 }
</style>
<div id="main">#content#</div> 
```

我收回那句话……真的吗？！边框没有百分比宽度？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-29T19:32:22.910

如果您的中心区域是固定宽度的，那么您可以生成一个具有该宽度、一个像素高的图像，然后编写以下 CSS：

```
body {
    background-color: #ccc;
    background-image: url('some-image.jpg');
    background-position-x: center;
    background-repeat: repeat-y;
} 
```

如果没有，您必须定义一个`<div>`. `<div>`如果您希望您的内容以页面为中心，您可能必须定义 a来保存您的内容......

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-29T19:36:34.850

## CSS

```
<style type="text/css">
    body { background-color: #ccc; }
    div.page { margin: 0 auto; width: 85%; background-color: #ddd; }
</style> 
```

## HTML

```
<div class="page">
    <h1>Your page</h1>
    <p>Coming soon...</p>
</div> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-29T19:28:31.157

不可以。您需要将深灰色背景与浅灰色元素分开创建一个元素。

就像是：

```
<body style="background-color:#ccc;">

<div style="margin:0 auto;background-color:#555;width:85%;">

<!-- rest of the page contents -->

</div>

</body> 
```

或者在 body 上使用背景图片，但它的可扩展性较差，并且不能用于百分比宽度。

# .net - 如何允许 webproject 进行调试，而无需将服务器配置存储在项目中？

> ID：695188
> 
> 赞同：0
> 
> 时间：2009-03-29T19:26:15.343
> 
> 标签：.net, asp.net, iis, webdev.webserver

我想将我的项目设置为在 IIS 中运行，因为开发服务器在投入生产时导致误报。

但是，我不希望我不那么偏执的同事被迫这样做。我可以在附加到 iis 时关闭开发服务器启动，而不强制我的同事使用它吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-30T01:58:32.730

如果我理解了这个问题，那么您将遇到问题，您对 web.config 的本地更改不断检查到源代码管理中......因此，如果您在 web.config 中设置编译节点以进行调试，然后检查它，更改将影响其他开发商？

这是 Web 应用程序中比较烦人的事情之一。我使用的技术是击败任何将本地设置签入到 web.config 的开发人员的废话。

不过说真的……我以前使用过的一种技术是仅限制源代码控制中的权限，以便只有主管理员帐户才能签入对其的更改。

普通开发人员无权更改源代码管理中的特定文件。

开发人员手动删除了本地 web.config 副本的只读标志，以便他们可以对其环境进行任何必要的更改（连接 stings、调试设置等）......但他们不能意外地将这些更改签入源控制。

如果确实需要对 web.config 文件进行更改，那么我们必须使用主管理员帐户登录才能进行更改。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-30T08:52:40.007

嗯，我很想知道您项目的默认服务器是什么——因为它肯定是这些选项之一吗？

反正。您想要做的事情有一个“很长的路要走”：

1.  在 IIS 管理器中，将站点指向项目的根目录，从那里启动并运行应用程序（如果您使用的是 WinXP，请查看[IISAdmin.Net](http://www.codeplex.com/iisadmin)，这是在 XP 上设置多个站点的好工具）。
2.  从 Visual Studio 构建您的站点（或者如果它是一个网站，请确保所有内容都已保存）。
3.  在您选择的浏览器中从站点请求页面。
4.  在 Visual Studio 中转到：
    1.  调试或工具
    2.  附加到进程...
    3.  选择 w3wp
    4.  附

您现在将调试网站工作进程。

如果您在远程计算机上运行 IIS 并且使用的是 VS2k8，则需要确保在远程计算机上安装了 Visual Studio Remote Debugging Monitor - 这些文件通常可以在您的 VS2k8 安装目录中找到：

> \Microsoft Visual Studio 9.0\Common7\IDE\Remote Debugger

（附近有一个安装程序，但我现在似乎找不到它）。

# ruby-on-rails - 使用 geokit 浏览位置

> ID：695198
> 
> 赞同：0
> 
> 时间：2009-03-29T19:31:35.783
> 
> 标签：ruby-on-rails

我的用户模型使用 geokit 从 ip 地址中查找地址。如何让用户选择不同的国家、州或城市？我检查了所有文档，但不知道如何检索国家、州或城市的列表。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-29T21:55:15.110

您的问题不是 100% 清楚，但您可能正在尝试做一些 Geokit 不是为之设计的事情。

Geokit 基本上只做一件事：它需要一个 IP 地址或一个物理地址，并为您提供纬度/经度。当您将它作为 Rails 插件安装时，您可以对模型进行地理编码（通常使用街道地址），它会为您的模型类添加一些有用的东西。这些额外的东西可以让你计算模型对象之间的距离。

AFAIK，您无法从 Geokit 获得国家/地区列表。在我的项目中，我要么使用了一个免费的在线列表，要么从另一个应用程序导出列表，要么订阅了一项服务。

# javascript - ui 对话框在 IE 中工作一次

> ID：695199
> 
> 赞同：0
> 
> 时间：2009-03-29T19:31:38.013
> 
> 标签：javascript, jquery

我希望有人可以帮助解决这个问题。我正在使用在单击具有相同类的链接时弹出的 ui 对话框。问题是该链接一次很好，但是如果我再次单击它或具有相同类的另一个链接，则仅加载叠加层，而仅加载 IE 中的内容框。它在 Firefox 中效果很好。我的脚本包含一个 ajax 帖子，如果我删除了 ajax 代码，那么该框在每次点击时都可以正常工作。

我的代码：

```
$().ready(function() {

    $('#dialog').dialog({
        autoOpen:false,
        title:  $(this).attr("title"),
        modal: true, width: 450, height:"auto", resizable: false,
        close: function(ev, ui) { $(this).remove(); },
        overlay: {
            opacity: 0.5,
            background: "black"
        }
    });

   $(".mybutton").click(function(){

        $.post($(this).attr("href"), { },
            function(data) {
                $('#dialog').html(data);

            }

        );
        $('#dialog').dialog('open');
        return false;
    });

}); 
```

我有多个链接与“mybutton”类和一个 id 为 #dialog 的 div。我也在使用最新版本的 jQuery 和 ui。任何帮助将不胜感激。谢谢

我正在使用 IE8、jQuery 1.3.2、jQuery UI 1.7.1

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-29T20:05:42.267

The post is done asynchronously by default. It looks like you expect it to be synchronous. Try moving the open of the dialog into the callback after the data is set rather than in the click function -- which may execute before the callback returns.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-30T06:07:03.010

将 open 移到回调中...

```
$('#dialog').html(data).dialog('open'); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-09-13T15:55:31.700

我遇到了同样的问题。我通过自己管理对话框的状态来解决它......创建一个新的并每次处理它。

```
function makeDialog()
{
     var html = '';
     html += '<div>My dialog Html...</div>';

     return $(html).dialog(
     {
          position: 'center',
          modal: true,
          width: 518,
          height: 630,
          autoOpen: false,
          close: function() { $j(this.remove(); }
     });
} 
```

# wpf - 绑定wpf listview后选择所有项目

> ID：695201
> 
> 赞同：1
> 
> 时间：2009-03-29T19:34:55.477
> 
> 标签：wpf, xaml, mvvm, binding

我有以下 XAML：

```
<ListView x:Name="debitOrderItems" ItemsSource="{Binding DebitOrderItems}">
  <ListView.ItemTemplate>
    <DataTemplate>
      <CheckBox x:Name="checkbox" Content="{Binding}" IsChecked="{Binding RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type ListViewItem}}, Path=IsSelected}" />
    </DataTemplate>
  </ListView.ItemTemplate>
</ListView> 
```

绑定项目列表工作正常，我得到一个带有复选框的漂亮列表视图，但我希望立即将它们全部选中。ListView 上有一个 SelectAll() 方法，但我什么时候可以调用它？DataContextChanged 不起作用，因为我在填充 DebitOrderItems 之前链接它。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-29T20:35:42.930

您可以在 Loaded 事件中执行此操作：

```
public Window()
{
    InitializeComponent();
    Loaded += delegate
    {
        _listView.SelectAll();
    };
} 
```

也就是说，我会质疑你的设计。通常，列表中的每个项目都有一个视图模型，并且将`IsChecked`属性绑定到该视图模型上的属性。

# php - 通过 PHP 检索网站来源的最有效方法？（获取请求）

> ID：695212
> 
> 赞同：2
> 
> 时间：2009-03-29T19:38:14.643
> 
> 标签：php, http, sockets, fgets

我知道 file_get_contents 可用于检索网页的来源，但我想知道最有效的方法。

我有一个很久以前制作的旧课程，它使用这样的东西：

```
 $this->socket = fsockopen($this->host, 80);

    fputs($this->socket, 'GET ' . $this->target . ' HTTP/1.0' . "\n");
    fputs($this->socket, 'Host: ' . $this->host . "\n"); 
    fputs($this->socket, 'User-Agent: Mozilla/5.0 (X11; U; Linux i686; en-US; rv:1.9b5) Gecko/2008050509 Firefox/3.0b5' . "\n");
    fputs($this->socket, 'Connection: close' . "\n\n");

    $this->source = '';

    while(!feof($this->socket))
    {
        $this->source .= fgets($this->socket, 128);
    }

    fclose($this->socket); 
```

这是最好的方法吗？最有效的意思是返回最快的结果。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-29T19:42:28.033

`file_get_contents()`是最好和最有效的方法。但是，无论哪种方式，都没有太大区别，因为瓶颈是网络，而不是处理器。代码可读性也应该是一个问题。

也考虑这个基准：[http ://www.ebrueggeman.com/php_benchmarking_fopen.php](http://www.ebrueggeman.com/php_benchmarking_fopen.php)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-29T19:42:16.020

您拥有的代码可能是执行您所说的最快和最简单的方法。但是，如果您想要执行更复杂的任务（例如发布或支持 HTTP 1.1 内容，例如 Content-Encoding 和 Transfer-Encoding），它就不是很灵活。

如果您想要一些可以处理更复杂情况等的东西，请使用 php [cURL](http://php.net/curl)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-30T01:40:18.487

没有把握？让我们测试一下！下面的脚本[`example.org`](http://www.example.org)使用这两种方法打开了 10 次：

```
$t = microtime(true);
$array = array();
for($i = 0; $i < 10; $i++) {
    $source = file_get_contents('http://www.example.org');
}
print microtime(true) - $t;
print '<br>';
$t = microtime(true);
$array = array();
for($i = 0; $i < 10; $i++) {
    $socket = fsockopen('www.example.org', 80);
    fputs($socket, 'GET / HTTP/1.0' . "\n");
    fputs($socket, 'Host: www.example.org' . "\n"); 
    fputs($socket, 'User-Agent: Mozilla/5.0 (X11; U; Linux i686; en-US; rv:1.9b5) Gecko/2008050509 Firefox/3.0b5' . "\n");
    fputs($socket, 'Connection: close' . "\n\n");
    $source = '';
    while(!feof($socket)) {
        $source .= fgets($socket, 128);
    }
    fclose($socket);
}
print microtime(true) - $t; 
```

第一次运行：

```
file_get_contents: 3.4470698833466
fsockopen: 6.3937518596649 
```

第二次运行：

```
file_get_contents: 3.5667569637299
fsockopen: 6.4959270954132 
```

第三次运行

```
file_get_contents: 3.4623680114746
fsockopen: 6.4249370098114 
```

因此，由于[`file_get_contents`](http://www.php.net/file_get_contents)更快更简洁，我将宣布它为获胜者！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-29T19:56:57.593

还要检查 Zend Framework 的[`Zend_Http_Client`](http://framework.zend.com/manual/en/zend.http.html#zend.http.client.usage)类。它支持重定向等。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-30T01:26:34.337

你不会得到比内置的 file_get_contents 像这样的自制代码更好的性能。实际上，短至 128 字节（？为什么？）的字符串的常量连接会表现得相当糟糕。

对于 HTTP，*有理由*自己动手或使用外部库，例如：

*   您需要控制网络超时

*   您想直接从套接字流式传输内容而不是累积它

但性能不是其中之一；简单的内置PHP功能将仅受网络速度的限制，这是您无能为力的。

# flash - 如何确定关联数组是否有键？

> ID：695215
> 
> 赞同：21
> 
> 时间：2009-03-29T19:39:28.290
> 
> 标签：flash, actionscript-3, arrays, associative-array, key

在 ActionScript 3 中，是否有任何方便的方法来确定关联数组（字典）是否具有特定键？

如果密钥丢失，我需要执行额外的逻辑。我可以捕捉到`undefined property`异常，但我希望这可能是我最后的手段。

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2009-03-31T06:05:54.673

```
var card:Object = {name:"Tom"};

trace("age" in card);  //  return false 
trace("name" in card);  //  return true 
```

试试这个运算符：“in”

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-11T01:07:41.770

`hasOwnPropery`是您测试它的一种方式。以此为例：

```
 var dict: Dictionary = new Dictionary();

// this will be false because "foo" doesn't exist
trace(dict.hasOwnProperty("foo"));

// add foo
dict["foo"] = "bar";

// now this will be true because "foo" does exist
trace(dict.hasOwnProperty("foo")); 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-03-29T21:33:17.067

最快的方法可能是最简单的：

```
// creates 2 instances
var obj1:Object = new Object();
var obj2:Object = new Object();

// creates the dictionary
var dict:Dictionary = new Dictionary();

// adding the first object to the dictionary (but not the second one)
dict[obj1] = "added";

// checks whether the keys exist
var test1:Boolean = (dict[obj1] != undefined); 
var test2:Boolean = (dict[obj2] != undefined); 

// outputs the result
trace(test1,test2); 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-04-09T06:21:51.017

hasOwnProperty 似乎是流行的解决方案，但值得指出的是，它只处理字符串并且调用起来可能很昂贵。

如果您使用对象作为字典中的键，则 hasOwnProperty 将不起作用。

更可靠和高效的解决方案是使用严格相等来检查未定义。

```
function exists(key:*):Boolean {
    return dictionary[key] !== undefined;
} 
```

请记住使用严格相等，否则具有空值但有效键的条目将看起来为空，即

```
null == undefined // true
null === undefined // false 
```

实际上，正如已经提到的，使用`in`应该也可以正常工作

```
function exists(key:*):Boolean {
    return key in dictionary;
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-29T19:47:31.967

试试这个：

```
for (var key in myArray) {
    if (key == myKey) trace(myKey+' found. has value: '+myArray['key']);
} 
```

# sharepoint - 如何创建和部署要在 Sharepoint Designer 工作流操作中使用的自定义 DesignerType？

> ID：695216
> 
> 赞同：0
> 
> 时间：2009-03-29T19:39:46.637
> 
> 标签：sharepoint, workflow, designer

我想为将由 Sharepoint Designer 使用的自定义工作流操作创建自己的 DesignerType。这可能吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-31T00:09:28.007

我已经创建了一堆自定义操作。我问的是添加到[此处](http://blogs.msdn.com/sharepointdeveloperdocs/archive/2007/11/15/extending-workflow-actions-for-sharepoint-designer.aspx)概述的默认 DesignerTypes 集中：

这可能连飞碟都够不着。

# objective-c - 使用带有 WebViewUI 的目录

> ID：695232
> 
> 赞同：1
> 
> 时间：2009-03-29T19:47:32.843
> 
> 标签：objective-c, iphone

我有 60 个左右的网页要放入目录中。如何修改它`webview loadrequest`以从目录中提取内容？

```
[webView loadRequest:[NSURLRequest requestWithURL:[NSURL fileURLWithPath:    [[NSBundle mainBundle] pathForResource:docPage ofType:@"html"]isDirectory:NO]]]; 
```

# django - django 模板能否知道调用它的视图是否具有 @login_required 装饰器？

> ID：695236
> 
> 赞同：5
> 
> 时间：2009-03-29T19:49:53.320
> 
> 标签：django, templates, decorator

假设我有一个系统，其中有一些页面是公开的（未经身份验证的用户和登录用户都可以查看）和其他只有登录用户才能查看的页面。

我希望模板为这两类页面中的每一个显示略有不同的内容。@login_required 视图装饰器始终用于只有登录用户才能查看的视图。但是，我的模板需要知道这个装饰器是否用于调用模板的视图。

请记住，我不关心用户是否登录公共页面。我关心的是一个页面是否可以被公众查看，而没有@login_required 装饰器会告诉我这一点。

任何人都可以提示我模板如何知道是否在调用模板的视图上使用了特定的装饰器？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-29T23:28:54.103

是的，这是可能的，但不是非常简单。复杂的因素是 Django 的`login_required`装饰器实际上通过了 2 级间接（一个动态函数和一个其他装饰器），最终到达 django.contrib.auth.decorators._CheckLogin，这是一个带有`__call__`方法的类。

假设您有一个非 django 的花园式装饰函数，如下所示：

```
def my_decorator(func):
    def inner():
        return func()
    return inner

@my_decorator
def foo():
    print foo.func_name

# results in: inner 
```

检查函数`foo`是否已被包装可以像检查函数对象的名称一样简单。您可以在函数内部执行此操作。该名称实际上是最后一个包装函数的名称。对于更复杂的情况，`inspect`如果您正在寻找特别的东西，您可以使用该模块从当前框架向上走外部框架。

然而，在 Django 的情况下，装饰器实际上是`_CheckLogin`类的实例这一事实意味着该函数不是真正的函数，因此没有`func_name`属性：尝试上述代码将引发异常。

但是，查看 的源代码`django.contrib.auth.decorators._CheckLogin`表明该`_CheckLogin`实例将具有一个`login_url`属性。这是一个非常简单的测试：

```
@login_required
def my_view(request):
    is_private = hasattr(my_view, 'login_url') 
```

因为`_CheckLogin`也用于实现其他 auth 装饰器，所以这种方法也适用于`permission_required`等单个视图周围的多个装饰器......我猜是留给读者的练习（检查框架堆栈？）。

然而，作为未经请求的编辑建议，我会说检查函数本身以查看它是否像这样包装让我觉得有点繁琐。你可以想象当一个新的开发者来到这个项目时，各种不可预知的行为等待着发生，就像对其他装饰器的打击一样。事实上，您还面临着 django 框架本身的变化……等待发生的安全风险。

出于这个原因，我会推荐 Van Gale 的方法，因为它是明确的，因此是更强大的实现。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-29T19:52:10.210

我会将一个额外的上下文变量传递到模板中。

因此，具有 @login_required 的视图将传递一个变量`private: True`，而其他视图将传递`private: False`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-29T19:53:56.167

为什么您的模板需要知道这一点？如果使用`@login_required`装饰器，视图本身会阻止未登录的人访问页面，因此从一开始就看不到模板。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-29T21:11:49.863

模板是分层的，那么为什么没有一个`@login_required`版本和一个“否`@login_required`”版本，它们都继承自同一个父级？

这将使模板更干净，更易于维护。

# c# - 如何在 .Net 中播放“新邮件”系统声音？

> ID：695241
> 
> 赞同：4
> 
> 时间：2009-03-29T19:52:17.153
> 
> 标签：c#, .net, audio

如何在 C# 中播放“新邮件”系统声音？这也称为“通知”声音。

在 Win32 中，这将类似于

```
sndPlaySound('Notify', (SND_ALIAS or SND_ASYNC)); 
```

那么您如何在.Net 中做到这一点？我知道你能做到

```
System.Media.SystemSounds.Asterisk.Play(); 
```

但是那里有非常有限的五种声音 - 不包括用户设置为新邮件声音的任何声音。

当我收到新邮件并播放该文件时，我可以找出正在播放的 .wav 文件，但是当用户的声音方案更改时，它不会更新。

* * *

我最终做了什么：

我没有播放系统声音，而是将 wav 文件作为资源嵌入到应用程序中，并使用`System.Media.SoundPlayer`

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-29T21:21:39.450

一种选择是直接 PInvoke 到 sndSound API。这是该方法的 PInvoke 定义

```
public partial class NativeMethods {

    /// Return Type: BOOL->int
    ///pszSound: LPCWSTR->WCHAR*
    ///fuSound: UINT->unsigned int
    [System.Runtime.InteropServices.DllImportAttribute("winmm.dll", EntryPoint="sndPlaySoundW")]
    [return: System.Runtime.InteropServices.MarshalAsAttribute(System.Runtime.InteropServices.UnmanagedType.Bool)]
public static extern  bool sndPlaySoundW([System.Runtime.InteropServices.InAttribute()] [System.Runtime.InteropServices.MarshalAsAttribute(System.Runtime.InteropServices.UnmanagedType.LPWStr)] string pszSound, uint fuSound) ;

    /// SND_APPLICATION -> 0x0080
    public const int SND_APPLICATION = 128;

    /// SND_ALIAS_START -> 0
    public const int SND_ALIAS_START = 0;

    /// SND_RESOURCE -> 0x00040004L
    public const int SND_RESOURCE = 262148;

    /// SND_FILENAME -> 0x00020000L
    public const int SND_FILENAME = 131072;

    /// SND_ALIAS_ID -> 0x00110000L
    public const int SND_ALIAS_ID = 1114112;

    /// SND_NOWAIT -> 0x00002000L
    public const int SND_NOWAIT = 8192;

    /// SND_NOSTOP -> 0x0010
    public const int SND_NOSTOP = 16;

    /// SND_MEMORY -> 0x0004
    public const int SND_MEMORY = 4;

    /// SND_PURGE -> 0x0040
    public const int SND_PURGE = 64;

    /// SND_ASYNC -> 0x0001
    public const int SND_ASYNC = 1;

    /// SND_ALIAS -> 0x00010000L
    public const int SND_ALIAS = 65536;

    /// SND_SYNC -> 0x0000
    public const int SND_SYNC = 0;

    /// SND_LOOP -> 0x0008
    public const int SND_LOOP = 8;

    /// SND_NODEFAULT -> 0x0002
    public const int SND_NODEFAULT = 2;
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-04T07:18:59.590

实际上，新邮件声音是“MailBeep”别名，而不是“Notify”别名。

所以你想调用 PlaySound(L"MailBeep", NULL, SND_SYSTEM | SND_NODEFAULT | SND_ALIAS);

P/Invoke 绝对是通往这里的道路。

[不要忘记指定 SND_NODEFAULT ，否则即使用户在控制面板中禁用了新的邮件声音，您的应用也会发出声音](http://blogs.msdn.com/larryosterman/archive/2008/09/25/why-specify-snd-nodefault-when-calling-playsound.aspx)。

SND_SYSTEM 是 Windows Vista 的新功能，它使声音以“Windows 声音”的形式播放——这取决于您是否想要获得这种体验。

# javascript - Is there a way to use jQuery.getScript inside the AIR application sandbox?

> ID：695242
> 
> 赞同：0
> 
> 时间：2009-03-29T19:52:47.620
> 
> 标签：javascript, jquery, ajax, air

I 'm trying to build an AIR application using the HTML/JS engine (not flex nor flash), but I'm facing an issue while trying to load dynamically a JS file form the application directory.
Once the application has launched, if I try to load a script using jQuery.getScript method, the script is never interpreted and no error is thrown.

I've read about the security model of AIR and found that, in the Application sandbox, once the application is launched, nearly no new script can be added BUT the ones form the application directory.
So, I'm wondering why my script isn't interpreted. Is it due to the fact that jQuery append the script to the DOM and that this is prohibited? Is there a jQuery alternative? Or am I force do use the crappy AIR native API?

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2009-03-30T06:04:00.287

您应该使用本机 API 来检索文本然后`eval()`是文本.. 这将具有相同的一般效果...可能想要`eval.call(window, scriptText)`确保您的命名空间/封装是正确的。

# php - How can you view ASP.NET Session State in a different platform like PHP?

> ID：695253
> 
> 赞同：2
> 
> 时间：2009-03-29T19:59:19.460
> 
> 标签：php, asp.net, session-state

Say I have an ASP.NET webpage and I also have a PHP Blog/BBS/Website. I want all logins to be done via the ASP.NET webpage. The ASP.NET Session State is stored in SQL. Is there any way I can read/decode the Session State from PHP to tell if a user is logged on if I have the Session State cookie?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-29T20:19:09.537

I don't think there's a supported way. You could reverse-engineer the store, but the database format may change with next .NET service pack and youe a'd be screwed then.

The only safe way would be to implement your own session state provider so you could guarantee that the database format doesn't change.

If all you need is to verify that the user is authenticated, it would be probably easier to send the user an encrypted cookie with the username and decrypt it in the PHP app.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-30T03:27:25.543

除非您特别需要对整个 asp.net 会话状态的完全访问权限，否则最好将您知道两个应用程序需要直接共享的特定信息存储在共享数据库或文件中。

这样，您就可以忽略 asp.net 会话的大部分复杂性，而只需挑选您的应用程序需要相互共享的特定数据片段。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-29T20:51:03.173

我从未尝试过，但如果您提供了一个简单的 Web 服务，它是您的 asp.net 应用程序的一部分，但只能从您的 PHP 站点访问。您现在应该能够通过网络服务读取会话中的任何内容。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-29T23:06:02.833

这看起来很棘手，但请尝试阅读[此处](http://ar2.php.net/manual/en/function.session-set-save-handler.php)。这里的问题是知道 asp 编码和保存会话的方式，如果您可以阅读该格式，这可能会有所帮助。

我在想的另一种方法是向php创建一个对一些“登录”页面表单的请求，在那里你发送登录凭据并且php文件创建会话，但是如果你让它保持打开状态，这可能是不安全的，而且可能很慢，因为需要另一个请求。

另一方面，我看到很少有网站，一旦你登录，例如在主站点，你想去论坛，你点击一些链接，将表单提交到 php 登录页面（凭据是“硬编码的” " 对于该会话中的该用户）和 php 页面登录，您喜欢“常规”行为。

希望清楚

# c - C中的算法比较，有什么区别？

> ID：695259
> 
> 赞同：3
> 
> 时间：2009-03-29T20:00:56.040
> 
> 标签：c, algorithm, memory-management, iteration

```
#define IMGX 8192
#define IMGY 8192
int red_freq[256];
char img[IMGY][IMGX][3];

main(){ 

int i, j;
  long long total;
  long long redness;

  for (i = 0; i < 256; i++) 
    red_freq[i] = 0;

  for (i = 0; i < IMGY; i++) 
    for (j = 0; j < IMGX; j++) 
      red_freq[img[i][j][0]] += 1;

  total = 0;
  for (i = 0; i < 256; i++) 
    total += (long long)i * (long long)red_freq[i];

  redness = (total + (IMGX*IMGY/2))/(IMGX*IMGY); 
```

将第二个 for 循环替换为

```
for (j = 0; j < IMGX; j++) 
    for (i = 0; i < IMGY; i++) 
      red_freq[img[i][j][0]] += 1; 
```

其他一切都保持不变，为什么第一个算法比第二个算法快？

它与内存分配有关吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-29T20:07:01.767

第一个版本按顺序更改内存，因此最佳地使用了处理器缓存。第二个版本使用它加载的每个缓存行中的一个值，因此它对于缓存的使用非常不利。

要理解的一点是缓存被分成几行，每一行在整体结构中都会包含很多值。

编译器还可以优化第一个版本以使用更智能的指令（SIMD 指令），这将更快。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-29T20:06:32.110

这是因为第一个版本按照物理布局的顺序遍历内存，而第二个版本在内存中从数组中的一列跳转到下一列。这将导致缓存抖动并干扰 CPU 的最佳性能，然后必须花费大量时间等待缓存一次又一次地刷新。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-29T20:07:46.647

这是因为大型现代处理器架构（例如 PC 中的架构）经过大规模优化，可以在他们最近访问的“附近”（地址相关术语）内存的内存上工作。实际的物理内存访问比 CPU 理论上可以运行的速度要慢得多，因此帮助进程以最有效的方式进行访问的所有内容都有助于提高性能。

概括更多是几乎不可能的，但是“参考的局部性”是一件好事。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-29T20:07:31.623

由于内存的布局方式，第一个版本保持了数据局部性，因此减少了缓存未命中率。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-29T20:16:32.537

内存分配只发生一次，而且是在开始时，所以这不可能是原因。原因是运行时如何计算地址。在这两种情况下，内存地址都计算为

```
(i * (IMGY * IMGX)) + (j * IMGX) + 0 
```

在第一个算法中

```
(i * (IMGY * IMGX)) gets calculates 8192 times
(j * IMGX) gets calculated 8192 * 8192 times 
```

在第二种算法中

```
(i * (IMGY * IMGX)) gets calculates 8192 * 8192 times
(j * IMGX) gets calculated 8192 times 
```

自从

```
(i * (IMGY * IMGX)) 
```

涉及两次乘法，越多需要更多时间。这就是原因

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-29T20:07:23.777

是的，它与内存分配有关。第一个循环索引 的内部维度`img`，每次恰好跨越 3 个字节。这很容易在一个内存页面内（我相信这里的常见大小是一页 4kB）。但是在您的第二个版本中，外部维度的索引变化很快。这将导致内存读取分布在更大范围的内存上——即`sizeof (char[IMGX][3])`字节，即 24kB。随着内部索引的每次变化，这些跳跃再次开始发生。这将影响不同的页面，并且可能会慢一些。我还听说 CPU 会提前读取内存。这将使第一个版本受益，因为在它读取时，该数据可能已经在缓存中。我可以想象第二个版本并没有从中受益，因为它会在内存中来回跳跃。

我怀疑差异并没有那么大，但如果算法运行多次，它最终会变得明显。您可能想阅读[`Row-major Order`](http://en.wikipedia.org/wiki/Row-major_order)维基百科上的文章。这就是用于在 C 中存储多维数组的方案。

# browser - Where does the browser fail as a client

> ID：695262
> 
> 赞同：0
> 
> 时间：2009-03-29T20:01:26.117
> 
> 标签：browser, user-interface, rich-internet-application

Where should the browser be improved upon to help improve application experiences?

For instance some of my main gripes are A) Different browsers will need different configurations / plugins (I dont want to download different JRE's, RIA platforms such as flash, silverright, gears so forth)

B) I want to always be able to drag data from my desktop to a 'Webapp'. I don't like clicking browse for file and then uploading it. I think this is something that should be easily handled.

Additionally based on the above point - I'd like for it to be very easy to drag information from a web page to my computer to be used in whatever shape form or matter needed. For instance I'd like if I could drag my user ID from stack overflow into my mail / crm client which would take relevant information and maybe even build a picture up of my knowledge.

What else am I missing ?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-29T20:11:43.220

I see that current problem is ever-growing pile of technologies. Just connect straight to users browser API calls via RPC. RPC is future way to go and it puts end to this tech-piling-up-trend. Currently security is too weak for this kind of technology. Maybe some sort of virtual sandbox would fix that.

See RPyc [theory of operation](http://rpyc.wikidot.com/theory) and [screencast](http://rpyc.wikidot.com/screencasts#part1), it explains the idea pretty well.

# c# - 如何在 WPF Visual Studio 设计器中显示占位符值，直到可以加载实际值

> ID：695263
> 
> 赞同：15
> 
> 时间：2009-03-29T20:02:10.950
> 
> 标签：c#, wpf, visual-studio, designer

我是一位经验丰富的 C# 开发人员，但也是 WPF 新手。我无法通过网络搜索找到答案的基本问题（我认为）。这是简化的用例...

我想在 WPF TextBlock 中显示一个字符串。所以我在我的 XAML 控件的代码隐藏中编写了一些 C# 代码......

```
public class MyCoolControl : UserControl
{
   public void InitializeMyCoolControl()
   {
      this.DataContext = "SomeStringOnlyAvailableAtRuntime"; // Perhaps from a database or something...
   }
} 
```

我像这样设置我的 XAML：

```
<UserControl ... snip...>
   <!-- Bind the textblock to whatever's in the DataContext -->
   <TextBlock Text="{Binding}"></TextBlock>
</UserControl> 
```

效果很好，当我执行我的应用程序时，我可以看到值“SomeStringOnlyAvailableAtRuntime”。但是，我在使用 Visual Studio 2008 的 XAML 设计器的设计时看不到任何东西。

如何在设计时查看文本块的占位符值（任何内容）？

谢谢！

-麦克风

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2009-03-30T01:16:46.107

在设计用户控件时，我经常使用`FallbackValue`绑定来查看一些东西。例如：

```
<TextBlock Text={Binding Path=AverageValue, FallbackValue=99.99} /> 
```

但是，由于`FallbackValue`不仅仅在设计时应用，如果您`FallbackValue`出于其他原因想在运行时使用，这可能不合适。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-30T14:01:25.067

在您的示例中，您可能需要使用`TargetNullValue`，而不是绑定`FallbackValue`表达式可能`null`在设计时使用。`DataContext``null`

`FallBackValue`如果`Path`绑定中的给定不存在，则使用，但由于没有指定路径，我假设`DataContext`将被评估为`null`.

```
<UserControl ... snip...>
  <!-- Bind the textblock to whatever's in the DataContext -->   
    <TextBlock Text="{Binding TargetNullValue=Nothing to see}"></TextBlock>
</UserControl> 
```

另请注意，需要 .NET Framework 3.5 SP1，因为这两个附加属性是在 SP1 中添加的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-29T21:21:42.477

我不知道使用 Visual Studio 的编辑器执行此操作的方法，但您可以使用 Expression Blend 执行此操作。

[这是](http://www.galasoft.ch/mydotnet/articles/article-2007091401.html)描述如何实现这一目标的文章。

我确实希望 MS 将 Blend 和 Visual Studio 的功能合并在一起，因为让一个包做一件事而另一个包做另一件事有点傻。特别是当他们来自同一家公司时。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-03-05T09:34:12.813

在这种情况下，让 MultiValueConverter 或 ViewModel 对象处理对象加载并为您更新依赖项属性不是最好的选择吗？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-02-24T06:27:09.713

`TargetNullValue`和都`FallbackValue`在运行时具有功能，因此它们不是好的占位符选择。
`TargetNullValue`：如果目标属性值相等`TargetNullValue`，则源属性设置为`null`，如果源属性为`null`，则目标属性设置为`TargetNullValue`。
`FallbackValue`：如果源`Binding`是`null`或未能将源属性转换为目标属性，则目标属性将设置为`FallbackValue`。

您可以创建自定义 MarkupExtension 以在设计器中显示占位符，并在运行时进行正常绑定

我的代码：

```
//Coding by Squirrel Downy(Flithor)
public class PlaceHolderBinding : MarkupExtension
{
    /// <summary>
    /// Show placeholder in designer, if null than ignore it
    /// </summary>
    public object PlaceHolder { get; set; }
    /// <summary>
    /// Binding works in runtime
    /// </summary>
    public BindingBase Binding { get; set; }

    public override object ProvideValue(IServiceProvider serviceProvider)
    {
        //if no binding
        if (Binding == null) throw new ArgumentNullException("Binding");

        //get target info
        var target = serviceProvider.GetService(typeof(IProvideValueTarget)) as IProvideValueTarget;
        if (target == null) throw new InvalidOperationException("Only support as Binding");

        //get target object and check is DependencyObject
        if (!(target.TargetObject is DependencyObject targetObject))
            throw new InvalidOperationException("Only support on DependencyObject");

        //if target in designer, return placeholder
        if (DesignerProperties.GetIsInDesignMode(targetObject))
            return PlaceHolder;

        //get target property and check is DependencyProperty
        if (!(target.TargetProperty is DependencyProperty targetProp))
            throw new InvalidOperationException("Only support on DependencyProperty");

        //set binding and return binding provide value
        BindingOperations.SetBinding(targetObject, targetProp, Binding);
        return Binding.ProvideValue(serviceProvider);
    }
} 
```

# javascript - 事件在 Firefox/Chrome 中有效，但在 IE 中失败

> ID：695265
> 
> 赞同：1
> 
> 时间：2009-03-29T20:03:52.100
> 
> 标签：javascript, internet-explorer, raphael

我刚刚构建了一张新西兰的 SVG 地图，用于与优秀的 javascript 库[Raphael](http://raphaeljs.com)一起使用，但不幸的是，我偶然发现了我只能想象的 IE 的 javascript 解释器中的错误或语法变化。

在 Firefox 和其他浏览器中，onlick 和 onmouseover 事件可以完美运行 - 但是它们不会在 IE 中触发（在 IE 7 中测试）。不幸的是，没有 javascript 错误可以帮助我调试它，所以我只能假设 IE 以某种根本不同的方式处理这些事件。

```
<script type="text/javascript" charset="utf-8">
    window.onload = function() {
        var R = Raphael("paper", 450, 600);
        var attr = {
            fill: "#3f3f40",
            stroke: "#666",
            "stroke-width": 1,
            "stroke-linejoin": "round"
        };
        var nz = {};
        nz.northland = R.path(attr, "M 193.34222,3.7847503 C 194.65463");
                // SVG data stripped for sake of brevity
        var current = null;
        for (var region in nz) {
            nz[region].color = Raphael.getColor();
            (function(rg, region) {
                rg[0].style.cursor = "pointer";
                rg[0].onmouseover = function() {
                    current && nz[current].animate({ fill: "#3f3f40", stroke: "#666" }, 500) && (document.getElementById(current).style.display = "");
                    rg.animate({ fill: rg.color, stroke: "#ccc" }, 500);
                    rg.toFront();
                    R.safari();
                    document.getElementById(region).style.display = "block";
                    current = region;
                };
                rg[0].onclick = function() {
                    alert("IE never gets this far.");
                    //window.location.href = "my-page.aspx?District=" + region;
                };
                rg[0].onmouseout = function() {
                    rg.animate({ fill: "#3f3f40", stroke: "#666" }, 500);
                };
                if (region == "northland") {
                    rg[0].onmouseover();
                }
            })(nz[region], region);
        }
    };
</script> 
```

非常感谢 ：）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-29T20:33:17.037

该修复似乎使用 onmousedown 事件而不是 onclick。

改变：

```
rg[0].onclick = function() {
alert("IE never gets this far, but Firefox is happy.");
}; 
```

到

```
rg[0].onmousedown = function() {
alert("This works in IE and Firefox.");
}; 
```

解决了这个问题。感谢大家的投入 - 最后到达那里。如果有人真的知道为什么 IE 不喜欢**onclick**，我很想听听！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-29T20:24:31.753

您是否尝试过附加事件？

```
if (rg[0].attachEvent)
    rg[0].attachEvent("onclick", function(){ /* IE */ });
else
    rg[0].addEventListener("click", function(){ /* other */ }, false); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-29T20:25:08.587

IE 并不完全以正常工作而闻名。如果您提到您使用的是哪个 IE 版本，将会有所帮助。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-30T06:00:07.907

通常一个抽象框架，如 jquery 或原型是你最好的选择。他们为您处理浏览器差异。此外，您可以在更高级别订阅您的事件......在浏览器中订阅 mousemove/click 并确定您结束了什么，或者从事件气泡中单击比许多对象更便宜。

Joel Potter 提到了订阅者模型，使用 dom 和 IE 方法，这比方法分配更好。

# c# - 在列表框中搜索

> ID：695269
> 
> 赞同：2
> 
> 时间：2009-03-29T20:05:36.370
> 
> 标签：c#, .net, winforms, search, listbox

你好

我正在尝试将一个文本框放在一个列表框中进行搜索。我有一个 TextBox: SearchText 与此代码：

```
 private void SearchText_TextChanged(object sender, EventArgs e)
 {
    int i = listBox3.FindString(SearchText.Text);
    listBox3.SelectedIndex = i;
 } 
```

和加载时的列表框我有这个代码

```
List<string> str = GetListOfFiles(@"D:\\Music\\massive attack - collected");        
listBox3.DataSource = str;
listBox3.DisplayMember = "str"; 
```

在 selectedIndexChanged 上：

```
private void listBox3_SelectedIndexChanged(object sender, EventArgs e)
{
    player1.URL = listBox3.SelectedItem.ToString(); // HERE APPEAR THE ERROR "Object reference not set to an instance of an object."

    //  provaTxt.Text = listBox3.SelectedValue.ToString();
} 
```

当我在 SeachText 中写下以查找歌曲时，我在 ListBox 的 selectedIndexChanged 行中收到错误（“对象引用未设置为对象的实例。”）。作为我的情况，您知道在 listBox 中查找的另一种方法吗？谢谢你的分享。很好的问候

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-29T20:08:57.393

听起来好像没有找到该项目，所以`SelectedItem`是空的；尝试使用：

```
player1.URL = Convert.ToString(listBox3.SelectedItem); 
```

我相信这可以处理 null 情况（或者，首先测试 null ）。

我也很想查看基础列表：

```
List<string> items = (List<string>)listbox3.DataSource;
listbox3.SelectedIndex = items.FindIndex(s => s.StartsWith(searchFor)); 
```

* * *

例如：

```
using System;
using System.Collections.Generic;
using System.Windows.Forms;
class MyForm : Form
{
    [STAThread]
    static void Main()
    {
        Application.EnableVisualStyles();
        Application.Run(new MyForm());
    }

    ListBox listbox;
    TextBox textbox;
    CheckBox multi;
    public MyForm()
    {
        textbox = new TextBox { Dock = DockStyle.Top };
        List<string> strings = new List<string> { "abc", "abd", "abed", "ab" };
        listbox = new ListBox { Dock = DockStyle.Fill, DataSource = strings };
        textbox.KeyDown += textbox_KeyDown;
        Controls.Add(listbox);
        Controls.Add(textbox);
        listbox.SelectedIndexChanged += listbox_SelectedIndexChanged;
        listbox.SelectionMode = SelectionMode.MultiExtended;
        multi = new CheckBox { Text = "select multiple", Dock = DockStyle.Bottom };
        Controls.Add(multi);
    }

    void listbox_SelectedIndexChanged(object sender, EventArgs e)
    {
        Text = Convert.ToString(listbox.SelectedItem);
    }

    void textbox_KeyDown(object sender, KeyEventArgs e)
    {
        if (e.KeyCode == Keys.Return)
        {
            string searchFor = textbox.Text;
            List<string> strings = (List<string>)listbox.DataSource;
            if (multi.Checked)
            {
                for (int i = 0; i < strings.Count; i++)
                {
                    listbox.SetSelected(i, strings[i].Contains(searchFor));
                }
            }
            else
            {
                listbox.ClearSelected();
                listbox.SelectedIndex = strings.FindIndex(
                    s => s.Contains(searchFor));
            }
        }
    }
} 
```

# php - 不能简单地使用 PostgreSQL 表名（“关系不存在”）

> ID：695289
> 
> 赞同：259
> 
> 时间：2009-03-29T20:16:21.820
> 
> 标签：php, sql, postgresql, quoted-identifier

我正在尝试运行以下 PHP 脚本来执行简单的数据库查询：

```
$db_host = "localhost";
$db_name = "showfinder";
$username = "user";
$password = "password";
$dbconn = pg_connect("host=$db_host dbname=$db_name user=$username password=$password")
    or die('Could not connect: ' . pg_last_error());

$query = 'SELECT * FROM sf_bands LIMIT 10';
$result = pg_query($query) or die('Query failed: ' . pg_last_error()); 
```

这会产生以下错误：

> 查询失败：错误：关系“sf_bands”不存在

在所有示例中，我都可以找到有人收到错误说明关系不存在的地方，这是因为他们在表名中使用了大写字母。我的表名没有大写字母。有没有办法在不包括数据库名称的情况下查询我的表，即`showfinder.sf_bands`？

* * *

## 回答 #1

> 赞同：395
> 
> 时间：2009-03-29T20:25:59.927

根据我的阅读，此错误意味着您没有正确引用表名。一个常见的原因是该表是用混合大小写的拼写定义的，而您尝试使用全部小写来查询它。

换句话说，以下失败：

```
CREATE TABLE "SF_Bands" ( ... );

SELECT * FROM sf_bands;  -- ERROR! 
```

使用双引号分隔标识符，以便您可以在定义表时使用特定的混合大小写拼写。

```
SELECT * FROM "SF_Bands"; 
```

* * *

关于您的评论，您可以将架构添加到“search_path”，这样当您引用表名而不限定其架构时，查询将通过按顺序检查每个架构来匹配该表名。就像`PATH`在 shell 或`include_path`PHP 等中一样。您可以检查您当前的模式搜索路径：

```
SHOW search_path
  "$user",public 
```

您可以更改架构搜索路径：

```
SET search_path TO showfinder,public; 
```

另见[http://www.postgresql.org/docs/8.3/static/ddl-schemas.html](http://www.postgresql.org/docs/8.3/static/ddl-schemas.html)

* * *

## 回答 #2

> 赞同：91
> 
> 时间：2012-09-03T15:35:03.777

我对此有疑问，这就是故事（可悲但真实）：

1.  如果您的表名都是小写的，例如：您可以使用的帐户：`select * from AcCounTs`它会正常工作

2.  如果您的表名都是小写的，例如：`accounts` 以下将失败： `select * from "AcCounTs"`

3.  如果您的表名混合大小写，例如：`Accounts` 以下将失败： `select * from accounts`

4.  如果您的表名混合大小写，例如：`Accounts` 以下将正常工作： `select * from "Accounts"`

我不喜欢记住这样无用的东西，但你必须；）

* * *

## 回答 #3

> 赞同：24
> 
> 时间：2012-07-10T20:10:01.303

Postgres 处理与其他 RDMS 不同的查询。将架构名称放在表名之前的双引号中，如下所示，“SCHEMA_NAME”。“SF_Bands”

* * *

## 回答 #4

> 赞同：22
> 
> 时间：2011-03-03T18:38:00.763

将 dbname 参数放在连接字符串中。它对我有用，而其他一切都失败了。

此外，在进行选择时，请指定`your_schema`. `your_table`像这样：

```
select * from my_schema.your_table 
```

* * *

## 回答 #5

> 赞同：14
> 
> 时间：2015-02-05T14:13:12.467

我在 OSX 上遇到了类似的问题，但尝试使用双引号和单引号。对于您的情况，您可以尝试这样的事情

```
$query = 'SELECT * FROM "sf_bands"'; // NOTE: double quotes on "sf_Bands" 
```

* * *

## 回答 #6

> 赞同：10
> 
> 时间：2019-09-06T07:38:30.630

您必须在引号中写入模式名​​称和表名称。如下：

```
select * from "schemaName"."tableName"; 
```

* * *

## 回答 #7

> 赞同：10
> 
> 时间：2020-09-19T03:27:27.253

如果表名包含下划线或大写，则需要用双引号将其括起来。

```
SELECT * from "Table_Name"; 
```

* * *

## 回答 #8

> 赞同：8
> 
> 时间：2018-06-16T07:29:44.207

这真的很有帮助

```
SET search_path TO schema,public; 
```

我更深入地挖掘了这个问题，并了解了如何通过默认设置为当前数据库中的新用户设置这个“search_path”。

打开数据库属性，然后打开工作表“变量”并简单地为您的用户添加这个具有实际值的变量。

因此，现在您的用户将通过默认获取此 schema_name，您可以使用不带 schemaName 的 tableName。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2016-04-05T15:30:39.887

对我来说，问题是，我在初始化 Django 时使用了对该特定表的查询。当然它会抛出一个错误，因为那些表不存在。就我而言，它是`get_or_create`admin.py 文件中的一个方法，每当软件运行任何类型的操作（在本例中为迁移）时都会执行该方法。希望对某人有所帮助。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2021-01-26T15:14:50.897

我遇到了与上面相同的问题，我使用的是 PostgreSQL 10.5。我尝试了上述所有方法，但似乎没有任何效果。

然后我关闭了 pgadmin 并为 PSQL 终端打开了一个会话。登录到 PSQL 并分别连接到数据库和模式：

```
\c <DATABASE_NAME>;
set search_path to <SCHEMA_NAME>; 
```

然后，重新启动 pgadmin 控制台，然后我可以在 pagadmin 的查询工具中正常工作。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2021-06-09T22:04:05.533

除了[比尔卡尔文的](https://stackoverflow.com/a/695312/10795605)回答=>

是的，您应该用`double quotes`. 但是，请注意，很可能 php**不允许**您简单地编写：

```
$query = "SELECT * FROM "SF_Bands""; 
```

相反，您应该使用`single quotes`while 包围**查询**，如[sav 所说](https://stackoverflow.com/a/28346193/10795605)。

```
$query = 'SELECT * FROM "SF_Bands"'; 
```

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2020-05-07T05:59:12.743

最简单的解决方法是将表名和所有列名更改为**小写**，您的问题将得到解决。

例如：

*   更改`Table_Name`为`table_name` 和
*   更改`ColumnName`为`columnname`

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2020-04-26T16:34:52.470

您必须先添加架构，例如

```
SELECT * FROM place.user_place; 
```

如果您不想在所有查询中添加它，请尝试以下操作：

```
SET search_path TO place; 
```

现在它将起作用：

```
SELECT * FROM user_place; 
```

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2021-05-19T11:41:05.340

对一些人来说可能很傻，但就我而言 - 一旦我创建了表，我就可以在同一个会话中查询表，但是如果我使用新会话重新登录`table does not exits`。

然后我`commit`在创建表后使用，现在我也可以在新会话中查找和查询表。像这样：

```
select * from my_schema.my_tbl; 
```

希望这会对一些人有所帮助。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2021-10-03T22:33:31.470

确保表名不包含任何尾随空格

[![在此处输入图像描述](https://i.stack.imgur.com/1dRpA.png)](https://i.stack.imgur.com/1dRpA.png)

# ruby - 如何在 Ruby 中返回数组的一部分？

> ID：695290
> 
> 赞同：149
> 
> 时间：2009-03-29T20:16:23.710
> 
> 标签：ruby, arrays, list, slice

使用 Python 中的列表，我可以使用以下代码返回其中的一部分：

```
foo = [1,2,3,4,5,6]
bar = [10,20,30,40,50,60]
half = len(foo) / 2
foobar = foo[:half] + bar[half:] 
```

由于 Ruby 在数组中做所有事情，我想知道是否有类似的东西。

* * *

## 回答 #1

> 赞同：232
> 
> 时间：2009-03-29T20:23:33.053

是的，Ruby 的数组切片语法与 Python 非常相似。这是`ri`数组索引方法的文档：

```
--------------------------------------------------------------- Array#[]
     array[index]                -> obj      or nil
     array[start, length]        -> an_array or nil
     array[range]                -> an_array or nil
     array.slice(index)          -> obj      or nil
     array.slice(start, length)  -> an_array or nil
     array.slice(range)          -> an_array or nil
------------------------------------------------------------------------
     Element Reference---Returns the element at index, or returns a 
     subarray starting at start and continuing for length elements, or 
     returns a subarray specified by range. Negative indices count 
     backward from the end of the array (-1 is the last element). 
     Returns nil if the index (or starting index) are out of range.

        a = [ "a", "b", "c", "d", "e" ]
        a[2] +  a[0] + a[1]    #=> "cab"
        a[6]                   #=> nil
        a[1, 2]                #=> [ "b", "c" ]
        a[1..3]                #=> [ "b", "c", "d" ]
        a[4..7]                #=> [ "e" ]
        a[6..10]               #=> nil
        a[-3, 3]               #=> [ "c", "d", "e" ]
        # special cases
        a[5]                   #=> nil
        a[6, 1]                #=> nil
        a[5, 1]                #=> []
        a[5..10]               #=> [] 
```

* * *

## 回答 #2

> 赞同：30
> 
> 时间：2014-02-13T05:23:03.320

如果要在索引 i 上拆分/剪切数组，

```
arr = arr.drop(i)

> arr = [1,2,3,4,5]
 => [1, 2, 3, 4, 5] 
> arr.drop(2)
 => [3, 4, 5] 
```

* * *

## 回答 #3

> 赞同：18
> 
> 时间：2009-03-29T20:20:26.507

您可以为此使用[slice()](http://www.ruby-doc.org/core/classes/Array.html#M002228)：

```
>> foo = [1,2,3,4,5,6]
=> [1, 2, 3, 4, 5, 6]
>> bar = [10,20,30,40,50,60]
=> [10, 20, 30, 40, 50, 60]
>> half = foo.length / 2
=> 3
>> foobar = foo.slice(0, half) + bar.slice(half, foo.length)
=> [1, 2, 3, 40, 50, 60] 
```

顺便说一句，据我所知，Python“列表”只是有效地实现了动态增长的数组。开头插入是O(n)，最后插入是分期O(1)，随机访问是O(1)。

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2020-06-15T03:00:01.583

Ruby 2.6 Beginless/Endless Ranges

```
(..1)
# or
(...1) 
```

```
(1..)
# or
(1...) 
```

```
[1,2,3,4,5,6][..3]
=> [1, 2, 3, 4]

[1,2,3,4,5,6][...3]
 => [1, 2, 3] 
```

```
ROLES = %w[superadmin manager admin contact user]
ROLES[ROLES.index('admin')..]
=> ["admin", "contact", "user"] 
```

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2015-01-30T12:06:03.040

另一种方法是使用范围方法

```
foo = [1,2,3,4,5,6]
bar = [10,20,30,40,50,60]
a = foo[0...3]
b = bar[3...6]

print a + b 
=> [1, 2, 3, 40, 50 , 60] 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2018-03-23T19:26:39.827

我喜欢这个范围：

```
def first_half(list)
  list[0...(list.length / 2)]
end

def last_half(list)
  list[(list.length / 2)..list.length]
end 
```

但是，要非常小心端点是否包含在您的范围内。这在一个奇数长度的列表中变得至关重要，您需要选择在哪里打破中间。否则你最终会重复计算中间元素。

上面的示例将始终将中间元素放在后半部分。

# javascript - 你推荐哪个 ajax 脚本库？

> ID：695294
> 
> 赞同：-1
> 
> 时间：2009-03-29T20:18:11.973
> 
> 标签：javascript, ajax

现在有很多 JavaScript 库（extJs、Scriptaculous、Dojo、prototype、Solvent 等等）。找不到任何比较利弊的网站。

有人可以提出建议吗？需要考虑的事项： - 大小 - 性能 - 跨平台 - 易用性和文档 - （在 python/Django 中开发时使用特定的特殊原因？）

谢谢！亚尼夫

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-29T20:28:12.713

jQuery 非常好，而且可能是最常见的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-29T21:13:45.647

jQuery 是目前最流行的，而且有充分的理由！

*   它非常轻巧。简化版只有 19kb。

*   您可以使用[google 托管的 jQuery](http://code.google.com/apis/ajaxlibs/documentation/index.html#jquery)来提高速度，（使用它有可能您的用户已经缓存了它）。

*   It (almost always) works the same in all browsers, stopping the need for a lot of the previously hated cross-browser development testing.

*   It is based on CSS which is familiar with web designers.

*   It uses CSS3 componenets.

*   It has a HUGE number of plugins available from the community. It is also easy to write your own.

*   It is used by some massive web companies. StackOverflow, digg, Dell, Google etc.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-29T20:24:44.327

不要忘记 jQuery
我认为它更像是跨浏览器而不是跨平台。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-29T20:47:18.220

在我看来，选择框架时要考虑的最重要的事情是编码风格。每个框架都做大致相同的事情，但方式不同。

我的建议是选择对你最有意义的一个。每个框架的大小、性能和浏览器兼容性都差不多。

您可能还想查看 Wikipedia 上的“ [JavaScript 框架比较](http://en.wikipedia.org/wiki/Comparison_of_JavaScript_frameworks)”，了解有关每个框架的一些技术细节。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-29T20:52:43.763

我必须同意上述（即 jQuery）——但也推荐[Prototype](http://www.prototypejs.org)

Prototype 是一个干净、简单、轻量级的 JavaScript 引擎，它与服务器端语言无关。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-29T21:28:26.750

My answer to a very similar question:

Jquery

*   Fast
*   Well documented
*   Easy to use
*   Chaining
*   Unlike prototype it doesn't extend an object if you didn't specifically ask for it (try looping an array in prototype)
*   easy-to-use AJAX (I love the $.ajaxSetup() function)
*   Nice Event handlers
*   CSS selectors
*   filtering your selection
*   did I mention chaining?
*   Small (only 30kb)
*   Nice little build-in effects.
*   Plugins

([https://stackoverflow.com/questions/394601/which-javascript-framework-jquery-vs-dojo-vs/394837#394837](https://stackoverflow.com/questions/394601/which-javascript-framework-jquery-vs-dojo-vs/394837#394837))

# php - 使用 file_get_contents() 加载远程 xml 页面

> ID：695296
> 
> 赞同：12
> 
> 时间：2009-03-29T20:18:58.990
> 
> 标签：php, xml, file-get-contents

我在网上看到一些类似的问题，没有答案。

我想将远程 XML 页面的源返回到字符串中。就本问题而言，远程 XML 页面是：

```
http://www.test.com/foo.xml 
```

在普通的网络浏览器中，我可以查看页面并且源是 XML 文档。但是，当我使用`file_get_contents('http://www.test.com/foo.xml')`时，它会返回一个带有相应 URL 的字符串。

是否有检索 XML 组件？我不在乎它是否使用 file_get_contents，只要它会起作用。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-03-29T20:33:58.177

您需要在服务器中设置 allow_url_fopen 才能使其正常工作。

如果你不这样做，那么你可以使用这个函数作为替代：

```
<?php
function curl_get_file_contents($URL)
    {
        $c = curl_init();
        curl_setopt($c, CURLOPT_RETURNTRANSFER, 1);
        curl_setopt($c, CURLOPT_URL, $URL);
        $contents = curl_exec($c);
        curl_close($c);

        if ($contents) return $contents;
            else return FALSE;
    }
?> 
```

[从这里](http://ar2.php.net/manual/es/function.file-get-contents.php#82255)借来的。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-03-29T20:33:45.820

这似乎很奇怪。file_get_contents() 是否为其他站点（不仅是 XML）返回任何有效数据？[如果fopen-wrappers](http://se.php.net/manual/en/filesystem.configuration.php#ini.allow-url-fopen)已启用（默认情况下），则URL 只能用作文件名参数。

我猜你稍后会处理检索到的 XML - 然后你应该能够使用 simplexml_load _file() 直接将它加载到[SimpleXml中。](http://php.net/simplexml)

```
try {
   $xml = simplexml_load_file('http://www.test.com/foo.xml');
   print_r($xml);
} ... 
```

我推荐使用 SimpleXML 来读取 XML 文件，它非常容易使用。

# batch-file - write a batch file to add aworkstation in to adomine and add the DNS and WINS ipaddress to that

> ID：695297
> 
> 赞同：0
> 
> 时间：2009-03-29T20:19:01.673
> 
> 标签：batch-file

I want to write a batch file to add a workstation into domine and assign the DNS ,WINS , and static ip address to that workstation.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-20T05:59:18.573

In order to join a workstation to the domain, you can use the "netdom" utility included with resource kits and support tools. For example, for Windows XP SP2 & SP3 [download](http://www.microsoft.com/downloads/details.aspx?FamilyId=49AE8576-9BB9-4126-9761-BA8011FABF38&displaylang=en)

Then issue the following command. NETDOM /Domain:MYDOMAIN /user:adminuser /password:apassword MEMBER MYCOMPUTER /JOINDOMAIN

For modifying network settings, use the "netsh" command. Here is an example of setting a static IP:

```
netsh int ip add address name="Local Area Connection" 192.168.1.101 255.255.255.224 gateway=192.168.1.1 
```

And for DNS:

```
netsh int ip add dns name="Local Area Connection" 208.67.220.220
netsh int ip add dns name="Local Area Connection" 208.67.222.222 index=2 
```

And finally for WINS:

```
netsh int ip set winsservers "Local Area Connection" static 10.0.0.1 
```

# java - 一般递归自类型的值的Java字段类型？

> ID：695298
> 
> 赞同：4
> 
> 时间：2009-03-29T20:19:02.033
> 
> 标签：java, generics, visitor-pattern, self-type

给定一个基类定义递归自类型的类层次结构：

```
abstract class A<T extends A<T>> { } 
```

我如何声明另一个类（它在 T 中不应该是通用的，因为这样的 T 可能在对象的生命周期内变化）具有可以包含 A 的任何子类的字段？

以下不起作用：

```
public class B {
    //fails to compile, because the capture of ? is not sufficiently narrow
    private A<?> a;

    public <T extends A<T>> setA(T a) {
        this.a = a;
    }
} 
```

-- 问题结束 --

我注意到许多 StackOverflow 成员倾向于用“你为什么首先这样做？”来解决某些难题。以下是我使用这种模式的理由——您可以注意到 Java 标准库在其 Enum 类的定义中也使用了递归自类型：`Enum<E extends Enum<E>>`. 这个问题可以类似地被问为“如何定义类型的字段`Enum<?>`。

理由示例：

```
abstract class A<T extends A<T>> {
    public abtract T self();
    public B<T> bify(Bifyer bifyer) {
        return bifyer.bify(self());
    }
} 
```

与子类：

```
class ASub1 extends A<ASub1> { 
    public ASub1 self() { return this; }
}       

class ASub2 extends A<ASub2> { 
    public ASub2 self() { return this; }
} 
```

绑定到并行类层次结构：

```
abstract class B<T extends A<T>> {
}

class BSub1<T extends A<T>> implements B<T> { }
class BSub2<T extends A<T>> implements B<T> { }
//and others 
```

并且随着 Bifyer 接口的实现管理的 B 实例的生成：

```
interface Bifyer {
    B<ASub1> bify(ASub1 asub1);
    B<ASub2> bify(ASub2 asub2);        
} 
```

此接口的实现可能会为 B 返回 BSub1 或 BSub2。这本质上是访问者模式的应用程序，其中 Bifyer 是访问者，但与标准访问者不同，accept 方法返回一个值而不是 void。这提供了一个模块化框架，其中可以指定不同的 Bifyer 实现来为 Bify 方法提供替代行为和返回类型 - 例如为 B 的每个子类提供一个。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-29T20:27:38.423

如果你用 绑定`?`下面的通配符`A`，它​​应该可以工作：

```
public class B {
    private A<? extends A> a;

    public <T extends A<T>> void setA(T a) {
        this.a = a;
    }
} 
```

# amazon - 建立亚马逊附属链接

> ID：695303
> 
> 赞同：19
> 
> 时间：2009-03-29T20:21:12.840
> 
> 标签：amazon

如何在不使用亚马逊在线工具的情况下从常规链接生成亚马逊附属链接（使用我的跟踪 ID）？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-02-25T12:23:48.820

本质上替换此 URL 中的 ASIN 和 trackingId：

`http://www.amazon.com/dp/{ASIN}/?tag={trackingId}`

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-03-30T03:21:54.233

这是一个[简单的教程](http://www.askdavetaylor.com/how_do_i_quickly_build_amazon_affiliate_links_on_my_pages.html)，可以帮助您入门。[亚马逊的这个页面](https://affiliate-program.amazon.com/gp/associates/help/t5/a16)应该填补一些关于 ASIN 的空白，尤其是标题为“如果我有 13 位 ISBN，是否有自动创建关联链接的方法？”的部分。这是[另一篇相关文章](http://crazybob.org/2008/10/how-to-create-simple-amazon-affiliate.html)。

您并不太具体说明要如何生成它们或将生成多少，但有一个由[Eri Robillard编写的](http://www.erobillard.com)[在线工具](http://www.erobillard.com/snippets/amazonlink.aspx)，它使用 WebForms 和 XML Web Services。如果您想手工制作少量链接，它看起来是一个不错的工具。 如果您希望以编程方式生成它们，您可能可以从他那里获得许可以截取他的网站，或者他可能会为您提供源代码。我找不到他对其使用施加的限制（如果有的话）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-15T12:36:58.443

[有人在我的帖子](https://stackoverflow.com/questions/12159775/create-link-with-amazon-asin-number-to-link-the-right-country-e-g-amazon-com)中提到了一种简单的方法。

他告诉我使用一个名为`asin.info`转发您的合作伙伴 ID 的简单重定向服务。您可以轻松地在网页上生成链接，或者只使用以下语法：

> `http://asin.info/{asincode}/{partnerid}`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-29T20:33:50.610

虽然我没有答案，但一个好的开始是将来自跟踪工具的附属链接的元素与项目页面上的标识符进行比较。

据我所知，每个亚马逊产品都有一个唯一标识符（书籍的 ISBN），这个标识符以及您的跟踪 ID 都存储在附属链接中。

对格式进行逆向工程应该相当简单。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-04-19T09:38:38.683

[Affiliaters.in](https://www.affiliaters.in)为您提供该功能的站点。

如果您是会员，而不仅仅是在注册时输入您的亚马逊 aff_id 并粘贴链接，则没有其他 aff_id 或与其他 aff_id。该站点将自动删除其他人的 aff_id 并放入您的。

不仅如此，它还为您缩短了链接

[![在此处输入图像描述](https://i.stack.imgur.com/msYJX.png)](https://i.stack.imgur.com/msYJX.png)

# ruby - Should I learn MacRuby or RubyCocoa

> ID：695304
> 
> 赞同：16
> 
> 时间：2009-03-29T20:21:55.880
> 
> 标签：ruby, macos, macruby, ruby-cocoa

I am wanting to learn mac development with ruby but I'm not sure which one to go at. RubyCocoa has been around longer but I think MacRuby will beat it out in the long run..

Any suggestions??

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2009-03-29T20:31:15.920

Go with MacRuby. It's the future :)

It's newer, way faster, and much better integrated. HotCocoa is awesome as well.

MacRuby is a Ruby VM implemented on top of Apple Technologies as opposed to a bridge like RubyCocoa. A Ruby String for example is an NSString by nature, instead of being bridged by the runtime. It's a much cleaner, faster and more solid approach. It's also developed and sponsored by Apple, which means it could become part of OS X at some point.

Also see this post: [Why MacRuby Matters](http://antoniocangiano.com/2009/03/29/why-macruby-matters)

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-10-10T20:20:25.763

Since Chuck replied to you, things changed quite a lot, MacRuby now uses LLVM, allows for AOT compilation and is quite stable and much faster than it used to be. The ruby side of things still need some work for be 100% compatible but as I'm writing this response, 0.5 is still in beta and you should see ruby libraries being compatible very quickly.

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-03-29T20:50:50.833

RubyCocoa 更加成熟并且经过更好的测试。MacRuby 更简单，整体设计更好。MacRuby 也与坐在沙滩球上的草坪椅一样稳定。严重地。从长远来看，它绝对是您想要使用的那个，但它还没有。它们并没有太大的不同，以至于您必须“学习”一个与另一个。它们都是可以访问 Cocoa API 的 Ruby。了解 Cocoa API 比其他任何事情都重要。

我建议使用 Objective-C 学习 Cocoa。一旦你很好地掌握了框架的核心概念（都是基于 Objective-C 的），那么如果你仍然想使用 Ruby，你就可以使用 Ruby。

## 2011 年更新

上述情况不再适用于 MacRuby。它非常稳定和快速，足以在纯 Ruby 中完成大多数类型的 Cocoa 应用程序。MacRuby 团队也竭尽全力兼容几乎所有的系统框架，甚至包括 C 框架。如果你喜欢 Ruby 并想做 Mac 开发，那绝对是值得考虑的事情。没有理由再选择 RubyCocoa，除非您需要支持旧版本的 OS X 或 PowerPC（MacRuby 严格来说是 Intel 10.5+）。剩下的注意事项：

*   必须在您的应用程序中包含 MacRuby.framework 会降低捆绑包大小的上限（“Hello World”IIRC 需要几十 MB）

*   虽然它总体上是稳定的，但它仍然是非常新的测试版软件，所以在库的较少使用的角落有一些皱纹（例如指针有一些怪癖），并且一些设计决策不是最终的（例如并发支持是发展迅速）

*   该文档仍在进行中，并且落后于快速发展的语言。您会发现很多关于 MacRuby 的文章都表明，HotCocoa 是制作应用程序的一种很酷的原生方式——它是一个很酷的实验，但它现在已被废弃，存在一些使其不适合大规模应用程序开发的关键缺陷。标准的 Xcode 工具链是进行 MacRuby 开发的受支持方式。

我还推荐使用 Objective-C 学习 Cocoa，因为那是框架的原生语言，因此阻力最小。

# php - Socket not working PHP

> ID：695305
> 
> 赞同：1
> 
> 时间：2009-03-29T20:22:48.733
> 
> 标签：php, sockets

Here is my code

```
<?php
error_reporting(E_ALL);

/* Allow the script to hang around waiting for connections. */
set_time_limit(0);

/* Turn on implicit output flushing so we see what we're getting
 * as it comes in. */
ob_implicit_flush();

$address = 'localhost';
$port = 10000;

if (($sock = socket_create(AF_INET, SOCK_STREAM, SOL_TCP)) === false) {
    echo "socket_create() failed: reason: " . socket_strerror(socket_last_error()) . "\n";
}

if (socket_bind($sock, $address, $port) === false) {
    echo "socket_bind() failed: reason: " . socket_strerror(socket_last_error($sock)) . "\n";
}

if (socket_listen($sock, 5) === false) {
    echo "socket_listen() failed: reason: " . socket_strerror(socket_last_error($sock)) . "\n";
}

do {
    if (($msgsock = socket_accept($sock)) === false) {
        echo "socket_accept() failed: reason: " . socket_strerror(socket_last_error($sock)) . "\n";
        break;
    }
do {
    $out = socket_read($msgsock, 2048);

    if (!empty($out)) {
        if ($out == 'quit') {
            break;
        }
        elseif ($out == 'shutdown') {
            socket_write($msgsock, 'plc down', 8);
            socket_close($msgsock);
            break 2;
        }
        else {
            switch ($out) {
                case "KABBE": $response = "Kabbe te!"; break;
                case "SZOPJ": $response = "Szopjal te!"; break;
                default: $response = "Ismeretlen parancs";
            }
            socket_write($msgsock, $response, strlen($response));
            break;
        }
    }
    } while (true);
socket_close($msgsock);
} while (true);

socket_close($sock);
?> 
```

and now the errors

```
Warning: socket_bind() [function.socket-bind]: unable to bind address [0]: Only one usage of each socket address (protocol/network address/port) is normally permitted. in C:\wamp\www\socket\socket.php on line 18
socket_bind() failed: reason: Only one usage of each socket address (protocol/network address/port) is normally permitted.
Warning: socket_listen() [function.socket-listen]: unable to listen on socket [0]: An invalid argument was supplied. in C:\wamp\www\socket\socket.php on line 22
socket_listen() failed: reason: An invalid argument was supplied.
Warning: socket_accept() [function.socket-accept]: unable to accept incoming connection [0]: An invalid argument was supplied. in C:\wamp\www\socket\socket.php on line 27
socket_accept() failed: reason: An invalid argument was supplied. 

```

I searched on google but nothing useful. What is the problem?

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-29T21:11:59.643

PHP 还提供了[stream_socket_server](http://php.net/manual/en/function.stream-socket-server.php)和其他 stream_socket_* 函数。
我发现这些对开发人员更友好。

来自 php.net 的示例代码：

```
$socket = stream_socket_server("tcp://localhost:8000", $errno, $errstr);
if (!$socket) {
  echo "$errstr ($errno)<br />\n";
} else {
  while ($conn = stream_socket_accept($socket)) {
    fwrite($conn, 'The local time is ' . date('n/j/Y g:i a') . "\n");
    fclose($conn);
  }
  fclose($socket);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-29T20:30:02.333

'localhost' isn't a valid address as socket_bind doesn't accept DNS names, use the equivalent IP address '127.0.0.1'.

[More info](http://www.php.net/socket_bind)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-29T20:29:43.910

That means you already have an open socket on your computer on that port.

Try switching to another unused port.

On Windows (which is what you seem to be working on), you can see the list of open sockets from the command line:

```
netstat -an 
```

If you want to know which processes are listening to those ports, try this instead:

```
netstat -ban 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-04-16T19:00:47.643

绑定前使用此代码：

```
if (!socket_set_option($socket, SOL_SOCKET, SO_REUSEADDR, 1)) {
    echo socket_strerror(socket_last_error($socket));
    exit;
} 
```

供参考[http://www.php.net/manual/en/function.socket-bind.php](http://www.php.net/manual/en/function.socket-bind.php)

您也可以查看[http://www.php.net/manual/en/function.socket-set-option.php](http://www.php.net/manual/en/function.socket-set-option.php)了解详情

# iphone - 如何释放 MPMoviePlayerController？

> ID：695307
> 
> 赞同：26
> 
> 时间：2009-03-29T20:23:46.373
> 
> 标签：iphone, memory-management, mpmovieplayercontroller

我有几个访问电影播放器​​的视图。对于这些视图，我已将以下代码放入 AppDelegate 的方法中。他们发送文件名进行播放。该代码工作正常，但我知道某处需要发布。如果我将最后一行添加为释放或自动释放，一旦用户在电影播放器​​上按下完成，应用程序就会崩溃。

```
MPMoviePlayerController *moviePlayer = [[MPMoviePlayerController alloc] 
                 initWithContentURL:[NSURL fileURLWithPath:moviePath]];
moviePlayer.movieControlMode = MPMovieControlModeDefault;
[moviePlayer play];
//[moviePlayer release]; 
```

我收到此错误：

objc[51051]: FREED(id): message videoViewController发送到释放对象=0x1069b30

节目接收信号：“EXC_BAD_INSTRUCTION”。

我应该如何释放播放器？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-03-29T23:09:11.563

我发现必须先向 MPMoviePlayerController 发送停止消息，然后才能安全地释放它。所以我在 handlePlaybackEnd 中执行它——首先我停止它，然后我自动释放它。调用 release 似乎不太好用：

```
- (void) moviePlayBackDidFinish : (NSNotification *) notification
{
  VideoPlayerController * player = notification.object;
  [player stop];
  [player autorelease];
} 
```

整个事情变得有点棘手，因为 MPMoviePlayerPlaybackDidFinishNotification 可以被多次发送，但是两次调用 stop/autolease 对你也没有任何好处。所以你需要以某种方式防范这种情况。

最后，在您可以安全地创建新的 MPMoviePlayerController 实例之前，似乎需要对主运行循环进行几次迭代。如果你做得太快，你会得到声音但没有视频。很好玩吧？

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-08-15T22:47:23.283

要回答 4thSpace 对上述答案的评论，您可以删除通知观察者，这样您就不会多次收到它：

```
- (void)moviePlayBackDidFinish:(NSNotification *)notification {
    MPMoviePlayerController *theMovie = [notification object];
    [[NSNotificationCenter defaultCenter] removeObserver:self
        name:MPMoviePlayerPlaybackDidFinishNotification
        object:theMovie];
    [theMovie stop];
    [theMovie release];
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2010-04-23T08:45:46.760

对于 iphone os 3.2，您需要调用 [moviePlayer pause]；在调用 [moviePlayer stop] 之前；

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2010-02-04T16:35:56.480

如果玩家没有到达终点，停止和释放对我来说是不够的。

我的解决方案是在发布之前将其设置 `moviePlayer.initialPlaybackTime = -1` 为`moviePlayBackDidFinish:`：

```
-(void)playMovie: (NSString *)urlString{ 
    movieURL = [NSURL URLWithString:urlString]; 
    moviePlayer = [[MPMoviePlayerController alloc] initWithContentURL:movieURL]; 
    moviePlayer.initialPlaybackTime = 0; 
    [[NSNotificationCenter defaultCenter] addObserver:self selector:@selector(moviePlayBackDidFinish: ) name:MPMoviePlayerPlaybackDidFinishNotification object:moviePlayer] ;

    moviePlayer.scalingMode = MPMovieScalingModeAspectFit; 
    moviePlayer.movieControlMode = MPMovieControlModeDefault;
    moviePlayer.backgroundColor = [UIColor blackColor];

    [moviePlayer play];
}

-(void)moviePlayBackDidFinish: (NSNotification*)notification{ 
    [[NSNotificationCenter defaultCenter] removeObserver:self name:MPMoviePlayerPlaybackDidFinishNotification object:moviePlayer] ; 

    moviePlayer.initialPlaybackTime = -1; 

    [moviePlayer stop]; 
    [moviePlayer release]; 
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-02-17T12:40:05.077

我遇到了同样的问题，我刚刚意识到我用 object:nil 设置了通知方法（这是一个复制粘贴）。

尽管我根本不应该收到任何通知，但我收到了多个通知。

这是我修复所有的新通知设置代码（请参阅对象：moviePlayer）：

```
[[NSNotificationCenter defaultCenter] addObserver:self 
                           selector:@selector(moviePlaybackDidFinish:) 
                           name:MPMoviePlayerPlaybackDidFinishNotification 
                           object:moviePlayer]; 
```

希望有帮助。现在我所有的代码都可以正常工作。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-09-10T16:42:29.450

这似乎显着减少了内存。但是对于 IOS 4.1 来说似乎还不错。

```
- (void)videoFinishedCallback:(NSNotification *)aNotification
{
    thePlayer = [aNotification object];
    [[NSNotificationCenter defaultCenter]
    removeObserver:self
    name:MPMoviePlayerPlaybackDidFinishNotification object:thePlayer];

    thePlayer.initialPlaybackTime = -1;

    #if __IPHONE_OS_VERSION_MAX_ALLOWED >= 30200
        [thePlayer pause]; 
    #endif

    [thePlayer stop];
    [thePlayer release];    
} 
```

# asp.net - 在 ASP.NET 中自定义 MembershipProvider 有什么优势？

> ID：695309
> 
> 赞同：7
> 
> 时间：2009-03-29T20:24:38.930
> 
> 标签：asp.net

如果我需要实现我自己的`MembershipProvider`类，我必须实现我自己需要的所有服务，那么通过实现`MembershipProvider`派生类与仅仅编写我自己的`MySecurity`类相比，我有什么优势呢？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-29T22:12:30.187

*建立一个正确*的身份验证系统是很困难的，因为构建一个*看似*有效的东西是很容易的。您不希望在部署一年后发现自己的系统在六个月前被破解。

使用模型构建系统`MembershipProvider`通过为您提供一个有助于正确实现的框架来帮助您正确地完成它。您只需要准确填写一组方法，就可以依靠提供的高级架构来确保您在正确的地方使用正确的方法。

*正确*完成各个方法的实现相对容易。您可以将它们放入您的单元测试中，并相信它们会按预期进行。

换句话说，您不必担心是否在正确的位置检查您的身份验证令牌。调用成员资格提供程序的 ASP.Net 部分知道何时执行此操作。您所要做的就是正确实施检查，这通常归结为简单的比较。

此外，您可能不需要从头开始。您必须选择从现有提供者继承，并且只添加您想要但它尚未提供的功能。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-30T01:44:07.820

如果您只需要与默认会员提供程序之一“有点”不同的东西，那么您可能应该考虑从内置提供程序之一或更好的第 3 方提供程序之一继承，并使用您需要的附加功能对其进行扩展或覆盖您要更改的功能。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-29T20:35:23.197

编写自己的 MembershipProvider 类的主要优点是它被 ASP.NET 视为一流的组件，您可以使用标准接口进行身份验证和授权，并且如果您想使用之后只需更改配置文件不同的提供者。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-30T09:05:48.570

从技术上讲，您应该获得一定程度的可移植性 - 通过使用现有模型，您应该能够将您的提供者放入其他 Web 应用程序中，以非常轻松地替换他们的会员系统。

不幸的是，在会员/个人资料方面似乎走自己的路的第 3 方的数量令人印象深刻，而且也相当令人沮丧，尤其是当您付出所有努力基于它编写一些东西时。

话虽如此，通过使用成员资格提供者模型，所有其他使用成员资格的控件“正常工作”（即 Login、LoginStatus、LoginName 等），而无需编写它们的自定义版本。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-29T20:28:00.920

好吧，这取决于...我发现它非常有用，因为我必须添加函数的概念，以便每个角色都有与之关联的函数，等等。

在那种情况下，我实现了自己的 Membership 和 RoleProvider 类，其中包含 AddFunctionToRole 方法...... IsFunctionAssignedToUser 方法......等等

更多关于[这里的信息](http://www.juanformoso.com.ar/post/2008/06/13/Class-Design-Decision.aspx)

# ruby-on-rails - 如何从 text_field 生成的输入中删除 size 属性？

> ID：695313
> 
> 赞同：7
> 
> 时间：2009-03-29T20:26:06.773
> 
> 标签：ruby-on-rails, ruby, forms

我有一个带有表单模板的 .erb 文件，该文件使用`form_for`帮助程序生成表单，并且它们的一些字段是使用`text_field`方法生成的。在生成的 HTML 中，我看到`size`属性被添加到使用上述方法生成的每个输入中。

我想用 CSS 控制输入大小，而该`size`属性阻止我这样做。有没有办法告诉`text_field`方法我不想要它们？

我试图将`:size => nil`作为选项传递给该方法，但这没有帮助。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-11-07T02:01:09.457

这对我有用

```
<%= f.text_field :title, :size => nil %> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-30T03:42:54.540

您可以使用 CSS 或 :size 选项来控制输入字段的大小。我不确定是否有删除 size 属性的选项，我总是忽略它并使用 CSS 设置输入字段的宽度。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-07-09T11:43:54.753

`<%= f.text_field :name, :size => nil, :style => "width: 120px; height: 20px;" %>`. 这将起作用

# javascript - craigslist rss feed

> ID：695316
> 
> 赞同：1
> 
> 时间：2009-03-29T20:27:42.137
> 
> 标签：javascript, jquery, xml, rss

I'm trying to parse the data from a craigslist rss feed.

This is the feed url - [http://www.craigslist.org/about/best/all/index.rss](http://www.craigslist.org/about/best/all/index.rss)

I'm using jfeed and my code is given below

```
jQuery(function() {

    jQuery.getFeed({
        url: 'proxy.php?url=http://www.craigslist.org/about/best/all/index.rss',
        success: function(feed) {        
            jQuery('#result').append('<h2>'
            + feed.title
            + '</h2>');                                

        }    
    });
}); 
```

However, I don't get the feed title displayed or any other property of the feed. If i just try to print out the feed to the screen, I get 'Object Object' which means it correctly returned the feed.

Anybody know what I am missing?

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2011-08-15T16:44:42.467

[第一：由于跨域](http://jimbojw.com/wiki/index.php?title=Introduction_to_Cross-Domain_Ajax)策略，您无法从另一个域获取数据。我不了解 jfeed，但在我的项目中我想出了这个解决方案。使用这个简单的功能，您可以节省一些带宽和代码开销。

**工作示例**

[http://intervisual.de/stackoverflow/fetchxml/index.html](http://intervisual.de/stackoverflow/fetchxml/index.html)

proxy.php（来源：http: [//jquery-howto.blogspot.com/2009/04/cross-domain-ajax-querying-with-jquery.html](http://jquery-howto.blogspot.com/2009/04/cross-domain-ajax-querying-with-jquery.html)）

```
<?php
// Set your return content type
header('Content-type: application/xml');

// Website url to open
$daurl = 'http://www.craigslist.org/about/best/all/index.rss';

// Get that website's content
$handle = fopen($daurl, "r");

// If there is something, read and return
if ($handle) {
    while (!feof($handle)) {
        $buffer = fgets($handle, 4096);
        echo $buffer;
    }
    fclose($handle);
}
?> 
```

**jQuery**

```
$.ajax({
    type: "GET",
    url: "proxy.php",
    dataType: "xml",
    success: parseXml
 });

function parseXml(xml) {
    console.log(xml);
    $(xml).find("item").each(function() {
        var content = $(this).find("title").text()
        $("#news_list").append('<li>' + content +'</li>');
    });
} 
```

**HTML**

```
<div id="news_list"></div> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-01-27T08:27:16.103

或者，您可以使用其他服务来读取 RSS 提要并将其转换为 JSON，如果您无法访问任何服务器端环境，这将非常有用。

为此，我通常使用 YQL，但肯定还有其他服务。

这是一个使用 craigslist 和源代码的工作示例：http: [//jsfiddle.net/soparrissays/NFSaq/2/](http://jsfiddle.net/soparrissays/NFSaq/2/)

# asp.net - Create A Default User for an ASP.NET Application Using Forms Authentication

> ID：695319
> 
> 赞同：0
> 
> 时间：2009-03-29T20:28:38.563
> 
> 标签：asp.net, forms-authentication

I'm creating an ASP.NET web application which I want to secure with Forms Authentication.

When the application is run for the first time, I want it to create a default administrator account so that the owner is able to log in and configure the application.

I managed to get something working for this by running the following method from the Application_Start method:

```
private static void InitializeMembership(MembershipProvider provider)
{
    int total;
    provider.GetAllUsers(0, 1, out total);

    if (total == 0)
    {
        Membership.CreateUser("admin", "admin");
    }
} 
```

The problem is this fails with an error about the chosen password not being secure enough. Normally this would be fine as I do want to enforce a strong password, but in this specific case I want a simple password

Is there a way of disabling the check for just this call, or am I approaching the whole problem incorrectly?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-29T20:34:01.560

I would ship the DATABASE with the admin user in there by default, and force that password to get changed on the first login.

This is helpful in two ways: 1) You know that the default admin will always be there 2) you don't have to maintain that user creation code that will only run at very random intervals.

Alternatively, you could make your default password be more complex.

# sql - 我应该使用没有 GUID 的自然身份列吗？

> ID：695325
> 
> 赞同：0
> 
> 时间：2009-03-29T20:32:57.460
> 
> 标签：sql, primary-key

可以用 2 个外键列定义表主键，这些列的组合必须是唯一的吗？因此不添加新的 id 列（Guid 或 int）？

这有负面影响吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-29T20:37:54.937

是的，完全没问题。为什么不？复合主键的缺点是它可能很长，并且从应用程序的角度可能更难唯一地识别单个行。但是，对于几个整数列（特别是在联结表中），这是一个很好的做法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-29T20:45:44.793

自然主键与人工主键是引起广泛争论的问题之一，恕我直言，讨论似乎只是让立场变得更加坚定。

在我看来，只要开发人员知道如何避免两者的缺点，两者都可以工作。自然主键（无论是复合列还是单列）更接近于确保不会将重复行添加到数据库中。而使用人工主键时，必须首先检查记录是否唯一（与人工主键相反，主键始终是唯一的）。实现此目的的一种有效方法是在使记录唯一的字段上具有唯一或候选索引（例如，使主键候选的字段）

同时人工主键便于加入。可以使用单个字段到单个字段连接来建立关系。使用复合键，SQL 语句的编写者必须知道要在连接中包含多少字段。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-29T20:39:00.130

对于“ok”的一些定义，是的。只要您从不打算向此交集表添加其他字段，就可以了。但是，如果您打算拥有更多字段，最好使用 ID 字段。想想还是不错的，但可能会更尴尬。

当然，除非磁盘空间非常昂贵！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-29T20:40:27.130

如果您查看任何数据库教科书，您会发现大量此类表。这是定义 n 对 m 关系的默认方式。例如：

```
article = (id, title, text)
author = (id, name)
article_author = (article_id, author_id) 
```

从语义上讲，article_author 不是一个新实体，因此您可以避免将其定义为主键，而是将其创建为具有 UNIQUE 约束的普通索引。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-29T20:42:39.760

是的，我同意，“一些好的定义”是好的。但是，当您决定从某个地方引用此复合主键（即，将其移至外键）时，它很快就会变成 NG（不好）。

# asp.net - ASP.NET：管理用户和角色（CMS、门户等？）

> ID：695340
> 
> 赞同：0
> 
> 时间：2009-03-29T20:39:38.317
> 
> 标签：asp.net, asp.net-mvc, authentication, web-applications, forms-authentication

我不知道如何表达一个好问题，所以我只会说我想要什么！

我必须为我们的供应商重新设计一个 Web 应用程序，其中一部分需要逐个供应商限制内容。看看 ASP.NET (MVC)，使用内置的授权过滤器以及 IPrincipal 和 IIdentity 接口似乎很容易（我还没有使用它们，只是在阅读，所以我可能错误地使用了这些术语！）。

我不感兴趣的是编写所有用于管理用户和角色的代码。我希望能够假设所有这些都是由第三方应用程序为我完成的，并且我的代码只是指定了所需的角色。

现在，我不确定我所追求的产品，或者它是否存在。这是一个CMS吗？现在我们的供应商网站使用的是非常旧的 DNN 版本。我们现有的一些自定义代码是作为 DNN 中的一个模块编写的。我对这种类型的解决方案根本不感兴趣。我希望能够构建一个标准的 ASP.NET webapp，而不是绑定到某个供应商的“模块”定义。如果 CMS / Portal 在 ASP.NET 提供的 API 后面实现自定义提供程序，这似乎应该是可能的，是吗？

如果有意义的话，这里的主要（唯一）客户是开发人员。

笔记：

*   我真的不需要完整的 CMS，这就是为什么我对要搜索的产品类型感到困惑的原因。某些 CMS 功能可能不错，但该站点仅用于非常特定的供应商交互，这将是 95% 的自定义。

*   我看到 ASP.NET 提供了一个网站管理工具，这很酷，但没有解决用户交互的面向公众的方面。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-29T21:09:01.303

ASP.NET 提供了广泛的成员资格和角色管理 API，这些 API 从 2.0 版开始就非常容易使用。它们在 ASP.NET MVC 中可用。与样式或其他东西相比，它们可能不需要更多的工作。但是由于您无论如何都不想这样做，您可以在 MVC 应用程序中使用带有登录控件的简单 Web 表单，并通过以下方式使路由忽略该路径：

```
routes.IgnoreRoute("SignIn.aspx"); 
```

只需将登录控件拖到`SignIn.aspx`任何 Web 表单应用程序中即可。

# c++ - 开始 C++ 问题；无法实例化抽象类（VS 中的 C2259）

> ID：695346
> 
> 赞同：2
> 
> 时间：2009-03-29T20:43:22.303
> 
> 标签：c++, windows, com

我正在尝试创建 IAudioEvents COM 接口的具体实例（在 Vista 及更高版本中可用）。这是我第一次涉足 COM 编程，所以我可能只是在这里做一些愚蠢的事情。无论如何，以下代码无法使用“C2259：'AudioEndpointVolumeNotifierImpl'：无法实例化抽象类”进行编译。

类定义（AudioEndpointVolumeNotifierImpl.h）：

```
class AudioEndpointVolumeNotifierImpl : public IAudioSessionEvents
{
private:
    LONG _cRef;

public:
    AudioEndpointVolumeNotifierImpl() : _cRef(1){}
    ~AudioEndpointVolumeNotifierImpl(){}
    HRESULT STDMETHODCALLTYPE OnSimpleVolumeChanged(float NewVolume, BOOL NewMute,LPCGUID EventContext);

    HRESULT STDMETHODCALLTYPE OnChannelVolumeChanged(DWORD ChannelCount, float NewChannelVolumeArray[], DWORD ChangedChannel, LPCGUID EventContext){return S_OK;}
    HRESULT STDMETHODCALLTYPE OnDisplayNameChanged(LPCWSTR NewDisplayName, LPCGUID EventContext){return S_OK;}
    HRESULT STDMETHODCALLTYPE OnGroupingParamChanged(LPCGUID NewGroupingParam, LPCGUID EventContext){return S_OK;}
    HRESULT STDMETHODCALLTYPE OnIconPathChanged(LPWCHAR NewIconPath, LPCGUID EventContext){return S_OK;}
    HRESULT STDMETHODCALLTYPE OnSessionDisconnected(AudioSessionDisconnectReason DisconnectReason){return S_OK;}
    HRESULT STDMETHODCALLTYPE OnStateChanged(AudioSessionState NewState){ return S_OK; }

    ULONG STDMETHODCALLTYPE AddRef()
    {
        return InterlockedIncrement(&_cRef);
    }

    ULONG STDMETHODCALLTYPE Release()
    {
        ULONG ulRef = InterlockedDecrement(&_cRef);
        if (0 == ulRef)
        {
            delete this;
        }
        return ulRef;

    }

    HRESULT STDMETHODCALLTYPE QueryInterface(REFIID riid, VOID **ppvInterface)
    {
        if (IID_IUnknown == riid)
        {
            AddRef();
            *ppvInterface = (IUnknown*)this;
        }
        else if (__uuidof(IAudioSessionEvents) == riid)
        {
            AddRef();
            *ppvInterface = (IAudioSessionEvents*)this;
        }
        else
        {
            *ppvInterface = NULL;
            return E_NOINTERFACE;
        }
        return S_OK;
    }
}; 
```

对应的.cpp：

```
HRESULT STDMETHODCALLTYPE AudioEndpointVolumeNotifierImpl::OnSimpleVolumeChanged(float NewVolume, BOOL NewMute, LPCGUID EventContext)
{
    PostStatusChange(NewVolume);

    return S_OK;
} 
```

在以下代码的 IClassFactory 实例中失败：

```
...
AudioEndpointVolumeNotifierImpl* pObject = new AudioEndpointVolumeNotifierImpl();
    if (pObject == NULL)
    {
        return E_OUTOFMEMORY ;
    }
... 
```

这段代码的很大一部分来自一些教程（特别是 IUnknown 的东西）。我不希望这段代码能工作，但我不明白为什么它不能编译。

谢谢。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-29T20:56:23.503

奇怪的是，虽然这里`OnIconPathChanged`被描述为采用`LPWCHAR`参数：

[http://msdn.microsoft.com/en-us/library/dd370939(VS.85).aspx](http://msdn.microsoft.com/en-us/library/dd370939(VS.85).aspx)

在此处的示例中显示了一个`LPCWSTR`：

[http://msdn.microsoft.com/en-us/library/dd370797(VS.85).aspx](http://msdn.microsoft.com/en-us/library/dd370797(VS.85).aspx)

其中之一可能是错误的；如果我们假设它是前者，并且该方法实际上需要一个`LPCWSTR`（无论如何考虑到上下文这更有意义），那将解释您的错误。我会尝试将您的声明更改为

```
HRESULT STDMETHODCALLTYPE OnIconPathChanged(LPCWSTR NewIconPath, LPCGUID EventContext){return S_OK;} 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-03-29T21:23:25.107

除了 Eric Melski 的回答（因为你说你是初学者，我认为他的回答对你来说不是很清楚）：

出现此错误的原因是因为 AudioEndpointVolumeNotifierImpl 是一个抽象类，这意味着它具有纯虚方法，可以直接在类中定义，也可以从基类继承。

在你的情况下，显然是后者。

您想要做的是实现继承的纯虚方法，您已经尝试过这样做，但是如果方法的签名不同，您只是定义了一个重载，而基础纯虚方法保持不变。而且您的课程仍然是抽象的。因此出现错误消息。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-19T12:16:32.657

当您收到此错误时，您通常可以在输出控制台（即不是错误列表）中查找“由于以下成员：”，您将看到是什么使类抽象。

# algorithm - 对产品列表进行分类的算法？

> ID：695347
> 
> 赞同：7
> 
> 时间：2009-03-29T20:44:05.000
> 
> 标签：algorithm, nlp

我有一个列表，代表或多或少相同的产品。例如，在下面的列表中，它们都是希捷硬盘。

1.  希捷硬盘 500Go
2.  适用于笔记本电脑的希捷硬盘 120Go
3.  希捷 Barracuda 7200.12 ST3500418AS 500GB 7200 RPM SATA 3.0Gb/s 硬盘
4.  希捷全新闪亮 500Go 硬盘
5.  希捷梭子鱼 7200.12
6.  希捷 FreeAgent Desk 500GB 外置硬盘 银色 7200RPM USB2.0 零售

对于人类来说，硬盘3和5是一样的。我们可以更进一步，假设产品 1、3、4 和 5 相同，并将产品 2 和 6 放在其他类别中。

我们有一个庞大的产品清单，我想对其进行分类。**有没有人知道什么是做这种事情的最佳算法。**有什么建议么？

我虽然是**贝叶斯分类器**，但我不确定它是否是最佳选择。任何帮助，将不胜感激！

谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-29T20:52:09.240

您至少需要两个组件：

首先，您需要进行“特征”提取的东西，即获取您的项目并提取相关信息。例如，“new and shinny”不如“500Go hard drive”和“seagate”相关。一个（非常）简单的方法将包括一个简单的启发式提取制造商、技术名称（如“USB2.0”）和模式（如“GB”、“RPM”）从每个项目中提取。

然后，您最终会得到每个项目的一组功能。一些机器学习人员喜欢将其放入“特征向量”中，即每个特征都有一个条目，根据特征是否存在设置为 0 或 1。这是您的数据表示。然后，您可以在此向量上进行距离比较。

请注意，您最终可能会得到一个包含数千个条目的向量。即使那样，您也必须对结果进行聚类。

可能有用的维基百科文章：

*   [特征提取](http://en.wikipedia.org/wiki/Feature_extraction)
*   [最近邻搜索](http://en.wikipedia.org/wiki/Nearest_neighbor_search)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-14T12:35:43.933

这类问题没有简单的解决方案。特别是如果您的列表非常大（数百万个项目）。也许这两篇论文可以为您指明正确的方向：

[http://www.cs.utexas.edu/users/ml/papers/normalization-icdm-05.pdf](http://www.cs.utexas.edu/users/ml/papers/normalization-icdm-05.pdf) [http://www.ismll.uni-hildesheim.de/pub/pdfs/Rendle_SchmidtThieme2006-Object_Identification_with_Constraints.pdf](http://www.ismll.uni-hildesheim.de/pub/pdfs/Rendle_SchmidtThieme2006-Object_Identification_with_Constraints.pdf)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-30T11:51:26.893

要对产品进行实际分类，您可以使用带有黑板的“增强型神经网络”。（这只是一个让您朝着正确方向思考的隐喻，而不是严格使用这些术语。）

想象一组通过侦听器或事件连接的对象（就像神经元和突触一样）。每个对象都有一组模式，并根据这些模式测试输入。

一个例子：

*   一个对象测试 ("seagate"|"connor"|"maxtor"|"quantum"| ...)
*   另一个对象测试 [:digit:]*(" ")?("gb"|"mb")
*   另一个对象测试 [:digit:]*(" ")?"rpm"

所有这些对象都连接到另一个对象，如果它们的某些组合触发，则将输入分类为硬盘驱动器。单个对象本身会将某些特征输入到黑板（用于说明输入内容的公共书写区域）中，例如制造商、容量或速度。

因此，神经元的触发不是基于阈值，而是基于对模式的识别。其中许多神经元可以在黑板上高度并行工作，甚至可以通过其他神经元进行正确分类（也许引入确定性？）

我在用于根据[UNSPSC](http://www.unspsc.org/)对产品进行分类的产品原型中使用了类似的东西，并且能够对汽车零件进行 97% 的正确分类。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-30T11:29:53.747

您将遇到的问题之一是确定非线性或无序属性中的最近邻。我正在这里建立[曼努埃尔的条目](https://stackoverflow.com/questions/695347/algorithm-to-classify-a-list-of-products/695357#695357)。

您将遇到的一个问题是确定 (1) Seagate 500Go、(2) Seagate Hard Drive 120Go for laptop 和 (3) Seagate FreeAgent Desk 500GB 外置硬盘 Silver 7200RPM USB2.0 Retail 的接近程度：

1 更接近 2 还是更接近 3？差异是否证明了不同的类别？

人类会说 3 介于 1 和 2 之间，因为外部 HD 可以在两种机器上使用。这意味着，如果有人为他的台式机搜索 HD，并扩大选择范围以包括替代品，则也会显示外部 HD，但不会显示笔记本电脑 HD。也许，SSD、USB 记忆棒、CD/DVD 驱动器甚至会出现在笔记本电脑驱动器之前，从而扩大范围。

可能的解决方案：

向用户展示成对的属性，并让他们权衡接近度。给他们一个比例，告诉你某些属性有多接近。然后，扩大选择范围将使用此比例作为此属性的距离函数。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-04-22T13:38:20.607

[MALLET](http://mallet.cs.umass.edu)具有 CRF 和 MaxEnt 的实现，它们可能可以很好地完成这项工作。正如之前有人所说，您需要先提取特征，然后将它们输入分类器。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2017-02-27T22:09:57.740

老实说，这似乎更像是一个[记录链接](https://en.wikipedia.org/wiki/Record_linkage)问题，而不是一个分类问题。你不会提前知道所有的课程是什么，对吧？但是您确实想弄清楚哪些产品名称指的是相同的产品，哪些指的是不同的产品？

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2017-03-02T06:51:47.413

首先，我会使用 CountVectorizer 来查看生成的词汇表。会有像'from'、'laptop'、'fast'、'silver'等词。你可以使用停用词来丢弃这些没有给我们任何信息的词。我也会继续丢弃“硬盘”、“驱动器”、“硬盘驱动器”等，因为我知道这是硬盘驱动器列表，因此它们不提供任何信息。然后我们会有像这样的单词列表

1.  希捷 500Go
2.  希捷 120Go
3.  希捷梭子鱼 7200.12 ST3500418AS 500GB 7200 RPM SATA 3.0Gb/s
4.  500Go 希捷等

您可以使用功能列表，例如以 RPM 结尾的东西可能会提供 RPM 信息，以 mb/s 或 Gb/s 结尾的东西也是如此。然后我会丢弃像“1234FBA5235”这样的字母数字字符，这很可能是型号等，不会给我们太多信息。现在，如果您已经知道列表中出现的硬盘驱动器品牌，例如“Seagate”、“Kingston”，您可以使用字符串相似度或简单地检查它们是否出现在给定的句子中。完成后，您可以使用聚类将相似的对象组合在一起。现在，具有相似 rpm、gb's、gb/s、品牌名称的对象将聚集在一起。同样，如果你使用 KMeans 之类的东西，你必须找出 K 的最佳值。你必须做一些手工工作。

但是上述方法的问题是，如果您事先不知道品牌列表，那么您将遇到麻烦。然后我会使用贝叶斯分类器来查找每个句子并获得它是硬盘品牌的概率。我会寻找两件事

1.  看看数据，大多数时候句子会明确提到“硬盘”这个词，然后我就知道它肯定是在谈论硬盘。像“梅赛德斯奔驰硬盘”这样的东西的机会很小。
2.  这有点费力，但我会在亚马逊上写一个 Python 网络**爬虫**（或者如果你不能只为最常用的硬盘品牌写一个谷歌并创建一个列表）它给我的列表就像'Seagate Barracuda 7200.12 ST3500418AS 500GB 7200 RPM SATA 3.0Gb/s' 现在对于每个句子，它都会使用诸如朴素贝叶斯之类的东西来给我它是一个品牌的可能性。sklearn 非常方便地做这些事情。

# java - 在 Mac OS X 上使用 JDK 1.6 运行 Ant

> ID：695350
> 
> 赞同：12
> 
> 时间：2009-03-29T20:48:30.263
> 
> 标签：java, macos, ant

我在 Mac OS X 上使用 JDK 1.6 运行 Ant 时遇到问题。即使在 OS X 的 Java Preference 中将 Java 应用程序版本设置为 Java SE 6，`java -version`在终端中执行也显示`java version "1.6.0_07"`，Ant 似乎仍然使用 JDK 1.5 来使用 JDK 1.5因为它在编译我的代码时看不到 JDK 1.6 类。

我了解 Ant 依赖`JAVA_HOME`环境变量来指定要使用的 JDK。但是，我不太明白如何在 Mac OS X 上设置此变量。

因此，我的问题是如何让 Ant 在 Mac OS X 上使用 JDK 1.6 运行。如果正确的方法仍然是设置`JAVA_HOME`环境变量，那么如何在 OS X 上设置变量。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-03-29T20:56:53.737

JAVA_HOME 环境变量在您的主目录的 .profile 文件中设置。（/Users/ejel/.profile ？）对其进行编辑并将其设置为您想要的。例如：

```
export JAVA_HOME=/System/Library/Frameworks/JavaVM.framework/Versions/1.6/Home 
```

从现在开始，每次打开一个新的终端窗口时，它都会将 JAVA_HOME 设置为这个新值。它不会随着任何现有的打开窗口而改变。

如果您真的对将其放入配置文件感到震惊，或者如果它与其他软件冲突，则导出语句始终可以在终端中手动运行或进入在您开始之前运行一次的脚本（例如：setj6ev.sh）运行蚂蚁任务。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-06-27T10:10:03.390

我已经添加了行

```
export JAVA_HOME=`/usr/libexec/java_home` 
```

对于我的 .zshrc 文件，它似乎可以解决问题（.bash_profile 或者如果你使用 bash 的话）。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-21T14:57:51.157

Ted，使用 Java Preferences 应用程序不会更改 /System/Library/Frameworks/JavaVM.framework/Versions 中的 CurrentJDK 符号链接，如果未设置 JAVA_HOME 环境变量，Ant 将使用该符号链接。因此，您可以手动更改该符号链接或设置 JAVA_HOME 环境变量，但如果您都不这样做，那么 Ant 将不会使用正确的 JDK。

您可以通过在 build.xml 文件中发出 <echo message="${ant.java.version}"/> 来查看 Ant 正在使用的 jdk 版本。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-30T05:17:20.117

在 .profile/.bashrc/.zshrc 中显式设置 JAVA_HOME 变量实际上并不是在 mac 上推荐的方法。我见过一些程序被明确设置为特定版本的 JAVA_HOME （例如带有一些 spring 资源的 grails 1.1）。

设置要使用的 Java 版本的正确方法是使用 /Application/Utilities/Java Preferences.app 应用程序。

在那里，您将要使用的 java 版本拖到顶部。这将为所有应用程序启用该版本（包括从命令行运行的应用程序和通过 GUI 进程启动的应用程序）。

您可以通过从命令行运行它来测试当前版本：

```
java -version 
```

我实际上并不喜欢 mac 处理整个 java 符号链接目录和文件的方式。这并不明显，人们经常把它搞砸。

有关更多详细信息，请参阅[苹果开发者页面。](http://developer.apple.com/java/faq/#javahome)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2011-01-18T18:31:35.307

我尝试了一切，只有一件事对我有用：取消链接 CurrentJDK，并链接到 1.6：

```
cd /System/Library/Frameworks/JavaVM.framework/Versions   
sudo unlink CurrentJDK   
sudo ln -sF "1.6" CurrentJDK 
```

最后我得到：

```
java -version   
java version "1.6.0_22" 
```

我希望这会有所帮助。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2009-03-30T11:16:39.177

您可能需要打开一个新的命令提示符实例，以便 shell 可以获取对环境变量的任何更改。

# utility - 如何实现磁盘碎片？

> ID：695354
> 
> 赞同：5
> 
> 时间：2009-03-29T20:50:58.900
> 
> 标签：utility, fragmentation

我有一些想法想在磁盘碎片整理竞技场中尝试一下。我得出的结论是，作为实现的先驱，能够将磁盘置于碎片状态是很有用的。在我看来，这似乎是一种比碎片整理更难实现的状态。我认为商业碎片整理公司可能已经解决了这个问题。

所以我的问题......

**一个人如何去实现一个分片器？在使用它来测试碎片整理程序的上下文中，有什么意义？**

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-29T20:55:59.260

也许您应该在模拟/模拟磁盘上测试您的碎片整理算法，而不是对实际磁盘进行碎片整理？只有当您对算法本身按规定工作感到满意时，您才能使用实际磁盘 API 在实际磁盘上进行测试。

您甚至可以拍摄实际碎片磁盘（您的或您认识的人的）的快照，并将这些数据用作测试的模拟模型。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-29T20:56:36.140

如何最好地分段取决于文件系统。

通常，同时打开大量文件。打开文件将创建一个新的目录条目，但不会导致为该文件写入块。但是现在依次遍历每个文件，写入一个块。这通常会导致下一个空闲块被消耗，这将导致您的所有文件彼此碎片化。

*对现有*文件进行分段是另一回事。基本上，做同样的事情，但在现有文件的文件副本上执行此操作，删除原始文件并重命名副本。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-29T21:08:31.930

我在这里可能过于简单化了，但是如果您人为地对磁盘进行分段，那么您运行的任何测试都将仅适用于您的分段器创建的碎片，而不是任何现实世界的碎片。您最终可能会针对不代表真实世界事件的碎片工具中的假设进行优化。

拍一些碎片磁盘的磁盘映像不是更容易更准确吗？你有没有朋友或同事相信你不会对他们的数据做任何反社会的事情？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-29T21:02:56.233

碎片是一个数学问题，因此您在执行特定操作时试图最大化硬盘驱动器磁头的行进距离。所以为了有效地分割一些东西，你需要先定义具体的操作

# asp.net - 用“;”下载文件 或文件名中的“#”会破坏文件名

> ID：695356
> 
> 赞同：3
> 
> 时间：2009-03-29T20:52:07.163
> 
> 标签：asp.net

我有一个名为 AttachmentDownload.aspx 的文件，并且在 Page_Load 方法中有这样的代码，可以下载文件。除包含“;”的名称外，所有名称在 IE 中都能正常工作 或者 ”＃”。他们提供用户以“AttachmentDownload.aspx”名称保存文件。有解决方法吗？

这是一个例子：

```
var fileName = Server.UrlPathEncode (";%.txt");
Response.AddHeader("content-disposition", String.Format("attachment;filename=\"{0}\"", fileName));
Response.WriteFile(path);
Response.End(); 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-30T00:53:08.380

> 除包含“;”的名称外，所有名称在 IE 中都能正常工作 或者 ”＃”。

我无法用 '#' 但 ';' 重现问题 当然会破坏它。'"' 和 '\' 也一样（你可以在 Unix 上的文件名中使用它们，这会破坏你的引用字符串）。

[在RFC1521](http://www.ietf.org/rfc/rfc1521.txt)中定义了在 RFC822 系列参数化标头（例如 Content-Disposition）中包含带外字符的“正确”解决方案：不能包含在“令牌”中的字符串应该包装在带引号的字符串中，这[RFC2822](http://www.ietf.org/rfc/rfc2822.txt)定义为将 " 和 \ 字符反斜杠转义，然后用引号括起来。

[然后， RFC2231](http://www.ietf.org/rfc/rfc2231.txt)以一种非常复杂的方式扩展了这一点，在标头参数中包含非 ASCII 字符，理论上您会希望使用它来支持 Unicode 字符。

在实践中：HTTP 并不是真正的 RFC822 系列规范，并且这些东西在常规浏览器中都不起作用（Opera 中的反斜杠转义除外）。没有可靠的方法可以将 Unicode Content-Disposition 文件名发送给客户端，并且您的问题是 ';' 不是因为任何转义问题，而是因为 IE 无法解析太妃糖的参数化标头（即使它被引号包围，它也会在字符串中的下一个分号处拆分）。

对于可靠的跨浏览器文件名设置，您可以在现实世界中采用两种方法：

1.  在将文件名放入 Content-Disposition 标头之前，从文件名中删除任何令人反感的内容。这包括前导/尾随空格/点、大多数其他标点符号和任何非 ASCII。

2.  Don't specify a filename in the Content-Disposition header at all, and let the browser work out what filename to use from the last part of the URL. To stop it choosing “AttachmentDownload.aspx”, you can put whatever you like as a trailing URL part, eg.:

    [http://www.example.com/AttachmentDownload.aspx/Foo%23Bar](http://www.example.com/AttachmentDownload.aspx/Foo%23Bar)

This requires you encode most punctuation using plain URL encoding and Unicode characters with UTF-8, but at least you can get the characters in. The above results in a file download prompt for ‘Foo;Bar’.

Note that even though you *can* encode Windows-unfriendly characters like ‘"’ in a URL path part like this, for downloaded files it is best not to, because IE will respond by trying to save the file using a ‘"’ in the filename, and will silently and mysteriously fail in response.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-31T12:51:57.253

I started to just clean my filenames of all special characters. I've come up with a mapping table that should map most of the commonly used chars.

```
//http://www.pjb.com.au/comp/diacritics.html
private static string[,] CharacterReplacements = { 
    { " ", "-"},
    { "&", "-"},
    { "?", "-"},
    { "!", "-"},
    { "%", "-"},
    { "+", "-"},
    { "#", "-"},
    { ":", "-"},
    { ";", "-"},
    { ".", "-"},

    { "¢", "c" },   //cent
    { "£", "P" },   //Pound
    { "€", "E" },   //Euro
    { "¥", "Y" },   //Yen
    { "°", "d" },   //degree
    { "¼", "1-4" }, //fraction one-quarter
    { "½", "1-2" }, //fraction half    
    { "¾", "1-3" }, //fraction three-quarters}
    { "@", "AT)"}, //at                                                  
    { "Œ", "OE" },  //OE ligature, French (in ISO-8859-15)        
    { "œ", "oe" },  //OE ligature, French (in ISO-8859-15)        

    {"Å","A" },  //ring
    {"Æ","AE"},  //diphthong
    {"Ç","C" },  //cedilla
    {"È","E" },  //grave accent
    {"É","E" },  //acute accent
    {"Ê","E" },  //circumflex accent
    {"Ë","E" },  //umlaut mark
    {"Ì","I" },  //grave accent
    {"Í","I" },  //acute accent
    {"Î","I" },  //circumflex accent
    {"Ï","I" },  //umlaut mark
    {"Ð","Eth"}, //Icelandic
    {"Ñ","N" },  //tilde
    {"Ò","O" },  //grave accent
    {"Ó","O" },  //acute accent
    {"Ô","O" },  //circumflex accent
    {"Õ","O" },  //tilde
    {"Ö","O" },  //umlaut mark
    {"Ø","O" },  //slash
    {"Ù","U" },  //grave accent
    {"Ú","U" },  //acute accent
    {"Û","U" },  //circumflex accent
    {"Ü","U" },  //umlaut mark
    {"Ý","Y" },  //acute accent
    {"Þ","eth"}, //Icelandic - http://en.wikipedia.org/wiki/Thorn_(letter)
    {"ß","ss"},  //German

    {"à","a" },  //grave accent
    {"á","a" },  //acute accent
    {"â","a" },  //circumflex accent
    {"ã","a" },  //tilde
    {"ä","ae"},  //umlaut mark
    {"å","a" },  //ring
    {"æ","ae"},  //diphthong
    {"ç","c" },  //cedilla
    {"è","e" },  //grave accent
    {"é","e" },  //acute accent
    {"ê","e" },  //circumflex accent
    {"ë","e" },  //umlaut mark
    {"ì","i" },  //grave accent
    {"í","i" },  //acute accent
    {"î","i" },  //circumflex accent
    {"ï","i" },  //umlaut mark
    {"ð","eth"}, //Icelandic
    {"ñ","n" },  //tilde
    {"ò","o" },  //grave accent
    {"ó","o" },  //acute accent
    {"ô","o" },  //circumflex accent
    {"õ","o" },  //tilde
    {"ö","oe"},  //umlaut mark
    {"ø","o" },  //slash
    {"ù","u" },  //grave accent
    {"ú","u" },  //acute accent
    {"û","u" },  //circumflex accent
    {"ü","ue"},  //umlaut mark
    {"ý","y" },  //acute accent
    {"þ","eth"}, //Icelandic - http://en.wikipedia.org/wiki/Thorn_(letter)
    {"ÿ","y" },  //umlaut mark
    }; 
```

Or you can get the whole code here:

[http://remy.supertext.ch/2012/08/clean-filenames/](http://remy.supertext.ch/2012/08/clean-filenames/)

Let me know if you find chars that are missing.

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2010-04-21T14:11:16.180

Filename with special symbols(e.g: space; # @ ! $ ) or Non-Unicode characters either cannot be supported by some browsers or cause incorrect filename in client machine. Here is an article by a Chinese called chanext, he gave a perfect way to solve this problem: this article gave a sample code(written with c#) to show how to get perfect solution to this problem in the all four popular browsers (IE; Opera; Firefox and Chrome) the filename "Microsoft.Asp.Net.doc" and "F ile;;!@%#^&y.doc" can both be output correctly using the way the author provided in this article.

[http://ciznx.com/post/aspnetstreamdownloaddisplaynonunicodespacechar.aspx](http://ciznx.com/post/aspnetstreamdownloaddisplaynonunicodespacechar.aspx)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-29T21:26:58.983

[UrlPathEncode](http://msdn.microsoft.com/en-us/library/system.web.httpserverutility.urlpathencode.aspx)仅对类似 URL 的字符串的“路径”部分进行编码，请尝试使用 [Server.UrlEncode](http://msdn.microsoft.com/en-us/library/zttxte6w.aspx)或[HttpUtility.UrlEncode](http://msdn.microsoft.com/en-us/library/4fkewx0t.aspx)。

# php - 为什么 TCP 可以工作，而 UDP 不行？

> ID：695360
> 
> 赞同：1
> 
> 时间：2009-03-29T20:54:45.147
> 
> 标签：php, sockets, tcp, udp

编码：

```
<?php
error_reporting(E_ALL);

/* Allow the script to hang around waiting for connections. */
set_time_limit(0);

/* Turn on implicit output flushing so we see what we're getting
 * as it comes in. */
ob_implicit_flush();

$address = '127.0.0.1';
$port = 11100;

if (($sock = socket_create(AF_INET, SOCK_DGRAM, SOL_UP)) === false) {
    echo "socket_create() failed: reason: " . socket_strerror(socket_last_error()) . "\n";
}

if (socket_bind($sock, $address, $port) === false) {
    echo "socket_bind() failed: reason: " . socket_strerror(socket_last_error($sock)) . "\n";
}

if (socket_listen($sock, 5) === false) {
    echo "socket_listen() failed: reason: " . socket_strerror(socket_last_error($sock)) . "\n";
}

do {
    if (($msgsock = socket_accept($sock)) === false) {
        echo "socket_accept() failed: reason: " . socket_strerror(socket_last_error($sock)) . "\n";
        break;
    }
    do {
    $out = socket_read($msgsock, 2048);

    if (!empty($out)) {
        if ($out == 'quit') {
            break;
        }
        elseif ($out == 'shutdown') {
            socket_write($msgsock, 'plc down', 8);
            socket_close($msgsock);
            break 2;
        }
        else {
            switch ($out) {
                case "KABBE": $response = "Kabbe te!"; break;
                case "SZOPJ": $response = "Szopjal te!"; break;
                default: $response = "Ismeretlen parancs";
            }
            socket_write($msgsock, $response, strlen($response));
            break;
        }
    }
    } while (true);
socket_close($msgsock);
} while (true);

socket_close($sock);
?> 
```

它适用于 TCP：

```
$socket = socket_create(AF_INET, SOCK_STREAM, SOL_TCP); 
```

但使用 UDP 它不起作用：

```
$sock = socket_create(AF_INET, SOCK_DGRAM, SOL_UDP); 
```

错误：

> 警告：socket_listen() [function.socket-listen]：无法在套接字 [0] 上侦听：引用的对象类型不支持尝试的操作。在第 22 行的 C:\wamp\www\socket\socket.php 中，socket_listen() 失败：原因：所引用的对象类型不支持尝试的操作。
> 
> 警告：socket_accept() [function.socket-accept]：无法接受传入连接 [0]：引用的对象类型不支持尝试的操作。在第 27 行的 C:\wamp\www\socket\socket.php 中，socket_accept() 失败：原因：所引用的对象类型不支持尝试的操作。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-29T21:06:05.633

因为 TCP 是面向连接的，而 UDP 不是，并且 UDP 套接字有不同的 API。看看[socket_recvfrom](http://www.php.net/manual/en/function.socket-recvfrom.php)和[socket_sendto](http://www.php.net/manual/en/function.socket-sendto.php)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-05T17:57:01.193

我已经通过编辑 Growl 类来修复它

```
 socket_sendto($sck, $data, strlen($data), 0x100, $this->address, $this->port); 
```

至

```
 socket_sendto($sck, $data, strlen($data), 0x0, $this->address, $this->port); 
```

# python - 什么是 LLVM 以及如何用 LLVM 替换 Python VM 将速度提高 5 倍？

> ID：695370
> 
> 赞同：26
> 
> 时间：2009-03-29T21:01:56.830
> 
> 标签：python, multicore, llvm, unladen-swallow

Google 正在赞助一个开源项目，以将 Python 的速度提高 5 倍。

[Unladen-Swallow](http://code.google.com/p/unladen-swallow/)似乎有一个[很好的项目计划](http://code.google.com/p/unladen-swallow/wiki/ProjectPlan)

为什么并发是一个如此困难的问题？
LLVM 会解决并发问题吗？
除了多核之外，还有其他解决方案可用于硬件进步吗？

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2009-03-29T21:37:41.110

[LLVM](http://llvm.org/)是几样东西——一种虚拟机/优化编译器，结合不同的前端，以特定语言输入并以中间语言输出结果。此中间输出可以与虚拟机一起运行，也可以用于生成独立的可执行文件。

并发的问题在于，虽然它在科学计算中使用了很长时间，但它最近才在消费者应用程序中变得普遍。因此，虽然众所周知如何编写科学计算程序以实现出色的性能，但编写一个擅长并发的邮件用户代理/文字处理器是完全不同的事情。此外，大多数当前的操作系统在设计时都考虑到了单处理器，并且它们可能没有为多核处理器做好充分准备。

LLVM 在并发方面的好处是你有一个中间输出，如果将来并发方面有进步，那么通过更新你的解释器，你可以立即在所有 LLVM 编译的程序中获得这些好处。如果您已编译为独立的可执行文件，这并不容易。所以 LLVM 本身并没有解决并发问题，但它为未来的增强打开了大门。

当然，像量子计算机、基因计算机等硬件还有更多可能的进步。但我们必须等待它们成为现实。

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2009-03-29T21:39:59.547

切换到 LLVM 本身并不能解决并发问题。这是通过摆脱[Global Interpreter Lock](http://docs.python.org/c-api/init.html#thread-state-and-the-global-interpreter-lock)来单独解决的。

我不确定我对此有何感想。我主要使用线程来处理阻塞 I/O，而不是利用多核处理器（为此，我将使用该`multiprocessing`模块来生成单独的进程）。

所以我有点喜欢 GIL；它让我的生活更轻松，不必考虑棘手的同步问题。

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2009-03-29T22:07:58.340

LLVM 负责代码生成的细节，因此它允许他们以更通用、可移植、可维护的方式重写 Psyco。这反过来又允许他们重写 CPython 核心，这让他们可以试验备用 GC 和其他改进 python 对并发支持所需的东西。

换句话说，LLVM 并没有解决并发问题，它只是解放了你的双手，让你可以解决它。

# c++ - C++ 标准列表和默认可构造类型

> ID：695372
> 
> 赞同：0
> 
> 时间：2009-03-29T21:02:23.973
> 
> 标签：c++, list, stl, default-constructor

为什么要求的单参数构造函数`std::list<T>`是`T`默认可构造类型？我的意思是以下代码无法编译。

```
struct Foo { // does not have default constructor.
  Foo (int i) {} 
}
int main(void) {
  std::list<Foo> l(10);
} 
```

似乎可以像在 std::vector 中所做的那样使用[构造和销毁习语，尽管需要更多地记录列表类。](http://en.wikibooks.org/wiki/More_C%2B%2B_Idioms/Generic_Container_Idioms)

在相关说明中，为什么列表中没有容量功能？您可以争辩说，这样的函数会预先支付内存分配成本，并在以后消除`push_back`对象时的开销。至少它会使两个 STL 序列容器的接口稍微一致。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-29T21:26:10.030

std::list 没有容量函数，因为它没有意义；它永远不必像矢量那样调整大小。它的容量仅受可用内存的限制，不易确定。

根据您的要求，我认为您实际上想要reserve()。这对于矢量来说是一次性的，因为它（非常）需要这样的东西；没有特别要求使所有 STL 容器的所有功能保持一致，尤其是当它们对其他人毫无意义时。

您可以使用自定义分配器来实现相同的效果。正如曼努埃尔建议的那样，看看提升。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-29T21:04:01.240

没有一般要求类型是默认可构造的 - 它必须是可复制和可分配的。您的代码不起作用，因为您尝试创建一个包含 10 个项目的列表——它们必须以某种方式构造，因此必须使用默认构造函数——但仅限于这种特定情况。如果您创建了一个空列表并将其添加到其中，则不会有这样的要求。

其他容器也是如此 - 尝试编译以下内容：

```
#include <vector>

struct A {
    A( int x ) : z(x) {}
    int z;
};

std::vector <A> a(10); 
```

关于您问题的第二部分，我只是观察到接口的一致性不是标准容器的主要设计标准-例如，无意将一种类型的容器替换为其他。Scott Meyers 的“Effective STL”一书的第 1 项和第 2 项对此进行了很好的讨论。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-29T21:14:41.120

[尼尔已经回答了主要问题](https://stackoverflow.com/questions/695372/c-standard-list-and-default-construtible-types/695379#695379)。

另请注意，调用 resize() 时需要一个默认构造函数。

您可以通过拥有指向对象的指针的 STL 列表来规避这一点，但我想这对您来说已经很明显了。

> 在相关说明中，为什么列表中没有容量功能？您可以争辩说，这样的函数会预先支付内存分配成本，然后在您 push_back 对象时消除开销。至少它会使两个 STL 序列容器的接口稍微一致。

我想这里的问题是[STL 列表允许跨列表拼接](http://www.sgi.com/tech/stl/List.html)。如果您想预先分配内存，请查看[Boost Pool Allocator](http://www.boost.org/doc/libs/1_38_0/libs/pool/doc/interfaces/pool_alloc.html)。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-29T21:14:06.253

原因是，当您构造一个包含 n 个元素的列表（其中 n 是您在构造函数中使用的参数）时，该列表会用 T() 的副本填充其 n 个元素的结构。

有关列表，请参见[sgi stl 文档](http://www.sgi.com/tech/stl/List.html)。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-29T21:58:29.393

所以你的问题真的是“为什么列表中没有储备和容量功能？”

答案是没有理由提前为列表保留内存——添加新元素永远不需要对现有元素进行重新分配和复制，不需要保存列表内容的内存是连续的，迭代器不需要在执行`list::push_back()`.

所有这些都是 存在的原因`vector<>::reserve()`，并且为新元素保留内存是 a`vector<>`将执行放置`new`到原始内存中的原因。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-29T21:07:53.430

> 为什么 std::list 的单参数构造函数要求 T 是默认可构造类型？

因为这个构造器 - 创建带有元素的列表（作为参数传递的数字）。每个元素的值将是默认值。您也可以使用带有两个参数的构造函数，用于创建包含将使用第二个元素值初始化的元素的列表。

> 在相关说明中，为什么列表中没有容量功能？

它没有意义，因为向列表添加新元素的成本比使用向量的情况要少得多。

> std::vector 没有这样的限制。我的问题是为什么不在 std::list 中也使用相同的技术（创建/销毁习语）？

这不是限制。因为如果您不使用此类构造函数，则不需要默认初始化程序。向量也是如此。

# ruby-on-rails - 如何从 Rspec 开始？

> ID：695376
> 
> 赞同：6
> 
> 时间：2009-03-29T21:03:22.440
> 
> 标签：ruby-on-rails, tdd, rspec, bdd

在过去的 3 个月里，我一直在使用 Rails。现在我希望启动 BDD 或 TDD。我想从 RSpec 开始。我该如何开始呢？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-29T21:32:44.320

以下网站可能感兴趣：

*   [http://peepcode.com/products/rspec-basics](http://peepcode.com/products/rspec-basics)
*   [http://www.elctech.com/tutorials/rspec-tutorial](http://www.elctech.com/tutorials/rspec-tutorial)
*   [http://jimmyzimmerman.com/blog/2007/11/simple-tutorials-for-learning-bdd-and-rspec.html](http://jimmyzimmerman.com/blog/2007/11/simple-tutorials-for-learning-bdd-and-rspec.html)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-29T22:47:14.877

PragProg 有一本 RSpec 的作者自己写的 beta 书（完整的书将于 6 月发货）。我现在正在处理它，到目前为止它一直很棒！几周前我开始浏览 peepcode 的截屏视频，Sarah Mei 是对的，它们很棒。然而，这本书在我也需要它的地方更深入一点（我自己是 BDD 的新手）。

[RSpec 手册](http://pragprog.com/titles/achbd/the-rspec-book)

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-03-30T09:39:32.547

如果您刚开始，您可能想尝试从黄瓜和 rspec 的组合开始。

Cucumber，是 rpecs 的故事运行器的更高级别的集成测试替代品，旨在提高客户端的可读性。

新的 RSpec 书涵盖了如何进行由外而内的开发技术，并且黄瓜场景对于测试初学者恕我直言感觉更加切实。

Ryan Bates 刚刚发布了一个[开始使用黄瓜](http://railscasts.com/episodes/155-beginning-with-cucumber)截屏视频（我不能保证内容，因为他的文件托管目前看起来很无聊，但他所有的其他视频都非常清晰）。

[最近在 Mountain West Ruby Conf 上也有一个 Cucumber BDD 演讲，这里](http://mwrc2009.confreaks.com/14-mar-2009-15-00-bdd-with-cucumber-ben-mabey.html)是关于 confreaks的。

[我在这里](http://delicious.com/srboisvert/cucumber)有一些其他的黄瓜链接。

# c - 成熟的 C 标准库

> ID：695380
> 
> 赞同：5
> 
> 时间：2009-03-29T21:05:01.610
> 
> 标签：c, open-source, cross-platform

我正在寻找一个 C 库，它至少能给我一些我真正错过的 C++ 和 STL/Boost 的东西。（我必须使用 C，所以请不要“使用 C++”的帖子）

我需要

1.  动态字符串（自动增长和收缩）
2.  某种列表（std::vector 替换）
3.  stringstream 之类的东西（用于类型对话和缓冲区）

此外，它必须具有成熟的开源实现，并且必须独立于平台（需要支持 Windows、Linux 和 Mac）。

有什么建议吗？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-03-29T21:08:31.540

GTK的[GLib](http://library.gnome.org/devel/glib/)怎么样？

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-29T23:21:06.043

我推荐[Apache Portable Runtime](http://apr.apache.org/)。它相当小巧、便携且功能强大——至少为跨多个平台的 Apache httpd 提供支持。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-30T00:14:44.277

您总是可以考虑在您的应用程序中嵌入动态语言运行时。[Lua](http://www.lua.org/)内核一点也不大，提供满足您要求的数据类型，是开源的，并获得 MIT 许可，因此它与 FOSS 和商业项目兼容。

您不一定需要使用用 Lua 编写的代码才能受益，因为它的 C API 提供了对其数据类型及其值的完全访问。但是，您可以稍后将应用程序的一些逻辑移动到 Lua 中，以提高表达的清晰度和使用动态语言编码的其他好处，并将函数作为一等值。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-30T06:04:13.997

看看[Gnulib](http://www.gnu.org/software/gnulib/)

# hardware - 在并行端口上同时发送和接收数据

> ID：695387
> 
> 赞同：0
> 
> 时间：2009-03-29T21:08:43.083
> 
> 标签：hardware, parallel-port

如果我理解并行端口正确，同时从（D0 到 D7）发送数据，但它可以单独控制棒吗？例子：

```
D0 = Input
D1 = Input
D2 = Output
...
...
...
D7 = Input 
```

它会工作吗？我想要做的是同时发送和接收数据。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-29T21:11:51.610

正在同时读取或设置数据线 (D0-D7)。有关双向 I/O 的各种技术，请阅读随附的文章：

标准并口：[http ://www.beyondlogic.org/spp/parallel.htm](http://www.beyondlogic.org/spp/parallel.htm)

EPP：[http ://www.beyondlogic.org/epp/epp.htm](http://www.beyondlogic.org/epp/epp.htm)

ECP：[http ://www.beyondlogic.org/ecp/ecp.htm](http://www.beyondlogic.org/ecp/ecp.htm)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-29T21:11:36.947

当然，通过发送一个仅设置了所需位的数字 (2 ^n )，您将获得预期的结果。

我不确定双向访问。我想这是通过使用控制引脚和数据引脚来实现的，但这只是一个猜测。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-29T21:24:27.990

做 EPP 或 ECP 的并行端口只允许 D0-D7 为所有输入或所有输出。尝试不这样做可能会炸毁您的硬件。

请参见[http://www.nor-tech.com/solutions/dox/ieee1284_parallel_ports.pdf](http://www.nor-tech.com/solutions/dox/ieee1284_parallel_ports.pdf)，第 6 页。

但是，如果您只需要“其他”方向的少量输入/输出，并行端口有几条控制线可能会很有用。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-29T21:40:57.220

该[站点](http://www.lvr.com/parprtib.htm)是并行端口编程的良好来源。

基本思想是您需要一个 DLL、附加组件或库来允许您访问 PC 的 I/O 端口。对于 Windows XP，您需要一个特定的驱动程序来允许您执行此操作，因为操作系统不提供开箱即用的访问权限。

并行端口通常位于三个地址 278,378、3BC 之一。这个港口。有你正在读取或写入的字节。

(base)+1 端口允许访问状态字节。IE。279,379, 3BD

(base)+2 端口允许访问控制字节。IE。27A,37A,3BE

并行端口文档不仅会告诉如何实现常用模式（如双向），还会告诉如何在字节级别控制端口以实现您自己的自定义。

过去只有标准模式可用。您在（基本）端口抽出字节。一些应用程序，比如我的应用程序，将这些端口的各个位作为廉价数字 I/O 控制器的形式进行操作。我们确实使用了状态和控制字节作为额外的输入和输出。您可以向并行端口芯片发送一些命令来精确配置模式。

今天有数百个站点使用并行端口来解决各种问题。我会感到惊讶的是，其中一个没有可以用于特定应用程序的东西。

同样，我推荐的这本书是 Parallel Port complete。它讲述了您需要开始的所有内容。如果您的应用程序对于那本书来说太深奥了，它将提供一个跳板，您可以从中找到所需的确切设置。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-04-19T06:49:50.330

我相信它在端口控制寄存器（基地址 + 2）中的第 5 位会切换方向。（未连接硬件线）

# ruby-on-rails - Rails 条件路由

> ID：695408
> 
> 赞同：0
> 
> 时间：2009-03-29T21:24:16.463
> 
> 标签：ruby-on-rails, routes, conditional

我正在尝试设置一个用户创建向导，其中用户只能转到与用户所在的向导中当前步骤相对应的页面。

我已经整理好了状态机功能。当前状态存储在数据库中。这不是问题

问题是如何将用户重定向到正确的页面。

我首先尝试了一个 before 过滤器，但这导致了一个重定向循环。解决方案很混乱。

我尝试的下一件事是使用 redirect_to 将请求发送到一个操作，然后重定向到正确的页面。这导致了 DoubleRenderError，因为我重定向了两次。我认为redirect_to 是一个新的http 请求，但似乎不是。

我现在想知道是否可以直接在路由中设置这种功能。我将需要访问数据库以获取当前状态。我不知道这是如何完成的，或者是否有可能

有任何想法吗？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-29T23:41:13.013

我不确定我是否完全理解你的问题。

但是，出现双重渲染错误的原因是因为在一个普通的 redirect_to ruby​​ 代码继续执行之后。在某些时候，此代码尝试再次呈现数据（因此出现 DoubleRenderError）。

您可能想使用：

```
redirect_to [...] and return false 
```

这将阻止任何以后的代码被执行，从而防止出现 DoubleRenderError。

祝你好运！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-08-05T10:11:43.397

我想这个问题和我昨天遇到的一样（我在 Rails 2.1 上），我的解决方案可以在[我的博客上找到，真的很简单！](http://franckyu.tumblr.com/post/907117191/rails-2-1-routing-when-its-a-pain-choose-the)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-09T01:46:09.727

我想，这种定义[方法](http://guides.rubyonrails.org/routing.html#advanced-constraints)`:constraints =>`可能正是您所寻找的

# performance - GDBM 的替代品或继任者

> ID：695415
> 
> 赞同：4
> 
> 时间：2009-03-29T21:28:40.027
> 
> 标签：performance, nfs, key-value, non-relational-database, gdbm

我们有一个[GDBM](http://www.delorie.com/gnu/docs/gdbm/gdbm.html)键值数据库作为负载平衡的面向 Web 的应用程序的后端，该应用程序是用 C++ 实现的。应用程序提供的数据变得非常庞大，因此我们的管理员已将 GDBM 文件从“本地”存储（在网络服务器上，或非常靠近）移动到大型、共享、远程、NFS 挂载的文件系统。

这影响了性能。我们的性能测试（在测试环境中）显示页面加载时间从数百毫秒（对于本地磁盘）跳跃到几秒（通过 NFS、本地网络），有时甚至高达 30 秒。我相信问题的很大一部分是应用程序从 GDBM 文件中进行了大量随机读取，并且这些读取比 NFS 慢，这在生产中会更糟（前端和后端甚至它们之间的网络硬件更多）并且随着我们的数据库变得更大。

虽然这不是一个关键应用程序，但我想提高性能，并提供一些可用资源，包括应用程序开发人员时间和 Unix 管理员。我的主要限制是时间只有几周的资源。

在我看来，我的选择是：

1.  通过调整参数提高 NFS 性能。我的直觉是我们不会从中得到太多，但我以前错了，我对 NFS 调优并不是很了解。

2.  移动到不同的键值对数据库，例如[memcachedb](http://memcachedb.org/)或[Tokyo Cabinet](http://tokyocabinet.sourceforge.net/index.html)。

3.  用其他一些协议替换 NFS（iSCSI 已经提到，但我不熟悉）。

我应该如何解决这个问题？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-03-29T22:52:08.890

不要太拘泥于“关系与非关系”的比较。似乎与这个问题无关。

您的应用程序跨越的界限是不同的：**从本地快速文件存储上的小型数据库到通过网络访问的大型数据库**。越过这条线意味着您现在可以更好地使用专用的、网络服务的数据库管理系统。管理服务器是否管理关系数据库与该方面无关。

为了快速启动和运行，[MariaDB](https://mariadb.org/)（MySQL 的继任者）可能是您最好的选择。如果您预见到它的发展会远远超出现在的水平，那么您不妨将它放在[PostgreSQL](https://www.postgresql.org/)中，因为无论如何它最终都需要去那里 :-)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-29T21:54:13.973

这似乎不是你想听到的，但老实说，如果我是你，我会把它扔到一个 mysql 表中。与 GDBM-over-NFS 不同，它并不像使用起来更难，而且您会从中获得很多好处，尤其是实际上针对您的情况的远程访问协议。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-07-13T19:55:32.670

如果您想坚持使用非关系数据库，您可以尝试[BDB](http://www.oracle.com/database/berkeley-db/index.html "伯克利数据库")或 DJB 的[CDB](http://cr.yp.to/cdb.html "国开行")。到目前为止我都使用过，我认为在性能方面它们优于 GDBM。

但是请记住 bignose 的回答，因为我也认为您的瓶颈可能不是您正在使用的数据结构 (GDBM)，而是您的基础设施。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-02-20T16:26:35.243

通过网络使用平面文件的文件系统 i/o 不是一个好主意，但您应该考虑编写一个多线程的 tcp 服务器来进行 i/o、查询等。在那台机器上，然后将结果返回给您。传输小块数据而不是整个数据库文件..

我正在设计一种缓存持久性机制来克服高可用性问题。我将在 python 中对其进行编码。

# scheduled-tasks - 定期基于 Windows Server 的进程

> ID：695416
> 
> 赞同：1
> 
> 时间：2009-03-29T21:29:24.533
> 
> 标签：scheduled-tasks, monitoring, windows-server

我编写了一些自定义程序来执行我定期运行的各种维护/监控任务（有些每隔几分钟，有些每天一次）。将它们从任务调度程序中运行出来，或者将它们作为 Windows 服务运行（由嵌入式计时器对象触发）是更好的做法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-29T21:38:39.533

这是一篇关于服务与预定任务的有趣文章。

[http://weblogs.asp.net/jgalloway/archive/2005/10/24/428303.aspx](http://weblogs.asp.net/jgalloway/archive/2005/10/24/428303.aspx)

我认为对于简单/一次性类型的计划处理，只需编写一个控制台应用程序并将其作为 Windows 计划任务运行就更容易了。

然而，大多数时候，我最终都会编写一个服务，这样我们所有的服务都以相同的方式运行。正如 Martin 所说， [Quartz.NET](http://quartznet.sourceforge.net/)在编写计划服务方面非常强大，并且比普通的计划任务提供了更多的灵活性。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-29T21:35:11.117

编辑：我以某种方式假设您正在寻找 .NET 解决方案。如果不是，请无视我的回答。

* * *

如果您想使用自己的 Windows 服务，请查看[Quartz.NET](http://quartznet.sourceforge.net/index.html)：

> Quartz.NET 是一个功能齐全的开源作业调度系统，可用于从最小的应用程序到大型企业系统。

使用此库，您可以免费获得 Windows 任务调度程序的灵活性，但可以运行您自己的服务。

# c# - 从 C# 调用 C++ dll 函数时出现问题

> ID：695419
> 
> 赞同：1
> 
> 时间：2009-03-29T21:29:48.667
> 
> 标签：c#, c++, function, dll, interop

这是我关于 C# 中的河豚问题的第三个线程。尽管事实上我无法在我的应用程序中实现河豚，但我决定将其用作外部 C++ dll。请注意我已经尝试过 Blowfish.NET 和任何其他，问题是我正在将代码从 C++ 转换为 C#，并且 C# 代码必须与 C++ 代码完全相同。

至今：

[--->C++ DLL 源代码<---](http://pastebin.com/m6baeee0d)

*注意导出的函数在代码的最后*

C# 代码（定义）

```
 [DllImport("TestDLL.dll", EntryPoint = "Initkey" ,ExactSpelling = true , CallingConvention = CallingConvention.Cdecl)]
    public static unsafe extern void Initkey(byte[] key);

    [DllImport("TestDLL.dll", EntryPoint = "encode", ExactSpelling = true, CallingConvention = CallingConvention.Cdecl)]
    public static unsafe extern void encode(UInt32 *stream); 
```

C#代码（函数调用）

-初始化河豚键

```
UInt32[] keyarray = new UInt32[2];
//some code
Extern.Initkey(Misc.ConvertFromUInt32Array(keyarray));
//
//
//Helper function used to convert a UInt32 array into Byte array.
public static byte[] ConvertFromUInt32Array(UInt32[] array)
{
    List<byte> results = new List<byte>();
    foreach (UInt32 value in array)
    {
        byte[] converted = BitConverter.GetBytes(value);
        results.AddRange(converted);
    }
    return results.ToArray();
} 
```

-对数据进行编码。

```
 UInt32[] keyarray2 = new UInt32[2];
            //some code
            unsafe
            {
                fixed (UInt32* LPBYTE = keyarray2)
                {
                    Extern.encode(LPBYTE);
                }
            } 
```

在 keyarray2 被 Encode 函数覆盖后，我通过解密它们来检查 C++ 代码中的值，以确保一切正常。

好吧，这不好。那是我的问题，这就是为什么我要请你帮忙。

当我解密它们时值是不同的，但是如果我在 C++ 源代码中加密它们和解密它们，它们是相等的。C++ 代码是完全一样的，除了没有 DLL，因为代码是 C++。

可能是因为 Initialize 函数。几个月前我读过 C++ 中的数组作为指针传递。我不相信，但即便如此 - 这可能是问题吗？

我找不到线索。我用 C# 中的河豚浪费了我的生命。至少该解决方案应该有效，但它没有 - 为什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-29T22:51:54.210

您是否知道您正在初始化一个临时实例，该实例在 Initkey 函数返回时被破坏？您应该将整个内容组合在一个函数中，或者在堆上创建 cBlowfish 并将指针返回到 C# 代码（它可以将其视为不透明的 IntPtr）。

此外，您不需要在这里使用 unsafe 。只需直接传递 UInt32[] 即可。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-29T23:16:11.453

要补充 jachymko 所说的内容，还请查看 BitConverter 的文档 - 您需要确保以您想要的字节顺序传递密钥和数据。注意 - 在您之前的帖子中，我使用修改后的 Blowfish.NET 加密器成功加密了数据，并使其与您的 C++ 代码的结果相匹配。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-29T21:54:57.200

C 和 C++ 中的数组作为指针传递。C# 中数组的语义包括一个额外的间接层。您的 C# 程序（可能）正在传递保存数据地址的变量的地址。

我最近在将一个字节数组从 C# 传递到 C 函数中挣扎，并且不得不在两个方向上编组数据。对我来说，您的代码正在这样做并不明显。

比解释更好，我将提供一个具体的例子：

```
//extern "C" LIBEXIFWRAPPER_API void findEXIFtagValue( void * load, unsigned int tagID, char* buf, int bufLen );
[DllImport("libexif-wrapper.dll")]
unsafe public static extern IntPtr findEXIFtagValue([MarshalAs(UnmanagedType.SysUInt)]IntPtr load, int tagID, [MarshalAs(UnmanagedType.SysUInt)]IntPtr buf, int bufLen); 
```

此函数接受一个指向不透明数据的指针、一个 int 和一个字节数组，其中存储了一个文本字符串。

以下片段显示了如何声明字节数组、传递给 C 函数并提取结果：

```
const int tagBuffer = 1024;
IntPtr buf = Marshal.AllocHGlobal(tagBuffer);

findEXIFtagValue(loader, (int)ExifTag.EXIF_TAG_DATE_TIME, buf, tagBuffer);
string s = Marshal.PtrToStringAnsi(buf); 
```

请注意，参数在原型中被封送并再次被封送以检索结果。

这些对我来说都不是特别明显。似乎 IntPtr 是 void* 的 C# 等价物，除非我必须使用 SysUInt 来管理 (C) void*。指向字节数组的指针被编组为 SysUInt。

（来自 C# 菜鸟）

高温高压

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-29T22:36:03.450

也许你应该尝试使用`ref`指针，以及`out`通过参数返回数据的函数。让我知道这是否有效。谢谢。

# caching - NFS和缓存有什么关系？

> ID：695425
> 
> 赞同：0
> 
> 时间：2009-03-29T21:35:48.323
> 
> 标签：caching, nfs

这似乎应该是显而易见的，但我看不到答案。NFS 有缓存吗？它是如何工作的？它只是利用您的操作系统/文件系统缓存吗？它取决于您使用的客户端或服务器吗？

我在 Solaris 上使用 NFS 作为客户端，没有特殊的挂载选项。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-29T21:42:11.443

NFS 本身没有缓存，但是您的操作系统可能会在文件系统级别进行一些缓存。

来自 RFC 1813：

> NFS 版本 3 协议未定义客户端或服务器上的缓存策略。特别是，不支持客户端和服务器之间以及不同客户端之间的严格缓存一致性。

[http://www.unixcoding.org/NFSCoding](http://www.unixcoding.org/NFSCoding)解释了 NFS 缓存的一些实际问题。

# character-encoding - 获取给定编码的核心基础字符串的计算长度

> ID：695427
> 
> 赞同：1
> 
> 时间：2009-03-29T21:37:10.520
> 
> 标签：character-encoding, core-foundation, cfstring

有没有办法获取`CFString`给定任意字符编码的字节长度？这似乎是可能的，因为该函数`CFStringGetSmallestEncoding`必须已经进行了一些计算，但是我不想使用最小的编码，我想知道如果我想要 UTF-8 编码的字节或者可能需要分配多大的缓冲区另一种可变宽度字符编码。

是否可以？或者我是否需要使用分配最大可能的缓冲区大小`CFStringGetMaximumSizeForEncoding`？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-29T13:17:30.947

你有可用的基金会吗？如果是这样，您可以将 CFStringRef 转换为 NSString* 并使用 lengthOfBytesUsingEncoding:。

请记住，尽管 CFStringGetMaximumSizeForEncoding 是 O(1)，而 lengthOfBytesUsingEncoding: 在字符串的长度上是 O(n)（您实际上是在进行两次转换），因此使用 CFStringGetMaximumSizeForEncoding 分配缓冲区可能会更好。

# ruby - 在采用多个可选参数的方法中，除了第一个参数之外，如何指定？

> ID：695431
> 
> 赞同：12
> 
> 时间：2009-03-29T21:38:41.763
> 
> 标签：ruby

我有这样的方法：

```
def foo(fruit='apple', cut="sliced", topping="ice cream")
  # some logic here
end 
```

我怎么能在我只覆盖顶部参数但使用其他参数的默认值的情况下调用它，像这样

```
foo('','','hot fudge') 
```

当然这不能按预期工作，但我只想为第三个可选参数提供一个值，并让前两个坚持使用它们的默认值。我知道如何使用哈希来做到这一点，但他们是使用上述语法的快捷方式吗？

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2015-02-27T21:24:19.903

从 Ruby 2.0 开始，您可以使用关键字参数：

```
def foo(fruit: 'apple', cut: "sliced", topping: "ice cream")
  [fruit, cut, topping]
end

foo(topping: 'hot fudge') # => ['apple', 'sliced', 'hot fudge'] 
```

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2009-03-29T22:58:36.190

您不能在 ruby​​ 中使用此语法来执行此操作。我会为此推荐哈希语法。

```
def foo(args={})
  args[:fruit]    ||= 'apple'
  args[:cut]      ||= 'sliced'
  args[:topping]  ||= 'ice cream'
  # some logic here
end

foo(:topping => 'hot fudge') 
```

你也可以使用位置参数来做到这一点：

```
def foo(fruit=nil,cut=nil,topping=nil)
  fruit    ||= 'apple'
  cut      ||= 'sliced'
  topping  ||= 'ice cream'
  # some logic here
end

foo(nil,nil,'hot fudge') 
```

请记住，这两种技术都会阻止您将实际`nil`参数传递给函数（有时您可能想要这样做）

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-29T21:52:22.277

不，您必须检查函数 foo 中参数的值。如果它们是空字符串或 null，您可以将它们设置为默认参数。

# url - 制作 URL 的安全字符是什么？

> ID：695438
> 
> 赞同：195
> 
> 时间：2009-03-29T21:42:36.700
> 
> 标签：url, friendly-url

我正在制作一个包含文章的网站，并且我需要文章根据标题具有“友好”的 URL。

例如，如果我的文章标题是`"Article Test"`，我希望 URL 是`http://www.example.com/articles/article_test`。

但是，文章标题（作为任何字符串）可以包含多个特殊字符，这些字符无法在我的 URL 中按字面意思输入。例如，我知道`?`或`#`需要更换，但我不知道所有其他人。

URL 中允许使用哪些字符？什么是安全的？

* * *

## 回答 #1

> 赞同：246
> 
> 时间：2009-03-29T21:57:33.607

引用[RFC 3986](http://www.ietf.org/rfc/rfc3986.txt)的第 2.3 节：

> URI 中允许但没有保留用途的字符称为未保留字符。这些包括大写和小写字母、十进制数字、连字符、句点、下划线和波浪号。
> 
> ```
>  ALPHA  DIGIT  "-" / "." / "_" / "~" 
> ```

[请注意，与旧的RFC 2396](http://www.ietf.org/rfc/rfc2396.txt)相比，RFC 3986 列出的保留标点符号更少。

* * *

## 回答 #2

> 赞同：124
> 
> 时间：2009-03-29T21:56:45.917

您需要注意两组字符：**reserved**和**unsafe**。

**保留**字符是：

*   和号（“&”）
*   美元（“$”）
*   加号（“+”）
*   逗号 (",")
*   正斜杠（“/”）
*   冒号 （”：”）
*   分号 (";")
*   等于 ("=")
*   问号（“？”）
*   “在”符号（“@”）
*   英镑（“#”）。

通常认为**不安全**的字符是：

*   空间 （” ”）
*   小于和大于 ("<>")
*   打开和关闭括号（“[]”）
*   打开和关闭大括号（“{}”）
*   管道（“|”）
*   反斜杠（“\”）
*   插入符号（“^”）
*   百分 （”％”）

我可能忘记了一个或多个，这导致我附和[Carl V 的回答](https://stackoverflow.com/questions/695438/what-are-the-safe-characters-for-making-urls/695450#695450)。从长远来看，您最好使用允许字符的“白名单”然后对字符串进行编码，而不是试图与服务器和系统不允许的字符保持同步。

* * *

## 回答 #3

> 赞同：49
> 
> 时间：2016-11-04T03:58:39.180

### 始终安全

从理论上和规范来看，这些基本上在任何地方都是安全的，除了域名。[对未列出的任何内容进行百分比编码](https://en.wikipedia.org/wiki/Percent-encoding)，一切顺利。

```
 A-Z a-z 0-9 - . _ ~ ( ) ' ! * : @ , ; 
```

### 有时安全

只有在特定的 URL 组件中使用时才安全；小心使用。

```
 Paths:     + & =
    Queries:   ? /
    Fragments: ? / # + & = 
```

### 永远不安全

根据 URI 规范 (RFC 3986)，所有其他字符都必须进行百分比编码。这包括：

```
 <space> <control-characters> <extended-ascii> <unicode>
    % < > [ ] { } | \ ^ 
```

如果考虑最大兼容性，请将字符集限制为 AZ az 0-9 - _ 。（句点仅用于文件扩展名）。

### 牢记上下文

即使根据规范有效，URL 仍然可能是“不安全的”，具体取决于上下文。例如包含无效文件名字符的 file:/// URL，或者在不用作分隔符时包含“？”、“=”和“&”的查询组件。这些情况的正确处理通常取决于您的脚本并且可以解决，但请记住这一点。

* * *

## 回答 #4

> 赞同：45
> 
> 时间：2009-03-29T21:48:44.783

您最好只保留一些字符（白名单）而不是删除某些字符（黑名单）。

只要您正确编码，您可以在技术上允许任何字符。但是，为了回答问题的精神，您应该只允许这些字符：

1.  小写字母（将大写转换为小写）
2.  数字，0 到 9
3.  破折号 - 或下划线 _
4.  波浪号~

其他一切都有潜在的特殊意义。例如，您可能认为可以使用 +，但可以将其替换为空格。& 也很危险，尤其是在使用一些重写规则时。

与其他评论一样，请查看标准和规范以获取完整详细信息。

* * *

## 回答 #5

> 赞同：20
> 
> 时间：2014-07-19T01:47:13.400

查看[RFC3986 - Uniform Resource Identifier (URI): Generic Syntax](https://www.rfc-editor.org/rfc/rfc3986)，您的问题围绕着 URI 的**路径**组件。

> ```
>  foo://example.com:8042/over/there?name=ferret#nose 
> ```

```
 \_/   \______________/\_________/ \_________/ \__/
      |           |            |            |        |
   scheme     authority       path        query   fragment
      |   _____________________|__
     / \ /                        \
     urn:example:animal:ferret:nose 
```

引用第 3.3 节，URI`segment`的有效字符类型为`pchar`：

> pchar = unreserved / pct-encoded / sub-delims / ":" / "@"

分解为：

> ## `ALPHA / DIGIT / "-" / "." / "_" / "~"`
> 
> ## `pct-encoded`
> 
> ## `"!" / "$" / "&" / "'" / "(" / ")" / "*" / "+" / "," / ";" / "="`
> 
> ## `":" / "@"`

或者换句话说：您可以使用[ASCII 表](http://en.wikipedia.org/wiki/ASCII#mediaviewer/File:ASCII_Code_Chart-Quick_ref_card.jpg)中的任何（非控制）字符，*除了* `/`、`?`、`#`和。`[``]`

这种理解得到了[RFC1738 - 统一资源定位器 (URL)](https://www.rfc-editor.org/rfc/rfc1738#section-5)的支持。

* * *

## 回答 #6

> 赞同：12
> 
> 时间：2009-03-29T22:09:20.940

从您描述的上下文来看，我怀疑您实际上想要做的是一种叫做“SEO slug”的东西。最普遍的已知做法是：

1.  转换为小写
2.  将 az 和 0-9 以外的整个字符序列转换为一个连字符 (-)（不是下划线）
3.  从 URL 中删除“停用词”，即没有意义的可索引词，如“a”、“an”和“the”；谷歌“停用词”的广泛列表

因此，例如，一篇标题为“The Usage of !@%$* to Represent Swearing In Comics”的文章会得到一个“usage-represent-swearing-comics”的标题。

* * *

## 回答 #7

> 赞同：11
> 
> 时间：2010-12-01T22:28:38.703

未保留 = ALPHA / DIGIT / "-" / "." /“_”/“~”

* * *

## 回答 #8

> 赞同：6
> 
> 时间：2009-03-29T21:46:37.767

URI 的格式在[RFC 3986](http://www.ietf.org/rfc/rfc3986.txt)中定义。有关详细信息，请参见第 3.3 节。

* * *

## 回答 #9

> 赞同：6
> 
> 时间：2009-03-29T22:19:34.083

从 SEO 的角度来看，连字符比下划线更受欢迎。转换为小写，删除所有撇号，然后用单个连字符替换所有非字母数字字符串。剪掉开头和结尾多余的连字符。

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2011-09-30T12:48:13.030

我有一个类似的问题。我想要有漂亮的 URL，并得出结论，我必须在 URL 中只允许字母、数字和 - 和 _。

这很好，但后来我写了一些不错的正则表达式，我意识到它识别出所有 UTF-8 字符都不是 .NET 中的字母并且被搞砸了。这似乎是 .NET 正则表达式引擎的一个已知问题。所以我得到了这个解决方案：

```
private static string GetTitleForUrlDisplay(string title)
{
    if (!string.IsNullOrEmpty(title))
    {
        return Regex.Replace(Regex.Replace(title, @"[^A-Za-z0-9_-]", new MatchEvaluator(CharacterTester)).Replace(' ', '-').TrimStart('-').TrimEnd('-'), "[-]+", "-").ToLower();
    }
    return string.Empty;
}

/// <summary>
/// All characters that do not match the patter, will get to this method, i.e. useful for Unicode characters, because
/// .NET implementation of regex do not handle Unicode characters. So we use char.IsLetterOrDigit() which works nicely and we
/// return what we approve and return - for everything else.
/// </summary>
/// <param name="m"></param>
/// <returns></returns>
private static string CharacterTester(Match m)
{
    string x = m.ToString();
    if (x.Length > 0 && char.IsLetterOrDigit(x[0]))
    {
        return x.ToLower();
    }
    else
    {
        return "-";
    }
} 
```

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2015-03-28T08:02:28.333

当我通过 Ajax/PHP 将一个值返回到一个 URL 时，我发现将我的 URL 编码为一个安全的 URL 非常有用，然后页面会再次读取该 URL。

带有特殊字符的 URL 编码器的 PHP 输出`&`：

```
// PHP returning the success information of an Ajax request
echo "".str_replace('&', '%26', $_POST['name']) . " category was changed";

// JavaScript sending the value to the URL
window.location.href = 'time.php?return=updated&val=' + msg;

// JavaScript/PHP executing the function printing the value of the URL,
// now with the text normally lost in space because of the reserved & character.

setTimeout("infoApp('updated','<?php echo $_GET['val'];?>');", 360); 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-03-29T21:47:12.600

我认为您正在寻找类似“ [URL encoding](https://en.wikipedia.org/wiki/Percent-encoding) ”的东西 - 对 URL 进行编码，以便在网络上使用它是“安全的”：

这是一个参考。如果您不想要任何特殊字符，只需删除任何需要 URL 编码的字符：

*[HTML URL 编码参考](http://www.w3schools.com/TAGS/ref_urlencode.asp)*

* * *

## 回答 #13

> 赞同：-4
> 
> 时间：2016-02-23T15:44:00.703

3-50 个字符之间。可以包含小写字母、数字和特殊字符 - 点 (.)、破折号 (-)、下划线 (_) 和比率 (@)。

# asp.net - 将存储库模式与实体框架（mvc 店面）一起使用

> ID：695440
> 
> 赞同：13
> 
> 时间：2009-03-29T21:44:23.060
> 
> 标签：asp.net, asp.net-mvc, entity-framework, domain-driven-design, entity

任何人都可以伸出援助之手吗？我一直在观看 MVC 店面的视频，并使用这些技术（即 DDD、存储库模式）创建了自己的网站，但我希望使用实体框架。

在接口中它返回 IQueryable 但使用实体框架我应该返回 ObjectQuery 吗？- 我将使用 LINQ。

同样在storedfront示例中，它是这样的： IQueryable<Category> GetCategories();

同样在 MVC 商店中，Category 类是一个构建的实体类（标准类），但是使用 Entity Framework，这些类是在对象上下文中预构建的——不是吗？

所以我应该需要建造它们吗？

我有点困惑。如果有人有任何有用的示例或代码，那将非常有帮助。

正如我所说，我已经使用 linq2sql 观看了 MVC 店面中的视频，但我真的很想使用实体框架。

有任何想法吗？

谢谢

铁匠铺

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-03-30T13:14:43.497

让我一次一个地回答你的问题：

您的存储库*应*返回 IQueryable<T>，*而不是*ObjectQuery。原因是存储库模式的全部目的是抽象出数据存储的细节。这允许您在对控制器进行单元测试时执行诸如替换模拟存储库之类的操作。如果您让存储库返回 ObjectQuery，那么您并没有抽象出实体框架。另一种说法是，您的存储库的用户不应该尽可能多地知道它是执行 O/R 映射的实体框架。

为了在 Stack Overflow 的段落文本中使用大于和小于符号，您必须像在 HTML 中一样对它们进行转义，即：

```
&lt; 
```

您不需要在代码块中执行此操作；在代码块中，您只需键入小于/大于符号。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-03-30T01:14:57.877

如果您在[http://www.asp.net/learn/mvc/#MVC_SampleApp](http://www.asp.net/learn/mvc/#MVC_SampleApp)站点中看到联系人管理器教程，也许他们使用了存储库模式和实体框架。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-05-04T19:06:28.957

几周前我开始像您一样，您会发现使用 EF 非常容易。我的项目很小，所以我使用 EF 生成的实体作为我的模型类，您可以使用部分类向它们添加自己的逻辑。

这是我的一个存储库的一个简单方法，例如：

```
 /// <summary>
    /// Finds a user by it's credentials
    /// </summary>
    /// <param name="oUser"></param>
    /// <returns></returns>
    public User FindByCredentials(string username, Byte[] password)
    {
        User user = null;

        if (!Validators.IsStringEmptyOrNull(username))
        {
            user = this.FindByCredentialsQuery(username, password).FirstOrDefault<User>();
        }

        return (Validators.IsNull(user)) ? new User() : user;

    }

    /// <summary>
    /// Finds a user by it's credentials
    /// </summary>
    /// <param name="username"></param>
    /// <param name="password"></param>
    /// <returns></returns>
    protected IQueryable<User> FindByCredentialsQuery(string username, Byte[] password)
    {
        var query = from Users in this.UserDataContext.Users
                    where
                        (Users.Username == username) &&
                        (Users.Password == password) &&
                        (Users.Enabled == true)
                    select Users;

        return query;
    } 
```

请注意，我仅在存储库内使用 IQueryable，并且仅返回请求的实体列表。这样我可以控制对 DB 的查询始终在 Repo 内执行。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2011-05-11T16:37:23.030

一个新的 MVC 教程系列包括一个存储库示例，其中包括带有参数的方法，这些方法允许您指定过滤器、排序等，而不返回 IQueryable： [http ://www.asp.net/entity-framework/tutorials/implementing-the -repository-and-unit-of-work-patterns-in-an-asp-net-mvc-application](http://www.asp.net/entity-framework/tutorials/implementing-the-repository-and-unit-of-work-patterns-in-an-asp-net-mvc-application)

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2010-12-01T07:21:44.793

一个很好的实体框架通用存储库（活动）： http: [//www.codeproject.com/KB/database/ImplRepositoryPatternEF.aspx](http://www.codeproject.com/KB/database/ImplRepositoryPatternEF.aspx)

现在我使用这个作为应用程序框架（包括一个完美的存储库） [http://efmvc.codeplex.com/](http://efmvc.codeplex.com/)

请大喊一声；）

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-05-04T18:32:30.023

我不确定这是否正确，但我正在使用 L2E，使用[AutoMapper](http://www.codeplex.com/AutoMapper) 3rd 方工具将生成的对象转换为域对象。

# ruby - 猴子修补核心类的替代方案

> ID：695441
> 
> 赞同：9
> 
> 时间：2009-03-29T21:45:15.447
> 
> 标签：ruby, oop, monkeypatching

我对 Ruby 还是很陌生，基本上只是在完成 Cooper 的书之后才编写我的第一个微程序。我被指出了避免猴子修补的方向，但问题是我不知道实现相同行为的替代方法是什么。基本上，我想添加一个每个字符串对象都可以访问的新方法。显而易见的猴子修补方法是：

```
class String
  def do_magic
    ...magic...
  end
end 
```

我记得有一种使用 String.send 的方法。但我不记得它是如何完成的，也不记得我在哪里读到的。谁能指出仍然让我将该方法用于 String 类和子对象的任何替代方法？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-03-29T22:28:48.180

这样做的任何其他方式都只是猴子修补的一种更尴尬的语法。有涉及各种事物的方法，但是`send`为什么*呢*？继续并以明显的方式进行。`eval`

 *在大型项目中或当你有依赖项时，你要小心猴子修补，因为当几只手都在同一个地方搞砸时，你可能会发生冲突。这并不意味着要寻找一种替代语法来完成相同的事情——这意味着当您进行可能影响不属于您的代码的更改时要小心。在您的特定情况下，这可能不是问题。这只是大型项目中可能需要解决的问题。

Ruby 中的一种替代方法是您可以向单个对象添加方法。

```
a = "Hello"
b = "Goodbye"
class <<a
  def to_slang
    "yo"
  end
end
a.to_slang # => "yo"
b.to_slang # NoMethodError: undefined method `to_slang' for "Goodbye":String 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-03-30T05:04:30.413

如果您想添加一个可供每个字符串对象访问的新方法，那么按照您拥有的方式进行操作就是如何完成它。

一个好的做法是将核心对象的扩展放在单独的文件（如`string_ex.rb`）或子目录（如`extensions`或`core_ext`）中。这样一来，扩展的内容就很明显了，人们很容易看到它们是如何扩展或更改的。

猴子修补可能会出错的地方是，当您更改核心对象的某些现有行为时，会导致其他一些期望原始功能行为不端的代码。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-29T22:56:09.207

该类`object`定义了`send`，所有对象都继承了它。你“发送”一个对象的`send`方法。该`send`方法的参数是您想要调用的方法的名称作为符号，后跟任何参数和一个可选块。您也可以使用`__send__`.

```
>> "heya".send :reverse
=> "ayeh"

>> space = %w( moon star sun galaxy )
>> space.send(:collect) { |el| el.send :upcase! }
=> ["MOON", "STAR", "SUN", "GALAXY"] 
```

**编辑..**

您可能想使用以下`define_method`方法：

```
String.class_eval {
  define_method :hello do |name|
    self.gsub(/(\w+)/,'hello') + " #{name}"
  end
}

puts "Once upon a time".hello("Dylan")
# >> hello hello hello hello Dylan 
```

这增加了实例方法。添加类方法：

```
eigenclass = class << String; self; end
eigenclass.class_eval {
  define_method :hello do
    "hello"
  end
}

puts String.hello
# >> hello 
```

但是，您不能定义需要块的方法。

[阅读Why's Poignant Guide](http://poignantguide.net/ruby/chapter-6.html)中的这一章可能是件好事，您可以跳到“Dwemthy 的数组”以了解元编程的内容。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-30T18:49:34.610

多谢你们。

所有建议的实施工作。更重要的是，我学会了权衡手头的案例，并决定重新打开核心（或库）类是否是一个好主意。

FWIW，一位朋友指出了`send`我正在寻找的实现。但是现在我看它，它比所有其他实现更接近于猴子补丁:)

```
module M
    def do_magic
    ....
    end
end
String.send(:include, M) 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-11-07T09:23:32.867

作为将函数附加到类或对象的替代方法，您始终可以采用函数式路线：

```
class StringMagic
  def self.do(string)
     ...
  end
end

StringMagic.do("I'm a String.") # => "I'm a MAGIC String!" 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2016-04-06T22:18:08.087

如果其他人想要您的代码（例如，作为 gem），您描述的“猴子补丁”确实可能是一个问题。谁说他们不想添加一个名为 do_magic 的 String 方法？一种方法将覆盖另一种方法，这可能很难调试。如果您的代码有可能是开源的，那么最好创建自己的类：

```
class MyString < String
  def initialize(str)
    @str = str
  end
  def do_magic
    ...magic done on @str
    @str
  end
end 
```

现在，如果你需要 do_magic 你可以

```
magic_str = MyString.new(str).do_magic 
```

# css - CSS 在 Zend 框架中没有正确应用

> ID：695443
> 
> 赞同：0
> 
> 时间：2009-03-29T21:45:47.877
> 
> 标签：css, zend-framework

我是 Zend 框架的新手。

如果我通过访问[http://localhost/zendapplicationfolder/contact](http://localhost/zendapplicationfolder/contact)访问我的 Zend 应用程序，它会正确显示并正确应用 css 但如果我通过访问[http://localhost/zendapplicationfolder/contact/](http://localhost/zendapplicationfolder/contact/)访问 Zend 应用程序（添加正斜杠)，页面显示但没有应用css，但是如果我查看源代码，css链接通常嵌入在head标签之间。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-29T22:06:34.927

包含 CSS 的 dcode 应该在布局文件中，并且**应该**使用 baseurl 帮助程序，而不是手动编写指向 css 文件的链接。

助手类：

```
class Zend_View_Helper_BaseUrl
{
    function baseUrl()  {
        return Zend_Controller_Front::getInstance()->getBaseUrl();
    }
} 
```

布局中的代码：

```
<link rel="stylesheet" type="text/css" media="screen" href="<?=$this->baseUrl();?>/your/path/from base url/your.css" /> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-30T04:39:08.337

在不知道您的项目布局的情况下，我怀疑您可以通过使用`/css/screen.css`而不是`css/screen.css`该正斜杠来解决问题，该正斜杠将为您提供 css 目录的绝对路径，而不是您正在使用的相对路径。

例如，这有效：`<?php echo $this->headLink()->appendStylesheet('/css/main.css') ?>` 虽然这符合您的描述：`<?php echo $this->headLink()->appendStylesheet('css/main.css') ?> the only diff is the forward slash in front of css.`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-29T03:02:08.753

我想在添加样式表时我必须对我的代码进行一些更改。事实证明，我需要更改的只是添加 gaoshan88 指出的正斜杠（谢谢！）：

href="stylesheets/main3.css"
到
href="/stylesheets/main3.css"

# database - Mac最好的数据库管理软件？

> ID：695444
> 
> 赞同：2
> 
> 时间：2009-03-29T21:46:19.093
> 
> 标签：database, macos

OSX 最好的数据库管理软件是什么？

*   维护数据库模式和数据
*   运行查询
*   将模式从一种数据库类型转换为另一种
*   数据泵移动数据
*   模式差异工具，理想情况下能够构建脚本来更新模式
*   便于使用

我感兴趣的数据库是

*   微软SQL
*   PostgreSQL
*   MySQL
*   火鸟
*   (SQLite)

最好为所有数据库使用一种工具，而不是为每个数据库使用一种工具。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-29T22:04:10.970

对于 MySql，请使用[http://www.sequelpro.com/（foss](http://www.sequelpro.com/)）或[http://www.araelium.com/querious/](http://www.araelium.com/querious/)（付费）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-29T22:29:28.833

我过去使用过[SQuirreL SQL](http://www.squirrelsql.org/)。它是用 Java 编写的，因此它可以在任何具有良好 JVM 的平台和任何具有良好 JDBC 驱动程序的数据库上工作。我认为它会做大部分，如果不是你所要求的全部。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-29T22:42:06.900

对于 postgres，pgAdmin3 在最近的几个版本中变得更好，并且在 OS X 中运行良好。我也使用过 SQuirrel，它适用于 jdbc 兼容的数据库，但已经有一段时间了。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-29T22:23:46.070

我每天在工作中使用[Aqua Data studio 6，包括 SQL Server、Sybase IQ 和 Netezza。](http://www.aquafold.com/index.html)不必一直切换工具很方便。它还有一个方便的 SQL 更漂亮，当人们给我发送错误的 SQL 来查看时，它可以帮助我保持低血压。Netezza 不受支持，但适用于通用 ODBC/JDBC。

虽然它是一个 java 应用程序，但我真正遇到问题的唯一时间是当我运行一个返回许多行（超过 100k）的查询时。您可以设置限制和/或玩记忆，但每隔一段时间我就会在脚上射击自己并敲击键盘。

我运行 windows 但也支持 linux 和 mac。

Nice 刚刚注意到版本 7 内置了数据透视表。这将使我免于将数据集剪切和粘贴到 Excel 中！

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-03-29T22:47:13.237

对于 MySQL，您可以尝试：

1.  [MySQL 管理员](http://dev.mysql.com/downloads/gui-tools/5.0.html)
2.  [PHP Mysql Admin](http://www.phpmyadmin.net/)（如果您不介意安装 PHP Web 应用程序）
3.  [Oracle 的 SQLDeveloper](http://www.oracle.com/technology/products/database/sql_developer/index.html)（与 MySQL 一起工作，也需要一点配置）

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-03-12T12:26:03.863

我是一名 Mac 开发人员，也想要其中一些工具，所以我构建了一些工具。

*   [用于 SQLite 的 SQLPro](https://www.sqlitepro.com/)
*   [用于 MSSQL 的 SQLPro](http://macsqlclient.com/)和
*   [用于 MySQL 的 SQLPro](http://mysqlui.com/)

用于 SQLite 的 SQLPro 是最古老的，并且以 4 星的平均评级和很好的评论获得了相当不错的评价。

SQLPro for MSSQL 它是一个更新的应用程序，用于连接到 MSSQL 数据库（特别是我想要 Azure 支持，但它也支持其他版本），它也得到了很好的评价。

一些人也向我询问了 Postgres 版本，因此它将在不久的将来推出。

# javascript - 如何将函数名转换为字符串

> ID：695456
> 
> 赞同：7
> 
> 时间：2009-03-29T21:52:11.357
> 
> 标签：javascript

我有一个对象的函数，比如说 Object.MyFunc。我需要将此函数名称发送到另一个函数，如下所示：doSomething("Object.MyFunc");

有什么建议吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2015-10-28T14:44:55.157

这是一个老问题，但在 ES6 中，这种能力是通过[`Function.name`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Function/name)属性提供的。ECMAScript 2015[语言规范](http://www.ecma-international.org/ecma-262/6.0/)定义[了如何将此属性添加到 Function 实例](http://www.ecma-international.org/ecma-262/6.0/#sec-setfunctionname)：

> 9.2.11 SetFunctionName（F，名称，前缀）
> 
> 抽象操作`SetFunctionName`需要一个`Function`参数`F`、一个`String`或`Symbol`参数`name`和可选的`String`参数前缀。此操作通过执行以下步骤添加`name`属性： ...`F`

不幸的是，这还没有在所有主要浏览器中实现：[这里](http://kangax.github.io/compat-table/es6/#test-function_name_property)列出的不是所有 IE 版本都支持它，并且在所有其他主要浏览器中仅部分支持（Edge 13 目前具有最好的支持，尽管仍然是部分支持）。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-29T21:57:37.600

没有一个很好的方法来获取函数名。在 JavaScript 中，您可以拥有匿名函数，因此没有合适的方式来命名它们。

无论如何，使用`arguments.callee.toSring()`. 例如：

```
function foo() {
    alert("I am " + arguments.callee.toString());
} 
```

但是，这很糟糕，因为并非所有函数都有名称，并且某些浏览器可能会将特定于实现的详细信息附加到此字符串。

但是，也许除了获得名字之外，您还试图做其他事情？如果你想最终调用函数，你实际上可以传递函数本身。这称为 lambda 函数。例如：

```
function foo(inFunc) {
    inFunc();
}

foo(function() { alert("foo"); }); 
```

上面的代码创建了一个弹出警报的匿名函数。然后将其传递给`foo`函数，该函数只调用传递给它的任何函数。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-29T21:55:42.737

如果您尝试`MyFunc`从内部调用`doSomething`，则可以传递实际函数：

```
var someObject = new Object();
someObject.MyFunc = function() { alert('test'); }
function doSomething(func) {
    func();
}
doSomething(someObject.MyFunc); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-30T01:59:49.750

正如其他人所指出的，很可能无论您尝试做什么，都可以通过不同的方式做得更好。但是，如果您确实需要查找函数的名称，有一种相当简单的方法可以做到这一点，但并非在所有情况下都有效。

```
//returns the name of the function func on the object obj
function getFuncName(obj, func){
  for(var funcName in obj){
    if(obj[funcName] === func){
      return funcName;
    }
  }
}

alert(getFuncName(Object, Object.MyFunc)); //alerts "MyFunc" 
```

这里的限制是你需要对象和函数，并且函数必须是可迭代的——这意味着它不能是内置函数。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-30T05:51:32.623

也许你的意思是这样的？

```
function getFn(fnName){
    for (var l in yourObj){
      if (l === fnName && yourObj[l] instanceof Function){
        return [ l, yourObj[l] ];
      }
    }
    return [fnName ,'not found'];
} 
```

循环遍历对象并传递包含方法名称和指向方法的指针（或错误消息）的数组。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2009-03-29T22:38:39.763

如果你有这个功能：

```
function test()
{
  alert('here');
} 
```

你可以这样调用它：

```
function testTest(func)
{
   func();
}

testTest(test); 
```

# java - 使用 Java AWT 将图像添加到面板

> ID：695458
> 
> 赞同：4
> 
> 时间：2009-03-29T21:52:47.347
> 
> 标签：java, image, awt, frames, panels

我之前发布过关于面板非常混乱的帖子，但是我通过简单地更改布局来解决这个问题（感谢查理马丁的帮助）。现在，我正在尝试将图像添加到面板中，以便可以将该面板添加到框架中。这是我正在搞砸的课程的一部分。

~~[http://friendpaste.com/13zibFC4oVxCbm83500KVj](http://friendpaste.com/13zibFC4oVxCbm83500KVj)~~ （死链接）

这就是我运行程序并点击开始游戏（在启动弹出窗口上）时出现的情况.. ![截屏](https://i.stack.imgur.com/WnKCw.jpg)

本质上，主窗口上应该有一个图像以及按钮，我不确定我将如何实现这一点。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-29T22:07:03.100

我可能只是在 JLabel 上设置一个 ImageIcon 并将 JLabel 添加到面板中您想要的位置。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-29T22:29:55.790

请，请，请-不要-使用 JLabel。虽然这是最简单的方法，但它也是不好的做法，并且当您的图像不是您想要显示的实际尺寸时会导致问题。

第二个答案是在正确的道路上，但仍然有同样的问题。

这是我过去写的一门课程，这是您需要的：

如果需要，它还允许您设置特定的大小；它将缩放图像以最适合面板，并对齐图像。

```
import java.awt.Dimension;
import java.awt.Graphics;
import java.awt.Image;
import java.awt.Insets;
import java.awt.print.PageFormat;
import java.awt.print.Printable;
import java.awt.print.PrinterException;
import java.io.File;

import javax.swing.ImageIcon;
import javax.swing.JComponent;
import javax.swing.SwingConstants;

public class ImagePanel extends JComponent implements SwingConstants, Printable {

    private Image image;
    private int verticalAlignment = CENTER;
    private int horizontalAlignment = CENTER;

    public ImagePanel() {}

    public ImagePanel(Image image) {
        setImage(image);
    }

    public Image getImage() {
        return image;
    }

    public void setImage(Image image) {
        this.image = image;
        repaint();
    }

    public void setImage(String file) {
        setImage(new ImageIcon(file).getImage());
    }

    public void setImage(File file) {
        setImage(new ImageIcon(file.getAbsolutePath()).getImage());
    }

    public void setImage(byte[] imageData) {
        setImage(imageData==null ? null : new ImageIcon(imageData).getImage());
    }

    public int getVerticalAlignment() {
        return verticalAlignment;
    }

    /**
     * @beaninfo
     *        bound: true
     *         enum: TOP    SwingConstants.TOP
     *               CENTER SwingConstants.CENTER
     *               BOTTOM SwingConstants.BOTTOM
     *    attribute: visualUpdate true
     *  description: The alignment of the image along the Y axis.  
     */
    public void setVerticalAlignment(int verticalAlignment) {
        if( (verticalAlignment==TOP) || (verticalAlignment==CENTER) || (verticalAlignment==BOTTOM) )
            this.verticalAlignment = verticalAlignment;
        else
            throw new IllegalArgumentException("Invalid Vertical Alignment: " + verticalAlignment);
    }

    public int getHorizontalAlignment() {
        return horizontalAlignment;
    }

    /**
     * @beaninfo
     *        bound: true
     *         enum: LEFT    SwingConstants.LEFT
     *               CENTER SwingConstants.CENTER
     *               RIGHT SwingConstants.RIGHT
     *    attribute: visualUpdate true
     *  description: The alignment of the image along the X axis.  
     */
    public void setHorizontalAlignment(int horizontalAlignment) {
        if( (horizontalAlignment==LEFT) || (horizontalAlignment==CENTER) || (horizontalAlignment==RIGHT) )
            this.horizontalAlignment = horizontalAlignment;
        else
            throw new IllegalArgumentException("Invalid Horizontal Alignment: " + horizontalAlignment);
    }

    @Override
    public Dimension getPreferredSize() {
        if(image == null)
            return super.getPreferredSize();
        else
            return new Dimension(image.getWidth(this), image.getHeight(this));
    }

    @Override
    protected void paintComponent(Graphics g) {
        super.paintComponent(g);

        if(image==null)
            return;

        Insets insets = getInsets();
        int x = insets.left;
        int y = insets.top;

        int w = getWidth() - insets.left - insets.right;
        int h = getHeight() - insets.top - insets.bottom;

        int src_w = image.getWidth(null);
        int src_h = image.getHeight(null);

        double scale_x = ((double)w)/src_w;
        double scale_y = ((double)h)/src_h;

        double scale = Math.min(scale_x, scale_y);

        int dst_w = (int)(scale * src_w);
        int dst_h = (int)(scale * src_h);

        int dx = x + (w-dst_w)/2;
        if(horizontalAlignment==LEFT)
            dx = x;
        else if(horizontalAlignment==RIGHT)
            dx = x + w - dst_w; 

        int dy = y + (h-dst_h)/2;
        if(verticalAlignment==TOP)
            dy = y;
        else if(verticalAlignment==BOTTOM)
            dy = y + h - dst_h; 

        g.drawImage(image, dx, dy, dx+dst_w, dy+dst_h, 0, 0, src_w, src_h, null);
    }

    public int print(Graphics graphics, PageFormat pageFormat, int pageIndex) throws PrinterException {

        if(pageIndex>0 || image==null)
            return NO_SUCH_PAGE;

        double w = pageFormat.getImageableWidth();
        double h = pageFormat.getImageableHeight();

        int src_w = image.getWidth(null);
        int src_h = image.getHeight(null);

        double scale_x = w/src_w;
        double scale_y = h/src_h;

        double scale = Math.min(scale_x, scale_y);

        int dst_w = (int)(scale * src_w);
        int dst_h = (int)(scale * src_h);

        int dx = (int)((w-dst_w)/2);

        int dy = (int)((h-dst_h)/2);

        graphics.drawImage(image, dx, dy, dx+dst_w, dy+dst_h, 0, 0, src_w, src_h, null);

        return PAGE_EXISTS;
    }
} 
```

# c# - Pro LINQ 书中的 OrderBy 签名错误？

> ID：695459
> 
> 赞同：0
> 
> 时间：2009-03-29T21:53:49.717
> 
> 标签：c#, .net, linq, errata

根据[Pro LINQ: Language Integrated Query in C# 2008](http://www.apress.com/book/view/9781590597897)，*OrderBy*运算符的原型是

```
public static IOrderedEnumerable<T> OrderBy<T, K>(
    this IEnumerable<T> source,
    Func<T, K> keySelector)
where
    K : IComparable<K> 
```

但是[MSDN 文档对](http://msdn.microsoft.com/en-us/library/bb534966.aspx)*TKey*没有泛型约束，它应该是类型`IComparable<TKey>`

```
public static IOrderedEnumerable<TSource> OrderBy<TSource, TKey>(
    this IEnumerable<TSource> source,
    Func<TSource, TKey> keySelector
) 
```

我基本上是按*Unit*然后按*Size*对 Inventory 进行排序。

```
 var sortedInventories = inventories
                            .OrderBy(inventory => inventory.Unit)
                            .OrderBy(inventory => inventory.Size); 
```

从上面的代码片段中，lambda 表达式只是返回要排序的库存属性。它看起来不像返回的表达式`IComparer<T>`

但根据逻辑，看起来 lambda 表达式应该是 type `IComparer<T>`。

**哪个是正确的声明`OrderBy`？**
（Apress.com [Errata 页面](http://www.apress.com/book/errata/648)上没有任何信息）

这是我为测试而创建的示例应用程序`OrderBy`

```
public class Program
{
    public static void Main(string[] args)
    {
        var inventories = new[] {
            new Inventory { Unit = 1, Size = 2 },
            new Inventory { Unit = 2, Size = 4 },
            new Inventory { Unit = 3, Size = 6 },
        };
        var sortedInventories = inventories
                                .OrderBy(inventory => inventory.Unit)
                                .OrderBy(inventory => inventory.Size);

        foreach (var inventory in sortedInventories)
            Console.WriteLine("Unit: {0}; Size = {1}", inventory.Unit, inventory.Size);
    }
}

public class Inventory
{
    public int Unit { get; set; }
    public double Size { get; set; }
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-29T21:58:02.793

将您的第二个“OrderBy”更改为“ThenBy”。您目前正在使用*所有*东西，因此它有效地按大小，然后按单位，但效率低下。我不确定您认为`IComparer<T>`应该从哪里进入，除非您将其指定为另一个参数。基本上它使用`Comparer<T>.Default`，除非您指定一个单独的比较器。

无论如何，您的查询应该是：

```
var sortedInventories = inventories
                          .OrderBy(inventory => inventory.Unit)
                          .ThenBy(inventory => inventory.Size); 
```

（根据您的测试数据，您无法区分，因为在每种情况下`Size = Unit * 2`。尝试使用一个具有小单元和大尺寸的项目。）

是的，看起来这本书的签名有点错误——可能是因为它在发布前不久发生了变化。如果您基本上担心得到错误的结果，以上就是解释。

# powershell - PowerShell 转换从函数返回的值。如何避免这种情况？

> ID：695474
> 
> 赞同：5
> 
> 时间：2009-03-29T21:59:28.377
> 
> 标签：powershell, return-value

我正在尝试从 PowerShell 函数返回 List< T> ，但得到以下之一：

1.  null - 用于空列表
2.  System.Int32 - 一个元素的列表
3.  System.Object[] - 用于包含更多元素的列表

代码：

```
function CreateClrList
{
    $list = New-Object "System.Collections.Generic.List``1[System.Int32]"
    $list.Add(3)
    $list
}

Write-Host (CreateClrList).GetType() 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-03-29T22:09:38.023

是的，powershell 展开所有集合。一种解决方案是使用一元逗号返回包含真实集合的集合：

```
function CreateClrList
{
    $list = New-Object "System.Collections.Generic.List``1[System.Int32]"
    $list.Add(3)
    ,$list
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-10-20T23:43:45.633

请注意，大多数情况下，您*希望*Powershell 展开可枚举类型，以便管道命令执行得更快并获得更早的用户反馈，因为管道中的命令可以开始处理第一个项目并提供输出。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-19T07:07:29.530

如果您需要返回整数列表，请使用[jachymko 的解决方案](https://stackoverflow.com/a/695483/29430)。

否则，如果您并不特别关心得到的是列表还是数组，而只是想遍历结果，则可以在枚举时将结果包装在 @() 中，例如

```
$fooList = CreateClrList
foreach ($foo in @($fooList))
{
    ...
} 
```

这将导致`@($fooList)`成为数组类型 - 一个空数组、一个元素的数组或多个元素的数组。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-12-05T07:31:35.257

PowerShell 5.0 添加了对类的支持，因此添加了可以指定返回类型的方法。要控制返回的类型，请使用具有静态方法的类：

```
class ListManager {
    static [System.Collections.Generic.List[int]] Create() {
        [System.Collections.Generic.List[int]] $list =
            [System.Collections.Generic.List[int]]::new()

        $list.Add(3)

        return $list
     }
}

[ListManager]::Create().GetType() 
```

# c# - 在运行时设置强类型数据集连接字符串的最佳方法？

> ID：695491
> 
> 赞同：13
> 
> 时间：2009-03-29T22:14:22.443
> 
> 标签：c#, visual-studio, ado.net

我的 Windows 窗体应用程序使用在 Visual Studio 中使用设计器创建的强类型数据集。在运行时，我希望能够选择实时数据库或测试数据库。

在运行时以编程方式为数据集设置连接字符串的最佳方法是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2010-05-27T08:13:53.387

TableAdapters 中的 Connection 属性定义为**internal**。

```
internal global::System.Data.SqlClient.SqlConnection Connection 
```

> 因此，如果您的 TypedDataset 与您的主 Windows 窗体应用程序不在同一个程序集中，您将无法访问 Connection 属性。当您重构数据集代码并将其移动到将生成其自己的独立程序集的单独项目中时，此问题可能会在稍后弹出。

要解决此问题，您可以执行以下操作。

为您的 TableAdapter 创建部分类，并在默认的公共无参数构造函数旁边添加另一个构造函数。假设 TableAdapter 类型为 MyTableAdapter

```
public partial class MyTableAdapter
{
    public MyTableAdapter(SqlConnection connection)
    {
        thisSetConnection(connection);
        this.ClearBeforeFill = true;
    }

    public void SetConnection(SqlConnection connection)
    {
        this._connection = connection;
    }
} 
```

您需要对项目中的尽可能多的 TableAdapter 执行此操作。TableAdapter 没有任何公共基类，但感谢它们被声明为部分类，因此我们能够按照上述方式进行操作。

现在在运行时，您可以像这样创建 TableAdapter 的实例。

```
SqlConnection connection;
//create the connection here at runtime..
MyTableAdapter adapter = new MyTableAdapter(connection); 
```

或者甚至可以在您使用默认的无参数公共构造函数创建 TableAdapter 实例之后再分配它。

```
SqlConnection connection;
//create the connection here at runtime..
MyTableAdapter adapter = new MyTableAdapter();
adapter.SetConnection(connection); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2020-02-18T09:12:19.227

默认情况下，该`Connection`属性设置为[`internal`](https://docs.microsoft.com/en-us/dotnet/csharp/language-reference/keywords/internal)。这可以在 DataSet 的设计器中更改。

1.  右键单击表适配器。

[![在此处输入图像描述](https://i.stack.imgur.com/eQ5yP.png)](https://i.stack.imgur.com/eQ5yP.png)

2.  然后将`ConnectionModifier`属性更改为`public`.

[![在此处输入图像描述](https://i.stack.imgur.com/7eq1x.png)](https://i.stack.imgur.com/7eq1x.png)

3.  您现在可以访问`Connection`项目中的属性。

```
var loginsTableAdapter = new MyDataSetTableAdapters.LoginsTableAdapter();
loginsTableAdapter.Connection.ConnectionString = _myConnectionString; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-30T00:50:33.753

回复：wethercotes 评论

向导会在您设置数据集时存储连接字符串，但这并不意味着您不能使其成为动态的。具体如何取决于您使用的版本，但一般来说，如果您展开数据集下的文件，您会发现像 Designer.cs 或 DataTableNameAdapter.xsd 这样的文件。您可以打开这些文件并搜索 _connection。这通常是一个私有变量，并在类的 init 函数中设置。

您可以通过添加如下代码使设置动态化：

```
public string ConnectionString
{
    get { return this._connection.ConnectionString; }
    set
    {
        if (this._connection == null)
        {
            this._connection = new System.Data.SqlClient.SqlConnection();
        }
        this._connection.ConnectionString = value;
    }
} 
```

请注意，如果您重新生成数据集，您可能会丢失这部分代码，并且如果不重构数据集，您可能必须将其添加到多个对象中。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-29T22:17:47.130

将它们的连接字符串都存储在 app.config 中，然后您可以根据命令行/启动开关进行切换。或者，如果您想为用户提供灵活性，您可以为他们提供一个选项页面，他们可以在其中选择要使用的连接。

下面是读取启动开关的代码：

```
string[] args = Environment.GetCommandLineArgs();
// The first (0 index) commandline argument is the exe path.
if (args.Length > 1)
{
    if (Array.IndexOf(args, "/live") != -1)
    {
        // connection string = 
        // ConfigurationSettings.AppSettings["LiveConString"];
    }
}
else
{
    // connection string = 
    // ConfigurationSettings.AppSettings["TestConString"];
} 
```

所以现在你通过调用来启动你的应用程序：

```
MyApp.exe /live 
```

单独使用 MyApp.exe 或与任何其他开关一起使用将为您提供测试配置。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2011-01-13T05:01:13.890

编辑设计器文件很痛苦。

我在“用户”下创建了一个名为“ConnectionString”的设置条目，当您添加强类型数据集时，这会使 Visual Studio 创建一个应用程序字符串“连接字符串 1”。

因此，我只需将数据集设计器文件中的所有 'ConnectionString1' 替换为 'ConnectionString'，这将允许您使用 'User' 字符串设置在运行时加载连接字符串。

恕我直言，这是一个缺点，允许用户在运行时修改连接字符串。（有人在雷德蒙德听吗？）

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-12-10T16:45:21.727

使用 TableAdapterManager 可能对您有用。请阅读更多内容：[http ://rajmsdn.wordpress.com/2009/12/09/strongly-typed-dataset-connection-string/](http://rajmsdn.wordpress.com/2009/12/09/strongly-typed-dataset-connection-string/)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2010-05-27T07:56:21.900

到目前为止我发现的最佳解决方案：

添加另一个程序设置，其中包含客户端在运行时设置的首选连接字符串（例如 newConnectionString）

然后在使用表适配器之前：

```
this.myTableAdapter.Connection.ConnectionString = Properties.Settings.Default.newConnectionString; 
```

# file - 什么是正常的chmod？

> ID：695497
> 
> 赞同：41
> 
> 时间：2009-03-29T22:18:14.290
> 
> 标签：file, permissions, chmod

在我的网络服务器上，我的文件权限无处不在，我想将所有内容“重置”回原来的样子。我不希望任何用户能够进来并从我的网络服务器上删除东西！我只是希望他们能够查看 php 页面等。

我应该使用什么 chmod？

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2015-03-11T17:47:53.013

这是我收集的摘要

*   chmod所有**文件**到**644**
*   全部修改。**htaccess**文件到**644**
*   chmod 所有**robots.txt**文件到**644**
*   chmod所有**目录**到**711**
*   chmod**目录列表**（.htaccess 选项+索引）的所有**目录**到**755**
*****   chmod用户可以**上传文件的所有****目录**，到**755**（例如：/uploads/）。****

 ******说明：

*   **644**表示：
    *   6：文件/目录的**所有者****可以读写****，**但不能执行。由于文件不可执行，因此您不需要在这里拥有“x”权限（6 表示 r+w。7 表示 r+w+x）。
    ***   44：文件/目录所属的组（使用查看组**）**`ls -l`和**其他所有人**（公众）可以**读取**文件，但不能执行或写入（权限编号4）。**
***   **711**意味着：
    *   7：文件/目录的**所有者可以****读**、**写**和**执行**。这是目录所必需的！当您尝试列出目录时，如果没有“执行”，您将获得权限被拒绝。
    *   11：文件/目录所属的**组和****公众**只有**执行**权。这适用于您不希望其他人浏览内容但希望让他们访问目录下方的选定文件的目录。*   **755**表示：
    *   7：文件/目录的**所有者可以****读**、**写**和**执行**。
    *   55：文件/目录所属的**组和****公众**有**读**和**执行**权限，但没有写权限。这使用户能够查看目录中的文件，并能够读取这些文件，但不能更改它们。**

 **还有一个交互式在线计算器，您可以使用它来确定使用哪些权限：[https ://chmod-calculator.com/](https://chmod-calculator.com/)

* * *

## 回答 #2

> 赞同：32
> 
> 时间：2009-03-29T22:23:01.157

它们应该尽可能地限制，但仅此而已。

通常`0644`是一个不错的选择，它赋予所有者读写权限，但其他人只能读取。`0755`对于目录。但是，它可能取决于您的特定系统设置。

* * *

## 回答 #3

> 赞同：19
> 
> 时间：2009-03-29T22:31:03.230

如果您想重置所有内容，请执行此命令并理清后果。通常 644 是文件的好权限，而 711 是目录的好权限。如果您允许目录列表，则使用 755。

```
$ find /var/www/html \( -type f -execdir chmod 644 {} \; \) \
                  -o \( -type d -execdir chmod 711 {} \; \) 
```

如果您想要一些侵入性较小的东西，那么只需删除组和“其他”的写入位。

```
$ chmod -R go-w /var/www/html 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-03-29T22:24:16.380

我认为`644`是文件和`755`目录的标准。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-29T22:27:30.197

如果您的网络服务器仅提供网页服务，不允许通过（例如）匿名 FTP 访问，则错误的文件权限不允许用户删除文件。

如果其他人可以通过其他方式（例如 SSH）访问您的服务器，请确保没有为您以外的用户设置写入位。执行：

```
find . -exec chmod go-w {} \; 
```

此命令将限制执行它的所有文件和目录的权限。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-29T22:39:17.017

无论您使用哪种方法，如果您的 Web 应用程序有可能依赖具有某些权限的文件或目录，请务必进行彻底的测试。虽然允许过于宽松的权限可能是不好的设计，但有时确实会发生这种情况，因此您可能会破坏应用程序。

# python - 将 cProfile 的结果限制为包含“something”_和/或_“something_else”的行

> ID：695501
> 
> 赞同：3
> 
> 时间：2009-03-29T22:22:58.647
> 
> 标签：python

我正在使用 cProfile 来分析我的整个应用程序的主要功能。除了正在分析的一些 3rd 方库之外，它运行良好，并且也显示在输出中。在读取输出时，这并不总是可取的。

我的问题是，我该如何限制这个？[关于 python 分析器](http://docs.python.org/library/profile.html)的文档提到：

```
p.sort_stats('time', 'cum').print_stats(.5, 'init') 
```

> 该行以时间为主键，以累积时间为辅键对统计信息进行排序，然后打印出一些统计信息。具体来说，列表首先被剔除到其原始大小的 50% (re: .5)，**然后只保留包含 init 的行，并打印该子子列表**。

它提到只显示包含“init”的行。这很好用，但我想以这样的方式限制它，以便我可以说限制包含“init”和/或“get”的行。通过反复试验，我发现您可以添加另一个参数，一个字符串，它将被进一步过滤以仅显示包含 string1**和**string2 的行。使用我之前的示例，这看起来像：

```
p.sort_stats('time', 'cum').print_stats(.5, 'init', 'get') 
```

任何人都知道如何限制行，以便只显示包含“init”**和/或**“get”的行？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-30T00:48:44.037

根据您链接的文档，字符串是正则表达式：

> 每个限制要么是一个整数 ...，要么是一个正则表达式（以模式匹配打印的标准名称；从 Python 1.5b1 开始，这使用由 re 模块定义的 Perl 样式的正则表达式语法）

因此：

```
p.sort_stats('time', 'cum').print_stats(.5, 'init|get') 
```

应该管用。

# python - 使用 Python 和正则表达式解析模板模式

> ID：695505
> 
> 赞同：0
> 
> 时间：2009-03-29T22:24:44.570
> 
> 标签：python, regex, parsing, grouping

我正在编写一个从旧模板引擎模式中提取数据的脚本：

```
[%price%]
{
$54.99
}
[%/price%]

[%model%]
{
WRT54G
}
[%/model%]

[%brand%]{
LINKSYS
}
[%/brand%] 
```

[% %] 中的所有内容都是键，{ } 中的所有内容都是值。使用 Python 和正则表达式，我能够做到这一点： (?<=[%)(?P\w*?)(?=\%])

返回 ['price', 'model', 'brand']

我只是在将括号数据作为值匹配时遇到问题

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-29T22:34:29.697

我同意 Devin 的观点，即单个正则表达式不是最佳解决方案。如果确实有任何奇怪的情况没有被您的正则表达式处理，那么您将无法发现真正的风险。

我建议使用有限状态机方法。逐行解析文件，首先查找 price-model-brand 块，然后解析大括号内的任何内容。此外，请务必注意是否有任何块未正确打开或关闭，因为这些可能格式错误。

你应该能够在 python 中用大约 30-40 行代码编写这样的东西。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-29T22:27:23.050

看起来使用`re.Scanner`（遗憾的是未记录）比使用单个正则表达式更容易。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-29T22:52:13.600

只是为了笑：

```
import re
RE_kv = re.compile("\[%(.*)%\].*?\n?\s*{\s*(.*)")
matches = re.findall(RE_kv, test, re.M)
for k, v in matches:
    print k, v 
```

输出：

```
price $54.99
model WRT54G
brand LINKSYS 
```

请注意，我做了足够的正则表达式来显示匹配项，它甚至没有在结束时限制右括号。使用风险自负。

# c# - LINQ - 左连接、分组依据和计数

> ID：695506
> 
> 赞同：172
> 
> 时间：2009-03-29T22:25:59.950
> 
> 标签：c#, .net, linq, linq-to-sql

假设我有这个 SQL：

```
SELECT p.ParentId, COUNT(c.ChildId)
FROM ParentTable p
  LEFT OUTER JOIN ChildTable c ON p.ParentId = c.ChildParentId
GROUP BY p.ParentId 
```

如何将其转换为 LINQ to SQL？我卡在了 COUNT(c.ChildId)，生成的 SQL 似乎总是输出 COUNT(*)。这是我到目前为止得到的：

```
from p in context.ParentTable
join c in context.ChildTable on p.ParentId equals c.ChildParentId into j1
from j2 in j1.DefaultIfEmpty()
group j2 by p.ParentId into grouped
select new { ParentId = grouped.Key, Count = grouped.Count() } 
```

谢谢！

* * *

## 回答 #1

> 赞同：195
> 
> 时间：2009-03-29T22:28:29.507

```
from p in context.ParentTable
join c in context.ChildTable on p.ParentId equals c.ChildParentId into j1
from j2 in j1.DefaultIfEmpty()
group j2 by p.ParentId into grouped
select new { ParentId = grouped.Key, Count = grouped.Count(t=>t.ChildId != null) } 
```

* * *

## 回答 #2

> 赞同：59
> 
> 时间：2010-07-09T00:28:49.600

考虑使用子查询：

```
from p in context.ParentTable 
let cCount =
(
  from c in context.ChildTable
  where p.ParentId == c.ChildParentId
  select c
).Count()
select new { ParentId = p.Key, Count = cCount } ; 
```

* * *

如果查询类型通过关联连接，则简化为：

```
from p in context.ParentTable 
let cCount = p.Children.Count()
select new { ParentId = p.Key, Count = cCount } ; 
```

* * *

## 回答 #3

> 赞同：39
> 
> 时间：2013-07-31T00:40:23.510

**迟到的答案：**

如果您所做的只是 Count()，则**根本不需要左连接。**请注意，`join...into`实际上转换为`GroupJoin`返回分组，`new{parent,IEnumerable<child>}`因此您只需要调用`Count()`该组：

```
from p in context.ParentTable
join c in context.ChildTable on p.ParentId equals c.ChildParentId into g
select new { ParentId = p.Id, Count = g.Count() } 
```

在扩展方法语法`join into`中 a 等价于`GroupJoin`（而 a`join`没有`into`is `Join`）：

```
context.ParentTable
    .GroupJoin(
                   inner: context.ChildTable
        outerKeySelector: parent => parent.ParentId,
        innerKeySelector: child => child.ParentId,
          resultSelector: (parent, children) => new { parent.Id, Count = children.Count() }
    ); 
```

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2015-10-01T04:44:38.527

虽然 LINQ 语法背后的想法是模拟 SQL 语法，但您不应总是考虑将 SQL 代码直接转换为 LINQ。在这种特殊情况下，我们不需要进行**group into**，因为**join into**本身就是一个 group join。

这是我的解决方案：

```
from p in context.ParentTable
join c in context.ChildTable on p.ParentId equals c.ChildParentId into joined
select new { ParentId = p.ParentId, Count = joined.Count() } 
```

与这里投票最多的解决方案不同，我们不需要在**Count(t => t.ChildId != null)中检查****j1**、**j2**和 null

 *** * *

## 回答 #5

> 赞同：7
> 
> 时间：2009-08-14T08:42:11.230

```
 (from p in context.ParentTable     
  join c in context.ChildTable 
    on p.ParentId equals c.ChildParentId into j1 
  from j2 in j1.DefaultIfEmpty() 
     select new { 
          ParentId = p.ParentId,
         ChildId = j2==null? 0 : 1 
      })
   .GroupBy(o=>o.ParentId) 
   .Select(o=>new { ParentId = o.key, Count = o.Sum(p=>p.ChildId) }) 
```

# iphone - UIBarbutton 上的 UIButton 图标

> ID：695514
> 
> 赞同：0
> 
> 时间：2009-03-29T22:29:19.303
> 
> 标签：iphone

是否有任何简单的方法可以在 UIBarButton 项目上使用 UIButton 图标（UIButtonTypeInfoLight），而不是将其创建为图像（在 Photoshop 方面我很笨拙）？

这些图像是否可以在某处解决？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-10-01T08:21:20.050

使用 - (id)initWithCustomView:(UIView *)customView 并传递给它一个 UIButton。UIButton 是一个 UIView

# c++ - Qt XML 输入

> ID：695515
> 
> 赞同：2
> 
> 时间：2009-03-29T22:29:28.147
> 
> 标签：c++, xml, qt

我正在尝试使用 Qt 工具包从 C++ 程序中的 XML 文件输入数据。我的 XML 数据格式如下：

```
`<item>
    <title>title<\title>
    <tree_loc1>0<\tree_loc1>
    <parent>parent<\parent>
    <description>description<\description>
    <other_info>other info<\other_info>
    <location>location<\location>
    <last_modified>Mar 28 2009 8:16 pm<\last_modified>
    <radio>0<\radio>
 </item>` 
```

目前我必须在 XML 中读取的函数如下。不幸的是，它从第一个标签（标题）中识别出数据，然后将所有未来访问数据的尝试返回为 NULL。我传入的 subRoot 是 domDocument.documentElement()。我对 XML 很陌生，对 Qt 也有些陌生，如果您能提供任何帮助来解决我的问题，我将不胜感激！非常感谢你。

```
void XmlHandler::readXML(QStandardItemModel *model, QDomNode subRoot){
  QDomElement node;
  QString title;
  int row;
  QString parent;
  QString description;
  QString other_info;
  QString location;
  QString last_modified;
  QString radio;
  QString value;
  bool flag;

  if (subRoot.isNull())
    return; // error condition

  for (int i = 0; i < N_STRINGS; i++){
    node = subRoot.firstChildElement(tagName[i]); // returns NULL all but the 1st time
    value = DEFAULT_VALUE;

    value = node.text();
    switch (i) {
      case 0:
      title = value;
          break;
      case 1:
      row = value.toInt();
      break;
      case 2:
      parent = value;
      break;
      case 3:
      description = value;
          break;
      case 4:
      other_info = value;
      break;
      case 5:
      location = value;
      break;
      case 6:
      last_modified = value;
      break;
      case 7:
          radio = value;
      break;
      }
  }
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-29T22:37:06.193

您的 XML 数据不是有效的 XML - 反斜杠应该是正斜杠。例如：

```
<title>title<\title> 
```

应该：

```
<title>title</title> 
```

# html - HTML 实体在 Camino 中显示错误

> ID：695524
> 
> 赞同：0
> 
> 时间：2009-03-29T22:37:13.667
> 
> 标签：html, entity, camino

我试图在我的 HTML 页面中显示字符 ☜ 和 ☞。我测试过的每一个浏览器都能正确显示它们，除了（莫名其妙地）卡米诺。相反，它显示了这一点：

[☜ http://b2.s3.p.quickshareit.com/files/picture1a9745.png](http://b2.s3.p.quickshareit.com/files/picture1a9745.png)

这就是它为☜呈现的内容。它为☞ 显示的符号是相似的。

如果由于某种原因您无法正确看到这些字符，这是我正在使用的 HTML 实体：

```
&#9756; and &#9758; 
```

现在，Camino 是一个使用 Gecko 的仅限 Mac 的浏览器。但是，我测试过的所有 Firefox 版本都可以正常工作，我的主要浏览器是 Mac 上的 Safari。

谢谢您的帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-29T22:47:10.930

我认为这是 Firefox 2 中的一个错误，它使用了 Camino 使用的渲染引擎。

[https://bugzilla.mozilla.org/attachment.cgi?id=229547&action=edit](https://bugzilla.mozilla.org/attachment.cgi?id=229547&action=edit)

# ruby-on-rails - my_object.save(false) 并没有真正跳过我的 Active Record 验证

> ID：695528
> 
> 赞同：5
> 
> 时间：2009-03-29T22:39:26.360
> 
> 标签：ruby-on-rails, ruby, activerecord

所以我一直在努力解决我一直遇到的这个错误，我终于找到了导致它的原因。我一直觉得当我打​​电话时

```
@my_model.save(false) 
```

我会***跳过***我的 ActiveRecord 验证。事实证明这是部分正确的。**尽管**我的 ActiveRecord 验证，我的对象正在保存到数据库中。我的问题存在是因为我的一个验证在验证过程中修改了其中一个子模型（这是一个 24 小时位置的调度应用程序，因此当午餐被保存时，我会根据他们保存的日期和第二天检查它们还要确保用户不是指“凌晨 2 点”进行夜班。

我的问题是：有没有办法真正跳过我的验证并直接进入数据库？这是正常的 ActiveRecord 行为还是我应该更深入地进行验证？还是我运气不好，需要重新编写验证？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-03-29T23:49:54.210

> 我的问题存在是因为我的一个验证在验证过程中修改了一个子模型

修复它，然后你的问题就会消失。验证永远不应该修改对象！

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-03-29T23:46:33.487

您可能希望在将记录保存到数据库之前使用 before_create 或其他回调与记录进行交互，而不是尝试在验证器中执行此操作。

这是有关 ActiveRecord 回调的文档：http: [//api.rubyonrails.org/classes/ActiveRecord/Callbacks.html](http://api.rubyonrails.org/classes/ActiveRecord/Callbacks.html)

还有一个使用回调的指南，其中包含有关如何在此处跳过它们的一些详细信息：http: [//guides.rubyonrails.org/activerecord_validations_callbacks.html](http://guides.rubyonrails.org/activerecord_validations_callbacks.html)

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-03-30T10:49:10.163

我同意，您应该使用回调与记录进行交互。验证不应该修改对象..

如果你仍然觉得需要这样做..使用

```
myobject.save_without_validation

```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-03-30T09:32:43.793

我同意 Orion，永远不要使用验证来修改对象，而是使用像 after_save 这样的回调。

# c - 为什么每次运行应用程序时都必须使用导出定义 LD_LIBRARY_PATH？

> ID：695530
> 
> 赞同：47
> 
> 时间：2009-03-29T22:40:15.703
> 
> 标签：c, linux, gcc, shared-libraries, ld

我有一些使用一些共享库的代码（gcc 上的 c 代码）。编译时，我必须使用 -I 和 -L 显式定义包含和库目录，因为它们不在标准位置。当我尝试运行代码时，出现以下错误：

```
./sync_test 
./sync_test: error while loading shared libraries: libsync.so: cannot open shared object file: No such file or directory 
```

但是，执行以下操作，一切正常：

```
export LD_LIBRARY_PATH="/path/to/library/"
./sync_test 
```

现在，奇怪的是，这只能工作一次。如果我再次尝试运行sync_test，我会得到同样的错误，除非我先运行导出命令。我尝试将以下内容添加到我的 .bashrc 中，但没有任何区别：

```
LD_LIBRARY_PATH="/path/to/library/" 
```

* * *

## 回答 #1

> 赞同：47
> 
> 时间：2009-03-30T00:20:00.300

你应该避免`LD_LIBRARY_PATH`在你的`.bashrc`. 有关详细信息，请参阅[“ `Why LD_LIBRARY_PATH is bad`”](http://xahlee.info/UnixResource_dir/_/ldpath.html)。

在链接时使用链接器选项[-rpath](http://sourceware.org/binutils/docs-2.22/ld/Options.html#Options)以便动态链接器知道`libsync.so`在运行时在哪里找到。

```
gcc ... -Wl,-rpath /path/to/library -L/path/to/library -lsync -o sync_test 
```

## 编辑：

另一种方法是使用这样的包装器

```
#!/bin/bash

LD_LIBRARY_PATH=/path/to/library sync_test "$@" 
```

如果`sync_test`启动任何其他程序，它们最终可能会使用`/path/to/library`可能或可能不打算使用的库。

* * *

## 回答 #2

> 赞同：44
> 
> 时间：2009-03-29T22:46:01.353

采用

```
export LD_LIBRARY_PATH="/path/to/library/" 
```

在您的 .bashrc 中，否则它只能用于 bash 而不是您启动的任何程序。

链接时尝试`-R/path/to/library/`标记，它会使程序在该目录中查找，您不需要设置任何环境变量。

编辑：看起来`-R`只有 Solaris，你在 Linux 上。

另一种方法是添加路径`/etc/ld.so.conf`并运行`ldconfig`. 请注意，这是一个适用于所有动态链接二进制文件的全局更改。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2009-03-29T23:12:29.307

您可以将所有内容放在一行中：

```
LD_LIBRARY_PATH="$LD_LIBRARY_PATH:/path/to/library" ./sync_test 
```

应该让事情变得更容易一些，即使它不会改变任何基本的东西

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2009-03-29T22:44:32.260

您是否在 .bashrc 中“导出”？

```
export LD_LIBRARY_PATH=$LD_LIBRARY_PATH:"/path/to/library" 
```

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2012-08-07T15:58:03.017

与其在运行时使用 LD_LIBRARY_PATH 覆盖库搜索路径，不如使用`rpath`. 如果您与 GCC 链接添加`-Wl,-rpath,<libdir>`应该可以解决问题，如果您与 ld 链接它只是`-rpath <libdir>`.

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-03-30T07:03:41.203

如果它是您在系统上安装的东西，您还可以做的是将包含共享库的目录添加到您的**/etc/ld.so.conf**文件中，或者在**/etc/ld.so 中创建一个新文件。 conf.d/**

（我已经检查了 RHEL5 和 Ubuntu 发行版，所以我认为它对于 linux 来说是通用的）

ldconfig 程序将确保它们被包含在系统范围内。

有关更多信息，请参见以下链接： [www.dwheeler.com/secure-programs/Secure-Programs-HOWTO/dlls.html](http://www.dwheeler.com/secure-programs/Secure-Programs-HOWTO/dlls.html)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2016-10-24T21:36:49.717

您可以在代码中添加具有新定义的呼叫系统：

```
sprintf(newdef,"export LD_LIBRARY_PATH=$LD_LIBRARY_PATH:%s:%s",ld1,ld2);
system(newdef); 
```

但是，我不知道这是正确的解决方案，但它有效。

问候

# c# - 在 C# 中将数据传递到回调方法（通过 BeginInvoke）

> ID：695537
> 
> 赞同：5
> 
> 时间：2009-03-29T22:44:36.677
> 
> 标签：c#, .net, multithreading

我有以下代码：

```
 delegate int doStuffDel(int instanceNo, int sleepTime, int repeatCount);
    string result;

    private int doStuff(int instanceNo, int sleepTime, int repeatCount)
    {
        for (int i = 0; i < repeatCount; i++)
        {
            Console.Write(instanceNo);
            Thread.Sleep(sleepTime);
        }
        result = instanceNo + " repeated " + repeatCount;
        return instanceNo;
    }

    private void button3_Click(object sender, EventArgs e)
    {
        doStuffDel del = doStuff;
        IAsyncResult ar = del.BeginInvoke(3, 120, 50, finishedCallback, result);
    }

    private void finishedCallback(IAsyncResult ar)
    {
        Console.WriteLine("Done. The result was " + ar.AsyncState.ToString());
    } 
```

我认为 res.AsyncState 会返回字符串，作为调用 BeginInvoke 的最后一个参数传递，但它是空的。有人知道为什么吗？

PS，我知道我可以将 del 作为 BeginInvoke 中的最后一个参数传递，然后在回调中调用 EndInvoke，以从 doStuff 方法获得一些结果，或者我可以从类中获取字符串 val！- 但我很惊讶 AsyncResult 对象上的 AsyncState 为空......

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-29T22:49:34.667

的值`ar.AsyncState`是您最初将结果传递给 时的值`BeginInvoke`。事实上，当你传递它时，你使用的值`result`并不意味着它“绑定”到结果变量。它只是`result`您将变量传递给开头时的值。

要看到这一点，要么`result`在调用之前设置一些测试值`BeginInvoke`，要么只传递一个字符串文字。无论哪种方式，您都会在回调中获得该值。

另一方面，您的回调和原始委托都具有相同的目标对象，因此您可以`result`在回调中使用 use 并且它将具有您想要的值 - 这是维护状态的另一种方式。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-29T22:49:39.957

它在您调用 BeginInvoke 时传入。那时，*结果*为空。如果你在调用之前设置了*结果*，你会在回调中看到它。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-29T22:52:14.957

问题是您传递的值*-*`result` which （之前`doStuff`）是`null`。`result`对 inside的更新`doStuff`不会影响异步状态。

# c - 声明没有初始大小的数组

> ID：695548
> 
> 赞同：4
> 
> 时间：2009-03-29T22:49:49.317
> 
> 标签：c

我正在尝试使用 Visual Studio 2008 在 Windows Vista x64 上编译 OpenSSL (pyOpenSSL) 的 Python 绑定。当我运行时`python setup.py build_ext -I C:\OpenSSL\include`，它会因以下错误而死：

```
building 'OpenSSL.crypto' extension
C:\Program Files (x86)\Microsoft Visual Studio 9.0\VC\BIN\amd64\cl.exe /c /nologo /Ox /MD /W3 /GS- /DNDEBUG -I\OpenSSL\include -IC:\Python26\include -IC:\Python26\PC /Tcsrc/crypto/x509name.c /Fobuild\temp.win-amd64-2.6\Release\src/crypto/x509name.obj
x509name.c
src/crypto/x509name.c(16) : error C2133: 'crypto_X509Name_methods' : unknown size
error: command '"C:\Program Files (x86)\Microsoft Visual Studio 9.0\VC\BIN\amd64\cl.exe"' failed with exit status 2 
```

当我查看有问题的源时，我在第 16 行看到以下内容：

```
static PyMethodDef crypto_X509Name_methods[]; 
```

我的C很生锈，所以我不记得你是否可以这样做。由于这是一个 Python 库，我猜它是为了在 gcc 中编译而编写的，但我没有在这台计算机上安装 Cygwin 环境。是否有一些开关可用于让此代码与 VS2008 一起编译？

## 回答：

稍后在代码中，有这样的：

```
/*
 * ADD_METHOD(name) expands to a correct PyMethodDef declaration
 *   {  'name', (PyCFunction)crypto_X509_name, METH_VARARGS }
 * for convenience
 */
#define ADD_METHOD(name)        \
    { #name, (PyCFunction)crypto_X509Name_##name, METH_VARARGS,  crypto_X509Name_##name##_doc }
static PyMethodDef crypto_X509Name_methods[] =
{
    ADD_METHOD(hash),
    ADD_METHOD(der),
    ADD_METHOD(get_components),
    { NULL, NULL }
};
#undef ADD_METHOD 
```

根据 Neil Butterworth 的建议，我错误地更改了以下内容：

```
static PyMethodDef crypto_X509Name_methods[]; 
```

到：

```
static PyMethodDef crypto_X509Name_methods[4]; 
```

和编译的代码。

谢谢大家。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-29T22:52:16.080

由于它是静态的，因此必须在某个编译单元（C 源文件）中以恒定大小对其进行初始化。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-29T23:04:39.780

你可能有这样的情况：

```
#include <stdio.h>

static int a[];     // declaration

// lots of code

int a[3];           // use 
```

它用 gcc 编译为 C。我不确定它应该（它不是有效的 C++），但我不足以作为 C 语言律师来肯定地告诉你。

# wpf - WPF：窗口加载时刷新/更新控件

> ID：695549
> 
> 赞同：3
> 
> 时间：2009-03-29T22:50:53.417
> 
> 标签：wpf, controls

我想在标签中显示时间。标签内容需要在加载窗口时自动刷新。

我有一个简单的 WPF 窗口，里面有一个标签控件。如此处所示

```
<Window x:Class="shoes.Window1"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    Title="Window1" Height="300" Width="300" Loaded="Window_Loaded">
    <Grid>
        <Label Margin="12" Name="lblSeconds"></Label>
        <Button Margin="68,22,135,0" Name="button1" Height="24" VerticalAlignment="Top" Click="button1_Click">Button</Button>
    </Grid>
</Window> 
```

我查看了此处可用的代码：http: [//geekswithblogs.net/NewThingsILearned/archive/2008/08/25/refresh--update-wpf-controls.aspx](http://geekswithblogs.net/NewThingsILearned/archive/2008/08/25/refresh--update-wpf-controls.aspx)

我修改以适应这种方式：

```
public partial class Window1 : Window
{
    private static Action EmptyDelegate = delegate() { };

    public Window1()
    {
        InitializeComponent();

    }

    private void Window_Loaded(object sender, RoutedEventArgs e)
    {
        if (IsLoaded)
        {
            LoopingMethod();
        }
    }

    private void LoopingMethod()
    {
        while(true)
        {
            lblSeconds.Content = DateTime.Now.ToLongTimeString();
            lblSeconds.Refresh();
            Thread.Sleep(10);
        }
    }
}
public static class ExtensionMethods
{

    private static Action EmptyDelegate = delegate() { };

    public static void Refresh(this UIElement uiElement)
    {
        uiElement.Dispatcher.Invoke(DispatcherPriority.Render, EmptyDelegate);
    }
} 
```

我发现代码在通过 button_Click 事件触发时运行良好。我试图让代码通过这样的 Window_Loaded 事件运行，但徒劳无功。窗口内容从不显示。

我可以做些什么来在加载窗口时自动更新标签？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-29T22:57:52.043

这是完全正常的，因为 OnLoad 处理程序处于无限循环中。该循环在 UI 线程上，因此 Window 永远不会显示。

首先：将循环包装在 a 中`Backgroundworker`，以便它在单独的线程上运行。

我还将循环代码分解到一个单独的对象实现`INotifyPropertyChanged`中，该对象实现了一个带有时间（字符串）的属性，让该属性`PropertyChanged`在它发生变化时引发事件（通过循环）。当然，您仍然需要在单独的线程上执行此操作（例如使用`BackgroundWorker`）。使用 Binding 将您的专用对象绑定到标签。

另一种策略是使用`Timer`定期回调，您可以在那里更新标签。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-29T23:10:44.587

我将编写一个实现 INotifyPropertyChanged 接口的类，该接口具有 CurrentTime 属性并包含一个 DispatcherTimer 实例，该实例将定期引发 PropertyChanged("CurrentTime") 事件。

然后只需将此对象放入表单的资源中，并将标签的内容绑定到 CurrentTime 属性。

DispatcherTimer 使用消息泵，因此不涉及不必要的线程。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-30T07:17:00.143

不要使用无限循环，而是使用 DispatcherTimer

# winapi - 使用 Windows API 让多个显示器进入睡眠状态？

> ID：695550
> 
> 赞同：1
> 
> 时间：2009-03-29T22:51:23.290
> 
> 标签：winapi, sleep, power-management, multiple-monitors

我究竟如何让我的两个显示器进入睡眠状态，我想自己编写一个应用程序，因为我想添加某些功能，到目前为止，我在 MSDN 上找不到任何与让你的显示器进入睡眠状态有关的内容。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-29T23:19:42.737

你想要这样的东西：

```
SendMessage(HWND_BROADCAST, WM_SYSCOMMAND, SC_MONITORPOWER, (LPARAM) 2); 
```

它应该在双显示器上工作。

尽管[最好不要使用 HWND_BROADCAST，而是使用应用程序自己的窗口中的 HWND](http://blogs.msdn.com/oldnewthing/archive/2006/06/13/629451.aspx)。你没有说你使用的是什么语言，但如果它是 C# 或 VB.NET，有很多示例演示如何从这些语言中调用它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-29T23:22:04.650

查看[WM_SYSCOMMAND](http://msdn.microsoft.com/en-us/library/ms646360(VS.85).aspx)消息的`SC_MONITORPOWER`选项。

C#有一个 CodeProject[示例](http://www.codeproject.com/KB/cs/Monitor_management_guide.aspx)。

# java - 使用消息框 java 声明时停止

> ID：695557
> 
> 赞同：-1
> 
> 时间：2009-03-29T22:54:53.297
> 
> 标签：java, messagebox, while-loop

我需要找到一种方法来在 java 中关闭消息框时停止 while 语句。我正在修改一个聊天程序，服务器没有 gui 并使用 while(true) 语句进行侦听。我正在尝试找到一种方法来关闭服务器，而无需进入任务管理器并杀死 java.exe。我对java没有什么经验，所以一些源代码会很好。谢谢您的帮助！

编辑：我决定使用不同的聊天程序。谢谢您的帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-29T22:58:54.940

您可以使用“break;” 退出 Java 中的任何循环：

```
while (isRunning)
{
    // Code

    if (somethingHappened)
    {
        break; // break out of loop
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-29T22:59:16.720

也许我误解了，但消息框的状态不应该是 while 条件的一部分吗？如果您不能直接在循环中访问消息框，则可以将其分解为一个方法，该方法根据消息框的状态返回一个布尔值。

# iphone - 在基于 PPC 的计算机上开发 iPhone

> ID：695558
> 
> 赞同：1
> 
> 时间：2009-03-29T22:55:29.910
> 
> 标签：iphone, macos, intel

在其他地方已经说过，为 iPhone 开发[需要基于 Intel 的计算机](https://stackoverflow.com/questions/190662/whats-the-cheapest-mac-development-box-possible)，但根据我读过的几份介绍性 Apple 文档，情况似乎并非如此。参见[这个](http://developer.apple.com/iphone/gettingstarted/docs/iphonedevtools.action)例子，它只是说，“要为 iPhone OS 开发应用程序，你需要一台运行 Xcode 工具的 Mac OS X 计算机。” 任何人都可以提供参考吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-30T02:26:54.317

我已经成功地为每个版本的 iPhone SDK 编译、模拟和设备调试 iPhone 应用程序，但不包括 iPhone SDK 3.0。

您只需要编辑两件事：[更改 Xcode 的安装程序脚本](http://secret.hnc.cc/archives/116-How-to-get-the-iPhone-SDK-installing-on-PPC.html)，以便安装程序将其安装在 PowerPC 上并[更改默认模拟器配置](http://blog.flextip.net/en/2008/12/iphone-no-architectures-to-compile-for-ppc/)，使其认为 PPC 是有效的模拟器目标架构。

它有时会从 PPC 安装到设备上，但它会起作用。

对于 iPhone SDK 3.0，Apple 没有使用 PPC 代码构建 Interface Builder 组件。这意味着使用 SDK 3.0 Interface Builder 是不可能的（没有破解或解决方法）。在 PPC 上构建和运行 iPhone 应用程序的乐趣很快就会结束——很可能是 Snow Leopard，Xcode 本身可能会丢失 PPC 代码（不是说 PPC 用户无论如何都会运行 Snow Leopard，但 Snowless Leopard 的 Xcode 更新将会结束）。

摘要：是的，它适用于 PPC。是的，从 PPC 调试设备很容易出错。不，它不会持续很长时间——PPC 代码会慢慢被删除。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-30T00:36:13.320

Cnet[有](http://reviews.cnet.com/8301-19512_7-10115416-233.html)关于在 PPC 上设置它的说明。请记住，Apple 不太可能对此提供太多帮助 - 它完全不受支持，因为它甚至首先需要破解才能工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-29T22:59:29.823

嗯，我相信苹果说它是仅限英特尔的，但肯定有一些人至少有一部分在 PPC 上工作：http: [//arstechnica.com/apple/news/2008/03/iphone-sdk-not- just-intel-only-anymore.ars](http://arstechnica.com/apple/news/2008/03/iphone-sdk-not-just-intel-only-anymore.ars)

谷歌上还有其他点击可以告诉你如何设置它。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-17T06:39:12.180

我想对 Alex Blewitt 的 PPC iPhone SDK 安装程序脚本表示非常感谢和推荐。他[打包](http://alblue.blogspot.com/2008/12/enabling-iphone-development-on-ppc-macs.html)了一个工具，只需简单的说明即可为您完成所有工作。我刚刚让它在我旅行的 Powerbook 12" 上运行。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2009-03-30T07:38:26.457

[http://blog.flextip.net/2008/12/iphone-no-architectures-to-compile-for-ppc/](http://blog.flextip.net/2008/12/iphone-no-architectures-to-compile-for-ppc/)

这个链接对我有好处。我在 PPC 上成功安装了 SDK

# sql - 从 MySql 移植到 T-Sql。任何 INET_ATON() 等价物？

> ID：695568
> 
> 赞同：5
> 
> 时间：2009-03-29T23:01:41.363
> 
> 标签：sql, mysql, tsql

需要将一些代码从 MySql 移动到 TSql。我对 INET_ATON 进行了几次调用，它将类似于 IPAddress 的字符串转换为数字。是否有 T-SQL 等价物？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-03-29T23:48:35.663

滥用 parsname 函数：

```
create function INET_ATON (@addr varchar(15))
returns bigint
with schemabinding
as
begin
  return  
    cast(parsename(@addr, 4) as bigint) * 16777216 +
    cast(parsename(@addr, 3) as bigint) * 65536 +
    cast(parsename(@addr, 2) as bigint) * 256 +
    cast(parsename(@addr, 1) as bigint)
end 
```

不过，这里不支持“简短地址”的东西。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-30T07:31:10.763

这是一个将 IP 地址转换为字符串的函数：

```
CREATE FUNCTION dbo.IpToString 
    (@ip_str VarChar(15))
returns BigInt
as
    begin
    declare @i int
    declare @dot_pos int
    declare @current_part VarChar(15)
    declare @result BigInt

    set @result = 0
    set @i = 0

    while Len(@ip_str) > 0
        begin
        set @i = @i + 1
        set @dot_pos = CharIndex('.', @ip_str)
        if @dot_pos > 0
            begin
            set @current_part = Left(@ip_str, @dot_pos - 1)
            set @ip_str = SubString(@ip_str, @dot_pos + 1, 15)
            end
        else 
            begin
            set @current_part = @ip_str
            set @ip_str = ''
            end

        if Len(@current_part) > 3 Return(Null)
        if IsNumeric(@current_part) = 0 Return (Null)
        if not cast(@current_part as int) between 0 and 255 Return (Null)
        set @result = 256 * @result + Cast(@current_part as BigInt)
        end

    if @i = 4 Return(@result)

    Return(Null)
    end 
```

创建函数后，您可以像这样调用它：

```
select dbo.IpToString('1.2.3.4') 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-07-28T03:03:49.963

好一点。它使用 int (4b) 而不是 bigint (8b)。您的结果应该只有四个字节......每个八位字节一个：

```
create function INET_ATON (@ip varchar(15))
returns int
begin
    declare @rslt int 
    -- This first part is a little error checking
    -- Looks for three dots and all numbers when not dots 
    if len(@ip) - len(replace(@ip,'.','')) = 3 
        AND
            isnumeric(replace(@ip,'.','')) = 1
    begin 
    set @rslt = convert(int,
            convert(binary(1),convert(tinyint,parsename(@ip, 4)))
        +   convert(binary(1),convert(tinyint,parsename(@ip, 3)))
        +   convert(binary(1),convert(tinyint,parsename(@ip, 2)))
        +   convert(binary(1),convert(tinyint,parsename(@ip, 1)))
        )
    end
    else set @rslt = 0
    return @rslt
end; 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-05-07T13:18:03.140

与直接回答您的问题相比，这是一个不同的选择（我看到了反对票 ^^），但您也可以考虑将转换逻辑放入您的软件而不是查询中。根据语言和用例，这可能会更好。

## 例子

**PHP**：`ip2long("192.168.1.1");`

**C/C++**：`inet_addr("192.168.1.1");`

**C＃**

```
System.Net.IPAddress ip;
long ipn = (System.Net.IPAddress.TryParse("192.168.1.1", out ip))

    ? (((long) ip.GetAddressBytes()[0] << 24) | (ip.GetAddressBytes()[1] << 16) |
              (ip.GetAddressBytes()[2] <<  8) |  ip.GetAddressBytes()[3])

    : 0; 
```

你也可以给它`-1`，或者`null`（`long?`作为数据类型），或者编写一个抛出异常的方法，以防转换失败。

**Python**

```
reduce(lambda sum, chunk: sum <<8 | chunk, map(int, '192.168.1.1'.split("."))) 
```

在你开始投票之前：这只是一个简短的例子，我知道这里没有错误处理。

## 结论

当然，大多数时候让 dbs 完成这项工作会更好，但这真的取决于，如果您没有每秒处理数百万个请求的项目，这可能会有所帮助。

# php - UDP 写入套接字并同时从套接字读取

> ID：695569
> 
> 赞同：0
> 
> 时间：2009-03-29T23:01:46.183
> 
> 标签：php, sockets, udp

服务器：

```
<?php
error_reporting(E_ALL | E_STRICT);

$socket = socket_create(AF_INET, SOCK_DGRAM, SOL_UDP);

socket_bind($socket, '127.0.0.1', 11104);

$from = "";
$port = 0;
socket_recvfrom($socket, $buf, 12, 0, $from, $port);
//$buf=socket_read($socket, 2048);

echo "Received $buf from remote address $from and remote port $port" . PHP_EOL;
$msg="Sikerult";

//socket_write($socket, $msg, strlen($msg));
socket_sendto($socket, $msg, strlen($msg), 0, '127.0.0.1', 11104);
//socket_close($socket);
?> 
```

客户：

```
 $sock = socket_create(AF_INET, SOCK_DGRAM, SOL_UDP);
$result = socket_connect($sock, '127.0.0.1', 11104);
    $msg = "Sikerult";
    $len = strlen($msg);
        //socket_write($sock, $msg, strlen($msg));
    socket_sendto($sock, $msg, $len, 0, '127.0.0.1', 11104);
    //$buf=socket_read($sock, 2048);
    socket_recvfrom($sock, $buf, 12, 0, $from, $port);
    echo $buf;
    socket_close($sock);
?> 
```

服务器从客户端接收数据，但客户端从服务器没有得到任何数据，并且没有停止运行。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-29T23:16:32.027

服务器将数据包发送回自己，您需要将其传递给客户端的端口，而不是服务器的端口。所以：

```
socket_recvfrom($socket, $buf, 12, 0, $from, $port);
socket_sendto($socket, $msg, strlen($msg), 0, $from, $port); 
```

# c# - ASP.NET 部分页面类名称最佳实践

> ID：695572
> 
> 赞同：1
> 
> 时间：2009-03-29T23:03:10.127
> 
> 标签：c#, asp.net, vb.net, class-design

当您在 VS 2008 中创建新的 asp.net 页面并选择后面的代码时，它还会创建典型的 aspx.vb 或 aspx.cs 文件以配合它。

在这些文件的顶部，VS 将“部分类”名称命名为文件结构和/或 aspx 文件的名称。

问题：是否有最佳实践？我可以只为我的应用程序中的所有页面或单个目录使用一个类名，而不必给每个页面一个唯一的名称吗？

克里斯

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-29T23:23:40.013

我认为“部分类”的原因是允许 Visual Studio 将所有声明放在一个单独的文件中，这样它们就不会弄乱代码隐藏。除了 aspx.vb/cs 文件之外，还有一个 Designer.vb/cs 文件，其中包含所有控件声明。

查看[asp.net：部分类和继承](https://stackoverflow.com/questions/480915/asp-net-partial-classes-and-inheritance)以获取更多信息。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-29T23:06:34.737

代码隐藏特定于单个页面。弄乱它会破坏 aspx 模型（请参阅 aspx 页面顶部的“继承”或类似内容）。

每个 aspx 页面（在常规 ASP.NET 中）都应该有一个单独的类。

在 ASP.NET MVC 中，请注意单个控制器类通常与多个相关视图相关联（并且 aspx/ascx 在 MVC 中不倾向于具有代码隐藏）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-29T23:17:11.323

在我们的项目中，由于大部分实际工作是由服务器端标签插入页面的服务器控件完成的，因此我们实际上不需要在大多数页面中隐藏代码。因此，在我们的 22 个 aspx 页面中，大约有 18 个甚至没有 <%Page%> 指令。默认页面基类是从 web.config 文件中设置的：

```
 <pages masterPageFile="~/MasterPage.master" pageBaseType="OurProject.OurBasePageClass">
    </pages> 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-03-29T23:05:50.150

不，每个页面都必须是不同的类（假设它们实际上在做不同的事情）。这是因为您实际上是在为每个页面创建 Page 的子类，然后用您的特定行为覆盖默认逻辑。所以每组行为（每个“页面类型”）都是一个不同的类。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2009-03-29T23:08:18.273

对于许多 ASPX 页面，使用与“代码隐藏”相同的类实际上有点常见。如果您发现自己在基页类及其关联的 ASPX 文件之间进行了大量的一对一操作，那么坚持使用默认模型是有意义的。但是，如果这对您的应用程序没有意义，那么没有什么可以阻止您将所有 ASPX **Inherits**属性指向同一个类。

当然，与任何事情一样，最好在打破规则之前先了解规则。普通的 WebForms 模型确实适合大多数用例，尤其是对于 ASP.NET WebForms 平台的初学者或中级开发人员。因此，在开始更改内容之前，请确保您足够了解自己正在进入的内容:)

# sql - 在 MS SQL Server 中创建作为保留字/关键字的表名

> ID：695578
> 
> 赞同：58
> 
> 时间：2009-03-29T23:06:59.337
> 
> 标签：sql, sql-server

可以命名我已经是关键字的数据库表吗？就我而言，我试图命名将容纳我的用户的表。我已将其命名为**用户**，但它在 SQL Server Management Studio 中显示为粉红色，因此我假设它是现有的系统表或关键字。谢谢你的建议。

保留关键字的官方列表：[保留关键字 (Transact-SQL)](http://msdn.microsoft.com/en-us/library/ms189822%28v=sql.105%29.aspx)

* * *

## 回答 #1

> 赞同：125
> 
> 时间：2009-03-29T23:34:19.083

重复三遍：

不要这样做，我不会使用保留字！

你会感谢我的！

* * *

## 回答 #2

> 赞同：79
> 
> 时间：2009-03-29T23:12:57.857

您可以创建与关键字同名的表。如果您“引用”表名，它应该可以工作。SQL server 中的默认引号是方括号：[]

```
CREATE TABLE [dbo].[user](
    [id] [bigint] NOT NULL,
    [name] [varchar](20) NOT NULL
) ON [PRIMARY] 
```

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2009-03-29T23:13:53.750

是的，没关系。在您的查询中，您可以将 [ 和 ] 放在您的表名周围，以便 SQL Server 知道您指的是一个表 - 即

```
CREATE TABLE [User] ...
SELECT * FROM [User] 
```

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2009-03-29T23:12:29.807

您可以使用 [User] 来执行此操作。如果可能，请使用与关键字不冲突的表名，以避免混淆和错误。

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2010-12-01T20:18:59.730

对于 MS Query，我发现双引号在 Query 中非常有效。

```
select T1."Reference"
from MyTable T1 
```

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2012-04-25T15:23:26.340

对*字符串*使用**“单引号”**，对列名使用**“双引号”**。

 ***例子：

```
INSERT INTO AccountMovement
("Date", Info)
VALUES
('2012/03/17', 'aa'),
('2012/03/17', 'bb'),
('2012/03/17', 'cc'),
('2012/03/17', 'dd') 
```

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2009-03-30T00:51:26.653

我坐在阵营中，说表名应该是复数，所以在你的情况下就是用户。

我喜欢这个约定，因为它对我来说很有意义。您有一组用户，因此请调用您的表。如果您拉出一个单独的行，然后可以填充一个名为 User 的对象，则进一步向下流。

如果您的约定要求对表名使用单数，请使用不同的名称，例如：Member、Client 等。

另请参阅 RacerX 的答案！

如前所述，如果您 [Braket] 该名称在技术上是可以的。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2009-03-29T23:52:32.160

如前所述，您可以通过引用名称来做到这一点。当然，您还必须在引用该名称时引用它 - 相信我，它很快就会变老。

顺便说一句，仅仅因为 SSMS 语法为这个词着色并不一定意味着它是一个[保留词](http://msdn.microsoft.com/en-us/library/aa238507.aspx)。Sql 可能会像那样烦人。;)

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2009-03-30T00:16:50.637

表名和列名的基本规则（或一般更好的对象名）：

不要使用与保留字相同或什至相似的任何内容。仅使用 A-Za-z0-9 和下划线。特别是不要使用空格。仅使用不需要转义的名称，然后不要将转义用作永久测试。

您，以及与您一起工作或将在您的代码上工作的每个人，都不需要恶化。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2009-04-03T13:26:02.010

正如其他人所说，不要这样做；然而，我在同一条船上。我有一条规则说我所有的表都以单数形式存储。组织不是组织，资产不是资产 PartsCatalog 有很多 Part 等。

好吧，我有一个用户表，所以我该怎么称呼它？我最终逃脱了它[用户]。现在我后悔那个决定，因为我总是忘记逃离桌子；但是，我还没有想出更好的名字：Member 是主要候选人。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2014-11-15T16:03:56.350

不是一个好主意-出于各种充分的理由

为什么不这样做的更多原因 1) 与保留名称的明显可能冲突 2) 如果您想在两年内对表单字段中的“用户”代码或使用通用名称时搞砸的任何地方的代码进行全局替换 3) 如果你需要搜索在你的代码中使用“用户”的场合——你知道它的去向（我们有超过一百万行代码，它会杀了我们）。

我们做了什么 1) 每个表名都有一个唯一的开头，例如对象的 O_nnn 财务数据的 F_nnn ......我们将相同的字段应用于 opp_created 等字段，用于在日期创建机会，SUSR_RID 用于引用销售函数中的用户 ID 与OPUSR_RID 对用户的操作引用... 2) 除了前缀，我们使用尽可能明显的名称，例如 O_FlightArrivalTime 而不是 O_FltAT。今天的数据库没有显示出更长名称的性能下降。3) 现在，当使用 OF_FlightArrivalTime 作为 Formfield 名称时，您可以轻松找到关联，但全局搜索 O_F... 只会找到 DB 字段、搜索 OF_F... 表单字段和 _F.... 两者.

# .net - C# 正则表达式替换问题

> ID：695579
> 
> 赞同：3
> 
> 时间：2009-03-29T23:07:03.907
> 
> 标签：.net, regex, replace

如果我有这样的字符串“Hello - World - Hello World”

我想替换子字符串的第一个实例之前的字符“ - ”

例如，用“SUPERDOOPER”替换上面的内容会留下：“SUPERDOOPER - World - Hello World”

到目前为止，我得到了这个：“^[^-]* - ”

但这包括错误的“ - ”。

请问如何用正则表达式做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-29T23:13:10.430

使用[非捕获组](http://www.exampledepot.com/egs/java.util.regex/NoGroup.html)，它先于模式检查以验证匹配，但不将这些字符包含在匹配本身中。

```
(^[^-]*)(?: -) 
```

编辑：再想一想，这似乎有点多余。这不工作吗？：

```
^[^-]* 
```

获取字符串开头之间的所有非破折号字符并继续直到遇到破折号？还是您也需要排除空间？如果是这样，请选择第一个。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-30T00:45:21.597

为什么你认为你需要对这样的字符串操作使用正则表达式？

这更简单，更有效：

```
str = "SUPERDOOPER" + str.Substring(str.IndexOf(" -")); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-30T00:17:23.147

您可以尝试将正则表达式与积极的前瞻一起使用：`"^[^-]*(?= - )"`。据我所知，C# 支持它。此正则表达式将*完全*匹配您想要的。[您可以在著名的《精通正则表达式》](https://rads.stackoverflow.com/amzn/click/com/0596528124)一书中找到更多关于前瞻、后瞻和其他高级正则表达式技术的信息。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-29T23:13:22.940

你就不能这样做吗？

Regex.Replace("World - Hello World", "^[^-]* -", "SUPERDOOPER -");

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-29T23:14:19.740

```
Regex.Replace(input, @"(Hello)( -.*\1)", @"SUPERDOOPER$2"); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-29T23:15:05.090

模式： ([^-]+) (- .+)

第一个表达式匹配任何一系列不包括破折号的字符。然后是一个空间。第二个表达式以破折号和空格开头，后跟一系列一个或多个“任意”字符。

替代品：“Superdooper $2”

交付 Superdooper - World - Hello World

# firebird - 如何执行 Firebird 的命令行卸载？

> ID：695580
> 
> 赞同：2
> 
> 时间：2009-03-29T23:07:08.120
> 
> 标签：firebird, uninstallation

我使用命令行开关从我的应用程序的安装包中安装 Firebird 数据库。但现在我想以同样的方式卸载 Firebird。

问题是 Firebird 的 Windows 安装可执行文件是使用 Inno Setup 构建的。为了卸载 Inno Setup 可执行文件，您必须运行一个名为`uninst???.exe`Firebird 安装目录的文件，其中 ??? 是一些三位数字。

细节：

*   我使用 InstallAware 作为我的安装构建器。它提供了一种类似于 InstallShield 的脚本语言。
*   我正在安装 Firebird 的 SuperServer 版本，而不是嵌入式版本。（我需要此应用程序的并发用户访问权限。）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-30T00:12:26.200

HKLM\Software\Microsoft\Windows\Currentversion\Uninstall\ 例如 {350C97B0-3D7C-4EE8-BAA9-00BCB3D54227} 在下面你会找到一个名为“UninstallString”的键，你应该能够执行并卸载。

有些程序是按名称列出的，而不是 GUID，所以请仔细检查

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-05T21:50:08.883

注册表中有一个名为 DefaultInstace 的键

在德尔福代码中

```
function TfrmMain.FBDefaultInstance: String;
var
  Reg: TRegistry;
begin
  Reg := TRegistry.Create;
  try
    Reg.RootKey := HKEY_LOCAL_MACHINE;
    Reg.OpenKeyReadOnly('SOFTWARE\Firebird Project\Firebird Server\Instances');
    Result := Reg.ReadString('DefaultInstance');
    Reg.CloseKey;
  finally
    Reg.Free;
  end;
end; 
```

在您停止服务并启动卸载之后

DefaultPath + 'unins000.exe /SILENT /NORESTART /SUPPRESSMSGBOXES'

# javascript - 垂直文本菜单上的模糊鱼眼效果

> ID：695586
> 
> 赞同：1
> 
> 时间：2009-03-29T23:12:18.777
> 
> 标签：javascript, menu, blur

我正在搜索现有脚本，这些脚本将通过模糊文本并根据鼠标指针对其进行缩放来为垂直文本菜单设置动画。

我正在尝试完成这些操作：

1.  鼠标悬停时类似 OS X 的移动，可以“放大”和缩小文本
2.  在未集中注意力的状态下，文本会变得模糊
3.  当用户将他们的指针移近文本时，文本会锐化。

[这是一个演示一些效果的 Flash 示例](http://www.flashden.net/item/vertical-fisheye-menu/19994)，但我真的更喜欢使用 JavaScript 而不是使用“向下”、“向上”和“选择”按钮，自然而然。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-29T23:58:13.877

这是一个我认为可以为您工作的开源脚本（或者至少经过轻微修改）

[http://marcgrabanski.com/pages/code/fisheye-menu](http://marcgrabanski.com/pages/code/fisheye-menu)

以及使用它的教程： http: [//simply-basic.com/tools/fisheye-menu-for-your-website/](http://simply-basic.com/tools/fisheye-menu-for-your-website/)

编辑：

我意识到上面的脚本可能不能很好地处理文本。不幸的是，在 javascript 中模糊文本并不容易。使用 canvas 元素可能是可能的，但我无法在快速的谷歌搜索中找到任何东西，这可能与旧浏览器不兼容。

这是另一个对列表中的文本项具有鱼眼效果的脚本：http: [//aleph-null.tv/article/20080522-1839-265.xml/Text-based-Fish-Eye-Effect](http://aleph-null.tv/article/20080522-1839-265.xml/Text-based-Fish-Eye-Effect)。这可能更接近您正在寻找的内容，但它绝对没有那么流畅，并且不允许您像 flash 那样模糊文本。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-30T00:22:08.797

我不确定您是否可以在 Javascript 中执行此操作...

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-01-21T20:21:04.923

不是对这个老问题的严格回答，但今天你可以使用 CSS3 轻松实现类似的东西（无需任何 javascript）：

```
.fancy-bar {
    height: 80px;
    display: flex;
    flex-direction: row;
    flex-wrap: nowrap;
    justify-content: center;
    align-items: flex-end;
}

.fancy-bar .item {
    display: inline-block;
    margin: 5px;
}

.fancy-bar .item .ball {
    width: 40px;
    height: 40px;
    margin: 0 auto;
    -webkit-transition: all 0.5s ease;
    -moz-transition: all 0.5s ease;
    -o-transition: all 0.5s ease;
    transition: all 0.5s;
    -webkit-border-radius: 20px;
    -moz-border-radius: 20px;
    border-radius: 20px;
}

.fancy-bar .item-black .ball {
    background-color: black;
}

.fancy-bar .item-red .ball {
    background-color: red;
}

.fancy-bar .item-green .ball {
    background-color: green;
}

.fancy-bar .item-brown .ball {
    background-color: brown;
}

.fancy-bar .item-orange .ball {
    background-color: orange;
}

.fancy-bar .item:hover .ball {
    width: 60px;
    height: 60px;
    -webkit-border-radius: 30px;
    -moz-border-radius: 30px;
    border-radius: 30px;
}

.fancy-bar .item .title {
    text-align: center;
    font-size: 11px;
    font-family: sans-serif;
    color: #ccc;
    text-shadow: #777 0px 0px 2px;
    opacity: 0.8;
    -webkit-transition: all 0.5s ease;
    -moz-transition: all 0.5s ease;
    -o-transition: all 0.5s ease;
    transition: all 0.5s;
}

.fancy-bar .item:hover .title {
    font-size: 13px;
    opacity: 1;
    text-shadow: none;
}

.fancy-bar .item-black:hover .title {
    color: black;
}

.fancy-bar .item-red:hover .title {
    color: red;
}

.fancy-bar .item-green:hover .title {
    color: green;
}

.fancy-bar .item-brown:hover .title {
    color: brown;
}

.fancy-bar .item-orange:hover .title {
    color: orange;
}
```

```
<div class="fancy-bar">

<div class="item item-black">
  <div class="ball"></div>
  <div class="title">First</div>
</div>

<div class="item item-red">
  <div class="ball"></div>
  <div class="title">Second</div>
</div>

<div class="item item-green">
  <div class="ball"></div>
  <div class="title">Third</div>
</div>

<div class="item item-brown">
  <div class="ball"></div>
  <div class="title">Fourth</div>
</div>

<div class="item item-orange">
  <div class="ball"></div>
  <div class="title">Fifth</div>
</div>

</div>
```

# c# - 是否有任何工具可以从 XAML 转换为 C#（代码隐藏）？

> ID：695591
> 
> 赞同：2
> 
> 时间：2009-03-29T23:13:02.770
> 
> 标签：c#, wpf, xaml

我正在寻找一种将一些 XAML 动画转换为 C# 代码的简单方法。有没有可用的工具来做到这一点？

谢谢！

沃利

这是我要转换的代码：

```
<Storyboard x:Key="Storyboard1">
  <Rotation3DAnimationUsingKeyFrames BeginTime="00:00:00"
      Storyboard.TargetName="DefaultGroup"
      Storyboard.TargetProperty="(Visual3D.Transform).(Transform3DGroup.Children)[2].(RotateTransform3D.Rotation)">
    <SplineRotation3DKeyFrame KeyTime="00:00:04.0200000">
      <SplineRotation3DKeyFrame.Value>
        <AxisAngleRotation3D Angle="144.99999999999997" Axis="1,0,0"/>
      </SplineRotation3DKeyFrame.Value>
    </SplineRotation3DKeyFrame>
  </Rotation3DAnimationUsingKeyFrames>
</Storyboard> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-29T23:24:51.150

您可以使用 XamlReader.Load("") 来解析它。希望能帮助到你 ：）

编辑：

```
StoryBoard myStoryBoard = (StoryBoard)XamlReader.Load("code"); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-31T13:25:37.673

这与 c# 中的代码相同：

```
Storyboard storyboard3 = new Storyboard();

storyboard3.AutoReverse = false;
Rotation3DAnimationUsingKeyFrames r3d = new Rotation3DAnimationUsingKeyFrames();
r3d.BeginTime = new TimeSpan(0, 0, 0, 0, 0);
r3d.Duration = new TimeSpan(0,0,0,1,0);

r3d.KeyFrames.Add(new SplineRotation3DKeyFrame(new AxisAngleRotation3D(new Vector3D(1,0,0),1)));
r3d.KeyFrames.Add(new SplineRotation3DKeyFrame(new AxisAngleRotation3D(new Vector3D(1, 0, 0), 37)));
r3d.Name = "r3d";

Storyboard.SetTargetName(r3d, "DefaultGroup");
Storyboard.SetTargetProperty(r3d, new PropertyPath("(Visual3D.Transform).(Transform3DGroup.Children)[2].(RotateTransform3D.Rotation)")); 

storyboard3.Children.Add(r3d);
this.BeginStoryboard(storyboard3); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-30T04:04:56.173

为什么需要将 XAML 转换为过程代码？如果我正确阅读了您的评论之一，那是因为您需要在运行时更改值。如果是这种情况，[数据绑定](http://msdn.microsoft.com/en-us/library/ms750612.aspx)可能会更好。您能否描述一下您尝试用 C# 做哪些不能用 XAML 做的事情？

# windows - 使用批处理文件打开多个 PDF 文档

> ID：695603
> 
> 赞同：8
> 
> 时间：2009-03-29T23:17:35.910
> 
> 标签：windows, batch-file, pdf, cmd, acrobat

我正在尝试使用一个简单的批处理文件打开几个 PDF 文档：

```
ECHO OFF
CLS
cd Program Files\Adobe\Reader 9.0\Reader
Acrord32.exe C:\Users\BW1.pdf
Acrord32.exe C:\Users\BW2.pdf
Acrord32.exe C:\Users\BW3.pdf
Acrord32.exe C:\Users\BW4.pdf
Acrord32.exe C:\Users\BW5.pdf
Acrord32.exe C:\Users\BW6.pdf
EXIT 
```

上面的批处理文件只打开第一个 PDF，然后等到我关闭它以打开下一个 PDF 文件。如何同时打开所有 PDF 文档？（比如去Acrobat Reader，file->Open->xx.pdf）

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-03-29T23:23:48.767

使用`start`：

```
start acrord32.exe 1.pdf
start acrord32.exe 2.pdf
start acrord32.exe 3.pdf 
```

甚至（正如 Johannes Rössel 在下面的评论中建议的那样）：

```
start 1.pdf
start 2.pdf
start 3.pdf 
```

可能也可以（取决于您的默认 PDF 查看器）。

请注意，在使用`start`带引号的参数时必须小心，因为以下内容不起作用（第一个带引号的参数被解释为新控制台窗口的标题）：

```
start "1.pdf" 
```

相反，您必须执行以下操作：

```
start "" "1.pdf" 
```

这是一个令人讨厌的怪癖`start`，但在这种情况下，您必须有效地提供一个虚拟标题才能正确打开指定的文件（即使标题是不必要的，因为这不会创建新的控制台窗口）。

[其他可用批处理命令的列表。](http://www.computerhope.com/batch.htm)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2010-08-12T14:04:20.757

对我来说，即使没有`start`命令它也可以工作。我用：

```
c:\path\to\my.pdf 
```

经常在 cmd.exe 窗口中，它总是打开 Acrobat Reader（我在 Windows 上的默认查看器）。在我编写的通过 Ghostscript 生成 PDF 的批处理文件中，我的最后两行是：

```
"%ouptutpath%\%outputfile%.pdf"
"%outputpath%\%outputfile%-optimized.pdf" 
```

它会自动在两个不同的阅读器窗口中打开两个生成的 PDF。（我的`%outputpath%`包含空格，`%outputfile%`也可能有一些...）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-29T23:25:35.190

您是否尝试过 Acrobat Reader 是否允许在命令行上显示更多文件，即。

```
start acrord32.exe 1.pdf 2.pdf 3.pdf 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-30T13:00:51.657

谢谢！

使用 start 就可以了。我必须使用 start 的次数与要打开的 pdf 文档的数量一样多。由于某些原因

启动 acrord32.exe 1.pdf 2.pdf 3.pdf

仅打开第一个文档。所以我猜 Acrobat reader 可能不允许在命令行上使用更多文件。

我很感激你的回答。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-05-10T09:31:08.210

感谢以上回答。

我也在下面尝试过，工作正常：

开始 /B excel.exe "D:\我的第一个文件.xlsx" "E:\我的第二个文件.xlsx" "D:\工作文件夹\我的第三个文件.xlsx"

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2017-11-25T03:48:57.853

对于指定目录中的每个 pdf 文件，对该文件使用 start 命令：

```
for %f ("C:\Users\*.pdf") do start %f 
```

根据微软文档：

> For 为一组文件中的每个文件运行指定的命令。
> 
> `for {%variable|%%variable} in (set) do command [ CommandLineOptions]`

# ruby-on-rails - 铁路验证 错误处理

> ID：695604
> 
> 赞同：0
> 
> 时间：2009-03-29T23:18:18.373
> 
> 标签：ruby-on-rails, error-handling

目前，当我的 rails 应用程序遇到错误时，它会将错误代码和堆栈跟踪转储到浏览器窗口中。

如何关闭此功能，以便这些错误仅记录在日志中而不输出到浏览器？

谢谢

**更正：**我最关心的只是验证错误。我想要的只是使用生成的脚手架时获得的相同功能。我想显示验证错误消息并突出显示有问题的表单字段。现在我得到的只是这个标准的开发错误输出。最初这是在我的应用程序上运行的，但不知何故它丢失了。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-29T23:23:09.627

当您的服务器在生产模式下遇到错误时，它将显示默认的 rails 错误页面，而不是您在开发模式下看到的堆栈跟踪。

您可以通过将自定义静态 html 500 或 404 错误页面放在 public/500.html 和 public/404.html 中来添加它们。

如果您想以不同的方式处理错误，可以将以下代码放入 ApplicationController 中（此代码未经测试，但基于我的一个项目中非常相似的方法）：

```
around_filter :handle_errors

def handle_errors
  begin
    yield
   rescue Exception => e
     # Handle the exception however you wish.
   end
end 
```

请注意，上面的代码不会处理 404 错误。但是，您可以通过将以下内容放在 config/routes.rb 的底部来指定默认操作来处理无法定位的路由：

```
map.connect '*path', :controller => 'home', :action => 'page_not_found' 
```

编辑：

在进行了更多研究之后，有一种替代且可能更好的自定义错误处理方法：http: [//brian.pontarelli.com/2007/01/14/handling-rails-404-and-500-errors/](http://brian.pontarelli.com/2007/01/14/handling-rails-404-and-500-errors/)。本质上，建议是覆盖如下`rescue_action_in_public`方法：

```
 def rescue_action_in_public(exception)
    render :template => "shared/error", :layout => "standard", :status => "500"
  end 
```

# html - 您是否允许输入没有值？

> ID：695618
> 
> 赞同：5
> 
> 时间：2009-03-29T23:25:35.783
> 
> 标签：html, forms, input

以下是否允许？

```
<input type="hidden" name="field" /> 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-03-29T23:28:41.623

在隐藏字段中很好。仅在复选框和单选输入中需要。它永远不能用文件输入来指定。见[http://www.w3schools.com/TAGS/att_input_value.asp](http://www.w3schools.com/TAGS/att_input_value.asp)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-29T23:35:04.357

[XHTML 1.1 模式](http://www.w3.org/TR/xhtml-modularization/schema_module_defs.html#a_smodule_Basic_Forms)说这**不是**`value`强制性的：

 **```
 <xs:attributeGroup name="xhtml.input.attlist">
    <xs:attributeGroup ref="xhtml.Common.attrib"/>
    <xs:attribute name="type" type="xhtml.InputType.class" default="text"/>    
    <xs:attribute name="name" type="xh11d:CDATA"/>
    <xs:attribute name="value" type="xh11d:CDATA"/>
    <xs:attribute name="checked">
      <xs:simpleType>
        <xs:restriction base="xs:NMTOKEN">
          <xs:enumeration value="checked"/>
        </xs:restriction>
      </xs:simpleType>
    </xs:attribute>
    <xs:attribute name="size" type="xh11d:Number"/>
    <xs:attribute name="maxlength" type="xh11d:Number"/>
    <xs:attribute name="src" type="xh11d:URI"/>
    <xs:attribute name="tabindex" type="xh11d:Number"/>    
    <xs:attribute name="accesskey" type="xh11d:Character"/>
  </xs:attributeGroup> 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-29T23:29:12.607

是的，表单输入由您控制以满足您的要求，只要它们格式正确且有效的 xhtml。

不过，这似乎毫无意义。

# wpf - 将 datacontext 字符串属性绑定到 StaticResource 键

> ID：695624
> 
> 赞同：11
> 
> 时间：2009-03-29T23:31:25.597
> 
> 标签：wpf, data-binding, binding, static-resource

我有一个带有 ResourceKey 和 Caption 的 List 值，这些值都是字符串。Resource 是资源字典中定义的实际资源的名称。这些 ResourceKey 图标中的每一个都是 Canvas 的。

```
<Data ResourceKey="IconCalendar" Caption="Calendar"/>
<Data ResourceKey="IconEmail" Caption="Email"/> 
```

然后我有一个列表视图，其中有一个带有按钮的数据模板和按钮下方的文本标题。我想要做的是将 Resource 静态资源显示为按钮的内容。

```
<ListView.ItemTemplate>
    <DataTemplate>
        <Grid>
            <Grid.RowDefinitions>
                <RowDefinition Height="*" />
                <RowDefinition Height="Auto" />
            </Grid.RowDefinitions>

            <Button Content="{Binding ResourceKey}" Template="{StaticResource  RoundButtonControlTemplate}"/>
            <TextBlock Grid.Row="1" Margin="0,10,0,0" Text="{Binding Caption}" HorizontalAlignment="Center" FontSize="20" FontWeight="Bold" />
        </Grid>
    </DataTemplate>
</ListView.ItemTemplate> 
```

我想我已经尝试了绑定静态资源等的所有排列。

我对替代方案持开放态度，我知道只有一张图像并设置源属性可能更容易。

谢谢

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-03-29T23:58:22.863

经过一番思考后，我最终使用了`ValueConvertor`这样的：

```
class StaticResourceConverter : IValueConverter
{
    public object Convert(object value, Type targetType, object parameter, CultureInfo culture)
    {
        var resourceKey = (string)value;

        return Application.Current.Resources[resourceKey];
    }

    public object ConvertBack(object value, Type targetType, object parameter, CultureInfo culture)
    {
        throw new Exception("The method or operation is not implemented.");
    }
} 
```

并且按钮上的绑定变为

```
<Button Content="{Binding ResourceKey, Converter={StaticResource resourceConverter}}" /> 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2016-04-15T07:44:03.663

在这里，我得到了@dvkwong 答案的改进版本（以及@Anatoliy Nikolaev 的编辑）：

```
class StaticResourceConverter : MarkupExtension, IValueConverter
{
    private Control _target;

    public object Convert(object value, Type targetType, object parameter, CultureInfo culture)
    {
        var resourceKey = (string)value;

        return _target?.FindResource(resourceKey) ?? Application.Current.FindResource(resourceKey);
    }

    public object ConvertBack(object value, Type targetType, object parameter, CultureInfo culture)
    {
        throw new NotSupportedException();
    }

    public override object ProvideValue(IServiceProvider serviceProvider)
    {
        var rootObjectProvider = serviceProvider.GetService(typeof(IRootObjectProvider)) as IRootObjectProvider;
        if (rootObjectProvider == null)
            return this;

        _target = rootObjectProvider.RootObject as Control;
        return this;
    }
} 
```

用法：

```
<Button Content="{Binding ResourceKey, Converter={design:StaticResourceConverter}}" /> 
```

这里的主要变化是：

1.  转换器现在是一个`System.Windows.Markup.MarkupExtension`，所以它可以直接使用而不被声明为资源。

2.  转换器是上下文感知的，因此它不仅会在您的应用程序的资源中查找，还会在本地资源（当前窗口、用户控件或页面等）中查找。

# nginx - Best method of post processing Nginx reverse proxy response

> ID：695630
> 
> 赞同：8
> 
> 时间：2009-03-29T23:39:59.850
> 
> 标签：nginx, reverse-proxy

I'm doing some researching on switching from Apache to Nginx as a reverse proxy in front of a Grails application on the backend. I'm playing around with some URL rewriting and have run into an issue with the response being sent back from my back end. I can handle the location header rewrite but I'm wondering what the best way to process the actually content is for link and such.

Is nginx_substitutions_filter the preferred method or is there another module that folks use to do content replacement in the response body?

I've thought about creating a Grails plugin to handle rendering the correct content based on additional request headers but now I'm thinking that would be best handled outside the application to allow for the most flexibility and loose coupling.

Are there any articles about best practices for doing URL rewriting/response post processing for reverse proxy scenarios?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-31T02:13:14.217

您可以使用 Lua 模块来捕获响应并像 Lua 字符串一样对其进行操作。将输出大写的愚蠢示例：

```
res = ngx.location.capture('/some/path')
ngx.print(string.upper(res.body)) 
```

见[http://wiki.nginx.org/HttpLuaModule#ngx.location.capture](http://wiki.nginx.org/HttpLuaModule#ngx.location.capture)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-03-31T09:10:03.480

如果您只想替换标题，HeadersMore 3rd 方模块非常适合。除此之外，susbstiution 模块似乎是唯一的选择。

但我建议你让后端返回正确的页面。修改每个响应都会占用资源并且需要时间。

# php - 在 PHP preg_replace 函数中包含新行

> ID：695633
> 
> 赞同：15
> 
> 时间：2009-03-29T23:41:57.740
> 
> 标签：php, regex, newline

我正在尝试匹配可能出现在多行上的字符串。它以特定字符串开头和结尾：

```
{a}some string
can be multiple lines
{/a} 
```

我可以在正则表达式之间获取所有内容`{a}`吗`{/a}`？看来. 不匹配新行，但我尝试了以下但没有运气：

```
$template = preg_replace( $'/\{a\}([.\n]+)\{\/a\}/', 'X', $template, -1, $count );
echo $count; // prints 0 
```

它匹配 。或 \n 当他们独自一人但不在一起时！

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2009-03-29T23:44:27.873

使用[`s`修饰符](http://www.php.net/manual/en/reference.pcre.pattern.modifiers.php)：

```
$template = preg_replace( $'/\{a\}([.\n]+)\{\/a\}/s', 'X', $template, -1, $count );
//                                                ^
echo $count; 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-03-30T06:42:31.537

我认为您遇到的问题不仅仅是点不匹配换行符，但让我从格式建议开始。您可以使用几乎任何标点符号作为正则表达式分隔符，而不仅仅是斜杠 ('/')。如果您使用另一个字符，则不必在正则表达式中转义斜杠。我知道 '%' 在 PHPers 中很流行；这将使您的模式论点：

```
'%\{a\}([.\n]+)\{/a\}%' 
```

现在，正则表达式没有按您的预期工作的原因是，当点出现在字符类（方括号）中时，它失去了它的特殊含义——所以`[.\n]`只匹配一个点或换行符。您正在寻找的是`(?:.|\n)`，但我会建议匹配回车符和换行符：

```
'%\{a\}((?:.|[\r\n])+)\{/a\}%' 
```

这是因为“换行符”这个词可以指代 Unix 样式的“\n”、Windows 样式的“\r\n”或旧 Mac 样式的“\r”。任何给定的网页可能包含其中任何一种或两种或多种样式的混合；"\n" 和 "\r\n" 的混合很常见。但是使用 /s 模式（也称为单行或 DOTALL 模式），您无需担心：

```
'%\{a\}(.+)\{/a\}%s' 
```

但是，原始正则表达式存在另一个问题，它仍然存在于这个问题中：`+`贪婪。这意味着，如果文本中有多个`{a}...{/a}`序列，则第一次应用正则表达式时，它将匹配所有序列，从 first`{a}`到 last `{/a}`。`+`解决这个问题的最简单方法是通过附加一个问号来使不贪心（又名“懒惰”或“不情愿”）：

```
'%\{a\}(.+?)\{/a\}%s' 
```

最后，我不知道在你的模式参数的开头引号之前如何理解'$'。我不做 PHP，但这对我来说似乎是一个语法错误。如果有人可以在这件事上教育我，我将不胜感激。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-29T23:48:41.203

来自[http://www.regular-expressions.info/dot.html](http://www.regular-expressions.info/dot.html)：

> “点匹配单个字符，而不关心那个字符是什么。唯一的例外是换行符。”

您需要在表达式中添加一个尾随 /s 标志。

# iphone - UITableView 滚动太远并导致奇怪的事情

> ID：695640
> 
> 赞同：4
> 
> 时间：2009-03-29T23:48:14.183
> 
> 标签：iphone, cocoa-touch, uitableview

我有一个 UITableView，当滚动到远弹包时。这也意味着用户可以拖动表格，使其只有一半是可见的，而主视图的另一半是白色的。这会在我的应用程序中导致一些奇怪的行为。我在 AppDelegate 中创建了一个数组。在 RootViewController 的 viewDidLoad 中，我获得了对 AppDelegate 的引用并保留它直到应用程序关闭。在 RootViewController 的 cellForRowAtIndexPath 中，我引用 AppDelegate 实例的数组来获取将填充单元标签的对象。在用户如上所述滚动之前，它工作正常。一旦发生这种情况，就可以在调试器中看到对象 7，例如数组中的对象 7 已变成 UICachedDeviceRGBColor。我不知道为什么会这样。该数组仅在 AppDelegate 中在应用创建时分配一次。

据我所知，我必须首先单击表格中的一行。新视图被推送，其中也有一个 UITableView。在第二个视图的 cellForRowAtIndexPath 中，我检查了 delegate.array，因为第二个视图也有对数组的引用。我立即看到数组中的对象 2 是：

```
2 : UIDeviceRGBColorSpace 1 1 1 1 
```

这是不应该的。然后，当我单击返回并再次显示主表时，请执行上述滚动技术以获取怪异。我滚动表格刚好足以在 cellForRowAtIndexPath 中命中我的断点，然后看到数组已被更改。对象 2 是正确的类型，但现在对象 7 不是。

问题是，如果我尝试访问对象 7 并调用我要转换的类型的属性，那么 UICachedDeviceRGBColor 上当然不存在该属性。这是一个“Inavlid”，因此由于内存访问错误，我得到了“EXC_BAD_INSTRUCTION”。

在这种特定条件下，是什么导致数组发生这种变化？或者至少，我该如何防范呢？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-30T00:20:43.560

这是在设备上，但看起来好像我已经弄清楚了。

在 RootViewController 的 didSelectRowAtIndexPath 中，我从 delegate.thearray 中获取了一个对象。就在第二个视图被推送之前，我释放了这个对象。这是错误的，因为我没有分配对象。删除了那条线，数组中不再有怪异之处。现在似乎一切正常。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2009-03-29T23:58:56.827

这是在模拟器还是设备上？

当我使用鼠标上的滚轮滚动表格时，我发现只有在模拟器上才会发生这样的事情。模拟器无法判断您何时释放滚轮，因此不知道何时弹回。然后，当我触摸它时，它会弹回并在与我触摸不同的项目上注册我的触摸。这在设备上没有发生。当您使用滚动条在设备上滚动时，它会在您释放时立即弹回，因此您无法在过度滚动时触摸项目。

# c++ - 为什么 C++ 映射类型参数在使用 [] 时需要一个空的构造函数？

> ID：695645
> 
> 赞同：115
> 
> 时间：2009-03-29T23:49:59.343
> 
> 标签：c++, dictionary

> 另请参阅 [C++ 标准列表和默认可构造类型](https://stackoverflow.com/questions/695372/c-standard-list-and-default-constructible-types)

不是主要问题，只是烦人，因为我不希望我的类在没有特定参数的情况下被实例化。

```
#include <map>

struct MyClass
{
    MyClass(int t);
};

int main() {
    std::map<int, MyClass> myMap;
    myMap[14] = MyClass(42);
} 
```

这给了我以下 g++ 错误：

> /usr/include/c++/4.3/bits/stl_map.h:419: 错误：没有匹配函数调用'MyClass()'</p>

如果我添加一个默认构造函数，这编译得很好；我确定这不是由不正确的语法引起的。

* * *

## 回答 #1

> 赞同：182
> 
> 时间：2009-03-30T00:01:41.000

This issue comes with operator[]. Quote from SGI documentation:

> `data_type& operator[](const key_type& k)` - Returns a reference to the object that is associated with a particular key. If the map does not already contain such an object, `operator[]` inserts the default object `data_type()`.

If you don't have default constructor you can use insert/find functions. Following example works fine:

```
myMap.insert( std::map< int, MyClass >::value_type ( 1, MyClass(1) ) );
myMap.find( 1 )->second; 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-03-29T23:54:51.890

~~是的。STL 容器中的值需要维护复制语义。IOW，它们需要表现得像原始类型（例如 int），这意味着它们应该是默认可构造的。~~

~~如果没有这个（和其他要求），就很难在实现 STL 容器的数据结构上实现各种内部复制/移动/交换/比较操作。~~

参考 C++ 标准后，我发现我的答案不准确。**实际上，默认构造不是必需的**：

从 20.1.4.1 开始：

> 默认构造函数不是必需的。某些容器类成员函数签名将默认构造函数指定为默认参数。T() 必须是定义明确的表达式...

因此，严格来说，如果您碰巧使用了在其签名中使用默认构造函数的容器函数，则您的值类型只需要是默认可构造的。

The real requirements (23.1.3) from all values stored in STL containers are `CopyConstructible` and `Assignable`.

There are also other specific requirements for particular containers as well, such as being `Comparable` (e.g. for keys in a map).

* * *

Incidentally, the following compiles with no error on [comeau](http://www.comeaucomputing.com/tryitout/):

```
#include <map>

class MyClass
{
public:
    MyClass(int t);
};

int main()
{
    std::map<int, MyClass> myMap;
} 
```

So this might be a g++ problem.

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-03-30T08:53:46.807

Check requirements of stored type of the stl::map. Many stl collection require that stored type contains some specific properties (default constructor, copy constructor, etc.).

Constructor without arguments is needed by the stl::map, because it's used, when operator[] is invoked with the key, which hasn't already been kept by the map. In this case the operator[] inserts the new entry consisting of the new key and value constructed using parameterless constructor. And this new value is then returned.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-12-22T19:15:32.790

assume you have the following

```
class Person
{
public:
    Person(int age) :age(age){}
    Person() {} // default ctor
    int age;
};

map<int, Person> m;

// accessing not-existent key, results in assigning default value to that key
m[10];

// creates default object for key:20 first then assigns age
m[20].age = 32; 
```

what should happen if you wanna assign `age` for a nonexistent key?

for languages with `null` type such as `javascript` the map returns `null` and its is up to user to check for it before accessing the object or its internal fields.

c++ went a different approach and creates the `Person` using default constructor so the null is avoided all together

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2009-03-29T23:54:57.757

Check if:

*   You forgot the ';' after class declaration.
*   MyType should've been declared accordingly.
*   No default constructor there...

The std::map declaration seems correct, I think.

* * *

## 回答 #6

> 赞同：-2
> 
> 时间：2009-03-29T23:58:54.657

Most likely because std::pair requires it. std::pair holds two values using value semantics so you need to be able to instantiate them without parameters. So the code uses std::pair in various places to return the map values to the caller and this is commonly done by instantiating an empty pair and assigning the values into it before returning the local pair.

You could get around this with smart pointers using a map<int, smartptr<MyClass> > but that adds the overhead of checking for null pointers.

# c# - 如何在不对 html 进行硬编码的情况下创建 html 报告？

> ID：695646
> 
> 赞同：7
> 
> 时间：2009-03-29T23:50:13.493
> 
> 标签：c#, .net, html, reporting, hard-coding

我目前正在重构一个控制台应用程序，其主要职责是根据存储在数据库中的值生成报告。

到目前为止，我创建报告的方式如下：

```
const string format = "<tr><td>{0, 10}</td><td>
                       {1}</td><td>{2, 8}</td><td>{3}</td><td>{4, -30}</td>
                       <td>{5}</td><td>{6}</td></tr>";

if(items.Count > 0)
{
    builder.AppendLine(
        String.Format(format, "Date", "Id", "WorkItemId", 
                      "Account Number", "Name", "Address", "Description"));
}

foreach(Item item in items)
{
    builder.AppendLine(String.Format(format, item.StartDate, item.Id,
                       item.WorkItemId, item.AccountNumber, 
                       String.Format("{0} {1}", 
                                     item.FirstName, item.LastName), 
                       item.Address, item.Description));
}

string report = String.Format("<html><table border=\"1\">{0}
                                     </table></html>",
                              builder.ToString()); 
```

（以上只是一个示例......对格式感到抱歉......我试图格式化它，所以它不需要水平滚动......）

我真的不喜欢我这样做的方式。它现在可以工作并且可以完成工作......但我只是认为它不可维护......特别是如果报告在需要创建的 html 方面变得更加复杂。更糟糕的是，我团队中的其他开发人员肯定会为他们的应用程序复制和粘贴我的代码，这些应用程序会生成 html 报告，并且可能会造成可怕的混乱。（我已经看到了这样的恐怖！想象一下一个报表函数，它有数百行硬编码的 sql 来检索报表的详细信息......这足以让一个成年人哭泣！）

然而，虽然我根本不喜欢这个......我只是想不出另一种方法来做到这一点。

当然必须有办法做到这一点......我很确定。不久前，我在 aspx 页面中生成表格时也在做同样的事情，直到有人向我展示了我可以将对象绑定到控件并让 .NET 负责呈现。它把可怕的代码，类似于上面的代码，变成了两三行优雅的代码。

有谁知道在不硬编码 html 的情况下为该报告创建 html 的类似方法？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-03-29T23:59:11.893

使您的应用程序生成包含原始数据的 XML 文件。然后对其应用一个包含 HTML 的外部 XSLT。

更多信息：http: [//msdn.microsoft.com/en-us/library/14689742.aspx](http://msdn.microsoft.com/en-us/library/14689742.aspx)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-30T00:13:24.263

您可以使用[NVelocity 之](http://www.castleproject.org/others/nvelocity/)类的模板引擎来分离您的报告视图和代码。那里可能还有其他不错的模板引擎...

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-30T12:40:39.443

meziod - 另一个细读的途径是 HtmlTextWriter 对象的扩展方法。我在这个网站上发现了一个绝妙的技巧。

[HtmlTextWriter 扩展](https://stackoverflow.com/questions/414605/fluent-interface-for-rendering-html)

我敢肯定，您可以从中发挥巨大的潜力...

问候 - 酷拉

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-29T23:54:42.577

好吧，您可以使用其中一种报告框架（Crystal、MS RDL 等）并*导出*为 html - 但是，我怀疑对于简单数据，您当前的方法开销较小。我可能会使用`XmlWriter`or LINQ-to-XML （而不是`string.Format`，它不会处理转义）...

```
 new XElement("tr",
            new XElement("td", item.StartDate),
            new XElement("td", item.Id),
            new XElement("td", item.WorkItemId), 
```

等。转义对于文本值（名称、描述等）尤其重要。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-30T00:13:24.763

您可以考虑使用简单的模板引擎，例如[http://www.stefansarstedt.com/templatemaschine.html](http://www.stefansarstedt.com/templatemaschine.html)并将您的模板与内容分开。

这非常实用，允许在不重新编译的情况下修改模板，并且您的模板仍然具有 C# 功能。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-30T01:36:44.547

Microsoft SQL Reporting Services 在这方面做得很好，并且可以处理多种格式。

我的公司使用它来创建 PDF 报告，由于我们有 HIPAA 要求，我们通过第三方 PDF 控件自动为其输入密码......

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2017-04-28T09:57:49.913

正如coolashaka 已经提到的，使用 HtmlTextWriter 是一个不错的选择，当然如果您添加一些有用的扩展方法，例如：

简单的例子：

```
public static void WriteNav(this
     HtmlTextWriter writer, List<String> navItems)
    {
        writer.RenderBeginTag("nav");
        writer.RenderBeginTag(HtmlTextWriterTag.Ul);
        foreach (var item in navItems)
        {
            writer.RenderBeginTag(HtmlTextWriterTag.Ul);
            writer.AddAttribute(HtmlTextWriterAttribute.Href, "~/" + item + ".html");
            writer.RenderBeginTag(HtmlTextWriterTag.A);
            writer.Write(item);
            writer.RenderEndTag();
            writer.RenderEndTag();
        }
        writer.RenderEndTag();
        writer.RenderEndTag();

    } 
```

我知道这是一个老问题，但谷歌将在未来几年继续指导人们。

# sql - 使用 SQL 2000 使用 from XML 子句创建 XML

> ID：695647
> 
> 赞同：0
> 
> 时间：2009-03-29T23:51:04.957
> 
> 标签：sql, xml

我正在从 SQL 查询创建 XML 文档，我想知道是否有办法通过 SQL 查询输出版本和编码标签？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-30T00:24:16.703

我认为您可以手动将此信息添加到查询结果中，因为它们不超过两个字符串。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-30T09:51:42.377

FOR XML 是 SQL Server 2005 中的新功能，对吧？所以你必须手动组装 XML：

```
select 
   '<?xml version="1.0" encoding="ISO-8859-1" ?>' + char(13) + char(10) +
   '<root>' + char(13) + char(10) +
   '    <value>' + yourtable.yourfield + '</value>' + char(13) + char(10) +
   '</root>' + char(13) + char(10)
from yourtable
where id = 1 
```

由您以您在 XML 标头中声明的编码传输它。

# c++ - Qt PDF教程？

> ID：695649
> 
> 赞同：5
> 
> 时间：2009-03-29T23:53:50.910
> 
> 标签：c++, qt

我在哪里可以找到 PDF 格式的 Qt 教程。我找遍了谷歌，但找不到一个。我需要能够离线阅读它，因为我不能总是在互联网上。谢谢！

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-03-29T23:59:23.923

据我所知，没有直接来自 trolltech 的 PDF，但所有文档都在

> Qt\200x.xx\qt\doc\html

其中 200x.xx 代表 Qt SDK 的版本。例如，我的是 2009.01。

您可以使用许多[HTML 到 PDF](http://www.google.ca/search?hl=en&q=html2pdf&btnG=Google+Search&meta=)转换器之一来实现您正在寻找的内容。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-04-03T08:06:18.317

如果您正在寻找教程或书籍，而不是 QT 文档，请查看此免费电子书：

[使用 Qt 4 进行 C++ GUI 编程](http://www.qtrac.eu/marksummerfield.html)

作者发布了具有开放许可证的第一版。如果您喜欢它，您仍然可以在亚马逊购买印刷的第二版。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-30T00:10:59.120

您实际上可以使用使用 QT 创建的 html 到 pdf 转换器... [http://code.google.com/p/wkhtmltopdf/](http://code.google.com/p/wkhtmltopdf/)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-01T12:53:11.367

我太晚了吗？您还可以使用下载整个网站的 html 蜘蛛。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-10-19T19:52:56.430

第二版也可免费获得（但仅限 HTML 格式）： [C++ GUI Programming with Qt 4, second edition](http://www.informit.com/store/product.aspx?isbn=0132354160)。单击示例内容选项卡以访问它们。章节都在那里（但顺序错误——但是，目录列在页面底部，因此您可以看到正确的顺序）。所有示例都可以从“下载”选项卡中获得。

还有一本更高级的书（但它不是免费的）：[Advanced Qt Programming](http://www.qtrac.eu/aqpbook.html)

# mysql - 你如何在mysql中按标题排序，忽略“the”这个词？

> ID：695664
> 
> 赞同：8
> 
> 时间：2009-03-30T00:02:21.823
> 
> 标签：mysql, regex

我有一个按字母分组的电影列表。自然，以字母“T”开头的电影有大约 80% 的电影以“The”开头。诸如“黑暗骑士”之类的电影应该出现在“D”列表中，最好也出现在“T”列表中。我有什么办法可以做到吗？

我在 WHERE 子句中使用以下代码来显示以某个字母开头的电影，忽略“the”，但这也有一个方便的副作用，就是让电影（如“黑暗骑士”）出现在字母“D”和“T”。

```
WHERE movie_title REGEXP CONCAT('^(the )?', '$letter') 
```

当我回显数据库中的所有电影时，我想实现这一点。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-03-30T00:05:43.987

如果您要经常执行此查询，您将需要在表中创建一个具有“排序”名称的单独字段。使用正则表达式或其他操作使 MySQL 无法利用索引。

因此，最简单、最有效的解决方案是让您添加一个`movie_title_short`字段，其中`movie_title`不包含“The”或“A”。一定要为该`movie_title_short`字段添加索引！

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-03-30T00:25:34.047

正如卡尔所说，我会将其构建到它自己的可索引字段中，以避免每次都计算它。我建议以稍微不同的方式来避免冗余。

```
movies (id, name, namePrefix) 
```

例如：

```
| Dark Knight        | The |
| Affair To Remember | An  |
| Beautiful Mind     | A   | 
```

这样，您可以以两种不同的方式显示这些电影：`"name, namePrefix"`或`"namePrefix name"`并且可以相应地进行排序。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-30T00:12:24.593

```
select right(movie_title, char_length(movie_title)-4) as movie_title
from movies 
where left(movie_title,3) = 'the'
union
select movie_title
from movies 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-30T00:14:38.723

您可以在 select 子句中使用 mysql 替换功能...

```
 select replace(movie_title,'The ','') from ... order by replace(movie_title,'The ','')' 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-09-03T15:12:34.650

我自己也遇到了这个问题......解决方案是：

```
SELECT * FROM movies WHERE title REGEXP '^d' AND title NOT REGEXP '^the ' OR title REGEXP '^the d' 
```

这只会给你以“D”或“D”开头的结果

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-21T21:45:10.147

用这个：

```
SELECT * FROM movies ORDER BY TRIM(LEADING 'the ' FROM LOWER(`movie_title`)); 
```

# c# - 执行 IQueryable 查询的一部分并将其余部分推迟到 Linq for Objects

> ID：695678
> 
> 赞同：8
> 
> 时间：2009-03-30T00:15:33.993
> 
> 标签：c#, linq, expression-trees, iqueryable

我有一个 Linq 提供程序，它成功地从我选择的数据源中获取数据，但是现在我有了过滤的结果集，我想做的是允许 Linq to Objects 处理表达式树的其余部分（对于诸如联接之类的事情，投影等）

我的想法是，我可以通过 ExpressionVisitor 将包含 IQueryProvider 的表达式常量替换为结果集 IEnumerable，然后返回该新表达式。还从我的 IQueryable 返回 IEnumerable 的提供程序...但这似乎不起作用:-(

有任何想法吗？

编辑：这里有一些很好的答案，但给出的形式......

```
var qry = from c in MyProv.Table<Customer>()
          Join o in MyProv.Table<Order>() on c.OrderID equals o.ID
          select new 
          {
            CustID = c.ID,
            OrderID = o.ID
          } 
```

在我的提供者中，我可以轻松地从客户和订单中取回 2 个结果集，如果数据来自 SQL 源，我只需构造并传递 SQL Join 语法，但在这种情况下，数据不是来自 SQL 源，所以我需要在代码中进行连接...但正如我所说我有 2 个结果集，并且 Linq to Objects 可以进行连接...（以及后来的投影）只需替换表达式常量`MyProv.Table<Customer>`和`MyProv.Table<Order>`使用`List<Customer>`and`List<Order>`并让`List<>`提供者处理表达式……这可能吗？如何？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-30T04:40:47.973

前面的两个答案都有效，但如果您使用 AsEnumerable() 将 IQueryable 转换为 IEnumerable，则效果会更好：

```
// Using Bob's code...
var result = datacontext.Table
   .Where(x => x.Prop == val)
   .OrderBy(x => x.Prop2)
   .AsEnumerable()  //  <---- anything after this is done by LINQ to Objects
   .Select(x => new { CoolProperty = x.Prop, OtherProperty = x.Prop2 }); 
```

编辑：

```
// ... or MichaelGG's
var res = dc.Foos
           .Where(x => x.Bla > 0)  // uses IQueryable provider
           .AsEnumerable()
           .Where(y => y.Snag > 0); // IEnumerable, uses LINQ to Objects 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-28T22:53:44.673

我所追求的事情是用具体的 IEnumerable（或通过 .AsQueryable() 的 IQueryable）结果集替换表达式树中的 Queryable<> 常量......这是一个复杂的主题，可能只对 Linq 有意义在表达树访问者等方面深入研究的提供者作家。

我在 msdn 演练中找到了一个片段，它的功能类似于我所追求的，这给了我前进的方向......

```
using System;
using System.Linq;
using System.Linq.Expressions;

namespace LinqToTerraServerProvider
{
    internal class ExpressionTreeModifier : ExpressionVisitor
    {
        private IQueryable<Place> queryablePlaces;

        internal ExpressionTreeModifier(IQueryable<Place> places)
        {
            this.queryablePlaces = places;
        }

        internal Expression CopyAndModify(Expression expression)
        {
            return this.Visit(expression);
        }

        protected override Expression VisitConstant(ConstantExpression c)
        {
            // Replace the constant QueryableTerraServerData arg with the queryable Place collection.
            if (c.Type == typeof(QueryableTerraServerData<Place>))
                return Expression.Constant(this.queryablePlaces);
            else
                return c;
        }
    }
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2010-07-01T20:18:34.143

如果您实现了存储库模式，则只需提供 IQueryable 并抽象出表即可。

例子：

```
var qry = from c in MyProv.Repository<Customer>()
          Join o in MyProv.Repository<Order>() on c.OrderID equals o.ID
          select new 
          {
            CustID = c.ID,
            OrderID = o.ID
          } 
```

然后只需构建您的提供程序以在您的 Repository 方法中对 IQueryable 模式进行建模，就像[本文](http://iridescence.no/post/Linq-to-Sql-Programming-Against-an-Interface-and-the-Repository-Pattern.aspx)说明的那样。

这样，您可以编写各种提供程序以用于您需要的任何内容。您可以拥有一个 LINQ 2 SQL 提供程序，或者为您的单元测试编写一个内存提供程序。

LINQ 2 SQL 提供程序的 Repository 方法如下所示：

```
public IQueryable<T> Repository<T>() where T : class
{
    ITable table = _context.GetTable(typeof(T));
    return table.Cast<T>();
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-30T01:15:15.613

除非我有误解，否则我通常只是在 linq 方法链中添加 .ToArray() ，在我希望 linq 提供程序执行的地方。

例如（想想 Linq to SQL）

```
var result = datacontext.Table
   .Where(x => x.Prop == val)
   .OrderBy(x => x.Prop2)
   .ToArray()
   .Select(x => new {CoolProperty = x.Prop, OtherProperty = x.Prop2}); 
```

所以通过 OrderBy() 被翻译成 SQL，但 Select() 是 LINQ to Objects。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-30T03:06:37.980

Rob 的回答很好，但强制全面列举。您可以强制转换以保持扩展方法语法和惰性评估：

```
var res = ((IEnumerable<Foo>)dc.Foos
            .Where(x => x.Bla > 0))  // IQueryable
          .Where(y => y.Snag > 0)   // IEnumerable 
```

# python - 如何区分函数和类方法？

> ID：695679
> 
> 赞同：6
> 
> 时间：2009-03-30T00:16:10.183
> 
> 标签：python, reflection, metaprogramming

如果变量引用函数或类方法，我如何找出它是哪一个并获取类类型，以防它是类方法，特别是当类仍如给定示例中那样声明时。

例如。

```
def get_info(function_or_method):
    print function_or_method

class Foo(object):
    def __init__(self):
        pass

    get_info(__init__)

def bar():
    pass

get_info(bar) 
```

**在大卫和 JF 塞巴斯蒂安的前两个回复之后更新问题** 为了再次强调 JF 塞巴斯蒂安提到的一点，我希望能够在类中声明函数时区分它（当我得到的类型是函数时）而不是绑定或未绑定的方法）。IE。第一次调用`get_info(__init__)`发生的地方我希望能够检测到它的方法被声明为类的一部分。

出现了这个问题，因为我在它周围放置了一个装饰器，它获得了**init**函数的句柄，我实际上无法确定一个方法是在类中声明还是作为独立函数声明

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-03-30T00:29:51.447

您可以通过检查类型来区分两者：

```
>>> type(bar)
<type 'function'>
>>> type(Foo.__init__)
<type 'instancemethod'> 
```

或者

```
>>> import types
>>> isinstance(bar, types.FunctionType)
True
>>> isinstance(bar, types.UnboundMethodType)
True 
```

这就是你在`if`声明中这样做的方式。

此外，您可以从`im_class`方法的属性中获取类：

```
>>> Foo.__init__.im_class
__main__.Foo 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-03-30T00:42:17.203

在您调用`get_info(__init__)`（在类定义中）时，这`__init__`是一个普通函数。

```
def get_info(function_or_method):
    print function_or_method

class Foo(object):
    def __init__(self):
        pass
    get_info(__init__)   # function

def bar():
    pass

get_info(Foo.__init__)   # unbound method
get_info(Foo().__init__) # bound method
get_info(bar)            # function 
```

输出（CPython，IronPython）：

```
<function __init__ at ...>
<unbound method Foo.__init__>
<bound method Foo.__init__ of <__main__.Foo object at ...>>
<function bar at ...> 
```

输出（Jython）：

```
<function __init__ 1>
<unbound method Foo.__init__>
<method Foo.__init__ of Foo instance 2>
<function bar 3> 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-03-30T07:20:29.383

> 为了再次强调 JF Sebastian 提到的一点，我希望能够在类中声明函数时区分它（当我得到的类型是函数而不是绑定或未绑定方法时）。IE。第一次调用`get_info(__init__)`发生的地方我希望能够检测到它的方法被声明为类的一部分。
> 
> 出现了这个问题，因为我在它周围放置了一个装饰器，它获得了 init 函数的句柄，我实际上无法确定一个方法是在类中声明还是作为独立函数声明

你不能。JF Sebastian 的回答仍然 100% 适用。当类定义的主体被执行时，类本身还不存在。语句（`__init__`函数定义和`get_info(__init__)`调用）发生在新的本地命名空间中；在调用`get_info`发生时，`__init__`是对该命名空间中函数的引用，这与在类外部定义的函数没有区别。

# testing - 将系统测试用例包含在应用程序的最终打包产品中是否会导致膨胀或增加风险？

> ID：695682
> 
> 赞同：1
> 
> 时间：2009-03-30T00:18:12.053
> 
> 标签：testing, packaging, rpm

我正在打包一个 rpm 文件，该文件有一个 %postinstall 部分，用于检测某些条件并运行一套单元、功能和系统测试。当我使用代码本身用于诊断的一些相同环境变量时，我得到了一些回击，它暴露了一些内部结构。想法？

更新：我不打算自动运行测试，也不打算将它们的存在暴露给最终用户。我建议该测试包仅适用于该套件所在的任何机器。它使包的最终大小增加了大约 3%，并且需要大量的内部知识才能正确执行。

程序本身是一个库，其他人可以使用并在 API 中公开。事物如何运作的内部知识不是问题。我的主要动机是缺乏合适的测试资源和目标环境的巨大可变性。一些测试非常简单（类似于 configure 可能会确定编译器提供的所有正确功能）。其他测试涉及更多，它们证明了库应该提供的基本功能。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-30T00:51:11.550

如果你想避免每次安装都会运行的抱怨，至少使用 RPM 的[%check](http://fedoraproject.org/wiki/How_to_create_an_RPM_package#.25check_section)规则。

听起来人们关心“逆向工程”。那么软件是专有的吗？这似乎是您问题的症结所在。无论如何，测试套件与打包软件分开是很常见的。

但是，您并非不切实际：允许用户自己在他们的系统上运行测试并为您提供结果是与用户建立协作关系的一个重要方面。不幸的是，您遇到了专有商业模式。

也许您可以通过缩减或重写测试和诊断来妥协，以仅证明足够的健康度而不会透露太多。我不会放弃你迄今为止所写的测试和诊断。

您确实应该提出这样的论点，即用户会对带有完整测试系统的软件包感到高兴并更有信心，并且这些都超过了泄露软件内部结构的任何恐惧。

# visual-studio - 无法使用 VS2008 winforms 设计器将控件分配给自定义 winforms 面板

> ID：695688
> 
> 赞同：1
> 
> 时间：2009-03-30T00:22:34.570
> 
> 标签：visual-studio, winforms, visual-studio-2008, designer

我继承了带有人员表单（带有地址、电话等）的原型公司应用程序。

现在在提到的那个人表单上，一个标签+文本字段是表单本身的子项，而不是它在视觉上所属的面板的子项。

如何在 VS 2008 设计器中将控件的父级从窗体更改为现有面板？

**更新：**

啊，看来是我心爱的牛人为了我高兴而留下的超神奇自定义组框控件有问题。拖入一个普通的组框可以工作......

**更新 2：**

在文档大纲的帮助下，我可以看到我们在应用程序中的自定义“GroupBoxExt”是有缺陷的，将控件拖到面板上（或只是更改面板上控件的位置）将其分配给表单。

**更新 3：**

现在我发现了错误（感谢文档大纲提示），我去谷歌搜索并在[CodeGuru](http://www.codeguru.com/csharp/csharp/cs_controls/custom/article.php/c11389/)上找到了一个自定义组框。那篇文章的作者发现你需要用

```
[Designer("System.Windows.Forms.Design.ParentControlDesigner, System.Design", typeof(IDesigner))] 
```

使其表现得像一个漂亮的容器。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-30T00:37:38.447

如果您希望在设计器中执行此操作，您正在寻找的是“文档大纲”面板（它位于“其他窗口”下的“视图”菜单下）。从那里您可以在大纲中按名称拖动控件并重新分配父控件。

希望这可以帮助！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-30T00:34:00.687

我不确定你问的是什么。你能试着澄清一下这个场景吗？

但是，如果您想更改控件的父级，您需要做的就是使用 Controls 属性使该控件成为面板的子级。

```
myPanel.Controls.Add(target) 
```

这应该将目标的父级更新为 myPanel。

如果您尝试通过设计器执行此操作，您需要做的就是将目标控件拖到面板上，这应该会处理好它。

# vb.net - 使用 VB.Net 将图标复制到启动文件夹

> ID：695689
> 
> 赞同：0
> 
> 时间：2009-03-30T00:23:53.037
> 
> 标签：vb.net, icons, copy, startup, startup-folder

我想将一个图标从 vb.net 代码复制到计算机的启动文件夹中。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-30T00:29:52.163

您可以使用 Environment.GetSpecialFolder 函数找到启动文件夹，然后使用 File.Copy 复制文件。

```
Public Sub CopyIconFromStartup(iconName as String, target As String) 
  Dim path as String = Environment.GetSpecialFolder(SpecialFolder.Startup)
  path = IO.Path.Combine(path, iconName)
  File.Copy(path, target)
End Sub 
```

# wcf - 如何构建一个暴露业务层的 WCF 服务？

> ID：695692
> 
> 赞同：4
> 
> 时间：2009-03-30T00:29:09.390
> 
> 标签：wcf

WCF 通过使用接口和契约等来促进良好的设计。让我感到困惑的是，例如在我的情况下，如果我有 2 组业务功能，如 ICustomerMgmtBIZ 和 IProductMgmtBiz。如果这两个是ServiceContracts，我有一个像

IBusinessService:IProductMgmtBIZ,ICustomerMgmtBIZ

和实现类BusinessService。我看到 BusinessService 类将有太多的实现。到目前为止，我一直在使用的解决方法是实现部分类。

坦率地说，一个 WCF 服务可以只有 1 个实现和 1 个服务合同吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-30T02:29:12.080

不，可以在 WCF 服务类型（具有 ServiceBehavior 属性的类）上实现多个服务协定，因为这只是让类实现多个接口的问题。如果您使用任何 Visual Studio 模板或其他类型的代码生成器，这可能不会立即清楚。然而，虽然你可以在一个 Service 类型上实现多个 Service Contract 接口，但是如果你需要这个服务，在这种情况下可能是一个单例（？），它对你没有多大好处，就像一个服务一样。IBusinessService 意味着您需要从一个客户端代理调用所有服务的功能，以便所有操作都可以在同一个逻辑会话中运行（类似于 ASPX Web 会话）。如果不是这样，

您的实现只能在 WCF ServiceHost 实例上具有绝对要求吗？哪些因素会影响您的决定？

顺便说一句，部分课程不再困扰我。将代码拆分为多个文件的想法现在看起来很自然。例如，除了将核心逻辑存储在 ServiceType.cs 中之外，将部分类存储在 ServiceType_IProductMgmtBiz.cs 和 ServiceType_ICustomerMgmtBIZ.cs 之类的文件中似乎很自然。

最后，以下问题可能有用... [WCF 和接口继承 - 这是一件可怕的事情吗？](https://stackoverflow.com/questions/470726/wcf-and-interface-inheritance-is-this-a-terrible-thing-to-do/474439)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-30T01:52:16.007

坦率地说，不 - 有点 - 是的，但是。任何解决方法都不是最佳的，并且涉及使用“IBlank”作为主 WCF 接口（您的接口从 IBlank 派生）和两个端点，一个实现 IProductMgmtBIZ，另一个实现 ICustomerMgmtBIZ。我面前没有我的开发机器，这可能涉及其他一些覆盖。因此，在 WCF 级别上，除非您想拥有两个 WCF ServiceHost（这是完全合理的），否则您会被搞砸。

简而言之，解决方法是不优雅的。在具有不同扩展名的同一端口上拥有两个 WCF 端点更容易。

# c# - 对可能无限列表的 LINQ 查询

> ID：695702
> 
> 赞同：6
> 
> 时间：2009-03-30T00:37:40.023
> 
> 标签：c#, linq, ienumerable

我目前正在做一些 Project Euler 问题，早期的问题通常涉及斐波那契数或素数等问题。对它们进行迭代似乎很适合 LINQ，至少在代码的可读性和感知“优雅”方面（我试图在可能和适用的情况下使用特定于语言的特性来感受这些语言）。

我现在的问题是，如果我只需要一组达到一定限制的数字，我应该如何最好地表达这一点？目前我已经在迭代器中对各自的限制进行了硬编码，但我真的希望枚举器返回列表，直到外部的东西决定不再查询它，因为它超过了一定的限制。所以基本上我有一个潜在的无限迭代器，但我只从中获取一组有限的数字。我知道这样的事情在函数式语言中是微不足道的，但我想知道 C# 是否也允许这样做。我唯一的另一个想法是有一个迭代器 Primes(long) ，它返回素数达到一定限制，对于其他序列也是如此。

有任何想法吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-03-30T00:45:59.007

大多数 LINQ 方法（可枚举类）都是惰性的。因此，例如，没有任何问题：

```
var squares = Enumerable.Range(0, Int32.MaxValue).Select(x=>x*x); 
```

您可以使用 Take 方法来限制结果：

```
var 10squares = squares.Take(10);

var smallSquares = squares.TakeWhile(x => x < 10000); 
```

**编辑：**您需要避免的事情是“延迟”返回但必须消耗整个可枚举来产生结果的函数。例如，分组或排序：

```
var oddsAndEvens = Enumerable.Range(0, Int32.MaxValue)
                             .GroupBy(x => x % 2 == 0);
foreach (var item in oddsAndEvens) {
  Console.WriteLine(item.Key);
} 
```

（这可能会给你一个 32 位的 OutOfMemoryExeption。）

# python - 谷歌数据 API 身份验证

> ID：695703
> 
> 赞同：6
> 
> 时间：2009-03-30T00:38:25.217
> 
> 标签：python, django, google-api, gdata, gdata-api

我正在尝试让我的 Django 应用程序（不使用 Google 应用程序引擎）使用 Google 联系人数据 API 从 Google 联系人中检索数据。浏览[身份验证文档](http://code.google.com/apis/accounts/docs/AuthSub.html)以及[Data API Python 客户端文档](http://code.google.com/apis/contacts/docs/1.0/developers_guide_python.html)

获取一次性令牌的第一步（AuthSubRequest）工作正常。下一步（AuthSubSessionToken），将一次性令牌升级为会话令牌。python API 调用 UpgradeToSessionToken() 根本不适合我，它给了我 NonAuthSubToken 异常：

```
gd_client = gdata.contacts.service.ContactsService()
gd_client.auth_token = authsub_token
gd_client.UpgradeToSessionToken() 
```

作为替代方案，我想通过“手动”构建 HTTP 请求来使其工作：

```
url = 'https://www.google.com/accounts/AuthSubSessionToken'
headers = {
               'Content-Type': 'application/x-www-form-urlencoded',
               'Authorization': 'AuthSub token=' + authsub_token,
               'User-Agent': 'Python/2.6.1',
               'Host': 'https://www.google.com', 
               'Accept': 'text/html, image/gif, image/jpeg, *; q=.2, */*; q=.2',
               'Connection': 'keep-alive',
           }
req = urllib2.Request(url, None, headers)
response = urllib2.urlopen(req) 
```

这给了我一个不同的错误：

HTTP 错误 302：HTTP 服务器返回将导致无限循环的重定向错误。最后 30x 错误消息是：已临时移动

我在这里做错了什么？对于我尝试使用的任何一种方法，我将不胜感激帮助/建议/建议：Python API 调用 (UpgradeToSessionToken) 或使用 urllib2 手动构造 HTTP 请求。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-02T14:43:43.320

根据[此处](http://code.google.com/apis/contacts/docs/2.0/developers_guide_protocol.html#auth_sub)的 2.0 文档，有一个 python 示例集...

> 运行示例代码
> 
> 包含本文档中显示的所有示例代码的完整工作示例客户端可在 Python 客户端库分发中的目录下找到`samples/contacts/contacts_example.py`。
> 
> 示例客户端对联系人执行多项操作以演示联系人数据 API 的使用。

希望它会为您指明正确的方向。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-04T15:26:00.107

我最近有一个类似的问题。通过将“安全”设置为“真”来修复我的问题。

```
 next = 'http://www.coolcalendarsite.com/welcome.pyc'
  scope = 'http://www.google.com/calendar/feeds/'
  secure = True
  session = True
  calendar_service = gdata.calendar.service.CalendarService() 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-04T15:39:21.573

有四种不同的身份验证方式。使用 AuthSub 对您来说真的那么重要吗？如果您无法让 AuthSub 工作，请考虑使用[ClientLogin](http://code.google.com/apis/gdata/auth.html#ClientLogin)方法。我可以毫不费力地让它发挥作用。

# php - 使用 Ajax/PHP 刷新

> ID：695707
> 
> 赞同：1
> 
> 时间：2009-03-30T00:45:45.497
> 
> 标签：php, ajax

除了我昨天的问题（[在这里](https://stackoverflow.com/questions/693905/live-orders-view-on-website-advice-needed)），我正在开发一个网页，其中有一个显示“实时”订单详细信息的部分。

我网页的上半部分有 Spry 选项卡式面板。其中一个面板包含对我创建的单独 php 页面 (getOpenOrders.php) 的包含调用。这包含一个 SQL 查询，用于获取所有未结订单，然后将详细信息放入表中。

因此，未结订单表显示在 Spry 面板中。我现在需要采取哪些步骤才能每 15 秒刷新一次？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-30T00:48:44.413

您真的想为每个用户每 15 秒调用一次数据库吗？这不是超载吗？

我不是说你的数据库会超载，但是，你**不应该这样**做！

**已编辑**

您应该显示图像或指向该页面的链接，以便获得适当的答案，因为这完全取决于您在表格中所做的事情。

因为我不知道，所以我会给你一个关于可能发生的事情的答案。

因为您说您是 ajax 世界的新手，所以让我们让事情变得简单，不要让事情变得复杂，您应该返回一个 JSON 对象并使用它来重新填充您的表。:)

因此，我们将从 2 个按钮（上一个和下一个）开始，以便用户可以移动正在显示的数据（您可能不想让他/她看到 100 行对吗？）

* * *

假设您有 2 个页面，一个**showData.php**和**getTable.php**，在 showData.php 中您需要加载 jQuery（这很棒）并添加一些代码，但是要放置表格的位置，只需添加一个带有 id="myTable" 的 div 标签，因为我们将从 getTable.php 文件中获取数据。

getTable.php 文件必须只输出包含所有数据的表格 html 代码，没有 html、body 等...想法是在名为 myTable 的 div 中添加 getTable.php 生成的所有代码

假设 getTable.php 在 queryString 中获取了一个页面变量，它将告诉您应该显示哪个页面（用于`LIMIT`MySQL 或 PostgreSQL 数据库）

* * *

您可以使用名为[datatables](http://www.datatables.net/)的 jQuery 插件，这是我的选择之一，[查看他的示例](http://www.datatables.net/examples/example_zero_config.html)以及您需要编写多小的代码！只使用 jQuery 和 Datatables 插件。

第一个描述在 jQuery.Load() 之后加载 getTable.php 并添加为 div 的子项，并为上一个和下一个按钮执行此操作，将查询字符串与用户请求的页面一起传递。这很简单，您可以查看该网站，如果您更喜欢使用 DataTables 插件，那么只需按照他们的示例进行操作 :)

如果您毕竟需要帮助，请给我留言。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-30T00:53:37.753

```
<META HTTP-EQUIV=Refresh CONTENT="15; URL=<?php print $PHP_SELF ?>"> 
```

这应该在头部标签之间。

-或者-

```
header('Refresh: 15'); 
```

这应该**在**head 标签之前和 html 标签之后。

正如 balexandre 所说，应该使用不同的方法。对于连接到该站点的每个用户，不需要每 15 秒访问一次数据库。但是，无论如何都有你的答案。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-30T19:32:27.160

尽管 balexandre 提出了一个很好的观点，但如果您确实决定需要刷新，您可以在 JavaScript 中简单地执行以下操作：

```
window.onload = function( )
{
     setTimeout( 'window.location.refresh( )', 1500 );
} 
```

（我没有测试过上面的代码，所以语法可能需要稍微调整一下，但你明白了）

# language-agnostic - 网络服务器是否可以确定它是否是 HA 故障转移系统的活动节点，而无需在服务器本身上进行硬编码？

> ID：695715
> 
> 赞同：3
> 
> 时间：2009-03-30T00:50:51.163
> 
> 标签：language-agnostic, monitoring

我可以想到一些使用 ping、盒子名称和 HA 共享名称的 hack，但我认为它们会导致数据泄漏。

一个盒子是否应该知道它是 HA 集群的一部分，或者该集群的名称是什么？这更像是DNS的功能吗？是否有一些 API 暴露给盒子以加入 HA 集群并请求当前活动节点的 id？

我想在正在运行的程序的警报机制中区分非活动节点和活动节点。如果活动节点发出警报，我想打一个寻呼机，而在非活动节点上我想发送一封电子邮件。将决定推入警报层会将相同的问题转移到其他地方。

**简单的解决方案：** 从通过网络连接的外部代理轮询服务器使得任何关于谁是活动节点的空壳游戏成为一个有争议的问题。为了澄清这一点，唯一需要关注的是远程代理监控真实情况。每个盒子都可以整天发送电子邮件，我所关心的。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-07T20:39:36.427

这实际上取决于您使用的 HA 系统。

例如，如果您的系统使用共享 IP 并且流量由某个硬件设备管理，那么很难确定某个设备是主设备还是从设备。这实际上取决于特定的解决方案......只要您可以向主管添加自定义脚本，您应该没问题 - 例如控制器可以每秒 ping 主服务器上的守护程序。在警报脚本中，只需检查最后一次 ping 的时间是否 < 2 秒...

如果您的系统没有主管/控制器节点，但每个节点都试图确定自己的状态，那么您可能会遇到更多问题。如果发生脑裂，您可能会同时拥有两个奴隶或两个主人，因此您的警报软件在这两种情况下都是错误的。可以确保只有一个活动节点（STONITH 和其他节点）的小工具可以提供帮助。

另一方面，在第二种情况下，如果HA软件在两台主机上都正常工作，您应该可以直接从中获取主/从信息。它必须随时知道自己的状态，因为这是它的主要功能之一。在大多数 HA 解决方案中，您应该能够获取当前状态，或者添加一些代码以在状态更改时运行。Heartbeat 两者都提供。

不过，我不会担心像裂脑这样的边缘情况。当集群节点之间失去连接时，几乎任何情况都比单独节点上发生的事情更重要:)

如果您真正关心的只是日志记录/警报，那么理想情况下，您可以拥有一个单独的记录器框，它可以获取有关当前网络/集群状态的所有信息。外部盒子可能会更好地了解如何处理这种情况。如果您的集群被拒绝/从网络断开/断电，您将不会收到任何警报。一对冗余的独立显示器可以让您摆脱这种情况。

我不确定您为什么提到 DNS - 由于它的刷新时间，它不应该是任何“实时”集群信息的来源。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-30T01:06:15.883

一种方法是让盒子将其关于它是否处于活动状态的想法导出到您的监控中。从那里，您可以根据此状态预测寻呼/电子邮件（在故障转移周围出现竞争条件），并在没有/太多系统认为它们处于活动状态时发出警报。

另一种选择是通过 DNS 别名（或其他一些寻址活动系统的方法）监控活动系统并在其上进行寻呼。然后还监控所有系统，包括活动的和非活动的，并通过电子邮件发送。这将导致活动系统出现重复警报，但这可能没问题。

如果不了解您的设置，很难更具体。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-03T22:35:40.723

通常，HA 集群中的机器不应该真正知道哪个是活动的。请注意，有一个例外，那就是 cronjobs。在工作中，我们有一个 HA 集群，上面运行着一些相当重要的服务。其中一些使用服务有 cronjobs，我们只希望它们在活动机器上运行。为此，我们使用这个 shell 脚本：

```
#!/bin/sh
HA_CLUSTER_IP=0.0.0.0
if ip addr | grep $HA_CLUSTER_IP >/dev/null; then
    eval "$@"
fi 
```

（请注意，这是在 Debian 上运行的。）它的作用是检查当前框是否是集群中的活动框（将 0.0.0.0 替换为 HA 集群的外部 IP），如果是，则执行命令作为脚本的参数传入。这确保只有一个盒子在实际执行 cronjobs。

除此之外，我真的没有理由想到为什么你需要知道哪个盒子是活动的。

**更新：**我们的 HA 集群使用[Heartbeat](http://www.linux-ha.org/HeartbeatProgram)将集群的外部 IP 地址作为辅助地址分配给集群中的活动机器。以编程方式，您可以通过调用来检查您的机器是否是当前活动框`gethostbyname()`，并遍历返回的数据，直到您到达末尾或在列表中找到集群的 IP。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-14T23:50:18.633

没有硬编码……？我假设您的意思是一些本机心跳查询，不确定。但是，您可以使用 ifconfig，HA 在配置为运行的任何接口上创建一个虚拟接口。例如，如果在 eth0 上配置了 HA，那么它将创建一个 eth0:0 的虚拟接口，但仅在活动节点上。

因此，您可以对 ifconfig 输出进行简单查询，以确定服务器是否是活动节点，例如 eth0 是否是配置的接口：

```
ACTIVE_NODE=`ifconfig | grep -c 'eth0:0'` 
```

这会将 $ACTIVE_NODE 变量设置为 1（对于活动）和 0（如果是待机）。希望这可能会有所帮助。

[http://www.of-networks.co.uk](http://www.of-networks.co.uk)

# perl - Perl 有哪些好的交互式 GUI 构建器包？

> ID：695722
> 
> 赞同：10
> 
> 时间：2009-03-30T00:53:40.127
> 
> 标签：perl, user-interface

我想用 Perl 编写一些交互式 GUI。我用过 TclTk，但它看起来过时了。我已经为 C++ 编写了 QT 代码，但是 PerlTk 模块已经好几年没有发布了。谷歌搜索我看到了其他可能的选择。

对此有什么好的包，包括基本的窗口、菜单、画布、滚动条等等。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-03-30T03:04:30.560

[Gtk2](http://developer.gnome.org/)有[glade2](http://glade.gnome.org/)可以写出[Gtk2::GladeXML](http://search.cpan.org/dist/Gtk2-GladeXML/GladeXML.pm)可用的 XML 文件。这是一个[如何将 XML 与应用程序捆绑](http://markmail.org/message/7zs6qtmv6u2mpa3g)在同一个文件中的示例。

一开始我误读了这个问题。我以为你想要一个用于制作 GUI 的 GUI 编辑器（这就是 glade2）。您还可以使用 Gtk2 而不使用 glade2 创建 GUI：

```
#!/usr/bin/perl

use strict;
use warnings;
use Gtk2;

Gtk2->init;

my $window = Gtk2::Window->new;
my $vbox   = Gtk2::VBox->new;
my $label  = Gtk2::Label->new("Hello World");
my $button = Gtk2::Button->new("Press me");

$window->add($vbox);
$vbox->add($label);
$vbox->add($button);

$window->set_default_size(200, 200);
$window->signal_connect(
    destroy => sub {
        Gtk2->main_quit;
    }
);

my $i = 0;
$button->signal_connect(
    clicked => sub {
        $label->set_text("button pressed " . ++$i . " times");
    }
);

$window->show_all;

Gtk2->main; 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-03-30T01:07:17.160

试试[wxPerl](http://wxperl.sourceforge.net/)！

从网站：

> wxPerl 是一个扩展模块，允许从 Perl 创建 GUI（图形用户界面）；它是作为令人敬畏的 wxWidgets C++ GUI 工具包的包装器而构建的。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-03-30T04:32:09.790

与 Chas Owens 相呼应，glade 在 Perl 中非常适用于 Gtk2。此外，Gtk2 还支持 GtkBuilder 文件（您也可以创建最新的 glade）。

wxPerl（以及 wxWidgets 本身）的主要问题是它不允许您将文件事件观察器安装到其主循环中（它只有 GUI、Socket 和 Timer 事件），这与 Tk 和 Gtk 不同。

Qt、Tk 和 Gtk2 事件循环可以在 Perl 中与 AnyEvent 一起使用，而 Gtk2 可以通过 Glib::Event 和 Glib::EV 模块连接到运行 Event 或 Ev 主循环的应用程序中。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-03-30T06:24:49.597

WxPerl 的 GUI 构建器是[wxGlade](http://wxglade.sourceforge.net/)或[wxFormBuilder](http://wxformbuilder.org/)，两者都是开源的。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-03-30T09:08:23.713

我可能会使用 Gtk2，但 Tk 绝对没有死。缺乏发布是由于多年来一直在解决的错误。很多人仍在使用它，并且通常可以正常工作。（Tk 的事件循环有点傻，但这是一个你可能不应该关心的细节。）唯一的缺点是你的 GUI 看起来像是 1996 年的，但谁在乎呢？

（`gitk`git 附带的工具表明，只要 Tk GUI 有用，它们看起来就很好。）

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2012-09-07T19:41:37.110

最近，我了解到另一个名为[Prima](https://metacpan.org/module/Prima)的 Perl GUI 工具包。它的名声在于它是用 C 语言编写的，特别是为 Perl 编写的，而不是来自 TCL 的端口或与其他东西的绑定。假设您的系统上有一些相当标准的库，它将直接从 CPAN 及其跨平台安装！

David Mertens 一直在使用它为[PDL编写一个新的](http://pdl.perl.org)[绘图库](http://p3rl.org/PDL%3a%3aGraphics%3a%3aPrima)，还有一个[REPL](http://p3rl.org/App%3a%3aPrima%3a%3aREPL)！

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2012-09-07T16:54:54.530

关于小部件的质量，所有三个 gtk2、wx 和 qt4 都同样好——gtk2 最快，qt4 具有最佳分辨率，而 wx 就两个参数而言介于两者之间。

但是 tk 在速度和分辨率方面都落后于这三者，但首先因为它是所有基于 unix 的解释语言的原始小部件，其次因为它是 freebsd 的原生小部件。

与今天的 perl 一样，perl-gtk2 的文档比 perl-qt4 稍微发达一些，而 perl-qt4 又比 wxperl 更发达。事实上，如果你浏览网页，你会发现 perl-gtk2 的教程甚至比 pygtk（也非常成熟）和 ruby​​-gtk2 更广泛。对于 python，wxpython 文档领先于 PyQt 和 pygtk，而对于 ruby​​，ruby-qt4 领先于 ruby​​-gtk2 和 wxruby。然而，其他的开发速度非常快（例如 ruby​​-gtk2），一段时间后所有九个将在所有方面都相同。

perl-qt4 的具体问题是：在非 kde 桌面的情况下，perl-qt4 可能无法运行。我尝试在 ubuntu 和 sabayon 中运行所有程序，发现 perl-gtk2 甚至 wxperl（以及 wxruby 也）运行良好，而我什至无法在 gnome-desktop 中运行单个 perl-qt4 程序，我已经安装了完整的 qt4 支持没有kde。

perl-qt4 不仅要求安装 qt4 库，还要求安装 kde-desktop 库。这个问题是 perl-qt4 特有的，在 PyQt 和 ruby​​qt4 的情况下不存在，因为它们都在 gnome 下使用 qt4 运行时运行良好。

因此，通过这种方式，九个选项中有八个（加上三个 tk）表现良好（我还没有测试 PySide）。

在 perl-tk 的情况下，widget 得到了很好的开发和建立，与 tkinter、pmw 和 ruby​​tk 不同，它的文档是上述所有这些中最好的。

但也许过了一段时间，所有的文档都已经开发出来了，任何文档都会变得同样好。

在考虑了速度、清晰度和跨平台之间的平衡后，选择 perl-gtk2、perl-qt4 或 wxperl。

perl-tk、perl-gtk2 和 perl-qt4 语法与 perl 编程语言语法很好地配合，而 wxperl 语法看起来更像是正确的 c++ 混合到 perl 中，这与各自的语言语法不同（就像 wxpython 和 wxruby 的情况一样） .

但是，如果您已经记住 wx 代码是独一无二的，那么您可以直接从 wxperl 开始。

否则，最好的出路是：从 perl-tk 开始，然后切换到 perl-gtk2，然后切换到 perl-qt4 或 wxperl 类似，但确保您学习所有四个而不是只学习一个（相同的顺序也应该适用于 python 和 ruby尽管文档支持是反向的，但在 perl 的情况下，即使在这方面也是相同的）。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-03-30T11:52:55.860

我没有真正的答案给你，但通常你必须考虑你的部署目标。一些 GUI 库非常好，但前提是您可以让它们在您的操作系统上工作。我不一定认为所有框架都需要跨平台兼容，这是一个在完美世界中努力实现的非常值得称赞的目标，只要您选择的框架不会因为基础而锁定您的大部分用户GUI 库很难在特定平台上安装或支持。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-05-09T05:17:46.840

我只是想让每个人都知道 PerlQt 很棒，而且这个网站有很多关于如何使用它的教程和很多可供下载的示例。

[PerlQt 维基教程](http://perlqt.wikidot.com)

PerlQt 是一种使用 Qt 拖放表单设计器和 Perl 创建漂亮的 GUI 程序的非常快速和简单的方法。PerlQt 对于高级开发人员来说足够强大，对于初学者来说也很容易。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-04-03T03:20:26.037

我要使用的解决方案是 Gtk-Perl。一开始我很难安装它，但最后我在一个包中找到[了 Camelbox](http://code.google.com/p/camelbox/) Perl+Gtk2。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2011-01-20T15:58:52.370

我用过`Tk`，但在过去的几天里，我一直在玩[`Continuity`](http://continuity.tlt42.org/)（[CPAN 条目](http://search.cpan.org/perldoc?Continuity)），一个有状态（每个用户的持久状态）Web 应用程序/服务器，它可以很容易地将“GUI”功能添加到应用程序中，同时使其多用户和便携。

编辑：在我写这篇文章的时候，我最感兴趣的是 Continuity 有自己的内置网络服务器。现在对于 Perl 的其他 web 框架也是如此。尽管我也听说过有关[Dancer](http://perldancer.org)的好消息，但我一直在使用[Mojolicious](http://mojolicio.us)。

# asp.net - ASP.Net GridView 排序

> ID：695723
> 
> 赞同：2
> 
> 时间：2009-03-30T00:53:49.643
> 
> 标签：asp.net, gridview, sorting

我有一个将 AllowSorting 设置为 true 的网格视图。单击可排序标题时，我会收到一个排序事件。处理程序有一个参数“GridViewSortEventArgs e”，它有一个 SortDirection 属性。无论您单击同一标题多少次，SortDirection 始终为升序。我想我错过了一些东西，比如告诉网格“现在你根据第一列和升序排序”，这样下次网格看到点击“第一列”标题时，它决定下降。

任何帮助表示赞赏。干杯，阿里

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-30T01:39:01.703

谢谢大家，我听了 balexandre 并采取了 viewState 方法。我想我不应该这样做，但似乎没有更好的方式自动取款机，我今天必须发货......

再次感谢，伟大的社区。干杯，阿里

# java - Java 重载方法

> ID：695724
> 
> 赞同：-3
> 
> 时间：2009-03-30T00:55:05.037
> 
> 标签：java, overloading

我正在尝试使用一个文件在命令窗口中创建一个菜单。用户从那些菜单选项中进行选择。他们被提示输入一个数字。该数字被传递给两个重载方法，这些方法确定该数字是整数还是浮点数。计算完成后，结果将打印到屏幕上并重新出现菜单。这是我的两个文件中的代码。

MyMathOpsTest 类：

```
import java.util.Scanner; // import Scanner class
public class MyMathOpsTest
{
   //method to pause until a key is pressed
   public static void pause() 
   { 
       try 
   { 
       System.out.print("Press <Enter> to continue..."); 
       System.in.read(); 
   } 
       catch (Exception e)
       {
           System.err.printf("Error %s%c\n",e.getMessage(),7);
       }
}//end pause

public static void main( String args[] )
{
    //variables to capture keyboard input
    Scanner keyBd = new Scanner( System.in );
    char selection;
    //int selection;

    do{//display menu
        System.out.println( "1\. Square a Number");
        System.out.println( "2\. Cube a Number");
        System.out.println( "3\. Raise a Number to a Power");
        System.out.println( "4\. Maximum of Three Numbers");
        System.out.println( "5\. Minimum of Three Numbers");
        System.out.println( "6\. Exit");
        System.out.print( "Selection[1-6]: " );

        //get menu selection
        selection = keyBd.next().charAt(0);
        //selection = keyBd.nextInt();

        //process menu selection
        switch (selection){
            case '1':
                MyMathOpsTest.squareTheNumber();
                pause();
                break;
            case '2':
                MyMathOpsTest.cubeTheNumber();
                pause();
                break;
            case '3':                
                MyMathOpsTest.raiseTheNumber();
                pause();
                break;
            case '4':                
                MyMathOpsTest.maximumNumber();
                pause();
                break;
            case '5':                
                MyMathOpsTest.minimumNumber();
                pause();
                break;
                case '6':
                //recognize as valid selection but do nothing
                break;
            default :
                System.out.printf("%c\n",7);
                System.out.println("Invalid Selection");
        }//end switch

    }while( selection != '6');
} // end method main

public static void squareTheNumber()
{

}

public static void cubeTheNumber()
{
}

public static void raiseTheNumber()
{
}

public static void maximumNumber()
{
MyMathOps.maximum();
}

public static void minimumNumber()
{
}

} // end class MyMathOpsTest 
```

MyMathOps 类：

```
import java.util.Scanner;

public class MyMathOps
{
public static int square(x:Integer):Integer
{
}

public static double square(x:Double):Double
{
}

public static int cube(x:Integer):Integer
{
}

public static double cube(x:Double):Double
{
}

public static int maximum(x:Integer, y:Integer, z:Integer):Integer
{
    // create Scanner for input from command window
    Scanner input = new Scanner( System.in );
    // obtain user input
    System.out.print( "Enter three integer values separated by spaces: ");
    int numberl = input.nextInt();
    // read first integer
    int number2 = input.nextInt();
    // read second double
    int number3 = input.nextInt();
    // read third double
    // determine the maximum value
    int result = maximum( numberl, number2, number3 );
    // display maximum value
    System.out.println( "Maximum is: " + result );
} // end method maximum

public static double maximum(x:Double, y:Double, z:Double):Double
{
    // create Scanner for input from command window
    Scanner input = new Scanner( System.in );
    // obtain user input
    System.out.print( "Enter three floating-point values separated by spaces: ");
    number1 = input.nextDouble();
    // read first double double
    number2 = input.nextDouble();
    // read second double
    double number3 = input.nextDouble();
    // read third double
    // determine the maximum value
    double result = maximum( numberl, number2, number3 );
    // display maximum value
    System.out.println( "Maximum is: " + result );
} // end method maximum

public static int minimum(x:Integer, y:Integer, z:Integer):Integer
{
    // create Scanner for input from command window
    Scanner input = new Scanner( System.in );
    // obtain user input
    System.out.print( "Enter three integer values separated by spaces: ");
    int numberl = input.nextInt();
    // read first integer
    int number2 = input.nextInt();
    // read second double
    int number3 = input.nextInt();
    // read third double
    // determine the minimum value
    int result = minimum( numberl, number2, number3 );
    // display minimum value
    System.out.println( "Minimum is: " + result );
} // end method minimum

public static double minimum(x:Double, y:Double, z:Double):Double
{
    // create Scanner for input from command window
    Scanner input = new Scanner( System.in );
    // obtain user input
    System.out.print( "Enter three floating-point values separated by spaces: ");
    number1 = input.nextDouble();
    // read first double double
    number2 = input.nextDouble();
    // read second double
    double number3 = input.nextDouble();
    // read third double
    // determine the minimum value
    double result = minimum( numberl, number2, number3 );
    // display minimum value
    System.out.println( "Minimum is: " + result );
} // end method minimum

} // end class MyMathOps 
```

此代码是我自己键入的代码和我教科书中的示例代码的组合。这不会在 jGRASP 中为我编译。我得到这些错误。

```
MyMathOps.java:10: <identifier> expected
   public static int square(x:Integer):Integer
                              ^
MyMathOps.java:96: ')' expected
    } // end method minimum
     ^
2 errors

----jGRASP wedge: exit code for process is 1.
----jGRASP: operation complete. 
```

我在这里做错了什么？我花了几个小时研究这个并阅读我的教科书。如果我不明白这一点。我会得到一个不好的成绩。我需要在这门课上取得好成绩，这样我才能进入一流的计算机科学大学。谢谢你的帮助。

万一我的导师或盐湖社区学院的任何管理员遇到这个问题，让我明确表达我的意图。这个问题是本着学术诚信的最大精神发布的。我问这个问题是为了寻求一般建议和帮助，以了解使用 Java 编程语言的正确方法。我绝不会使用他人的作品并将其视为我自己的作品。我使用此处提供的答案作为我理解的一般帮助。我自己做所有的工作，不会复制回答我问题的人提供的工作。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-30T01:14:04.273

像这样的行不是有效的 Java 语法：

```
public static int square(x:Integer):Integer
public static int maximum(x:Integer, y:Integer, z:Integer):Integer
... 
```

这看起来像 UML 或伪代码语法。“x:Integer”是“与语言无关的”表示法，这意味着 x 是 Integer 类型（映射到 Java 中的 int 或 Integer 对象）。最后的 ":Integer" 意味着该方法返回一个 Integer 类型，您已经正确执行了该类型。

尝试将所有方法声明更改为如下所示：

```
public static int square(int x) // Or "Integer x" if you want to use the Integer class, rather than the primitive int
public static int maximum(int x, int y, int z)
.... 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-30T01:41:02.633

我猜你已经习惯了 Pascal（或派生词）。

公共静态 int square(x:Integer):Integer

在Java中

公共静态 int square(int x)

此外，由于代码位于“MyMathOpsTest”中，因此您不需要在方法调用前加上“MyMathOpsTest.”。

另外，为什么称它为“MyMathOps”而不是“MathOperationsTest”？当然，它是你的——对我或其他任何人来说都不会太久！选择有意义的名称，尽量避免使用“Ops”之类的简写，除非它在您工作的领域很常见（URL 是一个很好的名称，“Ops”不是）。

现在对于初学者的一般编程建议：

*   写一行代码
*   让那行代码编译
*   一旦该行代码编译工作，下一个
*   获取下一行代码进行编译
*   继续这样做，直到程序完成。

一遍又一遍地犯同样的错误是没有意义的——你所擅长的就是犯错误，这并不好玩。

所以为了让你开始......

**第1步：**

```
public class MathOperations
{
    public static int maximum(final int x, final int y, final int z)
    {
    }
} 
```

（编译上面的代码）

**第2步：**

```
public class MathOperations
{
    public static int maximum(final int x, final int y, final int z)
    {
        final Scanner input;
    }
} 
```

（编译上面的代码）

**第 3 步：**

```
public class MathOperations
{
    public static int maximum(final int x, final int y, final int z)
    {
        final Scanner input;

        intput = new Scanner(System.in);
    }
} 
```

（编译上面的代码）

然后继续一行一行。一旦你掌握了窍门，你就可以做多行，但一开始，一次做一行会在你犯错时立即告诉你。确保在继续下一行之前修复所有错误。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-30T01:15:45.097

此外，在第一个方法 pause() 的末尾，您需要另一个花括号：

```
public static void pause() 
{ 
    try 
    { 
      System.out.print("Press <Enter> to continue..."); 
      System.in.read(); 
    } 
    catch (Exception e)
    {
      System.err.printf("Error %s%c\n",e.getMessage(),7);
    }
}<-- this one is missing in yours 
```

希望这可以帮助！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-30T01:46:17.207

我不知道练习的重点是什么——数学运算、重载或菜单。但我建议您以这些为基础重新开始。至少他们编译并运行：

```
public class MyMathOps
{
   public static int square(int x)
   {
       return x*x;
   }

   public static double square(double x)
   {
       return x*x;
   }

   public static int cube(int x)
   {
       return x*x*x;
   }

   public static double cube(double x)
   {
       return x*x*x;
   }

   public static int maximum(Integer... values)
   {
       Integer maxValue = Integer.MIN_VALUE;

       for (Integer value : values)
       {
           if (value.compareTo(maxValue) > 0)
           {
               maxValue = value;
           }
       }

       return maxValue;
   }

   public static double maximum(Double... values)
   {
       Double maxValue = Double.MIN_VALUE;

       for (Double value : values)
       {
           if (value.compareTo(maxValue) > 0)
           {
               maxValue = value;
           }
       }

       return maxValue;
   }

   public static int minimum(Integer... values)
   {
       Integer minValue = Integer.MAX_VALUE;

       for (Integer value : values)
       {
           if (value.compareTo(minValue) < 0)
           {
               minValue = value;
           }
       }

       return minValue;
   }

   public static double minimum(Double... values)
   {
       Double minValue = Double.MIN_VALUE;

       for (Double value : values)
       {
           if (value.compareTo(minValue) < 0)
           {
               minValue = value;
           }
       }

       return minValue;
   }

} 
```

和测试类（简化）：

```
public class MyMathOpsTest
{
    public static void main(String args[])
    {
        Integer [] intValues = { 1, 2, 3, };
        Double [] doubleValues = { 11.0, 14.0, -6.0 };

        for (Integer value : intValues)
        {
            System.out.println("value  : " + value);
            System.out.println("squared: " + MyMathOps.square(value));
            System.out.println("cubed  : " + MyMathOps.cube(value));
            System.out.println("min    : " + MyMathOps.minimum(intValues));
            System.out.println("max    : " + MyMathOps.maximum(intValues));
        }

        for (Double value : doubleValues)
        {
            System.out.println("value  : " + value);
            System.out.println("squared: " + MyMathOps.square(value));
            System.out.println("cubed  : " + MyMathOps.cube(value));
            System.out.println("min    : " + MyMathOps.minimum(doubleValues));
            System.out.println("max    : " + MyMathOps.maximum(doubleValues));
        }
    }
} 
```

运行完成后，您将知道您的方法是正确的。省去第一次尝试阅读价值观的困难。

# css - CSS 菜单不会出现在 Flash 上

> ID：695726
> 
> 赞同：5
> 
> 时间：2009-03-30T00:56:59.120
> 
> 标签：css, flash, drop-down-menu, swfobject, open-flash-chart

我在页面上有一个下拉/多级 CSS 菜单。然而，菜单并没有出现在我拥有的闪存图表上。**明显的解决方法似乎是放置 wmode:transparent （或不透明），但这对我不起作用。**我还尝试将 CSS 中的 z 级别设置为非常高的值（2000），但这也不起作用。

另外，我正在使用 open-flash-chart-v2 来生成图表。（虽然我认为这并不重要，但它限制了我传递变量的能力，因为我没有直接使用嵌入或对象标签）。

```
<script type="text/javascript">
swfobject.embedSWF("/ofc-library/open-flash-chart.swf", "chart", "100%", "100%", "9.0.0", "expressInstall.swf", {"wmode" : "transparent"});
</script> 
```

[页面显示问题](http://www.bcsfanpoll.com/graph/)（这目前不显示 z-index 尝试修复。）

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-03-30T01:01:10.950

wmode 标记未正确设置。

这是正确的代码：

```
<object width="100%" height="100%" style="visibility: visible;" id="chart" data="/ofc-library/open-flash-chart.swf" type="application/x-shockwave-flash"><param value="transparent" name="wmode"/></object> 
```

这是您的代码：

```
<object width="100%" height="100%" type="application/x-shockwave-flash" data="/ofc-library/open-flash-chart.swf" id="chart" style="visibility: visible;"><param name="flashvars" value="wmode=transparent"/></object> 
```

具体来说：

```
<param name="flashvars" value="wmode=transparent"/> 
```

应该：

```
<param value="transparent" name="wmode"/> 
```

以下是如何正确执行此操作（请注意参数之前的空哈希。wmode 是参数而不是 flashvar）：

```
swfobject.embedSWF("/ofc-library/open-flash-chart.swf", "chart", "100%", "100%", "9.0.0", "expressInstall.swf", {}, {"wmode" : "transparent"}) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-30T01:07:32.307

因为您使用的是 swfObject，请尝试以下操作：

```
 var so = new SWFObject("/ofc-library/open-flash-chart.swf", "chart", "100%", "100%", "9.0.0", "expressInstall.swf");
 so.addParam("wmode", "transparent");
 so.write("flashcontent"); 
```

# asp.net-mvc - 将 Javascript 函数分配给 AjaxOptions OnSuccess 属性引发错误 - ASP.NET MVC

> ID：695729
> 
> 赞同：10
> 
> 时间：2009-03-30T00:59:14.310
> 
> 标签：asp.net-mvc, asp.net-ajax

我正在使用 Ajax.ActionLink 帮助器来生成删除记录的链接。这是代码：

```
Ajax.ActionLink("Delete Image", "DeleteImage", new { id = item.Id },
                                               new AjaxOptions { HttpMethod = "Delete", OnSuccess = "Test()" } ) 
```

我为 OnSucess 属性分配了一个 Javascript 函数 (Test())，因为我想做一些 JQuery 的东西，但是当我单击删除链接时，会出现此错误消息

> Microsoft JScript 运行时错误：“b”为空或不是对象

在 MicrosoftAjax.js 文件中（第 5 行，第 62099 列）。如果我删除 OnSuccess 属性，一切正常（即使 Test() 函数为空，也会引发相同的错误）。谢谢你的帮助！

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-03-30T18:08:48.577

```
OnSuccess = "Test()" 
```

你必须这样写它是一个回调......

```
OnSuccess = "Test" 
```

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2010-09-02T15:18:29.310

如果您必须将任何参数传递给 OnSuccess 事件，您可能必须以这种方式编写函数。

```
OnSuccess = "function(){exampleFunction('" + param1 + "');}" 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-01-20T01:38:22.700

要传递参数，匿名函数将不起作用，您需要执行以下操作：

```
OnSuccess = String.Format("Test({0})", param) 
```

# c# - 如何在 C# 中访问属性或 const 的描述属性？

> ID：695730
> 
> 赞同：23
> 
> 时间：2009-03-30T00:59:37.817
> 
> 标签：c#, .net, attributes

您如何访问 const 或属性上的 Description 属性，即

```
public static class Group
{

    [Description( "Specified parent-child relationship already exists." )]
    public const int ParentChildRelationshipExists = 1;

    [Description( "User is already a member of the group." )]
    public const int UserExistsInGroup = 2;

} 
```

或者

```
public static class Group
{

    [Description( "Specified parent-child relationship already exists." )]
    public static int ParentChildRelationshipExists { 
      get { return 1; } 
    }

    [Description( "User is already a member of the group." )]
    public static int UserExistsInGroup { 
      get { return 2; } 
    }

} 
```

在调用类中，我想访问 Description 属性，即

```
int x = Group.UserExistsInGroup;
string description = Group.UserExistsInGroup.GetDescription(); // or similar 
```

我也对其他方法的想法持开放态度。

**编辑：** 我应该提到我在这里提供了一个示例： [自动实现的属性是否支持属性？](https://stackoverflow.com/questions/464889/does-auto-implemented-properties-support-attributes)

但是，我正在寻找一种无需在属性类型中输入字符串文字即可访问描述属性的方法，即，我宁愿不这样做：

```
typeof(Group).GetProperty("UserExistsInGroup"); 
```

类似于扩展方法的东西；类似于以下方法，它将通过扩展方法返回 Enum 上的 Description 属性：

```
public static String GetEnumDescription( this Enum obj )
{
    try
    {
        System.Reflection.FieldInfo fieldInfo = 
            obj.GetType().GetField( obj.ToString() );

        object[] attribArray = fieldInfo.GetCustomAttributes( false );

        if (attribArray.Length > 0)
        {
            var attrib = attribArray[0] as DescriptionAttribute;

            if( attrib != null  )
                return attrib.Description;
        }
        return obj.ToString();
    }
    catch( NullReferenceException ex )
    {
        return "Unknown";
    }
} 
```

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2009-03-30T01:04:22.317

尝试以下

```
var property = typeof(Group).GetProperty("UserExistsInGroup");
var attribute = property.GetCustomAttributes(typeof(DescriptionAttribute), true)[0];
var description = (DescriptionAttribute)attribute;
var text = description.Description; 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-03-30T01:05:00.660

您可以调用[MemberInfo.GetCustomAttributes()](http://msdn.microsoft.com/en-us/library/system.reflection.memberinfo.getcustomattributes.aspx)来获取在`Type`. 您可以`MemberInfo`通过执行以下操作来获取该属性：

```
PropertyInfo prop = typeof(Group).GetProperty("UserExistsInGroup",
    BindingFlags.Public | BindingFlags.Static); 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2010-02-02T06:03:14.997

这是我用于处理 .NET 中的自定义属性的辅助类

```
public class AttributeList : List<Attribute>
{
    /// <summary>
    /// Gets a list of custom attributes
    /// </summary>
    /// <param name="propertyInfo"></param>
    /// <returns></returns>
    public static AttributeList GetCustomAttributeList(ICustomAttributeProvider propertyInfo)
    {
        var result = new AttributeList();
        result.AddRange(propertyInfo.GetCustomAttributes(false).Cast<Attribute>());
        return result;
    }

    /// <summary>
    /// Finds attribute in collection by its type
    /// </summary>
    /// <typeparam name="T"></typeparam>
    /// <returns></returns>
    public T FindAttribute<T>() where T : Attribute
    {
        return (T)Find(x => typeof(T).IsAssignableFrom(x.GetType()));
    }

    public bool IsAttributeSet<T>() where T : Attribute
    {
        return FindAttribute<T>() != null;
    }
} 
```

还对 MsTest 进行了单元测试，展示了如何使用这个类

```
[TestClass]
public class AttributeListTest
{
    private class TestAttrAttribute : Attribute
    {
    }

    [TestAttr]
    private class TestClass
    {
    }

    [TestMethod]
    public void Test()
    {
        var attributeList = AttributeList.GetCustomAttributeList(typeof (TestClass));
        Assert.IsTrue(attributeList.IsAttributeSet<TestAttrAttribute>());
        Assert.IsFalse(attributeList.IsAttributeSet<TestClassAttribute>());
        Assert.IsInstanceOfType(attributeList.FindAttribute<TestAttrAttribute>(), typeof(TestAttrAttribute));
    }
} 
```

[http://www.kozlenko.info/2010/02/02/getting-a-list-of-custom-attributes-in-net/](http://www.kozlenko.info/2010/02/02/getting-a-list-of-custom-attributes-in-net/)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-30T01:44:33.030

好的，我已经看到了您的编辑，我不确定您是否可以使用扩展方法来做到这一点，因为它们会知道包含类的类型。

这听起来有点古怪，但是创建一个新类“DescribedInt”怎么样，它会有一个隐式转换运算符让您自动将其用作 int？你几乎可以使用你描述的方式。你仍然会有一个描述，但是当你需要像 Int 一样使用它时，你不需要获取 .Data 属性......

例如：

```
private void ExampleUse()
{
    int myvalue = Group.A; //see, no need to cast or say ".Data" - implicit cast
    string text = Group.A.Description; 
```

//用值做事... }

```
public static class Group
{
    public static DescribedInt A = new DescribedInt(12, "some description");
    public static DescribedInt B = new DescribedInt(88, "another description");
}

public class DescribedInt
{
    public readonly int data;
    public readonly string Description;

    public DescribedInt(int data, string description)
    {
        this.data = data;
        this.Description = description;
    }

    //automatic cast to int
    public static implicit operator int(DescribedInt orig)
    {
        return orig.data;
    }

    //public DescribedInt(string description)
    //{
    //    this.description = description;
    //}

    //if you ever need to go the "other way"
    //public static implicit operator DescribedInt(int orig)
    //{
    //    return new DescribedInt(orig, "");
    //}
} 
```

# iphone - 使用导航控制器时如何初始化视图

> ID：695731
> 
> 赞同：0
> 
> 时间：2009-03-30T01:00:20.610
> 
> 标签：iphone, navigation

我有一个显示银行交易列表的表格视图。当我点击一个时，我想显示使用当前数据初始化的编辑对话框。我目前正在做这样的事情来获取控制器并初始化其视图上的文本字段：

```
- (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath {   
    TransactionDetailViewController *transactionDetailViewController;
    transactionDetailViewController = [[TransactionDetailViewController alloc] initWithNibName:@"TransactionDetailViewController" bundle:nil];

    // round up data
    NSMutableDictionary *rowDict = (NSMutableDictionary *)[transactions objectAtIndex:indexPath.row];

    transactionDetailViewController.amountField.text = [rowDict objectForKey:@"amount"];
    transactionDetailViewController.nameField.text = [rowDict objectForKey:@"name"];
    transactionDetailViewController.datePicker.date = [rowDict objectForKey:@"date"];   

    [self.navigationController pushViewController:transactionDetailViewController animated:YES];
    [transactionDetailViewController release];
} 
```

不幸的是，这不起作用，因为此时尚未初始化 amountField、nameField 和 datePicker —— 它们是 0x00，因此，当我尝试设置它们的文本或日期值时，它们会被忽略。在调用 viewDidLoad 时，它们确实得到了正确的初始化。我是否必须存储在父控制器中选择的行，然后从详细视图回调文件所有者，或者有什么方法可以同时初始化详细视图并创建它？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-30T01:30:29.490

您有 2 个选项：

1.  覆盖`init`方法`TransactionDetailViewController`并在那里初始化子视图

2.  传递`NSDictionary`to`TransactionDetailViewController`并在`viewDidLoad`.

我通常将这两种方法结合起来。

如果您的视图并不复杂（并且您实际上不需要使用 NIB 文件），您可以在`init`.

另一方面，将 传递`NSDictionary`给视图可能会使您更容易获得返回值。

所以，在你的情况下，我可能会添加一个`NSDictionary`属性`TransactionDetailViewController`，然后做

```
[transactionDetailViewController setTransaction:rowDict] 
```

然后在 中`viewDidLoad`，我将初始化子视图中的值。

# math - 我在哪里可以找到有关线增长算法的信息？

> ID：695733
> 
> 赞同：2
> 
> 时间：2009-03-30T01:01:11.700
> 
> 标签：math, image-processing

我正在做一些图像处理，我需要找到一些关于线增长算法的信息——不确定我是否在这里使用了正确的术语，所以请告诉我这是需要的。

想象一下，我的输入图像只是黑色背景上的一个圆圈。我基本上想提取坐标，这样我就可以根据坐标在别处画这个圆。

*注意：*我已经在使用边缘检测图像过滤器，但我认为最好用一个简单的例子来解释。

基本上我要做的是检测图像中的线条，并将结果存储在一个数据类型中，我说过一个名为 Line 的类和各种不同的 Point 对象（包含 X/Y 坐标）。

```
class Line
{
    Point points[];
}

class Point
{
    int X, Y;
} 
```

这就是我想使用它的方式......

```
Line line;

for each pixel in image
{
    if pixel should be added to line
    {
        add pixel coordinates to line;
    }
} 
```

我不知道如何解决这个问题，因为你可能会建立，所以对任何主题的指针将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-30T01:24:52.407

我不确定我的解释是否正确，但标准方法是使用[Hough transform](http://en.wikipedia.org/wiki/Hough_transform)。这是一个两步过程：

1.  从给定的图像中，确定每个像素是否是边缘像素（此过程会创建一个新的“二进制”图像）。执行此操作的标准方法是[Canny 边缘检测](http://en.wikipedia.org/wiki/Canny_edge_detector)。

2.  使用边缘像素的二值图像，应用霍夫变换。基本思想是：对于每个边缘像素，计算通过它的所有线，然后取通过最多边缘像素的线。

编辑：显然你正在寻找边界。这是你如何做到的。

回想一下，Canny 边缘检测器实际上也给你一个梯度（不仅仅是幅度）。因此，如果您选择一个边缘像素并沿着（或反对）该向量，您将找到下一个边缘像素。继续前进，直到你不再碰到边缘像素，并且有你的边界。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-30T01:25:40.253

你说的不是一个简单的问题！我发现这个网站对图像处理很有帮助：http: [//homepages.inf.ed.ac.uk/rbf/HIPR2/wksheets.htm](http://homepages.inf.ed.ac.uk/rbf/HIPR2/wksheets.htm)

要尝试的一件事是[Hough 变换](http://homepages.inf.ed.ac.uk/rbf/HIPR2/hough.htm)，它可以检测图像中的形状。请注意，这并不容易弄清楚。

对于边缘检测，最好的是[Canny 边缘检测](http://homepages.inf.ed.ac.uk/rbf/HIPR2/canny.htm)，这也是一项非常重要的任务。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-30T05:41:51.087

假设以下情况为真：

*   您的图像在背景上包含一个形状
*   您可以确定哪些像素是背景，哪些像素是形状
*   您只想抓取形状外部的边界（这不包括您想要追踪内圆的类似甜甜圈的形状）

您可以使用轮廓跟踪算法，例如*Moore-neighbour*算法。

**脚步：**

1.  **找到一个初始边界像素**。为此，从图像的左下角开始，一直向上移动，如果到达顶部，则从底部开始，向右移动一个像素并重复，直到找到一个形状像素。确保在找到形状像素之前跟踪您所在的像素的位置。

2.  **找到下一个边界像素**。顺时针绕上一次访问的边界像素，从您最后一次访问的背景像素开始，然后找到当前的边界像素。

3.  **重复步骤 2，直到您重新访问第一个边界像素**。一旦您第二次访问第一个边界像素，您就已经跟踪了形状的整个边界并且可以停止。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-30T01:22:53.677

您可以查看[http://processing.org/](http://processing.org/)该项目的创建是为了在视觉环境中教授计算机编程的基础知识。有一种基于 java 的语言和一个用于制作“草图”的 IDE。它是一个非常好的包，可以快速处理视觉对象，并且有很好的例子，比如对你有用的[边缘检测。](http://processing.org/learning/topics/edgedetection.html)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-30T14:58:01.890

只是为了回应上面你想做边缘检测和霍夫变换的答案。
请注意，圆的霍夫变换有点棘手（您正在求解 3 个参数，x，y，半径）您可能只想使用[openCV 之类的库](http://sourceforge.net/projects/opencvlibrary/)

# c++ - 使用 __stdcall 和损坏的堆栈 (C++) 进行思想实验

> ID：695734
> 
> 赞同：-1
> 
> 时间：2009-03-30T01:01:45.147
> 
> 标签：c++, windows, stack, corrupt, stdcall

今天脑子里一直在想函数指针这个话题，脑子里想到了以下场景：

```
__stdcall int function (int)
{
    return 0;
}

int main()
{
    (*(int(*)(char*,char*))function)("thought", "experiment");
    return 0;
} 
```

AFAIK 这段代码会破坏堆栈，那么如果我运行这段代码，我会看到哪些类型的问题？

我会做这个调查自己，但是我已经离开我的开发机器一周了。

编辑：等一下，我想多了。正如评论中所观察到的那样，这段代码的目的是在所有事情都说完后在堆栈上留下一个参数（调用者将两个参数放在堆栈上，被调用者 - 只需要一个参数 - 只弹出一个）。然而，由于我的演员没有提到调用约定，我是否抛弃了 stdcall，至少从调用者的角度来看？*int function(int)*仍然会从堆栈中弹出一个参数，但是调用者是否会因为转换而恢复认为该函数是 __cdecl （默认值）？（即弹出三个参数？）

EDIT2：正如 Rob 所证实的，第二个问题的答案是肯定的。如果我想在堆栈上留下一个参数，我将不得不重述 __stdcall：

```
(*(__stdcall int(*)(char*,char*))function)("thought", "experiment"); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-30T01:42:04.487

您正在调用该函数，就好像它是 _cdecl 这意味着调用者推送参数并清理堆栈。

接收函数是 _stdcall，这意味着被调用者清理堆栈。被调用者需要一个参数，因此将从堆栈中弹出 4 个字节。

当函数返回时，调用者将弹出两个指针（之前已压入两个指针），因此您的堆栈被 4 个字节损坏。

两种调用约定使用相同的返回机制，并具有相同的寄存器规则（不保留 eax、ecx 和 edx）。有关更多详细信息，请参阅[维基百科](http://en.wikipedia.org/wiki/X86_calling_conventions)。

根据堆栈帧布​​局和对齐方式，这种不匹配可能会导致许多影响。如果你很幸运，那么你就可以摆脱它。如果不是这样，您可能会弄乱主函数的返回地址，导致程序在分支到谁知道在哪里时崩溃。如果编译器注入了某种堆栈保护来捕获损坏，那么它可能会检测到这一点并中止程序。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-30T01:20:08.113

不，它绝对不会导致蓝屏。没有用户模式进程能够做到这一点。即使这样的错误出现在内核模式代码中，蓝屏死机也只会在访问无效内存或将错误参数传递给函数后才会发生。

您只是在破坏进程的私有内存，并且该破坏可能（或可能不会）稍后导致无效操作（例如，取消引用指向无效内存的指针）。发生这种情况时，操作系统会终止您的进程，但不会很快。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-30T01:08:57.717

我认为在这种情况下你会有“未定义的行为”。

来自[C 标准](http://c0x.coding-guidelines.com/6.3.2.3.html)：（我认为它在 C++ 中是相同的）

> 768 如果转换后的指针用于调用类型与指向的类型不兼容的函数，则行为未定义。

编辑：在大多数操作系统上，这种类型的错误不会导致整个操作系统出现问题。但这会在您的程序中导致未定义的问题。用户模式程序很难导致蓝屏。

# database-design - 如何为多种产品设计产品表，其中每种产品都有很多参数

> ID：695752
> 
> 赞同：163
> 
> 时间：2009-03-30T01:19:06.273
> 
> 标签：database-design, relational-database, database-schema

我在桌子设计方面没有太多经验。我的目标是创建一个或多个满足以下要求的产品表：

*   支持多种产品（电视，电话，PC，...）。每种产品都有一组不同的参数，例如：

    *   手机将具有颜色、尺寸、重量、操作系统...

    *   PC将具有CPU，HDD，RAM ...

*   参数集必须是动态的。您可以添加或编辑您喜欢的任何参数。

如果每种产品没有单独的表格，我如何满足这些要求？

* * *

## 回答 #1

> 赞同：264
> 
> 时间：2009-03-30T02:41:21.117

您至少有以下五个选项来对您描述的类型层次结构进行建模：

*   [单表继承](http://martinfowler.com/eaaCatalog/singleTableInheritance.html)：所有产品类型的一个表，具有足够的列来存储所有类型的所有属性。这意味着*很多*列，其中大多数在任何给定行上都是 NULL。

*   [类表继承](http://martinfowler.com/eaaCatalog/classTableInheritance.html)：Products 的一个表，存储所有产品类型共有的属性。然后每个产品类型一个表，存储特定于该产品类型的属性。

*   [具体表继承](http://martinfowler.com/eaaCatalog/concreteTableInheritance.html)：没有通用产品属性的表。相反，每个产品类型都有一个表，存储常见的产品属性和产品特定的属性。

*   [序列化 LOB](http://martinfowler.com/eaaCatalog/serializedLOB.html)：一个产品表，存储所有产品类型共有的属性。一个额外的列以 XML、YAML、JSON 或其他格式存储半结构化数据的 BLOB。此 BLOB 允许您存储特定于每种产品类型的属性。您可以使用花哨的设计模式来描述这一点，例如 Facade 和 Memento。但是，无论您有不能在 SQL 中轻松查询的属性块；您必须将整个 blob 取回应用程序并在那里对其进行排序。

*   [Entity-Attribute-Value](http://en.wikipedia.org/wiki/Entity-Attribute-Value_model)：一张表用于产品，一张表将属性转为行，而不是列。EAV 就关系范式而言不是一个有效的设计，但无论如何很多人都在使用它。这是另一个答案提到的“属性模式”。[请参阅 StackOverflow 上带有eav 标签](https://stackoverflow.com/questions/tagged/eav)的其他问题，了解其中的一些陷阱。

我在演示文稿“[可扩展数据建模](http://www.slideshare.net/billkarwin/extensible-data-modeling)”中写了更多关于此的内容。

* * *

关于 EAV 的其他想法：虽然很多人似乎喜欢 EAV，但我不喜欢。它似乎是最灵活的解决方案，因此也是最好的。但是，请记住格言[TANSTAAFL](http://en.wikipedia.org/wiki/Tanstaafl)。以下是 EAV 的一些缺点：

*   没有办法强制列（相当于`NOT NULL`）。
*   无法使用 SQL 数据类型来验证条目。
*   无法确保属性名称的拼写一致。
*   无法在任何给定属性的值上放置外键，例如查找表。
*   在传统的表格布局中获取结果既复杂又昂贵，因为要从多行获取属性，您需要`JOIN`为每个属性执行操作。

EAV 为您提供的灵活性程度需要在其他方面做出牺牲，这可能会使您的代码与以更传统的方式解决原始问题一样复杂（或更糟）。

在大多数情况下，没有必要拥有那种程度的灵活性。在 OP 关于产品类型的问题中，为产品特定属性创建每个产品类型的表要简单得多，因此您至少对相同产品类型的条目强制执行一些一致的结构。

仅当必须允许*每一行都*可能具有一组不同的属性时，我才会使用 EAV 。当您拥有一组有限的产品类型时，EAV 是多余的。类表继承将是我的首选。

* * *

2019 年更新：我越是看到人们使用 JSON 作为“许多自定义属性”问题的解决方案，我就越不喜欢这种解决方案。它使查询过于复杂，即使使用特殊的[JSON 函数](https://dev.mysql.com/doc/refman/8.0/en/json-functions.html)来支持它们也是如此。与存储在普通行和列中相比，存储 JSON 文档需要更多的存储空间。

基本上，这些解决方案在关系数据库中都不是简单或有效的。具有“可变属性”的整个想法与关系理论根本不一致。

归根结底，您必须选择一种对*您的*应用程序最不利的解决方案。因此，在选择数据库设计之前，您需要知道如何查询数据。没有办法选择一种“最佳”的解决方案，因为任何解决方案都可能最适合给定的应用程序。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2011-03-21T14:20:19.457

@铁石心肠

我会一直使用 EAV 和 MVC。

@比尔卡文

> 以下是 EAV 的一些缺点：
> 
> *   无法强制列（相当于 NOT NULL）。
> *   无法使用 SQL 数据类型来验证条目。
> *   无法确保属性名称的拼写一致。
> *   无法在任何给定属性的值上放置外键，例如查找表。

您在这里提到的所有这些事情：

*   数据验证
*   属性名称拼写验证
*   必填列/字段
*   处理依赖属性的破坏

我认为根本不属于数据库，因为没有一个数据库能够像应用程序的编程语言那样在适当的级别上处理这些交互和需求。

在我看来，以这种方式使用数据库就像用石头敲钉子一样。你可以用一块石头来做，但你不应该使用更精确和专门为这种活动设计的锤子吗？

> 在传统的表格布局中获取结果既复杂又昂贵，因为要从多行获取属性，您需要为每个属性执行 JOIN。

这个问题可以通过对部分数据进行少量查询并使用您的应用程序将它们处理成表格布局来解决。即使您有 600GB 的产品数据，如果您需要此表中每一行的数据，您也可以批量处理。

更进一步 如果您想提高查询的性能，您可以选择某些操作，例如报告或全局文本搜索，并为它们准备索引表，这些表将存储所需的数据并定期重新生成，假设每 30 分钟一次。

您甚至不必担心额外数据存储的成本，因为它每天都在变得越来越便宜。

如果您仍然关心应用程序执行操作的性能，您始终可以使用 Erlang、C++、Go 语言来预处理数据，然后在您的主应用程序中进一步处理优化的数据。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2010-09-16T19:31:34.093

如果我使用`Class Table Inheritance`含义：

> 一个产品表，存储所有产品类型共有的属性。然后每个产品类型一个表，存储特定于该产品类型的属性。——比尔·卡尔文

我最喜欢 Bill Karwin 的建议。我可以预见一个缺点，我将尝试解释如何避免成为问题。

**当一个属性仅对 1 种类型通用，然后对 2、3 等变得通用时，我应该制定什么应急计划？**

例如：（这只是一个例子，不是我真正的问题）

如果我们卖家具，我们可能会卖椅子、灯具、沙发、电视等。电视类型可能是我们携带的唯一具有功耗的类型。所以我会把`power_consumption`属性放在`tv_type_table`. 但随后我们开始携带也有`power_consumption`属性的家庭影院系统。好的，它只是另一种产品，所以我也会将此字段添加到其中`stereo_type_table`，因为此时这可能是最简单的。但是随着时间的推移，随着我们开始携带越来越多的电子产品，我们意识到它`power_consumption`已经足够广泛，应该在`main_product_table`. 我现在该怎么办？

将字段添加到`main_product_table`. 编写一个脚本来循环遍历电子设备，并将每个电子设备的正确值`type_table`放入`main_product_table`. 然后从每个`type_table`.

现在如果我总是使用同一个`GetProductData`类与数据库交互来提取产品信息；那么如果代码中的任何更改现在需要重构，它们应该只针对该类。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-03-30T01:44:33.030

您可以拥有一个 Product 表和一个单独的 ProductAdditionInfo 表，其中包含 3 列：产品 ID、附加信息名称、附加信息值。如果许多但不是所有类型的产品都使用颜色，则可以将其设置为 Product 表中的可为空列，或者将其放在 ProductAdditionalInfo 中。

这种方法不是关系数据库的传统技术，但我已经看到它在实践中被大量使用。它可以灵活并具有良好的性能。

Steve Yegge 将此[称为属性模式](http://steve-yegge.blogspot.com/2008/10/universal-design-pattern.html#redacted)，并写了一篇关于使用它的长文。

# c++ - C++ STL map::erase a non-existing key

> ID：695754
> 
> 赞同：59
> 
> 时间：2009-03-30T01:20:41.370
> 
> 标签：c++, stl, map, key, erase

关于 C++ STL 映射，按键擦除：-

```
 size_type map::erase ( const key_type& x ); 
```

删除不存在的密钥是否合法？即下面的片段可以吗？

```
map<char,int> mymap;
mymap['c']=30;
mymap.erase('c');
mymap.erase('c');
mymap.erase('D'); 
```

干杯

* * *

## 回答 #1

> 赞同：80
> 
> 时间：2009-03-30T01:22:19.433

是的，事实上，[`std::map::erase()`](http://en.cppreference.com/w/cpp/container/map/erase)返回一个 size_type 表示已擦除的键数。因此，它返回 0 表示未擦除任何内容，返回 1 表示地图已擦除的内容。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-03-30T01:23:42.643

这很好， mymap.erase('D') 在这种情况下将返回 0。

见[http://www.cplusplus.com/reference/stl/map/erase.html](http://www.cplusplus.com/reference/stl/map/erase.html)

# wcf - 带有“ArrayOfstring”数据协定的 WCF 序列化错误

> ID：695755
> 
> 赞同：0
> 
> 时间：2009-03-30T01:21:44.957
> 
> 标签：wcf, serialization

当我调用我的 WCF 服务时收到下面提到的错误？如何摆脱它？

尝试序列化参数[http://tempuri.org/:MyWCFSvc.svc](http://tempuri.org/:MyWCFSvc.svc)时出错 InnerException 消息为“Type 'System.String[]'，数据合同名称为 'ArrayOfstring: [http://schemas.microsoft.com /2003/10/Serialization/Arrays](http://schemas.microsoft.com/2003/10/Serialization/Arrays) '不是预期的。将任何静态未知的类型添加到已知类型列表中 - 例如，通过使用 KnownTypeAttribute 属性或将它们添加到传递给 DataContractSerializer 的已知类型列表中。有关详细信息，请参阅 InnerException。*

我尝试在我的 WCF 服务接口中使用 [ServiceKnownType(typeof(string[]))] 但没有运气

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2010-02-16T21:11:22.943

晚了一年，但我遇到了同样的问题，这就是你需要做的

```
List<SomeClass> mylist = new List<SomeClass>();

DataContractSerializer dcs = new DataContractSerializer(mylist.GetType());
XmlWriter writer = XmlWriter.Create(sb, XWS);
dcs.WriteObject(writer, query);      
writer.Close(); 
```

问题是当您使用类的类型构造序列化程序时，序列化程序不会将其视为一个数组，它只会看到一个对象。

如果首先通过这样做找到它：

```
DataContractSerializer dcs = new DataContractSerializer(SomeClass.GetType());
XmlWriter writer = XmlWriter.Create(sb, XWS);
dcs.WriteObject(writer, query[0]);  // Only get the first record from linq to sql
writer.Close(); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-04T14:06:48.983

我也遇到了同样的问题，但是在对 OperationContract 进行了限定`[ServiceKnownType(typeof(string[]))]`并`[ServiceKnownType(typeof(int[]))]`解决了该问题之后。

例如：

```
[ServiceContract]
    public interface IReportService
    {
        [OperationContract]
        [ServiceKnownType(typeof(string[]))]
        [ServiceKnownType(typeof(int[]))]
        bool GenerateReport(int clientId, int masterId, string reportType, int[] vtIds, DateTime initialDate, DateTime finalDate,
                            bool descending, string userName, string timeZoneId, bool embedMap,
                            object[] vtExtraParameters, object[] vtScheduleParameters, string selectedCriteria,
                            out long reportID, out int scheduleID, out string message); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-30T01:44:07.853

您没有理由必须 KnownType 一个字符串数组。序列化程序应该已经知道这一点，并且数组不是问题。我正在毫无问题地在 WCF 中移动事物列表。你能发布一个你正在做什么的代表性样本吗？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-31T16:07:54.147

在客户端上配置服务引用提供了“数据类型”选项，允许您为集合/字典类型指定不同的类型。你里面有什么设置？

# php - 将动态 PHP/MySQL 论坛永久缓存为静态页面

> ID：695768
> 
> 赞同：2
> 
> 时间：2009-03-30T01:30:55.997
> 
> 标签：php, mysql, database, forum, archiving

我曾经为一小群在线死亡竞赛玩家运行了一个自制的论坛系统。这些论坛早已被关闭，目前处于离线状态。我想做的是创建静态 HTML 文件，其中包含整个系统的所有数据，以便拥有以前用户可以搜索的在线存档。

我可以控制所有原始数据。这将包括：

*   图片
*   简介
*   论坛主题
*   数据库
*   PHP 脚本

基本上，我想把数据库排除在外，这样我就不必浪费资源来保持它的活力。（也因为这是一个自制的论坛解决方案，我敢肯定它不是很优化）

这是一个可行的目标，还是我应该让论坛保持原样，而不用担心开销？

如果可能（并且远程可行），我可以获得一些关于如何进行的建议吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-30T01:53:47.267

wget 可以创建网站的 HTML 镜像。查看文档以了解 --mirror 的用法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-30T02:05:52.450

使用输出缓冲来捕获所有输出并将其写入文件而不是输出到浏览器。

编辑您的代码，以便在顶部（在任何 HTML 输出到浏览器之前），您有以下行：

```
ob_start(); 
```

在脚本的末尾，添加以下内容：

```
$output = ob_get_clean();
file_put_contents("<<name of this page>>.html", $output); 
```

你必须想出一些命名方案，这样你就不会得到重复。

然后，使用正则表达式，使用 apache RewriteRules 将所有请求重定向到新的 HTML 页面，这样您的链接就不会中断。

要获取所有页面，如果您没有很多页面，您可以一个一个地单击它们，您可以手动将所有 URL 写入一个数组，然后循环遍历它们，或者您甚至可以自己爬取站点，查找页面上的所有 URL 并将它们添加到队列中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-30T02:00:48.793

什么 ceejayoz 说 或者，您可以在应用程序的引导程序中添加一个缓存标头，一个您认为想要的多年的缓存。

您使用要在客户端缓存页面的小时数调用附加函数，如果有，请务必在 session_start 之后调用此函数，因为 session_start 会发出阻止缓存的标头。

```
function client_side_cache($hours)

{
        //in the event a session start is used, I have to clean all the #$%# headers it sends to prevent caching
        header('Cache-Control: ',true);
        header("Pragma: ", true);
        header("Expires: ", true);

        //get the If-Modified-Since header in a unix time format
        $headers = getallheaders();
        if (isset($headers['If-Modified-Since']))
        {
            $modifiedSince = explode(';', $headers['If-Modified-Since']);
            $modifiedSince = strtotime($modifiedSince[0]);
        }
        else
        {
            $modifiedSince = 0;
        }

        //calculate the Last-Modified timestamp
        $current_time=time();
        $last_modified=($current_time)/($hours*3600);
        $last_modified=(int)$last_modified;
        $last_modified=$last_modified*$hours*3600;

    //check cache not expires
        if ($last_modified <= $modifiedSince)
        {
            header('HTTP/1.1 304 Not Modified');
            exit();
        }

        else //emit a new Last-Modified (either cache expired or page wasn'r cached
        {
            Header('Last-Modified: '.gmdate("D, d M Y H:i:s",$last_modified).' GMT ');
        }

} 
```

# email - 用于识别电子邮件中引用文本的现有工具或代码

> ID：695770
> 
> 赞同：1
> 
> 时间：2009-03-30T01:32:26.100
> 
> 标签：email, email-parsing

我正在寻找一种方法来识别电子邮件中引用的文本。目标是在我的网络应用程序中添加类似于 Gmail 的“显示引用文本”功能的内容，该应用程序涉及邮件处理程序机器人。

stackoverflow 上有类似的问题，但他们要求一种算法。如果必须，我可以实现这一点，但我更喜欢经过验证的真正解决方案。

要求：

1) 支持 HTML 和纯文本电子邮件

2）在全线程上操作（即，它有原始文本来比较引用的文本；无需猜测）

3) 处理与引用相关的常见添加，例如“2008 年 5 月 10 日下午 6:35，布兰登写道：”

一个 python 库将是超级神奇的理想，但我不希望得到那么幸运。一个可以做到这一点的简单命令行工具非常接近理想，但我也不希望那么幸运。我很乐意从一个开源邮件客户端选择一个众所周知的良好实现，它可以合理地提取到一个工具中。

有没有人建议我最好的选择是什么？

我有点惊讶没有“电子邮件处理程序机器人构建工具包”之类的东西。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2010-07-20T22:53:41.433

只是跟进我收到的关于这个问题的电子邮件。

Sup 有一个非常容易理解/提取/翻译的逻辑来实现这一点。我将相关函数移植到 Python 并根据我的目的对其进行了调整。

Sup 是用 Ruby 编写的基于终端的邮件客户端：http: [//sup.rubyforge.org/](http://sup.rubyforge.org/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-08-19T09:45:33.157

谷歌为他们的方法申请了专利： [http ://www.google.co.uk/patents/US7222299](http://www.google.co.uk/patents/US7222299)

# http - REST 服务的 HTTP 动词和内容协商或 GET 字符串？

> ID：695776
> 
> 赞同：2
> 
> 时间：2009-03-30T01:38:48.880
> 
> 标签：http, rest

我正在设计一个 REST 服务，并试图权衡使用完整的 http 动词数组和内容协商与 GET 字符串变量的优缺点。我的选择会影响可缓存性吗？两种解决方案都可能不适合所有领域。

哪个最适合 crud 和查询（例如？action=PUT）？

哪个最适合 api 版本选择（例如？version=1.0）？

哪个最适合返回数据类型（例如？type=json）？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-30T02:25:52.337

CRUD/查询最好用 HTTP 动词表示。创建和更新通常是 PUT 或 POST。检索将是 GET。删除将是一个删除。这就是一般的映射。要点是 GET 不会引起副作用，并且动词会按照您期望的那样做。

如果这是传递它的唯一方式（例如，http 客户端库不允许您发送非 GET/POST 请求），则将操作放在 URI 中是可以的。但是，大多数库*都这样做*，因此强烈建议*不要*通过 URL 传递动词。

对 API 进行版本控制的“最佳”方式是在每个请求的基础上使用 HTTP 标头；这允许客户端升级/降级特定请求，而不是每一个请求。当然，版本控制的粒度需要从一开始就考虑进去，这可能会使服务器端代码严重复杂化。大多数人只是使用用于访问服务器的 URL。[Peter Williams 的博客文章“版本控制 Rest Web 服务”](http://barelyenough.org/blog/2008/05/versioning-rest-web-services/)中有更详细的解释

没有最好的返回数据类型；这取决于您的应用程序。对于 Ajax 网站，JSON 可能更容易，而对于要使用 Xpath 查询的复杂结构，XML 可能更容易。协议缓冲区是第三种选择。它还讨论了在 URL 或 HTTP 标头中最好指定返回协议是否更好。

在大多数情况下，标头对缓存的影响最大，因为代理在被告知时会尊重它们，用户代理也是如此（但显然 UA 的行为不同）。仅基于 URL 的缓存非常依赖于层。一些用户代理不会缓存任何带有查询字符串（Safari、iirc）的内容，并且代理可以根据自己的需要自由缓存或不缓存。

# wpf - 在以编程方式添加的控件上使用情节提要动画

> ID：695782
> 
> 赞同：38
> 
> 时间：2009-03-30T01:41:49.900
> 
> 标签：wpf, animation, storyboard

我正在尝试将新控件淡入到我的应用程序的“应用程序”区域，该区域是在删除现有控件后以编程方式添加的。我的代码如下所示：

```
 void settingsButton_Clicked(object sender, EventArgs e)
    {
        ContentCanvas.Children.Clear();

        // Fade in settings panel
        NameScope.SetNameScope(this, new NameScope());

        SettingsPane s = new SettingsPane();
        s.Name = "settingsPane";

        this.RegisterName(s.Name, s);
        this.Resources.Add(s.Name, s);

        Storyboard sb = new Storyboard();

        DoubleAnimation settingsFade = new DoubleAnimation();
        settingsFade.From = 0;
        settingsFade.To = 1;
        settingsFade.Duration = new Duration(TimeSpan.FromSeconds(0.33));
        settingsFade.RepeatBehavior = new RepeatBehavior(1);
        Storyboard.SetTargetName(settingsFade, s.Name);
        Storyboard.SetTargetProperty(settingsFade, new PropertyPath(UserControl.OpacityProperty));

        ContentCanvas.Children.Add(s);

        sb.Children.Add(settingsFade);
        sb.Begin();
    } 
```

但是，当我运行此代码时，我收到错误“没有适用的名称范围来解析名称 'settingsPane'。”

我可能做错了什么？我很确定我已经正确注册了所有内容:(

* * *

## 回答 #1

> 赞同：66
> 
> 时间：2009-03-30T01:54:47.357

我不会为 NameScopes 等而烦恼，而是宁愿使用 Storyboard.SetTarget。

```
var b = new Button() { Content = "abcd" };
stack.Children.Add(b);

var fade = new DoubleAnimation()
{
    From = 0,
    To = 1,
    Duration = TimeSpan.FromSeconds(5),
};

Storyboard.SetTarget(fade, b);
Storyboard.SetTargetProperty(fade, new PropertyPath(Button.OpacityProperty));

var sb = new Storyboard();
sb.Children.Add(fade);

sb.Begin(); 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2010-06-02T21:03:55.797

我在开始方法中使用这个作为参数解决了这个问题，试试：

```
sb.Begin(this); 
```

因为名字是在窗口中注册的。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-04-02T18:01:18.347

我同意，在这种情况下使用名称范围可能是错误的。使用 SetTarget 比使用 SetTargetName 更简单、更容易。

如果它对其他人有帮助，这就是我用来突出显示表格中的特定单元格的方法，其突出显示会衰减为空。添加新答案时，它有点像 StackOverflow 突出显示。

```
 TableCell cell = table.RowGroups[0].Rows[row].Cells[col];

    // The cell contains just one paragraph; it is the first block
    Paragraph p = (Paragraph)cell.Blocks.FirstBlock;

    // Animate the paragraph: fade the background from Yellow to White,
    // once, through a span of 6 seconds.

    SolidColorBrush brush = new SolidColorBrush(Colors.Yellow);
    p.Background = brush;
    ColorAnimation ca1 = new ColorAnimation()
    {
            From = Colors.Yellow,
            To = Colors.White,
            Duration = new Duration(TimeSpan.FromSeconds(6.0)),
            RepeatBehavior = new RepeatBehavior(1),
            AutoReverse = false,
    };

    brush.BeginAnimation(SolidColorBrush.ColorProperty, ca1); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-19T18:41:43.427

这可能很奇怪，但我的解决方案是同时使用这两种方法：

```
Storyboard.SetTargetName(DA, myObjectName);

Storyboard.SetTarget(DA, myRect);

sb.Begin(this); 
```

在这种情况下，没有错误。

看看我使用过的代码。

```
 int n = 0;
        bool isWorking;
        Storyboard sb;
        string myObjectName;
         UIElement myElement;

        int idx = 0;

        void timer_Tick(object sender, EventArgs e)
        {
            if (isWorking == false)
            {
                isWorking = true;
                try
                {
                      myElement = stackObj.Children[idx];

                    var possibleIDX = idx + 1;
                    if (possibleIDX == stackObj.Children.Count)
                        idx = 0;
                    else
                        idx++;

                    var myRect = (Rectangle)myElement;

                   // Debug.WriteLine("TICK: " + myRect.Name);

                    var dur = TimeSpan.FromMilliseconds(2000);

                    var f = CreateVisibility(dur, myElement, false);

                    sb.Children.Add(f);

                    Duration d = TimeSpan.FromSeconds(2);
                    DoubleAnimation DA = new DoubleAnimation() { From = 1, To = 0, Duration = d };

                    sb.Children.Add(DA);
                    myObjectName = myRect.Name;  
                   Storyboard.SetTargetName(DA, myObjectName);
                   Storyboard.SetTarget(DA, myRect);

                    Storyboard.SetTargetProperty(DA, new PropertyPath("Opacity"));

                    sb.Begin(this);

                    n++;
                }
                catch (Exception ex)
                {
                    Debug.WriteLine(ex.Message + "   " + DateTime.Now.TimeOfDay);
                }

                isWorking = false;
            }
        } 
```

# vb6 - 您如何识别用户何时更改了 Visual Basic 6.0 中的 Windows 默认打印机？

> ID：695784
> 
> 赞同：1
> 
> 时间：2009-03-30T01:42:23.550
> 
> 标签：vb6, printing

我有一个[Visual Basic 6.0应用程序，当用户通过](http://en.wikipedia.org/wiki/Visual_Basic#Timeline)*控制面板*更改 Windows 默认打印机时，它需要识别。

现在，当应用程序启动时，“Printer.DeviceName”包含默认的打印机名称......很简单。

如果您随后通过控制面板更改 Windows 默认打印机，您的 Visual Basic 应用程序将无法识别新的默认打印机，直到它重新启动。

有没有办法以某种方式刷新 Visual Basic 打印机对象，以便您的应用程序可以识别更改？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-03-30T02:37:07.320

有一个更简单的方法。当您的应用程序启动时，只需将`Printer`对象的`TrackDefault`属性设置为`True`.

```
Public Sub Main()

    Printer.TrackDefault = True

End Sub 
```

当`TrackDefault`属性为`True`时，`Printer`对象将自动跟踪通过控制面板对默认打印机所做的更改。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-30T02:01:37.733

我找到了解决方案。使用API​​调用如下；

```
Private Declare Function GetProfileString Lib "kernel32.dll" Alias "GetProfileStringA" (ByVal lpAppName As String, ByVal lpKeyName As String, ByVal lpDefault As String, ByVal lpReturnedString As String, ByVal nSize As Long) As Long

Public Function GetDefaultPrinter() As Printer

    Dim strBuffer As String * 254
    Dim iRetValue As Long
    Dim strDefaultPrinterInfo As String
    Dim tblDefaultPrinterInfo() As String
    Dim objPrinter As Printer

    ' Retreive current default printer information
    iRetValue = GetProfileString("windows", "device", ",,,", strBuffer, 254)
    strDefaultPrinterInfo = Left(strBuffer, InStr(strBuffer, Chr(0)) - 1)
    tblDefaultPrinterInfo = Split(strDefaultPrinterInfo, ",")
    For Each objPrinter In Printers
        If objPrinter.DeviceName = tblDefaultPrinterInfo(0) Then
            ' Default printer found !
            Exit For
        End If
    Next

    ' If not found, return nothing
    If objPrinter.DeviceName <> tblDefaultPrinterInfo(0) Then
        Set objPrinter = Nothing
    End If

    Set GetDefaultPrinter = objPrinter

End Function 
```

感谢[http://www.andreavb.com/tip070005.html](http://www.andreavb.com/tip070005.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-30T01:54:07.220

您可以在表单上添加一个 Timer 对象，并使用 10 秒触发器检查打印机是否已更改。

# asp.net - IListSource 不包含任何数据源

> ID：695792
> 
> 赞同：3
> 
> 时间：2009-03-30T01:46:32.293
> 
> 标签：asp.net, gridview, webforms, datatable

那么这究竟意味着什么呢？

一些人建议为了规避这个错误，只有在数据表的行数大于零时才将 gridview 绑定到数据集。

但是，例如，如果您的搜索没有返回任何记录，那么您的数据表将没有行，但是您仍然可以绑定到数据集呢？

除了检查行是否在数据集（或数据表）中，我如何确保 ilist 包含有效的数据源？

最好的方法是什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-15T21:00:12.790

确保你使用这个：

```
if (!this.IsPostBack)
{
} 
```

你也可以检查`dataSet.Tables.Count > 0`then `return dataSet`else `return null;`

我认为 DataSet 返回有`Count = 0`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-01-20T10:53:04.003

请检查您的连接字符串。就我而言，连接字符串是问题所在。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-08-07T23:51:54.450

旧线程，但只是想让人们知道我最近遇到了这个错误（在查看我们的旧系统时），结果发现这个问题与将数据源直接绑定到数据集有关。

```
Dim MyDs As new Dataset
MyDs = GetFromDataBase()

MyDropDownList.Datasource = MyDs 
```

奇怪的是，我多年来一直在编写这样的代码，而且它在我的本地机器上运行良好（有史以来最好的开发线 =P）但在服务器上它一直在崩溃。

我必须做

```
MyDropDownList.Datasource = MyDs.Tables(0) 
```

也许这与 Windows 2008 Server 上的 .Net 4.0 有关，不确定，但希望这可能有助于有人浪费 30 分钟的时间寻找错误，以寻找您认为非常好的（尽管是遗留）代码。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-06T05:39:52.763

`IListSource`不包含任何数据源。

当网站托管在 IIS 服务器中时，为什么会出现此错误。

这是因为数据源没有与服务器正确连接。

我在调用该方法时使用了这个回发检查。

```
if (!this.IsPostBack) { ... } 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-07-16T11:47:47.103

确保在将数据绑定到 gridview 后关闭连接

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2020-04-15T09:57:48.313

就我而言，我的页面应该重定向到另一个页面，但该 URL 不存在。所以我得到了这个错误。如果您要重定向到其他页面，请检查 URL。

# python - 腌制字符串的更有效方法

> ID：695794
> 
> 赞同：9
> 
> 时间：2009-03-30T01:48:21.977
> 
> 标签：python, numpy, pickle, space-efficiency

pickle 模块在酸洗时似乎使用了字符串转义字符；这变得低效，例如在 numpy 数组上。考虑以下

```
z = numpy.zeros(1000, numpy.uint8)
len(z.dumps())
len(cPickle.dumps(z.dumps())) 
```

长度分别为 1133 个字符和 4249 个字符。

z.dumps() 显示类似 "\x00\x00" （字符串中的实际零）的内容，但 pickle 似乎正在使用字符串的 repr() 函数，产生 "'\x00\x00'" （零是 ascii 零）。

即 ("0" in z.dumps() == False) 和 ("0" in cPickle.dumps(z.dumps()) == True)

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2009-03-30T02:40:30.510

尝试使用更高版本的 pickle 协议，其协议参数为`pickle.dumps()`. 默认值为 0，是 ASCII 文本格式。大于 1 的（我建议你使用 pickle.HIGHEST_PROTOCOL）。协议格式 1 和 2（以及 3，但这是针对 py3k 的）是二进制的，应该更加节省空间。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-03-30T10:38:05.587

解决方案：

```
import zlib, cPickle

def zdumps(obj):
  return zlib.compress(cPickle.dumps(obj,cPickle.HIGHEST_PROTOCOL),9)

def zloads(zstr):
  return cPickle.loads(zlib.decompress(zstr))  

>>> len(zdumps(z))
128 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2010-05-11T07:26:47.573

`z.dumps()`已经是腌制的字符串，即，可以使用 pickle.loads() 将其取消腌制：

```
>>> z = numpy.zeros(1000, numpy.uint8)
>>> s = z.dumps()
>>> a = pickle.loads(s)
>>> all(a == z)
True 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-05-09T21:46:27.037

对 vartec 答案的改进，这似乎更节省内存（因为它不会强制将所有内容都转换为字符串）：

```
def pickle(fname, obj):
    import cPickle, gzip
    cPickle.dump(obj=obj, file=gzip.open(fname, "wb", compresslevel=3), protocol=2)

def unpickle(fname):
    import cPickle, gzip
    return cPickle.load(gzip.open(fname, "rb")) 
```

# java - 如何获得正确的编码？

> ID：695795
> 
> 赞同：1
> 
> 时间：2009-03-30T01:49:11.710
> 
> 标签：java

我有 utf-8 文件，我想在我的 java 程序中读取和显示。

在eclipse控制台（stdout）或swing中，我得到的是问号而不是正确的字符。

```
BufferedReader fr = new BufferedReader(
                      new InputStreamReader(
                      new FileInputStream(f),"UTF-8"));
System.out.println(fr.readLine());

inpuStreamReader.getEncoding() //prints me UTF-8 
```

我通常在 linux 控制台或 firefox 等上显示重音字母都没有问题。

为什么呢？我病了：/

谢谢你的帮助

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-30T01:52:39.360

我不是 Java 专家，但您似乎正在`InputStreamReader`使用不一定是 UTF-8 的文件创建 UTF-8。

另请参阅：[Java：如何确定流的正确字符集编码](https://stackoverflow.com/questions/499010/java-how-to-determine-the-correct-charset-encoding-of-a-stream)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-30T01:59:54.913

听起来 Eclipse 控制台没有处理 UTF-8 字符，和/或为该控制台配置的字体不支持您尝试显示的 Unicode 字符。

如果您将 Eclipse 配置为使用 UTF-8 字符，并且还确保使用的字体可以显示在您的文件中编码的那些 Unicode 字符，那么您可能能够使其工作。

从[Eclipse 3.1 New and Noteworthy](http://archive.eclipse.org/eclipse/downloads/drops/R-3.1-200506271435/eclipse-news-part1c.html)页面：

> 您可以使用启动配置的 Common 选项卡上的 Console Encoding 设置，将控制台配置为使用不同于默认字符编码的字符编码来显示输出。

至于 Swing，我认为您需要选择正确的字体。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-30T02:02:13.300

当系统必须显示 Unicode 字符时，有几个参数在起作用 -

*   首先想到的是输入流或缓冲区的编码，您已经弄清楚了。
*   The next one in the list is the Unicode capabilities of the application - Eclipse does support display of Unicode characters in the console output; [with a workaround](https://bugs.eclipse.org/bugs/show_bug.cgi?id=13865) :).
*   The last one in my mind is that of the font used in you console output - not all fonts come with glyphs for displaying Unicode characters.

* * *

Update

The non-display of Unicode characters is most likely due to the fact that Cp1252 is used for encoding characters in the console output. This can be modified by visiting the Run configuration of the application - it appears in the Common tab of the run-time configuration.

# c# - 使用 SSL 和 SslStream 进行对等身份验证？

> ID：695802
> 
> 赞同：18
> 
> 时间：2009-03-30T01:56:43.483
> 
> 标签：c#, ssl, ssl-certificate, sslstream

我需要在使用 TCP/IP 套接字进行通信的各种进程之间提供安全通信。我想要身份验证和加密。而不是重新发明轮子，我真的很想使用 SSL 和 SslStream 类和自签名证书。我想要做的是根据我本地应用程序中的已知副本验证远程进程的证书。（不需要证书颁发机构，因为我打算手动复制证书）。

为此，我希望应用程序能够在第一次运行时自动生成新证书。除了 makecert.exe，看起来[这个链接](http://blogs.msdn.com/dcook/archive/2008/11/25/creating-a-self-signed-certificate-in-c.aspx)显示了一种自动生成自签名证书的方法，所以这是一个开始。

我查看了 SslStream 的 AuthenticateAsServer 和 AuthenticateAsClient 方法。您可以提供回调以进行验证，因此看起来是可能的。但现在我了解了它的细节，我真的认为不可能做到这一点。

我是否朝着正确的方向前进？有更好的选择吗？以前有没有人做过这样的事情（基本上是对等 SSL 而不是客户端服务器）？

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2009-03-31T03:42:31.553

**第 1 步：**生成自签名证书：

*   我下载了Doug Cook 发布的[Certificate.cs 类](http://blogs.msdn.com/dcook/archive/2008/11/25/creating-a-self-signed-certificate-in-c.aspx)
*   我使用此代码生成 .pfx 证书文件：

    ```
    byte[] c = Certificate.CreateSelfSignCertificatePfx(
            "CN=yourhostname.com", //host name
            DateTime.Parse("2000-01-01"), //not valid before
            DateTime.Parse("2010-01-01"), //not valid after
            "mypassword"); //password to encrypt key file

        using (BinaryWriter binWriter = new BinaryWriter(
            File.Open(@"testcert.pfx", FileMode.Create)))
        {
            binWriter.Write(c);
        } 
    ```

**第 2 步：**加载证书

```
 X509Certificate cert = new X509Certificate2(
                            @"testcert.pfx", 
                            "mypassword"); 
```

**第3步：**把它放在一起

*   我基于[这个非常简单的 SslStream 示例](http://leastprivilege.com/2005/02/28/sslstream-sample/)
*   您将收到有关 SslProtocolType 枚举的编译时错误。只需将其从 SslProtocolType.Default 更改为 SslProtocols.Default
*   有 3 条关于已弃用功能的警告。我用建议的替代品替换了它们。
*   我将 Server Program.cs 文件中的这一行替换为步骤 2 中的行：

    X509Certificate 证书 = getServerCert();

*   在 Client Program.cs 文件中，确保您设置 serverName = yourhostname.com（并且它与证书中的名称匹配）

*   在 Client Program.cs 中，CertificateValidationCallback 函数失败，因为 sslPolicyErrors 包含 RemoteCertificateChainErrors。如果你再深入一点，这是因为签署证书的颁发机构不是受信任的根。
*   我不想让用户将证书导入根存储等，所以我为此做了一个特殊情况，我检查了 certificate.GetPublicKeyString() 是否等于我存档的公钥对于该服务器。如果匹配，我从该函数返回 True。这似乎行得通。

**第 4 步：**客户端身份验证

这是我的客户端进行身份验证的方式（它与服务器有点不同）：

```
TcpClient client = new TcpClient();
client.Connect(hostName, port);

SslStream sslStream = new SslStream(client.GetStream(), false,
    new RemoteCertificateValidationCallback(CertificateValidationCallback),
    new LocalCertificateSelectionCallback(CertificateSelectionCallback));

bool authenticationPassed = true;
try
{
    string serverName = System.Environment.MachineName;

    X509Certificate cert = GetServerCert(SERVER_CERT_FILENAME, SERVER_CERT_PASSWORD);
    X509CertificateCollection certs = new X509CertificateCollection();
    certs.Add(cert);

    sslStream.AuthenticateAsClient(
        serverName,
        certs,
        SslProtocols.Default,
        false); // check cert revokation
}
catch (AuthenticationException)
{
    authenticationPassed = false;
}
if (authenticationPassed)
{
    //do stuff
} 
```

CertificateValidationCallback 与服务器案例中的相同，但请注意 AuthenticateAsClient 如何获取一组证书，而不仅仅是一个证书。所以，你必须像这样添加一个 LocalCertificateSelectionCallback（在这种情况下，我只有一个客户端证书，所以我只返回集合中的第一个）：

```
static X509Certificate CertificateSelectionCallback(object sender,
    string targetHost,
    X509CertificateCollection localCertificates,
    X509Certificate remoteCertificate,
    string[] acceptableIssuers)
{
    return localCertificates[0];
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2010-04-26T12:10:18.767

你也可以看看这个示例异步 SslStream 客户端/服务器实现示例 [http://blogs.msdn.com/joncole/archive/2007/06/13/sample-asynchronous-sslstream-client-server-implementation.aspx](http://blogs.msdn.com/joncole/archive/2007/06/13/sample-asynchronous-sslstream-client-server-implementation.aspx)

如果证书未正确生成，您可以获得异常服务器模式 SSL 必须使用具有关联私钥的证书。

基本证书示例

makecert -sr LocalMachine -ss My -n CN=Test -sky exchange -sk 123456

或者

作为外部文件

makecert -sr LocalMachine -ss My -n CN=Test -sky exchange -sk 123456 c:\Test.cer

证书创建工具 (Makecert.exe)
[http://msdn.microsoft.com/en-us/library/bfsktky3%28VS.80%29.aspx](http://msdn.microsoft.com/en-us/library/bfsktky3%28VS.80%29.aspx)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-30T02:11:47.473

您提出的建议对我来说听起来不错，只是听起来您希望等到调用回调以生成证书。我不认为那会飞。AFAIK，您必须在调用时提供有效证书`AuthenticateAsX`。

但是，这些类是可覆盖的；所以理论上，你可以创建一个派生类，它首先检查是否需要生成证书，如果需要生成它，然后调用父`AuthenticateAsX`方法。

# functional-programming - 如何在标准 ML 中打印多态值？

> ID：695807
> 
> 赞同：6
> 
> 时间：2009-03-30T02:01:07.920
> 
> 标签：functional-programming, polymorphism, printing, sml

有没有办法在标准 ML（特别是 SML/NJ）中打印多态值？我有一个多态函数没有做我想要的，并且由于在 SML 中调试的糟糕状态（请参阅[调试生产功能程序的任何真实世界经验？](https://stackoverflow.com/questions/393492/any-real-world-experience-debugging-a-production-functional-program)），我想看看它在做什么旧`print`的。一个简单的例子是（在提示下）：

```
fun justThisOnce(x : 'a) : 'a = (print(x); x);
justThisOnce(42); 
```

其他建议表示赞赏。与此同时，我将继续盯着有问题的代码提交。

### 更新

我能够找到错误，但问题仍然存在于防止未来痛苦和痛苦的希望中。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-31T01:14:23.407

不，没有办法打印多态值。你有两个选择：

*   将您的函数专门用于易于打印的整数或字符串。然后当 bug 被杀死时，再次使其成为多态。

*   如果错误仅在某些其他实例化时出现，`show`请将其作为附加参数传递给您的函数。例如，如果您的多态函数具有类型

    ```
    'a list -> 'a list 
    ```

    您将类型扩展到

    ```
    ('a -> string) -> 'a list -> 'a list 
    ```

    您在`show`内部使用进行打印，然后通过将该功能部分应用于合适的`show`，您可以获得可以在原始上下文中使用的版本。

    这很乏味，但确实有帮助。（但请注意：它可能会驱使您尝试 Haskell。）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-30T06:02:36.123

**仅在 MOSML 中**：仅出于调试目的，使用该`printVal`功能。请注意，此功能仅在顶层模式下可用，当您尝试编译程序时会导致错误。

**编辑**：在这种情况下，恐怕没有通用的解决方案，您需要将您的值显式转换为字符串，然后打印出来。有关好的建议，请参阅其他答案。

# unit-testing - 代码覆盖的陷阱

> ID：695811
> 
> 赞同：32
> 
> 时间：2009-03-30T02:04:22.950
> 
> 标签：unit-testing, code-coverage

我正在寻找代码覆盖率的一些不良副作用的真实示例。

我注意到最近在工作中发生了这种情况，因为有一项实现 100% 代码覆盖率的政策。代码质量肯定一直在提高，但相反，测试人员似乎正在编写更宽松的测试计划，因为“代码完全经过单元测试”。结果，一些逻辑错误设法溜走了。调试它们真的很痛苦，因为“代码已经过完全单元测试”。

我认为这部分是因为我们的工具只进行了语句覆盖。尽管如此，它本来可以更好地度过时间。

如果有人对代码覆盖政策有其他负面影响，请分享。我想知道现实世界中正在发生什么样的其他“问题”。

提前致谢。

编辑：感谢所有非常好的回应。有一些我会标记为答案，但不幸的是我只能标记一个。

* * *

## 回答 #1

> 赞同：59
> 
> 时间：2009-03-30T03:02:40.673

一句话：代码覆盖率告诉你你肯定**没有**测试过什么，而不是你**有什么。**

构建有价值的单元测试套件的一部分是找到最重要的、高风险的代码并提出难题。您要确保将艰难的事情作为优先事项。覆盖率数字没有代码的“重要性”概念，也没有测试质量的概念。

根据我的经验，您将编写的许多最重要的测试都是几乎不增加任何覆盖率的测试（边缘情况会在这里和那里增加一些额外的百分比，但会发现大量错误）。

设置硬性和（可能适得其反的）覆盖率目标的问题在于，开发人员可能不得不开始向后弯腰来测试他们的代码。让代码可测试，然后就是折磨。如果您通过出色的测试达到 100% 的覆盖率，那就太棒了，但在大多数情况下，额外的努力是不值得的。

此外，人们开始痴迷/摆弄数字，而不是关注测试的质量。我见过覆盖率超过 90% 的糟糕测试，就像我见过只有 60-70% 覆盖率的优秀测试一样。

同样，我倾向于将覆盖率视为绝对**没有**经过测试的指标。

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2009-03-30T02:21:08.263

仅仅因为存在代码覆盖率并不意味着您实际上正在测试通过该函数的所有路径。

例如，这段代码有四个路径：

```
if (A) { ... } else { ... }
if (B) { ... } else { ... } 
```

然而，只有两个测试（例如，一个 A 和 B 为真，一个 A 和 B 为假）将给出“100% 的代码覆盖率”。

这是一个问题，因为一旦达到神奇的 100% 数字就会停止测试。

* * *

## 回答 #3

> 赞同：19
> 
> 时间：2009-03-30T02:28:21.443

以我的经验，代码覆盖工具的最大问题是有人会成为“高代码覆盖率”等于“良好测试”的信念的牺牲品。大多数覆盖率工具只提供语句覆盖率指标，而不是条件、数据路径或决策覆盖率。这意味着可以在如下代码中获得 100% 的覆盖率：

```
for (int i = 0; i < MAX_RETRIES; ++i) {
    if (someFunction() == MAGIC_NUMBER) {
        break;
    }
} 
```

...没有在 for 循环上测试终止条件。

更糟糕的是，可以从简单地调用您的应用程序的测试中获得非常高的“覆盖率”，而无需费心验证输出或验证不正确。

简而言之，*低*代码覆盖率肯定表明测试不足，但*高*覆盖率*并不*表明测试充分或正确。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-03-30T02:18:38.207

有时极端情况非常罕见，不值得测试，但严格的代码覆盖规则要求您无论如何都要对其进行测试。

例如，在 Java 中，MD5 算法是内置的，但从技术上讲，可能会抛出“不支持的算法”类型的异常。它永远不会被抛出，您的测试将不得不经历重大的回转来测试该路径。

这会浪费很多工作。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-03-30T03:23:17.800

在我看来，一个团队衡量代码覆盖率的最大危险是它奖励大型测试，惩罚小型测试。如果您可以选择编写一个覆盖应用程序大部分功能的单个测试，还是编写十个测试单个方法的小测试，那么仅测量代码覆盖率意味着您应该编写大型测试。

但是，编写一组 10 个小测试将使您的测试不那么脆弱，并且会比一个大型测试更彻底地测试您的应用程序。因此，通过测量代码覆盖率，尤其是在测试习惯仍在不断发展的组织中，您通常会设置错误的激励措施。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-03-30T02:43:43.963

我知道这不是您问题的直接答案，但是...

任何测试，无论是什么类型，本身都是不够的。单元测试/代码覆盖率适用于开发人员。QA 仍然需要对整个系统进行测试。业务用户仍然需要对系统进行整体测试。

相反，QA 完全测试代码，因此开发人员不应该测试同样糟糕。测试是免费的，不同的测试提供不同的东西。每种测试类型都可能遗漏其他人可能发现的东西。

就像其他开发一样，不要走捷径进行测试，它只会让错误通过。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-03-30T02:20:27.280

1.  编写过于有针对性的测试用例。
2.  代码的输入可变性测试不足
3.  执行了大量的人工测试用例。
4.  不专注于因噪音而导致的重要测试失败。
5.  难以分配缺陷，因为来自许多组件的许多条件必须相互作用才能执行生产线。

拥有 100% 覆盖率目标的最坏副作用是花费大量的测试开发周期 (75%+) 来解决极端情况。这种策略的另一个不良影响是集中在特定的代码行上，而不是解决输入范围。我真的不在乎 strcpy 函数至少运行了一次。我真的很关心它是否与各种各样的输入相冲突。有政策是好的。但任何极端严厉的政策都是不好的。100% 的代码覆盖率指标对于代码被认为是可靠的既不是必要的，也不是充分的。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-03-30T09:58:26.103

代码覆盖率的最大缺陷之一是人们只谈论代码覆盖率，而没有具体说明他们在谈论*什么类型的代码覆盖率。*C0、C1、C2 甚至更高级别的代码覆盖率的特性都*大相径庭*，所以仅仅谈论“代码覆盖率”甚至没有意义。

例如，实现 100% 的全路径覆盖几乎是不可能的。如果您的程序有`n`决策点，则需要 2 ^n次测试（并且根据定义，值中的每一位都是一个决策点，因此要为仅添加两个`int`s 的极其简单的函数实现 100% 完整路径覆盖，您需要 18446744073709551616 次测试）。如果你只有*一个*循环，你已经需要*无限多的*测试。

OTOH，实现 100% 的 CO 覆盖率是微不足道的。

要记住的另一件重要事情是，代码覆盖率不会*告诉*您测试了哪些代码。它只告诉你*运行*了什么代码！您可以自己尝试一下：采用具有 100% 代码覆盖率的代码库。从测试中删除所有断言。现在代码库*仍然*有 100% 的覆盖率，但没有测试任何东西！所以，代码覆盖率不会告诉你测试了什么，只告诉你什么没有测试。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-04-01T01:10:50.863

有一些工具，[比如 Jumble](http://jumble.sourceforge.net/index.html)，它通过分支覆盖执行分析，通过改变你的代码来查看你的测试是否在所有不同的排列上都失败了。

直接从他们的网站：

> Jumble 是一个类级别的突变测试工具，与 JUnit 一起工作。变异测试的目的是提供测试用例有效性的度量。对要测试的代码执行单个突变，然后执行相应的测试用例。如果修改后的代码未能通过测试，那么这会增加对测试的信心。相反，如果修改后的代码通过了测试，这表明存在测试缺陷。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-03-30T02:22:22.003

代码覆盖率没有问题——我看到的错误是 100% 的数字。在某些时候，收益递减定律开始发挥作用，测试最后 1% 的成本比测试其他 99% 的成本更高。代码覆盖率是一个有价值的目标，但常识还有很长的路要走。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-03-30T02:42:17.587

!00% 的代码覆盖率意味着经过良好测试的代码完全是一个神话。作为开发人员，我们知道系统的硬/复杂/精细部分，我更愿意看到这些区域经过适当测试，并且只获得 50% 的覆盖率，而不是每行至少运行一次的无意义数字。

就一个真实世界的例子而言，我所在的唯一一个覆盖率为 100% 的团队编写了一些我见过的最糟糕的代码。100% 的覆盖率被用来代替代码审查——结果可以预见的很糟糕，以至于大多数代码都被丢弃了，即使它通过了测试。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2009-03-30T02:51:43.757

我们有很好的工具来衡量单元测试的代码覆盖率。因此，依靠 100% 的代码覆盖率来表示您已经“完成测试”是很诱人的。这不是真的。

正如其他人所提到的，100% 的代码覆盖率并不能证明您已经进行了充分的测试，50% 的代码覆盖率也不一定意味着您没有进行充分的测试。

衡量测试执行的代码行数只是一个指标。您还必须测试各种合理的函数输入，以及函数或类的行为取决于其他一些外部状态。例如，某些代码的功能会根据数据库或文件中的数据而有所不同。

我最近也在博客上写过这个：http: [//karwin.blogspot.com/2009/02/unit-test-coverage.html](http://karwin.blogspot.com/2009/02/unit-test-coverage.html)

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2009-03-30T03:52:17.997

100% 的代码覆盖率并不意味着你已经完成了 usnit 测试

```
function int divide(int a, int b) {
    return a/b;
} 
```

只需 1 个单元测试，我就获得了 100% 的代码覆盖率：

```
return divide(4,2) == 2; 
```

现在，没有人会争辩说这个具有 100% 覆盖率的单元代码表明他的功能工作得很好。

我认为代码覆盖率是一个很好的元素，可以知道您是否缺少任何明显的代码路径，但我会小心使用它。

# security - 你怎么能加密用户数据，只有他们才能解密呢？

> ID：695813
> 
> 赞同：4
> 
> 时间：2009-03-30T02:06:22.837
> 
> 标签：security, cryptography

我正在考虑创建一个 Web 应用程序，它可以让人们输入文本（使用 SSL 连接），并在保存到数据库之前对其进行加密。目标是拥有它，以便只有用户才能解密它。

您可以让用户连同他们的数据一起输入密钥，并在他们想要查看数据时再次输入，而不是存储密钥。不过，这对用户来说会有点痛苦。

但是，如果您将密钥存储在服务器上，您就可以访问它并且可能会解密他们的数据。

我认为如果不让用户每次都输入密钥或存储密钥，就不可能做到这一点，但是有没有我没有想到的方法？就像可能从只有用户知道的信息中生成密钥一样？涉及cookies的东西？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-03-30T02:07:48.747

您应该研究[公钥密码学](http://en.wikipedia.org/wiki/Public-key_cryptography)。基本思想是，您可以使用只有私钥持有者才能解密的公钥来加密信息。在您的场景中，服务器将记录所有用户的公钥，并使用它们来加密信息。然后，您的用户将使用他们的私钥（服务器永远不会看到）来解密数据。

如果您正在寻找一种在客户端存储私钥的方法，您可以查看[PersistJS](http://pablotron.org/software/persist-js/)。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-30T02:13:32.227

听起来你可以使用 PGP 做一些事情。正如前一篇文章所提到的，您将拥有一个公钥和私钥。私钥可以通过密码来保护。这样您就可以将私钥潜在地存储在数据库中，因为它仍然需要密码才能使用它。

最大的问题是，如果用户忘记了该密码，他们可能会丢失该数据。您可以通过使用备用解密密钥 (ADK) 来解决这个问题。该密钥会自动与所有内容一起加密，并且可以在多个人之间拆分。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-30T03:04:13.400

从信息安全的角度来看，只有在用户的计算机而不是您的服务器上完成加密/解密时，这才有意义（因为不能保证您没有存储密钥和/或明文）。JavaScript 是不可能的，因此您需要一个客户端应用程序*。

此外，公钥密码学的计算成本很高。如果您有很多用户并决定在服务器上进行加密/解密，您可能需要记住这一点。

* 或 Java 小程序，但那是 90 年代。Silverlight 或 Flash 也可能会起作用。

# iphone - 如何解决 UITableView 中滚动缓慢的问题

> ID：695814
> 
> 赞同：8
> 
> 时间：2009-03-30T02:06:39.873
> 
> 标签：iphone, objective-c, performance

我是第一次在真实设备上进行测试，在修复了一些明显的性能问题之后，我一直在纠结如何平滑滚动。

这就是我所做的：

*   数据在 sqlite
*   我有一个带有标题的小数组
*   我在每个标题数组中都有来自 Db 的 ID 列表

例如

标题 A Ids= 1,2; 标题 B IDs= 3,4

*   我懒加载单元格和对象来获取数据
*   一次只能加载 10 个项目
*   加载速度很快，只有滚动是个问题

这是加载单元格的代码：

```
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath {
    static NSString *CellIdentifier = @"ProductCell";

    ProductCell *cell = (ProductCell *)[tableView dequeueReusableCellWithIdentifier:CellIdentifier];

    if (cell == nil) {
        NSArray *nib = [[NSBundle mainBundle] loadNibNamed:@"ProductCell" owner:self options:nil];

        cell = [nib objectAtIndex:0];
    }

    // Set up the cell...
    Product *p = [self locateRecord:indexPath]; 

    cell.nameLabel.text = [p.name capitalizedString];
    cell.codeLabel.text = p.ref;

    if ([self.selectedProducts objectForKey:[NSNumber numberWithInt:p.Id]]) {
        OrderDetail *d = [self findDetail:p];

        cell.qty.text = [NSString stringWithFormat:@"%ld",[d.qty integerValue]];
    }

    return cell;
}

- (id) locateRecord:(NSIndexPath *)indexPath {
    NSNumber *theId;
    NSUInteger pos = [indexPath row];

    id o;

    if (self.results) { 
        theId = [self.results objectAtIndex:pos];
    } else {
        NSString *key = [[self.index objectAtIndex:[indexPath section]] objectAtIndex:0];
        NSArray *data = [self.cache objectForKey:key];

        theId =  [data objectAtIndex:pos];
    }   

    Db *db= [Db currentDb];

    o = [db loadById:[self returnItemClass] theId:[theId intValue]];

    return o;
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-30T02:22:30.647

1.  预加载数据
2.  [做自己的画](http://blog.atebits.com/2008/12/fast-scrolling-in-tweetie-with-uitableview/)

# sql - 审计日志删除的最佳方法是什么？

> ID：695817
> 
> 赞同：1
> 
> 时间：2009-03-30T02:08:49.133
> 
> 标签：sql, logging, audit

连接字符串上的用户 ID 不是变量，并且与程序的用户 ID（例如可以是 GUID）不同。如果您的连接字符串的用户 ID 是静态的，您如何审核日志删除？

记录插入/更新/删除的最佳位置是通过触发器。但是使用静态连接字符串，很难记录谁删除了某些内容。有什么选择？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-30T03:39:18.153

使用 SQL Server，您可以使用 CONTEXT_INFO 将信息传递给触发器。

我在必须使用触发器的代码（由网络应用程序调用）中使用它（例如，表上的多个写入路径）。这是无法将我的逻辑放入存储过程的地方。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-30T18:12:05.917

我们也有类似的情况。我们的 Web 应用程序始终以相同的数据库用户身份运行，但使用不同的逻辑用户进行应用程序跟踪和控制。

我们通常将逻辑用户 ID 作为参数传入每个存储过程。要跟踪删除，我们一般不删除行，只需将状态标记为已删除，并相应地设置 LastChgID 和 LastChgDate 字段。对于重要的表，我们保留审计日志（每个更改状态的副本），我们使用上述方法，触发器将行复制到审计表，LastChgID 已正确设置，触发器无需担心关于获取身份证。

# c++ - 对于 NULL 指针，我应该使用 NULL 还是 0？

> ID：695823
> 
> 赞同：1
> 
> 时间：2009-03-30T02:14:38.467
> 
> 标签：c++, pointers, null

### 复制

> [你在 C++ 中使用 NULL 还是 0 作为指针？](https://stackoverflow.com/questions/176989/do-you-use-null-or-0-zero-for-pointers-in-c)

在处理`NULL`指针时，可以这样做

```
if(ptr != NULL){ ... }

or this

if(ptr != 0){ ... } 
```

是否有理由更喜欢其中的一个`C++`？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-03-30T02:15:57.743

使用`NULL`，因为它在*语义*上表明你的意思。

请记住，编程的目的不是告诉计算机要做什么。关键是告诉*其他人*你告诉计算机做什么。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-03-30T02:17:40.033

两者都行；所以将：

`if (ptr) { ... }`

显式检查 NULL 表明了 if 的意图，因此，我认为它有助于检查使用的可维护性：

`if (ptr != NULL) { ... }`

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-30T03:04:23.680

没关系。每个专业的程序员都会知道什么`ptr = 0`和`if( !ptr )`意味着什么，并且完全符合标准。所以，做你想做的事，但无论你做什么，总是做同样的事情。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-03-30T02:17:52.390

if(ptr != NULL) 比 if(ptr != 0) 读得更好。因此，虽然您可以使用后者节省 3 次击键，但如果您使用前者，您将帮助您的同事在阅读您的代码时保持理智。

# grails - 在 grails 中将视频文件转换为 .flv 格式

> ID：695831
> 
> 赞同：1
> 
> 时间：2009-03-30T02:19:11.107
> 
> 标签：grails, video

我正在 grails 中开发一个网络应用程序。我已经实现了视频的播放选项。为了播放视频，我使用了[flashplayer 插件](http://grails.org/FlashPlayer+Plugin)。它正在工作。现在我计划实现用户也可以上传他们的视频的功能。上传后视频文件如何将这些视频文件转换为 .flv 格式？

或者

Flash 播放器可以播放所有视频格式吗？我尝试使用 .wmv 文件。它不工作。

任何人都可以提供帮助吗？

谢谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-30T02:37:27.740

Flash 只能播放 FLV 和 h.264 编码的视频（例如 mp4、f4v）。[您可以使用FFmpeg](http://www.ffmpeg.org/)将视频转换为任何这些格式。如果您使用的是 Windows，您可以[在此处](http://ffmpeg.arrozcru.org/builds/)获取一些预构建的二进制文件。

应将 inputfile.avi 转换为音频比特率为 48kbps 和视频比特率为 224kbps 的 flv 的示例命令行（可能需要将 libmp3lame 替换为 mp3，具体取决于 ffmpeg 的版本）：

```
ffmpeg -i inputfile.avi -s 640x480 -y -f flv -acodec mp3 -ac 1 -ab 48k -b 224k -ar 22050 outputfile.flv 
```

h.264 / aac 示例：

```
ffmpeg -i inputfile.avi -s 640x480 -y -f mp4 -vcodec libx264 -acodec libfaac -ab 48k -b 224k -ar 22050 outputfile.mp4 
```

# .net - 在报告中包含未知数量的外部图像？

> ID：695832
> 
> 赞同：0
> 
> 时间：2009-03-30T02:19:34.180
> 
> 标签：.net, asp.net, reporting-services, reporting, rdlc

我正在构建一个需要包含照片的报告，我无法知道将拍摄多少张照片，但它们存储在以正在生成的报告 ID 命名的文件夹下的文件服务器上。我将如何将这些包含在 RDLC 中？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-30T06:44:41.203

如果您知道数量和文件名，在报告中包含图像很简单：[MSDN How to: Add an Image (Image Wizard)](http://msdn.microsoft.com/en-us/library/ms156388(SQL.90).aspx)

但是在您的情况下，如果您不知道应该显示多少图像，您可以选择：
- 将图像文件名保存在 DB 中并使用 sql 从报告中选择它们
或
- 创建 Web 服务以从目录中收集图像文件名并传递它在报告中作为数据源。[Reporting Services：使用 XML 和 Web 服务数据源](http://technet.microsoft.com/en-us/library/aa964129.aspx)

接下来在报告中使用表格或列表，将 Image 放在那里并将 url/path 设置为来自数据源字段的 Image。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-30T03:10:02.420

我是一个 PHP 人，所以我的答案需要过滤，但在 PHP 中，你会读取目录，然后查看目录中的每个文件，以确保它是适合包含的图像类型。

打开目录（）读取目录（）

和一个 for a while 循环来检查文件扩展名，以确保您只包含图像。

# java - 基于前提条件创建新实例的最佳方法

> ID：695841
> 
> 赞同：4
> 
> 时间：2009-03-30T02:28:26.280
> 
> 标签：java

你好我的问题是这个。假设您有一个定义转换器如何实现的接口。这个接口可以有一个方法 loadDocument() 和另一个 convert()。现在假设我们想要有多个转换器，ConvertHTML2DOC、ConvertXML2HTML 等，你明白了。

假设您获得了需要在 2 个字符串中转换的两种格式（无论您如何获得它们）。现在您需要创建转换器的实例并转换文档。

我的问题是哪个更好：实际创建一个详细的 if 语句或通过 Class 类的反射加载类？为了证明我写了一个小例子来说明我的意思。在我的示例中，我有 2 个类 P1 和 P2 共享一个接口。我还创建了 50000 个来显示速度差异。事实证明，普通调用稍微快一点，但我认为在我开始提到的复杂示例中，通过 Class 方法创建类的好处是更方便和更易于维护。你怎么认为？

```
import java.util.*;

public class Test {
  public static void main(String[] args) {
    try {
      Random r = new Random();
      Date test1start = new Date();
      for (int i = 0; i<= 50000; i++){
        Printable p = (Printable)Class.forName("P"+(r.nextInt(2)+1)).newInstance();
        System.out.println(p.getString());
      }
      Date test1stop = new Date();
      Date test2start = new Date();
      for (int i = 0; i<= 50000; i++){
        Printable p;
        if (r.nextInt(2) == 0 ) {
           p = new P1();
        } else {
          p = new P2();
        }
        System.out.println(p.getString());
      }
      Date test2stop = new Date();
      System.out.println("Test with 'Class' invocation took "+(test1stop.getTime()-test1start.getTime())+" milliseconds.");
      System.out.println("Test with 'normal' invocation took "+(test2stop.getTime()-test2start.getTime())+" milliseconds.");
    } catch (Exception e) {
    }
  }
}

interface Printable {
  public String getString();
}

class P1 implements Printable {
  public String getString(){
    return "1";
  }
}

class P2 implements Printable {
  public String getString(){
    return "2";
}
  } 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-30T03:58:26.953

你绝对应该听从哈维尔的建议——工厂登记是解决这个问题的正确方法。我过去曾多次以这种方式实现它，用于格式转换或其他一些基于可扩展“谓词”的工厂解决方案（例如，基于反射信息的自动 GUI 生成）。

然而，我建议对设计进行补充——引入所有翻译人员都针对的通用域模型 (CDM)。假设您有格式 A、B 和 C 并且需要支持每种格式之间的转换 - 您将获得所有排列：

*   A -> B
*   A -> C
*   B -> A
*   B -> C
*   C -> A
*   C -> B

随着格式数量的增加，您会得到爆炸式的转换！一个更好的主意是将每个转换分成两部分——我们称它为*importer*和*exporter*。导入器将格式转换为通用域模型 (CDM)，而导出器将 CDM 转换为某种格式。

例如，我们将 A 到 B 的转换分解为以下内容：

*   A --> CDM（这是一个导入）
*   CDM --> B（这是一个出口）

现在，当您想要添加新格式时，您只需要编写一个导入器和一个导出器，但您可以翻译到/从所有其他格式！谈论可扩展性！它还允许您可以读取但不能写入的格式，反之亦然。

因此，解决方案是建立一个进口工厂注册和一个出口工厂注册。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-30T03:36:37.940

绝对使用工厂方法；但不要使用“大`if`”或名称修饰，而是使用“类注册”方法。为此，工厂类维护一个表，每个具体类在其中注册它的条件（在您的情况下是源名称和目标名称）和构造函数（它是一个“条件->构造函数”字典）。工厂本身只是简单地构造字典键并获取它需要的构造函数。

一大优点是每个具体类都封装了它所解决的条件，你可以在不改变工厂方法的情况下添加更多。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-03-30T02:51:32.293

尝试这样的事情，编译时安全，使用 Class.forName 的单行性。

```
public class PrintableFactory
{
    public enum Type
    {
        HTML,
        DOC,
    }

    public static Printable getPrintable(final Type from, final Type to)
    {
        final Printable printable;

        if(from == HTML && to == DOC)
        {
            printable = new HtmlToDoc();
        }
        else if(from == DOC && to == HTML)
        {
            printable = new DocToHTML();
        }
        else
        {   
            // you decide if you want runtime or compile time exception handling
            // could also return numm but I don't like that myself.
            throw new ImpossibleConversionException(from, to);
        }

        return (printable);
    }
} 
```

# iphone - NSString 比较在 Objective-C 中不起作用

> ID：695843
> 
> 赞同：1
> 
> 时间：2009-03-30T02:30:33.577
> 
> 标签：iphone, objective-c, cocoa, cocoa-touch

以下是我试图在两个 NSString 值之间进行比较的 Objective-C 代码，但是它会引发运行时错误。这是代码：

```
NSDictionary *innerContent=[JSONResponseDict valueForKey:@"JSONRESPONSE"];
NSString *authFlag = [innerContent valueForKey:@"authenticationFlag"];

NSLog(@"authFlag = %@",authFlag);

UIAlertView *alert = [[UIAlertView alloc]
                      initWithTitle:nil
                      message: [NSString stringWithFormat:@"authenticationFlag = %@",authFlag]
                      delegate:self
                      cancelButtonTitle:@"OK"
                      otherButtonTitles:nil];
[alert show];
[alert release];

// This block is problematic
if ( [authFlag isEqualToString:@"1"]){
    NSLog(@"Logged in");
    self.view = homeView;
} else {
    NSLog(@"Not logged in");
} 
```

请注意，NSString authFlag 已被测试为确实具有有效的字符串值。authFlag 的值为“1”或“0”（它来自使用 json-framework 对 JSON 调用的响应）。

这是运行时错误：

```
[Session started at 2009-03-29 19:21:00 -0700.]
2009-03-29 19:21:11.186 taggle[4144:20b] userEmail=user@domain.com&password=opensesame
2009-03-29 19:21:11.653 taggle[4144:20b] authFlag = 1
2009-03-29 19:21:11.655 taggle[4144:20b] *** -[NSCFBoolean isEqualToString:]:       unrecognized selector sent to instance 0xa089c400
2009-03-29 19:21:11.661 taggle[4144:20b] *** Terminating app due to uncaught exception 'NSInvalidArgumentException', reason: '*** -[NSCFBoolean isEqualToString:]: unrecognized selector sent to instance 0xa089c400' 
```

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-03-30T02:36:46.197

如错误日志所示，authFlag 不是`NSString`，而是`NSCFBoolean`.

你可以这样做：

```
NSCFBoolean *authFlag = [innerContent valueForKey:@"authenticationFlag"];

if([authFlag boolValue]) {
    NSLog(@"Logged in");
    self.view = homeView;
} else {
    NSLog(@"Not logged in");
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-10-18T16:17:26.290

您的 authFlag 是 NSNumber 而不是 NSString。

NSCFBoolean 是 NSNumber 的私有子类。它属于类集群设计模式。

NSNumber 中没有名为 isEqualToString: 的方法。
这是修改后的代码。

```
NSNumber *authFlag = [innerContent valueForKey:@"authenticationFlag"];

if([authFlag boolValue]) {
    NSLog(@"Logged in");
    self.view = homeView;
} else {
    NSLog(@"Not logged in");
} 
```

# c# - 在 linq 不工作的 asp.net 中更新

> ID：695844
> 
> 赞同：0
> 
> 时间：2009-03-30T02:31:18.223
> 
> 标签：c#, .net, asp.net, linq, .net-3.5

我有一个奇怪的问题。我正在尝试使用 linq 更新某些字段，但它不起作用。我尝试构建该站点并对其进行调试，该站点可以正常工作并显示该函数已被调用。我还尝试在文件后面的代码中手动添加值，这也有效，但不知何故，在运行时，表单不会从文本字段传回值。

```
<%@ Page Language="C#" AutoEventWireup="true" CodeFile="AddEditBook1.aspx.cs" MasterPageFile="../AdminMaster.master" Inherits="AdminPanel_AddEditBook1" Title="Add or Edit Book Page"%>

<asp:Content ID="Content1" ContentPlaceHolderID="ContentPagePlaceHolder1" Runat="Server">
<div class="content"> 
    <div class="titleMain">Library -> Add or Edit Book Page
    </div>
    <h1><span></span>Add or Edit Book Page</h1>

    <div class="contentpage" >
        <p>On this page you can Add or Edit Book Page</p>

        <asp:Label ID="AddEditBookMsg" runat="server" Visible="false" />

            <table width="650"  class="table" cellspacing="15">
                <tr>
                    <td>Book ID</td>
                    <td><asp:Label ID="BookId" runat="server" /></td>
                </tr>
                <tr>
                    <td>Book name</td>
                    <td><asp:TextBox ID="BookName" runat="server" /></td>
                </tr>
                <tr>
                    <td>Author</td>
                    <td><asp:TextBox ID="BookAuthor" runat="server" Text="" /></td>
                </tr> 
```

代码：

```
using System;
using System.Collections;
using System.Configuration;
using System.Data;
using System.Linq;
using System.Web;
using System.Web.Security;
using System.Web.UI;
using System.Web.UI.HtmlControls;
using System.Web.UI.WebControls;
using System.Web.UI.WebControls.WebParts;
using System.Xml.Linq;

public partial class AdminPanel_AddEditBook1 : System.Web.UI.Page
{
    // book represents 3 tables
    protected void Page_Load(object sender, EventArgs e)
    {
        AddEditBookMsg.Visible = false;
        if (Request["book_id"] != null)
        {
            GetExistingBook();
        }
    }

    public void GetExistingBook()
    {
        BooksDataContext book = new BooksDataContext();
        int book_id = Int32.Parse(Request["book_id"].ToString());
        var bookexist = book.books.Single(b => b.book_id == book_id);
        var bookDDL = from c in book.categories
                      select c;
        var bookexistdesc = book.bookdescs.Single(bds => bds.book_id == book_id);
        if (bookexist.book_id == book_id)
        {
            BookName.Text = bookexist.book_name;
            BookAuthor.Text = bookexist.book_author;
            BookShortDesc.Text = bookexist.book_short_desc;
            BookLongDesc.Text = bookexistdesc.book_long_desc;
            BookImg.Text = bookexist.book_img;
            BookSqu.Text = bookexist.book_squ;
            BookArrived.Text = bookexist.book_arrived.ToString();
            BookQty.Text = bookexist.book_qty.ToString();

            if (!Page.IsPostBack)
            {
                CaID.DataSource = bookDDL;
                CaID.DataTextField = "ca_name";
                CaID.DataValueField = "ca_id";
                CaID.DataBind();
            }
        }
    }

    protected void update_Click(object sender, EventArgs e)
    {
        BooksDataContext book = new BooksDataContext();

        int book_id = Int32.Parse(Request["book_id"].ToString());
        book bookexist2 = book.books.Single(b1 => b1.book_id == book_id);
        bookdesc bookexistdesc2 = book.bookdescs.Single(bds1 => bds1.book_id == book_id);

        bookexist2.book_name = BookName.Text;
        bookexist2.book_author = BookAuthor.Text.ToString();
        bookexist2.book_short_desc = BookShortDesc.Text;

        bookexist2.book_img = BookImg.Text;
        bookexist2.book_squ = BookSqu.Text;
        bookexist2.book_arrived = DateTime.Parse(BookArrived.Text);
        bookexist2.book_qty = Int32.Parse(BookQty.Text);

        bookexistdesc2.book_long_desc = BookLongDesc.Text;
        book.SubmitChanges();
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-30T03:17:33.913

您忘记检查它是否是 Page_Load 中的回发。您也会在回发时从数据库重新加载...

```
if (!IsPostback())
{
  if (Request["book_id"] != null)
  {
    GetExistingBook();
  }
} 
```

# html - 如何在imagemap上实现标签弹出

> ID：695845
> 
> 赞同：0
> 
> 时间：2009-03-30T02:32:05.803
> 
> 标签：html, css

这是我第一次在 html 中使用 map 标签。我假设在我想要的图像上获取标签是“反复试验”

当用户将鼠标悬停在图像的“可点击”部分时，是否可以有一个工具提示类型标签？更酷的东西是漫画书风格的工具提示:)

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-30T03:06:20.477

```
<area .... title="koko" style="cursor: default;" /> 
```

你可以采用任何你想要的光标形状，只需谷歌“css cursor”。标题属性将为您提供该区域的小型浮动描述。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-30T03:07:10.243

给你 - 一些示例代码：

```
<map name="planetmap">
  <area shape="rect" coords="0,0,82,126" href="sun.htm" alt="Sun" />
  <area shape="circle" coords="90,58,3" href="mercur.htm" alt="Mercury" />
  <area shape="circle" coords="124,58,8" href="venus.htm" alt="Venus" />
</map> 
```

# java - Java 的浮点实现是否还有 Kahan 指出的问题？

> ID：695846
> 
> 赞同：6
> 
> 时间：2009-03-30T02:33:31.273
> 
> 标签：java, floating-point

今晚我阅读了 Kahan 的几篇论文，以及他对 Java的[著名咆哮。](http://www.cs.berkeley.edu/~wkahan/JAVAhurt.pdf)在我深入研究 JVM 规范之前，自从这方面最初的咆哮以来有什么变化吗？例如：

*   设置舍入模式
*   访问标志
*   免费获得更高的精度
*   ... ?

谢谢，

尼科。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-30T07:08:25.107

Kahan 教授的学生 Joe Darcy 成为 Sun 的“浮点沙皇”。他的博客文章[“一切旧的都是新的”](https://blogs.oracle.com/darcy/entry/everything_old_is_new_again)，是了解更多关于他为纠正问题所做的工作的切入点。已经有了很大的改进。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-30T05:58:15.260

我的猜测是它们仍然有效，因为自 98 年以来我在这方面没有看到太大的变化。

但是，即使今天添加它们，我也不确定它们是否真的会被大量使用。许多语言都支持可变精度算术（Java 也是如此），这似乎是解决此类问题的更好方法。例如 BigInteger、BigDecimal。

# java - 在 MVEL 中格式化 orb 标签

> ID：695848
> 
> 赞同：1
> 
> 时间：2009-03-30T02:33:40.870
> 
> 标签：java, templates, el, mvel

如何去除 MVEL 2.0 模板结果中由@code{}、@if{}、@foreach{}、@end{} 等或标签生成的空白行？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-30T22:08:42.743

如果您不希望标签前后有空格，则不要在前后使用 CR：

例如：项目：@foreach{item : stuff}@{item}@{','}

如果将其分成多行，则会保留空格。

# c# - 您网站上的 Ventrilo 状态

> ID：695849
> 
> 赞同：0
> 
> 时间：2009-03-30T02:34:06.857
> 
> 标签：c#, php, asp.net

我正在寻找一些示例，说明如何在您的网站上显示 ventrilo 服务器的状态。我想要的是能够显示谁登录以及他们登录的频道。我找到了您可以购买的网站，但希望找到开源或免费的解决方案。

如果还没有解决方案，请提供一些有关如何在 php 或 c#/asp.net 中完成此操作的信息，因为我确实有两个选项可用。

编辑：现在，我真的很想知道这是如何完成的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-30T02:46:26.547

Ventrilo 自己提供了一些 PHP 服务器状态脚本，您可以在此基础上构建：

[http://www.ventrilo.com/dlprod.php?id=201](http://www.ventrilo.com/dlprod.php?id=201)

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2017-04-24T11:44:17.123

可用于任何语言的 REST API，不仅是 C# 或 PHP [http://tools.cleanvoice.ru/ventrilostatus](http://tools.cleanvoice.ru/ventrilostatus)

它以 CVP 格式返回数据[https://wiki.mumble.info/wiki/Channel_Viewer_Protocol](https://wiki.mumble.info/wiki/Channel_Viewer_Protocol)

### Javascript 示例（基于[http://mumble-widget.guildbit.com](http://mumble-widget.guildbit.com)）

[https://jsfiddle.net/obbwgLu1/](https://jsfiddle.net/obbwgLu1/)

### PHP 示例

```
<?php

$address = "";
$port = 3784;
$api_url = "https://api.cleanvoice.ru/ventrilo/?address={$address}&port={$port}";

if ( $response = @file_get_contents($api_url) )
{
    if ( $json = json_decode($response) )
    {
        if (isset($json->error))
        {
            echo $json->message;
        }
        else
        {
            echo render_cvp_channel($json->root);
        }
    }
}

function render_cvp_channel($channel)
{
    // display channel name
    $html = sprintf("<b>%s</b>", $channel->name);
    $html .= '<ul>';

    // display users
    foreach ($channel->users as $u)
    {
        $html .= sprintf("<li><i>%s</i></li>", $u->name);
    }

    // display subchannels
    foreach ($channel->channels as $c)
    {
        $html .= render_cvp_channel($c);
    }
    $html .= '</ul>';

    return $html;
}

?> 
```

[![在此处输入图像描述](https://i.stack.imgur.com/5nHmd.png)](https://i.stack.imgur.com/5nHmd.png)

# php - 使用动作脚本获取 IP 地址？

> ID：695854
> 
> 赞同：6
> 
> 时间：2009-03-30T02:36:53.030
> 
> 标签：php, actionscript-3, actionscript, ip-address

是否可以通过 Flash (swf) Action Script 3 获取客户端 IP 地址，然后将其传递给 php 文件以将其存储在数据库中？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-30T02:54:20.600

无需在 Flash 中执行，只需在您的服务器上执行 php "$ip=@$REMOTE_ADDR;"

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-30T02:46:10.013

不，客户端 IP 地址在 ActionScript 3 中不可用。推荐的方法是让它反映在服务器端代码中。

见[http://www.actionscript.org/forums/showthread.php3?s=&threadid=20123](http://www.actionscript.org/forums/showthread.php3?s=&threadid=20123)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-08-25T17:48:29.713

```
function GetUserIP() {
    var js="function get_userIP(){return java.net.InetAddress.getLocalHost().getHostAddress();}";
    var userIPInfo:String=ExternalInterface.call(js).toString();
    return userIPInfo;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-30T02:44:23.277

据我所知是的！但我想知道这样做的原因。您可以只使用 PHP 获取 IP 地址..

编辑：进行了研究..改变了我的答案。我认为用 Flash 做的可能性较小..

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-30T03:06:00.823

像上面的答案一样，使用 PHP（或其他脚本语言）将 IP 地址作为参数值传递到您的 flash 电影中，您将在运行时使用它。

另一种选择是使用 ExternalInterface 调用服务器端 PHP 脚本或类似的东西以返回 IP 地址。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-30T12:03:57.893

正如 Alex 所说，通过 flashvars 传递它，但 PHP 应该是：

```
$_SERVER['REMOTE_ADDR'] 
```

json 扩展对于写出 flash 变量很方便，例如用于传递给 swfobject：

```
var flashvars = { IP : <?=json_encode($_SERVER['REMOTE_ADDR'])?> }; 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2010-09-13T17:48:40.667

可以通过 Flash Actionscript 获取真实 IP 地址。

访问此网站后您会相信（点击 Flash 标签）：

[http://AnalyzeMy.net](http://AnalyzeMy.net)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2013-07-05T10:30:38.020

尽管大多数人都在说 - 以某种方式存在差异。我曾经经营过一个相当大的论坛（200k+），大多数被禁止的成员最终在进入我们的聊天室后再次被抓获（Flash）。虽然 VB 软件（使用 php）会提供一个 IP（通常通过代理/网络），但 Chat (Flash) 实际上会给我们他们的真实 IP。不要让我解释它 - 我自己几乎没有使用 PHP ......

# oop - 我应该根据范式还是根据语言提供的工具来设计我的软件？

> ID：695865
> 
> 赞同：1
> 
> 时间：2009-03-30T02:45:54.490
> 
> 标签：oop, procedural-programming

我将通过示例来解释这个问题：在 zend 框架中，当您想向视图类添加功能时，可以使用所谓的 Helper 类。
辅助类是具有一个方法（与类名相同）的类，该方法在每个视图中都可用（通过反射，辅助方法由视图方法包装）
它非常有条理和干净，但是，这意味着额外包括每个这样的助手和一些玩反射。这两件事对性能都有影响。

我的想法不是为每个要添加到视图中的方法开发一个 Helper（每个方法都在不同的文件中），而是编写一个带有 C 样式函数列表的助手（即不是类静态方法，实际函数），它可以是仅在 View 类中使用（因为 View 助手仅包含在 View 中）。

因此，这是将一些程序与 OO 混合，但性能优势是可见的，无论如何，帮助程序是通常不需要维护状态的单一方法......

有人会说：“所以用程序化，性能更好”，不，我很清楚 OO 的好处，除了这件小事，
那么，我应该坚持单一范式还是混合它们？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-30T03:28:09.880

首先：OOP 是结构化编程的一个子集，它是过程的一个子集，所以你并没有像你暗示的那样走得那么“范式”。（“范式”，多么丑陋和过度使用的词）

第二：OOP，是一种设计风格，不是语言特性。只要您维护（概念）封装，使用函数而不是方法不会使您的程序减少 OOP。

第三：即使是PHP中最多的OOP代码也必须在某种程度上使用内置函数。因此，几乎按照定义，使用函数不能是“反 OOP”。

第四：是的，OOP 是目前最好的设计风格之一，但“忠于愿景”没有任何优点。毕竟，它们都是您工具箱中的工具。如果您选择的语言的 OOP 结构无法提供您对这个特定实例的需求，那么请使用其他技巧使其工作。如果您担心代码的可维护性（谁不担心？），那么将“hacky”部分封装在对象呈现的接口内，这样它就不会泄漏。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-30T03:58:31.787

回答您的问题的唯一方法是为每个设计决策提供优缺点。

通常，当状态控制参与最少时，**程序设计**是最好的，对于无状态处理，一次性数据转换。程序处理的例子有：各种数学函数、字符串转换、数组转换、直接内存访问等。

虽然**OOP**非常适合状态控制。将 OOP 用于 UI 元素（数百万个教科书示例）、套接字编程（打开、侦听、关闭、其他状态）之类的事情非常棒，协议实现也受益匪浅。任何涉及*多个实例*和*状态机*的东西都能完美地实现。

因此，一种常见的做法是将用于简单处理的一次性函数与类中的复杂状态控制混合。类中的方法将使用函数进行内部数据处理。

一起破解某些东西可能适用于短暂的非生产代码。但是在多次升级之后，您最终可能会为您的代码寻找意大利面条酱。与临时编码相反，对代码进行深思熟虑的设计总是好的。

另一个方面是**框架中的常见做法**。如果 zend 框架中的一种常见做法是混合实现（OOP 和用于简单转换的函数式），那么没有理由不这样做。如果不是，最好坚持使用一种方法，否则您将面临可维护性问题，其他人将不得不花费数小时和数天来理解您的代码。

也有必要探索做任何事情的每一个**技术限制：**

*   如果涉及编译器（而不是解释器）和链接，请确保那里没有问题
*   如果您的代码被拆分为模块（库），请务必检查混合内容不会破坏兼容性
*   如果存在性能问题，请量化它们；一旦你这样做了，决定可能会变得更容易
*   做许多测试应用程序来验证您的选择 - 意外崩溃、缓慢启动/停止、数据损坏、跳过箍来完成任务，所有这些都表明选择不是最佳选择。知道*为什么和知道**什么*一样重要。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-30T03:53:47.917

您应该根据您的非功能性需求进行设计。例如，如果吞吐量是您的目标，那么您应该选择性能路径。但是，如果可维护性是您的目标，也许您应该让您的代码更具可读性，而不是放入所有不可读的性能优化代码。

框架给你留下空间来决定事情。OOP 本身只是一个概念。因此，恕我直言，在 OO 程序中使用 C 风格的函数并不是一种罪过。如果合适，那就去吧。

# asp.net-mvc - REST Url 结构 - 资源 ID 可以在控制器之前吗？

> ID：695872
> 
> 赞同：1
> 
> 时间：2009-03-30T02:52:38.263
> 
> 标签：asp.net-mvc, model-view-controller, url, rest, friendly-url

ASP.NET MVC（以及一般的 MVC）的标准模板似乎是*{controller}/{action}/{id}*，但是，在我目前正在从事的项目中，我不确定这是否合适结构体。例如，如果我有一个控制汽车的应用程序，对我来说，拥有以下结构对我来说更有意义：

```
 {car-rego}/{controller}/{action}/{data etc} 
```

这对我来说很有意义，因为汽车（由车牌识别）是我们正在对其执行操作的资源，并且功能的逻辑分离被分离为控制器和操作。这将导致 URL 如下：

```
/ESX-121/Power/On
/ESX-121/Speed/Set/100
/ESX-121/Speed/Current -- get the current speed (could be /ESX-121/Speed also)
/ESX-121/Turn/Left
/ESX-121/Speed/Set/90
/ESX-121/Power/Off 
```

如果这遵循默认模式，它将如下所示：

```
/Power/On/ESX-121
/Speed/Set/ESX-121/100
/Speed/Current/ESX-121 -- get the current speed (could be /Speed/ESX-121 also)
/Turn/Left/ESX-121
/Speed/Set/ESX-121/90
/Power/Off/ESX-121 
```

对我来说，就可读 URL 而言，第一个选项更有意义，并且资源标识符位于一个恒定的逻辑位置。例如*/Speed/Set/ESX-121/100*向我建议有一个标识符为 ESX-121 的速度类型的资源，但事实并非如此，操作是在汽车上进行的。

对于此类情况，您如何构建 URL 以及相关的控制器和操作？您认为这是一个可以接受的解决方案，还是有更好的方法来构建它？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-30T03:25:01.090

从“哲学”的角度来看，这是一个大问题。

您似乎对几乎所有事情都使用 GET 请求，例如设置速度。REST 背后的想法是，对 ESX-121 资源的访问可以为您提供其当前状态的表示，在您的情况下，它的速度、方向、是否开启等。

在其 URL 上发布汽车的一些表示将有效地改变其当前状态。（例如，如果您使用 XML 表示，您可以发布

```
<car><id>ESX-121</id><speed>100</speed><car> 
```

改变它的速度。在 ASP.net MVC 下，您将为此发布一个表单。

您正在尝试做的是将 SOAP 服务建模方式（面向操作或动词）应用于 REST 服务，这并不是真正的想法。

可能很难“获得” REST 的做事方式，并且它可能与您在使用 SOAP 服务时所做的一切背道而驰，但牢记这些原则很重要。

从理论上讲，您的 URL 描述了一个资源，唯一可用的操作是通过 GET（读取）、POST（创建）、PUT（创建或更新）、DELETE（删除）进行。

编辑：感谢 marxidad 纠正我每个动词应该映射到的内容。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-30T07:03:29.877

除了上面帖子中指出的评论之外，我认为稍微改变一下结构是完全可以的。（但不要使用 GET 来更新数据，如上所述）

以 CMS 为例，您经常会看到以下结构：

`{controller}/{id}/{action}`
或
`pages/about_the_company` （显示操作是默认操作）
`pages/about_the_company/edit`（GET 将显示编辑页面，而 POST 将执行更新）

当然，在 CMS 中，控制器会默认设置为，`pages`因此 url 会更短。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-30T07:21:26.963

REST 不是关于拥有干净的 URI，而是关于将正确的语义附加到 HTTP 方法 GET、POST、PUT 和 DELETE。

GET 应该只用于安全的幂等操作，POST 应该用于创建或处理，PUT 应该用于更新现有资源，DELETE 用于（嗯）删除资源。

如果需要，您可以使用带有大量“？和 &”参数的丑陋 URI，同时仍然可以开始 RESTful。

现在关于您的 URI，虽然第二个选项看起来不错，但它是一种使用非英语语言编写“普通英语”的方法。一开始这听起来可能是个好主意，但使 URI 具有可读性背后​​的主要思想是客户端可以使用它们并发现新功能。这就是为什么在 URI 中保留站点/应用程序的树结构总是一个更好的主意。

有关该主题的更多信息，请参阅[Jacob Nielsen 的关于 URL 作为 UI 的警报框。](http://www.useit.com/alertbox/990321.html)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-07-20T22:42:10.480

如果您定义任何类型的 URI 命名结构，例如“{car-rego}/{controller}/{action}/{data etc}”，那么您的 API 不是 REST。它只是 RPC。您不能将 URI 或 URI 命名约定定义为 REST API 的一部分——它直接违反了 RESTful 架构的约束之一。

有关详细信息，请参阅[http://roy.gbiv.com/untangled/2008/rest-apis-must-be-hypertext-driven](http://roy.gbiv.com/untangled/2008/rest-apis-must-be-hypertext-driven)。

# javascript - onblur ajax没有调用回调函数

> ID：695874
> 
> 赞同：1
> 
> 时间：2009-03-30T02:53:43.520
> 
> 标签：javascript, jquery, ajax, events

我有以下称为内联的代码，如下所示。问题是警报永远不会触发。在萤火虫中，我可以看到我的对象填充了数据，但警报仍然没有触发。有任何想法吗？

```
function update(s_arrive) {
    $.post("../base/getDestInfo.asp", { "dest": s_arrive }, function(data) { alert('aa'); }, "json");
}

<input type='text' name="box" onblur="update('AUS');" /> 
```

**更新：** 确实有效的一件事是，如果我使请求同步，那么它就会触发。

**更新 2：** IE 8 和 Chrome 按预期工作。Firefox 然而......不是那么多。

**更新3：** 重新启动Firefox后它工作。非常非常非常奇怪。结束项目。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-10-23T12:41:06.337

再次尝试删除分号。它有时对我有用。

```
<input type='text' name="box" onblur="update('AUS')" /> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-30T05:47:57.767

有时，如果您在进入 firebird 调试器时刷新页面，脚本会在该选项卡中停止，我经常不得不在另一个选项卡中打开该页面。

# asp.net-mvc - 视图模型应该是具有自己存储库的聚合吗？

> ID：695876
> 
> 赞同：0
> 
> 时间：2009-03-30T02:54:21.567
> 
> 标签：asp.net-mvc, repository, aggregate

是否应该通过对单个存储库的单个调用来完全定义将传递给视图的模型。换句话说，模型是单个聚合，还是我的模型应该由单独的聚合构建，每个聚合都有自己的存储库，在服务层？

我现在拥有它的方式是，我只需调用一个存储库来填充整个模型，然后由 View 呈现。似乎聚合、存储库和模型都变成了同一个概念。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-30T13:04:54.563

我的意思是“以上都不是”。我更喜欢对视图使用表示模型，并且表示模型不需要存储库。这是由许多原因造成的：

*   使用表示模型允许您在设计模型和数据库之前设计视图和控制器。因此，您可以及早获得用户输入。
*   演示模型允许您将一个相当“扁平”的模型传递给视图，因此您无需担心诸如延迟加载之类的 ORM 问题。
*   表示模型通常会简化模型绑定。
*   使用演示模型时，您不必担心意外返回某个用户不应该看到的字段，或者意外更新不应允许用户更新的字段，因为您没有得到正确的白名单。

现在，更具体地说，遵循您的问题：您是否构建了演示模型的实例？需要多少个存储库？好吧，这个问题现在几乎可以回答了。您设计表示模型以遵循视图的要求。您按照良好的 TDD 实践设计存储库，包括识别聚合根。现在“我需要多少个存储库来实例化这个模型”的问题很简单。您检查模型所需的聚合根，并使用您需要的那些。通常，我可以在单个 LINQ 查询中执行此操作。

# console-application - C# 控制台应用程序 - 保持运行

> ID：695877
> 
> 赞同：12
> 
> 时间：2009-03-30T02:55:42.000
> 
> 标签：console-application, keep-alive

我即将开发一个控制台应用程序，它需要在特定时间持续运行和执行工作。

我的问题是让您的应用程序保持活力的最佳方法或实践是什么？

我的想法是：一个永无止境的循环？一个定时器，它会在需要时（在设定的睡眠期之后）休眠然后跳转到例行程序？

我会将应用程序编译成 exe，然后使用 AlwaysUp 将其作为服务运行。

问候..

彼得

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-03-30T03:02:16.387

更好的解决方案是编写一个控制台应用程序来完成它的工作并退出。然后，您可以使用 Windows 任务计划程序定期运行它。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-03-30T02:58:32.587

为什么不首先将您的应用程序构建为服务？

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2015-12-04T23:33:05.147

虽然您确实应该为此使用服务，但如果您需要/想要这样做，您可以使用 a`ManualResetEvent`来执行此操作：

```
private ManualResetEvent Wait = new ManualResetEvent(false); 
```

当您完成“开始”并只想等待时，您将执行以下操作：

```
Wait.WaitOne(); 
```

当您想停止并让它退出时，您可以执行以下操作：

```
Wait.Set(); 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-03-30T03:01:12.050

您可能不想只是在循环中旋转而不必要地消耗处理器时间。

假设您在 Windows 上，您应该有一个循环，该循环永远不会以调用 WaitForSingleObject() 或 WaitForMultipleObjects() 或 MsgWaitForMultipleObjects() 结束，具体取决于您的需要。然后有一些同步对象可以唤醒你，比如命名事件。

[请参阅此处](http://msdn.microsoft.com/en-us/library/ms686360(VS.85).aspx)的 Win32 同步文档。如果您详细说明您的程序需要做什么，我们可能会提供更具体的建议。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2013-03-04T22:26:27.277

您可以添加引用`System.Windows.Forms`并调用`System.Windows.Forms.Application.Run()`以开始标准应用程序消息循环。 `Ctrl-C`将终止应用程序。

另一种选择是用于`Console.ReadKey()`暂停应用程序。喜欢`Console.WriteLine("Press [ANY] key to quit..."); Console.ReadKey();`

这就是我在控制台应用程序中使用的，当它们只是坐在那里等待事件发生时。在任何一种情况下，应用程序都将继续运行并捕获触发事件（例如来自计时器、WCF、FileWatcher 等）。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-03-30T03:00:35.377

持续运行的代码称为守护程序， [此处](http://social.msdn.microsoft.com/Forums/en-US/csharpgeneral/thread/2079f76b-3f44-42e8-9dfe-e08301ce1d93/)有一篇文章概述了如何执行您所要求的操作。这将为您提供一个如何在[此处](http://www.codeproject.com/KB/dotnet/simplewindowsservice.aspx)编写简单服务的示例。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-03-30T03:02:05.807

如果您的程序将持续运行，那么您应该休眠直到所需的事件发生（例如 XX 秒过去）。如果您只是在 while {} 循环中旋转，您将占用 CPU 时间。

如果您的程序将始终在机器上运行，那么您应该考虑将其设置为服务，以便它与机器一起自动启动和停止。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-03-30T03:02:01.550

好吧，我确定它应该在某个时候停止，不是吗？

如果您希望它也可以作为控制台应用程序运行，请生成一个可以工作的线程，并在 Console.ReadLine() 上设置主线程块。

如果您真的只想永远暂停主线程，只需阻止您永远不会触发的 ManualResetEvent。

但是，如果可以，请考虑使用服务。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-03-30T04:01:20.893

如果您构建一个桌面应用程序，您会希望它在系统托盘中运行。这将

1.  防止您的用户意外关闭应用程序
2.  让您的应用程序不会弄乱用户的屏幕

如果您构建一个服务器应用程序，您将需要编写一个 Windows 服务。这将

1.  防止管理员意外关闭您的应用程序
2.  无需服务器让某人登录控制台以运行您的应用程序

作为一个主要是 IT 专业人士的人，我会说我们获得的第 3 方应用程序作为控制台应用程序而不是 Windows 服务运行，我们付出了很多努力来防止被购买。它为我们创造了很多工作，并带来了重大的支持问题和安全漏洞。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2011-10-25T10:17:27.003

发送线程休眠：System.Threading.Thread.Sleep(10000);

等待按键被按下： Console.WriteLine("Press any key to continue..."); Console.Read();

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2019-01-11T22:08:33.147

创建一个任务，然后等待它。

```
class Program
{
    static void Main(string[] args)
    {
        var processTask = Process();
        processTask.Wait();
    }

    private static async Task Process()
    {
        var isNotCancelled = true;

        while (isNotCancelled)
        {
            //Polling time here
            await Task.Delay(1000);

            //TODO: Do work here and listen for cancel
            Console.WriteLine("I did  some work...");
        }
    }
} 
```

# c# - 实体框架通用存储库错误

> ID：695878
> 
> 赞同：12
> 
> 时间：2009-03-30T02:57:55.817
> 
> 标签：c#, entity-framework, generics, repository-pattern

我正在尝试为我的实体框架存储库创建一个非常通用的泛型存储库，该存储库具有基本的 CRUD 语句并使用接口。我先撞到了砖墙头，然后被撞倒了。这是我的代码，在控制台应用程序中编写，使用实体框架模型，带有一个名为 Hurl 的表。只是试图通过其 ID 拉回对象。这是完整的应用程序代码。

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Data.Objects;
using System.Linq.Expressions;
using System.Reflection;
using System.Data.Objects.DataClasses;

namespace GenericsPlay
{
    class Program
    {
        static void Main(string[] args)
        {
            var hs = new HurlRepository(new hurladminEntity());
            var hurl = hs.Load<Hurl>(h => h.Id == 1);
            Console.Write(hurl.ShortUrl);
            Console.ReadLine();

        }
    }

    public interface IHurlRepository
    {
        T Load<T>(Expression<Func<T, bool>> expression);
    }

    public class HurlRepository : IHurlRepository, IDisposable 
    {

        private ObjectContext _objectContext;

        public HurlRepository(ObjectContext objectContext)
        {
            _objectContext = objectContext;
        }

        public ObjectContext ObjectContext
        {
            get
            {
                return _objectContext;
            }
        }

        private Type GetBaseType(Type type)
        {
            Type baseType = type.BaseType;
            if (baseType != null && baseType != typeof(EntityObject))
            {
                return GetBaseType(type.BaseType);
            }
            return type;
        }

        private bool HasBaseType(Type type, out Type baseType)
        {
            Type originalType = type.GetType();
            baseType = GetBaseType(type);
            return baseType != originalType;
        }

        public IQueryable<T> GetQuery<T>()
        {
            Type baseType;
            if (HasBaseType(typeof(T), out baseType))
            {
                return this.ObjectContext.CreateQuery<T>("[" + baseType.Name.ToString() + "]").OfType<T>();
            }
            else
            {
                return this.ObjectContext.CreateQuery<T>("[" + typeof(T).Name.ToString() + "]");
            }
        }

        public T Load<T>(Expression<Func<T, bool>> whereCondition)
        {
            return this.GetQuery<T>().Where(whereCondition).First(); 
        }

        public void Dispose()
        {
            if (_objectContext != null)
            {
                _objectContext.Dispose();
            }
        }
    }

} 
```

这是我得到的错误：

```
 System.Data.EntitySqlException was unhandled
  Message="'Hurl' could not be resolved in the current scope or context. Make sure that all referenced variables are in scope, that required schemas are loaded, and that namespaces are referenced correctly., near escaped identifier, line 3, column 1."
  Source="System.Data.Entity"
  Column=1
  ErrorContext="escaped identifier"
  ErrorDescription="'Hurl' could not be resolved in the current scope or context. Make sure that all referenced variables are in scope, that required schemas are loaded, and that namespaces are referenced correctly." 
```

这是我试图从中提取此信息的地方。

[http://blog.keithpatton.com/2008/05/29/Polymorphic+Repository+For+ADONet+Entity+Framework.aspx](http://blog.keithpatton.com/2008/05/29/Polymorphic+Repository+For+ADONet+Entity+Framework.aspx)

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-30T18:10:24.237

Well, this one had me puzzled. I took a wild stab (after seeing a portion of the EFRepository in Stephen Walther's upcoming ASP.NET MVC Unleashed book) and it started working, here is the fix (Replace this method, notice the difference in the string formatting). Any suggestions as to why this is this way? The way that I see this, it may be a bug (or maybe something I was doing). At any rate for any of those interested. (I would imagine fixing this portion will fix the entire function of the EFRepository @ [Keith Patton's blog post](http://blog.keithpatton.com/2008/05/29/Polymorphic+Repository+For+ADONet+Entity+Framework.aspx)).

```
public IQueryable<T> GetQuery<T>()
{
    Type baseType;
    if (HasBaseType(typeof(T), out baseType))
    {
        return this.ObjectContext.CreateQuery<T>(String.Format("[{0}]", baseType.Name.ToString())).OfType<T>();
    }
    else
    {
        return this.ObjectContext.CreateQuery<T>(String.Format("[{0}]", typeof(T).Name.ToString()));
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-05-09T02:41:51.210

Here is another good one:
[http://blog.zoolutions.se/post/2010/04/05/Generic-Repository-for-Entity-Framework-for-Pluralized-Entity-Set.aspx](http://blog.zoolutions.se/post/2010/04/05/Generic-Repository-for-Entity-Framework-for-Pluralized-Entity-Set.aspx)

# internet-explorer - 仅在 IE8 中存在的与 https 相关的问题（不存在任何其他浏览器）

> ID：695879
> 
> 赞同：1
> 
> 时间：2009-03-30T02:58:08.687
> 
> 标签：internet-explorer

我有一个网站，其中有一些 javascript 代码可以动态加载到从 ASP.net 2.0 服务器上的 .ashx 文件生成的顶部导航中。

如果网页不使用 https，它在所有浏览器中都可以正常工作。但是，如果网页使用 https 作为协议，顶部导航在除 IE8 之外的所有浏览器（IE6、IE7、FF、Google Chrome、Safari）中都可以正常工作。顶部导航在 IE8 中消失。

有谁知道是什么导致了这个问题以及如何解决它？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-30T03:19:18.387

我找到了导致问题的原因。

顶部导航是从非 ssl .ashx 文件加载的，
例如[http://www.example.com/ex1/example.ashx](http://www.example.com/ex1/example.ashx)。

所有其他浏览器都可以正常工作，但 IE8 需要在加载 .ashx 文件时使用 https（由于安全问题？），
即[https://www.example.com/ex1/example.ashx](https://www.example.com/ex1/example.ashx)

# c# - 在多个显示器上绘制所有窗口

> ID：695897
> 
> 赞同：5
> 
> 时间：2009-03-30T03:07:53.737
> 
> 标签：c#, gdi+, desktop

我正在使用以下代码在单个显示器上绘图：

```
Point cursorLocation;
NativeMethods.GetCursorPos(out cursorLocation);
Screen screen = Screen.FromPoint(cursorLocation);

Point h1 = new Point(screen.Bounds.Left, cursorLocation.Y);
Point h2 = new Point(screen.Bounds.Right, cursorLocation.Y);
Point v1 = new Point(cursorLocation.X, screen.Bounds.Top);
Point v2 = new Point(cursorLocation.X, screen.Bounds.Bottom);

using (Graphics graphics = Graphics.FromHwnd(NativeMethods.GetDesktopWindow())) {
    NativeMethods.SHChangeNotify(0x8000000, 0x1000, IntPtr.Zero, IntPtr.Zero);
    graphics.DrawLine(Pens.Red, h1, h2);
    graphics.DrawLine(Pens.Red, v1, v2);
} 
```

*理论上*，这*应该* 在任一监视器上使用。但是，它只利用初级。所以，为了解决这个问题，我得到了所有显示器的 DC 并尝试这样做。

 *```
IntPtr hdc = NativeMethods.CreateDC("DISPLAY", IntPtr.Zero, IntPtr.Zero, IntPtr.Zero);
Graphics graphics = Graphics.FromHdc(hdc);
graphics.DrawLine(Pens.Red, h1, h2);
graphics.DrawLine(Pens.Red, v1, v2);
graphics.Dispose();
NativeMethods.ReleaseDC(IntPtr.Zero, hdc); 
```

去想，这甚至根本没有绘制到屏幕上。我已经为 CreateDC 尝试了各种重载，并搜索了 SO 和其他资源，但我很难过。

* * *

一旦解决了这个问题，任何人都知道如何通过使用 SHCHangeNotify 刷新桌面来消除闪烁？我只画了两条线，它像疯了一样闪烁..)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-30T03:13:23.867

这对我有用。我使用 EnumDisplayDevices 来获取名称。

```
[DllImport("gdi32.dll")]
public static extern IntPtr CreateDC(string lpszDriver, string lpszDevice, string lpszOutput, IntPtr lpInitData);

var hdc = CreateDC(@"\\.\DISPLAY1", "", "", IntPtr.Zero);
Graphics g = Graphics.FromHdc(hdc);
var pt = Cursor.Position;
g.DrawEllipse(Pens.BlueViolet, pt.X - 100, pt.Y - 100, 200, 200); 
```

更多信息在这里：http: [//msdn.microsoft.com/en-us/library/windows/desktop/dd145179 (v=vs.85).aspx](http://msdn.microsoft.com/en-us/library/windows/desktop/dd145179(v=vs.85).aspx)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-30T08:59:40.877

这不是您问题的答案，但如果您对此没有任何问题，我建议您尝试使用 WPF 来解决这个问题。我玩过其他类型的桌面交互，如透明度，与 GDI 替代方案相比，WPF 速度快如闪电。

您放置您的 wpf 应用程序并调整其​​大小以适合您需要在其上绘制的所有区域。然后将其设置为透明，并确保它的点击（我认为这是 100% 透明度的默认设置）。这样，只要您在这个大的 WPF 画布/表单上没有任何东西，所有鼠标事件都会点击到桌面。

然后开始在上面画画。（我喜欢它，因为它很容易为线条和图像添加效果）。保证不闪退。

或者，您可以在普通 Windows 窗体上使用相同的方案。

这样您就不必求助于 GDI 来完成您的工作。

我认为，当您现在接近它时，您能够做到这一点的唯一方法是连接到桌面 WM_PAINT 上的窗口消息并在那里完成您的工作。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-31T02:06:35.217

不幸的是，由于以下原因，这两个答案都没有任何帮助：

我仅限于 Windows 窗体，因为这是为 WF 构建的基础框架。我已经尝试过 TransparencyKey/Form 技巧，仍然闪烁太多。

我认真地尝试了近十种不同的方法，甚至我在 Google 中搜索 DirectX/Direct3D、C# Desktop Hooks 和其他方法的结果都无济于事。

我要做的就是画一个横跨整个桌面的十字准线，1px x 1px ..肯定有人必须有一些例子来说明如何在不闪烁和良好性能的情况下做到这一点：？D3D、DX、GDI 还是其他？:\

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-30T05:15:11.697

在第一部分无法提供帮助。我假设您正在 Paint 事件中绘制线条。使用双缓冲来消除闪烁。

# c# - 排序列表 使用查询表达式

> ID：695906
> 
> 赞同：13
> 
> 时间：2009-03-30T03:18:07.377
> 
> 标签：c#, linq, sorting, expression

我在使用 Linq 订购这样的结构时遇到问题：

```
public class Person
{
    public int ID { get; set; }
    public List<PersonAttribute> Attributes { get; set; }
}

public class PersonAttribute
{
    public int ID { get; set; }
    public string Name { get; set; }
    public string Value { get; set; }
} 
```

一个人可能会这样：

```
PersonAttribute Age = new PersonAttribute { ID = 8, Name = "Age", Value = "32" };
PersonAttribute FirstName = new PersonAttribute { ID = 9, Name = "FirstName", Value = "Rebecca" };
PersonAttribute LastName = new PersonAttribute { ID = 10, Name = "LastName", Value = "Johnson" };
PersonAttribute Gender = new PersonAttribute { ID = 11, Name = "Gender", Value = "Female" }; 
```

我想使用 LINQ 投影按我选择的人员属性升序对人员列表进行排序，例如，按年龄排序，或按名字排序。

我正在尝试类似的东西

```
string mySortAttribute = "Age"
PersonList.OrderBy(p => p.PersonAttribute.Find(s => s.Name == mySortAttribute).Value); 
```

但是语法让我失望。有什么线索吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-03-30T06:17:41.517

`OrderBy`是产生新序列的 LINQ 扩展。要订购现有序列，您需要添加一个或两个扩展方法......然后您可以使用：

```
PersonList.Sort(p => p.Attributes.Find(
  s => s.Name == mySortAttribute).Value);

public static class ListExtensions {
  public static void Sort<TSource, TValue>(
    this List<TSource> source,
    Func<TSource, TValue> selector)
  {
    var comparer = Comparer<TValue>.Default;
    source.Sort((x, y) => comparer.Compare(selector(x), selector(y)));
  }
  public  static void SortDescending<TSource, TValue>(
    this List<TSource> source,
    Func<TSource, TValue> selector)
  {
    var comparer = Comparer<TValue>.Default;
    source.Sort((x, y) => comparer.Compare(selector(y), selector(x)));
  }
} 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2010-04-22T15:32:47.473

我知道这是一篇旧帖子，但我想我会发布一个我不久前找到的比较器，以防其他人需要它。

```
public class GenericComparer<T> : IComparer<T>
 {
     public string SortExpression { get; set; }
     public int SortDirection { get; set; } // 0:Ascending, 1:Descending

     public GenericComparer(string sortExpression, int sortDirection)
     {
         this.SortExpression = sortExpression;
         this.SortDirection = sortDirection;
     }
     public GenericComparer() { }

     #region IComparer<T> Members
     public int Compare(T x, T y)
     {
         PropertyInfo propertyInfo = typeof(T).GetProperty(SortExpression);
         IComparable obj1 = (IComparable)propertyInfo.GetValue(x, null);
         IComparable obj2 = (IComparable)propertyInfo.GetValue(y, null);

         if (SortDirection == 0)
         {
             return obj1.CompareTo(obj2);
         }
         else return obj2.CompareTo(obj1);
     }
     #endregion
 } 
```

**用法**

```
List<MyObject> objectList = GetObjects(); /* from your repository or whatever */
objectList.Sort(new GenericComparer<MyObject>("ObjectPropertyName", (int)SortDirection.Descending));
dropdown.DataSource = objectList;
dropdown.DataBind(); 
```

您可以重载构造函数以接受 SortDirection 枚举。我没有这样做，因为该类在没有引用 System.Web 的库中。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-03-30T03:28:21.313

为什么不使用键值字典而不是 List<PersonAttribute> ？我认为它会更适合，并使其他一切变得更容易。

更新 - 像这样：

```
public class Person
{
  public Dictionary<string, string> Attributes = new Dictionary<string,string>();
}

List<Person> people = new List<Person>();

Person rebecca = new Person();
rebecca.Attributes["Age"] = "32";
rebecca.Attributes["FirstName"] = "Rebecca";
rebecca.Attributes["LastName"] = "Johnson";
rebecca.Attributes["Gender"] = "Female";
people.Add(rebecca);

var PeopleInAgeOrder = people.OrderBy(p => p.Attributes["Age"]); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-30T05:39:45.743

这是假设 Attribute 类实现 IComparable 或有一个很好的 ToString 函数（我希望）。

```
var list = personList.OrderBy(p => p.Attributes.FirstOrDefault(a => a.Name == "Age")) 
```

否则语法会变得更加复杂：

```
var list = personList
            .OrderBy(p => 
                     p.Attributes.FirstOrDefault(a => a.Name == "Age") == null ?
                     "" : p.Attributes.First(a => a.Name == "Age").Value
            ); 
```

我还假设每个键都有一个值 - 否则你需要更智能的代码...... ;-)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-30T03:42:29.050

会不会是你的语法错误？您的属性称为属性，但您在代码中使用称为 ObjectSettings 的东西？或者这是一个错字。

如果是，那么您的代码看起来不错，除非并非所有 Person 实例都具有您尝试排序的属性，在这种情况下您会遇到异常。

编辑：另外，不要使用 Find，而是尝试使用 First。

```
PersonList.OrderBy(p => p.Attributes.First(a => a.Name == "Age").Value) 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-30T04:01:59.220

我想你会遇到一个异常，其中一个项目没有年龄属性。我尝试了下面的代码，它运行良好 - 正如其他海报所指出的那样，我猜你的数据有点不对劲。无论如何，下面的工作正常......

```
 List<Person> personList = new List<Person>();
    Random rand = new Random();

    //generate 50 random persons
    for (int i = 0; i < 50; i++)
    {
        Person p = new Person();
        p.Attributes = new List<PersonAttribute>();
        p.Attributes.Add(new PersonAttribute() { ID = 8, Name = "Age", Value = rand.Next(0, 100).ToString() });
        p.Attributes.Add(new PersonAttribute() { ID = 10, Name = "Name", Value = rand.Next(0, 100).ToString() });
        personList.Add(p);
    }

    var finalList = personList.OrderBy(c => c.Attributes.Find(a => a.Name == "Age").Value).ToList(); 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2010-04-23T08:13:43.130

您需要考虑的一些情况：

*   由于您的属性在字符串中，“30”和“3”的年龄将在“4”之前排序
*   该属性可能不存在

如果您创建此扩展方法类：

```
public static class ListExtenstions
{
    public static List<Person> OrderList(this List<Person> list, string attributeName, PersonAttribute defaultAttribute)
    {
        return OrderList(list, attributeName, defaultAttribute, x => x);
    }

    public static List<Person> OrderList<T>(this List<Person> list, string attributeName, PersonAttribute defaultAttribute, Func<string, T> convertion)
    {
        return list.OrderBy(x => convertion((x.Attributes.FirstOrDefault(y => y.Name == attributeName) ?? defaultAttribute).Value)).ToList();

        // Query Syntax
        //return
        //    (from p in list
        //     let attribute = p.Attributes.FirstOrDefault(a => a.Name == attributeName) ?? defaultAttribute
        //     orderby attribute.Value
        //     select p).ToList();
    }
} 
```

然后，您可以按以下方式正确排序列表：

```
List<Person> persons = ...
...
PersonAttribute defaultAttribute = new PersonAttribute() { Value = "0" };
var ordered = persons.OrderList("Age", defaultAttribute, x => Convert.ToInt32(x)); 
```

这将给出正确的排序顺序。如果该属性将始终存在，您可以删除`defaultAttribute`.

要对“名称”进行排序，只需使用：

```
List<Person> persons = ...
...
PersonAttribute defaultAttribute = new PersonAttribute() { Value = String.Empty };
var ordered persons.OrderList("Name", defaultAttribute); 
```

# iphone - iPhone 上 URL 中 NSString 字符无效的问题

> ID：695911
> 
> 赞同：5
> 
> 时间：2009-03-30T03:21:43.547
> 
> 标签：iphone, url, nsstring

我的一些 http 请求在 URL 中有“空格”，但 iPhone 无法识别。只要网址中有“空格”，我就必须将“空格”更改为“%20”。现在我必须将用户输入的消息发送到服务器，它可以有尽可能多的“空格”，就像用户喜欢的那样。看来我必须全部替换它们。（stringByReplacingOccurrencesOfString）

Convert 'space' to '%20' 是我偶尔发现的。我的问题是 NSString 中的哪些其他字符不能被 iPhone 上的 url 直接使用？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-03-30T03:35:18.350

我认为这是一种更好的方法：

```
NSString* escapedUrl = [originalUrl   
stringByAddingPercentEscapesUsingEncoding:NSUTF8StringEncoding]; 
```

如果您想了解 URL 编码的工作原理，请查看此[URL](http://www.w3schools.com/TAGS/ref_urlencode.asp)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-30T03:41:28.677

有关完整的详细信息，请参阅[RFC 2396](https://www.rfc-editor.org/rfc/rfc2396)。以下字符必须转义：

```
控制字符（ASCII 00-1F 和 7F）
空间
<
>
#
%
"

```

不转义就使用以下字符是不明智的，因为已知某些网关和其他传输代理有时会修改此类字符，或者将它们用作分隔符：

`{ } | \ ^ [ ] ``

# c# - 关闭 C# Windows 窗体的问题

> ID：695916
> 
> 赞同：1
> 
> 时间：2009-03-30T03:26:05.877
> 
> 标签：c#, winforms

我在关闭 C# Windows 窗体应用程序时遇到问题。它目前只会给我一个没有标题或任何东西的空白表格。**我需要找到一种方法来关闭这个未知的小窗口。**

我有 2 个表单页面，一个用于登录屏幕，一个用于实际应用程序。全部由 program.cs 文件运行。

**程序.cs**

```
...
static void Main()
{
    Application.EnableVisualStyles();
    Application.SetCompatibleTextRenderingDefault(false);
    Application.Run(new PROG1());
} 
```

这只是 Visual Studio 创建的用于运行我的程序的基本主程序。

然后我们有主程序

**PROG1.cs**

```
...
public PROG1()
{
    Login LoginForm = new Login();
    DialogResult a = LoginForm.ShowDialog();

    if(LoginForm.ValidLogin == 1) {
        InitializeComponent();
    } else {
        Application.Exit(); //FAIL
    }
} 
```

您可以看到第一个 program.cs 文件调用了 PROG1.cs，它调用了 login.cs 的一个实例。如果您插入有效的登录，登录页面将关闭，主 PROG1 将按原样显示。但是，如果您只是单击红色 X 关闭登录表单，它会出现 Prog1 和 LoginForm.ValidLogin != 1，因此它不会初始化表单并将尝试关闭表单。这只会给我留下未初始化的表格，而不是关闭它。如果我改为使用 this.close() ，它会给我一个运行时错误。

有任何想法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-30T03:37:46.907

将 InitializeComponent 调用放回到原来的顶部。尝试使用未初始化的变量，包括试图告诉它们关闭自己，是一个坏主意。

配置 PROG1 表单的属性，以便隐藏而不是显示初始状态。LoginForm 返回后，您的 PROG1 代码可以决定是显示自己还是关闭自己。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-30T03:37:58.047

您没有在失败时初始化表单的原因是因为 InitializeComponent() 方法的内容需要很长时间才能运行吗？看来您应该将程序简化为：

```
static void Main()
{
    Application.EnableVisualStyles();
    Application.SetCompatibleTextRenderingDefault(false);

    LoginForm login = new LoginForm();

    if (login.ShowDialog() == DialogResult.OK &&
        login.ValidLogin == 1)
    Application.Run(new PROG1());
} 
```

并从 PROG1 的构造函数中删除逻辑。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-30T03:37:15.803

你不应该在构造函数中做这样的事情。

要么有一个新的输入表单，显示很少或什么都不显示，并在`Load`事件或`Load`主表单上显示事件的登录表单。如果您显示模态对话框，他们将无法访问您的父表单，如果他们无法登录，您可以关闭父表单。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-30T03:40:56.603

我会推荐 Samuel 建议的最佳实践。但是，如果您想要一些快速的东西，请尝试将登录逻辑移动到 Visual Studio 生成的 Main：

在 Program.cs 中

```
 [STAThread]
    static void Main()
    {
        Application.EnableVisualStyles();
        Application.SetCompatibleTextRenderingDefault(false);

        Form2 login = new Form2();
        if (login.ShowDialog() == DialogResult.Yes)
        {
            Application.Run(new Form1());
        }
    } 
```

在 Form2.cs 中

```
 private void button1_Click(object sender, EventArgs e)
    {
        this.DialogResult = DialogResult.No;
        this.Close();
    }

    private void button2_Click(object sender, EventArgs e)
    {
        this.DialogResult = DialogResult.Yes;
        this.Close();
    } 
```

# nhibernate - 使用 Critera 查询时仅检索特定列？

> ID：695917
> 
> 赞同：19
> 
> 时间：2009-03-30T03:26:47.027
> 
> 标签：nhibernate

我正在为我公司正在做的一个项目推荐 NHibernate，我想知道 NHibernate 是否可以优化为在使用 Criteria 查询语言时仅检索表上的特定列。

例如。假设我有一个包含 30 列的表，它使用 NHibernate 映射到一个对象，该对象是与表的一对一匹配。但是，对于系统的特定功能，我只关心其中的两列。

现在，我知道我可以使用 HQL 并执行`CreateQuery`此操作，但这需要我为我想有选择地检索的每个字段组合创建一个构造函数。从维护的角度来看，这可能是一个巨大的痛苦，因为直到运行时我才会发现丢失的构造函数。

我喜欢 Criteria 查询语言，因为它生成参数化 SQL 而不是来自 HQL 的直接 SQL 查询。我看到有一个“排除”模型不包括某些列，但在大多数情况下，我将包含比排除更多的列。

感谢下面的评论，我研究了预测，这对我来说仍然不是理想的情况。使用以下内容时：

```
var list = session
    .CreateCriteria(typeof (Task))
    .SetProjection(Projections
                       .ProjectionList()
                       .Add(Projections.Property("Id")))
    .List(); 
```

我最终得到的变量`list`只是整数，我希望拥有完整的 Task 对象，但所有字段都设置为默认值。这甚至可能吗？到目前为止，我所看到的一切都说不。

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2009-03-30T04:46:17.087

是的，您可以通过使用投影来使用标准查询来做到这一点。只需投影您希望使用的属性，并且只有那些将包含在已编译查询的 select 子句中。

[http://nhibernate.info/doc/nh/en/index.html#querycriteria-projection](http://nhibernate.info/doc/nh/en/index.html#querycriteria-projection)

**更新以编辑**

有几种方法可以做到这一点，但是有一些限制。1）NHibernate方式。

```
var list = session.CreateCriteria(typeof (Task))
.SetProjection(Projections.ProjectionList()
                   .Add(Projections.Property("Name"), "Name")
                   .Add(Projections.Property("ID"), "ID")
)
.SetResultTransformer(Transformers.AliasToBean(typeof (Task)))
.List(); 
```

只需将属性名称作为别名分配给您的投影，AliasToBean 转换器就会将这些投影映射到实际类。此方法的限制是您映射的任何属性都必须在 POCO 类中有一个 setter，这可以是一个受保护的 setter，但它必须有一个 setter。

您也可以使用 linq 以稍微不同的方式执行此操作

```
var list = session.CreateCriteria(typeof (Task))
.SetProjection(Projections.ProjectionList()
                   .Add(Projections.Property("Name"))
                   .Add(Projections.Property("ID"))
)
.List<IList>()
.Select(l => new Task() {Name = (string) l[0], ID = (Guid) l[1]}); 
```

这只是使用 linq 将输出的索引列表映射到 Task 类的新实例中。与上述相同的限制适用，只是这有点更严格，因为映射的所有属性都必须有一个公共设置器，因为这是 linq 用来填充对象的。

我希望这可以帮助你。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-30T15:36:28.477

回应您的编辑：据我所知，这是不可能的。

但是，您可以做的是创建一个 NHibernate 已知的类，并且只包含您感兴趣的属性。

例如，“TaskView”类只包含“Task”类的某些属性。
您必须在 hbm.xml 文件中“导入”TaskView 类，以便 NHibernate 知道该类（参见导入映射）。
然后，您可以使用 Projection 将“任务”转换为 TaskView 实例。当您查看 NHibernate 生成的查询时，您会发现它只会检索填充 TaskView 类所需的列。

我在这里也发布过类似的东西： [NHibernate and Collection Counts](https://stackoverflow.com/questions/532483/nhibernate-and-collection-counts)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-30T15:31:21.093

我不确定这是否适合您的目的，但这只是一个建议：如果查询最终成为您*始终*使用的东西，您可以为其创建一个 SQL 视图，然后针对该视图创建一个映射文件。

NHibernate 将像对待任何表一样对待视图，当然 CRUD 操作相对于数据完整性问题来说是一个问题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-07-19T17:34:17.503

您是否尝试过设置默认构造函数来设置默认值？由于这是应用程序方面的问题，因此由您来解决。顺便说一句，为什么每个排列都需要一个构造函数？Hibernate 将使用全参数构造函数或无参数构造函数，然后使用 setter，因此无需完成所有这些工作。实际上，如果我没记错的话，它可以做的还不止这些，如果通过字节码操作魔法正确配置，它甚至可以设置所有私有字段而没有设置器。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2014-04-06T17:49:07.010

I asked a similar question and NHibernate seems to lack the most common feature used by applications since the creation of SQL. The ability to select only some columns. This is really corny and if I had been on the project I would of refused any logic that requires you to jump through a hoop and upside down and all around just to select only fields. Even if there is an answer to it I find hours of research just too complicated for something so simple. I know its available in Nhibernate's linq provider using projection but for extremely complex queries it is not possible so select only specific fields. Either all of them or you must start creating DTOs/Models that are not the original ones which in my view should not have to be duplicated because a user just wants less records. An exclusion/inclusion list for regular sql based queries (not linq) is a must. I wish these ORMs would just do the most basic things first. Simply ignore filling in the model if the fields are not returned in the result set from the database. I hope someone can give a simple solution/hack/workaround.

# language-agnostic - 有没有什么解决方案可以知道两个没有详细内容比较的pdf的相似性

> ID：695925
> 
> 赞同：3
> 
> 时间：2009-03-30T03:34:58.553
> 
> 标签：language-agnostic, pdf, similarity

我想知道两个 pdf 文件的相似性，但我不想做详细内容比较。仅从其外部结构是否有任何解决方案。有可能吗？谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-30T04:13:05.577

这听起来可能很困难，但这里是 PDF 元数据中的一些容易获得的成果，按难度排序。

1.  文档元数据，例如`eBook-title`和`Title`
2.  文档中的页数（计数`/Page`指令）
3.  比较每个页面的元数据，例如`MediaBox`, `CropBox`, `BleedBox`,`TrimBox`
4.  查找图像和文档特定字体等嵌入内容，看看它们是否完美匹配。
5.  提取纯文本并比较单词：字数、最常用的单词等。对于西方语言，您可以像`strings`在 Linux 上一样通过字符串查找器运行 PDF。或者您可以进入文件并找到`(blah blah blah) Tj`，这是大多数文本在 PDF 内容中的存储方式。

最后，您可以通过使用 GhostScript 或其他库将它们转换为光栅格式，然后以这种方式进行比较来作弊。如果您转换为像 100 像素这样的低分辨率，那么粗略的细节可能看起来很相似。

如果您从未直接使用过 PDF，那并不可怕！它只是一个文本文件（在解压缩后），您可以或多或少地逐行解析。我在[HTML 文档中更多地讨论 PDF 到 PDF](https://stackoverflow.com/questions/514170/html-document-to-pdf/688957#688957)的答案。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-30T03:50:52.337

您可以通过对它们运行哈希（如 md5）来判断两个文件是否不同，但这不会告诉您它们之间的相似程度。

有一些二进制差异程序可以告诉您两个二进制文件的不同之处并得到合理的结果，但是许多二进制文件，尤其是文档容器，在只有很小的内部内容差异时会显示出很多二进制差异。

我不熟悉pdf格式的细节。也许其他人知道可能有帮助的内置机制。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-30T07:34:58.507

PDF 不仅仅是一个文本文件。它是 B 树的二进制转储。使用压缩对象，您还可以将对象数据压缩在其他二进制对象中，这样您就看不到它们了。

如果你想做低级的文本操作，你真的需要使用一个像样的工具。Acrobat 9.0 有一个菜单选项来浏览内部 PDF 结构，或者您可以使用 IText 之类的东西。

# c# - nHibernate，不存在具有给定标识符的行

> ID：695931
> 
> 赞同：51
> 
> 时间：2009-03-30T03:37:21.700
> 
> 标签：c#, nhibernate, nhibernate-mapping

我有一个沿着这条线的映射。

```
<hibernate-mapping xmlns="urn:nhibernate-mapping-2.2" namespace="Model.Entities" schema="etl" assembly="Model" default-lazy="false">
  <class name="Model.Entities.DataField, Model" table="mdm_field">
    <id name="FieldId" column="field_id" type="int">
      <generator class="native" />
    </id>
    <many-to-one name="KeyField" class="Model.Entities.Key, Model" column="field_id" />
  </class>
</hibernate-mapping> 
```

现在在数据库中，mdm_field 表中的 field_id 有时具有相关 key_field 表中不存在的值，因此它基本上破坏了参照完整性。因此，当我加载实体时，出现错误“不存在具有给定标识符的行”。如何配置映射以适应这种情况，这样它就不会在这种情况下死掉。

* * *

## 回答 #1

> 赞同：81
> 
> 时间：2009-03-30T03:46:27.013

好的，我找到了答案。添加

```
not-found="ignore" 
```

属性的属性`KeyField`：

```
<many-to-one name="KeyField" not-found="ignore" class="Model.Entities.Key, Model" column="field_id" /> 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-06-27T11:04:28.093

在我的情况下，问题是因为 MyISAM 引擎没有强制执行外键约束，因此其中一行最终指向一个不存在的值，并且代理抛出了异常。在这种情况下，我建议检查您的数据集是否一致。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2014-11-05T17:36:06.433

试试那个...

```
public void Override(ModelMapper modelMapper) {
    modelMapper.Class<T>(c => { 
        c.ManyToOne(m => m.FKObj, r => {
            r.Column("FKColumn");
            r.NotFound(NotFoundMode.Ignore); // THIS IS IMPORTANT!!!
        });
    });
} 
```

# entity-framework - 实体和对象之间有区别吗？

> ID：695934
> 
> 赞同：21
> 
> 时间：2009-03-30T03:38:28.247
> 
> 标签：entity-framework, object

实体和对象这两个术语有区别吗？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-03-30T03:45:43.300

一般来说，*实体*是一个抽象概念，通常由数据库模式中的表表示。术语*对象*通常是指内存中的数据结构。表示实体的对象可以称为*实体对象*（通常映射到数据库表中的一行），即它是*实体类*的实例（通常映射到表）。

在 .NET Framework (3.5 SP1)中**，*实体*是 EDM（实体数据模型）实例的一部分**，并映射到一个或多个表中的行。例如，可以是可以映射到单个*Customer数据库表的**Customer* **实体类型**，也可以扩展到*CustomerPreferences*表。使用 EntityProvider，您可以使用 eSQL 访问实体，就好像它们只是数据库表中的行一样。EDM 模型也称为*概念层*。

 *****在 EDM 模型之上还有一个称为*对象层***的层，其中实体被具体化为 EDM 映射的对象。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2015-10-06T06:39:43.427

**实体**是本身存在的东西，实际上或潜在地，具体或抽象，物理或不存在。它不必是物质存在的。

在计算机科学中，**对象**是内存中具有值并可能由标识符引用的位置。

# php - 在会员站点中实现 PHP 聊天

> ID：695944
> 
> 赞同：0
> 
> 时间：2009-03-30T03:43:30.810
> 
> 标签：php, chat, lamp

我有一个会员网站，我想将聊天添加到（专用盒子上的 LAMP）。它不需要太复杂，但必须使用已经登录的成员的用户名进行聊天。

这对我来说是一个副项目，所以如果可能的话，我宁愿不从头开始编写它，并且现有的脚本或类将是理想的。我做了一些搜索，似乎确实倾向于 JSON/Ajax，但我找不到任何确定的东西。

任何提示/指针？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-30T05:21:00.670

这里有两个项目可能对您有所帮助（均基于 AJAX/JSON）：

*   [jQuery Ajax Chat plugin](http://plugins.jquery.com/project/chat) - 一个简单、轻量级的 jQuery 插件。没有花里胡哨，但它可以完成工作。

*   [Ajax IM](http://www.ajaxim.com/) - 一个成熟的 Web 应用程序，它试图模拟桌面 IM 客户端所期望的所有功能。相当大的下载大小（324KB 压缩）。

我目前在我的一个项目中使用第一个作为基本的 IM 系统。我能够使用每个用户的系统凭据来实现它（因为他们已经登录到系统 - 而不是让他们选择自己的昵称）。该示例包括由 AJAX 轮询的脚本的 PHP 源代码。它工作得很好。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-30T04:54:34.710

构建基于网站的聊天系统通常采用三种方法。

1.  **Java 小程序解决方案**- 查找或构建与聊天服务器通信的 Java 小程序。小程序可以是 IRC 客户端，也可以是带有自定义服务器的定制聊天客户端。我什至看到一些网站使用 Java 小程序作为通信前端，其中界面全部由浏览器中的 Javascript 和 HTML 运行，但 Javascript 发送和接受来自小程序的事件以运行聊天。

2.  **AJAX** Post/Poll - 每次用户写入消息时，将消息发送到 HTTP 服务器，所有连接的用户都会定期轮询新消息。

3.  **[Comet](http://en.wikipedia.org/wiki/Comet_(programming))** - 主要使用 Javascript，每个客户端与 HTTP 服务器建立长期连接，然后空闲。当从用户发送消息时，它是通过已经预先存在的连接发送的。而不是轮询他们，来自其他用户的新消息只是沿着同一个连接流动。

就个人而言，我发现第 3 个选项是最令人兴奋的，但也是最复杂的。您可能需要构建自己的 HTTP 服务器版本来支持 Comet 所需的长期连接。而且由于 TCP/IP 中的套接字描述符有 16 位限制，因此您的服务器上每个 IP 将被限制为大约 64K 套接字。（请记住，每个客户端都需要一个打开的套接字！）最后，构建 Comet 客户端代码的技术在浏览器之间存在很大差异。为此存在一些框架，但您必须在新浏览器出现时维护它们。

如果您正在运行一个小型网站，并且您想面对一个可以克服的挑战，那么只需使用 AJAX 轮询。这很有趣，不会太难，而且你会学到很多东西。如果您不介意，那就找一个 Java 小程序。一旦配置了匹配的服务器，您就不必担心维护它，因为该解决方案与客户端非常无关。当然，它要求在客户端上安装 Java 运行时环境，但这并不总是正确的......

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-30T03:56:03.353

使用 AJAX 将聊天帖子发送到服务器并定期将更改加载到聊天框（Prototype 有一个很好的功能来执行此操作，它将检查服务器是否有更新的数据（ajax 定期更新程序））。根据您对“不那么复杂”的规范，这几乎是最基本的。

哦，是的，如果您希望将聊天消息保存在数据库中，请*确保*您保护自己免受 SQL 注入。

# jquery - jQuery更改事件触发器

> ID：695946
> 
> 赞同：0
> 
> 时间：2009-03-30T03:44:22.510
> 
> 标签：jquery, input, internet-explorer-6

我有一个问题需要 JQuery 的帮助。JQuery 给我的输入以增加使用大小写更改。编码：

```
#(".inp").bind("change",function (){
  if(isNaN(this.value)){
    this.value = 0;
  }
} 
```

当我第一次输入字符时，发生了大小写更改，输入值更改为 0 但是当我第二次输入**相同**的字符时，不会发生更改。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-30T13:24:35.483

来自[jQuery 文档](http://docs.jquery.com/Events/change#fn)：

> 当控件失去输入焦点并且其值在获得焦点后已被修改时，将触发 change 事件。

所以，它只发射了一次。这就是为什么你有你得到的行为。我会使用[KeyDown 事件](http://docs.jquery.com/Events/keydown#fn)，因为

> keydown 事件在键盘上的某个键被按下时触发。

要使用此事件，您必须执行以下操作：

```
$('.inp').keydown(function(event){
  switch (event.keyCode) {
    // ...
    // different keys do different things
    // Different browsers provide different codes
    // see here for details: http://unixpapa.com/js/key.html    
    // ...
  }
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-30T03:58:22.193

看起来您可能想要使用 keypress 事件，而不是 change 事件。

# java - Java中变量或方法的最大名称长度

> ID：695951
> 
> 赞同：44
> 
> 时间：2009-03-30T03:50:12.667
> 
> 标签：java, naming, specifications, name-length

Java 中的类/方法/变量名称是否有最大长度？JLS似乎没有提到这一点。从代码可读性和可维护性的角度来看，我知道很长的名称无论如何都是有问题的，但是出于好奇，存在一个限制（我猜类名可能受到文件系统最大文件名限制的限制）。

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2009-03-30T03:53:16.200

如果我没记错的话，限制不在语言本身，而是在类文件格式中，它将名称限制为 64k，因此对于所有实际意图和目的而言，标识符长度不是问题。具体来说，这是池中常量字符串的定义，似乎暗示最大长度为 16 位：

```
CONSTANT_Utf8_info {
    u1 tag;
    u2 length;
    u1 bytes[length];
} 
```

类名可能是文件系统的更多问题，我同意，我不确定当前支持什么。

* * *

## 回答 #2

> 赞同：27
> 
> 时间：2009-03-30T03:54:37.243

JLS： [标识符是Java 字母和Java 数字的无限长度序列，其中第一个必须是Java 字母。](https://docs.oracle.com/javase/specs/jls/se15/html/jls-3.html#jls-3.8)

还发现了类似的问题（虽然它没有出现在我的初始搜索中，或者当我输入奇怪的问题标题时）：[Maximum Method Name Length](https://stackoverflow.com/questions/425988/maximum-method-name-length)

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2009-03-30T05:30:43.610

如果您超过了 VM 对方法名称施加的大小限制，那么您会收到编译器错误（至少对于我正在使用的 javac 版本）：

> Main.java:1：字符串“aaaaaaaaaaaaaaaaaa...”的 UTF8 表示对于常量池来说太长了

# sql-server - 处理大于 8000 个字符的 VARCHAR 变量

> ID：695952
> 
> 赞同：3
> 
> 时间：2009-03-30T03:50:40.467
> 
> 标签：sql-server

我在创建电子邮件正文的 SQL Server 2005 数据库上有一个存储过程。此过程的结果必须放在一个表中，该表具有消息正文的 TEXT 字段以供以后处理。

我遇到的问题是在某些情况下要生成的电子邮件大于 8000 个字符。所以我不能在 TEXT 变量中构建消息正文，因为 SQL Server 不允许 TEXT 类型的变量。我可以将电子邮件的各个部分累积到一个表变量中，但这样做并不能解决问题，因为我无法将这些电子邮件部分一起附加到一个变量中以插入到结果表中。

有没有办法 (1) 操作内存中大于 8000 的实体，或者 (2) 有办法让我将（临时）表字段中的值累积到文本字段中？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-30T04:09:45.037

您可以使用 SQL 2005 中的 NVARCHAR(max) 或 VARCHAR(max) 数据类型来完成此操作。

> 大值数据类型的行为与其较小的对应数据类型 varchar、nvarchar 和 varbinary 相似。这种相似性使 SQL Server 能够更有效地存储和检索大字符、Unicode 和二进制数据。
> 
> 使用大值数据类型，您可以使用 SQL Server 使用 SQL Server 早期版本中的 text、ntext 和 image 数据类型无法实现的方式。您可以定义可存储大量数据、最多 2^31 字节的字符、二进制和 Unicode 数据的变量。

[http://msdn.microsoft.com/en-us/library/ms178158.aspx](http://msdn.microsoft.com/en-us/library/ms178158.aspx)

# c++ - c++ 基于键盘输入的退出循环

> ID：695960
> 
> 赞同：1
> 
> 时间：2009-03-30T03:54:53.543
> 
> 标签：c++, loops

是否可以根据键盘输入退出 C++ 循环，而不必每次迭代都输入内容？

例如

```
while(checkkeyboardinput != 'q')
   {
     do work
   } 
```

我觉得这很容易，但谷歌并没有帮助我，我不记得如何做到这一点。谢谢您的帮助。

编辑：我正在使用 VS2008

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-30T04:00:25.217

试试 _kbhit()。据我所知，它会检查缓冲区中是否有任何键盘输入等待。

[http://msdn.microsoft.com/en-us/library/58w7c94c%28VS.80%29.aspx](http://msdn.microsoft.com/en-us/library/58w7c94c%28VS.80%29.aspx)

> _kbhit
> 
> 检查控制台的键盘输入。
> 
> int _kbhit（无效）；
> 
> **返回值**
> 
> 如果某个键被按下，_kbhit 返回一个非零值。否则，它返回 0。
> 
> **评论**
> 
> _kbhit 函数检查控制台是否有最近的击键。如果函数返回非零值，则表示缓冲区中正在等待击键。然后程序可以调用 _getch 或 _getche 来获取击键。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-30T03:57:45.270

如果您使用 ncurses，您可以非常轻松地使用`getch()`. 但是，没有标准的方法来做你想做的事。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-30T05:10:02.443

您忽略了提及您正在运行的操作系统。获取键盘输入取决于操作系统（甚至取决于库——例如，如何使用 GTK 显然是特定于 GTK 的。）

好吧，GTK 可以在多个操作系统上运行，所以……但你明白了。您需要详细说明您工作的环境以获得合理的答案。

# common-lisp - 简单的 http 用法

> ID：695969
> 
> 赞同：2
> 
> 时间：2009-03-30T03:58:54.113
> 
> 标签：common-lisp

我不知道如何使用 trivial-http 库将参数传递给 http post 请求。我可以发帖，但我不确定如何传递帖子变量。作为字符流。

[http://common-lisp.net/project/trivial-http/user-guide.html#http-post](http://common-lisp.net/project/trivial-http/user-guide.html#http-post)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-30T04:36:30.293

您需要将 post 变量作为 post 请求的内容传入。最常用的方式是 as `application/x-www-form-urlencoded`，不过`multipart/form-data`如果需要上传文件也可以使用；有关编码的详细信息，请参见[此处](http://www.w3.org/TR/html401/interact/forms.html#form-content-type)。

要在 POST 请求中使用 传递信息`application/x-www-form-urlencoded`，您需要将其作为内容类型传递，并将 url 编码的查询字符串作为内容传递。像这样的东西应该工作：

```
(thttp:http-post "http://example.com/submit-form" "application/x-www-form-urlencoded"
                 "foo=bar&baz=quux") 
```

如果您需要转义将作为 POST 请求的键或值传入的字符串，则可以使用`escape-url-query`转义它们以安全地传入 url 编码的正文：

```
(thttp:http-post "http://example.com/submit-form" "application/x-www-form-urlencoded"
                 (format nil "foo=~a&bar=~a" (thttp:escape-url-query foo) 
                                             (thttp:escape-url-query bar)))) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-30T04:32:29.053

您应该将 POST 正文编码为字符串。例如，参见[http://en.wikipedia.org/wiki/POST_(HTTP)](http://en.wikipedia.org/wiki/POST_(HTTP))。要从字符串生成字符流，请使用 with-input-from-string 或 make-string-stream。

# css - 除了用 JS 之外，还有没有办法在 IE 中用 CSS 实现表格行高亮？

> ID：695970
> 
> 赞同：2
> 
> 时间：2009-03-30T03:59:54.937
> 
> 标签：css, internet-explorer, css-tables

我想在可以在 Internet Explorer 中使用的 CSS 上添加悬停时突出显示的行。我尝试了以下方法：

```
#tableId tr:hover td { background-color:#f00; } 
```

这似乎适用于 Opera、Firefox 和 Safari，但不适用于 IE。

有解决方案还是唯一的解决方案 JavaScript？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-30T04:03:55.020

某些版本的 IE（特别是 IE6，虽然 :hover 在 IE7 中存在问题）不支持 :hover，这意味着没有 JavaScript 就无法实现行高亮。

只是为了在技术上正确- IE6 确实支持：悬停，但仅在锚标记上，因此您无法定位表行。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-30T05:15:02.883

丹尼尔·卢是正确的。IE6 仅支持悬停在锚元素上，但我从经验中知道 IE7 将支持悬停在您计划做的事情上。为了让 IE6 进行悬停，我使用了`csshover.htc`. 我不记得在哪里找到它了，但如果你用谷歌搜索“csshover.htc”，你会得到一堆链接（例如：[whatever:hover](http://www.xs4all.nl/~peterned/csshover.html)）。我知道它是免费和开源的，所以你也可以从[我制作的这个网站上](http://www.propertypress.co.nz)撕掉它:)。

编辑：我是个笨蛋。我提供的链接是我使用的确切链接:)

EDIT2：这是一个在 IE7 中工作的悬停，与您的情况完全相同（但是没有实现 IE6 修复）[新卡车搜索目录](http://www.newtrucksearch.com.au/Article/Content/Directory)

# java - Java：在 Ruby on Rails 应用程序中创建新“产品”的 HTTP Post

> ID：695971
> 
> 赞同：5
> 
> 时间：2009-03-30T04:00:03.797
> 
> 标签：java, ruby-on-rails, android, http

在 android 上使用 Apache HttpClient，如何使用 HttpPost 将数据发送到 RESTfull Ruby on Rails 应用程序。

**这是我的控制器：**

```
# POST /products
  def create

    @product = Product.new(params[:product])

    respond_to do |format|
      if @product.save
        flash[:notice] = 'Product was successfully created.'
        format.html { redirect_to(@product) }
        format.xml  { render :xml => @product, :status => :created, :location => @product }
      else
        format.html { render :action => "new" }
        format.xml  { render :xml => @product.errors, :status => :unprocessable_entity }
      end
    end
  end 
```

这是我的 Java 代码。我应该在 URL 名称中传递数据，还是必须将其设置在其他地方？（也许是httppost.setEntity？）最终我将使用JSON，但现在我只想得到它，这样我就可以在Rails 中调用“create”方法。Rails 正在获取 POST，但从未在“create”方法中执行任何代码

```
 HttpClient httpclient = new DefaultHttpClient();

  HttpPost httppost = new HttpPost("http://192.168.0.100:3000/products/new");

  HttpResponse response = httpclient.execute(httppost); 
```

我很困惑，如果有人能指出我正确的方向，我将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-02T02:18:37.933

我在我的 POST 请求中添加了以下内容，它就像一个魅力。

```
httppost.addHeader("Content-Type","application/json"); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-30T04:04:00.620

Rails 没有执行 Create 方法中的任何代码，因为您正在向“New”方法发出请求。

通常，New 方法用于呈现用户随后提交给 create 方法的 HTML 表单。对于 Web 服务，不需要此方法。

请改用 url `http://192.168.0.100:3000/products`（不带 /new）。默认情况下，rails 会通过查看请求类型并确定它是 POST 请求来将此请求路由到 Create 方法。

这假设您已将 Products 正确设置为路由中的 RESTful 资源。否则，您将需要使用`http://192.168.0.100:3000/products/create`. 这是 RESTful 资源和路由的 API 文档：http: [//api.rubyonrails.org/classes/ActionController/Resources.html](http://api.rubyonrails.org/classes/ActionController/Resources.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-30T06:23:02.767

要在 POST 请求中提交数据，您需要调用`httppost.setRequestBody()`. 此方法将 s 数组`NameValuePair`与您的数据一起使用 - 请参阅 HTTP 客户端文档以了解正确的语法。

# connection-string - 使用 App.Config 的类库中强类型数据集的动态连接字符串

> ID：695979
> 
> 赞同：2
> 
> 时间：2009-03-30T04:07:46.913
> 
> 标签：connection-string, app-config, strongly-typed-dataset, class-library

这是我在 StackOverflow.com 上的第一个问题，我不确定这是否是正确的方法。我发现了一个类似的问题，标题为：[Modifying the Data Source for the Strongly Typed Dataset Connection String](https://stackoverflow.com/questions/434815/modifying-the-data-source-for-the-strongly-typed-dataset-connection-string)。但是，提供的答案对我不起作用。我无法对此发表评论，因为我没有足够的“声誉积分”（再次，我刚刚注册），并且我不想提供“答案”，因为我不知道正确的回答。

我的问题是我需要能够修改生成的 myproject 中的连接字符串。**dll** .config 文件，但这样做对我完全没有影响。我的库仍然使用在设计时设置的默认连接字符串。我已经尝试了所有我知道的尝试，但仍然没有运气。我已经尝试使用多种不同的方法解决这个问题，但问题仍然存在。对于我的具体问题，我在互联网上也找不到任何帮助。如果有人能解释为什么我修改的配置文件没有被读取，那就太好了。

有用的信息：

*   我正在使用强类型数据集
*   我在设计时不知道实际的连接字符串。
*   app.config 不允许我指定“用户”范围的连接字符串。
*   我绑定到一个类库（没有 Windows 窗体）

感谢您的任何帮助！

卢克

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-30T05:28:15.427

默认情况下，类库不解析自己的 mylibrary.dll.config - 它们将使用主机的配置文件（app.config 或 web.config）。

您可以做的是查看 ConfigurationManager 并查看从磁盘加载特定/其他配置文件的方法（OpenMappedExeConfiguration）。这样，您可能可以获取库的配置设置并使用它们。

在 Stackoverflow 或其他地方有很多关于使用这个 OpenMappedExeConfiguration 的帖子。

马克

# objective-c - 如何在 Objective-C 中声明类级别的属性？

> ID：695980
> 
> 赞同：224
> 
> 时间：2009-03-30T04:09:04.977
> 
> 标签：objective-c, cocoa, oop

也许这很明显，但我不知道如何在 Objective-C 中声明类属性。

我需要为每个班级缓存一本字典，并想知道如何将它放在班级中。

* * *

## 回答 #1

> 赞同：203
> 
> 时间：2009-03-30T04:50:41.273

属性在Objective-C中具有特定含义，但我认为您的意思是相当于静态变量的东西？例如，所有类型的 Foo 只有一个实例？

要在 Objective-C 中声明类函数，您使用 + 前缀而不是 - 所以您的实现看起来像：

```
// Foo.h
@interface Foo {
}

+ (NSDictionary *)dictionary;

// Foo.m
+ (NSDictionary *)dictionary {
  static NSDictionary *fooDict = nil;
  if (fooDict == nil) {
    // create dict
  }
  return fooDict;
} 
```

* * *

## 回答 #2

> 赞同：119
> 
> 时间：2013-04-04T12:50:09.863

我正在使用这个解决方案：

```
@interface Model
+ (int) value;
+ (void) setValue:(int)val;
@end

@implementation Model
static int value;
+ (int) value
{ @synchronized(self) { return value; } }
+ (void) setValue:(int)val
{ @synchronized(self) { value = val; } }
@end 
```

我发现它作为单例模式的替代品非常有用。

要使用它，只需使用点符号访问您的数据：

```
Model.value = 1;
NSLog(@"%d = value", Model.value); 
```

* * *

## 回答 #3

> 赞同：110
> 
> 时间：2016-06-16T03:36:42.453

正如在 WWDC 2016/XCode 8 上所见（[LLVM 会话中的新增](https://developer.apple.com/videos/play/wwdc2016/405/)功能@5:05）。类属性可以声明如下

```
@interface MyType : NSObject
@property (class) NSString *someString;
@end

NSLog(@"format string %@", MyType.someString); 
```

请注意，类属性永远不会合成

```
@implementation
static NSString * _someString;
+ (NSString *)someString { return _someString; }
+ (void)setSomeString:(NSString *)newString { _someString = newString; }
@end 
```

* * *

## 回答 #4

> 赞同：64
> 
> 时间：2009-03-30T05:03:15.300

如果您正在寻找 的类级别等价物`@property`，那么答案是“没有这样的东西”。但请记住`@property`，无论如何，它只是语法糖；它只是创建适当命名的对象方法。

您想创建访问静态变量的类方法，正如其他人所说，它们的语法略有不同。

* * *

## 回答 #5

> 赞同：24
> 
> 时间：2013-09-25T20:36:32.597

这是一种线程安全的方法：

```
// Foo.h
@interface Foo {
}

+(NSDictionary*) dictionary;

// Foo.m
+(NSDictionary*) dictionary
{
  static NSDictionary* fooDict = nil;

  static dispatch_once_t oncePredicate;

  dispatch_once(&oncePredicate, ^{
        // create dict
    });

  return fooDict;
} 
```

这些编辑确保 fooDict 只创建一次。

来自[Apple 文档](https://developer.apple.com/library/mac/documentation/Performance/Reference/GCD_libdispatch_Ref/Reference/reference.html#//apple_ref/c/func/dispatch_once)：“dispatch_once - 在应用程序的生命周期内执行一次且仅一次的块对象。”

* * *

## 回答 #6

> 赞同：14
> 
> 时间：2016-11-14T15:11:20.977

从 Xcode 8 开始，Objective-C 现在支持类属性：

```
@interface MyClass : NSObject
@property (class, nonatomic, assign, readonly) NSUUID* identifier;
@end 
```

由于永远不会合成类属性，因此您需要编写自己的实现。

```
@implementation MyClass
static NSUUID*_identifier = nil;

+ (NSUUID *)identifier {
  if (_identifier == nil) {
    _identifier = [[NSUUID alloc] init];
  }
  return _identifier;
}
@end 
```

您可以使用类名上的普通点语法访问类属性：

```
MyClass.identifier; 
```

* * *

## 回答 #7

> 赞同：7
> 
> 时间：2009-03-30T05:48:06.407

属性仅在对象中具有值，在类中没有。

如果你需要为一个类的所有对象存储一些东西，你必须使用一个全局变量。`static`您可以通过在实现文件中声明它来隐藏它。

您还可以考虑使用对象之间的特定关系：您将主角色的角色分配给您类的特定对象，并将其他对象链接到该主对象。主人将把字典作为一个简单的财产。我想到了一棵树，就像 Cocoa 应用程序中用于视图层次结构的树一样。

另一种选择是创建一个专用类的对象，该类由您的“类”字典和与该字典相关的所有对象组成。这就像`NSAutoreleasePool`在 Cocoa 中一样。

* * *

## 回答 #8

> 赞同：7
> 
> 时间：2018-08-15T14:19:11.417

从 Xcode 8 开始，您可以使用 Berbie 回答的**class**属性。

但是，在实现中，您需要使用静态变量代替 iVar 为类属性定义类 getter 和 setter。

样本.h

```
@interface Sample: NSObject
@property (class, retain) Sample *sharedSample;
@end 
```

样品.m

```
@implementation Sample
static Sample *_sharedSample;
+ ( Sample *)sharedSample {
   if (_sharedSample==nil) {
      [Sample setSharedSample:_sharedSample];
   }
   return _sharedSample;
}

+ (void)setSharedSample:(Sample *)sample {
   _sharedSample = [[Sample alloc]init];
}
@end 
```

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2014-09-09T06:33:40.280

如果您有许多类级别的属性，则可能需要使用单例模式。像这样的东西：

```
// Foo.h
@interface Foo

+ (Foo *)singleton;

@property 1 ...
@property 2 ...
@property 3 ...

@end 
```

和

```
// Foo.m

#import "Foo.h"

@implementation Foo

static Foo *_singleton = nil;

+ (Foo *)singleton {
    if (_singleton == nil) _singleton = [[Foo alloc] init];

    return _singleton;
}

@synthesize property1;
@synthesize property2;
@synthesise property3;

@end 
```

现在访问您的类级属性，如下所示：

```
[Foo singleton].property1 = value;
value = [Foo singleton].property2; 
```

* * *

## 回答 #10

> 赞同：-4
> 
> 时间：2017-01-04T18:15:26.317

[试试这个解决方案很简单] 您可以在 Swift 类中创建一个静态变量，然后从任何 Objective-C 类中调用它。

# c - 将省略号传递给另一个可变参数函数

> ID：695982
> 
> 赞同：71
> 
> 时间：2009-03-30T04:10:13.913
> 
> 标签：c, variadic-functions

我有大约 30 个可变参数函数。每个都接受一个路径作为最后的参数，例如：

```
bool do_foo(struct *f, int q, const char *fmt, ...) 
```

在每个函数中，我必须检查扩展格式是否小于或等于某个大小。所以，我发现自己复制/粘贴相同的代码块来检查有多少字符`vsnprintf()`没有打印，`errno`相应地设置并退出写入。

我想做的是编写一个函数来执行此操作，它将返回一个已知为安全大小的静态分配（扩展）字符串，或者在失败时返回新初始化的字符串，可以针对 NULL 进行检查。检查还必须确定字符串是绝对路径还是相对路径，这会影响字符串的安全大小。这是很多重复的代码，它开始闻起来了。

有没有办法可以将省略号的内容从我的函数条目传递给另一个函数？还是我必须先调用`va_start()`，然后将其传递`va_list`给辅助函数？

**编辑：**

我一点也不反对将它传递`va_list`给助手，我只是想确保没有其他东西存在。在我看来，编译器理解可变参数从哪里开始，所以我只是好奇我是否可以告诉它传递它们。

* * *

## 回答 #1

> 赞同：71
> 
> 时间：2009-03-30T04:21:19.033

你不能，你只能将参数作为`va_list`. 请参阅[comp.lang.c 常见问题解答](http://c-faq.com/varargs/handoff.html)。

一般来说，如果您在 C 中编写可变参数函数（即采用可变数量参数的函数），您应该为每个函数编写两个版本：一个采用省略号 ( `...`)，另一个采用`va_list`. 采用省略号的版本应该调用`va_start`，调用采用 a 的版本`va_list`，调用`va_end`，然后返回。函数的两个版本之间不需要重复代码，因为一个调用另一个。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-03-30T06:00:03.540

可能您可以使用可变参数宏 - 像这样：

```
#define FOO(...)  do { do_some_checks; myfun(__VA_ARGS__); } while (0) 
```

**注意！**可变参数宏仅适用于 C99

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-01T04:53:19.250

我不知道这是否有帮助，您可以通过引用访问变量。这是一种偷偷摸摸的技巧，但不幸的是，它不允许您在最终函数定义中使用省略号。

```
#include <stdio.h>

void print_vars(int *n)
{
  int i;
  for(i=0;i<=*n;i++)
    printf("%X %d  ", (int)(n+i), *(n+i));
  printf("\n");
}

void pass_vars(int n, ...)
{
  print_vars(&n);
}

int main()
{
    pass_vars(4, 6, 7, 8, 0);
    return 0;
} 
```

在我的电脑上它输出

```
$ ./a.out
BFFEB0B0 4  BFFEB0B4 6  BFFEB0B8 7  BFFEB0BC 8  BFFEB0C0 0 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-30T04:15:18.300

您必须将 va_list 传递给助手。

# .net - 如何在 IronPython 中实现接口？

> ID：695986
> 
> 赞同：15
> 
> 时间：2009-03-30T04:14:22.967
> 
> 标签：.net, interface, ironpython

[IronPython 2.0.1 附带](http://ironpython.codeplex.com/wikipage?title=FAQ&version=30)的常见问题解答如下：

> 您可以在 C# 中定义接口，将它们构建到 DLL 中，然后在 Python 代码中实现这些接口，并将实现接口的 Python 对象传递给 C# 代码。

我已经用谷歌搜索和谷歌搜索，但还没有找到如何做到这一点。有人可以帮忙吗？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-03-30T04:32:38.133

您可以使用 Python 的常规继承语法来做到这一点：

```
class SomeClass (ISomeInterface):
    def SomeMethod(self, parameter):
        pass 
```

只需“继承”接口，像任何其他类方法一样实现它的方法，然后享受吧！

# java - 如何通过java程序监控安装过程？

> ID：695988
> 
> 赞同：0
> 
> 时间：2009-03-30T04:18:44.860
> 
> 标签：java, installanywhere

我需要帮助来通过 java 代码跟踪安装过程。我们的安装程序是使用 InstallAnywhere 开发的。当用户单击取消按钮时，安装程​​序会退出，但不会像安装前那样使系统处于清理状态。因此，请帮助我跟踪用户的“取消”按钮，以便我们可以执行一些操作，使系统处于清洁状态。

请建议我可以采取的方法来解决这个问题。提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2010-01-01T04:01:02.210

您需要弄清楚如何在 InstallAnywhere 框架中执行此操作。如果我记得，它提供了很多通过插件 Java 类做事的钩子，尤其是在企业版中。该文档非常广泛，应该为您提供一些有关如何继续的线索。

如果该方法不起作用，并且您无法从 InstallAnywhere 支持渠道、论坛等处获得任何帮助，请考虑切换到开源 Java 安装程序。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-30T11:04:05.400

InstallAnyWhere 必须有关于它的文档。

# php - php 正则表达式：获取 src 值

> ID：695989
> 
> 赞同：2
> 
> 时间：2009-03-30T04:20:06.667
> 
> 标签：php, regex

如何在 php 中使用正则表达式检索所有 src 值？

```
<script type="text/javascript" src="http://localhost/assets/javascript/system.js" charset="UTF-8"></script>
<script type='text/javascript' src='http://localhost/index.php?uid=93db46d877df1af2a360fa2b04aabb3c' charset='UTF-8'></script> 
```

检索到的值应该只包含：

*   [http://localhost/assets/javascript/system.js](http://localhost/assets/javascript/system.js)
*   [http://localhost/index.php?uid=93db46d877df1af2a360fa2b04aabb3c](http://localhost/index.php?uid=93db46d877df1af2a360fa2b04aabb3c)

谢谢你。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-30T04:56:07.297

```
/src=(["'])(.*?)\1/ 
```

例子：

```
<?php

$input_string = '<script type="text/javascript" src="http://localhost/assets/javascript/system.js" charset="UTF-8"></script>';
$count = preg_match('/src=(["\'])(.*?)\1/', $input_string, $match);
if ($count === FALSE) 
    echo('not found\n');
else 
    echo($match[2] . "\n");

$input_string = "<script type='text/javascript' src='http://localhost/index.php?uid=93db46d877df1af2a360fa2b04aabb3c' charset='UTF-8'></script>";
$count = preg_match('/src=(["\'])(.*?)\1/', $input_string, $match);
if ($count === FALSE) 
    echo('not found\n');
else 
    echo($match[2] . "\n"); 
```

给出：

```
http://localhost/assets/javascript/system.js
http://localhost/index.php?uid=93db46d877df1af2a360fa2b04aabb3c 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-03-30T05:25:48.037

也许只有我一个人，但我不喜欢使用正则表达式在 HTML 片段中查找内容，尤其是当 HTML 不可预测时（可能来自用户或其他网页）。

像这样的东西怎么样：

```
$doc =
<<<DOC
    <script type="text/javascript" src="http://localhost/assets/javascript/system.js" charset="UTF-8"></script>
    <script type='text/javascript' src='http://localhost/index.php?uid=93db46d877df1af2a360fa2b04aabb3c' charset='UTF-8'></script> 
```

```
DOC;

$dom = new DomDocument;
$dom->loadHTML( $doc );

$elems = $dom->getElementsByTagName('*');

foreach ( $elems as $elm ) {
    if ( $elm->hasAttribute('src') )
        $srcs[] = $elm->getAttribute('src');
}

print_r( $srcs ); 
```

我不知道这和正则表达式之间的速度差异是什么，但我花了更少的时间来阅读它并理解我想要做什么。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-03-30T05:38:49.160

我同意尼克的观点，使用 DomDocument 对象来获取您的数据。这是一个 xpath 版本：

```
$doc =
<<<DOC
    <script type="text/javascript" src="http://localhost/assets/javascript/system.js" charset="UTF-8"></script>
    <script type='text/javascript' src='http://localhost/index.php?uid=93db46d877df1af2a360fa2b04aabb3c' charset='UTF-8'></script>
DOC;

$doc = new DomDocument;
$doc->loadHTML($doc);

$xpath = new DomXpath($doc);
$elements = $xpath->query('//[@src]');

foreach($elements as $element)
{
    echo $element->nodeValue;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-10-17T20:05:49.480

jQuery 方法

```
var Scripts = [];
$('head script').each(function(){
    if($(this).attr('type') == 'text/javascript' && $(this).attr('src')){
        Scripts.push($(this).attr('src'));
    }
});
console.log(Scripts) 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-30T19:41:31.880

If you decide to go the regex route, this should be useful for you

```
/(?<=\<).*?src=(['"])(.*?)\1.*?(?=/?\>)/si 
```

# windows - 从 DataGrid VB.Net Windows 应用程序导出到 Excel

> ID：695992
> 
> 赞同：0
> 
> 时间：2009-03-30T04:23:46.300
> 
> 标签：windows, vb.net, winforms

对于基于窗口的应用程序，我需要使用 VB.Net 将 DataGrids 的内容导出到 Excel。

如何做到这一点..有什么想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-30T05:06:29.723

有很多方法可以做到这一点。使用 File 类中的静态方法创建 excel 文件。然后，您可以创建与 Excel 文件的 OleDB 连接，然后使用 SQL 查询将所有数据写入其中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-30T06:45:21.903

开箱即用的 DataGrid 不支持此功能。你可以一个。使用具有此功能的第三方数据网格 b. 创建一个与表格内容相同的报表。Microsoft 免费提供的报表查看器控件具有导出到 Excel 的功能**********************