# StackOverflow 问答 10855000-10855999

# php - 单击动态创建的复选框时，通过 AJAX/PHP 更新 MySQL 中的值？

> ID：10855000
> 
> 赞同：2
> 
> 时间：2012-06-01T17:46:53.007
> 
> 标签：php, javascript, jquery, mysql, ajax

我正在为我正在处理的项目创建一个管理面板。它将在表格中列出一堆条目，并且每一行都会有一个复选框。此复选框将用于激活要在网站上显示的条目。

我正在使用 MySQL 数据库中的数据设置复选框的`id`和`name`。例如..

```
<input type="checkbox" class="active" name="active<?php echo $id; ?>" id="active<?php echo $id; ?>" <?php if ($active == 1): ?>checked="checked"<?php endif; ?> value="<?php echo $id; ?>"> 
```

对于 ID 为 5 的条目，它将如下所示..

```
<input type="checkbox" class="active" name="active5" id="active5" checked="checked" value="5"> 
```

我需要进行设置，以便当您选中或取消选中它时，它会更新数据库中的“活动”值。如何在单击时获取每个复选框的值，并将该值发送到 MySQL 数据库。如果我`name`事先知道复选框，我可以很容易地做到这一点，但由于`name`部分是从数据库生成的，我不确定如何编写代码来确定哪个条目获得活动值。

**这是我的 jQuery ..**

```
$("input.active").click(function() {
// store the values from the form checkbox box, then send via ajax below
var check_active = $(this).is(':checked') ? 1 : 0;
var check_id = $(this).attr('value');

console.log(check_active);
console.log(check_id);

    $.ajax({
        type: "POST",
        url: "http://nowfoods.marketspacecom.com/nextstep/ajax.php",
        data: {id: check_id, active: check_active},
        success: function(){
            $('form#submit').hide(function(){$('div.success').fadeIn();});

        }
    });
return true;
}); 
```

**这是PHP ..**

```
<?php

include("dbinfo.inc.php");
mysql_connect($server,$username,$password);
@mysql_select_db($database) or die( "Unable to select database"); 

// CLIENT INFORMATION
$active = mysql_real_escape_string($_POST['active']);
$id = mysql_real_escape_string($_POST['id']);

$addEntry = "UPDATE entries SET active = '$active' WHERE id = '$id'";
mysql_query($addEntry) or die(mysql_error());

mysql_close(); 
```

?>

![我正在构建的屏幕截图](../Images/5d64242106013faae104e1479e081822.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T17:49:27.183

这是错误的：

```
var active = $('#active').attr('value'); 
```

您需要检查单击的元素，并且必须检查它是否被检查（除非您使用它来传递 ID，否则该值并不重要）：

```
var active = $(this).is(':checked');    // the checkbox is checked (boolean) 
```

您可以将其设置为整数值，例如：

```
var active = $(this).is(':checked') ? 1 : 0; 
```

简称：

```
if ($(this).is(':checked')) {
  var active = 1;
} else {
  var active = 0;
} 
```

在 php 中，您需要正确处理用户输入：

```
$active = (int) $_POST['active']; 
```

**编辑：**您的编辑代码中似乎有一个不应存在的空间，当您设置时它是否有效：

```
...
data: {"active=": check_active, "id": check_id},
... 
```

此外，由于两个值都是整数/应该是整数，因此使用字符串函数为数据库转义它们并没有真正的用途，您应该测试整数或至少将它们转换为整数：

```
// CLIENT INFORMATION
$active = (int) $_POST['active'];
$id = (int) $_POST['id']; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-01T17:53:34.983

您可以向输入添加一个类并将值设置为 id：

`<input class="active" type="checkbox" name="active5" id="active5" value="5" checked="checked">`

然后，更改您的 jQuery：

```
$("input.active").click(function() {
// store the values from the form checkbox box, then send via ajax below
var check_active = $(this).is(':checked') ? 1 : 0;
var check_id = $(this).attr('value');

    $.ajax({
        type: "POST",
        url: "http://nowfoods.marketspacecom.com/nextstep/ajax.php",
        data: {id: check_id, active: check_active}
        success: function(){
            $('form#submit').hide(function(){$('div.success').fadeIn();});

        }
    });
return true;
}); 
```

至于 PHP：

```
<?php

include("dbinfo.inc.php");
mysql_connect($server,$username,$password);
@mysql_select_db($database) or die( "Unable to select database"); 

// CLIENT INFORMATION
$active        = mysql_real_escape_string($_POST['active']);
$id = mysql_real_escape_string($_POST['id']);

// WHERE id=16 is just for testing purposes. Need to dynamically find which checkbox was checked and use that info to tell the query which ID to update. 
$addEntry  = "UPDATE entries SET active = '$active' WHERE id = '$id'";
mysql_query($addEntry) or die(mysql_error());

mysql_close();
?> 
```

这应该是您正在寻找的。可能有一些小的语法问题，因为我是在脑海中写下这个，但我希望你能得到大致的想法。:-)

# c# - 无法连接到 WebSocket 服务器。不知道为什么

> ID：10855002
> 
> 赞同：0
> 
> 时间：2012-06-01T17:47:01.600
> 
> 标签：c#, html, debugging, connection, websocket

我使用本文中的代码[只是](http://www.codeproject.com/Articles/57060/Web-Socket-Server)为了尝试启动并运行某些东西。但是，一旦它运行，我似乎无法连接到 Web 套接字服务器。

我已经尝试转发端口 8080 和 8181，确保它们使用[canyouseeme](http://canyouseeme.org/)转发，允许我的防火墙下的端口，完全禁用我的防火墙，尝试和转发不同的端口等。

到目前为止没有任何效果。HTML 浏览器页面和控制台服务器应用程序都运行良好，没有错误，但是当我尝试通过浏览器中的 HTML 页面进行连接时，我不断收到此错误消息：

```
Connecting to ws://localhost:8181/chat ...
Socket closed! 
```

我以前从未使用过 WebSockets，所以我不确定我是否遗漏了一些东西，比如我是否需要安装一些框架​​、运行一些守护程序或什么。我正在运行 Windows 7 64 位并使用 Visual Studio 运行该解决方案。不知道如何让它工作。有人有想法么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-01T18:49:56.887

那篇文章中提到的服务器可能使用的是旧的 Hixie 协议。如果您运行的是最新版本的 Chrome 或 Firefox，那么您使用的是较新的 HyBi/IETF 协议。这篇文章写于 2010 年 6 月，当时新的协议还没有被标准化和采用。

**更新**：

[Fleck](https://github.com/statianzo/Fleck)看起来像是那篇文章中代码的后代（通过[Nugget](http://nugget.codeplex.com/)），它支持新旧协议变体。

# windows-8 - Windows 8 Metro 应用程序：图像上的模糊动画过滤器

> ID：10855003
> 
> 赞同：1
> 
> 时间：2012-06-01T17:47:05.787
> 
> 标签：windows-8, windows-runtime, windows-store-apps, winrt-xaml

有没有人知道或有任何提示我如何在大约 1 秒的时间内将图像的模糊从焦点变为模糊？

基本上与此相同的问题，但在 Windows 8 上！ [使用核心动画制作高斯模糊动画？](https://stackoverflow.com/questions/6748404/animating-a-gaussian-blur-using-core-animation)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-04T06:56:35.807

您可以创建图像的模糊版本 - 例如使用 WriteableBitmapEx，然后将模糊版本覆盖在原始图像之上，并将其不透明度从 0 设置为 1。

或者 - 您可以执行 DirectX 互操作并为绑定到控制模糊度的像素着色器输入的属性设置动画，尽管这可能需要更多工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-02T04:11:44.540

模糊不是 Xaml 的 WinRT 动画库中的动画 [http://msdn.microsoft.com/en-us/library/windows/apps/windows.ui.xaml.media.animation.aspx#classes](http://msdn.microsoft.com/en-us/library/windows/apps/windows.ui.xaml.media.animation.aspx#classes)

你想通过模糊来完成什么？

你试过这个动画吗？- FadeOutThemeAnimation

# html - 带有 css 和 html 的 tabview 菜单

> ID：10855006
> 
> 赞同：0
> 
> 时间：2012-06-01T17:47:26.833
> 
> 标签：html, css, view, tabs

我希望以下内容成为选项卡式视图。

```
 <div id="navigation">

<ul class="secondbakedmenu">
<li><a href=".html">Images</a>
<ul>

<li>

</li>

    <dt>Images</dt>
<dd></dd>
<a href=".html"><img src="" height=100 width=120/></a>

<li>

<dt>Images</dt>
<dd></dd>
<a href=".html"><img src="" height=100 width=120/></a>

</li>

<dt>Images</dt>
<dd></dd>
<a href=".html"><img src="" height=100 width=120/></a>

<li>

<dt>Images</dt>
<dd></dd>
<a href=".html"><img src="" height=100 width=120/></a>

</li>
<dt>Images</dt>
<dd></dd>
<a href=".html"><img src="" height=100 width=120/></a>

<li>

<dt>Images</dt>
<dd></dd>
<a href=".html"><img src="" height=100 width=120/></a>

</li>

<dt>Images</dt>
<dd></dd>
<a href=".html"><img src="" height=100 width=120/></a>

<li>

<dt>Images</dt>
<dd></dd>
<a href=".html"><img src="" height=100 width=120/></a>

</li>

<dt>Images</dt>
<dd></dd>
<a href=".html"><img src="" height=100 width=120/></a>

</ul> 
```

```
<dl>
<ul class="secondbakedmenu">
<li><a href=".html">Previews</a>
<ul>

<li>
<dt>Preview</dt>
<dd></dd>
<a href=".html"><img src="" height=100 width=120/></a>
</li>

<li>
<dt>Preview</dt>
<dd></dd>
<a href=".html">SSX<img src="" height=100 width=120/></a>
</li>

<li>
<dt>Preview</dt>
<dd></dd>
<a href=".html"><img src="" height=100 width=120/></a>
</li>

<li>    
<dt>Preview</dt>
<dd></dd>
<a href=".html"><img src="" height=100 width=120/></a>
</li>

<li>
<dt>Preview</dt>
<dd></dd>
<a href=".html"><img src="" height=100 width=120/></a>    
</li> 
```

```
<ul class="secondbakedmenu">
<li><a href=".html">All Updates</a>
<ul>
<li><a href=".html">1</a></li>
<li><a href=".html">2</a></li>
<li><a href=".html">3</a></li>
<li><a href=".html">4</a></li>
<li><a href=".html">5</a></li>
</ul> 
```

​​​​</p>

和它的CSS

```
.secondbakedmenu {list-style: none;
         float: left;
         margin-top: 15px;
         margin-left: -20px;}

.secondbakedmenu li>a{color: white;
            font-size: 12px}

.secondbakedmenu li{font-family: Berlin Sans FB;
          } 

.secondbakedmenu li ul {position: absolute;
                        display: none;}

.secondbakedmenu a:hover{text-decoration: none;
                        color: white;
        text-shadow: 1px 1px 1px blue;

        }   

.secondbakedmenu li:hover ul {
                     display: block;
                     list-style-type: none;
                     }

ul.secondbakedmenu li:hover{margin: 0;
                            padding: 0;} 
```

我怎样才能使这个菜单成为一个带有单击功能而不是悬停的选项卡式视图菜单，并使选项卡式时显示的内容正确放置在同一个容器内。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-01T17:55:12.863

绝对需要 JavaScript。但是，我不会重新发明那个轮子。使用带有插件的 java 脚本库。

jQuery 的 UI 在这里有一个“选项卡”小部件：http: [//jqueryui.com/demos/tabs/](http://jqueryui.com/demos/tabs/)

# css - 如何使用css3实现一个球弹跳效果？

> ID：10855010
> 
> 赞同：3
> 
> 时间：2012-06-01T17:47:42.343
> 
> 标签：css, bounce

事实上，我几乎成功了：我`div`需要反弹：

```
<div class="container">
    <div class="flipcard transition allowhover">
        <h1>This is card</h1>
    </div>
</div>​ 
```

然后我使用 css3 animate 来实现弹跳效果：

```
.container{
    width: 100%;
    height: 100%;
    -moz-perspective: 1000px;
}
.flipcard{
    background: red;
    width: 200px;
    height: 300px;
    position: absolute;
    top: 40px;
    left: 20px;
    -webkit-transform-style: preserve-3d;
    -webkit-transition:all 0.6s ease-in-out;
}
.allowhover:hover{
    -webkit-animation-name: bounce;
    -webkit-animation-duration: 1.5s;
    -webkit-animation-iteration-count: infinite ;
    -webkit-animation-direction: normal;
}

@-webkit-keyframes bounce {
   25% {
     top:7px;
   }
   45% {
     top:40px;
   }
   64% {
      top:19px;
   }
   76% {
      top:40px;
   }
   96%{
      top: 25px
   }
   100% {
      top:40px;
   }
}​ 
```

现在在线示例在这里：http: [//jsfiddle.net/GEEtx/](http://jsfiddle.net/GEEtx/)

看起来可行，但不够好，我应该如何设置`key-frames`参数以使其更像球一样弹跳？有没有公式可以根据元素的宽度和高度或时间来计算弹跳高度和计数？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T18:03:02.180

只需很少的试验和错误，我们就可以根据需要计算出反弹效果。

所有 jQuery 缓动插件都使用这个公式来获得反弹效果。

```
 easeInBounce: function (x, t, b, c, d) {
                return c - jQuery.easing.easeOutBounce (x, d-t, 0, c, d) + b;
        },
        easeOutBounce: function (x, t, b, c, d) {
                if ((t/=d) < (1/2.75)) {
                        return c*(7.5625*t*t) + b;
                } else if (t < (2/2.75)) {
                        return c*(7.5625*(t-=(1.5/2.75))*t + .75) + b;
                } else if (t < (2.5/2.75)) {
                        return c*(7.5625*(t-=(2.25/2.75))*t + .9375) + b;
                } else {
                        return c*(7.5625*(t-=(2.625/2.75))*t + .984375) + b;
                }

// t: current time, b: begInnIng value, c: change In value, d: duration 
```

因此将其应用于当前的 CSS 关键帧。
d ：动画持续时间。//1.5 : 1500
b : 开始时的最高值 // 0
c : 值变化 //40px
t : 当前时间 // 10

通过应用这些进行更多工作，我们可能会找出 CSS 中反弹效果所需的值。

我还找到了这个[CSS3 3D Bouncing Ball 教程](http://tympanus.net/Tutorials/CSS3BouncingBall/)

希望对您有所帮助。

# spreadsheetgear - 如何让 SpreadsheetGear.IRange.AutoFit() 为每列提供正确的宽度？

> ID：10855012
> 
> 赞同：6
> 
> 时间：2012-06-01T17:47:48.073
> 
> 标签：spreadsheetgear

我使用 Spreadsheetgear 生成 Excel 工作簿。

我的工作簿很简单：

*   我在单元格中插入字符串
*   第一行是粗体
*   我在标题周围和列之间绘制边框。

在该过程结束时，我调用`myRange.Columns.AutoFit()`，然后保存工作簿。

当我用 Excel 打开它时，自动调整几乎很好，但它仍然错过了每列中大约 1.2 个宽度单位。

这是`AutoFit()`实现中的错误还是我遗漏了什么？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-11-02T18:09:45.940

实际上，在大约 6 个月前我正在构建我的实现时，我实际上询问了 SpreadsheetGear 的支持。我提到 b/c 他们的 AutoFit() 并不完全正确，我不得不在自动调整大小后为每一列添加一个“软糖因子”。支持人员的回应基本上是，这是与 Excel 的一个已知差异，他们没有将其归类为错误。以下是他们必须对我说的话：

> SpreadsheetGear 和 Excel 之间的自动调整列略有不同的原因是 .NET 和 GDI+ 提供给我们的字体指标与 Excel 中使用的不同。由于列尺寸与工作簿中使用的字体相关联，因此字体指标与 Excel 完全匹配是不可能的，不幸的是。我们尽最大努力匹配 Excel，但不可能在所有情况下都完全匹配。
> 
> 有趣的是，Excel 实际上与他们的字体度量计算非常不一致；尝试使用 SpreadsheetGear 创建一个包含大量文本的工作簿，可能会在一个单元格中添加 40-50 个“a”字符。现在将该工作簿保存到磁盘并在 Excel 2007 或 2010 中打开它，使用右下角的缩放滑块在不同点放大和缩小，并注意文本相对于列宽发生了相当大的移动。SpreadsheetGear 更符合这种情况。
> 
> 无论如何，您在列宽上添加一点“软糖因子”的方法是我们可以建议的最佳解决方法。这是“骇人听闻的”，但我们根本无法改进它，因为您要处理两种不同的环境以及 Excel 本身的不一致指标。

这是我用来根据需要加宽列的“软糖因素”：

```
ws.UsedRange.Columns.AutoFit()
For col As Integer = 0 To ws.UsedRange.ColumnCount - 1
    ws.Cells(1, col).ColumnWidth *= 1.
Next 
```

在 C# 中

```
ws.UsedRange.Columns.AutoFit()
for (int col = 0; col < ws.UsedRange.ColumnCount; col++)
    ws.Cells[1, col].ColumnWidth *= 1.15; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2017-01-12T22:54:38.160

基于@Stephen 的答案... Excel 的列宽限制为 255，所以我这样做了：

```
 private static void AutoFitColumns(SpreadsheetGear.IWorksheet worksheet)
    {
        worksheet.UsedRange.Columns.AutoFit();

        const int ExcelMaximumColumnWidth = 255;
        const double OneHundredFifteenPercent = 1.15;

        for (var i = 0; i < worksheet.UsedRange.ColumnCount; i++)
        {
            var cell = worksheet.Cells[1, i];
            var width = cell.ColumnWidth * OneHundredFifteenPercent;

            if (width > ExcelMaximumColumnWidth)
                width = ExcelMaximumColumnWidth;

            cell.ColumnWidth = width;
        }
    } 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-19T19:55:46.210

您可能需要将 SpreadsheetGear 升级到最新版本。我已经安装了SpreadsheetGear 2008，但我在使用AutoFit() 时遇到了很多问题。阅读 SpreadsheetGear2010 的变更日志[http://www.spreadsheetgear.com/downloads/whatsnew.aspx](http://www.spreadsheetgear.com/downloads/whatsnew.aspx)，您会看到此版本中发生了几次 AutoFit 重构。

# ruby-on-rails - 禁用 URL 中的部分布局

> ID：10855013
> 
> 赞同：0
> 
> 时间：2012-06-01T17:47:48.453
> 
> 标签：ruby-on-rails, popup

我正在构建我的第一个 Rails 应用程序，现在我遇到了问题。
我有一个应用程序布局，其中包括页眉和页脚（当然还有内容）。现在我在一个视图中有一个弹出窗口（我使用[Facebox](https://github.com/defunkt/facebox)），效果很好，除了我不想在通过 ajax 加载的页面中显示页脚。

我不知道我该怎么做...有没有办法可以将类似此选项的内容添加到 URL 中？
如果你能给我一个如何解决这个问题的想法，我已经很高兴了。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-01T17:55:42.090

您是否需要更改弹出窗口中显示的页面布局？如果是这样，请检查方法`:layout`的选项`render`。您可以使用其他布局，或者根本不使用布局。

您可以在控制器中执行此操作。为“无页脚”页面创建新操作（不要忘记修改 routes.rb）

```
def show_footerless (user/1/show_footerless)
  @user = User.find(params[:id])
  render "show", :layout => "footerless" # or :layout => nil
end 
```

或将额外参数传递给标准操作 (/user/1?footerless=1)

```
def show
  @user = User.find(params[:id])
  if params[:footerless]==1
    render "show", :layout => "footerless" # or :layout => nil
  else
    render "show"
  end
end 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-01T17:50:32.653

您可以在打开弹出窗口时执行

```
@popup_displayed = true 
```

然后在布局中

```
<%= render 'layouts/footer' unless @popup_displayed %> 
```

# java - soap:address 位置显示主机名而不是 DNS url

> ID：10855015
> 
> 赞同：0
> 
> 时间：2012-06-01T17:47:53.533
> 
> 标签：java, web-services, wsdl

我们目前已经编写了 2 个 Web 服务，一个使用 CXF，另一个仅使用 JAX-WS。

在 vanilla JAX-WS 服务中，soap 地址如下所示

`<soap:address location="http://server-name:8080/Service"/>`

在 CXF 服务中，soap 地址如下所示

```
<soap:address location="http://cxfservice.website.com/Service"/> 
```

如何使 JAX-WS 服务使用 DNS url 而不是主机名作为肥皂地址位置？（这些服务位于负载平衡器后面，如果使用服务器的主机名，则客户端无法解析地址）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-01T17:52:02.943

对于 CXF，您可以在定义端点时定义所需的地址。如果你使用 Spring 来配置 CXF，那看起来像：

```
<jaxws:endpoint id="wsEndpoint"
    address="http://cxfservice.website.com/Service" ...>
    ...
</jaxws:endpoint> 
```

有关如何配置 CXF 端点的更多详细信息和配置选项，请访问 CXF 文档的链接： http: [//cxf.apache.org/docs/jax-ws-configuration.html](http://cxf.apache.org/docs/jax-ws-configuration.html)

# c# - C# WCF - 窗口 - 发布

> ID：10855017
> 
> 赞同：0
> 
> 时间：2012-06-01T17:48:07.880
> 
> 标签：c#, c#-4.0

我有带有 2 个启动项目的 C# windows 应用程序 -WCF。一种是调用 WCF 服务的控制台应用程序。现在 Windows 应用程序将调用控制台应用程序。我已将控制台和窗口都设置为启动项目。我想发布 Windows 应用程序。如何让我的两个应用程序都以单个 exe 启动？

提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-02T15:53:12.863

在控制台应用程序中启动服务后，在控制台主程序中调用 win 表单。然后隐藏您可以看到表单的控制台。

# cuda - 关于 cuddpp 中的紧凑操作

> ID：10855020
> 
> 赞同：2
> 
> 时间：2012-06-01T17:48:20.593
> 
> 标签：cuda, gpgpu, gpu

以下内核函数是 cuda 库 (http://gpgpu.org/developer/cudpp) 中的紧凑操作。

我的问题是为什么开发人员重复写作部分 8 次？为什么它可以提高性能？

为什么一个线程处理 8 个元素，为什么不是每个线程处理一个元素？

```
template <class T, bool isBackward>
__global__ void compactData(T                  *d_out, 
                        size_t             *d_numValidElements,
                        const unsigned int *d_indices, // Exclusive Sum-Scan Result
                        const unsigned int *d_isValid,
                        const T            *d_in,
                        unsigned int       numElements)
{
  if (threadIdx.x == 0)
  {
        if (isBackward)
            d_numValidElements[0] = d_isValid[0] + d_indices[0];
    else
        d_numValidElements[0] = d_isValid[numElements-1] + d_indices[numElements-1];
   }

   // The index of the first element (in a set of eight) that this
   // thread is going to set the flag for. We left shift
   // blockDim.x by 3 since (multiply by 8) since each block of 
   // threads processes eight times the number of threads in that
   // block
   unsigned int iGlobal = blockIdx.x * (blockDim.x << 3) + threadIdx.x;

   // Repeat the following 8 (SCAN_ELTS_PER_THREAD) times
   // 1\. Check if data in input array d_in is null
   // 2\. If yes do nothing
   // 3\. If not write data to output data array d_out in
   //    the position specified by d_isValid
   if (iGlobal < numElements && d_isValid[iGlobal] > 0) {
       d_out[d_indices[iGlobal]] = d_in[iGlobal];
   }
   iGlobal += blockDim.x;  
   if (iGlobal < numElements && d_isValid[iGlobal] > 0) {
       d_out[d_indices[iGlobal]] = d_in[iGlobal];       
   }
   iGlobal += blockDim.x;
   if (iGlobal < numElements && d_isValid[iGlobal] > 0) {
       d_out[d_indices[iGlobal]] = d_in[iGlobal];
   }
   iGlobal += blockDim.x;
   if (iGlobal < numElements && d_isValid[iGlobal] > 0) {
       d_out[d_indices[iGlobal]] = d_in[iGlobal];
   }
   iGlobal += blockDim.x;
   if (iGlobal < numElements && d_isValid[iGlobal] > 0) {
       d_out[d_indices[iGlobal]] = d_in[iGlobal];
   }
   iGlobal += blockDim.x;
   if (iGlobal < numElements && d_isValid[iGlobal] > 0) {
       d_out[d_indices[iGlobal]] = d_in[iGlobal];
   }
   iGlobal += blockDim.x;
   if (iGlobal < numElements && d_isValid[iGlobal] > 0) {
       d_out[d_indices[iGlobal]] = d_in[iGlobal];
   }
   iGlobal += blockDim.x;
   if (iGlobal < numElements && d_isValid[iGlobal] > 0) {
       d_out[d_indices[iGlobal]] = d_in[iGlobal];
   }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T18:10:35.963

> 我的问题是为什么开发人员重复写作部分 8 次？为什么它可以提高性能？

正如@torrential_coding 所说，循环展开可以提高性能。特别是在这种情况下，循环非常紧凑（其中几乎没有逻辑）。但是，编码人员应该使用 CUDA 对自动循环展开的支持，而不是手动进行。

> 为什么一个线程处理 8 个元素，为什么不是每个线程处理一个元素？

仅计算 iGlobal 的完整索引并为每 8 个操作而不是每个操作检查 threadIdx.x 是否为零可能会有一些小的性能提升，如果每个内核只执行一个元素，则必须这样做。

# asp.net-mvc - 成功后清除字段

> ID：10855021
> 
> 赞同：27
> 
> 时间：2012-06-01T17:48:25.427
> 
> 标签：asp.net-mvc

我有一个包含 2 个输入类型 = 文本的页面。

```
@model MVC3.ViewModel.TalkToUsVM

@using (Html.BeginForm())
{
    <ul>
        <li>@Html.TextBoxFor(m => m.TalkToUsRequest.Name)</li>
        <li>@Html.TextBoxFor(m => m.TalkToUsRequest.Email)</li>
    </ul>

    <input type="submit" value="Save"/>
} 
```

在我的控制器中，我这样做：

```
[HttpPost]
public ActionResult Create(TalkToUsRequest talkToUsRequest)
{
    var vm = new TalkToUsVM();

    if (TryValidateModel(talkToUsRequest))
    {
        vm.Result = "Success";

        return View("Create",vm);
    }

    vm = new TalkToUsVM
    {
        Result = "Errrooooooor",
        TalkToUsRequest = talkToUsRequest
    };

    return View(vm);
} 
```

所以问题..当我的模型有效时，我将结果设置为“成功”，此时 vm.TalkToUsRequest 为空..但是当页面呈现时，所有字段的值与我提交时的值相同..甚至我设置 vm.TalkToUsRequest = null！！如何清除此字段？

* * *

## 回答 #1

> 赞同：75
> 
> 时间：2012-06-01T17:52:28.937

因此，在这种情况下，如果您返回同一视图，则必须清除模型状态。尝试以下操作：

```
 ModelState.Clear();
    return View(vm);
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2018-02-25T16:55:22.967

您的答案 ：

```
TryUpdateModel(yourmodelname); 
```

它会更新你的视图状态

如果您还想同时清除所有 Modelstate.error ，您还可以使用：

```
 ModelState.Clear(); 
```

# android - 多视图 Android ScrollView scrollTo Popover 不起作用

> ID：10855022
> 
> 赞同：2
> 
> 时间：2012-06-01T17:48:28.810
> 
> 标签：android, popover, android-scrollview

我的应用在视图 A 中打开。在视图 B 中，我制作了一个自定义弹出框，其视图包含：

```
LinearLayout
    ScrollView
        LinearLayout1
        LinearLayout2
              .
              .
              .
        LinearLayoutN 
```

我想做的是从视图 A，移动到视图 B，将垂直滚动位置设置为弹出窗口中滚动视图的特定线性布局。

我在代码中将滚动视图分配给了一个变量，并且

```
variable.scrollTo 
```

不管用。

我也试过把

```
sView.post(new Runnable() {     
    @Override     
    public void run() {         
        sView.scrollTo(0, myNum);     
    }  
}); 
```

在我运行设置视图 B 的例程中，在 OnCreate 例程中尝试了它。滚动 ScrollView 似乎没有任何效果。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-06T00:31:14.263

这

```
sView.post(new Runnable() {     
    @Override     
    public void run() {         
        sView.scrollTo(0, scrollYPos);     
    }  
}); 
```

非常有用，但它的位置更为重要。如果滚动视图位于弹出视图内部，实际上必须将上面的代码放置在真正将该弹出视图带到屏幕上的代码之后。

# c# - Why mono touch can write iOS apps in C# and can submit to AppStore?

> ID：10855023
> 
> 赞同：2
> 
> 时间：2012-06-01T17:48:32.793
> 
> 标签：c#, objective-c, xamarin.ios, app-store

Is this the mono touch using a C# interrupter or compiler to transfer the C# code to Objective C? But based on the Apple guideline, a interrupter or compiler application is not allow to submit on the AppStore. How is this magic going on? Thanks.

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-06-01T17:56:17.370

From the [Introduction to MonoTouch](http://docs.xamarin.com/ios/getting_started/introduction_to_monotouch) documentation:

> MonoTouch allows you to write native iOS applications using C# and the .NET Base Class Library (BCL). Via the magic of Mono’s compiler, applications built on the MonoTouch platform compile down directly to native ARM assembly code.

Since it is compiling down to ARM code, there is no interpretation happening on the device while your app is running, which is why apps are in compliance with the AppStore requirements.

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-06-01T17:57:41.190

In the documentation, [Introduction to MonoTouch](http://docs.xamarin.com/ios/getting_started/introduction_to_monotouch) (emphasis added):

> MonoTouch allows you to write native iOS applications using C# and the .NET Base Class Library (BCL). Via the magic of Mono’s compiler, applications built on the MonoTouch platform **compile down directly to native ARM assembly code.** This contrasts with compilers for traditional .NET applications that create Intermediate Language (IL) code that compiles at run time. Even things like generics, which used to rely on Just In Time (JIT) compilation are available via Mono’s Ahead Of Time (AOT) compiler.

So there is no interpreter. It compiles to native ARM assembly.

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-06-01T17:57:11.867

Please see [this press release](http://www.apple.com/pr/library/2010/09/09Statement-by-Apple-on-App-Store-Review-Guidelines.html) from Apple in 2010 which states that they have removed the restrictions on tools used to create iOS apps. (Hat tip to @ShaChris23's comment on [this question](https://stackoverflow.com/questions/1583856/how-to-decide-between-monotouch-and-objective-c).)

That explains why regular compilers are allowed - and as the other answers have explained, MonoTouch is a compiler, not an JIT interpreted/compiled language like Mono/.NET is on other platforms.

# vb.net - 如何计算列表视图列中的特定单词

> ID：10855024
> 
> 赞同：-2
> 
> 时间：2012-06-01T17:48:34.773
> 
> 标签：vb.net

我有一个表单，它是 1 个列表视图和一个文本框。
* 列表视图共有 100 行数据
* 列表视图有 5 列
* 第 3 列只有两个可能的词`yes`或`no`

我想计算第`yes`3 列中单词的出现次数

总行可以用这个代码计算：

```
''''''''''COUNT TOTAL ADMISSION''''''''''''''

Dim rowcount As Integer = 0

For Each item As ListViewItem In LVfeestatementBA_I.Items
  rowcount = CInt(item.SubItems(0).Text) 'Considering every column always have some value
Next

txttotaladBA_I.Text = rowcount.ToString() 
```

任何帮助都会很棒

**编辑 1**

这是学校的作业。正如我所说，我的目标是找出第 3 列中某个单词的出现次数。我有 MS 访问数据库，它与代码连接并为列表视图提供数据。列表视图有 5 列，共有 100 行。col-3 中的数据仅包含三个单词`gen`、`occ`和`cc`。现在想用代码计算 col-3 的单词并显示像 (68) 这样的数字`textbox1`

**编辑 2**

我应用了 thedarkspoon 提供的功能，但没有显示结果。我只希望结果显示在`textbox1`，例如。如果总字数是，`78`那么`form_load`它应该显示`78`在`textbox1`. 我通过最后添加`textbox1.text = numofyes`并更改变量从现在`integer`到`string`现在它的工作解决了这个问题

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T19:24:01.627

我不太了解您的情况（您必须更清楚）。

无论如何，给定一个 ListView，它显示每个项目都有 3 个子项目，并且我们知道第三个子项目将具有“是”或“否”的值，我们可以构建一个查询，如（使用 linq）：

```
 var collectionOfListViewItems = listView1.Items.Cast<ListViewItem>();
     var numberOfrowsWithTheThirdSubItemTextEqualToYes = (from c in collectionOfListViewItems where c.SubItems[3].Text == "yes" select c).Count(); 
```

如果没有 linq，你可以做一个 foreach：

```
 var numberOfrowsWithTheThirdSubItemTextEqualToYes = 0;
     foreach (ListViewItem  item in listView1.Items)
     {
        if (item.SubItems[3].Text == "yes")
           numberOfrowsWithTheThirdSubItemTextEqualToYes++;
     } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-02T17:19:13.717

好的，你去吧，我把它变成了一个函数，但你可以很容易地把它改成一个子程序：

```
Function countyes()
    'Set up a variable to count the number of yes:
    Dim numofyes As Integer = 0
    'Count the number of yes (Replace listview1 with the name of your listview):
    For Each item As ListViewItem In ListView1.Items
        'If the Yes/No is in column 3, you are looking in subitem 2:
        If item.SubItems(2).Text = "Yes" Then
            'Increment the variable by one if the value is yes:
            numofyes = numofyes + 1
        End If
    Next
    'Return our total number of Yes that we found:
    Return numofyes
End Function 
```

希望这可以帮助！

# jquery - jquery 加载回调函数失败

> ID：10855028
> 
> 赞同：3
> 
> 时间：2012-06-01T17:49:17.763
> 
> 标签：jquery, asynchronous, load

我一直在阅读有关此问题的几个问题，但我没有找到解决问题的方法。对不起，如果我重复之前问过的事情。

在代码中：

```
$("#menuZone").load("northMenu.jsp", function(response, status, xhr) {
                if (status == "error") {
                    var msg = "Error found: ";
                    alert(msg + xhr.status + " " + xhr.statusText);
                }else{
                    // hide admin menus
                    $('.admin').hide();
                }
            }); 
```

我要做的是从**“northMenu.jsp”**加载一个无序列表并隐藏具有 class 的项目（li 标签）`admin`。

在上面的代码中，带有 的项目`class`没有*被隐藏*，但是完整`html`的被完美地插入了`#menuZone`.

之后，在其他地方调用函数来显示和隐藏该项目，工作正常。

在[jquery load doc](http://api.jquery.com/load/)中说，*“如果提供了完整的回调，则在后处理和 HTML 插入完成后执行”*。

所以，问题不应该是异步问题！或者可以吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-01T20:30:15.477

Since [this fiddle](http://jsfiddle.net/qMyzu/) is working for you, it does not seem to be an issue with your browser. Assuming nothing in your code is tampering with `load()` (a reasonable assumption IMHO), that only leaves two possible explanations:

1.  `$(".admin")` matches nothing because the markup coming from the AJAX request does not contain `class` attributes, and these attributes are added by code somewhere down the line.

2.  The elements are actually hidden, but are shown again immediately afterwards by another part of the code (you mentioned other AJAX requests being performed in your question's comments).

Therefore, I'd suggest you instrument your `complete` callback by adding an `alert()` call:

```
// Hide admin menus.
$(".admin").hide();
alert($(".admin").length); 
```

There are three possible outcomes:

*   The alert prints `0`, which means *(1) is true*.
*   The alert prints a number greater than `0`, in which case:
    *   Without dismissing the alert box, check if the `.admin` elements are visible,
        *   If they aren't, then *(2) is true*.
        *   If they are, then *something else I failed to think of is true*.

# php - 时间差异

> ID：10855035
> 
> 赞同：0
> 
> 时间：2012-06-01T17:50:00.663
> 
> 标签：php, postgresql, date, timestamp

我是 PostgresQL 和 PHP 的新手，正在使用 PostgresQL Timestamp 对象，并试图找出现在和那个时间戳之间的差异，以年、月和日的形式显示。有这样做的吗？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-01T18:08:34.840

```
select age(now(), '2010-01-02 12:34:35'); 
```

完整版：

```
select substring(a from 1 for (position('days' in a) + 3)) 
from (select (age(now(), '2010-01-02 12:34:35'))::text) s(a)
;
       substring        
------------------------
 2 years 4 mons 30 days
(1 row) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-01T18:11:55.880

你可以减去两个时间戳，结果是一个[`interval`](http://www.postgresql.org/docs/current/interactive/datatype-datetime.html).
要获得“现在”，您可以使用`now()`或`current_timestamp`（除其他外）。

```
SELECT now() - '2010-02-21 20:11:32'; 
```

不过，这将显示如下内容：

```
830 days 23:00:50.127241 
```

要获得合理的陈述，请使用[`age()`或`justify_interval()`](http://www.postgresql.org/docs/current/interactive/functions-datetime.html#FUNCTIONS-DATETIME-TABLE)

```
SELECT justify_interval(now() - '2010-02-21 20:11:32'); 
```

以您似乎喜欢的格式显示相同的值：

```
2 years 3 mons 20 days 23:01:34.095813 
```

如果您想要特定的输出格式，请使用[`to_char()`](http://www.postgresql.org/docs/current/interactive/functions-formatting.html)

# c++ - 从标准输出读取的奇怪性能问题

> ID：10855038
> 
> 赞同：2
> 
> 时间：2012-06-01T17:50:25.227
> 
> 标签：c++, linux, ipc, stdout, c++-standard-library

我正在研究一些将用于测试其他可执行文件的代码。为方便起见，我将我的代码称为测试器，将被测试的代码称为客户端。测试器将生成客户端并向客户端的标准输入发送命令，并从客户端的标准输出接收结果。

我想先做一些性能测试，所以我写了一个非常简单的示例测试器和客户端。测试仪等待客户端将“READY”写入其标准输出，并作为响应将“GO”发送到客户端的标准输入。然后客户端将一些字节数写入标准输出，通过命令行标志配置，然后写入“\nREADY\n”，此时测试仪将再次写入“GO”。这会重复 10,000 次，然后我计算完成测试所需的时间和“吞吐量”，即 10,000 除以完成时间。

我运行了上述测试，让客户端在发送“READY”之前发送 0、10、100、1000、10000 和 100000 字节的数据。对于每个字节大小，我重复测试 10 次并取平均值。在我的笔记本电脑上运行 Ubuntu VMWare 实例时，我获得了每秒大约 100k GO/READY 对的吞吐量。性能相当稳定，几乎不依赖于客户端发送给测试仪的二进制字节数。然后我在运行 CentOS 的速度非常快的 24 核服务器上重复了测试。对于 0 字节有效负载，我观察到每秒只有大约 55k GO/READY 对，并且随着客户端发送的字节数增加，性能明显下降。当客户端在“GO”和“READY”之间发送 100k 字节时，吞吐量仅为每秒大约 6k 次操作。

所以我有三个问题

1.  为什么相同的代码在更快的机器上运行得更慢
2.  为什么虚拟机的性能与负载大小无关，而快速服务器上的性能却严重依赖负载大小？
3.  我能做些什么来让服务器上的事情变得更快吗

一种可能的解释是我在快速服务器上重新编译了代码，并且它使用了不同版本的 C++ 库。VMWare 机器运行 Ubuntu 11.10，快速服务器运行 CentOS 6。两者都是 64 位机器。

相关测试器代码如下：

```
ios_base::sync_with_stdio(false);
const int BUFFER_SIZE = 2 << 20;
char buffer[BUFFER_SIZE];
process_stdout->rdbuf()->pubsetbuf(buffer, BUFFER_SIZE);
Timer timer;
// Wait until the process is ready
string line;
line.reserve(2 << 20);
getline(*process_stdout, line);
CHECK(line == "READY");
timer.Start();
for (int i = 0; i < num_trials; ++i) {
  *process_stdin << "GO\n";
  process_stdin->flush();
  line = "";
  while (line != "READY") {
    getline(*process_stdout, line);
  }
}
double elapsed = timer.Elapsed();
cout << "Done. Did " << num_trials << " iterations in "
     << elapsed << " seconds. Throughput: "
     << double(num_trials) / elapsed << " per second." << endl; 
```

我还尝试了使用 read() 调用（来自 unistd.h）到 1MB 缓冲区并调用 memchr 以查找“\n”字符并查找 READY 的版本，但得到了相同的性能结果。

相关客户端代码如下：

```
// Create a vector of binary data. Some portion of the data will be sent 
// to stdout each time a "GO" is received before sending "READY"
vector<char> byte_source;
const int MAX_BYTES = 1 << 20;
for (int i = 0; i < MAX_BYTES; ++i) {
 byte_source.push_back(i % 256);
}

cout << "READY" << endl;
while (cin.good()) {
  string line;
  getline(cin, line);
  if (line == "GO") {
    // The value of response_bytes comes from a command line flag
    OutputData(response_bytes, byte_source);
    cout << "READY" << endl;
  }
}

// write bytes worth of data from byte_source to stdout
void OutputData(unsigned int bytes,
                const vector<char>& byte_source) {
  if (bytes == 0) {
    return;
  }
  cout.write(&byte_source[0], bytes);
  cout << "\n";
} 
```

任何帮助将不胜感激！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-01T18:39:46.227

VM 中的速度与有效负载大小无关这一事实表明您做错了什么。这些不是完整的程序，因此很难确定是什么。使用 strace 查看发生了什么，即客户端是否确实发送了您认为的所有数据（并检查测试人员是否正在接收应有的所有数据）。

100k READY/GO 对太多了；它基本上接近每秒上下文切换次数的上限，没有做任何其他事情。

# java - 修改文本文件中的数据

> ID：10855039
> 
> 赞同：0
> 
> 时间：2012-06-01T17:50:28.750
> 
> 标签：java, android, file-io, text-files, edit

已经创建了一个文件，该文件存储数据以“，”分隔并以“;”结尾的记录。

到目前为止，我已经能够追加到文件中，但现在**我需要更新记录中的特定元素**。每条记录都以唯一标识符开头。

下面是如何打开文件并将每个唯一 ID 读入数组的示例：

```
DataInputStream fin = new DataInputStream(openFileInput("Updates.txt"));
try {
    for (;;) {
    String record = fin.readUTF();
    Log.d(DEBUG_TAG, "Record "+record);
    elements = record.split(",");
    String trackingNo = elements[0];
    UpdateRecord item = new UpdateRecord(trackingNo);
    }
}
catch (EOFException e) {
    Log.i("Data Input Sample", "End of file reached");
}
fin.close(); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-12-12T06:27:38.953

```
Sub example1()
Dim strFinal As String
Dim strline As String

Open "D:\textfile.txt" For Input As #1
    While EOF(1) = False
        Line Input #1, strline
        If Len(strline) > 24 Then
            strFinal = strFinal + ModifyColumn(strline)
            Else
            strFinal = strFinal + strline + vbCrLf
        End If
    Wend
    strFinal = strFinal
Close #1

Open "D:\textfile.txt" For Output As #1
    Print #1, strFinal
Close #1
End Sub

Function ModifyColumn(ByVal strInput As String) As String
    Dim arrString() As String
    Dim strOutput As String
    'split the columns
    arrString = Split(strInput, vbTab)
    'concatenate the first 2 column as they are
    strOutput = arrString(0) + vbTab + arrString(1) + vbTab + arrString(2)
    'add 100$ to column3
    requirevalue = Left(arrString(3), InStr(1, arrString(3), "|") - 1)
    last3Digit = Right(requirevalue, 3)
    If Left(requirevalue, 3) = "max" Then
        Newvalue = vbTab + "OTPxxxxxx" & last3Digit & "|" & Right(arrString(3), Len(arrString(3)) - InStr(1, arrString(3), "|")) + vbCrLf
    Else
        Newvalue = vbTab + arrString(3) + vbCrLf
    End If
    strOutput = strOutput & Newvalue
    'strOutput = strOutput + Strings.Trim(Str(CDbl(Left(arrString(3), Len(arrString(2)) - 1)) + 100)) + "$" + vbCrLf
    ModifyColumn = strOutput
End Function`enter code here` 
```

# python - 将 Tweety（python 模块）搜索结果写入 CSV

> ID：10855042
> 
> 赞同：0
> 
> 时间：2012-06-01T17:50:43.963
> 
> 标签：python, twitter, csv

这是我正在使用的简单代码：

```
import tweepy

result = tweepy.api.search(q="McDonalds ",rpp=1000,page=2, geocode= "34.085422,-117.900879,100mi" )

for tweet in result:
    print tweet.text
    print tweet.geo 
```

它返回我想要的结果。在我的 IDE 中，我得到如下结果：

```
@stevo_k14 I'm going back after mcdonalds haha

None

“@FunnyEvil: If bars can't serve drunk people, Mcdonalds shouldn't be able to serve fat people.”

{u'type': u'Point', u'coordinates': [33.9581, -118.1779]}

Mcdonalds for breakfast? Yup i think so :)

None

@JessicaCarrillo You make me want to go out to McDonalds right now!!!!! Lol good morning.

{u'type': u'Point', u'coordinates': [33.9443, -118.0038]} 
```

有些返回没有位置，有些返回位置。我真正想做的是将结果直接写入一个 csv 文件，其中包含关键字、Tweet、Lat、Lon 作为我的标题。在这种情况下，关键字将是“麦当劳”。最好有一些 ifelse 语句不写结果，除非它们有位置。

我是编程新手，非常感谢您的帮助！谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T18:02:46.540

您可以只使用 csv 模块并迭代您现有的推文。

```
import tweepy
import csv

keyword = 'McDonalds '
result = tweepy.api.search(q=keyword,rpp=1000,page=2, geocode= "34.085422,-117.900879,100mi" )

with open('some.csv', 'w') as acsv:
    w = csv.writer(acsv)
    w.writerow(('Keyword', 'Tweet', 'Lat', 'Lon'))
    for tweet in result:
        lat, lon = tweet.geo if tweet.geo else ('', '')
        w.writerow((keyword, tweet.text, lat, lon)) 
```

# java - 在 Java 中并行执行依赖任务

> ID：10855045
> 
> 赞同：16
> 
> 时间：2012-06-01T17:50:49.413
> 
> 标签：java, multithreading

我需要找到一种在java中并行执行任务（依赖和独立）的方法。

1.  任务 A 和任务 C 可以独立运行。
2.  任务 B 依赖于任务 A 的输出。

我检查了 java.util.concurrent Future 和 Fork/Join，但看起来我们无法向任务添加依赖项。

谁能指出我纠正Java API。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2014-09-12T03:33:29.507

在 Scala 中，这很容易做到，而且我认为您最好使用 Scala。这是我从这里提取的一个示例[http://danielwestheide.com/（Scala](http://danielwestheide.com/)新手指南第 16 部分：从这里出发）这个人有一个很棒的博客（我不是那个人）

让我们请一位咖啡师煮咖啡。要做的任务是：

1.  研磨所需的咖啡豆（无先前任务）
2.  加热一些水（没有前面的任务）
3.  使用研磨咖啡和热水冲泡浓缩咖啡（取决于 1 和 2）
4.  起泡一些牛奶（没有之前的任务）
5.  将泡沫牛奶和浓缩咖啡混合（取决于 3,4）

或作为一棵树：

```
Grind   _
Coffe    \
          \   
Heat    ___\_Brew____ 
Water                \_____Combine
                     /
Foam    ____________/
Milk 
```

在使用并发 api 的 java 中，这将是：

```
import java.util.concurrent.Callable;
import java.util.concurrent.ExecutionException;
import java.util.concurrent.ExecutorService;
import java.util.concurrent.Executors;
import java.util.concurrent.Future;
import java.util.concurrent.FutureTask;
import java.util.concurrent.TimeUnit;
import java.util.concurrent.TimeoutException;

public class Barrista {

    static class HeatWater implements Callable<String> {
        @Override
        public String call() throws Exception {
            System.out.println("Heating Water");
            Thread.sleep(1000);
            return "hot water";
        }
    }

    static class GrindBeans implements Callable<String> {
        @Override
        public String call() throws Exception {
            System.out.println("Grinding Beans");
            Thread.sleep(2000);
            return "grinded beans";
        }
    }

    static class Brew implements Callable<String> {

        final Future<String> grindedBeans;
        final Future<String> hotWater;

        public Brew(Future<String> grindedBeans, Future<String> hotWater) {
            this.grindedBeans = grindedBeans;
            this.hotWater = hotWater;
        }

        @Override
        public String call() throws Exception
        {
            System.out.println("brewing coffee with " + grindedBeans.get()
                    + " and " + hotWater.get());
            Thread.sleep(1000);
            return "brewed coffee";
        }
    }

    static class FrothMilk implements Callable<String> {

        @Override
        public String call() throws Exception {
            Thread.sleep(1000);
            return "some milk";
        }
    }

    static class Combine implements Callable<String> {

        public Combine(Future<String> frothedMilk, Future<String> brewedCoffee) {
            super();
            this.frothedMilk = frothedMilk;
            this.brewedCoffee = brewedCoffee;
        }

        final Future<String> frothedMilk;
        final Future<String> brewedCoffee;

        @Override
        public String call() throws Exception {
            Thread.sleep(1000);
            System.out.println("Combining " + frothedMilk.get() + " "
                    + brewedCoffee.get());
            return "Final Coffee";
        }

    }

    public static void main(String[] args) {

        ExecutorService executor = Executors.newFixedThreadPool(2);

        FutureTask<String> heatWaterFuture = new FutureTask<String>(new HeatWater());
        FutureTask<String> grindBeans = new FutureTask<String>(new GrindBeans());
        FutureTask<String> brewCoffee = new FutureTask<String>(new Brew(grindBeans, heatWaterFuture));
        FutureTask<String> frothMilk = new FutureTask<String>(new FrothMilk());
        FutureTask<String> combineCoffee = new FutureTask<String>(new Combine(frothMilk, brewCoffee));

        executor.execute(heatWaterFuture);
        executor.execute(grindBeans);
        executor.execute(brewCoffee);
        executor.execute(frothMilk);
        executor.execute(combineCoffee);

        try {

            /**
             *  Warning this code is blocking !!!!!!!
             */         
            System.out.println(combineCoffee.get(20, TimeUnit.SECONDS));
        } catch (InterruptedException e) {
            e.printStackTrace();
        } catch (ExecutionException e) {
            e.printStackTrace();
        } catch (TimeoutException e) {
            System.out.println("20 SECONDS FOR A COFFEE !!!! I am !@#! leaving!!");
            e.printStackTrace();
        } finally{
                executor.shutdown();
            }
        }
    } 
```

确保添加超时以确保您的代码不会永远等待某事完成，这是通过使用 Future.get(long, TimeUnit) 完成的，然后相应地处理失败。

但是在 scala 中要好得多，这里就像在博客上一样：准备一些咖啡的代码看起来像这样：

```
def prepareCappuccino(): Try[Cappuccino] = for {
  ground <- Try(grind("arabica beans"))
  water <- Try(heatWater(Water(25)))
  espresso <- Try(brew(ground, water))
  foam <- Try(frothMilk("milk"))
} yield combine(espresso, foam) 
```

所有方法都返回一个未来（类型为未来），例如研磨将是这样的：

```
def grind(beans: CoffeeBeans): Future[GroundCoffee] = Future {
   // grinding function contents
} 
```

对于所有实现，请查看博客，但仅此而已。您也可以轻松集成 Scala 和 Java。我真的建议在 Scala 而不是 Java 中做这种事情。Scala 需要更少的代码、更简洁和事件驱动。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-01T18:30:45.590

具有依赖关系的任务的通用编程模型是[Dataflow](http://en.wikipedia.org/wiki/Dataflow_programming)。每个任务只有一个但重复的依赖的简化模型是[Actor 模型](http://en.wikipedia.org/wiki/Actor_model)。Java 有很多 Actor 库，但用于数据流的却很少。另请参阅：[which-actor-model-library-framework-for-java](https://stackoverflow.com/questions/3357332/which-actor-model-library-framework-for-java)，[java-pattern-for-nested-callbacks](https://stackoverflow.com/questions/10695152/java-pattern-for-nested-callbacks)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-01T18:38:55.413

使用阻塞队列。将任务 A 的输出放入队列，任务 B 阻塞，直到队列中有可用的内容。

文档包含实现此目的的示例代码：http: [//docs.oracle.com/javase/6/docs/api/java/util/concurrent/BlockingQueue.html](http://docs.oracle.com/javase/6/docs/api/java/util/concurrent/BlockingQueue.html)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2018-10-21T14:56:54.057

Java 定义了一个 CompletableFuture 类。

[https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/CompletableFuture.html](https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/CompletableFuture.html)

这就是你要找的。它有助于构建执行流程。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-01T18:24:37.393

如果任务 B 依赖于任务 A 的输出，我首先会质疑任务 B 是否真的是一个单独的任务。如果存在以下情况，分离任务将是有意义的：

*   在需要任务 A 的结果之前，任务 B 可以做的一些重要的工作
*   任务 B 是一个长期持续的过程，它处理来自任务 A 的许多不同实例的输出
*   还有一些其他任务（比如 D）也使用任务 A 的结果

假设它是一个单独的任务，那么您可以允许任务 A 和 B 共享一个`BlockingQueue`，以便任务 A 可以传递任务 B 数据。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-06-01T18:01:23.663

你需要的是一个[CountDownLatch](http://docs.oracle.com/javase/6/docs/api/java/util/concurrent/CountDownLatch.html)。

```
final CountDownLatch gate = new CountDownLatch(2);
// thread a
new Thread() {
    public void run() {
        // process
        gate.countDown();
    }
}.start();

// thread c
new Thread() {
    public void run() {
        // process
        gate.countDown();
    }
}.start();

new Thread() {
    public void run() {
        try {
            gate.await();
            // both thread a and thread c have completed
            // process thread b
        } catch (InterruptedException e) {
            e.printStackTrace();
        }

    }
}.start(); 
```

作为替代方案，根据您的场景，您也可以使用[BlockingQueue](http://docs.oracle.com/javase/6/docs/api/java/util/concurrent/BlockingQueue.html)来实现生产者-消费者模式。请参阅文档页面上的示例。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2016-06-24T18:44:21.483

使用这个库[https://github.com/familysyan/TaskOrchestration](https://github.com/familysyan/TaskOrchestration)。它为您管理任务依赖性。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2016-08-23T17:46:40.503

有一个专门用于此目的的 java 库（免责声明：我是这个库的所有者），称为[Dexecutor](https://github.com/dexecutor/dependent-tasks-executor)

[这是您如何获得所需结果的方法，您可以在此处](https://github.com/dexecutor/dependent-tasks-executor/wiki)阅读有关它的更多信息

```
@Test
public void testDependentTaskExecution() {

    DefaultDependentTasksExecutor<String, String> executor = newTaskExecutor();

    executor.addDependency("A", "B");
    executor.addIndependent("C");

    executor.execute(ExecutionBehavior.RETRY_ONCE_TERMINATING);

}

private DefaultDependentTasksExecutor<String, String> newTaskExecutor() {
    return new DefaultDependentTasksExecutor<String, String>(newExecutor(), new SleepyTaskProvider());
}

private ExecutorService newExecutor() {
    return Executors.newFixedThreadPool(ThreadPoolUtil.ioIntesivePoolSize());
}

private static class SleepyTaskProvider implements TaskProvider<String, String> {

    public Task<String, String> provid(final String id) {

        return new Task<String, String>() {

            @Override
            public String execute() {
                try {
                    //Perform some task
                    Thread.sleep(500);
                } catch (InterruptedException e) {
                    e.printStackTrace();
                }
                String result = id + "processed";
                return result;
            }

            @Override
            public boolean shouldExecute(ExecutionResults<String, String> parentResults) {
                ExecutionResult<String, String> firstParentResult = parentResults.getFirst();
                //Do some logic with parent result
                if ("B".equals(id) && firstParentResult.isSkipped()) {
                    return false;
                }
                return true;
            }
        };          
    }

} 
```

# silverlight - 获取 XAP 中包含的文件的版本信息

> ID：10855047
> 
> 赞同：1
> 
> 时间：2012-06-01T17:51:03.597
> 
> 标签：silverlight, version, xap

我的 silverlight 项目中包含一个包含构建操作内容的文件。我需要以某种方式从代码中获取版本信息。有没有办法解决这个问题？

# javascript - javascript [object Object] 到字符串

> ID：10855048
> 
> 赞同：6
> 
> 时间：2012-06-01T17:51:03.887
> 
> 标签：javascript, jquery, html, json

我将从一点背景开始。

所以我想做的是从元素中获取“样式”属性，最终的计划是将其输出到文本框（样式是动态的）。有了这个，我创建了一些 CSS 前缀，因为我只获取计算样式。

有了这个，我有一个带有一堆 css 属性的变量，如下所示：

```
compcss = {
                'font-size': fsize,
                'padding': tpadd,

                '-webkit-border-radius': brad,
                '-moz-border-radius': brad,
                '-o-border-radius': brad,
                '-ms-border-radius': brad,
                'border-radius': brad,

                'background': bground,
                'background-m': bgmoz,
                'background-o': bgop,
                'background-i': bgie,
                'color': 'white',
                'text-shadow': '0 -1px 0 rgba(0, 0, 0, 0.25)',
                'text-decoration': 'none',
                'border': '1px solid rgba(0, 0, 0, 0.1) rgba(0, 0, 0, 0.1) rgba(0, 0, 0, 0.25)',

            }; 
```

通常 fsize、tpadd、brad 和 bground 用

```
document.defaultView.getComputedStyle(cssStr[0], "")[style] 
```

但是对于以下 jsbin，我输入了静态数字。

这将`[object Object]`在记录或放入文本框中时返回，这是意料之中的。但是，我希望这个对象以字符串形式输出：

```
font-size: Xpx;
padding: Ypx;
-webkit-border-radius: Zpx; 
```

依此类推，我尝试过 JSON.stringify(compcss)，但返回为：

```
"font-fize":"Xpx","padding":"Ypx","-webkit-border-radius":"Zpx" 
```

一直到线下。

让它以我想要的方式输出的最佳方法是什么？让我知道是否有任何需要澄清的地方。有没有更好的方法来解决这个问题？

这是一个 jsbin 例如：http: [//jsbin.com/opiwuy/2/edit](http://jsbin.com/opiwuy/2/edit)

Vanilla Javascript 和 JQuery 都很好。

谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-01T17:59:02.187

```
 var value = '';
  $.each(compcss, function(key, val) {
    value += key + ' : ' + val + ';' +'\n';
  });
  $('#css').val(value); 
```

**[演示](http://jsbin.com/onovus/4/edit#source)**

你也可以做

```
$('#css').val(function() {
    var value = '';
    $.each(compcss, function(key, val) {
      value += key + ' : ' + val + ';' + '\n';
    });
    return value;
}); 
```

**[演示](http://jsbin.com/equqet/2/edit#source)**

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-01T18:04:35.400

像这样的东西可能会满足您的需求：

```
function cssStringify(myObject) {
    var result = "";
    var stringObjs = JSON.stringify(myObject).split(",");
    $.each(stringObjs, function(val) {
        var pair = val.split(":");
        result = result + pair[0] + ":" + pair[1] + ";\n";
    });
    return result;
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-01T18:12:57.540

只是扔掉我的版本`.replace`

```
var xx = JSON.stringify(compcss); 
$('#csjson').val(
    xx.replace(/":"|":/g, ":")
      .replace(/,"/g, "\n")
      .replace(/"/g, "")); 
```

**演示：http:** [//jsbin.com/opiwuy/4](http://jsbin.com/opiwuy/4)

# ios - XCode 提示自动补全的速度很慢

> ID：10855050
> 
> 赞同：2
> 
> 时间：2012-06-01T17:51:17.153
> 
> 标签：ios, xcode, xcode4.3

当我在工作时在我的 MacBook Pro 上使用 Xcode 进行编码时，自动建议似乎需要 6-8 秒。在我家里的 MacBook Air 上，它们会立即出现。

这有什么原因吗？我在 Xcode 的首选项中看不到任何会导致此问题的内容： ![Xcode 首选项屏幕截图](../Images/111c46bc879f6535d932d3292cd57584.png)

这里有什么想法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-01T22:26:11.617

我有一台闪亮的新 iMac 正在开发中。这是一个i7 proc，8 GB内存。索引（以及随之而来的东西，例如代码感知或快速文档）需要很长时间（大约 600 个文件需要 5 分钟）。编译也是如此。

罪魁祸首原来是公司防病毒软件的访问扫描。对于相同数量的文件，我禁用了访问扫描和索引下降到大约 5 秒。如果您有权更改防病毒设置，可能值得一试。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-01T18:57:17.153

在我关注的一个开发者博客上（我目前找不到链接），作者说他经常不得不删除他的项目的 DerivedData 文件夹，因为损坏会导致这样的问题。试一试，看看它是否有帮助。

它不是 SSD 与非 SSD。我的 2009 MacBook Pro 几乎可以立即显示建议。

# java - 如何将虚拟机添加到库存？

> ID：10855051
> 
> 赞同：1
> 
> 时间：2012-06-01T17:51:17.813
> 
> 标签：java, vmware, datastore, esx

我正在为 VMware ESX 编写代码以将 .vmx 文件添加到清单中。此操作应与在 GUI 中进入数据存储并右键单击 .vmx 文件 --> 添加到清单相同。

我相信我应该使用方法 registerVM_Task() 并且我缺少的唯一参数是“主机”。

有人有什么想法吗？

# javascript - Google Maps API 3 - 绑定后删除圆圈

> ID：10855052
> 
> 赞同：1
> 
> 时间：2012-06-01T17:51:24.007
> 
> 标签：javascript, jquery, google-maps-api-3

我一生都无法弄清楚为什么`setMap(null)`不起作用。我真的很不高兴有多少关于使用 bindTo 添加覆盖的文档，但没有一个关于如何删除它的词。我究竟做错了什么？

我正在`.radius_type`点击创建圆圈。然后，当我将下拉菜单切换为不同的形状时，它不会删除圆圈。

我这样称呼地图：

```
var map = new google.maps.Map(document.getElementById('map'), {...}

// this toggles the shapes, but I can't get it to remove the circle for the marker
$('.radius_type.selectee').click(function(){
      var shape = $(this).find('span').html();
      var opts= {...};

    switch(shape){
        case 'circle':  // Here is the added circle to the second marker.
            var circle = new google.maps.Circle(opts);
            circle.setOptions({radius:17063,map:map});
            circle.bindTo('center',markers[1],'position');

            // It binds, now how to remove it?

            break;

        case 'square':
            //tried - circle.setMap(null);
            //tried - map.setMap(null);
            //tried - google.map.event.setMap(null);
            //tried - every web page on the topic.
            //
            // I don't understand how to unbind the circle from the marker.
            var rect = new google.maps.rect(opts);

            break;

        case 'draw':
            draw.setDrawingMode(google.maps.drawing.OverlayType.POLYGON);
            break;
    }
}); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-16T15:47:09.013

用于 `$('element').on('change',function())`删除圆圈

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-04-11T12:01:53.453

您可以尝试以下代码片段：

```
circle.setCenter(null); 
circle.unbind('center'); 
```

# mysql - 将MYSQL中的44替换为0？

> ID：10855060
> 
> 赞同：0
> 
> 时间：2012-06-01T17:52:14.493
> 
> 标签：mysql, database

如何在 MySQL 中将前 44 位替换为 0？

例如：

4476384424131 至 076384424131

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-01T17:55:38.297

使用字符类型和[子字符串函数](http://dev.mysql.com/doc/refman/5.5/en/string-functions.html#function_substr)，您可以简单地切断最初的 '44' 并将其替换为连接回来的零。

```
UPDATE tbl
  SET num = CONCAT('0', SUBSTR(num, 3))
WHERE LEFT(num, 2) = '44' 
```

（编辑：修复了 WHERE 子句以使用`LEFT()`而不是`SUBSTR()`）

```
mysql> SELECT CONCAT('0', SUBSTR(4476384424131, 3));
+-----------------------------------------+
| CONCAT('0', SUBSTR(4476384424131, 3))   |
+-----------------------------------------+
| 076384424131                            |
+-----------------------------------------+ 
```

# java - Robotium 测试项目在 Eclipse 中构建，但不在 ant 中

> ID：10855062
> 
> 赞同：1
> 
> 时间：2012-06-01T17:52:26.787
> 
> 标签：java, android, eclipse, ant, robotium

如何配置 ant 以包含来自单独项目/单独目录结构的类文件？

我正在尝试用ant构建一个robotium android测试项目。测试项目引用的不是robotium jar，而是robotium 源代码，我对它进行了一些修改（添加了一个方法和一些日志记录）。但是，当我现在尝试运行 ant 调试时，编译器看不到机器人代码。

我如何告诉 ant 包含其他目录中的那些机器人类？在eclipse中它工作正常，因为我在构建路径中有robotium项目。在蚂蚁中寻找等价物。

谢谢！！

```
-compile:
[javac] Compiling 3 source files to /Users/swolfe/Documents/git/android/automation-suite/sandbox/bin/classes
[javac] /Users/swolfe/Documents/git/android/automation-suite/sandbox/src/com/foobar/bookings/test/SearchTestHoneycomb.java:9: package com.jayway.android.robotium.solo does not exist
[javac] import com.jayway.android.robotium.solo.Solo;
[javac]                                        ^
[javac] /Users/swolfe/Documents/git/android/automation-suite/sandbox/src/com/foobar/bookings/test/SearchTestHoneycomb.java:15: cannot find symbol
[javac] symbol  : class Solo
[javac] location: class com.foobar.bookings.test.SearchTestHoneycomb
[javac]     private Solo solo;
[javac]             ^
[javac] /Users/swolfe/Documents/git/android/automation-suite/sandbox/src/com/foobar/bookings/test/SearchTestHoneycomb.java:23: cannot find symbol
[javac] symbol  : class Solo
[javac] location: class com.foobar.bookings.test.SearchTestHoneycomb
[javac]         solo = new Solo(getInstrumentation(), getActivity());
[javac]                    ^
[javac] 3 errors 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-24T07:30:02.837

你可以 jar 修改过的 Robotium 类，然后把这个文件放到 sandbox/libs

# javascript - iScroll4 中的无限滚动或改善惯性/动量

> ID：10855063
> 
> 赞同：3
> 
> 时间：2012-06-01T17:52:26.927
> 
> 标签：javascript, animation, iscroll4

几个月来我一直试图弄清楚这一点，并且已经用尽了我能想到的一切。

我想要实现的是：[http](http://blue.bluestudios.kenzomedia.com/v0.7/) : //blue.bluestudios.kenzomedia.com/v0.7/（从 iScroll4 借来的一些逻辑）

请注意，您可以继续滚动。这在该示例中工作正常。问题是它不像 iScoll4 那样完全平滑。

所以我一直在尝试使用 iScroll4 和 blue.bluestudios.kenzomedia.com/v0.8/ 来做同样的事情，但我似乎无法弄清楚如何让它正确“重复”。它似乎与 startX 和 startY 相关，但此时我已经尝试了很多不同的代码，真的想不出其他任何事情要做。如果您只是移动鼠标/手指，它将毫无问题地重复。仅在动画时。

[http://blue.bluestudios.kenzomedia.com/v0.8/assets/js/libs/iscroll.ext.js](http://blue.bluestudios.kenzomedia.com/v0.8/assets/js/libs/iscroll.ext.js)这是我有工作 _move 功能的地方。

同样，尝试在动画函数中做同样的事情，但没有运气。

在这一点上的任何建议都会非常有帮助。这是为了弄清楚如何让 iScroll4 做我想做的事情或改进 v0.7 上的动画。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-02T08:33:14.933

我看到您的 iscroll 包装器 div 中有太多嵌套元素。删除所有不需要的 div。这会降低性能。我只是做了一个简单的测试，删除了firebug中的一些嵌套元素，性能得到了极大的提升。由于[http://cubiq.org/iscroll-4中的文档](http://cubiq.org/iscroll-4) **尽量保持 DOM 结构尽可能简单，删除所有不必要的标签并避免过多的嵌套元素**。我相信一旦您尝试了这将使您的 iscroll 顺利

# .net - 拦截/覆盖自定义控件上的名称属性？

> ID：10855065
> 
> 赞同：2
> 
> 时间：2012-06-01T17:52:30.210
> 
> 标签：.net, vb.net, user-controls, controls

我有一个标签控件的自定义版本（使用用户控件构建）。在设计器中工作时，我想截取 Name 属性的设置（在属性面板中）并使用它来生成 Text 属性。也就是说，如果我在属性面板的 Name 属性中输入“lblFirstName”，我想立即看到 Text 属性设置为“First Name”。

解析 Name 属性不是问题；我能做到。

我试图重载/隐藏 Name 属性（因为不允许“覆盖”）以本质上将此“方面”添加到我们的自定义标签控件中，但它似乎在设计时没有命中 Shadowed 方法。如果通过代码进行操作，它会在运行时触发 Shadowed 方法。

关键是要避免重复工作，因为标签文本和标签名称本质上是相同的。唯一的区别是一个被格式化为对人类友好，另一个被格式化为对机器友好。

```
<System.ComponentModel.Browsable(True),
 System.ComponentModel.ParenthesizePropertyName(),
 System.ComponentModel.DesignerSerializationVisibility(System.ComponentModel.DesignerSerializationVisibility.Visible)>
Public Shadows Property Name As String
    Get
        Return MyBase.Name
    End Get
    Set(value As String)
        MyBase.Name = value
        If Me.DesignMode Then
            Me.Text = Humanize(value)
        End If
        Me.Invalidate()
    End Set
End Property 
```

这可能是选择正确属性的问题。我不知道。

相反，如果它是一个更简单的选择，我们可以允许设置 Text 属性来设置 Name 属性。我怀疑这会更容易，因为它还应该反映 Designer.vb 代码中的新名称，而不仅仅是标签的 Name 属性本身。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-01T18:53:31.537

您可以使用一些额外的设计时元素来做到这一点。这`IComponentChangeService`是您设计时间更改事件的钩子。

```
Imports System.ComponentModel.Design
Imports System.ComponentModel

Class RenameLabel
     Inherits System.Windows.Forms.Label
     Private WithEvents _compChServ As IComponentChangeService

     Public Overrides Property Site() As ISite
         Get
            Return MyBase.Site
         End Get
         Set(ByVal Value As ISite)
            If _compChServ IsNot Nothing Then _
               RemoveHandler _compChServ.ComponentRename, AddressOf nameChanged

            MyBase.Site = Value

            _compChServ = CType(GetService(GetType(IComponentChangeService)), _
                          IComponentChangeService)

            If _compChServ IsNot Nothing Then _
               AddHandler _compChServ.ComponentRename, AddressOf nameChanged
         End Set
    End Property

    Private Sub nameChanged(ByVal sender As Object, ByVal e As _
                            ComponentRenameEventArgs)
         'Add your change code here
         Me.Text = Me.Name
    End Sub

    Protected Overrides Sub Dispose(ByVal disposing As Boolean)
        If disposing Then
            If _compChServ IsNot Nothing Then _
               RemoveHandler _compChServ.ComponentRename, AddressOf nameChanged
        End If
        MyBase.Dispose(disposing)
    End Sub

End Class 
```

[MSDN - IComponentChangeService](http://msdn.microsoft.com/en-us/library/system.componentmodel.design.icomponentchangeservice%28v=vs.90%29.aspx)

[MSDN - 网站](http://msdn.microsoft.com/en-us/library/system.componentmodel.component.site%28v=vs.90%29.aspx)

**编辑**：添加了处理代码！

# html - CSS 对齐 div 中的文本

> ID：10855068
> 
> 赞同：0
> 
> 时间：2012-06-01T17:53:09.600
> 
> 标签：html, css

我想创建一个标题，其中一些单词与标题的最左侧`div`对齐，一些单词与最右侧对齐。我最初通过创建`span`s (`.headerLeft`和`.headerRight`) 并调整我想要对齐的部分的对齐方式来做到这一点。但是，如果我想要一个`background-color`用于我的 header ，这会产生问题`div`。这里的最佳实践解决方案是简单地添加一点内联 CSS 样式，还是有更好的方法？

## 我的代码（[示例](http://jsfiddle.net/7jAPX/)）

### HTML

```
<div class="header">
 <span class="headerLeft">Welcome to .</span>
 <span class="headerRight"><a href="login.html">Login</a> | <a
 href ="register.html">Register</a></span>
</div> 
```

### CSS

```
.header {
 width:100%
 position:fixed;
 top:0;
 margin-top:0;
 background-color:red;
 text-color:#C14000;
}
.headerLeft {
 float:left;
 text-align:left;
}
.headerRight {
 float:right;
 text-align:right;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-01T17:59:51.227

```
#header {
    overflow: hidden;
} 
```

此代码将解决您的问题。`height`of将`#header`自动`height`从内部最高的元素中获取`#header`。

另一种方法是手动设置`height`for `#header`。

你不需要内联样式:)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-01T18:00:23.653

您需要为头类设置溢出属性以强制它环绕内部跨度。见[http://jsfiddle.net/PsychegoPro/rnDT8/](http://jsfiddle.net/PsychegoPro/rnDT8/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-01T18:51:43.677

您需要清除浮动以使 div 具有实际高度。

这可以通过使用 clearfix 来实现。[什么是清除修复？](https://stackoverflow.com/questions/8554043/what-actually-is-clearfix/8554054#8554054)

# jsf - 级联 p:selectOneMenu 模型值未设置

> ID：10855074
> 
> 赞同：1
> 
> 时间：2012-06-01T17:53:50.167
> 
> 标签：jsf, primefaces, selectonemenu, updatemodel, ajax-update

我有一个应用程序，其中有一个级联下拉列表、一个简单的下拉列表和一个提交命令按钮。我希望通过从下拉列表中选择各种标准来在数据表中显示报告。一切正常，除非我希望从子下拉列表中选择标准。它不与托管 bean 中的值绑定（通过调试发现）。这是我的代码：xhtml：

```
<h:outputText value="Exchange"/>
            <p:selectOneMenu style="width: 150px" value="#{reportBean.exchange}">
                <f:selectItem itemLabel="--select--" itemValue="--select--"/>
                <f:selectItem itemLabel="NSE" itemValue="nse"/>
                <f:selectItem itemLabel="BSE" itemValue="bse"/> 
                <p:ajax update="sym" listener="#{reportBean.wow}"/>
            </p:selectOneMenu>             
        <h:outputText value="Scrip Symbol :"/>
        <p:selectOneMenu value="#{reportBean.scripID}" id="sym" style="width: 100px">
            <f:selectItem itemLabel="All" itemValue="0"/>
            <f:selectItems var="scrip" value="#{reportBean.sl}" itemLabel="#{scrip.scripSymbol}" itemValue="#{scrip.scripID}"/>
        </p:selectOneMenu>

        <h:outputText value="Order Type :"/>
        <p:selectOneMenu style="width: 100px" value="#{reportBean.orderType}">
            <f:selectItem itemLabel="All" itemValue="All"/>
            <f:selectItem itemLabel="Buy" itemValue="B"/>
            <f:selectItem itemLabel="Sell" itemValue="S"/>
        </p:selectOneMenu>
            <p:commandButton ajax="true" update="dt" value="Submit" action="#{reportBean.getTradeByUserName()}" type="submit"/>
        </h:panelGrid>
        <p:dataTable id="dt" var="trade" widgetVar="scripTab" 
                     emptyMessage="No trade found with given criteria"  
                     value="#{reportBean.tradeList}"
                 paginator="true" paginatorTemplate="{CurrentPageReport} {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink}"
                 rowsPerPageTemplate="3,5,10" rows="3" >

        <p:column>.... 
```

托管bean代码：

```
 public void wow()
{    
        sl=getAllScripByExchange(exchange);
}

    public Integer getScripID() {
        return scripID;
    }

    public void setScripID(Integer scripID) {
        MasterScrip sm =getScripByID(scripID);
        if(sm!=null)
        this.scripSymbol=sm.getScripSymbol();
        this.scripID = scripID;
    }

    public List<TradeStock> getTradeList() {
        return tradeList;
    }

    public void setTradeList(List<TradeStock> tradeList) {
        this.tradeList = tradeList;
    }
     public List<service.TradeStock> getTradeByUserName()
    {
         HttpServletRequest request = (HttpServletRequest)FacesContext.getCurrentInstance().getExternalContext().getRequest();
        HttpSession session = request.getSession(true);
        String uname = session.getAttribute("uname").toString();   
        tradeList= getTradeReport(scripID, uname, exchange, orderType);
        return tradeList;
    } 
```

豆方法：

```
@Override
public Collection<TradeStock> getTradeReport(Integer scripID, String uname, String exchange, String tradeType) {

    String strQuery = null;
    strQuery = "Select t from TradeStock t where t.userName.userName = :userName ";
        if(! exchange.equalsIgnoreCase("All"))
    {
        strQuery += " and t.scripID.exchange = '" + exchange + "'";
    }         
    if(scripID>0)
    {
        strQuery += " and t.scripID.scripID = " + scripID;
    }
     if(! tradeType.equalsIgnoreCase("All"))
    {
        strQuery += " and t.orderID.buySell = '" + tradeType + "'";
    }

    Collection<TradeStock> c = em.createQuery(strQuery).setParameter("userName",uname).getResultList();

    return c;
} 
```

为什么值不绑定到 bean 道具？我该如何解决？（我担心的是昨天相同的代码工作但今天当我运行相同的代码时它开始困扰我）。

**编辑：面孔配置**

```
 <faces-config version="2.0"
    xmlns="http://java.sun.com/xml/ns/javaee" 
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
    xsi:schemaLocation="http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-facesconfig_2_0.xsd">
<managed-bean>
<managed-bean-name>userReportBean</managed-bean-name>    
<managed-bean-class>UserReportBean</managed-bean-class>
<managed-bean-scope>request</managed-bean-scope>
</managed-bean>
<navigation-rule>
<from-view-id>/adminpages/editScrip.xhtml</from-view-id>    
<navigation-case>
    <from-action>#{manageScrip.updateScrip}</from-action>
    <from-outcome>success</from-outcome>
    <to-view-id>/adminpages/manageScrip.xhtml</to-view-id>
    </navigation-case>
</navigation-rule>
<navigation-rule>
<from-view-id>/adminpages/addScrip.xhtml</from-view-id>    
<navigation-case>
    <from-action>#{manageScrip.addScrip}</from-action>
    <from-outcome>success</from-outcome>
    <to-view-id>/adminpages/manageScrip.xhtml</to-view-id>
    </navigation-case>
</navigation-rule>
<navigation-rule>
<from-view-id>/adminpages/manageScrip.xhtml</from-view-id>    
<navigation-case>
    <from-action>#{manageScrip.returnEdit}</from-action>
    <from-outcome>success</from-outcome>
    <to-view-id>/adminpages/editScrip.xhtml</to-view-id>
    </navigation-case>
</navigation-rule>
    <managed-bean>
        <managed-bean-name>equityBean</managed-bean-name>
        <managed-bean-class>beans.equityBean</managed-bean-class>
        <managed-bean-scope>request</managed-bean-scope>
    </managed-bean>
    <managed-bean>
        <managed-bean-name>reportBean</managed-bean-name>
        <managed-bean-class>beans.reportBean</managed-bean-class>
        <managed-bean-scope>request</managed-bean-scope>
    </managed-bean>
</faces-config> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-01T17:59:16.440

如果托管 bean 被放置在请求范围内，则可能会发生这种情况`@RequestScoped`。每个单独的 HTTP 请求，包括 Ajax 请求，都会创建一个全新的 bean 实例，所有属性都设置为默认值。这样`<f:selectItems>`列表变为空，因此在模型中没有设置值。

将 bean 放在视图范围内`@ViewScoped`应该可以解决这个问题。

### 也可以看看：

*   [如何选择合适的bean范围？](https://stackoverflow.com/questions/7031885/how-to-choose-the-right-bean-scope)

* * *

**更新**：您应该**从**`<managed-bean>`. `faces-config.xml`这是旧的 JSF 1.x 注册 bean 方式的遗留物。它们只会覆盖 JSF 2.x 的`@ManagedBean`配置方式。

与您的具体问题没有直接关系，但这些`<navigation-case>`条目在 JSF 2.x 中是多余的。也许您错误地阅读旧的 JSF 1.x 书籍/教程/资源而不是 JSF 2.x 的？

* * *

**与具体问题无关**，您的方法中存在严重的[SQL 注入攻击漏洞](http://en.wikipedia.org/wiki/SQL_injection)`getTradeReport()`。永远**不要**在 SQL/JPQL 字符串中对用户控制的变量进行字符串连接。改为使用参数化查询`setParameter()`。另请参阅[JSF 中的 CSRF、XSS 和 SQL 注入攻击预防](https://stackoverflow.com/questions/7722159/csrf-xss-and-sql-injection-attack-prevention-in-jsf)。

# ruby-on-rails - 导入一个 CSS 库

> ID：10855081
> 
> 赞同：1
> 
> 时间：2012-06-01T17:54:18.460
> 
> 标签：ruby-on-rails, ruby, twitter-bootstrap, haml

我有一个 haml 页面，它在没有我试图引用的 css 的情况下呈现。

我的 application.html.haml 中有这个

```
-controller_action = "#{controller_name}##{action_name}"
!!! 5
%html
  %head
    %a {:href => 'http://twitter-bootstrap/twitter-bootstrap-v2/docs/assets/css/bootstrap.css'}
  %body 
```

我只有一个页面：

```
.navbar .navbar-fixed-top Hello, World! 
```

这是从这里使用 Twitter 引导 css：http: [//twitter.github.com/bootstrap/](http://twitter.github.com/bootstrap/)

我期待 css 框架的一些元素出现在我的页面上，但它们没有出现。

我认为这可能是我如何尝试使用应用程序文件来引用 css 框架的问题。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-01T18:05:05.413

首先，您使用的 URL 是错误的，然后您导入 CSS 的方式也是错误的，最后您不应该从其他网站提供 CSS 文件，而应该从您的网站提供。

将此 CSS 复制到您的项目中，如果您使用的是 Rails 2.X ，则在**public/stylesheets中；如果您使用的是 Rails 3.X，则将其复制到****app/assets/stylesheets**中，然后使用正确的帮助器：

```
!!! 5
%html
  %head
    = stylesheet_link_tag 'bootstrap'
  %body 
```

然后您将让 CSS 正常工作。

# c++ - 包括与用户定义的类名的 Windows 标头冲突

> ID：10855086
> 
> 赞同：0
> 
> 时间：2012-06-01T17:54:47.330
> 
> 标签：c++, windows, qt, include

Qt 项目中的以下包含与我的用户定义类冲突：

```
#ifdef Q_OS_WIN
#include "qt_windows.h"
#include "qwindowdefs_win.h"
#include <shellapi.h>
#endif 
```

**代码片段：**

```
 if (Desktop::MessageBox::question(this, tr("I am ready?"),
                                     tr("I am not ready yet!?")) == QDialog::Rejected )
            {
                TRACE("Dialog rejected. I am not ready yet.");
                return;
            } 
```

**错误：** \Desktop\Gui\MainScreen.cpp:953：错误：'Desktop::MessageBoxA' 尚未声明

我的 Desktop::MessageBox 与 Windows 定义的 MessageBoxA 冲突。c++ 中这个问题的标准解决方案是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-01T17:57:14.670

1.  `#undef MessageBox`（和其他冲突的名称），或

2.  重命名您的班级，或

3.  将您对 Windows API 的使用封装到单独的 .cpp 文件中，这样您就不需要在任何地方都包含 Windows 标头，从而（很大程度上）避免了这个问题。

# visual-studio-2010 - 如何完全发布 Visual C# 项目？

> ID：10855087
> 
> 赞同：2
> 
> 时间：2012-06-01T17:54:47.470
> 
> 标签：visual-studio-2010, package, visual-c#-express-2010

我有一个相当基本的 Visual C# 项目（不超过 100 行），但它包含一些第 3 方 DLL 引用。在开发它的计算机上运行项目，它运行得很好。

在 Microsoft Visual C# 2010 Express 中，我访问`Project->Publish <project name>`并构建了一些文件，包括 setup.exe 安装程序。

当我将这些文件移动到另一台计算机并运行 setup.exe 时，它​​会正确安装程序。

但是当我运行程序时，它只是简单地关闭说：

> ProjectName.exe 遇到问题，需要关闭。对此造成的不便，我们表示歉意。

命令窗口也会出现短暂的一秒钟，并出现一些错误，但很难弄清楚它在说什么。它看起来像：

> 未处理的异常：System.Runtime.InteropServices.COMException：检索具有 CLSID { ....... } 的组件的 COM 类工厂失败，原因是以下错误：.....

我无法让命令窗口保持不变，因此我无法获得完整的消息。但我认为这是由于另一台计算机没有那些 3rd 方 DLLS。

如何让 Visual C# 2010 打包包括 DLL 在内的*所有内容*，以便不会出现此错误？或者，如果这可能不是实际问题，我怎样才能阻止命令窗口立即消失？（我不知道所需的 DLL 的完整列表）

或者如果 DLL 是 C:\Windows\system32 下的注册 DLL，项目是否永远不会将其构建到包中？有没有办法查看它取决于什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-01T18:17:32.543

Visual Studio 2010 Express 不会创建功能齐全的安装程序，而只会创建 ClickOnce 安装程序，以及功能有限的安装程序。这种安装程序无法注册 COM DLL。

在您的情况下似乎有问题的是您使用的是未在目标系统上注册的 COM DLL。您可以尝试在您自己的程序中进行检查（例如尝试创建类并捕获由 CreateObject 函数引发的任何异常），然后调用 RegSvr32.exe /s 以注册它。或者您只是在程序第一次启动时执行此操作，在您从 DLL 创建任何对象之前……虽然没有尝试过。

您还可以确保在运行程序之前在目标系统上手动注册 DLL。

此外，当 .Net 使用 COM DLL 时，它通常会创建一个兼容性程序集来包装 COM DLL 并使 .Net 可以访问它。如果您使用的 DLL 只是这个兼容性程序集，您可能必须在您的系统上手动找到它所依赖的 COM DLL，并将其显式包含在您的项目文件中。

为了调试，在 CreateObject 周围放置 try/catch 块就足够了。如果这没有帮助，请尝试为应用程序未处理异常时引发的事件添加事件处理程序（根据您创建的应用程序类型，这可能会有所不同）。

# java - 从 Java 运行 gnuplot 进程时遇到问题

> ID：10855088
> 
> 赞同：0
> 
> 时间：2012-06-01T17:54:52.737
> 
> 标签：java, process, gnuplot, filepath, processbuilder

我在从 Java 运行 gnuplot 进程时遇到了一些问题。我正在创建一个 gnuplot 脚本文件，然后从 java 程序中运行它。我已经尝试使用 Process Builder 并使用 Runtime.getRuntime().exec("blah blah...") 构建一个进程，但两者都没有完整的工作能力。有趣的是，只要我通过 gnuplot 创建的图像文件没有保存到名称中没有空格的目录中，使用 Runtime 就可以使该过程几乎完美地工作。然而，ProcessBuilder 根本不起作用，并给我错误：“CreateProcess error=2，系统找不到指定的文件”

我花了很长时间才弄清楚这些东西，所以任何帮助都将不胜感激。

我使用的代码在这里：

```
File script = new File("Demo.plt");    //Script file that outputs to a PNG file

//This works as long as the script file doesn't output to a png with a space in it's filepath
Process aProcess = Runtime.getRuntime().exec("gnuplot " + script.toString());
Thread.currentThread().sleep(1000);
aProcess.waitFor();

//This doesn't work at all
ProcessBuilder builder = new ProcessBuilder("gnuplot " + script.toString());
builder.redirectErrorStream(true);
Process process = builder.start(); 
```

而且我知道脚本如果在 Java 之外运行，无论输出行中的空格如何，都可以工作。我什至尝试过使用'\'（空格的转义字符），但这也不起作用。事实上，这是我使用的代码：

```
String graphName = "DemoGraph";
//Isolate the FilePath
String path = script.getPath();
path = path.replace(script.getName(),"");
path = path.replace(File.separator, "\\\\"); //Gets around any parsing errors in filepaths on Windows
path = path.replace(" ", "\\ ");   //Should get around parsing errors with spaces in gnuplot, but it seems to be irrelevant.

scriptFileWriter.write("set output \"" + path + graphName + ".png\"\r\n"); 
```

这一定是 java 的问题，因为脚本从 Windows 命令行和 gnuplot 命令行运行，并且 frun 通过双击运行

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T21:14:35.980

我忘了在文件名周围加上引号。这是一个愚蠢的错误。

# r - 在 R 中处理长数据格式

> ID：10855097
> 
> 赞同：2
> 
> 时间：2012-06-01T17:55:28.377
> 
> 标签：r, split

再会，

```
d <- c(1,1,1,2,2,2,3,3,3)
e <- c(5,6,7,5,6,7,5,6,7)
f <- c(0,0,1,0,1,0,0,0,1)
df <- data.frame(d,e,f) 
```

我有类似上面的数据。我需要做的是为d的每个唯一元素找到f中的第一个非零值，并在e中找到对应的值。具体来说，我想要另一个向量 g 所以它看起来像这样：

```
d <- c(1,1,1,2,2,2,3,3,3)
e <- c(5,6,7,5,6,7,5,6,7)
f <- c(0,0,1,0,1,0,0,0,1)
g <- c(7,7,7,6,6,6,7,7,7)
df <- data.frame(d,e,f,g) 
```

建议轻松做到这一点？我以为我可以使用 split()，但是在拆分后我无法使用 which()。我可以像这样使用 ave：

```
foo <- function(x){which(x>0)[1]}
df$t <- ave(df$f,df$d,FUN=foo) 
```

但是我很难找到 e 的值。任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-01T18:02:45.937

其他人可以提供基本的 R 解决方案，但这里有一种使用**plyr**的方法：

```
> ddply(df,.(d),transform,g = head(e[f != 0],1))
  d e f g
1 1 5 0 7
2 1 6 0 7
3 1 7 1 7
4 2 5 0 6
5 2 6 1 6
6 2 7 0 6
7 3 5 0 7
8 3 6 0 7
9 3 7 1 7 
```

请注意，即使您的示例数据在列（按组）中只有一个唯一的非零元素，我还是按字面意思记下了“第一个非零元素”。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-01T18:27:38.997

这是base R中的一种方法

`g <- inverse.rle(list(lengths=rle(d)$lengths, values=e[f != 0]))`

# css - 导航菜单对齐 CSS

> ID：10855098
> 
> 赞同：0
> 
> 时间：2012-06-01T17:55:35.863
> 
> 标签：css, alignment

我想让我的[网站](http://www.popglitch.com)上的导航菜单均匀地跨越宽度。[这](http://themeforest.net/item/halo-stunning-wordpress-portfolio-theme/full_screen_preview/256076)是我正在尝试完成的示例，请注意链接如何均匀分布并拉伸导航栏的整个宽度。

我不确定要使用什么代码来完成此操作。我尝试了 margin:auto 但这似乎不起作用。

**这是我拥有的CSS：**

```
.mainNav{ 
  height:30px; 
  padding-bottom:0px; 
  margin:0 !important;
  position: relative; 
  border-top: 1px #d5d5d5 solid;
  border-bottom: 1px #d5d5d5 solid;
}
.mainNav a { 
  font-size:16px; 
  -webkit-transition:none; 
  -moz-transition:none; 
  -o-transition:none; 
  transition:none;
  position: relative;              
}   
.mainNav ul { 
  list-style-type: none; 
  list-style-image: none; 
}
.mainNav li {
  float:left;                   
  margin: 0 auto;
  position: relative; 
  list-style-type: none; 
  list-style-image: none; 
}   
.mainNav li a { 
  text-transform:uppercase; 
  padding:0 0 0 36px; 
  display:block; 
  padding-bottom:13px;  
}
.mainNav li ul { 
  display: none; 
  margin:0 !important; 
}
.mainNav li:hover > ul, .mainNav li.hover > ul { 
  display: block; 
  position: absolute; 
  top: 35px; 
  left: 0; 
  z-index: 1000; 
  width: 180px; 
}
.mainNav li  > ul { 
  height:auto;  
  width: auto; 
  background: #fff; 
  border:1px solid #efefef; 
  padding:0; 
}
.mainNav li  > ul li {  
  width:180px; 
  padding: 0; 
  position: relative; 
  height:35px; 
  border-bottom:1px solid #efefef; 
}   
.mainNav li  > ul li:last-child{  
  border-bottom:none; 
}
.mainNav li  > ul li a { 
  text-transform:none; 
  height:22px; 
  padding: 5px 10px 0px 15px; 
  text-align: left;  
  font-size: 13px; 
  line-height:25px; 
  color:#333; 
}
.mainNav li  > ul li a:hover { 
  border:none; 
}
.mainNav li ul li:hover > ul, .mainNav li ul li.hover > ul { 
  display: block; 
  position: absolute; 
  top:0; 
  left: 180px; 
  z-index: 0; 
  width: 180px; 
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T18:12:54.870

如果您关闭 javascript 并重新加载要复制的 wordpress 主题，您会注意到样式中断。

这是因为在列表项上设置的边距是为了将它们均匀地隔开，是使用 javascript 计算然后应用的。

您可以编写一个 javascript 解决方案来设置列表项的样式，或者快速修复对列表项的宽度进行硬编码，**例如**：

**更改当前的 CSS 块：**

```
.mainNav li a { 
  text-transform:uppercase; 
  padding:0 0 0 36px; 
  display:block; 
  padding-bottom:13px;  
} 
```

**到以下：**

```
.mainNav li a { 
  text-transform:uppercase; 
  text-align: center; /*added*/
  width: 117px; /*added*/
  padding:0; /*edited*/
  display:block; 
  /*padding-bottom:13px;*/ /*removed*/
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-02T11:40:03.953

它在我看来是固定的。您在 firefox 中的网站截图，在 firebug 中应用了样式：

![在此处输入图像描述](../Images/28503870bece146e886a8376badf5fbf.png)

# python - 如何在 Python 中读取正在进行的进程的标准输出输出？

> ID：10855107
> 
> 赞同：1
> 
> 时间：2012-06-01T17:56:23.563
> 
> 标签：python, process, stdout, tcpdump

您好，我对 Python 编程语言真的很陌生，我在编写一个脚本时遇到了问题。我想保存当我在 Python 脚本的变量中运行 tcpdump 命令时获得的 stdout 输出，但我希望 tpcdump 命令连续运行，因为我想从所有传输的数据包中收集长度，这些数据包被 tcpdump 过滤（使用我写的过滤器）。我试过 ：

```
 fin, fout = os.popen4(comand)
    result = fout.read()
    return result 
```

但它只是挂起。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-01T18:00:41.490

我猜它挂起是因为`os.popen4`在子进程退出之前不会返回。你应该`subprocess.Popen`改用。

```
import subprocess
import shlex  #just so you don't need break "comand" into a list yourself ;)

p=subprocess.Popen(shlex.split(comand),stdout=subprocess.PIPE)
first_line_of_output=p.stdout.readline()
second_line_of_output=p.stdout.readline()
... 
```

# hibernate - XmlInverseReference、休眠、JAXWS 和 Moxy

> ID：10855110
> 
> 赞同：2
> 
> 时间：2012-06-01T17:56:49.210
> 
> 标签：hibernate, jax-ws, moxy

我似乎无法让 moxy 使用 JAX-WS Web 服务和休眠。尽管我做了什么，`@XMLInverseReference`但不起作用。我希望它能够`application`在 a 上填充变量`Site`。我在做什么或理解错误？

我收到：`org.hibernate.PropertyValueException: not-null property references a null or transient value: Site.application`。如果我添加`@XMLElement`到`Site.application`，那么我会从 JAXB 获得循环引用异常。

值得一提的是，所有编组和解组均由 JAX-WS WSServlet 端点处理。

我还通过执行以下操作验证了我的 jaxb.properties 是否正常工作：

```
public class Run {
    public static void main(String[] args) throws Exception {
        System.out.println(JAXBContext.newInstance(Site.class).getClass());
    }
} 
```

* * *

应用：

```
@Entity
@Table(schema = "dbo", name = "Applications")
@XmlAccessorType(XmlAccessType.NONE)
@XmlRootElement
public class Application {
    @Id
    @Column(name = "id", nullable = false, insertable = false, updatable = false)
    @GeneratedValue(strategy = GenerationType.IDENTITY)
    @RemoteProperty
    @XmlElement
    private Integer id;
    @Column(name = "code", nullable = false, unique = true)
    @NaturalId
    @XmlElement
    private String code;
    @Column(name = "name")
    @XmlElement
    private String name;
    @OneToMany(mappedBy = "application", fetch = FetchType.EAGER)
    @Cache(usage = org.hibernate.annotations.CacheConcurrencyStrategy.READ_WRITE)
    @Cascade(value = {CascadeType.MERGE, CascadeType.PERSIST, CascadeType.DELETE, CascadeType.DELETE_ORPHAN})
    @Sort(type = SortType.NATURAL)
    @XmlElement
    private Set<Site> sites = new TreeSet<Site>();
} 
```

地点：

```
@Entity
@Table(schema = "dbo", name = "Sites")
@XmlAccessorType(XmlAccessType.NONE)
@XmlRootElement
public class Site implements Identifiable<Integer>, Comparable<Site> {
    @Id
    @Column(name = "id", nullable = false, insertable = false, updatable = false)
    @GeneratedValue(strategy = GenerationType.IDENTITY)
    private Integer id;
    @Column(name = "address", unique = true)
    @NaturalId(mutable = true)
    @XmlID
    private String address;
    @Column(name = "ssl")
    @XmlAttribute(required = true)
    private boolean ssl;
    @ManyToOne
    @JoinColumn(name = "applicationCode", nullable = false, referencedColumnName = "code")
    @XmlInverseReference(mappedBy = "code")
    private Application application;
} 
```

jaxb.properties

```
javax.xml.bind.context.factory=org.eclipse.persistence.jaxb.JAXBContextFactory 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-01T21:50:08.793

JAX-WS 实现不一定尊重 JAXB.properties。如果您使用的是 WebLogic 12.1.1 或 GlassFish 3.1.2，以下将有所帮助：

*   [http://blog.bdoughan.com/2011/12/eclipselink-moxy-is-jaxb-provider-in.html](http://blog.bdoughan.com/2011/12/eclipselink-moxy-is-jaxb-provider-in.html)
*   [http://blog.bdoughan.com/2012/02/glassfish-312-is-full-of-moxy.html](http://blog.bdoughan.com/2012/02/glassfish-312-is-full-of-moxy.html)

# php - php : 日历脚本在 7 月无法正常工作

> ID：10855111
> 
> 赞同：0
> 
> 时间：2012-06-01T17:56:50.977
> 
> 标签：php, datetime, calendar

这是我所有月份都从第 1 天开始的问题，但 2012 年第 7 个月从第 2 天开始不知道为什么

这是代码

```
<table>
<?php
$cMonth = 7;
$cYear = 2012;

$first_day_timestamp = mktime(0,0,0,$cMonth,1,$cYear);
$maxday              = date("t",$first_day_timestamp);
$thismonth           = getdate($first_day_timestamp);
$startday            = $thismonth['wday'] - 1;

for ($i=0; $i<($maxday+$startday); $i++) {

    if (($i % 7) == 0 )  echo "<tr>";

    if ($i < $startday) { echo "<td>&nbsp;</td>" ; continue; }

    $current_day = $i - $startday + 1;

    echo "<td>". $current_day . "</td>";

    if (($i % 7) == 6 ) echo "</tr>";
}
?>
</table> 
```

附上图片

![日历](../Images/a21ab738b6f0f3c5a2b582269aa50f23.png)

请告诉我为什么会这样

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-01T18:15:44.803

更改`$startday = $thismonth['wday'] - 1;`为`$startday = $thismonth['wday'];`显示正确的日历，星期天是一周的第一天。

您的代码的问题是 $startday 为 -1（$thismonth['wday'] 为 0，因为该月从星期日开始）。在循环的第一次迭代中，`$current_day = 0 - (-1) + 1 = 2`它从 2 开始，这是正确的，因为星期一是每月的 2 号。

从星期日开始的任何一个月都会出现此问题。试试 2013 年 9 月。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-01T18:15:54.497

你为什么做这个：

```
$startday            = $thismonth['wday'] - 1; 
```

??

您正在将日期偏移量向后移动。这实际上是在说您要开始指望的那一天是该月第一天的前一天。

--EDIT-- 所以你这样做是因为你希望日历从星期一而不是星期日开始。php 的 wday 是[这样](http://php.net/manual/en/function.getdate.php)的：

> 0（星期日）到 6（星期六）

您从中减去一个将使该月的开始向下移动一天，直到并且除非该月从星期日开始。然后 $startday 是-1，它会影响你的计数。您需要将其转至前一周。如果您添加另一行来修复这种情况，例如：

```
$startday = thismonth['wday'] - 1;
if($startday < 0 ) $startday = 6; 
```

它应该可以解决问题。我敢肯定还有其他方法可以弥补星期一是一周的第一天。

# linux - 如何获取linux中线程的调度统计信息？

> ID：10855112
> 
> 赞同：0
> 
> 时间：2012-06-01T17:56:57.157
> 
> 标签：linux, multithreading

在 Linux 中，我们可以使用“cat /proc/processs-id/sched”来获取调度信息，nr_switches，nr_vulnerable_switches，nr_invulnerable_switches 告诉我们进程被调度了多少次。有没有类似的方法可以获取线程的调度时间？提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T18:35:53.560

很难知道“安排时间”是什么意思。如果您的意思是内核/用户运行滴答声，那么`/prox/xxx/stat`看起来它具有有关运行时的一些详细信息。

在linux下，进程的线程可以在`/proc/xxx/task/yyy`. 每个目录对应一个与父进程关联的线程进程。

> **utime %lu** 此进程在用户模式下调度的时间量，以时钟滴答数衡量（除以 sysconf(_SC_CLK_TCK)。这包括来宾时间、来宾时间（运行虚拟 CPU 所花费的时间，见下文），以便应用程序执行不知道客人时间字段不要从他们的计算中丢失那个时间。
> 
> **stime %lu**此进程在内核模式下调度的时间量，以时钟滴答为单位（除以 sysconf(_SC_CLK_TCK)。

我会检查 proc 手册页以获取可用文件的列表。

> 人进程

# java - maven添加对共享包的依赖

> ID：10855118
> 
> 赞同：0
> 
> 时间：2012-06-01T17:57:20.600
> 
> 标签：java, maven, shared-libraries

我正在使用 Eclipse 和 Maven。

我当前的设置是 - 客户端（使用它自己的 maven pom.xml 分离 Eclipse 和 git 项目） - 服务器（使用它自己的 maven pom.xml 分离 Eclipse 和 git 项目）

客户端和服务器都是 Eclipse 和 git 中的不同项目。

但是，客户端和服务器之间共享一些常见的 Java 包。为了避免 common 包的重复，我想创建第三部分，所以我的新设置看起来像 - client - server - common

在 Eclipse 中，我可以将公共项目作为依赖项添加到我的客户端和服务器，它会起作用。与 git 相同。

但是，我不确定如何在客户端和服务器 pom.xml 中定义这种依赖关系。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-01T18:03:55.617

您可以从公共部分构建一个库，然后将其托管在您自己的 Maven 存储库中，然后您可以将其作为依赖项添加到您的服务器和客户端 pom.xml。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-01T18:04:42.150

您可以在 pom.xml 中添加项目作为依赖项

```
<dependencies>
    <dependency>
      <groupId> group-id-of-common-project</groupId>
      <artifactId> artifact-id-of-common-project</artifactId>
      <version>${mavenVersion}</version>
    </dependency>
</dependencies> 
```

# cuda - 可以使用 cudaMemcpy3D 在单个 cudaArray 中移动部分数据吗？

> ID：10855119
> 
> 赞同：0
> 
> 时间：2012-06-01T17:57:22.550
> 
> 标签：cuda, gpu

我想在 CUDA 中为体积纹理实现移位操作。我想到了一个实现，它对 memcpy 操作进行多次迭代，将 cudaArray 内的数据从一个位置移动到另一个位置。
我做错了什么，因为我总是得到无效的参数错误？这是我正在做的事情的草图：

```
/* My volume texture */
cudaArray* g_pVolumeTexture // its size is 256^3 voxels of type uchar2

...

cudaMemcpy3DParms prms;
prms.srcArray = g_pVolumeTexture;
prms.dstArray = g_pVolumeTexture; // src = dst, because I wanna rather shift than
                                  // copy

prms.extent = make_cudaExtent(24, 256, 256);
prms.srcPos = make_cudaPos(0, 0, 0);
prms.dstPos = make_cudaPos(48, 0, 0); // this will mean a move of 48 voxels in
                                      // x-direction; the piece of data moved
                                      // measures 24 voxels in x-direction

cudaMemcpy3D(&prms);

// Here cudaGetLastError always returns 'invalid argument error' 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-05T09:12:14.577

答案是肯定的：可以使用具有与 dstArray 相同的 srcArray 的 Memcpy3D 命令。我遇到的问题是由于不存在 cudaMemcpy3DParms 的初始重置而出现的：

```
cudaMemcpy3DParms p = {0}; 
```

# c# - WinForms ListBox 和 Ctrl+C 按键的行为非常奇怪

> ID：10855120
> 
> 赞同：1
> 
> 时间：2012-06-01T17:57:25.707
> 
> 标签：c#, winforms, listbox

我`ListBox`在两个应用程序的 WinForms 中遇到了一些非常奇怪的行为。它们都有一些其他控件（`TableLayoutPanel`s、`Button`s 等）

两个应用程序都处理 Ctrl+C 击键以将所选项目复制`ListBox`到剪贴板。但是，当我按下 Ctrl+C 时，当前的选定索引`ListBox`会向下移动一个，或者如果选择了最后一项，则选择会环绕到第一项。这发生*在*我的`KeyDown`处理程序完成工作之后。

这很奇怪，因为这两个应用程序中都没有会导致这种行为的代码。我什至不知道要按什么键来使选择前进或像那样换行。

我一直试图在示例程序中重现这种行为，但到目前为止，我还无法弄清楚这两个应用程序的共同点是什么使它们以这种方式运行。如果我弄清楚了，我会相应地更新这个问题。

我比较了有此问题的应用程序和没有此问题的应用程序之间的 Windows 消息活动。我发现了一条导致它的特定消息：

```
msg=0x2111 (WM_REFLECT + WM_COMMAND)
hwnd=0x211e2
wparam=0x111e2
lparam=0x211e2
result=0x0 
```

以下是在每个程序中按 Ctrl+C 的完整消息日志：

*   出现此问题的消息日志：[https ://gist.github.com/2854221](https://gist.github.com/2854221)
*   没有这个问题的消息日志：[https ://gist.github.com/2854203](https://gist.github.com/2854203)

我可以阻止处理这条神秘消息，但它是什么，是什么导致它被发送？我难住了。

* * *

## 回答 #1

> 赞同：-2
> 
> 时间：2013-03-20T17:53:15.483

列表框管理按键，所以当新选择的项目以“c”开头时

# linux - 获取 ELF 文件信息

> ID：10855126
> 
> 赞同：0
> 
> 时间：2012-06-01T17:57:53.347
> 
> 标签：linux, unix, elf

好的...所以我想编写一个程序，仅使用 mmap 打印 elf 文件中的所有部分名称（那不重要...）

所以到目前为止我所做的是 - 将文件映射到 stat 结构 = map_start = mmap(0, fd_stat.st_size, PROT_READ | PROT_WRITE , MAP_SHARED, fd, 0)) <0)

从我得到的起点将其转换为写入格式 = header = (Elf32_Ehdr *) map_start;

从文件中获取节头偏移量 = secoff = header->e_shoff;

现在 - 我知道我需要去 map_start+secoff 位置 - 这会给我部分表，而 sh_name 会给我一个字符串表的索引......

我怎么去毒刺桌？它是如何表示的？我该如何使用它？并且是 sh_name 中的值，字符串表中的索引（如果它表示为数组），或偏移量..

无论如何-假设我想打印前两个部分的名称-鉴于我在上面编写的代码帮助，我该怎么做？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-01T18:10:47.093

```
header = (Elf32_Ehdr *) map_start;
secoff = header->e_shoff; 
```

这可能是错误的。除非显式声明 Elf32_Ehdr 结构`__attribute__((packed))`，否则编译器最终会在结构的成员之间插入填充，因此`sizeof(Elf32_Ehdr) != (the actual size of an ELF header section)`. 为什么不简单地使用 libelf 访问器函数呢？

**更新：**如果不允许使用访问器函数，则必须执行以下操作：

```
Elf32_Ehdr hdr;
memcpy(&hdr.e_ident, map_start + 0, EI_NIDENT);
memcpy(&hdr.e.type, map_start + 0 + sizeof(Elf32_half), sizeof(Elf32_Half)); 
```

等等。

# asp.net - 在 asp.net 网页中使用 Url Link 嵌入外部视频

> ID：10855127
> 
> 赞同：0
> 
> 时间：2012-06-01T17:57:53.800
> 
> 标签：asp.net

我的 sql server 中有视频的外部 url 链接。如何使用我的 url 链接在 asp.net 页面中嵌入该视频？任何建议都会有所帮助。在此先感谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-01T20:57:08.623

看看[这篇文章](http://www.asp.net/web-pages/tutorials/files,-images,-and-media/10-working-with-video)。基本上，如果这些是 youtube 视频，您可以使用以下代码：

```
 <iframe width="560" 
            height="315" 
            src="http://www.youtube.com/embed/fxCEcPxUbYA" 
            frameborder="0" 
            allowfullscreen></iframe> 
```

在其他情况下，您可以[安装特定的 Helper](http://www.asp.net/web-pages/overview/getting-started/installing-helpers)来帮助您。

# c# - 当前（.NET 4）向 Web 服务发送 XML 请求的方式？

> ID：10855128
> 
> 赞同：1
> 
> 时间：2012-06-01T17:58:00.457
> 
> 标签：c#, web-services, .net-4.0

将原始 XML 请求发送到 Web 服务的最新 (.NET 4) 方法是什么？asmx 和 wcf 服务有区别吗？

我想通过前端接口构建 XML 并能够将其发送到不同的端点。这些端点可以是 asmx 或 wcf。开始执行此操作的最佳方法是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-01T18:22:42.037

我认为我们的意思是一样的；我通常不仅喜欢发送 XML，而且更喜欢使用对象并让 WCF 引擎决定以什么格式将其传递给服务/客户端（这可能取决于您和您的服务提供商支持的协议）。在 WCF 的术语中，这意味着将类定义为[Data Contracts](http://msdn.microsoft.com/en-us/library/ms733127.aspx)，并且只使用它们的实例，而不是它们可能表示的 XML。
如果对方仅支持 ASMX，它会将 WCF 可以用来对抗的支持协议限制为 WS-I Basic Profile 1.1（如果我没记错的话），但无论您选择/对抗的技术是什么，在我看来，这个概念，应该保持不变：在 .NET 中使用类，并让底层通信技术决定如何序列化并将其传递给另一方。当然，它也比仅将原始字符串作为 xml 发送更安全（尽管您可以通过验证接收到的 xml 的模式来解决一些安全问题）

# php - 是否可以生成与正则表达式字符串匹配的字符串？

> ID：10855134
> 
> 赞同：6
> 
> 时间：2012-06-01T17:58:43.053
> 
> 标签：php, javascript, jquery, regex

是否可以显示匹配正则表达式的字符串？

例子：

取表情`/^AD\d{3}/` 并展示`AD999`

我正在做的是验证一个非常简单的字符串，它要么包含所有数字，要么包含几个字符，还可能包含一个“-”。我正在针对使用邮政编码的所有国家/地区的数据库验证表单提交上的邮政编码。

我可以用 Javascript 或 PHP 执行它，如果这有什么不同的话。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-01T18:01:20.293

不，这种功能不可用。

您可以尝试自己实现它，但我认为这不是您的解决方案。只需正常编写消息即可。并非一切都必须始终是动态的。

不过我喜欢你的思维方式。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-01T18:17:39.950

**这是可能的**。PEX的[开发人员想通了](http://blog.dotnetwiki.org/CommentView,guid,ebbeae3f-9e53-4f67-9d30-6d8a1d2c4903.aspx)。

**不要抱太大希望**，我不知道任何 javascript 实现。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2014-04-22T08:34:40.660

现在有一个用于 javascript 的：http: [//fent.github.io/randexp.js/](http://fent.github.io/randexp.js/)。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-06-01T18:16:29.593

从您的附加评论中，我对您的问题有了更好的理解。

由于您的数据只是邮政编码，我建议可以在另一个方向工作并将*图片*存储在数据库中并从中自动生成正则表达式。

例如，英国邮政编码看起来`AA?99? 9AA | AA?9A 9AA`很容易转换为正则表达式（使用正则表达式！）。

# android - android中的活动堆栈

> ID：10855137
> 
> 赞同：0
> 
> 时间：2012-06-01T17:59:04.560
> 
> 标签：android, android-fragments, android-activity, back-stack

我对了解 android 还很陌生，并且听说过活动堆栈。

根据我的阅读和理解，它会在您进行每个活动时创建堆栈并将其作为堆栈项留下。

我的问题是：

*   删除活动堆栈会导致android节省更多内存吗？例如。例如具有大量图像的活动。

*   知道您希望它们从头开始就删除活动堆栈会更好吗？

如果我的第二句话有任何需要纠正的地方，请同时提及。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-01T18:02:07.217

> 知道您希望它们从头开始就删除活动堆栈会更好吗？

~~活动堆栈~~ **返回堆栈**很重要，因为它允许在屏幕之间进行反向导航。没有它，就不会有“后退按钮”导航，也就不存在“任务”的概念。Android 已经过优化，可以为您管理内存（请参阅`Activity`生命周期文档）。放在后栈上的活动仍然由系统管理；只要你不做傻事，就不应该有任何问题。:)

> 知道您希望它们从头开始就删除活动堆栈会更好吗？

我不确定我是否正确理解了这个问题，但答案很可能是“否”。如果您想从头开始（即清除后台堆栈），那么您可以[`FLAG_ACTIVITY_CLEAR_TOP`](http://developer.android.com/reference/android/content/Intent.html#FLAG_ACTIVITY_CLEAR_TOP)在启动新活动时使用该标志。

# iphone - 在多个类之间共享 UILabel 中的相同文本

> ID：10855144
> 
> 赞同：0
> 
> 时间：2012-06-01T17:59:24.130
> 
> 标签：iphone, objective-c, ios, xcode, uilabel

我在一个班级有一个 NSString，在另一个班级有一个 UILabel，在我的第三个班级有第三个 UILabel。他们都在 IB 中的 3 个不同的视图上。我希望我的第一堂课将一些字符串保存到 NSString 并且我希望我的第二堂课 UILabel 等于这个 NSString 并且我的第三堂课的 UILabel 等于我的第二堂课的 UILabel。我怎么做？

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T18:04:30.183

这是一个常见问题，具有解决方案的常见模式。

创建一个[模型类](http://en.wikipedia.org/wiki/Model%E2%80%93view%E2%80%93controller)来保存您的字符串。在您的应用程序委托（可能在 ）中实例化此类的一个对象`applicationDidFinishLaunching:`，并将其传递给您的所有三个视图控制器。通过您的子视图控制器在您的模型类上使用[键值观察](http://developer.apple.com/library/mac/#documentation/Cocoa/Conceptual/KeyValueObserving/KeyValueObserving.html)，因此它们会收到模型中的任何更改（即字符串更改）的警报。

# android - 如何创建像gmail android这样的底部菜单

> ID：10855148
> 
> 赞同：3
> 
> 时间：2012-06-01T17:59:32.720
> 
> 标签：android

我不太确定 Gmail 在 Android 中使用的是哪种布局。我想他们使用浮动`ViewGroup`.

但是对于顶部和底部的菜单，我真的需要有人告诉我如何制作它。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-01T18:16:06.243

我建议你使用 Sherlock ActionBar：

[http://actionbarsherlock.com/](http://actionbarsherlock.com/)

这使您可以轻松地为 2.x 及更高版本的每个版本的 Android 开发带有操作栏的应用程序。

在示例应用程序中，您可以在“拆分操作项”下找到实现所需内容的代码。这个想法是您像往常一样从菜单中添加操作，但在您的清单活动中写入以下行：

```
android:uiOptions="splitActionBarWhenNarrow" 
```

![带有拆分操作栏代码的演示应用程序](../Images/d6c1ec2787a09165b99bed90ad77f8c0.png)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-01T18:08:24.273

`<RelativeLayout>`您可以使用这样的标签 创建一个位于列表视图底部的菜单

```
<RelativeLayout
xmlns:android="http://schemas.android.com/apk/res/android"
android:orientation="vertical" android:layout_width="match_parent"
android:layout_height="wrap_content" >
    <ListView
      android:layout_height="wrap_content"
      android:layout_width="fill_parent" android:id="@android:id/list"
      android:listSelector="@android:color/transparent"
      android:layout_above="@+id/footer" />

    <include android:id="@+id/footer" android:layout_height="wrap_content"
      layout="@layout/mymenu" android:layout_width="fill_parent"
      android:layout_centerHorizontal="true"
      android:layout_alignParentBottom="true" >
    </include>
</RelativeLayout> 
```

mymenu 将包含一个线性布局，其中包含几行的表格布局（可以是文本视图、图像视图等）。表格将位于屏幕底部，列表视图将位于从顶部开始的框架中屏幕并在菜单顶部结束（无重叠）

您也可以通过简单地让列表视图说`layout_below="@+id/header"`而不是`layout_above"@+id/footer"`（或两者都做！）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-08-05T10:03:20.503

这在 android 上有介绍。您必须实现“拆分操作栏”。请注意，它在纵向视图中有效，并在您切换到横向时消失。 [安卓操作栏](http://developer.android.com/guide/topics/ui/actionbar.html)

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-06-01T18:02:30.527

它看起来像一个自定义的[ActionBar](http://developer.android.com/design/patterns/actionbar.html)实现。如果你把图标放在一个正常的`ActionBar`地方并且没有足够的空间来显示它们，android会自己创建一个底部栏并在那里显示图标。

我有一个类似的应用程序，我选择将我自己的自定义栏放在那里而不是实现[ActionBar](http://developer.android.com/design/patterns/actionbar.html)

# c# - 调用 c++ 代码时出现访问冲突错误是 c#

> ID：10855149
> 
> 赞同：0
> 
> 时间：2012-06-01T17:59:34.263
> 
> 标签：c#, c++, visual-c++, c#-4.0

在 C++ 中，我有以下这些类

```
class A
{
  public: 
      int __thiscall check(char *x,char *y,char *z);
  private:
      B *temp;
};

class B
{
  friend class A;
  Public:
    B();
    B(string x,string y,string z);
    ~B();
  private:
    string x;
    string y;
    string z;
}; 
```

我在 C++ 中的 dll 方法是这样的

```
__declspec(dllexport) int __thiscall A::check(char *x,char *y,char *z)
{
  temp=new B(x,y,z);
  return 1;
} 
```

B() 构造函数的代码如下：

```
B::B(string x, string y,string z)
{
  .......
} 
```

下面提到的是我的 c# dll 导入

```
[DllImport("sour.dll", CallingConvention = CallingConvention.ThisCall, ExactSpelling = true, EntryPoint = "check")]
    public static extern void check(IntPtr val,string x,string y,string z); 
```

c++ 构建成功，没有任何错误，但是当我使用 dll 导入方法从 c# 调用此方法时，当我尝试为“temp”类指针分配内存时，出现以下错误。下面提到的是错误。

```
 Attempted to read or write protected memory. This is often an indication that other memory is corrupt. 
```

任何人都可以帮助解决这个问题。提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-01T18:22:12.540

我会假设导出方法而不是类成员更容易。请确保 DllImport 使用正确的调用约定。

```
__declspec(dllexport) void __cdecl check(int x) 
```

[使用 PInvoke 互操作助手会导致](http://clrinterop.codeplex.com/releases/view/14120)

```
public partial class NativeMethods {

    /// Return Type: void
    ///x: int
    [System.Runtime.InteropServices.DllImportAttribute("<Unknown>", EntryPoint="check", CallingConvention=System.Runtime.InteropServices.CallingConvention.Cdecl)]
public static extern  void check(int x) ;

} 
```

* * *

您是否确保您的 dll 的 32/64 位版本匹配。如果您运行 x86 .net 版本（32 位），您可以激活本机和托管代码的调试，并且您应该能够在 C++ 方法中设置断点以查看会发生什么。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-02T05:58:30.150

通过 PInvoke 直接使用 C++ 将不起作用。必须首先通过堆上的 new 实例化 C++ 类，而您无法从托管代码中执行此操作。

您要调用的成员函数需要在 DllImport 语句中使用[thiscall 调用](http://msdn.microsoft.com/en-us/library/system.runtime.interopservices.callingconvention.aspx)约定，因为它是一个非静态成员方法。这需要隐式地将指针传递给堆栈上的非托管类实例，而您在此处无法真正做到这一点。

您应该考虑使用托管[C++ 包装器类](http://www.codeproject.com/Articles/14180/Using-Unmanaged-C-Libraries-DLLs-in-NET-Applicatio)（请参阅链接）来直接访问它，或者您制作一个 C 包装器，您可以在其中调用 ctor、dtor 和实例成员作为直接 C 方法，在必要时接受并返回 this 指针。

一个非常 hacky 的解决方案可能是直接通过 Marshal.GlobalAlloc 分配内存并通过 PInvoke 调用此存储位置上的 ctor，但由于您现在不提前需要多少内存，这是一个肮脏的 hack。

# xcode - Xcode/Phonegap 没有编译我的应用程序的正确版本

> ID：10855150
> 
> 赞同：1
> 
> 时间：2012-06-01T17:59:49.803
> 
> 标签：xcode, mobile, cordova

当我使用 Xcode 和 Phonegap 编译我的移动应用程序时，iPod/iPhone/iPad 上的应用程序是我昨天编译的前版本。

基本上，当我在模拟器中运行应用程序时，一切正常，所以我知道这是正确的文件和所有内容，但是当我为移动设备构建它时，它显示了我昨天做的那个。

这可能是什么原因造成的？有什么我应该检查的设置吗？就像我说的，我怀疑它与文件/文件夹有关，因为在模拟它时，它工作正常。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-01T18:22:46.367

您是否增加了构建的版本号？如果你用相同的编号重新编译，你可能会遇到麻烦。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-01T18:19:21.483

很久以前我也遇到过类似的问题。尝试在设备上删除您的应用程序，然后重新构建它。我不知道苹果如何管理应用程序，但我认为您的应用程序的主要部分保留在您的设备上（以加快编译速度）。我希望它会奏效！

# sitecore - 如何使用下拉菜单创建 Sitecore 功能区按钮？

> ID：10855152
> 
> 赞同：5
> 
> 时间：2012-06-01T17:59:52.547
> 
> 标签：sitecore, page-editor

Sitecore 页面编辑器和预览界面具有一个语言选择器按钮，该按钮触发一个“下拉”/覆盖菜单，用户可以在其中选择一种语言。我如何复制这种行为？

（我开始回答这个问题，并想出了一个解决方案。发布到 SOF 以征求意见/增强。）

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-06-01T17:59:52.767

您可以看到 Sitecore 在`Sitecore.Client`程序集中是如何做到的，`Sitecore.Shell.Applications.WebEdit.Commands.ChangeLanguage`并且`Sitecore.Shell.Applications.WebEdit.Commands.SetLanguage`.

为此，您需要创建自己的两个命令。一个命令与按钮相关联，一个在选择子项时执行。该示例基于更改国家/地区 cookie 的场景。

**更改国家命令**

首先，显示菜单的命令。您可以看到它显示了一个`Menu`带有动态选项的选项。覆盖`GetHeader`并`GetIcon`允许按钮本身根据用户的当前选择是动态的。

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using Sitecore.Shell.Applications.WebEdit.Commands;
using Sitecore.Diagnostics;
using Sitecore.Data.Items;
using Sitecore.Web.UI.Sheer;
using Sitecore.Web.UI.HtmlControls;
using Sitecore.StringExtensions;
using System.Web;

namespace Prototype.Commands
{
    public class ChangeCountry : WebEditCommand
    {
        protected Dictionary<string, CountryOption> _countries = new Dictionary<string, CountryOption>
        {
            {"US", new CountryOption {
                ID = "US",
                Name = "United States",
                Icon = "Flags/32x32/flag_usa.png"
            }},
            {"CA", new CountryOption {
                ID = "CA",
                Name = "Canada",
                Icon = "Flags/32x32/flag_canada.png"
            }},
            {"MX", new CountryOption {
                ID = "MX",
                Name = "Mexico",
                Icon = "Flags/32x32/flag_mexico.png"
            }},
            {"DE", new CountryOption {
                ID = "DE",
                Name = "Germany",
                Icon = "Flags/32x32/flag_germany.png"
            }}
        };

        public override void Execute(Sitecore.Shell.Framework.Commands.CommandContext context)
        {
            Assert.ArgumentNotNull(context, "context");
            if (context.Items.Length == 1)
            {
                Item item = context.Items[0];
                SheerResponse.DisableOutput();
                Menu control = new Menu();
                //replace with lookup and loop of available values
                foreach (var key in _countries.Keys)
                {
                    var country = _countries[key];
                    string id = country.ID;
                    string header = country.Name;
                    string icon = country.Icon;
                    string click = "prototype:setcountry(country={0})".FormatWith(key);
                    control.Add(id, header, icon, string.Empty, click, false, string.Empty, MenuItemType.Normal);
                }
                SheerResponse.EnableOutput();
                SheerResponse.ShowPopup("ChangeCountryButton", "below", control);
            }
        }

        public override string GetHeader(Sitecore.Shell.Framework.Commands.CommandContext context, string header)
        {
            HttpCookie country = HttpContext.Current.Request.Cookies["country"];
            if (country != null && _countries.ContainsKey(country.Value))
            {
                return _countries[country.Value].Name;
            }
            return base.GetHeader(context, header);
        }

        public override string GetIcon(Sitecore.Shell.Framework.Commands.CommandContext context, string icon)
        {
            HttpCookie country = HttpContext.Current.Request.Cookies["country"];
            if (country != null && _countries.ContainsKey(country.Value))
            {
                return _countries[country.Value].Icon;
            }
            return base.GetIcon(context, icon);
        }

        protected class CountryOption
        {
            public string ID { get; set; }
            public string Name { get; set; }
            public string Icon { get; set; }
        }
    }
} 
```

在 Commands.config 或包含文件中，注册新命令。

```
<command name="prototype:changecountry" type="Prototype.Commands.ChangeCountry,Prototype" /> 
```

**更改国家按钮**

在下创建一个新的块和按钮`/sitecore/content/Applications/WebEdit/Ribbons/WebEdit/Experience`。此功能区条也在预览模式下被引用/复制。该按钮将使用以下属性：

![功能区按钮](../Images/df9c619e6209e76c253a79663cb5e2e3.png)

Click 字段必须与您的命令名称匹配，ID 字段必须与上述`SheerResponse.ShowPopup`调用中提供的元素 ID 匹配。

**设置国家命令**

接下来是选择菜单/下拉菜单中的项目时将调用的命令。

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using Sitecore.Shell.Applications.WebEdit.Commands;
using System.Net;
using Sitecore.Diagnostics;
using Sitecore.Web.UI.Sheer;
using System.Web;

namespace Prototype.Commands
{
    public class SetCountry : WebEditCommand
    {
        public override void Execute(Sitecore.Shell.Framework.Commands.CommandContext context)
        {
            Assert.ArgumentNotNull(context, "context");
            var country = context.Parameters["country"];
            Assert.IsNotNullOrEmpty(country, "Country not found");
            HttpCookie cookie = new HttpCookie("country", country);
            HttpContext.Current.Response.Cookies.Add(cookie);
            WebEditCommand.Reload(WebEditCommand.GetUrl());
        }
    }
} 
```

在我们的示例中，我们根据所选值设置 cookie 并重新加载页面。传入的值基于与 中的菜单项关联的单击事件`ChangeCountry`。同样，配置时的命令名称需要与`ChangeCountry`单击事件中使用的名称相匹配。

```
<command name="prototype:setcountry" type="Prototype.Commands.SetCountry,Prototype" /> 
```

# c# - “membername”成员不是来自 xml-rpc 服务调用的 base64 类型错误

> ID：10855156
> 
> 赞同：-2
> 
> 时间：2012-06-01T18:00:00.510
> 
> 标签：c#, xml-rpc

我正在使用 Charles Cook 的 xml-rpc.net 来尝试进行 xml-rpc 服务调用。

请求需要以这种格式发送：

```
<?xml version="1.0" encoding="iso-8859-1"?>
<methodCall>
<methodName>leads</methodName>
<params>
<param>
<value>
<struct>
<member>
 <name>key</name>
 <value>
  <string>XXXXXXXXXXX</string>
 </value>
</member>
<member>
 <name>leads</name>
 <value>
  <base64>PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPGxlYWRzPgogICA8bGVhZD4K
          ICAgICAgPGlkPjM5OTk3PC9pZD4KICAgICAgPEZpcnN0TmFtZT5Cb2IgSmltPC9GaXJzdE5hbWU+
          CiAgICAgIDxMYXN0TmFtZT5TbWl0aDwvTGFzdE5hbWU+CiAgICAgIDxBZGRyZXNzPjEyMzQgV2Vz
          :
          :
          ICAgICA8UmVjZWl2ZUFkZGxJbmZvPlllczwvUmVjZWl2ZUFkZGxJbmZvPgogICAgICA8bG9wX3dj
          X3N0YXR1cz5ObzwvbG9wX3djX3N0YXR1cz4KICAgPC9sZWFkPgo8L2xlYWRzPg==
  </base64>
 </value>
</member>
</struct>
</value>
</param>
</params>
</methodCall> 
```

其中成员名称包含此格式的多个标签：

```
 <?xml version="1.0" encoding="UTF-8"?>
 <leads xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
   xmlns="http://www.siteName.com/Leads"
   xsi:schemaLocation="http://www.siteName.com/Leads Leads.xsd"
   version="1.0">
  <lead>
  <id>39997</id>
  <first_name>Jim</first_name>
  <last_name>Smith</last_name>
  <address>1234 West 5th Street</address>
  <address2/>
  <city>Beverly Hills</city>
  <state_or_province>CA</state_or_province>
  <country>USA</country>
  <postal_code>90210</postal_code>
  <best_number>555-121-3322</best_number>
  <best_number_ext/>
  <alt_number/>
  <alt_number_ext/>
  <time_zone>Pacific</time_zone>
  <best_time>mid day</best_time>
  <request_uri>http://siteName.com/contact/
               ?source=VendorName&amp;leadid=VendorId&amp;ad=SomeAd</request_uri>
  <handoff_id>X-vendorid</handoff_id>
  </lead>
  <lead>
  <id>39987</id>
  <first_name>George</first_name>
   :
   :
  <lop_wc_status>No</lop_wc_status>
  <request_uri>http://siteName.com/contact/
               ?source=VendorName&amp;leadid=VendorId&amp;ad=SomeAd</request_uri>
 </lead>
</leads> 
```

关于 webservice 方法的文档需要一个包含两个值（值数组）的参数 - 键和线索。包含潜在客户数据的 xml 文档必须打包为二进制对象。此值必须命名为潜在客户，并且必须是 base64 类型。

这是我到目前为止失败的结果：

我的结构包含潜在客户信息-

```
 [Serializable]
     public struct myLeads
     {
      public string id;
      public string first_name;
      public string last_name;
     } 
```

界面

```
 public interface ILead
    {
    [CookComputing.XmlRpc.XmlRpcMethod("leads", StructParams = true)]
    string NewLead(string key, myLeads leads);
    } 
```

最后，我初始化结构值并调用方法：

```
 myLeads newLead = default(newLeads);
    Guid guid = System.Guid.NewGuid();
    newLead.id = guid.ToString();
    newLead.first_name = "Test";
    newLead.last_name = "LastNameTest";
    newLead.address = "111 Test St";

    var leadPost = (ILead)XmlRpcProxyGen.Create(typeof(ILead));
    var clientProtocol = (XmlRpcClientProtocol)leadPost;
    clientProtocol.Url =  "https://dashboard.sitename.com/webservices/rpc/xmlrpc";
    try
    {
        result = leadPost.NewLead("XXXKeyXXX", newLead);
        Label1.Text = result;
    }
    catch (Exception ex)
    {
        throw ex;
    } 
```

我的代码在 try 块中抛出错误：leads 成员不是 base64 类型！如何正确设置？

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-02T14:35:08.750

Leads 方法的参数应该是包含两个成员的结构或类，例如：

```
public struct leadsParam
{
   public string key;
   public byte[] leads;
} 
```

界面将是

```
public interface ILead
{
    [XmlRpcMethod("leads")]
    string NewLead(leadsParam leads);
} 
```

# ide - 在 Matlab 中，如何使用命令移动文档栏？

> ID：10855158
> 
> 赞同：3
> 
> 时间：2012-06-01T18:00:01.617
> 
> 标签：ide, matlab

我在matlab中有一堆停靠的数字。每个都在文档栏中显示为一个选项卡。这是沿着图形窗口底部运行的栏，每个图形都有一个选项卡。通过单击锚点并将其移动到左侧、右侧或顶部，可以轻松移动此栏。从matlab帮助它说...

"移动文档栏。执行以下操作之一：

将其拖到另一个位置。从桌面 > 文档栏 > 栏位置子菜单中选择一个新位置。”

我的问题是，如何使用命令/脚本/代码来做到这一点？

![在此处输入图像描述](../Images/53d535a787a5272dfcf8e7984a4c8a34.png) ![在此处输入图像描述](../Images/2e04721c396d110a00197f882c7bd459.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-15T14:42:23.243

我从未尝试过移动停靠栏，但在创建 gui 时我对命令窗口做了一些类似的处理。例如：

```
function SetCommandWindowDocked(docked)
   j_desktop = com.mathworks.mde.desk.MLDesktop.getInstance;
   cmd_win = j_desktop.getClient('Command Window');
   j_desktop.setClientDocked(cmd_win,docked); 
end 
```

我使用 Yair Altman 的 matlab 实用程序来找出要使用的正确对象/方法，请参阅[matlab fileexchange](http://www.mathworks.com/matlabcentral/fileexchange/?term=authorid:27420)。

# javascript - 强制刷新客户端浏览器

> ID：10855159
> 
> 赞同：1
> 
> 时间：2012-06-01T18:00:10.520
> 
> 标签：javascript, http, caching, browser-cache

我对 javascript 文件添加了相当大的更改。但是，为了注册新的更改，我需要刷新浏览器。我想这对于使用该网站的所有其他人来说也是如此。

有没有办法使客户端的浏览器缓存失效并强制它下载新的js文件？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-01T18:04:29.923

您可以重命名文件，或者在加载文件时添加一个随机参数：

```
<script src="/javascripts/application.js?version=4" type="text/javascript"></script> 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-01T18:04:25.297

您可以在文件名中添加一个参数，例如

```
<script src="script.js?rnd=2131231"></script> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-01T18:13:00.500

[这里](https://stackoverflow.com/questions/118884/what-is-an-elegant-way-to-force-browsers-to-reload-cached-css-js-files)有一个非常全面的讨论，有几种方法可以做到这一点。
如果您的项目不够大或您不使用 apache，推荐的解决方案 (mod_pagespeed) 可能不是您的最佳解决方案，在这种情况下，我会推荐如下格式：

```
<script src="/{sha_1_here}/script.js"></script> 
```

而不是 GET 参数，因为显然某些浏览器不会缓存带有参数的脚本。
这应该适用于任何地方，您只需要重写 URL 服务器端。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-01T18:13:43.660

出于开发目的，我禁用了浏览器端的缓存，以便它始终获取。

但是对于生产，要重置以便所有客户端用户的浏览器都应该下载新版本，您可以查看 apache 的设置以使缓存文件过期。

# django - Celeryd Worker 停止处理任务

> ID：10855162
> 
> 赞同：1
> 
> 时间：2012-06-01T18:00:27.633
> 
> 标签：django, celery, celeryd, celery-task

我有一个 celeryd 和两个工人一起运行，看着他们我看到他们每个接受 4 个任务，处理它们，然后停止处理任务。（请注意，这些任务运行时间很长，最多需要 2 分钟才能处理）。

celeryctl 提供以下信息：

```
django@server: ./manage.py celeryctl inspect active
<- active
DEBUG 2012-06-01 12:51:11,330 amqplib 661 Start from server, version: 8.0, properties: {u'information': u'Licensed under the MPL.  See http://www.rabbitmq.com/', u'product': u'RabbitMQ', u'copyright': u'Copyright (C) 2007-2012 VMware, Inc.', u'capabilities': {}, u'platform': u'Erlang/OTP', u'version': u'2.8.2'}, mechanisms: [u'PLAIN', u'AMQPLAIN'], locales: [u'en_US']
DEBUG 2012-06-01 12:51:11,331 amqplib 507 Open OK! known_hosts []
DEBUG 2012-06-01 12:51:11,331 amqplib 70 using channel_id: 1
DEBUG 2012-06-01 12:51:11,332 amqplib 484 Channel open
-> eso-dev: OK
    - empty -

django@server:  ./manage.py celeryctl inspect scheduled
<- scheduled
DEBUG 2012-06-01 12:52:07,107 amqplib 661 Start from server, version: 8.0, properties: {u'information': u'Licensed under the MPL.  See http://www.rabbitmq.com/', u'product': u'RabbitMQ', u'copyright': u'Copyright (C) 2007-2012 VMware, Inc.', u'capabilities': {}, u'platform': u'Erlang/OTP', u'version': u'2.8.2'}, mechanisms: [u'PLAIN', u'AMQPLAIN'], locales: [u'en_US']
DEBUG 2012-06-01 12:52:07,108 amqplib 507 Open OK! known_hosts []
DEBUG 2012-06-01 12:52:07,108 amqplib 70 using channel_id: 1
DEBUG 2012-06-01 12:52:07,109 amqplib 484 Channel open
-> eso-dev: OK
    - empty -

django@server: ./manage.py celeryctl inspect registered
<- registered
DEBUG 2012-06-01 12:52:20,567 amqplib 661 Start from server, version: 8.0, properties: {u'information': u'Licensed under the MPL.  See http://www.rabbitmq.com/', u'product': u'RabbitMQ', u'copyright': u'Copyright (C) 2007-2012 VMware, Inc.', u'capabilities': {}, u'platform': u'Erlang/OTP', u'version': u'2.8.2'}, mechanisms: [u'PLAIN', u'AMQPLAIN'], locales: [u'en_US']
DEBUG 2012-06-01 12:52:20,568 amqplib 507 Open OK! known_hosts []
DEBUG 2012-06-01 12:52:20,568 amqplib 70 using channel_id: 1
DEBUG 2012-06-01 12:52:20,569 amqplib 484 Channel open
-> eso-dev: OK
    * celery.backend_cleanup
    * celery.chord
    * celery.chord_unlock
    *
celery_haystack.tasks.CeleryHaystackSignalHandler
    *
celery_haystack.tasks.CeleryHaystackUpdateIndex
    * convert.tasks.create_pdf
    * convert.tasks.create_pngs 
```

此外，每次发生这种情况时，要打印到日志的最后一件事是：

```
[2012-06-01 12:17:53,777: INFO/MainProcess] Task convert.tasks.create_pdf[319984de-5bc4-47fc-891f-273d827d625f] retry: None
None
[2012-06-01 12:17:54,327: INFO/MainProcess] Task convert.tasks.create_pdf[8a89f3c1-e991-487e-a2db-a57d23bae17f] retry: None
None 
```

这些任务也恰好在打印之前失败了，在我的代码中，我调用的是：

```
except HTTPError, e:
    statsd.incr('A.stat')
    log.warn('Woops: %s', e)
    create_pdf.retry() 
```

如果我杀死 celeryd （^C，它立即死亡，无需等待任务）并重新启动它，它会继续，就像其他一些任务没有发生任何事情并再次死亡（我认为它总是在`create_pdf`任务中，但日志显示此任务失败并重试没有问题）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-10T03:44:44.410

这是在 v3.0 中修复的 celery 已知错误。（[第 707 期](https://github.com/celery/celery/issues/707 "第 707 期")）

# java - 多个屏幕的 Java GUI 全屏

> ID：10855163
> 
> 赞同：5
> 
> 时间：2012-06-01T18:00:32.110
> 
> 标签：java, user-interface, awt, fullscreen, monitors

我希望我没有发布重复的问题，但我找不到这样的问题，所以也许我安全？反正...

对于我正在制作的应用程序，我将同时打开两个应用程序（两个独立的进程和窗口）。运行这些应用程序的计算机将具有多个监视器。我希望第一个应用程序/窗口全屏并占用我的一个显示器（简单部分），另一个在第二个显示器上全屏。如果可能的话，我希望他们以这种方式进行初始化。

目前，我正在使用以下代码使我的 Windows 全屏显示：

```
this.setVisible(false);
this.setUndecorated(true);
this.setResizable(false);
myDevice = GraphicsEnvironment.getLocalGraphicsEnvironment().getDefaultScreenDevice();
myDevice.setFullScreenWindow(this); 
```

它所在的类是 JFrame 类的扩展，myDevice 属于“GraphicsDevice”类型。当然有可能有更好的方法让我的窗口全屏显示，这样我就可以在两个不同的显示器上全屏显示两个不同的应用程序。

如果我有任何不清楚的地方，请说，我会尝试在澄清中进行编辑！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-01T18:07:17.957

首先，您需要将框架放置在每个屏幕设备上。

```
frame1.setLocation(pointOnFirstScreen);
frame2.setLocation(pointOnSecondScreen); 
```

然后要最大化一个框架，只需在您的 JFrame 上调用它：

```
frame.setExtendedState(Frame.MAXIMIZED_BOTH); 
```

这是一个工作示例，说明：

```
import java.awt.BorderLayout;
import java.awt.Color;
import java.awt.Frame;
import java.awt.GraphicsDevice;
import java.awt.GraphicsEnvironment;
import java.awt.Point;

import javax.swing.BorderFactory;
import javax.swing.JFrame;
import javax.swing.JPanel;
import javax.swing.JTextArea;
import javax.swing.SwingUtilities;

public class Test {
    protected void initUI() {
        Point p1 = null;
        Point p2 = null;
        for (GraphicsDevice gd : GraphicsEnvironment.getLocalGraphicsEnvironment().getScreenDevices()) {
            if (p1 == null) {
                p1 = gd.getDefaultConfiguration().getBounds().getLocation();
            } else if (p2 == null) {
                p2 = gd.getDefaultConfiguration().getBounds().getLocation();
            }
        }
        if (p2 == null) {
            p2 = p1;
        }
        createFrameAtLocation(p1);
        createFrameAtLocation(p2);
    }

    private void createFrameAtLocation(Point p) {
        final JFrame frame = new JFrame();
        frame.setTitle("Test frame on two screens");
        frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        JPanel panel = new JPanel(new BorderLayout());
        final JTextArea textareaA = new JTextArea(24, 80);
        textareaA.setBorder(BorderFactory.createLineBorder(Color.DARK_GRAY, 1));
        panel.add(textareaA, BorderLayout.CENTER);
        frame.setLocation(p);
        frame.add(panel);
        frame.pack();
        frame.setExtendedState(Frame.MAXIMIZED_BOTH);
        frame.setVisible(true);
    }

    public static void main(String[] args) {
        SwingUtilities.invokeLater(new Runnable() {

            @Override
            public void run() {
                new Test().initUI();
            }
        });
    }

} 
```

# javascript - Disqus 通用代码不适用于新的 disqus_identifier

> ID：10855164
> 
> 赞同：1
> 
> 时间：2012-06-01T18:00:35.127
> 
> 标签：javascript, disqus

此代码在线程 disqus_identifier 指向返回评论时显示评论，但是当它是零评论的线程时，我收到一条错误消息，内容为“我们无法加载 Disqus。如果您是版主，请参阅我们的故障排除指南。 "

```
<div id="disqus_thread"></div>
<script type="text/javascript">
/* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
var disqus_shortname = 'my_short_name'; // required: replace example with your forum shortname
var disqus_identifier = 'random';
/* * * DON'T EDIT BELOW THIS LINE * * */
(function() {
    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
    dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();
</script> 
```

必须有某种方法来创建一个空线程。提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-17T04:36:04.530

看起来您的站点无法访问，您可以使用 Disqus JavaScript 配置变量

```
var disqus_developer = 1; // developer mode is on 
```

这告诉 Disqus 服务您正在一个无法访问的网站上测试系统，例如安全的登台服务器或本地环境

[http://help.disqus.com/customer/portal/articles/472098-javascript-configuration-variables](http://help.disqus.com/customer/portal/articles/472098-javascript-configuration-variables)

还要验证您的`disqus_shortname`变量

# r - R quantreg basksolve 错误

> ID：10855165
> 
> 赞同：3
> 
> 时间：2012-06-01T18:00:40.380
> 
> 标签：r, quantreg

当我在 RI 中安装 quantreg 包时，会收到以下警告：

```
> library(quantreg)
Loading required package: SparseM
Package SparseM (0.96) loaded.
       To cite, see citation("SparseM")

Attaching package: 'SparseM'

The following object(s) are masked from 'package:base':

    backsolve

Package quantreg (4.79) loaded.
        To cite, see citation("quantreg") 
```

然后，在运行分位数回归后：

```
sym.lm  = rq(Y ~ X1 + X2 + X3 + X4 + X5 + X6 + X7, data = myd, na.action = na.omit, method = "fn", model = TRUE)
summary(sym.lm)
Error in base::backsolve(r, x, k = k, upper.tri = upper.tri, transpose = transpose,  : 
  singular matrix in 'backsolve'. First zero in diagonal [1]
In addition: Warning message:
In summary.rq(sym.lm) : 21010 non-positive fis 
```

此错误是否与反向求解范围问题有关？

# objective-c - 用于以 Flash 方式创建应用程序介绍的 IOS API

> ID：10855171
> 
> 赞同：0
> 
> 时间：2012-06-01T18:00:48.773
> 
> 标签：objective-c, ios5

我需要为 IOS 应用程序创建一个介绍，我想在带有音乐的 Macos X 屏幕保护程序主题（海滩、森林......）等图像之间创建过渡，以及文本的出现和消失。我不确切知道哪个 IOS API/框架最适合用来实现这一点。我将不胜感激建议或教程链接。

非常感谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T18:11:53.333

带有块动画的 UIImageView 和 UILabel 怎么样？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-01T18:14:05.660

这些链接至少可以为您提供一些关于如何开始的灵感：

[iphone图像褪色](https://stackoverflow.com/questions/5618964/iphone-fading-of-images)

[http://www.youtube.com/watch?v=a4M0BkJwLT0](http://www.youtube.com/watch?v=a4M0BkJwLT0)

# php - 301重定向到同名文件，同一个服务器，但域名不同

> ID：10855174
> 
> 赞同：2
> 
> 时间：2012-06-01T18:00:58.210
> 
> 标签：php, html, .htaccess

我最近对一个网站进行了大修，我们为该网站切换到了一个新的主域名。旧域名仍处于活动状态，需要重定向到新域名。

该站点仍然具有相同的根文件夹，因此有几个文件已更新，但名称相同（即 index.php、about.php、contact.php）。

我手动将不再存在的所有文件（通过.htaccess）重定向到具有手动重定向的新文件：

```
redirect 301 /old_file.php http://www.new_domain.org/new_file.php 
```

但是，这不适用于具有相同名称的文件，例如“index.php”。我仍然可以使用旧域名调用该站点。如何正确引用这些文件，以免受到谷歌的重复处罚？

我试过了，但没有用：

```
#Options +FollowSymLinks
RewriteEngine on
RewriteCond %{HTTP_HOST} ^www.old_domain.org$[OR]
RewriteCond %{HTTP_HOST} ^old_domain.org$
RewriteRule ^(.*)$ http://www.new_domain.org/$1 [R=301,L] 
```

谢谢你

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-01T18:07:30.870

*   清除浏览器缓存并重新启动它
*   确保 mod_rewrite 和 .htaccess 已启用`httpd.conf`，然后将此代码放在您`.htaccess`的`DOCUMENT_ROOT`目录中：

代码

```
Options +FollowSymLinks -MultiViews
# Turn mod_rewrite on
RewriteEngine On
RewriteBase /

RewriteCond %{HTTP_HOST} ^(www\.)?old_domain\.org$ [NC]
RewriteRule ^ http://www.new_domain.org%{REQUEST_URI} [R=301,L] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-01T18:09:16.210

看看使用规范标签作为替代方案。

[http://www.seomoz.org/blog/cross-domain-canonical-the-new-301-whiteboard-friday](http://www.seomoz.org/blog/cross-domain-canonical-the-new-301-whiteboard-friday)

# asp.net-mvc - 如果有的话，什么设计模式在实现基于用户的记录级权限方面有用？

> ID：10855175
> 
> 赞同：4
> 
> 时间：2012-06-01T18:01:00.823
> 
> 标签：asp.net-mvc, entity-framework, design-patterns

我正在使用 ASP.NET MVC 和使用 Repository 模式进行数据访问的实体框架来实现 Web 应用程序。此应用程序将有几个不相关的用户创建对象。每个用户应该只能访问他们自己的对象。

**是否有任何模式或内置 EF 功能提供一种方法来确保用户只能访问自己的记录？**

我目前正在考虑向所有私有域对象添加一个*所有者*字段，并实现一个对数据库的所有查询都必须通过的类。此类将确定被查询的域对象是否是私有的。如果是这样，这个类将在查询中附加一个关于*所有者的过滤器。*这听起来合理吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-01T18:08:33.527

您问题的第二部分非常接近[*Repository Pattern*](http://msdn.microsoft.com/en-us/library/ff649690.aspx)的描述。这种方法可用于通过强制插入用户特定的过滤器来解决逐个记录的访问问题。

这种方法将您的客户端业务逻辑与基于行的安全性实现分离：如果您以后决定更改*实现*逐条记录访问的方式，您需要修改的只是您的存储库实现。客户端甚至不需要重新编译。

EF 将所有业务实体的存储库定义为部分类。您可以在其之上添加一个接口（在单独的文件中），并使用 EF 生成的方法实现存储库的方法：

```
IMyRepository {
    IQueryable<ClientOrder> Orders;
    IQueryable<ServiceIssue> Issues;
}

// The other part of MyRepository is EF-generated.
// Assume that EF provides properties these properties:
// - ObjectSet<ClientOrder> AllOrders 
// - ObjectSet<ServiceIssue> AllIssues 
public partial SecureRepository : IMyRepository {
    private readonly Guid userId;
    public SecureRepository(Guid userId) : this() {
        this.userId = userId;
    }
    public IQueryable<ClientOrder> Orders {
        get {
            return AllOrders.Where(ord => ord.UserId == userId);
        }
    }
    public IQueryable<ServiceIssue> Issues {
        get {
            return AllIssues.Where(csi => csi.UserId == userId);
        }
    }
} 
```

`UserId`在将订单和问题保存到数据库之前，您可以添加用于设置订单和问题的写入方法。

# visual-studio - Visual Studio 中预生成事件中的条件逻辑返回 255

> ID：10855181
> 
> 赞同：1
> 
> 时间：2012-06-01T18:01:36.663
> 
> 标签：visual-studio, conditional

我一直在缩小我试图在 Visual Studio 的预构建事件中进行文件复制的错误。错误是“以代码 255 退出”，这并不能帮助我弄清楚为什么这种语法不起作用：

```
if  '$(PlatformName)' == 'x86' 
  copy C:\work\test\libnria.dll c:\work 
```

有人看到这有什么问题吗？我已将复制命​​令简化为硬编码示例。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-04T08:15:50.517

删除 $(PlatformName) 宏周围的引号？

# php - 需要在使用 ajax 将字符串返回到选择/选项动态之前分解字符串

> ID：10855183
> 
> 赞同：0
> 
> 时间：2012-06-01T18:01:50.260
> 
> 标签：php, mysql, ajax, getjson

所以，我有一个非常糟糕的数据库，我无法转换。

该字符串是 5 个数字，例如：180,2345,123,5643,23534

我需要将这些数字（需要以某种方式爆炸）放在这样的选择选项中：

```
<select name="hotel" id="hotel" class="fieldbackend">
<option value="403">403</option>
<option value="880">880</option>
<option value="983">983</option>
<option value="648">648</option>
</select> 
```

目前我得到了这个结果：

```
<select name="hotel" id="hotel" class="fieldbackend">
<option value="undefined">undefined</option>
<option value="undefined">undefined</option>
<option value="undefined">undefined</option>
<option value="undefined">undefined</option>
<option value="403,880,983,648">403,880,983,648</option>
</select> 
```

有我的源代码：

```
<select class="fieldbackend" id="destination" name="destination">
     <option value="">-- Destination --</option>
</select>

<select class="fieldbackend" id="hotel" name="hotel">
     <option value="">-- Hôtel --</option>
</select> 
```

有我的JS：

```
$(function(){
    $('#destination').change(function(){
        $.getJSON('/dev/select2.php', {'destination': $(this).val()}, function(data) {
            var items = '';
            $.each(data, function(key, val) {
                items += '<option value="' + val['deHotels'] + '">' + val['deHotels'] + '</option>';
            });

        $('#hotel').html(items);
        });
    });
}) 
```

最后是我的php代码：

```
$requete = "SELECT DISTINCT deHotels FROM sirev_Dests WHERE deDestName = '". $_GET['destination'] ."' ORDER BY deDestName";
    $connect = mysql_connect("&&&&&&&&&&&&&&&","&&&&&&&&&&&&&&&","&&&&&&&&&&&&&&&");

    mysql_select_db("&&&&&&&&&&&&&&&", $connect);

    $res = mysql_query($requete) or die(mysql_error());
    while ($row = mysql_fetch_assoc($res, true)) {
        $items = explode(',',$row['deHotels']);
        array_push($items, $row);
    }
die(json_encode($items)); 
```

结果有一个屏幕：http: [//nsa29.casimages.com/img/2012/06/01/120601072406136633.jpg](http://nsa29.casimages.com/img/2012/06/01/120601072406136633.jpg)

对不起我的英语，我来自魁北克市。

任何人都可以帮我弄清楚吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-01T18:10:06.803

试试这个：

```
while ($row = mysql_fetch_assoc($res, true)) {
  array_push($items, $row['deHotels']);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-01T18:12:02.747

您的 PHP 代码应如下所示：

```
$res = mysql_query($requete) or die(mysql_error());
if ($res) {
    $row = mysql_fetch_row($res);
    $items = explode(',', $row);
    die(json_encode($items));
} 
```

由于您只从数据库中选择 1 行，因此无需循环查询结果。并用于`explode()`将字符串`'180,2345,...'`转换为`array('180','2345',...)`.

在你的 js 中，替换`val['deHotels']`为`val`：

```
$.each(data, function(key, val) {
   items += '<option value="' + val + '">' + val + '</option>';
}); 
```

# php - 计算直方图的数值？

> ID：10855185
> 
> 赞同：1
> 
> 时间：2012-06-01T18:01:58.350
> 
> 标签：php, image-processing, histogram

我需要比较 2 个不同图像的 2 个不同直方图（以搜索相似图像）

我怎样才能得到直方图的数值，所以我可以做类似的事情：

```
if ( (image1.histogram_value - image2.histogram_value) < threshold )
 //> images are similar ! 
```

## 笔记：

我需要一个值，因为我需要将它存储在数据库中，这样我就可以快速比较数千张图像。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T18:19:48.730

您应该使用直方图相似性度量来比较两个直方图。否则，使用单个数字来表示直方图是没有意义的，除非您的直方图始终是具有单个参数的众所周知的密度函数（这不是任意图像的情况）。

因此，您可以使用以下措施之一（以及许多其他措施）：

*   巴塔查里亚系数
*   欧几里得距离

# javascript - 使用 javascript 获取位图的像素

> ID：10855189
> 
> 赞同：3
> 
> 时间：2012-06-01T18:02:25.480
> 
> 标签：javascript, image, bitmap, pixel

我正在尝试专门为我自己的页面编写一个greasemonkey javascript 代码。在页面中，有一个 id 为“barcode”的 img。

我可以用

```
var imageattributes = document.getElementById('barcode'); 
```

并从页面中获取图像。我想要的是我希望能够将这个图像中的所有像素放在一个数组中。

我一直在stackoverflow中四处走动，并看到了一些方法来做到这一点。我也看到了pixastic。我对stackoverflow中的解决方案的问题是

```
var imgData = context.getImageData(0, 0, canvas.height, canvas.width); 
```

不起作用。不管我做什么。而且 pixastic 没有显示我如何在任何地方查看像素信息。他们的文档只涵盖了他们已经拥有的反转、模糊等功能。

我目前拥有的代码是这样的：

```
var imageattributes = document.getElementById('barcode').attributes;
var imageurl = imageattributes.getNamedItem("src").value;
var imageurl2 = imageurl.replace("..","http://localhost");

var img = new Image();
img.src = imageurl2;
context.drawImage(img, 0, 0);
var imgData = context.getImageData(0, 0, canvas.height, canvas.width);
var pixel = new Array();
for(i=0;i<canvas.height;i++){
    pixel[i] = new Array();
    for(j=0;j<canvas.width;j++){
        pixel[i][j] = imgData.data[i*canvas.width+j*4];
    }
}
document.getElementById('derp').innerHTML = imageurl; 
```

应该获取图像，将其作为 src，将其加载为新图像，并将像素放入数组中。最后一行只是在屏幕上显示代码是否有效，因此如果 url 打印，则表示它有效，如果没有，则表示无效。

谁能帮我解决这个问题？谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T22:52:28.350

您没有（或没有使用）`<canvas>`元素。您的 HTML 应如下所示：

```
<img id="barcode" src="whatever.bmp">
<canvas id="mycanvas">
    <div id="fallback">
        You only see this message if your browser doesn't support canvas.
    </div>
<canvas> 
```

您的函数应以：

```
var context = document.getElementById('mycanvas').getContext('2d'); 
```

那应该使您的代码正常运行。您需要先获取`<canvas>`元素的绘图上下文，然后将图像添加到该上下文中，最后从上下文中检索像素数据。

要直接解决您上面的评论，该行

```
var context = document.getElementById('barcode').getContext('2d'); 
```

尝试获取图像元素的上下文，但这是不可能的。您只能调用`getContext`画布元素。

# android - 在 ImageView android 中看不到图像

> ID：10855194
> 
> 赞同：2
> 
> 时间：2012-06-01T18:02:47.057
> 
> 标签：android, imageview

我正在尝试使用 MyClass 中的对象填充 ListView 项。该类的属性之一是 jpg 图像。我把我的图像放在图像/文件夹中。我使用此代码填充

```
private static final String ASSETS_DIR = "images/";
String imgFilePath=ASSETS_DIR+r.resourceID;

    try{
    Bitmap bitmap = BitmapFactory.decodeFile(imgFilePath);
    resourceIdView.setImageBitmap(bitmap);

    }
    catch(Exception e)
    {
        System.out.println(" Error");

    } 
```

r.resourceID 是图像的名称，例如“AUD.jpg” resourceIDView 是 ImageView 程序没有进入 catch 部分，但是我看不到图像，有人可以帮我吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T18:06:07.317

将您的图像放在可绘制文件夹中并设置为 imageview ...

```
 resourceIdView.setImageResource(R.drawable.AUD); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-01T19:07:33.770

根据您的命名约定，我得出结论，您将图像存储在“资产”文件夹中。如果是，那么您可以使用以下代码行来解决此问题：

```
private static final String ASSETS_DIR = "images/";
String imgFilePath=ASSETS_DIR+r.resourceID;

try{
    Drawable d = Drawable.createFromStream(getAssets().open(imgFilePath), null);
    resourceIdView.setImageDrawable(d);
}
catch(Exception e)
{
    System.out.println(" Error");

} 
```

希望这可以帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-01T18:38:17.463

您可以尝试将图像放在 /res 下的 drawable 文件夹中。使用`ImageAdapter`扩展`BaseAdapter`来填充您的 ListView。您可以使用此代码：[http ://www.java2s.com/Code/Android/2D-Graphics/extendsBaseAdaptertocreateImageadapter.htm](http://www.java2s.com/Code/Android/2D-Graphics/extendsBaseAdaptertocreateImageadapter.htm)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-01-22T02:47:37.597

我所拥有的是图像在 Designer 中显示但不在设备上，所以我将图像放在所有 drawable-xdpi 目录中。这对我有用。

# gunicorn - Gunicorn worker 超时错误

> ID：10855197
> 
> 赞同：261
> 
> 时间：2012-06-01T18:03:01.530
> 
> 标签：gunicorn

我已经设置了 3 个工作人员 30 个工作人员连接并使用 eventlet 工作人员类的 gunicorn。它是在 Nginx 后面设置的。每隔几个请求后，我就会在日志中看到这一点。

```
[ERROR] gunicorn.error: WORKER TIMEOUT (pid:23475)
None
[INFO] gunicorn.error: Booting worker with pid: 23514 
```

为什么会这样？我怎样才能弄清楚出了什么问题？

谢谢

* * *

## 回答 #1

> 赞同：236
> 
> 时间：2014-06-19T11:52:48.177

我们在使用 Django+nginx+gunicorn 时遇到了同样的问题。从 Gunicorn 文档中，我们配置了几乎没有区别的优雅超时。

经过一番测试，我们找到了解决办法，要配置的参数是：超时（而不是优雅超时）。它像时钟一样工作..

所以，做：

1）打开gunicorn配置文件

2) 将 TIMEOUT 设置为您需要的值 - 值以秒为单位

```
NUM_WORKERS=3
TIMEOUT=120

exec gunicorn ${DJANGO_WSGI_MODULE}:application \
--name $NAME \
--workers $NUM_WORKERS \
--timeout $TIMEOUT \
--log-level=debug \
--bind=127.0.0.1:9000 \
--pid=$PIDFILE 
```

* * *

## 回答 #2

> 赞同：56
> 
> 时间：2018-01-05T06:26:14.607

在 Google Cloud 上只需添加`--timeout 90`到入口点`app.yaml`

```
entrypoint: gunicorn -b :$PORT main:app --timeout 90 
```

* * *

## 回答 #3

> 赞同：30
> 
> 时间：2012-08-18T16:21:42.450

运行 Gunicorn `--log-level debug`。

它应该为您提供应用程序堆栈跟踪。

* * *

## 回答 #4

> 赞同：18
> 
> 时间：2020-04-23T13:20:12.353

这个端点是否花费了太多时间？

也许你使用的是没有异步支持的flask，所以每个请求都会阻塞调用。要轻松创建异步支持，请添加`gevent`worker。

使用 gevent，一个新调用将产生一个新线程，您的应用将能够接收更多请求

```
pip install gevent
gunicon .... --worker-class gevent 
```

* * *

## 回答 #5

> 赞同：12
> 
> 时间：2013-08-06T03:34:43.767

会不会是这个？ [http://docs.gunicorn.org/en/latest/settings.html#timeout](http://docs.gunicorn.org/en/latest/settings.html#timeout)

其他可能性可能是您的响应时间过长或等待。

* * *

## 回答 #6

> 赞同：12
> 
> 时间：2018-08-09T09:31:47.327

`WORKER TIMEOUT`意味着您的应用程序无法在定义的时间内响应请求。您可以使用[gunicorn 超时设置进行设置](http://docs.gunicorn.org/en/stable/settings.html#timeout)。某些应用程序需要比另一个应用程序更多的时间来响应。

可能影响这一点的另一件事是[选择工人类型](http://docs.gunicorn.org/en/stable/design.html#choosing-a-worker-type)

> 默认同步工作程序假定您的应用程序在 CPU 和网络带宽方面是资源受限的。一般来说，这意味着您的应用程序不应该做任何花费未定义时间的事情。花费未定义时间的示例是对 Internet 的请求。在某些时候，外部网络会出现故障，导致客户端堆积在您的服务器上。因此，从这个意义上说，任何向 API 发出传出请求的 Web 应用程序都将受益于异步工作者。

当我遇到与您相同的问题时（我试图使用 Docker Swarm 部署我的应用程序），我试图增加超时并使用另一种类型的工作类。但都失败了。

然后我突然意识到我将我的资源限制在我的撰写文件中的服务**太低了。**在我的情况下，这是减慢应用程序的事情

```
deploy:
  replicas: 5
  resources:
    limits:
      cpus: "0.1"
      memory: 50M
  restart_policy:
    condition: on-failure 
```

所以我建议你首先检查一下是什么降低了你的应用程序的速度

* * *

## 回答 #7

> 赞同：9
> 
> 时间：2021-01-21T11:22:36.223

用于在 Azure App Services (Linux App) 上运行 Flask Apps 的 Microsoft Azure 官方文档将超时的使用说明为 600

```
gunicorn --bind=0.0.0.0 --timeout 600 application:app 
```

[https://docs.microsoft.com/en-us/azure/app-service/configure-language-python#flask-app](https://docs.microsoft.com/en-us/azure/app-service/configure-language-python#flask-app)

* * *

## 回答 #8

> 赞同：8
> 
> 时间：2019-05-09T19:24:48.260

我在 Docker 中遇到了同样的问题。

在 Docker 中，我保持训练有素的`LightGBM`模型 +`Flask`服务请求。作为我使用的 HTTP 服务器`gunicorn 19.9.0`。当我在我的 Mac 笔记本电脑上本地运行我的代码时，一切都很完美，但是当我在 Docker 中运行应用程序时，我的 POST JSON 请求冻结了一段时间，然后工作人员因异常`gunicorn`而失败。`[CRITICAL] WORKER TIMEOUT`

我尝试了很多不同的方法，但唯一解决我的问题的是添加`worker_class=gthread`.

这是我的完整配置：

```
import multiprocessing

workers = multiprocessing.cpu_count() * 2 + 1
accesslog = "-" # STDOUT
access_log_format = '%(h)s %(l)s %(u)s %(t)s "%(r)s" %(s)s %(b)s "%(q)s" "%(D)s"'
bind = "0.0.0.0:5000"
keepalive = 120
timeout = 120
worker_class = "gthread"
threads = 3 
```

* * *

## 回答 #9

> 赞同：7
> 
> 时间：2015-09-18T11:06:56.893

我遇到了非常相似的问题，我也尝试使用“runserver”来查看是否可以找到任何东西，但我所拥有的只是一条消息`Killed`

所以我认为这可能是资源问题，我继续为实例提供更多 RAM，并且它起作用了。

* * *

## 回答 #10

> 赞同：6
> 
> 时间：2014-05-07T10:28:12.480

您需要使用其他工作类型类，如**gevent**或**tornado**之类的异步类，请参阅此以获得更多解释：第一个解释：

> 如果您希望您的应用程序代码在请求处理期间可能需要长时间暂停，您可能还需要安装 Eventlet 或 Gevent

第二个 ：

> 默认同步工作程序假定您的应用程序在 CPU 和网络带宽方面是资源受限的。一般来说，这意味着您的应用程序不应该做任何花费未定义时间的事情。例如，对 Internet 的请求符合此标准。在某些时候，外部网络会出现故障，导致客户端堆积在您的服务器上。

* * *

## 回答 #11

> 赞同：5
> 
> 时间：2020-06-08T01:01:23.420

这对我有用：

```
gunicorn app:app -b :8080 --timeout 120 --workers=3 --threads=3 --worker-connections=1000 
```

如果你有`eventlet`添加：

```
--worker-class=eventlet 
```

如果你有`gevent`添加：

```
--worker-class=gevent 
```

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2019-11-28T08:53:04.717

超时是这个问题的一个关键参数。

但是它不适合我。

当我设置workers = 1时，我发现没有gunicorn超时错误。

当我查看我的代码时，我**在服务器初始化中发现了一些套接字连接（socket.send 和 socket.recv）。**

**socket.recv 会阻止我的代码，这就是为什么当worker>1时它总是超时的原因**

希望能给对我有问题的人一些想法

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2019-06-11T01:05:58.760

如果您使用 GCP，则必须为每个实例类型设置工作人员。

链接到 GCP 最佳做法[https://cloud.google.com/appengine/docs/standard/python3/runtime](https://cloud.google.com/appengine/docs/standard/python3/runtime)

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2019-11-20T04:17:37.763

对我来说，解决方案是添加`--timeout 90`到我的入口点，但它不起作用，因为我定义了两个入口点，一个在 app.yaml 中，另一个在我的 Dockerfile 中。我删除了未使用的入口点并添加`--timeout 90`了另一个入口点。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2020-10-15T12:19:12.020

弗兰克的回答为我指明了正确的方向。我有一个访问托管 Digital Ocean Postgresql 数据库的 Digital Ocean 液滴。我需要做的就是将我的 Droplet 添加到数据库的“可信来源”中。

（单击 DO 控制台中的数据库，然后单击设置。编辑可信来源并选择液滴名称（单击可编辑区域，它将向您建议））。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2020-09-14T07:04:47.080

对我来说，这是因为我忘记在数据库服务器上为我的 Django 设置防火墙规则。

# iphone - iPhone iOS Apple Demo代码的完整列表？

> ID：10855199
> 
> 赞同：-4
> 
> 时间：2012-06-01T18:03:10.947
> 
> 标签：iphone, ios, objective-c

我花了大约 15 分钟寻找名为 AVCam 的旧 WWDC 2010 代码并在[此处找到它](http://developer.apple.com/library/ios/#samplecode/AVCam/Introduction/Intro.html)

纯粹出于好奇，我想看看还有哪些其他代码可用，但[iOS 开发人员库](http://developer.apple.com/library/ios/#samplecode/) 一直在重定向我。

**作为 iOS 开发计划的成员，我是否可以通过 Apple 浏览 iOS 示例库？**也许有一个集中的地方列出了所有的演示，所以我可以简单地按名称搜索它们？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-01T18:05:41.240

您可以轻松搜索 Xcode 4 Organizer 中的所有示例。

# sql - 当某个日期范围内不存在时，需要返回一个值并将其计数为 0

> ID：10855208
> 
> 赞同：2
> 
> 时间：2012-06-01T18:04:17.030
> 
> 标签：sql, date, join, constraints

下面是我的确切代码。此查询非常有效，除非在日期范围内不存在 teamid。如果在指定的日期范围内不存在 teamid，我希望 SQL 将 teamid 添加到表中并将其计数设置为 0。然后，我的表会自动将 teamid 转换为我的 teamtext。

```
SELECT tn.teamtext, COUNT(referteamID2) AS cnt
FROM teamnames AS tn
JOIN caseaudit AS ca
ON tn.teamID = ca.referteamID2
WHERE CONVERT(smalldatetime,dModLast,101) BETWEEN '2012-03-01' AND '2012-03-10'
AND ca.referteamid1 <> ca.referteamid2
AND teamid IN (99, 107, 124, 27, 31, 44, 110, 43, 57, 50, 46)
GROUP BY tn.teamtext
ORDER BY tn.teamtext 
```

这将返回：

```
4H BOSS                59
ASSET MANAGEMENT       16
BOSS                   5
CUSTOMER SUPPORT       133
NETWORK ENGINEERING    15
PRODUCTION ENGINEERING 142
SECURITY               6
VOICE SERVICES         21
XEROX                  8 
```

有人告诉我，这个问题可能与在给出日期限制后使用 IN 有关。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-01T18:07:51.900

将条件从 WHERE 子句移至 SELECT 中的 CASE 语句：

```
SELECT tn.teamtext,
       sum(case when CONVERT(smalldatetime,dModLast,101) BETWEEN '2012-03-01' AND '2012-03-10' 
                then 1 else 0
           end) AS cnt
FROM teamnames AS tn JOIN
     caseaudit AS ca
     ON tn.teamID = ca.referteamID2
WHERE ca.referteamid1 <> ca.referteamid2 AND
      teamid IN (99, 107, 124, 27, 31, 44, 110, 43, 57, 50, 46)
GROUP BY tn.teamtext
ORDER BY tn.teamtext 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-01T18:32:42.470

您可以尝试使用外部连接，但我不确定这是否是一种有效的方法：

```
SELECT tn.teamtext, SUM(case when ca.referteamID2 is null then 0 else 1) AS cnt
FROM teamnames AS tn
LEFT OUTER JOIN caseaudit AS ca
ON tn.teamID = ca.referteamID2
WHERE CONVERT(smalldatetime,dModLast,101) BETWEEN '2012-03-01' AND '2012-03-10'
AND ca.referteamid1 <> ca.referteamid2
AND teamid IN (99, 107, 124, 27, 31, 44, 110, 43, 57, 50, 46)
GROUP BY tn.teamtext
ORDER BY tn.teamtext 
```

# database - 移动 REST 到数据库架构的示例

> ID：10855210
> 
> 赞同：0
> 
> 时间：2012-06-01T18:04:25.427
> 
> 标签：database, rest, architecture

有没有人有针对移动设备优化的 REST 应用程序架构。我希望看到的架构与数据库一起管理 REST 请求和响应。理想情况下，我希望看到一种具有扩展能力并且可以灵活更改的架构。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-14T14:43:35.780

你应该看看 MVVM 架构模式。有大量的 MVVM 教程，但您可以从[Silverlight 客户端开始使用 MVVM](http://hsuhanda.blogspot.com/2010/09/silverlight-client-for-rest-using-mvvm.html) post。另请参阅此问题[Good architecture for 在 Windows Phone 7 的 MVVM 应用程序中使用 REST Web 服务？](https://stackoverflow.com/questions/3182229/good-architecture-for-consuming-a-rest-web-service-in-an-mvvm-app-for-windows-ph)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-31T17:21:29.687

根据我的经验，RESTlets 和 Hibernate 是使用 ORM 实现 REST 到数据库解决方案的好解决方案。

# java - 在捆绑包中包含第 3 方罐子

> ID：10855214
> 
> 赞同：0
> 
> 时间：2012-06-01T18:04:30.250
> 
> 标签：java, osgi, classloader

我正在尝试在我的捆绑包中包含 3rd 方 jar。我正在关注本教程[http://www.aqute.biz/Blog/2007-02-19](http://www.aqute.biz/Blog/2007-02-19)，但是在我的 Activator 中，我在尝试从该外部 jar 中引用一个类时得到 ClasNotFoundException 。

我的 bundle jar 目录结构：

```
-\MyBundle
  -\plugin.xml
  -\META-INF
    -\MANIFEST.MF
  -\org
    -\mybundle
      -\Activator.class
  -\3rdParty.jar 
```

MANIFEST.MF 看起来像这样：

```
...
Bundle-ClassPath: .,
 3rdParty.jar
... 
```

它是 Eclipse 3.5.1 RCP 应用程序的一部分。

错误信息：

```
java.lang.ClassNotFoundException: 3rd.party.proxy.ConfiguratorProxy
    at org.eclipse.osgi.internal.loader.BundleLoader.findClassInternal(BundleLoader.java:494)
    at org.eclipse.osgi.internal.loader.BundleLoader.findClass(BundleLoader.java:410)
    at org.eclipse.osgi.internal.loader.BundleLoader.findClass(BundleLoader.java:398)
    at org.eclipse.osgi.internal.baseadaptor.DefaultClassLoader.loadClass(DefaultClassLoader.java:105)
    at java.lang.ClassLoader.loadClass(Unknown Source)
    at java.lang.ClassLoader.loadClassInternal(Unknown Source)
    at java.lang.Class.forName0(Native Method)
    at java.lang.Class.forName(Unknown Source)
    at my.program.eclipse.core.ProcessEditorUploaderActivator.start(ProcessEditorUploaderActivator.java:111) 
```

但是当我调用 this.getClass().getResource("/3rdParty.jar") 时，它会起作用。

**编辑：问题已解决**。我不得不从我的 RCP 应用程序中删除 org.eclipse.core.runtime、org.eclipse.equinox.app 和 org.eclipse.osgi 目录。缓存了有关捆绑包类路径的信息。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-04T08:48:54.727

需要检查的一些事项：

*   你的 3rdParty.jar 真的在 bundle jar 里面吗？用Winzip打开并检查。

*   您的 Manifest.MF 是否正确？尝试将 Bundle-ClassPath: 的所有条目放在一行上，没有新行： Bundle-ClassPath: .,3rdParty.jar

*   您试图从哪里访问课程？内部 jar 的类将从 MyBundle.jar 的类中可见，但它们不会从框架中的其他包中可见，除非您在清单中导出包！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-02T06:59:07.903

你是从 Eclipse 运行它吗？如果是这样，您的第三方包也应该列在您的 .classpath 文件中。你应该有这样的一行：

`<classpathentry exported="true" kind="lib" path="lib/thirdparty.jar"/>`

（这应该在使用 MANIFEST 编辑器时自动发生）

如果您要导出插件并以其他方式运行它，您将需要一个 build.properties 文件，该文件应类似于：

```
source.. = src/ 
output.. = classes/ 
bin.includes = META-INF/,\
           .,\
           lib/thirdparty.jar 
```

# php - pt、em、px、percent、other的转化率

> ID：10855218
> 
> 赞同：13
> 
> 时间：2012-06-01T18:05:05.103
> 
> 标签：php, javascript, jquery, css, size

当我需要使用 pt 代替 px 或 em 代替 pt 或任何情况时，我会遇到更多的情况，并且尝试为大于 36px 的东西找到合适的尺寸有时在 . ......比它应该的。所以我基本上想让自己成为一个小小的转换计算器。但是，我似乎找不到任何东西可以区分转换率是从一个到另一个，对于另一个相等的对应部分。

我希望我能在这里找到可以帮助我的人。基本上我的总体希望是让自己成为一个基于 jquery 的小输入，比如计算器。我键入我的 px、pt、% 和其他，然后选择要输入的转换并单击确定。

创建计算，很容易。我必须在每次转换的基础上应用的数学不是那么多，这就是我希望在这里找到的，所以我可以做到。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-06-01T18:09:22.277

好，

12pt = 16px = 1em = 100%

假设您不更改正文上的字体大小（否则 pt 会有所不同），您的操作系统的 dpi 设置为 72 等等。

关系如下：

```
pt = 3/4*px

em = pt/12

% = pt*100/12 
```

在这种情况下。值得指出的是，使用 pt 是错误的，除非您正在打印某些东西，并且使用 px、% 或 em 更常见。

就个人而言，我只使用 px 或 em。使用 % 或 em 对于较小屏幕的基本字体大小发生变化的设计很方便。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-01T18:13:28.470

Ems 和 %s 是相对值，可以根据您的上下文而改变。通常，1em 相当于 16px，但是如果你改变你的 body 的字体大小，1em 就相当于你改变它的任何值。1.25em 也相当于 125%。

通常，72pt 相当于 1 英寸，但不应在打印 CSS 之外使用。

px 也是绝对值，但高度依赖于客户端设备 DPI。这变化很大，但大多数设备以可预测的方式处理 px 值——视网膜 iphone 上的 10px 显示与 pre-retina 设备上的 10px 相同。

还有`rem`指`html`元素的字体大小。查看更多：[http ://snook.ca/archives/html_and_css/font-size-with-rem](http://snook.ca/archives/html_and_css/font-size-with-rem)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-05-09T13:31:15.430

*   1 毫米 = 约 3.78 像素
*   1 厘米 = 10 毫米 = 约 37.8 像素
*   1 英寸 = 25.4 毫米 = 96 像素
*   1pt = 1/72 英寸 = 1 1/3 像素
*   1 件 = 12 点 = 1/6 英寸 = 16 像素
*   1 像素 = 3/4 点 = 1/96 英寸

这些关系彼此固定，但请注意它们与屏幕布局中的物理尺寸不对应。如果屏幕的精确 DPI 为 96，则 1 英寸仅对应屏幕上的实际英寸。存在各种各样的屏幕和设备，因此实际上很少会出现这种情况。

1px 也不总是对应一个物理像素。对于高 dpi 设备（例如“视网膜”显示器），浏览器可以将 px 单位转换为物理像素的倍数，例如。1px = 4x4 物理像素。

在打印中，单位 in、cm、mm 实际上确实对应于物理单位。但是，当用于打印样式表时，px 单位与屏幕像素（或 dpi）没有任何关系。它只是定义为 1/96 英寸。

相对单位（em、ex、%）无法转换为绝对单位（px、cm、mm、in、pc、pt），因为相对单位取决于当前字体大小。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-06-01T21:50:14.087

要使网站真正对所有人开放，您需要摆脱点和像素。你需要这些测量是相对的。因此百分比和 ems。

这是最好的方法。

很多人（客户）有各种各样的视力问题。

为什么要做一个那些人不能轻易使用的网站？

（各种标准解决了这些问题）

# windows - 有没有办法在 Windows 下监控正在运行的应用程序的套接字缓冲区大小？

> ID：10855221
> 
> 赞同：0
> 
> 时间：2012-06-01T18:05:35.760
> 
> 标签：windows, sockets, udp, buffer

我试图猜测正在运行的应用程序的 UDP 输入套接字使用的大小，但找不到任何能够做到这一点的软件。更接近的 Ifound 是 TracePlus/Winsock 但它只适用于 32 位应用程序，而我的是 64 位...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T18:25:39.200

与其尝试猜测应用程序在其代码中实际使用的缓冲区大小，我建议您改用数据包嗅探器（例如 Wireshark）来查看实际通过网络传输的数据包的实际大小。应用程序必须使用至少与数据包一样大的缓冲区大小，否则 WinSock 将报告`WSAEMSGSIZE`错误并且数据将被截断/丢弃。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-01T18:37:13.263

你尝试过使用钩子技术吗？我认为绕道可以帮助你

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-04T12:08:24.380

带有 SO_RCVBUF 选项的 getsockopt() 为您提供套接字接收缓冲区的大小。不确定那是你真正想要的。

# asp.net-mvc - ASP.NET MVC、BDD、Specflow 和 WatiN：将应用程序置于特定状态

> ID：10855224
> 
> 赞同：5
> 
> 时间：2012-06-01T18:05:45.053
> 
> 标签：asp.net-mvc, bdd, watin, specflow

我是 BDD、Specflow 和 WatiN 的新手。我想使用这些工具来自动化我的 ASP.NET MVC 应用程序的验收测试。

我已经弄清楚了如何基本使用这些工具，并且我成功构建了我的第一个验收测试：登录网站。

这是这个测试的小黄瓜：

```
Feature: Log on to the web 
    As a normal user
    I want to log on to the web site

Scenario: Log on
    Given I am not logged in
    And I have entered my name in the username textbox
    And I have entered my password in the password textbox
    When I click on the login button
    Then I should be logged and redirected to home 
```

现在，我想写一堆其他的测试，它们都需要对用户进行身份验证。例如：

```
Feature: List the products 
    As an authenticated user
    I want to list all the products

Scenario: Get Products
    Given I am authenticated
    And I am on the products page
    When I click the GetProducts button
    Then I should get a list of products 
```

让我烦恼的是，为了使这个测试独立于其他测试，我必须编写代码才能再次登录网站。这是要走的路吗？我怀疑。

我想知道是否有最佳实践可以用于测试这样的场景。我应该保持浏览器打开并让测试在同一个浏览器上按特定顺序运行吗？还是应该将 MVC 应用程序置于特定状态？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-01T18:36:14.217

为此，我们有一个特定的 Given 步骤，在 Gherkin 中看起来像这样：

```
Given I am signed in as user@domain.tld 
```

就像您提到的，此步骤基本上重复使用其他步骤来登录用户。我们还有一个需要密码的“重载”，以防测试用户有非默认测试密码：

```
Given I am signed in as user@domain.tld using password "<Password>"

[Binding]
public class SignInSteps
{
    [Given(@"I am signed in as (.*)")]
    public void SignIn(string email)
    {
        SignInWithSpecialPassword(email, "asdfasdf");
    }

    [Given(@"I am signed in as (.*) using password ""(.*)""")]
    public void SignInWithSpecialPassword(string email, string password)
    {
        var nav = new NavigationSteps();
        var button = new ButtonSteps();
        var text = new TextFieldSteps();
        var link = new LinkSteps();

        nav.GoToPage(SignOutPage.TitleText);
        nav.GoToPage(SignInPage.TitleText);
        nav.SeePage(SignInPage.TitleText);
        text.TypeIntoTextField(email, SignInPage.EmailAddressLabel);
        text.TypeIntoTextField(password, SignInPage.PasswordLabel);
        button.ClickLabeledSubmitButton(SignInPage.SubmitButtonLabel);
        nav.SeePage(MyHomePage.TitleText);
        link.SeeLinkWithText("Sign Out");
    }
} 
```

我认为这是最好的方法，因为您不能保证所有测试都以特定顺序运行。

不过，您也可以使用 SpecFlow 标签执行此操作，并让该标签执行 BeforeScenario。这可能看起来像这样：

```
Feature: List the products 
    As an authenticated user
    I want to list all the products

@GivenIAmAuthenticated
Scenario: Get Products
    Given I am on the products page
    When I click the GetProducts button
    Then I should get a list of products

[BeforeScenario("GivenIAmAuthenticated")]
public void AuthenticateUser()
{
    // code to sign on the user using Watin, or by reusing step methods
} 
```

> ...我应该将 MVC 应用程序置于特定状态吗？

在用户登录时，需要将其置于特定状态的不是 MVC 应用程序，而是需要置于特定状态的浏览器——即写入身份验证 cookie。我不确定你是否可以这样做，因为 auth cookie 是加密的。我总是发现让 SF 在每个场景开始时通过身份验证步骤更容易。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-20T15:59:28.603

您可能需要考虑进一步完善您的解决方案。阅读[Dan North 的 Who's Domain 是什么](http://dannorth.net/2011/01/31/whose-domain-is-it-anyway/)，然后问问自己这两个场景是否真的属于一起。我发现 danludwig 建议的方法是有价值的，但是根据他们的领域分离你的场景更有价值。把它想象成重构你的场景。

You can still build one scenario from the activities of another, but ask yourself, do you really need to go through the same steps, or would providing a mocked "Already logged in" object to your session work better.

# google-fusion-tables - 融合表 kml 导入不完整

> ID：10855227
> 
> 赞同：0
> 
> 时间：2012-06-01T18:06:01.460
> 
> 标签：google-fusion-tables

我将 KML 文件导入到融合表中，并且看到缺少行 - 我只得到前 4 行。我在 Google 地球中检查了文件，所有多边形都显示得很好，所以我确信 KML 文件没有损坏。

当我第一次在 Google Drive 表格中打开该文件时，它有一个注释说它是 17% 导入的，但随后就消失了。好像导入没有完成。该文件为 20MB。

任何提示或建议。我在这里环顾四周，没有看到类似的问题。指点赞赏！

*PS：如果你对这个问题感兴趣，你可以试试这里的文件：http: [//temp.rahulbotics.com/chna.kml.zip](http://temp.rahulbotics.com/chna.kml.zip)*

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-04T01:33:01.470

问题确实是我的多边形太长（打破了 Fusion Tables 中的长度限制）。我使用了一个快速的 sed 命令来显着减少坐标的有效数字，然后它可以正常导入！

```
sed 's/\([0-9]\{2\}\.[0-9]\{4\}\)[0-9]*/\1/g' orig.kml > trimmed5.kml 
```

# c++ - 如何在 Amazon EC2（运行 Ubuntu Lucid）上设置 Nginx 并配置 FastCGI/FastCGI C++？

> ID：10855228
> 
> 赞同：1
> 
> 时间：2012-06-01T18:06:01.843
> 
> 标签：c++, ubuntu, nginx, amazon-ec2, fastcgi

我正在构建一个我想作为 Web 服务提供的 C++ API。我正在考虑使用 REST API，并决定使用 FastCGI 或 FastCGI C++ 在 C++ API 和 Web 服务器之间进行通信。

这是一个非常高流量的 Web 服务，我将设置一个 Nginx 服务器来处理负载。我可以按照教程在 Amazon EC2（运行 Ubuntu Lucid）上安装 Nginx 并配置为使用 FastCGI 或 FastCGI C++ 吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-01T20:17:53.083

这篇博客如何使用 PHP-FPM 在 Ubuntu Amazon EC2 上设置 Nginx：

[http://blog.johnalvero.com/2010/12/canonical-ubuntu-1010-on-amazon-ec2.html](http://blog.johnalvero.com/2010/12/canonical-ubuntu-1010-on-amazon-ec2.html)

# objective-c - 如何加载多个 QTMovie 对象，然后选择播放哪个？

> ID：10855230
> 
> 赞同：0
> 
> 时间：2012-06-01T18:06:07.347
> 
> 标签：objective-c, cocoa, quicktime

我是使用 Objective-C 和 Cocoa 的新手。

[我已经按照这里](https://developer.apple.com/library/mac/#samplecode/MyMediaPlayer/Introduction/Intro.html)的 Quicktime 播放电影的示例代码。我想知道如何扩展它，以便我可以`QTMovie`在程序开始时加载多个 s，然后在请求时以最小的延迟播放它们中的每一个。

我最初的策略是创建一个包含`QTMovie`对象的类以及加载和播放它的方法。然后在我的主课中，我会有这些`MovieContainer`对象的列表。

当我尝试实现这个时，我`QTMovieLoadStateError`在加载每个`QTMovie`错误消息的过程中得到一个

```
Domain=NSOSStatusErrorDomain Code=-2098 "The operation couldn’t be completed.
(OSStatus error -2098.)" (component is not thread-safe) 
```

我是在完全错误的方向上前进，还是我只是错过了几行可以使这个“线程安全”的代码？

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-04T23:58:51.180

在后台（非主）线程中使用 QTMovie 对象之前，您需要调用：

```
[QTMovie enterQTKitOnThread] 
```

或者

```
[QTMovie enterQTKitOnThreadDisablingThreadSafetyProtection] 
```

选择哪一个取决于电影文件的编解码器。第二种变体将允许非线程安全的组件；对于一些罕见的编解码器，这将是唯一的方法。

呼叫必须与：

```
[QTMovie exitQTKitOnThread] 
```

# c# - 如何将参数传递给ajax调用

> ID：10855232
> 
> 赞同：2
> 
> 时间：2012-06-01T18:06:08.317
> 
> 标签：c#, javascript, asp.net, ajax

我有一个名为 MyTest.js 的 javascript 类，现在我在加载 MyWebPage.cs 时注册了这个脚本，但我需要将 3 个参数传递给函数，然后它将调用 Web 服务。这是我的javascript函数

```
MyTest.init = function() {
    var params = new Hash();
    params.set("blank", "blank");
    new Ajax.Request('/Test.asmx/CreateClients', {
        method: 'post',
        onSuccess: attachCallback(this, "Yay"),
        onFailure: attachCallback(this, "Nay"),
        onException: attachCallback(this, "Nay"),
        parameters: params
    });
} 
```

现在我需要传递的参数是两个字符串、名称和注释，我可以在加载我的 .cs 文件时获得它们。如何将值传递给这个 init 函数？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-01T18:10:21.947

使用数据属性：

```
MyTest.init = function() {
    var params = new Hash();
    params.set("blank", "blank");
    new Ajax.Request('/Test.asmx/CreateClients', {
        method: 'post',
        data: {Name:"name", Notes:"Notes"},
        onSuccess: attachCallback(this, "Yay"),
        onFailure: attachCallback(this, "Nay"),
        onException: attachCallback(this, "Nay"),
        parameters: params
    });
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-01T18:15:26.170

在我看来，您使用的是 Prototype，而不是 jQuery，但我不确定。如果你是，你只需要用`parameters`你的名字和注释属性来填充你的 Ajax.Request 对象。

```
MyTest.init = function(name, note) {
    var params = new Hash();
    params.set("blank", "blank");
    params.set("name", name);
    params.set("note", note);
    new Ajax.Request('/Test.asmx/CreateClients', {
        method: 'post',
        onSuccess: attachCallback(this, "Yay"),
        onFailure: attachCallback(this, "Nay"),
        onException: attachCallback(this, "Nay"),
        parameters: params
    });
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-01T18:15:45.907

你可以试试，在服务器端写出来

```
<script type="text/javascript">
 var param1 = '<%= dotNetValue %>';
 var param2 = '<%= otherDotNetValue %>';
</script> 
```

然后在客户端上，您将可以访问这些（全局）变量

```
params.Set("first", param1);
params.Set("second", param2); 
```

# java - NetBeans 平台：实体记录锁 - 不同的应用程序

> ID：10855241
> 
> 赞同：0
> 
> 时间：2012-06-01T18:06:56.473
> 
> 标签：java, locking, entity, entitymanager, netbeans-platform

我有一个关于 NetBeans 平台中的记录锁定的问题。

所以我有一个带有 DBF 表的数据库。我有一个运行的 NetBeans 平台应用程序，它可以访问这些表。它将记录锁定在其中一个中。

我有另一个运行的 NetBeans 平台应用程序实例。我正在尝试这样做，因此如果打开了多个 NetBeans 平台应用程序实例，则只有 1 个可以访问数据库中的锁定记录。我没有做到这一点。

如果我错了，请纠正我，但 entitymanager.lock 特定于应用程序中的 EntityManage 实例。因此，如果我 Application1.entityManager.lock 锁定了一条记录，那么 Application2.entityManager 不会知道该锁吗？

所以我想另一个问题是：是否可以让同一个 NetBeans 应用程序的 2 个实例共享同一个 EntityManager？

谢谢你

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-02T10:18:34.243

首先，EntityManager 的实例不能保证是线程安全的。这意味着规范不期望实现是线程安全的，并且不鼓励共享实体管理器的实例——当然，构建线程安全的实现当然是大声的。结果是你不想共享实体管理器。

锁定是通过实体管理器执行的，但行被锁定在数据库中。在规范中，这是用以下单词拼写的：

> 当使用悲观锁定来锁定实体实例时，持久性提供程序必须锁定与该实例的非集合值持久状态相对应的数据库行。

# android - Android GLSurfaceView over MediaPlayer-SurfaceView

> ID：10855243
> 
> 赞同：2
> 
> 时间：2012-06-01T18:07:03.690
> 
> 标签：android, android-relativelayout, surfaceview, android-mediaplayer, glsurfaceview

我有一个`MediaPlayer`使用 a`SurfaceView`来显示视频。现在我想添加一个`GlSurfaceView`在`MediaPlayerto`视频上渲染一个立方体。我正在使用相对布局。而且我可以分开做这两项工作，但是我不能`GlSurfaceView`把`SurfaceView`. 它根本不会渲染我用于立方体的 OpenGL 代码。有人可以帮忙吗？

```
 _cube = new CubeGLView(this);
   _cube.setEGLConfigChooser(8, 8, 8, 8, 16, 0);
   _cube.setId(10002);
   _cube.getHolder().setFormat(PixelFormat.TRANSLUCENT);
   _cube.getHolder().setFormat(PixelFormat.RGBA_8888);
   //_cube.setRenderMode(GLSurfaceView.RENDERMODE_CONTINUOUSLY);

   _render = new GlRenderer(_cube.getContext());
   _cube.setRenderer(_render);
   _cube.setVisibility(View.GONE);

   RelativeLayout layout = new RelativeLayout(this);
   RelativeLayout.LayoutParams rlp = new RelativeLayout.LayoutParams(
   RelativeLayout.LayoutParams.MATCH_PARENT,
   RelativeLayout.LayoutParams.MATCH_PARENT);

   RelativeLayout.LayoutParams lp = new RelativeLayout.LayoutParams(
   RelativeLayout.LayoutParams.WRAP_CONTENT,
   RelativeLayout.LayoutParams.WRAP_CONTENT);
   lp.addRule(RelativeLayout.CENTER_IN_PARENT);

   mPreview.setLayoutParams(lp);
   _cube.setLayoutParams(lp);

   layout.addView(_cube);
   layout.addView(mPreview);

   setContentView(layout, rlp); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-04T12:37:49.820

解决它： mPreview = new SurfaceView(this); mPreview.setId(10001);

```
 mPreview.setOnClickListener(this);
    mPreview.setClickable(true);

    holder = mPreview.getHolder();
    holder.addCallback(this);
    holder.setType(SurfaceHolder.SURFACE_TYPE_PUSH_BUFFERS);
    extras = getIntent().getExtras();

    _cube = new CubeGLView(this);
    _cube.setEGLConfigChooser(8, 8, 8, 8, 16, 0);

    _cube.setId(10002);
    _cube.getHolder().setFormat(PixelFormat.TRANSLUCENT);
    _cube.getHolder().setFormat(PixelFormat.RGBA_8888);

    _render = new GlRenderer(_cube.getContext());
    _cube.setRenderer(_render);

    RelativeLayout layout = new RelativeLayout(this);
    RelativeLayout.LayoutParams rlp = new RelativeLayout.LayoutParams(
            RelativeLayout.LayoutParams.MATCH_PARENT,
            RelativeLayout.LayoutParams.MATCH_PARENT);

    RelativeLayout.LayoutParams lp = new RelativeLayout.LayoutParams(
            RelativeLayout.LayoutParams.MATCH_PARENT,
            RelativeLayout.LayoutParams.MATCH_PARENT);
    lp.addRule(RelativeLayout.CENTER_IN_PARENT);

    mPreview.setLayoutParams(lp);

    LayoutParams params = new LayoutParams(LayoutParams.WRAP_CONTENT, LayoutParams.WRAP_CONTENT);
    params.setMargins(100,10, 0,0);
    _cube.setLayoutParams(params);

    DataManager datamanager = DataManager.getInstance();

    if (!datamanager.isHasalreadyview()){
        Log.d(TAG, "onCreate icicle == null");
        layout.addView(_cube);
        layout.addView(mPreview);
        datamanager.setHasalreadyview(true);
    }else{
        Log.d(TAG, "onCreate icicle != null");
        layout.addView(mPreview);
        layout.addView(_cube);
    }

    setContentView(layout, rlp); 
```

# ios - 游戏中心换肤

> ID：10855251
> 
> 赞同：0
> 
> 时间：2012-06-01T18:07:40.387
> 
> 标签：ios, xcode, game-center, gamekit

是否可以从 GameCenter 获取数据并为其创建自己的皮肤？

如果是这样，我在哪里可以访问我们收到的所有数据？我想要的重要数据是当前比赛，其他一切对我来说都没什么大不了的。谁能帮忙？！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T21:08:08.157

这些应该可以帮助您：

```
[GKTurnBasedMatch loadMatchesWithCompletionHandler:(void (^)(NSArray *matches, NSError *error))completionHandler];

[GKTurnBasedMatch loadMatchDataWithCompletionHandler:(void (^)(NSData *matchData, NSError *error))completionHandler]; 
```

编辑：

一步一步解释整个过程需要很长的帖子，但这里是主要思想：

```
[GKTurnBasedMatch loadMatchesWithCompletionHandler:(void (^)(NSArray *matches, NSError *error)){ 

for (GKTurnBasedMatch *myMatch in matches) {

// update your UI depending on the games. Below is just an example.. This part is up to you - update a tableView, manage a view etc..

int k = 0; // will hold the number of active players still in the game
for (GKTurnBasedParticipant *part in myMatch.participants) {

if(participant.matchOutcome != GKTurnBasedMatchOutcomeQuit){
k++;
}

}

if ([myMatch.currentParticipant.playerID isEqualToString [GKPlayer localPlayer].playerID]) {
//our turn

if (k<2) { //there are less than 2 active players - end game if it's your turn etc...

//end turn depending on your turn.
return;
}

//update your UI for that match..

} else { //not your turn

//update your UI - goes to their turn section for example

}

}

}]; 
```

再次，我只是从头顶写下所有这些，所以我确定有错误，但这是你想要采取的主要路线。您想获取当前比赛的列表 - 并根据轮到谁或比赛是否结束以及其他内容列出它们。

# wordpress - 在 WordPress 上的帖子内容和相关帖子缩略图插件之间添加一个按钮

> ID：10855258
> 
> 赞同：0
> 
> 时间：2012-06-01T18:07:59.900
> 
> 标签：wordpress

我正在尝试向我的 WordPress 模板添加一个按钮。基本上，我有帖子，然后出现了相关帖子缩略图小部件。我希望按钮在帖子的文本和相关的帖子缩略图小部件之间移动。我的“Single Post”中包含所有这些的代码如下：

```
<div class="post-content">
<?php the_content(__('<em><strong>More:</strong> Read the rest of this entry...</em>', 'life-is-simple')); ?>
</div> 
```

我知道相关帖子缩略图插件属于此代码，因为当我在 Google Chrome 上“检查元素”时它就在那个地方。不过，我找不到如何编辑该 div 中事物的顺序。任何帮助将不胜感激，谢谢！

## 编辑

澄清：我正在使用 Life Is Simple WordPress 主题，尽管它已经进行了相当多的自定义编辑（尽管主要是在 CSS 方面）。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-02T02:10:55.640

该插件可能会将输出附加到`the_content`filter 。这意味着，正在`the_content`自动添加输出。这是一种常见的行为。

您需要查看插件的管理界面，看看是否可以使用模板标签的替代方式（我相信有）。在这种情况下，您应该将模板标签放在 div 之后`the_content()`。

**编辑我：**

经过一个小挖掘， - 事实上有 - 你需要把

```
<?php get_related_posts_thumbnails(); ?> 
```

然后插件应该自己知道不要附加到 the_content。对于参数传递，或者如果某些东西不起作用，请阅读他们的 APi 或帮助文件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-01T20:37:53.187

您可能需要编辑`single.php`或`archive.php`在您的主题中。如果那里没有发生任何看起来熟悉的事情，则可能是在使用循环。在这种情况下，您可能会在 、 中找到您要查找的内容`loop.php`，`loop-single.php`或者`loop-archive.php`取决于您所在的页面类型以及主题的构建方式。在找到的位置附近添加按钮`Read the rest of this entry..`。

有了更多信息（例如您正在使用的主题），您也可以提供更多帮助。

# c# - 带有空行的 RichTextbox 行验证

> ID：10855260
> 
> 赞同：0
> 
> 时间：2012-06-01T18:08:08.627
> 
> 标签：c#, asp.net, .net, richtextbox, rtf

```
Line 1
Line 2
Line 3
Line 4
Line 5
<<Empty line>>
Line 7
Line 8
Line 9
Line 10
<<Empty line>>
<<Empty line>> 
```

我有一个富文本框来显示 10 行，但是数据库中的数据有超过 10 行的 ex。

> 我需要删除大于 10 的空行并保留 10 之间的任何空行吗？

所以预期的结果应该是

```
Line 1
Line 2
Line 3
Line 4
Line 5
<<Empty line>>
Line 7
Line 8
Line 9
Line 10

String.IsNullOrEmpty(RichTextBoxr.Lines[Count]) => This if i use, it detects out the last line(in this example 12) and keeps the 11th empty line, which i don't want. Any help? 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-01T18:41:55.407

在您的查询或 RichTextbox.Text 中应用 TRIM 以消除尾随空格。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-05T20:53:35.477

从技术上讲，没有第 11 行。正在发生的是第十行以换行符结尾。在结果上使用 String.Trim 去掉结尾的换行符。

```
char[] charsToTrim = {'\r', '\n'};
s = s.TrimEnd(charsToTrim); 
```

...或类似的东西。

# jquery - Jquery动画容器水平超过相对定位的页面

> ID：10855263
> 
> 赞同：0
> 
> 时间：2012-06-01T18:08:15.447
> 
> 标签：jquery, html, css, jquery-animate

我在玩一个网站，但遇到了问题。正如您在下面看到的问题是，当我单击其中一个框时，框会通过垂直和水平扩展进行动画处理，并且容器会垂直扩展，但它无法水平扩展。容器相对于其中的内容物定位。我想知道是否有一种简单的方法可以通过其相对定位使其水平扩展，而无需将扩展硬编码到 Jquery 中。谢谢（如果需要，我可以发布代码）

![点击之前](../Images/230bbdbf3d4249c74ec25f6477c763bf.png) ![点击后](../Images/7c04114cf9596159ba9a87968ea07dcb.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-01T19:34:24.453

我想出了我的问题的答案。只需添加：

```
white-space:nowrap; 
```

到父 div 的 css。这允许在水平方向上溢出。请记住，父元素是**相**对于子元素定位的。

# algorithm - 查找字符串中块的语义值所需的提示

> ID：10855272
> 
> 赞同：0
> 
> 时间：2012-06-01T18:09:04.557
> 
> 标签：algorithm

我有一个问题，除了听起来微不足道之外，（对我来说）要找到一个直接的、可扩展的和高性能的解决方案并不简单。我有一个输入文本，网站用户可以在其中搜索位置。

今天位置可以是城市、城市中的地址或城市中的街区，用户必须使用逗号将地址或街区与城市分开，然后我很容易拆分字符串并查找是否第一个块是地址、社区或城市。如果用户未能在输入中填写所有需要的信息，输入一个没有城市的地址，并且我匹配多个具有相同名称的街道，我们将显示所有位置供他选择正确的位置。

使用搜索日志，我们发现大多数用户不使用逗号，即使所有工具提示都指出如何使用位置搜索（谢谢 google :p）。

因此，需要对位置搜索提出新要求，以接受非逗号分隔的地址，例如：

```
1\. "5th Avenue"
2\. "Manhattan"
3\. "New York"
4\. "5th Avenue Manhattan"
5\. "5th Avenue Manhattan New York"
6\. "Manhattan New York"
7\. "5th Avenue New York" 
```

但我找不到找到每个块的含义的方法或动态的方法来完成这项工作。即，如果我得到一个像“New Yok”这样的字符串，“new”可以是一个地址，“york”可以是一个城市。

我的问题是，是否有某种技术或框架来实现我所需要的，或者我需要在算法中以我的方式工作（基于字数、逗号等）来具体做到这一点？

编辑1：

因为我使用 SQL Server，所以我正在考虑全文搜索多列搜索，之前进行完全匹配，之后进行非完全匹配。但我认为一些不完整的地址会返回数千行。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T18:40:18.210

关键不是特异性从左到右递减吗？也就是说，最右边的语义元素（无论是“纽约”还是“曼哈顿”）总是最不具体的（如果它是自治市镇，那么我们不必担心城市，如果它是街道，我们不必担心不必担心自治市镇等）

因此，反转标记并递归，寻找一个完整的命中（“Manhattan”）或一个关键字（“Avenue”、“Street”、“New”）来指示语义元素的开始或结束。因此，通过后，您可能会：

```
"5th Avenue" -> TOKEN STREET_END_TOKEN
"Manhattan" -> BOROUGH
"New York" -> COMPOUND_BEGIN_TOKEN TOKEN
"5th Avenue Manhattan" -> TOKEN STREET_END_TOKEN BOROUGH
"5th Avenue Manhattan New York" -> TOKEN STREET_END_TOKEN BOROUGH COMPOUND_BEGIN_TOKEN TOKEN
"Manhattan New York" -> BOROUGH COMPOUND_BEGIN_TOKEN TOKEN
"5th Avenue New York" -> TOKEN STREET_END_TOKEN COMPOUND_BEGIN_TOKEN TOKEN 
```

这应该给你足够的模式匹配。

更新：

好的，扩展一般策略：

```
Step 1 : Generate a pattern of the query structure by identifying keywords ("Manhattan"), and semantically-meaningful ("Street", "Avenue") or grammatically-significant ("New", "Saint") tokens. 
Step 2: Match the generated pattern against a set of templates -- "* BOROUGH *" -> (Street) (BOROUGH) (City)", "* STREET_END_TOKEN" -> (Street name) (Street type), etc.  
Step 3: The result of Step 2 ought to give you a sense of what kind of query you're dealing with. You'll have to apply domain rules at that point (if you know the complete query is TOKEN STREET_END_TOKEN then you know "Well, this is a query that just specifies a street" and you have to apply whatever rule is appropriate (grab the locale of their browser? Use their query history to guess which neighborhood and city? etc.) 
```

# asp.net - 从 gmail 获取联系人

> ID：10855274
> 
> 赞同：0
> 
> 时间：2012-06-01T18:09:14.703
> 
> 标签：asp.net, gmail

我正在使用 Google Data API 从 gmail 中检索联系人。我使用了以下代码：

```
string token = Request.QueryString["token"];
            RequestSettings rs = new RequestSettings("myapp", token);
            rs.AutoPaging = true;
            List<string> lstEmails = new List<string>();
            try
            {
            rs.AutoPaging = true;
            ContactsRequest cr = new ContactsRequest(rs);
            Feed<Contact> f = cr.GetContacts();
            foreach (Contact e in f.Entries)
            {
                foreach (EMail email in e.Emails)
                {
                    lstEmails.Add(email.Address);
                }
            }
            }
            catch
            {

            } 
```

但它仅读取 25 个 gmail 联系人，并引发以下错误：

```
Execution Failed: {https://www.google.com/m8/feeds/contacts/{email}/full?start-index=26&max-results=25} 
```

但我想从 gmail 获得总联系人。

# css - 用于定位的 CSS 简写

> ID：10855276
> 
> 赞同：66
> 
> 时间：2012-06-01T18:09:20.153
> 
> 标签：css, css-position

`top` `right` `bottom` `left`或`width`和有任何简写`height`吗？

我有很多这样的CSS

```
#topDiv {
    position:absolute;
    top:0px;
    left:0px;
    right:0px;
    height:100px;
}
#centerDiv {
    position:absolute;
    top:100px;
    bottom:120px;
    left:0px;
    right:0px;
}
#consoleDiv {
    position:absolute;
    left:0px;
    right:0px;
    bottom:0px;
    height:120px;
} 
```

我想做这样的事情

```
position: absolute 10px 50px 50px 100px; 
```

或者

```
size: 400px 200px; 
```

* * *

## 回答 #1

> 赞同：55
> 
> 时间：2012-06-01T18:11:15.130

**2021 年更新**：该[`inset`物业](https://developer.mozilla.org/en-US/docs/Web/CSS/inset)目前正在获得采用。此属性使用与速记属性相同的多值语法`margin`。有关浏览器兼容性，请参阅[MDN](https://developer.mozilla.org/en-US/docs/Web/CSS/inset#browser_compatibility)。

* * *

不存在将所有这些值组合起来的简写形式。这些都是*不同*的属性，不像，例如`background`，它具有颜色、图像、位置和重复指令，因此*可以*合并成一个速记形式。

如果你真的想要这种类型的控件，你可以使用类似 SASS 的东西并创建一个[mixin](http://sass-lang.com/docs/yardoc/file.SASS_REFERENCE.html#mixins)。

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2017-09-14T15:43:42.977

我刚找到这个，正在寻找相同的东西，我最终使用 sass 作为顶部、底部、左侧、右侧

这是我的解决方案

```
@mixin position($top, $right: $top, $bottom: $top, $left: $right) {
    top: $top;
    right: $right;
    bottom: $bottom;
    left: $left;
 } 
```

像大多数 CSS 速记一样工作

`@include position(5) // all 4`

`@include position(5,4) // vertical, horizontal`

`@include position(5,4,3) // top, horizontal, bottom`

`@include position(5,4,3,2) // top, right, bottom, left`

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2012-06-01T18:23:18.610

答案是否定的，因为它们是不同的属性，所以不能组合。但是，您可以稍微巩固您的 CSS，而不是重复某些属性，例如：

```
#topDiv,
#centerDiv,
#consoleDiv {
    position:absolute;
    left:0;
    right:0;
}
#topDiv {
    top:0;
    height:100px;
}
#centerDiv {
    top:100px;
    bottom:120px;
}
#consoleDiv {
    bottom:0;
    height:120px;
} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2020-04-15T14:21:11.867

`inset`是你在 2020 年可以使用的定位速记，但你需要使用 PostCSS 和这个插件[https://github.com/jonathantneal/postcss-inset](https://github.com/jonathantneal/postcss-inset)

例子：

```
.example {
  inset: 10px 20px 80px;
}

/* becomes */

.example {
  top: 10px;
  right: 20px;
  bottom: 80px;
  left: 20px;
} 
```

更多信息和规格在这里： [https ://www.w3.org/TR/css-logical-1/#propdef-inset](https://www.w3.org/TR/css-logical-1/#propdef-inset)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2022-01-15T08:10:20.520

你可以使用**插图：右上角左下角；**.

```
#topDiv {
    position: absolute;
    inset: 0;
    min-height: 100px;
}

#centerDiv {
    position: absolute;
    inset: 100px 0 120px;
}

#consoleDiv {
    position: absolute;
    inset: auto 0 0 0;
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-06-10T19:22:34.623

如果你想要这个的简写，你需要用 Sass 制作所谓的 mixin。不知道是什么？查一下！

```
@mixin position($position, $args) {
  @each $o in top right bottom left {
        $i: index($args, $o);

    @if $i and $i + 1< = length($args) and type-of(nth($args, $i + 1)) == number  {
          #{$o}: nth($args, $i + 1);
    }
  }

  position: $position;
}

@mixin absolute($args) {
        @include position("absolute", $args);
}

@mixin fixed($args) {
        @include position("fixed", $args);
}

@mixin relative($args) {
        @include position("relative", $args);
} 
```

这是一个解释它的链接：

[http://hugogiraudel.com/2013/08/05/offsets-sass-mixin/](http://hugogiraudel.com/2013/08/05/offsets-sass-mixin/)

# perl - 查找目录树中最新的 500 个文件的命令，并且符合 POSIX

> ID：10855282
> 
> 赞同：1
> 
> 时间：2012-06-01T18:09:39.297
> 
> 标签：perl, shell, unix, xargs

我正在寻找单行 shell 脚本或 unix 命令来在目录树中查找最新的 500 个文件。主要限制是它应该符合 POSIX 并且目录可以包含大量文件。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-04T13:27:49.773

我从下面的链接中找到了一个 perl 脚本，它有帮助：

```
find . -type f -print | perl -l -ne ' $_{$_} = -M; END {  $,="\n";   print sort {$_{$b} <=> $_{$a}} keys %_   }' | head -n 500 
```

[如何递归查找并列出具有子目录和时间的目录中的最新修改文件？](https://stackoverflow.com/questions/5566310/how-to-recursively-find-and-list-the-latest-modified-files-in-a-directory-with-s)

欢迎更多评论。谢谢大家。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-01T18:17:14.730

这个怎么样：

[Posix ls](http://pubs.opengroup.org/onlinepubs/000095399/utilities/ls.html)和[head](http://www.unix.com/man-page/POSIX/1/head/)

```
ls -tc DIR | head -n 500 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-13T20:23:06.937

> 寻找 。-type f -print | perl -l -ne ' $ *{$* } = -M; END { $,="\n"; 打印排序 {$ *{$b} <=> $* {$a}} 键 %_ }' | 头-n 500

*对于排序 $ {$a} <=> $* {$b}应该是相反的

头部可以避开：print+(...)[0..499]

递归调用也可以找到：

```
perl -e 'sub R{($_)=@_;map{-d$_?&R($_):$_}<$_/*>}print$_,$/for(sort{-M$a<=>-M$b}R".")[0..499]' 
```

或者使用 unix cmd：不确定是否有很多参数可能会失败

```
find . -type f -exec ls -1t {} + | head -500
find . -type f -print0 | xargs -0 ls -1t | head -500 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-01T18:49:26.937

```
find . -type f -exec stat -c %Y:%n {} \; |
  sort -rn | sed -e 's/.*://' -e 500q 
```

这对 ctime 进行排序，可以通过使用`%Z`或`%X`在格式字符串中进行更改，但`stat`不是 POSIX。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-04T08:21:58.930

使用 shell 脚本没有 100% 可靠的 POSIX 方法。

一个 POSIX C 程序会很容易做到这一点，假设您通过最后修改的文件内容或最后更改的文件定义最新的。如果您指的是上次创建时间，则没有 POSIX 方式，也可能根本没有解决方案，具体取决于所使用的文件系统。

# mysql - 数据库应用和远程MySql

> ID：10855284
> 
> 赞同：0
> 
> 时间：2012-06-01T18:09:42.947
> 
> 标签：mysql, database, software-design

我想创建一个桌面应用程序，它应该处理远程机器上运行的 mySql 服务器上的数据。所以每个用户都有一个桌面应用程序的副本，并在远程 mySql 服务器上编辑数据。

现在我的问题是 mySql 服务器不允许来自其他主机的连接。问题，这只是创建应用程序的错误方式。如果不是，我如何让任何主机访问 MYsql 服务器。（我知道我可以打开一个特定的 IP 但这不起作用，因为该应用程序可以在任何地方运行）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T18:17:11.267

您应该在服务器上使用一个瘦服务层将您的数据库放在前面，您可以在其中对数据进行一些验证/处理，执行身份验证等。然后您的客户端应用程序会将您的服务层中的这些方法公开为 Web 服务，您的客户端应用程序将使用 SOAP/XML、REST/JSON 等进行通信。通常，如果您的应用程序位于 LAN 内，则直接公开您的数据库是一个坏主意，而在 Internet 上公开它是一个糟糕的主意。

# jquery - 循环内的jquery函数不迭代

> ID：10855285
> 
> 赞同：2
> 
> 时间：2012-06-01T18:09:45.757
> 
> 标签：jquery, iteration

我的代码有问题，该`title`属性仅显示`16`而不是显示从`1`through的所有值`15`。为什么会这样，任何人都可以建议我做错了什么？？？

**我的代码**

```
 x=1;
 while(x <= 15)
 {
     $("td#id"+x).mouseover(function(x){
     $(this).attr('title', x)           
   });
   x++;
} 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-06-01T18:13:22.307

这是**非常常见**的“在回调中使用循环变量”问题。

当您使用 jQuery 时，最简单的修复是`data`处理程序的参数：

```
 var x=1;
 while (x <= 15) {
     $("td#id"+x).mouseover({ x: x }, function(ev) {
         this.title = ev.data.x;        
     });
     x++;
 } 
```

也就是说，你为什么只在一个`mouseover`函数中设置它？标题应该直接添加到元素中，只需一次：

```
for (var x = 1; x <= 15; ++x) {
    document.getElementById('id' + x).title = x;
} 
```

在`mouseover`处理程序中执行此操作实际上不会破坏任何内容，但这意味着您已经注册了一个事件处理程序，每次您从一个单元格移动到另一个单元格时都会一遍又一遍地调用（并更新 DOM）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-01T18:13:17.930

您作为事件处理程序提供给 jquery 的函数保留了一个指向定义它的外部块及其（活动）变量的指针。这就是闭包的工作原理。

所以当它被执行时，x 是 15。

我知道大多数 javascript 开发人员不知道它是如何工作的，但这是一件非常有趣的事情：http: [//jibbering.com/faq/notes/closures/](http://jibbering.com/faq/notes/closures/)

编辑：我不会在这里添加我打算添加的通常修复，因为 Alnitak 在我面前指出，回调实际上在这种情况下完全没用；）

# c++ - 如果我只想要架构良好的工作区但不一定要单独编译，如何在 C++ 中组织头文件/代码文件？

> ID：10855287
> 
> 赞同：1
> 
> 时间：2012-06-01T18:09:54.857
> 
> 标签：c++, header, dependencies, workspace, organization

我开始在一个 cpp 文件中编写我的程序，但现在我的代码太多了，所以我决定将它分开。但问题是我有很多常量，包括和其他一些我想在一个地方拥有的东西。不幸的是，代码的依赖部分都需要它们，所以我不能用通常的包含文件来做到这一点。

对我有什么帮助？

（我在Linux下编写并用命令行编译）

（对不起我的英语不好 ：））

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-01T22:25:36.080

正如Hristo所说，您通常应该将定义写在头文件中，并将实现写在源代码文件中。

但是，要回答您的问题：

> 但问题是我有很多常量，包括和其他一些我想在一个地方拥有的东西。

我通常所做的是创建一个名为“common.h”或“defs.h”之类的文件（我从 Doom 中获得了这个想法......），并且该文件有许多定义，你发现你在整个过程中都需要这些定义程序。如果您使用常量，请在头文件中声明常量，如下所示：

```
 extern const int MAX_SOMETHING;
    extern const bool TRUTH_VALUE; 
```

并制作定义这些常量的补充源文件（defs.cpp 或 common.cpp）：

```
 const int MAX_SOMETHING = 5;
    const bool TRUTH_VALUE = true; 
```

所以现在当您在其他源文件中包含 common/defs.h 时，extern 关键字将告诉该源文件该定义在另一个源文件中（它在 common/defs.cpp 中）所以它会在那里找到定义，并且您可以在包含 common/defs.cpp 的任何地方使用它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-01T18:31:31.180

在大多数项目中，定义在头文件中，实现在源代码文件中。但是模板函数的实现必须在头文件中，因为它们必须对所有使用它们的源文件可见。变量应该在头文件中定义*外部*并在源文件中声明。常量也可以在头文件*static*中声明。

例子：

Foo.h

```
#pragma once
class Foo{
    public:
        void bar();
        template<class Type>
        void increment(Type &a){
            ++a;
            return;
        }
};
extern Foo theFoo;
static const int five=5; 
```

Foo.cpp

```
#include "Foo.h"
#include <iostream>
void Foo::bar(){
    std::cout<<"Foo::bar called"<<std::endl;
    return;
}
Foo theFoo; 
```

主文件

```
#include "Foo.h"
#include <iostream>
int main(){
    theFoo.bar();
    std::cout<<five<<std::endl;
    return 0;
} 
```

# java - javax.el.PropertyNotFoundException：在类型 java.lang.String 上找不到属性“tname”

> ID：10855288
> 
> 赞同：2
> 
> 时间：2012-06-01T18:09:59.717
> 
> 标签：java, jsp, struts, jstl, el

我之前使用的是 scriptlet，但现在我切换到了 mvc。我无法在 JSP 页面上检索值并出现错误：

```
javax.el.PropertyNotFoundException: Property 'tname' not found on type java.lang.String 
```

豆子代码：

```
public class regForm extends org.apache.struts.validator.ValidatorForm implements Iprafunctions {

    private String tname = null;
    private String tfee = null;

    public String getTfee() {
        return tfee;
    }

    public void setTfee(String tfee) {
        this.tfee = tfee;
    }

    public String getTname() {
        return tname;
    }

    public void setTname(String tname) {
        this.tname = tname;
    }
    public regForm() {
        super();
    }
} 
```

动作控制器：

```
public ActionForward mvc(ActionMapping mapping, ActionForm form,
        HttpServletRequest request, HttpServletResponse response)
        throws Exception {
    regForm reg = (regForm) form;
    String sql = "Select tname,tfee from addtest order by tname";
    ResultSet rs = SQLC.getData(sql, null);
    Collection myBeans = new ArrayList();
    while (rs.next()) {
        String testname = rs.getString("tname");
        String testfee = rs.getString("tfee");
        reg.setTname(testname);
        reg.setTfee(testfee);
        myBeans.add(reg.getTname());
        myBeans.add(reg.getTfee());
    }
    request.setAttribute("myBeans", myBeans);
    return mapping.findForward(SUCCESS);
} 
```

JSP 页面中的访问

```
<%@ taglib prefix="c" uri="http://java.sun.com/jsp/jstl/core" %>
<table>
    <tr><td>Name</td><td>Fee</td></tr>
    <c:forEach var="reg" items="${myBeans}">
        <tr>
            <td><c:out value="${reg.tname}"></c:out></td>
            <td><c:out value="${reg.tfee}"></c:out></td>
        </tr>
    </c:forEach>
</table> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-01T18:16:14.290

实际上，您正在添加字符串`Collection`并且您正在尝试调用

`getTName()` 经过`${reg.tname}`

要么将整个 bean 添加到您的集合中，要么将 JSTL 替换为`${reg}`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-01T18:18:51.903

我认为您将名称和费用直接添加到数组列表中，但您应该将整个`regForm`对象添加到数组列表中。

而不是下面的代码

```
myBeans.add(reg.getTname());
myBeans.add(reg.getTfee()); 
```

你需要这样做

```
myBeans.add(reg); 
```

此外，不要使用从表单中获得的相同对象。尝试创建新对象并添加到数组列表中并尝试使用泛型。

**编辑：**

```
while (rs.next()) {
        String testname = rs.getString("tname");
        String testfee = rs.getString("tfee");
        regForm beanObject = new regForm();
        beanObject.setTname(testname);
        beanObject.setTfee(testfee);
        myBeans.add(beanObject);
    } 
```

# c# - 哪个 Windows 服务可确保网络连接？

> ID：10855290
> 
> 赞同：18
> 
> 时间：2012-06-01T18:10:02.790
> 
> 标签：c#, windows-services

我正在做一个 Windows 服务，它在启动时必须具有网络连接。代码在 c# 中，我将服务设置为依赖于其他人

```
serviceInstaller.ServicesDependedOn = new string[] { "Tcpip" }; 
```

我可以看到在 Windows 服务管理器上正确输入了依赖项，但是在重新启动后，我的服务无法启动，因为它无法连接到网络，在主机获得 IP 后，服务正确启动。

我尝试使用“Tcpip”和“Dhcp”服务。它应该依赖于哪个服务？

服务需要网络连接，因为它的目的是通过 ssh 挂载一个单元

谢谢！

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-06-01T20:30:22.770

我们一直在使依赖于网络的服务开始启动，依赖于“服务器”服务。它的实际名称是“LanmanServer”。这对我们来说工作正常。如果你看它的描述，它会说：

> 支持此计算机通过网络共享文件、打印和命名管道。如果此服务停止，这些功能将不可用。如果禁用此服务，任何显式依赖它的服务都将无法启动。

我们的想法是，如果计算机已准备好执行这些功能，则必须启动网络。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-11-08T11:47:43.777

我使用“Tcpip”、“Dhcp”、“Dnscache”。对我来说没问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2022-01-08T13:14:01.850

取决于`LanmanServer`接受的答案中提到的 @user957902 在 Windows Server 2019 上不起作用（嗯，至少对我和其他一些人来说）。

在 Windows Server 2019 中，我认为无法使用服务依赖项解决此问题。

我在我的 Windows 服务中解决了这个问题，方法是等待 Internet 连接建立，使用以下代码（只需调用该`WaitUntilInternetConnectionAvailable`方法）：

```
public static class WinINet
{
    [DllImport("wininet.dll")]
    public static extern bool InternetGetConnectedState(out int description, int reservedValue);
}

...

public static bool WaitUntilInternetConnectionAvailable(TimeSpan timeout, TimeSpan checkEvery)
{
    var sw = Stopwatch.StartNew();
    while (sw.Elapsed < timeout)
    {
        if (IsInternetConnectionAvailable())
        {
            return true;
        }

        Thread.Sleep(checkEvery);
    }

    return false;
}

public static bool IsInternetConnectionAvailable()
{
    return WinINet.InternetGetConnectedState(out _, 0);
} 
```

# regex - 在 VI 中搜索和替换正则表达式，需要说明

> ID：10855294
> 
> 赞同：3
> 
> 时间：2012-06-01T18:10:31.457
> 
> 标签：regex, vi

鉴于以下情况，我想评论以 1 或 2 或 3 开头的行

```
Some text
1 101 12
1 102 13
2 200 2
// Some comments inside
2 202 4
2 201 7
3 300 0
3 301 7
Some other text 
```

以下正则表达式（似乎）看起来正确，但它不起作用..

```
%s/^([123])(.+)/#\1\2/g 
```

egrep 使用相同的正则表达式匹配

```
egrep '^([123])(.+)' file_name 
```

请帮助我了解为什么此搜索和替换在 VI 中失败

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-01T18:18:01.763

您需要转义字符：`()+`. 所以你可以这样做`%s/^\([123]\)\(.\+\)/#\1\2/g`，但似乎更容易做到：`:g/^[123]/s/^/#`

请注意，vi 确实具有用于更改模式中符号含义的各种选项 ( `help magic`)。特别是，您可以使用 'very magic' 并执行以下操作：（`:%s/\v^([123].+)/#\1/g`请注意，该`g`标志在这里完全是多余的！）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-01T18:22:21.297

在 Perl 中，

```
my $t = "Some text
1 101 12
1 102 13
2 200 2
2 202 4
2 201 7
3 300 0
3 301 7
Some other text";

foreach (split /^/, $t) {
  $_ =~ s/^([1-3])/# $1/;
  print $_;
} 
```

结果：

```
Some text
# 1 101 12
# 1 102 13
# 2 200 2
# 2 202 4
# 2 201 7
# 3 300 0
# 3 301 7
Some other text 
```

# assembly - 组装测试后的JL

> ID：10855296
> 
> 赞同：4
> 
> 时间：2012-06-01T18:10:32.940
> 
> 标签：assembly

我看到以下代码 -

```
add    $0x14,%esp
mov    %eax,%ebx
test   %ebx,%ebx
jl     80590d7 <XXXX+0xbc7> 
```

我对理解上述代码感到困惑。如果我们有像 test %ebx 这样的指令，%ebx 应该总是相等的吗？

此外，我在 GDB 中运行，以下是信息寄存器的输出 -

```
(gdb) info registers
eax            0x0      0
ecx            0x189f   6303
edx            0x6      6
ebx            0x442ff4 4468724
esp            0xffbde13c       0xffbde13c
ebp            0xffbde4c8       0xffbde4c8
esi            0x1d5c4d50       492588368
edi            0x444140 4473152
eip            0x80590dd        0x80590dd
eflags         0x296    [ PF AF SF IF ]
cs             0x23     35
ss             0x2b     43
ds             0x2b     43
es             0x2b     43
fs             0x0      0
gs             0x63     99 
```

有人可以解释一下这是如何工作的吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-01T18:23:50.920

这是测试标志标志的一种奇怪方式。JL 指令旨在测试（减法）CMP 指令是否导致负值。

但是，如果结果设置了符号位，则 TEST 指令似乎也设置了 SF 标志。

[http://en.wikipedia.org/wiki/TEST_(x86_instruction)](http://en.wikipedia.org/wiki/TEST_%28x86_instruction%29)

# wpf - 隐藏 TextBlock.Inlines

> ID：10855299
> 
> 赞同：0
> 
> 时间：2012-06-01T18:10:47.420
> 
> 标签：wpf

有没有办法在 TextBlock 中隐藏内联文本？

```
<TextBlock.Inlines>
   <Run Text="A" />
   <Run Text="B" />
   <Run Text="" />
   <Run Text="C" />
</TextBlock.Inlines> 
```

即使 B 和 C 字母之间没有文字，它也会占据一些我不想要的地方。我想隐藏这个内联。我怎样才能做到这一点？

有没有其他方法可以在一行中组合多个文本样式？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-01T18:20:46.207

结果不是因为额外的`Run`. 这只是因为您在 XAML 中有空格。这样做应该可以解决它：

```
<TextBlock.Inlines>
   <Run Text="A" /><Run Text="B" /><Run Text="" /><Run Text="C" />
</TextBlock.Inlines> 
```

来源：[http ://social.msdn.microsoft.com/Forums/en/wpf/thread/5f37aa29-3dc6-44db-9784-197f221f80f7](http://social.msdn.microsoft.com/Forums/en/wpf/thread/5f37aa29-3dc6-44db-9784-197f221f80f7)

# javascript - 自定义 JavaScript 在 WordPress 中创建随机字符

> ID：10855304
> 
> 赞同：0
> 
> 时间：2012-06-01T18:11:22.160
> 
> 标签：javascript, jquery, wordpress

我正在解决客户遇到的问题，他们使用的 javascript 导致`/*`并`/*]]>*/`显示在登录工具提示上。我一直在寻找原因，我对此感到困惑。我所知道的是，它是由[This Page](http://www.apistudyabroad.com)的 JavaScript 以某种方式生成的。

该插件正在使用此模板，其中没有任何这些字符：

```
<script type="text/template" id="api-login-btn-template">
    <div id="api-signin">
        <label for="api-signin-login">Login : </label><input type="text" id="api-signin-login" name="email" value="" title="e-mail address"/>
        <label for="api-signin-pass">Password : </label><input type="password" id="api-signin-pass" name="password" value="" title="password"/>
        <div class="sign-in-errors"></div>
        <br/>
        <button class="sign-in-btn"><span>Sign In</span> <span class="blue">&#x25B6;</span></button>
    </div>
    <div id="api-signout" style="display:none">
        <p><a href="/program-finder/favorites/">My Favorite Programs <span  class="ltblue_link">&#x25B6;</span></a></p>
        <p>Application: <a id="api-app-status" href="https://secure.apistudyabroad.com/forms"></a></p>
        <button class="sign-out-btn"><span>Sign Out</span></button>
    </div>
</script> 
```

负责此功能的 javascript 文件[在此处](http://www.apistudyabroad.com/wp-content/plugins/api_js/js/api.js)。我相信弹出窗口从第 400 行开始`$('.pane-container').each(function() {`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T19:41:44.657

这是您的模板在生成的页面上的样子（在 Firefox 中查看源代码）：

```
<script type="text/template" id="find-a-program-template">
/*<![CDATA[*/<div style="padding:20px;"><h2> 
...
...
...<div class="clear"></div></div>/*]]>*/
</script> 
```

似乎 PHP / WordPress 在页面渲染期间将该 CDATA 部分添加到模板中，但 jQuery 插件不知道如何忽略它并将其写下来。

顺便说一句，您在页面上还有一堆服务器端`<?php the_time('m') ?>`调用，但这可能无关紧要。

# regex - 正则表达式查找/替换

> ID：10855306
> 
> 赞同：1
> 
> 时间：2012-06-01T18:11:32.563
> 
> 标签：regex, eclipse, replace

我正在尝试对 java 源文件进行一些查找和替换。

目前，我的类具有以下形式的无效名称（从自动命名不佳的工具导入）：

```
public class [0-9]{2}[A-Za-z]+ 
```

我想在数字周围插入下划线，从而生成表单的有效类名

```
public class [_][0-9]{2}[_][A-Za-z]+ 
```

但是，使用 Eclipses 查找和替换工具，使用正则表达式框检查查找和替换字符串不会像我想要的那样格式化输出。

它需要

```
02ListOfValidAppIDs 
```

并使它

```
[-][0-9]{2}[_][A-Za-z]+ 
```

代替

```
_02_ListOfValidAppIDs 
```

如何让正则表达式保留任意数字和文本并将它们插入替换字符串？

（编辑：作为说明，通过预览功能，我可以看到 eclipse 正确地找到了我希望替换的所有名称，仅此而已）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-01T18:20:20.637

我不确定您需要的 Regex 的确切风格，但是这样的事情应该可以让您朝着正确的方向开始。

更新您的“查找”模式以使用捕获组：

```
(public class )([0-9]{2})([A-Za-z]+) 
```

然后在替换中引用这些捕获：

```
\1_\2_\3 
```

注意：一些正则表达式将使用`{}`代替`()`来表示捕获的组，一些风格将使用`$1`, `$2`,`$3`等作为参考而不是使用`\#`.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-01T18:31:52.360

在 Eclipse 的 Find/Replace 对话框中，如果您使用

```
([0-9]+)([A-Za-z]+) 
```

在`Find`盒子里和

```
_$1_$2 
```

在`Replace with`盒子里。

当然，`Regular expressions`也必须选中该框。

# java - 黑莓中 AutoCompleteField 上的占位符文本

> ID：10855309
> 
> 赞同：1
> 
> 时间：2012-06-01T18:11:43.587
> 
> 标签：java, blackberry, autocomplete

我在黑莓应用程序的一个屏幕中放置了`AutoCompleteField`一个。我必须显示一个占位符文本来为用户输入信息提供提示。

这是下面的代码`AutoCompleteField`

```
BasicFilteredList filterList = new BasicFilteredList();
        String[] address = { "T 115 Centro Galleria Shopping Centre, Cnr Old Collier and Walters Road Morley WA 1522", 
                "1423 SEAVIEW POINT POINT COOK VIC 2674",
                "Lot 1498 Yarraman Road Wyndham Vale VIC 3795", 
                "Lot 3506 Witchmount Close Hillside VIC 4055",
                "6 Paas Place Williamstown VIC 4233", 
                "Lot 99 14 James Close Sunbury VIC 4502", 
                "1 Charlotte Street Clayton South VIC 4779" };

        filterList.addDataSet(1, address, "address", BasicFilteredList.COMPARISON_IGNORE_CASE);
        AutoCompleteField autoCompleteField = new AutoCompleteField(filterList){
            public void onSelect(Object selection, int SELECT_TRACKWHEEL_CLICK) {
                 ListField _list = getListField();
                 if (_list.getSelectedIndex() > -1) {
                     if(selectedText!=null){
                         BasicFilteredListResult result = (BasicFilteredListResult) selection;
                         selectedText.setText(result._object.toString());
                     }
                 }
             }
        };
        add(autoCompleteField); 
```

任何人，请建议我如何实现相同的。

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-03T03:01:07.890

[您可以使用与此处显示的普通 EditFields](https://stackoverflow.com/a/7414401/119114)类似的技术。基本上，您需要覆盖子类`paint()`中的方法`AutoCompleteField`。在`paint()`中，您检查并查看该字段是否为空，如果是，则手动绘制所需的*占位符*文本。

不同之处在于它`AutoCompleteField`是`Manager`一个`BasicEditField`内部。因此，要正确绘制文本，您需要计算出父级`Manager`（`AutoCompleteField`）中编辑字段的 x 和 y 偏移量。

因此，将您`AutoCompleteField`的实例替换为此类的实例：

```
 private class CustomAutoCompleteField extends AutoCompleteField {
      private int yOffset = 0;
      private int xOffset = 0;

      public CustomAutoCompleteField(BasicFilteredList filteredList) {
         super(filteredList);
      }

      protected void paint(Graphics g) {
         super.paint(g);
         if (xOffset == 0) {
            // initialize text offsets once
            xOffset = getEditField().getContentLeft();
            yOffset = getEditField().getContentTop();
         }
         String text = getEditField().getText();
         if (text == null || text.length() == 0) {
            int oldColor = g.getColor();
            g.setColor(Color.GRAY);
            g.drawText("enter text", xOffset, yOffset);
            g.setColor(oldColor);
         }
      }

      public void onSelect(Object selection, int SELECT_TRACKWHEEL_CLICK) {
         ListField _list = getListField();
         if (_list.getSelectedIndex() > -1) {
            if(selectedText!=null){
               BasicFilteredListResult result = (BasicFilteredListResult) selection;
               selectedText.setText(result._object.toString());
            }
         }
      }
   } 
```

我在 OS 5.0 上测试了这个，实例没有设置任何边距或填充。对于不同的布局，您可能需要调整计算 x 和 y 偏移的逻辑。但是，上面的代码向您展示了基本思想。祝你好运。

**编辑：**上面的代码提出了一个警告，即您的`onSelect()`方法显然依赖于未显示的代码。照原样，上面的代码不会编译。我`onSelect()`留在那里只是为了表明我实际上只是替换了您最初拥有的匿名类，并且没有在您的`onSelect()`方法中做任何不同的事情，因为它与占位符文本问题没有直接关系。

# transactions - Jboss 7.1.1 事务，级联 EJB 方法

> ID：10855310
> 
> 赞同：4
> 
> 时间：2012-06-01T18:11:46.647
> 
> 标签：transactions, jboss7.x, ejb-3.1

我有两个无状态的 SessionBean。我的客户端（JSF2 应用程序）正在第一个 EJB (CompletionFacade) 上调用方法 (saveOrderCompletion)，该方法在第二个 EJB (ContactFacade) 上调用另一个方法 (processRequest) 以通过 JMS 向队列发送消息。

在第一个调用方法结束时，我抛出了一个 RuntimException 来查看 JBoss 的行为。这应该全部在一个事务中运行，因此事务应该进行回滚，这样就不应该将消息发送到队列。

我在 weblogic 服务器上仔细检查了这个，它准确地显示了预期的行为。我的问题是为什么 JBoss 不回滚整个事务？我错过了什么...

实体没有被持久化，但无论如何都会将消息发送到队列。

我正在使用 jboss 7.1.1，应用程序部署为 EAR

这是我的会话 bean...

```
/**
* Session Bean implementation class CompletionFacade
*/
@Stateless
public class CompletionFacade implements CompletionFacadeRemote, CompletionFacadeLocal {

    @PersistenceContext(unitName="my_test")
    private EntityManager entityManager;

    @EJB
    ContactFacadeLocal contactFacade;

    .....

    @Override
    @TransactionAttribute(TransactionAttributeType.REQUIRED)
    public OrderCompletion saveOrderCompletion(OrderCompletion orderCompletion) throws TestBusinessException {
        try {

            ...do some stuff on entity

            //persist to get id
            entityManager.persist(orderCompletion);

            //finally send email
            contactFacade.processRequest(orderCompletion,partner);

            if (0 == 0)
                throw new RuntimeException("Test RuntimeException ");

        } catch (TestGenericException re) {
            throw new TestBusinessException("Could not print orderCompletion: " ,re);
        } catch (DocumentException e) {
            throw new TestBusinessException("Could not print orderCompletion: " ,e);
        }

        return orderCompletion;
    }
} 
```

和第二个门面：

```
@Stateless
public class ContactFacade implements ContactFacadeRemote, ContactFacadeLocal {

....

    /*
     * actually create message
     */
    @TransactionAttribute(TransactionAttributeType.REQUIRED)
    public void processRequest(Object request, SmtpPartner partner) throws TestGenericException {

        if (logger.isDebugEnabled()) {
            logger.debug("Starting to process request!");
        }

        QueueConnection connection = null;
        QueueSession session = null;

        try {

         ...lookup queue etc...

             sender.send(QUEUE, objectMessage);

        } catch (JMSException e) {
            logger.error("MS Exception:", e);
        } catch (NamingException e) {
            logger.error("Naming exception:", e);
        } ...
        } finally {
            try {
                session.close();
                connection.close();
            } catch (JMSException e) {
                logger.error("Error closing connection:", e);
            }

        }
    }

...
} 
```

非常感谢任何帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-02T19:27:25.447

你漏掉了最重要的部分；您从中获取连接的 JMS 连接工厂以及获取该工厂的方式。

确保你注入了这个工厂，并且你使用了一个事务性的。在 JBoss AS 6 中，java:/JmsXA 是事务性的，而 java:/ConnectionFactory 是非托管/非事务性的替代方案。检查您是否使用了正确的 AS 7。

# javascript - 使用 ajax 在加载页面中运行 javascript

> ID：10855311
> 
> 赞同：0
> 
> 时间：2012-06-01T18:11:50.587
> 
> 标签：javascript, jquery, ajax

我在另一个线程中读到，我将能够将 javascript 代码放在页面 y 中，并且在加载 ajax 时它将在页面 x 中工作。我没有收到错误，但它也没有工作。

[在加载了 jQuery Ajax 的页面中运行 javascript](https://stackoverflow.com/questions/10627180/running-javascript-in-page-that-is-loaded-with-jquery-ajax)

```
 $(function CheckinMap() {
        $.ajax({
            dataType: "html",
            url: "content/home/index.cs.asp?Process=ViewCheckinMap",
            success: function(data) {
                //$("#friends").html(data);
                $("#checkinmap").append(data);

            },
            error: function (data) {
                $("#checkinmap").append(data);
            }
        });
    }); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-01T18:14:33.573

您正在寻找的是[`.load()`](http://api.jquery.com/load/). 这将加载所有 JS，而不是将其作为死文本添加到页面中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-01T18:16:04.977

您可以使用 getScript API：[http ://api.jquery.com/jQuery.getScript/](http://api.jquery.com/jQuery.getScript/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-01T18:18:55.713

在您通过 AJAX 注入的内容中，您可以执行匿名函数调用，使其在添加到 DOM 后执行

```
<script language="javascript">

(function doStuff(){ alert('hello, I was injected'); })();

</script> 
```

这在过去对我有用....

# android - 在 android 应用程序包中包含图像的最佳方法

> ID：10855314
> 
> 赞同：1
> 
> 时间：2012-06-01T18:11:54.670
> 
> 标签：android

我正在为 android 开发一个应用程序，该应用程序显示了狂欢节的活动列表。我希望应用程序具有每个活动的图像，以避免用户在运行应用程序时必须下载它，并改善用户对应用程序的体验。

为此，我已将每个活动的图像添加为资源，但我不知道这是否是最好的方法。Resource 有一些我不喜欢的限制，例如您不能在可绘制文件夹中创建子文件夹来组织图像，唯一接受作为资源名称的字符是 [a-zA-Z0-9_] 等。 ...

有什么好的方法吗？或者如果我想避免用户必须下载图像，我必须使用资源。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T18:26:09.070

android 系统旨在将所有可绘制项目（又名图像）放在资源文件夹中。如果您希望图像与您的应用程序一起打包（而不是事后下载），则需要将它们包含在 res/drawable 中

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-01T18:46:57.093

下载图像总是更好，但如果您的要求是应用程序应该事先拥有所有图片，那么您可以使用“资产”文件夹，我认为对图片名称没有限制。我已经尝试了以下代码并且它有效：

```
ImageView img = (ImageView)findViewById(R.id.activity_image);
    try {
        Drawable d = Drawable.createFromStream(getAssets().open("@ahd ka.png"), null);
        img.setImageDrawable(d);
    } catch (IOException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    } 
```

我特意使用了一个名称中带有特殊字符的 png 文件，只是为了表明程序可以运行。希望这可以帮助。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-01T18:16:00.713

您可以在用户第一次加载您的应用程序时下载图像，然后将其保存到 sdcard。

当您的应用程序再次运行时，请检查 sdcard 中是否可用的天气图像。

如果没有，则下载图像，否则使用 sdcard 中的图像。

# php - 拒绝直接访问 PHP 文件

> ID：10855318
> 
> 赞同：2
> 
> 时间：2012-06-01T18:12:09.093
> 
> 标签：php

在设计网站时，我创建了一个 top.php 页面来保存页面的本质，这样我就可以对每个页面使用 include。所以 top.php 用我的 CSS 样式表和我的网站背景，然后是菜单栏来控制我的头。我在我的内容中使用了绝对定位，所以所有内容基本上都位于图像之上——模板。也许不切实际，但看起来确实不错。无论如何，如果您要访问 mywebpage.com/top.php，您只会看到明显没有内容的模板。现在这真的不是问题，因为除了谷歌决定将它包含在搜索中之外，没有人会去那个链接。即使我已经提交了站点地图并将其隐藏在我的 Google 网络帐户中。

有什么解决办法吗？

我显然不是一个经验丰富的网页设计师。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-06-01T18:15:38.147

您应该将仅包含在一个目录中的所有文件放在一个目录中，并使用`.htaccess`文件阻止对该目录的访问。

这将阻止 Google 以及用户直接访问该文件。

您的`.htaccess`文件应包含

`deny from all`

您创建一个名为“片段”的目录并`top.php`放入其中。然后，在目录中创建一个名为`.htacess`. 该文件应包含`deny from all`.

可以通过以下方式创建没有任何名称且只有扩展名的文件：

1.  转到记事本并键入`deny from all`
2.  点击另存为
3.  选择“保存类型”为“所有文件”和名称`".htacess"`（带引号）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-01T18:15:16.647

创建一个`robots.txt`文件并将其放在您的根文件夹中。将其添加到其中：

```
User-agent: *
Disallow: /top.php 
```

此外，您可以使用 .htaccess 修改权限或禁止它

# javascript - 使用 Node.js 驱动程序生成动态 mongodb 查询

> ID：10855323
> 
> 赞同：3
> 
> 时间：2012-06-01T18:12:22.247
> 
> 标签：javascript, node.js, mongodb

我正在使用 MongoDB 的 Node.js 驱动程序，并且在调用 find() 之外构造查询对象没有问题，直到我尝试将`$or`构造引入组合中。

我正在尝试动态生成查询，因为我有可变数量的参数，并且不希望有与我有参数一样多的 collection.find 调用。

为此，我使用了一个简单的查询：

```
var query = {};
query['name'] = 'Steve';
query['date_created'] = '<some date>';

mongo_collection.find(query, function(err, c) {}); 
```

但是，当我尝试使用 $ 或整个过程分崩离析。

我没有高兴地尝试了以下每一项：

```
var query = {}; 
```

1.

```
query[$or] = [ { 'field' : 'value1' }, { 'field' : 'value2' } ];
query['date_created'] = '<some date>'; 
```

2.

```
query = { $or : [ { 'field' : 'value1' }, { 'field' : 'value2' } ] };
query['date_created'] = '<some date>'; 
```

3.

```
query = eval("[ { 'field' : 'value1' }, { 'field' : 'value2' } ]");
query['date_created'] = '<some date>'; 
```

在每种情况下，`$or`都用引号括起来（老实说，我不确定这是否是问题......）并且查询失败。

有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-06-02T04:34:36.703

这是你可以做到的（可能有多种方法）：

```
var query = {};

query["$or"]=[];
query["$or"].push({"field":"value1"});
query["$or"].push({"field":"value2"});
query["date_created"]="whatever";

query
{
    "$or" : [
        {
            "field" : "value1"
        },
        {
            "field" : "value2"
        }
    ],
    "date_created" : "whatever"
} 
```

现在您应该可以运行 db.collection.find(query)

# sql - 不同声明后的自定义订单

> ID：10855326
> 
> 赞同：0
> 
> 时间：2012-06-01T18:12:40.223
> 
> 标签：sql, db2, sql-order-by

我想定制一个订单：IN、OUT、FINISHED。
如果我离开 case 语句，我将进入 FINISHED、IN、OUT。我找到了这个解决方案，但它对我不起作用 - 我遇到了错误。

```
select  distinct 'IN' as STATUS,
(select count(*) ...)
from table

UNION ALL

select  distinct 'OUT',
(select count(*) ...)
from table

UNION ALL

select  distinct 'FINISHED',
(select count(*) ...)
from table

order by 
case STATUS
    when 'IN' then 1
    when 'OUT' then 2
    when 'FINISHED' then 3
end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T18:19:45.057

您提供的查询存在一些语法异常。我认为以下内容可以解决您的问题：

```
select *
from ((select distinct 'IN' as statusA, (select count(*) ...
       from table
      )
      union all
      (select distinct 'OUT',  (select count(*) ...)
       from table 
      )
      union all
      (select distinct 'FINISHED',  (select count(*) ...) 
       from table
      )
     ) t
order by status,
      (case STATUSA when 'IN' then 1
                    when 'OUT' then 2
                    when 'FINISHED' then 3
       end) 
```

您最初的问题可能有多种原因。您在第一个子查询中缺少“IN”。您在 order by 中的状态后缺少逗号。而且，一些数据库将一系列联合中的最终 order by 仅应用于最后一个查询（尽管我认为 DB2 正确地做到了这一点）。

# c# - 验证方法访问权限的最优雅方法是什么（C#.Net）

> ID：10855336
> 
> 赞同：4
> 
> 时间：2012-06-01T18:13:16.823
> 
> 标签：c#, web-services, security

我有一个内置在 WCF (C#.Net) 中的 WebService，其中包含许多方法。在每种方法上，我都不想验证当前用户是否有权访问此特定操作。

现在，我有这样的事情：

```
 public MyContract MyMethod(int MyParameter)
    {
        ValidateAccess(MyCurrentIdentityInfo, ActionEnum);

        // Do stuff here...
    }
    public void MyMethod2(int MyParameter)
    {
        ValidateAccess(MyCurrentIdentityInfo, ActionEnum);

        // Do stuff here...
    }
    etc... 
```

您会注意到我在开始时调用了一个方法来检查访问权限，然后执行我需要的代码。这段代码工作正常，但我必须在我的服务中的每个方法上调用这个方法，我觉得它不漂亮。

有没有更优雅的方式来实现我想要做的事情？我尝试使用自定义属性但没有成功。

请注意，**我不是在尝试对 WebService 本身的用户进行身份验证**。在上面的示例中，用户在 WebService 上是有效的。但是我想运行一个自定义代码来检查他是否可以调用一个删除记录的方法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T18:18:55.290

您可以考虑使用[Castle Dynamic Proxy](http://reducingcomplexity.blogspot.it/2010/02/wcf-and-aop-with-castledynamicproxy.html)将操作验证注入登录用户。

# mysql - 从多个表中检索记录的最快方法

> ID：10855340
> 
> 赞同：1
> 
> 时间：2012-06-01T18:13:25.933
> 
> 标签：mysql, performance, inner-join

我需要从两个表中检索列，并且我使用了 INNER JOIN。但它在加载页面时会耗费大量时间。有没有更好更快的方法来实现同样的目标？

> 从 Pyalers P 中选择 P.Col1、P.Col2、P.Col3、P.Col4、P.Col5、C.Col1、C.Col2、C.Col3 在 C.Col1 = P.Col1 上连接客户 C，其中 P。 Col2 = 5

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-01T18:14:53.333

不知道你的 DDL，就没有办法说。

但从概念上讲这是可以的，只要确保你有正确的索引集。

例如：（您的表名真的是“Pyalers”吗？假设是“玩家”）

```
CREATE INDEX idx_players ON `players` (col1);
CREATE INDEX idx_customers ON `customers` (col1); 
```

使用连接 2 个表所需的列。

[http://dev.mysql.com/doc/refman/5.0/en/create-index.html](http://dev.mysql.com/doc/refman/5.0/en/create-index.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-01T18:18:04.667

您正在以正确的方式进行操作，但是如果您的表上没有正确列上的索引，那么对于任何大小的表都不会很快。Pyalers.col1 和 Customers.col1 是否都有索引？

向我们展示这些表是如何定义的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-01T19:05:54.253

确保您的表具有所需的索引...作为“经验法则”，用于搜索 ( `WHERE`) 或数据连接 ( `INNER JOIN`, `LEFT JOIN`, `RIGHT JOIN`) 的每个字段都应该被索引。

示例：如果你正在创建一个表，你可以在那个时候添加你的索引（注意你的表应该总是有一个主键）：

```
CREATE TABLE myTable (
myId int unsigned not null,
someField varchar(50),
primary key (myId),
index someIdx(someField)
); 
```

如果你的表已经存在，并且要添加索引，则需要使用`ALTER`语句：

```
ALTER TABLE myTable
ADD INDEX someIdx(someField),
ADD PRIMARY KEY (myId); 
```

规则：

1.  要定义索引，您需要为其提供唯一名称，并指定索引中包含的字段：`INDEX myIndex(field1, field2, ...)`

2.  有不同类型的索引：`PRIMARY KEY`用于主键（这很明显，是吧？）；`INDEX`是一个“普通索引”，只是用来加速搜索和连接操作；`UNIQUE INDEX`是防止重复值的索引。

建议：

*   只要有可能，索引所有相关的数字和日期字段（id、出生日期等）。避免在包含“双”值的字段上创建索引。

*   不要滥用索引，因为滥用会创建非常大的索引文件。

尖端：

*   如果您想查看查询将如何执行，可以使用以下`EXPLAIN`语句：

    解释选择 *，乙。*从 a.myId = b.otherId 上的内部连接 ​​b

该指令将向您显示查询的执行计划。如果在最后一列中看到“文件排序”或“使用临时”，您可能（只是可能）需要额外的索引（请注意，如果您使用`GROUP BY`，您几乎总是会收到“使用临时”消息）

希望这对你有帮助

# php - ORM 用 PHP 映射两个表

> ID：10855346
> 
> 赞同：1
> 
> 时间：2012-06-01T18:14:02.717
> 
> 标签：php, orm, pdo, logic

## 现在的情况

我的数据库中有两张表，一张用于帖子，一张用于评分。这些与 MySQL 中的关系相关联，因此一篇文章可能有 0、1 或多个评级，但一个评级只能应用于一篇文章。

当我获取帖子列表时，我还想获得评分，但不必为 foreach 循环中的每个帖子单独调用数据库。

为此，我尝试使用 SQL 查询来获取所有带有 LEFT JOIN 评分的帖子，以便它返回如下结果：

```
statusId|statusBody|rating
-----------------------------
1, post1, 0
1, post1, 1
2, post2, 0
3, post3, 1
3, post3, 1 
```

SQL 工作正常，我得到了我要求的数据。

理想情况下，我现在想要实现的是将此表转换为对象集合，每个对象存储帖子信息以及取决于其总评分的值。

使用 PDO 返回数据结果后，这是我用来映射数据的代码：

## 代码逻辑

我的代码逻辑是这样的：

```
Get all statuses joined with ratings table

Create empty output array

Loop through PDO result
{
    Create loop specific temp array

    Push first row of result into temp array

    Remove row from PDO result

    Loop through PDO result for objects with matching statusId
    {
        If row matches statusId, add to temp buffer and remove from PDO result
    }

    Take first row of buffer and create status object

    Loop through objects in temp array to calculate ratings and add onto above status object
    Clear temp buffer

    Add status object to output array
}

return output array 
```

## 实际代码

```
 try 
  {
     $result = $pdo->query($sql);
     //if($result == false) return false;
     $statuses = $result->fetchAll(PDO::FETCH_CLASS, 'status');
  } 
  catch (PDOException $e) 
  {
     return FALSE;
  }

  if (!$result) {
     return FALSE;
  }

  //create empty output array to be filled up
  $status_output = array();

  //loop through all status
  foreach($statuses as $s1key => $s1value)
  {     
     //initialise temporary array;
     $status_temp_buffer = array();

     //create temp array for storing status with same ID in and add first row
     array_push($status_temp_buffer, $s1value);

     //remove from primary array
     unset($statuses[$s1key]);

     //loop through array for matching entries
     foreach($statuses as $s2key => $s2value)
     {
        //if statusId matches original, add to array;
        if($s2value->statusId == $s1value->statusId)
        {
           //add status to temp array
           array_push($status_temp_buffer, $s2value);

           //remove from primary array
           unset($statuses[$s2key]);
        }

        //stop foreach if statusId can no longer be found
        break;
     }

     //create new status object from data;
     $statObj = $status_temp_buffer[0];

     //loop through temp array to get all ratings
     foreach($status_temp_buffer as $sr)
     {
        //check if status has a rating
        if($sr->rating != NULL)
        {
           //if rating is positive...
           if($sr->rating == 1)
           {
              //add one point to positive ratings
              $statObj->totalPositiveRatings++;
           }

           //regardless add one point to total ratings
           $statObj->totalAllRatings++;
        }
     }

     //clear temporary array
     $status_temp_buffer = NULL;

     //add object to output array
     array_push($status_output, $statObj);
  } 
```

## 问题

我在使用此代码时遇到的问题是，虽然评分很好，并且它正确计算了每个帖子的评分总数，但它仍然显示重复的帖子有多个评分。

对此的任何帮助将不胜感激，谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T18:59:10.757

据我了解，目标是获得每个`Post`条目的总评分。除了手动循环每个评分，您还可以采取另外两条路径：

*   计算查询中的总数：

    ```
    SELECT SUM(rating) AS total , .. FROM Posts LEFT JOIN .... GROUP BY statusID 
    ```

    您将收到一个`Post`条目列表，每个条目都已计算出总评分。如果您有很多*`writes`*to`Ratings`表，这是一个非常好的解决方案，并且更少*`reads`*。

*   另一种方法是打破表规范化，但提高*`read`*性能。您需要做的是在`Posts`表中添加另一列：`total_rating`. 并在表中有一个[`TRIGGER`](http://dev.mysql.com/doc/refman/5.6/en/create-trigger.html)on ，这会相应地改变。`INSERT``Ratings``Posts.total_rating`

    这种方式的好处是简化了请求`Posts`。同时，`Ratings`现在可以使用表来确保`total_rating`已正确计算，或者重新计算值，如果评级有一些较大的变化：比如禁止用户，这会导致删除该用户所做的所有评级。

# c++ - 使用凭据提供程序登录

> ID：10855348
> 
> 赞同：2
> 
> 时间：2012-06-01T18:14:03.137
> 
> 标签：c++, authentication, winapi, credential-providers

请有人向我解释如何创建一个有效的凭据提供程序！我使用 HardwareEventCredentialProvider 示例作为基础来构建我自己的 Provider。我已经更改了用户名和密码字段，但它似乎不起作用。向系统提交凭据后，我只看到一秒钟的空白屏幕。或收到消息“密码或用户名不正确”，然后重新开始身份验证...我需要做什么`GetSerialization()`以及`SetSerialization()`使用现有用户登录的方法？（用户名=L“virt naXa！”，密码=L“1234”）

我已阅读“凭据提供程序技术参考”和 Dan Griffin 关于 Vista 中 CP 的文章，但仍然不明白如何使用凭据提供程序登录。（也许我做的不仔细，需要重读？）

我很抱歉我的英语不好，这不是我的母语:)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2015-04-16T14:20:55.780

*好久没问这个问题了。。。*

我只记得当时我重读[了这篇文章](https://habr.com/ru/post/83384/)（俄语）并**仔细地**按照示例创建了我自己的凭据提供程序。它奏效了！

不幸的是，该文章作者提供的源代码不再可用。在这里您可以找到另一个[Credential Provider](https://github.com/laie/CustomCredentialProvider)示例。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-10T11:58:38.280

下载 MSDN 示例并从[此处自定义它们（新链接）](https://www.microsoft.com/en-us/download/details.aspx?id=4057)。

它们实际上有点过时了，但它们仍然有效！

# android - View1 在 Android 4.0 上 View2.setvisibility(view.INVISIBLE) 后消失

> ID：10855357
> 
> 赞同：0
> 
> 时间：2012-06-01T18:15:02.107
> 
> 标签：android, android-asynctask, visibility, android-4.0-ice-cream-sandwich, glsurfaceview

在我的应用程序中，我有一个包含特定游戏控件（control_1，control_2）的游戏任务栏。另外我有两个按钮（Button_1，Button_2），我可以在其中切换可见性。因为我有很多 UI 更改，所以我在异步任务的 onPostexecute() 中进行了可见性切换。这适用于 android 4.0 之前的所有测试设备。但是> 4.0设备在切换其中一个按钮的可见性时会删除我的游戏任务栏的背景图像。这不应该发生，我没有更多的想法去哪里看。

我在视图层次结构的底部有一个带有 glsurfaceview 的框架布局。

```
<FrameLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:id="@+id/baseframe"
android:layout_width="match_parent"
android:layout_height="match_parent"
android:layout_weight="1" >

<LinearLayout
    android:id="@+id/glSurfaceHolder"
    android:layout_width="match_parent"
    android:layout_height="match_parent" >
</LinearLayout>

<LinearLayout
    android:id="@+id/GameTaskbar"
    android:layout_width="match_parent"
    android:layout_height="50dp"
    android:layout_gravity="bottom"
    android:background="@drawable/bar"
    android:orientation="horizontal"
    android:visibility="invisible" >

    <Button
        android:id="@+id/control_1"
        android:layout_width="50dp"
        android:layout_height="50dp"
        android:layout_gravity="bottom"
        android:layout_margin="1dp"
        android:background="@drawable/blind" >
    </Button>

    <Button
        android:id="@+id/control_2"
        android:layout_width="50dp"
        android:layout_height="50dp"
        android:layout_gravity="bottom"
        android:layout_margin="1dp"
        android:background="@drawable/blind" >
    </Button>   
</LinearLayout>
<Button
    android:id="@+id/Button_1"
    android:layout_width="75dp"
    android:layout_height="50dp"
    android:layout_gravity="right|center_vertical"
    android:background="@drawable/drop_64"
    android:visibility="invisible" >
</Button>

<Button
    android:id="@+id/Button_2"
    android:layout_width="75dp"
    android:layout_height="50dp"
    android:layout_gravity="left|center_vertical"
    android:background="@drawable/back_64"
    android:visibility="invisible" >
</Button>
</FrameLayout> 
```

这是我切换可见性的部分：

```
protected void onPostExecute() {
if(button_1_state){
    Button_1.setVisibility(View.VISIBLE);
}
else{
    Button_1.setVisibility(View.INVISIBLE);
}
if(button_2_state){
    Button_2.setVisibility(View.VISIBLE);
}
else{
    Button_2.setVisibility(View.INVISIBLE);
}

...
 } 
```

根据这篇文章（[在 SurfaceView 上刷新 View 时出错](https://stackoverflow.com/questions/8891262/error-when-refreshing-view-on-top-of-surfaceview)），我能够将 Android4.0 特定的不需要的行为减少为不需要的 backgroundvisibilityswitch。

我也尝试过按钮上的 requestFocus() ，但没有运气。

当我调试它时，一切看起来都应该并且 gametaskbar.getVisibility() = 0。但是在离开 async-onPostexecute() 之后，背景图像消失了。在这种情况下，当我不将按钮可见性切换为不可见时，背景图像也会保留。就像我使用了我没有使用的错误 ID。

即使在模拟器中，我也可以重现这种行为。

ps：按钮可见性根据需要更改

也许有人有一个想法。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-02T16:20:06.930

修复了这个：将带有 GameTaskBar 背景图像的 LinearLayout 更改为另一个 FrameLayout，Imageview 在原始 LinearLayout 下方，带有控件

```
<FrameLayout
    android:id="@+id/GameTaskbar"
    android:layout_width="match_parent"
    android:layout_height="50dp"
    android:layout_gravity="bottom"
    android:visibility="invisible" >

    <ImageView
        android:id="@+id/bar"
        android:layout_width="match_parent"
        android:layout_height="match_parent" 
        android:src="@drawable/bar_512_2"
        android:contentDescription="@string/bar"/>

    <LinearLayout

        android:layout_width="match_parent"
        android:layout_height="match_parent"
        android:orientation="horizontal">

        <Button
            android:id="@+id/control_1"
            android:layout_width="50dp"
            android:layout_height="50dp"
            android:layout_gravity="bottom"
            android:layout_margin="1dp"
            android:background="@drawable/blind" >
        </Button>

        <Button
            android:id="@+id/control_2"
            android:layout_width="50dp"
            android:layout_height="50dp"
            android:layout_gravity="bottom"
            android:layout_margin="1dp"
            android:background="@drawable/blind" >
        </Button>   
    </LinearLayout>
</FrameLayout> 
```

奥奈

# matlab - 如何从文本文件中读取行作为matlab中的字符串？

> ID：10855362
> 
> 赞同：4
> 
> 时间：2012-06-01T18:15:30.463
> 
> 标签：matlab, file-io

我正在尝试在 MATLAB 中读取格式如下的文本文件。我希望将整行作为字符串读取。

```
 2402:0.099061 2404:0.136546 2406:0.447161 2407:0.126333 2408:0.213803 2411:0.068189 
```

我尝试了几件事。

`textscan(fid, '%s')`读取该行，但将该行拆分为空格处的单元格。

`fscanf(fid, '%s')`将该行作为字符串读取，但删除所有空格。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-01T18:33:56.377

`fgetl(fid)`会做你正在寻找的。换行被剥离。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-01T18:24:33.847

`textscan`默认情况下使用空格分隔符。将分隔符设置为空字符串：

```
>> q = textscan(fid, '%s', 'Delimiter', '');
>> q{1}{:}
ans = 2402:0.099061 2404:0.136546 2406:0.447161 2407:0.126333 2408:0.213803 2411:0.068189 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-02T05:46:29.280

如果您想将*整个文件*作为字符串读取（您的文件只有一行），请尝试：

```
s = fileread('input.txt');   %# returns a char vector
s = strtrim(s);              %# trim whitespaces 
```

如果您查看 FILEREAD 函数的源代码，它基本上是以二进制模式将文件作为字符数组读取：`fread(fid, '*char')`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-01T18:24:21.187

默认情况下，textscan 将空格视为分隔符。调用时指定不同的分隔符（数据中不存在），这应该可以解决问题，添加这个 fe

```
 'delimiter', '|' 
```

你也可以使用

```
 file = textread(<fileref goes here>, '%s', 'delimiter', '\n') 
```

然后

```
 file{1,1} 
```

将返回

```
 ans =

    2402:0.099061 2404:0.136546 2406:0.447161 2407:0.126333 2408:0.213803 2411:0.068189 
```

希望这可以帮助

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-05-26T20:19:11.537

采用：

```
clc;
fid = fopen('fileName.m');

while ischar(tline)
    disp(strcat("Line imported: ",tline))
    tline = fgetl(fid);
end

fclose(fid); 
```

# c# - 返回字符串时，Database.AddOutParameter 中的 Size 参数使用什么？

> ID：10855366
> 
> 赞同：10
> 
> 时间：2012-06-01T18:15:38.290
> 
> 标签：c#, .net, sql-server, database, enterprise-library

我得到一个字符串作为输出参数，并且需要知道在调用 AddOutParameter 时为 Size 参数设置什么。

我知道我可以使用一些巨大的数字，比如 int.MaxValue，但想知道最佳实践。

在 SQL Server 中，列实际上是唯一标识符类型。正在执行的 T-SQL 语句插入一条记录，然后将一些输出变量设置为新插入记录的 ID 和 GUID。这是我正在使用的实际代码，但变量名已更改。

```
database.AddOutParameter(cmd, "@someInt", DbType.Int32, 0);
database.AddOutParameter(cmd, "@someString", DbType.String, 0);

database.ExecuteNonQuery(cmd);

someInt = (int)database.GetParameterValue(cmd, "@someInt");
someString = database.GetParameterValue(cmd, "@someString").ToString(); 
```

执行时，我收到以下错误...

System.InvalidOperationException: String[2]: Size 属性的大小为 0 无效。

所以对我来说很明显，你不能只使用大小为 0 的字符串输出参数。你可以用一个 Int32 输出参数来做到这一点，但我猜一个字符串需要一个有效的大小。那么设置大小的最佳做法是什么？它可以只是一个巨大的尺寸而不影响性能吗？我可以将其设置为 int.MaxValue 之类的吗？有没有可以在这里使用的常数；（没有看到任何 String.MaxValue - 您可能会说我是 C# 新手，具有 Java 背景）。

我应该找出 uniqueidentifier 列的最大大小并将大小设置为该大小吗？如果我对 VARCHAR 或 NVARCHAR 列做同样的事情呢？

我希望框架能为我做这件事；我不想为我得到的每个字符串指定一个大小作为输出。有人对最佳实践有任何建议吗？

我已经阅读了下面的帖子以及 MSDN 文档，但是我还没有找到真正的最佳实践答案。

[AddOutParameter - 查找 DBType.Int32 长度的非幻数方法](https://stackoverflow.com/questions/3108881/addoutparameter-non-magic-number-way-of-finding-length-of-dbtype-int32)

[从 SQL Server 读取 VARBINARY(MAX) 到 C#](https://stackoverflow.com/questions/4948051/read-varbinarymax-from-sql-server-to-c-sharp)

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-06-01T21:57:43.073

我们发现您对 UniqueIdentifer 使用了错误的类型。您应该使用`DbType.Guid`而不是字符串，但您在评论中提出了其他问题，我无法在评论中回答，我不确定，所以我需要测试。

他们是

*   您应该将不同字符串输出参数的大小设置为多少？
*   它是 Nvarchar 还是 varchar 是否重要？
*   如果你让它太大或太小会发生什么？

我首先使用`SqlCommandBuilder.DeriveParameters`找出 ADO.NET 和 SQL Server 认为它应该是什么，然后执行存储过程来查看我们的返回值是什么。

```
Sql Type     | DbType                | Size | Returned string.Length()
----------------------------------------------------------------
Varchar(10)  | AnsiString            | 10   | 9
Char(10)     | AnsiStringFixedLength | 10   | 10
Nvarchar(10  | String                | 10   | 9
Varchar(max) | AnsiString            | -1   | 20,480 
NVarchar(max)| String                | -1   | 20,480 
```

正如预期的那样，派生的大小与所有字符类型的长度字段匹配，除了最大值和预期长度的返回值。然而，在查看最大类型和 DbTypes 时，我们对前三个有一些新问题。

*   那个 AnsiString 类型是怎么回事，如果我们将它设置为 DbType.String 如果我们保持相同的大小，它会影响输出吗？**答案：不，它没有，可能是因为 .NET 字符串是 unicode**

*   增加影响是否`Paramater.Size`影响任何非最大值？**答案：是的，但只有 char(10)。它通过添加空格来增加输出大小。**

*   减少`Paramater.Size`影响是否影响任何非最大值？**是的，它会截断返回值**

*   -1 的大小是魔法吗？ **答：是的，如果您将大小设置为 -1，它将返回值，就好像您已正确设置它们一样**

测试代码 .NET 4.0 SQL Server 2008

**SQL 代码**

```
CREATE PROCEDURE SomeOutput( 
@tenVC varchar(10)  output,
@tenC char(10) output,
@tenNVC nvarchar(10) output,
@maxVC varchar(max) output,
@maxNVC nvarchar(max) output,
@Indentifier uniqueidentifier output)
AS 

SELECT @tenC = '123456789',
       @tenVC = '123456789',
       @tenNVC = '123456789',
       @Indentifier = NEWID(),
       @maxVC = '',
       @maxNVC = ''

SELECT 
       @maxVC = @maxVC + '1234567890',
       @maxNVC = @maxNVC + '1234567890'
FROM
        master..spt_values 
WHERE
      type= 'P' 
```

**C# 代码**

```
static void Main(string[] args)
{

    using (SqlConnection cnn = new SqlConnection("Server=.;Database=Test;Trusted_Connection=True;"))
    {
        SqlCommand cmd = new SqlCommand("SomeOutput", cnn);
        cmd.CommandType = CommandType.StoredProcedure;
        cnn.Open();
        SqlCommandBuilder.DeriveParameters(cmd);

        Printparams(cmd.Parameters, "Derived");

        foreach (SqlParameter param in cmd.Parameters)
        {
            //By default output parameters are InputOutput
            //This will cause problems if the value is both null
            if (param.Direction == ParameterDirection.InputOutput )
                param.Direction = ParameterDirection.Output;

        }

        cmd.ExecuteNonQuery();

        Printparams(cmd.Parameters ,"Executed");

        cmd.Parameters["@tenVC"].DbType = DbType.String;
        cmd.Parameters["@tenNVC"].DbType = DbType.AnsiString;

        cmd.ExecuteNonQuery();

        Printparams(cmd.Parameters, "DbType change");

        foreach (SqlParameter param in cmd.Parameters)
        {
            if (param.DbType != DbType.Int32
                && param.DbType != DbType.Guid
                && param.Size != -1)
            {
                param.Size = param.Size * 2;

            }
        }

        cmd.ExecuteNonQuery();

        Printparams(cmd.Parameters, "Mangeled sizes up");

        foreach (SqlParameter param in cmd.Parameters)
        {
            if (param.DbType != DbType.Int32 
                && param.DbType != DbType.Guid
                && param.Size != -1)
            {
                param.Size = param.Size / 4;

            }
        }

        cmd.ExecuteNonQuery();

        Printparams(cmd.Parameters, "Mangeled sizes down");

        cmd.Parameters["@maxVC"].Size = Int32.MaxValue;
        cmd.Parameters["@maxNVC"].Size = Int32.MaxValue;

        cmd.ExecuteNonQuery();

        Printparams(cmd.Parameters, "Fixed max sizes");

        foreach (SqlParameter param in cmd.Parameters)
        {
            if (param.DbType != DbType.Int32
                && param.DbType != DbType.Guid)
            {
                param.Size = -1;

            }
        }

        cmd.ExecuteNonQuery();

        Printparams(cmd.Parameters, "is negative one magic");

        }
} 
```

**输出**

```
Derived
@RETURN_VALUE : Int32 : 0 : ReturnValue : 0 :
@tenVC : AnsiString : 10 : InputOutput : 0 :
@tenC : AnsiStringFixedLength : 10 : InputOutput : 0 :
@tenNVC : String : 10 : InputOutput : 0 :
@maxVC : AnsiString : -1 : InputOutput : 0 :
@maxNVC : String : -1 : InputOutput : 0 :
@Indentifier : Guid : 0 : InputOutput : 0 :

Executed
@RETURN_VALUE : Int32 : 0 : ReturnValue : 1 : 0
@tenVC : AnsiString : 10 : Output : 9 : 123456789
@tenC : AnsiStringFixedLength : 10 : Output : 10 : 123456789
@tenNVC : String : 10 : Output : 9 : 123456789
@maxVC : AnsiString : -1 : Output : 20480 : 123456789012345678901234567
@maxNVC : String : -1 : Output : 20480 : 123456789012345678901234567
@Indentifier : Guid : 0 : Output : 36 : eccc3632-4d38-44e8-9edf-031

DbType change
@RETURN_VALUE : Int32 : 0 : ReturnValue : 1 : 0
@tenVC : String : 10 : Output : 9 : 123456789
@tenC : AnsiStringFixedLength : 10 : Output : 10 : 123456789
@tenNVC : AnsiString : 10 : Output : 9 : 123456789
@maxVC : AnsiString : -1 : Output : 20480 : 123456789012345678901234567
@maxNVC : String : -1 : Output : 20480 : 123456789012345678901234567
@Indentifier : Guid : 0 : Output : 36 : 94cb0039-8587-4357-88fb-25c

Mangeled sizes up
@RETURN_VALUE : Int32 : 0 : ReturnValue : 1 : 0
@tenVC : String : 20 : Output : 9 : 123456789
@tenC : AnsiStringFixedLength : 20 : Output : 20 : 123456789
@tenNVC : AnsiString : 20 : Output : 9 : 123456789
@maxVC : AnsiString : -1 : Output : 20480 : 123456789012345678901234567
@maxNVC : String : -1 : Output : 20480 : 123456789012345678901234567
@Indentifier : Guid : 0 : Output : 36 : 4de88f14-9963-4a78-b09b-bb6

Mangeled sizes down
@RETURN_VALUE : Int32 : 0 : ReturnValue : 1 : 0
@tenVC : String : 5 : Output : 5 : 12345
@tenC : AnsiStringFixedLength : 5 : Output : 5 : 12345
@tenNVC : AnsiString : 5 : Output : 5 : 12345
@maxVC : AnsiString : -1 : Output : 20480 : 123456789012345678901234567
@maxNVC : String : -1 : Output : 20480 : 123456789012345678901234567
@Indentifier : Guid : 0 : Output : 36 : 5e973e72-14e5-4b75-9cff-e88

Fixed max sizes
@RETURN_VALUE : Int32 : 0 : ReturnValue : 1 : 0
@tenVC : String : 5 : Output : 5 : 12345
@tenC : AnsiStringFixedLength : 5 : Output : 5 : 12345
@tenNVC : AnsiString : 5 : Output : 5 : 12345
@maxVC : AnsiString : 2147483647 : Output : 20480 : 123456789012345678901234567
@maxNVC : String : 2147483647 : Output : 20480 : 123456789012345678901234567
@Indentifier : Guid : 0 : Output : 36 : 6cab2b41-d4ba-42d2-a93a-e59

is negative one magic
@RETURN_VALUE : Int32 : 0 : ReturnValue : 1 : 0
@tenVC : String : -1 : Output : 9 : 123456789
@tenC : AnsiString : -1 : Output : 10 : 123456789
@tenNVC : AnsiString : -1 : Output : 9 : 123456789
@maxVC : AnsiString : -1 : Output : 20480 : 123456789012345678901234567
@maxNVC : String : -1 : Output : 20480 : 123456789012345678901234567
@Indentifier : Guid : 0 : Output : 36 : 0d69ed57-fab7-49c8-b03a-d75 
```

# c# - 静态对象/多个应用程序域/一个进程

> ID：10855386
> 
> 赞同：1
> 
> 时间：2012-06-01T18:16:42.940
> 
> 标签：c#, winforms, multithreading, process, appdomain

好的，问题来了，我有一个严重依赖静态变量的 winform 应用程序，它是一个单例应用程序（一次只有一个进程实例）。

我现在需要创建一个包装应用程序，它可以创建 6 个这样的 winform 应用程序并在它们的主窗口之间切换。这样做的原因是这些应用程序有很多静态引用，必须根据它们连接的数据库进行更新。我们的用户现在需要连接到多个数据库，并且重新设计代码以消除静态问题不是一种选择。

所以我的问题是，我知道我可以在一个进程中创建新的应用程序域，但是这些应用程序域中的每一个是否都会获得一组新的静态引用？还是我实际上必须有单独的流程？如果是这样，我该如何构建一个新应用程序来创建旧应用程序的 6 个实例并将数据传递给每个实例（例如隐藏/显示、加载此对象、查询此数据库等...）对于一些简单的事情，这最终将成为一个扔掉的项目。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T18:19:16.703

每个应用程序域都有自己的一组加载程序集（[域中性程序](http://msdn.microsoft.com/en-us/library/43wc4hhs.aspx)集除外，它们在域之间共享）和类型。应用程序域中的每种类型都有自己的静态变量实例（在域中立程序集的情况下，CLR 以特殊方式提供了这一点）。

# api - 用于在 RESTful API 中添加到集合的 HTTP 方法

> ID：10855388
> 
> 赞同：6
> 
> 时间：2012-06-01T18:16:47.410
> 
> 标签：api, rest, http-method

我有一个代表标签集合的资源：

```
/users/{username}/tags 
```

API 客户端应该能够在单个 HTTP 请求中向该集合添加一组标签。我考虑了如何做到这一点，并首先考虑使用 PUT 或 POST 方法。但是我认为这意味着客户端正在“设置”或“替换”该集合中的标签。将多个标签“添加”到该集合中的最合适的 HTTP 方法（或者可能是不同的机制）是什么？

```
{HTTP METHOD} /users/{username}/tags 
```

请求正文：

```
 ["short", "crazy", "funny"] 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-06-01T20:33:14.400

`PUT /users/alganet/tags`替换所有标签。

`POST /users/alganet/tags`添加更多标签。

您也可以使用[PATCH](https://www.rfc-editor.org/rfc/rfc5789)。

`PATCH /users/alganet/tags`更改标签。

可能的身体：

`{"POST":["rest", "php"], "DELETE":["soap"]}`

正文必须具有与标头匹配的特定补丁格式`Accept-Patch`。上面的示例正文是补丁的自定义格式，但您可以使用`diff`例如 clean。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-06-01T18:22:04.540

如果在请求正文中发送的标签旨在添加到集合中，而不是替换，我建议使用 POST。如果您打算替换现有标签，请使用 PUT。

# c# - 创建运行时程序集的实例和分配属性

> ID：10855390
> 
> 赞同：2
> 
> 时间：2012-06-01T18:17:04.073
> 
> 标签：c#, system.reflection

我需要创建一个通用解决方案来创建从 xsd 生成的类的实例。例如：

```
<?xml version="1.0" encoding="utf-8"?>
<xs:schema attributeFormDefault="unqualified" elementFormDefault="qualified" xmlns:xs="http://www.w3.org/2001/XMLSchema">
  <xs:element name="PS">
    <xs:complexType>
      <xs:sequence>
        <xs:element name="P" maxOccurs="unbounded">
          <xs:complexType>
            <xs:sequence>
              <xs:element name="FXs" maxOccurs="1" minOccurs="0">
                <xs:complexType>
                  <xs:sequence>
                    <xs:element maxOccurs="unbounded" name="FX" minOccurs="1">
                      <xs:complexType>
                        <xs:attribute name="asOfDate" type="xs:date" use="required" />
                        <xs:attribute name="currency" type="xs:string" use="required" />
                        <xs:attribute name="rate" type="xs:decimal" use="required" />
                      </xs:complexType>
                    </xs:element>
                  </xs:sequence>
                </xs:complexType>
              </xs:element>
 </xs:sequence>
            <xs:attribute name="PName" type="xs:string" />
            <xs:attribute name="currency" type="xs:string" />
          </xs:complexType>
        </xs:element>
      </xs:sequence>
    </xs:complexType>
  </xs:element>
</xs:schema> 
```

当我从这个 xsd 运行时生成程序集时，它将具有 PS、PSP 和 PSFX 类。在这种情况下，我知道属性和期望的内容，因此 createinstance 和 getproperties 和 setvalue 将起作用。我知道投资组合将有一系列 PortfoliosPortfolio。

```
case "PS":
                                    if (p== null)
                                        p= myAssembly.CreateInstance(cls.FullName);
                                    break;

                                case "PSP":
                                    myClass = myAssembly.CreateInstance(cls.FullName);
                                    myClass.GetType().GetProperty("PName").SetValue(myClass, dt.Rows[0]["PortfolioName"].ToString(), null);
                                    myClass.GetType().GetProperty("currency").SetValue(myClass, dt.Rows[0]["Currency"].ToString(), null);
                                    if (myClasses == null)
                                        myClasses = Array.CreateInstance(myClass.GetType(), deals.Count());
                                    myClasses.SetValue(myClass, l);
                                    l++;
                                    portfolio.GetType().GetProperty("P").SetValue(p, myClasses, null); 
```

现在我想要一个通用的解决方案，它可以采用任何 xsd（不仅仅是上面的）并生成一个程序集。我已经生成了汇编，但现在我的问题是如何为不知道其中存在哪些属性的类动态分配属性？我的意思是我如何知道一个类在创建通用解决方案时正在使用另一个类的对象列表。因此，有一种方法可以获取实例和属性，而不是对类名和属性名进行硬编码。正如您从上面的代码片段中看到的那样，我将 a 数据集中的值分配给属性。计划是将值作为列名、属性名和父节点存储在数据库中。因此 P 节点中的 PName 属性将来自列名 Pname。我希望以这样一种方式进行设计，即我的代码中不会有任何硬编码。

对不起，请多多包涵，如果我说得不对，请告诉我。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T23:49:41.357

长问题值得长答案：

**I.**首先，一个小小的证书：我已经在类/程序集生成方面工作了一段时间。事实上，您可以使用[CodeDom](http://msdn.microsoft.com/en-us/library/y2k85ax6.aspx)（首选方法）或[IL Emit](http://msdn.microsoft.com/en-us/library/system.reflection.emit.ilgenerator%28v=vs.95%29.aspx)来做到这一点。但你可能不应该。

*   反对这一点的第一个论点是您的 XML 模型实际上并没有那么有用。好的，所以您有一个想要转换为类的 XML。为此，您将以某种方式将该 XML 转换为代码（C# 或 VB 甚至 IL），然后在运行时编译它以创建一个动态类。那么，为什么不直接使用代码而不是 XML？
*   上述观点有一个推论：如果您在设计时指定类，为什么不编译该类（因此，在编译时生成它）？

* * *

**二、**您的设计驱动程序**不是硬代码**。

*   首先是哲学分析：你不想硬编码*代码*，这是一个悖论。
*   最好的做法是尽量减少源代码中的硬编码字符串，主要是因为 (1) 这些字符串会发生变化 (2) 它可能会使测试更容易。我们可以从这个定义中提取两件事：
    *   您应该避免硬编码**字符串**，而不是程序结构
    *   您应该只配置那些在编译时预计会改变（“动态”）或您不知道的东西。数据库结构几乎不是这种情况。

现在，抽象地思考一下，你能避免硬编码吗？在您的示例中，您已经使用了一些字符串来引用您将要处理的 XML 文件中的数据。如果没有有关您要处理的数据的任何信息，程序将如何工作？

（是的，有答案）

...

答：当您只是呈现数据时，即完整的数据结构与程序逻辑无关。这方面的例子是文本编辑器。文本编辑器不需要事先了解数据。您渲染它，因为它存在于文件中。

但是，在您的情况下，数据库是数据的“主”。试图将它与您的程序分开是没有用的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-01T18:25:19.973

只解析 XML 而不是创建程序集不是更容易吗？您可以使用 XmlSchema 及其子对象来提取数据库中所需的所有信息。您可以使用处理 XML 文档的通用框架来操作 XML 输出。或者，如果您确实需要该程序集，您可以先更改 XML，然后将其反序列化为一个对象。

但是，如果您的客户端代码在编译时不应该知道程序集的 CLR 类型，我认为首先创建程序集没有多大意义，您最好创建一个通用的中间数据格式您可以根据需要转换为 XML 或数据库列。

# .net - dapper 查询返回的 DynamicObject 不包含所有选定的列

> ID：10855391
> 
> 赞同：0
> 
> 时间：2012-06-01T18:17:05.723
> 
> 标签：.net, sql-server, orm, dapper, calculated-columns

我正在使用 dapper.net 执行插入，如下所示：

```
var columns = conn.Query("INSERT INTO MyTable" +
                   "(Col1, Col2, Col3)" +
                   "VALUES (@Col1, @Col2, @Col3)" +
                   "SELECT Id, ComputedColumn FROM MyTable WHERE Id = scope_identity()",
                   myObj).Single();

myObj.Id = columns.Id;
myObj.ComputedValue = columns.ComputedColumn; 
```

查询成功，但在`myObj.ComputedValue = columns.ComputedColumn;`说`'System.Dynamic.DynamicObject' does not contain a definition for 'ComputedColumn'`

正如您可能已经收集到的，ComputedColumn 是表上的一个计算列，这就是为什么我在插入后将它与 Id 一起返回的原因。知道为什么这会失败吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T19:25:59.060

想通了——我在这张桌子上有一个代替插入的触发器。触发器正在返回 Id，以便与 Entity Framework（我已经切换到 dapper）一起玩得很好。 `SELECT Id, ComputedColumn FROM MyTable WHERE Id = scope_identity()`实际上甚至没有返回一行，但是 dapper 正确加载了触发器返回的 Id。将触发器更改为返回 Id 和 ComputedColumn，一切正常！

# javascript - JQuery .get xml crossdomain call inconsistencies

> ID：10855392
> 
> 赞同：1
> 
> 时间：2012-06-01T18:17:09.310
> 
> 标签：javascript, jquery, xml, ajax

I have been reading around this subject all morning, but I am still confused by the results.

From what I understand JQuery .ajax .get should not work cross browser using datatype="xml", however the following rs feed does work

`var rssurl = 'http://gdata.youtube.com/feeds/base/videos/-/trees?orderby=published&alt=rss';`

Yet when I try and call another feed it doesn't work. It gives a parseerror.

`var rssurl = 'http://api.flickr.com/services/feeds/photos_public.gne?tags=trees&format=rss2'`

Now this feed that doesn't work, does work, when I copy it locally and call it. Which is why I think it is a crossdomain issue.

Also, when viewing in Fiddler, I can see the feed is actualy downloaded. Which I find strange as why would this hapen if it is a crossdomain call, surely it would stop before the feed is pulled?

Below the code to pull the feed.

`$.ajax({ type: "GET", url: rssurl, dataType: "xml", success: function(data, textStatus, jqXHR) { document.write("got the feed: "+ textStatus+"
"); var $xml = $(data); $xml.find("item").each(function() { var $this = $(this), document.write( $this.find("title").text() ); }); }, error: function(jqXHR, textStatus, errorThrown){ alert('failure'); console.log('status: ' + textStatus); if (textStatus == 'error') console.log(errorThrown); } );`

So onto my questions:

1.  Why would I be able to make a cross-domain call to one feed and not another; shouldn't both be banned?
2.  If the 2nd feed did contain erros, why would it work locally?
3.  arghhhhhhhhhhhhhhh

cheers

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T19:46:58.963

The [CORS norm](https://developer.mozilla.org/en/http_access_control) specifies that the browser asks the server the authorization to embed the content in a frame coming from another origin. All modern browsers respect this norm.

When you ask api.flickr.com, it doesn't give you the authorization.

But when you ask gdata.youtube.com, it answers this header :

```
HTTP/1.1 200 OK
X-GData-User-Country: FR
Access-Control-Allow-Origin: http://fiddle.jshell.net
Content-Type: text/xml; charset=UTF-8
Expires: Fri, 01 Jun 2012 19:41:43 GMT
Date: Fri, 01 Jun 2012 19:41:43 GMT
Cache-Control: private, max-age=1800, no-transform
Vary: *
GData-Version: 1.0
Last-Modified: Fri, 01 Jun 2012 19:41:43 GMT
Content-Encoding: gzip
Transfer-Encoding: chunked
X-Content-Type-Options: nosniff
X-Frame-Options: SAMEORIGIN
X-XSS-Protection: 1; mode=block
Server: GSE 
```

So you see that you're authorized to embed the content (here I ask from a fiddle hence the [http://fiddle.jshell.net](http://fiddle.jshell.net) but servers may answer simply '*' meaning all origins without bothering personalizing this part of the header).

The conclusion is logical : you may include cross-domain parts if the service allows it.

And keep in mind that it's mainly a browser side lock, that protects you as a user (and your data) against injections.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-02T05:17:54.620

To answer your questions:

1.  It's the server's policy that decides whether the cross-domain call is allowed or not. To look at this from another perspective, [Flash](http://www.adobe.com/devnet/articles/crossdomain_policy_file_spec.html) and [Silverlight](http://msdn.microsoft.com/en-us/library/cc197955%28v=vs.95%29.aspx) developers are very familiar with cross-domain policies. To access a web service on another domain, the service needs to authorize cross-domain requests. The purpose is an attempt to limit cross-site scripting attacks.
2.  It means there's nothing wrong with the feed, it's just that when you load it remotely the browser is blocking your request per cross-domain policy.
3.  LOUD NOISES

You raise an interesting point that some browsers do actually load the file (as confirmed by Fiddler). IE by contrast does not load the file at all. I don't know the answer, but it would be interesting to hear an explanation of that point.

# dependencies - 可选类的 Puppet 运行排序

> ID：10855397
> 
> 赞同：5
> 
> 时间：2012-06-01T18:17:20.657
> 
> 标签：dependencies, puppet

我正在尝试用 Puppet 解决以下问题：

我有多个节点。每个节点都包含一个类的集合。例如，有一个`mysql`类和一个`webserver`类。node1 只是一个 webserver，node2 是 webserver + mysql。

我想指定如果一个节点同时具有 webserver 和 mysql，则 mysql 安装将在 webserver 之前发生。

我不能有`Class[mysql] -> Class[webserver]`依赖，因为 MySQL 支持是可选的。

我尝试使用阶段，但它们似乎在我的类之间引入了依赖关系，所以如果我有例如这个：

```
Stage[db] -> Stage[web]
class {
'webserver': 
  stage => web ;
'mysql':
  stage => db ;
} 
```

我在我的节点中包含 webserver 类

```
node node1 {
  include webserver
} 
```

.. mysql 类也包括在内！那不是我想要的。

如何定义可选类的顺序？

**编辑：这是解决方案：**

```
class one {
    notify{'one':}
}

class two {
    notify{'two':}
}

stage { 'pre': }

Stage['pre'] -> Stage['main']

class {
    one: stage=>pre;
    # two: stage=>main; #### BROKEN - will introduce dependency even if two is not included!
}

# Solution - put the class in the stage only if it is defined
if defined(Class['two']) {
    class {
            two: stage=>main;
    } 
}

node default {
    include one
} 
```

结果：

```
notice: one
notice: /Stage[pre]/One/Notify[one]/message: defined 'message' as 'one'
notice: Finished catalog run in 0.04 seconds 
```

~

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-19T03:00:53.940

如果 Class[mysql] 是可选的，那么您可以尝试使用 defined() 函数检查它是否存在：

```
 if defined(Class['mysq'l]) {
   Class['mysql'] -> Class['webserver']
 } 
```

这是我用来测试的一些示例代码：

```
class optional {
    notify{'Applied optional':}
}

class afterwards {
    notify{'Applied afterwards':}
}

class another_optional {
    notify{'Applied test2':}
}

class testbed {

    if defined(Class['optional']) {
            notify{'You should see both notifications':}
            Class['optional'] -> Class['afterwards']
    }

    if defined(Class['another_optional']) {
            notify{'You should not see this':}
            Class['another_optional'] -> Class['afterwards']
    }
}

node default {
     include optional
     include afterwards
     include testbed
} 
```

使用“puppet apply test.pp”执行后，它会生成以下输出：

```
notice: You should see both notifications
notice: /Stage[main]/Testbed/Notify[You should see both notifications]/message: defined 'message' as 'You should see both notifications'
notice: Applied optional
notice: /Stage[main]/Optional/Notify[Applied optional]/message: defined 'message' as 'Applied optional'
notice: Applied afterwards
notice: /Stage[main]/Afterwards/Notify[Applied afterwards]/message: defined 'message' as 'Applied afterwards'
notice: Finished catalog run in 0.06 seconds 
```

我在 Ubuntu 11.10 上使用 puppet 2.7.1 进行了测试

# c# - Log4Net 记录不正确的数据

> ID：10855398
> 
> 赞同：1
> 
> 时间：2012-06-01T18:17:25.100
> 
> 标签：c#, wcf, log4net, log4net-appender

我有一个 WCF 服务，其中我使用 Log4Net 将信息记录到 Sql Server 数据库。我使用 Log4Net 的 GlobalContext 来记录一些额外的信息，比如事务名称、状态、消息和其他一些东西。该系统中的一些重要事务是读取、写入和登录。

日志应如下所示：

*   “读取” -------- “成功” -------- “读取 xxx 客户数据”
*   “写入” -------- “成功” -------- “写入 xxx 客户的数据”
*   “登录”--------“失败”--------“用户会话已存在。”

当我运行正常测试时，一切正常 - 日志完美地写入数据库。但是，最近我使用 JMeter 进行了负载测试。上面提到的三个事务在 100 个并发线程中测试了 3 分钟。当我检查数据库日志时，我发现有些信息被错误地记录了。

前任：

*   “读取”--------“成功”--------“用户会话已存在。”
*   “写入” -------- “成功” -------- “读取 xxx 客户数据”

这是 Log4Net GlobalContext 不是线程安全的问题吗？我尝试使用 ThreadContext 而不是 GlobalContext，但看起来很多信息没有被记录。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-03T04:51:47.933

LogicalThreadContext 为我做了诀窍！

# ruby-on-rails - 如何将 Twitter Bootstrap 安装到我的 Rails

> ID：10855404
> 
> 赞同：3
> 
> 时间：2012-06-01T18:17:44.910
> 
> 标签：ruby-on-rails, ruby, twitter-bootstrap

我刚跑

```
gem install twitter-bootstrap-rails 
```

它安装了许多文件：

```
11 gems installed
Installing ri documentation for activesupport-3.2.5...
Installing ri documentation for activemodel-3.2.5...
Installing ri documentation for rack-1.4.1...
Installing ri documentation for journey-1.0.3...
Installing ri documentation for sprockets-2.1.3...
Installing ri documentation for actionpack-3.2.5...
Installing ri documentation for therubyracer-0.10.1...
Installing ri documentation for commonjs-0.2.6...
Installing ri documentation for less-2.2.1...
Installing ri documentation for less-rails-2.2.3...
Installing ri documentation for twitter-bootstrap-rails-2.0.8...
Installing RDoc documentation for activesupport-3.2.5...
Installing RDoc documentation for activemodel-3.2.5...
Installing RDoc documentation for rack-1.4.1...
Installing RDoc documentation for journey-1.0.3...
Installing RDoc documentation for sprockets-2.1.3...
Installing RDoc documentation for actionpack-3.2.5...
Installing RDoc documentation for therubyracer-0.10.1...
Installing RDoc documentation for commonjs-0.2.6...
Installing RDoc documentation for less-2.2.1...
Installing RDoc documentation for less-rails-2.2.3...
Installing RDoc documentation for twitter-bootstrap-rails-2.0.8... 
```

我应该运行捆绑更新吗？还是我只需要将 twitter-bootstrap-rails-2.0.8 添加到我的 gemfile 中？

什么是让它被我的“require”和“import”语句识别的正确方法？

我还将这一行添加到我的 application.css 中：

```
 *= require twitter/bootstrap 
```

谢谢！

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-06-01T18:23:49.627

我相信您需要将 twitter bootstrap 添加到您的 gemfile 中，然后运行`bundle install`​​. Gemfile 的目的是为 Rails 提供应用程序需要的依赖项/gems 的参考。因此，除非您在 gemfile 中指定它，尽管它已安装，您的应用程序无法使用它。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-01T18:24:48.303

每当您对安装这样的 gem 有疑问时，Github 上的页面都是一个不错的起点。

[https://github.com/seyhunak/twitter-bootstrap-rails#installing-gem](https://github.com/seyhunak/twitter-bootstrap-rails#installing-gem)

把它放在你的gemfile中。

捆绑安装。

然后继续阅读那里的说明。;)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-01T18:23:02.263

您需要在 Gemfile 中使用它，然后运行 ​​bundle install

# mysql - 使用子查询删除行？

> ID：10855410
> 
> 赞同：0
> 
> 时间：2012-06-01T18:18:03.107
> 
> 标签：mysql, sql, database

使用时我似乎无法让 SQL 工作`LIKE`

```
DELETE FROM `customer_numbers` 
WHERE number NOT LIKE (SELECT number FROM number_part)% 
```

`constomer_numbers`如果`number`不包含在`number_part`表中，则基本上从表中删除所有行

示例：customer_numbers.number = 0559354544 和 number_part.number = 05593 - 它不应该删除它。但是如果 05593 不包含在`customer_numbers.number`然后从 customer_numbers 表中删除行.. 它应该匹配前 5 位数字`number_part`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-01T18:24:35.537

您不能将 not like 与列表一起使用（在大多数数据库中，我很确定这在 mysql 中是正确的）。

相反，您可以使用相关子查询：

```
DELETE FROM `customer_numbers`
WHERE not exists (SELECT number FROM number_part
                  where customer_numbers.number like concat(number, '%')
                 ) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-01T18:25:41.707

您的查询相当混乱。至少有两种方式：

1.  您的子查询返回多行，但位于您期望单个结果的位置。

2.  您需要引用您的 LIKE 字符串。

2 可能很容易修复。尝试：

```
... WHERE number LIKE CONCAT((SELECT ... LIMIT 1),'%'); 
```

不过，1确实是您的问题。如果您将子选择作为单个命令运行，我希望您会得到多行，对吗？您希望如何将数字列表（比如说，`1, 2, 3, 4, 5`）视为 LIKE 字符串的一部分？

我猜你希望的是类似的东西`LIKE '1%' OR LIKE '2%' OR LIKE '3%'...`，等等......不是吗？

无论如何，如果您能更准确地告诉我们您想要做什么，我们可能会帮助您更好地解决您的问题。

正如你的问题所言，我只能说： **它不是那样工作的。**

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-01T19:11:38.237

您将字段命名为编号，但由于前导 0，它们似乎是字符值，所以我假设它们是字符字段。

如果您的部件号总是 5 个字符长，那么您可以执行以下操作：

```
DELETE FROM `customer_numbers` 
WHERE substring(number,1,5) NOT IN (SELECT number FROM number_part) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-01T18:24:08.723

1.  您不能对数字字段进行 LIKE。
2.  您不能对不是 DISTINCT 的子选择进行相等。

您必须使用“IN”。

```
DELETE FROM `customer_numbers` WHERE number NOT IN (SELECT number FROM number_part) 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-01T18:24:30.663

像这样的东西怎么样：

```
DELETE FROM customer_numbers WHERE number NOT IN (SELECT number FROM number_part) 
```

# php - 为丢失的键递归复制多维数组结构

> ID：10855413
> 
> 赞同：0
> 
> 时间：2012-06-01T18:18:07.343
> 
> 标签：php, arrays

几天来，我一直在用头撞墙，试图编写一种方法来递归地从 2 个多维数组中填充任何缺失的键和空值。

基本上，我有 2 个数组，一个是包含所有预期键的“主”多维数组，另一个是我想在缺失值不存在时填充它们。

例如：

主阵列：

```
Array
(
    [title] => 
    [blog_content] => 
    [blog_files] => Array
        (
            [0] => Array
                (
                    [file] => Array
                        (
                            [file_id] => 
                            [site_id] => 
                            [entry_id] => 
                            [field_id] => 
                            [channel_id] => 
                            [member_id] => 
                            [member_info] => Array
                                (
                                    [0] => Array
                                        (
                                            [username] => 
                                            [member_id] => 
                                            [screen_name] => 
                                            [email] => 
                                            [join_date] => 
                                            [last_visit] => 
                                            [group_id] => 
                                            [in_authorlist] => 
                                        )

                                )

                            [link_field_id] => 
                            [filename] => 
                            [extension] => 
                            [mime] => 
                            [upload_service] => 
                            [title] => 
                            [url_title] => 
                            [filesize] => 
                            [md5] => 
                            [file_primary] => 
                            [file_order] => 
                            [date] => 
                            [downloads] => 
                        )

                )

        ) 
```

修改后的数组：

```
Array
(
    [title] => Title goes here
    [status] => open
    [entry_date] => 1321038883
    [entry_id] => 79
    [blog_content] => 
    [blog_files] => 
    [test_file] => 

) 
```

我要做的是获取主数组并将任何丢失的键和多维结构添加到修改后的数组中，如下所示：

```
Array
(
    [title] => Title goes here
    [status] => open
    [entry_date] => 1321038883
    [entry_id] => 79
    [blog_content] => Here's the content
[blog_files] => Array
    (
        [0] => Array
            (
                [file] => Array
                    (
                        [file_id] => 
                        [site_id] => 
                        [entry_id] => 
                        [field_id] => 
                        [channel_id] => 
                        [member_id] => 
                        [member_info] => Array
                            (
                                [0] => Array
                                    (
                                        [username] => 
                                        [member_id] => 
                                        [screen_name] => 
                                        [email] => 
                                        [join_date] => 
                                        [last_visit] => 
                                        [group_id] => 
                                        [in_authorlist] => 
                                    )

                            )

                        [link_field_id] => 
                        [filename] => 
                        [extension] => 
                        [mime] => 
                        [upload_service] => 
                        [title] => 
                        [url_title] => 
                        [filesize] => 
                        [md5] => 
                        [file_primary] => 
                        [file_order] => 
                        [date] => 
                        [downloads] => 
                    )

            )

) 
```

我尝试了一些令人讨厌的头部爆炸递归（我现在头疼），内置了诸如 array_merge 之类的函数（不适用于数字键），但没有什么能让事情正常进行。

但是要记住的一件事是，有时修改后的数组有时会具有主数组的结构或结构的一部分，其值因此将主数组附加到修改后的数组将覆盖任何现有值。

任何帮助/建议将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T18:22:02.253

这看起来非常适合经常被遗忘的[数组联合运算符](http://php.net/manual/en/language.operators.array.php)

```
$newArray = $moddedArray + $masterArray; 
```

我不知道你想用 multi-dimensional `$moddedArray`s 做什么，因为你的例子并不清楚。

# php - 捕获所有 PHP 错误并将它们放入字符串 var

> ID：10855423
> 
> 赞同：-1
> 
> 时间：2012-06-01T18:19:04.977
> 
> 标签：php

如何捕获所有 PHP 错误并将它们放入字符串 var 中？

我想我应该使用 set_error_handler()。

我正在使用 Ajax + JSON 并希望以字符串形式输出错误，然后通过 JSON 输出它们。

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-08T10:56:53.833

嗯，这很容易：

```
/// Exception handler function
function yourExceptionHandler($exception)
{
    echo '
    <pre>
    <b>Error</b>:  Unhandled '.$exception.'
    occured <b>'.$exception->getFile().'</b> in line <b>'.
    $exception->getLine().'</b><br />
    </pre>';
} 
```

然后把这个函数交给php：

```
/// Assign exception handler function
set_exception_handler('yourExceptionHandler'); 
```

将此代码放在 php 脚本的开头。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-01T18:22:10.843

用这个：

```
<?php

try {

// your code block here

} catch (Exception $e) {
  $_my_catch_var = $e->getMessage();
} 
```

# c# - 从文本框中获取值

> ID：10855425
> 
> 赞同：-2
> 
> 时间：2012-06-01T18:19:14.150
> 
> 标签：c#, windows-8, windows-runtime, microsoft-metro

我知道问这个问题很愚蠢，但我似乎无法从我的文本框中为 Windows 8 Metro 应用程序添加额外的 Value(int)。已经尝试了几个小时，感觉很愚蠢，有人帮帮我。谢谢

```
int test = textboxSharedTotal.GetValue;
int test = int.Parse(textboxSharedTotal);
int test = int.Parse(textboxSharedTotal.Text); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-01T20:56:01.823

int test = int.Parse(textboxSharedTotal.Text);

应该管用。没有更多细节，很难为您提供帮助。如果此文本框出现在对话框中，但您想提取值并在主窗体/应用程序中引用它，则需要在对话框函数调用之外声明 int test 并将其作为引用字符串传递。然后你可以设置它 = int.Parse(textboxSharedTotal.Text); 并且在用户关闭对话框后仍然具有该值。

如果没有更多细节，我不知道这是否是你的问题。

# cakephp - 如何在 TitleController CakePHP 中向 UserController 发出请求？

> ID：10855430
> 
> 赞同：0
> 
> 时间：2012-06-01T18:19:24.043
> 
> 标签：cakephp

如何在 CakePHP 的 TitleController 中向 UserController 发出请求？

我试试

```
$ this-> User-> Title-> find ('list'); 
```

但它不起作用。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-01T19:41:46.587

如果您的 User 模型和 Title 模型之间存在 HasMany 或 BelongsTo 等关系，您将能够使您的代码工作。如果没有关系，则需要先加载模型：

在您的标题控制器中：

```
$this->loadModel('User');
$this->User->find('list'); 
```

# asp.net - 如何使用 Gmail OAuth 制作 STS

> ID：10855431
> 
> 赞同：1
> 
> 时间：2012-06-01T18:19:27.810
> 
> 标签：asp.net, oauth, gmail, identity

我们想制作一个将身份验证外包给谷歌的 STS。

按照[https://developers.google.com/accounts/docs/OAuth2Login?hl=es-ES](https://developers.google.com/accounts/docs/OAuth2Login?hl=es-ES)中所述的步骤，我们在 vs2010 中的 sts 网站模板生成的 Login.aspx 中有以下代码：

```
protected void Page_Load(object sender, EventArgs e)
{
    if (Request.QueryString["code"] != null)
    {
        //I'm coming from google, already authenticated
        FormsAuthentication.SetAuthCookie(GetUserName(Request.QueryString["code"]), false);
        Response.Redirect("default.aspx");
    }
    else
    {
        //I want to authenticate
        Response.Redirect(
            "https://accounts.google.com/o/oauth2/auth?" +
            "response_type=code&" +
            "client_id=988046895016.apps.googleusercontent.com&" +
            "redirect_uri=" + HttpUtility.UrlEncode("https://localhost/GmailSTS/login.aspx") + "&" +
            "scope=" + HttpUtility.UrlEncode("https://www.googleapis.com/auth/userinfo.email")
            );
    }
} 
```

但是我收到一个错误，因为 QueryString 中没有指定 wa，调试示例和生成的模板我看到 wa、wtrealm、wctx 和 wct 是所需的参数，所以我使用了 state 参数，所以它们往返并取回它们：

```
protected void Page_Load(object sender, EventArgs e)
{
    if (Request.QueryString["code"] != null)
    {
        //I'm coming from google, already authenticated
        FormsAuthentication.SetAuthCookie("johannsw", false);
        String lQueryStrings = HttpUtility.UrlDecode(Request.QueryString["state"]);
        lQueryStrings.Replace('?', '&');
        Response.Redirect("default.aspx" + "?" + lQueryStrings);

    }
    else
    {
        //I want to authenticate
        String lState = String.Empty;
        foreach (var key in Request.QueryString.AllKeys)
        {
            if (String.Equals("wa", key) ||
                String.Equals("wtrealm", key) ||
                String.Equals("wctx", key) ||
                String.Equals("wct", key))
                lState += key + "=" + Request.QueryString[key] + "&";
        }
        lState = lState.Remove(lState.Length - 1);

        Response.Redirect(
            "https://accounts.google.com/o/oauth2/auth?" +
            "response_type=code&" +
            "client_id=988046895016.apps.googleusercontent.com&" +
            "redirect_uri=" + HttpUtility.UrlEncode("https://localhost/GmailSTS/login.aspx") + "&" +
            "scope=" + HttpUtility.UrlEncode("https://www.googleapis.com/auth/userinfo.email") + "&" +
            "state=" + HttpUtility.UrlEncode(lState)
            );
    }
} 
```

但现在我收到一条错误消息，提示“不允许使用 HTTP 动词 POST 访问路径 '/WebSite1/'。”

有什么提示吗？谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-05T14:24:28.673

好吧，我终于成功了。这是我解决它的方法，以防万一它帮助别人：

登录.aspx.cs

```
protected void Page_Load(object sender, EventArgs e)
{
    if (Request.QueryString["code"] != null && Request.QueryString["error"] != "access_denied")
    { 
        // If I got code and no error then 
        // ask for access_code so I can get user email

        //Here I ask for the access_code.
        WebRequest requestLogIn = null;
        Stream stream = null;
        WebResponse response = null;
        StreamReader reader = null;

        string sendData = "code=" + Request.QueryString["code"] + "&";
        sendData += "client_id=" + ObtenerClientID() + "&";
        sendData += "client_secret=" + ObtenerClientSecret() + "&";
        sendData += "redirect_uri=" + System.Configuration.ConfigurationManager.AppSettings["urlLogin"] + "&"; //TODO: ver si es necesario
        sendData += "grant_type=authorization_code";

        requestLogIn = WebRequest.Create("https://accounts.google.com/o/oauth2/token");

        requestLogIn.Method = "POST";
        requestLogIn.ContentType = "application/x-www-form-urlencoded";

        byte[] arrayToSend = Encoding.UTF8.GetBytes(sendData);
        requestLogIn.ContentLength = arrayToSend.Length;

        stream = requestLogIn.GetRequestStream();
        stream.Write(arrayToSend, 0, arrayToSend.Length);
        stream.Close();

        response = requestLogIn.GetResponse();

        if (((HttpWebResponse)response).StatusCode == HttpStatusCode.OK)
        {
            stream = response.GetResponseStream();
            reader = new StreamReader(stream);
            string responseValue = reader.ReadToEnd();
            reader.Close();

            var lJSONResponse = new JavaScriptSerializer().Deserialize<JSONResponseToken>(responseValue);

            //Now that I have the access_code ask for the user email so I can match him in my base and load claims.

            WebRequest myRequest = WebRequest.Create("https://www.googleapis.com/oauth2/v2/userinfo");
            myRequest.Method = "GET";

            myRequest.Headers.Add("Authorization", "Bearer " + lJSONResponse.Access_Token);

            response = myRequest.GetResponse();
            if (((HttpWebResponse)response).StatusCode == HttpStatusCode.OK)
            {
                stream = response.GetResponseStream();
                reader = new StreamReader(stream);
                responseValue = reader.ReadToEnd();

                var lUserMail = new JavaScriptSerializer().Deserialize<JSONResponseUserMail>(responseValue);

                // User is authenticated
                FormsAuthentication.SetAuthCookie(lUserMail.Email, false);

                // default.aspx will load claims
                Response.Redirect("default.aspx?" + Request.QueryString.ToString());
            }
        }

    }
    else
    {
        //redirect to google for login.

        //Save original url in a cookie for later use.
        Guid lGuid = Guid.NewGuid();
        CreateContextCookie(lGuid.ToString(), this.Request.Url.AbsoluteUri);

        Response.Redirect(
            "https://accounts.google.com/o/oauth2/auth?" +
            "response_type=code&" +
            "client_id=" + ObtenerClientID() + "&" +
            //I want to return here again
            "redirect_uri=" + HttpUtility.UrlEncode(System.Configuration.ConfigurationManager.AppSettings["urlLogin"]) + "&" + 
            //Add scope so I can get user mail.
            "scope=" + HttpUtility.UrlEncode("https://www.googleapis.com/auth/userinfo.email") + "&" +
            //Reference to the cookie so I can get the original url again
            "state=" + HttpUtility.UrlEncode(lGuid.ToString())
            );
    }
} 
```

默认.aspx.cs：

protected void Page_PreRender（对象发送者，EventArgs e）{

```
 String lCode = Request.QueryString["code"];
    String lSTate = Request.QueryString["state"];
    var ctxCookie = this.Request.Cookies[lSTate];

    var requestMessage = (SignInRequestMessage)WSFederationMessage.CreateFromUri(new Uri(ctxCookie.Value));
    //Erase cookie
    var contextCookie = new HttpCookie(lSTate)
    {
        Expires = DateTime.UtcNow.AddDays(-1)
    };

    //process login request
    SecurityTokenService sts =
        new CustomSecurityTokenService(CustomSecurityTokenServiceConfiguration.Current);
    SignInResponseMessage responseMessage =
        FederatedPassiveSecurityTokenServiceOperations.ProcessSignInRequest(requestMessage, this.User, sts);
    FederatedPassiveSecurityTokenServiceOperations.ProcessSignInResponse(responseMessage, this.Response);

    this.Response.Cookies.Add(contextCookie);
} 
```

# java - 这个 LinkedList 结果有什么问题？

> ID：10855432
> 
> 赞同：0
> 
> 时间：2012-06-01T18:19:31.017
> 
> 标签：java, data-structures, linked-list

我试图弄清楚这个 LinkedList 实现有什么问题。结果不是我预期的，我以为应该是：9 4 2 7 5。但是，当我运行它时，只添加了5。有人可以解释为什么吗？非常感谢！

```
public class LinkedList {

    LinkedList next;
    int value;

    public LinkedList(int value) {
        this.value = value;
        next = null;
    }

    public void add(int n, LinkedList k) {  
        LinkedList node = new LinkedList(n);
        node.next = k;
        k = node;
    }
}

public class LinkedListDemo {

    public static void main(String[] args) {
        LinkedList l = new LinkedList(5);

        l.add(7,l);
        l.add(2,l);
        l.add(4,l);
        l.add(9,l); 

        while(l != null) {
            System.out.println(l.value);
            l = l.next;
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-01T18:24:51.817

您正在丢失对 k 的更改，因为 Java 正在按值传递对 k 的引用。这意味着当方法退出时，分配 k = node 不会持续存在。

查看此[问题](https://stackoverflow.com/questions/40480/is-java-pass-by-reference)以获取有关该问题的更多信息:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-01T18:25:17.473

在前面添加需要更改第一个节点，一个解决方案：

```
public LinkedList add(int n){
    LinkedList node = new LinkedList(n);

    node.next = this;
    return node;
}

l = l.add(7); 
```

# mysql - 在多对多表中查找双向绑定

> ID：10855438
> 
> 赞同：1
> 
> 时间：2012-06-01T18:20:02.030
> 
> 标签：mysql, sql

我有一个多对多的关系`R`（两列绑定表，两列都是同一个表的外键）。现在，我想找到所有`x, y`这样的对`x,y in R`和`y,x in R`。当我的表包含数十万行时，最快的方法是什么？我正在使用mysql。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-01T18:26:20.590

```
SELECT  LEAST(x, y) l, GREATEST(x, y) g
FROM    r
GROUP BY
        l, g
HAVING  COUNT(*) > 1 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-01T18:29:39.323

最快的方法大概是这样的：

```
select (case when x < y then x else y end) as themin,
       (case when x < y then y else x end) as themax
from (select distinct x, y from R) r
group by (case when x < y then x else y end), (case when x < y then y else x end)
having count(*) > 1 
```

这会对 x 和 y 值进行排序，因此当您对它们进行分组时，无论原始顺序如何，它们都是按规范顺序排列的。

You can dispense with the "select distinct" if you know the pairs are already distinct in the R table.

The alternative is some sort of self join (either explicitly or using IN or NOT IN). You can try different ways, but I think this is probably the fastest.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-01T18:25:49.647

做一个自我加入：

```
SELECT  *
FROM    R T1
        INNER JOIN R T2
            ON T1.X = T2.Y
            AND T1.Y = T2.X 
```

**附录**

如果您不想返回重复的行（即 1、2 和 2、1），您可以使用：

```
SELECT  *
FROM    R T1
        INNER JOIN R T2
            ON T1.X = T2.Y
            AND T1.Y = T2.X
WHERE   T1.X < T1.Y; 
```

但是，如果您不想返回重复的行，我怀疑 Quassnoi 的解决方案可能会执行得更好，但这将取决于您的数据和指标。

# javascript - 警报会截断我的数据，我该如何查看？

> ID：10855439
> 
> 赞同：0
> 
> 时间：2012-06-01T18:20:02.223
> 
> 标签：javascript

alert() 有最大长度吗？

如果是这样，有没有办法克服它......最大长度更大的不同工具？

这是来自警报的大量输出...注意在最后被截断。截断的内容在浏览器中呈现，所以我知道它在那里。

```
|<!--p|2--><!--FRAMEWORK
-->
    <div id="Ba">
      <div id="Ba1">

<!--ACCOUNT
--->

<div id="account">
  <img id="picture" class="b" src="foo/images/generic_small.jpg" alt="">
  </img>
  <div id="wrap_menu_new">
    <p id="top_new">
      Test Account    </p>
    <div id="wrap_drop_down_new">
      <p id="signout_button" class="drop_down_new">Sign Out
      </p>
      <p id="settings_button" class="drop_down_new">Settings
      </p>
    </div>
  </div>
</div>

<!--FRAMEWORK
--->

      </div>
    </div>
    <div id="Bb">
      <div id="Bb1">

<!--BOOKMARKS 
--->

<div id="bookmark_hold">
  <form id="bookmark" method="post" name="bookmark">
    <div id="bookmark_url_wrap">
      <input id="bookmark_input_url" name="url" type="text" maxlength="2048" class="bookmark">
        <p id="bookmark_label_url">Url
        </p>
      </input>
    </div>
    <div id="bookmark_title_wrap">
      <input id="bookmark_input_title" name="title" type="text" maxlength="32" class="bookmark">
        <p id="bookmark_label_title">Title
        </p>
      </input>
    </div>
    <div id="bookmark_tag_wrap">
      <input id="bookmark_input_tag" name="tag" type="text" maxlength="8" class="bookmark">
        <p id="bookmark_label_tag">Tag
        </p>
      </input>
    </div>        
    <input type="hidden" name="domain" value="not_domain">
    </input>
    <input type="hidden" name="favicon" value="not_favicon">
    </input>
    <p id="bookmark_flip_button">Delete
    </p>
    <p id="bookmark_add_button">Add
    </p>
    <div id="bookmark_response" class="response">
    </div>
  </form>
  <div id="tag_bookmark_fill">
    <div id="tag_fill">

    <!--TAG FILL 
    -->

    </div>
    <div id="space">
    </div>
    <div id="bookmark_fill">

    <!--BOOKMARK FILL 
    -->

    </div>
  </div>
</div>

<!--TWEETS 
-->

<div id="tweet_hold">
  <form id="tweet" method="post" name="tweet">
    <div id="tweet_input_wrap">
      <input id="tweet_input" name="tweet" type="text" maxlength="40">
        <p id="tweet_label">Comment
        </p>
      </input>
    </div>
    <p id="tweet_button" href="javascript:void(0)">Share
    </p>
    <div id="tweet_response" class="response">
    </div>
    <div id="tweet_fill">
      <!--TWEET FILL 
      -->
    </div>
  </form>
</div>

<!--SETTINGS
-->

<form id="privacy">

  <input type="radio" id="radio1" name="rdo">
  <label for="radio1"></label>  
  <p class="privacy_title">Normal</p>
  <p class="privacy_content">Your bookmarks are posted to the feed.</p>

  <input type="radio" id="radio2" name="rdo">
  <label for="radio2"></label>    
  <p class="privacy_title">Private</p>
  <p class="privacy_content">Your bookmarks are not posted to the feed.</p>

<!--
  <input type="radio" id="radio3" name="rdo">
  <label for="radio3"></label>
  <p class="privacy_title">Secret</p>
  <p class="privacy_content">Same as private and all of your data is encrypted using NSA approved algorithms.</p>
-->

    <p id="save_button" class="wordpress">Save
    </p>
    <p id="cancel_button" class="wordpress">Cancel
    </p>

</form>

<!--FRAMEWORK 
--->

      </div>
    </div>

<!--DYNAMIC CONTENT 
-->

<script type='text/javascript'>new Arc.Shared().set( 'load_on', 1 );</script><div id='bookmark_data'>[{"id":"1","0":"1","title":"ebay ","1":"ebay ","url":"http:\/\/ebay.com","2":"http:\/\/ebay.com","domain":"ebay.com","3":"ebay.com","tag":"buy","4":"buy","favicon":"http:\/\/www.ebay.com\/favicon.ico","5":"http:\/\/www.ebay.com\/favicon.ico"},{"id":"1","0":"1","title":"gilt","1":"gilt","url":"http:\/\/www.gilt.com\/","2":"http:\/\/www.gilt.com\/","domain":"gilt.com","3":"gilt.com","tag":"buy","4":"buy","favicon":"http:\/\/assets2.giltcdn.com\/assets\/201205231954-27b1d5fa2c\/images\/default\/util\/favicon.ico","5":"http:\/\/assets2.giltcdn.com\/assets\/201205231954-27b1d5fa2c\/images\/default\/util\/favicon.ico"},.... 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-01T18:22:13.510

`alert`是的，浏览器确实限制了消息的最大长度。

为什么你总是想要`alert()`这么大的文本？对于调试，您应该使用`console.log()`适用于所有现代浏览器的哪个，或者创建一个 div/textarea 并在其中显示数据。

# java - 独特的一对值 + 休眠和批量插入

> ID：10855440
> 
> 赞同：0
> 
> 时间：2012-06-01T18:20:15.480
> 
> 标签：java, hibernate, object

我的对象： http: [//pastebin.com/FWEGwcL0](http://pastebin.com/FWEGwcL0)

我需要防止添加已经存在的夫妇（姓名；姓氏）的行。即：我可以添加 (John; Brown)、(John; White)、(Louise; Brown)，但我应该阻止添加另一个 (John; Brown)。

当我保存对象时，我会保存一个列表。这意味着如果我将密钥放在 DB 上让这对夫妇（姓名，姓氏）唯一，我担心当我保存对象列表时，如果一个失败，所有其他值也会失败。

我怎样才能防止这种情况？

非常感谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-01T18:40:12.887

不幸的是，如果您附加了实例，JPA 中的异常是不可恢复的。

从规范：

> 3.3.2 事务回滚 对于事务范围和扩展的持久性上下文，事务回滚会导致所有预先存在的托管实例和已删除的实例[31] 分离。实例的状态将是事务回滚时实例的状态。事务回滚通常会导致持久性上下文在回滚时处于不一致的状态。特别地，版本属性的状态和生成的状态（例如，生成的主键）可能不一致。因此，以前由持久性上下文管理的实例（包括在该事务中持久化的新实例）可能无法以与其他分离对象相同的方式重用——例如，它们在传递给合并操作时可能会失败。 [32 ]

这意味着一旦遇到异常，您就不能将该会话用于任何进一步的数据库操作。

这意味着您必须创建一个新会话，然后再次开始您的事务。

如果您直接使用 hibernate API 来管理事务，那么 Hibernate 也是如此。

> 12.2.3\. 异常处理 如果 Session 抛出异常，包括任何 SQLException，立即回滚数据库事务，调用 Session.close() 并丢弃 Session 实例。Session 的某些方法不会使会话保持一致状态。Hibernate 抛出的任何异常都不能被视为可恢复的。通过在 finally 块中调用 close() 确保 Session 将被关闭。

处理此问题的一种方法是您不使用托管实例，而是使用分离实例，在这种情况下，您将在每次数据库操作成功与否之后关闭会话或 entityManager。

在这种情况下，一旦关闭会话，您的对象就会分离，进一步的异常不会对它们产生任何影响。

看到一篇不错的[文章](http://weblogs.java.net/blog/blog/davidvc/archive2007/04/jpa_and_rollbac.html)

# php - 如何从 php 脚本中启动 Jquery 获取请求？

> ID：10855441
> 
> 赞同：0
> 
> 时间：2012-06-01T18:20:19.080
> 
> 标签：php, jquery, ajax

我有一个画廊，里面有一个大的图像滑块和一个在 php 中工作的小缩略图网格，但我需要一个 javascript 函数来交换和重用这个函数来交互式地加载新的图像和缩略图。如何将 start 参数传递给 Jquery 函数以填充图像滑块和网格？目前，我正在使用 start 参数为文档编写一个 href，并且在 document.load 函数中我废弃了这个 href 并触发了一个 getjson 函数来从我的数据库中提取记录？

这是我的 Jquery，它在我的菜单 li 文档子树中查找第一个 href，并将其用作获取参数以从我的数据库中提取记录：

```
 $j("#tx-gallery-pi1 #menu li").click(function() {  
     $j.getJSON($j(this).find('a').attr('href'), function(json) {
    var container = $j('#tx-gallery-pi1 #container');
    container.masonry();
    $j.each(json, function(idx, ele) {
      container.append($j("#brickTemplate").tmpl(ele).css({
        "display": "block"
      })).masonry('reload');

      container.imagesLoaded(function() {
        // bricks correct height
        var brick = $j("#tx-gallery-pi1 #container .brick"); 
        brick.each(function() {
          var content = $j(this).find(">div");
          var img = $j(this).find("img");
           content.css({
            height: img.attr("height")
           });
        });
      });
    });
  });
  return false; // don't follow the link!
}); 
```

}

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T18:31:29.670

当你用 php 创建一个 HTML 文档时，你可以说

```
<script>
    var startvar ='<?php echo($yourvariable); ?>';
</script> 
```

并稍后在站点中使用它。

您可以使用 AJAX 更新您的输出文档。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-01T18:27:19.340

你应该在你的控制器上以不同的动作分割那个php（比如get_thumbnails和get_image以及每个部分的html代码）并使用jQuery你可以做“$（thumbnails_container）.load（'/get_thumbnails.php'）”，它会是如果您至少输入相关代码，则更容易回答

如果您需要发布或获取参数，请检查 jQuery 的加载方法的文档

# java - java和网站重定向检测

> ID：10855444
> 
> 赞同：1
> 
> 时间：2012-06-01T18:20:38.340
> 
> 标签：java

我有java相关的问题...

网站 www.stationv3.com 每天都会更新（至少在大多数情况下，它有点不规则）。每次我使用地址 www.stationv3.com（使用浏览器）连接到一个站点时，它都会将我重定向到它的子页面 www.stationv3.com/date_of_latest_update.html

我正在尝试制作一个可以从网站上提取最新漫画的程序，但我不确定如何找到它的确切地址。但我知道我能够找出我是否能以某种方式找出我在每次连接时被重定向到哪里。用java可以吗？我知道它可以做各种古怪的事情，但我对互联网相关的东西还是新手......

我使用确切的站点名称只是为了方便您查看正在发生的事情......而且，我正在创建一个通用代码，它可以（通过一些修补）应用于以这种方式运行的任何站点。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-01T18:31:46.010

```
import java.net.*;
public class ShowStationV3Redirect {
public static void main(String[] args) throws Exception {
    URL url = new URL(args[0]);
    HttpURLConnection.setFollowRedirects(false);
    HttpURLConnection connection = (HttpURLConnection) url.openConnection();
    System.out.println("Response code = " + connection.getResponseCode());
    String header = connection.getHeaderField("location");
    if (header != null)
        System.out.println("www.stationv3.com redirected to " + header);
}
} 
```

上面的代码片段告诉你你被重定向到哪个 URL。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-01T18:47:21.540

我想你可能只是觉得：

```
http://www.stationv3.com/comics/{yyyy}{mm}{dd}sv3.gif 
```

忘记重定向问题。您可以使用此代码（确实未经测试）：

```
URL server = new URL("<put here the image URL>");
HttpURLConnection connection = (HttpURLConnection)server.openConnection();
connection.setRequestMethod("GET");
connection.setDoInput(true);
connection.setDoOutput(true);
connection.setUseCaches(false);
connection.addRequestProperty("Accept","image/gif");
connection.addRequestProperty("Accept-Encoding", "gzip, deflate");
connection.connect();
InputStream is = connection.getInputStream();       
OutputStream os = new FileOutputStream("c:/mycomic.gif");

byte[] buffer = new byte[1024];     
int byteReaded = is.read(buffer);
while(byteReaded != -1)
{
    os.write(buffer,0,byteReaded);
byteReaded = is.read(buffer);
}

os.close(); 
```

# c# - 为什么 Microsoft 从 MVC4 RC 的模板中删除基于 Ajax 的登录和注册工作流？

> ID：10855445
> 
> 赞同：3
> 
> 时间：2012-06-01T18:20:44.620
> 
> 标签：c#, asp.net, json, asp.net-mvc-4

我在 beta 软件的 AccountController.cs 中没有看到以下 json 方法。

```
[AllowAnonymous]
[HttpPost]
public JsonResult JsonLogin(LoginModel model, string returnUrl)

[AllowAnonymous]
[HttpPost]
public ActionResult JsonRegister(RegisterModel model) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-02T14:20:22.917

可能是因为 ajax 概念，如异步 http 请求、回调等，对于初学者来说有点高级。没有这些“复杂性”，MCV 项目模板对初学者更友好，可以得到更广泛的接受。另一方面，更熟练的用户能够自己弄清楚如何对他们的应用程序进行 ajaxify。就个人而言，我希望 Microsoft 在“创建项目”对话框中提供“启用 ajax 方法”复选框。

# sparql - 使用 SPARQL 提取 dbpedia 实体的层次结构

> ID：10855450
> 
> 赞同：3
> 
> 时间：2012-06-01T18:21:26.680
> 
> 标签：sparql, semantic-web, dbpedia

我正在尝试使用[SPARQL 端点](http://dbpedia.org/sparql)为 DBpedia 资源提取 Wikipedia 类别或 Yago 分类的层次结构。例如，我想以实体的分层形式找出所有可能的类别和类，例如[http://dbpedia.org/resource/Nokia](http://dbpedia.org/resource/Nokia)，如事物 → 组织 → 公司 → ... → 诺基亚。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-06-24T11:27:41.127

一个简单的 SPARQL 选择可以检索您感兴趣的信息，尽管它不会按层次结构*排列*。您对获取资源的所有类型以及`rdfs:subClassOf`它们之间的关系感兴趣。这是一个非常简单的[诺基亚](http://dbpedia.org/resource/Nokia)查询，可以在[DBpedia SPARQL 端点上运行](http://dbpedia.org/sparql)

```
SELECT * WHERE {
  dbpedia:Nokia a ?c1 ; a ?c2 .
  ?c1 rdfs:subClassOf ?c2 .
} 
```

[SPARQL 结果](http://dbpedia.org/sparql?default-graph-uri=http%3A%2F%2Fdbpedia.org&query=SELECT+%2a+WHERE+%7B%0D%0A++dbpedia%3ANokia+a+%3Fc1+%3B+a+%3Fc2+.%0D%0A++%3Fc1+rdfs%3AsubClassOf+%3Fc2+.%0D%0A%7D&format=text%2Fhtml&timeout=30000&debug=on)

如果您将该结果集中的每一对类视为有向边并执行[拓扑排序](http://en.wikipedia.org/wiki/Topological_sorting)，那么您将看到诺基亚资源所属的类的层次结构。实际上，由于将其视为图可能很方便，因此您可以使用 SPARQL 构造查询以 RDF 图的形式获取它。

```
CONSTRUCT WHERE {
  dbpedia:Nokia a ?c1 ; a ?c2 .
  ?c1 rdfs:subClassOf ?c2 .
} 
```

[SPARQL 结果](http://dbpedia.org/sparql?default-graph-uri=http%3A%2F%2Fdbpedia.org&query=CONSTRUCT+WHERE+%7B%0D%0A++dbpedia%3ANokia+a+%3Fc1+%3B+a+%3Fc2+.%0D%0A++%3Fc1+rdfs%3AsubClassOf+%3Fc2+.%0D%0A%7D&format=text%2Frdf%2Bn3&timeout=30000&debug=on)

构造查询生成此图（N3 格式）：

```
@prefix rdfs:   <http://www.w3.org/2000/01/rdf-schema#> .
@prefix dbpedia-owl:    <http://dbpedia.org/ontology/> .
@prefix owl:    <http://www.w3.org/2002/07/owl#> .
@prefix yago:   <http://dbpedia.org/class/yago/> .
@prefix rdf:    <http://www.w3.org/1999/02/22-rdf-syntax-ns#> .
@prefix dbpedia:    <http://dbpedia.org/resource/> .

dbpedia-owl:Agent   rdfs:subClassOf owl:Thing .
dbpedia-owl:Company rdfs:subClassOf dbpedia-owl:Organisation .
dbpedia-owl:Organisation    rdfs:subClassOf dbpedia-owl:Agent .
yago:CompaniesBasedInEspoo  rdfs:subClassOf yago:Company108058098 .
dbpedia:Nokia   rdf:type    yago:CompaniesListedOnTheHelsinkiStockExchange ,
        owl:Thing ,
        yago:CompaniesBasedInEspoo ,
        dbpedia-owl:Agent ,
        yago:DisplayTechnologyCompanies ,
        yago:ElectronicsCompaniesOfFinland ,
        dbpedia-owl:Company ,
        dbpedia-owl:Organisation ,
        yago:Company108058098 ,
        yago:CompaniesEstablishedIn1865 .
yago:CompaniesEstablishedIn1865 rdfs:subClassOf yago:Company108058098 .
yago:CompaniesListedOnTheHelsinkiStockExchange  rdfs:subClassOf yago:Company108058098 .
yago:DisplayTechnologyCompanies rdfs:subClassOf yago:Company108058098 .
yago:ElectronicsCompaniesOfFinland  rdfs:subClassOf yago:Company108058098 . 
```

### 评论

上面的查询检索`rdf:type`诺基亚的层次结构。在问题中，您还提到了 Wikipedia 类别。`dcterms:subject`DBpedia 资源通过属性与其相应文章所属的 Wikipedia 类别相关联。然后，这些维基百科类别按层次结构构建`skos:broader`。不过，这些确实不是个人的*类型*。例如，数据包含：

```
dbpedia:Nokia dcterms:subject category:Finnish_brands
category:Finnish_brands skos:broader category:Brands_by_country 
```

虽然说诺基亚是芬兰品牌可能是有道理的，但说诺基亚*是**一个*品牌国家就没有多大意义了。

# web-services - Axis 2 和 Rampart - 为什么服务在请求中返回 wsse:Security 标头？

> ID：10855451
> 
> 赞同：2
> 
> 时间：2012-06-01T18:21:35.993
> 
> 标签：web-services, soap, https, axis2, rampart

我正在连接到安全服务。

我有一个配置为使用 jks 文件提供证书的 SOAP UI 项目，以及允许我获得有效响应的适当安全设置。

我已经使用 AXIS 2 和 Rampart 从 JAVA 项目创建 SOAP 请求。使用 TCPMon，我设法获取了 SOAP 请求。

当请求在 JAVA 项目中运行时，我只得到响应：

*org.apache.axis2.AxisFault：缺少 wsse：请求中的安全标头*

但是如果我接受相同的请求，在 TCPMon 中捕获并将其放入 SOAP UI 项目中，我会成功获得响应。

有人有什么想法吗？

```
<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/">  <soapenv:Header>  
<wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd"  
soapenv:mustUnderstand="1">  
  <wsu:Timestamp xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd"  
  wsu:Id="Timestamp-1">  
    <wsu:Created>2012-06-01T15:09:12.520Z</wsu:Created>  
    <wsu:Expires>2012-06-01T15:14:12.520Z</wsu:Expires>  
  </wsu:Timestamp>  
  <wsse:BinarySecurityToken xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd"  
  EncodingType="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-soap-message-security-1.0#Base64Binary"  
  ValueType="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0#X509v3"  
  wsu:Id="CertId-ECDB0E....01">  
  MIID4DCCA0mgAwIBAgIBFjAN....</wsse:BinarySecurityToken>  
  <ds:Signature xmlns:ds="http://www.w3.org/2000/09/xmldsig#"  
  Id="Signature-2">  
    <ds:SignedInfo>  
      <ds:CanonicalizationMethod Algorithm="http://www.w3.org/2001/10/xml-exc-c14n#" />  
      <ds:SignatureMethod Algorithm="http://www.w3.org/2000/09/xmldsig#rsa-sha1" />  
      <ds:Reference URI="#Id-15..93">  
        <ds:Transforms>  
          <ds:Transform Algorithm="http://www.w3.org/2001/10/xml-exc-c14n#" />  
        </ds:Transforms>  
        <ds:DigestMethod Algorithm="http://www.w3.org/2000/09/xmldsig#sha1" />  
        <ds:DigestValue>  
        3wgvhJ8SI2soC..IA=</ds:DigestValue>  
      </ds:Reference>  
      <ds:Reference URI="#Timestamp-1">  
        <ds:Transforms>  
          <ds:Transform Algorithm="http://www.w3.org/2001/10/xml-exc-c14n#" />  
        </ds:Transforms>  
        <ds:DigestMethod Algorithm="http://www.w3.org/2000/09/xmldsig#sha1" />  
        <ds:DigestValue>  
        VlzDT69YEl..qTlbj0=</ds:DigestValue>  
      </ds:Reference>  
    </ds:SignedInfo>  
    <ds:SignatureValue>  
    ZCRypw/..=</ds:SignatureValue>  
    <ds:KeyInfo Id="KeyId-ECD..2">  
      <wsse:SecurityTokenReference xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd"  
      wsu:Id="STRId-ECDB0E6..6193">  
        <wsse:Reference URI="#CertId-ECDB0E..01"  
        ValueType="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0#X509v3" />  
      </wsse:SecurityTokenReference>  
    </ds:KeyInfo>  
  </ds:Signature>  
</wsse:Security></soapenv:Header><soapenv:Body xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd" wsu:Id="Id-15..3"><ns2:ProductSearchV2Request xmlns:ns2="http://product.webservice.sxc.com">   
  <ns2:Strength>900</ns2:Strength>  
  <ns2:MaximumResultSetInd>true</ns2:MaximumResultSetInd>  
  <ns2:MaximumResultSet>100</ns2:MaximumResultSet>  
</ns2:ProductSearchV2Request> 
```

这是我正在使用的 WS-POLICY 文档：

```
<?xml version="1.0" encoding="UTF-8"?>  
<!--  
 !  
 ! Copyright 2006 The Apache Software Foundation.  
 !  
 ! Licensed under the Apache License, Version 2.0 (the "License");  
 ! you may not use this file except in compliance with the License.  
 ! You may obtain a copy of the License at  
 !  
 !      http://www.apache.org/licenses/LICENSE-2.0  
 !  
 ! Unless required by applicable law or agreed to in writing, software  
 ! distributed under the License is distributed on an "AS IS" BASIS,  
 ! WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.  
 ! See the License for the specific language governing permissions and  
 ! limitations under the License.  
 !-->  
<wsp:Policy wsu:Id="SigOnly"  
            xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd"  
            xmlns:wsp="http://schemas.xmlsoap.org/ws/2004/09/policy">  
    <wsp:ExactlyOne>  
        <wsp:All>  
            <sp:AsymmetricBinding xmlns:sp="http://schemas.xmlsoap.org/ws/2005/07/securitypolicy">  
                <wsp:Policy>  
                    <sp:InitiatorToken>  
                        <wsp:Policy>  
                            <sp:X509Token  
                                    sp:IncludeToken="http://schemas.xmlsoap.org/ws/2005/07/securitypolicy/IncludeToken/AlwaysToRecipient">  
                                <wsp:Policy>  
                                    <sp:RequireThumbprintReference/>  
                                    <sp:WssX509V3Token10/>  
                                </wsp:Policy>  
                            </sp:X509Token>  
                        </wsp:Policy>  
                    </sp:InitiatorToken>  
                    <sp:RecipientToken>  
                        <wsp:Policy>  
                            <sp:X509Token  
                                    sp:IncludeToken="http://schemas.xmlsoap.org/ws/2005/07/securitypolicy/IncludeToken/Never">  
                                <wsp:Policy>  
                                    <sp:RequireThumbprintReference/>  
                                    <sp:WssX509V3Token10/>  
                                </wsp:Policy>  
                            </sp:X509Token>  
                        </wsp:Policy>  
                    </sp:RecipientToken>  
                    <sp:AlgorithmSuite>  
                        <wsp:Policy>  
                            <sp:TripleDesRsa15/>  
                        </wsp:Policy>  
                    </sp:AlgorithmSuite>  
                    <sp:Layout>  
                        <wsp:Policy>  
                            <sp:Strict/>  
                        </wsp:Policy>  
                    </sp:Layout>  
                    <sp:IncludeTimestamp/>  
                    <sp:OnlySignEntireHeadersAndBody/>  
                </wsp:Policy>  
            </sp:AsymmetricBinding>  
            <sp:Wss10 xmlns:sp="http://schemas.xmlsoap.org/ws/2005/07/securitypolicy">  
                <wsp:Policy>  
                    <sp:MustSupportRefKeyIdentifier/>  
                    <sp:MustSupportRefIssuerSerial/>  
                </wsp:Policy>  
            </sp:Wss10>  
            <sp:SignedParts xmlns:sp="http://schemas.xmlsoap.org/ws/2005/07/securitypolicy">  
                <sp:Body/>  
            </sp:SignedParts>  
            <ramp:RampartConfig xmlns:ramp="http://ws.apache.org/rampart/policy">  
                <ramp:user>ctr</ramp:user>  
                <ramp:encryptionUser>ctr</ramp:encryptionUser>  
                <ramp:passwordCallbackClass>com.gtnet.rampart.PWCBHandler  
                </ramp:passwordCallbackClass>  

                <ramp:signatureCrypto>  
                    <ramp:crypto provider="org.apache.ws.security.components.crypto.Merlin">  
                        <ramp:property name="org.apache.ws.security.crypto.merlin.keystore.type">JKS</ramp:property>  
                        <ramp:property name="org.apache.ws.security.crypto.merlin.file">build\resources\qa.jks</ramp:property>  
                        <ramp:property name="org.apache.ws.security.crypto.merlin.keystore.password">123123</ramp:property>  
                    </ramp:crypto>  
                </ramp:signatureCrypto>  
            </ramp:RampartConfig>  

        </wsp:All>  
    </wsp:ExactlyOne>  
</wsp:Policy> 
```

谢谢艾伦

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-05T21:33:09.253

看起来好像错误不是出站请求，而是处理响应。响应没有安全标头，当我们尝试对其进行解密时，会发生异常。

我需要以某种方式更改我的 Rampart 配置以仅执行出站安全性，而不是入站

我会回来报告的：）

* * *

好的，问题是一旦使用 Rampart，它就会期望响应具有相同的安全标头。我解决问题的方法是删除 Rampart.mar 文件中流入安全性的处理程序。

我不确定这是否是最好的解决方法，但它对我们有用。

要删除流入处理程序：解压缩rampart.mar 文件

注释掉流入部分

压缩 META_INF 文件夹。然后将 .zip 文件重命名为 .mar

现在，当您使用它时，因为没有为流入定义处理程序，它将只使用标准的 Axis2 响应处理程序。

我想如果您有几个使用 Rampart 的项目，其中一些在响应中有安全标头，而有些没有，您将需要不同的方法。

* * *

这里详细介绍了另一种方法。这可能是一种更好的方法：

[http://blog.rampartfaq.com/2009/11/how-to-generate-non-secure-response-to.html](http://blog.rampartfaq.com/2009/11/how-to-generate-non-secure-response-to.html)

例外：

> org.apache.axis2.AxisFault：在org.apache.rampart.handler.RampartReceiver.setFaultCodeAndThrowAxisFault（RampartReceiver.java:180）在org.apache.rampart.handler.RampartReceiver.invoke（RampartReceiver.java）的请求中缺少wsse：Security标头:99) 在 org.apache.axis2.engine.AxisEngine.invoke(AxisEngine.java:251) 在 org.apache.axis2.engine 的 org.apache.axis2.engine.Phase.invoke(Phase.java:318)。 AxisEngine.receive(AxisEngine.java:160) 在 org.apache.axis2.description.OutInAxisOperationClient.handleResponse(OutInAxisOperation.java:364) 在 org.apache.axis2.description.OutInAxisOperationClient.send(OutInAxisOperation.java:417) 在 org .apache.axis2.description.OutInAxisOperationClient.executeImpl(OutInAxisOperation.java:229)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2019-10-08T23:28:40.123

经过大量导航，并多次阅读相同的页面，我终于得到了一个令我满意的解决方案。

从上一篇文章中我引用：“好的，问题是一旦 Rampart 被启用，它期望响应具有相同的安全标头。” （作为请求） **这绝对是真的！**

我觉得最好的方法可以在以下链接中找到：http: [//xacmlinfo.org/2012/11/09/disabling-ws-security-for-in-or-out-messages-in-axis2/](http://xacmlinfo.org/2012/11/09/disabling-ws-security-for-in-or-out-messages-in-axis2/)

但是，就我而言，我不想制作新模块，因此我决定在我的代码中模拟该模块。我试图分三个步骤来解释它。

1.  （首先）我使用默认策略（取自上一个链接）作为我的代码中的一种方法。（它适用于 Axis 1.6.2 和 Rampart 的兼容版本）

私有字符串 getPolicy() { return "xml for policy" }

**重要**的是，该方法必须将以下 xml 作为字符串返回（更好地阅读）

```
<wsp:Policy wsu:Id="emptryPolicy" 
xmlns:wsp="http://schemas.xmlsoap.org/ws/2004/09/policy"
xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
<wsp:ExactlyOne>
<wsp:All>
<sp:TransportBinding xmlns:sp="http://schemas.xmlsoap.org/ws/2005/07/securitypolicy"> 
<wsp:Policy>
</wsp:Policy>
</sp:TransportBinding>
</wsp:All>
</wsp:ExactlyOne>
</wsp:Policy> 
```

2.  （二）我根据前面的方法创建了一个Policy（对象）。

InputStream 流 = new ByteArrayInputStream(getPolicy().getBytes());

策略 p = PolicyEngine.getPolicy(stream);

3.  （三）我使用了KEY_RAMPART_IN_POLICY和KEY_RAMPART_OUT_POLICY的属性。

Stub._getServiceClient().getOptions().setProperty(RampartMessageData.KEY_RAMPART_OUT_POLICY, ***web service的安全策略***);

Stub._getServiceClient().getOptions().setProperty(RampartMessageData.KEY_RAMPART_IN_POLICY, p);

**重要** Web 服务的安全策略取决于 Web 服务使用的安全性...如果您的提供商在 wsdl 中提供了策略，您就不必为此苦恼​​...但在其他情况下，您只需使用壁垒政策。在壁垒站点中，对每种类型的安全策略都有非常清晰的示例描述。（UsernameToken Authentication、AsymmetricBinding 等）

这个例子塑造了一个有安全性的请求和没有安全性的响应。这个对我有用！

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2015-09-21T11:55:02.130

在我的情况下，同样的问题，但我通过更改存根中的肥皂请求版本名称空间 uri 获得了成功响应。我已将名称空间 uri 从“ [http://www.w3.org/2003/05/soap-envelope](http://www.w3.org/2003/05/soap-envelope) ”更改为“ [http://schemas.xmlsoap.org/soap/envelope/](http://schemas.xmlsoap.org/soap/envelope/) ”。

# matlab - matlab中的KNN算法

> ID：10855461
> 
> 赞同：1
> 
> 时间：2012-06-01T18:22:21.257
> 
> 标签：matlab, machine-learning, distance, classification, knn

我正在研究拇指识别系统。我需要实现 KNN 算法来对我的图像进行分类。据此，[它](http://www.mediafire.com/?l4hfthrt5ond8dk)只有 2 个测量值，通过它计算找到最近邻居的距离，但在我的情况下，我有 400 个 25 X 42 的图像，其中 200 个用于训练，200 个用于测试。我正在寻找几个小时，但我没有找到找到点之间距离的方法。

编辑：我已将第 200 张图像重新整形为 1 X 1050，并将它们存储在`trainingData`200 X 1050 的矩阵中。类似地我做了`testingData`.

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-02T20:50:41.240

下面是 k-最近邻分类的说明代码（使用的一些函数需要统计工具箱）：

```
%# image size
sz = [25,42];

%# training images
numTrain = 200;
trainData = zeros(numTrain,prod(sz));
for i=1:numTrain
    img = imread( sprintf('train/image_%03d.jpg',i) );
    trainData(i,:) = img(:);
end

%# testing images
numTest = 200;
testData = zeros(numTest,prod(sz));
for i=1:numTest
    img = imread( sprintf('test/image_%03d.jpg',i) );
    testData(i,:) = img(:);
end

%# target class (I'm just using random values. Load your actual values instead)
trainClass = randi([1 5], [numTrain 1]);
testClass = randi([1 5], [numTest 1]);

%# compute pairwise distances between each test instance vs. all training data
D = pdist2(testData, trainData, 'euclidean');
[D,idx] = sort(D, 2, 'ascend');

%# K nearest neighbors
K = 5;
D = D(:,1:K);
idx = idx(:,1:K);

%# majority vote
prediction = mode(trainClass(idx),2);

%# performance (confusion matrix and classification error)
C = confusionmat(testClass, prediction);
err = sum(C(:)) - sum(diag(C)) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-01T19:50:17.610

如果要计算向量和之间的[欧几里得距离](http://en.wikipedia.org/wiki/Euclidean_distance)，只需使用[Pythagoras](http://en.wikipedia.org/wiki/Pythagorean_theorem)。在 Matlab 中：`a``b`

```
dist = sqrt(sum((a-b).^2)); 
```

但是，您可能希望[`pdist`](http://www.mathworks.nl/help/toolbox/stats/pdist.html)一次为矩阵中的所有向量组合计算它。

```
dist = squareform(pdist(myVectors, 'euclidean')); 
```

我将列解释为要分类的实例，将行解释为潜在的邻居。不过这是任意的，您可以切换它们。

如果有一个单独的测试集，您可以计算到训练集中实例的距离`pdist2`：

```
dist = pdist2(trainingSet, testSet, 'euclidean') 
```

您可以使用此距离矩阵对向量进行 knn 分类，如下所示。我将生成一些随机数据作为示例，这将导致低（大约机会级别）准确性。但是当然你应该插入你的实际数据，结果可能会更好。

```
m = rand(nrOfVectors,nrOfFeatures); % random example data
classes = randi(nrOfClasses, 1, nrOfVectors); % random true classes
k = 3;  % number of neighbors to consider, 3 is a common value

d = squareform(pdist(m, 'euclidean')); % distance matrix
[neighborvals, neighborindex] = sort(d,1); % get sorted distances 
```

查看`neighborvals`和`neighborindex`矩阵，看看它们是否对您有意义。第一个是先前`d`矩阵的排序版本，后者给出了相应的实例编号。请注意，自距离（在 中的对角线上`d`）已浮动到顶部。我们对此不感兴趣（始终为零），因此我们将在下一步中跳过第一行。

```
assignedClasses = mode(neighborclasses(2:1+k,:),1); 
```

所以我们在 k 个最近邻中分配最常见的类！

您可以将分配的类与实际类进行比较以获得准确度分数：

```
accuracy = 100 *  sum(classes == assignedClasses)/length(classes);
fprintf('KNN Classifier Accuracy: %.2f%%\n', 100*accuracy) 
```

或者做一个混淆矩阵来查看分类的分布：

```
confusionmat(classes, assignedClasses) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-02T04:21:36.997

是的，knn 有一个功能：[knnclassify](http://www.mathworks.com/help/toolbox/bioinfo/ref/knnclassify.html)

玩弄你想要保留的邻居数量以获得最佳结果（使用混淆矩阵）。当然，此功能会处理距离。

# php - 在 PHP 中迭代 MySQL 结果时检测未来的重复值

> ID：10855462
> 
> 赞同：2
> 
> 时间：2012-06-01T18:22:27.747
> 
> 标签：php, mysql

我正在尝试计算一个团队在有序 MySQL 结果集中的排名，而我遇到的问题是检测*第一个*团队的平局以显示平局值。

例如，假设结果集如下：

```
team_id    pts
---------------
1          89
2          87
3          76
4          76
5          52 
```

我用以下 PHP 计算团队的排名：

```
$i = 0;
while($row = mysql_fetch_assoc($r)) { //iterate thru ordered (desc) SQL results
    ++$i;
    ($row['pts'] == $prev_val)
        ? $rnk = 'T-' . $rnk    //same as previous score, indicate tie
        : $rnk = $i;            //not same as previous score
    $rnk = str_replace('T-T-','T-',$rnk); //eliminate duplicative tie indicator
    if ($row['team_id'] == $team_id) { //current team in resultset matches team in question, set team's rank
        $arr_ranks['tp']['cat'] = 'Total Points';
        $arr_ranks['tp']['actual'] = number_format($row['pts'],1);
        $arr_ranks['tp']['league_rank'] = $rnk;
        $arr_ranks['tp']['div_rank'] = $div_rnk;
    }
    else if ($i == 1) { //current team is category leader (rank=1) and is not team in question, set current team as leader
        $arr_ranks['tp']['leader'] = "<a href='index.php?view=franchise&team_id=" . $row['team_id'] . "'>" . get_team_name($row['team_id']) . '</a> (' . number_format($row['pts'],1) . ')';
    }
    $prev_val = $row['pts']; //set current score as previous score for next iteration of loop
} 
```

上面的“平局”逻辑将把＃4队与＃3队平局，但**反之**则不然。

换句话说，对于#3 队，`$rnk = 3`，而对于#4 队，`$rnk = T-3`。（两者都**应该**是“T-3”。）

所以问题就变成了：我如何在遍历结果时“向前看”以找出当前分数是否与列表后面的分数相同/重复，这样我就可以将它与随后的欺骗一起视为并列？

谢谢。

* * *

编辑：如果我首先将结果存储在表中，我可以实现 Ignacio 的代码，`"wins"`如下所示：

```
select
    s1.team_id,
    t.division_id,
    sum(s1.score>s2.score) tot_wins,
            (   select count(*)
                from wins
                where team_id <> s1.team_id
                and wins > (select wins
                            from wins
                            where team_id = s1.team_id)
            )+1 as rnk
from
    scoreboard s1
    left join teams t
        on s1.team_id = t.team_id
    left join scoreboard s2
        on s1.year=s2.year and s1.week=s2.week and s1.playoffs=s2.playoffs and s1.game_id=s2.game_id and s1.location<>s2.location
group by s1.team_id
order by tot_wins desc; 
```

这给出了以下结果：

```
team_id    division_id   tot_wins  rnk
--------------------------------------
10         1             44        1
2          1             42        2
3          2             42        2
8          1             39        4
5          2             37        5
. . . 
```

但是，我突然想到我**已经得到了这个结果集**，这**实际上并没有解决我的问题**。

为避免混淆，我已经[单独发布了“跟进”问题](https://stackoverflow.com/questions/11001158/recognizing-duplicates-while-iterating-through-query-results)。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-01T20:40:39.387

我喜欢伊格纳西奥与他的答案的链接。但是，如果您仍然想使用 PHP，您可以按 SCORE 收集排名，并为每个分数分配团队。这可能不是最有效的方法，但它会起作用。

```
$ranks = array();
while ($row = mysql_fetch_assoc($result)) {
    $ranks[$row['pts']][] = $row['team_id'];
} 
```

`$ranks`将是一个看起来像...的数组

```
$ranks[89] = array(1);
$ranks[87] = array(2);
$ranks[76] = array(3,4);
$ranks[52] = array(5); 
```

使用`foreach`on `$ranks`，并仔细检查点的出现方式（升序或降序）。您可以使用 count() 查看是否有平局。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-01T18:36:01.973

```
$exists = array();
if ($row['team_id'] == $team_id && !in_array($row['pts'], $exists)) { //current team in resultset matches team in question, set team's rank
        $exists[] = $row['pts'];
        $arr_ranks['tp']['cat'] = 'Total Points';
        $arr_ranks['tp']['actual'] = number_format($row['pts'],1);
        $arr_ranks['tp']['league_rank'] = $rnk;
        $arr_ranks['tp']['div_rank'] = $div_rnk;
    } 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-13T18:15:16.723

这个问题已经在[这里回答了](https://stackoverflow.com/a/11019634/432321)。

查询：

```
SELECT a.team_id, a.wins, count(*) instances
FROM
    (SELECT
        s1.team_id,
        sum(s1.score>s2.score) wins
    FROM scoreboard s1
        LEFT JOIN scoreboard s2
            ON s1.year=s2.year
            AND s1.week=s2.week
            AND s1.playoffs=s2.playoffs
            AND s1.game_id=s2.game_id
            AND s1.location<>s2.location
    GROUP BY s1.team_id) AS a
    LEFT JOIN
        (SELECT
            sum(s1.score>s2.score) wins
        FROM scoreboard s1
            LEFT JOIN scoreboard s2
                ON s1.year=s2.year
                AND s1.week=s2.week
                AND s1.playoffs=s2.playoffs
                AND s1.game_id=s2.game_id
                AND s1.location<>s2.location
        GROUP BY s1.team_id) AS b
            ON a.wins = b.wins
GROUP BY a.team_id, b.wins
ORDER BY a.wins DESC; 
```

这给出了输出......

```
=================================
|team_id   | wins    |instances |
=================================
|10        | 44      |1         |
|2         | 42      |3         | //tie
|9         | 42      |3         | //tie
|5         | 42      |3         | //tie
|3         | 41      |1         |
|11        | 40      |1         |
|...       |         |          |
================================= 
```

然后，在 PHP 中，我将能够通过检查 when 来检测所有关系`$row['instances'] > 1`。

# javascript - 如何使用javascript更改选择列表jsp中的选项？

> ID：10855463
> 
> 赞同：0
> 
> 时间：2012-06-01T18:22:34.000
> 
> 标签：javascript, jsp, struts

我有这个 jsp 页面，如果单击单选按钮，其中一个小节应该变得不可见，并且选择列表中的选项应该改变。

```
<center>
  <span class="ReportSubsectionTitle">Report Type</span>
                                    <br />
 <html:radio  styleId="detail" property="reportOutputStyleID" onclick="doSummary();" value="1" />Pending Funding
                                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
 <html:radio  styleId="summary" property="reportOutputStyleID" onclick="doDetail();" value="2" />Previously Funded
 </center>
 <script>
 function doDetail(){   
    document.getElementById("narrowByDateRangeTop").checked = false;        
    document.getElementById("narrowByDateRangeBottom").checked = false;
    document.getElementById("narrowByDateRangeTop").disabled = true;    
    document.getElementById("narrowByDateRangeBottom").disabled = true;
    document.getElementById("dateRangeTypeID").disabled = true;
    document.getElementById("dateRangeLabel").disabled = true;
    document.getElementById("startDateStr").disabled = true;
    document.getElementById("startDateLabel").disabled = true;
    document.getElementById("startDateCalendarTrigger").disabled = true;
    document.getElementById("endDateStr").disabled = true;
    document.getElementById("endDateLabel").disabled = true;
    document.getElementById("endDateCalendarTrigger").disabled = true;
    document.getElementById("startDateTime").disabled = true;
    document.getElementById("endDateTime").disabled = true;

    document.getElementById("narrowByDateRangeTop").style.visibility = "hidden";    
    document.getElementById("narrowByDateRangeBottom").style.visibility = "hidden";
    document.getElementById("dateRangeTypeID").style.visibility = "hidden";
    document.getElementById("dateRangeLabel").style.visibility = "hidden";
    document.getElementById("startDateStr").style.visibility = "hidden";
    document.getElementById("startDateLabel").style.visibility = "hidden";
    document.getElementById("startDateCalendarTrigger").style.visibility = "hidden";
    document.getElementById("endDateStr").style.visibility = "hidden";
    document.getElementById("endDateLabel").style.visibility = "hidden";
    document.getElementById("endDateCalendarTrigger").style.visibility = "hidden";
    document.getElementById("startDateTime").style.visibility = "hidden";
    document.getElementById("endDateTime").style.visibility = "hidden";

    document.getElementById("DateSelection").style.visibility = "hidden";

 }
 function doSummary(){  

    document.getElementById("narrowByDateRangeTop").checked = true;     
    document.getElementById("narrowByDateRangeBottom").checked = false;
    document.getElementById("narrowByDateRangeTop").disabled = false;   
    document.getElementById("narrowByDateRangeBottom").disabled = false;
    document.getElementById("dateRangeTypeID").disabled = false;
    document.getElementById("dateRangeLabel").disabled = false;
    document.getElementById("startDateStr").disabled = false;
    document.getElementById("startDateLabel").disabled = false;
    document.getElementById("startDateCalendarTrigger").disabled = false;
    document.getElementById("endDateStr").disabled = false;
    document.getElementById("endDateLabel").disabled = false;
    document.getElementById("endDateCalendarTrigger").disabled = false;
    document.getElementById("startDateTime").disabled = false;
    document.getElementById("endDateTime").disabled = false;

    document.getElementById("narrowByDateRangeTop").style.visibility = "visible";   
    document.getElementById("narrowByDateRangeBottom").style.visibility = "visible";
    document.getElementById("dateRangeTypeID").style.visibility = "visible";
    document.getElementById("dateRangeLabel").style.visibility = "visible";
    document.getElementById("startDateStr").style.visibility = "visible";
    document.getElementById("startDateLabel").style.visibility = "visible";
    document.getElementById("startDateCalendarTrigger").style.visibility = "visible";
    document.getElementById("endDateStr").style.visibility = "visible";
    document.getElementById("endDateLabel").style.visibility = "visible";
    document.getElementById("endDateCalendarTrigger").style.visibility = "visible";
    document.getElementById("startDateTime").style.visibility = "visible";
    document.getElementById("endDateTime").style.visibility = "visible";
    document.getElementById("DateSelection").style.visibility = "visible";

 }
 </script> 
```

然后，我将这个小节标记为“日期选择”，我想让它变得不可见：

```
 <tr>
    <td align="center" style="padding-bottom: 5px;">
        <span id = "DateSelection" class="ReportSubsectionTitle">Date Selection</span>
    </td>
    <td align="center" style="padding-bottom: 5px;">
        <span class="ReportSubsectionTitle">Save Generated Report?</span>
    </td>
</tr>
<tr>
    <td valign="top" nowrap="nowrap">
        <%@ include file="dateSelectionSection1.jsp" %>
    </td>
    <td valign="top" nowrap="nowrap" style="padding-left: 10px;">
        <%@ include file="savedReportNameField.jsp" %>
    </td>
</tr> 
```

我有一个选择列表

```
 <span style="padding-left: 5px;">
                                    Date Type:
                                    <html:select property="dateTypeID">
                                        <html:options collection="dateTypes" property="id" labelProperty="name"/>
                                    </html:select>
                                </span> 
```

我尝试将 id 添加到选择中，但它收到一个错误，提示找不到标签。我想更改下拉菜单下的选择并锁定选择。

我尝试了 document.getElementById("dateTypeID").options[0].selected = 1。但是，之后没有任何变化。

我是 JSP 新手，不太清楚如何处理这个问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-02T08:00:03.867

假设这是您的选择语句：

```
<select name="master" size="1">
  <option value="newsvalue">News</option>
  <option value="webmastervalue">Webmaster</option>
  <option value="techvalue">Tech</option>
</select> 
```

在用户勾选单选按钮后调用的 javascript 函数中，您首先从 selectList 中删除所有选项，如下所示：

```
document.myform.master.options.length=0; 
```

然后你重新填充 selectList 做这样的事情：

```
document.myform.master.options[0]=new Option("Sports", "sportsvalue", true, false);  
document.myform.master.options[1]=new Option("Music", "musicvalue", false, false);
document.myform.master.options[2]=new Option("Movies", "moviesvalue", false, false); 
```

“new Option()”函数的数据类型是：

```
new Option(text, value, defaultSelected, selected); 
```

所以这在 JSP 中的处理方式与在 HTML 页面中的处理方式并没有什么不同。希望你发现这很有用:-)

# objective-c - 将整数转换为格式化字符串

> ID：10855466
> 
> 赞同：0
> 
> 时间：2012-06-01T18:23:02.233
> 
> 标签：objective-c, cocoa, nsstring, type-conversion

将整数转换为字符串时如何格式化？例如：

```
NSString *date = [NSString stringWithFormat:
       @"...somestuff... %+02d00", ...., gmtOffset]; 
```

以上不能正常工作。我想要的是，例如，+0200 出现。我应该认为 %+02d 会将我的整数 2 转换为“+02”。但它没有发生，我得到“+2”。为什么是这样？我做错了什么还是不支持某些格式？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-01T18:43:27.143

编辑：我终于明白了。适用于正数和负数并添加前导零。希望能帮助到你。

```
NSString *str = [NSString stringWithFormat:@"%+03d00", 2];
NSLog(@"%@", str); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-01T18:44:49.853

是的，亚当是对的：

```
 NSString *date = [NSString stringWithFormat:
                  @"%+03d00",2];
NSLog(@"date %@",date); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-01T20:29:54.930

文档说，有一个 + as 修饰符。但我不知道如何准确放置/使用它。

[http://pubs.opengroup.org/onlinepubs/009695399/functions/printf.html](http://pubs.opengroup.org/onlinepubs/009695399/functions/printf.html)

`+ The result of a signed conversion shall always begin with a sign ( '+' or '-' ). The conversion shall begin with a sign only when a negative value is converted if this flag is not specified.`

苹果文档中的链接：
[https ://developer.apple.com/library/mac/#documentation/Cocoa/Conceptual/Strings/Articles/formatSpecifiers.html](https://developer.apple.com/library/mac/#documentation/Cocoa/Conceptual/Strings/Articles/formatSpecifiers.html)

# variables - 变量命名方式

> ID：10855468
> 
> 赞同：0
> 
> 时间：2012-06-01T18:23:05.317
> 
> 标签：variables, language-agnostic, naming-conventions

您更喜欢使用什么以及最佳实践是什么 - 制作长但非常有意义的名称或制作较短的名称？

例如，如果您正在编写一个类 House，将是

```
int numberOfRooms; 
```

或者

```
int nRooms; 
```

当然，当您阅读外国代码或将您的代码交给某人时，长名称更易于理解，但它们会使代码更长 -> 更难阅读。所以我把它搞砸了。:)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-01T18:32:36.480

最重要的事情之一是理解代码。

命名变量 numberOfRooms 或 numOfRooms 比命名 nRooms 更好——nRooms 可能意味着别的东西，而 numOfRooms 只是长了 4 个字符——所以，我认为，值得把它命名更长一点。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-02T11:42:38.860

1.  无论您在哪里工作，都可以使用房屋命名风格。其他同事将来会维护您的代码，最好让他们更容易。

2.  如果您是为自己工作，请使用您正在使用的语言的标准命名样式。Delphi、Java、C# 等都有标准样式。

3.  如果您正在开展协作项目，请遵循该项目的房屋命名风格。

4.  正如米罗斯拉夫所说，在合理范围内，较长的名称通常更好。

# python - 如何使我的重载运算符与 Python 中的内置类型正确运行？

> ID：10855471
> 
> 赞同：3
> 
> 时间：2012-06-01T18:23:12.983
> 
> 标签：python, oop

感觉很简单，但我似乎找不到我需要的信息。假设我定义了一个类矩阵：

```
class Matrix():
    def __mul__(self, other):
    if isinstance(other, Matrix):
        #Matrix multiplication.
    if isinstance(other, int): #or float, or whatever
        #Matrix multiplied cell by cell. 
```

如果我将一个矩阵乘以一个 int，这可以正常工作，但由于 int 不知道如何处理矩阵，因此 3*Matrix 会引发 TypeError。我该如何处理？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-01T18:27:27.827

定义`__rmul__`覆盖`int()`'`__mul__`方法的调用：

```
class Matrix():
    # code

    def __rmul__(self, other):
        #define right multiplication here.

        #As Ignacio said, this is the ideal
        #place to define matrix-matrix multiplication as __rmul__() will
        #override __mul__().

    # code 
```

请注意，您[可以使用所有数字运算符来执行此操作](http://docs.python.org/reference/datamodel.html#emulating-numeric-types)。

另请注意，最好使用新样式类，因此将您的类定义为：

```
class Matrix(object): 
```

这将允许您执行以下操作：

```
if type(other) == Matrix: ... 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-01T18:27:14.023

也定义[`__rmul__()`](http://docs.python.org/reference/datamodel.html#object.__radd__)方法。

# ios - Xcode 分析错误，缺少库？

> ID：10855472
> 
> 赞同：5
> 
> 时间：2012-06-01T18:23:15.693
> 
> 标签：ios, xcode, memory, profiling

我已经尝试在互联网上找到类似的错误，但似乎我是唯一遇到此错误的人。

我所做的是，当我想开始在 Xcode 中分析我的应用程序时，它在编译应用程序后崩溃。在设置中，我已经编辑了方案以使用“调试”构建，但这没有改变。

崩溃报告显示了这个特定的错误消息。我已经尝试自己弄清楚了，但目前我被卡住了。我只想看看我的应用程序使用了多少内存以及它对内存的作用。

这里是错误信息。希望你能以某种方式帮助我：

> Dyld 错误消息：库未加载：@rpath/DTBinaryAnalysis.framework/Versions/A/DTBinaryAnalysis
> 引用自：/Applications/Xcode.app/Contents/Applications/Instruments.app/Contents/MacOS/Instruments 原因：找不到图像

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-11-19T09:35:11.490

`instruments`在运行端到端测试时，我遇到了类似的错误：

`$ instruments -s devices dyld: Library not loaded: @rpath/DTBinaryAnalysis.framework/Versions/A/DTBinaryAnalysis Referenced from: /Applications/Xcode.app/Contents/Applications/Instruments.app/Contents/Frameworks/InstrumentsPlugIn.framework/Versions/A/InstrumentsPlugIn Reason: no suitable image found. Did find: /Applications/Xcode.app/Contents/Applications/Instruments.app/Contents/Frameworks/InstrumentsPlugIn.framework/Versions/A/../../..//DTBinaryAnalysis.framework/Versions/A/DTBinaryAnalysis: mmap() error 1 at address=0x10A0DF000, size=0x00005000 segment=__TEXT in Segment::map() mapping /Applications/Xcode.app/Contents/Applications/Instruments.app/Contents/Frameworks/InstrumentsPlugIn.framework/Versions/A/../../..//DTBinaryAnalysis.framework/Versions/A/DTBinaryAnalysis /Applications/Xcode.app/Contents/Developer/usr/bin/../../../Applications/Instruments.app/Contents/Frameworks//DTBinaryAnalysis.framework/Versions/A/DTBinaryAnalysis: mmap() error 1 at address=0x10A0ED000, size=0x00005000 segment=__TEXT in Segment::map() mapping /Applications/Xcode.app/Contents/Developer/usr/bin/../../../Applications/Instruments.app/Contents/Frameworks//DTBinaryAnalysis.framework/Versions/A/DTBinaryAnalysis Trace/BPT trap: 5`

解决方案（很有趣）：重启。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-07T22:47:11.963

尝试从头开始重新安装 xcode，看看它是否对您有帮助。

这应该够了吧。安装通常应该为 xcode 安装各种工具。

# javascript - 将参数传递给 setTimeout 的闭包

> ID：10855473
> 
> 赞同：5
> 
> 时间：2012-06-01T18:23:16.163
> 
> 标签：javascript, jquery, internet-explorer-9, closures, document-ready

我遇到了一个问题，我的应用程序存在于 iframe 中，并且它是从外部域调用的。当 iframe 正确加载时，IE9 不会触发 load 事件，所以我认为我无法使用 setTimeout 来轮询页面。

无论如何，我想看看我的 setTimeout 完成通常需要多长时间，所以我希望能够记录 setTimeout 从我的回调中触发的延迟，但我不确定如何将该上下文传递给它，所以我可以记录它。

```
App.readyIE9 = function() {
  var timings = [1,250,500,750,1000,1500,2000,3000];    
  for(var i = 0; i < timings.length; i++) {
    var func = function() {
    if(App.ready_loaded) return;
      console.log(timings[i]);
      App.readyCallBack();
    };
    setTimeout(func,timings[i]);
  }
}; 
```

我不断收到 LOG: undefined 在 IE9 的控制台中。

完成此任务的正确方法是什么？

谢谢

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-06-01T18:25:58.450

当您的函数`setTimeout`在未来某个时间被调用时，循环的值`i`已经增加到它的范围的末尾，所以报告。`for``console.log(timings[i]);``undefined`

要`i`在该函数中使用，您需要在函数闭包中捕获它。有几种方法可以做到这一点。我建议使用自执行函数来捕获这样的值`i`：

```
App.readyIE9 = function() {
  var timings = [1,250,500,750,1000,1500,2000,3000];    
  for(var i = 0; i < timings.length; i++) {
    (function(index) {
        setTimeout(function() {
            if(App.ready_loaded) return;
            console.log(timings[index]);
            App.readyCallBack();
        }, timings[index]);
    })(i);
  }
}; 
```

作为对谁起作用的一点解释：`i`作为该函数的第一个参数传递给自执行函数。第一个参数被命名`index`并在每次调用自执行函数时被冻结，因此`for`循环不会在`setTimeout`执行回调之前导致它发生变化。因此，`index`在自执行函数内部引用将获得每个`setTimeout`回调的正确数组索引值。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2012-06-01T18:25:59.453

发生这种情况是因为您没有关闭`i`. `func`循环完成后，`i`是 8 ( `timings.length`)，它不存在于数组中。

你需要做这样的事情：

```
App.readyIE9 = function() {
  var timings = [1,250,500,750,1000,1500,2000,3000];    
  for(var i = 0; i < timings.length; i++) {
    var func = function(x) {
      return function(){
          if(App.ready_loaded) return;
          console.log(timings[x]);
          App.readyCallBack();
      };
    };
    setTimeout(func(i),timings[i]);
  }
}; 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-06-01T18:26:00.537

当您使用`setTimeout`或`setInterval`回调时，这是一个常见的问题。您应该将`i`值传递给函数：

```
var timings = [1, 250, 500, 750, 1000, 1500, 2000, 3000],
    func = function(i) {
        return function() {
            console.log(timings[i]);
        };
    };

for (var i = 0, len = timings.length; i < len; i++) {
    setTimeout(func(i), timings[i]);
} 
```

**演示：http:** [//jsfiddle.net/r56wu8es/](http://jsfiddle.net/r56wu8es/)

# asp.net - 为什么需要将我的应用程序池标识添加到 IIS_IUSRS 组？

> ID：10855490
> 
> 赞同：2
> 
> 时间：2012-06-01T18:25:08.953
> 
> 标签：asp.net, iis-7.5

我正在使用域帐户作为应用程序池标识的 Windows 2008 R2/IIS 7.5 服务器上设置 .NET v4.0 Web 应用程序。当我访问该站点时，我收到以下错误：

当前身份 () 没有对 'C:\Windows\Microsoft.NET\Framework\v4.0.30319\Temporary ASP.NET Files' 的写入权限

据此：[http](http://learn.iis.net/page.aspx/140/understanding-built-in-user-and-group-accounts-in-iis/) ://learn.iis.net/page.aspx/140/understanding-built-in-user-and-group-accounts-in-iis/将工作进程的身份添加到 IIS_IUSRS 组当过程开始时。这似乎适用于我在同一台服务器上运行的现有 .NET v2.0 应用程序（我不必将其域帐户应用程序池标识添加到 IIS_IUSRS 组）。我设置的第一个 .NET v4.0 Web 应用程序似乎不是这种情况。

将身份添加到组后，一切正常。我怀疑有些东西配置不正确，迫使我这样做。在推出更多站点/服务器之前，我想了解这一点。

在此先感谢您的帮助...

# java - linux上库的java文件夹在哪里

> ID：10855492
> 
> 赞同：0
> 
> 时间：2012-06-01T18:25:12.137
> 
> 标签：java, linux

我需要在 java 文件夹下找到 \jre\lib\ext 来添加库。而且我不确定如何找到它

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-03T22:13:37.110

用于`String extDir = System.getProperty("java.ext.dirs");`根据需要获取扩展 dir 路径（有关系统属性的更多信息可以在[这里](http://www.leepoint.net/notes-java/io/30properties_and_preferences/40sysprops/10sysprop.html)找到），设置路径并将 jar 文件写入该目录（小心捕获在编写过程中可能引发的任何 IOException，因为这文件夹通常是写保护的或需要 root/admin 权限）

正如评论中所引用的，这应该只在特殊情况下进行

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-03T22:47:52.827

正如大多数评论所说，不要这样做，另一种选择。

大多数应用程序都有一个*app* .jar 和一个 lib 文件夹，所有库 jar 都驻留在其中。在应用程序 jar 中有一个 META-INF/MANIFEST.MF，其类路径包括 lib jar。

作为一名开发人员，我使用 maven（如 ant、ivy）来构建基础结构，它就是这样做的。jar 来自本地 maven 存储库，其他来自远程存储库。maven 还使用不同版本的所有 jar 的本地存储库。远程存储库中缺少的罐子，如自己的编程，可以安装在那里。

BTW **/usr/lib/jvm/**包含 java 版本（do `which java`, `which javac`）。

# ruby-on-rails-3 - Rails 3.2 + 设计 2.1 + OmniAuth + Backbone.js 身份验证

> ID：10855494
> 
> 赞同：5
> 
> 时间：2012-06-01T18:25:17.833
> 
> 标签：ruby-on-rails-3, backbone.js, devise, omniauth

我目前使用 Devise 2.1 + Rails 3.2.x 来验证用户。我还将很快添加 OmniAuth-Facebook 和 Twitter 支持。

我想将这个现有的基础设施与 Backbone.js 一起使用。从身份验证的角度来看，您能否告诉我这是否是正确的工作流程？

1.  用户通过 Devise（或 OmniAuth）登录
2.  使用 Devise 的 Token Authenticatable 返回一个令牌？
3.  骨干以某种方式访问​​令牌并将其作为 API 调用的一部分附加？我不需要 API 来创建用户，这由 Devise 处理。

问题： 1\. 你会这样实施吗？2\. 关于#2 和#3 的任何建议/代码示例？3.您将如何处理授权？我不认为CanCan会起作用。

PS 我阅读了很多文章，包括：http: [//jessewolgamott.com/blog/2012/01/19/the-one-with-a-json-api-login-using-devise/](http://jessewolgamott.com/blog/2012/01/19/the-one-with-a-json-api-login-using-devise/)。他们似乎专注于使用 API 进行身份验证，而不是在身份验证完成后保护 API 资源。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-14T02:16:04.560

实际上，我通过以下方式更容易做到这一点：

用户通过 Devise/OmniAuth 登录，不需要创建身份验证令牌如果我使用启用 Devise 的相同操作来提供 REST API，它将自动使用会话信息进行身份验证，因此无需额外的令牌捕获/重新发送是需要的。

PS RABL 是为在 Rails 中创建 API 而生成的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-08T17:19:45.720

1.  工作流程是正确的。
2.  我在互联网上找到了一些零碎的东西，也许我以后可以在博客上发表一下
3.  正确的。您可以覆盖`Backbone.sync`，或者如果您使用 jQuery，您可以全局配置 jQuery。[这里的](https://stackoverflow.com/questions/7785079/how-use-token-authentication-with-rails-devise-and-backbone-js)例子

除非您希望客户端了解其角色，否则授权将在服务器端进行相同处理。在服务器端，您将通过其令牌找到当前用户并进行相应授权。如果您确实需要知道用户具有哪些角色，您可以在用户进行身份验证时发送角色。

# mysql - PDO - 更新和设置查询（2 个数组）

> ID：10855496
> 
> 赞同：0
> 
> 时间：2012-06-01T18:25:21.027
> 
> 标签：mysql, arrays, pdo

所以我有两个数组需要在 MySQL 中更新和设置。item_id [1,2,3] 和 item_order[2,1,3]

这是数组插入之前的项目表：

```
item_id item_order
  1         1 //should become 2
  2         2 // should become 1
  3         3 // should become 3 
```

数组应该成对插入，1-2、2-1、3-3。如何有效地使用准备好的语句执行此操作，以及如何测试数组项是否确实是数字？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T18:31:11.023

这是一个例子：

UPDATE mytable SET myfield = CASE other_field WHEN 1 THEN 'value' WHEN 2 THEN 'value' WHEN 3 THEN 'value' END WHERE id IN (1,2,3)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-02T06:06:43.457

假设您有这样的输入：

```
$item_id = array(1, 2, 3);
$item_order = array(2, 1, 3);
// and a PDO connection named $pdo 
```

你可以尝试这样的事情。（我还假设您已将 PDO 配置为[在出现问题时抛出异常](http://us.php.net/manual/en/pdo.error-handling.php)）。

```
function all_numbers($input) {
  foreach($input as $o) {
    if(!is_numeric($o)) {
      return false;
    }
  }
  return true;
}

if(count($item_id) != count($item_order)) {
  throw new Exception("Input size mismatch!");
}

if(!all_numbers($item_id) || !all_numbers($item_order)) {
  throw new Exception("Invalid input format!");
}

$pairs = array_combine($item_id, $item_order);
// now $pairs will be an array(1 => 2, 2 => 1, 3 => 3);

if($pdo->beginTransaction()) {
  try {
    $stmt = $pdo->prepare('UPDATE `items` SET `item_order` = :order WHERE `item_id` = :id');

    foreach($pairs as $id => $order) {
      $stmt->execute(array(
        ':id' => $id,
        ':order' => $order,
      ));
    }
    $pdo->commit();
  } catch (Exception $E) {
    $tx->rollback();
    throw $E;
  }
} else {
  throw new Exception("PDO transaction failed: " . print_r($pdo->errorInfo(), true));
} 
```

但是重新设计您的输入可能会更好 - 仅以`item_ids`所需的顺序传递并`item_order`自动计算它们的值。

# macos - 如何在 macOS 中使用 librtmp 编译 ffmpeg？

> ID：10855499
> 
> 赞同：3
> 
> 时间：2012-06-01T18:25:31.557
> 
> 标签：macos, rtmp, homebrew

我尝试通过这样的自制软件在 mac lion 中安装 ffmpeg：

```
brew install --use-clang ffmpeg --with-tools --with-ffplay --enable-librtmp 
```

但编译标志最终为

```
configuration: --disable-debug --prefix=/usr/local/Cellar/ffmpeg/0.6.2 --enable-shared --enable-pthreads --enable-nonfree --enable-gpl --disable-indev=jack --enable-libx264 --enable-libfaac --enable-libmp3lame --enable-libtheora --enable-libvorbis --enable-libvpx --enable-libxvid --enable-libfaad 
```

用 librtmp 安装 ffmpeg 的正确方法是什么？我也想运行像 blackdetect 这样的 libavfilters。

直接安装总是失败，缺少 RTMP_Socket() 所以我希望有一个自制的解决方案。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2015-06-03T12:20:28.653

您可以通过添加`--with-rtmpdump`标志（在安装 RTMPDump 之后）在构建中包含 librtmp。这些是我使用的命令：

```
brew install rtmpdump
brew install ffmpeg --with-x265 --with-rtmpdump 
```

现在我有 rtmp、rtmpe、rtmps、rtmpt 和 rtmpte 作为可用的协议！:)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-03T16:03:23.963

终于可以编译了！认为密钥可能一直在运行

```
export PKG_CONFIG_PATH=$PKG_CONFIG_PATH:/usr/local/lib/pkgconfig 
```

就在配置之前但不确定，因为根据标志我得到了不同的错误。我最终运行的[脚本（从其他来源修改）位于 github：](https://gist.github.com/2863964) [https ://gist.github.com/2863964](https://gist.github.com/2863964)

# iphone - NSDictionary 不存储信息

> ID：10855504
> 
> 赞同：0
> 
> 时间：2012-06-01T18:25:43.423
> 
> 标签：iphone, objective-c, cocoa-touch

由于某些奇怪的原因， golferStats 没有正确存储信息......

我把这段代码中的一堆东西删掉了，为什么仍然无法正常工作？

**问题：**最后一个 NSLOG 在它应该返回一个巨大的数组时返回 nil...

```
NSMutableDictionary *golferStats = [[NSMutableDictionary alloc] init];
golferStats = [userDefaults objectForKey:@"golferStats"];

[golferStats setObject:golferTwoIconCounter forKey:golferName]; //golferName is k

[userDefaults setObject:golferStats forKey:@"golferStats"];
[userDefaults synchronize];
NSLog(@"SAVED SCORE CARD");
NSLog(@"%@",[golferStats objectForKey:@"k"]); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-01T18:30:36.123

`NSMutableDictionary *golferStats = [[NSMutableDictionary alloc] init];`

~~`golferStats = [userDefaults objectForKey:@"golferStats"];`~~

...

`[golferStats release];`

您首先创建一个`NSDictionary`，然后在它之上分配，从而泄漏内存并可能`nil`从用户默认值中恢复。 `setObject:forKey:`在`nil`字典中是无操作的，然后您将其设置回用户默认值。

**编辑：**

尝试先检查是否有字典：

```
NSDictionary *golferStats = [userDefaults objectForKey:@"golferStats"];
if (golferStats == nil) {
    golferStates = [NSDictionary dictionary]; // this will not leak
}
... 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-01T18:46:21.430

如果要在字典已经存在的情况下保留字典的现有内容*，*请执行以下操作：

```
NSMutableDictionary *golferStats = [userDefaults objectForKey:@"golferStats"];
if (!golferStats) golferStats = [[[NSMutableDictionary alloc] init] autorelease];

[golferStats setObject:golferTwoIconCounter forKey:golferName];
[userDefaults setObject:golferStats forKey:@"golferStats"];
[userDefaults synchronize];

// no [golferStats release] because of autorelease above 
```

# c++ - C++：抛出异常会调用复制构造函数？

> ID：10855506
> 
> 赞同：1
> 
> 时间：2012-06-01T18:25:52.737
> 
> 标签：c++, visual-c++, exception

我们有一个自定义错误类，每当我们抛出异常时都会使用它：

```
class AFX_CLASS_EXPORT CCLAError : public CObject 
```

它定义了以下复制构造函数：

```
CCLAError(const CCLAError& src) { AssignCopy(&src); } // (AssignCopy is a custom function) 
```

它最初是用 MSVC6 (Visual Studio 2003) 编写和编译/链接的。我正在进行必要的更改以使其编译并链接到 MSVC8+（VS 2008+）

调用 msvc8 链接器时，出现以下错误：

```
LNK2001: unresolved external symbol "private: __thiscall CObject::CObject(class CObject const &)" (??0CObject@@AAE@ABV0@@Z) 
```

我明白错误告诉我什么：没有为 CObject 的某个子级定义复制构造函数，因此它一直沿继承树向上直到它遇到 CObject，因为没有定义复制构造函数。

我在编译定义并首先抛出 a 的库时第一次看到错误`CCLAError`，这就是为什么我要继续进行，好像这是原因。

我能够通过更改来解决错误

```
throw CCLAError( ... ) 
```

到

```
throw new CCLAError( ... ) 
```

和

```
catch(CCLAError& e)
{
   throw e;
} 
```

到

```
catch(CCLAError& e)
{
   throw;
} 
```

但是，我不明白为什么重新抛出捕获的异常会调用复制构造函数。我错过了一些完全明显的东西吗？随后，为什么删除包含对捕获的异常的引用的变量会导致复制构造函数不被调用？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-06-01T18:29:48.197

抛出的对象的类型必须是`throw`可复制的，因为表达式可能会复制其参数（副本可能会被省略，或者在 C++11 中可能会发生移动，但复制构造函数必须仍然是可访问和可调用的）。

使用重新抛出异常`throw;`不会创建任何副本。使用抛出捕获的异常对象`throw e;`将导致创建副本`e`。这与*重新抛出*异常不同。

您的“更新”代码无法按预期工作。 `catch (CCLAError&)`不会捕获 类型的异常`CCLAError*`，该类型是由 引发的异常的类型`throw new CCLAError(...);`。你需要抓住`CCLAError*`. 但是，不要这样做。按值抛出异常并按引用捕获。所有异常类型都应该是可复制的。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-06-01T18:30:07.260

> 但是，我不明白为什么重新抛出捕获的异常会调用复制构造函数。

它没有，但重新抛出抛出的异常是用`throw;`. 当您这样做时，`throw e;`您要求抛出捕获的异常的副本。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-06-01T18:31:34.170

几点：

首先不要调用`throw new foo()`使用`throw foo`

第二当你写：

```
catch(foo const &e) {
   throw e;
} 
```

您实际上创建了一个新异常，例如，如果抛出的异常是`foo`我调用的子类，`throw e`您将丢失此信息并实际使用复制构造函数`foo`从 e 生成 - 不管它是什么。

现在当你打电话

```
catch(foo const &e) {
   throw;
} 
```

您不会创建新异常，而是传播相同的异常。

所以：**永远不要**使用`throw e;`向前传播异常，使用`throw;`

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-01T18:37:15.670

当您抛出异常时，您要抛出的对象通常驻留在堆栈中。作为抛出过程的一部分，堆栈正在被清理，因此编译器必须制作一个可以在该点之后继续存在的副本。

当您使用 抛出一个对象时`new`，您不是在抛出实际的对象，而是在抛出一个指向该对象的指针。这意味着您的`catch`块还必须捕获指针而不是引用。不要忘记`delete`指向指针，否则会发生内存泄漏！

当 catch 块使用`throw;`而不是它时，`throw e;`它可以重用它之前制作的副本，并且不需要制作另一个副本。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-01T18:38:20.790

看来您误解了重新抛出的含义。当你这样做 -

```
catch(CCLAError& e)
{
   throw e;
} 
```

- 你不是在重新抛出。相反，正如您所观察到的，您确实在创建新异常的副本。相反（再次，正如您自己发现的那样），这在技术上是重新抛出的正确方法：

```
catch(CCLAError& e)
{
   throw;
} 
```

阅读 Stroustrup 的 TC++PL 中的第 14 章（14.3.1 处理重新抛出）。

此外，您不必这样做 -

```
throw new CCLAError( ... ) 
```

相反，做 -

```
throw CCLAError( ... ) 
```

-- 就像你以前做的那样，只能通过**CONST**引用接收（你不能持有对临时的引用）。

```
catch(const CCLAError &e) 
```

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2012-06-01T18:30:11.537

语言规范允许编译器根据需要制作尽可能多的原始对象副本。份数没有限制。

这意味着，您的自定义异常类必须具有*可访问*的复制构造函数，可以是编译器生成的，也可以是用户定义的。

# ruby-on-rails-3 - 带有rails 3.2.3和passenger 3.0.12的nginx 1.2.0 - 403错误

> ID：10855511
> 
> 赞同：0
> 
> 时间：2012-06-01T18:26:05.677
> 
> 标签：ruby-on-rails-3, nginx, passenger

乡亲

我正在尝试使用乘客 3.0.12 和 nginx 1.2 在 rails 3.2.3 上设置 ruby​​。我已按照说明使用乘客模块编译 nginx。以下是我的 nginx 配置。当我尝试转到根页面（使用 curl localhost）时，它给了我 403 禁止错误。它似乎没有将请求传递给乘客。如果我遗漏了一些简单的东西，请告诉我。谢谢，

```
worker_processes  1;

events {
    worker_connections  1024;
}

http {
    passenger_root /home/ubuntu/.rvm/gems/ruby-1.9.3-p194/gems/passenger-3.0.12;
    passenger_ruby /home/ubuntu/.rvm/wrappers/ruby-1.9.3-p194/ruby;
    rails_env development;

    include   mime.types;
    default_type  application/octet-stream;

    sendfile        on;
    keepalive_timeout  65;

    server {
        listen       80;
        server_name  localhost;
        passenger_enabled on;

        location / {
            root   /home/ubuntu/rails/myapp/public;
        }
    }

} 
```

**编辑** 如果我执行以下操作：1）创建一个新应用程序 - 虚拟 2）将 config.ru 更改为打印 'hello world' 3）将根更改为指向虚拟应用程序的公共目录

然后错误消失。

此外，如果我创建一个全新的 rails 应用程序，我可以访问默认的 rails 应用程序页面。我还尝试为整个 myapp 目录结构创建目录 perms 777。没有喜悦。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-01T20:07:18.063

解决了。​​passenger_enabled 子句必须移到 location 块内。

# asp.net - 使用 iTextSharp 将 2 个网格视图合并到一个生成的 PDF 文件中

> ID：10855513
> 
> 赞同：0
> 
> 时间：2012-06-01T18:26:15.050
> 
> 标签：asp.net, gridview, itextsharp

我正在使用 2 个网格视图。第一个启用了分页，每页允许的行数为一。第二个 gridview 将第一行中的值作为时间范围，每次我在 gridview1 上更改页面时，第二个 GV 都会根据 GV1 的值自动更改其内容。

以前，我能够使用 iTextSharp 生成 PDF 文件，只有一个 gridview 并且没有启用分页。但是现在我首先在启用分页的情况下苦苦挣扎，其次是将两个网格视图合并到一个 pdf 文件中。

有人知道我该怎么做吗？

提前致谢。

**编辑：**这是我使用 iTextSharp 从 gridview 生成 PDF 文件的代码。

```
using iTextSharp.text;
using iTextSharp.text.pdf;
using iTextSharp.text.html;
using iTextSharp.text.html.simpleparser;

StringWriter stw = new StringWriter();
HtmlTextWriter htextw = new HtmlTextWriter(stw);
gvReportes.AllowPaging = false;
gvReportes.HeaderRow.Style.Add("font-family", "Arial, Helvetica, sans-serif;");
gvReportes.HeaderRow.Style.Add("font-size", "7.20px");
gvReportes.HeaderRow.Style.Add("color", "#284775");
gvReportes.Style.Add("font-family", "Arial, Helvetica, sans-serif;");
gvReportes.Style.Add("font-size", "6px");
gvReportes.RenderControl(htextw);
Document document = new Document();
string path = "path.pdf";
PdfWriter writer = PdfWriter.GetInstance(document, new FileStream(path, FileMode.Create));
document.Open();
StringReader str = new StringReader(stw.ToString());
HTMLWorker htmlworker = new HTMLWorker(document);
htmlworker.Parse(str);
Response.Write(document);
document.Close(); 
```

这就是网格视图的显示方式，您可以看到 GV1 上的值“Salida”和“Llegada”作为时间范围在 GV2 上显示数据。

![网格视图](../Images/46e874c00b4c1a198865f9587edf99fb.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-15T08:59:23.040

```
protected void Button1_Click(object sender, EventArgs e)
    {
        Response.Clear(); //this clears the Response of any headers or previous output
        Response.Buffer = true; //ma
        Response.ContentType = "application/pdf";

        Response.AddHeader("content-disposition", "attachment;filename=injoin.pdf");

        Response.Cache.SetCacheability(HttpCacheability.NoCache);

        StringWriter sw = new StringWriter();

        HtmlTextWriter hw = new HtmlTextWriter(sw);

        GridView1.RenderControl(hw);

        StringReader sr = new StringReader(sw.ToString());

        Document pdfDoc = new Document(PageSize.A4, 10f, 10f, 10f, 0f);

        HTMLWorker htmlparser = new HTMLWorker(pdfDoc);

        PdfWriter.GetInstance(pdfDoc, Response.OutputStream);

        pdfDoc.Open();

        htmlparser.Parse(sr);

        pdfDoc.Close();

        Response.Write(pdfDoc);

        Response.End();  

    } 
```

# .net - joomla中的WPF Clickonce

> ID：10855516
> 
> 赞同：1
> 
> 时间：2012-06-01T18:26:22.633
> 
> 标签：.net, wpf, joomla

我有一个小型 wpf 应用程序，我只希望现有站点的注册用户可以访问它。我可以在 joomla 页面中通过 clickonce 发布我的 wpf 应用程序吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-07T20:06:16.110

是的，你可以，我最近才这样做。

1.  您应该使用如下设置发布您的 WPF 应用程序：

    *   发布文件夹：c:\MyPublishFolder
    *   安装文件夹：[http](http://www.yourwebsite.com/ClientBin/) ://www.yourwebsite.com/ClientBin/ （可以是我们网站上的任何文件夹）
2.  将 c:\MyPublishFolder 文件夹中的所有文件上传到[http://www.yourwebsite.com/ClientBin/](http://www.yourwebsite.com/ClientBin/)

3.  在 Joomla 中创建文章并确保编辑器是默认的 html 编辑器

4.  将以下链接添加到您的文章中，以允许用户安装您的应用程序：

<a href="/ClientBin/setup.exe">立即安装</a>

请注意，如果用户没有 .NET 4.0 或您开发的应用程序要使用的任何版本，那么它将由安装程序安装。

最后，只有注册用户才能访问下载页面，编辑链接到您的应用程序安装页面的菜单项并将访问权限设置为“已注册”

希望这可以帮助

# javascript - 谷歌地图标记事件监听器不起作用

> ID：10855517
> 
> 赞同：0
> 
> 时间：2012-06-01T18:26:26.097
> 
> 标签：javascript, google-maps-api-3, google-maps-markers

这是我的测试示例的链接和我试图弄清楚的代码。 [http://www.gaiser-vfx.com/media/maptest.html](http://www.gaiser-vfx.com/media/maptest.html)

```
<div id="googleMap">
    <script type="text/javascript" src="http://maps.google.com/maps/api/js?sensor=true"></script>
    <script type="text/javascript" src="http://code.google.com/apis/gears/gears_init.js"></script>
    <div id="map_canvas" style="width:100%; height:300px"></div>
<script>
    var noLocation = new google.maps.LatLng(52.1307, -3.78371);
    var initialLocation;
    var browserSupportFlag =  new Boolean();
    var map;
    var myOptions = {
        zoom: 6,
        draggable: true,
        minZoom: 0,
        maxZoom: 20,
        disableDefaultUI: true,
        zoomControl: true,
        scrollwheel: true,
        disableDoubleClickZoom: true,
        mapTypeId: google.maps.MapTypeId.false
    };

    map = new google.maps.Map(document.getElementById("map_canvas"), myOptions);
    google.maps.event.addListener(map, 'bounds_changed', function() {
    var center = map.getCenter();
    var zoomLevel = map.getZoom();
    $('#LocationLatitude').val(center.lat().toFixed(5));$('#LocationLongitude').val(center.lng().toFixed(5));$('#LocationZoom').val(zoomLevel);});

    var poly
    var path = new google.maps.MVCArray;
    poly = new google.maps.Polygon({
        strokeWeight: 3,
        fillColor: '#5555FF'
    });

    poly.setMap(map);
    poly.setPaths(new google.maps.MVCArray([path]));
    google.maps.event.addListener(map, 'click', addPoint);

    function addPoint(event) {
        path.insertAt(path.length, event.latLng);
        var marker = new google.maps.Marker({
        position: event.latLng,
        map: map,
        draggable: true
    });

    markers.push(marker);
    marker.setTitle("#" + path.length);
    google.maps.event.addListener(marker, 'click', function() {
        marker.setMap(null);
        for (var i = 0, I = markers.length; i < I && markers[i] != marker; ++i);
            markers.splice(i, 1);
            path.removeAt(i);
        });

        google.maps.event.addListener(marker, 'dragend', function() {
            for (var i = 0, I = markers.length; i < I && markers[i] != marker; ++i);
                path.setAt(i, marker.getPosition());
            }
        );
    }
</script> 
```

`

这是我要遵循的示例。

[http://gmaps-samples-v3.googlecode.com/svn/trunk/poly/poly_edit.html](http://gmaps-samples-v3.googlecode.com/svn/trunk/poly/poly_edit.html)

我的代码和示例之间的主要区别之一是示例中使用了初始化函数调用，而我只是在加载页面时尝试加载我的。在我的地图测试中，我能够在地图上放置标记并将它们拾起并移动它们，但是每个标记上将多边形更新为新标记点的功能以及删除每个标记的功能似乎不起作用。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-01T19:03:30.893

看起来您所要做的就是声明一个`markers`对事件侦听器可见的变量：

```
...
var markers = [];
var poly;
var path = new google.maps.MVCArray;
... 
```

# python - 优化：将 JSON 从 Streaming API 转储到 Mongo

> ID：10855518
> 
> 赞同：8
> 
> 时间：2012-06-01T18:26:27.803
> 
> 标签：python, json, mongodb, pymongo, http-streaming

**背景：** 我`python`设置了一个模块来从流式 API 中获取 JSON 对象，并使用 pymongo 将它们（一次批量插入 25 个）存储在 MongoDB 中。为了比较，我还有一个 bash 命令可以`curl`从同一个流 API`pipe`和`mongoimport`. 这两种方法都将数据存储在单独的集合中。

我会定期监控这些`count()`收藏品以检查它们的表现。

到目前为止，我看到该`python`模块落后于该`curl | mongoimport`方法大约 1000 个 JSON 对象。

**问题：** 如何优化我的`python`模块以与 ? 同步 `curl | mongoimport`？

我无法使用`tweetstream`，因为我使用的不是 Twitter API，而是第 3 方流媒体服务。

有人可以帮我吗？

**`Python`模块：**

```
 class StreamReader:
    def __init__(self):
        try:
            self.buff = ""
            self.tweet = ""
            self.chunk_count = 0
            self.tweet_list = []
            self.string_buffer = cStringIO.StringIO()
            self.mongo = pymongo.Connection(DB_HOST)
            self.db = self.mongo[DB_NAME]
            self.raw_tweets = self.db["raw_tweets_gnip"]
            self.conn = pycurl.Curl()
            self.conn.setopt(pycurl.ENCODING, 'gzip')
            self.conn.setopt(pycurl.URL, STREAM_URL)
            self.conn.setopt(pycurl.USERPWD, AUTH)
            self.conn.setopt(pycurl.WRITEFUNCTION, self.handle_data)
            self.conn.perform()
        except Exception as ex:
            print "error ocurred : %s" % str(ex)

    def handle_data(self, data):
        try:
            self.string_buffer = cStringIO.StringIO(data)
            for line in self.string_buffer:
                try:
                    self.tweet = json.loads(line)
                except Exception as json_ex:
                    print "JSON Exception occurred: %s" % str(json_ex)
                    continue

                if self.tweet:
                    try:
                        self.tweet_list.append(self.tweet)
                        self.chunk_count += 1
                        if self.chunk_count % 1000 == 0
                            self.raw_tweets.insert(self.tweet_list)
                            self.chunk_count = 0
                            self.tweet_list = []

                    except Exception as insert_ex:
                        print "Error inserting tweet: %s" % str(insert_ex)
                        continue
        except Exception as ex:
            print "Exception occurred: %s" % str(ex)
            print repr(self.buff)

    def __del__(self):
        self.string_buffer.close() 
```

谢谢阅读。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-02T20:45:17.727

最初您的代码中有一个错误。

```
 if self.chunk_count % 50 == 0
                    self.raw_tweets.insert(self.tweet_list)
                    self.chunk_count = 0 
```

您重置了 chunk_count，但没有重置 tweet_list。因此，您第二次尝试插入 100 个项目（50 个新项目加上 50 个之前已发送到 DB 的项目）。您已解决此问题，但仍然看到性能差异。

整个批量大小的事情结果是一个红鲱鱼。我尝试使用一个大的 json 文件并通过 python 加载它，而不是通过 mongoimport 加载它，Python 总是更快（即使在安全模式下 - 见下文）。

仔细查看您的代码，我意识到问题在于流 API 实际上是以块的形式向您传递数据。您应该只获取这些块并将它们放入数据库中（这就是 mongoimport 正在做的事情）。您的 python 为拆分流、将其添加到列表然后定期向 Mongo 发送批次所做的额外工作可能是我看到的和您看到的之间的区别。

为您的 handle_data() 尝试此代码段

```
def handle_data(self, data):
    try:
        string_buffer = StringIO(data)
        tweets = json.load(string_buffer)
    except Exception as ex:
        print "Exception occurred: %s" % str(ex)
    try:
        self.raw_tweets.insert(tweets)
    except Exception as ex:
        print "Exception occurred: %s" % str(ex) 
```

需要注意的一件事是您的[python 插入没有在“安全模式”下运行](http://api.mongodb.org/python/current/api/pymongo/collection.html#pymongo.collection.Collection.insert)- 您应该通过`safe=True`在插入语句中添加一个参数来更改它。然后，您将在任何插入失败时获得异常，并且您的 try/catch 将打印暴露问题的错误。

它的性能成本也不高——我目前正在运行一个测试，大约五分钟后，两个集合的大小为 14120 14113。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-10T15:50:49.027

摆脱了 StringIO 库。在这种情况下，因为每行都会调用`WRITEFUNCTION`callback `handle_data`，所以只需`JSON`直接加载。然而，有时数据中可能包含两个`JSON`对象。抱歉，我无法发布`curl`我使用的命令，因为它包含我们的凭据。但是，正如我所说，这是适用于任何流式 API 的普遍问题。

```
 def handle_data(self, buf): 
    try:
        self.tweet = json.loads(buf)
    except Exception as json_ex:
        self.data_list = buf.split('\r\n')
        for data in self.data_list:
            self.tweet_list.append(json.loads(data)) 
```

# javascript - 如何使用 HTML5 和 CSS 更改按钮背景颜色 3 次

> ID：10855520
> 
> 赞同：1
> 
> 时间：2012-06-01T18:26:42.340
> 
> 标签：javascript, html, css

我正在创建一个内部用户可以单独单击的按钮表。我需要这些按钮才能将背景从白色切换到绿色再到红色，然后再切换回白色......用户是内部用户，我可以指定这只适用于 Chrome。我想坚持使用基本的 HTML5/CSS3 和 Javascript，因为它更具程序性，而且我的团队（我们不是网页开发人员）更有可能维护它。

按钮元素似乎与文本或其他元素的工作方式不同。我已经使用代码来更改其他背景颜色，但是当元素是按钮时它不起作用。

我的 2 个基本阻塞问题是：

1.  您如何在 onClick() 例程中读取当前背景颜色，以便我的代码可以计算下一个颜色？

    如何更改 Button 元素的样式或类，以便在退出 onClick() 例程期间或退出时更改背景颜色？

我见过在 CSS 文件中定义 3 种不同颜色样式的示例，如下所示：

```
.make-background-white { background-color: white}
.make-background-green { background-color: green}
.make-background-red   { background-color: red} 
```

当我最初绘制按钮时，我可以使用它们。但我不知道如何在 onClick() 例程中“读取”当前背景颜色，也无法更改颜色。

**更多细节**

我从数据库中读取以查找按距离排序的商店周围的所有邮政编码。我创建了一个以邮政编码作为文本的按钮表，范围为 40-600 个按钮。背景颜色显示未分配的邮政编码（白色背景）和已分配的邮政编码（绿色背景）。

有时，用户想要单击几个 White 邮政编码来表示他们想要将该代码分配给商店。

我还想要一些帮助按钮，用户可以单击这些按钮自动为半径为 30 或 60 或 90 英里的商店着色/分配邮政编码。

我在幕后有一个大型 Javascript 哈希/关联数组，它使用邮政编码作为键，用于创建按钮、跟踪距离、跟踪分配或未分配的邮政编码等。这很简单. 它的动态改变按钮背景让我失望。

经过三天的黑客攻击后，我确实设法通过使用带有如下回调的 Jquery 来完成某些工作：

```
$(".btn").click(function() {
    if ( $(this).hasClass ('make-background-white') {
        $(this).removeClass('make-background-white');
        $(this).addClass ('make-background-green');
    } else if ( $(this).hasClass('make-background-green') {
         // Remove green, add red
    } else if () {
        // Remove red, add white
    }

} 
```

这似乎触发了按钮以使用新背景重新绘制，并通过在“类”属性中存储一个字符串来工作，以便我以后可以读取和操作。这是我在其他更直接的 Javascript 中的回调，其他使用“getElementById()”的 onClick() 例程似乎无法以相同的方式读取或操作“class”属性。

任何在 Javascript 中执行上述操作的帮助将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T20:42:07.703

如果每个按钮一次只需要一个类名，则可以在单击时读取/写入类名。

```
$(".btn").click(function() {
   var c=this.className;
   if(c=='make-background-white' || c=='')this.className='make-background-red';
   else if(c=='make-background-red')this.className='make-background-green';
   else this.className='make-background-white';
} 
```

这假设您从白色背景开始，或者因为所有按钮都以这种方式开始（按钮，.make-background-white{background-color:white;color:black}），或者您设置了它们的类属性。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-01T19:44:36.087

如果您的目标是在纯 JavaScript 中实现背景颜色循环按钮（在这种情况下不依赖类名），那么下面是一种可能的方法，尽管它可能过于复杂：

```
function inArray(needle, haystack) {
    if (!needle || !haystack) {
        return false;
    }
    else {
        var notFound = -1;
        for (var i = 0, len = haystack.length; i < len; i++) {
            if (haystack[i] == needle) {
                return i;
            }
        }
        return notFound;
    }
}

function colorToggle(el, colors) {
    if (!el) {
        return false;
    }
    else {
        var colors = colors || [
            'rgb(255, 0, 0)',
            'rgb(0, 255, 0)',
            'rgb(0, 0, 255)'],
            wGCS = window.getComputedStyle,
            curColor = wGCS(el, null).backgroundColor;
        var pos = inArray(curColor, colors);
        if (pos > -1 && pos < (colors.length - 1)) {
            el.style.backgroundColor = colors[inArray(curColor, colors) + 1];
        }
        else if (pos > -1 && pos == (colors.length - 1)) {
            el.style.backgroundColor = colors[0];
        }
    }
}

var buttons = document.querySelectorAll('button.colorToggle');

for (var i = 0, len = buttons.length; i < len; i++) {
    buttons[i].style.backgroundColor = 'rgb(255, 255, 255)';
    buttons[i].onclick = function() {
        colorToggle(this, ['rgb(255, 255, 255)','rgb(0, 255, 0)','rgb(255, 0, 0)']);
    };
}​ 
```

[JS 小提琴演示](http://jsfiddle.net/davidThomas/yAamm/1/)。

由于您保证这只需要在 Chrome 中运行，我只在 Chromium 18 中进行了测试（因为我没有 Windows 或 Mac 来明确测试 Google Chrome），这似乎确实符合您的要求。

参考：

*   [`window.getComputedStyle`](https://developer.mozilla.org/en/DOM/window.getComputedStyle).

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-01T19:51:25.347

您真的需要在更改之前获取 CSS 属性吗？没有此先决条件的示例：

```
<html>
<head>
<script type="text/javascript">
var bg_colors = ['red', 'blue', 'green']

function change_bg_color()
{
  bg_color = bg_colors.shift();
  bg_colors.push(bg_color);
  document.getElementById("demo").style.backgroundColor=bg_color;
}
</script>
</head>
<body>

<h1>My First Web Page</h1>
<p id="demo">This is a paragraph.</p>

<button type="button" onclick="change_bg_color()">change background-color</button>

</body>
</html> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-06-26T12:15:51.007

您可以通过 jquery setTimeOut 函数来实现这一点。通过保持颜色的隐藏值，您可以切换样式

```
<script>
setTimeout(function() {   
//code to change style to button
}, 10000);
</script> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-01T22:03:58.663

成功。我终于找到了如何使用 Javascript 访问 className 属性。

并且不知何故 - 设置 className 似乎会触发按钮的重新绘制。

下面是我用 onClick="zipClick('this_button', 'this_textarea')" 调用的函数

感谢您的所有精彩回复。

```
 // This function does 2 things:
    //    Changes the background color of the button
    //    Calls a REST service
    function zipClick (aButtonId, aTextAreaId) {

        var lButton = document.getElementById(aButtonId);
        var lClassName = lButton.className;

        // lClassName should be something like: "btn make-background-yellow"
        //alert ("Button Class Start = " + lClassName);

        if ( lClassName.indexOf('green') > -1 ) {
            lButton.className = 'btn make-background-yellow';
        } else if ( lClassName.indexOf('white') > -1) {
            lButton.className = 'btn make-background-green';
        } else if ( lClassName.indexOf('yellow') > -1 ) {
            lButton.className = 'btn make-background-white';
        } else {
            // Should never get here but fix the class name for the next click
            lButton.className = 'btn make-background-white';
        }

        alert ("old class: " + lClassName + "\nnew class: " + lButton.className);

    }   // zipClick 
```

# java - 在 Ubuntu 上安装 RWekajars

> ID：10855525
> 
> 赞同：0
> 
> 时间：2012-06-01T18:27:49.350
> 
> 标签：java, r, ubuntu, installation, weka

我尝试安装 R 包“RWekajars”。不幸的是，我收到以下错误消息：

```
* installing *source* package ‘RWekajars’ ...
** Paket ‘RWekajars’ erfolgreich entpackt und MD5 Summen überprüft
Exception in thread "main" java.lang.NoClassDefFoundError: getsp
Caused by: java.lang.ClassNotFoundException: getsp
        at java.net.URLClassLoader$1.run(URLClassLoader.java:202)
        at java.security.AccessController.doPrivileged(Native Method)
        at java.net.URLClassLoader.findClass(URLClassLoader.java:190)
        at java.lang.ClassLoader.loadClass(ClassLoader.java:306)
        at sun.misc.Launcher$AppClassLoader.loadClass(Launcher.java:301)
        at java.lang.ClassLoader.loadClass(ClassLoader.java:247)
Could not find the main class: getsp.  Program will exit.
./configure: Zeile 50: test: -ge: Einstelliger (unärer) Operator erwartet.
./configure: Zeile 51: test: -eq: Einstelliger (unärer) Operator erwartet.
Need at least Java version 1.5/5.0. 
```

我使用的是 Ubuntu 11.04，但我在 Ubuntu 10.10 上遇到了同样的问题。

刷新 R - Java 配置

```
R CMD javareconf 
```

没有*帮助*。

我在两台机器上遇到问题，一台运行 Oracle Java (1.6.0_26)，另一台运行 OpenJDK (1.6.0)。所以错误信息

```
Need at least Java version 1.5/5.0 
```

似乎没有道理。此外，只安装了一个 java 版本。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-01T18:27:49.583

解决方案（至少对于 ubuntu）：

打开终端并执行

```
export CLASSPATH=/usr/share/R/share/java 
```

在同一个终端窗口中

```
R
> install.packages("RWekajars") 
```

完毕。

如何获得解决方案（如果您正在运行另一个操作系统或发行版，这应该会对您有所帮助）：

为了解决这个问题，我首先使用

```
download.packages("RWekajars") 
```

在配置脚本中，您会看到 R 使用

```
java_version=`${JAVA} getsp "java.version"` 
```

我用了

```
locate getsp 
```

并发现：

```
/usr/share/R/share/java/getsp.class 
```

因此，getsp 类存在，但 R 找不到它。这就是为什么我们在执行 R 之前将 CLASSPATH 变量设置为 /usr/share/R/share/java。这样 R 在安装过程中知道在哪里可以找到 getsp 程序。如果您的 getsp.class 在另一个目录中，您必须更改导出语句中的路径。

希望这对某人有所帮助，因为我花了一段时间才弄清楚这一点。

PS：这个问题在 ubuntu 12.04 上不会发生 - 至少现在是这样。

# javascript - 向 Javascript 提供特定于部署的信息

> ID：10855530
> 
> 赞同：0
> 
> 时间：2012-06-01T18:28:03.983
> 
> 标签：javascript, web-applications, deployment

由于 UI 有时是使用 Javascript 构建的，我很好奇人们如何提供在 Web 应用程序的部署实例之间发生变化的属性。例如，我的所有静态资产都来自与 webapp 交付位置不同的域（static.example.com 与 example.com）。在开发中，静态域与用于生产的域不同（dev.static.example 用于开发，而 static.example.com 用于生产部署）。

使用 Javascript，我最终会动态地构建带有 img 标签的 UI 元素（例如，作为 ajax 响应的一部分）。图像 src attr 在生产和开发中会有所不同。我知道有一些方法可以将这些变化的信息转换为 Javascript，但似乎没有什么好用的。我很好奇你们中是否有人有任何技巧来处理这种情况，或者你想出了什么最佳实践。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-01T18:32:28.600

我会专注于使用 JSON + [jQuery 模板](http://stephenwalther.com/blog/archive/2010/11/30/an-introduction-to-jquery-templates.aspx)。

# ios5 - MKNetworkKit - 冻结操作的跟踪状态/未调用 onCompletion 和 onError

> ID：10855531
> 
> 赞同：3
> 
> 时间：2012-06-01T18:28:12.227
> 
> 标签：ios5, network-programming

MKNetworkKit 库的众多强大功能之一是它可以轻松地“冻结”http POST 请求（例如上传到服务器），这些请求可以在网络连接恢复后自动恢复。

详细信息：http: [//blog.mugunthkumar.com/products/ios-framework-introducing-mknetworkkit/#Operation_freezing](http://blog.mugunthkumar.com/products/ios-framework-introducing-mknetworkkit/#Operation_freezing)

但是当我结束基于 MKNetworkKit 的应用程序时，我发现 onCompletion 和 onError 块不会在冻结的网络事务上被调用（这显然是一个已知问题），我正在努力如何构建围绕这让用户知道冻结交易何时真正完成。

有没有人处理过这种情况？

什么是让用户忘记网络中断和停机时间的最佳方法，但仍然能够就上次成功连接的时间提供一些反馈？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-17T00:58:55.190

我想出的最佳答案是继承 MKNetworkOperation，然后覆盖 operationSucceeded 和 operationFailedWithError。当冻结操作完成时，仍会调用这些例程。

从 MKNetworkOperation.h 头文件：

```
/*!
 *  @abstract Overridable custom method where you can add your custom business logic error handling
 *  
 *  @discussion
 *  This optional method can be overridden to do custom error handling. Be sure to call [super operationSucceeded] at the last.
 *  For example, a valid HTTP response (200) like "Item not found in database" might have a custom business error code
 *  You can override this method and called [super failWithError:customError]; to notify that HTTP call was successful but the method
 *  ended as a failed call
 *
 */
-(void) operationSucceeded;

/*!
 *  @abstract Overridable custom method where you can add your custom business logic error handling
 *  
 *  @discussion
 *  This optional method can be overridden to do custom error handling. Be sure to call [super operationSucceeded] at the last.
 *  For example, a invalid HTTP response (401) like "Unauthorized" might be a valid case in your app.
 *  You can override this method and called [super operationSucceeded]; to notify that HTTP call failed but the method
 *  ended as a success call. For example, Facebook login failed, but to your business implementation, it's not a problem as you
 *  are going to try alternative login mechanisms.
 *
 */
-(void) operationFailedWithError:(NSError*) error; 
```

# cdi - CODI + WELD：专业化 bean 必须扩展另一个 bean

> ID：10855532
> 
> 赞同：0
> 
> 时间：2012-06-01T18:28:15.413
> 
> 标签：cdi, jboss-weld, codi

我有一个使用 JSF 2.0 (impl Mojarra 2.1.6) 的 EE 应用程序。我使用的服务器是 glassfish 3.1.2，CDI 实现是 WELD。有时，当我运行应用程序时，会出现以下异常：

```
org.jboss.weld.exceptions.DefinitionException: WELD-000047 Specializing bean must extend another bean:  Managed Bean [class org.apache.myfaces.extensions.cdi.jsf2.impl.Jsf2ModuleStartupObserver] with qualifiers [@Any @Default]
    at org.jboss.weld.bean.ManagedBean.specialize(ManagedBean.java:458)
    at org.jboss.weld.bean.AbstractBean.initialize(AbstractBean.java:121)
    at org.jboss.weld.bean.AbstractClassBean.initialize(AbstractClassBean.java:190)
    at org.jboss.weld.bean.ManagedBean.initialize(ManagedBean.java:322)
    at org.jboss.weld.bootstrap.AbstractBeanDeployer.deploy(AbstractBeanDeployer.java:115)
    at org.jboss.weld.bootstrap.BeanDeployment.deployBeans(BeanDeployment.java:204)
    at org.jboss.weld.bootstrap.WeldBootstrap.deployBeans(WeldBootstrap.java:344)
    at org.glassfish.weld.WeldDeployer.event(WeldDeployer.java:179)
    at org.glassfish.kernel.event.EventsImpl.send(EventsImpl.java:128)
    at org.glassfish.internal.data.ApplicationInfo.load(ApplicationInfo.java:277)
    at com.sun.enterprise.v3.server.ApplicationLifecycle.deploy(ApplicationLifecycle.java:460)
    at com.sun.enterprise.v3.server.ApplicationLifecycle.deploy(ApplicationLifecycle.java:240)
    at org.glassfish.deployment.admin.DeployCommand.execute(DeployCommand.java:389)
    at com.sun.enterprise.v3.admin.CommandRunnerImpl$1.execute(CommandRunnerImpl.java:348)
    at com.sun.enterprise.v3.admin.CommandRunnerImpl.doCommand(CommandRunnerImpl.java:363)
    at com.sun.enterprise.v3.admin.CommandRunnerImpl.doCommand(CommandRunnerImpl.java:1085)
    at com.sun.enterprise.v3.admin.CommandRunnerImpl.access$1200(CommandRunnerImpl.java:95)
    at com.sun.enterprise.v3.admin.CommandRunnerImpl$ExecutionContext.execute(CommandRunnerImpl.java:1291)
    at com.sun.enterprise.v3.admin.CommandRunnerImpl$ExecutionContext.execute(CommandRunnerImpl.java:1259)
    at com.sun.enterprise.v3.admin.AdminAdapter.doCommand(AdminAdapter.java:461)
    at com.sun.enterprise.v3.admin.AdminAdapter.service(AdminAdapter.java:212)
    at com.sun.grizzly.tcp.http11.GrizzlyAdapter.service(GrizzlyAdapter.java:179)
    at com.sun.enterprise.v3.server.HK2Dispatcher.dispath(HK2Dispatcher.java:117)
    at com.sun.enterprise.v3.services.impl.ContainerMapper$Hk2DispatcherCallable.call(ContainerMapper.java:354)
    at com.sun.enterprise.v3.services.impl.ContainerMapper.service(ContainerMapper.java:195)
    at com.sun.grizzly.http.ProcessorTask.invokeAdapter(ProcessorTask.java:849)
    at com.sun.grizzly.http.ProcessorTask.doProcess(ProcessorTask.java:746)
    at com.sun.grizzly.http.ProcessorTask.process(ProcessorTask.java:1045)
    at com.sun.grizzly.http.DefaultProtocolFilter.execute(DefaultProtocolFilter.java:228)
    at com.sun.grizzly.DefaultProtocolChain.executeProtocolFilter(DefaultProtocolChain.java:137)
    at com.sun.grizzly.DefaultProtocolChain.execute(DefaultProtocolChain.java:104)
    at com.sun.grizzly.DefaultProtocolChain.execute(DefaultProtocolChain.java:90)
    at com.sun.grizzly.http.HttpProtocolChain.execute(HttpProtocolChain.java:79)
    at com.sun.grizzly.ProtocolChainContextTask.doCall(ProtocolChainContextTask.java:54)
    at com.sun.grizzly.SelectionKeyContextTask.call(SelectionKeyContextTask.java:59)
    at com.sun.grizzly.ContextTask.run(ContextTask.java:71)
    at com.sun.grizzly.util.AbstractThreadPool$Worker.doWork(AbstractThreadPool.java:532)
    at com.sun.grizzly.util.AbstractThreadPool$Worker.run(AbstractThreadPool.java:513)
    at java.lang.Thread.run(Thread.java:680) 
```

它并不总是发生；当它发生时，如果我再次运行该应用程序，它就可以正常工作。但这很烦人，我想知道为什么会这样。有人知道吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-02T17:45:56.423

[我可以通过遵循http://os890.blogspot.co.at/2012/05/slides-myfaces-codi-and-seam3-become.html](http://os890.blogspot.co.at/2012/05/slides-myfaces-codi-and-seam3-become.html)中的常见陷阱提示来解决 Glassfish3 的所有问题（幻灯片 #32+）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-02T04:47:32.170

听起来像是 Glassfish CDI 集成中的错误。我建议向他们的 JIRA 添加一张票。

# c++ - 删除矢量指针的最佳方法？

> ID：10855534
> 
> 赞同：1
> 
> 时间：2012-06-01T18:28:24.160
> 
> 标签：c++, visual-c++

> **可能重复：**
> [如何正确删除指针？](https://stackoverflow.com/questions/10854274/how-to-properly-delete-pointer)

我`std::vector`用来将一组对象放入其中以备后用，我`DETAIL* pPtr = new DETAIL`用来创建指针，然后将其插入向量中。

DETAIL 的结构

```
struct DETAIL {
    int nRef;
    short sRandom;
}; 
```

这是删除和擦除**向量中**的指针的最佳方法，不会留下内存泄漏的空间吗？

```
while(Iter1 != m_Detail.end())
{
    if((*Iter1)->nRef == m_SomeVar)    
    {
        delete  *Iter1;
        m_Detail.erase(Iter1);
        break;
    }

    Iter1++;
} 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-06-01T18:30:42.507

不要将原始指针放入 . `vector`，而是使用智能指针，例如`std::shared_ptr`. 那么就不需要了`delete`，简单`erase`的指针 from`vector`和指向的对象就会被自动删除。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-01T20:34:37.437

> 我`DETAIL* pPtr = new DETAIL`用来创建指针

这是您的第一个错误，您正在获取资源（来自 freestore 的内存和在该内存中构造的对象），而不是初始化将获取所有权并保证释放您获取的资源的对象。解决第一个错误的成语称为[Resource Acquisition Is Initialization](http://en.wikipedia.org/wiki/Resource_Acquisition_Is_Initialization)。

它应该是这样的：

```
std::shared_ptr<DETAIL> pPtr(new DETAIL); 
```

或者更好：

```
std::shared_ptr<DETAIL> pPtr = std::make_shared<DETAIL>(); 
```

或在 C++03 中替换`std::shared_ptr`为`boost::shared_ptr`(and `boost::make_shared`)

下一个错误是`delete *Iter1;`因为几乎所有在析构函数之外使用的代码`delete`都是错误的（并且**所有**`delete`在析构函数之外使用并伴随着一个关于如何避免内存泄漏的问题的代码肯定是错误的。）如果你使用 RAII 习语，你不会不需要使用`delete`，因为它会在正确的时间自动发生。

另外，你的课为什么叫`DETAIL`？`Detail`相反有什么问题？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-01T20:47:44.880

我不喜欢“从不”这样的回答，所以我会回答，但会给你一些技巧来绕过释放向量而不释放内容的风险。

如果我理解得很好，你有一个 DETAIL 指针向量：

```
std::vector<DETAIL*> details; 
```

因此，您需要一种方法来删除和删除所有指向某个 m_SomeVar 的指向对象：（现在让我们假设它是一个自由函数）

```
void free_references(int reference, std::vector<DETAIL*> & vector)
{
    std::vector<DETAIL*>::iterator it = vector.begin();

    while (it != vector.end())
    {
        if ((*it)->nRef == reference)
        {
            delete *it;
            // erase() makes the original 'it' in an unknown state which can't be used
            // erase will return a valid iterator which is, in this case, the following element
            it = vector.erase(it); 
        }
        else
        {
            ++it;
        }
    }
} 
```

正如我在您的代码中所理解的那样，向量是一个类的成员。这很好，因为您将能够删除析构函数中的所有内容。

但是，我会`std::unique_ptr`在这里使用“授予”指向向量内 unique_ptr 容器的指针的所有权。并且当向量内存空闲时，`std::unique_ptr`智能点确保所拥有的指向对象被释放。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-01T18:33:17.767

我的建议是使用 std::shared_ptr 使用擦除从向量中删除共享指针，并让它处理释放。但是，您所做的事情并没有错，但擦除不会导致向量释放它为保存指针而分配的空间。您可以使用[shrik_to_fit](http://en.cppreference.com/w/cpp/container/vector/shrink_to_fit)删除分配的空间。

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2012-06-01T18:32:57.713

我不知道我是否完全理解它，但你尝试过使用 ZeroMemory 宏吗？

# objective-c - 等效于 ViewDidLoad 的 Objective-C 命令行

> ID：10855535
> 
> 赞同：0
> 
> 时间：2012-06-01T18:28:29.927
> 
> 标签：objective-c, command-line

我只是想知道我应该在哪里设置变量的值以在我的所有方法中使用。例如，假设在我的 .h 中我说： `@property NSString *name;`然后在 .m 中合成它。我在哪里为它分配一个值，以便在我的函数中，比如`-(NSString *)changeUsername:(NSString *) changes`and `-(void)deleteUsername`，我可以访问该数据？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T18:38:04.993

`main()`是在命令行程序中调用的第一件事。你不会在那里（或从 调用的地方`main()`）做吗？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-01T18:43:14.133

由于您在谈论属性，因此您必须有一个要实例化的类。该类的指定初始化程序（`-init`或类似的）是设置属性和/或实例变量的正确位置。

Cocoa Touch 应用程序延迟某些初始化标记的唯一原因`-viewDidLoad`是视图控制器在初始化时不会加载它们的视图，并且某些属性或 ivars 与将要加载的视图相关。在加载（或创建）视图之前，显然无法设置这些东西，因此`-viewDidLoad`成为设置这些东西的最佳场所。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-01T18:39:17.710

好吧，您可以在您的类的初始化程序中这样做，实际上，这将是 C++ 或 Java 中的方法。在 Objective-c 中，您通常使用惰性实例化，最好的地方是在该属性的 getter 中。

如果有人为属性赋值，则调用 setter 并且一切正常。如果有人询问该值并且尚未设置（为零），您可以创建对象和/或在 getter 中分配默认值。

```
// Override accessor for name
- (NSString*)name
{
    if (!_name) {
        _name = @"unknown";
    }

    return _name;
} 
```

访问器方法是您应该直接访问实例变量的唯一地方。

# sql-server - ColdFusion 8 执行 cfquery、事务和脏读

> ID：10855537
> 
> 赞同：4
> 
> 时间：2012-06-01T18:28:38.933
> 
> 标签：sql-server, coldfusion, transactions

在将 ColdFusion 8 与 MSSQL 一起使用时，在进行跟踪时，我的 DBA 注意到 cfquery 调用正在附加，`SET TRANSACTION ISOLATION LEVEL READ COMMITTED`而这些调用并不在查询本身中。他建议出于性能原因将其删除或更改为未提交。

这是 ColdFusion 正在添加的东西吗？默认情况下是在 ColdFusion 和/或 MSSQL 中添加的吗？

我正在使用 ColdFusion 的默认 MSSQL 驱动程序，并且可以通过`<cftransaction isolation="read_uncommitted">`在每个 cfquery 周围使用标记来临时更改。

有没有其他方法可以阻止它被附加到 ColdFusion 中，或者 cftransaction 是最好的方法吗？

最后一个问题，使用时`isolation="read_uncommitted"`为什么要`SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED`在查询添加之前但之后添加`SET TRANSACTION ISOLATION LEVEL READ COMMITTED`？

先感谢您。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-01T18:56:00.063

已提交是对未指定隔离级别的数据库的任何查询的默认隔离级别。您在执行期间更改它，然后它恢复为“已提交”。当 CF 和 JDBC 驱动程序一起工作时，语句的创建是“幕后”工作的一部分。使用“read_uncommitted”更快，因为它读取时不会阻止任何其他连接或查询更改或读取数据。因此，它开启了“脏读”的可能性（您正在读取未提交的数据，因此可能是不正确的数据），但在许多情况下，这并不是什么大问题，因此您的 DBA 可能是正确的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-03-18T15:55:12.960

这没有被正确解释，**read_committed**是一个“隔离”问题，如果其他任务打开表以进行**更新/插入/删除**，则“read_committed”中的事务将被等待从表中释放锁，直到事务**已**提交。如果事务设置为“ **read_uncommitted** ”，它将直接从现有数据中读取，并且不会等待挂起的 **更新/插入/删除**。因此，“ **Dirty** ”这个术语意味着任何未决的、**未提交**的都不会被返回，但也不会被锁定和延迟。

# vim - 为什么 vim incsearch 在取消搜索时会暂停 钥匙？

> ID：10855539
> 
> 赞同：2
> 
> 时间：2012-06-01T18:28:44.717
> 
> 标签：vim

在 vim 中，如果您`set incsearch`这样做，它将滚动到当前搜索词的下一个匹配项，而无需移动光标。我经常使用它来阅读一段代码而不将光标移到那里，因为然后我可以点击`<ESC>`，屏幕将返回到我开始搜索时光标所在的位置。

`<ESC>`但是，vim 在您点击之后和滚动回光标之前会暂停。我觉得这个停顿很烦人。这个暂停背后的目的是什么，和/或这个暂停是可配置的？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-01T19:14:36.837

我假设你在终端中运行 Vim。`<Esc>`是许多终端转义序列的开始字符，例如光标移动或`Alt`/ `Meta`+ 其他键。如果你在配置中的某处定义了一些 alt/meta 键映射，Vim 会在你点击后稍等片刻，`Esc`以确保`<Esc>`字符不是更长序列的开始。

您可能需要`:help 'timeout'`相应地检查和调整设置。如果需要，您可以设置`timeoutlen`更短的持续时间（`ttimeoutlen`默认设置为 -1，因此不使用）。

**编辑**：如果您在 tmux 或 GNU 屏幕中运行 Vim，这可能不足以防止暂停。如果使用 tmux，请尝试添加`set -s escape-time 0`到您的 .tmux.conf，[正如 Vicent Marti 在此处所建议的那样](https://unix.stackexchange.com/questions/23138/esc-key-causes-a-small-delay-in-terminal-due-to-its-alt-behavior)。如果使用 GNU 屏幕，您可能会成功添加

```
maptimeout 0
defc1 off 
```

到你的 .screenrc，正如[brian_ruiz 在这里所建议的那样](https://unix.stackexchange.com/questions/8439/gnu-screen-makes-vim-esc-key-slow)。

# mysql - org.hibernate.AssertionFailure: null id in entry（发生异常后不要刷新Session）

> ID：10855542
> 
> 赞同：60
> 
> 时间：2012-06-01T18:29:14.740
> 
> 标签：mysql, windows, hibernate, jsf-2, jboss

我有一个休眠和 JSF2 应用程序进入部署服务器并突然抛出 org.hibernate.AssertionFailure: null id 异常。我将立即提供堆栈跟踪和代码，但首先有四个重要问题：

1.  这只发生在部署服务器上（在 Windows Sever 2008 上运行的 Jboss 和 MySql）。它不会发生在我的开发机器（在 Windoes 7 Pro 上运行的 Tomcat 和 MySql）上，也不会发生在暂存环境（在 Linux 上运行的 Jboss 和 MySql）上.)

2.  对此进行研究，似乎人们在尝试插入对象时会出现此错误。但是当我做一个简单的查询时我得到了错误。（实际上，各种不同的查询，因为错误随机出现在几个页面上。）

3.  错误只是偶尔发生。如果我重新启动 Jboss，它会消失，但稍后会返回。此外，它并不一致，在某些点击时它在那里，在其他点击时则不是。即使它命中，当我对页面进行简单刷新时，它也能正常返回。

4.  我正在使用 c3p0（下面的配置）

知道发生了什么吗？

代码详情：

这发生在地址对象上。这是完整的hbm：

```
<?xml version="1.0"?>
<!DOCTYPE hibernate-mapping PUBLIC
"-//Hibernate/Hibernate Mapping DTD 3.0//EN"
"http://hibernate.sourceforge.net/hibernate-mapping-3.0.dtd">
<hibernate-mapping package="com.idex.auctions.model">
<class name="Address" table="address" lazy="true">
  <id name="addressID" column="AddressID">
        <generator class="native"/>            
  </id>

  <property name="street" column="street"/> 
  <property name="city" column="city"/> 
  <property name="zip" column="zip"/> 
  <property name="state" column="state"/> 
  <property name="region" column="region"/> 
  <property name="country" column="country"/> 

  <many-to-one name="user" 
       class="com.idex.auctions.model.User" 
       column="userid" 
       unique="true" 
       cascade="save-update"/>
 </class> 
</hibernate-mapping> 
```

Java 类很简单：

```
public class Address implements Serializable {
private static final long serialVersionUID = 7485582614444496906L;

private long addressID;
private String street;
private String city;
private String zip;
private String state;
private String region;
private String country;
private User user;

public Address() {

}
public long getAddressID() {
    return addressID;
}
public void setAddressID(long addressID) {
    this.addressID = addressID;
}
public String getStreet() {
    return street;
}
public void setStreet(String street) {
    this.street = street;
}
public String getCity() {
    return city;
}
public void setCity(String city) {
    this.city = city;
}
public String getZip() {
    return zip;
}
public void setZip(String zip) {
    this.zip = zip;
}
public String getState() {
    return state;
}
public void setState(String state) {
    this.state = state;
}
public String getRegion() {
    return region;
}
public void setRegion(String region) {
    this.region = region;
}
public String getCountry() {
    return country;
}
public void setCountry(String country) {
    this.country = country;
}
public User getUser() {
    return user;
}
public void setUser(User user) {
    this.user = user;
}

} 
```

c3p0 配置：

```
<property name="hibernate.c3p0.acquire_increment">1</property> 
<property name="hibernate.c3p0.idle_test_period">1000</property> 
<property name="hibernate.c3p0.max_size">20</property>  
<property name="hibernate.c3p0.min_size">5</property>
<property name="hibernate.c3p0.timeout">1800</property>
<property name="hibernate.c3p0.max_statements">0</property>
<property name="connection.provider_class">org.hibernate.connection.C3P0ConnectionProvider</property> 
```

使用的版本是

```
hibernate3.jar

c3p0-0.9.1.2.jar

myfaces-api-2.1.4.jar

myfaces-impl-2.1.4.jar

mysql-connector-java-5.1.20-bin.jar 
```

完整的堆栈跟踪

```
org.hibernate.AssertionFailure: null id in com.idex.auctions.model.Address entry 
    (don't flush the Session after an exception occurs)
org.hibernate.event.def.DefaultFlushEntityEventListener.checkId(
                                          DefaultFlushEntityEventListener.java:78)
org.hibernate.event.def.DefaultFlushEntityEventListener.getValues(
                                          DefaultFlushEntityEventListener.java:187)
org.hibernate.event.def.DefaultFlushEntityEventListener.onFlushEntity(
                                          DefaultFlushEntityEventListener.java:143)
org.hibernate.event.def.AbstractFlushingEventListener.flushEntities(
                                          AbstractFlushingEventListener.java:219)
org.hibernate.event.def.AbstractFlushingEventListener.flushEverythingToExecutions(
                                          AbstractFlushingEventListener.java:99)
org.hibernate.event.def.DefaultAutoFlushEventListener.onAutoFlush(
                                          DefaultAutoFlushEventListener.java:58)
org.hibernate.impl.SessionImpl.autoFlushIfRequired(SessionImpl.java:997)
org.hibernate.impl.SessionImpl.list(SessionImpl.java:1142)
org.hibernate.impl.QueryImpl.list(QueryImpl.java:102)
com.idex.auctions.manager.DatabaseManager.getAllObjects(DatabaseManager.java:464)
com.idex.auctions.ui.NavBean.gotoHome(NavBean.java:40)
sun.reflect.GeneratedMethodAccessor350.invoke(Unknown Source)
sun.reflect.DelegatingMethodAccessorImpl.invoke(Unknown Source)
java.lang.reflect.Method.invoke(Unknown Source)
javax.el.BeanELResolver.invokeMethod(BeanELResolver.java:735)
javax.el.BeanELResolver.invoke(BeanELResolver.java:467)
javax.el.CompositeELResolver.invoke(CompositeELResolver.java:246)
org.apache.el.parser.AstValue.getValue(AstValue.java:159)
org.apache.el.ValueExpressionImpl.getValue(ValueExpressionImpl.java:189)
org.apache.myfaces.view.facelets.el.ContextAwareTagValueExpression.getValue(
                                          ContextAwareTagValueExpression.java:96)
javax.faces.component._DeltaStateHelper.eval(_DeltaStateHelper.java:246)
javax.faces.component.UIOutcomeTarget.getOutcome(UIOutcomeTarget.java:50)
org.apache.myfaces.shared.renderkit.html.HtmlRendererUtils.getOutcomeTargetHref(
                                          HtmlRendererUtils.java:1542)
org.apache.myfaces.shared.renderkit.html.HtmlLinkRendererBase.renderOutcomeLinkStart(
                                          HtmlLinkRendererBase.java:908)
org.apache.myfaces.shared.renderkit.html.HtmlLinkRendererBase.encodeBegin(
                                          HtmlLinkRendererBase.java:143)
javax.faces.component.UIComponentBase.encodeBegin(UIComponentBase.java:502)
javax.faces.component.UIComponent.encodeAll(UIComponent.java:744)
javax.faces.component.UIComponent.encodeAll(UIComponent.java:758)
javax.faces.component.UIComponent.encodeAll(UIComponent.java:758)
org.apache.myfaces.view.facelets.FaceletViewDeclarationLanguage.renderView(
                                    FaceletViewDeclarationLanguage.java:1900)
org.apache.myfaces.application.ViewHandlerImpl.renderView(ViewHandlerImpl.java:285)
com.ocpsoft.pretty.faces.application.PrettyViewHandler.renderView(
                                    PrettyViewHandler.java:163)
javax.faces.application.ViewHandlerWrapper.renderView(ViewHandlerWrapper.java:59)
org.apache.myfaces.tomahawk.application.ResourceViewHandlerWrapper.renderView(
                                    ResourceViewHandlerWrapper.java:93)
com.idex.auctions.ui.CustomViewHandler.renderView(CustomViewHandler.java:98)
org.apache.myfaces.lifecycle.RenderResponseExecutor.execute(RenderResponseExecutor.java:115)
org.apache.myfaces.lifecycle.LifecycleImpl.render(LifecycleImpl.java:241)
javax.faces.webapp.FacesServlet.service(FacesServlet.java:199)
com.ocpsoft.pretty.PrettyFilter.doFilter(PrettyFilter.java:126)
com.ocpsoft.pretty.PrettyFilter.doFilter(PrettyFilter.java:118) 
```

* * *

## 回答 #1

> 赞同：54
> 
> 时间：2013-05-15T13:15:29.720

例外：

> org.hibernate.AssertionFailure: null id in entry（发生异常后不要刷新Session）

告诉我们会话异常发生在抛出this**之前**`org.hibernate.AssertionFailure`。

确切地说，`org.hibernate.AssertionFailure`是在发生错误时抛出`session.flush()`，而不是发生错误的地方。

以上是事实，因此可能得出的结论是：某些东西可能会**抑制**原始异常。

因此，请寻找**其他**可能的错误点：A`save()`或`saveOrUpdate()`可能**正在尝试使用一个字段来持久化一个实体，在该`null`字段**中，该列是`NOT NULL`？

* * *

**提示：** 为了帮助调试，请尝试`session.flush()`在与对象的每次交互后添加一个`Session`（例如`session.save(obj)`，`session.merge(obj)`等），这将有望导致`org.hibernate.AssertionFailure`更早发生，更接近实际问题发生的位置。（当然，调试后，去掉那些`session.flush()`。）

就我而言，**真正的**异常发生在抑制异常的`try/catch {}`块内`catch`（没有重新抛出或警告我）。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2012-06-07T20:13:56.437

我敢打赌并发问题，但它可能发生在不同的级别：

*   如果没有正确实现[经典的“在视图中打开会话”模式，](http://blog.smartkey.co.uk/2010/03/open-session-in-view-pattern-spring-jpa/)则可以在不同用户之间共享休眠会话
*   [由于不正确的休眠缓存设置](http://docs.jboss.org/hibernate/orm/3.3/reference/en/html/performance.html#performance-cache)，实体在两个用户会话之间共享
*   一个 JDBC 连接在两个不同的休眠会话之间共享（不太可能）

除了这些潜在的麻烦来源之外，我将删除 c3p0（也许只是谣言......），因为您的堆栈已经提供`DataSource`了与事务管理器集成的连接池。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2015-05-28T08:07:40.647

@asdcjunior 已正确回答。在抛出异常之前发生了一些事情。

在那种情况下（当您为一个测试处理单个事务时，它经常发生在集成测试中 - 例如@Transaction注释）我正在调用该方法：

```
session.clear() 
```

这很有帮助，因为所有“脏”对象都已从当前会话中删除，因此在执行下一次刷新时不会出现问题。

示例流程：

*   插入分配实体（与约束的多对多关系，只能存在单个分配）-> 一切正常
*   再次插入相同的分配实体 -> 一切正常，在这种情况下，控制器返回某种错误的请求异常，在后台 Spring 抛出 IntegrityViolationException -> 在测试中一切正常
*   获取存储库并执行 findAll().size() 以检查已分配的计数，以确保我们只有一个分配 -> 引发了提到的异常；/ 发生了什么？在会话上仍然存在脏对象，通常会话会被破坏（控制器返回错误）但是这里我们有下一个断言来检查数据库，所以这里的解决方案是在下一个与数据库相关的方法执行之前附加 session.clear()

正确流程示例：

*   插入分配实体
*   插入相同的分配实体
*   **session.clear()**
*   获取存储库并执行 findAll().size()

希望能帮助到你 ;）

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2012-06-08T20:55:50.533

您可能遇到了一些 Hibernate 错误。（我建议至少升级到 Hibernate 3.3.2.GA。）

同时，当您的 ID 可以为空时，Hibernate 会做得更好，这样 Hibernate 总是可以区分尚未持久化到数据库的新对象和已经在数据库中的对象。`addressID`将from的类型更改为`long`to`Long`可能会解决该问题。

您提供的堆栈跟踪表明您在查询中看到了问题，因为您的查询强制在执行查询之前将缓冲的写入刷新到数据库并且写入失败，可能与其他人看到的相同插入问题。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2018-02-21T19:30:13.313

我遇到了这个问题，我只是添加了 try catch 块，在 catch 块中我写了 seesion.clear(); 现在我可以继续将其余记录插入数据库。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2012-06-11T16:34:35.953

好的，我继续根据此线程中的其他答案进行研究。但最后，由于我们面临生产截止日期，我不得不选择紧急路线。所以我没有弄清楚hibernate，而是做了这两件事：

1.  删除了一个 jQuery 库，我使用它来获取对其中一个表单的关注。我这样做是因为我在某处读到这种类型的错误可能是由于表单发布空值而发生 - 导致空 id 下降。我怀疑 jQuery 库可能无法很好地与 PrimeFaces 配合使用，并导致某些表单出现故障。只是一种预感。

2.  我杀死了用户和地址之间的休眠实现关系。（只需要一个，而不是一对多）并在需要时自己编写代码。幸运的是，它只显着影响了一页，所以工作量不大。

底线：我们上线了，应用程序已经运行了好几天，没有任何错误。所以这个解决方案可能并不漂亮——我并不为自己感到骄傲——但我有一个正在运行的应用程序和一个快乐的客户。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2018-10-30T11:07:12.807

问题流程：

1.  您创建一个新的瞬态实体实例（这里是地址实例）
2.  您将其持久化到数据库中（使用保存、合并或持久化休眠会话/JPA EntityManager）
3.  由于实体标识符是由数据库生成的，因此休眠必须触发数据库插入（它刷新会话）以检索生成的 id
4.  插入操作触发异常（或会话中任何待处理的未刷新更改）
5.  您捕获异常（不传播它）并恢复执行流程（此时您的会话仍然包含没有 id 的未持久实例，问题是休眠似乎将实例视为托管但实例已损坏为托管对象必须有身份证）
6.  您到达工作单元的结尾，并且在提交当前事务之前自动刷新会话，刷新失败并出现断言失败，因为会话包含损坏的实例

您有许多可能的方法来减轻此错误：

*   最简单的一个，就像休眠状态一样，“发生异常后不要刷新会话”，即。持久性异常后立即放弃并回滚当前事务。
*   捕获错误后从会话中手动驱逐（JPA：分离）损坏的实例（在第 5 点，但如果错误是由另一个挂起的更改而不是实体插入本身触发的，这将是无用的）
*   不要让数据库处理 id 生成（使用 UUID 或分布式 id 生成系统，在这种情况下，最终刷新将抛出真正的错误，阻止新实例的持久性而不是休眠断言失败）

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2016-09-08T18:35:13.473

> org.hibernate.AssertionFailure: null id in entry（发生异常后不要刷新Session）

这只是发生在我们身上，我想我会为后代添加一些细节。事实证明，我们试图创建一个具有违反条件的重复字段的实体：

```
Caused by: org.hibernate.exception.ConstraintViolationException: Duplicate entry '' for key
'Index_schools_name' 
```

然而，这个异常被掩盖了，因为即使创建失败，休眠也试图*提交会话。*当创建失败时，没有设置 id，因此出现断言错误。在堆栈跟踪中，我们可以看到 hibernate 正在提交：

```
at org.springframework.orm.hibernate4.HibernateTransactionManager.doCommit
(HibernateTransactionManager.java:480) 
```

它应该回滚会话，而不是提交它。这原来是我们的回滚配置的问题。我们使用的是旧的 XML 配置，异常路径不正确：

```
<prop key="create*">PROPAGATION_REQUIRED,-org.x.y.LocalException</prop> 
```

路径不正确，`LocalException`hibernate 没有抛出错误（或者它被埋在启动日志中）。如果您使用注释并且未指定正确的异常，也可能是这种情况：

```
// NOTE: that the rollbackFor exception should match the throws (or be a subclass)
@Transactional(rollbackFor = LocalException.class)
public void create(Entity entity) throws AnotherException { 
```

一旦我们修复了休眠连接，我们就会正确地看到“重复条目”异常，并且会话正在正确回滚和关闭。

另一个问题是，当 hibernate 抛出`AssertionFailure`. 请参阅：[https ://stackoverflow.com/a/39397836/179850](https://stackoverflow.com/a/39397836/179850)

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2020-01-17T12:04:31.513

在以下情况下发生在我身上：

1.  新实体被持久化。

2.  实体配置有`javax.persistence.EntityListeners`。`javax.persistence.PostPersist`运行。

3.  `PostPersist`需要来自数据库的一些数据来通过`STOMP`. 执行`org.springframework.data.repository.PagingAndSortingRepository`查询。

4.  例外。

我通过在以下内容中使用以下内容来修复它`EntityListeners`：

```
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.scheduling.concurrent.ThreadPoolTaskScheduler;
import java.time.Instant;
...

ThreadPoolTaskScheduler scheduler = ApplicationContextHolder.getContext().getBean(ThreadPoolTaskScheduler.class);
scheduler.schedule(() -> repository.query(), Instant.now()); 
```

其中`ApplicationContextHolder`定义为：

```
import org.springframework.beans.BeansException;
import org.springframework.context.ApplicationContext;
import org.springframework.context.ApplicationContextAware;
import org.springframework.stereotype.Component;

@Component
public class ApplicationContextHolder implements ApplicationContextAware {

    private static ApplicationContext context;

    @Override
    public void setApplicationContext(ApplicationContext applicationContext) throws BeansException {
        context = applicationContext;
    }

    public static ApplicationContext getContext() {
        return context;
    }
} 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2020-05-07T16:12:20.583

在我的情况下，问题是实体字段的长度参数。当我试图在其中一个字段中保存一个字符串值过长的对象时，我得到了错误。解决方案是在休眠配置中设置参数“length”的正确值。

```
<property name="status" type="string" length="150" not-null="false" access="field"/> 
```

也可以使用注释 @Length 来完成，如下所示：

```
@Length(max=150)
private String status; 
```

在我的情况下，休眠异常的消息非常具有误导性，堆栈跟踪也是如此。找到问题发生位置的最快方法是使用调试器跟踪您的代码并评估*session.flush();* 在每个*save()*和*saveOrUpdate()*方法之后。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2012-06-10T22:16:51.707

这与正在执行的查询无关。这只会触发冲洗。此时 Hibernate 正在尝试为实体分配一个标识符，但似乎由于某种原因失败了。

您能否尝试更改生成器类：

```
<generator class="identity"/> 
```

看看这是否有所作为。您是否还确保已部署的数据库在表上设置了正确的自动递增列？

听起来您的问题与[此](https://stackoverflow.com/questions/1838520/hibernate-problems-with-auto-increment-id-mysql-5)类似。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2015-05-07T09:38:06.503

更改生成器类：

```
<generator class="identity" /> 
```

至

```
<generator class="assigned" /> 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2019-08-08T15:51:36.977

当我制作 session.getCurrentSession.refresh(entity) 时，我遇到了同样的错误，它对我来说更像是一个错误，而不是我的代码问题。当我尝试在测试开始时刷新实体并且该实体是在测试设置中创建的（使用 junit 的 @Before 注释）时，我在单元测试中遇到此错误。奇怪的是，我在设置中以相同的方式同时使用随机数据从同一个类创建 3 个实体，我可以刷新创建的前两个，但最后一个刷新失败。因此，例如，如果我在测试设置中创建 3 个实体用户，我可以刷新用户 1 和用户 2，但用户 3 失败。我能够通过在设置中创建实体的代码末尾添加 session.flush() 来解决此问题。我不 不会出现任何错误，我应该这样做，但我无法解释为什么需要额外的刷新。此外，即使没有刷新，我也可以确认实体实际上在测试数据库中，因为我可以在测试中查询它们，但仍然无法通过 refresh(entity) 方法。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2021-03-14T17:32:00.167

就我而言，我追踪了错误并发现我没有将表的**主键**（即 'ID' ）标记为 'Auto_Increment' **AI**。只需勾选 AI 复选框即可。 [![在此处输入图像描述](../Images/805b137528b9777dda8e5ec8ef2dec07.png)](https://i.stack.imgur.com/yeYl7.png)

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2018-07-10T14:54:15.770

有时，当字符串的长度大于 DB 允许的长度时，会发生这种情况。

`DataIntegrityViolationException`转换为这个异常，这是休眠的一种奇怪行为。

因此，如果您`Column`在指定长度的实体的 String 字段上有注释并且实际值大于该长度，则会引发上述异常。

参考：[https ://developer.jboss.org/thread/186341?_sscc=t](https://developer.jboss.org/thread/186341?_sscc=t)

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2019-01-17T06:31:14.697

我有同样的错误。就我而言，这是因为在此异常之前我执行了异常的创建查询。异常被捕获并且不回滚捕获块中的事务。然后我在其他操作中使用这个损坏的事务，几次后我得到了同样的异常。起初我将冲洗模式设置为手动

```
public final Session getCurrentSession()  
{
    Session session = sessionFactory.getCurrentSession();
    session.setFlushMode(FlushMode.MANUAL);
    return session;
} 
```

然后我得到了另一个例外，它向我解释了实际上发生的事情。然后我在我的 create 方法的 catch 块中完成了事务回滚。它对我有帮助。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2016-11-23T03:36:02.857

我也有同样的例外，在休眠配置文件中：

```
<property name="operateType" type="java.lang.Integer">
        <column name="operate_type" not-null="true" />
 </property> 
```

在对象上传递空值时，发生异常

```
 "org.hibernate.AssertionFailure: null id in com.idex.auctions.model.Address entry", 
```

我认为原因是因为 Hibernaye 将检查 'not-null' 属性，因此，删除 'not-null' 属性或将 'not-null' 设置为 'false' 将解决问题。

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2021-10-14T08:41:16.623

我不知道我是否迟到了，但我的问题是我正在打开一个事务并提交-> 刷新-> 在请求后关闭。但是，在这些之间，我是否有一个 nhibernate save() 运算符会自动执行此操作，在这种情况下它会抱怨。

抛出异常：

```
session.BeginTransaction();
model.save(entity);
session.Transaction.commit(); 
```

为我解决

```
model.save(entity) //this one should open transaction, save and commit/flush by itself 
```

然而很多人说你应该同时使用，例如[NHibernate： Session.Save 和 Transaction.Commit](https://stackoverflow.com/questions/1332849/nhibernate-session-save-and-transaction-commit)。

但是由于某种原因，它现在对我有用，没有交易..

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2018-08-31T11:50:04.533

org.hibernate.AssertionFailure: null id in entry（发生异常后不要刷新Session）

您在使用 save 方法时遇到此错误，如果您维护用户活动的版本历史并尝试设置以下值 `setCreatedBy(1); setModifiedBy(1); setCreationDate(); setChangeDate();` } 您将收到上述错误以解决此问题，您需要在表上创建以下列。

`Created_By Modified_By Creation_Date Change_Date` 如果您在 Update 方法解决此问题时遇到相同的错误只需将 Update() 方法更改为 merge() 方法，希望对您有所帮助。

* * *

## 回答 #20

> 赞同：-1
> 
> 时间：2013-07-12T12:13:28.677

在 catch 块中回滚您的事务

# java - JPA 和一组枚举值

> ID：10855543
> 
> 赞同：2
> 
> 时间：2012-06-01T18:29:22.593
> 
> 标签：java, hibernate, jpa

有没有一种简单的方法来使用 JPA（使用 Hibernate）来存储枚举项的集合/列表？列表中不能有重复项。我目前尝试：

```
public EnumSet<MediaRole.MediaRoleEnum> mediaRoles; 
```

但这在访问该字段时会返回一个空指针。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-01T18:33:56.170

只需使用：

```
List<MediaRole.MediaRoleEnum> mediaRoles;
Set<MediaRole.MediaRoleEnum> mediaRoles; 
```

取决于你的需要。检查[您将哪种 Java 类型用于 JPA 集合，为什么？](https://stackoverflow.com/questions/4655392/which-java-type-do-you-use-for-jpa-collections-and-why)

在映射文件中：

```
<attributes>
    <element-collection name="mediaRoles"/>
</attributes> 
```

如果您使用注释，只需使用等效的注释：

```
@ElementCollection
List<MediaRole.MediaRoleEnum> mediaRoles; 
```

# c++ - 选择字体对话框：munges 字体名称无法重新加载

> ID：10855546
> 
> 赞同：2
> 
> 时间：2012-06-01T18:30:06.307
> 
> 标签：c++, winapi, mfc

我发现 Win32 ChooseFont() API 的行为有些奇怪，更重要的是不一致。

```
LOGFONT lf = { 0 };
strcopy(lf.lfFaceName, m_face_name);
const int ppi = GetDeviceCaps(pView, LOGPIXELSY);
lf.lfHeight = -MulDiv(m_font_height, ppi, 72);
CFontDialog fd(&lf);
if (fd.DoModal() != IDOK)
    return;
m_face_name = fd.GetFaceName();
m_font_height = lf.lfHeight; 
```

假设第一次，人脸名称是“Segoe UI”，这是可行的。

但是如果用户将对话框更改为“Segoe UI”、“Light”、“9”、（面部、样式、高度），并且我们再次执行上述操作，则字体选择常用对话框无法选择“ Segoe UI”作为人脸名称。相反，我将 Font: 字段设为空白。

如果用户选择“Regular”、“Italic”、“Bold”、“Bold Italic”的样式，这不是问题，因为这些样式存储在样式位中，并且不会混淆名称。我在第二次运行时丢弃它们，因为我忽略了它们（我会禁用字体样式：如果有一种方法可以轻松做到这一点 - 我不希望为此子类化 CFontDialog - 这是一个完整的“另一个时间级别”和此刻不允许的努力）。

我尝试根据对话框中的先前细节创建一种字体，然后尝试将 LOGFONT 拉出。没有骰子。

同样，我尝试在对话框中查询 FontStyle() - 但它返回空白 - 所以这里没有什么可以从字体名称中删除......

这似乎是 MS 对话框的一个错误 - 它告诉我一件事，但随后无法使用它自己的输出在第二次通过时正确初始化自身（当然，在这种情况下，我只是保留了部分而不是全部 LOGFONT ）。

有谁知道 WTH 有这个想法吗？或者我可能会使用的一种方法（在字体名称末尾寻找“Light”的硬编码 - 太糟糕了！）？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-02T00:57:06.193

字体设计的发展已经大大超过了传统 api 跟上的能力。OpenType 发生了，其中之一。除了 LOGFONT 可以支持的字体样式之外，还有其他字体样式。对于 Segoe UI，控制粗体的属性可以是 Light 和 Semibold。对于其他字体，字体拉伸是另一个属性，常见的有 Condensed 和 Expanded。字体能够实现专用的字体文件以使这些样式看起来不错，而不是像过去那样依赖于从现有字体中合成样式。查看 WPF FontStretch 和 FontWeight 枚举类型以获取可能的值。

这些是 LOGFONT 无法表达的属性。有一个兼容性黑客来处理这个问题，类型面孔名称被映射。所以风格为“Light”的“Segoe UI”变成了“Segoe UI Light”。Windows 字体映射器将从这样的名称中选择正确的 true-type 字体文件。然而不起作用的是用“Segoe UI Light”初始化 LOGFONT.lfFaceName。实际上不知道为什么，可能避免不必处理歧义。或者只是简单的失败。一种可能的解决方法是在字体名称中识别这些附加的样式名称，但这也不完美。

GDI 的汽油用完了。很像 User32。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-06-01T19:25:55.000

首先，当您在 proc 中初始化 LOGFONT 时，不能只将其设置为 0

```
ala "= { 0 };" 
```

使用类似的东西

```
memset(&lf, 0, sizeof(lf)); 
```

否则你的 lf 在你的 proc 中包含随机废话。其次，不保存LOGFONT结构的所有设置有什么大不了的？如果您使用的是 MFC，这并不是因为它的开销太大。如果修复 lf 的初始化不起作用，只需保存整个 LOGFONT。

# file - 在 C++ 中通过 TCP 套接字管道传输文件

> ID：10855553
> 
> 赞同：0
> 
> 时间：2012-06-01T18:30:36.213
> 
> 标签：file, sockets, tcp, pipe, transfer

我有一个关于创建顺序套接字管道以通过 N-Hops 路径（S - - - > M1 - - - > M2 - - - > M3 - - - > D）转发 TCP 流的问题。S 的目标是通过 TCP 套接字将文件发送给 D。因此，所有节点 M1、M2 和 M3 将在两种模式下运行，服务器和客户端，除了 S 和 D，它们将仅在一种模式下运行。

我的问题是：我可以创建一个套接字管道来形成这条路径，以便 M1 从 S 接收第一个数据包，它将直接转发到 M2 等等（即，无需等待任何 M 接收整个文件，只需立即发送您收到的任何内容）？并且基于可用的客户端/服务器 TCP 套接字模型，如果可行，执行此任务需要什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-01T23:56:01.493

是的，您可以...但是您需要使用事件循环对每台机器进行编程（即套接字层不会为您执行此操作）。

我这样做的方法是让每台机器围绕 select() 运行一个事件循环，使用几个非阻塞套接字（一个用于传入数据，一个用于传出数据）。每个进程都有一个小的（8kB？）内部缓冲区，用于临时存储它想要转发的一些数据。

然后您的选择循环将按照以下规则运行：

1) 每当内部缓冲区未满时，告诉 select() 您希望在传入数据套接字有数据可供您读取时收到通知。

2) 每当内部缓冲区超过空时，告诉 select() 您希望在传出数据套接字有缓冲区空间可供您写入时收到通知。

3) 每当 select() 向您指示传入数据套接字有数据可供您读取时，将一些数据从传入数据套接字读取到您的临时本地缓冲区中。（您读取的数量将受到传入数据套接字上可用数据量和本地缓冲区中可用空间量的限制，以较小者为准）

4) 每当 select() 向您指示传出数据套接字有缓冲区空间可写入时，从临时本地缓冲区将一些数据写入传出数据套接字。（您写入的数量将受到传入数据套接字的数据量和传出套接字当前可以接受的空间量的限制，以较小者为准）

鉴于上述逻辑，字节将以相当流水线的方式从每个节点流向下一个节点。

（这里没有描述通过 socket()、connect() 或 bind()/listen()/accept() 处理和设置套接字的错误，但这也是必要的）

# clojure - 使用“lein run”运行时不会触发关闭挂钩

> ID：10855559
> 
> 赞同：19
> 
> 时间：2012-06-01T18:31:06.680
> 
> 标签：clojure, leiningen, shutdown-hook, clojure-java-interop

我有以下代码：

```
(ns test-hook.core)

(defn -main []
  (.addShutdownHook (Runtime/getRuntime) (Thread. #(println "shutdown")))
  (println "start")
  (doseq [i (range 1 6)]
    (Thread/sleep 1000)
    (println i))) 
```

和以下 project.clj

```
(defproject test-hook "1.0.0-SNAPSHOT"
  :aot :all
  :main test-hook.core
  :description "FIXME: write description"
  :dependencies [[org.clojure/clojure "1.2.0"]]) 
```

当我使用“lein run”运行它时，关闭挂钩仅在正常程序执行时执行，而不是在接收 SIGINT (Ctrl-C) 时执行

即使在接收到 SIGINT 时，在 lein 之外运行的相同代码也会成功执行关闭挂钩。

从 lein 运行并使用 Ctrl-C 中止时，如何执行关闭挂钩？

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2012-06-02T16:16:24.807

你试过用蹦床跑吗？

```
lein trampoline run 
```

似乎对我有用。

AFAIK“lein trampoline”不会嵌套 JVM，因此您的 Ctrl-C 不会被 leiningen 捕获，而是被您的代码捕获。

# ruby - Ruby 类名在符号列表中，但解释器无法识别

> ID：10855568
> 
> 赞同：0
> 
> 时间：2012-06-01T18:31:41.507
> 
> 标签：ruby, interpreter, symbols

我正在学习符号，当我将文件中的所有符号作为文件`Symbol.all_symbols`的第一行转储时，我惊讶地发现文件中的所有符号都包含在数组中。但是，如果我尝试访问一个在下面定义的类，我会得到`NameError`，换句话说，它是一个无法识别的符号。

```
puts "DefinedAtEnd is in symbol list: \
 #{Symbol.all_symbols.select {|s| s =~ /^DefinedAtEnd/} != nil} "
puts "do_it is in symbol list: \
 #{Symbol.all_symbols.select {|s| s =~ /^do_it/} != nil} "
puts "foo is in symbol list: #{Symbol.all_symbols.select {|s| s =~ /^foo/} != nil} "

#d = DefinedAtEnd.new    # This will get a NameError

class DefinedAtEnd
  def do_it
    foo = 'bar'
    puts 'In method do_it'
  end
end 
```

运行上面得到这个结果：

```
DefinedAtEnd is in symbol list: true 
do_it is in symbol list: true 
foo is in symbol list: true 
```

但是，如果我取消注释该行`d = DefinedAtEnd.new`，则会收到以下错误：

```
uninitialized constant DefinedAtEnd (NameError) 
```

似乎解析器（metparser？）在开始“执行”代码行之前对整个文件进行了一次解析，但它还没有构建类。也许这是某种“预通行证”？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T18:34:57.323

该文件被逐行解释；您不能在尚未定义*的代码中引用某些内容——读取与初始化不同。*

Ruby 1.9.2 输出以下内容，这可能更具启发性：

```
foo2.rb:7:in `<main>': uninitialized constant Object::DefinedAtEnd (NameError) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-01T20:42:16.753

解析源文件和执行其代码是有区别的。它分两个阶段发生。在解析过程中，对象的名称（包括类名和理论上可能分配的所有变量）被嵌入到符号表中。也就是说，这是一个你可能不应该依赖的实现细节（更是如此，因为你不能真正用它做任何有用的事情）。

通常，符号是内部字符串，即永远不会被垃圾收集并且在整个解释器中只存在一次的字符串。

```
"foo".object_id == "foo".object_id   # => false
:foo.object_id == :foo.object_id     # => true 
```

与字符串不同，符号也不能原地更改，它们是不可变的。

# android - Android UI 在图形布局和 AVD 中的显示方式不同

> ID：10855571
> 
> 赞同：0
> 
> 时间：2012-06-01T18:31:57.227
> 
> 标签：android, android-layout, android-edittext

我尝试制作一个圆形的 EditText。它在 main.xml 的图形布局中很好地显示。但是当我启动 AVD 时它仍然是方形的。这是代码：

```
<EditText
        android:id="@+id/et"
        android:layout_width="300dp"
        android:layout_height="wrap_content"
        android:padding="5dp"
        android:hint="Enter a #hashtag or keyword"
        android:textColor="#000000"
        android:drawableLeft="@drawable/magnifier"
        android:background="@drawable/rounded_edittext"
        android:textSize="16dp" >
        <requestFocus />
    </EditText> 
<!-- res/drawable/rounded_edittext.xml -->     <shape xmlns:android="http://schemas.android.com/apk/res/android"
android:padding="10dp"
android:shape="rectangle" >
<solid android:color="#FFFFFF" />
<corners
    android:bottomLeftRadius="15dp"
    android:bottomRightRadius="15dp"
    android:topLeftRadius="15dp"
    android:topRightRadius="15dp" /> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-01T18:47:07.913

这是一个圆形的编辑文本，它也改变了点击状态，只需使用这些 xml

```
<?xml version="1.0" encoding="utf-8"?>
<!-- res/drawable/rounded_edittext_states.xml -->
<selector xmlns:android="http://schemas.android.com/apk/res/android">
    <item 
     android:state_pressed="true" 
     android:state_enabled="true"
        android:drawable="@drawable/rounded_focused" />
    <item 
     android:state_focused="true" 
     android:state_enabled="true"
        android:drawable="@drawable/rounded_focused" />
    <item 
     android:state_enabled="true"
        android:drawable="@drawable/rounded_edittext" />
</selector> 
```

正常的圆形编辑文本：

```
<?xml version="1.0" encoding="utf-8"?>
<!--  res/drawable/rounded_edittext.xml -->
<shape xmlns:android="http://schemas.android.com/apk/res/android"
android:shape="rectangle" android:padding="10dp">
 <solid android:color="#FFFFFF"/>
    <corners
     android:bottomRightRadius="15dp"
     android:bottomLeftRadius="15dp"
  android:topLeftRadius="15dp"
  android:topRightRadius="15dp"/>
</shape> 
```

按下，集中编辑文本

```
<?xml version="1.0" encoding="utf-8"?>
<!-- res/drawable/rounded_edittext_focused.xml -->
<shape xmlns:android="http://schemas.android.com/apk/res/android"
android:shape="rectangle" android:padding="10dp">
 <solid android:color="#FFFFFF"/>
 <stroke android:width="2dp" android:color="#FF0000" />
    <corners
     android:bottomRightRadius="15dp"
     android:bottomLeftRadius="15dp"
  android:topLeftRadius="15dp"
  android:topRightRadius="15dp"/>
</shape> 
```

而且...现在， EditText 应该如下所示：

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:orientation="vertical"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent">
<EditText  
    android:layout_width="fill_parent" 
    android:layout_height="wrap_content" 
    android:text="@string/hello"
    android:background="@drawable/rounded_edittext_states"
    android:padding="5dip"/>
</LinearLayout> 
```

我使用此布局对其进行测试，即使使用多轮编辑文本它也适用于我：

这是我使用的布局

```
<?xml version="1.0" encoding="utf-8"?>
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:orientation="vertical" >

    <EditText
        android:id="@+id/et"
        android:layout_width="300dp"
        android:layout_height="wrap_content"
        android:background="@drawable/rounded_edittext"
        android:drawableLeft="@drawable/ic_launcher"
        android:hint="Enter a Login"
        android:textColor="#000000"
        android:textSize="16dp"
        android:padding="5dp">
        <requestFocus />
        </EditText>

        <EditText
            android:id="@+id/et2"
            android:layout_width="300dp"
            android:layout_height="wrap_content"
            android:layout_alignParentLeft="true"
            android:layout_below="@+id/et"
            android:layout_marginTop="14dp"
            android:background="@drawable/rounded_edittext"
            android:drawableLeft="@drawable/ic_launcher"
            android:ems="10"
            android:hint="Enter a Password"
            android:padding="5dp"
            android:textColor="#000000"
            android:textSize="16dp" />

</RelativeLayout> 
```

这是模拟器上结果的屏幕截图：

![在此处输入图像描述](../Images/ebb707d1bb051b830a56a043c5333f3f.png)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-01T18:55:01.423

// 感觉你的rounded_edittext.xml有问题。

你能去掉这2行吗

```
android:padding="10dp"
android:shape="rectangle" 
```

//或者你可以使用myshape.xml

```
<?xml version="1.0" encoding="UTF-8"?> 
<shape xmlns:android="http://schemas.android.com/apk/res/android"> 
    <solid android:color="#FAFFFA"/>    

    <corners android:bottomRightRadius="15dp" android:bottomLeftRadius="15dp" 
     android:topLeftRadius="15dp" android:topRightRadius="15dp"/>

 <stroke android:width="3dp" android:color="#C3C3C3"/> 

</shape> 
```

# css - 将图像定位在以流体为中心的 div 之外

> ID：10855572
> 
> 赞同：0
> 
> 时间：2012-06-01T18:32:06.453
> 
> 标签：css, positioning

![在此处输入图像描述](../Images/8738190faef0d9448800f62a3cb47592.png) 我在尝试将图像定位到居中 div 的右侧时遇到问题。此代码适用于 Chrome 和 Safari，但不适用于 IE8 或 Firefox。Chrome版本是我要的，而不是如图所示的IE版本。谢谢！

```
#page {
width: 90%;
max-width: 1400px;
min-width: 600px;
margin: 0 auto;
overflow: hidden;
background: 
white;
}

<div style="width: 90%; max-width: 1400px; min-width: 600px; margin: 0 auto;">
  <div style="float: right; position: relative; z-index: 200; bottom: 4px; left: 20px;">
    <a href="<?php echo tep_href_link('specials.php');?>"><img src="images/clearance-tab-vert.png"></a>
  </div>
</div>
<div id="page">
blah
</div> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-01T18:43:30.810

看到这个小提琴：http: [//jsfiddle.net/QLBjX/2/](http://jsfiddle.net/QLBjX/2/)

```
#page {
width: 90%;
max-width: 1400px;
min-width: 600px;
margin: 0 auto;
overflow: hidden;
background: 
white;
}

<div id="page">
blah
<div style="float:right; background:black; width:100px; height:100px";>
<a href="<?php echo tep_href_link('specials.php');?>"><img src="images/clearance-tab-vert.png" width="100" height="100"></a>
</div>
</div> 
```

# asp.net-mvc-3 - 如何在使用 unitofwork 和通用存储库的控制器中最小化服务

> ID：10855573
> 
> 赞同：1
> 
> 时间：2012-06-01T18:32:12.313
> 
> 标签：asp.net-mvc-3, tdd, moq, unit-of-work

我是 TDD（Asp.net MVC3 环境）的新手，并试图采用 TDD 作为我们更好的开发方法。

在我们的生产代码中，我们有以下场景

## 在网络中

```
//Autofac used to resolve Dependency
TestController(XService xSerivice,YSerivice yService) 
{_xService =xService,_YService= yService}

[HTTPPost]
ActionResult Create(A1 a1)
{
  _xService.XUnitOfWork.A1.add(a1)
  _xService.XUnitOfwork.SaveChanges();

} 
```

// 其中X，Y是不同的上下文，具体的类，没有实现接口！

## 在业务层

`Xservice(XUnitofWork)` // 没有实现接口！

**在 DAL 层**

```
'XUnitofWork:DataRepostory(Generic)...
    {
      GenericRepository<a1Entity> A1,
      GenericRepository<a2Entity> A2
    } 
```

现在我意识到我们应该在 BAL 层和 Web 层中都实现接口。我的问题是有什么方法可以在我们的控制器中模拟服务（XService，YService）以测试某些行为（TDD）[例如，通过' `_xService.XUnitOfwork.SaveChanges()`'保存实体时发生保存更改异常？

请帮助。在此先感谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-01T18:59:34.087

如果您将具体类中的成员（属性、方法）标记为`virtual`，我认为您可以单独模拟这些方法/属性。（我认为虚拟的 VB 等价物是 Overridable..？）

Moq 通过在测试运行时在运行时创建新的具体实现来工作。这就是为什么它与接口和抽象类一起工作得如此好。但是如果没有接口或抽象类，则需要重写一个方法或属性。

**回复问题作者的回答：**

由于您自称是 TDD 新手，我只想指出，仅仅为了使类可测试而向类添加无参数构造函数不应该是一个可接受的解决方案。

通过为您的 GenericRepository 类提供对实体框架的 DbSet / IDbSet 的硬依赖，您正在创建存储库实现和 EF 之间的紧密耦合......请注意该`using System.Data.Entity`文件顶部的行。

每当您决定添加构造函数依赖项时，您都应该认真考虑将其添加为接口或抽象类。如果您需要访问您无法控制的库的成员（例如 EF 的 DbContext），请按照[Morten 的回答](https://stackoverflow.com/a/10878074/304832)并将功能包装在您自己的自定义界面中。

在 DbContext 的情况下，此类不仅仅是为您提供 UnitOfWork 实现。它还为您提供了一种查询数据并在存储库中添加/替换/删除项目的方法：

```
public interface IUnitOfWork
{
    int SaveChanges();
}

public interface IQuery
{
    IQueryable<TEntity> GetQueryable<TEntity>() where TEntity : class;
}

public interface ICommand : IQuery
{
    void Add(object entity);
    void Replace(object entity);
    void Remove(object entity);
} 
```

您可以很容易地将 DbContext 包装在这 3 个接口中，如下所示：

```
public class MyCustomDbContext : DbContext, IUnitOfWork, ICommand
{
    // DbContext already implements int SaveChanges()

    public IQueryable<TEntity> GetQueryable<TEntity>() where TEntity : class
    {
        return this.Set<TEntity>();
    }

    public void Add(object entity)
    {
        this.Entry(entity).State = EntityState.Added;
    }

    public void Replace(object entity)
    {
        this.Entry(entity).State = EntityState.Modified;
    }

    public void Remove(object entity)
    {
        this.Entry(entity).State = EntityState.Deleted;
    }
} 
```

请注意您的接口如何不依赖于`System.Data.Entity`. 它们使用原语和标准 .NET 类型，如`object`、`IQueryable<T>`和`int`. 这样，当您为接口提供通用存储库依赖项时，您可以删除对 System.Data.Entity 的依赖项：

```
// using System.Data.Entity; // no need for this dependency any more

public class GenericRepository
{
    private readonly ICommand _entities;
    private readonly IQueryable<TEntity> _queryable;

    public GenericRepository(ICommand entities)
    {
        this._entities = entities;
        this._queryable = entities.GetQueryable<TEntity>();
    }

    //public GenericRepository()
    //{ 
        // no need for a parameterless constructor!
    //}
} 
```

...并且您的 GenericRepository 现在是完全可单元测试的，因为您可以轻松地模拟任何这些接口方法。

**最后说明：**

此外，在看到您对自己问题的回答后，您似乎将 CompanyRepository 作为 UnitOfWork 类的属性。然后，您将 UnitOfWork 作为对 CompanyInformationController 的依赖项注入。这是倒退。相反，您应该将 CompanyRepository（或其接口）注入控制器的构造函数。UnitOfWork 模式与维护已知存储库的引用无关。它是关于跟踪对相关项目所做的多项更改，以便它们都可以作为单个事务推送一次。EF 会自动执行此操作，因此只要 AutoFac 提供相同的 DbContext 实例，无论您的应用程序请求 IQuery、ICommand 还是 IUnitOfWork 实现，那么 UnitOfWork 应该关注的唯一方法是 SaveChanges()。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-02T11:13:04.563

感谢您的回复。在花了几个小时并更改了我以前的代码后，我试图做的测试是成功的。更改如下： 1) 现在在我的控制器中使用 UnitofWork 而不是冗余服务。2) 向 GenericRepository 类添加了一个无参数构造函数。（没有任何 DBContext！），因为它将需要一个 DBContext 作为构造函数中的参数，不能通过提供模拟 DBContext 来替代。

**GenericRepository：** 公共类 GenericRepository 其中 TEntity ：类 {

```
 internal DbContext _context;
    internal DbSet<TEntity> dbSet;

    public GenericRepository(DbContext context)
    {
        this._context = context;
        this.dbSet = context.Set<TEntity>();
    }
    public GenericRepository()    //newly added!
    { 

    } 
```

…………………………………………………………………………

**完成测试**

```
 [TestMethod]
    public void Index_Return_OneModel_WhenCalling()
    {
        //arrange

        AutoMapperExtension automapper = new AutoMapperExtension();          
        var moqentities = new Mock<SetupEntities>();                
        List<CompanyInformation> list =new List<CompanyInformation>();
        list.Add(new CompanyInformation{ CompanyName = "a", CompanyAddress = "aa", Id = 1});
        list.Add(new CompanyInformation { CompanyName = "b", CompanyAddress = "b", Id = 2 });                 
        var unitOfWork = new Mock<UnitOfWork>(moqentities.Object);
        unitOfWork.Setup(d => d.CompanyRepository).Returns(new GenericRepository<CompanyInformation>());
        unitOfWork.Setup(d => d.CompanyRepository.GetAll()).Returns(list.AsQueryable());

        var controller = new CompanyInformationController(unitOfWork.Object);          

        //Act
        var result =(ViewResult) controller.Index();
        var model =(CompanyInformationViewModel)  result.ViewData.Model;

        //Assert
        Assert.AreEqual(1, model.Id);           

    } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-04T07:59:42.743

最好的方法是为 XService 创建一个接口。如果由于某种原因这是不可能的（如果 XService 是不实现接口的第三方类），则考虑将功能包装在具有接口的包装类中。

# java - 在休眠命名查询中调用自定义函数

> ID：10855579
> 
> 赞同：0
> 
> 时间：2012-06-01T18:32:39.083
> 
> 标签：java, hibernate, hql

我试图在命名查询中调用一个函数，但我得到：

```
java.lang.IllegalStateException: No data type for node:     org.hibernate.hql.ast.tree.MethodNode 
 \-[METHOD_CALL] MethodNode: '('
    +-[METHOD_NAME] IdentNode: 'MYFUNCTION' {originalText=MYFUNCTION}
    \-[EXPR_LIST] SqlNode: 'exprList'
       \-[NUM_INT] LiteralNode: '1' 
```

我的查询类似于

```
@NamedQuery(name = "myQuery",
            query = " select r, MYFUNCTION(r.id) from ResPO r "
                + " where  r.status like 'A'") 
```

如果我简化查询，一切正常：

```
@NamedQuery(name = "myQuery",
        query = " select r from ResPO r "
            + " where  r.status like 'A'") 
```

错误是什么？谢谢++

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T20:16:09.760

您可以通过扩展您正在使用的方言并通过调用该`registerFunction()`方法来注册您的功能来做到这一点。

[http://docs.jboss.org/hibernate/orm/3.5/api/org/hibernate/dialect/Dialect.html#registerFunction%28java.lang.String,%20org.hibernate.dialect.function.SQLFunction%29](http://docs.jboss.org/hibernate/orm/3.5/api/org/hibernate/dialect/Dialect.html#registerFunction%28java.lang.String,%20org.hibernate.dialect.function.SQLFunction%29)

# iphone - 应用程序中多个 UIWindow 的最佳实践

> ID：10855586
> 
> 赞同：0
> 
> 时间：2012-06-01T18:32:58.777
> 
> 标签：iphone, objective-c, ios, ipad, uiwindow

专家，请分享在当前窗口顶部添加 UIWindow 时必须注意的最佳方法和实践。（Window1）我有一种情况，我在视图控制器中将视图“A”的方向锁定为肖像。然后我创建一个新的 UIWindow 并将其设置为键和可见。这个新 UIWindow 的根视图控制器又是一个支持所有方向的视图控制器。我遇到的问题是，每当我将前一个窗口（比如 window1）作为键并再次可见时，并尝试旋转设备，即使视图保持锁定到特定方向（比如纵向），状态栏也在旋转，看起来非常奇怪。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-25T23:03:56.090

我认为将自定义警报旋转到应用程序不支持的方向是一个坏主意。反正。为了防止状态栏旋转，您应该删除第二个窗口

```
[alertWindow setHidden:YES]; 
[alertWindow release]; 
alertWindow=nil; 
```

在您的警报消失后。

你也可以考虑有用这个喜欢：

*   [https://github.com/eigner/CODialog](https://github.com/eaigner/CODialog)
*   [https://github.com/gpambrozio/BlockAlertsAnd-ActionSheets](https://github.com/eaigner/CODialog)
*   [https://github.com/kyoshikawa/ZPopoverController](https://github.com/kyoshikawa/ZPopoverController)
*   [https://github.com/TomSwift/TSAlertView](https://github.com/TomSwift/TSAlertView)

# algorithm - 在给定角的值、一阶和二阶导数的情况下，在正方形的中点插入值的方法？

> ID：10855588
> 
> 赞同：2
> 
> 时间：2012-06-01T18:33:18.847
> 
> 标签：algorithm, interpolation, spline, spatial-interpolation

所有空间插值的实际例子我都能够通过采样额外的周围点来估计导数来找到工作。但是，如果导数已知，并且您只需要已知点中心的单个点的值（和导数），是否有更简单的方法？

举例说明：假设对于每个点`(1, 1)`、`(-1, 1)`、`(-1, -1)`，并且`(1, -1)`您知道`f(x, y)`、`f'(x)`、`f''(x)`、`f'(y)`和- 并且您想要在for 、、、和处的`f''(y)`插值。`(0, 0)``f(x, y)``f'(x)``f''(x)``f'(y)``f''(y)`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T22:14:28.023

首先，提出的问题没有意义。在多变量微积分中，我们没有导数，我们有偏导数。其中很多。

假设您在拐角处有值、一阶偏导数和二阶偏导数。所以在每个角落我们知道值，x 的部分，y 的部分，x 的第二个部分，x 的第二个部分，y 的第二个部分和 y 的第二个部分。我们每个角有 6 条数据，总共 24 条数据。

接下来我们要做的是尝试将其拟合到适当的多项式。24 项，即`a0 + a1 x + a2 y + a3 x^2 + a4 x y + a5 y^2 + a6 x^3 + a7 x^2 y + a8 x y^2 + a9 y^3 + a10 x^4 + a11 x^3 y + a12 x^2 y^2 + a13 x y^3 + a14 y^4 + a15 x^5 + a16 x^4 y + a17 x^3 y^2 + a18 x^2 y^3 + a18 x y^4 + a19 y^5 + a20 x^6 + a21 x^4 y^2 + a22 x^2 y^4 + a23 y^6`. （我不得不省略一些 6 次方，因为我已经达到了 24 的限制。）

如果你计算出来，将所有这些值与所有这些点进行匹配，你会得到 24 个变量中的 24 个方程。求解，你得到所有要使用的系数。插入该值`(0, 0)`，您就有了插值。

直截了当，乏味，不适合胆小的人。

# javascript - 为什么我的 Google maps api v3 和侧面板在调整大小时没有填满我的页面？

> ID：10855589
> 
> 赞同：1
> 
> 时间：2012-06-01T18:33:40.477
> 
> 标签：javascript, css, google-maps-api-3, colors, positioning

我正在开发一个网页，左侧有一个带有搜索栏的侧面板，右侧有一个谷歌地图 api v3 填充页面的其余部分。当我将浏览器垂直缩小时，侧面板和地图以及浏览器底部之间有一个空白区域。但是，文本继续到浏览器的底部。看起来像：![在此处输入图像描述](../Images/923817b9b4b51acd6dff75515e543743.png)

这是我的CSS代码：

```
<style type="text/css">

    body {margin:0;}
        #panel {height:100%; width:300px; position:absolute; padding:0;background-color:#8C95A0;}
            #header {padding:2px; text-align:center}
            #address_instruction {position:relative; top:7%; padding:2px; text-align:center}
            #geocoder {position:relative; top:8%; padding:2px; text-align:center}
            #toggle_instruction {position:relative; top:22%; padding:2px; text-align:center}
            #layers {position:relative; top:25%; padding:2px; text-align:center}
                #layer0 {padding:2px; text-align:center}
                #layer1 {padding:2px; text-align:center}
                #layer2 {padding:2px; text-align:center}
            #link {top:50%; position:relative; padding:2px; text-align:center}
        #map_canvas {height:100%; left:300px; right:0px; position:absolute; padding:0;}

</style> 
```

#panel 中的 ID 指的是面板左侧的项目。为什么侧面板背景颜色和地图不延伸到浏览器底部？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-04T16:37:39.410

我能够通过更改以下内容并将其添加到#panel 来解决问题：{ position:fixed; 溢出：自动；}

# file - java me：如何清除文件

> ID：10855591
> 
> 赞同：3
> 
> 时间：2012-06-01T18:33:50.830
> 
> 标签：file, java-me

如何清除 J2ME 中的文件，使其变为空（无内容）？
所有输出流（`OutputStream, DataOutputStream, PrintStream...`）
只能`write()`将内容添加到文件中，而我看不到删除文件中的一个字节/字节的方法。

我使用 Netbeams 7.0.1

感谢您的帮助

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-01T19:05:33.177

像这样调用你的**write()**方法：

```
.write((new String()).getBytes()); 
```

这将使您的文件为空。

* * *

您还可以删除文件并创建一个新文件。这也将导致一个具有相同文件名的空文件。

# security - 当使用原始套接字进行 TCP 流量时，请阻止内核接收传入的数据包

> ID：10855594
> 
> 赞同：0
> 
> 时间：2012-06-01T18:34:00.443
> 
> 标签：security, sockets, testing, iptables

我正在运行一些需要使用非标准 TCP 套接字的安全测试，以生成普通 TCP 堆栈不会遵循的行为。我使用原始套接字来生成这样的流量。

当收到来自另一个端点的回复时，内核不知道 TCP 连接并发出 RESET。为防止这种情况发生，通常的解决方案是定义一个 iptables 规则来丢弃所有传出的 RESET（例如 iptables -A OUTPUT -p tcp -dport 50000 --tcp-flags RST RST -j DROP）。

但是，在我的特定情况下，RESET 也是在测试期间生成的有效段。我需要的是一种从该连接中过滤掉所有段的方法，以便不涉及内核 TCP 堆栈，但可以访问我的原始套接字中的所有段。任何想法我怎样才能做到这一点？这可能与 iptables 吗？

在此先感谢路易斯

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-01T19:40:15.983

试图使用主机的 IP 地址并与 Linux 的 TCP/IP 堆栈作斗争是自找麻烦。

相反，我会使用单独的 IP 地址，将其路由到 tun 设备并从 tun 设备获取原始 IP 数据包，而不是使用原始套接字（连接 tun 设备的一些示例代码可从[http://www. secdev.org/projects/tuntap_udp/](http://www.secdev.org/projects/tuntap_udp/)）。这样，Linux TCP/IP 堆栈就不会妨碍您（路由目的除外）。

# php - 在提交时更新文本框中的值？？PHP

> ID：10855596
> 
> 赞同：-2
> 
> 时间：2012-06-01T18:34:12.347
> 
> 标签：php, ldap

我有一个 PHP 网页。最初，文本框中的值是根据用户登录信息从 LDAP 目录中检索的。用户对值进行任何必要的更改，并单击提交文本框中的值得到更新，目录中的值也得到更新（我已经完成了这部分）。我是 PHP 新手，我想弄清楚如何在提交时更新文本框中的值。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-01T18:38:50.897

使用 PHP，您只能在对服务器进行 AJAX 调用时对提交进行更改。但是，您可以在服务器端提交后仅使用 PHP 进行更改。

如果没有 JavaScript 的帮助，直接“onsubmit”在浏览器中更新是不可能的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-01T18:40:43.620

您希望获取用户提交的值并在您的文本字段中重新显示它们。

就像是

```
<input type="text" name="phone_num" id="phone_num" value="<?php (isset($_POST['phone_num']) ? $_POST['phone_num'] : $valueFromLDAPDir) ?>" /> 
```

# excel - 组合多列的 IF 语句

> ID：10855598
> 
> 赞同：2
> 
> 时间：2012-06-01T18:34:20.677
> 
> 标签：excel, if-statement, multiple-columns

我正在使用 excel 2010 并希望使用 IF 语句来添加具有字母和数字的多个列。我已经把所有的编码都写进去了，这样当每个条件之一出现时，它们的总和是正确的。

我遇到的问题是是否有多个相同的条件。

例如，我使用的 IF 语句是：`=IF(ISNA(MATCH("1P",C7:CO7,0)),0,1)+IF(ISNA(MATCH("2P",C7:CO7,0)),0,2)`等等。

显然，在 C7 和 CO7 单元格之间有许多单元格，如果一个以上的单元格中有 1P 或 2P，则不会添加额外的单元格，而只会添加一个。如何让我的公式识别多个单元格中的条件？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T20:09:11.063

`=COUNTIF(C7:CO7,"1P")+2*COUNTIF(C7:CO7,"2P")`应该会给你你需要的答案

编辑：固定公式 - 感谢@Andy

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-01T21:16:48.553

If you are interested in a flexible approach that allows for an arbitrary number of match values and multipliers, you could try this.

Make a little table somewhere of Match Values and corresponding Multipliers and use this array formula:

```
=SUM(IF($C$7:$CO$7=$A$2:$A$5,$B$2:$B$5,0)) 
```

Commit the array formula by pressing `Ctrl+Shift+Enter`.

![enter image description here](../Images/b36759810957249d03be2aee6abe1e49.png)

*Note my screen shot truncates the data range. 14 is the correct answer for the data I entered.*

# php - Google 安全浏览 API 限制

> ID：10855601
> 
> 赞同：0
> 
> 时间：2012-06-01T18:34:39.293
> 
> 标签：php, google-api, safe-browsing

谁知道我可以检查多少个 url 以及我需要使用 safebrowsing api 的请求之间的时间限制。我将它与 PHP 一起使用，但在检查了 2k 个 URL 后，我得到了

抱歉，您的计算机或网络可能正在发送自动查询。为了保护我们的用户，我们现在无法处理您的请求。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-07T08:49:32.317

应该是 10.000

使用安全浏览查找 API [https://developers.google.com/safe-browsing/lookup_guide#UsageRestrictions](https://developers.google.com/safe-browsing/lookup_guide#UsageRestrictions)

和安全浏览 API v2 [https://developers.google.com/safe-browsing/developers_guide_v2#Overview](https://developers.google.com/safe-browsing/developers_guide_v2#Overview)

但你可以要求更多是免费的，他们说。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-09T01:42:48.413

我了解他们允许您每天进行 10k 请求。对于每个请求，您最多可以查询 500 个 URL，因此，它们总共可以让您每天查找 500 万个 URL，这还不错。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-07-04T12:14:52.043

我目前使用 Google Safe Browsing API，以下是 API 中的限制。

*   一个 API 密钥每 24 小时可以向多达 10,000 个客户端发出请求。
*   您可以在单个 POST 请求中查询多达 500 个 URL。

我之前每次使用一个请求，并以超出 API 定义的配额结束。但现在每个请求我最多设置 500 个 URL。它帮助我不超过 API 的限制，而且速度也非常快。

# jsf - 在 EJB 中进行验证时，如何在 jsf 中显示多条错误消息？

> ID：10855607
> 
> 赞同：0
> 
> 时间：2012-06-01T18:35:14.967
> 
> 标签：jsf, error-handling, ejb, validation

根据[这个](https://stackoverflow.com/questions/9783505/catch-db-exception-in-jsfejb-application)问题的答案，我知道如果出现错误，EJB 将抛出一个异常，该异常将在支持 bean 中捕获，支持 bean 将根据异常向用户显示错误消息。

我的问题是，如果有多个错误怎么办？如何向用户显示多条错误消息，而 EJB 一次只能抛出一个异常？

例如，在注册表中，用户需要输入电子邮件地址、姓名、密码和重新密码，并且不能为空。如果所有数据都有效但给定的电子邮件地址已经存在，EJB 将抛出 EntityExistException 并通知用户电子邮件地址已注册。如果出现多个错误，例如密码和重新密码不匹配并且名称为空怎么办？我想向用户显示这两个错误。EJB 应该抛出什么异常？我可以采取什么方法来实现这一目标？

注意：验证必须在 EJB 中

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-01T18:45:25.777

您不应该在支持 bean 操作方法中进行验证，而应该在正常的`Validator`.

例如

```
<h:inputText value="#{register.email}" required="true" validator="#{emailValidator}" />
<h:inputSecret binding="#{password}" value="#{register.password}" required="true" />
<h:inputSecret required="true" validator="confirmPasswordValidator">
    <f:attribute name="password" value="#{password.value}" />
</h:inputSecret>
... 
```

像`#{emailValidator}`这样：

```
@MangedBean
public class EmailValidator implements Validator {

    @EJB
    private UserService userService;

    @Override
    public void validate(FacesContext context, UIComponent component, Object value) throws ValidatorException {
        if (value == null) {
            return; // Let required="true" handle.
        }

        if (userService.existsEmail((String) value)) {
            throw new ValidatorException(Messages.createError("Email already exists"));
        }
    }

} 
```

请注意，EJB 不应在此处抛出异常。只有在出现致命且不可恢复的错误（例如 DB 关闭或错误的表/列定义）时才应该这样做。

`confirmPasswordValidator`像这样的东西

```
@FacesValidator("confirmPasswordValidator")
public class ConfirmPasswordValidator implements Validator {

    @Override
    public void validate(FacesContext context, UIComponent component, Object value) throws ValidatorException {
        Object password = component.getAttributes().get("password");

        if (value == null || password == null) {
            return; // Let required="true" handle.
        }

        if (!password.equals(value)) {
            throw new ValidatorException(Messages.createError("Password do not match"));
        }
    }

} 
```

# ruby - 如何使用红宝石中的给定值评估其模板中的字符串

> ID：10855617
> 
> 赞同：1
> 
> 时间：2012-06-01T18:36:52.767
> 
> 标签：ruby

有一个这样的字符串，它存储在一个文件中

```
#{date}abcde.doc 
```

我希望能够读取此字符串并将 #{date} 替换为

```
Date.today.strftime("%Y%m%d") 
```

有没有办法解析模板并进行评估？提前致谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-01T18:41:59.930

是的，然而……

如果您使用哈希替换会更容易，如下所示：

```
s = "%{date}abcde.doc"
s % { date: Time.now.strftime(etc) } 
```

或者只使用 ERb。

我认为您正在使用字符串插值，因此需要对其进行评估。

# python - 将要打印的图像发送到默认打印机...python

> ID：10855619
> 
> 赞同：3
> 
> 时间：2012-06-01T18:37:07.977
> 
> 标签：python, image, printing

所以，目前我正在创建一个应用程序，当您按下 GUI 上的按钮时，它需要将当前图像发送到打印机。它在 Windows 上运行。我一直在寻找标准库和第三方应用程序来帮助我做到这一点。

有谁知道可以帮助我解决这个问题的东西？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-23T23:55:42.730

检查此链接：[http ://timgolden.me.uk/python/win32_how_do_i/print.html](http://timgolden.me.uk/python/win32_how_do_i/print.html)

并使用它打印您已保存到磁盘的位图文件。jpg 和 png 由于某种原因无法工作 - 可能是因为它们需要转换为打印机友好的格式。

我对这些东西了解不多，但是用 tim Golden 的代码打印位图绝对适合我。

# ruby-on-rails - 使用默认的 Rails 生成器调用自定义生成器

> ID：10855622
> 
> 赞同：4
> 
> 时间：2012-06-01T18:37:43.260
> 
> 标签：ruby-on-rails, ruby, generator

需要明确的是，这不是我想要的：

*   让我的自定义生成器调用默认的 Rails 生成器
*   用我自己的替换默认的 Rails 生成器

我想要做的是在我调用时自动调用我的生成器：

```
rails generate scaffold User name age:integer 
```

我不是在写测试替换或任何东西，它完全是自定义的。我找到的关于发电机的所有信息都涉及前两种情况之一，但不是我想做的。一旦我发现`hook_for`我立即认为这正是我所需要的，但它似乎恰恰相反——从我的自定义生成器内部调用另一个 Rails 生成器（如果我想为我的自定义生成器创建一个测试文件，我会调用`hook_for :test_framework`然后在`TestUnit::MyCustomGenerator`某处定义一个类）。

我想我可以修补默认的脚手架生成器来调用我的，但这感觉很脏。我研究了一些类似[https://github.com/Skalar/i18n-yaml-generator](https://github.com/Skalar/i18n-yaml-generator)的 gem，但试图将其转换为使用初始化程序并且`lib/generators`不适合我。scaffold_generator 运行，但我的从未被调用。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-01T21:08:41.013

对我来说，它适用于 lib/generators/

```
$ rails g generator scaffold
      create  lib/generators/scaffold
      create  lib/generators/scaffold/scaffold_generator.rb
      create  lib/generators/scaffold/USAGE
      create  lib/generators/scaffold/templates
$ rails g scaffold
Usage:
  rails generate scaffold NAME [options]
....
        what/will/it/create 
```

[http://guides.rubyonrails.org/generators.html#generators-lookup](http://guides.rubyonrails.org/generators.html#generators-lookup)

另一种方式可能是:)

*   叉铁路宝石
*   根据您的喜好覆盖 Rails::Generators::ScaffoldGenerator 类
*   本地安装或在 Gemfile 中指定源路径

此外，如果“它完全是定制的”，则称它为不同的名称是公平的，不是吗？

# android - 将 Sqlite 数据库与 Oracle 10g 同步

> ID：10855624
> 
> 赞同：1
> 
> 时间：2012-06-01T18:38:00.483
> 
> 标签：android, sqlite, oracle10g

我的 android 应用程序与 Sqlite3 db 连接。我想定期将这些数据与 oracle db 同步（可能通过批处理程序或我需要决定的 API 调用）。

编辑：**数据同步概念而不是直接使用网络服务的原因是**用户将使用 android 应用程序从他不会获得网络连接的某个地方输入/更新数据。

是否可以通过**oracle 移动服务器将****Sqlite3 db**与**Oracle 10g db**同步？版本兼容性是我最关心的问题之一，因此在尝试之前要先确认一下。

 **同样，是否有其他方法或更好的方法来实现相同的目标？

我对此没有任何想法。请建议最好的方法。

问候，**

# coldfusion - Robots.txt 和 Coldfusion

> ID：10855625
> 
> 赞同：1
> 
> 时间：2012-06-01T18:38:00.567
> 
> 标签：coldfusion, seo, robots.txt

我试图禁止网站的某些部分而不是整个内容。
我对此比较陌生，所以如果有人引导我完成它，我将不胜感激。

我知道您可以禁止：/page1.cfm 来自爬虫，但如果我只想禁止该页面的一部分，例如该页面上存在的链接或联系表格，该怎么办？这个功能甚至可能吗？

根据我最近阅读的一些论坛，“nofollow”功能不再有效，因为爬虫变得越来越聪明。（我不知道那个论坛有多可信，所以如果有人有更好的来源，请分享）

有什么建议么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-03T12:49:02.247

您可以使用元标记中的属性“nofollow”来隐藏页面上的信息。谷歌写道，他们不会传递标有“nofollow”的链接。您可以在此处找到有关此内容和示例的更多信息：
[Robots.txt 教程](http://tools.seobook.com/robots-txt/)和[Google 支持](http://support.google.com/webmasters/bin/answer.py?hl=en&answer=96569)
希望这会有所帮助

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-04T13:23:36.880

不要使用nofollow，你会在你的页面上丢失linkjuice。

Robots.txt 只是对爬虫的提示，如果他们已经找到了他们仍然访问的页面并将其编入索引，则有一半的时间使用禁止规则。

使用 .htaccess 规则来禁止或阻止对该页面的访问。或者用复杂的 .js 加密你的链接（base64_encode() + str_rot13() 编码应该足以丢失爬虫）

# css - 项目符号随着 CSS3 列消失

> ID：10855627
> 
> 赞同：48
> 
> 时间：2012-06-01T18:38:13.203
> 
> 标签：css, html-lists

当我使用 CSS3 将它们转换为列时，列表项上的项目符号消失了。关于如何纠正它的任何想法或建议？

见例子：http: [//jsfiddle.net/gduDm/1/](http://jsfiddle.net/gduDm/1/)

```
ul li {
    list-style-type: disc !important;
    column-break-inside: avoid;
}
ul {
    list-style-type: disc !important;
    margin-top: 1em;
    column-count: 2;
    column-gap: 0.5em;
} 
```

* * *

## 回答 #1

> 赞同：83
> 
> 时间：2012-06-01T18:40:33.590

我认为子弹在那里，但它们被渲染到观察区域的左侧。尝试：

```
list-style-position: inside; 
```

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2013-02-20T20:21:41.820

在列表元素中同时添加`padding-left`和否定`text-indent`似乎会产生所需的结果：

```
ul li {
    padding-left: 1em;
    text-indent: -1em;
}
ul {
    list-style: inside disc;
} 
```

[http://jsfiddle.net/mblase75/gduDm/4/](http://jsfiddle.net/mblase75/gduDm/4/)

或者，将 a 添加`margin-left`到列表元素（而不是列表）并使用`outside`项目符号：

```
ul li {
    margin-left: 1em;
}
ul {
    list-style: outside disc;
} 
```

[http://jsfiddle.net/mblase75/gduDm/9/](http://jsfiddle.net/mblase75/gduDm/9/)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2016-09-28T08:40:47.430

设置`margin-left:1em`使项目符号出现而不会弄乱文本缩进。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2015-09-28T18:45:07.493

在这里尝试了第一个答案之后，我的列表项溢出到第二行并且没有排队时遇到了问题。使用`column-gap`我能够将第二列移动并查看项目符号。

资料来源：http: [//karlikdesign.com/how-to-split-a-list-into-two-columns-with-pure-css/](http://karlikdesign.com/how-to-split-a-list-into-two-columns-with-pure-css/)

```
 <!– CSS CODE –&gt;
    .two-columns {
    -webkit-column-count: 2;
    -moz-column-count: 2;
    column-count: 2;
    -webkit-column-gap: 40px;
    column-gap: 40px;
    -moz-column-gap: 40px;
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2019-09-20T17:55:13.017

其他一些解决方案相当不错，但我尝试的所有解决方案都给我带来了各种副作用。我做了一些小的调整，并试图让它尽可能接近完美。

```
ul {
  column-count:2;
}

ul.solution {
  margin-left:-0.6em;
  margin-right:0.6em;
}

ul.solution > * {
  margin-left:0.6em;
  margin-right:-0.6em;
}
```

```
Experimental Group
<ul class="solution">
 <li>
  This solution is pretty similar to the others.
 </li>
 <li>
  It does not require you to put the bullets inside, so you can keep your left edge clean if you want. 
 </li>
 <li>
  This fixed it for me in IE11 while also not impacting the appearance on Chromium, so I didn't have to do any browser filtering.
 </li>
</ul>
Control Group
<ul>
 <li>
  This solution is pretty similar to the others.
 </li>
 <li>
  It does not require you to put the bullets inside, so you can keep your left edge clean if you want. 
 </li>
 <li>
  This fixed it for me in IE11 while also not impacting the appearance on Chromium, so I didn't have to do any browser filtering.
 </li>
</ul>
```

# maven - 如何在 NetBeans Maven 项目中的 NetBeans 中启用 jsp-tags 自动完成功能？

> ID：10855632
> 
> 赞同：2
> 
> 时间：2012-06-01T18:38:26.950
> 
> 标签：maven, netbeans, autocomplete, jsp-tags, opencms

使用 NetBeans 7.1.2。

按照以下说明的过程使用 NetBeans 编辑页面时，IDE 仅提供`<jsp:...>`标记的自动完成功能：

![在此处输入图像描述](../Images/3eba8436364336db12e56376a03ec6aa.png)

这就是我创建 NetBeans 项目和 jsp 的方式（尽管它不是特定于原型的，问题也与 opencms 无关）：我使用[OpenCms-Module 原型创建了一个 maven 项目](http://bp-cms-commons.sourceforge.net/m2site/infonova/archetypes/opencms-module-archetype/1.0.1/ "infonova 的 opencms 站点")

```
mvn archetype:generate -DarchetypeCatalog=http://bp-cms-commons.sourceforge.net/m2repo 
```

原型创建一个带有**jar**包装的 maven 项目。

之后，我在`src/main/opencms/modules/blahblah/templates`.

然后我将`taglibs.standard`依赖项添加到项目中，以尝试为 NetBeans 提供相应的 tlds。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T18:38:27.120

经过几个小时试图让这个工作，我发现[这个报告和关闭的错误](http://netbeans.org/bugzilla/show_bug.cgi?id=179584 "NetBeans 错误")提示我走向正确的方向：

1.  ~~添加`src/main/webapp`目录~~ **编辑 1** ：如果文件在里面，则只有标签才会*自动*完成。**linux中的解决方法**（不确定windows链接是否有效）：创建一个符号链接：`jstl``src/main/webapp`

     ***   `ln -s opencms/ src/main/webapp`从项目根文件夹** 
***   将 maven 项目打包更改为`war`( `Project properties -> General -> Packaging`)（*请注意，`@taglib`指令和`taglibs.standard`依赖项都不是必需的。*）

    如果该`Web Pages`条目未出现在您的项目下（在项目视图中），您可能需要重新启动 NetBeans。现在您将在`src/main/webapp`! :-)** 

 **![自动完成修复](../Images/2876dcc1dfe9e49efce9da0f7a694aef.png)

**编辑 2**

不幸的是，如果在版本控制下，NetBeans 将符号链接视为一个新目录，并将其下的所有文件视为新文件 :-( 这非常不方便，因为要访问 IDE 集成的版本控制功能，您仍然需要打开原始文件资源。**

# sql - Qt : 防止 QSqlTableModel 在编辑时更新数据库

> ID：10855634
> 
> 赞同：1
> 
> 时间：2012-06-01T18:38:28.497
> 
> 标签：sql, qt

我想要的是当用户单击保存按钮时，只有更改应该写入数据库，直到那时更改应该只显示在表上（而不是在数据库中），而 QSqlTableModel 在编辑时更新数据库..

```
model = new QSqlTableModel();
model->setTable(table_name);
model->select(); 
```

我正在使用上面的代码..
任何帮助表示赞赏..

谢谢 ：）

**编辑：使用 Qt 4.8**

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-01T19:40:07.357

您可以使用[QSqlTableModel::setEditStrategy](http://qt-project.org/doc/qt-4.8/qsqltablemodel.html#setEditStrategy)来更改提交行为。

```
model->setEditStrategy(QSqlTableModel::OnManualSubmit); 
```

在您的*SaveButtonClickedSlot*中，您必须调用：

```
model->submitAll(); 
```

# php - PHP - DOMDocument 加载带有编码名称的 XML

> ID：10855635
> 
> 赞同：0
> 
> 时间：2012-06-01T18:38:38.643
> 
> 标签：php, xml, flash, actionscript-2

可以说，在我的 Flash 项目中，我有为我动态创建 xml 文件的脚本（通过 PHP）。XML 文件名基于特定变量，并`escape(variable)`在该变量可能（并且大多数情况下）包含不受支持的文件名字符的情况下使用转义...

稍后我需要在我的 flash 项目中知道 xml 文件的确切名称，因为我仅在**`unescape(XMLfile) == variable`**. 有很多变量，所以我不能只使用`String.replace()`函数来清除不受支持的文件名字符......

我正在使用的 PHP 文件的一部分：

```
$XMLDom = new DomDocument('1.0', 'UTF-8');
$xmlId = trim($_POST['xmlId']);
if(file_exists($xmlId)){
    $XMLDom ->load($xmlId);
}else{
    $newXMLHandler = fopen($xmlId, 'w') or die("can't open file");
    fclose($newXMLHandler);

    $XMLDom ->load($xmlId);

    .... rest of the code ....

    $XMLDom ->save($xmlId);
} 
```

上面代码的结果是目录中有2个新创建的XML文件

一个由创建的 XML 空文件`fopen($xmlId, 'w')`，名为：“ **fi%20le%2C%2E%40.xml** ”，第二个名为：“ file **,.@.xml** ”，其中存储了我所有的新 XML 数据...

有没有办法通过 PHP 加载转义的命名 XML 文件？

提前致谢。

亚瑟。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T19:48:03.400

我不太确定我理解你的问题，但如果你的问题是在 PHP 中找到 escape() 的模拟函数，那么[`urlencode()`](http://php.net/manual/en/function.urlencode.php)看起来是最好的匹配，但你需要研究到底是什么被转义了。请注意，例如，有几种不同的方法可以对字符串进行百分比编码，尤其是多字节字符串。Flash 可以使用`escapeMultibyte()`，也可以同时使用`encodeURIComponent()`编码不同的字符子集，并且以不同的方式进行编码——所以要小心！

现在，关于文件名，如果您的 HTTP 服务器在 Unix 系统上运行，那么“file,.@.xml”是一个有效的文件名，不用担心 - 有时不方便，但它是一个合法的名称。

```
touch 'fi le,.@.xml' 
```

会创建一个文件，那里没有问题。基本上，受限制的字符是斜杠和空字符（“\x00”），但通常也限制可能被解释为 shell 命令的字符 - 这真的取决于你。

# javascript - 在 highcharts.js 中从我的控制器获取 json 数据

> ID：10855644
> 
> 赞同：4
> 
> 时间：2012-06-01T18:39:06.780
> 
> 标签：javascript, asp.net-mvc-3, highcharts

我正在尝试制作一个高图表，它应该向我显示每种类型的预留房间数量：

这是我使用 GetHighChart 方法的控制器：

```
 public JsonResult GetHighChart()
    {
        var viewModel = Reservation.RoomTypeByDate(5);
        var result = new JsonResult { Data = viewModel};
        return result;

    } 
```

Reservetion.RoomTypeByDate 看起来像这样：

```
 public static List<dynamic> RoomTypeByDate(int? LunaDorita)
    { 
    var result=DBContext.Current.ExecuteProcedure("RoomtypeCountbydate",
      new QueryParam<int>("@p_ID", LunaDorita.Value)).Map();
    return result; 
```

这是我的存储过程：

```
SELECT Room_Type, COUNT(*) AS NumarRezervari
FROM   dbo.Reservation re
JOIN   dbo.Room ro ON ro.RoomID = re.Room_ID
JOIN   dbo.Room_Type rt ON rt.RoomType_ID = ro.Room_Type_ID
WHERE  MONTH(re.Data_Check_in)=@p_ID
GROUP  BY Room_Type 
```

我的 Json 结果是：

```
[[{"Key":"Room_Type","Value":"Double"},{"Key":"NumarRezervari","Value":2}],      [{"Key":"Room_Type","Value":"LUXURY"},{"Key":"NumarRezervari","Value":1}],[{"Key":"Room_Type","Value":"Triple"},{"Key":"NumarRezervari","Value":1}]] 
```

我应该如何修改这个 javascript 文件，而不是下面的系列，以便从 myReports 控制器的 GetHighChart 方法中获取我的数据。因此，我希望使用我的 RoomType 代替名称，例如 Double，而不是使用数据来拥有我自己的数据 [ 2,5....]？

```
$(function () {
    var chart;
    $(document).ready(function () {
        chart = new Highcharts.Chart({

            chart: {
                renderTo: 'container',
                type: 'line'

           },
            title: {
                text: 'Monthly Average Temperature'
            },
            subtitle: {
                text: 'Source: WorldClimate.com'
            },
            xAxis: {
                categories: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec']
            },
            yAxis: {
                title: {
                    text: 'Temperature (°C)'
                }
            },
            tooltip: {
                enabled: false,
                formatter: function () {
                    return '<b>' + this.series.name + '</b><br/>' +
                        this.x + ': ' + this.y + '°C';
                }
            },
            plotOptions: {
                line: {
                    dataLabels: {
                        enabled: true
                    },
                    enableMouseTracking: false
                }
            },
            series: [{
                name: 'Tokyo',
                data: [7.0, 6.9, 9.5, 14.5, 18.4, 21.5, 25.2, 26.5, 23.3, 18.3, 13.9, 9.6]
            }, {
                name: 'London',
                data: [3.9, 4.2, 5.7, 8.5, 11.9, 15.2, 17.0, 16.6, 14.2, 10.3, 6.6, 4.8]
            }]
        });
    });
}); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-09T12:20:04.353

遵循以下步骤： 使图表成为全局变量

```
var chart; 
```

您可以像这样为图表定义加载事件

```
chart = new Highcharts.Chart({    
chart: {
                renderTo: 'container',
                type: 'spline',
                marginRight: 10,
                events: {
                    load: requestData
                    }
                }
            } 
```

这里 requestData 是一个 javascript 函数。在此函数中，您可以将数据动态绑定到图表。

```
function requestData() {

        var pointArray = [];
        for (var i = 0; i < data2.length; i++) {
            //                    var series, shift;

            //                    var point = new Array(new Date(data2[i].UTC).getTime(), parseFloat(data2[i].Value));
            var point = {
                x: new Date(data2[i].UTC).getTime(),
                y: parseFloat(data2[i].Value)
            };
            chartRTM.series[0].addPoint(point);

        }                
        chartRTM.series[0].redraw();} 
```

注意：这里的 data2 是要绑定的数据的 json 列表。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-03T18:43:10.510

如果您使用的是 Visual Studio，则可以使用[**DotNet.Highcharts**](http://dotnethighcharts.codeplex.com/)来更轻松地构建 highchart 对象。通过这样做，您可以直接使用 Series 和 Data 对象，然后将它们传递给 Highcharts。它将 JavaScript 的创建排除在外。下面是我如何在 MVC 3 中创建图表的示例。如您所见，我正在使用 LINQ to SQL 来收集图表所需的数据。我正在创建一个系列列表来保存数据。这是动态完成的，因此我可以根据需要为图表添加尽可能多的系列，而无需事先知道会有多少。然后我创建图表并将系列列表传递给它。

```
public ActionResult CombinerBarToday(DateTime? utcStartingDate = null,
                                     DateTime? utcEndingDate = null)
{
    //GET THE GENERATED POWER READINGS FOR THE SPECIFIED DATETIME
    var firstQ = from s in db.PowerCombinerHistorys
                 join u in db.PowerCombiners on s.combiner_id equals u.id
                 where s.recordTime >= utcStartingDate
                 where s.recordTime <= utcEndingDate
                 select new
                 {
                     CombinerID = u.name,
                     Current = s.current,
                     RecordTime = s.recordTime,
                     Voltage = s.voltage,
                     Watts = (s.current * s.voltage)
                 };

    //GET A LIST OF THE COMBINERS CONTAINED IN THE QUERY
    var secondQ = (from s in firstQ
                   select new
                   {
                        Combiner = s.CombinerID
                   }).Distinct();

    /* THIS LIST OF SERIES WILL BE USED TO DYNAMICALLY ADD AS MANY SERIES 
     * TO THE HIGHCHARTS AS NEEDED WITHOUT HAVING TO CREATE EACH SERIES INDIVIUALY */
    List<Series> allSeries = new List<Series>();

    TimeZoneInfo easternZone = TimeZoneInfo.FindSystemTimeZoneById("Eastern Standard Time");

    //LOOP THROUGH EACH COMBINER AND CREATE SERIES
    foreach (var distinctCombiner in secondQ)
    {
        var combinerDetail = from s in db2.PowerCombinerHistorys
                 join u in db2.PowerCombiners on s.combiner_id equals u.id
                 where u.name == distinctCombiner.Combiner
                 where s.recordTime >= utcStartingDate
                 where s.recordTime <= utcEndingDate
                 select new
                 {
                     CombinerID = u.name,
                     Current = s.current,
                     RecordTime = s.recordTime,
                     Voltage = s.voltage,
                     Watts = (s.current * s.voltage) / 1000d
                 };

        var results = new List<object[]>();

        foreach (var detailCombiner in combinerDetail)
        {
            results.Add(new object[] { 
                            TimeZoneInfo.ConvertTimeFromUtc(detailCombiner.RecordTime, easternZone), 
                            detailCombiner.Watts });
        }

        allSeries.Add(new Series
        {
            Name = distinctCombiner.Combiner,
            //Data = new Data(myData)
            Data = new Data(results.ToArray())

        });
    }

    Highcharts chart = new Highcharts("chart")
    .InitChart(new Chart { DefaultSeriesType = ChartTypes.Spline, ZoomType = ZoomTypes.X})
    .SetTitle(new Title { Text = "Combiner History" })
    .SetSubtitle(new Subtitle { Text = "Click and drag in the plot area to zoom in" })
    .SetOptions(new GlobalOptions { Global = new Global { UseUTC = false } })
    .SetPlotOptions(new PlotOptions
    {
        Spline = new PlotOptionsSpline
        {
            LineWidth = 2,
            States = new PlotOptionsSplineStates { Hover = new PlotOptionsSplineStatesHover { LineWidth = 3 } },
            Marker = new PlotOptionsSplineMarker
            {
                Enabled = false,
                States = new PlotOptionsSplineMarkerStates
                {
                    Hover = new PlotOptionsSplineMarkerStatesHover
                    {
                        Enabled = true,
                        Radius = 5,
                        LineWidth = 1
                    }
                }
            }
        }
    })
    .SetXAxis(new XAxis
    {
        Type = AxisTypes.Datetime,
        Labels = new XAxisLabels
        {
            Rotation = -45,
            Align = HorizontalAligns.Right,
            Style = "font: 'normal 10px Verdana, sans-serif'"
        },
        Title = new XAxisTitle { Text = "Time(Hour)" },
    })
    .SetYAxis(new YAxis
    {
        Title = new YAxisTitle { Text = "Kilowatt" }
    })

    .SetSeries(allSeries.Select(s => new Series {Name = s.Name, Data = s.Data }).ToArray());

    return PartialView(chart);
} 
```

# ajax - JSON 发布到 Spring-MVC，Spring 没有看到数据

> ID：10855645
> 
> 赞同：0
> 
> 时间：2012-06-01T18:39:09.523
> 
> 标签：ajax, json, spring, spring-mvc

我正在开发一个项目，该项目将使用 Ajax 将 JSON 对象发布到 Springs-MVC。我一直在进行一些更改，并且达到了不再出现错误的地步，但是我没有看到在我需要的对象中发布到 Spring 的数据。

这是我的弹簧控制器。

```
@RequestMapping(value="/AddUser.htm",method=RequestMethod.POST)
    public @ResponseBody JsonResponse addUser(@ModelAttribute(value="user") User user, BindingResult result ){
        JsonResponse res = new JsonResponse();

        if(!result.hasErrors()){
            res.setStatus("SUCCESS");
            res.setResult(userList);
        }else{
            res.setStatus("FAIL");
            res.setResult(result.getAllErrors());
        }

        return res;
    } 
```

我放了一个断点，我的 USER 对象永远不会获取数据。接下来是我的 USER 对象的副本：

```
public class User {

    private String name = null;
    private String education = null;

    private List<String> nameList = null;
    private List<String> educationList = null;

    public String getName() {
        return name;
    }
    public void setName(String name) {
        this.name = name;
    }
    public String getEducation() {
        return education;
    }
    public void setEducation(String education) {
        this.education = education;
    }
    public List<String> getNameList() {
        return nameList;
    }
    public void setNameList(List<String> nameList) {
        this.nameList = nameList;
    }
    public List<String> getEducationList() {
        return educationList;
    }
    public void setEducationList(List<String> educationList) {
        this.educationList = educationList;
    } 
```

现在对于执行 Ajax、JSON 发布的 javascript 代码：

```
function doAjaxPost() {  

      var inData = {};

      inData.nameList = ['kurt','johnathan'];
      inData.educationList = ['GSM','HardKnocks'];

      htmlStr = JSON.stringify(inData);
      alert(".ajax:" + htmlStr);

    $.ajax({
         type: "POST",
         contentType: "application/json; charset=utf-8",
         url:  contexPath + "/AddUser.htm",
         data: inData,
         dataType: "json",
         error: function(data){
              alert("fail");
         },
         success: function(data){
              alert("success");
         }
         });

}; 
```

***如果你能帮忙，请让我现在？？我必须尽快让这个工作......谢谢***

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-04T09:47:42.840

您还需要在控制器中找到的 RequestMapping 注释中指定标头。

```
@RequestMapping(headers ={"Accept=application/json"}, value="/AddUser.htm", method=RequestMethod.POST) 
```

Also, remove .htm in your URL path. htm is some kind of request type overide. Using .htm specifies the web server to handle the request as a classic html request. Using .json would specify to the webserver that the request expects to be handled as a json request.

# iphone - 将多个 UIBarButtonItems 添加到 Storyboard 中的 UINavigationItem？

> ID：10855651
> 
> 赞同：22
> 
> 时间：2012-06-01T18:39:42.013
> 
> 标签：iphone, ipad, ios5

![在此处输入图像描述](../Images/c3a716f8c2a784596e17081c41f2b7f3.png)

正如您在我的故事板中看到的那样，添加单个 UIBarButton 项目很容易。但是我想添加几个，似乎我无法使用情节提要？

这很烦人，因为这样我就失去了故事板的整个很好的概述，它是 Segue 的。

是这样吗？第一个使用故事板的项目，所以我想我可能会遗漏一些东西。

* * *

## 回答 #1

> 赞同：51
> 
> 时间：2013-02-10T17:24:20.807

在 XCode 4.6 中（至少），您可以将一个普通视图拖到导航栏上（在您想要多个按钮的任何一侧），然后在其顶部拖一个工具栏。完成此操作后，您可以在工具栏上放置多个条形按钮项目，并将它们连接到操作/转场等，就像往常一样。确保您已将视图和工具栏都设置为默认（透明）背景颜色。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2015-06-13T05:41:37.010

在 Xcode 7 中，您最终可以直接在 Interface Builder 中将多个 UIBarButtonItems 拖到 UINavigationItem 中。

请参阅 WWDC 2015 Session 407 视频，标题为：

> 在 Interface Builder 中实现 UI 设计

[https://developer.apple.com/videos/wwdc/2015/?id=407](https://developer.apple.com/videos/wwdc/2015/?id=407)

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2014-12-23T16:59:24.857

试试这个

```
 -(void)viewDidLoad
{

    [super viewDidLoad];

    UIBarButtonItem *editBarButtonItem = [[UIBarButtonItem alloc] initWithBarButtonSystemItem:UIBarButtonSystemItemEdit target:self action:@selector(editAction)];

    UIBarButtonItem *saveBarButtonItem = [[UIBarButtonItem alloc] initWithBarButtonSystemItem:UIBarButtonSystemItemSave target:self action:@selector(saveAction)];

    self.navigationItem.rightBarButtonItems = [[NSArray alloc] initWithObjects:editBarButtonItem, saveBarButtonItem, nil];   
} 
```

我们还需要实现方法editAction 和saveAction。

```
-(void)editAction
{

    NSLog(@"edit button clicked");
}

-(void)saveAction
{

    NSLog(@"save button clicked");
} 
```

# asp.net-mvc-3 - 带有 where 子句或 if 的 Sum 表达式

> ID：10855654
> 
> 赞同：0
> 
> 时间：2012-06-01T18:40:10.413
> 
> 标签：asp.net-mvc-3, report, reporting

如何编写一个表达式，它只会对列不为空的列表中的值求和？

例子：

2.1 4 5 23

4 1 2 无

1 3.1 5 1

8 .5 1 无

我想将第一列的总和与最后一列不为空的所有行相加。所以我的答案是 2.1+1 = 3.1。Sum 表达式中是否可以有一个“where”子句？或者我怎么能使用 Sum-if 来完成这个？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T18:45:49.927

看看这是否有帮助

```
 select sum(field_1) from table_name where last_field is not null 
```

# c# - 获取标签是否由 Timer 事件聚焦未按预期工作

> ID：10855657
> 
> 赞同：0
> 
> 时间：2012-06-01T18:40:26.880
> 
> 标签：c#, winforms, timer, label

我正在编写一个等待几秒钟并清理标签值的方法。但如果用户在标签上使用鼠标，则无法清除它。

编码：

```
public static void CleanIn(this Label label, int miliseconds)
        {
            Timer timer = new Timer();
            timer.Interval = miliseconds;
            timer.Tick += (o, e) =>
            {

                if (!label.Focused)
                {
                    label.ResetText();
                    timer.Stop();
                    timer.Dispose();
                }
            };
            timer.Start();
        } 
```

问题是：如果鼠标在标签上，则该值是独立清理的。如何解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-01T18:46:24.967

`Label`永远不能有焦点（*）。响应鼠标悬停事件并手动跟踪用户是否悬停并对其进行逻辑处理。

*技术上不正确，请参见[此处](https://stackoverflow.com/a/5692661/426894)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-01T18:53:02.787

该`Focused`属性与用户是否选择了控件有关，与鼠标是否位于控件上无关。您可以[`MousePosition`](http://msdn.microsoft.com/en-us/library/system.windows.forms.control.mouseposition.aspx)结合使用该属性和[`PointToClient`](http://msdn.microsoft.com/en-us/library/system.windows.forms.control.pointtoclient.aspx)方法来确定鼠标是否在控件上，如下所示：

```
...
Point cursor = label.PointToClient(Control.MousePosition);
if (!(cursor.X >= 0 && cursor.X <= label.Width
        && cursor.Y >= 0 && cursor.Y <= label.Height))
{
    ... 
```

# algorithm - 定义地理围栏并查看点是否在其内部/外部的算法

> ID：10855661
> 
> 赞同：7
> 
> 时间：2012-06-01T18:41:06.513
> 
> 标签：algorithm, math, geo, point-in-polygon, geofencing

我正在寻找一种算法，我可以创建一个地理围栏并检查设备是否正在进入/离开围栏。我已经研究过多边形算法中的点（光线投射和缠绕数），但是是否有任何算法可以应用于圆形和任何不规则形状？重要的限制是时间效率。

谢谢你。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-09T13:02:02.110

Here is the c code algorithm that is simple to understand:

[http://alienryderflex.com/polygon/](http://alienryderflex.com/polygon/)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-01T21:00:03.947

圆很容易（至少如果你假设一个局部平坦的表面） - 只是到一个点的绝对距离。

如果您需要速度，通常的方法是级联，您首先检查一个圆，或者围绕该点检查一个正方形，然后是凸多边形，然后是更详细的多边形（如果需要）。

你如何定义不规则形状 - 如果它不是多边形？

ps 请参阅[如何测试一个点是否在 2D 整数坐标中的凸多边形内？](https://stackoverflow.com/questions/1119627/how-to-test-if-a-point-is-inside-of-a-convex-polygon-in-2d-integer-coordinates/1119687#1119687)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2020-07-19T04:23:57.643

我为python找到了这个解决方案。据我所知，这很有效。

```
from shapely.geometry import Point, Polygon
import matplotlib.path as mpltPath
from functools import reduce
import operator
import math
coords = [[ 12.934158,77.609316], [ 12.934796,77.609852],[ 12.934183,77.610646], [ 12.933551,77.610100], [12.934158,77.609316]]

#sorting the geofence coords in clockwise direction
center = tuple(map(operator.truediv, reduce(lambda x, y: map(operator.add, x, y), coords), [len(coords)] * 2))
coords = sorted(coords, key=lambda coord: (-135 - math.degrees(math.atan2(*tuple(map(operator.sub, coord, center))[::-1]))) % 360)

#Testing if a point inside or outside
poly = Polygon(coords)
point = Point(12.933556,77.609854)
print(coords)
if(point.within(poly)):
    print("Inside")
else:
    print("Outside") 
```

谢谢你！

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2018-03-06T17:20:42.123

[绕组数法](http://geomalgorithms.com/a03-_inclusion.html#wn_PnPoly())

> 但最重要的是，出于几何正确性和效率的原因，在确定多边形中是否包含点时，应始终首选缠绕数算法。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-10-09T13:11:50.423

看看四叉树、空间索引、四叉树和 r-tree。

# javascript - Javascript正则表达式验证？

> ID：10855663
> 
> 赞同：0
> 
> 时间：2012-06-01T18:41:21.810
> 
> 标签：javascript, jquery, regex, html, onsubmit

因此，我在我的 HTML5 模式属性中为 iPhone 数字键盘使用了最小的正则表达式 [0-9]*。我还有一个提交功能，可以通过服务器发送电子邮件。一切正常，直到我意识到它正在尝试发送表单，而不管浏览器是否试图阻止基于不正确的用户输入的提交。

所以我做了以下但不能让它工作：

```
<script>
function validate(){
    var phone=/[0-9]*/;
    var x=document.forms["form"]["contactnum"].value;
    if (x!=phone){
        alert("Contact Number must be a valid phone number (no dashes)");
        return false;
    }

    else {
        alert("Thank you! We have received your information and will contact you shortly.");
        ajax('{{=URL('new_post')}}',['phone'], 'target');
            return false;
    }
}
</script> 
```

问题是我只有在 if 语句中设置 if (x==null || x=="") 才能让它工作。如果我尝试将它与任何其他 var 匹配，它总是会说我不匹配 [0-9]*。我已经写了几个复杂的正则表达式，但真的不想在这个简单的表单上使用任何东西。我只想要 iPhone 上的数字键盘，如果它不是数字或 null，则不提交。我什至不在乎他们是否在电话中输入“2”，只要是数字即可。

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-01T18:48:11.060

```
if ( x.match(/^[0-9]+$/) ) {
  // valid
} else {
  // invalid
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-01T18:47:48.560

这不是你使用正则表达式的方式：

```
if (!phone.test(x)) ... 
```

此外，如果您想匹配一个只有数字的字符串，请尝试

```
var phone = /^\d*$/; 
```

这也将匹配空字符串；如果您想要至少一位数字，请使用`+`而不是。`*`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-01T18:48:04.723

您实际上似乎在这里有两个问题。对于第一部分，您没有展示如何使用`validate()`，但请记住 onsubmit 处理程序本身必须返回 false 以阻止浏览器完成正常的提交过程。例如，以下将不起作用：

```
$('#myform').submit(function(){
    validate();
}); 
```

但这*将*成功停止默认提交过程：

```
$('#myform').submit(function(){
    return validate();
}); 
```

`validate()`将返回 false，然后您的处理程序返回相同的值。

# c# - 如果单击另一个按钮或链接按钮，动态文本框会消失

> ID：10855667
> 
> 赞同：1
> 
> 时间：2012-06-01T18:41:47.090
> 
> 标签：c#, .net, visual-studio-2010, webpage

下面编写的代码显示特定条件的文本框。但是当我单击另一个不相关的按钮或链接时，它会消失。当我在网页上执行其他活动时，我需要它保持可见

```
protected void DropDownList1_SelectedIndexChanged(object sender, EventArgs e)
{
    TextBox new_textbox = new TextBox();

    if (DropDownList1.Text.Equals("OFF"))
    {
        new_textbox.ID = "txt" + 1;

        PlaceHolder1.Controls.Add(new_textbox);
        Label5.Visible = true;
        new_textbox.Visible = true;
    }
    else
    {   
        Label5.Visible = false;
    }        
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T18:46:09.257

这个问题之前在 SO 上被问过： [Dynamicly added controls in Asp.Net](https://stackoverflow.com/questions/113392/dynamically-added-controls-in-asp-net)

您只是在特定情况下添加此控件，特别是在`DropDownList1.Text.Equals("OFF")`. 在这种情况下，您是否可以使用刚刚设置为可见的静态控件？

根据 msdn 的[Add Controls to an ASP.NET Web Page Programmatically](http://msdn.microsoft.com/en-us/library/kyt0fzt1.aspx)：

> 控件通常在页面的初始化阶段添加到页面。有关页面阶段的详细信息，请参阅 ASP.NET 页面生命周期概述。

引用链接到[ASP.NET 页面生命周期概述](http://msdn.microsoft.com/en-us/library/ms178472.aspx)。

您必须小心动态添加控件，请参阅有关[Dynamic Web Server Controls and View State](http://msdn.microsoft.com/en-us/library/hbdfdyh7.aspx)的这个 msdn 页面。

# ajax - Grails - 将域参数传递给 Javascript

> ID：10855668
> 
> 赞同：0
> 
> 时间：2012-06-01T18:41:51.117
> 
> 标签：ajax, grails

有没有办法将我的 gsp 文件中的实例变量传递给 Javascript？

这就是我所拥有的不起作用：

```
<input type="button" value="Add" onclick="addTo('${person.id}');" /> 
```

${person.id} 是域实例 Person 的 ID。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-01T19:16:16.803

这对我来说很好。我能够将 id 发送到 javascript 函数并在警报中显示它。您是否收到错误，或者该值没有被传递？也许将您的javascript添加到问题中。

# vba - 使用函数返回值时出现“需要对象”错误？

> ID：10855673
> 
> 赞同：0
> 
> 时间：2012-06-01T18:41:57.630
> 
> 标签：vba

我有一个函数可以在一个范围内查找当前日期并返回找到它的单元格。我正在尝试使用该单元格的位置来计算子程序中的偏移量。但是，当我运行宏时，我得到`objected required`一个错误。函数及子程序如图所示：

```
Function findCurrentDate() As Range
    Dim needle As Date
    Dim rng As Range
    needle = CLng(Date)
    Dim haystack As Range
    Dim search As Range
    Set haystack = Range("B3:B86")
    Set search = haystack.Find(needle, After:=haystack(1), _
                           LookIn:=xlValues, Lookat:=xlWhole, _
                           SearchOrder:=xlNext, MatchByte:=True)
End Function

Sub showFutureWeeklyHours()
    Dim wkday_row_offset As Integer
    Dim search As Range
    Set search = findCurrentDate()
    Set wkday_row_offset = search.Row
...
End Sub 
```

这不是完整的子程序，但足以重现错误。日期列表存储在单元格中`B3:B86`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-01T18:47:15.347

这`wkday_row_offset`是一个数字，而不是一个对象，所以不要使用 Set。

```
"This method returns Nothing if no match is found. The Find method does not affect the selection or the active cell." 
```

[http://msdn.microsoft.com/en-us/library/ff839746.aspx](http://msdn.microsoft.com/en-us/library/ff839746.aspx)

在查找 row 属性之前，您需要检查是否返回了某些内容。没有什么是没有行的。行是一个数字，而不是一个对象。

```
Function findCurrentDate() As Range
    Dim needle As Date
    Dim rng As Range
    needle = CLng(Date)
    Dim haystack As Range
    Dim search As Range
    Set haystack = Range("B3:B86")
    Set search = haystack.Find(needle, After:=haystack(1), _
                           LookIn:=xlValues, Lookat:=xlWhole, _
                           SearchOrder:=xlNext, MatchByte:=True)
    Set findCurrentDate = search
End Function

Sub showFutureWeeklyHours()
    Dim wkday_row_offset As Integer
    Dim search As Range
    Set search = findCurrentDate()

    wkday_row_offset = search.row
''...
End Sub 
```

# php - 如果文件已上传，则返回带有 $_POST 的隐藏字段

> ID：10855677
> 
> 赞同：0
> 
> 时间：2012-06-01T18:42:14.507
> 
> 标签：php

```
<form class="formp" action="" method="post" enctype="multipart/form-data" id="frm" name="wjd">
<input type="hidden" name="MAX_FILE_SIZE" value="2000000"/>
<p>Gerecht:</p><p>Prijs:</p><p>Plaatje:</p><p>Upload:</p>
<?php
$resultmenus = mysqli_query($dbc,"SELECT * FROM prijslijst WHERE menunaam='menu\'s'");
while($rowmenus = mysqli_fetch_array($resultmenus,MYSQLI_ASSOC)) {
 echo   "<input type=\"hidden\" name=\"id\" value=\"{$rowmenus['id']}\"/>";
 echo   "<input name=\"gerecht[]\" type=\"text\" size=\"30\" maxlength=\"30\" value=\"{$rowmenus['gerecht']}\"/>";
 echo   "<input name=\"prijs[]\" type=\"text\" size=\"5\" maxlength=\"5\" value=\"{$rowmenus['prijs']}\"/>";
 echo   "<img src=\"../{$rowmenus['plaatje']}\" /><input  size=\"1\" type=\"file\" name=\"file[]\" id=\"file\"/>";
}
<input type="submit" name="submit" value="verzend" />
</form> 
```

这将从隐藏输入类型字段中的 db echo'd 输出 id 为 1 到 5 的表单。我的问题是：当我在第 3 行中仅上传 1 个带有 id3 的文件而其余文件为空时，是否可以仅检索该 id？

因为当我尝试使用 $_POST['id']; 检索它时 我得到最后一个值 5。这是浏览器的输出。

```
<form id="frm" class="formp" name="wjd" enctype="multipart/form-data" method="post" action="">
<input type="hidden" value="2000000" name="MAX_FILE_SIZE">
<p>Gerecht:</p><p>Prijs:</p><p>Plaatje:</p><p>Upload:</p>
<input type="hidden" value="1" name="id">
<input type="text" value="Menu 1" maxlength="30" size="30" name="gerecht[]">
<input type="text" value="3.00" maxlength="5" size="5" name="prijs[]">
<img src="../images/plaatjes/mini_menu3.gif">
<input id="file" type="file" name="file[]" size="1">
<input type="hidden" value="2" name="id">
<input type="text" value="Menu 2" maxlength="30" size="30" name="gerecht[]">
<input type="text" value="6.00" maxlength="5" size="5" name="prijs[]">
<img src="../images/plaatjes/mini_menu2.gif">
<input id="file" type="file" name="file[]" size="1">
<input type="hidden" value="3" name="id">
<input type="text" value="Menu 3" maxlength="30" size="30" name="gerecht[]">
<input type="text" value="6.00" maxlength="5" size="5" name="prijs[]">
<img src="../images/plaatjes/mini_menu1.gif">
<input id="file" type="file" name="file[]" size="1">
<input type="hidden" value="4" name="id">
<input type="text" value="Menu 4" maxlength="30" size="30" name="gerecht[]">
<input type="text" value="7.00" maxlength="5" size="5" name="prijs[]">
<img src="../images/plaatjes/mini_menu3.gif">
<input id="file" type="file" name="file[]" size="1">
<input type="hidden" value="5" name="id">
<input type="text" value="Menu 5" maxlength="30" size="30" name="gerecht[]">
<input type="text" value="4.00" maxlength="5" size="5" name="prijs[]">
<img src="../images/plaatjes/mini_menu2.gif">
<input id="file" type="file" name="file[]" size="1">
<input type="submit" value="verzend" name="submit">
</form> 
```

这是处理脚本。

```
if(isset($_POST['submit'])) {
        if((array_search('', $_POST["gerecht"])!==false) or (array_search('', $_POST["prijs"])!==false)) { //1 or more field empty
        echo "<span class=\"error\">Please fill in all fields</span>";
        exit();
    }else{//field filled in

       foreach ($_FILES['file']['name'] as $i => $name) {

            if ($_FILES['file']['error'][$i] == 4) { // no upload continue
                continue;
            }
            if ($_FILES['file']['error'][$i] == 0) {

                echo $_POST['id'];

            }//end else error 0

       }//end foreach 
    }//end filled in forms

}else{ //submit button clicked

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T19:37:21.880

你有

```
<input type="hidden" value="1" name="id">
<input type="hidden" value="2" name="id"> 
```

等等

你只会得到数字 5，因为它是最后一个，并且正在覆盖它之前的那个。

与输入文本相同，`name`属性应该不同。

做一个`var_dump($_POST);`查看所有正在发布的内容。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-01T19:40:10.807

如果您重新使用表单元素名称（并且它不是数组），最后一个值将覆盖以前的值。看看你怎么样

```
<input type="hidden" value="5" name="id"> 
```

试试吧

```
<input type="hidden" value="5" name="id[]"> 
```

并遍历它们。

# java - java中的多线程编程，最佳实践和代码

> ID：10855679
> 
> 赞同：0
> 
> 时间：2012-06-01T18:42:22.533
> 
> 标签：java, multithreading

我正在编写一个文件，该文件在网上对不同位置进行大量调用（遗憾的是，这是要求的一部分）

我的问题是这样的：

假设我有一个 main 方法并想调用其他方法：

```
public static void main(String args[]){
    //how do I break stuff into threads here
     Thread nameThread1 = new(fileName.DoMethod1(x))
     Thread nameThread2 = new(fileName.DoMethod2(x))
     Thread nameThread3 = new(fileName.DoMethod3(x))
     Thread nameThread4 = new(fileName.DoMethod4(x))
     Thread nameThread5 = new(fileName.DoMethod5(x))
}

           //fileName.java
public static void doMethod1(object){
   //Do Method Stuff
}

public static void doMethod2(object){
   //Do Method Stuff
} 
```

我已经阅读了一些关于如何实现它的指南，但我仍然对执行此操作的精确方法感到困惑。

如果可能的话，有人可以给我看一些例子吗？谢谢！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-01T18:45:36.657

您不能像在您的帖子中那样调用不同的方法。你可以做的是调用不同的类：

```
public static void main(String args[]){
     Thread nameThread1 = new Thread(new Method1(x));
     nameThread1.start();
     Thread nameThread2 = new Thread(new Method2(x));
     nameThread2.start();
     Thread nameThread3 = new Thread(new Method3(x));
     nameThread3.start();
     Thread nameThread4 = new Thread(new Method4(x));
     nameThread4.start();
     Thread nameThread5 = new Thread(new Method5(x));
     nameThread5.start();
}

public class Method1 implements Runnable {
   private Object obj;
   public Method1(Object obj) {
       this.obj = obj;
   }
   //fileName.java
   public void run(){
      //Do Method Stuff
   }
} 
```

您应该始终考虑使用创建`ExecutorService`代码来管理这样的作业。例如：

```
// create a thread pool with 10 workers
ExecutorService threadPool = Executors.newCachedThreadPool();
threadPool.submit(new Method1(x));
threadPool.submit(new Method2(x));
...
// once we have submitted all jobs to the thread pool, it should be shutdown
threadPool.shutdown(); 
```

如果您*必须*使用一个类，那么您可以启动一个`Runnable`使用开关或其他东西的类：

```
public static void main(String args[]){
     Thread nameThread1 = new Thread(new Method(1, x));
     nameThread1.start();
     Thread nameThread2 = new Thread(new Method(2, x));
     nameThread2.start();
     ...
}
public class Method1 implements Runnable {
   private int which;
   private Object obj;
   public Method1(int which, Object obj) {
       this.which = which;
       this.obj = obj;
   }
   //fileName.java
   public void run(){
       switch(which) {
          case 1:
             doMethod1(obj);
             break;
          case 2:
             doMethod2(obj);
             break;
          ...
       }
    }
    private void doMethod1(Object obj){
       ...
    }
    private void doMethod2(Object obj){
       ...
    }
} 
```

但是执行者或单独的`Runnable`类会更干净。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-01T18:54:40.510

`Thread`需要一个 的实例`Runnable`，因此您可以做的是创建一个实现 Runnable 的类，然后传递它必须响应的命令，然后根据您选择调用哪个方法的命令。

```
public class MyRunnable implements Runnable {

   public MyRunnable(String commandToExecute){
      this.command = commandToExecute;
   }

   public void run() {
      //depending on command call specific methods.
   }
} 
```

这种方法的一个缺点是您的 run 方法的 if else 列表太长，无法检查要调用的方法。

好处是，如果所有方法都与一个类相关并且将它们放在单独的类中没有意义，那么您就不会创建不必要的类。

另一种方法是按照 Gray 的建议为每个方法设置单独的类，而不是直接创建可以用来`Factory Pattern`为您创建和实例的特定类的实例。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-01T19:08:13.643

如果您必须进行大量调用，最好的解决方案是实例化一个线程池并将其用于所有任务。稍后，您根据机器拥有的处理器/内核数量对其进行盘绕调整。这是一个使用 a 的非常简单的实现`ThreadPoolExecutor`：

```
import java.util.concurrent.LinkedBlockingQueue;
import java.util.concurrent.ThreadPoolExecutor;
import java.util.concurrent.TimeUnit;

public class GenericThreadPool {

    private static final int CORE_POOL_SIZE = 3;
    private static final int MAXIMUM_POOL_SIZE = 10;
    private static final long KEEP_ALIVE_TIME = 10;

    private ThreadPoolExecutor threadPool = null;
    private final LinkedBlockingQueue<Runnable> queue = new LinkedBlockingQueue<Runnable>();

    private GenericThreadPool() {
        this.threadPool = new ThreadPoolExecutor(CORE_POOL_SIZE, MAXIMUM_POOL_SIZE, KEEP_ALIVE_TIME, TimeUnit.SECONDS,
                this.queue);

    }

    private static class LazyHolder {
        public static final GenericThreadPool INSTANCE = new GenericThreadPool();
    }

    public static GenericThreadPool getInstance() {
        return LazyHolder.INSTANCE;
    }

    public void execute(Runnable task) {
        this.threadPool.execute(task);
    }

    public void shutdown() {
        this.threadPool.shutdown();
    }

} 
```

要执行任务，您只需创建一个实现`Runnable`接口的类，获取线程池实例并运行您的作业。

```
public class MyJob implements Runnable {
   public void run(){
      // Do your job here...
   }
}

GenericThreadPool pool = GenericThreadPool.getInstance();
pool.execute(new MyJob()); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-02T06:50:55.037

好吧，很多人建议你使用 Runnable，但我建议你使用 Callable，因为 Runnable 不返回结果并且不能抛出检查异常。为了更好地组织代码并能够从方法中抛出异常或返回值，请使用 callable。也为了您的目的，使用一些池执行器来完成这项工作。这是我对设计的看法，-

1.  编写一个可调用类并根据请求参数调用适当的方法，

    私有类 GetAndProcessResponse 实现 Callable { 私有最终请求请求；私人最终CountDownLatch countDownLatch；

    ```
     GetAndProcessResponse(final Request request, final CountDownLatch countDownLatch) {
            this.request = request;
            this.countDownLatch = countDownLatch;
        }

        public ProcessedResponse call() {
            try {
                // do a switch case on request params
                // and call appropriate methods.
            } finally {
                countDownLatch.countDown();
            }
        }
    } 
    ```

2.  使用 countDownLatch 获取作业完成状态。

3.  不要调用 join，因为你需要使用 executor 服务。

4.  使用 future.get(timeout) 因为它是一个网络工作，需要一段时间后削减。

# vbscript - 执行 wScript 的 VBScript 未正确执行

> ID：10855680
> 
> 赞同：0
> 
> 时间：2012-06-01T18:42:41.217
> 
> 标签：vbscript, wsh

尝试将我的 IIS 日志自动加载到 MSSQL 中，我编写了以下函数。

执行这个函数会弹出一个cmd提示符来执行logparser.exe，然后立即关闭。它保持打开的时间足以让我看到 logparser 帮助菜单。

但是，如果我删除“>> test.out”部分，它会按预期工作。

知道为什么吗？如您所见，我正在输出按预期正确形成的 shell 字符串。

```
Function RunLogParser(logFile) 

Dim oShell, iRC, ShellString 

WScript.Echo "Importing File " + logFile + vbCrLf

ShellString = """C:\Program Files\Log Parser 2.2\LogParser.exe"" ""SELECT * INTO weblog FROM " + logFile + """ " + " -i:W3C -o:SQL -server:localhost -database:testdb -driver:""SQL Server"" -createTable:OFF" + " >> test.out"

WScript.Echo vbTab + "Shell String " + ShellString + vbCrLf

     Set oShell =  WScript.CreateObject("WScript.Shell")

     iRC = oShell.Run(Shellstring, 1, True)        

     RunLogParser = (iRC=0)

RunLogParser = False

End Function 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-01T18:49:46.133

要使用 shell 功能（>> 重定向），您需要一个 shell；所以在你的 ShellString 前面加上“%comspec% /c”。由于此命令的复杂性，可能需要进一步修改引号。

# java - 尝试运行我的 servlet 时出现 HTTP 状态 404

> ID：10855681
> 
> 赞同：0
> 
> 时间：2012-06-01T18:42:43.103
> 
> 标签：java, eclipse, jsp, servlets

我有一个动态 Web 项目，其中一个 DAO FileDao 在包中`de.vogella.wtp.filecounter.dao;`，一个 servlet FileCounter 在包 d`e.vogella.wtp.filecounter.servlets;`包中。我试图运行 servlet 并更改端口 8088，因为我的 8080 已经被其他一些应用程序占用。当我运行这个 servlet 时，我在控制台中收到以下错误：

```
Jun 1, 2012 2:39:13 PM org.apache.tomcat.util.digester.SetPropertiesRule begin
WARNING: [SetPropertiesRule]{Server/Service/Engine/Host/Context} Setting propert
y 'source' to 'org.eclipse.jst.jee.server:de.vogella.wtp.filecounter' did not fi
nd a matching property.
Jun 1, 2012 2:39:13 PM org.apache.coyote.AbstractProtocol init
INFO: Initializing ProtocolHandler ["http-bio-8088"]
Jun 1, 2012 2:39:13 PM org.apache.coyote.AbstractProtocol init
INFO: Initializing ProtocolHandler ["ajp-bio-8010"]
Jun 1, 2012 2:39:13 PM org.apache.catalina.startup.Catalina load
INFO: Initialization processed in 380 ms
Jun 1, 2012 2:39:13 PM org.apache.catalina.core.StandardService startInternal
INFO: Starting service Catalina
Jun 1, 2012 2:39:13 PM org.apache.catalina.core.StandardEngine startInternal
INFO: Starting Servlet Engine: Apache Tomcat/7.0.27
Jun 1, 2012 2:39:13 PM org.apache.coyote.AbstractProtocol start
INFO: Starting ProtocolHandler ["http-bio-8088"]
Jun 1, 2012 2:39:13 PM org.apache.coyote.AbstractProtocol start
INFO: Starting ProtocolHandler ["ajp-bio-8010"]
Jun 1, 2012 2:39:13 PM org.apache.catalina.startup.Catalina start
INFO: Server startup in 260 ms 
```

这是错误：

```
HTTP Status 404 - /de.vogella.wtp.filecounter/servlet/de.vogella.wtp.filecounter.servlets.FileCounter

--------------------------------------------------------------------------------

type Status report

message /de.vogella.wtp.filecounter/servlet/de.vogella.wtp.filecounter.servlets.FileCounter

description The requested resource (/de.vogella.wtp.filecounter/servlet/de.vogella.wtp.filecounter.servlets.FileCounter) is not available.

--------------------------------------------------------------------------------

Apache Tomcat/7.0.27 
```

对出了什么问题有任何猜测吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T19:19:45.880

HTTP 错误 404 表示找不到页面或资源。所以你只是输入了错误的 URL。只需检查 web.xml 中的 URL 和在浏览器中键入的 URL。

在这里，也许`FileCounter`上课放错了地方。也检查一下。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-06-04T11:19:56.480

我正在做同样的教程并且遇到了同样的问题。我想这是一个非常常见的教程，所以我会在这里留下我的答案。

在我的安装中，Eclipse 默认不创建 web.xml。创建 Servlet 时，Eclipse 使用注解进行映射。我在复制教程的代码时不小心删除了注释。我猜你也是这样做的。

为了解决这个问题，我在课堂前添加了一个 @WebServlet 注释。像这样：

```
@WebServlet("/FileCounter")
public class FileCounter extends HttpServlet {
... 
```

# php - 解释这个 UTF-8 检测正则表达式

> ID：10855682
> 
> 赞同：5
> 
> 时间：2012-06-01T18:42:44.617
> 
> 标签：php, regex

这个问题询问如何检测 UTF-8 字符串 -[如何检测是否必须在字符串上应用 utf8 解码或编码？](https://stackoverflow.com/questions/4407854/)

解决方案是这样的：

```
if (preg_match('!!u', $string))
{
   // this is utf-8
}
else 
{
   // definitely not utf-8
} 
```

我一直无法弄清楚如何分解“!!u”表达式。我点击了所有 PHP 的 PCRE 内容，可能错过了“！”的描述。标记和“u”-东西。我尝试通过 perl 的 YAPE::Regex::Explain 运行它（如[请解释这个 Perl 正则表达式](https://stackoverflow.com/questions/381157/please-explain-this-perl-regular-expression/381175#381175)中所见）并且无法得到有意义的东西 [我不是 perl 专家 - 不知道我是否喂它正确的表达式/字符串]。

那么......究竟是如何`preg_match('!!u', $string)`工作的？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-01T18:46:38.280

这只是一个空的正则表达式。`!`是[分隔符](http://www.php.net/manual/en/regexp.reference.delimiters.php)，`u`是[修饰符](http://php.net/manual/en/reference.pcre.pattern.modifiers.php)。

至于它为什么起作用，来自 PHP Manual 对`u`修饰符的描述（强调我的）：

> 此修饰符打开与 Perl 不兼容的 PCRE 的附加功能。模式字符串被视为 UTF-8。此修饰符在 Unix 上的 PHP 4.1.0 或更高版本以及 win32 上的 PHP 4.2.3 中可用。自 PHP 4.3.5 起**检查模式的 UTF-8 有效性。**

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-06-01T18:46:57.047

`!`被用作分隔符而不是`/`. 我会为你重写这个，`//u`是一样的。这`u`是一个将模式视为 utf8 的修饰符。

# ios - 如何提交需要登录的应用程序

> ID：10855683
> 
> 赞同：0
> 
> 时间：2012-06-01T18:42:45.840
> 
> 标签：ios, app-store

我正在提交一个与另一个系统集成的应用程序。为了使用该应用程序，您需要有一个 Apple 没有的系统登录。

提交此类应用程序的准则是什么？如果 Apple 测试团队能看到的唯一屏幕是登录屏幕，我认为可能会有一些问题。

谢谢，

乔

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-01T18:44:55.577

您应该为 Apple 审阅者提供一个测试帐户，并在提交应用程序时指定登录凭据。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-01T18:45:04.207

我创建了几个类似的应用程序。我们为 Apple 提供了或多或少的虚拟帐户，可以通过登录屏幕并查看应用程序的基本功能，但没有发布任何我们不想泄露的秘密信息

# asp.net - GridView RowCommand 事件和保存文本

> ID：10855687
> 
> 赞同：1
> 
> 时间：2012-06-01T18:42:52.323
> 
> 标签：asp.net, gridview, postback

我有一个 GridView 设置：

```
<asp:GridView id="GridView1" Runat="server" AutoGenerateColumns="False" OnRowCommand = "GridView1_RowCommand" EnableViewState="true">
   <Columns>
       <asp:TemplateField HeaderText="Delete" ItemStyle-HorizontalAlign="Center"> 
            <ItemTemplate><asp:Button runat="server" ID="Delete" ImageUrl="~/images/Close.gif" CommandName="DeleteRow" CommandArgument="<%# CType(Container,GridViewRow).RowIndex %>"/></ItemTemplate></asp:TemplateField>

       <asp:TemplateField HeaderText="Comment" ItemStyle-Width="175px">
            <ItemTemplate><textarea class="raTextBox" id="txtItemComment" rows="4" cols="30"></textarea></ItemTemplate></asp:TemplateField> 
   </Columns>   
</asp:GridView> 
```

代码隐藏中的 RowCommand 设置如下：

```
Protected Sub GridView1_RowCommand(ByVal sender As Object, ByVal e As System.Web.UI.WebControls.GridViewCommandEventArgs)
   If (e.CommandName = "DeleteRow") Then
     //do stuff here 
```

GridView 是页面加载上的数据绑定，如下所示：

```
Private Sub Page_Load(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles MyBase.Load
  If Not IsPostBack Then
     Session("CalledModule") = "RCMT0021"
  Else
      With ViewState
           _intRepor = CInt(.Item("Report"))
      End With
  End If
     DataBind()   //Gridview Load
End Sub 
```

我的问题：

1.  行命令事件永远不会被触发。该页面刚刚进入 Page_Load 中的 ELSE（不是回发）
2.  如何跟踪在每一行的“评论”列（TEXTAREA）中输入的所有内容，并在单击“保存更改”（表单）按钮时将数据保存到数据库中？

谢谢！

更新：网格视图的数据绑定如下：

```
Public Sub DataBind()
Dim clsDatabase As New clsDatabase
Dim cmd As New OleDbCommand()
Try
 cmd.CommandText = "SELECT A, B FROM WHERE C = ? ORDER BY A"
   Dim report As New OleDbParameter("@Report", _intReportNumber)
   cmd.Parameters.Add(report)

   cmd.Connection = clsDatabase.Open_DB()
   Dim dReader As OleDbDataReader
   dReader = cmd.ExecuteReader(CommandBehavior.CloseConnection)

   Dim dt As New DataTable
   dt.Columns.Add(New DataColumn("PictureURL", GetType(String)))
   dt.Columns.Add(New DataColumn("Seq", GetType(Int16)))
   dt.Columns.Add(New DataColumn("ReportNumber", GetType(String)))

   Do While (dReader.Read())
      Dim dr As DataRow = dt.NewRow()

      _strComments = dReader(0).ToString
      dr("Seq") = dReader.GetInt16(1)
      dr("PictureURL") = "GetImages.aspx?report=" + _intReportNumber.ToString + "&seq=" + dReader.GetInt16(1).ToString
      dr("ReportNumber") = _intReportNumber.ToString
      dt.Rows.Add(dr)
   Loop

   GridView1.DataSource = dt
   GridView1.DataBind()

  Catch err As Exception
 End Try
End Sub 
```

![在此处输入图像描述](../Images/e687c045c53ed7f3d7c0c2882228350d.png)

因此，基本上，GridView 具有三个可见列 - 一个评论字段、一个图片字段和一个带有删除按钮（图像）的字段，用于从数据库中删除图片（和评论，如果有的话）。第 4 列是隐藏的，用于跟踪图像的图像 ID。为简单起见，我没有包括图片和其他列。

*   用户可以添加评论，当他点击“保存更改”按钮时，应该为图片保存相应的评论。
*   **'SELECT IMAGE' 打开一个 ModalDialogBox，使用户能够选择图像。关闭时，它会导致回发，并重新绑定 gridview 以显示用户刚刚选择的图像。因此，我需要 GridView 在回发时重新绑定，或者解决这个问题。**
*   删除图像按钮**（在 gridview 中）**应该从数据库中删除图像和评论。

再次感谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-02T04:52:59.043

试试这个结构...

aspx 页面：（注`textarea`有`runat="server"`）

```
<body>
    <form runat="server">
    <asp:ScriptManager runat="server" />
    <asp:UpdatePanel ID="UpdatePanel1" runat="server">
        <ContentTemplate>
            <asp:GridView ID="GridView1" runat="server" AutoGenerateColumns="False" OnRowCommand="GridView1_RowCommand"
                EnableViewState="true" OnRowDataBound="GridView1_RowDataBound">
                <Columns>
                    <asp:TemplateField HeaderText="Delete" ItemStyle-HorizontalAlign="Center">
                        <ItemTemplate>
                            <asp:Button runat="server" ID="Delete" Text="Delete" />
                        </ItemTemplate>
                    </asp:TemplateField>
                    <asp:TemplateField HeaderText="Comment" ItemStyle-Width="175px">
                        <ItemTemplate>
                            <textarea runat="server" class="raTextBox" id="txtItemComment" rows="4" cols="30"></textarea></ItemTemplate>
                    </asp:TemplateField>
                </Columns>
            </asp:GridView>
        </ContentTemplate>
    </asp:UpdatePanel>
    </form>
</body> 
```

aspx.cs：

```
protected void Page_Load(object sender, EventArgs e)
{
    if (!Page.IsPostBack)
    {
        BindGrid();
    }
}

protected void BindGrid()
{
    var items = new List<string>();
    for (int i = 0; i < 10; i++)
    {
        items.Add(i + ";comment" + i.ToString());
    }
    GridView1.DataSource = items;
    GridView1.DataBind();
}

protected void GridView1_RowCommand(object sender, GridViewCommandEventArgs e)
{
    if (e.CommandName == "DeleteRow")
    {
        var idx = Convert.ToInt32(e.CommandArgument);
        var cmt = GridView1.Rows[idx].FindControl("txtItemComment") as System.Web.UI.HtmlControls.HtmlTextArea;
        cmt.Value = DateTime.Now.ToString();
    }
}

protected void GridView1_RowDataBound(object sender, GridViewRowEventArgs e)
{
    if (e.Row.RowType == DataControlRowType.DataRow)
    {
        var item = e.Row.DataItem.ToString().Split(";".ToCharArray());

        var del = e.Row.FindControl("Delete") as Button;
        del.CommandName = "DeleteRow";
        del.CommandArgument = item[0];

        var cmt = e.Row.FindControl("txtItemComment") as System.Web.UI.HtmlControls.HtmlTextArea;
        cmt.Value = item[1];
    }
} 
```

![然后点击 3 个按钮](../Images/10a9552e4e44ca0dbe58be963fcfcd9c.png)

# powershell - 如何重新评估从文件中获取的 powershell 变量

> ID：10855689
> 
> 赞同：1
> 
> 时间：2012-06-01T18:42:55.530
> 
> 标签：powershell, csv, profile

我正在使用 CSV 文件和 Import-Csv 来获取一堆自定义别名和路径。我这样做是为了让我可以运行，并且路径将通过 Invoke-Item 执行。

我也可以在命令外壳窗口中执行此操作，以使用以下命令打开配置文件 ps1：Invoke-Item $PROFILE - 然后在记事本中启动配置文件 ps1。

但我想使用我的运行功能。所以我在 CSV 中指定别名“profile”以及路径为“$PROFILE”，然后应该调用“Invoke-Item $profile”——除非我通过 CSV 使用它，$profile 仍然是一个文本并且不得到评估。

有没有办法重新评估字符串中的变量？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-01T19:58:50.197

您可以使用`Invoke-Expression`cmdlet（或其别名“iex”）对其进行评估：

```
Invoke-Item (iex "$profile") 
```

# javascript - 如何让嵌入式 JavaScript 在 .innerHTML 写入中运行？

> ID：10855695
> 
> 赞同：0
> 
> 时间：2012-06-01T18:43:23.307
> 
> 标签：javascript, json

我以前遇到过外部文件未运行的问题。

我通过动态加载文件来解决这个问题......即在 JavaScript 中创建元素并通过 .src 属性链接到它（这样做而不是在 html 中使用脚本标记）。我需要在这里做类似的事情吗？

这是我需要运行的嵌入式 JavaScript，它通过正文的 .innerHTML 插入。目前它只是我页面中的“死代码”。请注意我作为 set 函数的第二个变量传入的 json。这是 PHP 编写并通过 ajax POST 传递给客户端的。

```
<script type='text/javascript'>new Arc.Shared().set( 'tweet_data', [{"id":"1","0":"1","picture":"0","1":"0","name":"Test Account","2":"Test Account","tweet":"Hi","3":"Hi","time":"1338559048","4":"1338559048"},{"id":"1","0":"1","picture":"0","1":"0","name":"Test Account","2":"Test Account","tweet":"hi","3":"hi","time":"1338558809","4":"1338558809"},{"id":"1","0":"1","picture":"0","1":"0","name":"Test Account","2":"Test Account","tweet":"<a class=\"bookmark_tweet\" target=\"_blank\" href=\"http:\/\/ebay.com\">ebay <\/a>","3":"<a class=\"bookmark_tweet\" target=\"_blank\" href=\"http:\/\/ebay.com\">ebay <\/a>","time":"1338504456","4":"1338504456"},{"id":"1","0":"1","picture":"0","1":"0","name":"Test Account","2":"Test Account","tweet":"foo","3":"foo","time":"1338504225","4":"1338504225"},{"id":"1","0":"1","picture":"0","1":"0","name":"Test Account","2":"Test Account","tweet":"foo","3":"foo","time":"1338504222","4":"1338504222"},{"id":"1","0":"1","picture":"0","1":"0","name":"Test Account","2":"Test Account","tweet":"foo","3":"foo","time":"1338504220","4":"1338504220"},{"id":"1","0":"1","picture":"0","1":"0","name":"Test Account","2":"Test Account","tweet":"foo","3":"foo","time":"1338504217","4":"1338504217"}] );</script> 
```

**笔记：**

Eval Snippet 的替代方案：

```
var myCode = 'alert("Howdy?");';
 var myFucn = new Function(myCode);
 myFucn(); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T18:47:00.840

如果你想运行 AJAX 注入的 JS，你应该在它上面调用“eval()”（出于安全原因）。另一种可能性是通过`<script src='[url to your JS]'></script>`标签加载它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-01T21:18:49.493

另一种方式[：为什么嵌入的 JavaScript 在响应 ajax 调用时不执行？](https://stackoverflow.com/questions/7297293/why-doesnt-embedded-javascript-execute-when-inserted-in-response-to-an-ajax-cal)

这是 append 子方法……它采用 ajax responseText 并将其附加到 DOM 中。

```
function onSuccess() {
    src = document.createElement('script');
    src.innerHTML = this.responseText;
    document.body.appendChild(src);
} 
```

第三种方法是让外部元素在此处触发它：

[执行使用 .innerHTML 插入的 <script> 元素](https://stackoverflow.com/questions/2592092/executing-script-elements-inserted-with-innerhtml)

# django - django-tastypie 有 JSON 响应

> ID：10855701
> 
> 赞同：0
> 
> 时间：2012-06-01T18:43:33.167
> 
> 标签：django, tastypie

我的意思是，我想在修改 obj_create() 时得到 JSON 响应。我已经实现了 UserSignUpResource(ModelResource) 并在 obj_create() 内部进行了一些验证，当它失败时，我提出了 BadRequest()。但是，这并不会丢弃 JSON。它会抛出 String 。

知道我是否可以让它抛出 {'error': 184, 'message': 'This username already exists'} 格式？还是我不打算修改 obj_create()？或者我应该怎么做？

多多帮助，谢谢。

干杯，米奇

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-07T22:03:32.623

很简单，我刚刚在tastepies http 模块中创建了一个小辅助方法：

```
import json

#tastypies HttpResponse classes here...

def create_json_response(data, http_response_class):
    return http_response_class(content=json.dumps(data), content_type="application/json; charset=utf-8") 
```

那么你可以简单地说：

```
from tastypie.http import HttpNotFound, create_json_response

#choose HttpNotFound, HttpCreated whatever...
raise ImmediateHttpResponse(create_json_response({"error":"resource not found"}, HttpNotFound)) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-12-18T15:01:06.260

您应该使用资源中的 error_response 方法。

就像是：

```
 def obj_create(self, bundle, **kwargs):
        # Code that finds Some error
        my_errors = {"error": ["Some error"]}
            raise ImmediateHttpResponse(response=self.error_response(bundle.request, my_errors)) 
```

通常你会调用 super 并且错误应该来自于 sweetpie 验证过程。异常将被自动抛出（错误字典保存在 bundle.errors 属性中）。

# php - 在mysql中选择所有可能的孩子

> ID：10855703
> 
> 赞同：-1
> 
> 时间：2012-06-01T18:43:37.730
> 
> 标签：php, mysql

我有一个用户表。我有一张认证表​​。

每个用户可以拥有多个认证。认证有一个 user_id 外键。

1.  如何在一个查询中选择用户及其所有认证？
2.  如何选择获得认证的用户？

用户表：

```
CREATE TABLE `users` (
  `id` int(11) unsigned NOT NULL auto_increment,
  `username` varchar(24) default NULL,
  `displayname` varchar(24) default NULL,
  `email` varchar(64) default NULL,
  `password` text,
  `signup_date` int(11) default NULL,
  `signup_ip` varchar(15) default NULL,
  `hash` text,
  `verified` tinyint(1) default '0',
  `last_login` int(11) default NULL,
  `logins` int(11) default NULL,
  `status` text,
  `recovery_hash` text,
  `recovery_initiated` int(11) default NULL,
  `last_updated` int(11) default NULL,
  `signup_method` text,
  `signup_question` int(11) default NULL,
  PRIMARY KEY  (`id`)
) ENGINE=InnoDB AUTO_INCREMENT=3 DEFAULT CHARSET=utf8; 
```

认证表：

```
CREATE TABLE `certifications` (
  `id` int(11) unsigned NOT NULL auto_increment,
  `user_id` int(11) unsigned NOT NULL,
  `number` varchar(128) default NULL,
  `board` varchar(128) default NULL,
  `company` varchar(128) default NULL,
  `website` varchar(128) default NULL,
  PRIMARY KEY  (`id`),
  KEY `user_id` (`user_id`),
  CONSTRAINT `certifications_ibfk_1` FOREIGN KEY (`user_id`) REFERENCES `users` (`id`) ON DELETE CASCADE ON UPDATE CASCADE
) ENGINE=InnoDB AUTO_INCREMENT=3 DEFAULT CHARSET=utf8; 
```

感谢您的阅读。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-01T18:52:25.680

使用 join 获取 id 为 1 的用户的所有证书。

```
SELECT b.id as certification_id 
FROM users AS a
LEFT JOIN certifications AS b
ON a.id = b.user_id
WHERE a.id = 1; 
```

使用内部联接获取所有具有认证的用户。所有没有证书的用户都将退出。

```
SELECT a.id as users_with_certifications
FROM users as a
JOIN certifications AS b
ON a.id = b.user_id; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-01T18:54:07.093

如何在一个查询中选择用户及其所有认证？

```
SELECT *
FROM certifivations C
LEFT JOIN users U
ON C.user_id = U.id
WHERE U.id=USERID 
```

如何选择获得认证的用户？

```
SELECT *
FROM certifivations C
JOIN users U
ON C.user_id = U.id
GROUP BY U.id 
```

# asp.net-mvc-3 - 从部分视图返回部分 h tml？

> ID：10855705
> 
> 赞同：0
> 
> 时间：2012-06-01T18:43:45.773
> 
> 标签：asp.net-mvc-3, razor

我们有一个页面，其中有很多（接近 20 个）按钮/链接，它们会弹出不同的 div。我正在考虑将所有这 20 个 div 的 html 放在一个 cshtml 文件中。当进行 ajax 调用（对控制器操作方法）时，我想获取这个 cshtml 文件，获取这个特定的 div（我将为每个 div 使用一些分隔符/标识符）并返回 html。我怎样才能做到这一点？

还是有更好的方法？我不想将所有 20 个 div 都隐藏在主视图 cshtml 页面中。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T18:46:11.063

在局部视图中使用 a`switch`来选择要发出的内容块。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-01T19:06:51.967

看看这篇文章[在 ASP.NET MVC 3 中实现 RenderPartialViewToString](http://www.c-sharpcorner.com/blogs/7150/implementing-renderpartialviewtostring-in-asp-net-mvc-3.aspx)

# ios - 如何根据开关位置限制阵列的负载

> ID：10855706
> 
> 赞同：0
> 
> 时间：2012-06-01T18:43:46.653
> 
> 标签：ios, xcode, annotations, switch-statement, nsuserdefaults

我从 plist 和循环类别加载我的注释

```
NSMutableArray *annotations = [[NSMutableArray alloc]init];

NSString *path = [[NSBundle mainBundle] pathForResource:@"data" ofType:@"plist"];
NSDictionary *dict = [NSDictionary dictionaryWithContentsOfFile:path];

for(path in dict){

NSString *theCategory;

theCategory = [NSString stringWithFormat:@"%@", path];
NSLog(@"%@", path);

NSArray *ann = [dict objectForKey:theCategory];

for(int i = 0; i < [ann count]; i++) {

    NSString *coordinates = [[ann objectAtIndex:i] objectForKey:@"Coordinates"];

    double realLatitude = [[[coordinates componentsSeparatedByString:@","] objectAtIndex:1] doubleValue];
    double realLongitude = [[[coordinates componentsSeparatedByString:@","] objectAtIndex:0] doubleValue];

    MyAnnotation *myAnnotation = [[MyAnnotation alloc] init];
    CLLocationCoordinate2D theCoordinate;
    theCoordinate.latitude = realLatitude;
    theCoordinate.longitude = realLongitude;

    myAnnotation.coordinate=CLLocationCoordinate2DMake(realLatitude,realLongitude);        
    myAnnotation.title = [[ann objectAtIndex:i] objectForKey:@"Name"];
    myAnnotation.subtitle = [[ann objectAtIndex:i] objectForKey:@"Address"];
    myAnnotation.icon = [[ann objectAtIndex:0] objectForKey:@"Icon"];

    [mapView addAnnotation:myAnnotation];
    [annotations addObject:myAnnotation];

}

} 
```

然后我的设置中有一个开关

```
- (IBAction)saveSwitch:(id)sender
{
    NSUserDefaults *defs1 = [NSUserDefaults standardUserDefaults];
    [defs1 setBool: blackSwitch.on forKey: @"blackKey"];
    [[NSUserDefaults standardUserDefaults] synchronize];
} 
```

**我需要通过此开关限制特定类别的注释显示。如果我循环类别，怎么办？**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-01T18:50:55.103

在您的第一个循环中，执行以下操作：

```
for(NSString *category in dict){
    if ([category isEqualToString:@"Whatever"]) {
        //continue?
        NSArray *ann = [dict objectForKey:category];
        BOOL blackKeyStatus = [[NSUserDefaults standardUserDefaults]boolForKey:@"blackKey"];

        if (blackKeyStatus) {
            //switch ON
            //act appropriatelyForOnValue
            //begin Loop 2 here?
        } else {
            //switch OFF
            //act appropriately
        }

    } else {
        //do something else?
    } 
```

如果您需要测试特定条件，请执行任何必要的操作来确定是否满足该条件。

# java - 显示没有输入的软键盘

> ID：10855707
> 
> 赞同：0
> 
> 时间：2012-06-01T18:43:56.160
> 
> 标签：java, android

我实现了一个控件是软键盘的活动（我想在按下某些键时执行一些操作）

所以我想显示键盘（没有 EditText 或类似的）并阅读触摸

```
@Override
public boolean onKeyDown(int keyCode, KeyEvent event) {
    return super.onKeyDown(keyCode, event);

} 
```

键盘应始终在应用程序中可见。那可能吗？我该怎么做？谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T19:32:04.373

目前无法测试它是否有效，但我知道至少有一个用于 EditTexts 的显示/隐藏软键盘，但它可能适用于任何视图：

```
InputMethodManager imm = (InputMethodManager)getSystemService(Context.INPUT_METHOD_SERVICE);
            imm.showSoftInputFromWindow(viewToAnchorTo.getWindowToken(), 0); 
```

# javascript - 将页面上的特定单词大写

> ID：10855709
> 
> 赞同：3
> 
> 时间：2012-06-01T18:44:03.437
> 
> 标签：javascript, jquery, html, css

我有您的典型 MVC3 应用程序，其中包含大量 CRUD 页面。在这些页面中，有很多带有 Id 列的列表......客户今天告诉我，他们总是希望看到“ID”而不是“Id”，但这些字段通常更完全合格（IE：“Job Id”或某物）

有没有办法使用css仅对文本的“Id”部分进行文本转换（全部大写）而不添加任何额外的html？

我认为部分解决方案涉及这个伪类： div:contains(" Id ") 但我不确定它是否可行......

我也不介意用 jquery 做这个，但我试图尽量减少重构。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-01T19:08:36.007

根据其他答案，这里是带有有效替换的简短版本：

```
$("h3").text(function() {
    return $(this).text().replace(/\b(id)\b/gi, "ID");
});​ 
```

**演示：http:** [//jsfiddle.net/bcAyP/](http://jsfiddle.net/bcAyP/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-01T19:15:40.843

You cannot apply CSS to specific words, only elements (or the small set of pseudo-elements defined by CSS). Here's a JavaScript-based solution that never affects your markup:

## Demo: [http://jsfiddle.net/6LRWC/2/](http://jsfiddle.net/6LRWC/2/)

```
function replaceTextUnder(node,pattern,str){
  var t, walk=document.createTreeWalker(node,NodeFilter.SHOW_TEXT,null,false);
  while(t=walk.nextNode()){
    t.nodeValue = t.nodeValue.replace(pattern,str);
  }
}

replaceTextUnder(document.body, /\bid\b/gi, "ID" ); 
```

Alternatively, here it is wrapped up as a jQuery plugin:

```
jQuery.fn.replaceInText = function(pattern,str){
  return this.each(function(){
    var t, walk=document.createTreeWalker(this,NodeFilter.SHOW_TEXT,null,false);
    while(t=walk.nextNode()) t.nodeValue = t.nodeValue.replace(pattern,str);
  });
};

$('li,td,th').replaceInText( /\bid\b/gi, "ID" );​ 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-01T18:52:55.327

您不能将 CSS 样式应用于单个单词，只能应用于元素。这意味着您需要有额外的 HTML。否则，它可以在 jQuery 中完成。

```
$("h3").each(function() {
    var title = $(this).text();
    title = title.replace(/\bid\b/gi, "ID");
    $(this).text(title);
}); 
```

[**活生生的例子**](http://jsfiddle.net/VKYg7/16/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-01T18:58:50.217

要对抗内部匹配，请使用以下内容：

```
$("h3").each(function() {
    $(this).text($(this).text().replace(/\sId/g, "ID"));
});​ 
```

这当然假设 id 总是大写，如您的描述。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2012-06-01T19:08:16.170

[http://jsfiddle.net/HZVs8/](http://jsfiddle.net/HZVs8/)

给你，先生。

```
$("body").html(function(i, t) {
return t.replace(/( id)/g, " ID");
});​ 
```

您需要注意的是，您必须确保“id”在 jQuery 中之前有一个空格，否则，此代码将查找每个包含“id”的文本字符串并对其进行转换到“身份证”。

如果您遇到的问题是文本是这样的：“ProjectId”并且您希望它是这样的：“ProjectID”，请使用以下代码：

```
$("body").html(function(i, t) {
return t.replace(/(Id)/g, " ID");
}); 
```

基本上，您选择的文本区分大小写。只需确保您选择了正确的片段，否则它可能会选择带有“id”的每个单词并将其设为“ID”，而您不希望这样。

弄乱我制作的 JSFiddle。有用。

# android - 在上午 12:00 更新小部件？

> ID：10855710
> 
> 赞同：0
> 
> 时间：2012-06-01T18:44:16.410
> 
> 标签：android, android-widget

我的小部件只是一个日期小部件。我需要的是每天凌晨 12:00（午夜之后）更新 UI。这是我第一次这样做的方式：

在我的`widget_info.xml`：

```
android:updatePeriodMillis="1000*60*30" //equals to 30 min which is the min time you can update. 
```

这种方法工作正常，除了一件事：它没有在上午 12:00 准确更新。它可能会在上午 12:00-12:30 的范围内更新（在我的情况下，它会在上午 12:19 更新）。如何在每小时开始时强制更新？

我阅读了一些关于使用 AlarmManager 的内容，这将帮助您在 30 分钟内更新小部件。这将解决我的问题（如果我强制它每分钟更新一次），但我能有比这更简单的解决方案吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-01T19:12:21.450

`AlarmManager`如果您需要*精确*的更新时间，您将不得不走这条路线......

# java - 适用于 App Engine (Java) 的全文搜索 API

> ID：10855711
> 
> 赞同：3
> 
> 时间：2012-06-01T18:44:22.730
> 
> 标签：java, google-app-engine, full-text-search

我一直在尝试使用 Google AppEngine 的实验性搜索 API。我正在使用 SDK 1.6.6。到目前为止，我可以将条目添加到索引并在我的开发环境中搜索它。当我部署我的应用程序时，我仍然可以将条目添加到索引中，但是当我尝试执行搜索时，我得到以下异常日志：

```
br.com.qmagico.server.service.search.GenericSearchService search: Busca com query 'soma' falhou
com.google.appengine.api.search.SearchException: 
at com.google.appengine.api.search.IndexImpl$3.convertException(IndexImpl.java:268)
at com.google.appengine.api.utils.FutureWrapper.get(FutureWrapper.java:106)
at com.google.appengine.api.search.FutureHelper.getInternal(FutureHelper.java:74)
at com.google.appengine.api.search.FutureHelper.quietGet(FutureHelper.java:33)
at com.google.appengine.api.search.IndexImpl.search(IndexImpl.java:390)
at br.com.qmagico.server.service.search.GenericSearchService.search(GenericSearchService.java:109)
at br.com.qmagico.server.service.search.AulaSearchService.search(AulaSearchService.java:50)
at br.com.qmagico.server.handler.GetAulasHandler.executeLoggedException(GetAulasHandler.java:45)
at br.com.qmagico.server.handler.GetAulasHandler.executeLoggedException(GetAulasHandler.java:1)
at br.com.qmagico.server.QmActionHandler.execute(QmActionHandler.java:23)
at com.gwtplatform.dispatch.server.AbstractDispatchImpl.doExecute(AbstractDispatchImpl.java:153)
at com.gwtplatform.dispatch.server.AbstractDispatchImpl.execute(AbstractDispatchImpl.java:111)
at com.gwtplatform.dispatch.server.AbstractDispatchServiceImpl.execute(AbstractDispatchServiceImpl.java:81)
at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
at java.lang.reflect.Method.invoke(Method.java:616)
at com.google.apphosting.runtime.security.shared.intercept.java.lang.reflect.Method_$1.run(Method_.java:165)
at java.security.AccessController.doPrivileged(Native Method)
at com.google.apphosting.runtime.security.shared.intercept.java.lang.reflect.Method_.privilegedInvoke(Method_.java:163)
at com.google.apphosting.runtime.security.shared.intercept.java.lang.reflect.Method_.invoke_(Method_.java:124)
at com.google.apphosting.runtime.security.shared.intercept.java.lang.reflect.Method_.invoke(Method_.java:43)
at com.google.gwt.user.server.rpc.RPC.invokeAndEncodeResponse(RPC.java:569)
at com.google.gwt.user.server.rpc.RemoteServiceServlet.processCall(RemoteServiceServlet.java:208)
at com.google.gwt.user.server.rpc.RemoteServiceServlet.processPost(RemoteServiceServlet.java:248)
at com.google.gwt.user.server.rpc.AbstractRemoteServiceServlet.doPost(AbstractRemoteServiceServlet.java:62)
at javax.servlet.http.HttpServlet.service(HttpServlet.java:637)
at javax.servlet.http.HttpServlet.service(HttpServlet.java:717)
at com.google.inject.servlet.ServletDefinition.doService(ServletDefinition.java:263)
at com.google.inject.servlet.ServletDefinition.service(ServletDefinition.java:178)
at com.google.inject.servlet.ManagedServletPipeline.service(ManagedServletPipeline.java:91)
at com.google.inject.servlet.FilterChainInvocation.doFilter(FilterChainInvocation.java:62)
at com.google.inject.servlet.ManagedFilterPipeline.dispatch(ManagedFilterPipeline.java:118)
at com.google.inject.servlet.GuiceFilter.doFilter(GuiceFilter.java:113)
at org.mortbay.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1157)
at com.google.apphosting.utils.servlet.ParseBlobUploadFilter.doFilter(ParseBlobUploadFilter.java:102)
at org.mortbay.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1157)
at com.google.apphosting.runtime.jetty.SaveSessionFilter.doFilter(SaveSessionFilter.java:35)
at org.mortbay.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1157)
at com.google.apphosting.utils.servlet.TransactionCleanupFilter.doFilter(TransactionCleanupFilter.java:43)
at org.mortbay.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1157)
at org.mortbay.jetty.servlet.ServletHandler.handle(ServletHandler.java:388)
at org.mortbay.jetty.security.SecurityHandler.handle(SecurityHandler.java:216)
at org.mortbay.jetty.servlet.SessionHandler.handle(SessionHandler.java:182)
at org.mortbay.jetty.handler.ContextHandler.handle(ContextHandler.java:765)
at org.mortbay.jetty.webapp.WebAppContext.handle(WebAppContext.java:418)
at com.google.apphosting.runtime.jetty.AppVersionHandlerMap.handle(AppVersionHandlerMap.java:249)
at org.mortbay.jetty.handler.HandlerWrapper.handle(HandlerWrapper.java:152)
at org.mortbay.jetty.Server.handle(Server.java:326)
at org.mortbay.jetty.HttpConnection.handleRequest(HttpConnection.java:542)
at org.mortbay.jetty.HttpConnection$RequestHandler.headerComplete(HttpConnection.java:923)
at com.google.apphosting.runtime.jetty.RpcRequestParser.parseAvailable(RpcRequestParser.java:76)
at org.mortbay.jetty.HttpConnection.handle(HttpConnection.java:404)
at com.google.apphosting.runtime.jetty.JettyServletEngineAdapter.serviceRequest(JettyServletEngineAdapter.java:135)
at com.google.apphosting.runtime.JavaRuntime$RequestRunnable.run(JavaRuntime.java:477)
at com.google.tracing.TraceContext$TraceContextRunnable.runInContext(TraceContext.java:449)
at com.google.tracing.TraceContext$TraceContextRunnable$1.run(TraceContext.java:455)
at com.google.tracing.TraceContext.runInContext(TraceContext.java:695)
at com.google.tracing.TraceContext$AbstractTraceContextCallback.runInInheritedContextNoUnref(TraceContext.java:333)
at com.google.tracing.TraceContext$AbstractTraceContextCallback.runInInheritedContext(TraceContext.java:325)
at com.google.tracing.TraceContext$TraceContextRunnable.run(TraceContext.java:453)
at com.google.apphosting.runtime.ThreadGroupPool$PoolEntry.run(ThreadGroupPool.java:251)
at java.lang.Thread.run(Thread.java:679) 
```

执行此搜索的代码如下：

```
public List<Long> search(Index index, String queryStr, String sortField) {
    ArrayList<Long> ids = new ArrayList<Long>();
    if (queryStr != null && !queryStr.isEmpty()) {
        int limit = 5;
        try {
            QueryOptions.Builder builder = QueryOptions.newBuilder().setLimit(limit);
            if (sortField != null) {
                builder = builder.setSortOptions(SortOptions.newBuilder()
                    .addSortExpression(SortExpression.newBuilder()
                        .setExpression(sortField)
                        .setDefaultValue("")
                        .setDirection(SortExpression.SortDirection.DESCENDING))
                    .build());
            }
            QueryOptions queryOptions = builder.build();

            Query query = Query.newBuilder()
                .setOptions(queryOptions)
                .build(queryStr);
            LOG.info("Enviando query " + query);
            Results<ScoredDocument> results = index.search(query);
            for (ScoredDocument scoredDoc : results) {
                ids.add(scoredDoc.getOnlyField("id").getNumber().longValue());
            }
        } catch (RuntimeException e) {
            LOG.log(Level.SEVERE, "Busca com query '" + queryStr + "' falhou", e);
        }
    }
    return ids;
} 
```

有人我应该做些什么来解决这个问题吗？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-25T04:53:17.307

如果您认为排序是您的问题，那么您可能希望使用 Document rank 对索引中的文档进行预排序。文档上的排名字段默认设置为自 2011 年 1 月 1 日以来的秒数。但是，您可以提供整数排名值。例如，如果您想按价格（从低到高，从高到低）对产品目录进行排序。排名用于对索引中的文档进行预排序。

```
public Index getIndex(String indexName) {
    IndexSpec indexSpec = IndexSpec.newBuilder().setName(indexName).build();
    return SearchServiceFactory.getSearchService().getIndex(indexSpec);
}

Document doc = Document.newBuilder()
    .addField(Field.newBuilder().setName('name').setText("some text"))
    .setRank(functionToGetPrice())
    .build();

getIndex("productHighToLow").put(doc);

doc = Document.newBuilder()
    .addField(Field.newBuilder().setName('name').setText("some text"))
    .setRank(MAXINT-functionToGetPrice())
    .build();

getIndex("productLowToHigh").put(doc); 
```

然后当你搜索你的索引时，如果用户选择了“价格从低到高”并查询“LED TV”，那么你可以简单地发出如下查询

```
getIndex("productLowToHigh").search("LED TV"); 
```

即使对于大型（产品目录）索引，它也会更快且语义正确。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-11T15:43:37.330

您是否尝试删除 SortOptions ？设置 SortOptions 时出现同样的错误。我认为这是一个错误。

# java - Scala 方式来初始化成员？

> ID：10855715
> 
> 赞同：1
> 
> 时间：2012-06-01T18:44:39.743
> 
> 标签：java, scala, constructor

在 Java 中，我们可以扩展方法中的当前范围以引用变量，`this`如果它被形式参数隐藏。一个典型的例子是我们在构造函数中所做的：

```
class A {
    int i;
    A(int i) { this.i = i; }
} 
```

现在，Scala 中有没有类似的技巧？例如，我有这样的定义：

```
class A(i: Int) {
   val i = i; // ?
} 
```

一个简单的解决方案是将其中一个参数重命名为其他参数（例如在 C++ 中使用下划线），但我想避免这种情况。

有没有其他选择？

提前致谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-01T18:51:32.100

*完全一样*吗？然后只需将其声明为`val`（或`var`）：

```
class A(val i: Int) {} 
```

不完全一样吗？然后你必须使用两个名字。

# asp.net-mvc - 回到前面的页面

> ID：10855718
> 
> 赞同：2
> 
> 时间：2012-06-01T18:44:53.150
> 
> 标签：asp.net-mvc

我在部分视图和其他 3 个使用布局的页面中的布局页面中有一个搜索文本输入：

```
@using (Html.BeginForm("Search", "Product"))
{
    @Html.TextBoxFor(m => m.SearchText)
    @Html.ValidationMessageFor(m => m.SearchText)

    <input type="submit" value="Search"/>
} 
```

当它进入 Product/Search 操作时，我如何知道它来自哪里并返回正确的页面并显示一条消息，假设其他 3 个页面使用不同的 ViewModel？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-01T19:17:49.033

在您的布局中，修改您的`BeginForm`以在路由值中包含请求路径：

```
@using (Html.BeginForm("Search", "Product"),new {path = Request.Path}) 
```

然后，在您的控制器中，您可以通过重定向到该路径来完成：

```
public ActionResult Search( string path, FormCollection form ) {
    // build your search results here
    return Redirect( path );
} 
```

这应该可以解决问题。如果您需要传递其他信息，您只需将查询字符串附加到路径：

```
public ActionResult Search( string path, FormCollection form ) {
    // build your search results here
    return Redirect( path + "?message=foo" );
} 
```

# jquery - 拦截模式对话框后如何继续提交事件？

> ID：10855721
> 
> 赞同：0
> 
> 时间：2012-06-01T18:45:00.317
> 
> 标签：jquery, jquery-ui

我有一个表单，我希望用户在尝试提交时确认其中一个值，并且我希望在 jQuery UI 模式对话框中进行确认。

代码看起来像这样：

```
valuesCheck = function(event) {
    $j("#proposal-form-errors")
        .dialog({
            modal: true,
            width: 600,
            title: 'Values Confirmation',
            buttons: {
                "Confirm values and submit proposal": function () {
                    $form = $j('form#proposal');
                    $form.addClass('values-confirmed');
                    $j(this).dialog("destroy");
                    $form.submit();
                },
                "Continue editing": function () {
                    $j(this).dialog("destroy");
                }
            }
        })
        .html('<p>Please confirm the selected values.</p>');
    event.preventDefault();
}

$j("form#proposal").submit(function(event) {
    var val1 = $j("#val1 option:selected").text();
    var val2 = $j("#val2").val();
    if (val1 && val2 && !$j(this).hasClass('values-confirmed')) {
        valuesCheck(event);
    } else {
        return true; // processing stops here after the first click.
    }
}); 
```

通过在 Firebug 中设置断点，我可以看到一切正常，除了在单击“确认值并提交提案”后，当它通过提交函数中的“返回 true”行时，没有任何反应。如果我再次触发提交事件，表单将实际提交。

我认为问题与“event.preventDefault()”有关，但没有它，模式对话框会消失，并且在确认之前提交表单。

我也尝试`$form.submit()`从`valuesCheck`处理程序中再次调用该方法，但无济于事。

如何使模式对话框中的“确认值并提交提案”按钮在单击时实际提交表单？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-01T19:16:44.057

看看[这个 jsfiddle](http://jsfiddle.net/g9aWz/)。我将功能提炼为最基本的功能，因此您需要将其重新应用到您的真实代码中，但它确实有效。

对于后代，这是代码：

```
# HTML

<form id="proposal" action="http://google.com" method="get" target="_blank">
    <input name="q">
    <button type="submit">Search</button>
</form>
<div id="proposal-form-errors"></div>​

# jQuery

valuesCheck = function(event) {
    $("#proposal-form-errors")
        .dialog({
            modal: true,
            width: 600,
            title: 'Values Confirmation',
            buttons: {
                "Confirm values and submit proposal": function () {
                    $form = $('form#proposal');
                    $form.addClass('values-confirmed');
                    $(this).dialog("destroy");
                    $form.submit();
                },
                "Continue editing": function () {
                    $(this).dialog("destroy");
                }
            }
        })
        .html('<p>Please confirm the selected values.</p>');
}

$("form#proposal").submit(function(event) {
    if (!$(this).hasClass('values-confirmed')) {
        event.preventDefault();
        valuesCheck();
    }
});​ 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-01T19:15:33.890

```
if (val1 && val2 && !$j(this).hasClass('values-confirmed')) {
        valuesCheck(event);
    } else {
        return true; // processing stops here after the first click.
    } 
```

`val1`当任何or为空时，此块将提交表单`val2`，我认为这不是预期的。

这是您的代码的略微修改版本，它似乎可以工作

```
$j = jQuery;
var valuesCheck = function(event) {
    $j("#proposal-form-errors")
        .dialog({
            modal: true,
            width: 600,
            title: 'Values Confirmation',
            buttons: {
                "Confirm values and submit proposal": function () {
                    $form = $j('form#proposal');
                    $form.addClass('values-confirmed');
                    $j(this).dialog("destroy");
                    $form.trigger('submit',['pass']);
                },
                "Continue editing": function () {
                    $j(this).dialog("destroy");
                }
            }
        }).html('<p>Please confirm the selected values.</p>');
    event.preventDefault();
}

$j("form#proposal").submit(function(event,pass) {
    if(pass)
       return true;
    var val1 = $j("#val1 option:selected").text();
    var val2 = $j("#val2").val();

    if (val1 && val2) {
        valuesCheck(event);
    } else{
      alert('Please fill all values');
      event.preventDefault();  
    }
});​ 
```

检查小提琴，单击该按钮后，表单将提交并且页面将刷新。

[工作小提琴](http://jsfiddle.net/joycse06/MxVez/2/)

我在触发时使用[$.trigger](http://api.jquery.com/trigger/)`submit`传递自定义数据。

# java - 如何使用 jersey 和 java 在客户端和 webservice rest 之间传输对象

> ID：10855724
> 
> 赞同：1
> 
> 时间：2012-06-01T18:45:24.077
> 
> 标签：java, jersey, jax-rs

我是 JAX-WS 的新手，我创建了一个测试样本，例如：

服务器：

```
@Path("/login")
public class Login {
   public Login(){
      initDB();
   }
    @GET
    @Path("{username}/{password}")  
    @Produces(MediaType.TEXT_PLAIN)
    public String login(@PathParam("username") String username,@PathParam("password") String password) {
     int id = db.login(username, password);
     return ""+id;
    }
} 
```

客户：

```
public class WSConnection {

    private ClientConfig config;
    private Client client;
    private WebResource service;
    public WSConnection(){
        config = new DefaultClientConfig();
        client = Client.create(config);
        service = client.resource(getBaseURI());
    }
    public int login(String username,String password){
        return Integer.parseInt(service.path("rest").path("login").path(username).path(password).accept(
                MediaType.TEXT_PLAIN).get(String.class));
    }
    private URI getBaseURI() {
        return UriBuilder.fromUri(
                "http://localhost:8080/Project2").build();
    }
} 
```

在服务器中，在方法登录时，我返回从用户名和密码中选择的用户的 ID。如果我想返回对象：

```
public class Utente {

    private int id;
    private String username;
    private String nome;
    private String cognome;

    public Utente(int id, String username, String nome, String cognome) {
        this.id = id;
        this.username = username;
        this.nome = nome;
        this.cognome = cognome;
    }
    public int getId() {
        return id;
    }
    public void setId(int id) {
        this.id = id;
    }
    public String getUsername() {
        return username;
    }
    public void setUsername(String username) {
        this.username = username;
    }
    public String getNome() {
        return nome;
    }
    public void setNome(String nome) {
        this.nome = nome;
    }
    public String getCognome() {
        return cognome;
    }
    public void setCognome(String cognome) {
        this.cognome = cognome;
    }   
} 
```

我必须做什么？有人可以解释一下吗？谢谢你！！！:)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-08T12:15:16.303

使用@XmlRootElement 注释您的对象并将资源上的@Produces(MediaType.TEXT_PLAIN) 更改为@Produces(MediaType.APPLICATION_XML)。从资源方法中返回该对象 - 它将作为 XML 自动发送到客户端。在客户端，您可以执行以下操作：

```
Utente u = service.path("rest").path("login").path(username).path(password)
           .accept(MediaType.APPLICATION_XML).get(Utente.class); 
```

顺便说一句，将登录操作映射到 HTTP GET 是一个坏主意 - 您应该改用 POST。

# vb.net - 如何从 Soap Web Response 获取元素数据？VB.NET

> ID：10855732
> 
> 赞同：1
> 
> 时间：2012-06-01T18:46:10.497
> 
> 标签：vb.net, soap, xml-parsing

我正在尝试从 Web 服务获取数据，只返回一个结果，即库存中给定商品的数量。

我已成功获得结果，但需要从中删除所有 XML 代码以简单地返回数字，返回的 XML 如下所示：

```
<?xml version="1.0" encoding="utf-8"?>
<soap:Envelope xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/">
  <soap:Body>
    <stockenquiryResponse xmlns="https://webservices.electrovision.co.uk">
      <stockenquiryResult>**THE NUMBER I NEED**</stockenquiryResult>
    </stockenquiryResponse>
  </soap:Body>
</soap:Envelope> 
```

我敢肯定这已经被问过很多次了，但是我找不到一个简单的解决方案来从`stockenquiryresult`标签中获取值。

[从 vbnet 中的 XML 获取值](https://stackoverflow.com/questions/5619895/get-value-from-xml-in-vbnet)

似乎是正确的答案，但我无法让它工作。

如果有帮助，我将使用以下示例获取数据：

[http://msdn.microsoft.com/en-us/library/debx8sh9(v=vs.80).aspx](http://msdn.microsoft.com/en-us/library/debx8sh9(v=vs.80).aspx)

只需进行一些调整即可正确获取数据，最值得注意的是将内容类型更改`application/soap+xml`为 XML 并将数据作为 XML 传递。

我正在使用带有 ASP.NET 2.0 的 VB。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-01T19:50:00.757

有一些内置的 .NET 类可用于读取 XML。

**使用 XmlDocument**

XmlDocument 在 DOM（文档对象模型）中公开您从 Web 服务检索到的 XML 字符串。[您可以在MSDN](http://msdn.microsoft.com/en-us/library/system.xml.xmldocument.aspx)上阅读有关 XmlDocument 的信息。

```
Dim XMLDoc as new XMLDocument

XMLDoc.LoadXML(XMLString)

Dim Result as string = XMLDoc.LastChild.InnerText

'Alternatively, you can use SelectSingleNode.
'You will need to determine the correct XPath expression.
'Dim Result as string = XMLDoc.SelectSingleNode("XPathToNode").InnerText 
```

如果您选择使用 SelectSingleNode，那么[MSDN 上的 XPath 文档](http://msdn.microsoft.com/en-us/library/d271ytdx.aspx)将会派上用场。

**使用 XmlReader**

对于像阅读一个标签一样快的事情，您还可以使用 XmlReader（[MSDN 文档）](http://msdn.microsoft.com/en-us/library/system.xml.xmlreader.aspx)。与 XmlDocument 不同，XmlReader 不会将 XML 公开为 DOM。XmlReader 是仅向前的阅读器，但应该比 XmlDocument 更快、更轻量级。这适用于您的情况。

```
Dim XSettings as new XmlReaderSettings
'You can use XSettings to set specific settings on the XmlReader below.
'See linked docs.

Using SReader as New StringReader(XMLString)

    Dim X as XmlReader = XmlReader.Create(SReader, XSettings)
    X.ReadToDescendant("stockenquiryResult")
    Dim Result as string = X.ReadElementContentAsString

End Using 
```

# bash - grep 在 bash 中获取匹配文本的文件名和行号

> ID：10855734
> 
> 赞同：4
> 
> 时间：2012-06-01T18:46:12.803
> 
> 标签：bash, grep

我想`grep`在搜索 term 的文件夹上做一个 in bash `foobar`。然后，我想输出所有匹配项以及找到匹配项的**文件名**和**行号**。这可能吗？

我需要输出看起来像：

```
{{filename}}:{{line_number}} - {{matched_text}} 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-06-01T19:44:19.840

```
grep -nrH 'regex' /dir/ 
```

`-H`是添加文件名、`-n`添加行号、`-r`递归的选项

即使没有文件，我也会得到文件名，`-H`除非只有一个文件。

添加`-i`不区分大小写

添加`-E`扩展正则表达式

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-01T18:48:30.593

使用 -n 或 --line-number 选项

```
grep -n foobar 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-01T18:48:05.900

是的; 尝试： `grep -nr "expression" /path/to/files/`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-02T02:27:14.690

`awk`基于解决方案：

```
awk '/REGEX/{print FILENAME":"FNR" - "$0}' PATH 
```

对于递归路径搜索，

```
find PATH-TO-START -type f -exec awk '/REGEX/{print FILENAME":"FNR" - "$0}' {} \; 
```

# sql - 写入控制文件以将 csv 文件插入 Oracle 数据库

> ID：10855746
> 
> 赞同：0
> 
> 时间：2012-06-01T18:47:19.823
> 
> 标签：sql, csv, oracle11g, sql-loader

我有一些我的 csv 文件来显示它的格式。我只是想在继续之前确保我的数据能够正确上传到我的 Oracle 数据库中。我目前正在使用 sqlloader 来执行此操作。

```
"SERV TAP ID", "ACCT NUMBER", "MTR ID" , "SERV HOUSE","SERV STREET", "SERV TOWN", "BIL NAME","MTR DATE SET3","BIL PHONE","MTR SIZE","BILL CYCLE","MTR REMOTE ID"

"111111" , "222222222" , "33333333", "444", "Mark AVE", "Monroe", "Dos Equis", "07092008", "" , "0058" , "21", "1480040662" 
```

这就是我的控制文件的样子。关于我做错了什么的任何想法？

```
load data
infile GIS.csv
into table Billing
fields terminated by ","
(TAP_ID, ACCT_NUM, MTR_ID, SERV_HOUSE, SERV_STREET, SERV_TOWN, BIL_NAME, MTR_DATE_SET, BIL_PHONE, MTR_SIZE, BILL_CYCLE, MTR_RMT_ID) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-04T17:18:32.597

在我看来是对的。我建议添加：

```
OPTIONALLY ENCLOSED BY '"' 
```

跳过值周围的引号和

```
OPTIONS(SKIP=1) 
```

跳过标题行。

# jquery - 使用悬停事件克隆元素？

> ID：10855750
> 
> 赞同：2
> 
> 时间：2012-06-01T18:47:38.847
> 
> 标签：jquery

***HTML：***

```
<div id='task-header'>
</div>
<div id='tasks'>
    <a href="#" id ="add">Add</a>
  <ul>
    <li class ="editable">
      <form class='task'>
        <input class='textfield' type='text' />
      </form>
        <a href="#" class="delete">Delete this row</a>
    </li>
  </ul>
</div>
<div id='task-footer'></div> 
```

***jQuery：***

```
var item = $("#tasks ul li:eq(0)").clone(true); // need to clone for new add
$('#add').click(function() {
    var taskItem = item.clone(true);
    $('#tasks ul').append(taskItem);
    taskItem.find(':input:text').val("");
    return false;
});

$('body').on('click', '.delete', function() {
    $(this).parent('li').remove();
    return false;
});

$(".editable").hover(function() {
    $(this).addClass("editHover");
}, function() {
    $(this).removeClass("editHover");
});​ 
```

*JSFiddle：http:* [//jsfiddle.net/t67yJ/](http://jsfiddle.net/t67yJ/)

我设置了我的`clone(true)`参数，但我仍然无法让我的 cloned`<li>`具有悬停效果。我应该怎么办？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-01T18:54:47.647

只需将克隆调用移动到处理程序下方，如下所示，

```
$(".editable").hover(function() {
    $(this).addClass("editHover");
}, function() {
    $(this).removeClass("editHover");
});

var item = $("#tasks ul li:eq(0)").clone(true); // need to clone for new add 
```

[**演示**](http://jsfiddle.net/t67yJ/6/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-01T18:49:36.873

### 解决方案1：

```
$(".editable").hover(function() {
    $(this).addClass("editHover");
}, function() {
    $(this).removeClass("editHover");
});
var item = $("#tasks ul li:eq(0)").clone(true); // just change the place 
                                                // of first clone statement
$('#add').click(function() {
    var taskItem = item.clone(true);
    $('#tasks ul').append(taskItem);
    taskItem.find(':input:text').val("");
    return false;
});
$('body').on('click', '.delete', function() {
    $(this).parent('li').remove();
    return false;
}); 
```

**[演示](http://jsfiddle.net/thecodeparadox/Yxpxd/1/)**

### 解决方案 2：（使用事件委托）

```
var item = $("#tasks ul li:eq(0)"); // remove clone(true) from here
$('#add').click(function() {
    var taskItem = item.clone(true);
    $('#tasks ul').append(taskItem);
    taskItem.find(':input:text').val("");
    return false;
});
$('body').on('click', '.delete', function() {
    $(this).parent('li').remove();
    return false;
});
// use event delegation
$("#tasks").on('hover', '.editable', function(e) {
    if (e.type == 'mouseenter') $(this).addClass("editHover");
    else $(this).removeClass("editHover");
}); 
```

**[演示（带事件委托）](http://jsfiddle.net/thecodeparadox/MHFVd/)**

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-01T18:50:52.427

为了不克隆元素两次，您可以`clone`在第一行中删除一个额外的元素并在委托事件方法中附加处理程序：

```
var item = $("#tasks ul li:eq(0)");

$("body").on("hover", ".editable", function() {
    $(this).toggleClass("editHover");
}).on("click", "#add", function() {
    var taskItem = item.clone(true).removeClass("editHover");
    $("#tasks ul").append(taskItem);
    taskItem.find(":input:text").val("");
    return false;
}).on("click", ".delete", function() {
    $(this).parent("li").remove();
    return false;
});​ 
```

**演示：http:** [//jsfiddle.net/t67yJ/7/](http://jsfiddle.net/t67yJ/7/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-01T18:50:45.790

克隆元素时尚未定义事件侦听器。将 var 移动`item = $("#tasks ul li:eq(0)").clone(true);`到脚本的末尾。

**[小提琴](http://jsfiddle.net/ult_combo/t67yJ/1/)**

或者使用`.on`/`.live`事件委托，您不必克隆侦听器，正如 coder 所说。

# mysql - 带有两个 AND 条件的 SELECT

> ID：10855751
> 
> 赞同：-2
> 
> 时间：2012-06-01T18:47:39.713
> 
> 标签：mysql

我想在 MySQL 中使用具有两个条件的`SELECT`语句。`AND`这是我的表和插入，然后是 select 语句。我没有从 select 语句中得到任何结果。

```
-- 
-- Table structure for table `indextable`
-- 

CREATE TABLE `indextable` (
  `post_id` bigint(40) NOT NULL,
  `key` varchar(20) NOT NULL,
  `value` varchar(20) NOT NULL,
  `cat_id` int(11) NOT NULL,
  KEY `key_2` (`key`),
  KEY `value_2` (`value`)
) ENGINE=MyISAM DEFAULT CHARSET=utf8;

-- 
-- Dumping data for table `indextable`
-- 

INSERT INTO `indextable` VALUES (390, 'doors', '360', 398);
INSERT INTO `indextable` VALUES (390, 'body_type', '347', 398);
INSERT INTO `indextable` VALUES (390, 'seller_type', '11', 398);
INSERT INTO `indextable` VALUES (390, 'mechanical_condition', '6', 398);
INSERT INTO `indextable` VALUES (390, 'body_condition', '1', 398);
INSERT INTO `indextable` VALUES (390, 'kilometers', '', 398);
INSERT INTO `indextable` VALUES (390, 'year', '2012', 398);
INSERT INTO `indextable` VALUES (390, 'mobile', '', 398);
INSERT INTO `indextable` VALUES (390, 'price', '111111111111', 398);
INSERT INTO `indextable` VALUES (388, 'city', 'localhost', 398);
INSERT INTO `indextable` VALUES (388, 'description', '<!--:en-->dddddddddd', 398);
INSERT INTO `indextable` VALUES (388, 'title', '<!--:en-->555       ', 398);
INSERT INTO `indextable` VALUES (388, 'categories_name', 'Cars souq', 398);
INSERT INTO `indextable` VALUES (388, 'images', 'http://localhost/wor', 398);
INSERT INTO `indextable` VALUES (388, 'fuel_type', '380', 398);
INSERT INTO `indextable` VALUES (388, 'warranty', '725', 398);
INSERT INTO `indextable` VALUES (388, 'horsepower', '387', 398);
INSERT INTO `indextable` VALUES (388, 'transmission_type', '377', 398);
INSERT INTO `indextable` VALUES (388, 'color', '707', 398);
INSERT INTO `indextable` VALUES (388, 'no_of_cylinders', '365', 398);
INSERT INTO `indextable` VALUES (388, 'doors', '360', 398);
INSERT INTO `indextable` VALUES (388, 'body_type', '347', 398);
INSERT INTO `indextable` VALUES (388, 'seller_type', '11', 398);
INSERT INTO `indextable` VALUES (388, 'mechanical_condition', '6', 398);
INSERT INTO `indextable` VALUES (388, 'body_condition', '1', 398);
INSERT INTO `indextable` VALUES (388, 'kilometers', '', 398);
INSERT INTO `indextable` VALUES (388, 'year', '2012', 398);
INSERT INTO `indextable` VALUES (388, 'mobile', '', 398);
INSERT INTO `indextable` VALUES (388, 'price', '3333', 398);
INSERT INTO `indextable` VALUES (390, 'no_of_cylinders', '365', 398);
INSERT INTO `indextable` VALUES (390, 'color', '707', 398);
INSERT INTO `indextable` VALUES (390, 'transmission_type', '377', 398);
INSERT INTO `indextable` VALUES (390, 'horsepower', '387', 398);
INSERT INTO `indextable` VALUES (390, 'warranty', '725', 398);
INSERT INTO `indextable` VALUES (390, 'fuel_type', '380', 398);
INSERT INTO `indextable` VALUES (390, 'images', '', 398);
INSERT INTO `indextable` VALUES (390, 'categories_name', 'Cars souq', 398);
INSERT INTO `indextable` VALUES (390, 'title', '<!--:en-->ddddddddd<', 398);
INSERT INTO `indextable` VALUES (390, 'description', '<!--:en-->dddddddddd', 398);
INSERT INTO `indextable` VALUES (390, 'city', 'localhost', 398);
INSERT INTO `indextable` VALUES (392, 'price', '133', 398);
INSERT INTO `indextable` VALUES (392, 'mobile', '', 398);
INSERT INTO `indextable` VALUES (392, 'year', '2012', 398);
INSERT INTO `indextable` VALUES (392, 'kilometers', '222', 398);
INSERT INTO `indextable` VALUES (392, 'body_condition', '1', 398);
INSERT INTO `indextable` VALUES (392, 'mechanical_condition', '6', 398);
INSERT INTO `indextable` VALUES (392, 'seller_type', '11', 398);
INSERT INTO `indextable` VALUES (392, 'body_type', '347', 398);
INSERT INTO `indextable` VALUES (392, 'doors', '360', 398);
INSERT INTO `indextable` VALUES (392, 'no_of_cylinders', '365', 398);
INSERT INTO `indextable` VALUES (392, 'color', '707', 398);
INSERT INTO `indextable` VALUES (392, 'transmission_type', '377', 398);
INSERT INTO `indextable` VALUES (392, 'horsepower', '387', 398);
INSERT INTO `indextable` VALUES (392, 'warranty', '725', 398);
INSERT INTO `indextable` VALUES (392, 'fuel_type', '380', 398);
INSERT INTO `indextable` VALUES (392, 'images', '', 398);
INSERT INTO `indextable` VALUES (392, 'categories_name', 'Cars souq', 398);
INSERT INTO `indextable` VALUES (392, 'title', '<!--:en-->ddddddddd<', 398);
INSERT INTO `indextable` VALUES (392, 'description', '<!--:en-->dddddddddd', 398);
INSERT INTO `indextable` VALUES (392, 'city', 'localhost', 398);
INSERT INTO `indextable` VALUES (393, 'price', '111111111111', 398);
INSERT INTO `indextable` VALUES (393, 'mobile', '', 398);
INSERT INTO `indextable` VALUES (393, 'year', '2012', 398);
INSERT INTO `indextable` VALUES (393, 'kilometers', '', 398);
INSERT INTO `indextable` VALUES (393, 'body_condition', '1', 398);
INSERT INTO `indextable` VALUES (393, 'mechanical_condition', '6', 398);
INSERT INTO `indextable` VALUES (393, 'seller_type', '11', 398);
INSERT INTO `indextable` VALUES (393, 'body_type', '347', 398);
INSERT INTO `indextable` VALUES (393, 'doors', '360', 398);
INSERT INTO `indextable` VALUES (393, 'no_of_cylinders', '365', 398);
INSERT INTO `indextable` VALUES (393, 'color', '707', 398);
INSERT INTO `indextable` VALUES (393, 'transmission_type', '377', 398);
INSERT INTO `indextable` VALUES (393, 'horsepower', '387', 398);
INSERT INTO `indextable` VALUES (393, 'warranty', '725', 398);
INSERT INTO `indextable` VALUES (393, 'fuel_type', '380', 398);
INSERT INTO `indextable` VALUES (393, 'images', '', 398);
INSERT INTO `indextable` VALUES (393, 'categories_name', 'Cars souq', 398);
INSERT INTO `indextable` VALUES (393, 'title', '<!--:en-->ddddddddd<', 398);
INSERT INTO `indextable` VALUES (393, 'description', '<!--:en-->dddddddddd', 398);
INSERT INTO `indextable` VALUES (393, 'city', 'localhost', 398);
INSERT INTO `indextable` VALUES (398, 'price', '11333', 398);
INSERT INTO `indextable` VALUES (398, 'mobile', '', 398);
INSERT INTO `indextable` VALUES (398, 'year', '2012', 398);
INSERT INTO `indextable` VALUES (398, 'kilometers', '', 398);
INSERT INTO `indextable` VALUES (398, 'body_condition', '1', 398);
INSERT INTO `indextable` VALUES (398, 'mechanical_condition', '6', 398);
INSERT INTO `indextable` VALUES (398, 'seller_type', '11', 398);
INSERT INTO `indextable` VALUES (398, 'body_type', '347', 398);
INSERT INTO `indextable` VALUES (398, 'doors', '360', 398);
INSERT INTO `indextable` VALUES (398, 'no_of_cylinders', '365', 398);
INSERT INTO `indextable` VALUES (398, 'color', '707', 398);
INSERT INTO `indextable` VALUES (398, 'transmission_type', '377', 398);
INSERT INTO `indextable` VALUES (398, 'horsepower', '387', 398);
INSERT INTO `indextable` VALUES (398, 'warranty', '725', 398);
INSERT INTO `indextable` VALUES (398, 'fuel_type', '380', 398);
INSERT INTO `indextable` VALUES (398, 'images', 'http://localhost/wor', 398);
INSERT INTO `indextable` VALUES (398, 'categories_name', 'Cars souq', 398);
INSERT INTO `indextable` VALUES (398, 'title', '<!--:en-->aaaaaaaaaa', 398);
INSERT INTO `indextable` VALUES (398, 'description', '<!--:en-->aaaaaaaaaa', 398);
INSERT INTO `indextable` VALUES (398, 'city', 'localhost', 398);

SELECT distinct post_id FROM indextable as i WHERE ( i.key ='price' AND i.value BETWEEN 12 AND 1000 ) AND ( i.key ='year' AND i.value=2012 ) 
```

注意：当我只使用第一个条件或只使用第二个条件时，我会得到一个结果。

我想执行这样的查询：

```
SELECT distinct post_id 
FROM indextable as i 
WHERE ( i.key ='price' AND i.value BETWEEN 12 AND 1000 )
    AND ( i.key ='year' AND i.value=2012 )
    AND ( i.key ='body_condition' AND i.value=1 )
    AND ( i.key ='mechanical_condition' AND i.value=6 )
    AND ( i.key ='seller_type' AND i.value=11 )
    AND ( i.key ='body_type' AND i.value=347 )
    AND ( i.key ='doors' AND i.value=360 )
    AND ( i.key ='no_of_cylinders' AND i.value=365 )
    AND ( i.key ='color' AND i.value=707 )
    AND ( i.key ='transmission_type' AND i.value=377 )
    AND ( i.key ='horsepower' AND i.value=387 )
    AND ( i.key ='warranty' AND i.value=725 )
    AND ( i.key ='fuel_type' AND i.value=380 ) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T18:51:08.580

那是因为你的条件不对。

```
 SELECT distinct post_id FROM indextable as i 
WHERE ( i.key ='price' AND i.value BETWEEN 12 AND 1000 ) 
AND ( i.key ='year' AND i.value=2012 ) 
```

这和使用是一样的

```
 SELECT distinct post_id FROM indextable as i 
WHERE  i.key ='price' AND i.value BETWEEN 12 AND 1000 
AND  i.key ='year' AND i.value=2012 
```

我认为您尝试做的是

```
 SELECT distinct post_id FROM indextable as i 
WHERE ( i.key ='price' AND i.value BETWEEN 12 AND 1000 ) 
OR ( i.key ='year' AND i.value=2012 ) 
```

编辑：你的意思是你没有这个结果？我复制了您的表格并进行了查询，并且可以正常工作。

![在此处输入图像描述](../Images/aba905c5036e8e132a27e042ea257c70.png)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-01T18:51:05.207

```
 .... WHERE ( i.key ='price' AND i.value BETWEEN 12 AND 1000 ) AND 
            ( i.key ='year' AND i.value=2012 ) 
```

意味着 i.key 的值必须是 'price' 和 'year' 在同一行。这是不可能的，所以没有结果！

改成

```
 .... WHERE ( i.key ='price' AND i.value BETWEEN 12 AND 1000 ) OR 
            ( i.key ='year' AND i.value=2012 ) 
```

# javascript - 在事件之间传递变量

> ID：10855753
> 
> 赞同：-1
> 
> 时间：2012-06-01T18:47:50.887
> 
> 标签：javascript, jquery

我有一个编辑按钮，单击该按钮会触发下面的第一个事件。它（编辑表单）还有一个取消链接，单击该链接会触发下面的第二个事件。如何确保`PrevContent`在取消事件中可以访问该值？用户可以一次点击任意数量的相应编辑链接。

```
$('.js-profile-edit').live('click',function(){

    var TrBlock     = $(this).closest('tr');
    var PrevContent = TrBlock.html();
    var colspan     = TrBlock.parent().prev().find('a:first').first().data('span');

    $.ajax({
        url     : $(this).attr('href'),
        type    : 'GET',
        success : function(response){
            TrBlock.html('<td colspan="'+colspan+'">'+response+'</td>');
        },
        error    : function(jqXHR, textStatus, errorThrown){
            uiAlert({message : 'Something Broke. Try again later'})
        }
    });
    return false;
});

$('.js-profile-edit-cancel').live('click',function(){
    $(this).closest('tr').html(PrevContent);
    return false;
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T19:08:18.977

也许您可以将其填充`PrevContent`到取消按钮的[数据对象中。](http://api.jquery.com/data/)

`js-profile-edit`在点击处理程序中写入：

```
$('.js-profile-edit-cancel').data('PrevContent', PrevContent); 
```

并读入`js-profile-edit-cancel`点击处理程序：

```
var PrevContent = $(this).data('PrevContent'); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-01T19:08:55.820

您应该能够将`prevContent`as存储`.data()`在最近的位置`<tr>`：

```
$('.js-profile-edit').live('click',function(){

    var TrBlock     = $(this).closest('tr');
    var PrevContent = TrBlock.html();
    TrBlock.data({contents: PrevContent});  // save it
    ...
})

$('.js-profile-edit-cancel').live('click',function() {
    var TrBlock = $(this).closest('tr');
    TrBlock.html(TrBlock.data('contents'));
    return false;
}); 
```

# cygwin - 使用 Cygwin 时的“挂载”

> ID：10855758
> 
> 赞同：5
> 
> 时间：2012-06-01T18:48:11.060
> 
> 标签：cygwin, mount

我正在尝试使用 mount 命令将工作中的计算机上的目录挂载到我的 Windows 机器上。

在 cygwin 中，我尝试了几种变体：

```
mount machineName:/remote/location/blah /local/location
mount -t nfs machineName:/remote/location/blah /local/location
mount nfs machineName:/remote/location/blah /local/location
mount machineNAme:/remote/location/blah 
```

并且我已经尝试过切换参数等。等等......我要么收到此消息：`mount: can't find brotula in /etc/fstab or in /etc/fstab.d/$USER`要么`invalid arguments`。我知道我的路径是正确的，因为我使用 scp 很好。

我究竟做错了什么？谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-01T18:54:50.167

您是否`$ mount //machinename/remote/location/blah /local/location`按照中的示例进行了尝试`man mount`？

# javascript - javascript foo.call(object) 与 object.foo()

> ID：10855759
> 
> 赞同：4
> 
> 时间：2012-06-01T18:48:12.337
> 
> 标签：javascript, jquery

我正在查看[jQuery 源代码](https://github.com/jquery/jquery/blob/master/src/core.js)，然后我看到他们使用`foo.call(context)`而不是`context.foo()`.
例如 - 假设`this`他们使用的是数组：

```
return slice.call( this ); 
```

代替：

```
return this.slice(); 
```

有什么区别？它是执行这些调用的首选方式（就性能而言）？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-01T18:51:27.840

问题是“foo”实际上可能不是“上下文”的属性。在这种情况下，唯一真正的选择是使用`.call()`（或`.apply()`，视情况而定）。

如果您确实有一个具有“foo”属性的对象是一个函数，那么没有真正的理由使用`.call()`.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-01T19:16:02.747

除了@Pointy的回答，直接调用成员函数似乎比Class.prototype.foo快很多：

[http://jsperf.com/javascript-foo-call-object-vs-object-foo](http://jsperf.com/javascript-foo-call-object-vs-object-foo)

# lambda - lambda 表达式是如何得名的？

> ID：10855762
> 
> 赞同：55
> 
> 时间：2012-06-01T18:48:26.440
> 
> 标签：lambda

我可能在这里显示我的无知，但是为什么 lambda 表达式称为 lambda 表达式。我了解如何使用它们，但我很好奇“lambda”一词是否有任何意义。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-06-01T18:51:28.030

该术语仅源自数学关键字。

Wiki 信息：[Lambda 演算](http://en.wikipedia.org/wiki/Lambda_calculus)

检查这个：[http ://dictionary.reference.com/browse/lambda+expression](http://dictionary.reference.com/browse/lambda+expression)

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-06-01T18:52:56.593

因为它们来自 Church 的[lambda 演算](http://en.wikipedia.org/wiki/Lambda_calculus)。

# c# - 左侧DataGridView显示一列，数据来自右侧DataGridView

> ID：10855766
> 
> 赞同：1
> 
> 时间：2012-06-01T18:48:58.037
> 
> 标签：c#, winforms, datagridview

我有两个 DataGirdViews。我想从右侧 DataGridView 中选择行并将它们传递给左侧。 ![数据网格视图](../Images/06405f6e00d05bbf0d39ef8ecb1a43ba.png)

右边有 4 列。在左侧网格中，我只定义了一个新列，我只想显示这一列。此列是右侧的列之一，例如 column[2]。我被困在这里，不知道如何通过行？

我不完整的代码（可能是错误，未经测试）：

```
 private void btnAdd_Click(object sender, EventArgs e)
    {
        try
        {
            if (dgRight.CurrentRow != null)
            {
                DataRowView currentDataRowView = (DataRowView)dgRight.CurrentRow.DataBoundItem;
                foreach (DataGridViewRow row in dgRight.Rows)
                {
                    DataGridViewCheckBoxCell check = row.Cells[0] as DataGridViewCheckBoxCell;
                    if (check.Value != null)
                    {
                        if ((bool)check.Value)
                        {
                            //this row has a checkBox set to true (tick is added)
                            //add this row to dataTable ...
                            DataRow myRow = (row.DataBoundItem as DataRowView).Row;
                            DataRow dr = dt.NewRow();

                            if (!dt.Columns.Contains("ID"))
                            {
                                datatableRight.Columns.Add("ID", typeof(int));
                                datatableRight.Columns.Add("col1", typeof(string));
                                datatableRight.Columns.Add("col2", typeof(string));
                                datatableRight.Columns.Add("col3", typeof(string));
                                DataColumn[] keyColumns = new DataColumn[1];
                                keyColumns[0] = datatableRight.Columns["ID"];
                                datatableRight.PrimaryKey = keyColumns;
                            }

                            dr["ID"] = myRow["ID"];
                            dr["col1"] = myRow["col1"];
                            dr["col2"] = myRow["col2"];
                            dr["col3"] = myRow["col3"];

                            if (!datatableRight.Rows.Contains(dr[0]))
                            {
                                datatableRight.Rows.Add(dr);
                            }
                        }
                    }

                }
                dgLeft.DataSource = datatableRight;
                datLeft = datatableRight.Copy();

            }
        }
        catch (Exception ex)
        {
            MessageBox.Show(ex.Message);
        }
    } 
```

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T19:26:27.123

简单地使用两个具有相同架构的数据表来绑定这些网格，然后移动数据表中的行。

检查这个[示例项目](http://www.zumodrive.com/share/ge0nZmRkMz)。 [http://www.zumodrive.com/share/ge0nZmRkMz](http://www.zumodrive.com/share/ge0nZmRkMz)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-01T20:58:58.473

一种快速展示使用数据复制列的概念的方法 -

```
dataGridView2.AutoGenerateColumns = false;
///... assuming that datagridview2 is already created with proper columns

dataGridView1.AutoGenerateColumns = false;
dataGridView1.DataSource = dataGridView2.DataSource;

    private void btnAdd_Click(object sender, EventArgs e)
            {

                for (int j = 0; j < this.dataGridView2.Columns.Count; j++)
                {
                    if (dataGridView2.Columns[j].Name == "Description")
                    {
                        this.dataGridView1.Columns.Add(this.dataGridView2.Columns[j].Clone() as DataGridViewColumn);
                    }
                }
            } 
```

# mysql - mysql触发器进入无限循环

> ID：10855767
> 
> 赞同：3
> 
> 时间：2012-06-01T18:48:58.270
> 
> 标签：mysql, triggers

我的用户表上有以下触发器，它将值从名称字段复制到电子邮件字段。

```
CREATE TRIGGER copy_name_on_insert BEFORE INSERT ON users
FOR EACH ROW
  SET NEW.email = NEW.name;

CREATE TRIGGER copy_name_on_update BEFORE UPDATE ON users
FOR EACH ROW
  SET NEW.email = NEW.name; 
```

此触发器在本地环境中工作正常，但在生产中它进入无限循环。有人对这种行为有任何想法吗？

本地和生产环境正在运行 mysql 5.5。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-01T19:09:39.307

从我们的 DBA 那里得到了这个答案。

因此，这不是递归错误（尽管错误消息非常糟糕，而且看起来很像）。相反，这是一个内存复杂性问题。

基本上，每条语句必须在有限的内存空间（本例中为 128K）中运行。虽然大多数语句的空间远小于此空间，但此触发器似乎具有更大的内存需求。

这在测试中起作用的原因是尝试的测试不够大。（并且测试服务器可能分配了更多内存）

例如，这在测试中起作用：

```
UPDATE users SET name="j@mail.com" WHERE id=1234; 
```

但真正在生产中运行的是：

```
update users set full_name='Jason H', attr1='abc1', attr2='abc', attr3='adad' .... where id=1917; 
```

基本上，java/hibernate 系统正在更新每个字段......出于某种原因。这很愚蠢，hibernate 可能应该做的更少。

实际查询的相当大的复杂性使其超过了生产中的内存限制。

# javascript - 根据 LI click 更改 DIV 的背景图像

> ID：10855768
> 
> 赞同：0
> 
> 时间：2012-06-01T18:49:02.223
> 
> 标签：javascript, jquery, html, css

我正在创建一个网站来展示应用程序，并希望允许用户单击 iPhone 模型来查看应用程序的各种功能。

我有一个 iPhone 覆盖，作为背景图像 (.iphone) 和屏幕抓取，也作为背景图像 (.screen) 在页面上，但希望用户能够决定显示什么屏幕抓取通过单击特定按钮。

我自己不熟悉 JQuery，但有人告诉我这可能是解决这个问题的方法。我将如何实现这一目标？我的代码是...

```
<div class="iphone"></div>
<div class="screen"></div>

<ul>
<li class="screenshots">Screen 1</li>
<li class="screenshots">Screen 2</li>
</ul> 
```

任何帮助将不胜感激。

编辑：我找到了一个类似的例子。这是...[链接](http://www.potionfactory.com/thehitlist/iphone/)。单击缩略图，它会显示在 iPhone 上。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T18:58:37.050

我可能会设置如下：

```
<div class="fullsize">
  <div class="iphone"></div>
  <div class="screen"></div>
<div>

<ul class="screenshots">
  <li class="iphone" id="scr1">Screen 1</li>
  <li class="screen" id="scr2">Screen 2</li>
</ul>
<script>
$('.screenshots li').click(function() {
  $('.fullsize div').hasClass($(this).attr('class')).css('background-image', 'imgurl'));
});
</script> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-01T18:54:37.217

```
<div class="iphone"></div>
<div class="screen"></div>
<ul>
<li class="screenshots"><a href="#" id="scr1">Screen 1</a></li>
<li class="screenshots"><a href="#" id="scr2">Screen 2</a></li>
</ul>
<script>
$('.screenshots a').click(function(){
    switch($(this).attr('id')){
        case 'src1':
            $('.iphone').css('background-image','url("image1.png")');
        break;
        case 'src2':
            $('.iphone').css('background-image','url("image2.png")');
        break;
    }
});
</script> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-01T18:57:21.383

从语义上讲，您的标记应如下所示：

```
<div class="screenshot" id="iphone"></div>
<div class="screenshot" id="screen"></div>

<ul id="screenshot-nav">
<li><a href="#iphone">Screen 1</a></li>
<li><a href="#screen">Screen 2</a></li>
</ul> 
```

使用实际链接而不是向`li`. 此外，这样做即使没有 javascript，也可以使功能正常工作，因为至少，用户将简单地“跳转”到正确的屏幕截图。

有了这些，下面的 jQuery 应该可以工作了：

```
$('#screenshot-nav a').click(function(){
    $('.screenshot').hide();
    $($(this).attr('href')).show();
}); 
```

但是，由于您是为 iPhone 制作的，因此您可能应该查看 jQuery Mobile，尤其是`touch`事件处理程序，而不是`click`.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-01T18:57:42.817

我建议使用一个 jQuery click 处理程序，它可以为每个设置所需的图像背景：

```
<div class="iphone"></div>
<div class="screen"></div>
<ul>
<li class="screenshots" data-backgroundurl="url1.jpg">Screen 1</li>
<li class="screenshots" data-backgroundurl="url2.jpg">Screen 2</li>
</ul>
<script>
$('.screenshots').click(function(){
    $('.screen').css('background-image', $(this).data("backgroundurl"));
});
</script> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-01T18:55:06.987

```
$('li').click(function(){
   $('div').css("background-image", "image/url/here.ext");
)}; 
```

# iphone - 从我的应用程序中删除位置管理器警报

> ID：10855771
> 
> 赞同：0
> 
> 时间：2012-06-01T18:49:18.453
> 
> 标签：iphone, objective-c, xcode, ios5

我使用 Location Manager API 来找出当前位置的纬度和经度。但是，当我调用更新位置管理器方法时，我从应用程序中收到了一些警报，我附在此消息中。我想删除此警报消息，默认情况下我想为此设置是或（允许）。有没有可能？

谢谢你

![在此处输入图像描述](../Images/e34723acaaa21a27e3507090ab569381.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T18:58:50.707

不可能，这个对话框会在应用启动时显示一次

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-01T18:55:37.003

它不可能做到这一点。这样做是为了保障用户的安全。如果您一直关注 PATH ADDRESSBOOK 问题，则会出现“因为 Path App 在使用他们的地址簿之前没有询问用户”。因此，Apple 在 Core Location 和 Push Notifications 中默认实现了*询问功能*或权限。而且从外观上看，在通讯录中也是如此，您将不得不坚持使用它 - 毕竟，您不想陷入隐私问题。:)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-01T19:00:09.763

您不能，即使可以，您的应用程序也可能不会被 Apple 接受。

# java - 是否总是需要一个单独的“写入器”线程（在套接字读取器/文件写入器客户端中）？

> ID：10855784
> 
> 赞同：2
> 
> 时间：2012-06-01T18:50:23.363
> 
> 标签：java, multithreading, writer

我有一些客户端代码从套接字读取（通过输入流）并在循环中写入文件（通过 BufferedWriter）：

```
dataInStream = new BufferedInputStream(dataSocket.getInputStream());
outputFile = new BufferedWriter(new FileWriter(filename));
byte bytes[] = new byte[64];
Message msg = new Message();
int bytesRead = 0;
while (true) {                
   bytesRead = dataInStream.read(bytes, 0, 64);
   // create a message from the raw data...
   msg.parse(bytes);
   // write it to the file as a String
   outputFile.write(msg.toString());
   outputFile.flush();
} 
```

**（显示一般流程的简化代码 - 我只在需要添加额外的编写器线程时对学习感兴趣）**

在什么时候（数据速率方面）我可能需要将文件写入操作拆分到另一个线程（即“写入器”），在读取器和写入器线程之间使用类似**ConcurrentLinkedQueue**的东西？

我的要求消息速率很低（即 1400 字节消息，最多每秒 10 条消息）

我对吞吐量进行基准测试的测试代码表明它可以轻松处理 150000 字节/秒。由于数据速率（无论结果如何）是恒定的，写入器是否可以阻塞足够长的时间以导致读取器的数据丢失？

还是*始终*拥有读者*和*作者线程只是一种好习惯？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-01T18:56:21.410

> 在什么时候（数据速率方面）我可能需要将文件写入操作拆分到另一个线程（即“写入器”）

当您遇到性能问题或分析器告诉您这是一个好主意时，您应该*只*开始优化您的代码（使其更复杂）。

> 还是始终拥有读者和作者线程只是一种好习惯？

这是一个很好的做法，没有其他信息。但是在您的情况下，您知道数据要求，因此只有在您期望大量吞吐量或者您期望在磁盘端受到 IO 限制时才应该这样做。

> 我的要求消息速率很低（即 1400 字节消息，最多每秒 10 条消息）

这并不是很多数据吞吐量来保证额外的代码复杂性

> 作家可以阻止足够长的时间以导致读者数据丢失吗？

在大多数情况下，本地磁盘 IO 将比网络更快。有可能遇到这种情况，但我认为这不是很常见。内核在套接字上为您提供了大量缓冲，如果您溢出内核缓冲区，TCP/IP 协议将重新传输，这样即使您*阻塞*了很长时间，您也不会丢失数据。

# java - 备用 JUnit textui TestRunner

> ID：10855786
> 
> 赞同：0
> 
> 时间：2012-06-01T18:50:29.713
> 
> 标签：java, groovy, junit

我正在用 Groovy 编写一些系统测试，并利用它的单元测试基础设施。它工作得很好，只是我不喜欢默认的 JUnit 测试运行器，它显示 . 对于套件中的每个测试，等到最后报告有关错误和失败的详细信息。系统测试可能需要很长时间才能运行，因此一旦您知道存在故障或错误，能够在中间中断它们是很有用的，但是只有在您知道哪个测试用例失败以及在套件正在运行。

是否有任何可供我使用的替代 JUnit 测试运行器来提供开箱即用的功能？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-01T22:52:32.783

我不确定您所说的“textui”是什么意思，但[IntelliJ IDEA 11 社区版](http://www.jetbrains.com/idea/download/index.html)有一个集成的 JUnit 测试运行器，它与您描述的 Groovy 完全一样（但据我所知，它只有一个图形用户界面） .

# yii - 在 Yii 中使用 with 和 together

> ID：10855789
> 
> 赞同：0
> 
> 时间：2012-06-01T18:50:46.430
> 
> 标签：yii, paging, relation

我有一个显示客户端数据的分页网格。假设我有一个表`Client`，其中有一个表`name`，其中的每一行都有电话号码，还有一个表，其中有每个客户的地址。所以每个都有很多s 和有很多es。`lastName``address``Phone_Number``Client``Adress``Client``Phone_Number``Adress`

关键是我正在尝试对网格的存储读取设置限制。因此，假设我设置了 limit = 2。网格每页应仅显示 2 行（2 个客户端）。问题是，例如，如果 client1 有两个电话号码，查询将带来两行，使网格只显示一个客户端。我知道`together=>false`查询中的设置将解决这个问题。但是每当我设置`together=>false`.

这是我正在使用的代码....

```
Client::model()->with(
      'clientPhoneNumbers',
      'clientPhoneNumbers'.'PhoneNumber',
      'clientAddresses',
      'clientAddresses'.'Address'
)->findAll(array(condition=>(('Address.s_street_name LIKE :queryString') OR ('PhoneNumber.n_number LIKE :queryString')), params=>$params, order=>$order, limit=>$limit,together=>false)); 
```

如果我这样做，我会收到如下错误：`Column not found: Address.s_street_name`. 但是，如果我设置`together=>true`，它就“很好”。

我通过这样的查询找到了解决这个问题的方法......

```
$with = array(
      'clientPhoneNumbers',
      'clientPhoneNumbers'.'PhoneNumber'=>array(condition=>('PhoneNumber.n_number LIKE :queryString'), params=>array(':queryString'=>$queryString)),
      'clientAddresses',
      'clientAddresses'.'Address'=>array(condition=>('Address.s_street_name LIKE :queryString'), params=>array(':queryString'=>$queryString))
);

Client::model()->findAll(array(with=>$with, order=>$order, limit=>$limit,together=>false)); 
```

问题是，如果我这样做，条件是这样的

```
(('Address.s_street_name LIKE :queryString') AND ('PhoneNumber.n_number LIKE :queryString')) 
```

我需要它是这样的

```
(('Address.s_street_name LIKE :queryString') OR ('PhoneNumber.n_number LIKE :queryString')). 
```

有任何想法吗 ？

请记住，关系和表的名称不是实际名称。使用 Gii 创建的模型和关系

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-01T19:04:31.947

嗯..这就是我会尝试的方式。

```
<?php
$criteria=new CDbCriteria;
$criteria->with = array('clientPhoneNumbers', 'clientAddresses');
$criteria->together = true;
$criteria->addCondition(array('Address.s_street_name LIKE :queryString', 'PhoneNumber.n_number LIKE :queryString'), 'OR');    
$criteria->params = array(':queryString' => $queryString);
$criteria->limit = $limit;
$criteria->order = $order;

$result = Client::model()->findAll($criteria);
?> 
```

另外，我认为[这](http://www.yiiframework.com/doc/api/1.1/CDbCriteria/#c4414)描述了一个与您类似的案例。请注意，他/她正在显式更新[条件](http://www.yiiframework.com/doc/api/1.1/CDbCriteria#condition-detail)参数，但 IMO 使用[addCondition](http://www.yiiframework.com/doc/api/1.1/CDbCriteria#addCondition-detail)方法执行此操作更具可读性。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-01T21:08:13.637

将条件与 join 语句一起使用。

```
public function test()
{
    $criteria=new CDbCriteria;
    $criteria->alias = 'i';
    $criteria->compare('id',$this->id);     
    .........
            .........

    $criteria->join= 'JOIN phoneNUmbers d ON (i.id=d.id)';

    return new CActiveDataProvider($this, array(
        'criteria'=>$criteria,
        'sort'=>array(
            'defaultOrder'=>'clients ASC',
        ),
    ));
} 
```

或者使用 DAO 来准备和执行您自己的查询并以您希望的格式返回数据。

或者您可以使用 CSQLDataProvier。最后 2 个选项使您可以更好地控制 SQL 语句

# javascript - JavaScript/jQuery – 在输入字段的末尾添加一个字符

> ID：10855791
> 
> 赞同：5
> 
> 时间：2012-06-01T18:50:47.107
> 
> 标签：javascript, jquery, input

我正在尝试创建一个输入字段，该字段在键入时自动在键入的文本末尾放置一个问号。

我刚刚想出了这段代码，但显然它会生成多个问号。

```
$("#id").keyup(function(){
   $(this).val($(this).val() + "?");
}); 
```

谢谢你的想法。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-01T18:55:53.650

```
$("#id").keyup(function(){
    if ($(this).val().split('').pop() !== '?') {
        $(this).val($(this).val() + "?");
    }
}); 
```

## [演示](http://jsfiddle.net/s9RMs/)

编辑：

```
(function($) {
  $.fn.setCursorPosition = function(pos) {
    if ($(this).get(0).setSelectionRange) {
      $(this).get(0).setSelectionRange(pos, pos);
    } else if ($(this).get(0).createTextRange) {
      var range = $(this).get(0).createTextRange();
      range.collapse(true);
      range.moveEnd('character', pos);
      range.moveStart('character', pos);
      range.select();
    }
  }
}(jQuery));
$("#id").keyup(function(){
    if ($(this).val().split('').pop() !== '?') {
        $(this).val($(this).val() + "?");
        $(this).setCursorPosition( $(this).val().length - 1)
    }
});​ 
```

## [新的演示](http://jsfiddle.net/YtRS4/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-01T19:04:18.973

```
// Input is way better than keyup, although not cross-browser
// but a jquery plugin can add its support.
$('#id').on('input', function() {
    // If the last character isn't a question mark, add it
    if ( this.value[ this.value.length - 1 ] !== '?' ) {
        this.value += '?';
    }
}); 
```

# c# - FileSystemWatcher 为 Created 事件生成不一致的事件数

> ID：10855804
> 
> 赞同：1
> 
> 时间：2012-06-01T18:51:36.930
> 
> 标签：c#

环境：Windows7 64位/ C#

我有一个名为“Folder50”的文件夹，里面有 50 个文件。当我使用 ctrl + C 和 ctrl + V 命令将此文件夹复制到文件系统监视文件夹时，有时系统会生成 51 个事件，包括根文件夹。

但有时，系统只为根文件夹生成一个事件。

```
 void onCreated(object source, FileSystemEventArgs e)
   {
        Console::WriteLine( "File: {0} {1}", e.FullPath, e.ChangeType );
   } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-01T18:59:03.833

我已经对 FileSystemWatcher 进行了很多试验，并遇到了与您相同的问题。经过一番研究，我发现这似乎只是它的运作方式。如果它们发生在最后一个事件的指定时间段内，我在设置计时器以忽略其他事件方面取得了一些成功，但显然也会错过不同文件的并发副本。

如果您观看所有可用的事件，则会发生更多的怪异事件。复制文件将触发删除和新文件创建事件，有时会触发多个事件。保存文件可能会引发大量写入。总的来说，FileSystemWatcher 非常不一致。

我从以下网站找到了一些帮助，在对代码进行了一些修改后，它适合我的需要。

[http://spin.atomicobject.com/2010/07/08/consolidate-multiple-filesystemwatcher-events/](http://spin.atomicobject.com/2010/07/08/consolidate-multiple-filesystemwatcher-events/)

# javascript - 使用 jQuery 解析外部 JSON 文件

> ID：10855806
> 
> 赞同：1
> 
> 时间：2012-06-01T18:52:03.333
> 
> 标签：javascript, jquery, xml, ajax, json

我有一个 2 MB JSON 对象，我希望用 jQuery 解析它。我将整个对象转储到一个名为“timeline.js”的文件中，我希望将其作为数据集进行解析，以根据需要获取记录。

我的数据集最初是一个 XML 文件，但我读到 JSON 会更有效，因为我使用 jQuery 来提取数据并将其放置在 DOM 中。

下面是我的对象的第一条记录。我将如何解析此对象以获取“profileid”为 1016 的记录？

```
{
timeline:{
    record:[
        {
            profileid:1016,
            title:'Adam',
            parentprofileid:0,
            type:'Person',
            minzoomlevel:29,
            maxzoomlevel:66,
            isapproxstart:1,
            isapproxend:1,
            startdate:-4181,
            enddate:-3251,
            shortdescription:'Name means "red" or "man" he is...',
            article:'<div><span>The first member of...',
            status:22,
            scriptures:{
                scripture:[
                    {
                        profileid:1016,
                        scripturetext:'Genesis 2:7',
                        referencetext:'Birth'
                    },
                    {
                        profileid:1016,
                        scripturetext:'Genesis 5:4',
                        referencetext:'Death'
                    }
                ]
            }
        }, 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-01T19:11:52.620

jQuery parseJSON 工作正常，但是在使用 jQuery AJAX 并将 dataType 设置为 JSON 时是不必要的（它在接收到数据后已经被 jQuery 解析）。

但是，我想您的实际问题是如何找到 profileid 为 1016 的记录。由于所有项目都在一个数组中，找到它的唯一方法是循环数组并检查为当前项目设置的 profileId . 例如：

```
for(var i in items){
    if(items[i].profileid == 1016){
       //execute whatever you want to do.
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-01T18:55:42.507

使用：[jQuery.parseJSON( json )](http://api.jquery.com/jQuery.parseJSON/) - 采用格式良好的 JSON 字符串并返回结果 JavaScript 对象。例子

```
var obj = jQuery.parseJSON('{"name":"John"}');
 alert( obj.name === "John" ); 
```

# graphics - 2D 旋转方向

> ID：10855809
> 
> 赞同：0
> 
> 时间：2012-06-01T18:52:24.200
> 
> 标签：graphics, computer-vision

我试图理解我可以使用旋转矩阵的所有方式（抱歉不可读）： R(x) = [ cos(x) -sin(x) ; 罪（x）cos（x）]

您可以拥有两种类型的坐标系 (CS)：CS1 --> 正 x 轴向右，正 y 轴向上，这显然是人们使用的标准方向。CS2 --> 正 x 轴向右，正 y 轴向下。

我感到困惑的是插入 R(x) 时角度 x 的符号。根据数字的符号，角度可以逆时针或顺时针旋转（在任意向量上），但是对于哪个 CS 方向以及另一个方向的行为如何？

此外，如果您能解释的比维基百科更多关于不在犯罪现场和别名转换的内容，那就太好了。哪个最好考虑轮换？如果我认为在别名方法中，我是否必须对角度 x 使用相反的符号。这就是我所指的： [http ://en.wikipedia.org/wiki/Rotation_matrix#Ambiguities](http://en.wikipedia.org/wiki/Rotation_matrix#Ambiguities)

谢谢！

这是对的吗...

利用 R(x)。

向量在 CS1 (alibi) 中逆时针旋转“x”。这与角度“x”的 CS1 顺时针旋转有关（矢量现在具有新坐标）。如果 x 为负数，则逆时针变为顺时针（不在场证明），顺时针变为逆时针（别名）

如果我们要使用 CS2 ...可以采用上述方法，但要再次将逆时针方向与顺时针方向交换，反之亦然。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-01T18:57:10.710

在标准笛卡尔坐标（你称之为“CS1”）中，该矩阵将导致*向量**逆时针*旋转（即“alibi”）

 *在倒 Y 轴的情况下，它将是顺时针方向。*

# c# - 基于 OS 版本的 C# 条件编译变量

> ID：10855810
> 
> 赞同：1
> 
> 时间：2012-06-01T18:52:24.437
> 
> 标签：c#, variables, struct, operating-system, conditional-compilation

首先，是的，我看过这些帖子：
[C# 中是否有一种简单的方法可以根据 OS 版本使用条件编译符号](https://stackoverflow.com/questions/2830957/is-there-an-easy-way-in-c-sharp-to-have-conditional-compilation-symbols-based-on)
[条件编译取决于 C# 中的框架版本，](https://stackoverflow.com/questions/408908/conditional-compilation-depending-on-the-framework-version-in-c-sharp)
但它们并不针对我正在寻找的方向。

我正在寻找的是通过操作系统版本的***变量 _type_ 限定：***

```
public struct REPASTESPECIAL
{
     UInt32   dwAspect;
#if WINVER >= 6.0
     UIntPtr  dwParam;
#else
     UInt32   dwParam;
#endif 
} 
```

我不想回到这样的状态：

```
public struct REPASTESPECIAL<T>
{
     UInt32     dwAspect;
     T dwParam;
}
// return type by OS version
public static Type GetRePasteSpecial_ParamType()
{
    if (Environment.OSVersion.Version.Major >= 5) return typeof(IntPtr);
    else return typeof(UInt32);
} 
```

...因为这将允许程序员在我希望 dwParam 仅成为 IntPtr 或 UInt32 对象时使用 T 类型的任何对象，但如果我必须这样做，并将其作为其他寻找相同对象的参考。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-01T18:58:09.190

否 - 条件编译在*编译*时工作，而看起来你正在寻找在*执行*时工作的东西。

编辑：想想看，你可以在某种意义上使用条件编译*：*你可以尽可能地将它封装在它自己的程序集中，并以两种方式编译它，产生两个单独的程序集。然后在安装时（或其他）安装正确的组件。如果不知道您正在编写什么样的应用程序，就很难知道这有多可行。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-01T20:48:28.107

回答：“我有一些丑陋的逻辑，我害怕当我暴露给别人时会被滥用”

考虑公开不会让任何误用的漂亮且可用的 API。将所有互操作类型声明为内部类和实现结构的好 API，使 REPASTESPECIAL 等最内部的类公开可见/可用并没有太大价值。

这样，您可以隐藏丑陋的类/结构类型，并在需要时动态选择特定于操作系统的实现。

如果这个教育项目——那么它将是学习[依赖注入](http://en.wikipedia.org/wiki/Dependency_injection)以在运行时配置正确实现的好地方。

# .net - .net 使用正则表达式从字符串中提取模式

> ID：10855812
> 
> 赞同：1
> 
> 时间：2012-06-01T18:52:38.833
> 
> 标签：.net, regex

我有一个字符串，可以包含任意数量的任何类型的字符。我正在寻找使用正则表达式来提取模式并将它们放入我以后可以操作的字符串中。

例如：我希望正则表达式提取所有 3 位数字序列。因此，如果我有一个字符串“Easy as 123”，我会从中得到“123”。

顺便说一句，这适用于 C#.net 和 VB.net

非常感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T18:54:25.673

`(\d+)`

```
(       start capturing group
   \d   capture digits
+       capture one or more
)       end capturing group 
```

这将提取数字。但我建议您阅读[正则表达式](http://www.regular-expressions.info/)，以便您可以学习约定并编写自己的约定。尝试使用[regexr](http://gskinner.com/RegExr/)来测试它们。

# iphone - 我如何在没有痛苦的情况下调整 UIImages 的大小？

> ID：10855814
> 
> 赞同：-4
> 
> 时间：2012-06-01T18:52:39.583
> 
> 标签：iphone, objective-c, ios, uiimage

我见过：

*   各种UIImage调整大小代码错误且有bug的指责
*   调整低质量图像的代码大小
*   调整翻转图像的代码大小
*   调整在人像相机照片上无法正常工作的代码

有没有人可以推荐的用于调整/裁剪 UIImage 的代码？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-02T03:44:29.907

我这里使用的是[https://stackoverflow.com/a/10491692/1271826](https://stackoverflow.com/a/10491692/1271826)中显示的类别，该类别提供`UIImage`了一系列调整大小的方法，有效支持`UIViewContentModeScaleToFill`、`UIViewContentModeScaleAspectFill`和`UIViewContentModeScaleAspectFit`.

我主要使用它来创建我的缩略图图像（使用 my `imageByScalingAspectFillSize`），并使用不同格式的图像进行此操作而不会发生意外。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-02T03:55:45.417

如果您只是在谈论不包含元数据的 UIImage，那么只需开始创建图形上下文并在上下文中调用 uiimage 绘制方法：

```
- (UIImage*)resizeImage:(UIImage*)jpeg withSize:(CGSize)newSize
{   
    UIGraphicsBeginImageContextWithOptions(newSize, NO, 0.0);
    [jpeg drawInRect:CGRectMake(0, 0, newSize.width, newSize.height)];
    UIImage *resizedImage = UIGraphicsGetImageFromCurrentImageContext();    
    UIGraphicsEndImageContext();

    return resizedImage;
} 
```

如果您想要调整包含元数据（例如从磁盘读取或其他内容）的图像大小，请执行预览方法并在重新保存时使用原始源字典。

# android - Android ImageView 适合屏幕 onTouch

> ID：10855816
> 
> 赞同：0
> 
> 时间：2012-06-01T18:52:46.563
> 
> 标签：android, onclick, imageview, touch-event, image-enlarge

如何使图像适合从相机捕获的屏幕？我目前有一个预览，它是所拍摄图像的一种缩略图版本。我想触摸它并使其适合整个屏幕。在布局中，我有以下属性：

```
android:onClick="previewPhoto" 
```

但我不知道如何进行。这是我认为我应该做的，但想知道是否有更简单的方法。如果我开始一项新活动，我应该如何完成以下代码？

```
public void previewPhoto(View view){
    Toast.makeText(this, "Photo touched!", Toast.LENGTH_SHORT).show();
    mImageView.setScaleType(ScaleType.FIT_XY);

    Intent fullScreenIntent = new Intent(view.getContext(),FullImageActivity.class);
    fullScreenIntent.putExtra
    //ProfilePageNormalUser.this.startActivity(fullScreenIntent); 
} 
```

请注意，mImageView 是一个保存所拍摄照片的对象。当我简单地使用`setScaleType(ScaleType.FIT_XY);`它时，它将使图像适合微小的缩略图视图。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-01T19:28:33.237

3 种可能的解决方案，但对于所有这些，您需要为视图设置一个新的 layoutParams（对于宽度和高度，将它们设置为 fillParent）：

1.  在 imageView 上使用“setContentView”将其用作新布局。完成后，通过在您使用的布局上使用此方法返回到先前的布局。

2.  它需要接管根视图的整个空间。此解决方案取决于活动的布局。例如，如果布局复杂，则将其包裹在一个framelayout中，并将视图移动到framelayout，然后设置layoutParams。

3.  将视图设置在所有视图的顶部，然后设置 layoutParams.example（在示例中，“视图”是您希望设置在顶部的视图，对您来说，这将是“mImageView”） ：

> ```
> ...
> final View view=findViewById(R.id.view1);
> final WindowManager.LayoutParams layoutParams=new WindowManager.LayoutParams();
> layoutParams.gravity=Gravity.TOP|Gravity.LEFT;
> layoutParams.width=view.getLayoutParams().width;
> layoutParams.height=view.getLayoutParams().height;
> layoutParams.flags=WindowManager.LayoutParams.FLAG_NOT_FOCUSABLE;
> layoutParams.flags|=WindowManager.LayoutParams.FLAG_NOT_TOUCHABLE;
> final ViewGroup parent=(ViewGroup)view.getParent();
> parent.removeView(view);
> final WindowManager windowManager=(WindowManager)getSystemService(Context.WINDOW_SERVICE);
> windowManager.addView(view,layoutParams);
> // TODO handle overlapping title bar and/or action bar if needed 
> ```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-01T19:34:45.207

如果您只需要全屏显示照片而不需要自定义布局/按钮，则可以使用以下代码启动图库应用程序（或任何其他支持显示图像的第三方应用程序）：

```
Intent intent = new Intent();
intent.setAction(Intent.ACTION_VIEW);
intent.setDataAndType(Uri.parse("file://" + picturePath),"image/*");
startActivity(intent); 
```

编辑：

启动相机时可以设置picturePath，这样你就知道图像存储在哪里。请在此处查看 takePhotoFromCamera 方法：

[https://github.com/miguelrodelas/Android-Snippets/blob/master/ImageSnippets.java](https://github.com/miguelrodelas/Android-Snippets/blob/master/ImageSnippets.java)

该方法返回图片路径。它使用 getOutputMediaFile 方法（也在那里）从日期生成图像名称。

# php - 处理和监视存储在 MySQL 数据库中的基于时间的事件的方法？

> ID：10855822
> 
> 赞同：1
> 
> 时间：2012-06-01T18:53:22.177
> 
> 标签：php, mysql

我正在创建一个基于浏览器的 MMO，它具有基于时间的事件：即建造一座建筑物需要 23 小时。

我可以将其记录在我的 MySQL 数据库中，然后使用 cron 脚本或`watch`（[这个问题非常有帮助](https://stackoverflow.com/questions/1726116/run-a-php-script-every-second-using-cli)）循环遍历事件表（或等效表）。

似乎有一个普遍的共识，即我可以：

(1) 为处理事件及其相关触发器的脚本每秒运行一次 cron 作业。

(2) 每分钟运行一个 cron 作业，每秒循环 59 次迭代，处理事件及其相关触发器。

(3) 用于`watch`每秒运行一个 php 脚本。

本质上，在事件完成后，脚本将处理一些触发器，这些触发器的范围从改变状态、更新数据库、触发在最近事件之后排队的其他“事件”等等。

我最大的担忧来自每秒可能处理 10,000 多个事件和触发器。我可以使用哪些策略来避免性能问题？这些都是解决方案，还是有更好的选择？

示例事件：

```
Construction of Building A - 00:43:21 
```

快进 2601 秒并执行以下触发器：

```
Place Building A on map at Location x,y
Update resource total given by building
Start timer on next building in the queue
Construction of Building B - 02:10:49 
```

为了更好地解释：在游戏的早期阶段，这些事件将需要 5 分钟到 1 小时不等。在游戏的后期，这些事件将相隔数百小时。我需要实时处理这些事件，因为它们会影响游戏的其他方面（例如资源结构会提高每小时提供的资源量）。因此，无论用户是否处于活动状态，这些事件都需要由服务器处理。理论脚本将检查过期事件，然后根据该事件，运行与所述事件过期相关的其他几种方法。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-01T20:17:31.877

[https://github.com/prggmr/prggmr](https://github.com/prggmr/prggmr)

听起来像一个事件库可能会在这里极大地帮助你，

您可以在 prggmr 中编写一个简单的间隔来获取未来需要发生的事件并将它们注册到事件引擎中以发出信号，而不是尝试使用“包罗万象”来监视将来发生的所有事件当时。

像下面这样的东西可能会起作用，

```
prggmr\interval(function(){
    $query = mysql_query("SELECT event, when FROM events");
    while($event = mysql_fetch_assoc($query)) {
        prggmr\setTimeout(function() use ($event){
            prggmr\signal($event['event']);
        }, $event['when']);
    }
    // What this would do is look for any events that require signaling in the
    // in the future such as a building construction and signal it when the 
    // given amount of time in milliseconds has run
}, 3600);
// This simply tells the engine to run the function every minute 
```

并运行此代码说它存储在 event_detect.php

```
prggmr event_detect.php 
```

您通常希望由另一个应用程序（例如 runit）管理该进程。

使用这种方法，您可以将可能发生在应用程序中的所有事件构建为注册的“信号处理程序”，并在后台运行一个实际的游戏引擎，在事件发生时实时等待和监视事件，而无需任何用户交互。

我们实际上正在使用这种方法来处理我们目前正在开发的游戏的类似情况……逻辑上完全不同，但非用户交互式事件处理都是一样的。

此外，为了提高性能，您可以非常轻松地在一秒钟或更短的时间内处理 10,000 个事件，具体取决于您的服务器。

# python - Celery Flask --- 错误：[Errno 111] 连接被拒绝

> ID：10855824
> 
> 赞同：6
> 
> 时间：2012-06-01T18:53:44.680
> 
> 标签：python, celery, flask

在运行了烧瓶芹菜的基本示例之后（据我所知运行良好），我正在尝试将其集成到我自己的项目中。基本上，我在下面使用这个：

```
from flask import Blueprint, jsonify, request, session
from flask.views import MethodView
from celery.decorators import task

blueprint = Blueprint('myapi', __name__)

class MyAPI(MethodView):

    def get(self, tag):
        return get_resource.apply_async(tag)

@task(name="get_task")
def get_resource(tag):
    pass 
```

使用与示例中相同的设置，我收到此错误：

```
Traceback (most recent call last):
  File "/x/venv/lib/python2.7/site-packages/flask/app.py", line 1518, in __call__
    return self.wsgi_app(environ, start_response)
  File "/x/venv/lib/python2.7/site-packages/flask/app.py", line 1506, in wsgi_app
    response = self.make_response(self.handle_exception(e))
  File "/x/venv/lib/python2.7/site-packages/flask/app.py", line 1504, in wsgi_app
    response = self.full_dispatch_request()
  File "/x/venv/lib/python2.7/site-packages/flask/app.py", line 1264, in full_dispatch_request
    rv = self.handle_user_exception(e)
  File "/x/venv/lib/python2.7/site-packages/flask/app.py", line 1262, in full_dispatch_request
    rv = self.dispatch_request()
  File "/x/venv/lib/python2.7/site-packages/flask/app.py", line 1248, in dispatch_request
    return self.view_functions[rule.endpoint](**req.view_args)
  File "/x/venv/lib/python2.7/site-packages/flask/views.py", line 84, in view
    return self.dispatch_request(*args, **kwargs)
  File "/x/venv/lib/python2.7/site-packages/flask/views.py", line 151, in dispatch_request
    return meth(*args, **kwargs)
  File "/x/api/modules/document/document.py", line 14, in get
    return get_resource.apply_async(tag)
  File "/x/venv/lib/python2.7/site-packages/celery/app/task/__init__.py", line 449, in apply_async
    publish = publisher or self.app.amqp.publisher_pool.acquire(block=True)
  File "/x/venv/lib/python2.7/site-packages/kombu/connection.py", line 657, in acquire
    R = self.prepare(R)
  File "/x/venv/lib/python2.7/site-packages/kombu/pools.py", line 54, in prepare
    p = p()
  File "/x/venv/lib/python2.7/site-packages/kombu/pools.py", line 45, in <lambda>
    return lambda: self.create_producer()
  File "/x/venv/lib/python2.7/site-packages/celery/app/amqp.py", line 265, in create_producer
    pub = self.app.amqp.TaskPublisher(conn, auto_declare=False)
  File "/x/venv/lib/python2.7/site-packages/celery/app/amqp.py", line 328, in TaskPublisher
    return TaskPublisher(*args, **self.app.merge(defaults, kwargs))
  File "/x/venv/lib/python2.7/site-packages/celery/app/amqp.py", line 158, in __init__
    super(TaskPublisher, self).__init__(*args, **kwargs)
  File "/x/venv/lib/python2.7/site-packages/kombu/compat.py", line 61, in __init__
    super(Publisher, self).__init__(connection, self.exchange, **kwargs)
  File "/x/venv/lib/python2.7/site-packages/kombu/messaging.py", line 79, in __init__
    self.revive(self.channel)
  File "/x/venv/lib/python2.7/site-packages/kombu/messaging.py", line 168, in revive
    channel = channel.default_channel
  File "/x/venv/lib/python2.7/site-packages/kombu/connection.py", line 581, in default_channel
    self.connection
  File "/x/venv/lib/python2.7/site-packages/kombu/connection.py", line 574, in connection
    self._connection = self._establish_connection()
  File "/x/venv/lib/python2.7/site-packages/kombu/connection.py", line 533, in _establish_connection
    conn = self.transport.establish_connection()
  File "/x/venv/lib/python2.7/site-packages/kombu/transport/amqplib.py", line 279, in establish_connection
    connect_timeout=conninfo.connect_timeout)
  File "/x/venv/lib/python2.7/site-packages/kombu/transport/amqplib.py", line 89, in __init__
    super(Connection, self).__init__(*args, **kwargs)
  File "/x/venv/lib/python2.7/site-packages/amqplib/client_0_8/connection.py", line 129, in __init__
    self.transport = create_transport(host, connect_timeout, ssl)
  File "/x/venv/lib/python2.7/site-packages/amqplib/client_0_8/transport.py", line 281, in create_transport
    return TCPTransport(host, connect_timeout)
  File "/x/venv/lib/python2.7/site-packages/amqplib/client_0_8/transport.py", line 85, in __init__
    raise socket.error, msg
error: [Errno 111] Connection refused

--> 
```

我正在使用redis，如果我安装rabbitmq，我会收到另一个错误，但我现在不明白这一点——代理应该是redis，但它没有找到它还是什么？谁能给我更多的线索这里发生了什么？我是否需要导入其他东西，等等。关键是，除了简单的例子之外，几乎没有什么，这对我来说毫无意义。

我能够确定的最多的是在 Api 模块中无法访问“芹菜”，当它在应用程序级别尝试将数据放在那里时，那里的芹菜属于一些默认值，即'没有安装，因为我指向redis。只是一个猜测。我无法将信息导入模块，只是确定从应用程序调用任何“celery”（例如，输出 celery.conf）会导致错误——尽管我可以导入 celery.task。

这是应用程序正在使用的代理配置，直接来自示例：

```
BROKER_URL = 'redis://localhost:6379/0'
CELERY_RESULT_BACKEND = "redis"
CELERY_REDIS_HOST = "localhost"
CELERY_REDIS_PORT = 6379
CELERY_REDIS_DB = 0 
```

编辑：

如果你想看演示：[https ://github.com/thrisp/flask-celery-example](https://github.com/thrisp/flask-celery-example)

事实证明，在您的设置中设置 BROKER_TRANSPORT = 'redis' 对于我传入的任何内容都很重要（对于我在此处和 git 示例中提出的设置），我不完全确定为什么会这样'不在示例位中，但在我添加的位中，但它是 - 没有这个，它希望将所有内容转储到默认的 ampq 队列中。

编辑2：

此外，这是一个相当大的问题，使用即将发布的 Celery 版本在与 Flask 一起使用时简化了 10,000 个问题，使所有这些都变得不必要。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-12T16:37:54.773

您必须配置 redis 以绑定本地主机。在`/etc/redis/redis.conf`中，取消注释该行

```
bind 127.0.0.1 
```

# c - 如何在opencv中找到图像之间的重叠区域？

> ID：10855825
> 
> 赞同：4
> 
> 时间：2012-06-01T18:53:47.437
> 
> 标签：c, image-processing, opencv, computer-vision

我正在尝试使用两个图像实现 alpha 混合以进行图像拼接。我的第一张图片是这个-> ![在此处输入图像描述](../Images/63e05e23200c075d7a4a20c4e4f6f3ec.png)

这是我的第二张图片-> ![在此处输入图像描述](../Images/583634c25f137b19fab702046c1e347c.png)

这是我的结果图像-> ![在此处输入图像描述](../Images/50e536459dbc7ff56b90297fec14a6c4.png)

如您所见，结果不正确。我想我首先必须找到两者之间的重叠区域，然后在重叠部分上实现 alpha 混合。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-01T20:21:29.210

首先，你有没有看到 OpenCV 2.3 中引入了一个新的“拼接”模块？

它提供了一组用于拼接管道的构建块，包括混合和“找到重叠”（例如注册）步骤。这是一个文档：[http](http://docs.opencv.org/modules/stitching/doc/stitching.html) ://docs.opencv.org/modules/stitching/doc/stitching.html和一个拼接应用示例：[stitching_detailed.cpp](https://code.ros.org/trac/opencv/browser/trunk/opencv/samples/cpp/stitching_detailed.cpp?rev=6906)

我建议您研究此示例的代码，以便更好地理解细节。

关于发现重叠，计算机视觉中有几种常见的方法：

*   光流
*   模板匹配
*   特征匹配

对于你的情况，我推荐最后一个 - 它在照片上效果很好。这种方法已经在 OpenCV 中实现了——探索 OpenCv 源代码，看看它是如何`cv::detail::BestOf2NearestMatcher`工作的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-02T04:30:41.173

我认为最常见的方法是 SIFT，在两张图像中找到一些关键点，然后将它们扭曲以获得您的结果。看到[这个](http://opencv.willowgarage.com/documentation/cpp/feature_detection.html)

[这里](http://tobw.net/index.php?cat_id=2&project=Panorama%20Stitching%20Demo%20in%20Matlab)是关于 SIFT 和全景拼接的解释。

# python - 如何在 Python 中遍历 JSON

> ID：10855827
> 
> 赞同：2
> 
> 时间：2012-06-01T18:53:53.210
> 
> 标签：python, json, loops

我不知道如何循环一个比 1 级更深的 JSON 对象。对象是：

```
{
  "data":[
    {
      "id":"251228454889939/insights/page_fan_adds_unique/day",
      "name":"page_fan_adds_unique",
      "period":"day",
      "values":[
        {
          "value":9,
          "end_time":"2012-05-29T07:00:00+0000"
        },
        {
          "value":5,
          "end_time":"2012-05-30T07:00:00+0000"
        }
      ],
      "title":"Daily New Likes",
      "description":"Daily The number of new people who have liked your Page (Unique Users)"
    },
    {
      "id":"251228454889939/insights/page_fan_adds/day",
      "name":"page_fan_adds",
      "period":"day",
      "values":[
        {
          "value":9,
          "end_time":"2012-05-29T07:00:00+0000"
        },
        {
          "value":5,
          "end_time":"2012-05-30T07:00:00+0000"
        }
      ],
      "title":"Daily New Likes",
      "description":"Daily The number of new people who have liked your Page (Total Count)"
    }
  ]
} 
```

**代码：**

```
def parseJsonData(data):
    output_json = json.loads(data)
    for i in output_json:
        print i
        for k in output_json[i]:
            print k 
```

为什么我不能像这样访问对象：`output_json[data][id]`？如果我尝试这个，我会得到一个错误：

> 字符串索引必须是整数

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-01T19:30:14.447

由于您的“数据”键实际上是一个对象列表，因此您不能直接通过它们的“id”字段访问这些项目。您需要通过列表索引访问每个项目，例如：
`output_json["data"][0]["id"]`

现在，如果您想要做的是能够通过“id”字段作为键来索引“data”的成员，您可以重新格式化您的数据：

```
# make "data" a dict {id: item, }, instead of list [item1, item2, ...]
output_json['data'] = dict((item['id'], item) for item in json_data['data'])

print output_json['data']
# {'251228454889939/insights/page_fan_adds_unique/day': ...

print output_json['data']['251228454889939/insights/page_fan_adds_unique/day']
# {'description': 'Daily The number of new p ...

# ways to loop over "data"
for id_, item in output_json['data'].iteritems():
    print id_, item

for item in output_json['data'].itervalues():
    print item 
```

否则，您要做的只是遍历“数据”，因为索引和对象之间没有真正的相关性：

```
for item in output_json["data"]:
    print item['id']

# 251228454889939/insights/page_fan_adds_unique/day
# 251228454889939/insights/page_fan_adds/day 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-01T19:04:44.110

您粘贴的不是有效的 JSON。在“数据”之后有一个不匹配的 [。

基于此，我猜可能数据不是您认为的那样。如果 output_json[data] 的值是一个列表，那么您将无法访问`output_json[data][id]`. 相反，您必须执行类似的操作`output_json[data][0][id]`，其中 [0] 访问列表中的第一项。

# c# - 如何转换 IEnumerable to List where each object is an IFoo? How can I convert IEnumerable to List <ifoo>where each object is an IFoo? I have an IEnumerabl 问问题 问问题 2012-06-01T18:54:30.813 16867 次 This question shows research effort; it is useful and clear 3 This question does not show any research effort; it is unclear or not useful Bookmark this question. Show activity on this post. How can I convert IEnumerable to List <ifoo>where each object is an IFoo? I have an IEnumerable, someCollection, and each item in someCollection is an IFoo instance. How can I convert someCollection into a List<ifoo>? Can I use convert or cast or something instead of looping through and building up a list? Try this: enumerable.Cast<ifoo>().ToList(); c#linqgenericsienumerable 4 3 回答 3 This answer is useful 13 Using LINQ, you can use Cast to cast the items, and use ToList to get a list. Try: IEnumerable someCollection; //Some enumerable of object. var list = someCollection.Cast<ifoo>().ToList(); 于 2012-06-01T18:56:30.540 回答 This answer is useful 4 someCollection.Cast<ifoo>().ToList() 于 2012-06-01T18:56:15.583 回答 This answer is useful 4 尝试这个： enumerable.Cast<ifoo>().ToList(); 于 2012-06-01T18:56:03.940 回答 Related 1 php - 使用 PHP 正则表达式从 MySQL 查询中剥离/删除所有值？ 1 algorithm - 向堆添加和删除值的高效算法 1 java - DigitalPersona Java SDK - 比较功能集和模板 3 php - 每个 cookie 或每个会话显示随机图像和链接？ 1 .net - 访问不同程序集的资源 1 vba - 使用原始文件名下载文件 0 iphone - UIImagePickerController 与自定义 OverlayView 在 iPod iOS5、iPhone4S iOS5 上崩溃 1 ajax - 如何从 AjaxRequest wicket 6 获取额外参数 1 php - jQuery-文件-上传 2 java - Android：我应该避免 Commonsware 的 WakefulIntentservice 中的自写方法吗？ Reference php × 1429865 c/c++ × 756500 nginx × 49975 mongodb × 159057 mybatis × 3233 anaconda × 13410 pycharm × 14671 python × 1902243 vscode × 56040 docker × 110988 github × 49000 flask × 49129 ffmpeg × 24037 jmeter × 16910 matplotlib × 63493 bootstrap × 54641

> ID：10855836
> 
> 赞同：3
> 
> 时间：
> 
> 标签：c#, linq, generics, ienumerable

How can I convert `IEnumerable<object>` to `List<IFoo>` where each object is an `IFoo`?

I have an `IEnumerable<object>`, `someCollection`, and each item in `someCollection` is an `IFoo` instance. How can I convert `someCollection` into a `List<IFoo>`? Can I use convert or cast or something instead of looping through and building up a list?

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-06-01T18:56:30.540

Using LINQ, you can use [`Cast`](http://msdn.microsoft.com/en-us/library/bb341406.aspx) to cast the items, and use [`ToList`](http://msdn.microsoft.com/en-us/library/bb342261) to get a list.

Try:

```
 IEnumerable<object> someCollection; //Some enumerable of object.
 var list = someCollection.Cast<IFoo>().ToList(); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-01T18:56:15.583

`someCollection.Cast<IFoo>().ToList()`

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-06-01T18:56:03.940

尝试这个：

```
enumerable.Cast<IFoo>().ToList(); 
```</ifoo></ifoo></ifoo></ifoo></ifoo></ifoo></ifoo>

# javascript - 添加 cookie 值

> ID：10855842
> 
> 赞同：0
> 
> 时间：2012-06-01T18:54:49.343
> 
> 标签：javascript, html

我有销售物品的网站。我创建了具有

*   标题，
*   价格，
*   数量
*   全部的

我有一个添加到购物篮按钮，它存储 cookie，我有一个查看购物篮按钮，它链接到另一个 html 页面，该页面 onload 读取每个产品的 cookie。每个产品都有一个单独的总数，但我想做的是将总数加在一起以获得总体总数。我不知道如何编写一个函数来获取 cookie 总值。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T18:58:32.060

我知道 javascript 纯粹主义者会为此而杀了我，但你真的应该考虑使用像这样的 jQuery 插件：

[http://www.electrictoolbox.com/jquery-cookies/](http://www.electrictoolbox.com/jquery-cookies/)

它会让你的生活更轻松。

这一页：

[http://web.enavu.com/tutorials/working-with-cookies-using-jquery-and-javascript/](http://web.enavu.com/tutorials/working-with-cookies-using-jquery-and-javascript/)

向您展示如何使用 javascript 和 jQuery 插件访问 cookie。

# facebook - 从应用程序中删除 facebook 用户

> ID：10855845
> 
> 赞同：2
> 
> 时间：2012-06-01T18:54:58.970
> 
> 标签：facebook, facebook-graph-api

在五月更新之前（我们使用离线令牌，因为它们没有过期），在将禁用离线访问启用（禁用旧功能），这不再有效。我试图弄清楚可能发生了什么变化。目前没有关于该主题的帖子，而且我发现的所有帖子的答案都非常矛盾。

IE

[使用图形 API 从用户中删除应用程序](https://stackoverflow.com/questions/6634212/remove-the-application-from-a-user-using-graph-api)

对比

[Facebook 帐户取消链接或取消授权 facebook 应用程序并检查从 facebook 应用程序链接的状态](https://stackoverflow.com/questions/8679643/facebook-account-delink-or-deauthorize-facebook-app-and-check-status-of-linking)

这也记录在图形文档中，说这个命令应该可以工作，我尝试了几种不同的语法（它实际上没有说明在文档中使用哪种语法 - 干得好 Facebook，它只是说“发送删除请求”）。

长话短说，这行得通吗？尝试修复此功能时，我不断收到 400 错误“错误请求”。

我尝试了以下两个网址：

[https://graph.facebook.com/userId/permissions?access_token=someToken&method=delete](https://graph.facebook.com/userId/permissions?access_token=someToken&method=delete) [https://graph.facebook.com/me/permissions?access_token=someToken&method=delete](https://graph.facebook.com/me/permissions?access_token=someToken&method=delete)

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-01T19:05:52.200

这些问题并不矛盾，其中一个问题在 Graph API 对此提供支持之前得到了回答

[https://developers.facebook.com/docs/reference/api/user/#permissions](https://developers.facebook.com/docs/reference/api/user/#permissions)是文档，例子是：（javascript）

```
FB.api("/me/permissions","DELETE",function callback()); 
```

我已经做过很多次了，它确实有效

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-01T19:38:59.573

很抱歉回答了我自己的问题：

显然我实际上得到的是随机错误而不是实际错误。

我不确定 /me/ 是否有效，因为我没有回去重新测试它，但我现在确定使用以下格式：

[https://graph.facebook.com/userId/permissions&access_token=someToken](https://graph.facebook.com/userId/permissions&access_token=someToken)

在 facebook 中取消您自己的应用程序的授权确实可以正常工作。

# mysql - 用字符串 mysql 替换值

> ID：10855858
> 
> 赞同：0
> 
> 时间：2012-06-01T18:56:20.837
> 
> 标签：mysql

我有一个 VARCHAR 列，其中一些值以数字“5”结尾。这些值可能具有不同的长度。我想用字符串“UTR-5”替换所有这些值。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T18:58:19.820

也许不是最快的解决方案，但是：

```
update myTable set value = 'UTR-5' where value like '%5' 
```

# jquery - RaphaelJS 将我的 SVG 画在屏幕下方太远

> ID：10855861
> 
> 赞同：1
> 
> 时间：2012-06-01T18:56:31.057
> 
> 标签：jquery, svg, raphael

我的 SVG 一直显示在页面下方太远。过去一周我进行了详尽的搜索，但找不到解决方案。

请在这里查看我的意思。

[http://danu2.it.nuigalway.ie/09101916/raphael_map/](http://danu2.it.nuigalway.ie/09101916/raphael_map/)

我可以将边距顶部调整 -450 像素，但这会在项目后期给我带来问题。我遵循了[http://playground.mobily.pl/tutorials/building-an-interactive-map-with-raphael.html](http://playground.mobily.pl/tutorials/building-an-interactive-map-with-raphael.html)上的精彩教程，达到了我所做的一切。

这是 SVGworks.svg（将其标记到我上面的链接以查看，sOf 将我限制为两个链接。可能不适用于您的 IE）我在我的 raphael 实现中用于地图数据。

谁能告诉我为什么 SVG 地图在屏幕上加载这么远？

任何指针将不胜感激。蒂亚。

（除此之外：徽章在离线测试中显示，只是发现它不能在线工作，小问题）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-01T19:52:44.067

那是因为您的 paths.js 是这样说的。

例如，如果您定义了 Donegal，请将其复制并粘贴到在线 SVG 编辑器中，如下所示：[SVG-edit](http://svg-edit.googlecode.com/svn/branches/2.5.1/editor/svg-editor.html)：

```
<svg width="640" height="480" xmlns="http://www.w3.org/2000/svg">
 <!-- Created with SVG-edit - http://svg-edit.googlecode.com/ -->
 <g>
  <title>Layer 1</title>
  <path d="m249.813,525.80298c-1.31401,0.00403 -2.642,0.08698 -3.90401,0.08698c-2.552,0 -1.83499,1.54102 -0.28799,2.57202c1.73999,1.16003 3.37199,3.25903 4.86099,4.00403c0.64101,0.31995 2.688,3.70795 1.71501,4.29199c-2.804,1.68201 -3.63901,1.43799 -5.149,-0.57599c-2.48401,-3.31201 -0.968,-0.92303 -2.571,-0.28101c-1.15401,0.46198 -4.82501,0.263 -4.86101,0.28101c-1.505,0.75195 -3.717,1.18396 -3.717,3.72296c0,2.20099 -0.134,3.73602 0.85699,5.71899c0.664,1.32904 1.642,2.14502 2.284,3.42902c0.92101,1.84302 0.86301,3.474 0.86301,5.72498c0,1.98102 0.24699,4.073 -0.576,5.71802c-0.35199,0.703 -0.25499,5.28699 -0.856,5.43701c-1.23999,0.31 -5.14899,0.97699 -5.14899,2.57098c0,2.935 0.23299,2.83099 -1.71501,4.29199c-0.68399,0.513 -6.87199,3.12799 -5.19899,-0.21899c0.845,-1.68799 2.64999,-2.47101 3.14699,-4.461c0.466,-1.862 2.12001,-2.31799 2.634,-3.53497c0.183,-0.43103 -1.56,-0.94904 -1.38899,-1.633c0.53,-2.12201 1.563,-2.539 2.521,-4.45502c0.881,-1.76099 2.03799,-0.43701 1.433,-2.85901c-0.36,-1.44098 -0.895,-2.36096 -0.895,-4.15399c0,-1.83698 -0.84999,-5.07397 -2.82799,-5.56799c-2.681,-0.66998 -0.817,-2.19904 -1.714,-4.29199c-1.42101,-3.31403 -2.77299,-2.29004 -6.864,-2.29004c-1.793,0 -5.19701,0.54504 -5.769,2.828c-0.35201,1.409 -2.966,2.47205 -2.72801,3.90399c0.32701,1.96002 2.20201,1.33301 2.20201,3.27802c0,2.117 -1.37801,3.52802 -2.283,4.58002c-0.09599,-0.302 -1.96201,1.29297 -1.70799,-3.33398c0.101,-1.83502 0.06898,-2.86401 -4.34901,-3.03503c-1.286,-0.04901 1.731,-1.591 1.32001,-3.23401c-0.49699,-1.98895 -2.834,-1.521 -4.248,-0.81299c-1.437,0.71802 -0.60899,3.66901 -1.62,4.85504c-0.754,0.88397 -2.325,1.15497 -3.642,1.414c-1.47501,0.28998 1.21899,4.42596 -2.321,3.54095c-1.179,-0.29401 -0.99501,-1.03699 -2.12701,-2.32697c-0.823,-0.93805 -1.92499,1.48999 -3.23499,0.50696c-2.84201,-2.13196 -2.12001,0.50604 -4.248,0.50604c-0.789,0 -3.03401,-0.31201 -3.03401,0.80701c0,0.76599 0.39801,3.91699 1.01401,4.65497c1.646,1.97498 0.433,1.23798 -0.40601,3.03503c-0.847,1.81195 0.35001,3.65594 -0.30099,5.862c-1.235,1.05695 -1.877,-1.151 -2.73401,-2.427c-1.047,-1.55804 -0.56999,-0.86102 -2.52699,-0.90704c-2.427,-0.05798 -1.69499,4.43604 -3.13499,5.15503c-2.71901,1.35901 -0.606,1.05402 -0.606,3.64099c0,1.34998 3.84999,2.98999 3.44,3.23499c-1.06801,0.64099 -3.47801,0.625 -5.05501,1.414c-1.64299,0.82098 0.043,3.40204 1.214,3.841c0.539,0.20203 1.056,0.46698 1.614,0.60699c2.145,0.53601 2.05099,-0.68896 3.64101,-1.00702c1.99399,-0.39899 4.01599,-0.74799 2.83499,1.61401c-0.466,0.93103 -0.79399,3.45099 0.40001,4.04803c1.88399,0.94196 0.681,1.64197 0.20599,2.828c-0.47,1.17499 -1.576,1.909 -2.42799,0.20697c-0.63701,-1.27301 -2.552,-3.07098 -4.44801,-2.83398c-1.68999,0.211 -2.18999,1.21399 -3.642,1.21399c-1.459,0 -4.047,-0.80701 -3.84099,1.013c0.39999,3.54498 0.93599,1.92102 2.42099,3.03497c0.96201,0.72101 3.026,1.20001 3.84801,2.02106c0.358,0.35797 0.62599,1.58295 0,2.83398c-0.32701,0.65399 -2.269,3.79999 -3.44,2.62799c-1.177,-1.17603 -1.631,-1.82599 -3.235,-2.22803c-1.24901,-0.31299 -2.597,-2.828 -3.23399,-2.828c-1.27501,0 -3.35101,-0.41895 -3.84201,0.80701c-0.187,0.46704 -0.153,3.89099 -0.606,4.04199c-2.62599,0.875 -3.073,1.052 -4.855,2.83405c-1.459,1.45898 -1.104,-2.10303 -2.22701,-0.60699c-0.98999,1.31897 -2.05499,1.02698 -1.21399,2.42798c0.612,1.021 2.424,3.58698 3.44,3.841c0.99599,0.24902 1.49599,4.82098 2.42799,4.44897c3.37199,-1.349 2.869,1.64105 5.862,1.21301c4.60699,-0.65802 0.642,0.25903 2.834,0.80701c1.287,0.32202 2.687,-2.508 3.035,-2.42102c1.15599,0.289 1.888,3.69403 2.42099,2.62701c0.565,-1.13 3.50101,-3.40399 4.048,-1.21399c0.614,2.45502 -0.45799,1.35901 -2.021,3.23499c-0.496,0.59503 -1.978,2.99902 0,2.83398c1.89099,-0.15698 4.26399,0.31403 4.849,-2.02698c0.437,-1.745 1.08099,-3.492 1.42,-4.849c0.853,-3.409 4.534,-0.86401 4.448,-0.81299c-0.995,0.59698 -2.004,4.39697 -0.606,4.04797c1.679,-0.41998 2.19701,-2.42798 4.04201,-2.42798c1.319,0 1.953,-1.41699 3.034,-2.22699c0.188,-0.14203 4.203,-2.61499 4.655,-0.80701c0.089,0.35498 0.81801,3.53198 0.2,3.841c-2.48399,1.242 -2.784,2.31 -4.44899,3.64197c-1.776,1.42102 -1.82001,2.16504 -1.82001,4.24805c0,4.00098 -3.166,-0.74005 -2.021,3.841c0.278,1.11499 0.133,3.16699 -2.021,2.62799c-0.27,-0.06702 -0.543,-0.133 -0.813,-0.20001c-0.158,0.21198 -0.218,0.521 -0.287,0.81299c0.339,0.25403 0.327,0.245 1.076,0.80701c0.91,0.68298 4.00299,2.05402 4.86099,3.00299c1.507,-0.02002 2.511,-0.18896 3.14601,-0.71997c1.57799,-1.31403 4.80099,-0.44702 5.71899,-2.28302c0.752,-1.505 3.72301,-0.83099 3.72301,-3.435c0,-1.70599 -0.30801,-3.71399 1.42699,-4.29199c1.30901,-0.43604 2.923,-1.68604 4.57901,-0.85699c1.459,0.729 2.52499,1.43298 4.57399,1.43298c3.108,0 1.53601,-1.745 3.716,-2.28998c2.42,-0.60504 -0.125,-3.36902 1.146,-4.00403c0.12701,-0.06396 5.07701,-2.43097 5.28601,-2.44c-0.93001,-1.23596 1.09799,-3.09302 -1.563,-4.42297c-1.112,-0.55603 -1.90401,2.00195 -3.147,2.00195c-1.56999,0 1.63501,4.05603 -2.002,3.14703c-1.089,-0.27203 -1.354,-2.578 -4.004,-2.578c-2.603,0 -1.72099,-2.82001 -1.72099,-4.86102c0,-1.96497 -0.908,-1.48895 2.28999,-2.85895c2.342,-1.00403 -2.008,-4.00403 2.289,-4.00403c2.147,0 5.45,0.29401 6.576,0.57599c0.37599,0.09399 6.86299,1.40302 6.86299,-2.28998c0,-2.492 3.412,0.44397 3.72301,0.85699c1.35899,1.81201 2.002,-3.51202 2.002,-4.00403c0,-1.58099 -0.073,-3.15399 0.28099,-4.573c0.72301,-2.888 3.436,-1.33698 3.436,-4.57996c0,-2.28003 0.46201,-2.75305 2.002,-4.29205c0.55301,-0.55396 1.394,-1.76196 2.146,-3.00299c0.16501,-0.45099 0.832,-0.94196 0.714,-1.00098c-1.291,-0.64502 0.873,-4.28601 -0.569,-4.28601c-1.799,0 -2.106,-3.82397 -1.433,-5.14899c1.41,-2.77698 0.039,-3.716 3.716,-3.716c0.903,0 3.29399,-2.00201 3.435,-2.00201c2.386,0 4.892,0.56903 4.86099,-1.72101c0.033,-0.01001 0.09401,-0.021 0.15001,-0.03101c-0.42101,-0.29498 -0.716,-0.52295 -0.72,-0.53796c-0.502,-2.01001 0.047,-2.336 1.427,-3.716c0.96701,-0.96698 3.45801,-2.65002 4.42999,-3.62299c1.09,-1.09003 0.785,-2.50305 2.15201,-3.52899c1.28699,-0.96503 2.86301,-1.26404 4.573,-2.29004c1.37,-0.82202 4.267,0.13403 4.57999,-1.43298c0.45001,-2.25201 1.87701,-2.48401 1.427,-4.28601c-0.302,-1.20697 -0.39398,-3.91302 -2.28998,-4.29199c-2.15701,-0.43103 -3.62802,-1.43298 -6.28802,-1.43298c-2.03598,0 -2.569,-1.13 -3.72299,-2.57104c-0.72,-0.89996 -3.04599,-3.052 -3.42899,-3.14697c-2.36101,-0.591 -2.24301,-2.70703 -4.00401,-3.14703c-1.205,-0.30194 -2.504,-0.37494 -3.81799,-0.37097l0,0zm-24.364,87.16602c0.00301,0.00397 0.00301,0.00897 0.00601,0.01202c0.00899,-0.00702 0.00198,-0.01202 -0.00601,-0.01202z" id="svg_1" stroke-width="5" stroke="#000000" fill="none"/>
 </g>
</svg> 
```

我从您的脚本中获取了路径定义。

所以，简而言之：重新创建你的图形。您可以使用上述编辑器，但需要一些费力的复制/粘贴。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-01T21:07:00.650

Strah 是对的：您的路径在您打算显示的窗口之外偏移。请不要重新创建你的路径——这只是没有必要的。创建路径时只需转换路径即可。像这样复杂、相互关联的路径的坐标系已经是任意的了；路径之间的关系是重要的，而不是起源。

```
// init.js...

var obj = r.path(paths[county].path);

obj.attr(attributes).attr( { transform: "t0,-500" } ); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-03T08:22:04.340

将路径定义的地图放入集合中。这很简单，它是您开始创建路径之前的一行代码和您创建的最后一条路径之后的一行代码。

您可以在这里看到 2 套相同的套装。除非移动 1，否则它们将相互重叠。

一幅画描绘一千个字。这是一个简单的例子，然后你应该永远知道如何做到这一点......

[http://www.irunmywebsite.com/raphael/additionalhelp.php?q=movingpath](http://www.irunmywebsite.com/raphael/additionalhelp.php?q=movingpath)

# ms-access - MS ACcess 使文本框在按钮单击时可见

> ID：10855863
> 
> 赞同：1
> 
> 时间：2012-06-01T18:56:49.010
> 
> 标签：ms-access, vba, ms-access-2003

在每次单击按钮时，我都希望能够使 4 个文本框和 4 个标签“可见”。我不确定如何使用 VBA 代码执行此操作。

到目前为止，这是我尝试过的：没有产生错误，但我不知道如何从这里开始。

```
Private Sub Command36_Click()

Static Counter As Integer
Dim Name As String
Dim Name2 As String
Dim Count As Integer

Counter = Counter + 1

Name = "Label" & Counter
Name2 = "Text" & Counter
Command36.Caption = Name & Name2

For Count = 1 To Count = Counter 
```

Microsoft Access 表单、VBS

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-01T19:22:02.350

我想你的意思是：

```
Private Sub Command36_Click()
Dim Name As String
Dim Name2 As String
Dim Count As Integer

   For Count = 1 To 4
      Name = "Label" & Counter
      Name2 = "Text" & Counter
      Command36.Caption = Name & Name2
   Next

End Sub 
```

我不太明白上面的意思是什么。

这可能更有用，如果，正如你所说，你想让一些东西可见：

```
 For Count = 1 To 4
      Name1 = "Label" & Counter
      Name2 = "Text" & Counter
      Me(Name1).Visible = True
      Me(Name2).Visible = True
   Next 
```

帮自己一个忙，并确保为控件提供“真实”名称，而不是 Command36，而是类似`cmdShowLabel`

# c# - 在 C# 中从 SQL Server 检索大量数据的最简单方法

> ID：10855865
> 
> 赞同：2
> 
> 时间：2012-06-01T18:56:53.123
> 
> 标签：c#, sql-server, json, .net-2.0, sqlclr

在我的情况下，我有一个我自己编写的 C# DLL，它已在包含销售/客户数据的 SQL Server 数据库中注册。到目前为止，我有点卡住了。

DLL 调用远程服务器以获取令牌。然后将令牌添加到数据库中。理想情况下，下一步是将数据从 SQL 服务器检索到 DLL 中，然后使用 DLL 检索到的令牌构建 JSON 文件并将其发布到远程服务器。

我卡住的地方是，仅在我的 JSON 文件的收据部分就有 134 个元素，具有不同的数据类型。我需要能够在我的 C# DLL 中处理所有这些数据，并且将来我可能需要将更多数据提取到这个 JSON 文件中以进行发布。我已经进行了一些研究，使用用户定义类型 (UDT) 不太有效，据我所知，这是我应该远离的一个选项。我知道的另外两个选项是导出到 XML 并在我的 DLL 中解析它，或者创建和读取 134 多个变量。

我的问题是：除了 XML/硬编码之外，还有更简单的方法吗？如果有一种方法可以使用数组或对象，但根据我在[这里读到的内容似乎都不受支持，那将是理想的](http://msdn.microsoft.com/en-us/library/ms131092.aspx)

谢谢你。

**重要提示：由于我使用的数据库和 JSON 库，我正在使用 .Net framework 2.0**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T19:02:14.037

您可能应该坚持使用 XML，因为您的数据是半结构化的。特别是如果您知道您的架构将随着时间的推移而改变。SQL Server*还不*是[OODBMS](http://en.wikipedia.org/wiki/Object-relational_database)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-01T19:30:09.773

我建议您在 C# 端使用 XML 序列化。您创建一个对数据库模式进行建模的对象。

当您使用 .NET 2.0 时，您已经有一组很好的基类来以面向对象的方式对数据库模式进行建模。甚至可以为空的列也可以映射到可以为空的对象以节省内存和网络空间。

在 SQL 端，您使用 FOR XML 子句，这会将查询的输出从表格更改为 XML。您只需要制作一个好的 SP，即可在与 C# 对象完全相同的层次结构中创建 XML。

此 XML 必须匹配类的名称和大小写以及 c# 类的属性。

然后，您将在不超过 10 行代码中从 C# 端反序列化此 XML。无论数据层次结构有多大或多么复杂，您都会立即在内存中拥有可以再次序列化为 JSON 的对象。

如果您需要一些关于如何实现这一目标的好例子，请告诉我。请澄清您是否在 SQL Server CLR 执行上下文中运行，因为您可能需要特殊权限来序列化/反序列化数据。

我想这是实现 Entity Framework 功能的一种非常原始的方式。但它有效。

# jquery - 如何使 jqrid 子网格的每一行中的数据都不同？

> ID：10855870
> 
> 赞同：0
> 
> 时间：2012-06-01T18:57:12.620
> 
> 标签：jquery, arrays, object, jqgrid, datatable

我有一个带有一行的子网格的 jqgrid。现在每个子网格行都有相同的数据我想知道的是使用 subGridRowExpanded 对象在每个子网格行中填充不同数据的最佳方法是什么。这是 jsfiddle 用于查看我到目前为止所做的事情：

[http://jsfiddle.net/mojarame/h54Gs/light/](http://jsfiddle.net/mojarame/h54Gs/light/)
[http://jsfiddle.net/mojarame/h54Gs/embedded/result/](http://jsfiddle.net/mojarame/h54Gs/embedded/result/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T22:39:18.017

我不确定我是否完全理解您想要什么，但无论如何我都会将您的代码更改[为以下演示](http://www.ok-soft-gmbh.com/jqGrid/SubGrid2.htm)。

# iphone - AudioServicesPlaySystem音量？

> ID：10855874
> 
> 赞同：21
> 
> 时间：2012-06-01T18:57:25.117
> 
> 标签：iphone, objective-c, audio, volume

我有这个代码：

```
-(void)createAndPlaySoundID: (NSString*)name 
{
    NSString *path = [NSString stringWithFormat: @"%@/%@", [[NSBundle mainBundle] resourcePath], name];

    NSURL* filePath = [NSURL fileURLWithPath: path isDirectory: NO];
    SystemSoundID soundID;
    AudioServicesCreateSystemSoundID((__bridge CFURLRef)filePath, &soundID);

    AudioServicesPlaySystemSound(soundID);
} 
```

我这样称呼它：

```
[self createAndPlaySoundID: @"mySound.caf"]; 
```

这很好用，但是我无法控制音量。我只是希望用户使用 iPad 上的标准物理音量按钮来控制音量。

如果我将此音量降低到 1，它会播放，很棒，但是如果我将设备音量调到最大，它的音量相同。

任何帮助将不胜感激，处理这个，谢谢。

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2012-11-07T22:01:30.610

我也被这个话题上的类似问题所困扰。

我的问题是有一个我不知道的全局设置。

在设置应用程序中，在

> 常规 > 声音 > 铃声和警报

如果“使用按钮更改”设置为`Off`，则使用的声音`AudioServicesPlaySystemSound()`将始终以全音量播放（但其他声音 API，例如`AVAudioPlayer`将尊重设备的音量）。

# c# - 对项目的 Visual Studio 修改未更新 \bin 中的 .exe 文件

> ID：10855875
> 
> 赞同：4
> 
> 时间：2012-06-01T18:57:31.590
> 
> 标签：c#, visual-studio

我对 Visual Studio (Express) 很陌生。我做了一个项目，然后在我的桌面上放了一个 .exe 文件的快捷方式。后来我对项目进行了一些更改，当我使用 CTRL + F5 在 Visual Studio 中运行项目时，这些更改都是可见的。但是，我的桌面快捷方式指向的 .exe 文件仍然运行旧版本。

任何建议表示赞赏。

问候。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-01T20:46:23.433

通过在解决方案资源管理器中右键单击您的项目，转到属性，然后转到构建选项卡，您可以选择输出路径。bin\Debug\ 是默认值，这可能是您新建的 .exe 所在的位置

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-01T20:51:14.713

您可能需要使用“重建”操作而不是“构建”。有时 .NET 编译器会对更改的内容感到困惑 - “重建会强制重新编译解决方案，而不仅仅是“更改”的文件。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-01-10T12:09:11.637

这个问题可能有很多原因。我所做的是删除`.exe`目录中存在的`/bin/Debug`文件。重建将再次自动生成`.exe`文件。

# windows-8 - 如何在天气应用程序中创建一个不错的添加按钮到列表视图？

> ID：10855879
> 
> 赞同：0
> 
> 时间：2012-06-01T18:57:43.757
> 
> 标签：windows-8, microsoft-metro

执行以下步骤：

打开天气应用程序。右键单击位置

看到那个带有 + 符号的小项目了吗？我想做一些完全一样的事情，外观和行为。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-03T05:58:29.427

假设您只是想了解一些关于`metro-ui`控件的基本想法并且您正在使用 Release Preview。

当您单击鼠标右键时，将调用被触发的控件`App Bar`。“地方”按钮是一个`App Bar Command`. 单击该按钮将带您到另一个页面（`HTML`或`XAML`）。此页面包含一个`ListView`带有 的控件`GridLayout`。您可以动态更改事件`ListView Template`并将不同的操作分配给`itemInvoke`事件。

这是应用栏和命令的快速教程：http: [//msdn.microsoft.com/en-us/library/windows/apps/hh465309.aspx](http://msdn.microsoft.com/en-us/library/windows/apps/hh465309.aspx)

这是列表视图控件的快速教程：http: [//msdn.microsoft.com/en-us/library/windows/apps/hh465496.aspx](http://msdn.microsoft.com/en-us/library/windows/apps/hh465496.aspx)

# ruby-on-rails - rails 生成迁移：没有更多版本号-acts_as_archive 兼容性？

> ID：10855883
> 
> 赞同：2
> 
> 时间：2012-06-01T18:57:59.930
> 
> 标签：ruby-on-rails, migration, version

当我做一个：

```
rails generate migration xxx 
```

我得到：...创建 db/migrate/_xxx.rb

没有时间戳，也没有任何编号。

我试过：

```
rake db:migrate:reset -> no change  
rake db:version -> correct value (20120509143011)  
add config.active_record.timestamped_migration=false -> same problem (so i removed this line) 
```

我正在使用 rails 3.2 - ruby​​ 1.9.2 - rvm - mysql

任何的想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-02T11:36:10.320

问题已得到纠正......但我不知道为什么;-(

我做的最后一件事是删除 gem“act_as_archive”。然后我生成了一个迁移以删除相应的表，我的时间戳又回来了！

我这样做了 2 或 3 次（添加/删除 gem），问题是可重现的（至少在我的项目中）

所以我想这是与acts_as_archive gem 的兼容性问题。
我希望这对其他人有帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-18T20:50:44.303

问题是acts_as_archive 使用的'also_migrate' gem 的版本（0.35）。下一个版本（0.36）解决了这个问题。如果记忆有用，我相信 method_missing 别名没有从它执行的任何操作中返回值

# mysql - 在 MySQL 中透视数据。

> ID：10855884
> 
> 赞同：1
> 
> 时间：2012-06-01T18:58:00.107
> 
> 标签：mysql

我敢肯定这种问题之前已经出现过，但我一直在寻找，找不到与我需要的类似的东西。

编辑：所以经过一些阅读，这看起来像是属于枢轴并使用组连接。如果有人有任何见解，我真的很感激。

我有 3 个表（为简单起见，去掉了不必要的字段和数据）：

```
Students
id       name
------------------
1        John
2        Jane

Tests
id     name
------------------
1      Test1
2      Test2

Results
id    test_id     student_id   result
--------------------------------------
1     1           1            90
2     1           2            70
3     2           1            50
4     2           2            95 
```

我想要的是能够生成这样的表格：

```
Name     Average    Test1    Test2
-----------------------------------
John     70         90        50
Jane     92.5       70        95 
```

我知道如何获得平均值，而且我确信我可以用一组丑陋的循环和 php 逻辑来做到这一点，但我想获得最有效的解决方案。任何帮助是极大的赞赏。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-02T01:15:19.217

```
SELECT
    s.name,
    avg(r.result) AS average,
    t1.result AS test1,
    t2.result AS test2
FROM
    students s,
    results r,
    results t1,
    results t2
WHERE
    r.student_id = s.id AND
    t1.test_id = 1 AND
    t1.student_id = s.id AND
    t2.test_id = 2 AND
    t2.student_id = s.id
GROUP BY s.id;

+------+---------+-------+-------+
| name | average | test1 | test2 |
+------+---------+-------+-------+
| John |      70 |    90 |    50 | 
| Jane |    82.5 |    70 |    95 | 
+------+---------+-------+-------+ 
```

**编辑：**您不能真正根据测试表的内容动态地制作测试列。不过，您可以选择特定值用作列。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-01T19:12:38.497

您需要查看[AVG](http://dev.mysql.com/doc/refman/5.0/en/group-by-functions.html#function_avg)函数。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-01T19:12:55.903

尝试这个：

```
mysql> Select s.Name as Name, avg(r.result) as Average 
from result as r join Student as s 
on r.id=s.id group by (r.id) 
```

你会有这样的东西：

```
Name     Average 
-----------------
John     70    
Jane     92.5 
```

你不能把一行当作一列，想象一下约翰有 100000 次 test1，就不可能把它当作列。

# javascript - python中的热图

> ID：10855885
> 
> 赞同：1
> 
> 时间：2012-06-01T18:58:04.127
> 
> 标签：javascript, python, ajax

我需要为销售交易`timestamp`（销售）、`price`和绘制三个变量`zip_code`。是否有 python 或 javascript 库可以在其中绘制带有这些变量的热图？也许类似于 HighCharts，但具有地理绘图功能。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-01T19:08:01.327

[Heatmap.js](http://www.patrick-wied.at/static/heatmapjs/)是一个很棒的客户端库。

[谷歌地图](http://www.patrick-wied.at/static/heatmapjs/demo/maps_heatmap_layer/gmaps.php)示例

[开放层](http://www.patrick-wied.at/static/heatmapjs/demo/maps_heatmap_layer/openlayers.php)示例

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-01T19:11:42.357

[Matplotlib](http://matplotlib.sourceforge.net/)是一个很棒的 Python 绘图库。它使用底图工具包具有地理绘图功能。但是，我认为它没有关于邮政编码边界的信息，因此您必须从某个地方获取邮政编码 shapefile。谷歌搜索表明它们可以从美国人口普查网站获得。

我不知道有任何 Python 绘图工具包支持开箱即用的基于邮政编码的映射。带有底图的 matplotlib 允许您将普通标记（点、形状等）绘制到地图上。例如，很容易在美国地图上绘制带有彩色点的地图（例如，颜色“热图”对应于交易价格）。似乎您想要的困难部分是获取包含有关邮政编码边界信息的地图数据。我很确定你可以让 matplotlib 工作，但可能需要一些设置工作才能以正确的方式连接邮政编码信息。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-02-04T17:57:31.253

我会这样做：

一、下载美国人口普查局 shapefile 二、在 matplotlib 中绘制形状

[这是](https://gist.github.com/CloudCray/8711607)有关如何下载邮政编码 shapefile 以及如何使用这些文件绘制地图的要点。它还向您展示了如何改变各个邮政编码的颜色。

您将缩放您正在寻找的数据点，然后使用灰度百分比或 RGB 元组通过邮政编码改变颜色。

# asp-classic - vbscript/asp msxml.xmlhttp.6.0 仅在第一次尝试时出错

> ID：10855888
> 
> 赞同：1
> 
> 时间：2012-06-01T18:58:18.073
> 
> 标签：asp-classic, vbscript, xmlhttprequest

我有 asp/vbscript 代码将 XML 正文发布到 web api，并收到 XML 响应。

在浏览器中，（新会话）在第一次加载时，它会出错，这是消息：

err.source = msxml6.dll, err.number = -2146697208 - 指定资源下载失败。

重新加载页面时，它可以工作，之后每次都会工作，直到会话超时。

这里会发生什么？

代码如下 - 相当标准。

```
Dim oXmlHttp : Set oXmlHttp = CreateObject("MSXML2.XMLHTTP.6.0")

On Error Resume Next
oXmlHttp.Open "POST", sUri, False
oXmlHttp.setRequestHeader "Content-Type", "application/x-www-form-urlencoded"
oXmlHttp.Send(sRequest)
If Err Then
    response.write "err.source = " & err.Source & ", err.number = " & err.number & " - [" & err.Description & "]"
End If
On Error Goto 0 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-02T17:54:30.583

您应该做的第一件事是停止使用 XMLHTTP 并改用 ServerXMLHTTP。XMLHTTP 在服务器上下文中使用是不安全的。

# css - 两个 ::after 伪元素

> ID：10855890
> 
> 赞同：42
> 
> 时间：2012-06-01T18:58:26.893
> 
> 标签：css, pseudo-element

我想将两个 css`::after`伪元素应用于单个 DOM 元素，每个元素都有不同的颜色。（是的，我可以将 DOM 元素包装在另一个 DOM 元素中，并赋予每个元素和`::after`伪元素，但我更喜欢更简洁的 html。）

我怀疑这是可能的，但想知道是否有人可以更好地告诉我。

我特别怀疑将伪元素链接在一起的可能性，`::after`以便一个`::after`与另一个有关，而另一个与 DOM 元素有关，但如果有人知道如何做到这一点，请告诉。

* * *

## 回答 #1

> 赞同：43
> 
> 时间：2012-06-01T19:07:32.720

除了您的- [http://jsfiddle.net/BePSq/](http://jsfiddle.net/BePSq/) ，您还可以使用`:before`伪元素`:after`

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-06-01T19:05:56.093

您不能将两个`::after`伪元素添加到一个 DOM 元素。但是，您可以另外添加一个`::before`。根据您要完成的工作，这可能会起作用。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-06-01T19:09:19.057

您可以在一个 DOM 元素上同时使用 :before 和 :after 伪元素。只要确保正确放置它们。我相信 :before 将伪元素放在父元素之前，而 :after 将其放在 html 之后。但是，您只能使用这两个，并且不能添加更多的伪元素。

# jquery - jQuery .val() 问题

> ID：10855898
> 
> 赞同：0
> 
> 时间：2012-06-01T18:58:56.497
> 
> 标签：jquery, ajax

JS/jQuery 有点新，但我试图将隐藏字段的值更改为循环时 JSON 对象的特定值的总和。这是我所拥有的：

```
 <form>
            <input id="totDistance" type="hidden" value="" />
        </form>

<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
<script type="text/javascript">
$(document).ready(function() {
$.ajax({
   type: "POST",
   url: "loadPolys.php",
   dataType: "json",
   success: function(returnedJson){

    jQuery.each(returnedJson, function(i, val) {

    var curType = val.type;
    var curAlias = val.alias;
    var curDistance = val.distance;
    totDistance += parseInt(curDistance, 10);
    $('#totDistance').val(totDistance);
    });

},
   error: function(){
    alert("oh no");
   }

});
});
</script> 
```

尽管输入字段一直设置为“[object HTMLInputElement]1734”。要添加的值是 17 和 34，因此正在提取数据......并且 totDistance 设置为 51......我做错了什么？*菜鸟*

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T19:03:30.060

尝试定义`totDistance`变量：

```
...
success: function(returnedJson){

var totDistance = 0;

jQuery.each(returnedJson, function(i, val) {
... 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-01T19:14:27.497

I think what you are facing is an IE specific issue where it `totDistance` is getting evaluated as `document.getElementById('totDistance')` That is when it has an matching element with ID (totDistance). To avoid this.. simply declare the var and initialize to 0.

Also It is better to set the hidden element outside the `.each`

```
success: function(returnedJson){    
    var totDistance = 0;  //declared a var
    jQuery.each(returnedJson, function(i, val) {
      var curType = val.type;
      var curAlias = val.alias;
      var curDistance = val.distance;
      totDistance += parseInt(curDistance, 10);      
    });

    $('#totDistance').val(totDistance); //Moved outside of .each    
} 
```

# git - 可以将 Git 配置为根据上次提交日期设置文件日期吗？

> ID：10855905
> 
> 赞同：0
> 
> 时间：2012-06-01T18:59:15.987
> 
> 标签：git

我想知道 Git 是否配置为根据上次提交日期设置文件日期？

目前，当我签出一个分支时，文件日期似乎设置为当前日期。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-01T19:04:17.687

当然，在结帐后挂钩中执行此操作。

> 此钩子可用于执行存储库有效性检查、自动显示与前一个 HEAD 的差异（如果不同）或设置工作目录元数据属性。

# iphone - 如何检测对 UISearchDisplayController 中灰色（变暗）背景的点击

> ID：10855906
> 
> 赞同：5
> 
> 时间：2012-06-01T18:59:20.370
> 
> 标签：iphone, objective-c, ios, uisearchbar, uisearchdisplaycontroller

我正在开发一个想要实现搜索功能的 iOS 项目。我正在使用`UISearchBar`并且`UISearchDisplayController`我想`UISearchBar`隐式隐藏。当用户点击 时`UIBarButtonItem`，搜索栏会出现并“成为FirstResponder”，而当用户点击`Cancel`搜索栏中的按钮时，它应该会消失。

出现工作正常，但我有一个消失的问题。当用户点击`Cancel`按钮（`searchBarCancelButtonClicked`方法）时，我设法隐藏了搜索栏，但是当点击灰色（变暗）背景时，我无法隐藏搜索栏`UISearchDisplayController`。据我所知，没有办法检测到这个事件，所以有必要应用一些 hack。你知道吗，或者什么是检测灰色背景点击的最佳方法？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-11T08:49:57.740

所以我终于解决了。除了 之外`searchBarCancelButtonClicked:(UISearchBar *)searchBar`，还需要隐藏搜索栏`searchDisplayControllerDidEndSearch:(UISearchDisplayController *)controller`。看起来即使在点击灰色（变暗）背景时也会调用此回调，因此它可以轻松用于隐藏搜索栏。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-01T19:18:52.573

UISearchDisplayController 通常由 UISegmentedControl、UIResultsTable 和键盘组成。结果表是您要检测此触摸以解除的位置。知道了这一点后，也许您可​​以向该视图添加一个透明的 UIButton 来解除第一响应者，或者您可以在透明视图上添加一个 UIGestureRecognizer 来实现相同的效果？只是想一想，我自己还没有尝试过，如果它对你有用，我很高兴！

# lucene.net - 如何使用 lucene.net 索引 .txt、.pdf、.doc 等文件？

> ID：10855907
> 
> 赞同：-2
> 
> 时间：2012-06-01T18:59:30.183
> 
> 标签：lucene.net

我是 Lucene .net 的新手。如何使用 lucene.net 索引 .txt、.pdf、.doc 等文件？以及我们可以使用 lucene.net 索引哪些文件？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-05T16:25:05.543

Lucene.net 对索引特定文件是不可知的。您必须自己索引文件。

我会使用 IFilters 提取文档中的文本，然后使用 Lucene.net 创建搜索索引。

您可以在 codeproject.com 上搜索有关使用 IFilters 和 lucene.net 的多篇文章

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-05T19:13:42.287

在索引文件之前，您需要以适当的方式从中提取文本。Lucene 或 Lucene.net 不这样做。对于文本提取，您可以在 Windows 中使用 IFilter。IFilters 可能不稳定，您需要使用有线程问题的 COM。此外，对不同版本的文档使用不同的 ifilter 确实很麻烦。

[http://www.codeproject.com/Articles/13391/Using-IFilter-in-C](http://www.codeproject.com/Articles/13391/Using-IFilter-in-C)

www.ifilter.org

文本提取有商业替代品，但它们非常昂贵。

[http://www.isys-search.com/products/document-filters](http://www.isys-search.com/products/document-filters)

[http://www.oracle.com/us/technologies/embedded/025613.htm](http://www.oracle.com/us/technologies/embedded/025613.htm)

Apache Tika 是一个很好的商业开源替代品。它是在 Java 中的。

[http://tika.apache.org/](http://tika.apache.org/)

我强烈建议将[Apache Solr/Lucene](http://lucene.apache.org/solr/)与良好的[Solr .NET 客户端](http://code.google.com/p/solrnet/)一起使用，而不是 Lucene.net。Solr 内置了 Tika 集成，可以实现您想要做的事情。您无需了解 Java 即可使用 Solr。它是一个独立的 Web 服务，可以在轻量级应用服务器上运行。

如果您使用 Lucene.Net 构建文档搜索解决方案，您将遇到许多 Solr 已经解决的问题。

[http://www.lucidimagination.com/devzone/technical-articles/content-extraction-tika](http://www.lucidimagination.com/devzone/technical-articles/content-extraction-tika)

[http://wiki.apache.org/solr/ExtractingRequestHandler](http://wiki.apache.org/solr/ExtractingRequestHandler)

这里有关于 Lucene vs Solr 的很好的讨论。

[搜索引擎 - Lucene 或 Solr](https://stackoverflow.com/questions/1400892/search-engine-lucene-or-solr)

# javascript - 如何在javascript中重载函数？

> ID：10855908
> 
> 赞同：111
> 
> 时间：2012-06-01T18:59:32.410
> 
> 标签：javascript

经典（非 js）重载方法：

```
function myFunc(){
 //code
}

function myFunc(overloaded){
 //other code
} 
```

Javascript 不允许使用相同的名称定义多个函数。因此，出现了这样的事情：

```
function myFunc(options){
 if(options["overloaded"]){
  //code
 }
} 
```

除了传递带有重载的对象之外，是否有更好的解决方法来处理 javascript 中的函数重载？

传入重载会很快导致函数变得过于冗长，因为每个可能的重载都需要一个条件语句。使用函数来完成`//code`这些条件语句的内部可能会导致使用范围的棘手情况。

* * *

## 回答 #1

> 赞同：133
> 
> 时间：2012-06-01T19:02:59.210

Javascript 中的参数重载有多个方面：

1.  **可变参数**- 您可以传递不同的参数集（类型和数量），并且函数将以与传递给它的参数匹配的方式运行。

2.  **默认参数**- 如果参数未传递，您可以为其定义默认值。

3.  **命名参数**- 参数顺序变得无关紧要，您只需命名要传递给函数的参数。

下面是关于这些参数处理类别中的每一个的部分。

## 变量参数

因为 javascript 没有对参数或所需数量的参数进行类型检查，所以您可以只拥有一个实现，`myFunc()`通过检查参数的类型、存在或数量来适应传递给它的参数。

jQuery 一直这样做。您可以使某些参数成为可选参数，也可以根据传递给它的参数在函数中分支。

在实现这些类型的重载时，您可以使用几种不同的技术：

1.  您可以通过检查声明的参数名称值是否为来检查是否存在任何给定参数`undefined`。
2.  您可以使用 来检查总数量或参数`arguments.length`。
3.  您可以检查任何给定参数的类型。
4.  对于可变数量的参数，您可以使用`arguments`伪数组来访问任何给定的参数`arguments[i]`。

这里有些例子：

让我们看看jQuery的`obj.data()`方法。它支持四种不同的使用形式：

```
obj.data("key");
obj.data("key", value);
obj.data();
obj.data(object); 
```

每一个都会触发不同的行为，并且在不使用这种动态形式的重载的情况下，将需要四个单独的函数。

以下是如何辨别所有这些英语选项的方法，然后我将它们全部组合成代码：

```
// get the data element associated with a particular key value
obj.data("key"); 
```

如果传递给的第一个参数`.data()`是一个字符串，第二个参数是`undefined`，那么调用者必须使用这种形式。

* * *

```
// set the value associated with a particular key
obj.data("key", value); 
```

如果第二个参数未定义，则设置特定键的值。

* * *

```
// get all keys/values
obj.data(); 
```

如果没有传递参数，则返回返回对象中的所有键/值。

* * *

```
// set all keys/values from the passed in object
obj.data(object); 
```

如果第一个参数的类型是普通对象，则设置该对象的所有键/值。

* * *

以下是如何将所有这些组合到一组 javascript 逻辑中：

```
 // method declaration for .data()
 data: function(key, value) {
     if (arguments.length === 0) {
         // .data()
         // no args passed, return all keys/values in an object
     } else if (typeof key === "string") {
         // first arg is a string, look at type of second arg
         if (typeof value !== "undefined") {
             // .data("key", value)
             // set the value for a particular key
         } else {
             // .data("key")
             // retrieve a value for a key
         }
     } else if (typeof key === "object") {
         // .data(object)
         // set all key/value pairs from this object
     } else {
         // unsupported arguments passed
     }
 }, 
```

* * *

这种技术的关键是确保您想要接受的所有形式的参数都是唯一可识别的，并且永远不会混淆调用者正在使用哪种形式。这通常需要适当地对参数进行排序，并确保参数的类型和位置具有足够的唯一性，以便您始终可以分辨出正在使用哪种形式。

例如，如果您有一个接受三个字符串参数的函数：

```
obj.query("firstArg", "secondArg", "thirdArg"); 
```

您可以轻松地将第三个参数设为可选，并且您可以轻松检测到该条件，但您不能仅将第二个参数设为可选，因为您无法判断调用者要传递的这些参数中的哪一个，因为无法确定第二个参数是否传递参数是第二个参数，或者第二个参数被省略，所以第二个参数的位置实际上是第三个参数：

```
obj.query("firstArg", "secondArg");
obj.query("firstArg", "thirdArg"); 
```

由于所有三个参数都是同一类型，因此您无法区分不同参数之间的区别，因此您不知道调用者的意图。使用这种调用方式，只有第三个参数可以是可选的。如果您想省略第二个参数，则必须将其作为`null`（或其他可检测的值）传递，并且您的代码会检测到：

```
obj.query("firstArg", null, "thirdArg"); 
```

* * *

这是可选参数的 jQuery 示例。这两个参数都是可选的，如果未传递，则采用默认值：

```
clone: function( dataAndEvents, deepDataAndEvents ) {
    dataAndEvents = dataAndEvents == null ? false : dataAndEvents;
    deepDataAndEvents = deepDataAndEvents == null ? dataAndEvents : deepDataAndEvents;

    return this.map( function () {
        return jQuery.clone( this, dataAndEvents, deepDataAndEvents );
    });
}, 
```

这是一个 jQuery 示例，其中可能缺少参数或三种不同类型中的任何一种，这会为您提供四种不同的重载：

```
html: function( value ) {
    if ( value === undefined ) {
        return this[0] && this[0].nodeType === 1 ?
            this[0].innerHTML.replace(rinlinejQuery, "") :
            null;

    // See if we can take a shortcut and just use innerHTML
    } else if ( typeof value === "string" && !rnoInnerhtml.test( value ) &&
        (jQuery.support.leadingWhitespace || !rleadingWhitespace.test( value )) &&
        !wrapMap[ (rtagName.exec( value ) || ["", ""])[1].toLowerCase() ] ) {

        value = value.replace(rxhtmlTag, "<$1></$2>");

        try {
            for ( var i = 0, l = this.length; i < l; i++ ) {
                // Remove element nodes and prevent memory leaks
                if ( this[i].nodeType === 1 ) {
                    jQuery.cleanData( this[i].getElementsByTagName("*") );
                    this[i].innerHTML = value;
                }
            }

        // If using innerHTML throws an exception, use the fallback method
        } catch(e) {
            this.empty().append( value );
        }

    } else if ( jQuery.isFunction( value ) ) {
        this.each(function(i){
            var self = jQuery( this );

            self.html( value.call(this, i, self.html()) );
        });

    } else {
        this.empty().append( value );
    }

    return this;
}, 
```

* * *

## 命名参数

其他语言（如 Python）允许传递命名参数作为仅传递一些参数并使参数独立于它们传入的顺序的一种方式。Javascript 不直接支持命名参数的特性。一种常用的设计模式是传递属性/值的映射。这可以通过传递具有属性和值的对象来完成，或者在 ES6 及更高版本中，您实际上可以传递 Map 对象本身。

这是一个简单的 ES5 示例：

jQuery`$.ajax()`接受一种使用形式，您只需将单个参数传递给它，该参数是具有属性和值的常规 Javascript 对象。您传递给它的哪些属性决定了将哪些参数/选项传递给 ajax 调用。有些可能是必需的，许多是可选的。由于它们是对象的属性，因此没有特定的顺序。事实上，可以在该对象上传递超过 30 种不同的属性，只需要一个（url）。

这是一个例子：

```
$.ajax({url: "http://www.example.com/somepath", data: myArgs, dataType: "json"}).then(function(result) {
    // process result here
}); 
```

在`$.ajax()`实现内部，它可以只询问传入对象上传递了哪些属性，并将这些属性用作命名参数。这可以通过使用`for (prop in obj)`或通过将所有属性放入一个数组中`Object.keys(obj)`然后迭代该数组来完成。

当有大量参数和/或许多参数是可选的时，这种技术在 Javascript 中非常常用。注意：这给实现函数带来了责任，以确保存在最小的有效参数集，并为调用者提供一些调试反馈，如果传递的参数不足（可能通过抛出带有有用错误消息的异常） .

在 ES6 环境中，可以使用解构为上述传递的对象创建默认属性/值。[此参考文章](http://www.2ality.com/2015/01/es6-destructuring.html)中对此进行了更详细的讨论。

这是那篇文章的一个例子：

```
function selectEntries({ start=0, end=-1, step=1 } = {}) {
    ···
}; 
```

然后，您可以这样称呼它：

```
selectEntries({start: 5});
selectEntries({start: 5, end: 10});
selectEntries({start: 5, end: 10, step: 2});
selectEntries({step: 3});
selectEntries(); 
```

您未在函数调用中列出的参数将从函数声明中获取它们的默认值。

`start`这将为,`end`和`step`传递给`selectEntries()`函数的对象的属性创建默认属性和值。

## 函数参数的默认值

在 ES6 中，Javascript 为参数的默认值添加了内置语言支持。

例如：

```
function multiply(a, b = 1) {
  return a*b;
}

multiply(5); // 5 
```

[在 MDN 上](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Functions/Default_parameters)进一步描述了可以在此处使用的方式。

* * *

## 回答 #2

> 赞同：33
> 
> 时间：2012-06-01T19:03:57.680

可以通过多种方式重载 JavaScript 中的函数。所有这些都涉及单个主功能，该功能要么执行所有流程，要么委托给子功能/流程。

最常见的简单技术之一涉及一个简单的开关：

```
function foo(a, b) {
    switch (arguments.length) {
    case 0:
        //do basic code
        break;
    case 1:
        //do code with `a`
        break;
    case 2:
    default:
        //do code with `a` & `b`
        break;
    }
} 
```

更优雅的技术是使用数组（或对象，如果您不为*每个*参数计数进行重载）：

```
fooArr = [
    function () {
    },
    function (a) {
    },
    function (a,b) {
    }
];
function foo(a, b) {
    return fooArr[arguments.length](a, b);
} 
```

前面的例子不是很优雅，任何人都可以修改`fooArr`，如果有人将超过 2 个参数传递给 ，它将失败`foo`，因此更好的形式是使用模块模式和一些检查：

```
var foo = (function () {
    var fns;
    fns = [
        function () {
        },
        function (a) {
        },
        function (a, b) {
        }
    ];
    function foo(a, b) {
        var fnIndex;
        fnIndex = arguments.length;
        if (fnIndex > foo.length) {
            fnIndex = foo.length;
        }
        return fns[fnIndex].call(this, a, b);
    }
    return foo;
}()); 
```

当然，您的重载可能希望使用动态数量的参数，因此您可以为`fns`集合使用一个对象。

```
var foo = (function () {
    var fns;
    fns = {};
    fns[0] = function () {
    };
    fns[1] = function (a) {
    };
    fns[2] = function (a, b) {
    };
    fns.params = function (a, b /*, params */) {
    };
    function foo(a, b) {
        var fnIndex;
        fnIndex = arguments.length;
        if (fnIndex > foo.length) {
            fnIndex = 'params';
        }
        return fns[fnIndex].apply(this, Array.prototype.slice.call(arguments));
    }
    return foo;
}()); 
```

* * *

我个人的偏好往往是`switch`，尽管它确实增加了 master 功能。我使用这种技术的一个常见例子是访问器/修改器方法：

```
function Foo() {} //constructor
Foo.prototype = {
    bar: function (val) {
        switch (arguments.length) {
        case 0:
            return this._bar;
        case 1:
            this._bar = val;
            return this;
        }
    }
} 
```

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2014-09-13T06:45:53.200

你不能严格意义上的方法重载。不像`java`or中支持它的方式`c#`。

**问题是 JavaScript 本身并不支持方法重载。因此，如果它看到/解析两个或多个具有相同名称的函数，它只会考虑最后定义的函数并覆盖以前的函数。**

我认为适合大多数情况的一种方式如下 -

假设你有方法

```
function foo(x)
{
} 
```

您可以定义一个新方法**，而不是在 javascript 中不可能**的重载方法

```
fooNew(x,y,z)
{
} 
```

然后修改第一个函数如下 -

```
function foo(x)
{
  if(arguments.length==2)
  {
     return fooNew(arguments[0],  arguments[1]);
  }
} 
```

如果您有许多这样的重载方法，请考虑使用`switch`不仅仅是`if-else`语句。

（[更多详细信息](http://opensourceforgeeks.blogspot.in/2014/09/method-overloading-in-javascript.html)） PS：上面的链接转到我的个人博客，其中有更多详细信息。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2012-06-01T19:01:31.817

在javascript中，您可以只实现一次函数并在没有参数的情况下调用函数`myFunc()` 然后检查选项是否为“未定义”

```
function myFunc(options){
 if(typeof options != 'undefined'){
  //code
 }
} 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2012-12-23T09:21:56.800

我根据参数编号使用了一些不同的重载方法。不过我相信 John Fawcett 的方法也不错。这里的示例，代码基于 John Resig（jQuery 的作者）的解释。

```
// o = existing object, n = function name, f = function.
    function overload(o, n, f){
        var old = o[n];
        o[n] = function(){
            if(f.length == arguments.length){
                return f.apply(this, arguments);
            }
            else if(typeof o == 'function'){
                return old.apply(this, arguments);
            }
        };
    } 
```

可用性：

```
var obj = {};
overload(obj, 'function_name', function(){ /* what we will do if no args passed? */});
overload(obj, 'function_name', function(first){ /* what we will do if 1 arg passed? */});
overload(obj, 'function_name', function(first, second){ /* what we will do if 2 args passed? */});
overload(obj, 'function_name', function(first,second,third){ /* what we will do if 3 args passed? */});
//... etc :) 
```

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2013-04-10T01:22:09.837

我试图为[这里](http://stamat.wordpress.com/2013/04/10/javascript-function-overloading/)描述的这个问题开发一个优雅的解决方案。你可以在[这里](http://jsfiddle.net/stamat/Geh5r/)找到演示。用法如下所示：

```
var out = def({
    'int': function(a) {
        alert('Here is int '+a);
    },

    'float': function(a) {
        alert('Here is float '+a);
    },

    'string': function(a) {
        alert('Here is string '+a);
    },

    'int,string': function(a, b) {
        alert('Here is an int '+a+' and a string '+b);
    },
    'default': function(obj) {
        alert('Here is some other value '+ obj);
    }

});

out('ten');
out(1);
out(2, 'robot');
out(2.5);
out(true); 
```

用于实现此目的的方法：

```
var def = function(functions, parent) {
 return function() {
    var types = [];
    var args = [];
    eachArg(arguments, function(i, elem) {
        args.push(elem);
        types.push(whatis(elem));
    });
    if(functions.hasOwnProperty(types.join())) {
        return functions[types.join()].apply(parent, args);
    } else {
        if (typeof functions === 'function')
            return functions.apply(parent, args);
        if (functions.hasOwnProperty('default'))
            return functions['default'].apply(parent, args);        
    }
  };
};

var eachArg = function(args, fn) {
 var i = 0;
 while (args.hasOwnProperty(i)) {
    if(fn !== undefined)
        fn(i, args[i]);
    i++;
 }
 return i-1;
};

var whatis = function(val) {

 if(val === undefined)
    return 'undefined';
 if(val === null)
    return 'null';

 var type = typeof val;

 if(type === 'object') {
    if(val.hasOwnProperty('length') && val.hasOwnProperty('push'))
        return 'array';
    if(val.hasOwnProperty('getDate') && val.hasOwnProperty('toLocaleTimeString'))
        return 'date';
    if(val.hasOwnProperty('toExponential'))
        type = 'number';
    if(val.hasOwnProperty('substring') && val.hasOwnProperty('length'))
        return 'string';
 }

 if(type === 'number') {
    if(val.toString().indexOf('.') > 0)
        return 'float';
    else
        return 'int';
 }

 return type;
}; 
```

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2012-06-23T22:05:35.773

[https://github.com/jrf0110/leFunc](https://github.com/jrf0110/leFunc)

```
var getItems = leFunc({
  "string": function(id){
    // Do something
  },
  "string,object": function(id, options){
    // Do something else
  },
  "string,object,function": function(id, options, callback){
    // Do something different
    callback();
  },
  "object,string,function": function(options, message, callback){
    // Do something ca-raaaaazzzy
    callback();
  }
});

getItems("123abc"); // Calls the first function - "string"
getItems("123abc", {poop: true}); // Calls the second function - "string,object"
getItems("123abc", {butt: true}, function(){}); // Calls the third function - "string,object,function"
getItems({butt: true}, "What what?" function(){}); // Calls the fourth function - "object,string,function" 
```

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2016-07-19T08:09:52.593

# JS重载没问题，pb函数重载时如何保持代码干净？

您可以使用**转发**来获得干净的代码，基于两件事：

1.  参数数量（调用函数时）。
2.  参数类型（调用函数时）

    ```
     function myFunc(){
          return window['myFunc_'+arguments.length+Array.from(arguments).map((arg)=>typeof arg).join('_')](...arguments);
       }

        /** one argument & this argument is string */
      function myFunc_1_string(){

      }
       //------------
       /** one argument & this argument is object */
      function myFunc_1_object(){

      }
      //----------
      /** two arguments & those arguments are both string */
      function myFunc_2_string_string(){

      }
       //--------
      /** Three arguments & those arguments are : id(number),name(string), callback(function) */
      function myFunc_3_number_string_function(){
                let args=arguments;
                  new Person(args[0],args[1]).onReady(args[3]);
      }

       //--- And so on .... 
    ```

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2013-12-03T08:44:15.700

看一下这个：

[http://www.codeproject.com/Articles/688869/Overloading-JavaScript-Functions](http://www.codeproject.com/Articles/688869/Overloading-JavaScript-Functions)

基本上在你的课堂上，你给你想要重载的函数编号，然后通过一个函数调用你添加函数重载，快速而简单。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2014-01-09T02:44:30.763

由于 JavaScript 没有函数重载*选项*，因此可以使用对象来代替。如果有一个或两个必需的参数，最好将它们与选项对象分开。这是一个关于如何使用选项对象并将值填充为默认值的示例，以防选项对象中未传递值。

```
function optionsObjectTest(x, y, opts) {
    opts = opts || {}; // default to an empty options object

    var stringValue = opts.stringValue || "string default value";
    var boolValue = !!opts.boolValue; // coerces value to boolean with a double negation pattern
    var numericValue = opts.numericValue === undefined ? 123 : opts.numericValue;

    return "{x:" + x + ", y:" + y + ", stringValue:'" + stringValue + "', boolValue:" + boolValue + ", numericValue:" + numericValue + "}"; 
```

}

[这](http://jsfiddle.net/vlad_bezden/4ZqH7/)是一个关于如何使用选项对象的示例

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2014-08-26T20:40:57.530

为此，您需要创建一个将函数添加到对象的函数，然后它将根据您发送给函数的参数数量执行：

```
<script > 
//Main function to add the methods
function addMethod(object, name, fn) {
  var old = object[name];
  object[name] = function(){
    if (fn.length == arguments.length)
      return fn.apply(this, arguments)
    else if (typeof old == 'function')
      return old.apply(this, arguments);
  };
}

￼  var ninjas = {
   values: ["Dean Edwards", "Sam Stephenson", "Alex Russell"]
};

//Here we declare the first function with no arguments passed
  addMethod(ninjas, "find", function(){
    return this.values;
});

//Second function with one argument
  addMethod(ninjas, "find", function(name){
    var ret = [];
    for (var i = 0; i < this.values.length; i++)
      if (this.values[i].indexOf(name) == 0)
        ret.push(this.values[i]);
    return ret;
  });

//Third function with two arguments
  addMethod(ninjas, "find", function(first, last){
    var ret = [];
    for (var i = 0; i < this.values.length; i++)
      if (this.values[i] == (first + " " + last))
        ret.push(this.values[i]);
    return ret;
  });

//Now you can do:
ninjas.find();
ninjas.find("Sam");
ninjas.find("Dean", "Edwards")
</script> 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2013-06-17T18:23:38.803

我喜欢在父函数中添加子函数，以实现区分相同功能的参数组的能力。

```
var doSomething = function() {
    var foo;
    var bar;
};

doSomething.withArgSet1 = function(arg0, arg1) {
    var obj = new doSomething();
    // do something the first way
    return obj;
};

doSomething.withArgSet2 = function(arg2, arg3) {
    var obj = new doSomething();
    // do something the second way
    return obj;
}; 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2013-10-08T05:35:49.187

您要达到的目标最好使用函数的局部**参数**变量来完成。

```
function foo() {
    if (arguments.length === 0) {
        //do something
    }
    if (arguments.length === 1) {
        //do something else
    }
}

foo(); //do something
foo('one'); //do something else 
```

[您可以在此处](http://www.justinbar.net/post/add-parameters-to-an-existing-javascript-function)找到有关其工作原理的更好解释。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2021-01-01T12:30:58.473

使用扩展运算符作为参数怎么样？可以使用多个参数调用同一个块。所有参数都被添加到一个数组中，并且在您可以根据长度循环进入的方法中。

```
 function mName(...opt){
        console.log(opt); 
    }
    mName(1,2,3,4); //[1,2,3,4]
    mName(1,2,3); //[1,2,3] 
```

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2021-12-21T05:07:34.170

```
(() => {
  //array that store functions
    var Funcs = []
     /**
     * @param {function} f overload function
     * @param {string} fname overload function name
   * @param {parameters} vtypes function parameters type descriptor (number,string,object....etc
     */
    overloadFunction = function(f, fname, ...vtypes) {
        var k,l, n = false;
        if (!Funcs.hasOwnProperty(fname)) Funcs[fname] = [];
        Funcs[fname].push([f, vtypes?vtypes: 0 ]);
        window[fname] = function() {
            for (k = 0; k < Funcs[fname].length; k++)
                if (arguments.length == Funcs[fname][k][0].length) {
                    n=true;
                    if (Funcs[fname][k][1]!=0)
                    for(i=0;i<arguments.length;i++)
                    {
                        if(typeof arguments[i]!=Funcs[fname][k][1][i])
                        {
                            n=false;
                        }
                    }
                    if(n) return Funcs[fname][k][0].apply(this, arguments);
                }
        }
    }
})();

//First sum function definition with parameter type descriptors
overloadFunction(function(a,b){return a+b},"sum","number","number")
//Second sum function definition with parameter with parameter type descriptors
overloadFunction(function(a,b){return a+" "+b},"sum","string","string")
//Third sum function definition (not need parameter type descriptors,because no other functions with the same number of parameters
overloadFunction(function(a,b,c){return a+b+c},"sum")

//call first function
console.log(sum(4,2));//return 6
//call second function
console.log(sum("4","2"));//return "4 2"
//call third function
console.log(sum(3,2,5));//return 10
//ETC...
```

# .net - EPPlus 不允许在 IE 中下载 excel，但在 Firefox 中可以正常工作。

> ID：10855913
> 
> 赞同：0
> 
> 时间：2012-06-01T19:00:16.537
> 
> 标签：.net, internet-explorer

我有一个“下载”按钮，可以创建一个 excel 文件然后打开它。它在 Firefox 中运行良好，但在 IE 中单击该按钮完全没有任何作用。有谁知道为什么或如何解决它？这是代码：

```
<div align="center" id="excelDiv" runat="server">
    <a id="excelDownloadLink" runat="server">
    <input type="button" id="btnSubmitDownload" value="Download" />
    </a>
    <br /><br />
    <span id="validationResults" style="color:Red"></span><br />
</div> 
```

后面的代码：

```
 protected void Page_Load(object sender, EventArgs e)
    {
        excelDownloadLink.ServerClick += new System.EventHandler(ExcelDownload);

        DataCounts.DataSource = db.GetRequestCountByState();
        DataCounts.DataBind();
    }

    public override void VerifyRenderingInServerForm(Control control)
    {
        /* Confirms that an HtmlForm control is rendered for the specified ASP.NET
           server control at run time. */
    }

    public void ExcelDownload(object sender, EventArgs e)
    {
        DateTime startDateVal = DateTime.Parse(startDate.Value.ToString());
        DateTime endDateVal = DateTime.Parse(endDate.Value.ToString());

        if (searchType.Value == "Requests by Status")
        {

            DataSet statusExtract = db.GetStatusExport(startDateVal, endDateVal);
            DataTable statusExtractTable = statusExtract.Tables[0];

            DumpExcel(statusExtractTable, "Requests by Status");
        }
        else if (searchType.Value == "Database Extract")
        {
            DataSet dataExtract = db.GetDataExport(startDateVal, endDateVal);
            DataTable dataExtractTable = dataExtract.Tables[0];

            DumpExcel(dataExtractTable, "Database Extract");
        }
    }

    private void DumpExcel(DataTable tbl, string type)
    {
        using (ExcelPackage pck = new ExcelPackage())
        {
            //Create the worksheet
            ExcelWorksheet ws = pck.Workbook.Worksheets.Add("Database Extract");

            //Load the datatable into the sheet, starting from cell A1\. Print the column names on row 1
            ws.Cells["A2"].LoadFromDataTable(tbl, false);
            Response.Clear();

            switch (type)
            { 
                case "Database Extract":
                    //Header Titles
                    ws.Cells["A1"].Value = "RequestNumber";
                    ws.Cells["B1"].Value = "State";
                    ws.Cells["C1"].Value = "Status";
                    ws.Cells["D1"].Value = "Queue";
                    ws.Cells["E1"].Value = "OEM";
                    ws.Cells["F1"].Value = "Raytheon Material Number";
                    ws.Cells["G1"].Value = "Mfg Part Number";
                    ws.Cells["H1"].Value = "Material Charge Number";
                    ws.Cells["I1"].Value = "Program";
                    ws.Cells["J1"].Value = "Purchase Order";
                    ws.Cells["K1"].Value = "Purchase Requisition";
                    ws.Cells["L1"].Value = "Business Unit";
                    ws.Cells["M1"].Value = "Site";
                    ws.Cells["N1"].Value = "Buyer";
                    ws.Cells["O1"].Value = "Requisitioner";
                    ws.Cells["P1"].Value = "Component Engineer";
                    ws.Cells["Q1"].Value = "Responsible Engineer";
                    ws.Cells["R1"].Value = "Quality Engineer";
                    ws.Cells["S1"].Value = "Item Type";
                    ws.Cells["T1"].Value = "Material Location";
                    ws.Cells["U1"].Value = "Justification";
                    ws.Cells["V1"].Value = "Internal Testing Required";
                    ws.Cells["W1"].Value = "External Testing Required";
                    ws.Cells["X1"].Value = "Create Date";
                    ws.Cells["Y1"].Value = "Create Comments";
                    ws.Cells["Z1"].Value = "Closed Date";
                    ws.Column(26).Style.Numberformat.Format = @"m/d/yy h:mm:ss AM/PM";
                    ws.Cells["AA1"].Value = "Cancelled Date";
                    ws.Column(27).Style.Numberformat.Format = @"m/d/yy h:mm:ss AM/PM";
                    ws.Cells["AB1"].Value = "qty";
                    ws.Cells["AC1"].Value = "Minimum Buy Qty";
                    ws.Cells["AD1"].Value = "Broker Name";
                    ws.Cells["AE1"].Value = "Second Tier Supplier";
                    ws.Cells["AF1"].Value = "Requisitioner Date";
                    ws.Column(32).Style.Numberformat.Format = @"m/d/yy h:mm:ss AM/PM";
                    ws.Cells["AG1"].Value = "Requisitioner Comments";
                    ws.Cells["AH1"].Value = "CE Date";
                    ws.Column(34).Style.Numberformat.Format = @"m/d/yy h:mm:ss AM/PM";
                    ws.Cells["AI1"].Value = "CE Comments";
                    ws.Cells["AJ1"].Value = "REA Date";
                    ws.Column(36).Style.Numberformat.Format = @"m/d/yy h:mm:ss AM/PM";
                    ws.Cells["AK1"].Value = "REA Comments";
                    ws.Cells["AL1"].Value = "PQE Date";
                    ws.Column(38).Style.Numberformat.Format = @"m/d/yy h:mm:ss AM/PM";
                    ws.Cells["AM1"].Value = "PQE Comments";
                    ws.Cells["AN1"].Value = "PQE Customer Approval";
                    ws.Cells["AO1"].Value = "PQE NFD Purchase Request Approval";
                    ws.Cells["AP1"].Value = "PQE Additional Internal Testing";
                    ws.Cells["AQ1"].Value = "PQE Additional External Testing";
                    ws.Cells["AR1"].Value = "REA NFD Purchase Request";
                    ws.Cells["AS1"].Value = "REA Additional Internal Testing";
                    ws.Cells["AT1"].Value = "REA Additional External Testing";
                    ws.Cells["AU1"].Value = "MA Date";
                    ws.Column(47).Style.Numberformat.Format = @"m/d/yy h:mm:ss AM/PM";
                    ws.Cells["AV1"].Value = "MA Approval";
                    ws.Cells["AW1"].Value = "MA Comments";

                    ws.Column(1).AutoFit();
                    ws.Column(2).AutoFit();
                    ws.Column(3).AutoFit();
                    ws.Column(4).AutoFit();
                    ws.Column(5).AutoFit();
                    ws.Column(6).AutoFit();
                    ws.Column(7).AutoFit();
                    ws.Column(8).AutoFit();
                    ws.Column(9).AutoFit();
                    ws.Column(10).AutoFit();
                    ws.Column(11).AutoFit();
                    ws.Column(12).AutoFit();
                    ws.Column(13).AutoFit();
                    ws.Column(14).AutoFit();
                    ws.Column(15).AutoFit();
                    ws.Column(16).AutoFit();
                    ws.Column(17).AutoFit();
                    ws.Column(18).AutoFit();
                    ws.Column(19).AutoFit();
                    ws.Column(20).AutoFit();
                    ws.Column(21).AutoFit();
                    ws.Column(22).AutoFit();
                    ws.Column(23).AutoFit();
                    ws.Column(24).AutoFit();
                    ws.Column(25).AutoFit();
                    ws.Column(26).AutoFit();
                    ws.Column(27).AutoFit();
                    ws.Column(28).AutoFit();
                    ws.Column(29).AutoFit();
                    ws.Column(30).AutoFit();
                    ws.Column(31).AutoFit();
                    ws.Column(32).AutoFit();
                    ws.Column(33).AutoFit();
                    ws.Column(34).AutoFit();
                    ws.Column(35).AutoFit();
                    ws.Column(36).AutoFit();
                    ws.Column(37).AutoFit();
                    ws.Column(38).AutoFit();
                    ws.Column(39).AutoFit();
                    ws.Column(40).AutoFit();
                    ws.Column(41).AutoFit();
                    ws.Column(42).AutoFit();
                    ws.Column(43).AutoFit();
                    ws.Column(44).AutoFit();
                    ws.Column(45).AutoFit();
                    ws.Column(46).AutoFit();
                    ws.Column(47).AutoFit();
                    ws.Column(48).AutoFit();
                    ws.Column(49).AutoFit();
                    break;

                case "Requests by Status":
                    ws.Cells["A1"].Value = "RequestNumber";
                    ws.Cells["B1"].Value = "Status";
                    ws.Cells["C1"].Value = "Queue";
                    ws.Cells["D1"].Value = "OEM";
                    ws.Cells["E1"].Value = "Raytheon Material Number";
                    ws.Cells["F1"].Value = "Mfg Part Number";
                    ws.Cells["G1"].Value = "Material Charge Number";
                    ws.Cells["H1"].Value = "Program";

                    ws.Column(1).AutoFit();
                    ws.Column(2).AutoFit();
                    ws.Column(3).AutoFit();
                    ws.Column(4).AutoFit();
                    ws.Column(5).AutoFit();
                    ws.Column(6).AutoFit();
                    ws.Column(7).AutoFit();
                    ws.Column(8).AutoFit();

                    break;
            }      

            //Format the header for all columns
            using (ExcelRange rng = ws.Cells["A1:AW1"])
            {
                rng.Style.Font.Bold = true;
                //Set Pattern for the background to Solid
                rng.Style.Fill.PatternType = ExcelFillStyle.Solid;
                //Set color to dark blue
                rng.Style.Fill.BackgroundColor.SetColor(System.Drawing.Color.FromArgb(79, 129, 189));
                rng.Style.Font.Color.SetColor(System.Drawing.Color.White);
            }

            using (ExcelRange cols = ws.Cells["C1:C2000"])
            {

            }

            //Write it back to the client
            Response.ContentType = "application/vnd.openxmlformats-officedocument.spreadsheetml.sheet";
            Response.AddHeader("content-disposition", "attachment;  filename=NFDDatabaseExtract.xlsx");
            Response.BinaryWrite(pck.GetAsByteArray());

            Response.End();
        }
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-01T19:08:59.947

弄清楚了。而是创建了一个服务器控件 (asp:Button)，并仅将 OnClick 事件用于服务器控件，并将其指向 ExcelDownload。我知道我以前在 IE 命名控件上遇到过与 IE 不同的问题，也许这就是问题所在。不确定，但无论如何，这解决了它。

# cocoa - NSPopUpButton 箭头颜色

> ID：10855915
> 
> 赞同：5
> 
> 时间：2012-06-01T19:00:29.623
> 
> 标签：cocoa, colors, nspopupbutton

有没有办法自定义 NSPopUpButton 箭头的颜色？我环顾四周，但我还没有找到答案

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T19:14:11.533

我真的不认为有一种“简单”的方法可以做到这一点。如果您查看 API 描述，它甚至声明它不响应 setImage 例程。我已经做了很多工作，对按钮对象等进行子分类......我认为这是你必须去的地方才能做你所要求的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-02-26T23:21:39.697

就像这些控件中的太多一样，我通过继承 NSPopupButton(Cell) 然后在 drawRect 中完成我自己的所有绘图来做到这一点......虽然我作弊了一点，并使用图像来做实际的三角形而不是试图通过原语来做.

```
- (void)drawRect:(NSRect)dirtyRect 
{
  //...Insert button draw code here...
  //Admittedly the above statement includes more work than we probably want to do.
  //Assumes triangleIcon is a cached NSImage...I also make assumptions about location

  CGFloat iconSize = 6.0;
  CGFloat iconYLoc = (dirtyRect.size.height - iconSize) / 2.0;
  CGFloat iconXLoc = (dirtyRect.size.width - (iconSize + 8));

  CGRect triRect = {iconXLoc, iconYLoc, iconSize, iconSize};
  [triangleIcon drawInRect:triRect];
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-09-18T14:09:15.290

我通过使用“假色”过滤器更改了箭头颜色，而不使用任何图像。到目前为止，这是改变可可控制对我来说最简单的方法。

```
class RLPopUpButton: NSPopUpButton {
init() {
    super.init(frame: NSZeroRect, pullsDown: false)
    addFilter()
}

required init?(coder: NSCoder) {
    super.init(coder: coder)
    addFilter()
}

func addFilter() {
    let colorFilter = CIFilter(name: "CIFalseColor")!
    colorFilter.setDefaults()
    colorFilter.setValue(CIColor(cgColor: NSColor.black.cgColor), forKey: "inputColor0")
    colorFilter.setValue(CIColor(cgColor: NSColor.white.cgColor), forKey: "inputColor1")

//        colorFilter.setValue(CIColor(cgColor: NSColor.yellow.cgColor), forKey: "inputColor0")
//        colorFilter.setValue(CIColor(cgColor: NSColor.property.cgColor), forKey: "inputColor1")

    self.contentFilters = [colorFilter]
}
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-11-27T11:20:05.320

我这样做了，它对我有用。

```
(void)drawImageWithFrame:(NSRect)cellFrame inView:(NSView *)controlView
{
    NSPopUpButton *temp = (NSPopUpButton*)controlView;

    NSString *strtile = temp.title;

    AppDelegate *appdel = (AppDelegate*)[NSApplication sharedApplication].delegate;
    NSFont *font = [NSFont systemFontOfSize:13.5];
   NSSize size = NSMakeSize(40, 10);// string size

    CGRect rect = controlView.frame;
    rect = CGRectMake((size.width + temp.frame.size.width)/2, rect.origin.y, 8, 17);

    [self drawImage:[NSImage imageNamed:@"icon_downArrow_white.png"] withFrame:rect inView:self.
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-02-12T11:38:37.030

**斯威夫特 5**

在界面生成器中，删除默认箭头设置。然后，为单元格应用这个子类，这将在 NSPopUpButton 的右侧添加一个 NSImageView。

这样，您就可以完全控制设置为自定义按钮的内容以及定位方式。

```
import Cocoa

@IBDesignable class NSPopUpButtonCellBase: NSPopUpButtonCell {

    let textColor = NSColor(named: "white")!
    let leftPadding: CGFloat = 16
    let rightPadding: CGFloat = 30

    override func awakeFromNib() {
        super.awakeFromNib()

        let imageView = NSImageView()
        imageView.image = NSImage(named: "ic_chevron_down")!

        controlView!.addSubview(imageView)

        imageView.translatesAutoresizingMaskIntoConstraints = false

        imageView.widthAnchor.constraint(equalToConstant: CGFloat(20)).isActive = true
        imageView.heightAnchor.constraint(equalToConstant: CGFloat(20)).isActive = true
        imageView.trailingAnchor.constraint(equalTo: controlView!.trailingAnchor).isActive = true
        imageView.centerYAnchor.constraint(equalTo: controlView!.centerYAnchor).isActive = true
    }

    // overriding this removes the white container
    override func drawBezel(withFrame frame: NSRect, in controlView: NSView) {

    }

    // overriding this allows us to modify paddings to text
    override func titleRect(forBounds cellFrame: NSRect) -> NSRect {
        // this gets rect, which has title's height, not the whole control's height
        // also, it's origin.y is such that it centers title
        let processedTitleFrame = super.titleRect(forBounds: cellFrame)

        let paddedFrame = NSRect(
            x: cellFrame.origin.x + leftPadding,
            y: processedTitleFrame.origin.y,
            width: cellFrame.size.width - leftPadding - rightPadding,
            height: processedTitleFrame.size.height
        )

        return paddedFrame
    }

    // overriding this allows us to style text
    override func drawTitle(_ title: NSAttributedString, withFrame frame: NSRect, in controlView: NSView) -> NSRect {
        let attributedTitle = NSMutableAttributedString.init(attributedString: title)
        let range = NSMakeRange(0, attributedTitle.length)
        attributedTitle.addAttributes([NSAttributedString.Key.foregroundColor : textColor], range: range)

        return super.drawTitle(attributedTitle, withFrame: frame, in: controlView)
    }
} 
```

# windows-phone-7 - WP7 列表框绑定无法正常工作

> ID：10855917
> 
> 赞同：0
> 
> 时间：2012-06-01T19:00:37.317
> 
> 标签：windows-phone-7, data-binding

肯定是一个菜鸟错误（我昨天下午开始在 WP7 中开发），但我在这上面浪费了很多时间。
我发布了我的课程和我的一小部分代码：

```
public class ChronoLaps : INotifyPropertyChanged
{
    private ObservableCollection<ChronoLap> laps = null;

    public int CurrentLap
    {
        get { return lap; }
        set
        {
            if (value == lap) return;
            // Some code here ....
            ChronoLap newlap = new ChronoLap()
            {
                // Some code here ...
            };
            Laps.Insert(0, newlap);

            lap = value;
            NotifyPropertyChanged("CurrentLap");
            NotifyPropertyChanged("Laps");
        }
    }

    public ObservableCollection<ChronoLap> Laps { 
        get { return laps; }
        set
        {
            if (value == laps) return;
            laps = value;
            if (laps != null)
            {
                laps.CollectionChanged += delegate
                {
                    MeanTime = Laps.Sum(p => p.Time.TotalMilliseconds) / (Laps.Count * 1000);
                    NotifyPropertyChanged("MeanTime");
                };
            }
            NotifyPropertyChanged("Laps");
        }
    }
} 
```

**MainPage.xaml.cs**

```
public partial class MainPage : PhoneApplicationPage
{
    public ChronoLaps History { get; private set; }

    private void butStart_Click(object sender, EventArgs e)
    {
        History = new ChronoLaps();
        // History.Laps.Add(new ChronoLap() { Distance = 0 });

        LayoutRoot.DataContext = History;
    }
} 
```

**主页.xaml**

```
<phone:PhoneApplicationPage>    
    <Grid x:Name="LayoutRoot" Background="Transparent">
        <Grid Grid.Row="2">
            <ScrollViewer Margin="-5,13,3,36" Height="758">
                <ListBox Name="lbHistory" ItemContainerStyle="{StaticResource ListBoxStyle}"
                         ItemsSource="{Binding Laps}" 
                         HorizontalAlignment="Left" Margin="5,25,0,0"
                         VerticalAlignment="Top" Width="444">
                    <ListBox.ItemTemplate>
                        <DataTemplate>
                            <StackPanel Orientation="Horizontal">
                                <TextBlock Text="{Binding Lap}" Width="40" />
                                <TextBlock Text="{Binding Time}" Width="140" />
                                <TextBlock Text="{Binding TotalTime}" Width="140" />
                                <TextBlock Text="{Binding Distance}" />
                            </StackPanel>
                        </DataTemplate>
                    </ListBox.ItemTemplate>
                </ListBox>
            </ScrollViewer>
        </Grid>
    </Grid>
</phone:PhoneApplicationPage> 
```

问题是当我将一个或多个项目添加到`History.Laps`集合时，我的列表框没有刷新并且这些项目不会出现。
但是，如果我删除在线评论，则会`// History.Laps.Add(new ChronoLap()...`出现此项目，因此稍后会插入其他所有项目。
更多：如果我删除该评论然后写`History.Laps.Clear()`（在设置绑定之前或之后）绑定不再起作用。如果集合是空的，就好像它会变得疯狂。
实在不明白是什么原因...

**更新和解决方案**：
如果我搬家

```
History = new ChronoLaps();
LayoutRoot.DataContext = History; 
```

从`butStart_Click`到`public MainPage()`一切​​都按预期工作。
有人可以解释一下原因吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-31T09:36:27.863

尝试为列表框绑定 DataContext 和 ItemSource ..

我是怎么做的。。

```
 <ListBox x:Name="AppList" Background="White" DataContext="{Binding DisplayItem}" SelectionChanged="AppList_SelectionChanged" Height="500" Width="auto">
            <ListBox.ItemTemplate>
                <DataTemplate>
  </DataTemplate>
            </ListBox.ItemTemplate>
        </ListBox> 
```

而且我不知道它是否会有所帮助，但我仍然会发布我正在使用的代码..

项目列表.cs

```
 using System;
using System.Net;
using System.Windows;
using System.Windows.Controls;
using System.Windows.Documents;
using System.Windows.Ink;
using System.Windows.Input;
using System.Windows.Media;
using System.Windows.Media.Animation;
using System.Windows.Shapes;
using System.Windows.Media.Imaging;

namespace AppHouseLibrary
{
    public class ItemList : IComparable
    {
        private string _name;
        public string WidgetName
        {
            get
            {
                return _name;
            }
            set
            {
                _name = value;
            }
        }
        public int ID
        {
            get;
            set;
        }
        private BitmapImage _Icon;
        public BitmapImage Icon
        {
            get
            {
                return _Icon;
            }
            set
            {
                _Icon = value;
            }
        }
        //public string arrow { get; set; }
        public BitmapImage arrow { get; set; }
        public int CompareTo(ItemList other)
        {
            return this.WidgetName.CompareTo(other.WidgetName);
        }
    }
} 
```

我有一个 UIManager.cs 类，在我将数据加载到 UI 给用户之前，我会在其中刷新数据。

```
 using System;
using System.ComponentModel;
using System.Collections.ObjectModel;
using System.Windows.Media.Imaging;
using System.Collections.Generic;
using StirLibrary.com.mportal.data.bean;
using com.mportal.utils;
using StirLibrary.com.mportal.utils;

namespace StirLibrary.com.UI
{
    public class UIManager : INotifyPropertyChanged
    {
       private static UIManager instance = null;
       private static string TAG = "UIManager";

       BitmapImage arrowImage = Utils.returnImage(ImageUtils.ARROW);

```
 public List<ItemList> data = new List<ItemList>();
    public static UIManager getInstance()
    {
        if (instance == null)
        {
            instance = new UIManager();
        }
        return instance;    
    }

    private ObservableCollection<ItemList> _displayItem = new ObservableCollection<ItemList>();
    public ObservableCollection<ItemList> DisplayItem
    {
        get
        {
            return _displayItem;
        }
    }

    private UIManager()
    {

    }

    public event PropertyChangedEventHandler PropertyChanged;
    private void NotifyPropertyChanged(String PropertyName)
    {
        if (null != PropertyChanged)
        {
            PropertyChanged(this, new PropertyChangedEventArgs(PropertyName));
        }
    }
    public WidgetBean[] serviceBeanList = null;
    public WidgetBean[] wheelBeanList = null;

    public WidgetBean getServiceWidgetBean(int selectedIndex)
    {
        try
        {
            if (serviceBeanList != null)
            {
                return serviceBeanList[selectedIndex];
            }
        }
        catch (Exception e)
        {
            Logger.log(TAG, e.Message);
        }
        return null;
    }

    public WidgetBean getWheelWidgetBean(int selectedIndex)
    {
        try
        {
            if (wheelBeanList != null)
            {
                return wheelBeanList[selectedIndex];
            }
        }
        catch (Exception e)
        {
            Logger.log(TAG, e.Message);
        }
        return null;
    }

    public void DisplayCatalog(string[] ServiceDisplayName, string[] WheelDisplayName, BitmapImage[] ServiceIcons, WidgetBean[] ServiceBeanList, WidgetBean[] WheelBeanList)
    {
        try
        {
            DisplayItem.Clear();
            string disp1 = string.Empty;
            string name = ServiceDisplayName[0];
            wheelBeanList = WheelBeanList;

            serviceBeanList = ServiceBeanList;
            for (int i = 0; i < ServiceDisplayName.Length; i++)
            {
                WidgetBean bean = serviceBeanList[i];
                if (bean.isCategory())
                {
                    DisplayItem.Add(new ItemList { WidgetName = ServiceDisplayName[i], Icon = ServiceIcons[i], arrow = arrowImage });
                }
                else
                {
                    DisplayItem.Add(new ItemList { WidgetName = ServiceDisplayName[i], Icon = ServiceIcons[i] });
                }
            }

            NotifyPropertyChanged("UI");
        }
        catch (Exception e)
        {
            Logger.log(TAG,e.Message);
        }
    }

    public void DisplayCatalog(string[] displayName, BitmapImage[] icons, WidgetBean[] beanArray)
    {
        try
        {
            serviceBeanList = beanArray;

            DisplayItem.Clear();
            for (int i = 0; i < displayName.Length; i++)
            {
                WidgetBean bean = serviceBeanList[i];
                if (bean.isCategory())
                {
                    DisplayItem.Add(new ItemList { WidgetName = displayName[i], Icon = icons[i], arrow = arrowImage });
                }
                else
                {
                    DisplayItem.Add(new ItemList { WidgetName = displayName[i], Icon = icons[i] });
                }
            }

            NotifyPropertyChanged("UI");
        }
        catch (Exception e)
        {
            Logger.log(TAG,e.Message);
        }

    }
} 
```

} 
            回答 #2

赞同：0

时间：2012-06-01T22:04:45.447

实际上，我认为为 ChronoLaps 开设单独的课程没有意义。这是我修改 MainPage.xaml.cs 代码的方式，一切似乎都对我有用。

```
public partial class MainPage : PhoneApplicationPage
    {
        public ObservableCollection<ChronoLap> Laps { get; set; }
        public double MeanTime { get; set; }

        // Constructor
        public MainPage()
        {
            InitializeComponent();
            Laps = new ObservableCollection<ChronoLap>();
            Laps.CollectionChanged += delegate
            {
                MeanTime = Laps.Sum(p => p.Time.TotalMilliseconds) / (Laps.Count * 1000);
            };
            DataContext = this;
            Loaded += (s, e) =>
                          {
                              Laps.Add(new ChronoLap() {Time = TimeSpan.FromSeconds(1000)});
                              Laps.Add(new ChronoLap() {Time = TimeSpan.FromSeconds(1000)});
                              Laps.Add(new ChronoLap() {Time = TimeSpan.FromSeconds(1000)});
                          };
        }
    } 
```

```

# python - lxml etree.parse 内存分配错误

> ID：10855921
> 
> 赞同：3
> 
> 时间：2012-06-01T19:01:10.160
> 
> 标签：python, lxml

我正在使用 lxml etree.parse 以某种方式解析一个巨大的 XML 文件（大约 65MB - 300MB）。当我运行包含以下函数的独立 python 脚本时，我遇到内存分配失败：

```
Error:

     Memory allocation failed : xmlSAX2Characters, line 5350155, column 16 
```

部分功能代码：

```
def getID():
        try:
            from lxml import etree
            xml = etree.parse(<xml_file>)  # here is where the failure occurs
            for element in xml.iter():
                   ...
                   result = <formed by concatenating element texts>
            return result
        except Exception, ex:
            <handle exception> 
```

奇怪的是，当我在 IDLE 上输入相同的函数并测试相同的 XML 文件时，我没有遇到任何 MemoryAllocation 错误。

关于这个问题的任何想法？提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-01T19:04:38.590

我将使用[迭代解析器](http://lxml.de/parsing.html#iterparse-and-iterwalk)来解析文档，调用`.clear()`您完成的任何元素；这样您就不必一次性将整个文档加载到内存中。

您可以将迭代解析器限制为仅那些您感兴趣的标签。如果您只想解析`<person>`标签，请告诉您的解析器：

```
for _, element in etree.iterparse(input, tag='person'):
    # process your person data
    element.clear() 
```

通过清除循环中的元素，您可以将其从内存中释放出来。

# sql - 查询最近进行的记录

> ID：10855922
> 
> 赞同：0
> 
> 时间：2012-06-01T19:01:20.683
> 
> 标签：sql, sql-server, date

Eligibility Table [ET] 中有 Eligible [Eg] 和 Ineligible [In] 的记录。每条记录仅附有一个日期。我在服务表 [ST] 中有客户服务 [CS]，我需要确定服务日期之前最近的记录类型。

* * *

```
______________ET______________

Eg    01.01.2012  
In    01.20.2012  
Eg    01.29.2012  
In    02.10.2012  

_________________________ST______________________________  

CS  Joe Schmoe  02.01.2012 11:00 AM  
CS  Joe Schmoe  01.25.2012 1:00  PM  
CS  Harold Doe  02.09.2012 4:00  PM 
```

* * *

我想返回这样一个事实，即由于 01.01.2012 的资格记录，Joe Schmoe 在 02.01.2012 上午 11:00 的服务符合资格，Joe Schmoe 在 01.25.2012 下午 1:00 因为没有资格而没有资格获得服务2012 年 9 月 2 日下午 4:00 有资格获得服务，因为 2012 年 1 月 29 日有资格记录。

****__ *_* __ *_* __ *_* __***结果****_* __ *_* __ *_* __ *_* __ *_* __ *_* __****

 **Joe Schmoe 02.01.2012 11:00 AM 合格 01.01.2012
Joe Schmoe 01.25.2012 1:00 PM 不合格 01.20.2012
Harold Doe 02.09.2012 4:00 PM 不合格 01.29.2012

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-01T20:38:03.023

`apply` was designed for this.

```
select
    ST.fName, stETD = ST.etDate, previousET.*
from
    ST
    outer apply (
        select top 1
            ET.Status,
            ET.ETDate
        from
            ET
        where
            ET.ETDate <= ST.etDate
        order by
            ET.ETDate desc
    ) previousET
order by
    2 
```

[http://sqlfiddle.com/#!3/1c73b/11](http://sqlfiddle.com/#!3/1c73b/11)

This will get you the most recently (`order by ETDate desc`) proceeding record (`where ETDate <= ST.Date`). Thanks to [mikeY](https://stackoverflow.com/a/10856588/40822) for fiddle.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-01T19:57:02.723

我是这样做的：

[http://sqlfiddle.com/#!3/1c73b/5](http://sqlfiddle.com/#!3/1c73b/5)

```
select fname, etdate, 'eligible' as eligible
from st
where  etdate between 
(select max(etdate) from et where status ='Eg')
and
(select max(etdate) from et where status ='In')
union
select fname, etdate, 'ineligible' as eligible
from st
where  etdate not between 
(select max(etdate) from et where status ='Eg')
and
(select max(etdate) from et where status ='In')
order by 2 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-01T19:10:54.643

假设资格表中的 UserId 和 Date 具有唯一约束（否则，您将需要另一个决胜局，例如在 userid、date 上添加 row_number），您：

*   加入日期小于您感兴趣的日期（CS 日期）的所有记录
*   然后你取这些日期中的最大值（因为你想要事件之前的最后一个日期）
*   然后，您 JOIN 回到原始表以获取其余的行详细信息（状态类型）。这就是为什么您需要唯一约束

```
SELECT
   UserId, Date, Status, ETDate
FROM (
    --The last matching status record by date
    SELECT ST.UserId, ST.Date, MAX(ET.Date) as ETDate
    FROM ST
    JOIN ET ON
       ST.UserId = ET.UserId
       AND CS.Date >= ET.Date
    GROUP BY
       ST.UserId, ST.Date
) as C
JOIN ET as E ON
    C.UserId = E.UserId
    AND C.ETDate = E.ETDate 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-01T19:45:34.110

这似乎是一个奇怪的要求，因为 elibility 不在用户级别。

以下查询执行您想要的操作：

```
select et.*, st.elibility, st.ETDate
from et cross join
     (select st.*
      from st join
           (SELECT MAX(cs.Date) as lastcsDate
            FROM st JOIN
                 et
                 ON st.Date <= et.Date
            GROUP BY cs.UserId
           ) t
           on st.date = t.lastcsDate
     ) lastst 
```

注意：我没有运行此查询来原谅任何拼写错误。

这使用相关子查询来获取 et 表中每个日期或之前的最新日期。剩下的只是加入 select 子句的正确信息。**

# android - 如何在 Android 中合并两个 SimpleCursorAdapter？

> ID：10855926
> 
> 赞同：1
> 
> 时间：2012-06-01T19:01:56.043
> 
> 标签：android, sql, cursor, simplecursoradapter

我正在使用两个 SimpleCursorAdapter 在我的 Listview 中连续显示文本和图像。问题是当两次调用这些适配器时，它们会相互冲突。最后，我的 Listview 只显示了我最后调用的 SimpleCursorAdapter 的数据。

我需要做的是合并这两个 SimpleCursorAdapter，尽管它们使用不同的 sql 数据库。

有什么想法可以解决这个问题？？

```
/** Called when the activity is first created. */
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.reminder_list);
    mDbHelper = new RemindersDbAdapter(this);
    mImageHelper = new ImageAdapter(this);
    mDbHelper.open();
    mImageHelper.open();
    fillData();
    fillImages();
    registerForContextMenu(getListView());
}

//
// Fills the ListView with the data from the SQLite Database.
//
private void fillData() {
    Cursor remindersCursor = mDbHelper.fetchAllReminders();
    startManagingCursor(remindersCursor);

    // Creates an array with the task title.
    String[] from = new String[] {RemindersDbAdapter.KEY_TITLE, RemindersDbAdapter.KEY_BODY};

    // Creates an array for the text.
    int[] to = new int[] {R.id.text1, R.id.text2};

    // SimpleCursorAdapter which is displayed.
    SimpleCursorAdapter reminders = new SimpleCursorAdapter(this, R.layout.reminder_row, remindersCursor, from, to);
    setListAdapter(reminders);

}

//
// Fills the ListView with the images from the SQLite Database.
//
private void fillImages() {
    Cursor imageCursor = mImageHelper.fetchAllImages();
    startManagingCursor(imageCursor);

    // Creates an array with the image path.
    String[] fromImage = new String[] {ImageAdapter.KEY_IMAGE};

    // Creates an array for the text.
    int[] toImage = new int[] {R.id.icon};

    // SimpleCursorAdapter which is displayed.
    SimpleCursorAdapter images = new SimpleCursorAdapter(this, R.layout.reminder_row, imageCursor, fromImage, toImage);
    setListAdapter(images);
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-01T19:10:54.760

您可以使用[MergeCursor](http://developer.android.com/reference/android/database/MergeCursor.html)类将多个单独的游标公开为单个游标。由于您的适配器绑定不同的列-> 小部件，您可能必须编写自己的 SimpleCursorAdapter 子类（或只是 CursorAdapter），以便您可以根据行执行正确类型的绑定。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-01T19:17:24.027

如何创建自己的适配器（扩展 BaseAdapter），每次需要时都指向正确的数据？通过这种方式，您可以完全控制显示每个项目的时间和地点。

您甚至可以使用 2 个适配器并将它们用于新适配器。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-01T19:19:51.907

> 我需要做的是合并这两个 SimpleCursorAdapter，尽管它们使用不同的 sql 数据库。

如果两个适配器确实不同（例如，不同的行布局），请使用[my`MergeAdapter`](https://github.com/commonsguy/cwac-merge)将两个现有适配器合并为一个，然后`MergeAdapter`将`ListView`.

但是，在您的情况下，您似乎只是有两个`Cursors`内容不同，在这种情况下，superfell 的使用答案`MergeCursor`可能是更好的方法。

# hibernate - 使用休眠通过一些参数（“WHERE value = ...”）从数据库中级联删除

> ID：10855927
> 
> 赞同：0
> 
> 时间：2012-06-01T19:02:08.703
> 
> 标签：hibernate, cascade, cascading-deletes

在 Bean 类中有这个注解：

```
 class User {  
        @OneToMany(targetEntity = Feedback.class,mappedBy = "user",cascade =   
        CascadeType.ALL,fetch = FetchType.LAZY)  
    private List<Feedback> feedbacks;  
        ...  
    } 
```

我想删除有一些反馈的用户。如果我输入这个：

```
sessionFactory.getCurrentSession().delete(
sessionFactory.getCurrentSession().get(User.class, id)); 
```

用户将被成功删除，（id为主键）。但是我想删除所有用户，女巫，角色=“admin”，如果我输入这个查询：

```
String query = "DELETE from User WHERE role='" + role + "'";
    sessionFactory.getCurrentSession().createQuery(query).executeUpdate(); 
```

它将仅删除不参考反馈的用户。我的查询有什么问题？请帮忙。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T22:19:49.497

您的查询没有任何问题。HQL 删除查询不会“触及”关联。这是每个 JPA 规范。

查看Hibernate Jira 中的[这个问题](https://hibernate.onjira.com/browse/HHH-695)，了解添加对添加新关键字 CASCADE 的支持以删除用于指定关联的查询，这些关联也应该被删除。

# hibernate - 我如何处理 HQL，多对多？

> ID：10855930
> 
> 赞同：16
> 
> 时间：2012-06-01T19:02:22.977
> 
> 标签：hibernate

![在此处输入图像描述](../Images/090a252ac94d3c9a08987721d96b7cd4.png)

这是我的数据库结构。多对多的关系。我想选择写过同一本书的作者。使用 SQL，我做到了。如何使用 HQL？

```
 Query query = session.createSQLQuery("SELECT FirstName, LastName FROM authors, books, author_book as ab WHERE ab.authorID=authors.authorID AND ab.bookID = books.bookID AND ab.bookID = :id");
   query.setInteger("id", 1);
   List list = query.list();
   Iterator<Object[]> iter = list.iterator();
   while (iter.hasNext()) {
       Object[] obj = iter.next();
       System.out.println(obj[0] + " " + obj[1]);
    } 
```

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2012-06-01T22:13:52.133

假设实体名称是 Book 和 Author 并且 Book 具有 authors 属性：

```
select a.firstName, a.lastName from Book b join b.authors a where b.id = :id 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-02T10:05:23.087

让我们以实体 Authors、Books 和 AuthorBook 为例。

您可以尝试以下查询。

```
String hql = "select a.firstName, a.lastName from Authors a, Books b, AuthorBook ab where ab.authorId=a.authorId and ab.bookId=b.bookId and ab.bookId=:id";

List<Object[]> resultList = session.createQuery(hql).setInteger("id", 1).list();

for(Object[] result : resultList)
{

        System.out.println("First Name : " + result[0]);
        System.out.println("Last Name : " + result[1]);
} 
```

# android - 在启动时启动服务

> ID：10855931
> 
> 赞同：0
> 
> 时间：2012-06-01T19:02:25.080
> 
> 标签：android, service

我在尝试在 android 启动时启动服务时遇到问题，只要手机启动我的应用程序就会出错并且必须停止它。这里是：

我的清单的一部分：

```
<service
    android:name=".EventsNotificationService"
    android:label="EventsNotificationService">
    <intent-filter>
        <action
            android:name="it.bloomp.service.EventsNotificationService" />
    </intent-filter>
/service>

<receiver
    android:name=".receiver.StartEventsNotificationService"
    android:enabled="true"
    android:exported="true"
    android:label="StartEventsNotificationService">
    <intent-filter>
        <action
            android:name="android.intent.action.BOOT_COMPLETED" />
    </intent-filter>
</receiver> 
```

我的服务：

```
package it.bloomp.service;

import android.app.Service;
import android.content.Intent;
import android.os.IBinder;
import android.widget.Toast;

public class EventsNotificationService extends Service {

    @Override
    public IBinder onBind(Intent intent) {
        return null;
    }

    @Override
    public void onCreate() {
        super.onCreate();
        Toast.makeText(this,"Service created", Toast.LENGTH_LONG).show();
    }

    @Override
    public void onDestroy() {
        super.onDestroy();
        Toast.makeText(this,"Service destroyed", Toast.LENGTH_LONG).show();
    }

    @Override
    public void onStart(Intent intent, int startId) {
        super.onCreate();
        Toast.makeText(this,"Service started", Toast.LENGTH_LONG).show();
    }
} 
```

我的服务启动器：

```
package it.bloomp.service;

import android.content.BroadcastReceiver;
import android.content.Context;
import android.content.Intent;

public class StartEventsNotificationService extends BroadcastReceiver {

    @Override
    public void onReceive(Context context, Intent intent) {
        if ("android.intent.action.BOOT_COMPLETED".equals(intent.getAction())) {
            Intent serviceIntent = new Intent("it.bloomp.service.EventsNotificationService");
            context.startService(serviceIntent);
        }
    }
} 
```

此外，这会使服务在启动时启动，但我怎样才能让它一直运行呢？

**编辑：**

例外情况：

> 06-01 16:58:55.716: E/AndroidRuntime(483): 致命异常: main 06-01 16:58:55.716: E/AndroidRuntime(483): java.lang.RuntimeException: 无法实例化接收器 it.bloomp。 activity.receiver.StartEventsNotificationService: java.lang.ClassNotFoundException: it.bloomp.activity.receiver.StartEventsNotificationService 06-01 16:58:55.716: E/AndroidRuntime(483): at android.app.ActivityThread.handleReceiver(ActivityThread.java: 2100) 06-01 16:58:55.716: E/AndroidRuntime(483): 在 android.app.ActivityThread.access$1500(ActivityThread.java:123) 06-01 16:58:55.716: E/AndroidRuntime(483):在 android.app.ActivityThread$H.handleMessage(ActivityThread.java:1197) 06-01 16:58:55.716: E/AndroidRuntime(483): 在 android.os.Handler.dispatchMessage(Handler.java:99) 06- 01 16:58:55.716：E/AndroidRuntime(483)：在 android.os.Looper。循环(Looper.java:137) 06-01 16:58:55.716: E/AndroidRuntime(483): 在 android.app.ActivityThread.main(ActivityThread.java:4424) 06-01 16:58:55.716: E/ AndroidRuntime(483): at java.lang.reflect.Method.invokeNative(Native Method) 06-01 16:58:55.716: E/AndroidRuntime(483): at java.lang.reflect.Method.invoke(Method.java: 511) 06-01 16:58:55.716: E/AndroidRuntime(483): 在 com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:784) 06-01 16:58:55.716: E/ AndroidRuntime(483): 在 com.android.internal.os.ZygoteInit.main(ZygoteInit.java:551) 06-01 16:58:55.716: E/AndroidRuntime(483): 在 dalvik.system.NativeStart.main(Native方法）06-01 16:58:55.716：E/AndroidRuntime（483）：引起：java.lang.ClassNotFoundException：it.bloomp.activity.receiver.StartEventsNotificationService 06-01 16:58:55.716：E/AndroidRuntime(483): 在 dalvik.system.BaseDexClassLoader.findClass(BaseDexClassLoader.java:61) 06-01 16:58:55.716: E/AndroidRuntime(483): 在 java.lang.ClassLoader.loadClass(ClassLoader.java :501) 06-01 16:58:55.716: E/AndroidRuntime(483): 在 java.lang.ClassLoader.loadClass(ClassLoader.java:461) 06-01 16:58:55.716: E/AndroidRuntime(483):在 android.app.ActivityThread.handleReceiver(ActivityThread.java:2095) 06-01 16:58:55.716: E/AndroidRuntime(483): ... 10 更多ActivityThread.handleReceiver(ActivityThread.java:2095) 06-01 16:58:55.716: E/AndroidRuntime(483): ... 10 更多ActivityThread.handleReceiver(ActivityThread.java:2095) 06-01 16:58:55.716: E/AndroidRuntime(483): ... 10 更多

编辑2：

我的清单：

```
<?xml version="1.0" encoding="utf-8"?>
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
    package="it.bloomp.activity"
    android:versionCode="1"
    android:versionName="1.0" >

    <uses-permission android:name="android.permission.RECEIVE_BOOT_COMPLETED" />
    <uses-permission android:name="android.permission.ACCESS_NETWORK_STATE" />    
    <uses-permission android:name="android.permission.INTERNET" />

    <uses-sdk
        android:minSdkVersion="4"
        android:targetSdkVersion="15" />

    <application
        android:icon="@drawable/ic_launcher"
        android:label="@string/app_name"
        android:theme="@android:style/Theme.NoTitleBar" >
        <activity
            android:name=".EventsListActivity"
            android:label="@string/app_name" >
            <intent-filter>
                <action android:name="android.intent.action.MAIN" />

                <category android:name="android.intent.category.LAUNCHER" />
            </intent-filter>
        </activity>

        <activity
            android:name=".EventActivity"/>

        <service android:name=".EventsNotificationService" android:label="EventsNotificationService">
            <intent-filter>
                <action android:name="it.bloomp.service.EventsNotificationService" />
            </intent-filter>
        </service>

        <receiver
            android:name=".StartEventsNotificationService"
            android:enabled="true"
            android:exported="true"
            android:label="StartEventsNotificationService">
            <intent-filter>
                <action android:name="android.intent.action.BOOT_COMPLETED" />
            </intent-filter>
        </receiver>

    </application>

</manifest> 
```

我的服务：

```
package it.bloomp.service;

import android.app.Service;
import android.content.Intent;
import android.os.IBinder;
import android.widget.Toast;

public class EventsNotificationService extends Service {

    @Override
    public IBinder onBind(Intent intent) {
        return null;
    }

    @Override
    public void onCreate() {
        super.onCreate();
        System.out.println("Service created.");
    }

    @Override
    public void onDestroy() {
        super.onDestroy();
        System.out.println("Service destroyed.");
    }

    @Override
    public void onStart(Intent intent, int startId) {
        super.onCreate();
        System.out.println("Service started.");
    }
} 
```

我的服务启动器：

```
package it.bloomp.service;

import android.content.BroadcastReceiver;
import android.content.Context;
import android.content.Intent;

public class StartEventsNotificationService extends BroadcastReceiver {

    @Override
    public void onReceive(Context context, Intent intent) {
        if ("android.intent.action.BOOT_COMPLETED".equals(intent.getAction())) {
            Intent serviceIntent = new Intent("it.bloomp.service.EventsNotificationService");
            context.startService(serviceIntent);
        }
    }
} 
```

我的例外：

> 06-03 15:37:36.142: E/AndroidRuntime(479): 致命异常: main 06-03 15:37:36.142: E/AndroidRuntime(479): java.lang.RuntimeException: 无法实例化接收器 it.bloomp。 activity.StartEventsNotificationService: java.lang.ClassNotFoundException: it.bloomp.activity.StartEventsNotificationService 06-03 15:37:36.142: E/AndroidRuntime(479): at android.app.ActivityThread.handleReceiver(ActivityThread.java:2100) 06- 03 15:37:36.142: E/AndroidRuntime(479): 在 android.app.ActivityThread.access$1500(ActivityThread.java:123) 06-03 15:37:36.142: E/AndroidRuntime(479): 在 android.app .ActivityThread$H.handleMessage(ActivityThread.java:1197) 06-03 15:37:36.142: E/AndroidRuntime(479): 在 android.os.Handler.dispatchMessage(Handler.java:99) 06-03 15:37 :36.142: E/AndroidRuntime(479): 在 android.os.Looper.loop(Looper.java:137) 06-03 15:37:36.142: E/AndroidRuntime(479): 在 android.app.ActivityThread.main(ActivityThread.java:4424) 06-03 15:37:36.142: E/AndroidRuntime(479) : 在 java.lang.reflect.Method.invokeNative(Native Method) 06-03 15:37:36.142: E/AndroidRuntime(479): 在 java.lang.reflect.Method.invoke(Method.java:511) 06- 03 15:37:36.142: E/AndroidRuntime(479): 在 com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:784) 06-03 15:37:36.142: E/AndroidRuntime(479) : 在 com.android.internal.os.ZygoteInit.main(ZygoteInit.java:551) 06-03 15:37:36.142: E/AndroidRuntime(479): 在 dalvik.system.NativeStart.main(Native Method) 06- 03 15:37:36.142: E/AndroidRuntime(479): 原因: java.lang.ClassNotFoundException: it.bloomp.activity.StartEventsNotificationService 06-03 15:37:36.142: E/AndroidRuntime(479):在 dalvik.system.BaseDexClassLoader.findClass(BaseDexClassLoader.java:61) 06-03 15:37:36.142: E/AndroidRuntime(479): 在 java.lang.ClassLoader.loadClass(ClassLoader.java:501) 06-03 15 :37:36.142: E/AndroidRuntime(479): 在 java.lang.ClassLoader.loadClass(ClassLoader.java:461) 06-03 15:37:36.142: E/AndroidRuntime(479): 在 android.app.ActivityThread。 handleReceiver(ActivityThread.java:2095) 06-03 15:37:36.142: E/AndroidRuntime(479): ... 10 更多handleReceiver(ActivityThread.java:2095) 06-03 15:37:36.142: E/AndroidRuntime(479): ... 10 更多handleReceiver(ActivityThread.java:2095) 06-03 15:37:36.142: E/AndroidRuntime(479): ... 10 更多

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T19:13:01.950

我在清单文件中看不到权限。您应该添加：

```
<uses-permission android:name="android.permission.RECEIVE_BOOT_COMPLETED" /> 
```

此外，首先尝试检查日志中是否启动了服务。在那之后只做吐司，也许问题就在那里。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-01T20:07:12.243

android:name=".receiver.StartEventsNotificationService"

可能应该是

android:name=".StartEventsNotificationService"

编辑

试试这个作为你的意图：

Intent i = new Intent(context, EventNotificationService.class);

此外，您应该更新收到的错误。鉴于您从清单和服务启动代码中显示的内容，它不能与您所拥有的相同。尝试自己阅读错误并遵循它们指向的位置，学习如何有效地做到这一点将为您节省大量的 StackOverflow 时间，并且比仅仅询问其他人会教给您很多。

# javascript - Javascript数组不使用for循环变量

> ID：10855933
> 
> 赞同：2
> 
> 时间：2012-06-01T19:02:38.463
> 
> 标签：javascript, google-maps-api-3

我有一个数组，其中包含与我创建的 Google Maps Polygon Objects 同名的字符串。我想遍历数组以设置特定选项。这是代码：

```
for (var i = 0; i < statesPoly.length; i++) {
    google.maps.event.addListener(statesPoly[i], 'mouseover', function() {
        statesPoly[i].setOptions({ strokeWeight: '2' });
    });
} 
```

执行时，我得到“无法调用未定义的方法'setOptions'”，因为脚本似乎在字面上使用 statesPoly[i]。例如，当我将 statesPoly[i] 替换为 statesPoly[11] 时，脚本会按预期工作。

当我尝试这样的事情时，循环也按预期工作：

```
for (var i = 0; i < statesPoly.length; i++) {
    alert(statesPoly[i].strokeColor);
} 
```

我究竟做错了什么？

更新：

这里越来越近。我相信`this`在某些情况下使用的原因是因为我的函数需要一个对象并且我给它一个字符串。会是这样吗？

```
alert(statesPoly[0]);
        google.maps.event.addListener(sarawakPoly, 'mouseover', function() {
            $("#"+statesPoly[0]).addClass("highlight");
            sarawakPoly.setOptions({ strokeWeight: '2' });
            //infowindow.open(map,marker);
        }); 
```

上面的代码将通过 SarawakPoly 发出警报，并且使用 statesPoly[0] 作为 ID 中的字符串可以按预期工作。这

```
 alert(statesPoly[0]);
        google.maps.event.addListener(statesPoly[0], 'mouseover', function() {
            $("#"+statesPoly[0]).addClass("highlight");
            statesPoly[0].setOptions({ strokeWeight: '2' });
            //infowindow.open(map,marker);
        }); 
```

不起作用，因为“未捕获的类型错误：无法读取未定义的属性‘鼠标悬停’”

如果我是对的，如何让我的 JS 将我的数组变量转换为对象？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-01T19:07:32.273

这是 JavaScript 代码中非常常见的错误：

```
for (var i = 0; i < n; i++) {
    registerSomeCallback(function () {
        console.log(i);
    });
} 
```

在每次循环迭代中，变量`i`都会递增，并且由于 JavaScript 的[词法作用域](https://stackoverflow.com/questions/1047454/what-is-lexical-scope)，在每次迭代中定义的函数共享相同的`i`变量。这意味着当调用回调时（在您的情况下发生 Google Maps 事件时），`i`将始终是循环到达的最后一个值。

就好像你正在这样做：

```
var i, fn;

i = 0;
fn = function () { alert(i); };
fn(); // will alert "0"
i = 1;
fn(); // i has changed, will now alert "1"
i = 2;
fn(); // i has changed again, will now alert "2" 
```

您需要确保循环的每次迭代都有一个新的变量范围，例如：

```
for (var i = 0; i < n; i++) {
    (function (n) {
        registerSomeCallback(function () {
            console.log(n);
        });
    }(i));
} 
```

在此版本的代码中，每个回调都在其自己的变量范围内定义，并带有自己的计数器变量（您仍然可以调用它`i`，但我调用`n`它是为了使示例更清晰）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-01T19:06:04.653

您可以尝试`this`改用吗？

```
 for (var i = 0; i < statesPoly.length; i++) {
      (function(i) {
        google.maps.event.addListener(statesPoly[i], 'mouseover', function() {
            this.setOptions({ strokeWeight: '2' });
        });
       })(i);
    } 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-01T19:10:08.420

statesPoly[i] 未定义，因为您的变量 i 未在您附加到事件侦听器的新函数中定义。

您可以在这里做几件事，但最简单的方法是将这个变量传递给函数。像这样的东西：

```
google.maps.event.addListener(statesPoly[i], 'mouseover', function(i) {
  statesPoly[i].setOptions({ strokeWeight: '2' });
}); 
```

# java - 两个带有依赖注入的单例实例（Google Guice）

> ID：10855937
> 
> 赞同：2
> 
> 时间：2012-06-01T19:02:55.037
> 
> 标签：java, dependency-injection, guice

我正在使用依赖注入 Google Guice 框架开发一个项目。

在 Guice 中，可以将类与单例范围绑定为：

```
bind(Foo.class).to(FooImpl.class).in(Scopes.SINGLETON); 
```

如果`FooImpl`类本身是一个真正的单例类：

```
public class FooImpl implements Foo{
    public static final FooImpl INSTANCE = new FooImpl();
    public static FooImpl getInstance(){...}
    // ...
} 
```

或者

```
public class FooImpl implements Foo{
    private FooImpl instance = null;

    private FooImpl(){...}
    public static FooImpl getInstance(){
         if(instance == null)
             instance = new FooImpl();
         return FooImpl();
         // ...
    }

    // ...
} 
```

因此，可以在项目中声明两个单例，第一个由 Guice 声明，第二个由`getInstance()`传统方式声明。

Google Guice 还可以使用该`toInstance()`方法将接口绑定到特定实例。

因此，在 Java 中使用以下声明来绑定 Singleton，而不应该是绑定 Singleton 的更好方法：

```
bind(Foo.class).toInstance(FooImpl.getInstance()); 
```

而不是第一个？它更安全吗？是否有可能以这种方式拥有两个单例实例？

使用 Google Guice 声明单例的最佳方式是什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-01T19:56:10.180

您建议的第一种方法是首选：

```
bind(Foo.class).to(FooImpl.class).in(Scopes.SINGLETON); 
```

这允许 Guice`FooImpl`根据需要执行依赖注入。使用您上次建议的方法手动绑定到实例时，这是*不可能的。*`toInstance()`

最后，Singleton 设计模式[是一种反模式，原因有很多](http://misko.hevery.com/2008/08/25/root-cause-of-singletons/)。注意这里指的是使用`getInstance()`等的实现；在您的应用程序的生命周期内拥有一个类的单个实例（如 Guice`SINGLETON`范围内的对象）无论如何都*不错*。

另请参阅[Guice 关于范围的页面，](http://code.google.com/p/google-guice/wiki/Scopes)了解单例范围的一些使用指南。

# cocoa - 从 Nib 加载 NSViewController

> ID：10855938
> 
> 赞同：2
> 
> 时间：2012-06-01T19:02:56.620
> 
> 标签：cocoa, appkit, nsviewcontroller

我可以像通常在 UIKit 中使用 initWithNibName:bundle: 那样加载 NSViewController 及其视图和 Nib 文件中的所有子视图吗？在 AppKit 中，我可以使用该消息加载 NSWindowController，但如果我尝试加载 NSViewController，虽然视图不是 nil，但它不会显示。有没有已知的方法可以做到这一点？

编辑：如果我使用 addSubview: 以编程方式添加视图，它会起作用，如果我使用主笔尖中的自定义视图的插座然后替换它则不起作用。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-30T14:30:29.607

也许问题在于，当您尝试以这种方式加载视图时，它只是“延迟加载”。
之后，您应该尝试从该视图访问某些内容以使视图完全加载和显示。

# .net - WPF Datagrid COMException 使用 IncludeHeader ClipboardCopyMode

> ID：10855940
> 
> 赞同：9
> 
> 时间：2012-06-01T19:03:01.900
> 
> 标签：.net, wpf, wpfdatagrid, clipboard

在我的 WPF 应用程序中，我使用了一个`Datagrid`控件；在控件定义中，我将`ClipboardCopyMode`属性定义为“IncludeHeader”。

```
<DataGrid Name="datagrid"  ClipboardCopyMode="IncludeHeader">
</DataGrid> 
```

有时，当我尝试从网格复制任何数据时，我遇到`HRESULT`剪贴板崩溃错误 -

```
System.Runtime.InteropServices.COMException (0x800401D0): 
OpenClipboard Failed (Exception from HRESULT: 0x800401D0 (CLIPBRD_E_CANT_OPEN)) 
```

任何解决它的建议。我查看了其他帖子，主要是关于当您明确使用`Clipboard`相关方法但与`Datagrid`.

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-05T07:45:43.327

[在http://blogs.infragistics.com/forums/t/35379.aspx](http://blogs.infragistics.com/forums/t/35379.aspx)从 Andrew Smith 那里找到这个-

> 从技术上讲，只有一个进程可以打开剪贴板，因此如果另一个进程打开了它，则后续请求将失败，直到第一个释放剪贴板。这是在 WinForms Clipboard 类中处理的，它会在每次尝试之间延迟重试集合，但 WPF 剪贴板类不会这样做，因此如果它在第一次显示时失败，则会发生异常。即使这样，我们也应该捕获异常并在它仍然失败时引发剪贴板操作错误。

解释了同样的事情，并在这个意大利博客上提到了一些修复它的方法 -

> [WPF DataGrid 剪贴板 BUG (?) & 工作](http://blogs.wpfitalia.it/ainotame/archive/2011/03/22/WPF-DataGrid-Clipboard-BUGampWorkaround.aspx)
> 
> [谷歌翻译](http://translate.google.co.in/translate?sl=it&tl=en&js=n&prev=_t&hl=en&ie=UTF-8&layout=2&eotf=1&u=http://blogs.wpfitalia.it/ainotame/archive/2011/03/22/WPF-DataGrid-Clipboard-BUGampWorkaround.aspx)

以下 MSDN 论坛帖子建议这可能是特定于机器的问题，您可以在其他机器上重现此问题吗？-

> [从 DataGrid 复制到剪贴板时出现 CLIPBRD_E_CANT_OPEN 异常](http://social.msdn.microsoft.com/Forums/fi/wpf/thread/02b733e0-838d-46d6-952f-5483db32282d)

**更新：**

博客链接似乎已关闭，但可以通过此链接访问缓存版本 -

[WPF DataGrid 剪贴板 BUG (?) & 工作（缓存翻译）](http://translate.google.co.in/translate?hl=en&sl=it&tl=en&u=http%3A%2F%2Fweb.archive.org%2Fweb%2F20120408210239%2Fhttp%3A%2F%2Fblogs.wpfitalia.it%2Fainotame%2Farchive%2F2011%2F03%2F22%2Fwpf-datagrid-clipboard-bugampworkaround.aspx&sandbox=1)

# android - Android ListActivity 和 TabActivity 在同一个类中

> ID：10855941
> 
> 赞同：1
> 
> 时间：2012-06-01T19:03:03.943
> 
> 标签：android, listactivity, tabactivity

我有一个要使用 ListView 显示的字符串数组。我在网上查了一下，发现可以通过从ListActivity扩展我的类来完成。但我面临一个问题。在我的应用程序中，我已经继承了 TabActivity。现在，我不能继承多个类。现在我该怎么做 ？我需要保留选项卡并在 ListView 中生成字符串。欢迎所有建议。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-01T19:08:32.583

幸运的是，您*不需要*继承自来`ListActivity`使用`ListView`. 唯一继承自`ListActivity`buys 你的是它会自动`ListView`在你的布局中找到一个带有属性`android:id="@android:id/list"`的 a ，并添加一个辅助方法来设置列表的适配器（以及其他一些可以在`ListView`自身上访问的辅助方法）。

因此，在您的情况下，由于您不能从多个类继承，您可以保留超类`TabActivity`并简单地调用`findViewById`来查找您的，`ListView`然后手动调用[setAdapter](http://developer.android.com/reference/android/widget/ListView.html#setAdapter%28android.widget.ListAdapter%29)`ListView`。

# java - 无法裁剪位图

> ID：10855948
> 
> 赞同：0
> 
> 时间：2012-06-01T19:03:58.447
> 
> 标签：java, android

我正在尝试裁剪和缩放给定的位图，但只有缩放有效。
我究竟做错了什么？

```
private Bitmap CropAndShrinkBitmap(Bitmap io_BitmapFromFile, int i_NewWidth, int i_NewHeight) 
{
    int cuttingOffset = 0;
    int currentWidth = i_BitmapFromFile.getWidth();
    int currentHeight = i_BitmapFromFile.getHeight();

    if(currentWidth > currentHeight)
    {
        cuttingOffset = currentWidth - currentHeight;
        Bitmap.createBitmap(i_BitmapFromFile, cuttingOffset/2, 0, currentWidth - cuttingOffset, currentHeight);
    }
    else
    {
        cuttingOffset = i_NewHeight - currentWidth;
        Bitmap.createBitmap(i_BitmapFromFile, 0, cuttingOffset/2, currentWidth, currentHeight - cuttingOffset);
    }
    Bitmap fixedBitmap = Bitmap.createScaledBitmap(i_BitmapFromFile, i_NewWidth, i_NewHeight, false)  ;

    return i_BitmapFromFile;
} 
```

描述说：“createBitmap 返回一个不可变的位图”。
那什么意识？这是我问题的原因吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T20:33:48.817

默认情况下，位图是“不可变的”，这意味着您无法更改它们。您需要创建一个可编辑的“可变”位图。

查看这些链接以了解如何执行此操作：

[BitmapFactory.decodeResource 在 Android 2.2 中返回一个可变位图，在 Android 1.6 中返回一个不可变位图](https://stackoverflow.com/questions/4349075/bitmapfactory-decoderesource-returns-a-mutable-bitmap-in-android-2-2-and-an-immu)

[http://sudarnimalan.blogspot.com/2011/09/android-convert-immutable-bitmap-into.html](http://sudarnimalan.blogspot.com/2011/09/android-convert-immutable-bitmap-into.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-01T20:42:58.123

裁剪可能工作正常，但是`Bitmap`裁剪的结果对象是从**返回**的`createBitmap()`，原始对象没有被修改（如前所述，因为`Bitmap`实例是不可变的）。如果你想要裁剪的结果，你必须获取返回值。

```
Bitmap cropped = Bitmap.createBitmap(i_BitmapFromFile, cuttingOffset/2, 0, currentWidth - cuttingOffset, currentHeight); 
```

然后，您可以根据该结果进行任何进一步的工作。

高温高压

# delphi - Delphi 内联代码设计

> ID：10855950
> 
> 赞同：0
> 
> 时间：2012-06-01T19:04:11.727
> 
> 标签：delphi, inline

我有以下代码：

```
procedure p1(const s:string);
var i,l:integer;

  function skip:boolean; //inline not possible
  begin
    while (i<=l) and (s[i]<=' ') do inc(i);
    result:=i<=l;
  end;

begin
  //skip() is VERY often called here
end;

procedure p2(const s:string);

  function skip(const s:string;var i:integer;l:integer):boolean;inline; 
  begin
    while (i<=l) and (s[i]<=' ') do inc(i);
    result:=i<=l;
  end;

var i,l:integer;
begin
  //skip(s,i,l) is VERY often called here
end; 
```

你更喜欢哪一个？第一个可读性更好，但速度较慢，因为 skip() 不能内联。第二种更快，但很丑，因为每次都必须指定所有参数。你知道另一个好的可读和快速的解决方案吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-01T19:10:37.613

不要过早优化。

**除非您真的**需要性能提升，否则请坚持使用更清晰的代码。

更清晰的是第二个。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-01T19:57:18.240

第二个更清晰。我并不教条地反对使用全局变量，但第二个例子看起来更干净。

由于第二个示例也更快......那么你的答案很简单。第2个。

....作为旁注，如果您真的需要这么快的速度，内联汇编和展开循环可能是可能的选择...但我不知道如何使用此代码，或者如果那会有所作为。

# python - Pyparsing：提取可变长度、可变内容、可变空白子串

> ID：10855951
> 
> 赞同：2
> 
> 时间：2012-06-01T19:04:17.283
> 
> 标签：python, bioinformatics, pyparsing, medical

我需要从前列腺切除术最终诊断报告的平面文件中提取 Gleason 分数。这些分数总是有 Gleason 这个词和两个数字相加成另一个数字。人类在二十多年内输入了这些。包括各种空格和修饰符的约定。以下是迄今为止我的 Backus-Naur 表格，以及两个示例记录。仅针对前列腺切除术，我们正在研究超过一千个病例。

我使用 pyparsing 是因为我正在学习 python，并且对我对正则表达式写作的有限接触没有美好的回忆。

我的问题：如何在不解析可能出现在这些最终诊断中或可能不在这些最终诊断中的所有其他可选数据的情况下提取这些 Gleason 等级？

```
num = Word(nums)
record ::= accessionDate + accessionNumber + patMedicalRecordNum + finalDxText
accessionDate ::= num + "/" + num + "/" num
accessionNumber ::= "S" + num + "-" + num
patMedicalRecordNum ::= num + "/" + num + "-" + num + "-" + num
finalDxText ::= listOfParts + optionalComment + optionalpTNMStage
listOfParts ::= OneOrMore(part)
part ::= <multiline idiosyncratic freetext which may contain a Gleason score I want> + optionalpTNMStage
optionalComment ::= <multiline idiosyncratic freetext which may contain a Gleason score I don't want>
optionalpTNMStage ::= <multiline idiosyncratic freetext which may contain a Gleason score I don't want>

01/01/11  S11-55555 20/444-55-6666 A.  PROSTATE AND SEMINAL VESICLES, PROSTATECTOMY:                           
                                   -  ADENOCARCINOMA.                                                      

                                   TOTAL GLEASON SCORE:  GLEASON 5+4=9                                     
                                   TUMOR LOCATION:  BILATERAL                                              
                                   TUMOR QUANTITATION:  15% OF PROSTATE INVOLVED BY TUMOR                  
                                   EXTRAPROSTATIC EXTENSION:  PRESENT AT RIGHT POSTERIOR                   
                                   SEMINAL VESICLE INVASION:  PRESENT                                      
                                   MARGINS:  UNINVOLVED                                                    
                                   LYMPHOVASCULAR INVASION:  PRESENT                                       
                                   PERINEURAL INVASION:  PRESENT                                           
                                   LYMPH NODES (SPECIMENS B AND C):                                        
                                      NUMBER EXAMINED:  25                                                 
                                      NUMBER INVOLVED:  1                                                  
                                      DIAMETER OF LARGEST METASTASIS:  1.7 mm                              
                                   ADDITIONAL FINDINGS:  HIGH-GRADE PROSTATIC INTRAEPITHELIAL NEOPLASIA,   
                                      ACUTE AND CHRONIC INFLAMMATION, INTRADUCTAL EXTENSION OF INVASIVE    
                                      CARCINOMA                                                            

                                   PATHOLOGIC STAGE:  pT3b N1 MX                                           

                               B.  LYMPH NODES, RIGHT PELVIC, EXCISION:                                    
                                   -  ONE OF SEVENTEEN LYMPH NODES POSITIVE FOR METASTASIS (1/17).         

                               C.  LYMPH NODES, LEFT PELVIC, EXCISION:                                     
                                   -  EIGHT LYMPH NODES NEGATIVE FOR METASTASIS (0/8).                     
01/02/11  S11-4444 20/111-22-3333 PROSTATE AND SEMINAL VESICLES, PROSTATECTOMY:                               
                                  - ADENOCARCINOMA.                                                        
                                    GLEASON SCORE:  3 + 3 = 6 WITH TERTIARY PATTERN OF 5\.                                             
                                    TUMOR QUANTITATION:  APPROXIMATELY 10% BY VOLUME.                      
                                    TUMOR LOCATION:  BILATERAL.                                            
                                    EXTRAPROSTATIC EXTENSION:  NOT IDENTIFIED.                             
                                    MARGINS:  NEGATIVE.                                                    
                                    PERINEURAL INVASION:  IDENTIFIED.                                      
                                    LYMPH-VASCULAR INVASION:  NOT IDENTIFIED.                              
                                    SEMINAL VESICLE/VASA DEFERENTIA INVASION: NOT IDENTIFIED.              
                                    LYMPH NODES:  NONE SUBMITTED.                                          
                                    OTHER:  HIGH GRADE PROSTATIC INTRAEPITHELIAL NEOPLASIA.                
                               PATHOLOGIC STAGE (pTNM):  pT2c NX. 
```

全面披露：我是一名从事研究的医生；这是我第一次真正使用 python 工作。我读过 Lutz 的 Learning Python，Shaw 的 Learning Python the Hard Way，并解决了各种问题集。我在这个论坛 pyparsing wiki 上查看了许多与 pyparsing 相关的问题，我购买并阅读了 McGuire 先生的 Pyparsing 入门。也许我在问一个问题，当我真的应该被告知我正站在“当你必须编写解析器时，这种沮丧的死亡螺旋很常见”（McGuire，17）？我不知道。到目前为止，我很高兴能够从事可能实际上是一个真正的项目。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-01T19:18:16.537

看一下 pyparsing 中的 SkipTo 解析元素。如果你为 num+num=num 部分定义了一个 pyparsing 结构，你应该能够使用 SkipTo 跳过“Gleason”和那个之间的任何内容。大致像这样（未经测试的伪pyparsing）：

```
score = num + "+" + num + "=" num
Gleason = "Gleason" + SkipTo(score) + score 
```

PyParsing 默认会跳过空格，使用 SkipTo 你可以跳过任何与你想要的格式不匹配的东西。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-01T21:03:42.310

这是一个提取患者数据和任何匹配的 Gleason 数据的示例。

```
from pyparsing import *
num = Word(nums)
accessionDate = Combine(num + "/" + num + "/" + num)("accDate")
accessionNumber = Combine("S" + num + "-" + num)("accNum")
patMedicalRecordNum = Combine(num + "/" + num + "-" + num + "-" + num)("patientNum")
gleason = Group("GLEASON" + Optional("SCORE:") + num("left") + "+" + num("right") + "=" + num("total"))
assert 'GLEASON 5+4=9' == gleason
assert 'GLEASON SCORE:  3 + 3 = 6' == gleason

patientData = Group(accessionDate + accessionNumber + patMedicalRecordNum)
assert '01/02/11  S11-4444 20/111-22-3333' == patientData

partMatch = patientData("patientData") | gleason("gleason")

lastPatientData = None
for match in partMatch.searchString(data):
    if match.patientData:
        lastPatientData = match
    elif match.gleason:
        if lastPatientData is None:
            print "bad!"
            continue
        print "{0.accDate}: {0.accNum} {0.patientNum} Gleason({1.left}+{1.right}={1.total})".format(
                        lastPatientData.patientData, match.gleason
                        ) 
```

印刷：

```
01/01/11: S11-55555 20/444-55-6666 Gleason(5+4=9)
01/02/11: S11-4444 20/111-22-3333 Gleason(3+3=6) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-01T19:45:31.670

```
gleason = re.compile("gleason\d+\d=\d")
scores = set()
for record in records:
    for line in record.lower().split("\n"):
        if "gleason" in line:
            scores.add(gleason.match(line.replace(" ", "")).group(0)[7:]) 
```

或者其他的东西

# c++ - async_wait() 处理程序的实际签名

> ID：10855955
> 
> 赞同：0
> 
> 时间：2012-06-01T19:04:25.417
> 
> 标签：c++, boost, boost-asio, boost-bind

我有一个两层对象结构，其中包含的对象有一个deadline_timer，外部对象有处理函数，如：

```
class Internal
{
    asio::deadline_timer t;
public:
    void QueueTick(void (*handler)(boost::system::error_code const&))
    {
       t.expires_from_now(posix_time::millisec(250));
       t.async_wait(handler);
    }
};

class ForClients
{
    Internal I;
    void OnTick(boost::system::error_code const&) { /*...*/ }
    void Init()
    {
        I.QueueTick(boost::bind(&cdevXcite::OnTick, this, _1));
    }
}; 
```

该`QueueTick()`调用无法在 MSVS 2008 中编译，并显示“无法将参数 1 从 'boost::_bi::bind_t' 转换为 'void (__cdecl *)(const boost::system::error_code &)'”。

如果我公开计时器成员并使用相同的参数直接调用`I.t.async_wait()`，它会成功。显然，处理程序的签名比我在`QueueTick`声明中使用的更特殊；但是，我找不到定义它的符号，而且我不知道如何解释`basic_deadline_timer<>`模板内正在进行的元编程。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-01T22:21:53.687

如果您可以使用 C++11，则可以执行以下操作：

```
class Internal
{
    asio::deadline_timer t;

public:
    void QueueTick(const std::function<void(const boost::system::error_code&)>& handler)
    {
        t.expires_from_now(posix_time::millisec(250));
        t.async_wait(handler);
    }
};

class ForClients
{
    Internal I;
    void OnTick(const boost::system::error_code& ec) { /*...*/ }
    void Init()
    {
        I.QueueTick([this](const boost::system::error_code& ec) { OnTick(ec); });
    }
}; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-02T02:59:42.467

`async_wait`可以使用任何可以使用参数调用的可调用类型来调用asio 计时器`boost::system::error_code const&`。任何地方都没有定义它的单一类型，它只需要可以使用记录的参数类型进行调用。

QueueTick 参数的类型就是这样一种可调用类型，它是指向具有正确签名的普通 ol' 非成员函数的指针：

```
void QueueTick(void (*handler)(boost::system::error_code const&)) 
```

但结果`boost::bind`是一个类类型重载`operator()`，不能转换为该函数指针类型。

有几种方法可以解决这个问题，但最简单的可能是跟随`async_wait`自己并将 QueueTick 编写为函数模板，接受任何类型：

```
class Internal
{
  asio::deadline_timer t;
public:
  template<WaitHandle>
    void QueueTick(WaitHandle handler)
    {
      t.expires_from_now(posix_time::millisec(250));
      t.async_wait(handler);
    }
}; 
```

其余代码将保持不变。

如果这不是一个选项（例如，因为 QueueTick 需要是虚拟的），那么您可以使用`boost::function`with 可以保存正确签名的任何可调用对象：

```
class Internal
{
  asio::deadline_timer t;
public:
  typedef boost::function<void(boost::system::error_code const&)> handler_type;
  void QueueTick(handler_type handler)
    {
      t.expires_from_now(posix_time::millisec(250));
      t.async_wait(handler);
    }
}; 
```

`boost::function`由于构造对象，与模板版本相比，这将具有较小的开销。

# asp.net-mvc - 文档和云

> ID：10855965
> 
> 赞同：0
> 
> 时间：2012-06-01T19:05:12.210
> 
> 标签：asp.net-mvc, cloud

我们正在建立一个网站，用户可以在其中上传 Word 文档。我们使用 Asp.net MVC、C# 和 Sqlserver。我们的第一个想法是使用 VPS 托管并将文档保存在服务器中。

但是在查看了许多云托管选项之后，我们想知道使用云选项来保存文档是否比 VPS 更便宜/高效。

我们估计大约有 400,000 个用户，每个用户只能上传一个 word 文档。

如果有人能告诉我们正确的方向，我们将不胜感激！

谢谢 ！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T19:11:27.433

> 我们想知道使用云选项保存文档是否比 VPS 更便宜/高效。

[Amazon S3](http://aws.amazon.com/s3/)和[Azure blob 存储](http://www.windowsazure.com/en-us/home/features/storage/)提供这种服务，只需在这些链接下查看它们的定价 - 它非常便宜。它们还通过 HTTP 提供对上传文档的公共和受保护访问。

> 如果有人能告诉我们正确的方向，我们将不胜感激！

Amazon S3 和 Windows Azure 都支持 .NET，您可以将它们与您的 ASP.NET 网站一起使用，这取决于您的喜好。

# php - 从 php 回显 javascript 不起作用？

> ID：10855969
> 
> 赞同：2
> 
> 时间：2012-06-01T19:05:38.123
> 
> 标签：php, javascript, html, echo

因此，在一个 html 页面中，我试图让一个 php 段回显一些 javascript 代码，如下所示：

```
<?php
    echo "This was legitimately hit";
    if(!empty($_POST['name']))
    {
        echo '<script type="text/javascript">alert("We got the name");</script>';
    }
    else
    {
        echo '<script type="text/javascript">alert("We DID NOT get the name");</script>';
    }
?> 
```

从我在网上阅读的内容来看，这似乎是一种合法的做事方式，但该页面似乎正在阅读第一部分，直到第一个关闭的雪佛龙（见下方）作为评论。

```
<?php
    echo "This was legitimately hit";
    if(!empty($_POST['name']))
    {
        echo '<script type="text/javascript"> 
```

然后它将 else 和 next echo 读取为纯文本，并将其放在网页上。然后下一个 javascript 代码块被读取为常规 javascript 代码块，因此该页面会弹出一个提示它没有获得名称的弹出窗口。然后右方括号和关闭人字形将输出为更多文本。

所以最后页面只是结束了

```
alert("We got the name")'; } else { echo ''; } ?> 
```

以纯文本形式打印在其上，并弹出一个提示我们未收到姓名的弹出窗口。

这里出了什么问题？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-01T19:08:04.153

听起来该文件没有作为 PHP 处理。文件名是否以 .php 结尾？您确定 PHP 已安装并正确连接到 Web 服务器吗？

编辑：在同一页面处理 Facebook 请求：

```
<?php

if (isset($_POST['facebook_request_field'])) {
  // handle the Facebook request, output any necessary response
  // then exit
  exit;
}

?>
<!-- display the web page normally here --> 
```

所以对于你的测试页：

```
<?php

if (isset($_POST['name'])) {
  echo '<script type="text/javascript">alert("got a name!");</script>';
  exit;
}

?>
<script type="text/javascript">alert("No name.");</script> 
```

（这实际上与您已经拥有的功能相同，所以也许我误解了目的。）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-01T19:09:29.880

在`We got the signed request`and之间`We got the name`，我认为您没有向我们提供导致错误的实际代码。`alert`仔细检查，并确保您在通话之前没有任何杂散的单引号。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-01T19:09:22.590

`;`后面有缺失`alert`。您是否尝试过先纠正此问题？

# powershell - 从使用不寻常标签格式的网页中提取数据

> ID：10855970
> 
> 赞同：1
> 
> 时间：2012-06-01T19:05:46.190
> 
> 标签：powershell

注意：必须在powershell中完成。
我已经搜索和搜索了这个我似乎无法解决的小问题。该页面是一种不寻常的 xml 格式，看起来像这样

```
<?xml version="1.0" encoding="utf-8" ?> 
<string xmlns="http://foo.bar.moo.org/">WILBER</string> 
```

这是页面上唯一的内容。唯一会改变的部分是威尔伯可能是别的东西。

我试过了：

```
$site="http://lalaland.org/Getmoocow?input=$foo_name"
$data = (new-object System.Net.WebClient).DownloadString($site)
$foo = [regex]::Matches($data, '<string.*?>(.+)</string>') | % {$_.Captures[0].Groups[1].value} 
```

和一些变种，但没有运气。我唯一需要的是位于字符串标签之间的东西

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T19:17:50.173

因此，鉴于您提供的字符串，

```
[xml]$x = @"
>> <?xml version="1.0" encoding="utf-8" ?>
>> <string xmlns="http://foo.bar.moo.org/">WILBER</string>
>> "@
>>
$x.string.'#text'
WILBER 
```

# php - 判断 PHP 中是否存在 $_SESSION 超全局变量

> ID：10855972
> 
> 赞同：29
> 
> 时间：2012-06-01T19:05:54.097
> 
> 标签：php, session

我想做这样的事情：

```
if ($_SESSION['errors'] exists)
{
    //Do stuff
} 
```

我想在 page1 上创建一个会话，然后转到 page2 它将检查错误，如果有错误它返回到 page1 并显示错误。

但是，如果尚未在第 2 页创建变量，则 page1 将给出错误。

如果我`$_SESSION['errors'] == ""`在 page1 上这样做，它会重置变量，这样就不好了。

* * *

## 回答 #1

> 赞同：64
> 
> 时间：2012-06-01T19:07:08.463

```
if (isset($_SESSION['errors']))
{
    //Do stuff
} 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-06-01T19:10:08.133

使用`isset()`和`empty()`php函数。

```
if (isset($_SESSION['errors']) && !empty($_SESSION['errors'])) {
    // ...
} 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2015-05-15T04:02:05.207

```
if (!isset($_SESSION['id']) || (trim($_SESSION['id']) == '')) {
     // do stuff
} 
```

# django - heroku 和 django，类型字符变化的值太长（50）

> ID：10855978
> 
> 赞同：2
> 
> 时间：2012-06-01T19:06:10.323
> 
> 标签：django, heroku

我在syncdb上收到此错误：

```
 File "/app/.heroku/venv/lib/python2.7/site-packages/django/db/models/manager.py", line 203, in _insert
    return insert_query(self.model, objs, fields, **kwargs)
  File "/app/.heroku/venv/lib/python2.7/site-packages/django/db/models/query.py", line 1576, in insert_query
    return query.get_compiler(using=using).execute_sql(return_id)
  File "/app/.heroku/venv/lib/python2.7/site-packages/django/db/models/sql/compiler.py", line 910, in execute_sql
    cursor.execute(sql, params)
  File "/app/.heroku/venv/lib/python2.7/site-packages/django/db/backends/util.py", line 40, in execute
    return self.cursor.execute(sql, params)
  File "/app/.heroku/venv/lib/python2.7/site-packages/django/db/backends/postgresql_psycopg2/base.py", line 52, in execute
    return self.cursor.execute(query, args)
django.db.utils.DatabaseError: value too long for type character varying(50) 
```

创建这个新模型后：

```
class Promocio(models.Model):
    codiIdioma = models.CharField(u"Codi de l'idioma",max_length = 10, choices = LANGUAGES, unique=True  )    
    headTxt = models.TextField( u"Text del títol",   help_text = u'''Text que apareixerà com a títol al missatge de promoció de la recollida de e-mails amb la tablet''' )
    bodyTxt = models.TextField( u"Text del cost del missatge" ,  help_text = u'''Text que apareixerà com al cos del missatge de promoció de la recollida de e-mails amb la tablet''')
    buttonTxt =  models.TextField( u"Text del butó d'OK",  help_text = u'''Text que apareixerà dins el butó de recollida de e-mails amb la tablet''' )
    codiOrdenacio = models.CharField(u"Codi d'ordenació",max_length = 10, blank = True, help_text = u"Codi alfanumèric per determinar quin idioma es presenta abans i quin després. Ex: 00AA" )  

    class Meta:
        ordering=['codiOrdenacio']
        db_table = u'promocions_tablet'
        verbose_name = u'Missatge de Promoció a mostrar a la tablet'
        verbose_name_plural = u'Missatges de Promoció a mostrar a la tablet' 
```

一些想法来解决这个问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-01T21:34:11.370

在此期间自动创建的唯一对象`syncdb`是`ContentType`s，但每个 char 字段都`ContentType`允许 100 个字符，并且从 Django 的早期就开始了。`verbose_name`用于内容类型上的字段`name`，但您的`verbose_name`，虽然很长，但仍低于 50 个字符。

除此之外，Django每次运行时还会处理*所有*`initial_data`应用程序中的任何固定装置。这就是为什么我问你有没有。如果这个特定的应用程序没有，那么一定有某个应用程序，在*某个地方*确实有一个。此外，这可能包括 中列出的第三方应用程序，因此您可能需要四处寻找。*`syncdb`*`INSTALLED_APPS`**

# c# - 将 SelectedItem 作为完全独立的 Uielement 的 DataContext

> ID：10855979
> 
> 赞同：0
> 
> 时间：2012-06-01T19:06:20.987
> 
> 标签：c#, wpf, xaml, mvvm, selecteditem

我开始使用 wpf 和 mvvm 模式在 c# 中制作程序来学习这种程序语言。很抱歉，我终于遇到了无法使用 Google 解决的问题。但我尽量做到精确。

首先，我[向](http://s7.directupload.net/images/120601/3x5gli87.png)您展示 GUI，以便我可以更轻松地解释我的问题。

MainWindow 的 xaml 文件在[这里](http://code.google.com/p/lolscripts/source/browse/trunk/MainWindow.xaml)。

如您所见，这不是一个严肃而重要的程序，我只是为了学习一些技术而制作它。

*现在是我的**主要问题**：* 我需要页脚中第二个 ListView(Consumables) 的 SelectedItem 属性。我认为这不会是一个严重的问题，因为我可以使用相对路径和列表视图的名称将它绑定到所选项目。当我将一个项目添加到此列表视图时，这不起作用并导致空引用错误。我仔细检查了代码，我确信我没有做错什么。所以我认为问题在于，它是一种后代 ui 元素。

我的下一个尝试是在绑定到所选项目的主视图模型中创建一个新属性。您可以在第 136 行找到它。但正如我发现的那样，如果我单击一个项目，这也会导致我出现 System.NullReferenceException。我认为这是因为这个属性是只读的。我不知道该怎么办。**是否有任何其他可能性将 SelectedItem 绑定为页脚的 DataContext**？

*我的第二个问题是关于第 27 行*。TabControl 应始终自动选择第一个选项卡。但它只会每两次。这很有趣。如果我向下滚动 Champion Combo Box，第一个选项卡变为：选中 - 未选中 - 选中 - ...

*我的第三个也是最后一个问题大约是 72*，与第 50 行相似（DataContext 也相同）但是您看到第 50 行的 itemtemplate 的 ContextMenu 的 ICommand 有效，而 contextmenu（l. 72）不调用 Icommand . 诡异的。

这是一个有趣的项目，所以如果我的信息不够，我可以为您提供源代码。--对不起，只允许两个超链接--

请帮我。我对这种意想不到的行为有点困惑。我没有找到任何可以帮助我的东西，如果这些问题的答案很简单，我很抱歉：P

只是强调一下：主要问题是我唯一真正需要答案的问题。第二个可以通过编程方式解决。而要解决第三个问题，我可以删除此功能。

我为每一个提示感到高兴！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-01T19:22:24.717

还没有完成整个问题，但是您应该将所选项目绑定到您的视图模型属性（双向绑定），然后将另一个 UIElement 绑定到此视图模型属性（可能是一种方式绑定或检查值相等性，以免导致 stackoverflow 异常)

# operating-system - 当您在操作系统级别双击应用程序时

> ID：10855980
> 
> 赞同：0
> 
> 时间：2012-06-01T19:06:21.617
> 
> 标签：operating-system, window

> 当我们在操作系统级别双击应用程序时会发生什么。我知道这高度依赖于操作系统。但我认为在 Windows

当前正在执行的进程将 fork() 一个新的子进程，新创建的子进程的进程控制块将使用应用程序所需的数据进行初始化，新进程将被调度或立即执行

有什么建议么。提前感谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-04T10:56:58.090

就像 linux 上的 fork() 一样，我们在 windows 上有 CreateProcess。同样，所有初始化都会发生......有关更多详细信息，您可以参考[http://msdn.microsoft.com/en-us/library/ms682425(v=vs.85).aspx](http://msdn.microsoft.com/en-us/library/ms682425(v=vs.85).aspx)。就像在linux中我们使用命令ps来列出正在运行的进程，在windows中我们有tasklist。

# ios - IOS - 调用具有匹配参数的函数问题

> ID：10855981
> 
> 赞同：0
> 
> 时间：2012-06-01T19:06:23.880
> 
> 标签：ios, xcode, function, methods

虽然我看到了一些引用类似问题的东西，但似乎没有一个解决方案适用。我创建了一个函数，它获取传递给它的字符串。我想要一个函数，该函数将根据传递给它的字符串返回月份、年份或日期（“HH”将返回当前小时）。所以我创建了这个：

```
- (NSString *)getDay:(NSString *) dateType {

NSDate *date = [NSDate date];

NSDateFormatter *dateFormat = [[NSDateFormatter alloc]init];
[dateFormat setDateFormat:dateType];

NSString *dateString = [dateFormat stringFromDate:date];

[dateFormat release];
return dateString;
} 
```

然后我在这里调用它：

```
 NSString *dateIt = [self getDay:@"HH"]; 
```

我得到的错误是“在'getDay''int'与'NSString *'中实现参数类型冲突

我还收到“不兼容的指向整数转换的指针，将'NSString *'发送到'int'类型的参数”

有什么线索吗？我将所有内容都声明为字符串。

# iphone - NSURLconnection 在 3g 上失败“网络连接丢失”

> ID：10855982
> 
> 赞同：0
> 
> 时间：2012-06-01T19:06:29.183
> 
> 标签：iphone, objective-c, ios, xcode

我有一个使用 NSURLconnection 的应用程序，当使用 3G 并出现错误“网络连接丢失”时，它似乎始终无法与 Web 服务通信。但是，该应用程序在 wifi 下运行得很好。

关于可能是什么问题的任何想法？我需要对 NSURLconnection 做任何特别的事情来处理 3G 吗？

我使用的一个 NSURL 代码示例。

```
 NSURLConnection *conn = [[NSURLConnection alloc] initWithRequest:req delegate:self];
    if (conn) {
        XMLData = [NSMutableData data];     
    } 
```

委托方法

```
 -(void) connection:(NSURLConnection *) connection 
 didReceiveResponse:(NSURLResponse *) response {
    [XMLData setLength: 0];
 }

-(void) connection:(NSURLConnection *) connection 
didReceiveData:(NSData *) receiveddata {
[XMLData appendData:receiveddata];
}

-(void) connection:(NSURLConnection *) connection 
   didFailWithError:(NSError *) error {
     self.errorLabel.text = [error localizedDescription];

 }

 -(void) connectionDidFinishLoading:(NSURLConnection *) connection {
     NSLog(@"DONE. Received Bytes: %d", [XMLData length]);
     NSString *theXML = [[NSString alloc] 
                    initWithBytes: [XMLData mutableBytes] 
                    length:[XMLData length] 
                    encoding:NSUTF8StringEncoding];

   //i do some xml parsing on the data returned
   } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T19:28:00.303

我会开始将 NSLog 放在委托方法中。从 didReceiveData 开始。

```
 -(void) connection:(NSURLConnection *) connection didReceiveData:(NSData *) receiveddata          { 
            if (receiveddata != nil){ 
            [XMLData appendData:receiveddata];
             NSLog(@"didReceiveData :receiveddata is:%@", receiveddata);

            }
    else{ 
        NSLog(@"NO Data:%@");
        }

    } 
```

# ruby-on-rails - Rails link_to_if 类无法正确显示

> ID：10855983
> 
> 赞同：0
> 
> 时间：2012-06-01T19:06:38.433
> 
> 标签：ruby-on-rails, link-to

对于我的生活，我无法弄清楚为什么会发生这个问题。我一直使用link_to helper，但iv只使用了几次link_to_if helper，这次我无法获取链接以获取CSS类。

这是我的链接

```
<%= link_to_if(step.sequence > 1, raw('<i class="icon-chevron-up"></i>'), url_for(:controller => :test_steps, :action => :update_sequence, :direction => 'up', :id => step.id, :test_script_id => @test_script), { :class => 'btn btn-mini' })%> 
```

图像显示，没有预期的链接，但最后定义的 CSS 类没有，相反它只是没有类。这与我在所有 link_to 助手中使用的格式相同。

谁能解释为什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-01T19:14:18.067

使用 link_to_if，`raw('<i class="icon-chevron-up"></i>')`如果条件失败，则仅返回名称 -- 在您的情况下 -- 的结果。否则将适用于链接标签的所有选项都将被忽略。

查看[源代码](https://github.com/rails/rails/blob/00554568e0625b2e4d4212ab7464f02234f74427/actionpack/lib/action_view/helpers/url_helper.rb#L452)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-01T19:14:37.853

尝试传递一个空哈希作为选项参数，以便将`{ :class => '...' }`其分配给 html_options 参数。未经测试

```
<%= link_to_if(step.sequence > 1, raw('<i class="icon-chevron-up"></i>'), url_for(:controller => :test_steps, :action => :update_sequence, :direction => 'up', :id => step.id, :test_script_id => @test_script), {}, { :class => 'btn btn-mini' })%> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-08-01T18:31:14.280

**将link_to_if**或**link_to_unless**包装在一个跨度中：

```
 %span.pull-right
   = link_to_unless Foo.deleted.empty?, "<i class='icon-white icon-trash'></i> Undelete Foo".html_safe, deleted_foos_path 
```

上面的代码在显示的任何内容上设置了一个 css 类（向右拉） - 完整链接或只是其文本。

# gwt - 无法将新条目插入反序列化的 AutoBean 映射

> ID：10855986
> 
> 赞同：0
> 
> 时间：2012-06-01T19:06:52.693
> 
> 标签：gwt, autobean

当我尝试向反序列化的 Map 实例插入新条目时，我没有得到任何异常，但 Map 没有被修改。这个入口点代码探测它。我做错了什么？

```
public class Test2 implements EntryPoint {

public interface SomeProxy {
    Map<String, List<Integer>> getStringKeyMap();
    void setStringKeyMap(Map<String, List<Integer>> value);
}

public interface BeanFactory extends AutoBeanFactory {
    BeanFactory INSTANCE = GWT.create(BeanFactory.class);

    AutoBean<SomeProxy> someProxy();
}

@Override
public void onModuleLoad() {
    SomeProxy proxy = BeanFactory.INSTANCE.someProxy().as();

    proxy.setStringKeyMap(new HashMap<String, List<Integer>>());
    proxy.getStringKeyMap().put("k1", new ArrayList<Integer>());
    proxy.getStringKeyMap().put("k2", new ArrayList<Integer>());

    String payload = AutoBeanCodex.encode(AutoBeanUtils.getAutoBean(proxy)).toString();
    proxy = AutoBeanCodex.decode(BeanFactory.INSTANCE, SomeProxy.class, payload).as();

    // insert a new entry into a deserialized map
    proxy.getStringKeyMap().put("k3", new ArrayList<Integer>());

    System.out.println(proxy.getStringKeyMap().keySet()); // the keySet is [k1, k2] :-( ¿where is k3? 
} 
```

}

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-04-29T12:51:19.097

诸如 java.util.Set 和 java.util.List 之类的集合类很棘手，因为它们是根据 Object 实例进行操作的。要使集合可序列化，您应该通过普通类型参数指定它们期望包含的特定对象类型（例如，`Map<Foo,Bar>`而不仅仅是`Map`）。如果您使用原始集合或地图，您将获得臃肿的代码并容易受到拒绝服务攻击。

字体： http: [//www.gwtproject.org/doc/latest/DevGuideServerCommunication.html#DevGuideSerializableTypes](http://www.gwtproject.org/doc/latest/DevGuideServerCommunication.html#DevGuideSerializableTypes)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-03T17:05:23.023

不应该 AutoBeanCodex.encode(AutoBeanUtils.getAutoBean(proxy)) *.toString();* 成为*getPayLoad()*

稍后我会检查代码，我不知道这是否导致了问题。但它确实与我的典型方法不同。

# hashtable - 从哈希表中删除一个值的成本是多少？

> ID：10855989
> 
> 赞同：1
> 
> 时间：2012-06-01T19:07:01.343
> 
> 标签：hashtable, probing

现在我有这个问题，当我们在插入过程中使用线性探测时，我被问到从哈希表中删除一个值的成本。

通过阅读互联网上的各种内容，我可以发现它必须与负载因子有关。虽然我不确定，但我读到了负载因子与所需探头数量之间的关系，它是探头数量 = 1 / (1-LF)。

所以我相信成本必须取决于探测序列。但随后另一个想法毁了一切。

如果元素被插入到 p 探针中，现在我试图删除这个元素怎么办。但在此之前，我已经删除了几个具有相同哈希码的元素，并且是插入小于 p 的探针的一部分。

在这种情况下，我到达了一个阶段，我在哈希表中看到一个空槽，但我不确定我要删除的元素是否已被删除，或者由于探测而位于其他位置。

我还发现，一旦我删除了一个元素，我必须用一些特殊的指示器标记​​这个槽，以告知它是可用的，但这并不能解决我不确定我愿意删除的元素的问题。

谁能建议在这种情况下如何找到成本？如果是非线性探测，方法会有所不同吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-03T20:57:09.467

标准方法是“查找元素，标记为已删除”。标记显然具有 O(1) 成本，因此总操作成本与仅查找相同： O(1) *expected*。在退化情况下它可能高达 O( *n )（例如，所有元素都具有相同的散列）。*O(1) 是我们理论上可以说的。

关于负载率。负载因子（占用的桶数与总数之比）越高，*预期*因子越大（但这不会改变理论 O 成本）。请注意，在这种情况下，负载因子包括表元素中存在的两者的数量以及先前标记为已删除的存储桶的数量。

其他探测类型（例如二次）不会改变理论成本，但可能会改变预期的常数因子或其方差。如果您查看“后备”序列，则在线性排序中，不同存储桶的序列重叠。这意味着如果某个桶的序列很长，那么相邻桶的序列也会很长。例如：如果桶 4 到 10 被占用，桶 #4 的序列为 7 桶长（4、5、6、...、10），#5 为 6，依此类推。对于二次探测，情况并非如此。

但是，线性探测具有更好的内存缓存行为的好处，因为您检查彼此靠近的内存单元。然而，在实践中，对于二次探测，后备序列很少足够长，这很重要。

最后，在线性探测的情况下，可以在*没有*删除标记的情况下工作，但是为此，您必须使删除过程相当复杂（尽管仍然期望 O(1)，但常数因子要高得多）。是否值得，必须通过实际分析来决定；例如，这简化了一些插入和查找。但是，对于 C++ 实现，这将有一个缺点，即 erase() 会使迭代器无效。

# java - 在java中使用BCEL强制代理

> ID：10855990
> 
> 赞同：0
> 
> 时间：2012-06-01T19:07:05.797
> 
> 标签：java, sockets, proxy, bcel

有什么方法可以代替像

```
Socket s = new Socket(Proxy.NO_PROXY); 
```

和

```
Socket s = new Socket(); 
```

使用 BCEL，因为我不知道如何。我知道这将涉及更改 InstructionList，但我不知道如何扫描它，也不知道要查找哪些操作码。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-01T19:36:42.840

如果您使用[AspectJ](http://eclipse.org/aspectj/)或类似的高级工具，您可能会获得更短的学习曲线。

对于低级字节码修改，如果不学习 Java 操作码，您将无法逃脱。一个好的起点是[JVM Specification](http://docs.oracle.com/javase/specs/jvms/se7/html/jvms-2.html#jvms-2.11)。此外，BCEL 没有很好的文档记录，如果您可以灵活地选择低级别，我建议使用 ASM 框架。这是使用 ASM[实现简单字节码转换](http://asm.ow2.org/doc/tutorial.html)的相应教程。它基于较旧的 ASM 版本，但想法仍然相同。

# sql-server - 优化实体框架生成的 SQL Server 执行计划

> ID：10855991
> 
> 赞同：2
> 
> 时间：2012-06-01T19:07:07.163
> 
> 标签：sql-server, entity-framework, linq-to-entities, query-optimization

我有一个数据结构，它基本上是一个带有标签字典的文档。我正在尝试恢复给定表单类型的所有文档，这些文档具有名为“姓氏”的标签和标签值为“史密斯”的标签。可能有 0..N 个与文档关联的“姓氏”标签。

我正在使用以下 linq 查询尝试将源文档与具有匹配标签的子文档进行匹配：

```
DB.Documents
    .Where(doc => doc.FormID == pd.IndexForm.FormID)
    .Where(doc => doc.Document_StringIndex_ReadOnly
                .Join(Fields,
                        dsi => new { FieldName = dsi.FieldName, FieldValue = dsi.StringValue },
                        dsi2 => new { FieldName = dsi2.FieldName, FieldValue = dsi2.StringValue },
                        (dsi, dsi2) => dsi.Document).Count() > 0); 
```

使用 .ToTraceString() 输出时会生成以下查询

```
SELECT 
[Project1].*
FROM ( SELECT 
    [Extent1].*
    (SELECT 
        COUNT(cast(1 as bit)) AS [A1]
        FROM   [dbo].[Document_StringIndex_ReadOnly] AS [Extent2]
        INNER JOIN  (SELECT [Extent3].*
            FROM  [dbo].[Document] AS [Extent3]
            INNER JOIN [dbo].[Document_StringIndex_ReadOnly] AS [Extent4] ON [Extent3].[DocumentID] = [Extent4].[DocumentID] ) AS [Join1] ON (([Extent2].[FieldName] = [Join1].[FieldName]) OR (([Extent2].[FieldName] IS NULL) AND ([Join1].[FieldName] IS NULL))) AND (([Extent2].[StringValue] = [Join1].[StringValue]) OR (([Extent2].[StringValue] IS NULL) AND ([Join1].[StringValue] IS NULL)))
        LEFT OUTER JOIN [dbo].[Document] AS [Extent5] ON [Extent2].[DocumentID] = [Extent5].[DocumentID]
        WHERE ([Extent1].[DocumentID] = [Extent2].[DocumentID]) AND ([Join1].[DocumentID1] = @p__linq__7) AND ([Join1].[FieldName] = @p__linq__8)) AS [C1]
    FROM [dbo].[Document] AS [Extent1]
    WHERE [Extent1].[FormID] = @p__linq__5
)  AS [Project1]
WHERE [Project1].[C1] > 0 
```

如果我为我的参数直接替换常量（如下所示），查询执行得非常快。但是，如果我将参数保留在原位，则查询需要几分钟。

```
SELECT 
[Project1].*
FROM ( SELECT 
    [Extent1].*
    (SELECT 
        COUNT(cast(1 as bit)) AS [A1]
        FROM   [dbo].[Document_StringIndex_ReadOnly] AS [Extent2]
        INNER JOIN  (SELECT [Extent3].*
            FROM  [dbo].[Document] AS [Extent3]
            INNER JOIN [dbo].[Document_StringIndex_ReadOnly] AS [Extent4] ON [Extent3].[DocumentID] = [Extent4].[DocumentID] ) AS [Join1] ON (([Extent2].[FieldName] = [Join1].[FieldName]) OR (([Extent2].[FieldName] IS NULL) AND ([Join1].[FieldName] IS NULL))) AND (([Extent2].[StringValue] = [Join1].[StringValue]) OR (([Extent2].[StringValue] IS NULL) AND ([Join1].[StringValue] IS NULL)))
        LEFT OUTER JOIN [dbo].[Document] AS [Extent5] ON [Extent2].[DocumentID] = [Extent5].[DocumentID]
        WHERE ([Extent1].[DocumentID] = [Extent2].[DocumentID]) AND ([Join1].[DocumentID1] = 1015) AND ([Join1].[FieldName] = 'DDKey')) AS [C1]
    FROM [dbo].[Document] AS [Extent1]
    WHERE [Extent1].[FormID] = 22
)  AS [Project1]
WHERE [Project1].[C1] > 0 
```

生成执行计划后，我了解到如果直接代入参数值，SQL Server 会执行索引查找，我的查询速度很快。只要我保留参数，SQL Server 就会执行索引扫描，并且我的查询会超时。有什么方法可以让 SQL Server 一直在寻找？我可以强制实体框架不使用参数化查询吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-01T19:24:25.947

在生成的 SQL 中，这一行

```
[Join1].[FieldName] = @p__linq__8 
```

可能是问题所在。

If `FieldName`is `varchar(...)`and `@p__linq__8`is `nvarchar(...)`then this 子句将导致表扫描，因为参数类型与索引类型不匹配。

当您直接替换“DDKey”时，类型匹配，因此您获得索引搜索。用 N'DDkey' 试试你的查询，看看你是否得到了表扫描。

这是各种版本的 Linq to Sql 和 Linq to Entities 的问题，但可能会在以后的版本中修复。

如果您无法更新到最新版本，解决此问题的一种方法是更改`FieldName`​​为`nvarchar(...)`.

# javascript - Javascript：根据下拉列表的当前值显示/隐藏行

> ID：10855999
> 
> 赞同：0
> 
> 时间：2012-06-01T19:08:00.100
> 
> 标签：javascript, asp-classic

在这种情况下，我正在使用 Javascript 和 ASP。当这个特定页面打开时，我的下拉菜单之一已经填充了“打开”或“关闭”状态 - 您可以看到该值来自我的记录集中的 ID。

我现在想做的是：如果页面第一次加载时的状态是“关闭”并且用户决定将其更改为“打开”，他们必须重新输入“重新打开原因” - 所以，那将在下拉列表下方显示标题和文本框....

到目前为止，这是我尝试过的：我创建了一个 showHide() 函数并将其放在下拉列表中的 select 内，但它什么也没做，所以现在卡住了。任何帮助表示赞赏。谢谢！

```
 <select name="cboStatus" id="cboStatus" style="width:200px" onchange="showHide();">                           <%
                        RSStatus.MoveFirst
                        If Not RSStatus.EOF Then
                            Do While Not RSStatus.EOF
                                %><option value='<%= RSStatus("ID")%>'
                                <%If RSStatus("ID") = RS("prjStatus") Then Response.Write "selected"%>><%= RSStatus("prjStatus")%></option><%
                                RSStatus.MoveNext
                            Loop
                        End If
                        %>           
                    </select> 
```

应从上述 JS 生成的 HTML：

```
<tr id="lbReopenReason" style="display:none">
                <td bordercolor="#f0f0e4" bgcolor="#f0f0e4"><h3>Reopen Reason</h3></td>
              </tr>
              <tr id="trReopenReason" style="display:none">
                <td bordercolor="#FFFFFF" bgcolor="#FFFFFF">
                <input name="txtReopenReason" type="text" id="txtReopenReason" value="<%If (RS("reOpenReason")) <> "" Then Response.Write(RS("reOpenReason"))%>" size="100" />
                </td>
              </tr> 
```

Javascript：

```
 function showHide()
        {
            var cboStatus = document.getElementById("cboStatus");
                  var cboStatusValue = cboStatus.options[cboStatus.selectedIndex].text;
            var lbReopenReason = document.getElementById("lbReopenReason");             var trReopenReason = document.getElementById("trReopenReason");         

            //If the status of the project is Closed at the time of page load, and that status changes, then the user must enter a re-open reason.
            if ( (status == 3) && (cboStatusvalue == 'Open' )
            {
                lbReopenReason.style.display = "";
                trReopenReason.style.display = "";
                }
                  else
{
                lbReopenReason.style.display = "none";
            trReopenReason.style.display = "none";
            }
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T19:26:17.817

看起来这里有两个问题：

1）您的函数被称为“statusShowHide（）”，而不是“showHide（）”，所以这可能是它没有被调用的原因。2）您的 onchange 属性在函数调用后缺少右引号，因此也可能是这样。

试一试这些修复，看看它现在是否有效。

编辑：还有一些建议：

在您的 showHide() 方法中，您说：

```
if ( (status == 3) && (cboStatusvalue == 'Open' ) 
```

什么时候应该：

```
if ( (cboStatus === 3) && (cboStatusValue === 'Open' ) ) 
```

此外，而不是您当前获取元素值的方式：

```
var cboStatusValue = cboStatus.options[cboStatus.selectedIndex].text; 
```

尝试使用：

```
var cboStatusValue = cboStatus.value; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-10T16:17:53.613

终于用以下方法解决了这个问题：

窗口加载以填充初始记录值：

```
window.onload = findStatus;

    function findStatus()   
    {
        var cboStatus = document.getElementById('cboStatus');
        statusShowHide(cboStatus);      
    } 
```

后跟这个用于更改状态的 Javascript：

```
function statusShowHide(obj)
{   
    var txtStatusFirstLoad = document.getElementById("txtStatusFirstLoad");                  
    var lbReopenReason = document.getElementById("lbReopenReason");
    lbReopenReason.style.display = "none";

    if (txtStatusFirstLoad.value == 3 && obj.value == 1)
    {

        lbReopenReason.style.display = "block";
    }   
} 
```

并添加了这个隐藏的文本框来捕获初始状态值：

```
<input name="txtStatusFirstLoad" id = "txtStatusFirstLoad" type="hidden" value="<%=RS("Status")%>" /> 
```