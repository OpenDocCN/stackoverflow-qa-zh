# StackOverflow 问答 10813000-10813999

# linux - 网络重启后Openswan隧道不工作

> ID：10813000
> 
> 赞同：4
> 
> 时间：2012-05-30T08:54:00.983
> 
> 标签：linux, centos, vpn, ipsec

我在尝试创建 ipsec 连接时观察到一些奇怪的行为。我在 cisco asa 和我的 Linux 机器之间配置了 ipsec，它按预期工作。但是当我在我的 Linux 机器上重新启动网络服务或在 cisco 端重新启动端口时，隧道停止工作但隧道状态为 up：

```
/etc/init.d/ipsec status
/usr/libexec/ipsec/addconn Non-fips mode set in /proc/sys/crypto/fips_enabled
IPsec running  - pluto pid: 2684
pluto pid 2684
1 tunnels up
some eroutes exist 
```

当我尝试连接到另一端（telnet、ping、ssh）时，连接不起作用。

我的 /etc/ipsec.conf 看起来像这样：

```
# /etc/ipsec.conf - Openswan IPsec configuration file
#
# Manual:     ipsec.conf.5
#
# Please place your own config files in /etc/ipsec.d/ ending in .conf

version 2.0     # conforms to second version of ipsec.conf specification

# basic configuration
config setup
        # Debug-logging controls:  "none" for (almost) none, "all" for lots.
        # klipsdebug=none
        # plutodebug="control parsing"
        # For Red Hat Enterprise Linux and Fedora, leave protostack=netkey
        protostack=netkey
        nat_traversal=yes
        virtual_private=
        oe=off
        # Enable this if you see "failed to find any available worker"
        nhelpers=0

#You may put your configuration (.conf) file in the "/etc/ipsec.d/" and uncomment this.
include /etc/ipsec.d/*.conf 
```

我的 /etc/ipsec.d/myvpn.conf 看起来像这样：

```
conn myvpn
        authby=secret                # Key exchange method
        left=server-ip                     # Public Internet IP address of the
                                     # LEFT VPN device
        leftsubnet=server-ip/32            # Subnet protected by the LEFT VPN device
        leftnexthop=%defaultroute    # correct in many situations
        right=asa-ip                 # Public Internet IP address of
                                     # the RIGHT VPN device
        rightsubnet=network/16       # Subnet protected by the RIGHT VPN device
        rightnexthop=asa-ip          # correct in many situations
        auto=start                   # authorizes and starts this connection
                                     # on booting
        auth=esp
        esp=aes-sha1
        compress=no 
```

当我重新启动 openswan 服务时，一切都开始工作了，但我认为应该有一些逻辑可以自动执行此操作。有谁知道我错过了什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-30T14:32:10.390

如果双方都可用，您可能希望启用失效对等检测。当隧道实际上不再工作并断开或重置它时，死对等检测会发出通知。

如果不可用，您还可以尝试将会话重新协商时间更改为非常低；您的隧道将经常创建新密钥并设置新隧道以定期替换旧隧道，当会话关闭时，在超时后有效地重新创建隧道。

对于我自己在 Linux 上的 PPP 会话，我只需在 /etc/ppp/ip-up.local 中有一个“service ipsec restart”，以便在 PPP 设备重新联机时重新启动所有隧道。

YMMV。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-10T03:35:48.810

只需尝试 DPD，但不起作用。

所以我刚刚从 mikebabcock 那里学到了东西。

在我的 /etc/ppp/ip-down 中添加以下行

```
service ipsec restart 
```

有了这个解决方法，现在 L2TP/IPSec 就像一个魅力一样工作。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-01-05T03:54:15.347

我不喜欢每次断开连接时都重新启动 ipsec 的想法。实际上`/usr/libexec/ipsec/_updown`是在 ipsec 中运行不同的操作。相同的脚本可以在 leftupdown/rightupdown 上运行。但问题是，当远程客户端连接回您的主机时，它不会执行任何实际命令。要解决此问题，您需要在 /usr/libexec/ipsec/_updown.netkey`doroute replace`之后添加`up-client)`（如果您当然使用 Netkey）：

```
# ...skipped...
#
up-client)
# connection to my client subnet coming up
# If you are doing a custom version, firewall commands go here.
    doroute replace
#
# ...skipped... 
```

但请注意，如果您更新软件包，此文件将被覆盖，因此只需将其放在其他位置，然后将以下命令添加到您的连接配置中：

```
rightupdown="/usr/local/libexec/ipsec/_updown"
leftupdown="/usr/local/libexec/ipsec/_updown" 
```

现在，一旦远程连接回您的服务器，路由就会恢复。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2016-03-04T09:18:27.243

对我来说，由于奇怪的原因`DPD`，在每种情况下都不能正常工作。我使用此脚本每分钟检查一次状态。脚本在 Peer（例如防火墙）上运行：

```
C=$(ipsec auto --status | grep "established" | wc -l)
if [ $C -eq 0 ]
then
 echo "Tunnel is down... Restarting"
 ipsec restart
else
 echo "Tunnel is up...Bye!"
fi 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2016-05-26T09:52:20.837

这可能是由于 iptables 规则而发生的。
确保已启用对远程公共 IP 地址的 udp 端口​​ 500 和 esp 协议。

例子：

```
    iptables -A 输出 -p udp -d 1.2.3.4 --dport 500 -j 接受
    iptables -A 输出 -p esp -d 1.2.3.4 -j 接受

```

再见

# css - 滚动条自带大尺寸图片

> ID：10813002
> 
> 赞同：1
> 
> 时间：2012-05-30T08:54:12.123
> 
> 标签：css, image, scroll, centering

我正在设计一个只包含图像的网页（图像会随着时间而变化）。图像的尺寸不固定。所以我计划在垂直和水平中心显示图像。对于我使用的水平中心和我使用`margin:0 auto;`的垂直中心`line-height and vertical-align`，如可能的答案中所述。为了限制尺寸更大的图像，我使用`max-height, max-width`带有图像标签的属性。

看：[fiddle](http://jsfiddle.net/knoxxs/EqeTx/7/) {看发生了什么用浏览器窗口更大尺寸的图像替换图像。对于小图像，一切正常。}

我也分享快照：

1.  带小图： ![在此处输入图像描述](../Images/607fe3e44e2a7747e3161e393d9323cb.png)
2.  大图：（希望你能看到右边的小滚动条） ![在此处输入图像描述](../Images/2ccd85e1109e1201e81513c0061e57c4.png)

我正在使用谷歌浏览器 (20.0.1132.17)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-30T08:55:59.673

我认为你需要：

```
html, #container /* whatever your container is*/ {
    overflow: none;
} 
```

* * *

编辑：

您必须发布一个包含您想要的内容的实时页面。JSFiddle 不足以解决这个问题。

你可以设置`max-height: 100%`，但你也必须设置

```
html, body {
  height: 100%;
  margin: 0;
  padding: 0;
} 
```

# c# - 现有连接被远程主机强行关闭

> ID：10813003
> 
> 赞同：2
> 
> 时间：2012-05-30T08:54:14.540
> 
> 标签：c#, wcf

我的服务的 app.config

```
<system.serviceModel>
<client>
  <endpoint name="DataLocal" address="net.tcp://SomeAddress" binding="netTcpBinding" contract="ISomeContract" bindingConfiguration="TcpCustomSecurity" behaviorConfiguration="SecureBehaviorName">
    <identity>
      <dns value="localhost"/>
    </identity>
  </endpoint>
</client>
  <services>     
  <service name="SomeService">
    <host>
      <baseAddresses>
        <add baseAddress="http://SomeService" />
        <add baseAddress="net.tcp://SomeService" />
      </baseAddresses>
    </host>
    <endpoint name="SomeService_Normal" address="Secure" binding="netTcpBinding" contract="ISomeService" bindingConfiguration="TcpNormal"/>
  </service>
</services>
<bindings>
  <netTcpBinding>        
    <binding name="TcpNormal" transferMode="Buffered" receiveTimeout="24.20:31:23.6470000">
      <readerQuotas maxDepth="2147483647" maxStringContentLength="2147483647" maxArrayLength="2147483647" maxBytesPerRead="2147483647" maxNameTableCharCount="2147483647"/>
      <security mode="None" />
    </binding>
    <binding name="TcpCustomSecurity" transferMode="Buffered" closeTimeout="00:01:00" openTimeout="00:01:00" receiveTimeout="24.20:31:23.6470000" sendTimeout="00:01:00" maxReceivedMessageSize="2147483647" maxBufferSize="2147483647" maxBufferPoolSize="2147483647">
      <readerQuotas maxDepth="2147483647" maxStringContentLength="2147483647" maxArrayLength="2147483647" maxBytesPerRead="2147483647" maxNameTableCharCount="2147483647"/>
      <security mode="Message">
        <message clientCredentialType="UserName"/>
      </security>
    </binding>
  </netTcpBinding>   
</bindings>
<behaviors>
  <endpointBehaviors>
    <behavior name="SecureBehaviorName">
      <clientCredentials>
        <serviceCertificate>
          <authentication certificateValidationMode="None"/>
        </serviceCertificate>
      </clientCredentials>
      <dataContractSerializer maxItemsInObjectGraph="2147483647"/>
    </behavior>
  </endpointBehaviors>
</behaviors> 
```

**以下是我得到的错误的堆栈语句..**

```
>          System.dll!System.Net.Sockets.Socket.Send(byte[] buffer, int offset, int size, System.Net.Sockets.SocketFlags socketFlags) + 0x5a bytes 
        System.ServiceModel.dll!System.ServiceModel.Channels.SocketConnection.Write(byte[] buffer, int offset, int size, bool immediate, System.TimeSpan timeout) + 0xa7 bytes   
        System.ServiceModel.dll!System.ServiceModel.Channels.SocketConnection.Write(byte[] buffer, int offset, int size, bool immediate, System.TimeSpan timeout, System.ServiceModel.Channels.BufferManager bufferManager) + 0x34 bytes   
        System.ServiceModel.dll!System.ServiceModel.Channels.BufferedConnection.WriteNow(byte[] buffer, int offset, int size, System.TimeSpan timeout, System.ServiceModel.Channels.BufferManager bufferManager) + 0x90 bytes    
        System.ServiceModel.dll!System.ServiceModel.Channels.BufferedConnection.Write(byte[] buffer, int offset, int size, bool immediate, System.TimeSpan timeout, System.ServiceModel.Channels.BufferManager bufferManager) + 0x47 bytes 
         System.ServiceModel.dll!System.ServiceModel.Channels.FramingDuplexSessionChannel.OnSend(System.ServiceModel.Channels.Message message, System.TimeSpan timeout) + 0x115 bytes  
         System.ServiceModel.dll!System.ServiceModel.Channels.OutputChannel.Send(System.ServiceModel.Channels.Message message, System.TimeSpan timeout) + 0x81 bytes    
         System.ServiceModel.dll!System.ServiceModel.Dispatcher.DuplexChannelBinder.Request(System.ServiceModel.Channels.Message message, System.TimeSpan timeout) + 0x154 bytes  
        System.ServiceModel.dll!System.ServiceModel.Channels.ServiceChannel.Call(string action, bool oneway, System.ServiceModel.Dispatcher.ProxyOperationRuntime operation, object[] ins, object[] outs, System.TimeSpan timeout) + 0x206 bytes           
         System.ServiceModel.dll!System.ServiceModel.Channels.ServiceChannelProxy.InvokeService(System.Runtime.Remoting.Messaging.IMethodCallMessage methodCall, System.ServiceModel.Dispatcher.ProxyOperationRuntime operation) + 0x59 bytes   
         System.ServiceModel.dll!System.ServiceModel.Channels.ServiceChannelProxy.Invoke(System.Runtime.Remoting.Messaging.IMessage message) + 0x65 bytes            
        mscorlib.dll!System.Runtime.Remoting.Proxies.RealProxy.PrivateInvoke(ref System.Runtime.Remoting.Proxies.MessageData msgData, int type) + 0xee bytes 
```

// 首先是上面堆栈中的服务调用...

服务行为是这样的：[ServiceBehavior(InstanceContextMode = InstanceContextMode.Single)]

该错误是在几个小时的持续测试后发生的……在调试时无法重现它……

**编辑：**

多亏了德扬，我得到了追踪结果……

在第一次出现错误时，我收到此消息：**已达到最大挂起连接数。**

在第二次出现时，我收到此消息：**系统达到了为油门“MaxConcurrentConnections”设置的限制。此油门的限制设置为 200。可以通过修改服务油门元素中的属性“maxConcurrentSessions”来更改油门值。**

所以对于第二条消息，我这样做了：

并将此服务行为分配给服务。我是否需要在第一条消息的绑定上设置 maxConnections。此外，这是问题的根本原因，第一个或第二个或两者。因为在随后的消息中，我总是收到第二条消息。

**请指导更新我的 app.config 以避免这种情况。**

**更新**

我有追踪结果...

在第一次出现时，我收到此消息：**已达到最大挂起连接数。**

在第二次出现时，我收到此消息：系统达到了为油门“MaxConcurrentConnections”设置的限制。此油门的限制设置为 200。可以通过修改服务油门元素中的属性“maxConcurrentSessions”来更改油门值。

所以对于第二条消息，我这样做了：

```
 <serviceBehaviors>
    <behavior name="tcpNormalBehavior">
      <serviceThrottling maxConcurrentSessions="800" maxConcurrentInstances="800" maxConcurrentCalls="200" />
      <dataContractSerializer maxItemsInObjectGraph="2147483647" />
    </behavior>
  </serviceBehaviors> 
```

并将此服务行为分配给服务。我是否需要在第一条消息的绑定上设置 maxConnections。此外，这是问题的根本原因，第一个或第二个或两者。因为在随后的消息中，我总是收到第二条消息。

请指导。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-30T09:00:56.273

您有可能在 WCF 服务的某处遇到未处理的异常，例如堆栈溢出。如果我理解正确，该服务可以工作，但会在几个小时后停止工作。

调试 WCF 服务的第一步是[WCF 跟踪](http://msdn.microsoft.com/en-us/library/ms733025.aspx)。启用它，尝试测试您的服务，在它再次停止工作后，.svclog 文件中应该有一个跟踪条目。

*编辑*
关于您更新的问题：您收到该异常是因为您在完成通话后没有从客户端关闭连接。尝试重构您的代码，以便对 WCF 的调用如下所示：

```
WCFProxy clientProxy = null;
try
{
    clientProxy = new WCFProxy();
    clientProxy.SomeCall();
    clientProxy.Close();
}
catch (Exception)
{
    if (clientProxy != null)
    {
        clientProxy.Abort();
    }
    throw;
} 
```

然后看看会不会出问题。

# c# - 在 Monodroid 中导航 Android 活动

> ID：10813004
> 
> 赞同：0
> 
> 时间：2012-05-30T08:54:14.540
> 
> 标签：c#, xamarin.android

在我使用 Monodroid 的 Android 应用程序中，我有几个活动。我注意到（物理）后退按钮并不总是让应用程序返回到之前的活动，正如人们所期望的那样。

此外，如果应用程序崩溃，则当前活动消失，但显示应用程序的先前活动。根据我使用 Java 开发 Android 应用程序的经验，这不是我所期望的行为。所以它可能是一个典型的 Monodroid 东西。我在这里错过了什么吗？

我有一个主要活动（飞溅），显示一次。从活动导航到活动是这样的：

我的主要活动

```
 [Activity(Label = "x", MainLauncher = true, NoHistory = true, Icon = "@drawable/zoeker2", Theme="@android:style/Theme.NoTitleBar")]
    public class SplashActivity : Activity
    {

 private void showLogon()
        {
            System.Threading.Thread.Sleep(500);
            RunOnUiThread(delegate
            {
                StartActivity(typeof(LogonActivity)); 
            });
        } 
```

我的登录活动

```
 [Activity(Label = "x",   Theme = "@android:style/Theme.NoTitleBar")]
    public class LogonActivity : Activity
    {

 void LogonActivity_OnLogonSucceeded(object sender, EventArgs e)
        {
            Tools.Log("Logon Activity. Logon succeeded");
            updateButtonStates();
            var menuActivity = new Intent(this, typeof(MenuActivity));
            StartActivity(menuActivity);
        } 
```

最后是菜单活动

```
 [Activity(Label = "Menu", Theme="@android:style/Theme.NoTitleBar")]
    public class MenuActivity : Activity, ILocationListener, ISensorEventListener 
    { 
```

这里没有什么花哨的。我必须使用其他属性吗？有什么线索吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-30T09:32:03.527

除了使用的 SplashActivity 之外`NoHistory = true`，我希望您记录的活动在 MonoDroid/Android 中的“正常 BackStack 操作”中工作

您对 Java/Android 的体验也应该在 Mono for Android 中看到。

你能试试像 ApiDemo 这样的东西吗 - 在你当前的设置中是否有效 - [https://github.com/xamarin/monodroid-samples/tree/master/ApiDemo](https://github.com/xamarin/monodroid-samples/tree/master/ApiDemo)

如果您仍然看到问题，那么也许您可以发布一个小示例项目，或者您可以将其作为错误/问题报告给[http://bugzilla.xamarin.com/enter_bug.cgi](http://bugzilla.xamarin.com/enter_bug.cgi)

* * *

上：

> 此外，如果应用程序崩溃，当前活动消失，但显示应用程序的先前活动

这听起来很不寻常。您有时确实会看到 Android 在调试会话结束后尝试重新启动以前的应用程序 - 也许这就是您所看到的？

# android - 在按钮 onclick 中调用片段问题

> ID：10813008
> 
> 赞同：0
> 
> 时间：2012-05-30T08:54:28.113
> 
> 标签：android, android-layout, android-fragments

我创建了一个片段扩展类来调用布局如下

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:orientation="vertical" >

   <TextView
        android:id="@+id/date_time_label"
        android:layout_centerVertical="true"
        android:layout_marginLeft="200dp"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content" 
        android:textSize="32dp"
        android:textStyle="bold"

        android:text="time_label"
        />

    <TextView
        android:id="@+id/last_view_time"
        android:layout_toRightOf="@+id/date_time_label"
        android:layout_alignBaseline="@+id/date_time_label"
        android:layout_marginLeft="8dip"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:textSize="32dp"

        />

</LinearLayout>

package com.appnetics;

import java.text.SimpleDateFormat;
import java.util.Date;

import android.os.Bundle;
import android.support.v4.app.Fragment;
import android.view.LayoutInflater;
import android.view.View;
import android.view.ViewGroup;
import android.widget.TextView;

/**
 * DateTime
 */
public class details extends Fragment {
    private static String getDateTimeString(Date time) {
        return new SimpleDateFormat("d MMM yyyy HH:mm:ss")
            .format(time);
    }

    private final String time = getDateTimeString(new Date());

    /** @see android.app.Fragment#onCreateView(android.view.LayoutInflater, android.view.ViewGroup, android.os.Bundle) */
    @Override
    public View onCreateView(
        LayoutInflater inflater,
        ViewGroup container,
        Bundle b)
    {
        View view = inflater.inflate(
            R.layout.details,
            container,
            false);  //!!! this is important

        ((TextView) view.findViewById(R.id.last_view_time))
            .setText(time);

        return view;
    }
} 
```

现在使用它我创建这样的布局

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:orientation="horizontal" >

    <Button
        android:id="@+id/btn_showdetails"
        android:layout_width="100dip"
        android:layout_height="wrap_content"
        android:layout_marginLeft="110dip"
        android:layout_marginTop="15dip"
        android:text="Show Details" />

    <LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:orientation="horizontal" 
     android:id="@+id/my_parent_layout"
    >
    </LinearLayout>

</LinearLayout> 
```

在我说的按钮的点击事件上

```
setOnClickListener(new View.OnClickListener() {

            public void onClick(View v) {

                FragmentManager fragmentManager = getFragmentManager();
                        FragmentTransaction fragmentTransaction = fragmentManager.beginTransaction();
                        details fragment = new details();
                        fragmentTransaction.add(R.id.my_parent_layout, fragment);
                        fragmentTransaction.commit();

            }
        }); 
```

但它引发错误 **方法 getFragmentManager() 未定义类型 new View.OnClickListener(){}**

任何想法如何解决

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-05T07:35:34.423

如果从片段调用活动然后在下面的代码或调用片段到片段然后只需替换代码而不是 startactivity onclick 方法

```
public class FragmentA extends Fragment implements OnClickListener{

    @Override
    public View onCreateView(LayoutInflater inflater, ViewGroup container,
            Bundle savedInstanceState) {

        View v = inflater.inflate(R.layout.fragment_start, container, false);

        Button button1 = (Button) v.findViewById(R.id.StartButton);
        button1.setOnClickListener(this);
        return v;
    }

    @Override
    public void onClick(View v) {
        startActivity(new Intent(getActivity(),testing.class));
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-30T09:01:44.917

在侦听器定义之前声明并将 fragmentManager 设置为 final。

```
final FragmentManager fragmentManager = getFragmentManager();

<your listener declaration> 
```

您应该能够在侦听器中使用它。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-04-23T22:19:22.067

下面的代码有效

```
 Button publishButton =(Button)                                                                                                  
                          fragmentView.findViewById(R.id.publishButton);
    publishButton.setOnClickListener(new View.OnClickListener() {
           @Override
           public void onClick(View view) {
              publish();
           }
      }); 
```

# mysql - mysql转储。文件的位置？

> ID：10813009
> 
> 赞同：8
> 
> 时间：2012-05-30T08:54:29.910
> 
> 标签：mysql, sql, mysqldump

我对我的数据库进行了更新，但找不到该文件，因此我可以下载它。文件位于何处？提前致谢

```
 root@xxxx:~# mysqldump -u root -p cherio > myBackup.sql
    Enter password: 
    root@xxxx:~# find myBackup.sql
    myBackup.sql 
```

编辑：

我试过这个：

```
 root@xxxx:~# find / -name "myBackup.sql"
  /root/myBackup.sql 
```

好的，我必须刷新我的 FTP 才能显示该文件。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-05-30T08:56:20.587

在您进行转储的同一目录上。它是 ./myBackup.sql 而不是 myBackup.sql 执行 ls -all。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-09-16T12:26:52.603

它位于您运行此命令的同一目录中。要检查这一点，请运行“pwd”，它将为您提供当前路径。然后运行命令，它将数据库文件存储在同一目录中。要正确生成生成的文件，请运行以下命令，

```
mysqldump --database --user=root --password your_db_name > export_into_db.sql 
```

这将为您提供“export_into_db.sql”数据库文件。玩它。

享受...

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-30T08:56:50.640

它位于运行转储命令的根目录或当前目录中。在终端上试试这个命令..

```
locate myBackup.sql 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-01-08T14:13:00.763

我有同样的问题。结果是由于某种原因我无法在根目录中创建任何文件。尝试进入一些更深的文件夹例如

```
cd var
cd www 
```

然后执行：

```
mysqldump -uUSERNAME -pPASSWORD DATABASE > backup.sql 
```

# android - 使用我的模块为 android 构建 opencv .a 和 .so 的问题

> ID：10813010
> 
> 赞同：4
> 
> 时间：2012-05-30T08:54:41.200
> 
> 标签：android, opencv

我是 OpenCV 的新手，也是这个小组的新手。目前我正在开发一些需要 OpenCV 库的 android 手机 ICS 项目。我的模块代码是用 C 编写的，在该代码中我想调用一些 OpenCV lib 函数。刚开始，我已经下载了适用于 android 平台的 OpenCV-2.4.0。

*   到目前为止我已采取的步骤：

    1.  将 .a 和 .so 文件从 \OpenCV-2.4.0-android-bin.tar\OpenCV-2.4.0-android-bin\OpenCV-2.4.0\libs\armeabi-v7a 复制到我的模块文件夹中
    2.  将 .h 文件从 \OpenCV-2.4.0-android-bin.tar\OpenCV-2.4.0-android-bin\OpenCV-2.4.0\include 复制到我的模块文件夹中
    3.  在我模块的 android.mk 文件中添加 .h 、.a 和 .so 路径。
    4.  执行构建。

现在我在 libopencv_core.a 中遇到链接错误当我从 .mk 文件中删除 libopencv_core.a 时，构建成功。我认为 libopencv_core.a 对这些函数（gzopen、gzclose 等）的其他库有依赖性

```
prebuilt/linux-x86/toolchain/arm-linux-androideabi-4.4.x/bin/../lib/gcc/arm-linux-androideabi/4.4.3/../../../../arm-linux-androideabi/bin/ld: out/target/product/jaguark/obj/STATIC_LIBRARIES/libopencv_core_intermediates/libopencv_core.a(persistence.cpp.o): in function icvPuts(CvFileStorage*, char const*):persistence.cpp(.text._ZL7icvPutsP13CvFileStoragePKc+0x20): error: undefined reference to 'gzputs'
prebuilt/linux-x86/toolchain/arm-linux-androideabi-4.4.x/bin/../lib/gcc/arm-linux-androideabi/4.4.3/../../../../arm-linux-androideabi/bin/ld: out/target/product/jaguark/obj/STATIC_LIBRARIES/libopencv_core_intermediates/libopencv_core.a(persistence.cpp.o): in function icvGets(CvFileStorage*, char*, int):persistence.cpp(.text._ZL7icvGetsP13CvFileStoragePci+0x26): error: undefined reference to 'gzgets'
prebuilt/linux-x86/toolchain/arm-linux-androideabi-4.4.x/bin/../lib/gcc/arm-linux-androideabi/4.4.3/../../../../arm-linux-androideabi/bin/ld: out/target/product/jaguark/obj/STATIC_LIBRARIES/libopencv_core_intermediates/libopencv_core.a(persistence.cpp.o): in function icvXMLSkipSpaces(CvFileStorage*, char*, int):persistence.cpp(.text._ZL16icvXMLSkipSpacesP13CvFileStoragePci+0x1e2): error: undefined reference to 'gzgets'
prebuilt/linux-x86/toolchain/arm-linux-androideabi-4.4.x/bin/../lib/gcc/arm-linux-androideabi/4.4.3/../../../../arm-linux-androideabi/bin/ld: out/target/product/jaguark/obj/STATIC_LIBRARIES/libopencv_core_intermediates/libopencv_core.a(persistence.cpp.o): in function icvXMLSkipSpaces(CvFileStorage*, char*, int):persistence.cpp(.text._ZL16icvXMLSkipSpacesP13CvFileStoragePci+0x208): error: undefined reference to 'gzeof'
prebuilt/linux-x86/toolchain/arm-linux-androideabi-4.4.x/bin/../lib/gcc/arm-linux-androideabi/4.4.3/../../../../arm-linux-androideabi/bin/ld: out/target/product/jaguark/obj/STATIC_LIBRARIES/libopencv_core_intermediates/libopencv_core.a(persistence.cpp.o): in function icvXMLSkipSpaces(CvFileStorage*, char*, int):persistence.cpp(.text._ZL16icvXMLSkipSpacesP13CvFileStoragePci+0x33c): error: undefined reference to 'gzeof' 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-30T09:54:25.810

您可以按照这些[教程](http://opencv.itseez.com/doc/tutorials/introduction/android_binary_package/android_binary_package.html)了解如何将 OpenCV 用于 android 项目和[NDK-build](http://opencv.itseez.com/doc/tutorials/introduction/android_binary_package/android_binary_package_using_with_NDK.html)。一开始有点棘手。我也遇到了一个库的问题，每次编译后它都消失了，我每次都必须一次又一次地包含。

# javascript - Android 上的本地 Ajax 请求 / Sencha / PhoneGap

> ID：10813013
> 
> 赞同：1
> 
> 时间：2012-05-30T08:54:52.640
> 
> 标签：javascript, android, cordova, extjs

我正在尝试通过本地 Ajax 请求在 PhoneGap 应用程序中加载一些内容。它似乎在 iPhone 上运行良好，但 Android 找不到该文件。

它是这样的：

```
Ext.Ajax.request({
        url: 'file:///android_asset/webapp/content/file.html',
        success: function(response, opts) {
            console.log('response ' + response.responseText);
        }
        failure: function(response, opts) {
            console.log('response ' + response.responseText);
        }
    }); 
```

我已经调整了Manifest并设置了Internet Permission，仍然没有成功。

你有什么主意吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-30T10:03:04.840

我不确定这是否完全满足您的要求，但请查看这个[Phonegap Android 插件](https://github.com/purplecabbage/phonegap-plugins/tree/master/Android)集合。它包括用于在 Android 上为 PhoneGap[上传](https://github.com/purplecabbage/phonegap-plugins/tree/master/Android/FileUploader)和[下载](https://github.com/purplecabbage/phonegap-plugins/tree/master/Android/Downloader)内容的插件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-30T14:59:10.143

在这种情况下，我要做的第一件事就是摆脱对 Sencha 或 jQuery 等第三方库的依赖，直接使用 XHR。存在一个问题，即从文件协议发出请求有时会返回状态 0，而实际上它是 200。大多数库都已修复此问题，但您永远不知道。试试这个 XHR 代码，它应该在 Android 上运行得很好：

```
var request = new XMLHttpRequest();
    request.open("GET", "file:///android_asset/webapp/content/file.html", true);
    request.onreadystatechange = function(){
        if (request.readyState == 4) {
            if (request.status == 200 || request.status == 0) {
                console.log("response " + request.responseText);
            }
        }
    }
    request.send(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-30T20:51:17.033

您使用的是哪个版本的 Sencha Touch？正如西蒙指出的那样，许多库在遇到响应代码 0 时报告失败，Sencha Touch 从 2.0.0 开始修复此问题

[http://www.sencha.com/forum/showthread.php?173577-Ext.data.Connection-fails-when-evaluating-a-file-protocol-s-status](http://www.sencha.com/forum/showthread.php?173577-Ext.data.Connection-fails-when-evaluating-a-file-protocol-s-status)

其次，尝试删除 ULR 的 file:///android_asset/webapp/ 部分，内容目录的相对 url 应该可以正常工作，并减轻您为到达该路径可能进行的任何操作系统检测切换。

```
Ext.Ajax.request({
    url: 'content/file.html',
    success: function(response, opts) {
        console.log('response ' + response.responseText);
    }
    failure: function(response, opts) {
        console.log('response ' + response.responseText);
    }
}); 
```

# iphone - 如何在xcode中拖放文件？

> ID：10813014
> 
> 赞同：0
> 
> 时间：2012-05-30T08:55:00.700
> 
> 标签：iphone, objective-c, ios, xcode, ipad

## 当我拖放任何文件而不是其显示**如下图所示**。

所以我想知道什么是“ **PrizeperdayTests** ”？添加一些文件时我必须检查它吗？如果我不检查怎么办？我问这个问题是因为当我从 Xcode 运行我的应用程序时，它会运行，但是当我尝试使用 api 文件运行我的应用程序时，它会立即关闭。 ![在此处输入图像描述](../Images/c6422fc93bcd3f68e6f9c3d6929645a4.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-30T09:04:21.820

这是由 Xcode 创建的单元测试目标，可能是您选择的项目模板的一部分。

除非您拖入单元测​​试所需的文件，否则您可以不选中“PrizeperdayTests”。

# html - 我怎样才能使 CSS :first-letter 不是标记/HTML 标记功能？

> ID：10813015
> 
> 赞同：3
> 
> 时间：2012-05-30T08:55:05.367
> 
> 标签：html, css, frontend

很简单，我需要将 a 中的第一个字母`<p>`设置为不同的颜色，但有时在该字母之前有一个图像。有没有办法`:first-letter`适用于非 HTML 标签？

CSS：

```
p:first-letter {
    color: red; // this should make the "W" red"
} 
```

HTML：

```
<p><img src="will.jpg">West Philadelphia, Born And Raised</p> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-30T09:24:38.207

**在第一个字母中:after:before 伪类**不起作用所以我为你做了一个技巧我希望这会对你有所帮助:-

```
 p {
  background:url(http://www.dummyimage.com/10x10/000/fff) no-repeat 0 3px;
  text-indent:10px;
  }

p:first-letter {
    color: red; 
  } 
```

演示：- [http://jsbin.com/uwemuy/3/edit](http://jsbin.com/uwemuy/3/edit)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-30T09:18:09.520

使用 CSS 是不可能的。您需要按照建议更改 HTML 或执行一些 javascript hack：

*   查找段落的第一个子 img 元素
*   将它们移到段落的末尾
*   在它们上应用样式定义以显示在文本之前

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-30T09:10:03.453

“先”的意思是先。将您的 HTML 更改为：

```
<p>West Philadelphia, Born And Raised<img style="float:left;" src="will.jpg" /></p> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-30T09:24:15.563

**CSS：**

```
.red_color {
    color: red;
} 
```

**HTML：**

```
<img src="will.jpg"><span class='red_color'>W</span>est Philadelphia, Born And Raised 
```

# html - a: 悬停颜色在谷歌浏览器上无法正常工作

> ID：10813019
> 
> 赞同：4
> 
> 时间：2012-05-30T08:55:30.797
> 
> 标签：html, css, google-chrome

我想用 CSS hover 建立一个链接。我正在使用 font-face 用 JennaSue 制作另一种字体。

CSS：

```
@font-face {
    font-family:JennaSue1;
    src: url(font/JennaSue.otf);  
} 
 @font-face {
    font-family:JennaSue3;
    src: url(font/JennaSue.ttf);  
} 
@font-face {
    font-family:JennaSue2;
    src: url(font/JennaSue.eot);  
} 

#australia {
    position:absolute;
    font-size:40px; 
    left:0px; 
    top:32px; 
    color:#fff; 
    font-family: JennaSue1,JennaSue2,JennaSue3;
}
#australia a {
    text-decoration:none; 
    color:#fff;}
#australia a:hover { color:#b30101; } 
```

HTML：

```
<div id="australia"><a href="#">Australia</a></div> 
```

该字体在 chrome 上运行良好，但当我将链接悬停时，它显示如下[图片](https://s18.postimg.cc/igsdzqytj/before.png)：

[![悬停图像](../Images/8e3837dbdb39e071e7b7726a65f15448.png)](https://i.stack.imgur.com/Eu4Lh.png)

感谢您在此处链接的答案，您可以看到[http://jsfiddle.net/6UdYd/1/](http://jsfiddle.net/6UdYd/1/)；

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-30T09:39:51.660

正如[Grezzo](https://stackoverflow.com/a/10813332/885443)指出的那样，字体似乎有些奇怪。如果你看[这个 fiddle](http://jsfiddle.net/vMCrf/1/)，左边的链接就像你的例子。我添加了一个边框来可视化`a`元素的边界。“j”和“p”在此边界之外突出。通过向其添加底部和左侧填充（如在右侧链接上所做的那样），悬停按预期工作。

我想这有点快速修复，但我真的不知道如何正确地做到这一点。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-30T09:16:21.160

这似乎与 j 的左侧部分位于实际字符区域开始的左侧有关。请参阅此示例（可能必须使用 chrome）[http://jsfiddle.net/JGgHf/](http://jsfiddle.net/JGgHf/)其中 j 的左侧未包含在 div 中。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-30T09:36:11.977

尝试添加一个`font-weight`. 这似乎解决了[问题](http://jsfiddle.net/BramVanroy/6UdYd/2/)。

```
#australia a:hover{
    color:#b30101;
    font-weight: 500;
} 
```

另一种可能性是在左侧添加一点填充，以便文本[适合](http://jsfiddle.net/BramVanroy/6UdYd/5/)a-tag。

```
#australia a{
    text-decoration:none;
    color:#fff;
    padding-left: 3px;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-30T09:15:37.623

[http://jsfiddle.net/rakesh_katti/n37hC/2/](http://jsfiddle.net/rakesh_katti/n37hC/2/)

您发布的代码没有错误。该错误可能与与之相关的其他元素有关。或者你正在使用的字体。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-30T09:45:39.367

尝试：

```
#australia a:link {
    text-decoration:none; 
    color:#fff;
}
#australia a:hover { color:#b30101; } 
```

我发现 Chrome 有时会忽略我的 a 样式，除非我使用 :link 伪代码。

# grails - JDBC 存储中的共享 Compass/Lucene 索引

> ID：10813021
> 
> 赞同：2
> 
> 时间：2012-05-30T08:55:32.350
> 
> 标签：grails, jdbc, lucene, searchable, compass-lucene

使用 Grails 中的可搜索插件（在底层使用 Compass/Lucene），我们尝试在两个不同的 Web 应用程序之间共享搜索索引。一个应用程序仅以只读方式访问数据。另一个应用程序允许修改数据并负责在任何更改时更新索引或根据需要进行完整的重新索引。

为了存储索引，我们使用 JDBC 存储（两个应用程序都指向同一个数据库）[http://www.compass-project.org/docs/latest/reference/html/core-connection.html](http://www.compass-project.org/docs/latest/reference/html/core-connection.html)。

不幸的是，一旦我们在一个应用程序中重建整个索引，另一个应用程序似乎缓存了无效数据，如果执行搜索，则会引发异常：

```
| Error 2012-05-30 09:22:07,560 [http-bio-8080-exec-8] ERROR errors.GrailsExceptionResolver  - IndexOutOfBoundsException occurred when processing request: [POST] /search
Index: 45, Size: 13\. Stacktrace follows:
Message: Index: 45, Size: 13
   Line | Method
->> 547 | RangeCheck  in java.util.ArrayList
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
|   322 | get         in     ''
|   265 | fieldInfo . in org.apache.lucene.index.FieldInfos
|   254 | fieldName   in     ''
|    86 | read . . .  in org.apache.lucene.index.TermBuffer
|   127 | next        in org.apache.lucene.index.SegmentTermEnum
|   158 | scanTo . .  in     ''
|   271 | get         in org.apache.lucene.index.TermInfosReader
|   332 | terms . . . in     ''
|   717 | terms       in org.apache.lucene.index.SegmentReader
|    93 | generate .  in org.apache.lucene.search.PrefixGenerator
|    58 | getDocIdSet in org.apache.lucene.search.PrefixFilter
|   116 | <init> . .  in org.apache.lucene.search.ConstantScoreQuery$ConstantScorer
|    81 | scorer      in org.apache.lucene.search.ConstantScoreQuery$ConstantWeight
|   230 | scorer . .  in org.apache.lucene.search.BooleanQuery$BooleanWeight
|   131 | search      in org.apache.lucene.search.IndexSearcher
|   112 | search . .  in     ''
|   204 | search      in org.apache.lucene.search.MultiSearcher
|   113 | getMoreDocs in org.apache.lucene.search.Hits
|    90 | <init>      in     ''
|    61 | search . .  in org.apache.lucene.search.Searcher
|   146 | findByQuery in org.compass.core.lucene.engine.transaction.support.AbstractTransactionProcessor
|   259 | doFind . .  in org.compass.core.lucene.engine.transaction.readcommitted.ReadCommittedTransactionProcessor
|   246 | find        in org.compass.core.lucene.engine.transaction.support.AbstractConcurrentTransactionProcessor
|   352 | find . . .  in org.compass.core.lucene.engine.LuceneSearchEngine
|   188 | hits        in org.compass.core.lucene.engine.LuceneSearchEngineQuery
|   199 | hits . . .  in org.compass.core.impl.DefaultCompassQuery
|   104 | doInCompass in grails.plugin.searchable.internal.compass.search.DefaultSearchMethod$SearchCompassCallback
|   133 | execute . . in org.compass.core.CompassTemplate
|    57 | doInCompass in grails.plugin.searchable.internal.compass.support.AbstractSearchableMethod
|    66 | invoke . .  in grails.plugin.searchable.internal.compass.search.DefaultSearchMethod
|    37 | search      in grails.plugin.searchable.SearchableService 
```

我们可以将索引从一个应用程序重建到另一个应用程序这一事实进行沟通，以便可以执行一些清理工作。

*   有人对 Grails 和 Searchable 插件有类似的问题吗？
*   是否可以丢弃 Compass/Lucene 缓存的数据？
*   一般可以禁用缓存吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-13T12:40:58.647

在搜索之前清除所有缓存似乎可以解决问题......

```
searchableService.compass.compass.searchEngineFactory.indexManager.clearCache() 
```

# c++ - 为什么这些模板静态函数之一有效，而另一个无效？

> ID：10813033
> 
> 赞同：0
> 
> 时间：2012-05-30T08:56:47.300
> 
> 标签：c++, templates

首先，我的代码片段在`matrix.hpp`：

```
template <class T>
class matrix
{
  public:
    matrix();

    T& operator() (size_t i, size_t j) {return elem[i+j*4];}
    const T& operator() (size_t i, size_t j) const {return elem[i+j*4];}

    // ...

    static matrix<T> identity() {return matrix<T>();}
    static matrix<T> translation(const vector<T>&);
    template <class RT> static matrix<T> rotation_x(RT);

    // ...

};

// ...

template <class T>
inline
matrix<T>
matrix<T>::translation(const vector<T>& v)
{
    matrix<T> result;
    result(0, 3) = v.x;
    result(1, 3) = v.y;
    result(2, 3) = v.z;
    return result;
}

template <class T, class RT>
inline
matrix<T>
matrix<T>::rotation_x(RT angle)
{
    RT ca = std::cos(angle);
    RT sa = std::sin(angle);
    matrix<T> result;
    result(1, 1) = +ca;
    result(1, 2) = -sa;
    result(2, 1) = +sa;
    result(2, 2) = +ca;
    return result;
} 
```

据我所知，这两种实现在技术上没有太大区别。主要区别在于`rotation`与`translation`

然而，g++ 不接受`rotation`我目前的方式：

```
la/matrix.hpp:272:31: error: invalid use of incomplete type 'class la::matrix<T>'
la/matrix.hpp:16:7: error: declaration of 'class la::matrix<T>' 
```

这里发生了什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-30T09:03:44.143

你的类只有一个模板参数，第二个是指模板类的模板函数，所以你需要

```
template <class T>
template <class RT>
inline
matrix<T> matrix<T>::rotation_x(RT angle) { .... } 
```

这适用于函数是否是静态的。

# javascript - 输入字段的多个默认值

> ID：10813039
> 
> 赞同：-1
> 
> 时间：2012-05-30T08:57:05.617
> 
> 标签：javascript, jquery

我希望有一个搜索框输入字段，当不在焦点时会闪烁多个默认值。如在*“纽约”* 3 秒，然后*在“洛杉矶”* 3 秒等，或者模拟这些打字也很好。

我所做的是这个

[http://jsfiddle.net/5aD7W/1/](http://jsfiddle.net/5aD7W/1/)

但问题是 .val() 每隔 3 秒就会被覆盖一次，即使它处于焦点位置也是如此。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-30T09:02:55.273

我想出的一种方法：

```
var words = ['New York', 'Los Angeles', 'Home'];
var $search = $('#searchId');
var index = -1;

function foo() {

    if ($search.is(':focus')) {
        return;
    }
    index++;
    $search.val(words[index % words.length]);
}​

setInterval(foo, 3000); 
```

[**现场演示**](http://jsfiddle.net/wAKXn/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-30T09:03:49.480

你可以像[JsFiddle 上的这个 Demo 那样做](http://jsfiddle.net/Z9Hed/3/)

在 html 中

```
<input id="txtCity" type="text" value="New York"  />​ 
```

输入脚本

```
 arr = ["New York", "Los Angesles", "London"];
txtCity = $('#txtCity');
i=0;
setInterval(function(){ 

    if (txtCity.is(':focus')) 
        return;   
    txtCity.val(arr[i++]);
    if(i==arr.length)
         i = 0;
}, 2000);

$('#txtCity').focus(function(){
    this.value=""
 });
​
​ 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-30T09:01:11.750

您将需要一些脚本来执行此操作，因此 jQuery 是一个不错的方法。简单的标记不会解决您的问题。相关：[使用 Javascript 动态更改 HTML5 输入元素的“占位符”属性](https://stackoverflow.com/questions/3919369/changing-the-placeholder-attribute-of-html5-input-elements-dynamically-using-j)

# android - 从 BroadcastReceiver 唤醒设备

> ID：10813040
> 
> 赞同：0
> 
> 时间：2012-05-30T08:57:18.780
> 
> 标签：android, broadcastreceiver, alarm, wakelock, powermanager

我有一个设置重复警报的应用程序，我希望它唤醒设备，解锁键盘保护，做一些事情，然后释放锁，准备在下一个警报时再次重复。它似乎可以工作，但手机仅在第一次触发警报时唤醒并解锁键盘保护，每次警报重复之后它不会打开屏幕并解锁，尽管警报触发的音频文件每次都会播放。我错过了什么？

```
public class RepeatingAlarmWake extends BroadcastReceiver
{
    @Override
    public void onReceive(Context context, Intent intent)
    {
        PowerManager pm = (PowerManager) context.getSystemService(Context.POWER_SERVICE);
        PowerManager.WakeLock wl = pm.newWakeLock(PowerManager.SCREEN_BRIGHT_WAKE_LOCK | PowerManager.FULL_WAKE_LOCK | PowerManager.ACQUIRE_CAUSES_WAKEUP, "Wake up!");        
        wl.acquire();
        KeyguardManager keyguardManager = (KeyguardManager) context.getSystemService(Context.KEYGUARD_SERVICE); 
        KeyguardLock keyguardLock =  keyguardManager.newKeyguardLock("TAG");
        keyguardLock.disableKeyguard();

        PlayAudio2.INSTANCE.PlayAudio();
        wl.release(); 
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T08:19:44.327

您实际设置旋转警报的代码在哪里？无论如何，您应该使用 RTC_WAKEUP 以便在您的闹钟响起时设备会唤醒。

# c# - PCSC 智能卡读卡器的“友好名称”是如何构建的？

> ID：10813041
> 
> 赞同：4
> 
> 时间：2012-05-30T08:57:20.060
> 
> 标签：c#, .net, smartcard-reader, pcsc, winscard

我使用 WinSCard 列出所有读者，这给了我这样的列表：

```
ASK RDR4x7 0
SCM Microsystems Inc. SCR3320 USB Smart Card Reader 0
SCM Microsystems Inc. SCR3320 USB Smart Card Reader 1
SCM Microsystems Inc. SCR3320 USB Smart Card Reader 2 
```

这很棒，但我不知道哪个名字属于哪个读卡器。

**这些名字从何而来？它们是如何构造的？**

到目前为止我发现的是：在注册表中，有一个`HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services`键。在此键下，您可以找到与读卡器的“服务”（我通过查询 WMI 注册表找到）匹配的子键。例如：为`SCM Microsystems Inc. SCR3320 USB Smart Card Reader`读者提供的服务是`SCR3XX2K`。

这个子键 ( `SCR3XX2K`) 有另一个子键`Enum`，它有多个有趣的值：

*   `Count`：DWORD，连接的阅读器数量
*   `0`, `1`, `2`: STRING，硬件设备 ID

我猜这些是附加到“友好名称”的数字，但我无法弄清楚名称字符串是如何构造的。我需要它来将硬件设备 ID（我通过 WMI 获得）映射到它们的友好名称。

**那么，用于为智能卡读卡器创建“友好名称”的模式是什么，这些值从何而来？**

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-30T09:36:54.193

它们是这三个属性的结合：

```
SCARD_ATTR_VENDOR_NAME
SCARD_ATTR_VENDOR_IFD_TYPE
SCARD_ATTR_DEVICE_UNIT 
```

TechNet 文章[智能卡事件](http://technet.microsoft.com/en-US/library/ff404292%28v=ws.10%29.aspx)在“智能卡读卡器名称”部分对此进行了说明。

`SCARD_???``SCardGetAttrib` [使用函数](http://msdn.microsoft.com/en-us/library/windows/desktop/aa379559%28v=vs.85%29.aspx)请求属性。

该`SCARD_ATTR_DEVICE_SYSTEM_NAME`属性返回`friendly name`您在列出读者时获得的属性。

智能卡读卡器列表存在于注册表中`HKLM\SOFTWARE\Microsoft\Cryptography\Calais\Readers`。读卡器由 SCR 驱动程序的 INF 文件添加到此列表中，因此在驱动程序安装期间。

设备和读卡器之间的链接可以在 SmartCardReader 类中`{50DD5230-BA8A-11D1-BF5D-0000F805F530}`找到`HKLM\SYSTEM\CurrentControlSet\Control\Class\{50DD5230-BA8A-11D1-BF5D-0000F805F5‌​30}`。

# scorm - SCORM 1.2 不同 SCO 的suspended_data

> ID：10813043
> 
> 赞同：1
> 
> 时间：2012-05-30T08:57:27.950
> 
> 标签：scorm

我是 SCORM 本身的新手，我在通过 Moodle 的 LMS API 跟踪进度时遇到问题

SCORM 版本是 1.2

我有这样的结构：

第1课

*   模块1.1

*   模块1.2

...

第2课

*   模块 2.1

ETC

每节课都有一组两种类型的模块：

HTML 模块 - 用户刚刚查看的模块

游戏模块 - 由于模块完整性而获得奖牌（无、铜牌、银牌、金牌）的一些游戏

进度跟踪问题如下：

我需要根据子模块的进度（排序？）来跟踪不同课程的进度。

毕竟：在课程的所有游戏模块完成后，我需要在课程中添加一个开始。星号表示课程级别的某种进展

我想要做的是将模块的进度数据（奖牌）存储在 cmi.suspended_data 变量中作为字符串：

“module1.1,gold|module1.2|silver ...”

之后，我想在每次加载页面时处理该内容，并确定我是否获得了一门课程的 STAR。例如：当我在第 1 课的最后一场比赛中获得奖牌时，现在所有比赛都有奖牌 - 之后我转到第 2 课 - 我应该在第 1 课中加星...

问题是从一个模块到另一个模块，从一个课到另一个模块等等——RESETSsuspended_data 变量。

问题1：挂起的数据是否链接到SCO对象？（这意味着每个模块/课程都有自己的suspended_data var）

问题2：在这种情况下跟踪测序进度的正确方法是什么（正如我所见，scorm 2004 有一些可以在清单中描述的测序机制。这是 1.2 版本中的正确方法）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-07T20:27:13.463

问题 1：cmi.suspend_data 对每个 SCO 都是唯一的，只能从 SCO 内部读取/设置。在您的情况下，SCO2 无法读取 SCO1 的suspend_data，反之亦然。

问题2：你最好在这里坚持单一的SCO方法。您的所有模块和课程都将成为单个 SCO 的一部分，这意味着您将能够无任何问题地跟踪奖牌和用户进度。

# jquery-mobile - 索引'pageinit'上的Jquery Mobile对话框随处弹出

> ID：10813049
> 
> 赞同：0
> 
> 时间：2012-05-30T08:58:10.403
> 
> 标签：jquery-mobile

我在使用 Jquery Mobile 上的对话框时遇到问题。在索引页面上，我想对条款和条件进行对话。该对话框有效，我单击接受，它就消失了。然后当移动到另一个页面时它会再次弹出，并且即使在单击接受后也会反复弹出。

```
<script>
    $(document).bind('pageinit', function (){
        $.mobile.changePage("terms.html", "pop", false, false);
    });
</script> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-30T11:43:39.780

`pageinit`页面初始化时触发。因为您使用`$(document).bind('pageinit', function (){});`了这意味着您绑定到所有 pageinit，而不仅仅是一个。采用

```
$("#page1").bind('pageinit', function (){
     $.mobile.changePage("terms.html", "pop", false, false);
}); 
```

`page1`你的第一页的id在哪里。

或者

```
$(document).bind('pageinit', function (){
    if(!termsAccepted) {
        $.mobile.changePage("terms.html", "pop", false, false);
    }
}); 
```

如果您的应用程序有多个入口点（如移动网页）而不是单个入口点（如移动应用程序，始终从 index.html 开始），则第二种方法会更好

编辑：这可能会更好

```
$(document).one('pageinit', function () {
    $.mobile.changePage("terms.html", "pop", false, false);
}); 
```

# mysql - mysql 客户端中的命令历史记录仅显示多行查询的最后一行

> ID：10813051
> 
> 赞同：6
> 
> 时间：2012-05-30T08:58:19.667
> 
> 标签：mysql, osx-lion, readline, gnu-screen, tmux

我在 Screen/Tmux 中使用 Mysql 的命令行客户端，来自 OSX 的 Terminal.app 中的 Bash。当使用向上箭头重新显示先前运行的查询时，该查询跨越的范围超过在线，并且当光标位于终端的最后一行时，mysql 的命令历史记录中的命令会被“截断”或切断。当我在我的 Ubuntu 工作站上使用相同的工具时，这永远不会发生

这是所发生情况的直观表示：

输入一些查询；这里没有错。

```
+-------------------------------------------+
|mysql>                                     |
|mysql>                                     |
|mysql>                                     |
|mysql>select * from tables where legs = 4 a|
|nd colour = 'green';                       |
+-------------------------------------------+ 
```

运行它，显示结果：

```
+-------------------------------------------+
|| 2 | ....... | ..... |                    |
|+---+---------+-------+                    |
| x rows in set (0.00 sec)                  |
|                                           |
|mysql>                                     |
+-------------------------------------------+ 
```

点击 [arrow-up] 重新显示最后一个查询给我留下了：

```
+-------------------------------------------+
|| 2 | ....... | ..... |                    |
|+---+---------+-------+                    |
| x rows in set (0.00 sec)                  |
|                                           |
|nd colour = 'green';                       |
+-------------------------------------------+ 
```

再次点击[向上箭头]，我得到：

```
+-------------------------------------------+
|| 2 | ....... | ..... |                    |
|+---+---------+-------+                    |
| x rows in set (0.00 sec)                  |
|mysql>select * from tables where legs = 4 a|
|nd colour = 'green';                       |
+-------------------------------------------+ 
```

可以通过更改设置来解决吗？还是Mysql客户端的bug？

软件版本：

```
OSX 10.7.3
Terminal Version 2.2.2 (303)
GNU bash, version 3.2.48(1)-release (x86_64-apple-darwin11)
mysql  Ver 14.14 Distrib 5.5.19, for osx10.7 (i386) using readline 5.1
Screen version 4.00.03 (FAU) 23-Oct-06
tmux 1.6 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-06-15T01:42:33.163

在这方面，你有几个我能想到的让你的生活更轻松的选择：

*   **readline 命令与 mysql 选项相结合**：readline 接受类似于[基本 emacs 命令](http://lpn.rnbhq.org/tools/xemacs/emacs_ref.html)的命令（也可以设置为 vi），或者示例 CTRL-a 将您返回到行首。

    这与您设置`set horizontal-scroll-mode On`的[readline](http://unixhelp.ed.ac.uk/CGI/man-cgi?readline%203)相结合`~/.inputrc`，它允许您以 1 条直线获取输入，将光标放在最后。结合 CTRL-a 可以立即跳转到开头，非常方便。

    `~/.inputrc`：

    ```
    $if Mysql
        set horizontal-scroll-mode On`
        # uncomment the commands below to use vi keybindings
        #set keymap vi
        #set editing-mode vi
    $endif 
    ```

    （某些系统，OSX 10.5 肯定我相信使用 libedit 而不是 readline，在这种情况下`~/.editrc`，如果您不确定您的系统发出`mysql --version`命令，则需要将其全部放入）

    要查找您发出的命令，您也有`CTRL-r`，它允许您输入一个术语，并且您的历史记录将被搜索最后一次出现。

    有趣的命令是：

    *   CTRL-P 转到历史记录中的上一个命令
    *   CTRL-N 转到历史记录中的下一个命令
    *   CTRL-R 反向搜索你的历史
    *   CTRL-S 向前搜索你的历史
    *   CTRL-A 将光标移动到行首
    *   CTRL-E 将光标移动到行尾
    *   CTRL-W 向后删除一个单词
    *   ALT-D 向前删除一个单词
    *   CTRL-F 将光标向前移动 1 个字符
    *   CTRL-B 将光标向后移动 1 个字符
    *   ALT-F 将光标向前移动 1 个单词
    *   ALT-B 将光标向后移动 1 个单词
    *   ALT-_撤消

    根据您的外壳和底层，它们可能并非全部工作或被拦截。例如，在我在 kde 上使用的 Konsole 上，我必须在高级设置中禁用流控制以允许使用 CTRL-s 等。

    最后 mysql 还为您提供了[\e 命令](http://dev.mysql.com/doc/refman//5.5/en/mysql-commands.html)，该命令允许您在通用文件编辑器中编辑命令，如果您不喜欢 vi 或 emacs，请尝试 nano，它很简单而且效果很好。使用它的主要缺点是，当向上滚动换行时，制表符会被忽略，而空格则不会。这只是一个 unix 的东西，但 OS X 应该在那里做得很好，因为我没有任何苹果电脑，所以无法检查，抱歉。:)

    为了更容易地使用这个命令，您可以在其中放入一个 readline 字符串宏，`~/.inputrc` 例如`Control-o: "\\e;\n"`将 CONTROL-o 绑定到 \e; 然后*输入*以立即执行。（查看[键绑定部分](http://www.delorie.com/gnu/docs/readline/rlman_32.html)）

*   **使用备用外壳**：例如[altSQL](http://ewaters.github.com/altsql-shell/)：它提供语法着色、漂亮的历史滚动和其他一些细节，最大的好处是您拥有源代码，因此您可以调整您想要的内容。

*   **放下外壳并使用 GUI**：最后，我想插入漂亮的[MySQL 工作台](http://www.mysql.com/products/workbench/)来处理您的数据库，它是跨平台的、免费的，并且在我看来是一个不错的工具。

我意识到这不是一个完美的解决方案，每个都有优点和缺点，但我希望这对你有所帮助。

# c# - 使用基本控制类处理母版页面板

> ID：10813053
> 
> 赞同：1
> 
> 时间：2012-05-30T08:58:32.223
> 
> 标签：c#, vb.net, asp.net-2.0

我有管理模块。该模块有一个母版页，左侧没有面板。我必须使用用 VB 语言构造的基本控件类使这个面板可见和不可见。我正在使用带有 c# 网站的 asp.net 2.0。

请告诉我如何在链接按钮单击事件上构建此基本控件类并使用母版页管理面板。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-30T09:38:13.240

我们将有很多机会实现它。我更喜欢使用[外观模式](http://en.wikipedia.org/wiki/Facade_pattern)。

构造一个内部使用 VB 类的类：

```
public newManageClass()
{
    private oldManagedVBClass _old;

    //.ctor
    public newManageClass()
    {
        _old = new oldManagedVBClass();
    }

    public void makePanelsVisible()
    {
        _old.MakePanelsVisible();
    }
} 
```

然后你可以在你的母版页中使用这个类作为帮助类。

# c# - 在 C# 中动态创建变量

> ID：10813062
> 
> 赞同：1
> 
> 时间：2012-05-30T08:59:05.057
> 
> 标签：c#, visual-studio, visual-studio-2008

我正在尝试做这样的事情：

```
for (int i = 1; i < nCounter ; i++)
{
    string dvName = "dv" + i.ToString();
    System.Windows.Forms.DataGridView dvName = new DataGridView();
    // other operations will go here..
} 
```

你可以猜到，我想做的是 at `i == 1`，创建一个`DataGridView`with name `dv1`，并且 at `i == 2`，创建一个`DataGridView`with name `dv2`，但我做不到。

Visual Studio squiggles 说***“一个名为 dvName 的局部变量已在此范围内声明”***我还尝试了以下操作：

```
for (int i = 1; i <nCounter ; i++)
{
    System.Windows.Forms.DataGridView dv & i = new DataGridView();
    // other operations will go here..
} 
```

但是 VS 再次出现曲线，我希望你明白我想要完成的事情。谁能建议我该怎么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-30T09:07:35.313

你真正需要的是一个`Dictionary<int, DataGridView> grids`. 将其填充到您的 for 循环 ( `grids[i] = new DataGridView();`) 中，然后使用所需的网格 ( `grids[someCalculatedIndex]`)

希望这可以帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-30T09:09:39.523

尝试一个可以保存变量的数据结构，例如dict等

```
 System.Collections.Generic.Dictionary<string,System.Windows.Forms.DataGridView>
          grids = new Dictionary<string,System.Windows.Forms.DataGridView>();

for (int i = 1; i <nCounter ; i++)
{
    grids.Add("dv" + i.ToString(), new DataGridView());            
}

// to work on grid 1
DataGridView grid1 = grids["dv1"];
// so on 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-30T09:10:01.893

所以你正在尝试动态创建变量名？那是不可能的。为什么不使用数组或列表（甚至字典）？还是您只想设置控件的名称？

```
var list = new List<DataGridView>();

for (int i = 1; i <nCounter ; i++)
{
    System.Windows.Forms.DataGridView dvName = new DataGridView();
    dvName.Name = "dv" + i.ToString();
    list.Add(dvName);
    // other operations will go here..
}

foreach (var dv in list)
{    
    ...do something... 
}

DataGridView secondDv = list.Single(dv=>dv.Name == "dv2");
secondDv.DoSomething() 
```

不清楚你想做什么...

# spring-security - Spring Security 和多个 ldap 配置

> ID：10813066
> 
> 赞同：13
> 
> 时间：2012-05-30T08:59:09.760
> 
> 标签：spring-security, ldap, high-availability

我使用 Spring Security 来管理用户和组证券。

所有数据都存储在 ldap 服务器中。我的配置如下：

```
 <authentication-manager alias="authenticationManager">
         <ldap-authentication-provider 
           user-search-filter="(mail={0})"
           user-search-base=""
           group-search-filter="(uniqueMember={0})"
           group-search-base="ou=groups"
           group-role-attribute="cn"
           role-prefix="ROLE_"
           user-context-mapper-ref="contextMapper">
         </ldap-authentication-provider>
         <lda
  </authentication-manager>

  <beans:bean id="contextMapper" class="com.mycompany.CustomContextMapper">
    <beans:property name="indexer" ref="entityIndexer" />
  </beans:bean>

  <ldap-user-service  server-ref="ldapServer" user-search-filter="(mail={0})" />

  <ldap-server manager-dn="cn=admin,dc=springframework,dc=org" manager-password="password" url="ldap://server/dc=springframework,dc=org" id="ldapServer" /> 
```

一切都像魅力一样运行。现在，如果第一个 ldap 服务器关闭（回退），我想添加第二个 ldap 服务器。我找不到一个简单的方法来做到这一点。

所以，我的问题很简单：如果第一个服务器关闭，如何在此配置中添加第二个 ldap 服务器以提供后备？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-05-30T13:50:35.597

对 url 属性使用空格分隔值：

```
url="ldap://server1/dc=springframework,dc=org ldap://server2/dc=springframework,dc=org" 
```

参考：[LDAP 和 LDAPS URL](http://docs.oracle.com/javase/jndi/tutorial/ldap/misc/url.html)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-13T20:22:55.293

前面的答案是正确的。

我想添加有关 LDAP 服务器冗余的信息。由于这是添加多个 LDAP url 的目标，希望它有用。

我测试了几个场景：

对于 LDAP 服务器 url(url1, url2)

***如果 urls 指定的两个 LDAP 服务器都关闭，应用程序登录将失败。***

***如果一台 LDAP 服务器停机。将 server1 视为 url1 ： ldap://url1 （无论 url1 位于第 1 位还是第 2 位），应用程序都可以正常工作。***

**如果任一 url 语法错误： url1 : ldap://MALFORMED_URL ，应用程序将无法启动。**

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-05-30T13:50:07.607

这太简单了，我错过了。

只需配置多个以空格分隔的 url 即可：

```
<ldap-server ... url="ldap://server1/dc=springframework,dc=org ldap://server2/dc=springframework,dc=org" /> 
```

# css - 在 Internet Explorer 中，中心 DIV 显示在页面底部

> ID：10813071
> 
> 赞同：0
> 
> 时间：2012-05-30T08:59:37.857
> 
> 标签：css, internet-explorer

我在 Internet Explorer 中的 div 有问题。我有一个三列布局，它可以在除 Internet Explorer 之外的所有浏览器（chrome、firefox、safari）中正确显示。在 IE 中，中间 div 显示在页面底部而不是侧边栏之间。

几天来我一直在尝试找出问题所在。我确定这与我的 CSS 有关，但我不确定。

任何帮助，将不胜感激！

我的网站是：[http ://www.onedirectionconnection.com](http://www.onedirectionconnection.com)

这是CSS：

```
div#container {
    margin-left: auto;
    margin-right: auto;
    margin-top: 0px;
    width: 1125px;
    text-align: left;
}

div#header {
    clear: both;
    height: 500px;
    margin-top: 0px;
    padding: 0px;
    border: 0px
}

div#navi {
    text-align: center;
    background: #FFFFFF;
    clear: both;
    height: 60px
    margin-left: 13px;
    margin-right: 13px;
    margin-bottom: 10px;
    padding-left: 39px;
    border-bottom: 3px solid #FF0000;
    border-top: 3px solid #FF0000;
}

div#left {
    float: left;
    width: 320px;
}

div#right {
    float: right;
    width: 320px;
}

div#middle {
    padding: 0px 325px 5px 325px;
    margin: 0px;
} 
```

我只包含了我认为与问题相关的部分，但如有必要，任何人都可以随时在我的网站上提供代码！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-30T09:05:22.663

增加容器的宽度或减少一些边距。

```
#middle
{
 padding: 0px 0px 5px 0px;
 margin: 0px;
 overflow: hidden;
 width: 485px;
 float: left;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-30T09:25:18.287

您需要处理 DIV 的定位。左边的div没问题。在左 div 和右 div 之后添加中间 div。

加到`float: left; width: 400px; margin: 0;`中间。并调整中间 DIV 子元素的宽度。

# c++ - 为 WIN CE 仿真器 5.0 开发的应用程序不能在 WIN CE 设备 6.0 上运行？

> ID：10813074
> 
> 赞同：0
> 
> 时间：2012-05-30T08:59:41.523
> 
> 标签：c++, windows-mobile, windows-ce, emulation

> **可能重复：**
> [为什么在 WIN CE 6.0 中运行简单的控制台应用程序但基于对话框的不运行？](https://stackoverflow.com/questions/10959134/why-simple-console-app-runs-but-dialog-based-does-not-run-in-win-ce-6-0)

我正在嵌入式 VC++ 4 中开发应用程序。当我选择 WIN CE 模拟器 5.0 作为平台时，它可以正确运行。但是，当我将生成的模拟器文件复制到具有 WIN CE 6.0 的真实设备时，它不起作用。

为什么？我该怎么办？

谢谢，

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-30T12:41:56.593

主要问题是，当您在 Win CE 5.0 中构建模拟器时，您正在构建 x86 指令集。根据设备的不同，您可能必须针对 ARM 指令集进行编译。

基本上，您还需要实际的 SDK，用于您要为其发布软件的设备。但是，没有标准的 windows CE 6.0 SDK。相反，设备制造商使用 Windows Platform Builder 工具创建它们。您必须找出在哪里可以获得适用于您设备的 SDK 并针对该平台进行编译。

# javascript - 如何使用 Javascript 在 MS Dynamics CRM 2011 中禁用系统功能区按钮？

> ID：10813075
> 
> 赞同：0
> 
> 时间：2012-05-30T08:59:47.467
> 
> 标签：javascript, dynamics-crm-2011, dynamics-crm-4

> **可能重复：**
> [在 CRM 2011 中禁用系统功能区](https://stackoverflow.com/questions/8942676/disable-system-ribbon-in-crm-2011)

任何人请解释如何禁用系统功能区按钮，如“保存”、“保存并关闭”

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-01T07:19:02.223

禁用“保存”和“保存并关闭”的最佳方法是取消用户的“更新”权限 - CRM 将自动为您禁用这些按钮。

如果您需要根据一些基于记录的条件执行此操作，您可以使用 Ribbon Workbench for Dynamics CRM：

1) 创建一个解决方案，包括您希望更改的实体（或添加应用程序功能区以在所有功能区上进行更改）

2) 添加一个包含您可能需要使用的任何 javascript 函数的网络资源

3) 将解决方案加载到 Ribbon Workbench

4) 更改为“表格”功能区

5）选择“保存”按钮并右键单击->“自定义命令”

6) 在“解决方案元素”中找到命令并更改启用规则。

7) 如果您不需要自定义任何核心启用/显示规则，您可以将“IsCore”属性更改为 True，以便它使用基本定义。

如果您需要任何支持 - 您可以使用[http://ribbonworkbench.uservoice.com/](http://ribbonworkbench.uservoice.com/) “联系我们”。

斯科特

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-30T10:19:15.763

这是在电子邮件实体上隐藏“插入模板”功能区按钮的示例。只需修改它以禁用您必要的按钮。

```
var buttonID = "email|NoRelationship|Form|Mscrm.Form.email.ApplyTemplate-Large"; // id of ribbon button
var btn = window.top.document.getElementById(buttonID);
if(btn)
{
   btn.disabled = true;
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-31T07:53:07.917

尝试使用[CRM 2011 Visual Ribbon Editor](http://crmvisualribbonedit.codeplex.com/)。我认为最简单的方法是，如果您使用 CRM On-Premises。

如果没有，请尝试[适用于 Dynamics CRM 2011 的 Ribbon Workbench](http://www.develop1.net/public/page/Ribbon-Workbench-for-Dynamics-CRM-2011.aspx)

# image - 图像和视频同步到客户端的工具

> ID：10813078
> 
> 赞同：1
> 
> 时间：2012-05-30T08:59:54.243
> 
> 标签：image, apache-flex, video, sync, offline

我支持 Flex 客户端 - 服务器并且客户端大部分时间都处于脱机状态。这个想法是用户将整天与客户端一起工作，并通过同步数据连接到网络。客户目前没有任何类型的媒体，例如产品图片或视频，但我们希望实现这一点。

我正在寻找一种价格合理的工具或开源工具，它可以通过将服务器上的主文件夹基本上同步到客户端上的文件夹来帮助通过网络同步图像/视频

我尝试过 Microsoft 的 SyncToy，但评论对于所涉及的数据量不是很好

我正在看 Telelogos 的 MediaTransfer，它很好但价格过高

我觉得必须有更好的工具甚至更好的方法——我愿意接受不同方法的建议。谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-10-05T02:11:06.477

以下是一些媒体服务器：

*   [Adobe 媒体服务器](https://www.adobe.com/products/adobe-media-server-family.html)
*   [Gnump3D](https://www.gnu.org/software/gnump3d/)
*   [达尔文流媒体服务器](http://dss.macosforge.org/)
*   [视窗媒体服务器](http://technet.microsoft.com/en-us/library/cc727428)
*   [LEADTOOLS 多媒体开发工具包](http://www.leadtools.com/sdk/multimedia.htm)
*   [IceCast 流媒体服务器](http://icecast.org/docs/icecast-2.3.3/)

这是一个客户：

*   [XBMC](http://xbmc.org/about/)

Adobe 有一个关于如何将其产品与移动客户端集成的教程：

*   [Adobe Media Server：将视频流式传输到 iOS](https://www.adobe.com/devnet/adobe-media-server/articles/streaming-video-ios.html)

Mozilla 有一个关于设置支持自适应流媒体文件的教程：

*   [设置自适应流媒体源](https://developer.mozilla.org/en-US/Apps/Build/Audio_and_video_delivery/Setting_up_adaptive_streaming_media_sources)

Haxe 在他们的实验性 RTMP 服务器上有一个教程：

*   [斧头视频](https://code.google.com/p/haxevideo/wiki/Help)

苹果有 Darwin Streaming Server 商业版的教程：

*   [准备用于 Internet 传输的电影](https://support.apple.com/kb/HT2438)

微软有一个 IIS 流插件的教程：

*   [Apple HTTP Live Streaming 与 IIS 媒体服务](http://www.iis.net/learn/media/live-smooth-streaming/apple-http-live-streaming-with-iis-media-services)

最后，有一个关于将 Gnump3d 作为 Windows 服务运行的教程：

*   [将 Gnump3d 安装为 Windows 服务](http://www.gnu.org/software/gnump3d/Gnump3d-Service-on-Windows.txt)

# jquery - JQuery 内容在 IE8 中消失

> ID：10813082
> 
> 赞同：1
> 
> 时间：2012-05-30T09:00:24.843
> 
> 标签：jquery, html

我在 IE7/IE8 中遇到 JQuery 问题。我下面的代码位于我的页面顶部，它被插入到 CMS 页面中。然后将内容（FAQ 导航）加载到主页的空 div 中。

```
<script type="text/javascript" src="/wcsstore/MadisonsStorefrontAssetStore/images/js/jquery-1.7.2.min.js"></script>
<script type="text/javascript">
$.get('/wcsstore/MadisonsStorefrontAssetStore/images/contentspots/viva/faqnavigation.html', function(data) {
 $('#faq_links').html(data);
});
</script> 
```

正如您从上面看到的那样，内容然后被插入到我页面中的空 div 中，这是页面中的第一个。

```
<div id="faq_links"></div> 
```

我已经在 FF、Opera、Safari、Chrome 和 IE9 中测试过，一切都很好，问题来自 IE7 + IE8。有时导航会加载（但选择一个链接会使它再次消失）其他时候它只是在它应该在的地方留下一个空白区域。它链接的文件只是一个简单的 ul，大约有 20 个链接。

我尝试在页面中添加一个警报，以查看它是否没有通过添加来加载 JQuery

```
alert('Load was performed.'); 
```

就在 }); 哪个有效，并且每次加载页面时都会弹出“已加载”但仍未加载内容。

我无法将您链接到该页面，因为它位于开发 CMS 中。任何有助于找出为什么它使我的导航消失的帮助都会被应用。

我很乐意回答您可能有的任何问题或在需要时提供更多信息。

谢谢。马特。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-30T09:07:09.193

尝试添加`$(document).ready`：

```
<script type="text/javascript">
$(document).ready(function(){
   $.get('/wcsstore/MadisonsStorefrontAssetStore/images/contentspots/viva/faqnavigation.html',   function(data) {
    $('#faq_links').html(data);
   });
})
</script> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-30T09:09:38.890

尝试在请求中添加随机数....我不知道它是否可以解决问题...我希望如此

```
$(document).ready(function(){
    $.get('/wcsstore/MadisonsStorefrontAssetStore/images/contentspots/viva/faqnavigation.html', { rnd: Math.floor(Math.random()*11) }, function(data) {
    $('#faq_links').html(data);
     });
  }); 
```

# python - 如何将循环中变量的输出保存到 python 中的列中的文本文件中？

> ID：10813083
> 
> 赞同：1
> 
> 时间：2012-05-30T09:00:26.747
> 
> 标签：python, text-files

我正在从图形生成随机边并打印它们，但每次我尝试将其保存到文本文件时，都会出现类似`TypeError: expected a character buffer object`. 代码如下：

```
import re
import md5
import pickle
import networkx as nx
import itertools
from random import choice

ff=open("testfile.txt","r+")
G=nx.read_gpickle("authorgraph_new.gpickle")
for nodes in G:
    random_edge=choice(G.edges())
    ff=open("testfile.txt","a")
    ff.write(random_edge) 
```

我需要将 random_edge 的输出保存在文本文件中，最好保存在列中，因为 的值`random_edge`采用`(abcdef, pqrstu)`. 我想将两者放在同一行的单独列中，并将下一个值放在同一列中。我知道我可以使用`"\n"`来获取换行符的输出但是当我使用

```
ff.write(random_edge + "\n") 
```

我得到一个错误`TypeError: can only concatenate tuple (not "str") to tuple`。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-30T09:11:44.390

在这种情况下，您可以尝试用 2 行来完成，例如：

```
for nodes in G:
    ff.write(random_egde)
    ff.write('\n') 
```

希望这对您的情况有用。
这里第一行写入您的数据，而第二行向数据添加新行。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-30T12:58:24.043

Joel 的评论是正确的：您将结果（元组）与换行符（一个字符串）连接起来。Python 不喜欢以这种方式混合数据类型。如果您正在编写更复杂的结构化数据，那么将来您可能还想研究 python 的 csv 模块。

# directshow - 使用 DirectShow 预览 1080P 视频的问题

> ID：10813084
> 
> 赞同：1
> 
> 时间：2012-05-30T09:00:27.737
> 
> 标签：directshow, preview, frame-rate

我在我的应用程序中使用 DirectShow 从网络摄像头捕获视频。我在使用相机预览和捕捉 1080P 视频时遇到问题。例如：罗技的 HD Pro Webcam C910 摄像头。1080P 视频预览非常生涩，没有观察到高清清晰度。我可以看到枚举的设备名称是“USB 视频设备”

今天我们在这些 XP 机器上安装了罗技网络摄像头软件。在该应用程序中，我们可以毫无抖动地观看 1080P 视频。此外，我们在罗技应用程序中录制了 1080P 视频，并以高质量观看了它们。

但是当我测试我的应用程序时，

1.  我可以看到枚举的设备名称已更改为“Logitech Pro Webcam C910”，而不是之前的“USB 视频设备”。

2.  我的应用程序占用的 CPU 是 20%，但进程“SYSTEM”占用了 60%+，整个 CPU 围绕 100% 旋转

    1.  尽管视频质量已经大大提高，但仍然存在混蛋，这可能是由于 100% 的 CPU。

    2.  当我关闭我的应用程序时，“系统”进程的高 CPU 使用率消失了。

关于我的应用程序 - 它使用 ICaptureGraphBuilder2::RenderStream 创建预览和捕获流。

在 Capture Stream 中，我将相机过滤器连接到 NULL 渲染器，并使用样本采集器作为中间过滤器。

在预览流中，我有

```
g_pBuild->RenderStream(&PIN_CATEGORY_PREVIEW,&MEDIATYPE_Video,cam,NULL,NULL); 
```

预览显示在使用 IVideoWindow 接口指定的窗口上。我使用以下

```
g_vidWin->put_Owner((OAHWND)(HWND)hWnd);
g_vidWin->put_WindowStyle(WS_CHILD | WS_CLIPSIBLINGS);
g_vidWin->put_MessageDrain((OAHWND)hWnd); 
```

我尝试将帧速率设置为不同的值（ AvgTimePerFrame = 500000 ( 20 fps ) 和 666667(15 fps) 等。

但是所有的试验，仍然给出相同的结果。清晰度变得更加清晰，但仍然存在一些混蛋，由于“系统”的利用率超过 60%，CPU 几乎是 100%。当我关闭我的视频应用程序时，“系统”的使用率会回到 1-2%。

非常欢迎对此提供任何帮助。

提前致谢，

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-15T08:24:23.120

使用**IAMStreamConfig.SetFormat()**选择来自捕获设备的输出流（捕获和预览）的帧速率、尺寸、色彩空间和压缩。

旁白：上面的*“它不会改变源过滤器自己的速率”的评论*是完全错误的。这个接口的全部目的是定义捕获视频的输出格式和帧率。

使用**IAMStreamConfig.GetStreamCaps()**确定可用的帧速率、尺寸、色彩空间和压缩格式。大多数相机提供多种不同的格式。

听起来您面临的根本问题是 USB 带宽（至少在 USB3 之前）在没有压缩的情况下无法维持 30fps 1080P。我最熟悉的是 Microsoft LifeCam Studio 系列的 USB 摄像头，这些设备执行硬件压缩以通过网络发送视频，然后在接收端占用大量 CPU 将 Motion JPEG 压缩视频转换为转换成 YUV 格式。大概罗技相机以类似的方式工作。

相机产生的帧率受到在软件中执行自动对焦、自动​​色彩校正和自动曝光的额外工作量的影响。如果可能，请尝试禁用相机上的所有这些功能。在 Skype 时代，摄像头软件和硬件已经不再那么注重保持高帧率，而是为了更好的图像质量。

只要相机指示帧丢失，即使相机无法以请求的速率生成帧，用于捕获的 DirectShow 时序模型也会继续工作。它使用与每个捕获的帧一起骑行的“丢帧”计数字段来执行此操作。丢弃的帧加上“真实”帧的总和**必须**等于通过**IAMStreamConfig.SetFormat()**设置的请求帧速率。

在 I7 上使用 LifeCam Studio，我以 30fps 720p 预览，压缩为 H.264 并使用大约 30% 的 CPU 将 .mp4 文件写入磁盘，但前提是所有自动对焦/颜色/曝光设置在相机上被禁用。

# c# - BitmapPalette 内存不足异常

> ID：10813085
> 
> 赞同：1
> 
> 时间：2012-05-30T09:00:30.170
> 
> 标签：c#, wpf, winforms, png, gdi+

我有以下循环运行的代码。

```
public void Test(Bitmap bmp)
{
   FormatConvertedBitmap fBitmapSource = new FormatConvertedBitmap();
   PngBitmapEncoder pngBitmapEncoder = new PngBitmapEncoder();
   BitmapImage bi = new BitmapImage();

   using (MemoryStream ms = new MemoryStream())
   {
      bmp.Save(ms, ImageFormat.Png);
      bmp.Dispose();
      bmp = null;

      bi.BeginInit();
      bi.StreamSource = ms;
      bi.EndInit();

      BitmapPalette pallete = new BitmapPalette(bi, 256);
      ... 
```

最后一行

```
BitmapPalette pallete = new BitmapPalette(bi, 256); 
```

有时会抛出以下异常

```
Insufficient memory to continue the execution of the program.at System.Windows.Media.Imaging.BitmapPalette..ctor(BitmapSource bitmapSource, Int32 maxColorCount) 
```

有任何想法吗 ？我显然有足够的内存来继续执行。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-30T13:32:13.190

托管程序中还有其他 OutOfMemoryException 来源与托管内存不足无关。当它转换旧本机代码返回的错误代码时也会引发异常。就像 COM 方法调用可以返回的 E_OUTOFMEMORY 错误一样。与您的情况相关，由 GDI+ 提供。其中只有 20 个不同的错误代码表示失败，您会发现它们记录在[这个答案](https://stackoverflow.com/questions/2610416/is-there-a-reason-image-fromfile-throws-an-outofmemoryexception-for-an-invalid-i/2610506#2610506)中。其中之一是 OutOfMemory。

这可能意味着不止一件事。用完*非托管*内存，GDI+ 用来存储位图像素的那种内存肯定是有可能的。这也可能意味着您的进程已用完可用的 GDI 对象句柄，Windows 规定了 10,000 个 GDI 句柄的句柄配额。顺便说一句，这是一个巨大的数字，超过该配额几乎总是表明代码中存在错误。手柄泄漏。在托管程序的情况下，这几乎总是由于忘记使用 Image.Dispose() 方法并且没有足够频繁地运行垃圾收集器以允许终结器释放句柄。

可悲的是，它甚至可能由损坏的位图数据触发，这在您的情况下不太可能，因为您在分配调色板时轰炸了。这表示句柄泄漏，应该在 Taskmgr.exe 的“进程”选项卡中很容易看到。查看 + 选择列并勾选 GDI 对象。在测试过程中，请密切注意过程的显示值。稳步增长的数字会带来麻烦，当它达到 10,000 时，节目就结束了。另请查看“提交大小”列，这可能会显示您在消耗过多非托管内存时遇到的麻烦。

# mysql - 如何使用 IN 运算符但使用 AND 条件

> ID：10813088
> 
> 赞同：1
> 
> 时间：2012-05-30T09:00:46.457
> 
> 标签：mysql, sql

我有两张桌子`Person`和`Interest`

`Person`表结构

```
Id | Name 
```

`Interest`表结构

```
Id | Person Id | Interest Category 
```

我的问题是如何找到喜欢“音乐”和“电影”和“运动”类别的人。类别将是动态的。

所以它会喜欢使用 IN 运算符，但在 IN 运算符中使用 AND 条件而不是 OR 条件。

```
SELECT `Person Id` FROM Interest
WHERE `Interest Category` IN ('music', 'movie', 'sport'); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-30T09:23:58.037

你可以使用`HAVING COUNT`. 这个数字也必须是动态的。

```
SELECT person_id
FROM interest
WHERE interest_category IN ( 'music', 'movie', 'sport');
GROUP BY person_id
HAVING COUNT(*) = 3; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-30T09:15:39.707

```
SELECT DISTINCT p.id
FROM Person p
JOIN Interest i1 ON p.id = i1.person_id AND i1.interest_category = 'music'
JOIN Interest i2 ON p.id = i2.person_id AND i2.interest_category = 'movie'
JOIN Interest i3 ON p.id = i3.person_id AND i3.interest_category = 'sport' 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-30T11:03:03.667

尝试这个

```
 SELECT DISTINCT DECODE(A.RES, B.RES, I.INTEREST_CATEGORY, 'FALSE') AS FINAL_RES
  FROM INTEREST I,
       TABLE(SYS.DBMS_DEBUG_VC2COLl('music', 'movie', 'sport')),
       (SELECT LENGTH(WM_CONCAT(COLUMN_VALUE)) AS RES
          FROM TABLE(SYS.DBMS_DEBUG_VC2COLl('music', 'movie', 'sport'))) A,

```
 (SELECT LENGTH(WM_CONCAT(DISTINCT I.INTEREST_CATEGORY)) AS RES
      FROM TABLE(SYS.DBMS_DEBUG_VC2COLl('music', 'movie', 'sport')),
           INTEREST I
     WHERE I.INTEREST_CATEGORY = COLUMN_VALUE) B 
```

WHERE I.INTEREST_CATEGORY = COLUMN_VALUE 
```

此查询有 2 个部分

```
 (SELECT LENGTH(WM_CONCAT(COLUMN_VALUE)) AS RES
          FROM TABLE(SYS.DBMS_DEBUG_VC2COLl('music', 'movie', 'sport'))) 
```

这将计算作为输入提供的值的长度

第二次查询

```
 (SELECT LENGTH(WM_CONCAT(DISTINCT I.INTERESET_CATEGORY)) AS RES
          FROM TABLE(SYS.DBMS_DEBUG_VC2COLl('music', 'movie', 'sport')),
               INTEREST I
         WHERE I.INTEREST_CATEGORY = COLUMN_VALUE) 
```

计算与数据库条目匹配的类别的长度。

然后最后比较这 2 个长度并返回 ID。

这是完成这项工作的一条很长的路，但如果您不想使用 group by（这是更小的编码），这可能是您查询的一种方法。

希望能帮助到你

# visual-studio-2010 - Visual Studio 和 Tfs：更新源代码管理状态

> ID：10813090
> 
> 赞同：3
> 
> 时间：2012-05-30T09:00:54.273
> 
> 标签：visual-studio-2010, tfs

当我在 Visual Studio 2010 上启动一个项目时，我必须等待 10 分钟，而屏幕底部的“更新源代码管理状态”完成。在这种情况发生之前，Visual Studio 会完全冻结。

我通过 VPN 连接，并且我为我的 tfs 主机启用了域查找。（http://www.codeproject.com/Questions/111260/VS-NET-2008-hangs-everytime-we-load-our-project-fr.aspx?tab=mostrecent）

我不知道还能做什么。有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-04-08T20:10:51.507

如果您使用 yourtfsserver.visualstudio.com 并且该站点已关闭（例如，由于 Azure 存储中断，就像现在一样）VS 可能会在您打开新的源代码控制项目时或在您在项目中时随机冻结您它不在源代码控制中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-30T12:21:46.493

最简单的调查方法是在 devenv.exe 中启用跟踪（查看 tf.exe.config 并将适当的部分复制到 devenv.exe.config）并查看正在进行的服务器调用。我建议在 msdn 论坛 (http://social.msdn.microsoft.com/Forums/en-US/tfsversioncontrol) 上发布结果，因为 TFS 开发人员比 stackoverflow 更密切地监视它。祝你好运！

# android - 关于 LinearLayout 以及控件如何调整大小

> ID：10813091
> 
> 赞同：0
> 
> 时间：2012-05-30T09:00:56.347
> 
> 标签：android, android-layout, android-widget

今天我一直在玩 LinearLayout 并且对结果感到惊讶：

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
     android:orientation="vertical" >

<TextView
    android:id="@+id/textView1"
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:text="Big Text"
    android:gravity="center_vertical|center_horizontal"
    android:textAppearance="?android:attr/textAppearanceLarge" />

<TextView
   android:id="@+id/textView2"
   android:layout_width="match_parent"
   android:layout_height="match_parent"
   android:text="Medium Text"
   android:textAppearance="?android:attr/textAppearanceMedium" />   

<Button
    android:id="@+id/button1"
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:layout_gravity="bottom"
    android:text="Button"
   />

</LinearLayout> 
```

这是一个简单的布局，带有一个文本视图标题，然后是一个文本视图，我希望它覆盖所有父级（但底部按钮占用的空间）和一个放置在底部的按钮，其 layout_gravity="bottom" .

这会产生一个布局，其中标题正确显示，中心文本视图覆盖所有剩余的可用空间并且按钮不出现。为什么是这样？中心文本视图不应该只考虑底部按钮的大小来计算它的大小吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-30T09:11:11.667

在你的中心使用 layout_weight="1" `TextView`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-30T09:25:34.197

> 中心文本视图不应该只考虑底部按钮的大小来计算它的大小吗？

不，因为您告诉第二个`TextView`匹配其父级的高度，`FILL_PARENT`因此它将填满所有剩余空间，最后一个`TextView`.

> (...) 和一个放置在底部的按钮，layout_gravity="bottom"。

不幸的是，这不是 a 的`LinearLayout`工作方式。如果将方向设置为垂直，则基本上只有`left`和`right`重力会起作用。反之亦然，使用（默认）水平方向，只有`top`和`bottom`工作。方向确定`View`子项按顺序动态定位的方向，这意味着您无法手动更改该方向的“位置”。

现在，为了获得所需的效果，您可以为第二个`TextView`指定高度`0dp`和 的权重`1`，使其动态填充所有剩余空间*，而不*会将第三个推`TextView`离底部。或者，您可以使用 a ，您*可以*`RelativeLayout`使用它直接设置位置，并简单地指示中间坐在第一个下方，但在最后一个上方。*`TextView`*

 ** * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-30T09:20:34.353

永远记住拇指法则

如果您在找到控件后立即使用具有垂直方向的线性布局

`android:layout_height="match_parent"`

布局将忽略其下方的所有控件。

希望这有帮助

维普尔

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-30T09:24:03.070

代替这个

```
 android:layout_width="match_parent"
 android:layout_height="match_parent" 
```

像这样使用“wrap_content”

```
 android:layout_width="wrap_content"/"fill_parent"
  android:layout_height="wrap_content"/"fill_parent" 
```*

# javascript - 如何将横向按钮放置到 iframe（适用于所有浏览器）？

> ID：10813094
> 
> 赞同：0
> 
> 时间：2012-05-30T09:01:04.977
> 
> 标签：javascript, html

我需要动态创建 iframe 并将一些按钮（在列中）放在它们的右侧，按钮位置跟随 iframe 的位置。

我尝试了所有的设置

```
button.style.position = " " 
```

插入“绝对”、“相对”等并尝试指定像素位置，但它不起作用。

但是，我注意到用不同的浏览器打开同一个页面时，按钮被放置在不同的位置。

我需要一种方法，允许我将按钮放置在 iframe 的右侧，跟随其位置，最重要的是，它与所有最常用的浏览器返回相同的结果。

我可以使用什么技术？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-30T09:41:30.153

基本前提有什么问题

```
 <div id="left">
    <iframe src="http://www.google.com"></iframe>
</div>
<div id="right">
    <button>first button</button>
    <button>second button</button>
</div> 

#left, #right {
    float:left;
    width:46%;
    height:300px;
    margin:2%;
}
iframe {
    width:100%;
}
button {
    width:100%;
    clear:right;
} 
```

[工作示例](http://jsfiddle.net/PsHGp/)

# sql - 将多个字段连接到一个字段

> ID：10813098
> 
> 赞同：1
> 
> 时间：2012-05-30T09:01:31.743
> 
> 标签：sql

数据库名：表名

```
table : abc
Remark1 Remark2 Remark3 Remark4 Remark5
1       2       3       4       5

table : xyz
Kod_type description    
1      xxxx 
2      yyyy 
3      zzzz 
4      aaaa 
5      bbbb 
```

如何使用 kod_type 加入 Remark1、Remark2、Remark3、Remark4、Remark5？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-30T09:05:47.993

连接两个表时使用`AND`Condition with`On`子句。

如果要匹配所有备注栏应匹配到 Kod_Type

```
SELECT abc.*, 
       xyz.* 
FROM   abc 
       INNER JOIN xyz 
               ON abc.Remark1 = xyz.Kod_Type 
                  AND abc.Remark2 =  abc.Remark1 
                  AND abc.Remark3 =  abc.Remark1
                  AND abc.Remark4 =  abc.Remark1 
                  AND abc.Remark5 =  abc.Remark1 
```

如果您想要任何备注栏匹配到 Kod_Type 的记录

```
SELECT abc.*, 
           xyz.* 
    FROM   abc 
           INNER JOIN xyz 
                   ON abc.Remark1 = xyz.Kod_Type 
                      OR abc.Remark2 = xyz.Kod_Type 
                      OR abc.Remark3 = xyz.Kod_Type 
                      OR abc.Remark4 = xyz.Kod_Type 
                      OR abc.Remark5 = xyz.Kod_Type 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-30T09:06:48.247

你用你通常做的同样的方式做——

```
SELECT ABC.*, XYZ.* FROM XYZ, ABC
WHERE 
XYZ.KOD_TYPE=ABC.REMARK1
AND XYZ.KOD_TYPE=ABC.REMARK2
AND XYZ.KOD_TYPE=ABC.REMARK3
AND XYZ.KOD_TYPE=ABC.REMARK4
AND XYZ.KOD_TYPE=ABC.REMARK5 
```

如果您需要查询任何一个备注匹配的地方 -

```
SELECT ABC.*, XYZ.* FROM XYZ, ABC
WHERE 
XYZ.KOD_TYPE=ABC.REMARK1
OR XYZ.KOD_TYPE=ABC.REMARK2
OR XYZ.KOD_TYPE=ABC.REMARK3
OR XYZ.KOD_TYPE=ABC.REMARK4
OR XYZ.KOD_TYPE=ABC.REMARK5 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-30T10:33:56.403

这个问题不是很清楚，但我认为这样的事情是有意的。

```
SELECT COALESC(d1.description, '') as description1
        , COALESC(d2.description, '') as description2
        , COALESC(d3.description, '') as description3
        , COALESC(d4.description, '') as description4
        , COALESC(d5.description, '') as description5
FROM abc
LEFT JOIN xyz d1 ON d1.kod_type=abc.remark1
LEFT JOIN xyz d2 ON d2.kod_type=abc.remark2
LEFT JOIN xyz d3 ON d3.kod_type=abc.remark3
LEFT JOIN xyz d4 ON d4.kod_type=abc.remark4
LEFT JOIN xyz d5 ON d5.kod_type=abc.remark5
        ; 
```

# sql - Pl/PgSQL，插入两张表，一张带有标题行

> ID：10813099
> 
> 赞同：3
> 
> 时间：2012-05-30T09:01:35.250
> 
> 标签：sql, postgresql, plpgsql

进行以下插入的最佳方法是什么。我环顾四周，我有点卡住了。

我目前拥有的表格（插入）

```
| id | order_id | item_id | type | group |
| 1  | 1        | 1       | 2    | 1     |  <- type 2 represents a "header" item, or a "kit"
| 2  | 1        | 2       | 1    | 1     |  <- type 1 represents a member of the "kit"
| 3  | 1        | 3       | 1    | 1     |
| 4  | 1        | 4       | 2    | 2     |  <- New group means new kit
| 5  | 1        | 2       | 1    | 2     |
| 6  | 1        | 5       | 1    | 2     | 
```

我需要将这些项目插入以下两个表中：
1）item_entry

```
| id | mode | tmplt_id | item_id | parent_item_entry_id |
| 1  | 1    | 1        | NULL    | NULL                 | <- This is a header line, mode 1
| 2  | 2    | NULL     | 2       | 1                    | <- This is a sub line, mode 2
| 3  | 2    | NULL     | 3       | 1                    | <- parent_item_entry_id references the header it belongs to
| 4  | 1    | 4        | NULL    | NULL                 |
| 5  | 2    | NULL     | 2       | 4                    |
| 6  | 2    | NULL     | 5       | 4                    | 
```

2) item_entry_details

```
| id | item_entry_id | order_id | group |
| 1  | 1             | 1        | 1     | 
| 2  | 4             | 1        | 2     | <- only header information is necessary 
```

当然，item_entry.id 是从一个序列（item_entry_id_seq）中删除的。有没有一种优雅的方法可以让它发挥作用？我目前遍历每个组，首先将 nextval() 分配给一个变量，然后循环遍历组中的每个项目，写入表。

```
FOR recGroup IN SELECT DISTINCT group FROM insert LOOP
  intParentItemEntryID := nextval('item_entry_id_seq');
  FOR recLine IN SELECT * FROM insert LOOP
    INSERT INTO item_entry VALUES (CASE intParentItemEntryID/DEFAULT, CASE 1/2, CASE recLine.item_id/NULL, CASE NULL/recLine.item_id, CASE NULL/intParentItemEntryID)
    INSERT INTO item_entry_details VALUES (DEFAULT, intParentItemEntryID, recLine.order_id, recLine.group);
  END LOOP;
END LOOP; 
```

有没有更好的方法，或者上面是这种类型插入的唯一方法？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-30T11:30:58.077

这里不需要“一次一行”的程序代码，只需简单的旧 sql 就足够了。

```
-- create the tables that the OP did not provide
DROP TABLE the_input;
CREATE TABLE the_input
    ( id INTEGER NOT NULL PRIMARY KEY
    , order_id INTEGER NOT NULL
    , item_id INTEGER NOT NULL
    , ztype INTEGER NOT NULL
    , zgroup INTEGER NOT NULL
    );
DROP TABLE target1 ;
CREATE TABLE target1
    ( id INTEGER NOT NULL  
    , zmode INTEGER NOT NULL 
    , tmplt_id INTEGER     
    , item_id INTEGER      
    , parent_item_entry_id INTEGER  
    );
DROP TABLE target2 ;
CREATE TABLE target2
    ( id SERIAL NOT NULL   
    , item_entry_id INTEGER NOT NULL
    , order_id INTEGER NOT NULL   
    , zgroup INTEGER NOT NULL
    );

 -- fil it up ...
INSERT INTO the_input      
 ( id, order_id, item_id, ztype, zgroup ) VALUES
 ( 1  , 1        , 1       , 2    , 1     ) --  <- type 2 represents a "header" item, or a "kit"
,( 2  , 1        , 2       , 1    , 1     ) --  <- type 1 represents a member of the "kit"
,( 3  , 1        , 3       , 1    , 1     ) --
,( 4  , 1        , 4       , 2    , 2     ) --  <- New group means new kit
,( 5  , 1        , 2       , 1    , 2     ) --
,( 6  , 1        , 5       , 1    , 2     ) --
    ;

-- Do the inserts.
INSERT INTO target1(id,zmode,tmplt_id,item_id,parent_item_entry_id)
SELECT i1.id, 1, i1.id, NULL, NULL
FROM the_input i1
WHERE i1.ztype=2
UNION ALL
SELECT i2.id, 2, NULL, i2.id, ip.item_id
FROM the_input i2
JOIN the_input ip ON ip.zgroup = i2.zgroup AND ip.ztype=2
WHERE i2.ztype=1
    ; 
INSERT INTO target2(item_entry_id,order_id,zgroup)
SELECT DISTINCT MIN(item_id),order_id,  zgroup
FROM the_input i1
WHERE i1.ztype=2
GROUP BY order_id,zgroup
    ;
SELECT * FROM target1
ORDER BY id;

SELECT * FROM target2
ORDER BY id; 
```

结果：

```
NOTICE:  CREATE TABLE / PRIMARY KEY will create implicit index "the_input_pkey" for table "the_input"
CREATE TABLE
INSERT 0 6
DROP TABLE
CREATE TABLE
INSERT 0 6
 id | zmode | tmplt_id | item_id | parent_item_entry_id 
----+-------+----------+---------+----------------------
  1 |     1 |        1 |         |                     
  2 |     2 |          |       2 |                    1
  3 |     2 |          |       3 |                    1
  4 |     1 |        4 |         |                     
  5 |     2 |          |       5 |                    4
  6 |     2 |          |       6 |                    4
(6 rows)

DROP TABLE
NOTICE:  CREATE TABLE will create implicit sequence "target2_id_seq" for serial column "target2.id"
CREATE TABLE
INSERT 0 2
 id | item_entry_id | order_id | zgroup 
----+---------------+----------+--------
  1 |             4 |        1 |      2
  2 |             1 |        1 |      1
(2 rows) 
```

# php - php+MYSQL+一次获取n行

> ID：10813108
> 
> 赞同：1
> 
> 时间：2012-05-30T09:01:56.710
> 
> 标签：php, mysql, foreach, count

我有一个看起来像这样的数据库：（日期格式为`strtotime`）

```
ID  Date            
1   1338366170000
2   1337761370000
3   1337761370000
4   1337761370000
5   1337156570000
6   1331713370000
7   1331713370000 
```

如您所见，有些条目来自同一日期。我现在想获取每个日期并计算它发生的频率。

所以最终结果看起来像：

```
Date: 1338366170000
Count: 1

Date: 1337761370000
Count: 3

Date: 1337156570000
Count: 1 

Date: 1331713370000
Count: 2 
```

我目前正在这样做以获取所有日期并计算每个日期：

首先我抓住所有行：

```
$stats      = $sql->query("SELECT * FROM stats_clicks"); 
```

现在，我认为当我尝试计算具有相同日期的条目时问题就开始了：我遍历所有结果并搜索每个日期并计算它。

```
foreach($sql->get() as $result){

    //Sum clicks for each date
    $date   = $result["date"];

    $stats  = $sql->query("SELECT * FROM stats_clicks WHERE date = '$date'");
    $count  = count($sql->get());

    echo "Date: $date<br>Count: $count<br><br>";

} 
```

输出是：

```
Date: 1338366170000
Count: 1

Date: 1337761370000
Count: 3

Date: 1337761370000
Count: 3

Date: 1337761370000
Count: 3

Date: 1337156570000
Count: 1 

Date: 1331713370000
Count: 2 

Date: 1331713370000
Count: 2 
```

如何避免多次输出每个日期，而是每个日期只输出一次正确的计数？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-30T09:08:25.377

```
SELECT `Date`, COUNT(`Date`) as `Count`
FROM stats_clicks
GROUP BY `Date` 
```

结果

```
Date    Count
1331713370000   2
1337156570000   1
1337761370000   3
1338366170000   1 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-30T09:24:19.473

使用此查询。您将获得无重复的正确计数。SELECT date,count(*) FROM stats_clicks GROUP BY date;

# java - 如何创建java桌面应用程序数据库？

> ID：10813118
> 
> 赞同：0
> 
> 时间：2012-05-30T09:02:50.907
> 
> 标签：java, database

我正在开发一个简单的家谱应用程序（使用 Jung）。要求之一是能够保存我生成的图形或数据。

我已经在 Google 上查找过，但其中大多数都提供网站/在线数据库。我希望能够将数据库保存在桌面上，并从同一个数据库文件中加载。

为此，我需要查找什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-30T09:06:38.277

查看[SQLite](http://www.sqlite.org/)、[HSQL DB](http://hsqldb.org/)或[Apache Derby](http://db.apache.org/derby/)。所有这些都应该适合您的推荐，所以选择取决于您。

或者，您始终可以将数据存储到 XML 或属性文件等文件中。这取决于您的应用程序有多大以及您要保存什么样的数据。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-30T09:05:25.377

查看嵌入式数据库。JDK 中包含的JavaDB [http://www.oracle.com/technetwork/java/javadb/overview/index.html](http://www.oracle.com/technetwork/java/javadb/overview/index.html)对您来说是一个不错的选择。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-30T09:05:20.780

1.  SQLite
2.  XML
3.  您自己的存储序列化对象的格式

# java - Java - 从 PNG 图像创建形状 (NullPointerException)

> ID：10813121
> 
> 赞同：0
> 
> 时间：2012-05-30T09:03:05.563
> 
> 标签：java, nullpointerexception, draw, shape, area

对于我的项目，我想创建自定义形状的按钮。我有创建圆形按钮的代码，经过大量研究，我设法找到了一些代码，可用于从具有透明度的 PNG 图像生成形状（区域），以便我可以使用代码并将其放入进入我的自定义按钮程序。然而，创建形状的过程是消耗CPU的，并且创建每个形状需要相当长的时间。这是我从图像生成形状的代码：

```
import java.awt.Rectangle;
import java.awt.geom.Area;
import java.awt.image.BufferedImage;

public class CreateShapeClass {
    public static Area createArea(BufferedImage image, int maxTransparency) {
        Area area = new Area();
        Rectangle rectangle = new Rectangle();
        for (int x = 0; x < image.getWidth(); x++) {
            for (int y = 0; y < image.getHeight(); y++) {
                int rgb = image.getRGB(x, y);
                rgb = rgb >>> 24;
                if (rgb >= maxTransparency) {
                    rectangle.setBounds(x, y, 1, 1);
                    area.add(new Area(rectangle));
                }
            }
        }
        return area;
    }
} 
```

通过使用上面的代码，将会出现 NullPointerException 错误。这是堆栈跟踪：

```
java.lang.NullPointerException
at CreateShapeClass.createArea(CreateShapeClass.java:10)
at CustomButton.initShape(CustomButton.java:95)
at CustomButton.paintBorder(CustomButton.java:102)
at javax.swing.JComponent.printBorder(Unknown Source)
at javax.swing.JComponent.paint(Unknown Source)
at javax.swing.JComponent.print(Unknown Source)
at javax.swing.JComponent.paintChildren(Unknown Source)
at javax.swing.JComponent.printChildren(Unknown Source)
at javax.swing.JComponent.paint(Unknown Source)
at javax.swing.JComponent.print(Unknown Source)
at javax.swing.JComponent.paintChildren(Unknown Source)
at javax.swing.JComponent.printChildren(Unknown Source)
at javax.swing.JComponent.paint(Unknown Source)
at javax.swing.JLayeredPane.paint(Unknown Source)
at javax.swing.JComponent.print(Unknown Source)
at javax.swing.JComponent.paintChildren(Unknown Source)
at javax.swing.JComponent.printChildren(Unknown Source)
at javax.swing.JComponent.paint(Unknown Source)
at javax.swing.JComponent.print(Unknown Source)
at java.awt.GraphicsCallback$PrintCallback.run(Unknown Source)
at sun.awt.SunGraphicsCallback.runOneComponent(Unknown Source)
at sun.awt.SunGraphicsCallback.runComponents(Unknown Source) 
```

这是我的自定义按钮类：

```
import java.awt.*;
import java.awt.geom.*;
import java.awt.image.BufferedImage;
import java.io.*;
import java.util.Iterator;

import javax.imageio.ImageIO;
import javax.imageio.ImageReadParam;
import javax.imageio.ImageReader;
import javax.imageio.stream.ImageInputStream;
import javax.swing.*;

public class CustomButton extends JButton {
    protected Shape shape, base;
    protected BufferedImage image;
    protected String imagePath;

    private static final long serialVersionUID = 1L;
    public CustomButton() {
        this(null, null);
    }
    //takes in an icon
    public CustomButton(Icon icon) {
        this(null, icon);
    }
    //takes in a text string for button
    public CustomButton(String text) {
        this(text, null);
    }

    //takes in a text string for button
    public CustomButton(Icon icon, String imagePath, boolean useless) {
        this(null, icon);
        this.imagePath = imagePath;
    }
    //takes in an action for the button press event
    public CustomButton(Action a) {
        this();
        setAction(a);
    }
    //takes in text and icon image
    public CustomButton(String text, Icon icon) {
        setModel(new DefaultButtonModel());
        init(text, icon);
        if(icon==null) {
            return;
        }
        setBorder(BorderFactory.createEmptyBorder(0,0,0,0));
        setBackground(Color.BLACK);
        setContentAreaFilled(false);
        setFocusPainted(false);
        //setVerticalAlignment(SwingConstants.TOP);
        setAlignmentY(Component.TOP_ALIGNMENT);
        initShape();
    }

    //creates a method for retrieving preferred size of the button (the image)
    @Override public Dimension getPreferredSize() {
        Icon icon = getIcon();
        Insets i = getInsets();
        if (icon == null){
            return super.getPreferredSize();
        }
        else {
            return new Dimension(icon.getIconWidth(), icon.getIconHeight());
        }
    }

    //creates the shape of the button from the image
    protected void initShape() {
        if(!getBounds().equals(base)) {
            Dimension s = getPreferredSize();
            base = getBounds();
            if (image == null){
                try {
                    image = ImageIO.read(new File("Untitled1.png"));
                } catch (IOException e) {
                    e.printStackTrace();
                }
            }
            shape = CreateShapeClass.createArea(image, 25);
            System.out.println(shape.getBounds());
        }
    }

    //creates the border of the button
    @Override protected void paintBorder(Graphics g) {
        initShape();
        Graphics2D g2 = (Graphics2D)g;
        g2.setRenderingHint(RenderingHints.KEY_ANTIALIASING, RenderingHints.VALUE_ANTIALIAS_ON);
        g2.setColor(getBackground());
        g2.setStroke(new BasicStroke(1.0f));
        g2.draw(shape);
        g2.setRenderingHint(RenderingHints.KEY_ANTIALIASING, RenderingHints.VALUE_ANTIALIAS_OFF);
    }
    @Override public boolean contains(int x, int y) {
        initShape();
        return shape.contains(x, y);
    }
} 
```

那么，任何人都可以指导我代码哪里出错了？有没有什么办法可以将生成的形状保存到某种文件中，以便在程序运行时不必总是重新生成形状？或者有什么方法可以预先缓存形状。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-30T09:06:18.413

您没有检查`image`参数是否为`null`. `initShape`如果无法读取“Untitled1.png”，则查看您的调用方法可以获得一个空指针。

# ruby-on-rails - 如何在 Rails 设计插件中针对未经授权的页面请求显示错误消息？

> ID：10813136
> 
> 赞同：0
> 
> 时间：2012-05-30T09:04:22.507
> 
> 标签：ruby-on-rails, authentication, devise

我在一个 Ruby on Rails 项目中工作，该项目使用 Devise 插件实现了身份验证机制。我是这个插件和 Ruby 的新手。因此难以解决身份验证问题。问题是，根据当前的实现，如果用户试图在没有登录的情况下访问应用程序中的页面，它会通过说他或她应该在访问该页面之前登录或注册来将用户重定向到登录页面. 这是正确的。这就是我需要的实现。但是发生的情况是，即使用户直接进入登录页面，也会显示此错误消息。这不是必需的。因为如果用户直接访问登录页面，没有意义给出错误信息。任何帮助将不胜感激。谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-30T09:50:47.807

您在不应该使用的地方调用设计`authenticate_user!`并且不使用`require_no_authentication`

您必须确保在您的会话控制器中调用过滤器之前

```
prepend_before_filter :require_no_authentication, :only => [ :new, :create ] 
```

这些都是在设计的默认控制器中处理的（例如，Devise::SessionsController），你在使用它们吗？

# c# - 如何更改打开的 ToolStripDropDownButton 的背景色？

> ID：10813138
> 
> 赞同：3
> 
> 时间：2012-05-30T09:04:32.017
> 
> 标签：c#, winforms, toolstripdropdown

`ToolStripDropDownButton`打开下拉菜单时，我需要更改 a 的背景颜色。我该怎么做？

我试图从 继承一个类`ToolStripProfessionalRenderer`，然后覆盖`OnRenderDropDownButtonBackground`，但它只影响下拉关闭时。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-30T09:15:02.283

我相信您可以使用以下方法：

**第一种方法：**

```
toolStripDropDownButton1.Paint += toolStripDropDownButton1_Paint;
//...
void toolStripDropDownButton1_Paint(object sender, PaintEventArgs e) {
    if(toolStripDropDownButton1.Pressed) {
        // TODO Paint your pressed button
        e.Graphics.FillRectangle(Brushes.Green, e.ClipRectangle);
    }
} 
```

**第二种方法：**

```
toolStrip.Renderer = new PressedRenderer();
//...    

class PressedRenderer : ToolStripProfessionalRenderer {
    protected override void OnRenderDropDownButtonBackground(ToolStripItemRenderEventArgs e) {
        if(e.Item.Pressed)
            e.Graphics.Clear(Color.Green);
        else base.OnRenderDropDownButtonBackground(e);
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-30T09:15:41.440

活动是[`OnDropDownOpened`](http://msdn.microsoft.com/en-us/library/system.windows.forms.toolstripdropdownitem.ondropdownopened.aspx)你想要的吗？

```
private void toolStripDropDownButton_DropDownOpened(object sender, EventArgs e)
{
   toolStripDropDownButton.BackColor = Color.Red;
} 
```

# mongodb - 存储在 mongoDB 中的 Django nonrel 相关字段不再按 ObjectID 存储？

> ID：10813139
> 
> 赞同：1
> 
> 时间：2012-05-30T09:04:33.300
> 
> 标签：mongodb, pymongo, django-nonrel

我有一个使用 MongoDB 的现有 Django nonrel 应用程序。似乎对象的相关字段是由 ObjectID 存储的。例如，我有一个 UserProfile 模型，它与 OneToOneField 的用户对象相关。存储的对象数据如下：

```
{
    "_id": {
        "$oid": "4f67540040e0460001000001"
    },
    "user_id": {
        "$oid": "4f67540040e0460001000000"
    },
    ....
} 
```

我在 Heroku 上部署了应用程序，它使用 git 存储库来获取 django nonrel 项目和 django-mongodb-engine。我使用的pymongo版本是2.1.1。我不确定由于哪个库的更新，我发现相关字段似乎不再由 ObjectId 存储。新对象数据的存储方式如下：

```
{
    "_id": {
        "$oid": "4f67540040e0460001000001"
    },
    "user_id": "4f67540040e0460001000000",
    ....
} 
```

问题是由于数据格式不一致而导致错误。不仅我无法获取先前存储的对象的相关对象（获取“DoesNotExist：UserProfile 匹配查询不存在。”）。Piston 也无法获取新保存对象的相关对象。

我尝试将修订说明符添加到 requirements.txt 中的 git 存储库 URL，但没有运气，这很奇怪。

有谁知道发生了什么？也许我必须做一个 mongoDB 数据更新来修复那些相关的数据 id 值？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-30T09:35:07.483

你之前用的是什么版本？- 还需要了解 django-nonrel / djangotoolbox 版本。

似乎您可能必须手动迁移数据 - 但最好确定更改发生的版本以确保其不是暂时的更改。

# android - onSaveInstanceState 不起作用

> ID：10813142
> 
> 赞同：1
> 
> 时间：2012-05-30T09:04:48.370
> 
> 标签：android, list, task, save

我知道这个问题已经被问了很多，但我不明白为什么 onSaveInstanceState 对我不起作用。这可能是一些愚蠢的事情，但我希望你们中的一些人能在这里帮助我。无论如何，这是我的代码：

```
public class Main extends Activity implements OnClickListener, OnKeyListener {

EditText textitem;
Button buttonadd;
ListView listitems;

ArrayList<String> ToDo;
ArrayAdapter<String> AA;
ArrayList<String> MyArrayList;

/** Called when the activity is first created. */
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);

    textitem = (EditText) findViewById(R.id.textitem);
    buttonadd = (Button) findViewById(R.id.buttonadd);
    listitems = (ListView) findViewById(R.id.listitems);

    buttonadd.setOnClickListener(this);
    textitem.setOnKeyListener(this);

    ToDo = new ArrayList<String>();
    AA = new ArrayAdapter<String>(this,
            android.R.layout.simple_list_item_1, ToDo);
    listitems.setAdapter(AA);

}

@Override
public void onSaveInstanceState(Bundle savedInstanceState) {
    savedInstanceState.putStringArrayList("MyArrayList", ToDo);
    super.onSaveInstanceState(savedInstanceState);
}

@Override
public void onRestoreInstanceState(Bundle savedInstanceState) {
    super.onRestoreInstanceState(savedInstanceState);
    ArrayList<String> ToDo = savedInstanceState.getStringArrayList("MyArrayList");
}

private void addItem(String item) {
    if (item.length() > 0) {
        this.ToDo.add(item);
        this.AA.notifyDataSetChanged();
        this.textitem.setText("");
    }
}

public void onClick(View v) {
    if (v == this.buttonadd) {
        this.addItem(this.textitem.getText().toString());
    }
}

public boolean onKey(View v, int keyCode, KeyEvent event) {
    if (event.getAction() == KeyEvent.ACTION_DOWN
            && keyCode == KeyEvent.KEYCODE_DPAD_CENTER) {
        this.addItem(this.textitem.getText().toString());
    }
    return false;
} 
```

}

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-30T09:07:18.603

您将其保存在局部变量中，为什么？可以试试这个

```
@Override
public void onRestoreInstanceState(Bundle savedInstanceState) {
    super.onRestoreInstanceState(savedInstanceState);
    this.ToDo = savedInstanceState.getStringArrayList("MyArrayList");
} 
```

通常你在 onCreate 中恢复你的状态。也可以在 onRestoreInstanceState 中恢复它，但不是很常见。（onRestoreInstanceState 在 onStart 之后调用，而 onCreate 在 onStart 之前调用。

来自：[onSaveInstanceState() 和 onRestoreInstanceState()](https://stackoverflow.com/questions/4096169/onsaveinstancestate-and-onrestoreinstancestate)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-30T09:10:35.507

您在“onRestoreInstanceState()”回调中提取保存的值，但实际上您并没有对它们做任何事情。

```
ArrayList<String> ToDo = savedInstanceState.getStringArrayList("MyArrayList"); 
```

您需要将这些值包装在适配器中并将其分配给列表，就像您在 onCreate() 末尾执行的操作一样。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-30T09:15:54.903

```
public class Main extends Activity implements OnClickListener, OnKeyListener {

EditText textitem;
Button buttonadd;
ListView listitems;

ArrayList<String> ToDo;
ArrayAdapter<String> AA;
ArrayList<String> MyArrayList;

/** Called when the activity is first created. */
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);

    textitem = (EditText) findViewById(R.id.textitem);
    buttonadd = (Button) findViewById(R.id.buttonadd);
    listitems = (ListView) findViewById(R.id.listitems);

    buttonadd.setOnClickListener(this);
    textitem.setOnKeyListener(this);

    if(savedInstanceState!=null)
     {
       ToDo = savedInstanceState.getStringArrayList("MyArrayList");
     }
    else
     {
       ToDo = new ArrayList<String>();
     }
    AA = new ArrayAdapter<String>(this,
            android.R.layout.simple_list_item_1, ToDo);
    listitems.setAdapter(AA);

}

@Override
public void onSaveInstanceState(Bundle savedInstanceState) {
    savedInstanceState.putStringArrayList("MyArrayList", ToDo);
    super.onSaveInstanceState(savedInstanceState);
}

private void addItem(String item) {
    if (item.length() > 0) {
        this.ToDo.add(item);
        this.AA.notifyDataSetChanged();
        this.textitem.setText("");
    }
}

public void onClick(View v) {
    if (v == this.buttonadd) {
        this.addItem(this.textitem.getText().toString());
    }
}

public boolean onKey(View v, int keyCode, KeyEvent event) {
    if (event.getAction() == KeyEvent.ACTION_DOWN
            && keyCode == KeyEvent.KEYCODE_DPAD_CENTER) {
        this.addItem(this.textitem.getText().toString());
    }
    return false;
} 
```

希望这会帮助你。维普尔

# java - 通过 oAuth 2.0 访问 Java Google Plus

> ID：10813144
> 
> 赞同：0
> 
> 时间：2012-05-30T09:04:52.183
> 
> 标签：java, oauth-2.0, google-plus

我尝试了许多不同的方法来访问谷歌帐户以读取个人资料数据，但每次都失败。

```
 Exception in thread "main" com.google.api.client.googleapis.json.GoogleJsonResponseException: 401 Unauthorized
{
  "code" : 401,
  "errors" : [ {
    "domain" : "global",
    "location" : "Authorization",
    "locationType" : "header",
    "message" : "Invalid Credentials",
    "reason" : "authError"
  } ],
  "message" : "Invalid Credentials"
} 
```

我尝试通过以下代码访问

```
@SuppressWarnings("deprecation")
public static GoogleAccessProtectedResource connect(String CLIENT_ID,String CLIENT_SECRET,String SCOPE,String CALLBACK_URL,HttpTransport TRANSPORT,JsonFactory JSON_FACTORY) throws IOException{
    // Generate the URL to which we will direct users
        String authorizeUrl = new GoogleAuthorizationRequestUrl(CLIENT_ID,
            CALLBACK_URL, SCOPE).build();
        System.out.println("Paste this url in your browser: " + authorizeUrl);

        // Wait for the authorization code
        System.out.println("Type the code you received here: ");
        BufferedReader in = new BufferedReader(new InputStreamReader(System.in));
        String authorizationCode = in.readLine();

        // Exchange for an access and refresh token
        GoogleAuthorizationCodeGrant authRequest = new GoogleAuthorizationCodeGrant(TRANSPORT,
            JSON_FACTORY, CLIENT_ID, CLIENT_SECRET, authorizationCode, CALLBACK_URL);
        authRequest.useBasicAuthorization = false;
        AccessTokenResponse authResponse = authRequest.execute();
        String accessToken = authResponse.accessToken;
        GoogleAccessProtectedResource access = new GoogleAccessProtectedResource(accessToken,
            TRANSPORT, JSON_FACTORY, CLIENT_ID, CLIENT_SECRET, authResponse.refreshToken);
        HttpRequestFactory rf = TRANSPORT.createRequestFactory(access);
        System.out.println("Access token: " + authResponse.accessToken);

        // Make an authenticated request
        GenericUrl shortenEndpoint = new GenericUrl("https://www.googleapis.com/urlshortener/v1/url");
        String requestBody =
            "{\"longUrl\":\"http://farm6.static.flickr.com/5281/5686001474_e06f1587ff_o.jpg\"}";
        HttpRequest request = rf.buildPostRequest(shortenEndpoint,
            ByteArrayContent.fromString("application/json", requestBody));
        HttpResponse shortUrl = request.execute();
        BufferedReader output = new BufferedReader(new InputStreamReader(shortUrl.getContent()));
        System.out.println("Shorten Response: ");
        for (String line = output.readLine(); line != null; line = output.readLine()) {
          System.out.println(line);
        }

        // Refresh a token (SHOULD ONLY BE DONE WHEN ACCESS TOKEN EXPIRES)
        //access.refreshToken();
        //System.out.println("Original Token: " + accessToken + " New Token: " + access.getAccessToken());

        return access;

  } 
```

然后我想访问我的帐户

```
public static void getData1(String accessToken, String clientId, String clientSecret, String refreshToken) throws IOException{
    // Set up the HTTP transport and JSON factory
      HttpTransport httpTransport = new NetHttpTransport();
      JsonFactory jsonFactory = new JacksonFactory();

      // Set up OAuth 2.0 access of protected resources
      // using the refresh and access tokens, automatically
      // refreshing the access token when it expires
      GoogleAccessProtectedResource requestInitializer =
          new GoogleAccessProtectedResource(accessToken, httpTransport,
          jsonFactory, clientId, clientSecret, refreshToken);

      // Set up the main Google+ class
      Plus plus = Plus.builder(httpTransport, jsonFactory)
          .setHttpRequestInitializer(requestInitializer)
          .build();

      // Make a request to access your profile and display it to console
      Person profile = plus.people().get("[myID]").execute();
      System.out.println("ID: " + profile.getId());
      System.out.println("Name: " + profile.getDisplayName());
      System.out.println("Image URL: " + profile.getImage().getUrl());
      System.out.println("Profile URL: " + profile.getUrl());
  } 
```

以下主要方法应该在之后工作：`CLIENT_ID`并且`CLIENT_SECRET`被创建

```
public static void main(String[] args) throws IOException {
  GoogleAccessProtectedResource access1=Connection.connect(CLIENT_ID, CLIENT_SECRET, SCOPE, CALLBACK_URL, TRANSPORT, JSON_FACTORY);

  //refresh
  String token= access1.getAccessToken();
  access1.refreshToken();
  String refreshed=access1.getAccessToken(); 
//get data
    Connection.getData1(token, CLIENT_ID, CLIENT_SECRET, refreshed); 
} 
```

这是我的数据...

```
private static final String SCOPE = "https://www.googleapis.com/auth/urlshortener";
private static final String CALLBACK_URL = "urn:ietf:wg:oauth:2.0:oob";
private static final HttpTransport TRANSPORT = new NetHttpTransport();
private static final JsonFactory JSON_FACTORY = new JacksonFactory();

// FILL THESE IN WITH YOUR VALUES FROM THE API CONSOLE
private static final String CLIENT_ID = "[myID].apps.googleusercontent.com";
private static final String CLIENT_SECRET = "[myID]"; 
```

* * *

现在抛出了一个错误的请求异常

```
Exception in thread "main" com.google.api.client.http.HttpResponseException: 400 Bad  Request
{
 "error" : "invalid_client"
}
at com.google.api.client.http.HttpRequest.execute(HttpRequest.java:900)
at com.google.api.client.auth.oauth2.draft10.AccessTokenRequest.executeUnparsed(AccessTokenRequest.java:472)
at com.google.api.client.auth.oauth2.draft10.AccessTokenRequest.execute(AccessTokenRequest.java:486)
at Connection.connect(Connection.java:78)
at Connection.main(Connection.java:50) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-30T17:32:53.240

希望这很容易解决。

您正在使用 SCOPE 字符串：

`https://www.googleapis.com/auth/urlshortener`

这是 URL Shortener (goo.gl) API 的范围，而不是 Google+ API。相反，您应该尝试使用 Google+ 的配置文件范围

`https://www.googleapis.com/auth/plus.me`

此处的文档： [https ://developers.google.com/+/api/oauth](https://developers.google.com/+/api/oauth)

在上面，您似乎正在使用 [myID] 来引用两种不同类型的 ID：

在下面的语句中，myID 应该是您的 Google+ 个人资料 ID（从您的 Google+ 个人资料的 URL 复制/粘贴，或者使用字符串“我”来表示当前授权的用户）：

`Person profile = plus.people().get("[myID]").execute();`

但是，对于 CLIENT_ID，您应该使用 code.google.com/apis/console 中项目的值。

# ios - UITextView / UITextField 的虚线/虚线边框

> ID：10813146
> 
> 赞同：5
> 
> 时间：2012-05-30T09:05:03.460
> 
> 标签：ios, objective-c, uitextfield, uitextview, border

我想为我的和设置一个**虚线/虚线边框**。`UITextField``UITextView`

我怎样才能做到这一点？我知道，我可以用这行代码设置边框：

```
[self.textFieldCardTitle.layer setBorderWidth:1.0];
[self.textFieldCardTitle.layer setBorderColor:[[UIColor whiteColor] CGColor]]; 
```

* * *

**注意：**我已经有了在`UIImageView`后面添加一个`UITextView`并设置一个带有虚线边框的图像的想法。但我不想那样解决它。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-30T09:08:15.277

例如，您可以尝试下一种方法：

1）创建将代表您的边框的图像（例如：一个点和空格）

2）将图像添加到项目中。

3）设置边框（如您问题中的代码）并使用图案设置颜色：

```
[self.textFieldCardTitle.layer setBorderWidth:6.0];
[self.textFieldCardTitle.layer setBorderColor:[[UIColor colorWithPatternImage:[UIImage imageNamed:@"dashed_white.png"]] CGColor]]; 
```

由于边框是沿 4 个边（左、右、下、上）绘制的，因此您应该使用方形图像：例如，中间的像素是黑色的，而它周围的像素是透明的。因此，该图像的副本将放置在视图周围。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2016-01-04T10:47:50.507

**只需对周围的虚线/虚线边框`UIView`**或`UITextField`任何其他视图使用以下代码：-

```
CAShapeLayer * _border = [CAShapeLayer layer];
_border.strokeColor = [UIColor redColor].CGColor;
_border.fillColor = nil;
_border.lineDashPattern = @[@4, @2];
[YOURVIEW.layer addSublayer:_border];

//for a square effect
_border.path = [UIBezierPath bezierPathWithRect:YOURVIEW.bounds].CGPath;
//for a rounded effect
//_border.path = [UIBezierPath bezierPathWithRoundedRect:YOURVIEW.bounds cornerRadius:txtUserName.frame.size.height / 2].CGPath;

_border.frame = YOURVIEW.bounds; 
```

有关更多详细信息，请参阅此[答案](https://stackoverflow.com/a/15260479/3908884)。

希望，这就是你要找的。任何问题都可以回复我。:)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2014-12-01T16:12:55.680

这是我对 Swift 所做的：

```
self.textFieldCardTitle.layer.borderWidth = 3
self.textFieldCardTitle.layer.borderColor = (UIColor(patternImage: UIImage(named: "dot")!)).CGColor 
```

免费奖金，我附上了下面的图片。除非 StackOverflow 更改其背景，否则您可能不会看到它们，因为它们是白色背景上的白色方块，因此您也可以在下面找到网址。

![点](../Images/1f26cf44bef027c3a661c34d1ce1c183.png) ![点@2x](../Images/2413c2b29ba0e1af72b118d6cd81333f.png) ![点@3x](../Images/beb4d89e7279856524d810b53c738c16.png)

*   [http://i.stack.imgur.com/X7PfM.png](https://i.stack.imgur.com/X7PfM.png) -> 重命名为 dot.png
*   [http://i.stack.imgur.com/IemhF.png](https://i.stack.imgur.com/IemhF.png) -> 重命名为 dot@2x.png
*   [http://i.stack.imgur.com/CSjZT.png](https://i.stack.imgur.com/CSjZT.png) -> 重命名为 dot@3x.png

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-08-28T03:32:27.450

***Swift 5，对于@Meet Doshi 的回答***

```
class CustomTextField: UITextField{

   let dashBorder = CAShapeLayer()

    override init(frame: CGRect) {
        super.init(frame: .zero)

        dashBorder.strokeColor = UIColor.lightGray.cgColor
        dashBorder.fillColor = nil
        dashBorder.lineDashPattern = [4, 2]
        layer.addSublayer(dashBorder)

    }

    override func layoutSubviews() {
        super.layoutSubviews()
        dashBorder.path = UIBezierPath(roundedRect: bounds, cornerRadius: 5).cgPath
        dashBorder.frame = bounds
    }

} 
```

# nlp - 用于命名实体识别的语言无关工具

> ID：10813147
> 
> 赞同：2
> 
> 时间：2012-05-30T09:05:09.007
> 
> 标签：nlp, named-entity-recognition

有人知道是否有任何与语言无关的命名实体识别库吗？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-30T11:23:13.527

我对此表示怀疑。

理论上，如果您有大型注释语料库，您可以使用纯监督学习技术。但是，如果您不能使用依赖于语言的规则、启发式或特征，并且您正在寻找高精度和召回率 - 语料库的大小将必须是庞大的。我敢说，对于任何给定的人类口语，可能没有足够的注释数据来完成这项任务。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-10-29T07:51:07.557

我认为多语言 BERT 模型是一个很好的起点，尽管您仍然需要在特定数据集上对其进行微调。如果您正在寻找的语言根本没有资源，您可以尝试在类似的语言上对其进行微调。要考虑的另一件事是将标签从一种语言转移到另一种语言。一种方法是使用多语言嵌入并搜索从源语言到目标语言的最近邻，并以这种方式进行翻译。

# java - 如何在 Java 中将数字转换为字母？

> ID：10813154
> 
> 赞同：40
> 
> 时间：2012-05-30T09:05:26.057
> 
> 标签：java

有没有比这更好的将数字转换为其字母等价物的方法？

```
private String getCharForNumber(int i) {
    char[] alphabet = "ABCDEFGHIJKLMNOPQRSTUVWXYZ".toCharArray();
    if (i > 25) {
        return null;
    }
    return Character.toString(alphabet[i]);
} 
```

也许比处理大于 26 的数字更优雅的东西？

* * *

## 回答 #1

> 赞同：79
> 
> 时间：2012-05-30T09:11:30.200

只需使用 ASCII 表示。

```
private String getCharForNumber(int i) {
    return i > 0 && i < 27 ? String.valueOf((char)(i + 64)) : null;
} 
```

注意：这假设`i`介于`1`和`26`包含之间。

如果您想从零开始，您必须将条件更改为`i > -1 && i < 26`和增量。`65``i`

这是完整的 ASCII 表，以防您需要参考：

* * *

![在此处输入图像描述](../Images/6e666040323a825f8f9a43a5d8013fb8.png)

* * *

**编辑：**

正如一些人在这里建议的那样，直接使用字符`'A'`而不是其 ASCII 代码更具可读性。

```
private String getCharForNumber(int i) {
    return i > 0 && i < 27 ? String.valueOf((char)(i + 'A' - 1)) : null;
} 
```

* * *

## 回答 #2

> 赞同：36
> 
> 时间：2015-05-15T12:38:04.627

对于 0-25 之外的输入，我有时会发现为所有整数提供一个明确定义的字符串，而不是给出错误或一些标记值（例如“？”）。我喜欢使用以下内容：

```
 0 ->    A
   1 ->    B
   2 ->    C
 ...
  25 ->    Z
  26 ->   AA
  27 ->   AB
  28 ->   AC
 ...
 701 ->   ZZ
 702 ->  AAA
 ... 
```

这也可以扩展到负数：

```
 -1 ->   -A
  -2 ->   -B
  -3 ->   -C
 ...
 -26 ->   -Z
 -27 ->  -AA
 ... 
```

Java 代码：

```
public static String toAlphabetic(int i) {
    if( i<0 ) {
        return "-"+toAlphabetic(-i-1);
    }

    int quot = i/26;
    int rem = i%26;
    char letter = (char)((int)'A' + rem);
    if( quot == 0 ) {
        return ""+letter;
    } else {
        return toAlphabetic(quot-1) + letter;
    }
} 
```

Python 代码，包括使用字母数字（基数 36）或区分大小写（基数 62）字母的能力：

```
def to_alphabetic(i,base=26):
    if base < 0 or 62 < base:
        raise ValueError("Invalid base")

    if i < 0:
        return '-'+to_alphabetic(-i-1)

    quot = int(i)/base
    rem = i%base
    if rem < 26:
        letter = chr( ord("A") + rem)
    elif rem < 36:
        letter = str( rem-26)
    else:
        letter = chr( ord("a") + rem - 36)
    if quot == 0:
        return letter
    else:
        return to_alphabetic(quot-1,base) + letter 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-05-30T09:19:11.297

我会返回一个字符`char`而不是一个字符串。

```
public static char getChar(int i) {
    return i<0 || i>25 ? '?' : (char)('A' + i);
} 
```

注意：当字符解码器无法识别字符时，它会返回`?`

我会使用`'A'`or`'a'`而不是查找 ASCII 代码。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2012-05-30T09:12:57.923

如果您将 a/A 定义为 0

```
char res;
if (i>25 || i<0){
    res = null;
}
    res = (i) + 65
}
return res; 
```

大写字母 65；非大写字母 97

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2012-05-30T09:14:40.130

就个人而言，我更喜欢

```
return "ABCDEFGHIJKLMNOPQRSTUVWXYZ".substring(i, i+1); 
```

这股靠山`char[]`。或者，我认为下一个最易读的方法是

```
return Character.toString((char) (i + 'A')); 
```

这不依赖于记住 ASCII 表。它不做验证，但如果你愿意，我宁愿写

```
char c = (char) (i + 'A');
return Character.isUpperCase(c) ? Character.toString(c) : null; 
```

只是为了清楚地表明您正在检查它是一个字母字符。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2015-10-16T09:14:40.167

```
public static String abcBase36(int i) {
    char[] ALPHABET = "0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ".toCharArray();
    int quot = i / 36;
    int rem = i % 36;

    char letter = ALPHABET[rem];
    if (quot == 0) {
        return "" + letter;
    } else {
        return abcBase36(quot - 1) + letter;
    }
} 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2013-05-08T13:27:10.420

您可以将输入转换为基数 26（十六进制）并将每个“数字”单独转换回基数 10 并应用 ASCII 映射。由于 A 映射到 0，您将得到结果 A、B、C、...、Y、Z、BA、BB、BC、...等，根据您对输入值的要求，可能需要也可能不需要> 26，因为很自然地认为 AA 在 Z 之后。

```
public static String getCharForNumber(int i){

    // return null for bad input
    if(i < 0){
        return null;
    }

    // convert to base 26
    String s = Integer.toString(i, 26);

    char[] characters = s.toCharArray();

    String result = "";
    for(char c : characters){
        // convert the base 26 character back to a base 10 integer
        int x = Integer.parseInt(Character.valueOf(c).toString(), 26);
        // append the ASCII value to the result
        result += String.valueOf((char)(x + 'A'));          
    }

    return result;
} 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2015-09-16T12:28:23.390

```
public static string IntToLetters(int value)
{
string result = string.Empty;
while (--value >= 0)
{
    result = (char)('A' + value % 26 ) + result;
    value /= 26;
}
return result;
} 
```

为了满足 A 为 1 而不是 0 的要求，我在 while 循环条件中添加了 - 并删除了值 - 从循环的末尾，如果有人出于自己的目的希望它为 0，你可以扭转变化，或者简单地增加价值++；在整个方法的开始。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2017-05-24T16:14:02.440

从 int 获取字母值可以简单地通过以下方式完成：

```
(char)('@' + i) 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2012-05-30T09:18:37.917

你可以这样尝试：

```
private String getCharForNumber(int i) {
    CharSequence css = "ABCDEFGHIJKLMNOPQRSTUVWXYZ";
    if (i > 25) {
        return null;
    }
    return css.charAt(i) + "";
} 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2012-05-30T09:20:24.667

另一种变体：

```
private String getCharForNumber(int i) {
    if (i > 25 || i < 0) {
        return null;
    }
    return new Character((char) (i + 65)).toString();
} 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2013-10-28T10:26:56.263

这不完全是答案，而是我制作的一些有用/相关的代码。当您运行它并在命令行中输入任何字符时，它会返回`getNumericValue(char)`... 这似乎与 ASCII 表不同，因此请注意。无论如何，不​​是直接回答您的问题，但希望对您有所帮助：

```
import java.lang.*;
import java.util.*;
/* charVal.java
         */

//infinite loops. whenever you type in a character gives you value of 
//getNumericValue(char)
//
//ctrl+c to exit

public class charVal {
   public static void main(String[] args) {
     Scanner inPut = new Scanner(System.in);
     for(;;){
       char c = inPut.next().charAt(0);
       System.out.printf("\n %s = %d \n", c, Character.getNumericValue(c));
     }
    }
} 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2016-07-05T14:11:56.987

另一种方法从`0`a 开始并返回`String`

```
public static String getCharForNumber(int i) {
    return i < 0 || i > 25 ? "?" : String.valueOf((char) ('A' + i));
} 
```

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2019-10-22T14:02:45.047

```
public static void main(String[] args)
 {
     int rem,n=702,quo;
     String s=" ";
     while(n>0)
     {
         rem=(n-1)%26;
         quo=(n-1)/26;
         s=(char)(rem+97)+s;
         if(quo==1)
         {
            s=(char)(97)+s;
            break;
         }
         else
         n=(n-1)/26;
     }
     System.out.print(s);
 }
}
////We can also write the code like the below one. There is no much difference but it may help to understand the concept for some people.

public static void main(String[] args)
 {
     int rem,n=52,quo;
     String s=" ";
     while(n>0)
     {
         rem=n%26;
         quo=n/26;
         if(rem==0)
             rem=26;
         s=(char)(rem+96)+s;
         if((quo==1 || quo==0) && n>26)
         {
             n=n/26;
            s=(char)(n+96)+s;
            break;
         }
         else
             n=n/26-1; 
     }
     System.out.print(s);
 } 
```

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2020-09-27T10:44:10.387

```
for(int i=0;i<ar.length();i++) {
            char ch = ar.charAt(i);
                    System.out.println((char)(ch+16));;
        } 
```

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2021-12-15T11:02:33.127

接受的答案最好地描述了解决方案。然而，当您想继续对值 27 进行编号时，它无法处理这种情况，例如`aa`, `ab`, ... `az`, `aaa`, `aab`.... 为此，我通过以下方式实现了：

```
protected String getAlphaNumber(int intValue) {
    if (intValue == 0) {
        return "";
    }
    intValue = Math.abs(intValue);
    String prefix = "";
    int charPosition = intValue % 26;
    int blocks = intValue / 26;
    if (charPosition == 0) { //the last letter, "z" (26)
        blocks--;
        charPosition = 26;
    }
    for (int i = 0; i < blocks; i++) {
        prefix += "a";
    }
    return prefix + ((char) (charPosition + 96)); // "a"-"z" chars are located in the 97-122 indexes of the ASCII table, so shift all 96 positions.
} 
```

# c#-4.0 - 使用 servermanager 创建 IIS，commitchanges 错误

> ID：10813156
> 
> 赞同：1
> 
> 时间：2012-05-30T09:05:31.477
> 
> 标签：c#-4.0, iis-7.5, servermanager

当我想使用 servermanager 创建新服务器时遇到麻烦。

这是我的代码

```
 ServerManager sm = new ServerManager();
    Site s = sm.Sites.Add("NEWSERVER", path, 80);

    BindingCollection bindingCollection = s.Bindings;
    bindingCollection.Clear();

    Binding binding = s.Bindings.CreateElement("binding");
    binding["protocol"] = "https";
    binding["certificateHash"] = "‎thumprint value";
    binding["certificateStoreName"] = "MY";
    binding["bindingInformation"] = string.Format("{0}:{1}:{2}", "*", "443", "subdomain.url.com");
    bindingCollection.Add(binding);

    Binding binding2 = s.Bindings.CreateElement("binding");
    binding2["protocol"] = "http";
    binding2["bindingInformation"] = string.Format("{0}:{1}:{2}", "*", "80", "subdomain.url.com");
    bindingCollection.Add(binding2);

    s.ServerAutoStart = true;

    ApplicationPool a = sm.ApplicationPools.Add("NEWSERVER");
    a.ManagedRuntimeVersion = "v4.0";
    s.ApplicationDefaults.ApplicationPoolName = "NEWSERVER";
    sm.CommitChanges(); 
```

当我运行它时，它会创建服务器 + 绑定，但会出现以下错误：

“访问被拒绝。（来自 HRESULT 的异常：0x80070005 (E_ACCESSDENIED)）”

这在 sm.CommitChnages() 运行时发生。

我无法弄清楚我无法访问哪些内容。有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-30T09:43:14.797

您必须使用本地管理员帐户运行这段代码。

对于 ASP.NET 应用程序，您的选择是

1.  使用 WindowsIdentity 模拟本地管理员。
2.  或者在本地管理员帐户下运行应用程序池。

他们都有一些你需要注意安全方面的事情，

[http://msdn.microsoft.com/en-us/library/ff647404.aspx](http://msdn.microsoft.com/en-us/library/ff647404.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-08-25T03:53:30.887

我在尝试动态添加绑定时遇到了同样的问题。我刚刚以管理员身份运行应用程序

它对我有用。

# android - 安卓菜单不出现

> ID：10813157
> 
> 赞同：1
> 
> 时间：2012-05-30T09:05:37.263
> 
> 标签：android, android-layout, menu

我目前正在开发 Android 应用程序，我还处于起步阶段。在过去的几个月里，我几乎在公司里作为软件开发人员专门开发了 iOS 应用程序，现在我必须在 android 中做同样的事情。

我目前的问题是屏幕上没有出现简单的菜单栏。我制作了一个带有选项卡活动和两个活动的虚拟应用程序，以通过选项卡活动进行切换。接下来我想做的是在这些嵌入式活动之一中显示一个选项菜单。

我就是这样做的（当然我读了一些教程，我认为它必须是正确的）：

1.  在 /res/menu 文件夹中创建 menu.xml：

    ```
    <?xml version="1.0" encoding="utf-8"?>  
    <menu xmlns:android="http://schemas.android.com/apk/res/android">
        <item android:id="@+id/about"
              android:title="About" />
        <item android:id="@+id/help"
              android:title="Help" />
    </menu> 
    ```

2.  在选定的 Activity 中添加了 onCreateOptionsMenu：

    ```
    package com.xitaso.androidlayouttest;

    import android.app.Activity;
    import android.os.Bundle;
    import android.view.Menu;
    import android.view.MenuInflater;

    public class SecondActivity extends Activity{

    public void onCreate(Bundle savedInstanceState) {
            super.onCreate(savedInstanceState);
            setContentView(R.layout.second);
    }

    public boolean onCreateOptionsMenu(Menu menu) {   
            MenuInflater menuInflater = getMenuInflater();  
            menuInflater.inflate(R.menu.menu, menu);  
            return true;  
        } 
    } 
    ```

根据各种教程，应该是这样。有什么我错过的吗，我必须在 Manifest-XML 中添加一些内容吗？

在此先感谢您的帮助！

# c++ - 我可以制作一个从其基础继承的模板特化吗？

> ID：10813165
> 
> 赞同：4
> 
> 时间：2012-05-30T09:06:04.177
> 
> 标签：c++, templates, inheritance

换句话说：是否可以制作一个从其基础继承的模板特化，如下所示：

```
template <class T>  
class A{};  
template <>  
class A<int>:public A<>{}; 
```

使 A 具有 A 的所有功能？我是新来的，所以我不知道如何格式化，以防万一代码出现错误。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-30T09:22:13.993

# php - 脸书 PHP SDK

> ID：10813166
> 
> 赞同：3
> 
> 时间：2012-05-30T09:06:04.623
> 
> 标签：php, facebook, authentication, sdk

我想知道 Facebook PHP SDK 在 Facebook 服务器端身份验证方面是否是最新的（https://developers.facebook.com/docs/authentication/server-side/）

当 FB 传回我的状态和代码时，我很难获得 access_token。我是否打算以编程方式添加此功能？还是 SDK 旨在处理来自 Facebook 的响应？

例子：

我通过FB：

```
https://www.facebook.com/dialog/oauth?client_id=1234567890&redirect_uri=http%3A%2F%2Flocalhost%2F&state=ef8dba2dc8b4fa002973ffa5e29c67cb 
```

脸书返回：

```
http://localhost/?state=ef8dba2dc8b4fa002973ffa5e29c67cb&code=AQAhuVUqufbghj2bBLcCr5SdRJopdYaR-vAoZJzilvvDgiGYNuEPVKTRLqD9p9MPrPhIIubYPH0aka8RtBQU_vSGdkCI5DkQxhQpwWcADu1_jSQgOC9vBsF2oWardpcPcq4PzmNq-JYhdvEFyMD0K7vPY0WioUgLghhw28FJAhHis9K7dz6HyrNy0YXfjbK0AN0#_=_ 
```

但是，SDK 不处理上述来自 Facebook 的响应。Facebook 建议您通过回传代码来获取和访问令牌。

1.  交换用户访问令牌的代码

用户授权您的应用程序后，您应该发出服务器端请求以将上面返回的代码交换为用户访问令牌。

```
https://graph.facebook.com/oauth/access_token?client_id=YOUR_APP_ID
&redirect_uri=YOUR_REDIRECT_URI
&client_secret=YOUR_APP_SECRET
&code=CODE_GENERATED_BY_FACEBOOK 
```

SDK自己不这样做吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-30T09:32:44.460

Try this :

```
$user = $facebook->getUser();

$url = $facebook->getLoginUrl(array(

          'scope'         => 'email,publish_stream,publish_actions',

          'redirect_uri' => 'login.php', //give ur apropriate page

    ));

if($user){

    $acestokn = $facebook -> getaccesstoken();

}else{

    header('location:'.$url);
           exit;
} 
```

# mysql - 从 MySQL 查询结果创建按年份分组的 json 字符串

> ID：10813169
> 
> 赞同：0
> 
> 时间：2012-05-30T09:06:07.917
> 
> 标签：mysql, json, date, request

我有一个 mysql 表：`events`并且想获得特殊格式的 json_string。

```
id   event
1    2010-01-01 00:00:00 
2    2010-02-02 00:00:00 
4    2011-01-04 00:00:00 
5    2012-01-30 00:00:00 
6    2012-02-15 00:00:00 
7    2012-03-16 00:00:00 
8    2012-04-10 00:00:00 
... 
```

我需要获取 json 字符串：

```
{"events":[
{"2010":{"id":1,"event":2010-01-01 00:00:00},{"id":2,"event":2010-02-02 00:00:00}},
{"2011":{"id":4,"event":2011-01-04 00:00:00}},
{"2012":{"id":5,"event":2012-01-30 00:00:00},{"id":6,"event":2012-02-15 00:00:00},{"id":7,"event":2012-03-16 00:00:00},{"id":8,"event":2012-04-10 00:00:00}}
}]} 
```

我的代码如下：

```
 $result = DB::query('SELECT id, event FROM events');
 $events = array();
 while($event = $result->fetch_object()) {
     $events[] = $event;
 }

 return array(
    'events' => json_encode($events);
 ); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-30T09:12:34.077

像这样的东西：

```
$result = DB::query('SELECT id, event, YEAR(event) AS event_year FROM events');
$events = array();
while($event = $result->fetch_object()) {
  $event_year = $event->event_year;
  unset($event->event_year);
  $events[$event_year][] = $event;
}

return array(
  'events' => json_encode($events, JSON_FORCE_OBJECT); // If you need it...
); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-30T09:23:46.850

试试这个 MySQL 查询 -

```
SELECT CONCAT('{"events":[\r\n', GROUP_CONCAT(json SEPARATOR '\r\n'), '\r\n}]}') FROM (
  SELECT
    GROUP_CONCAT(CONCAT('{"', YEAR(event), '": {"id":', id, ',"event":', event, '}}')) json
  FROM
    events1
  GROUP BY
    YEAR(event)
  ) t 
```

它将生成下一个 JSON 字符串 -

```
{"events":[
{"2010": {"id":1,"event":2010-01-01 00:00:00}},{"2010": {"id":2,"event":2010-02-02 00:00:00}}
{"2011": {"id":4,"event":2011-01-04 00:00:00}}
{"2012": {"id":5,"event":2012-01-30 00:00:00}},{"2012": {"id":6,"event":2012-02-15 00:00:00}},{"2012": {"id":7,"event":2012-03-16 00:00:00}},{"2012": {"id":8,"event":2012-04-10 00:00:00}}
}]} 
```

# c# - 如何使用 Asp.net 和 SQL Server 在应用程序中审计日志？

> ID：10813184
> 
> 赞同：0
> 
> 时间：2012-05-30T09:06:56.527
> 
> 标签：c#, .net, sql-server, audit-logging

我在我的 SQL Server 表中创建了以下列：

```
Log_id
Old_value
New_value
Module [The module for the transaction]
Reference_id [unique id of the record from respective tbl to associate with transaction history]
Transaction [The type of transaction. Can include, INSERT, UPDATE or DELETE]
Transaction_status [Indicates SUCCESS or FAILURE]
Stack_trace [The detailed stack trace of the error]
Modified_on
Modified_by 
```

每当发生插入、更新或删除时，将相关数据插入上述审计表的最佳可能和最有效的方法是什么。

请指教。谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-30T10:19:18.673

最好的效率取决于很多事情：数据库负载（多少更新，有多大），您将如何处理数据等。

但一种方法是使用触发器： 关于使用触发器 和 [MSDN 文档](http://msdn.microsoft.com/en-us/library/ms189799.aspx)[添加审计跟踪的博客](http://weblogs.asp.net/jgalloway/archive/2008/01/27/adding-simple-trigger-based-auditing-to-your-sql-server-database.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-30T12:41:16.233

触发器可能有 Modifed_by 的问题。这是 ASP.NET，因此很可能是与 SQL 的单个连接，并且只有 ASP 知道 Modified_by。

如果日志的所有信息都已经在 SQL 中，则触发。

如果日志需要 SQL 中不存在的信息，那么最佳和高效是不一样的。

通过存储过程的两个独立语句将是最有效的。

但是为了数据完整性，将两个语句包装在一个事务中，以便它们作为一个单元成功或失败。开销很小。再次在存储过程中。或者在后面的代码中你可以使用 TSQL 和事务，但存储过程会更快更安全。

还要查看日志中的索引。更少的索引是更快的插入。日志是您可能希望优化插入速度而不是选择速度的地方。

# java - 使用 Sax Parser、Java 处理 XML 中的空标签

> ID：10813185
> 
> 赞同：7
> 
> 时间：2012-05-30T09:06:58.677
> 
> 标签：java, xml, sax, saxparser

我正在使用 Sax 解析器来处理预先编写的 XML 文件....我无法更改 XML，因为它由另一个应用程序持有，但需要从中解析数据。XML 文件包含一个标签 < ERROR_TEXT/> ，当没有发生错误时该标签为空。结果，解析器在标记关闭之后获取下一个字符，即“\n”。我试过 result.replaceAll("\n", ""); 和 result.replaceAll("\n", "");

如何让 SAX 识别这是一个空标记并将值返回为 "" ？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2017-11-10T07:38:48.957

你做吧。如果你有 xml 和 Java 源代码。

```
<ERROR_TEXT>easy</ERROR_TEXT><ERROR_TEXT/> 
```

Java 代码

```
private boolean isKeySet = false;
private String key = "";
@Override
public void characters(
    char[] ch,
    int start,
    int length
) throws SAXException
{
    if (!isKeySet) {
        return;
    }
    isKeySet = false;
    logger.debug("key : [" + key + "], value : [" + value + "]");
}
@Override
public void startElement(
    String uri,
    String localName,
    String qName,
    Attributes attrs
) throws SAXException
{
    key = qName;
    isKeySet = true;
}

@Override
public void endElement(
    String uri,
    String localName,
    String qName
) throws SAXException
{
    if (isKeySet) {
        isKeySet = false;
        logger.debug("key : [" + key + "](EMPTY!!!)");
    }
} 
```

结果日志：

> 键：[ERROR_TEXT]，值：[简单]
> 
> 键：[ERROR_TEXT]（空！！！）

**调用流程：startElement() -> characters() -> endElement() -> startElement() -> endElement() -> characters()**

而已！结束

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-01-27T07:43:57.273

`SAXParser`*当它遇到字面上*`cDAta`的“字符”时，它会通过`characters()`它调用的事件返回。使用该函数是没有意义的，因为它在每个打开的标签之后调用，无论它是否实际包含任何数据。在继续之前，您可以使用并进行检查。*`String.trim()``String.length()>=0`*

 ** * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-30T09:40:27.673

你没有。SAX 的工作是解析数据，而不是决定数据的内容应该是什么。在您的 parseHandler 中，将数据字符串存储在所有元素中，然后在处理该元素时，对数据执行 string.trim()。如果它的输出为空白并且您的标签是 ERROR_TEXT 标签，则您知道没有错误。*

# python - 每秒运行一个 python 函数

> ID：10813195
> 
> 赞同：4
> 
> 时间：2012-05-30T09:07:48.130
> 
> 标签：python

我想要的是能够每秒运行一个函数，与函数需要多长时间无关（它应该总是在一秒钟以下）。我考虑了许多选项，但不确定哪个是最好的。

如果我只使用延迟函数，它不会考虑函数运行所需的时间。

如果我对函数计时，然后从一秒中减去它并在延迟中弥补其余部分，则不会考虑时间计算。

我尝试使用 threading.timer（我不确定它的工作原理），但它似乎确实比 1s 慢。

这是我尝试测试 threading.timer 的代码：

```
def update(i):
    sys.stdout.write(str(i)+'\r')
    sys.stdout.flush()
    print i
    i += 1
    threading.Timer(1, update, [i]).start() 
```

有没有办法做到这一点与函数花费的时间长度无关？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-30T09:12:14.873

这样就可以了，而且它的准确性不会随着时间的推移而漂移。

```
import time

start_time = time.time()
interval = 1
for i in range(20):
    time.sleep(start_time + i*interval - time.time())
    f() 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-05-30T09:15:24.870

实际上不应该使用使用 threading.Timer 的方法（参见下面的代码），因为每个时间间隔都会启动一个新线程，并且这个循环永远无法干净地停止。

```
# as seen here: https://stackoverflow.com/a/3393759/1025391
def update(i):
  threading.Timer(1, update, [i+1]).start()
  # business logic here 
```

如果您想要一个后台循环，最好启动一个运行循环的新线程，如另一个答案中所述。哪个能够接收到停止信号，你`join()`最终可以线程。

[这个相关的答案](https://stackoverflow.com/questions/22498038/improve-current-implementation-of-a-setinterval-python/22498708#22498708)似乎是实现这一点的一个很好的起点。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2016-02-28T19:20:50.913

如果`f()`总是花费不到一秒的时间，则在一秒的边界上运行它（没有漂移）：

```
import time

while True:
    time.sleep(1 - time.monotonic() % 1)      
    f() 
```

这个想法来自[@Dave Rove 对类似问题的回答](https://stackoverflow.com/a/25251804/4279)。

要了解它是如何工作的，请考虑一个示例：

1.  `time.monotonic()`返回`13.7`并被`time.sleep(0.3)`调用
2.  `f()`大约（±一些错误）`14`秒（自`time.monotonic()`纪元以来）被调用
3.  `f()`运行，需要`0.1`(< 1) 秒
4.  `time.monotonic()`返回大约`14.1`几秒钟并被`time.sleep(0.9)`调用
5.  `15`步骤 2\. 在几秒钟左右重复（从`time.monotonic()`纪元开始）
6.  `f()`运行并且需要`0.3`(< 1) 秒（注意：该值与步骤 2 不同。）
7.  `time.monotonic()`返回`15.3`并被`time.sleep(0.7)`称为
8.  `f()`在几秒钟左右被调用`16`并重复循环。

每一步`f()`都在一秒钟的边界上调用（根据`time.monotonic()`计时器）。错误不会累积。没有漂移。

另请参阅：[如何在 python 中定期运行函数（使用 tkinter）](https://stackoverflow.com/a/26609843/4279)。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-30T09:29:55.323

这个怎么样：每次跑步后，睡`(1.0 - launch interval)`几秒钟。您可以通过更改来更改终止条件`while True:`。虽然如果你的函数运行时间超过 1 秒，这会出错。

```
from time import time, sleep

while True:
    startTime = time()
    yourFunction()
    endTime = time()-startTime
    sleep(1.0-endTime) 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2014-06-28T15:14:24.463

线程可能是一个不错的选择。基本概念如下。

```
import threading

def looper():    
    # i as interval in seconds    
    threading.Timer(i, looper).start()    
    # put your action here
    foo()

#to start 
looper() 
```

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2020-03-31T06:53:01.313

我想推荐以下代码。如果需要，您可以将 True 替换为任何条件。

```
while True:
time.sleep(1) #sleep for 1 second
func()    #function you want to trigger 
```

* * *

告诉我它是否有效。

# java - 如何比较java中的两个hashmap？

> ID：10813196
> 
> 赞同：0
> 
> 时间：2012-05-30T09:07:49.247
> 
> 标签：java, hashmap

我有两个哈希映射，如下所示：

```
1.=============Employee=================

Key : 1_10 : Value : 13/04/2012
Key : 1_11 : Value : 18/04/2012
Key : 1_12 : Value : 19/04/2012
Key : 1_14 : Value : 23/04/2012
Key : 1_13 : Value : 20/04/2012
Key : 1_16 : Value : 25/04/2012
Key : 1_1  : Value : 02/04/2012
Key : 1_15 : Value : 24/04/2012
Key : 1_18 : Value : 27/04/2012
Key : 1_3  : Value : 04/04/2012
Key : 1_17 : Value : 26/04/2012
Key : 1_2  : Value : 03/04/2012
Key : 1_5  : Value : 06/04/2012
Key : 1_19 : Value : 30/04/2012
Key : 1_4  : Value : 05/04/2012
Key : 1_7  : Value : 10/04/2012
Key : 1_6  : Value : 09/04/2012
Key : 1_9  : Value : 12/04/2012
Key : 1_8  : Value : 11/04/2012

2.=============Working day=================

Key : 27 : Value : 27/4/2012
Key : 02 : Value : 02/4/2012
Key : 26 : Value : 26/4/2012
Key : 19 : Value : 19/4/2012
Key : 11 : Value : 11/4/2012
Key : 04 : Value : 04/4/2012
Key : 30 : Value : 30/4/2012
Key : 06 : Value : 06/4/2012
Key : 13 : Value : 13/4/2012
Key : 09 : Value : 09/4/2012
Key : 03 : Value : 03/4/2012
Key : 23 : Value : 23/4/2012
Key : 20 : Value : 20/4/2012
Key : 16 : Value : 16/4/2012
Key : 10 : Value : 10/4/2012
Key : 18 : Value : 18/4/2012
Key : 25 : Value : 25/4/2012
Key : 17 : Value : 17/4/2012
Key : 12 : Value : 12/4/2012
Key : 24 : Value : 24/4/2012
Key : 05 : Value : 05/4/2012 
```

键不同，但值相同，有时值不同。

我想找出`employeemap`比较时不存在的值`workingdaymap`

```
if (!employeeMap.containsValue(workingdayMap.get(wKey))) {
    //take the value which is not present in employeeMap which is present in workingdayMap
} 
```

但它给了我来自employeeMap 的空值。

你能帮我解决这个问题吗？

问候托尼

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-30T09:12:08.913

值日期对象？如果是这样，您将尝试查看映射是否包含相同的对象（以及它的哈希，除非您在两个映射中存储了完全相同的实例，否则它会有所不同）而不是对象的值。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-30T09:25:01.473

像这样的东西应该工作：

```
Set workingValues = new HashSet(workingdayMap.values());
workingValues.removeAll(employeeMap.values()); 
```

我们从`workingdayMap`使用该`values()`方法中获得了所有值。我们不想`Collection`直接修改它，因为它会修改`workingdayMap`，所以我们创建了一个`Set`名为`workingValues`.

然后，我们删除所有在`employeeMap`其中找到的值，这些值将保留在 in`workingdayMap`但不在 in`employeeMap`中的值`workingValues`。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-30T09:30:18.527

你能试试这样吗。

```
 HashMap<String, Date> employeeMap = new HashMap<String, Date>();

    HashMap<String, Date> workingdaymap = new HashMap<String, Date>();

    Set<String> values1 = new HashSet<String>(employeeMap.values());
    Set<String> values2 = new HashSet<String>(workingdaymap.values());
    boolean equal = values1.equals(value2); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-30T12:21:59.370

下面是完美运行的代码，比较失败的原因是地图值不同。

```
Key : 27 : Value : 27/4/2012, Key : 1_18 : Value : 27/04/2012 
```

如果我们看到日期，就会清楚地看到差异。 `27/4/2012`与 `27/04/2012`我将其存储为字符串不同。

```
Iterator<Map.Entry<String,String>> holyDayiterator = workingdayMap.entrySet().iterator();

                 while (holyDayiterator.hasNext()) {
                    Map.Entry holiDayEntry = holyDayiterator.next();
                    if(!employeeMap.containsValue((holiDayEntry.getValue()))){
                        System.out.println("works perfect");
                    } 
```

感谢大家的支持，也感谢投反对票的人。

:) 托尼

# iphone - 从 Superview 中删除表子视图

> ID：10813202
> 
> 赞同：0
> 
> 时间：2012-05-30T09:08:12.287
> 
> 标签：iphone, ios, ios4

嗨，在我的应用程序中，我最初从应用程序委托加载了一个视图。接下来，当某个按钮单击此根视图时，我添加了此代码。

```
-(IBAction)method
{
   View1 *v1=[[View1 alloc] init];
   CGRect frame = CGRectMake(0.0f, 100.0f, 320.0f, 250.0f);
   v1.view.frame=frame;

   hideView = [[UIView alloc] initWithFrame: CGRectMake(0,0,320,480)];
   hideView.backgroundColor = [UIColor blackColor];
   hideView.alpha =0.8;
   [hideView addSubview:v1.view];
   [self.view addSubview:hideView];
} 
```

在上面的代码中，View1 是另一个视图控制器，隐藏视图只是根视图控制器中的一个视图。现在完全为根视图控制器添加了两个视图。现在我的问题是当我单击表格单元格时，我想从根视图中删除两个添加的子视图。这该怎么做？而且当我将此子视图添加到根视图时，滚动也无法到表视图并说访问错误如何解决这个问题？或任何其他方式来做到这一点。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-30T09:18:07.700

您可以为任何视图（子视图）设置唯一`tag`性，以便以后轻松检索对它们的引用。

例如，在您的情况下，您可以添加以下行：

```
 v1.tag = 10112;
 hideView = 10113; 
```

稍后您可以输入对该视图的引用：

```
//view - is a root view of that subviews
View1 *v1 = [view viewWithTag:10112];
UIView *hideView = [view viewWithTag:10113];

// and now you are able to remove them:
[v1 removeFromSuperview];
[hideView removeFromSuperview]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-30T09:27:32.467

如果`View1`是 inside `hideView`，那么您可以调用`[hideView removeFromSuperView];`以删除两者，或者仅使用 @Nekto 解决方案来识别您要删除的视图。
对于滚动问题，如果您在顶部添加一个视图，`UITableView`您将失去表格的滚动，这是正常的，您可以查看 UIView 的[hitTest](http://developer.apple.com/library/ios/#documentation/uikit/reference/uiview_class/uiview/uiview.html#//apple_ref/occ/instm/UIView/hitTest%3awithEvent%3a)方法。

# dynamics-crm - 为 CRM 网格着色

> ID：10813204
> 
> 赞同：2
> 
> 时间：2012-05-30T09:08:18.673
> 
> 标签：dynamics-crm, dynamics-crm-4

如何在 Dynamics CRM 4 上为 CRM 网格着色？

我想在加载视图时自动显示带有背景颜色的实体列表。

我的目标是根据所列实体的状态使用不同的颜色。例如，我想为具有过去日期字段的案例设置一种颜色，而为将来具有此日期的案例设置另一种颜色。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-30T09:08:19.157

下面描述的解决方案是Microsoft**不支持**的更改（也就是说，使用它需要您自担风险）。另外，不能保证在应用 CRM 汇总时它不会被破坏。

* * *

在 CRM 服务器上，修改`C:\Program Files\Microsoft Dynamics CRM\CRMWeb\_static\_grid\grid.htc`文件：

`initializeData()`在函数末尾添加以下代码：

```
if (window.location.href.toLowerCase() == 
    "http://CrmServerName:5555/OrganizationName/cs/home_cases.aspx") {
    // We ensure that we are on the organization we want to colorize and that we 
    // are on the Cases page

    var colorizeColumn = InnerGrid.FindColumnIndex("new_date");

    if (colorizeColumn > 0) {
        // We ensure that the column we'll use to colorize is present

        for (var i = 0; i < InnerGrid.AllRecords.length; i++) {
            // For each line

            // Build the date value from the displayed date
            var new_date_displayed = InnerGrid.AllRecords[i][3].
                cells[colorizeColumn].innerText;
            var new_date_value = new Date(new_date_displayed.substring(6,10), 
                                          new_date_displayed.substring(3,5) - 1, 
                                          new_date_displayed.substring(0,2), 
                                          new_date_displayed.substring(11,13), 
                                          new_date_displayed.substring(14,16), 0, 0);
            // Get current date
            var current_datetime = new Date();

            if (new_date_value <= current_datetime) {
                InnerGrid.rows[i].style.backgroundColor="ff0066";
            } else {
                InnerGrid.rows[i].style.backgroundColor="ff6600";
            }
        }
   }
} 
```

这就是你得到的：

![彩色网格](../Images/ffe708e85157635b4863194663771870.png)

# jquery - 一页上的 Fancybox 和 Nivo 滑块不起作用

> ID：10813209
> 
> 赞同：1
> 
> 时间：2012-05-30T09:08:26.637
> 
> 标签：jquery, fancybox, nivo-slider

我想在我的网站的横幅中实现一个简单的 Nivo 幻灯片，并在它下面实现一个花式画廊 - 我只是无法让它们同时工作。Nivo 滑块优先，当我禁用它时，fancybox 画廊工作。我正在使用 fancybox v2 (jquery 1.7.2) 和 nivo 滑块 jquery 1.7.1 - 是这个问题吗？我的 jquery 和 js 技能非常初级，所以请为我拼写出来 - 非常感谢！这里是测试站点：[http ://designasite.co.za/aerialphotographer/](http://designasite.co.za/aerialphotographer/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-30T09:23:31.343

我在使用 Nivo Slider 和 SigPro 库时遇到了类似的问题（直到我选择了一个不依赖于相同 jQuery 代码的版本）。我相信 Nivo 滑块改变了 jQuery 的一些工作方式，并且很容易与其他图像处理模块/插件不兼容。

我的建议是简单地尝试另一款画廊软件，或另一款幻灯片软件。或者，根本不要将两者放在同一页面上。

Nivo 的一个众所周知的不受欢迎的部分。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-30T09:35:00.353

我会尝试清理你的 jQuery，试试这个：

```
<script type="text/javascript">
    $(document).ready(function() {
        $(".fancybox").fancybox();

        $('#slider').nivoSlider({
            effect: 'fade', // Specify sets like: 'fold,fade,sliceDown'
            animSpeed: 1000, // Slide transition speed
            pauseTime: 3000, // How long each slide will show
        });

    });
</script> 
```

另外，删除

```
<script type="text/javascript" src="scripts/jquery-1.7.1.min.js"></script> 
```

在包含和初始化当前 nivo 滑块插件的位置上方，并移动

```
<script type="text/javascript" src="scripts/jquery.nivo.slider.pack.js"></script> 
```

`head`与其他包含的文件一起进入您的标签。

这样做的原因是您应该只包含一次 jQuery，并且在页面上也只使用一个版本，同时包含所有插件和 css 文件是一种很好的做法，通常建议在底部实际包含您的 jQuery 插件您的页面，这样它就不会减慢您的初始页面的加载速度，但无论您拥有它，请将它们放在同一位置，以便更容易找到它们。

# jquery - 将 json 数据传递给 jQuery.post 函数

> ID：10813212
> 
> 赞同：0
> 
> 时间：2012-05-30T09:08:40.570
> 
> 标签：jquery, json, getelementbyid

我将尝试使用 jQuery 代码：

```
$.post("test.php", { category: "Ubuntu", newname: "Hash" },

function(data) {
     alert("Data Loaded: " + data);
   }); 
```

但在 json 数据中，我想使用从表单域中获取的一些数据。我曾经使用`getElementById('fieldname').value`. 如何将变量传递给 json 查询？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-30T09:10:33.983

```
var category = $('#fieldname1').val(), // just assume id with fieldname1, fieldname2 etc
    newname =  $('#fieldname2').val();

$.post("test.php", { category:category , newname: newname  },

function(data) {
     alert("Data Loaded: " + data);
   }); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-30T09:15:28.180

我们可以在 jquery 中发布任何内容

```
var cat = $('#cat').val(),//for taking category value
    name =  $('#new').val();//for taking newname value
$.post("test.php", { category:cat , newname: name  },function(data) {
     alert("Data that came from server : " + data);
}); 
```

您可以将服务器中的变量作为**类别**访问，将新**名称**作为变量访问。访问它们，然后**返回**您想要的数据。您**返回的数据**来自回调**函数（）**的变量**数据**。

 **在这里，我们访问了 id 为**cat**和**new的****文本框**的值。**

# xcode - 在 xcode 中更改我的应用程序图标（OSX 应用程序）

> ID：10813213
> 
> 赞同：1
> 
> 时间：2012-05-30T09:08:48.423
> 
> 标签：xcode, macos, cocoa

我更改了图标（将我的 icon.png 拖到图标位置）但是当我运行我的应用程序时，在停靠栏中不显示图标并显示默认图标

我怎么解决这个问题

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-30T09:12:44.297

您是否在 plist 文件中将“图标文件”字段值更改为 icon.png

然后清理并构建项目

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-30T16:07:01.757

您应该制作`.icns`并将其拖到您的项目中。您可以从以下链接中找到有关它的信息：

[创建 icns 图标文件](http://murphymac.com/creating-icns-icon-files/)

[如何：为您的 Mac 创建自定义图标](http://macapper.com/2007/04/21/how-to-create-custom-icons-for-your-mac/)

[如何制作 Mac 图标](http://www.macinstruct.com/node/59)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-30T09:10:55.070

尝试清理（`Product -> Clean`）您的项目并再次构建（`Product -> Build`）它。

还要检查项目中是否列出了所有图标文件`plist`。

# grails - javascript 库中的 Grails 应用程序上下文

> ID：10813217
> 
> 赞同：4
> 
> 时间：2012-05-30T09:09:20.023
> 
> 标签：grails

是否可以访问

```
grails.app.context 
```

从javascript库中？--也就是说，不是将javascript插入到GSP文件中。

我有一些依赖于上下文的 javascript，为什么我需要能够从 javascript 访问它。

我在我的 gsp 文件中包含了 javascript：

```
<r:require modules="myModule" /> 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-30T09:12:33.687

您可以将它作为全局 JS 变量传递给 Javascript，将其放在`<head>`标签内：

```
<g:javascript>
   window.appContext = '${request.contextPath}';
</g:javascript> 
```

并在普通 javascript 的任何地方使用它，例如：

```
$.ajax({
   url: appContext + '/hello/world'
}) 
```

# web-services - 如何在 JAX-WS 客户端中指定 ReplyTo EndpointReference？

> ID：10813220
> 
> 赞同：3
> 
> 时间：2012-05-30T09:09:31.237
> 
> 标签：web-services, jax-ws, ws-addressing

我想使用 JAX-WS API 创建启用 WS-Addressing 的 Web 服务客户端。我使用 wsimport 从 WSDL 文件创建客户端存根，并且可以使用 AddressingFeature 启用/禁用 WS-Addressing，例如

```
Hello hello = service.getHelloSoap11(new AddressingFeature(true, true)); 
```

但是，我在 Web 中找不到任何自定义 WS-Addressing ReplyTo/FaultTo 端点引用的示例。基本上我想创建一个如下所示的 WS 请求（请参阅**wsa:ReplyTo**元素）：

```
<soapenv:Envelope ...>
  <soapenv:Header xmlns:wsa="http://www.w3.org/2005/08/addressing">
    <wsa:To soapenv:mustUnderstand="1">http://localhost:8080/poc/helloService/
    </wsa:To>
    <wsa:ReplyTo>
      <wsa:Address>http://mycompany.com/poc/reply</wsa:Address>
      <wsa:ReferenceParameters>
        <field1 xmlns="http://mycompany.com/poc/cust">some value1</field1>
        <field2 xmlns="http://mycompany.com/poc/cust">some value2</field2>
      </wsa:ReferenceParameters>
    </wsa:ReplyTo>
    <wsa:Action>http://mycompany.com/poc/sayHello</wsa:Action>
    <wsa:MessageID>urn:uuid:7849b04f-c74e-4836-99e4-8e25d2700fae
    </wsa:MessageID>
  </soapenv:Header>
  <soapenv:Body>
    ...
  </soapenv:Body>
</soapenv:Envelope> 
```

如果使用 Spring Web Service 客户端，我可以添加端点引用。但是，我需要使用 JAX-WS 来完成。有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-25T06:34:24.797

我回答我自己的问题。

似乎标准 JAX-WS API 没有提供一种方便的方式来自定义 WS-Addressing From/ReplyTo/FaultTo 端点引用。但是，每个 JAX-WS 运行时都可能提供额外的专有 API 来设置标头。

例如，IBM JAX-WS RI 提供了**EndpointReferenceManager** SPI 来创建端点引用：

```
 import com.ibm.wsspi.wsaddressing.EndpointReference;
    import com.ibm.wsspi.wsaddressing.EndpointReferenceManager;
    import com.ibm.wsspi.wsaddressing.WSAConstants;

    public void testWSAddressing () {

    // get the port
    Hello hello = service.getHelloSoap11();

    // build a EndpiontReference of <wsa:ReplyTo>
    BindingProvider bp = (BindingProvider) hello;
    EndpointReference epr = EndpointReferenceManager.createEndpointReference(new URI(
       "http://www.w3.org/2005/08/addressing/anonymous"));
    epr.setReferenceParameter(new QName("http://mycompany.com/test", "someRefParam"),
                "12345678");

    ((BindingProvider) hello).getRequestContext()
            .put(WSAConstants.WSADDRESSING_REPLYTO_EPR, epr);
    ...

    HelloResponse response = hello.hello(request);
    } 
```

上面的代码在 IBM Websphere 中运行时，将生成如下所示的 SOAP 消息：

```
<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/">
  <soapenv:Header xmlns:wsa="http://www.w3.org/2005/08/addressing">
    <wsa:To>http://localhost:8080/poc/helloService/</wsa:To>
    <wsa:ReplyTo>
      <wsa:Address>http://www.w3.org/2005/08/addressing/anonymous
      </wsa:Address>
      <wsa:ReferenceParameters>
        <someRefParam xmlns="http://mycompany.com/test">12345678</someRefParam>
      </wsa:ReferenceParameters>
    </wsa:ReplyTo>
    <wsa:MessageID>urn:uuid:BE9E173A35BAB51CB31338454394298
    </wsa:MessageID>
    <wsa:Action>http://mycompany.com/Hello</wsa:Action>
  </soapenv:Header>
  <soapenv:Body>
    ...
  </soapenv:Body>
</soapenv:Envelope > 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-07-15T13:02:26.600

我找到了一种使用标准 JAX-WS 执行此操作的方法。获取端口时，同时使用 AddressingFeature 和 OneWayFeature。

```
AddressingFeature addressingfeature = new AddressingFeature();
OneWayFeature onewayfeature = new OneWayFeature(true, new WSEndpointReference(YOUR_REPLY_TO_ADDRESS, AddressingVersion.W3C));

// get the port
Hello hello = service.getHelloSoap11(addressingfeature, onewayfeature); 
```

这将产生带有“ReplyTo”标签的消息。您可能必须为此获取“com.sun.xml.ws:jaxws-rt”依赖项。

# c# - 从外部应用程序向 Web 浏览器添加书签

> ID：10813221
> 
> 赞同：3
> 
> 时间：2012-05-30T09:09:33.190
> 
> 标签：c#, powershell

有谁知道是否可以从外部应用程序向网络浏览器（Safari、IE、FF、Chrome、Opera）添加书签？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-30T10:08:30.503

对于**IE**：

您需要在这里创建一个链接文件：

C＃

```
 Environment.GetFolderPath(Environment.SpecialFolder.Favorites) 
```

电源外壳

```
 [Environment]::GetFolderPath( [System.Environment+SpecialFolder]::Favorites) 
```

**铬合金：**

您需要在 json 格式文件中添加条目`bookmarks`（无扩展名）：

开`Win7`是

```
C:\Users\<YOURUSERNAME>\AppData\Local\Google\Chrome\User Data\Default\ 
```

**火狐：**

书签存储在`SQLite`：

```
../Application Data/Mozilla/Firefox/Profiles/{your firefox profile}/places.sqlite 
```

使用`System.Data.SQLite`您可以尝试添加链接，但我无法为您提供更多帮助。

无法为您提供 Safari 和 Opera 的帮助

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-30T09:32:04.317

[在 Powershell V2 ISE (x86) 中，此](http://blogs.technet.com/b/heyscriptingguy/archive/2010/06/08/hey-scripting-guy-how-can-query-the-contents-of-a-special-folder-on-a-windows-7-computer.aspx)代码将列出系统上的所有特殊文件夹，甚至是-

```
$objShell = New-Object -com "Wscript.Shell"
$objShell.SpecialFolders | WHERE {$_.ToString() -match "Fav"} 
```

然后，您可以访问和操作 C:\Users\username\Favorites 文件夹。我不知道这是否会扩展到所有浏览器[IE除外]

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2020-01-21T22:24:24.573

这是我想出的从 PowerShell 向 Chrome 添加书签的解决方案：

```
$fileBookmarks="$env:LOCALAPPDATA\Google\Chrome\User Data\Default\Bookmarks"
$dataBookmarks=Get-Content $fileBookmarks -Encoding UTF8| Out-String |ConvertFrom-Json
function createNewChromeBookmark ($Bookmarks, [string]$BookmarkName, [string]$BookmarkURL) {
    function getBookmarkIDs($object){
        $object | ForEach-Object{
            "{0:0000}" -f [int]($_.id);
            if([bool]($_.PSobject.Properties.name -match "children")){
                GetBookmarkIDs($_.children);
            }
        }
    };
    $nextBookmarkID = [int](getBookmarkIDs -object $Bookmarks.roots.bookmark_bar|Sort-Object -Descending|Select-Object -First 1) + 1
    $currentChomeTime=[System.DateTimeOffset]::Now.ToUnixTimeMilliseconds()*10000;
    $newBookmark= [PSCustomObject]@{
        date_added=$currentChomeTime
        guid=[guid]::NewGuid()
        id=$nextBookMarkID
        name="$BookmarkName"
        type="url"
        url="$BookmarkURL"
    }
    return $newBookmark;
}
$newBookmark = createNewChromeBookmark -Bookmarks $dataBookmarks -BookmarkName "Your Bookmark Name" -BookmarkURL "https://[Your URL Here]";
$dataBookmarks.roots.bookmark_bar.children += $newBookmark;
$dataBookmarksJSON = ConvertTo-Json -InputObject $dataBookmarks -Depth 200
Set-Content -Path $fileBookmarks -Value $dataBookmarksJSON -Encoding UTF8 
```

# php - OOP，MySQL 类的问题

> ID：10813227
> 
> 赞同：-2
> 
> 时间：2012-05-30T09:09:53.750
> 
> 标签：php, mysql

MVC 返回 fetch_array/object 结果的类

> ```
>  class DbDriver{
>     private $connection;
>     private $query;
>     private $result;
>     public function connect()
>         {
>         $host             = 'localhost';
>         $user             = '';
>         $password         = '';
>         $database         = '';
>         $this->connection = mysql_connect($host, $user, $password);
>         $this->connection = mysql_select_db($database);
>         return TRUE;
>         }
>     public function disconnect()
>         {
>         $this->connection->mysql_close();
>         return TRUE;
>         }
>     public function prepare($query)
>         {
>         $this->query = $query;
>         return TRUE;
>         }
>     public function query()
>         {
>         if (isset($this->query))
>             {
>             $this->result = $this->connection->mysql_query($this->query);
>             return TRUE;
>             }
>         return FALSE;
>         }
>     public function fetch($type = 'object')
>         {
>         if (isset($this->result))
>             {
>             switch ($type)
>             {
>                 case 'array':
>                     $row = $this->result->mysql_fetch_array();
>                     break;
>                 case 'object':
>                 default:
>                     $row = $this->result->mysql_fetch_object();
>                     break;
>             }
>             return $row;
>             }
>         return FALSE;
>         }
>     } 
> ```

返回

[2012 年 5 月 30 日星期三 11:55:42] [错误] [客户端] PHP 致命错误：在第 30 行的 /var/www/httpdocs/test/mysql.php 中的非对象上调用成员函数 mysql_query()

第 30 行

```
 $this->result = $this->connection->mysql_query($this->query); 
```

生病疯了。>.<

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-30T09:13:51.750

因为mysql_query：

> 成功时返回 MySQL 链接标识符，失败时返回 FALSE。

所以 $this->connection 不是**object**。

请使用[PDO](http://php.net/manual/en/book.pdo.php)驱动或[MySQLi](http://www.php.net/manual/en/mysqli.quickstart.php)，mysql_* 扩展[将在未来被弃用](http://us.php.net/manual/en/mysqlinfo.api.choosing.php)。

好的 PDO[示例](http://www.phpro.org/tutorials/Introduction-to-PHP-PDO.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-30T09:16:11.910

这是你的问题

```
$this->connection = mysql_select_db($database); 
```

`mysql_select_db`返回`bool`

但请看一下 PDO 或 mysqli

# java - Hibernate 映射要由表连接加载的特定字段

> ID：10813228
> 
> 赞同：2
> 
> 时间：2012-05-30T09:09:54.423
> 
> 标签：java, database, hibernate, orm, hibernate-mapping

有没有办法可以映射休眠对象中的字段以加载表查询？

例如，可以说`Table_Message`有字段`id(int),message_key(varchar),message_content(Clob),language(varchar)`。该表将保存不同语言（区域设置）的消息。

还有另一个使用休眠映射到实体的表。`Comments`与字段`id(int),comment_message_id(varchar),created_date(datetime)`。`comment_message_id`指`Table_Message`'`message_key`列。

编辑：Table_Message 不是休眠中的映射实体

假设我的评论课是

```
public class Comment
{
   int id;
   String message;
   Date createdDate;
} 
```

有没有办法通过使用默认语言环境（例如“en”）通过 message_key 加入 Comment 表和 Table_Message 表来告诉休眠加载消息。

基本上有没有办法告诉休眠通过运行特定查询来加载字段？如果是这样，那是什么？

我知道为加载实体编写自定义 SQL 查询。但由于我使用的是 XDoclet，似乎没有办法做到这一点。如果有一种方法可以为单个字段执行此操作，那将非常方便。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-30T11:05:51.880

您必须通过`comment_message_id`with连接表`message_key`并通过 进一步过滤结果`language`。我认为它`message_key`是独一无二的。

附带说明：您应该使用整数键以获得更好的性能。

您可以尝试在 SQL 中编写数据库视图并创建一个实体以使视图不透明：

```
CREATE VIEW Comment_Table_Message AS 
SELECT c.id, c.comment_message_id, c.created_date, m.id AS mid, 
       m.message_content, m.language 
FROM Comment c, Table_Message m 
WHERE c.comment_message_id = t.message_key; 
```

现在您可以创建实体`CommentTableMessage`并使用 JPQL 按语言过滤结果：

```
SELECT x FROM CommentTableMessage x WHERE x.language=?1 
```

* * *

如果 Table_Message 是一个 Hibernate 实体，你会写（用 JPA 术语）：

```
@Entity
public class Comment
{
   int id;
   @ManyToOne()
   @JoinColumn(name="comment_message_id")
   TableMessage tableMessage;
   String message;
   Date createdDate;
}

@Entity
public class TableMessage {
   int id;
   @Id
   String messageKey;
   bytes[] messageContent; //I don't know how you want to deal with Blobs?
   String language;
} 
```

有了它，您可以编写一个简单的 JPA 查询：（您可以使用 JPA 吗？-下一个假设）

```
SELECT c FROM Comment c WHERE c.tableMessage.language=?1 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-31T06:44:22.450

我想 ResultTransformer 可以帮助你。请检查

[http://docs.jboss.org/hibernate/orm/3.3/api/org/hibernate/transform/ResultTransformer.html](http://docs.jboss.org/hibernate/orm/3.3/api/org/hibernate/transform/ResultTransformer.html) http://stackoverflow.com/questions/6423948/resulttransformer-in-hibernate-return-null

# sql-server-2008 - 如何使用 WKT 作为函数的输入？

> ID：10813230
> 
> 赞同：3
> 
> 时间：2012-05-30T09:10:00.570
> 
> 标签：sql-server-2008, spatial

我在 t-sql 语句中有以下 where 子句：

```
where a.CELL_GEOM.STIntersects(
STGeomFromText('POLYGON((-25.43623984375 44.257784519021, 21.62918984375 44.257784519021, 21.62918984375 60.752403080295, -25.43623984375 60.752403080295, -25.43623984375 44.257784519021))', 4326)) = 'true' 
```

该行报告错误：

```
'STGeomFromText' is not a recognized built-in function name. 
```

如何使用此函数中显示的众所周知的文本值？我只是在 STGeomFromText 中使用了不正确的语法，因为这是我见过的唯一示例。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-30T09:19:31.630

尝试在`geometry::`文档中使用 like 为函数名称添加前缀？

例如：`geometry::STGeomFromText( ...`

[链接到文档](http://msdn.microsoft.com/en-us/library/bb933823.aspx)

# java - 如何使用 WebDriver 将字符串保存为变量，然后在另一个测试中使用 tis 变量

> ID：10813233
> 
> 赞同：0
> 
> 时间：2012-05-30T09:10:04.623
> 
> 标签：java, variables, webdriver, store

我在保存用户名和密码时遇到问题。注册后，用户在注册页面获取用户名和密码。我想将此用户名和密码存储为变量，然后再使用它。这适用于 Selenium IDE 中的存储文本和 javascript，但这不适用于使用 Java 的 WebDriver。任何想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-30T09:24:44.377

你是这个意思吗？

```
import static org.junit.Assert.*;

import org.junit.Test;

public class AbcTest {

    static String aString = "";

    @Test
    public void test1() {

        aString = "abc";

    }

    @Test
    public void test2() {

        assertTrue(aString.equals("abc"));

    }

} 
```

# java - 从另一个打开的应用程序中的问题

> ID：10813241
> 
> 赞同：0
> 
> 时间：2012-05-30T09:10:27.557
> 
> 标签：java, android, android-package-managers

我正在制作一个应用程序，在其中我获得手机上安装应用程序的列表，然后我从我的应用程序中点击并打开这些应用程序。但是这里提出的问题`CATEGORY_LAUNCHER`给出了空指针

**我的 logcat 输出::**

```
05-30 14:34:33.876: E/Handler(14042): Failed to handle callback; interface not implemented, callback:android.view.View$PerformClick@40e35d70
05-30 14:34:33.876: E/Handler(14042): java.lang.NullPointerException
05-30 14:34:33.876: E/Handler(14042):   at com.AppFavorits.GetAllApp$1$1.onClick(GetAllApp.java:83)
05-30 14:34:33.876: E/Handler(14042):   at android.view.View.performClick(View.java:3538)
05-30 14:34:33.876: E/Handler(14042):   at android.widget.CompoundButton.performClick(CompoundButton.java:105)
05-30 14:34:33.876: E/Handler(14042):   at android.view.View$PerformClick.run(View.java:14330)
05-30 14:34:33.876: E/Handler(14042):   at android.os.Handler.handleCallback(Handler.java:607)
05-30 14:34:33.876: E/Handler(14042):   at android.os.Handler.dispatchMessage(Handler.java:92)
05-30 14:34:33.876: E/Handler(14042):   at android.os.Looper.loop(Looper.java:154)
05-30 14:34:33.876: E/Handler(14042):   at android.app.ActivityThread.main(ActivityThread.java:4974)
05-30 14:34:33.876: E/Handler(14042):   at java.lang.reflect.Method.invokeNative(Native Method)
05-30 14:34:33.876: E/Handler(14042):   at java.lang.reflect.Method.invoke(Method.java:511)
05-30 14:34:33.876: E/Handler(14042):   at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:784)
05-30 14:34:33.876: E/Handler(14042):   at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:551)
05-30 14:34:33.876: E/Handler(14042):   at dalvik.system.NativeStart.main(Native Method) 
```

**我的代码::** **更新**

```
 final Dialog dialog = new Dialog(GetAllApp.this);
                    dialog.setContentView(R.layout.maindialog);
                    dialog.setTitle("This is my custom dialog box");
                    dialog.setCancelable(true);
                    //there are a lot of settings, for dialog, check them all out!

                    //set up text
                    final RadioButton rdoDialogopen = (RadioButton)dialog.findViewById(R.id.rdoDialogopen);
                    final RadioButton rdoDialogfav = (RadioButton)dialog.findViewById(R.id.rdoDialogfav);
                    final RadioButton rdoDialogopenNfav = (RadioButton)dialog.findViewById(R.id.rdoDialogopenNfav);

                rdoDialogopen.setOnClickListener(new View.OnClickListener() {
                    public void onClick(View v) {
                        if (rdoDialogopen.isChecked() == true) {
                            if(lstpinfo.get(position).pname !=null)
                            {
                            Intent i = new Intent(Intent.ACTION_MAIN);
                            PackageManager manager = getPackageManager();
                            i = manager.getLaunchIntentForPackage(lstpinfo
                                    .get(position).pname);
                            i.addCategory(Intent.CATEGORY_LAUNCHER);
                            startActivity(i);

                            }

                        }

                    }

                }); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-30T09:27:26.397

如果您从后台启动应用程序，则必须在您的 Intent 对象中设置`FLAG_ACTIVITY_NEW_TASK`和`FLAG_FROM_BACKGROUND`使用：`addFlags`

```
Intent intent25 = new Intent(Intent.ACTION_MAIN).addCategory(
Intent.CATEGORY_LAUNCHER).setClassName("_APP_PACKAGE_NAME",
"_APP_PACKAGE_NAME.ACTIVITY_NAME").addFlags(Intent.FLAG_ACTIVITY_NEW_TASK)
.addFlags(Intent.FLAG_FROM_BACKGROUND).setComponent(new ComponentName("APP_PACKAGE_NAME",
"APP_PACKAGE_NAME.ACTIVITY_NAME"));
getApplicationContext().startActivity(intent25); 
```

我在考虑你知道我们如何从中提取包名称和活动名称`PackageManager`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-30T11:36:29.963

我不知道你的问题是什么，你必须粘贴更多代码！

但是您必须查看[本](http://impressive-artworx.de/2011/list-all-installed-apps-in-style/)教程，因为它处理与您相同的问题

1.  在列表视图中列出手机上所有已安装的应用程序
2.  通过调用其启动意图来启动单击的应用程序

下载它附加的代码

# c - 链接到非线程静态库时，IPP 线程是否安全？

> ID：10813244
> 
> 赞同：1
> 
> 时间：2012-05-30T09:10:38.750
> 
> 标签：c, multithreading, thread-safety, intel-ipp

链接到非线程静态库时，IPP 线程是否安全？

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-09-17T06:51:05.073

IPP 不关心线程，因为它几乎没有需要保护的状态信息。

# php - 如何从网站获取包含关键字的 URL？

> ID：10813248
> 
> 赞同：-4
> 
> 时间：2012-05-30T09:10:51.287
> 
> 标签：php

如何从网站获取包含提供的关键字的 URL？

例如：我想捕获此页面 [http://www.catererglobal.com/rzwritingajobad.html](http://www.catererglobal.com/rzwritingajobad.html)
上 包含任何关键字（促销、工作）的所有锚点 href

预期结果包括：

[http://www.catererglobal.com/recruiters/rz-promote-your-brand](http://www.catererglobal.com/recruiters/rz-promote-your-brand) http://www.catererglobal.com/recruiters/rz-job-advertising

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-30T09:38:51.973

这就是我在 php 中的做法 =)

```
<?php
$oldSetting = libxml_use_internal_errors( true );
libxml_clear_errors();

$html = new DOMDocument();
$html->loadHtmlFile( 'http://www.catererglobal.com/rzwritingajobad.html' );
$xpath = new DOMXPath( $html );
$links = $xpath->query( '//a' );

foreach ( $links as $link ) {
    $cur = $link->getAttribute( 'href' );
    if (preg_match('/(promote|job)/', $cur)) { echo "$cur\n"; }
}

libxml_clear_errors();
libxml_use_internal_errors( $oldSetting );
?> 
```

输出是：

```
http://www.catererglobal.com/recruiters/rz-job-advertising/10298792/post-a-job/
/recruiters/rz-job-advertising
/recruiters/rz-promote-your-brand
/moreterms/job-location
http://www.madgex.com/job-boards/ 
```

Xpath 是我们最好的朋友 ;)

# c# - 在方法和调用者方法中维护变量值

> ID：10813249
> 
> 赞同：1
> 
> 时间：2012-05-30T09:10:52.003
> 
> 标签：c#, function, call

如何维护作为参数传递的调用函数中的变量值以调用函数？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-30T09:12:43.360

使用 ref 关键字，这将保留您的变量。

```
private void method()
{
    int a = 10;
    function(ref a);
}

private void function(ref int a)
{
    //do work and change value of a
} 
```

# ios - 在 iPhone 和 Windows Phone 7 上存储文件的安全性如何？

> ID：10813255
> 
> 赞同：0
> 
> 时间：2012-05-30T09:11:30.037
> 
> 标签：ios, security, windows-phone-7

在 Windows Phone 7 和 iPhone 上存储文件的安全性如何？

与在 Android 中一样，我们有一些文件浏览器实用程序，它显示存储在设备 SD 卡上的所有文件和文件夹，允许用户复制、移动、删除和执行其他短活动。

在 Windows Phone 7 和 iPhone 的情况下，似乎没有这样的文件浏览器实用程序，我猜这些系统的存储架构与不允许文件浏览的 Android 不同。

在我的 Android 案例中，我会加密文件并存储它以使其更安全。我也可以使用文件和文件夹属性。

对于 iPhone 和 Windows Phone 7 的情况，我需要加密文件并存储它吗？

或者

我可以在不应用加密的情况下放置文件，假设没有其他应用程序能够访问该文件，用户也不能这样做？

在这些设备上保护文件的其他替代方法是什么？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-30T09:17:04.457

你想向谁隐藏文件？手机的用户？

如果是这样，尤其是在 Android 上，用户将始终有一种访问文件的方法。

如果你想保护文件的内容，不要依赖操作系统隐藏它。这是个[坏主意](http://en.wikipedia.org/wiki/Security_through_obscurity)。

您列出的所有操作系统都提供加密作为其 API 的一部分。查看详细信息。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-30T10:51:00.250

在 Windows Phone 上，所有数据和应用程序都被沙盒化，因此它们无法相互访问或共享/访问彼此的数据。

安全显然是一个相对的东西。如果有人足够持久，他们将能够从设备上获取您的应用程序创建的文件，但这对大多数人来说并不是一项简单的任务。

如果您真的不希望其他人能够读取您的文件，那么您需要以加密格式存储它们，该格式使用未存储在代码或设备上的加密密钥。

**更新**
如果您想安全地加密设备上的数据，那么您需要记住，如果有人可以访问您保存的文件，他们也可以访问您的代码、反编译、阅读并自己运行它。
唯一真正的解决方法是让用户在每次运行应用程序时输入用户名和密码（重要：**您不得保存此密码**）。然后，这些凭据用于访问外部资源（Web 服务器），该资源使用这些凭据返回用于加密/解密 的密钥（您也**不能保存）。**

安全性是一种折衷方案，您需要权衡这种开销是否值得以及对于您要保护的数据的安全性是否必要。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-30T09:42:06.530

在 iPhone 上，您可以使用 Senuti 或 Phonedisk 等实用程序来浏览文件系统，许多甚至允许您将手机安装为磁盘并以这种方式浏览。许多 iOS 应用程序将其文件存储在应用程序支持或文档目录中，它们不受任何保护。

[http://www.macroplant.com/phonedisk/](http://www.macroplant.com/phonedisk/)

如果您不希望用户查看文件，唯一的选择是加密文件。查看 CommonCrypto 框架

# jquery - jQuery识别复选框值的问题？

> ID：10813257
> 
> 赞同：0
> 
> 时间：2012-05-30T09:11:31.650
> 
> 标签：jquery

我的 jQuery 代码有问题，因为某种原因它在我的情况下无法区分选中和未选中的复选框。它在第一个帐户上识别它们（即，如果它一开始未选中，它会识别它实际上未选中）。但是，如果您随后取消选中它，它仍然认为它未选中。

你可以在这里看到：http: [//jsfiddle.net/3BZp4/1/](http://jsfiddle.net/3BZp4/1/)

选中后，它将将该行复制到第二个表，但是当您取消选中同一行时，尽管选择器只要求未选中的行，它仍会复制到第二个表。

```
$('#one tbody tr td input.checkbox:not(:checked)').on('change', function (e)
{ }); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-30T09:18:42.740

看起来您已将函数绑定到当前未选中的所有输入框。该功能将始终绑定到这些复选框，无论其后的状态如何。您应该检查已检查状态作为绑定函数的一部分，这与代码悖论所做的非常相似。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-30T09:14:03.610

你可以尝试这样的事情：

```
$(':checkbox').on('change', function() {
  if(this.checked) {
     // do if checked
  } else {
    // do if not checked
  }
}); 
```

您的完整代码将：

```
$('#one tbody tr td input.checkbox').on('change', function(e) {
    if (this.checked) {
        var row = $(this).closest('tr').html();
        $('#two tbody').append('<tr>' + row + '</tr>');
    }
}); 
```

检查此**[演示](http://jsfiddle.net/7Yd6k/2/)**

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-30T09:24:38.050

**工作演示**这是你要找的东西吗[http://jsfiddle.net/gvDGS/2/](http://jsfiddle.net/gvDGS/2/)

API [http://api.jquery.com/not-selector/](http://api.jquery.com/not-selector/)

如果我错过了什么，请告诉我，希望这会有所帮助！

**代码**// 绑定到所有未选中但检查复选框是否选中。

```
$('input[type=checkbox]:not(:checked)').on('change', function() {

   if( $(this).is(':checked') ){
        var row = $(this).closest('tr').html();
        $('#two tbody').append('<tr>' + row + '</tr>');
    }
}); 
```

# objective-c - 在沙盒 OSX 应用程序中询问用户管理员密码

> ID：10813258
> 
> 赞同：6
> 
> 时间：2012-05-30T09:11:32.890
> 
> 标签：objective-c, macos, cocoa

我正在编写一个应用程序，我希望自定义首选项窗口在允许任何更改之前询问管理员密码（但从不存储它）。现在我一直在使用这个代码片段：

```
 OSStatus status;
    AuthorizationRef authorizationRef;

    // AuthorizationCreate and pass NULL as the initial
    // AuthorizationRights set so that the AuthorizationRef gets created
    // successfully, and then later call AuthorizationCopyRights to
    // determine or extend the allowable rights.
    // http://developer.apple.com/qa/qa2001/qa1172.html
    status = AuthorizationCreate(NULL, kAuthorizationEmptyEnvironment, kAuthorizationFlagDefaults, &authorizationRef);
    if (status != errAuthorizationSuccess)
    {
        NSLog(@"Error Creating Initial Authorization: %d", status);
        return status;
    }

    // kAuthorizationRightExecute == "system.privilege.admin"
    AuthorizationItem right = {kAuthorizationRightExecute, 0, NULL, 0};
    AuthorizationRights rights = {1, &right};
    AuthorizationFlags flags = kAuthorizationFlagDefaults | kAuthorizationFlagInteractionAllowed | kAuthorizationFlagPreAuthorize | kAuthorizationFlagExtendRights;

    // Call AuthorizationCopyRights to determine or extend the allowable rights.
    status = AuthorizationCopyRights(authorizationRef, &rights, NULL, flags, NULL);
    if (status != errAuthorizationSuccess)
    {
        NSLog(@"Copy Rights Unsuccessful: %d", status);
    }
    return status; 
```

效果很好，显示了一个标准的操作系统密码对话框，要求输入管理员密码。首选项 nib 中的各种控件根据返回的`status`. 但是，现在我正在尝试对应用程序进行沙箱处理，并且此代码始终返回`errAuthorizationDenied`. 我已经查看了文档`AuthorizationCopyRights`，`AuthorizationCreate`但我看不到在沙盒环境中使用它们的参考。

我尝试过各种不同的方法，`AuthorizationFlags flags`但结果总是一样的。有没有办法修改上述代码以在沙盒中工作，或者这些天要求管理员密码只是一个禁忌？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-05-30T09:52:01.570

我查看了沙盒文档，名为[确定您的应用程序是否适合沙](http://developer.apple.com/library/mac/documentation/Security/Conceptual/AppSandboxDesignGuide/DesigningYourSandbox/DesigningYourSandbox.html#//apple_ref/doc/uid/TP40011183-CH4-SW6)盒的部分立即回答了您的问题。

从文档

> 以下应用行为与应用沙盒不兼容：
> 
> *   使用授权服务

游戏结束。

事实上，我不确定你希望达到什么目标。为什么不让用户确定他们自己的应用程序自定义首选项？

# visual-studio - 项目属性中的 CUDA/C++ 选项卡

> ID：10813260
> 
> 赞同：2
> 
> 时间：2012-05-30T09:11:41.503
> 
> 标签：visual-studio, cuda

1 - 如何获得如图所示的CUDA选项卡

![在此处输入图像描述](../Images/af56a3ed10537b3b9db5008c0242f6f1.png)

2 - 当我将 .cu 文件添加到项目时，如何阻止 Visual Studio 以红色突出显示 CUDA 关键字，如下所示？

![在此处输入图像描述](../Images/f78802bb618561943624edfb638e879c.png)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-30T09:23:24.903

使用 Visual Studio 正确设置 CUDA 的最简单方法是在安装 CUDA 工具包时选择安装 Visual Studio 集成。然后一切都应该设置得很好。

但是，您可以通过复制 CUDA 工具包随附的规则和 MS Build Extensions 手动执行相同操作。您会在以下位置找到它们（取决于您的版本）

> %PATH_TO_NVIDIA_GPU_Computing_Toolkit%\CUDA\<版本>\extras\visual_studio_integration

在那里，您将找到适当的规则、构建扩展和注册表信息，包括有关如何设置的自述文件。

但就像我说的，在运行安装程序时选择集成的最简单方法。

如果您进行了设置，但仍然没有显示相关信息，请确保启用了构建自定义。您可以转到您的项目，右键单击它，然后转到`Build Customization`. 在那里，您可以为您的 CUDA 版本选择适当的目标。

![在此处输入图像描述](../Images/8f9e1e84b96367312be75dda1f7a8691.png)

# mysql - 加盟业绩

> ID：10813263
> 
> 赞同：1
> 
> 时间：2012-05-30T09:11:48.700
> 
> 标签：mysql, sql, performance

我正在尝试优化我的查询以使网站加载更快

```
SELECT ac.id as id, ac.first_name, ac.last_name, ac.email, ac.company_name, upd8r_twitter_accts.id as twitter, upd8r_facebook_accts.id as facebook 
FROM upd8r_user_accts ac  
LEFT OUTER JOIN upd8r_twitter_accts ON ac.id = upd8r_twitter_accts.user_id 
LEFT OUTER JOIN upd8r_facebook_accts ON ac.id = upd8r_facebook_accts.user_id 
WHERE ac.`rfid` = '' AND ac.last_name != '' AND ac.`owner_id` = '114' 
ORDER BY ac.`last_name` asc 
```

没有连接，查询在 0.0001 秒内运行，但有连接，它运行 0.3432 秒。

我该如何加快速度？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-30T09:16:18.433

```
SELECT  ac.id as id, ac.first_name, ac.last_name, ac.email, ac.company_name,
        (
        SELECT  id
        FROM    upd8r_twitter_accts
        WHERE   upd8r_twitter_accts.user_id = ac.id
        ORDER BY
                id
        LIMIT 1
        ) twitter,
        (
        SELECT  id
        FROM    upd8r_facebook_accts
        WHERE   upd8r_facebook_accts.user_id = ac.id
        ORDER BY
                id
        LIMIT 1
        ) facebook
FROM    upd8r_user_accts ac
WHERE   ac.`rfid` = ''
        AND ac.`owner_id` = '114'
        AND ac.last_name > ''
ORDER BY
        ac.`last_name` asc 
```

创建以下索引：

```
upd8r_user_accts (rfid, owner_id, last_name)
upd8r_twitter_accts (user_id, id)
upd8r_facebook_accts (user_id, id) 
```

# c# - access 2007 查询和 c# 数据表显示不同的输出

> ID：10813264
> 
> 赞同：2
> 
> 时间：2012-05-30T09:11:50.413
> 
> 标签：c#, ms-access-2007, oledb

我在 access 2007 中有以下查询，它使用 access 的 sql 设计视图给了我正确的结果。

```
 SELECT B1.LAYER_TYPE,
  B1.LAYER_NAME AS LAYER_NAME,
  B2.LAYER_NAME AS RELATED_LAYER_NAME,
  B3.LAYER_NAME AS RELATED_LAYER2_NAME,
  C.RULE_NAME
  FROM (((NCS_RULES_RELATIONS AS A
  LEFT JOIN NCS_LAYERS AS B1 ON A.LAYER_ID = B1.LAYER_ID)
  LEFT JOIN NCS_LAYERS AS B2 ON A.RELTD_LAYER_ID = B2.LAYER_ID)
  LEFT JOIN NCS_LAYERS AS B3 ON A.RELTD_LAYER2_ID = B3.LAYER_ID)
  LEFT JOIN NCS_RULES AS C ON A.RULE_ID = C.RULE_ID
  ORDER BY B1.LAYER_TYPE; 
```

结果如下：

![查询结果访问](../Images/572cddbf57016cadf869fc4ada8ed4ad.png)

但是当我尝试使用`c#`和`oledbconnection`访问将结果获取到数据表时，最后一行的 RULE_NAME 字段值显示奇怪的结果（见下图）。

![来自视觉工作室](../Images/b57d90494806beec11c526d0ee935856.png)

我的检索表代码如下：

```
public DataTable GetTable(string strSelectSQL)
        {
            if (this.con.State != ConnectionState.Open)
                con.Open();

            DataTable dt = new DataTable();
            DataSet ds = new DataSet();
            IDbCommand command = con.CreateCommand();
            command.CommandText = strSelectSQL;
            command.Connection = con;

            IDbDataAdapter da = factory.CreateDataAdapter();
            da.SelectCommand = command;
            da.Fill(ds);

            dt = ds.Tables[0];

            con.Close();
            return dt;

        } 
```

有人可以帮我解决这种奇怪的行为吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-30T09:17:32.127

似乎一切都很好。我猜你有这样的多行值`Rule_name field`：`AnnoFromLine\n\rDimOnLine`. 如您所见，Datagridview 显示多行值，而 sql 设计视图仅显示第一行。

# xml - Eclipse：如何格式化工作区中的所有 xml 文件？

> ID：10813265
> 
> 赞同：3
> 
> 时间：2012-05-30T09:11:53.553
> 
> 标签：xml, eclipse, formatting

我非常感谢 Eclipse 将代码格式化程序应用于工作区中的所有项目的功能，但是它仅适用于*Java*文件，我现在想将格式化程序应用于所有*XML*文件。还有一包：`pom's`，*Spring* configs等。

我发现没有可以为所有选定项目完成任务的内置格式。所以，我的问题，你知道一个可以完成任务的外部插件（可能有自己的可以导出/导入的格式设置）吗？或者我错过了现有的选项？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2015-06-02T21:37:24.527

这是我所做的：文件搜索所有文件名模式为 *.xml 的文件。在搜索结果中，全选，然后右键单击，来源 -> 格式。我在 Eclipse Luna 4.4.2 上，不确定这个功能有多远。

# java - 动态 jpql 返回集合但如何将其分配给数据表？

> ID：10813271
> 
> 赞同：0
> 
> 时间：2012-05-30T09:12:23.237
> 
> 标签：java, jsf, jakarta-ee, jpa, primefaces

我有一个动态jpql如下：

```
public Collection getOrderReportByUserName(String userName, Integer scripID, String orderStatus, String orderType) 
{     

    String strQuery = null;

        Collection<TradeStock> ts = em.createQuery("Select t from TradeStock t where t.userName.userName = :userName").setParameter("userName",userName).getResultList();
        if(ts.isEmpty())
        {
            strQuery = "Select o from OrderStock o where o.userName.userName = :userName ";
        }
        else
        {
            strQuery = "Select o,t from OrderStock o,TradeStock t where o.userName.userName = :userName and t.userName.userName = :userName";
        }   

    Collection c = em.createQuery(strQuery).setParameter("userName",userName).getResultList();
    return c;  
} 
```

豆代码：

```
public collection getOrderReport()
    {

        collOrder=  getOrderReportByUserName(uname,scripID,orderStatus,orderType);

    } 
```

xhtml:

```
<p:dataTable id="dt" var="order" widgetVar="scripTab" 
                     emptyMessage="No scrip found with given criteria" binding="#{stockOrderBean.dt}" 
                     value="#{stockOrderBean. collOrder}"
                 >

        <p:column>

            <f:facet name="header">
                Scrip Symbol
            </f:facet>
            <h:outputText value="#{order.get(0)}"/> ?? how to assign it?
        </p:column>...... 
```

在这里，当我调试它时，我发现“c”包含返回的集合，但现在如何将它分配给数据表？返回的集合包含 2 个表的对象——“tradeStock”和“orderStock”——那么如何在 primefaces 数据表中使用它？

**编辑：** 我想显示来自两个不同类的字段 - OrderStock 中的一些字段和 TradeStock 中的一些字段，它们由名为“OrderID”的公共字段连接。这可能吗？如果没有，那还有什么替代解决方案？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-30T09:27:51.687

[*注意：我推荐阅读一些 Java 开发的基础知识。您的代码中存在一些重大缺陷。*]

但至于你的具体问题：

如果你`getOrderReport()`在一个被调用的 bean 中有一个方法，`StockOrderBean`你必须在你的视图中引用它：

`#{stockOrderBean.orderReport}`

因此，您的表定义应如下所示：

```
<p:dataTable value="#{stockOrderBean.orderReport}" var="order"..> 
```

您需要确保您的列表包含相同类/超类的对象，而不是完全不同的对象才能使其工作。然后，如果您的类`Order`具有 getter 和 setter 的属性日期，您可以在表列中引用它：

```
 <h:outputText value="#{order.date}"/> 
```

# ios - 如果 UITableView scrollToRowAtIndexPath 只有一个项目，它不会滚动到第一行

> ID：10813280
> 
> 赞同：0
> 
> 时间：2012-05-30T09:12:53.803
> 
> 标签：ios, uitableview

我已经在 iPhone 上实现了一个 tableView，它可以使用 searchBar 进行搜索。我试图模仿第一次加载时在我的 tableView 中隐藏 searchBar 的效果。

当 tableView 包含多于一行时，该行为是预期的。但是，当只有一行时，它不会滚动到第一行。它显示了搜索栏。

```
- (void)viewDidLoad {
    [self.tableView scrollToRowAtIndexPath:[NSIndexPath indexPathForRow:0 inSection:0] 
                          atScrollPosition:UITableViewScrollPositionTop
                                  animated:NO];
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-30T10:10:47.473

实际上我不明白所有的事情（可能是错误的，当您将单元格添加到表格时 - 搜索栏在哪里，在什么单元格中？）但是您可以尝试

```
[self.tableView scrollRectToVisible:CGRectMake(0, yValue, 10, 10) animated:YES]; 
```

# c# - C#：如何在可滚动、可缩放的面板中绘制非常大的控件？

> ID：10813283
> 
> 赞同：1
> 
> 时间：2012-05-30T09:13:08.423
> 
> 标签：c#, .net, winforms, controls, panel

想象一个带有可能很宽的水平条的条形图。我在表单上有一个面板，我想在其中显示这些栏并滚动和缩放它们。可以调整窗体以及面板的大小。条形图是从数据库动态创建的。每次用户放大或缩小时，都必须重新创建所有条形以在面板上调整它们的大小。

我使用标签控件来创建这些条，但问题也适用于所有其他控件：如果我放大得足够远，我的条最终将超过控件大小的神奇 16 位边框（> 65536 像素）。这使得不可能在开始时简单地在面板上创建所有控件并让面板处理滚动。

我的想法：根据滚动条的当前位置和缩放级别，清除所有条形控件的面板并仅创建在当前视图窗口中可见的那些。远离可见视图的条将在面板外被剪短，因此它们的最大尺寸受面板尺寸的限制。

我的问题：

*   这个清除/创建过程最好在哪些小组活动中进行？可能有数千个控件，所以应该尽可能少。
*   有没有更好的方法来处理这个？也许我从一开始就搞错了。

这个问题不仅出现在巨大的控件中，而且在面板上较小的控件相距很远（> 65536像素）时也会出现，所以我认为一个好的解决方案可能对许多项目都有帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-30T12:00:48.707

我不想仅仅为了他们的点击事件而创建/销毁控件，或者隐藏/调整控件的大小。`UserControl`创建并覆盖`OnPaint`绘制条形图的方法并覆盖`OnClick`or`OnMouseXxx`事件非常容易。

由于您已经知道条在“虚拟空间”中的位置，因此很容易将鼠标光标的位置映射到条（或在条外单击）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-30T11:59:10.610

我知道你说 winforms 是强制性的，但我真的认为你应该查看 wpf 视图框。您可以在 winforms 中托管 wpf 元素。因此，其他所有内容都可以与表单相关，并且您有一个面板来托管和显示您的控件。我可以写一个简单的例子来向你展示这一点，但如果你不打算这样做，我真的不想浪费我的时间。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-30T12:30:06.083

您可以创建一个元文件（矢量图形），在图像控件中显示它，然后手动确定单击了哪个逻辑元素。

# php - JSON PHP 格式化 Jackson 解析 POJO

> ID：10813290
> 
> 赞同：1
> 
> 时间：2012-05-30T09:13:57.727
> 
> 标签：php, codeigniter, jackson, pojo

我正在将 CodeIgniter 用于一些小型 REST WS，并且无法获得正确（从杰克逊解析器的角度来看）格式化的 JSON 输出。为了让杰克逊做到这一点，输出需要类似于：

```
{ "recipes": 
    [ 
        {
            "name":"Recipe 1",
            "id":"8aecfd9b2fa26e83012fa298c2a50017",
            "recipe":"1 Lorem ipsum...",
        }, 
        { 
            "name":"Recipe 2",
            "id":"8aecfd9b2fa26e83012fa298c2a90018",
            "recipe":"2 Lorem ipsum...",
        },
        {
            "name": "Recipe 3",
            "id":"8aecfd9b2fa26e83012fa298c2ae0019",
            "recipe":"3 Lorem ipsum...",
        } 
    ]
} 
```

并使用 CodeIgniter 控制器中的代码，例如：

```
 $allEecipes['recipes'] = array(
                    array('name' => 'Recipe 1', 'id' => '8aecfd9b2fa26e83012fa298c2a50017', 'recipe' => '1 Lorem ipsum...'),
                    array('name' => 'Recipe 2', 'id' => '128aecfd9b226e83012fa298c2a50017', 'recipe' => '1 Lorem ipsum...'),
                    array('name' => 'Recipe 3', 'id' => '34ecfd9b2fa26e83012fa298c2a50017', 'recipe' => '1 Lorem ipsum...'),
        );      

        $this->response($allEecipes, 200); // 200 being the HTTP response code 
```

我得到以下 JSON 输出：

```
[
  [
    {
      "name": "Recipe 1",
      "id": "8aecfd9b2fa26e83012fa298c2a50017",
      "recipe": "1 Lorem ipsum..."
    },
    {
      "name": "Recipe 2",
      "id": "128aecfd9b226e83012fa298c2a50017",
      "recipe": "1 Lorem ipsum..."
    },
    {
      "name": "Recipe 3",
      "id": "34ecfd9b2fa26e83012fa298c2a50017",
      "recipe": "1 Lorem ipsum..."
    }
  ]
] 
```

请注意括号和缺少的数组名称。如何把事情做好？我想 PHP encode_to_json 正在正确地完成它的工作。

**编辑：** 在添加类之后仍然没有运气

```
class Eecipes
{
    public $recipes;

    public function __construct()
    {
    }
} 
```

并像创建它一样

```
 $allEecipes = new Eecipes();
    $allEecipes-> recipes = array(
        array('name' => 'Recipe 1', 'id' => '8aecfd9b2fa26e83012fa298c2a50017', 'recipe' => '1 Lorem ipsum...'),
        array('name' => 'Recipe 2', 'id' => '128aecfd9b226e83012fa298c2a50017', 'recipe' => '1 Lorem ipsum...'),
        array('name' => 'Recipe 3', 'id' => '34ecfd9b2fa26e83012fa298c2a50017', 'recipe' => '1 Lorem ipsum...'),
        );
$this->response($allEecipes, 200); 
```

我得到的输出是

```
{
  "recipes": {
    "0": {
      "name": "Recipe 1",
      "id": "8aecfd9b2fa26e83012fa298c2a50017",
      "recipe": "1 Lorem ipsum..."
    },
    "1": {
      "name": "Recipe 2",
      "id": "128aecfd9b226e83012fa298c2a50017",
      "recipe": "1 Lorem ipsum..."
    },
    "2": {
      "name": "Recipe 3",
      "id": "34ecfd9b2fa26e83012fa298c2a50017",
      "recipe": "1 Lorem ipsum..."
    }
  }
} 
```

所以，仍然没有必要。没有尖括号**[**，也不需要数字。在线 JSON 查看器中的结果也显示了差异

好的：http: [//img822.imageshack.us/img822/7034/goodj.jpg](http://img822.imageshack.us/img822/7034/goodj.jpg)

和坏的：http: [//img534.imageshack.us/img534/3389/badrk.jpg](http://img534.imageshack.us/img534/3389/badrk.jpg)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-30T09:18:19.243

[尝试使用json_encode](http://php.net/json_encode)自己对结果进行编码 ，然后发送结果？查看 json_encode 的 flag 选项，JSON_FORCE_OBJECT 可能对你有帮助

# asp.net-mvc-3 - ASP.NET MVC 3 依赖注入 - 控制器、视图和操作过滤器

> ID：10813291
> 
> 赞同：6
> 
> 时间：2012-05-30T09:14:01.083
> 
> 标签：asp.net-mvc-3, dependency-injection, unity-container

我正在尝试使用 Microsoft Unity 在 ASP.NET MVC 3 应用程序中使用依赖注入。首先，我实现了自己的 IDependencyResolver 并在我的 Global.asax 文件中激活它，如下所示：

```
DependencyResolver.SetResolver(new UnityDependencyResolver(container)); 
```

我发现我不需要做任何其他事情来让控制器注入（通过构造函数和 [Dependency] 属性）工作。使用默认视图引擎，我还发现我可以让 [Dependency] 属性在标准视图中工作，但不能在布局视图中工作。是否有可能让它也适用于布局视图？

但是我已经实现了我自己的视图引擎，它继承自 VirtualPathProviderViewEngine，它覆盖了 CreateView/CreatePartialView 方法并返回我自己的自定义视图（实现 IView）。见下面自定义视图的 Render 方法：

```
public void Render(ViewContext viewContext, TextWriter writer) {
    var webViewPage = DependencyResolver.Current.GetService(_type) as WebViewPage;
    //var webViewPage = Activator.CreateInstance(_type) as WebViewPage;

    if (webViewPage == null)
        throw new InvalidOperationException("Invalid view type");

    webViewPage.VirtualPath = _virtualPath;
    webViewPage.ViewContext = viewContext;
    webViewPage.ViewData = viewContext.ViewData;
    webViewPage.InitHelpers();

    WebPageRenderingBase startPage = null;

    if (_runViewStartPages)
        startPage = StartPage.GetStartPage(webViewPage, "_ViewStart", _viewStartFileExtensions);

    var pageContext = new WebPageContext(viewContext.HttpContext, webViewPage, null);
    webViewPage.ExecutePageHierarchy(pageContext, writer, startPage);
} 
```

使用注释掉的行，我在视图中完全失去了依赖注入，因此我将其更改为上面的行，该行再次适用于标准视图，但不适用于布局视图。如果您能告诉我如何修改上述内容以适用于布局视图，我将不胜感激？

最后，我试图让动作过滤器注入也能正常工作。我发现了两种不同的情况：

1.  通过属性将过滤器应用于操作。

2.  将其定义为全局过滤器，例如：

    GlobalFilters.Filters.Add(new TestAttribute());

似乎都没有使用依赖解析器。因此我需要做一些额外的工作。如果有更好的方法，请纠正我。为了启用第一个场景，我做了以下事情：

```
public class UnityFilterAttributeFilterProvider : FilterAttributeFilterProvider {
    private IUnityContainer _container;

    protected override IEnumerable<FilterAttribute> GetControllerAttributes(ControllerContext controllerContext, ActionDescriptor actionDescriptor) {
        var attributes = base.GetControllerAttributes(controllerContext, actionDescriptor);

        foreach (var attribute in attributes) {
            _container.BuildUp(attribute.GetType(), attribute);
        }

        return attributes;
    }

    protected override IEnumerable<FilterAttribute> GetActionAttributes(ControllerContext controllerContext, ActionDescriptor actionDescriptor) {
        var attributes = base.GetActionAttributes(controllerContext, actionDescriptor);

        foreach (var attribute in attributes) {
            _container.BuildUp(attribute.GetType(), attribute);
        }

        return attributes;
    }
} 
```

然后在我的 Global.asax 文件中定义它，如下所示：

```
FilterProviders.Providers.Remove(FilterProviders.Providers.Single(f => f is FilterAttributeFilterProvider));
FilterProviders.Providers.Add(new UnityFilterAttributeFilterProvider(container)); 
```

这工作正常，但我想知道这是否是正确的方法？为了解决第二种情况，我只是将我定义全局过滤器的位置更改为以下内容：

```
GlobalFilters.Filters.Add(DependencyResolver.Current.GetService<TestAttribute>()); 
```

现在这又可以工作了，但这是正确的方法吗？

我会很感激帮助。谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2021-11-12T00:21:07.143

我最初问这个已经有一段时间了，但我想我会分享我最终做了什么。

在我无法使用构造函数或属性注入的情况下，我使用`DependencyResolver`（服务定位器模式）解决了它。例如，如果我需要该服务`IService`，我会像这样简单地注入它：

```
public IService Service => DependencyResolver.Current.GetService<IService>(); 
```

虽然有些人可能认为这是一种反模式，但我发现它表现良好，导致问题更少，并且随着 C# 的新进展，我认为它看起来并不算太糟糕。

但是，如果您使用的是 ASP.NET Core，则永远不必使用服务定位器模式，因为它已通过依赖注入在其核心进行了重建。

# objective-c - iOS相机打开警告

> ID：10813293
> 
> 赞同：10
> 
> 时间：2012-05-30T09:14:04.203
> 
> 标签：objective-c, ios

我刚刚开始进行 iOS 开发，所以对于我的第一个项目，我正在开发一个简单的 iOS 应用程序来拍摄照片并将其显示在屏幕上。

这是我的代码，在第四行出现错误：

```
- (IBAction)takePicture:(id)sender {
    UIImagePickerController *imagePicker = [[UIImagePickerController alloc] init];
    imagePicker.sourceType =  UIImagePickerControllerSourceTypeCamera;
    imagePicker.delegate = self;
    [self presentModalViewController:imagePicker animated:YES];
} 
```

我收到以下警告：

```
 Assigning to 'id<UINavigationControllerDelegate,UIImagePickerControllerDelegate>' from incompatible type 'todd_learningViewController *const __strong' 
```

我不明白警告信息，也不知道如何摆脱警告。

谢谢，

编辑：

我的类头文件如下所示：

```
 @interface todd_learningViewController : UIViewController <UIApplicationDelegate>

  - (IBAction)takePicture:(id)sender;

  @property (weak, nonatomic) IBOutlet UIImageView *pictureView;

  @end 
```

我应该如何修改它？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-06-02T17:00:06.520

让你的班级实施`UINavigationControllerDelegate`，这个警告信息就会消失。此协议中的所有方法都是可选的，因此您不必修改您的实现类。

为什么我们必须这样做仍然是我试图弄清楚的事情，但现在这是解决方案。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-05-30T09:32:58.467

首先在类中实现下面的委托

```
<UIPickerViewDelegate,UIPickerViewDataSource>

@interface className : NSObject <UIApplicationDelegate,UIPickerViewDelegate,UIPickerViewDataSource> {

} 
```

**应该是这样的**

```
@interface todd_learningViewController : UIViewController <UIApplicationDelegate,UIPickerViewDelegate,UIPickerViewDataSource>{

    }

  - (IBAction)takePicture:(id)sender;

  @property (weak, nonatomic) IBOutlet UIImageView *pictureView;

  @end 
```

# mongodb - replSet 的 Mongo DB 问题

> ID：10813294
> 
> 赞同：5
> 
> 时间：2012-05-30T09:14:07.380
> 
> 标签：mongodb

我正在尝试这个：

> mongod --replSet mySet --dbpath /data/r1 --port 27017 --oplogSize 700
> 
> mongod --replSet mySet --dbpath /data/r2 --port 27018 --oplogSize 700
> 
> mongod --replSet mySet --dbpath /data/r3 --port 27019 --oplogSize 700

然后在新终端中：

```
/mongo --port 27017
MongoDB shell version: 2.0.2
connecting to: 127.0.0.1:27017/test 

> cfg = {

    _id : "mySet",
    members : [
    { _id : 0, host : "localhost:27017" },
    { _id : 1, host : "localhost:27018" },
    { _id : 2, host : "localhost:27019" } ] } 
```

当我跑步时

> rs.initiate(cfg)

我收到此错误：

> { "errmsg" : "服务器没有运行 --replSet", "ok" : 0 }

为什么我收到此错误？

来自日志文件：

```
Fri Jun 01 15:05:11 [initandlisten] MongoDB starting : pid=5236 port=27017 dbpath=c:\mongodb\data 64-bit host=mami
Fri Jun 01 15:05:11 [initandlisten] db version v2.0.4, pdfile version 4.5
Fri Jun 01 15:05:11 [initandlisten] git version: 329f3c47fe8136c03392c8f0e548506cb21f8ebf
Fri Jun 01 15:05:11 [initandlisten] build info: windows sys.getwindowsversion(major=6, minor=1, build=7601, platform=2, service_pack='Service Pack 1') BOOST_LIB_VERSION=1_42
Fri Jun 01 15:05:11 [initandlisten] options: { dbpath: "c:\mongodb\data", logappend: true, logpath: "c:\mongodb\logs\logfilename.log", service: true }
Fri Jun 01 15:05:11 [initandlisten] journal dir=c:/mongodb/data/journal
Fri Jun 01 15:05:11 [initandlisten] recover : no journal files present, no recovery needed
Fri Jun 01 15:05:12 [initandlisten] waiting for connections on port 27017
Fri Jun 01 15:05:12 [websvr] admin web console waiting for connections on port 28017
Fri Jun 01 15:05:12 [initandlisten] connection accepted from 127.0.0.1:49663 #1
Fri Jun 01 15:05:56 [conn1] end connection 127.0.0.1:49663
Fri Jun 01 15:06:02 [initandlisten] connection accepted from 127.0.0.1:49669 #2
Fri Jun 01 15:06:11 [clientcursormon] mem (MB) res:22 virt:67 mapped:0
Fri Jun 01 15:06:19 [conn2] terminating, shutdown command received
Fri Jun 01 15:06:19 dbexit: shutdown called
Fri Jun 01 15:06:19 [conn2] shutdown: going to close listening sockets...
Fri Jun 01 15:06:19 [conn2] closing listening socket: 488
Fri Jun 01 15:06:19 [conn2] closing listening socket: 492
Fri Jun 01 15:06:19 [conn2] shutdown: going to flush diaglog...
Fri Jun 01 15:06:19 [conn2] shutdown: going to close sockets...
Fri Jun 01 15:06:19 [conn2] shutdown: waiting for fs preallocator...
Fri Jun 01 15:06:19 [conn2] shutdown: lock for final commit...
Fri Jun 01 15:06:19 [conn2] shutdown: final commit...
Fri Jun 01 15:06:19 [conn2] shutdown: closing all files...
Fri Jun 01 15:06:19 [conn2] closeAllFiles() finished
Fri Jun 01 15:06:19 [conn2] journalCleanup...
Fri Jun 01 15:06:19 [conn2] removeJournalFiles
Fri Jun 01 15:06:19 [conn2] shutdown: removing fs lock...
Fri Jun 01 15:06:19 dbexit: really exiting now

***** SERVER RESTARTED *****

Fri Jun 01 15:06:19 [initandlisten] MongoDB starting : pid=6980 port=27017 dbpath=c:\mongodb\data 64-bit host=mami
Fri Jun 01 15:06:19 [initandlisten] db version v2.0.4, pdfile version 4.5
Fri Jun 01 15:06:19 [initandlisten] git version: 329f3c47fe8136c03392c8f0e548506cb21f8ebf
Fri Jun 01 15:06:19 [initandlisten] build info: windows sys.getwindowsversion(major=6, minor=1, build=7601, platform=2, service_pack='Service Pack 1') BOOST_LIB_VERSION=1_42
Fri Jun 01 15:06:19 [initandlisten] options: { dbpath: "c:\mongodb\data", logappend: true, logpath: "c:\mongodb\logs\logfilename.log", service: true }
Fri Jun 01 15:06:19 [initandlisten] journal dir=c:/mongodb/data/journal
Fri Jun 01 15:06:19 [initandlisten] recover : no journal files present, no recovery needed
Fri Jun 01 15:06:19 [initandlisten] waiting for connections on port 27017
Fri Jun 01 15:06:20 [websvr] admin web console waiting for connections on port 28017
Fri Jun 01 15:06:20 [initandlisten] connection accepted from 127.0.0.1:49678 #1
Fri Jun 01 15:06:22 [conn1] end connection 127.0.0.1:49678
Fri Jun 01 15:06:30 [initandlisten] connection accepted from 127.0.0.1:49679 #2
Fri Jun 01 15:06:36 [conn2] terminating, shutdown command received
Fri Jun 01 15:06:36 dbexit: shutdown called
Fri Jun 01 15:06:36 [conn2] shutdown: going to close listening sockets...
Fri Jun 01 15:06:36 [conn2] closing listening socket: 488
Fri Jun 01 15:06:36 [conn2] closing listening socket: 492
Fri Jun 01 15:06:36 [conn2] shutdown: going to flush diaglog...
Fri Jun 01 15:06:36 [conn2] shutdown: going to close sockets...
Fri Jun 01 15:06:36 [conn2] shutdown: waiting for fs preallocator...
Fri Jun 01 15:06:36 [conn2] shutdown: lock for final commit...
Fri Jun 01 15:06:36 [conn2] shutdown: final commit...
Fri Jun 01 15:06:36 [conn2] shutdown: closing all files...
Fri Jun 01 15:06:36 [conn2] closeAllFiles() finished
Fri Jun 01 15:06:36 [conn2] journalCleanup...
Fri Jun 01 15:06:37 [conn2] removeJournalFiles
Fri Jun 01 15:06:37 [conn2] shutdown: removing fs lock...
Fri Jun 01 15:06:37 dbexit: really exiting now

***** SERVER RESTARTED *****

Fri Jun 01 15:06:37 [initandlisten] MongoDB starting : pid=7076 port=27017 dbpath=c:\mongodb\data 64-bit host=mami
Fri Jun 01 15:06:37 [initandlisten] db version v2.0.4, pdfile version 4.5
Fri Jun 01 15:06:37 [initandlisten] git version: 329f3c47fe8136c03392c8f0e548506cb21f8ebf
Fri Jun 01 15:06:37 [initandlisten] build info: windows sys.getwindowsversion(major=6, minor=1, build=7601, platform=2, service_pack='Service Pack 1') BOOST_LIB_VERSION=1_42
Fri Jun 01 15:06:37 [initandlisten] options: { dbpath: "c:\mongodb\data", logappend: true, logpath: "c:\mongodb\logs\logfilename.log", service: true }
Fri Jun 01 15:06:37 [initandlisten] journal dir=c:/mongodb/data/journal
Fri Jun 01 15:06:37 [initandlisten] recover : no journal files present, no recovery needed
Fri Jun 01 15:06:37 [initandlisten] waiting for connections on port 27017
Fri Jun 01 15:06:37 [websvr] admin web console waiting for connections on port 28017
Fri Jun 01 15:06:37 [initandlisten] connection accepted from 127.0.0.1:49680 #1
Fri Jun 01 15:06:39 [conn1] end connection 127.0.0.1:49680
Fri Jun 01 15:07:37 [clientcursormon] mem (MB) res:22 virt:66 mapped:0
Fri Jun 01 15:53:55 [clientcursormon] mem (MB) res:0 virt:64 mapped:0
Fri Jun 01 15:58:55 [clientcursormon] mem (MB) res:1 virt:64 mapped:0
Fri Jun 01 15:59:24 [initandlisten] connection accepted from 127.0.0.1:50087 #2
Fri Jun 01 15:59:55 [clientcursormon] mem (MB) res:2 virt:65 mapped:0
Fri Jun 01 16:04:55 [clientcursormon] mem (MB) res:2 virt:65 mapped:0
Fri Jun 01 16:06:07 [conn2] replSet replSetInitiate admin command received from client 
```

我已经尝试过本教程[replSet](http://www.mongodb.org/display/DOCS/Replica+Set+Tutorial)但仍然没有

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-05-30T10:13:44.030

`--replSet`我能想到的一个原因是，在您尝试启动它之前，您已经在端口 27017 上运行了一个没有参数的 mongod 。`ps aux |grep mongod`在你尝试这个之前，确保没有 mongod 正在运行 ( )。我还会检查日志文件，因为它很可能提供了一个线索，为什么它没有以副本集模式启动。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-10-16T18:44:50.933

我发现一个简单的解决方案是为 --replSet 指定一个子参数。

我将我的 Mongo 服务器配置为只有一个节点的 ReplicaSet，因为它充当 PRYMARY，不会有另一个节点来读取目的。

这是运行 mongod 服务时帮助我的原因。

> /> sudo mongod --replSet myReplSet

一旦我使用 mongo 登录，提示就会改变，然后我可以正确配置 rs：

> /myReplSet:PRIMARY> cfg = { _id : "mySet", 成员: [ { _id : 0, 主机: "localhost:27017" } ] }
> 
> /myReplSet:PRIMARY> rs.initiate(cfg)

这就是诀窍！

我希望这可以帮助别人。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-05-06T10:22:41.130

我注意到它的 linux 权限问题，如上面建议的帖子。要修复它，您需要为数据目录命令设置权限，因为它是`sudo chown -R $USER /data`. 我对 npm 有同样的问题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-09-17T16:17:19.890

有同样的问题，所以在我的情况下，系统中还有一个 mongod 进程正在运行（当然，它`--replSet`在默认端口上没有标志运行，这就是我出现此错误的原因）。

运行命令：

```
$ ps aux | grep mongod 
```

就我而言，它输出：

```
root 63434 0.3 0.1 2621328 12228 ?? S 5:53PM 0:03.44 mongod --replSet m101 --logpath 1.log --dbpath /data/rs1 --port 27017 --smallfiles --oplogSize 64 --fork

root 63442 0.2 0.1 2622352 12220 ?? S 5:54PM 0:03.37 mongod --replSet m101 --logpath 2.log --dbpath /data/rs2 --port 27018 --smallfiles --oplogSize 64 --fork

root 63448 0.2 0.1 2621312 12208 ?? S 5:54PM 0:03.35 mongod --replSet m101 --logpath 3.log --dbpath /data/rs3 --port 27019 --smallfiles --oplogSize 64 --fork

pavlo 683 0.0 0.0 3082276 6628 ?? S 31Aug14 11:27.70 /usr/local/opt/mongodb/bin/mongod --config /usr/local/etc/mongod.conf

pavlo 63522 0.0 0.0 2432784 624 s002 S+ 6:06PM 0:00.00 grep mongod 
```

所以带有 id 的进程`683`正在进行中，所以在我杀死它之后一切正常：

```
$ kill 683 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-07-24T11:58:24.613

我设法解决了这个问题。

1.  我首先删除了mongodb：sudo apt-get remove mongodb

2.  [我遵循了 MongoDB 教程：](http://docs.mongodb.org/manual/tutorial/install-mongodb-on-ubuntu/)

3.  但是，在步骤之后...： sudo apt-get update

4.  ...我决定重新安装 mongodb：sudo apt-get remove mongodb（在这一步我可能指定了 'mongodb-server'）。

而且，神奇的是，replSet 名称能够从 mongodb.conf 加载。我被留给 rs.initiate() - 就是这样。

注意：我从 2.4.9 开始并以相同的 2.4.9 结束 - 只是工作。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-01-02T16:20:09.877

我在做我的 mongodb 复制和分片作业时遇到了完全相同的问题。在运行以下命令之后：

```
./mongod --replSet m101 --logpath "1.log" --dbpath /data/rs1 --port 27017 --smallfiles --oplogSize 64 --fork 
```

然后进行`ps aux | grep mongo`检查，我意识到实际上没有运行任何东西。我所做的只是将这些命令作为系统根运行，所以最后我运行 mongod 进程，如：

```
sudo ./mongod --replSet m101 --logpath "1.log" --dbpath /data/rs1 --port 27017 --smallfiles --oplogSize 64 --fork 
```

就是这样！:)

希望能帮助到你。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2015-07-06T10:21:20.310

是的，在我的 ubuntu 15.04 上也是如此。并通过解决端口解决了它。此外，检查日志，以便执行状态让我们知道它是如何工作的。

# eclipse - m2e 生命周期映射：委派插件执行

> ID：10813300
> 
> 赞同：3
> 
> 时间：2012-05-30T09:14:18.367
> 
> 标签：eclipse, maven, m2e

根据[m2e 维基](http://wiki.eclipse.org/M2E_plugin_execution_not_covered)：

> m2e 使用插件 groupId、artifactId、版本范围和目标的组合将插件执行与操作相匹配。可以指示 m2e 执行插件执行三个基本操作——忽略、执行和委托给项目配置器。

此外，我可以阅读以忽略我需要做的插件：

```
<pluginExecution>
   <pluginExecutionFilter>
      <groupId>org.bsc.maven</groupId>
      <artifactId>maven-processor-plugin</artifactId>
      <versionRange>[2.0.5,)</versionRange>
      <goals>
         <goal>process</goal>
      </goals>
   </pluginExecutionFilter>
   <action>
      <delegate />
   </action>
</pluginExecution> 
```

因此，为了委派执行，我应该做同样的事情，但这样做似乎是合乎逻辑的：

```
<action>
     <delegate />
</action> 
```

但它不起作用。我收到以下错误：

`No enum constant org.eclipse.m2e.core.lifecyclemapping.model.PluginExecutionAction.delegate`

那么委托插件执行的方法是什么？我应该省略`pluginExecution`要委托的插件的元素吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-30T12:27:20.193

关于[M2E 兼容的 maven 插件](http://wiki.eclipse.org/M2E_compatible_maven_plugins)。只有

```
1\. <ignore/> mapping 
2\. <execute/> mapping 
```

没有提到代表的标签。

如果我理解正确，这是一个默认配置，没有任何必需的配置。它只是让 Eclipse M2E/M2E 扩展来决定。请注意，对我来说，我正在使用来自 JBoss 的“***用于 Eclipse WTP 的 m2e 项目配置器***”来处理 Web 项目。您可能需要使用一些与您的要求相匹配的 M2E 扩展。

我总是使用忽略来管理自定义资源并且它可以正常工作。

更新：

在 Eclipse 中，请点击菜单***Windows ---> preferences --> Maven ---> Discovery***。然后单击“***打开目录***”按钮。系统将为您提供一个扩展列表（m2e 连接器）以供安装。比如有*Android连接器、antlr、AspectJ*等。我希望可能会有一个扩展来帮助你实现这个要求。

# asp.net-mvc - 如何从 asp.net webservice 以 JSON 形式返回多个对象

> ID：10813302
> 
> 赞同：0
> 
> 时间：2012-05-30T09:14:27.103
> 
> 标签：asp.net-mvc, vb.net, web-services

我有以下代码返回一个单对象 JSON 数组，

```
Imports System.ServiceModel
Imports System.ServiceModel.Activation
Imports System.ServiceModel.Web
Imports System.IO
Imports System.Runtime.Serialization.Json
Imports System.Runtime.Serialization

<ServiceContract(Namespace:="")> _
<AspNetCompatibilityRequirements(RequirementsMode:=AspNetCompatibilityRequirementsMode.Allowed)> _
Public Class MessageService
    <OperationContract()> _
    Public Function GetMessage(Id As Integer) As String
        Dim m As New NewMessage()
        m.Id = 1
        m.Text = "Text test"

        Dim stream As New MemoryStream()
        Dim serializer As New DataContractJsonSerializer(GetType(NewMessage))
        serializer.WriteObject(stream, m)

        serializer.WriteObject(stream, m)

        stream.Position = 0
        Dim streamReader As New StreamReader(stream)
        Return streamReader.ReadToEnd()
    End Function
End Class

<DataContract()> _
Public Class NewMessage
    <DataMember()> _
    Public Id As Integer
    <DataMember()> _
    Public Text As String
End Class 
```

返回的数据是：

```
{id:1,Text:"TText test"} 
```

如何让它返回：

```
[{id:1,Text:"Text 1"},{id:2,Text:"Text 2"}] 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-30T09:28:54.887

您必须返回类 NewMessage 的数组，或者如果您想返回单个对象，则创建一个具有 NewMessage 数组属性的类并返回该类。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-30T15:25:58.310

让它返回

```
[{id:1,Text:"Text 1"},{id:2,Text:"Text 2"}] 
```

您必须改为将 NewMessage 更改为 List< NewMessage >。DataContractJsonSerializer 将处理其余部分。

# render - MissingTemplate : 在 Rails 3.2.3 中渲染部分

> ID：10813307
> 
> 赞同：2
> 
> 时间：2012-05-30T09:14:39.880
> 
> 标签：render, ruby-on-rails-3.2, actionview, partials, missing-template

嗨，我是 Ruby on Rails 的新手，我正在在线关注 Michael Hartl 的书。在他的[书](http://ruby.railstutorial.org/chapters/filling-in-the-layout#code%3alayout_with_partials)的部分部分。他用来渲染部分的代码是

```
<%= 渲染'布局/样式表' %>
```

但我得到这个[错误](http://geekpics.net/images/2012/05/30/Bq1bs.png)。

我阅读了 API 并尝试了这个

```
<%=render :partial => "/layouts/stylesheets" %>
```

但仍然无法弄清楚这一点。

感谢所有的帮助！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-30T10:27:37.693

在您看来，请确保您具有以下结构：

```
- views
  - layouts
    - application.html.erb
    - _stylesheets.html.erb 
```

您的代码应该是：

```
<%= render 'layouts/stylesheets' %> 
```

如果您的主模板位于 layouts 文件夹中：

```
<%= render 'stylesheets' %> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-30T18:09:28.610

我忽略了文件名。当我最初创建文件时，在 .erb 扩展名之后，我不小心在后面放了一个空格。

# magento - Magento，在带有 sales_flat_quote_item_option 表的自定义模块中升级 1.7 查询失败

> ID：10813310
> 
> 赞同：1
> 
> 时间：2012-05-30T09:14:46.230
> 
> 标签：magento

我在 Magento 中编写了一个自定义模块，它在 sales_flat_quote_item_option 表中添加了一行。我使用 addOption 方法和一个数组作为 quote_item 对象的参数。然后我运行 $quoteItem->save();

使用 Magento 1.4 版，一切都像魅力一样工作。我试图将 Magento 升级到 1.7 版本，但我的模块似乎不再工作了。

在尝试调试之后，我认为 sales_flat_quote_item_option 中的插入查询根本没有启动（根据查询日志文件）。

所以我写了一个简单的查询来插入数据，我的模块现在正在工作。

也许有人已经面临这种问题？我需要尽可能干净。

让我分享失败的代码：

```
public function assignDocumentToQuoteItem(Mage_Sales_Model_Quote_Item $quoteItem, $documentid)
    {

        if(is_numeric($documentid) && $documentid > 0)
        {
            /** @var Mage_Catalog_Model_Product */
            $product = $quoteItem->getProduct();

            $quoteItem->addOption(array(
                        'product_id' => $product->getId(),
                        'product' => $product,
                        'code' => 'documentid',
                        'value' => $documentid));
            $quoteItem->save();
            return true;
        }

        throw new Exception(__METHOD__.' - Document id has to be a numeric value.');

    } 
```

Magento 1.4 可以正常工作，但 1.7 不行，这里有什么想法吗？

非常感谢 ！

# objective-c - 将触摸区域添加到 UIView (iOS5)

> ID：10813312
> 
> 赞同：0
> 
> 时间：2012-05-30T09:15:02.163
> 
> 标签：objective-c, ios, xcode, uiview, uiviewcontroller

我有一个带有 MainViewController 的 MainView。现在我想添加一个我想注册触摸的特定区域（在特定区域绘画）。我怎么能这样做？我想过添加一个带有自己的子视图控制器的子视图，但是[这个家伙](http://blog.carbonfive.com/2011/03/09/abusing-uiviewcontrollers/)告诉这不是一个好方法。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-30T09:20:55.257

您链接到的帖子部分已过时，因为它是在 Apple在 iOS 5 中引入对[View Controller Containment的支持之前编写的。](http://developer.apple.com/library/ios/releasenotes/General/WhatsNewIniPhoneOS/Articles/iOS5.html#//apple_ref/doc/uid/TP30915195-SW16)

也就是说，您可以选择是否：

1.  子视图由其自己的视图控制器管理或

2.  您使用`MainViewController`直接响应子视图中的触摸或

3.  你创建了一个`UIView`子类，它在没有视图控制器的帮助下解释自己的触摸。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-30T09:21:37.997

添加一个自定义视图作为属性，称为 touchArea

```
-(void) touchesBegan/Moved/Ended (NSSet *)touches withEvent:(UIEvent *)event {

CGPoint location = [[touches anyObject] locationInView:self.view];

if (CGRectContainsPoint(touchArea.frame, location))
//code
}

} 
```

# c++ - opencv中的Kmean聚类

> ID：10813314
> 
> 赞同：0
> 
> 时间：2012-05-30T09:15:16.017
> 
> 标签：c++, opencv

基本上，我有两个玩家位置点，我想将来自 Vec2f 的玩家位置聚集在一起。

我尝试了这个代码示例，但它不起作用，并且在调用 kmeans 函数时它给出了一个异常。

```
float *pointsdata = new float[10];

    for (std::map< unsigned int, Player >::iterator it = players.begin(); it != players.end(); ++it)
    {
       for (int i =0; i< players.size(); i++)
       {
           pointsdata[i] = it->second.m_Position.x; 
           pointsdata[i+1] = it->second.m_Position.y; 

       }
    }

    //float pointsdata[] = { 1,1, 2,2, 6,6, 5,5, 10,10};
    cv::Mat points(10, 2, CV_32F, *pointsdata);
    cv::Mat labels, centers;

    cv::kmeans(points, 3, labels, cv::TermCriteria(CV_TERMCRIT_EPS, 1000, 0), 1000, cv::KMEANS_RANDOM_CENTERS, centers);

    cout << "labels: " << labels << endl;
    cout << "centers " << centers << endl; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-30T09:34:24.223

You have the cv::Mat API [here](http://www710.univ-lyon1.fr/~eguillou/documentation/opencv2/classcv_1_1_mat.html). The constructor you're trying to use is the following, right?

```
Mat (int _rows, int _cols, int _type, void *_data, size_t _step=AUTO_STEP)
constructor for matrix headers pointing to user-allocated data 
```

So you should probably do the following:

```
if(players.size() > 10)
{
    cout << "ERROR, too many players\n";
    // Do some error handling here
    return;
}

//float pointsdata[10][2]; // use this if it doesnt need to be dynamic
/* 2D definition, but we need to create it as a 1D array with room for the 2d
float **pointsdata = new float*[10];
for(int i = 0; i < 10; ++i)
{
    pointsdata[i] = new float[2];
}
*/
float *pointsdata = new float[10*2];

for (std::map< unsigned int, Player >::iterator it = players.begin();
     it != players.end();
     ++it)
{
    for (int i =0; i< players.size() && i < 10; i++)
    {
         pointsdata[i] = it->second.m_Position.x; 
         pointsdata[i + 10*i] = it->second.m_Position.y; 
    }
}

cv::Mat points(10, 2, CV_32F, pointsdata); 
```

# java - 鼠标拖动时Java / Swing JViewport跳来跳去

> ID：10813327
> 
> 赞同：0
> 
> 时间：2012-05-30T09:15:59.933
> 
> 标签：java, swing, mouseevent, jscrollpane

我试图将[http://java-swing-tips.blogspot.co.uk/2008/06/mouse-drag-auto-scrolling.html](http://java-swing-tips.blogspot.co.uk/2008/06/mouse-drag-auto-scrolling.html)集成到我的程序中，但它似乎行为不端，我不确定发生了什么。

gameGrid 标签实际上是一个带有单击事件的单独类，这就是为什么我让鼠标侦听器尝试调用父 mouseListeners（以前网格 mouseListeners 覆盖了可滚动视口 mouseListeners，因此它不会拖动），但是 JPanel 与一些形状显示相同的行为。

```
package uk.co.mhayward.games.factions;

import java.awt.BasicStroke;
import java.awt.BorderLayout;
import java.awt.Color;
import java.awt.Cursor;
import java.awt.Dimension;
import java.awt.Graphics;
import java.awt.Graphics2D;
import java.awt.HeadlessException;
import java.awt.Point;
import java.awt.Polygon;
import java.awt.Rectangle;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;
import java.awt.event.HierarchyEvent;
import java.awt.event.HierarchyListener;
import java.awt.event.MouseAdapter;
import java.awt.event.MouseEvent;
import java.awt.event.MouseListener;
import java.awt.event.MouseMotionListener;

import javax.swing.JComponent;
import javax.swing.JFrame;
import javax.swing.JPanel;
import javax.swing.JScrollPane;
import javax.swing.JTextArea;
import javax.swing.JViewport;

public class WhyYouJump extends JFrame {

    public static void main(String[] args) {
        new WhyYouJump();
    }

    private static final long serialVersionUID = 3697837493691218641L;

    private final JPanel gameGridPanel;

    private final JScrollPane gridScrollPane;

    private final JViewport gridScrollPaneViewport;

    private final JTextArea jTextArea = new JTextArea();

    public WhyYouJump() throws HeadlessException {
        super();

        gameGridPanel = new JPanel() {
            @Override
            public void paint(Graphics g) {
                super.paint(g);
                Graphics2D g2d = (Graphics2D) g;

                Polygon shape1 = new Polygon();
                Polygon shape2 = new Polygon();
                Polygon shape3 = new Polygon();

                for (int i = 0; i < 6; i++) {
                    shape1.addPoint((int) (200 + 50 * Math.cos(i * 2 * Math.PI / 6)),
                            (int) (200 + 50 * Math.sin(i * 2 * Math.PI / 6)));
                    shape2.addPoint((int) (400 + 50 * Math.cos(i * 2 * Math.PI / 6)),
                            (int) (200 + 50 * Math.sin(i * 2 * Math.PI / 6)));
                    shape3.addPoint((int) (100 + 50 * Math.cos(i * 2 * Math.PI / 6)),
                            (int) (100 + 50 * Math.sin(i * 2 * Math.PI / 6)));
                }

                g2d.setStroke(new BasicStroke(3));
                g2d.setPaint(Color.WHITE);
                g2d.fill(shape1);
                g2d.fill(shape2);
                g2d.fill(shape3);
                g2d.setPaint(Color.BLACK);
                g2d.draw(shape1);
                g2d.draw(shape2);
                g2d.draw(shape3);
            }
        };

        gameGridPanel.setPreferredSize(new Dimension(1440, 900));
        gameGridPanel.setSize(new Dimension(1440, 900));

        gridScrollPane = new JScrollPane(gameGridPanel);

        gameGridPanel.addMouseListener(new MouseAdapter() {
            @Override
            public void mousePressed(MouseEvent e) {
                for (MouseListener l : gameGridPanel.getParent().getMouseListeners()) {
                    e.setSource(gridScrollPaneViewport);
                    l.mousePressed(e);
                }
                jTextArea.append(e.getPoint().toString() + "\n");
            }

            @Override
            public void mouseReleased(MouseEvent e) {
                for (MouseListener l : gameGridPanel.getParent().getMouseListeners()) {
                    e.setSource(gridScrollPaneViewport);
                    l.mouseReleased(e);
                }
            }

            @Override
            public void mouseExited(MouseEvent e) {
                for (MouseListener l : gameGridPanel.getParent().getMouseListeners()) {
                    e.setSource(gridScrollPaneViewport);
                    l.mouseExited(e);
                }
            }
        });

        gameGridPanel.addMouseMotionListener(new MouseAdapter() {
            @Override
            public void mouseDragged(MouseEvent e) {
                for (MouseMotionListener l : gameGridPanel.getParent().getMouseMotionListeners()) {
                    e.setSource(gridScrollPaneViewport);
                    l.mouseDragged(e);
                }
            }
        });

        gameGridPanel.addHierarchyListener(new HierarchyListener() {

            public void hierarchyChanged(HierarchyEvent e) {
                for (HierarchyListener l : gameGridPanel.getParent().getHierarchyListeners()) {
                    e.setSource(gridScrollPaneViewport);
                    l.hierarchyChanged(e);
                }
            }
        });

        this.setLayout(new BorderLayout());
        this.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);

        gridScrollPane.setPreferredSize(new Dimension(500, 300));
        gridScrollPane.getVerticalScrollBar().setUnitIncrement(16);

        ViewportDragScrollListener l = new ViewportDragScrollListener(gameGridPanel, false);
        gridScrollPaneViewport = gridScrollPane.getViewport();
        gridScrollPaneViewport.addMouseMotionListener(l);
        gridScrollPaneViewport.addMouseListener(l);
        gridScrollPaneViewport.addHierarchyListener(l);

        this.add("Center", gridScrollPane);

        JScrollPane textScrollPane = new JScrollPane(jTextArea);
        textScrollPane.setPreferredSize(new Dimension(140, 180));
        this.add("South", textScrollPane);

        this.pack();
        this.setLocation(100, 100);
        this.setVisible(true);
    }

    class ViewportDragScrollListener extends MouseAdapter implements HierarchyListener {
        private static final int SPEED = 4;
        private static final int DELAY = 10;
        private final Cursor dc;
        private final Cursor hc = Cursor.getPredefinedCursor(Cursor.HAND_CURSOR);
        private final javax.swing.Timer scroller;
        private final JComponent label;
        private final Point startPt = new Point();
        private final Point move = new Point();
        private boolean autoScroll = false;

        public ViewportDragScrollListener(JComponent comp, boolean autoScroll) {
            this.label = comp;
            this.autoScroll = autoScroll;
            this.dc = comp.getCursor();
            this.scroller = new javax.swing.Timer(DELAY, new ActionListener() {
                public void actionPerformed(ActionEvent e) {
                    JViewport vport = (JViewport) label.getParent();
                    Point vp = vport.getViewPosition();
                    vp.translate(move.x, move.y);
                    label.scrollRectToVisible(new Rectangle(vp, vport.getSize()));
                }
            });
        }

        public void hierarchyChanged(HierarchyEvent e) {
            JComponent c = (JComponent) e.getSource();
            if ((e.getChangeFlags() & HierarchyEvent.DISPLAYABILITY_CHANGED) != 0 && !c.isDisplayable() && autoScroll) {
                scroller.stop();
            }
        }

        @Override
        public void mouseDragged(MouseEvent e) {
            JViewport vport = (JViewport) e.getSource();
            Point pt = e.getPoint();
            int dx = startPt.x - pt.x;
            int dy = startPt.y - pt.y;
            Point vp = vport.getViewPosition();
            vp.translate(dx, dy);
            label.scrollRectToVisible(new Rectangle(vp, vport.getSize()));
            move.setLocation(SPEED * dx, SPEED * dy);
            startPt.setLocation(pt);
        }

        @Override
        public void mousePressed(MouseEvent e) {
            ((JComponent) e.getSource()).setCursor(hc); //label.setCursor(hc);
            startPt.setLocation(e.getPoint());
            move.setLocation(0, 0);
            if (autoScroll) {
                scroller.stop();
            }
        }

        @Override
        public void mouseReleased(MouseEvent e) {
            ((JComponent) e.getSource()).setCursor(dc); //label.setCursor(dc);
            if (autoScroll) {
                scroller.start();
            }
        }

        @Override
        public void mouseExited(MouseEvent e) {
            ((JComponent) e.getSource()).setCursor(dc); //label.setCursor(dc);
            move.setLocation(0, 0);
            if (autoScroll) {
                scroller.stop();
            }
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-30T11:09:41.647

一种方法，使用 SwingUtilities.convertMouseEvent(gamePanel,mouseEvent,viewport): （编辑：正如 Guillaume Polet 已经说过的）

```
MouseAdapter convertMouseEventListener = new MouseAdapter() {
  private void dispatchEvent(MouseEvent e) {
    JComponent c = (JComponent)e.getComponent();
    JComponent p = (JComponent)e.getComponent().getParent();
    p.dispatchEvent(SwingUtilities.convertMouseEvent(c,e,p));
  }
  @Override public void mouseDragged(MouseEvent e)  { dispatchEvent(e); }
  @Override public void mouseClicked(MouseEvent e)  { dispatchEvent(e); }
  @Override public void mouseEntered(MouseEvent e)  { dispatchEvent(e); }
  @Override public void mouseExited(MouseEvent e)   { dispatchEvent(e); }
  @Override public void mousePressed(MouseEvent e)  {
    jTextArea.append(e.getPoint().toString() + "\n");
    dispatchEvent(e);
  }
  @Override public void mouseReleased(MouseEvent e) { dispatchEvent(e); }
};
gameGridPanel.addMouseMotionListener(convertMouseEventListener);
gameGridPanel.addMouseListener(convertMouseEventListener); 
```

另外，如果 gameGridPanel 有自己的 MouseListener，我建议使用 ComponentDragScrollListener 而不是 ViewportDragScrollListener：

```
ComponentDragScrollListener l = new ComponentDragScrollListener(gameGridPanel);
gameGridPanel.addMouseMotionListener(l);
gameGridPanel.addMouseListener(l);
gameGridPanel.addHierarchyListener(l); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-30T09:51:58.443

我不确定这到底在做什么，但我至少可以发现一件事：`mousePressed` `mouseReleased`并且`mouseExited`永远不会在您的课程中被调用，`ViewportDragScrollListener`因为您不转发事件。看了这篇文章后，他们没有使用这种技术，我认为这也可能是您问题的一部分。

考虑直接在正确的组件上添加鼠标侦听器，而不是像您那样转发事件。

编辑：

当你转发事件时，你修改了源，但点仍然在原来的组件坐标中。考虑使用以下代码创建一个新事件：

```
e = SwingUtilities.convertMouseEvent((Component) e.getSource(), e, gridScrollPaneViewport); 
```

# internet-explorer - dijit.form.TextBox 在单击按钮时添加字符串，基于最后的选择

> ID：10813328
> 
> 赞同：0
> 
> 时间：2012-05-30T09:16:09.363
> 
> 标签：internet-explorer, textbox, dojo, cursor-position, dijit.form

即使在 dijit.form.TextBox 中失去焦点后如何保持光标位置？我的表单中有文本框和按钮。当我单击按钮时，我希望将一些文本添加到该文本框中我保留的特定光标位置。

我想要完全一样的东西：http: [//jsfiddle.net/NE4Ev/6/](http://jsfiddle.net/NE4Ev/6/) 但这在 Internet Explorer 中不起作用。有人可以帮忙吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-30T10:42:39.763

监听 TextBox 的`onblur`事件以保存光标位置：

```
textBox.on("blur", function() {
    var start = this.textbox.selectionStart,
        end = this.textbox.selectionEnd;
    this.set("cursorPosition", [start, end]);
}); 
```

`textBox.focus()`当通过调用以编程方式将焦点返回到文本框时，例如当用户单击按钮时，您可以使用该位置在光标位置插入一些文本并恢复光标位置：

```
textBox.on("focus", function() {
    var cursorPosition = this.get("cursorPosition");
    if(cursorPosition) {            
        this.textbox.setSelectionRange(cursorPosition[0], cursorPosition[1]);                                          
    }
}); 
```

请参阅 jsFiddle 的工作示例：http: [//jsfiddle.net/phusick/rryEg/](http://jsfiddle.net/phusick/rryEg/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-30T12:05:47.187

我已经通过 phusick 修改了答案以满足您的需求。

但是，一旦您了解了小部件上的 cusron 选择，这里就真的没什么可做的了。

**HTML：**

```
<input
    id="textBox1"
    data-dojo-type="dijit.form.TextBox"
    value="some text here"/>

<button id="button1" data-dojo-type="dijit.form.Button">foo</button> 
```

**JavaScript：**

```
require([
    "dojo/ready",
    "dijit/registry",
    "dijit/form/TextBox",
    "dijit/form/Button",
    "dojo/domReady!"
], function(
    ready,
    registry
) {

    ready(function() {

        var textBox = registry.byId("textBox1"),
            button = registry.byId("button1");        

        textBox.on("blur", function() {
            var start = this.textbox.selectionStart,
                end = this.textbox.selectionEnd;
            this.curStart = start;
            this.curEnd = end;
        });

        textBox.on("focus", function() {
            var cursorPosition = [this.curStart,this.curEnd];
            if(cursorPosition) {            
                this.textbox.setSelectionRange(cursorPosition[1], cursorPosition[1]);                                          
            }
        });

        button.on("click", function() {
            var cur = [textBox.curStart,textBox.curEnd];
         var val = textBox.get("value");
            var str = val.substring(0,cur[0])+ 'foo' + val.substring(cur[1]);
            textBox.set("value", str);
            textBox.focus();
            textBox.textbox.setSelectionRange(cur[0]+'foo'.length, cur[0]+'foo'.length);
        });

    });

}); 
```

这是小提琴链接：

[http://jsfiddle.net/NE4Ev/6/](http://jsfiddle.net/NE4Ev/6/)

# c# - 在 c# 中访问另一个类的非静态构造函数中的静态属性

> ID：10813330
> 
> 赞同：-8
> 
> 时间：2012-05-30T09:16:12.537
> 
> 标签：c#

我试图在另一个类的非静态构造函数中访问普通类（ClassA.StaticPropertyXX）的静态属性。ClassA 是普通类。

它工作正常。我需要知道它是否正确。请告诉我。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-30T09:20:22.987

没有什么能阻止你这样做。您将在这些类之间建立耦合。对 ClassA 的更改可能会影响（甚至破坏）其他类。所以如果可以的话，你应该避免它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-30T09:21:50.297

您可能会遇到的情况：

*   您没有`using`命名空间的声明，因此`ClassA`不可用。这可以通过添加`using`语句或指定完整的命名空间来解决。
*   该名称`ClassA`与另一个名称冲突。这可以通过在`using`语句中为命名空间创建别名来解决。
*   静态属性不是`public`。

只要您有权访问该`ClassA`类型，就可以访问其中的公共静态属性。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-30T09:22:37.740

代替：

```
class MyClass
{
    private int _value;

    public MyClass()
    {
        _value = OtherClass.StaticInt;
    }
} 
```

赞成：

```
class MyClass
{
    private int _value;

    public MyClass(int valueForConstruction)
    {
        _value = valueForConstruction;
    }
} 
```

与解耦`MyClass`，`OtherClass`即使您这样做：

```
MyClass c = new MyClass(OtherClass.StaticInt); 
```

# signalr - SignalR 生成 HttpParseException..??

> ID：10813339
> 
> 赞同：0
> 
> 时间：2012-05-30T09:17:03.427
> 
> 标签：signalr

我正在使用 SignalR 为我在 Win2003 和 IIS6 上运行的站点构建简单的聊天。部署此功能几分钟后，IIS6 会自动禁用所有服务。

系统恐慌……？我使用的版本是 SignalR 0.3。这种情况的详细日志文件：

*事件代码：3006 事件消息：发生解析器错误。事件时间：2012 年 5 月 30 日下午 3:22:47 事件时间 (UTC)：2012 年 5 月 30 日上午 8:22:47 事件 ID：fa5b58f6de4f4de2a07d915049cb7e89 事件顺序：5 事件发生：1 事件详细代码：0*

应用信息：应用域：/LM/W3SVC/788149765/Root-1-129828397662128750 信任等级：完整应用虚拟路径：/应用路径：E:\Code\PLW\WebGame\机器名：SVCTAG-J7KG62S

进程信息：进程 ID：6728 进程名称：w3wp.exe 帐户名称：NT AUTHORITY\NETWORK SERVICE

异常信息：异常类型：HttpParseException 异常消息：无法创建类型“RealTimeChat.MyTest”。在 System.Web.UI.SimpleWebHandlerParser.GetType(String typeName) 在 System.Web.UI.SimpleWebHandlerParser.GetTypeToCache(Assembly builtAssembly) 在 System.Web.Compilation.SimpleHandlerBuildProvider.GetGeneratedType(CompilerResults results) 在 System.Web.Compilation.BuildProvider .CreateBuildResult(CompilerResults results) at System.Web.Compilation.BuildProvider.GetBuildResult(CompilerResults results) at System.Web.Compilation.BuildManager.CompileWebFile(VirtualPath virtualPath) at System.Web.Compilation.BuildManager.GetVPathBuildResultInternal(VirtualPath virtualPath, Boolean noBuild , 布尔allowCrossApp, 布尔allowBuildInPrecompile, 布尔throwIfNotFound,

请求信息： 请求URL：[http](http://haaanjsc.vn/MyTest.ashx) ://haaanjsc.vn/MyTest.ashx 请求路径：/MyTest.ashx 用户主机地址：210.211.97.164 用户：已
认证：False 认证类型：
线程账号名：NT AUTHORITY\NETWORK SERVICE

线程信息：线程 ID：1 线程帐户名称：NT AUTHORITY\NETWORK SERVICE 正在模拟：False 堆栈跟踪：在 System.Web.UI.SimpleWebHandlerParser.GetType(String typeName) 在 System.Web.UI.SimpleWebHandlerParser.GetTypeToCache(Assembly builtAssembly ) 在 System.Web.Compilation.SimpleHandlerBuildProvider.GetGeneratedType(CompilerResults results) 在 System.Web.Compilation.BuildProvider.CreateBuildResult(CompilerResults results) 在 System.Web.Compilation.BuildProvider.GetBuildResult(CompilerResults results) 在 System.Web.Compilation。 BuildManager.CompileWebFile(VirtualPath virtualPath) at System.Web.Compilation.BuildManager.GetVPathBuildResultInternal(VirtualPath virtualPath, Boolean noBuild, Boolean allowCrossApp, Boolean allowBuildInPrecompile, Boolean throwIfNotFound,Boolean ensureIsUpToDate) 在 System.Web.Compilation.BuildManager.GetVPathBuildResultWithNoAssert(HttpContext context, VirtualPath virtualPath, Boolean noBuild, Boolean allowCrossApp, Boolean allowBuildInPrecompile, Boolean throwIfNotFound, Boolean ensureIsUpToDate) 在 System.Web.Compilation.BuildManager.GetVPathBuildResult(HttpContext context, VirtualPath在 System.Web.UI.SimpleHandlerFactory.System.Web.IHttpHandlerFactory2.GetHandler(HttpContext context, String requestType, VirtualPath virtualPath, String physicalPath) 在 System.Web.HttpApplication. System.Web.HttpApplication.MapHandlerExecutionStep 处的 MapHttpHandler（HttpContext 上下文、字符串 requestType、VirtualPath 路径、String pathTranslated、Boolean useAppConfig）。System.Web.HttpApplication.IExecutionStep.Execute() 在 System.Web.HttpApplication.ExecuteStep（IExecutionStep 步骤，布尔值&完成同步）

自定义活动详情：

*[有关详细信息，请参阅http://go.microsoft.com/fwlink/events.asp](http://go.microsoft.com/fwlink/events.asp)上的帮助和支持中心。*

有人可以帮我吗

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-08T16:28:48.583

我在该堆栈跟踪中的任何地方都看不到 SignalR。看起来你还有另一个问题。

# ruby-on-rails - 如何显示“访问的最新页面”列表

> ID：10813342
> 
> 赞同：5
> 
> 时间：2012-05-30T09:17:05.953
> 
> 标签：ruby-on-rails

在 Rails 中，如何显示当前用户访问的最近 5 个页面的列表？

我知道我可以做 redirect_to(request.referer) 或 redirect_to(:back) 链接到最后一页，但我如何创建一个实际的页面历史列表？

它主要用于原型，因此我们不必将历史记录存储在数据库中。会话会做。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-05-30T09:33:34.537

你可以在你的 application_controller 中放这样的东西：

```
class ApplicationController < ActionController::Base
  before_filter :store_history

private

  def store_history
    session[:history] ||= []
    session[:history].delete_at(0) if session[:history].size >= 5
    session[:history] << request.url
  end
end 
```

现在它存储最近访问的五个 url

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-05-30T09:31:36.113

```
class ApplicationController < ActionController::Base
  after_action :set_latest_pages_visited

  def set_latest_pages_visited
      return unless request.get?
      return if request.xhr?

      session[:latest_pages_visited] ||= []
      session[:latest_pages_visited] << request.path_parameters
      session[:latest_pages_visited].delete_at 0 if session[:latest_pages_visited].size == 6
  end
.... 
```

后来你可以做

```
 redirect_to session[:latest_pages_visited].last 
```

# python - 有条件地设置python变量

> ID：10813344
> 
> 赞同：0
> 
> 时间：2012-05-30T09:17:16.767
> 
> 标签：python, variables

我想根据另一个变量设置一个变量。在我的情况下，var1 可以是“mean”、“sum”或“max”（从 gui 解析的输入）。基于这些字符串，我想（有条件地）设置另一个变量；比如：如果 var1 是“平均值”那么 var2 = 2，如果 var1 = “sum”那么 var2=4，如果 var1 = “max”那么 var2 = 6。

最好的方法是什么（对于初学者）？如果我在 if else 过程中使用它，我需要使变量成为全局变量以在 if 之外使用它们？有推荐的程序吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-30T09:19:58.383

使用字典：

```
d = {'mean': 2,
     'sum': 4,
     'max': 6}
var2 = d.get(var1) 
```

如果`var1`不包含在 中`d`，`var2`将默认为`None`。如果你想要另一个默认值：

```
var2 = d.get(var1, 0) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-30T09:20:33.113

用字典怎么样？

```
mapping = {'mean': 2
         , 'sum' : 4
         , 'max' : 6
          }
var1 = 'mean'
var2 = mapping[var1]
# or
var2 = mapping.get(var1) # To avoid KeyErrors 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-30T09:25:26.507

由于 python 没有内置的 switch-case 语句，一个 pythonic 的方法是使用一个 dict：

```
>>> d = {'mean': 2, 'sum': 4, 'max': 6}
>>> var1 = "max"
>>> var2 = d[var1]
>>> var2
6 
```

您不再需要考虑变量的范围（尽管考虑它是个好问题！）。

# java - 通过 JNI 传递、返回和转换为列表的向量列表

> ID：10813346
> 
> 赞同：27
> 
> 时间：2012-05-30T09:17:36.360
> 
> 标签：java, c++, list, java-native-interface, stdvector

我需要通过 Java

```
List< List<MyPoint> > points; 
```

通过 jni 到 C++ 并转换为

```
std::vector< std::vector<MyPoint> > 
```

处理这个向量并返回

```
List< List<MyPoint> > 
```

1.  如何正确传递列表和返回列表？
2.  如何在对象向量的向量中和向后转换对象列表列表？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-06-07T05:02:37.973

我用标准工具解决了这个问题。

1.  在 Java 类中创建为对象 (O) 容器 (C)
2.  将对象数组 (O) 从 Java 代码传递到本机部分
3.  在 C++ 代码中从数组向量创建
4.  计算新向量
5.  构建容器数组 (C) 并插入对象 (O)
6.  返回容器数组 (C)

**代码实现：**

在java部分：

*1 - 从点列表创建数组*

在 c++ 部分：

*2 - 构建输入向量*

```
std::vector<CurvePoint> src_line;

jclass java_points_cls = env->FindClass("myPointClass");
jmethodID java_mid = env->GetMethodID(java_points_cls, "<init>", "(II)V");    
jfieldID fidX = env->GetFieldID(java_points_cls, "x", "I");
jfieldID fidY = env->GetFieldID(java_points_cls, "y", "I");

int srcCount = env->GetArrayLength(srcLines);

for (int i=0; i < srcCount; i++) 
{
    jobject cur_pnt =  env->GetObjectArrayElement(srcLines, i); 

    LinePoint src_point;        

    src_point.x = env->GetIntField(cur_pnt, fidX); 
    src_point.y = env->GetIntField(cur_pnt, fidY);    

    src_line.push_back(src_point);
} 
```

*3 - 计算`lines`*

*4 - 构建输出数组*

```
jclass java_line_cls = env->FindClass("myLinesClass");

jmethodID java_line_add = env->GetMethodID(java_line_cls, "addPoint", "(II)V");  
jmethodID java_line_init = env->GetMethodID(java_line_cls, "<init>", "()V");

jobjectArray resLines = (jobjectArray) env->NewObjectArray(lines.size(),     java_line_cls, 0); 

for(int i = 0; i < lines.size(); ++i)
{
    jobject cur_line =  env->NewObject(java_line_cls, java_line_init);
    for(int j = 0; j < lines[i].size(); ++j)
        env->CallVoidMethod(cur_line, java_line_add, 
                                lines[i][j].x,
                                lines[i][j].y);
    env->SetObjectArrayElement(resLines, i, cur_line);
}

return resLines; 
```

Java部分

*5 - 从返回的数组创建行列表*

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2014-05-01T03:37:39.637

```
JNIEXPORT jobjectArray JNICALL Java_ProcessInformation_getAllProcessPid  (JNIEnv*env,jobject obj) {

    vector<string>vec;

    vec.push_back("Ranjan.B.M");

    vec.push_back("Mithun.V");

    vec.push_back("Preetham.S.N");

    vec.push_back("Karthik.S.G");

    cout<<vec[0];

    cout<<vec[0];

    jclass clazz = (env)->FindClass("java/lang/String");

    jobjectArray objarray = (env)->NewObjectArray(vec.size() ,clazz ,0);

    for(int i = 0; i < vec.size(); i++) {

        string s = vec[i]; 

         cout<<vec[i]<<endl;

         jstring js = (env)->NewStringUTF(s.c_str());

        (env)->SetObjectArrayElement(objarray , i , js);

    }

    return objarray;    

} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-02T10:02:48.933

正如我从参考 JNI 中理解的那样，JNI 只能处理原始类型或对象的一维数组。

因为在Java方面，不得不将列表翻译成数组。然后，在本机部分传递的数组和元素的数量。将转到所需的向量并进行处理。返回两个数组（包含所有轮廓点的数组和包含每个轮廓中的点数的数组）和轮廓数的结果。结果数组收集在 Java 一侧的列表列表中。

虽然问题没有完全解决，因为 JNI 无法为 native 部分中的现有项分配内存。因此需要将部分数据提取出来，在Java端为它们分配内存，并填入native。

一个可能的解决方案可能是使用 SWIG 或 JavaCpp 之类的活页夹

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-05T00:40:06.440

你也可以使用这个[项目](https://code.google.com/p/android-cpp-sdk/)。它将允许像使用原生类一样使用 JNI 下的 java 类。

# c++ - FTDI：无法打开端口 C++

> ID：10813348
> 
> 赞同：3
> 
> 时间：2012-05-30T09:17:47.947
> 
> 标签：c++, visual-c++, windows-7, usb, serial-port

我目前正在使用 FTDI FT232R 将 USB 线转换为串行线（特别是 RS485）。我的程序在 WIndows 7（64 位）下运行，并在 Visual C++ 2010 中编译。我正在使用 FTDI 库，其指南可在此链接中找到

[http://www.ftdichip.com/Support/Documents/ProgramGuides/D2XX_Programmer's_Guide(FT_000071).pdf](http://www.ftdichip.com/Support/Documents/ProgramGuides/D2XX_Programmer%27s_Guide%28FT_000071%29.pdf)

如果我“正常”启动它（只需双击图标），该程序可以在某些 PC（不是全部）上运行，而如果我使用“以管理员身份运行”它不适用于我可以测试的任何 PC（总是Windows 7的）。所有驱动程序都已更新到最新版本（2.8.24.0），特别是我遇到的错误是：FT_INVALID_HANDLE 有人可以帮帮我吗？谢谢乔治

# javascript - 将 couchdb 持久性添加到节点中的 socketio json 提要

> ID：10813356
> 
> 赞同：0
> 
> 时间：2012-05-30T09:18:30.163
> 
> 标签：javascript, json, node.js, couchdb

我目前正在研究如何将持久性添加到节点中的实时 twitter json 提要。我已经设置了流，它正在向客户端广播，但是我如何将这些数据存储在诸如 couchdb 之类的 json 数据库中，以便在客户端第一次访问页面时访问存储 json？

我似乎无法理解couchdb。

```
var array = { 
    "tweet_id": tweet.id,
    "screen_name": tweet.user.screen_name,
    "text" : tweet.text, 
    "profile_image_url" : tweet.user.profile_image_url 
};

db.saveDoc('tweet', strencode(array), function(er, ok) {
    if (er) throw new Error(JSON.stringify(er));
    util.puts('Saved my first doc to the couch!');
});

db.allDocs(function(er, doc) {
    if (er) throw new Error(JSON.stringify(er));
    //client.send(JSON.stringify(doc));
    console.log(JSON.stringify(doc));
    util.puts('Fetched my new doc from couch:');
}); 
```

这是我用来尝试保存/检索推文数据的两个片段。该数组是一条单独的推文，每次收到新推文时都需要保存到沙发上。

我不理解 saveDoc 的 id 部分——当我使它唯一时，**db.allDocs**只列出 ID 而不是数据库中每个文档的内容——当它不是唯一的时，它在第一个 db 条目后失败。

有人可以解释将这种类型的json数据保存和检索到couchdb的正确方法吗？我基本上想在客户端第一次查看页面时加载整个数据库。（数据库将少于 100 个条目）

干杯。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-30T11:18:50.253

*   您需要在数据库中插入文档。您可以通过插入来自 twitter API 的 JSON 来做到这一点，也可以一次插入一个状态 ( `for loop`)
*   您应该创建一个公开该信息的视图。如果您直接从 Twitter 保存 JSON，您将需要`emit`在地图函数中多次保存
*   那里的操作（摄取和查询）不是一回事，因此您应该在程序的不同时间真正执行它们。
*   您应该考虑运行一个更新数据库的 bg 进程（可能像 a 一样简单`setInterval`）。或者您可以使用`clarinet`(http://github.com/dscape/clarinet) 之类的东西直接解析 Twitter 流 API。

我是[nano](http://github.com/dscape/nano)的作者，这里是满足您大部分需求的测试之一：

*   [https://github.com/dscape/nano/blob/master/tests/view/query.js](https://github.com/dscape/nano/blob/master/tests/view/query.js)

对于实际的查询语义和您了解 CouchDB 如何工作的更多信息，我建议您阅读：

*   [http://guide.couchdb.org/editions/1/en/index.html](http://guide.couchdb.org/editions/1/en/index.html)

我觉得它很有用，我建议你买这本书：）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-30T10:42:50.473

如果您想使用模块与 CouchDB 交互，我建议您使用[cradle](https://github.com/cloudhead/cradle)或[nano](https://github.com/dscape/nano)。

您还可以使用在 Node.js 中找到的默认 http 模块向 CouchDB 发出请求。缺点是默认的 http 模块往往有点冗长。有一些替代方案可以为您提供更好的 API 来处理 http 请求。这个[要求](https://github.com/mikeal/request)真的很受欢迎。

要获取数据，您需要向视图发出 GET 请求，您可以[在此处](http://guide.couchdb.org/editions/1/en/views.html)找到更多信息。如果要创建文档，则必须对数据库使用 PUT 请求。

# android - 使用 Intent 从 FTP 服务器下载文本文件。

> ID：10813357
> 
> 赞同：0
> 
> 时间：2012-05-30T09:18:33.187
> 
> 标签：android, android-intent, ftp

我正在使用 ftp 连接从服务器下载文本文件。但不幸的是我得到了例外：

```
android.content.ActivityNotFoundException: No Activity found to handle Intent { act=android.intent.action.PICK dat=64.78.178.19 typ=vnd.android.cursor.dir/lysesoft.andftp.uri (has extras) } 
```

我也在 manifest.xml 中定义了活动。

下面是我的*清单文件*

```
<?xml version="1.0" encoding="utf-8"?>
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
package="com.saltriver.hourdoc"
android:versionCode="1"
android:versionName="1.0" >

<uses-sdk android:minSdkVersion="8" />
<uses-permission android:name="android.permission.WRITE_EXTERNAL_STORAGE"/>
<uses-permission android:name="android.permission.INTERNET"/>

<application android:icon="@drawable/ic_launcher" android:label="@string/app_name">
    <activity android:name=".HourdocActivity"
              android:label="@string/app_name">
        <intent-filter>
            <action android:name="android.intent.action.MAIN" />
            <category android:name="android.intent.category.LAUNCHER" />
        </intent-filter>
    </activity>

</application> 
```

*下载文本文件的代码。*

```
public void onCreate(Bundle savedInstanceState) 
{
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);

   Button downloadFilesButton = (Button) findViewById(R.id.button_download_files_id);
    downloadFilesButton.setOnClickListener(new View.OnClickListener()
    {
  public void onClick(View v) 
  {
    Intent intent = new Intent();
    intent.setAction(Intent.ACTION_PICK);
    // FTP URL (Starts with ftp://, sftp://, ftps:// or scp:// followed by hostname and port).
    Uri ftpUri = Uri.parse(ConstantCodes.ftphost);
    intent.setDataAndType(ftpUri, ConstantCodes.ftpuri);
    // Download
    intent.putExtra("command_type", "download");
    // FTP credentials (optional)
    intent.putExtra("ftp_username", ConstantCodes.userid);
    intent.putExtra("ftp_password", ConstantCodes.pwd);
    //intent.putExtra("ftp_keyfile", "/sdcard/dsakey.txt");
    //intent.putExtra("ftp_keypass", "optionalkeypassword");
    // FTP settings (optional)
    intent.putExtra("ftp_pasv", "true");
    //intent.putExtra("ftp_resume", "true");
    //intent.putExtra("ftp_encoding", "UTF-8");
    //intent.putExtra("ftps_mode", "implicit");
    // Activity title
    intent.putExtra("progress_title", "Downloading files ...");
    // Remote files to download.
    intent.putExtra("remote_file1",  ConstantCodes.ftp_remotefile1);
    //intent.putExtra("remote_file2", "/remotefolder/subfolder/file2.zip");
    // Target local folder where files will be downloaded.
    intent.putExtra("local_folder",  ConstantCodes.localfolder_path);  
    intent.putExtra("close_ui", "true");  
    startActivityForResult(intent,ConstantCodes.DOWNLOAD_FILES_REQUEST);
  }
    });
}

protected void onActivityResult(int requestCode, int resultCode, Intent intent) 
 {
Log.i(TAG, "Result: "+resultCode+ " from request: "+requestCode);
if (intent != null)
{
  String transferredBytesStr = intent.getStringExtra("TRANSFERSIZE");
  String transferTimeStr = intent.getStringExtra("TRANSFERTIME");
  Log.i(TAG, "Transfer status: " + intent.getStringExtra("TRANSFERSTATUS"));
  Log.i(TAG, "Transfer amount: " + intent.getStringExtra("TRANSFERAMOUNT") + " file(s)");
  Log.i(TAG, "Transfer size: " + transferredBytesStr + " bytes");
  Log.i(TAG, "Transfer time: " + transferTimeStr + " milliseconds");
  // Compute transfer rate.
  if ((transferredBytesStr != null) && (transferTimeStr != null))
  {
    try
    {
      long transferredBytes = Long.parseLong(transferredBytesStr);
      long transferTime = Long.parseLong(transferTimeStr);
      double transferRate = 0.0;
      if (transferTime > 0) transferRate = ((transferredBytes) * 1000.0) / (transferTime * 1024.0);
      Log.i(TAG, "Transfer rate: " + transferRate + " KB/s");
    } 
    catch (NumberFormatException e)
    {
       // Cannot parse string.
     }
   }
 }
} 
```

建议我在哪里做错了。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-30T11:06:00.003

我给你找到了一些东西。检查这个[GoogleCode](http://code.google.com/p/hassanpurcom/source/checkout)示例项目。它非常适合我。他们正在用下面的类实现下载功能

**下载线程.java**

```
public class DownloaderThread extends Thread
{
    // constants
    private static final int DOWNLOAD_BUFFER_SIZE = 4096;

    // instance variables
    private AndroidFileDownloader parentActivity;
    private String downloadUrl;

    /**
     * Instantiates a new DownloaderThread object.
     * @param parentActivity Reference to AndroidFileDownloader activity.
     * @param inUrl String representing the URL of the file to be downloaded.
     */
    public DownloaderThread(AndroidFileDownloader inParentActivity, String inUrl)
    {
        downloadUrl = "";
        if(inUrl != null)
        {
            downloadUrl = inUrl;
        }
        parentActivity = inParentActivity;
    }

    /**
     * Connects to the URL of the file, begins the download, and notifies the
     * AndroidFileDownloader activity of changes in state. Writes the file to
     * the root of the SD card.
     */
    @Override
    public void run()
    {
        URL url;
        URLConnection conn;
        int fileSize, lastSlash;
        String fileName;
        BufferedInputStream inStream;
        BufferedOutputStream outStream;
        File outFile;
        FileOutputStream fileStream;
        Message msg;

        // we're going to connect now
        msg = Message.obtain(parentActivity.activityHandler,
                AndroidFileDownloader.MESSAGE_CONNECTING_STARTED,
                0, 0, downloadUrl);
        parentActivity.activityHandler.sendMessage(msg);

        try
        {
            url = new URL(downloadUrl);
            conn = url.openConnection();
            conn.setUseCaches(false);
            fileSize = conn.getContentLength();

            // get the filename
            lastSlash = url.toString().lastIndexOf('/');
            fileName = "file.bin";
            if(lastSlash >=0)
            {
                fileName = url.toString().substring(lastSlash + 1);
            }
            if(fileName.equals(""))
            {
                fileName = "file.bin";
            }

            // notify download start
            int fileSizeInKB = fileSize / 1024;
            msg = Message.obtain(parentActivity.activityHandler,
                    AndroidFileDownloader.MESSAGE_DOWNLOAD_STARTED,
                    fileSizeInKB, 0, fileName);
            parentActivity.activityHandler.sendMessage(msg);

            // start download
            inStream = new BufferedInputStream(conn.getInputStream());
            outFile = new File(Environment.getExternalStorageDirectory() + "/" + fileName);
            fileStream = new FileOutputStream(outFile);
            outStream = new BufferedOutputStream(fileStream, DOWNLOAD_BUFFER_SIZE);
            byte[] data = new byte[DOWNLOAD_BUFFER_SIZE];
            int bytesRead = 0, totalRead = 0;
            while(!isInterrupted() && (bytesRead = inStream.read(data, 0, data.length)) >= 0)
            {
                outStream.write(data, 0, bytesRead);

                // update progress bar
                totalRead += bytesRead;
                int totalReadInKB = totalRead / 1024;
                msg = Message.obtain(parentActivity.activityHandler,
                        AndroidFileDownloader.MESSAGE_UPDATE_PROGRESS_BAR,
                        totalReadInKB, 0);
                parentActivity.activityHandler.sendMessage(msg);
            }

            outStream.close();
            fileStream.close();
            inStream.close();

            if(isInterrupted())
            {
                // the download was canceled, so let's delete the partially downloaded file
                outFile.delete();
            }
            else
            {
                // notify completion
                msg = Message.obtain(parentActivity.activityHandler,
                        AndroidFileDownloader.MESSAGE_DOWNLOAD_COMPLETE);
                parentActivity.activityHandler.sendMessage(msg);
            }
        }
        catch(MalformedURLException e)
        {
            String errMsg = parentActivity.getString(R.string.error_message_bad_url);
            msg = Message.obtain(parentActivity.activityHandler,
                    AndroidFileDownloader.MESSAGE_ENCOUNTERED_ERROR,
                    0, 0, errMsg);
            parentActivity.activityHandler.sendMessage(msg);
        }
        catch(FileNotFoundException e)
        {
            String errMsg = parentActivity.getString(R.string.error_message_file_not_found);
            msg = Message.obtain(parentActivity.activityHandler,
                    AndroidFileDownloader.MESSAGE_ENCOUNTERED_ERROR,
                    0, 0, errMsg);
            parentActivity.activityHandler.sendMessage(msg); 
        }
        catch(Exception e)
        {
            String errMsg = parentActivity.getString(R.string.error_message_general);
            msg = Message.obtain(parentActivity.activityHandler,
                    AndroidFileDownloader.MESSAGE_ENCOUNTERED_ERROR,
                    0, 0, errMsg);
            parentActivity.activityHandler.sendMessage(msg); 
        }
    }

} 
```

**更新**

或者您可以简单地将以下代码用于`Upload`&`Download`过程。

```
package com.resource.util;
import java.io.BufferedInputStream;
import java.io.BufferedOutputStream;
import java.io.File;
import java.io.FileInputStream;
import java.io.FileOutputStream;
import java.io.IOException;
import java.net.MalformedURLException;
import java.net.URL;
import java.net.URLConnection;

/**
 * This class is used to upload a file to a FTP server.
 *
 * @author Muthu
 */
public class FileUpload
{

   /**
    * Upload a file to a FTP server. A FTP URL is generated with the
    * following syntax:
    * ftp://user:password@host:port/filePath;type=i.
    *
    * @param ftpServer , FTP server address (optional port ':portNumber').
    * @param user , Optional user name to login.
    * @param password , Optional password for user.
    * @param fileName , Destination file name on FTP server (with optional
    *            preceding relative path, e.g. "myDir/myFile.txt").
    * @param source , Source file to upload.
    * @throws MalformedURLException, IOException on error.
    */
   public void upload( String ftpServer, String user, String password,
         String fileName, File source ) throws MalformedURLException,
         IOException
   {
      if (ftpServer != null &amp;&amp; fileName != null &amp;&amp; source != null)
      {
         StringBuffer sb = new StringBuffer( "ftp://" );
         // check for authentication else assume its anonymous access.
         if (user != null &amp;&amp; password != null)
         {
            sb.append( user );
            sb.append( ':' );
            sb.append( password );
            sb.append( '@' );
         }
         sb.append( ftpServer );
         sb.append( '/' );
         sb.append( fileName );
         /*
          * type ==&gt; a=ASCII mode, i=image (binary) mode, d= file directory
          * listing
          */
         sb.append( ";type=i" );

         BufferedInputStream bis = null;
         BufferedOutputStream bos = null;
         try
         {
            URL url = new URL( sb.toString() );
            URLConnection urlc = url.openConnection();

            bos = new BufferedOutputStream( urlc.getOutputStream() );
            bis = new BufferedInputStream( new FileInputStream( source ) );

            int i;
            // read byte by byte until end of stream
            while ((i = bis.read()) != -1)
            {
               bos.write( i );
            }
         }
         finally
         {
            if (bis != null)
               try
               {
                  bis.close();
               }
               catch (IOException ioe)
               {
                  ioe.printStackTrace();
               }
            if (bos != null)
               try
               {
                  bos.close();
               }
               catch (IOException ioe)
               {
                  ioe.printStackTrace();
               }
         }
      }
      else
      {
         System.out.println( "Input not available." );
      }
   }

   /**
    * Download a file from a FTP server. A FTP URL is generated with the
    * following syntax:
    * ftp://user:password@host:port/filePath;type=i.
    *
    * @param ftpServer , FTP server address (optional port ':portNumber').
    * @param user , Optional user name to login.
    * @param password , Optional password for user.
    * @param fileName , Name of file to download (with optional preceeding
    *            relative path, e.g. one/two/three.txt).
    * @param destination , Destination file to save.
    * @throws MalformedURLException, IOException on error.
    */
   public void download( String ftpServer, String user, String password,
         String fileName, File destination ) throws MalformedURLException,
         IOException
   {
      if (ftpServer != null &amp;&amp; fileName != null &amp;&amp; destination != null)
      {
         StringBuffer sb = new StringBuffer( "ftp://" );
         // check for authentication else assume its anonymous access.
         if (user != null &amp;&amp; password != null)
         {
            sb.append( user );
            sb.append( ':' );
            sb.append( password );
            sb.append( '@' );
         }
         sb.append( ftpServer );
         sb.append( '/' );
         sb.append( fileName );
         /*
          * type ==&gt; a=ASCII mode, i=image (binary) mode, d= file directory
          * listing
          */
         sb.append( ";type=i" );
         BufferedInputStream bis = null;
         BufferedOutputStream bos = null;
         try
         {
            URL url = new URL( sb.toString() );
            URLConnection urlc = url.openConnection();

            bis = new BufferedInputStream( urlc.getInputStream() );
            bos = new BufferedOutputStream( new FileOutputStream(
                  destination.getName() ) );

            int i;
            while ((i = bis.read()) != -1)
            {
               bos.write( i );
            }
         }
         finally
         {
            if (bis != null)
               try
               {
                  bis.close();
               }
               catch (IOException ioe)
               {
                  ioe.printStackTrace();
               }
            if (bos != null)
               try
               {
                  bos.close();
               }
               catch (IOException ioe)
               {
                  ioe.printStackTrace();
               }
         }
      }
      else
      {
         System.out.println( "Input not available" );
      }
   }
} 
```

从上面的代码`download()`方法可以为您提供所需的任何内容。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-30T20:17:48.887

我使用库[Download Commons Net](http://commons.apache.org/net/download_net.cgi)是最好的库之一，它非常适合上传或下载

# java - FTPClient检查权限

> ID：10813363
> 
> 赞同：1
> 
> 时间：2012-05-30T09:18:42.750
> 
> 标签：java, apache, apache-commons-net

[如果我在ftp://ftpdomainname.com](ftp://ftpdomainname.com)有一个 ftp 服务器并且我想将文件上传到它，我如何使用[Commons Net](http://commons.apache.org/net/)检查它的权限？

我尝试：

```
ftpClient = new FTPClient();
ftpClient.connect(url.getHost());

ftpClient.login(username, pass);

FTPFile[] directories = mFtpClient.listDirectories("/");
for(FTPFile dir : directories) {
    permissions = dir.hasPermission(FTPFile.USER_ACCESS, FTPFile.READ_PERMISSION);
} 
```

但它没有获得根服务器（文件夹）的权限，而是获得其子文件夹的权限。

我可以指定像[ftp://ftpdomainname.com/](ftp://ftpdomainname.com/)这样的 url并获取我是否有写权限吗？或者像[ftp://ftpdomainname.com/subfolder1/subfolder2/](ftp://ftpdomainname.com/subfolder1/subfolder2/)这样的网址？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-30T16:00:55.407

使用 Commons Net 3.1[`FTPClient`](http://commons.apache.org/net/api-3.1/org/apache/commons/net/ftp/FTPClient.html)类，您可以尝试通过发出以下命令来获取当前的 FTPFile

```
 FTPFile current = mFTPClient.listFiles(".")[0];
 // Then check permissions as your upper code does. 
```

毕竟，在大多数主机上，当前文件都可以通过“.”访问。

**根据评论**编辑一些澄清。****

 **假设您刚刚连接到您的 FTP 服务器（在尝试上传文件之前）：

```
ftpClient = new FTPClient();
ftpClient.connect(url.getHost());

ftpClient.login(username, pass); 
```

完成后，立即尝试访问当前文件夹（这应该是您的默认用户文件夹，换句话说就是您要上传文件的文件夹）：

```
 FTPFile current = mFTPClient.listFiles(".")[0]; 
```

在此文件夹中，读取权限，您将拥有根文件夹的权限：

```
current.hasPermission(FTPFile.USER_ACCESS, FTPFile.READ_PERMISSION); 
```

想写点什么？然后检查 WRITE_PERMISSION。**

# php - PHP socket_recv 和 socket_read

> ID：10813365
> 
> 赞同：7
> 
> 时间：2012-05-30T09:18:55.827
> 
> 标签：php

通过阅读 PHP 手册，socket_recv 和 socket_read 函数在我看来是一样的，这两个函数都从客户端获取数据。

谁能告诉我这两个功能有什么不同？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-05-30T09:28:52.807

`socket_recv`返回接收到的字节数 `socket_read`返回已经接收到的数据

您可以从缓冲区中读取字节并`socket_recv`知道已收到多少字节。`socket_read`您只能从缓冲区中读取特定数量的数据

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-30T09:33:46.580

From [http://www.faqs.org/faqs/unix-faq/socket/#b](http://www.faqs.org/faqs/unix-faq/socket/#b):

> 2.18\. What is the difference between read() and recv()?
> 
> From Andrew Gierth (andrew@erlenstar.demon.co.uk):
> 
> read() is equivalent to recv() with a flags parameter of 0\. Other
> values for the flags parameter change the behaviour of recv().
> Similarly, write() is equivalent to send() with flags == 0.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-30T09:55:03.300

```
MSG_WAITALL  Block until at least len are received. However, if a signal is caught or the remote host disconnects, the function may return less data.
MSG_DONTWAIT     With this flag set, the function returns even if it would normally have blocked. 
```

一种阻塞能力，它可以让函数等待直到接收到数据，当然通过使用 socket_recv，但是通过使用 socket_read，它假定字节已经接收并且不等待，所以它可能什么也不返回：

```
Note:

socket_read() returns a zero length string ("") when there is no more data to read. 
```

# php - Ajax 自动完成输入，已经关联了一些事件

> ID：10813368
> 
> 赞同：0
> 
> 时间：2012-05-30T09:19:05.463
> 
> 标签：php, javascript, jquery, ajax

我有一个小项目，我做了一个类似excel的表格。每个表格单元格都包含一个禁用的输入，当您单击任何单元格时，输入变为启用以便您可以键入，更改该单元格的颜色+整行，您可以使用 TAB 切换到下一行，或使用 ENTER 切换到下一行，或 UP 和 DOWN 用于其上方或下方的单元格。当行更改时，它将调用 ajax 函数将数据更新到数据库。

这是迄今为止的项目描述。我的问题是：

我需要对表格的某些列进行自动完成。到目前为止，我尝试了 Bootstrap typeahead、JqueryUI 自动完成和其他几个。它们似乎都不适合我的情况。主要原因是他们覆盖了我的事件。

我试图只在一个特定的单元格上添加自动完成功能，以测试它是如何工作的。当我单击它时，该单元格不会启用，因为我的 javascript 已被该自动完成功能禁用。

我试图从代码中启用它以查看它是如何工作的，并且确实自动完成似乎出现了，但是我的向上和向下箭头键搞砸了。

关于如何让自动完成功能在这种情况下工作的任何想法？

谢谢，任何想法都非常感谢，我已经对此进行了两天的头脑风暴。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-30T13:26:38.530

这是一个非常简单的脚本，可以完成这项工作...... [http://dev.twiip.ch/scripts/autocomplete/](http://dev.twiip.ch/scripts/autocomplete/)

他们的链接提供了一个简单的示例，可以使用 php 和 ajax 从 mysql 数据库中选择一些数据。

它是法语的，你可以用谷歌翻译来理解。

# javascript - 为了将值添加到文本区域中，我从 jquery 函数中缺少什么

> ID：10813370
> 
> 赞同：0
> 
> 时间：2012-05-30T09:19:13.123
> 
> 标签：javascript, jquery

在用户单击“添加”按钮后，我试图将一些内容添加到文本区域中，但没有任何反应。有什么我想念的吗？

以下是添加所选内容的 jquery 代码：

```
 $(".add").on("click", function(event) {
    console.log("clicked");
    //lets get our Question Text... 
    var theQuestion = $("td:first-child", $(this).parent()).text();
    //the row is present, let's then make sure that the proper cell gets oru data. 
    if ($('.activePlusRow').length > 0) {
        $('.activePlusRow').next('.textAreaQuestion').val(theQuestion);
        $('.activePlusRow').removeClass('activePlusRow');
    }

});

 $(".plusrow").on("click", function(event) {
    //adding a unique class for the purpose of the click. 
    $(this).addClass('activePlusRow');
}); 
```

下面是文本区域：

```
 $('.questionTextArea').each( function() {

    var $this = $(this);
    var $questionText = $("<textarea class='textAreaQuestion'></textarea>").attr('name',$this.attr('name')+"[]")
                   .attr('value',$this.val());

    }); 
```

编辑：

您可以使用该应用程序亲自查看。以下是应用程序的使用方法：

1.  当您打开应用程序时，单击“绿色加号”按钮。将出现一个模式窗口。
2.  在搜索框中输入“AAA”，然后单击“搜索”。
3.  显示您的搜索结果。这就是问题所在。我想要的是，当用户单击“添加”按钮添加“问题”时，它应该关闭模式窗口并将“问题”添加到顶部文本区域，但它没有这样做。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-30T09:42:35.377

与输入不同的文本区域不使用 value 属性来存储数据，这可能是 attr('value', 'bla') 失败的原因。

我相信 .val() 方法会自动考虑到这一点，因此无论如何都可以工作。

尝试类似：

```
var $questionText = $("<textarea class='textAreaQuestion'></textarea>").attr('name',$this.attr('name')+"[]").val($this.val()); 
```

* * *

# php - 为什么浏览器不解析内容？

> ID：10813377
> 
> 赞同：0
> 
> 时间：2012-05-30T09:19:44.743
> 
> 标签：php, apache, http-headers

我有一个在 linux apache 服务器上运行的网站。

当内容存在于源代码中时，有时不会显示动态 .php 页面（页面为白色/空白），似乎浏览器没有解析内容。

我不知道为什么浏览器没有解析，我的印象是它认为页面仍在加载，因此没有解析（因为浏览器表示它仍在加载）。但是，由于所有内容都已经存在，它应该开始显示。

错误日志中只有通知。

*   浏览器不解析内容/认为页面仍在加载的原因可能是什么？
*   我能做些什么呢？

# javascript - 用链接替换 URL 或完全限定域名

> ID：10813379
> 
> 赞同：0
> 
> 时间：2012-05-30T09:19:51.957
> 
> 标签：javascript, regex

我不擅长常规exp。我想将链接更改为文本中的超链接

例如

```
Hello http://stackoverflow.com
Hello www.stackoverflow.com 
```

我希望stackoverflow链接

```
Hello <a href='http://stackoverflow.com'>http://stackoverflow.com</a>
Hello <a href='http://www.stackoverflow.com'>www.stackoverflow.com</a> 
```

我用这个

```
var exp = /(\b(https?|ftp|file|):\/\/[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|])/ig;
        return str.replace(exp,"<a href='$1' target='_blank'>$1</a>"); 
```

但这仅适用于 http://

预先感谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-30T16:22:06.557

正如其他人所说，首先您需要定义什么是“链接”。（请注意，在这种情况下，“链接”只是“超链接”的缩写，因此您的这句话没有意义。）考虑到您的两个示例，您希望匹配[*统一资源标识符（URI）*](http://en.wikipedia.org/wiki/Uniform_resource_identifier)和[*完全限定域名*（FQDN）](http://en.wikipedia.org/wiki/Fully_qualified_domain_name)代替。

为此，您应该采用可在[RFC 3986 附录 B](https://www.rfc-editor.org/rfc/rfc3986#appendix-B)中找到的正则表达式-</p>

```
^(([^:/?#]+):)?(//([^/?#]*))?([^?#]*)(\?([^#]*))?(#(.*))? 
```

– 并将其更改为在单词边界处匹配的，在 之后仅接受 FQDN 和可选端口号`//`，并在空格 ( `\s`) 处停止：

```
 ,----scheme----.   ,-Fully Qualified Domain Name-.,-port.,--path--.,---query----.,fragment
      |              |   |                             ||     ||        ||            ||       |
(^|\s)(([^:/?#\s]+):)?(//([A-Za-z0-9-]+\.)+[A-Za-z0-9-]+(:\d+)?([^?#\s]*)(\?([^#\s]*))?(#(\S*))? 
```

然后你可以让方案部分成为可选的——</p>

```
 |
                          v
(^|\s)((([^:/?#\s]+):)?//)?(([A-Za-z0-9-]+\.)+[A-Za-z0-9-]+(:\d+)?([^?#\s]*)(\?([^#\s]*))?(#(\S*))? 
```

– 并将其写为正则表达式文字（表达式中的斜杠需要转义，因为它们用作分隔符）：

```
/(^|\s)((([^:\/?#\s]+):)?\/\/)?(([A-Za-z0-9-]+\.)+[A-Za-z0-9-]+)(:\d+)?([^?#\s]*)(\?([^#\s]*))?(#(\S*))?/ 
```

（您可能也想匹配[IDN](http://en.wikipedia.org/wiki/Internationalized_domain_name)；JSX:regexp.js 及其对 Unicode 字符属性的支持可以帮助您，请参阅[如何从字符串中删除所有字符](https://stackoverflow.com/questions/1015844/beginner-javascript-regex-how-to-remove-all-characters-from-a-string/8568325#8568325)。您可能希望在 FQDN 子表达式前添加一个子表达式`(\w+@)?`用于代理访问的 URI 中用户名的可选和不推荐传输。）

然后，您可以替换与相应元素匹配的*所有*字符串（`g`lobal 修饰符） ：`a`

```
var rx = /(^|\s)(((([^:\/?#\s]+):)?\/\/)?(([A-Za-z0-9-]+\.)+[A-Za-z0-9-]+)(:\d+)?([^?#\s]*)(\?([^#\s]*))?(#(\S*))?)/g;

str = str.replace(rx,
  function (match, optionalWhitespace, uri, scheme, p4, protocol, fqdn, p7, port,
            path, query, queryVal, fragment, fragId) {
    return (optionalWhitespace ? optionalWhitespace : '')
      + '<a href="' + (protocol ? uri : 'http://' + uri)
      + '" target="_blank">' + uri + '<\/a>';
  }); 
```

您必须在此假设，当您只看到 FQDN 前缀时，它是不安全网站的域名，并在前面加上`http://`. 否则，属性中的 URI 引用将引用*您*`href`网站中可能存在的路径，该路径以域名作为其名称 ( )，这可能不是您想要的。*`http://your-site.example/other-site.example.com`*

 *在您的情况下，此表达式可能匹配太多，但不太可能；使用尽可能多的输入进行测试，并根据需要进行调整。如果向后兼容性不是问题，请使用[非捕获括号](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/RegExp)( `(?:…)`) 以提高效率并减少命名参数；有关详细信息，请参阅[ECMAScript 支持矩阵](http://PointedEars.de/es-matrix)。

捕获 FQDN 部分（括号内`([A-Za-z0-9-]+\.)+[A-Za-z0-9-]+`）是可选的；您可能希望使用它为`a`元素赋予`class`属性值，以便以特殊方式对其进行格式化，例如添加合适的图标，例如用于指向 Stack Overflow、Wikipedia、Twitter 或 Facebook 的链接。

您可能还想重新考虑使用该`target`属性（[对于 Strict (X)HTML，您必须删除它](http://www.w3.org/TR/html4/struct/links.html#edef-A)）。用户可能不会善意地认为无法控制链接目标的打开位置。改为以标题、图标、光标等形式提供提示。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-30T13:23:48.647

使用此代码：

```
var exp = /(((?:(?:https?|ftp|file):)?\/\/)?(?:[\w-]+\.)?[\w-]+\.\w{2,5}(?:\/[^\s\/]*)*)/ig;
return str.replace(exp, function(_, link, protocol){
    return link.link(protocol ? link : "http://" + link);
}); 
```*

# java - 现代 JVM 中的反射成本（6 起）

> ID：10813390
> 
> 赞同：5
> 
> 时间：2012-05-30T09:20:48.103
> 
> 标签：java, reflection

我想知道现代 JVM 中反射的成本是否已经下降，除了代码中最关键的部分之外，我们可以在任何地方自由使用它。

例如，如果我想根据用户提供的方法名称作为输入来调用方法。现在有两种实现方式：

1.  使用 if/else/switch 来确定调用哪个方法。如果有大量案例，这显然会是很多代码。

2.  使用反射来调用方法。这绝对是更少的代码。

**澄清**：上面只是一个使用反射可以减少代码量的例子。我只是想知道用一些反射魔法替换大量静态代码是否是一种有效的策略。如果您在类似的线路上做过一些事情，也请分享任何经验。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-30T09:24:21.547

不，在我看来，还有另一种更好的方法：使用命令模式和名称/命令实例对的映射。您可以在没有开关或反射的情况下扩展很长的距离。它也是多态的——更“面向对象”。

看看`java.lang.Runnable`或者`java.util.concurrent.Callable`如果你不想使用你自己的命令。如果您愿意，您的方法可以异步执行。

我不清楚用户将如何指定他们希望调用的方法。如果你使用反射，他们必须拼出类的名称、方法、参数，并知道返回类型。你打算如何向他们展示可能的选择？应用程序中的每个类、每个方法？有什么公平的游戏吗？

我认为以易于指定和调用的方式呈现一个选项列表更为合理。我不相信任何基于反射的解决方案都符合该标准。

您想为用户提供一个选择，但“一切顺利”对我来说似乎并不实际。

至于下面提供的具体示例，包括 Spring 控制器和服务，我不会使用反射。如果您的用户通过传递 HTTP 查询参数来指定开始或停止，最好使用 REST 将各个控制器方法映射到您想到的特定 URL。我的偏好是清晰，即使它更冗长。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-30T09:25:51.133

即使它下降了，与直接方法调用/字段访问相比，它仍然慢很多。但是在您的情况下，这真的不重要，因为这些天 JVM 飞速发展。您是否看到*明显*的性能影响来证明这样的问题？另外，请意识到这里的附带损害是您失去了所有静态类型检查的优点。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-30T09:33:00.417

You must differentiate between two steps in a reflective method call: method lookup (slow) and method invocation (very fast). So all you really need to do is cache the `Method` instances and have a fast lookup solution for them. Then you'll have a win-win solution.

# iphone - 如何检查文本是否归档值并显示警报并清空iphone中的文本字段

> ID：10813393
> 
> 赞同：4
> 
> 时间：2012-05-30T09:21:00.663
> 
> 标签：iphone, xcode

我正在输入值 textfiled 我希望如果它是正确的值那么它可以显示警报并使文本字段为空。所以用户可以输入正确的值我已经尝试了很多方法但我没有解决它。

```
 -(void)textFieldTextDidChangeClinicMarkup:(UITextField*)tf{

   NSString*test=clinicMarkupTextField.text;

if([test isEqualToString:@"1"]){
    NSString*value=@"1";

    appDelegate.clinicalMarkup=value;

}

else if([test isEqualToString:@"1.5"]){

    NSString*value=@"1.5";

    appDelegate.clinicalMarkup=value;

}

else if([test isEqualToString:@"2"]){

    NSString*value=@"2";

    appDelegate.clinicalMarkup=value;

}

else if([test isEqualToString:@"2.5"]){

    NSString*value=@"2.5";

    appDelegate.clinicalMarkup=value;

}

else if([test isEqualToString:@"3"]){

    NSString*value=@"3";

    appDelegate.clinicalMarkup=value;

}

else if([test length] >=3 || [test floatValue] > 3 || [test floatValue] <1 )  {

    UIAlertView * alert = [[UIAlertView alloc] initWithTitle:@"Warning" message:@"Clinic Markup can only be 1, 1.5, 2, 2.5 and 3 " delegate:nil cancelButtonTitle:@"OK" otherButtonTitles:nil];
    [alert show];
    [alert release];

     }
  } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-30T09:45:37.337

对于这个特定的问题，我会使用一个`UIStepper`控件来代替：

```
stepper.minimumValue = 1.0f;
stepper.maximumValue = 3.0f;
stepper.stepValue = 0.5f; 
```

步进控件如下所示：
![在此处输入图像描述](../Images/4640f63107fe79fadd5df220df915323.png)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-30T09:58:48.950

@james 如果您只有一个文本字段，那么您可以实现以下代码：

```
- (BOOL)textFieldShouldReturn:(UITextField *)textField
{
 NSString *strText=textField.text;
    if ([strText isEqualToString:@"1"]||[strText isEqualToString:@"1.5"]||[strText isEqualToString:@"2"]||[strText isEqualToString:@"2.5"]||[strText isEqualToString:@"3"]) 
    {
        appDelegate.clinicalMarkup=strText;
        [textField resignFirstResponder];
    }
    else
    {
        UIAlertView * alert = [[UIAlertView alloc] initWithTitle:@"Warning" message:@"Clinic Markup can only be 1, 1.5, 2, 2.5 and 3 " delegate:nil cancelButtonTitle:@"OK" otherButtonTitles:nil];
        [alert show];
        [alert release];

    }
return YES;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-30T09:45:24.140

设置您的委托

```
clinicMarkupTextField.delegate = self;
clinicMarkupTextField.returnKeyType = UIReturnKeyDone; 
```

并尝试下面的代码

```
-(BOOL)textFieldShouldReturn:(UITextField *)textField{

    if(clinicMarkupTextField == textField) //only if u have more then 1 text field
    {
        NSString*test=textField.text;

    if([test isEqualToString:@"1"]){
            NSString*value=@"1";
        appDelegate.clinicalMarkup=value;
     }

         ---SNIP---             

        else if([test length] >=3 || [test floatValue] > 3 || [test floatValue] <1 )  {

         //if all condition fails 
         textField.text = @"";

             UIAlertView * alert = [[UIAlertView alloc] initWithTitle:@"Warning" message:@"Clinic Markup can only be 1, 1.5, 2, 2.5 and 3 " delegate:nil cancelButtonTitle:@"OK" otherButtonTitles:nil];
             [alert show];
             [alert release];

          }
       }
 return yes;

    } 
```

# facebook - 将 Google 地球小工具嵌入到安全的 Facebook 应用程序中

> ID：10813396
> 
> 赞同：1
> 
> 时间：2012-05-30T09:21:14.793
> 
> 标签：facebook, google-maps, kml, google-earth-plugin

我正在尝试将 google 地球小工具嵌入到安全的 Facebook 应用程序中，但我遇到了一些问题，因为 google 小工具 URL 不安全，

```
<script src="//www.gmodules.com/ig/ifr?url=http://dl.google.com/developers/maps/embedkmlgadget.xml&amp;up_kml_url=&amp;up_view_mode=earth&amp;up_earth_2d_fallback=1&amp;up_earth_fly_from_space=1&amp;up_earth_show_nav_controls=1&amp;up_earth_show_buildings=1&amp;up_earth_show_terrain=1&amp;up_earth_show_roads=1&amp;up_earth_show_borders=1&amp;up_earth_sphere=earth&amp;up_maps_zoom_out=1&amp;up_maps_default_type=hybrid&amp;synd=open&amp;w=500&amp;h=400&amp;title=Test&amp;border=%23ffffff%7C3px%2C1px+solid+%23999999&amp;output=js"></script> 
```

它拒绝在 https 环境中加载小工具，因为它应该，但现在我似乎找不到任何为小工具生成安全脚本标签的方法，我已经用谷歌搜索了我的屁股并搜索了 SO，但我可以找不到任何有用的东西，知道如​​何让这个小工具显示在我的 Facebook 应用程序中吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-12T16:44:09.367

如果您无法提供小工具，那么此答案将无济于事。如果您可以将您的小工具变成服务网页而不是小工具，那么答案很简单。包含 Google 地球的 google javascript 文件从以下位置更改：

[http://www.google.com/jsapi](http://www.google.com/jsapi)

至

[https://www.google.com/jsapi](https://www.google.com/jsapi)

你就跑起来了。

# frameworks - 需要一些解释和路线图才能成为 Web 开发人员

> ID：10813397
> 
> 赞同：-1
> 
> 时间：2012-05-30T09:21:17.543
> 
> 标签：frameworks

希望你能帮助我。

我计划在这些暑假期间学习 Web 开发，以便在我学会 inshAllah 后可以做一些自由职业，但我对从哪里开始以及在几个方面有点困惑。希望你们能帮助我并推荐我应该学习的内容和顺序。

我正在攻读计算机科学学士学位，学过很多 C++，所以我对编程语言有相当多的概念。我做了一个数据库课程，所以我知道相当数量的数据库和sql。

我也知道相当多的 html、css、javascript、jquery、php（非常基本的 php，只够与 mysql 交互）。

对我来说，一条明显的道路是提高我的 php 技能。但是还有框架和CMS。我已经在线阅读，但我不能完全理解框架或 CMS 到底是什么？除了框架或cms之外还有其他东西吗？先学哪个？我应该先学习一个框架/cms吗？

此外，似乎有很多关于 wordpress 的自由项目，所以当谈到 CMS 时，我宁愿这样做。

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-30T09:29:51.030

一旦你学会了如何使用框架，框架通常会提供预制代码，从长远来看，你可以使用这些代码来“加速你的工作流程”。并非所有事情都需要。多年来，我一直在没有任何特定框架的情况下进行开发，尽管最终可能会从中受益。

CMS（内容管理系统）是网站管理员/公司/客户用来将内容插入网站的后端或管理部分。它是非技术人员的界面，它使更改页面/更新/产品等变得容易。一个不错的基于 PHP 的免费 CMS 是 Joomla，或者您可以查看 WordPress。Joomla 通常不超过几天的时间来学习如何使用。

希望这可以帮助。

# performance - 优化简单的 Common Lisp gibbs 采样程序

> ID：10813398
> 
> 赞同：6
> 
> 时间：2012-05-30T09:21:27.053
> 
> 标签：performance, statistics, common-lisp, sbcl, mcmc

作为练习，我在Darren Wilkinson的博客文章[Gibbs sampler 中用各种语言（重新访问）重写了示例程序。](http://darrenjw.wordpress.com/2011/07/16/gibbs-sampler-in-various-languages-revisited/)

代码如下所示。这段代码在我（5 岁的）机器上运行大约 53 秒，使用 SBCL 1.0.56，使用 buildapp 创建核心映像，然后运行它

```
time ./gibbs > gibbs.dat 
```

因为这是计算帖子中其他语言的时间的方式，所以我想我会做一些类似的事情。帖子中的 C 代码运行大约 25 秒。如果可能的话，我想尝试加速 Lisp 代码。

```
##############################
gibbs.lisp
##############################
(eval-when (:compile-toplevel :load-toplevel :execute)
  (require :cl-rmath) (setf *read-default-float-format* 'double-float))

(defun gibbs (N thin)
  (declare (fixnum N thin))
  (declare (optimize (speed 3) (safety 1)))
  (let ((x 0.0) (y 0.0))
    (declare (double-float x y))
    (print "Iter x y")
    (dotimes (i N)
      (dotimes (j thin)
    (declare (fixnum i j))
    (setf x (cl-rmath::rgamma 3.0 (/ 1.0 (+ (* y y) 4))))
    (setf y (cl-rmath::rnorm (/ 1.0 (+ x 1.0)) (/ 1.0 (sqrt (+ (* 2 x) 2))))))
      (format t "~a ~a ~a~%" i x y))))

(defun main (argv)
  (declare (ignore argv))
  (gibbs 50000 1000)) 
```

然后我用as`gibbs`调用构建了可执行文件`sh gibbs.sh``gibbs.sh`

```
##################
gibbs.sh
##################
buildapp --output gibbs --asdf-tree /usr/share/common-lisp/source/ --asdf-tree /usr/local/share/common-lisp/source/ --load-system cl-rmath --load gibbs.lisp --entry main 
```

使用 SBCL 1.0.56 进行编译时，我得到了 6 个编译器注释，它们在下面重现。我不知道该怎么处理他们，但会感谢任何提示。

```
; compiling file "/home/faheem/lisp/gibbs.lisp" (written 30 MAY 2012 02:00:55 PM):

; file: /home/faheem/lisp/gibbs.lisp
; in: DEFUN GIBBS
;     (SQRT (+ (* 2 X) 2))
; 
; note: unable to
;   optimize
; due to type uncertainty:
;   The result is a (VALUES (OR (DOUBLE-FLOAT 0.0) (COMPLEX DOUBLE-FLOAT))
;                           &OPTIONAL), not a (VALUES FLOAT &REST T).

;     (/ 1.0d0 (SQRT (+ (* 2 X) 2)))
; 
; note: unable to
;   optimize
; due to type uncertainty:
;   The second argument is a (OR (DOUBLE-FLOAT 0.0)
;                                (COMPLEX DOUBLE-FLOAT)), not a (COMPLEX
;                                                                DOUBLE-FLOAT).
; 
; note: forced to do static-fun Two-arg-/ (cost 53)
;       unable to do inline float arithmetic (cost 12) because:
;       The second argument is a (OR (DOUBLE-FLOAT 0.0) (COMPLEX DOUBLE-FLOAT)), not a DOUBLE-FLOAT.
;       The result is a (VALUES (OR (COMPLEX DOUBLE-FLOAT) (DOUBLE-FLOAT 0.0))
;                               &OPTIONAL), not a (VALUES DOUBLE-FLOAT &REST T).

;     (CL-RMATH:RGAMMA 3.0d0 (/ 1.0d0 (+ (* Y Y) 4)))
; 
; note: doing float to pointer coercion (cost 13)

;     (SQRT (+ (* 2 X) 2))
; 
; note: doing float to pointer coercion (cost 13)

;     (CL-RMATH:RNORM (/ 1.0d0 (+ X 1.0d0)) (/ 1.0d0 (SQRT (+ (* 2 X) 2))))
; 
; note: doing float to pointer coercion (cost 13)
; 
; compilation unit finished
;   printed 6 notes

; /home/faheem/lisp/gibbs.fasl written
; compilation finished in 0:00:00.073 
```

更新 1：[Rainer Joswig 的回答](https://stackoverflow.com/a/10813558/350713)指出 SQRT 的参数可能是否定的，这是我看到的晦涩编译器注释的来源，即

```
The result is a (VALUES (OR (DOUBLE-FLOAT 0.0) (COMPLEX DOUBLE-FLOAT))
    ;                           &OPTIONAL), not a (VALUES FLOAT &REST T). 
```

编译器抱怨说，由于它不知道参数的值是否为正，结果可能是一个复数。由于在示例中，该值`x`是来自 gamma 分布的样本变量，因此它始终大于 0。Stephan 在 SBCL 用户邮件列表中很有帮助地指出了这一点，（请参阅线程[“优化简单的 Common Lisp”中的第二条消息Gibbs 采样程序”](http://thread.gmane.org/gmane.lisp.steel-bank.general/3543)，这可以通过声明 x 大于或零来解决，如下所示，

```
(declare (type (double-float 0.0 *) x)) 
```

[有关FLOAT 类型](http://www.lispworks.com/documentation/lw50/CLHS/Body/t_short_.htm#double-float) 和 [间隔指示符](http://www.lispworks.com/documentation/lw50/CLHS/Body/12_af.htm)的相关文档，请参阅 Common Lisp Hyperspec 。

这似乎加快了代码速度。它现在可靠地低于 52 秒，但仍然没有太大的进步。这也留下了关于

```
note: doing float to pointer coercion (cost 13) 
```

如果由于某种原因无法修复，我想知道原因。此外，无论如何，对注释含义的解释会很有趣。具体来说，这个词`pointer`在这里是什么意思？这与调用 C 函数的事实有关吗？此外，成本 13 似乎不是很有用。正在测量什么？

此外，Rainer 建议可以减少 consing，这可能会减少运行时间。我不知道是否可以减少 consing，或者是否会减少运行时间，但我会对意见和方法感兴趣。总体而言，似乎没有太多可以提高此功能的性能。也许它太小太简单了。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-30T09:30:54.740

请注意，Common Lisp 有一个[THE](http://clhs.lisp.se/Body/s_the.htm#the)特殊运算符。它允许您声明表达式结果的类型。例如，这允许您尽可能缩小类型。

例如，结果是`(SQRT somefloat)`什么？它可以是浮点数，但如果`somefloat`为负数，它可能是复数。如果你知道 somefloat 总是积极的（而且只有这样），那么你可以写`(the double-float (sqrt somefloat))`. 然后编译器可能能够生成更高效的代码。

另请注意，Common Lisp 有`OPTIMIZE`声明。如果您想要最快的代码，您需要确保相应地设置它们。可能仅适用于个别功能。通常它比全局更改优化要非常积极。

Common Lisp 有一个函数`DISASSEMBLE`可以让你查看编译后的代码。

然后是宏`TIME`。您从中获得的有趣信息包括它做了多少 consing。使用双浮点算术可能会有大量的 consing。在 SBCL 邮件列表上寻求帮助会很有用。也许有人可以告诉你如何避免这种骗局。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-31T05:07:11.027

这对我有用：

```
(sqrt (the (double-float 0d0) (+ (* 2d0 x) 2d0))) 
```

# exception - java.lang.NoClassDefFoundError / ClassNotFoundException

> ID：10813400
> 
> 赞同：1
> 
> 时间：2012-05-30T09:21:35.743
> 
> 标签：exception, servlets, birt

我正在尝试运行 BIRT Servlet 示例：

[http://onjava.com/pub/a/onjava/2006/07/26/deploying-birt.html?page=2](http://onjava.com/pub/a/onjava/2006/07/26/deploying-birt.html?page=2)

我想我将所有必需的 jar 添加到我的项目的构建路径中，但我现在无法让这个东西运行好几天。

```
exception 

javax.servlet.ServletException: Error instantiating servlet class WebReport
org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:472)
org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:100)
org.apache.catalina.valves.AccessLogValve.invoke(AccessLogValve.java:929)
org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:405)
org.apache.coyote.http11.Http11Processor.process(Http11Processor.java:269)
org.apache.coyote.AbstractProtocol$AbstractConnectionHandler.process(AbstractProtocol.java:515)
org.apache.tomcat.util.net.JIoEndpoint$SocketProcessor.run(JIoEndpoint.java:300)
java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source)
java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source)
java.lang.Thread.run(Unknown Source)

root cause 

java.lang.NoClassDefFoundError: org/eclipse/birt/report/engine/api/IRenderOption
java.lang.Class.getDeclaredConstructors0(Native Method)
java.lang.Class.privateGetDeclaredConstructors(Unknown Source)
java.lang.Class.getConstructor0(Unknown Source)
java.lang.Class.newInstance0(Unknown Source)
java.lang.Class.newInstance(Unknown Source)
org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:472)
org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:100)
org.apache.catalina.valves.AccessLogValve.invoke(AccessLogValve.java:929)
org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:405)
org.apache.coyote.http11.Http11Processor.process(Http11Processor.java:269)
org.apache.coyote.AbstractProtocol$AbstractConnectionHandler.process(AbstractProtocol.java:515)
org.apache.tomcat.util.net.JIoEndpoint$SocketProcessor.run(JIoEndpoint.java:300)
java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source)
java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source)
java.lang.Thread.run(Unknown Source)

root cause 

java.lang.ClassNotFoundException: org.eclipse.birt.report.engine.api.IRenderOption
org.apache.catalina.loader.WebappClassLoader.loadClass(WebappClassLoader.java:1678)
org.apache.catalina.loader.WebappClassLoader.loadClass(WebappClassLoader.java:1523)
java.lang.Class.getDeclaredConstructors0(Native Method)
java.lang.Class.privateGetDeclaredConstructors(Unknown Source)
java.lang.Class.getConstructor0(Unknown Source)
java.lang.Class.newInstance0(Unknown Source)
java.lang.Class.newInstance(Unknown Source)
org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:472)
org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:100)
org.apache.catalina.valves.AccessLogValve.invoke(AccessLogValve.java:929)
org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:405)
org.apache.coyote.http11.Http11Processor.process(Http11Processor.java:269)
org.apache.coyote.AbstractProtocol$AbstractConnectionHandler.process(AbstractProtocol.java:515)
org.apache.tomcat.util.net.JIoEndpoint$SocketProcessor.run(JIoEndpoint.java:300)
java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source)
java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source)
java.lang.Thread.run(Unknown Source) 
```

还有什么我忘了做的吗？你能帮我理解这个错误并运行servlet吗？提前致谢！！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-30T09:27:06.977

您必须确保包含该类的 JAR 文件`org.eclipse.birt.report.engine.api.IRenderOption`存在于`WEB-INF/lib`文件夹中。

# c# - 如何在 C# 中挂钩 NTShutdownSystem 以区分关机和重启

> ID：10813406
> 
> 赞同：4
> 
> 时间：2012-05-30T09:21:49.570
> 
> 标签：c#, hook, shutdown, reboot, shutdown-hook

不幸的是，当您收听 WM_QUERYENDSESSION 时，如果用户请求重新启动或关闭，您不会获得信息。这是一个非常糟糕的设计，但它就是 Windows 的方式，所以我正在考虑将调用挂钩到 NTShutdownSystem，它获取一个参数，告诉系统执行重新启动或关闭。

问题是：如何在 C# 中实际实现这一点？我想获得某种挂钩，我可以使用它来确定传递给 NTShutdownSystem 的参数，然后保存该信息。之后，我想按照用户想要的方式调用“真正的”NTShutdownSystem。

你有任何示例代码来说明这一点吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-30T10:53:57.200

之所以`WM_QUERYENDSESSION`没有给出关机原因，是因为当时用户可能只是正在注销，而不是关闭系统。

这通常属于*内核级挂钩*的类别，并且通常被认为不是一件好事，因为它会影响系统的稳定性。它们中的大多数是用 C 或 C++ 编写的，并且通常必须付出很多努力才能在所有正在执行的程序中执行挂钩 - 例如在程序加载时挂钩例程。

这不是一件小事，但是已经编写了一些框架来帮助尝试使用托管代码（例如 C#）[挂钩这样的例程](http://easyhook.codeplex.com/)

下一个要问的问题是你为什么在乎？

**编辑**NTShutdownSystem 在关机过程中很晚才被调用——那时你可能没有 UI，也没有办法做任何事情。我建议拦截[ExitWindowsEx](http://msdn.microsoft.com/en-us/library/windows/desktop/aa376868%28v=vs.85%29.aspx)、[InitiateShutdown](http://msdn.microsoft.com/en-us/library/windows/desktop/aa376872%28v=vs.85%29.aspx)、[InitiateSystemShutdown](http://msdn.microsoft.com/en-us/library/windows/desktop/aa376873%28v=vs.85%29.aspx)和[InitiateSystemShutdownEx](http://msdn.microsoft.com/en-us/library/windows/desktop/aa376874%28v=vs.85%29.aspx) - 我不知道其中一些是否被另一个调用，但您应该只记录原因，然后在`WM_QUERYENDSESSION`标准应用程序的代码中对原因做出反应。

# html - HTML5 视频不播放

> ID：10813408
> 
> 赞同：18
> 
> 时间：2012-05-30T09:21:58.957
> 
> 标签：html

我为 HTML5 尝试了一个简单的示例，但它似乎不起作用。

```
<!DOCTYPE html>
<html>

<body>
  <video width="320" height="240" controls="controls autoplay">
    <source src="resources/sample/sample1.mp4" type="video/mp4" />
  </video>
</body>

</html>
```

我在 chrome 上尝试了这个例子，视频加载了，但它不播放，如果我来回移动滑块，我可以看到视频帧，但视频本身不播放。

更新：我在 localhost(tomcat) 上访问了它，它仍然以同样的方式做出反应。我还注意到我无法在 chrome 或 firefox（更新）上播放任何 HTML5 视频。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2014-03-05T19:32:03.477

添加“控件”作为标志。它允许浏览器在视频上运行它自己的播放器代码。我在 Chrome 上尝试了一个 .mp4 文件，它可以工作。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-07-18T03:51:14.130

我不同意亚历克斯佩雷奥拉。它可以通过引用文件名和/或路径从本地机器加载。

我遇到了类似的问题，结果发现 Win 7 Pro 中的 IIS 在它的 mime 类型中没有 mp4。必须添加添加 mime 类型。请参阅下面链接中添加 mime 类型的说明。

[html5 视频不播放 mp4 错误“Invalid Source”？](https://stackoverflow.com/questions/14079808/html5-video-is-not-playing-mp4-error-invalid-source/)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2014-11-19T05:29:06.580

使用这两种格式它在所有浏览器中都可以正常工作：

```
<video width="640" height="360" controls>
    <!-- MP4 must be first for iPad! -->
    <source src="unbelievable.mp4" type="video/mp4" /><!-- Safari / iOS video    -->
    <source src="movie.ogg" type="video/ogg" /><!-- Firefox / Opera / Chrome10 -->
</video> 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2019-03-05T09:28:39.443

我现在面临同样的问题。我正在`src`使用 ajax 动态和异步地获取视频。

问题是`<video>`元素在`src`. 如果我们在加载后将`<video>`元素放入 DOM，`src`那么问题将得到解决。

如果是 Angular，我们可以使用它`*ngIf`来解决问题。以下是 Angular 代码片段：

```
<video autoplay *ngIf="src" class="thumbnail">
  <source [src]="src" [type]="type">
</video> 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-05-30T09:27:31.243

您不能使用 HTML5 Video 标签加载这样的本地文件。您必须使用本地主机或远程托管文件。尝试安装 mamp/wamp 并通过虚拟主机加载它。

```
<source src="http://localhost/development/programs/html/html5/sample/sample1.m4v" type="video/mp4" /> 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2020-06-12T22:09:44.527

对我有用的是将 mp4 格式从 V1 转换为 V2：

`ffmpeg.exe -i old.mp4 -brand mp42 new-v2.mp4`

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2019-04-12T16:57:21.840

如果您的视频类型是在 IIS/.NET 上运行的 MP4

将 web.config 文件添加到应用程序的根目录，`web.config`内容如下

```
 <?xml version="1.0" encoding="UTF-8"?>
  <configuration>
    <system.webServer>
      <staticContent>
        <mimeMap fileExtension=".mp4" mimeType="application/mp4" />
       </staticContent>
    </system.webServer>
  </configuration> 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2018-12-06T07:05:22.410

由于 IIS 中未添加 mime 类型，视频未在服务器中播放。

添加 Mime 类型：

• 转到 IIS 并选择您的站点

• 单击菜单下的 Mime 类型，然后单击右侧选项卡上的添加

• 在文件扩展名下添加mp4，在Mime 类型下添加视频/mp4，然后单击确定。

• 重新启动 IIS，现在运行应用程序

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2012-05-30T10:57:46.193

尝试为您的视频设置一个相对 uri。"D:/..." 仅适用于本地窗口，而不适用于所有浏览器。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2013-01-02T11:17:30.580

这可能是由于视频编码。检查视频的编码，看看 Chrome 是否支持。这可能是我遇到的可能原因。尝试使用 ff-mpeg 之类的编码器对视频进行编码。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2012-10-08T12:16:49.567

Chrome：文件是否也包含音频？如果是这样并且您正在桌面上播放它，请将扬声器连接到桌面并检查。

Firefox：不支持 H.264 内容

IE9：应将以下内容添加到您的页面`<meta http-equiv="X-UA-Compatible" content="IE=edge" />`

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2018-09-07T08:34:30.003

只需将控件设置为标志，而不是键=值对：

```
<!DOCTYPE html>
<html>
<body>

<video width="320" height="240" controls>
  <source src="resources/sample/sample1.m4v" type="video/mp4" />
</video>

</body>
</html> 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2015-10-13T14:04:16.517

我在 IIS 上托管时遇到了这个问题，并在[这里](https://stackoverflow.com/questions/28274486/iis-returns-404-not-found-for-mp4-files)找到了解决方案。就我而言，即使将完整的视频 URL 放在 Chrome 上也会给我 404 错误，因为站点配置中不存在 MP4 MIME 类型。因此，我添加了带有 MIME 视频/mp4 的 .mp4，一切正常。不知道是否与 tomcat 相同，但这值得一试......

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2021-08-01T16:18:20.143

请确保您已正确插入视频路径。您的“资源”文件夹和视频标签所在的页面必须位于同一文件夹中。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2017-03-06T18:16:14.597

添加`autoplay loop`到视频标签以自动播放，如下所示：

```
<!DOCTYPE html>
<html>
<body>
<video width="320" height="240" autoplay loop>
  <source src="resources/sample/sample1.m4v" type="video/mp4" />
</video>
</body>
</html> 
```

# c# - 如何在 C# 中将“int”转换为“char”？

> ID：10813412
> 
> 赞同：1
> 
> 时间：2012-05-30T09:22:10.350
> 
> 标签：c#, casting, char, int

我有一个混合了数字和字母的字符串变量。我想创建一个只包含`int`前一个字符串变量值的新字符串。所以我找到了两种转换`int`为`char`. 但是，它们不起作用。这是我尝试过的

```
string onlyNumberString = "";
foreach (char onlyNum in puzzleData)
{
    for (int i = 1; i < 10; i++)
    {
        if (onlyNum == (char)i)
        {
            onlyNumberString += onlyNum;
        }
    }
} 
```

和

```
string onlyNumberString = "";
foreach (char onlyNum in puzzleData)
{
    for (int i = 1; i < 10; i++)
    {
        if (onlyNum == Convert.ToChar(i))
        {
            onlyNumberString += onlyNum;
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-30T09:25:02.500

改用 Char.IsDigit，要简单得多。

```
StringBuilder onlyNumber = new StringBuilder();
foreach (char onlyNum in puzzleData)
{
    if (Char.IsDigit(onlyNum))
    {
        onlyNumber.Append(onlyNum);
    }
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-30T09:23:43.560

```
int iNum = 2;

char cChar = iNum.ToString()[0]; 
```

当 0 <= x <= 9 时适用于 x。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-05-30T09:24:14.367

您可以直接将其`int`转换为`char`：

```
var myChar = (char)20; 
```

但要做你想做的事，我建议使用正则表达式：

```
var onlyNumerals = Regex.Replace(myString, @"[^0-9]", ""); 
```

以上将用空格替换任何不是 0-9 的字符。

另一种方法，使用 LINQ 和`char.IsDigit`：

```
 var onlyNumeral = new string(myString.Where(c => Char.IsDigit(c)).ToArray()); 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-05-30T09:32:17.907

你可以这样做：

```
string justNumbers = new String(text.Where(Char.IsDigit).ToArray()); 
```

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2012-05-30T09:25:49.963

几种方法：

```
(char)int 
```

或者

```
int.Parse(char.ToString()) 
```

或者

```
Convert.ToChar(int); 
```

# crystal-reports - 使用 Crystal Reports 13 对数据进行分组

> ID：10813413
> 
> 赞同：1
> 
> 时间：2012-05-30T09:22:10.663
> 
> 标签：crystal-reports, grouping

两天来，我一直试图在水晶报告中对数据进行分组，但我无法让它发挥作用。

我想要完成的是根据用户类别对评论进行分组。

我有这个数据：

```
Question Nr Answer Category

oq1         asdf   External
oq1         Hej    Manager
oq1         asdf   External 
```

我希望这显示为：

**问题编号**

**外部**
asdf
asdf

 **海杰**经理****

 **我一直在尝试感觉像是一百万种不同的组组合，但它不会做我想要的。我最接近的是：

**问题编号**

**外部**
asdf

**经理**
_

**外部**
asdf

有谁知道可行的解决方案？

谢谢彼得

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-30T10:29:45.897

Group1 应该是 questionnr，group2 应该是 category。

从我所看到的情况来看，没有理由不应该将两个 asdf 条目组合在一起——除非其中一个条目旁边有一些空格？**

# knockout.js - 可观察数组内的对象更新已完成，但浏览器上未出现更改

> ID：10813416
> 
> 赞同：2
> 
> 时间：2012-05-30T09:22:24.490
> 
> 标签：knockout.js

我现在面临一个问题。我有一个包含对象列表的可观察数组。每当我更新数组的任何对象的属性时。它不会反映在浏览器上。我使用了所有淘汰功能，如替换、删除。但是更新出现在可观察数组中，但不在浏览器中。

这是我的问题的示例：

```
 var ViewModel=new {
     self=this;
     self.List=ko.observableArray([]); 
              }
     $(function(){
       ko.applyBinding(ViewModel); 
    }) 
    $.post('/url',{},function(data){
        ViewModel.List(data); //data is list having 4 property having CommentList as again object-->id,title,description,CommentList--->commenttitle,commentdescription
      })  
    //During change of property of commentList
    $.post('/updateComment',{},function(obj){//Here obj-->obj.Commenttitle="some title",obj.commentdescription='some description'
       //Let say there require update 4th object of List and  2nd property of CommentList
         ViewModel.AnswerList()[4].CommentList.splice(2,1,obj);

     })
    //But nothing updation on browser 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-30T10:31:33.443

你说：

> 每当我更新任何数组对象的属性时，它都不会反映在浏览器上。

可观察数组中对象的属性也需要设置为，`ko.observable`以便您的 UI 自动更新。

例如：

```
var anObservableArray = ko.observableArray([    
  { name: "A", type: "Type A" }    
]);

// some later point
anObservableArray()[0].name = "B"; 
```

不会更新您的 UI，因为它**不是**`name`可观察的。

然而，

```
var anObservableArray = ko.observableArray([    
  { name: ko.observable("A"), type: ko.observable("Type A") }    
]);

// some later point
anObservableArray()[0].name("B"); 
```

..将更新您的 UI 以将名称 B 显示为`name`可观察的。

编辑：（将代码添加到问题后）

所以从你的代码中你有：

```
 answer=GetAnswerFromViewModel(parentcourseItemID); 
 answer.CommentCount--;                     
 answer.CommentList.splice(CommentIndex,1); 
 answer.CommentText=''; 
```

假设`GetAnswerFromViewModel`返回具有可观察属性的答案，您应该编写：

```
 answer=GetAnswerFromViewModel(parentcourseItemID); 
 answer.CommentCount(answer.CommentCount()--);                     
 answer.CommentList.splice(CommentIndex,1); 
 answer.CommentText(''); 
```

如果您的答案中的属性不是可观察的，那么您的 UI 将不会更新。

# jsf - 在视图中找不到带有标识符的组件

> ID：10813417
> 
> 赞同：0
> 
> 时间：2012-05-30T09:22:27.520
> 
> 标签：jsf, primefaces

我有一个问题是，当我尝试更新不在同一个 xhtml 中的组件时。

有人知道怎么做吗？

thx PD：我正在使用 primefaces 3.2

对不起我的英语不好

我认为我没有很好地解释。

我有一个 tis 结构的 xhtml 父亲：

```
<h:panelGrid id="tabla">

    <h:form id="formTripu" prependId="false">
        <h:panelGrid id="fichaTripulante">
            <ui:include src="path1" />
            <p:spacer height="5px" />
            <p:tabView dynamic="false" cache="true">
                <p:tab title="#{bundleTrip.datosAdministrativos}">
                    <ui:include
                        src="path2" />
                </p:tab>
                <p:tab title="Datos Operativos ">
                    <ui:include
                        src="path3" />
                </p:tab> 
```

我希望做的是例如在 path1 中我使用 ah:selectBooleanCheckbox ，例如：

```
 <h:selectBooleanCheckbox inmediate="true" id="checkExt"
                        value="#{bean.Obj.field}">
                        <f:ajax render="estadoTripu"
                            actionListener="#{bean.method}" />
                    </h:selectBooleanCheckbox> 
```

estadoTripu 在 path2 中（otherxthml 但形式相同）。

```
<p:panel>
    <h:panelGrid id="datos" columns="5">
        <p:column> 
```

```
 <h:selectOneMenu id="estadoTripu" 
                    value="#{bean.Obj.Field2}">
                    <f:selectItems
                        value="#{bean.list}" var="item"
                        itemValue="#{item.id}" immediate="true"
                        itemLabel="#{item.desc}">
                    </f:selectItems>
                </h:selectOneMenu>
            </h:panelGrid>
        </p:column>
    </h:panelGrid>
</p:panel> 
```

Witch is paht in render of:ajax????

谢谢大家

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-30T10:38:20.463

试试这个：（这是我从 BalusC 学到的一个技巧 :)）

添加`binding="#{components.mySelecOneMenu}"`到您的`h:selectOneMenu`

```
<h:selectOneMenu binding="#{components.mySelecOneMenu}" ..... 
```

这就是你的按钮应该是什么样子（或多或少）

```
<h:commandButton value="doSomeThing">
    <f:ajax render="#{components.mySelecOneMenu.clientId}"/>
</<h:commandButton> 
```

将此添加到您的`faces-config.xml`

```
<managed-bean>
    <description>Holder of all component bindings.</description>
    <managed-bean-name>components</managed-bean-name>
    <managed-bean-class>java.util.HashMap</managed-bean-class>
    <managed-bean-scope>request</managed-bean-scope>
</managed-bean> 
```

这里有一些我只是建议你做的详细解释

[如何打破clientID的暴政？](https://stackoverflow.com/a/8340408/617373)

[没有 bean 属性的 JSF 组件绑定](https://stackoverflow.com/a/8168427/617373)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-30T09:29:33.987

如果它们不在同一个 xhtml 中，您是否在另一个中包含一个？如果没有，只需更改页面，它将显示正确的页面。

但我认为我没有正确理解你的问题。

请添加一些代码

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-05T09:38:22.703

我发现组件应该采用相同的形式，调用 id 以形式开始到组件，它首选将 id 放置在每个面板网格、面板等，因为您必须调用要渲染的每个组件 englobe 组件。

# mysql - sql加入查询

> ID：10813419
> 
> 赞同：0
> 
> 时间：2012-05-30T09:22:34.000
> 
> 标签：mysql, sql, join

我有一个查询

```
SELECT foodjoint_id FROM provider_food_joints WHERE foodjoint_name='".$foodjoint_name."'"; 
```

现在我必须从另一个有 foodjoint_id 归档的表中选择所有信息

```
SELECT *  AND foodjoint_name FROM  provider_food_joints  from menu_item where foodjoint_id = THOSE ID 
```

我必须加入这两个

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-30T09:26:04.223

```
SELECT provider_food_joints.*, 
       menu_item.* 
FROM   provider_food_joints 
       INNER JOIN menu_item 
               ON menu_item.foodjoint_id = provider_food_joints.foodjoint_id 
WHERE  provider_food_joints.foodjoint_name = '".$foodjoint_name."' 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-30T09:27:06.817

```
SELECT * FROM  provider_food_joints a join menu_item b 
on a.foodjoint_id = b.foodjoint_id where foodjoint_name='".$foodjoint_name."'" 
```

* * *

## 回答 #3

> 赞同：-3
> 
> 时间：2012-05-30T09:27:38.450

```
SELECT *  AND foodjoint_name FROM  provider_food_joints  
WHERE foodjoint_id IN (SELECT foodjoint_id FROM provider_food_joints WHERE foodjoint_name='".$foodjoint_name."'") 
```

# .htaccess - URL 重写 - htaccess web.config

> ID：10813422
> 
> 赞同：0
> 
> 时间：2012-05-30T09:22:44.657
> 
> 标签：.htaccess, url-rewriting, web-config

我在 IIS 中导入了这些重写规则：

```
RewriteRule ^search/(.+)/([0-9]+)?$ search.html?name=$1&page=$2 [QSA,L]
RewriteRule ^search/(.+)?$ search.html?name=$1&page=1 [QSA,L] 
```

翻译是：

```
match url="^search/(.+)/([0-9]+)?$" ignoreCase="false"
action type="Rewrite" url="search.html?name={R:1}&amp;page={R:2}" appendQueryString="true"

match url="^search/(.+)?$" ignoreCase="false"
action type="Rewrite" url="search.html?name={R:1}&amp;page=1" appendQueryString="true" 
```

但是当我测试时不起作用

HTTP 错误 404.0 - 未找到 - 这是错误

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-30T09:37:58.440

有条件试试，

条件logicalGrouping="MatchAll" trackAllCaptures="false"

（不包括开始和结束标签。）

# ios - 选择德国地区时，Ipad 应用程序不显示小数点后的值

> ID：10813424
> 
> 赞同：1
> 
> 时间：2012-05-30T09:22:52.543
> 
> 标签：ios, region, catextlayer

在我正在开发的应用程序中，我正在处理十进制值。我正在使用 CATextLayer 打印它们。但是，当我们从设备的设置中选择德国地区时，它不会显示小数点后的值。But when US/UK/AUSTRALIA region is selected, it shows values after decimal point. 如果有人遇到过/处理过此类问题，请回复

# jquery - 用 .append() 附加 html 字符串不起作用？

> ID：10813426
> 
> 赞同：0
> 
> 时间：2012-05-30T09:23:04.063
> 
> 标签：jquery

我对 jquery 比较陌生，所以请多多包涵。我创建了一个 HTML 页面，其中包含一些我想添加新元素的钩子。附加字符串按预期工作：

```
$(theParentNode).append ("blurb1"); 
```

但附加 HTML 不会：

```
$(theParentNode).append ("<b>blurb2</b>"); 
```

当我检查生成的 DOM 时，父节点没有子节点。最后，当我尝试这个时：

```
$(theParentNode).append ("blurb1");
$(theParentNode).append ("<b>blurb2</b>");
$(theParentNode).append ("blurb3"); 
```

只有第一个子节点出现在父节点的子节点列表中。最后的实验涉及添加“span”而不是“b”元素。在那种情况下，我从 jquery 得到一个错误：div is null, line 6443 of jquery-1.7.2.js

我必须忽略一些非常基本的东西，但仍然很难为什么它不起作用，因为 append 应该采用 html 字符串......感谢任何帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-30T12:52:30.057

尝试通过它的 ID 来引用它：-

例如：-

`<div id='MyDiv'></div>`

您需要使用：-

`$('#MyDiv').append("<b>blurb2</b>");`

# c# - 类中的 WCF 功能

> ID：10813430
> 
> 赞同：2
> 
> 时间：2012-05-30T09:23:17.323
> 
> 标签：c#, wpf, wcf, data-binding, serialization

我最近将 WPF 应用程序转换为使用 WCF 服务（为相关网站编写，旨在转换应用程序）。

一切都很好，除了我从模型中进行的一些实时数据绑定。

```
public decimal? SalePrice
    {
        get { return _salePrice; }
        set
        {
            _salePrice = value;
            TotalSalesPrice = value + _warranty;
        }
    } 
```

在 References.cs 中，这变成

```
[System.Runtime.Serialization.DataMemberAttribute()]
    public System.Nullable<decimal> SalePrice {
        get {
            return this.SalePriceField;
        }
        set {
            if ((this.SalePriceField.Equals(value) != true)) {
                this.SalePriceField = value;
                this.RaisePropertyChanged("SalePrice");
            }
        }
    } 
```

然后将使用 INotifyPropertyChanged 使表单保持最新。

解决这个问题的最佳方法是什么？

我已经为这个客户端功能编写了一个单独的类，但是有多个这样的类，这似乎是一种非常非语义和漫长的做事方式。我注意到它们是部分的，并试图使它们成为虚拟的，然后有一个 ovveride 客户端，但是虚拟属性在被序列化时被删除了。

非常感谢任何帮助，奥利

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-30T10:24:31.343

您不应将生成的 DataContracts 用于数据绑定。我认为他们在生成的文件上实施 INotifyPropertyChanged 真的很遗憾，因为它鼓励人们做错事

数据契约只是根据服务对数据的视图。这不是您的表单/窗口必然需要的数据视图。

您应该将数据的服务表示视为您的模型，并将您的视图绑定到以最方便的方式呈现数据的 ViewModel。这也意味着随着服务的发展，您的数据绑定不会中断，并且您知道您必须做的所有更改都可以在视图模型中完成

# objective-c - 无法用简单的立方体显示 VBO，似乎是缓冲区的问题

> ID：10813432
> 
> 赞同：0
> 
> 时间：2012-05-30T09:23:22.207
> 
> 标签：objective-c, ios, opengl-es, glkit

试图在 raywenderlich.com 上修改[这个](http://www.raywenderlich.com/5223/beginning-opengl-es-2-0-with-glkit-part-1)OpenGL 和 GLKit 教程，我试图从波前 obj 文件渲染一个立方体，没有每个顶点的颜色信息和表面法线。但是被渲染的东西看起来一点也不像立方体。

![](../Images/d483005d86f3532b45fe895aa192c5aa.png)

为了解析一个 obj 文件，我有一个方法（createDrawable），它通过 obj 并将信息保存到一个结构（Drawable）中，该结构包含四件事：顶点缓冲区、索引缓冲区、对象中的面数和变换矩阵目的。（这里是[头](http://pastebin.com/J2ActMD4)文件、[.m 文件](http://pastebin.com/7JQaSinV)和[.obj 文件](http://pastebin.com/tWqLVzBZ)。）

```
- (Drawable)createDrawable: (NSString *)objFileName {
    ......
    ......

    // Parsed obj and put info in vertexData and indices arrays.

    Drawable _drawable;

    _drawable.numFaces = numFaces;

    glGenBuffers(1, &_drawable.vertexBuffer);
    glBindBuffer(GL_ARRAY_BUFFER, _drawable.vertexBuffer);
    glBufferData(GL_ARRAY_BUFFER, sizeof(vertexData) * numFaces * 8, vertexData, GL_STATIC_DRAW);

    glGenBuffers(1, &_drawable.indexBuffer);
    glBindBuffer(GL_ELEMENT_ARRAY_BUFFER, _drawable.indexBuffer);
    glBufferData(GL_ELEMENT_ARRAY_BUFFER, sizeof(indices) * numFaces * 3, indices, GL_STATIC_DRAW);

    _drawable.matrix = GLKMatrix4Identity;
    _drawable.matrix = GLKMatrix4Translate(_drawable.matrix, 0.0f, 0.0f, 10.0f);

    return _drawable;
} 
```

对于渲染，我使用另一种方法（renderDrawable）绑定对象的缓冲区，设置指向它们的指针，然后使用 glDrawElements(..) 进行渲染。

```
- (void) renderDrawable: (Drawable)object {
    glBindBuffer(GL_ARRAY_BUFFER, object.vertexBuffer);
    glEnableVertexAttribArray(GLKVertexAttribPosition);        
    glVertexAttribPointer(GLKVertexAttribPosition, 3, GL_FLOAT, GL_FALSE, 0, (const GLvoid *) 0);
    glEnableVertexAttribArray(GLKVertexAttribTexCoord1);
    glVertexAttribPointer(GLKVertexAttribTexCoord1, 2, GL_FLOAT, GL_FALSE, 0, (const GLvoid *) 3);
    glEnableVertexAttribArray(GLKVertexAttribNormal);
    glVertexAttribPointer(GLKVertexAttribNormal, 3, GL_FLOAT, GL_FALSE, 0, (const GLvoid *) 5);

    glBindBuffer(GL_ELEMENT_ARRAY_BUFFER, object.indexBuffer);
    glDrawElements(GL_LINES, sizeof(object.indexBuffer) * 3 * object.numFaces, GL_UNSIGNED_BYTE, (const GLvoid *) object.indexBuffer);
} 
```

我认为我对缓冲区（此处显示的 createDrawable 的一部分和 .m 文件中的 renderDrawable 的一部分）做错了，但我就是不知道它是什么。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-30T10:40:42.360

我认为您的问题是您将 GL_LINES 传递给 glDrawElements() 而不是 GL_TRIANGLES。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-30T10:45:37.170

我认为 glVertexArrayPointer 中的“步幅”参数应该设置为 8 * sizeof(float) 例如（单个顶点的大小）

```
glVertexAttribPointer(GLKVertexAttribNormal, 3, GL_FLOAT, GL_FALSE, 8 * sizeof(float), (const GLvoid *) 5); 
```

当步幅为 0 时 - 这意味着属性以连续的方式存储......但是您已经交错了属性，因此您必须向 OpenGL 提供更多信息。

另一个问题：什么是`sizeof(vertexData) * numFaces * 8`......我认为应该是：`sizeof(vertexData) * numFaces * 3`

对于索引缓冲区：`sizeof(indices) * numFaces * 3`-我认为应该是`sizeof(int) * numFaces * 3`

int - 索引类型，但你有 GL_BYTE （这意味着你只能有 256 个不同的索引！）

渲染时：glDrawArrays - 您已绑定索引缓冲区，因此将最后一个参数设置为 NULL

# ruby - rexml page.root.has_elements？说没有元素

> ID：10813433
> 
> 赞同：0
> 
> 时间：2012-05-30T09:23:23.027
> 
> 标签：ruby, rexml

我试图阅读以下文件：

使用以下代码：

```
require 'rexml/document'
include REXML

str = File.read("../pages/prac.xml").gsub(/\s+/, " ")

page = REXML::Document.new(str)
print "no elements\n" if page.root.has_elements?
print "Text: #{page.root.text}\n"
print "Name: #{page.root.name}\n"

page.root.each_element do |parent_tag|
    parent_tag.each_element do |tag|
        if tag.has_elements?
            tag.each_element do |data|
                p data
            end
        else
            puts "#{tag.name}: #{tag.text}"
        end
    end
end 
```

我看到的输出是：

```
no elements
Text:  
Name: html 
```

有人可以通过指出这里有什么问题来帮助我吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-30T21:45:15.460

```
print "no elements\n" if page.root.has_elements? 
```

**page.root.has_elements？**如果根元素有子元素，则返回**true 。**在您的情况下，当根元素找到子元素时，您正在打印“无元素”。它可能应该改为“具有元素”，因为它具有误导性。

其次，来自的输出`page.root.name`是指 XML 文档的根元素的名称，因此在您的情况下会打印出“html”。但是，`page.root.text`返回第一个文本节点（不是子元素的文本），它可能是一个空格，因此似乎不显示任何内容。

# windows-phone-7 - 如何在 bing 地图中使用 gps 获取当前城市名称

> ID：10813435
> 
> 赞同：2
> 
> 时间：2012-05-30T09:23:25.343
> 
> 标签：windows-phone-7, bing-maps, pushpin

我在我的应用程序中使用了 bing 地图，我使用 gps 定位当前位置，我也使用 geoco-ordinatewatcher 获取坐标，并使用图钉固定当前位置。但我的问题是我想获取图钉指向的当前城市和国家/地区名称。我无法使用 map.center 属性来获得它。谁能帮帮我..提前谢谢...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-30T10:40:09.973

以下博客文章应该可以帮助您：-

[http://www.nickharris.net/2010/12/how-to-reverse-geocode-a-location-to-an-address-on-windows-phone-7/](http://www.nickharris.net/2010/12/how-to-reverse-geocode-a-location-to-an-address-on-windows-phone-7/)

不幸的是，CivicAddressResolver 目前未在 Windows Phone 上实现，因此您必须使用基于在线的解决方案。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-30T11:10:54.140

请参考下面的代码

ReverseGeocodeRequest reverseGeocodeRequest = new ReverseGeocodeRequest(); // 使用有效的 Bing 地图密钥设置凭据 reverseGeocodeRequest.Credentials = new GeoCodeService.Credentials(); reverseGeocodeRequest.Credentials.ApplicationId = "你的 bing 地图密钥";

```
 // Set the point to use to find a matching address
        GeoCodeService.Location point = new GeoCodeService.Location();
        point.Latitude = Your lat;
        point.Longitude = Your lng;

        reverseGeocodeRequest.Location = point;

        // Make the reverse geocode request
        GeocodeServiceClient geocodeService = new GeocodeServiceClient("BasicHttpBinding_IGeocodeService");
        geocodeService.ReverseGeocodeCompleted += new EventHandler<ReverseGeocodeCompletedEventArgs>(geocodeService_ReverseGeocodeCompleted);
        geocodeService.ReverseGeocodeAsync(reverseGeocodeRequest); 
```

无效geocodeService_ReverseGeocodeCompleted（对象发送者，ReverseGeocodeCompletedEventArgse）{
字符串文本1；

```
 GeocodeResponse geocodeResponse = e.Result;
            System.Diagnostics.Debug.WriteLine("GeoCode Response is :"+geocodeResponse);
            if (geocodeResponse.Results.Count() > 0)
               text1  = geocodeResponse.Results[0].DisplayName;
            else
                text1 = "No Results found";
            textBlock1.Text = text1;
            System.Diagnostics.Debug.WriteLine("Location is :"+text1);
    } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-30T10:42:12.517

无法从设备上的纬度/经度坐标解析位置。
这样做需要设备附带所有地点的数据库来进行查找。这样的数据库将是巨大的，并且存在保持更新的问题。

# android - EditText setOnKeyListener 中的问题

> ID：10813436
> 
> 赞同：1
> 
> 时间：2012-05-30T09:23:27.177
> 
> 标签：android

我有一个`EditText`. 在 a`setOnKeyListener`上`EditText`，我想执行以下操作。

1.  单击键盘的完成按钮后，我想在我的`TextView`.

2.  单击其他按钮而不是完成按钮时，我想`TextView`留空。

因此，为此，我编写了代码，但它适用于单击完成按钮，但不适用于其他按钮。那么任何人都可以帮我解决这个问题吗？

**我的代码**

```
EditText.setOnKeyListener(new OnKeyListener() 
{
    public boolean onKey(View v, int keyCode, KeyEvent event) 
    {           
        if ((event.getAction() == KeyEvent.ACTION_DOWN) && (keyCode == KeyEvent.KEYCODE_ENTER))
        {                             
            m_passwrdErrorText.setText(m_res.getString(R.string.passwrd_error_text));
        }
        else
        {
            m_passwrdErrorText.setText("");
        }
        return false;
    }
}); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-30T09:27:15.413

可以尝试

```
editText.setOnEditorActionListener(new OnEditorActionListener() {
    @Override
    public boolean onEditorAction(TextView v, int actionId, KeyEvent event) {
        if (actionId == EditorInfo.IME_ACTION_DONE) {
            // do your stuff here
        }
        return false;
    }
}); 
```

# android - 当我单击gridview中的任何图像项目时，如何全屏显示图像？

> ID：10813443
> 
> 赞同：1
> 
> 时间：2012-05-30T09:23:38.610
> 
> 标签：android, image, gridview

我有一个 T 恤图像列表，它显示在网格视图中。现在我要做的是，当我在网格视图中单击图像的任何项目时，全屏显示图像。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-30T09:42:10.963

实现此目的的一种方法是：制作显示来自画廊的图像的意图：因为该代码是：

```
intent = new Intent(Intent.ACTION_PICK, android.provider.MediaStore.Images.Media.EXTERNAL_CONTENT_URI);
 startActivityForResult(intent, TFRequestCodes.GALLERY); 
```

之后覆盖 onActivityResult() 方法：

```
@Override
    protected void onActivityResult(int requestCode, int resultCode, Intent data) {

        } 
```

在该方法中，您可以获得图像 id 以及您想要获取的任何内容：您还可以在您的活动中显示它：

# java - JPA：定义复杂的@OneToMany 关系

> ID：10813448
> 
> 赞同：0
> 
> 时间：2012-05-30T09:23:48.993
> 
> 标签：java, jpa, entity-relationship, one-to-many

我已经定义了一组表 t1, t2, ... tN：

```
mysql>  desc t1;
+-------------+------------------+------+-----+---------+----------------+
| Field       | Type             | Null | Key | Default | Extra          |
+-------------+------------------+------+-----+---------+----------------+
| id          | int(10) unsigned | NO   | PRI | NULL    | auto_increment |
(...)
+-------------+------------------+------+-----+---------+----------------+

(...)

mysql>  desc tN;
+-------------+------------------+------+-----+---------+----------------+
| Field       | Type             | Null | Key | Default | Extra          |
+-------------+------------------+------+-----+---------+----------------+
| id          | int(10) unsigned | NO   | PRI | NULL    | auto_increment |
(...)
+-------------+------------------+------+-----+---------+----------------+ 
```

和一个表，它将存储关于表 t1，... tN 中每个记录的一些**注释**：

```
 mysql> desc postit;

+---------------+------------------+------+-----+---------+----------------+
| Field         | Type             | Null | Key | Default | Extra          |
+---------------+------------------+------+-----+---------+----------------+
| id            | int(10) unsigned | NO   | PRI | NULL    | auto_increment |
| foreign_id    | int(10) unsigned | NO   | MUL | NULL    |                |
| foreign_table | varchar(20)      | NO   | MUL | NULL    |                |
| content       | text             | NO   |     | NULL    |                |
(....)
+---------------+------------------+------+-----+---------+----------------+ 
```

现在我应该如何为表't1'定义一个@Entity ....

```
@Entity(name="T1")
@Table(name="t1")
public class T1
    {
        (...)
        public List<PostIt> getComments() { ... }
        } 
```

从表'postit'中检索其所有评论，因为表达式应该是

```
select P from postit as P where P.foreign_table="t1" and P.foreign_id= :t1_id 
```

是否有特定的 JPA 注释来定义这种关系，或者我应该在 T1 的每个实例中注入（如何？）一个**EntityManager**并调用 @NamedQuery ？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-30T11:47:13.007

我认为您应该使用[继承](http://openjpa.apache.org/builds/1.1.0/docs/jpa_overview_mapping_discrim.html)对表进行建模。

这样你就有了 AbstractTable

```
@Entity
@DiscriminatorColumn(name="type_id")
@DiscriminatorValue("-1")
...
class AbstractTable {

@OneToMany(mappedBy="foreign_id")
public List<PostIt> getComments() { ... }
        }
...
} 
```

并且：

```
@Entity
@DiscriminatorValue("1")
...
class Table1 {}

@Entity
@DiscriminatorValue("2")
...
class Table2 {} 
```

如果您需要双向关系，那么您需要弄清楚如何从 Postit 实体引用表。我觉得有点像

```
@ManyToOne
public AbstractTable getTable() { ... } 
```

应该管用。

更多信息可以在这里找到[http://wleeper.com/2009/12/17/jpa-onetomany-with-inheritance/](http://wleeper.com/2009/12/17/jpa-onetomany-with-inheritance/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-30T11:48:53.120

您的设计对应于继承树，其中根 AbstractComment 实体的所有子类都将存储在同一个表中，使用鉴别器列 ( `foreign_table`)：

```
@Entity
@Table(name = "postit")
@Inheritance(strategy = SINGLE_TABLE)
@DiscriminatorColumn(name = "foreign_table", discriminatorType = STRING)
public abstract class AbstractComment {
    // ... fields, getters, setters
}

@Entity
@DiscriminatorValue("t1")
public class T1Comment extends AbstractComment {

}

@Entity
@Table(name="t1")
public class T1 {
    @OneToMany
    @JoinColumn(name = "foreign_id")
    private Set<T1Comment> comments;
} 
```

# java - 在 Android 应用程序中使用 http post

> ID：10813451
> 
> 赞同：0
> 
> 时间：2012-05-30T09:24:00.473
> 
> 标签：java, android, http-post, httpclient

我需要在我的应用程序中做简单的 http post。

找到示例并创建`AsyncTask`类。post的主要代码是这样的：

`nameValuePairs`- 是帖子元素

```
HttpClient httpclient = new DefaultHttpClient();
HttpPost httppost = new HttpPost(URL_STRING);
httppost.setEntity(new UrlEncodedFormEntity(nameValuePairs, HTTP.UTF_8));
HttpResponse response = httpclient.execute(httppost);
String data = new BasicResponseHandler().handleResponse(response); 
```

我是怎么得到这个异常的

```
org.apache.http.client.HttpResponseException: Forbidden 
```

这是什么意思？如果该服务返回此内容，那么如何查看完整消息？

另外，如果有其他方法可以制作 http 帖子，我可以试试 :)

谢谢你们的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-30T09:48:41.913

异常`org.apache.http.client.HttpResponseException`表示非 2xx HTTP 响应，如下所述：http: [//hc.apache.org/httpcomponents-client-ga/httpclient/apidocs/org/apache/http/client/HttpResponseException.html](http://hc.apache.org/httpcomponents-client-ga/httpclient/apidocs/org/apache/http/client/HttpResponseException.html)。

您可以使用简单的 httpPOST 方法，如下所示：

```
 HttpClient httpclient = new DefaultHttpClient();    
         HttpPost httppost = new HttpPost("http://Your URL/");      
        try {        
         // Add your data        
         List<NameValuePair> nameValuePairs = new ArrayList<NameValuePair>(3);        
         nameValuePairs.add(new BasicNameValuePair("Name1", "Value1"));        
         nameValuePairs.add(new BasicNameValuePair("Name2", "Value2"));     
         nameValuePairs.add(new BasicNameValuePair("Name3", "Value3"));    

          httppost.setEntity(new UrlEncodedFormEntity(nameValuePairs));          
        // Execute HTTP Post Request        
         HttpResponse response = httpclient.execute(httppost);             
         } 
        catch (ClientProtocolException e) 
        {       
         // TODO Auto-generated catch block    
         } 
        catch (IOException e) 
        {         
        // TODO Auto-generated catch block  
          } 
```

# python - 当我们使用 python-netaddr 获得子网和 IPv4 地址时，如何获取 IP 前缀？

> ID：10813454
> 
> 赞同：5
> 
> 时间：2012-05-30T09:24:09.393
> 
> 标签：python, ip, python-2.7, ip-address, inetaddress

我正在使用 python-netaddr 库来处理 IP 地址和子网。我阅读了完整的 netaddrd 文档：[Netaddr 文档](http://code.google.com/p/netaddr/wiki/IPTutorial#Representing_IP_Subnets)。但没有找到任何解决我的问题的方法。我有一个 IP 地址和子网，我想通过使用它们来获取该 IP 的前缀。这样我就可以打印所有进入子网的 ip。

例如：

```
Ip Address: 192.0.2.0
Subnet Network: 255.255.255.0

It should return the prefix which is : 24 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-30T09:35:06.517

要获得 24，您可以使用以下代码段

```
ip = IPNetwork('192.0.2.0/255.255.255.0')
print ip.prefixlen 
```

但是，如果您想要子网中所有地址的列表，则使用起来更容易：

```
ip = IPNetwork('192.0.2.0/255.255.255.0')
list(ip) 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-02-25T02:43:54.850

使用给定的网络掩码，我们可以使用以下函数获取前缀：

```
def getPrefix(mask):
    prefix = sum([bin(int(x)).count('1') for x in mask.split('.')])
    return prefix 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-02-24T09:56:41.193

```
def getPrefix(binary):
    prefixCount=0
    for i in (str(binary)):
        if(i == '1'):
            prefixCount+=1
    return prefixCount 
```

如果子网转换为二进制格式并在输入中给出，这将返回您的“前缀计数”。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-06-03T00:38:42.677

子网掩码是：255.255.255.0 这就是 ic it：1。1\. 1\. 0

255 是所有 8 位都打开。IE。全部为 1。0 是所有 8 位都关闭。如果您查看此子网掩码 [255.255.255.0]，前 3 个八位字节全部变为“开启”，而最后一个八位字节变为“关闭”。
因此，计算在这种情况下为 ON 的所有八位字节，我们可以说 3 个八位字节： 255.255.255.0 1 。1\. 1 .0 8 + 8 + 8 + 0 =24

# ios - 在移动设备上运行的 Phonegap/Cordova

> ID：10813455
> 
> 赞同：0
> 
> 时间：2012-05-30T09:24:12.443
> 
> 标签：ios, cordova

如何测试网站是否在移动设备上运行？什么相当于旧的 Phonegap.available？由于我从 PhoneGap 1.3.0 切换到 Cordova 1.7.0 它不起作用，我尝试了。

```
window.cordova 
```

但这在桌面浏览器上也返回 true。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-30T10:04:35.570

是`device.cordova`。请参阅[此处的参考](http://docs.phonegap.com/en/1.7.0/cordova_device_device.md.html#device.cordova)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-30T12:14:36.903

您还可以为 创建一个事件`deviceready`，该事件仅在应用程序从移动设备运行时才会发生：

```
document.addEventListener("deviceready", onDeviceReady, false);

function onDeviceReady()
{
    alert("We're mobile!");
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-06-07T14:40:33.017

只是如果有人谷歌它：

```
PhoneGap.available 
```

替换为：

```
device.available 
```

# node.js - 在 node.js 中接收 XMLHttp Body

> ID：10813460
> 
> 赞同：0
> 
> 时间：2012-05-30T09:24:18.773
> 
> 标签：node.js, web, xmlhttprequest

我有 JavaScript 代码向我的 Node.js 应用程序发布 XMLHttp 请求。

我设法使用快递轻松接收请求。但是，我无法使用 bodyParser() 读取 POST 请求的正文。访问 req.body 时，它只是“未定义”或“{}”。

我怎么可能这样做？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-31T02:00:00.603

1.x中连接的`bodyParser`中间件（或`multipart`2.x 中的中间件）的文档说

> 作为安全措施，文件存储在单独的对象中，存储为`req.files`. 这可以防止可能改变文件名的攻击，并根据应用程序获得对受限文件的访问权限。

尝试

```
req.files.pic 
```

# sql - 在 VARCHAR 中使用 max 以获得结果 > 999999？

> ID：10813467
> 
> 赞同：2
> 
> 时间：2012-05-30T09:24:50.347
> 
> 标签：sql, oracle, numbers, max, varchar

如果有人将一列设为 VARCHAR2(256 CHAR) 并且该列中只有数字怎么办。我想得到最高的数字。问题是：数字大于 999999，但是 varchar 的 Max 总是给我一个 999999 的最大数字

我试过`to_number(max(numbers), '9999999999999')`了，但我还是得到了 999999，那不可能。有任何想法吗？谢谢

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-30T09:26:18.040

最好的方法是

**第一个解决方案** 将列转换为数字

或者

**第二种解决方案** 将您查询中的数据转换为数字而不是获取数据...

*例子*

```
 select max(col1) from(
  select to_number(numbers) as col1 from table ) d 
```

必须这样，因为如果您在 TO_NUMBER() 之前调用 MAX()，它将按字母顺序排序，然后 999999 大于 100000000000。请注意，将 TO_NUMBER() 应用于 varchar2 列会产生 INVALID_NUMBER 异常的风险，应该包含任何非数字字符的列。这就是为什么首选提出的第一个解决方案。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-05-30T11:58:18.430

在 Oracle 中，NUMBER 类型包含基数为 100 的浮点值，其精度为 38 位有效数字，最大值为 9999...(38 9's) x 10^125。有两个问题 - 第一个是 NUMBER 是否可以包含从 256 字符串转换的值，第二个是是否可以区分两个在数字方面“接近”的值。

让我们从一个 256 个字符的字符串开始，并尝试将其转换为数字。显而易见的事情是：

```
SELECT TO_NUMBER('9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999') AS VAL
  FROM DUAL; 
```

执行上面我们得到：

```
ORA-01426: numeric overflow 
```

我们之前已经注意到了，这是我们预期的。NUMBER 可以处理的最大指数是 125 - 这里我们尝试转换具有 256 个有效数字的值。NUMBER 无法处理此问题。如果我们将位数减少到 125，如下所示：

```
SELECT TO_NUMBER('99999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999') AS VAL
  FROM DUAL; 
```

它工作正常，我们的答案是 1E125。

<*眨眼*>

哇！等待！！什么？？？答案是**1** x 10^125？？？那些9的呢？！？！？！？

记得之前我提到过，Oracle NUMBER 是一个*浮点值*，最大精度为 38，最大指数为 125。从 TO_NUMBER 125 的角度来看，所有串在一起的 9 不能精确表示 - 数字太多（请记住，最大精度为 38（稍后会详细介绍））。所以它尽其所能 - 它转换前 38 位数字（全部为 9），然后说“我应该如何最好地舍入它以使结果 A）代表输入和 B）尽可能接近我能得到我得到的东西吗？”。在这种情况下，它查看数字 39，发现它是 9，并决定向上舍入。由于所有其他数字也是 9，因此它继续整齐地四舍五入，直到以 1 作为剩余尾数位结束。

*** 稍后，回到牧场…… ***

好的，之前我提到过 NUMBER 的精度为 38 位。这并不*完全*正确 - 它实际上可以区分高达 40 位精度的值，至少有时，如果风是正确的，并且你正在走下坡路。这是一个例子：

```
SELECT CASE
         WHEN to_number('9999999999999999999999999999999999999999') >
              to_number('9999999999999999999999999999999999999998')
           THEN 'Greater'
           ELSE 'Not greater'
       END AS VAL
  FROM DUAL; 
```

这两个值各有 40 位（计数留给极度无聊的读者作为练习:-)。如果执行上述操作，您将返回**'Greater'**，表明两个 40 位数值的比较成功。

现在找点乐子。如果您在每个字符串中添加一个额外的“9”，生成一个 41 位的值，然后重新执行该语句，它将返回“Not greater”。

<*眨眼*>

等待！什么？？哇！！！这些价值观*明显*不同！即使是 TotalFool (tm) 也能看到！！

这里的问题是 41 位数字超过了 NUMBER 类型的精度，因此当 TO_NUMBER 发现它有这么长的值时，它开始丢弃右侧的数字。因此，即使这两个非常大的数字对你和我来说**显然**不同，但一旦它们被折叠、纺锤、残缺和转换，它们就根本没有什么不同。

那么，这里的要点是什么？

1 - 对于 OP 的原始问题 - 除了使用 NUMBER 之外，您还必须想出另一种方法来比较您的数字字符串，因为 Oracle 的 NUMBER 类型不能容纳 256 个数字值。我建议您通过确保所有值的长度均为 256 位来规范化字符串，根据需要在左侧添加零，然后字符串比较应该可以正常工作。

2 - 浮点数通过否定证明（你最喜欢的神/神）的存在，因为它们显然是（你最喜欢的邪恶拟人化）的作品。每当你与他们一起工作时（我们迟早都必须这样做），你应该记住，他们是恶毒的恶毒副产品，等着在你最意想不到的时候攻击你。

3 - 没有*第三*点！（对于那些*无需借助颅外搜索引擎*就可以识别的人，还有额外的功劳：-）

分享和享受。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-05-30T10:01:01.603

如果您的意思是列中的数字可能*很大*（256 位），您可以尝试这样的操作：

```
SELECT numbers
FROM (
  SELECT numbers
  FROM *table_name*
  ORDER BY LPAD(numbers, 256) DESC
)
WHERE rownum = 1 
```

或像这样：

```
SELECT LTRIM(MAX(LPAD(numbers, 256))) AS numbers
FROM *table_name* 
```

# android - Android数据后端单向同步

> ID：10813471
> 
> 赞同：3
> 
> 时间：2012-05-30T09:25:02.433
> 
> 标签：android, data-synchronization

我创建了一个监控应用程序：

*   如果有可用的网络连接：她使用 json 定期向服务器发送测量数据
*   如果没有可用的网络，她将数据存储在 sd 卡中，并在网络连接恢复时发送。

实际上我在内存中使用了一个循环缓冲区，当发送数据时我将其清空

框架中是否已经有一些有用的东西，或者我必须完整地写出来？

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-28T22:29:44.283

我会从广场检查[磁带](http://square.github.com/tape/)库。我从未尝试过，但看起来你正在寻找什么。

# asp.net - 如何在外部 SQL Server 上使用 ASP.NET 配置？

> ID：10813476
> 
> 赞同：0
> 
> 时间：2012-05-30T09:25:15.743
> 
> 标签：asp.net, configuration

在 Visual Studio 中，可以很好地管理 ASP.NET 站点的用户和成员资格。我将成员资格数据从 SQLEXPRESS 移至普通 SQL 服务器。该网站运行良好，但是我现在如何管理我的用户/配置文件/等...就像我在 Visual Studio 中习惯的那样？是否可以告诉 vs2010 “查看”新的 sql server 数据库而不是 apsnetdb.mdf 文件？

谢谢，

埃里克

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-30T09:34:59.823

我就是这样做的：

在您的 web.config 文件中，在 connectionStrings 部分下，将您的连接字符串命名为`LocalSqlServer`，即

```
<connectionStrings>
    <remove name="LocalSqlServer" />
    <add name="LocalSqlServer" connectionString="Server=123.123.123.123;Database=dbName;User ID=dbuser;Password=dbPassword;Trusted_Connection=False;" />
</connectionStrings> 
```

您的角色和成员资格提供者（如果有`connectionStringName`设置）将它们更改为`LocalSqlServer`否则，默认提供者“应该”自动引用`LocalSqlServer`。

在 VS2010 中，我只需转到项目 > ASP.NET 配置，这将启动工具来管理用户、角色等。

高温高压

# sql - 新表或使用逗号？

> ID：10813479
> 
> 赞同：2
> 
> 时间：2012-05-30T09:25:22.623
> 
> 标签：sql, sql-server, database

我想了解您对此的建议：

对产品类别使用逗号

![在此处输入图像描述](../Images/f6b74d7bbf801ac65b0bb09e0cbdda24.png)

或创建第三张桌子。

![在此处输入图像描述](../Images/a5dcc642b068832bdcdf93ac1cc527cc.png)

哪个更有用？

非常感谢您的建议。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-30T09:26:42.590

创建第三张桌子绝对是更好的选择。

使用逗号分隔的值只会在以后给您带来问题。它还会使编写 SQL 查询变得比他们需要的复杂得多，并且为此付出了性能代价。

# android - 是否可以在 android 设备和另一个 NFC 设备之间使用 Android Beam？

> ID：10813483
> 
> 赞同：10
> 
> 时间：2012-05-30T09:25:34.273
> 
> 标签：android, nfc, android-beam

我想在我的 Android 应用和支持 NFC 的信息亭之间实现 NFC 通信。我已阅读[文档](http://developer.android.com/guide/topics/nfc/nfc.html)，并且了解推送数据可以通过两种方式完成：

*   通过前台 NDEF 推送 API 级别 10 到 13
*   通过 API 级别 14 的 Android Beam

我想我可以通过第一个解决方案做我想做的事，但我想知道是否可以在 Android 设备和非 Android 设备之间使用 Android Beam？

谢谢你的帮助，

罗曼

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-05-30T19:49:25.930

虽然 API 10 到 13 和 APi 14 之间的函数调用不同，但实际的底层协议几乎相同。在这两种情况下，NFC 点对点通信都是使用 LLCP 完成的。在 API 10 到 13 中，实际使用的数据传输协议是 NPP。在 API 14 中，将 SNEP 添加到其中，但当其他设备不支持 SNEP 时，它将回退到 NPP。

因此，当您的非 Android 设备通过 LLCP 实现 SNEP 和/或 NPP 时，它可以将数据传输到 Android NFC 设备并从其接收数据。存在几种用于读卡器设备的 SNEP 和 LLCP 实现，例如参见[https://github.com/grundid/nfctools](https://github.com/grundid/nfctools)。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-30T10:38:44.053

我调查了这个大学项目。

首先请注意，NFC 操作有 3 种模式{卡读/写、标签仿真和 P2P 通信}。Android 支持 Card 读/写和 P2P 通信。

通过 P2P 与非 Android 设备进行通信非常复杂，因为您必须使用基于 LLCP（逻辑链路控制协议）构建的 NPP（Ndef 推送协议）。您的非 android 平台需要实现 LLCP 才能进行通信。我不确定这是否已经为 NFC 完成。可在[此处找到有关 NPP/LLCP 实施的信息](http://static.googleusercontent.com/external_content/untrusted_dlcp/source.android.com/en//compatibility/ndef-push-protocol.pdf)

下一种方法是使用卡读/写模式与运行在卡模拟模式下的非 Android 设备进行通信。通过这种方式，您可以将 APDU 发送到仿真标签以发送和接收数据。我在我的项目中使用 BlackBerry 反向执行了这种方法。黑莓支持卡模拟，所以我使用非 Android 设备 (ACR122U) 将 APDU 发送到黑莓。

虽然第一种方法 (P2P) 显然是理想的方法，但第二种方法可能更容易实施。无论如何，它在我的应用程序中运行良好，我创建了一个通过 NFC 接受付款的系统。

请注意，ACR122U 对 NFC 标签仿真没有很好的支持，因此不适合您。LibNFC网站是寻找支持标签仿真的设备的良好开端[。](http://www.libnfc.org/)

我现在完成了这个项目，使用 ACR122U 设备效果很好。如果您在第二种方法上需要任何帮助，请询问。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-10-26T07:47:53.357

请参阅以下问题 28014：启用真正的 NFC p2p 通信和禁用“Touch to Beam”UI 的选项
[https://code.google.com/p/android/issues/detail?id=28014](https://code.google.com/p/android/issues/detail?id=28014) Android Peer to Peer 不起作用一点也不。

# android - 在不使用相机的情况下解码 QRcode 图像

> ID：10813484
> 
> 赞同：0
> 
> 时间：2012-05-30T09:25:48.907
> 
> 标签：android, qr-code, zxing

伙计们，我正在开发一个用于读取 QR 码的 Android 应用程序。我实现了库 ZXing，但我不能使用相机。我需要获取保存为图像的二维码并使用与 ZXing 解码存储为图像的二维码相关的功能......有什么想法吗？

我检查了论坛，但我需要更完整的东西..：（

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-04T14:34:51.643

是的，您可以在不使用相机的情况下解码 QR。您必须从图库中导入图像，获取位图并将其传递给`LuminanceSource source = new RGBLuminanceSource(bMap);` 这里是代码。

```
LuminanceSource source = new RGBLuminanceSource(bMap); 
BinaryBitmap bitmap = new BinaryBitmap(new HybridBinarizer(source));
Reader reader = new MultiFormatReader();
try {
    Result result = reader.decode(bitmap);
    String contents = result.getText(); 
    byte[] rawBytes = result.getRawBytes(); 
    BarcodeFormat format = result.getBarcodeFormat(); 
    ResultPoint[] points = result.getResultPoints();
} catch (NotFoundException e) {
    e.printStackTrace();
    return;
} catch (ChecksumException e) {
    e.printStackTrace();
    return;
} catch (FormatException e) {
    e.printStackTrace();
    return;
} 
```

# php - Facebook PHP/JS SDK“会话已在 unix 时间过期”，具有长寿命令牌

> ID：10813488
> 
> 赞同：7
> 
> 时间：2012-05-30T09:25:53.637
> 
> 标签：php, facebook, facebook-graph-api

我正在尝试使用存储的长寿命访问令牌，但 2 小时后我从图形 API 收到以下错误。我已经编写了一些代码来将用户发送到 Facebook 以获取可以交换访问令牌的新代码，它工作得很好，除了在每个后续页面请求中都会发生这种情况，Facebook 继续使我的访问令牌无效，并出现以下错误，尽管他们的服务器返回了访问令牌。

```
Error validating access token: Session has expired at unix time 1338300000\. The current unix time is 1338369365. 
```

完整的测试页示例如下。出于明显的原因省略了我的密钥。点击页面，登录，然后离开几个小时，然后再次点击页面（您将重定向到 facebook 并返回 url 中的代码），重新加载页面，它将继续重定向到 facebook 并返回, 事件虽然我告诉它使用它刚刚为所述代码返回的访问令牌。

```
<?php
  require 'facebook.php';

  $app_id = APP_ID;
  $app_secret = APP_SERCRET;
  $my_url = URL;

  $facebook = new Facebook(array(
    'appId'   => $app_id,
    'secret'  => $app_secret
  ));

  // known valid access token stored in a database
  $access_token = isset($_COOKIE["FB_LONG_AC_TOKEN"]) ? $_COOKIE["FB_LONG_AC_TOKEN"] : false;

  $code = $_REQUEST["code"];

  // If we get a code, it means that we have re-authed the user
  //and can get a valid access_token.
  if (isset($code)) {
    $token_url="https://graph.facebook.com/oauth/access_token?client_id="
      . $app_id . "&redirect_uri=" . urlencode($my_url)
      . "&client_secret=" . $app_secret
      . "&code=" . $code . "&display=popup";
    $response = file_get_contents($token_url);
    $params = null;
    parse_str($response, $params);
    $access_token = $params['access_token'];
  }

  // Attempt to query the graph:
  $graph_url = "https://graph.facebook.com/me?"
    . "access_token=" . $access_token;
  $response = curl_get_file_contents($graph_url);
  $decoded_response = json_decode($response);

  //Check for errors
  if ($decoded_response->error) {
  // check to see if this is an oAuth error:
    if ($decoded_response->error->type== "OAuthException") {
      // Retrieving a valid access token.
      $dialog_url= "https://www.facebook.com/dialog/oauth?"
        . "client_id=" . $app_id
        . "&redirect_uri=" . urlencode($my_url);
      echo("<script> top.location.href='" . $dialog_url
      . "'</script>");
    }
    else {
      echo "other error has happened";
    }
  }
  else {
  // success
    echo("Success: ".$decoded_response->name."<br />");
    echo($access_token."<br />");

    // Attempt to convert access token to longlife token if we don't have one stored.
    if (!isset($_COOKIE["FB_LONG_AC_TOKEN"]))
    { // don't have long life token, so let's get one.
      $ch = curl_init("https://graph.facebook.com/oauth/access_token?client_id=".$app_id."&client_secret=".$app_secret."&grant_type=fb_exchange_token&fb_exchange_token=".$access_token);
      curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);
      curl_setopt($ch, CURLOPT_CONNECTTIMEOUT, 5);
      curl_setopt($ch, CURLOPT_TIMEOUT, 10);
      $data = curl_exec($ch);
      curl_close($ch);

      $params = null;
      parse_str($data, $params);

      if (isset($params["access_token"]))
      {
        $access_token = $params["access_token"];

        echo("Got long life token.<br />");
        setcookie("FB_LONG_AC_TOKEN", $access_token, time() + (3600 * 24 * 60), "/");
      }
    }
    else {
      echo("Have long life token already.<br />");
    }
  }

  if ($access_token) {
    $facebook->setAccessToken($access_token);

    // See if there is a user from a cookie
    $user = $facebook->getUser();

    if ($user) {
      try {
        // Proceed knowing you have a logged in user who's authenticated.
        $user_profile = $facebook->api('/me');
      } catch (FacebookApiException $e) {
        echo '<pre>'.htmlspecialchars(print_r($e, true)).'</pre>';
        $user = null;
      }
    }
  }

  // note this wrapper function exists in order to circumvent PHP’s
  //strict obeying of HTTP error codes.  In this case, Facebook
  //returns error code 400 which PHP obeys and wipes out
  //the response.
  function curl_get_file_contents($URL) {
    $c = curl_init();
    curl_setopt($c, CURLOPT_RETURNTRANSFER, 1);
    curl_setopt($c, CURLOPT_URL, $URL);
    $contents = curl_exec($c);
    $err  = curl_getinfo($c,CURLINFO_HTTP_CODE);
    curl_close($c);
    if ($contents) return $contents;
    else return FALSE;
  }
?>
<!doctype html>
<html xmlns:fb="http://www.facebook.com/2008/fbml">
<head>
    <title>Facebook Auth</title>
</head>
<body>
  <?php if ($user) { ?>
    Your user profile is
    <pre>
      <?php print htmlspecialchars(print_r($user_profile, true)) ?>
    </pre>
  <?php } else { ?>
    <fb:login-button></fb:login-button>
  <?php } ?>

  <div id="fb-root"></div>
  <script>
      window.fbAsyncInit = function () {
        FB.init({
          appId: <?php echo($app_id); ?>,
          cookie: true, // enable cookies to allow the server to access the session
          oauth: true, // enable OAuth 2.0
          xfbml: true  // parse XFBML
        });

        FB.getLoginStatus(function (res) {
          console.log(res.status);
        });
      };

      (function(d){
        var js, id = 'facebook-jssdk'; if (d.getElementById(id)) {return;}
        js = d.createElement('script'); js.id = id; js.async = true;
        js.src = "//connect.facebook.net/en_US/all.js";
        d.getElementsByTagName('head')[0].appendChild(js);
      }(document));
  </script>
</body>
</html> 
```

我究竟做错了什么？或者这是 Facebook 的问题？

**更新：**

我已经更新了我的代码以遵循@cpilko 发布的流程，但是我仍然遇到同样的问题。我可以很好地登录和退出。但是，如果我在几个小时后访问测试页面，比如说第二天我使用提供的长寿命访问令牌（FB JS SDK 认为我已连接，但服务器没有），我得到了 Session expired 异常，我刷新页面并我显示为服务器和 FB JS SDK 都已登录，并且我从 facebook 获得的长寿令牌与我最初尝试的令牌相同（存储在我的 cookie 中）。我不明白的是为什么我第一次无法使用长寿令牌。更新了下面的代码。

```
<?php
  require 'facebook.php';

  $app_id = "XXXXXXXXXXXXX";
  $app_secret = "XXXXXXXXXXXXXXXXXXXX";
  $my_url = "http://swan.magicseaweed.local/facebook/";

  $facebook = new Facebook(array(
    'appId'   => $app_id,
    'secret'  => $app_secret
  ));

  $valid_user = false;

var_dump($_COOKIE);
echo("<br />");

  if (isset($_COOKIE["FB_LONG_AC_TOKEN"]))
  { // Have long term token, attempt to validate.
    // Attempt to query the graph:
    $graph_url = "https://graph.facebook.com/me?"
      . "access_token=" . $_COOKIE["FB_LONG_AC_TOKEN"];
    $response = curl_get_file_contents($graph_url);
    $decoded_response = json_decode($response);

    // If we don't have an error then it's valid.
    if (!$decoded_response->error) {
      $valid_user = true;
      $access_token = $_COOKIE["FB_LONG_AC_TOKEN"];
      echo("Have long life token.<br />");
    }
    else {
      // Stored token is invalid.
      // Attempt to renew token.

      // Exchange short term token for long term.
      $ch = curl_init("https://graph.facebook.com/oauth/access_token?client_id=".$app_id."&client_secret=".$app_secret."&grant_type=fb_exchange_token&fb_exchange_token=".$facebook->getAccessToken());
      curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);
      curl_setopt($ch, CURLOPT_CONNECTTIMEOUT, 5);
      curl_setopt($ch, CURLOPT_TIMEOUT, 10);
      $data = curl_exec($ch);
      curl_close($ch);

      $params = null;
      parse_str($data, $params);

      if (isset($params["access_token"]))
      {
        $access_token = $params["access_token"];

        echo("Got long life token.<br />");
        setcookie("FB_LONG_AC_TOKEN", $access_token, time() + (3600 * 24 * 60), "/");
      }
      else
      { // Clear invalid token.
        setcookie("FB_LONG_AC_TOKEN", "false", time() - 3600, "/");
        echo("Long life token invalid.<br />");
      }
    }
  }
  else if ($facebook->getUser())
  { // Have short term access token.
    // Verify short term token is valid still.
    try {
        // Proceed knowing you have a logged in user who's authenticated.
        $user_profile = $facebook->api('/me');
    }
    catch (FacebookApiException $e) { }

    if (is_array($user_profile)) { // Have user.
      $valid_user = true;

      // Exchange short term token for long term.
      $ch = curl_init("https://graph.facebook.com/oauth/access_token?client_id=".$app_id."&client_secret=".$app_secret."&grant_type=fb_exchange_token&fb_exchange_token=".$facebook->getAccessToken());
      curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);
      curl_setopt($ch, CURLOPT_CONNECTTIMEOUT, 5);
      curl_setopt($ch, CURLOPT_TIMEOUT, 10);
      $data = curl_exec($ch);
      curl_close($ch);

      $params = null;
      parse_str($data, $params);

      if (isset($params["access_token"]))
      {
        $access_token = $params["access_token"];

        echo("Got long life token.<br />");
        setcookie("FB_LONG_AC_TOKEN", $access_token, time() + (3600 * 24 * 60), "/");
      }
    }
  }

  if ($access_token) {
    $facebook->setAccessToken($access_token);

    // See if there is a user from a cookie
    $user = $facebook->getUser();

    if ($user) {
      try {
        // Proceed knowing you have a logged in user who's authenticated.
        $user_profile = $facebook->api('/me');
      } catch (FacebookApiException $e) {
        echo '<pre>'.htmlspecialchars(print_r($e, true)).'</pre>';
        $user = null;
      }
    }
  }

  // note this wrapper function exists in order to circumvent PHP’s
  //strict obeying of HTTP error codes.  In this case, Facebook
  //returns error code 400 which PHP obeys and wipes out
  //the response.
  function curl_get_file_contents($URL) {
    $c = curl_init();
    curl_setopt($c, CURLOPT_RETURNTRANSFER, 1);
    curl_setopt($c, CURLOPT_URL, $URL);
    $contents = curl_exec($c);
    $err  = curl_getinfo($c,CURLINFO_HTTP_CODE);
    curl_close($c);
    if ($contents) return $contents;
    else return FALSE;
  }
?>
<!doctype html>
<html xmlns:fb="http://www.facebook.com/2008/fbml">
<head>
    <title>Facebook Auth</title>
</head>
<body>
  <?php if ($user) { ?>
    Your user profile is
    <pre>
      <?php print htmlspecialchars(print_r($user_profile, true)) ?>
    </pre>
  <?php } else { ?>
    <fb:login-button></fb:login-button>
  <?php } ?>

  <div id="fb-root"></div>
  <script>
      window.fbAsyncInit = function () {
        FB.init({
          appId: <?php echo($app_id); ?>,
          cookie: true, // enable cookies to allow the server to access the session
          oauth: true, // enable OAuth 2.0
          xfbml: true  // parse XFBML
        });

        FB.getLoginStatus(function (res) {
          console.log(res.status);
        });
      };

      (function(d){
        var js, id = 'facebook-jssdk'; if (d.getElementById(id)) {return;}
        js = d.createElement('script'); js.id = id; js.async = true;
        js.src = "//connect.facebook.net/en_US/all.js";
        d.getElementsByTagName('head')[0].appendChild(js);
      }(document));
  </script>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-30T11:29:11.870

当您的原始令牌过期时，您陷入循环的原因是您的代码不允许 Facebook 为您提供新令牌。当您收到 OAuth 错误时，您正在调用 OAuth 对话框，该对话框不会使用新令牌重新填充您的 cookie。

您遇到的另一个问题是在进行 api 调用之前，您正在用短期访问令牌覆盖长期访问令牌：

```
// known valid access token stored in a database
$access_token = isset($_COOKIE["FB_LONG_AC_TOKEN"]) ? $_COOKIE["FB_LONG_AC_TOKEN"] : false;
 ...
if ($access_token) {
$facebook->setAccessToken($access_token); //Loads the short-term token from a cookie! 
```

如果是我的代码，我会使用两个变量：`$access_token_temp`这样`$access_token_long`我就可以保持直截了当。

**编辑**

您的页面加载工作流程需要：

```
+ IF one exists, retrieve the long-term token from `$_COOKIE['FB_LONG_AC_TOKEN']` 
    + If it does exist, test to see if it is valid.
    + If valid, use the renew the token and update the cookie if one is returned. (Only one token will be returned per day)
    + Else mark the long-term token as invalid and clear the cookie.
    + Set a `$vaild_user` flag.
+ ELSE IF a new short-term token is available
    + Read the short-term token cookie with the PHP API and exchange this for a long-term token.
    + Store the long-term token in the cookie
    + Clear the short-term token cookie
    + Set a `$valid_user` flag
+ ELSE: The token does not exist or is invalid
    + Redirect the user to the JS API auth dialog and store the returned short term token in a cookie.
    + Reload the page to process this.
+ ENDIF 
+ IF `$valid_user`: Do stuff. 
```

你已经在你的代码中得到了所有的部分。您只需要清理逻辑以使其工作。

**编辑#2：**

我在我的服务器上运行了你的代码。它主要工作，但您输出的调试信息过早地发送标头，抑制`setcookie()`设置 cookie 的能力。

我通过`$out = array();`在开头声明附近运行您的代码，然后将您的所有`echo`和`print`语句更改`$out[] = "What you were echoing or printing before";`为仍显示此内容，请`echo implode("\n", $out);`在`<body>`您的文档中添加。

一旦我这样做了，我就能够在 cookie 中存储一个有效的令牌，并[验证](https://developers.facebook.com/tools/debug/access_token)它确实是一个有效期为 60 天的长寿命令牌。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-14T17:21:36.560

看起来 FB 正在劝阻我们不要为更长的令牌进行服务器交换：

回复：桌面应用程序：“但是，如果不让用户再次登录到您的应用程序，就无法获得长期用户 access_token。” [https://developers.facebook.com/roadmap/offline-access-removal/](https://developers.facebook.com/roadmap/offline-access-removal/)

您是否检查过服务器上的时区设置？我已经设置了离线访问令牌，并进行了刷新-尽管它涉及用户重新单击以刷新（不是自动的）。

另外-您可以很容易地进行图形调用

```
$facebook->api("me"); // no need to add access token, or decode JSON, etc. 
```

# javascript - JavaScript/HTML5/jQuery 拖放上传 - “未捕获的类型错误：无法读取未定义的属性‘文件’”

> ID：10813494
> 
> 赞同：12
> 
> 时间：2012-05-30T09:26:21.710
> 
> 标签：javascript, jquery, html, file-upload, drag-and-drop

我会事先告知您，我的 JavaScript 经验有限。

* * *

目前，我有 JavaScript 代码：

```
$('#xhr-filebox').bind({
    "dragover": HandleDragEvent,
    "dragleave": HandleDragEvent,
    "drop": HandleDropEvent
});

function HandleDropEvent(e){
    var files = e.target.files || e.dataTransfer.files;
    UploadFile(files[0]);
} 
```

（有些代码省略了，但如果您要求我会添加更多）

...和 ​​HTML：

```
<div class="filebox" id="xhr-filebox">
    <p id="xhr-action">...or click me to pick one.</p>
</div> 
```

但是，当我将文件拖入其中时，Chrome JS 控制台会这样说：

> 未捕获的类型错误：无法读取未定义的属性“文件”

但是，它可以在从文件输入读取时获取 FileList 对象。

奇怪的是，当我记录事件参数（ console.log(e) ）时，它将它记录为 f.event，而在我的类似脚本中，它将它记录为 MouseEvent （屏幕截图：[http://i.stack.imgur .com/3krcT.png](https://i.stack.imgur.com/3krcT.png) )

与 jQuery 中的 bind() 函数不同，this 使用 getElementById() 返回的 DOM 对象的 addEventListener() 函数，IE this 是纯 JavaScript。我已经尝试过这种方法，但没有任何新的事情发生。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-05-30T09:30:40.690

如果`files`不存在 on `e.target`，则您正在寻找`files`on `e.dataTransfer` ——但如果 on 没有`dataTransfer`属性`e`（并且您的屏幕截图中似乎没有），您将尝试取消引用`undefined`，从而导致此错误。

我将代码更改为：

```
function HandleDropEvent(e){
    var files = e.target.files || (e.dataTransfer && e.dataTransfer.files);
    if (files) {
        UploadFile(files[0]);
    }
    else {
        // Perhaps some kind of message here
    }
} 
```

这样，如果`e.target.files`不存在且`e.dataTransfer` *也不*存在，您将得到`files`being `undefined`，而不是错误。

* * *

jQuery 为您提供的事件对象是由 jQuery 创建和规范化的。由于我们知道`e.dataTransfer`该事件对象上不存在（从您的屏幕截图中），我猜它不是 jQuery 从原始事件对象复制的属性之一。不过没关系，因为 jQuery 让我们可以通过`e.originalEvent`. 所以我会尝试：

```
function HandleDropEvent(e){
    var dt = e.dataTransfer || (e.originalEvent && e.originalEvent.dataTransfer);
    var files = e.target.files || (dt && dt.files);
    if (files) {
        UploadFile(files[0]);
    }
    else {
        // Perhaps some kind of message here
    }
} 
```

如果那是它所在的位置，或者从我们找到它的`files`任何位置（在 上，或在 上）中抓取。`e.target``dataTransfer``e``e.originalEvent`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2017-02-17T15:02:52.093

在过去的几年里，我一直在使用以下代码：

```
var files = e.target.files || 
(e.dataTransfer ? e.dataTransfer.files : e.originalEvent.dataTransfer.files); 
```

但是，我最近在使用 Chrome 时遇到了一个问题，其中 e.target.files 存在但长度为 0 导致文件为空，即使 dataTransfer 确实有删除的文件。

所以，我不得不使用稍微不同的检查：

```
var files = e.target.files;
if (!files || files.length === 0)
    files = (e.dataTransfer ? e.dataTransfer.files : e.originalEvent.dataTransfer.files); 
```

希望这可以帮助其他人。

# java - J2ME 读取不同语言的文件（编码）

> ID：10813495
> 
> 赞同：1
> 
> 时间：2012-05-30T09:26:31.830
> 
> 标签：java, encoding, java-me, inputstream, midp

我的 J2ME 应用程序必须读取不同语言（英语、法语、阿拉伯语）的文件。

这些文件是用 UTF-8 编码编写的，我用以下代码读取它们：

```
InputStream is = this.getClass().getResourceAsStream("/res/traduct_"+ lang +".txt");
StringBuffer sb = new StringBuffer();
int chars;
while ((chars = is.read()) != -1)
    sb.append((char) chars);
String str = new String(String.valueOf(sb).getBytes("ISO-8859-1")); 
```

这在 Netbeans 模拟器和我的 LG 手机中运行良好，但在其他手机（诺基亚、三星）中，不显示阿拉伯语和法语。只有英语在所有情况下都有效。

我的代码有问题吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-31T08:00:41.557

这段代码没有问题：[Reading text file in J2ME](https://stackoverflow.com/questions/739691/reading-text-file-in-j2me/739744#739744)

```
String content = "";
Reader in = new InputStreamReader(this.getClass().getResourceAsStream("asdf.txt"), THE_ENCODING);
StringBuffer temp = new StringBuffer(1024);
char[] buffer = new char[1024];
int read;
while ((read=in.read(buffer, 0, buffer.len)) != -1) {
  temp.append(buffer, 0, read);
}
content = temp.toString(). 
```

谢谢蒂洛。

# django - Django 模型引用

> ID：10813496
> 
> 赞同：0
> 
> 时间：2012-05-30T09:26:32.487
> 
> 标签：django, django-models

我正在尝试创建具有以下字段的 django 模型

```
Ruleinfo(Character field)
Ispname(Character field)
Priority (Character field)
From (Character field)
To(Character field) 
```

我的问题是，对于每个 Ispname，它们可以是多个（多于一个）Ruleinfo，对于每个 Ruleinfo，它们可以是多个（多于一个）优先级数。我正在编写一个类似的模型

```
class Rule(models.Model):
    Ruleinfo = models.CharField(max_length=5,null=False)
    Ispname  = models.CharField(max_length=5,null=False)
    priority = models.ForeignKey('Priority')
    From  =    models.IntegerField(null=True)
    To = models.IntegerField(null=True)

class Priority(models.Model):  
    priority =  models.IntegerField(null = True)
    ispname = models.ForeignKey('Rule')
    rule = models.ForeignKey('Rule') 
```

但是这个模型并没有验证我在哪里做错了任何想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-30T10:37:32.473

从[文档](https://docs.djangoproject.com/en/dev/ref/models/fields/#charfield)：

> `CharField`有一个额外的必需参数：
> 
> **`CharField.max_length`**

# php - 谷歌分析与 PHP

> ID：10813497
> 
> 赞同：3
> 
> 时间：2012-05-30T09:26:39.767
> 
> 标签：php, javascript, google-analytics

我正在尝试将 Google Analytics 与 php 一起使用。我无法使用 JavaScript。有没有办法解决这个问题？

我尝试了一些 php 库，但似乎这些库不起作用。我试过的库：[http ://code.google.com/p/serversidegoogleanalytics/](http://code.google.com/p/serversidegoogleanalytics/)

提前致谢。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-30T12:18:01.120

是的，谷歌在这里提供了一个服务器端代码：

[https://developers.google.com/analytics/devguides/collection/other/mobileWebsites](https://developers.google.com/analytics/devguides/collection/other/mobileWebsites)

它提供了基本功能并且非常适合页面浏览。但是，它不包括事件或自定义变量。您可以做的是使用此代码以及一些简单的函数，这些函数将允许您将正确的参数 (utme) 发送到 gif 请求中。

# android - 通过 ANDROID 中的 EMAIL_ADDRESS 在 SQLITE DB 中检索用户名和密码

> ID：10813507
> 
> 赞同：4
> 
> 时间：2012-05-30T09:27:22.920
> 
> 标签：android, sqlite

我需要获取用户名和密码...我正在我的应用程序中进行密码恢复，所以这是我的 DB 代码：

```
public String getEmailAddr() throws SQLException {
    Cursor mCursor = db.rawQuery(
        "SELECT Username, Passwords FROM " + 
        USERS_TABLE + " WHERE EmailNO=?",null);

    if (mCursor != null) {           

        if(mCursor.getCount() > 0 {
            //return obj1.getpassword();
        }
    }

    //return false;
    return obj1.getpassword();
} 
```

当用户输入电子邮件地址时，它必须首先检查是否存在并使用我的活动代码发送电子邮件返回密码和用户名：

```
public void onClick(View v) {
    String EmailAddress = txtEmailAddress.getText().toString();
    try {
        if(EmailAddress.length() > 0) {
            DBAdapter  dbUser = new DBAdapter (RecoverPassword.this);
            dbUser.open();

            if(dbUser.getEmailAddress(EmailAddress)) {
                Toast.makeText(RecoverPassword.this,
                    "Email Successfully ", 
                    Toast.LENGTH_LONG).show();
                    Toast.makeText String to = 
                        txtEmailAddress.getText().toString();
                    //String subject = EmailAddress.getText().toString();
                    // String message = EmailAddress.getText().toString();
                    Intent email = new Intent(Intent.ACTION_SEND);
                    email.putExtra(Intent.EXTRA_EMAIL, new String[]{ to});
                    email.putExtra(Intent.EXTRA_SUBJECT, "Password Recovery");
                    email.putExtra(Intent.EXTRA_TEXT, dbUser.getEmailAddr());
                    //need this to prompts email client only 
                    email.setType("message/rfc822");
                    startActivity(Intent.createChooser(email, "gmail :"));                 
                }

                else {
                    Toast.makeText(RecoverPassword.this,
                        "Invalid Email", Toast.LENGTH_LONG).show();
                    txtEmailAddress.setText("");
                }

                dbUser.close();
            }
        }

        catch(Exception e) {
            Toast.makeText(RecoverPassword.
            this,e.getMessage(), Toast.LENGTH_LONG).show();
        }

        Please help me to check what is wrong...but there is no error but it cant return 
        username and password to the email sent 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-30T09:33:25.707

我对您的代码感到困惑，但是当您想从中获取数据`Cursor`时

```
String[] whereArgs = new String[<data>];
    Cursor mCursor = db.rawQuery("SELECT Username, Passwords FROM " + USERS_TABLE + " WHERE EmailNO = ?", whereArgs);
    mCursor.moToFirst();

    if(mCursor.getCount() > 0} {
       String userName = mCursor.getString(0);
       String password = mCursor.getString(1);

    } 
```

您必须使用从数据库返回数据的`getters`提供实例。`Cursor`

**编辑：**

我没有注意到你使用 whereArgs 所以当你使用`WHERE`子句时，你必须指定 whereArgs 因为`String[]`它包含将被替换的数据而不是**?** 字符。

您可以使用关闭数据库：

```
@Override
protected void onDestroy() {
    super.onDestroy();
    if (yourDatabase != null) {
        yourDatabase.close();
    }
} 
```

或者在打开你的数据库的每项工作之后，你应该`close()`db.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-30T09:34:35.500

在

```
Cursor mCursor = db.rawQuery("SELECT Username, Passwords FROM " + USERS_TABLE + " WHERE
EmailNO=?",null); 
```

您没有提供 EmailNO 的值。将值替换为`null`。

编辑：我认为你的代码应该是这样的：

```
public boolean getEmailAddress(String emailNo) 
    throws SQLException { //pass the EmailNo which you want in where clause
    Cursor mCursor = db.rawQuery(
        "SELECT Username, Passwords FROM sddashsd WHERE 
        EmailNO='"+emailNo+"'",null);

        if (mCursor != null) {         
            if(mCursor.getCount() > 0)
                return true;
        else 
            return false;
        }
    } 
```

并在此处编辑您的代码：

```
public void onClick(View v) {
    String EmailAddress = 
        txtEmailAddress.getText().toString();

    try {
        if(EmailAddress.length() > 0) {
            DBAdapter  dbUser = new DBAdapter (RecoverPassword.this);
            dbUser.open();

            if(dbUser.getEmailAddress(EmailAddress)) {
                Toast.makeText(RecoverPassword.this,
                    "Email Successfully ", Toast.LENGTH_LONG).show();
                String to = txtEmailAddress.getText().toString();
                //String subject = EmailAddress.getText().toString();
                // String message = EmailAddress.getText().toString();
                Intent email = new Intent(Intent.ACTION_SEND);
                email.putExtra(Intent.EXTRA_EMAIL, new String[]{ to});
                email.putExtra(Intent.EXTRA_SUBJECT, "Password Recovery");
                email.putExtra(Intent.EXTRA_TEXT, dbUser.getEmailAddr());
                //need this to prompts email client only
                email.setType("message/rfc822");
                startActivity(Intent.createChooser(email, "gmail"));
            }

            else {
                Toast.makeText(RecoverPassword.this,"Invalid Email", 
                    Toast.LENGTH_LONG).show();                             
                    txtEmailAddress.setText("");
            }

        }

    }

    catch(Exception e) {
        Toast.makeText(RecoverPassword.this,
            e.getMessage(), Toast.LENGTH_LONG).show();
    }

    finally {
        dbUser.close();  
    } 
```

# javascript - jQuery如何在内容更改后获取div的高度

> ID：10813511
> 
> 赞同：2
> 
> 时间：2012-05-30T09:27:35.143
> 
> 标签：javascript, jquery

我正在动态更改 div 的内容，我需要在更改后立即获得它的新高度。

```
var text='Bla-bla-bla Bla-bla-bla Bla-bla-bla Bla-bla-bla Bla-bla-bla Bla-bla-bla Bla-bla-bla Bla-bla-bla Bla-bla-bla Bla-bla-bla Bla-bla-bla Bla-bla-bla Bla-bla-bla Bla-bla-bla Bla-bla-bla Bla-bla-bla Bla-bla-bla Bla-bla-bla Bla-bla-bla Bla-bla-bla Bla-bla-bla Bla-bla-bla Bla-bla-bla Bla-bla-bla Bla-bla-bla Bla-bla-bla Bla-bla-bla Bla-bla-bla Bla-bla-bla Bla-bla-bla Bla-bla-bla Bla-bla-bla Bla-bla-bla Bla-bla-bla Bla-bla-bla Bla-bla-bla Bla-bla-bla Bla-bla-bla Bla-bla-bla Bla-bla-bla Bla-bla-bla Bla-bla-bla Bla-bla-bla Bla-bla-bla ';
$('.jspPane').html(text);
$('.jspPane').ready(function()
{
  alert($('.jspPane').height());
}); 
```

例如这段代码会给我**2376**

但是当我`$('.jspPane').height();`在 Google Chrome 控制台中调用时，它给了我**90**，这是该文本的正确值。

我究竟做错了什么？

谢谢！

真诚的，斯坦

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-30T09:31:42.950

放`.html()`里面就行了`.ready()`。

```
var text='Bla-bla-bla Bla-bla-bla Bla-bla-bla Bla-bla-bla Bla-bla-bla Bla-bla-bla Bla-bla-bla Bla-bla-bla Bla-bla-bla Bla-bla-bla Bla-bla-bla Bla-bla-bla Bla-bla-bla Bla-bla-bla Bla-bla-bla Bla-bla-bla Bla-bla-bla Bla-bla-bla Bla-bla-bla Bla-bla-bla Bla-bla-bla Bla-bla-bla Bla-bla-bla Bla-bla-bla Bla-bla-bla Bla-bla-bla Bla-bla-bla Bla-bla-bla Bla-bla-bla Bla-bla-bla Bla-bla-bla Bla-bla-bla Bla-bla-bla Bla-bla-bla Bla-bla-bla Bla-bla-bla Bla-bla-bla Bla-bla-bla Bla-bla-bla Bla-bla-bla Bla-bla-bla Bla-bla-bla Bla-bla-bla Bla-bla-bla';

$('.jspPane').ready(function()
{
     $('.jspPane').html(text);
     alert($('.jspPane').height());
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-30T09:28:40.577

```
$('.jspPane').html(text);
alert($('.jspPane').height()); 
```

**[工作样本](http://jsfiddle.net/mckr4/)**

# css - 是否可以在选择框中将文本居中？

> ID：10813528
> 
> 赞同：258
> 
> 时间：2012-05-30T09:29:00.263
> 
> 标签：css

我试过这个：http: [//jsfiddle.net/ilyaD/KGcC3/](http://jsfiddle.net/ilyaD/KGcC3/)

HTML：

```
<select name="state" class="ddList">
    <option value="">(please select a state)</option>
    <option class="lt" value="--">none</option>
    <option class="lt" value="AL">Alabama</option>
    <option class="lt" value="AK">Alaska</option>
    <option class="lt" value="AZ">Arizona</option>
    <option class="lt" value="AR">Arkansas</option>
    <option class="lt" value="CA">California</option>
    <option class="lt" value="CO">Colorado</option>
</select> 
```

CSS：

```
select { width: 400px; text-align: center; }
select .lt { text-align: center; } 
```

如您所见，它不起作用。有没有一种纯 CSS 的方式来使选择框中的文本居中？

* * *

## 回答 #1

> 赞同：465
> 
> 时间：2015-12-30T15:42:13.630

**Chrome**有一个部分解决方案：

```
select { width: 400px; text-align-last:center; } 
```

它确实使所选选项居中，但不是下拉列表中的选项。

* * *

## 回答 #2

> 赞同：97
> 
> 时间：2016-10-25T10:21:24.967

那是为了对齐。试试看：

```
select{
    text-align-last:right;
    padding-right: 29px;
    direction: rtl;
} 
```

`text-align-last`可以在此处找到该属性的浏览器支持： [https](https://www.w3schools.com/cssref/css3_pr_text-align-last.asp) ://www.w3schools.com/cssref/css3_pr_text-align-last.asp 看起来只有 Safari 仍然不支持它。

* * *

## 回答 #3

> 赞同：63
> 
> 时间：2013-02-14T12:57:12.593

您必须将 CSS 规则放入 select 类中。

**使用 CSS 文本缩进**

**例子**

```
<select class="day"> /* option 1 option 2 option 3 option 4 option 5 here */ </select> 
```

**CSS 代码**

```
select { text-indent: 5px; } 
```

* * *

## 回答 #4

> 赞同：62
> 
> 时间：2019-05-11T12:46:11.983

对的，这是可能的。您可以使用**text-align-last**

```
text-align-last: center; 
```

* * *

## 回答 #5

> 赞同：58
> 
> 时间：2020-02-15T05:29:17.253

2020，我正在使用：

```
select {
    text-align: center;
    text-align-last: center;
    -moz-text-align-last: center;
} 
```

* * *

## 回答 #6

> 赞同：35
> 
> 时间：2012-05-30T09:33:35.177

I'm afraid this isn't possible with plain CSS, and won't be possible to make completely cross-browser compatible.

However, using a jQuery plugin, you could style the dropdown:

[https://www.filamentgroup.com/lab/jquery-ui-selectmenu-an-aria-accessible-plugin-for-styling-a-html-select.html](https://www.filamentgroup.com/lab/jquery-ui-selectmenu-an-aria-accessible-plugin-for-styling-a-html-select.html)

This plugin hides the `select` element, and creates `span` elements etc on the fly to display a custom drop down list style. I'm quite confident you'd be able to change the styles on the spans etc to center align the items.

* * *

## 回答 #7

> 赞同：23
> 
> 时间：2017-06-12T12:30:51.897

只是使用这个：

```
select {

text-align-last: center;
padding-right: 29px;

} 
```

* * *

## 回答 #8

> 赞同：22
> 
> 时间：2018-07-25T19:37:39.730

```
select {
  text-align: center;
  text-align-last: center;
}
option {
  text-align: left;
}
```

```
<select>
   <option value="">(please select a state)</option>
   <option class="lt" value="--">none</option>
   <option class="lt" value="AL">Alabama</option>
   <option class="lt" value="AK">Alaska</option>
   <option class="lt" value="AZ">Arizona</option>
   <option class="lt" value="AR">Arkansas</option>
   <option class="lt" value="CA">California</option>
   <option class="lt" value="CO">Colorado</option>
</select>
```

* * *

## 回答 #9

> 赞同：17
> 
> 时间：2016-01-24T23:36:00.463

这个 JS 函数应该适合你

```
function getTextWidth(txt) {
  var $elm = $('<span class="tempforSize">'+txt+'</span>').prependTo("body");
  var elmWidth = $elm.width();
  $elm.remove();
  return elmWidth;
}
function centerSelect($elm) {
    var optionWidth = getTextWidth($elm.children(":selected").html())
    var emptySpace =   $elm.width()- optionWidth;
    $elm.css("text-indent", (emptySpace/2) - 10);// -10 for some browers to remove the right toggle control width
}
// on start 
$('.centerSelect').each(function(){
  centerSelect($(this));
});
// on change
$('.centerSelect').on('change', function(){
  centerSelect($(this));
}); 
```

完整的 Codepen：http: [//codepen.io/anon/pen/NxyovL](http://codepen.io/anon/pen/NxyovL)

* * *

## 回答 #10

> 赞同：10
> 
> 时间：2014-12-24T11:37:46.160

我一直使用以下技巧使其仅与 css 一起使用。

```
padding-left: 45%;
font-size: 50px; 
```

填充将使文本居中，并且可以调整文本大小:)

从验证的角度来看，我猜这显然不是 100% 正确的，但它确实有效:)

* * *

## 回答 #11

> 赞同：7
> 
> 时间：2017-06-19T10:07:40.037

**如果您有一个包含类似文本长度选项的列表**（例如页面选择），则替代“假”解决方案：

```
padding-left: calc(50% - 1em); 
```

这适用于 Chrome、Firefox 和 Edge。诀窍在于将文本从左侧推到中心，然后减去 px、em 或任何选项文本中长度的一半。

[![在此处输入图像描述](../Images/fa6d4f967908f9353a9fa31340d9a92a.png)](https://i.stack.imgur.com/DfzCo.jpg)

***最佳解决方案 IMO（2017 年）仍在通过 JS 替换选择，并使用 div 或其他内容构建您自己的假选择框，并在其上绑定点击事件以支持跨浏览器。***

* * *

## 回答 #12

> 赞同：5
> 
> 时间：2014-03-09T19:13:04.773

不完全居中，但使用上面的示例，您可以在选择框中设置左边距。

```
<style>.UName { text-indent: 5px; }</style><br>

<select  name="UserName" id="UserName" size="1">
    <option class="UName" selected value="select">Select User</option>
    <option class="UName" value="User1">User 1 Name</option>
    <option class="UName" value="User2">User 2 Name </option>
    <option class="UName" value="User3">User 3 Name</option>
</select> 
```

* * *

## 回答 #13

> 赞同：5
> 
> 时间：2018-06-12T09:04:16.753

尝试这个 ：

```
select {
    padding-left: 50% !important;
    width: 100%;
} 
```

* * *

## 回答 #14

> 赞同：5
> 
> 时间：2018-05-14T00:31:31.543

这对我有用：

```
text-align: center;
text-align-last: center; 
```

* * *

## 回答 #15

> 赞同：2
> 
> 时间：2012-05-30T09:34:25.423

You can't really customise `<select>` or `<option>` much. The only way (cross-browser) would be to manually create a drop down with divs and css/js to create something similar.

* * *

## 回答 #16

> 赞同：2
> 
> 时间：2016-03-25T13:40:05.293

如果您没有找到任何解决方案，您可以在 angularjs 上使用此技巧或使用 js 将所选值与 div 上的文本映射，此解决方案在 angular 上完全符合 css，但需要在 select 和 div 之间进行映射：

```
var myApp = angular.module('myApp', []);

myApp.controller('selectCtrl', ['$scope',
  function($scope) {
    $scope.value = '';

  }
]);
```

```
.ghostSelect {
  opacity: 0.1;
  /* Should be 0 to avoid the select visibility but not visibility:hidden*/
  display: block;
  width: 200px;
  position: absolute;
}
.select {
  border: 1px solid black;
  height: 20px;
  width: 200px;
  text-align: center;
  border-radius: 5px;
  display: block;
}
```

```
<!doctype html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <title>Example - example-guide-concepts-1-production</title>
  <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.2.23/angular.min.js"></script>
</head>
<body ng-app="myApp">
  <div ng-app ng-controller="selectCtrl">
    <div class=select>
      <select ng-model="value" class="ghostSelect">
        <option value="Option 1">Option 1</option>
        <option value="Option 2">Option 2</option>
        <option value="Option 3">Option 3</option>
      </select>
      <div>{{value}}
      </div>
    </div>
  </div>
</body>
```

希望这对某人有用，因为我花了一天时间在 phonegap 上找到这个解决方案。

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2014-07-30T22:53:49.060

虽然您无法将选项文本置于选择中的中心，但您可以在选择的顶部放置一个绝对定位的 div 以达到相同的效果：

```
#centered
{
  position: absolute;
  top: 10px;
  left: 10px;
  width: 818px;
  height: 37px;
  text-align: center;
  font: bold 24pt calibri;
  background-color: white;
  z-index: 100;
}

#selectToCenter
{
  position: absolute;
  top: 10px;
  left: 10px;
  width: 840px;
  height: 40px;
  font: bold 24pt calibri;
}

$('#selectToCenter').on('change', function () {
    $('#centered').text($(this).find('option:selected').text());
});

<select id="selectToCenter"></select>
<div id="centered"></div> 
```

确保 div 和 select 在文档中都有固定的位置。

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2021-01-28T12:27:05.323

在您选择使用**width: auto**和 no padding 以查看您的文本有多长。我在我的选择中使用了 100% 的可用宽度，并且我的所有选项都具有相同的长度，这允许我使用非常简单的 css。

**text-indent**将从左侧移动文本，类似于 padding-left
**120px 是我的文本长度**- 我想将它居中，所以需要一半的大小和一半的选择大小，留下 50% - 60px

```
select{
  width: 100%;
  text-indent: calc(50% - 60px);
} 
```

**如果我有不同大小的选项怎么办？**

但是，有可能解决方案不会是一个漂亮的解决方案。
如果选项之间的差异不像 5 个字符，前一个解决方案可能会让您非常接近居中。

**如果您仍然需要更精确地居中，您可以这样做**

**准备这个类：**

```
.realWidth{
   width: auto;
} 
```

将 onChange 侦听器应用于选择元素

在该侦听器中，**将 .realWidth**应用于选择元素

```
const selectRef = document.getElementById("yourId");
selectRef.classList.add("realWidth"); 
```

访问选项的实际宽度。

```
const widthOfSelect = selectRef.getBoundingClientRect().width / 2; 
```

widthOfSelect 是您要查找的宽度。将其存储在全局/组件变量中。

删除realWidth，你不再需要它了。

```
selectRef.classList.remove("realWidth"); 
```

**我正在使用 react**，**我不确定这是否适用于 vanilla**，如果不是，您必须找到另一种解决方案。

```
<select style={`textIndent: calc(50% - ${widthOfSelect}) %`}> ... </select> 
```

然而，另一种不好的解决方案可能是使用 js 创建 CSS 类并将其放在首位。

**优点：**

1.  可能有效，我还没有尝试过动态解决方案，但它应该可以工作。

**缺点：**

1.  如果程序不够快，用户会看到 width: auto 发生，因此想知道发生了什么。如果是这种情况，只需创建重复选择，将其隐藏在具有更高 z-index 的东西后面，并将 on select 侦听器从原始应用到隐藏的重复。
2.  如果由于香草限制而无法内联样式可能很难使用，但您可以制作一个脚本来优化头部的 appendChild。

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2021-08-06T08:43:20.840

最简单的方法：使用 padding-left

```
select{
   padding-left:2rem
} 
```

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2021-01-16T13:55:32.580

我遇到了一个客户坚持这样做的问题，他们在 Mac 和 iPhone 上。

我最终使用了媒体查询和填充左的百分比填充。这是一个令人满意的解决方案吗？一点也不，但它让我继续前进。

* * *

## 回答 #21

> 赞同：-1
> 
> 时间：2020-06-15T12:29:57.590

它还不是 100%，但你可以使用这个片段！

文本对齐最后：居中；// 对于 Chrome text-align: center; // 对于火狐

暂时不适用于 Safari 或 Edge！

* * *

## 回答 #22

> 赞同：-3
> 
> 时间：2015-09-02T20:55:13.760

如果选项是静态的，您可以在选择框上监听更改事件并为每个单独的项目添加填充

```
$('#id').change(function() {
    var select = $('#id');
    var val = $(this).val();

    switch(val) {
        case 'ValOne':
            select.css('padding-left', '30px');
            break;
        case 'ValTwoLonger':
            select.css('padding-left', '20px');
             break;
        default:
            return;
    }
}); 
```

# jquery - autocomplete jquery struts 2

> ID：10813530
> 
> 赞同：0
> 
> 时间：2012-05-30T09:29:11.767
> 
> 标签：jquery, autocomplete, struts2

I have a problem using the autocomplete jquery tool

client side :

```
JQElement.autocomplete({
   source:  function (request, response) {
        $.ajax({
            url: jsonAction,
            dataType: "json",
            data: {
                maxRows: 10,
                startsWith: request.term
            },
            success: function( data ) {
                response( $.map( data , function( item ) {
                        return {
                                label: item.label,
                                value: item.value
                        }
                }));
                //response(data);
            },
            error: function(message, status, errorThrown) {
                alert("une erreur s'est produit lors de la recherche des éléments correspondant à la saisie. Contacter les créateurs du programme");
            }
        });
    },
    minLength: 1
 }); 
```

the action is called :

```
public String getInsuredNumbers() {
    try {
        String maxRows = request.getParameter("maxRows");
        String startsWith = request.getParameter("startsWith");

        if(maxRows.equals("")) maxRows = "10";
        if(startsWith.equals("")) startsWith = "17";

        String sql = "select assure.ASS_nni, assure.ASS_nom, assure.ASS_prenom from assure where "
                + "assure.ASS_nni like '" + startsWith + "%' limit " + maxRows;
        ResultSet rs = this.getResponse(sql);

        while(rs.next()) {
            Param p = new Param(rs.getString(1), rs.getString(1) + " " + rs.getString(2) + " " + rs.getString(3));
            data.add(p);
        }

    } catch (SQLException ex) {
        Logger.getLogger(AutocompleteAction.class.getName()).log(Level.SEVERE, null, ex);
    } finally {
        return SUCCESS;
    }
}

public List<Param> getData() {
    return data;
} 
```

data is an ArrayList of Param

```
public class Param {
  private String value;
  private String label;

  public Param(String value, String label) {
    this.value = value;
    this.label = label;
  }

  public String getLabel() {
    return label;
  }

  public String getValue() {
    return value;
  } 
```

}

Firebug bug shows me that the json answer is good the success answer is triggered on client side

However the list under the input appears to be empty

Can you help on that ?

Thank you

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-30T11:21:36.467

Solution

On client-side :

```
JQElement.autocomplete({
   source:  function (request, response) {
        $.ajax({
            url: jsonAction,
            dataType: "json",
            data: {
                maxRows: 10,
                startsWith: request.term
            },
            success: function( data ) {
                var mydata;

                $.map(data, function(item, i) {
                    if(i == "data") {
                        mydata = item;
                    }
                });

                response( $.map( mydata , function( item) {
                        return {
                            label: item.label,
                            value: item.value
                        }
                }));
            },
            error: function(message, status, errorThrown) {
                alert("une erreur s'est produit lors de la recherche des éléments correspondant à la saisie. Contacter les créateurs du programme");
            }
        });
    },
    minLength: 1, 
```

# maven - 将 Maven 配置文件放入外部文件？

> ID：10813531
> 
> 赞同：2
> 
> 时间：2012-05-30T09:29:24.960
> 
> 标签：maven, maven-3

我有几个 Maven 配置文件，它们不应该在所有机器上都可用。所以我不想把它们放到根目录下的super pom中。

但是，据我所知，没有办法将 Maven 3 构建配置文件放入不同的文件中，并在运行时使用激活规则和命令行参数包含它们。

还是我错了？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-30T09:38:25.753

在 Maven 3 中，不可能将配置文件放入外部文件中。在早期版本中（Maven 2.2.1 存在一个profiles.xml）。

# linux - bash 和 linux 内核中的 Shebang 行限制

> ID：10813538
> 
> 赞同：32
> 
> 时间：2012-05-30T09:29:55.100
> 
> 标签：linux, bash, shebang

我正在尝试执行由 zc.buildout 自动生成的 python 脚本，所以我无法控制它们。我的问题是 shebang 行（#！）对于 bash（80 个字符限制）或直接执行（一些我不知道的 Linux 内核常量）来说太长了。

这是一个示例脚本，可帮助您重现我的问题：

```
#!/././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././bin/bash
echo Hola! 
```

如何将 bash 或内核配置为允许更大的 shebang 行？

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2012-05-30T09:35:17.703

由于内核编译时间缓冲区限制，在 99.9% 的系统上限制为 127 个字符。

它在内核中受限于`BINPRM_BUF_SIZE`, 设置在`include/linux/binfmts.h`.

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2012-05-31T00:41:11.023

如果您不想重新编译内核以获得更长的 shebang 行，您可以编写一个包装器：

```
#!/bin/bash

if [[ $# -eq 0 ]]; then
    echo "usage: ${0##*/} script [args ...]"
    exit
fi

# we're going to expand a variable *unquoted* to use word splitting, but
# we don't want to have path expansion effects, so turn that off
set -f

shebang=$(head -1 "$1")
if [[ $shebang == '#!'* ]]; then
    interp=( ${shebang#\#!} )        # use an array in case a argument is there too
else
    interp=( /bin/sh )
fi

# now run it
exec "${interp[@]}" "$@" 
```

然后像这样运行脚本：`wrapper.sh script.sh`

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2015-01-04T09:13:46.800

更新了@glenn jackman 的脚本以支持传入命令行参数。

顺便说一句，我在非常深的目录层次结构中创建 python virtualenv 时遇到了这个问题。

就我而言，这是在 Mesos 框架目录中创建的 virtualenv。

超长的 shebang 使呼叫`xxx/.../venv/bin/pip`毫无用处。

包装脚本被证明是最有用的。

```
#!/usr/bin/env bash

script="$1" 
shebang=$(head -1 "$script")

# use an array in case a argument is there too
interp=( ${shebang#\#!} )        

# now run it, passing in the remaining command line arguments
shift 1
exec "${interp[@]}" "$script" "${@}" 
```

# sql-server - 比较两个表和它们的列

> ID：10813541
> 
> 赞同：2
> 
> 时间：2012-05-30T09:29:56.203
> 
> 标签：sql-server, tsql

我有 2 张桌子`Table1`&`Table2`都有 10 列

我想将这两个表与它们的每个列值进行比较，并**只选择那些有超过三个列匹配的记录**..

IE。，

`Table1.Col1`值匹配`Table2.Col1`值
AND`Table1.Col2`值匹配`Table2.Col2`值
AND`Table1.Col3`值匹配`Table2.Col3`值

或者

`Table1.Col2`值匹配`Table2.Col2`值
AND`Table1.Col4`值匹配`Table2.Col4`值
AND`Table1.Col6`值匹配`Table2.Col6`值等等...

如何为此编写一个简单而智能的查询？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-30T10:21:28.417

加入 or 条件，然后根据匹配的字段数进行过滤（我只处理了 4 个字段，根据需要添加）。

```
select *
from table1 t1
join table2 t2
  on t1.field1 = t2.field1 
  or t1.field2 = t2.field2
  or t1.field3 = t2.field3
  or t1.field4 = t2.field4
where 
   ( case when t1.field1 = t2.field1 then 1 else 0 end 
   + case when t1.field2 = t2.field2 then 1 else 0 end 
   + case when t1.field3 = t2.field3 then 1 else 0 end 
   + case when t1.field4 = t2.field4 then 1 else 0 end
   ) >= 3 
```

如果你像我一样懒惰，你可以像这样为所有字段生成语句。

```
select 'select * ' union all
select '  from table1 t1' union all
select '  join table2 t2' union all
select '    on 1 = 1 ' union all
select '   and t1.' + t1.name + ' = t2.' + t2.name  from sys.columns t1 join sys.columns t2 on t1.name = t2.name where t1.object_id = object_id('table1') and t2.object_id = object_id('table2')
union all
select 'where ( 0' union all
select '   + case when t1.' + t1.name + ' = t2.' + t2.name + ' then 1 else 0 end ' from sys.columns t1 join sys.columns t2 on t1.name = t2.name where t1.object_id = object_id('table1') and t2.object_id = object_id('table2')
union all 
select '      ) >= 3' 
```

（运行查询并复制粘贴结果。）

# android - 在android中使用帧缓冲区以编程方式截取屏幕截图的步骤是什么

> ID：10813548
> 
> 赞同：1
> 
> 时间：2012-05-30T09:30:30.977
> 
> 标签：android, linux, screenshot

我的设备已植根，我想以编程方式截取屏幕截图。我正在尝试使用这样的帧缓冲区来做到这一点。

```
$ /system/bin/cat /dev/graphics/fb0 > /mnt/sdcard/screenshot.bin
/system/bin/cat /dev/graphics/fb0 > /mnt/sdcard/screenshot.bin 
```

**screenshot.bin**文件已在 sdcard 上成功创建，文件大小为 4800KB

谁能告诉我下一步该怎么做才能获得图像。

请帮忙！！对不起我糟糕的英语。

提前致谢。

# c++ - 默认构造函数递归崩溃

> ID：10813560
> 
> 赞同：2
> 
> 时间：2012-05-30T09:31:07.390
> 
> 标签：c++

/*下面的程序似乎神秘地进入了递归，即使看不到任何东西。编译器：g++ (Ubuntu 4.4.3-4ubuntu5.1) 4.4.3 机器：x86 操作系统：Ubuntu 10.04 64-bit

*/

```
 #include<iostream>
    using namespace std;

    class Test
    {
    public:
      Test ():x(9)
      {
        cout << " Test::Test\n";
        Test (x);
      }
      Test (int a)
      {
        cout << " Test::para\n";
      }
    private:
            int x;
    };

int main(void)
{
 Test a;
return 0;
} 
```

为什么是这样？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-30T10:24:24.263

```
Test (x); 
```

被解析为

```
Test x; 
```

...不是作为构造函数调用。你也可以写

```
Test (y); 
```

并获得相同的行为。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-30T09:42:39.773

你不能像在 C++ 中那样调用其他构造函数。但从 C++11 开始，您可以在初始化列表中转发构造函数调用：

```
class Test {
public:
    Test (): Test(9) {
        cout << " Test::Test\n";
    }

    Test (int a) : x(a) {
        cout << " Test::para\n";
    }

private:
    int x;
}; 
```

有关您的代码崩溃原因的解释，请参阅[Wolfgang 的回答。](https://stackoverflow.com/a/10814418/1968)

# vmware - 可以在 Windows 8 预览版上安装 vmware server 2 吗？

> ID：10813562
> 
> 赞同：1
> 
> 时间：2012-05-30T09:31:14.550
> 
> 标签：vmware, windows-8, vmware-server

抱歉，如果已经问过这个问题，在网上搜索会发现很多关于在 VMware 上安装 Win8 beta 的线程，但不是相反。

我正在尝试在 Windows 8 Preview 机器上安装 VMware Server 2.0.2。它似乎安装正确，但我无法访问基于 Web 的主页来配置虚拟机，即

```
https://localhost:8333/ui/ 
```

给出“与 localhost 的连接尝试被拒绝。网站可能已关闭或您的网络可能未正确配置”的错误。

有没有人在 Windows 8 Preview 上成功运行 VMware Server 2.0.2？如果是这样，您是否需要避免任何陷阱？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-30T19:21:37.500

我认为它永远不会得到解决。VMware Server 于 2010 年 1 月宣布终止供货；将不支持 Windows 8。

您最好的尝试是尝试以兼容模式启动服务，但您为什么要这样做？为什么不使用更高级的 VMware Player 或 VMware Workstation 产品？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-19T17:56:21.340

我找到了一种在 Windows 8 上运行它的方法。

在我的装有 x64 版本的 Windows 8 的 PC 上，当我安装 VMware Server 2 时，我发现有一个名为 VMware Host Agent 的服务无法运行。当我打开系统服务管理器并单击启动此服务时，它给了我错误。

我的解决方案是使用相同的命令字符串创建一个服务，并使用 cmd.exe 中的“sc create”命令将其设置为自动启动。它对我有用！

# iphone - 为什么即使在崩溃后我的应用程序也没有关闭

> ID：10813568
> 
> 赞同：5
> 
> 时间：2012-05-30T09:31:38.723
> 
> 标签：iphone, ios, ipad, ios-simulator

我正在开发一个 iPad 应用程序。有时它会崩溃（我知道原因），但我想知道为什么应用程序即使在崩溃后也没有关闭！当应用程序崩溃时，我收到一些与控制台崩溃相关的错误，但应用程序没有关闭。它甚至出现在多任务栏中（当我按两次主页按钮时我可以看到）。我想知道是否有某种设置？还是这是正常行为？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-30T09:47:31.940

如果您从 Xcode 运行应用程序，调试器仍将附加，因此崩溃不会终止进程。您可以使用 Xcode 调试器查看堆栈、检查变量等。只有当您在 Xcode 中停止应用程序时，该进程才会完全终止。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-30T11:32:12.763

@Mike Weller 是正确的。

模拟器的典型行为是在崩溃时不关闭应用程序，因为调试器被设计为在发生崩溃的代码点停止（原因很明显！）。

如果您想在设备上检查它是否满意。连接您的设备，通过 xcode 在其上运行该应用程序一次。关闭应用程序（在 xcode 上停止）。然后断开设备。

该应用程序现在将像任何其他普通应用程序一样安装在您的设备上。运行这个应用程序并做任何导致它崩溃的事情。您将看到应用程序将关闭，您将被扔回 iphone 跳板屏幕。

至于app出现在多任务栏中，这里已经提到，app出现在多任务栏中并不代表它还在运行。这是 ios 和 android 架构的重要区别。

多任务栏不是任务管理器。ios 的理念是用户不需要知道应用程序是否正在运行。他只需要知道他过去运行过哪些应用程序。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-30T09:43:10.023

它没有关闭的原因可能是应用程序实际上没有崩溃。

可能是您看到的打印是打印到日志的异常吗？难道是你在打印后捕获了这个异常？

像这样：

```
@try {
   [test characterAtIndex:6];
}
@catch (NSException * e) {
   NSLog(@"Exception: %@", e);
} 
```

上面的代码不会崩溃，因为异常被捕获了。捕获异常是告诉平台您已经解决了问题，因此应用程序不需要崩溃。

可能还有很多其他原因，但根据您提供的信息，这是我最好的猜测。您可以发布您所看到的日志打印，这肯定会提供更好的线索......

# java - 优化套接字java中的性能

> ID：10813570
> 
> 赞同：1
> 
> 时间：2012-05-30T09:31:45.457
> 
> 标签：java, performance, sockets

我的应用程序使用套接字和线程将接收到的实时数据发送给连接到它的客户端。为此，步骤如下：

*   连接到数据服务器，然后等待客户端
*   启动一个线程来讨论传入的数据，格式化它们并将它们发送给客户（如果有的话）。
*   当客户端连接时，它会为他打开一个线程，通过该线程发送数据。
*   最后用另外一个线程测试一下你是在接收还是发送数据，否则会重新连接到源。

从源接收到的数据存储在一个等待线程处理的数组中。在每个客户端线程中，接收到的数据也存储在要发送的数组中。这样做的目的是在接收或发送数据时不会出现阻塞。数据延迟 10 秒或更长时间才能到达客户

我可以做些什么来优化性能？这是在 Windows 服务器上运行的，你能推荐任何分析器吗？

非常感谢您的帮助。

编辑：数据是可变长度的字符串。部分代码是：//在实现Runnable的类中创建源套接字，然后等待客户端

```
Socket entrada = new Socket(servidor,Integer.parseInt(puerto));
InputStream sIn = entrada.getInputStream();  
        while (!error) {  
          try {
              s = salida.accept();
              clientes.add(new ClientThread(s));              
// run
while (((c = sIn.read()) != -1) && ((clientes.size() > 0))) {
if (c != 13 && c != 10) {
cad += (char) c;
}
if (c == 13) received[i] = cad

// In SendThread, run
// format received[i] and send result
for (i=0; i < clientes.size(); i++) {
  clientes.get(i).SendData(result);
}

// In ClientThread:
OutputString s1out = socket.getOutputStream();
// SendData
sending[i] = result;
// run
if cad forsending
              for (int j = 0;j<res.length();j++){
                try {
                    s1out.write((int)res.charAt(j));          
                  } catch (Exception e) {
                  }
              } 
```

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-30T12:19:18.413

根据您发送的数据量，它可能是您处理流的方式。

`c = sIn.read()`一次只读取几个字节。尝试用[BufferedReader](http://docs.oracle.com/javase/1.4.2/docs/api/java/io/BufferedReader.html)包装它并使用`readLine()`. BufferedReader 一次读取几 kb，效率更高。`readLine()`还将为您将输入分成几行，这将在一定程度上简化代码。

在客户端连接上，PrintWriter 可以帮助您一次性输出整行。

# java - ArrayList 值未在 LogCat 中打印

> ID：10813571
> 
> 赞同：0
> 
> 时间：2012-05-30T09:31:59.660
> 
> 标签：java, android, sqlite

DBAdapter 类函数：

```
public void getValues(){

        Cursor mCursor = db.query(DBAdapter.DATABASE_TABLE2, new String[] {
                EDGE_ID,
                SOURCE_NODE_ID,
                DESTINATION_NODE_ID,
                VALUE1}, null, null, null, null, null);
        mCursor.moveToFirst();
        while(!mCursor.isAfterLast()) {
            mArrayList.add(mCursor.getString(mCursor.getColumnIndex(DBAdapter.SOURCE_NODE_ID)));
            mCursor.moveToNext();
        }

        for(String d1:mArrayList) {
            System.out.println(d1);
        }
    } 
```

以下是主要活动课程：

```
public void onCreate(Bundle icicle) {
        super.onCreate(icicle);
        setContentView(R.layout.main);

    final DBAdapter db = new DBAdapter(this);
    db.open();
    db.getValues();
    db.close();
} 
```

根据上面的代码，我应该得到一个数组列表，其中包含我的数据库表的值

SOURCE_NODE_ID

属性。我想在 LogCat 中打印这个数组列表。但我收到以下错误：

```
05-30 14:51:39.435: E/AndroidRuntime(4954): FATAL EXCEPTION: main
05-30 14:51:39.435: E/AndroidRuntime(4954): java.lang.RuntimeException: Unable to start activity ComponentInfo{com.navigationsystem/com.navigationsystem.NavigationSystemActivity}: java.lang.NullPointerException
05-30 14:51:39.435: E/AndroidRuntime(4954):     at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1956)
05-30 14:51:39.435: E/AndroidRuntime(4954):     at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:1981)
05-30 14:51:39.435: E/AndroidRuntime(4954):     at android.app.ActivityThread.access$600(ActivityThread.java:123)
05-30 14:51:39.435: E/AndroidRuntime(4954):     at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1147)
05-30 14:51:39.435: E/AndroidRuntime(4954):     at android.os.Handler.dispatchMessage(Handler.java:99)
05-30 14:51:39.435: E/AndroidRuntime(4954):     at android.os.Looper.loop(Looper.java:137)
05-30 14:51:39.435: E/AndroidRuntime(4954):     at android.app.ActivityThread.main(ActivityThread.java:4424)
05-30 14:51:39.435: E/AndroidRuntime(4954):     at java.lang.reflect.Method.invokeNative(Native Method)
05-30 14:51:39.435: E/AndroidRuntime(4954):     at java.lang.reflect.Method.invoke(Method.java:511)
05-30 14:51:39.435: E/AndroidRuntime(4954):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:784)
05-30 14:51:39.435: E/AndroidRuntime(4954):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:551)
05-30 14:51:39.435: E/AndroidRuntime(4954):     at dalvik.system.NativeStart.main(Native Method)
05-30 14:51:39.435: E/AndroidRuntime(4954): Caused by: java.lang.NullPointerException
05-30 14:51:39.435: E/AndroidRuntime(4954):     at com.navigationsystem.DBAdapter.getValues(DBAdapter.java:117)
05-30 14:51:39.435: E/AndroidRuntime(4954):     at com.navigationsystem.NavigationSystemActivity.onCreate(NavigationSystemActivity.java:53)
05-30 14:51:39.435: E/AndroidRuntime(4954):     at android.app.Activity.performCreate(Activity.java:4465)
05-30 14:51:39.435: E/AndroidRuntime(4954):     at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1049)
05-30 14:51:39.435: E/AndroidRuntime(4954):     at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1920)
05-30 14:51:39.435: E/AndroidRuntime(4954):     ... 11 more 
```

这段代码有什么问题。

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-30T10:02:02.487

```
05-30 14:51:39.435: E/AndroidRuntime(4954): Caused by: java.lang.NullPointerException 
05-30 14:51:39.435: E/AndroidRuntime(4954):     at com.navigationsystem.DBAdapter.getValues(DBAdapter.java:117) 
```

您的代码中有一个`NullPointer`。

我认为`mArrayList`在`null`你的`getValue()`方法之内。您在哪里创建了该列表？

也许`db`它也在`null`你之内`DBAdapter`。你试过调试吗？你输出变量了吗？

# c - 如何在已经依赖于 SDL 的程序可能使用的库中初始化 SDL？

> ID：10813574
> 
> 赞同：0
> 
> 时间：2012-05-30T09:32:06.237
> 
> 标签：c, shared-libraries, sdl

我想将 SDL_net 用于少数程序将使用的帮助程序库。但是，其中一些程序本身可能已经在使用 SDL。如果我理解正确，这意味着我不能在初始化/释放我的库时盲目使用`SDL_Init`和`SDL_Quit`，因为 SDL 实例在主程序和我的库之间共享。

到目前为止，我最好的想法是让程序传递一个参数，指示它是否已经在使用 SDL，这将使程序首先负责调用 SDL_Init。我想知道是否有更清洁的解决方案。`SDL_WasInit`看起来很有希望，但显然只允许检查已初始化的子系统，而不是 SDL 本身是否已初始化（可以使用 完成`SDL_Init(0)`）。

这是关于 SDL 1.2。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-30T21:53:50.517

`SDL_WasInit()`可用于检查特定子系统是否正在运行，通过类似的检查`SDL_WasInit(SDL_INIT_VIDEO) != 0`但 SDL_WasInit() 上的[SDL 文档](http://www.libsdl.org/cgi/docwiki.cgi/SDL_WasInit)也说如果您传入`SDL_WasInit(SDL_INIT_EVERYTHING) != 0`or `SDL_WasInit(0) != 0`，这将让您知道 SDL 的任何子系统是否正在运行。

# python - 硒弹出使用python保存文件问题

> ID：10813575
> 
> 赞同：0
> 
> 时间：2012-05-30T09:32:14.663
> 
> 标签：python, selenium

我正在使用硒处理 html。单击最后一个链接后，弹出一个说保存文件的窗口。
使用 selenium 我正在记录所有事件，然后生成 selenium RC 脚本。
我想知道如何使用 python 从代码中获取弹出文件？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T20:52:56.000

在保存文件的情况下，您可以通过配置浏览器配置文件的选项来绕过弹出框。有关使用 Firefox 的解释，请参阅[此](https://stackoverflow.com/questions/12099250/python-webcrawler-downloading-files/12099438)答案。一般的想法是，您需要告诉 Firefox 本身在保存某些类型的文件时不要提示。请注意，这将导致文件被保存在某个地方，但您也可以控制它的去向，以防您想要删除文件（或在 Python 中单独处理它）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-30T14:55:28.590

Webdriver 无法与浏览器模式弹出窗口通信。但这可以做到，请查看以下链接以获取答案

[http://blog.codecentric.de/en/2010/07/file-downloads-with-selenium-mission-impossible/](http://blog.codecentric.de/en/2010/07/file-downloads-with-selenium-mission-impossible/)

# android - Avoid destroying of activity

> ID：10813580
> 
> 赞同：1
> 
> 时间：2012-05-30T09:32:26.703
> 
> 标签：android, android-activity, lifecycle

I have a main activity from which the user starts several activities with `startActivityForResult` . This might be an external application like the xing barcode scanner or a internel activity like a mapview or calendar ect.

The Problem is, by executing `startActivityForResult` my main activity is paused and might be terminated by the android system. Somtimes, when the user stay a long time in a started activity this happens and after closing the new activity the main activity is destroyed and the OnActivityResult Listener is not called.

Is there a way to tell the system "Do not destroy this paused activity" ?

> edit:

The Problem is a little bit more complicated, i fear i've made many mistakes in the whole achitecture of my app. I will try to explain what i've done:

I have a main activity (`extends TabActivity`) and a `final public class GlobalVars` in GlobalVars is store lots of Variables or Classes, which are used by all activities of the project eg. :

```
public static boolean system_initialized = false;
public static boolean system_Onforeground = true; 
```

in the `main.class OnCreate` Method, i set system_initialized to `true` in the `OnResume` method i set `Onforeground = true` , in `onPause` is set `Onforeground = false` and in `OnDestroy` is set `initialized = false`

if I start the app system_initialized and Onforeground will be true, if i start a `ActivityforResult` initialized will stay true, but Onforeground will be set to false.

Now i have a BroatcastReceiver wich starts `android.intent.action.BOOT_COMPLETED` and initialise a Alamrmmanager with a Service as pendingIntent.

Now I use the service to check every minute if i have to do something in the main activity. If a action occured, the services checks if system_initialized = true (in GlobalVars) if not, the service starts the app, otherwise the service use a handler (in GlobalVars) to call a Runnable in the main activity.

This works well, if the main Activity is running, the runnable will be executed and something happens, if the user has started a `ActivityforResult` the service realised that the main activity is not onForeground and do something in the background. But if the main activity is destroyed, the service will restart the main activity and i don't want that ^^

I know, quite strange, but i dont know how to realise the things i need in a other way...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-30T09:39:49.290

但是当你回到你的活动时，它会被重新创建。
您需要做的就是使用`onSaved`实例和其他方式保存您的活动状态。

您还可以将检查放入您`onLowMemory`获得的应用回调中。

请点击 SO 上的链接。
这可能会有所帮助。

[处理 DVM 杀死你的活动](https://stackoverflow.com/questions/7652662/handling-dvm-killing-your-activity)

# css - 我可以更换扩展图标 (▶) 元素？

> ID：10813581
> 
> 赞同：48
> 
> 时间：2012-05-30T09:32:38.333
> 
> 标签：css, html

我在我的网站中使用了该`<details>`元素，并且我想更改展开/折叠箭头的设计。是否可以设置图片而不是现有字符？

另外，是否可以更改箭头的位置？我希望它在右侧，而不是在摘要文本旁边。

* * *

## 回答 #1

> 赞同：58
> 
> 时间：2012-05-30T09:37:33.253

由于`<summary>`has `dipslay: list-style`，可以通过设置属性来自[定义公开标记：](https://developer.mozilla.org/en-US/docs/Web/HTML/Element/details#Customizing_the_disclosure_widget)[`list-style-type`](https://developer.mozilla.org/en-US/docs/Web/CSS/list-style-type)

```
details > summary {
    list-style-type: '▶️';
}

details[open] > summary {
    list-style-type: '';
}

details {
    border: 1px solid gray;
    border-radius: 0.2rem;
    padding: 0.5rem;
}

details[open] > summary {
    margin-bottom: 0.5rem;
}
```

```
<details>
<summary>An example</summary>

With some example text shown when expanded.
</details>
```

不幸的是，一些当前一代的浏览器（嗯，Safari ......）*仍然*不支持这个。一种解决方法是设置`list-style: none`，然后`content`通过[`::marker`](https://developer.mozilla.org/en-US/docs/Web/CSS/::marker)伪元素提供自定义。这仍然可以用于提供进一步的定制。除了……好吧，Safari也不支持`::marker`，它只支持非标准的`::-webkit-details-marker`。它不支持在其中设置自定义内容。因此，我们需要*隐藏*元素并通过以下方式设置实际图标`::before`：

```
details > summary {
    list-style-type: none;
}

details > summary::-webkit-details-marker {
    display: none;
}

details > summary::before {
    content: '▶️';
}

details[open] > summary::before {
    content: '';
}

details {
    border: 1px solid gray;
    border-radius: 0.2rem;
    padding: 0.5rem;
}

details[open] > summary {
    margin-bottom: 0.5rem;
}
```

```
<details>
<summary>An example</summary>

With some example text shown when expanded.
</details>
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2015-09-17T00:20:57.013

> 是否可以设置图片而不是现有字符？

这当然是可能的——将baskground 图像设置为您的图标并将原始标记的颜色设置为透明会产​​生这种效果。

例子：

```
details summary::-webkit-details-marker {
    background: url(/images/toggle-expand.png) center no-repeat;
    color: transparent;
}
details[open] summary::-webkit-details-marker {
    background: url(/images/toggle-collapse.png) center no-repeat;
    color: transparent;
} 
```

这仅适用于 Webkit 浏览器和 Chrome。您可能需要考虑旋转图标而不是用不同的图标替换它，在这种情况下，您可以使用以下内容：

```
summary::--webkit-details-marker {
    transform: rotate(-90deg);
}

details[open] summary::--webkit-details-marker {
    transform: rotate(0deg);
}

[dir="rtl"] summary::--webkit-details-marker {
    transform: rotate(90deg);
}

[dir="rtl"] details[open] summary::--webkit-details-marker {
    transform: rotate(0deg);
} 
```

如果图标最初指向下方，则此解决方案会旋转图标。它还考虑了`details`RTL 父级中的元素；如果在整个文档中使用多个文本方向，请小心使用这种方法。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2021-02-05T11:05:28.753

您可以添加此样式

```
details>summary {
  list-style-type: none;
  outline: none;
  cursor: pointer;
  border: 1px solid #eee;
  padding: 5px;
  border-radius: 5px;
}

details>summary::-webkit-details-marker {
  display: none;
}

details>summary::before {
  content: '+ ';
}

details[open]>summary::before {
  content: '- ';
}

details[open]>summary {
  margin-bottom: 0.5rem;
}
```

```
<details>
  <summary>Click here</summary>
  Some text!
</details>
```

很简单！

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2020-08-10T01:38:18.707

我找到的最好的代码是在[http://html5doctor.com/the-details-and-summary-elements/](http://html5doctor.com/the-details-and-summary-elements/)上，这个巧妙的小技巧站得住脚。你可以在伪元素中放置任何你想替换的图标。

```
summary::-webkit-details-marker {
  display: none
}
summary:after {
  background: red;
  border-radius: 5px;
  content: "+";
  color: #fff;
  float: left;
  font-size: 1.5em;
  font-weight: bold;
  margin: -5px 10px 0 0;
  padding: 0;
  text-align: center;
  width: 20px;
}
details[open] summary:after {
  content: "-";
} 
```

[代码输出图片](https://i.stack.imgur.com/dfO53.png)

链接到一个小站点，您可以在该站点上使用开发工具来查看它是如何工作的[http://output.jsbin.com/egefop/15#html,live](http://output.jsbin.com/egefop/15#html,live)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-10-26T11:57:25.143

[MDN 说](https://developer.mozilla.org/en-US/docs/Web/HTML/Element/summary)

> 您还可以更改要显示的样式：块以删除显示三角形。

截至 2021 年，所有主流浏览器都支持此功能，不再需要`-webkit-details-marker`。

```
summary {
  display: block;
}

summary::after {
  margin-left: 1ch;
  display: inline-block;
  transition: 0.2s;
  content: '\203A'; /* chevron */
}

details[open] summary::after {
  transform: rotate(90deg);
}
```

```
<details>
  <summary>Summary</summary>
  Details provided if clicked.
</details>
```

# ios - iOS Create a Unique Identifier for Pictures

> ID：10813582
> 
> 赞同：3
> 
> 时间：2012-05-30T09:32:42.477
> 
> 标签：ios, image, iphoto, picturegallery

I want to import pictures from the photo library on iOS but I want to check that I haven't already done so in the past.

What can I use as a unique identifier to check for?

What I thought so far are these:

1.  Created Date ( This might have a low probability of conflict, might have pictures taken at the same time or saved at the same time by iphoto)
2.  Pictures filesize (Depending on how accurate I can get this number)
3.  A combination of the two?
4.  Exif Data? (Works well for pictures taken but what if you have images with no Exif?)

What are you using?

Thanks

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-30T09:37:14.833

当我遇到这样的问题时，我使用的是日期（在本例中为 unix 时间戳）和文件名组合的 MD5-Hash。我认为这应该是独一无二的。

# unity3d - Unity3D：像素字节数组到 Color32 数组（结合 ZXing 和 Vuforia）

> ID：10813591
> 
> 赞同：1
> 
> 时间：2012-05-30T09:33:00.387
> 
> 标签：unity3d, pixel, qr-code, zxing, qcar-sdk

也许有人可以帮助我。我需要一个 Color32[] 数组，方法是调用 GetPixels32()。这是带有网络摄像头的 QR 码阅读器的一个很好的解决方案。 [如何使用 Unity3D 解码二维码](http://ydaira.blogspot.de/2012/05/how-to-decode-qr-code-using-unity3d.html)

不幸的是，Vuforia 只能给出一个字节数组......

```
Image.PIXEL_FORMAT mPixelFormat = Image.PIXEL_FORMAT.RGB565;
Image cameraImage = CameraDevice.Instance.GetCameraImage(mPixelFormat);
byte[] pixels = cameraImage.Pixels; 
```

有谁知道如何将 Pixel 字节数组制作成 Color32 数组？ [这](https://ar.qualcomm.at/arforums/showthread.php?t=2209&referrerid=11163)是我在 Vuforia 论坛上的问题。

也许任何人在 Unity for Android 和 iOS 中都有任何其他的二维码解码解决方案。我将非常感谢您的帮助。

编辑：[这](http://answers.unity3d.com/questions/259781/pixel-byte-array-to-color32-array-combine-zxing-wi.html)是 unityAnswers 中的相同问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-10T21:57:06.110

看起来您正在请求 16 位 R5G6B5 格式的图像数据，所以我希望这就是数据格式：5-6-5 位格式的字节对。因此，将两个字节转换为常规 Color 结构类似于：

```
color.r = (byte[0] & 0x1f) / (float)(0x1f);
color.g = ((byte[1] & 0x07) | ((byte[0] & 0xe0) >> 5)) / (float)(0x3f);
color.b = ((byte[1] & 0xf8) >> 3) / (float)(0x1f); 
```

然后，您可以通过投射将 Color 转换为 Color32。

也就是说，如果您可以请求 24 位格式而不是 16 位格式的图像数据，那么您可以直接将字节值提供给 Color32 的通道。

# html - 为什么要使用“for”关键字来绑定 HTML 中的标签？

> ID：10813592
> 
> 赞同：44
> 
> 时间：2012-05-30T09:33:01.527
> 
> 标签：html

> **可能重复：**
> [HTML 标记中的 For 属性是什么？](https://stackoverflow.com/questions/3681601/what-is-the-for-attribute-for-in-an-html-tag)

我一直在试图找出这一点。在 HTML 中使用标签时使用“for=”的原因是什么？

```
<form>
  <label for="male">Male</label>
  <input type="radio" name="sex" id="male" />
  <br />
  <label for="female">Female</label>
  <input type="radio" name="sex" id="female" />
</form> 
```

如果需要，那么 HTML 5 中是否有一些等价物或者是一样的？

* * *

## 回答 #1

> 赞同：63
> 
> 时间：2012-05-30T09:35:23.643

它使标签上的点击成为输入元素的焦点`for`。

在您发布的示例中，您只需单击单词`Male` *或*单选按钮即可将其选中。没有这个，你点击的目标要小得多......

> 如果需要，那么 HTML 5 中是否有一些等价物或者是一样的？

这不是必需的，但对于具有要关注的直接表单元素的标签来说是一种很好的做法（对于在表单上没有对应元素的标签没有多大意义）。

HTML 5 的语法相同。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2012-05-30T09:35:06.890

For 将 the`<label>`和`<input>`字段绑定在一起。应该`for`指向`id`. `<input>`它实际上不是必需的，但它很有用，例如在单选按钮上，用户可以单击标签来检查单选按钮，从而创建更大的点击区域和更好的用户体验。

您`for`在 HTML5 中的使用方式与在 HTML4 或 XHTML 或您之前使用的任何方式中使用的方式相同。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2012-05-30T09:36:42.040

如果您使用`for`标签的属性，并将其值设置`id`为相关`input`元素的值，则大多数浏览器会在单击标签时聚焦输入元素。这对于复选框和单选按钮等小元素特别有用。

# xslt - XSLT: Is it possible to select unique IDs into variable ordered by a criteria other than the ID itself?

> ID：10813595
> 
> 赞同：0
> 
> 时间：2012-05-30T09:33:10.263
> 
> 标签：xslt

Imagine the following xml

```
<elements>
  <element>
    <elementID>0x1000</elementID>
    <elementSort>1</elementSort>
    <elementName>Master Joda</elementName>
    <modifyDate>1979-01-01</modifyDate>
  </element>
  <element>
    <elementID>0x1000</elementID>
    <elementSort>1</elementSort>
    <elementName>Master Yoda</elementName>
    <modifyDate>1979-01-05</modifyDate>
  </element>
  <element>
    <elementID>0x2000</elementID>
    <elementSort>2</elementSort>
    <elementName>Luke Skywalker</elementName>
    <modifyDate>1979-01-08</modifyDate>
  </element>
</elements> 
```

I use the following xslt to select a list of unique IDs into a variable

```
<xsl:variable name="ids" 
   select="elements/element/elementID[not(.=following::elementID)]" /> 
```

Then i let xslt build some html for each ID (the output will be a horizontal list of elements per ID)

```
<xsl:for-each select="$ids">

  <xsl:variable name="elementID" select="." />

  <div class="itemContainer clear" style="width:{$containerWidth}">

    <xsl:for-each select="/elements/element[elementID=$elementID]">

      <xsl:sort select="modifyDate" />

      <xsl:call-template name="elementTemplate" />

    </xsl:for-each>

  </div>

</xsl:for-each> 
```

The problem is: how can i sort the elements in the first level of the for-each nesting (the IDs) without having the Element by which i want to sort in the list itself (the ID list).

In practical terms: how can i sort by Jedi hierarchy (master -> pupil), if elementSort 1 means master and elementSort 2 means pupil, having multiple elements per hierarchy in each row, which are then ordered by modifyDate.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-30T14:25:40.933

**而不是**：

```
<xsl:for-each select="/elements/element/elementID[elementID=$elementID]">        
  <xsl:sort select="modifyDate" />        
  <xsl:call-template name="elementTemplate" />      
</xsl:for-each> 
```

**顺便说一句，上面显然是不正确**的，因为一个`elementID`元素根本没有任何子元素`elementID`。

**使用**：

```
<xsl:for-each select="/elements/element[elementID=$elementID]">        
  <xsl:sort select="elementSort" data-type="number" />        
  <xsl:sort select="modifyDate" />        
  <xsl:call-template name="elementTemplate" />      
</xsl:for-each> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-31T07:54:17.803

我找到了一个解决方案，尽管它可能不是很好的“xslt-design”。

我将唯一 elementSorts 的列表存储在一个附加变量中，并在原始第一个变量周围放置另一个 for-each。然后我结合条件（唯一性和 sortID），同时设置保存唯一元素 ID 的变量。

```
<xsl:variable name="ids" 
   select="elements/element/elementID[not(.=following::elementID) and ../elementSort=$sort]" /> 
```

编辑：

可能更好：

```
<xsl:variable name="ids" 
   select="elements/element[elementSort=$sort]/elementID[not(.=following::elementID)]" /> 
```

**另一个注意事项**

如果 xml 文档中有其他节点可以包含 elementID 节点，则您必须按如下方式指定以下:: 子句以避免不必要的行为：

```
<xsl:variable name="ids" 
   select="elements/element[elementSort=$sort]/elementID[not(.=following::element/elementID)]" /> 
```

这样，在评估唯一性时仅考虑元素节点内部的 elementID，如果存在通过 elementID 与元素节点相关的节点，则会派上用场。

# iphone - Access UI components Inside controllers init method

> ID：10813599
> 
> 赞同：0
> 
> 时间：2012-05-30T09:33:25.453
> 
> 标签：iphone, objective-c

I'm trying to hide a button inside the controller's init method. But its not working. I have created a outlet to the image to access it from the controller. Dont know why the image is not get hidden.But I can do it inside the viewdidload method. Is it because the view still not loaded?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-30T09:35:37.767

是的，视图将在调用 viewdidload 时加载。所以对现有 UI 的任何更改都应该在视图中调用，加载或视图将出现

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-30T09:40:02.853

您正在谈论的 UI 组件都是您正在创建的 UIViewController 拥有的 UIView 的所有子视图。但是在调用 init 方法时实际上并没有创建 UIView 及其子视图，因此您不能在那里更改它们。

`viewDidLoad`是任何只需要在视图创建后、显示之前运行一次的代码的合适位置。

`viewWillAppear:`并且`viewDidAppear:`将在每次视图即将或刚刚再次变得可见时运行。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-30T09:51:01.717

`loadView`实际上，当消息发送到控制器时，整个视图层次结构将被加载。当您第一次访问控制器的视图时，也会自动发送此消息。这就是为什么您的按钮消息在`init`方法中被丢弃，因为该对象尚未从`xib`/中“解冻” `storyboard`。是的，进行视图自定义的适当位置将在`viewDidLoad`委托方法内。

PS。另外...如果您希望在初始化时隐藏按钮，为什么不检查它`hidden`在`xib`/中的属性`storyboard`？

# java - How to send user input to terminal from java program (i.e by programmatically)?

> ID：10813608
> 
> 赞同：2
> 
> 时间：2012-05-30T09:33:48.003
> 
> 标签：java, linux, ubuntu, terminal, sudo

I am executing command from java program like

```
Process myProcess = Runtime.getRuntime().exec("sudo cat /etc/sudoers"); //It asks for password so I send password through outputstream from my program.

InputStream inputStream = myProcess.getInputStream();
OutputStream outputStream = myProcess.getOutputStream();
outputStream.write("mypassword".getBytes()); // write password in stream
outputStream.flush();
outputStream.close(); 
```

But problem is that, it again ask to me for password as I already send the password through outputstream from my program. For solving this I tried so many times but not actually done.

By using shell script,I am able to provide password to terminal and my program works fine but it is not the most flexible way.

Can you suggest me any way for providing password through my java program ? (instead of shell programming)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-30T09:46:46.697

您可以使用`-S`sudo 选项来执行此操作：

```
String[] cmd = {"/bash/bin","-c","echo yourpassword| sudo -S your command"}; 
Runtime.getRuntime.exec(cmd); 
```

但我不确定它是否值得推荐。

我不是作者，我在那里找到了这个：http: [//www.coderanch.com/t/517209/java/java/provide-password-prompt-through-Java](http://www.coderanch.com/t/517209/java/java/provide-password-prompt-through-Java)

# django - Django - 渲染响应

> ID：10813611
> 
> 赞同：2
> 
> 时间：2012-05-30T09:33:56.677
> 
> 标签：django, django-templates, django-views

我在我的 Django 视图中使用以下代码

```
data = {'d':['a','b','c']}
return render_to_response('login/invalid.html',data) 
```

现在我希望我的`invalid.html`页面具有将列表转换`['a','b','c']`为 javascript 变量数组的代码，以便我可以填充下拉菜单。但我无法将这些元素转换为 javascript 数组。

```
var arr = "{{ 'd' }}" 
```

将列表作为字符串而不是数组请帮助

* * *

此代码使用数组创建下拉列表

```
<select >
              <script type="text/javascript">

              {% autoescape off %}
              var veg = {{ d }}
              {% endautoescape %}

                 for (i = 0; i < veg.length; i++) {
                     document.write('<option>')
                     document.write(veg[i])                   
                     document.write('</option>')                    
                }
             </script>            
         </select> 
```

* * *

```
 d = json.dumps(['a','b','c'])
                #d = serializers.serialize("json", ['a','b','c'])
                #data={"d":json.dumps(['1','2','3','4'])}
                #data={}
                data = {'d':d}

                #data["read"] = json.dumps(",".join(['abc']))

                #return render_to_response('login/invalid.html',json.dumps(data),context_instance=RequestContext(request))

                return render_to_response('login/invalid.html',data,context_instance=RequestContext(request)) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-30T09:53:44.723

您可能希望将[数据序列化为](https://docs.djangoproject.com/en/dev/topics/serialization/#serializing-django-objects)json：

```
import json

d = json.dumps(['a','b','c']) 
# now d actually has a json string
data = {'d':d}
return render_to_response('login/invalid.html',data) 
```

然后在你的模板中

```
// arr now holds the list
{% autoescape off %}
var arr = {{ d }}
{% endautoescape %}
console.log(arr);
arr.doSomething(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-30T09:38:12.057

通过将列表转换为 JSON`json`并在模板中输出，并根据需要将其标记为安全。

# ruby-on-rails - to_json returns nil in a field if its black, ios can't interpret that null in ror

> ID：10813613
> 
> 赞同：3
> 
> 时间：2012-05-30T09:34:03.803
> 
> 标签：ruby-on-rails, json

How to change the field values from null to "" in the output of to_json?

It currently returns

```
{"name":"priya","mobile":null} 
```

instead I want

```
{"name":"priya","mobile":""} 
```

or

```
{"name":"priya","mobile":"NA"} 
```

Please suggest

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-30T11:44:52.703

要添加到 philee 的答案，您可以在模型中添加一个 as_json 方法。

```
def as_json(opts={})
  json = super(opts)
  Hash[*json.map{|k, v| [k, v || "NA"]}.flatten]
end 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-30T09:52:50.897

```
s = {"name" => "pryia", "mobile" => nil} 

Hash[*s.map{|k, v| [k, v || "NA"]}.flatten]
# => "name"=>"pryia", "mobile"=>"NA"}

Hash[*s.map{|k, v| [k, v || "NA"]}.flatten].to_json
# => "{\"name\":\"pryia\",\"mobile\":\"NA\"}" 
```

# jquery - 结合 .toggle() 和表单验证

> ID：10813624
> 
> 赞同：1
> 
> 时间：2012-05-30T09:34:42.103
> 
> 标签：jquery, forms, validation, toggle

我有一个使用此插件验证的表单：http: [//bassistance.de/jquery-plugins/jquery-plugin-validation/](http://bassistance.de/jquery-plugins/jquery-plugin-validation/)

我决定使用`.toggle()`.

这是表格：

```
<form id="identification" action="Test.php" method="post">
    <fieldset>
        <legend>Identification</legend>
        <p>
            <label for="firstName">First name</label>
            <input id="firstName" type="text" name="firstName" class="required"/>
        </p>
        <p>
            <label for="lastName">Last name</label>
            <input id="lastName" type="text" name="lastName" class="required"/>
        </p>
        <p>
            <label for="email">E-mail address</label>
            <input id="email" type="text" name="email" class="required email"/>
        </p>
        <div class="hiddenFields">
            <p>
                <label for="zip">Zip code</label>
                <input id="zip" type="text" name="zip" class="required zip"/>
            </p>
            <p>
                <label for="city">City</label>
                <input id="city" type="text" name="city" class="required"/>
            </p>        
        </div>
        <p class="showFields"><a class="toggle" href="#">Click here</a> for more info</p>
    </fieldset> 
    <p class="submit"><input type="submit" value="Submit"/></p>
</form> 
```

`.hiddenFields`div 设置为在我的`display: none;`CSS 中。

这是验证脚本：

```
$(document).ready(function(){
    $("#identification").validate({
        rules: {
                "zip": { digits:true, minlength:5, maxlength:5 }
        }
    });

    jQuery.extend(jQuery.validator.messages, {
        required: "This field is needed.",
        email: "Please enter a valid e-mail address.",
        digits,minlength,maxlength: "Please enter a valid zip code.",
        minlength: "Please enter a valid zip code.",
        maxlength: "Please enter a valid zip code."
    });
}); 
```

这是切换脚本：

```
$(document).ready(function(){
    $("a.toggle").click(function(e){
        e.preventDefault();
        $(".hiddenFields").toggle("fast");
    });
}); 
```

`.hiddenFields`现在，没有div 和没有 div一切正常，`.toggle()`但是当我尝试添加它时，验证不再起作用，我真的不明白为什么。

当字段被隐藏和不被隐藏时，我如何设法验证此表单？它目前在这两种情况下都不起作用。

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-30T10:17:20.130

[这是在 jsFiddle 上](http://jsfiddle.net/jp2nj/)。

您有一个流氓`digits,minlength,`导致语法错误：

```
jQuery.extend(jQuery.validator.messages, {
   required: "This field is needed.",
   email: "Please enter a valid e-mail address.",
   digits,minlength,maxlength: "Please enter a valid zip code.",
   minlength: "Please enter a valid zip code.",
   maxlength: "Please enter a valid zip code."
}); 
```

你也进了`maxlength`两次。

将其更改为此将修复它：

```
jQuery.extend(jQuery.validator.messages, {
   required: "This field is needed.",
   email: "Please enter a valid e-mail address.",
   minlength: "Please enter a valid zip code.",
   maxlength: "Please enter a valid zip code."
}); 
```

# dojo - Dojo 甘特图示例不呈现

> ID：10813625
> 
> 赞同：1
> 
> 时间：2012-05-30T09:34:42.303
> 
> 标签：dojo

我只是拿了[道场甘特图示例](http://archive.dojotoolkit.org/nightly/dojotoolkit/dojox/gantt/tests/test_Gantt.html)并将其放入我的代码中，现在**[这个小提琴](http://jsfiddle.net/a2YjK/)**，没​​有任何渲染，没有任何错误。我错过了什么吗？似乎 onLoad 没有运行，在我的 Chrome 控制台网络选项卡中，没有 404 的问题，而且看起来所有下载的东西都很好？

**更新**

我认为这里的问题在于 require `GanttChart`。如果我**[对此发表评论，](http://jsfiddle.net/a2YjK/1/)**至少我会进入`onLoad`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-07T05:49:58.783

Dojo 1.7.2 中的甘特图似乎存在问题。当我切换到 v 1.7.1 时，它工作正常（对于我的实现，也适用于你的小提琴）。

# c# - 在 CRM 项目中的联系人之间建立家庭关系

> ID：10813626
> 
> 赞同：1
> 
> 时间：2012-05-30T09:34:50.293
> 
> 标签：c#, sql-server, sql-server-2008, tree

我想建立联系人之间的家庭关系，并发现联系人之间的隐藏关系并使用 sql server 中的递归显示它。例如：我有这张表，其中包含：

```
User_id_1   User_id_2   relation
1           2           Parent-child
2           3           Brother-brother
3           4           Brother-brother 
```

我的存储过程应该发现特定用户 ID 的所有关系。如果用 user_id=4 调用这个 sp，它应该给我 user_id=4 的所有关系，它应该知道 4 是 3 和 2 的兄弟，1 是 4 的父级。我怎么能这样做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-30T09:45:09.570

您可以从另外 2 个表开始，1 个用于配置关系（类似于您当前的`relation`列），另一个用于配置在递归查找期间要遍历的关系。

```
Table: Relationship
Id: int
Description: string

Table: RelationshipToRelationship
FromRelationshipId: int
ToRelationshipId: int 
```

数据如下所示：

**关系**

```
Id   Description
==   ===============
1    Brother-Brother
2    Parent-Child 
```

**关系到关系**

```
FromRelationshipId   ToRelationshipId 
==================   ================
1                    1
1                    2 
```

如果/当我解决它时，将更新一个可行的查询

我预见的问题：

*   您提出了最简单的情况（我兄弟的父母是我的父母），但在其他情况下就崩溃了（我兄弟的孩子不是我的孩子）。
*   标记关系的类似问题（您可以将我兄弟的父母标记为`Parent-Child`我，但您兄弟的孩子需要标记`Brother-Brother-Parent-Child`）。

一切都很快变得混乱。保持希望关联的每一方之间的直接关系不是更好吗（即，表中的另外 2 条记录将用户 4 和 2 连接为 Brother-Brother 和 4 和 1 作为 Parent-Child）？

# android - 检查 WIFI 热点上的互联网连接

> ID：10813635
> 
> 赞同：2
> 
> 时间：2012-05-30T09:35:20.777
> 
> 标签：android, networking

我想检查设备是否真正连接到互联网，甚至连接到需要登录的打开的 wifi 热点。
经典代码：

```
ConnectivityManager cm = (ConnectivityManager) getSystemService(Context.CONNECTIVITY_SERVICE);
NetworkInfo netInfo = cm.getActiveNetworkInfo();
if (netInfo != null && netInfo.isConnected() && netInfo.isAvailable(){
   //connection on
} 
```

可以正常查看设备已连接，但不是真正的互联网。

我用 ：

```
URL url = new URL("http://www.google.com");
    HttpURLConnection urlConnection = (HttpURLConnection) url.openConnection();
                urlConnection.setConnectTimeout((int)(1000 * TIMEOUT)); 
                urlConnection.connect();
                if (urlConnection.getResponseCode() == 200 && url.getHost().equals(urlConnection.getURL().getHost())) {
       //I am supposed to be connected
    } 
```

因为当连接到热点时，我们通常会被重定向到登录页面。虽然，在我的测试中，httpUrlConnection 没有被重定向，然后 urlConnection.getURL.getHost() 真的是“google.com”。

该怎么办？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-31T13:59:23.153

从 Android 4.0.1 android.net.wifi.WifiWatchdogStateMachine 获得：

```
private boolean isConnected() {
        HttpURLConnection urlConnection = null;
        try {
            URL url = new URL("http://clients3.google.com/generate_204");
            urlConnection = (HttpURLConnection) url.openConnection();
            urlConnection.setInstanceFollowRedirects(false);
            urlConnection.setConnectTimeout(10000);
            urlConnection.setReadTimeout(10000);
            urlConnection.setUseCaches(false);
            urlConnection.getInputStream();
            return urlConnection.getResponseCode() == 204;
        } catch (IOException e) {
            log("Walled garden check - probably not a portal: exception " + e);
            return false;
        } finally {
            if (urlConnection != null) urlConnection.disconnect();
        }
} 
```

# javascript - 将 MVC 模型序列化为 JSON

> ID：10813636
> 
> 赞同：0
> 
> 时间：2012-05-30T09:35:22.007
> 
> 标签：javascript, asp.net, json, asp.net-mvc-3

我正在尝试做一个非常简单的任务：获取一个 MVC 模型，并将其作为 JSON 发送回服务器。我试过了

```
 @Html.Raw(Json.Encode(Model)); 
```

在调试 JS 时，我看到序列化 JSON 上的日期对象如下所示：`/date (00064321)/`当将序列化 JSON 传递给服务器时，服务器端的日期为空。任何人都明白发生了什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-30T12:32:08.533

您必须创建一个匿名对象，将日期时间属性转换为字符串，而不是直接对模型进行 JSON 编码。

前任。

```
var meeting = new Meeting 
              { 
                  Name = "Project Updates", 
                  StartDateTime = DateTime.Now 
              }; 
```

直接传递模型..

```
@Html.Raw(Json.Encode(meeting)) 
```

生产

```
{"Name":"Project Updates","StartDateTime":"\/Date(1338381576306)\/"} 
```

和

```
@Html.Raw(Json.Encode(new { 
                  Name = meeting.Name, 
                   StartDateTime = meeting.StartDateTime.ToString()
})) 
```

生产

```
{"Name":"Project Updates","StartDateTime":"5/30/2012 6:09:36 PM"} 
```

正如预期的那样。

# git - Git 压缩我从其他人那里提取的本地提交

> ID：10813638
> 
> 赞同：1
> 
> 时间：2012-05-30T09:35:23.003
> 
> 标签：git

我想使用 rebase -i 压缩一些本地提交，但我已经在我的本地提交之间拉入并合并了其他人的更改。这个命令还能用吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-30T09:41:57.570

我相信它在前一段时间得到了对 rebase 合并的支持，所以试试吧。

但即使没有，您也可以在合并后的更改后创建新分支，并用于`git cherry-pick`在此处应用您的更改，而不是使用 rebase 调整它们。

对于将来，使用`git pull --rebase`或`git fetch`后跟`git rebase`( `-i`) 而不是直接拉到您的私有工作分支，因此您的更改最终会重新基于您拉取的内容，而不是与合并混合。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-30T12:40:38.467

从`git rebase`手册页：

> -p, --preserve-merges 不要忽略合并，而是尝试重新创建它们。

它还包括警告：

> 这在内部使用了 --interactive 机制，但除非您知道自己在做什么，否则将其与 --interactive 选项显式结合通常不是一个好主意。

警告指的是[这里的讨论。](http://thread.gmane.org/gmane.comp.version-control.git/148059/focus=148092)在重新排序提交时，发布`git rebase -i -p`可能会导致意外结果，因此我建议您熟悉[撤消坏变基的多种方法。](https://stackoverflow.com/a/135614/877115)最重要的是，请记住变基的黄金法则：永远不要变基您与他人共享的历史记录。

# firefox-addon - 如何从工具栏按钮库将面板添加到图标

> ID：10813643
> 
> 赞同：2
> 
> 时间：2012-05-30T09:35:47.937
> 
> 标签：firefox-addon, firefox-addon-sdk

我尝试使用 Erik Vold 的工具栏按钮库在地址栏附近添加一个按钮。但它没有像小部件那样的面板选项。我只想要与带有 onclick 面板的小部件一样，但图标应该靠近地址栏或类似的东西。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-30T21:52:47.427

工具栏按钮模块中有一个面板选项，iirc 与小部件模块的工作方式相同。

[https://github.com/voldsoftware/toolbarbutton-jplib/blob/master/docs/toolbarbutton.md](https://github.com/voldsoftware/toolbarbutton-jplib/blob/master/docs/toolbarbutton.md)

# html - node.js 服务器，显示包含 jqGrid 插件的 HTML 文件。

> ID：10813644
> 
> 赞同：0
> 
> 时间：2012-05-30T09:35:48.763
> 
> 标签：html, json, node.js, jqgrid, treegrid

我有一个包含 jqGrid 插件的简单 HTML 文件。我正在使用 jqGrid 插件在我的 HTML 页面中有一个树形网格。

现在，我试图在 node.js 服务器中托管这个 HTML 文件。我的 server.js 看起来像这样

```
var http = require('http');
var fs = require('fs');
var path = require('path');

http.createServer(function (request, response) {

console.log('request starting...');

var filePath = '.' + request.url;
console.log('filePath : '+filePath);

if (filePath == './')
    filePath = './tree.html';

var extname = path.extname(filePath);
console.log('extname : '+extname);

var contentType = 'text/html';

switch (extname) {
    case '.js':
        contentType = 'text/javascript';
        break;
    case '.css':
        contentType = 'text/css';
        break;
}

path.exists(filePath, function(exists) {
    if (exists) {
        fs.readFile(filePath, function(error, content) {
            if (error) {
                response.writeHead(500);
                response.end();
            } else {
                response.writeHead(200, { 'Content-Type': contentType });
                response.end(content, 'utf-8');
            }
        });
    } else {
        response.writeHead(404);
        response.end();
    }
});

}).listen(8125); 
```

到目前为止，我可以在浏览器中显示我的 HTML 内容 [http://localhost:8125/]

我的部分 HTML(tree.html) 文件如下所示

```
jQuery("#treegrid").jqGrid({ 
          url: 'tree.json', 
          datatype: 'json', 
          //mtype: 'GET', 
          colNames: [/* "ID",  */"Col 1", "Col 2",.. ],
          colModel: [/* { 
              name: 'id', 
              index: 'id', 
              width: 1, 
              hidden: true, 
              key: true 
          },  */{ ... 
```

如果您注意到，我已将“tree.json”指定为 URL 属性以加载树形网格。那只是读取一个静态文件以加载带有示例数据的树形网格。

**问题：**现在，当我尝试使用 [http://localhost:8125/] 访问我的 HTML 文件时，我收到[http://localhost:8125/tree.json]的**404 Not Found错误**

**快速解决方案：**我可以指定文件“tree.json”的相对路径，它可以工作。

我的 HTML 文件**tree.html**和**tree.json**都在同一个目录（/tree）中，我像这样从命令提示符（终端）启动我的 node.js 服务器

```
tree> node server.js 
```

我想知道我可以在哪里放置我的**tree.json**以使我的 HTML 按预期工作。

请随时询问任何澄清。

提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-30T10:17:47.643

你用线

```
var filePath = '.' + request.url; 
```

在您的代码中，这似乎有点奇怪。可能在您提出要求的情况下`'tree.json'`，您可能想要拥有`.tree.json`的值`filePath`而不是值。`./tree.json`我认为你应该在这里修复代码。

此外，在扩展的情况下，最好设置`'application/json'`为`contentType`变量的值，`.json`就像你设置`'text/javascript'`和`'text/css'`for`'.js'`和`'.css'`文件一样。

# python - 突然我在使用 runserver 时没有定义 DJANGO_SETTINGS_MODULE

> ID：10813651
> 
> 赞同：3
> 
> 时间：2012-05-30T09:36:17.927
> 
> 标签：python, django

完整的错误是：

```
ImportError: Could not import settings 'app.settings' (Is it on sys.path?): No module named settings 
```

整个时间，

```
python manage.py runserver 
```

一直工作正常，并且`DJANGO_SETTINGS_MODULE`以前从未定义过 - 这不是这里的问题，因为我正在运行`manage.py`它应该自行设置。

我添加了一些导入后出现了问题 - runserver 立即停止工作。我也无法进行验证 - 没有任何效果。设置`DJANGO_SETTINGS_MODULE`也无济于事，尽管这是错误所暗示的。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-30T09:37:54.523

添加内部 django 函数的顶级导入可能会以非常不明显的方式破坏 django。

```
from django.core import context_processors 
```

是在一个很早就导入到 settings.py 的文件中，这导致了这个错误。

在我看来，django 可以使用更好的方法来检测此类问题。导致问题的行根本没有出现在回溯中。

# php - url重写以在php中提交

> ID：10813652
> 
> 赞同：0
> 
> 时间：2012-05-30T09:36:32.273
> 
> 标签：php

有谁知道如何在 php 中为提交操作重写 URL？

例子：

我有如下代码：

我使用以下链接 www.assignment.com 调用该页面（我已将索引设置为 test.php），test.php 将显示以下代码。

```
<form action="test.php" method="post">
  <input type="text" name="phone" value="">
  <input class="submit_btn" type="submit" name="submit" id="submit" value="SUBMIT">
</form> 
```

当我单击提交按钮时，它将发布到 test.php 以执行操作并显示相同的输入页面。但是，一旦单击提交按钮，url 链接将变为 www.assignment.com/test.php。有什么方法可以在提交后将 URL 重写为 www.assignment.com 而不是 www.assignment.com/test.php？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-30T09:42:24.087

您可以在脚本`header("Location: www.assignment.com");`末尾使用。`test.php`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-30T09:44:58.550

如果您在加载`test.php`时运行`http://assignment.com/`，您可以将表单目标更改为：

```
<form action="/" method="post"> 
```

# xml - Xpath：根据条件选择节点（使用本地名称（））

> ID：10813653
> 
> 赞同：30
> 
> 时间：2012-05-30T09:36:39.497
> 
> 标签：xml, xpath

这个问题很愚蠢，但我完全被卡住了。我想根据条件提取节点的子节点。XML如下：

```
<a> 
 <aCode>aaa</aCode>
 <aValue>bbb</aValue>
</a> 
```

表达很明显：`//a[aCode='aaa']`

但是如果它与命名空间一起使用并且我必须使用`local-name()`. 我已经测试了以下内容，它给出了解析错误：

```
/*[local-name()='a'][[local-name()='aCode']='aaa'] 
```

有人知道我应该做什么吗？

* * *

## 回答 #1

> 赞同：51
> 
> 时间：2012-05-30T09:59:39.867

你可能是说

```
//*[local-name()='a'][*[local-name()='aCode']='aaa'] 
```

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2012-05-30T09:45:16.043

**尝试这个**

```
/a/aCode[text()='aaa'] 
```

或者

```
//*[local-name() = 'aCode' and text() = 'aaa'] 
```

你用`//`错地方了。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2014-05-19T00:57:20.127

这一项工作：

```
//*[local-name()='a'][*[local-name()='acode' and text()='a2']] 
```

还有这个：

```
//*[local-name()='a'][aCode[text()='a2']] 
```

# extjs4 - 从面板 extjs 4 获取底栏

> ID：10813659
> 
> 赞同：0
> 
> 时间：2012-05-30T09:37:03.003
> 
> 标签：extjs4, panel, toolbar

我有这个带 bbar 的面板：

```
panelModellazioneMS = new Ext.Panel({
   anchor: '100% 95%',
   layout: 'card',
   border: false,
   padding: '5 5 0 5',
   bbar: [ 
     {
    id: 'move-prevMS',
    text: 'Indietro',
    handler: function(btn) {..}
     }  ]
}); 
```

我会在外部函数中禁用此面板的 bbar。我能怎么做？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-30T11:05:36.040

简单的方法是

```
panelModellazioneMS.query('#move-prevMS')[0] 
```

但一般 tbar 和 bbar 都存储在 panelModellazioneMS 中。**dockedItems**，第二种方法是从该数组中获取。

# c# - 记录导航

> ID：10813662
> 
> 赞同：0
> 
> 时间：2012-05-30T09:37:23.380
> 
> 标签：c#, sql-server, navigation

使用 C# 和 SQL 服务器，我希望能够浏览记录。我应该将所有记录加载到数据集中吗？数据库可能会变得非常大。做这个的最好方式是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-30T09:44:21.600

使用分页浏览记录始终是一个**好习惯**。因为内存是问题。您不应该在内存中加载大量数据......所以，分页是解决方案

如何在您的 gridview 控件中进行**自定义分页检查此**[分页](http://msdn.microsoft.com/en-us/library/aa479347.aspx)和[自定义分页](http://technico.qnownow.com/2012/03/30/custom-paging-in-asp-net-gridview-control/)。

![在此处输入图像描述](../Images/9c68bc1a32a7c463258d48df80565d26.png)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-30T09:39:45.303

**您应该使用自定义分页，并通过它获得您想要的数字或记录...实现此用途可以在您的 sql server 中使用网格视图和 cutomaging sp**

检查这个：[ASP.NET 扩展网格控件](http://pranayamr.blogspot.com/2010/04/aspnet-extended-grid-control.html)

EnhanceGrid 具有以下特点：

*   自定义分页以仅获取所需数量的记录
*   用于显示排序方向的列标题中的图标
*   分页器中的下拉菜单以调整页面中的记录数
*   扩展网格的属性
*   如何使用自定义网格控件

![在此处输入图像描述](../Images/96929db3aeadab4694c38673a8b77e47.png)

# rspec - 使用 rspec 测试 ActiveAdmin

> ID：10813663
> 
> 赞同：13
> 
> 时间：2012-05-30T09:37:30.677
> 
> 标签：rspec, rspec2, activeadmin, rspec-rails

我正在尝试开始测试 ActiveAdmin，特别是我需要测试来自 ActiveAdmin 控制器之一的 member_action。

你们知道关于这个主题的任何好的教程吗？

谢谢，

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-06-25T22:45:11.613

这就是我这样做对我有用的方式：-

# 应用程序/管理员/posts.rb

```
ActiveAdmin.register Post do

  menu :parent => "Admin"

  #path = /admin/posts/:id/comments
  member_action :comments do
   @post = Post.find(params[:id])
  end 
end 
```

# 规格/控制器/管理员/posts_controller_spec.rb

```
require 'spec_helper'
include Devise::TestHelpers

describe Admin::PostsController do
  render_views

  before(:each) do
    @user = mock_model(User, :email => "tester@localspecs.com")
    request.env['tester'] = mock(Tester, :authenticate => @user, :authenticate! => @user)
  end

  describe "Get comments" do
    before(:each) do
      @post = Post.create! valid_attributes
      Post.should_receive(:find).at_least(:once).and_return(@post)
      get :comments, :id => @post.id
    end

    after(:each) do
      @post.destroy
    end

    it "gets the proper record to update" do
      assigns(:post).should eq(@post)
    end

    it "should render the actual template" do
      response.should contain("Comments")
      response.body.should =~ /Comments/m
    end
  end
end 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2014-11-28T16:20:46.170

```
# app/admin/post.rb
ActiveAdmin.register Post do
end

# spec/controller/admin/posts_controller_spec.rb
describe Admin::PostsController do
  subject { get :index }
  its(:status) { should eq 200 }
end 
```

# objective-c - 设置 frame.origin 与 CGAffineTransformMakeTranslation 之间的性能差异

> ID：10813667
> 
> 赞同：3
> 
> 时间：2012-05-30T09:37:50.450
> 
> 标签：objective-c, ios, performance, cocoa-touch, position

我有一个类似网格的缩略图滚动视图，我首先初始化所有缩略图，然后将其框架设置为：

```
thumbnail.frame = CGRectMake(0, 0, 100, 100); 
```

然后稍后`willAnimateRotationToInterfaceOrientation`，重新定位这些缩略图：

```
thumbnail.transform = CGAffineTransformMakeTranslation(posX, posY); 
```

虽然在上述方法之后检查位置时：

```
NSLog(@"thumbnail frame x: %f", thumbnail.frame.origin.x); 
```

它将返回包含变换操作的位置，而不是`0,0`

`transform`使用而不是设置一个新`frame`的`UIView`作为重新定位的目的是否有真正的好处？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-30T10:01:27.217

主要好处是您可以使用更多类型的仿射变换，例如

*   `CGAffineTransformTranslate`
*   `CGAffineTransformScale`
*   `CGAffineTransformRotate`
*   `CGAffineTransformInvert`
*   `CGAffineTransformConcat`

但 frame struct 只设置框架。

**其他注意事项：**

1) In performance reasons assuming that `CGAffineTransformMakeTranslation(posX, posY)` changes only `center` property it is loos like it should work faster than changing the `frame` property but who knows. So for reposition purposes I would use this way or changing the `center` property.

2) In contrast of `CALayer`'s `transform` the `UIView`'s `transform` changes real position of the view.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-30T10:08:37.280

Using the translation transform will move (translate) the view in the transformed perspective. That is, uf you first rotate the view, and then translates it, it will move in the direction relative to the rotation. For a simple reordering, I would suggest changing the `center` property instead. This way, you can still use the `frame` property in a meaningful way.

# java - 创建自己的 Period 课程时遇到困难

> ID：10813676
> 
> 赞同：1
> 
> 时间：2012-05-30T09:38:30.733
> 
> 标签：java, calendar, period, milliseconds

我很难建立自己的时期课程，我知道那里已经有一些课程，但由于内部限制，我将不得不实施自己的课程。构造函数（下面的代码）基本上接受2个日期，一个开始和一个结束，方法makeWeeks（）将把这段时间分成几周，我根据我在学习列表时学到的“头尾”原则开发了这个.

继承人的代码（要领）

```
public class Period implements Serializable
{
  private static final long serialVersionUID = 1L;

  private Calendar          start;

  private Calendar          end;

  private long              durationMillis;

  private long              startMillis;

  private long              endMillis;

  private long              MAX              = 604800000; //A week in millis

  private long              DAY              = 86400000;

  private long              SIX              = 518400000;

  private ArrayList<Week>   weeks;

  public Period(Calendar start, Calendar end)
  {

    this.start = start;
    this.end = end;
    startMillis = start.getTimeInMillis();
    endMillis = end.getTimeInMillis();
    durationMillis = endMillis - startMillis;
    int startWeek = start.get(Calendar.WEEK_OF_YEAR);
    int endWeek = end.get(Calendar.WEEK_OF_YEAR);
    weeks = new ArrayList<Week>();

  }

  /**
   * Construct the weeks in this period
   * 
   * @return
   */
  public ArrayList<Week> makeWeeks()
  {
    long borderLine;

    if ((durationMillis < MAX) || (endMillis < startMillis))
    {
      return null;
    }
    Calendar endHead = Calendar.getInstance();
    //If first week is not Monday then count the days that have been completed
    if (start.get(Calendar.DAY_OF_WEEK) != Calendar.MONDAY)
    {
      int days = 0;
      start = adjustCalendar(start);//Set time to 0:0:0:0
      days = getDaysToMonday(start.get(Calendar.DAY_OF_WEEK));
      endHead.setTimeInMillis(start.getTimeInMillis());
      endHead.add(Calendar.DAY_OF_YEAR, days - 1);
      weeks.add(new Week(start, endHead, days, calcCompletion(days), setWeekNumber(start)));//was endHead
      borderLine = endHead.getTimeInMillis() + DAY;
    }//head week set

    else
    {
      start = adjustCalendar(start);
      endHead.setTimeInMillis(start.getTimeInMillis());//Successful
      borderLine = endHead.getTimeInMillis();
    }

    long endMillis = 0;

    while ((((borderLine + SIX)) < (end.getTimeInMillis() + 1)))
    {

      Calendar endNext = Calendar.getInstance();
      Calendar begin = Calendar.getInstance();
      begin.setTimeInMillis(borderLine);
      endNext.setTimeInMillis(borderLine + SIX);

      weeks.add(new Week(begin, endNext, 7, true, setWeekNumber(begin)));
      borderLine += MAX;
      endMillis = endNext.getTimeInMillis();
    }
    //adjust Tail

    Calendar tail = Calendar.getInstance();
    tail.setTimeInMillis(endMillis + DAY);//the beginning of the tail

    tail = adjustCalendar(tail);//set to 00:00:00

    int daysTail = getDaysToTail(end.get(Calendar.DAY_OF_WEEK) + 1);
    if (daysTail != 0)
    {
      weeks.add(new Week(tail, end, daysTail, calcCompletion(daysTail), setWeekNumber(end)));
    }
    return weeks;
  }//EOF makeweeks

  private int setWeekNumber(Calendar cal)
  {

    return cal.get(Calendar.WEEK_OF_YEAR);
  }

  /**
   * This method returns the amount of days between the given day and the next coming Monday
   */
  private int getDaysToMonday(int currentDay)
  {

    switch (currentDay)
    {

      case 1://sunday
        return 1;

      case 2://monday
        return 0;

      case 3://tuesday
        return 6;

      case 4://wednesday
        return 5;

      case 5://thursday
        return 4;

      case 6://friday
        return 3;

      case 7://saturday
        return 2;
    }
    return 0;

  }//EOF method

  /**
   * Returns the day to the end of the final week, always start counting from a Monday
   * 
   * @return
   */
  private int getDaysToTail(int tailDay)
  {

    switch (tailDay)
    {

      case 1://sunday
        return 0;

      case 2://monday
        return 1;

      case 3://tuesday
        return 2;

      case 4://wednesday
        return 3;

      case 5://thursday
        return 4;

      case 6://friday
        return 5;

      case 7://saturday
        return 6;
    }

    return 0;

  }

  /**
   * Returns the amount of weeks stored in this period, completed and non
   * 
   * @return
   */
  public int totalWeeks()
  {
    return weeks.size();
  }

  /**
   * Tells us if the selected period is at least one week
   * will return no result.
   * 
   * @return
   */
  public boolean isAtleastWeek()
  {
    long diff = end.getTimeInMillis() - start.getTimeInMillis();
    if (diff < MAX)
    {
      return false;
    }
    return true;
  }

  /**
   * Provided a week-number, gives back a Week marked by that week-number, if existing.
   * 
   * @param weekNumber
   * @return
   */
  public Week getWeek(Double weekNumber)
  {

    int weekNumberInt = weekNumber.intValue();
    for (Week week : weeks)
    {
      if (weekNumberInt == week.getWeekNumber())
      {
        return week;
      }
    }
    return null;
  }

  /**
   * This method will set the calendars time (H:M:S:M) to 0:0:0:0 so to be able to calculate a precise start and End,
   * dates will remain unaltered
   * 
   * @param cal
   * @return
   */
  private Calendar adjustCalendar(Calendar nu)
  {

    nu.set(Calendar.HOUR, 0);
    nu.set(Calendar.MINUTE, 0);
    nu.set(Calendar.SECOND, 0);
    nu.set(Calendar.MILLISECOND, 0);

    return nu;
  } 
```

恐怕有问题，这在大多数情况下都可以正常工作，但在某些情况下（如 2011 年 11 月和 2011 年 12 月）不会收集第二周，如果您设置为 endDate 31，则不会在 2012 年 3 月收集最后一周/Mar/2012 但如果您选择结束 30/Mar/2012。你有什么建议吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T08:06:21.150

解决了！

```
public class Period implements Serializable
{
  private static final long serialVersionUID = 1L;

  private Calendar          start;

  private Calendar          end;

  private Calendar          startClone;

  private Calendar          endClone;

  private long              durationMillis;

  private long              startMillis;

  private long              endMillis;

  private long              MAX              = 604800000; //A week in millis

  private long              DAY              = 86400000;

  private long              SIX              = 518400000;

  private ArrayList<Week>   weeks;

  /**
   * Constructor accepts 2 Calendars
   * 
   * @param start
   * @param end
   */
  public Period(Calendar start, Calendar end)
  {

    this.start = start;
    this.end = end;
    startClone = (Calendar)start.clone();
    endClone = (Calendar)end.clone();
    startMillis = start.getTimeInMillis();
    endMillis = end.getTimeInMillis();
    durationMillis = endMillis - startMillis;
    int startWeek = start.get(Calendar.WEEK_OF_YEAR);
    int endWeek = end.get(Calendar.WEEK_OF_YEAR);
    weeks = new ArrayList<Week>();

  }

  /**
   * Construct the weeks in this period
   * 
   * @return
   */
  public ArrayList<Week> makeWeeks()
  {
    Calendar borderLine;
    //The meaning of this is to report on weeks, so shorter periods wont be taken in consideration
    if ((durationMillis < MAX) || (endMillis < startMillis))
    {
      return null;
    }
    Calendar endHead = Calendar.getInstance();
    //If first week is not Monday then count the days that have been completed
    if (start.get(Calendar.DAY_OF_WEEK) != Calendar.MONDAY)
    {
      int days = 0;
      start = adjustCalendar(start);//Set time to 0:0:0:0
      days = getDaysToMonday(start.get(Calendar.DAY_OF_WEEK));
      endHead = (Calendar)start.clone();
      endHead.add(Calendar.DAY_OF_YEAR, days - 1);
      weeks.add(new Week(start, endHead, days, calcCompletion(days), setWeekNumber(start)));//was endHead
      //borderLine = endHead.getTimeInMillis() + DAY;
      Calendar vector = endHead;
      vector.add(Calendar.DAY_OF_YEAR, 1);
      borderLine = vector;
    }//head week set

    else
    {
      start = adjustCalendar(start);
      endHead = (Calendar)start.clone();//Successful
      borderLine = (Calendar)endHead.clone();
    }

    long endMillis = 0;

    while ((((borderLine.getTimeInMillis() + SIX)) < (end.getTimeInMillis() + 1)))
    {

      Calendar endNext = Calendar.getInstance();
      Calendar begin = Calendar.getInstance();
      begin = (Calendar)borderLine.clone();
      endNext = (Calendar)borderLine.clone();
      endNext.add(Calendar.DAY_OF_YEAR, 6);
      weeks.add(new Week(begin, endNext, 7, true, setWeekNumber(begin)));
      borderLine.add(Calendar.DAY_OF_YEAR, 7);
      endMillis = endNext.getTimeInMillis();
    }
    //adjust Tail

    Calendar tail = Calendar.getInstance();
    tail.setTimeInMillis(endMillis);

    tail.add(Calendar.DAY_OF_YEAR, 1);//the beginning of the tail

    if (!(tail.get(Calendar.DAY_OF_YEAR) >= end.get(Calendar.DAY_OF_YEAR)))
    {
      tail = adjustCalendar(tail);//set to 00:00:00

      int daysTail = getDaysToTail(end.get(Calendar.DAY_OF_WEEK));
      if (daysTail != 0)
      {
        weeks.add(new Week(tail, end, daysTail, calcCompletion(daysTail), setWeekNumber(end)));
      }
    }
    return weeks;
  }//EOF makeweeks

  /**
   * Get the weekNumber
   * 
   * @return
   */
  private double setWeekNumber(Calendar cal)
  {

    Integer week = cal.get(Calendar.WEEK_OF_YEAR);
    Double clone = week.doubleValue();
    return clone;
  }

  /**
   * This method returns the amount of days between the given day and the next coming Monday
   */
  private int getDaysToMonday(int currentDay)
  {

    switch (currentDay)
    {

      case 1://sunday
        return 1;

      case 2://monday
        return 0;

      case 3://tuesday
        return 6;

      case 4://wednesday
        return 5;

      case 5://thursday
        return 4;

      case 6://friday
        return 3;

      case 7://saturday
        return 2;
    }
    return 0;

  }//EOF method

  /**
   * Returns the day to the end of the final week, always start counting from a Monday
   * 
   * @return
   */
  private int getDaysToTail(int tailDay)
  {

    switch (tailDay)
    {

      case 1://sunday
        return 0;

      case 2://monday
        return 1;

      case 3://tuesday
        return 2;

      case 4://wednesday
        return 3;

      case 5://thursday
        return 4;

      case 6://friday
        return 5;

      case 7://saturday
        return 6;
    }

    return 0;

  }

  /**
   * Returns the amount of weeks stored in this period, completed and non
   * 
   * @return
   */
  public int totalWeeks()
  {
    return weeks.size();
  }

  /**
   * Tells us if the selected period is at least one week, since this is a weekly report, selecting less then a week
   * will return no result.
   * 
   * @return
   */
  public boolean isAtleastWeek()
  {
    long diff = endClone.getTimeInMillis() - startClone.getTimeInMillis();
    if (diff < MAX)
    {
      return false;
    }
    return true;
  }

  /**
   * Provide the dates(start and end of a week) in the form of a String
   * 
   * @param weekNumber
   * @return
   */
  public String getDates(Double weekNumber)
  {

    int weekNumberInt = weekNumber.intValue();

    String vector = new String();

    for (Week week : weeks)
    {
      if (week.getWeekNumber() == weekNumberInt)
      {
        vector += week.getStart().get(Calendar.DAY_OF_MONTH) + "/";
        vector += (week.getStart().get(Calendar.MONTH) + 1) + "/";
        vector += week.getStart().get(Calendar.YEAR) + "-";
        vector += (week.getEnd().get(Calendar.DAY_OF_MONTH)) + "/";
        vector += (week.getEnd().get(Calendar.MONTH) + 1) + "/";
        vector += week.getEnd().get(Calendar.YEAR);
      }
    }
    return vector;
  }

  /**
   * Provided a week-number, gives back a Week marked by that week-number, if existing.
   * 
   * @param weekNumber
   * @return
   */
  public Week getWeek(Double weekNumber)
  {

    int weekNumberInt = weekNumber.intValue();
    for (Week week : weeks)
    {
      if (weekNumberInt == week.getWeekNumber())
      {
        return week;
      }
    }
    return null;
  }

  /**
   * This method will set the calendars time (H:M:S:M) to 0:0:0:0 so to be able to calculate a precise start and End,
   * dates will remain unaltered
   * 
   * @param cal
   * @return
   */
  private Calendar adjustCalendar(Calendar nu)
  {

    nu.set(Calendar.HOUR, 0);
    nu.set(Calendar.MINUTE, 0);
    nu.set(Calendar.SECOND, 0);
    nu.set(Calendar.MILLISECOND, 0);

    return nu;
  }

  /**
   * BBC defines a week "complete" only if 4 or more days of that week have passed.
   * 
   * @param days
   * @return
   */
  private boolean calcCompletion(int days)
  {
    if (days < 4)
    {
      return false;
    }
    return true;
  }

  /**
   * @return
   */
  public boolean hasWeekNumber(Double weekNumber)
  {

    for (Week week : weeks)
    {
      if (weekNumber.intValue() == week.getWeekNumber())
      {
        return true;
      }
    }
    return false;
  }

  /**
   * Returns the highest week number
   * 
   * @return
   */
  public double getHighestWeekNumber()
  {
    return weeks.get(weeks.size() - 1).getWeekNumber();
  }

  /**
   * Test method to print fields of a calendar
   */
  private String showCalValues(Calendar cal)
  {

    return "Day of year " + cal.get(Calendar.DAY_OF_YEAR) + " Day of month: " + cal.get(Calendar.DAY_OF_MONTH)
        + " Day of week: " + cal.get(Calendar.DAY_OF_WEEK) + " month " + cal.get(Calendar.MONTH) + " date: "
        + cal.get(Calendar.HOUR_OF_DAY) + ":" + cal.get(Calendar.MINUTE) + ":" + cal.get(Calendar.MILLISECOND)
        + " week number: " + cal.get(Calendar.WEEK_OF_YEAR) + " millis: " + cal.getTimeInMillis();
  }

  /**
   * Test method that prints the weeks
   */
  private void showWeeks()
  {
    for (Week w : weeks)
    {
      System.out.println(w.getWeekNumber() + " start millis: " + w.getStart().getTimeInMillis());
    }
  }
} 
```

# java - 使用 Lotus notes 发送加密电子邮件

> ID：10813681
> 
> 赞同：0
> 
> 时间：2012-05-30T09:39:01.367
> 
> 标签：java, lotus-notes

有没有办法使用 JAVA API 使用 Lotus notes 发送加密电子邮件？

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-30T10:16:00.210

是的。在to上设置[EncryptOnSend](http://publib.boulder.ibm.com/infocenter/domhelp/v8r0/index.jsp?topic=%2Fcom.ibm.designer.domino.main.doc%2FH_ENCRYPTONSEND_PROPERTY_JAVA.html)，然后使用该方法发送它。`Document``true``send`

> 要在邮寄时加密文档，此方法会在 Domino 目录中查找每个收件人的公钥。如果它找不到收件人的公钥，该方法会向该收件人发送一份未加密的文档副本。所有其他收件人都会收到该文档的加密副本。

# javascript - 使用导航按钮制作基本 Javascript 幻灯片时出错

> ID：10813682
> 
> 赞同：0
> 
> 时间：2012-05-30T09:39:11.927
> 
> 标签：javascript, html

我正在尝试制作具有前进和后退按钮的 javascript 幻灯片。我只需要 8 张图片，我可以单击一个按钮转到下一张图片或上一张图片。但是，我的代码不起作用，我不知道为什么。我认为这是一个简单的解决方法，但为时已晚，我觉得我已经尝试了所有方法。当我说它不起作用时，我指的是浏览器要么返回一个错误，说“无法解析背景图像”（仅当我删除 if/then 语句并且只运行 else 部分时才会发生，而不是`else`前面当然）或者它只是崩溃，可能是由于当我尝试使用 if/then 语句运行它时出现无限循环。这是一个 jsfiddle 链接：http: [//jsfiddle.net/AZchy/](http://jsfiddle.net/AZchy/)。谢谢你的帮助！

这是我的javascript：

```
var images = new Array(8);
images[0] = "url('screen1.jpg')";
images[1] = "url('screen2.jpg')";
images[2] = "url('screen3.jpg')";
images[3] = "url('screen4.jpg')";
images[4] = "url('screen5.jpg')";
images[5] = "url('screen6.jpg')";
images[6] = "url('screen7.jpg')";
images[7] = "url('screen8.jpg')";
var i = 0;

function slideShowForward(){
        if(i=7){
            i = 0;
            document.getElementById("images").style.backgroundImage = images[i];
        }
        else{
            i++;
            document.getElementById("images").style.backgroundImage = images[i];
        }
}
function slideShowBack(){
        if(i=0){
            i=7;
            document.getElementById("images").style.backgroundImage = images[i];
        }
        else{
            i--;
            document.getElementById("images").style.backgroundImage = images[i];
        }
} 
```

这是我的 HTML

```
<body>
<div id="container">
<div id="images">
</div>
<div id="form">
<form name="buttons" action="">
    <input type="button" name="previous" value="Previous" onclick="slideShowBack()"/>
    <input type="button" name="next" value="Next" onclick="slideShowForward()"/>
</form>
</div>
</div>
</body> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-30T09:47:53.620

更改`if (i = 0)`为`if (i == 0)`。`if (i = 7)`应该是一样的`if ( i == 7)`。

# windows - 在 FAT 上快速创建大文件

> ID：10813683
> 
> 赞同：0
> 
> 时间：2012-05-30T09:39:16.933
> 
> 标签：windows, winapi, file-io, filesystems, fat32

在 Windows 的 FAT MicroSD 上创建大文件的最快方法是什么？到目前为止，所有解决方案都显示了导致文件稀疏的方法，但我需要预先分配所有扇区（因为它将被数据记录器使用）。目前我只写了几千兆字节的零，但这需要很长时间。

编辑：似乎要遵守 FAT 规范，Windows 将不得不分配所有数据块并将它们初始化为零，因为 FAT 会执行“集群链接”。所以我想我要求的是不可能的，但是我会留下这个问题以防万一。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-30T14:33:47.540

Alex 说得对，就执行时间而言，这是最快的方式，但写入 FAT 并非易事。我的理解是，您将不得不处理扇区大小和碎片化问题。这是LGTM的[开源 FAT32 实现。](http://elm-chan.org/fsw/ff/00index_e.html)

就您需要编写的代码量而言，最快的方法是[这篇 Raymond Chen 博客文章中的选项 1](http://blogs.msdn.com/b/oldnewthing/archive/2011/09/22/10215053.aspx)。

简而言之 ：

1.  创建文件
2.  寻求结束
3.  写一个字节

奖励：它也适用于 NTFS（我正在使用它的一个应用程序）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-30T15:52:45.493

应该可以创建文件（使用[CreateFile](http://msdn.microsoft.com/en-us/library/windows/desktop/aa363858.aspx)）并在之后使用[SetEndOfFile](http://msdn.microsoft.com/en-us/library/windows/desktop/aa365531.aspx)设置文件的大小。不确定 Windows 是否对扇区进行了零初始化。如果我没记错的话，它在 Windows XP 下的 FAT32 分区上没有。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-30T11:35:56.457

最快的方法是直接访问带有 FAT 控制数据的扇区并分配足够长的簇链，并为文件创建一个目录条目并使其指向链的第一个簇。这避免了写入千兆字节的零。如果您从空的预格式化媒体开始并且不需要保留任何先前写入的数据，这应该是一项微不足道的任务。您可以对控制数据区域的内容进行硬编码，避免 FAT 解析。

我不记得您如何在 Windows 中获得如此低级/原始的访问权限。我认为您只需要打开设备卷（或物理设备），然后它就可以作为原始数据访问。请参阅MSDN 上的[CreateFile()描述中的详细信息。](http://msdn.microsoft.com/en-us/library/windows/desktop/aa363858%28v=vs.85%29.aspx)在 Vista+ 上，您的应用可能需要对此具有特殊访问权限。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-12-02T09:33:04.133

[也许尝试fsutil](https://technet.microsoft.com/en-us/library/cc788058.aspx)会很有用：

> fsutil 文件 [createnew] (文件名) (长度)

# c# - 背景中的帆布儿童

> ID：10813686
> 
> 赞同：0
> 
> 时间：2012-05-30T09:39:27.483
> 
> 标签：c#, wpf, back

我想让一个`Canvas`孩子成为背景。

例如：我有一个`Ellipse`（画布的孩子）。当我在相同坐标上添加一个矩形时，我想把它放在椭圆下。

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-30T09:43:53.020

您可以使用[Canvas (Panel) 的 ZIndex Attached 属性](http://msdn.microsoft.com/en-us/library/system.windows.controls.panel.zindex)：

```
<Canvas>
    <Ellipse Canvas.ZIndex = "10" />
    <Rectangle Canvas.ZIndex = "5"/>
</Canvas> 
```

或者您可以重新排序子元素：

```
<Canvas>
    <Rectangle/>
    <Ellipse />
</Canvas> 
```

在代码中：

```
Canvas.SetZIndex(newRectangle, 5);
Canvas.SetZIndex(oldEllipse, 10); 
```

# ios - ZUUIRevealController 在窗口上方显示空白

> ID：10813689
> 
> 赞同：3
> 
> 时间：2012-05-30T09:39:39.233
> 
> 标签：ios

所以我实现了 ZUUIRevealController 来创建一个单独的菜单，这一切都很好，但是 backViewController 似乎有一些问题，看看这个图像： ![在此处输入图像描述](../Images/8b7d603337ac2ec21f7c888a6cd05826.png)

如您所见，显示了一个空白区域，正是状态栏的高度，我不知道为什么。

实现这个时没有什么特别的事情发生：

```
SortViewController *sortViewController = [[SortViewController alloc] init]; 

ZUUIRevealController *revealController = [[ZUUIRevealController alloc] initWithFrontViewController:self.tabBarController rearViewController:sortViewController];
self.window.rootViewController = revealController; 
```

SortViewController 是一个 UITableViewController。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-04T06:39:17.853

刚刚遇到同样的问题并找到了解决方法。转到`UITableViewController`您用作后视图的属性检查器中，在 View Controller 下，有一个 Layout want full screen 复选框。这消除`tableview`了`rearViewController`.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-08T07:01:30.543

检查一下：在您的 AppDelegate.m 文件中使用此代码 -

```
- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:    (NSDictionary *)launchOptions
{
    UIWindow *window = [[UIWindow alloc] initWithFrame:[[UIScreen mainScreen] bounds]];
    self.window = window;

    FrontViewController *frontViewController = [[FrontViewController alloc] init];
    RearViewController *rearViewController = [[RearViewController alloc] init];

    UINavigationController *navigationController = [[UINavigationController alloc] initWithRootViewController:frontViewController];

    RevealController *revealController = [[RevealController alloc] initWithFrontViewController:navigationController rearViewController:rearViewController];
    self.viewController = revealController;

    self.window.rootViewController = self.viewController;
    [self.window makeKeyAndVisible];
    return YES;
} 
```

希望 dis 解决您的问题，并获得 50+ BOUNTY 奖励 :)

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2012-06-13T05:04:15.387

我刚刚发现，如果我使用普通视图，它可以工作，在我只使用 UITableView 之前，这似乎会出现问题。

# javascript - 在骨干应用程序中进行 SEO，以便谷歌可以在 phantomjs 之后索引主页

> ID：10813690
> 
> 赞同：3
> 
> 时间：2012-05-30T09:39:43.830
> 
> 标签：javascript, backbone.js, seo, phantomjs

我有骨干网站。我使用了 phantomjs，以便搜索引擎可以按照 _escaped_fragment_spec 通过 js 链接 (#!/something) 进行查找。我已经使用 google webtools 进行了检查，以查看 google 将如何看待我的网站，并且大多数情况下一切似乎都是正确的。

但是，主页（例如：www.example.com；链接中没有#!的那个），google没有发送_escaped_fragment_spec，所以页面没有发送到phantomjs，也没有应用js，因此google是看着几乎是空的页面。

有谁知道如何指出这一点，或解决问题？

谢谢

编辑：根据谷歌（https://developers.google.com/webmasters/ajax-crawling/docs/getting-started），你应该添加到头部，但是我已经添加了它，并且 webtools - 见谷歌，没有接缝将主页作为javascript处理。有什么帮助吗？有问题的网站是[http://www.boletus-app.com/](http://www.boletus-app.com/) 谢谢

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-12T05:31:54.177

这个问题的答案是使用片段元标记

```
<meta name="fragment" content="!"> 
```

这将强制使用转义片段请求包括主页在内的所有页面

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-12T02:19:34.377

查询参数名为“_escaped_fragment”，而不是“_escaped_fragment_spec”。

Google 不会在您的客户端应用程序中执行 JavaScript。Google 的 AJAX 应用程序支持旨在支持您站点中的 AJAX/hashbang URL 从其他站点链接到的情况。例如，如果有人链接到`http://example.com/app#!my-route`，当 Google 的爬虫遇到该链接时，它会`http://example.com/app?_escaped_fragment=my-route`在向您的服务器请求之前将其翻译为。您的服务器代码必须处理此查询参数并生成适当的 HTML 来表示该 URL 以供 Google 索引。

# jquery - 使用 json-jquery 进行分页

> ID：10813697
> 
> 赞同：0
> 
> 时间：2012-05-30T09:40:26.307
> 
> 标签：jquery, json

我试图搜索并获取此链接[Making jQuery Pagination](http://web.enavu.com/tutorials/making-a-jquery-pagination-system/)，但在本教程中是针对静态内容的。但对我来说，我使用 JSON 来检索我的控制器查询的数据。然后我取 JSON 的结果，在表中列出，div 和 span。在我的表格中有很多行，所以我想将其作为分页。

谁能告诉我一些关于这个问题的线索？提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-30T09:45:50.627

1.  第一次加载，从您的服务器发送指定数量的记录，在客户端显示。
2.  单击下一步时，发送您所在的页码和所需的记录数，服务器应发送带有下一页数据的 json。
3.  对以前做同样的事情。

所有这些请求都将是 ajax 调用。

对于显示，您可以选择多个选项：

1.  给定记录，例如 10、20，为每个发言设置一个 div，然后在 prev next 中，您还可以移动它们，并将它们的 id 作为页码，以便您可以轻松识别您所在的页面。

2.  在表中添加新行，恕我直言，这将需要更多努力。

不要每次都访问数据库，前一个数据库资源是有限的，而是获取额外的行（取决于用例）并将其保存在内存中。

# .net - VB.NET FTP 错误 550

> ID：10813700
> 
> 赞同：1
> 
> 时间：2012-05-30T09:40:43.143
> 
> 标签：.net, vb.net, ftp, filestream, ftpwebrequest

我尝试将`'.ics'`文件上传到活动的 FTP 服务器

命名空间：

```
Imports System
Imports System.IO
Imports System.Data.OleDb
Imports System.Collections
Imports Microsoft.VisualBasic
Imports System.Net
Imports System.Text 
```

代码：

```
'Create a FTP Request Object and Specfiy a Complete Path
                Dim reqObj As FtpWebRequest = WebRequest.Create(Ziel + "Calendar/" + MitarbeiterNr + ".ics")
                reqObj.Method = WebRequestMethods.Ftp.UploadFile
                reqObj.UsePassive = False
                reqObj.Credentials = New NetworkCredential(User, Password)
                reqObj.Proxy = Nothing
                reqObj.KeepAlive = False
                reqObj.UseBinary = False
                reqObj.Timeout = 5000

                Dim sourceStream As FileStream = File.OpenRead(AppPath + "Ablage\" + MitarbeiterNr + "\" + MitarbeiterNr + ".ics") ' store file in buffer
                Dim buffer(Convert.ToInt32(sourceStream.Length)) As Byte
                sourceStream.Read(buffer, 0, buffer.Length)
                sourceStream.Close()
                reqObj.ContentLength = buffer.Length
                'Dim objUTF8 As New UTF8Encoding()
                'lblMsg.Text &= objUTF8.GetString(buffer)

                'Upload File and set its object to nothing
                Dim requestStream As System.IO.Stream
                Try
                    requestStream = reqObj.GetRequestStream() 'times out here
                    requestStream.Write(buffer, 0, buffer.Length)
                    requestStream.Close()
                Catch ex As Exception
                    Debug.printMeldung(ex.Message & ex.Source & ex.StackTrace)
                End Try

                reqObj = Nothing 
```

使用的用户具有写入等所需的权限。URI 看起来像

```
ftp://Serveradress/Calendar/filename.ics 
```

这是我得到的错误消息`requestStrem = reqObj.GetRequestStream()`：

> Der Remoteserver hat einen Fehler zurückgegeben (550) Datei nicht verfügbar (zB nicht gefunden oder kein Zugriff).System 来自 System.Net.FtpWebRequest.SyncRequestCallback(Object obj) 来自 System.Net.FtpWebRequest.RequestCallback(Object obj) 来自 System.Net .CommandStream.InvokeRequestCallback(Object obj) bei System.Net.CommandStream.Abort(Exception e) bei System.Net.FtpWebRequest.FinishRequestStage(RequestStage 阶段) bei System.Net.FtpWebRequest.GetRequestStream() bei Calendar.Calendar.Upload(String MitarbeiterNr) 在 DVisualStudio 2008CalendarCalendarCalendar.vbZeile 240 中。

抱歉，它是德文的，但我想你们中的大多数人都能读到；-)

我从这里抢了代码

> [http://forums.asp.net/post/2590178.aspx](http://forums.asp.net/post/2590178.aspx)

如果有人帮助我尽快解决问题会很高兴=）

光僧

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-22T14:56:37.073

始终检查在主机名之后和路径之前放置双斜杠的 FTP 连接字符串，例如 ftp.mickeymouse//htdocs/filename。

当我只有一个斜线 maqrk 时，我收到了一条完全没有帮助的错误 550 消息。

解决了我的问题，尽管在这里可能不相关。

# c# - 使用 C# 在图形上绘制点

> ID：10813701
> 
> 赞同：3
> 
> 时间：2012-05-30T09:40:45.687
> 
> 标签：c#, graph

我有 (x,y) 形式的点，我需要在图形（折线图）上绘制这些点。图形需要是连续的而不是离散的。我需要在 C# 中使用一些用于图形的 API 而不是通过图形库。请建议如何做，如果可能的话，请分享代码。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-30T11:07:37.157

如果您可以使用`Chart`Windows 窗体中的标准控件，则此代码：

```
chart1.ChartAreas[0].Axes[0].Title = "N";
chart1.ChartAreas[0].Axes[1].Title = "FIB(N)";
chart1.Series[0].ChartType = SeriesChartType.Line;
chart1.Series[0].MarkerStyle = MarkerStyle.Circle;
chart1.Series[0].LegendText = "Fibonacci numbers";
Tuple<int,int> t = Tuple.Create(0,1);

for(int i = 1; i <= 30; i++){
  chart1.Series[0].Points.Add(new DataPoint(i, t.Item1));
  t = Tuple.Create(t.Item2, t.Item1 + t.Item2);
} 
```

这将绘制斐波那契数列连续 XY 图。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-30T09:45:42.590

如果您可以使用 WPF，请查看[Dynamic Data Display](http://dynamicdatadisplay.codeplex.com/)。他们甚至有一个连续图的演示，它会随着它的进行重新缩放。

# perl - Perl：删除行中的空格

> ID：10813703
> 
> 赞同：0
> 
> 时间：2012-05-30T09:40:55.917
> 
> 标签：perl

我有以下文件：

```
firstname=John
name=Smith
address=Som
 ewhere 
```

如您所见，地址位于 2 行（第二行以空格开头）。

我必须将“好”输出（带有“address=Somewhere”）写入另一个文件。

这是我写的第一个脚本（有点复杂）：

```
foreach $line (@fileIN) {
    if ($lastline eq "") {
        $lastline = $line;
    } else {
        if ($line =~/^\s/) {
            print $line;
            $line =~s/^\s//;
            $lastline =~s/\n//;
            $lastline = $lastline.$line;
        } else {
            print fileOUT $lastline;
            $lastline = $line;
        }
    }
} 
```

$line =~/^\s/ => 这个正则表达式匹配 $line 中的空格，但不仅在开头。

我也尝试写一个简单的，但它也不起作用：

```
perl -pe 's/$\n^\s//' myfile 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-30T09:56:38.173

比如像这样？

```
while (<DATA>) {
    chomp;
    print "\n" if /=/ and $. - 1; # do not insert empty line before the 1st line
    s/^\s+//;                     # remove leading whitespace
    print;
}
print "\n";                       # newline after the last line

__DATA__
firstname=John
name=Smith
address=Som
 ewhere 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-30T09:56:39.417

你似乎做了太多的工作。我会这样做：

```
my $full_line;
foreach my $line (@fileIN) {
    if ($line =~ /^\s+(.+)\Z/s){                   # if it is continuation
            my $continue = $1;                     # capture and
            $full_line =~ s/[\r\n]*\Z/$continue/s; # insert it instead last linebreak
    } else {                                       # if not
            if(defined $full_line){ print $full_line } # print last assembled line if any
            $full_line = $line;                    # and start assembling new
    }
}
if(defined $full_line){ print $full_line }         # when done, print last assembled line if any 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-30T09:55:55.927

仅检查我的解决方案 1 个正则表达式 :)

```
my $heredoc = <<END;
firstname=John
name=Smith
address=Som
 ewhere
END

$heredoc =~ s/(?:\n\s(\w+))/$1/sg;
print "$heredoc";` 
```

# c++ - std::multiset 与 std::map 用于保持多个可重复的整数值

> ID：10813704
> 
> 赞同：10
> 
> 时间：2012-05-30T09:40:57.977
> 
> 标签：c++, stl, containers

我想创建一个记录来保存有关信息

*   a）存在什么样的元素以及
*   b) 存在的每种元素的数量

在树的一个节点中。我将只为叶节点显式存储此信息，而父节点的信息可以通过组合所有子节点的信息来获得（例如，孩子 1 有 3 个 A 对象，1 个 B 对象，孩子 2 有 1 A 的对象，C 的 2 个对象——父级有 A 的 4 个对象，B 的 1 个对象和 C 的 2 个对象）。

当从父节点请求这些信息时我会小心，不要先请求、使用和丢弃子节点的信息，然后再请求它的父节点，但*向上构造*将是一个常见的操作。其他两个常见的操作直接来自我存储的内容：*种类 X 的对象是否存在？*有*多少 X 类物体存在？*还有**多少种物体存在？**

对象种类表示为整数，并且对象编号始终是整数值。什么是更好的选择（以及所选选择的论据）：

*   使用`std::multiset<int>`, 和`std::multiset::count()`操作`std::multiset::find()`（更容易联合但元素重复，总的不同元素计数难以获得）
*   使用`std::map<int, std::size_t>`种类作为键，对象数量作为值（没有重复的元素，`std::map::find()`存在函数，大小给出了存储的对象种类的正确数量，但是访问不存在的元素会无意中增加大小）

谢谢你的建议！

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-06-01T12:57:52.103

要为每个比较谓词存储总共*n*个具有*k*`std::multiset`个不同值的项目，分配*n 个*二叉搜索树节点 (*)。An`std::map`仅分配*k*个（稍大）节点。

当您的比较谓词可以认为两个项目相等但仍必须显式存储时，您将使用`std::multiset`它们，因为它们在比较谓词不检查的某些方面有所不同。此外，迭代a 会生成*n 个*`multiset`项目中的每一个，而 a将生成*k*个不同项目中的每一个，其中每个项目都有计数。*`map`*

 **如果项目只是整数，请使用`std::map`. 然后，您的“有多少不同的项目”查询将只是对 的调用`size`，它在恒定时间内运行。

您声称“访问不存在的元素会无意中增加大小”仅在您用于`operator[]`访问节点时才成立。[`find`](http://en.cppreference.com/w/cpp/container/map/find)不表现出这种行为。

(*) C++ 标准不保证这些容器被实现为（平衡的）BST，但在我见过的所有实现中，它们都是。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-01T13:37:40.913

排序的`std::vector<int>`呢？您需要的操作可以满足如下：

*   *X种类的物体存在吗？* `std::binary_search`
*   *有多少种类 X 的物体？* ,`std::equal_range`减去`.first``.second`
*   *存在多少种物体？*
    *   `std::unique_copy`然后`size()`是副本，或者...
    *   使用单独的计数器，`std::binary_search`在插入向量之前调用

与树状结构相比，这种方法的优点是缓存局部性（所有数据都是连续的）和更少的内存占用。在不了解您的数据的情况下，我无法确定它会更快还是更慢。您必须对其进行分析才能找到答案，但我有一种预感，它的性能会比您预期的要好。

这里最大的权衡是表现力。该`std::map`方法可能在逻辑上传达您正在做的事情方面做得更好，即对象ID 和计数之间的关系。**

# java - JSP 获取属性定义

> ID：10813705
> 
> 赞同：1
> 
> 时间：2012-05-30T09:41:14.720
> 
> 标签：java, spring, jsp

我有 Spring 控制器，在其中我将一些属性映射到模型，然后通过 jsp 页面显示模型信息......问题是所有属性（即`${attributeName}`- 这是我在渲染页面中得到的）都按定义显示，没有值。到目前为止，这工作得很好。我怀疑其中一个库丢失了，但不知道是哪个库...

提前致谢。

控制器示例

```
@RequestMapping(value="/entity", method=RequestMethod.GET)
public String getEntity(@RequestParam (value="q", required=true) String q, Model model){
   model.addAttribute("q", q);

   return "viewName"; //this is jsp file name
} 
```

视图名称.jsp

```
${q} 
```

当我调用 localhost:8080/controller/entity?q=string 时，输出应该是“string”，但输出是 ${q}

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-30T10:28:48.253

在您的控制器功能中使用 Model 模型`ModelMap map`，然后在该映射中添加您的属性。

还要检查你的jsp页面目录的顶部。该标签中是否有任何属性，例如`isELIgnored='true'`，然后将其删除，然后尝试使用它。

我认为它应该可以解决您的问题。

干杯。

# c# - 使用 SSH.NET 库通过 SSH 连接到 MySQL

> ID：10813707
> 
> 赞同：5
> 
> 时间：2012-05-30T09:41:31.777
> 
> 标签：c#, mysql, database, ssh, connection-string

我得到了一个链接，可以使用这个库通过 SSH 连接到使用 C# 的 MySQL 数据库进行连接。

这是该库的[链接](http://sshnet.codeplex.com/)，因为您不需要手动打开 SSH 通道，很多人会发现这很有趣。

这是一个非常详细的库，有很多功能，但我想做的很简单。每次我想写入数据库时​​，我只想打开一个 SSH 通道。

在搜索提供的源代码时，我想到了可以在**TestSshCommand.cs**中找到的这部分代码，我想我可以将这部分用于我的连接，但我需要你的帮助才能让它像我一样工作我的连接字符串我不知道如何连接所有这些。

代码：

```
public void Test_Execute_SingleCommand()
        {
            using (var client = new SshClient(Resources.HOST, Resources.USERNAME, Resources.PASSWORD))
            {
                client.Connect();
                var result = ExecuteTestCommand(client);
                client.Disconnect();

                Assert.IsTrue(result);
            } 
```

我连接到非 SSH 通道的代码是：

```
con.ConnectionString = ConfigurationManager.ConnectionStrings["Con2"].ConnectionString;
            con.Open();
            cmd = new MySqlCommand("SELECT COUNT(*) FROM " + ConfigSettings.ReadSetting("main"), con);

     //...... more of the code 
```

那么如何将这段代码与上面的代码结合起来，以便它可以首先打开一个 SSH 通道，然后执行我的查询呢？

我需要将我的代码放在*连接*和*断开*功能中吗？

另一个人认为我在引用中添加了**.dll**文件，我必须说所有导入都不起作用。所以有人可以下载这个库并尝试这个简单的代码，看看你的项目是否有参考，这样每个人（很多人）都可以为他们未来的项目找到一个可行的解决方案吗？

编辑：

这是我稍后尝试做的代码。我的 SSH 连接现在只需将这两者结合起来即可工作。

问题是我需要在我的电脑上本地拥有一个数据库并且需要连接到服务器。所以端口转发不会像论坛上所说的那样，当mysql已经有端口可以运行时我不能转发端口

```
using (var client = new SshClient("cpanel****", "******", "******"))
          {
            client.Connect();
            con = new MySqlConnection(GetConnectionString());
            con.Open();
            cmd = new MySqlCommand(String.Format("insert into {0} values (null, ?Parname , ?Parname2, ?Parname3, ?Parname4, ?Parname5, ?Parname6, ?Parname7);", ConfigSettings.ReadSetting("main")), con);
            cmd.Parameters.Add("?Parname", MySqlDbType.Double).Value = Math.Round(deciLat, 5);
            // ... more parameters
            cmd.ExecuteNonQuery();
            client.Disconnect();
           } 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2015-01-01T23:02:40.927

您只需为隧道使用与 MySQL 实例正在使用的 3306 不同的本地端口。

下面的示例使用端口 8001 代替：

```
using (var client = new SshClient("ssh_hostname", "ssh_username", "ssh_password"))
{
  client.Connect();
  var tunnel = new ForwardedPortLocal("127.0.0.1", 8001, "127.0.0.1", 3306);
  client.AddForwardedPort(tunnel);
  tunnel.Start();
  using (var DB = new DBContext())
  {
    //MySQL interaction here!
    scores = DB.Table
      .Where(x => !String.IsNullOrEmpty(x.SomeField))
      .ToList();
  }
  tunnel.Stop();
} 
```

然后确保在您的连接字符串中有服务器 127.0.0.1 和端口 8001

```
server=127.0.0.1;port=8001 
```

这会将任何去往 127.0.0.1:8001 的东西连接到 ssh_hostname:3306。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-06-01T10:39:13.207

您需要使用 SSH 连接设置端口转发...

基本上建立一个 SSH 连接，侦听 localhost 上的端口 3306 并将其转发到您的 MySQL 数据库服务器...

在 MySQL DB 的连接字符串中，您需要将部分更改为`server=...`，`server=localhost`而 SSH 连接需要转到 MySQL DB 服务器的 IP。

如果您无法转发端口 3306，您可以使用任何您想要的端口，但您需要另外更改连接字符串的一部分...有关具有不同端口的连接字符串的示例，`port=`请参见[此处](http://www.connectionstrings.com/mysql)... SSH 连接仍以 3306 为目标但在这种情况下，在 localhost 上侦听不同的端口...

以下是一些带有源代码的工作示例（虽然不是 SSH.NET，因为我不使用 SSH.NET，但这应该让你开始 IMO）：

*   [http://georgelantz.com/2007/09/10/access-mysql-through-ssh-tunnel-in-a-windows-net-application/](http://georgelantz.com/2007/09/10/access-mysql-through-ssh-tunnel-in-a-windows-net-application/)
*   [http://www.howtogeek.com/howto/ubuntu/access-your-mysql-server-remotely-over-ssh/](http://www.howtogeek.com/howto/ubuntu/access-your-mysql-server-remotely-over-ssh/)（这只是关于如何从命令行使用本地 SSH 客户端进行设置的一个选项）

# annotations - 如何在行尾放置注释？

> ID：10813708
> 
> 赞同：0
> 
> 时间：2012-05-30T09:41:36.923
> 
> 标签：annotations, plot, matplotlib

我的目标是生成如下图：

![图片示例](../Images/a4cec1999de0c27ab4f37861b8a69465.png)

我需要的是获得一组注释，然后将这些注释正确对齐到绘图上。我怎样才能做到这一点？文本应该一直到 y 轴之前。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-30T10:51:07.573

一种方法是使用 fig.text()。您可以执行以下操作：

```
fig = plt.figure()
fig.text(0.8,0.5,'Your text here',size='small',ha='right') 
```

数字是图形上文本的 x,y 坐标，范围从 0 到 1。“ha”代表水平对齐。

另一种方法是创建一个辅助 y 轴，然后使用 ylabels() 在该轴上设置自定义刻度标签。

# bash - 在后台 BASH #3 上使用 Matlab 命令运行循环

> ID：10813711
> 
> 赞同：0
> 
> 时间：2012-05-30T09:41:55.470
> 
> 标签：bash, matlab, background

在以下网站的帮助下，我设法在后台运行了 Matlab：

[http://www.stat.osu.edu/computer-support/programming/background-jobs](http://www.stat.osu.edu/computer-support/programming/background-jobs)

我正在执行循环：

```
for ((i = 1; i <= 5; i++)); do
    echo $i>i.txt;
    matlab -nodesktop -nodisplay <script.m &> dummy.out &
done 
```

在脚本中有一部分：

```
fid=fopen( 'a:\folder\i.txt');'];
iter=str2double(fgets(fid))
myfunction(iter,a,b,c) 
```

myfunction.m 的函数行是

```
myfunction(num,a,b,c) 
```

此函数保存一个名称也根据“num”的值而变化的文件

意思是，输出将是：第一个命令的 myfile1.mat，第二个命令的 myfile2 等。

当我在没有循环的情况下运行命令时

```
echo 1>i.txt;
matlab -nodesktop -nodisplay <script.m &> dummy.out &
echo 2>i.txt;
matlab -nodesktop -nodisplay <script.m &> dummy.out &

etc... 
```

没有问题，输出很好

当我运行循环时，我得到的唯一文件是 myfile5.mat

我更改了代码，以便输入将是 myfunction(i1,a,b,c), myfunction(i2,a,b,c)... 但结果保持不变。

我认为这是因为保存部分位于函数的末尾（运行了很长时间），所有函数的“num”都是 5（循环完成的速度比计算快得多）。

有任何想法吗？tnx

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-30T16:52:15.417

问题是`&`MATLAB 调用后的 & 符号 - 发生的事情是循环开始运行，将值 1 放入 i.txt，然后**分叉出**一个 MATLAB 进程，然后循环再次运行，将值 2 放入i.txt，然后分叉出**另一个**MATLAB 进程，依此类推。现在 MATLAB 需要一段时间才能启动，并且这个循环非常快，因为它不会等待 MATLAB 调用完成，所以当第一个 MATLAB 实例最终完成时，循环已经完成很长时间并且 i.txt 中的值为5 用于所有呼叫。

简短版：删除`&`标志:)

这将使 MATLAB 在继续循环之前运行并完成。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-30T10:41:24.343

问题是您使用相同的文件运行作业，因为它在后台模式下运行，首先文件包含“1”，然后是“2”、“3”、“4”、“5”，然后才是第一个脚本开始评估（并且已经在文件中看到“5”，而不是“1”）。

您现在正试图通过文件将参数传递给函数，对吗？我只是想知道，为什么不将参数传递给函数本身？此处描述的在 Matlab 中并行运行多个函数（在后台模式下），例如： http: [//www.mathworks.ch/matlabcentral/newsreader/view_thread/166876](http://www.mathworks.ch/matlabcentral/newsreader/view_thread/166876)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-01T02:42:25.607

我找到了解决问题的方法，

这很简单，我所要做的就是将变量导出到环境中，然后它们在 MATLAB 脚本中读取它们

```
for ((i = 1; i <= 5; i++)); do
     export i
     matlab -nodesktop -nodisplay <script.m &> dummy.out &
done 
```

在 script.m 中

```
iter=str2double(getenv('i'))
myfunction(iter,a,b,c) 
```

效果很好！

# c++ - 使用 C++ 查找系统电源状态

> ID：10813714
> 
> 赞同：2
> 
> 时间：2012-05-30T09:42:00.180
> 
> 标签：c++, winapi, power-management, power-state

我正在编写 C++ 代码。我是 C++ 新手。我想找到系统电源状态，即如果它的离线/睡眠/在线等我正在尝试使用[SYSTEM_POWER_STATE 枚举](http://msdn.microsoft.com/en-us/library/windows/desktop/aa373227%28v=vs.85%29.aspx)。但是如果有人可以写一个简短的例子或发布一个有用的链接，就找不到如何使用它。

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-30T09:56:08.817

MSDN 中有大量关于电源管理的信息。

电源管理功能列表及说明：

[http://msdn.microsoft.com/en-us/library/windows/desktop/aa373163(v=vs.85).aspx](http://msdn.microsoft.com/en-us/library/windows/desktop/aa373163(v=vs.85).aspx)

以及使用示例：

[http://msdn.microsoft.com/en-us/library/windows/desktop/aa373243(v=vs.85).aspx](http://msdn.microsoft.com/en-us/library/windows/desktop/aa373243(v=vs.85).aspx)

但是，您的问题有点奇怪：当您睡觉时，您正在……睡觉！您可以将系统切换到挂起模式，但您的软件在系统休眠时没有运行。因此，如果您想要一些更具体的信息，请澄清您的问题。如果您正在编写系统服务或驱动程序，这更有意义，但问题仍然不清楚。

要获取电源状态（电池负载、电源），请使用[GetSystemPowerStatus](http://msdn.microsoft.com/en-us/library/windows/desktop/aa372693%28v=vs.85%29.aspx)。

还有一件事情。如果您谈论的是 Windows CE，那么您可以在这里：[GetSystemPowerState](http://msdn.microsoft.com/en-us/library/ms899319.aspx)。你也没有提到 WinCE :)

# eclipse-plugin - 在工作台中放置视图

> ID：10813715
> 
> 赞同：0
> 
> 时间：2012-05-30T09:42:02.043
> 
> 标签：eclipse-plugin, eclipse-rcp

当我的 RCP 应用程序被盯着时，我想设计我的视图。这意味着 for`viewA`必须出现在左侧，在下方`viewB`。然后在编辑器区域空间中，我想添加另一个`ViewC`和底部的编辑器区域`ViewD`和右侧`viewE`，下方`ViewF`。我该如何设计？此处无法附上图片！！是否有任何链接将视图放在工作台上？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-30T09:59:39.397

如果你想这样做，你必须取消编辑器区域，因为你不能在编辑器区域内拥有视图。

```
public void createInitialLayout(IPageLayout layout) {
    layout.setEditorAreaVisible(false);

    layout.addView("viewA", IPageLayout.LEFT, 1.0f, layout.getEditorArea());
    layout.addView("viewC", IPageLayout.RIGHT, 0.666f, "viewA");
    layout.addView("viewE", IPageLayout.RIGHT, 0.5f, "viewC");

    layout.addView("viewB", IPageLayout.BOTTOM, 0.5f, "viewA");
    layout.addView("viewD", IPageLayout.BOTTOM, 0.5f, "viewC");
    layout.addView("viewF", IPageLayout.BOTTOM, 0.5f, "viewE");
} 
```

请注意，语句的顺序很重要。

# javascript - ajax onreadystatechange 函数

> ID：10813718
> 
> 赞同：0
> 
> 时间：2012-05-30T09:42:07.233
> 
> 标签：javascript, ajax

我有一个运行良好但不回调 onreadystatechange 函数的 ajax oop 脚本。这是代码=>

```
function AjaxConstruct(method,file,params){
    this.method = method;
    this.file = file;
    this.params = params;
    this.http = false;
}

AjaxConstruct.prototype.ajax = function(){
    if (window.XMLHttpRequest){
    this.http = new XMLHttpRequest();
} else {
    this.http = new ActiveXObject("Microsoft.XMLHTTP");
} 
if (this.http){
this.http.open(this.method,this.file,true);
if (this.method==="POST"){
    this.http.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
}
this.http.send(this.params);
this.http.onreadystatechange = function(){
    if (this.http.readyState==4 && this.http.status==200){
        alert("yeah");
    }
};
}
}; 
```

它不回调onreadystatechange匿名函数，如何解决？谢谢 ：）

像这样调用方法=>

```
var ajax = new AjaxConstruct("POST","filename","params");
ajax.ajax(); 
```

但没有调用 onreadystatechange :(

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-30T10:05:17.550

我认为回调被调用，但访问`this.http.readyState`会引发错误，因为在回调内部，`this`不引用您的实例。

查看控制台是否有错误。

只需使用`this.readyState`或将`XMLHTTPRequest`对象分配给局部变量并使用它而不是`this.http`.

了解更多关于[`this`](https://developer.mozilla.org/en/JavaScript/Reference/Operators/this).

# iphone - iOs中的NSDate转换问题

> ID：10813721
> 
> 赞同：0
> 
> 时间：2012-05-30T09:42:19.193
> 
> 标签：iphone, nsdate, nsdateformatter, nstimeinterval

我有一个代表 a 的 double 值`NSTimeInterval`。我想从双精度值创建正确的日期，这是我的代码。我得到了输出，但实际值有一些变化。

```
NSString *modiDate = [NSString stringWithFormat:@"1338229800"]; //example time interval value

NSNumber *time = [NSNumber numberWithDouble:([modiDate doubleValue] - 3600)];
NSTimeInterval interval = [time doubleValue];    
NSDate *online = [NSDate date];
online = [NSDate dateWithTimeIntervalSince1970:interval];    
NSDateFormatter *dateFormatter = [[[NSDateFormatter alloc] init] autorelease];
[dateFormatter setDateFormat:@"MM/dd/yyyy HH:mm:ss aaa"];

NSLog(@"result: %@", [dateFormatter stringFromDate:online]); 
```

这里出了什么问题？任何想法？

**编辑：** 为了首先进行测试，我将日期转换为`NSTimeInterval`并试图取回日期。这是代码和输出。

```
NSString *modDate = [NSString stringWithFormat:@"5/30/2012 2:02:55 PM"];

NSDateFormatter *format = [[NSDateFormatter alloc]init];
[format setDateFormat:@"MM/dd/yyyy HH:mm:ss aaa"];
NSDate *dateFromString1 = [[NSDate alloc] init];
dateFromString1 = [format dateFromString:modDate];
[format release];
NSTimeInterval timeInterval1 = [dateFromString1 timeIntervalSince1970];

NSLog(@"timeinterval : %f",timeInterval1);

NSDate *online = [NSDate date];
online = [NSDate dateWithTimeIntervalSince1970:timeInterval1];    
NSDateFormatter *dateFormatter = [[[NSDateFormatter alloc] init] autorelease];
[dateFormatter setDateFormat:@"MM/dd/yyyy HH:mm:ss aaa"];

NSLog(@"result: %@", [dateFormatter stringFromDate:online]); 
```

输出是：

```
 result: 05/30/2012 12:02:55 PM actual date:5/30/2012 2:02:55 PM 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-30T09:55:37.793

首先，NSTimeInterval 是一个浮点数，因此您不需要使用 NSString 或 NSNumber（NSNumber 用于将数字存储在字典或数组中）。

您可以将代码简化为：

```
NSTimeInterval interval = 1338229800;
interval -= 3600;
NSDate *online = [NSDate dateWithTimeIntervalSince1970:interval];
NSDateFormatter *dateFormatter = [[[NSDateFormatter alloc] init] autorelease];
[dateFormatter setDateFormat:@"MM/dd/yyyy HH:mm:ss aaa"];
NSLog(@"result: %@", [dateFormatter stringFromDate:online]); 
```

这给了我：`05/28/2012 19:30:00 PM`

它对应于初始值：1338229800 减去一小时（- 3600 秒）。

编辑 ：

在您的编辑中，您的写作：

```
NSString *modDate = [NSString stringWithFormat:@"5/30/2012 2:02:55 PM"];
NSDateFormatter *format = [[NSDateFormatter alloc]init];
[format setDateFormat:@"MM/dd/yyyy HH:mm:ss aaa"]; 
```

但是你应该检查[日期格式模式页面](http://unicode.org/reports/tr35/tr35-6.html#Date_Format_Patterns)：
`2:02:55 PM`对应`@"h:mm:ss a"`而不是~~`"HH:mm:ss aaa"`~~

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-30T09:57:33.780

这段代码有很多问题：

为什么要创建所有这些对象：

```
NSString *modiDate = [NSString stringWithFormat:@"1338229800"]; //example time interval value
NSNumber *time = [NSNumber numberWithDouble:([modiDate doubleValue] - 3600)];
NSTimeInterval interval = [time doubleValue]; 
```

当这是相同的：

```
 NSString *modiDate = [NSString stringWithFormat:@"1338229800"];
 NSTimeInterval interval = [modiDate doubleValue]  - 3600; 
```

* * *

在这里，您可以在线设置新日期：

```
NSDate *online = [NSDate date]; 
```

只是在这里设置另一个在线日期：

```
online = [NSDate dateWithTimeIntervalSince1970:interval]; 
```

你应该这样做：

```
NSDate *online = [NSDate dateWithTimeIntervalSince1970:interval]; 
```

* * *

我确定您对这段代码有什么问题，但它可以正常工作。您可能想要设置语言环境，这不是真正需要但可能对本地化有一些影响：

```
NSDateFormatter *dateFormatter = [[[NSDateFormatter alloc] init] autorelease];
dateFormatter.locale = [NSLocale systemLocale];
[dateFormatter setDateFormat:@"MM/dd/yyyy HH:mm:ss aaa"];

NSLog(@"result: %@", [dateFormatter stringFromDate:online]); 
```

* * *

**从编辑中添加了新代码**

在您的编辑中，您添加了以下代码：

```
NSDate *dateFromString1 = [[NSDate alloc] init];
dateFromString1 = [format dateFromString:modDate]; 
```

在这里，您正在泄漏一个`NSDate`对象，只需执行以下操作：

```
NSDate *dateFromString1 = [format dateFromString:modDate]; 
```

正如[马丁](https://stackoverflow.com/users/127493/martin)在回答中所说的那样，问题出在时间格式字符串中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-30T10:09:57.067

您正在使用 24 小时的 HH。而是使用适用于 AM/PM 格式的 hh (0-12)。

# ruby-on-rails - 与嵌套属性和多对多关系的自动完成关联

> ID：10813725
> 
> 赞同：1
> 
> 时间：2012-05-30T09:42:29.743
> 
> 标签：ruby-on-rails, ruby-on-rails-3

我已经按照自动完成协会 Railscast 将“艺术家”添加到我的“发布”中。一切似乎都运行良好，但我随后注意到它每次都在创建一个新艺术家，而不是通过自动完成选择现有的艺术家。

与 railscast 不同，我使用的是多对多关系，并且艺术家也被接受为版本下的嵌套属性，所以我知道这个问题可能与其中一个或两个有关。

以下是我的模型和相关观点。在我看来，这条线`self.artist = Artist.find_or_create_by_name(name) if name.present?`没有被使用。我认为这是因为我有`f.autocomplete_field :name`而不是，`f.autocomplete_field :artist_name`但是当我改变它时，我得到一个无方法错误！

有人可以帮忙吗？

```
class Release < ActiveRecord::Base
  has_many :artist_releases
  has_many :artists, :through => :artist_releases

  accepts_nested_attributes_for :artists, :reject_if => lambda { |a| a[:name].blank? }
  accepts_nested_attributes_for :artist_releases

  def artist_name
   artist.try(:name)
  end

  def artist_name=(name)
   self.artist = Artist.find_or_create_by_name(name) if name.present?
  end      
end

class ArtistRelease < ActiveRecord::Base
  belongs_to :artist
  belongs_to :release
end

class Artist < ActiveRecord::Base
  has_many :artist_releases
  has_many :releases, :through => :artist_releases  
end

#Release Form
<%= form_for(@release) do |f| %>
<%= f.text_field :title, :class => "text" %>
    <%= f.fields_for :artists do |builder| %>
    <%= render 'artist_fields', :f => builder %>
    <% end %>
    <p><%= link_to_add_fields "Add Artist", f, :artists %> </p>
<% end %>

#Artist Fields
<p>
<%= f.label :artist_name, "Artist" %><br />
<%= f.autocomplete_field :name, autocomplete_artist_name_releases_path, :id_element => '#artist_id', :class => "text" %>
</p> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-30T10:18:55.767

你应该要么把

```
<%= f.autocomplete_field :artist_name, autocomplete_artist_name_releases_path, :class => "text" %> 
```

其中 f 是发布形式。但这分配给 Release#artist （只有一个），它应该是未定义的，因为你的发布模型`has_many :artists`

你可以做的是允许逗号分隔列表中的许多名称。请注意，我们将其直接放在发布形式中，不需要嵌套属性。

```
#Release Form
<%= form_for(@release) do |f| %>
<%= f.text_field :title, :class => "text" %>
...
<%= f.autocomplete_field :artist_names, autocomplete_artist_name_releases_path, :class => "text", 'data-delimiter' => ',' %>
<% end %> 
```

在发布模型中，不需要嵌套属性。

```
class Release < ActiveRecord::Base
  has_many :artist_releases
  has_many :artists, :through => :artist_releases

  attr_accessor :artist_names 
  def artist_names=(names)
    self.artists = names.split(',').map { |name| Artist.find_or_create_by_name(name.strip) }
  end 
end 
```

您可以使用嵌套属性解决，但仅在您有多个字段供艺术家填写时才建议使用。

# python - 使用 Python 图像库模糊包含文本的图像

> ID：10813726
> 
> 赞同：4
> 
> 时间：2012-05-30T09:42:30.717
> 
> 标签：python, python-imaging-library

我有一个包含一些文本的图像（在标准文档字体大小中），我试图模糊图像，使文本不再可读。

然而，PIL 中的默认 ImageFilter.BLUR 太强了，所以图像只是被消隐了，除了这里和那里的单个像素。

PIL 的某处是否存在较弱的 BLUR？还是有更好的过滤器/更好的方法？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-30T09:53:38.723

`BLUR`只是一个预设`ImageFilter.Kernel`：

```
class BLUR(BuiltinFilter):
    name = "Blur"
    filterargs = (5, 5), 16, 0, (
        1,  1,  1,  1,  1,
        1,  0,  0,  0,  1,
        1,  0,  0,  0,  1,
        1,  0,  0,  0,  1,
        1,  1,  1,  1,  1
        ) 
```

其中 BuiltinFilter 是一个简单的 Kernel 自定义子类，它绕过构造函数，`filterargs`包含`size`, `scale`, `offset`, `kernel`。换句话说，`BLUR`相当于：

```
BLUR = Kernel((5, 5), (1, 1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 0, 0, 0, 1, 1, 0, 0, 0, 1, 1, 1, 1, 1, 1)) 
```

比例设置为默认值（`16`，25 个权重的总和），偏移量也是如此。

您可以尝试使用较小的内核：

```
mildblur = Kernel((3, 3), (1, 1, 1, 1, 0, 1, 1, 1, 1)) 
```

或使用比例和偏移值。

# android - 获取并保存 EditText 的输入（在 AlertDialog 内）

> ID：10813736
> 
> 赞同：-1
> 
> 时间：2012-05-30T09:43:05.380
> 
> 标签：android, android-alertdialog

在我的应用程序代码的某些部分中，我有一个显示 AlertDialog 以从用户那里获取值（数字）的方法。但是当我尝试将它保存在一个变量（int）中并返回它时，我得到了这个编译错误：

![在此处输入图像描述](../Images/600378aaf06319dd4accfaff98a60229.png)

错误说：“不能在以不同方法定义的内部类中引用非最终变量*bet ”*

所以我尝试将 bet 作为最终变量，得到一个新错误：“无法分配最终局部变量 bet，因为它是在封闭类型中定义的”

我的想法是调用该方法，显示警报对话框，获取输入值并返回它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-30T09:44:26.120

声明`bet`为全局变量。

```
public class SomeActivity extends Activity {
    int bet=0;
    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);
    }

    private int betDialog() 
    {
        //some code...
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-30T16:13:45.037

我发现的问题的“解决方案”是下一个：

我将需要用户输入的代码移到“onClick();”中

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-30T09:44:21.927

您可以简单地全局分配变量并使用它。

有关更多说明，请参见此处，

[不能引用在不同方法中定义的内部类中的非最终变量](https://stackoverflow.com/q/1299837/603744)

正如[jon-skeet](https://stackoverflow.com/users/22656/jon-skeet)[这里](https://stackoverflow.com/a/5997998/603744)提到的

> 任何使用但未在内部类中声明的局部变量、形式方法参数或异常处理程序参数都必须声明为 final。任何在内部类中使用但未声明的局部变量必须在内部类的主体之前明确分配（第 16 节）。

# svn - 如何忽略 TortoiseSVN 中的目标文件夹

> ID：10813737
> 
> 赞同：4
> 
> 时间：2012-05-30T09:43:08.523
> 
> 标签：svn, tortoisesvn, svnignore

如何忽略 TortoiseSVN 中的目标文件夹？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2016-01-12T11:55:44.423

这是一个老问题，但供进一步参考：它也可以在“TortoiseSVN”->“设置”上下文菜单选项中全局配置。只需将“目标”（用空格分隔）添加到“全局忽略模式”设置中，然后单击“应用”

[![在此处输入图像描述](../Images/db6ab89ee21716db3717e003daa9ba2a.png)](https://i.stack.imgur.com/6faR1.png)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-30T11:27:01.550

我假设您已经设置了一个 Subversion 存储库，并且您想忽略工作副本中名为“target”的文件夹。

右键单击目标文件夹图标，选择“TortoiseSVN -> 添加到忽略列表 -> 目标”；右键单击包含目标的文件夹的图标，然后选择“SVN Commit...”；输入消息文本，然后按 OK。

# mysql - 选择一段时间内的数据

> ID：10813741
> 
> 赞同：1
> 
> 时间：2012-05-30T09:43:12.000
> 
> 标签：mysql, sql, datetime

我想检索过去 24 小时与今天的日期相比的数据 - 1 天。

问题是我的表中没有日期时间字段，但日期分为 3 部分（日/月/年）

我试过这个：

```
select *
from user u
Where DAYOFMONTH (CURDATE () - INTERVAL 1 day) - u.Day <= 1
and MONTH (CURDATE ()) - = 0 u.Month
and YEAR (CURDATE ()) - = 0 u.Year 
```

但如果我进入新的月份，它就不起作用。

你能帮我吗？

非常感谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-30T09:55:02.313

我希望这个查询能解决它。希望 u.Month,u.Day,u.Year 一致。

```
select * from user u Where
STR_TO_DATE(CONCAT(u.Month,'-',u.Day,'-',u.Year), '%m-%d-%Y') = date_add(curdate() , INTERVAL -2 DAY) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-30T09:52:42.553

使用 iso 格式，您可以使用 convert 来获取日期时间（tsql）

像这样的东西（未经测试）

```
SELECT * from user u 
where DATEADD(day,-1,GETDATE()) < convert(datetime, u.Year + u.Month + u.Day ) 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-30T09:47:04.513

您可以从您的字段中格式化一个真实的日期`DATE(CONCAT(u.Year, '-', u.Month, '-', u.Day))`：然后您可以对其进行常规日期操作（例如减法`INTERVAL 1 DAY`）

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-30T10:56:05.410

首先，这个计算的结果不会是精确的。您想“*检索过去 24 小时的数据*”，但您没有存储时间，只是存储日期。所以你只能从*今天*或*今天和昨天*检索数据：

*   仅提取今天的记录时：当您在 H00:00:01 提取数据时，可能会出现边界条件。由于您没有存储时间值，因此您将丢失昨天的数据，这很可能意味着*所有数据*。
*   在拉取今天和昨天的记录时：当您在 H23:59:59 拉取数据时，可能会出现边界条件。由于您不存储时间值，因此您将从 2 天（- 1 秒）中提取数据。

总之，将时间值添加到您的表中。最好是一列`DATETIME`或`TIMESTAMP`数据类型（[差异仅在范围内](http://dev.mysql.com/doc/refman/5.5/en/datetime.html)）。

回到你的问题。基本上，你想要做的是：

```
/*
select * from table
where date >= now - 1 day;
*/ 
```

如何计算`now - 1 day`？带[`DATE_SUB()`](http://dev.mysql.com/doc/refman/5.5/en/date-and-time-functions.html#function_date-add)功能：

```
DATE_SUB(NOW(), INTERVAL 1 DAY) 
```

如何使您的列中的日期？具有[`CONCAT_WS`](http://dev.mysql.com/doc/refman/5.5/en/string-functions.html#function_concat-ws)和[`STR_TO_DATE()`](http://dev.mysql.com/doc/refman/5.5/en/date-and-time-functions.html#function_str-to-date)功能：

```
STR_TO_DATE(CONCAT_WS('-', u.Day, u.Month, u.Year, '00', '00', '00'), '%d-%m-%Y-%H-%i-%s') 
```

连接的字符串中有零 - 只要将这些列添加到表中，您就可以将它们替换为`u.Hour`, 。但正如我之前所说，您将使用列实现最佳性能。`u.Min``u.Sec``DATETIME`

总结：

```
SELECT *
FROM users u
WHERE STR_TO_DATE(CONCAT_WS('-', u.Day, u.Month, u.Year, '00', '00', '00'), '%d-%m-%Y-%H-%i-%s') >= DATE_SUB(NOW(), INTERVAL 1 DAY) 
```

# html - 使一行带有边框和边距的 div 动态填充宽度

> ID：10813743
> 
> 赞同：2
> 
> 时间：2012-05-30T09:43:20.817
> 
> 标签：html, css, fluid-layout

考虑以下代码：

**CSS：**

```
.output {
    margin-right:10px;
    border:1px solid #000;
}
.box{
    border-right:1px solid #000;
}
.first{
    border-left:1px solid #000;
} 
```

**HTML：**

```
<div class="line">
    <div class="output">5</div>
    <div class="boxes">
        <div class="box first"><span>&nbsp;</span></div>
        <div class="box"><span>&nbsp;</span></div>
        <div class="box"><span>&nbsp;</span></div>
        <div class="box"><span>&nbsp;</span></div>
        <div class="box last"><span>&nbsp;</span></div>
    </div>
</div> 
```

我希望 div 水平排列并填充 'line' div' （父级的空间），但动态地，例如我不想为每个框指定固定宽度，我只想让它们填满水平空间.

这可以做到吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-30T10:45:49.123

一种简单且[广泛支持](http://caniuse.com/css-table)的方法是`display: table`.

**见：http:** [//jsfiddle.net/thirtydot/tPCwD/](http://jsfiddle.net/thirtydot/tPCwD/)

请注意，您可以更改`.box`元素的数量，它仍然有效。

```
.line {
    border: 3px solid red;
    display: table;
    width: 100%;
}
.output {
    padding-right: 10px;
    display: table-cell;
    width: 1px; /* take the minimum amount of space */
    white-space: nowrap;
}
.output > span {
    border:1px solid #000;
}
.boxes {
    display: table;
    width: 100%;
    table-layout: fixed; /* to force equal width columns */
}
.box {
    border-right:1px solid #000;
    display: table-cell;
    background: #ccc;
}
.first {
    border-left:1px solid #000;
} 
```

如果需要对 IE7 及更低版本的支持，您可以仅对这些浏览器使用 JavaScript（条件注释）。有一个[`.htc`JavaScript polyfill 可用](http://tanalin.com/en/projects/display-table-htc/)，但我不确定它在这个布局上的效果如何。或者，您可以只使用真正的`<table>`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-30T09:55:00.720

如果您只想填充水平空间`output`，`boxes`我会使用`float:left`on `output`。这样，它将占用所需的空间，而`boxes`盒子将填满其余的空间。

另一方面，如果你想让五个`box` `div`s 来填充它们的父级，只需给每个一个 a`width:20%`并设置`box-sizing:border-box`以考虑边界。在这种情况下，你必须让浏览器知道每个盒子之间的关系应该有多大，否则它怎么知道要扩展哪个盒子来填充空间？

5 es 的另一种选择是`box`，如果您想处于“最前沿”，请查看[flexbox 规范](https://developer.mozilla.org/en/Using_flexbox)。

# c# - ASP.Net RadioButtonList SelectedIndexChanged 事件未触发

> ID：10813744
> 
> 赞同：1
> 
> 时间：2012-05-30T09:43:31.627
> 
> 标签：c#, asp.net

我正在构建一个动态 RadioButtonList 来列出特定搜索项的所有记录，并允许用户选择相关选项。然而，我遇到的问题是 SelectedInhdexChanged 事件永远不会触发。

我已经尝试初始化 RadioButtonList 并在 page_load 和 page_init 方法中分配其事件处理程序。我还尝试将 RadioButtonList 拖到页面上并双击它以这种方式创建事件处理程序 - 但仍然没有运气。

有任何想法吗？我在下面粘贴了我的代码供您查看：

这是我的 Page_Load 和事件处理程序方法：

```
protected void Page_Load(object sender, EventArgs e)
    {
        if (!Page.IsPostBack)
        {
            measureDropdown = loadDropdown("GetMeasuringTypes", measureDropdown);
            categoryDropdown = loadDropdown("GetCategories", categoryDropdown);
        }

        rBtn = new RadioButtonList();
        rBtn.CausesValidation = true;
        rBtn.SelectedIndexChanged += new EventHandler(rBtn_SelectedIndexChanged);
    }

    void rBtn_SelectedIndexChanged(object sender, EventArgs e)
    {
        moreThanOneLbl.Text = "Woohoo!";
    } 
```

这是我将列表项分配给 RadioButtonList（来自数据表）的方式：

```
foreach (DataRow row in table.Rows)
            {
                ListItem li = new ListItem();
                li.Value = row[0].ToString();
                li.Text = row[1].ToString() + ": " + row[2].ToString();
                //rBtn.Items.Add(li);
                RadioButtonList1.Items.Add(li);

            } 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-05-30T09:46:13.167

尝试将 AutoPostBack 属性设置为 true。

```
rBtn.AutoPostBack = true 
```

# javascript - 为什么将 django 内联表单集克隆为具有相似 id 和名称的表单？

> ID：10813745
> 
> 赞同：1
> 
> 时间：2012-05-30T09:43:32.233
> 
> 标签：javascript, jquery, python, django

在我的项目中，我使用 django 内联表单集。我得到了 jquery 来克隆表单集，但不幸的是，克隆的表单具有相同的名称和 id，因此在最后一个表单中输入的数据会覆盖第一个表单中的数据。我可能做错了什么？

这是脚本：

```
<script type="text/javascript">>
function cloneMore(selector, type) {
    var newElement = $(selector).clone(true);
    var total = $('#id_' + type + '-TOTAL_FORMS').val();
    newElement.find(':input').each(function() {
        var name = $(this).attr('name').replace('-' + (total-1) + '-','-' + total + '-');   
        var id = 'id_' + name;
        $(this).attr({'name': name, 'id': id}).val('').removeAttr('checked');
    });
    newElement.find('label').each(function() {
        var newFor = $(this).attr('for').replace('-' + (total-1) + '-','-' + total + '-');  
        $(this).attr('for', newFor); 
    }); 
    total++;
    $('#id_' + type + '-TOTAL_FORMS').val(total);
    $(selector).after(newElement);
}

</script> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-30T16:25:14.100

我将 CloneMore.js 脚本用于相同目的（此时我的版本已修改）。我不知道您是否属于这种情况，但是如果您有任何被 javascript 修改的字段，则需要重新初始化该字段。例如，uniform.js 选择器、日期选择器或任何自动完成字段可能需要重置。

这是我点击克隆按钮时处理其中一些问题的代码片段。另请注意，这些都在[`live()`](http://api.jquery.com/live/)

```
// #add_more is my button to add a formset
$('#add_more').live('click',function() { 
    cloneMore('div.line_item:last', 'lineitem');
    $(".line_item:last").find('.hasDatepicker').each(function() {
        // remove then initialize datepicker
        $(this).removeClass("hasDatepicker").datepicker( {dateFormat:'mm/dd/yy'} );
    });
    $(".line_item:last").find('.autocomplete_field').each(function() {
        // remove then initialize autocomplete
        $(this).autocomplete('destroy');
        // enable_autocomplete is a custom function, but it's basically just 
        // $(this).autocomplete({ options... })
        enable_autocomplete($(this), cust_part_url);
    });
}); 
```

编辑：我认为这个[SO Answer](https://stackoverflow.com/a/669982/484669)是 cloneMore 脚本的起源

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-30T13:07:48.520

django formset 中的每个表单都提供了唯一的 name 属性，它充当 django 的一种 id，这意味着如果您在 formset 中克隆第一个表单，这意味着您还将克隆它的 id，因此克隆它将覆盖第一个形式。

您可以使用/克隆[Baseformset](https://docs.djangoproject.com/en/dev/topics/forms/formsets/#empty-form)提供的 empty_form，`{{form.empty_form}}`为其提供适当的名称并更新`-TOTAL_FORMS`

# xml - 是否可以使用 FOP 0.95 和 exsl:node-set() 函数解析包装在 CDATA 中的 XML？

> ID：10813749
> 
> 赞同：0
> 
> 时间：2012-05-30T09:43:55.853
> 
> 标签：xml, xslt, xslt-1.0, cdata

美好的一天，请指教。我正在使用 FOP 0.95（1.0 版）和 EXSL 扩展。我有这个 XML：

```
<List>
  <Item>
    <Details><![CDATA[<details><weight>0.5kg</weight><colour>Red</colour></details>]]></Details>
  </Item>
</List> 
```

有没有办法如何使用 exsl:node-set() 函数解析 CDATA 中的字符串？以下代码输出“<details><weight>0.5kg</weight><colour>Red</colour></details>”而不是“0.5kg Red”，这意味着它不会被解析而是作为字符串处理：

```
<xsl:variable name="txtDetails" select="/List/Item/Details"/>
<xsl:variable name="details" select="exsl:node-set($txtDetails)"/>
<xsl:value-of select="$details"/> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-30T17:16:31.957

答案是不。包装在 CDATA 部分中的内容不会被解析为 XML 标记。这就是 CDATA 部分的重点。使用`exsl:node-set()`没有帮助。

这个问题与 XSL-FO 无关。FOP 是 XSL-FO 处理器，而不是 XML 解析器。它当然使用了 XML 解析器，但这并不影响这个答案。FOP 也不是 XSLT 处理器；即使它可以进行 XSLT 转换，实际的 XSLT 处理器也会在“幕后”完成真正的工作。

# android - 最佳实践 - 允许离线使用 Android 应用？

> ID：10813750
> 
> 赞同：0
> 
> 时间：2012-05-30T09:44:05.200
> 
> 标签：android

目前我正在开发一个必须与服务器通信（例如通过 REST）来加载、保存数据等的 Android 原生应用程序。

现在我正在考虑离线场景。如果手机当前没有网络连接，我还希望用户保存数据。如果网络连接再次启动，我想将用户数据与我的服务器同步。

有谁知道一些最佳实践来实现这一目标。我正在考虑使用 couchdb 进行复制，但我想知道是否还有其他好方法来支持我的应用程序的离线使用。

多谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-30T09:53:08.517

您可以为此目的使用广播接收器

```
 <receiver android:name=".ConnectionReceiver" >
            <intent-filter>
                <action android:name="android.net.conn.CONNECTIVITY_CHANGE" />
            </intent-filter>
        </receiver> 
```

如果连接性改变（打开或关闭），我们可以知道使用此广播接收器...并启动一个异步任务以进行刷新并从服务器加载新数据

# sql - 具有多个值的 SQL Server 2008 查询

> ID：10813751
> 
> 赞同：1
> 
> 时间：2012-05-30T09:44:05.990
> 
> 标签：sql, sql-server-2008, stored-procedures

我的 SQL Server 2008 数据库中有下表

```
dbo.FormEmployment
------------------
employmentID int (PK)
formID int (FK)
gradeID int
employerName nvarchar 
```

我希望创建一个查询，该查询将根据他们的gradeID 选择所有用户。目前我有以下查询

```
DECLARE @gradeID int
SET @gradeID = 1

SELECT distinct u.userID, u.userTypeID, u.firstName, u.lastName, u.email, u.password, u.contactNumber, u.organisationID, u.emailVerificationCode, u.mobileVerificationCode, u.userStatusID 

FROM [User] u, dbo.FormEmployment emp, dbo.Form f

WHERE u.userTypeID = 47 
--Grades
AND emp.gradeID = @gradeID
AND f.formID = emp.formID
AND f.locumID = u.userID 
```

上面的查询允许我声明一个gradeID，然后获取与该gradeID 匹配的所有用户。但是，我还需要能够声明几个gradeID，例如，我希望我的参数@gradeID 是这样的

设置@gradeID = 1、2、3

这样它将获得所有具有 1、2 或 3 级的用户。

反正有这样做吗？任何帮助或指导将不胜感激，因为我必须为应用程序构建的搜索依赖于它。

谢谢。

**编辑**

有关搜索如何工作的更多信息。

每个 GradeID 都将存储在数据库中的一个表中。用户将看到gradeID 的复选框列表，然后他们将能够从该列表中选择任意数量的gradeID。一旦他们单击“提交”，他们选择的等级 ID 将被传递到我的存储过程以执行搜索。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-30T09:54:25.780

```
DECLARE @grades
        TABLE
        (
        id INT
        )

INSERT
INTO    @grades
VALUES
        (1),
        (2),
        (3)

SELECT   u.userID, u.userTypeID, u.firstName, u.lastName, u.email, u.password, u.contactNumber, u.organisationID, u.emailVerificationCode, u.mobileVerificationCode, u.userStatusID 
FROM     [User] u
WHERE    userId IN
         (
         SELECT  f.locumId
         FROM    FormEmployment emp
         JOIN    Form f
         ON      f.formId = emp.formId
         WHERE   emp.gradeId IN
                 (
                 SELECT  id
                 FROM    @grades
                 )
         )
         AND u.userTypeID = 47 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-30T09:50:23.400

一种可能：

```
SELECT (...) 
FROM (...) 
WHERE emp.gradeID IN (@gradeID1, @gradeID2, @gradeID3) 
```

如果不知道参数个数，可以在运行时生成sql IN子句（同时给`SqlCommand`实例添加参数）

# javascript - 追加后的JQuery隐藏

> ID：10813753
> 
> 赞同：3
> 
> 时间：2012-05-30T09:44:18.660
> 
> 标签：javascript, jquery, variables, append, hide

我正在运行一个脚本，该脚本将在从下拉列表中选择元素时附加一个元素，该位一切正常并附加该项目。附加的项目包括一个按钮，单击该按钮将隐藏附加的项目。我似乎无法开始工作的是隐藏功能。如果我将元素手动放入 HTML 并单击隐藏按钮，代码似乎可以正常工作，但由于某种原因，在附加它时它不起作用？

```
$('#addteammember').click(function() {
 var usernamevalue = $("#teammemberselected").val();
 var teammemberfullname = $('#teammemberselected option:selected').text();
  $('#teammemberlist').append("<li><input class='removeteam' type='button' value="+usernamevalue+" /><span class='listitem'>"+teammemberfullname+"</span></li>");
});

$('.removeteam').click(function () {
  $(this).hide();
}); 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-30T09:45:58.273

发生这种情况是因为您动态附加按钮，但`click`仅将处理程序绑定到已经存在的元素。您可以改用此代码：

```
$("#teammemberlist").on("click", ".removeteam", function () {
    $(this).hide();
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-30T09:48:11.513

试试`live`功能。

```
$(".removeteam").live("click", function() {
$(this).hide();
}); 
```

# jquery - 具有灵活标签的 CSS 无表格表单

> ID：10813760
> 
> 赞同：1
> 
> 时间：2012-05-30T09:44:35.317
> 
> 标签：jquery, html, css, forms, label

我有管理站点，其中包含许多表单，这些表单往往通过对齐标签来设置样式：

```
<form>
    <label for="name"><input type="text" name="name">
    <label for="name"><input type="text" name="name">
    <label for="name"><input type="text" name="name">
</form> 
```

我通常会做些什么来获得效果：

```
label{
    width: 150px /* fixed that is */
    text-align: right;
} 
```

这很好用，但是当我的多个表单有时具有非常不同且更长的标签名称时，如果我希望所有表单在垂直线上完美对齐，这会迫使我为最大的元素提供最小所需的宽度。但是当内容很少时，巨大的差距就来了，结果总体上不够灵活。

有没有人有解决这个问题的想法？Css 或 jQuery（不确定它是否有效）可能吗？但是我对 jQuery 的想法是从特定表单循环 .width() （有时同一页面上几乎没有不同的表单），并从中选择 max，然后将其作为宽度分配给它们的父级，但这似乎是一个麻烦的解决方案。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-31T08:48:50.633

好吧，这个怎么样...

使用百分比宽度和浮动：左。长标签会包裹在多行上（我知道这不是您所要求的）。

HTML：

```
<form>
    <label for="name">lka;sjdl kfa jsldkkfjlkasdjf alkdsjalkfk asdfasd asd fasdf dfdsa afsd afdsf asdfsdads jdaslk </label>
    <input type="text" name="name">
    <label for="name">ljlkjljljljljlkj</label>
    <input type="text" name="name">
    <label for="name">asdfasfdsasdaf</label>
    <input type="text" name="name">
</form> 
```

CSS：

```
form {
    width:400px;
}
label {
    width: 48%;
    float:left;
    clear:both;
}
input {
    width: 48%; 
    float: left;
} 
```

我发现你需要让总宽度加起来略低于 100%，以考虑继承的边界和边距等。我确定 49% 可以通过反复试验来工作。

仅在 Firefox 中测试。

# wso2 - GreG 嵌套模板

> ID：10813762
> 
> 赞同：1
> 
> 时间：2012-05-30T09:44:42.973
> 
> 标签：wso2, wso2greg

我们需要在主模板中嵌套模板。嵌套模板应该能够显示客户可以填写的字段。例如，此邮件有两个附件。文件 1.jpg：在这张图片中，您可以看到它如何显示带有加号的按钮。它有一个红色箭头。当我按下按钮时，它会显示一个嵌套模板。在这个模板中，我可以填写事件类型和路径字段，仅此而已。在我们的例子中，我们需要显示用户可以填写的字段，以及在嵌套模板中添加更多嵌套模板的选项。在图片 2.jpg 中，您可以看到我们需要的结果。此图像 2 显示了一个指向绿色按钮的红色箭头。如果您按下绿色按钮，它会显示另一个嵌套模板。在此模板中，您可以填写更多字段。此外，您还有另一个绿色按钮可以嵌套另一个模板。

总结一下，我们需要创建复杂的模板，即包含在主模板中的模板。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T11:57:51.690

如果您的意思是通过嵌套模板嵌套 RXT，那么 WSO2 Governance Registry 目前不支持嵌套 RXT。

# java - 如何告诉oracle按照从java传入的特定排序顺序进行排序？

> ID：10813767
> 
> 赞同：6
> 
> 时间：2012-05-30T09:45:12.313
> 
> 标签：java, sql, oracle, sorting

这是我需要做的。

我在java中有一个列表，我可以将其转换为逗号分隔的ID字符串，例如“3,4,5,6,1,2”

我想知道是否有办法将该字符串传递给oracle并根据该字符串的排序顺序对sql代码进行排序？

所以这个查询：

```
select t.id
from t_test t 
```

将导致此订单

```
ID
3
4
5
6
1
2 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-30T10:24:53.540

如果您可以在 java 中修改查询，则可以执行以下操作：

```
SELECT t.id
FROM t_test t
ORDER BY DECODE(t.id, 3, 'A', 'B') ASC,
         DECODE(t.id, 4, 'A', 'B') ASC,
         DECODE(t.id, 5, 'A', 'B') ASC,
         DECODE(t.id, 6, 'A', 'B') ASC,
         DECODE(t.id, 1, 'A', 'B') ASC,
         DECODE(t.id, 2, 'A', 'B') ASC; 
```

您必须为列表中的每个元素在 order by 子句中放置一个解码。每个解码中的第二个参数是列表的一个元素。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-30T10:30:01.387

像这样的东西：

```
with ordered_ids as (
  select to_number(regexp_substr ('3,4,5,6,1,2','[^,]+',1,level)) as id, level as sort_order
  from dual
  connect by regexp_substr ('3,4,5,6,1,2','[^,]+',1,level) is not null
)
select t.id
from t_test t 
  join ordered_ids oi on oi.id = t.id
order by oi.sort_order; 
```

您可能可以将文字`'3,4,5,6,1,2'`作为 PreparedStatement 的参数，但我尚未对此进行测试。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-30T09:49:49.483

我不认为这是可能的。您只能在查询中使用升序或降序。但是您可以做的是使用这样的准备好的语句`select * from t_test t where t.id = ?`并为列表中的每个 ID 运行此语句并将结果添加到结果列表中。

您也可以尝试使用参数为 ID 列表的存储过程来执行此操作

**编辑**

另一个想法是在你的 ID 列表的小块上使用 IN 运算符（每个可能有 10 个）。由于这将以未指定的顺序返回结果，因此您可以编写一个自定义比较器或另一个类，将该列表带入您指定的顺序。然后，您可以将所有子列表连接到一个结果列表中。对于包含 100 个条目和批量大小为 10 的列表，您只需要 10 个数据库查询 + 一些时间进行重新排序

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-30T09:52:58.693

```
select t1 from (select t.id t1 from t_test t order by t.id asc); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-30T10:08:27.810

在休眠中你可以做 -

```
public String getResult(String sortOrder){
    SQLQuery query = getSession().createSQLQuery("select t from ( select t.id t from t_test t order by t.id=:sortOrder").addScalar("name", Hibernate.STRING);    
    query.setString("sortOrder", sortOrder);
    return (String)query.uniqueResult();
} 
```

# actionscript-3 - 主 SWF 和运行时从另一个域加载的 SWF 之间的类不匹配

> ID：10813769
> 
> 赞同：3
> 
> 时间：2012-05-30T09:45:16.027
> 
> 标签：actionscript-3, class, flash, cross-domain

我加载了一个外部 SWF。**外部 SWF**有一个嵌入的DisplayObject **(** *getChildAt(0))* ，我使用以下代码获得了它的**Class**的一个实例：

```
 public function getEmbedded():* {
        var _class:Class = loaderInfo.applicationDomain.getDefinition(getQualifiedClassName(getChildAt(0))) as Class;
        return new _class();
    } 
```

到目前为止，一切都很好。如果**主 SWF**（加载上述外部 SWF）和**外部 SWF**在同一个域中（本地或在线），则**主**SWF和**外部**SWF的类**匹配**：

例如，我在外部 SWF 中嵌入了一个**fanlib.tween.TPlayer对象。**在主要的 SWF 中，我这样做：

```
var clip3:fanlib.tween.TPlayer = externalSwf.getEmbedded(); 
```

它工作正常。

**但！！！**

**如果外部 SWF 是从另一个域加载的，则类不匹配！！！**

我收到这样的错误：

> [Fault] 异常，信息=TypeError: Error #1034: Type Coercion failed: cannot convert fanlib.tween::TPlayer@2563221 to fanlib.tween.TPlayer。

这不是*crossDomain*的问题，我已经正确设置了*XML*文件和*安全上下文*，并且外部 SWF 加载时**没有安全错误**。尝试将嵌入类转换为主对象时会出现问题。

这可以用任何方式解决吗？？？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-05T23:31:24.963

你可以让你的代码工作使用
`var clip3:* = externalSwf.getEmbedded();`
，如果你想保持你的代码警告免费使用`interface`
`var clip3: TplayerInterface = externalSwf.getEmbedded() as TplayerInterface;`

# javascript - 在循环中创建对象时未执行函数 - javascript

> ID：10813773
> 
> 赞同：0
> 
> 时间：2012-05-30T09:45:29.280
> 
> 标签：javascript, function

在下面的代码中，drawFunc 在循环期间没有执行（我可以看到，通过逐步调试，代码只是跳转到函数的末尾）。

该函数在“stage.add(layer);”行执行，导致错误。

有关如何解决此问题的任何帮助？

```
<html>
    <head>
        <style>
            body {
                margin: 0px;
                padding: 0px;
            }
            canvas {
                border: 1px solid #9C9898;
            }
        </style>
        <script type="text/javascript" src="http://www.html5canvastutorials.com/libraries/kinetic-v3.9.7.js"></script>
        <script>
            window.onload = function() {

                // global parameters
                var curvatureX = 10;
                var curvatureY = 10;
                var nodeRadius = 10;

                var stage = new Kinetic.Stage({
                    container: "container",
                    width: 578,
                    height: 300
                });
                var layer = new Kinetic.Layer();

                var nodes = [];

                for (var i = 0;i<10;i++){
                    nodes[i] = new Kinetic.Circle({
                        x: i*20,
                        y: i*5,
                        z:1,
                        radius: nodeRadius,
                        fill: "blue",
                        stroke: "black",
                        strokeWidth: 4
                    });
                    layer.add(nodes[i]);

                }

                var edges = [];
                for (var i = 0;i<9;i++){
                    console.log("just after the for: "+i);
                    edges[i]= new Kinetic.Shape({

// *** PROBLEMS IS HERE
// *** FOR LOOP SKIPS THE FOLLOWING LINES

                        drawFunc: function() {
                            var context = this.getContext();
                            context.beginPath();
                            console.log("in the drawing function: "+i);
                            context.moveTo(nodes[i].getX(), nodes[i].getY());
                            if ((nodes[i].getY()-nodes[i+1].getY())<0){
                                context.quadraticCurveTo((nodes[i].getX()+nodes[i+1].getX()+curvatureX)/2, (nodes[i].getY()+nodes[i+1].getY()-curvatureY)/2, nodes[i+1].getX(), nodes[i+1].getY());
                            }
                            else{
                                context.quadraticCurveTo((nodes[i].getX()+nodes[i+1].getX()+curvatureX)/2, (nodes[i].getY()+nodes[i+1].getY()+curvatureY)/2, nodes[i+1].getX(), nodes[i+1].getY());

                            }
                            context.lineWidth = 10;
                            // line color
                            context.strokeStyle = "black";
                            context.stroke();
                        },

// *** LOOP RESUMES HERE

                        fill: "#00D2FF",
                        stroke: "black",
                        strokeWidth: 4
                    });
                    layer.add(edges[i]);
                }

                //*** FUNCTION IS EXECUTED HERE, CAUSING BUG.
                stage.add(layer);

                var amplitude_1 = 100;
                var amplitude_2 = 30;
                var period = 2000;
                // in ms
                var centerX = stage.getWidth() / 2;
                var centerY = stage.getHeight() / 2;

                stage.onFrame(function(frame) {
                    for (var i=0;i<nodes.length;i++){
                        nodes[i].setX(amplitude_1 * i * Math.sin(frame.time * 2 * Math.PI / period) + centerX);
                        nodes[i].setY(amplitude_2 * i+ 20);
                    }
                    layer.draw();

                });

                stage.start();
            };

        </script>
    </head>
    <body>
        <div id="container"></div>
    </body>
</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-30T10:20:07.413

您**不能**使用在函数*外部*声明的变量，并假定在该函数*内部*使用它的值就是函数声明时的值。

在循环变量的特定情况下，在调用内部函数时，该变量将具有分配给它的*最后一个值。*

要解决此问题，您必须在新范围内“关闭”外部变量的值，在您的情况下，如下所示：

```
for (var i = 0; i < 9; ++i) {
    ...
    drawFunc: (function(i) {  //  <------------+
        return function() {   //               |
            alert(i);         // you can use this "i" here
        }
    })(i)
} 
```

不寻常的构造现在有一个*立即调用的函数表达式*，它已*传递*给您的循环变量`i`，但现在在其范围内具有该变量的本地绑定副本。

# c# - 单击其他单元格时如何在文本框中获取gridview的单元格值？

> ID：10813781
> 
> 赞同：0
> 
> 时间：2012-05-30T09:45:56.810
> 
> 标签：c#, asp.net, mysql

我有一个包含 4 列的网格视图，即：“用户 ID”、“描述”、“显示密码”、“更改密码”。

我在每个单元格的更改密码列中放置了一个图像按钮，在 Gridview 下方有 3 个文本框。

当我单击更改密码时，该特定行的用户 ID 应显示在文本框 1 中。

如何使用 C# 在 asp.net 中执行此操作，后端是 MySql DB 服务器？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-30T12:19:34.780

我的偏好是使用该`CommandArgument`属性并将点击事件的方法直接分配给后面的aspx代码中的按钮：

```
<asp:Button ID="btnChangePassword" CommandArgument='<%# Eval('UserID') %>' OnClick="MyEventMethod" /> 
```

然后在后面的代码中你会有一个方法来处理它：

```
public void MyEventMethod(object sender, EventArgs e)
{
    Button btn = (Button)sender;
    this.TextBox1.Text = btn.CommandArgument;
} 
```

另一种方法是使用 JavaScript（以避免回发）和 onClientClick 属性。在您的网格视图上方的某个地方，您将有一种方法来处理此分配。

```
<script type="text/javascript">
    // Gets the actual reference to the textbox in javascript
    // using the client id
    function SetTextBoxUserID(userid)
    {
        var textbox1 = document.getElementById('<%= this.TextBox1.ClientID %>');
        textbox1.value = userid;
    }
</script> 
```

然后控件将如下所示：

```
<asp:Button ID="btnChangePassword" OnClientClick='SetTextBoxUserID(<%# "'" + Eval("UserID") + "'" %>)' /> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-30T09:59:48.387

将“更改密码”列更改为超链接字段。在数据部分的该列的属性中，您可以看到 DataNavigateUrlFields 属性。将其设置为“用户 ID”。然后在DataNavigateUrlFormatString属性设置为同一页面如下

```
~/User.aspx?UserId={0} 
```

然后在页面加载事件中编写如下代码

```
String userId= Request["UserId"];
        if (!string.IsNullOrEmpty(userId))
            TextBox1.Text = userId; 
```

这可能不是最好的拍摄。但这可以解决

# sql - 组合 UPDATE 和 SELECT 语句 - 在同一列上添加空格

> ID：10813784
> 
> 赞同：0
> 
> 时间：2012-05-30T09:46:09.413
> 
> 标签：sql

我想做这样的事情，但总是出错，所以代码不正确。我想用空格更新同一列。

```
update table 
set (select line as line1 from  table where id='100')=line1+' ' 
where id='100' 
```

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-30T09:49:41.977

在`DB2`（根据您之前的问题假设，`MySQL`也适用）：

```
UPDATE  table
SET     line = CONCAT(line, ' ')
WHERE   id = '100' 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-30T09:49:00.920

```
update table 
set line=line+' ' 
where id=100 
```

像这样的东西？

# asp.net - 如何在 vb.net 中执行字符串连接？

> ID：10813785
> 
> 赞同：1
> 
> 时间：2012-05-30T09:46:09.820
> 
> 标签：asp.net, .net, c#-4.0, vb.net-2010

这是字符串值`<a href="javascript:changePage('5')">Overview</a>`。现在我想将它存储在 vb.net 中的字符串中。

我如何存储它。

```
Dim link As String="<a href="javascript:changePage('5')">Overview</a>" 
```

请指导我摆脱这个问题？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-30T09:48:33.900

您需要`"`通过将它们加倍来逃避内部：

```
Dim link As String="<a href=""javascript:changePage('5')"">Overview</a>" 
```

C# 版本可以是以下之一：

```
var link = @"<a href=""javascript:changePage('5')"">Overview</a>"

var link = "<a href=\"javascript:changePage('5')\">Overview</a>" 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-30T09:48:18.690

只需在双引号表示的文字中使用单引号即可。使用将输出到浏览器的标记执行此操作将导致引号内单引号的标记无效 - 在这种情况下，您可以使用另一组双引号来*转义*双引号。

```
Dim link As String = "<a href=""javascript:changePage('5')"">Overview</a>" 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-05-30T09:52:14.837

我已经离开 VB.NET 很长时间了，在 C-Sharp 中可以这样做：

```
String link = "<a href=\"javascript:changePage('5')\">Overview</a>"; 
```

我希望它能给你一个想法，你将不得不转义内部的双引号。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-05-30T09:50:55.477

如下使用：

```
Dim link As String = "<a href=\"javascript:changePage('5')\">Overview</a>" 
```

# r - 在 ggplot2 中使用 opts 更改 axis.line 不起作用。这个怎么做？

> ID：10813786
> 
> 赞同：2
> 
> 时间：2012-05-30T09:46:12.173
> 
> 标签：r, ggplot2

在试图以明显的方式得到[这个问题](https://stackoverflow.com/questions/10808761/r-style-axes-with-ggplot)的答案时，我遇到了一个相当意外的错误。我尝试`axis.line`使用功能在主题中设置选项`opts()`，尝试使用更新它`theme_update()`，但都无济于事。每次尝试时，我都会遇到相同的错误：

> ```
> Error in validDetails.polyline(x) : 
>   It is invalid to specify both 'id' and 'id.lengths' 
> ```

给出此错误的一些示例代码：

```
require(ggplot2)

Data <- data.frame(autos=c(
  sample(1:4,8,TRUE),
  sample(6:9,4,TRUE),
  11,18
  ))

ggplot(Data,aes(autos)) + 
  geom_histogram(fill='lightblue',colour="black",binwidth=5) +
  opts(axis.line=theme_line(), panel.border=theme_blank()) 
```

知道我在忽略什么吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-30T09:55:40.203

[https://github.com/hadley/ggplot2/wiki/-opts()-List](https://github.com/hadley/ggplot2/wiki/-opts()-List)上的 ggplot2 wiki包含有用的信息。

描述了每个选项，以及它需要的主题类型。从这个页面：

```
...
axis.title.y (text)
axis.line (segment)
... 
```

因此，`theme_segment`在您的选择中使用：

```
ggplot(Data,aes(autos)) + 
  geom_histogram(fill='lightblue',colour="black",binwidth=5) +
  opts(axis.line=theme_segment(), panel.border=theme_blank()) 
```

![在此处输入图像描述](../Images/28f855dd2e832010b76d7bcd61385a77.png)

# objective-c - 对于混合 ARC 和 NON-ARC 类的项目，僵尸对象的奇怪行为：EXC_BAD_ACCESS

> ID：10813788
> 
> 赞同：0
> 
> 时间：2012-05-30T09:46:16.370
> 
> 标签：objective-c, ios, automatic-ref-counting, nszombie, gmgridview

我的应用程序有一个大问题，我想知道如何解决它。我在 SO 中进行了很多搜索，但找不到有效的解决方案。这是我正在处理的场景。

我有一个非 ARC 应用程序，我在其中使用了一堆 ARC 类。这些类属于[GMGridView](https://github.com/gmoledina/GMGridView)。这些类已通过`-fobjc-arc`指令添加到项目中。

这是我正在使用的代码（为了简单起见，我只添加了关键部分）。

*内存管理部分*

```
- (void)dealloc
{
    [gmGridView setActionDelegate:nil];
    [gmGridView setDataSource:nil];
    [gmGridView release];    

    [super dealloc];
} 
```

*ViewDidLoad 部分*

```
- (void)viewDidLoad
{
    [super viewDidLoad];

    NSInteger topBottomSpacing = 20;
    NSInteger leftRifghtSpacing = 75;
    NSInteger itemSpacing = 5;

    UIView* mainView = [self view];

    GMGridView* gridView = [[[GMGridView alloc] initWithFrame:mainView.bounds] autorelease];    
    gridView.autoresizingMask = UIViewAutoresizingFlexibleWidth | UIViewAutoresizingFlexibleHeight;
    gridView.backgroundColor = [UIColor clearColor];   
    gridView.style = GMGridViewStyleSwap;
    gridView.itemSpacing = itemSpacing;
    gridView.minEdgeInsets = UIEdgeInsetsMake(topBottomSpacing, leftRifghtSpacing, topBottomSpacing, leftRifghtSpacing);
    gridView.centerGrid = NO;
    gridView.actionDelegate = self;
    gridView.dataSource = self;    
    [mainView addSubview:gridView];

    [self setGmGridView:gridView]; // retain policy
} 
```

*数据源部分*

```
- (GMGridViewCell *)GMGridView:(GMGridView *)gridView cellForItemAtIndex:(NSInteger)index
{
    CGSize size = [self GMGridView:gridView sizeForItemsInInterfaceOrientation:[[UIApplication sharedApplication] statusBarOrientation]];

    GMGridViewCell *cell = [gridView dequeueReusableCell];    
    if (!cell) {

        cell = [[[GMGridViewCell alloc] initWithFrame:CGRectMake(0, 0, size.width, size.height)] autorelease];

        InternalView *view = [[[InternalView alloc] initWithFrame:CGRectMake(0, 0, size.width, size.height)] autorelease];
        cell.contentView = view;
    }

    return cell;
} 
```

当我使用 Zombie Objects 时，该应用程序运行良好。没有错误。但是当我禁用 Zombie Objects 时，应用程序会在方法中崩溃**EXC_BAD_ACCESS 。**`main`这对我来说很奇怪，因为如果启用了 Zombies，我会看到发生在`main`.

我不太确定的是`autorelease`代码中的调用，但我认为如果我不将对象放入自动释放池中，它们会泄漏。

```
GMGridView* gridView = [[[GMGridView alloc] initWithFrame:mainView.bounds] autorelease];

cell = [[[GMGridViewCell alloc] initWithFrame:CGRectMake(0, 0, size.width, size.height)] autorelease]; 
```

调查了一下，我发现如果我`[gmGridView release]`在`dealloc`方法中发表评论，应用程序就会停止崩溃。那么这是什么意思？如果我不打电话`release`，会`gmGridView`泄漏吗？

你有什么建议吗？先感谢您。

**编辑**

`- (GMGridViewCell *)GMGridView:(GMGridView *)gridView cellForItemAtIndex:(NSInteger)index`我在方法中添加了一些代码。第一次忘记加了

(of type )的`dealloc`方法似乎是问题的根源。这里是代码。`InternalView``UIView`

```
- (void)dealloc
{    
    [addButton release]; // it's added to self addSubview, it has also a retain policy
    [imageView release]; // it's added to detView addSubview, it has also a retain policy
    [detView release]; // it's added to self addSubview, it has also a retain policy

    [super dealloc];
} 
```

评论`[detView release]`，崩溃消失了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-31T22:54:34.173

Flex_Addicted,

从您的代码来看，我们正在查看 MRR 代码（即非 ARC）。如果是 ARC，则不能使用 [super dealloc]、-release 或 -autorelease。

那是你的意图吗？如果是这样，那么你有一个提前释放。我建议您将此类转换为 ARC。ARC 与静态分析器一起，会发现早期的释放问题并处理它们。

安德鲁

# jquery - 使用phonegap在Android本机应用程序上跳转文本

> ID：10813790
> 
> 赞同：0
> 
> 时间：2012-05-30T09:46:24.163
> 
> 标签：jquery, android, html, css, cordova

我正在使用 Phonegap 为 Android 构建一个应用程序，但存在一个小问题。当我浏览页面时，页面上的所有文本在大约 2 秒内上下移动（移动是几个像素，不多但很烦人）。我在滚动浏览时也遇到了问题（当我从屏幕上松开手指时）。

我为我的应用程序使用 iScroll 和 jQuery（不是 jQuery mobile）。

我希望有人可以帮助我解决这个问题。

提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-30T10:14:38.897

在您的 .css 文件中使用它：

```
body 
{
-webkit-backface-visibility: hidden;
overflow: hidden;
} 
```

# solr - Solr 管理员什么也没显示（nutch）

> ID：10813792
> 
> 赞同：0
> 
> 时间：2012-05-30T09:46:25.770
> 
> 标签：solr, indexing, nutch, luke

我已经成功创建了一个 Solr 索引，它使用 nutch 抓取了几页。使用 Luke 查询索引我得到了预期的结果（默认字段“内容”）。但是，当我尝试使用 solr/admin 界面时，我使用 q= 得到所有内容*：*如预期的那样：

```
<response>
<lst name="responseHeader">
  <int name="status">0</int>
  <int name="QTime">0</int>
  <lst name="params">
    <str name="indent">on</str>
    <str name="start">0</str>
    <str name="q">*:*</str>
    <str name="version">2.2</str>
    <str name="rows">10</str>
  </lst>
</lst>
<result name="response" numFound="11" start="0">
  <doc>
    <float name="boost">1.0</float>
    <str name="content">
      'a lot of text...'
    </str>
    <str name="digest">f73dc90d5ab992f62ba3980de2312dfe</str>
    <str name="id">http://thenet.net/</str>
    <str name="segment">20120529084510</str>
    <str name="title">1 < 2 < 3</str>
    <date name="tstamp">2012-05-29T06:45:12.872Z</date>
    <str name="url">http://theurl.net</str>
  </doc> 
```

但在查询特定字符串时绝对没有：

```
<response>
  <lst name="responseHeader">
    <int name="status">0</int>
    <int name="QTime">0</int>
    <lst name="params">
      <str name="indent">on</str>
      <str name="start">0</str>
      <str name="q">java</str>
      <str name="version">2.2</str>
      <str name="rows">10</str>
    </lst>
  </lst>
  <result name="response" numFound="0" start="0"/>
</response> 
```

在 Solr 管理界面它说：

```
mro:8983
cwd=/$PATH_TO_SOLR_AND_NUTH_DIRS/solr/example SolrHome=solr/./ 
HTTP caching is OFF 
```

在 schema.xml 中，“内容”是默认搜索字段。

任何帮助都感激不尽！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-30T11:32:54.843

请检查 schema.xml 文件中内容字段的 fieldType。如果它设置为`string`then 这将解释为什么您没有获得特定文本值的任何查询结果。您应该使用 fieldType of`text_general`或类似的东西来获得更好的搜索结果，因为该 fieldType 将标记、过滤和阻止索引的值。请参考[Solr Wiki](http://wiki.apache.org/solr/)上的[分析器、标记器和标记过滤器](http://wiki.apache.org/solr/AnalyzersTokenizersTokenFilters)以获取更多信息。

# python - Python textwrap 并忽略部分字符串

> ID：10813793
> 
> 赞同：4
> 
> 时间：2012-05-30T09:46:28.487
> 
> 标签：python, string, word-wrap

这里完全是初学者编码器，首先在这个好地方发帖。使用 Python 3.2.3。

**简要说明**

我想对字符串进行自动换行和字符填充，但应该忽略字符串的某些部分。

**背景**

我正在使用一个从 .txt 文件输出文本但没有自动换行或换行符的程序。由于我至少目前无法编辑程序的功能，所以我唯一的选择是编辑文本文件。

该程序使用固定大小的等宽字体，所以我知道每个文件和行的特定字符数。我使用程序的硬空间命令 \_ 作为每个包装行的填充字符（最后一行除外）。hard-space 命令暂时转换为**#**以在我的脚本中保持正确的字符数。

这是我的文本编辑脚本的一个相当改变和简化的版本：

```
from textwrap import TextWrapper

linelist = ['"I thought that...\p glob was a weird\_name for a module."',
"Nobody can tell a secret from the \p\shake{1}sky unless they borrow wings \
from their neighbors. It's a pity, really. Life on the ground can be a bore.",
'\shake{6} The ground was trembling. What\wait{150} \pcould\wait{1300} the \
townfolk do? Even the pizzeria was closed.']

ww = TextWrapper(break_on_hyphens="False", width=30)

def space_wordwrap(wwl):
    out = []
    for ln in ww.wrap(wwl):
        out.append("{0:#<{1:d}}".format(ln, ww.width))
        #just a quick workaround for simpler print output for SO question
        if not ln in ww.wrap(wwl)[-1]:
            out[-1] += "\n"
    return ''.join(out).rstrip('#')

for line in linelist:
    #line = line.replace('\\_', '#')
    if len(line) > ww.width:
        line = space_wordwrap(line)
    #line = line.replace('#', '\\_')
    print(line + "\n") 
```

**问题**

文本文件中的许多行都包含程序的命令。这些命令不会被程序显示为文本，但它们的位置很重要......并且它们被放置在可显示文本周围的任何位置。这会抛出自动换行的字符数。

有 4 个命令：`\p \wait{100} \stop{200} \shake{1}`. 请参阅`linelist`示例。

脚本的输出是这样的：

```
"I thought that...\p glob was#
a weird\_name for a module."

Nobody can tell a secret from#
the \p\shake{1}sky unless they
borrow wings from their#######
neighbors. It's a pity,#######
really. Life on the ground can
be a bore.

\shake{6} The ground was######
trembling. What\wait{150}#####
\pcould\wait{1300} the########
townfolk do? Even the pizzeria
was closed. 
```

我想我必须从行中删除程序命令，然后在自动换行后将它们插入各自的位置，但我不确定最干净的方法是什么。

我最初的想法是找到前一个单词（如果有的话）并将其用作参考。我会检查是否使用了 \，在它之前找到一个没有后跟 \ 的空格，将前一个单词存储在一个列表中，然后在单词上插入一个订单号，以防万一线。

哇！结果证明这是一个相当冗长的描述。关于应该如何做的任何建议？另外，如果我的任何编码实践看起来很愚蠢，我很高兴知道。毕竟，这才刚刚开始。:-]

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-30T10:51:42.170

有很多方法可以做到这一点，但......

预处理文本，删除命令并记住它们的位置，作为从文本开头的字符偏移量。

然后做你的文字包装。

最后重新插入命令。您可能需要逐个字符地遍历最终文本，以便在计算命令字符位置时可以忽略 # 字符和 /n 和 /r。

一个可能足够好的近似解决方案是将命令替换为您知道不会出现在源文本中的占位符字符，例如 @、~、& 等，同时完成重新格式化，然后放入之后命令返回。输出不会被完美包裹，因为某些行的末尾可能有比必要更多的空格。

# oauth - PHP Oauth 内页 TAB

> ID：10813794
> 
> 赞同：0
> 
> 时间：2012-05-30T09:46:29.840
> 
> 标签：oauth, tabs, facebook-php-sdk

我的标签需要知道用户成为粉丝的日期，所以我必须请求权限。尽管有 facebook 官方文档，我还是成功了，用户被重定向到 oauth 对话框，在他确认后，返回选项卡。

```
$user = $facebook->getUser();
if ($user)
{
    $access_token = $facebook->getAccessToken();
    $user_profile = $facebook->api('/me');
    try
    {
        $likes = $facebook->api("/me/likes/pageid");
    }
    catch (FacebookApiException $e)
    {
        $user = null;
    }
}
else
{
    ?>
    <script type="text/javascript">
        var oauth_url = 'https://www.facebook.com/dialog/oauth/';
        oauth_url += '?client_id=<?=$app_id?>';
        oauth_url += '&redirect_uri=' + encodeURIComponent('https://www.facebook.com/<?=$pageid?>?sk=app_<?=$app_id?>');
        oauth_url += '&scope='
        window.top.location = oauth_url;
    </script>
    <?
    die();
} 
```

一切正常，但如果用户不接受对话框，我将无法解析错误响应。返回的网址是：

```
https://www.facebook.com/page?sk=app_appid&error_reason=user_denied&error=access_denied&error_description=The+user+denied+your+request.#_=_ 
```

但是选项卡内的 iframe 没有任何参数。

我能做些什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-30T10:44:09.883

您只能使用`app_data`URL 中的参数将数据传递到选项卡上的 iframe。您必须将不成功的登录尝试重定向到如下 URL：

`https://www.facebook.com/{your_page}?v=app_{app_id}&app_data={your_string}`

例如`https://www.facebook.com/{your_page}?v=app_{app_id}&app_data=login_failed`

仍然会出现`login_failed`在解码`signed_request`

# jquery - 选择行后，Telerik 网格禁用 onrowselected 事件

> ID：10813799
> 
> 赞同：0
> 
> 时间：2012-05-30T09:46:45.847
> 
> 标签：jquery, asp.net-mvc-3, telerik-grid

我`Html.Telerik().Grid`在我的 asp.net MVC 3 项目中使用，其中我有一个播种 searchResults 的网格（Telerik 网格），用户可以单击这些行以查看在新页面中打开的特定行的更多信息新窗户。我还使用 Jquery 来处理`onrowselected`事件，并且我正在向控制器发布帖子以获取详细信息。

**jQuery代码：**

```
 function onRowSelected(e) {
        var grid = $(this).data('tGrid');
       //populate criteria here

        $.ajax({
            type: "POST",
            contentType: "application/json; charset=utf-8",
            url: //"some url",
            data: //data to controller,
            dataType: "text json",
            success:
        function (data, textStatus) {
            if (data != "Success") {
                ShowError(data);
            }
            else {
                window.location.href = //"redirect";
            }
        }
        }

        }); 
```

我不希望用户选择页面上的任何其他内容，并希望他等到加载详细信息，即一旦他选择了一行，他就不能选择网格中的任何其他行。任何实现这一目标的方法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-30T17:32:08.940

我可以建议使用加载进度弹出窗口来阻止用户选择其他任何内容并指示某些操作正在幕后发生。

这是我之前使用过的一个插件[http://contextllc.com/tools/jQuery-showLoading](http://contextllc.com/tools/jQuery-showLoading)

包含插件脚本后，实现将相当简单：

```
function onRowSelected(e) {
    $('#someID').showLoading();  //To show the loading progress bar, someID could be the div that contains the grid.

    $.ajax({
        type: "POST",
        contentType: "application/json; charset=utf-8",
        url: //"some url",
        data: //data to controller,
        dataType: "text json",
        success:
            function (data, textStatus) {
                 $('#someID').hideLoading();  //To hide the loading progress bar
            }
    });
} 
```

编辑：

或者你可以尝试这样的事情，它会显示覆盖隐藏整个页面和屏幕中间的加载图片。

将以下样式添加到您的页面，您必须在 .loading-indicator 类的背景属性中找到图像并编辑路径：

```
<style type="text/css">
.loading-indicator {
    position: absolute; 
    height: 80px;
    width: 80px;
    left: 50%;
    top: 50%;
    z-index: 1001;
    background: url( '../images/loading.gif' );
    background-repeat: no-repeat;
    background-position: center center;
}

.loading-indicator-overlay {
    position: absolute; 
    width:100%;
    height: 100%;
    z-index: 1000;
    background-color: black;
    opacity: 0.6;
}
</style> 
```

添加 javascript 以显示和隐藏加载栏：

```
<script type="text/javascript">
function showLoadingBar() {
    $('#overlay').addClass('loading-indicator-overlay');
    $('#loadingbar').addClass('loading-indicator');
}

function hideLoadingBar() {
    $('#overlay').removeClass('loading-indicator-overlay');
    $('#loadingbar').removeClass('loading-indicator');
}
</script> 
```

将以下 div 标签添加到页面：

```
<body>
    <div id="overlay"></div>
    <div id="loadingbar"></div>
    ....
    ....
</body> 
```

现在您可以调用 showLoadingBar() 或 hideLoadingBar() 来阻止用户与页面交互，同时进行一些后台处理。您必须测试该 css 以确保它与主流浏览器兼容。

# javascript - 如何在 javascript 中调用实例化类的函数？

> ID：10813802
> 
> 赞同：3
> 
> 时间：2012-05-30T09:46:52.637
> 
> 标签：javascript, jquery, oop, namespaces, instantiation

说实话，我可以调用该函数，但只是以硬编码的方式。我不想对提交绑定我的 getData 函数进行硬编码，而是想通过参数调用该函数。请帮助我，如何做到这一点。

**谢谢。**

```
formhandler = new xForm.Main(); // new formhandler
formhandler.setForm(this.formid); // fn.setForm(string) // configure the container, which has the form elements, or the form itself
modal = new xModal.Main(); // new modal handler
modal.setModal(this.modalid); // set modal element
modal.showModal(); // show
modal.bindClose(".cancel"); // bind closing classes
modal.bindSubmit(".submit", formhandler, "getData"); // bind submit to call formhandler.getData() 
```

在 xModal.js

```
var xModal = xModal || {};

xModal.Main = function()
{
  var self = this;
  ...

this.bindSubmit = function(classname, a, b)
{
    this.closeclass = classname;
    $("#"+this.target).find(classname).click(function(){
        a.call(b); // edited after the original post, i forgot to replace the call's argument to b in the question excuse me for the inaccuracy
    });
} 
```

此函数应调用 xForm 中的 getData（这是 xForm 的片段）

```
var xForm = xForm || {};

xForm.Main = function()
{
var self = this;
this.target = "";
this.data = {};

...

this.getData = function()
{
    getSingleElements();
    getMultiElements();
    return returnData();
} 
```

* * *

**更新：**

我想我刚刚找到了一种方法来做到这一点，但请告诉我我是否做错了什么，或者你有一个更好的解决方案来解决这个问题（我很确定有人有）

我想，我有正确的方法。

在xForm中我做了一个fn，它通过参数调用函数包含在self中（实际上等于这个）

```
var xForm = xForm || {};

xForm.Main = function()
{
var self = this;

this.callFn = function(func)
{
    return self[func].call(this);
}

... 
```

然后我从另一个类（xModal）调用 fn

```
var xModal = xModal || {};

xModal.Main = function()
{
var self = this;
this.bindSubmit = function(classname, a, b)
{
    this.closeclass = classname;
    $("#"+this.target).find(classname).click(function(){
        a.callFn(b);
    });
} 
```

然后我只需要告诉 xModal 这个：

```
modal.bindSubmit(".submit", formhandler, "getData"); // bind submit to call formhandler.getData() 
```

所以现在模态类将调用 args[1] 的 args[2] 函数。还可以通过 apply 方法为调用 fn 提供更多参数。

对我很好，但我不知道，也许你可以帮助我做得更好。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-30T10:21:41.910

您将某个对象的方法名称绑定到提交事件：

```
modal.bindSubmit(".submit", formhandler, "getData"); 
```

但是您也想将参数传递给该方法。这不是 Javascript 的做法。相反，只需将匿名函数绑定到事件，然后在此匿名函数中随意调用该方法：

```
modal.bindSubmit(".submit", function(){
    formhandler.getData("My arguments");
}); 
```

您在我的示例中看到的是作为参数传递的匿名函数。在 Javascript 中，字符串或整数等值与函数之间没有区别。可以将函数分配给变量，并作为参数传递。

为了更清楚，你也可以这样写：

```
var eventHandler = function(){
    formhandler.getData("My arguments");
};

modal.bindSubmit(".submit", eventHandler); 
```

这被称为“第一类函数”，是“函数式编程”范式的一部分。

在事件处理函数内部，您仍然可以访问创建它的 scooe 中的变量，例如 formhandler 对象。这称为“关闭”。

阅读此内容。一开始它会让你大吃一惊，但它真的值得你花时间，因为它会让你看到更简单的解决方案。

从您的示例中，我不确定对象模式是什么。如果它是 jQuery 元素，我的示例应该可以立即运行，否则，您需要更新代码以调用作为事件处理程序传入的函数，而不是调用对象上的方法。

# c# - 在会话开始重定向时 - 推荐人是什么？

> ID：10813806
> 
> 赞同：2
> 
> 时间：2012-05-30T09:47:14.613
> 
> 标签：c#, asp.net, redirect, global-asax

我正在使用 global.asax 的 on_session_start() 方法来捕获移动用户代理并重定向到网站的移动版本。我的问题是：

在移动网站上，如果用户从 URL 请求 blahblah.com/directory1 重定向（记住我使用的是 on_session_start()） - 引荐来源是 blahblah.com 还是 blahblah.com/directory1？

谢谢

C

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-08T18:38:03.987

`on_session_start()` 推荐将是`null`。

# iphone - 如何将本地视频文件嵌入到 Html 中以在 UIWebView 中播放？

> ID：10813808
> 
> 赞同：5
> 
> 时间：2012-05-30T09:47:23.470
> 
> 标签：iphone, objective-c, ios, cocoa-touch, uiwebview

我可以在 WebView 中播放视频文件，但视频会自动播放而无需用户交互。所以现在我正在采用不同的方法来实现这一目标。

```
 NSString* embedHTML = @"\
        <html><head>\
        <style type=\"text/css\">\
        body {\
        background-color: transparent;\
        color: white;\
        }\
        </style>\
        </head><body style=\"margin:0\">\
        <embed id=\"yt\" src=\"http://www.businessfactors.de/bfcms/images/stories/videos/defaultscreenvideos.mp4\" type=\"application/x-shockwave-mp4\" \
        width=\"%0.0f\" height=\"%0.0f\"></embed>\
        </body></html>";

 _webView = [[UIWebView alloc] initWithFrame:CGRectMake(0.0, 0.0, 320.0, 412.0)];

    [_webView setOpaque:NO];
    NSString *html = [NSString stringWithFormat:embedHTML, _webView.frame.size.width, _webView.frame.size.height];
    [_webView loadHTMLString:html baseURL:nil]; 
```

这样，我可以播放来自互联网的视频文件。但我想播放本地内存中的文件。

即使尝试传递本地文件路径变量，视频也无法播放。谁能告诉我如何将我的本地文件嵌入到 html 中，以便我可以像互联网视频一样在 webview 中播放？

**案例 1：视频在 WebView 中自动播放，但播放按钮仍在顶部。案例2：如上图嵌入在线视频URL，可以播放视频。但我想传递本地视频文件路径而不是在线视频url**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-30T09:59:56.420

如果您使用 UIWebView，则无法从本地内存运行文件。如果您希望视频不自动播放，则必须在 HTML 文件中输入代码（我假设您显示的 HTML 文件是您自己的）以禁用视频的自动播放。

如果您使用的是对象，这里有一个示例代码供您遵循

```
<object width="160" height="144">
<param name="autoplay" value="false">

<embed src="sample.mov" width="160" height="144"
autoplay="false" controller="false"
</embed>

</object> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-30T12:35:14.480

如果您将 .mp4 或兼容的其他视频添加到您的应用程序包中，您可以像这样访问它的路径；

`[[NSBundle mainBundle] pathForResource:@"blalba" ofType:@"mp4"];`

它为您提供 url 字符串。

如果您的视频不在您的捆绑包中，无论是从捆绑包中复制还是从互联网下载，您都可以获得这样的目录；

```
NSString *documentdir = [NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES) lastObject];
NSString *tileDirectory = [documentdir stringByAppendingPathComponent:@"xxxx/Tiles"];
NSLog(@"Tile Directory: %@", tileDirectory); 
```

获取视频的 url 后，你可以把它放到你的 WebView 中。但我认为它会在 iphone 的默认视频播放器中播放.. 祝你好运..

# php - 从 OpenCart 中删除 index.php?route=common/home

> ID：10813809
> 
> 赞同：26
> 
> 时间：2012-05-30T09:47:29.387
> 
> 标签：php, seo, opencart

我目前`User SEO URL's`在 OpenCart Admin 中设置为 Yes。

`System -> Settings -> Store -> Server -> User SEO URL's`

到目前为止，所有标签和 SEO 链接都可以正常工作；该命令已达到预期效果。

但是对于主页和其他一些链接；如何删除：

> index.php?route=common/home

从网址？我是否必须在硬编码 PHP 文件中进行查找和替换并进行风险升级，还是有其他方法？

（没有臃肿的性能，即没有糟糕的业余工具，如 vQmod）

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2012-06-05T18:34:35.270

要简单地删除它，您可以在`/catalog/controller/common/seo_url.php`

寻找：

```
return $link; 
```

**在**新行之前放：

```
$link = str_replace('index.php?route=common/home', '', $link); 
```

由 TheBlackBenzKid 编辑：如果您想要完整的 SEO，只需使用此行而不是上面的行：

```
$link = str_replace('index.php?route=', '', $link); 
```

还要确保在商店的管理面板中打开了 SEO URL。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2013-08-09T03:24:03.713

我真的很喜欢上面 Victor Schröder 的解决方案，因为它很简单。谢谢！我根据他的代码模型创建了一个 vQmod，以防它对任何人都有帮助。这是代码：

```
<modification>

    <file name="system/library/url.php">
        <operation>
            <search position="before"><![CDATA[$url .= 'index.php?route=' . $route;]]></search>
            <add><![CDATA[
                if ('common/home' == $route) {
                    if ($args) {
                        $url .= '?' . str_replace('&', '&amp;', '&' . ltrim($args, '&'));
                    }
                } else {
            ]]></add>
        </operation>
        <operation>
            <search position="before"><![CDATA[foreach ($this->rewrite as $rewrite) {]]></search>
            <add><![CDATA[
                }
            ]]></add>
        </operation>
    </file>

    <file name="catalog/controller/common/seo_url.php">
        <operation>
            <search position="replace"><![CDATA[parse_str($url_info['query'], $data);]]></search>
            <add><![CDATA[
                if (isset($url_info['query'])) parse_str($url_info['query'], $data);
            ]]></add>
        </operation>
    </file>

</modification> 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2013-03-09T01:40:22.253

之前的“解决方案”是错误的，因为他们攻击的是 SEO URL **translate**。您想要的是处理OpenCart中的 URL**生成。**

让我们保持简单。去`/system/library/url.php`看看`public function link`。用这个版本替换函数：

```
public function link($route, $args = '', $connection = 'NONSSL') {
    if ('NONSSL' == $connection) {
        $url = $this->url;
    } else {
        $url = $this->ssl;  
    }

    if ('common/home' == $route) {
        if ($args) {
            $url .= '?' . str_replace('&', '&amp;', '&' . ltrim($args, '&')); 
        }
    } else {
        $url .= 'index.php?route=' . $route;
        if ($args) {
            $url .= str_replace('&', '&amp;', '&' . ltrim($args, '&')); 
        }
    }

    foreach ($this->rewrite as $rewrite) {
        $url = $rewrite->rewrite($url);
    }

    return $url;
} 
```

就这么简单。我无法相信为什么这不在 OpenCart 的核心中。

**编辑：**

我运行了一些测试，如果启用了 SEO URL，则有必要在其中进行一次编辑`/catalog/controller/common/seo_url.php`以避免“未定义索引”错误。

在里面`public function rewrite`，替换这一行：

```
parse_str($url_info['query'], $data); 
```

有了这个：

```
if (isset($url_info['query'])) parse_str($url_info['query'], $data); 
```

现在它确实有效。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2016-09-18T20:23:26.027

**步骤 01\. 在您的商店服务器设置中启用 USE SEO URL**

转到“系统”，然后单击“设置”。找到您要更改的商店，然后单击右侧的“编辑”链接。最后单击“服务器”选项卡并将 SEO URL 的单选设置为“是”并保存您的设置。

注意：不会自动为您创建关键字。您还必须打开 Apache mod_rewrite。默认情况下，大多数网络主机都会启用此功能。本教程的第 3 步将解释如何添加关键字。

**步骤 02\. 更改 .htaccess 文件中的一些内容以使您的主页 SEO URL 友好**

转到您的主机控制面板并编辑您的 .htaccess 文件。有时为了取消隐藏此文件是隐藏的，您可以单击您的网络主机控制面板文件管理器并勾选显示隐藏文件选项，然后单击“开始”按钮。

找到 .htaccess 文件后，更改以下行：

```
RewriteBase /
RewriteRule ^sitemap.xml$ index.php?route=feed/google_sitemap [L]
RewriteRule ^googlebase.xml$ index.php?route=feed/google_base [L]
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteCond %{REQUEST_URI} !.*\.(ico|gif|jpg|jpeg|png|js|css)
RewriteRule ^([^?]*) index.php?_route_=$1 [L,QSA] 
```

至：

```
RewriteBase /
RewriteRule ^sitemap.xml$ index.php?route=feed/google_sitemap [L]
RewriteRule ^googlebase.xml$ index.php?route=feed/google_base [L]
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteCond %{REQUEST_URI} !.*\.(ico|gif|jpg|jpeg|png|js|css)
RewriteRule ^([^?]*) index.php?_route_=$1 [L,QSA]
RewriteCond %{QUERY_STRING} ^route=common/home$
RewriteRule ^index\.php$ http://www.yourwebsite.co.uk? [R=301,L] 
```

如果您执行上面的步骤，您的主页将从如下所示：http: [//yourwebsite.com/index.php](http://yourwebsite.com/index.php?route=common/home) ?route=common/home 变为： http: [//yourwebsite.com](http://yourwebsite.com)

**步骤 03\. 手动输入 URL 的 SEO 关键字** 最后，您需要为要重写 URL 的每个页面、信息、产品和类别输入 SEO 关键字。编辑和创建项目时，您可以在数据选项卡下找到 SEO 关键字字段。

一旦您输入了 SEO 关键字，您的 URL 就会起作用。

一旦您遵循了所有这些说明，您就可以开始获得更高排名、增加流量和更多客户的好处。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-08-14T09:13:28.337

如何将徽标中的链接替换为`<?php echo $base; ?>`. 它将链接到基本域并删除`index.php?route=common/home`.

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2013-03-03T15:20:17.183

杰的解决方案对我不起作用，编辑后我得到空白屏幕。所以我做了一个新的：

把这行放在前面：

```
return $link; 
```

而不是之后：

```
public function rewrite($link) { 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2013-03-07T14:16:52.580

所以，我使用的是 1.5.5.1，没有一个关于这个问题的答案解决了我的问题。然而，结合[@Jay Gilford](https://stackoverflow.com/users/711273/jay-gilford)、[@TheBlackBenzKid](https://stackoverflow.com/users/596952/theblackbenzkid)和[@rkaartikeyen](https://stackoverflow.com/users/707852/rkaartikeyan)的答案，我想出了一个完全可行的解决方案。

[请记住启用@TheBlackBenzKid](https://stackoverflow.com/users/596952/theblackbenzkid)所示的 seo 网址。

可以在代码下方找到解释。

```
[php]
类 ControllerCommonSeoUrl 扩展控制器 {
    公共函数索引（）{
        // 添加重写到 url 类
        if ($this->config->get('config_seo_url')) {
            $this->url->addRewrite($this);
        }

        // 解码网址
        if (isset($this->request->get['_route_'])) {
            $parts = explode('/', $this->request->get['_route_']);

            foreach ($parts 作为 $part) {
                $query = $this->db->query("SELECT * FROM " . DB_PREFIX . "url_alias WHERE 关键字 = '" . $this->db->e​​scape($part) . "'");

                if ($query->num_rows) {
                    $url = explode('=', $query->row['query']);

                    if ($url[0] == 'product_id') {
                        $this->request->get['product_id'] = $url[1];
                    }

                    if ($url[0] == 'category_id') {
                        if (!isset($this->request->get['path'])) {
                            $this->request->get['path'] = $url[1];
                        } 别的 {
                            $this->request->get['path'] .= '_' 。$url[1];
                        }
                    }   

                    if ($url[0] == 'manufacturer_id') {
                        $this->request->get['manufacturer_id'] = $url[1];
                    }

                    if ($url[0] == 'information_id') {
                        $this->request->get['information_id'] = $url[1];
                    }   
                } 别的 {
                    $this->request->get['route'] = 'error/not_found';   
                }
            }

            if (isset($this->request->get['product_id'])) {
                $this->request->get['route'] = 'product/product';
            } elseif (isset($this->request->get['path'])) {
                $this->request->get['route'] = 'product/category';
            } elseif (isset($this->request->get['manufacturer_id'])) {
                $this->request->get['route'] = 'product/manufacturer/info';
            } elseif (isset($this->request->get['information_id'])) {
                $this->request->get['route'] = '信息/信息';
            }别的 {
                $this->request->get['route'] = $this->request->get['_route_'];
            }

            if (isset($this->request->get['route'])) {
                返回 $this->forward($this->request->get['route']);
            }
        }
    }

    公共函数重写（$链接）{
        $url_info = parse_url(str_replace('&', '&', $link));

        $url = '';

        $数据 = 数组（）；

        parse_str($url_info['query'], $data);

        foreach ($data as $key => $value) {
            if (isset($data['route'])) {
                if (($data['route'] == 'product/product' && $key == 'product_id') || (($data['route'] == 'product/manufacturer/info' || $data ['route'] == 'product/product') && $key == 'manufacturer_id') || ($data['route'] == '信息/信息' && $key == 'information_id')) {
                    $query = $this->db->query("SELECT * FROM " . DB_PREFIX . "url_alias WHERE `query` = '" . $this->db->e​​scape($key . '=' . (int)$价值） 。 ”'”）;

                    if ($query->num_rows) {
                        $url .= '/' 。$query->row['keyword'];

                        未设置（$data[$key]）；
                    }                   
                } elseif ($key == '路径') {
                    $categories = explode('_', $value);

                    foreach ($categories as $category) {
                        $query = $this->db->query("SELECT * FROM " . DB_PREFIX . "url_alias WHERE `query` = 'category_id=" . (int)$category . "'");

                        if ($query->num_rows) {
                            $url .= '/' 。$query->row['keyword'];
                        }                           
                    }

                    未设置（$data[$key]）；
                }
            }
        }

        如果（$url）{
            未设置（$data['route']）；

            $查询 = '';

            如果（$数据）{
                foreach ($data as $key => $value) {
                    $查询 .= '&' 。$键。'=' 。$价值;
                }

                如果（$查询）{
                    $查询 = '?' . 修剪（$查询，'&'）；
                }
            }

            返回 $url_info['scheme'] 。'://' 。$url_info['host'] 。(isset($url_info['port']) ? ':' . $url_info['port'] : '') 。str_replace('/index.php', '', $url_info['path']) 。$网址。$查询；
        } 别的 {
            $link = str_replace('index.php?route=', '', $link);
            返回$链接；
        }
    }   
}

```

显然，[@Jay Gilford](https://stackoverflow.com/users/711273/jay-gilford)和[@TheBlackBenzKid](https://stackoverflow.com/users/596952/theblackbenzkid)解决了在页面上正确写入 url 的问题。

```
113 号线

$link = str_replace('index.php?route=', '', $link);

```

但它似乎破坏了 url，因为控制器找不到页面，因此恢复到错误页面。

```
38 - 40 号线

} 别的 {
    $this->request->get['route'] = 'error/not_found';   
}

```

[@rkaartikeyen 的](https://stackoverflow.com/users/707852/rkaartikeyan)解决方案通过将当前路由设置为请求的路由来解决这个问题

```
51 - 53 号线

别的 {
    $this->request->get['route'] = $this->request->get['_route_'];
}

```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2015-07-05T14:26:06.533

我来晚了，但我的解决方案可能对其他人有用（在 Opencart 2.0.3.1 上测试）：

打开您的 MySQL 控制台并运行此查询（使用您的数据库名称更改 YOURDATABASE）：

```
INSERT INTO `YOURDATABASE`.`url_alias` (`url_alias_id`, `query`, `keyword`) VALUES (NULL, 'common/home', ' '); 
```

这个怎么运作：

诀窍在于为“关键字”列添加一个空格（''），如果您插入一个空字符串（''），则此解决方法不起作用，并且 url 重写器将再次返回 index.php?route=common/家。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2020-05-09T23:29:32.657

对我来说，最简单的方法是：

1-去`/system/library/url.php`

2- 定位`function link(`

3-上面`return $url;`放了以下行：

```
$url = str_replace('index.php?route=common/home', '', $url); 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2020-08-26T20:39:06.110

# OpenCart 3.x

首先在您网站的根文件夹中将**htaccess.txt**重命名为**.htaccess**。

然后转到***系统 > 设置 > 您的商店***。编辑。打开选项卡***Server***并将**Use SEO URLs**设置为***Yes***。

现在打开***目录/控制器/启动/seo_url.php***

寻找`} elseif ($key == 'path') {`

之前添加

```
} elseif ($key == 'route') {
  $query = $this->db->query("SELECT * FROM " . DB_PREFIX . "seo_url WHERE `query` = '" . $this->db->escape($value) . "' AND store_id = '" . (int)$this->config->get('config_store_id') . "' AND language_id = '" . (int)$this->config->get('config_language_id') . "'");

  if ($query->num_rows && $query->row['keyword']) {
    $url .= '/' . $query->row['keyword'];
    unset($data[$key]);
  } else if ($data['route'] == "common/home") { 
    $url .= '/'; 
  } 
```

现在`/index.php?route=common/home`变成了`/`

现在您可以使用**account/login**或**information/contact等结构在*****Design > SEO URL***中设置 SEO URL 。

 ***** * *

## 回答 #11

> 赞同：0
> 
> 时间：2014-02-16T21:12:33.207

在文件 \system\library\response.php 中，在公共函数 output() 的开头添加下一行

```
if (!defined('HTTP_CATALOG')) $this->output = str_replace(array('index.php?route=common/home', '?route=common/home'), '', $this->output); 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2014-01-02T14:03:02.283

我得到了这个[http://www.antropy.co.uk/index.php/blog/one-quick-opencart-seo-tip-to-avoid-a-duplicate-home-page/](http://www.antropy.co.uk/index.php/blog/one-quick-opencart-seo-tip-to-avoid-a-duplicate-home-page/)为我删除了代码我的主页

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2012-11-18T21:52:46.093

/catalog/controller/common/seo_url.php

打开文件并替换下面的代码

```
<?php
class ControllerCommonSeoUrl extends Controller {
    public function index() {
        // Add rewrite to url class
        if ($this->config->get('config_seo_url')) {
            $this->url->addRewrite($this);
        }

        // Decode URL
        if (isset($this->request->get['_route_'])) {
            $parts = explode('/', $this->request->get['_route_']);

            foreach ($parts as $part) {

                $query = $this->db->query("SELECT * FROM " . DB_PREFIX . "url_alias WHERE keyword = '" . $this->db->escape($part) . "'");

                if ($query->num_rows) {
                    $url = explode('=', $query->row['query']);

                    if ($url[0] == 'product_id') {
                        $this->request->get['product_id'] = $url[1];
                    }

                    if ($url[0] == 'category_id') {
                        if (!isset($this->request->get['path'])) {
                            $this->request->get['path'] = $url[1];
                        } else {
                            $this->request->get['path'] .= '_' . $url[1];
                        }
                    }   

                    if ($url[0] == 'manufacturer_id') {
                        $this->request->get['manufacturer_id'] = $url[1];
                    }

                    if ($url[0] == 'information_id') {
                        $this->request->get['information_id'] = $url[1];
                    }   
                } else {
                    $this->request->get['route'] = 'error/not_found';   
                }
            }

            if (isset($this->request->get['product_id'])) {
                $this->request->get['route'] = 'product/product';
            } elseif (isset($this->request->get['path'])) {
                $this->request->get['route'] = 'product/category';
            } elseif (isset($this->request->get['manufacturer_id'])) {
                $this->request->get['route'] = 'product/manufacturer/info';
            } elseif (isset($this->request->get['information_id'])) {
                $this->request->get['route'] = 'information/information';
            }else {
                $this->request->get['route'] = $this->request->get['_route_'];
            }

            if (isset($this->request->get['route'])) {
                return $this->forward($this->request->get['route']);
            }
        }
    }

    public function rewrite($link) {
        if ($this->config->get('config_seo_url')) {
            $url_data = parse_url(str_replace('&amp;', '&', $link));
            $url = ''; 

            $data = array();

            parse_str($url_data['query'], $data);
            foreach ($data as $key => $value) {

                if (isset($data['route'])) {
                    if (($data['route'] == 'product/product' && $key == 'product_id') || (($data['route'] == 'product/manufacturer/info' || $data['route'] == 'product/product') && $key == 'manufacturer_id') || ($data['route'] == 'information/information' && $key == 'information_id')) {
                        $query = $this->db->query("SELECT * FROM " . DB_PREFIX . "url_alias WHERE `query` = '" . $this->db->escape($key . '=' . (int)$value) . "'");

                        if ($query->num_rows) {
                            $url .= '/' . $query->row['keyword'];

                            unset($data[$key]);
                        }                   
                    } elseif ($key == 'path') {
                        $categories = explode('_', $value);

                        foreach ($categories as $category) {
                            $query = $this->db->query("SELECT * FROM " . DB_PREFIX . "url_alias WHERE `query` = 'category_id=" . (int)$category . "'");

                            if ($query->num_rows) {
                                $url .= '/' . $query->row['keyword'];
                            }                           
                        }

                        unset($data[$key]);
                    }else {
                        $url .= '/'.$value;
                    }
                }
            }

            if ($url) {
                unset($data['route']);

                $query = '';

                if ($data) {
                    foreach ($data as $key => $value) {
                        $query .= '&' . $key . '=' . $value;
                    }

                    if ($query) {
                        $query = '?' . trim($query, '&');
                    }
                }

                return $url_data['scheme'] . '://' . $url_data['host'] . (isset($url_data['port']) ? ':' . $url_data['port'] : '') . str_replace('/index.php', '', $url_data['path']) . $url . $query;
            } else {
                return $link;
            }
        } else {
            return $link;
        }       
    }   
}
?> 
```

*------------------*改变的地方*--------------------------*

我在公共函数 index() 中添加的以下行也重写了公共函数。

```
else {
this->request->get['route'] = $this->request->get['_route_'];
} 
```

index() 函数执行如下

1.  从 htaccss "? *route* =$1" 获取查询（例如：url 看起来像 site.com/shirts）
2.  所以*路线*是衬衫
3.  现在该函数检查“衬衫”是否在 url_alias 表中找到，如果找到，那么它会从 url_alias 表中生成一个类似于 index.php?categoryID=Value 的变量。
4.  或者，如果 url_alias 表中没有衬衫的记录，那么它会检查它是否是其他一些页面，如信息或制造商，如果它发现它会生成一个获取变量示例 index.php?route=information/information 或 index.php?route =产品/制造商/信息。
5.  但它不检查它是否在布局中找到。所以我在 else 块中添加了将*路由*设置为 get 变量的代码，例如 index.php?route=< *route* >
6.  所以在 index() 函数中它的工作正常。就像我在重写函数中所做的一样。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2021-04-24T05:11:32.957

在 Opencart 3 中，如果你想重定向所有丑陋的 url，比如

```
index.php?route=common/home
index.php?route=account/register
index.php?route=product/product&path=244&product_id=481 
```

您需要将漂亮的网址添加到`Admin -> Design -> SEO Urls`类似于

[![在此处输入图像描述](../Images/55e37087e1abc13acc28bea20fc4a7bf.png)](https://i.stack.imgur.com/OsFeg.png)

然后执行以下操作： In `catalog/controller/startup/seo_url.php`, in function `index`, after

```
if ($this->config->get('config_seo_url')) {
   $this->url->addRewrite($this);
} 
```

添加这个

```
if (isset($this->request->get['route'])) {
    if (DOMAIN_ROOT . $this->request->server['REQUEST_URI'] != $this->rewrite(DOMAIN_ROOT . $this->request->server['REQUEST_URI'])) {
        $this->response->redirect($this->rewrite(DOMAIN_ROOT . $this->request->server['REQUEST_URI']));
    }
}
elseif (strpos($this->request->server['REQUEST_URI'], 'index') !== false) {
    $this->response->redirect(HTTPS_SERVER);
} 
```

添加最后一步是`DOMAIN_ROOT`在`config.php`with中定义

```
define('DOMAIN_ROOT', 'https://www.somedomain.org'); // no slash, no subfolder 
```

它对我来说效果很好

* * *

## 回答 #15

> 赞同：-1
> 
> 时间：2013-12-12T15:50:53.390

我为此创建了一个 VQMOD。在这里免费下载：[http ://www.opencart.com/index.php?route=extension/extension/info&extension_id=14683](http://www.opencart.com/index.php?route=extension/extension/info&extension_id=14683)

效果很好。

* * *

## 回答 #16

> 赞同：-1
> 
> 时间：2016-08-08T09:19:04.253

要从 url 中删除`index.php?route=`，我只是建议编辑`.htaccess`文件。

只需添加以下内容：

```
RewriteCond %{THE_REQUEST} \ /index\.php\?_route_=?([^&\ ]*)
RewriteRule ^ /%1? [L,R] 
```

我没有遇到任何问题。请记住，您需要启用**RewriteEngine 。**寻找这一行：`RewriteEngine On`。如果不存在，请在上面的代码之前过去。****

# jquery - fancybox v2 中的动态 facebook like 按钮

> ID：10813811
> 
> 赞同：0
> 
> 时间：2012-05-30T09:47:31.493
> 
> 标签：jquery, fancybox-2

fancybox v2 中的动态 facebook like 按钮

如何在图像标题后使用类似 fb 的按钮、tweet.G+按钮制作 fancybox v2，这是我的代码。我如何为每个图像制作不同的按钮。

```
$('.fancybox-buttons').fancybox({
    openEffect: 'none',
    closeEffect: 'none',
    prevEffect: 'none',
    nextEffect: 'none',
    playSpeed: 2500,
    arrows: false,
    nextClick: true,
    helpers: {
        thumbs: {
            width: 50,
            height: 50
        },
        buttons: {}
    },
    afterLoad: function ()
    {
        this.title = 'Image ' + (this.index + 1) + ' of ' + this.group.length + (this.title ? ' - ' + this.title : '');
    }
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-31T15:29:34.683

这不会完全回答您的问题，但请查看这篇文章以将 Facebook Like 按钮添加到您的 Fancybox。 [FancyBox 中未显示 Facebook 赞按钮？](https://stackoverflow.com/questions/10250402/facebook-like-button-not-displaying-in-fancybox)

您需要为您的幻想箱中的每个项目（照片？）提供自己的 URL。因此，如果您有照片，请确保每张照片都可以在[http://yourdomain.com/photo/photo_name_1](http://yourdomain.com/photo/photo_name_1)、[http://yourdomain.com/photo/photo_name_2](http://yourdomain.com/photo/photo_name_2)等 URL 上找到...

当您创建 facebook like 按钮时，请确保取消选择“发送按钮”，然后您可以选择 iFrame。将“URL to Like”设置为您网站的基本域，只是为了在创建按钮时创建一个占位符。你的 iFrame 最终会是这样的：

```
<iframe src="//www.facebook.com/plugins/like.php?href=http%3A%2F%2Fyourdomain.com%2F&amp;send=false&amp;layout=button_count&amp;width=450&amp;show_faces=true&amp;action=like&amp;colorscheme=light&amp;font=verdana&amp;height=21" scrolling="no" frameborder="0" style="border:none; overflow:hidden; width:450px; height:21px;" allowTransparency="true"></iframe> 
```

在 iFrame 中，您可以看到正在传回 Facebook 的链接。它以 http 开头，然后是冒号：(%3A) 和斜杠 /(%2F)。如果您想为每个图像添加一个单独的类似按钮，请在您的代码中（使用 PHP、Ruby、javascript 等）动态地将 url 的其余部分附加到您的按钮上，以创建类似这样的内容 ...http%3A%2F %2Fyourdomain.com%2Fphoto%2Fphoto_name_1

# sql - 在同一个表中获取行

> ID：10813813
> 
> 赞同：0
> 
> 时间：2012-05-30T09:47:38.940
> 
> 标签：sql, ruby-on-rails-3

我正在尝试获取表格中的行。

想象一下，我有两条记录（t1 和 t2）。我想获得在 t2.start_hour 和 t2.finish_hour 之间没有 t1.start_hour 的行。我基本上只想得到几个小时内与另一个没有冲突的事件。

这是表格：

```
create_table "occurrences", :force => true do |t|
    t.string   "start_hour"
    t.string   "finish_hour"
    t.date     "start_date"
    t.date     "finish_date"
    t.datetime "created_at",  :null => false
    t.datetime "updated_at",  :null => false
    t.integer  "activity_id"
  end 
```

这是我到目前为止提出的 SQL 查询：

```
Occurrence.find_by_sql("SELECT * FROM occurrences t1 INNER JOIN occurrences t2 ON (t1.start_hour NOT BETWEEN t2.start_hour and t2.finish_hour)") 
```

它给了我重复的结果。我无法删除它们并获得正确答案。

我在这里先向您的帮助表示感谢。

例子

输入

```
#<Occurrence id: 1, start_hour: "19:00", finish_hour: "20:20", start_date: "2012-05-30", finish_date: "2012-05-30", created_at: "2012-05-30 09:58:19", updated_at: "2012-05-30 09:58:19", activity_id: 1>, 

#<Occurrence id: 2, start_hour: "19:30", finish_hour: "20:10", start_date: "2012-05-30", finish_date: "2012-05-30", created_at: "2012-05-30 09:58:19", updated_at: "2012-05-30 09:58:19", activity_id: 2>,

#<Occurrence id: 3, start_hour: "22:00", finish_hour: "23:20", start_date: "2012-05-30", finish_date: "2012-05-30", created_at: "2012-05-30 09:58:20", updated_at: "2012-05-30 09:58:20", activity_id: 3> 
```

输出

```
#<Occurrence id: 1, start_hour: "19:00", finish_hour: "20:20", start_date: "2012-05-30", finish_date: "2012-05-30", created_at: "2012-05-30 09:58:19", updated_at: "2012-05-30 09:58:19", activity_id: 1>, 

#<Occurrence id: 3, start_hour: "22:00", finish_hour: "23:20", start_date: "2012-05-30", finish_date: "2012-05-30", created_at: "2012-05-30 09:58:20", updated_at: "2012-05-30 09:58:20", activity_id: 3> 
```

start_hour = 19:30 的记录不输出，因为在另一个记录的 19:00 和 20:20 之间。

编辑：

我得到了解决方案：

```
Occurrence.find_by_sql("SELECT start_hour FROM occurrences WHERE start_hour NOT IN (SELECT t2.start_hour FROM occurrences t1 INNER JOIN occurrences t2 ON ((t1.activity_id <> t2.activity_id AND t2.start_hour BETWEEN t1.start_hour and t1.finish_hour)))") 
```

谢谢您的帮助

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-30T10:13:28.597

未经测试（从内存中），您需要排除记录本身-> t1.activity_id <> t2.activity_id left join 否则您将无法获得没有右侧的好记录

需要对此进行测试：p

```
SELECT * FROM occurrences t1 
left JOIN occurrences t2 
ON (t1.activity_id <> t2.activity_id and t1.start_hour BETWEEN t2.start_hour and t2.finish_hour)
where t2.activity_id is null 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-30T10:01:06.430

假设表中有3条记录。（我用整数代替数据时间，因为这会更容易）

```
 id     start    end
   1      1        3
   2      4        5
   3      7        9 
```

当我试图找到开始不在开始和结束之间的行时，比对于 id =1 第一行都为真并且会出现结果。同样，对于 id =2 (start=4) 的行，两行都符合条件（使第三行出现两次结果）第三行也会发生同样的情况，你最终会得到六行。

它不是很清楚您要在这里实现什么，但是放置 distinct 将删除重复项。

编辑：您可能会考虑将内部连接放在开始和结束日期。

# macos - 静态链接 glib2

> ID：10813814
> 
> 赞同：0
> 
> 时间：2012-05-30T09:47:40.030
> 
> 标签：macos, dependencies, static-linking, glib

有没有办法将 glib2 静态链接到我的二进制文件？我在 Mac OS X Lion 上。

如果不是，那么有人想如何开发一个可以安装在默认位置没有安装 glib 库或根本没有安装的系统中的应用程序？换句话说，使用 glib2 构建的二进制文件的分发仅适用于高级用户，他们知道热下载、构建和安装 glib！？“自由软件”精神在哪里？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-01T19:11:36.000

我不知道是否有任何方法可以静态链接 GLib，但 GIMP 和 GEdit（以及其他应用程序）提供“普通”Mac OS X 应用程序包以供下载，因此无需静态链接当然可以做到。[以下](http://git.gnome.org/browse/gedit/tree/osx/README)是有关 GEdit 如何执行此操作的说明。

# ruby - 用于 HTTPS 请求的 Socksify 和 SSL

> ID：10813815
> 
> 赞同：3
> 
> 时间：2012-05-30T09:47:39.817
> 
> 标签：ruby, sockets, ssl, socks

对于一个项目，我需要通过 Socks5 代理进行 HTTPS 调用，以便我可以访问客户的远程 API。我使用的原始代码是这样的：

```
url = "/proxyValidate?service=#{migration_station_verification_url}&ticket=#{service_ticket}"

if Rails.env == 'development'
  uri = URI.parse(soe_cas_url + url)
  Net::HTTP.SOCKSProxy('127.0.0.1', 1080).start(uri.host, uri.port) do |http|
    res = http.get(uri.path)
    doc = Nokogiri::XML(res)
    doc.remove_namespaces!
    doc.xpath('//sessionId').first.content
  end
else
  http = Net::HTTP.new(soe_cas_url)
  http.use_ssl = true
  req = Net::HTTP::Get.new(url)
  res = http.request(req)
  doc = Nokogiri::XML(res)
  doc.remove_namespaces!
  doc.xpath('//sessionId').first.content
end 
```

目标是仅在开发环境中使用代理。当我使用代理拨打电话时，我收到错误消息：

**错误的状态行：“<!DOCTYPE**

谷歌搜索这表明我需要将**use_ssl**标志设置为 true，这在开发周期之外工作。使用 socksify 时没有这样的机制。如果我在 do 块内调用它，我会收到会话已启动的错误。在块外调用它会返回一个异常，即不存在这样的函数。

谁能告诉我如何通过 socksify 代理运行 SSL/HTTPS？

**编辑：**

我目前正在使用纯套接字来获得我想要的东西，使用以下代码：

```
 socket = Socket::TCPSocket.open('127.0.0.1', 1080)

  ssl_context = OpenSSL::SSL::SSLContext.new
  ssl_context.verify_mode = OpenSSL::SSL::VERIFY_NONE
  ssl_context.ca_file = File.join(Rails.root, 'ssl', 'cacert.pem')

  ssl_socket = OpenSSL::SSL::SSLSocket.new(socket, ssl_context)
  ssl_socket.sync_close = true
  ssl_socket.connect

  request = "GET #{url} HTTP/1.1\r\nAccept: */*\r\nHost: #{soe_cas_url}"
  ssl_socket.puts(request)
  ssl_socket.puts("")

  response = ""
  while (line = ssl_socket.gets)
    response << line
  end 
```

然而，这在**ssl_socket.connect**失败并出现以下错误：

**ssl_connect 系统调用返回=5 errno=0 状态=sslv2/v3 读取服务器你好 a**

我试过使用自签名证书，没有证书等，但似乎没有任何效果。我知道端点依赖于 staging environmnet 上的自签名证书。

# performance - 从性能的角度来看，创建 CloudStorageAccount 或 CloudBlobClient 实例的成本是多少？

> ID：10813816
> 
> 赞同：24
> 
> 时间：2012-05-30T09:47:43.217
> 
> 标签：performance, azure

每次我想从存储中获取 blob 时，是否应该创建 CloudStorageAccount 和 CloudBlobClient 实例？例如，我实现了用于处理 blob 存储的自定义虚拟路径提供程序。最佳设计解决方案是什么：创建 CloudStorageAccount 和 CloudBlobClient 实例一次作为我的自定义虚拟路径提供程序的私有字段，或者使用具有静态（共享）方法的实用程序，每次我想从贮存？从性能的角度来看它有多贵？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-05-30T10:22:58.883

您可以重用 CloudStorageAccount 和 CloudBlobClient，因为它们没有任何状态（请参阅 Steve Marx 在 Simon 的链接中的回复）。SDK 是开源的，您可以简单地[查看 GitHub 上的源代码](https://github.com/WindowsAzure/azure-sdk-for-net/)。

如果您查看 CloudStorageAccount 类，您会发现它的主要目的是确保您最终获得带有 Blob/Queue 和 TableEndpoint 的 StorageCredentials。查看 CloudBlobClient 的构造函数，您可以看到它存储了存储凭据、端点 Uri 和一些默认值。

这里没有任何复杂的东西，也没有任何网络 I/O，这意味着处理非常便宜。但是当您考虑性能时，每一个小优化都会有所帮助，因此您可以安全地将其存储在静态变量中（这可能会影响您的单元测试），或者如果您使用 IoC 容器，您可以选择对整个容器使用单个实例。

现在你需要考虑一些事情。您的 CloudStorageAccount 和 CloudBlobClient 都将保存存储凭据和端点 Uri。但是，如果您通过门户更改此信息（您可能更改了存储帐户的密钥）怎么办？如果您存储 CloudStorageAccount/CloudBlobClient 的单个实例，您可能需要处理[RoleEnvironment.Changing](http://msdn.microsoft.com/en-us/library/microsoft.windowsazure.serviceruntime.roleenvironment.changing.aspx)事件以使用新的存储帐户信息“刷新”这些对象。

# matlab - 通过对行和列的谓词生成布尔矩阵

> ID：10813825
> 
> 赞同：4
> 
> 时间：2012-05-30T09:48:13.030
> 
> 标签：matlab, matrix, octave

我有以下向量：

```
y = [1; 3; 2; 3; 1]; 
```

它的所有值都介于`1`和`n`（在本例中为`3`）之间，表示不同的选项。

我想创建一个大小为`size(y, 1)`x的矩阵，`n`其行对应于`y`值：

```
1 0 0 % because y(1) = 1
0 0 1 % because y(2) = 3
0 1 0 % because y(3) = 2
0 0 1
1 0 0 
```

一种方法是

```
Y = zeros(size(y, 1), num_labels);
for i = 1:m
    Y(i, y(i)) = 1;
end 
```

有没有更好的方法来做到这一点，也许在一个表达式中？
基本上，我需要的是生成一个带有 boolean predicate 的矩阵`(i, j) => j == y(i)`。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-30T10:17:52.777

如果`a`是列向量，你可以试试这个

```
a =  [1; 3; 2; 3; 1];

bsxfun(@eq, a, [1:max(a)]) 
```

如果它是一个行向量

```
a =  [1; 3; 2; 3; 1]';

bsxfun(@eq, a', [1:max(a)]) 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-05-30T12:03:31.167

如果您有权访问 Statistics Toolbox，该命令将`dummyvar`完全满足您的需求。

```
>> y = [1; 3; 2; 3; 1];
>> dummyvar(y)
ans =
     1     0     0
     0     0     1
     0     1     0
     0     0     1
     1     0     0 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-30T10:02:14.100

您可以[`sub2ind`](http://www.mathworks.com/help/techdoc/ref/sub2ind.html)在初始化矩阵后使用如下：

```
y = [1; 3; 2; 3; 1];
m = length(y);
n = max(y);

Y = zeros(m, n);
Y(sub2ind(size(Y), 1:m, y')) = 1

Y =

     1     0     0
     0     0     1
     0     1     0
     0     0     1
     1     0     0 
```

这里的技巧是要知道相应的行`y`从一个`1`到`m`一个。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-05-30T13:29:43.300

```
accumarray([(1:length(y)).' y], 1) 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-05-31T01:25:27.410

正如 Dmitri Bouianov 在 Coursera 讨论论坛上所建议的，这也有效：

```
Y = eye(num_labels)(y, :); 
```

此解决方案使用 to 的元素`y`作为索引从单位矩阵中选择行。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-03-16T14:18:49.103

在 Octave 中（至少从 3.6.3 开始，不确定何时引入），您可以使用广播非常轻松地做到这一点。它是这样工作的：

```
Y = y==1:3 
```

（如果 y 是行矩阵，则需要先转置它 - 如果您想转置 Y，请使用 y==(1:3)'）

# iphone - NSSortDescriptor 对多关系

> ID：10813826
> 
> 赞同：0
> 
> 时间：2012-05-30T09:48:14.400
> 
> 标签：iphone, objective-c, one-to-many, nssortdescriptor

我使用核心数据数据库。我有实体专辑，它有很多实体SpecificImage（获取这些图像的关键是@“specificImages”）我想获得id = 1的专辑并按id对附加的SpecificImages进行排序。我试过了

```
NSSortDescriptor *sortDescriptor = [NSSortDescriptor sortDescriptorWithKey:@"specificImages.id" ascending:YES]; 
```

但我得到了错误

> 由于未捕获的异常“NSInvalidArgumentException”而终止应用程序，原因：“此处不允许多对多键”

这是我的代码：

```
 NSString *entityName = kEntityName;
    AppDelegate *appDelegate = [[UIApplication sharedApplication] delegate];;
    NSManagedObjectContext *context = appDelegate.managedObjectContext;
    NSEntityDescription *entityDesctiption = [NSEntityDescription 
                                              entityForName: entityName
                                              inManagedObjectContext:context];

    // find object
    NSPredicate *predicate = [NSPredicate predicateWithFormat:@"id == %d", CurrentCategoryItemID];
    NSFetchRequest *request = [[NSFetchRequest alloc] init];
    NSSortDescriptor *sortDescriptor = [NSSortDescriptor sortDescriptorWithKey:@"specificImages.id" ascending:YES];
    [request setSortDescriptors:[NSArray arrayWithObject:sortDescriptor]];
    [request setEntity:entityDesctiption];
    [request setPredicate:predicate];
    NSArray *objects = [context executeFetchRequest:request error:nil];
    [request release];
    if (objects == nil)
    {
        NSLog(@"there was an error");
        return;
    }
    else if ([objects count] == 0)
    {
        return;
    }
    NSManagedObject *object = [objects objectAtIndex:0]; 
```

当我尝试执行 NSArray *objects = [context executeFetchRequest:request error:nil]; 时，它会引发异常

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-09T06:15:38.110

我假设，如果您在 Album 中有很多 SpecificImages ，那么您还将从 SpecificImage 到 Album 存在反向关系（SpecificImage 中的 1 个 Album 对象）。

在这里，我首先找到所需专辑 id 的所有特定图像，而不是所有专辑，最后形成这些特定图像对象之一，我将取回专辑对象。

```
NSString *entityName = @"SpecificImage";
AppDelegate *appDelegate = [[UIApplication sharedApplication] delegate];;
NSManagedObjectContext *context = appDelegate.managedObjectContext;
NSEntityDescription *entityDesctiption = [NSEntityDescription 
                                          entityForName: entityName
                                          inManagedObjectContext:context];

// find object
NSPredicate *predicate = [NSPredicate predicateWithFormat:@"album.id == %d", CurrentCategoryItemID];
NSFetchRequest *request = [[NSFetchRequest alloc] init];
NSSortDescriptor *sortDescriptor = [NSSortDescriptor sortDescriptorWithKey:@"id" ascending:YES];
[request setSortDescriptors:[NSArray arrayWithObject:sortDescriptor]];
[request setEntity:entityDesctiption];
[request setPredicate:predicate];
NSArray *specificImagesArray = [context executeFetchRequest:request error:nil];
[request release];
if (objects == nil)
{
    NSLog(@"there was an error");
    return;
}
else if ([objects count] == 0)
{
    return;
}
Album *album = [(SpecificImage *)[specificImagesArray objectAtIndex:0] album]; 
```

specificImagesArray 是您要查找的 specificImages 数组，album 是您需要的 id = CurrentCategoryItemID 的相册。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-13T12:48:56.697

我认为，没有任何变体，如何做到这一点。我有这个问题。但是在执行 fetch 请求后，我必须按 id 对其进行排序。

# c# - 交换绑定源中的两个条目

> ID：10813835
> 
> 赞同：1
> 
> 时间：2012-05-30T09:48:38.533
> 
> 标签：c#, bindingsource

我有一个绑定源，它用作数据网格的数据源。绑定绑定源后，我试图交换绑定源的两行。

```
 object currentRow = dashBoardBindingSource[index];
                    object aboveRow = dashBoardBindingSource[index - 1];
                    dashBoardBindingSource[index] = aboveRow;
                    dashBoardBindingSource[index - 1] = currentRow; 
```

上面的代码给了我一个异常如下

```
Cannot set an object into this list. 
```

我正在使用以下代码将数据绑定到绑定源

```
OnlineOutageReport[] outageReports;
dashBoardBindingSource = new BindingSource();
            dashBoardBindingSource.DataSource = ToDataTable<OnlineOutageReport>(outageReports);

private static DataTable ToDataTable<T>(IList<T> data)
    {
        PropertyDescriptorCollection props =
            TypeDescriptor.GetProperties(typeof(T));
        DataTable table = new DataTable();
        for (int i = 0; i < props.Count; i++)
        {
            PropertyDescriptor prop = props[i];
            table.Columns.Add(prop.Name, Nullable.GetUnderlyingType(
        prop.PropertyType) ?? prop.PropertyType);

        }
        object[] values = new object[props.Count];
        foreach (T item in data)
        {
            for (int i = 0; i < values.Length; i++)
            {
                values[i] = props[i].GetValue(item);
            }
            table.Rows.Add(values);
        }
        return table;
    } 
```

任何人都有一个想法。谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2015-08-13T21:21:10.437

下面是我如何将 bindingSource 从 DataGridView 的一行移动到另一行。

```
 int index = this.KeyDataGridView.SelectedRows[0].Index;

            this.KeyDataGridView.ClearSelection();
            if (index == this.KeyDataGridView.Rows.Count - 1)
            {
                return;//can go down
            }
            var tempKey = this.keysBindingSource[index];
            this.keysBindingSource.RemoveAt(index);
            this.keysBindingSource.Insert(index + 1, tempKey); 
```

它可能只需要您使用 dataSource.Insert(index) 代替

# jquery - 为什么我的列表没有在 Jquery 中附加列表项？

> ID：10813837
> 
> 赞同：2
> 
> 时间：2012-05-30T09:48:44.643
> 
> 标签：jquery

在 jQuery 中，我有一个带有预制 css 类的简单脚本，但这里没有 css 格式。

[http://jsfiddle.net/nSscK/](http://jsfiddle.net/nSscK/)

我希望简单地向列表中添加更多字段。我将列表项存储在 taskItem 中并记录它以确保 html 是正确的。但是，我的清单上没有任何内容。

谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-30T09:52:53.567

您在添加之前忘记`clone`了元素。否则，您只需附加相同的元素。

```
$('#add').click(function(){
    var taskItem = $("#tasks ul li:first").clone();
    $('#tasks ul').append(taskItem);
    taskItem.find(':text').val("").focus();
    return false;
}); 
```

**演示：http:** [//jsfiddle.net/nSscK/3/](http://jsfiddle.net/nSscK/3/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-30T09:51:36.180

```
jQuery(function (){

    $('#add').click(function(){
        var taskItem = $("#tasks ul li:eq(0)").clone(true, true); // need to clone for new add
        $('#tasks ul').append(taskItem);
        taskItem.find(':input:text').val("");
        return false;
    });
}); 
```

[**演示**](http://jsfiddle.net/nSscK/9/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-30T09:53:14.993

你需要克隆它。

```
var taskItem = $("#tasks ul li").clone(); 
```

# c# - Visual Studio 安装程序的 version 属性中的字母数字值

> ID：10813838
> 
> 赞同：0
> 
> 时间：2012-05-30T09:48:47.263
> 
> 标签：c#, asp.net, installation

我们可以在 Visual Studio 的 Web 安装程序的版本属性中使用像 v2.1.0.xyx.1 这样的字母数字值吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-30T09:51:03.760

这是不可能的。

类[`Version`](http://msdn.microsoft.com/en-us/library/system.version.aspx)部分都输入为`int32`，所以你不能给它们一个字符串值。

# android - 在 SharedPreferences 中存储一个字符串数组

> ID：10813841
> 
> 赞同：9
> 
> 时间：2012-05-30T09:48:53.080
> 
> 标签：android, storage, sharedpreferences

我想知道是否可以在共享首选项中保存一个字符串数组，以某种方式，每次我们保存某个字符串时，我们都会将其存储在该数组中。

例如，我有一个带有特定 ID 的位置列表，我想将其标记为收藏。理想的情况是，拥有一个数组并在该数组中保存某个位置 ID（我们称之为 Location1），所以下次我想将一个新位置标记为收藏（我们称之为 Location2）时，我检索该数组（其中到目前为止包含 Location1) 并添加我要添加的这个新位置的 ID (Location2)。

Android 有存储原始对象的方法，但没有存储数组的方法。有什么想法可以做到这一点吗？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2012-05-30T09:55:09.190

这是可行的：[我只是在写博客](http://sherifandroid.blogspot.com/2012/05/string-arrays-and-object-arrays-in.html)：

***保存您的阵列***

```
//String array[]
//SharedPreferences prefs
Editor edit = prefs.edit();
edit.putInt("array_size", array.length);
for(int i=0;i<array.length; i++)
    edit.putString("array_" + i, array[i]);
edit.commit(); 
```

***检索您的阵列***

```
int size = prefs.getInt("array_size", 0);
array = new String[size];
for(int i=0; i<size; i++)
    prefs.getString("array_" + i, null); 
```

* * *

刚写的，可能有错别字。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2013-08-02T22:49:22.827

您可以使数组成为 JSON 数组，然后像这样存储它：

```
SharedPreferences settings = getSharedPreferences("SETTINGS KEY", 0);
SharedPreferences.Editor editor = settings.edit();

JSONArray jArray = new JSONArray();
try {
    jArray.put(id);
} catch (JSONException e) {
    e.printStackTrace();
}

editor.putString("jArray", jArray.toString());
editor.commit(); 
```

然后你可以得到这样的数组：

```
SharedPreferences settings = getSharedPreferences("SETTINGS KEY", 0);
try {
    JSONArray jArray = new JSONArray(settings.getString("jArray", ""));
} catch (JSONException e) {
    e.printStackTrace();
} 
```

只是我过去使用的替代解决方案

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-30T09:53:40.353

编写方法来读取和写入序列化数组。这应该不会太难。只需将字符串数组展平为您存储在首选项中的单个字符串。另一种选择是将数组转换为 XML 结构，然后将其存储在首选项中，但这可能是矫枉过正。

# ios - MKMapView 上有交通的道路

> ID：10813844
> 
> 赞同：2
> 
> 时间：2012-05-30T09:49:03.357
> 
> 标签：ios, mkmapview, traffic

我对 MKMapView 组件有疑问。我看到在原生的“地图”iOS 应用中，我们可以绘制不同点之间的道路，并显示这些道路的交通情况。好吧，这正是我想要为我的应用程序做的 :)

所以，我有两个问题：

1）首先，我如何在地图上绘制道路。我读了很多关于 MKOverlay 的东西，关于一些在 UIWebView 中使用 JavaScript 执行此操作的示例，但是最好的方法是什么？

2) 我如何知道某条特定道路上的交通情况？为了绘制绿色、橙色或红色的道路。

非常感谢 ！

问候，塞巴斯蒂安；）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-30T10:12:37.870

不幸的是，现在*iOS 5*`CLGeocoder`的课程只支持处理地址到地理位置的转换和反向。这意味着在您拥有的地理编码周围查找地址或找到您提供的地址的地理编码。无法访问道路图来创建路线（精确选择和绘制道路）以及控制确切位置的交通。您可以使用标准工具做的唯一事情是使用您自己的数据绘制覆盖图。*`MKMapView`*

 *为了达到您想要的结果，我会提供使用第三方资源，例如*Google Maps API*，并用于`UIWebView`呈现自定义地图。[谷歌地图 JavaScript API v3 TrafficLayer](https://developers.google.com/maps/documentation/javascript/layers#TrafficLayer)*

# .net - Informix .NET 连接字符串

> ID：10813847
> 
> 赞同：2
> 
> 时间：2012-05-30T09:49:13.383
> 
> 标签：.net, informix, provider

我正在尝试连接到 Informix DB 服务器 (v10)，并且正在使用 Informix Data Provider .NET 类库通过 .NET 应用程序建立连接并检索数据。

最初，我在本地机器上设置了一个 Informix 服务器来对这个库进行一些测试。有趣的是，有两种情况，一种连接字符串有效，另一种无效。

场景 1：服务器设置为通过协议 'drsoctcp' 连接，连接字符串如下：

```
connectionString="Server=my.server.com:9088; Database=mytestdb; User ID=user; Password=mypass; Persist Security Info=True; Authentication=Server;" 
```

以上工作，因为正在使用的协议是'drsoctcp'

场景 2：服务器设置为通过协议“onsoctcp”进行连接，连接字符串与上面完全相同。连接将不起作用，抛出的错误是：

> 错误 [08001] [IBM] SQL30081N 通信错误或已检测到。正在使用的通信协议：“TCP/IP”。正在使用的通信 API：“SOCKETS”。检测到错误的位置：“fe80::1:10 9:c212:ce44%10”。检测错误的通信功能：“recv”。协议特定错误代码：“ *”、“* ”、“0”。SQLSTATE=08001

“my.server.com”是我在 LAN 上识别的机器的名称。我还尝试使用 localhost 或 IP 地址（127.0.0.1 和外部 IP 地址），但仍然没有成功。

**真正的问题**在这里：我希望连接的 Informix 服务器（完全在不同的网络上）可供我通过 onsoctcp 协议进行连接。

有没有人设法通过 onsoctcp 协议与 .NET Informix 提供程序类连接？

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-30T09:52:10.317

你检查过 ConnectionStrings.com 吗？[在此页面上](http://connectionstrings.com/informix#p46)，他们使用以下`onsoctcp`选项：

> 数据库=myDataBase;主机=192.168.10.10;服务器=db_engine_tcp;服务=1492; 协议=onsoctcp；UID=myUsername；密码=myPassword；

# php - php sql请求给出0结果

> ID：10813851
> 
> 赞同：0
> 
> 时间：2012-05-30T09:49:31.157
> 
> 标签：php, sql, request

我有一个 sql 请求，它应该将 char 字符串从：“toto，tata，titi”爆炸到一个数组（“toto”，“tata”，“titi”）：

```
$q = $connexion->db->prepare("UPDATE thesaurus_fr SET synonymes_mots = CONCAT(synonymes_mots, ', ', :synonymes_racine) WHERE synonymes_racine = :synonymes_courant");
$syns=explode(",",$_POST['synsList']);
$syns=array_unique($syns);
foreach ($syns as $syn) {
$q->bindValue(":synonymes_racine", $_POST['word']);
$q->bindValue(":synonymes_courant", $syn);
$q->execute();

} 
```

目前，请求的每个部分似乎都有效。它没有崩溃，但我没有得到任何结果，我做错了什么？感谢帮助

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-30T12:50:48.587

检查表列大小。连接结果可能太长。

无论如何，您应该在每次执行后使用`print_r($connexion->db->errorInfo());`

[http://www.php.net/manual/es/pdo.errorinfo.php](http://www.php.net/manual/es/pdo.errorinfo.php)

# javascript - 接受选项对象作为参数的简洁方法，回退到省略属性的默认值

> ID：10813852
> 
> 赞同：0
> 
> 时间：2012-05-30T09:49:32.703
> 
> 标签：javascript

我有一个函数，可以使用包含多个选项的可选对象调用，如果省略，每个选项都应回退到默认值。

我目前正在这样做：

```
function f(options){
    var _options = options || {};
    _options.propertyOne = options.propertyOne || 50;
    _options.propertyTwo = options.propertyOne || 100;
    _options.propertyThree = options.propertyThree || {};
    _options.propertyThree.subPropOne = options.propertyThree.subPropOne || 150;

    //etc...
}

var options = {
    propertyOne: 20,
    propertyThree: {
        subPropOne: 100
    }
}

f(options); 
```

然而，随着选项数量的增加，代码看起来越来越混乱。还有一个潜在的问题是错误/零值被忽略（尽管所有属性当前都是数字且非零）。

有没有更有效、更简洁的方法来实现这一目标？我考虑过在我的函数中创建一个初始化为默认值的对象，然后递归地将参数中提供的任何选项复制给它，但我不确定这样做是否会引入我还没有想到的新问题。

**编辑：**

我将用来递归复制属性的函数：

```
function copyOptions(from, to){
    for(var i in from){
        if(typeof from[i] == "object"){
            to[i] = copyOptions(from[i], to[i]);
        }else if(typeof from[i] != "undefined"){
            to[i] = from[i];
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-30T09:56:50.887

试试下面的：

```
function f(options){
    var _options = {
        propertyOne: 50,
        propertyTwo = 100,
        propertyThree: {
            subPropOne: 150
        }
    }

    if(options !== undefined){
        for(i in options){
            _options[i] = options[i];
        }
    }
} 
```

然后在函数内部，使用变量_options。您还需要扩展循环以查看 typeof options[i] 是否是一个对象，然后进入它等等。

# c++ - 编译opencv代码时遇到错误

> ID：10813853
> 
> 赞同：2
> 
> 时间：2012-05-30T09:49:33.123
> 
> 标签：c++, opencv

我正在使用 opencv 2.4，下面是我要编译的代码。我使用这个命令编译我的代码

```
g++ -o "match" -ggdb `pkg-config --cflags opencv` match.cpp `pkg-config --libs opencv` 
```

为什么我收到此错误：

```
match.cpp: In function ‘int main(int, const char**)’:
match.cpp:18:37: error: expected type-specifier before ‘SurfFeatureDetector’
match.cpp:18:37: error: conversion from ‘int*’ to non-scalar type ‘cv::Ptr<cv::FeatureDetector>’ requested
match.cpp:18:37: error: expected ‘,’ or ‘;’ before ‘SurfFeatureDetector’
match.cpp:22:2: error: ‘SurfDescriptorExtractor’ was not declared in this scope
match.cpp:22:26: error: expected ‘;’ before ‘extractor’
match.cpp:26:2: error: ‘extractor’ was not declared in this scope
match.cpp:29:2: error: ‘BruteForceMatcher’ was not declared in this scope
match.cpp:29:30: error: expected primary-expression before ‘&gt;’ token
match.cpp:29:32: error: ‘matcher’ was not declared in this scope 
```

我认为我使用的 opencv 版本存在一些问题，因为相同的代码在 2.2 版本上运行良好，但我不确定它是什么。帮助 ！！

```
#include <opencv/cv.h>
#include <opencv/highgui.h>
#include <string.h>
#include <iostream>

using namespace std;
using namespace cv;

int main(int argc, const char* argv[])
{
    cout << argv[1] << endl << argv[2] << endl;
    Mat img1 = imread(argv[1] , CV_LOAD_IMAGE_GRAYSCALE );
    Mat img2 = imread(argv[2] , CV_LOAD_IMAGE_GRAYSCALE );

    vector<KeyPoint> keypoints1;
    vector<KeyPoint> keypoints2;
    Ptr<FeatureDetector> feature = new SurfFeatureDetector(2500);
    feature->detect(img1,keypoints1);
    feature->detect(img2,keypoints2);

    SurfDescriptorExtractor extractor;

    Mat desc1 , desc2;

    extractor.compute(img1,keypoints1,desc1);
    extractor.compute(img2,keypoints2,desc2);

    BruteForceMatcher<L2<float> > matcher;

    vector<vector<DMatch> > matches1;
    vector<vector<DMatch> > matches2;
    vector<DMatch> symMatches;
    vector<DMatch> outMatches;

    matcher.knnMatch(desc1,desc2,matches1,2);
    matcher.knnMatch(desc2,desc1,matches2,2);

    int count_inliers = 0 , count_matches = 0;

    for(vector<vector<DMatch> >::const_iterator matIt1 = matches1.begin(); matIt1 != matches1.end(); ++matIt1){
        count_matches++;
        if(matIt1->size() < 2)
            continue;
        for(vector<vector<DMatch> >::const_iterator matIt2 = matches2.begin(); matIt2 != matches2.end(); ++matIt2){
            if(matIt2->size() < 2)
                continue;
            if((*matIt1)[0].queryIdx == (*matIt2)[0].trainIdx && (*matIt2)[0].queryIdx == (*matIt1)[0].trainIdx){
                count_inliers++;
                symMatches.push_back(DMatch((*matIt1)[0].queryIdx,(*matIt1)[0].trainIdx,(*matIt1)[0].distance));
                break;
            }
        }
    }

    vector<Point2f> points1, points2;

    for(vector<DMatch>::const_iterator it = symMatches.begin(); it!=symMatches.end(); ++it){
        float x = keypoints1[it->queryIdx].pt.x;
        float y = keypoints1[it->queryIdx].pt.y;
        points1.push_back(Point2f(x,y));

        x = keypoints2[it->trainIdx].pt.x;
        y = keypoints2[it->trainIdx].pt.y;
        points2.push_back(Point2f(x,y));
    }

    vector<uchar> inliers(points1.size(),0);

    Mat fundamental;
    fundamental = findFundamentalMat(Mat(points2),Mat(points1),inliers,CV_FM_RANSAC,2,0.8);

    vector<uchar>::const_iterator itIn = inliers.begin();
    vector<DMatch>::const_iterator itM = symMatches.begin();
    for(;itIn!=inliers.end();++itIn,++itM){
        if(*itIn){
            outMatches.push_back(*itM);
        }
    }
    cout << count_inliers << endl;
    cout << count_matches << endl;
    cout << (float) count_inliers/(float) count_matches << endl;

    float diff = (float) count_inliers/(float) count_matches;
//  if(diff > 0.30){
//      cout << "Similar Images " << endl << "-----------------" << endl;
//      exit(1);
//  }

//  vector<uchar> inliers(points1.size(),0);
    Mat homography = findHomography(Mat(points2),Mat(points1),inliers,CV_RANSAC,1);

    vector<Point2f>::const_iterator itPts = points1.begin();
//  vector<uchar>::const_iterator itIn = inliers.begin();
/*  while(itPts != points1.end()){
        if(*itIn)
            circle(img1,*itPts,3,Scalar(255,255,255),2);
        ++itPts;
        ++itIn;
    }
    itPts = points2.begin();
    itIn = inliers.begin();
    while(itPts != points2.end()){
        if(*itIn)
            circle(img2,*itPts,3,Scalar(255,255,255),2);
        ++itPts;
        ++itIn;
    }
*/

    Mat result;

    warpPerspective(img2,result,homography,Size(2*img2.cols,img2.rows));
    Mat half(result,Rect(0,0,img1.cols,img1.rows));

    img1.copyTo(half);

    // Add results to image and save.
    char name[1000];

//    strcpy(name,"./surf/surf");
//    strcat(name,argv[1]);

    cv::Mat output1;
    cv::Mat output2;
    cv::drawKeypoints(img1, keypoints1, output1);
    cv::drawKeypoints(img2, keypoints2, output2);
    cv::imwrite("./surf/img11.png", img1);
    cv::imwrite("./surf/img21.png", img2);
    cv::imwrite("./surf/img31.png", result);
    cv::imwrite("./surf/tt.png", result);
    cv::imwrite("./surf/img41.png", half);
    cv::imwrite("./surf/img51.png", output1);
    cv::imwrite("./surf/img61.png", output2);

    return 0;
} 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-09-20T07:56:32.393

现在`BruteForceMatcher`被称为

```
cv::BFMatcher 
```

请参阅[文档](http://docs.opencv.org/modules/features2d/doc/common_interfaces_of_descriptor_matchers.html#bfmatcher)。

你可以像这样定义一个匹配器：

```
DescriptorMatcher* hammingMatcher = new BFMatcher(NORM_HAMMING,false);
//or
DescriptorMatcher* hammingMatcher = new BFMatcher(NORM_L2,false); 
```

* * *

**编辑**

同样在此[示例](https://github.com/kikohs/freak/blob/master/demo/freak_demo.cpp)代码中，您可以通过包含标头来了解如何使用旧版本匹配器

```
#include "hammingseg.h" 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-06-09T11:01:31.500

阅读有关 SURF 和 SIFT 检测器的[讨论](http://tech.groups.yahoo.com/group/OpenCV/message/87559)- 它们已被移动为非免费的。

也作为动态库添加到链接`libopencv_nonfree.so`和`libopencv_features2d.so`.

因为`BruteForceMatcher`它看起来仍然是一个悬而未决的问题，但我很确定其中一个问题`.so`，我希望他们也改变了标题。如果你找到一些关于`BruteForceMatcher`我将不胜感激。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-08-27T22:13:40.880

包括以下内容

```
#"opencv2/features2d/features2d.hpp"
#"opencv2/highgui/highgui.hpp"
#"opencv2/core/core.hpp"
#"opencv2/legacy/legacy.hpp" (BruteForceMatcher is defined here!) 
```

并链接到以下内容

```
#opencv_core.so
#opencv_flann.soo (if youre using the FLANN matcher)
#opencv_highgui.so
#opencv_features2d.so
#opencv_nonfree.so 
```

似乎对我有用。希望这可以帮助。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-10-24T17:48:56.367

```
#include <opencv2/legacy/legacy.hpp> 
```

添加这一行，它将像以前一样工作。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-07T07:30:49.370

它真的很简单：

```
//matching descriptors
cv::BFMatcher matcher(cv::NORM_L2, true);
std::vector<cv::DMatch> matches;
matcher.match(descriptor1, descriptor2, matches); 
```

将标志设置为 true，您已经获得了交叉检查。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-05-30T10:28:15.570

看起来您需要包含 SurfFeatureDetector 的头文件

[这](http://www710.univ-lyon1.fr/~eguillou/documentation/opencv2/classcv_1_1_surf_feature_detector.html)是 API，他们在其中提到以下内容：

```
#include <features2d.hpp> 
```

不要将文件包含在整个路径中，而是仅包含名称并让编译器参数 (-I) 指定其路径。这更便携。

如果它没有在那里定义，那么寻找它。在 linux 中，您可以执行以下操作：

```
# find . -name "*.h*" | xargs grep SurfFeatureDetector | grep class
# find . -name "*.h*" | xargs grep BruteForceMatcher | grep class 
```

这应该得到所有 *.h 和 *.hpp 文件和 SurfFeatureDetector 的 grep 以及那些结果，类的 grep。

# c++ - 为什么这个 write() 操作只写一行

> ID：10813857
> 
> 赞同：-1
> 
> 时间：2012-05-30T09:49:47.703
> 
> 标签：c++, linux, file, csv, append

下面我的代码有一个小问题。我在课堂上从状态机中调用它`this->write_file(this->d_filename);`。循环中的案例被命中了几次，但是我想要生成的 CSV 文件中只有一行条目。

我不确定这是为什么。`this->open(filename)`我用我的写功能打开文件。它返回文件描述符。该文件使用 O_TRUNK 打开，并且`if ((d_new_fp = fdopen(fd, d_is_binary ? "wba" : "w")) == NULL)`. 而 aba 指的是 write、binary 和 append。因此，我期望不止一条线。

fprintf 语句写入我的数据。它还有一个`\n`.

```
 fprintf(d_new_fp, "%s, %d %d\n", this->d_packet, this->d_lqi, this->d_lqi_sample_count); 
```

我根本无法弄清楚为什么我的文件没有增长。

最好的，马吕斯

```
 inline bool
    cogra_ieee_802_15_4_sink::open(const char *filename)
    {
      gruel::scoped_lock guard(d_mutex); // hold mutex for duration of this function

      // we use the open system call to get access to the O_LARGEFILE flag.
      int fd;
      if ((fd = ::open(filename, O_WRONLY | O_CREAT | O_TRUNC | OUR_O_LARGEFILE,
          0664)) < 0)
        {
          perror(filename);
          return false;
        }

      if (d_new_fp)
        { // if we've already got a new one open, close it
          fclose(d_new_fp);
          d_new_fp = 0;
        }

      if ((d_new_fp = fdopen(fd, d_is_binary ? "wba" : "w")) == NULL)
        {
          perror(filename);
          ::close(fd);
        }

      d_updated = true;
      return d_new_fp != 0;
    }

    inline void
    cogra_ieee_802_15_4_sink::close()
    {
      gruel::scoped_lock guard(d_mutex); // hold mutex for duration of this function

      if (d_new_fp)
        {
          fclose(d_new_fp);
          d_new_fp = 0;
        }
      d_updated = true;
    }

    inline void
    cogra_ieee_802_15_4_sink::write_file(const char* filename)
    {
      if (this->open(filename))
        {

          fprintf(d_new_fp, "%s, %d %d\n", this->d_packet, this->d_lqi,
              this->d_lqi_sample_count);
          if (true)
            {
              fprintf(stderr, "Writing file %x\n", this->d_packet);
            }
        }
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-30T09:58:09.437

`O_TRUNC`从[man open](http://linux.die.net/man/2/open)的说明：

> 如果文件已经存在并且是常规文件并且打开​​模式允许写入（即 O_RDWR 或 O_WRONLY），它将被截断为长度 0。如果文件是 FIFO 或终端设备文件，则忽略 O_TRUNC 标志。否则，未指定 O_TRUNC 的效果。

该文件在每次调用时打开`write_file()`，删除之前写入的任何内容。替换`O_TRUNC`为`O_APPEND`。

# bash - 在执行 shell 脚本时，如何知道它正在执行的行号，

> ID：10813863
> 
> 赞同：15
> 
> 时间：2012-05-30T09:50:11.580
> 
> 标签：bash, shell

在执行 shell 脚本时，如何知道它正在执行的行号，确实编写了一个包装器，我可以在其中从 shell 脚本执行 shell 脚本并知道它正在执行的行号。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-05-30T11:22:15.400

您可以设置`PS4`变量以使`set -x`输出包含行号：

```
PS4=':${LINENO}+'
set -x 
```

这将在执行时将行号放在每行之前：

```
:4+command here
:5+other command 
```

`+`在变量扩展之后有一些符号字符（例如我的示例中的 a ）很重要`PS4`，因为最后一个字符会重复以显示嵌套深度。也就是说，如果您调用一个函数，并且该函数调用一个命令，则输出`set -x`将像这样报告它：

```
:3+++command run within a function called from a function
:8++command run within a function
:19+line after the function was called 
```

如果运行脚本涉及多个文件，您可能希望包含`BASH_SOURCE`变量而不是仅包含变量`LINENO`（假设这确实是一个 bash 脚本，而不是`/bin/sh`-- 确保您的脚本以`#!/bin/bash`! 开头）：

```
PS4=':${BASH_SOURCE}:${LINENO}+'
set -x 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-05-30T11:17:13.110

Bash 有一个特殊的变量`$LINENO`可以做你想做的事。

```
#!/bin/bash
echo "$LINENO"
echo "$LINENO"
echo "$LINENO" 
```

演示：

```
$ ./lineno
2
3
4 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-05-30T09:51:46.473

```
#!/bin/sh -x 
```

将在执行时报告这些行（`-x`要明确的选项）。它不会给您*行号*，但会报告实际行。

另一种但更痛苦的方法是使用陷阱处理程序，如此[处](http://phaq.phunsites.net/2010/11/22/trap-errors-exit-codes-and-line-numbers-within-a-bash-script/)所述。

# asp.net-mvc-3 - 如何访问列表中的对象，保存在会话中。ASP.NET MVC 3

> ID：10813870
> 
> 赞同：3
> 
> 时间：2012-05-30T09:50:30.763
> 
> 标签：asp.net-mvc-3, session

所以我有这个代码：

```
var list = new List<Carrito> { 
                new Carrito { ProductId = producto.ID , Cantidad = 1, PrecioUnitario = producto.Precio }
            };

            Session["list"] = list;

            return View(); 
```

然后我加载视图，但我不知道如何打印会话内的内容。有任何想法吗？

这是我在视图中使用但不起作用的代码：

```
@foreach(var item in (IEnumerable<object>)Session["list"] )
{
  <p>@item.ProductId</p>
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-30T09:54:39.400

它就像从会话变量中读回值并将其转换为原始类型一样简单，然后做任何你想做的事情

例子：

```
@{
    if(Session["list"]!= null)
    {
    var listBackFromSession = (List<Carrito>)Session["list"];
    // do what you want
    }
 } 
```

我的建议是使用 ViewBag 更优雅的方式。

来自官方 asp.net mvc 网站关于 Viewbag 的引用：

> **新的“ViewBag”属性**
> 
> *MVC 2 控制器支持 ViewData 属性，该属性使您能够使用后期绑定字典 API 将数据传递到视图模板。在 MVC 3 中，您还可以使用更简单的语法和 ViewBag 属性来完成相同的目的。例如，您可以编写 ViewBag.Message="text"，而不是编写 ViewData["Message"]="text"。您无需定义任何强类型类即可使用 ViewBag 属性。因为它是一个动态属性，所以您可以改为获取或设置属性，它会在运行时动态解析它们。在内部，ViewBag 属性作为名称/值对存储在 ViewData 字典中。（注意：在 MVC 3 的大多数预发布版本中，ViewBag 属性被命名为 ViewModel 属性。）*

此外，这是一篇关于 MVC 中保存数据的不同方式的好文章：[http://rachelappel.com/when-to-use-viewbag-viewdata-or-tempdata-in-asp。 net-mvc-3-应用程序](http://rachelappel.com/when-to-use-viewbag-viewdata-or-tempdata-in-asp.net-mvc-3-applications)

例子：

```
var list = new List<Carrito> { 
                new Carrito { ProductId = producto.ID , Cantidad = 1, PrecioUnitario = producto.Precio }
            };

// use ViewBag
ViewBag.myList = list;

then inside your view, read them back like this:

var myList = (List<Carrito>)ViewBag.myList;
// your code 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-30T10:09:13.010

你在做 MVC**根本上是错误**的。在 MVC 中，视图仅用于渲染模型。访问该模型的逻辑应该在控制器或任何其他地方实现，而不是在视图本身中。

因此，我建议您只需将**列表**传递给视图，并通过`@model List<Carrito>`在顶部包含来使您的视图具有强类型。

# sharepoint - 带有表单库的 SharePoint 2010 网站模板 - 表单模板包含网站 URL

> ID：10813871
> 
> 赞同：0
> 
> 时间：2012-05-30T09:50:34.803
> 
> 标签：sharepoint, sharepoint-2010, infopath, form-library

我正在开发一个网站模板，该模板将用于为不同的组织单位创建数百个网站。该站点应包含一个表单库，以及一个 InfoPath 表单模板。

我的问题是 - 是否可以创建模板并让高级用户创建站点，而无需任何管理员或开发人员参与？如果不是 - 最简单的选择是什么？

问题是表单模板包含站点 URL，我不知道这是否可以避免。因此，当创建站点并提交表单时，它最终会出现在原始站点的库中。

我已经为试点项目创建了一些站点，到目前为止我一直在做的是解开 XSN 文件，手动编辑 URL，重新打包到 XSN 中并发布到新库。这可行，但涉及我希望避免的站点创建过程中的手动步骤。这是我正在编辑的行：

```
<xsf:submit caption="Submit" disableMenuItem="no" onAfterSubmit="close" showStatusDialog="no">
    <xsf:davAdapter name="SharePoint Library Submit" submitAllowed="yes" overwriteAllowed="no">
        <xsf:folderURL value="http://my_farm_url/subsite1/form_lib" 
```

也在这里：

```
<xsf2:solutionPropertiesExtension branch="wss">
    <xsf2:wss path="http://my_farm_url/subsite1/form_lib" 
```

我正在将 subsite1 更改为 subsite2。

我尝试设置一个相对 URL，首先是提交元素，然后是两者，但无济于事。表单正在呈现（在浏览器中），提交工作（没有错误）但是提交的表单不在库中。进一步研究，表单最终被提交到根站点上的表单库 - `http://my_farm_url/form_lib`！当您考虑它时，这是有道理的，这就是`form_lib`从站点，从根站点角度将您带到的相对 url。

目前我设想的唯一解决方案是创建一个工具，帮助用户基于模板创建站点，在幕后修复 XSN。我不知道如何以编程方式发布表单模板，但应该可以。除了这个未知数之外，它也不是很自动化，如果可以找到仅适用于 SharePoint/InfoPath 工具的适当解决方案，我将非常高兴。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-13T20:31:51.167

您需要安排一个 EventReceiver 没有办法进行配置。

在 EventReceiver 中，您必须读取文件“Manifest.xsf”，更新定义了 url 的 XML 节点并保存文件“Manifest.xsf”。

要读取 XML 节点，必须使用 System.Xml.dll

# android - 应用程序关闭后如何删除 GPS 更新

> ID：10813874
> 
> 赞同：0
> 
> 时间：2012-05-30T09:50:49.403
> 
> 标签：android, gps

我有一个使用`gps`. 除非应用程序被强制关闭（由用户或 android 操作系统）并重新打开，否则它工作正常。然后我似乎无法关闭`gps`更新。这是我的代码：

```
private void registerLocationUpdates() {
    Intent intent = new Intent(ParkOGuardActivity.class.getName()
            + ".LOCATION_READY");
    pendingIntent = PendingIntent.getBroadcast(
            getApplicationContext(), 0, intent, 0);
    // minimum every 1 minutes, 5 kilometers 
    this.locationManager.requestLocationUpdates(this.provider, 5000,
            300000, pendingIntent);
}

private void cancelLocationUpdates() {
    if(pendingIntent != null){
        Log.d(TAG,pendingIntent!=null ? "pending is not null" : "pending is null");
        this.locationManager.removeUpdates(pendingIntent);
    }
} 
```

如果我调用该`cancelLocationUpdates()`方法没问题，但是在重新打开应用程序后（在它被强制关闭后）它`pendingIntent`是空的，我不能删除更新......有什么办法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-30T10:05:27.447

我找到了解决方案。它是一个丑陋的，但它的工作原理：

```
private void cancelLocationUpdates() {
    if(pendingIntent == null) {
        registerLocationUpdates();
    }
    this.locationManager.removeUpdates(pendingIntent);
} 
```

希望能帮助到你。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-30T10:11:14.667

在开始活动之前检查 GPS 是打开还是关闭，如下所示：

```
LocationManager lm;
boolean gpsOn = false;
if (!lm.isProviderEnabled(LocationManager.GPS_PROVIDER )) {
    launchGPSOptions();
    if (!gpsOn) launchGPS();
} 
```

在您的代码中使用 LaunchGPS 和 LaunchGPS 选项，如下所示：

```
private void launchGPSOptions() {
    String provider = Settings.Secure.getString(getContentResolver(),
            Settings.Secure.LOCATION_PROVIDERS_ALLOWED);
    if (!provider.contains("gps")) {
        final Intent poke = new Intent();
        gpsOn = true;
        poke.setClassName("com.android.settings",
                "com.android.settings.widget.SettingsAppWidgetProvider");
        poke.addCategory(Intent.CATEGORY_ALTERNATIVE);
        poke.setData(Uri.parse("3"));
        sendBroadcast(poke);
    }
}

private void launchGPS() {
    // final ComponentName toLaunch = new
    // ComponentName("com.android.settings","com.android.settings.SecuritySettings");
    final Intent intent = new Intent(
            Settings.ACTION_LOCATION_SOURCE_SETTINGS);
    intent.addCategory(Intent.CATEGORY_LAUNCHER);
    // intent.setComponent(toLaunch);
    intent.setFlags(Intent.FLAG_ACTIVITY_NEW_TASK);
    startActivityForResult(intent, 0);
} 
```

# python - OpenERP：如何在同一个视图中显示两个对象的字段？

> ID：10813880
> 
> 赞同：2
> 
> 时间：2012-05-30T09:51:22.920
> 
> 标签：python, xml, one-to-many, openerp

如何在同一个树视图中显示两条记录的字段，知道这些表与 OneToMany relashionship 链接？

这是我的领域：

```
 'class_id': fields.many2one('mod.class', 'Entree', required=True), 
```

在我的树视图中：

```
 <field colspan="4" name="class_id" nolabel="1" widget="one2many_list"/> 
```

但这只能显示外键，但我需要其他字段

我会很感激任何帮助。谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-30T19:40:51.743

通常，我使用[`related`字段](http://doc.openerp.com/v6.1/developer/03_modules_2.html#relational-types)来显示相关表中的字段。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-30T15:51:43.100

像许多报告一样制作相关字段或制作没有表格的视图（数据库）。或制作仪表板类型视图。这取决于您和您的要求。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-31T05:17:33.313

在 OpenERP 的插件文件夹 goto addons > base > partner > partner.py 中，您可以看到一个名为“address”的字段，它是一个 one2many 字段。您还可以找到与地址字段相关的一些相关字段，例如“手机”、“电话”、“城市”等。这些相关字段可以在树视图中使用。

这与您正在尝试做的事情相同。

# regex - mod重写的正则表达式

> ID：10813892
> 
> 赞同：0
> 
> 时间：2012-05-30T09:52:15.760
> 
> 标签：regex

我试图为在 Windows 服务器上运行的 mod 重写规则编写正则表达式。到目前为止我试过

```
RewriteRule ^/hcp/(.*)/(.*)$ /delete.aspx?page=$2&root=$1 [NC,L,I]
RewriteRule ^/hcp/(.*)$ /delete.aspx?page=$1&root=$1 [NC,L,I] 
```

和

```
RewriteRule ^/hcp/([a-z]|[-])/([a-z]|[-])$ /delete.aspx?page=$2&root=$1 [NC,L,I]
RewriteRule ^/hcp/([a-z]|[-])$ /delete.aspx?page=$1&root=$1 [NC,L,I] 
```

只是为了很好的衡量我刚刚尝试过这个

```
RewriteRule ^/hcp/(([a-zA-Z0-9_-]+)/([a-zA-Z0-9_-]+)$ /delete.aspx?page=$2&root=$1 [NC,L,I]
RewriteRule ^/hcp/([a-zA-Z0-9_-]+)$ /delete.aspx?page=$1&root=$1 [NC,L,I] 
```

我试图让它匹配

```
www.site.com/hcp/parameter 
```

和

```
www.site.com/hcp/param1/param2 
```

出于某种原因，它不断将所有内容放入 $1 而没有放入 $2 或者在第二行的情况下，第二个 $1 是空白的，例如

```
root = page = param1/param2 
```

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-30T13:04:24.920

试试这个：

```
RewriteRule ^/hcp/([^/]+)/([^/]+)$ /delete.aspx?page=$2&root=$1 [NC,L,I]
RewriteRule ^/hcp/([^/]+)$ /delete.aspx?page=$1&root=$1 [NC,L,I] 
```

你也需要使用`B`flag吗？我不知道重写与 Apache 的相似之处。

# android - 动态生成活动

> ID：10813893
> 
> 赞同：1
> 
> 时间：2012-05-30T09:52:19.307
> 
> 标签：android

我有一个应用程序，根据用户输入，我必须显示活动。请指定如何动态显示活动。已经保持活动的最大数量并使用意图显示它们绝对不是一个可行的选择。

我怎样才能做到这一点？z

```
public class Progress extends Activity implements OnClickListener{
Button b;

@Override
protected void onCreate(Bundle savedInstanceState) {
// TODO Auto-generated method stub
super.onCreate(savedInstanceState);
setContentView(R.layout.progress);
    b = (Button) findViewById(R.id.b);
    b.setOnClickListener(this);
}

@Override
public void onClick(View view) {
// TODO Auto-generated method stub

switch(view.getId()){

 case R.id.b:

 String numberPos = et.getText.toString();
 int n = Integer.parseInt(numberPos);

  break;

}

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-30T09:55:47.817

尽量少一点模糊。您想针对什么问题使用动态活动？为什么你不能使用意图。

您应该像进行其他所有活动一样进行活动，但您应该根据您的意图传递参数，并让您的活动根据参数显示它所需的信息。

# wpf - WPF 嵌套用户控件和 MVVM（尤其是 Caliburn.Micro

> ID：10813896
> 
> 赞同：0
> 
> 时间：2012-05-30T09:52:25.633
> 
> 标签：wpf, user-controls, caliburn.micro

我非常担心选择要转换的 MVVM 框架。主要考虑因素之一是对用户控件和嵌套用户控件的支持，因为我今天的主页有一个包含嵌套用户控件的用户控件。

Catel 的作者[强调缺乏对嵌套用户控件的支持](http://www.codeproject.com/Articles/129920/Catel-Part-3-of-n-The-MVVM-Framework#nested)是其他平台（包括 Caliburn.Micro）的主要缺点

所以我的问题是：**Caliburn.Micro 不支持嵌套用户控件吗？**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-30T10:33:38.917

Caliburn.Micro 对您用于开发用户界面的机制类型没有任何限制。不需要使用 Caliburn.Micro 的约定，您仍然可以在需要时明确使用绑定。

如果您在视图合成期间使用用户控件来重用用户界面代码，那么 Caliburn.Micro 也为此提供了一种替代技术，使用视图模型属性和`ContentControl`s。

有关示例，请参见[此处。](https://stackoverflow.com/questions/9580325/does-caliburn-micro-play-nicely-with-user-controls)

# c# - 如何从服务获取 JSON 响应

> ID：10813899
> 
> 赞同：0
> 
> 时间：2012-05-30T09:52:27.720
> 
> 标签：c#, json, web-services, windows-8, windows-runtime

我试图从服务中获取 PNR 状态（火车票状态信息）

# 请求有效 PNR

请求格式：[http](http://www.mmtstraintimings.in/pnrstatus/) : //www.mmtstraintimings.in/pnrstatus/ {PNR 编号}

[具有有效 PNR 的服务 URL：http://www.mmtstraintimings.in/pnrstatus/8102874012](http://www.mmtstraintimings.in/pnrstatus/8102874012)

回复 ：

" `Journey Details<\/td>\u000a<\/tr>\u000a<TR class=\"heading_table\">\u000a<td width=\"11%\">Train Number<\/Td>\u000a<td width=\"16%\">Train Name<\/td>\u000a<td width=\"18%\">Boarding Date <br>(DD-MM-YYYY)<\/td>\u000a<td width=\"7%\">From<\/Td>\u000a<td width=\"7%\">To<\/Td>\u000a<td width=\"14%\">Reserved Upto<\/Td>\u000a<td width=\"21%\">Boarding Point<\/Td>\u000a<td width=\"6%\">Class<\/Td>\u000a<\/TR>\u000a<TR>\u000a<TD class=\"table_border_both\">*19309<\/TD>\u000a<TD class=\"table_border_both\">GNC INDORE EXP <\/TD>\u000a<TD class=\"table_border_both\"> 3- 6-2012<\/TD>\u000a<TD class=\"table_border_both\">BRC <\/TD>\u000a<TD class=\"table_border_both\">INDB<\/TD>\u000a<TD class=\"table_border_both\">INDB<\/TD>\u000a<TD class=\"table_border_both\">BRC <\/TD>\u000a<TD class=\"table_border_both\"> SL<\/TD>\u000a<\/TR>\u000a<\/TABLE><table class='listings' border='0' id='listings'><tbody>\u000a<TR>\u000a<td width=\"25%\" class=\"heading_table_top\">S. No.<\/td>\u000a<td width=\"45%\" class=\"heading_table_top\">Booking Status <br \/> (Coach No , Berth No., Quota)<\/td>\u000a<td width=\"30%\" class=\"heading_table_top\">* Current Status <br \/>(Coach No , Berth No.)<\/td>\u000a<\/TR>\u000a<TR>\u000a<TD class=\"table_border_both\"><B>Passenger 1<\/B><\/TD>\u000a<TD class=\"table_border_both\"><B>W\/L 112,PQWL <\/B><\/TD>\u000a<TD class=\"table_border_both\"><B>W\/L 92<\/B><\/TD>\u000a<\/TR>\u000a<TR>\u000a<TD class=\"table_border_both\"><B>Passenger 2<\/B><\/TD>\u000a<TD class=\"table_border_both\"><B>W\/L 113,PQWL <\/B><\/TD>\u000a<TD class=\"table_border_both\"><B>W\/L 93<\/B><\/TD>\u000a<\/TR>\u000a<TR>\u000a<td class=\"heading_table_top\">Charting Status<\/td>\u000a<TD colspan=\"3\" align=\"middle\" valign=\"middle\" class=\"table_border_both\"> CHART NOT PREPARED <\/TD>\u000a<\/TR>\u000a<TR>\u000a<td colspan=\"4\"><font color=\"#1219e8\" size=\"1\"><b> * Please Note that in case the Final Charts have not been prepared, the Current Status might upgrade\/downgrade at a later stage.<\/font><\/b><\/Td>\u000a<\/TR>\u000a<\/TABLE>\u000a<BR>\u000a<TABLE wi`"

这是响应 HTML 或 JSON 还是什么？？？我只是无法得到它。

我认为它使用 Http POST 来获取信息。

使用此服务链接的网站[http://www.pnrstatuscheck.in/](http://www.pnrstatuscheck.in/)以这种格式显示信息

![上面的响应在网站上显示为这张图片](../Images/5bf22fa212a082c826162cf67c1b0798.png)

我想将信息提取到一个实体中并随意使用它..我该怎么做..

任何指针都会有所帮助

# 编辑

我什至做了一个小程序来获取上面的文本（我仍然不知道如何解释它）

如果您不使用代理，请删除代理代码

```
 Uri uri = new Uri("http://www.mmtstraintimings.in/pnrstatus/8102874012");
        var request = (HttpWebRequest)WebRequest.Create(uri);
        request.Proxy = WebRequest.DefaultWebProxy;
        request.Credentials = new NetworkCredential("ID", "pass", "domain");
        request.Proxy.Credentials = new NetworkCredential("id", "pass", "domain");
        request.Method = "GET";
        request.ContentType = "application/x-www-form-urlencoded";

        using (var response = request.GetResponse())
        {

            using (Stream responseStream = response.GetResponseStream())
            {
                using (StreamReader readStream = new StreamReader(responseStream, Encoding.UTF8))
                {
                    var result = readStream.ReadToEnd();
                }

            }
        } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-30T11:32:24.120

为您清理了一些响应。

不知道您可能想对此做什么，但是由于响应不完整，您甚至无法解析它..

还在 Fiddler 中使用 XML 和 JSON 作为接受类型的 GET 请求对此进行了测试。没有不同。

```
 "Journey Details</td>
</tr>

<TR class="heading_table">
    <td width="11%">Train Number</Td>
    <td width="16%">Train Name</td>
    <td width="18%">Boarding Date <br>(DD-MM-YYYY)</td>
    <td width="7%">From</Td>
    <td width="7%">To</Td>
    <td width="14%">Reserved Upto</Td>
    <td width="21%">Boarding Point</Td>
    <td width="6%">Class</Td>
</TR>
<TR>
    <TD class="table_border_both">*19309</TD>
    <TD class="table_border_both">GNC INDORE EXP </TD>
    <TD class="table_border_both"> 3- 6-2012</TD>
    <TD class="table_border_both">BRC </TD>
    <TD class="table_border_both">INDB</TD>
    <TD class="table_border_both">INDB</TD>
    <TD class="table_border_both">BRC </TD>
    <TD class="table_border_both"> SL</TD>
</TR> 
```

```
<table class='listings' border='0' id='listings'>
    <tbody>
        <TR>
            <td width="25%" class="heading_table_top">S. No.</td>
            <td width="45%" class="heading_table_top">Booking Status <br /> (Coach No , Berth No., Quota)</td>
            <td width="30%" class="heading_table_top">* Current Status <br />(Coach No , Berth No.)</td>
        </TR>
        <TR>
            <TD class="table_border_both"><B>Passenger 1</B></TD>
            <TD class="table_border_both"><B>W/L  112,PQWL  </B></TD>
            <TD class="table_border_both"><B>W/L   91</B></TD>
        </TR>
        <TR>
            <TD class="table_border_both"><B>Passenger 2</B></TD>
            <TD class="table_border_both"><B>W/L  113,PQWL  </B></TD>
            <TD class="table_border_both"><B>W/L   92</B></TD>
        </TR>
        <TR>
            <td class="heading_table_top">Charting Status</td>
            <TD colspan="3" align="middle" valign="middle" class="table_border_both"> CHART NOT PREPARED </TD>
        </TR>
        <TR>
            <td colspan="4">
                <font color="#1219e8" size="1">
                    <b> * Please Note that in case the Final Charts have not been prepared, the Current Status might upgrade/downgrade at a later stage.</font></b>
            </Td>
        </TR>
    </TABLE>
    <BR>
    <TABLE wi" 
```

# css - 从顶级 css 导入 css 被阻止

> ID：10813905
> 
> 赞同：2
> 
> 时间：2012-05-30T09:52:40.837
> 
> 标签：css, firefox, noscript

在网页中，我有以下代码段：

```
<html>
<head>
<META http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<base href="https://XXXXX /">
<title>Example</title>
<link href="Layout/standard.css" type="text/css" title="Example" rel="stylesheet">
</head>
<body> 
```

引用的页面`standard.css`如下所示：

```
@import url( "standard2.css" );
@import url( "standard3.css" ); 
```

在 Firfefox ESR 10.0.4 中升级[noscript 插件](http://noscript.net)`standard2.css`（版本 2.4.3）后， css 页面`standard3.css`不再加载。使用早期版本的 noscript 一切都按预期工作。

为什么 noscript 阻止这个？从另一个 css 中导入 css 是否存在已知的安全问题？或者它只是 noscript 中的一个错误？

* * *

**更新**：问题不在于级联导入。问题是我使用了一个短 URL ( `https://hostname/...`)。如果我使用完全限定的 URL ( `https://hostname.mynet.com/...`) 一切正常。

所以它看起来真的像 noscript 2.4.3 中的一个错误。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-30T12:24:42.613

NoScript[更改日志](http://noscript.net/changelog)没有提及对此的任何更改，因此它可能是一个错误。

# mongodb - 获取所选文档在集合中的位置 [mongoDB]

> ID：10813908
> 
> 赞同：27
> 
> 时间：2012-05-30T09:52:45.207
> 
> 标签：mongodb, collections, find, position

如何在 mongo 集合中获取所选文档的位置（索引）？

例如这个文件：有`db.myCollection.find({"id":12345})` 索引`3``myCollection`

```
myCollection:
    id: 12340, name: 'G'
    id: 12343, name: 'V'
    id: 12345, name: 'A'
    id: 12348, name: 'N' 
```

* * *

## 回答 #1

> 赞同：42
> 
> 时间：2012-05-30T11:17:38.683

如果您的要求是查找文档的位置而不考虑任何顺序，那么这是不可能的，因为 MongoDb 不会按特定顺序存储文档。但是，如果您想知道基于某个字段的索引，例如`_id`，您可以使用此方法。

如果您在您的`_id`领域严格遵循自动增量。您可以计算所有价值小于该值的文档`_id`，例如 n ，然后 n + 1 将是基于 的文档的索引`_id`。

```
n = db.myCollection.find({"id": { "$lt" : 12345}}).count() ; 
```

如果从集合中删除文档，这也是有效的。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-30T10:06:47.693

据我所知，没有单一的命令可以做到这一点，这在一般情况下是不可能的（见德里克的回答）。但是，`count()`用于对有序 id 值字段进行的查询似乎有效。**警告：这假设有一个可靠排序的字段，这在并发编写器的情况下很难实现。在此示例`_id`中使用，但是这仅适用于单个编写器案例。**：

```
MongoDB shell version: 2.0.1
connecting to: test
> use so_test
switched to db so_test
> db.example.insert({name: 'A'})
> db.example.insert({name: 'B'})
> db.example.insert({name: 'C'})
> db.example.insert({name: 'D'})
> db.example.insert({name: 'E'})
> db.example.insert({name: 'F'})
> db.example.find()
{ "_id" : ObjectId("4fc5f040fb359c680edf1a7b"), "name" : "A" }
{ "_id" : ObjectId("4fc5f046fb359c680edf1a7c"), "name" : "B" }
{ "_id" : ObjectId("4fc5f04afb359c680edf1a7d"), "name" : "C" }
{ "_id" : ObjectId("4fc5f04dfb359c680edf1a7e"), "name" : "D" }
{ "_id" : ObjectId("4fc5f050fb359c680edf1a7f"), "name" : "E" }
{ "_id" : ObjectId("4fc5f053fb359c680edf1a80"), "name" : "F" }
> db.example.find({_id: ObjectId("4fc5f050fb359c680edf1a7f")})
{ "_id" : ObjectId("4fc5f050fb359c680edf1a7f"), "name" : "E" }
> db.example.find({_id: {$lte: ObjectId("4fc5f050fb359c680edf1a7f")}}).count()
5
> 
```

如果查询的字段被索引，这也应该相当快。该示例在 mongo shell 中，但`count()`也应该在所有驱动程序库中都可用。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2016-10-17T03:03:11.560

这可能是非常缓慢但直接的方法。在这里你可以像往常一样传递查询。只是我正在循环所有文档并检查条件是否与记录匹配。在这里，我正在检查 _id 字段。您可以使用任何其他单个字段或多个字段来检查它。

```
var docIndex = 0;
db.url_list.find({},{"_id":1}).forEach(function(doc){
  docIndex++;
  if("5801ed58a8242ba30e8b46fa"==doc["_id"]){
    print('document position is...' + docIndex);
    return false;
  }
}); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-30T10:11:12.233

MongoDB 无法返回它，因为它不会在数据库中保持文档的顺序，就像 MySQL fe 不命名行号一样。

jhonkola 的 ObjectID 技巧仅在只有一个客户端创建新元素时才有效，因为 ObjectID 是在客户端生成的，第一部分是时间戳。如果不同的客户端与同一台服务器通信，则无法保证顺序。不过，我不会依赖这个。

我也不太明白你想要做什么，所以也许在你的问题中提到这一点？然后我可以更新答案。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-05-31T10:13:55.287

重组您的集合以包含任何条目的位置，即 {'id': 12340, 'name': 'G', 'position': 1} 然后在使用所需位置作为查询搜索数据库集合（myCollection）时

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2018-09-22T16:36:46.450

我使用的返回整个集合的查询都使用排序来获得可重现的顺序，find.sort.forEach 与上面的脚本一起使用以获得正确的索引。

# java - 如何在 Java 的 GlazedLists/JTable 中添加、删除和更新行？

> ID：10813915
> 
> 赞同：2
> 
> 时间：2012-05-30T09:53:07.613
> 
> 标签：java, swing, jtable, jtextfield, glazedlists

我创建了一个带有 GlazedLists 的表，以便能够过滤该表以进行搜索。现在的问题是如何删除、添加或更新此表中的行。我确实搜索了 API，但无法弄清楚。

**谁能用一个简单的例子演示如何实现删除、添加、更新？**

```
public static JTable retrieveArtikelTable(String filePath, String[] header, JTextField filterField) {
    EventList eventList = new BasicEventList();
    String[] headers = new String[0];
    CsvReader reader = null;
    JTable t = new JTable();
    if (filePath != null) {
        if (new File(filePath).exists()) {
            try {
                reader = new CsvReader(filePath, ';');
                if (header != null) {
                    headers = header;
                } else {
                    headers = reader.getHeaders();
                }
                while (reader.readRecord()) {
                    String[] values = reader.getValues();
                    eventList.add(new Artikel(values[0], values[1], values[2]));
                }
                reader.close();
                TextFilterator artikelFilterator = new TextFilterator() {
                    public void getFilterStrings(List baseList, Object element) {
                        Artikel artikel = (Artikel) element;
                        baseList.add(artikel.getCode());
                        baseList.add(artikel.getName());
                        baseList.add(artikel.getNumber());
                    }
                };
                TextComponentMatcherEditor matcherEditor = new TextComponentMatcherEditor(filterField, artikelFilterator);
                FilterList filteredArtikels = new FilterList(eventList, new ThreadedMatcherEditor(matcherEditor));

                // build a JTable
                TableFormat tf = GlazedLists.tableFormat(Artikel.class,headers, headers);
                t = new JTable(new EventTableModel(filteredArtikels, tf));
            } catch (Exception ex) {
                OeExceptionDialog.show(ex);
            } finally {
                assert reader != null;
                reader.close();
            }
        }
    }else{
        t=new JTable();
        JOptionPane.showMessageDialog(filterField.getParent(),"Attention: " +filePath+
                "There is no such a file to be able to create a table!");
    }

    return t;
}

header = new String[]{"Code","Name","Number"};
JTextField filterField = new JTextField();
JTable table = retrieveArtikelTable("c:\articl.csv", header, filterField)

int selectedRow = table.getSelectedRow();
EventTableModel tableModel = (EventTableModel) table.getModel();
// code for deleting a row from this table

// code for add row to this table

// code for updating row from this table 
```

**编辑：**

```
EventList eventList = new BasicEventList();
JTable table = retrieveArtikelTable("c:\articl.csv", header, filterField, eventList)
int selectedRow = table.getSelectedRow();

// code for deleting a row from this table
 eventList.remove(selectedRow);
// code for add row to this table

// code for updating row from this table 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-30T10:10:17.970

如果您对 EventList 进行更改，那么这些更改将通过表模型传播到 JTable。（也就是说，如果您向该列表添加一个新对象、删除一个或更新一个对象，则更改会自动发生。因此，“事件”前缀 - 列表中的事件将传达给模型。）

因此，您可能需要保留对 EventList 的引用，以确保它可以访问`retrieveArtikelTable()`您的案例之外的部分代码。

我觉得[GlazedLists Developer](http://publicobject.com/glazedlistsdeveloper/)的截屏视频非常适合涵盖所有基本主题。

**编辑：**只是提醒您如何使列表成为实例变量，以便可以通过任何方法访问它，而不仅仅是构造表的方法。

```
public class Example {
    private EventList<Person> eventList = new BasicEventList<Person>();

    public JTable createTable(...) { ... code to generate the table ...}

    public void manipulateTable() {
        // add to the table (via the eventList)
        eventList.add(new Person("Steve Jobs"));
        // remove first object in the table (and the list)
        eventList.remove(0);
        // update a row
        Person p = eventList.get(0);
        p.setName("A N Other");
        eventList.set(0,p); // overwrite the old object in the list

    }
} 
```

**编辑#2：**我包含了一个更完整的示例，以说明您应该如何使用 EventSelectionModel 正确处理选择，它允许您准确知道在任何给定时间选择了哪些行，即使过滤器已经应用。

![示例应用的屏幕截图](../Images/e07d5dc7ec47ef1db47d573bbdddfb96.png)

我复制了一个使用 Netbeans GUI 构建器部分生成的文件。但需要注意的关键点是：

1.  将[EventSelectionModel](http://publicobject.com/glazedlists/glazedlists-1.8.0/api/ca/odell/glazedlists/swing/EventSelectionModel.html)声明为实例变量，以便可以在类的其他地方访问它。

2.  `btnDeleteActionPerformed()`方法。这就是按下 Delete 按钮时发生的情况。首先，我检查是否选择了任何行。如果是这样，获取选定的项目（作为事件列表返回）并简单地将它们从主列表中删除。

这是 MyFrame.java 的示例代码

```
public class MyFrame extends javax.swing.JFrame {

    private EventList<Person> eventList = new BasicEventList<Person>();
    private EventSelectionModel<Person> selectionModel;

    /**
     * Creates new form MyFrame
     */
    public MyFrame() {
        initComponents();
        loadData();
        configureTable();
    }

    private void loadData() {

        eventList.add(new Person("Richard", "Dawkins"));
        eventList.add(new Person("Sam", "Harris"));
        eventList.add(new Person("Christopher", "Hitchens"));
        eventList.add(new Person("Daniel", "Dennett"));

    }

    private void configureTable() {
        String[] headers = new String[]{"Firstname", "Lastname"};
        String[] properties = new String[]{"firstname", "lastname"};

        TextFilterator<Person> personTextFilterator = new TextFilterator<Person>() {

            @Override
            public void getFilterStrings(List list, Person p) {
                list.add(p.getFirstname());
                list.add(p.getLastname());
            }
        };

        MatcherEditor<Person> textMatcherEditor = new TextComponentMatcherEditor<Person>(txtFilter, personTextFilterator);

        FilterList<Person> filterList = new FilterList<Person>(eventList, textMatcherEditor);

        TableFormat tf = GlazedLists.tableFormat(properties, headers);
        EventTableModel<Person> model = new EventTableModel<Person>(filterList, tf);

        selectionModel = new EventSelectionModel<Person>(filterList);
        tblNames.setSelectionModel(selectionModel);

        tblNames.setModel(model);
    }

    /**
     * This method is called from within the constructor to initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is always
     * regenerated by the Form Editor.
     */
    @SuppressWarnings("unchecked")
    // <editor-fold defaultstate="collapsed" desc="Generated Code">                          
    private void initComponents() {

        jLabel1 = new javax.swing.JLabel();
        txtFilter = new javax.swing.JTextField();
        jScrollPane1 = new javax.swing.JScrollPane();
        tblNames = new javax.swing.JTable();
        btnDelete = new javax.swing.JButton();
        btnReload = new javax.swing.JButton();

        setDefaultCloseOperation(javax.swing.WindowConstants.EXIT_ON_CLOSE);
        setTitle("GlazedLists test");

        jLabel1.setText("Filter");

        tblNames.setModel(new javax.swing.table.DefaultTableModel(
            new Object [][] {
                {null, null, null, null},
                {null, null, null, null},
                {null, null, null, null},
                {null, null, null, null}
            },
            new String [] {
                "Title 1", "Title 2", "Title 3", "Title 4"
            }
        ));
        jScrollPane1.setViewportView(tblNames);

        btnDelete.setText("Delete");
        btnDelete.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnDeleteActionPerformed(evt);
            }
        });

        btnReload.setText("Reload data");
        btnReload.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnReloadActionPerformed(evt);
            }
        });

        javax.swing.GroupLayout layout = new javax.swing.GroupLayout(getContentPane());
        getContentPane().setLayout(layout);
        layout.setHorizontalGroup(
            layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
            .add(layout.createSequentialGroup()
                .addContainerGap()
                .add(layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
                    .add(layout.createSequentialGroup()
                        .add(jLabel1)
                        .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)
                        .add(txtFilter))
                    .add(jScrollPane1, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 388, Short.MAX_VALUE)
                    .add(org.jdesktop.layout.GroupLayout.TRAILING, layout.createSequentialGroup()
                        .add(btnReload)
                        .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                        .add(btnDelete)))
                .addContainerGap())
        );
        layout.setVerticalGroup(
            layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
            .add(layout.createSequentialGroup()
                .addContainerGap()
                .add(layout.createParallelGroup(org.jdesktop.layout.GroupLayout.BASELINE)
                    .add(jLabel1)
                    .add(txtFilter, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE))
                .addPreferredGap(org.jdesktop.layout.LayoutStyle.UNRELATED)
                .add(jScrollPane1, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 240, Short.MAX_VALUE)
                .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)
                .add(layout.createParallelGroup(org.jdesktop.layout.GroupLayout.BASELINE)
                    .add(btnDelete)
                    .add(btnReload))
                .addContainerGap())
        );

        pack();
    }// </editor-fold>                        

    private void btnDeleteActionPerformed(java.awt.event.ActionEvent evt) {                                          
        if (!selectionModel.isSelectionEmpty()) {
            eventList.removeAll(selectionModel.getSelected());
        }
    }                                         

    private void btnReloadActionPerformed(java.awt.event.ActionEvent evt) {                                          
        eventList.clear();
        loadData();
    }                                         

    /**
     * @param args the command line arguments
     */
    public static void main(String args[]) {

        /*
         * Create and display the form
         */
        java.awt.EventQueue.invokeLater(new Runnable() {

            @Override
            public void run() {
                new MyFrame().setVisible(true);
            }
        });
    }
    // Variables declaration - do not modify                     
    private javax.swing.JButton btnDelete;
    private javax.swing.JButton btnReload;
    private javax.swing.JLabel jLabel1;
    private javax.swing.JScrollPane jScrollPane1;
    private javax.swing.JTable tblNames;
    private javax.swing.JTextField txtFilter;
    // End of variables declaration                   
} 
```

我在示例中使用了 Person 类，它是一个非常简单的[POJO](http://en.wikipedia.org/wiki/Plain_Old_Java_Object)：

```
public class Person {

    private String firstname;
    private String lastname;

    public Person() {
    }

    public Person(String firstname, String lastname) {
        this.firstname = firstname;
        this.lastname = lastname;
    }

    public String getFirstname() {
        return firstname;
    }

    public void setFirstname(String firstname) {
        this.firstname = firstname;
    }

    public String getLastname() {
        return lastname;
    }

    public void setLastname(String lastname) {
        this.lastname = lastname;
    }

} 
```

我个人建议将数据加载与创建表的方法分开。我使用了`loadData()`填充列表的方法。如果没有要加载的数据，或者您要从中加载的文件有问题，那么仍然会创建表，但其中没有任何内容，因为列表仍然是空的。

# iphone - 是否可以在应用程序运行时动态更改标签栏项目文本/图标？

> ID：10813917
> 
> 赞同：0
> 
> 时间：2012-05-30T09:53:10.400
> 
> 标签：iphone, objective-c, ios, xcode

是否可以在应用程序运行时动态更改标签栏项目文本/图标？

例如，标签栏上的项目名称是 Item1。我想在使用应用程序时以编程方式将其更改为“ItemX”。

非常感谢，-代码

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-30T10:10:15.117

您想在哪里更改 Tabbar Item 文本/图标？在视图控制器本身中？您可以在视图控制器中更改 Tabbar Item 文本/图标，如下所示：

```
self.title = @"ItemX";

self.tabBarItem.image = [UIImage imageNamed:@"ItemX"]; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-30T10:08:21.793

[如何在可可的 uitabbarcontroller 中设置单个 tabbaritem 图标](https://stackoverflow.com/questions/978116/how-to-set-individual-tabbaritem-icons-in-uitabbarcontroller-in-cocoa)

# jquery - 使用 jQuery 从下拉列表中删除选项？

> ID：10813919
> 
> 赞同：-1
> 
> 时间：2012-05-30T09:53:17.237
> 
> 标签：jquery, debugging, list, drop-down-menu

我用过：

```
jQuery(document).ready(function() {
    alert(jQuery('#FormField_11').html());
    jQuery("#FormField_11 option[value='Afghanistan']").remove();
}); 
```

它给了我警报消息，但该值没有从下拉列表中删除。

我的代码中有明显的错误吗？你能告诉我如何正确实施吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-30T10:07:22.060

我认为您正在尝试通过下拉文本而不是值来删除。[JsFiddle 上的演示](http://jsfiddle.net/ZqvpG/)

按文本删除

```
<select id="FormField_11">
    <option value="foo">Afghanistan</option>
    <option value="bar">China</option>
</select>   

jQuery("#FormField_11 option").each(function(){
   if($(this).text() == "Afghanistan")
       $(this).remove();       
});​ 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-30T09:59:00.560

上面的代码也可以正常工作，但试试这个：

```
$("#FormField_11").find("option[value='Afghanistan']").remove(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-30T10:03:25.407

您发布的代码有效。所以我猜测你可能在“阿富汗”选项中有前导/尾随空格。

在这里查看：http: [//jsfiddle.net/jfSHP/1/](http://jsfiddle.net/jfSHP/1/)

# php - Symfony 检查 jQuery 是否已经包含

> ID：10813920
> 
> 赞同：0
> 
> 时间：2012-05-30T09:53:17.947
> 
> 标签：php, jquery, symfony1, symfony-1.4

有没有办法检查 sfContext 是否已经添加了 jQuery 库，使用：

```
sfContext::getInstance()->getResponse()->addJavascript('/js/jquery-1.4.2.min.js'); 
```

或者

```
addJavascript('jquery-1.4.2.min.js', sfView::getContext()); 
```

或者

```
use_javascript('jquery-1.4.2.min.js'); 
```

在模板中？

在我看来，添加更多 jQuery 会阻止他们的行动。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-30T10:12:16.147

您应该使用自己的支票。

1.  用你自己的`sfWebResponse`
2.  覆盖`addJavascript`
3.  添加支票

`myWebResponse.class.php`因此，使用以下代码在文件夹中创建一个新文件`/lib/response/`（创建它）：

```
class myWebResponse extends sfWebResponse 
{
  public function addJavascript($file, $position = '', $options = array())
  {
    $this->validatePosition($position);

    // check if the file to add is jquery
    // nb: you might update the regex 
    if (preg_match('/jquery/i', $file))
    {
      // retrieve all loaded js
      $files = array_keys($this->getJavascripts());

      // check if one them containt jquery
      // nb: you might update the regex 
      $isJquery = preg_grep("/jquery/i", $files);

      // jquery found so do not add the file
      if ( ! empty($isJquery))
      {
        return;
      }
    }

    $this->javascripts[$position][$file] = $options;
  } 
```

然后，默认使用您的新回复。在您的`apps/frontend/config/factories.yml`中，添加：

```
all:
  response:
    class: myWebResponse 
```

你完成了。

# iphone - iphone测试iad一直不可见

> ID：10813922
> 
> 赞同：0
> 
> 时间：2012-05-30T09:53:21.080
> 
> 标签：iphone, ios, ios5, iad

我在我的应用程序中实施了 iPhone 广告。我收到了测试广告，但有时需要一段时间才能显示测试广告？这是正常的还是应该始终出现在应用中的测试广告？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-30T10:13:39.003

@Amt-Henning 我认为这是测试 iAd 的正常行为。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-30T11:23:27.430

@developersaremad 是正确的。iAd 只会在与 Apple iAd 服务器成功通信并且您的应用收到测试广告时才会显示。这模拟了当用户可能不在数据覆盖区域内并因此无法获得广告时的现实生活。

# c# - 在 C# 中，如何动态获取静态类的成员？

> ID：10813925
> 
> 赞同：0
> 
> 时间：2012-05-30T09:53:32.147
> 
> 标签：c#, reflection, static, member

我目前正在尝试使用 ZXing 库在 Windows Phone 7.5 中开发移动条形码阅读器。看到我在这里发帖，你可能已经猜到我遇到了一些我不知道解决办法的问题。

问题如下： ZXing 库允许多种条形码格式 - 但是，我想包含一个设置菜单，让用户专门关注一个条形码。

BarcodeFormat 对象是静态的，包含我要分配的只读成员（BarcodeFormat 类型）。

看到和听到反射是这种动态行为的有力武器，我想我应该试一试。

到目前为止，我的代码可以使用 ZXing 获取所有可能的格式

```
MemberInfo[] plist = typeof(BarcodeFormat).GetMembers(); 
```

这适用于获取格式的名称，这意味着我可以成功地在列表中显示名称。但是在尝试将这些格式分配给实际阅读器时遇到了问题，因为我只有 MemberInfo 而不再是 BarcodeFormat。

到目前为止，我只找到了用户想要动态访问（设置/获取）变量的示例。然而，提议的解决方案似乎不适合我的问题——至少我没有找到任何方法来以这些方式分配格式。

任何帮助都会很棒:) 非常感谢。

编辑： BarcodeFormat 是这样使用的：

```
WP7BarcodeManager.ScanMode = BarcodeFormat.ITF; 
```

在此示例中，仅接受 ITF（交织 2 出 5）格式的条形码。

到目前为止，我已经尝试了以下方法。

只需分配 MemberInfo 对象而不是原始 BarcodeFormat 对象。

将 MemberInfo 对象转换为 BarcodeFormat。

我尝试使用 FieldInfo 和 getValue，但似乎我必须创建一个示例对象并将值分配给所需的字段才能获取值。这不能在这里完成，因为对象是静态的并且字段是只读的。

整个 ZXing 库被编译为我将项目链接到的 DLL。（它似乎正确链接，因为其他一切正常）。BarcodeFormat 的示例声明如下所示

```
public static readonly BarcodeFormat ITF 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-30T10:32:46.250

动态获取 ITF：

```
var formatName = "ITF";
var format = typeof(BarcodeFormat)
   .GetProperty(formatName, BindingFlags.Static | BindingFlags.Public)
   .GetValue(null, null); 
```

设置 WP7BarcodeManager.ScanMode：

```
WP7BarcodeManager.ScanMode = (BarcodeFormat)format; 
```

ps

BarcodeFormat 的成员：

```
var _format = member is PropertyInfo 
  ? ((PropertyInfo)member).GetValue(null, null)
  : ((FieldInfo)member).GetValue(null);
var format = (BarcodeFormat)_format; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-30T10:25:25.047

[“因为静态属性属于类型，而不是单个对象，所以通过将 null 作为对象参数传递来获取静态属性”](http://msdn.microsoft.com/en-us/library/b05d59ty)

*例如 ：*

```
PropertyInfo CurCultProp = (typeof(CultureInfo)).GetProperty("CurrentCulture"); 
Console.WriteLine("CurrCult: " + CurCultProp.GetValue(null,null)); 
```

所以你需要做的就是调用`GetProperties()`而不是`GetMembers()`调用`GetValue(null, null)`来获取值。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-30T10:49:12.060

我不完全理解你为什么要经历反思的麻烦。

您可以像这样枚举条形码类型（好的虚拟代码，您可能应该绑定到列表框/选择器但是..）：

```
var mgr = new BarcodeTypeManager();
foreach (var barCode in mgr.BarcodeTypes)
{  
  WP7BarcodeManager.ScanMode = barCode.BarcodeType;
} 
```

（事实上​​，`BarcodePhotoChooser`您还可以使用一个选择器。）

如果用户可以保存首选类型，您可以轻松地再次查找它：

```
var typeToUse = mgr.BarcodeTypes.Where(b => b.Name == "what user selected").FirstOrDefault();
WP7BarcodeManager.ScanMode = typeToUse.BarcodeType; 
```

# iphone - 编辑 UITableViewCell 并更改 textlabel

> ID：10813926
> 
> 赞同：2
> 
> 时间：2012-05-30T09:53:37.170
> 
> 标签：iphone, objective-c, xcode, uitableview

我想在 uitableview 中编辑、删除和重新排序单元格。我擅长删除和重新排序，但如何编辑单元格？

单击编辑按钮时，我想更改 cell.textLabel.text。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-31T07:03:05.720

**请参阅 mihiros 给出的答案非常正确。**

我也会建议这样做：

1.  单击单元格上的编辑按钮时，您可以删除或隐藏文本并将其替换为 textField 那里。

2.  在该字段中添加所需的文本，然后单击“确定”或完成从文本字段中获取文本并将其提供给**cell.textLabel.text**，然后取消隐藏标签（如果您在编辑时将其隐藏）。

**补充**：您还可以在单​​击写入 cell.textLabel.text 中的 Edit 按钮时将默认文本放在 Textfield 中。

# c++ - 向后读取文件？

> ID：10813930
> 
> 赞同：17
> 
> 时间：2012-05-30T09:53:41.253
> 
> 标签：c++

有没有一种方法可以逐行向后读取文件，而不必从头开始读取文件以开始向后读取？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-05-30T10:06:36.183

使用[内存映射文件](http://www.boost.org/doc/libs/1_41_0/libs/iostreams/doc/classes/mapped_file.html)并向后走。操作系统将以相反的顺序分页文件的所需部分。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-05-30T10:14:27.773

根据评论，一个可能的（非常简单的）替代方案是将这些行读入`vector`. 例如：

```
#include <iostream>
#include <fstream>
#include <string>
#include <vector>

int main()
{
    std::ifstream in("main.cpp");

    if (in.is_open())
    {
        std::vector<std::string> lines_in_reverse;
        std::string line;
        while (std::getline(in, line))
        {
            // Store the lines in reverse order.
            lines_in_reverse.insert(lines_in_reverse.begin(), line);
        }
    }
} 
```

编辑：

根据[jrok](https://stackoverflow.com/users/947836/jrok)和[Loki Astari](https://stackoverflow.com/users/14065/loki-astari)的评论，`push_back()`效率会更高，但行将按文件顺序排列，因此反向迭代 ( `reverse_iterator`) 或[`std::reverse()`](http://en.cppreference.com/w/cpp/algorithm/reverse)将是必要的：

```
 std::vector<std::string> lines_in_order;
    std::string line;
    while (std::getline(in, line))
    {
        lines_in_order.push_back(line);
    } 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-05-30T10:04:03.350

1.  打开文件进行读取，调用`fseek()`寻找文件末尾，然后调用`ftell()`获取文件的长度。`stat()`或者，您可以通过调用或获取文件长度`fstat()`

2.  将缓冲区指针分配给上面 #1 中获得的文件大小。

3.  将整个文件读入该缓冲区——您可能可以`fread()`一次性读取所有文件（假设文件足够小）。

4.  使用另一个 char 指针将文件从缓冲区的末尾横向移动到缓冲区的开头。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2016-01-17T10:08:41.827

稍微改进的版本是这样的：-
1）寻找最后一个位置
2）获取最后一个位置
3）读取一个字符并打印它；
4) 寻找 2 个 pos 回来；
5) 重复 3 &4`last-1`次；

```
 ifstream in;
    in.open("file.txt");
    char ch;
    int pos;
    in.seekg(-1,ios::end);
    pos=in.tellg();
    for(int i=0;i<pos;i++)
    {
        ch=in.get();
        cout<<ch;
        in.seekg(-2,ios::cur);
    }
    in.close(); 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2012-05-30T10:01:36.413

简短的回答是否定的。但是，您可以使用 seek() 函数将指针移动到您想去的地方。然后从那个点读取（）一些数据。如果你知道如何管理缓冲区，那么它应该很快，因为你可以读取和缓存数据，然后搜索前一个换行符。玩得开心 \r\n 这将被倒置......

-- 更新：对可能算法的一些阐述 --

这不是有效的代码，但它应该让您了解我在这里要说的内容

文件内容如下：

```
int fpos = in.size() - BUFSIZ;
char buf[BUFSIZ];
in.seek(fpos);
in.read(buf, BUFSIZ);
fpos -= BUFSIZ; // repeat until fpos < 0, although think of size % BUFSIZ != 0
// now buf has characters... reset buffer position
int bpos = BUFSIZ - 1; 
```

获取字符串：

```
// first time you need to call the read
if(bpos == -1) do_a_read();
// getting string
std::string s;
while(bpos >= 0 && buf[bpos] != '\n') {
  s.insert(0, 1, buf[bpos]);
  --bpos;
}
// if bpos == -1 and buf[0] != '\n' then you need to read another BUFSIZ chars
// and repeat the previous loop...

// before leaving, skip all '\n'
while(bpos >= 0 && buf[bpos] == '\n') {
  --bpos;
}
return s; 
```

为了简化 '\r'，您可以先将所有 '\r' 转换为 '\n'。否则，'\n' 的所有测试也需要测试'\r'。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2019-04-05T19:32:13.747

我的答案类似于使用 a`vector`来存储文件行的答案，但我会改为使用`list`.

假设您在名为 的文件中有以下文本`input.txt`：

```
hello
there
friend 
```

我会逐行阅读文件，不是将每一行推到我的后面，`list`而是推到它的前面。使用它而不是`push_back`与将文件的内容逐行读取到 a`vector`然后反转它或向后迭代它具有相同的效果。

```
#include <iostream>
#include <fstream>
#include <list>
#include <string>
#include <iterator>
#include <algorithm>

int main(void) {
    std::ifstream file;
    file.open("input.txt");
    // Make sure the file opened properly

    std::list<std::string> list;
    std::string buffer;
    while (std::getline(file, buffer)) {
        list.push_front(buffer);
    }

    file.close();

    std::copy(
        list.begin(),
        list.end(),
        std::ostream_iterator<std::string>(std::cout, "\n")
    );

    return 0;
} 
```

（请注意，底部的位`std::copy`只是打印列表的内容，并使用换行符作为元素之间的分隔符。）

然后打印：

```
friend
there
hello 
```

# android - 在 Android 中运行 JavaMOP 方面的异常

> ID：10813931
> 
> 赞同：0
> 
> 时间：2012-05-30T09:53:44.260
> 
> 标签：android, aspectj

我正在使用 Java 的 MOP 工具 ( [JavaMOP](http://fsl.cs.uiuc.edu/index.php/MOP) ) 来生成在 Android 中运行的方面。
我正在尝试使用 HasNext 示例，该示例仅指定程序始终在迭代器的下一个方法之前调用 hasext 方法。

使用 JavaMOP 生成方面的代码是：

```
package mop;
import java.io.*;
import java.util.*;
import javamoprt.*;
import java.lang.ref.*;
import org.aspectj.lang.*;

class HasNextMonitor_Set extends javamoprt.MOPSet {
    protected HasNextMonitor[] elementData;

    public HasNextMonitor_Set(){
        this.size = 0;
        this.elementData = new HasNextMonitor[4];
    }

    public final int size(){
        while(size > 0 && elementData[size-1].MOP_terminated) {
            elementData[--size] = null;
        }
        return size;
    }

    public final boolean add(MOPMonitor e){
        ensureCapacity();
        elementData[size++] = (HasNextMonitor)e;
        return true;
    }

    public final void endObject(int idnum){
        int numAlive = 0;
        for(int i = 0; i < size; i++){
            HasNextMonitor monitor = elementData[i];
            if(!monitor.MOP_terminated){
                monitor.endObject(idnum);
            }
            if(!monitor.MOP_terminated){
                elementData[numAlive++] = monitor;
            }
        }
        for(int i = numAlive; i < size; i++){
            elementData[i] = null;
        }
        size = numAlive;
    }

    public final boolean alive(){
        for(int i = 0; i < size; i++){
            MOPMonitor monitor = elementData[i];
            if(!monitor.MOP_terminated){
                return true;
            }
        }
        return false;
    }

    public final void endObjectAndClean(int idnum){
        int size = this.size;
        this.size = 0;
        for(int i = size - 1; i >= 0; i--){
            MOPMonitor monitor = elementData[i];
            if(monitor != null && !monitor.MOP_terminated){
                monitor.endObject(idnum);
            }
            elementData[i] = null;
        }
        elementData = null;
    }

    public final void ensureCapacity() {
        int oldCapacity = elementData.length;
        if (size + 1 > oldCapacity) {
            cleanup();
        }
        if (size + 1 > oldCapacity) {
            HasNextMonitor[] oldData = elementData;
            int newCapacity = (oldCapacity * 3) / 2 + 1;
            if (newCapacity < size + 1){
                newCapacity = size + 1;
            }
            elementData = Arrays.copyOf(oldData, newCapacity);
        }
    }

    public final void cleanup() {
        int numAlive = 0 ;
        for(int i = 0; i < size; i++){
            HasNextMonitor monitor = (HasNextMonitor)elementData[i];
            if(!monitor.MOP_terminated){
                elementData[numAlive] = monitor;
                numAlive++;
            }
        }
        for(int i = numAlive; i < size; i++){
            elementData[i] = null;
        }
        size = numAlive;
    }

    public final void event_hasnext(Iterator i) {
        int numAlive = 0 ;
        for(int i_1 = 0; i_1 < this.size; i_1++){
            HasNextMonitor monitor = (HasNextMonitor)this.elementData[i_1];
            if(!monitor.MOP_terminated){
                elementData[numAlive] = monitor;
                numAlive++;

                monitor.Prop_1_event_hasnext(i);
                if(monitor.Prop_1_Category_fail) {
                    monitor.Prop_1_handler_fail(i);
                }
            }
        }
        for(int i_1 = numAlive; i_1 < this.size; i_1++){
            this.elementData[i_1] = null;
        }
        size = numAlive;
    }

    public final void event_next(Iterator i) {
        int numAlive = 0 ;
        for(int i_1 = 0; i_1 < this.size; i_1++){
            HasNextMonitor monitor = (HasNextMonitor)this.elementData[i_1];
            if(!monitor.MOP_terminated){
                elementData[numAlive] = monitor;
                numAlive++;

                monitor.Prop_1_event_next(i);
                if(monitor.Prop_1_Category_fail) {
                    monitor.Prop_1_handler_fail(i);
                }
            }
        }
        for(int i_1 = numAlive; i_1 < this.size; i_1++){
            this.elementData[i_1] = null;
        }
        size = numAlive;
    }
}

class HasNextMonitor extends javamoprt.MOPMonitor implements Cloneable, javamoprt.MOPObject {
    public Object clone() {
        try {
            HasNextMonitor ret = (HasNextMonitor) super.clone();
            return ret;
        }
        catch (CloneNotSupportedException e) {
            throw new InternalError(e.toString());
        }
    }

    int Prop_1_state;
    static final int Prop_1_transition_hasnext[] = {1, 1, 2};;
    static final int Prop_1_transition_next[] = {2, 0, 2};;

    boolean Prop_1_Category_fail = false;

    public HasNextMonitor () {
        Prop_1_state = 0;

    }

    public final void Prop_1_event_hasnext(Iterator i) {
        MOP_lastevent = 0;

        Prop_1_state = Prop_1_transition_hasnext[Prop_1_state];
        Prop_1_Category_fail = Prop_1_state == 2;
    }

    public final void Prop_1_event_next(Iterator i) {
        MOP_lastevent = 1;

        Prop_1_state = Prop_1_transition_next[Prop_1_state];
        Prop_1_Category_fail = Prop_1_state == 2;
    }

    public final void Prop_1_handler_fail (Iterator i){
        {
            System.err.println("! hasNext() has not been called" + " before calling next() for an" + " iterator");
            this.reset();
        }

    }

    public final void reset() {
        MOP_lastevent = -1;
        Prop_1_state = 0;
        Prop_1_Category_fail = false;
    }

    public javamoprt.ref.MOPWeakReference MOPRef_i;

    //alive_parameters_0 = [Iterator i]
    public boolean alive_parameters_0 = true;

    public final void endObject(int idnum){
        switch(idnum){
            case 0:
            alive_parameters_0 = false;
            break;
        }
        switch(MOP_lastevent) {
            case -1:
            return;
            case 0:
            //hasnext
            //alive_i
            if(!(alive_parameters_0)){
                MOP_terminated = true;
                return;
            }
            break;

            case 1:
            //next
            //alive_i
            if(!(alive_parameters_0)){
                MOP_terminated = true;
                return;
            }
            break;

        }
        return;
    }

}

public aspect HasNextMonitorAspect implements javamoprt.MOPObject {
    javamoprt.map.MOPMapManager HasNextMapManager;
    public HasNextMonitorAspect(){
        HasNextMapManager = new javamoprt.map.MOPMapManager();
        HasNextMapManager.start();
    }

    // Declarations for the Lock
    static Object HasNext_MOPLock = new Object();

    static boolean HasNext_activated = false;

    // Declarations for Indexing Trees
    static javamoprt.map.MOPBasicRefMapOfMonitor HasNext_i_Map = new javamoprt.map.MOPBasicRefMapOfMonitor(0);
    static javamoprt.ref.MOPWeakReference HasNext_i_Map_cachekey_0 = javamoprt.map.MOPBasicRefMapOfMonitor.NULRef;
    static HasNextMonitor HasNext_i_Map_cachenode = null;

    // Trees for References
    static javamoprt.map.MOPRefMap HasNext_Iterator_RefMap = HasNext_i_Map;

    pointcut MOP_CommonPointCut() : !within(javamoprt.MOPObject+) && !adviceexecution();
    pointcut HasNext_hasnext(Iterator i) : (call(* Iterator.hasNext()) && target(i)) && MOP_CommonPointCut();
    after (Iterator i) : HasNext_hasnext(i) {
    try{
        HasNext_activated = true;
        synchronized(HasNext_MOPLock) {
            HasNextMonitor mainMonitor = null;
            javamoprt.map.MOPMap mainMap = null;
            javamoprt.ref.MOPWeakReference TempRef_i;

            // Cache Retrieval
            if (i == HasNext_i_Map_cachekey_0.get()) {
                TempRef_i = HasNext_i_Map_cachekey_0;

                mainMonitor = HasNext_i_Map_cachenode;
            } else {
                TempRef_i = HasNext_i_Map.getRef(i);
            }

            if (mainMonitor == null) {
                mainMap = HasNext_i_Map;
                mainMonitor = (HasNextMonitor)mainMap.getNode(TempRef_i);

                if (mainMonitor == null) {
                    mainMonitor = new HasNextMonitor();

                    mainMonitor.MOPRef_i = TempRef_i;

                    HasNext_i_Map.putNode(TempRef_i, mainMonitor);
                }

                HasNext_i_Map_cachekey_0 = TempRef_i;
                HasNext_i_Map_cachenode = mainMonitor;
            }

            mainMonitor.Prop_1_event_hasnext(i);
            if(mainMonitor.Prop_1_Category_fail) {
                mainMonitor.Prop_1_handler_fail(i);
            }
        }
        }catch(Exception e){
                    System.out.println("Cause: "+e.getCause().toString());
                    System.out.println("Error:"+e.getLocalizedMessage());
                }
    }

    pointcut HasNext_next(Iterator i) : (call(* Iterator.next()) && target(i)) && MOP_CommonPointCut();
    before (Iterator i) : HasNext_next(i) {
        try{
        HasNext_activated = true;
        synchronized(HasNext_MOPLock) {
            HasNextMonitor mainMonitor = null;
            javamoprt.map.MOPMap mainMap = null;
            javamoprt.ref.MOPWeakReference TempRef_i;

            // Cache Retrieval
            if (i == HasNext_i_Map_cachekey_0.get()) {
                TempRef_i = HasNext_i_Map_cachekey_0;

                mainMonitor = HasNext_i_Map_cachenode;
            } else {
                TempRef_i = HasNext_i_Map.getRef(i);
            }

            if (mainMonitor == null) {
                mainMap = HasNext_i_Map;
                mainMonitor = (HasNextMonitor)mainMap.getNode(TempRef_i);

                if (mainMonitor == null) {
                    mainMonitor = new HasNextMonitor();

                    mainMonitor.MOPRef_i = TempRef_i;

                    HasNext_i_Map.putNode(TempRef_i, mainMonitor);
                }

                HasNext_i_Map_cachekey_0 = TempRef_i;
                HasNext_i_Map_cachenode = mainMonitor;
            }

            mainMonitor.Prop_1_event_next(i);
            if(mainMonitor.Prop_1_Category_fail) {
                mainMonitor.Prop_1_handler_fail(i);
            }
        }
    }catch(Exception e){
                    System.out.println("Cause: "+e.getCause().toString());
                    System.out.println("Error:"+e.getLocalizedMessage());
                }
    }

    after(Iterator i) throwing (Exception e): HasNext_next(i) {
      System.out.println("Threw an exception: " + e);
      }
    after(Iterator i) throwing (Exception e): HasNext_hasnext(i) {
      System.out.println("Threw an exception: " + e);
      }

}

} 
```

我的Android项目中的方法是：

```
public void method1() {
        Vector<Integer> v = new Vector<Integer>();
        v.add(1);
        v.add(2);
        v.add(3);
        v.add(4);
        Iterator<Integer> i = v.iterator();
        int sum = 0;
        if (i.hasNext()) {
            sum += (Integer) i.next();
            sum += (Integer) i.next();
            sum += (Integer) i.next();
            sum += (Integer) i.next();
        }
        System.out.println("sum: " + sum);
} 
```

用切面编织Android项目并执行该方法后，应用程序抛出以下异常：

```
E/AndroidRuntime(2334): FATAL EXCEPTION: main
E/AndroidRuntime(2334): org.aspectj.lang.NoAspectBoundException: Exception while initializing mop_HasNextMonitorAspect: java.lang.ExceptionInInitializerError
E/AndroidRuntime(2334):     at mop.HasNextMonitorAspect.aspectOf(HasNextMonitorAspect.aj:1)
E/AndroidRuntime(2334):     at com.mopapplication.MOPApplicationActivity.method1(Unknown Source)
E/AndroidRuntime(2334):     at com.mopapplication.MOPApplicationActivity$3.onClick(Unknown Source)
E/AndroidRuntime(2334):     at android.view.View.performClick(View.java:3122)
E/AndroidRuntime(2334):     at android.view.View$PerformClick.run(View.java:11942)
E/AndroidRuntime(2334):     at android.os.Handler.handleCallback(Handler.java:587)
E/AndroidRuntime(2334):     at android.os.Handler.dispatchMessage(Handler.java:92)
E/AndroidRuntime(2334):     at android.os.Looper.loop(Looper.java:132)
E/AndroidRuntime(2334):     at android.app.ActivityThread.main(ActivityThread.java:4028)
E/AndroidRuntime(2334):     at java.lang.reflect.Method.invokeNative(Native Method)
E/AndroidRuntime(2334):     at java.lang.reflect.Method.invoke(Method.java:491)
E/AndroidRuntime(2334):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:844)
E/AndroidRuntime(2334):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:602)
E/AndroidRuntime(2334):     at dalvik.system.NativeStart.main(Native Method)
E/AndroidRuntime(2334): Caused by: java.lang.ExceptionInInitializerError
E/AndroidRuntime(2334):     at java.lang.management.ManagementFactory.getOperatingSystemMXBean(ManagementFactory.java:409)
E/AndroidRuntime(2334):     at javamoprt.map.MOPMapManager.<init>(Unknown Source)
E/AndroidRuntime(2334):     at mop.HasNextMonitorAspect.<init>(HasNextMonitorAspect.aj:231)
E/AndroidRuntime(2334):     at mop.HasNextMonitorAspect.ajc$postClinit(HasNextMonitorAspect.aj:1)
E/AndroidRuntime(2334):     at mop.HasNextMonitorAspect.<clinit>(HasNextMonitorAspect.aj:228)
E/AndroidRuntime(2334):     ... 13 more
E/AndroidRuntime(2334): Caused by: java.lang.UnsatisfiedLinkError: Couldn't load management: findLibrary returned null
E/AndroidRuntime(2334):     at java.lang.Runtime.loadLibrary(Runtime.java:425)
E/AndroidRuntime(2334):     at java.lang.System.loadLibrary(System.java:554)
E/AndroidRuntime(2334):     at sun.security.action.LoadLibraryAction.run(LoadLibraryAction.java:50)
E/AndroidRuntime(2334):     at java.security.AccessController.doPrivileged(AccessController.java:116)
E/AndroidRuntime(2334):     at java.security.AccessController.doPrivileged(AccessController.java:85)
E/AndroidRuntime(2334):     at sun.management.ManagementFactory.<clinit>(ManagementFactory.java:467)
E/AndroidRuntime(2334):     ... 18 more 
```

我知道这不是库的问题，因为我在 Android 项目中包含了 AspectJ、JavaMOP 和 Java 运行时库（对于 Java 运行时库，我只包含必要的类和包，而不是全部图书馆）。

知道有什么问题吗？

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-31T11:04:48.117

从堆栈跟踪我们可以读到您正在使用的库正在尝试加载“管理”库。该库包含在 sun（现在的 Oracle）jdk 中，但不是 android 的一部分。我猜你在android中使用这个lib不会有任何运气，因为它依赖于android中不包含的管理东西，比如SNMP。

# javascript - __doPostBack() 在下拉选择索引相同时不会被触发

> ID：10813934
> 
> 赞同：3
> 
> 时间：2012-05-30T09:53:50.570
> 
> 标签：javascript, asp.net, c#-4.0, dopostback

我有两个下拉列表 ddlCountry 和 ddlState 以及一个按钮提交。
虽然 ddlstate 在更新面板中。
在提交数据库中两个下拉存储的按钮值时。
我在中继器控件中显示数据。（在 HTML 表结构中）ASPX 代码

```
<table id="tablelist" class="csstablelist" cellspacing="1" cellpadding="1">
                    <tr>
                        <td class="csstablelisttoptr">
                            ddlCountryID
                        </td>
                        <td class="csstablelisttoptr">
                            ddlCountryText
                        </td>
                        <td class="csstablelisttoptr">
                            ddlstateText
                        </td>
                    </tr>
                    <asp:Repeater ID="repeaterList" runat="server" OnItemDataBound="repeaterList_ItemDataBound">
                        <ItemTemplate>
                            <tr onclick="selectRow(this);">
                                <td class="csstablelisttd" style="display: none">
                                    <asp:Label ID="ddlCountryID" runat="server" Text='<%#Eval("ddlCountryID")%>'></asp:Label>
                                </td>
                                <td class="csstablelisttd">
                                    <asp:Label ID="ddlCountryText" runat="server" Text='<%#Eval("ddlCountryText")%>'></asp:Label>
                                </td>
                                <td class="csstablelisttd">
                                    <asp:Label ID="ddlstateText" runat="server" Text='<%#Eval("ddlstateText")%>'></asp:Label>
                                </td>
                            </tr>
                        </ItemTemplate>
                    </asp:Repeater>
                </table>
<asp:DropDownList ID="ddlCountry" runat="server" CssClass="csstextbox" Width="207px" AutoPostBack="true" OnSelectedIndexChanged="ddlCountry_SelectedIndexChanged">
</asp:DropDownList>
<asp:UpdatePanel ID="updatePanelState" runat="server">
    <ContentTemplate>
        <asp:DropDownList ID="ddlState " runat="server" CssClass="csstextbox" Width="177px">
        </asp:DropDownList>
    </ContentTemplate>
    <Triggers>
        <asp:AsyncPostBackTrigger ControlID="ddlCountry" EventName="SelectedIndexChanged" />
    </Triggers>
</asp:UpdatePanel>
<asp:Button ID="btnSave" runat="server" Width="80px" OnClientClick="return validateForm();" Text="Save" CssClass="cssbutton" OnClick="btnSave_Click" />

ddlCountryID | ddlCountryText | ddlstateText
1            | USA            | XYZ
2            |India           | PQR 
```

我在下面写的 TR 的 Onclick (SelectRow(this)) 函数在 javascript 中突出显示转发器值和下拉值匹配并被选中。

```
<script type="text/javascript">
function selectRow(objTR)
{
 var ddlCountry =document.getElementById('<%=ddlCountry.ClientID %>');
 var ddlState =document.getElementById('<%=ddlState .ClientID %>');

    for (i = 0; i < ddlCountry .options.length; i++)
    {
        if (ddlCountry .options[i].text == objTR.cells[1].innerText.trim())
            break;
    }           
    ddlCountry .options[i].selected = true;

    __doPostBack(ddlCountry .id, objTR.cells[2].innerText.trim());    
}
</script> 
```

我在后面的代码中写了 ddlCountry SelectedIndexChangedEvent。

从 Javascript 我正在触发 __doPostBack() 并将 ddlCountry 作为事件目标 ddlStateText 作为事件参数传递给 SelectedIndexChangedEvent 并在这样的事件中获取值。

```
string stateDescription = Request["__EVENTARGUMENT"];
ddlState .Items.FindByText(stateDescription ).Selected = true;//for highliting the repeater value and dropdown value match and selected 
```

pageLoad上的绑定国家

```
 if(!Ispostback)
protected Void BindCountry()

{

strSQL = @"SELECT countryID,Country from Country_Master";
        DataTable dataTableCountry = null;
        dataTableCountry = objSqlDbComm.ExecuteDatasetQuery(strSQL).Tables[0];

        int countryID;
                string Country;     
        var dictioneryCountry = new Dictionary<int, string>();
        foreach(DataRow dr in dataTableCountry.Rows)
        {
            countryID = Convert.ToInt32(dr["countryID"]);
            Country= dr["Country"].ToString();          
            dictioneryCountry.Add(countryID,Country);
        }
        ddlCountry.Items.Clear();
        ddlCountry.DataTextField = "Value";
        ddlCountry.DataValueField = "Key";
        ddlCountry.DataSource = dictioneryCountry;
        ddlCountry.DataBind();
        ddlCountry.Items.Insert(0, new ListItem("[Select]", "-1"));
        ddlCountry.Items[0].Selected = true;
} 
```

我的问题是我是否有以下转发器数据。

```
ddlCountryID | ddlCountryText | ddlstateText
1            | USA            | XYZ
2            |India           | PQR
2            |India           | MNO 
```

当我选择具有国家印度和国家 mno 的第 3 行时，__dopostback() 方法被触发。

当我转到第 1 行时，__dopostback() 方法被触发。

当我从第 1 行到第 3 行时，方法是正确的触发方式，但是当从第 3 行到第 2 行具有相同的国家/地区 id 时，__dopostback() 方法不会触发并且未从 ddlstate 中选择状态。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-16T04:23:55.867

如果您调试代码，您将看到 __doPostBack() 确实在工作，因为 Page_Load 中的代码正在执行（尝试在此处设置断点进行检查）。问题是您的 DropDownList 的索引没有改变，因此 IndexChanged 事件不会被触发并且 ddlCountry_SelectedIndexChanged 永远不会运行。当您调用 __doPostBack() 时，这与从代码隐藏中手动调用 ddlCountry_SelectedIndexChanged 不同。

除了设置此下拉列表值之外，您是否有特殊原因会进行回发？

**解决方案 1**

我建议删除 __doPostBack() 行并添加以下内容：

```
var state = objTR.cells[2].innerText.trim();
for (var i = 0; i < ddlState.options.length; i++)
{
    if (ddlState.options[i].text == state)
    {
        ddlState.options[i].selected = true;
        break;
    }
} 
```

**解决方案 2**

或者，如果您真的必须回帖，您可以执行以下操作：

一种。在更新面板中添加一个隐藏按钮，如下所示：

```
<div style="display: none">
<asp:Button ID="btnState" OnClick="btnState_Click" runat="server" />
</div> 
```

湾。选择国家后更改您的 javascript 以执行以下操作：

```
document.getElementById('__EVENTARGUMENT').value = objTR.cells[2].innerText.trim();
document.getElementById('<%= btnState.ClientID %>').click(); 
```

C。创建一个 FilterState() 函数并从您的 ddlcountry indexchanged 事件中调用它

```
protected void ddlCountry_SelectedIndexChanged(object sender, EventArgs e)
{
    FilterState();
}

private void FilterState()
{
// insert whatever filtering code you had here
} 
```

d。添加您的 btnState_Click 函数（请注意，如果已选择项目，则之前设置 ddlState 的选定项目的方式会引发错误。）：

```
protected void btnState_Click(object sender, EventArgs e)
{
    FilterState();
    string state = Request["__EVENTARGUMENT"];
    if (state != "")
        ddlState.SelectedValue = state;
} 
```

**解决方案 3**

第三种解决方案将允许您仍然使用 __doPostBack，并通过将其放入 Page_Load 函数中来完全废弃 SelectedIndexChanged 事件：

```
if (IsPostBack && Request["__EVENTTARGET"] == ddlCountry.UniqueID)
{
    FilterState();
    string stateDescription = Request["__EVENTARGUMENT"];
    if (stateDescription != "")
        ddlState.SelectedValue = stateDescription;
} 
```

另一方面，对于您的 BindCountry 函数，没有真正的理由使用字典，您可以直接绑定 DataTable：

```
strSQL = @"SELECT countryID,Country from Country_Master";
DataTable dataTableCountry = objSqlDbComm.ExecuteDatasetQuery(strSQL).Tables[0];
ddlCountry.Items.Clear();
ddlCountry.DataSource = dataTableCountry;
ddlCountry.DataTextField = "Country";
ddlCountry.DataValueField = "countryID";
ddlCountry.DataBind();
ddlCountry.Items.Insert(0, new ListItem("[Select]", "-1"));
ddlCountry.Items[0].Selected = true; 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-05-30T10:18:18.133

这可能是因为您没有为 Text = "India" 的下拉列表绑定单独的值，因此服务器无法识别该值已更改，因此未处理 selectedindexchanged 事件。

尝试创建一个对印度文本具有不同价值的数据源，或者只使用一个印度文本

我可以清楚地看到印度的 listview 中有两个重复的记录，带有重复的键 (2)

不建议这样做。只使用一个应该具有唯一键的记录。

我可以理解您只有一个数据源，因此以这样一种方式修改您的代码，即在向 ddlCountry 添加项目时检查该项目是否已经存在或是否存在，只是不要再次添加它。替换 Bindcontry 代码中的后续代码，它应该可以正常工作。

```
 foreach(DataRow dr in dataTableCountry.Rows)
    {
        countryID = Convert.ToInt32(dr["countryID"]);
        Country= dr["Country"].ToString();

        if ( ! dictioneryCountry.Contains(countryID))
        {
           dictioneryCountry.Add(countryID,Country);
        }
    } 
```

让我知道它是否有效

# ruby-on-rails - 如何在我的 Rails 模型中获取当前 rake 任务的名称？

> ID：10813935
> 
> 赞同：9
> 
> 时间：2012-05-30T09:53:51.223
> 
> 标签：ruby-on-rails, rake, activemodel

我对支持 ActiveModel 缓存的 gem 之一有一些问题。当我将观察者用于缓存模型时，在应用程序初始化期间，它会尝试描述表以获取所有字段名称。

当 rake 任务运行时也会做同样的事情，包括 db:migration。在这种情况下，会出现一些循环引用错误。我想检测当前的 rake 任务，跳过 gem 初始化，但我不知道如何找出是通过 rake 任务调用的代码。如何检查？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-05-30T11:35:28.963

我不完全了解您要做什么，但这是获取任务名称的示例。

```
 task :testing do |task_name|
    puts task_name
  end 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2013-06-26T19:54:56.117

这个问题问了几个地方，我觉得没有一个答案很好……**我**认为答案是 check `Rake.application.top_level_tasks`，这是一个将要运行的任务列表。Rake 不一定只运行*一项*任务。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-30T11:54:23.997

如果您通过以下方式运行任务，`rake task`或者`bundle exec rake task`您可以通过以下方式在初始化程序中检查它：

```
if $0.end_with?('rake')
  # rake stuff
else
  # non-rake stuff
end 
```

如果你喜欢，你可以使用`$PROGRAM_NAME`代替。`$0`

# java - 如何将字符串转换为 iCalendar(ics) 对象？

> ID：10813937
> 
> 赞同：1
> 
> 时间：2012-05-30T09:53:58.110
> 
> 标签：java, icalendar, ical4j

我的任务是实现一种将通过 JSON 对象接收的字符串转换为 iCalendar 对象（ics）的方法。我找到了 iCal4j 库，并一直在尝试将其用作我的解析器。但是，CalendarBuilder 似乎需要一个 InputStream。

我该如何进行？

```
String response = jsonObj.getString("icalendar");

CalendarBuilder calBuiler = new CalendarBuilder();
Calendar calendar = calBuilder.build("???");
.... 
```

编辑：这会工作吗？

```
public Calendar convertStringtoCalendar(String arg)
{
    CalendarBuilder calBuiler = new CalendarBuilder();
    InputStream is;
    try {
        is = new ByteArrayInputStream(arg.getBytes("UTF-8"));
        return calBuiler.build(is);

    } catch (UnsupportedEncodingException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    } catch (IOException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    } catch (ParserException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    }

    return null;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-01T06:49:52.863

通过执行以下操作解决了问题。

```
public static Component getCalendarEvent(String myCalendarString) 
{
    try {
        StringReader sin = new StringReader(myCalendarString);
        CalendarBuilder builder = new CalendarBuilder();
        Calendar calendar = builder.build(sin);

        return (Component)calendar.getComponent("VEVENT");

    } catch (Exception e) {e.printStackTrace();}

    return null;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-11-03T01:47:38.097

我建议您尝试我的新 iCalendar API for Java，称为 iCalendarFx。它可以将字符串解析为任何日历元素 - VCALENDAR、VEVENT 等。

您可以在[http://jfxtras.org/上查看](http://jfxtras.org/)

您可以在[https://github.com/JFXtras/jfxtras/tree/8.0/jfxtras-icalendarfx下载它](https://github.com/JFXtras/jfxtras/tree/8.0/jfxtras-icalendarfx)

# c# - 使用 ASP.Net 在谷歌地图中定位和标记位置

> ID：10813938
> 
> 赞同：0
> 
> 时间：2012-05-30T09:54:02.737
> 
> 标签：c#, asp.net, .net, google-maps

我知道这样的问题已经被问过很多次了，但我的情况略有不同。我想要的是，我有南波士顿的 10 家书店地址。现在我想在 Google 地图上显示这 10 家书店在南波士顿的一个圆圈内。

见下图。它应该在 ASP.Net/C# - 3.5/4.0 中开发，如果一些托管代码可以用于相同的版本，我更愿意。

![在此处输入图像描述](../Images/02ee772ee784fa2c1aec2969fa3461f5.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-30T10:13:57.143

好吧，您可以使用谷歌地图 APIV3 在某个点和半径处绘制一个圆心。有关演示，请访问[Google Maps OverLays。](https://developers.google.com/maps/documentation/javascript/overlays#Circles)

如果您想显示圆圈中的所有标记，然后创建一些逻辑并设置圆圈的半径，在您的情况下，这将取决于书店在地图上的位置。因此，创建一个逻辑并处理您的书店的位置，然后根据需要设置圆心和半径。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-30T10:20:05.950

1.  声明一个新的[LatLngBounds](https://developers.google.com/maps/documentation/javascript/reference#LatLngBounds)对象
2.  遍历书店位置并使用绑定的`extend`方法将所有位置包括在绑定中。
3.  `getNorthEast`使用and`getSouthWest`方法得到边界的东北和西南点lat-lng 。
4.  [使用geometry.spherical](https://developers.google.com/maps/documentation/javascript/reference#spherical)`computeDistanceBetween`方法获取东北和西南之间的距离
5.  将距离除以 2 得到圆半径。
6.  使用`getCenter`边界的方法得到圆的中心。
7.  使用上面的半径和中心来绘制圆。

# css - 菜单子项悬停边框

> ID：10813939
> 
> 赞同：0
> 
> 时间：2012-05-30T09:54:21.370
> 
> 标签：css

在以下示例中 - 悬停在子元素上时是否可以保留顶级导航的边框？当悬停在其子项目上时，我想保留“关于我们”的黑色边框。*示例*：http: [//jsfiddle.net/6zKRC/2/](http://jsfiddle.net/6zKRC/2/)

**HTML**

```
<div class="navigation">
  <ul class="navigation fc">
   <li>
    <a href="/">Home</a>
   </li>
   <li class="">
    <a href="/about.aspx">About</a>
    <ul>
      <li>
        <a href="/about/sub-navigation-1.aspx">Sub Navigation 1</a>
      </li>
      <li>
        <a href="/about/sub-navigation-2.aspx">Sub Navigation 2</a>
      </li>
    </ul>
  </li>
 </ul>
</div>​ 
```

**CSS**

```
.navigation ul {
  font-family: Arial, Verdana;
  font-size: 14px;
  margin: 0;
  padding: 0;
  list-style: none;
}

.navigation ul li {
  display: block;
  position: relative;
  float: left;
}

.navigation li ul {
    display: none; 
}

.navigation ul li a {
  display: block;
  text-decoration: none;
  color: #000;
  font-weight:bold;
  padding: 5px 15px 5px 15px;
  white-space: nowrap;
}

.navigation ul li a:hover { 
  background: #CCC;
  color:black;
  border:solid 1px black;
  border-bottom:0;
}

.navigation li:hover ul {
  display: block;
  position: absolute;
  border:solid 1px black;
  border-top:0;
}

.navigation li:hover li {
  float: none;
  font-size: 11px;
}

.navigation li:hover a {
  background: #CCC; 
}

.navigation li:hover li a:hover {
  background: #CCC;
  border:0;
} 
```

​</p>

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-30T10:13:31.683

嗨，我对您的 css 进行了一些更改，请检查您更新的 css :-

**CSS**

```
.navigation ul {
  font-family: Arial, Verdana;
  font-size: 14px;
  margin: 0;
  padding: 0;
  list-style: none;
}

.navigation ul li {
  display: block;
  position: relative;
  float: left;
}
.navigation li ul {
    display: none; 
}
.navigation ul li a {
  display: block;
  text-decoration: none;
  color: #000;
  font-weight:bold;
  padding: 5px 15px 5px 15px;
  white-space: nowrap;
}
.navigation ul li:hover { 
  background: #CCC;
  color:black;
  border:solid 1px black;
  border-bottom:0;
}
.navigation li:hover ul {
  display: block;
  position: absolute;
  border:solid 1px black;
  border-top:0;
    left:-1px;
} 
.navigation li:hover ul li {
  float: none;
  font-size: 11px;
      background: #CCC; 

}
.navigation li:hover li:hover {
  background:#e6e6e6;
  border:0;
} 
```

**HTML**

```
<div class="navigation">
  <ul class="navigation fc">
   <li>
    <a href="/">Home</a>
   </li>
   <li class="">
    <a href="/about.aspx">About</a>
    <ul>
      <li>
        <a href="/about/sub-navigation-1.aspx">Sub Navigation 1</a>
      </li>
      <li>
        <a href="/about/sub-navigation-2.aspx">Sub Navigation 2</a>
      </li>
    </ul>
  </li>
 </ul>
</div>​ 
```

我希望你看这个：- [http://jsbin.com/uwemuy/5/edit](http://jsbin.com/uwemuy/5/edit)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-30T10:03:50.117

在css中更改如下

```
.navigation li:hover a {
     background: #CCC; 
     border:solid 1px black;
} 
```

见[http://jsfiddle.net/6zKRC/2/](http://jsfiddle.net/hemant1027/LtswV/)

# android - 蓝牙错误服务发现在android中失败

> ID：10813942
> 
> 赞同：2
> 
> 时间：2012-05-30T09:54:27.143
> 
> 标签：android

我 [从 Android Bluetooth Insecure Rfcomm](https://stackoverflow.com/questions/8515572/service-discovery-failed-from-android-bluetooth-insecure-rfcomm) private static final UUID MY_UUID = UUID.fromString("00001101-0000-1000-8000-00805F9B34FB"); 使用这个 UUID，我可以连接除 android 之外的其他手机（Bada、Blackberry）。下面是我从 android 示例中获得的代码 /

```
**
     * This thread runs while attempting to make an outgoing connection
     * with a device. It runs straight through; the connection either
     * succeeds or fails.
     */
    private class ConnectThread extends Thread 
    {
        private final BluetoothSocket mmSocket;
        private final BluetoothDevice mmDevice;
        BluetoothSocket tmp = null;
        public ConnectThread(BluetoothDevice device) 
        {
            mmDevice = device;

            // Get a BluetoothSocket for a connection with the
            // given BluetoothDevice
            try 
            {
                tmp = device.createRfcommSocketToServiceRecord(MY_UUID);
                Log.d(TAG, "tmp = "+tmp.toString());
            }
            catch (IOException e) 
            {
                Log.e(TAG, "create() failed", e);
            }
            mmSocket = tmp;
        }

        public void run()
        {
            Log.i(TAG, "BEGIN mConnectThread");
            setName("ConnectThread");

            // Always cancel discovery because it will slow down a connection
            mAdapter.cancelDiscovery();

            // Make a connection to the BluetoothSocket
            try
            {
                // This is a blocking call and will only return on a
                // successful connection or an exception
                Log.d(TAG, " before connecting mmsocket.connect()");
                mmSocket.connect();
                Log.d(TAG, " after connecting mmsocket.connect()");
            }
            catch (IOException e) 
            {
                Log.d(TAG, " before connectionFailed()");
                connectionFailed();
                Log.d(TAG, " after connectionFailed()");
                Log.d(TAG, "after connectiofailed exception is: "+ e.toString());
                // Close the socket
                try 
                {
                    mmSocket.close();
                } 
                catch (IOException e2) 
                {
                    Log.d(TAG, "unable to close() socket during connection failure: "+ e2.toString());
                }

//                // Start the service over to restart listening mode
//                BluetoothChatService.this.start();
                return;
            }

            // Reset the ConnectThread because we're done
            synchronized (BluetoothService.this)
            {
                mConnectThread = null;
            }
            Log.d(TAG, " before connected mmsocket and mmdevice");

            // Start the connected thread
            connected(mmSocket, mmDevice);
            Log.d(TAG, "after connected mmsocket and mmdevice");
        }

        public void cancel() {
            try {
                mmSocket.close();
            } catch (IOException e) {
                Log.e(TAG, "close() of connect socket failed", e);
            }
        }
    } 
```

我收到错误服务发现失败。我想配对 2 部安卓手机请帮忙！！！

# file - 使用 BATCH 脚本检查目录中是否存在任何类型的文件

> ID：10813943
> 
> 赞同：38
> 
> 时间：2012-05-30T09:54:27.077
> 
> 标签：file, batch-file, directory

你好我正在寻找一个批处理文件来检查给定文件夹中是否有任何类型的文件。

到目前为止，我已经尝试了以下

```
if EXIST FOLDERNAME\\*.* ( echo Files Exist ) ELSE ( echo "Empty" ) 
```

如果我知道文件扩展名（例如带有以下内容的 txt 文件），我可以让它工作

```
if EXIST FOLDERNAME\\*.txt ( echo Files Exist ) ELSE ( echo "Empty" ) 
```

谢谢您的帮助

* * *

## 回答 #1

> 赞同：54
> 
> 时间：2012-05-30T14:57:10.227

检查文件夹是否至少包含一个文件

```
>nul 2>nul dir /a-d "folderName\*" && (echo Files exist) || (echo No file found) 
```

检查文件夹或其任何后代是否包含至少一个文件

```
>nul 2>nul dir /a-d /s "folderName\*" && (echo Files exist) || (echo No file found) 
```

检查一个文件夹是否至少包含一个文件或文件夹。
*注意添加`/a`选项以启用隐藏和系统文件/文件夹的查找。*

```
dir /b /a "folderName\*" | >nul findstr "^" && (echo Files and/or Folders exist) || (echo No File or Folder found) 
```

检查一个文件夹是否至少包含一个文件夹

```
dir /b /ad "folderName\*" | >nul findstr "^" && (echo Folders exist) || (echo No folder found) 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2015-12-15T10:06:08.217

对于目录中的文件，您可以使用以下内容：

```
if exist *.csv echo "csv file found" 
```

或者

```
if not exist *.csv goto nofile 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2012-05-30T10:03:04.797

你可以用这个

```
@echo off
for /F %%i in ('dir /b "c:\test directory\*.*"') do (
   echo Folder is NON empty
   goto :EOF
)
echo Folder is empty or does not exist 
```

取自[这里](http://wishmesh.com/2009/07/batch-script-to-test-if-folder-directory-is-empty/)。

那应该做你需要的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-01-26T13:39:50.877

一个滚动你自己的功能。

是否支持递归与`2nd`开关。

此外，允许`;`接受的答案无法解决的文件名称虽然是一个很好的答案，但这将解决这个问题。

这个想法来自[https://ss64.com/nt/empty.html](https://ss64.com/nt/empty.html)

代码中的注释。

```
@echo off
title %~nx0
setlocal EnableDelayedExpansion
set dir=C:\Users\%username%\Desktop
title Echos folders and files in root directory...
call :FOLDER_FILE_CNT dir TRUE
echo !dir!
echo/ & pause & cls
::
:: FOLDER_FILE_CNT function by Ste
::
:: First Written:               2020.01.26
:: Posted on the thread here:   https://stackoverflow.com/q/10813943/8262102
:: Based on:                    https://ss64.com/nt/empty.html
::
:: Notes are that !%~1! will expand to the returned variable.
:: Syntax call: call :FOLDER_FILE_CNT "<path>" <BOOLEAN>
:: "<path>"   = Your path wrapped in quotes.
:: <BOOLEAN>  = Count files in sub directories (TRUE) or not (FALSE).
:: Returns a variable with a value of:
:: FALSE      = if directory doesn't exist.
:: 0-inf      = if there are files within the directory.
::
:FOLDER_FILE_CNT
if "%~1"=="" (
  echo Use this syntax: & echo call :FOLDER_FILE_CNT "<path>" ^<BOOLEAN^> & echo/ & goto :eof
  ) else if not "%~1"=="" (
  set count=0 & set msg= & set dirExists=
  if not exist "!%~1!" (set msg=FALSE)
  if exist "!%~1!" (
   if {%~2}=={TRUE} (
    >nul 2>nul dir /a-d /s "!%~1!\*" && (for /f "delims=;" %%A in ('dir "!%~1!" /a-d /b /s') do (set /a count+=1)) || (set /a count+=0)
    set msg=!count!
    )
   if {%~2}=={FALSE} (
    for /f "delims=;" %%A in ('dir "!%~1!" /a-d /b') do (set /a count+=1)
    set msg=!count!
    )
   )
  )
  set "%~1=!msg!" & goto :eof
  ) 
```

# internet-explorer-9 - IE9 根本不关心“X-UA-Compatible”元标记

> ID：10813947
> 
> 赞同：0
> 
> 时间：2012-05-30T09:54:38.823
> 
> 标签：internet-explorer-9, renderer, ie8-compatibility-mode

我在互联网上找不到任何关于此的信息，所以我在这里寻求帮助：

由于某些技术原因，我尝试强制 IE9 进入 IE8 呈现模式，使用以下元标记作为第一行之后的第一行`<head>`：

```
<meta content="IE=8" http-equiv="X-UA-Compatible"> 
```

出于某种原因，我们办公室的所有 IE9 都只是呈现 IE9 样式，无论我尝试什么。当我从 IE9 查看 DevTool (F12) 时，它显示 IE8 是“默认页面”，但它仍然坚持在 DevTools 中设置的渲染模式。没有办法影响它。我们甚至删除并重新安装了 IE9，因为我们认为一旦你使用 DevTool 设置渲染模式，IE9 就会永远坚持下去......

这与强制 IE9 进入任何其他模式的理由无关。在这种特殊情况下，它是我们的首选。

让我抓狂的是，IE9 应该根据我在那里读到的所有信息尊重元标记，但出于某种奇怪的原因，我们的 IE9 并不关心它。

有没有人知道什么可以阻止 IE9 表现得像 IE8？

最好的问候，罗马。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-08T15:37:50.573

在我看来，一切正常。如果 IE8 被标识为“默认页面”，但选择了 IE9，则浏览器可能会记住您在 IE9 中呈现的明确决定。只需手动选择“页面默认值”，浏览器就应该尊重它。

只要 IE8 被识别为页面默认值，一切都很好。只需告诉您的团队切换回该特定域/页面上的默认页面即可。IE 不会为谁可以设置文档模式而与您争吵。如果您之前从列表中选择了 IE9 标准，它将尊重这一点，即使页面的默认设置是其他的。

# .net - 使用 Al.exe 创建附属程序集

> ID：10813951
> 
> 赞同：1
> 
> 时间：2012-05-30T09:54:48.020
> 
> 标签：.net, localization, resources, satellite-assembly

我正在尝试使用 Al.exe 创建附属程序集。

要从`.ressources`文件创建程序集，我正在执行以下命令：

```
al.exe /c:<culture> /out:<output dll name> /embedresource: <name of the .resources file> /fileversion:3.1.5.0 /productv:3.1.5.0 /keyf:Key.snk 
```

**第一个问题：**

fileversion、productv 和 keyf 是否必须与我部署的应用程序的文件版本、产品版本和密钥相同？

**第二个问题：**

为什么当我将生成的 DLL 部署到 GAC 时，版本列变为 0.0.0.0 ？但是当我在 GAC 中查看它们的属性时，为什么文件版本和产品版本是正确的并且版本字段是 0.0.0.0？

非常感谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-31T11:46:41.210

**对问题 1 的回答：**

似乎文件版本、产品版本和密钥必须与部署的应用程序相同，否则卫星 Dll 将不可见，应用程序将使用默认资源 Dll。

**回答问题 2：**

版本为 0.0.0.0，因为这是`/v`使用 Al.exe 时的一个选项，除了文件和产品版本之外，还必须指定该选项。

**最佳方法：**

最好的方法是使用该`/template`选项而不是单独指定版本、文件版本和产品版本，以便新创建的程序集可以从应用程序程序集继承正确的清单。

# actionscript-3 - 将 AS3 中的位图数据旋转 180 度以进行导出

> ID：10813952
> 
> 赞同：4
> 
> 时间：2012-05-30T09:54:55.733
> 
> 标签：actionscript-3, flash, matrix, bitmap, bitmapdata

我在 AS3 闪存中有一个位图，我使用 base64 编码的 jpg 字符串将其发送到 javascript。

所有这些都很好。我需要发送按比例缩小并旋转 180 度的 img。缩放有效，但旋转无效。旋转永远不会发生。我知道我显然做错了，但不知道正确的方法。

所以基本上我只需要将图像旋转 180 度，所以当它被发送到 javascript 时它是颠倒的。

这是我的转换代码

```
var scaleFactor:int = 5;

var tempBitmap:BitmapData = new BitmapData(img.width/scaleFactor, img.height/scaleFactor);
var drawMatrix:Matrix = new Matrix(1/scaleFactor, 0, 0, 1 /scaleFactor );
drawMatrix.rotate(Math.PI); //180deg

tempBitmap.draw(img, drawMatrix); 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-30T11:25:56.083

我认为你需要在旋转后平移你的对象，否则它会被剪裁，所以你看不到它，我用 CS5 在舞台上的 MovieClip 中做了一个位图的例子。

```
import flash.display.Bitmap;
import flash.display.BitmapData;
import flash.display.MovieClip;

var scaleFactor:int = 1;

var tempBitmap:BitmapData = new BitmapData(img.width, img.height);

var rotationMatrix:Matrix = new Matrix();
rotationMatrix.rotate(Math.PI);
rotationMatrix.translate(img.width, img.height);

tempBitmap.draw(box_mc, rotationMatrix);
var output:Bitmap = new Bitmap(tempBitmap);

addChild(output); 
```

我没有弄乱缩放，我猜你可以自己做。我放在舞台上的那个在右边，绘制的bitmapData在舞台的左上角，并且正确地反转了。

**更新**

还可以根据下面的 32bitkid 评论查看[fl.motion.MatrixTransformer ！](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/fl/motion/MatrixTransformer.html#rotateAroundExternalPoint%28%29)

![在此处输入图像描述](../Images/4871046494696f07e2e388ec3df6f7dc.png)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-09-26T21:14:41.233

```
 /** flips individual blocks within a bitmap. Specifically used for doing sprite sheets. But I am sure you could find another use if you wanted.
     * @param   inBM
     * @param   spritePixelWidth
     * @param   spritePixelHeight
     * @param   inTransformType   :An enum from TransFiveConstants. Example: TransFiveConstants.VERTICAL_FLIP
     * @return  a bitmap data object where all the sprites within the sprite sheet bitmap have been rotated or transformed **/
    public static function makeTransformedCopyOfSpriteSheet(inSpriteSheet:BitmapData, spritePixelWidth:int, spritePixelHeight:int, inTransformType:int):BitmapData
    {
        //Do error check to make sure we evenly fit into the bitmap we are doing transforms on.
        CONFIG::debug{
            if ( (inSpriteSheet.width  % spritePixelWidth ) != 0) { throw new Error("input error: width  does not go in evenly! Fix it."); }
            if ( (inSpriteSheet.height % spritePixelHeight) != 0) { throw new Error("input error: height does not go in evenly! Fix it."); }
        }//CONFIG_debug

        //Calculate width and height in sprites of the inSpriteSheet.
        var widthInSprites :int = inSpriteSheet.width  / spritePixelWidth ;
        var heightInSprites:int = inSpriteSheet.height / spritePixelHeight;

        /** Bitmap that takes rectangle chunks out of inSpriteSheet, one at a time. **/
        var inBM:BitmapData = new BitmapData(spritePixelWidth, spritePixelHeight, true, 0x00);

        //Inlined copy of code in makeTransformedCopy
        ////////////////////////////////////////////////////////////////////
        var flipWidthHeight:Boolean = false;
        if (inTransformType == TransFiveConstants.ROTATE_NEG_90 ||
            inTransformType == TransFiveConstants.ROTATE_POS_90  )
        {
            flipWidthHeight = true;
        }
        var outWID:int = (flipWidthHeight ? inBM.height : inBM.width );
        var outHGT:int = (flipWidthHeight ? inBM.width  : inBM.height);
        ////////////////////////////////////////////////////////////////////

        /** Bitmap that is a [rotated||transformed] version of inputBitmap: **/
        var outBM:BitmapData = new BitmapData(outWID, outHGT, true, 0x00);

        var outputSpriteSheetWidth :int = outBM.width  * widthInSprites;
        var outputSpriteSheetHeight:int = outBM.height * heightInSprites;
        /** The output of this function **/
        var outputSpriteSheet      :BitmapData = new BitmapData(outputSpriteSheetWidth, outputSpriteSheetHeight, true, 0x00);

        //scan through the sheet with a rectangle and make all the transformed copies you need.
        //Every time you make a transformed chunk/copy, move it from the inSpriteSheet to the outputSpriteSheet

        /** Places the [rotated||transformed] chunk in correct spot on outputSpriteSheet **/
        var finalDestination:Point = new Point();

        var cookieCutter:Rectangle = new Rectangle();
        cookieCutter.width         = spritePixelWidth ;
        cookieCutter.height        = spritePixelHeight;
        for (var xx:int = 0; xx < widthInSprites ; ++xx){
        for (var yy:int = 0; yy < heightInSprites; ++yy){
            cookieCutter.x = xx * spritePixelWidth;
            cookieCutter.y = yy * spritePixelHeight;

            //Cut chunk out of main sprite sheet:
            inBM.copyPixels(inSpriteSheet, cookieCutter, ZZ, null, null, true);

            //Transform the chunk you cut out of the main sprite sheet:
            makeTransformedCopy(inBM, inTransformType, outBM);

            //Paste the transformed copy into the output sheet:
            finalDestination.x = xx * outBM.width; //if outBM is rotated, this width will NOT BE SAME AS spritePixelWidth
            finalDestination.y = yy * outBM.height;
            outputSpriteSheet.copyPixels(outBM, outBM.rect, finalDestination, null, null, true);
        }}//next [xx, yy]

        return outputSpriteSheet;
    }//makeTransformedCopyOfSpriteSheet

    /** Flips/Mirrors and Rotates using a 1D index scan remap. "transformUsingScanRemap"
     * 
     *  Meaning, I put data into a 1D array, then change my assumptions on the "scan order" ( left-right, then top-bottom is default convention),
     *  I can effectively rotate or transform the pixel input.
     * 
     *  All we have to do is pack the bitmap into a 1D array. (scanning left-right, top-to-bottom)
     *  And then convert it BACK to the 2D array using a different formula assuming the data is packed via a different scan order.
     * 
     *  EXAMPLE:
     *  If we change our assumption to assume it is left-right, then BOTTOM-to-top, and make a formula for mapping 1D indexes
     *  to 2D values based on that scan order assumption, we achieve a vertical flip.
     * 
      * @param  inBM            :Bitmap we are making a transformed copy of.
      * @param  inTransformType :The enum for the type of [transform||rotation] to use. For values check TransFiveConstants.as
      * @param  outputBitmap    :Supply this to OVERWRITE an existing bitmap instead of create a NEW bitmap for output.
      * @return a transformed or rotated bitmap **/
    public static function makeTransformedCopy(inBM:BitmapData, inTransformType:int, outputBitmap:BitmapData = null):BitmapData
    {
        //If the bitmap is being ROTATED, we will have to flip the output width and height.
        var flipWidthHeight:Boolean = false;
        if (inTransformType == TransFiveConstants.ROTATE_NEG_90 ||
            inTransformType == TransFiveConstants.ROTATE_POS_90  )
        {
            flipWidthHeight = true;
        }

        var outWID:int = (flipWidthHeight ? inBM.height : inBM.width );
        var outHGT:int = (flipWidthHeight ? inBM.width  : inBM.height);

        //You can supply a reference to the OUTPUT of this function if you are doing some type of batch processing
        //And want to avoid repetitively constructing new intermediary bitmaps:
        if (outputBitmap == null)
        {
            var outputBitmap:BitmapData = new BitmapData(outWID, outHGT, true, 0x00);
        }
        else
        {
            if (outputBitmap.width  != outWID) { ICU.error("Bad output bitmap supplied. Size is wrong."); }
            if (outputBitmap.height != outHGT) { ICU.error("Bad output bitmap supplied. Size is wrong."); }
        }

        /** Max x index when remapping 1D values. **/
        var maxXXX:int = outWID - 1;
        /** Max y index when remapping 1D values. **/
        var YYYmax:int = outHGT - 1;

        /** Number of full columns, using 1D scan order for this orientation. **/
        var fullColumns:int = 0;

        /** Number of full rows, using 1D scan order for orientation specified. **/
        var fullRows:int = 0; 

        /**What is left over after we have calculated the rows or collumns we have. **/
        var remainder:int = 0;

        var curPix:uint;
        var index:int = ( -1);
        var trans:IntPoint = new IntPoint();

        inBM.lock();
        outputBitmap.lock();
        for (var yy:int = 0; yy < inBM.height; yy++) {
        for (var xx:int = 0; xx < inBM.width ; xx++) {

            ++index;

            //using 1D index position, remap that to correct 2D position.
            //To do different transforms and rotations, simply change your assumptions on how we
            //map from 1D to 2D.
            //Standard 1D to 2D assumes scan lines go left-right, then top-bottom. Row by row.
            //2D to 1D formula for standard: 
            //1D = (Y * width) + X.
            //how many full widths you can get out of 1D == Y. Remainder == X.
            //2D.Y = (1D/width);
            //2D.X = 1D - (2D.Y * width);

            if (inTransformType == TransFiveConstants.NO_TRANSFORM)
            {                                               //[1][2] Assumed scan order   (AKA 1D to 2D Mapping)
                fullRows  = (index / outWID);               //[3][4] used to get full 
                remainder = index - (fullRows * outWID);    //[5][6] rows and remainder.

                trans.iy = fullRows;
                trans.ix = remainder;
            }else
            if (inTransformType == TransFiveConstants.VERTICAL_FLIP)
            {                                               //[5][6] Assumed scan order  (AKA 1D to 2D Mapping)
                fullRows  = (index / outWID);               //[3][4] used to get full 
                remainder = index - (fullRows * outWID);    //[1][2] rows and remainder.

                trans.iy = YYYmax - fullRows;
                trans.ix = remainder;
            }else
            if (inTransformType == TransFiveConstants.ROTATE_NEG_90)
            {                                                   //[2][4][6] Assumed scan order  (AKA 1D to 2D Mapping)
                fullColumns = (index / outHGT);                 //[1][3][5] used to get full rows and remainder.
                remainder   = index - (fullColumns * outHGT);    

                trans.ix = fullColumns;
                trans.iy = YYYmax - remainder;
            }else
            if (inTransformType == TransFiveConstants.ROTATE_POS_90)
            {                                                   //[5][3][1] Assumed scan order  (AKA 1D to 2D Mapping)
                fullColumns = (index / outHGT);                 //[6][4][2] used to get full rows and remainder.
                remainder   = index - (fullColumns * outHGT);    

                trans.ix = maxXXX - fullColumns;
                trans.iy = remainder;
            }else
            if (inTransformType == TransFiveConstants.FLOOR_MIRROR)
            {                                               //[2][1] Assumed scan order   (AKA 1D to 2D Mapping)
                fullRows  = (index / outWID);               //[4][3] used to get full 
                remainder = index - (fullRows * outWID);    //[6][5] rows and remainder.

                trans.iy = fullRows;
                trans.ix = maxXXX - remainder;
            }
            else
            {
                throw new Error("Transform type not recognized");
            }

            //Copy and paste the pixel now that we know where to put it:
            curPix = inBM.getPixel32(xx, yy);
            outputBitmap.setPixel32(trans.ix, trans.iy, curPix);

        }}//next [xx, yy]
        inBM.unlock();
        outputBitmap.unlock();

        return outputBitmap;
    }//transformUsingScanRemap 
```

# java - 在浏览器和 jvm 方面处理 ssl 证书的区别？

> ID：10813959
> 
> 赞同：0
> 
> 时间：2012-05-30T09:55:06.393
> 
> 标签：java, ssl, https

这是连接到 https 站点时浏览器处理 ssl 证书的方式

1.  当我在浏览器中键入[https://myDemoSite.com](https://myDemoSite.com)时，首先我的浏览器会从 myDemoSite.com 请求证书（由于 https），然后 myDemoSite 将该证书发送到浏览器

2.  一旦浏览器收到该证书，浏览器将检查它是否由经过验证的权威机构签名，如威瑞信

3.  如果第二步是，那么作为第三步，它检查证书问题是否与用户在浏览器中键入的 URL 相同

现在我通过 java 程序连接 https 站点说 HttpsConnectProg1。我的问题是程序 i.e HttpsConnectProg1 将如何处理这个由 https 站点连接颁发的证书（尽管这个 https 站点颁发的证书是经过验证的，即由经过验证的机构签名）。

**我刚刚尝试了一个连接到发布认证证书的 https 站点的小程序。我预计会出现一些错误，例如 sslhandshake 错误或证书错误（因为我没有在 $JAVA_HOME\jre\lib\security 文件夹中添加这个经过认证的证书），但令我惊讶的是，我没有收到任何错误。**

**现在重要的问题是 HttpsConnectProg1 是否检查浏览器完成的第 3 步，因为这是非常重要的一步？供您参考这里是**

```
 import java.io.IOException;
 import java.net.MalformedURLException;
 import java.net.URL;
 import java.net.URLConnection;
 import java.util.Properties;
 import javax.net.ssl.HostnameVerifier;
 import javax.net.ssl.HttpsURLConnection;
 import javax.net.ssl.SSLSession;

 public class ConnectToDemoSite {

/**
 * @param args
 */
public static void main(String[] args) {
    // TODO Auto-generated method stub

    String urlStr = "https://www.myDemoSite.com/demo1/";
    URL url;
    Properties reply = new Properties();
    try {
        url = new URL(urlStr);
        URLConnection conn = url.openConnection();
        if(conn instanceof HttpsURLConnection)
        {
        HttpsURLConnection conn1 = (HttpsURLConnection)url.openConnection();
            conn1.setHostnameVerifier(new HostnameVerifier()  
            {        
                public boolean verify(String hostname, SSLSession session)  
                {  
                    return true;  
                }  
            });  

        reply.load(conn1.getInputStream());
        }
        else 
        {
             conn = url.openConnection();
             reply.load(conn.getInputStream());
        }
    } catch (MalformedURLException e) {
       e.printStackTrace();
        e.printStackTrace();
    } catch (IOException e) {
        e.printStackTrace();
    }
    catch (Exception e) {
        e.printStackTrace();
    }
    System.out.println("reply is"+reply);

 }

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-30T10:14:43.093

当您使用 Java 连接到`https://`URI 时，它使用[Java 安全套接字扩展 (JSSE)](http://docs.oracle.com/javase/7/docs/technotes/guides/security/jsse/JSSERefGuide.html)（除非您真的想使用 SSL/TLS 的自定义实现，但这非常罕见）。

有多种方法可以调整信任管理（主要是使用自定义`TrustManager`），但否则它将使用一定数量的合理设置。

在您的示例中，将使用 default 验证证书，该证书`SSLContext`本身配置为 default `X509TrustManager`，并从中读取信任锚（请参阅[JSSE 参考指南的](http://docs.oracle.com/javase/7/docs/technotes/guides/security/jsse/JSSERefGuide.html#Customization)[*自定义*](http://docs.oracle.com/javase/7/docs/technotes/guides/security/jsse/JSSERefGuide.html#Customization)`cacerts`部分中的表格[](http://docs.oracle.com/javase/7/docs/technotes/guides/security/jsse/JSSERefGuide.html#Customization)*）。*

 *默认情况下，JRE 带有许多预信任的 CA 证书（如大多数浏览器或操作系统）`cacerts`，通常类似于您在浏览器中找到的证书。这是 JSSE 参考。指南说：

> 重要说明：JDK 在 /lib/security/cacerts 文件中附带了数量有限的受信任根证书。如 keytool 中所述，如果您将此文件用作信任库，则您有责任维护（即添加/删除）此文件中包含的证书。
> 
> 根据您联系的服务器的证书配置，您可能需要添加额外的根证书。从适当的供应商处获取所需的特定根证书。

如果证书是可信的，它会检查主机名是否对预期的 URL 有效。（请注意，检查的不是完整的 URL，而只是主机名。）

这些规则在[RFC 2818（HTTPS 规范）第 3.1 节](https://www.rfc-editor.org/rfc/rfc2818#section-3.1)中定义。（Java 7 还没有实现 RFC 6125，但规则非常相似，尤其是对于 HTTPS。）**编辑：**当连接建立时，`URLConnection`（和底层`SSLSession`）设置为服务器的主机名。简而言之，遵循 RFC 2818 中的规则，它会在证书的主题备用名称 (SAN) 扩展中查看服务器证书以查找 DNS 条目，以查看它是否与为连接设置的主机名匹配，或者查找该名称在证书的主题 DN 的公用名 (CN) 中，当不存在 SAN DNS 条目时。

主机名验证通常由默认主机名验证程序完成。在您的示例中，您已将默认验证器替换为始终返回的验证器`true`。因此，在您的情况下，此验证实际上不会发生，并且所有内容都将被接受（您这样做会引入安全漏洞）。

此外，在 Java 中完成的默认主机名验证比许多浏览器更严格地遵循 RFC 2818。特别是，它不[接受 CNs 中的 IP 地址](https://stackoverflow.com/a/8444863/372643)。

（出于与您应该使用始终返回 true 的主机名验证器相同的原因，您不应该使用不做任何事情的信任管理器，因为您会看到许多示例，它们为某些 SSL 提供了快速修复错误信息。）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2019-05-14T21:27:41.063

Java includes root certificates from well-known certificate authorities, so if you have a real certificate, it operates much like a browser.

If you sign your own certificate, a browser will warn you and provide a UI to enable use of the certificate in the future. This is where things diverge for a Java program—the right way to handle this depends entirely on the program you are writing, and there can't be a one-size-fits-all approach.

If your application has a UI, you could do something similar to what a browser does.

On the other hand, a "headless" application is usually pre-configured with the necessary root certificates.

In the end, both browsers and the Java PKIX validation libraries are maintaining the security of TLS by requiring you to provide or approve the root certificates on which authentication ultimately depend. Without trusted root certificates, it is impossible to authenticate a server, and thus impossible to ensure privacy or integrity of communications.*

# android - 缩放时谷歌地图的标记移动

> ID：10813963
> 
> 赞同：0
> 
> 时间：2012-05-30T09:55:24.327
> 
> 标签：android, google-maps, coordinates, google-maps-markers

我在地图上添加了一个标记，但是当我放大时它会向左移动（最大放大时它标记正确的位置），当我缩小时它会向右移动（最大缩小时它标记为 3000Km正确的地方）。

这是在 onCreate 之前绘制标记的类（图像是 62px wx 70px h）：

```
class MapOverlay extends com.google.android.maps.Overlay
    {
        @Override
        public boolean draw(Canvas canvas, MapView map, boolean shadow, long when) 
        {
            super.draw(canvas, map, shadow);                   

            Point screenPts = new Point();
            map.getProjection().toPixels(point, screenPts);

            Bitmap bmp = BitmapFactory.decodeResource(getResources(), R.drawable.mapmarker);            
            canvas.drawBitmap(bmp, screenPts.x + 50, screenPts.y - 70, null);         
            return true;
        }
    } 
```

这是我用来调用该类的代码：

```
 latitud = loc.getLatitude();
            longitud = loc.getLongitude();
            precision = loc.getAccuracy();

        controlMapa = map.getController();
        point = new GeoPoint((int) (latitud * 1E6), (int) (longitud * 1E6));

        controlMapa.animateTo(point);
        controlMapa.setZoom(17);

        MapOverlay mapOverlay = new MapOverlay();
        List<Overlay> listOfOverlays = map.getOverlays();
        listOfOverlays.clear();
        listOfOverlays.add(mapOverlay);

        map.invalidate(); 
```

有什么问题？每次缩放更改时，如何使它们移动到正确的点？

先感谢您！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-30T11:10:41.223

解决了！我只需要补充：

```
canvas.drawBitmap(bmp, screenPts.x - (bmp.getWidth() / 2), screenPts.y - bmp.getHeight(), new Paint()); 
```

代替：

```
canvas.drawBitmap(bmp, screenPts.x + 50, screenPts.y - 70, null); 
```

# mysql - MySql查询优化，用join替换not in subquery

> ID：10813966
> 
> 赞同：1
> 
> 时间：2012-05-30T09:55:35.377
> 
> 标签：mysql, subquery

我有一个查询，我觉得它非常庞大，可以进行优化。第一件事显然是用 join 替换 not in subquery ，但它会影响我拥有的子查询。我很感激有关它的建议/解决方法。

这是查询

```
SELECT *
FROM lastweeksales
WHERE productID =  1234
AND retailer NOT 
IN (
    SELECT retailer
    FROM sales
    WHERE productID
    IN (
        SELECT productID
        FROM products
        WHERE publisher = 123
    )
    AND DATE =  date(now())
) 
```

基本上，我想从上周的产品销售中获得行，其中零售商不存在今天进行销售但销售应该只针对某个出版商的产品。

:S:S:S

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-30T12:28:10.210

您可以通过轻松将 2 个内部子查询组合在一起`INNER JOIN`。对于外层，您应该使用`LEFT OUTER`join 然后 filter on `retailer IS NULL`，如下所示：

```
SELECT lws.*
  FROM lastweeksales lws
  LEFT JOIN (SELECT s.retailer 
               FROM sales s
               JOIN products p USING (productID)
              WHERE p.publisher = 123
                AND s.date = date(now())) AS r
         ON lws.retailer = r.retailer
 WHERE r.retailer IS NULL; 
```

# c# - 如何从 Web 服务返回多个字符串？

> ID：10813969
> 
> 赞同：1
> 
> 时间：2012-05-30T09:55:38.110
> 
> 标签：c#, asp.net, mysql, web-services

我已经使用 C# 和 MySQL 在 asp.net 中创建了 webservice。我想从此服务返回多个值。我正在使用以下代码：

```
[WebMethod]
public string RegisterUserViaFacebook(string fbid, string fbmailid,string devicetype)  
{
    string success = "Already Registered";
    string id="", name="";

    if (!ExistsFBID(fbid))
    {
        name = GenerateUserName();

        string password = generatePassword(10);

        string insertUser = "Insert into tbl_userinfo(UserName,Password,Facebook_ID,Facebook_EmailID,DeviceType) values";
        insertUser += "( '" + name + "' ,'" + password + "','" + fbid + "','" + fbmailid + "','" + devicetype + "' )";
        con = new MySqlConnection(conString);
        con.Open();
        MySqlCommand cmd = new MySqlCommand(insertUser, con);
        success = cmd.ExecuteNonQuery().ToString();
        con.Close();

        string getID = "SELECT UserID from tbl_userinfo where UserName='" + name + "'  ";
        con = new MySqlConnection(conString);
        con.Open();
        MySqlCommand cmd1 = new MySqlCommand(getID, con);
        id = cmd1.ExecuteScalar().ToString();
        con.Close();

        if (Convert.ToInt16(success) > 0)
        {
            SendMail(fbmailid, name, password);
            success = "New User"  ;
        }
        else
            success = "Error in Insertion";
    }
    else
    {
        string getID1 = "SELECT UserID, UserName from tbl_userinfo where Facebook_ID='" + fbid + "' ";
        con = new MySqlConnection(conString);
        con.Open();
        MySqlCommand cmd2 = new MySqlCommand(getID1, con);
        MySqlDataReader info = cmd2.ExecuteReader();

        while (info.Read())
        {
            id = info.GetString(0);
            name = info.GetString(1);

        }
        con.Close();
    }

    string jsonString = JsonConvert.SerializeObject(success);
    String finalString = "{\"USER IS\":";
    finalString += jsonString;
    finalString += "}";

    string jsonString1 = JsonConvert.SerializeObject(id);
    String finalString1 =finalString + "{\"ID IS\":";
    finalString1 += jsonString1;
    finalString1 += "}" ;

    string jsonString2 = JsonConvert.SerializeObject(name);
    String finalString2 = finalString1 + "{\"NAME IS\":";
    finalString2 += jsonString2;
    finalString2 += "}";
    return finalString2;

 } 
```

但它返回单个字符串中的所有值。我想将值单独返回为`Succeess`,`ID`和`Name`.

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-30T09:57:01.583

创建一个简单的类来保存成功、id 和名称并返回它的序列化实例。

```
public class RegistrationResult
{
   public string Success { get; set; }
   public string Name { get; set; }
   public int Id { get; set; }
} 
```

你可以这样做：

```
var result = new RegistrationResult { Success = success, Name = name, Id = id} ;
return JsonConvert.SerializeObject(success); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-30T10:04:04.287

您可能希望在 JSON 中返回单个对象。

```
return "{user: "+JsonConvert.SerializeObject(success)+", id: "+JsonConvert.SerializeObject(id)+", name: "+JsonConvert.SerializeObject(name)+"}"; 
```

Oded的回答也很好。它更清楚一点，但还需要一个额外的类。

# android - 在机器人中调用函数

> ID：10813970
> 
> 赞同：0
> 
> 时间：2012-05-30T09:55:39.087
> 
> 标签：android, robotium

robotium 如何调用在**测试类**中编写的**函数**。我在测试类中写了很多**函数。**我**不想**调用每个函数。我只是想在某些特定**条件下**调用一些函数。就像我们在编程语言中所做的那样。我该怎么做？我注意到即使我们没有调用在测试类中编写的每个函数都在执行。 *为什么会这样？*

 ******** * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-30T10:13:52.297

这不是机器人，而是测试框架。仪器测试运行器只是遍历类并调用测试类的所有公共方法。*******

# facebook - 分享时 Facebook 无法从我的网站元数据中正确获取图像

> ID：10813971
> 
> 赞同：0
> 
> 时间：2012-05-30T09:55:39.777
> 
> 标签：facebook, facebook-graph-api, facebook-like

我设置了 Facebook 元数据，让 Facebook 在共享时获取正确的数据。但是我在图像方面遇到了麻烦。我使用了 Facebook 的 url linter 工具，但我不知道错误在哪里：http: [//developers.facebook.com/tools/debug/og/object ?q=http%3A%2F%2Fwww.agendaburgos.com %2Fagenda%2Ffiesta-curpillos-parral.aspx](http://developers.facebook.com/tools/debug/og/object?q=http%3A%2F%2Fwww.agendaburgos.com%2Fagenda%2Ffiesta-curpillos-parral.aspx) 它显示的警告如下：该元数据的解析器结果与输入元数据不匹配。这很可能是由于数据以一种意外的方式排序、为一个属性提供了多个值而只期望一个值、或者给定属性的属性值不匹配造成的。以下是解析结果中未看到的输入属性 => 内容对：og:image:url =>[http://www.agendaburgos.com/Imagen.ashx?url=uploads%5ceventos%5cfiestas-del-curpillos-en-el-parral_5417.jpg&h=200&estirar=true](http://www.agendaburgos.com/Imagen.ashx?url=uploads%5ceventos%5cfiestas-del-curpillos-en-el-parral_5417.jpg&h=200&estirar=true)

来自 og:image 的链接是正确的，问题出在哪里？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-30T10:37:54.443

如果 Facebook 调试工具不喜欢您图像的 URL，则会出现此问题。您正在使用脚本来生成已上传图像的调整大小版本。尝试在标签中引用原始图像`og:image`，看看是否有帮助：

```
<meta property="og:image" content="http://www.agendaburgos.com/uploads/eventos/fiestas-del-curpillos-en-el-parral_5417.jpg" /> 
```

记得再次抓取页面以更新 Facebook 的缓存。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-30T10:46:42.653

我认为您收到此警告的原因可能是由于您使用 ASHX 处理程序构建图像 URL 的方式。

不要为动态调整大小而烦恼。Facebook 将在他们获得图像后处理该问题。只需将您的图片以全分辨率发送到 Facebook。

您还有一个问题是您没有明确定义 og:description 标记。如果可以，您应该将您的描述标签重复为 og:description。

# mysql - 系统崩溃后恢复mysql

> ID：10813975
> 
> 赞同：0
> 
> 时间：2012-05-30T09:55:44.150
> 
> 标签：mysql, mysqldump

我的 Windows 操作系统崩溃，但不知何故我保存了 mysql5.0 文件夹。

现在我想恢复我的数据和结构。这就是我在 mysql5 目录中的内容

![在此处输入图像描述](../Images/eff7a3d68fe400da79102a0118260757.png)

这是内部数据目录

![在此处输入图像描述](../Images/4b77706e5b9489763ff77c31c4bcae68.png)

在房地产文件夹内，我有所有表格 .frm 文件。请告诉我如何恢复数据和结构。谢谢

# android - 从 Android WebView 获取完整的 HTML 内容

> ID：10813980
> 
> 赞同：0
> 
> 时间：2012-05-30T09:56:04.980
> 
> 标签：android, html, webview, partial

我有一个 WebView，里面有一些网页。现在我想检索WebView 内部的**完整**HTML 内容。

我使用 loadUrl("javascript:...") 和 WebView 的 javascript 界面功能来检索此 HTML，使用如下内容：

*   document.getElementsByTagName('html')[0].innerHTML / outerHTML
*   document.documentElement.outerHTML
*   ...

在每种情况下，我都会收到**部分**HTML 内容——正好是前 10000 个字符！所以我的问题是 - 我如何获得**完整**的HTML 内容？它是特定于设备的吗，也许有解决方法？

顺便说一句，网页是用 javascript 动态创建的——我不能简单地从服务器下载文件。

此外，我尝试使用 console.log 在 javascript 中打印 HTML 内容，并发现完全相同的行为。

提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-30T13:45:23.850

我的错误 - 它与 javascript 无关，也与我测试的特定设备无关。

因此，简而言之，这些 js 属性中的任何一个都可以正常工作。

# django - 将 Django 移动到新服务器后图像丢失

> ID：10813983
> 
> 赞同：1
> 
> 时间：2012-05-30T09:56:34.163
> 
> 标签：django, migrate, syncdb

我正在将 Django 项目移动到新服务器。

我是 Django 的新手，我不知道应该在哪里上传文件夹。有应该在网站上显示的所有图像。在配置文件中，我没有看到我可以指定的上传文件夹，所以我猜它总是应该是 django 项目的相同位置，或者我找不到它。

位置保存在数据库中。当我将上传的文件放入媒体文件夹时，网址就像`domain.co.uk/media/upload/media/images/year/month/day/image_name.ext`旧网站上的一样，网站上的图像仍然丢失。

如果我手动输入 url，所有图像都可见，但 django 似乎看不到文件。

我还检查了 django 日志文件：

```
2012-05-30 09:13:33,393 ERROR render:  Thumbnail tag failed: [in /usr/lib/python2.6/site-packages/sorl_thumbnail-11.12-py2.6.egg/sorl/thumbnail/templatetags/thumbnail.py (line 49)]
Traceback (most recent call last):
  File "/usr/lib/python2.6/site-packages/sorl_thumbnail-11.12-py2.6.egg/sorl/thumbnail/templatetags/thumbnail.py", line 45, in render
    return self._render(context)
  File "/usr/lib/python2.6/site-packages/sorl_thumbnail-11.12-py2.6.egg/sorl/thumbnail/templatetags/thumbnail.py", line 97, in _render
    file_, geometry, **options
  File "/usr/lib/python2.6/site-packages/sorl_thumbnail-11.12-py2.6.egg/sorl/thumbnail/base.py", line 50, in get_thumbnail
    cached = default.kvstore.get(thumbnail)
  File "/usr/lib/python2.6/site-packages/sorl_thumbnail-11.12-py2.6.egg/sorl/thumbnail/kvstores/base.py", line 25, in get
    return self._get(image_file.key)
  File "/usr/lib/python2.6/site-packages/sorl_thumbnail-11.12-py2.6.egg/sorl/thumbnail/kvstores/base.py", line 123, in _get
    value = self._get_raw(add_prefix(key, identity))
  File "/usr/lib/python2.6/site-packages/sorl_thumbnail-11.12-py2.6.egg/sorl/thumbnail/kvstores/cached_db_kvstore.py", line 26, in _get_raw
    value = KVStoreModel.objects.get(key=key).value
  File "/usr/lib/python2.6/site-packages/django/db/models/manager.py", line 132, in get
    return self.get_query_set().get(*args, **kwargs)
  File "/usr/lib/python2.6/site-packages/django/db/models/query.py", line 344, in get
    num = len(clone)
  File "/usr/lib/python2.6/site-packages/django/db/models/query.py", line 82, in __len__
    self._result_cache = list(self.iterator())
  File "/usr/lib/python2.6/site-packages/django/db/models/query.py", line 273, in iterator
    for row in compiler.results_iter():
  File "/usr/lib/python2.6/site-packages/django/db/models/sql/compiler.py", line 680, in results_iter
    for rows in self.execute_sql(MULTI):
  File "/usr/lib/python2.6/site-packages/django/db/models/sql/compiler.py", line 735, in execute_sql
    cursor.execute(sql, params)
  File "/usr/lib/python2.6/site-packages/django/db/backends/util.py", line 34, in execute
    return self.cursor.execute(sql, params)
  File "/usr/lib/python2.6/site-packages/django/db/backends/mysql/base.py", line 86, in execute
    return self.cursor.execute(query, args)
  File "/usr/lib64/python2.6/site-packages/MySQLdb/cursors.py", line 174, in execute
    self.errorhandler(self, exc, value)
  File "/usr/lib64/python2.6/site-packages/MySQLdb/connections.py", line 36, in defaulterrorhandler
    raise errorclass, errorvalue
DatabaseError: (1146, "Table 'thumbnail_kvstore' doesn't exist")
2012-05-30 09:13:33,396 DEBUG execute:  (0.000) SELECT `freetext_freetext`.`id`, `freetext_freetext`.`key`, `freetext_freetext`.`content`, `freetext_freetext`.`active` FROM `freetext_freetext` WHERE (`freetext_freetext`.`active` = True  AND `freetext_freetext`.`key` = office-closed-message ); args=(True, u'office-closed-message') [in /usr/lib/python2.6/site-packages/django/db/backends/util.py (line 44)]
2012-05-30 09:13:33,399 DEBUG execute:  (0.000) SELECT `menus_menu`.`id`, `menus_menu`.`name`, `menus_menu`.`slug`, `menus_menu`.`base_url`, `menus_menu`.`description`, `menus_menu`.`enabled` FROM `menus_menu` WHERE (`menus_menu`.`enabled` = True  AND `menus_menu`.`slug` = about ); args=(True, u'about') [in /usr/lib/python2.6/site-packages/django/db/backends/util.py (line 44)]
2012-05-30 09:13:33,401 DEBUG execute:  (0.000) SELECT `menus_menuitem`.`id`, `menus_menuitem`.`menu_id`, `menus_menuitem`.`title`, `menus_menuitem`.`url`, `menus_menuitem`.`order` FROM `menus_menuitem` INNER JOIN `menus_menu` ON (`menus_menuitem`.`menu_id` = `menus_menu`.`id`) WHERE `menus_menu`.`slug` = about  ORDER BY `menus_menuitem`.`order` ASC; args=(u'about',) [in /usr/lib/python2.6/site-packages/django/db/backends/util.py (line 44)]
2012-05-30 09:13:33,404 DEBUG execute:  (0.000) SELECT `freetext_freetext`.`id`, `freetext_freetext`.`key`, `freetext_freetext`.`content`, `freetext_freetext`.`active` FROM `freetext_freetext` WHERE (`freetext_freetext`.`active` = True  AND `freetext_freetext`.`key` = contactdetails-footer ); args=(True, u'contactdetails-footer') [in /usr/lib/python2.6/site-packages/django/db/backends/util.py (line 44)] 
```

我检查了数据库并且没有表调用`thumbnail_kvstore`，但是我有数据库备份，并且在备份文件中该表不存在。

我得到的所有上传文件都在`media/uploads/media/`.

此外，我在某些页面上遇到错误：

```
Syntax error. Expected: ``thumbnail source geometry [key1=val1 key2=val2...] as var``
/usr/lib/python2.6/site-packages/sorl_thumbnail-11.12-py2.6.egg/sorl/thumbnail/templatetags/thumbnail.py in __init__, line 72
In template /var/www/vhosts/domain.co.uk/sites/apps/shop/products/templates/products/product_detail.html, error at line 34
{% thumbnail image.file "800x700" detail as zoom %} 
```

也许我安装的某些模块的版本不正确。不知道如何解决。

我正在使用 CentOS 6、mod_wsgi、apache、python 2.6。

**更新 1.0：**

在旧服务器上是 Django 1.3，在新服务器上是 Django 1.3.1

**更新 1.1：**

我想我知道问题出在哪里。我试过`python manage.py syncdb`了，这是输出：

```
Syncing...
Creating tables ...
The following content types are stale and need to be deleted:

    orders | ordercontact

Any objects related to these content types by a foreign key will also
be deleted. Are you sure you want to delete these content types?
If you're unsure, answer 'no'.

    Type 'yes' to continue, or 'no' to cancel: no
Installing custom SQL ...
Installing indexes ...
No fixtures found.

Synced:
 > django.contrib.auth
 > django.contrib.contenttypes
 > django.contrib.sessions
 > django.contrib.sites
 > django.contrib.messages
 > django.contrib.admin
 > django.contrib.admindocs
 > django.contrib.markup
 > django.contrib.sitemaps
 > django.contrib.redirects
 > django_filters
 > freetext
 > sorl.thumbnail
 > django_extensions
 > south
 > currencies
 > pagination
 > tagging
 > honeypot
 > core
 > faq
 > logentry
 > menus
 > news
 > shop
 > shop.cart
 > shop.orders

Not synced (use migrations):
 - dbtemplates
 - contactform
 - links
 - media
 - pages
 - popularity
 - testimonials
 - shop.brands
 - shop.collections
 - shop.discount
 - shop.pricing
 - shop.product_types
 - shop.products
 - shop.shipping
 - shop.tax
(use ./manage.py migrate to migrate these) 
```

接下来我运行`python manage.py migrate`，这就是我得到的：

```
Running migrations for dbtemplates:
 - Migrating forwards to 0002_auto__del_unique_template_name.
 > dbtemplates:0001_initial
 ! Error found during real run of migration! Aborting.

 ! Since you have a database that does not support running
 ! schema-altering statements in transactions, we have had
 ! to leave it in an interim state between migrations.

! You *might* be able to recover with:   = DROP TABLE `django_template` CASCADE; []
   = DROP TABLE `django_template_sites` CASCADE; []

 ! The South developers regret this has happened, and would
 ! like to gently persuade you to consider a slightly
 ! easier-to-deal-with DBMS.
 ! NOTE: The error which caused the migration to fail is further up.
Traceback (most recent call last):
  File "manage.py", line 13, in <module>
    execute_manager(settings)
  File "/usr/lib/python2.6/site-packages/django/core/management/__init__.py", line 438, in execute_manager
    utility.execute()
  File "/usr/lib/python2.6/site-packages/django/core/management/__init__.py", line 379, in execute
    self.fetch_command(subcommand).run_from_argv(self.argv)
  File "/usr/lib/python2.6/site-packages/django/core/management/base.py", line 191, in run_from_argv
    self.execute(*args, **options.__dict__)
  File "/usr/lib/python2.6/site-packages/django/core/management/base.py", line 220, in execute
    output = self.handle(*args, **options)
  File "/usr/lib/python2.6/site-packages/South-0.7.3-py2.6.egg/south/management/commands/migrate.py", line 105, in handle
    ignore_ghosts = ignore_ghosts,
  File "/usr/lib/python2.6/site-packages/South-0.7.3-py2.6.egg/south/migration/__init__.py", line 191, in migrate_app
    success = migrator.migrate_many(target, workplan, database)
  File "/usr/lib/python2.6/site-packages/South-0.7.3-py2.6.egg/south/migration/migrators.py", line 221, in migrate_many
    result = migrator.__class__.migrate_many(migrator, target, migrations, database)
  File "/usr/lib/python2.6/site-packages/South-0.7.3-py2.6.egg/south/migration/migrators.py", line 292, in migrate_many
    result = self.migrate(migration, database)
  File "/usr/lib/python2.6/site-packages/South-0.7.3-py2.6.egg/south/migration/migrators.py", line 125, in migrate
    result = self.run(migration)
  File "/usr/lib/python2.6/site-packages/South-0.7.3-py2.6.egg/south/migration/migrators.py", line 99, in run
    return self.run_migration(migration)
  File "/usr/lib/python2.6/site-packages/South-0.7.3-py2.6.egg/south/migration/migrators.py", line 81, in run_migration
    migration_function()
  File "/usr/lib/python2.6/site-packages/South-0.7.3-py2.6.egg/south/migration/migrators.py", line 57, in <lambda>
    return (lambda: direction(orm))
  File "/usr/lib/python2.6/site-packages/django_dbtemplates-1.3-py2.6.egg/dbtemplates/migrations/0001_initial.py", line 18, in forwards
    ('last_changed', self.gf('django.db.models.fields.DateTimeField')(default=datetime.datetime.now)),
  File "/usr/lib/python2.6/site-packages/South-0.7.3-py2.6.egg/south/db/generic.py", line 226, in create_table
    ', '.join([col for col in columns if col]),
  File "/usr/lib/python2.6/site-packages/South-0.7.3-py2.6.egg/south/db/generic.py", line 150, in execute
    cursor.execute(sql, params)
  File "/usr/lib/python2.6/site-packages/django/db/backends/util.py", line 34, in execute
    return self.cursor.execute(sql, params)
  File "/usr/lib/python2.6/site-packages/django/db/backends/mysql/base.py", line 86, in execute
    return self.cursor.execute(query, args)
  File "/usr/lib64/python2.6/site-packages/MySQLdb/cursors.py", line 174, in execute
    self.errorhandler(self, exc, value)
  File "/usr/lib64/python2.6/site-packages/MySQLdb/connections.py", line 36, in defaulterrorhandler
    raise errorclass, errorvalue
_mysql_exceptions.OperationalError: (1050, "Table 'django_template' already exists") 
```

我也跑了`python manage.py migrate --list`，而 uotput 是：

```
 dbtemplates
  (*) 0001_initial
  (*) 0002_auto__del_unique_template_name

 contactform
  (*) 0001_initial
  (*) 0002_auto__add_callback
  (*) 0003_auto__add_field_callback_notes
  (*) 0004_auto__add_field_callback_is_closed__add_field_callback_closed
  (*) 0005_auto__add_field_callback_url
  (*) 0006_auto__add_contact
  (*) 0007_auto__add_field_contact_category
  (*) 0008_auto__add_field_contact_url

 links
  (*) 0001_initial
  (*) 0002_auto__add_field_category_enabled__add_field_category_order

 media
  (*) 0001_initial
  (*) 0002_auto__del_field_image_external_url__add_field_image_link_url__del_fiel
  (*) 0003_add_model_FileAttachment
  (*) 0004_auto__chg_field_file_slug__chg_field_image_slug
  (*) 0005_auto__chg_field_image_file
  (*) 0006_auto__chg_field_file_file

 pages
  (*) 0001_initial
  (*) 0002_auto__chg_field_page_meta_description__chg_field_page_meta_title__chg_
  (*) 0003_auto__add_field_page_show_in_sitemap
  (*) 0004_auto__add_field_page_changefreq__add_field_page_priority

 popularity
  (*) 0001_initial

 testimonials
  (*) 0001_initial
  (*) 0002_auto__add_field_testimonial_is_featured

 brands
  (*) 0001_initial
  (*) 0002_auto__add_field_brand_template
  (*) 0003_auto__chg_field_brand_meta_description__chg_field_brand_meta_title__ch
  (*) 0004_auto__add_field_brand_url
  (*) 0005_auto__del_field_brand_image__add_field_brand_logo

 collections
  (*) 0001_initial
  (*) 0002_auto__add_field_collection_discount
  (*) 0003_auto__chg_field_collection_meta_description__chg_field_collection_meta
  (*) 0004_auto__add_field_collection_is_featured
  (*) 0005_auto__add_field_collection_order

 discount
  (*) 0001_initial
  (*) 0002_added_field_discount_description
  (*) 0003_auto__add_field_discountvoucher_automatic
  (*) 0004_auto__add_field_discountvoucher_collection
  (*) 0005_auto__del_field_discountvoucher_collection
  (*) 0006_auto__chg_field_discountvoucher_expiry_date

 pricing
  (*) 0001_initial
  (*) 0002_auto__add_pricingrule

 product_types
  (*) 0001_initial
  (*) 0002_auto__add_field_producttype_meta_title__add_field_producttype_meta_des
  (*) 0003_auto__add_field_producttype_summary__add_field_producttype_description

 products
  (*) 0001_initial
  (*) 0002_auto__del_field_product_is_featured
  (*) 0003_auto__chg_field_product_meta_keywords__chg_field_product_meta_descript
  (*) 0004_auto

 shipping
  (*) 0001_initial
  (*) 0002_auto__add_field_shippingmethod_includes_tax__add_field_shippingmethod_
  (*) 0003_auto__add_field_shippingmethod_order
  (*) 0004_auto__del_field_shippingmethod_tax_rate__del_field_shippingmethod_incl
  (*) 0005_auto__del_field_shippingrule_enabled

 tax
  (*) 0001_initial
  (*) 0002_auto__add_field_taxrate_internal_name
  (*) 0003_initial_internal_names
  (*) 0004_auto__add_unique_taxrate_internal_name
  (*) 0005_force_unique_taxrate_name
  (*) 0006_auto__add_unique_taxrate_name 
```

之后一些图像源是这样的：

```
 src="cache/1e/bd/1ebd719910aa843238028edd5fe49e71.jpg" 
```

但有些仍然是 src="" 甚至不显示`img`标签
另外我已经检查了数据库，并且`thumbnail_kvstore`已经创建了表。

any1 可以帮助我处理 syncdb 请求吗？

# java - 将非常大的日志文件的所有行插入 ms sql server 2008 时出现以下错误

> ID：10813984
> 
> 赞同：-3
> 
> 时间：2012-05-30T09:56:36.263
> 
> 标签：java, sql, sql-server, jdbc

**1.程序继续运行其他行，但此错误仅针对某些特定行。如果要插入 134789 行，则只插入大约 133666 行。所有行的格式与日志文件中的格式相同。**

```
 *com.microsoft.sqlserver.jdbc.SQLServerException: Incorrect syntax near the keyword 'In'.
            at com.microsoft.sqlserver.jdbc.SQLServerException.makeFromDatabaseError(SQLServerException.java:216)
            at com.microsoft.sqlserver.jdbc.SQLServerStatement.getNextResult(SQLServerStatement.java:1515)
            at com.microsoft.sqlserver.jdbc.SQLServerStatement.doExecuteStatement(SQLServerStatement.java:792)
            at com.microsoft.sqlserver.jdbc.SQLServerStatement$StmtExecCmd.doExecute(SQLServerStatement.java:689)
            at com.microsoft.sqlserver.jdbc.TDSCommand.execute(IOBuffer.java:5696)
            at com.microsoft.sqlserver.jdbc.SQLServerConnection.executeCommand(SQLServerConnection.java:1715)
            at com.microsoft.sqlserver.jdbc.SQLServerStatement.executeCommand(SQLServerStatement.java:180)
            at com.microsoft.sqlserver.jdbc.SQLServerStatement.executeStatement(SQLServerStatement.java:155)
            at com.microsoft.sqlserver.jdbc.SQLServerStatement.executeUpdate(SQLServerStatement.java:642)
            at Access.insertIntoDatabase(Access.java:186)
            at appWindowLog$1thread1.run(appWindowLog.java:233)
            at java.lang.Thread.run(Unknown Source)* 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-30T10:08:43.373

你知道，这是一个初学者级别的提示：

查找出错的 SQL 语句。

严重地。

在异常处理程序中，打印出 SQL 并查看问题所在。它将为您提供准确的 SQL。鉴于错误消息，您基本上有类似 SQL 注入的问题 - 字段中的某些内容需要转义，这是一个问题，因为您构建的语句不使用参数 (BAD BAD BAD)。

> 关键字“In”附近的语法不正确。

IN (not INTO) 不是出现在您的 INSERT INTO ... VALUES... 语法中的关键字，因此会出现一些问题。例如，包含 ' - 的字符串不应该发生，但是....好吧;) 显然它确实发生了。

当你找到它时，在谷歌中输入“SQL Injection”并了解它 - 运行相同的方法。你永远不会再像这样将 SQL 放在一起（或者当有人发现时应该被解雇）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-30T10:05:15.443

考虑使用[PreparedStatement](http://docs.oracle.com/javase/6/docs/api/java/sql/PreparedStatement.html)。您的日志行可能包含`'`会破坏您的插入语句的意外符号。如果您使用 PreparedStatement 它将以正确的方式转义参数。

# python - 具有 BSD 许可证的快速 Python min-cut 库

> ID：10813990
> 
> 赞同：1
> 
> 时间：2012-05-30T09:56:48.710
> 
> 标签：python, graph, cython, mathematical-optimization, max-flow

是否有一个快速的 cython/python 库来进行最大流量/最小切割计算（最好使用 Boykov-Kolmogorov），它具有 BSD 许可证？

轻量级 C 库也很有用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-30T10:23:11.283

有GPL 许可的[Graph-Tool或 MIT 许可](http://projects.skewed.de/graph-tool/)[的 Python-Graph](http://code.google.com/p/python-graph/)，具体取决于您可以使用的内容。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-30T10:00:11.990

[NetworkX](http://networkx.lanl.gov/)怎么样？查看他们[与流量相关的算法](http://networkx.lanl.gov/reference/algorithms.flow.html)。

许可证是 BSD

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2019-11-12T09:15:25.513

正如[这个答案](https://stackoverflow.com/a/58815407/5085211)中所详述的那样，它还包括一个简单的基准测试，SciPy（在 BSD-3 下获得许可）包括 1.4.0 的实现作为`scipy.sparse.csgraph.maximum_flow`.

# jquery - 添加下拉列表时的嵌套排序树问题

> ID：10813991
> 
> 赞同：0
> 
> 时间：2012-05-30T09:56:49.037
> 
> 标签：jquery, nested-sortable

我开发了一个可以正常工作的嵌套排序树。现在，我试图在每行末尾添加一个带有子菜单的按钮，但这会破坏 javascript 代码。我从控制台得到的错误是：

p 为空，item.left = p.left;

我在行尾添加的代码是：

```
 <span class="btn-tree btn-group">
      <button class="btn btn-mini" href="#">Edit</button>
      <button class="btn btn-mini dropdown-toggle"  data-toggle="dropdown">
         <span class="caret"></span>
      </button>
      <ol class="dropdown-menu no-nest">
        <li class="no-nest"><a href="/projects/pmnodes/61/edit">Edit</a></li>
        <li class="no-nest"><a href="/projects/pmnodes/61/move" class="fancyform">Move challenge</a></li>
        <li class="no-nest"><a href="/projects/pmnodes/61" data-confirm="Are you sure?" data-method="delete" rel="nofollow">Delete</a></li>
        <li class="no-nest"><a href="/projects/pmnodes/new?parent_id=61">New sub-challenge</a></li>
        <li class="no-nest"><a href="/projects/projectmilestones/68/edit?pmnode_id=25" class="fancyform">Request assistance</a></li>
        <li class="no-nest"><a href="/projects/pmnodes/61/duplicate" class="duplicate">Duplicate</a></li>
        <li class="no-nest"><a href="/projects/pmnodes/61/alias">Make alias</a></li>
      </ol>
</span> 
```

此按钮基于 twitter 引导框架。已添加无嵌套类，因为它不起作用（如果我删除它们，错误仍然存​​在）。

**更新：**

我在这里创建了一个可访问的测试页面：bivdev.herokuapp.com/projects/pmnodes/1 login:admin@birdseyeview.eu pwd: admin01 你能看一下吗？谢谢！

**更新 2**

我还尝试使用 sortable() 中可用的禁用选项，但它没有帮助。

我是这样做的：

在 nestedSortable 中添加取消回调：

```
cancel: ".disabled", 
```

然后我在我想要禁用的所有“li”标签中添加了一个“禁用”类。

怎么了？

谢谢，

尼古拉斯。

# java - 使用 Spring MVC 3.1+ WebApplicationInitializer 以编程方式配置 session-config 和 error-page

> ID：10813993
> 
> 赞同：21
> 
> 时间：2012-05-30T09:56:49.387
> 
> 标签：java, spring-mvc, servlet-3.0

[WebApplicationInitializer](http://static.springsource.org/spring/docs/3.1.x/javadoc-api/org/springframework/web/WebApplicationInitializer.html)提供了一种以编程方式表示标准 web.xml 文件的大部分内容的方法 - servlet、过滤器、侦听器。

但是我还没有找到一种使用 WebApplicationInitializer 来表示这些元素（会话超时、错误页面）的好方法，是否仍然需要为这些元素维护 web.xml？

```
<session-config>
    <session-timeout>30</session-timeout>
</session-config>

<error-page>
    <exception-type>java.lang.Exception</exception-type>
    <location>/uncaughtException</location>
</error-page>

<error-page>
    <error-code>404</error-code>
    <location>/resourceNotFound</location>
</error-page> 
```

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-05-30T10:57:35.930

我对这个主题做了一些研究，发现对于一些配置，比如 sessionTimeOut 和错误页面，你仍然需要 web.xml。

看看这个[链接](http://explodingjava.blogspot.in/2010/05/servlet-30-annotations.html)

希望这对您有所帮助。干杯。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-12-11T15:11:57.867

使用 spring-boot 非常简单。

我相信它也可以通过扩展[SpringServletContainerInitializer](http://docs.spring.io/spring/docs/3.1.0.M2/javadoc-api/org/springframework/web/SpringServletContainerInitializer.html)来完成，而无需弹簧启动。似乎这就是它专门设计的。

> Servlet 3.0 ServletContainerInitializer 旨在支持使用 Spring 的 WebApplicationInitializer SPI 对 servlet 容器进行基于代码的配置，而不是（或可能结合使用）传统的基于 web.xml 的方法。

示例代码（使用 SpringBootServletInitializer）

```
public class MyServletInitializer extends SpringBootServletInitializer {

    @Bean
    public EmbeddedServletContainerFactory servletContainer() {
        TomcatEmbeddedServletContainerFactory containerFactory = new TomcatEmbeddedServletContainerFactory(8080);

        // configure error pages
        containerFactory.getErrorPages().add(new ErrorPage(HttpStatus.UNAUTHORIZED, "/errors/401"));

        // configure session timeout
        containerFactory.setSessionTimeout(20);

        return containerFactory;
    }
} 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2015-06-18T07:22:26.573

实际上`WebApplicationInitializer`并没有直接提供。但是有一种方法可以使用 java 配置设置 sessointimeout。

您必须创建`HttpSessionListner`第一个：

```
import javax.servlet.http.HttpSessionEvent;
import javax.servlet.http.HttpSessionListener;

public class SessionListener implements HttpSessionListener {

    @Override
    public void sessionCreated(HttpSessionEvent se) {
        //here session will be invalidated by container within 30 mins 
        //if there isn't any activity by user
        se.getSession().setMaxInactiveInterval(1800);
    }

    @Override
    public void sessionDestroyed(HttpSessionEvent se) {
        System.out.println("Session destroyed");
    }
} 
```

在此之后，只需使用您的 servlet 上下文注册此侦听器，该上下文将在`WebApplicationInitializer`under 方法中可用`onStartup`

```
servletContext.addListener(SessionListener.class); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-08-25T17:58:56.977

扩展 BwithLove 注释，您可以使用异常和控制器方法（@ExceptionHandler）定义 404 错误页面：

1.  在 DispatcherServlet 中启用抛出**NoHandlerFoundException**。
2.  在控制器中使用**@ControllerAdvice**和**@ExceptionHandler**。

WebAppInitializer 类：

```
public class WebAppInitializer implements WebApplicationInitializer {
@Override
public void onStartup(ServletContext container) {
    DispatcherServlet dispatcherServlet = new DispatcherServlet(getContext());
    dispatcherServlet.setThrowExceptionIfNoHandlerFound(true);
    ServletRegistration.Dynamic registration = container.addServlet("dispatcher", dispatcherServlet);
    registration.setLoadOnStartup(1);
    registration.addMapping("/");
}

private AnnotationConfigWebApplicationContext getContext() {
    AnnotationConfigWebApplicationContext context = new AnnotationConfigWebApplicationContext();
    context.setConfigLocation("com.my.config");
    context.scan("com.my.controllers");
    return context;
}
} 
```

控制器类：

```
@Controller
@ControllerAdvice
public class MainController {

    @RequestMapping(value = "/")
    public String whenStart() {
        return "index";
    }

    @ExceptionHandler(NoHandlerFoundException.class)
    @ResponseStatus(value = HttpStatus.NOT_FOUND)
    public String requestHandlingNoHandlerFound(HttpServletRequest req, NoHandlerFoundException ex) {
        return "error404";
    }
} 
```

“error404”是一个 JSP 文件。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2015-12-11T10:05:02.320

在 web.xml 中

```
<session-config>
    <session-timeout>3</session-timeout>
</session-config>-->
<listener>
    <listenerclass>

  </listener-class>
</listener> 
```

监听类

```
public class ProductBidRollBackListener implements HttpSessionListener {

 @Override
 public void sessionCreated(HttpSessionEvent httpSessionEvent) {
    //To change body of implemented methods use File | Settings | File Templates.

 }

 @Override
 public void sessionDestroyed(HttpSessionEvent httpSessionEvent) {
    HttpSession session=httpSessionEvent.getSession();
    WebApplicationContext context = WebApplicationContextUtils.getWebApplicationContext(session.getServletContext());
    ProductService productService=(ProductService) context.getBean("productServiceImpl");
    Cart cart=(Cart)session.getAttribute("cart");
    if (cart!=null && cart.getCartItems()!=null && cart.getCartItems().size()>0){
        for (int i=0; i<cart.getCartItems().size();i++){
            CartItem cartItem=cart.getCartItems().get(i);
            if (cartItem.getProduct()!=null){
                Product product = productService.getProductById(cartItem.getProduct().getId(),"");
                int stock=product.getStock();
                product.setStock(stock+cartItem.getQuantity());
                product = productService.updateProduct(product);
            }
        }
    }
 }
} 
```

# php - php filemtime 24 小时格式

> ID：10813996
> 
> 赞同：4
> 
> 时间：2012-05-30T09:56:53.827
> 
> 标签：php, date, format

我创建了这段代码来获取文件最后一次被触摸的日期，然后以 AM/PM 格式显示给用户。

它似乎没有工作。我知道我很接近；我究竟做错了什么？

```
$filename = 'test.html';
if (file_exists($filename)) {
    $date = date(filemtime($filename));
    clearstatcache();
}
echo "- last updated: " . date('F d Y h:i A', strtotime($date)); 
```

输出：最后更新时间：1969 年 12 月 31 日 06:59 PM

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-30T10:00:11.793

尝试这个：

```
if (file_exists($filename)) {
    $date = filemtime($filename);
    clearstatcache();
}
echo "- last updated: " . date('F d Y h:i A', $date); 
```

在您的代码中，这一行：

```
$date = date(filemtime($filename)); 
```

不起作用，因为`filemtime`返回一个 UNIX 时间戳，然后您将其作为第一个参数传递给`date()`. 即使这确实有效，您也会将该日期转换回 UNIX 时间戳`strtotime()`，然后再次转换回日期字符串，这似乎有点低效。

还要考虑如果文件不存在会发生什么，是否会`$date`在您的代码中的其他地方设置？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-30T10:00:34.357

```
$date = date(filemtime($filename)); 
```

那条线是错误的。第一个参数`date()`是一个格式字符串。用。。。来代替：

```
$date = filemtime($filename); 
```

此外，您不需要`strtotime()`在时间戳上执行，只需按原样使用：

```
echo date('F d Y h:i A', $date); 
```

# regex - 使用正则表达式和路由的 URL 中的用户名

> ID：10813997
> 
> 赞同：0
> 
> 时间：2012-05-30T09:56:56.360
> 
> 标签：regex, cakephp, routes

我的用户控制器中有一个名为 的方法`view`，它应该显示指定的（通过 URL）用户：

```
public function view($username = null) {
    $this->User->username = $username;

    if (!$this->User->exists()) {
        throw new NotFoundException('Няма такъв потребител!');
    }

    if (!$username) {
        $this->Session->setFlash('Няма такъв потребител!');
        $this->redirect(array('action' => 'index'));
    }
    $this->set('user', $this->User->read());
} 
```

在路由配置中：

```
 Router::connect('/:username',   array('controller' => 'users', 'action'=> 'view'), array('username' => '^([a-z0-9])+$')); 
```

但是当我尝试时：`www.example.com/Username`它返回一个致命错误：缺少控制器。

我也试过这个：

```
Router::connect('/users/:username', array('controller' => 'users', 'action'=> 'view'), array('pass' => array('username'), 'username' => '^([a-z0-9])+$')); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-30T12:56:45.727

不幸的是，这种设置使用`/:username`太简单了，它几乎会覆盖所有其他路由。要有效地做到这一点（+ 正确的 CakePHP 方式），您需要设置一个自定义路由，[这是我的，它几乎可以实现相同的目标](https://github.com/Dunhamzzz/Consumer-Love/blob/master/Lib/ProductRoute.php)。在大多数情况下，只需将“产品”替换为“用户”，通读一遍，以确保您了解发生了什么......

如果您仍然无法解决，请查看我的路线配置。

如果您想将**/user/dunhamzz**路由到配置文件，您可以这样设置：

```
Router::connect('/user/:username',
    array('controller' => 'users', 'action' => 'view'),
    array('pass' => array('username')
); 
```

然后您的视图操作只需将用户名作为第一个参数：

```
public function view($username) {

} 
```

# mysql - Perl MySQL 错误 - 请调试

> ID：10813999
> 
> 赞同：-4
> 
> 时间：2012-05-30T09:57:11.633
> 
> 标签：mysql, perl

> 8,0,3,40,83,6,0,1,1)DBD::mysql::db do failed: You have an error in your SQL syntax; 查看与您的 MySQL 服务器版本相对应的手册，了解在 ':50:00,431.956,967.042,-5.27581,-0.489368 ,8.74281,9,0,10,0,0,0,0,0, 附近使用的正确语法0,0,12,0,14,0' at line 1 at monitor.pl line 187, line 1\. DBD::mysql::db do failed: 你的 SQL 语法有错误；检查与您的 MySQL 服务器版本相对应的手册，了解在 ':50:00,431.956,967.042,-5.27581,-0.489368,8.74281,9,0,10,0,0,0,0,0,0 附近使用的正确语法,0,12,0,14, 0' at line 1 at monitor.pl line 187, line 1\. 终止信号 SIGINT(2) 00,431.956,967.042,-5.27581,-0.489368 ,8.74281,9,0,10,0,0,0,0,0,0,0,12,0,14,0' 在第 1 行的 monitor.pl 第 187 行，第 1 行 DBD::mysql::db do failed: 你的 SQL 语法有错误；检查与您的 MySQL 服务器版本相对应的手册，了解在 ':50:00,431.956,967.042,-5.27581,-0.489368,8.74281,9,0,10,0,0,0,0,0,0 附近使用的正确语法,0,12,0,14, 0' at line 1 at monitor.pl line 187, line 1\. 终止信号 SIGINT(2) 00,431.956,967.042,-5.27581,-0.489368 ,8.74281,9,0,10,0,0,0,0,0,0,0,12,0,14,0' 在第 1 行的 monitor.pl 第 187 行，第 1 行 DBD::mysql::db do failed: 你的 SQL 语法有错误；检查与您的 MySQL 服务器版本相对应的手册，了解在 ':50:00,431.956,967.042,-5.27581,-0.489368,8.74281,9,0,10,0,0,0,0,0,0 附近使用的正确语法,0,12,0,14, 0' at line 1 at monitor.pl line 187, line 1\. 终止信号 SIGINT(2)

问候，

我不断收到上述 MySQL 错误。我根本无法深究。

我想我会问社区。

提前谢谢了，

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-30T09:59:15.730

引用`VALUES`子句中的常量。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-30T09:59:29.300

在查询中使用它们之前，您没有引用您的值。`2012-05-29T09:50:00`不是有效的 SQL 文字，并且需要用引号引起来，尽管您显然是在将时间戳插入名为 的列`1_1_windSpeed`中，这没有多大意义；我的猜测是您在某处忘记或放错了列。