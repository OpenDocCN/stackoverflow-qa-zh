# StackOverflow 问答 11783000-11783999

# c++ - GCC 报告对现有符号的未定义引用

> ID：11783000
> 
> 赞同：-1
> 
> 时间：2012-08-02T17:47:43.157
> 
> 标签：c++, linux, gcc, ld

这是我的链接命令行：

```
g++ -o verdox src/AIFactory.o src/AnimatedMesh.o src/BalanceStone.o src/Camera.o \
src/Card.o src/Caterpillar.o src/Character.o src/Collectable.o src/Concave.o \
src/Configuration.o src/Dynamic.o src/DynBall.o src/Enemy.o src/FixedLight.o \
src/FuzzyState.o src/Game.o src/GameInput.o src/GameUnit.o src/HUD.o src/Level.o \
src/LogicAttributes.o src/MainCharacter.o src/Main.o src/Menu.o src/MenuInput.o \
src/MeshStrider.o src/Object.o src/ObjectFactory.o src/OgreDebugDrawer.o \
src/OgreMusic.o src/OgreSoundEffect.o src/Projectile.o src/Scenery.o src/Shape.o \
src/SoftBody.o src/Trigger.o src/Utils.o src/Verdox.o src/Wasp.o src/World.o \
UFUG/libufug.a TinyXML/libtinyxml.a -L[...](lots of library dirs) \
-lboost_thread-mt -logg -lvorbis -lvorbisfile -lConvexDecomposition \
-lBulletSoftBody -lBulletDynamics -lBulletCollision -lLinearMath \
-lOgreMain -lpthread /usr/local/lib/OGRE/Plugin_OctreeZone.so \
/usr/local/lib/OGRE/Plugin_PCZSceneManager.so -Wl,-rpath,/usr/local/lib/OGRE \
-L/usr/local/lib -lOgreMain -lpthread -L/usr/local/lib -lCEGUIBase \
-L/usr/local/lib -lCEGUIOgreRenderer -lOgreMain -lpthread -lCEGUIBase -lsigc-2.0 \
-lopenal -lOIS 
```

我知道有一些重复，但我认为它应该没有害处，而且我不想在知道出了什么问题之前与构建系统抗争。

问题是我得到了一些未定义的引用：

```
src/Game.o: In function `Game':
/home/lucas/src/ufugames/verdox/src/Game.cpp:64: undefined reference to `Ogre::PCZPlugin::PCZPlugin()'
/home/lucas/src/ufugames/verdox/src/Game.cpp:64: undefined reference to `Ogre::OctreeZonePlugin::OctreeZonePlugin()'
src/Game.o: In function `~PCZPlugin':
/home/lucas/src/ufugames/ogre_src_v1-8-0/PlugIns/PCZSceneManager/include/OgrePCZPlugin.h:49: undefined reference to `vtable for Ogre::PCZPlugin'
src/Game.o: In function `~OctreeZonePlugin':
/home/lucas/src/ufugames/ogre_src_v1-8-0/PlugIns/OctreeZone/include/OgreOctreeZonePlugin.h:47: undefined reference to `vtable for Ogre::OctreeZonePlugin'
collect2: ld returned 1 exit status 
```

但是所有报告丢失的符号都在`Plugin_OctreeZone.so`and中找到`Plugin_PCZSceneManager.so`：

```
$ nm -C /usr/local/lib/OGRE/Plugin_PCZSceneManager.so | grep "Ogre::PCZPlugin::PCZPlugin()"
00029440 t Ogre::PCZPlugin::PCZPlugin()
00029440 t Ogre::PCZPlugin::PCZPlugin()

$ nm -C /usr/local/lib/OGRE/Plugin_PCZSceneManager.so | grep "vtable for Ogre::PCZPlugin"
00046e20 d vtable for Ogre::PCZPlugin

$ nm -C /usr/local/lib/OGRE/Plugin_OctreeZone.so | grep "Ogre::OctreeZonePlugin::OctreeZonePlugin()"
0000c350 t Ogre::OctreeZonePlugin::OctreeZonePlugin()
0000c350 t Ogre::OctreeZonePlugin::OctreeZonePlugin()

$ nm -C /usr/local/lib/OGRE/Plugin_OctreeZone.so | grep "vtable for Ogre::OctreeZonePlugin"
0000fe20 d vtable for Ogre::OctreeZonePlugin 
```

那么，为什么链接失败？我正在使用 GNU ld 2.21.53.20110810 和 GCC 4.6.1（一切都来自 Ubuntu 11.10）。

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-08-02T17:58:35.873

链接器命令中库的顺序很重要：http: [//www.network-theory.co.uk/docs/gccintro/gccintro_18.html](http://www.network-theory.co.uk/docs/gccintro/gccintro_18.html)

首先要做的是放在`-o verdox`命令的末尾。我之前也遇到过这个问题...然后看看是否还有错误。

# ruby - Ruby 删除数组的第一个索引

> ID：11783005
> 
> 赞同：6
> 
> 时间：2012-08-02T17:47:54.120
> 
> 标签：ruby, arrays

我有一个数组。我需要保留除索引 0 处的元素之外的所有内容。此时我的大脑被炸了。我整天都在编程。任何帮助都会很棒。谢谢！

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-08-02T17:50:07.897

使用该[`Array#shift`](http://www.ruby-doc.org/core-1.9.3/Array.html#method-i-shift)方法，它完全符合您的要求：

```
a = [1, 2, 3]
a.shift # => 1
a # => [2, 3] 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-08-02T17:49:45.697

您可以只使用数组索引切片：

```
some_array[1..-1] 
```

或者，如果你想永久修改一个变量，howsabout：

```
some_array = [1,2,3,4]
some_array.delete_at(0)
# => 1
some_array
# => [2,3,4] 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-01-08T04:19:19.723

切片怎么样！

> a = [“a”，“b”，“c”]
> 
> a.slice!(0) #=> "a"
> 
> a #=> ["b", "c"]

[http://www.ruby-doc.org/core-2.1.0/Array.html#method-i-slice-21](http://www.ruby-doc.org/core-2.1.0/Array.html#method-i-slice-21)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-12-25T10:57:50.880

根据如何处理结果（删除第一个元素的数组），有不同的方法来获取结果以及如何使用它可能会影响选择。

一种方法是将原始数组更改为新数组，并通过应用方法删除第一个元素，忽略该方法的结果并由于应用方法的副作用而实现所需的结果。OP 接受了这样做的答案（这意味着它在他的情况下有效）：

```
a = [ "a", "b", "c" ]
a.shift #=> "a"
a #=> ["b", "c"] 
```

如果您希望保留结果数组，这很有效，但您需要将一些方法放入现有方法链的中间，以便“摆脱第一个数组元素”。但是，在我的情况下，我有一个数组，其中第一个元素是由系统命令生成的标题行，然后是该命令的几行输出，每个数组元素中都有一个，并且正在修改这些行以达到我想要的结果意识到需要删除标题行，因为与其余行的形式不同，它没有被正确处理并且不需要。我的原始代码行看起来像这样（又`a`是数组）：

```
puts a.method1.method2.method3.method4 
```

我想这样做：

```
puts a.method1.method2.removeFirstElement.method3.method4 
```

一种通过使用来做到这一点的方法`slice`显示在一个不同的答案中，尽管不清楚在某些情况下它如何比接受的答案更好：

```
puts a.method1.method2.slice(1..-1).method3.method4 
```

如果我使用接受的答案，我将不得不做这样的事情：

```
temp = a.method1.method2
temp.shift
puts temp.method3.method4 
```

除了需要修改原始代码结构（尽管根据正在做的事情有利有弊），有必要创建一个新的临时对象（'temp'）来获得结果。

很高兴知道我们前进的方向通常会对如何到达那里产生明确的影响。

（我会注意到，我几乎更喜欢使用`slice!(0)`in 代替`shift`来实际更改数组，因为感叹号清楚地表明数组正在被更改；该`shift`方法不符合当前添加感叹号的建议到会改变对象的方法。但是，唉，我可能还是会使用它`shift`来避免混乱的`(0)`。）

# java - 使用来自另一个受信任域的 ID 使用 Java 在 Active Directory 中搜索

> ID：11783009
> 
> 赞同：2
> 
> 时间：2012-08-02T17:48:03.547
> 
> 标签：java, active-directory

我正在尝试使用受信任的 ID 和另一个域 (B.lmig.com) 在 Java 中的一个域 (A.domain.com) 中搜索 Active Directory 组的成员。我知道信任配置正确，因为我可以连接 id 并通过 ldp 和 ADUC 成功执行搜索。但是使用以下代码：

```
Hashtable<String, String> env = new Hashtable<String, String>();
env.put(Context.INITIAL_CONTEXT_FACTORY, "com.sun.jndi.ldap.LdapCtxFactory");
env.put(Context.PROVIDER_URL, "ldap://A.domain.com:389/");
env.put(Context.SECURITY_AUTHENTICATION, "simple");

env.put(Context.SECURITY_PRINCIPAL, "id@B.domain.com");
env.put(Context.SECURITY_CREDENTIALS, "*******");

env.put(Context.REFERRAL, "follow");
InitialLdapContext ctx = new InitialLdapContext(env, null);

String base = "DC=A,DC=domain,DC=com";

String filter = "(memberof=CN=grouptest,OU=someplace,OU=somewhere,OU=thegroups,DC=A,DC=domain,DC=com)";

SearchControls controls = new SearchControls();
controls.setSearchScope(SearchControls.SUBTREE_SCOPE);

NamingEnumeration<SearchResult> answer = ctx.search(base, filter, controls); 
```

导致以下异常，这似乎表明用户 id 不存在。

```
Exception in thread "main" javax.naming.AuthenticationException: [LDAP: error code 49 - 80090308: LdapErr: DSID-0C090334, comment: AcceptSecurityContext error, data 525, vece 
```

我的问题是是否有某个设置或我缺少的东西会告诉 Java 该 ID 位于“B.domain.com”域中，并且应该通过该域进行身份验证，同时在“A. domain.com”域名？因为我可以通过 LDP 和 ADUC 进行搜索，所以我必须缺少配置或引用错误的域或其他东西。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-02T18:26:31.827

LDAP 错误代码 49 是无效凭据。数据525表示没有这样的用户。

根据我的经验，`security_principal`通常是专有名称 (DN)，而不是电子邮件地址。

在我们的系统中，我们在 AD 中搜索电子邮件`(sAMAccountName=id@b.domain.com)`以获取`DN`. 然后`DN`用于`security_principal`。

# javascript - 用户滚动时在网页上绘制曲线

> ID：11783016
> 
> 赞同：8
> 
> 时间：2012-08-02T17:48:38.507
> 
> 标签：javascript, html, drawing, html5-canvas, parallax

我想知道是否可以在用户滚动时在网站上动态绘制曲线。我很确定它可以使用 HTML5 Canvas 和 bezierCurveTo() 方法来完成，但这只是立即将整个事情画出来。

这将用于使用 skrollr 库的视差网站。

有没有图书馆可以让这变得容易？

有什么建议么？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-08-03T08:05:34.217

skrollr 的创建者在这里。这是您提出的一个非常有趣的问题。你知道 skrollr 在嵌入式 SVG 上工作吗？

经过 30 分钟的搜索（起点：[如何逐步绘制矢量路径？（Raphael.js）](https://stackoverflow.com/questions/4631019/how-to-draw-a-vector-path-progressively-raphael-js)）我想出了以下官方 skrollr 演示：

[http://prinzhorn.github.com/skrollr/examples/path.html](http://prinzhorn.github.com/skrollr/examples/path.html)

是的，我很兴奋。

# c# - Microsoft.ACE.OLEDB.12.0 获取工作表名称

> ID：11783017
> 
> 赞同：5
> 
> 时间：2012-08-02T17:48:39.490
> 
> 标签：c#, asp.net, excel

我一直在寻找一种方法来获取我上传的电子表格中的第一个工作表名称。

现在，在使用 Jet 4 时，我发现了许多风格或代码，但我必须使用 Ace 12，而当我使用该驱动程序时，它永远不会得到有关电子表格的任何信息。有谁知道用 Ace 12 提取电子表格名称的好方法？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-08-02T17:53:33.913

由于所有工作表都作为表名列出，因此您可以使用[OleDbConnection.GetOleDbSchemaTable()](http://msdn.microsoft.com/en-us/library/system.data.oledb.oledbconnection.getoledbschematable.aspx)方法获取文件中所有工作表的列表。我不确定它们返回的顺序，但我希望它们按工作表顺序排列。

```
DataTable dt = conn.GetOleDbSchemaTable(System.Data.OleDb.OleDbSchemaGuid.Tables, null);
string workSheetName = (string)dt.Rows[0]["TABLE_NAME"]; 
```

# ruby-on-rails-3 - 耙太阳黑子：solr：开始不起作用

> ID：11783018
> 
> 赞同：0
> 
> 时间：2012-08-02T17:48:40.687
> 
> 标签：ruby-on-rails-3, rake, sunspot

我正在使用我的 Rails 应用程序，我正在尝试启动 Solr，但它一直告诉我我的 rake 已中止。这是我的终端中显示的内容：

`$bundle exec rake sunspot:solr:start
rake aborted!
dlopen(/Users/shui/.rvm/gems/ruby-1.9.2-p180@rails307/gems/mysql2-0.3.11/lib/mysql2/mysql2.bundle, 9): Library not loaded: libmysqlclient.18.dylib Referenced from: /Users/shui/.rvm/gems/ruby-1.9.2-p180@rails307/gems/mysql2-0.3.11/lib/mysql2/mysql2.bundle
Reason: image not found - /Users/shui/.rvm/gems/ruby-1.9.2-p180@rails307/gems/mysql2-0.3.11/lib/mysql2/mysql2.bundle`

我已经在我的 Rakefile 中添加了“require 'sunspot/rails/tasks'”和“require 'sunspot/solr/tasks'”，并按照[https://github.com/sunspot/sunspot/wiki/上的所有安装说明进行操作在 5 分钟或更短的时间内将太阳黑子搜索添加到 Rails](https://github.com/sunspot/sunspot/wiki/Adding-Sunspot-search-to-Rails-in-5-minutes-or-less)

我在 Mac OSX Lion 上运行，试图让 Sunspot 与 Rails 3 一起工作。有人知道我该如何解决这个问题吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-02T17:52:17.657

您的问题不在于太阳黑子，而在于`libmysqlclient.18.dylib`.

请参阅[Library not loaded: libmysqlclient.16.dylib error when trying to run 'rails server' on OS X 10.6 with mysql2 gem](https://stackoverflow.com/questions/4546698/library-not-loaded-libmysqlclient-16-dylib-error-when-trying-to-run-rails-serv)以获得解决方案！

只需确保您已安装 MySql 并且您在 Gemfile 中正确引用了 mysql gem，并且该捆绑包安装了正确的本机扩展。

# functional-programming - Common Lisp：编译与评估

> ID：11783022
> 
> 赞同：6
> 
> 时间：2012-08-02T17:48:55.070
> 
> 标签：functional-programming, lisp, common-lisp, sbcl

在带有 sbcl 的 Emacs + Slime 上，一旦我在文件中定义了一个函数（或更多），我有两个选择：

*   **评估**：例如使用 CMx eval-defun
*   **编译**：例如使用 Cc Mk 编译文件

第二个也生成一个 .fasl 文件。

**两者有什么区别？**

**当我编译定义/文件时，幕后发生了什么？**

**各有什么优缺点？**

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-03T05:29:41.880

首先，有一个函数`eval`[ [1](http://www.lispworks.com/documentation/lw50/CLHS/Body/f_eval.htm) ]，它允许在语言运行时评估（即执行）任意 CL 形式。CL 实现可能有 2 种不同的操作模式：编译模式和解释模式。编译模式意味着，在评估之前，表单首先在内存中编译。同样在 CL 评估中，不是在文件级别上进行，而是在单个表单级别上进行。所以`eval`可以编译和解释表单，这取决于操作模式。（例如，SBCL 默认总是编译，除非你通过设置`sb-ext:*evaluator-mode*`来指示它不要编译`:interpret`，而 CLISP 总是解释）。

现在，还有一个方便的函数`compile-file`[ [2](http://www.lispworks.com/documentation/lw51/CLHS/Body/f_cmp_fi.htm) ] 允许编译某个文件中的所有表单并将结果保存在另一个文件中。这**不会触发** 对这些表单的评估。

CL 还定义了程序生命周期的 3 个不同时间：编译时间、加载时间和执行时间。并且有可能控制使用最神秘的 CL 特殊运算符`eval-when`[ [3](http://www.lispworks.com/documentation/lw50/CLHS/Body/s_eval_w.htm) ] 之一时发生的情况。

综上所述，`C-M-x eval-defun`将调用`eval`光标下的表单。它不需要编译它，但这是可能的，具体取决于实现。`C-c M-k compile-file`将`compile-file`您的缓冲区，但不评估它的内容。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-03T00:25:35.920

也许一个比喻会更容易理解。

想象一下，你有一些**工作**要做，而有一个**工人**可以做。不幸的是，这个工人不懂你的语言。假设你说英语，而他只会法语。所以你需要**翻译**。好的，没问题，你也有翻译。在这里，您有 2 个选项：

1.  靠近工人，告诉翻译做什么，看看工人是怎么做的。
2.  要求翻译人员将任务写在纸上，然后在每次需要执行工作时将此纸交给工人。

如果您只需要完成一次工作，那么走哪条路没有太大区别。但是，如果您希望同一件事多次完成，并且可能由不同的工人（全是法国人）完成，您可能希望获得带有翻译说明的论文。

所以现在开始编程。你用一种语言（例如Common Lisp）编写程序，但计算机本身并不理解它。它只“说”它的内部语言——本机代码。所以你需要某种翻译。这就是编译器进入游戏的地方。编译器将您的代码翻译（编译）为本机代码，以便计算机可以执行它。

就像法国工人的例子一样，你有两个选择：

1.  告诉计算机**在需要时做什么**。在这种情况下，编译器将翻译指令，计算机将执行它们，两者都会立即忘记它。这称为**评估**。
2.  **将指令写入文件**，然后在每次需要时使用它来告诉计算机要做什么。这通常称为**编译**。

请注意*术语中的混乱*：实际上，编译器在这两种情况下都有效，但是当您比较评估和编译时，后者仅指第二种情况。在其他情况下，术语可能会有所不同，因此在阅读评估、编译、解释和一般翻译等内容时，请尝试理解基本过程。

另请注意，在 SBCL REPL 编译（写入文件）中具有评估的副作用。因此，在这种特定情况下，唯一的区别是写入文件。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-02T21:55:05.093

当你评估一个表达式时，实际发生的事情是它被发送到 sbcl，在那里你的表达式文本将被解析然后编译成本地代码，这些本地代码将存储在 Common Lisp 环境的内存中。

第二种方法将执行相同的操作，但将所有代码编译到文件中。您想要编译代码的原因是为了加快加载速度；无需解析代码的语法和语义并再次生成代码，只需将其加载到内存中即可运行。

所以编译的好处只是加载速度，节省了计算机工作。

在编辑已经编译的文件的情况下，您可以 eval-defun 仅在内存中重新创建函数，这可能比编译整个文件更快。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-02T23:24:16.720

这不是直接回答您的问题，但这对于评论来说也太长了。

大多数情况下，如果我们谈论 SLIME 和 Emacs，您不会喜欢使用任何一个选项 - 您会使用`C-c C-c`, (或`M-x slime-compile-defun`)。这将弹出（如果尚未打开）编译缓冲区，其中显示编译错误和警告+它将突出显示代码中的问题。这也适用于 Flymake 光标之类的东西（一旦您导航到有问题的区域，它将在 minibuffer 中显示究竟是什么问题）。

当您实际上有一个您想要稍后使用的产品时，编译文件很少发生。或者，最有可能的是，您希望其他人使用它而无需您进行设置。例如，如果您有一个 Web 服务器，并且您希望系统管理员能够根据需要（重新）启动它 - 管理员不需要知道您的软件如何运行，她只需要知道如何启动它.

评估一个 defun 就是这样 - 它将文本发送到 SWANK，但不分析结果。当然，你的 Lisp 会在你这样做之后打印一些东西给你，但 SLIME 会搁置一旁。

# pagination - 如何为以下 SQL 添加分页

> ID：11783023
> 
> 赞同：0
> 
> 时间：2012-08-02T17:49:00.517
> 
> 标签：pagination, sql-server-2008-r2

我有以下 SQL，我想知道如何分页：

我有变量`@skip`，`@top`所以我可以翻页..

```
SELECT ID FROM (
  SELECT COUNT(*) AS ID, -1 AS [Weight]
  FROM Employees i
    INNER JOIN #WeightedIDs w
    ON (i.ID = w.ID)
  WHERE (i.DepartmentID = 10 and i.ShiftID = 2)

  UNION ALL

  SELECT i.ID, w.[Weight]
  FROM Employees i
    INNER JOIN #WeightedIDs w
    ON (i.ID = w.ID)
  WHERE (i.DepartmentID = 10 and i.ShiftID = 2)
) x
ORDER BY x.[Weight] ASC 
```

**更新：**

我有以下内容，但它根本不起作用：

```
DECLARE @skip INT, @top INT
SET @skip = 30
SET @top = 100

;WITH PaginatedResults AS
(
  SELECT ID, w.[Weight],
    ROW_NUMBER() OVER (ORDER BY w.[Weight] ASC) AS RowNum
  FROM Employees i 
    INNER JOIN #WeightedIDs w 
    ON (i.ID = w.ID)  
  WHERE (i.DepartmentID = 10 and i.ShiftID = 2)
)
SELECT ID FROM (
  SELECT COUNT(*) AS ID, -1 AS [Weight]
  FROM Employees i 
    INNER JOIN #WeightedIDs w 
    ON (i.IssueID = w.id)  
  WHERE FlightID > 2 and IssueID > 0

  UNION ALL

  SELECT ID, [Weight]
  FROM PaginatedResults
  WHERE RowNum >= @skip AND RowNum < @skip + @top
) x
ORDER BY x.[Weight] ASC 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-02T17:51:44.090

此链接显示了 2008 年的一个不错的分页机制：

[相当于 SQL Server 的 LIMIT 和 OFFSET？](https://stackoverflow.com/questions/2135418/equivalent-of-limit-and-offset-for-sql-server)

在 SQL 2012 中，有 OFFSET 和 FETCH 关键字使得分页变得非常容易。

这个问题也应该适用：

[如何在 SQL Server 2008 中进行分页](https://stackoverflow.com/questions/2244322/how-to-do-pagination-in-sql-server-2008?rq=1)

# python - 有没有一种简单的方法可以让烧瓶中的会话超时？

> ID：11783025
> 
> 赞同：97
> 
> 时间：2012-08-02T17:49:19.067
> 
> 标签：python, session, timeout, flask

我正在用烧瓶建立一个网站，用户拥有帐户并能够登录。我正在使用烧瓶主体进行部分登录和角色管理。有没有办法让用户的会话在 5 分钟或 10 分钟后过期？我无法在烧瓶文档或烧瓶主体的文档中找到它。

我想到了一种手动操作的方法，在登录时设置一个带有时间标签的变量服务器端，在用户采取的下一个操作时，服务器验证该时间戳上的时间增量并删除会话。

* * *

## 回答 #1

> 赞同：140
> 
> 时间：2012-08-02T21:01:53.220

一旦你关闭浏览器，烧瓶会话就会过期，除非你有一个永久会话。您可以尝试以下方法：

```
from datetime import timedelta
from flask import session, app

@app.before_request
def make_session_permanent():
    session.permanent = True
    app.permanent_session_lifetime = timedelta(minutes=5) 
```

默认情况下，在 Flask 中，permanent_session_lifetime 设置为 31 天。

* * *

## 回答 #2

> 赞同：44
> 
> 时间：2018-04-18T05:12:00.383

是的，我们应该设置

```
session.permanent = True
app.permanent_session_lifetime = timedelta(minutes=5) 
```

但我认为它不应该设置为`app.before_request`，这将导致设置它们太多次。

这`permanent_session_lifetime`是一个[Basics Configuration](http://flask.pocoo.org/docs/0.12/config/#configuration-basics)，因此应该在您配置应用程序时进行设置：

```
 from datetime import timedelta
 app = Flask(__name__)
 app.config['SECRET_KEY'] = 'xxxxxxxxx'
 app.config['PERMANENT_SESSION_LIFETIME'] =  timedelta(minutes=5) 
```

为每个客户创建的`session`遗嘱，与其他客户分开。所以，我认为最好的设置位置`session.permanent`是当你`login()`：

```
@app.route('/login', methods=['GET', 'POST'])
def login():
    #After Verify the validity of username and password
    session.permanent = True 
```

# css - facebook的CSS浮动属性喜欢

> ID：11783031
> 
> 赞同：-1
> 
> 时间：2012-08-02T17:49:52.743
> 
> 标签：css, facebook-like

我只是一个初学者博客作者，我对CSS一无所知。也许有人可以给我 Facebook Like 按钮的正确 CSS 代码。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-02T17:57:16.770

涉及的人不少。例如：.button_count .like_button_dark .like_button_no_like .liketext, .button_count .connect_widget_like_button .liketext

找到一个like 按钮，右键单击，然后点击inspect 元素。您将能够看到所有涉及的 CSS 规则。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-02T17:51:37.993

[bam](http://developers.facebook.com/docs/reference/plugins/like/)到此为止，只需按照屏幕左侧的步骤操作（向下滚动一点）。你不需要任何 CSS，除非你想改变它的位置或外观。

# sql-server - SQL Server：查找即将到来的日期

> ID：11783034
> 
> 赞同：0
> 
> 时间：2012-08-02T17:50:02.377
> 
> 标签：sql-server, reporting-services

我有一个带有`Date`列的 SQL Server 数据库。这些日期都是未来的日期。

我将如何在 2 周的时间内找到所有临近的日期？基本上是关于即将到来的日期的两周通知查询。

例如：今天是 8 月 2 日。如果有的话，查询将返回 8 月 16 日（提前 2 周）的日期。

如果它明天运行，它将在 8 月 16 日和 8 月 17 日（提前 2 周）返回。

这显然会通过报告管理器 (SSRS) 每天运行。有任何想法吗？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-02T18:01:40.243

您可以使用[DATEADD](http://msdn.microsoft.com/en-us/library/ms186819.aspx)：

```
SELECT *
FROM MyTable
WHERE MyDateField BETWEEN GETDATE() AND DATEADD(week, 2, GETDATE()) 
```

如果您的列是`datetime`，您可能希望先将其转换为日期，否则在 8 月 1 日 12:00 运行此操作将返回 8 月 15 日 12:00 之前的所有内容。以下代码将为您执行此操作：

```
SELECT *
FROM MyTable
WHERE CAST(MyDateField AS date) BETWEEN CAST(GETDATE() AS date) AND CAST(DATEADD(week, 2, GETDATE()) AS date) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-02T17:58:28.280

```
SELECT * FROM mytable WHERE dateCol BETWEEN DATEADD(dd, 0, DATEDIFF(dd, 0, GETDATE())) AND 
    DATEADD(s, -1, DATEADD(d, 1, DATEADD(d, DATEDIFF(d, 0, DATEADD(wk, 2, GETDATE())), 0))) 
```

这将返回从今天开始到 2 周内一天结束之间的任何内容。

如果您尝试从今天起 2 周内返回单日 (00:00:00 > 23:59:59) 的任何记录，请使用

```
SELECT * FROM mytable WHERE dateCol BETWEEN DATEADD(dd, 0, DATEDIFF(dd, 0, DATEADD(wk, 2, GETDATE()))) AND 
    DATEADD(s, -1, DATEADD(d, 1, DATEADD(d, DATEDIFF(d, 0, DATEADD(wk, 2, GETDATE())), 0))) 
```

您可以替换`GETDATE()`为您想要开始/结束的任何日期。

# java - 如何使用 HttpClient 发送 post 请求

> ID：11783037
> 
> 赞同：0
> 
> 时间：2012-08-02T17:50:08.957
> 
> 标签：java, eclipse, httpclient

有谁知道我将如何使用带有 HttpClient 库的 Java Eclipse 中的发布请求来更新页面？目前这就是我所拥有的，但是当我执行它时，我得到一个找不到页面的错误：

```
public void update() {
    HttpClient httpclient = new DefaultHttpClient();
    HttpPost httppost = new HttpPost("http://examplepage.xml");
    try {
        // Add your data
        List<NameValuePair> nameValuePairs = new ArrayList<NameValuePair>(2);
        nameValuePairs.add(new BasicNameValuePair("_action", "<BasicPage><title>New Title</title></BasicPage>"));
        nameValuePairs.add(new BasicNameValuePair("_method", "post"));
        httppost.setEntity(new UrlEncodedFormEntity(nameValuePairs));
        // Execute HTTP Post Request
        HttpResponse response = httpclient.execute(httppost);
        HttpEntity entity = response.getEntity();
        String info = (""+EntityUtils.toString(entity));
        System.out.println(info);
        System.out.println(response.getEntity().getContent());
        System.out.println(response);
    } catch (ClientProtocolException e) {
        // TODO Auto-generated catch block
    } catch (IOException e) {
        // TODO Auto-generated catch block
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-02T17:57:39.090

你的代码看起来不错。检查页面 URI 或别名“examplepage.xml”是否实际存在或映射。还要检查它是否可以接受 POST 请求。

# visual-studio - 无法打开项目“MyProject.csproj”。不支持项目输出类型

> ID：11783040
> 
> 赞同：1
> 
> 时间：2012-08-02T17:50:32.947
> 
> 标签：visual-studio, expression-blend, visual-studio-2012

我正在尝试在 win7 的 Blend for VS 2012 中打开一个项目。那时（当它工作时）和现在（当它不工作时）之间唯一发生的变化是 Visual Studio 的更新。

关于如何解决这个问题的任何想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-02T18:07:10.907

Blend for Visual Studio 2012 RC 仅支持 Windows 8 Metro 风格项目，只能在 Windows 8 上构建。不支持 WPF 和 Silverlight。

# jsf - 来自 onChange 的 JSF 操作

> ID：11783043
> 
> 赞同：7
> 
> 时间：2012-08-02T17:50:34.743
> 
> 标签：jsf, input, onchange

我正在尝试使用 JSF 设置一个数据表，其中包含行总数框，该框将汇总行中任何框的行总数 onChange。该行看起来像：

```
<tr id="input_row_1">
<td id="mondayInput1">
    <h:inputText id="monday1" size="4" value="#{timesheet.monday1}" required="false" />
    <!-- <input name="monday1" class="smallInput" type="number" size="2" maxlength="4" min="0"/> -->
</td>
<td id="tuesdayInput1">
    <h:inputText id="tuesday1" size="4" value="#{timesheet.tuesday1}" required="false" />
    <!--<input name="tuesday1" class="smallInput" type="number" size="2" maxlength="4" min="0"/> -->
</td>
<td id="wednesdayInput1">
    <h:inputText id="wednesday1" size="4" value="#{timesheet.wednesday1}" required="false" />
    <!--<input name="wednesday1" class="smallInput" type="number" size="2" maxlength="4" min="0"/> -->
</td>
<td id="thursdayInput1">
    <h:inputText id="thursday1" size="4" value="#{timesheet.thursday1}" required="false" />
    <!--<input name="thursday1" class="smallInput" type="number" size="2" maxlength="4" min="0"/> -->
</td>
<td id="fridayInput1">
    <h:inputText id="friday1" size="4" value="#{timesheet.friday1}" required="false" />
    <!--<input name="friday1" class="smallInput" type="number" size="2" maxlength="4" min="0"/> -->
</td>
<td id="saturdayInput1">
    <h:inputText id="saturday1" size="4" value="#{timesheet.saturday1}" required="false" />
    <!--<input name="saturday1" class="smallInput" type="number" size="2" maxlength="4" min="0"/> -->
</td>
<td id="sundayInput1">
    <h:inputText id="sunday1" size="4" value="#{timesheet.sunday1}" required="false" />
    <!--<input name="sunday1" class="smallInput" type="number" size="2" maxlength="4" min="0"/> -->
</td>
<td>
    <h:inputText id="total1" size="4" value="#{timesheet.total1}" required="false" />
    <!-- <input name="total1" id="total1" type="text" size="5" readonly="readonly" /> -->
</td> 
```

所以我首先尝试添加`onChange="#{timesheet.setTotal1}"`到 day 条目，但 onChange 事件调用 javascript，而不是 java / JSF 代码。有人可以帮助更新总数吗？

编辑：我已经接受了 BalusC 的回答，但还需要`event`在标签中包含属性以`<f:ajax>`使其正常工作，就像这样

```
<h:inputText id="friday1" size="4" value="#{timesheet.friday1}" maxlength="4" required="false" >
    <f:ajax event="change" render="total1" listener="#{timesheet.updateTotal1}" />
</h:inputText> 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-02T18:30:30.827

实际上，该`onchange`属性只是被视为纯文本 HTML 属性，它应该代表一个 JavaScript`onchange`处理函数。这与“普通的”HTML 没有什么不同。该属性中的任何 EL 表达式都将被视为值表达式。另请参阅[标签文档](http://docs.oracle.com/javaee/6/javaserverfaces/2.1/docs/vdldocs/facelets/h/inputText.html)。

根据您的问题历史，您正在使用 JSF 2.x（请在未来的问题中明确提及确切的 JSF impl/version，因为与 JSF 1.x 相比，JSF 2.x 中的许多事情都不同）。因此，只需使用新的 JSF 2.0`<f:ajax>`标记即可。

```
<h:inputText ...>
    <f:ajax listener="#{timesheet.changeTotal1}" render="idOfTotalComponent" />
</h:inputText>

...

<h:outputText id="idOfTotalComponent" value="#{timesheet.total1}" /> 
```

和

```
public void changeTotal1(AjaxBehaviorEvent event) {
    total1 = ...;
} 
```

# ruby-on-rails - 在联网的 windows 机器上查看我的 webrick 服务器@lvh.me:3000

> ID：11783045
> 
> 赞同：0
> 
> 时间：2012-08-02T17:50:58.580
> 
> 标签：ruby-on-rails

请让我知道是否有更好的交换来发布此内容。

在测试它们时，我通常在本地运行我的 Rails 应用程序。我使用 lvh.me 指向我的本地主机。我真的需要在 IE 中做一些测试。我的办公桌上有一台 Windows 笔记本电脑，所以我希望能够从 Windows 笔记本电脑查看在 mac 上运行的服务器。在浏览器中拉起我的 IP，windows lap 不起作用。

# nvidia - Xubuntu 12.04 显示屏（带大黄蜂）升级后搞砸了

> ID：11783046
> 
> 赞同：1
> 
> 时间：2012-08-02T17:51:03.907
> 
> 标签：nvidia, xubuntu, optimus

我最近让我的机器（运行 Xubuntu 12.04）升级了大约 300 个不同的东西。我有一个混合图形 NVIDIA Optimus 系统，在升级之前它与 Bumblebee 3.0 完美配合。自升级以来，字体无法正确呈现（白色字母中的某些像素变成黑色）并且 Bumblebee 会抛出

```
[430.015513] [ERROR]The Bumblebee daemon has not been started yet or the socket path /var/run/bumblebee.socket was incorrect.
[430.015627] [ERROR]Could not connect to bumblebee daemon - is it running? 
```

当我尝试使用 NVIDIA 芯片运行任何东西时。

我用谷歌搜索了错误，重新启动似乎已经解决了大多数问题。我已经重新启动，重新安装了 bumblebee，并更新了我的 nvidia 驱动程序，但都无济于事。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-15T22:37:40.397

一直遇到完全相同的问题，并在忽略一段时间后设法使其正常工作。我还在使用反向移植包和 ubuntu-xswat-ppa 运行基于 12.04 的 Mint 13 64 位 LTS。我的笔记本电脑使用的是 Nvidia 310M Optimus 混合显卡 (ASUS U43jc) - 这是我要解决的问题：

```
sudo apt-get build-dep bumblebee bumblebee-nvidia
sudo apt-get build-dep nvidia-current
sudo apt-get install bumblebee --reinstall 
```

之后检查服务状态并最终运行！尝试运行：

```
optirun glxspheres 
```

在我的外部显示器上以 1920x1080 的分辨率成功运行平均 ~106 帧/秒和 ~99 Mpixels/sec。

祝你好运！

# c++ - 如何限制对当前文件的某些功能或对象的访问？

> ID：11783054
> 
> 赞同：5
> 
> 时间：2012-08-02T17:52:17.440
> 
> 标签：c++, namespaces, scope, public, privacy

我想知道是否可以将对命名空间中声明的某些函数或对象的访问限制在同一文件中的其他类中。例如，

```
//myheader.h

namespace stuff
{
  int repair(firstObj obj);
  int doSomethingElse();
  privateObj obj;
} 
```

在这种情况下，我希望函数`doSomethingElse()`和对象`obj`只能被此文件中声明的类访问。

是否有一些关键字可以用来限制访问？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-08-02T17:54:18.247

使用未命名的命名空间：

```
namespace stuff
{

  int repair(firstObj obj);

  namespace 
  {
    int doSomethingElse();
    privateObj obj;
  }

} 
```

从[这里](http://msdn.microsoft.com/en-us/library/yct4x9k5%28v=vs.80%29.aspx)[强调我的]：

> 未命名的命名空间是变量静态声明的更好替代品。 **它们允许变量和函数在整个翻译单元内可见，但在外部不可见。**尽管未命名命名空间中的实体可能具有外部链接，但它们有效地由其翻译单元唯一的名称限定，因此永远无法从任何其他翻译单元看到。

另请参阅此相关问题：[未命名/匿名命名空间与静态函数](https://stackoverflow.com/q/154469/1025391)

* * *

**编辑：**刚刚注意到这是我们正在谈论的头文件：

> 在这种情况下，我希望函数 doSomethingElse() 和对象 obj 只能被此文件中声明的类访问。

那么你不应该首先在公共头文件中声明这些方法和对象，而是在特定的实现文件中：如果其他人不应该使用它们，其他人甚至不应该知道它们存在。

然后使用一个未命名的命名空间来有效地限制可达性（例如*，*如果有人会不小心使用相同的标识符提供另一个声明）。

如果将它留在头文件中，可能会发生这种情况：[匿名名称空间和一个定义规则](https://stackoverflow.com/questions/7955058/anonymous-namespaces-and-the-one-definition-rule)（如果头文件包含在多个翻译单元中）：

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-08-02T17:54:36.493

是的，把它放在一个匿名命名空间中：

```
namespace stuff
{
    int repair(firstObj obj)

    namespace
    {
        int doSomethingElse();
        privateObj obj;
    }
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-02T17:54:57.457

声明它们，因为`static` 这意味着它们只能在该文件中访问。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-02T17:55:52.727

您可以使用关键字`static`。

```
namespace stuff
{
 int repair(firstObj obj)
 static int doSomethingElse();
 static privateObj obj;
} 
```

因此，对象和函数只能在当前文件中访问。

# biztalk - BizTalk 错误：“路由失败报告”的路由失败报告

> ID：11783056
> 
> 赞同：2
> 
> 时间：2012-08-02T17:52:25.087
> 
> 标签：biztalk, biztalk-2010, btahl7

我尝试向 BizTalk 发送 HL7 消息，并收到错误代码 0xC0C01B4e（路由失败报告）和消息：

> <名称不可用> 的路由失败报告

我已经在最后一天工作了，现在收到这条消息，完全难以置信。

我的场景：

```
1 Request/Response Recieve Port named HL7Test.In
1 Receive Location for the Receive Port called HL7Test.In.MLLP
   Type is MLLP
   Receive pipeline is BTAHL72XRecievePipeline
   Send pipeline is BTAHL72XSendPipeline
1 Send Port
   Type is file
   Send pipeline is Passthrough
   Filter is BTS.ReceivePortName == HL7Test.In
1 Party configuration called "REG", with the following BTAHL7 configuration:
   Acknowledgemnt type: OriginalMode
   Validate body segments: Enabled
   Validate custom datat types: Enabled
   Alow trailing delimiters: Enabled
   Schema namespace: http://microsoft.com/HealthCare/HL7/2X
I've deployed the BTAHL7V2XCommon, BTAHL7V21Common and ADT message schemas 
```

我使用来自第 3 方应用程序的 MLLP 发送 HL7 消息 未返回 ack 文件未写入 1 生成不可恢复错误，如上所述。

我发送的消息是：

> MSH|^~\&|REG|FAC|||201207271419||ADT^A04|504111|D|2.1|||AL|AL|
> EVN|A04|201207271419||02 PID|1||M11||REGRIHSOT^xyz^2^3^5^6
> NK1|1|Regrihsot^妻子^3^4^5^6|W|1^2^city ^BC^V1S 0A7^6^7^8|
> PV1|1|E|KAMRIHED|||||MITD4||||||HO||||ED||BC|||||||||||||||||FAC||注册|||201207271417|
> ZAD|邮件^1^^城市^BC^V1S 0A7|PHYS^1^^坎卢普斯^BC^V1S 0A7| ZTZ|PT|
> 中关村|^^|

这一切都在一小时前运行良好。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-02T22:10:12.967

看来我还需要一个消耗 ACK 的发送端口。我之前确实有这个，所以我使用过滤器添加了它：

> BTS.MessageType == [http://microsoft.com/HealthCare/HL7/2X#ACK_24_GLO_DEF](http://microsoft.com/HealthCare/HL7/2X#ACK_24_GLO_DEF)

我不明白为什么我需要使用此消息。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-26T15:30:38.337

我对 MLLP 适配器没有太多经验，但通常任何发布到 BizTalk 环境的消息都必须有订阅者。如果没有人在等待消息，则 BizTalk 将其视为错误并抛出异常路由失败。这是有道理的，因为如果 BizTalk 不将未经请求的消息视为异常，那么随着时间的推移，您的环境将因所有这些未经请求的消息而变得臃肿。

我本来希望您的 MLLP 请求/响应适配器应该接收到 ACK 并关闭循环。不知道为什么需要创建一个单独的发送端口来接收 ACK。在这个方向上可能值得研究。

# php - 如果未单击相应链接，则将字段设置为隐藏

> ID：11783058
> 
> 赞同：0
> 
> 时间：2012-08-02T17:52:31.900
> 
> 标签：php, jquery, html, ajax

当用户单击链接并出现多选下拉菜单时，我会加载其他信息`holds[]`。

如果用户没有选择“更多”信息链接，则`holds[]`下拉菜单不会呈现，并且不会显示在帖子数据中`print_r($_POST);`

对于 ajax，在成功时（用户单击更多信息链接），它会显示一大段 html，其中包含该`holds[]`下拉菜单（如下面的屏幕截图所示）。

如果未单击相应的“更多”信息链接，是否可以添加到 ajax/jQuery 以将`holds[]`下拉菜单设置为隐藏字段？

任何帮助表示赞赏。

![在此处输入图像描述](../Images/eaab61564ecc3173d0cfb12aa315c094.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-02T17:59:44.250

您可以让`more`按钮调用一个 javascript 函数，该函数执行一个 ajax 调用，该函数返回您正在查找的数据并将其插入到单击它的行之后的表中：

```
$(".more").on('click', function() {
    var rowId = $(this).attr('id');
    $.post("process.php", {
            id: rowId
        }, function (data) {
            $(this).parent().parent().after(data);
            $(this).html("<a href='#' class='close' id='" + $(this).attr('id') + "'>close</a>");
        }
});

$(this).parent() // <td> containing "more"
    .parent() // <tr> containing <td> containing "more" 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-02T17:56:52.087

```
<input class="hidden" /> <!--Will be hidden by defaul -->

.hidden {
    display:none;
}

$('.more').click(function(){
    $(this).siblings('.dropdown').toggleClass('hidden'); 
    //You haven't posted your html so I'm going to make some assumptions
}); 
```

# ruby-on-rails-3 - 如何将字体真棒图标嵌入 submit_tag

> ID：11783061
> 
> 赞同：19
> 
> 时间：2012-08-02T17:52:47.043
> 
> 标签：ruby-on-rails-3, twitter-bootstrap-rails, font-awesome

尝试为我的按钮使用字体很棒的图标，但我无法让它显示在 submit_tag 中

```
 <%= submit_tag icon("search"), class: "btn-primary", style:"width:40px;" %> 
```

输出：

```
 <input class="btn-primary" name="commit" style="width:40px;" type="submit" value="&lt;i class='icon-search' style='font-size:1em' &gt;&lt;/i&gt;"> 
```

帮手：

```
def icon(name, size=1)
  #icon("camera-retro")
  #<i class="icon-camera-retro"></i> 

  html = "<i class='icon-#{name}' "
  html += "style='font-size:#{size}em' "
  html += "></i>"
  html.html_safe
end 
```

当我删除助手的 html.html_safe 行时，我得到了同样的结果。它就像 html_safe 不起作用。我也试过 html = raw(html) 也没有效果。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-08-02T18:12:05.413

输入提交标签不允许嵌套 HTML，您需要显示一个图标。

尝试使用按钮：

```
<button class='btn btn-primary' style='width:40px;'>
  <%= icon("search") %>
</button> 
```

值得注意的是按钮标签和输入提交标签的行为之间的一些差异。查看[这个 SO question](https://stackoverflow.com/questions/469059/button-vs-input-type-button-which-to-use)以获得大量详细信息。我个人在我的应用程序中使用按钮标签没有遇到任何问题。但是，YMMV 针对不同的浏览器等。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-07-18T23:53:10.830

```
<%= link_to(status, :method=>:delete) do %>
   <i class='icon-trash icon-large'></i>
<% end %> 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-10T18:54:26.463

您可以在 HTML 代码中添加图标，如下所示：

```
<i class="icon-search"></i> 
```

然而，如果你想在 Rails link_to helper 中放置图标，请使用 ilink_to helper 方法。请按照以下步骤操作：

1) 将 gem 添加到 Gemfile 中的资产组： gem 'less-rails-fontawesome'

2）运行*捆绑安装*：

3) 确保*@import 'fontawesome';* 在 app/assets/stylesheetes/bootstrap_and_overrides.css.less 中未注释。

4) 使用 *ilink_to* 辅助方法而不是 *link_to* 辅助方法。

```
<%= ilink_to "upload-alt", "Edit", edit_post_path(post), class: 'btn btn-mini' %> 
```

Obs：在链接文本之前删除图标名称图标前缀

这些说明在这里：[https ://github.com/wbzyl/less-rails-fontawesome](https://github.com/wbzyl/less-rails-fontawesome)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-02T18:11:04.023

我认为您需要摆脱`html_safe`助手，并使用`raw icon("search")`而不仅仅是`icon("search")`

正如 BaronVonBraun 所说 - 使用`button`而不是`input[submit]`

# java - 如何使用 AES 解密用 openssl 命令加密的 Java 文件？

> ID：11783062
> 
> 赞同：12
> 
> 时间：2012-08-02T17:52:50.843
> 
> 标签：java, openssl, aes

我需要在 JAVA 中使用以下命令解密在 UNIX 中加密的文件：

```
openssl aes-256-cbc -a -salt -in password.txt -out password.txt.enc
mypass
mypass 
```

我必须像在 UNIX 中一样在 java 中解密

```
openssl aes-256-cbc -d -a -in password.txt.enc -out password.txt.new
mypass 
```

有人可以给我一个java代码来做到这一点吗？

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2012-08-02T22:48:20.460

OpenSSL一般使用自己的基于密码的密钥派生方式，具体[`EVP_BytesToKey`](http://www.openssl.org/docs/crypto/EVP_BytesToKey.html)见下文代码。此外，它将密文隐式编码为多行的 base 64，这将需要在邮件消息的正文中发送。

所以结果是，在伪代码中：

```
salt = random(8)
keyAndIV = BytesToKey(password, salt, 48)
key = keyAndIV[0..31]
iv = keyAndIV[32..47]
ct = AES-256-CBC-encrypt(key, iv, plaintext)
res = base64MimeEncode("Salted__" | salt | ct)) 
```

因此解密是：

```
(salt, ct) = base64MimeDecode(res)
key = keyAndIV[0..31]
iv = keyAndIV[32..47]
pt = AES-256-CBC-decrypt(key, iv, plaintext) 
```

可以像这样在Java中实现：

```
import java.io.File;
import java.io.IOException;
import java.nio.charset.Charset;
import java.nio.file.Files;
import java.security.GeneralSecurityException;
import java.security.MessageDigest;
import java.util.Arrays;
import java.util.List;

import javax.crypto.BadPaddingException;
import javax.crypto.Cipher;
import javax.crypto.IllegalBlockSizeException;
import javax.crypto.spec.IvParameterSpec;
import javax.crypto.spec.SecretKeySpec;

import org.bouncycastle.util.encoders.Base64;

public class OpenSSLDecryptor {
    private static final Charset ASCII = Charset.forName("ASCII");
    private static final int INDEX_KEY = 0;
    private static final int INDEX_IV = 1;
    private static final int ITERATIONS = 1;

    private static final int ARG_INDEX_FILENAME = 0;
    private static final int ARG_INDEX_PASSWORD = 1;

    private static final int SALT_OFFSET = 8;
    private static final int SALT_SIZE = 8;
    private static final int CIPHERTEXT_OFFSET = SALT_OFFSET + SALT_SIZE;

    private static final int KEY_SIZE_BITS = 256;

    /**
     * Thanks go to Ola Bini for releasing this source on his blog.
     * The source was obtained from <a href="http://olabini.com/blog/tag/evp_bytestokey/">here</a> .
     */
    public static byte[][] EVP_BytesToKey(int key_len, int iv_len, MessageDigest md,
            byte[] salt, byte[] data, int count) {
        byte[][] both = new byte[2][];
        byte[] key = new byte[key_len];
        int key_ix = 0;
        byte[] iv = new byte[iv_len];
        int iv_ix = 0;
        both[0] = key;
        both[1] = iv;
        byte[] md_buf = null;
        int nkey = key_len;
        int niv = iv_len;
        int i = 0;
        if (data == null) {
            return both;
        }
        int addmd = 0;
        for (;;) {
            md.reset();
            if (addmd++ > 0) {
                md.update(md_buf);
            }
            md.update(data);
            if (null != salt) {
                md.update(salt, 0, 8);
            }
            md_buf = md.digest();
            for (i = 1; i < count; i++) {
                md.reset();
                md.update(md_buf);
                md_buf = md.digest();
            }
            i = 0;
            if (nkey > 0) {
                for (;;) {
                    if (nkey == 0)
                        break;
                    if (i == md_buf.length)
                        break;
                    key[key_ix++] = md_buf[i];
                    nkey--;
                    i++;
                }
            }
            if (niv > 0 && i != md_buf.length) {
                for (;;) {
                    if (niv == 0)
                        break;
                    if (i == md_buf.length)
                        break;
                    iv[iv_ix++] = md_buf[i];
                    niv--;
                    i++;
                }
            }
            if (nkey == 0 && niv == 0) {
                break;
            }
        }
        for (i = 0; i < md_buf.length; i++) {
            md_buf[i] = 0;
        }
        return both;
    }

    public static void main(String[] args) {
        try {
            // --- read base 64 encoded file ---

            File f = new File(args[ARG_INDEX_FILENAME]);
            List<String> lines = Files.readAllLines(f.toPath(), ASCII);
            StringBuilder sb = new StringBuilder();
            for (String line : lines) {
                sb.append(line.trim());
            }
            String dataBase64 = sb.toString();
            byte[] headerSaltAndCipherText = Base64.decode(dataBase64);

            // --- extract salt & encrypted ---

            // header is "Salted__", ASCII encoded, if salt is being used (the default)
            byte[] salt = Arrays.copyOfRange(
                    headerSaltAndCipherText, SALT_OFFSET, SALT_OFFSET + SALT_SIZE);
            byte[] encrypted = Arrays.copyOfRange(
                    headerSaltAndCipherText, CIPHERTEXT_OFFSET, headerSaltAndCipherText.length);

            // --- specify cipher and digest for EVP_BytesToKey method ---

            Cipher aesCBC = Cipher.getInstance("AES/CBC/PKCS5Padding");
            MessageDigest md5 = MessageDigest.getInstance("MD5");

            // --- create key and IV  ---

            // the IV is useless, OpenSSL might as well have use zero's
            final byte[][] keyAndIV = EVP_BytesToKey(
                    KEY_SIZE_BITS / Byte.SIZE,
                    aesCBC.getBlockSize(),
                    md5,
                    salt,
                    args[ARG_INDEX_PASSWORD].getBytes(ASCII),
                    ITERATIONS);
            SecretKeySpec key = new SecretKeySpec(keyAndIV[INDEX_KEY], "AES");
            IvParameterSpec iv = new IvParameterSpec(keyAndIV[INDEX_IV]);

            // --- initialize cipher instance and decrypt ---

            aesCBC.init(Cipher.DECRYPT_MODE, key, iv);
            byte[] decrypted = aesCBC.doFinal(encrypted);

            String answer = new String(decrypted, ASCII);
            System.out.println(answer);
        } catch (BadPaddingException e) {
            // AKA "something went wrong"
            throw new IllegalStateException(
                    "Bad password, algorithm, mode or padding;" +
                    " no salt, wrong number of iterations or corrupted ciphertext.");
        } catch (IllegalBlockSizeException e) {
            throw new IllegalStateException(
                    "Bad algorithm, mode or corrupted (resized) ciphertext.");
        } catch (GeneralSecurityException e) {
            throw new IllegalStateException(e);
        } catch (IOException e) {
            throw new IllegalStateException(e);
        }
    }        
} 
```

请注意，代码将 ASCII 指定为字符集。使用的字符集可能因您的应用程序/终端/操作系统而异。

* * *

一般来说，您应该强制 OpenSSL 使用 NIST 批准的 PBKDF2 算法，因为使用 OpenSSL 密钥派生方法 - 迭代计数为 1 - 是不安全的。这可能会迫使您使用与 OpenSSL 不同的解决方案。请注意，基于密码的加密本质上是相当不安全的——密码比随机生成的对称密钥安全得多。

* * *

[OpenSSL 1.1.0c 更改了](https://stackoverflow.com/q/39637388/608639)一些内部组件中使用的摘要算法。以前使用MD5，1.1.0改用SHA256。请注意，更改不会影响您`EVP_BytesToKey`和`openssl enc`.

最好在命令行界面中明确指定摘要（例如`-md md5`，为了向后兼容或`sha-256`向前兼容），并确保 Java 代码使用相同的摘要算法（`"MD5"`或`"SHA-256"`包括破折号）。另请参阅[此答案中](https://stackoverflow.com/a/54173509/589259)的信息。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-03-31T22:31:52.040

以下是**OpenSSLPBEInputStream**和**OpenSSLPBEOutputStream**，它们可用于以与 OpenSSL 兼容的方式加密/解密任意字节流。

示例用法：

```
 // The original clear text bytes
    byte[] originalBytes = ...

    // Encrypt these bytes
    char[] pwd = "thePassword".toCharArray();
    ByteArrayOutputStream byteOS = new ByteArrayOutputStream();
    OpenSSLPBEOutputStream encOS = new OpenSSLPBEOutputStream(byteOS, ALGORITHM, 1, pwd);
    encOS.write(originalBytes);
    encOS.flush();
    byte[] encryptedBytes = byteOS.toByteArray();

    // Decrypt the bytes
    ByteArrayInputStream byteIS = new ByteArrayInputStream(encryptedBytes);
    OpenSSLPBEInputStream encIS = new OpenSSLPBEInputStream(byteIS, ALGORITHM, 1, pwd); 
```

其中 ALGORITHM（仅使用 JDK 类）可以是：“PBEWithMD5AndDES”、“PBEWithMD5AndTripleDES”、“PBEWithSHA1AndDESede”、“PBEWithSHA1AndRC2_40”。

要处理原始海报的“openssl aes-256-cbc -a -salt -in password.txt -out password.txt.enc”，请将bouncey castle 添加到类路径，并使用algorthm=“PBEWITHMD5AND256BITAES-CBC-OPENSSL”。

```
/* Add BC provider, and fail fast if BC provider is not in classpath for some reason */
Security.addProvider(new BouncyCastleProvider()); 
```

依赖：

```
 <dependency>
        <groupId>org.bouncycastle</groupId>
        <artifactId>bcprov-jdk16</artifactId>
        <version>1.44</version>
    </dependency> 
```

输入流：

```
import javax.crypto.BadPaddingException;
import javax.crypto.Cipher;
import javax.crypto.IllegalBlockSizeException;
import javax.crypto.NoSuchPaddingException;
import java.io.IOException;
import java.io.InputStream;
import java.security.InvalidAlgorithmParameterException;
import java.security.InvalidKeyException;
import java.security.NoSuchAlgorithmException;
import java.security.spec.InvalidKeySpecException;

public class OpenSSLPBEInputStream extends InputStream {

    private final static int READ_BLOCK_SIZE = 64 * 1024;

    private final Cipher cipher;
    private final InputStream inStream;
    private final byte[] bufferCipher = new byte[READ_BLOCK_SIZE];

    private byte[] bufferClear = null;

    private int index = Integer.MAX_VALUE;
    private int maxIndex = 0;

    public OpenSSLPBEInputStream(final InputStream streamIn, String algIn, int iterationCount, char[] password)
            throws IOException {
        this.inStream = streamIn;
        try {
            byte[] salt = readSalt();
            cipher = OpenSSLPBECommon.initializeCipher(password, salt, Cipher.DECRYPT_MODE, algIn, iterationCount);
        } catch (InvalidKeySpecException | NoSuchPaddingException | NoSuchAlgorithmException | InvalidKeyException | InvalidAlgorithmParameterException e) {
            throw new IOException(e);
        }
    }

    @Override
    public int available() throws IOException {
        return inStream.available();
    }

    @Override
    public int read() throws IOException {

        if (index > maxIndex) {
            index = 0;
            int read = inStream.read(bufferCipher);
            if (read != -1) {
                bufferClear = cipher.update(bufferCipher, 0, read);
            }
            if (read == -1 || bufferClear == null || bufferClear.length == 0) {
                try {
                    bufferClear = cipher.doFinal();
                } catch (IllegalBlockSizeException | BadPaddingException e) {
                    bufferClear = null;
                }
            }
            if (bufferClear == null || bufferClear.length == 0) {
                return -1;
            }
            maxIndex = bufferClear.length - 1;
        }
        return bufferClear[index++] & 0xff;

    }

    private byte[] readSalt() throws IOException {

        byte[] headerBytes = new byte[OpenSSLPBECommon.OPENSSL_HEADER_STRING.length()];
        inStream.read(headerBytes);
        String headerString = new String(headerBytes, OpenSSLPBECommon.OPENSSL_HEADER_ENCODE);

        if (!OpenSSLPBECommon.OPENSSL_HEADER_STRING.equals(headerString)) {
            throw new IOException("unexpected file header " + headerString);
        }

        byte[] salt = new byte[OpenSSLPBECommon.SALT_SIZE_BYTES];
        inStream.read(salt);

        return salt;
    }

} 
```

输出流：

```
import javax.crypto.BadPaddingException;
import javax.crypto.Cipher;
import javax.crypto.IllegalBlockSizeException;
import javax.crypto.NoSuchPaddingException;
import java.io.IOException;
import java.io.OutputStream;
import java.security.InvalidAlgorithmParameterException;
import java.security.InvalidKeyException;
import java.security.NoSuchAlgorithmException;
import java.security.SecureRandom;
import java.security.spec.InvalidKeySpecException;

public class OpenSSLPBEOutputStream extends OutputStream {

private static final int BUFFER_SIZE = 5 * 1024 * 1024;

private final Cipher cipher;
private final OutputStream outStream;
private final byte[] buffer = new byte[BUFFER_SIZE];
private int bufferIndex = 0;

public OpenSSLPBEOutputStream(final OutputStream outputStream, String algIn, int iterationCount,
                              char[] password) throws IOException {
    outStream = outputStream;
    try {
        /* Create and use a random SALT for each instance of this output stream. */
        byte[] salt = new byte[PBECommon.SALT_SIZE_BYTES];
        new SecureRandom().nextBytes(salt);
        cipher = OpenSSLPBECommon.initializeCipher(password, salt, Cipher.ENCRYPT_MODE, algIn, iterationCount);
        /* Write header */
        writeHeader(salt);
    } catch (InvalidKeySpecException | NoSuchPaddingException | NoSuchAlgorithmException | InvalidKeyException | InvalidAlgorithmParameterException e) {
        throw new IOException(e);
    }
}

@Override
public void write(int b) throws IOException {
    buffer[bufferIndex] = (byte) b;
    bufferIndex++;
    if (bufferIndex == BUFFER_SIZE) {
        byte[] result = cipher.update(buffer, 0, bufferIndex);
        outStream.write(result);
        bufferIndex = 0;
    }
}

@Override
public void flush() throws IOException {
    if (bufferIndex > 0) {
        byte[] result;
        try {
            result = cipher.doFinal(buffer, 0, bufferIndex);
            outStream.write(result);
        } catch (IllegalBlockSizeException | BadPaddingException e) {
            throw new IOException(e);
        }
        bufferIndex = 0;
    }
}

@Override
public void close() throws IOException {
    flush();
    outStream.close();
}

private void writeHeader(byte[] salt) throws IOException {
    outStream.write(OpenSSLPBECommon.OPENSSL_HEADER_STRING.getBytes(OpenSSLPBECommon.OPENSSL_HEADER_ENCODE));
    outStream.write(salt);
}

} 
```

小普通类：

```
import javax.crypto.Cipher;
import javax.crypto.NoSuchPaddingException;
import javax.crypto.SecretKey;
import javax.crypto.SecretKeyFactory;
import javax.crypto.spec.PBEKeySpec;
import javax.crypto.spec.PBEParameterSpec;
import java.security.InvalidAlgorithmParameterException;
import java.security.InvalidKeyException;
import java.security.NoSuchAlgorithmException;
import java.security.spec.InvalidKeySpecException;

class OpenSSLPBECommon {

protected static final int SALT_SIZE_BYTES = 8;
protected static final String OPENSSL_HEADER_STRING = "Salted__";
protected static final String OPENSSL_HEADER_ENCODE = "ASCII";

protected static Cipher initializeCipher(char[] password, byte[] salt, int cipherMode,
                                         final String algorithm, int iterationCount) throws NoSuchAlgorithmException, InvalidKeySpecException,
        InvalidKeyException, NoSuchPaddingException, InvalidAlgorithmParameterException {

    PBEKeySpec keySpec = new PBEKeySpec(password);
    SecretKeyFactory factory = SecretKeyFactory.getInstance(algorithm);
    SecretKey key = factory.generateSecret(keySpec);

    Cipher cipher = Cipher.getInstance(algorithm);
    cipher.init(cipherMode, key, new PBEParameterSpec(salt, iterationCount));

    return cipher;
}

} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-09-14T19:22:08.120

在科特林：

```
package io.matthewnelson.java_crypto

import java.util.*
import javax.crypto.Cipher
import javax.crypto.SecretKeyFactory
import javax.crypto.spec.IvParameterSpec
import javax.crypto.spec.PBEKeySpec
import javax.crypto.spec.SecretKeySpec

class OpenSSL {

    /**
     * Will decrypt a string value encrypted by OpenSSL v 1.1.1+ using the following cmds from terminal:
     *
     *   echo "Hello World!" | openssl aes-256-cbc -e -a -p -salt -pbkdf2 -iter 15739 -k qk4aX-EfMUa-g4HdF-fjfkU-bbLNx-15739
     *
     * Terminal output:
     *   salt=CC73B7D29FE59CE1
     *   key=31706F84185EA4B5E8E040F2C813F79722F22996B48B82FF98174F887A9B9993
     *   iv =1420310D41FD7F48E5D8722B9AC1C8DD
     *   U2FsdGVkX1/Mc7fSn+Wc4XLwDsmLdR8O7K3bFPpCglA=
     * */
    fun decrypt_AES256CBC_PBKDF2_HMAC_SHA256(
        password: String,
        hashIterations: Int,
        encryptedString: String
    ): String {
        val encryptedBytes = Base64.getDecoder().decode(encryptedString)

        // Salt is bytes 8 - 15
        val salt = encryptedBytes.copyOfRange(8, 16)
//        println("Salt: ${salt.joinToString("") { "%02X".format(it) }}")

        // Derive 48 byte key
        val keySpec = PBEKeySpec(password.toCharArray(), salt, hashIterations, 48 * 8)
        val keyFactory = SecretKeyFactory.getInstance("PBKDF2WithHmacSHA256")
        val secretKey = keyFactory.generateSecret(keySpec)

        // Decryption Key is bytes 0 - 31 of the derived key
        val key = secretKey.encoded.copyOfRange(0, 32)
//        println("Key: ${key.joinToString("") { "%02X".format(it) }}")

        // Input Vector is bytes 32 - 47 of the derived key
        val iv = secretKey.encoded.copyOfRange(32, 48)
//        println("IV: ${iv.joinToString("") { "%02X".format(it) }}")

        // Cipher Text is bytes 16 - end of the encrypted bytes
        val cipherText = encryptedBytes.copyOfRange(16, encryptedBytes.lastIndex + 1)

        // Decrypt the Cipher Text and manually remove padding after
        val cipher = Cipher.getInstance("AES/CBC/NoPadding")
        cipher.init(Cipher.DECRYPT_MODE, SecretKeySpec(key, "AES"), IvParameterSpec(iv))
        val decrypted = cipher.doFinal(cipherText)
//        println("Decrypted: ${decrypted.joinToString("") { "%02X".format(it) }}")

        // Last byte of the decrypted text is the number of padding bytes needed to remove
        val plaintext = decrypted.copyOfRange(0, decrypted.lastIndex + 1 - decrypted.last().toInt())

        return plaintext.toString(Charsets.UTF_8)
    }
} 
```

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2017-01-23T14:42:14.297

不要使用 ase-128-cbc，使用 ase-128-ecb。

# 只取前 16 个字节作为密钥，因为密钥是 128 位

# 哈希输出以十六进制打印，每 2 个字符表示一个字节值

hashwd=`echo -n $password| openssl sha1 | sed 's#.*=\\s*##g' | cut -c 1-32`

openssl enc -aes-128-ecb -salt -in -out -K $hashpwd

Java 代码在这里：

```
import sun.misc.BASE64Decoder;
import sun.misc.BASE64Encoder;

import javax.crypto.Cipher;
import javax.crypto.spec.SecretKeySpec;
import java.io.*;
import java.security.MessageDigest;
import java.security.NoSuchAlgorithmException;
import java.util.ArrayList;
import java.util.Arrays;

    //openssl enc -nosalt -aes-128-ecb
    // -in <input file>
    // -out <output file>
    // -K <16 bytes in hex, for example : "abc" can be hashed in SHA-1, the first 16 bytes in hex is a9993e364706816aba3e25717850c26c>
    private final static String TRANSFORMATION = "AES"; // use aes-128-ecb in openssl

public static byte[] encrypt(String passcode, byte[] data) throws CryptographicException {
        try {
            Cipher cipher = Cipher.getInstance(TRANSFORMATION);
            cipher.init(Cipher.ENCRYPT_MODE, genKeySpec(passcode));
            return cipher.doFinal(data);
        } catch (Exception ex) {
            throw new CryptographicException("Error encrypting", ex);
        }
    }

    public static String encryptWithBase64(String passcode, byte[] data) throws CryptographicException {
        return new BASE64Encoder().encode(encrypt(passcode, data));
    }

    public static byte[] decrypt(String passcode, byte[] data) throws CryptographicException {
        try {
            Cipher dcipher = Cipher.getInstance(TRANSFORMATION);
            dcipher.init(Cipher.DECRYPT_MODE, genKeySpec(passcode));
            return dcipher.doFinal(data);
        } catch (Exception e) {
            throw new CryptographicException("Error decrypting", e);
        }
    }

    public static byte[] decryptWithBase64(String passcode, String encrptedStr) throws CryptographicException {
        try {
            return decrypt(passcode, new BASE64Decoder().decodeBuffer(encrptedStr));
        } catch (Exception e) {
            throw new CryptographicException("Error decrypting", e);
        }
    }

    public static SecretKeySpec genKeySpec(String passcode) throws UnsupportedEncodingException, NoSuchAlgorithmException {
        byte[] key = passcode.getBytes("UTF-8");
        MessageDigest sha = MessageDigest.getInstance("SHA-1");
        key = sha.digest(key);
        key = Arrays.copyOf(key, 16); // use only first 128 bit
        return new SecretKeySpec(key, TRANSFORMATION);
    } 
```

在 jdk6 和 jdk8 中测试并通过。

# android - 我如何从列表视图中获取价值

> ID：11783066
> 
> 赞同：-1
> 
> 时间：2012-08-02T17:53:03.267
> 
> 标签：android, listview, simplecursoradapter

我有一个`ListView`我的`sqlite`数据，我想单击并在另一个中显示该值`Activity`。

谁能教我如何做到这一点？

下面是我的代码：

```
Cursor cursor = mydb.queueAll();
    startManagingCursor(cursor);

    String[] from = new String[] { myDbAdapter.ELDERLY_DATE_TIME };
    int[] to = new int[] { R.id.textView1 };

    SimpleCursorAdapter cursorAdapter = new SimpleCursorAdapter(this,
            R.layout.displayactivity, cursor, from, to);
    listContent.setAdapter(cursorAdapter);
    mydb.close();

    listContent.setOnItemClickListener(new OnItemClickListener() {

        public void onItemClick(AdapterView<?> parent, View view,
                int position, long id) {
            // TODO Auto-generated method stub

        }

    }); 
```

提前致谢 ：）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-02T18:14:10.683

> 实际上我只是想获得价值，以便我可以通过意图将价值传递给另一个活动

您不必将值“传递”给另一个`Activity`. 在您的其他人中`Activity`，您只需查询在您的`ListView`.

# python - 在 python 中更新我的字典

> ID：11783067
> 
> 赞同：2
> 
> 时间：2012-08-02T17:53:05.927
> 
> 标签：python, dictionary, for-loop

这应该是一个简单的问题，但我无法理解它。我有一本字典，叫`TD`. 的{key1{key2:values}}`TD`是`{1:{u'word':3, u'next':2, u'the':2},2:{...}...}`where`key1`是文档，`key2`是文档中的一个词，是该词在文档`value`中出现的次数，使用该`Counter`方法获得。

我有大量文档，因此每个文档在 TD 中都有一个条目：

```
TD = {1:{u'word':2, u'next':1, u'the':5,...},
      2:{u'my':4, u'you':1, u'other':2,...},
      ...
      168:{u'word':1, u'person':1, u'and':8,...}} 
```

我现在要做的是检查每个单词`{1{...}}`以查看它是否出现在其他文档中，并对每个文档重复此过程。对于每个文档中出现的单词，`freq`增加 1。我有一个名为的新字典`Score`，应该如下所示：

```
{1:{u'word':score, u'next':score,...}, 2:{u'my':score, u'you':score,...}...} 
```

要获取此字典：

```
Score={}
count = 0
for x,i in TD[count].iteritems():
    freq=1
    num=1
    for y in TD[num].keys():
        if word in TF[num].keys():
            freq+=1
        num+=1
    Score[num]={x:(i*freq)}
    num+=1 
```

这给了我以下输出：

```
{1:{u'word':score}, 2:{u'next':score}, 3:{u'the':score}...} 
```

应该：

```
{1:{u'word':score, u'next':score, u'the':score,...}...} 
```

我认为问题出在线路上`Score[num]={x:(i*freq)}`

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-02T17:57:04.880

使用[dict 视图](http://docs.python.org/library/stdtypes.html#dictionary-view-objects)查找文档之间的交集，然后使用 Counter 来计算它们的频率：

```
Score = {}
for id, document in TD.iteritems():
    counts = Score[id] = Counter()
    for otherid, otherdocument in TD.iteritems():
        if otherid == id:
            continue  # Skip current document
        counts.update(document.viewkeys() & otherdocument.viewkeys()) 
```

Score 中的每个条目都将计算文档中每个单词在其他文档中出现的频率。

如果您还需要在当前文档中包含字数（计数 + 1），只需删除`if otherid == id`测试。

在您自己的代码中，您混淆了`num`and `count`，但在 python 中，您*通常*在任何情况下都不需要手动增加循环计数器。

# wpf - 水平堆栈面板中控件的宽度

> ID：11783068
> 
> 赞同：0
> 
> 时间：2012-08-02T17:53:07.360
> 
> 标签：wpf

在我的 WPF 应用程序中，我有一个水平 StackPanel，我试图将其用作工具栏。在这个面板中，我有按钮、组合框和文本框。由于按钮最高，因此 StackPanel 采用它们的高度。组合框和文本框也是如此。但我希望他们保持原样，否则他们看起来很难看。我怎样才能防止它们扩大并填满所有可用空间？我试图将它们的高度设置为 Auto 或明确的大小，但这没有帮助。我还尝试将 StackPanel 替换为 Grid，但这也无济于事。我究竟做错了什么？

```
 <StackPanel Orientation="Horizontal" Margin="3, 10">
        <ComboBox x:Name="Agencies" DisplayMemberPath="Name" SelectedValuePath="Value" 
                  SelectedItem="{Binding SelectedAgency}"
                  Height="50"  MinWidth="100" Margin="3,0"/>
        <Button x:Name="UploadFile"
            MinWidth="70"
            Margin="2"
            HorizontalAlignment="Center"
            VerticalAlignment="Center" 
            attachProperties:ButtonIcon.Icon="Resources/Images/add.png"
            Content="Upload File"  IsEnabled="{Binding EnrollmentFiles.Any}"                           
            Style="{StaticResource ImageButtonStyle}" />          
         <Button x:Name="EnrollmentDelete"
            MinWidth="70"
            Margin="2"
            HorizontalAlignment="Center"
            VerticalAlignment="Center" 
            attachProperties:ButtonIcon.Icon="Resources/Images/Remove.png"
            Content="Delete Enrollment"  IsEnabled="{Binding EnrollmentFiles.Any}"                           
            Style="{StaticResource ImageButtonStyle}" />

        <TextBox x:Name="WorkSheetName" />
    </StackPanel> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-02T18:02:49.380

你需要`VerticalAlignment`在你的`ComboBox`和`TextBox`上设置类似的东西`Center`。默认情况下，它设置为`Stretch`

```
<TextBox VerticalAlignment="Center" ... /> 
```

# ruby - 红宝石没有从终端正确执行

> ID：11783070
> 
> 赞同：2
> 
> 时间：2012-08-02T17:53:21.473
> 
> 标签：ruby, nokogiri, platypus

我有以下红宝石脚本：

```
require "rubygems"
require "rest-client" #although not required in the program
require "open-uri"
require "nokogiri"

puts "Opening file"
page=File.open("file.html","r"){|file| file.read}
puts page
    page = Nokogiri::HTML(page)
    puts page.class
    #Filters content of page to select all references to the documents filing date
    td_rows = page.css('td i.blue')
    puts td_rows 
```

我可以从 CodeRunner 或 TextWrangler 运行此脚本，并使用 ruby​​ 'filename' 从终端调用它。但是，我试图让脚本在某个时间点运行，并尝试使用 Keyboard Maestro 或 Platypus 调用脚本，但尽管它运行它似乎并没有完成该行

```
td_rows = page.css('td i.blue') 
```

变量 td_rows 不包含任何内容。有谁知道为什么这不起作用？

非常感谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-06T17:51:26.350

如果您的代码无法读取该文件，Nokogiri 在尝试解析空字符串时仍会创建一个空 HTML 文档：

```
[2] (pry) main: 0> Nokogiri::HTML('')
=> #(Document:0x245962c {
  name = "document",
  children = [ #(DTD:0x24ab210 { name = "html" })]
  })
[3] (pry) main: 0> Nokogiri::HTML('').to_html
=> "<!DOCTYPE html PUBLIC \"-//W3C//DTD HTML 4.0 Transitional//EN\" \"http://www.w3.org/TR/REC-html40/loose.dtd\">\n\n" 
```

并且，此时，当您查看它的类时，您将获得一个 Nokogiri::HTML 文档：

```
[4] (pry) main: 0> Nokogiri::HTML('').class
=> Nokogiri::HTML::Document 
```

所以检查类名对`puts page.class`你没有任何好处。并且，寻找单元格将返回空：

```
[3] (pry) main: 0> Nokogiri::HTML('').css('td i.blue')
=> [] 
```

就个人而言，如果您想知道您是否阅读过文档，请查看是否有任何字符：

```
abort("Got nothing") if page.empty? 
```

而不是打印内容或查看 document.class。

另外，我会使用`page = File.read('file.html')`而不是`File.open`，但这只是我。

这一切都指向文件未找到或为空。您可以使用类似的东西`File.exists?('file.html')`来查找它的存在并`File.size('file.html')`在继续之前检查它是否有内容。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-10T16:43:38.460

我设法找出为什么 nokogiri 解析不起作用。

出于某种原因，如果该页面是从 Web 打开的，则该脚本可以运行，但如果该网页先保存到磁盘然后再打开，则该脚本不会运行。我发现当从磁盘打开页面时，它遇到了 nokogiri 错误，并且只读取并解析了文件的前几行。该错误是由于 html 注释未在同一行而是在后续行关闭。

我设法通过使用模式“rb”而不是“r”读取文件来克服这个问题。即，如果我将 file.open 行替换为：

```
page=File.open("file.html","rb"){|file| file.read} 
```

nokogiri 正确解析文件。

# php - RSS 提要和特殊字符

> ID：11783071
> 
> 赞同：4
> 
> 时间：2012-08-02T17:53:28.083
> 
> 标签：php, xml, rss, special-characters, htmlspecialchars

我已经工作了好几个小时来尝试获取 RSS 提要。问题在于特殊字符。我在网站上将数据列为列表，但我也想要一个 rss 提要。标题有“&”，写成$amp;。如果我使用 htmlspecialchars 它会将其转换为 $amp;amp; 如果我不这样做，验证器会因为“&”而给出错误。我不能写“&”，否则 html 将无法正确显示。我尝试不理会它并将其放在 Cdata 标记中，但这也不起作用。

这是提要： http: [//montanafarmersunion.com/rss.php](http://montanafarmersunion.com/rss.php)

这是同一列表的 html：[http ://montanafarmersunion.com/?hd=news&id=news](http://montanafarmersunion.com/?hd=news&id=news)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-03T01:03:29.560

[RSS 顾问委员会页面](http://www.rssboard.org/rss-profile#data-types-characterdata)很好地总结了这个问题：

> 该规范没有明确说明是否允许在项目描述以外的元素中使用 HTML，导致聚合器如何处理其他元素中的字符数据存在很大差异。这使得发布者特别难以确定如何对字符“&”和“<”进行编码，这些字符必须以 XML 进行编码。

也就是说，没有“正确”的方法。从理论上讲，您应该能够不使用 CDATA 标记，然后使用 HTML 编码您的标题。例如，这在 Firefox 和 IE8 中适用于我：

```
$title = 'August 1st: MFU President &amp; friends on farm bill';
echo '<title>'.trim($title).'</title>'; 
```

但是[W3 RSS 验证器](http://validator.w3.org/appc/)（这是您正在使用的吗？）建议不要使用它，因为`&amp;`基于上面链接的页面。他们建议使用十六进制字符引用，但仅限于`&`和`<`。实现这一点的最简单方法可能很简单`str_replace`：

```
$title = 'August 1st: MFU President & friends on farm bill';
$title = str_replace(array('&', '<'), array('&#x26;', '&#x3C;'), $title);
echo '<title>'.trim($title).'</title>'; 
```

（请注意，我已将起始字符串设为裸线`&`）

我也觉得有必要提及[这篇博](http://www.xn--8ws00zhy3a.com/blog/2006/06/encoding-rss-titles)文，这表明没有真正的方法可以让所有读者一直都开心。但最后一种方法应该得到大部分。

# mysql - 选择每个类别中时间戳最大的行

> ID：11783072
> 
> 赞同：9
> 
> 时间：2012-08-02T17:53:27.927
> 
> 标签：mysql, database, group-by

我有一个 MySQL 数据库（博客），它有一个 id、title、timestamp 和 category_id 列名。如何从具有最新时间戳的每个类别中选择一行？如果我有 3 行属于类别 1、2、1，那么我将返回两行，其中“1”中类别的最高时间戳作为第一行，类别“2”的行作为第二行。

我试过了：

```
SELECT title, timestamp, category_id
FROM blogs 
WHERE timestamp IN (
  SELECT MAX(timestamp) 
  FROM blogs 
  GROUP BY category_id
) 
```

但是由于时间戳不是唯一的，因此可以说，它可以拉入一个带有 category_id = 1 的额外行，该行与在内部选择语句中选择的 category_id = 2 的行具有相同的时间戳。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-08-02T18:04:47.553

~~对于 MySQL，此查询将返回您指定的结果集：~~

 ~~```
SELECT b.title
     , MAX(b.timestamp)
     , b.category_id
  FROM blogs b
 GROUP BY b.category_id 
```~~ 

~~如果在具有相同最新“时间戳”的类别中碰巧有多个“标题”，则只会返回该类别的一行，因此每个类别只会返回一个“标题”。~~

* * *

注意：其他 DBMS 系统将抛出与上述查询类似的异常（错误），因为 SELECT 列表中未出现在 GROUP BY 中的非聚合的处理。

您的查询非常接近。您已经获得了返回每个类别的“最新”时间戳的内部查询。下一步是返回 category_id 以及最新的时间戳。

```
SELECT category_id, MAX(timestamp) AS timestamp
  FROM blogs
 GROUP BY category_id 
```

下一步是将其加入到 中`blogs`，以获取关联的“标题”

```
SELECT b.title
     , b.timestamp
     , b.category_id
  FROM (SELECT category_id, MAX(timestamp) AS timestamp
          FROM blogs 
         GROUP BY category_id
       ) l
  JOIN blogs b
    ON b.category_id = l.category_id AND b.timestamp = l.timestamp 
```

注意：如果一个类别有多个“最新”行（时间戳值匹配），则此查询将返回它们。

如果这是一个问题，可以修改查询（或以不同的方式编写）以防止一个类别出现两行的任何可能性。

* * *

只需向该查询添加一个 GROUP BY 子句即可（仅在 MySQL 中，而不是在其他 DBMS 中）

```
SELECT b.title
     , b.timestamp
     , b.category_id
  FROM (SELECT category_id, MAX(timestamp) AS timestamp
          FROM blogs 
         GROUP BY category_id
       ) l
  JOIN blogs b
    ON b.category_id = l.category_id AND b.timestamp = l.timestamp
 GROUP BY b.timestamp, b.category_id 
```

（对于其他 DBMS，您可以修改 SELECT 列表，替换`b.title`为`MAX(b.title) AS title`。当您从行中返回单个列时，这将起作用。

如果您希望以特定顺序返回行，请添加 ORDER BY 子句。

* * *

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-03-16T16:47:05.897

你也可以试试这个方法。当我在 MYSQL 5.6 中尝试时为我工作。它返回具有最高时间戳和 category_id 升序的两个类别。

> SELECT title , timestamp , category_id FROM blogs WHERE timestamp in (select max(timestamp) from blogs group by category_id) group by timestamp,category_id order by category_id asc;

# python - QT4 (PyQt4) QTableWidget 信号没有触发

> ID：11783073
> 
> 赞同：1
> 
> 时间：2012-08-02T17:53:28.767
> 
> 标签：python, qt, user-interface, qt4, pyqt

![程序](../Images/d59248b10ccb61b761a09a155e1979a6.png)

我正在编写一个论坛帖子数据库的界面。

在上面的程序中，有一个工具箱小部件包含两个小部件，主题浏览器处于活动状态。主题浏览器由具有垂直布局的父 QFrame 组成，其中包含主题论坛类别标签、导航控件小部件和小部件的主体`QTableWidget`（QTW）。QTW 选择行为是`QAbstractItemView.SelectRows`.

问题是，当我将函数连接到`itemClicked()`信号时，信号仅在我将单元格选择到`posts`and`Views`列时才会触发，但在我单击主题单元格时不会触发`name`。我尝试了其他信号，它们具有相同的行为。需要注意的一点是，名称的第一个字符有些模糊。所以我在想这可能是导致问题的原因。

有什么建议吗？

**编辑**

设置表的代码

```
 class ForumTopicWidget(QFrame):
    def __init__(self,db):
        QFrame.__init__(self)

        self._db=db
        self._rowcount = 21
        self._current_page = 1
        self._forum_id = None
        self._category_id = None

        self._navigation_widget = NavigationHeadWidget()
        self._layout = QVBoxLayout()
        self._title_label = QLabel()
        self._title_label.setText("<b>Topics</b>")
        self._title_label.setAlignment(Qt.AlignCenter)
        self._layout.addWidget(self._title_label)
        self._layout.addWidget(self._navigation_widget)
        self._topic_list = QTableWidget()
        #self._topic_list.setMinimumWidth(600)
        self._topic_list.setRowCount(self._rowcount)
        self._topic_list.setColumnCount(3)
        self._topic_list.setHorizontalHeaderLabels(["Name","Posts", "Views"])
        self._topic_list.horizontalHeader().setResizeMode(0,QHeaderView.Stretch)
        self._topic_list.verticalHeader().setVisible(False)
        #self._topic_list.setColumnWidth(0,476)
        self._topic_list.setColumnWidth(1,61)
        self._topic_list.setColumnWidth(2,61)
        self._topic_list.setSelectionBehavior(QAbstractItemView.SelectRows)
        self._layout.addWidget(self._topic_list)
        self.setLayout(self._layout)
        self.setFrameStyle(QFrame.WinPanel)
        self._topic_list.cellClicked.connect(self.cell_clicked)
        self._navigation_widget.set_nav_functions(self._shift_first, 
                                                  self._shift_prev, 
                                                  self._shift_next, 
                                                  self._shift_last)
        self.page_ids = []

    def cell_clicked(self,item):
        self._prime_topic(self.page_ids[item])

    def set_item_click_function(self,function):
        self._prime_topic = function

    def set_initial_state(self, category_id, forum_name):
        self._category_id = category_id
        self._topic_count = self._db.get_topic_count(category_id)
        self._last_page = int(ceil(float(self._topic_count) / self._rowcount))
        self.shift_state(1) 
        self._title_label.setText("<b> %s Topics</b>" % forum_name)

    def shift_state(self, new_page):
        self._current_page = new_page
        self.populate_page(new_page)
        self._navigation_widget.set_pagination_string(self._current_page, 
                                                      self._last_page)
    def _shift_first(self):
        self.shift_state(1)
        self._current_page = 1

    def _shift_prev(self):
        if self._current_page != 1:
            self._current_page = self._current_page - 1
            self.shift_state(self._current_page)

    def _shift_next(self):
        if self._current_page != self._last_page:
            self._current_page = self._current_page + 1
            self.shift_state(self._current_page)

    def _shift_last(self):
        self.shift_state(self._last_page)

    def populate_page(self,page_number):
        pages = self._db.get_paginated_topics(self._category_id,page_number,self._rowcount);

        i=0
        self.page_ids[:]=[]
        for page in pages:
            self.page_ids.append(page.id)
            q = QLabel()
            q.setText('<font size ="3">%s</font>' % page.title)
            self._topic_list.setCellWidget(i,0, q)
            pc = QTableWidgetItem(str(page.post_count))
            vc = QTableWidgetItem(str(page.view_count))
            pc.setFlags(QtCore.Qt.ItemIsEnabled)
            #pc.setFlags(QtCore.Qt.ItemIsEnabled)
            self._topic_list.setItem(i,1, pc)
            self._topic_list.setItem(i,2, vc)
            i = i +1 
```

问题出现在 OS X 和 Linux 上。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-02T19:24:53.080

来自 freenode 上 irc 频道 #qt 的 Sqwishy 指出了我的错误。

第一列是`QLabel`'s 而不是标准文本。QLabels 有自己的信号。第二两列是表格管理信号的类型。我使用 Label 而不是 a 的原因`QTableWidgetItem`是因为我想调整字体大小并且认为这是唯一的方法。

populate_page 方法应如下所示：

```
 def populate_page(self,page_number):
        pages =\ 
        self._db.get_paginated_topics(self._category_id,page_number,self._rowcount);

        i=0
        self.page_ids[:]=[]
        for page in pages:
            self.page_ids.append(page.id)
            nc = QTableWidgetItem(str(page.title))
            pc = QTableWidgetItem(str(page.post_count))
            vc = QTableWidgetItem(str(page.view_count))
            self._topic_list.setItem(i,0,nc)
            self._topic_list.setItem(i,1, pc)
            self._topic_list.setItem(i,2, vc)
            i = i +1 
```

# c# - 按位数学可以用于 SQL 中的一对多关系吗？

> ID：11783079
> 
> 赞同：11
> 
> 时间：2012-08-02T17:53:43.097
> 
> 标签：c#, sql, enums, bit-manipulation

RDBMS 中的适当规范化意味着表的增殖。整数字段可以将正交数据存储为位——这可以用作附加表的替代品，而不牺牲关系完整性吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-08-02T17:53:43.097

对于一对多关系，其中“多”具有少量已知值，可以将关系作为位掩码作为整数存储在父表中，从而无需额外的表。

假设我们有一张桌子 Person，我们想知道一个人访问过多少个大陆。我们首先为每个大陆分配一个“正交”位值。在 C# 中，枚举是一个不错的选择：

```
[Flags]
public enum JobAdvertisingRegion
{
    NorthAmerica = 1,              // or 1 << 0
    SouthAmerica = 2,              // 1 << 1
    Europe = 4,                    // 1 << 2
    Asia = 8,                      // 1 << 3
    Africa = = 16,                 // 1 << 4
    Australia = 32,                // 1 << 5
    Anarctica = 64                 // 1 << 6
} 
```

Persons 表可以简单地有一个称为 Contintents 的 int 列。表示一个人访问过欧洲和亚洲：

```
UPDATE Persons SET Continents = (4 + 8) WHERE Id = whatever 
```

要搜索访问过南极洲的人，我们使用按位数学：

```
SELECT * FROM Persons WHERE Continents & 64 = 64 
```

要搜索访问过非洲和亚洲的人员：

```
SELECT * FROM Persons WHERE Continents & (16 + 8) = (16 + 8) 
```

要搜索访问过澳大利亚或南美的人：

```
SELECT * FROM Persons WHERE Continents & (32 + 2) != 0 
```

一个缺点是，虽然整数列在 SQL 中是可索引的，但它们的位组件不是。对于上述查询，一些优化可以解决这个问题：

```
SELECT * FROM Persons WHERE Continents & 64 = 64 AND Continents >= 64

SELECT * FROM Persons WHERE Continents & (16 + 8) = (16 + 8) AND Continents >= (16 + 8)

SELECT * FROM Persons WHERE Continents & (32 + 2) != 0 AND Continents >= 2 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-08-02T18:12:30.450

你的问题的答案是“不”。位字段牺牲了关系完整性，原因很简单，数据库中的实体没有对应的表。

也就是说，许多数据库为此提供支持，通常是通过“位”数据类型。Mysql 具有更强的支持，具有“set”数据类型。

主要问题是您对集合中的元素一无所知——全名是什么，何时将其添加到数据库中，等等。（枚举解决了部分命名问题。）此外，集合的大小是有限的。你可能有一个例子，事情是有限的。然而，Matt 的例子更强调了这里的问题。您可以查看访问过的大陆列表。但是，当您切换到访问过的国家时，方法必然会大不相同，因为国家的数量不再适合单个“单词”。您是否希望您的系统在这方面以与国家截然不同的方式对待大陆？您是否希望您的设计决策受到计算机字中 32 位或 64 位的限制？

最后，您似乎将表格的激增视为一个问题。表的扩散实际上是一种解决方案。所有关于实体的数据都存储在表中，而不是通过系统分散。您可以维护有关实体实例的信息，例如创建实例的时间、它可能随时间发生的变化等。每当有人想要一个大陆时，都可能使用“大陆”的实体。

考虑在两个不同的开发人员决定为大陆开发自己的位掩码的系统中会发生什么——但他们将大陆按不同的顺序排列。使用设计良好的关系数据库（意味着在表定义中明确声明外键关系），就不会出现这种混淆。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-02T19:16:07.467

好吧，我将通过简单地陈述一些事实来反对（当前）流行的观点

*   SQL 和关系模型**不是**一回事。
*   关系模型（理论）适用于关系变量，即所谓**的 relvars**。
*   SQL 数据库使用表。
*   表和相关变量不一样，但可以——出于所有实际目的。
*   要使用关系建模理论，表应该代表相关变量。
*   对于表示关系变量的表，应满足以下条件：

    1.  行没有顺序
    2.  列没有顺序
    3.  没有重复的行
    4.  每个列-行交集只有一个列定义类型的值
    5.  没有特殊的隐藏列（行 ID、对象 ID ...）

因此，您可以使用超出关系设计理论范围的表和 SQL 做很多事情，但是您确实失去了“关系”的好处......

从技术上讲，您的帖子（问题）有两个答案。

*   是的，到帖子的标题。
*   不，到帖子的正文。

# objective-c - AVAudioPlayer 只播放部分声音

> ID：11783081
> 
> 赞同：2
> 
> 时间：2012-08-02T17:53:45.417
> 
> 标签：objective-c, ios, xcode, avfoundation, avaudioplayer

当使用 AVAudioPlayer 按下按钮时，我正在尝试播放歌曲剪辑。整个剪辑在 Xcode 中播放良好，但是当我在设备上加载应用程序并按下按钮时，它会播放歌曲的第一秒，然后安静下来。

我在 viewDidLoad 下有这个：

```
NSURL *url = [NSURL fileURLWithPath:[NSString stringWithFormat:@"%@/Song.aiff", [[NSBundle mainBundle] resourcePath]]];

player = [[AVAudioPlayer alloc] initWithContentsOfURL:url error:&audioFileError];
player.numberOfLoops = -1; 
```

然后当按下按钮时：

```
if (player == nil)
    NSLog(@"Audio file could not be played");
else
    [player play]; 
```

编辑：我也对如何播放音频剪辑的其他建议持开放态度，AVAudioPlayer 似乎是最简单和最直接的方法。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-02T19:10:42.240

实例化 AVAudioPlayer 后，您就错过了这个：

```
[self.player prepareToPlay]; 
```

此方法为播放准备缓冲区。

在引用您的变量时也使用`self`，这样您就可以通过访问器方法正确访问实例变量，而不是直接访问 ivar。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-02T19:08:28.110

由于 8vius 修复了它，放入

```
[player prepareToPlay]; 
```

在 numberOfLoops 行之后，它就像一个魅力。

# javascript - HTML5 元素在 Firefox、Opera 和 Safari 中不起作用

> ID：11783083
> 
> 赞同：0
> 
> 时间：2012-08-02T17:53:48.060
> 
> 标签：javascript, html, firefox, safari, opera

我有一个 HTML5`<video>`元素可以在 Chrome 中完美运行，但在 Firefox 和 Opera 中都不能。

这是 HTML 代码：

```
<div id="tele">
    <video id="v" width="254" height="204" autoplay>
    <source id="mp4" src="/media/joies.mp4" type="video/mp4" />
     <source id="ogg" src="/media/joies.ogv" type="video/ogg" />         
     <source id="webm" src="/media/joies.webm" type="video/webm" /> 
     <object id="flash" type="application/x-shockwave-flash"
        data="player.swf?file=joies.mp4">
        <param id="flash2" name="movie" value="player.swf?file=joies.mp4" />
    </object> </video>

</div>

<ul>
        <li><a href="#" class="activo"
                    onClick="changeVideo('/media/joies.ogv','/media/joies.mp4','/media/joies.webm','player.swf?file=joies.mp4','player.swf?file=joies.mp4','<?php echo __('Col·leccions. Música de Kaiserama. Compositor Oscar Kaiser.')?>')">1</a>

        </li>
        <li><a href="#"
            onClick="changeVideo('/media/CanalTE.ogv','/media/CanalTE.mp4','/media/CanalTE.webm','player.swf?file=CanalTE.mp4','player.swf?file=CanalTE.mp4','<?php echo __('Joies Corrents. Música de Kaiserama. Compositor Oscar Kaiser')?>')">2</a>
        </li>
        <li><a href="#"
            onClick="changeVideo('/media/FAD.ogv','/media/FAD.mp4','/media/FAD.webm','player.swf?file=FAD.mp4','player.swf?file=FAD.mp4','<?php echo __("Enjoia\'t 06\. Orfebres Fad.")?>')">3</a>
        </li>
    </ul> 
```

和 JavaScript 代码：

```
function changeVideo(v,x,w,y,z,tit) {
    var presentationImg = "presentationImg";
    var presentationImg2 = "presentationImg2";
    document.getElementById("mp4").src=x;
    document.getElementById("ogg").src=v;    
    document.getElementById("flash").data=y;
    document.getElementById("flash2").value=z;
    document.getElementById("webm").src=w;
    document.getElementById("titol").innerHTML=tit
    var video = document.getElementById('v');
    video.load();
    video.play();
    } 
```

访问网站：[http](http://www.saradomenech.com/ca/zapping) ://www.saradomenech.com/ca/zapping 问题出在哪里？

谢谢

问候

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-02T17:56:34.470

尝试将*ogg*元素放在视频标签的首位。

```
<source id="ogg" src="/media/joies.ogv" type="video/ogg" /> 
```

# html - ie8中的菜单项重叠

> ID：11783084
> 
> 赞同：4
> 
> 时间：2012-08-02T17:53:48.860
> 
> 标签：html, css, menu

嗨——由于某种原因，我的 2 个菜单项在 ie8 中重叠（见下面的截图——项目“关于我们”和“新闻”，而且这两个项目之间的空间中的背景是白色的）在我的网站 http://goo.gl /34oQ8 - 知道为什么吗？

![在此处输入图像描述](../Images/c1a11f31c5b6bd19db3b29dcb62ee72f.png)

CSS 代码

```
#nav
{
        right:2%;
        list-style:none;
        position:fixed;
        /* float:right; */
        top:30px;
        z-index:1000;
        /* width:520px; */
}

#nav > li {
    display: inline-block;
    /* dirty hack for IE7 */
    *display: inline;
    *zoom: 1;
}

#nav a
{
        font:12px 'Open Sans', "Helvetica Neue", Helvetica, Arial, "Lucida Grande", sans-serif;
        font-weight:600;
        letter-spacing:1px;
        float:left;
        top:30px;
        display:inline-block;
        font-size:11px;
        margin-left:5px;
        margin-right:5px;
        padding-left:15px;
        padding-right:15px;
        text-decoration:none;
        height:24px;
        color:#666;
        line-height:24px;
        text-align:center;
        box-shadow:1px 1px 2px rgba(0,0,0,0.2);
        /* background:rgba(255,255,255,0.9);  removed not ie8 compatible */
        text-transform:uppercase;
        background: white;
    opacity: 0.8;
    filter: Alpha(opacity='80');
}

#nav a:hover
{
        background:#dedede;
}

#nav .current a
{
        background:#666;
        color:#ededed;
} 
```

HTML 代码

```
 <ul id="nav">
  <li class="current"><a href="#presentation">Home</a></li>
  <li><a href="#equipe">Team</a></li>
  <li><a href="#plan-activite">About us</a></li>
  <li><a href="#medias">Press</a></li>
  <li><a href="#inline" class="modalbox">Contact</a></li>
</ul> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-02T17:58:25.283

我不认为在`<a>`元素上设置边距会隔开`<li>`你想要的 's 。尝试添加 margin-left 和/或 margin-right 来`nav li`代替

此外，HTML5 包含一个`<nav>`标签，可以很好地替换您的 id="nav"

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-02T18:40:54.487

您需要将所有间距和填充元素移动到 #nav > li 中。

#nav a 中的代码应仅用于设置链接项的样式，因为 LI 可用于设置菜单项本身的样式。

```
#nav > li {
            display: inline-block;
            margin: 0 5px;
            padding: 3px 15px;
} 
```

这将开始稍微清理代码..

# c++ - 获取准确的窗口区域大小 - CreateWindow 窗口大小不是正确的窗口大小

> ID：11783086
> 
> 赞同：4
> 
> 时间：2012-08-02T17:53:57.220
> 
> 标签：c++, window, gdi, createwindow

在尝试在 C++ 中创建一个窗口并绘制窗口大小与我设置的大小不匹配的矩形时，我注意到一些非常烦人的事情。

例如，如果我设置 480x240 窗口并尝试通过获取 GetWindowRect(hwnd, &rect) 从上到下、从左到右绘制矩形并计算宽度和高度：

```
rectangle_width = (rect.right - rect.left) / amountRectangleX;
rectangle_height = (rect.bottom - rect.top) / amountRectangleY; 
```

如果 amountRectangleX = 2 和 Y = 2 它会绘制 4 个矩形，但宽度和高度是“关闭的”，因此它不会填满整个屏幕或渲染它。发生这种情况的唯一方法（我已经用很多其他语言做过，所以我知道它有效）是，如果我设置 Window Size = 480x240，我希望它成为“DRAW”的区域。因为如果边框包含在窗口的大小中 - 在另一台具有不同窗口样式等的计算机上会有所不同。而且我不能只是为我的计算机手动“更改”它。

如果我设置窗口大小 = 480x240 并截屏，我会看到窗口空间 = 452x232，这令人困惑。如果我设置窗口大小 = 480x240 就可以了，但是当我 GetWindowRect() 我得到 452x232 而不是 480x240 时这是无效的，因为我没有足够的空间来绘制。这可以解释为什么我的 Rectangles 渲染超出了窗口空间，而我不希望这样。但我仍然希望能够设置我的尺寸 = 480x240 或其他任何东西，但仍然有边框。

为什么它会以这种方式工作，是否有解决此问题的方法？我不能是唯一一个想要能够设置窗口分辨率的人，无论您使用什么计算机，您设置的尺寸都是您可以绘制的绘图区域。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-07T14:09:05.587

我使用这种方法，现在它可以工作了：

```
if ( IsWindow( hwnd ) )
{

DWORD dwStyle = GetWindowLongPtr( hwnd, GWL_STYLE ) ;
DWORD dwExStyle = GetWindowLongPtr( hwnd, GWL_EXSTYLE ) ;
HMENU menu = GetMenu( hwnd ) ;

RECT rc = { 0, 0, width, height } ;

AdjustWindowRectEx( &rc, dwStyle, menu ? TRUE : FALSE, dwExStyle );

SetWindowPos( hwnd, NULL, 0, 0, rc.right - rc.left, rc.bottom - rc.top, SWP_NOZORDER | SWP_NOMOVE ) ;

} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-12-24T17:06:08.137

就像@Deukalion 一样，我无意中将所需的*客户区*大小放入了`::CreateWindow()`调用中，在绘制网格时，我发现自己缺少像素。我采用了相同的方法来调查我的应用程序屏幕截图的像素大小。我可以理解窗口的边框和标题栏从客户区占用了一些空间 - 但令人沮丧的是，在 Windows 10 下，甚至整个应用程序窗口都没有请求的大小！

我怀疑`::CreateWindow()`通过在宽度和高度上减去硬编码的像素数量来计算更小的客户区，然后围绕它构建窗口边框和标题栏。对于 Windows 10 的超薄鲜明的窗口主题，这个硬编码的数字不再正确。这太荒谬了 - 屏幕上真的*没有任何*`::CreateWindow()`要求的尺寸！

我听从了@PeterRuderman 的建议来使用这个`::AdjustWindowRect()`电话：

```
RECT rect;
rect.left = rect.top = 0;
rect.right = clientWidth;
rect.bottom = clientHeight;
::AdjustWindowRect(&rect, wflags, false);
HWND hWindow = ::CreateWindow(wcName, title, wflags, 0, 0,
  rect.right - rect.left, rect.bottom - rect.top, 0, 0, hInstance, 0); 
```

*   如[https://msdn.microsoft.com/en-us/library/windows/desktop/dd162897.aspx](https://msdn.microsoft.com/en-us/library/windows/desktop/dd162897.aspx)所述，RECT 结构将`right`and`bottom`字段视为预期矩形*之外。*
*   如果`::AdjustWindowRect()`将给定的原点坐标 (0,0) 保持不变，那就太好了，这样`right`和`bottom`可以直接填充到`::CreateWindow()`调用中。但令我惊讶的是，`left`and`bottom`字段变为负数。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-02T18:40:52.240

我仍然认为您没有提供足够的信息来解决您的问题，但这里有一个完整的程序（基本上）可以满足您的需求。你可以把它和你自己的比较一下，看看你哪里出错了。

```
#include <Windows.h>

LRESULT CALLBACK WindowProc( HWND hwnd, UINT uMsg, WPARAM wParam, LPARAM lParam )
{
    switch( uMsg ) {
    case WM_CLOSE:
        PostQuitMessage( 0 );
        break;

    case WM_PAINT:
        {
            RECT clientArea;
            GetClientRect( hwnd, &clientArea );

            PAINTSTRUCT ps;
            BeginPaint( hwnd, &ps );

            HBRUSH brush = (HBRUSH)GetStockObject( BLACK_BRUSH );

            RECT topLeft = clientArea;
            topLeft.right /= 2;
            topLeft.bottom /= 2;

            RECT bottomRight = clientArea;
            bottomRight.left = bottomRight.right / 2;
            bottomRight.top = bottomRight.bottom / 2;

            FillRect( ps.hdc, &topLeft, brush );
            FillRect( ps.hdc, &bottomRight, brush );

            EndPaint( hwnd, &ps );
        }

        return 0;
    }

    return DefWindowProc( hwnd, uMsg, wParam, lParam );
}

int CALLBACK WinMain( HINSTANCE hInstance, HINSTANCE hPrevInstance, LPSTR lpCmdLine, int nCmdShow )
{
    // Error checking omitted for brevity.
    WNDCLASSEX wc = { 0 };

    wc.cbSize = sizeof( wc );
    wc.lpfnWndProc = WindowProc;
    wc.hInstance = hInstance;
    wc.hbrBackground = (HBRUSH)(COLOR_WINDOW + 1);
    wc.lpszClassName = L"testclass";

    ATOM classAtom = RegisterClassEx( &wc );

    HWND window = CreateWindow( L"testclass", L"Test", WS_OVERLAPPEDWINDOW | WS_VISIBLE, CW_USEDEFAULT, CW_USEDEFAULT, 480, 240, NULL, NULL, hInstance, NULL );

    MSG msg;

    while( GetMessage( &msg, NULL, 0, 0 ) ) {
        TranslateMessage( &msg );
        DispatchMessage( &msg );
    }
} 
```

**编辑**

重新阅读您的问题后，我认为您只是在寻找 AdjustWindowRect API。在这种情况下，您的问题与以下问题重复：[WinAPI: Create a window with a specified client area size](https://stackoverflow.com/questions/4843806/winapi-create-a-window-with-a-specified-client-area-size)。为了将来参考，“您可以绘制的区域”称为客户区。

# java - 可以有一个扩展抽象类的空子类吗？

> ID：11783091
> 
> 赞同：6
> 
> 时间：2012-08-02T17:54:09.063
> 
> 标签：java, abstract-class, subclass

考虑以下：

```
 public abstract class Item {
     String name;
     String description;
     //concrete getters and setters follow
  }

   public class InventoryItem extends Item {
     //empty subclass of Item 
   }

  public class CartItem extends Item {
     int quantity;
     int tax;
     //getters and setters for quantity and tax follow
  } 
```

InventoryItem 表示可供出售的商品，而 CartItem 表示添加到购物车中的商品，因此它具有额外的属性，例如数量和税金。在这种情况下可以有一个抽象类 Item 的空子类吗？

选项 2：我们可以有一个空的 Item 接口。InventoryItem 将实现 Item 并定义名称和描述属性，并具有 getter 和 setter。CartItem 将从 InventoryItem 扩展，并将数量和税收定义为属性，并具有 getter 和 setter。

选项3：有一个Item界面会更好吗？InventoryItem 将实现 Item。然后我们可以有一个 CartItem 类，它“有一个”项目和两个属性，即税和数量

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-02T18:17:01.273

我认为这种设计没有任何问题：它清楚地指定`Item`为基础，和`InventoryItem`/`CartItem`作为可实例化的类。我将重命名`Item`为`AbstractItem`（Java 类库执行此操作）以强调该类的预期用途将用作其他类的基础这一事实。

存在 C++ 特定的问题，例如[通过基指针赋值](http://ptgmedia.pearsoncmg.com/images/020163371x/items/item33.html)，这使得将所有“非叶”类抽象化是非常可取的。尽管该规则并未从字面上翻译成 Java，但我认为将非叶类抽象化仍然是一个好主意，即使该类是自给自足的。这有助于您在用于直接实例化的类和用于扩展的类之间进行显式分离，这有利于不熟悉您的代码库的人进行维护。

将规则更进一步，在 Java 中创建所有叶类是一种常见的做法`final`。这是一个很好的防御规则，尤其是当你的类是不可变的时。

**编辑：**就购物车中的建模项目而言，继承不是最佳选择。事实上，我认为这样做是错误的。我会`CartItem`自己做一个`Item`，而不是扩展它，因为该项目不会通过放置在购物车中而成为另一种实体。这是我认为应该建模的方式：

```
public class Item {
    String name;
    String description;
    ...
}

public class CartItem {
   Item item;
   int quantity;
   int tax;
   ...
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-02T19:26:59.650

让我提供一个稍微长一点的建议或意见，这可能会提供一些指导。

在设计 is-a 层次结构时，我倾向于仅通过多态性来区分行为。一般来说，我倾向于避免仅通过数据区分对象。多年来，我什至停止为类似结构的“数据对象”创建继承层次结构，仅根据它们所持有的变量。

我花费最多的时间是在方法方面定义抽象类的通用接口，然后让子类都适用于相同的接口，但具有不同的行为。（里氏替换原则）

在这种情况下，我会考虑一个通用接口/抽象 Item 类，它具有 Item 实现的层次结构，它们在库存、计算税收等方面有所不同。我可以有一个方法 .isInCatalog() 来告诉我 item 在哪里或什么如果我必须以不同的方式处理它，这是它的本质，但我仍然会尝试将大多数项目类型特定逻辑封装到其多态方法的实现中。

尽管这些类型的计算实际上通常在数据库上的批处理/聚合操作中完成，而不是在单个对象中完成，但我会在抽象级别上使用 .getTax()、.getQuantity()，然后拥有具有不同行为的子类. （考虑将 NullObject 重构为无所事事以避免处理空值）

这篇可靠的博客文章中概述了有助于这种设计的一些原则：

[http://codebork.com/2009/02/18/solid-principles-ood.html](http://codebork.com/2009/02/18/solid-principles-ood.html)

# razor - ASP.NET MVC 4 / Web API - 为接受插入 Razor 渲染器：text/html

> ID：11783094
> 
> 赞同：8
> 
> 时间：2012-08-02T17:54:29.473
> 
> 标签：razor, asp.net-mvc-4, asp.net-web-api, content-negotiation

我正在使用 ASP.NET MVC 4 Web API 创建一个 RESTful Web 服务。对于 API 访问，我将返回 JSON，但一旦我让一切正常工作，默认情况下内容协商应该适用于 XML 和 JSON。

由于我正在努力实现真正以 RESTful 资源为中心的 Web 服务，因此我的 URI 将指向实际资源。如果请求中出现，我想通过返回资源的 HTML 表示来利用这一点`Accepts: text/html`（比如在浏览器中抛出链接）。

我希望能够利用 MVC 4 Web API 的内容协商为使用 Razor 模板的 text/html 插入渲染器。有没有这样做的工作示例？

是的，这是桥接“常规”MVC 页面和 Web API。基本上我想创建一个渲染器，它使用基于约定的方法来查找和渲染 Razor 视图，就像“常规”MVC 一样。我可以提出基于约定的视图查找逻辑。 **我只是在寻找** ***a)***将我的渲染器全局插入`text/html`到内容协商中，以及***b)***手动使用 Razor 引擎将我的模型渲染为 HTML。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-02T18:46:20.960

Fredrik Normén 有一篇关于这个主题的博文：

[http://weblogs.asp.net/fredriknormen/archive/2012/06/28/using-razor-together-with-asp-net-web-api.aspx](http://weblogs.asp.net/fredriknormen/archive/2012/06/28/using-razor-together-with-asp-net-web-api.aspx)

基本上，您需要创建一个`MediaTypeFormatter`

```
using System;
using System.Net.Http.Formatting;

namespace WebApiRazor.Models
{
    using System.IO;
    using System.Net;
    using System.Net.Http.Headers;
    using System.Reflection;
    using System.Threading.Tasks;

    using RazorEngine;

    public class RazorFormatter : MediaTypeFormatter
    {
        public RazorFormatter()
        {
            SupportedMediaTypes.Add(new MediaTypeHeaderValue("text/html")); 
            SupportedMediaTypes.Add(new MediaTypeHeaderValue("application/xhtml+xml"));
        }

        //...

        public override Task WriteToStreamAsync(
                                                Type type,
                                                object value,
                                                Stream stream,
                                                HttpContentHeaders contentHeaders,
                                                TransportContext transportContext)
        {
            var task = Task.Factory.StartNew(() =>
                {
                    var viewPath = // Get path to the view by the name of the type

                    var template = File.ReadAllText(viewPath);

                    Razor.Compile(template, type, type.Name);
                    var razor = Razor.Run(type.Name, value);

                    var buf = System.Text.Encoding.Default.GetBytes(razor);

                    stream.Write(buf, 0, buf.Length);

                    stream.Flush();
                });

            return task;
        }
    }
} 
```

然后在 Global.asax 中注册：

```
GlobalConfiguration.Configuration.Formatters.Add(new RazorFormatter()); 
```

*上面的代码是从博客文章中复制的，不是我的工作*

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-01-30T23:21:27.653

你可以看看[WebApiContrib.Formatting.Razor](https://github.com/WebApiContrib/WebApiContrib.Formatting.Razor)。它与 Kyle 的答案非常相似，但它是一个成熟的开源项目，具有更多功能、单元测试等。您也可以[在 NuGet 上获得它](http://www.nuget.org/packages/WebApiContrib.Formatting.Razor/)。

我会说它肯定需要更多功能，但他们似乎设计得很好，所以很容易为它做出贡献。

# php - 在动态导航表上均匀填充单元格时改变宽度

> ID：11783096
> 
> 赞同：2
> 
> 时间：2012-08-02T17:54:34.933
> 
> 标签：php, html, css

我目前在我的网站顶部有一个表格，它由一个 100% 宽度的表格、一行和几个表格分区组成。nav 分区的数量取决于你所在的页面，并且是动态生成的，所以没有办法轻松设置 td 宽度。此外，我正在尝试使用箭头的小图像作为每个导航项目的一种项目符号，每个导航项目的文本居中，但如果我无法使其对齐，我最终可能会删除它。

我的最终目标是在导航栏上有 6 到 10 个项目，大小不同以适合文本，同时将这些 td 单元格均匀分布在栏中，均匀分布。当我尝试同时使用箭头和文本时出现了我的问题，因为文本会自动自动换行到下一行而不是与文本对齐。这使得桌子形状奇怪。此外，在我尝试过的某些情况下，第一个单元格可能具有我设置的正确填充大小，例如左 7px，但是到表格行的末尾，间距完全错误，例如接近 50px。

是否有某种 div、td 和 CSS 组合来完成这项工作？用 div 代替我会更好吗？我已经没有想法如何在保持导航格式的同时均匀对齐这些单元格。任何帮助表示赞赏。

这是我目前所在的屏幕截图：http: [//dl.dropbox.com/u/27295687/Untitled.png](http://dl.dropbox.com/u/27295687/Untitled.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-02T21:54:16.530

您**需要**向我们展示制作此栏的代码。有一百种方法可以在 HTML 中实现这一点。

如果您的箭头图像包含在`<div>`. div-s 会自动占据一整行`width: 100%`。确保您的图像具有宽度，如果它被包裹在一个 div 中，请使用以下样式：

```
<div style="display: inline-block;"><img src="arrow.gif"></div> 
```

但是，如果我们看到代码，您可以获得直接的答案。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-02T21:28:09.210

这是[**你**](http://jsfiddle.net/ajrGG/)想要做的吗？

我猜关键的 CSS 属性`table-layout: fixed;`在 table 元素上

# javascript - `For 循环` 停留在 0

> ID：11783103
> 
> 赞同：0
> 
> 时间：2012-08-02T17:54:53.663
> 
> 标签：javascript, for-loop

我有一个循环问题。它不会从 0 增加“i”值。你能帮我吗？

这是我的代码：

```
var users = ["a", "b", "c"];

if (users.length > 0) {
    $(".ajax").live("submit", function(){
        for (var i=0; i < users.length; i++) {
            console.log(i);

            var forma = $(this);

            $("input[name=_session]", forma).val(users[i]);

            ajaxy(forma, function(data){
                console.log(data.status);
            });

            return false;
        }
    });
} else... 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-08-02T17:57:32.150

在循环的第一次迭代后返回 false。我认为您需要将`return false;`线路移出循环块。

正确缩进你的代码会使这样的错误很明显：

```
if (users.length > 0) {
    $(".ajax").live("submit", function () {
        for (var i = 0; i < users.length; i++) {
            console.log(i);
            var forma = $(this);
            $("input[name=_session]", forma).val(users[i]);
            ajaxy(forma, function (data) {
                console.log(data.status);
            });
            return false; // This should not be here
        }
    });
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-02T17:58:33.147

for 循环中的 return 语句导致它在进入下一次迭代之前退出。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-02T17:59:02.773

因为你返回循环的第一次迭代，我想。

# javascript - 这是什么 JavaScript/JQuery 语法？

> ID：11783106
> 
> 赞同：14
> 
> 时间：2012-08-02T17:55:02.183
> 
> 标签：javascript, jquery

我不知道如何搜索这个，所以我在这里问。

我继承了一个项目，这里没有人知道这个语法技巧叫什么。

如果从列表中选择了一个或另一个特定值，则有一个选择下拉更改事件将调用一个函数。

```
$('#accordion select[name=x_range]').change(function(){
  $('#custom-time')[$(this).val() == 'custom' ? 'show' : 'hide']();
  $('#custom-time-to-now')[$(this).val() == 'custom_to_now' ? 'show' : 'hide']();
  updateTimeIntervalOptions();
}).triggerHandler('change'); 
```

在此显示或隐藏函数在`#custom-time`或`#custom-time-to-now`div 上调用。

像这样的调用函数是什么？

编辑：
我应该说我理解三元 if/else，但不是`$(selector)[function_name]()`部分。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-08-02T18:16:27.917

我会说这不是一个技巧，而是对javascript的三个特性的理解。

首先，函数是一流的对象，因此您可以将它们分配给变量等

```
 var f = function () { ... }
 var b = [];
 b[1] = f; // assigning function to array element
 b[1]();   // calling function assigned to array element 
```

其次，方便的三元运算符，它是组合`if`和赋值的有效简写符号：

```
 var a = (b >c ) ? b : c;

 // is the same as

 if (b > c ) {
     a = b;
 } else {
     a = c;
 } 
```

最后但并非最不重要的一点是，每个对象属性都可以作为字典元素访问，即

```
 a.b = 5
 a['b'] === 5 // true! 
```

所以把所有这些放在一起你可以有这样的表达

```
$(selector)[condition?'show':'hide'](); 
```

这等于

```
if (condition) {
   $(selector).show();
} else {
   $(selector).hide();
} 
```

**更新**：关于这个特殊情况的一个注释。在大多数情况下，您不需要做这样复杂的事情，因为`$().toggle()`接受布尔参数来打开和关闭，所以

```
$(selector)[condition?'show':'hide'](); 
```

将以相同的方式工作

```
$(selector).toggle(!!condition); 
```

请注意，我使用 !! 为了将值转换为布尔值，因为切换检查参数使用`===`

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-08-02T17:58:27.177

> 像这样的调用函数是什么？

糟糕的编码习惯。

这是一种动态调用`show()`or`hide()`函数的方法。看着真恶心

编辑：显然我的回答对某些人来说是“有争议的”。请让我澄清一下：如果我可以在三元运算符上编写 if-else 语句——尤其是对于字符串比较之类的事情——我肯定会更清楚更短的代码。

这不是“令人讨厌的外观”，因为只是三元运算符或只是方法的括号访问。看起来很讨厌，因为代码在清晰性上采用了捷径，并在不需要时采用了捷径。

三元运算符也不错。支架访问还不错。但它们是易变的概念，很容易被滥用。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-08-02T18:00:48.073

显然它被称为[括号表示法](http://bclary.com/2004/11/07/#a-11.2.1)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-08-02T18:04:13.410

三元运算符将值设置为两个或多个选项（可以嵌套）。

将它们视为一个`switch`或一个`if/else`或一个`if/elseif/.../else`操作，但仅用于设置 ONE 值。

所以看看类似的东西：

```
var name = X === Y ? "Bob" : "Doug";
sayHello(name); 
```

这是一个三元条件，可以根据条件是真还是假来选择设置名称。

在您的 jQuery 中，他们只是跳过了一步，通过使用带有三元内部的括号表示法。

```
People[ (selected_person === "Bob") ? "Bob" : (selected_person === "Doug") ? "Doug" : "Jimmy" ].sayHi(); 
```

这将要求`sayHi()`或，`People.Bob`基于的值。`People.Doug``People.Jimmy``selected_person`

所以这是一个用于选择对象属性的三元条件，嵌套在括号符号内，而不是分两步完成：

```
 var person = // ternary from last step
 People[person].sayHi(); 
```

**编辑：**

根据您的编辑，它是括号符号。

```
MyObj = { myFunc : function () { doStuff(); } }; 
```

您可以`myFunc`通过几种不同的方式调用。
通过使用点表示法：`var func = MyObj.myFunc;`或通过括号表示法：`var func = MyObj["myFunc"];`
无论哪种方式，现在的值`func`都是`myFunc`。

所以他们正在做的是将 a 设置为`string`他们想要调用的函数的名称。

`var string = "show";`
`MyObj[string] // = MyObj.show`
`MyObj[string]() // = MyObj.show()`

对于您的代码，他们使用三元来确定字符串的值。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-08-02T18:01:19.387

它被称为“数组表示法”。看这里：[http ://www.erichynds.com/jquery/accessing-jquery-methods-using-array-syntax/](http://www.erichynds.com/jquery/accessing-jquery-methods-using-array-syntax/)

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2012-08-02T18:02:07.860

作者使用三元运算符 ( `? :`) 来调用使用数组表示法的 jQuery 对象的成员函数，`el['show']()`而不是`el.show()`. 分解，它看起来像：

```
var fnName;
if($(this).val() == 'custom') {
  fnName = 'show';
} else {
  fnName = 'hide';
}

$('#custom-time')[fnName]();  // an alternative to $('#custom-time').show() or .hide() 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-08-02T18:02:59.683

我不认为这种模式有一个特定的名称。有一个条件运算符用于选择不同的方法名称，然后使用此字符串以“括号”或“数组”语法动态调用该方法。

# ruby-on-rails - 一旦我从另一个位置保存它，Rails 就不再写入 development.log 文件

> ID：11783109
> 
> 赞同：0
> 
> 时间：2012-08-02T17:55:18.300
> 
> 标签：ruby-on-rails, macos, textmate

我面临一个非常奇怪的问题。当我开始时`rails s`，Rails 会按预期记录到 log/development.log 文件中。

一旦我在编辑器（例如 Vi、TextMate）中打开它并从那里保存它，Rails 就不再写入它了！我必须重新启动服务器，然后它才能再次工作。

这真的很奇怪，Vi/TextMate 似乎“窃取”了写入文件的权限，只有重新启动 Rails 服务器才能重新获得权限。

有人知道这里发生了什么吗？这真的很烦人。`rake log:clear`只要我没有为development.log点击“保存”，我也只能这样做，所以这是完全相同的奇怪行为......

我之前描述过类似这样的奇怪行为，我怀疑 AckMate 与它有关。可悲的是，我没有得到任何回应，请参阅[此处](https://stackoverflow.com/questions/11721159/textmate-find-in-files-seems-to-have-out-of-date-cache-maybe-because-of-ackmat)。

非常感谢您的帮助，这真的很困扰我。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-02T18:00:42.427

`vim`将您的文件写入临时文件，然后重命名它。

Rails 进程不断写入旧打开的[fd](https://en.wikipedia.org/wiki/File_descriptor)。

# iphone - 使用iOS中的核心图形绘制带有渐变的外半圆？

> ID：11783114
> 
> 赞同：19
> 
> 时间：2012-08-02T17:55:53.660
> 
> 标签：iphone, ios, core-graphics

我想在 iOS 中使用核心图形绘制一个像附加图像中的形状。这可能吗。如果可能，请提供示例代码。![在此处输入图像描述](../Images/d7109da03e360d3c8caaec145bdb51f5.png)

我希望形状上至少有 3 个颜色渐变。

* * *

## 回答 #1

> 赞同：47
> 
> 时间：2012-10-08T05:30:35.413

渐变不会自然地沿着路径绘制。你必须模拟它。该代码使用 NSBezierPath、NSView 和 CGContext，但将其移植到 iOS 应该不难。

我做了梯形的组装。

这是绘制渐变的 NSView 的 drawRect：

```
@implementation grad
-(void)drawRect:(NSRect)dirtyRect {

    [[NSColor whiteColor]set];
    NSRectFill([self bounds]);
    float dim = MIN(self.bounds.size.width, self.bounds.size.height);
    int subdiv=512;
    float r=dim/4;
    float R=dim/2;

    float halfinteriorPerim = M_PI*r;
    float halfexteriorPerim = M_PI*R;
    float smallBase= halfinteriorPerim/subdiv;
    float largeBase= halfexteriorPerim/subdiv;

    NSBezierPath * cell = [NSBezierPath bezierPath];

    [cell moveToPoint:NSMakePoint(- smallBase/2, r)];
    [cell lineToPoint:NSMakePoint(+ smallBase/2, r)];

    [cell lineToPoint:NSMakePoint( largeBase /2 , R)];
    [cell lineToPoint:NSMakePoint(-largeBase /2,  R)];
    [cell closePath];

    float incr = M_PI / subdiv;
    CGContextRef ctx = [[NSGraphicsContext currentContext] graphicsPort];
    CGContextTranslateCTM(ctx, +self.bounds.size.width/2, +self.bounds.size.height/2);

    CGContextScaleCTM(ctx, 0.9, 0.9);
    CGContextRotateCTM(ctx, M_PI/2);
    CGContextRotateCTM(ctx,-incr/2);

    for (int i=0;i<subdiv;i++) {
        // replace this color with a color extracted from your gradient object
        [[NSColor colorWithCalibratedHue:(float)i/subdiv saturation:1 brightness:1 alpha:1] set];
        [cell fill];
        [cell stroke];
        CGContextRotateCTM(ctx, -incr);
    }
} 
```

`subdiv`这看起来像这样，具有和`r`（内部半径）的各种组合，并且具有不同的比例。

![沿圆形渐变](../Images/a21ebe6d5c2150d8434e283e203657e9.png)

# 带有块的新版本，iOS 就绪

这个版本使用 Objective-C 块来实现颜色和轮廓功能。只需在一个块中传入一个函数，该函数返回 0 到 1 之间的任意数字的内半径、外半径和颜色。其他参数是开始角度、结束角度、细分数、中心和用于调试目的的比例，以及CGContextRef。

```
#import "GradientView.h"

@implementation GradientView

typedef void (^voidBlock)(void);
typedef float (^floatfloatBlock)(float);
typedef UIColor * (^floatColorBlock)(float);

-(CGPoint) pointForTrapezoidWithAngle:(float)a andRadius:(float)r  forCenter:(CGPoint)p{
    return CGPointMake(p.x + r*cos(a), p.y + r*sin(a));
}

-(void)drawGradientInContext:(CGContextRef)ctx  startingAngle:(float)a endingAngle:(float)b intRadius:(floatfloatBlock)intRadiusBlock outRadius:(floatfloatBlock)outRadiusBlock withGradientBlock:(floatColorBlock)colorBlock withSubdiv:(int)subdivCount withCenter:(CGPoint)center withScale:(float)scale
{
    float angleDelta = (b-a)/subdivCount;
    float fractionDelta = 1.0/subdivCount;

    CGPoint p0,p1,p2,p3, p4,p5;
    float currentAngle=a;
    p4=p0 = [self pointForTrapezoidWithAngle:currentAngle andRadius:intRadiusBlock(0) forCenter:center];
    p5=p3 = [self pointForTrapezoidWithAngle:currentAngle andRadius:outRadiusBlock(0) forCenter:center];
    CGMutablePathRef innerEnveloppe=CGPathCreateMutable(),
    outerEnveloppe=CGPathCreateMutable();

    CGPathMoveToPoint(outerEnveloppe, 0, p3.x, p3.y);
    CGPathMoveToPoint(innerEnveloppe, 0, p0.x, p0.y);
    CGContextSaveGState(ctx);

    CGContextSetLineWidth(ctx, 1);

    for (int i=0;i<subdivCount;i++)
    {
        float fraction = (float)i/subdivCount;
        currentAngle=a+fraction*(b-a);
        CGMutablePathRef trapezoid = CGPathCreateMutable();

        p1 = [self pointForTrapezoidWithAngle:currentAngle+angleDelta andRadius:intRadiusBlock(fraction+fractionDelta) forCenter:center];
        p2 = [self pointForTrapezoidWithAngle:currentAngle+angleDelta andRadius:outRadiusBlock(fraction+fractionDelta) forCenter:center];

        CGPathMoveToPoint(trapezoid, 0, p0.x, p0.y);
        CGPathAddLineToPoint(trapezoid, 0, p1.x, p1.y);
        CGPathAddLineToPoint(trapezoid, 0, p2.x, p2.y);
        CGPathAddLineToPoint(trapezoid, 0, p3.x, p3.y);
        CGPathCloseSubpath(trapezoid);

        CGPoint centerofTrapezoid = CGPointMake((p0.x+p1.x+p2.x+p3.x)/4, (p0.y+p1.y+p2.y+p3.y)/4);

        CGAffineTransform t = CGAffineTransformMakeTranslation(-centerofTrapezoid.x, -centerofTrapezoid.y);
        CGAffineTransform s = CGAffineTransformMakeScale(scale, scale);
        CGAffineTransform concat = CGAffineTransformConcat(t, CGAffineTransformConcat(s, CGAffineTransformInvert(t)));
        CGPathRef scaledPath = CGPathCreateCopyByTransformingPath(trapezoid, &concat);

        CGContextAddPath(ctx, scaledPath);
        CGContextSetFillColorWithColor(ctx,colorBlock(fraction).CGColor);
        CGContextSetStrokeColorWithColor(ctx, colorBlock(fraction).CGColor);
        CGContextSetMiterLimit(ctx, 0);

        CGContextDrawPath(ctx, kCGPathFillStroke);

        CGPathRelease(trapezoid);
        p0=p1;
        p3=p2;

        CGPathAddLineToPoint(outerEnveloppe, 0, p3.x, p3.y);
        CGPathAddLineToPoint(innerEnveloppe, 0, p0.x, p0.y);
    }
    CGContextSetLineWidth(ctx, 10);
    CGContextSetLineJoin(ctx, kCGLineJoinRound);
    CGContextSetStrokeColorWithColor(ctx, [UIColor blackColor].CGColor);
    CGContextAddPath(ctx, outerEnveloppe);
    CGContextAddPath(ctx, innerEnveloppe);
    CGContextMoveToPoint(ctx, p0.x, p0.y);
    CGContextAddLineToPoint(ctx, p3.x, p3.y);
    CGContextMoveToPoint(ctx, p4.x, p4.y);
    CGContextAddLineToPoint(ctx, p5.x, p5.y);
    CGContextStrokePath(ctx);
}

-(void)drawRect:(CGRect)rect {

    CGContextRef ctx = UIGraphicsGetCurrentContext();

    [[UIColor whiteColor] set];
    UIRectFill(self.bounds);

    CGRect r = self.bounds;

    r=CGRectInset(r, 60, 60);

    if (r.size.width > r.size.height)
        r.size.width=r.size.height;
    else r.size.height=r.size.width;

    float radius=r.size.width/2;

    [self drawGradientInContext:ctx  startingAngle:M_PI/16 endingAngle:2*M_PI-M_PI/16 intRadius:^float(float f) {
//        return 0*f + radius/2*(1-f);
        return 200+10*sin(M_PI*2*f*7);
//        return 50+sqrtf(f)*200;
//        return radius/2;
    } outRadius:^float(float f) {
//         return radius *f + radius/2*(1-f);
        return radius;
//        return 300+10*sin(M_PI*2*f*17);
    } withGradientBlock:^UIColor *(float f) {

//        return [UIColor colorWithHue:f saturation:1 brightness:1 alpha:1];
        float sr=90, sg=54, sb=255;
        float er=218, eg=0, eb=255;
        return [UIColor colorWithRed:(f*sr+(1-f)*er)/255\. green:(f*sg+(1-f)*eg)/255\. blue:(f*sb+(1-f)*eb)/255\. alpha:1];

    } withSubdiv:256 withCenter:CGPointMake(CGRectGetMidX(r), CGRectGetMidY(r)) withScale:1];

}

@end 
```

例子：

![曲线渐变 1](../Images/c27f96fba027c817f5f9cff8aa9bf493.png)

![曲线渐变 2](../Images/5da01af9267a546585a501a705d971fa.png)

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2012-08-02T18:21:04.107

### 如果你想把它画在`CGContext`：

用于`+[UIBezierPath bezierPathWithArcCenter:radius:startAngle:endAngle:clockwise:]`创建包含半圆弧的路径。然后使用`CGPathCreateCopyByStrokingPath`在圆弧周围创建一个封闭的形状。用于`CGContextAddPath`将此封闭形状添加到上下文路径，然后用于`CGContextClip`将剪辑区域设置为粗弧。

使用您的彩虹色`CGGradientCreateWithColors`创建一个。`CGGradient`使用`CGContextDrawLinearGradient`渐变填充剪辑区域。

### 如果你想使用 a 来绘制它`CALayer`：

创建一个`CAGradientLayer`. 将图层的`colors`属性设置为您的彩虹色。将图层设置`startPoint`为 (0,0)，将图层`endPoint`设置为 (1,0)。

创建一个`CAShapeLayer`并将其设置为渐变图层的蒙版。使用`+[UIBezierPath bezierPathWithArcCenter:radius:startAngle:endAngle:clockwise:]`和`CGPathCreateCopyByStrokingPath`创建一个包含粗圆弧的路径，并将此路径设置为形状图层的`path`.

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2015-11-30T04:47:06.537

从 iOS 8 开始，绘制圆形渐变最简单、最快的方法是使用 Core Image 滤镜。[内核在此答案](https://stackoverflow.com/a/6907597/3818946)的评论中链接到，但由于弄清楚如何实际使用它花了我一段时间，我将在此处发布整个过程。

本质上，Core Image 过滤器是在输入图像的每个像素上运行的小片段着色器。尽管它们被设计用于过滤图像，但您可以通过简单地忽略过滤器内核中的输入像素值来使用它们来生成图像。

下面的代码生成一个虚拟图像用作输入，然后对其应用自定义 CI 内核以生成圆形渐变。

```
// 1 - generate a dummy image of the required size
UIGraphicsBeginImageContextWithOptions(CGSizeMake(512.0, 256.0), NO, [[UIScreen mainScreen] scale]);
CIImage *dummyImage = [CIImage imageWithCGImage:UIGraphicsGetImageFromCurrentImageContext().CGImage];

// 2 - define the kernel algorithm
NSString *kernelString = @"kernel vec4 circularGradientKernel(__color startColor, __color endColor, vec2 center, float innerR, float outerR) { \n"
"    vec2 point = destCoord() - center;"
"    float rsq = point.x * point.x + point.y * point.y;"
"    float theta = mod(atan(point.y, point.x), radians(360.0));"
"    return (rsq > innerR*innerR && rsq < outerR*outerR) ? mix(startColor, endColor, theta/radians(360.0)*2.0) : vec4(0.0, 0.0, 0.0, 1.0);"
"}";

// 3 - initialize a Core Image context and the filter kernel
CIContext *context = [CIContext contextWithOptions:nil];
CIColorKernel *kernel = [CIColorKernel kernelWithString:kernelString];

// 4 - argument array, corresponding to the first line of the kernel string
NSArray *args = @[ [CIColor colorWithRed:1.0 green:0.0 blue:0.0],
                   [CIColor colorWithRed:0.0 green:0.0 blue:1.0],
                   [CIVector vectorWithCGPoint:CGPointMake(CGRectGetMidX(dummyImage.extent),CGRectGetMinY(dummyImage.extent))],
                   [NSNumber numberWithFloat:250.0],
                   [NSNumber numberWithFloat:500.0]];

// 5 - apply the kernel to our dummy image, and convert the result to a UIImage
CIImage *ciOutputImage = [kernel applyWithExtent:dummyImage.extent arguments:args];
CGImageRef cgOutput = [context createCGImage:ciOutputImage fromRect:ciOutputImage.extent];
UIImage *gradientImage = [UIImage imageWithCGImage:cgOutput];
CGImageRelease(cgOutput); 
```

输出如下所示：

[![使用 Core Image 滤镜生成的圆形渐变。](../Images/3a6d3b226fc6f41bc9c3bdb0b27184cf.png)](https://i.stack.imgur.com/RdWF1.png)

颜色和中心点以`CIColor`s 和`CIVector`s 封装传入，内圆和外圆的半径以浮点数给出。如果要传入其他参数，当然可以修改参数列表。

这种方法甚至足以用于动画，但如果你想这样做，请确保为每一帧**使用相同的上下文**，因为创建和拆除它是一个性能瓶颈。只需确保您的动画参数是输入参数并循环执行步骤 4 和 5。

另外，不要忘记最后的调用`CGImageRelease`，否则你会有内存泄漏。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-05-09T07:35:13.127

我使用了 Antoine 的答案并针对 iOS 进行了调整：

```
-(void)drawRect:(CGRect)rect {
    // http://stackoverflow.com/a/12775798/129202
    CGContextRef context = UIGraphicsGetCurrentContext();
    [[UIColor whiteColor] set]; //[[NSColor whiteColor]set];
    UIRectFill([self bounds]);
    float dim = MIN(self.bounds.size.width, self.bounds.size.height);
    int subdiv=512;
    float r=dim/4;
    float R=dim/2;

    float halfinteriorPerim = M_PI*r;
    float halfexteriorPerim = M_PI*R;
    float smallBase= halfinteriorPerim/subdiv;
    float largeBase= halfexteriorPerim/subdiv;

    UIBezierPath * cell = [UIBezierPath bezierPath];

    [cell moveToPoint:CGPointMake(- smallBase/2, r)];

    [cell addLineToPoint:CGPointMake(+ smallBase/2, r)];

    [cell addLineToPoint:CGPointMake( largeBase /2 , R)];
    [cell addLineToPoint:CGPointMake(-largeBase /2,  R)];
    [cell closePath];

    float incr = M_PI / subdiv;
    //CGContextRef ctx = [[NSGraphicsContext currentContext] graphicsPort];
    CGContextTranslateCTM(context, +self.bounds.size.width/2, +self.bounds.size.height/2);

    CGContextScaleCTM(context, 0.9, 0.9);
    CGContextRotateCTM(context, M_PI/2);
    CGContextRotateCTM(context,-incr/2);

    for (int i=0;i<subdiv;i++) {
        // replace this color with a color extracted from your gradient object
        [[UIColor colorWithHue:(float)i/subdiv saturation:1 brightness:1 alpha:1] set];
        [cell fill];
        [cell stroke];
        CGContextRotateCTM(context, -incr);
    }
} 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2014-02-17T10:44:14.213

作为另一个答案，我发现了这个：[https ://github.com/paiv/AngleGradientLayer](https://github.com/paiv/AngleGradientLayer)

我试过了，效果很好。我还没有研究实现。我不认为我需要。:-)

此时的代码：

```
//
// The MIT License (MIT)
// 
// Copyright (C) 2012 Pavel Ivashkov
//
// Permission is hereby granted, free of charge, to any person obtaining a copy of this
// software and associated documentation files (the "Software"), to deal in the Software
// without restriction, including without limitation the rights to use, copy, modify, merge,
// publish, distribute, sublicense, and/or sell copies of the Software, and to permit persons
// to whom the Software is furnished to do so, subject to the following conditions:
//
// The above copyright notice and this permission notice shall be included in all copies or
// substantial portions of the Software.
//
// THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED,
// INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR
// PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE
// FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR
// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER
// DEALINGS IN THE SOFTWARE.
//
//
//  AngleGradientLayer.m
//  paiv
//
//  Created by Pavel Ivashkov on 2012-02-12.
//

#import "AngleGradientLayer.h"

#if __has_feature(objc_arc)
#define BRIDGE_CAST(T) (__bridge T)
#else
#define BRIDGE_CAST(T) (T)
#endif

#define byte unsigned char
#define F2CC(x) ((byte)(255 * x))
#define RGBAF(r,g,b,a) (F2CC(r) << 24 | F2CC(g) << 16 | F2CC(b) << 8 | F2CC(a))
#define RGBA(r,g,b,a) ((byte)r << 24 | (byte)g << 16 | (byte)b << 8 | (byte)a)
#define RGBA_R(c) ((uint)c >> 24 & 255)
#define RGBA_G(c) ((uint)c >> 16 & 255)
#define RGBA_B(c) ((uint)c >> 8 & 255)
#define RGBA_A(c) ((uint)c >> 0 & 255)

@interface AngleGradientLayer()

- (CGImageRef)newImageGradientInRect:(CGRect)rect;

@end

static void angleGradient(byte* data, int w, int h, int* colors, int colorCount, float* locations, int locationCount);

@implementation AngleGradientLayer

- (id)init
{
    if (!(self = [super init]))
        return nil;

    self.needsDisplayOnBoundsChange = YES;

    return self;
}

#if !__has_feature(objc_arc)
- (void)dealloc
{
    [_colors release];
    [_locations release];
    [super dealloc];
}
#endif

- (void)drawInContext:(CGContextRef)ctx
{
    CGContextSetFillColorWithColor(ctx, self.backgroundColor);
    CGRect rect = CGContextGetClipBoundingBox(ctx);
    CGContextFillRect(ctx, rect);

    CGImageRef img = [self newImageGradientInRect:rect];
    CGContextDrawImage(ctx, rect, img);
    CGImageRelease(img);
}

- (CGImageRef)newImageGradientInRect:(CGRect)rect
{
    return [[self class] newImageGradientInRect:rect colors:self.colors locations:self.locations];
}

+ (CGImageRef)newImageGradientInRect:(CGRect)rect colors:(NSArray *)colors locations:(NSArray *)locations
{
    int w = CGRectGetWidth(rect);
    int h = CGRectGetHeight(rect);
    int bitsPerComponent = 8;
    int bpp = 4 * bitsPerComponent / 8;
    int byteCount = w * h * bpp;

    int colorCount = (int)colors.count;
    int locationCount = (int)locations.count;
    int* cols = NULL;
    float* locs = NULL;

    if (colorCount > 0) {
        cols = calloc(colorCount, bpp);
        int *p = cols;
        for (id cg in colors) {
            CGColorRef c = BRIDGE_CAST(CGColorRef)cg;
            float r, g, b, a;

            size_t n = CGColorGetNumberOfComponents(c);
            const CGFloat *comps = CGColorGetComponents(c);
            if (comps == NULL) {
                *p++ = 0;
                continue;
            }
            r = comps[0];
            if (n >= 4) {
                g = comps[1];
                b = comps[2];
                a = comps[3];
            }
            else {
                g = b = r;
                a = comps[1];
            }
            *p++ = RGBAF(r, g, b, a);
        }
    }
    if (locationCount > 0 && locationCount == colorCount) {
        locs = calloc(locationCount, sizeof(locs[0]));
        float *p = locs;
        for (NSNumber *n in locations) {
            *p++ = [n floatValue];
        }
    }

    byte* data = malloc(byteCount);
    angleGradient(data, w, h, cols, colorCount, locs, locationCount);

    if (cols) free(cols);
    if (locs) free(locs);

    CGColorSpaceRef colorSpace = CGColorSpaceCreateDeviceRGB();
    CGBitmapInfo bitmapInfo = kCGImageAlphaPremultipliedLast | kCGBitmapByteOrder32Little;
    CGContextRef ctx = CGBitmapContextCreate(data, w, h, bitsPerComponent, w * bpp, colorSpace, bitmapInfo);
    CGColorSpaceRelease(colorSpace);
    CGImageRef img = CGBitmapContextCreateImage(ctx);
    CGContextRelease(ctx);
    free(data);
    return img;
}

@end

static inline byte blerp(byte a, byte b, float w)
{
    return a + w * (b - a);
}
static inline int lerp(int a, int b, float w)
{
    return RGBA(blerp(RGBA_R(a), RGBA_R(b), w),
                blerp(RGBA_G(a), RGBA_G(b), w),
                blerp(RGBA_B(a), RGBA_B(b), w),
                blerp(RGBA_A(a), RGBA_A(b), w));
}
static inline int multiplyByAlpha(int c)
{
    float a = RGBA_A(c) / 255.0;
    return RGBA((byte)(RGBA_R(c) * a),
                (byte)(RGBA_G(c) * a),
                (byte)(RGBA_B(c) * a),
                RGBA_A(c));
}

void angleGradient(byte* data, int w, int h, int* colors, int colorCount, float* locations, int locationCount)
{
    if (colorCount < 1) return;
    if (locationCount > 0 && locationCount != colorCount) return;

    int* p = (int*)data;
    float centerX = (float)w / 2;
    float centerY = (float)h / 2;

    for (int y = 0; y < h; y++)
    for (int x = 0; x < w; x++) {
        float dirX = x - centerX;
        float dirY = y - centerY;
        float angle = atan2f(dirY, dirX);
        if (dirY < 0) angle += 2 * M_PI;
        angle /= 2 * M_PI;

        int index = 0, nextIndex = 0;
        float t = 0;

        if (locationCount > 0) {
            for (index = locationCount - 1; index >= 0; index--) {
                if (angle >= locations[index]) {
                    break;
                }
            }
            if (index >= locationCount) index = locationCount - 1;
            nextIndex = index + 1;
            if (nextIndex >= locationCount) nextIndex = locationCount - 1;
            float ld = locations[nextIndex] - locations[index];
            t = ld <= 0 ? 0 : (angle - locations[index]) / ld;
        }
        else {
            t = angle * (colorCount - 1);
            index = t;
            t -= index;
            nextIndex = index + 1;
            if (nextIndex >= colorCount) nextIndex = colorCount - 1;
        }

        int lc = colors[index];
        int rc = colors[nextIndex];
        int color = lerp(lc, rc, t);
        color = multiplyByAlpha(color);
        *p++ = color;
    }
} 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2014-06-03T01:39:56.173

我也花了很长时间寻找如何做到这一点，所以我想我会发布我最终这样做的方式。事实证明，这两个答案都很好地回答了这个问题：

[从圆形或甜甜圈中绘制线段](https://stackoverflow.com/questions/15866179/draw-segments-from-a-circle-or-donut)

出于我的目的，我只使用了该答案的绘图和渐变部分。结构看起来或多或少是这样的......

```
CGContextRef context = UIGraphicsGetCurrentcontext();

CGFloat arcStartAngle = M_PI;
CGFloat arcEndAngle = 2 * M_PI;

CGPoint startPoint = CGPointMake(...);
CGPoint endPoint = CGPointMake(...);

CGColorSpaceRef colorSpace = CGColorSpaceCreateDeviceRGB();

CGFloat colors[] =
{
    1.0, 0.0, 0.0, 1.0,   //RGBA values (so red to green in this case)
    0.0, 1.0, 0.0, 1.0    
};

CGGradientRef gradient = CGGradientCreateWithColorComponents(colorSpace, colors, NULL, 2);
//Where the 2 is for the number of color components. You can have more colors throughout //your gradient by adding to the colors[] array, and changing the components value.

CGColorSpaceRelease(colorSpace);

//Now for the arc part...

CGMutablePathRef arc = CGPathCreateMutable();

CGPathMoveToPoint(arc, NULL, startPoint.x, startPoint.y);

//Here, the CGPoint self.arcCenter is the point around which the arc is placed, so maybe the
//middle of your view. self.radius is the distance between this center point and the arc.
CGPathAddArc(arc, NULL, self.arcCenter.x, self.arcCenter.y, self.radius, 
             arcStartAngle, arcEndAngle, YES);

//This essentially draws along the path in an arc shape
CGPathRef strokedArc = CGPathCreateCopyByStrokingPath(arc, NULL, 5.0f, 
                                                      kCGLineCapButt, kCGLineJoinMiter, 10);

CGContextSaveGState(context);

CGContextAddPath(context, strokedArc);
CGContextClip(context);

CGContextDrawLinearGradient(context, gradient, startPoint, endPoint, 0);

CGContextDrawPath(context, kCGPathFillStroke);

CGGradientRelease(gradient);
CGContextRestoreGState(context);

//This all draws a gradient that is much larger than the arc itself, but using
//CGContextClip, it clips out everything EXCEPT the colors in the arc. Saving and Restoring
//the state allows you to preserve any other drawing going on. If you didn't use these,
//then all other drawing would also be clipped. 
```

我希望这有帮助。如果其中任何一个不清楚，我建议您查看上面的问题链接。该问题的答案包含我在此答案中使用的所有内容以及一些更酷且有用的绘图技巧。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2015-04-27T17:47:42.070

我使用[了 alecail](https://stackoverflow.com/users/1190417/alecail)的答案（iOS with blocks），但是，我注意到它需要一些调整（只是在 -(void) drawGratientInContext:... 中添加了一些 CGPathRelease() ），因为它使用了太多记忆。抱歉，我会将此作为评论发布，但由于我没有 50+ 的声誉，所以我必须回答如下：

```
-(void)drawGradientInContext:(CGContextRef)ctx  startingAngle:(float)a endingAngle:(float)b intRadius:(floatfloatBlock)intRadiusBlock outRadius:(floatfloatBlock)outRadiusBlock withGradientBlock:(floatColorBlock)colorBlock withSubdiv:(int)subdivCount withCenter:(CGPoint)center withScale:(float)scale
{
    float angleDelta = (b-a)/subdivCount;
    float fractionDelta = 1.0/subdivCount;

    CGPoint p0,p1,p2,p3, p4,p5;
    float currentAngle=a;
    p4=p0 = [self pointForTrapezoidWithAngle:currentAngle andRadius:intRadiusBlock(0) forCenter:center];
    p5=p3 = [self pointForTrapezoidWithAngle:currentAngle andRadius:outRadiusBlock(0) forCenter:center];
    CGMutablePathRef innerEnveloppe=CGPathCreateMutable(),
    outerEnveloppe=CGPathCreateMutable();

    CGPathMoveToPoint(outerEnveloppe, 0, p3.x, p3.y);
    CGPathMoveToPoint(innerEnveloppe, 0, p0.x, p0.y);
    CGContextSaveGState(ctx);

    CGContextSetLineWidth(ctx, 1);

    for (int i=0;i<subdivCount;i++)
    {
        float fraction = (float)i/subdivCount;
        currentAngle=a+fraction*(b-a);
        CGMutablePathRef trapezoid = CGPathCreateMutable();

        p1 = [self pointForTrapezoidWithAngle:currentAngle+angleDelta andRadius:intRadiusBlock(fraction+fractionDelta) forCenter:center];
        p2 = [self pointForTrapezoidWithAngle:currentAngle+angleDelta andRadius:outRadiusBlock(fraction+fractionDelta) forCenter:center];

        CGPathMoveToPoint(trapezoid, 0, p0.x, p0.y);
        CGPathAddLineToPoint(trapezoid, 0, p1.x, p1.y);
        CGPathAddLineToPoint(trapezoid, 0, p2.x, p2.y);
        CGPathAddLineToPoint(trapezoid, 0, p3.x, p3.y);
        CGPathCloseSubpath(trapezoid);

        CGPoint centerofTrapezoid = CGPointMake((p0.x+p1.x+p2.x+p3.x)/4, (p0.y+p1.y+p2.y+p3.y)/4);

        CGAffineTransform t = CGAffineTransformMakeTranslation(-centerofTrapezoid.x, -centerofTrapezoid.y);
        CGAffineTransform s = CGAffineTransformMakeScale(scale, scale);
        CGAffineTransform concat = CGAffineTransformConcat(t, CGAffineTransformConcat(s, CGAffineTransformInvert(t)));
        CGPathRef scaledPath = CGPathCreateCopyByTransformingPath(trapezoid, &concat);

        CGContextAddPath(ctx, scaledPath);
        CGContextSetFillColorWithColor(ctx,colorBlock(fraction).CGColor);
        CGContextSetStrokeColorWithColor(ctx, colorBlock(fraction).CGColor);
        CGContextSetMiterLimit(ctx, 0);

        CGContextDrawPath(ctx, kCGPathFillStroke);

        p0=p1;
        p3=p2;

        CGPathAddLineToPoint(outerEnveloppe, 0, p3.x, p3.y);
        CGPathAddLineToPoint(innerEnveloppe, 0, p0.x, p0.y);

        //Release both CGPathRefs. The original code just released 
        //trapezoid CG . 
        CGPathRelease(trapezoid);
        CGPathRelease(scaledPath);
    }
    //stroke width
    CGContextSetLineWidth(ctx, 0.0001);
    CGContextSetLineJoin(ctx, kCGLineJoinRound);
    CGContextSetStrokeColorWithColor(ctx, [UIColor blackColor].CGColor);
    CGContextAddPath(ctx, outerEnveloppe);
    CGContextAddPath(ctx, innerEnveloppe);
    CGContextMoveToPoint(ctx, p0.x, p0.y);
    CGContextAddLineToPoint(ctx, p3.x, p3.y);
    CGContextMoveToPoint(ctx, p4.x, p4.y);
    CGContextAddLineToPoint(ctx, p5.x, p5.y);
    CGContextStrokePath(ctx);

    //Release CGPathRefs
    CGPathRelease(innerEnveloppe);
    CGPathRelease(outerEnveloppe);

} 
```

# java - 在cmd上执行进程，不处理

> ID：11783116
> 
> 赞同：0
> 
> 时间：2012-08-02T17:56:00.773
> 
> 标签：java, ffmpeg

我正在从 Java 运行 ffmpeg。使用它将flv文件转换为mp3。

当我运行下面的代码时，ffmpeg 启动，创建一个新文件（.mp3 文件）但以 0% 的 CPU 运行。当我停止 JAVA 应用程序（来自 netbeans）时，ffmpeg 保持打开状态，并且每个 Windows 任务管理器（CTRL-ALT-DEL）从 0% 变为 99%。另一件奇怪的事情正在发生。ffmpeg 的输出没有被打印。

线程正在启​​动，但由于某种原因，java 没有给它任何时间来进行处理。

对于如何解决这个问题，有任何的建议吗？谢谢。

```
public class ConverterThread extends Thread {

 String fileToConvert;
 String fileToCreate;
 GetSong getSong;

public ConverterThread(String downloadLocationOnDisk, GetSong getSong) {
   this.fileToConvert = downloadLocationOnDisk;
   this.getSong = getSong;
}

public void run(){
    try {
        Thread cur=Thread.currentThread();
        cur.setPriority(Thread.MAX_PRIORITY);

           String downloadLocationOnDisk = fileToConvert;

            if(downloadLocationOnDisk.contains(".flv"))
                fileToCreate = downloadLocationOnDisk.replace(".flv", ".mp3");

            if(downloadLocationOnDisk.contains(".m4a"))
                fileToCreate = downloadLocationOnDisk.replace(".m4a", ".mp3");

            String cmdLine =  "ffmpeg/bin/ffmpeg -i \"" + fileToConvert + "\" \"" + fileToCreate +"\""; 

            System.err.println(cmdLine);

             // run the Unix "ps -ef" command
             // using the Runtime exec method:
             Process p = Runtime.getRuntime().exec(cmdLine);

             BufferedReader stdInput = new BufferedReader(new 
                  InputStreamReader(p.getInputStream()));

             BufferedReader stdError = new BufferedReader(new 
                  InputStreamReader(p.getErrorStream()));

             String s;

             // read the output from the command
             while ((s = stdInput.readLine()) != null) {
                 System.out.println(s);
             }

             // read any errors from the attempted command
             System.out.println("Here is the standard error of the command (if any):\n");
             while ((s = stdError.readLine()) != null) {
                 System.out.println(s);
             }

    } catch (IOException ex) {
        Logger.getLogger(ConverterThread.class.getName()).log(Level.SEVERE, null, ex);
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-02T20:27:18.677

我找到了解决方案。见这里[http://www.javaworld.com/javaworld/jw-12-2000/jw-1229-traps.html?page=2](http://www.javaworld.com/javaworld/jw-12-2000/jw-1229-traps.html?page=2)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-02T18:06:58.390

我认为这个问题出在某个地方：

```
Thread cur=Thread.currentThread();
cur.setPriority(Thread.MAX_PRIORITY); 
```

您的 Java 环境具有最高优先级，并且没有给 ffmpeg 足够的 CPU 时间。事实上，考虑完全不使用线程优先级，因为它可能导致不同操作系统/环境中的不同行为。

您也在此处等待 ffmpeg 命令结束：

```
while ((s = stdInput.readLine()) != null) {
    System.out.println(s);
} 
```

因此，您将在这里等到 ffmpeg 完成，如果 java 有所有 cpu 时间，这很难。

# android - 使用 ActionBarSherlock 更改主页图标

> ID：11783120
> 
> 赞同：2
> 
> 时间：2012-08-02T17:56:04.627
> 
> 标签：android, android-actionbar, actionbarsherlock

我正在尝试将我的主页图标更改为可绘制的。我正在使用以下代码：

```
getSupportActionBar().setIcon(R.drawable.some_image); 
```

这是行不通的！我在我的主题中设置了图像，所以也许这不能被覆盖......

到目前为止，我已经尝试过姜饼和蜂窝......

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-02T18:41:29.843

问题是我在 android 清单中使用以下行声明了一个徽标：

```
<application
   ....
   android:logo="@drawable/some_icon">
</application> 
```

我的主题中声明的图标被 getSupportActionBar().setIcon() 覆盖。

有关图标与徽标的更多信息，请参阅此 SO： [Android 图标与徽标](https://stackoverflow.com/questions/6735649/android-icon-vs-logo)

# android - 执行 http 请求 Android 时出现空异常

> ID：11783121
> 
> 赞同：1
> 
> 时间：2012-08-02T17:56:06.223
> 
> 标签：android, http, hosting

我有一个空异常执行此代码，在“执行”操作中，我不明白为什么，你能帮帮我吗？在这里，我的代码将地址检索为：“routeslibre.fr/connexion.php?variable=Departement;;;voie;;;” 并将其提供给 http 操作：执行。在这个操作中抛出一个异常，它有一个空值，我不明白原因....？谢谢你帮助我！

```
 mydataFromHMI = dataFromHMI;
    myFichierPHPbase = FichierPHPbase;

    String result = null;
    InputStream is = null;
    JSONObject json_data=null;

    try{
        GestionStrings gestionString = new GestionStrings();
        splitData = mydataFromHMI.split(";;;");
        mydataFromHMI = gestionString.blancTraitement(splitData[0]) 
                + ";;;" 
                + gestionString.blancTraitement(splitData[1]) 
                + ";;;";
        String httpRequest = new String("http://routeslibre.fr/"+ myFichierPHPbase + "?variable=" + mydataFromHMI);
        HttpGet httpGet = new HttpGet(httpRequest);
        HttpParams httpParameters = new BasicHttpParams();
        // Set the timeout in milliseconds until a connection is established.
        // The default value is zero, that means the timeout is not used. 
        int timeoutConnection = 3000;
        HttpConnectionParams.setConnectionTimeout(httpParameters, timeoutConnection);
        // Set the default socket timeout (SO_TIMEOUT) 
        // in milliseconds which is the timeout for waiting for data.
        int timeoutSocket = 5000;
        HttpConnectionParams.setSoTimeout(httpParameters, timeoutSocket);
        HttpClient httpclient = new DefaultHttpClient(httpParameters);
        HttpResponse response = httpclient.execute(httpGet);

        //If you get the value of response code as 200 then you are getting data from server and 
        //if the response code value >=300 then you have error at your server side.
        //int test = response.getStatusLine().getStatusCode();

        HttpEntity entity = response.getEntity();
        is = entity.getContent();
    }
    catch(Exception e){
        Log.i("taghttppost",""+e.toString());
        isProblemConnexion = true;
    } 
```

日志是：

```
 `  08-02 19:58:57.959: I/dalvikvm-heap(7640): Grow heap (frag case) to 15.421MB for 1647516-byte allocation
08-02 19:58:58.089: I/webclipboard(7640): clipservice: android.sec.clipboard.ClipboardExManager@419ff9b8
08-02 19:58:58.164: I/webclipboard(7640): clipservice: android.sec.clipboard.ClipboardExManager@419ff9b8
08-02 19:58:58.174: E/SKIA(7640): FimgApiStretch:stretch failed
08-02 19:58:58.324: I/webclipboard(7640): clipservice: android.sec.clipboard.ClipboardExManager@419ff9b8
08-02 19:58:58.364: I/Ads(7640): To get test ads on this device, call adRequest.addTestDevice("1CA948FD73C51AEDDBB30790A88E0DBC");
08-02 19:58:58.514: I/Ads(7640): adRequestUrlHtml: <html><head><script src="http://media.admob.com/sdk-core-v40.js"></script><script>AFMA_getSdkConstants();AFMA_buildAdURL({"kw":["voiture moto velo bus trameway tram train greve carte geolocalisation"],"preqs":0,"session_id":"10528273920811926641","u_sd":2,"seq_num":"1","slotname":"a15007f67ec6dea","u_w":360,"msid":"free.controls.source","js":"afma-sdk-a-v6.0.1","mv":"8013015.com.android.vending","isu":"1CA948FD73C51AEDDBB30790A88E0DBC","cipa":1,"format":"320x50_mb","net":"ed","app_name":"4.android.free.controls.source","hl":"fr","u_h":640,"carrier":"20820","ptime":0,"u_audio":1});</script></head><body></body></html>
08-02 19:59:02.174: I/taghttppost(7640): org.apache.http.client.ClientProtocolException
08-02 19:59:02.174: I/tagconvertstr(7640): java.lang.NullPointerException
08-02 19:59:02.179: I/connexions(7640): java.util.concurrent.ExecutionException: java.lang.NullPointerException
08-02 19:59:02.179: W/dalvikvm(7640): threadid=19: thread exiting with uncaught exception (group=0x40c661f8)
08-02 19:59:02.194: E/AndroidRuntime(7640): FATAL EXCEPTION: AsyncTask #2
08-02 19:59:02.194: E/AndroidRuntime(7640): java.lang.RuntimeException: An error occured while executing doInBackground()
08-02 19:59:02.194: E/AndroidRuntime(7640):     at android.os.AsyncTask$3.done(AsyncTask.java:278)
08-02 19:59:02.194: E/AndroidRuntime(7640):     at java.util.concurrent.FutureTask$Sync.innerSetException(FutureTask.java:273)
08-02 19:59:02.194: E/AndroidRuntime(7640):     at java.util.concurrent.FutureTask.setException(FutureTask.java:124)
08-02 19:59:02.194: E/AndroidRuntime(7640):     at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:307)
08-02 19:59:02.194: E/AndroidRuntime(7640):     at java.util.concurrent.FutureTask.run(FutureTask.java:137)
08-02 19:59:02.194: E/AndroidRuntime(7640):     at android.os.AsyncTask$SerialExecutor$1.run(AsyncTask.java:208)
08-02 19:59:02.194: E/AndroidRuntime(7640):     at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1076)
08-02 19:59:02.194: E/AndroidRuntime(7640):     at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:569)
08-02 19:59:02.194: E/AndroidRuntime(7640):     at java.lang.Thread.run(Thread.java:856)
08-02 19:59:02.194: E/AndroidRuntime(7640): Caused by: java.lang.NullPointerException
08-02 19:59:02.194: E/AndroidRuntime(7640):     at org.json.JSONTokener.nextCleanInternal(JSONTokener.java:116)
08-02 19:59:02.194: E/AndroidRuntime(7640):     at org.json.JSONTokener.nextValue(JSONTokener.java:94)
08-02 19:59:02.194: E/AndroidRuntime(7640):     at org.json.JSONArray.<init>(JSONArray.java:87)
08-02 19:59:02.194: E/AndroidRuntime(7640):     at org.json.JSONArray.<init>(JSONArray.java:103)
08-02 19:59:02.194: E/AndroidRuntime(7640):     at free.controls.source.clien.ConnexionSQL.ConnexionBD(ConnexionSQL.java:213)
08-02 19:59:02.194: E/AndroidRuntime(7640):     at free.controls.source.clien.ConnexionSQL.doInBackground(ConnexionSQL.java:76)
08-02 19:59:02.194: E/AndroidRuntime(7640):     at free.controls.source.clien.ConnexionSQL.doInBackground(ConnexionSQL.java:1)
08-02 19:59:02.194: E/AndroidRuntime(7640):     at android.os.AsyncTask$2.call(AsyncTask.java:264)
08-02 19:59:02.194: E/AndroidRuntime(7640):     at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:305)
08-02 19:59:02.194: E/AndroidRuntime(7640):     ... 5 more
08-02 19:59:02.339: E/WindowManager(7640): Activity free.controls.source.forum.ForumActivity has leaked window com.android.internal.policy.impl.PhoneWindow$DecorView@41bf0540 that was originally added here
08-02 19:59:02.339: E/WindowManager(7640): android.view.WindowLeaked: Activity free.controls.source.forum.ForumActivity has leaked window com.android.internal.policy.impl.PhoneWindow$DecorView@41bf0540 that was originally added here
08-02 19:59:02.339: E/WindowManager(7640):  at android.view.ViewRootImpl.<init>(ViewRootImpl.java:414)
08-02 19:59:02.339: E/WindowManager(7640):  at android.view.WindowManagerImpl.addView(WindowManagerImpl.java:282)
08-02 19:59:02.339: E/WindowManager(7640):  at android.view.WindowManagerImpl.addView(WindowManagerImpl.java:218)
08-02 19:59:02.339: E/WindowManager(7640):  at android.view.WindowManagerImpl$CompatModeWrapper.addView(WindowManagerImpl.java:143)
08-02 19:59:02.339: E/WindowManager(7640):  at android.view.Window$LocalWindowManager.addView(Window.java:547)
08-02 19:59:02.339: E/WindowManager(7640):  at android.app.Dialog.show(Dialog.java:278)
08-02 19:59:02.339: E/WindowManager(7640):  at free.controls.source.clien.ConnexionSQL.onPreExecute(ConnexionSQL.java:84)
08-02 19:59:02.339: E/WindowManager(7640):  at android.os.AsyncTask.executeOnExecutor(AsyncTask.java:561)
08-02 19:59:02.339: E/WindowManager(7640):  at android.os.AsyncTask.execute(AsyncTask.java:511)
08-02 19:59:02.339: E/WindowManager(7640):  at free.controls.source.forum.ForumActivity.onCreate(ForumActivity.java:78)
08-02 19:59:02.339: E/WindowManager(7640):  at android.app.Activity.performCreate(Activity.java:4533)
08-02 19:59:02.339: E/WindowManager(7640):  at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1053)
08-02 19:59:02.339: E/WindowManager(7640):  at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1934)
08-02 19:59:02.339: E/WindowManager(7640):  at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:1995)
08-02 19:59:02.339: E/WindowManager(7640):  at android.app.ActivityThread.access$600(ActivityThread.java:128)
08-02 19:59:02.339: E/WindowManager(7640):  at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1161)
08-02 19:59:02.339: E/WindowManager(7640):  at android.os.Handler.dispatchMessage(Handler.java:99)
08-02 19:59:02.339: E/WindowManager(7640):  at android.os.Looper.loop(Looper.java:137)
08-02 19:59:02.339: E/WindowManager(7640):  at android.app.ActivityThread.main(ActivityThread.java:4517)
08-02 19:59:02.339: E/WindowManager(7640):  at java.lang.reflect.Method.invokeNative(Native Method)
08-02 19:59:02.339: E/WindowManager(7640):  at java.lang.reflect.Method.invoke(Method.java:511)
08-02 19:59:02.339: E/WindowManager(7640):  at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:993)
08-02 19:59:02.339: E/WindowManager(7640):  at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:760)
08-02 19:59:02.339: E/WindowManager(7640):  at dalvik.system.NativeStart.main(Native Method)
08-02 19:59:03.464: I/GATE(7640): <GATE-M>DEV_ACTION_COMPLETED</GATE-M>` 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-02T19:59:03.757

在第 213 行查看您的 java 文件 ConnexionSQL.java，从该行生成空指针异常。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-02T23:28:27.930

来自这一行的错误：

`HttpGet httpGet = new HttpGet(httpRequest);`

我用这个改变了它：

`HttpPost request = new HttpPost(httpRequest);`

# jquery - jquery 动画“onstart” - 理论

> ID：11783122
> 
> 赞同：0
> 
> 时间：2012-08-02T17:56:07.330
> 
> 标签：jquery, jquery-animate

在动画开始之前，我需要分析我的元素以确保一切都在正确的位置。

我现在有这个工作，但问题是当你点击“动画”按钮太快时，事情就会变得不合适。我不能指望用户耐心等待每个动画完成。

我应该怎么办？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-02T17:59:56.110

在动画开始时禁用按钮，在动画完成回调时启用它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-02T17:57:59.227

在开始制作动画之前，您应该调用[`.stop(true)`](http://api.jquery.com/stop/)中断任何正在进行的和排队的动画。然后像现在一样重置元素并开始新动画。

如果它有帮助，`.stop(true, true)`只需跳转到动画的末尾，而不是将元素留在它们的开始/停止位置之间。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-02T18:01:49.493

用于`stop(true, true)`清除队列并跳到最后。

这将使元素处于先前运行动画的结束状态。

这里

第一个属性是清除队列

第二个属性是跳转到结束。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-09-04T08:28:14.700

`.animation()`有一个未记录的`start`选项，用它来进行分析

```
$('.box').animate({left:100},{
    duration:500,
    start:function(){
        console.log('start');
    },
    complete:function(){
        console.log('end');
    }
}); 
```

# cakephp - CakePHP 博客中的谷歌分析

> ID：11783135
> 
> 赞同：-1
> 
> 时间：2012-08-02T17:56:59.000
> 
> 标签：cakephp, blogs

我的网站管理员正在休假，我需要一种在我的博客上添加 Google Analytics 代码的方法。我到处找，找不到放置代码的头文件。

我还没有在实时服务器上拥有该站点，但这是博客路径的示例。

example.com/blogs/blog

我有一个“博客”文件夹，`/public_html/app/views/blogs`但其中的所有文件都没有可以放置 GA 代码的标签。还有其他地方我需要查找和索引文件吗？

我把代码放进去`/public_html/app/views/layouts/index.ctp`，它只显示在主页上而不是博客上。

请帮忙 - 谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-02T18:02:34.147

CakePHP 页眉和页脚一起在一个布局文件中。
默认布局文件是`views/layouts/default.ctp`.

# java - 使用随机类的首选方式

> ID：11783138
> 
> 赞同：4
> 
> 时间：2012-08-02T17:57:07.933
> 
> 标签：java, random

`Random`在 Java中使用类的首选方法是什么？

a) 创建一个对象`Random`并多次使用

`Random`b)每次需要随机值时创建一个新对象

有什么缺点和好处？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-02T18:10:26.043

从技术上讲，类所做的保证是单个实例将产生伪随机值流。使用您的方法 (b)，无法明确保证生成的值流将满足相同的随机性统计定义。因此，如果您关心真正的统计随机性，（a）将是首选。

我认为（b）没有多大好处。我想这意味着您不需要保留对 Random 的单个实例的引用，但是在单例类中这样做会很简单。一般来说，出于性能原因，我会对创建大量新对象持谨慎态度，但您可以衡量影响并决定它是否可以接受。

因此，在这些选项之间，我通常更喜欢 (a)。

我可以看到第三种选择，即使用多个长寿命实例。如果您有多个线程并且希望每个线程使用自己的`Random`对象，则可以这样做。（从 javadoc 中我不清楚让多个线程调用单个对象的含义可能是什么。）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-02T18:10:49.890

如果您需要在**循环**中重复生成随机数，那么您可以创建一个`Random`对象并使用它来生成数字。几乎没有任何理由`Random`为每个随机数创建一个新对象。这样做可能会不必要地降低程序的性能。

如果您偶尔生成一次随机数，那么每次生成随机数时创建一个新的 Random 对象并没有什么坏处。随身携带一个`Random`物体也可以。请注意，这可能与上述情况混合在一起：例如，您可能会在游戏开始时生成许多随机数，但在游戏期间不会发生随机事件。

`Random`对于 Java 虚拟机，我对通过在程序的整个生命周期中不保留对象可以节省的内存使用量有点怀疑。另一方面，如果`Random`总是重新创建对象，肯定会影响性能。开销可能可见也可能不可见，具体取决于程序的功能。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-02T18:29:22.153

这里的其他答案很好。尤其是戴夫·科斯塔的那个。我只有一件事要补充。

您希望谁看到随机行为？程序员还是最终用户？

使用带有静态种子的 1 个随机对象，意味着您将始终能够执行相同的操作并获得相同的结果（随机是伪随机而不是实际随机）。这是调试和尝试重现报告的错误的奇迹！

# java - 改变 RadialGradient，渐变位置？

> ID：11783140
> 
> 赞同：3
> 
> 时间：2012-08-02T17:57:09.337
> 
> 标签：java, android, gradient

这是我需要的图像：

[http://imgur.com/prXA5](http://imgur.com/prXA5) 我需要从 1 到 2，它必须是一个没有 xml 的程序。

```
//Create transparent circle
RadialGradient gradient = new android.graphics.RadialGradient(newBitmap.getWidth() /     2,newBitmap.getHeight() / 2, newBitmap.getWidth() - newBitmap.getWidth() / 2, 0x00000000, 0xFF000000, android.graphics.Shader.TileMode.CLAMP); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-02T20:44:10.800

想通了，

```
//Create transparent circle
    int[] Colors = {0x00000000, 0xFF000000};
    float[] ColorPosition = {0.60f, 0.99f};
    RadialGradient gradient = new android.graphics.RadialGradient(newBitmap.getWidth() / 2,newBitmap.getHeight() / 2, newBitmap.getWidth() - newBitmap.getWidth() /2, Colors, ColorPosition, android.graphics.Shader.TileMode.CLAMP); 
```

其中颜色位置是上面颜色的百分比位置（可以有很多你想要的）

# maven - 为什么批处理中的一组命令在只运行一些命令后往往会停止？

> ID：11783144
> 
> 赞同：19
> 
> 时间：2012-08-02T17:57:12.347
> 
> 标签：maven, command-line, batch-file

我的批处理文件的目标是执行“mvn clean install”，在某处复制一些环境文件，然后启动 localhost 服务器。

这是我的批处理文件：

```
REM # change the following dirs accordingly
set webapp_dir=C:\cygwin\home\git\new_trunk
echo "moving to webapps project dir"
cd %webapp_dir%
echo "mvn clean install"
mvn clean install

---------------------it seems to finish the maven install then just stops
---------------------------i dont really wanna write 2 batch files just for this

set env_dir=C:\cygwin\home\git\new_trunk\etc\environment\dev\yao
set class_dir=C:\cygwin\home\git\new_trunk\webapps-dist\target\classes
cd %env_dir%
copy /y env.conf.bat %class_dir%
echo "copying env.conf file"

msg * maven install complete, the env.conf has been copied

set run_dir=C:\cygwin\home\git\new_trunk\webapps-dist\target\classes\jboss-as\bin
cd %run_dir%
echo "starting the server, run server 0.0.0.0"
run.bat -c server -b 0.0.0.0 
```

当我说停止时，我的意思![这](../Images/cc6a7cf9697107596480ab6680f28e26.png) 是有一种方法可以在一个批处理文件中运行这里的所有内容吗？

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2012-08-02T18:04:47.507

尝试更改`mvn clean install`为`call mvn clean install`.

如果`mvn`是另一个批处理文件，除非您使用`call`.

# java - 为什么增加 newFixedThreadPool 会导致性能不佳？

> ID：11783150
> 
> 赞同：4
> 
> 时间：2012-08-02T17:57:34.993
> 
> 标签：java, multithreading, concurrency, java.util.concurrent, callable

我正在尝试更改报告的执行并使其同时完成。在“串行模式”中，执行测试需要 30 秒，而在使用并发模式时，我需要 27 秒（考虑到必须串行执行几个步骤，我对结果没问题）。

我仍然没有得到的是这一行：

```
ExecutorService executor = Executors.newFixedThreadPool(4); 
```

我的计算机配备了 2x2.6 Ghz 四核，如果 newFixedThreadPool 很高 (16)，我希望执行时间会减少。实际上，我增加的 newFixedThreadPool 越多，执行速度就越慢。这就引出了一个问题：我做错了什么或者我没有理解什么？！？！

我从我的执行中嵌入了 2 个结果屏幕截图。

A. newSingleThreadExecuter - 在 23 秒内运行

B. newFixedThreadPool(4) - 在 43 秒内运行。

每次我提交“工人”时，我都会得到 system.out currentTimeMillis，“fatched tkt”结果是从数据库获取数据所需的毫秒数。（在策略 A 中 - 大约需要 3 毫秒，在 B 中最多需要 7 毫秒）。

```
 Stopper stopper = new Stopper();
    for (Long iNum : multimap.asMap().keySet())
    {
        List<Long> tickets = (List<Long>) multimap.get(iNum);
        for (Long ticketNumber : tickets)
        {
                pojoPks = getPkData(iNum);
                Callable<PojoTicket> worker = new MaxCommThread(ticketNumber, pojoPks);
                Future<PojoTicket> submit = executor.submit(worker);
                futures.add(submit);
        }
    }

    System.out.println("futurues: " +futures.size());
    for (Future<PojoTicket> future : futures)
    {
        try
        {
            PojoTicket pojoTicket = future.get();
            //do the rest here

        } catch (InterruptedException e)
        {
            System.out.println("---------------------->InterruptedException");
        } catch (ExecutionException e)
        {
            System.out.println("---------------------->ExecutionException");
        }
    }

    executor.shutdown();
    stopper.stop(); 
```

![在此处输入图像描述](../Images/4cf63bdbbe8ec5ddc2eb1be55b6ba9eb.png)

![在此处输入图像描述](../Images/6e47d5ba866ea0996820842cc7358d5e.png)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-02T18:06:39.717

> 我增加的 newFixedThreadPool 越多执行越慢

通常，如果您将线程添加到作业并且它没有加速它可能是由于以下几个原因之一：

*   每个作业都必须在某种资源上同步，因此它们都在为锁争用而战，而不是独立运行。

*   这些作业没有太多的 CPU 工作要做。将线程添加到 IO 绑定进程不会使事情变得更快，因为 IO 通道可能已经被最大化。

但是，如果您的应用程序运行速度减半，这是一个有趣的情况。我只能猜测这是两者的结合。

要尝试的一件事是从 1 个线程开始，然后尝试 2 个。如果它没有运行得更快，那么首先查看作业之间共享的锁。每个作业正在修改哪些并发集合或其他对象？尝试减少锁的数量或让线程存储临时信息，然后锁一次以更新中心对象。

您还可以查看系统统计信息，以查看您的 IO 通道是否已达到最大值。磁盘一个常见的问题在这里。看看你是否可以在内存磁盘上运行，看看你的应用程序是否运行得更快。这将表明您受 IO 限制。

最后，我会研究为什么`ExecutionException`当你的工作获得收获时你会得到任何 s。这可能表明存在其他问题，但您应该首先了解这一点。

# database - 在 AS400 中使用 DB2 的 URL 设置 currentSchema

> ID：11783153
> 
> 赞同：2
> 
> 时间：2012-08-02T17:57:55.383
> 
> 标签：database, hibernate, url, jdbc, db2

对于 DB2 JDBC 类型 4 驱动程序 (com.ibm.db2.jcc.DB2Driver)，在配置中用于连接 DB2 数据库的 URL 是：jdbc:db2://HOST:PORT/DATABASE:currentSchema=SCHEMA; 这与大型机数据库完美配合。

但是，使用驱动程序“com.ibm.as400.access.AS400JDBCDriver”连接到 AS400 上的数据库的 URL 是什么... URL 中包含的“currentSchema”在这种情况下不起作用。用户名被视为模式的名称。如何使用 URL 设置当前架构？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-03T20:01:10.157

使用 as400 子协议，并像这样指定您的默认值

```
jdbc:as400://hostname/default-schema 
```

[http://www-01.ibm.com/support/docview.wss?uid=swg21398042](http://www-01.ibm.com/support/docview.wss?uid=swg21398042)

# php - 如何在将无限的文本流写入文件之前对其进行预处理？

> ID：11783162
> 
> 赞同：5
> 
> 时间：2012-08-02T17:58:23.860
> 
> 标签：php, bash, networking, logging, stream

我正在使用 tcpflow 在服务器上记录网络流量。我想将这些数据记录到一个文件中，但不是*全部*。监视进程将无限期地作为守护进程在后台运行。

流的某些行包含一个字节数，如果我看到该字节数（比如 800 个字节），那么我需要将接下来的 800 个字节记录到文件中。如果没有，我希望不写入文件。

对我来说，对流进行这种“即时预处理”以决定将什么重定向到日志文件的最佳方式是什么？某种正在侦听流的第二个守护程序脚本，它通过管道传输到该脚本？

例子：

我在流中看到以下行：

`1343932842: 010.079.091.189.35856-010.104.001.199.11211: set i:1:20163484235 0 0 1429`

首先，我需要检查它是否有一个“集合”。然后，我检查该行的最后一段（1429），然后读取接下来的 1429 个字节并将其写入文件。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-02T19:34:52.713

是的，使用一个将流作为输入的守护程序，并按照您的描述进行操作。我会推荐 C 而不是脚本，因为它具有非常简单的输入/输出和非常低的开销。

假设您有一个名为“capture”的可执行文件和一个名为“filter”的过滤程序，您可以使用 bash shell 将它们链接在一起

```
bash-prompt$ capture capture-params | filter 
```

任何`capture`写入标准输出的内容都可以`filter`作为标准输入的输入。从过滤器的角度来看，读取行是一件简单的事情，当找到 end ... size 模式时，将输出写入输出文件（或再次写入 stdout）。如果您写入标准输出，则可以使用将其重定向到文件

```
bash-prompt$ capture capture-params | filter > output-file.txt 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-28T04:45:54.753

到目前为止，您所描述的最优雅的应用程序是使用低占用空间的循环数据库。RRDtool 是开源行业标准、高性能数据记录和绘图。

使用 bash 命令，您可以将数据输入到数据库中，如果您选择，绘制它也非常简单。

参见： http: [//oss.oetiker.ch/rrdtool/gallery/index.en.html](http://oss.oetiker.ch/rrdtool/gallery/index.en.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-12T06:16:34.637

您可以使用 awk 进行动态文本处理。您将需要学习该语言，但我在实时日志解析中用于类似任务。我做tail -f file.log | awk -f myscript.awk

每一行都将通过您创建的 awk 脚本进行分析，使用 if-then-else，您可以检测行中存在的一些单词并激活 awk 代码的其他部分以不同方式解析该行，甚至运行外部程序。

# c++ - 检查 Rapidxml 中可变数量的兄弟节点和不同的兄弟节点

> ID：11783171
> 
> 赞同：1
> 
> 时间：2012-08-02T17:58:48.110
> 
> 标签：c++, xml, rapidxml

我在 C++ 中使用 Rapidxml 来读取 xml 文件

基于以下示例，我有两个问题

```
<?xml version="1.0" encoding="utf-8"?>
<rootnode version="1.0" type="example">
  <childnode1 entry="1">
    <evendeepernode attr1="cat" attr2="dog"/>
    <evendeepernode attr1="lion" attr2="wolf"/>
  </childnode1>
  <childnode2 entry="1">
  </childnode2>
</rootnode> 
```

1-如果相同类型的兄弟姐妹（evendeepernode）的数量是可变的。我怎样才能检查它？

2- 如果有不同的兄弟姐妹（例如 childnode1 和 childnode2 ）并且数量是可变的（例如可能有超过 1 个 childnode1 和/或可能有超过 1 个 childnode2 或其中一个可能根本不存在）。我该如何检查？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-02T20:19:01.427

好的，我还没有编译下面的代码，但它应该足够准确，可以根据您的需要进行修改。它至少应该说明您可以用于您的目的的方法和功能。可能有更好的方法，但如果您没有收到其他回复，这将满足您的需求。

对于您描述的 1- 之类的问题，我使用类似于以下的代码

```
xml_document<> doc;    
doc.parse<0>(xml_buffer);    // parse your string
xml_node<>* rootnode = doc.first_node("rootnode");  // Get first node
xml_node<>* childnode1 = rootnode->first_node("childnode1");     // childnode1

if (childnode1 != NULL) {
    // get first deeper node and loop over them all
    int number_of_siblings = 0;
    xml_node<>* deepernode = childnode1->first_node();
    while (deepernode != NULL) {
        // Do processing on this node

        // Your processing code here....

        // now get the next deepernode in this current level of nesting
        // pointer will be NULL when no more siblings 
        deepernode = deepernode->next_sibling();
        number_of_siblings++;
    }
    // Your xml had number_of_sibling nodes at this level
} 
```

对于您的问题 2-您可以使用相同类型的 while 循环来遍历 childnode1 级别的兄弟节点。如果你需要检查兄弟姐妹的名字，你可以使用

```
 string strNodeName = "childnode2";
 if (current_node->name() == strNodeName) {
     // current node is called childnode2 - do your processing.
 } 
```

如果您不需要检查节点名称，只需使用它来循环 rootnode 下的所有子节点

```
xml_document<> doc;    
doc.parse<0>(xml_buffer);    // parse your string
xml_node<>* rootnode = doc.first_node("rootnode");  // Get first node
xml_node<>* childnode = rootnode->first_node();     // get first childnode
int child_node_count = 0;
while (childnode != NULL) {
    // Do processing on this node

    // get sibling of current node (if there is one)    
    childnode = childnode->next_sibling();
    child_node_count++;
}
// child_node_count is now the number of child nodes under rootnode. 
```

# c# - Jquery 选项卡中的异步回调

> ID：11783174
> 
> 赞同：1
> 
> 时间：2012-08-02T17:59:05.233
> 
> 标签：c#, asp.net, ajax, jquery-ui

目前，我独自在一家公司的一个大项目中工作。一部分是 CMS，我想为它使用标签。

在这里我创建了 JQuery 选项卡

```
 $tabs = $('#tabs').tabs({cookie:{}, closable: true });

    });

    function addnewtab(name,link)
    {
         $tabs .tabs("add", link, name, tabcounter);
        $tabs.tabs("select", tabcounter);
        tabcounter++;

    } 
```

在这里，我打开一个新选项卡，并加载文件 Products.aspx。

```
onclick="addnewtab('Products','Products.aspx')" 
```

这是 Products.aspx，其任务是搜索产品并在网格视图中显示它们。出于概述目的，我剪切了 Gridview 的内容。

一切正常，但问题是hole cms 站点被刷新，并且只打开了具有正确内容的Products.aspx。

是否可能只刷新选项卡的内容？

```
<form id="form1"  runat="server">
       <asp:ScriptManager ID="ScriptManager1"   runat="server">
    </asp:ScriptManager>
         <asp:UpdatePanel ID="UpdatePanel1" runat="server">
  <ContentTemplate>

        <div >

             <table class="style1">
                    <tr>
                        <td>
                            <asp:Label ID="Label4" runat="server" Text="Filter: " />
                        </td>
                        <td>
                     <asp:Textbox ID="tb_keyword"  CssClass="dp_field" runat="server">
                            </asp:Textbox>
                        </td>

                        <td>
             <asp:Button ID="btn_get" runat="server"  OnClick="search" Text="Search" />
                        </td>
                    </tr>
                </table>
        </div>

     <asp:gridview id="gvProduct" runat="server" allowpaging="True">                         
        </asp:gridview>

      </ContentTemplate>
       </asp:UpdatePanel>
     </form> 
```

# datagrid - 如何拦截来自数据网格的超链接点击？

> ID：11783175
> 
> 赞同：0
> 
> 时间：2012-08-02T17:59:11.943
> 
> 标签：datagrid, hyperlink, crm

现在我有一个带有模板列的数据网格，如下所示：

`<asp:TemplateColumn> <ItemTemplate> <asp:HyperLink ID="lnkSelect" runat="server" Target="_blank" /> </ItemTemplate></asp:TemplateColumn>`

OnItemDataBound 方法基于此数据网格中包含 GUID 的另一列动态构建超链接的 NavigateURL 属性。通过单击超链接选择一行会为具有该 GUID 的联系人打开一个 Dynamics CRM 网页。该程序通过 JScript 从 CRM 中的功能区按钮单击启动。

该系统运行良好，但我发现我现在需要拦截该点击事件。我尝试添加一个 OnSelectedIndexChanged 事件，但这被忽略了；执行似乎并没有就此停止。

有什么方法可以拦截超链接点击，或者相反，我可以使用另一个控件来允许构建动态 URL 并拦截点击事件吗？

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-02T18:05:58.157

您必须在客户端执行此操作，特别是在“onclick”事件中。

创建一个 JavaScript 函数，例如`clickIntercept()`在导航之前执行必要的操作；然后在您分配 NavigateURL 属性的代码中分配具有“clickIntercept”值的“onclick”属性。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-02T18:54:41.087

谢谢你的回复，Trekstuff。

我还发现我可以将我的超链接更改为 ButtonColumn，删除 OnItemDataBound 代码并改用 OnItemCommand 方法。

对于 OnItemCommand 我有：

```
switch (((LinkButton)e.CommandSource).CommandName)
     {
            case "Select":    
               String selectedContact = ServerURL + QueryStringPrefix + e.Item.Cells[1].Text + QueryStringSuffix;
               Response.Redirect(selectedContact); 
               break;
     } 
```

这对我有用。

# delphi - delphi 2007中SysMon.ocx ActiveX控件在运行时出现EOleSysError未指定错误是什么意思？

> ID：11783178
> 
> 赞同：3
> 
> 时间：2012-08-02T17:59:25.490
> 
> 标签：delphi, activex, perfmon

我发现了一个非常诱人的示例，它使用 Windows 中包含的 SysMon.ocx ActiveX 控件来创建类似性能监视器的功能。

我发现了一个在 HTML 页面中使用它的示例，该页面动态添加了几个性能计数器（在本例中，用于 SQL 服务器性能）。由于 Delphi 可以在运行时轻松创建 ActiveX/OLE 对象，我想我会尝试将[此处](https://gist.github.com/3239139)的 HTML 示例转换为 Delphi。第一步是导入类型库并创建一个`SystemMonitor_TLB.pas`，我创建的，通过通常的导入方式，使用 Delphi 2007。

我已经注册了 OCX，并使用类型库导入器导入了“系统监视器”OCX (SysMon.ocx)，它创建了一个如下所示的导入 TLB.pas 文件。（此处仅显示文件的代表性示例）。

```
unit SystemMonitor_TLB;

// ************************************************************************ //
// WARNING                                                                    
// -------                                                                    
// ...
// Type Lib: C:\Windows\system32\sysmon.ocx (1)
// LIBID: {1B773E42-2509-11CF-942F-008029004347}
// LCID: 0
// Helpfile: 
// HelpString: System Monitor Control
// DepndLst: 
//   (1) v2.0 stdole, (C:\Windows\system32\stdole2.tlb)
// Errors:
//   Hint: TypeInfo 'SystemMonitor' changed to 'SystemMonitor_'
//   Error creating palette bitmap of (TSystemMonitor_) 
// : Registry key CLSID\{C4D2D8E0-D1DD-11CE-940F-008029004347}\ToolboxBitmap32 not found
// ************************************************************************ //
// *************************************************************************//

{$TYPEDADDRESS OFF} // Unit must be compiled without type-checked pointers. 
{$WARN SYMBOL_PLATFORM OFF}
{$WRITEABLECONST ON}
{$VARPROPSETTER ON}
interface

uses Windows, ActiveX, Classes, Graphics, OleCtrls, OleServer, StdVCL, Variants;

// *********************************************************************//
// GUIDS declared in the TypeLibrary. Following prefixes are used:        
//   Type Libraries     : LIBID_xxxx                                      
//   CoClasses          : CLASS_xxxx                                      
//   DISPInterfaces     : DIID_xxxx                                       
//   Non-DISP interfaces: IID_xxxx                                        
// *********************************************************************//
const
  // TypeLibrary Major and minor versions
  SystemMonitorMajorVersion = 3;
  SystemMonitorMinorVersion = 7;

  LIBID_SystemMonitor: TGUID = '{1B773E42-2509-11CF-942F-008029004347}';
  IID_...  // about 20 more lines of GUIDs s
// --SNIP--
// about 5000  lines of pretty typical import-TLB-code snipped
// --SNIP--
procedure Register;
begin
  RegisterComponents(dtlOcxPage, [TSystemMonitor_, TCounterItem, TLogFileItem]);
  RegisterComponents(dtlServerPage, [TCounters, TLogFiles, TCounterItem2, TSystemMonitor2, 
    TAppearPropPage, TGeneralPropPage, TGraphPropPage, TSourcePropPage, TCounterPropPage]);
end;

end. 
```

上面的整个文件可以在[这里](https://gist.github.com/3239139)找到。

我安装了包含这个单元的 .dpk 包，并创建了一个演示表单，并且 ActiveX 控件似乎可以工作，至少在设计时是这样。当我运行我的演示应用程序时，如果我将组件添加到表单中，在设计时，我在运行时遇到异常，它似乎是通过实例化基类的一部分`TOleControl`：

```
procedure TOleControl.CreateControl;
var
  Stream: IStream;
  CS: IOleClientSite;
  X: Integer;
begin
   //  about 12 lines not shown.
   OleCheck(FPersistStream.Load(Stream)); // here's where we get the mystery OLE error.
   DestroyStorage;
   // more code here.
end; 
```

我想知道的是：

1.  神秘的 OLE 错误是什么意思，有人知道我该如何解决吗？

2.  或者，是否有人知道如何解决上述问题，或者以其他方式获得与 delphi 2007 或 xe2 一起使用的 PerfMon 的 sysmon.ocx 的工作（在设计时和运行时）版本？

3.  评论中的提示是否是解决此问题的某种关键：

    ```
     //   Hint: TypeInfo 'SystemMonitor' changed to 'SystemMonitor_' 
    ```

更新：请注意，我正在谈论设计时支持的解决方法。当我只在运行时而不是设计时创建控件时，它工作正常：

```
type
  TSystemMonitor = TSystemMonitor_;
...
procedure TForm1.FormCreate(Sender: TObject);
begin
 SysMonCtrl := TSystemMonitor.Create(Self);
 SysMonCtrl.Align := alClient;
 SysMonCtrl.Parent := Self;
 SysMonCtrl.Show;
end; 
```

也许我应该那样做？

# objective-c - 如何打印 Restkit (IOS) 发送的正文

> ID：11783181
> 
> 赞同：11
> 
> 时间：2012-08-02T17:59:28.987
> 
> 标签：objective-c, ios, cocoa-touch, restkit

我通过 RKObjectManager 发送一个对象：

```
[[RKObjectManager sharedManager] postObject:myObject delegate:delegate]; 
```

映射和路由已经配置，并且可以成功运行。它发送一个 json 并且服务器接收请求，但我有一个问题。在 IOS 端，如何打印发送到服务器的 json。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-08-28T13:16:34.563

将以下内容放入您的应用委托中：

```
RKLogConfigureByName("RestKit/Network", RKLogLevelTrace); 
RKLogConfigureByName("RestKit/ObjectMapping", RKLogLevelTrace); 
```

# python - 无效语法---python

> ID：11783185
> 
> 赞同：-4
> 
> 时间：2012-08-02T17:59:46.973
> 
> 标签：python, syntax

我无法弄清楚为什么它在我的所有 If 语句中都说 Options 一词的语法无效

```
Options = raw_input("Would you like to Square, Cube, Multiply, or Divide?    ")

If  Options == "Square" or Options == "square":
Square = int(raw_input("What number would you like to Square?    "))
Answer1 = Square ** 2
print "The answer is :%d" %Answer1

if Options == "Cube":
Cube = int(raw_input("What number would you like to Cube    "))
Answer2 = Cube ** 3
print "The answer is :%d" %Answer2

if Options == "Multiply":
Multiply1 = int(raw_input("What is the first number to multiply?    "))
Multiply2 = int(raw_input("What is the second number to multiply?     "))
Answer3 = Multiply1 * Multiply2
 print "The answer is :d%" %Answer3" 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-02T18:01:36.140

Python 区分大小写。`If`需要`if`。您的代码也需要正确缩进。

# c# - 大小/类型化 SqlParameters 数组

> ID：11783188
> 
> 赞同：8
> 
> 时间：2012-08-02T18:00:09.213
> 
> 标签：c#, .net, sqlclient

我正在尝试创建一个 dbTyped 和大小的 SqlParameters 数组。这工作正常，但如果我需要另一列，则会导致两个地方的代码都发生变化。

```
SqlParameter[] parameters = {
                                  new SqlParameter("@first_name", SqlDbType.VarChar, 50),
                                  new SqlParameter("@last_name", SqlDbType.VarChar, 50),
                                  new SqlParameter("@middle_name", SqlDbType.VarChar, 50),
                                  new SqlParameter("@empid", SqlDbType.Int)
                            };
parameters[0].Value = to.FirstName;
parameters[1].Value = to.LastName;
parameters[2].Value = to.MiddleName;
parameters[3].Value = to.EmpId; 
```

有什么更好的方法来做到这一点？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-08-02T18:04:08.457

您可以使用[*对象初始化*](http://msdn.microsoft.com/en-us/library/bb384062.aspx)表达式：

```
SqlParameter[] parameters =
{    
  new SqlParameter("@first_name", SqlDbType.VarChar, 50) { Value = to.FirstName },
  new SqlParameter("@last_name", SqlDbType.VarChar, 50) { Value = to.LastName },
  new SqlParameter("@middle_name", SqlDbType.VarChar, 50) { Value = to.MiddleName },
  new SqlParameter("@empid", SqlDbType.Int) { Value = to.EmpId }
}; 
```

您也可以以相同的方式创建一个列表，这通常是首选：

```
List<SqlParameter> parameters = new List<SqlParameter>
{    
  new SqlParameter("@first_name", SqlDbType.VarChar, 50) { Value = to.FirstName },
  new SqlParameter("@last_name", SqlDbType.VarChar, 50) { Value = to.LastName },
  new SqlParameter("@middle_name", SqlDbType.VarChar, 50) { Value = to.MiddleName },
  new SqlParameter("@empid", SqlDbType.Int) { Value = to.EmpId }
}; 
```

或者你甚至可以写一个扩展方法`SqlParameter`：

```
public static SqlParameter WithValue(this SqlParameter parameter, object value)
{
    parameter.Value = value;
    return parameter;
} 
```

然后像这样使用它：

```
List<SqlParameter> parameters = new List<SqlParameter>
{    
  new SqlParameter("@first_name", SqlDbType.VarChar, 50).WithValue(to.FirstName),
  new SqlParameter("@last_name", SqlDbType.VarChar, 50).WithValue = to.LastName)
  new SqlParameter("@middle_name", SqlDbType.VarChar, 50).WithValue(to.MiddleName),
  new SqlParameter("@empid", SqlDbType.Int).WithValue(to.EmpId)
}; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-02T18:09:04.380

您可以使用允许您将值指定为参数的[构造函数重载。](http://msdn.microsoft.com/en-us/library/5a10hy4y.aspx)

例如：

```
SqlParameter[] parameters = {
                              new SqlParameter("@first_name", SqlDbType.VarChar, 50, ParameterDirection.Input, true, 0, 0, "", DataRowVersion.Current, to.FirstName),

etc... 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-02T18:30:17.500

更好的方法？当然：让一个工具帮助你，例如“dapper”：

```
var rows = conn.Query<YourType>(@" your tsql ",
    new { first_name = to.FirstName,
          middle_name = to.MiddleName,
          last_name = to.LastName,
          empid = to.EmpId }).ToList(); 
```

然后，这将为您处理所有参数化和实现。

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2012-08-02T18:02:14.880

您可以像这样添加值：

```
 new SqlParameter("@first_name", SqlDbType.VarChar, 50).value = to.FirstName 
```

# .net - Nhibernate 的 Pk 数据类型选择？

> ID：11783196
> 
> 赞同：0
> 
> 时间：2012-08-02T18:00:44.190
> 
> 标签：.net, nhibernate, guid, hilo

当我开始使用 nhibernate 时，我只是做了我一直使用递增 int 的事情。现在我对 nhibernate 和工作单元有了更多的了解，我觉得增加 int 并不是一个好方法（它们破坏了工作单元）。

我想知道我应该使用什么作为主键？我应该使用 GUID 还是 HILO？

我喜欢 GUID 问他们是独一无二的，但我不喜欢如果你开始获得一个巨大的数据库，他们会占用很多空间。

我没有使用过 HILO，但我认为您需要一个特殊的 hilo 表才能使其工作，这有点糟糕。

人们的想法是什么。

最后，当我有时间时，我想将旧代码转换为使用这种新的 PK 数据类型，以便我可以开始更好地利用工作单元。

将ok数据转换为PK的最佳方法是什么？使用我谈到的两种数据类型中的一种是否比另一种更容易转换？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-02T20:15:28.223

例如，在需要跨数据库复制的情况下，应使用 GUID。而不是标准的 GUID，它会弄乱你的索引。新罕布什尔州有一个 Guid.Comb。

至于 HILO - 仅将其用于批处理。不喜欢使用额外表的想法。之后转移到自然键。

基本上我会建议使用 Guid.Comb。这里有一些关于这些东西的阅读：
[使用 Guid.Comb Identifier Strategy](http://nhforge.org/blogs/nhibernate/archive/2009/05/21/using-the-guid-comb-identifier-strategy.aspx)

# asp.net - .NET 回发使其他浏览器加载 IE 条件注释

> ID：11783197
> 
> 赞同：2
> 
> 时间：2012-08-02T18:00:47.087
> 
> 标签：asp.net, .net, browser, webforms, conditional-comments

这是我的标准条件评论，仅针对 IE8 及以下版本提供 IE hack。它适用于初始负载。

```
<!--[if lt IE 9]>
    <link href="Styles/IE.css" rel="stylesheet" type="text/css" />
<![endif]--> 
```

有回传时，Chrome 21.0.1180.60 m 突然加载！到底是怎么回事？

**更新：**

我确认这也发生在 Firefox 和 Opera 中。我想知道.NET是否以某种方式刮取CSS的源代码，而不考虑条件注释并将它们放在视图状态中，它以某种方式在回发中包含CSS文件？这甚至有意义吗？这里还会发生什么？

**更新 2：**

这很奇怪。条件注释仅加载 CSS（不是纯文本、html 或 javascript）并且仅在标题中加载。Firefox、Opera 和 IE 将加载任意数量的条件注释（无论它们针对哪个浏览器），但 Chrome 只会加载第一个。因此：

```
<!--[if lt IE 9]>
    <link href="Styles/IE.css" rel="stylesheet" type="text/css" />
<![endif]-->
<!--[if IE 7]>
    <style>#test{border:dashed 1px red;</style>
    <script>alert("seven");</script>
<![endif]-->
<!--[if IE 8]>
    <style>#test{border:dashed 1px blue;</style>
    <script>alert("eight");</script>
<![endif]-->
<!--[if IE 9]>
    <style>#test{border:dashed 1px green;</style>
    <script>alert("nine");</script>
<![endif]--> 
```

将`IE.css`在回发时加载所有浏览器，IE、Opera 和 Firefox 将加载 IE 7、8 和 9 的 CSS，导致`#test`. Chrome 不提供`#test`任何边框。不会发生任何 javascript 警报。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-02T18:56:50.097

RadControls 仅在标题中获取条件样式表......据我从他们的文档（[http://www.telerik.com/help/aspnet-ajax/ajax-conditional-comments.html](http://www.telerik.com/help/aspnet-ajax/ajax-conditional-comments.html)）中可以看出，它说：“不幸的是，我们还没有找到一种可行的方法来检查那些[引用条件样式表]，我们不能轻易解决这个问题。”，所以他们只是提供了几个解决方法，一个选项是将条件注释放在身体。因此，为了回答您的问题，开发人员知道这是一个错误，并有望尽快修复...

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-02T18:09:52.883

只是为了排除任何明显的问题，但您没有使用 IE Tab Chrome 扩展程序，是吗？ [https://chrome.google.com/webstore/detail/hehijbfgiekmjfkfjpbkbammjbdenadd](https://chrome.google.com/webstore/detail/hehijbfgiekmjfkfjpbkbammjbdenadd)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-02T18:44:22.190

我会通过使用[HeadJS](http://headjs.com/)或其他 js 库而不是条件样式表来解决这个问题。这是一个非常漂亮的库，具有浏览器检测功能以及许多其他功能。

```
/ older than IE9 /
.lt-ie9 .box { padding: 10px; }

/ CSS fixes for IE6 /
.ie6 ul  { list-style: none; } 
```

# gnuplot - 使用 gnuplot 绘制词频直方图

> ID：11783202
> 
> 赞同：0
> 
> 时间：2012-08-02T18:01:04.680
> 
> 标签：gnuplot

我正在使用 gnuplot 绘制以下数据文件的直方图。

```
data.txt
=========
countries       1
domestic        1
fourth-largest  3
in      4
airline 5
and     8
destinations    3 
```

我想根据单词（x 轴）绘制单词频率（y 轴）的直方图。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-02T18:18:54.937

发现这个：

```
set xtics border in scale 1,0.5 nomirror rotate by -90 offset character 0, 0, 0
plot "data.txt" using 2:xticlabels(1) with histogram 
```

# magento - Magento (1.4.1) - 升级到 PHP5.3，管理员登录不起作用

> ID：11783204
> 
> 赞同：0
> 
> 时间：2012-08-02T18:01:11.447
> 
> 标签：magento, php-5.3

我们刚刚在测试服务器上升级到 PHP 5.3 以开始使用 Magento SOAP API。我们的 PHP 5.2.14 没有安装 PHP SOAP 库。

我发现 short_open_tags 已关闭，错误日志记录未打开并进行了更改。

但是，我无法登录到我的 Magento 管理员。它只是旋转一秒钟，然后立即返回管理员登录页面。没有抛出错误或异常，没有记录 PHP 错误。

我确保 TZ 已同步，/var/cache 目录为空，/var/session 目录为空，web/cookie config_data 值正确，已清除浏览器 cookie 数据...

我不知道还能去哪里寻找或做什么。有任何想法吗？

**更新完成的事情：**

尽管 config_data 表明时区是 America/Chicago，但下面放在 adminhtml/login 模板中的代码显示了这个结果：

```
UTC 08-02-2012 09:40:48 PM 
```

这是使用的代码：

```
echo date_default_timezone_get()."<br />\n";
echo date('m-d-Y h:i:s A'); 
```

从单独的 PHP 脚本运行的相同代码在 3 秒前运行时返回：

```
America/Chicago 08-02-2012 04:40:45 PM 
```

对 /store/app/Mage.php 和 /store/app/code/core/Mage/Core/Model/Locale.php 进行了更改，将 TZ 设置为 America/Chicago，管理员登录页面现在显示

```
America/Chicago 08-02-2012 04:44:41 PM 
```

但仍然没有登录。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-02T18:54:07.873

如果您的管理员登录尝试失败**而没有**显示错误，则几乎总是表明会话处理存在问题。

任何一个

*   无法设置 cookie
*   PHP 无法启动会话
*   服务器的时间不正确同步导致 cookie 立即超时
*   magento 用于设置 cookie 的域与您用于访问该站点的域不匹配（检查`core_config_data`表中的域名并清除缓存），
*   您正在通过域访问该站点，并且遇到了围绕 cookie 设置和域`localhost`的众多浏览器错误之一。`localhost`

祝你好运！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-02T18:53:26.353

您是否仔细检查了所有基本 url 值？

# python - django 自定义小部件和字段作为向导表单中的多个按钮

> ID：11783214
> 
> 赞同：0
> 
> 时间：2012-08-02T18:01:37.923
> 
> 标签：python, django, django-forms

我正在尝试在自定义问题中构建一些东西，从而尝试使用自定义字段和自定义小部件来实现我的目标。但不幸的是，我找不到足够的文档来指导我完成...

就我而言，我正在尝试构建向导的第一个表单，第一个表单将包含一个字段，该字段正在传递从数据库中预先填充的选择字典。字典看起来像这样

```
 choices = {
       1 : {
            'display_name'  : 'Bronze',
            'description'  : 'this package contain all the cool features and much more.',
            },
       2 : {
            'display_name'  : 'Silver',
            'description'  : 'this package contain all the cool features and much less.',
            },
    } 
```

所看到的字典包含从数据库动态提供的服务，这些服务将在初始化时提供给字段。另一方面，我需要构建一个自定义字段和小部件来填充以下 HTML

```
 <div class="choices">
        <div class="span3">
            <h2>Bronze</h2>
            <p>
                this package contain all the cool features and much more.
            </p>
            <input type="button" name="Bronze" value="1" />
        </div>
        <div class="span3">
            <h2>Silver</h2>
            <p>
                this package contain all the cool features and much less.
            </p>
            <input type="button" name="Silver" value="2" />
        </div>            
    </div> 
```

其中每个 span3 代表一行，其中包含包描述名称和按钮，用于选择并移至向导中的下一步。另一方面，我尝试构建一个简单的自定义字段，如下所示

```
class PackageField(forms.CharField):
    default_error_messages = {
        'not_valid_package': _(u'Package selected is not a valid package.'),
    }

    def to_python(self, value):
        print value
        if value in self.validators:
            return None
        return value 
```

和widget.py

```
class PackageWidget(MultiWidget):
    _choices = ()
    def __init__(self, choices, attrs=None):
        self._choices = choices
        super(PackageWidget, self).__init__(attrs)

    def render(self, name, value, attrs=None):

        output = []

        for k, v in self._choices:
            output.append('<div class="span3">%s<input type="button" class="btn"/></div>' % v)

        return mark_safe(self.format_output(output)) 
```

但我确信我编写自定义字段和小部件的方式存在很多错误，因为它们会抛出错误。

如果有人可以指导我如何编写正确的自定义字段和小部件，我将不胜感激，如果有人可以给我一个参考，我可以阅读更多内容，这将有很大帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-02T21:13:12.700

这个怎么样。对不起，重命名了一点，但你应该能够找出差异。下次您应该粘贴您遇到的错误等。

另外，我不知道你需要在`MultiWidget`这里。正常`Widget`工作不行吗？我认为 a`MultiWidget`适用于您想要显示多个不同的小部件时。

```
class Ex1Widget(forms.MultiWidget):
    _choices = ()
    def __init__(self, choices, attrs=[]):
        self._choices = choices
        super(Ex1Widget, self).__init__(attrs)

    def render(self, name, value, attrs=None):
        output = []

        for k, v in self._choices:
            output.append('<div class="span3">%s: <input type="submit" class="btn" value="x" /></div>' % v)

        return mark_safe(self.format_output(output))

class Ex1Form(forms.Form):
    test = forms.CharField(label="", widget=Ex1Widget(choices=(('this', 'This'), ('that', 'That'), ('other', 'Other Thing'),))) 
```

# java - HTTP BOSH 和 HTTP 流水线

> ID：11783217
> 
> 赞同：2
> 
> 时间：2012-08-02T18:01:45.733
> 
> 标签：java, http, web, xmpp

我对 HTTP BOSH 和 HTTP Pipelining 感到困惑。

BOSH 规范：http: [//xmpp.org/extensions/xep-0124.html](http://xmpp.org/extensions/xep-0124.html)

> 如果客户端需要向连接管理器发送一些数据，那么它只需发送包含数据的第二个请求。**不幸的是，大多数受限客户端不支持 HTTP Pipelining**（单个连接上的并发请求），因此客户端通常需要通过第二个 HTTP 连接发送数据。

在这个规范中有很多关于 HTTP 管道的信息，但是来自 [http://en.wikipedia.org/wiki/HTTP_pipelining](http://en.wikipedia.org/wiki/HTTP_pipelining)

> 像 POST 这样的非幂等方法不应该被流水线化。

在 BOSH 规范中：

> 所有信息都编码在标准 HTTP POST 请求和响应的正文中。每个 HTTP 正文都包含一个包装器，该包装器封装了正在传输的 XML 元素（请参阅包装器元素）。

那么 HTTP 流水线如何与 HTTP BOSH 一起使用？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-02T19:38:44.167

HTTP [RFC](http://www.w3.org/Protocols/rfc2616/rfc2616-sec8.html#sec8.1.2.2)说

> 客户端不应使用非幂等方法或非幂等方法序列对请求进行管道传输（参见第 9.1.2 节）。

在这种情况下，“不应”具有[RFC 2119](http://www.ietf.org/rfc/rfc2119.txt)给出的含义，即，

> 此短语或短语“不推荐”表示当特定行为可接受甚至有用时，在特定情况下可能存在正当理由，但在实施使用此标签描述的任何行为之前，应了解全部含义并仔细权衡案例

这意味着，一般来说，不建议将 HTTP 管道与`POST`请求结合使用（这符合[RFC 2616 的](http://www.w3.org/Protocols/rfc2616/rfc2616-sec9.html#sec9.5)概念`POST`）；但是，HTTP 协议实际上并没有禁止它。如果它实际上禁止了这种行为，RFC 2616 将使用“不得”的语言。该`BOSH`规范的作者做出了判断，在对流水线请求`BOSH`没有不利影响的情况下。`POST`

# python - 可以通过列表理解完成列表转换为字符串吗？

> ID：11783221
> 
> 赞同：0
> 
> 时间：2012-08-02T18:02:01.183
> 
> 标签：python, list-comprehension

我想知道`for row in purge_list:`在下面的例子中，它工作正常，是否可以使用列表理解转换为一行：

```
fnam = "purge_list.csv"
fH = open(fnam, 'w+')

out_str = ""

for row in purge_list:
    for str_element in row:
        out_str = str(str_element) + "," + out_str

    out_str = out_str + "\n"
    fH.write(out_str)
    out_str = ""

fH.close() 
```

我的目标是获取列表中返回的结果，并将它们写为逗号分隔的字符串。

谢谢。

## 编辑

这是数据的样子：

```
Device ID   Last Read   PremiseID   
80622121    2011-12-05 23:00:00 304096000   
80630175    2012-04-25 23:09:46 315080000   
80623426    2012-04-25 23:00:00 601012500   
80622084    2012-07-31 23:00:00 604013000   
80581425    2012-07-31 23:00:00 604034000 
```

我感谢对这个答案、评论和答案的关注。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-02T18:26:03.037

作为对您的编辑的回应——这是一种比较容易处理的方法：

```
FH.writelines([','.join(str(x) for x in reversed(row)) for row in purge_list]) 
```

但它仍然很难阅读。`join`我会使用and摆脱内部循环`reversed`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-02T18:08:03.507

是的：

```
>>> purge_list = [ ["a","b"], ["c","d"] ]
>>> ",".join( reversed( [ str(element) for row in purge_list for element in row  ]) )
'd,c,b,a' 
```

要注意：

*   字符串上的`join()`方法将该字符串作为传递给它的列表中每个元素之间的分隔符
*   列表推导可以嵌套，但它是由内而外解释的，这对某些人来说是违反直觉的（包括我在内）
*   您的代码将每个新元素放在字符串的开头，我通过在加入之前反转列表来完成

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-02T18:19:35.747

```
csv='\n'.join([','.join(map(str,row)) for row in purge_list]) 
```

当然，您可以用另一个字符串理解替换地图，但我认为地图更简单。

编辑：我错过了代码中的反向行。所以，FJ的答案是正确的。

再次编辑：要获得尾随的新行（最后一行之后的新行），请使用代码：

```
csv=['%s\n' % line for line in [','.join(map(str,row)) for row in purge_list]] 
```

这是您的代码 using`with`语句的等效项：

```
with open(fnam, 'w+') as file:
    file.writelines('%s\n' % line for line in [','.join(map(str,row)) for row in purge_list]) 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-02T18:20:17.667

我认为以下应该做你想要的，如果它不是你正在寻找的结果，请提供一些示例输入和预期输出：

```
out_str = '\n'.join(','.join(map(str, reversed(row))) for row in purge_list) 
```

您的代码似乎按顺序打印每一行，但每行中的元素被颠倒并用逗号连接，这是我的代码应该做的。

您的代码所做的另一件事（我认为这是无意的）是打印某些行的副本。

`','.join(map(str, reversed(row)))`相当于你的内部 for 循环（除了你的会包含一个尾随逗号），通过将它放在`for row in purge_list`生成器中，我们可以获得每一行的正确输出，然后`'\n'.join`用于从所有行创建一个大字符串。您可能还需要一个尾随换行符，您可以通过添加`+ '\n'`到我的单行代码的最后来实现。

**编辑：**如果您不想撤消任何操作，只需`reversed()`从上面删除调用。

# c++ - c++相互依赖的类模板，指针转换派生类

> ID：11783222
> 
> 赞同：0
> 
> 时间：2012-08-02T18:02:03.057
> 
> 标签：c++, qt, templates, gcc, clang

您好，我正在编写一个显示/显示和基准测试不同图形的程序。图由节点和边组成......所以我的问题是我有两个模板类（模板），它们是所有派生类的基础

```
template <class Node>
class Edge
{
public:
    Edge() : startN(0), endN(0), price(0) {}
    Edge(Node *startN, Node *endN, int price) : startN(startN), endN(endN), price(price)
    {
        startN->toEdges.push_back(this); // PROBLEM HERE
        endN->fromEdges.push_back(this); // PROBLEM HERE
    }

    Node *startNode() const {
        return startN;
    }
    Node *endNode() const {
        return static_cast<Node *>(endN);
    }
    int getPrice() const {
        return price;
    }
    void setPrice(int price) {
        this->price = price;
    }

private:
    Node *startN;
    Node *endN;

    int price;
}; 

template<template<class> class EdgeTemplate >
class NodeBase
{
public:
    NodeBase() : nodeId(0), key(0), state(UNLABELED), prev(0) {}
    NodeBase(int id, int key) : nodeId(id), key(key), state(UNLABELED), prev(0) {}

    void addToEdges(EdgeTemplate<NodeBase> *edge) {
        toEdges.push_back(static_cast<EdgeTemplate<NodeBase> *>(edge));
    }

    int nodeId;
    int key;
    State state;
    NodeBase *prev; // prevous scanned

    QVector<EdgeTemplate<NodeBase> *> fromEdges; // start
    QVector<EdgeTemplate<NodeBase> *> toEdges; // end
}; 
```

另一个模板类中出现错误：

```
template <template<class> class EdgeTemplate, class Node>
class DijkstraAlgorithm {
...
QVector<EdgeTemplate<Node> *> Edges; // the problem for derived classes
...
}; 
```

铛：

```
error: cannot initialize a parameter of type 'Edge<NodeBase<Edge> > *' with an rvalue of type 'Edge<DNode> *'
        startN->addToEdges(this);
                           ^~~~ 
```

海合会：

```
error: no matching function for call to 'QVector<Edge<NodeBase<Edge> >*>::push_back(Edge<DNode>* const)' 
```

所以据我了解，问题是派生类`DNode`（`class DNode : public NodeBase <Edge>`）不能存储在基类型的硬币容器中`NodeBase<Edge>`......我试过强制转换它，但它没有用。

有人可以解释我做错了什么，我该如何解决？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-02T18:28:24.940

在查看模板时，继承关系船舶根本不重要。

```
struct B {};
struct D : B {};

template<typename T>
struct C {};

C<B> *c = new C<D>; // error C<D> is completely different and has no relationship to C<B>

// you might as well say:
float *f = new char[50]; 
```

考虑：

```
template<>
struct C<B> {
    int a,b,c;
    int foo() { return a+b+c;}
};

template<>
struct C<D> {
    std::string s;
    std::string bar();
};

C<B> *c = new C<D>; // pretend it works.
c->foo(); // C<D> doesn't have a,b or c and doesn't have a method foo... 
```

也许 NodeBase 应该只将边缘类型作为模板参数而不是边缘模板。

```
template<typename Edge> struct NodeBase {
    QVector<Edge *> fromEdges;
}; 
```

然后 DNode 继承自`NodeBase<Edge<DNode>>`

可能有更好的方法，可能更直接地使用 CRTP，但如果不了解更多当前设计，就很难说。

# c# - 在 EF 4.x 中处理将 0/1 转换为 False/True 的最简单方法是什么？

> ID：11783226
> 
> 赞同：13
> 
> 时间：2012-08-02T18:02:21.273
> 
> 标签：c#, entity-framework-4

存储的 Proc 返回一个值为 0 或 1 的列，而不转换为 BIT。在我的 POCO 中，如果我将该字段声明为

```
public bool MyColumn {get; set;} 
```

我收到此错误：

```
The specified cast from a materialized 'System.Int32' type to the 'System.Boolean' type is not valid. 
```

这实际上是有道理的，因为 EF 将返回的值识别为整数。

我想知道是否有任何简单的方法（可能添加注释或使用流利的 api）在不接触 Proc 的情况下在场景背后的映射中自动将 0/1 转换为 False/True？

提前致谢！

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2015-02-19T21:01:18.537

另一种选择是从存储过程中返回一个 BIT，这样您就不需要在 C# 端进行任何转换或使用任何奇怪的装饰。这意味着，您可以在 T-SQL 中将整数值转换为 BIT，如下所示：

```
select col1, col2, CONVERT(BIT, CASE WHEN col3 IS NULL THEN 0 ELSE 1 END) as colWithBit
FROM table1 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2012-08-02T18:14:46.483

您可以做的是拥有另一个属性来表示布尔表示。用属性装饰它，`NotMapped`以便 EF 不会考虑将其用于映射。Do 和 If 条件并`true /false`根据 Other 属性的值返回。

```
public Class Customer
{

  [NotMapped]
  public bool MyColumnBool 
  {
      get
      {
         return (MyColumn ==1);
      }
  }

  public int MyColumn {get; set;}
  // other properties

} 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2019-05-22T10:47:12.170

在您的`ApplicationDbContext`（继承自的类`DbContext`）中，您可以使用 Fluent Api 转换数据库的值。

```
protected override void OnModelCreating(ModelBuilder modelBuilder)
{
  base.OnModelCreating(modelBuilder);
  modelBuilder.Entity<TheNameOfYourModelClass>()
    .Property(p => p.MyColumn)
    .HasConversion(
       v => v ? 1 : 0,
       v => (v == 1));
} 
```

现在，您的数据库将`1`在插入`true`for时包含，`MyColumn`反之亦然。当从您的数据库中读取时`1`将转换为`true`，反之亦然。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-06-17T16:31:58.717

基于@jimmy 提供的内容，还可以单独定义 ValueConverter，然后应用于多个实体/属性：

```
protected override void OnModelCreating(ModelBuilder modelBuilder)
{
    var boolConverter = new ValueConverter<bool, int>(
        v => v ? 1 : 0,
        v => (v == 1) ? true : false);

    foreach (var entityType in modelBuilder.Model.GetEntityTypes())
    {
        foreach (var property in entityType.GetProperties())
        {
            if (property.ClrType == typeof(bool))
                property.SetValueConverter(boolConverter);
        }
    }
} 
```

* * *

## 回答 #5

> 赞同：-3
> 
> 时间：2012-08-02T18:18:31.020

采用`System.Convert.ToBoolean(int)`

# python - Pyro 不适用于 python-daemon

> ID：11783227
> 
> 赞同：0
> 
> 时间：2012-08-02T18:02:31.330
> 
> 标签：python, daemon, pyro, python-daemon

那么，让我们开始吧。

1) PYRO - Python Remote Objects - 允许您在不同脚本之间共享对象的库

2) python-daemon - 处理我们脚本的守护进程 - 分离和其他作者称之为“表现良好的守护进程”的东西

有时这个库运行良好，但不能一起使用：（我制作了演示它的脚本（所有三个变体）：

```
from daemon import runner
import Pyro4
import sys
import time 

Pyro4.config.HMAC_KEY='topsecret'

class ADaemon():
    def __init__(self,pid_file,handler):
        self.stdin_path = '/dev/null'
        self.stdout_path = '/dev/tty'
        self.stderr_path = '/dev/tty'
        self.pidfile_path =  pid_file
        self.pidfile_timeout = 5
        self.handler=handler
    def run(self):
        print "Ready."
        self.handler()

class GreetingMaker(object):
    def get_fortune(self, name):
        return "Hello, {0}. Here is your fortune message:\n" \
               "Behold the warranty -- the bold print giveth and the fine print taketh away.".format(name)

greeting_maker=GreetingMaker()
daemon=Pyro4.Daemon()                 # make a Pyro daemon
uri=daemon.register(greeting_maker)   # register the greeting object as a Pyro object

variant=sys.argv[1]  #both|pyro|(start|stop) #daemon

if variant == 'both':
    print 'Pyro & Daemon example'
    print "Pyro is ready. Server uri =", uri      # print the uri so we can use it in the client later
    sys.argv[1]='start'#dont worry about 'zombi' daemons - daemon dont start in this case:( no apocalipsys:(
    runner.DaemonRunner(ADaemon('/tmp/tmp.pid',daemon.requestLoop)).do_action()

elif variant=='pyro':
    print 'Pyro example'
    print "Pyro is ready. Server uri =", uri      # print the uri so we can use it in the client later
    daemon.requestLoop()
elif variant=='start' or variant=='stop':
    print 'Daemon example'
    def testf():
        while True:
            print 'daemon works fine'
            time.sleep(3)
    runner.DaemonRunner(ADaemon('/tmp/tmp.pid',testf)).do_action()
else:
    print 'usage: both|pyro|(start|stop) #daemon' 
```

火焰兵 4.14-1 守护进程 1.5.5

错误：

```
argon@vprime:~/py/pyro$ python for_SO.py both
Pyro & Daemon example
Pyro is ready. Server uri = PYRO:obj_9cfa8b5197b4439a988763978a0473e5@localhost:33997
started with pid 23868
Ready.
Traceback (most recent call last):
  File "for_SO.py", line 35, in <module>
    runner.DaemonRunner(ADaemon('/tmp/tmp.pid',daemon.requestLoop)).do_action()
  File "/usr/lib/python2.7/dist-packages/daemon/runner.py", line 186, in do_action
    func(self)
  File "/usr/lib/python2.7/dist-packages/daemon/runner.py", line 131, in _start
    self.app.run()
  File "for_SO.py", line 18, in run
    self.handler()
  File "/usr/local/lib/python2.7/dist-packages/Pyro4-4.14-py2.7.egg/Pyro4/core.py", line 834, in requestLoop
    self.transportServer.loop(loopCondition=condition)
  File "/usr/local/lib/python2.7/dist-packages/Pyro4-4.14-py2.7.egg/Pyro4/socketserver/threadpoolserver.py", line 130, in loop
    self.events([self.sock])
  File "/usr/local/lib/python2.7/dist-packages/Pyro4-4.14-py2.7.egg/Pyro4/socketserver/threadpoolserver.py", line 153, in events
    csock, caddr=self.sock.accept()
  File "/usr/lib/python2.7/socket.py", line 202, in accept
    sock, addr = self._sock.accept()
socket.error: [Errno 9] Bad file descriptor 
```

# regex - r 正则表达式里程

> ID：11783229
> 
> 赞同：-3
> 
> 时间：2012-08-02T18:02:33.093
> 
> 标签：regex, r

我很难为里程编写正则表达式。里程可以采用以下任何一种形式：

*   130,000 英里
*   130000 英里
*   130XXX 英里
*   130,XXX 英里
*   13 万英里
*   你可以考虑的其他事情

对于正则表达式策略，最好先阅读英里，然后取其前面的第一个单词。因此，首先会读取里程，然后可能会读取 130,XXX。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-02T18:08:28.863

使用这个正则表达式`^\d+,?(\d|X|k)+\smiles$`

# java - 不同的方式

> ID：11783232
> 
> 赞同：3
> 
> 时间：2012-08-02T18:02:34.037
> 
> 标签：java, jsp, jsp-tags

有 -

```
<html>
<body>
         <jsp:useBean id="user" class="user.UserData" scope="session"/>
</body>
</html> 
```

和 -

```
<html>
<body>
         <%
             Object user = session.getAttribute("user.UserData") ; 
         %>
</body>
</html> 
```

假设`user.UserData`存在于`session`. 这两种方式有什么区别吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-02T18:22:35.337

```
<jsp:useBean id="user" class="user.UserData" scope="session"/> 
```

相当于

```
<%
    Object userDataObject = session.getAttribute("user") ; // id="user" of <jsp:useBean> maps to session attribute name "user"
%> 
```

此外，scriptlet 仅从 session 中读取现有数据，如果未找到属性，则返回 null。
如果 <jsp:useBean> 发现 session 中的属性“user”为空，它将创建一个 'user.UserData' 的实例并添加到 session 范围内的属性“user”中。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-02T18:15:29.353

JSP 中的一个众所周知的问题是：避免在页面 (.jsp) 中使用 Java 代码。所以第一种方法更合适，你同意吗？Taglibs`<jsp:useBean />`是一种无需混合层即可访问代码的好方法。我几乎没有介绍过的这个概念是[MVC](http://en.wikipedia.org/wiki/Model%E2%80%93view%E2%80%93controller) “规范”的一部分。

- 编辑 -

访问 bean 的第二种方式称为 scriptlet，应尽可能避免使用。可以在此处找到[JSTL 与 jsp scriptlets](https://stackoverflow.com/questions/4535423/jstl-vs-jsp-scriptlets)的简要比较。

# multithreading - 使用与 ExecutorService 线程的恒定连接

> ID：11783234
> 
> 赞同：0
> 
> 时间：2012-08-02T18:02:38.137
> 
> 标签：multithreading, jdbc, executorservice

我的任务是创建一个独立的 java 应用程序来执行以下操作：

1.  解析 .csv 文件。（这将有大约 300 万条记录）
2.  对于每条记录，在几个 DB 表中插入约 15 行。
3.  输出 .csv 记录是否成功处理。

我目前设计这个的想法是：

1.  阅读 .csv 文件（还没有考虑到这一步）
2.  为 .csv 中的每条记录创建一个工作/任务对象。将所有这些任务对象放在一个队列/列表中。
3.  创建预定义数量的线程（老派，不使用 Executor 框架）

每个线程都有以下逻辑：

1.  创建数据库连接。
2.  `if(getNextJobFromList() != null)`
    `// Prepare and insert the statements in a batch update.`
3.  关闭数据库资源。
4.  给出输出状态

时间在这里是一个很大的限制。

现在的问题：

1.  我可以使用 Executor 框架来加快速度吗？在我的伪代码中，线程在其生命周期内保持数据库连接。我可以在 Executor 框架中执行此操作吗？

2.  还有其他方法可以优化吗？

提前致谢 ：）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-02T18:08:32.923

您可以使用 Executor 来执行此操作。这听起来不是一个好主意，您将因工作而使数据库不堪重负，并且您的大多数线程将花费时间等待。

我认为你最好对数据库进行批量导入（如果你使用的是 Oracle，则使用 SQL*Loader，其他数据库也有类似的工具），不需要多线程。大容量复制速度非常快，它可以关闭约束检查和索引修改，并且只是吞食数据。它比 JDBC 快几个数量级，如果你想要速度，你应该检查一下。

# c++ - 尝试按值返回对象时出现无效指针错误

> ID：11783235
> 
> 赞同：0
> 
> 时间：2012-08-02T18:02:48.640
> 
> 标签：c++

我有一堂课，矩阵

```
class Matrix
{
private:
    int cols;
    int rows;
    int **matrix;
public:
    //constructors and methods
    friend Matrix addandupdate(Matrix a, Matrix b); 
} 
```

我在外部定义了 addandupdate 函数，如下所示，

```
Matrix addandupdate(Matrix a, Matrix b)
{
    int rsize = a.rows;
    int csize = a.cols;

    Matrix c(csize, rsize);

    for(int i=0; i<rsize; i++)
    {
        for(int j=0; j<csize; j++)
        {
            c.set(i,j,a.matrix[i][j]+b.matrix[i][j]);
        }
    }
    return c;
} 
```

然后主要是，

```
Matrix x(c, r);
//filling values in x
//printing x
Matrix newx = addandupdate(x, x);    //something is not right here
//printing newx 
```

除了上面导致引发运行时错误的行之外，一切都很好。

```
*** glibc detected *** ./a.out: munmap_chunk(): invalid pointer: 0x085c6020 ***
======= Backtrace: =========
/lib/i386-linux-gnu/libc.so.6(+0x73e42)[0x183e42]
/lib/i386-linux-gnu/libc.so.6(+0x74525)[0x184525]
/usr/lib/i386-linux-gnu/libstdc++.so.6(_ZdlPv+0x1f)[0x84d51f]
./a.out[0x8048c69]
./a.out[0x8048b05]
/lib/i386-linux-gnu/libc.so.6(__libc_start_main+0xf3)[0x1294d3]
./a.out[0x8048751] 
```

很长一段时间后，我正在编写 C++ 代码。如果这是愚蠢的事情，请原谅我。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-02T18:05:09.120

`Matrix newx = addandupdate(x, x);`调用您尚未实现的复制构造函数，并且您**需要**，因为浅拷贝在您的情况下是不够的。

您还需要一个赋值运算符和析构函数。

或者，正如马克指出的那样，替换`int **matrix;`为`std::vector<std::vector<int> >`.

# wolfram-mathematica - Mathematica-将多项式函数转换为列表并从中提取项

> ID：11783241
> 
> 赞同：3
> 
> 时间：2012-08-02T18:03:17.557
> 
> 标签：wolfram-mathematica

我有一个数学多项式函数，我想将其转换为术语列表。即对于一个函数

```
 v[a_,b_,c_]:=a^2+b^2+c^2 
```

我可以使用 MonomialList 以列表的形式获取术语，即

```
 vl[a_,b_,c_]:=MonomialList[v[a,b,c]] 
```

这给了我：

```
 vl[a,b,c]={a^2,b^2,c^2}; 
```

现在我想从这些术语中的每一个中创建单独的函数，以便我得到：

```
 vl[1,1,1]={1,1,1} 
```

代替

```
 vl[1,1,1]=3 
```

有什么简单的方法可以做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-02T18:33:58.077

例如

```
v[a_, b_, c_] := a^2 + b^2 + c^2
vl[a_, b_, c_] := Module[{x, y, z}, 
                         MonomialList[v[x, y, z]] /. {x -> a, y -> b, z -> c}]
vl[1, 1, 1]
(*
 -> {1,1,1}
*) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-03T03:10:11.823

我没有理由不预先计算列表，如下所示：

```
v[a_, b_, c_] := a^2 + b^2 + c^2

Block[{a, b, c},
 vf[a_, b_, c_] = MonomialList[v[a, b, c]];
] 
```

测试：

```
vf[q, r, s]
vf[1, 1, 1] 
```

> ```
> {q^2, r^2, s^2}
> 
> {1, 1, 1} 
> ```

的定义`vf`：

```
Definition[vf] 
```

> ```
> vf[a_, b_, c_] = {a^2, b^2, c^2} 
> ```

# perl - Perl 剥离 utf 字符串中的坏十六进制字节

> ID：11783247
> 
> 赞同：0
> 
> 时间：2012-08-02T18:03:45.083
> 
> 标签：perl, utf-8, byte, strip

我有一种情况，我的 perl 解析器将根据规范（定义的每个字段的开始、结束、长度）读取平面固定宽度的输入文件，并将创建一个逗号分隔的文件以加载到数据库中。

输入文件可以是 ISO-LATIN-1 或 UTF-8。无论字符集如何，perl 在创建逗号分隔文件方面做得很好（ISO-LATIN-1 到 ISO-LATIN-1 和 utf8 到 utf8）

因为，ISO-LATIN-1 字符只占用一个字节，所以从来没有问题。但是，将数据加载到数据库后，utf-8 会导致问题。由于 perl 解析器在读取输入数据时是按字节进行的，如果恰好有一个 40 字节长度的字段，但是有一个 utf char 占据了 39、40、41 的位置，那么只有前 2 个字节被提取到该字段和相同的内容正在加载到数据库中。

perl 有没有办法读取这个字符串并删除字符串末尾的坏字节？

例如：假设有一个 6 字节字段，字符序列是 Â8Ä，其中字节序列是 c382 38 c384 c382（即 7 个​​字节）。当 perl 解析器解析此数据时，它似乎正在获取 Â8Ä，但查看字节值它会提取 c382 38 c384 c3。最后有一个半字节 c3。有没有办法使用 perl 去除这种坏字节？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-09T20:21:54.510

看到这个：

**本页 **Perl pack函数的'U'模板格式：http:** **[//www.misc-perl-info.com/perl-pack.html](http://www.misc-perl-info.com/perl-pack.html)****

 **这个：

**[http://ahinea.com/en/tech/perl-unicode-struggle.html](http://ahinea.com/en/tech/perl-unicode-struggle.html)**

和这个：

**[Perl：utf8::decode 与 Encode::decode](https://stackoverflow.com/questions/4339377/perl-utf8decode-vs-encodedecode)****

# spring - spring 的 oauth 支持是否可以用于跨平台提供单点登录与多个 oauth 提供者？

> ID：11783248
> 
> 赞同：1
> 
> 时间：2012-08-02T18:03:45.523
> 
> 标签：spring, authentication, oauth, spring-security

我在 spring 的 oauth 支持中看到了一些看起来很有希望的东西，但我想知道它有多成熟。我想为多个 oauth 提供者的 web 应用程序提供单点登录，并验证本地移动 rest api 客户端。

各种 oauth 提供者之间的实现是否存在许多差异，或者是否严格遵守标准？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-03T02:34:45.987

[Spring Social](http://www.springsource.org/spring-social)可能会对您有所帮助。Spring social 将帮助您通过 Facebook 和 Twitter 等提供商登录您的应用程序。

大多数提供商都有 OAuth 1.x 或 OAuth 2.x 实现。使用 spring social 与我们在集成 OAuth 1 或 2 提供者登录方面没有太大区别。

您也可以与[Spring Security](http://static.springsource.org/spring-security/site/reference.html)一起进行 Spring 社交实现

# sharepoint - Powershell 执行 SharePoint 列表操作

> ID：11783253
> 
> 赞同：1
> 
> 时间：2012-08-02T18:04:17.860
> 
> 标签：sharepoint, powershell, sharepoint-2007, version, custom-lists

我有两个相同的 SharePoint 2007 列表。

我可以使用 powershell 执行以下操作：

1.  将第一个列表复制到第二个列表中，其中包含所有项目版本历史记录。
2.  从第一个列表中删除所有版本历史记录
3.  为第一个列表中的每个项目清除大约 15 列

此外，通过 SharePoint 2007 中网页上的按钮使该 powershell 脚本对用户可执行的最佳方法是什么？

非常感谢您对此脚本的任何帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-03T12:29:11.300

由于您可以使用 PowerShell 中的任何 DLL，是的，您可以使用 PowerShell 中的 SharePoint API。

基本上你可以

1.  stsadm 扩展[gl-copylist](http://blog.falchionconsulting.com/index.php/2007/09/importexportcopy-lists/)命令克隆列表（无论如何你都可以从 PowerShell 调用该命令）
2.  [已经有一个 PowerShell 脚本](http://blogs.sharepointpro.net/2011/03/30/versions.aspx)来禁用版本控制，但它涉及所有列表 - 您可能可以获得所需的块。
3.  调用 SPList.Fields["fieldToDelete"].Delete(); 删除列表中的字段。

关于#2 - 不确定这个，但您可以尝试将[SPList.EnableVersioning](http://www.google.lv/url?sa=t&rct=j&q=&esrc=s&source=web&cd=1&ved=0CGkQFjAA&url=http://msdn.microsoft.com/en-us/library/microsoft.sharepoint.splist.enableversioning.aspx&ei=TMEbULXbJcu30AHW9ICYBQ&usg=AFQjCNHepyGcyEH5yFbSzHvFB-A_UMUzIw&sig2=RJjXKA_RNylauxY3eJKBRg)设置为`false`, `.Update()`，然后设置为 ，然后`true`查看它是否会自动删除版本。

要从 powershell 访问 SharePoint API，请执行（[在此处阅读更多内容](http://nickgrattan.wordpress.com/2007/09/03/preparing-powershell-for-sharepoint-and-moss-2007/)）：

```
[System.Reflection.Assembly]::LoadWithPartialName("Microsoft.SharePoint") 
```

请注意，您只能从安装了 SharePoint 的计算机上执行此操作。否则，您将不得不通过 Web 服务与 PowerShell 对话。

# android - AndEngine NullpointerException 创建声音时

> ID：11783255
> 
> 赞同：0
> 
> 时间：2012-08-02T18:04:22.927
> 
> 标签：android, nullpointerexception, andengine, audio

快速提问：我有这个代码：

```
public EngineOptions onCreateEngineOptions() {
    instance = this;

    mCamera = new org.andengine.engine.camera.Camera(0, 0, CAMERA_WIDTH, CAMERA_HEIGHT);

    EngineOptions engineOptions = new EngineOptions(true, ScreenOrientation.LANDSCAPE_SENSOR, new RatioResolutionPolicy(CAMERA_WIDTH, CAMERA_HEIGHT), mCamera);
    engineOptions.getAudioOptions().setNeedsSound(true);
    //engineOptions.getAudioOptions().setNeedsMusic(true);

    return engineOptions;

} 
```

和

```
protected void onCreateResources() {

    SoundFactory.setAssetBasePath("mfx/");

    try {
        this.testSound = SoundFactory.createSoundFromAsset(this.mEngine.getSoundManager(), this, "explosion.ogg");
    } catch (final IOException e) {
        Debug.e(e);
    }
} 
```

我最后在另一个有这个活动的班级上玩它：

```
 activity.mCurrentScene.registerTouchArea(image);
    activity.mCurrentScene.setOnAreaTouchListener(new IOnAreaTouchListener() {

        @Override
        public boolean onAreaTouched(TouchEvent pSceneTouchEvent,
                ITouchArea pTouchArea, float pTouchAreaLocalX,
                float pTouchAreaLocalY) {
            Zancudo.this.activity.testSound.play();
            return false;
        }
    }); 
```

任何想法为什么我得到一个空指针异常？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-22T06:32:13.457

对于您正在使用的播放声音，如下所示

```
Zancudo.this.activity.testSound.play(); 
```

这看起来像问题，因为这里的活动对象没有在`Zancudo`类中实例化。

要访问 testSound，您需要获取**Zancudo**活动的实例。

# json - 带有特殊字符的 Ext.data.JsonStore

> ID：11783262
> 
> 赞同：1
> 
> 时间：2012-08-02T18:05:02.370
> 
> 标签：json, extjs4, special-characters

我正在创建一个 Ext.data.JsonStore 来显示图表。它在 C# 代码中构建的数据存储并通过以下方式插入到页面中：

```
Page.ClientScript.RegisterClientScriptBlock(this.GetType(), "Data", dataScript, true); 
```

这是生成的 javascript 代码：

```
var store = Ext.create('Ext.data.JsonStore', {
   fields: ["name", "ASAP", "Phase 2", "test", "Version 2.0 SR 1"],

   data: [
{ "name": "ASAP", "ASAP": 30, "Phase 2": 10, "test": 5, "Version 2.0 SR 1": 10 } ,
{ "name": "Phase 2", "ASAP": 12, "Phase 2": 5,  "test": 15, "Version 2.0 SR 1": 5 }   
   ]
}); 
```

问题是在“Version 2.0 SR 1”字段中有一个“。” 这导致脚本错误。

它返回的错误是：

```
SCRIPT1004: Expected ';' 
ext-all.js, line 18 character 5081 
```

我假设我需要以某种方式进行编码，但是我尝试将字段修改为无济于事：

```
Version 2\\.0 SR 1
Version 2\.0 SR 1
Version 2\u002E0 SR 1 
```

如果我删除“。” 或将其替换为“_”代码有效。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-03T14:24:41.817

Ext.data.JsonStore 类自动使用代理/读取器配置来配置自己，如下所示：

```
proxy: {
    type  : 'ajax',
    reader: 'json',
    writer: 'json'
} 
```

但是，这对于您所描述的情况还不够，因为您需要在 JSON 阅读器上启用[useSimpleAccessors 配置。](http://docs.sencha.com/ext-js/4-1/#!/api/Ext.data.reader.Json-cfg-useSimpleAccessors)那么，解决方案是使用常规的 Ext.data.Store 代替，并明确指定代理和读取器：

```
var store = Ext.create('Ext.data.Store', {
    proxy: {
        type: 'memory',
        reader: {
            type: 'json',
            useSimpleAccessors: true
        }
    },

    fields: ["name", "ASAP", "Phase 2", "test", "Version 2.0 SR 1"],

    data: [
        { "name": "ASAP", "ASAP": 30, "Phase 2": 10, "test": 5, "Version 2.0 SR 1": 10 } ,
        { "name": "Phase 2", "ASAP": 12, "Phase 2": 5,  "test": 15, "Version 2.0 SR 1": 5 }   
    ]
}); 
```

# python - python httplib/urllib 获取文件名

> ID：11783269
> 
> 赞同：13
> 
> 时间：2012-08-02T18:05:51.977
> 
> 标签：python, urllib, httplib

是否有可能获取文件名

```
e.g. xyz.com/blafoo/showall.html 
```

如果您使用 urllib 或 httplib？

这样我就可以将文件保存在服务器上的文件名下？

如果你去像这样的网站

```
xyz.com/blafoo/ 
```

你看不到文件名。

谢谢

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2012-08-02T18:09:32.023

从响应 http 标头中获取文件名：

```
import cgi

response = urllib2.urlopen(URL)
_, params = cgi.parse_header(response.headers.get('Content-Disposition', ''))
filename = params['filename'] 
```

从 URL 获取文件名：

```
import posixpath
import urlparse 

path = urlparse.urlsplit(URL).path
filename = posixpath.basename(path) 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2019-04-18T11:27:55.823

使用`urllib.request.Request`：

```
import urllib

req = urllib.request.Request(url, method='HEAD')
r = urllib.request.urlopen(req)
print(r.info().get_filename()) 
```

例子 ：

```
In[1]: urllib.request.urlopen(urllib.request.Request('https://httpbin.org/response-headers?content-disposition=%20attachment%3Bfilename%3D%22example.csv%22', method='HEAD')).info().get_filename()
Out[1]: 'example.csv' 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-02T18:09:25.957

你问什么没有多大意义。您唯一拥有的是 URL。从 URL 中提取最后一部分，或者您可以检查 HTTP 响应中的类似内容

```
content-disposition: attachment;filename="foo.bar" 
```

服务器可以设置此标头以指示文件名是**foo.bar**。这通常用于文件下载或类似的东西。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-02T18:09:53.867

我在谷歌上搜索了你的问题，我发现它在我相信之前已经在 stackoverflow 中得到了回答。

试试看这个帖子：

[在 Python 中使用 urllib2。如何获取正在下载的文件的名称？](https://stackoverflow.com/questions/5533880/using-urllib2-in-python-how-do-i-get-the-name-of-the-file-i-am-downloading)

> 文件名通常由服务器通过 content-disposition 标头包含：
> 
> ```
> content-disposition: attachment; filename=foo.pdf 
> ```
> 
> 您可以通过以下方式访问标题
> 
> ```
> result = urllib2.urlopen(...)
> result.info() <- contains the headers
> 
> i>>> import urllib2
> ur>>> result = urllib2.urlopen('http://zopyx.com')
> >>> print result
> <addinfourl at 4302289808 whose fp = <socket._fileobject object at 0x1006dd5d0>>
> >>> result.info()
> <httplib.HTTPMessage instance at 0x1006fbab8>
> >>> result.info().headers
> ['Date: Mon, 04 Apr 2011 02:08:28 GMT\r\n', 'Server: Zope/(unreleased version, python 2.4.6, linux2) ZServer/1.1 
> ```
> 
> Plone/3.3.4\r\n', '内容长度: 15321\r\n', '内容类型: text/html; charset=utf-8\r\n', 'Via: 1.1 www.zopyx.com\r\n', 'Cache-Control: max-age=3600\r\n', '过期时间: Mon, 04 Apr 2011 03:08:28 GMT\r\n', '连接：关闭\r\n']
> 
> 看
> 
> [http://docs.python.org/library/urllib2.html](http://docs.python.org/library/urllib2.html)

# c# - 返回任务时链接任务的正确方法是什么？

> ID：11783277
> 
> 赞同：26
> 
> 时间：2012-08-02T18:06:40.463
> 
> 标签：c#, task-parallel-library

我非常喜欢在 C# 中使用 Tasks，但是当我尝试从方法返回 Task 并且该方法将在其内部执行多个任务时，我感到困惑。那么我是否让我的方法启动一个新任务，然后在其中按顺序执行所有操作？用 .ContinueWith() 做这一切很难

例子：

```
public Task<string> GetSomeData(CancellationToken token)
{
    return Task.Factory.StartNew(() =>
    {
        token.ThrowIfCancellationRequested();

        var initialData = GetSomeInteger(token).Result;

        return GetSomeString(initialData, token).Result;
    });
}

public Task<int> GetSomeInteger(CancellationToken token)
{
    return Task<int>.Factory.StartNew(() =>
    {
        return 4;
    }, token);
}

public Task<string> GetSomeString(int value, CancellationToken token)
{
    return Task<string>.Factory.StartNew(() =>
    {
        return value.ToString();
    }, token);
} 
```

我不确定如何编写此方法以使其正确使用任务。我想我只是觉得那里应该有一个 .ContinueWith 之类的东西。

可能修复？？

```
public Task<string> GetSomeData(CancellationToken token)
{
    return GetSomeInteger(token).ContinueWith((prevTask) =>
    {
        return GetSomeString(prevTask.Result, token);
    }, token).Unwrap();
} 
```

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2012-08-02T18:22:12.220

一般来说，如果您已经在使用基于任务的方法，通常最好尽量避免启动新任务。链接任务而不是显式阻塞将减少系统的开销，因为它不会让 ThreadPool 线程处于等待状态。

话虽这么说，在你做的时候阻止通常更简单。

请注意，C# 5 使这变得更加简单，它提供了一个 API，可以为您提供两全其美的功能：

```
public async Task<string> GetSomeData(CancellationToken token)
{
    token.ThrowIfCancellationRequested();

    var initialData = await SomeOtherMethodWhichReturnsTask(token);

    string result = await initialData.MethodWhichAlsoReturnsTask(token);

    return result;
}; 
```

* * *

更新后编辑：

鉴于新代码，没有一种简单的方法可以直接将其与`ContinueWith`. 有几个选项。您可以使用[Unwrap](http://msdn.microsoft.com/en-us/library/dd780917.aspx)来转换`Task<Task<string>>`您创建的，即：

```
public Task<string> GetSomeData(CancellationToken token)
{
    Task<Task<string>> task = GetSomeInteger(token)
                               .ContinueWith(t => 
                               {
                                   return GetSomeString(t.Result, token);
                               }, token);
    return task.Unwrap();
} 
```

或者，您可以通过以下方式优雅地处理展开[`TaskCompletionSource<T>`](http://msdn.microsoft.com/en-us/library/dd449174.aspx)：

```
public Task<string> GetSomeData(CancellationToken token)
{
    var tcs = new TaskCompletionSource<string>();

    Task<int> task1 = GetSomeInteger(token);
    Task<Task<string>> task2 = task1.ContinueWith(t => GetSomeString(t.Result, token));
    task2.ContinueWith(t => tcs.SetResult(t.Result.Result));
    return tcs.Task;
} 
```

这允许整个进程在不创建新任务（绑定线程池线程）的情况下工作，并且不会阻塞。

请注意，您可能希望在取消时添加延续，并在请求取消时也使用[tcs.SetCancelled](http://msdn.microsoft.com/en-us/library/dd449188.aspx)。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2014-08-24T03:09:51.917

这是我为解决此问题而构建的扩展方法。在 .Net 中工作 4+

```
public static Task<TNewResult> ContinueWith<T, TNewResult>(this Task<T> task, Func<Task<T>, Task<TNewResult>> continuationFunction, CancellationToken cancellationToken)
{
    var tcs = new TaskCompletionSource<TNewResult>();
    task.ContinueWith(t => 
    {
        if (cancellationToken.IsCancellationRequested)
        {
            tcs.SetCanceled();
        }
        continuationFunction(t).ContinueWith(t2 => 
        {
            if (cancellationToken.IsCancellationRequested || t2.IsCanceled)
            {
                tcs.TrySetCanceled();
            }
            else if (t2.IsFaulted)
            {
                tcs.TrySetException(t2.Exception);
            }
            else
            {
                tcs.TrySetResult(t2.Result);
            }
        });
    });
    return tcs.Task;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-02T18:16:00.893

是的，一切都将在您的主要任务中按顺序运行。这是因为调用 Result 属性将阻塞当前线程，直到值返回。

# html - HTML表格，有没有办法将第二列放到新行？

> ID：11783279
> 
> 赞同：0
> 
> 时间：2012-08-02T18:06:46.123
> 
> 标签：html, css

嗨，我有一个包含 5 列的表，问题是第一列的`<td>`值可能很长，因此会被塞满。有没有办法将第二列移动到换行符并将第一列跨越整行而不`<tr>`为第一列创建新行

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-02T18:11:21.213

不，您必须为第二*行*`tr`创建一个新的（表格*行*），并且您可以使用该属性使第一个更宽。*`colspan`*

 *像这样的东西：

```
<table>
  <tr>
    <td colspan="2">abcdefg</td>
  </tr>
  <tr>
    <td>a</td>
    <td>b</td>
  </tr>
</table> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-02T18:13:28.343

我不相信`td`'s可以那样垂直堆叠..也许不是使用`td`'s，你可以将它们分成`div`'s，弄乱CSS会使它们排成一行，当第一个伸展到大时，它应该把另一个推到下面吗？

编辑 2：较新的版本，更好的对齐。

```
<table style="width: 200px;">
    <tr>
        <td>
            <div style="background-color: red; display: inline;">
                OneOneOneOne
            </div>
            <div style="background-color: blue; display: inline; width: 90px;">
                TwoTwoTwo
            </div>
            <div style="background-color: green; display: inline; width: 90px;">
                Three
            </div>  
        </td>
    </tr>
    <tr>
        <td>
            <div style="background-color: red; display: inline;">
                OneOneOneOneOneOneOneOneOneOneOne
            </div>
            <div style="background-color: blue; display: inline; width: 90px;">
                TwoTwoTwo
            </div>
            <div style="background-color: green; display: inline; width: 90px;">
                Three
            </div>
        </td>
    </tr>
</table> 
```

看起来不漂亮，需要更多的调整，但它就像你描述的那样......*

# bash - 使用 cURL 下载目录中的所有文件

> ID：11783280
> 
> 赞同：21
> 
> 时间：2012-08-02T18:06:54.203
> 
> 标签：bash, shell, curl, ftp, sftp

我正在使用 cURL 尝试下载某个目录中的所有文件。

这是我的文件列表的样子：

![在此处输入图像描述](../Images/5c1d0f9c1223f1390a1ccec5ee285f74.png)

我曾尝试在 bash 脚本中做：`iiumlabs.[].csv.pgp`而且`iiumlabs*`我猜 curl 在通配符上并不大。

```
curl -u login:pass ftp.myftpsite.com/iiumlabs* -O 
```

**问题：**我如何使用 cURL 下载这个文件目录？

* * *

## 回答 #1

> 赞同：50
> 
> 时间：2012-08-02T21:03:06.357

如果您不限于 curl，您可能希望在递归模式下使用[wget](https://www.gnu.org/software/wget/manual/wget.html)但将其限制为一级递归，请尝试以下操作；

```
wget --no-verbose --no-parent --recursive --level=1\
--no-directories --user=login --password=pass ftp://ftp.myftpsite.com/ 
```

*   `--no-parent`：递归检索时永远不要上升到父目录。
*   `--level=depth`：指定递归最大深度级别深度。默认的最大深度为五层。
*   `--no-directories`：递归检索时不要创建目录层次结构。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2012-08-02T19:18:16.200

好的，考虑到您使用的是 Windows，最简单的方法是使用`ftp`与其捆绑的标准工具。我将以下解决方案基于 Windows XP，希望它在其他版本上也能正常工作（或稍作修改）。

首先，您需要为`ftp`程序创建一个批处理（脚本）文件，其中包含它的指令。根据需要命名，然后放入：

```
curl -u login:pass ftp.myftpsite.com/iiumlabs* -O

open ftp.myftpsite.com
login
pass
mget *
quit 
```

第一行打开与 ftp 服务器的连接`ftp.myftpsite.com`。以下两行指定登录名和 ftp 将要求的密码（仅将 和 替换`login`为`pass`登录名和密码，不带任何关键字）。然后，您用于`mget *`获取所有文件。除了`*`，您可以使用任何通配符。最后，您可以在没有交互提示`quit`的情况下关闭程序。`ftp`

如果您需要先进入某个目录，请`cd`在`mget`. 它应该很简单。

最后，编写该文件并`ftp`像这样运行：

```
ftp -i -s:yourscript 
```

where`-i`禁用交互性（在下载文件之前询问），并`-s`指定您创建的脚本的路径。

* * *

遗憾的是，Windows 本身不支持通过 SSH 传输文件。但是对于这种情况，您可能还是想使用[PuTTy](http://www.chiark.greenend.org.uk/~sgtatham/putty/download.html)工具。对于这种情况，特别感兴趣的是它实际上是 openssh命令`pscp`的 PuTTy 对应部分。`scp`

语法类似于`copy`命令，它支持通配符：

```
pscp -batch login@mysshsite.com:iiumlabs* . 
```

如果您使用密钥文件进行身份验证，则应使用`-i path-to-key-file`. 如果您使用密码，`-pw pass`. 它还可以使用 load`-load your-session-name`参数重用使用 PuTTy 保存的会话。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2014-03-20T17:11:03.197

像这样的东西怎么样：

```
for /f %%f in ('curl -s -l -u user:pass ftp://ftp.myftpsite.com/') do curl -O -u user:pass ftp://ftp.myftpsite.com/%%f 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2018-10-30T13:52:54.607

您可以在 mac 上使用这样的脚本：

```
for f in $(curl -s -l -u user:pass ftp://your_ftp_server_ip/folder/) 
 do curl -O -u user:pass ftp://your_ftp_server_ip/folder/$f 
done 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-08-02T18:23:10.807

哦，我有你需要的东西！

```
$host = "ftp://example.com/dir/";
$savePath = "downloadedFiles";
if($check = isFtpUp($host)){

    echo $ip." -is alive<br />";

    $check = trim($check);
    $files = explode("\n",$check);

    foreach($files as $n=>$file){
        $file = trim($file);
        if($file !== "." || $file !== ".."){
            if(!saveFtpFile($file, $host.$file, $savePath)){
                // downloading failed. possible reason: $file is a folder name.
                // echo "Error downloading file.<br />";
            }else{
                echo "File: ".$file." - saved!<br />";
            }
        }else{
            // do nothing
        }
    }
}else{
    echo $ip." - is down.<br />";
} 
```

`isFtpUp`和功能`saveFtpFile`如下：

```
function isFtpUp($host){
$ch = curl_init();

curl_setopt($ch, CURLOPT_URL, $host);
curl_setopt($ch, CURLOPT_USERPWD, "anonymous:your@email.com");
curl_setopt($ch, CURLOPT_FTPLISTONLY, 1);
curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);
curl_setopt($ch, CURLOPT_TIMEOUT, 3);

$result = curl_exec($ch);

return $result;

}

function saveFtpFile( $targetFile = null, $sourceFile = null, $savePath){

// function settings
set_time_limit(60);
$timeout = 60;
$ftpuser = "anonymous";
$ftppassword = "your@email.com";
$savePath = "downloadedFiles"; // should exist!
$curl = curl_init();
$file = @fopen ($savePath.'/'.$targetFile, 'w');

if(!$file){
    return false;
}

curl_setopt($curl, CURLOPT_URL, $sourceFile);
curl_setopt($curl, CURLOPT_USERPWD, $ftpuser.':'.$ftppassword);

// curl settings

// curl_setopt($curl, CURLOPT_FAILONERROR, 1);
// curl_setopt($curl, CURLOPT_FOLLOWLOCATION, 1);
curl_setopt($curl, CURLOPT_RETURNTRANSFER, 1);
curl_setopt($curl, CURLOPT_TIMEOUT, $timeout);
curl_setopt($curl, CURLOPT_FILE, $file);

$result = curl_exec($curl);

if(!$result){
    return false;
}

curl_close($curl);
fclose($file);

return $result;
} 
```

编辑：

这是一个 php 脚本。将其保存为 .php 文件，将其放在您的网络服务器上，将 $ip 更改为您要从中下载文件的 ftp 服务器的地址（不必是 ip），在与该文件相同的目录中创建一个名为 downloadFiles 的目录。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2014-08-30T06:34:38.277

以下是我使用 cURL 快速下载的方法（但我不确定它可以下载多少文件）：

```
setlocal EnableDelayedExpansion

cd where\to\download

set STR=
for /f "skip=2 delims=" %%F in ('P:\curl -l -u user:password ftp://ftp.example.com/directory/anotherone/') do set STR=-O "ftp://ftp.example.com/directory/anotherone/%%F" !STR!
path\to\curl.exe -v -u user:password !STR! 
```

为什么**跳过=2**？搭便车`.`_`..`

为什么**delims=**？支持带空格的名称

# c++ - Visual Studio 中的解决方案范围定义？

> ID：11783281
> 
> 赞同：6
> 
> 时间：2012-08-02T18:06:55.113
> 
> 标签：c++, linux, visual-studio-2008, global-variables, porting

我有一个使用 Visual Studio 2008 构建的非常大的应用程序，该应用程序旨在在 Windows XP 上运行。该代码由一个包含六个独立项目的解决方案文件组成。我的工作是将这个应用程序移植到 Linux 上运行。我以前没有做过这样的事情。

我昨天发现，我的公司希望在我完成此代码后仍能在 Windows 上编译。我的第一个想法是使用预处理器语句，例如：

```
#define COMPILE_FOR_LINUX 
```

然后，我可以使用如下预处理器块告诉编译器哪些文件包含在头文件中：

```
#ifdef COMPILE_FOR_LINUX
// include required Linux headers here and skip Windows header includes
#else
// include required Windows headers here and skip Linux header includes
#endif 
```

包含适当的文件后，我可以使用以下块封装所有平台相关代码：

```
#ifdef COMPILE_FOR_LINUX
// compile Linux specific code used here.
#else
// compile Windows specific code used here.
#endif 
```

为了使某人尽可能容易地为他们喜欢的平台编译应用程序，我希望只在一个地方指定 COMPILE_FOR_LINUX。但是，我不确定如何做到这一点。

我的一个想法是创建一个空的头文件，然后让解决方案中的每个文件都包含在 Visual Studio 解决方案文件包含路径中指定的这个头文件。对于 Linux，我有另一个定义 COMPILE_FOR_LINUX 的头文件版本，然后让 makefile 指向这个版本而不是空的。但是，我确信这是一个非常粗略的解决方案，我不确定它是否会起作用。

**任何人都可以提出一种更优雅的方法来全局定义某些东西或以解决方案中的每个文件都可以看到它的方式创建变量吗？**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-02T18:09:19.310

这取决于您使用的编译器，但是`gcc`您可以从命令行指定预处理器指令，因此您只需要添加`COMPILE_FOR_LINUX`您的 makefile。

```
g++ -DCOMPILE_FOR_LINUX ..... 
```

对于windows，如果使用MSVS，你可以在项目属性中更改`Preprocessor directives`选项卡（实际上你不需要，因为`COMPILE_FOR_LINUX`没有定义，但你可以添加一个`COMPILE_FOR_WINDOWS`以保持一致性）。

# spring - 如何在 JUnit 测试中模拟 TransactionManager（在容器外）？

> ID：11783283
> 
> 赞同：14
> 
> 时间：2012-08-02T18:07:03.100
> 
> 标签：spring, transactions, junit, mocking, jta

我正在使用 Spring 3.1.0.RELEASE、JUnit 4.8.1，并最终将我的应用程序部署到 JBoss 4.2 服务器（我知道，我知道）。作为设置我的单元测试的一部分，我在我的 Spring 测试应用程序上下文中有这个......

```
<bean id="transactionManager"  
    class="org.springframework.transaction.jta.JtaTransactionManager">
        <property name="userTransactionName">
        <value>UserTransaction</value>
    </property> 
</bean> 
```

当然，现在这失败了，因为没有任何东西绑定到 JNDI 名称“UserTransaction”。如何模拟事务管理器？我正在使用 org.mockejb 框架，但对任何合适的模拟框架都是开放的。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-03-21T11:33:21.740

我们简单地为事务管理器创建一个空的实现，并确保在单元测试使用的 spring-context 中使用这个实现

```
package sample;

import org.springframework.stereotype.Service;
import org.springframework.transaction.PlatformTransactionManager;
import org.springframework.transaction.TransactionDefinition;
import org.springframework.transaction.TransactionException;
import org.springframework.transaction.TransactionStatus;

public class MockedTransactionManager implements PlatformTransactionManager {

    @Override
    public TransactionStatus getTransaction(TransactionDefinition definition) throws TransactionException {
        return null;
    }

    @Override
    public void commit(TransactionStatus status) throws TransactionException {

    }

    @Override
    public void rollback(TransactionStatus status) throws TransactionException {

    }

} 
```

..在spring-xml文件中看起来像..

```
<bean id="transactionManager" class="sample.MockedTransactionManager"/> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2020-05-27T11:29:10.050

您还可以使用[Mockito](https://site.mockito.org/)：

```
PlatformTransactionManager manager = mock(PlatformTransactionManager.class); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-04-12T09:06:58.293

您可以使用[PseudoTransactionManager](https://docs.spring.io/spring-integration/api/org/springframework/integration/transaction/PseudoTransactionManager.html)：

```
PlatformTransactionManager manager = new PseudoTransactionManager(); 
```

# c# - Oracle 未知异常

> ID：11783284
> 
> 赞同：2
> 
> 时间：2012-08-02T18:07:06.400
> 
> 标签：c#, oracle, .net-4.0

在我的本地机器上抛出一个奇怪的 Oracle 异常。该应用程序在测试环境中运行良好，但不会在本地运行。我在本地安装了 Oracle 版本 10.2 和 11.2，在我的项目中引用了 10.2 Oracle.DataAccess.dll(10.2.0.100)。抛出异常，但没有异常消息可以帮助我解决它。使用 C#/.NET 4.0获得更大的图像：http ![在此处输入图像描述](../Images/72948163edb1461e57ba77f5e07e8059.png) : [//i.imgur.com/R88M3.png](https://i.imgur.com/R88M3.png)

这是“异常详细信息”文本：

```
Oracle.DataAccess.Client.OracleException was unhandled by user code
  HResult=-2146233087
  Message=""
  StackTrace:
       at Oracle.DataAccess.Client.OracleException.HandleErrorHelper(Int32 errCode, OracleConnection conn, IntPtr opsErrCtx, OpoSqlValCtx* pOpoSqlValCtx, Object src, String procedure)
       at Oracle.DataAccess.Client.OracleException.HandleError(Int32 errCode, OracleConnection conn, IntPtr opsErrCtx, Object src)
       at Oracle.DataAccess.Client.OracleConnection.Open()
       at DomainModel.Concrete.AutherizationRespository.getUser(String sqlCmd) in C:\LocalRepository\Web_Apps\TransferArticulation6\trunk\DomainModel\Concrete\AutherizationRespository.cs:line 38
       at DomainModel.Concrete.AutherizationRespository.GetAdminUser(String netId) in C:\LocalRepository\Web_Apps\TransferArticulation6\trunk\DomainModel\Concrete\AutherizationRespository.cs:line 30
       at TransferArticulation4.Controllers.AccountController.SecondaryAuthentication(String userNetId) in C:\LocalRepository\Web_Apps\TransferArticulation6\trunk\TransferArticulation\Controllers\AccountController.cs:line 117
       at TransferArticulation4.Controllers.AccountController.Logon(FormCollection form) in C:\LocalRepository\Web_Apps\TransferArticulation6\trunk\TransferArticulation\Controllers\AccountController.cs:line 84
       at lambda_method(Closure , ControllerBase , Object[] )
       at System.Web.Mvc.ActionMethodDispatcher.Execute(ControllerBase controller, Object[] parameters)
       at System.Web.Mvc.ReflectedActionDescriptor.Execute(ControllerContext controllerContext, IDictionary`2 parameters)
       at System.Web.Mvc.ControllerActionInvoker.InvokeActionMethod(ControllerContext controllerContext, ActionDescriptor actionDescriptor, IDictionary`2 parameters)
       at System.Web.Mvc.ControllerActionInvoker.<>c__DisplayClassd.<InvokeActionMethodWithFilters>b__a()
       at System.Web.Mvc.ControllerActionInvoker.InvokeActionMethodFilter(IActionFilter filter, ActionExecutingContext preContext, Func`1 continuation)
  InnerException: 
```

堆栈跟踪文本：

```
 at Oracle.DataAccess.Client.OracleException.HandleErrorHelper(Int32 errCode, OracleConnection conn, IntPtr opsErrCtx, OpoSqlValCtx* pOpoSqlValCtx, Object src, String procedure)
   at Oracle.DataAccess.Client.OracleException.HandleError(Int32 errCode, OracleConnection conn, IntPtr opsErrCtx, Object src)
   at Oracle.DataAccess.Client.OracleConnection.Open()
   at DomainModel.Concrete.AutherizationRespository.getUser(String sqlCmd) in C:\LocalRepository\Web_Apps\TransferArticulation6\trunk\DomainModel\Concrete\AutherizationRespository.cs:line 38
   at DomainModel.Concrete.AutherizationRespository.GetAdminUser(String netId) in C:\LocalRepository\Web_Apps\TransferArticulation6\trunk\DomainModel\Concrete\AutherizationRespository.cs:line 30
   at TransferArticulation4.Controllers.AccountController.SecondaryAuthentication(String userNetId) in C:\LocalRepository\Web_Apps\TransferArticulation6\trunk\TransferArticulation\Controllers\AccountController.cs:line 117
   at TransferArticulation4.Controllers.AccountController.Logon(FormCollection form) in C:\LocalRepository\Web_Apps\TransferArticulation6\trunk\TransferArticulation\Controllers\AccountController.cs:line 84
   at lambda_method(Closure , ControllerBase , Object[] )
   at System.Web.Mvc.ActionMethodDispatcher.Execute(ControllerBase controller, Object[] parameters)
   at System.Web.Mvc.ReflectedActionDescriptor.Execute(ControllerContext controllerContext, IDictionary`2 parameters)
   at System.Web.Mvc.ControllerActionInvoker.InvokeActionMethod(ControllerContext controllerContext, ActionDescriptor actionDescriptor, IDictionary`2 parameters)
   at System.Web.Mvc.ControllerActionInvoker.<>c__DisplayClassd.<InvokeActionMethodWithFilters>b__a()
   at System.Web.Mvc.ControllerActionInvoker.InvokeActionMethodFilter(IActionFilter filter, ActionExecutingContext preContext, Func`1 continuation) 
```

我还应该提到，如果我引用版本 11.2 Oracle.DataAccess.dll(4.112.2.0)，我可以让它在本地运行，但是它在测试服务器上不起作用。

# java - 在屏幕上绘图 - Java

> ID：11783285
> 
> 赞同：0
> 
> 时间：2012-08-02T18:07:06.650
> 
> 标签：java, drawing

我想在 Java 的屏幕上绘制和更新一些简单形状（如线条、圆形或矩形）的位置。例如，我想在光标周围圈。我可以用Robot得到光标的位置，然后怎么画？有没有一些简单的方法可以做到这一点？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-02T18:08:52.103

这是一个非常广泛的问题。你应该看看[Java2D Tutorials](http://docs.oracle.com/javase/tutorial/2d/index.html)，他们应该给你一个开始。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-02T18:24:22.683

对于形状和图片，如果你用谷歌搜索，互联网上的教程很少，我认为 oracle docs 下的 java 教程对初学者有好处 - [http://docs.oracle.com/javase/tutorial/2d/index.html](http://docs.oracle.com/javase/tutorial/2d/index.html)

或者

这里[http://www.apl.jhu.edu/~hall/java/Java2D-Tutorial.html](http://www.apl.jhu.edu/~hall/java/Java2D-Tutorial.html)

其次，这些教程只是为您提供指导，我建议您阅读 Java 2d/3d 图形方面的书，这样您就可以很好地理解图形概念。

# java - 比较两个时间值并存储在数组中

> ID：11783299
> 
> 赞同：0
> 
> 时间：2012-08-02T18:08:15.783
> 
> 标签：java, android

我有四个整数

```
int minute;   int houre;  
int endHour;  int endMin; 
```

假设前两个是`houre = 6 -- minute = 40 so time is 6:40` 第二个是`endHour = 22 endMin = 40 so time is 22:40`

现在我想添加 10 分钟并将所有可能的时间值添加到数组中，直到 22:40。以下是我正在使用的代码

```
while (houre <= endHour && minute <= endMin)
            {   
              if (minute + 10 >= 60)
                    houre += 1;

                minute = (minute + 10) % 60;
                Datee dat = new  Datee();
                dat.startHour = houre;
                dat.startMin = minute;
                arrayOfTime.add(dat);
             } 
```

错误是在`minute <= endMin`……它在达到更多小时之前在这种情况下结束。谁能给我一个解决方案。我不知道为什么我不能解决这个小问题

最好的祝福

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-02T18:12:52.150

```
while( !(hour > endHour && minute > endMin) ) 
```

您当前的代码继续 while 循环，直到小时或分钟大于结束时间。您不想退出，直到它们都高于结束时间。

也就是说，Prakash 的代码更容易理解。你可能应该这样做。

实际上，更好的写法可能是：

```
while(hour <= endHour || minute <= endMin) 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-02T18:13:31.850

处理这种情况时的第一条经验法则是将单位转换为标准单位。

将开始和结束（小时/分钟）都转换为分钟

```
start_min = starthour * 60 + startmin;
end_min = endhour * 60 + endmin; 

while (start_min < end_min) {
  start_min += 10; 
  int hour = start_min / 60;
  int min = star_min % 60;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-02T18:14:26.407

条件应该是

```
while(((houre == endHour) && minute <= endMin) || houre < endHour) 
```

# c++ - 对于 C++ 中的日期/时间库，是否有轻量级的 Boost 替代方案？

> ID：11783300
> 
> 赞同：3
> 
> 时间：2012-08-02T18:08:21.027
> 
> 标签：c++, parsing, datetime, date, boost

我正在寻找一个跨平台库来解析和输出正负 64 位时间戳的文本日期/时间。

有这样的图书馆吗？Boost 有大量开销，我宁愿不包括模板等。是否有更轻量级的替代方案可用？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-02T19:30:45.997

我能找到适合我需要的最好的可以在这里找到：

[http://www.2038bug.com/pivotal_gmtime_r.c.html](http://www.2038bug.com/pivotal_gmtime_r.c.html)

在消除 localtime 函数后，这在 VC++ 中构建并允许 64 位时间戳，包括正数和负数。我还没有测试日期超过 2038 年的 strftime，但现在这将解决我的问题。

# rvm - 无法在 Snow Leopard 上使用 rvm 编译 ruby 1.9.3

> ID：11783302
> 
> 赞同：2
> 
> 时间：2012-08-02T18:08:24.833
> 
> 标签：rvm

当我跑步时

```
rvm -install 1.9.3 
```

我得到一个错误。这是日志的最后几行。

```
compiling readline.c
readline.c: In function    sername_completion_proc_call
readline.c:1499: error:    sername_completion_function   undeclared (first use in this function)
readline.c:1499: error: (Each undeclared identifier is reported only once
readline.c:1499: error: for each function it appears in.)
make[2]: *** [readline.o] Error 1
make[1]: *** [ext/readline/all] Error 2
make: *** [build-ext] Error 2 
```

有什么建议么？我知道我已经安装了另一个版本的 ruby​​。这是造成它的原因吗，如果是这样，我该如何解决？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-02T19:16:05.400

这是 readline 的问题。显然很多人都有这个问题，解决办法就是自己编译readline。在这里找到答案：[安装 ruby​​ 1.9.3 时出错](https://stackoverflow.com/questions/7962550/error-installing-ruby-1-9-3)

# maven - Netbeans 中 mvn -U 的等价物

> ID：11783309
> 
> 赞同：3
> 
> 时间：2012-08-02T18:08:58.343
> 
> 标签：maven, netbeans

如何告诉 Netbeans 7 检查并获取最新的 SNAPSHOT 版本？看来我要么必须等待时间阈值通过，要么在命令行上进行强制检查；`mvn -U compile`

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-03T16:05:29.377

在 Netbeans 7.2 的*输出*窗格中，左侧有一个黄色图标，带有工具提示*Re-run with different parameters*。单击它将打开一个对话框。选择**更新快照**。

![Netbeans：使用不同的参数对话框重新运行](../Images/849296a2201618c65350de0b10f549fa.png)

# java - 找不到主类：Main，应用程序将退出

> ID：11783315
> 
> 赞同：2
> 
> 时间：2012-08-02T18:09:21.790
> 
> 标签：java

我有 Main.java，它看起来像这样：

```
public class Main {

    /**
     * @param args
     */
    public static void main(String[] args) throws UnsupportedEncodingException {
        // TODO Auto-generated method stub
        System.out.println("here!");
    }

} 
```

我编译它：

```
javac Main.java 
```

并尝试运行它

```
java Main 
```

它死于以下异常：

```
Exception in thread "main" java.lang.UnsupportedClassVersionError: Main : Unsupported major.minor version 51.0
        at java.lang.ClassLoader.defineClass1(Native Method)
        at java.lang.ClassLoader.defineClass(ClassLoader.java:634)
        at java.security.SecureClassLoader.defineClass(SecureClassLoader.java:142)
        at java.net.URLClassLoader.defineClass(URLClassLoader.java:277)
        at java.net.URLClassLoader.access$000(URLClassLoader.java:73)
        at java.net.URLClassLoader$1.run(URLClassLoader.java:212)
        at java.security.AccessController.doPrivileged(Native Method)
        at java.net.URLClassLoader.findClass(URLClassLoader.java:205)
        at java.lang.ClassLoader.loadClass(ClassLoader.java:321)
        at sun.misc.Launcher$AppClassLoader.loadClass(Launcher.java:294)
        at java.lang.ClassLoader.loadClass(ClassLoader.java:266)
Could not find the main class: Main. Program will exit. 
```

java -版本是：

```
java version "1.6.0_24"
OpenJDK Runtime Environment (IcedTea6 1.11.3) (6b24-1.11.3-1ubuntu0.12.04.1)
OpenJDK 64-Bit Server VM (build 20.0-b12, mixed mode) 
```

我在 Ubuntu 服务器上运行它。

我究竟做错了什么？

**更新**

`javac -version`是

```
javac 1.7.0_03 
```

`which java`

```
/usr/bin/java 
```

`which javac`

```
/usr/bin/javac 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-02T18:11:47.513

您正在尝试使用 Java 6*运行*，但看起来您正在使用 Java 7 进行*编译。*

跑

```
javac -version 
```

检查...并假设它显示Java 7，您需要找出两者不同的*原因。*

跑步

```
$ which java
$ which javac 
```

*可能会*有所帮助...这些信息肯定会帮助我们帮助您。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-02T18:11:00.073

```
java.lang.UnsupportedClassVersionError: Main : Unsupported major.minor version 51.0 
```

您在类路径中用于编译的 jdk 似乎与您在运行时中的 jdk 不同。确保在两个类路径中都有相同的 jdk 可用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-24T08:41:35.227

我在 Ubuntu 上遇到了完全相同的问题。我的问题是需要完全删除 openjdk-6-jre-lib 中的一些原始库。在突触管理器中删除该软件包以及与 openjdk 6 或 jre 版本 6 相关的任何内容。如果您使用的是 Ubuntu 12，则需要安装 synaptic，因为他们已将其删除。我不喜欢使用软件管理器。确保您安装了版本 7 的 open jdk。

openjdk-7-jre-lib

请记住，这是使用 Oracle 的 Java 7 安装的替代方法。开放意味着开源版本。

如果您在 Ubuntu 上安装 openjdk 7，则应自动设置类路径。我不必调整它。如果你确实想调整它，你可以在 ~/.bash_profile 中设置它。但请记住，您可以从命令行编译的区域有限（需要在您的 ~/ 层次结构下）。您需要使用“drew: source .bash_profile”重新加载。我在 /etc/environment 中调整了类路径，它弄乱了关于 ubuntu 12 上 openjdk 6 的突触包管理器。无论如何，当类路径发生更改时，我无法使用突触卸载 openjdk 6。

# android - 将图像从 URL 加载到图库

> ID：11783320
> 
> 赞同：1
> 
> 时间：2012-08-02T18:09:31.353
> 
> 标签：android

我正在尝试将图像从网站加载到画廊中。图像无法加载到图库中。第一个（主）图像确实加载。

```
 public class viewimages extends Activity {

private Gallery gallery;
private ImageView imgView;

private Integer[] Imgid = {
        R.drawable.a_1, R.drawable.a_2, R.drawable.a_3, R.drawable.a_4
};

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.viewimages);
    try {
    URL url = new URL("http://www.mysite.com/images/1000298/pics/1.jpg");

        Bitmap bmp = BitmapFactory.decodeStream(url.openConnection()
                            .getInputStream());
        imgView = (ImageView)findViewById(R.id.ImageView01);    
        imgView.setImageBitmap(bmp);
    } catch (IOException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    }

     gallery = (Gallery) findViewById(R.id.examplegallery);
     gallery.setAdapter(new AddImgAdp(this));

     gallery.setOnItemClickListener(new OnItemClickListener() {
        public void onItemClick(AdapterView parent, View v, int position, long id) {
            imgView.setImageResource(Imgid[position]); 
        }
    });

}

public class AddImgAdp extends BaseAdapter {
    int GalItemBg;
    private Context cont;

    public AddImgAdp(Context c) {
        cont = c;

        TypedArray typArray = obtainStyledAttributes(R.styleable.GalleryTheme);
        GalItemBg = typArray.getResourceId(R.styleable.GalleryTheme_android_galleryItemBackground, 0);
        typArray.recycle();
    }

    public int getCount() {
        return Imgid.length;
    }

    public Object getItem(int position) {
        return position;
    }

    public long getItemId(int position) {
        return position;
    }

    public View getView(int position, View convertView, ViewGroup parent) {
        ImageView imgView = new ImageView(cont);
        List<String> imageNames = new ArrayList<String>();
        imageNames.add("1.jpg");
        imageNames.add("2.jpg");
        //etc. until you've added all images

        for (int i = 0; i < imageNames.size(); i++){
            URL url;
            try {
                url = new URL("http://www.mysite.com/images/1000298/pics/" + imageNames.get(i));
                Bitmap bmp = BitmapFactory.decodeStream(url.openConnection()
                        .getInputStream());
                imgView.setImageBitmap(bmp);
                imgView.setLayoutParams(new Gallery.LayoutParams(80, 70));
                imgView.setScaleType(ImageView.ScaleType.FIT_XY);
                imgView.setBackgroundResource(GalItemBg);
            } catch (MalformedURLException e) {
                // TODO Auto-generated catch block
                e.printStackTrace();
            } catch (IOException e) {
                // TODO Auto-generated catch block
                e.printStackTrace();
            }

        }

        return imgView;
    }
}

    } 
```

问题似乎出在 AddImgAdp 类中的 getView() 中。我不确定这是否是尝试从网站加载图像的正确位置？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-02T18:48:43.307

今天已经有很多android图片加载库了，尝试使用它们让开发更简单。例如[https://github.com/gobozov/Android-Universal-Image-Loader](https://github.com/gobozov/Android-Universal-Image-Loader)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-02T18:42:07.973

您需要首先加载所有图像。基本上你正在做的是当适配器加载时，你然后循环，试图加载所有图像。创建一个异步任务来下载您的图像（我建议您将它们加载到另一个数组列表中，直到您对缓存等事情更加熟悉）。然后，当您设置适配器时，抓住位置以使用您正在寻找的图像。例如，

```
"imgView.setImageBitmap(imageArray.get(position))"; 
```

# java - 用于图的集团覆盖的 Java 库

> ID：11783322
> 
> 赞同：4
> 
> 时间：2012-08-02T18:09:40.100
> 
> 标签：java, graph-algorithm, clique, clique-problem

有谁知道解决集团覆盖问题的库或一些代码（最好是Java）？

我找到了一个 OCaml[版本](http://theinf1.informatik.uni-jena.de/ecc/README)，但我想使用一些我可以更容易集成的东西。

我还找到了 Java[代码](http://jgrapht.org/javadoc/org/jgrapht/alg/BronKerboschCliqueFinder.html)和 C 代码来查找图中的最大团，但我不知道如何利用此代码找到团覆盖（例如，迭代删除最大团，直到没有节点留下不会产生最佳解决方案）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-09-26T23:05:33.650

## 确定图中是否存在 3-clique 的 Java 程序：

**问题定义：**

[https://en.wikipedia.org/wiki/Clique_problem](https://en.wikipedia.org/wiki/Clique_problem)

**输入格式：**

被调用方法的输入`three_clique`是一个字符串编码，表示一个无向图，表示如下：

```
(1,2,3)((1,2);(2,3);(3,1)) 
```

这种编码表示具有三个节点的无向​​图：1,2,3。1 和 2、2 和 3 以及 3 和 1 之间有边。它看起来像一个三角形。显然，这个无向图包含一个 3 集团。

这种无向图的编码不包含 3-clique：

```
(1,2,3)((1,2);(3,4)) 
```

**编码：**

```
import java.util.AbstractMap.SimpleEntry;
import java.util.Map;
import java.util.AbstractMap;
import java.util.ArrayList;

public class Main{
    public static boolean three_clique(String encoding){
        if (encoding.length() == 0){
            return false;
        }
        String[] elements = encoding.substring(1, encoding.indexOf(")")).split(",");
        encoding = encoding.substring(encoding.indexOf(")")+2); 
        encoding = encoding.substring(0, encoding.length()-1);
        ArrayList<Map.Entry<Integer, Integer>> arr = new ArrayList<Map.Entry<Integer, Integer>>();
        String[] pairs = encoding.split(";");
        if (pairs.length == 1){
            return false;
        } 
        for(int x = 0; x < pairs.length; x++){
            String str = pairs[x].substring(1, pairs[x].length()-1);
            String[] items = str.split(",");
            int left = Integer.parseInt(items[0]);
            int right = Integer.parseInt(items[1]);
            arr.add(new AbstractMap.SimpleEntry(left, right));
        }
        for(int x = 0; x < elements.length; x++){
            for(int y = 0; y < elements.length; y++){
                for(int z = 0; z < elements.length; z++){
                    if (x != y && y != z && z != x){
                        int one = Integer.parseInt(elements[x]);
                        int two = Integer.parseInt(elements[y]);
                        int three = Integer.parseInt(elements[z]);
                        if (is_connected(arr, one, two) &&
                            is_connected(arr, two, three) &&
                            is_connected(arr, three, one)){
                                return true;
                        }
                    }
                }
            }
        }
        return false;
    }
    public static boolean is_connected(ArrayList<Map.Entry<Integer, Integer>> arr, int left, int right){
        for(int x = 0; x < arr.size(); x++){
            if (left == arr.get(x).getKey() && arr.get(x).getValue() == right){
                return true;
            }
            if (right == arr.get(x).getKey() && arr.get(x).getValue() == left){
                return true;
            }
        }
        return false;
    }
    public static void main(String[] args){
        tests();
    }

    public static void tests(){
        String encoding = "";
        boolean expected;
        String msg = "";

        encoding = "";
        expected = false;
        msg = "expected '" + encoding + "' encoding to be false";
        doTest(encoding, expected, msg);

        encoding = "(1)()";
        expected = false;
        msg = "expected '" + encoding + "' encoding to be " + expected;
        doTest(encoding, expected, msg);

        encoding = "(1,2)((1,2))";
        expected = false;
        msg = "expected '" + encoding + "' encoding to be " + expected;
        doTest(encoding, expected, msg);

        encoding = "(1,2,3)((1,2);(2,3);(3,1))";
        expected = true;
        msg = "expected '" + encoding + "' encoding to be " + expected;
        doTest(encoding, expected, msg);

        encoding = "(1,2,3)((1,2);(3,4))";
        expected = false;
        msg = "expected '" + encoding + "' encoding to be " + expected;
        doTest(encoding, expected, msg);

        encoding = "(1,2,3,4)((1,2);(2,3);(3,1);(1,4))";
        expected = true;
        msg = "expected '" + encoding + "' encoding to be " + expected;
        doTest(encoding, expected, msg);

        encoding = "(1,2,3)((1,2);(2,3);(1,3))";
        expected = true;
        msg = "expected '" + encoding + "' encoding to be " + expected;
        doTest(encoding, expected, msg);
    }
    public static void doTest(String encoding, boolean expected, String msg){
        boolean result = three_clique(encoding);
        if (result == expected){
            System.out.print(".");
        }
        else{
            System.out.println("\n" + msg);
        }
    }
} 
```

**输出**

程序在屏幕上输出一系列七个点，这意味着所有单元测试都通过了。为了证明它有效，请为像这样的大型无向图添加更多单元测试用例：`(1,2,3,4,5)((1,5);(1,4);(1,3);(1,2);(1,1);)`并查看它是否返回 false。

**运行时复杂度：**

具体而言，计算复杂度是[多项式](https://en.wikipedia.org/wiki/Time_complexity#Polynomial_time)`O(n^3)`的。所以它的效率非常低，而且肯定不是这个问题的最佳算法。但它展示了如何处理和解决 Java 中的集团问题的起点。

# c++ - 将以科学计数法表示的字符串转换为浮点数和双精度数

> ID：11783327
> 
> 赞同：1
> 
> 时间：2012-08-02T18:10:19.373
> 
> 标签：c++, data-conversion

所以我正在做这个项目，我必须读取一个 CSV 文件，其中包含以科学记数法表示的数字。到目前为止，我所要做的是读取每个数字，然后将该数字转换为字符串，然后使用 stringstream 将其转换为双精度，但我不确定这是否是正确的方法。任何建议/建议都会有所帮助！

```
double temp;
istringstream in(line); //line is the string which contains the number, ex: 3.30144800e+03
in >> temp;
arr[w++] = temp; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-02T18:46:46.343

您可以将字符串转换为双精度`std::atof`

```
istringstream in(line);
double        value(atof(in.str().c_str())); 
```

或者您可以简单地将双倍从缓冲区中流出......

```
double value;
in >> value; 
```

# jquery - IE 8 在文本滑入动画上显示以前的背景

> ID：11783328
> 
> 赞同：0
> 
> 时间：2012-08-02T18:10:20.137
> 
> 标签：jquery, html, css, internet-explorer

我有一个真正烦人的问题，我似乎找不到它。仅在IE8中，我的jquery滑入文本动画背景显示上一张幻灯片的主背景，但仅在滑入时（当文本动画暂停时，上一张背景消失在动画文本的空间中）

要了解我在说什么，请访问： http: [//lamininbeauty.co.za/index2.html](http://lamininbeauty.co.za/index2.html)。但奇怪的是，如果你有IE 9，并且你使用IE8浏览器和文档模式，你就看不到效果（我没有）。我实际上是在一个实际的 IE8 浏览器上捡到它的......

知道文本滑入时导致丑陋背景效果的原因是什么吗？

谢谢你

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-02T20:21:44.097

我终于找到了问题所在。背景图像的包含 div 设置为 1024px 的固定宽度。我将其更改为 100%，给它另一个父 div，然后我将其设为宽度：1024px。由于某种原因修复了它...

# ios - 奇怪的“Retina”iOS 模拟器行为

> ID：11783336
> 
> 赞同：8
> 
> 时间：2012-08-02T18:10:55.613
> 
> 标签：ios, ios-simulator, osx-mountain-lion

上周我将 Lion 更新为 Mountain Lion，从那时起，iOS 模拟器上出现了这个非常奇怪的错误。第一张图片显示的是常规模拟器，第二张显示的是“Retina”模拟器。有谁知道如何解决这一问题？我尝试删除 Xcode 并重新安装，但没有运气。

普通模拟器：

![普通模拟器](../Images/cdaf9f8b35ac9a7afa4799330f289518.png)

视网膜模拟器：

![视网膜模拟器](../Images/eeadedff1965cdccc139279c1ddf6b49.png)

提前感谢您的帮助！

编辑：这不是 iPad 模拟器。这是“设备”菜单的屏幕截图。

![设备选项卡](../Images/5109294b54cc7353e0a9209130bf1099.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-31T01:33:18.663

我遇到了同样的问题，尝试更改您的mac上的显示分辨率。我使用的是 Retina Mac，所以不得不玩一下。

Xcode 确实为您提供了一个不同的视网膜模拟器，但看起来它们内置了逻辑以在一个模拟器中具有更高的分辨率。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-04T07:02:10.523

这里最重要的症状是，如果它显示在标准分辨率的 iPhone 上，您的 UI 占用的空间量正是您所期望的。另一个重要的症状是你的 UILabel 看起来褪色的方式 - 这通常表明 UILabel 没有收到正确的屏幕比例，特别是在光栅化时。

当您在应用程序委托 (didFinishLaunchingWithOptions) 中初始化应用程序时，请检查您是否已将 UIWindow 或 rootViewController 的边界硬编码为标准 iphone 分辨率（即 320x480）。这些应该使用 [[UIScreen mainScreen] bounds] 设置，而不是硬编码到实际点。实际上，您应该在您的应用程序中寻找您对屏幕尺寸进行硬编码的任何地方——搜索字符串“320”和“480”——这些数字永远不应出现在您的代码中。

另一种可能性是您已将某些视图设置为光栅化（layer.shouldRasterize = YES），但您尚未将 layer.rasterizationScale 设置为主屏幕的比例（即 [[UIScreen mainScreen] scale]，这将是2.0 在 Retina 上下文中）。当我没有正确设置比例时，我看到了同样的泥泞的 UILabel。

我认识到，由于您的帖子说此更改仅在您的操作系统更新后才发生，因此这些可能不是问题，但为了更加确定，我会检查它们。

**更新**：再三考虑，硬编码这些边界，这是不好的做法，不会导致这个问题，因为这些是 iPhone 的正确逻辑边界，并且操作系统可以为你扩展。因此，在这两个建议之间，更可能的罪魁祸首是某些与比例相关的属性设置不正确。另一种可能性是，如果您使用 UIView contentScaleFactor 并且设置不正确。

* * *

## 回答 #3

> 赞同：-3
> 
> 时间：2012-08-02T18:12:30.820

这是 iPad 模拟器。将其更改为 iPhone。

> 硬件->设备

# javascript - 如何防止 Uniform.js 对选择元素进行排序

> ID：11783340
> 
> 赞同：0
> 
> 时间：2012-08-02T18:11:04.087
> 
> 标签：javascript, html, uniform

我正在使用 Uniform.js 来设置一些选择的样式。它们看起来很棒，但是在设置 Uniform 样式时，它会根据每个选项的 value 属性对列表进行排序，这是不希望的。我该如何防止这种情况？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-06T03:26:44.270

问题不在于 Uniform.js，而在于我正在使用的应用程序的另一部分。

[链接到 GitHub 问题，了解更多信息](https://github.com/pixelmatrix/uniform/issues/232)

# java - stringTokenizer 方法错误

> ID：11783341
> 
> 赞同：0
> 
> 时间：2012-08-02T18:11:06.517
> 
> 标签：java, nullpointerexception, stringtokenizer

我正在尝试使用 stringTokenizer 方法读取存储在格式文件中的二维数组..

```
1 1
1 1 
```

代码是...

```
BufferedReader in = new BufferedReader(new InputStreamReader(System.in));
for(int i=0;i<n;i++)
                for(int j=0;j<n;j++){
                    StringTokenizer tok = new StringTokenizer(in.readLine());
                    t[i][j]=Integer.parseInt(tok.nextToken());
                } 
```

当我运行它时，我得到了 java.lang.NullPointerException 错误。但是，如果我在文件中使用它

```
1 1 1 1 
```

代码有效！
为什么会这样？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-02T18:27:02.983

通过在嵌套循环中进行`StringTokenizer`对象声明/实例化，对象不存在于嵌套循环范围之外。所以这实际上只是重复嵌套循环，所以你阅读的所有内容都是水平的。如果您移动嵌套循环的外部和父循环的内部，它仍将在嵌套循环的范围内。那应该可以解决您的问题。`for``StringTokenizer``StringTokenizer`

移动： `StringTokenizer tok = new StringTokenizer(in.readLine());`在您的嵌套循环上方。

# sql - 并排显示两个表中的记录，仅匹配某些字段

> ID：11783343
> 
> 赞同：5
> 
> 时间：2012-08-02T18:11:15.330
> 
> 标签：sql, oracle

我有两张桌子，`table A`：

```
Customer_ID  Product  Date Of Sale  Pay Meth 1  Pay Meth 2  QTY
-----------  -------  ------------  ----------  ----------  ---
        123  AB       1/1/2012             111         222    1
        123  AB       1/1/2012             111         222    1
        456  AC       2/1/2012             333         444    1 
```

和`table B`：

```
Customer_ID  Product  Date Of Sale  Pay Meth 1  Pay Meth 2  QTY
-----------  -------  ------------  ----------  ----------  ---
        123  AB       1/1/2012             111         222    2
        456  AB       1/1/2012             124         111    1 
```

我想匹配数据，以便客户的记录`123`分组`table A`为：

```
Customer_ID  Product  Date Of Sale  Pay Meth 1  Pay Meth 2  QTY
-----------  -------  ------------  ----------  ----------  ---
        123  AB       1/1/2012             111         222    2 
```

在它的右边出现以下记录`table B`：

```
Customer_ID  Product  Date Of Sale  Pay Meth 1  Pay Meth 2  QTY
-----------  -------  ------------  ----------  ----------  ---
        123  AB       1/1/2012             111         222    2 
```

另外（总是有一个also）我们想在该记录`table A`的右侧显示第三条记录`table B`（客户`456`）中的第二条记录，因为它们有相同的`Customer_ID`，`Product`并且`Date of Sale`

所以它应该看起来像

```
Customer_ID  Product  Date Of Sale  Pay Meth 1  Pay Meth 2  QTY  Customer_ID  Product  Date Of Sale  Pay Meth 1  Pay Meth 2  QTY
-----------  -------  ------------  ----------  ----------  ---  -----------  -------  ------------  ----------  ----------  ---
        123  AB       1/1/2012             111         222    1          123  AB       1/1/2012             111         222    1
        456  AC       2/1/2012             333         444    1          456  AB       1/1/2012             124         111    1 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-02T18:51:52.180

您可以对每个表进行子查询以获取每个客户的总和数量，然后通过客户 ID 加入结果，例如

```
SELECT a.*, b.*
FROM (
    Select customer_id, product, dateofsale, PayMeth1, PayMeth2, SUM(Qty) as Qty
    from TableA
    Group by customer_id, product, dateofsale, PayMeth1, PayMeth2
) a
JOIN (
    Select customer_id, product, dateofsale, PayMeth1, PayMeth2, SUM(Qty) as Qty
    from TableB
    Group by customer_id, product, dateofsale, PayMeth1, PayMeth2
) b 
ON a.customer_id = b.customer_id 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-02T18:33:23.830

您正在寻找的是 SQL JOIN 命令： [http ://www.tizag.com/sqlTutorial/sqljoin.php](http://www.tizag.com/sqlTutorial/sqljoin.php)

您只想为要匹配的列加入这两个表的行。因此，如果您尝试根据 customer_id 匹配两个表中的记录，那么您的 SQL 代码将如下所示：

```
SELECT *
FROM A
JOIN B
ON A.Customer_ID = B.Customer_ID 
```

不过，当您说这两条记录具有相同的 ID、产品和销售日期时，不确定您的意思是什么——它们似乎只有一个共同的 ID (456)。

# php - Where子句中的MySQL DateDiff？

> ID：11783347
> 
> 赞同：3
> 
> 时间：2012-08-02T18:11:20.833
> 
> 标签：php, mysql, yii

我们正在使用 Yii 框架并创建了一个搜索表单以包含以下 DatePicker 组件：

```
<?php echo $form->labelEx($model, 'availability_start_date');?>
        <?php 
        Yii::import('zii.widgets.jui.CJuiDatePicker');
        $this->widget('zii.widgets.jui.CJuiDatePicker', array(
            'name'=>'stattDate',
            'options'=>array(
                'showAnim'=>'fold',
            ),
            'htmlOptions'=>array(
                'style'=>'height:20px;'
            )
        ));
        ?> 
```

需要使用此小部件来搜索与上述小部件中指定的值相差 +/- 2 天的availability_start_date 的用户。

我们的 UserController 有以下连接逻辑：

```
if ($search_frm['availability_start_date']){
                    $join .= ' LEFT JOIN user_availability_start_date usd on u.id = usd.id';
                    $where .= 'AND usd.availability_start_date >= '.$search_frm
                ['availability_start_date'];
                } 
```

目前，WHERE 子句中的逻辑只要求匹配可用性开始日期大于或等于小部件的值。

如何修改上述 WHERE 子句以选择小部件值与 availability_start_date 值相差 +/- 2 天的那些记录？

更新：我已将 where 子句修改为如下：

```
if ($search_frm['availability_start_date']){
                    $join .= ' LEFT JOIN user_availability_start_date usd on u.id = usd.id';
                    $where .= ' AND usd.availability_start_date >= DATE_ADD('.$search_frm.', 
                INTERVAL -2 DAY)
                    AND usd.availability_start_date <= DATE_ADD(' .$search_frm.', INTERVAL 2 DAY)';
                } 
```

不幸的是，当我测试逻辑时，返回的记录不符合此条件。在表单或页面上不会引发错误。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-02T18:16:48.403

[`DATEDIFF()`](http://dev.mysql.com/doc/refman/5.1/en/date-and-time-functions.html#function_datediff)返回以天为单位的值。`ABS()`对于 +/- 2 天，您将需要使用 的返回的绝对值`DATEDIFF()`，验证它是否为`<= 2`。

```
$where .= "AND ABS(DATEDIFF(DATE(usd.availability_start_date), DATE('" . $search_frm['availability_start_date'] . "'))) <= 2"; 
```

我还将参数包装到`DATEDIFF()`in`DATE()`以截断时间部分（如果存在）。如果您的应用程序不需要它们，请删除它们。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-02T18:16:59.150

`BETWEEN`会为你完成的。

```
"AND usd.availability_start_date 
    BETWEEN DATE_ADD('".
        $search_frm['availability_start_date'] ."', INTERVAL - 2 DAY)
    AND DATE_ADD('".
        $search_frm['availability_start_date'] ."', INTERVAL 2 DAY)"; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-02T18:15:22.117

```
AND usd.availability_start_date >= DATE_ADD('.$search_frm .', INTERVAL -2 DAY)
AND usd.availability_start_date <= DATE_ADD('.$search_frm .', INTERVAL 2 DAY) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-02T18:19:50.083

试试这个：

```
if ($search_frm['availability_start_date']) {
    $join .= ' LEFT JOIN user_availability_start_date usd on u.id = usd.id';
    $where .= sprintf(
        'AND %s BETWEEN (usd.availability_start_date - INTERVAL 2 DAY) '
        . ' AND (usd.availability_start_date + INTERVAL 2 DAY)',
        $search_frm['availability_start_date']
    );
} 
```

# java - 将静态类指针存储在 Java 中的映射中

> ID：11783350
> 
> 赞同：0
> 
> 时间：2012-08-02T18:11:32.793
> 
> 标签：java

我有一个用户是某个职业的情况，所以我有类似的情况：

```
public abstract class Job
{
    private static String name;
    public static String getJobName() { return name; }
} 
```

和

```
public class Baker extends Job
{
    // I realize this is probably wrong, but not the main point
    Baker() { name = "Baker"; }
} 
```

然后我想将 User->Profession 存储在像这样的地图中

```
Map<User, Class<? extends Job>> uJobs = HashMap<User, Class<? extends Job>>();
uJobs.put(user, Baker.class); // This seems to work
String jobName = uJobs.get(user).getJobName(); // This not so much, and the IDE (eclipse) just somes 'class' specific stuff, not Job specific stuff. 
```

任何建议表示赞赏。这里的核心目标是将 1 个对象映射到一个类，我可以从中调用静态方法，而不需要每个对象的实例。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-02T18:22:43.807

不要将类对象放入哈希映射中，只需放入该类的一个实例即可。

```
Map<User,Job> uJobs=new HashMap<User, Job>();
uJobs.put(user, new Baker());
String jobname=uJobs.get(user).getJobName(); 
```

更好的是，您可能不需要在每次添加用户时都创建 Baker 的新实例。制作一个静态或单例。

```
class Baker extends Job
{
  public static Job instance=new Baker();
  public String getJobName()
  {
    return "Baker";
  }
}
...
uJobs.put(user, Baker.instance); 
```

如果区分工作的唯一因素是数据，则无需子类化。你可以改为说

```
class Job
{
  public static Job BAKER=new Job("baker", 7);
  public static Job BUTCHER=new Job("butcher", 12);
  public static Job CANDLESTICK_MAKER=new Job("candlestick maker", 27);

  private String name;
  private int whateverCode;

  pubilc Job(String name, int whateverCode)
  {
    this.name=name;
    this.whateverCode=whateverCode;
  }
  public String getJobName()
  {
    return name;
  }
  public int getWhateverCode()
  {
    return whateverCode;
  }
}
...
uJob.put(user, Job.BAKER); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-02T18:23:12.667

如果一组作业是预定义的（这似乎是因为您想为每个作业创建一个类），Java 方法是将作业放在一个枚举中 - 因此您的应用程序中只有一个 BAKER 对象，没有诉诸单例模式，[在您的情况下这显然是一个糟糕的设计](https://stackoverflow.com/questions/137975/what-is-so-bad-about-singletons)：

```
public enum Job {
    BAKER("Baker"),
    TEACHER("Teacher");

    private final String name;
    private Job(String name) {this.name = name;}

    public String getName() {return name;}
} 
```

然后你可以使用地图：

```
Map<User, Job> uJobs = new HashMap<User, Job>();
uJobs.put(user, Job.BAKER); // This seems to work
String jobName = uJobs.get(user).getName(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-02T18:16:20.697

您可以使用[单例模式](http://en.wikipedia.org/wiki/Singleton_pattern)

另一点，当您调用 时`uJobs.get(user).getJobName()`，您的变量`name`不等于“Baker”，因为已调用任何 Baker 实例。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-02T18:22:31.407

听起来你想实现一个单例。在这种情况下，我不建议使用静态变量。您想要的是所有对象的单例缓存。

```
public class JobCache {
  private Map<User, ? extends Job> internalCache;

  private static final JobCache instance;

  private JobCache() {}

  public static JobCache getInstance() {
      if (instance == null)
        instance = new JobCache();
      return instance;
  }

  public void putJob(User u, Job j) {
      internalCache.put(u, j);
  }

  public Job getJob(User u) {
      return internalCache.get(u);
  }
} 
```

[现在单身人士不受欢迎。](https://stackoverflow.com/questions/137975/what-is-so-bad-about-singletons)这是因为测试它们更难，因为你不能创建它们的实例并传递它们。但这是一个高级话题。现在，单例应该可以解决您的问题。

# php - 使用 jQuery + PHP 上传 DnD 图像

> ID：11783360
> 
> 赞同：1
> 
> 时间：2012-08-02T18:12:45.437
> 
> 标签：php, jquery, fileapi, data-uri

我正在尝试为图像设置拖放上传系统，但我不知道如何使用 PHP 将数据写入文件。

目前，我正在使用`FileReader.readAsDataURL()`检索上传图像的数据 URI，并将其存储在`var data`.

```
var base64_start = data.indexOf(',') + 1;
$.ajax({
    type : 'POST',
    url : 'save_image.php',
    ...
    data : data.substring(base64_start)
}); 
```

内部`save_image.php`：

```
foreach($_POST as $key => $val) {
    $file = $key; 
    break;  
}

$binary = base64_decode($file);
$fh = fopen('images/test.png', 'w');
fwrite($fh, $binary); 
```

我尝试下载`test.png`，它说图像已损坏。

我也尝试过使用`imagecreatefromstring()`：

```
$binary = base64_decode($file);
$img = imagecreatefromstring($binary); 
```

# php - 在一个 Dotcloud PHP 服务上配置多个主机

> ID：11783364
> 
> 赞同：2
> 
> 时间：2012-08-02T18:13:07.107
> 
> 标签：php, nginx, dotcloud

我正在 DotCloud 上创建一个应用程序，我想在其中使用相同的 PHP 服务托管多个网站。我已经有一个站点启动并运行，该站点的“approot”设置为我的 dotcloud.yml 文件中代码库的子文件夹。

我猜我需要从 dotcloud.yml 文件中删除我的 approot 定义，然后将每个子文件夹站点的 nginx.conf 设置包装在“服务器”声明中，其中 server_name 设置为我的别名域，root 设置为子文件夹对于那个域。不幸的是，因为我无法向“沙盒”应用程序添加别名，所以我无法在不创建另一个“实时”应用程序的情况下测试这样的配置。

如何将我的 dotcloud.yml 文件和 nginx.conf 文件配置为在一个子文件夹（我当前的 approot）上有一个别名点，并在同一个 PHP 服务上有另一个别名指向不同的子文件夹（一个完全不同的站点和域） ?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-02T21:29:01.283

不确定这是否正是您要寻找的东西。您可以拥有一个 dotCloud.yml，其中包含多个服务，每个服务都指向不同的 approot。

`dotcloud.yml`

```
php1:
   type: php
   approot: site_1
php2:
   type: php
   approot: site_2
db:
   type: mysql 
```

然后您可以使用命令行为每个服务分配不同的别名。

```
$ dotcloud alias add app.php1 www.example1.com

$ dotcloud alias add app.php2 www.example2.com 
```

**另外的选择：**

如果您将代码编写为多原则，那么您可以查看请求标头中的主机，并从相同的代码库为不同的网站提供服务。Django 在 python 端做到了这一点。不知道 php 是否有类似的东西。

# hadoop - hadoop 多个已经被创建的异常

> ID：11783365
> 
> 赞同：6
> 
> 时间：2012-08-02T18:13:18.997
> 
> 标签：hadoop, mapreduce

当我在小数据上运行代码时，我没有收到以下错误。但是当我在更大的数据集上运行相同的代码时，在使用多个输出时出现以下错误。请帮忙！

```
org.apache.hadoop.ipc.RemoteException: 
org.apache.hadoop.hdfs.protocol.AlreadyBeingCreatedException: failed to create file
/home/users/mlakshm/alop176/data-r-00001 for
DFSClient_attempt_201208010142_0043_r_000001_1 on client 10.0.1.100, because this file
is already being created by DFSClient_attempt_201208010142_0043_r_000001_0 on     10.0.1.130 at 
org.apache.hadoop.hdfs.server.namenode.FSNamesystem.recoverLeaseInternal(FSNamesystem.java:1406)
    at org.apache.hadoop.hdfs.server.namenode.FSNamesystem.startFileInternal(FSNamesystem.java:1246)
    at org.apache.hadoop.hdfs.server.namenode.FSNamesystem.startFile(FSNamesystem.java:1188)
    at org.apache.hadoop.hdfs.server.namenode.NameNode.create(NameNode.java:628)
    at sun.reflect.GeneratedMethodAccessor12.invoke(Unknown Source)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
    at java.lang.reflect.Method.invoke(Method.java:616)
    at org.apache.hadoop.ipc.RPC$Server.call(RPC.java:563)
    at org.apache.hadoop.ipc.Server$Handler$1.run(Server.java:1388)
    at org.apache.hadoop.ipc.Server$Handler$1.run(Server.java:1384)
    at java.security.AccessController.doPrivileged(Native Method)
    at javax.security.auth.Subject.doAs(Subject.java:416)
    at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1121)
    at org.apache.hadoop.ipc.Server$Handler.run(Server.java:1382)

    at org.apache.hadoop.ipc.Client.call(Client.java:1070)
    at org.apache.hadoop.ipc.RPC$Invoker.invoke(RPC.java:225)
    at $Proxy2.create(Unknown Source)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
    at java.lang.reflect.Method.invoke(Method.java:616)
    at org.apache.hadoop.io.retry.RetryInvocationHandler.invokeMethod(RetryInvocationHandler.java:82)
    at org.apache.hadoop.io.retry.RetryInvocationHandler.invoke(RetryInvocationHandler.java:59)
    at $Proxy2.create(Unknown Source)
    at org.apache.hadoop.hdfs.DFSClient$DFSOutputStream.<init>(DFSClient.java:3248)
    at org.apache.hadoop.hdfs.DFSClient.create(DFSClient.java:713)
    at org.apache.hadoop.hdfs.DistributedFileSystem.create(DistributedFileSystem.java:182)
    at org.apache.hadoop.fs.FileSystem.create(FileSystem.java:555)
    at org.apache.hadoop.fs.FileSystem.create(FileSystem.java:455)
    at org.apache.hadoop.mapred.TextOutputFormat.getRecordWriter(TextOutputFormat.java:118)
    at com.a.MultipleOutputs$InternalFileOutputFormat.getRecordWriter(MultipleOutputs.java:565)
    at com.a.MultipleOutputs.getRecordWriter(MultipleOutputs.java:432)
    at com.a.MultipleOutputs.getCollector(MultipleOutputs.java:518)
    at com.a.MultipleOutputs.getCollector(MultipleOutputs.java:482)
    at com.a.ReduceThree1.reduce(ReduceThree1.java:56)
    at com.a.ReduceThree1.reduce(ReduceThree1.java:1)
    at org.apache.hadoop.mapred.ReduceTask.runOldReducer(ReduceTask.java:519)
    at org.apache.hadoop.mapred.ReduceTask.run(ReduceTask.java:420)
    at org.apache.hadoop.mapred.Child$4.run(Child.java:255)
    at java.security.AccessController.doPrivileged(Native Method)
    at javax.security.auth.Subject.doAs(Subject.java:416)
    at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1121) 
```

在 org.apache.hadoop.mapred.Child.main(Child.java:249)

* * *

reduce类如下：

```
public class ReduceThree1 extends MapReduceBase implements Reducer<Text, Text, Text, Text>{
        //  @SuppressWarnings("unchecked")
        private MultipleOutputs mos;

         public void configure(JobConf conf1) {

         mos = new MultipleOutputs(conf1);

         }

            public void reduce (Text key, Iterator<Text> values, OutputCollector<Text, Text> output, Reporter reporter) throws IOException {

                // MultipleOutputs mos;
                 int sum = 0;
                 ArrayList<CustomMapI> alcmap = new ArrayList<CustomMapI>();
                while(values.hasNext())
                {

                    String val = values.next().toString();
                    StringTokenizer st = new StringTokenizer(val);
                    String uid = st.nextToken();
                    String f_val = st.nextToken();
                    CustomMapI cmap = new CustomMapI(uid, f_val);
                    alcmap.add(cmap);
                    sum += Integer.parseInt(f_val);

                }

                StringTokenizer st = new StringTokenizer(key.toString());
                String t = st.nextToken();
                String data = st.nextToken();

                for(int i = 0; i<alcmap.size(); i++)
                {

                    String str_key = t+" "+alcmap.get(i).getUid();
                    String str_val = data+" "+alcmap.get(i).getF_val()+" "+sum;

                 //   output.collect(new Text(str_key), new Text(str_val));
                   mos.getCollector("/home/users/mlakshm/alop176/data", reporter).collect(new Text(str_key), new Text(str_val));

                   for(int j = 1; j<alcmap.size(); j++)
                   {
                       if((j>i)&&(!alcmap.get(i).equals(alcmap.get(j))))
                       {
                           String mul_key = "null";

                           String uidi = alcmap.get(i).getUid();
                           String uidj = alcmap.get(j).getUid();

                          ArrayList<String> alsort = new  ArrayList<String>();
                          alsort.add(uidi);
                          alsort.add(uidj);
                          Collections.sort(alsort);
                          int fi = Integer.parseInt(alcmap.get(i).getF_val());

                          int fj = Integer.parseInt(alcmap.get(j).getF_val());
                          String intersection = "null";
                          if(fi<fj)
                          {
                             intersection = String.valueOf(fi);
                          }
                          else
                          {
                              intersection = String.valueOf(fj);
                          }

                          String mul_val = t+" "+alsort.get(0)+" "+alsort.get(1)+" "+intersection;
                        //   System.out.println(mul_key+ " "+mul_val);

                           mos.getCollector("/home/users/mlakshm/alop177/datepairs", reporter).collect(new Text(mul_key), new Text(mul_val));
                       }
                   }

                }

             }

            public void close() throws IOException {
                 mos.close();

                 }
} 
```

Job Conf 如下：

配置 config1 = 新配置（）；

```
 JobConf conf1 = new JobConf(config1, DJob.class);

          conf1.setJobName("DJob1");
          conf1.setOutputKeyClass(Text.class);
          conf1.setOutputValueClass(Text.class);
         // conf.setMapOutputValueClass(Text.class);
        //  conf.setMapOutputKeyClass(Text.class);
         // conf.setNumMapTasks(20);
          conf.setNumReduceTasks(10);
          conf1.setMapperClass(MapThree1.class);
         // conf.setCombinerClass(Combiner.class);
          conf1.setReducerClass(ReduceThree1.class);
          conf1.setPartitionerClass(CustomPartitioner.class);

          conf1.setInputFormat(TextInputFormat.class);
          conf1.setOutputFormat(TextOutputFormat.class);
       //   mos = new MultipleOutputs(conf1);
          MultipleOutputs.addNamedOutput(conf1, "/home/users/mlakshm/alop176/data", TextOutputFormat.class, LongWritable.class, Text.class);
          MultipleOutputs.addNamedOutput(conf1, "/home/users/mlakshm/alop177/datepairs", TextOutputFormat.class, LongWritable.class, Text.class);

          FileInputFormat.setInputPaths(conf1, new Path(other_args.get(2)));
          FileOutputFormat.setOutputPath(conf1, new Path(other_args.get(3)));

         JobClient.runJob(conf1); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-03T10:39:39.103

您很可能已经开启了推测执行，并且 reduce 任务 1 的两种不同尝试正在尝试写入 path `/home/users/mlakshm/alop176/data-r-00001`。对于较小的任务，这可能会成功，因为它们在 hadoop 推测性地执行第二次尝试之前完成。

我看到您的 MultipleOutputs 实现是自定义的（`com.a.MultipleOutputs`），您应该将所有 HDFS 数据写入任务工作目录，并让 OutputComitter 在输出提交时将其移动到最终输出目录。如果可以的话，粘贴代码，我们可以看看。

# android - 每种架构都有不同的 make 文件 - Android NDK

> ID：11783366
> 
> 赞同：3
> 
> 时间：2012-08-02T18:13:18.763
> 
> 标签：android, makefile, android-ndk, multiple-makefiles

我的目标是使用 NDK 编译的 c/c++ 代码超过 1 个架构，问题是我需要对我的 make 文件有一个清晰的组织，我还必须根据架构 NDK 不同地设置相同的环境变量是编译时的目标。

我怎样才能为每个架构使用不同的 makefile？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-04T06:09:43.790

你不需要不同的makefile。

在 Application.mk 中使用：

APP_ABI := 全部

然后例如使用

如果 eq($(TARGET_ARCH_ABI), armeabi)

`<<insert your definitions here>>`

万一

# jquery - Jquery 表单提交错误

> ID：11783368
> 
> 赞同：0
> 
> 时间：2012-08-02T18:13:30.037
> 
> 标签：jquery, forms, form-submit

我是 jquery 的新手，并且正在写一本书，但似乎无法让它发挥作用。我已经在 php 中创建了这个计算脚本，但是如果用户启用了 javascript，我宁愿使用它。这是直接来自我使用的书的代码

```
$(document).ready(function() {

$('.errorMessage').hide();

$('#area').submit(function() {
    var quan, price, tax, total;
    if ($('#quan').val() > 0) {
        quan = ('#quan').val();
        $('#quan1').removeClass('error');
        $('#quanerror').hide();
    } else {
        $('#quan1').addClass('error');
        $('#quanerror').show()
    }
    if ($('#price').val() > 0) {
        price = ('#price').val();
        $('#price1').removeClass('error');
        $('#priceerror').hide();
    } else {
        $('#price1').addClass('error');
        $('#priceerror').show()
    }
    if ($('#tax').val() > 0) {
        tax = ('#tax').val();
        $('#tax1').removeClass('error');
        $('#taxerror').hide();
    } else {
        $('#tax1').addClass('error');
        $('#taxerror').show()
    }
    if (quan && price && tax) {
        total = quan * price;
        total += total * (tax/100);

        $('#results').html('The total is <b>$' + total + '</b>');
    }
    return false;
    }); // end submit
    }); // end function 
```

错误工作得很好，但它不会打印出结果，而是会转到 math.php 脚本。书上说return false；会阻止这种情况，但它不起作用，当我输入文本时让我们说 quan 但不是输入 price 和 tax，会出现 price 和 tax 的错误，但在 quan 中输入的文本不会留下。任何帮助将不胜感激，对我来说很容易，这是我第一次使用 jquery。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-02T18:18:02.993

尝试 ..

```
 $('#area').submit(function(e) {
      e.preventDefault();
      // your code here
  }); 
```

# javascript - 如何使用 RaphaelJS 的 pathIntersection() 方法实现路径减法？

> ID：11783373
> 
> 赞同：2
> 
> 时间：2012-08-02T18:14:04.973
> 
> 标签：javascript, raphael

该方法的文档在这里：[http ://raphaeljs.com/reference.html#Raphael.pathIntersection](http://raphaeljs.com/reference.html#Raphael.pathIntersection)

假设我想做的是从另一条路径中减去一条路径。似乎 pathIntersection() 的返回对象包含我需要执行此操作的所有信息。这是真的？如果是这样，基本方法是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-03T10:44:02.550

如何对两条路径使用[parsePathString](http://raphaeljs.com/reference.html#Raphael.parsePathString)方法，比较它们并从不匹配的点创建一个新路径..？

# android - 如何使图像在触摸时从网格视图中消失？

> ID：11783374
> 
> 赞同：0
> 
> 时间：2012-08-02T18:14:09.023
> 
> 标签：android, android-layout, android-intent

我有一个网格视图，其中包含各种图像视图，我希望这些图像在触摸时消失。

我怎样才能做到这一点？如何为这些网格视图图像实现触摸侦听器？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-02T18:52:58.507

ImageViews 都是视图类型，布局是 ViewGroups。其中任何一个您都可以将可见性设置为消失或删除。所以实际上你只需要实现 onTouchListener 事件处理程序，然后在 ImageViews 上设置可见性。因此，如果您想一次将它们全部隐藏，您可能还需要考虑将整个布局设置为不可见。你可以做

```
LinearLayout myLinearLayout = (LinearLayout)findViewById(myLinearLayoutId);
myLinearLayout.setVisibility(View.GONE) // or to show again View.VISIBLE 
```

一般来说

```
 view.setVisibility(View.GONE) or View.INVISIBLE 
```

有关 onTouchListener 的教程，请参见：[http ://www.mybringback.com/tutorial-series/3279/android-the-basics-32-androids-ontouchlistener-and-motionevent/](http://www.mybringback.com/tutorial-series/3279/android-the-basics-32-androids-ontouchlistener-and-motionevent/)

# vb.net - 有时无法获取 .Document.Body.InnerHtml

> ID：11783379
> 
> 赞同：0
> 
> 时间：2012-08-02T18:14:29.717
> 
> 标签：vb.net, browser-automation

下面的代码在第一次运行时有效，但在随后的运行中经常失败。它失败的行在下面注释。我认为循环通过 SHDocVw.ShellWindows 会产生问题，我需要在再次运行之前清理一些东西。要复制问题，请在 IE 中打开 google，然后运行此过程，重复。谢谢你的帮助。确切的错误是 Exception from HRESULT: 0x800A01B6 。（请注意，这是更复杂代码的简化版本，如果已设置，我实际上会多次重用 IE_test。）

```
 Public IE_test As SHDocVw.InternetExplorer
    Sub TestIE()
    Dim shellWindows_3 As New SHDocVw.ShellWindows()
    Dim htmlDoc As String
    Dim link1 = "google.com"
    If IsNothing(IE_test) = True Then
        For Each ie_x As SHDocVw.InternetExplorer In shellWindows_3
            If ie_x.LocationURL.Contains(link1) Then 'find the google instance
                IE_test = ie_x
            End If
        Next
    End If

    With IE_test
        .Visible = True
        htmlDoc = .Document.Body.InnerHtml 'Fails here on second run
        .Quit()
    End With

    IE_test = Nothing
    MsgBox(Len(htmlDoc))

End Sub 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-08T02:30:51.407

我最终通过从任何程序中完全删除 .Quit() 解决了这个问题（直到程序关闭）。现在，我总是重用现有的 IE 实例，而不是关闭并重新打开，这样可以避免错误。

# ruby-on-rails-3 - 用于管理部分的 javascript_include_tag

> ID：11783380
> 
> 赞同：2
> 
> 时间：2012-08-02T18:14:35.730
> 
> 标签：ruby-on-rails-3

为站点的管理部分存储和引用 JS 的最佳实践是什么？

目前，我有一个引用大量 JS（供应商和应用程序）的 application.js。我想将一些引用移动到另一个文件中，这样当用户不是管理员时就不会（不必要地）加载它。

我正在寻找以下行为：

1.  如果用户不是管理员，则加载 application.js 中的所有内容，包括`/assets/javascripts`via下的所有文件`//= require_tree .`
2.  如果用户是管理员，则加载普通用户会加载的所有内容。另外，加载一些特定的JS。我不确定在哪里存储 JS，因为我不希望它被捡起`require_tree`

任何关于在哪里存储代码以及如何调用它的建议将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-02T18:33:07.147

也许你可以做这样的事情。创建一个文件，该文件需要管理员用户所需的`admin_application.js`所有代码，不包括指令，并维护一个未更改的文件，其中包含非管理员用户的所有要求和内容。 如果它们共享一个共同的布局，那么在你的标题标签中放置一些逻辑来处理这两种情况就很容易了。例子： `.js``require_tree``application.js`

**应用程序.html.erb**

```
<header>
  <% if current_user.is_admin? %>
    <%= javascript_include_tag "admin_application" %>
  <% else %>
    <%= javascript_include_tag "application" %>
  <% end %>
</header> 
```

我认为这是解决您的问题的一种简单而公平的方法。

# python - 字典：键是否存在

> ID：11783384
> 
> 赞同：0
> 
> 时间：2012-08-02T18:14:51.630
> 
> 标签：python, dictionary, coding-style

我使用 django 构建我的网络应用程序。其中一个页面发送不同的文件（具有不同的文件类型）。我有 6 种文件类型。而我当前的代码版本（这真的很糟糕 - 这就是我写这个问题的原因）是：

```
 try:
        file = request.FILES[u'file_doc']
    except MultiValueDictKeyError:
        try:
            file = request.FILES[u'file_fb2']
        except MultiValueDictKeyError:
            try:
                file = request.FILES[u'file_pdf']
            except MultiValueDictKeyError:
                try:
                    file = request.FILES[u'file_txt']
                except MultiValueDictKeyError:
                    try:
                        file = request.FILES[u'file_other']
                    except MultiValueDictKeyError:
                        try:
                            file = request.FILES[u'file_chm']
                        except MultiValueDictKeyError:
                            return HttpResponse('bad file type') 
```

你能告诉我 - 如何改善这种糟糕的代码和平。

蒂亚！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-02T18:17:18.500

该`in`测试让您查看键是否是字典的一部分。

```
if u'file_doc' in request.FILES:
    file = request.FILES[u'file_doc'] 
```

您可以简单地遍历一组键来测试：

```
for key in (u'file_doc', u'file_fb2', .. ):
    if key in request.FILES:
        file = request.FILES[key]
        break
else:
    return HttpResponse('bad file type') 
```

只有当for 循环完成而没有到达语句时，`else`套件才会*执行*，`break`即您没有找到匹配的键。

请注意，您仍然可以在循环中使用您的异常方法：

```
for key in (u'file_doc', u'file_fb2', .. ):
    try:
        file = request.FILES[key]
        break
    except MultiValueDictKeyError:
        pass
else:
    return HttpResponse('bad file type') 
```

但我不太确定这是否更具可读性。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-02T18:18:31.743

你可以这样做：

```
filetypes = [ u'file_doc', u'file_fb2', u'file_pdf' ]

file = None
for ft in filetypes:
  if ft in request.FILES:
    file = request.FILES[ft]
    break

if file is None:
  return HttpResponse('bad file type') 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-02T18:18:01.960

`request.FILES.get(u'file_doc', DEFAULT_VALUE)`如果字典中不存在该键，将返回 DEFAULT_VALUE。您也可以使用Martijn**编辑**`in`提到的关键字， 另请参阅[django MultiValueDictKeyError 错误，我该如何处理](https://stackoverflow.com/questions/5895588/django-multivaluedictkeyerror-error-how-do-i-deal-with-it)

 *** * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-02T18:20:19.710

```
def GetFile(request):
    file_types = "doc fb2 pdf txt other chm".split()
    for k in file_types:
        if "file_{0}".format(k) in request.FILES:
             return request.FILES["file_{0}".format(k)] 
```

至少我会这样做**

# java - java中是否有任何行为类似于c中的getopt的函数

> ID：11783386
> 
> 赞同：15
> 
> 时间：2012-08-02T18:15:03.763
> 
> 标签：java

您好，我正在开发可以接受命令行参数的命令行应用程序，例如

```
app -port 8888 -filename d:\xyz\xyz.pdf -dest d:\pqr 
```

我正在寻找可以返回我的一对选项及其对应值的函数，例如 c 中的 getopt。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-08-02T18:24:59.597

那里有很多用于 Java 的命令行解析器库。

最近（截至 2019 年底）具有很多动力和功能的命令行解析器是[picocli](https://picocli.info/)。

一些较旧的流行的是[commons-cli](http://commons.apache.org/cli/)（相当旧）、[args4j](http://args4j.kohsuke.org)和[JCommander](http://jcommander.org/)。

# facebook-graph-api - 显示超大尺寸个人资料图片 facebook api php

> ID：11783388
> 
> 赞同：0
> 
> 时间：2012-08-02T18:15:07.253
> 
> 标签：facebook-graph-api

我的应用程序依赖于非常大、高质量的用户头像。我目前使用的代码是这样的：

[http://graph.facebook.com/USERID/picture?type=large](http://graph.facebook.com/USERID/picture?type=large)

我得到了一张图片，但它大约是 200 像素 x 200 像素

有没有办法从用户的个人资料图片的相册中获取照片？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-02T21:16:01.147

您可以使用[FQL](https://developers.facebook.com/docs/reference/fql/)查询[select src_big from photo where aid in (select aid from album where owner = me() and type = 'profile')](https://developers.facebook.com/tools/explorer/?fql=select%20src_big%20from%20photo%20where%20aid%20in%20%28select%20aid%20from%20album%20where%20owner%20=%20me%28%29%20and%20type%20=%20%27profile%27%29)获取一组个人资料图片，并假设第一个是当前个人资料图片. 然而，这并不是万无一失的，但没有其他方法可以获得全尺寸的个人资料照片。

# reporting-services - SSRS PDF 文件链接不起作用

> ID：11783389
> 
> 赞同：1
> 
> 时间：2012-08-02T18:15:08.640
> 
> 标签：reporting-services, pdf-generation, ssrs-2008

我创建了一个已导出为 PDF 格式的 SSRS 200R2 标准版报告。该链接在 PDF 文件中不起作用。奇怪的是它可以在 Excel 中使用。
我在文本框属性对话框操作页面中选择了单选按钮**转到报告。**该链接位于矩阵总计字段中。

不确定这是否被视为超链接或钻取链接？

**http://technet.microsoft.com/en-us/library/dd255291**

**钻取链接** PDF 呈现不支持钻取链接。钻取链接不会呈现为可单击的链接，并且钻取报表无法连接到钻取的目标。

**超** 链接 报告中的超链接在 PDF 文件中呈现为可单击的链接。单击后，Acrobat 将打开默认客户端浏览器并导航到超链接 URL。

你知道它以 PDF 格式工作的方法还是我必须使用**Go to URL**？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-02T23:36:28.807

当您选择“转到报告”选项时，该选项被视为钻取链接。

Go to URL 被认为是一个超链接。它不是特定于报告的。它可以是任何东西。但是您可以为您在 Go To Report 中使用的报告生成一个 URL。您只需添加报表服务器的 Web 服务 URL。因此，假设您有一个名为 MyServer 的服务器，并且您使用默认的 Web 服务名称，reportserver。您想链接到文件夹我的报告文件夹中的报告我的其他报告。您的 URL 需要如下所示：

```
http://MyServer/reportserver/My Report Folder/My Other Report 
```

# wolfram-mathematica - 如何从 Mathematica 中椭圆图形内的列表图中收集数据点？

> ID：11783394
> 
> 赞同：3
> 
> 时间：2012-08-02T18:15:24.053
> 
> 标签：wolfram-mathematica

更新：

我有一个数据列表图，我想收集与 Mathematica 中的列表图重叠的圆形图形的特定边界内的所有数据点。

这样的事情可能吗？

我制作的椭圆的形式是

```
{c, s, \[Theta]} = 
 1 /. ComponentMeasurements[f, {"Centroid", "SemiAxes", "Orientation"}]
Show[Rasterize[p], Graphics[{Red, Rotate[Circle[c, s], \[Theta]]}]] 
```

你能帮我把你最底层的解决方案放入一个表格中，我可以在其中输入我的椭圆，包括 Centroid、SemiAxes 和 Orientation 属性吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-02T18:29:11.587

```
data = RandomReal[{0, 1}, {100, 2}]
r = 1/5;
center = {1/6, 1/4};
sd = Select[data, EuclideanDistance[#, center] < r &]
Show[ListPlot@data, 
     Graphics@Circle[center, r], 
     Graphics[{Red, PointSize[Large], Point@sd}], AspectRatio -> 1] 
```

![数学图形](../Images/9ad2bef829f6eab30ac976c0112f634c.png)

**编辑**

对于椭圆

```
data = RandomReal[{0, 1}, {100, 2}]
r = 1/5;
f1 = {1/6, 1/4};
f2 = {1/3, 1/5};
sd = Select[data, EuclideanDistance[#, f1] + EuclideanDistance[#, f2] < r &]
Show[ListPlot@data, 
     RegionPlot[EuclideanDistance[{x, y},f1] + EuclideanDistance[{x, y},f2] <r, 
                {x, 0, 1}, {y, 0, 1}], 
     Graphics[{Red, PointSize[Large], Point@sd}], AspectRatio -> 1] 
```

![数学图形](../Images/408a319d2baa809a76f980abd291d020.png)

**编辑 2**

更好的代码

```
data = RandomReal[{0, 1}, {100, 2}]
r = 1/5;
f1 = {1/6, 1/4};
f2 = {1/3, 1/5};
inside[{x_, y_}, {f1_, f2_}] := Sum[EuclideanDistance[{x, y}, i], {i, {f1, f2}}];
sd = Select[data, inside[#, {f1, f2}] < r &];
Show[ListPlot@data,
     RegionPlot[inside[{x, y}, {f1, f2}] < r, {x, 0, 1}, {y, 0, 1}],
     Graphics[{Red, PointSize[Large], Point@sd}],
  AspectRatio -> 1] 
```

**编辑 3**

在这里，您将整个内容转换为您的`ComponentMeasurements`输出

```
(*{c,s,t}=1/.ComponentMeasurements[f,{"Centroid","SemiAxes",\
"Orientation"}] *)
c = {.3, .4}
s = {.4, .2}
t = Pi/8

{s1, s2} = s
center = {cx, cy} = c
f = Sqrt[s1 s1 - s2 s2]
f1 = {f1x, f1y} = {cx + f Cos[t], cy - f Sin[t]}
f2 = {f2x, f2y} = {cx - f Cos[t], cy + f Sin[t]}
r = 2 Sqrt[f f + s2 s2]

data = RandomReal[{0, 1}, {100, 2}];

sd = Select[data, EuclideanDistance[#, f1] + EuclideanDistance[#, f2] < r &];
Show[
 ListPlot@data, 
 RegionPlot[ EuclideanDistance[{x, y}, f1] + EuclideanDistance[{x, y}, f2] < r,
              {x, 0, 1}, {y, 0, 1}], 
 Graphics[{Red, PointSize[Large], Point@sd}], 
AspectRatio -> 1] 
```

![数学图形](../Images/f737e9572c6a87086f079ed01bb3cc7b.png)

# php - PHP 和嵌套数组的问题

> ID：11783398
> 
> 赞同：1
> 
> 时间：2012-08-02T18:15:33.767
> 
> 标签：php, arrays, foreach, nested, json

我很难使用 json_decode() 处理嵌套数组。我正在尝试获取团队名称列表。

这是实际的数组： http: [//pastebin.com/eMqMcucN](http://pastebin.com/eMqMcucN)

如果你看阵型，一共有三支队伍。第一个团队包含我不需要且不完整的数据（但我能够获得团队名称）。它是团队拥有完整数据的嵌套数组，这让我很着迷。我想得到的是另外两个团队名称并忽略第一个团队，因为它没有嵌套数组，也没有真正的细节。但是，我可以毫无问题地获得第一个团队名称，因为它没有嵌套。

任何帮助/方向将不胜感激。这是我目前在上面的数组上使用的。

"echo 'name: ' . $sd->name;" 行 引发“警告：为 foreach() 提供的参数无效”的错误。我尝试了变化，但没有运气。

```
$obj=json_decode($json);
$data = $obj->fantasy_content->users->{'0'}->user[1]->teams;
$userguid = $obj->fantasy_content->users->{'0'}->user->{'0'};

echo '<pre>'; 
foreach($data as $d){

    $subdata = $d->team;

    foreach($subdata as $sd){
        echo 'name: ' .  $sd->name; //this line errors
    }
 } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-02T18:24:35.917

你应该更深两层，在`team`另一个数组下面，只有这个数组包含数组`name`：

```
[team] => Array
                (
                    [0] => Array (
                       [0] => stdClass Object
                            (
                                [team_key] => 273.l.73856.t.9
                            )

                       [1] => stdClass Object
                            (
                                [team_id] => 9
                            )

                       [2] => stdClass Object
                       (
                            [name] => Team API
                       )
                       ...
                    )
                ) 
```

# iphone - 将 epub 网址直接指向 iBooks

> ID：11783399
> 
> 赞同：1
> 
> 时间：2012-08-02T18:15:34.833
> 
> 标签：iphone, ios, ipad, ios5, epub

我知道如何通过 UIDocumentInterationController 和 UIApplication openURL 在 IOS 设备上打开 epub 书籍，但是......

如何从我的应用程序中获取远程服务器上的 epub 的 url 而不是下载 epub 只需将其定向到 iBooks 以便下载因此在设备中只有一个副本 eixts...在 iBooks 库中？

# cordova - iScroll 在缩放之前不会水平滚动

> ID：11783402
> 
> 赞同：0
> 
> 时间：2012-08-02T18:15:43.663
> 
> 标签：cordova, scroll, jqtouch, iscroll, ios6

我在使用 Phonegap/Cordova 构建的 JQTouch iPhone 应用程序中使用 iScroll 4 (cubiq.org/iscroll-4)。

我的问题是水平滚动，虽然'hScroll：true'，直到我放大和缩小图像才启用，这使得一切正常（确认iScroll工作并且包装器/滚动器的CSS是正确的）。

HTML：

```
<div id="wrapper">
    <div id="scroller"></div>  // Also tried with img-tag in div instead of as bg
</div> 
```

CSS：

```
#wrapper {
position:absolute;
top:45px; bottom:0; left:0; // 45px is header
z-index:1;
width:100%; // Also tried with window size (320)
overflow:auto; // Also tried with scroll
}

#scroller {
position:absolute; z-index:1;
width: 1024px; // The size of my image
height: 414px; // The height of my image
background: url(img/test.png) no-repeat;
padding: 0;
} 
```

JAVASCRIPT：

```
var myScroll;
function loaded() {
    myScroll = new iScroll('wrapper', {
                             hScrollbar: true,
                             vScrollbar: true,
                             hScroll: true,
                             vScroll: true,
                             zoom: true
                             });
} 
```

改变'vScroll'和'zoom'的参数马上就有了想要的效果。与水平滚动相关的参数在缩放触发它之前什么都不做。

我尝试在加载后刷新包装器或滚动到坐标，编辑我的应用程序的加载顺序，但没有任何帮助。

谢谢你的时间，安德烈亚斯。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-07T18:55:16.930

您需要手动启用 hScroll 选项。

在我需要缩放的每个 div 中，我都包含以下代码：

```
data-iscroll='{"zoom":true, "hScroll":true }' 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-31T09:18:34.823

这可能是因为包装器 div 的宽度每次都小于滚动器 div 的宽度。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-01-30T04:15:52.167

我有一个类似的问题，只是图像元素在缩放或调整窗口大小之前根本不会滚动。这个问题原来与 DOM 更新有关。我在当时隐藏的元素上创建滚动条。当它后来变得可见时，滚动不起作用。原来我必须显示然后刷新滚动条。

你可以在这里找到更多信息：http: [//iscrolljs.com/#refresh](http://iscrolljs.com/#refresh)

示例代码：

```
ajax('page.php', onCompletion);

function onCompletion () {
    // Update here your DOM

    setTimeout(function () {
        myScroll.refresh();
    }, 0);
}; 
```

# django - “WSGIRequest”对象没有属性“会话”

> ID：11783404
> 
> 赞同：15
> 
> 时间：2012-08-02T18:15:50.007
> 
> 标签：django, django-middleware

我有时在 process_response 方法的自定义中间件中收到此错误。我有以下中间件列表：

```
MIDDLEWARE_CLASSES = [
'django.middleware.common.CommonMiddleware',
'django.contrib.sessions.middleware.SessionMiddleware',
'django.contrib.auth.middleware.AuthenticationMiddleware',
'django.middleware.doc.XViewMiddleware',
'django.contrib.flatpages.middleware.FlatpageFallbackMiddleware',
'django.contrib.messages.middleware.MessageMiddleware',
'django.middleware.csrf.CsrfViewMiddleware',
'application.middleware.LastCampaignSessionMiddleware' 
```

]

所以会话中间件放在我的中间件之前。`del request.session`我在源代码中没有任何表达式。这是 process_response 方法：

```
 def process_response(self, request, response):
        if 'last_campaign_id' in request.session and request.session['last_campaign_id']:
            if request.COOKIES['last_campaign_id'] != request.session['last_campaign_id']:
                response.set_cookie('last_campaign_id', request.session['last_campaign_id'])
        return response 
```

不知道为什么它会发生。

**编辑 03-08-2012 12-30**

它看起来像浏览器请求网站图标：

```
[03/Aug/2012 10:26:42] "GET /favicon.ico/ HTTP/1.1" 404 6701 
```

django 中是否没有默认行为来解析此 url？因为我没有明确指定应该处理这个请求的视图。而且我不在页面源代码中使用网站图标。所以我猜是浏览器请求/favicon.ico。我想如果出现 404 错误，HttpRequest 将无法正确构造，所以难怪我在请求对象中没有会话。但这只是我的假设。

另外，如果有必要，我在收到此错误时正在使用 django dev 服务器。

**编辑 13-00**

我已经用 favicon 解决了这个问题，但仍然出现错误。为什么请求中可能不存在会话？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-08-03T12:38:07.520

问题出在中间件顺序上。

CommonMiddleware 返回 HttpResponsePermanentRedirect 在请求 url 已添加“www”或尾随“/”（设置中的 APPEND_SLASH 和 PREPEND_WWW）的情况下。在这种情况下，django 停止在中间件列表中查找 process_request 方法并开始运行 process_response 方法。

糟糕的是，没有关于标准 django 中间件的这种行为的信息（即中间件在某些情况下可能返回 HttpResponse 对象）。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2018-03-25T23:08:46.413

如果您因为更新到 Django 2.0 而来到这里并收到此错误，您可能想知道名称`MIDDLEWARE_CLASSES`已替换为`MIDDLEWARE`.

更多在这里[https://stackoverflow.com/a/47650447/1218179](https://stackoverflow.com/a/47650447/1218179)和这里[https://docs.djangoproject.com/en/2.0/topics/http/middleware/](https://docs.djangoproject.com/en/2.0/topics/http/middleware/)

# boolean - 布尔表达式的对偶和补码有什么区别？

> ID：11783407
> 
> 赞同：23
> 
> 时间：2012-08-02T18:16:01.307
> 
> 标签：boolean, boolean-logic, boolean-expression, boolean-operations

它是一样的吗？还是有细微的差别？我只是想确保我没有误解任何事情。

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2012-08-02T18:34:10.660

布尔对偶是通过简单地用 OR 替换 AND 和用 AND 替换 OR 来生成的。补语本身不受影响，因为表达式的补语是用 OR 替换 AND 对变量的否定，反之亦然。

考虑：

```
A+B 
```

补充：`A'B'`

双重的：`AB`

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-08-21T01:38:27.167

“身份的对偶也是身份。这就是所谓的对偶原则”。布尔标识是 X+0=X 或 X+X=X。他们有很多。Duals 仅适用于身份。要找到对偶，请切换运算符 (+ & .) 并切换标识元素（0 和 1，如果有任何 0 和 1）以将 X+0=X 更改为 X.1=X 并更改 X+X=X到 XX=X，它创建了同样有效的新身份。从像 X'Y+XY'=1 这样的任意表达式创建对偶是没有意义的。补码取决于任意表达式，如 f1(x,y)=X'Y+XY'，其补码为 f2(x,y)=(X+Y').(X'+Y) 如果如果将相同的值插入 f2(x,y)，则将值插入 f1(x,y) 将得到完全相反的结果。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2015-12-08T19:33:35.677

假设函数 f = {a, c', h', i', l, l, e, s, 1, 0}

f 补码将是 f = {a', c, h, i, l', l', e', s', 0, 1}

f 对偶将是 f = {a, c', h', i', l, l, e, s, 0, 1} 注意：对于对偶文字将保持原样。只有 OR 门被 AND 门替换，反之亦然，1 替换 0，反之亦然

但是在与门和值一起互补的情况下，文字将被补充。

这里是完整的例子：如果我们想得到 x'+y' 的赞美

互补说：(x')'.(y')'

对偶 说：xy

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-01-14T16:59:38.390

除了已经说过的。
同样重要的是要注意，1 的对偶是 0，反之亦然，这类似于补码运算。
例如：x+1 = 1
双是：x.0 = 0

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-07-20T06:46:20.473

在对偶中，AND 被 OR 运算符替换，OR 被 AND 运算符替换，但补语保持不变。在补语中，AND 或被 OR 替换，OR 将被 AND 替换，并且补语也发生了变化。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2018-02-03T19:28:33.350

在寻找对偶时，我们替换

1.  AND 与 OR 反之亦然
2.  0 和 1，反之亦然

在寻找补语的时候，除了以上两个，我们还需要替换

A 与 A' 反之亦然（即变量及其补码）

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2016-12-12T05:50:41.690

实际上对偶性是通过交换 1 和 0 以及（AND 和 OR）来获得的，但作为补充，另一个问题将包括在这个变化中，如果 x 它将被 x 替换，它将被 x bar 示例 f= (x+y) dual of f 是 = xy 但补码 = x(bar).y(bar)

# ajax - ajax加载页面时jQuery插件未加载

> ID：11783408
> 
> 赞同：1
> 
> 时间：2012-08-02T18:16:05.333
> 
> 标签：ajax, jquery, jquery-plugins, smooth-scrolling

我一直在研究这段代码。一旦画廊页面加载了ajax，我正在尝试实现SmoothDivScroll jquery 插件。这是我的 ajax js。请注意，如果不使用 ajax 加载画廊，smoothdivscroll 可以正常工作。

```
$(document).ready(function(){

    $('.more').live('click',function(){
        var href = $(this).attr('href');
        if ($('#ajax').is(':visible')) {
            $('#ajax').css('display','block').animate({height:'1px'}).empty();
        }
        $('#ajax').css('display','block').animate({height:'380px'},function(){
            $('#ajax').html('<img class="loader" src="images/loader.gif" alt="">');
            $('#ajax').load('content.php #'+href, function(){
                $('#ajax').hide().fadeIn().highlightFade({color:'#717171'});
            });
        });
        return true;
    });

    $("div#makeMeScrollable").smoothDivScroll({
        mousewheelScrolling: true,
        manualContinuousScrolling: true,
        visibleHotSpotBackgrounds: "always",
        autoScrollingMode: "onstart"
    });

}); 
```

更新：虽然@Mathletics 回答确实通过在回调中调用插件来加载插件，但smoothscrollingdiv 并不那么顺利。图片不是内​​联的，滑动非常生涩。无需通过ajax加载它就可以正常工作。下面我提供了链接，说明使用 ajax 和不使用 ajax 的样子。

Ajax 加载：[从菜单中选择图库](http://mobile.sheridanc.on.ca/~nguyen9/final/#gallery)

没有阿贾克斯：[这就是画廊应该有的样子](http://mobile.sheridanc.on.ca/~nguyen9/final/content.php)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-02T18:18:29.077

将`smoothDivScroll`呼叫移动到您的回调中。

```
$(document).ready(function(){

    $('.more').live('click',function(){
        var href = $(this).attr('href');
        if ($('#ajax').is(':visible')) {
            $('#ajax').css('display','block').animate({height:'1px'}).empty();
        }
        $('#ajax').css('display','block').animate({height:'380px'},function(){
            $('#ajax').html('<img class="loader" src="images/loader.gif" alt="">');
            $('#ajax').load('content.php #'+href, function(){
                $('#ajax').hide().fadeIn().highlightFade({color:'#717171'});
                    $("div#makeMeScrollable").smoothDivScroll({
                    mousewheelScrolling: true,
                    manualContinuousScrolling: true,
                    visibleHotSpotBackgrounds: "always",
                    autoScrollingMode: "onstart"
                });

            });
        });
        return true;
    });

}); 
```

# ruby-on-rails - 哈姆 + 小胡子

> ID：11783409
> 
> 赞同：1
> 
> 时间：2012-08-02T18:16:14.160
> 
> 标签：ruby-on-rails, ruby, haml, mustache

我正在尝试使用 Haml + Mustache 创建博客，但“描述”字段具有 CKEditor，因此该字段始终包含 html 标签，但即使放置“description.html_safe”，Mustache 也不会呈现为 html。

我的助手：

```
def post_for_mustache(post)
{
  post: {
    category: {
      url: category_order_path(:category => post.category.to_param),
      name: post.category.name
    },
    url: category_post_path(:category => post.category.to_param,
                            :slug => post.to_param),
    title: post.title,
    comment_enabled: post.comment_enabled,
    description: post.description.html_safe,
    title_escape: URI.escape(post.title),
    url_escape: URI.escape(category_post_url(:category => post.category.to_param,
                                             :slug => post.to_param)),
  }
}
end 
```

我的 Mustache 初始化程序：

```
module MustacheTemplateHandler
  def self.call(template)
    haml = "Haml::Engine.new(#{template.source.inspect}).render"
    if template.locals.include? 'mustache'
      "Mustache.render(#{haml}, mustache).html_safe"
    else
      haml.html_safe
    end
  end
end
ActionView::Template.register_template_handler(:mustache, MustacheTemplateHandler) 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-02T18:51:38.790

我猜你在你的小胡子里做这样的事情：

```
{{description}} 
```

如果`description`包含 HTML，则需要说：

```
{{{description}}} 
```

来自[精美手册](http://mustache.github.com/mustache.5.html)：

> **变量**
> [...]
> 默认情况下，所有变量都是 HTML 转义的。如果要返回未转义的 HTML，请使用三重小胡子： **`{{{name}}}`**。

因此`{{description}}`，将由 Mustache 编码 HTML，但`{{{descriptipn}}}`将按原样使用`description`。

# nhibernate - DDD 聚合根子关系 NHibernate 映射

> ID：11783414
> 
> 赞同：2
> 
> 时间：2012-08-02T18:16:49.903
> 
> 标签：nhibernate, domain-driven-design

我正在尝试遵循聚合设计原则，并提出了需要帮助的情况。我的聚合根是一个`Customer`对象。该`Customer`对象具有对象的`Address`子集合和`Contact`对象的子集合。

A`Contact`可以引用聚合`Address`下的a。`Customer`该`Customer`对象具有唯一性`ID`，而`Address`and`Contact`对象具有本地 id，因此数据库中的主键是`CustomerId`and `AddressId`。

以下是简化的类：

```
public class Customer : AggregateRoot {
    public virtual int CustomerId { get; protected set; }
    public virtual IList<Address> Addresses { get; protected set; }
    public virtual IList<Contact> Contacts { get; protected set; }
}
public class Address : Entity {
    public Address(Customer customer, int addressId) {
        this.Customer = customer;
        this.AddressId = addressId;
    }

    public virtual Customer Customer { get; protected set; }
    public virtual int AddressId { get; protected set; }
}
public class Contact : Entity {
    public Contact(Customer customer, int contactId) {
        this.Customer = customer;
        this.ContactId = contactId;
    }

    public virtual Customer Customer { get; protected set; }
    public virtual int ContactId { get; protected set; }
    public virtual Address Address { get; set; }
} 
```

该数据库具有如下表：

**顾客**

```
CustomerId int identity PK 
```

**地址**

```
CustomerId int not null PK,FK
AddressId int not null PK 
```

**接触**

```
CustomerId int not null PK,FK
ContactId int not null PK
AddressId int null FK 
```

当我尝试使用 Fluent NHibernate 映射我的实体时，我的问题就出现了。因为`Address`对象有一个复合键`CustomerId`and `AddressId`，NHibernate 不会重用`CustomerId`联系人表中的列。当我尝试保存聚合时，我得到一个异常，说值多于参数。发生这种情况是因为 Address 对象具有复合 ID，并且不`CustomerId`与对象共享列`Contact`。

我能看到解决这个问题的唯一方法是`AddressCustomerId`在表中添加一列`Contact`，但现在我有一个重复的列，`CustomerId`并且`AddressCustomerId`是相同的值。反正有这种行为吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-03T04:27:24.180

如果 Address 和 Contact 在 Customer 聚合之外都没有身份，那么它们应该被映射为组件集合。此外，客户地址和客户联系人关系是否需要是双向的？是否需要 addressId 和 contactId？如果模型被简化，这将起作用：

```
public class Customer
{
    public virtual int CustomerId { get; protected set; }
    public virtual IList<Address> Addresses { get; protected set; }
    public virtual IList<Contact> Contacts { get; protected set; }
}

public class Address
{
    public string Street1 { get; private set; }
    public string Street2 { get; private set; }
    public string City { get; private set; }
    public string Region { get; private set; }
}

public class Contact
{
    public string Name { get; private set; }
    public string Email { get; private set; }
    public virtual Address Address { get; set; }
}

public class CustomerMap : FluentNHibernate.Mapping.ClassMap<Customer>
{
    public CustomerMap()
    {
        Table("Customers");
        Id(x => x.CustomerId);
        HasMany(x => x.Addresses)
            .Table("CustomerAddresses")
            .KeyColumn("CustomerId")
            .Component(m =>
            {
                m.Map(x => x.Street1);
                m.Map(x => x.Street1);
                m.Map(x => x.City);
            });
        HasMany(x => x.Contacts)
            .Table("CustomerContacts")
            .KeyColumn("CustomerId")
            .Component(m =>
            {
                m.Map(x => x.Name);
                m.Map(x => x.Email);
                m.Component(x => x.Address, ma =>
                {
                    ma.Map(x => x.Street1);
                });
            });
    }
} 
```

在映射中，地址和联系人集合被映射为组件。这意味着他们不需要拥有自己的身份，因此不需要单独的映射类。然而，在这个模型中，联系人的地址将与联系人数据本身存储在同一行中，我认为这是一个很好的模型（而不是更规范的模型）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-13T11:27:23.833

据我所知，NHibernate 没有办法共享列。我最终选择了我已经使用了几年的解决方案。我使用 GUID 作为 NHibernate 的 ID，并使用 int 代理键进行查询。这个解决方案对我来说效果很好，但我只是想减少数据库中的一些额外浪费。

# function - 如何使用 MatLab 将变量从一个函数传递到另一个函数？

> ID：11783417
> 
> 赞同：1
> 
> 时间：2012-08-02T18:16:59.727
> 
> 标签：function, matlab, variables

假设我有一些函数`import_data()`，在这个函数内部我创建了 2 个变量：`response_values`和`file_to_get`

```
file_to_get = uigetfile({'*.csv*'}, 'Select the CSV File',...
'\\pfile01thn\bbruffey$\My Documents\analysis data\full files\...
Raw Stats Data full file only');

response_values = zeros(numel(C),numCols);
for i=1:numel(C)
    v = textscan(C{i}, '%s', 'Delimiter',',');
    v = str2double(v{1}(4:end));
    response_values(i,1:numel(v)) = v;
end 
```

然后我需要将这些变量传递给另一个函数`MS_Banding_Streaking()`

怎么可能做到这一点？（我目前正在使用全局变量，这是非常糟糕的做法。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-02T18:21:57.790

就像是

文件 import_data.m

```
function response_values, file_to_get = import_data()

file_to_get = uigetfile({'*.csv*'}, 'Select the CSV File',...
'\\pfile01thn\bbruffey$\My Documents\analysis data\full files\...
Raw  Stats Data full file only');

response_values = zeros(numel(C),numCols);
for i=1:numel(C)
    v = textscan(C{i}, '%s', 'Delimiter',',');
    v = str2double(v{1}(4:end));
    response_values(i,1:numel(v)) = v;
end 
```

文件 mainfunc.m

```
% Stuff before
[vals, filegot] = import_data()
MS_Banding_Streaking(filegot, vals)
% Stuff after 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-02T18:37:11.953

只需简单地将两个函数写在同一个`.m`文件中

```
function import_data()    
file_to_get = uigetfile({'*.csv*'}, 'Select the CSV File',...
'\\pfile01thn\bbruffey$\My Documents\analysis data\full files\...
Raw  Stats Data full file only');

response_values = zeros(numel(C),numCols);
for i=1:numel(C)
    v = textscan(C{i}, '%s', 'Delimiter',',');
    v = str2double(v{1}(4:end));
    response_values(i,1:numel(v)) = v;
end

MS_Banding_Streaking(response_values, file_to_get);

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

function MS_Banding_Streaking(resp_value, f2g)
% function body 
```

# perl - 比较哈希，打印具有相同值的键的值

> ID：11783418
> 
> 赞同：-3
> 
> 时间：2012-08-02T18:17:07.377
> 
> 标签：perl, hash, get, append

我想在 perl 中实现这个算法

```
11000,  67676,  -7878,  9898
11001,  67676,  -7878,  7673
11789,  56565,  -0909,  5555
17654,  67676,  -7654,  3214
18776,  99999,  -55,    4444
17765,  67676,  7878,   9898

scan *nodes
hash1{node}=x,y,z
invert_y=y*-1
chech invert_y existance in hash2
if exists
hash2{y}=[n1,n2,n3...].append the node
else
hash2{y}=store node in a array and pass its reference as value 

foreach key in hash1
get x1,y1,z1 of this node1 (eg. hash1{key} will return x,y,z of this node1)
invert_y=y*1
if exists hash2{invert_y}
get all node of hash2{keys} in node_array
foreach node2 in node_array
get x2,y2,z2 of this node2 (eg. hash1{node2} will return x,y,z of this node2)
if x1 of node1 == x2 of node2 && z1 of node1 == z2 of node2
    node1 and node2 are symmetric 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-02T22:24:32.477

我取了你的一些伪代码并对其进行了 perl 化以帮助你入门。

```
hash1{node}=x,y,z
  # value in hash is a reference to a 3-element array
  $hash1{$node} = [ $x, $y, $z ];

foreach key in hash1
  foreach my $k (keys %hash1)

get x1,y1,z1 of this node1 (eg. hash1{key} will return x,y,z of this node1)
  $node1 = $hash1{$k};

invert_y=y*1
  I have no idea what you mean here

if exists hash2{invert_y}
  if (exists $hash2{$invert_y}

get all node of hash2{keys} in node_array
  eh?

foreach node2 in node_array
  foreach $node2 (@node_array)

get x2,y2,z2 of this node2 (eg. hash1{node2} will return x,y,z of this node2)
  $node2 = $hash1{$node2};

if x1 of node1 == x2 of node2 && z1 of node1 == z2 of node2
    node1 and node2 are symmetric 

  # x is element 0, y is 1 and z is 2
  if ($node1->[0] == $node2->[0] &&
      $node1->[2] == $node2->[2]) 
```

# bash - 确定终端格式化输出的能力？

> ID：11783420
> 
> 赞同：3
> 
> 时间：2012-08-02T18:17:09.373
> 
> 标签：bash, terminfo

你好 - 如果我想确定终端可以显示的颜色数量，我只需读取输出

```
 tput colors 
```

...但是我不知道如何确定我正在写入的终端是否可以支持其他格式请求，例如粗体、下划线、反向视频、闪烁（糟糕！）。

我看到了如何通过 tput 设置输出，但在尝试之前不确定该功能是否存在。

我应该简单地假设所有终端都存在这种能力吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-02T18:38:22.270

您可以使用`infocmp`它，以及`grep`您正在寻找的功能。如果找到结果，则支持该功能：

```
infocmp | grep bold
    bel=^G, bold=\E[1m, clear=\E[H\E[2J, cr=^M, 
```

为了获得不同功能的名称，请查看[有关 terminfo 的 Linux 手册页](http://linux.die.net/man/5/terminfo)，或者查看[此](http://unixhelp.ed.ac.uk/CGI/man-cgi?terminfo+5)手册页以获取名称的表格布局。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-02T18:37:19.390

可能有更简单的方法，但您可以通过运行查询 terminfo 数据库

```
infocmp $TERM 
```

查看当前终端的完整条目（替换`$TERM`为任何支持的终端类型的名称）。您可能需要阅读手册页以了解如何创建最容易根据您的给定需求解析的输出。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-03T01:21:07.347

如果您尝试`tput`使用未定义属性的命令，它将返回非零退出代码。您可以重定向正常输出（如果有）以避免其生效。

```
for attr in bold rev smul blink sshm
do
    if ! tput "$attr" > /dev/null
    then
        echo "Attribute $attr is undefined"
    fi
done 
```

否则，如果您`grep`是 的输出`infocmp`，请使用`-1`(that's a one) 选项每行输出一个属性。

```
infocmp -1 | grep smul 
```

# html - 在 chrome 或 firefox 中的 iframe 下无法点击链接

> ID：11783422
> 
> 赞同：0
> 
> 时间：2012-08-02T18:17:10.927
> 
> 标签：html, iframe

我创建了一个 iframe 来保存我的网站的导航。导航有下拉元素。效果很好 - 但是，页面上 iframe 区域下的链接不再正常工作。我曾尝试使用 z-index，但它一次只允许 div 区域的一个链接起作用。我需要能够同时使用 iframe 中的链接和页面上的链接？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-02T18:22:07.740

这些元素被适当地保存在它们的框架内。

我强烈建议不要`<iframe>`以这种方式使用导航，原因如下：

*   搜索引擎不会链接到您的框架集，它们通常会链接到您的内页
*   安置问题，例如您遇到的问题
*   屏幕阅读器混乱和其他可访问性问题

# asp.net - 为什么会抛出异常？

> ID：11783426
> 
> 赞同：0
> 
> 时间：2012-08-02T18:17:35.433
> 
> 标签：asp.net, asp.net-mvc-3

我有一个基本控制器：

```
Public MustInherit Class InjuredWorkerController(Of TManager As IInjuredWorkerManagerBase) 
```

然后我有一个家庭控制器：

```
Public Class HomeController
    Inherits InjuredWorkerController(Of IInjuredWorkerManager) 
```

`IInjuredWorkerManager`继承`IInjuredWorkerManagerBase`

为什么这会引发强制转换异常：

```
Dim manager = CType(filterContext.Controller, InjuredWorkerController(Of IInjuredWorkerManagerBase)).Manager 
```

无法将“MyClaim.Controllers.HomeController”类型的对象转换为“MyClaim.Controllers.InjuredWorkerController`1[SAIF.Web.Mvc.MyClaim.IInjuredWorkerManagerBase]”。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-02T19:13:33.070

您需要提取一个接口`InjuredWorkerController`以使其工作，因为协变和逆变仅适用于接口和委托。

此代码编译并运行（C# 控制台应用程序，我不熟悉 VB.Net...）：

```
using System;

namespace TestApplication
{
    public interface IInjuredWorkerController<out TManager>
        where TManager : IInjuredWorkerManagerBase
    {
        TManager Manager { get; }
    }

    public abstract class InjuredWorkerController<TManager>
        : IInjuredWorkerController<TManager>
        where TManager : IInjuredWorkerManagerBase, new()
    {
        protected InjuredWorkerController()
        {
            Manager = new TManager();
        }

        public TManager Manager { get; private set; }
    }

    public interface IInjuredWorkerManagerBase
    {
        string Name { get; }
    }

    public interface IInjuredWorkerManager
        : IInjuredWorkerManagerBase {}

    public class InjuredWorkerManager : IInjuredWorkerManager
    {
        public string Name
        {
            get { return "Homer"; }
        }
    }

    public class HomeController
        : InjuredWorkerController<InjuredWorkerManager> {}

    internal class Program
    {
        private static void Main()
        {
            var controller = new HomeController();
            var manager = ((IInjuredWorkerController<IInjuredWorkerManagerBase>)controller).Manager;

            Console.Out.WriteLine(manager.Name);
            Console.ReadKey();
        }
    }
} 
```

[Eric Lippert](http://blogs.msdn.com/b/ericlippert/archive/tags/covariance+and+contravariance/)关于这个主题的博客系列是必读的。

# javascript - jQuery更改值鼠标悬停

> ID：11783427
> 
> 赞同：0
> 
> 时间：2012-08-02T18:17:37.850
> 
> 标签：javascript, jquery, jquery-ui, mouseover

我写了这段代码，但它不起作用：

JavaScript：

```
$(function() { 
    var menu_h_number=5

    for (i=1; i<=menu_h_number; i++)
    {
        $(".web_header_mb_"+i).show(1000);

        $(".web_header_mb_"+i).css("background", "#FF0000");

        $(".web_header_mb_"+i).hover(function () 
        {
            $(".web_header_mb_"+i).css("width", "200");
        });

        $(".web_header_mb_"+i).mouseout(function () 
        {
            $(".web_header_mb_"+i).css("width", "300");
        });
    }
}); 
```

HTML：

```
<div id="menu" class="web_header_mb_1"></div>
<div id="menu" class="web_header_mb_2"></div>
<div id="menu" class="web_header_mb_3"></div>
<div id="menu" class="web_header_mb_4"></div>
<div id="menu" class="web_header_mb_5"></div> 
```

当开始`id`在 bucle 中显示不同的 s 但当我执行 a 时`mouseover`，大小没有变化。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-02T19:06:38.883

**为什么它不起作用**

您的代码不起作用的原因是：

`i`将具有立即执行的代码的正确值（例如`show`and`hover`调用）。但是，由于 JavaScript 的工作方式，这不适用于回调（例如你给的回调`hover`）。JavaScript 将记住**变量**，而不是提供回调时变量的**值**。*直到循环完成后*才会调用回调。这就是为什么在回调`i`中总是**5**，因为那是`i`最后一个值。

您可以在此处阅读更多相关信息：[闭包 (MDN)](https://developer.mozilla.org/en/JavaScript/Guide/Closures)

另外，请注意`id`'**必须**是唯一的。您不能将`id`“菜单”赋予五个不同的元素；这就是课程的用途。换句话说：你的代码已经得到了`id`和`class`倒退。

**如何使它工作**

规避闭包“问题”的最简单方法是`$(this)`在回调函数内部使用。在 jQuery 中，`this`回调函数中的关键字总是指向触发事件的对象。通过使用`$(this)`你有完全正确的 jQuery 对象，没有任何大惊小怪：

```
for (i=1; i<=menu_h_number; i++)
{
    var currentItem = $(".web_header_mb_" + i);

    currentItem
        .show(1000)
        .css("background", "#FF0000");
        .hover(
            function() { // mouseenter
                $(this).css("width", 200);    // <--
            },
            function() { // mouseleave
                $(this).css("width", 300);    // <--
            });
} 
```

我在上面的代码中做的另一件事是将 jQuery 对象*缓冲*在一个局部变量 ( `currentItem`) 中。这使您的代码更快，因为您只需查找元素一次（而不是 6 次，在这种情况下）。你应该尽可能地这样做。

此外，如您所见，该[`hover`功能](http://api.jquery.com/hover/)不仅适用于`mouseover`事件。你可以给它回调来处理`mouseover`和`mouseout`。

正如其他人已经建议的那样，您可以做的另一件事是使用单个类而不是 5 个不同的类。如果查询匹配多个对象，jQuery 函数 ( `$()`) 实际上会返回一个**集合。**

因此，给定以下 HTML：

```
<div class="menu web_header_mb"></div>
<div class="menu web_header_mb"></div>
<div class="menu web_header_mb"></div>
<div class="menu web_header_mb"></div>
<div class="menu web_header_mb"></div> 
```

您可以使用[each()](http://api.jquery.com/each/)，如下所示：

```
$(".menu.web_header_mb").each(function() {
    $(this)
        .show(1000)
        .css("background", "#FF0000");
        .hover(
            function() { // mouseenter
                $(this).css("width", 200);
            },
            function() { // mouseleave
                $(this).css("width", 300);
            });
}); 
```

甚至这样：

```
$(".menu.web_header_mb").
    .show(1000)
    .css("background", "#FF0000");
    .hover(
        function() { // mouseenter
            $(this).css("width", 200);
        },
        function() { // mouseleave
            $(this).css("width", 300);
        }); 
```

最后一个有效，因为[show()](http://api.jquery.com/show/)、[css()](http://api.jquery.com/css/)和[hover()](http://api.jquery.com/hover/)都适用于 jQuery*集合*（以及单个 jQuery 对象）。整齐吧？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-02T18:42:30.320

没有必要循环遍历元素，如果你只是想出选择器，jQuery 就会为你做到这一点。

尝试匹配具有以开头的类的每个元素，`web_header_mb_`然后删除您不想要的元素。如果它们具有正确的索引，您可以`:lt(5)`或`slice(0,5)`，否则您必须根据类的最后一个字符过滤它们。您还可以链接方法，无需每次都调用选择器：

```
$("[class^='web_header_mb_']").filter(function() {
    var C = $(this).prop('class'); 
        C = C.charAt(C.length-1);
    return (C==1||C==2||C==3||C==4||C==5);
}).show(1000)
  .css("background","#FF0000")
  .on('mouseenter mouseleave', function() {
        $(this).css('width', e.type==='mouseenter'?'200':300);
}); 
```

或者

```
$("[class^='web_header_mb_']:lt(5)").show(1000)
    .css("background","#FF0000")
    .on('mouseenter mouseleave', function() {
       $(this).css('width', e.type==='mouseenter'?'200':300);
}); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-02T18:24:11.000

jQuery.hover() 实际上需要两个参数，鼠标移入和鼠标移出。

```
$(".web_header_mb_"+i).hover(
function ()  { $(this).css("width","200px") }, 
function ()  { $(this).css("width","300px") }
); 
```

实际上，查看代码，这并不是一个真正的好方法。在这里尝试这种方式：给所有 div 相同的类，而不是使用 for 循环进行迭代，并使用 $.each 来提供所需的事件。

```
<div id="menu" class="web_header_mb"></div>
<div id="menu" class="web_header_mb"></div>
<div id="menu" class="web_header_mb"></div>
<div id="menu" class="web_header_mb"></div>
<div id="menu" class="web_header_mb"></div>

$.each(".web_header_mb", function (){
  $(this).hover(
   function ()  { $(this).css("width","200px") }, 
   function ()  { $(this).css("width","300px") }
  );
}); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-02T18:20:50.843

尝试使用这个

```
$(function(){

    var menu_h_number=5;

    for (var i=1; i <= menu_h_number;i++) {
        $(".web_header_mb_"+i).show(1000)
                              .css("background","#FF0000")
                              .mouseover(function () {
                                  $(this).css("width","200");
                              })
                              .mouseout(function () {
                                  $(this).css("width","300");
                              });
    }
}); 
```

也可以在[jsfiddle上找到](http://jsfiddle.net/RPVwN/)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-08-02T18:20:56.427

这是因为执行悬停代码时 i 变量不在范围内或具有最新值。而是使用此变量。

仅供参考：1.您的 div 标签具有相同的 ID 但不同的类名。相反，使它们具有相同的类和不同的 ID。比你可以很好地使用 jQuery.each 函数。

1.  hover 函数可以有 2 个参数，第一个用于 mousein，第二个用于 mouseout。这样你就可以精简你的代码

# php - 是否可以将参数绑定到 MYSQLi 中的存储过程？

> ID：11783428
> 
> 赞同：2
> 
> 时间：2012-08-02T18:17:39.307
> 
> 标签：php, stored-procedures, mysqli

我一直在阅读存储过程和 MYSQLi 从这里[http://php.net/manual/en/mysqli.quickstart.stored-procedures.php](http://php.net/manual/en/mysqli.quickstart.stored-procedures.php)

和其他来源，但我仍然不确定如何调用存储过程`?`（如准备好的语句）

**是否可以将参数绑定到存储过程，类似于：**

```
$mysqli->query("CREATE PROCEDURE p(IN id_var INT) BEGIN INSERT INTO test(id)
         VALUES(id_var); END;"))
$mysqli->bindParam("i", $some_int);
$mysqli->query("CALL p"); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-02T20:11:44.207

绑定参数是PHP端的操作；存储过程是 MySQL 的东西。两者没有关系，不应该这样对待。

使用准备好的语句和参数绑定，您可以使用该`prepare()`方法定义一个查询，然后使用 将值绑定到`?`s 中`bind_param()`。因此，鉴于您的示例，准备好的语句方法如下所示：

```
$stmt = $mysqli->prepare("INSERT INTO test (id) VALUES (?)");
$stmt->bind_param('i', $some_int);
$stmt->execute(); 
```

另一方面，对于存储过程，您只需[使用`CALL`命令](http://dev.mysql.com/doc/refman/5.0/en/call.html)作为普通查询调用它：

```
//procedure created beforehand
CREATE PROCEDURE p(IN id_var INT)
INSERT INTO test (id)
VALUES (id_var);
//now in PHP:
$mysqli->query("CALL p($some_int)"); 
```

我不确定您是否可以`CREATE PROCEDURE`使用该`query()`方法运行。

所以回答你的问题：是的，可以同时使用两者（因为它们是不同的东西），但不是你想象的那样，这将是多余的。

# c++ - 如何在另一个函数中访问在一个函数中定义和声明的变量？

> ID：11783435
> 
> 赞同：17
> 
> 时间：2012-08-02T18:18:05.497
> 
> 标签：c++, scope

谁能告诉我如何访问在另一个函数中的函数中声明和定义的变量。例如

```
void function1()
{
   string abc;
}

void function2()
{
   I want to access abc here.
} 
```

怎么做？我知道使用参数我们可以做到这一点，但还有其他方法吗？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-08-02T18:21:31.123

C++ 方法是`abc`通过引用传递给您的函数：

```
void function1()
{
    std::string abc;
    function2(abc);
}
void function2(std::string &passed)
{
    passed = "new string";
} 
```

您也可以将您的字符串作为指针传递并在函数 2 中取消引用它。这更像是 C 风格的做事方式，并不安全（例如，可以传入 NULL 指针，如果没有良好的错误检查，它将导致未定义的行为或崩溃。

```
void function1()
{
    std::string abc;
    function2(&abc);
}
void function2(std::string *passed)
{
    *passed = "new string";
} 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2012-08-02T18:24:54.557

使其成为全球性的，然后双方都可以操纵它。

```
string abc;

void function1(){
    abc = "blah";
} 

void function2(){
    abc = "hello";
} 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2012-08-02T18:35:00.587

如果您想在 function2 中使用 function1 中的变量，那么您必须：

1.  直接通过，
2.  有一个更高范围的函数，它调用声明变量并传递它，或者
3.  将其声明为全局，然后所有函数都可以访问它

如果你的function2是从function1调用的，那么你可以将它作为参数传递给function2。

```
void function1()  
{  
    std::string abc;  
    function2( abc );  
}  

void function2( std::string &passed )   
{   
    // function1::abc is now aliased as passed and available for general usage.
   cout << passed << " is from function1.";   
} 
```

如果 function1 没有调用 function2，但两者都被 function3 调用，则让 function3 声明变量并将其作为参数传递给 function1 和 function2。

```
void parentFunction( )
{
    std::string abc;  
    function1( abc );  
    function2( abc );  
}
void function1( std::string &passed )   
{   
   // Parent function's variable abc is now aliased as passed and available for general usage.
   cout << passed << " is from parent function.";   
}   
void function2( std::string &passed )   
{   
    // Parent function's variable abc is now aliased as passed and available for general usage.
   cout << passed << " is from parent function.";   
} 
```

最后，如果 function1 和 function2 都没有被相互调用，也没有被代码中的同一个函数调用，那么声明该变量为全局共享，function1 和 function2 就可以直接使用它。

```
std::string global_abc;  
void function1( )   
{   
   cout << global_abc << " is available everywhere.";   
}   
void function2( )   
{   
   cout << global_abc << " is available everywhere.";   
} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-08-02T18:20:12.547

绝对没有办法。块的变量只能从该块直接访问。

指向对象的指针/引用可以作为参数传递到从此块调用的函数中。

# ios - 带计时器的 UIButton

> ID：11783439
> 
> 赞同：0
> 
> 时间：2012-08-02T18:18:24.577
> 
> 标签：ios, object, uiview

我想创建一个带有计时器的 UIButton，如附图所示。我该怎么做？将 MBProgressHUD 添加到 UIButton 有帮助吗？

[![位智](../Images/70315887b6e5c81c1b19232462a53d45.png)](https://i.stack.imgur.com/M9Hsi.png)
[（来源：[efytimes.com](http://www.efytimes.com/admin/useradmin/rte/my_documents/my_pictures/CA6_Waze3.PNG)）]

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-02T19:03:55.550

我可以向你展示如何绘制代表计时器的圆圈，我相信你可以从那里得到它。这是代码：

**定时器按钮.h**

```
#import <UIKit/UIKit.h>

@interface TimerButton : UIView
{
    float currentAngle;
    float currentTime;
    float timerLimit;
    NSTimer *timer;
}

@property float currentAngle;

-(void)stopTimer;
-(void)startTimerWithTimeLimit:(int)tl;

@end 
```

**定时器按钮.m**

```
#import "TimerButton.h"

@implementation TimerButton

#define DEGREES_TO_RADIANS(degrees)  ((3.14159265359 * degrees)/ 180)
#define TIMER_STEP .01

@synthesize currentAngle;

- (id)initWithFrame:(CGRect)frame
{
    self = [super initWithFrame:frame];
    if (self)
    {
        self.backgroundColor = [UIColor clearColor];

        currentAngle = 0;

    }
    return self;
}

- (void)drawRect:(CGRect)rect
{
    UIBezierPath* aPath = [UIBezierPath bezierPathWithArcCenter:CGPointMake(50, 50)
                                                         radius:45
                                                     startAngle:DEGREES_TO_RADIANS(0)
                                                       endAngle:DEGREES_TO_RADIANS(currentAngle)
                                                      clockwise:YES];
    [[UIColor redColor] setStroke];
    aPath.lineWidth = 5;
    [aPath stroke];
}

-(void)startTimerWithTimeLimit:(int)tl
{
    timerLimit = tl;
    timer = [NSTimer scheduledTimerWithTimeInterval:TIMER_STEP target:self selector:@selector(updateTimerButton:) userInfo:nil repeats:YES];
}

-(void)stopTimer
{
    [timer invalidate];
}

-(void)updateTimerButton:(NSTimer *)timer
{
    currentTime += TIMER_STEP;
    currentAngle = (currentTime/timerLimit) * 360;

    if(currentAngle >= 360) [self stopTimer];
    [self setNeedsDisplay];
}

@end 
```

试一试，如果您需要进一步解释，请告诉我。

# php - 从更多数组中选择唯一值

> ID：11783444
> 
> 赞同：2
> 
> 时间：2012-08-02T18:18:42.873
> 
> 标签：php, mysql, sql

我有以下代码：

```
$get_countries = "SELECT country FROM blahs WHERE country IS NOT NULL ORDER BY country";
$data_get_countries = mysqli_query($dbc, $get_countries);

while ($row_get_countries = mysqli_fetch_array($data_get_countries)) {
    $country_tabs = array_unique($row_get_countries);
    foreach ($country_tabs as $country_tab) {
        echo '<div>' . $country_tab . '</div>';
        var_dump($country_tab);
        var_dump($country_tabs);

    }
} 
```

现在 var_dump($country_tab) 输出：

```
string 'DE' (length=2)
string 'GB' (length=2)
string 'SE' (length=2)
string 'US' (length=2)
string 'US' (length=2)
string 'US' (length=2)
string 'US' (length=2) 
```

和 var_dump($country_tabs)：

```
array
    0 => string 'DE' (length=2)
array
    0 => string 'GB' (length=2)
array
    0 => string 'SE' (length=2)
array
    0 => string 'US' (length=2)
array
    0 => string 'US' (length=2)
array
    0 => string 'US' (length=2)
array
    0 => string 'US' (length=2) 
```

我想要实现的目标是让我的代码不显示相同的国家！array_unique($country_tabs) 不起作用，因为我在输出中有更多数组。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-02T18:22:23.283

采用`SELECT DISTINCT country FROM blahs WHERE country IS NOT NULL ORDER BY country`

它将删除每个重复的值。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-02T18:21:27.073

您最好像这样在数据库查询中获取唯一值：

```
SELECT DISTINCT country FROM blahs WHERE country IS NOT NULL ORDER BY country 
```

请注意，我添加了 DISTINCT 关键字来执行您要执行的操作。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-02T18:21:47.147

修改您的查询以仅获取唯一的国家/地区：

```
$get_countries = "SELECT DISTINCT country FROM blahs WHERE country IS NOT NULL ORDER BY country"; 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-08-02T18:22:28.623

使用 mysql 查询获取唯一国家：

```
SELECT country 
FROM blahs 
WHERE country IS NOT NULL
GROUP BY country
ORDER BY country 
```

这样优化多了！

# css - SCSS（sass）计算：#{}

> ID：11783451
> 
> 赞同：12
> 
> 时间：2012-08-02T18:19:10.103
> 
> 标签：css, sass

在计算字体大小时，我现在很困惑

这是我已经使用的正常计算。

`font-size: #{($font-size*0.7) / $em}em`

我现在想做的就是将上面的整个陈述与另一个陈述分开……我知道这听起来很复杂。

所以我有`#{($font-size*0.7) / $em}` 我有`#{($font-size*0.8125) / $em}`

我现在想将这两个值分开……</p>

所以`font-size: #{($font-size*0.7) / $em} / #{($font-size*0.8125) / $em}em`。

但这不起作用。知道如何用 SASS 进行这样的计算吗？

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2012-08-02T22:41:19.397

尝试：

```
font-size: #{(($font-size*0.7) / $em) / (($font-size*0.8125) / $em)}em 
```

插值回字符串`#{...}`应该是计算后完成的最后一件事。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-08-02T23:49:16.210

*ScottS 的回答在技术上*似乎是正确的，但为什么你首先需要这么复杂的表达式呢？表示为分数，这可以简化为

```
($font-size * 0.7 / $em) / ($font-size * 0.8125 / $em) = 0.7 / 0.8125 
```

你的最终表达是

```
font-size: #{(0.7/0.8125)}em 
```

……不是吗？

# javascript - JSON对象创建错误

> ID：11783453
> 
> 赞同：3
> 
> 时间：2012-08-02T18:19:15.107
> 
> 标签：javascript, jquery

我正在尝试以特定格式创建 JSON 对象

```
{ "id": 12234 , "name": "Alex" , "gender": "Male"}

 // My code starts here

var number = userid;         // alert(userid) is 12345
var name=  nameuser;         // alert(nameuser)  is  Alex
var g= gender;                 // alert(gender) is male

var userObj = { "id": number , "name": name , "gender":g} 
```

我试过 `JSON.stringify(userObj); ，返回对象类型为

```
{"id":"12345" , "name":"Alex" , "gender":"Male"} 
```

但这不是我想要的，因为我希望数字是 12345 而不是“12345”。

还尝试对对象内部的字段进行字符串化，例如

```
{ "id": number , "name":JSON.stringify(name) ,gender: JSON.stringify(g)} 
```

但是当我做`alert(userObj)`我的对象类型时`Object object`，这不是服务器识别的格式。我确信有一个解决方法，但我无法弄清楚

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-02T18:22:45.697

JSON 仅适用于字符串。JSON 中除了字符串、数组或其他 JSON 对象之外的任何内容都是无效的。也就是说，不允许使用“数字”；它必须是一个字符串。如有必要，您以后使用 JSON 的任何内容都需要能够将字符串更改回数字。JavaScript 通常在强制这些方面做得很好。

在服务器端，您可以执行类似的操作

```
obj = json_decode(source)
obj.id = (int)obj.id 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-02T19:10:20.217

将对象类型存储为属性之一，并使用它来转换您想要的方式。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-02T19:02:06.857

您问题中的以下代码是有效的 JSON。

```
{ "id": 12234 , "name": "Alex" , "gender": "Male"} 
```

我猜您遇到的问题是您的 userid 变量是一个字符串，而不是一个数字。如果是这样，请尝试

```
var number = parseInt(userid, 10); 
```

（参数 10 表示您使用的是基数为 10 的数字，而不是二进制或十六进制之类的数字）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-02T18:54:37.503

我认为你的解决方案将归结为你想用 JSON 做什么，而不是你希望它的格式。

如果您在其他 JavaScript 代码中使用它，那么 JSON.parse 方法将在另一端处理您的大部分问题（自动类型转换处理其余问题）。

如果您在服务器端使用它，PHP 或类似的工具会适当地解码对象。

如果它在您的服务器上是一种更严格的语言，您需要做的就是记住哪些参数需要转换为布尔值或 int/float。

# iphone - 平铺作为纹理图集一部分的图像

> ID：11783454
> 
> 赞同：1
> 
> 时间：2012-08-02T18:19:20.417
> 
> 标签：iphone, ios, opengl-es, cocos2d-iphone, texturepacker

我正在使用 Cocos2D。当图像是使用 Texture Packer 生成的纹理图集的一部分时，平铺图像的最有效方法是什么。我有一个 10 x 320 的图像，我想平铺它以填充屏幕。

我以前用过这段代码来平铺图像

```
bgHolder = [CCSprite spriteWithFile:@"bg.png" rect:CGRectMake(0, 0, 700, 300*155)];
ccTexParams params = {GL_LINEAR,GL_LINEAR,GL_REPEAT,GL_REPEAT};
[bgHolder.texture setTexParameters:&params];
[self addChild:bgHolder]; 
```

但是当我想要平铺的图像不是正方形并且只是整体纹理的一小部分时，我认为我不能使用这种方法。

链接一堆 CCSprite 对我来说似乎效率很低，所以我希望有更好的方法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-02T20:49:36.177

每个图块使用一个精灵。这就是这样做的方法。您应该使用精灵批处理来保持绘制调用的数量为 1。使用精灵批处理时渲染 48 个精灵并不比渲染一个 480x320 精灵差多少。

# c# - 在 C#.NET 中运行 cmd 命令

> ID：11783456
> 
> 赞同：-2
> 
> 时间：2012-08-02T18:19:26.267
> 
> 标签：c#

我正在尝试在 C# 的 Windows 应用程序中运行 cmd 命令。我的代码是，

```
 progressBar1.Show();
    progressBar1.Minimum = 0;
    progressBar1.Maximum = 100;
    progressBar1.Step = 1;

    ProcessStartInfo ProcessInfo; 
    Process Process;

    for (int i = 0; i < 300000; i++)
    {
        progressBar1.PerformStep();
        int percent = (int)(((double)progressBar1.Value/(double)progressBar1.Maximum) * 100);
        progressBar1.CreateGraphics().DrawString(percent.ToString() + "%", new Font("Arial",(float)7.02,FontStyle.Regular),Brushes.Black, new Point(progressBar1.Width / 2 - 10, progressBar1.Height / 2 -7));

        ProcessInfo = new ProcessStartInfo(command);
        ProcessInfo.RedirectStandardOutput = true;
        ProcessInfo.CreateNoWindow = true;
        ProcessInfo.UseShellExecute = false;

        Process = Process.Start(ProcessInfo);                    

        Process.Close();                    
    }
    progressBar1.Hide(); 
```

问题是，如果我在命令提示符中运行命令；它会在几秒钟内安装驱动程序，但如果我在 C# 中运行该命令，它就不起作用。

谁能解释一下，我是否缺少任何代码？

命令是

```
ExecuteCommand("\"C:\\Disk1.Win7\\setup.exe\" /s /f1\"C:\\Disk1.Win7\\setup_install.iss\" /a\"C:\\Disk1.Win7\\OposData.reg\""); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-02T18:50:23.457

从小处着手，编写一个启动该命令一次的程序，然后不关闭它，而是坐在那里等待用户输入。

在此工作之后，考虑使用类似于[后台工作者](http://msdn.microsoft.com/en-us/library/cc221403%28v=VS.95%29.aspx)的东西来为您的代码添加响应性和结构。您可以使用[HasExited](http://msdn.microsoft.com/en-us/library/system.diagnostics.process.hasexited.aspx)属性来监视进程的生命周期。

然后考虑使用 FileInfo 和 DirectoryInfo 类来指定参数，而不是硬编码路径和文件名。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-02T18:53:06.647

考虑移动运行 COMAMND 的代码，

```
ProcessInfo = new ProcessStartInfo(command);
    ProcessInfo.RedirectStandardOutput = true;
    ProcessInfo.CreateNoWindow = true;
    ProcessInfo.UseShellExecute = false;

    Process = Process.Start(ProcessInfo);                    

    Process.Close(); 
```

在那个“for”循环之外。添加一个运行驱动程序安装程序的 WHILE 循环，其中嵌入了 for 循环。

这可能会解决您的问题。您走在正确的轨道上，只需考虑稍微调整一下即可。正如 Alvin 和其他一些人所说，您的 COMMAND 只被处理了 3 毫秒，然后它被关闭并重新启动；最多300000次。东西只需要四处移动。

# node.js - 使用 mongoDb + nodeJs 更新嵌套文档

> ID：11783460
> 
> 赞同：0
> 
> 时间：2012-08-02T18:19:55.703
> 
> 标签：node.js, mongodb

我有这样的结构：

```
{
    "_id" : ObjectId("501abaa341021dc3a1d0c70c"),
    "name" : "prova",
    "idDj" : "1",
    "list" : [
        {
            "id" : 1,
            "votes" : 2
        },
        {
            "id" : 2,
            "votes" : 4
        }
    ]
} 
```

我正在尝试通过此查询增加选票：

```
session_collection.update(
 {'_id':session_collection.db.bson_serializer.ObjectID.createFromHexString(idSession),'list.id':idSong},
 {$inc:{'list.$.votes':1}},
 {safe: true} ,
 callback); 
```

但它不起作用，没有问题，它只是不更新​​任何东西。

我认为这是因为 'list.id' 和 'list.$.votes' 上的 ['] （简单引号），因为终端内的相同查询可以完美运行。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-03T17:30:09.263

我怀疑您的匹配没有按您的预期工作。回调将返回

函数（错误，更新的项目数，整体更新对象）

如果匹配成功，numberofItemsUpdated 应该等于 1。您需要检查 idSession 和 idSong 是否是您认为的那样。

# regex - 需要一个字母数字的正则表达式，其中存在 1 个连字符，单词之间有空格

> ID：11783463
> 
> 赞同：1
> 
> 时间：2012-08-02T18:20:08.130
> 
> 标签：regex

你能给我提供一个正则表达式吗？

*   只允许字母数字
*   整个字符串中肯定只有一个连字符
*   字符串前后不允许使用连字符或空格
*   不允许使用连续的空格或连字符。
*   hypen 和一个空格可以彼此靠近

有效 - "123-Abc test1","test- m e","abc slkh-hsds"
无效 - "abc", "-hsdj sdsd hjds-"

谢谢你帮助我。非常感谢您的帮助

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-02T18:28:06.393

```
/^([a-zA-Z0-9] ?)+-( ?[a-zA-Z0-9])+$/ 
```

在此处查看[演示](http://rubular.com/r/wWMJ7eRE6L)。

**编辑：**

*如果连字符的两边*不能有空格，则需要多一点：

```
/^([a-zA-Z0-9] ?)+-(((?<! -) )?[a-zA-Z0-9])+$/
                    ^^^^^^^^ ^ 
```

或者，如果不支持否定的后向断言（例如在 JavaScript 中），则使用等效的正则表达式：

```
/^([a-zA-Z0-9]( (?!- ))?)+-( ?[a-zA-Z0-9])+$/
              ^ ^^^^^^^ ^ 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-02T18:32:52.197

1.  只有字母数字（包括连字符和空格，否则没有意义）：

    ```
    ^[\da-zA-Z -]+$ 
    ```

    这是匹配字符串并确保每个字符都在给定集中的主要部分。即数字和ASCII字母以及空格和连字符（以下部分限制使用）。

2.  字符串的开头或结尾只有一个连字符且没有：

    ```
    (?=^[^-]+-[^-]+$) 
    ```

    这是一个先行断言，确保字符串以至少一个非连字符字符开始和结束。中间需要一个连字符。

3.  开头或结尾或字符串中没有空格：

    ```
    (?=^[^ ].*[^ ]$) 
    ```

    再次向前看，类似于上面的。它们可以合二为一，但看起来更混乱，也更难解释。

4.  没有连续的空格（连续的连字符已经被上面的 2\. 排除了）：

    ```
    (?!.*  ) 
    ```

把它们放在一起：

```
(?!.*  )(?=^[^ ].*[^ ]$)(?=^[^-]+-[^-]+$)^[\da-zA-Z -]+$ 
```

快速 PowerShell 测试：

```
PS> $re='(?!.*  )(?=^[^ ].*[^ ]$)(?=^[^-]+-[^-]+$)^[\da-zA-Z -]+$'
PS> "123-Abc test1","test- m e","abc slkh-hsds"," abc ", " -hsdj sdsd hjds- " -match $re
123-Abc test1
test- m e
abc slkh-hsds 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-02T18:25:13.250

使用这个正则表达式：

```
^(.+-.+)[\da-zA-Z]+[\da-zA-Z ]*[\da-zA-Z]+$ 
```

# c# - 如何防止自定义活页夹中的 MVC3 输入验证？

> ID：11783468
> 
> 赞同：0
> 
> 时间：2012-08-02T18:20:34.453
> 
> 标签：c#, asp.net-mvc-3

编辑：

在这里找到答案：[ASP.NET MVC 3 ValidateRequest(false) not working with FormCollection](https://stackoverflow.com/questions/4361907/asp-net-mvc-3-validaterequestfalse-not-working-with-formcollection)

原来我需要添加`System.Web.Helpers`，所以我可以`Unvalidated()`在 Request 对象上使用扩展方法。这为您提供了一个不会在看起来不安全的输入上引发异常的请求。

--

所以这是我的问题发生的背景：

*   我有一个模型类，其中包含一组子对象
*   我编写了一个构造函数，它将解析 FORM 输入，以便我可以将模型发布到操作方法
*   我已经设置了一个活页夹，它从发布的请求中获取 Form 对象并将其传递给我的模型的构造函数

由于某些子对象可以接受可能包含 HTML 的字符串输入，因此我需要禁用 MVC 的输入验证。我已经`[ValidateInput(false)]`在 action 方法上设置了一个属性，但`HttpRequestValidationException`仍然被抛出在我的模型的构造函数中。一时兴起，我什至尝试`[ValidateInput]`在模型的活页夹和模型本身上添加一个属性，但这也没有解决问题。

我在这里不知所措。我该如何处理这些异常，以便我仍然可以从表单中提取信息？或者，在这种情况下禁用 MVC 输入验证的适当方法是什么？

课堂草图如下：

```
public class FooController : ControllerBase {
  [HttpPost]
  [ValidateInput(false)]
  public ActionResult FooAction(FooModel model) { //do stuff; }
}

//tried [ValidateInput(false)] here as well, to no avail
public class FooBinder : BinderBase {
  public override object BindModel(...) {
    return new FooModel(controllerContext.HttpContext.Request.Form);
  }
}

//tried [ValidateInput(false)] here, too....again, no success
public class FooModel {
  public FooModel(NameValueCollection formData) {
    //do some initialization stuff

    var keys = formData.AllKeys;  //exception thrown here when inputs contain '<' or '>'

    //do some object construction stuff
  }

  public IEnumerable<FooChid> ChildCollection { get; set; }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-02T18:27:27.113

尝试`[ValidationInput(false)]`将`[AcceptVerbs(HttpVerbs.Post)]`. 但是，如果这将成为一个公共网站，那么您就是在向 XXS 敞开心扉，这是不明智的。

# postgresql - 在 MS Access (Jet / MADB) 数据库和 PostgreSQL DB 之间进行同步，这可能吗？

> ID：11783469
> 
> 赞同：3
> 
> 时间：2012-08-02T18:20:49.203
> 
> 标签：postgresql, ms-access, backend, database-mirroring

是否可以设置 MS 访问后端数据库（Microsoft JET 或 Access 数据库引擎），以便在插入/更新条目时将这些更改^*复制到 PostgreSQL 数据库？

双向同步会很好，但一种方式是可以接受的。

我知道将两者联系起来并使用一个作为前端是很受欢迎的，但两者都必须是后端。

有什么建议么？

* * *

^*即反射、同步、镜像

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-03T00:33:43.237

您可以使用[Microsoft SQL Server Express Edition](http://www.microsoft.com/sqlserver/en/us/editions/2012-editions/express.aspx)吗？还是必须使用[Microsoft Access Database Engine](http://www.microsoft.com/en-us/download/details.aspx?id=13255)？使用 MS SQL express 可能会有更多选项，例如更完整的触发器和日志记录。

无论哪种方式，您都需要一种方法来从源数据库引擎累积更改行的日志，以及通过读取日志并将其转换为合适的 PostgreSQL和`INSERT`语句来将它们同步到 PostgreSQL 的程序。`UPDATE``DELETE`

您可以通过让 MADB/Express 中的审计触发器在每个“真实”表更改时将一行插入审计影子表中来实现这一点，包括插入特殊的“行已删除”审计条目。然后您的同步程序可以连接到 MADB/Express，读取审计表，将更改应用到 PostgreSQL，并清空审计表。

如果您找到开箱即用的方法，我会感到惊讶。这是 Microsoft SQL Server 具有很大优势的一个领域，因为所有深度 Access 和 MADB 引擎集成都支持同步和集成功能。

有一些 ETL（“提取、转换、加载”）工具可能会有所帮助，例如[Pentaho](http://www.pentaho.com/)和[Talend](http://www.talend.com/resource/etl.html)。我不知道您是否可以使用它们实现所需的自动化程度。

# backbone.js - 将 Backbone 应用程序与 Parse.com 和 Meteor 集成

> ID：11783470
> 
> 赞同：2
> 
> 时间：2012-08-02T18:20:49.380
> 
> 标签：backbone.js, meteor, parse-platform

我有一个在 Parse.com 上运行的 Backbone 应用程序，我想将它集成到 Meteor 中。我这样做的主要原因是因为使用 Parse.com javascript SDK 你的密钥被暴露了，我试图隐藏它们并直接呈现内容。这甚至可能吗？javascript SDK可以在服务器上运行吗？

我刚开始使用 Meteor，它看起来很有希望，但我很难理解它的工作原理以及是否可以将它集成到 Parse.com 中托管的数据库中，该数据库拥有自己的自定义对象和方法。

在这种情况下，例如：

```
Step = new Meteor.Collection("step"); 
```

这些数据是从流星中的 mongoDB 提供的，是否可以从 Parse.com 提供它？

加起来：

1.  是否可以在服务器上运行 Parse.com javascript SDK 并访问它们的对象？

2.  如果 question1 == true，我如何将提供给 Meteor.Collections 的内容从 MongoDB 替换为我的 Parse 对象。

任何想法将不胜感激。

# iphone - 随机显示数组中的字符串，仅一次，并且每天更改

> ID：11783476
> 
> 赞同：0
> 
> 时间：2012-08-02T18:20:55.787
> 
> 标签：iphone, string, random, plist

我正在开发一个报价应用程序，并且我有我的 plist 设置，并且 plist 中的每个字符串都代表它自己的报价。有什么方法可以让我的一个视图中的 TextView 显示一个引号，并在每天午夜更改它，然后将字符串标记为已使用，这样它就不会重复它，并继续以随机顺序进行?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-02T18:27:49.200

`NSMutableSet`更新：我之前提到的答案`NSMutableArray`可能更符合您的要求。

*保留未使用*字符串的索引数组（您需要将其持久存储，例如在 中`NSUserDefaults`）。您可以在循环中初始化它，并用所有引号的索引填充它。所以如果你有 200 这个数组将有 200 个元素 [0..199]。每天或在适当的时候，从该数组中选择一个随机索引，将其用作当天报价的索引。从数组中删除它并将修改后的数组写回您的`NSUserDefaults`. 当数组的元素为零时，将使用所有索引重新填充。签出`NSUserDefaults`，`NSMutableArray`和`arc4random`。

例如，假设您有 5 个引号。

```
第 1 天：
  未使用的报价 = [ 0, 1, 2, 3, 4 ];
  随机选择索引 2。
  usedQuotes[2] 是 2 所以显示 quote[2] 并从数组中删除 usedQuotes[2]

第 2 天：
  未使用的报价 = [ 0, 1, 3, 4 ];
  随机选择索引 3。
  usedQuotes[3] 是 4 所以显示 quote[4] 并从数组中删除 usedQuotes[4]

第 3 天：
  未使用的报价 = [ 0, 1, 3];
  ...
  等等

```

您还应该保存选择报价的日期。当用户再次使用您的应用程序时，如果它是同一日期，请不要选择新的报价。如果他们的日子不同，只选择一个新的报价。这样您就不会错过报价或在某一天显示多个报价。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-02T18:28:44.863

您可以更新您的 plist 以删除引号或设置已使用的标志，然后将其排除在选择之外。

至于何时将其标记为已使用。我不确定每天午夜是否适用于您的模型如果它真的是随机的，那么将它们标记为在午夜使用并没有多大意义，因为他们可能不会每天都打开应用程序并且会错过随机报价。就好像它被订购一样，每天都会有一个报价。

从 OP 编辑​​：
在 AppDelegate didFinishLaunch 我添加了以下代码：

```
NSUserDefaults *defaults = [NSUserDefaults standardUserDefaults];

if (! [defaults boolForKey:@"notFirstRun"]) {

    [defaults setBool:YES forKey:@"notFirstRun"];

    [defaults setInteger:0 forKey:@"verseKey"];
    [defaults synchronize];
}
NSTimeInterval date = [defaults doubleForKey:@"startTimeInterval"];

NSTimeInterval dateNow = [NSDate timeIntervalSinceReferenceDate];

NSTimeInterval difference = dateNow - date;

difference = difference / 84000;

if(difference >= 0 && difference <= 1) {

}   

if(difference >= 1 ) {
    NSLog(@"ITSMORE");
    NSInteger savedIndex = [[NSUserDefaults standardUserDefaults] integerForKey:@"verseKey"];
    savedIndex +=1;
    if (savedIndex == 200) {
        [defaults setInteger:0 forKey:@"verseKey"];
        dateNow = [NSDate timeIntervalSinceReferenceDate];
        [defaults setDouble:dateNow forKey:@"startTimeInterval"];
        [defaults synchronize];
    }
    else {
    [defaults setInteger:savedIndex forKey:@"verseKey"];
    dateNow = [NSDate timeIntervalSinceReferenceDate];
    [defaults setDouble:dateNow forKey:@"startTimeInterval"];
    [defaults synchronize];
    }
} 
```

我相信这段代码应该在 firstRun 上将 verseKey 的值设置为 0 并将其与 NSUserDefaults 同步。然后，每次启动时，都会查看是否超过 24 小时。如果有，那么它会将 1 加到 verseKey 的键上，直到达到 200（我总共有 200 个引号）。一旦 200 被击中，它将重置为 0。然后我将 TextView 设置为 objectAtIndex:key for verses，这样它就会改变。听起来对吗？

# php - 在 Wordpress 页面的特定位置显示 sysdate + 7

> ID：11783477
> 
> 赞同：2
> 
> 时间：2012-08-02T18:20:57.270
> 
> 标签：php, wordpress

我有一个 wordpress 网站，我正在销售一个 7 天免费试用的产品。在登陆页面上，我想告诉他们他们今天不会收费，而是从今天起 7 天显示实际。

如何做到这一点？请帮忙。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-02T19:36:33.573

使用 strtotime 函数创建所需的时间窗口。

```
echo date("d-M-Y",strtotime("+7 days")); 
```

# c# - 列表上的异步函数

> ID：11783479
> 
> 赞同：5
> 
> 时间：2012-08-02T18:21:13.910
> 
> 标签：c#, async-await, c#-5.0

我有一个看起来像这样的函数：

```
public async Task<decimal> GoToWeb(string Sym){} 
```

通过字符串列表调用它的最佳方法是什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-02T18:27:58.770

[这是](http://msdn.microsoft.com/en-us/library/hh696703%28v=vs.110%29.aspx)来自 MSDN 的一篇关于使用`async-await`并行处理 multilpe 任务的文章。这[是](http://msdn.microsoft.com/en-us/library/hh556530%28v=vs.110%29.aspx)另一个专门解决一系列任务的问题。

简而言之，您可以执行以下操作之一：

1.  开始你的所有任务，然后开始`await`每个任务。它们都将并行运行，一旦它们全部完成，您的程序将继续运行。

2.  将您的任务放入一个集合中，然后用于`await`[`Task.WhenAll`](http://msdn.microsoft.com/en-us/library/hh160374%28v=VS.110%29.aspx)等待多个任务。

第二种方法的示例如下：

```
List<string> Syms = ... // Create your list of strings
IEnumerable<Task<decimal>> tasks = from Sym in Syms select GoToWeb(Sym);
decimal[] results = await Task.WhenAll(tasks); 
```

# c++ - 尝试使用 cmake 编译代码时未定义的引用

> ID：11783480
> 
> 赞同：0
> 
> 时间：2012-08-02T18:21:15.930
> 
> 标签：c++, boost, cmake, boost-asio

我试图了解我的 cmake 设置有什么问题。我下载了[http://alexott.net/en/cpp/BoostAsioProxy.html](http://alexott.net/en/cpp/BoostAsioProxy.html)中描述的代码。这是一个使用 boost 的异步 http 代理服务器。

这些是我的 CMakeLists.txt 的内容：

```
cmake_minimum_required(VERSION 2.4)
PROJECT(asio-proxy-async)

# Usage: 
#   cmake . -DCMAKE_INCLUDE_PATH=~/exp/include -DCMAKE_LIBRARY_PATH=~/exp/lib
#

SET(CMAKE_VERBOSE_MAKEFILE ON)

SET (CMAKE_MODULE_PATH ${cpptests_SOURCE_DIR}/cmake CACHE PATH "local cmake")

ADD_DEFINITIONS(-g -Wall -ansi -Wno-deprecated)

SET(Boost_USE_STATIC_LIBS OFF)
SET(Boost_USE_MULTITHREAD ON)
FIND_PACKAGE(Boost 1.49.0 REQUIRED COMPONENTS filesystem system thread regex)
MESSAGE(STATUS "** Boost Include: ${Boost_INCLUDE_DIR}")
MESSAGE(STATUS "** Boost Libraries: ${Boost_LIBRARIES}")
IF(Boost_FOUND)
  INCLUDE_DIRECTORIES(${Boost_INCLUDE_DIRS})
        LINK_DIRECTORIES(${Boost_LIBRARY_DIRS})
ENDIF(Boost_FOUND)

SET(USED_LIBS ${Boost_SYSTEM_LIBRARY} ${Boost_THREAD_LIBRARY} ${Boost_REGEX_LIBRARY})

ADD_EXECUTABLE(asio-proxy-async proxy.cpp proxy-server.cpp proxy-conn.cpp)
TARGET_LINK_LIBRARIES(asio-proxy-async ${USED_LIBS}) 
```

在我输入 cmake 之后。3个源文件编译得很好，但是在链接阶段，我得到了这个：

```
Linking CXX executable asio-proxy-async
/usr/bin/cmake -E cmake_link_script CMakeFiles/asio-proxy-async.dir/link.txt --verbose=1
/usr/bin/c++      CMakeFiles/asio-proxy-async.dir/proxy.o CMakeFiles/asio-proxy-async.dir/proxy-server.o CMakeFiles/asio-proxy-async.dir/proxy-conn.o  -o asio-proxy-async -rdynamic -lboost_system-mt -lboost_thread-mt -lboost_regex-mt 
CMakeFiles/asio-proxy-async.dir/proxy.o: In function `__static_initialization_and_destruction_0':
/usr/local/include/boost/system/error_code.hpp:214: undefined reference to `boost::system::generic_category()'
/usr/local/include/boost/system/error_code.hpp:215: undefined reference to `boost::system::generic_category()'
/usr/local/include/boost/system/error_code.hpp:216: undefined reference to `boost::system::system_category()'
CMakeFiles/asio-proxy-async.dir/proxy.o: In function `error_code':
/usr/local/include/boost/system/error_code.hpp:315: undefined reference to `boost::system::system_category()'
CMakeFiles/asio-proxy-async.dir/proxy.o: In function `boost::asio::error::get_system_category()':
/usr/local/include/boost/asio/error.hpp:216: undefined reference to `boost::system::system_category()'
CMakeFiles/asio-proxy-async.dir/proxy.o: In function `thread_exception':
/usr/local/include/boost/thread/exceptions.hpp:49: undefined reference to `boost::system::system_category()'
CMakeFiles/asio-proxy-async.dir/proxy.o: In function `condition_error':
/usr/local/include/boost/thread/exceptions.hpp:82: undefined reference to `boost::system::system_category()'
CMakeFiles/asio-proxy-async.dir/proxy-server.o: In function `__static_initialization_and_destruction_0':
/usr/local/include/boost/system/error_code.hpp:214: undefined reference to `boost::system::generic_category()'
/usr/local/include/boost/system/error_code.hpp:215: undefined reference to `boost::system::generic_category()'
/usr/local/include/boost/system/error_code.hpp:216: undefined reference to `boost::system::system_category()'
CMakeFiles/asio-proxy-async.dir/proxy-conn.o: In function `__static_initialization_and_destruction_0':
/usr/local/include/boost/system/error_code.hpp:214: undefined reference to `boost::system::generic_category()'
/usr/local/include/boost/system/error_code.hpp:215: undefined reference to `boost::system::generic_category()'
/usr/local/include/boost/system/error_code.hpp:216: undefined reference to `boost::system::system_category()'
collect2: ld returned 1 exit status
make[2]: *** [asio-proxy-async] Error 1
make[2]: Leaving directory `/home/nelsonrp/workspace/boost-test/asio-proxy-async'
make[1]: *** [CMakeFiles/asio-proxy-async.dir/all] Error 2
make[1]: Leaving directory `/home/nelsonrp/workspace/boost-test/asio-proxy-async'
make: *** [all] Error 2 
```

我在 SO 中看到了几篇关于 cmake 和 boost 的此类问题的帖子，但没有一个给出最终答案。为了更清楚地说明问题，让我指出，如果我这样做：

```
g++ -g -Wall -c proxy.cpp
g++ -g -Wall -c proxy-conn.cpp
g++ -g -Wall -c proxy-server.cpp
g++ proxy.o proxy-server.o proxy-conn.o -o asio-proxy-async -lboost_system -lboost_thread -lboost_regex -lboost_filesystem 
```

源代码编译得很好，这意味着我已经安装了 boost 并且它在正确的位置，问题似乎出在 cmake 上。有什么建议么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-02T19:04:26.253

The source code archive available on the page ships with its own outdated version of the `FindBoost.cmake` module. Remove the outdated module file, whose path is `asio-proxy-async/cmake/FindBoost.cmake`, then re-create your build folder and run `cmake` again. This will make CMake use the standard `FindBoost` module which should have no problems finding your existing Boost installation.

# php - 使用 php 强制下载受限 zip 文件

> ID：11783481
> 
> 赞同：2
> 
> 时间：2012-08-02T18:21:17.113
> 
> 标签：php, .htaccess, paypal

嗨，我让用户使用贝宝购买隐藏的虚拟 mov.zip 文件。我得到了交易部分并将详细信息存储在数据库等中......但是在用户返回交易页面后，我想将它们链接到受限文件夹中的压缩文件（.htaccess 拒绝所有）。我如何授予他们访问此目录的权限以下载文件几天。我无法暂时将文件移出目录，因为它非常大（它是一个高清动作效果包）。

谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-02T18:26:29.567

如果您的主机允许您更改脚本超时的 PHP 设置，您可以通过检查用户访问的 PHP 脚本流式传输文件。

例如，请求：

**>http://domain.com/download.php?file=be6bc64c94bbc062bcebfb40b4f93304**

```
<?php
session_start();

if (!isset($_GET['file']) header('Location: index.php'); // invalid request

// 1\. check user session
...
// 2\. get file from hash (use a Db like MySQL
$file = ...;

// 3\. check user privilege for the given file
...

// 4\. proceed to download
if (file_exists($file)) {
    set_time_limit(0);
    header('Content-Description: File Transfer');
    header('Content-Type: application/octet-stream');
    header('Content-Disposition: attachment; filename='.basename($file));
    header('Content-Transfer-Encoding: binary');
    header('Expires: 0');
    header('Cache-Control: must-revalidate');
    header('Pragma: public');
    header('Content-Length: ' . filesize($file));
    ob_clean();
    flush();
    readfile($file);
    exit;
} else {
    // error 404
} 
```

# ruby - 如何单击菜单中的所有 li 元素？

> ID：11783484
> 
> 赞同：0
> 
> 时间：2012-08-02T18:21:29.007
> 
> 标签：ruby, watir-webdriver

我正在尝试单击站点[http://watirwebdriver.com/顶部菜单上的所有链接](http://watirwebdriver.com/)

```
require 'watir-webdriver'

class Proba
  def test
    b = Watir::Browser.new
    b.goto "watirwebdriver.com"
    b.ul(:id => 'menu-watirwebdriver-menu').lis.each do |li|
      li.click
    end
  end
end

proba = Proba.new
proba.test 
```

但是有一个问题提出： [https ://gist.github.com/3239338](https://gist.github.com/3239338)

可能是什么问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-02T18:29:32.210

你所有的 li 都不可见。检查它们是否存在。

要仅单击可见 li，您可以执行以下操作：

```
 def test
    b = Watir::Browser.new
    b.goto "watirwebdriver.com"
    b.ul(:id => 'menu-watirwebdriver-menu').lis.each do |li|
      li.click if li.visible?
    end
  end 
```

# tsql - 我需要临时“存储”信息，或在查询中放入查询并插入 SQL Server 2005

> ID：11783493
> 
> 赞同：0
> 
> 时间：2012-08-02T18:21:51.160
> 
> 标签：tsql, sql-server-2005

所以我有 2 个表需要在其中插入类似的数据。它们是不同应用程序访问的员工数据库。他们是：

*   dbo_Employees
*   dbo_EmpDefaultSchedules
*   dbo_EmpUsers
*   dbo_EmpDefaultLocation

依此类推`dbo_Employees`，当您插入一行时，会自动创建主键。该列称为`EmpID`。这些不同的表中总共添加了大约 22 个不同的列。它们是诸如`FirstName`, `LastName`, `Address`,`Phone`等之类的东西，等等。

我正在尝试创建一个脚本，我可以在其中获取变量列表，一次输入它们，然后运行该脚本以一次将其添加到 4 个表中（最终 HR 将输入信息并自己创建的网页)

唯一给我带来麻烦的是`dbo_EmpDefaultSchedules`。`dbo_Employees`这是因为我需要将( ) 中的主键`EmpID`插入到`dbo_EmpDefaultSchedules`中，显然它是在脚本的第一部分运行之前创建的。我对第二部分的插入语句是这样的：

```
INSERT INTO [Database].[dbo].[EmpDefaultSchedules] (StaffCode, EmpID, LastName, FirstName, Dept, MgrStaffCode, IsMgr, PayrollStatus, PayFrequency, StdHrsWk, EmailAddress )
VALUES (@StaffCode, (select EmpID from [Database].[dbo].[Employees] WHERE StaffCode = @StaffCode), @LastName, @FirstName, @Dept, @MgrStaffCode, @IsMgr, @PayrollStatus, @PayrollFrequency, @StdHrsWk, @EmailAddress) 
```

当我这样做时，我收到此错误：

> 在这种情况下不允许子查询。只允许标量表达式。

我已经看到/读过这个： [在这种情况下不允许子查询。只允许标量表达式](https://stackoverflow.com/questions/3641068/subqueries-are-not-allowed-in-this-context-only-scalar-expressions-are-allowed)

还有这个： [MYSQL插入多个表](https://stackoverflow.com/questions/10269054/mysql-inserting-into-multiple-tables)

还有这个： [如何将 sql 查询中的值存储到变量中？](https://stackoverflow.com/questions/861712/how-do-i-store-a-value-from-a-sql-query-into-a-variable)

还有这个： [如何将 SELECT + WHERE 查询与 INSERT 查询结合起来？](https://stackoverflow.com/questions/10736506/how-do-i-combine-a-select-where-query-with-an-insert-query)

但仍然无法让它发挥作用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-02T18:30:20.437

在插入员工后，您可以使用 SCOPE_IDENTITY 将身份检索到变量中

[SCOPE_IDENTITY (Transact-SQL)](http://msdn.microsoft.com/en-us/library/ms190315%28v=sql.100%29.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-03T09:23:12.993

你可以做的是以下。

```
insert into Employees values (x,y,z)
insert into EmpDefaultSchedules (@staffcode, @@identity,....) 
```

@@identity 填充了插入的 EmpID，您可以稍后使用。如果您在员工之后和 EmpDefaultschedules 之前插入另一条记录，请确保将 @@identity 放在变量中

```
declare @EmpId int
insert into Employees values (x,y,z)
set @EmpId = @@identity
insert into EmpDefaultSchedules (@staffcode, @EmpId,....) 
```

# jquery - JQuery 嵌套排序和 Javascript

> ID：11783494
> 
> 赞同：0
> 
> 时间：2012-08-02T18:21:52.643
> 
> 标签：jquery, jquery-ui

您好，我正在研究一个 JQuery 嵌套可排序列表，我在[这里](https://github.com/mjsarfatti/nestedSortable/blob/master/jquery.mjs.nestedSortable.js)遇到了一个用于嵌套排序的插件 我可以成功拖放列表项，但是一旦拖动列表中的项目，我想进行 ajax 调用，是否可以这个用这个插件？它是否提供在拖动完成后调用 ajax 的任何选项？

我的 JS 文件是

```
$('#sortable').nestedSortable(
   {
        disableNesting: 'no-nest',
        forcePlaceholderSize: true,
        handle: 'div',
        items: 'li',
        opacity: .6,
        placeholder: 'placeholder',
        revert: 250,
        tabSize: 25,
        tolerance: 'pointer',
        toleranceElement: '> div',
        connectWith: '.sortable',
            onChange: function(serialized) {
            },
            onStop : function(){
                var element_id = $(this).attr("id");
                var parent_id = $(this).parent().attr("id");
                var prev_sibling_id = $(this).prev().attr("id");
                if(parent_id=='trash'){
                    var url = $(this).attr("patent-trash");
                    var data = {PID:element_id};
                    $.ajax({
                        type: "POST",
                        data: data,
                        url:url,
                        cache: false,
                        success: function(data) {
                            document.location.reload(true);
                        }
                    });
                }
 }); 
```

我之前使用过 onStop ，但有一些问题，我认为插件是相同的，但一些更新是在 1 个月前完成的，现在是否提供了在拖动完成后调用 ajax 的任何选项，或者有任何替代方法吗？ ?

请帮助我，我尽了我的努力

提前致谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-02T18:33:14.427

我找到了解决方案 :) 因为它与 jQuery Sortable 连接，所以所有的事件、选项和方法都在这里可用。我用了

```
 stop:function(){
  var element_id = $(this).attr("id");
            var parent_id = $(this).parent().attr("id");
            var prev_sibling_id = $(this).prev().attr("id");
            if(parent_id=='trash'){
                var url = $(this).attr("patent-trash");
                var data = {PID:element_id};
                $.ajax({
                    type: "POST",
                    data: data,
                    url:url,
                    cache: false,
                    success: function(data) {
                        document.location.reload(true);
                    }
                });
            }

  } 
```

它奏效了:)

# c++ - 安装多个程序 c++ 通过数组或其他方式获取用户输入

> ID：11783498
> 
> 赞同：0
> 
> 时间：2012-08-02T18:22:18.460
> 
> 标签：c++, arrays, input, vector

我正在编写一个 c++ 程序来安装我放在几台计算机上的某些程序。我在代码中放置了一个部分，允许用户选择他们想要的安装。我对 C++ 很生疏，所以我无法接受用户输入。我愿意接受有关更好方法的建议，我相信有几个。

```
 int allOrSelect;

std::cout << "Press 1 if you want all software, press 2 if you want to select";
std::cin >> allOrSelect;

if(allOrSelect == 1)
{
    std::cout<< "all software installing ..." <<std::endl;
}

if(allOrSelect == 2)
{
    std::cout << "Please select from the following list";
    std::cout << "software 1";
    std::cout << "software 2";
    std::cout << "software 3";
    std::cout << "software 4";
    std::cout << "Type the appropriate numbers separated by space or comma";
//this is where trouble starts
//I've tried a few different ways to take the user input
//i tried using vector array, but never got it working, but i figured there had to 
//be a simpler way.  also tried variations of cin.whatever
} 
```

如果您需要更多信息，请告诉我，并提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-02T19:02:58.727

假设用户输入是逗号分隔的值（例如，“1, 2, 3”），输入应该使用`std::istringstream`类进行标记。`std::set`用于防止重复值。

请注意，代码实际上并没有实现输入验证。

```
#include <set>
#include <iostream>
#include <sstream>

// Read the string representation:
// "1, 2, 3"
std::string input;
std::getline(std::cin, input);

// Convert to set of integers.
std::set<int> selection;
std::istringstream ss(input);
std::string softItem;

while (std::getline(ss, softItem, ','))
{
    std::stringstream stm;
    stm.str(softItem);

    int i;
    if (!(stm >> i))
    {
        // TODO: handle input error!
        std::cout << "Input error!" << std::endl;
        break;
    }
    selection.insert(i);
}

// Logic:
// The selection set contains the user selection. 
```

# java - 从地图添加到堆栈

> ID：11783506
> 
> 赞同：3
> 
> 时间：2012-08-02T18:22:40.263
> 
> 标签：java, map, stack, shortest-path

我正在为学校做一个项目，该项目要求我们找到两点之间的最短路径。基本上我使用广度优先搜索来遍历图表，然后使用地图来跟踪每个城市的前身。我的想法是，当我到达终点时，我将使用边缘地图来找出一个城市是如何到达的，并且基本上是向后工作。但是，当我尝试从地图中提取值时，我得到的只是空值，即使当我打印出内容时它表明那里有东西。如果有人可以帮助我找出问题所在，我将不胜感激。

每个城市及其邻居的输入文件内容：

```
basic
Bismark      Fargo
Minneapolis  Chicago
StPaul       Chicago
Minneapolis  StPaul
Minneapolis  Fargo
Fargo        GrandForks 
```

代码*（更正版本，因此此代码将不再出现所描述的问题）：*

```
import java.util.*;
import java.io.*;

public class BFSBasics {
    public static void main(String[] args) throws FileNotFoundException {
        Map<String, List<String>> graph = new HashMap<>();
        openFile(graph, args[0]);
        String start = args[1];
        String end = args[2];

        BFS(graph, start, end);
    }

    public static void openFile(Map<String,List<String>> graph, 
            String file) 
            throws FileNotFoundException{
        Map<String,List<String>> aGraph = new HashMap<>();
        try (Scanner scan = new Scanner(new File(file))){
            if(!scan.next().equals("basic")){
                System.err.println("File cannot be read.");
                System.exit(1);
            }else{
                while(scan.hasNext()){
                    String city1 = scan.next();
                    String city2 = scan.next();
                    addEdge(graph, city1, city2);
                    addEdge(graph, city2, city1);                   
                }   
            }   
        }
    }

    private static void addEdge(Map<String, List<String>> graph, String city1,
            String city2){
        List<String> adjacent = graph.get(city1);
        if(adjacent == null){
            adjacent = new ArrayList<>();
            graph.put(city1, adjacent);
        }
        adjacent.add(city2);
    }

    public static void BFS(Map<String, List<String>> graph, String start,
            String end) {
        boolean done = false;
                //cities that still need to be worked on
        Queue<String> work = new ArrayDeque<>();
                //cities that have already been seen
        Set<String> seen = new HashSet<>();
                //cities predecessor i.e. how it was gotten to
        Map<String, String> edges = new HashMap<>();
        LinkedList<String> path = new LinkedList<>();

        String city = start;
        work.add(start);
        while (!done && !work.isEmpty()) {
            city = work.remove();
            for (String s : graph.get(city)) {
                if (!seen.contains(s)) {
                    edges.put(s, city);
                    work.add(s);
                    seen.add(s);
                    if (s.equals(end)) {
                        done = true;
                    }
                }
            }
        }

        //Work backwards through the edges map and push onto the path stack
        path.push(end);
        String temp = edges.get(end);
        while(!temp.equals(start)){
            path.push(temp);
            temp = edges.get(path.peek()};
        }
        path.push(start);
        //print out the path
        while(!path.isEmpty()){
            System.out.println(path.pop());
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-02T18:48:08.293

您的路径构建代码有问题：

```
path.push(end);                 // push node (n - 1)
String temp = edges.get(end);   // temp = node (n - 2)
while(!temp.equals(start)){
    path.push(edges.get(temp)); // push node (n - 3) down to and including node 0
    temp = path.peek();         // temp = node (n - 3) down to and including node 0
}
path.push(start);               // push node 0 
```

所以节点 ( *n* - 2) 永远不会被推送到路径，而节点 0 将被推送两次。

但除此之外，该程序适用于我。[因此，正如Hbcdev](https://stackoverflow.com/users/705048/hbcdev)建议的那样，您确实有一个无法达到的目标。你应该检查你是否真的到达了结束节点。请注意，您的图形数据结构对有*向*图进行建模，因此如果要将输入解释为*无向*边，则必须为每行输入插入两条有向边。

另请注意，您不会将初始节点标记为可见，而当您将所有其他节点添加到队列中时，它们将被标记为可见。您也应该标记第一个。

**编辑：**
粘贴（几乎）完整的代码后，我通过以下方式对其进行了修复：

*   添加了两个通配符导入，for`java.util.*`和`java.io.*`. 通配符导入又快又脏。
*   在最后添加关闭`}`以关闭类定义。
*   `basic`在输入数据中添加了带有单词的行。`System.exit(1)`如果缺少该关键字，您确实应该这样做，而不是继续使用不一致的状态。

通过这些修改，我测试了两个城市的所有可能组合，总是按两个顺序排列，并且包括形成一个城市的路径。任何地方都没有值的证据`null`，无论是在输出中还是作为打印异常的原因。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-08-02T18:55:27.977

我在这里看到了几个可能的问题。直接原因可能是：您的逻辑隐含地假设只有一种方法可以到达任何给定节点。虽然这可能是真的，但我对此表示怀疑。如果有两种方法可以到达同一个节点，则在地图中用第二种方法覆盖第一种。

例如，假设输入是：

```
A->B
C->B
B->E
D->E 
```

您想从 A 到 E。这可以通过 A、B、E 来完成。但是当您构建地图时，您将为 B、A 创建一个边缘条目。然后您将编写 B、C，覆盖B, A. 然后你写 E, B. 很好。然后你写E，D，覆盖E，B。所以当你完成后，边缘图中的所有内容都是（B，C）和（E，D）。然后，您尝试从 E 向后走。您会找到 E，D。但这是错误的：您想要 E，B，但它被覆盖了。当你试图找到 D 的入口时，没有，所以不可能回到 A。

第二个问题是您说目标是找到从头到尾的最短路径。但是您没有做任何事情来找到最短路径：一旦找到任何路径，您就会停止寻找。原则上，您确实需要找到所有可能的路径，然后从该列表中选择最短的路径。（或者希望，以一种或另一种方式消除更长的路径。）

# html - 是否可以在 div 中垂直和水平居中文本？

> ID：11783511
> 
> 赞同：2
> 
> 时间：2012-08-02T18:23:02.107
> 
> 标签：html, css

我的意思是不使用任何其他标签......只有一个标签和它的 CSS。

所以

[http://jsfiddle.net/EqTsu/](http://jsfiddle.net/EqTsu/)

```
<style>
  #test{
      width: 100px;
      height: 100px;
      text-align: center;
      border: solid 1px #ff0000;
    }
</style>

<div id='test'>foo</div> 
```

需要什么垂直居中？

**根据下面的答案**

它需要

```
 display: table-cell;
  vertical-align: middle; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-02T18:25:04.807

有一种 hack-ish 变通方法，你先给出`<div>`属性`display: table-cell;`，然后给出`vertical-align: middle;`属性，是的。

所以完整的 CSS 将是：

```
#test{
  display: table-cell;
  vertical-align: middle;
  width: 100px;
  height: 100px;
  text-align: center;
  border: solid 1px #ff0000;
} 
```

此外，外部样式表是您的朋友。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-02T18:27:51.887

这是使用您的代码的 jsFiddle：

[http://jsfiddle.net/EqTsu/2/](http://jsfiddle.net/EqTsu/2/)

添加`display: table-cell;`将导致元素被视为表格中的单元格，然后您可以使用表格格式 CSS `vertical-align: middle;`。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-02T18:29:07.000

[了解垂直对齐，或“如何（不）垂直居中内容”](http://phrogz.net/CSS/vertical-align/index.html)

# javascript - CSS3 Javascript触发过渡动画

> ID：11783514
> 
> 赞同：1
> 
> 时间：2012-08-02T18:23:39.033
> 
> 标签：javascript, css, css-animations

我有一个 DIV 类设置如下：

```
div.map_view{
height: 420px;
transition: height 2s;
-moz-transition: height 2s; /* Firefox 4 */
-webkit-transition: height 2s; /* Safari and Chrome */
-o-transition: height 2s; /* Opera */
} 
```

目的是当我更改此 DIV 的高度时，它会为滚动设置动画（在本例中为向上）。当我在脚本中调用此函数时： `document.getElementById('map_view').style.height = '0px';`，它立即消失（不动画）。但是，如果我将其注释掉并在我的 JS 调试器中调用完全相同的行，动画就会起作用。

为什么是这样？我错过了什么导致它在我的脚本中什么都不做？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-02T18:35:51.393

我知道我已经通过使用 jquery 减少了几个角落，但这就是我得到的：

[http://jsfiddle.net/qZ6J4/7/](http://jsfiddle.net/qZ6J4/7/)

看看那个。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-02T18:57:47.357

我实际上在这里找到了一个有用的教程：[JavaScript 中的 CSS3 过渡](http://www.impressivewebs.com/css3-transitions-javascript/)。我基本上设置了我的两个 CSS3 类定义并使用 jQuery 的`.toggleClass()`函数在两者之间进行切换。

# sql - MS Access 中的模糊外部联接

> ID：11783517
> 
> 赞同：0
> 
> 时间：2012-08-02T18:24:00.113
> 
> 标签：sql, ms-access

收到此错误时尝试在其他两个连接表上创建外部连接 - 我只是看不到如何创建两个单独的查询以使其工作。子查询似乎也不起作用，任何帮助表示赞赏。我收到以下查询的错误，谢谢。

```
SELECT 
    CardHeader.CardID, CardHeader.CardDescription, CardHeader.GloveSize,     
    CardHeader.GloveDescription, CardDetail.Bin, CardDetail.ItemID, Items.ItemDescription, 
    Items.VCatalogID, CardDetail.ChargeCode, CardDetail.Quantity, Items.Cost, CardColors.ColorID
FROM
    ((Items 
INNER JOIN 
    (CardHeader INNER JOIN CardDetail ON CardHeader.CardID = CardDetail.CardID) ON Items.ItemID = CardDetail.ItemID) 
LEFT JOIN 
    CardColors ON CardDetail.ItemID = CardColors.ItemID) 
INNER JOIN 
    Colors ON CardColors.ColorID = Colors.ID
ORDER BY 
    CardHeader.CardID; 
```

我尝试了以下运行但要求以下参数（它不应该）

```
CardHeader.ID, MainQry.CardID

SELECT 
    MainQry.ID, MainQry.CardDescription, MainQry.GloveSize, 
    MainQry.GloveDescription, MainQry.Bin, MainQry.ItemID,
    MainQry.ItemDescription, MainQry.VCatalogID, MainQry.ChargeCode, 
    MainQry.Quantity, MainQry.Cost, SubQry.ColorID
FROM
    (SELECT 
         CardHeader.ID, CardHeader.CardDescription, CardHeader.GloveSize, 
         CardHeader.GloveDescription, CardDetail.Bin,
         CardDetail.ItemID, Items.ItemDescription, Items.VCatalogID, 
         CardDetail.ChargeCode, CardDetail.Quantity, Items.Cost 
     FROM 
         Items 
     INNER JOIN 
         (CardHeader 
     INNER JOIN 
         CardDetail ON CardHeader.CardID = CardDetail.CardID) ON Items.ItemID = CardDetail.ItemID
    )  AS MainQry 
LEFT JOIN 
    (SELECT 
         CardColors.ItemID, CardColors.ColorID 
     FROM 
         CardColors 
     INNER JOIN 
         Colors ON CardColors.ColorID = Colors.ID) AS SubQry ON MainQry.ItemID = SubQry.ItemID
ORDER BY 
    MainQry.CardID; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-03T13:46:28.530

第二条 SQL 语句可以通过参考第一条语句和错误来更正。错误是两者`CardHeader.ID`都`MainQry.CardID`提示输入参数，这表明内部语句应包含`CardHeader.CardID`，而不是`CardHeader.ID`

# objective-c - 带有 UIPageViewController 的 UIPanGestureRecognizer

> ID：11783518
> 
> 赞同：1
> 
> 时间：2012-08-02T18:24:01.923
> 
> 标签：objective-c, cocoa-touch

我正在使用 UIPageViewController 来显示某些内容。当用户使用 UIPanGestureRecognizer 在页面上下拉时，我希望能够显示其他内容。我似乎无法弄清楚我应该将我的手势识别器添加到什么，这样它就不会取消任何 pageviewcontroller 的操作。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-12T20:46:19.640

我开发的其中一个应用程序具有与此类似的功能。它显示了一个全屏 UIPageViewController，但是如果用户在右上角的功能区上向下拖动，它将整个向下滑动以显示后面的视图（用于设置和其他内容）。

我认为您的问题是内置手势识别器用于翻页。所以你想要做的要么是有一些东西可以拖动（比如我的应用程序左上角的功能区），它会有自己的手势。或者，您可以遍历分配给 UIPageViewController 的手势识别器并获取与 PanGesture 匹配的手势识别器，然后使用您自己的功能覆盖它以将事件委托给 UIPageViewController 或根据平移类型向下滑动。

希望有帮助。

# c# - 条件事件等待/ManualResetEvent

> ID：11783520
> 
> 赞同：3
> 
> 时间：2012-08-02T18:24:06.553
> 
> 标签：c#, multithreading, events, synchronization, manualresetevent

我知道如何使用 ManualResetEvent 或同步原语（如 Monitor）来等待事件和/或锁，但我想知道是否有一种方法可以实现以下内容：

```
ManualResetEvent resetEvent; 

public string WaitForOneThousandMs()
{
    resetEvent.Wait(1000);

    if (WaitTime(resetEvent) <= 1000)
        return "Event occured within 1000ms."; 
    else
        return "Event did not occur within 1000ms."; 
} 
```

1) 等待 1000ms 让事件 X 发生

2) 如果事件发生在 1000ms 内，执行路径 A

3）否则，执行路径B

这基本上是一个条件等待函数，条件是我们必须等待多长时间，如果可能的话，实现它的最佳方法是什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-02T18:26:51.247

看起来你在追求：

```
return resetEvent.WaitOne(1000) ? "Event occurred within 1000ms"
                                : "Event did not occur within 1000ms"; 
```

从文档中[`WaitHandle.WaitOne`](http://msdn.microsoft.com/en-us/library/cc189907.aspx)：

> **如果当前实例接收到信号，则**返回值**
> *true ；*否则，*false*。**

 **[`Monitor.Wait`](http://msdn.microsoft.com/en-us/library/syehfawa.aspx)`bool`以类似的方式返回 a 。**

# windows-8 - 是否可以将 Web 浏览器控件嵌入到具有 Metro Web 应用程序全部功能的 Metro XAML 应用程序中？

> ID：11783522
> 
> 赞同：5
> 
> 时间：2012-08-02T18:24:11.220
> 
> 标签：windows-8, windows-runtime, windows-store-apps, winrt-xaml

您可以在 Windows 8 上的基于 C# XAML 的 Metro 应用程序中嵌入 IE Web 浏览器控件吗？此外，当 HTML/Javascript 这样做时，它是否具有 Windows 8 HTML 应用程序所具有的完整功能集，例如调用 WinRT api？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-02T19:40:35.380

有一个 WebView 控件可用于查看网站或打开 html 字符串，但我相信能够与您需要通过[ScriptNotify](http://msdn.microsoft.com/en-us/library/windows/apps/windows.ui.xaml.controls.webview.scriptnotify.aspx)事件中继调用的 WinRT API 进行通信。

# java - GWT 处理返回、刷新、关闭按钮

> ID：11783525
> 
> 赞同：1
> 
> 时间：2012-08-02T18:24:32.573
> 
> 标签：java, gwt, gwt-rpc, mvp4g

当用户关闭窗口、刷新窗口或单击后退按钮时，我正在尝试运行一些 RPC 调用，*但*仅针对一个页面。我发现了一篇关于处理的帖子，但解决方案效果不佳，缺少后退按钮处理程序（不起作用），并且始终适用于网络上的所有页面，如果您离开页面，我找不到删除处理程序的内容

```
 Window.addWindowClosingHandler(new Window.ClosingHandler() {

                @Override
                public void onWindowClosing(ClosingEvent event) {
                    event.setMessage("You sure?");
                }
            });

    Window.addCloseHandler(new CloseHandler<Window>() {

                @Override
                public void onClose(CloseEvent<Window> event) {

                    // Execute code when window closes!
                System.out.println("ble ! ");

                }
            }); 
```

框架：带有 mvp4g 的 GWT 2.4。
浏览器：FF 和 Chrome。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-03T16:11:05.057

因为我使用 mvp4g 框架，所以我在那里找到了一个解决方案，您需要使用 CyclePresenter 扩展您的演示者并覆盖 onLoad 和 onUnload 方法。这些方法在视图从 DOM 加载/卸载时触发，我测试并适用于所有情况，f5、后退按钮、关闭浏览器/选项卡、转到其他 Web 并调用其他事件。现在我不能在那里放一些代码。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-03T13:12:35.373

您需要在离开页面时删除处理程序，然后在再次进入页面时重新添加它。上面的代码覆盖了“添加”部分，但缺少“删除”部分。您可以通过使用`HandlerRegistration`从方法返回的对象来做到这一点`add*Handler`。当您想删除注册的处理程序时，您只需调用该`HandlerRegistration.removeHandler()`方法：

```
HandlerRegistration windowClosingHandler = Window.addWindowClosingHandler(new ClosingHandler() {
    @Override
    public void onWindowClosing(ClosingEvent event) {
        // Handle window closing
    }
});
// From now on the CloseHandler will be fired

// ...
// Somewhere else:
windowClosingHandler.removeHandler();
// From now on the CloseHandler won't be fired 
```

# ms-access - 将文件夹内容复制到 Access 数据库中

> ID：11783527
> 
> 赞同：0
> 
> 时间：2012-08-02T18:24:34.803
> 
> 标签：ms-access

我想知道是否有人可能知道如何将文件夹的*内容*导入Access 表。

我有一个数据库，用于为具有唯一 ID 的学生制作身份证。当学生将他们的照片打印在这些卡片上时，文件将保存为 jpeg，并以学生证号作为文件名。（例如，学生 1234567 的照片将保存为 1234567.jpg。）这些照片都保存在同一个文件夹中。

我希望能够让 Access（或脚本）自动为该文件夹生成一个包含两列的表：文件名和图像（作为 BLOB）。这样，我就可以通过简单的 SQL 查询将学生的照片添加到他或她的数据记录中。

我的 VBA 技能不是很好（我正在学习中），因此我们将不胜感激。谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-02T18:59:04.867

有一篇 MS 文章： http: [//support.microsoft.com/kb/103257](http://support.microsoft.com/kb/103257)，但是，对于最新版本的 Access (2010)，您最好考虑附件数据类型，它还允许您显示表格上的照片。

# c# - xcode: Apple Mach-O Linker (Id) Error "getInt"，引用自：

> ID：11783530
> 
> 赞同：1
> 
> 时间：2012-08-02T18:24:36.630
> 
> 标签：c#, xcode

[按照https://manual.cs50.net/CS50_Library#Mac_OS_2](https://manual.cs50.net/CS50_Library#Mac_OS_2)上的说明，我已经在 Xcode 上安装了 cs50.h。我已将在项目中构建标题的搜索路径设置为 /usr/local/include 和要使用的库/local/lib（在项目和目标上）。

*#include cs50.h*编译，但构建失败并出现**Apple Mach-O Linker (Id) Error "getInt()"，引用自：**
我对 xcode 非常陌生，将不胜感激详细的解决方案。

操作系统 X10.8 xCode
4.4

# iphone - 如何自定义 MKAnnotationView 的标注大小？

> ID：11783531
> 
> 赞同：3
> 
> 时间：2012-08-02T18:24:45.350
> 
> 标签：iphone, ios, size, mkannotationview, callout

我是 iOS 新手。我需要将标注的大小设置为 300 * 150，我该怎么做？ ![http://img35.imageshack.us/img35/57/1imgz.jpg](../Images/507df5f5f3e11f231ee5262872aeeb84.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-05T11:00:22.347

我添加了所需大小的子视图。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-04T10:29:01.757

标注气泡的大小会根据其包含的文本进行调整。如果将 Title 和 subtitle 设置为一些长文本，标注会根据它进行调整。

# c++ - C++ iterator_adapter 在向量集合上

> ID：11783541
> 
> 赞同：2
> 
> 时间：2012-08-02T18:25:14.523
> 
> 标签：c++, boost, iterator

> **可能重复：**
> [展平迭代器](https://stackoverflow.com/questions/3623082/flattening-iterator)

我有某种类型的向量（比如int）。我想遍历向量中的元素集合，就像遍历整数向量一样。

我可以实现一些可以做到这一点的东西，但想知道如何使用 boost 的 iterator_adapter 来做到这一点。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-03T07:29:38.340

这是我破解的东西。它可以工作并输出正确的结果，但还有很多工作要做。

```
#include <boost/iterator/iterator_adaptor.hpp>
#include <iostream>
#include <vector>
#include <algorithm>
#include <iterator>
#include <string>

template <typename Iter>
class flattening_iterator :
    public boost::iterator_adaptor<
                flattening_iterator<Iter>,
                Iter,
                typename Iter::value_type::iterator::value_type,
                boost::forward_traversal_tag,
                typename Iter::value_type::iterator::value_type
    >
{
private:
        using super_t = boost::iterator_adaptor<
                                flattening_iterator<Iter>,
                                Iter,
                                typename Iter::value_type::iterator::value_type,
                                boost::forward_traversal_tag,
                                typename Iter::value_type::iterator::value_type
                        >;
        using inner_iterator = typename Iter::value_type::iterator;
public:
        flattening_iterator(Iter it)
                : super_t(it),
                  inner_begin(),
                  inner_end(),
                  outer_end(it)
        {}
        flattening_iterator(Iter begin, Iter end)
                : super_t(begin),
                  inner_begin((*begin).begin()),
                  inner_end((*begin).end()),
                  outer_end(end)
        {}
    using value_type = typename Iter::value_type::iterator::value_type;
private:
    friend class boost::iterator_core_access;
    inner_iterator inner_begin;
    inner_iterator inner_end;
    Iter outer_end;

    void increment()
    {
        if (this->base_reference() == outer_end)
            return; // At the end

        ++inner_begin;
        if (inner_begin == inner_end)
        {
            ++this->base_reference();
            inner_begin = (*this->base_reference()).begin();
            inner_end = (*this->base_reference()).end();
        }
    }

    value_type dereference() const
    {
        return *inner_begin;
    }
};

template <typename Iter>
auto flatten(Iter it) -> flattening_iterator<Iter>
{
    return flattening_iterator<Iter>(it);
}

template <typename Iter>
auto flatten(Iter begin, Iter end) -> flattening_iterator<Iter>
{
    return flattening_iterator<Iter>(begin, end);
}

int main()
{
    std::vector<std::vector<int>> v1{{1, 2, 3}, {4, 5, 6}, {7, 8, 9}};
    for (auto i = flatten(v1.begin(), v1.end()); i != flatten(v1.end()); ++i)
    {
        std::cout << *i << ' ';
    }
    std::cout << std::endl;
    std::vector<std::vector<std::string>> v2{{"Hello", "Print"}, {"Me", "Here"}};
    std::copy(flatten(v2.begin(), v2.end()), flatten(v2.end()),
                  std::ostream_iterator<std::string>(std::cout, " "));
} 
```

# javascript - $(window).load() 执行了 2 次？

> ID：11783542
> 
> 赞同：0
> 
> 时间：2012-08-02T18:25:16.083
> 
> 标签：javascript, jquery, html

我正在使用 $(window).load() 更改缩略图库的一些图像大小，然后根据图像大小配置幻灯片。由于某种原因，代码执行了 2 次。我可以这样说，因为在我的配置函数中，我使用 jQuery 将 div 包裹在另一个 div 周围。但是，当我在页面加载时查看我的 HTML 时，有 2 个相同 div 的实例被包装。

我使用 javascript 调试器查看发生了什么，我的代码执行，然后进入 jquery-min.js，然后返回到我的函数，就好像它被第二次调用一样。这是我的代码：

**HTML**

```
<?php session_start(); include ('dbConfig.php'); include('main.php'); ?>
<!DOCTYPE html>
<html>
<head>
<title>Main Gallery</title>
<link rel="stylesheet" href="css/reset.css" type="text/css" />
<link rel="stylesheet" href="css/style.css" type="text/css" />
<link href='http://fonts.googleapis.com/css?family=Great+Vibes' rel='stylesheet' type='text/css'>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js" type="text/javascript"></script>

<!--[if IE]>

   <style type="text/css">

   .transblack { 
       background:transparent;
       filter:progid:DXImageTransform.Microsoft.gradient(startColorstr=#50000000,endColorstr=#50000000); 
       zoom: 1;
    } 
     .transwhite { 
       background:transparent;
       filter:progid:DXImageTransform.Microsoft.gradient(startColorstr=#50FFFFFF,endColorstr=#50FFFFFF); 
       zoom: 1;
    } 

    </style>

<![endif]-->
<script>
$(window).load(function(){
$('#gallery ul li').each(function() {

    var $frame = $(this).children('div');
    $frame.children('img').superFit(); 

});

$('#gallery').css('visibility', 'visible');
configGallery();
});

$(document).ready(function(){

$('#filter').hide();
$('#photoWrap').hide();
$('#gallery').css('visibility', 'hidden');

});
</script>
</head>

<body>

<div id="mainWrap">
<?php include('adminPanel.php'); ?>
    <div id="photoWrap">
    <div id="controlLeft" class="control"></div>
        <div id="slideShow">
            <div id="slideContainer">

                        <?php
                            if(isset($_GET['c']) && isset($_GET['p']))
                            {
                                if(isAuthentic($_GET['c'], $_GET['p']))
                                {
                                    getSlideshow($_GET['c']);
                                }else{
                                    getSlideshow();
                                }
                            }else{
                                getSlideshow();
                            }
                        ?>

            </div>
        </div>
        <div id="controlRight" class="control"></div>
    </div>

<div id="container">

    <div id="filter" class="transblack"></div>

    <div id="titleWrap"></div>
    <div id="navWrap">
        <div id="nav">
            <ul>
                <li><a href="index.php">Home</a></li>
                <li><a href="gallery.php">Gallery</a></li>
                <li><a href="contact.php">Contact</a></li>
            </ul>
        </div>
    </div>

    <div id="clientHolder">
        <span id="clientSelector">Select Gallery: <select onchange="getGallery(document.getElementById('clientSelect').value)" id="clientSelect">
            <option value="-2">--Select--</option>
            <option value="-1">Public Gallery</option>
            <?php 
                if(isset($_GET['c']) && isset($_GET['p']))
                {
                    if(isAuthentic($_GET['c'], $_GET['p']))
                    {
                        getClients($_GET['c']);
                    }else{
                        getClients();
                    }
                }else{
                    getClients();
                }
                ?>
        </select></span>
    </div>
    <div id="gallery">
        <ul>
        <?php 
            if(isset($_GET['c']) && isset($_GET['p']))
            {
                if(isAuthentic($_GET['c'], $_GET['p']))
                {
                    getMain($_GET['c']);
                }else{
                    echo "<h2>The password you entered was incorrect</h2>";
                }
            }else{
            getMain();
            }?>
        </ul>
    </div>
</div>
</div>

<script src="js/md5.js" type="text/javascript"></script>
<script src="js/helper.js" type="text/javascript"></script>
<script src="js/superFit.js" type="text/javascript"></script>
</body>
</html> 
```

**Javascript** 这第一个是我创建的 jQuery 插件

```
(function($) {

    $.fn.superFit = function(options) {

        var $this = $(this);
        var parent = $this.parent();
        var parentW = parent.width();
        var parentH = parent.height();
        var imgW = $this.width();
        var imgH = $this.height();

        var imgRatio = imgH / imgW;
        var parentRatio = parentH / parentW;

            if(imgRatio < parentRatio) //We have a landscape image
            {
                //First set the height of image to be 100%;
                $this.css('height', '100%');
                imgW = $this.width();
                parentW = parent.width();

                //Now center the image
                $this.css('margin-left', -(imgW/2)+(parentW/2));

            }else{ //We have a portrait image
                $this.css('width', '100%');
            }

    }
        })(jQuery); 
```

这是被调用两次的函数

```
function configGallery()
{

var currentPosition;
var slides = $('.slide');
var currentSlide;
var currentImg;
var slideWidth = 720;
var numberOfSlides = slides.length;

 var imgRatio;
 var slideRatio = $('#slideShow').height() / slideWidth;

 slides.wrapAll('<div id="slideInner"></div>');

$('.imgHolder').click(function(){
        $('#filter').show();
        $('#photoWrap').show();
        currentPosition = $('.imgHolder').index(this);

        $('#slideShow').width(slideWidth);

      // Remove scrollbar in JS
      $('#slideContainer').css('overflow', 'hidden');

      //Change image size based on resolution

      // Wrap all .slides with #slideInner div
      slides.css({
        'float' : 'left',
        'width' : slideWidth
      });

        // Set #slideInner width equal to total width of all slides
        $('#slideInner').css('width', (slideWidth * numberOfSlides));

        // Hide left arrow control on first load
        manageControls(currentPosition);

        $('#slideInner').css('margin-left' , slideWidth*(-currentPosition));

        $('#photoWrap').css('margin-top', (screen.height/3)-($('#photoWrap').height()/3));

        changeSize();
});

  // Create event listeners for .controls clicks
  $('.control')
    .bind('click', function(){
    // Determine new position
    currentPosition = ($(this).attr('id')=='controlRight') ? currentPosition+1 : currentPosition-1;

    manageControls(currentPosition);

    changeSize();

    $('#slideShow').width(slideWidth);

      $('#slideInner').css('margin-left', slideWidth*(-currentPosition));

    });

    $('#filter').click(function(){
        $(this).hide();
        $('#photoWrap').hide();
    });
  // manageControls: Hides and shows controls depending on currentPosition
  function manageControls(position){
    // Hide left arrow if position is first slide
    if(position==-1){   currentPosition = numberOfSlides-1; }
    else{ $('#leftControl').show() }
    // Hide right arrow if position is last slide
    if(position==numberOfSlides){ currentPosition = 0; }
    else{ $('#rightControl').show() }
    }

function changeSize(){

      currentSlide = $('.slide').get(currentPosition);
      currentImg = $(currentSlide).children('img').first();
      imgRatio =  $(currentImg).height() / $(currentImg).width(); 

    if(imgRatio < slideRatio)
    {
        $(currentImg).addClass('landscape');
        //Vertically align
        var thisHeight = $(currentImg).height();
        $(currentImg).css('margin-top', ($('#slideShow').height()/2)-(thisHeight/2));

    }else{
        $(currentImg).addClass('portrait');
    }

}

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-02T18:42:08.410

为什么要使用 $(window).load()？请问有没有具体的原因。

标准的 jQuery 方式通过以下方式使用 DOMReady：

```
$(document).ready() 
```

或者：

```
$(function(){

}); 
```

* * *

## 回答 #2

> 赞同：-3
> 
> 时间：2012-08-02T18:37:15.830

```
var once = false;
function configGallery() {
    if ( ! once) {
        once = true;

        // Rest of the function
    }
} 
```

这将使它只执行一次。

# php - 动态断言 Zend_ACL - 在 isAllowed 上创建不需要的对象

> ID：11783543
> 
> 赞同：3
> 
> 时间：2012-08-02T18:25:19.440
> 
> 标签：php, zend-framework, dynamic, acl

在这篇文章之后，我尝试将动态 Zend_Acl 断言添加到我的项目中：http: [//www.amazium.com/blog/content-driven-access-control-with-zend-acl](http://www.amazium.com/blog/content-driven-access-control-with-zend-acl)

经过几天的思考，我仍然无法使其正常工作。它抛出一个错误：“可捕获的致命错误：传递给 Application_Model_User::populate() 的参数 1 必须是一个数组，给定的对象，在 C:\Program Files\Zend\Apache2\htdocs\guardian\application\models\User 中调用。 php 在第 14 行，并在第 92 行的 C:\Program Files\Zend\Apache2\htdocs\guardian\application\models\User.php 中定义”。

通过调试我发现了ClientController中的那一行

```
$subsidiary->setAllowed($this->_acl->isAllowed($user, $subsidiary)); 
```

导致问题。但我不知道如何使它工作。似乎 isAllowed 创建了一个 User 实例，尽管我直接将它传递到那里。

我的代码如下：

```
class My_Controller_Helper_Acl extends Zend_Acl{

public function __construct(){

    $this->add(new Zend_Acl_Resource('index'));
    $this->add(new Zend_Acl_Resource('client'));
    $this->add(new Zend_Acl_Resource('search'));
    $this->add(new Zend_Acl_Resource('subsidiary'));
    $this->add(new Zend_Acl_Resource('user'));
    $this->add(new Zend_Acl_Resource('error'));
    $this->add(new Zend_Acl_Resource('subs'));

    $guest = My_Role::ROLE_GUEST;
    $client = My_Role::ROLE_CLIENT;
    $technician = My_Role::ROLE_TECHNICIAN;
    $coordinator = My_Role::ROLE_COORDINATOR;
    $admin = My_Role::ROLE_ADMIN;

    $this->addRole(new Zend_Acl_Role($guest));
    $this->addRole(new Zend_Acl_Role($client));
    $this->addRole(new Zend_Acl_Role($technician), $client);
    $this->addRole(new Zend_Acl_Role($coordinator), $technician);
    $this->addRole(new Zend_Acl_Role($admin));

    $this->allow($guest, array('user', 'error'));
    $this->deny($guest, 'user', array('register', 'rights', 'delete'));
    $this->allow($client);
    $this->deny($client, 'client', 'new');
    $this->deny($client, 'client', 'delete');
    $this->deny($client, 'user', array('register', 'rights', 'delete'));
    $this->allow($client, 'subs', null, new My_Controller_Helper_UserOwned());
    $this->allow($coordinator, 'client', array('new', 'delete'));

    $this->allow($admin);

}
}

class My_Controller_Helper_UserOwned implements Zend_Acl_Assert_Interface{
/**
 * @param Zend_Acl $acl
 * @param Zend_Acl_Role_Interface $role
 * @param Zend_Acl_Resource_Interface $resource
 * @param unknown_type $privilege
 */
public function assert(Zend_Acl $acl, Zend_Acl_Role_Interface $role = null, Zend_Acl_Resource_Interface $resource = null, $privilege = null) {
    if (!$resource instanceof Application_Model_UserOwnedInterface){

        throw new Exception('UserOwnedInterface not implemented');
    }

    $auth = Zend_Auth::getInstance();
    if(!$auth->hasIdentity()){
        return false;
    }
    $user = new Application_Model_User($auth->getIdentity());

    return $resource->isOwnedByUser($user);
}
} 
```

ClientController.php / listAction

```
$subsidiariesDb = new Application_Model_DbTable_Subsidiary ();

$subsidiaries = $subsidiariesDb->getByTown ();
$users = new Application_Model_DbTable_User();
$user = $users->getByUsername($this->_username);

foreach($subsidiaries as $subsidiary){
                $subsidiary->setAllowed($this->_acl->isAllowed($user, $subsidiary));
            }

$this->view->subsidiaries = $subsidiaries;
$this->renderScript ( 'client/town.phtml' ); 
```

城镇.phtml

```
<?php foreach ($this->subsidiaries as $subsidiary) :
if($subsidiary->getAllowed()){
    if ($town != $subsidiary->getSubsidiaryTown()){?>
        </ul>
        <p class="bold"><?php echo $subsidiary->getSubsidiaryTown(); ?></p>
        <?php $town = $subsidiary->getSubsidiaryTown(); ?>
        <ul>
    <?php }
    if ($subsidiary->getHq()) {?>
        <li class="bold"><a href="<?php echo $this->url(array('clientId' => $subsidiary->getClientId()), 'clientIndex');?>">
            <?php echo $subsidiary->getSubsidiaryName() . ' (centrála)'?>
        </a></li>
    <?php }
    else {?>
        <li><?php echo '<a href="' . $this->url(array('clientId' => $subsidiary->getClientId(), 'subsidiary' => $subsidiary->getIdSubsidiary()), 'subsidiaryIndex') . '">' . $subsidiary->getSubsidiaryName() . '</a>'?></li>
    <?php }
}
    endforeach; ?> 
```

用户模型（部分）

```
class Application_Model_User implements Zend_Acl_Role_Interface{

private $idUser;
private $username;
private $password;
private $salt;
private $role;
private $userSubsidiaries;

public function __construct ($options = array()){
    if (!empty($options)){
        $this->populate($options);
                    //see what the options are in debug below
    }
}

public function getRoleId(){
    return $this->getRole();
}

public function populate(array $data){

    $this->idUser = isSet($data['id_user']) ? $data['id_user'] : null;
    $this->username = isSet($data['username']) ? $data['username'] : null;
    $this->password = isSet($data['password']) ? $data['password'] : null;
    $this->salt = isSet($data['salt']) ? $data['salt'] : null;
    $this->role = isSet($data['role']) ? $data['role'] : null;

    $this->userSubsidiaries = array();
    $subsidiaries = isSet($data['user_subsidiaries']) ? $data['user_subsidiaries'] : null;
    $this->addSubsidiaryToUser($subsidiaries);

    return $this;
}

public function toArray($toUpdate = false, $withSubsidiaries = true){
    if (!$toUpdate){
        $data['id_user'] = $this->idUser;
    }
    $data['username'] = $this->username;
    $data['password'] = $this->password;
    $data['salt'] = $this->salt;
    $data['role'] = $this->role;

    if($withSubsidiaries){
        $data['user_subsidiaries'] = $this->userSubsidiaries;
    }

    return $data;
}

public function hasSubsidiary($subsidiary){
    if($subsidiary instanceOf Application_Model_Subsidiary){
        $subsidiary = $subsidiary->getIdSubsidiary();
    }
    return in_array($subsidiary, $this->getUserSubsidiaries());
}

public function getUserSubsidiaries(){
    return $this->userSubsidiaries;
}

public function addSubsidiaryToUser($subsidiary){
    if(is_array($subsidiary)){
        foreach($subsidiary as $sub){
            $this->addSubsidiaryToUser($sub);
        }
    } elseif ($subsidiary instanceof Application_Model_Subsidiary){
        $this->userSubsidiaries[] = $subsidiary->getIdSubsidiary();
    } elseif (is_numeric($subsidiary)){
        $this->userSubsidiaries[] = $subsidiary;
    } else{
        throw new Exception('Invalid subsidiary provided.');
    }

    return $this;
}

} 
```

当我在填充函数中对 User 中的 $options 参数进行调试时，我在 ClientController [user = $users->getByUsername($this->_username);] 中创建用户时得到结果 (1)，这是正确的. 与isAllowed一致，我在开头提到，我得到结果（2）。但我不明白为什么用户对象甚至在该行上创建。我很绝望。你知道错在哪里吗？

结果（1）：

```
object(Application_Model_User)#169 (6) {
["idUser":"Application_Model_User":private] => string(1) "6"
["username":"Application_Model_User":private] => string(6) "klient"
["password":"Application_Model_User":private] => string(64) "82a78c724f3242148990897a3b754e1f57442311fab5cde74c2a238d8c8858fc"
["salt":"Application_Model_User":private] => string(88) "Ewxm5Pa7t0MHn9GtROi8Rg5bis0hUhXF/QnnaRmiwgOUqz1elGj/AzYcaVlHa+J6vTpdyvy3mtlmXfmoQlAswg=="
["role":"Application_Model_User":private] => string(1) "4"
["userSubsidiaries":"Application_Model_User":private] => array(1) {
[0] => string(1) "2"
}
} 
```

结果（2）：

```
object(stdClass)#18 (5) {
["id_user"] => string(1) "6"
["username"] => string(6) "klient"
["password"] => string(64) "82a78c724f3242148990897a3b754e1f57442311fab5cde74c2a238d8c8858fc"
["salt"] => string(88) "Ewxm5Pa7t0MHn9GtROi8Rg5bis0hUhXF/QnnaRmiwgOUqz1elGj/AzYcaVlHa+J6vTpdyvy3mtlmXfmoQlAswg=="
["role"] => string(1) "4"
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-03T15:23:42.463

如对原始问题的评论中所述，此问题现已解决。

我删除了

```
$user = new Application_Model_User($auth->getIdentity()); 
```

并且只使用

```
return $resource->isOwnedByUser($role); 
```

# php - Javascript：如何从输入的表单中找到相似的短语或文本？

> ID：11783547
> 
> 赞同：3
> 
> 时间：2012-08-02T18:25:30.780
> 
> 标签：php, javascript, mysql, ajax

我只是用新代码练习，我被卡住了。我希望能够打开一个表格在我的网站上发布问题，但是我是为了显示已经被问到的问题，这些问题可能与他们所问的问题相似。所以基本上就像在这个网站上一样，当我写这个问题时，它显示“可能已经有你答案的问题”。这就是我想要的，但找不到怎么做。所以我希望能够在表格中写一些代码搜索已经在数据库中的问题以找到类似的问题。有谁知道如何做到这一点？

**编辑 2012 年 3 月 8 日。**

所以我认为 iv 做到了，这就是我做到的，我认为无论如何都做到了。因此，如果有人对此感兴趣，请从 Bertrand 添加的链接下载文件，然后在 search.php 页面上将页面顶部的代码更改为：

```
include("config.php");
$search_term = filter_var($_GET["s"], FILTER_SANITIZE_STRING);

$array = explode(" ", $search_term);

foreach ($array as $key=>$word) {
$array[$key] = " title LIKE '%".$word."%' ";
}

$q = "SELECT * FROM posts WHERE  " . implode(' OR ', $array) . " LIMIT 0,10";
$r = mysql_query($q);
if(mysql_num_rows($r)==0)//no result found 
```

它似乎有效，我确实失去了突出显示您在搜索中键入的单词的突出显示功能。但我对此并不介意。只要它有效:)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-02T19:08:02.477

我认为答案是 Ajax 现场搜索。基本上，您必须获取用户正在输入的文本并运行将连接到服务器中页面的 ajax 请求，该页面将在您的数据库中运行查询并将结果（如果有）返回到请求中，而不是您填充与他们一起在“可能已经有答案的问题”区域。

查看本教程或 google 以使用 JQuery 进行 ajax 实时搜索。 [http://www.technabled.com/2009/03/how-to-build-animated-ajax-search-with.html](http://www.technabled.com/2009/03/how-to-build-animated-ajax-search-with.html)

# javascript - 使用正则表达式从 javascript 数组中获取数据

> ID：11783548
> 
> 赞同：0
> 
> 时间：2012-08-02T18:25:32.620
> 
> 标签：javascript, regex, arrays

经过几个令人沮丧的小时后，我向 stackoverflow 小组寻求帮助。虽然我知道正则表达式可以解决我的问题，但我对做我需要做的事情知之甚少（并且在截止日期前，所以无法在截止日期之前了解我需要什么）。

我的问题是我有以下数组：

```
(['ad53930','160x600','&PG=SPTRF3','&AP=1090','regular'],
['ad55852','728x90','&PG=SPTRF1','&AP=1390','regular'],
['ad52971','300x250_pginterstitial','&PG=SPTRF4','&AP=1089','pgInterstitial'],
['ad52969','300x250','&PG=SPTHP4','&AP=1089','regular']) 
```

并且需要提取&PG=后面的6位代码。我能够拼凑一些正则表达式来提取整个`&PG=XXXXXX`字符串，但是在 Chrome 的控制台中构建了它，并且在浏览器崩溃后，丢失了正则表达式。我想要完成的是从上面的数组中获得“SPTRF3，SPTRF1，SPTRF4，SPTHP4”的成品，无论是在另一个数组还是字符串中。

任何帮助将不胜感激！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-02T18:27:41.407

为什么需要正则表达式？您可以在数组中的该字符串上使用子字符串：`.substr(3)`。

如果 "&PG=" 字符串始终在 index 的数组中`2`，那么您可以像这样遍历数组数组：

```
for (idx in myArray)
   console.log(myArray[idx][2].substr(4), ","); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-02T18:31:09.573

使用正则表达式捕获组，将此正则表达式传递给每个带有`for`循环的项目并将结果推送到另一个数组`products`

```
var products = []
for (var i=0, l=arr.length, p; i<l; i++){
  p = /&PG\=(.+)/.exec(arr[i])[1]
  if (p) products.push(p)
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-02T18:31:26.287

这对我有用：

```
/&PG=[A-Z]{5}\d/g 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-02T18:32:55.193

它可能对你有用。

```
var arr = ['ad53930','160x600','&PG=SPTRF3','&AP=1090','regular']
var num = arr[2].substr(4); // it will give SPTRF3 
```

# javascript - HighStock HighCharts 在点击事件上设置标志

> ID：11783549
> 
> 赞同：3
> 
> 时间：2012-08-02T18:25:42.960
> 
> 标签：javascript, highcharts, highstock

我正在使用 HighCharts 的 HighStock 版本在图表中创建一系列数据。我有一个烛台图，在条形图的顶部，在直方图的顶部。烛台点是可点击的。我想在烛台图上他们刚刚单击的点上添加一个标志。

这是我尝试过的一些代码：

```
// create the chart
        chart = new Highcharts.StockChart({
            chart: {
                renderTo: 'container',
                alignTicks: false
            },

            rangeSelector: {
                selected: 1
            },

            title: {
                text: 'DJIA Historical'
            },

            yAxis: [{
                title: {
                    text: 'OHLC'
                },
                height: 300,
                lineWidth: 2
            }, {
                title: {
                    text: 'Volume'
                },
                top: 400,
                height: 100,
                offset: 0,
                lineWidth: 2
            }, {
                title: {
                    text: 'MACD'
                },
                top: 520,
                height: 100,
                offset: 0,
                lineWidth: 1
            }],

            series: [{
                type: 'candlestick',
                name: 'DJIA',
                data: ohlc,
                events: {
                    click: function(event) {

                        console.log(chart);
                        chart.series[6].setData(event.point);
                    }
                },
                dataGrouping: {
                    units: groupingUnits
                }
            }, {
                type: 'column',
                name: 'Volume',
                data: volume,
                yAxis: 1,
                dataGrouping: {
                    units: groupingUnits
                }
            }, {
                type: 'column',
                name: 'Histogram',
                pointPadding: 0,
                groupPadding: 0,
                data: histogram,
                yAxis: 2,
                color: '#666666'
            }, {
                type: 'line',
                name: 'MACD',
                pointPadding: 0,
                groupPadding: 0,
                data: macd,
                yAxis: 2,
                color: '#0000FF'
            }, {
                type: 'line',
                name: 'Signal',
                pointPadding: 0,
                groupPadding: 0,
                data: signal,
                yAxis: 2,
                color: '#000000'
            }, {
                type: 'flags',
                name: 'Active Point',
                data: [],
                onSeries: ohlc,
                shape: 'squarepin'
            }]
        });
    }) 
```

该图表不会引发任何 JavaScript 错误，但不会创建标志。至少，它没有显示出来。我想基本上让它在他们点击的烛台上绘制旗帜。如果他们单击另一个点，我想删除旧标志并在新点上绘制一个新标志。我认为这最好通过在系列中添加和删除数据来完成，但运气不佳。

对此的任何帮助将不胜感激！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-02T20:07:40.330

首先，非常感谢了解您的问题的 js-fiddle 示例。根据我对您问题的了解，试试这个（假设 5 是您的标志系列的索引，您的代码似乎使用索引 6？！）

```
click: function(event) {
                this.chart.series[5].addPoint({
                    x: event.point.x,
                    title: 'hey you clicked me'
                });
            } 
```

我摆弄的代码@ [http://jsfiddle.net/U2Z2x/1/](http://jsfiddle.net/U2Z2x/1/)

由于您似乎只对显示 1 个标志感兴趣，因为您正确使用了 setData，这似乎是您最好的选择，只是一个问题，setData 需要一个数组，并且您传递一个值，点的格式也需要对旗型系列稍作重做

```
 click: function(event) {
                this.chart.series[5].setData([{
                    x: event.point.x,
                    title: 'hey you clicked me'
                }]); 
```

小提琴更新@ [http://jsfiddle.net/U2Z2x/2/](http://jsfiddle.net/U2Z2x/2/)

# web-services - Reporting Services，如何使用复杂类型参数作为输入查询 Web 服务

> ID：11783551
> 
> 赞同：1
> 
> 时间：2012-08-02T18:25:59.700
> 
> 标签：web-services, reporting-services, parameter-passing, complextype

我需要查询在 Reporting Services 中传递复杂参数作为输入的 web 服务。我怎样才能做到这一点？

在 Visual Studio 的查询设计器中，我正在执行如下查询：

```
<Query>
<SoapAction>http://mywebservice.com/Customers/GetCustomers</SoapAction>
<Method Name="GetCustomers" Namespace="http://mywebservice.com/Customers/">
<Parameters>
<Parameter Name="myParams" type="xml">
   <DefaultValue>
        <myParams>
           <IdCustomer>0</IdCustomer>
        </myParams>
    </DefaultValue>
</Parameter>
</Parameters>
</Method>
<ElementPath IgnoreNamespaces="true">*</ElementPath>
</Query> 
```

WebService 期望它作为参数：

```
<?xml version="1.0" encoding="utf-8"?>
<soap:Envelope xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/">
  <soap:Body>
    <GetCustomer xmlns="http://mywebservice.com/Customers/">
      <myParams>
        <IdCustomer>int</IdCustomer>
        <IdCustomer>int</IdCustomer>
      </myParams>
    </GetCustomer>
  </soap:Body>
</soap:Envelope> 
```

当我在 Visual Studio 2008 上尝试时，我收到以下错误消息：

> 对指定 URL 执行 Web 请求失败。Soap 故障：System.Web.Services.Protocols.SoapException：服务器无法处理请求。---> System.NullReferenceException：对象引用未设置为对象的实例。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-08-27T14:31:11.513

您应该查看在测试客户端中发送的 xml，以获取查询所需语法的示例。我建议使用Visual Studio 附带的[wcftestclient 。](https://msdn.microsoft.com/en-us/library/bb552364)运行测试后，您可以在 XML 选项卡上查看 xml（在 wcftestclient 的屏幕底部），并将查询的 <DefaultValue> 部分中的内容替换为相应的参数值。

该 Web 服务的查询应如下所示。请注意将取决于您自己的情况**的命名空间：**

```
<Query>
  <SoapAction>http://mywebservice.com/Customers/GetCustomers</SoapAction>
  <Method Name="GetCustomer" Namespace="http://mywebservice.com/Customers/">
    <Parameters>
      <Parameter Name="myParams" type="xml">
        <DefaultValue xmlns:a="http://schemas.datacontract.org/2004/07/MyWebServices">
          <a:IdCustomer>0</a:IdCustomer>
          <a:IdCustomer>1</a:IdCustomer>
        </DefaultValue>
      </Parameter>
    </Parameters>
  </Method>
</Query> 
```

另外，我确实看到您有 <Parameter type="xml">。对我来说，我花了几个小时处理一个类似的查询，但缺少**type="xml"**。MSDN 上似乎没有很好地记录该属性。

# jquery - jQuery jCarousel 无法在 iPhone 上运行

> ID：11783553
> 
> 赞同：0
> 
> 时间：2012-08-02T18:26:02.183
> 
> 标签：jquery, jquery-plugins, jcarousel

我正在使用 sorgalla.com/projects/jcarousel/ 作为垂直轮播来保存视频的缩略图。单击时，较大视频的 src 会发生变化。

我有两个版本的页面——一个带有 Flash 导航（[http://www.Smokingstinks-aaco.org/index-slide.html](http://www.smokingstinks-aaco.org/index-slide.html)），另一个带有使用 Javascript 的导航（[http://www.Smokingstinks-aaco.org /移动](http://www.smokingstinks-aaco.org/mobile)）。带有 Flash 导航的那个可以正常工作，但是使用 Javascript 导航的那个有一些问题。

在 Chrome 中一切正常，但在我的 iPhone 4S 和新 iPad 上，当我向下滚动到最后一页时，最后两个缩略图丢失了，然后当我向上滚动时，所有缩略图都丢失了。我确定我缺少一些差异，但我找不到它。我什至建立了一个没有其他内容的演示页面，直接从 Sorgalla 的站点复制代码，然后添加了我需要的元素（您可以在 www.Smokingstinks-aaco.org/mobile/carousel-test.html 找到此页面） .

这个页面有同样的问题。虽然我对 Javascript 相当了解，但我对 JQuery 并没有太多经验，所以我希望这只是我忽略的一些易于修复的问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-06T16:10:51.903

看起来当我将 html{zoom: 2;} 添加到我的 css 时，它弄乱了 jCarousel 隐藏和显示缩略图的方式。删除该行时工作正常。

# vb.net - 使用 VB 在 Windows 窗体应用程序中的 SharePoint 中创建文件夹

> ID：11783555
> 
> 赞同：0
> 
> 时间：2012-08-02T18:26:11.343
> 
> 标签：vb.net, sharepoint, directory

我正在开发一个 Windows 窗体应用程序，我需要在 SharePoint 目录中创建一个文件夹，然后在该文件夹中保存一个 excel 文件。

我当前用于将我的 excel 文件保存在 sharepoint 目录中的代码按预期工作。

```
 Dim xlsApp As Microsoft.Office.Interop.Excel.Application = CreateObject("Excel.Application")
        Dim xlsWB As Microsoft.Office.Interop.Excel.Workbook
        xlsApp.Visible = True
        xlsWB = xlsApp.Workbooks.Open("H:\Records\1234_TEST.xls")
        xlsWB.SaveAs("//oil.Test.com/oil452-6603/TEST_FOLDER/1234_TEST.xls") 
```

我遇到的问题是我需要在 SharePoint 目录中创建一个文件夹，里面说“TEST_FOLDER”，以实际将 excel 文件放入其中。我不会在共享点服务器所在的同一台计算机上运行它，而且我还没有找到一种通过代码在共享点内创建文件夹的方法。

通过 sharepoint 手动添加文件夹不是一个选项，因为我需要为每个文件夹创建很多这些额外的文件夹/excel 文件。

任何关于我需要做些什么才能创建一个文件夹以便我可以将我的 excel 文件保存到其中的任何帮助将不胜感激。谢谢你

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-03T09:49:21.493

您可以使用[SharePoint Web 服务](http://msdn.microsoft.com/en-us/library/dd878586%28v=office.12%29)来做您需要的事情，您需要使用[Lists Web 服务](http://msdn.microsoft.com/en-us/library/lists%28v=office.12%29)。有关创建文件夹的示例，请参阅[此博客文章](http://sridharu.blogspot.co.uk/2008/10/createdelete-folers-using-listsasmx-web.html)（我尚未对其进行测试，但看起来不错）。

# python - Python 和 Windows 将 TCP 时间戳添加到标头

> ID：11783561
> 
> 赞同：0
> 
> 时间：2012-08-02T18:26:36.710
> 
> 标签：python, tcp, timestamp

我是一个真正的 py 和 TCP 新手，但我需要发送 18 到 141 字节的数据，并在标头中带有时间戳。我看到了这个链接

[如何在使用 python 构建 tcp SYN 数据包时设置 tcp 选项时间戳？](https://stackoverflow.com/questions/5082516/how-to-set-the-tcp-option-timestamp-while-building-a-tcp-syn-packet-using-python)

但我将使用 Windows 7，我不知道从哪里开始。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-01T22:41:05.073

如果你只是想打开 TCP 时间戳，它是 Windows 下的 TCP 选项。看看这个：[http ://technet.microsoft.com/en-us/library/cc938205.aspx?ppud=4](http://technet.microsoft.com/en-us/library/cc938205.aspx?ppud=4)

在注册表中将 Tcp1323Opts 设置为 2，重新启动并在所有传出连接上打开时间戳（假设对方也支持它们）。

但是你为什么想要那个？您无法从应用程序访问时间戳，它们仅用于帮助 TCP 处理长胖网络和大 TCP 窗口。

# java - 使用模式从字符串中提取数字

> ID：11783562
> 
> 赞同：0
> 
> 时间：2012-08-02T18:26:42.820
> 
> 标签：java, regex, pattern-matching

好的，这就是我所拥有的

> "C:\this\file\is\rev12\oh\A_12345\doll\classes"

我想从这个字符串中提取`12345`唯一的。

如何使用 Java [Pattern.compile](http://docs.oracle.com/javase/6/docs/api/java/util/regex/Pattern.html#compile%28java.lang.String%29)来完成？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-03T08:52:36.393

下面是您可以使用的代码，但是我必须将路径中的反斜杠更改为正斜杠并使用绝对路径。我还尝试更改路径“C:\\this\\file\\is\\rev12\\oh\\A_12345\\doll\\classes”以在 Windows 中使用它。您可以将“\”更改为“\\”。两个路径字符串都适用于以下代码。

```
File file = new java.io.File("C:/this/file/is/rev12/oh/A_12345/doll/classes").getAbsoluteFile();
    System.out.println(file.getAbsolutePath());

    Pattern pat = Pattern.compile("-?\\d+");
    Matcher mat = pat.matcher(file.getAbsolutePath());
    while (mat.find()) {
      System.out.println(mat.group());
    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-03T08:38:44.773

您应该更笼统地定义此数字的显示方式。因此，如果它在字符串中的某个位置带有前导下划线`_`和尾随斜杠`\`模式将跟随`_(\d+)\\`.

您的号码可以从模式匹配组中提取。 [试试看](http://regexpal.com/?flags=g&regex=_%28%5Cd%2b%29%5C%5C&input=C%3a%5Cthis%5Cfile%5Cis%5Crev12%5Coh%5CA_12345%5Cdoll%5Cclasses)。

# python - Python strptime - 处理单个数字日期

> ID：11783564
> 
> 赞同：2
> 
> 时间：2012-08-02T18:26:47.850
> 
> 标签：python, strptime

我一直在尝试将给定时间转换为不同的格式，考虑到外部设备的时区，跳过操作系统的时区转换。

最初，我有一个以 UTC 秒为单位的时间，以及来自设备的时区。例如，我现在所在的时间是秒=1343931446，时区=-0700。我想要做的是将它转换为 format `YYYYMMDD_HHMMSS`，它已经正常工作了一段时间。对于上述值，它应该是`20120802_111726`。

自从我在 7 月 11 日方便地编写后，以下代码块就可以正常工作。问题归结为这样一个事实，即当一天只有 1 位数长（也就是从昨天开始）时，解析出错了，我得到`20120821_011726`. 我假设问题是当我将时间值转换为日期时间时，当我打印时`time_t`，我会得到`time.struct_time(tm_year=2012, tm_mon=8, tm_mday=2, tm_hour=18, tm_min=17, tm_sec=26, tm_wday=3, tm_yday=215, tm_isdst=0)`，当解析为`datetime`.

问题是，我可以强制 datetime 接受月份/小时的 2 个字符输入，以便正确解析，还是有更好的方法来转换这些格式？请记住，此当前方法是由于无法使用任何考虑当前系统时间的方法而编写的，因为这样做是在不保证系统上的时区与秒所在的设备上相同的情况下完成的从...获取。

```
def convert_time(seconds, tz):
    """ Times obtained were in seconds since epoch. 
        Convert to format YYYYMMDD_HHMMSS.
    """
    time_t = time.gmtime(seconds) # convert to time tuple
    # convert to datetime format - because time zone comparisons can't be made
    # in a format directly convertible from UTC
       time_dt = datetime.datetime.strptime(str(time_t.tm_year) + 
                                            str(time_t.tm_mon)  + 
                                            str(time_t.tm_mday) +
                                            str(time_t.tm_hour) + 
                                            str(time_t.tm_min)  + 
                                            str(time_t.tm_sec), 
                                            '%Y%m%d%H%M%S')

    # Convert time zone to timedelta
    offset = datetime.timedelta(hours=int(tz.lstrip('-')[:2]), 
                                minutes=int(tz.lstrip('-')[2:]))
    sign = -1 if tz.startswith('-') else 1
    time_dt = time_dt + sign * offset
    time_dt = time_dt.strftime('%Y%m%d_%H%M%S')

    return time_dt 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-02T18:40:52.710

您的时间戳以秒表示，您的时区以小时和分钟表示。只需减去或添加转换为秒的时区，然后使用 time.strftime 函数将其格式化为您想要的字符串：

```
def convertTime(seconds, tz):
    tzhours, tzminutes = map(int, (tz.lstrip('-')[:2], tz[-2:]))
    offset = tzhours * 3600 + tzminutes * 60
    if tz.startswith('-'):
        offset *= -1
    return time.strftime('%Y%m%d_%H%M%S', time.gmtime(seconds + offset)) 
```

# git - 有没有办法将 Git 分支上的提交限制为某些人？

> ID：11783571
> 
> 赞同：1
> 
> 时间：2012-08-02T18:27:07.067
> 
> 标签：git

我希望能够确保只有我们的自动化部署解决方案才能将代码从开发人员分支提升到我们的 QA 和我们的生产分支（实际上没有执行任何工作，除了很少且非常受控制的修补程序） . 即，我想确保开发人员只在开发人员分支上工作，并且不会错误地向我们的 QA 或生产分支提交任何内容。

有什么方法可以做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-02T18:35:20.243

### 使用石榴石

虽然您可能能够使用[预提交挂钩](http://git-scm.com/book/en/Customizing-Git-Git-Hooks)对共享的本地存储库进行一些有限的权限检查，但这通常不是一个好方法并且难以实施。在处理多个克隆场景时它也没有用。

当前的最佳实践是使用[gitolite](https://github.com/sitaramc/gitolite)和精心设计的分支权限[引用。](http://sitaramc.github.com/gitolite/refex.html)Gitolite 可能非常复杂，但它当然应该允许您将特定分支上的提交限制为单个用户或指定组。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-02T18:53:41.647

如果您想要一个用于访问控制配置的 GUI，那么您也可以尝试[Gerrit](http://code.google.com/p/gerrit/)。虽然 Gerrit 主要是一个代码审查工具，但它还支持细粒度的权限、组和不同的身份验证源（Openid、LDAP 等）。

# javascript - onclick 事件未触发 javascript

> ID：11783572
> 
> 赞同：1
> 
> 时间：2012-08-02T18:27:08.610
> 
> 标签：javascript, onclick

编辑＃2：

做了一个 JS Fiddle... [http://jsfiddle.net/N2p6G/](http://jsfiddle.net/N2p6G/)（我硬编码了一些我确定可以正常工作的东西，但问题仍然存在）

原来的：

所以，我已经编写了数万行 javascript，并且使用了数百次看起来像这样的代码，但我不明白发生了什么。

```
blacklistitembutton.onclick = function() {
  console.log("clicked.");
} 
```

上面的代码似乎不起作用......我不知道为什么

事实上，我之前在同一个文件中使用了相同的方法......而且效果很好！

```
settings.onclick = function() {
  settings_popup.toggle();
} 
```

编辑：

它可能与它在 for 循环中执行的事实有关吗？这是代码...

```
var blacklistButton = document.createElement('input');
blacklistButton.type = 'button';
blacklistButton.value = "Add Current Site to Blacklist";
blacklistButton.onclick = function() {
  console.log('blacklistButton clicked');
}

for (var i=0;i<blacklist.length;i++) {
  var blacklistitembutton = document.createElement('div');
  blacklistitembutton.type = 'button';
  blacklistitembutton.blacklistValue = blacklist[i];
  blacklistitembutton.value = "X";
  blacklistitembutton.onclick = function() {
    console.log("clicked.");
  }
} 
```

然后将 blacklistButton 和所有 blacklistitembuttons 通过 element.appendChild 放入文档中（它们都显示成功！）

blacklistButton onclick 触发得很好，而 blacklistitembutton onclick 则不会。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-02T18:38:46.367

```
document.addEventListener('click', function(){
    console.log('clicked');
}, false); 
```

编辑：

这是在小提琴中重新编写的代码：http: [//jsfiddle.net/N2p6G/1/](http://jsfiddle.net/N2p6G/1/)

你的代码中有很多让我担心的东西。希望从我的重写中你可以看到有更好的方法来处理一些事情。

1）我不确定你为什么一开始就使用 document.write() 。那没有什么目的。

2) 你对 DOM 的修改*太多*了。您在代码中创建的一些 DOM 元素最好用作 html 中的目标位置。只有动态创建的输入按钮元素需要在 javascript 中完成。请记住，应该尽可能少地修改 DOM。

3) 不要使用 onclick、onsubmit、onhover 等语法分配事件。事件只能使用 addEventListener 绑定到 DOM 元素。以正确方式执行此操作的另一个好处是，如果需要，您可以将多个相同类型的事件分配给同一个元素。此外，使用我未包含的一些额外状态代码，您可以在以后有选择地删除特定事件（如果需要）。

4) 几年前有过关于使用 innerHTML 和字符串模板是否比使用 DOM 创建方法更快/更好的争论。有一段时间，最好的解决方案是使用 documentFragments 和两种方法的组合。这些天来，它不再重要了，因为所有的浏览器都非常快，所以为了简单起见，最好只使用 innerHTML。

这也回到了“不要过多接触 DOM”的规则。如果您查看我的代码，您会发现我将最终的 html 简单地组装为一个元素数组，这些元素在末尾作为单个字符串连接。然后使用单个 innerHTML 语句将其渲染到 DOM。我只触摸 DOM 一次，而不是多次。

5) 最后一位再次进入事件。在代码的开头和结尾，您可以看到我在何处以及如何为 DOM 元素添加事件。实际上，可以将开头的 addEventListener 移到末尾以将所有事件声明组合在一起，但这并不重要。我将其留在顶部以帮助您更好地了解正在发生的事情。

希望这可以帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-02T21:18:00.183

解决它！

```
blacklistitem.innerHTML += blacklist[i]; 
```

^ 搞砸了，此时代码中的 blacklistitem 仍然是一个 javascript 项，尚未附加到文档中的潜在父元素

所以我只是将 blacklist[i] 粘贴到一个 span 标签中并作为一个孩子附加，现在它工作正常:)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-02T20:30:19.693

我不知道这是否是您放在这里的拼写错误，但在循环中您正在创建一个“div”，然后为其分配一种“按钮”。这有效还是抛出错误？如果是这样，那就解释了为什么事件处理程序没有获取该函数。尝试将其设为“输入”，看看它现在是否有效。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-02T18:44:08.553

对于无限的事件绑定，使用`addEventListener`或`attachEvent`方法。您不能使用该传统方法添加多个相同类型的事件。

# android - Android：动态生成的 ImageButtons 数组仅返回单击时创建的最后一个的信息

> ID：11783573
> 
> 赞同：0
> 
> 时间：2012-08-02T18:27:14.243
> 
> 标签：android, dynamic, for-loop, settext

我有一个活动，它生成并显示名为 MapCells 的自定义 ImageButtons 的 GridLayout（这是一个游戏地图，令人惊讶。） MapCells 是随机生成的，包含一些与地形类型相关的变量以及看起来不同的变量（图像）。当我运行我的代码时会发生什么，我得到了我可爱的随机地图，当我点击单元格时，他们应该在屏幕上烤他们的 id（诊断帮助）以及获取他们存储的变量并将它们设置为同一活动中的一些 TextView。当我单击 MapCells 时，它的实际工作方式是它们烘烤唯一的 ID（如预期的那样）并具有其独特的外观，但显示的地形值是在所有情况下生成的最后一个 MapCell。我以为这是我的“for”的结果 循环创建所有 MapCells 作为变量 q （在注释掉的代码中可见），我只是覆盖了每个循环，所以我将它重写为下面的代码，但是，我遇到了同样的问题。我看过的其他问题似乎表明给他们ID可以解决这个问题。有任何想法吗？

```
package com.<redacted>

import java.util.Random;

import android.app.Activity;
import android.content.Intent;
import android.os.Bundle;
import android.view.View;
import android.view.View.OnClickListener;
import android.widget.TableRow;
import android.widget.TextView;
import android.widget.Toast;

public class MapScreen extends Activity implements OnClickListener{
    private static int dimen = 110; //the side length of map cells
    private int currentFood;
    private String currentName;
    private MapCell[] storage = new MapCell[18];//keep the cells in here

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.map_screen); //the xml

  //It's Randy the randomizer!
    Random randy = new Random();

    //Generate 6 random MapCells per row for use in our map.
    //MapCell q; -this is old and unused now
    for(int i=0; i<=5; i++){
        //q = new MapCell(randy.nextInt(4), this); //create and randomize
        //q.setId(i); //issue identity
        storage[i] = new MapCell(randy.nextInt(4), this); //shove it in the array
        storage[i].setId(i);
        storage[i].setOnClickListener((OnClickListener) this);
        //q.setOnClickListener((OnClickListener) this);
        ((TableRow)findViewById(R.id.mapRow01)).addView(storage[i], dimen, dimen); //add cell to display
    }
    for(int j=0; j<=5; j++){
        //q = new MapCell(randy.nextInt(4), this);
        //q.setId(j+6);
        //storage[q.getId()] = q; //shove it in the array
        //q.setOnClickListener((OnClickListener) this);
        storage[j+6] = new MapCell(randy.nextInt(4), this); //shove it in the array
        storage[j+6].setId(j+6);
        storage[j+6].setOnClickListener((OnClickListener) this);
        ((TableRow)findViewById(R.id.mapRow02)).addView(storage[j+6], dimen, dimen); //add cell to display
    }
    for(int k=0; k<=5; k++){
        //q = new MapCell(randy.nextInt(4), this);
        //q.setId(k+12);
        //storage[q.getId()] = q; //shove it in the array
        //q.setOnClickListener((OnClickListener) this);
        storage[k+12] = new MapCell(randy.nextInt(4), this); //shove it in the array
        storage[k+12].setId(k+12);
        storage[k+12].setOnClickListener((OnClickListener) this);
        ((TableRow)findViewById(R.id.mapRow03)).addView(storage[k+12], dimen, dimen); //add cell to display
    }
}

public void displayCell(MapCell view){
    //get the cell name view and then set its text to be the name of the clicked cell
    try{ //we need to try in case it feeds in a non-MapCell view
        currentName = storage[view.getId()].getName();
        ((TextView)findViewById(R.id.mapDisplayName)).setText(currentName);
        currentFood = storage[view.getId()].getFood();
        ((TextView)findViewById(R.id.mapDisplayFood)).setText(String.valueOf(currentFood));
        Toast.makeText(this, "Cell " + String.valueOf(view.getId()), Toast.LENGTH_SHORT).show(); //diagnostic line
    }
    catch (Exception x){
        //frowny time
        Toast.makeText(this, "Something Broke on cell " + String.valueOf(view.getId()) + " :(", Toast.LENGTH_SHORT).show();
    }
}

public void onClick(View v){//when we click a MapCell
    displayCell((MapCell)v);// feed it in
} 
```

}

那是相关的类。如果您要求，我可以向您展示 MapCell，但它只是一个 ImageButton，带有一些添加的变量，以便与 getter 一起使用。这些变量由 switch case 使用构造函数中提供的随机整数设置。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-02T19:32:34.983

由于我认为您的代码没有任何问题，因此我将在黑暗中试一试。在您的 MapCell 类中，保存地形值的变量是否使用**静态**修饰符定义？

# jquery - Jquery slideup/slidedown第二次不起作用

> ID：11783574
> 
> 赞同：1
> 
> 时间：2012-08-02T18:27:24.410
> 
> 标签：jquery, slidedown, slideup

我正在尝试编写一个代码来显示包含基于选择框的表单元素的 div 框。我认为解释这个问题的最简单方法是举一个例子。

[http://jsfiddle.net/544rc/1/](http://jsfiddle.net/544rc/1/) 如果你看看这个小提琴。请尝试以下方法：

首先选择选项1，出现searchform 1..这是正确的。选择选项 3，出现搜索表单 1 和 2，这也是正确的，但现在，当您再次选择选项 1 时。当它应该显示搜索表单 1 时，没有出现任何表单。

当谈到 jQuery 时，我是个菜鸟，所以如果我的脚本不够漂亮，你知道原因。

我的 jQuery：

```
$(document).ready(function() {
$("#select").change(function() {

    var val = $(this).val();

    if (val == "value1" || val == "value2") { //check if value 1 or 2 are selected

        $("#search2").slideDown("fast"); //Slide Down Effect
        $("#search1").slideUp("fast");

    } else {

        $("#search1").slideUp("fast"); //Slide Down Effect
        $("#search1").slideUp("fast");

    }

    $("#select").change(function() {

        var val = $(this).val();

        if (val == "value3" || val == "value4" || val == "value5") { // check if value 3, 4 or 5 are selected

            $("#search1").slideDown("fast"); //Slide Down Effect
            $("#search2").slideDown("fast");

        } else {

            $("#search1").slideUp("fast"); //Slide Down Effect
            $("#search2").slideUp("fast");

        }
    });
}); 
```

});​</p>

HTML：

```
<form id="indexsearch" method="post" action="#"> <!-- searchform -->
        <div class="soortselect">
            <label for="select">Ik zoek:</label>
            <select name="select" id="select" > <!-- select box -->
                <option value="">(choice)</option>
                <option value="value1">option 1</option>
                <option value="value2">option 2</option>
                <option value="value3">option 3</option>
                <option value="value4">option 4</option>
                <option value="value5">option 5</option>
            </select>
        </div>

        <div class="hide" id="search1"> <!--hidden search form 1 -->
            <div class="soortselect">
                <label for="edu">Opleiding</label>
                    <input name="edu" type="text" id="edu" ><br />
            </div>
        </div>

        <div class="hide" id="search2"> <!-- hidden search form 2 -->
            <div class="soortselect">
                <label for="postal">Postcode</label>
                    <input name="postal" type="text" id="postal"><br />
                <label for="name">Name</label>
                     <input name="name" type="text" id="name"><br />
                    <input name="vind2" type="submit" id="vind" value="Vind!">
            </div>
        </div>
    </form> 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-02T18:37:57.730

试试这个 jsFiddle：http: [//jsfiddle.net/544rc/4/](http://jsfiddle.net/544rc/4/)

根据我所看到的，您只需要添加另一个 else if 语句（检查值 3、4、5）。

如果再次选择时向上滑动，我添加了另一个`(choice)`。

这是更新的 Javascript：

```
$(document).ready(function() {

    //On Select Change...
    $("#select").change(function() {

        //Get Current Value
        var val = $(this).val();

        //If the value is the 1st or 2nd dropdown...
        if (val == "value1" || val == "value2") {
            //Slide down the second search form and slide up the first
            $("#search2").slideDown("fast"); //Slide Down Effect
            $("#search1").slideUp("fast");
        } 
        //If the value is the 3rd, 4th, or 5th dropdown...
        else if(val == "value3" || val == "value4" || val == "value5") {
            //Slide down both the forms
            $("#search1").slideDown("fast"); //Slide Down Effect
            $("#search2").slideDown("fast");
        } 
        //If the value is nothing (choice is selected)...
        else{
            //Slide up both forms
            $("#search1").slideUp("fast");
            $("#search2").slideUp("fast");
        }
    });
});​ 
```

我删除了您的原始`else`声明，因为它不需要。

# javascript - Chrome RangeError：使用 jQuery $.map 时超出了最大调用堆栈大小

> ID：11783575
> 
> 赞同：4
> 
> 时间：2012-08-02T18:27:24.683
> 
> 标签：javascript, jquery, google-chrome, web-applications, browser

我正在为我的雇主测试一个 Web 应用程序，其中涉及从服务器检索大量数据。[使用$.ajax](http://api.jquery.com/jQuery.ajax/)函数将数据作为 JSON 对象返回，其中包含大量子对象，我使用 jQuery 的[$.map](http://api.jquery.com/map/)函数将其转换为数组，如下所示

```
data_points = $.map(result.data.LotsOfIt, function(value, ndx){
              return value;
          }); //Throws Maximum call stack size exceeded with large data set. 
```

这似乎耗尽了 Chrome 的堆栈大小限制，每次我运行这个函数 Chrome 都会抛出**RangeError: Maximum call stack size exceeded**。如果我减少返回的数据量，它就可以正常工作。有趣的是，FireFox 和 IE9 可以很好地处理更大的数据集，但我认为 Chrome 的堆栈大小限制比这些浏览器中的任何一个都大，所以我预计它们也会失败。有没有其他人遇到过这个问题？有解决方法吗？或者我是否必须更新我的代码以限制返回的数据量以避免此错误？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-22T19:57:44.823

好的，所以在做了一些阅读之后，我怀疑这个问题与 $.map 实现中的递归调用有关，它导致 Chrome 浏览器堆栈溢出。我不得不重新编写代码以手动以非递归方式迭代返回的 JSON 对象的集合。在重构代码以对锥体处的整个集合使用 $.map 后，堆栈溢出问题不再出现。

# php - 如何删除 http://www. 来自 php 数组

> ID：11783585
> 
> 赞同：-2
> 
> 时间：2012-08-02T18:27:52.043
> 
> 标签：php

如何删除 http://www. 从 php 数组，

这是显示商店网址的代码，我只想显示 domain.com 而不是[http://www.domain.com](http://www.domain.com)，也可能显示为[http://domain.com](http://domain.com)

代码：`<p class="store-url"><a href="<?php echo $url_out; ?>" target="_blank"><?php echo $stores_url; ?>`

由于此功能，它显示为这样

```
<div class="store"> 

<?php // grab the store meta data 
$term = get_term_by('slug', get_query_var('term'), get_query_var('taxonomy'));
$stores_url = esc_url(get_metadata(APP_TAX_STORE, $term->term_id, 'clpr_store_url', true));
$dest_url = esc_url(get_metadata(APP_TAX_STORE, $term->term_id, 'clpr_store_aff_url', true));

// if there's a store aff link, then cloak it. else use store url
if ($dest_url)
$url_out = esc_url(home_url(CLPR_STORE_REDIRECT_BASE_URL . $term->slug));
else
$url_out = $stores_url; 

?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-02T18:34:47.513

尝试：

```
<?php $stores_url = preg_replace('/^https?:\/\/(?:www\.)?/i', '', $stores_url); ?>
<p class="store-url"><a href="<?php echo $url_out; ?>" target="_blank">
    <?php echo $stores_url ?>
</p> 
```

它将删除`http://`或`https://`从 URL 的开头以及`www`如果它跟随。

# javascript - 联系表格代码定制

> ID：11783596
> 
> 赞同：1
> 
> 时间：2012-08-02T18:28:20.577
> 
> 标签：javascript, jquery, html

[嗨 - 我已经根据这个地址http://designwoop.com/2012/07/tutorial-coding-a-jquery-popup-modal-contact-form/](http://designwoop.com/2012/07/tutorial-coding-a-jquery-popup-modal-contact-form/)上的教程在我的网站上实现了一个联系表单 它工作正常，唯一的问题是我想在表单中添加一个字段“名称”。

于是我在表单的html代码中加入了这行代码：

```
<input id="name" class="txt" type="name" name="name" placeholder="name"/><br /> 
```

修改后的表格代码：

```
<form id="contact" action="#" method="post" name="contact">
<label for="name">Your Name</label>
<input id="name" class="txt" type="name" name="name" placeholder="name"/><br />
<label for="email">Your E-mail</label>
<input id="email" class="txt" type="email" name="email" placeholder="e-mail address"/>
<br />
<textarea id="msg" class="txtarea" name="msg" placeholder="Type your message here..."></textarea>
<button id="send">Send E-mail</button>
</form> 
```

我还将它添加到发送邮件 php 文件中：

```
$msg .= "<p><strong>From:</strong> ".$username."</p>\r\n"; 
```

发送邮件 php 文件的完整代码：

```
?php
$sendto   = "myemail@gmail.com";
$usermail = $_POST['email'];
$content  = nl2br($_POST['msg']);

$subject  = "New Message frm";
$headers  = "From: " . strip_tags($usermail) . "\r\n";
$headers .= "Reply-To: ". strip_tags($usermail) . "\r\n";
$headers .= "MIME-Version: 1.0\r\n";
$headers .= "Content-Type: text/html;charset=utf-8 \r\n";

$msg  = "<html><body style='font-family:Arial,sans-serif;'>";
$msg .= "<h2 style='font-weight:bold;border-bottom:1px dotted #ccc;'>New message</h2>\r\n";
$msg .= "<p><strong>From:</strong> ".$username."</p>\r\n";
$msg .= "<p><strong>E-mail:</strong> ".$usermail."</p>\r\n";
$msg .= "<p><strong>Message:</strong> ".$content."</p>\r\n";
$msg .= "</body></html>";

if(@mail($sendto, $subject, $msg, $headers)) {
        echo "true";
} else {
        echo "false";
}

?> 
```

最后一部分：联系表单的 javascript 代码。这就是我想我需要添加对我添加的新字段“名称”的引用的地方。但不知道在哪里？（并且还使该字段成为强制性的）。您的帮助将不胜感激。非常感谢

```
// JavaScript Document
function validateEmail(email) {
                var reg = /^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;
                return reg.test(email);
        }

        $(document).ready(function() {
                $(".modalbox").fancybox();
                $("#contact").submit(function() { return false; });

                $("#send").on("click", function(){
                        var emailval  = $("#email").val();
                        var msgval    = $("#msg").val();
                        var msglen    = msgval.length;
                        var mailvalid = validateEmail(emailval);

                        if(mailvalid == false) {
                                $("#email").addClass("error");
                        }
                        else if(mailvalid == true){
                                $("#email").removeClass("error");
                        }

                        if(msglen < 4) {
                                $("#msg").addClass("error");
                        }
                        else if(msglen >= 4){
                                $("#msg").removeClass("error");
                        }

                        if(mailvalid == true && msglen >= 4) {
                                // if both validate we attempt to send the e-mail
                                // first we hide the submit btn so the user doesnt click twice
                                $("#send").replaceWith("<em>sending...</em>");

                                $.ajax({
                                        type: 'POST',
                                        url: 'sendmessage.php',
                                        data: $("#contact").serialize(),
                                        success: function(data) {
                                                if(data == "true") {
                                                        $("#contact").fadeOut("fast", function(){
                                                                $(this).before("<p><strong>Success! Your message has been sent, thank you.</strong></p>");
                                                                setTimeout("$.fancybox.close()", 1000);
                                                        });
                                                }
                                        }
                                });
                        }
                });
        }); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-02T18:37:42.443

将以下代码替换为：

```
var emailval  = $("#email").val();
var msgval    = $("#msg").val();
var msglen    = msgval.length;
var mailvalid = validateEmail(emailval);
//Get our name
var nameval = $("#name").val();
//Get our name length
var namelen = nameval.length; 
```

然后下

```
 if(msglen < 4) {
                        $("#msg").addClass("error");
                }
                else if(msglen >= 4){
                        $("#msg").removeClass("error");
                } 
```

添加这个

```
 if(namelen < 2) {
            //name must be at least 2 characters
                    $("#name").addClass("error");
            }
            else if(namelen >= 2){
                    $("#name").removeClass("error");
            } 
```

这就是 JavaScript 完成的！

对于 PHP 部分搜索：

```
$usermail = $_POST['email']; 
```

添加：

```
$username = $_POST['name']; 
```

试试我的朋友:)

# javascript - ajax文件上传图片获取高度和宽度

> ID：11783603
> 
> 赞同：0
> 
> 时间：2012-08-02T18:28:33.023
> 
> 标签：javascript, jquery, ajax, file-upload

我希望能够更改使用 ajax 上传的图像的高度。

这是我的代码：

```
$(function(){
$("#submitimage").click(function(){
    var data = new FormData(),
        // ClientHeight is not getting the image height it is getting the height of some other element.
        height = $("#file")[0].clientHeight,
        width = $("#file")[0].clientWidth,
        FileName = $("#file").val();
    console.log(height);
    console.log(width);
    FileName = FileName.replace("C:\\fakepath\\", "");
    data.append('file', $('#file')[0].files[0]);
    $.ajax({
        type: "POST",
        url: "upload_file.php",
        cache: false,
        contentType: false,
        processData: false,
        data: data,
        success: function(data) {
            newimage = "<br><img src='uploadedimages/"+FileName+"' width='"+width+"' height='"+height+"' alt='new image' /><br>";
            $(newimage).appendTo(".current-bulletin");
        }
    });
}); 
```

});

我使用 console.log 来获取它返回的高度和宽度，它总是 22x272，所以我相信 clientheight 正在获取文件按钮高度或类似的东西。

我可以从那里获得高度，还是在加载图像后以某种方式获得图像的高度然后更改它会更好？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-02T21:57:52.363

所以使用javascript我仍然没有找到这样做，但是我给图像一个类 new-img 并在 css 中使它有一个 max-width: 100%; 我能做的最好的。

# javascript - 从 shell 脚本中杀死 Node.js 程序

> ID：11783605
> 
> 赞同：0
> 
> 时间：2012-08-02T18:28:40.543
> 
> 标签：javascript, node.js, phantomjs

我正在运行一个 node.js 应用程序，它充当中间人代理来代理我通过 PhantomJS 无头测试环境发出的所有请求。我想从我的 PhantomJS 测试脚本（尽管我已经研究过它，似乎 phantom 没有`exec()`用于执行 shell 命令的命令）或一个管理这两个进程的小型 shell 脚本来启动这个代理。理想情况下，它会做类似的事情

```
#!/bin/bash
node proxy.js
phantomjs runTests.js
kill node process here 
```

有什么办法可以做到这一点吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-02T19:25:33.043

在提出这个问题后不久，我发现了一种更好的方法，可以使用子进程从我的节点应用程序中执行幻像程序。我将幻影脚本放在包含我的节点应用程序的文件夹中，然后像这样使用 exec：

```
var exec = require('child_process').exec;
var _phantom = exec('phantomjs runTests.js',function(error,stdout,stderr){
    console.log(stdout);
};

_phantom.on('exit',function(code,sig){
    process.exit(code);
}); 
```

这意味着我可以启动我的代理服务器，然后执行子进程。该`_phantom.on('exit')`块允许我检测进程何时退出代码。然后，使用 . 向节点应用程序发出退出信号非常简单`process.exit`。

# sql - 用于用户可选计划和使用 PIVOT 选择的表设计

> ID：11783608
> 
> 赞同：1
> 
> 时间：2012-08-02T18:28:46.193
> 
> 标签：sql, sql-server-2008, pivot

我正在创建一个日程安排应用程序，允许员工输入存储在表格中的所需日程安排。我正在查看的当前设计如下使用 SQL 2008 R2。

```
CREATE TABLE [dbo].[Schedule] (
    [EmpNum] [varchar](10) NOT NULL,
    [Start] [datetime] NOT NULL,
    [Length] [decimal](18, 2) NOT NULL,
    [Reason] [varchar](1) NOT NULL,

    CONSTRAINT [PK_Schedule] PRIMARY KEY CLUSTERED 
    (
        [EmpNum] ASC,
        [Start] ASC
    )
) 
```

需要注意的几点

*   用户可能没有输入特定日期范围的时间表，但仍希望看到他们的姓名列出但没有时间表
*   用户可以在一周中的某一天不选择任何内容，但在其他日子选择某些内容
*   **开始**是转变的开始
*   **长度**是一个班次的小时数，可能会因人而异，因人而异
*   **原因**列用于用户选择的内容（W - 工作、P - PTO 等）

这是示例数据

```
EmpNum     Start                   Length                                  Reason
---------- ----------------------- --------------------------------------- ------
000001     2012-08-02 09:00:00.000 12.00                                   W
000001     2012-08-04 08:00:00.000 9.50                                    P
000002     2012-08-02 08:30:00.000 10.00                                   W
000002     2012-08-03 19:00:00.000 12.00                                   W
000003     2012-08-03 08:00:00.000 8.00                                    P 
```

我想要的输出是这样的

```
EmpNum     [0]    [1]    [2]    [3]    [4]    [5]    [6]
---------- ------ ------ ------ ------ ------ ------ ------
000001     NULL   NULL   NULL   NULL   W      NULL   P
000002     NULL   NULL   NULL   NULL   W      W      NULL
000003     NULL   NULL   NULL   NULL   NULL   P      NULL 
```

自从我们刚刚从 SQL 2000 升级以来，我以前从未使用过`PIVOT`查询，所以请耐心等待。我已经构建了以下查询，该查询因以下错误而失败并且我被卡住了。

```
Msg 102, Level 15, State 1, Line 14
Incorrect syntax near '('. 
```

询问

```
declare @FirstDayOfWeek date
set @FirstDayOfWeek = '7/29/2012'

select EmpNum,
@FirstDayOfWeek [0],
dateadd(day, 1, @FirstDayOfWeek) [1],
dateadd(day, 2, @FirstDayOfWeek) [2],
dateadd(day, 3, @FirstDayOfWeek) [3],
dateadd(day, 4, @FirstDayOfWeek) [4],
dateadd(day, 5, @FirstDayOfWeek) [5],
dateadd(day, 6, @FirstDayOfWeek) [6]
from Schedule
pivot (
    max(Reason)
    for Start in ([0], [1], [2], [3], [4], [5], [6])
) as Pvt 
```

关于如何最好地实现这一点或我在这里有多么严重的错误有什么想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-02T18:33:22.983

看起来您正在尝试根据第 1-7 周的日期来透视您的数据。我建议对此稍作改动以使其正常工作：

```
SELECT *
FROM
(
    select EmpNum,
        reason,
        datepart(dw, start) as DyOfWk
    from #Schedule
) s
pivot (
    max(Reason)
    for dyofwk in ([1], [2], [3], [4], [5], [6], [7])
) as Pvt 
```

请参阅[带有演示的 SQL Fiddle](http://sqlfiddle.com/#!3/111f1/1)

结果：

![在此处输入图像描述](../Images/c62b96da575021300e1975853fbca788.png)

# php - 使用 PHP 导出 CSV 文件数据

> ID：11783610
> 
> 赞同：0
> 
> 时间：2012-08-02T18:29:04.973
> 
> 标签：php, mysql, arrays, csv

我在mysql表中有如下数据：

```
INSERT INTO `camp_expense` (`expense_id`, `camp_regtype`, `camp_name`, 
       `camp_date`, `expense_name`, `expense_amount`, `expense_total`, 
       `calculation_date`, `expense_status`) VALUES (1, 'Free', 'Sharekhan', 
       '2012-07-27 10:05:pm', '["Petrol / Conveyance"]', '["1000"]', '1000', 
       '31-07-2012 ', ''), (2, 'Free', 'Sharekhan', '2012-07-27 10:05:pm', 
       '["Tea / Water","Staff Incentives"]', '["1000"," 10000"]', '11000', 
       '31-07-2012 ', ''), 
```

在此第 5 列包含数组格式的数据。当我尝试以 CSV 格式导出它时；第 5 列中的数据显示为数组。我不想在结果中显示数组。我想以列格式显示第 5 列数据。这可能在使用 PHP 的 CSV 格式中吗？

谢谢 Onkar Kubal

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-02T18:35:27.977

我会认为第 5 个字段是 JSON 数组。如果是这样，您可能需要`json_decode`先对其进行编码，然后将其编码为 CSV。您可以使用适当的库，但也`join(',' $array)`可以这样做。

# jquery - 为什么 .index() 总是返回 0

> ID：11783612
> 
> 赞同：7
> 
> 时间：2012-08-02T18:29:11.123
> 
> 标签：jquery

我对为什么 .index() 在这段代码中返回 0 感到困惑。它不应该返回它在 jquery 对象数组中的位置的索引吗？

```
<div id="nav">
       <ul><a href="#">Link 1</a></ul>
       <ul><a href="#">Link 2</a></ul>
       <ul><a href="#">Link 3</a></ul>
       <ul><a href="#">Link 4</a></ul>    
</div>
<div class="parent">
    <div class="a">
        <p>this is a</p>
    </div>   
    <div class="b">
        <p>this is b</p>
    </div>
    <div class="c">
        <p>this is c</p>
    </div>
    <div class="d">
        <p>this is d</p>
    </div>
</div> 
```

jQuery代码

```
 $('#nav a').click(function() {
    console.log($(this).index());
    var $div = $('.parent > div').eq($(this).index());
    $div.show();
    $('.parent > div').not($div).hide();
});​ 
```

我必须使用`$(this).index('#nav a')`才能获得正确的索引。

[http://jsfiddle.net/HpCWW/2/](http://jsfiddle.net/HpCWW/2/)

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-08-02T18:31:01.523

`index`总是`0`因为`<a>`是其父级中的第一个孩子（`<ul>`）。

尝试获取`<ul>`' 索引。

```
$(this).parent().index() 
```

注意：您的 HTML 无效。s的唯一有效子代`<ul>`是`<li>`s。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-09-05T19:46:53.927

`.index()`可能返回的另一个原因`0`是，如果您像这样使用它：

```
$('matched elements').click(function(){
    console.log($(this).index()); // will be 0 in some cases
}); 
```

正确方法：

```
$('matched elements').click(function(){
    console.log($('matched elements').index($(this))); // will be the index within set of matched elements
}); 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-08-02T18:33:29.840

您的锚元素没有任何兄弟姐妹，因此它们的索引均为 0。它们都嵌套在自己的`<ul>`中，如果我没记错的话，这是`<li>`在锚点周围不包含的无效标记。

我会将您的 HTML 更改为：

```
<div id="nav">
    <ul>
        <li><a href="#">Link 1</a></li>
        <li><a href="#">Link 2</a></li>
        <li><a href="#">Link 3</a></li>
        <li><a href="#">Link 4</a></li>
    </ul>
</div>
<div class="parent">
    <div class="a">
        <p>this is a</p>
    </div>   
    <div class="b">
        <p>this is b</p>
    </div>
    <div class="c">
        <p>this is c</p>
    </div>
    <div class="d">
        <p>this is d</p>
    </div>
</div> 
```

而你 JS 对此：

```
$('.parent  div').hide();

$('#nav a').click(function() {
    // Notice, I'm going up to the parent <li> and then calling index().
    var $div = $('.parent > div').eq($(this).parent().index());
    $div.show();
    $('.parent > div').not($div).hide();
});​ 
```

[工作示例](http://jsfiddle.net/B6zFR/)

# android - Phonegap / jquery移动应用程序上的正确页面导航

> ID：11783614
> 
> 赞同：0
> 
> 时间：2012-08-02T18:29:17.787
> 
> 标签：android, jquery-mobile, cordova

我正在使用 phonegap 和 jquery mobile，但在返回页面时遇到问题。有四个页面：

溅

登录

主要的

子主

所以让我们说这样的流程总是首先击中启动画面。如果用户以前从未登录过，则会显示登录屏幕，如果有，则会显示主页。这是一个场景：

新用户将像这样导航：

溅

登录

主要的

子主

现在从子主屏幕，如果他们想退出，他们将点击后退按钮，直到他们退出。但是，当我希望他们在他们回击主屏幕时退出应用程序时，这条路线将再次引导他们通过登录页面和启动屏幕。

有没有办法让用户在按主键时退出？

我意识到我可以通过禁用后退按钮并添加退出按钮来避免这种情况。

我不确定这是否重要，但我的所有页面都在一个 html 文件中，由具有 `data-role="page"` 属性的 div 分隔

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-03T13:18:14.173

我想`navigator.app.exitApp()`这就是你要找的。当我们手动跟踪历史记录时，我们的辅助函数看起来类似于：

```
function backKeyDown(){
    if(historyContainsInfo(){
        popHistory();
    }else{
        navigator.app.exitApp();
    }
} 
```

并通过以下方式注册`document.addEventListener("backbutton", backKeyDown, true);`

# php - Cakephp 警告 - 无法打开流

> ID：11783617
> 
> 赞同：1
> 
> 时间：2012-08-02T18:29:30.250
> 
> 标签：php, cakephp

这是我第一次尝试使用蛋糕，我想我开始发疯了。我完全不知道它有什么问题！检查后文件似乎在正确的位置。

在系统路径中 cake 指向 inetpub ，因为应用程序在 WAMP 中，这与它有什么关系吗？

当我尝试将系统路径指向 WAMP 时，什么也没发生！命令控制台说 cake 是无效命令...

任何人都知道如何解决以下错误？

非常感谢任何帮助

![](../Images/f3f6087b6947199f1597d2d72384fda0.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-02T19:55:23.720

看起来你只需要改变`CAKE_CORE_INCLUDE_PATH`就`APP/webroot/index.php`可以找到核心。这就是它找不到引导文件的原因。

首先尝试取消注释定义常量的行。如果这不起作用，您可以尝试硬编码蛋糕核心的路径。

# java - 推土机仅在接收 bean 映射字段为空时复制

> ID：11783621
> 
> 赞同：1
> 
> 时间：2012-08-02T18:29:49.280
> 
> 标签：java, javabeans, dozer

我如何配置推土机，如果 bean b 中的字段为空，它只会将 bean a 中的一个字段的值复制到 bean b 中的一个字段？我正在使用 dsl 配置

```
mapping(FirstGivingPayloadV1.Payload.class, Nonprofit.class, oneWay(),
        mapNull(false), mapId("firstGivingPayloadV1"))
        .fields("latitude", "latitude")
        .fields("longitude", "longitude")
        .fields("revoked", "isNonProfitStatusVerified");
        .fields("url", "websiteUrl"); // only copy url if webSiteURL == null or is empty 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-03T09:40:54.947

为此字段转换编写自定义转换器。自定义转换器应检查 bean 中的字段`b`是否为空，以及是否将字段复制`a`到其中。

从推土机文档：

在下面的示例中，Dozer 将调用自定义转换器来执行字段映射。

```
<mapping>
  <class-a>org.dozer.vo.SimpleObj</class-a>
  <class-b>org.dozer.vo.SimpleObjPrime2</class-b>    
  <field custom-converter-id="CustomConverterWithId">
    <a>field1</a>
    <b>field1Prime</b>
  </field>
</mapping> 
```

在自定义转换器中，您可以访问目标对象，您可以检查它是否为空，查看`convert`方法签名：

```
public class TestCustomConverter implements CustomConverter {
 public Object convert(Object destination, Object source, Class destClass, Class sourceClass) {... 
```

# python - 我如何让我的程序继续使用 python 中的下一个 elif

> ID：11783622
> 
> 赞同：-1
> 
> 时间：2012-08-02T18:29:48.437
> 
> 标签：python, if-statement

```
import random
print"hello what is your name?"
name = raw_input()
print"hello", name
print"wanna play a game? y, n"
choice = raw_input()
if choice =='y':
    print'good lets start a number guessing game'

elif choice =='n':
    print'maybe next time'
    exit()

random.randint(1,10)
number = random.randint(1,10)
print'pick a number between 1-10'
numberofguesses = 0
guess = input()

while numberofguesses < 10:
 if guess < number:
    print"too low"
 elif guess > number:
        print"too high"
 elif guess == number:
        print'your correct the number is', number
 break
if guess == number:
    print'CONGRATS YOU WIN THE GAME' 
```

当我在程序中输入我的猜测时，它只给我一个输出，例如我输入 8 个程序输出“太高”但是当我再次猜测输出为空白时，我该如何解决这个问题？你好，你叫什么名字？

```
 ed
    hello ed
    wanna play a game? y, n
    y
    good lets start a number guessing game
    pick a number between 1-10
    2
    too low
    >>> 5
    5
    >>> 3
    3
    >>> 2
    2
    >>> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-02T18:33:39.433

我认为这就是你想要的：

```
numberofguesses = 0

while numberofguesses < 10:
 guess = input()  #int(raw_input("Pick a number between 1 and 10: ")) would be much better here.
 numberofguesses+=1
 if guess < number:
    print "too low"
 elif guess > number:
    print "too high"
 elif guess == number:
    print 'your correct the number is', number
    break 
```

使用您的代码版本，您猜一次。如果你错了，你的程序会一遍又一遍地尝试相同的猜测（假设你`break`实际上应该缩进`elif`. 您可能会在终端中输入新的猜测，但您的程序永远不会看到它们。如果它`break`实际上在您的代码中的正确位置，那么您猜测一次，无论写入还是错误，它都会立即退出循环。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-02T18:34:06.083

你的休息在你的 if 语句之外

它将执行一次while循环并无论如何都会中断

# javascript - jQuery：如果单击复选框动画 div

> ID：11783624
> 
> 赞同：1
> 
> 时间：2012-08-02T18:29:52.320
> 
> 标签：javascript, jquery, html, checkbox, jquery-animate

我的代码中有错误并发症。我已经研究了几个小时来寻找解决方案。这是我想要实现的目标：

我有一个包含 6 个复选框的页面。`.control-case`每个复选框周围都有一个包装 div 。如果选中了 5 个复选框，则剩余的复选框`.control-case`将添加一个类`.unselected`。

现在，如果单击此包装器`.control-case .unselected`，那么我有一个通知范围，我想使用 jQuery 颜色进行动画处理。

**好消息：**当它被点击时它有些工作。

**坏消息：**它有时会不时触发没有类的 div，并且它还可能重复颜色更改（我假设是由于队列备份）。如何仅在单击时才允许在正确的 div 上触发一次？

PS我也试过这个`.hasClass`方法。没有成功。

这是我的代码： http: [//pastebin.com/8XR7iHp2](http://pastebin.com/8XR7iHp2)

感谢大家的支持！:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-02T19:52:35.033

每次运行此代码时，

```
$('#type-controls .control-case.unselected').click(function() { 
```

一个新的单击处理程序实际上已添加到您的代码中。因此，造成重复烧制。我用另一种方法重写了你的代码。看看它是否满足你的要求。

```
 $(document).ready(function() {
        $('input:checkbox#foam-control, input:checkbox#reversecurve-control, input:checkbox#ultra-control, input:checkbox#pro-control, input:checkbox#icebreaker-control').attr('checked', true);
        $("#type-controls input[type=checkbox]").click(function() {
            var countchecked = $("#type-controls input[type=checkbox]:checked").length;
            if (countchecked >= 5) {
                $('#type-controls input[type=checkbox]').not(':checked').attr("disabled", true);
            }
            else {
                $('#type-controls input[type=checkbox]').not(':checked').attr("disabled", false);
            }
        });

        $("#type-controls label").click(function() {
            var countchecked = $("#type-controls input[type=checkbox]:checked").length;
            if (countchecked >= 5 && $(this).parent().hasClass('unselected')) {
                alert("Do notice");
                $('.max-notice').animate({
                    'backgroundColor': '#c30c08',
                    'color': '#fff'
                }, 400).delay(3000).animate({
                    'backgroundColor': '#fff',
                    'color': '#777'
                }, 300);
            }
        });
    });​ 
```

[您可以在http://jsfiddle.net/w7djF/1/](http://jsfiddle.net/w7djF/1/)查看演示

# java - xml SAX 解析未返回所需的结果

> ID：11783626
> 
> 赞同：0
> 
> 时间：2012-08-02T18:29:59.920
> 
> 标签：java, android

我有一个由我的客户提供的 xml，如下所示：

```
<?xml version='1.0' encoding='UTF-8' ?><quizzes updatetimestamp='2012-08-01 06:24'><quiz q_id='1'>
<q_name>Airplane!</q_name >
<q_appleid>com.patelware.moviesquiz.free</q_appleid>
<q_description>"Roger, Roger"</q_description>
<q_urlicon>http://www.inall3.com/king/icons/airplane_icon.png</q_urlicon>
<q_urlmainimg>http://www.inall3.com/king/icons/airplane_main.png</q_urlmainimg>
<q_urldb>http://www.inall3.com/king/dbs/airplane.xml</q_urldb>
<q_timesofupload>2011-05-01 00:00:00</q_timesofupload>
<q_priceindollar>0.00</q_priceindollar>

<q_cattype>Comedy</q_cattype>
<q_thighscore>http://www.inall3.com/hs/highscoreairplane.php?action=gethighscores&amp;mode=1</q_thighscore>
<q_phighscore>http://www.inall3.com/hs/highscoreairplane.php?action=gethighscores&amp;mode=2</q_phighscore>
</quiz> 
```

但是当我使用 SAX 解析器解析它时，一切都会正确返回，但是当我尝试解析`<q_thighscore>`或它只`<q_phighscore>`返回`mode=1`and`mode=2`时，但我想要解析完整链接，问题出在哪里，我现在该怎么办？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-02T19:32:47.630

您可能想使用 sax 默认处理程序。看看它是否有效。如果不是，可能需要扩展默认处理程序并覆盖此方法的行为以正确存储值。其中 myURLString 是您在扩展类中定义的变量。然后可以在 endElement 方法中访问此变量，例如。您可以完全控制这里。

所以一种方法是扩展 org.xml.sax.helpers.DefaultHandler;

并覆盖如下

```
 protected String myValueString;

   @Override
   public void characters(char[] ch, int start, int length) throws SAXException
   {
    super.characters(ch, start, length);  // deal with escape values here.
            myValueString = ...

    }

then inside   endElement(){

   check if matches your type and if so use myValueString; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-02T21:26:23.093

我已经解决了，我只是使用了 Pull 解析器而不是 SAX 解析器，它工作了:)

# php - 考虑多个函数调用

> ID：11783628
> 
> 赞同：0
> 
> 时间：2012-08-02T18:30:14.910
> 
> 标签：php, mysql

我正在使用一些在我开始工作之前就已经存在的代码。开发人员已经离开，由我来添加一些附加功能。

我正在做的是在 php 脚本的某些部分将时间戳记录到 MySQL DB。

我的问题是脚本被调用了两次。我只能找到被调用一次的实际函数。

```
Database Table
--------------
id    |  userID  | event  |  timestamp
---------------------------------------
1     |   4      |  5     | 2012-08-02 09:09:18 
```

我的问题是，是否有人知道在 2 秒内停止多个数据库调用的方法。

编辑：最好没有第二个数据库调用

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-02T18:33:17.503

如果您的 PHP 被调用两次，请添加`POST/GET`页面将提交并检查的参数，在第一次调用时此参数将有一个`NULL`值，但在每次重复调用时它将有一个值，您可以使用此值来防止脚本更新数据库。

# java - 如何在 Java 中加载和使用本机库？

> ID：11783632
> 
> 赞同：4
> 
> 时间：2012-08-02T18:30:36.303
> 
> 标签：java, native

我有一个 java 类，调用本机方法并尝试加载库：

```
import java.io.UnsupportedEncodingException;

public class Main {

    public static native String getMyString(String s);

    /**
     * @param args
     * @throws UnsupportedEncodingException
     */
    public static void main(String[] args) throws UnsupportedEncodingException {
        // TODO Auto-generated method stub
        // System.out.println("here!");

        String s2 = getMyString("string text");
        for (Byte b : s2.getBytes("UTF-8")) {
            System.out.print(b);
            System.out.print(",");
        }

    }

    static {
        System.loadLibrary("mylib.so");
    }

} 
```

“mylib.so”位于 Main.class 所在的目录中。

当我运行时，`java Main`我得到以下异常：

```
Exception in thread "main" java.lang.UnsatisfiedLinkError: no mylib.so in java.library.path
        at java.lang.ClassLoader.loadLibrary(ClassLoader.java:1856)
        at java.lang.Runtime.loadLibrary0(Runtime.java:845)
        at java.lang.System.loadLibrary(System.java:1084)
        at Main.<clinit>(Main.java:24) 
```

我应该改变什么才能让这个wark？

我试过设置库完整路径但没有成功

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-02T18:33:03.227

请执行下列操作：

*   使用 System.loadLibrary("mylib");
*   将 mylib.so 复制到 libmylib.so
*   运行 java -Djava.library.path=/root/ Main

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2015-03-26T18:39:49.017

## “如何加载本机库”

```
public final class NativeLibsLoaderUtil {
    private static final String JAVA_LIBRARY_PATH = "java.library.path";
    private static final String SYS_PATHS = "sys_paths";

    private NativeLibsLoaderUtil() {
    }

    private static void addLibsToJavaLibraryPath(final String tmpDirName) {
        try {
            System.setProperty(JAVA_LIBRARY_PATH, tmpDirName);
            /* Optionally add these two lines */
            System.setProperty("jna.library.path", tmpDirName);
            System.setProperty("jni.library.path", tmpDirName);
            final Field fieldSysPath = ClassLoader.class.getDeclaredField(SYS_PATHS);
            fieldSysPath.setAccessible(true);
            fieldSysPath.set(null, null);
        } catch (IllegalAccessException | NoSuchFieldException e) {
            LOGGER.error(e.getMessage(), e);
        }
    }   
} 
```

其中 tmpDirName 是您存储库的目录。或者您可以修改上面的类并使用系统属性中的临时目录，如下所示：

```
/**
 * Temporary directory system property name
 */
private static final String JAVA_IO_TMPDIR = "java.io.tmpdir";

/**
 *
 * @return
 */
private static File getTempDir() {
    final String tmpDirName = System.getProperty(JAVA_IO_TMPDIR);
    final File tmpDir = new File(tmpDirName);
    if (!tmpDir.exists()) {
        tmpDir.mkdir();
    }
    return tmpDir;
} 
```

！但首先你必须在那里复制你的本地库:)

然后在执行任何类构造函数之前，在“最根”类的静态块中加载本机库调用“addLibsToJavaLibraryPath”方法。

```
static {
    NativeLibsLoaderUtil.addLibsToJavaLibraryPath("/tmp");
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-02T18:36:54.410

您应该将 so 添加到库路径： [-Djava.libarary.path=](https://stackoverflow.com/questions/7195778/java-error-cannot-find-library-in-java-library-path) （这是在 java 命令中）。

如果您从 Eclipse 运行： [How to add native library to "java.library.path" with Eclipse launch（而不是覆盖它）](https://stackoverflow.com/questions/661320/how-to-add-native-library-to-java-library-path-with-eclipse-launch-instead-of)

* * *

## 回答 #4

> 赞同：-6
> 
> 时间：2012-08-21T12:28:03.147

正如雷默斯回答的那样。或者你可以使用 System.load("/Library/Path/libsample.so");

# php - 是否可以将简单的 PHP 片段重新编码为 javascript？

> ID：11783637
> 
> 赞同：0
> 
> 时间：2012-08-02T18:31:23.053
> 
> 标签：php, javascript

我在一个每周显示不同员工姓名的 Intranet 站点上有以下代码 - 它在员工数组中循环。它基本上会更新该特定一周内负责某些维护的站点。

```
<?php  
$staff = array('John', 'Mike', 'Chris');
echo $staff[((time()+3*24*3600)/(7*24*3600)) % count($staff)];
?> 
```

我们不得不让网站离线一段时间，我们直接在浏览器中访问页面（不通过网络服务器运行）。

有没有办法调整上面的代码以在 Javascript 中运行？我已经很久没有使用过 Javascript，我认为它可能是最好的选择，但我 a) 不确定它是否可能，并且 b) 不知道如何去做。

任何提示将非常感谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-02T18:45:01.730

这看起来很简单。

```
var staff = ['John', 'Mike', 'Chris'];
var selected = staff[ Math.floor(((Date.now()/1000) + 3*24*3600) / (7*24*3600)) % staff.length ];

console.log(selected); 
```

注意：我使用`(Date.now()/1000)`因为`time()`返回秒并`Date.now()`返回毫秒。

注意 2：我使用`Math.floor`as`((Date.now()/1000) + 3*24*3600) / (7*24*3600)`可能不会返回整数（并且 JavaScript 在使用`%`小数时返回与 PHP 不同的结果）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-02T18:39:48.947

试试这个：

```
var timeInMilliseconds = new Date().getTime();
var timeInSeconds = Math.floor(timeInMilliseconds / 1000);

var staff = ["John","Mike","Chris"];
alert(staff[Math.floor((timeInSeconds + 3*24*3600)/(7*24*3600)) % staff.length]);​ 
```

输出

> 克里斯

**注意：** 添加了 Math.floor 以强制整数。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-02T18:35:16.410

这是在前一周进行的，可能会引起人们的兴趣： http: [//phpjs.hertzen.com/](http://phpjs.hertzen.com/)

# unix - 使用 tsch 从文本文件中分离电子邮件地址

> ID：11783644
> 
> 赞同：2
> 
> 时间：2012-08-02T18:32:03.650
> 
> 标签：unix, email-validation, tcsh

我有一个文本文件，其中包含被大量垃圾包围的电子邮件地址。我只需要分隔电子邮件地址，并将每个地址写在单独的行中（或用逗号分隔它们）。

文本文件如下所示：

per@netvision.net אירית שנהב;רוני אשכול 99；מרכז האולפן 99；דפניאלפר; תים רון; (eina@gmail.com) אינה דגן 9303; (ori@gmail.com) אילן דור 9406; 第9304章

我认为要“抓住”所有以 [AZ] 开头并以 [AZ] 结尾的单词，因为周围的所有垃圾都不是英文字母（[AZ]）。

有人可以告诉我如何编写这个脚本吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-02T18:55:34.283

我会使用[`grep -o`](http://www.FreeBSD.org/cgi/man.cgi?query=grep). 它并不完全在 tcsh 中，但您可以从任何脚本中使用 grep。该`-o`选项使 grep 仅返回与正则表达式匹配的文本。

看起来您的输入文件当前使用分号分隔记录。这很重要，因为`grep`逐行读取内容。因此，我们将使用`tr`换行符替换您的记录分隔符，以确保`grep`看到每条记录。

```
ghoti@pc> cat strip_email 
#!/bin/tcsh

setenv inputfile emails.txt
setenv re_email '[[:alnum:]][[:alnum:]_%=+-]*@([[:alnum:]]([[:alnum:]-])+\.)+[[:alnum:]]{2,}'

tr ';' '\n' < $inputfile | grep -Eo "$re_email"

ghoti@pc> ./strip_email 
per@netvision.net
eina@gmail.com
ori@gmail.com
ghoti@pc> 
```

您可以将正则表达式调整为适合您的任何内容。在 unix 或 linux 系统上，您可以查看手册页：[`re_format(7)`](http://www.FreeBSD.org/cgi/man.cgi?query=re_format)或[`regex(7)`](http://www.unix.com/man-page/Linux/7/regex/)文档。那里记录了这`[:alnum:]`件作品，以及[`isalnum`](http://www.FreeBSD.org/cgi/man.cgi?query=isalnum).

# python - Python中的C样式指针，这是正确的吗？

> ID：11783645
> 
> 赞同：3
> 
> 时间：2012-08-02T18:32:07.717
> 
> 标签：python, c, pointers

我正在尝试将 C 应用程序移植到 Python，并且有很多指针。这些是否相等：

```
obj->position = (float*) malloc(obj->totalItems * obj->xyz * sizeof (float));
for (i = 0; i < components; i++) {
    obj->comps[i].position = obj->position + obj->pOffset; // Pointer arithmetic
obj->pOffset += obj->comps[i].items * obj->xyz;
} 
```

和

```
for i in range(self.totalItems * self.xyz):
    self.position.append(0.0)
for i in range(self.components):
    self.comps[i].position = self.position[self.pOffset:] # Position was a C pointer
    self.pOffset += self.comps[i].items * self.xyz 
```

我知道 Python 对象是通过引用传递的，所以我想知道是否：

```
self.comps[N].position = [1,2,3,4] 
```

将改变某些部分：

```
self.position[] 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-02T20:56:50.717

也许是这样的：

```
self.position = [0.0 for _ in self.total_items * self.xyz]
for i in range(self.components):
    self.comps[i].position = self.p_offset
    self.p_offset += self.comps[i].items 
```

在 Python 中，您可以更改类实例变量中的值。这称为“变异”实例。如果该类不允许这样做，则它是一个“不可变”类；如果它确实允许这样做，它就是一个“可变”类。字符串是不可变的，整数也是如此，但列表是可变的。

在 Python 中，我无法想到获取对列表中间部分的引用。列表是可变的：可以插入、删除等。那么引用应该做什么呢？

因此，与其进行指针数学运算并存储对列表中某个点的引用，不如只存储偏移量，然后在需要引用列表中的该点时使用偏移量来索引列表。

对于您的具体问题：

```
self.comps[N].position = [1,2,3,4] 
```

这会将对象`position`内的名称重新绑定`self.comps[N]`到现在指向具有该值的新创建的列表实例，`[1, 2, 3, 4]`并且根本不会影响`self.position`。但是，如果您只是设置`self.comps[i].position`为索引值，则可以使用以下代码：

```
i = self.comps[N].position
lst = [1, 2, 3, 4]
self.position[i:i+len(lst)] = lst 
```

这将在`self.position`列表中使用“切片”来替换值。

请注意，如果您使用 SciPy 甚至只是 NumPy，您可以定义一个`numpy.array`不是动态的；您可以使用“视图”来获取对列表一部分的引用。您可能想研究一下，尤其是在使用非常大的数组或矩阵时。

[查看一个numpy数组？](https://stackoverflow.com/questions/4370745/view-onto-a-numpy-array)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-02T21:27:31.940

self.comps[N].position = [1,2,3,4]

将 self.comps[N].position 设置为一个新列表。如果还有其他对 self.comps[N].position 的旧列表的引用，它们将不会被更改。

例子

```
x=[1,2,3]
y=x
print y #[1, 2, 3]
x[1]=4
print y #[1, 4, 3]
x=[4,5,6]
print y #[1, 4, 3] 
```

# ruby - 访问 Capybara 的方法时出现 NoMethodErrors

> ID：11783647
> 
> 赞同：0
> 
> 时间：2012-08-02T18:32:19.343
> 
> 标签：ruby, capybara

当我运行 Cucumber 时，出现以下错误：

```
undefined method `visit' for "default":String (NoMethodError)
C:/Users/user/.pik/rubies/Ruby-193-p194/lib/ruby/gems/1.9.1/gems/capybara-1.1.2/lib/capybara/session.rb:157:in `visit'
C:/Users/user/.pik/rubies/Ruby-193-p194/lib/ruby/gems/1.9.1/gems/capybara-1.1.2/lib/capybara/dsl.rb:161:in `visit'
D:/Andrey/project/features/support/env.rb:33:in `basicAuth'
D:/Andrey/project/features/support/env.rb:54:in `addHost'
D:/Andrey/project/features/support/env.rb:95:in `Before' 
```

当调用`Capybara.visit("http://www.google.com")`和

```
undefined method `browser' for "default":String (NoMethodError)
D:/Andrey/project/features/support/env.rb:105:in `After' 
```

调用时`page.driver.browser.save_screenshot("screenshot.png")`

和许多类似的错误。似乎到处都无法使用水豚的方法。

但是当我运行时`Capybara.methods.sort`，我会得到包含访问的[输出。](https://gist.github.com/3239428)

为什么会这样？

**更新：** 问题出在 env.rb 中。它包含代码：

```
Capybara.register_driver :selenium do |app|
    profile = Selenium::WebDriver::Firefox::Profile.new
    Capybara::Selenium::Driver.new(app, :browser => :firefox, :profile => profile)
  end
end 
```

如果我将其更改为：

```
Capybara.register_driver :selenium do |app|
    Capybara::Selenium::Driver.new(app, :browser => :firefox)
  end
end 
```

然后它工作。

以前的代码有什么问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-03T16:18:05.540

尝试这样做：

```
profile = Selenium::WebDriver::Firefox::Profile.new
profile['network.proxy.http'] = 'localhost'
profile['network.proxy.http_port'] = 9090

Capybara::Selenium::Driver.new(app, :browser => :firefox, :profile => profile) 
```

它不起作用，请尝试这样做：

```
visit("http://www.google.com") #remove "Capybara" before 
```

# python - webpy中多个表单的属性错误

> ID：11783649
> 
> 赞同：0
> 
> 时间：2012-08-02T18:32:21.390
> 
> 标签：python, forms, web.py

我正在创建一个 webpy 应用程序，该应用程序具有多个接受输入的表单，并且该输入由 python 执行，但是我在第一个表单上的键错误上不断收到属性错误：**AttributeError : 'Pycode'**，不知道为什么会这样，这是代码：

```
import web
from Commands import *
import Commands

operations = [method for method in dir(port) if callable(getattr(port, method))]
test = port(0)

def make_text(string):
    return string

urls = ('/', 'tutorial')
render = web.template.render('templates/',globals={'oper':operations})

app = web.application(urls, globals())

pythonCode = web.form.Form(
            web.form.Textarea(name='', class_='Pycode', id='Pycode')
            )
setProportionalGain = web.form.Form(
    web.form.Textbox(name='Set Proportional Gain', class_='SG', id='SG')
    )
setIntegralGain = web.form.Form(
    web.form.Textbox(name='Set Inegral Gain', class_='SI', id='SI')
    )
setDerivativeGain = web.form.Form(
    web.form.Textbox(name='Set Derivative Gain', class_='SD', id='SD')
    )

class tutorial:
    def GET(self):
        code = pythonCode()
        proportional = setProportionalGain()
        integral = setIntegralGain()
        derivative = setDerivativeGain()
    return render.tutorial(code,proportional,integral,derivative, "Input Command for ohm")

def POST(self):
    form = pythonCode()
    proportional = setProportionalGain()
    integral = setIntegralGain()
    derivative = setDerivativeGain()
    form.validates()
    data = web.input()
    print data
    print data.Pycode
    s = data.Pycode
    proportionalGain = "test.setProportionalGain(%s)" % data.SG
    integralGain = "test.setItegralGain(%s)" % data.SI
    derivativeGain = "test.setDerivativeGain(%s)" % data.SD
    try:
        exec(proportionalGain)
        exec(integralGain)
        exec(derivativeGain)
        exec(data.Pycode)
        s = "This is Python!"
    except:
        pass
    return s

if __name__ == '__main__':
    app.run() 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-03T07:41:43.587

检查[如何使用表单输入](http://webpy.org/form#inputfeatures)的文档。每个输入都应该有 name 作为它的第一个参数，你的`name`属性应该是`description`.

# c - 在保持松散耦合的同时保留对象

> ID：11783651
> 
> 赞同：1
> 
> 时间：2012-08-02T18:32:33.930
> 
> 标签：c, persistence, loose-coupling, cohesion

我在微控制器中处理一个项目，我需要保留一些设置。假装这是一个 iPod。我需要保存各种设置，如`CurrentSongPlaying`、`CurrentVolume`等，以便再次打开时可以恢复这些设置。我遇到的麻烦是将我所有的非易失性设置存储在一个结构中是有意义的，我可以从内存中序列化/反序列化，但是如果没有类执行，我无法找到一种方法来实现这一点来自非易失性存储器的序列化/反序列化，包括每个包含需要保存以获取大小/类型信息的设置的类。是否有某种设计模式可以让我将所有这些设置保存到内存中，而不必知道我正在保存什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-03T19:43:56.083

看起来你只需要一个[关联数组](http://en.wikipedia.org/wiki/Associative_array)。关联数组（或映射）是一个容器，允许您将不同的值映射到唯一键。根据实现，它可以具有固定或动态大小。再加上适当的序列化机制，它可以让你保存和恢复它的状态，而不必提前知道它的内容。

但是，C 并没有提供这种开箱即用的数据结构。[看看这个问题的几个实现。](https://stackoverflow.com/questions/4864453/associative-arrays-in-c)最常见的实现是[哈希表](http://en.wikipedia.org/wiki/Hash_table)，也称为哈希图。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-02T22:11:21.720

OOP 和类在 C 中不容易实现。

如果必须使用 C，我会将结构写入文件。

然后我会在重启时读取它们并在初始化期间解析它们。

您可以将其视为自己序列化您的结构。

# java - 从外部类更改实例变量值？

> ID：11783654
> 
> 赞同：0
> 
> 时间：2012-08-02T18:32:54.290
> 
> 标签：java, oop

这可能吗？例如，我有一个名为 telef 的类企业对象，它有一个价格变量，我希望能够从另一个类访问该企业的该价格变量。先感谢您

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-02T18:34:17.693

是的，只需创建一个公共 getter 方法。

例如在您的企业类中：

```
private String price;

public String getPrice() 
{
        return price;
} 
```

`telef`现在从具有我们可以编写的对象的任何其他类中：

```
String price = telef.getPrice(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-02T18:35:21.057

这违反了数据隐藏的概念，但您可以通过简单地公开它来做到这一点。

# css - Codeigniter css未加载

> ID：11783656
> 
> 赞同：1
> 
> 时间：2012-08-02T18:33:00.733
> 
> 标签：css, codeigniter

我对 css 和 codeigniter 有很大的问题。我开始认为这是我的权限还是我要疯了？

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>

<title>test</title>
<link rel="stylesheet" href="<?php echo base_url(); ?>/css/style.css" 
     type="text/css" media="screen"/>
</head>

<body>

<?php echo base_url(); ?>css/style.css 
```

这是我的头文件，正如你所看到的，我什至将它回显出来只是为了确保它是正确的，当我查看页面的源代码时它似乎很好..但不知何故它什么也没做，这个我的 CSS 只是为了向您展示背景应该是灰色的：

```
body{

background: #b6b6b6;
margin 0;
padding 0;
font-family: arial;
 } 
```

我的基本网址很好..因为它被回显并转到正确的位置 $config['base_url'] = 'http://localhost/block/application';

我真的要疯了 怎么回事？

ht 访问：

```
Deny from all 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-02T19:12:50.180

如果要`base_url()`输出正确的 url，只需将路径作为参数传入即可。

```
base_url('path/to/stylesheet.css'); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-07-03T00:16:44.270

您可以使用

```
<link rel="stylesheet" href="<?php echo base_url(); ?>css/style.css" 
type="text/css" media="screen"/> 
```

或者

```
<link rel="stylesheet" href="<?php echo base_url('css/style.css'); ?>" 
type="text/css" media="screen"/ 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2020-07-29T17:39:59.100

在尝试了这么多事情之后，对我来说真正有用的是将资产文件夹放在**根目录** 而**不是****应用程序目录中**

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-02T18:39:19.140

如果您`base_url()`给了您，`http://localhost/block/application`那么 css 文件的路径将如下所示`http://localhost/block/applicationcss/style.css`，我认为应该是`http://localhost/block/application/css/style.css`这样，所以您缺少一个`/`

```
<link rel="stylesheet" href="<?php echo base_url(); ?>/css/style.css" 
    type="text/css" media="screen"/> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-02T18:39:27.063

`/`在您的链接中添加另一个`/css/style.css`

```
<link rel="stylesheet" href="<?php echo base_url(); ?>/css/style.css" 
 type="text/css" media="screen"/> 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-08-02T22:20:45.137

在任何资源文件夹中都没有包含 Deny From All 的 htacess 文件。

您需要从应用程序文件夹中分离出 css 文件夹。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-08-19T21:25:35.293

您必须将 css 文件夹或文件放在根目录而不是应用程序目录中，并使用 base_url 函数，如下所述

`<link href="<?php echo base_url();?>site.css"`

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2019-05-24T14:20:44.677

添加`rel="stylesheet"`到 css 文件。

# regex - C if 语句的正则表达式

> ID：11783658
> 
> 赞同：-2
> 
> 时间：2012-08-02T18:33:04.910
> 
> 标签：regex, perl

以下的正则表达式`c if statement` 是我正在尝试但不匹配的

`if ( $line !~ /^if \(.\) \{/) {`

我希望它与`if ( a ==b ) {`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-02T18:37:48.860

尝试交换。对于 .* ，它将在 "()" 中接受超过 1 个字符

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-02T18:36:31.367

```
if ($line =~ /^if\s*\([^\)]+\)\s*\{/) 
```

# c++ - 使用 gstreamer 的关键回调

> ID：11783662
> 
> 赞同：0
> 
> 时间：2012-08-02T18:33:14.510
> 
> 标签：c++, gstreamer

我想知道是否有人知道如何使用 gstreamer 进行关键回调。我已经看过了，找不到任何东西。我正在尝试做相当于 cvWaitKey 的操作。我的程序中确实有 OpenCV，它可以与 Gstreamer 交互。但是，Gstreamer 正在将视频输出到屏幕，因此 cvWaitKey 不起作用。谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-02T19:23:49.230

这与 GStreamer 无关。选择一个像 Gtk+ 或 Qt 这样的 UI 工具包并使用那里的功能。

# php - 将日期和时间存储在 MySQL 数据库中以便以后使用 PHP 显示的最佳方法是什么？

> ID：11783668
> 
> 赞同：10
> 
> 时间：2012-08-02T18:33:28.110
> 
> 标签：php, mysql, datetime, date, time

我想将用户在我的网站上执行操作的日期和时间存储到 MySQL 数据库中。我希望能够轻松地执行以下操作：

*   将日期和时间作为一个字段存储在数据库中
*   使用内置 PHP 或 MySQL 函数生成操作的日期时间
*   根据我的服务器时间存储日期时间，而不用担心用户时区。
*   `Order By`我查询 MySQL 时的日期时间字段
*   稍后，使用内置 PHP 方法以多种不同格式显示日期时间

以下是我的问题：

*   我应该在 MySQL 中使用什么数据类型（例如`timestamp`，`datetime`...）？
*   我应该使用什么方法来生成日期时间（例如 MySQL's `now()`， PHP's `date()`... ）？
*   我以后应该使用什么 PHP 方法以各种漂亮的方式格式化日期时间（例如 2012 年 4 月 23 日，2012 年 7 月星期一下午 5 点......）？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-02T18:39:27.157

我会将其存储为日期时间，而不是时间戳。

我通常使用 PHP 日期函数，如果您想存储相对于用户时区的时间，您可以简单地根据用户的设置更改时区。

当您将其从数据库中拉出时，使用 strtotime() 对其进行转换，然后您可以使用所有 date() 功能以任何您想要的方式显示它。例子：

```
echo date('F j, Y',strtotime($db_datetime)); //Displays as 'March 5, 2012' 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-02T18:40:34.143

如果您将 mysql 数据类型设置为不可为空的时间戳，然后为该列保存具有空值的行，mysql 将自动为您更新时间戳。

至于再次读取它，您可以使用 php 的 strtotime 和 date 对象将其转换为您需要的格式。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-02T18:45:53.660

您应该使用 datetime 数据类型来满足您的要求。它将根据您的查询存储输入字段中的日期和时间。

要检索日期时间，您可以使用 mysql 的[date_format()](http://php.net/manual/en/function.date-format.php)函数或 PHP 的[date()](http://php.net/manual/en/function.date.php)函数。日期时间将始终根据服务器时间而不是客户端时间存储。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2021-11-28T21:32:46.683

我多年来一直在为这个问题苦苦挣扎，我开始认为最好的方法可能是将时间存储为代表 Unix 时间的整数（从 1970 年 1 月 1 日开始的秒数）。我已经这样做了，而且效果很好。

就我个人而言，我从未使用过日期时间，而且我想不出我会使用它的情况。它只是带来了太多的问题。

时间戳要好得多，但在 MySQL 中它不能存储晚于 2032 的日期。

我很想听到一些关于这个话题的严肃讨论，但 Stack Overflow 可能不是最好的地方。

# python - md5 多线程暴力破解

> ID：11783669
> 
> 赞同：3
> 
> 时间：2012-08-02T18:33:28.927
> 
> 标签：python, multithreading, md5, brute-force

我使用 python 2.7，我有一个简单的多头 md5 dict brute：

```
# -*- coding: utf-8 -*-

import md5
import Queue
import threading
import traceback

md5_queue = Queue.Queue()

def Worker(queue):
    while True:
        try:
            item = md5_queue.get_nowait()
        except Queue.Empty:
            break
        try:
            work(item)
        except Exception:
            traceback.print_exc()

        queue.task_done()

def work(param):
    with open('pwds', 'r') as f:
        pwds = [x.strip() for x in f.readlines()]

    for pwd in pwds:
        if md5.new(pwd).hexdigest() == param:
            print '%s:%s' % (pwd, md5.new(pwd).hexdigest())

def main():
    global md5_queue
    md5_lst = []
    threads = 5

    with open('md5', "r") as f:
        md5_lst = [x.strip() for x in f.readlines()]

    for m in md5_lst:
        md5_queue.put(m)    # add md5 hash to queue

    for i in xrange(threads):
        t = threading.Thread(target=Worker, args=(md5_queue,))
        t.start()

    md5_queue.join()

if __name__ == '__main__':
    main() 
```

在 5 个线程中工作。每个线程从队列中读取一个哈希值并使用密码列表进行检查。非常简单：1 个线程 1 签入“for”循环。

我想要更多一点：1 个线程和几个线程来检查密码。所以 work() 应该从队列中读取哈希并启动新数量的线程来检查密码（1 个线程哈希，10 个线程在那里检查密码）。例如：20 个带哈希的线程和 20 个线程在每个线程中对哈希进行暴力破解。类似的东西。

我怎样才能做到这一点？

PS对不起我的解释，问你是否不明白我想要什么。

PPS 这不是关于暴力 md5，而是关于多线程。

谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-02T18:40:38.480

Python 的默认实现（称为 CPython）使用[全局解释器锁](http://en.wikipedia.org/wiki/Global_Interpreter_Lock)(GIL)，它实际上只允许一个线程同时运行。对于 I/O 绑定的多线程应用程序，这通常不是问题，但对于像您这样受 CPU 限制的应用程序，这意味着您不会看到太多的多核加速。

我建议使用没有 GIL 的不同 Python 实现，例如 Jython，或者重写代码以使用没有 GIL 的不同语言。用本机编译的代码编写它是一个好主意，但是大多数具有 MD5 函数的脚本语言通常无论如何都会在本机代码中实现它，所以老实说，我不希望在本机编译的语言和脚本语言之间有太多的加速。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-02T20:57:01.713

我相信以下代码将是一个比您的示例代码更有效的程序：

```
from __future__ import with_statement

try:
    import md5
    digest = lambda text: md5.new(text).hexdigest()
except ImportError:
    import hashlib
    digest = lambda text: hashlib.md5(text.encode()).hexdigest()

def main():
    passwords = load_passwords('pwds')
    check_hashes('md5', passwords)

def load_passwords(filename):
    passwords = {}
    with open(filename) as file:
        for word in (line.strip() for line in file):
            passwords.setdefault(digest(word), []).append(word)
    return passwords

def check_hashes(filename, passwords):
    with open(filename) as file:
        for code in (line.strip() for line in file):
            for word in passwords.get(code, ()):
                print (word + ':' + code)

if __name__ == '__main__':
    main() 
```

它是用 Python 2.x 和 3.x 编写的，应该能够在其中任何一种语言上运行。

# asp.net - ASP.NET MVC3 服务器端验证和部分视图表单

> ID：11783671
> 
> 赞同：0
> 
> 时间：2012-08-02T18:33:30.913
> 
> 标签：asp.net, asp.net-mvc-3, validation, viewmodel, asp.net-mvc-partialview

所以...我得到了这个难题。我的模型是一个“用户”，它有大约 15 个不同的字段（包括一些 Bool 字段和一个密码字段）。为了方便起见，我不能有一个单一的大表格，相反，我想出了一个想法，将几个表格映射到几个不同的“子模型”（我想有人可能会称它们为ViewModels）发布到用户控制器中的特定方法。用户控制器然后验证 ViewModel，如果它们通过，它会更新原始用户。

问题是如果验证失败会发生什么 - 我需要找到一种方法来重新显示用户的完整选项卡式布局（在 4 个选项卡中有 4 个表单，映射到 4 个模型），并包括用户所做的更改'不通过验证。问题是，根据 4 个表单中的哪一个被编辑，“返回”对象是 4 种类型之一，因此其他 3 个表单（在不同选项卡中）必须像提交之前一样由现有用户数据填充按下。

我可能只是只见树木不见森林，但有人可以提出解决这类问题的方法吗？

编辑：要添加更多信息 - 问题是 - 如果服务器端验证失败，我需要在选项卡式布局中重新呈现编辑表单，并显示验证错误消息。我可以通过截断用户输入并重新加载原始“用户”数据来轻松做到这一点，但显然，我想保留输入。

# sql - 如何找到通过外键引用特定行的表？

> ID：11783678
> 
> 赞同：6
> 
> 时间：2012-08-02T18:34:15.310
> 
> 标签：sql, postgresql, foreign-keys

给定这样的结构：

```
CREATE TABLE reference_table (
  reference_table_key numeric NOT NULL,
  reference_value numeric,
  CONSTRAINT reference_table_pk PRIMARY KEY (reference_table_key)
);

CREATE TABLE other_table (
  other_table_key numeric NOT NULL,
  reference_table_key numeric,
  CONSTRAINT other_table_pk PRIMARY KEY (other_table_key),
  ONSTRAINT other_table_reference_fk FOREIGN KEY (reference_table_key)
      REFERENCES reference_table (reference_table_key) MATCH SIMPLE
      ON UPDATE NO ACTION ON DELETE SET NULL
);

CREATE TABLE another_table (
  another_table_key numeric NOT NULL,
  do_stuff_key numeric,
  CONSTRAINT another_table_pk PRIMARY KEY (another_table_key),
  ONSTRAINT another_table_reference_fk FOREIGN KEY (do_stuff_key)
      REFERENCES reference_table (reference_table_key) MATCH SIMPLE
      ON UPDATE NO ACTION ON DELETE SET NULL
);

--there are 50-60 tables which have similar foreign key references to reference_table 
```

我想编写一个查询，告诉我 other_table 和 another_table 中的主键，以及可能更多 reference_value 为 NULL 的表。

在伪代码中：

```
SELECT table_name, table_primary_key, table_fk_column_name
FROM ?????? some PG table ???????, reference_table
WHERE reference_table.reference_value IS NULL; 
```

结果看起来像：

```
table_name | table_primary_key | table_fk_column_name | reference_table_pk
---------------------------------------------------------------------------
other_table   | 2                |  reference_table_key | 7
other_table   | 4                |  reference_table_key | 56
other_table   | 45               |  reference_table_key | 454
other_table   | 65765            |  reference_table_key | 987987
other_table   | 11               |  reference_table_key | 3213
another_table | 3                |  do_stuff_key        | 4645
another_table | 5                |  do_stuff_key        | 43546
another_table | 7                |  do_stuff_key        | 464356
unknown_table | 1                |  unkown_column_key   | 435435
unknown_table | 1                |  some_other_column_key | 34543
unknown_table | 3                |  unkown_column_key   | 124
unknown_table | 3                |  some_other_column_key | 123 
```

这类似于但不是[Postgres: SQL to list table foreign keys](https://stackoverflow.com/questions/1152260/postgres-sql-to-list-table-foreign-keys)的副本。该问题显示了表结构。我想找到具体的实例。

本质上，如果我`DELETE FROM reference_table WHERE reference_value IS NULL;`要这样做，postgres 必须在内部做一些事情来确定它需要`reference_table_key`在第 2 行中设置`other_table`为 NULL。我想看看那些行会是什么。

有没有可以做到这一点的查询？是否有一个修饰符可以传递给 DELETE 调用，告诉我哪些表/行/列会受到该 DELETE 的影响？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-03T03:29:34.583

### 引用列中的 NULL 值

此查询生成 DML 语句以查找**所有表中的所有行**，其中列具有**引用另一个表**但`NULL`在该列中保存值的外键约束：

```
WITH x AS (
 SELECT c.conrelid::regclass    AS tbl
      , c.confrelid::regclass   AS ftbl
      , quote_ident(k.attname)  AS fk
      , quote_ident(pf.attname) AS pk
 FROM   pg_constraint c
 JOIN   pg_attribute  k ON (k.attrelid, k.attnum) = (c.conrelid, c.conkey[1])
 JOIN   pg_attribute  f ON (f.attrelid, f.attnum) = (c.confrelid, c.confkey[1])
 LEFT   JOIN pg_constraint p  ON p.conrelid = c.conrelid AND p.contype = 'p'
 LEFT   JOIN pg_attribute  pf ON (pf.attrelid, pf.attnum)
                               = (p.conrelid, p.conkey[1])
 WHERE  c.contype   = 'f'
 AND    c.confrelid = 'fk_tbl'::regclass  -- references to this tbl
 AND    f.attname   = 'fk_tbl_id'         -- and only to this column
)
SELECT string_agg(format(
'SELECT %L AS tbl
     , %L AS pk
     , %s::text AS pk_val
     , %L AS fk
     , %L AS ftbl
FROM   %1$s WHERE %4$s IS NULL'
                  , tbl
                  , COALESCE(pk 'NONE')
                  , COALESCE(pk 'NULL')
                  , fk
                  , ftbl), '
UNION ALL
') || ';'
FROM   x; 
```

产生这样的查询：

```
SELECT 'some_tbl' AS tbl
     , 'some_tbl_id' AS pk
     , some_tbl_id::text AS pk_val
     , 'fk_tbl_id' AS fk
     , 'fk_tbl' AS ftbl
FROM   some_tbl WHERE fk_tbl_id IS NULL
UNION ALL
SELECT 'other_tbl' AS tbl
     , 'other_tbl_id' AS pk
     , other_tbl_id::text AS pk_val
     , 'some_name_id' AS fk
     , 'fk_tbl' AS ftbl
FROM   other_tbl WHERE some_name_id IS NULL; 
```

产生如下输出：

```
 tbl    |     pk       | pk_val |    fk        |  ftbl
-----------+--------------+--------+--------------+--------
 some_tbl  | some_tbl_id  | 49     | fk_tbl_id    | fk_tbl
 some_tbl  | some_tbl_id  | 58     | fk_tbl_id    | fk_tbl
 other_tbl | other_tbl_id | 66     | some_name_id | fk_tbl
 other_tbl | other_tbl_id | 67     | some_name_id | fk_tbl 
```

*   **不可靠地覆盖多列外键或主键**。为此，您必须使查询更加复杂。

*   我将所有主键值*转换*为`text`以涵盖所有类型。

*   修改或删除这些行以查找指向其他或*任何*列/表的外键：

    ```
    AND    c.confrelid = 'fk_tbl'::regclass
    AND    f.attname = 'fk_tbl_id' -- and only this column 
    ```

*   用 PostgreSQL 9.1.4 测试。我用`pg_catalog`桌子。实际上，我在这里使用的任何东西都不会改变，但这并不能保证在主要版本中。`information_schema`如果您需要它在更新中可靠地工作，请使用表重写它。那会更慢，但可以肯定。

*   我没有在生成的 DML 脚本中清理表名，因为[`quote_ident()`](http://www.postgresql.org/docs/current/interactive/functions-string.html#FUNCTIONS-STRING-OTHER)使用模式限定名称会失败。您有责任避免使用有害的表名，例如`"users; DELETE * FROM users;"`. 通过更多的努力，您可以分别检索模式名和表名并使用`quote_ident()`.

* * *

### 引用列中的 NULL 值

我的第一个解决方案与您所要求的略有不同，因为您所描述的（据我所知）是不存在的。该值为`NULL`“未知”，无法引用。如果您实际上想在具有指向它的 FK 约束的列中查找具有值的行**（**`NULL`当然不是具有该值的特定行），那么查询可以大大简化：**`NULL`**

 **```
WITH x AS (
 SELECT c.confrelid::regclass   AS ftbl
       ,quote_ident(f.attname)  AS fk
       ,quote_ident(pf.attname) AS pk
       ,string_agg(c.conrelid::regclass::text, ', ') AS referencing_tbls
 FROM   pg_constraint c
 JOIN   pg_attribute  f ON (f.attrelid, f.attnum) = (c.confrelid, c.confkey[1])
 LEFT   JOIN pg_constraint p  ON p.conrelid = c.confrelid AND p.contype = 'p'
 LEFT   JOIN pg_attribute  pf ON (pf.attrelid, pf.attnum)
                               = (p.conrelid, p.conkey[1])
 WHERE  c.contype = 'f'
 -- AND    c.confrelid = 'fk_tbl'::regclass  -- only referring this tbl
 GROUP  BY 1, 2, 3
)
SELECT string_agg(format(
'SELECT %L AS ftbl
     , %L AS pk
     , %s::text AS pk_val
     , %L AS fk
     , %L AS referencing_tbls
FROM   %1$s WHERE %4$s IS NULL'
                  , ftbl
                  , COALESCE(pk, 'NONE')
                  , COALESCE(pk, 'NULL')
                  , fk
                  , referencing_tbls), '
UNION ALL
') || ';'
FROM   x; 
```

在整个数据库中查找所有此类行（注释掉对一个表的限制）。用 Postgres 9.1.4 测试并为我工作。

我将引用同一外部列的多个表分组到一个查询中，并添加一个引用表列表以提供概述。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-02T18:53:42.100

您需要此查询的联合：

```
select *
from ((select 'other_table' as table_name,
               other_table_key as primary_key,
               'reference_table_key' as table_fk,
               ot.reference_table_key
       from other_table ot left outer join
            reference_table rt
            on ot.reference_table_key = rt.reference_table_key
       where rt.reference_value is null
      ) union all
      (select 'another_table' as table_name,
               another_table_key as primary_key,
               'do_stuff_key' as table_fk,
               at.do_stuff_key
       from another_table at left outer join
            reference_table rt
            on at.do_stuff_key = rt.reference_table_key
       where rt.reference_value is null
      )
     ) t 
```**

# javascript - 如何使用正则表达式将此 CSS 块转换为 LESS？

> ID：11783682
> 
> 赞同：1
> 
> 时间：2012-08-02T18:34:31.220
> 
> 标签：javascript, css, regex, replace, less

我正在重构一堆 CSS（10,000 多行），而不是手动逐行转换，来自：

```
-webkit-transition: .1s linear all;
   -moz-transition: .1s linear all;
        transition: .1s linear all; 
```

进入这个：

```
 .transition(.1s linear all); 
```

有没有办法用正则表达式加快速度？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-02T19:03:51.010

```
#!/usr/bin/python
import re

with open('/tmp/test.txt') as f:
    for line in f:
        m = re.match(r'(.*)(transition):\s*(.*);', line)
        if m:
            print(".%s(%s);" % (m.group(2), m.group(3))) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-02T18:46:23.220

帮助转换可以做的一件事是使用 CSS 解析器来读取 CSS，然后编写自己的方法来发出 LESS 代码。[这是一个这样的 Java 解析器](http://cssparser.sourceforge.net/)。

我不明白你为什么需要这个。为什么不保留旧的 CSS，只在 LESS 中编写新的样式表？

但无论哪种方式，我都不认为正则表达式是这项任务的最佳选择，因为 CSS 必须以非常特定的方式编写才能使其工作，这可能不是超过 10000 行 CSS 的情况。

此外，您可以使用[此转换器](http://css2less.cc/)。它不会执行您所指的转换类型。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-02T18:47:40.000

我首先删除所有带前缀的 (http://refiddle.com/2t4)，然后用 mixin (http://refiddle.com/2t5) 替换不带前缀的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-02T18:42:04.483

这实际上取决于数据的可变性，但这是一个好的开始：

```
/(?:\s*(?:-(?:webkit|moz)-)?transition:\s*\.1s linear all;\n)+/ 
```

如果值是可变的，请替换与您的数据匹配的任何模式。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-02T18:49:31.157

不确定您使用的编辑器是否支持正则表达式中的查找替换。（我在 Eclipse IDE 中尝试了以下步骤）

第 1步：查找“.-webkit- *.* ”并替换为空白
第 2 步：查找“. *-moz-.* ”并替换为空白
第 3 步：查找“(transition):(.*);” 并替换为“.$1($2);”

希望这可以帮助。

# java - 如何在android中的数据库上更改数据时收到通知？

> ID：11783683
> 
> 赞同：2
> 
> 时间：2012-08-02T18:34:34.490
> 
> 标签：java, android, sqlite

我通过如何从 sqllite 数据库获取数据并将其设置为列表视图来获得此代码：

```
Cursor cursor = dbAdapter.getAllIncomingData();
            if (cursor != null && cursor.getCount() > 0) {
                cursor.moveToFirst();
                Log.d("ADD/EDIT", cursor.getCount() + "");

                int size = cursor.getCount();
                incomingDataList = new ArrayList<IncomingData>(size);
                incomingStringList = new ArrayList<String>(size);
                for (int i = 0; i < size; i++) {
                    String serial = cursor.getString(cursor
                            .getColumnIndex("serial"));
                    String mapurl = cursor.getString(cursor
                            .getColumnIndex("mapurl"));
                    String datetime = cursor.getString(cursor
                            .getColumnIndex("datetime"));
                    // Device device=new Device(id, label, serial,
                    // contact);
                    Device dev = dbAdapter.getDeviceBySerial(serial);
                    IncomingData inData = new IncomingData(serial, mapurl,
                            datetime);
                    inData.setLabel(dev.getLabel());
                    inData.setContact(dev.getContact());

                    incomingDataList.add(inData);
                    cursor.moveToNext();
                }
                inAdapter = new IncomingDataArrayAdapter(
                        MatchpointHistoryActivity.this, R.layout.history_item,
                        incomingDataList);
                historyList.setAdapter(inAdapter);

            } 
```

数据库的数据正在通过接收短信更新，我已经在接收器类中编写了插入查询，现在我希望如果添加或删除新数据，那么光标将得到通知并将适配器重置为列表视图，我必须重新启动活动才能查看更改，但我需要立即通知更改。我不想一直用计时器来做这些事情，还有其他方法吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-08-07T09:18:31.057

现在我得到了你的问题。这也可以通过 BroadcastReceiver 来完成，现在它将是您自己的自定义广播接收器，例如`"com.yourapppackage.DATABASE_CHANGED"`. 每当您当时将数据插入/删除到数据库中时，都会发送此广播。

您必须在列表活动中注册您的自定义接收器，并在`onReceive()`方法中更新您的列表。

例如，在 AndroidManifest.xml 中

```
<receiver
    android:name=".DatabaseChangedReceiver"
    android:enabled="true" >
       <intent-filter>
           <action android:name="com.youapppackage.DATABASE_CHANGED"></action>
       </intent-filter>
</receiver> 
```

DatabaseChangedReceiver.java

```
public class DatabaseChangedReceiver extends BroadcastReceiver {
    public static String ACTION_DATABASE_CHANGED = "com.youapppackage.DATABASE_CHANGED";

    @Override
    public void onReceive(Context context, Intent intent) {

    }
} 
```

注册此接收器的活动，

```
private DatabaseChangedReceiver mReceiver = new DatabaseChangedReceiver() {
   public void onReceive(Context context, Intent intent) {
       // update your list
   }

} 
```

在数据库插入/删除方法中，注意：您需要在数据库代码中进行上下文引用。

```
....
// code to insert/delete
....

context.sendBroadcast(new Intent(DatabaseChangedReceiver.ACTION_DATABASE_CHANGED)); 
```

因此这将执行您在活动中注册 DatabaseChangedReceiver 的代码。

* * *

## 回答 #2

> 赞同：-3
> 
> 时间：2012-08-07T08:10:17.240

@雷约翰。您可以为此使用**布尔标志**变量。最初它设置为**false**每当插入或任何更新完成时，然后将标志更改为**true**。之后，您可以简单地检查 flag 是否为**true**，然后您必须 notifyDataSetChanged() 并再次将 flag 设置为**false**。

# asp.net-mvc - 使用唯一键查找实体

> ID：11783693
> 
> 赞同：0
> 
> 时间：2012-08-02T18:35:16.447
> 
> 标签：asp.net-mvc, unique-key, dbset

在我的 asp.net mvc 3 应用程序中，我有一个通用存储库。我使用 DbSet 类的 Find 方法通过其主键查找实体，如下所示：

```
private DbSet<T> _dbSet;

public T FindByID(object id)
{
    return _dbSet.Find(id);
} 
```

有什么方法我也可以使用唯一键找到实体吗？我找不到 DbSet 类的源代码。如果可能的话，我想扩展 DbSet 类并为此添加一个新方法。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-08-03T22:42:19.927

根据这个答案，Entity Framework 似乎不支持唯一键：

[ADO.NET 数据模型中的备用/候选键](https://stackoverflow.com/questions/5307120/alternate-candidate-key-in-ado-net-data-model)

# oauth - 谷歌 Openid 和 Oauth

> ID：11783697
> 
> 赞同：0
> 
> 时间：2012-08-02T18:35:36.637
> 
> 标签：oauth, oauth-2.0, google-openid

我们有通过谷歌混合 Openid (OpenId+OAuth1 [0]) 协议进行身份验证的用户。要使用来自 google 的较新 API，我们必须更改为基于 oauth2 的身份验证。如果他是我们的 openid 用户之一，有没有办法在 oauth2 登录后知道？

id 看起来很不一样。google_oauth2 中的用户 ID 如下所示：

```
12345678901234567890 
```

google hybrid 中的用户 ID 如下所示：

```
https://www.google.com/accounts/o8/id?id=AItOawnlIGFin5I0F059UdqSYbK9JmA99e99ms 
```

有什么办法可以把它组合在一起吗？我可以进行基于 oauth 的调用来检索这样的 openid 用户标识吗？由于我们将其用于登录目的，我不想在登录页面上放置 2 个 google 登录按钮。我很难想象我们的用户会理解这一点。

是否有解决此类问题的通用策略？

[0] [https://developers.google.com/accounts/docs/OpenID#oauth](https://developers.google.com/accounts/docs/OpenID#oauth)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-03T00:16:15.197

谷歌谈论了一个[组合 OpenId/OAuth 调用](https://developers.google.com/accounts/docs/OpenID#oauth)，它应该可以满足你的需要。但是，文档中的所有链接都指向 OAuth 1.0。因此，您需要进行调查以确保它适用于 OAuth 2.0，因为 Google 已弃用 OAuth 1.0 接口。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-03T07:05:51.947

好的，看来我有办法做到这一点。必须实施和检查，但理论上它应该像这样工作：

```
send user to oauth2 login 
    -> if known, log him in
    -> if unknown send him to openid with immediate mode
          -> if successfull log him in, associate the former oauth connection
          -> if error the user is unknown and will be created with his oauth token 
```

如果用户没有使用 google 登录，即时模式也可能会失败，但由于他刚从 oauth2 舞蹈中回来，他必须在这之间注销，因为他会立即被重定向，所以这种情况不太可能发生。

# java - 如何在 xgettext 的 bean 验证注释中标记字符串消息？

> ID：11783698
> 
> 赞同：3
> 
> 时间：2012-08-02T18:35:36.353
> 
> 标签：java, internationalization, gettext, bean-validation

我正在为 i18n 使用 bean 验证和 gettext。如何标记要翻译的消息字符串，以便使用 xgettext 提取它？例如

```
@NotNull(message="Please enter a valid string")
String string; 
```

Normall 我调用 i18n.tr，但是如何标记一个常量？

亲切的问候克里斯蒂安

编辑：在运行时，我使用自定义消息插值器进行翻译。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-04T07:40:06.063

您可以尝试构建一个委托给 gettext的[自定义 MessageInterpolator 。](http://beanvalidation.org/1.0/spec/#custom-message-resolution)[如果您正在使用 Hibernate Validator，从ResourceBundleMessageInterpolator](http://docs.jboss.org/hibernate/stable/validator/api/index.html?org/hibernate/validator/messageinterpolation/ResourceBundleMessageInterpolator.html)派生插值器实现以重用实际插值逻辑可能是有意义的。

也就是说，我会对这个结果非常感兴趣。也许您可以分享您最终采用的方法？我可以想象这对其他人也很有趣。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-09T11:39:30.560

我通常不会回答我自己的问题。但现在我想出了以下解决方案：

我在附加评论中将我的字符串标记如下（我不再知道 DRY）：

```
//_.trans("Please enter a valid string");
@NotNull(message="Please enter a valid string")
String string; 
```

我在我的 pom 中调用以下脚本：

```
#!/bin/bash

# $1 -> java source directory
# $2 -> output file
# $3 -> po directory

echo "Source Directory: $1"
echo "Keys File: $2"
echo "PO Directory: $3"

xgettext --from-code utf-8 -L Java --force-po -ktrc:1c,2 -ktrnc:1c,2,3 -ktr -kmarktr -ktrn:1,2 -k -o "$2" $(find "$1" -name "*.java")
sed "s/\/\/_/_/g" $(find "$1" -name "*.java") | xgettext -F --from-code utf-8 -L Java -ktrans -k -j -o "$2" -

pofiles=$3/*.po
shopt -s nullglob
for i in $pofiles
do
   echo "msgmerge $i"
   msgmerge --backup=numbered -U $i $2
done 
```

该脚本首先正常调用 xgettext，然后调用 sed 删除注释斜杠和管道到 xgettext。因此，我的所有钥匙都在 keys.pot 中。

pom.xml - 个人资料：

```
 <profile>
        <id>translate</id>
        <build>
            <plugins>
                <plugin>
                    <artifactId>exec-maven-plugin</artifactId>
                    <groupId>org.codehaus.mojo</groupId>
                    <version>1.2.1</version>
                    <executions>
                        <execution>
                            <id>xgettext</id>
                            <phase>generate-resources</phase>
                            <goals>
                                <goal>exec</goal>
                            </goals>
                            <configuration>
                                <executable>sh</executable>
                                <arguments>
                                    <argument>${project.basedir}/extractkeys.sh</argument>
                                    <argument>src/main/java</argument>
                                    <argument>src/main/resources/po/keys.pot</argument>
                                    <argument>src/main/resources/po</argument>
                                </arguments>
                                <workingDirectory>${project.basedir}</workingDirectory>
                            </configuration>
                        </execution>
                    </executions>
                </plugin>
                <plugin>
                    <groupId>org.xnap.commons</groupId>
                    <artifactId>maven-gettext-plugin</artifactId>
                    <version>1.2.3</version>
                    <configuration>
                        <keysFile>${project.basedir}/src/main/resources/po/keys.pot</keysFile>
                        <outputDirectory>${project.basedir}/src/main/resources</outputDirectory>
                        <outputFormat>properties</outputFormat>
                        <poDirectory>${project.basedir}/src/main/resources/po</poDirectory>
                        <sourceDirectory>${project.build.sourceDirectory}/ch/sympany/tourist</sourceDirectory>
                        <sourceLocale>en</sourceLocale>
                        <targetBundle>${project.groupId}.Messages</targetBundle>
                    </configuration>
                    <executions>
                        <execution>
                            <goals>
                                <goal>dist</goal>
                            </goals>
                            <phase>generate-resources</phase>
                        </execution>
                    </executions>
                </plugin>
            </plugins>
        </build>
    </profile> 
```

我知道构建不再独立于平台，但在单独的配置文件中我可以接受它。但是，它也适用于 windows 家伙的 cygwin。

我的messageinterpolator如下：

```
public class GettextMessageInterpolator implements MessageInterpolator {

    private final MessageInterpolator delegate;

    public GettextMessageInterpolator() {
        this.delegate = new ResourceBundleMessageInterpolator();
    }

    @Override
    public String interpolate(String message, Context context) {
        return this.interpolate(message, context, ClientLocalLocator.get());
    }

    @Override
    public String interpolate(String message, Context context, Locale locale) {   
        I18n i18n = ClientLocalLocator.getI18n();
        String retVal = i18n.tr(message);
        if (StringUtils.isNotBlank(retVal))
            return retVal;
        return delegate.interpolate(message, context, locale);
    }

} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-03T14:10:35.650

我不确定 gettext 与 Java 的集成。也许你可以解释更多它是如何工作的。

从 Bean 验证的角度来看，i18n 是通过资源文件处理的。您可以执行以下操作，而不是将消息直接添加到代码中：

```
@NotNull(message="{my.notNull.message}")
String string; 
```

*然后，您在ValidationMessages.properties*及其特定于语言的计数器部分中定义您的消息。不确定 gettext 如何适合这里的图片。

**编辑**：

如果您真的想使用*xgettext*，我会发现问题在于 gettext 查找*gettext("whatever")*形式的标记。您可以通过 xgettext 执行的操作是通过 -k 选项为*gettext指定不同的关键字。*不过，在这种情况下这无济于事。如果您通过命令行执行所有这些操作，我可以想象您使用*sed来预解析**xgettext*的输入。就像是：

```
find . -name "*.java" | xargs sed -e 's/message="\(.*\)"/gettext("\1")/' | xgettext 
```

像这样的东西。

# opencv - 质心椭圆 MSER OPENCV

> ID：11783702
> 
> 赞同：3
> 
> 时间：2012-08-02T18:35:52.787
> 
> 标签：opencv, feature-detection, feature-extraction, mser

我正在研究一种图像配准方法，我想使用基于区域的特征检测器。作为代表并且因为它已经在opencv中实现，我想到了MSER。

我知道如何检测 MSER 区域。MSER 检测器给出了点向量内的 MSER 区域，一个轮廓。我想检索这些轮廓的质心。我可以在它们上面放置一个椭圆，但是我不知道如何检索这些椭圆的质心。有人知道是否已经实现了可以处理此任务的功能吗？还是我必须开发一个算法？

原因是我想使用这个质心点作为有趣的点来执行点对应。

谢谢

伊万

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-16T17:21:53.833

该区域的质心可以通过计算所有`x`值的平均值和所有值的平均值来计算`y`。结果`(meanX, meanY)`点是该区域的质心。

# jquery - 针对相同的孩子，但只针对某些不同的父母——CSS和jQuery选择器样式

> ID：11783703
> 
> 赞同：0
> 
> 时间：2012-08-02T18:36:03.490
> 
> 标签：jquery, css, jquery-selectors, css-selectors

有没有办法只针对选定父母的某些孩子而不复制孩子选择器并使选择器在长度方面超出图表？

例如，我想选择某些 div 的第一个子段落。

CSS就像

```
.funny > p:first-child, .sad > p:first-child {
 color: red
} 
```

标记

```
<div class="funny">
  <p>This is red</p>
  <p>This is whatever</p>
  <p>This is whatever</p>
  <p>This is whatever</p>
</div>

<div class="wildcrazy">
  <p>This is whatever</p>
  <p>This is whatever</p>
  <p>This is whatever</p>
  <p>This is whatever</p>
</div>

<div class="sad">
  <p>This is red</p>
  <p>This is whatever</p>
  <p>This is whatever</p>
  <p>This is whatever</p>
</div> 
```

*显然，除了我*想要定位的有趣和悲伤之外，许多其他 div 中可能还有很多其他第一段，也可能有很多其他 div，比如我*不想*定位的 wildcrazy 。

我的问题是：我可以如何声明孩子并将其与所有父母一起添加吗？就像是：

`.funny, .sad, .another_div_class0, .another_div_class1, .another_div_class2, .another_div_class3 > p:first-child`

代替

`.funny p:first, .sad p:first-child, .another_div_class0 p:first-child, .another_div_class1 p:first-child, .another_div_class2 p:first-child, .another_div_class3 p:first-child`

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-02T18:42:40.057

在jQuery这个：

```
.funny, .sad, .another_div_class0, .another_div_class1, .another_div_class2, .another_div_class3 > p:first 
```

将转化为：

```
$('.funny, .sad, .another_div_class0, .another_div_class1, .another_div_class2, .another_div_class3').children('p:first') 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-02T18:42:34.883

我不知道 CSS，但你可以用 jquery 来做。将您所有的父类放在一个选择器中，然后声明您只需要 ap 如果它是选择器的子类：

```
$('.funny, .sad, .another_div_class0, .another_div_class1, .another_div_class2, .another_div_class3').each( function() {
    $('p:first-child', this).css(Do whatever you want);
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-02T18:59:20.673

为什么不像这样向`div`您要选择的 's添加另一个类

```
<div class="funny selectthis">
  <p>This is red</p>
  <p>This is whatever</p>
  <p>This is whatever</p>
  <p>This is whatever</p>
</div>

<div class="wildcrazy">
  <p>This is whatever</p>
  <p>This is whatever</p>
  <p>This is whatever</p>
  <p>This is whatever</p>
</div>

<div class="sad selectthis">
  <p>This is red</p>
  <p>This is whatever</p>
  <p>This is whatever</p>
  <p>This is whatever</p>
</div> 
```

然后就用这个

```
$('.selectthis').find('p:first').css('color','red');​ 
```

[http://jsfiddle.net/U6qhb/](http://jsfiddle.net/U6qhb/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-11-22T13:11:49.400

```
$('.funny, .sad, .another_div_class0, .another_div_class1, .another_div_class2, .another_div_class3').find('p:first') 
```

# javascript - 绘图曲线下方的jqplot图像

> ID：11783704
> 
> 赞同：1
> 
> 时间：2012-08-02T18:36:11.370
> 
> 标签：javascript, graph, gradient, jqplot

我想要的是让彩虹渐变（VIBYOR）出现在我的情节曲线下方的区域中。

我正在使用 jqPlot，我想知道是否有办法将其设置为使用图像来渲染曲线下方的区域，而不是纯色。如果那不可能，我可能会通过使用渐变来获得，但我不知道如何完成。

我考虑使用 alpha 来使用某种背景图像来执行此操作，但由于多个画布层，我认为这不可行。

有没有人对如何用 jqPlot 实现这个有建议？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-05T11:15:50.893

您当然可以使用选项更改面积图中的颜色，但您不能在一组数据下使用不同的颜色。在创建图表对象之前使用颜色主题。喜欢

```
seriesColors: [ "#eee", "#ccc", "#999"], in options string 
```

# spring - 使用注解绑定数据

> ID：11783705
> 
> 赞同：0
> 
> 时间：2012-08-02T18:36:15.097
> 
> 标签：spring, spring-mvc

是否可以做与此相同的行为：

```
protected void onBind(HttpServletRequest request, Object command, BindException bindException) throws Exception {
    Invoice invoice = (Invoice) command;

    invoice.getLineItems().removeAll(Collections.singletonList(null));
} 
```

使用注释时？我正在使用 @controller 注释，所以我没有 onBind 函数。我想操作一个元素列表（从列表中删除项目）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-02T18:55:50.960

新方法是用[`@InitBinder`](http://static.springsource.org/spring/docs/3.0.x/api/org/springframework/web/bind/annotation/InitBinder.html)注解来注解方法：

```
@InitBinder
protected void initBinder(WebDataBinder binder) {
        ...
} 
```

您也可以通过调用方法注册`PropertyEditor`转换值。[`WebDataBinder.registerCustomEditor`](http://static.springsource.org/spring/docs/3.0.x/api/org/springframework/validation/DataBinder.html#registerCustomEditor%28java.lang.Class,%20java.beans.PropertyEditor%29)对于转换为集合，也有[`CustomCollectionEditor`](http://static.springsource.org/spring/docs/3.0.x/api/org/springframework/beans/propertyeditors/CustomCollectionEditor.html)可能很方便。

# jquery - “此页面的状态信息无效，可能已损坏”

> ID：11783707
> 
> 赞同：2
> 
> 时间：2012-08-02T18:36:18.513
> 
> 标签：jquery, asp.net, iframe, exception-handling, fancybox

我的 asp.net 应用程序有一个母版页、一个内容页和一个用户控件。

在主母版页中，有一个链接将fancybox 显示为iframe。iframe 有一个表单来登录页面。iframe 是一个新的母版页，其中包含登录的内容页面，该页面具有登录的用户控制权。

当用户单击按钮登录时，服务器端会检查凭据是否正常，如果不正常，则会显示一条消息。所有这些都使用自定义验证器。

我的问题是，当用户第一次单击按钮登录时，它会检查正常，但是如果凭据不好并且用户重新键入它们，我会在 firefox 上收到以下错误

```
Error: Sys.WebForms.PageRequestManagerServerErrorException:    
Sys.WebForms.PageRequestManagerServerErrorException: the state information is invalid  
for this page and might be corrupted http.../jquery-1.7.2.js 
```

在我的masterPage上

```
<%-- jQuery --%>
  <script src="<%= ResolveClientUrl("~/Template/Scripts/jquery-1.7.2.js") %>" 
   type="text/javascript"></script>
<%-- jQueryUI --%>
<script src="<%= ResolveClientUrl("~/Template/jqueryui/js/jquery-ui-1.8.21.custom.min.js") %>"
   <script type="text/javascript" src="<%= ResolveClientUrl("~/Template/Scripts/jquery.fancybox-1.4.3.min.js") %>">
</script>
<script type="text/javascript" charset="utf-8">
    $(document).ready(function () {
        $("#LoginLightBox").fancybox({
            width: 300,
            height: 750,
            scrolling: "no"
        });
        $("#RegistroLightbox").fancybox({
            width: 300,
            height: 750,
            scrolling: "no"
        });
    });

</script>
<asp:ContentPlaceHolder ID="HeadContent" runat="server">
</asp:ContentPlaceHolder>
<body id="page1">
<form id="Form1" runat="server">
<asp:ScriptManager ID="ScriptManager" runat="server">
</asp:ScriptManager>
<div >
<li style="display:inline"><a class="labelsTipolinks" id="LoginLightBox" href="Login.aspx?iframe=true">Login</a></li>
<li style="display:inline;color: #C53005;">|</li>
<li style="display:inline"><a class="labelsTipolinks"  id="RegistroLightbox" href="RegistroUsuario.aspx?iframe=true">Registro</a></li> 
```

在内容页面上：

```
<%@ Register TagPrefix="uc1" TagName="Login" Src="~/Controles/Login.ascx" %> 
```

最后是用户控件：

```
<div style="margin-top: 20px">
    <asp:UpdatePanel runat="server" ID="updPanelLoginIncorrecto">
        <ContentTemplate>
            <asp:CustomValidator ForeColor="Red" OnServerValidate="usuarioExistente_Validation"
                Display="Static" Font-Size="Small" runat="server" ID="vldLogin" 
                ValidationGroup="grupoValidacionLoginUsuario"
                Text="<%$ Resources:LocalizedText, MsjError_LoginIncorrecto%>">
            </asp:CustomValidator>
        </ContentTemplate>
        <Triggers>
            <asp:AsyncPostBackTrigger ControlID="btnLoginLightbox" EventName="Click" />
        </Triggers>
    </asp:UpdatePanel>
</div>
<div class="tableContent" style="float: right;">
    <asp:Button CssClass="button" ID="btnLoginLightbox" Text="Login" runat="server" OnClick="btnLogin_Click"
        ValidationGroup="grupoValidacionLoginUsuario" />
</div> 
```

请帮助这让我发疯。我已经尝试将 eventvalidation 设置为 false、sessions、response.cache.setno... 等，但没有任何效果。

**编辑**

我得到错误的行在 jquery 1.7.2.js 上，并且在 jQuery.dequeue(elem, type); 上。

**编辑 2**

我最终把fancybox作为一个内联元素放在master里面，但这不是我想要的解决方案。请帮帮我！！！！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-10T14:40:55.803

经过数周的尝试，我尝试输入 type:"iframe" 并且神奇地起作用了！我不知道必须做什么，但现在它可以工作了:) 所以代码是：

```
<script type="text/javascript" charset="utf-8">
$(document).ready(function () {
    $("#LoginLightBox").fancybox({
        type: "iframe",
        width: 300,
        height: 750,
        scrolling: "no"
    });
    $("#RegistroLightbox").fancybox({
        type: "iframe",
        width: 300,
        height: 750,
        scrolling: "no"
    });
});

</script> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-03T16:15:05.937

我过去遇到过类似的问题。我相信它涉及`<% %>`在`<head>`母版页上，但是我可能弄错了。用这个替换你的母版页，如果它解决了问题，请告诉我。

```
<html xmlns="http://www.w3.org/1999/xhtml">
<head runat="server">
<title></title>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
<script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.8.21/jquery-ui.min.js"></script>
<script type="text/javascript" src="~/Template/Scripts/jquery.fancybox-1.4.3.min.js">
</script>
<script type="text/javascript">
    $(document).ready(function () {
        $("#LoginLightBox").fancybox({
            width: 300,
            height: 750,
            scrolling: "no"
        });
        $("#RegistroLightbox").fancybox({
            width: 300,
            height: 750,
            scrolling: "no"
        });
    });

</script>
<asp:ContentPlaceHolder ID="HeadContent" runat="server">
</asp:ContentPlaceHolder>
    </head>
<body id="page1">
<form id="Form1" runat="server">
<asp:ScriptManager ID="ScriptManager" runat="server">
</asp:ScriptManager>
<div>
    <ul>
<li style="display:inline"><a class="labelsTipolinks" id="LoginLightBox" href="Login.aspx?iframe=true">Login</a></li>
<li style="display:inline;color: #C53005;">|</li>
<li style="display:inline"><a class="labelsTipolinks"  id="RegistroLightbox" href="RegistroUsuario.aspx?iframe=true">Registro</a></li>
</ul>
    </div>
</form>
</body>
</html> 
```

# jquery - 自动完成 jquery 添加搜索图标

> ID：11783708
> 
> 赞同：0
> 
> 时间：2012-08-02T18:36:20.300
> 
> 标签：jquery, jquery-ui, autocomplete

我正在使用jquery自动完成，并想在自动搜索输入框中添加搜索图标，并且当他们开始搜索时想要显示搜索jpg。你能提出他们的建议吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-03T07:31:46.843

您可以观察文本框的按键事件。尝试这个：

```
 $( "#tags" ).autocomplete({
        source: availableTags
    }).keyup(function () {
        if (this.value !== '') {
            $(this).addClass('close');   
        } else {
            $(this).removeClass('close');   
        }
    }); 
```

演示：http: [//jsfiddle.net/codef0rmer/5AASU/](http://jsfiddle.net/codef0rmer/5AASU/)

# entity-framework - 链接到实体

> ID：11783710
> 
> 赞同：0
> 
> 时间：2012-08-02T18:36:30.223
> 
> 标签：entity-framework

我有两个三个表，分别命名为
**Language、Language Type、Employee**

语言类型字段为**LId,LanguageType**

语言领域是**LId,EmpId,Language Fluency**

Employee 的字段是**EmpId ,EmpName**

语言类型和语言之间的关系是**一对一的**，语言和员工表是**多对一**的。问题是当我用语言输入数据时，它会显示错误

```
A dependent property in a Referential Constraint is mapped 
to a store-generated column. Column: 'LId'."}. 
```

即使数据被插入到语言类型而不是语言表中。lINQ 查询是针对语言表的

```
public void AddEmpLanguage(Language language, long id)   
{ 
   using (var context = new HRMSEntities())
  {
       Language emp = new Language
       {
            EmpId = id,
            LanguageFluency = language.LanguageFluency,
        };
       context.Language.AddObject(emp);
   }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-08T12:07:16.837

您可以尝试将语言直接添加到员工对象

```
public void AddEmpLanguage(Language language, long empId)   
{ 
    using (var context = new HRMSEntities())
    {
        Language lang = new Language
        {
            LanguageFluency = language.LanguageFluency,
        };
        var employee = context.Employees.Find(empId);
        /*          or context.Employees.FirstOrDefault(x=>x.ID == empId); */
        if(employee != null){
            employee.Languages.Add(lang);
        }
        context.SaveChanges();
    }
} 
```

# php - db2_connect 到 as400 与 php 和 wamp 服务器

> ID：11783711
> 
> 赞同：1
> 
> 时间：2012-08-02T18:36:30.280
> 
> 标签：php, db2, ibm-midrange, wampserver

我一直在尝试连接到**ibm db2**数据库，但这似乎是不可能的。**as400**与运行 php的服务器位于不同的服务器中。

每次我做一个`db2_connect`我得到以下错误：

```
Fatal error: Call to undefined function db2_connect() 
```

我怎样才能使这个功能工作？

**提示**：我已经尝试过`odbc`并且浪费了时间，但我也愿意接受有关该路径的建议。

[编辑]

终于改成java了。。。用php是不可能的。。。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-15T17:06:28.123

试试这个链接： [http ://www.theregister.co.uk/2006/08/09/db2_udb_part2/](http://www.theregister.co.uk/2006/08/09/db2_udb_part2/)

处理：安装 PHP DB2 扩展、创建连接、获取结果集

还提供了 PDO 选项作为替代选项。

但是对于 AS400 上的 DB2，不确定是否还需要在 AS400 上安装某些东西才能使其正常工作？无论如何，使用 ODBC Client Access 完全没有问题。你遇到了什么困难？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-02T19:17:44.657

检查您的 php.ini 文件并确保它启用了 DB2 扩展。 [http://www.php.net/manual/en/install.pecl.php](http://www.php.net/manual/en/install.pecl.php)

# python - 在对象实例上使用装饰器（或其他模式）来生成类

> ID：11783715
> 
> 赞同：3
> 
> 时间：2012-08-02T18:36:33.390
> 
> 标签：python, decorator

我可以看到实现这项工作的多个障碍，这很可能是不可能的，但我想我至少会问......

因此，毫不奇怪，我有一个类`AbstractEnumeratedConstantsGroup`，当子类化创建一个表示一组枚举常量的对象（例如，返回`FLAVORS`值`('VANILLA', 'CHOCOLATE', 'STRAWBERRY')`、`FLAVORS[0]`返回值`'VANILLA'`、`FLAVORS[1]`返回值`'CHOCOLATE'`、`FLAVORS.VANILLA`返回值等）时`0`，它使用元类和其他一些步法，以便所有这些都是创建新常量组所需的是：`FLAVORS.CHOCOLATE``1`

```
class FLAVORS(AbstractEnumeratedConstantsGroup):
    _constants = ('VANILLA', 'CHOCOLATE', 'STRAWBERRY')
FLAVORS = FLAVORS() 
```

我想进一步减少它：

```
@enumerated_constants_group
FLAVORS = ('VANILLA', 'CHOCOLATE', 'STRAWBERRY') 
```

我不知道如何解决的问题是：

我考虑过使用工厂/构建器，但我不喜欢的是它需要在代码中重复组名，或者组具有无用的`__name__`值（用于`__repr__`和`__str__`）。前任：

```
FLAVOR = enumerated_constants_group('FLAVOR', ('VANILLA', 'CHOCOLATE', 'STRAWBERRY')) 
```

或者

```
FLAVOR = enumerated_constants_group(('VANILLA', 'CHOCOLATE', 'STRAWBERRY'))
# FLAVOR.__name__ becomes some unfriendly machine-generated string 
```

作为装饰器思想的替代方案，是否可以从工厂方法引用调用范围（通过自省或隐式传递给函数），以便调用该方法会将新创建的对象插入到调用命名空间中给定的名字？前任：

```
enumerated_constants_group('FLAVOR', ('VANILLA', 'CHOCOLATE', 'STRAWBERRY'))
# I could now reference FLAVOR in any arbitrary scope that the method was called from 
```

我能做些什么来实现我想要的吗？还有其他我没有想到的方法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-02T18:43:47.460

`FLAVORS = ('VANILLA', 'CHOCOLATE', 'STRAWBERRY')`当您分配给一个裸名（如 中）时，没有一般的方法可以影响发生的事情。所以你想要的是不可能的。

也就是说，您可以编写一个元类，将返回的类替换为自身的实例，这样您就不需要`FLAVORS = FLAVORS(...)`在第一个示例中使用最后一行。类定义本身就足以创建对象。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-02T18:53:08.833

你看过[http://code.activestate.com/recipes/413486/](http://code.activestate.com/recipes/413486/)

它允许您编写如下代码：

```
>>> from enum import enum
>>> FLAVORS = enum('VANILLA', 'CHOCOLATE', 'STRAWBERRY')
>>> print FLAVORS
enum (VANILLA, CHOCOLATE, STRAWBERRY)
>>> print FLAVORS.VANILLA
VANILLA
>>> f = FLAVORS.CHOCOLATE
>>> f in FLAVORS
True
>>> for f in FLAVORS:
...     print f
...
VANILLA
CHOCOLATE
STRAWBERRY 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-02T18:44:32.770

作为中间步骤，你可以做

```
FLAVORS = type("FLAVORS",
               (AbstractEnumeratedConstantsGroup,),
               {_constants = ('VANILLA', 'CHOCOLATE', 'STRAWBERRY')})() 
```

这导致了一个假装饰器

```
def enumerated_constants_group(*args):
    AECG=AbstractEnumeratedConstantsGroup
    t = type(args[0], (AECG,), dict(_constants=args[1:]))
    return t()

FLAVORS = enumerated_constants_group('FLAVORS', 'VANILLA', 'CHOCOLATE', 'STRAWBERRY') 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-02T18:47:39.277

除了函数/方法装饰器之外，您还有类装饰器（至少它们在 python 2.4 中存在），请参阅[http://www.python.org/dev/peps/pep-3129/](http://www.python.org/dev/peps/pep-3129/)

无论如何，我不确定这是你需要的。

我会选择将（类型，值）作为参数的工厂类。

请注意：如果您的代码就是这样，并且 AbstractEnumeratedConstantsGroup 没有添加任何功能，那么您为什么不直接使用元组呢？

您可以使用以下内容定义一个 constants.py 模块：

```
FLAVOURS = ('VANILLA', 'CHOCOLATE', 'STRAWBERRY')
PETS = ('DOG', 'CAT', 'FISH') 
```

然后使用您的代码中的这些元组：

```
import constants
for pet in constants.PETS:
    print 'I have a ', pet 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-03T20:33:34.483

命名元组怎么样。[http://docs.python.org/library/collections.html#collections.namedtuple](http://docs.python.org/library/collections.html#collections.namedtuple)

# java - 获取有关打开新窗口的信息

> ID：11783716
> 
> 赞同：0
> 
> 时间：2012-08-02T18:36:39.760
> 
> 标签：java, windows, java-native-interface

[在 Java 中获取活动窗口信息](https://stackoverflow.com/questions/6391439/getting-active-window-information-in-java)允许我检查活动窗口是什么。

我需要的是在后台运行线程并检查是否出现任何新窗口。如何才能做到这一点？

我需要一种方法来通知我的线程出现了一个新窗口。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-02T19:14:21.147

最简单的方法是轮询窗口并检查是否有任何更改。我不知道有什么方法可以收到有关新窗口的通知，但您可以收到有关新进程的通知。尝试[这](http://msdn.microsoft.com/en-us/library/ms644990%28VS.85%29.aspx) [两个](http://msdn.microsoft.com/en-us/library/windows/hardware/ff559951%28v=vs.85%29.aspx)API 调用之一。

# java - 这是进行递归检查字符串是否为回文的最有效方法吗？

> ID：11783717
> 
> 赞同：0
> 
> 时间：2012-08-02T18:36:41.913
> 
> 标签：java

```
public boolean isPalindrome3(String input, int index, int length)
{
    if(index > (length-1-index))
        return true;

    else if(input.charAt(index)!=input.charAt(length-1-index))
        return false;

    else
        return isPalindrome3(input, index + 1, length);

} 
```

这里最初我传递输入字符串 0, input.length()

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-02T19:01:27.623

如果您不必使用递归，这里有一个更有效的回文检查：

```
public boolean isPalindrome3(String input)
{
    for (int start = 0, end = input.length() - 1; start < end; ) {
        if (input.charAt(start++) != input.charAt(end--)) {
            return false;
        }
    }
    return true;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-13T19:20:21.550

```
public static String reverseString(String s) {       
    byte[] array = s.getBytes();
    byte swap;

    for( int i = 0, j = array.length - 1; i < array.length / 2; i++, j--) {
        swap = array[ j ];
        array[ j ] = array[ i ];
        array[ i ] = swap;
    }

    return (new String(array));
}

if(myString.equals(reverseString(myString)))
    // is palindrome 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-02T18:45:20.057

我会这样写：

```
public boolean isPalindrome(String str, int offset)
{    
    int rightOffset = str.length() - offset - 1;
    if (offset <= rightOffset)
    {
        char c1 = str.charAt(offset);
        char c2 = str.charAt(rightOffset);
        if (c1 != c2) return false;

        return isPalindrome(str, offset + 1);
    } else
    {
        return true;
    }
} 
```

与您的代码的差异：

*   不要传递`length`, 因为那是一个 String 属性
*   展开字符比较
*   漂亮的代码格式
*   通过创建局部变量 rightOffset 提高了效率。

# jquery - 将点击链接中的值存储到隐藏输入中以进行发布

> ID：11783721
> 
> 赞同：1
> 
> 时间：2012-08-02T18:36:59.677
> 
> 标签：jquery, html

对于表格中的每个条目，我都有一个更多信息链接（如屏幕截图所示），它显示了附加信息。

当用户单击更多信息链接时，是否有可能从该链接中获取值，将其存储在隐藏的输入字段中，以便发布后我可以获取这些值？

![在此处输入图像描述](../Images/65e1323587bd012b4da2ea6ea49495a0.png)

“更多”信息链接的命名约定是：

```
<a href="#" data-student="2" class="mini-view">more</a>
<a href="#" data-student="6" class="mini-view">more</a>
<a href="#" data-student="7" class="mini-view">more</a>
<a href="#" data-student="9" class="mini-view">more</a> 
```

因此，如果单击了所有链接，它会发布如下数据：2,6,7,9 - 用户可以根据需要多次单击“更多”信息链接，所以我只想将其记录在第一次点击。

因为我要将这些值转换成一个数组并用它来做一些后端检查。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-02T18:54:54.483

```
var clickedIds = '';

$('.mini-view').on('click', function(){

    // need to check if the "more info" has already been clicked
    if(!$(this).data('clicked')){ 

         //if not, update the (serialized) list of clicked student ids:
         clickedIds = clickedIds  + $(this).data('student') + ',';

         //update that value to the hidden field
         //could have done this w/o the clickedIds var, but I think it's cleaner
         //this way:
         $('#myHiddenField').val(clickedIds);

         // then mark it as already clicked.
         $(this).data('clicked', true)

    }

}); 
```

这会将一个序列化列表放入您的隐藏变量中，看起来像“2,6,7,9”，

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-02T18:41:39.747

是的，它可以做到。

```
$('a.mini-view').click(function(){
   $('#id-of-hidden-field').val($(this).attr('data-student'));
}); 
```

所以我做了什么。

1.  附上点击链接
2.  使用属性值并将其添加到隐藏字段中
3.  它已经完成了。

如果你想添加多个值，例如逗号分隔然后这样做

```
$('a.mini-view').click(function(){
    var hf = $('#id-of-hidden-field');
    var newVal = hf.val() + (hf.val().length > 0 ? ',' : '') + $(this).attr('data-student');
    hf.val(newVal);
}); 
```

你会有像`1,4,23,1,19`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-02T18:55:36.780

您可以做的是每次单击链接时，检查“clicked”属性是否为真/存在，如果不是，则将该值添加到一些隐藏的输入，然后将“clicked”属性添加到链接。

这样，如果他们多次单击它，它只会将其添加到隐藏输入中一次。

像这样的东西：

```
$('a.mini-view').click(function(){
    var clicked = $(this).attr("clicked");
    var value = $(this).attr("data-student");
    if (!clicked){
        var newValue = $('#hidden-field').val() + "," + value;
        $('#hidden-field').val(newValue);
        $(this).attr("clicked", true);
    }
}); 
```

# c# - VB6 GMTOffset 到 C#

> ID：11783722
> 
> 赞同：1
> 
> 时间：2012-08-02T18:37:08.590
> 
> 标签：c#, vb6, vb6-migration

我正在尝试将下面的代码从 VB6 转换为 C#。我只是不确定从哪里开始，我想可能是因为我被 VB6 深深吸引，似乎无法退后一步。

```
Private Function GMT_OFFSET() As Integer
    '****DECLARE VARIABLES
    Dim dtNow As Date, dtEngland As Date
    Dim dtGMT As SYSTEMTIME
    '****GET SYSTEM TIME INFORMATION
    Call GetSystemTime(dtGMT)
    dtNow = Now
    dtEngland = dtGMT.wYear & "-" & dtGMT.wMonth & "-" & dtGMT.wDay & " " & dtGMT.wHour & ":" & dtGMT.wMinute & ":" & dtGMT.wSecond
    '****RETURN QUARTER HOURS
    GMT_OFFSET = DateDiff("n", dtEngland, dtNow) \ 15
End Function 
```

我知道 GetSystemTime 是一个 Win32 API，显然不想在 .NET 中执行 PInvoke，而是在 .NET Framework 中使用纯对象。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-02T19:04:56.190

根据您的代码，您正在寻找以下内容：

```
 var dtNow = DateTime.Now;
        var dtOffset = (dtNow.ToUniversalTime().Subtract(dtNow)).TotalMinutes / 15; 
```

如果通用时间大于当前系统时间，您可能需要负向调整偏移量。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-02T19:22:49.843

系统时间：

```
DateTime systemDateTime = DateTime.Now; 
```

但更重要的是，系统运行的偏移量：

```
TimeZoneInfo systemTimeZone = TimeZoneInfo.Local;
TimeSpan offset = systemTimeZone.GetUtcOffset();
Int32 offsetMinutes = offset.Hours * 60 + offset.Minutes; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-03T14:38:27.220

近直接翻译：

```
//Private Function GMT_OFFSET() As Integer
int GMT_OFFSET()
{
  //'****DECLARE VARIABLES
  //Dim dtNow As Date, dtEngland As Date
  DateTime dtNow, dtEngland;
  //Dim dtGMT As SYSTEMTIME
  //'****GET SYSTEM TIME INFORMATION
  //Call GetSystemTime(dtGMT)
  //dtNow = Now
  //dtEngland = dtGMT.wYear & "-" & dtGMT.wMonth & "-" & dtGMT.wDay & " " & dtGMT.wHour & ":" & dtGMT.wMinute & ":" & dtGMT.wSecond
  dtEngland = DateTime.UtcNow;
  dtNow = dtEngland.ToLocalTime;
  //'****RETURN QUARTER HOURS
  //GMT_OFFSET = DateDiff("n", dtEngland, dtNow) \ 15
  return Convert.ToInt32((dtNow - dtEngland).TotalMinutes) / 15;
//End Function
} 
```

NB VB6 的`DateDiff(interval,date1,date2)`结果基于`date2 - date1`，*反之亦然*。

但单线是：

```
return Convert.ToInt32(TimeZoneInfo.Local.GetUtcOffset(DateTime.UtcNow).TotalMinutes) / 15; 
```

# programming-languages - 为什么人们要为编程语言创建标准

> ID：11783724
> 
> 赞同：2
> 
> 时间：2012-08-02T18:37:13.873
> 
> 标签：programming-languages, standards, specifications

为什么人们在每种语言开发后不久就为其创建标准（或规范）？

**C++**

> 1998 年，C++ 标准委员会（ISO/IEC JTC1/SC22/WG21 工作组）对 C++ 进行了标准化，并发布了国际标准 ISO/IEC 14882:1998（非正式地称为 C++98）。

**爪哇**

> 1997 年，Sun Microsystems 与 ISO/IEC JTC1 标准机构以及后来的 Ecma International 接洽以正式化 Java，但很快就退出了该进程。

**JavaScript**

> 1996 年 11 月，Netscape 宣布已将 JavaScript 提交给 Ecma International 以作为行业标准考虑，随后的工作产生了名为 ECMAScript 的标准化版本。

而这样的例子不胜枚举。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-02T18:42:18.097

主要是为了确保不同的实现就实际构成该语言的内容达成一致，因此他们在用该语言编写的程序中接受和拒绝什么。

这主要是由于早期许多语言（例如，Lisp）*没有*标准化，这导致了碎片化和不兼容。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-02T18:41:30.167

制定标准是为了让想要实现或构建编译器或使用语言的公司和个人知道语言的预期行为是什么，并确保它们在实现之间保持一致。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-02T18:42:55.143

因为一个简单的事实（就像 Java 发生的那样）每家公司都将各自朝着不同的方向发展该语言。标准为遵循该标准的所有编译器应遵守的语言创建了最低规范。

# c# - 调用已初始化（非空）委托会产生 NullReferenceException（在 Windows 服务中）

> ID：11783728
> 
> 赞同：1
> 
> 时间：2012-08-02T18:37:34.897
> 
> 标签：c#, multithreading, .net-4.0, windows-services

出于某种原因，我很难从 Windows 服务的线程中调用委托方法。不要认为环境有那么大的不同，但希望您理解为什么我不能在调试器中单步执行此代码（尽管跟踪记录是很有可能的）。下面是一个简化的大纲；我想要的只是从主类执行回调以处理接收到的数据（我的愿望是将数据处理实现[涉及太多其他依赖项]与*BaseSvc*的库代码分开）：

```
public class    BaseSvc         // library class (separate DLL)
{
    public delegate     bool    dlProcCmd( byte[] bData );
    public static   dlProcCmd   fnProcCmd;

    public static void      Start( )                                // 1
//  public static void      Start( BaseSvc.dlProcCmd ProcCmd )      // 2
    {
//      BaseSvc.fnProcCmd=  ProcCmd;                                // 2
        ..
        bListen=    true;
        thTcpComm=  new Thread( new ThreadStart( TcpComm ) );
        thTcpComm.Start( );
    }
    ..
    public static void      TcpComm( )
    {
        ..
        while(  bListen  )
        {
            ..
            if(  fnProcCmd != null  )
            {
                Utils.Log( fnProcCmd.Method.ToString( ) );
                    // prints:Boolean ProcCmd(Byte[])
                fnProcCmd( bData );     // throws:
                    // Void TcpComm():  System.NullReferenceException
                    // Object reference not set to an instance of an object.
            }
        }
    }
    ..
} 
```

..

```
public partial class    WinSvc : ServiceBase        // SCM-compatible .exe
{
    /// <summary>Handles Start command</summary>
    protected override void     OnStart( string[] args )
    {
        BaseSvc.fnProcCmd=  ProcCmd;                                // 1a
//      BaseSvc.fnProcCmd=  new BaseSvc.dlProcCmd( ProcCmd );       // 1b
//      BaseSvc.fnProcCmd+= new BaseSvc.dlProcCmd( ProcCmd );       // 1c
        BaseSvc.Start( );                                           // 1
//      BaseSvc.Start( new BaseSvc.dlProcCmd( ProcCmd ) );          // 2
        ..
    }

    public bool     ProcCmd( byte[] bData )
    {
        ..
        return  true;
    }
} 
```

起初我认为代理方法的声明或初始化是错误的，所以各种尝试都用 1a、1b、1c 和 2 标记。然而，在任何一种情况下，我最终都会得到一个跟踪打印输出，确认`if( fnProcCmd != null )`检查通过，然后是空引用异常。 *bData*参数在那一刻被初始化，100% 保证并通过跟踪确认，因此仅留下`fnProcCmd`作为罪魁祸首。但它被初始化了，不是吗！？我在这里想念什么？

可能是*WinSvc类的执行上下文与**BaseSvc*的执行上下文不同，和/或`TcpComm( )`在它自己的线程中执行？在这种情况下，我希望出现更直观的错误..

我一定做错了。我应该怎么做才能启用这样的回调？

**更新**：在 Henk 的建议之后，我注释掉了`ProcCmd`'s body 并且问题消失了，=> 问题在该代码中，与委托机制无关。很抱歉造成混乱。
（顺便说一句，通过场景 1a 使用委托可以正常工作。）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-03T09:26:56.240

看这部分：

```
 if(  fnProcCmd != null  )
        {
            Utils.Log( fnProcCmd.Method.ToString( ) );
                // prints:Boolean ProcCmd(Byte[])
            fnProcCmd( bData );     // throws:
                // Void TcpComm():  System.NullReferenceException
                // Object reference not set to an instance of an object.
        } 
```

空检查`fnProcCmd`是广泛且令人信服的，因此它必须是内部发生的事情`ProcCmd()`。

要了解错误，请尝试使用空的 ProcCmd() ：

```
 public bool     ProcCmd( byte[] bData )
 {
    //    ...
    //
    //    ...
    return  true;
 } 
```

# meteor - 为什么在浏览器中禁用 websockets

> ID：11783729
> 
> 赞同：1
> 
> 时间：2012-08-02T18:37:41.990
> 
> 标签：meteor

Meteor 很棒，但看起来它在浏览器中使用长轮询而不是真正的 websocket。

Meteor 使用 sockjs，对吗？套接字是否被明确禁用？（在这里某处阅读）。这是什么原因？

坦克很多安德烈亚斯

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-02T19:34:43.633

**编辑：**由于[Meteor 0.6.3.1](http://meteor.com/blog/2013/05/15/meteor-063-websockets-mongodb-24-coffee-162-synthetic-tap-events) websockets 在许多浏览器中默认启用。

**上一个答案：** 由于某种原因，我找不到源（认为它在邮件列表中，但在那里找不到），但是从我的脑海中：

由于与各种浏览器的兼容性问题，它们被明确禁用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-16T11:54:46.343

由于启用 Inspector 时 WebSockets 会导致 Chrome 崩溃，因此在流星中禁用了 WebSockets。而已。

# php - 使用 PHP 检索 App Store 应用程序图标 URL

> ID：11783732
> 
> 赞同：1
> 
> 时间：2012-08-02T18:37:43.893
> 
> 标签：php, app-store

我发现 App Store API 支持有关应用程序的附加信息。

```
$keyword = $this->input->post('keyword');
$appstore_api = 'http://itunes.apple.com/search?country=US&entity=software&term='.$keyword;
$data = file_get_contents($appstore_api);
echo $data; 
```

这是我编写的 PHP 代码。

我得到这个结果。

{ "resultCount":50, "results": [ {"kind":"software", "features":[], "supportedDevices":["all"], "isGameCenterEnabled":false, "artistViewUrl":"http ://itunes.apple.com/us/artist/burbn-inc./id389801255?uo=4", "artworkUrl60":"http://a2.mzstatic.com/us/r1000/105/Purple/v4/ f3/0e/e2/f30ee271-c564-ec21-02d6-d020bd2ff38b/Icon.png", "screenshotUrls":["http://a3.mzstatic.com/us/r1000/102/Purple/v4/2d/25 /d3/2d25d348-74e9-8365-208c-45e64af73ed6/mzl.xnvocmpt.png”, “http://a1.mzstatic.com/us/r1000/077/Purple/v4/04/18/b3/0418b375-c0c1 -18c1-1aef-07555c99af46/mzl.pkthtqtv.png”, “http://a2.mzstatic.com/us/r1000/069/Purple/v4/31/08/65/31086528-2f37-bca0-71f3-c3095e698f35 /mza_8774562250786021670.png", "http://a3.mzstatic.com/us/r1000/091/Purple/v4/95/a2/65/95a265bb-b9f0-8732-9fe4-823ffbc9aba0/mza_5807950548098772841.png"], "ipadScreenshotUrls":[], " artUrl512":"http://a4.mzstatic.com/us/r1000/089/Purple/v4/44/76/7f/44767fb5-4cb2-25bf-5361-25138b8c2aeb/mzl.ntalagmr.png",

问题是如何提取名为“artworkUrl512”的变量？

我试过这样但失败了。

```
$image_url = $data->results->artworkUrl512;
$image_url2 = $data['results']['artworkUrl512']; 
```

你能帮我如何提取图标图像网址吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-02T18:39:58.077

`$data`是json编码的。使用`json_decode()`：

[http://php.net/manual/en/function.json-decode.php](http://php.net/manual/en/function.json-decode.php)

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2015-08-22T14:09:46.280

```
$data = json_decode($json, true);
echo $data['results'][0]['artworkUrl512']; 
```

# sql - 如何从 grails 调用数据库函数？

> ID：11783733
> 
> 赞同：3
> 
> 时间：2012-08-02T18:37:43.847
> 
> 标签：sql, database, grails, groovy

如何从 grails 调用数据库函数？比如像这样`CONVERT(decimal, timestamp)` 不使用groovy SQL：

```
def sql = new Sql(dataSource) 
```

我想避免任何 SQL 语句并充分利用 grails 的魔力。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-02T18:43:30.460

我的理解是 grails 没有对数据库功能的原生支持。您将需要编写 SQL。Gorm 是 Hibernate 的一个抽象，你可能要参考：

[如何使用 Hibernate 调用自定义数据库函数？](https://stackoverflow.com/questions/1909315/how-can-you-call-custom-database-functions-with-hibernate)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-02-19T16:22:56.677

在您的**域类**中，首先您必须 -

**导入 groovy.sql.Sql**

然后您可以创建 Sql 实例并调用如下函数 -

```
 def date = "'21-Feb-19 14:10:10.123000'"
    def timestamp_format = "'DD-Mon-RR HH24:MI:SS.FF'"
    String query = 'select to_timestamp('+date+','+timestamp_format+') from dual'
    def sql = Sql.newInstance('url', 'username', 'password', 'driverClassName')
    def result= sql.rows(query);
    def rows = result.collect{it.values()}
    println rows 
```

# clojure - 如何使用 gen-class 定义静态初始化程序

> ID：11783736
> 
> 赞同：4
> 
> 时间：2012-08-02T18:37:55.407
> 
> 标签：clojure, gen-class

我正在从 Clojure 生成一个实现 JDBC 驱动程序的 Java 类，问题是通常 JDBC 驱动程序`DriverManager`在静态初始化程序中注册自己，如下所示：

```
public class MyDriver implements java.sql.Driver {
    ...
    static { 
        ...
        try {
            DriverManager.registerDriver(new MyDriver());
        } catch (SQLException s) {
            throw (RuntimeException) new RuntimeException
                ("could not register MyDriver driver!").initCause(s);
        }
        ...
     }
} 
```

我必须在`gen-class`声明中添加什么以及实现它的函数应该具有哪个名称？

谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-02T20:02:55.323

我不相信这`gen-class`在目前纯粹是可能的。clojure 的 gen-class 总是生成一个静态初始化器，它通过调用将生成的类与 clojure 运行时联系起来

```
clojure.lang.Var#internPrivate(String, String) 
```

该静态初始化程序的生成具有一定的灵活性（请参阅 的`:load-impl-ns`选项`gen-class`），但没有办法将您自己的自定义代码添加到初始化程序中，我在查看 genclass.clj 后可以看到。

顺便说一句 - 顺便说一句，在 JVM 中，静态初始化器“方法”的名称是`<clinit>`

# javascript - 如何使用 jquery 选择前一个 li？

> ID：11783738
> 
> 赞同：1
> 
> 时间：2012-08-02T18:37:58.257
> 
> 标签：javascript, jquery

我有一个无序列表，但其中有不同类别的标题。

```
<ul>
    <h2>header1</h2>
    <li>...</li>
    <li>...</li>
    <li>...</li>
    <li>...</li>
    <h2>header2</h2>
    <li>...</li>
</ul> 
```

我正在尝试遍历它们并按日期对它们进行排序，但是标题却将其丢弃。

我正在循环使用：

```
var list = $('#articleList');
list.children("li").each(function () {
    ...
} 
```

我在循环中使用它来选择它之前的那个：

```
var prev = $(this).prev("li"); 
```

出于某种原因，如果您在标题之后的列表项上而不是在它们之前的列表项上，则 prev 会选择标题。所以我的排序最终在标题中是正确的，但我需要对整个内容进行排序，而不仅仅是在部分中。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-02T18:43:45.403

这与 HTML 解析有关。根据[规范](http://www.w3.org/TR/html401/struct/lists.html#h-10.2)，列表只能包含`<li>`元素，不能包含其他任何内容。因此，您的浏览器将构建一个不同的 DOM，例如通过将标题包装到列表项中（HTML5 将指定如何处理无效的 HTML）。使用 DOM 检查器查看实际的 DOM 树（上下文菜单 -> 检查元素）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-02T18:48:15.360

我怀疑您不正确的 HTML 正在弄乱 jQuery 。`prev()`方法。`ul`元素不应有`h2`子元素。

相反，你应该让你的`h2`元素成为元素的子`li`元素，让你的 HTML 看起来像这样：

```
<ul id="articleList">
    <li class="header"><h2>header1</h2></li>
    <li>...</li>
    <li>...</li>
    <li>...</li>
    <li>...</li>
    <li class="header"><h2>header2</h2></li>
    <li>...</li>
</ul> 
```

请注意，每个`li`包含元素的`h2`元素都有一个“标题”类。然后，您可以像这样遍历每个非标题`li`元素：

```
var list = $('#articleList');
list.children("li:not(.header)").each(function () {
    ...
} 
```

并像这样获取前一个非标题`li`元素：

```
var prev = $(this).prev("li:not(.header)"); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-02T18:42:47.043

尝试以下操作：

```
var prev = $(this).prevUntil('li').first(); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-03T08:22:08.760

这适用于您的html：

```
 var prevLI = $('ul li:last').prevAll('li:first');
    $('body').append('<h2>Selected: '+ prevLI.text() + '</h2>' ); 
```

试试这个小提琴：http: [//jsfiddle.net/guumaster/4Ax6v/1/](http://jsfiddle.net/guumaster/4Ax6v/1/)

# javascript - 使用 jQuery 搜索链接 HREF 值

> ID：11783740
> 
> 赞同：0
> 
> 时间：2012-08-02T18:38:11.190
> 
> 标签：javascript, jquery, html

我需要为用户添加一种通过箭头循环浏览画廊的方式。我已经将脚本设置为使用带有链接的缩略图在照片区域中显示更大的图像。

我用来使箭头起作用的方法是获取`src`当前图像的 ，并搜索缩略图链接`src`，然后`src`根据单击的箭头（`.left`或`.right`）查找下一个或上一个。

问题是：我不知道该怎么做。我有脚本可以在`src`用户单击箭头时找到当前的，但我不知道如何在缩略图中搜索相同的 src 或找到下一个或上一个 src。

[http://jsfiddle.net/G5VAf/](http://jsfiddle.net/G5VAf/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-02T18:44:04.490

用户`$(...).prev()`并`$(...).next()`为了获得下一张或上一张图片

```
$(this).prev('img')  // gives you previous img tag
$(this).next('img')  // gives you next one 
```

检查您更新的[jsfiddle](http://jsfiddle.net/G5VAf/5/)

[$.next()](http://api.jquery.com/next)

[$.prev()](http://api.jquery.com/prev)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-02T18:57:26.110

您可以使用`$('img[src="'+current+'"]')`来获取具有相同来源的任何图像。大概您想使用类似的东西`$('#thumbnails img[src=...]')`或`$('img.thumb[src=...]')`将自己限制在缩略图上。

获取下一个或上一个图像是使用[`.next()`](http://api.jquery.com/next/)and的简单问题[`.prev()`](http://api.jquery.com/prev/)。

# android - Android NDK 最佳实践

> ID：11783741
> 
> 赞同：1
> 
> 时间：2012-08-02T18:38:13.723
> 
> 标签：android, intellij-idea, android-ndk

有一段时间我在 IntelliJ Idea 中为 Android 开发。有时使用 jni 总是很不舒服。

请建议让 Idea 用 C/C++ 做这些事情的最佳方法

*   语法高亮
*   自动完成
*   索引来源并提供“成员的用法”或“转到声明”链接

理想情况下，在idea中显示错误消息并在代码中显示带有错误的行（如java）会非常酷。我相信有几个很好的解决方案。也许在 Eclipse 中？或者在 Emacs >< 中？

UPD。好的，我自己发现的是 Sequoyah，MVS 中的 n-vidia ndk 调试，idea 中的 c++ 插件和 iTerm 中的 ndk-stack。除了n-vidia，我都试过了。而这一切都不尽人意。这是所有解决方案吗？也许有一些关于适当调优的人？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-02T18:41:55.810

从未尝试过，但[Sequoyah 项目](http://www.aton.com/integrating-the-android-ndk-c-native-support-into-eclipse-using-sequoyah/)似乎就是将 NDK 开发与 Eclipse 集成。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-17T06:17:37.900

好吧，差不多一年过去了，但在极端情况下，我仍然没有发现比调试打印和 GDB 更好的东西。GDB 相当容易使用，但很不舒服。

每个特殊的 IDE 或插件看起来都不是真正的解决方案。希望宣布的 Android Studio 在发布阶段会有所帮助。

# javascript - 手动触发 domContentLoaded

> ID：11783745
> 
> 赞同：1
> 
> 时间：2012-08-02T18:38:43.827
> 
> 标签：javascript, dom

我偶然发现了一个执行此操作的脚本：

```
"complete" === document.readyState ? setTimeout(I, 1) : document.addEventListener ? (document.addEventListener("DOMContentLoaded", X, h), window.addEventListener("load", X, h)) : window.attachEvent ? window.attachEvent("onload", X) : console.log("No available event.") 
```

其中 X 和 I 是函数，h 为假。

它有什么作用？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-02T18:53:06.763

也许你会这样更好地理解它：

```
if("complete" === document.readyState){
    setTimeout(I, 1);
}else{
    if(document.addEventListener){
        document.addEventListener("DOMContentLoaded", X, h),
        window.addEventListener("load", X, h));
    }else{
        if(window.attachEvent){
            window.attachEvent("onload", X);
        }else{
            console.log("No available event.");
        }
    }
} 
```

它确实：

1.  检查文档是否已加载
2.  如果是，`I`则在 1 ms 后调用函数
3.  如果没有，它会检查浏览器是否支持`addEventListener`
4.  如果支持，则在加载 DOM 时，`X`将调用函数（通过`DOMContentLoaded`或`load`事件）
5.  如果不是，它会检查浏览器是否支持`attachEvent`
6.  如果支持，则在加载 DOM 时，将调用函数 X（通过`load`事件）
7.  如果不是，则表示浏览器不支持`addEventListener`也不支持`attachEvent`

我猜函数`X`访问或修改 DOM，所以上面的脚本在调用之前检查 DOM 是否完全加载`X`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-02T18:44:42.603

这似乎是一段代码，它以跨浏览器的方式检测 DOM 的加载状态。

如果浏览器不支持 DOMContentLoaded，它将回退到使用窗口加载事件。

这用于在 DOM 可供操作时（即在页面呈现后）启动您的代码。

# assembly - LLVM 4.0 的内联汇编问题

> ID：11783751
> 
> 赞同：3
> 
> 时间：2012-08-02T18:39:24.577
> 
> 标签：assembly, clang, inline-assembly, neon, llvm-4.0

在 Xcode 4.4 上，我在最后一个 LLVM 编译器 (4.0) 上编译内联汇编时遇到了一些问题。

在我的内联汇编代码中，对“fldmias”的每次调用都像：

```
asm volatile(    
"fldmias  %2, {s4-s19}    \n\t"
...
) 
```

给我这个错误：

**内联汇编问题**：指令“fldmia”无法设置标志，但指定了“s”后缀

相同的代码适用于 LLVM GCC 4.2。也许每个编译器的配置之间存在一些差异，但我没有找到任何东西。

谢谢。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-02T19:01:57.067

正如在上面的评论中发现的，这里的答案是使用 UAL 等效指令，在这种情况下是：

```
VLDMIA.32 %2, {s4-s19} 
```

# ruby-on-rails - 有关 Savon Gem 、 WSDL 和 Rails 请求的信息

> ID：11783756
> 
> 赞同：1
> 
> 时间：2012-08-02T18:39:50.213
> 
> 标签：ruby-on-rails, ruby, soap, ruby-on-rails-3.1, wsdl

**我解决了我的问题，但我仍然不明白为什么会有这个**问题。**

小解释：我必须使用一些参数调用 SOAP 服务器。

这是来自 wsdl webservice 的定义：

```
Method : "lanceDecodage"
 Jeton: xsd:string
 ID_JOB: xsd:string
 Priorite: xsd:int 
```

我想这样做：

```
@response_second = Savon.client(server).request(:lanceDecodage) do
      soap.body =  {
       :jeton => "ABCDEF"
       :ID_JOB => "123"
       :Priorite => 456
      }
    end 
```

但是服务器说我没有指定“优先”参数。

所以这个丑陋的请求成功了：

```
 @response_second = Savon.client(server).request(:lanceDecodage) do
          soap.body =  
            '<Jeton>ABCDEF</Jeton><ID_JOB>' + sound.id_job.to_s + '</ID_JOB><Priorite xsi:type="xsd:int">456</Priorite>'
        end 
```

'xsi:type="xsd:int"' 有什么问题？我们必须指定整数的类型吗？WebService 有问题吗？

谢谢您的答复。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-16T09:43:37.930

我没有一个很好的答案，但显然问题出在糟糕的 SOAP 服务上……谢谢您的回复

# php - 从结果中排除 mysql 中子查询结果中的内容

> ID：11783759
> 
> 赞同：0
> 
> 时间：2012-08-02T18:39:58.623
> 
> 标签：php, mysql, subquery

是否可以在子查询的结果中不显示某些内容。

示例：table1：有 4 个数字，1,2,3,4。所以 select * from table1 显示 4 结果

是否可以制作：

```
 select * from table1 where not exists(select * from table1 where num = 3) 
```

所以结果将是 1,2,4。基本上从结果中删除子查询结果中的某些内容。

我知道存在对此不起作用，因为它只给出真假，但还有其他方法吗？

谢谢大家。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-02T18:44:01.357

`select * from table1 where num <> 3;`?

或者

`select * from table1 where id NOT IN (select id from table2 where num = 3);`

详细说明你想要的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-02T18:44:23.407

您可以使用`NOT IN`，但子查询必须只返回一列（我认为存在同样的事情）。像这样的东西：

```
SELECT * FROM table WHERE column1 NOT IN (SELECT column1 FROM table WHERE column2 = 3) 
```

# variables - 如何在 Mathematica 中保存多个具有迭代名称的变量？

> ID：11783760
> 
> 赞同：6
> 
> 时间：2012-08-02T18:40:00.553
> 
> 标签：variables, wolfram-mathematica, iteration

我想在 Mathematica 中创建多个具有迭代名称的变量，如下所示：

```
Do["f" <> ToString[i] = i*2, {i, 1, 20}] 
```

我得到 f1=2, f2=4, f3=6, ... 等等。

我的错误：

> Set::write: f<>1 中的标记 StringJoin 受保护。>>

任何帮助都会很棒。谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-03T03:25:01.343

要实现这一点，您需要在( ) 看到它`"f" <> ToString[i]`之前评估表达式，或者您尝试使用 head 分配给一个对象，就像错误消息试图告诉您的那样。此外，您不能对字符串进行赋值，因此您需要使用 (surprise) 将其转换为符号。一种方法是使用：`Set``=``StringJoin``Symbol``Evaluate`

```
Do[Evaluate[Symbol["f" <> ToString[i]]] = i*2, {i, 1, 20}]

{f1, f2, f17} 
```

> {2, 4, 34}

然而，这通常不是使用*Mathematica*的好方法。例如，如果这些符号中的任何一个已经存在并且分配了值，则操作将失败。[正如如何在不评估符号的情况下阻止符号](https://stackoverflow.com/q/6234701/618728)的答案中所见，人们*可以通过更多的努力来解决这个问题？*（或更具体地说，在[我的回答](https://mathematica.stackexchange.com/a/784/121)中）但同样，这通常不是一个好的行动方案。

正常的方法是使用PrinceBilliard 显示的[索引对象。](http://reference.wolfram.com/mathematica/tutorial/MakingDefinitionsForIndexedObjects.html)

请参阅[此问题](https://mathematica.stackexchange.com/q/6511/121)、其答案以及下方评论中链接的四个相关问题，以了解有关此主题的更多信息。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-03T00:43:54.410

`Do[f[i] = i^2, {i,1,20}]`

迭代变量名称的工作方式类似于 f[i]。您还可以声明迭代的函数名称，例如`f[2][x_] := ...`

# c# - 使用 Web.UI.WebControls TreeView 仅检查节点的重复 TreeView 控件

> ID：11783761
> 
> 赞同：1
> 
> 时间：2012-08-02T18:40:06.017
> 
> 标签：c#, treeview

我在 C# 中使用 TreeView 控件的 Web 版本，并且我在页面上有一个带有复选框的 TreeView。用户将在 TreeView 中选择 1:n 的叶节点。父节点只能选择，因此用户可以选择所有子节点而无需单击每个子节点。一旦用户检查了所需的节点，他们将单击一个按钮并被带到一个新页面。对于此页面，我希望能够传递与前一页的 TreeView 具有相同层次结构的 TreeView 对象，但仅显示已检查的节点或已检查节点的父节点。我已经看到很多使用 Web.Forms 版本的 TreeView 的示例，但我似乎找不到使用 Web.UI 版本的好方法。

# hadoop - Hadoop 用于数据迁移

> ID：11783763
> 
> 赞同：1
> 
> 时间：2012-08-02T18:40:22.383
> 
> 标签：hadoop, hdfs, data-migration, spring-batch, jcr

我遇到的大多数情况是数据被迁移进/出 HDFS。而且我对 Hadoop 完全陌生！

但我的要求是在一个符合 JCR 的平面文件存储库中从各种来源移动大型二进制文件。我的问题是

1) Hadoop 是从 X 读取和写入 Y（两个非 HDFS 系统）场景的好选择吗？

2) 任何其他自定义框架或类似 Spring Batch 的东西都可以达到同样的目的吗？这意味着它只是IO和网络的问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-02T19:43:47.237

是的，您可以使用 hadoop，如果您的 X 和 Y 可以处理多个连接，并且如果您并行检索和存储数据将提供更好的性能。

有一个叫做[sqoop](http://sqoop.apache.org/)的框架可以更好地满足你的需求。

# dynamics-crm-2011 - 在 CRM 2011 中测试已建立的工作流程

> ID：11783766
> 
> 赞同：1
> 
> 时间：2012-08-02T18:40:24.020
> 
> 标签：dynamics-crm-2011

我最近创建了一个强大的 CRM 2011 工作流程来处理我们所有的任务，我希望能够对其进行测试。不幸的是，它包含一个 3 周的超时，之后它会发送一封电子邮件，这会阻止我们对其进行实时测试。是否有任何资源可用于测试这些工作流程（没有它们对现实世界的影响）？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-02T20:36:52.153

标准做法（为了更好的术语）是将超时减少到一分钟，并在切换回正确的超时之前在开发环境中运行工作流。

我不相信这种方法有任何替代方法。

# jquery - 在 jquery 中查找输入的每个更改

> ID：11783776
> 
> 赞同：0
> 
> 时间：2012-08-02T18:40:56.610
> 
> 标签：jquery, html, events, onchange

我在 html 中有一个输入。我想了解其内容的每一次变化。我知道 jquery 中有 .change 函数。但是当您关注/关注输入时它会触发。我希望当用户输入输入时，每个字母都会调用一个函数。有什么办法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-02T18:42:24.893

```
$("#yourinput").on("keyup",function(){
   //do stuff here
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-03T03:22:39.217

怎么用`input event`？这不是跨浏览器的方式，但它应该可以解决问题。
它在文本更改时触发，因此您可以通过箭头键导航而不会触发它。

[演示](http://jsfiddle.net/ricardolohmann/KUtDp/)

或者您可以存储最后输入的文本并与`keyup`跨浏览器方式的实际进行比较。

*参考*： - [https://developer.mozilla.org/en/DOM/DOM_event_reference/input](https://developer.mozilla.org/en/DOM/DOM_event_reference/input)

# windows - Windows server 2008r2 多播和 igmp 问题

> ID：11783777
> 
> 赞同：2
> 
> 时间：2012-08-02T18:40:57.170
> 
> 标签：windows, windows-server-2008-r2, multicast, igmp

我在 Windows 2008 R2 服务器上运行多播，发现路由器为我加入的组关闭多播时出现间歇性问题。在使用wireshark 并查看IGMP 流量时，我发现当路由器发出一般IGMP 查询时，有时没有发送IGMP 成员报告。例如，如果我加入了 4 个小组，有时我会看到全部四个小组的回复，有时是三个小组，有时是两个小组。我在路由器中将到期时间设置为 300 秒，理论上可以弥补这一点，但这并不总是能保证成功。当路由器停止馈送时，它会在 120 秒后重新启动它，这对于我正在读取的数据来说太大了，无法尝试填补。

这是可以修复的吗？这似乎不是正常的行为。

# c++ - SQLite 是否使用 SQLCipher 扩展泄漏内存？

> ID：11783781
> 
> 赞同：5
> 
> 时间：2012-08-02T18:41:13.330
> 
> 标签：c++, c, memory-leaks, sqlite, sqlcipher

我正在使用[SQLCipher](http://sqlcipher.net/)存储加密的[SQLite](http://www.sqlite.org/)数据库。但是，当我使用`sqlite3_key`加密数据库时，我开始出现内存泄漏。观察以下示例：

```
#include <sqlite3.h>    

int main()
{
    sqlite3 * connection;
    sqlite3_open_v2(":memory:", &connection, SQLITE_OPEN_READWRITE | SQLITE_OPEN_CREATE, NULL);
    sqlite3_key(connection, "passphrase", 10);
    sqlite3_close(connection);
} 
```

此示例产生内存泄漏。如果我删除对 的调用`sqlite3_key`，内存泄漏就会消失。

我已经缩小了一些可能的罪魁祸首：

*   尽管该示例使用内存数据库（因此`":memory:"`），但在使用基于文件的数据库时，我看到了相同的结果。
*   `sqlite3_*`调用的所有返回码都是`SQLITE_OK`，这意味着没有任何错误。
*   `10`for的缓冲区长度`"passphrase"`不是问题。

但是，无论我创建多少连接或使用多少不同的加密密钥，内存泄漏总是大约 8 KB。这让我怀疑这实际上不是内存泄漏，而只是 SQLite/SQLCipher 中的一些不变的全局内存，不会手动释放。

有谁之前经历过这个吗？有没有办法摆脱泄漏？即使这不是官方的内存泄漏，也很难用这个礼物检测到真正的内存泄漏。

我正在[为 Windows 使用 SQLCipher 库](https://github.com/CovenantEyes/sqlcipher-windows)。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-02T15:58:36.010

我对此进行了更深入的研究，这些报告的泄漏是由 OpenSSL 分配的内存造成的。由于 SQLCipher 不知道应用程序何时严格使用它，`EVP_cleanup()`因此不会调用它，并且 valgrind 将内存报告为泄漏。我们正在努力进行一个简单的修复，该修复将尝试通过一些简单的引用计数来识别 SQLCipher 何时不再使用 OpenSSL 结构，因此`EVP_cleanup()`可以自动调用。

作为 SQLCipher 下一个版本之前的快速解决方法，您可以`EVP_cleanup()`在退出之前在程序中手动调用。

# google-maps - 使用 Javascript API v3 在地图上将有效的 Google 街景区域显示为图层

> ID：11783782
> 
> 赞同：13
> 
> 时间：2012-08-02T18:41:20.530
> 
> 标签：google-maps, google-maps-api-3

我正在开发一个使用 Google Maps Javascript API v3 的 javascript Web 应用程序。地图允许用户做的一件事是沿着街道绘制路线。但是，我希望用户能够沿着已经被街道查看过的街道绘制路线，我遇到了一些问题......

当您将黄色街景人拖到地图对象上时，所有有效的街景街道都会亮起蓝色。但是，有时这些街道与实际地图没有正确对齐，有时地图上的街道没有经过街道查看。我的问题是如何让“有效街景区域”覆盖在地图上而不拖着黄色的人？有没有我可以以某种方式激活的层？

我希望该图层始终可见，以便用户可以判断他们正在绘制路线的街道是否已被街景查看，并能够确保他们的路线与街景网格对齐。

谢谢

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-12-04T16:17:10.010

StreetViewCoverageLayer() 已添加到 v3 api，因此这是可能的。

[https://developers.google.com/maps/documentation/javascript/reference#StreetViewCoverageLayer](https://developers.google.com/maps/documentation/javascript/reference#StreetViewCoverageLayer)

```
var map = new google.maps.Map(document.getElementById('map-canvas'), mapOptions);
var streetViewLayer = new google.maps.StreetViewCoverageLayer();
streetViewLayer.setMap(map); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-05T22:07:22.713

在 API v3 中，没有在地图上显示蓝色叠加层的图层。以下是可用层的完整列表：[https](https://developers.google.com/maps/documentation/javascript/layers) ://developers.google.com/maps/documentation/javascript/layers 。

目前，在 API 和官方地图网站上，蓝线实际上是显示在地图上的透明 PNG 瓦片 (256x256)。

有时它们无法正确对齐的原因是因为在某些国家/地区可以使用 Map Maker（协作地图编辑），并且人们弄乱了道路线，并且他们不会同时在所有 Google 服务中更新（对于街道查看可用性我什至认为它们根本不会更新）。

我能看到的唯一解决方法是熟悉谷歌地图（[https://developers.google.com/maps/documentation/javascript/maptypes#TileCoordinates](https://developers.google.com/maps/documentation/javascript/maptypes#TileCoordinates)）中使用的平铺坐标系统，它也用于蓝色覆盖，并创建一个使用它的新地图类型/图层。

平铺链接示例：[https](https://mts2.google.com/mapslt?lyrs=svv&x=75041&y=47444&z=17&w=256&h=256&hl=en&style=40,18) ://mts2.google.com/mapslt?lyrs=svv&x=75041&y=47444&z=17&w=256&h=256&hl=en&style=40,18 。

x 和 y 是平铺坐标，z 是缩放

这有点复杂，但如果你打算这样做，我可以提供一些额外的资源。

但请注意：API 条款未涵盖此解决方法。

# jquery - JQuery回调方法不一致

> ID：11783790
> 
> 赞同：3
> 
> 时间：2012-08-02T18:41:37.357
> 
> 标签：jquery, json

在这里，我试图从 REST API 数据中请求数据并使用 JQuery 呈现在网页中。

我正在发出 3 个不同的请求，响应时间大约为 200 毫秒、300 毫秒、7000 毫秒。这里从 3 个调用方法中调用了两个调用方法，我不明白为什么没有调用第 3 个。使用 Firebug 工具进行调试时，响应来自服务器。

当以下函数的顺序发生变化时，行为也会发生变化。正在调用一个或两个回调方法中的任何一个。

请帮我解决这个问题。

```
$.getJSON(
    "http://115.111.168.221:8080/AnalysisWebService/getDataFromSocialMedia?searchString=wellpoint&startDate=2012-08-01&endDate=2012-08-04&method=getAnalysisRange",
    function(json) {

        }

$(function () {
$.getJSON(
"http://115.111.168.221:8080/AnalysisWebService/getDataFromSocialMedia?searchString=wellpoint&source=facebook,twitter&searchFrom=socialmention&method=getTodayAnalysis",        

function(json) {

}
}
);
);

$(function () {
$.getJSON(
"http://115.111.168.221:8080/AnalysisWebService/getDataFromSocialMedia?searchString=wellpoint&source=facebook,twitter&searchFrom=socialmention&method=getCurrentAnalysis",      

function(json) {

}
}
);
); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-02T18:59:23.823

尝试这个：

```
var url = 'http://115.111.168.221:8080/AnalysisWebService/getDataFromSocialMedia?searchString=wellpoint';

$.getJSON(url + '&startDate=2012-08-01&endDate=2012-08-04&method=getAnalysisRange', function (json) {
    // do something
});

$.getJSON(url + '&source=facebook,twitter&searchFrom=socialmention&method=getTodayAnalysis', function (json) {
    // do something
});

$.getJSON(url + '&source=facebook,twitter&searchFrom=socialmention&method=getCurrentAnalysis', function (json) {
    // do something
}); 
```

您不需要将它们包装在其他任何东西中，因为 DOM 不必准备好就可以触发一些请求。

更好的是，为了提高可读性，请执行以下操作：

```
var url = 'http://115.111.168.221:8080/AnalysisWebService/getDataFromSocialMedia';

$.getJSON(url, {
    searchString: 'wellpoint',
    startDate: '2012-08-01',
    endDate: '2012-08-04',
    method: 'getAnalysisRange'
}).success(function(json) {
    console.log(json);
}).error(function() {
    console.log('error!');
});

$.getJSON(url, {
    searchString: 'wellpoint',
    source: 'facebook,twitter',
    searchFrom: 'socialmention',
    method: 'getTodayAnalysis'
}).success(function(json) {
    console.log(json);
}).error(function() {
    console.log('error!');
});

$.getJSON(url, {
    searchString: 'wellpoint',
    source: 'facebook,twitter',
    searchFrom: 'socialmention',
    method: 'getCurrentAnalysis'

}).success(function(json) {
    console.log(json);
}).error(function() {
    console.log('error!');
}); 
```

**编辑**：我也附加了错误处理程序，并删除了？从网址。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-02T18:45:07.040

您的语法似乎已关闭，括号和括号没有正确排列。如果您通过 Firebug 进行检查，您应该会在页面上收到错误消息。

**更新：** 我相信你的代码应该这样格式化：

```
$.getJSON(
    url,
    function(json) {

    }
)

$(function () {
    $.getJSON(
    url,      

        function(json) {

        }
    )
}
);

$(function () {
    $.getJSON(
        url,      

        function(json) {

        } 
    )
}
); 
```

此外，您应该考虑将重复的代码移动到一个函数中，并且只使用一个 document.ready 调用。这将使您的代码更健壮且更易于阅读。

# php - 在我刷新页面之前，我的网站上的某些内容不会显示

> ID：11783793
> 
> 赞同：-2
> 
> 时间：2012-08-02T18:41:42.550
> 
> 标签：php, wordpress

我有这个网站[http://www.taranmarlowjewelry.com/](http://www.taranmarlowjewelry.com/) ....当您第一次访问该网站时，请查看右上角....那里什么都没有，刷新页面并在右上角我的购物车出现了。

我的问题是为什么当我第一次访问我的网站时它没有出现在右上角，我将如何解决这个问题......在这里寻找正确方向的一步。

谢谢，J

我什至像这样手动将cookie放入主题的functions.php文件底部......

```
function set_new_cookie() {
    setcookie("PHPSESSID", '6a52e6037be6342014834c475b6c0637', time()+3600);  /* expire in 1 hour */

}
add_action( 'init', 'set_new_cookie'); 
```

它设置它，它没有显示任何错误，但它不能解决我的问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-02T18:47:56.833

这是因为显然必须设置一个 cookie 才能显示购物车。如果您在网站上禁用 cookie，您实际上可以阻止购物车出现。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-05T14:01:10.883

进入 wp-ecommerce/wpsc-includes/shopping_cart_functions.php 并调整这一行

```
if ( isset( $cart ) ) {
echo wpsc_shopping_basket_internals( $cart, false, true );
} 
```

对此

```
//if ( isset( $cart ) ) {
echo wpsc_shopping_basket_internals( $cart, false, true );
//} 
```

# java - 关于 Web Script Controller 类、Spring、AMP 和编译的问题

> ID：11783794
> 
> 赞同：0
> 
> 时间：2012-08-02T18:41:44.220
> 
> 标签：java, compilation, controller, alfresco, cas

所以我最近一直在尝试在 Oracle Linux 6 虚拟机上集成 CAS 和 Alfresco，但运气不佳。所以我一直在学习一些教程，目前正在尝试完成[这个](http://ecmstuff.blogspot.co.uk/2011/06/configuring-alfresco-for-sso-with-cas.html)。但是，在标题为“为 Alfresco Explorer 配置 CAS SSO”的部分下，我完全迷失了第 3-5 步。

* * *

3) 确保 org.mycompany.cms.authentication.LoginCas Web Script 控制器类中的 URL 正确：

```
public class LoginCas extends DeclarativeWebScript 
{
   private final static String CAS_WEBAPP_URL = "https://localhost:8443/cas-server-webapp-3.4.6";
   private final static String ALFRESCO_WEBAPP_URL = "http://localhost:8080/alfresco"; 
```

4) 在 Spring 上下文文件中配置 LoginCas web 脚本控制器：

需要从 Spring bean 配置加载和设置声明性 Web 脚本。如果要为此创建新的 AMP 文件，则将以下 Spring bean 配置添加到 module-context.xml：

```
<bean id="webscript.org.mycompany.authentication.logincas.get" class="org.mycompany.cms.authentication.LoginCas" parent="webscript">
   <property name="authenticationService" ref="authenticationService" />
   <property name="authenticationComponent" ref="authenticationComponent" />
</bean> 
```

5) 查找如何设置 AMP 构建项目并使用它将 Web 脚本控制器、身份验证过滤器、CAS 库和 Spring 上下文文件打包在一起

alfresco_war 包源代码中的以下两个类需要针对 Alfresco 3.4 SDK 和 CAS 库进行编译：

```
org.mycompany.cms.authentication.LoginCas
org.mycompany.cms.authentication.CasAuthenticationFilter 
```

要编译这些类，您需要 CAS 客户端库（例如 cas-client-core-3.1.12.jar），并且还需要将其打包在 AMP 中。

* * *

我想从第 3 步开始我的问题是，我在哪里可以找到这个“Web 脚本控制器类”？我是否需要在我的虚拟机上安装 IDE 来执行此操作/操作它？

我不知道第 4 步是什么意思。有人可以尝试以更简化的方式解释这一点吗？（顺便说一句，我使用 Spring 或 AMP 的经验为零）

对于第 5 步，虽然这听起来像是一个新手问题，但“alfresco_war 包源代码中的以下两个类需要针对 Alfresco 3.4 SDK 和 CAS 库进行编译”到底是什么意思？我在什么是编译的基本概念下，但是“被编译”是什么意思，我该如何去做呢？

感谢您提供的任何帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-06T13:19:25.327

看起来您正在学习配置 CAS，同时获得 Alfresco Java 支持的 Web 脚本的速成课程。在这一点上，通过 Web Script Framework 扩展 Alfresco 的教程对您很有帮助。关于这个主题有很多资源，这里有一些。

[露天维基](http://wiki.alfresco.com/wiki/Web_Scripts)

[官方文档](http://docs.alfresco.com/4.0/topic/com.alfresco.enterprise.doc/concepts/ws-architecture.html)

[Jeff Potts 的介绍白皮书](http://ecmarchitect.com/images/articles/alfresco-webscripts/web-script-article.pdf)

现在，回答您的问题：

3.) “控制器类”是指调用 Web 脚本时将运行的逻辑。由于这是一个 java 支持的 web 脚本，因此逻辑将在 Java Class(.java) 而不是标准的 JavaScript(.js) 文件中运行。当然，这里**不需要**IDE，但是创建一个 Eclipse 项目会很方便，您可以在其中导入 Alfresco SDK、CAS 所需的 jar 以及 Web 脚本的组件到一个位置（同样，使用 ant 将使构建和编译更简单）。

编辑：要回答“在哪里”问题，您的控制器脚本是[LoginCas.java](https://docs.google.com/leaf?id=0B1JEhRIvGU2gMzI2MzAyODktZWMwZi00MTYxLTk1ZjQtMjBlNGQyZDU1Y2Qx&hl=no)。

4.) 为了让 Alfresco 识别您的自定义代码，您需要向 Spring 提供一些信息。在引导期间，Alfresco 使用 Spring 根据 -context.xml 文件中该类的定义方式来加载您的类。[Alfresco 模块包](https://wiki.alfresco.com/wiki/AMP_Files)(AMP) 只是一种将自定义代码存储在一个简洁的小包中以进行部署的方法。Web 脚本框架严重依赖 Spring，因此如果您打算进行大量的 Alfresco 定制，我建议您也重新[学习这项技术。](http://www.springsource.org/tutorials)

5.) 还记得我在问题 3 中所说的关于包含所有必要组件的 eclipse 项目吗？第 5 步告诉您针对 3.4 SDK 和 CAS jar 编译控制器类，这意味着如果您在命令行中执行此操作，您将运行 javac，同时将 Alfresco SDK 和您的 CAS 组件中的所有库作为库参数传递那个电话。此处的最终目标是从您的 .java 控制器中获取已编译的 .class 文件。这使用 ANT 脚本更容易处理。

如果您下载[Alfresco SDK](http://wiki.alfresco.com/wiki/Alfresco_SDK)并将其导入 eclipse，您可以看到一些关于如何扩展 Alfresco 的示例。在浏览了一些文档之后，这将是一个很好的第二步。希望这会有所帮助，祝你好运！

# sql - sql复杂选择语句

> ID：11783795
> 
> 赞同：0
> 
> 时间：2012-08-02T18:41:44.887
> 
> 标签：sql, sql-server, oracle, indexing, constraints

我想在列上输入 fk 或索引，仅当此类约束不存在时。如果它存在，并且名称不是我想要的，只需重命名它，否则什么都不做。为此，我正在检查 SQL 服务器的 sys 表或 Oracle 的 all_... 表。

这是我尽可能简化的问题：

```
index_name              column_name
on_multiple_columns1    a
on_multiple_columns1    b

on_multiple_columns2    a
on_multiple_columns2    b
on_multiple_columns2    c

on_single_column1       b

on_single_column2       c 
```

现在我需要一个 select index_name into @constraintToRename 语句，所以我可以将@constraintToRename 重命名为“myName”，如果它存在并且还没有名称“myName”，或者如果它不存在则只创建一个新名称。我将提供有关该列和“myName”的信息，例如：

select index_name into @toRename from 'some_index_table' join 'some_other_index_table' where '索引仅在我现在输入的列上指定，因此不会返回多个列索引等等'

就我而言，我想在 b 列上输入带有 myName = test 的索引。当我只为 b 列选择名称时，我会得到 3 个索引（on_multiple_columns1、on_multiple_columns2 和正确的一个 on_single_column1），但我只需要 on_single_column1 以便我可以重命名它以进行测试。我该怎么做这个选择？就像是

```
select ... where column = 'my_column' and count(index_names) = 1 
```

或者

```
select .... where column = 'my_column' and index_name !corresponds to other columns :) 
```

如何在 SQL 中表达这一点？谢谢sss

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-03T10:39:08.213

受上面评论建议的启发，我现在正在使用这个：

```
select index_name from <table> where column_name='b' and index_name in 
(select index_name from <table> group by index_name having COUNT(index_name) = 1) 
```

这对我来说很好，谢谢

# ruby - ruby + selenium-webdriver actionbuilder

> ID：11783799
> 
> 赞同：2
> 
> 时间：2012-08-02T18:41:58.273
> 
> 标签：ruby, selenium, automation, selenium-webdriver

我似乎无法让 actionbuilder 在 selenium webdriver 中工作。我正在尝试自动化使用 Javascript 的菜单。我需要将鼠标悬停然后移动并单击鼠标悬停后出现的链接。

```
$driver.find_element(:id, "top_menu").find_elements(:tag_name, "a").each{ |a|
  if a.attribute('href').include? "javascript"
    then w = a 
    $driver.action.move_to(w).perform
    break
  end
} 
```

我意识到我对这个元素的追求有些模糊，并不是最佳实践。我已经要求为这个元素提供一个 id。任何关于如何使用 actionbuilder 或更好的方法来自动化鼠标移动的建议将不胜感激。

这是我得到的错误。
`generateErrorForNativeEvents'：无法执行本机交互：无法加载本机事件组件。(Selenium::WebDriver::Error::InvalidElementStateError

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-06T17:44:15.140

不是积极的，但我认为 Firefox 14.0.1 的更新可能已经破坏了它。我们的测试也失败了。我仍在努力修复。

更新：是的，我降级到 Firefox 13.0.1，我的测试现在正在运行。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-07-17T12:25:47.883

我遇到了 InvalidElementStateError 的相同问题：无法执行本机交互：当我尝试双击元素时无法加载本机事件组件

当我添加以下行时问题已解决

profile = Selenium::WebDriver::Firefox::Profile.new

profile.native_events = false

能力 = Selenium::WebDriver::Remote::Capabilities.firefox(:firefox_profile => profile)

@@driver = Selenium::WebDriver.for :firefox, :desired_capabilities => 能力

注意：- 一旦你这样做了，Firefox 测试现在将通过 Javascript 事件触发而不是原生点击来模拟用户交互。这有其优点和缺点。希望能帮助到你！

# jquery - 使用 jQuery 插入新创建的表格元素

> ID：11783800
> 
> 赞同：0
> 
> 时间：2012-08-02T18:41:59.603
> 
> 标签：jquery

我目前有将行插入表的工作代码。它看起来像这样：

```
<script type= "text/javascript">
$(document).ready(function() {
    var new_row = '<td><input type="text" value="Type question here" /></td><td><input type="button"class="add_next" value=" + " /><input type="button" class="move_up" value=" ^ " /><input type="button" class="move_down" value=" v " /><input type="button" class="remove" value=" x " /></td>';

    var q_num = 2; // question number

    $('.add_next').click(function() {

        console.log(this);

        console.log(($('<tr>')).insertAfter($(this).closest('tr'))
                    .attr('id', 'Q'+q_num)
                    .attr('name', 'Q'+q_num)
                    .append(new_row)

            );
        q_num++;

    });
});
</script> 
```

我的问题是变量 new_row 很难看。我想使用 $.append($(''))、.attr() 和其他 jQuery 函数即时创建这一行，但我还没有想出办法。我能想到的最好的是：

```
($('<tr>')).insertAfter($(this).closest('tr'))
                    .append($('<td>'))
                        .append('<input type="text" value="Type question here" />')
                    .append($('<td>'))
                        .append('<input type="button"class="add_next" value=" + " />')
                        .append('<input type="button" class="move_up" value=" ^ " />')
                        .append('<input type="button" class="move_down" value=" v " />')
                        .append('<input type="button" class="remove" value=" x " />'); 
```

如何使用 jQuery 而不是一个有效的 HTML 块来创建相同的条目？

提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-02T18:53:26.390

代替

```
.append('<input type="button"class="add_next" value=" + " />') 
```

你可以

```
.append($('<input />').attr({
    'class': 'add_next',
    'type': 'button',
    'value': ''
})); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-02T18:53:43.853

你可以这样做：

```
var new_row = $('<tr/>',{'id':'Q'+q_num,'name':'Q'+q_num}).append(
    $('<td/>').append(
        $('<input/>',{'type':'text','value':'Type question here'})
    ),
    $('<td/>').append(
        $('<input/>',{'type':'button','value':' + ','class':'add_next'}),
        $('<input/>',{'type':'button','value':' ^ ','class':'move_up'}),
        $('<input/>',{'type':'button','value':' v ','class':'move_down'}),
        $('<input/>',{'type':'button','value':' x ','class':'remove'})
    ),
); 
```

然后将您的插入代码更改为：

```
$(this).closest('tr').after(new_row); 
```

# php - 拉丁字符渲染 PHP MySQL

> ID：11783811
> 
> 赞同：0
> 
> 时间：2012-08-02T18:42:34.803
> 
> 标签：php, mysql, character-encoding

我有一个 mysql 表，它有一个字段，其中数据包含拉丁描述和一些拉丁字符，如下所示

```
BBVA Bancomer   0445574935<br\/>Banamex   19582 Sucursal 4346<br><br\/><br\/>Ambas cuentas a nombre de Shaklee M\u00e9xico, S. de RL. de CV.<br\/><br\/>Para adjuntar su ficha de pago y\/o formas de registro de clic aqu\u00ed <a href=\"index.php?option=com_fabrik&view=form&formid=8\">REPORTA AQU\u00cd TU PAGO Y\/O FORMA DE REGISTRO<\/a> 
```

我需要通过电子邮件发送此描述，但我选择使用 mysql 查询它与上面相同，我需要呈现如下所示的 lathin 字符

```
BBVA Bancomer 0445574935
Banamex 19582 Sucursal 4346

Ambas cuentas a nombre de Shaklee México, S. de RL. de CV.

Para adjuntar su ficha de pago y/o formas de registro de clic aquí REPORTA AQUÍ TU PAGO Y/O FORMA DE REGISTRO 
```

Ex - M\u00e9xico = México 请让我知道是否有任何 PHP 解决方案可以将此类文本呈现为拉丁文，谢谢

# git - git checkout 另一个分支

> ID：11783813
> 
> 赞同：28
> 
> 时间：2012-08-02T18:42:42.317
> 
> 标签：git, branch, git-checkout

我跑：

```
 git checkout mygithub/master 
```

但由于某种原因，运行“git status”显示“当前不在任何分支上”。跑步：

```
 git checkout master 
```

然后`git status`，说我现在在分支大师。现在我想切换到另一个分支。运行`git checkout anotherbranch`有效，但`git status`说我仍在分支'master'上。我究竟做错了什么？

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2012-08-02T18:48:16.250

`mygithub/master`是一个远程分支。要基于该远程分支创建本地分支，您必须使用`git checkout -b mymaster mygithub/master`. Git 试图让这件事变得简单：如果你写`git checkout branchname`, 并且 branchname 只存在于远程而不是本地，Git 将自动设置一个本地分支`<remote>/branchname`作为其父分支。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2015-07-24T06:27:46.330

如果要切换到另一个分支，请运行以下命令：

```
git checkout branch name 
```

如果要删除分支，请运行以下命令：

```
git branch -D branch name 
```

如果要创建新分支，请运行以下命令：

```
git checkout -b branch 
```

* * *

## 回答 #3

> 赞同：-6
> 
> 时间：2018-10-06T13:33:41.007

如果您想从 master 分支结帐，只需在终端中运行此命令

`git checkout -b BRANCH_NAME`

# regex - 使用正则表达式从文件中提取行，后跟短语

> ID：11783818
> 
> 赞同：2
> 
> 时间：2012-08-02T18:43:00.210
> 
> 标签：regex, command-line, grep

我有一个我正在为一个客户端开发的应用程序，它保留了最后一个 cron 的日志文件，用于发送的提醒电子邮件，并在它的日志中：

```
***************** 

app ID: 123 / app status: 0 / deposit paid: 0 /  email@domain.com 

date created: 2009-03-14 00:00:00
last updated: 1969-12-31 06:00:00pm
USING for date comparison: 2009-03-14 12:00:00am

EXPIRE THIS APP 
```

我试图弄清楚如何抓住`app ID: 123 / app status: 0 / deposit paid: 0 / email@domain.com`它后面的线，`EXPIRE THIS APP`因为并非所有人都会拥有它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-02T18:50:36.877

您需要注意您的正则表达式不要太松散，否则贪婪匹配会给出错误匹配。这是一个好的开始：

```
/(app ID: .+?)\n\ndate created: .+?\nlast updated: .+?\nUSING for date comparison: .+?\n\nEXPIRE THIS APP/ 
```

# javascript - d3.js 动画径向图示例

> ID：11783819
> 
> 赞同：0
> 
> 时间：2012-08-02T18:43:01.470
> 
> 标签：javascript, charts, d3.js, demo

有没有人有一个动画的 d3.js 径向图表的例子？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-02T19:10:29.730

这是我正在寻找的那种图表：[http ://www.larsko.org/v/euc/](http://www.larsko.org/v/euc/)

# python - 不能让python在for循环中做简单的增量

> ID：11783820
> 
> 赞同：0
> 
> 时间：2012-08-02T18:43:09.093
> 
> 标签：python, for-loop, increment

我刚开始使用 Python（我有大量的 VBA），所以我正在玩一些简单的语法。

我已经编写了这个简单的 for 循环，但输出似乎错误。我无法让变量“c”增加。

这是我的代码：

```
class Card:
    def county(self):
        for n in range(0,13):
            c = 0
            c = c + 1
            print c
    pick_card = Card()
    print pick_card.county() 
```

并且输出只是打印了 13 次“1”，然后是“无”

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-02T18:44:10.360

每次循环时，您都设置`c`为`0`，然后添加`1`，使其变为 1。

此外，您的最后一行是打印函数的返回值，该函数不返回任何内容（因此为“无”）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-02T18:45:15.313

您首先将其分配为 0，然后将其增加 1。因此它始终为 1。尝试使用以下命令：

```
class Card:
    def county(self):
        c = 0
        for n in range(0,13):
            c += 1
            print c
    pick_card = Card()
    print pick_card.county() 
```

# c# - 在调试模式下从 C# 中的方法返回 DataTable 时出现 AccessViolationException

> ID：11783821
> 
> 赞同：1
> 
> 时间：2012-08-02T18:43:16.713
> 
> 标签：c#, .net, mstest

我有一个测试方法，它建立一个具有特定模式的 DataTable 以在测试期间使用。如果我内联构建 DataTable 的代码，那么测试在调试模式下运行就好了。如果我将它封装在一个函数中，它会在调试模式下运行测试时抛出一个 AccessViolationException。在发布模式下运行时，它成功而没有问题。我已经包含了下面的代码。我尝试设置一些编译器开关和测试环境设置，认为它们是原因，但它们没有效果。我正在使用 MSTest 和 VS 2012 RC。测试项目是 .NET 4.5

```
[TestMethod]
        public void PkColumnSortedToTopWhenColumnMappingIsExisting()
        {
            // arrange
            var sourceMart = new TableMap();
            //var schema = new DataTable();

            var schema = GetDataBaseSchemaTable();

            schema.Rows.Add("Column1", 1, 2, 3, 4, true, /* isKey: */ false, true, "BaseColumn1", "BaseTable1", typeof(int), 24, true, false,
                                        false, false, false);
            schema.Rows.Add("Column2", 1, 2, 3, 4, true, /* isKey: */ false, true, "BaseColumn2", "BaseTable1", typeof(int), 24, true, false,
                                        false, false, false);
            var columnMapping1 = new ColumnMapping(schema.Rows[0], DatabaseType.MicrosoftSql);
            var columnMapping2 = new ColumnMapping(schema.Rows[1], DatabaseType.MicrosoftSql);
            sourceMart.Mappings.Add(columnMapping1);
            sourceMart.Mappings.Add(columnMapping2);
            var viewModel = new MappingViewModel(sourceMart);

            // Navigate to next page (first time building mappings)
            viewModel.Activate();

            // Set second column to be a PK
            sourceMart.Mappings.First(m => m.SourceColumnName == "Column2").IsDestinationColumnPartOfPrimaryKey = true;

            //Reactivate which simulates as if we navigated away and back which should resort it
            viewModel.Activate();

            // assert
            Assert.IsTrue(viewModel.ColumnMappingVMs.First().ColumnMapping.IsDestinationColumnPartOfPrimaryKey);
        }

        public DataTable GetDataBaseSchemaTable()
        {
            var schemaTable = new DataTable();
            schemaTable.Columns.Add(new DataColumn("ColumnName", typeof(string)));
            schemaTable.Columns.Add(new DataColumn("ColumnOrdinal", typeof(int)));
            schemaTable.Columns.Add(new DataColumn("ColumnSize", typeof(int)));
            schemaTable.Columns.Add(new DataColumn("SourceNumericPrecision", typeof(short)));
            schemaTable.Columns.Add(new DataColumn("SourceNumericScale", typeof(short)));
            schemaTable.Columns.Add(new DataColumn("IsUnique", typeof(bool)));
            schemaTable.Columns.Add(new DataColumn("IsKey", typeof(bool)));
            schemaTable.Columns.Add(new DataColumn("IsRowID", typeof(bool)));
            schemaTable.Columns.Add(new DataColumn("BaseColumnName", typeof(string)));
            schemaTable.Columns.Add(new DataColumn("BaseTableName", typeof(string)));
            schemaTable.Columns.Add(new DataColumn("DataType", typeof(Type)));
            schemaTable.Columns.Add(new DataColumn("ProviderType", typeof(int)));
            schemaTable.Columns.Add(new DataColumn("AllowDBNull", typeof(bool)));
            schemaTable.Columns.Add(new DataColumn("IsAliased", typeof(bool)));
            schemaTable.Columns.Add(new DataColumn("IsExpression", typeof(bool)));
            schemaTable.Columns.Add(new DataColumn("IsHidden", typeof(bool)));
            schemaTable.Columns.Add(new DataColumn("IsReadOnly", typeof(bool)));
            schemaTable.Columns.Add(new DataColumn("IsLong", typeof(bool)));

            return schemaTable;
        } 
```

# ruby-on-rails-3 - ActiveRecord::RecordNotFound: 找不到 id= 的用户

> ID：11783825
> 
> 赞同：1
> 
> 时间：2012-08-02T18:43:34.327
> 
> 标签：ruby-on-rails-3, testing, rspec, rspec-rails

我正在使用 rspec 测试我的应用程序，我读到我必须在测试环境中创建一个用户，但不知道如何......这是代码：

```
require 'spec_helper'

    describe CarsController do
    describe "GET 'new'" do
            it "should be successful" do
            visit new_user_car_path(:user_id=>"28")#also try (current_user) but nothing
            response.should be_success
            end
        end
    end 
```

当我运行它时，我收到了这条消息

```
Failure/Error: visit new_user_car_path(:user_id=>"28")
 ActiveRecord::RecordNotFound:
   Couldn't find User with id=28
 # ./app/controllers/cars_controller.rb:3:in `new'
 # ./spec/controllers/tanking_logs_controller_spec.rb:6:in `block (3 levels) in <top (required)>' 
```

如果您需要更多代码，请告诉我

编辑。我试过这个

```
require 'spec_helper'

describe CarsController do
describe "GET 'new'" do
    it "should be successful" do
        #user = User.create(...)
        @user = {:email => "user@example.com", :password => "foobar", :password_confirmation => "foobar" }
        visit new_user_car_path(@user) 
        response.should be_success
    end
end
end 
```

我现在得到了这个错误：

```
 No route matches {:action=>"new", :controller=>"cars", :email=>"user@example.com", :password=>"foobar", :password_confirmation=>"foobar"} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-02T18:45:27.043

您的测试数据库中没有 ID 为 28 的用户。您需要为您的测试数据库播种并使用您知道存在的用户的 ID。

或者，按需创建一个新用户：

```
describe "GET 'new'" do
  it "should be successful" do
    user = User.create(...)
    visit new_user_car_path(user)#also try (current_user) but nothing
    response.should be_success
  end
end 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-02T19:08:24.003

这可能会让您启动并运行，但绝不是运行测试的好方法。

因此，如果您的开发数据库中有一个 id = 28 的用户，您可以告诉 Rspec 对这个数据库而不是默认的测试数据库运行测试。

在你的 spec_helper.rb 替换这个

```
ENV["RAILS_ENV"] ||= 'test' 
```

和

```
ENV["RAILS_ENV"] ||= 'development' 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-02T18:48:06.590

现在您的规格已更改，您会收到路由错误。

正在发生的事情是 rails 试图在 cars#new 中创建一辆新车（这意味着`cars_controller`和`new`行动，但你没有那条路线。

跑去`rake routes`看看你有什么路线并发布。

# c# - 什么是最先进的自动更新技术？

> ID：11783829
> 
> 赞同：2
> 
> 时间：2012-08-02T18:43:50.100
> 
> 标签：c#, .net, visual-studio-2010, dll

我遇到了这个[线程](https://stackoverflow.com/questions/691663/auto-update-library-for-net)，但它已经超过 2 年了。我正在构建一个带有 DLL 文件和一堆资源文件的小型库。我希望客户端在我的服务器上更改时获得这些文件的更新版本。我将如何实现这一目标？

有两种选择：

*   [应用更新程序](http://autoupdaterdotnet.codeplex.com/)
*   [点击一次](http://msdn.microsoft.com/en-us/library/t71a733d%28v=vs.80%29.aspx)

但我很想知道这方面最近是否有任何进展。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-02T19:32:08.707

如果客户是另一个使用您的 dll 的开发人员，NuGet 非常好

[http://nuget.codeplex.com/](http://nuget.codeplex.com/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-02T19:39:36.323

虽然我还没有尝试过，但[NetSparkle](http://netsparkle.codeplex.com/)可能也值得一试。您可能会发现[这个相关问题](https://stackoverflow.com/questions/691663/auto-update-library-for-net)很有用。

# html - 为什么文本在 Internet Explorer 中不可见

> ID：11783830
> 
> 赞同：0
> 
> 时间：2012-08-02T18:43:58.607
> 
> 标签：html, css

我使用了一个非常酷的模板，创建者非常好，可以免费使用。但是我在 IE 8 中遇到了一些问题 - 文本不可见。我试图改变css，看看如果我拿出一件东西会发生什么，但我没有得到任何地方......有经验的人可以告诉我哪个属性正在搞砸吗？我试图修复它 3 个小时，但没有得到任何地方。您可以在此处查看该网站：http: [//luiszuno.com/themes/watercolor/spring/](http://luiszuno.com/themes/watercolor/spring/)

菜单或任何文本在 IE 中不可见...

如果可以的话，我会为您指出一个特定的代码块，但我无法隔离它.. 谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-02T18:54:26.990

```
<meta content="IE=8" http-equiv="X-UA-Compatible" /> 
```

在头部添加它，看看会发生什么

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-02T18:54:53.037

该网站正在使用 Cufon 来呈现那些未显示的文本。一般来说，我在 IE9 中遇到了 Cufon 的问题。实际上，我在该网站上看到了 IE8 中的文本，但没有看到 IE9。

尝试在您的页面中添加以下内容以查看是否可以修复它：

```
<!--[if gte IE 9]> <script type="text/javascript"> Cufon.set('engine', 'canvas'); </script> <![endif]--> 
```

另外这里有一些关于 IE9 和 Cufon 的信息：

[http://blog.ninanet.com/2011/04/29/cufon-and-ie9](http://blog.ninanet.com/2011/04/29/cufon-and-ie9)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-02T18:56:34.590

您的所有导航项都在`<canvas>`标签中，IE 8 及更早版本不支持

# dynamics-crm-2011 - 配置 CRM 2011 WIF Coo kie 的域和路径？

> ID：11783833
> 
> 赞同：1
> 
> 时间：2012-08-02T18:44:03.790
> 
> 标签：dynamics-crm-2011, wif, adfs2.0

我们有一个在 CRM javascript 中使用的外部 Web API。它托管在与 CRM 相同的域（不同的端口）上。我需要 WebApi 来验证 IFD 用户，最简单的方法似乎是为 WIF cookie 设置域，以便它们在 CRM 和我们的自定义站点之间共享。

我可以在我们的 ASP.Net 应用程序中通过 WIF 配置设置 cookie 属性。我怎样才能为 CRM 做同样的事情？

# mysql - 复杂的mysql插入

> ID：11783836
> 
> 赞同：5
> 
> 时间：2012-08-02T18:44:05.567
> 
> 标签：mysql

我在编写一个查询时遇到问题。例如，我有字段 id 和 name 的表，看起来像

```
ID | Name
---+------
1  | John 
2  | Ben
3  | Bob 
```

第二个带有字段名称和某个字段的表。我需要使用第一个表中的数据填充此表，因此它看起来像

```
name | somefield
-----+-----------
John | blah=1
Ben  | blah=2
Bob  | blah=3 
```

因此，名称的值是来自第一个表的名称，而某个字段的值是一些短语，例如来自第一个表的 blah=+id 值。这可能只用 mysql 吗？我尝试使用循环和 wp wpdb 类来做到这一点，但 wpdb 在每 30 行之后不断抛出一些 malloc（我认为）错误

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-02T18:47:44.017

```
INSERT INTO table2 SELECT Name,CONCAT('blah=',ID) FROM table1; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-02T18:49:05.407

```
insert into second_table select Name, concat('blah=', ID) from first_table; 
```

警告：此操作将在操作期间锁定`first_table`。MySQL 需要这样做以保证复制期间的一致性。这对于一次性数据填充可能是可以接受的，但可能不建议在高流量生产系统上定期运行它。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-02T18:51:49.447

这应该不会太难。您不需要循环，只需使用一条`INSERT SELECT`语句：

```
INSERT INTO table2(name, somefield)
SELECT name, CONCAT('blah=', id')
FROM table1 
```

# macos - XCode 4 中 OpenCV FileStorage 的问题

> ID：11783839
> 
> 赞同：2
> 
> 时间：2012-08-02T18:44:08.930
> 
> 标签：macos, opencv, xcode4

几个星期以来，我一直在为这个问题而烦恼，但我无法弄清楚。输入用于 cv::FileStorage 的示例代码：

```
FileStorage fs("test.yml", FileStorage::WRITE);
Mat cameraMatrix = (Mat_<double>(3,3) << 1000, 0, 320, 0, 1000, 240, 0, 0, 1);
fs << "cameraMatrix" << cameraMatrix;
fs.release(); 
```

在 Visual Studio 中生成文件*test.yml*就好了。但是，使用最新版本的 OpenCV(2.4.1) 重现 XCode4 中的代码似乎不会输出任何文件。它运行得很好。关于为什么会这样的任何想法都会很棒。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-03T16:40:17.910

我试过你的代码，它工作正常。您可能只是在错误的地方寻找 test.yml。它不会与您的源代码位于同一文件夹中。它位于派生数据路径下的可执行文件所在的文件夹中。默认情况下，这是`~/Library/Developer/Xcode/DerivedData`. 从那里，查找带有您的项目名称的文件夹。在此之下，查找`build/Products/Debug`或`build/Products/Release`找到您的可执行文件（以及您的 test.yml 文件）。

如果需要，您可以通过转到 Xcode Preferences -> Location 来更改派生数据文件夹。

# php - 获取 href 的 Xpath 表达式。不仅仅是锚文本

> ID：11783849
> 
> 赞同：2
> 
> 时间：2012-08-02T18:44:43.527
> 
> 标签：php, xpath

玩弄 xpath 表达式试图学习它。我找到了一个代码片段，并对其进行了一些调整。我想要做的是获取页面上的每个链接。

```
$baseurl = "http://www.example.com";
$html = file_get_contents($baseurl);

$dom = new DOMDocument();
@$dom->loadHTML($html);
$xpath = new DOMXPath($dom);

$ahrefs = $xpath->query('//a');

foreach ($ahrefs as $ahref) { 
    echo $ahref->childNodes->item(0)->nodeValue . "<br />";
} 
```

但现在我正在抓取锚文本。我想要那个`href`部分。甚至可能两者兼而有之。我究竟做错了什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-03T04:34:45.303

**使用**：

```
//a/@href 
```

不需要额外的代码（除了评估这个表达式）。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-02T18:54:39.990

要获取 href，您必须访问节点的[attributes属性](http://www.php.net/manual/en/class.domnode.php#domnode.props.attributes)

```
echo $ahref->attributes->getNamedItem("href")->nodeValue . "<br />"; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-02T18:57:40.903

```
echo $ahref->getAttribute('href') . "<br />"; 
```

# php - PHPSpec 和覆盖率报告

> ID：11783854
> 
> 赞同：14
> 
> 时间：2012-08-02T18:45:03.753
> 
> 标签：php, continuous-integration, jenkins, code-coverage, phpspec

有谁知道从 PHPSpec 测试生成覆盖率报告的方法？

我考虑过 xdebug，但据我所知，它无法为 jenkins 生成报告。

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2012-08-03T10:31:01.110

就目前而言（1.4.0），它还不支持代码覆盖率。很高兴听到您对此的反馈。以下是我对代码覆盖率的看法。

PHPSpec 是一个 BDD 框架。如果你在做 BDD，你会在编写你的类之前描述你的类的行为。如果你这样做，你的类的相关行为都将被“测试”正确覆盖。

代码覆盖率工具和指标对于遗留代码（您编写的代码没有规范/测试）很有用。您可以使用这样的工具来尝试达到可以继续 TDD 并获得免受回归保护的好处的程度。

一般来说，这种方法并不*像*首先描述行为 (TDD) 那样有效。一种方法可能足够简单，可以响应多个所需的行为。您知道，当您进行 TDD 时，您会在过程中不断进行重构，删除不需要的代码。你最终会得到 10 个规范（测试），它们都在相同的代码行中，都描述了不同的所需行为，所有这些都有助于理解代码。

“测试”一词的问题之一是它使人们认为 TDD 是关于验证的。它不是。这是关于沟通。StoryBDD 是利益相关者之间的通信，而 SpecBDD 是类之间的通信。简单，生动，足够的文档。

为保证您已经测试过代码而进行的代码覆盖是一种谬误，充其量是一个糟糕的指标。不幸的是，人们认为测试结构比测试行为更重要。这就是为什么 BDD 应运而生，以帮助将焦点重新回到正确的轨道上。确保这部分代码经过测试是假的，因为这部分代码可以做不止一件事，如果它被很好地重构的话，它应该做的。此外，您最终将测试访问器、修饰符和构造函数等内容。

但我愿意听取社区的意见。我可以看到代码覆盖率在哪里有用。另外，由于 Sebastian Bergmann 很好地将它从 PHPUnit 中模块化，我可以在 PHPSpec 中重用它。我希望你先写你的规格。您可以免费获得 100% 的相关行为代码覆盖率。在我看来，这才是最重要的。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2014-05-26T19:06:30.947

使用[PHPSpec 的代码覆盖率扩展](https://github.com/henrikbjorn/PhpSpecCodeCoverageExtension)来生成三叶草。

如果您想合并来自 PHPSpec 和其他工具（例如）PHPUnit 的覆盖率数据，请在合并模式下使用 PHP_CodeCoverage 输出格式和[phpcov工具。](https://github.com/sebastianbergmann/phpcov)

例子：

```
# phpspec.yml
extensions:
    - PhpSpec\Extension\CodeCoverageExtension

code_coverage:
    output: /tmp/coverage/phpspec.phpcoverage
    format: php

# phpunit.xml
<logging>
   <log type="coverage-php" target="/tmp/coverage/phpunit.phpcoverage" />
</logging>

# from the command line
phpcov merge --clover coverage.xml /tmp/coverage 
```

这将以最终的三叶草格式为您提供两种工具的覆盖范围，适合[Jenkins 之](https://wiki.jenkins-ci.org/display/JENKINS/Clover+PHP+Plugin)类的。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-08-06T22:58:12.897

我认为代码覆盖生成器对于正在进行 BDD 样式测试的遗留系统很有用，因为您将能够分辨出哪些代码没有经过测试。我会欣赏 PHPSpec 中的这样一个特性。

# windows - 通过 IOCTL 将结构传递给内核模式驱动程序

> ID：11783859
> 
> 赞同：0
> 
> 时间：2012-08-02T18:45:30.383
> 
> 标签：windows, driver, ioctl

我正在尝试将几个不同的信息从 Windows 中的用户模式应用程序传递给内核模式驱动程序。我不会假装完全知道我在做什么，所以如果我有任何基本的误解，我将不胜感激。

用户模式应用程序（将 IOCTL 发送给驱动程序）：

```
typedef struct {
    unsigned int write;
    ULONG reg_addr;
    ULONG reg_val;
} reg_parameters;

...

reg_parameters regvals;
regvals.write = 0;
regvals.reg_addr = 0xDEADBEEF;
regvals.reg_val = 0XBBBBBBBB;
ULONG value;

...

DeviceIoControl(driver,(ULONG)IOCTL_OMAPCONF_REG, &regvals, sizeof(regvals),
                     &value, sizeof(ULONG), &size, NULL); 
```

内核模式驱动程序（在 reg_addr 读取内存并将值存储在 reg_val 指定的位置）：

```
NTSTATUS OmapConfDrvDispatch(IN PDEVICE_OBJECT DeviceObject,
                    IN PIRP           Irp)
{
    PVOID               ioBuffer;

    ....

    ioBuffer  = Irp->AssociatedIrp.SystemBuffer;

    .... 
```

现在，问题是：如何从`ioBuffer`驱动程序中访问各个结构成员？

例如，为什么不那么简单`ioBuffer.reg_addr`？

想法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-02T18:59:21.823

将 转换`Irp->AssociatedIrp.SystemBuffer`为`reg_parameters`指针：

```
reg_parameters* regvals = (reg_parameters*)Irp->AssociatedIrp.SystemBuffer;
if (regvals->reg_addr == 0xDEADBEEF) {
   // mmmm - beef
} 
```

这假定您已`reg_parameters`在驱动程序代码中定义。

# perl - perl 变量名中的变量替换

> ID：11783861
> 
> 赞同：7
> 
> 时间：2012-08-02T18:45:43.243
> 
> 标签：perl

```
#!/usr/bin/perl
my $var_a;
$sub_a = "a";
$var_a = "a";
print ${var_."$sub_a"},"\n";

$sub_b = "b";
$var_b = "b";
print ${var_."$sub_b"},"\n";

__DATA__

b 
```

为什么打印的是b，而不是a？这对我来说似乎是非常意外的行为。

我正在尝试使用具有替换名称的变量。在实践中，我不能不声明变量，因为赋值是在 forloop 中完成的，因此具有不同的词法范围。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-08-02T19:00:26.483

请注意，这与您使用变量来包含其他变量的名称这一事实无关。

这不起作用的原因是因为`${"var_a"}`构造实际上是指包级别的变量`$main::var_a`。

由于`$var_a`被声明为词法变量，因此它是一个不同的标识符，因此`${"var_a"}`是 undef。

您可以看到，如果您更改`my $var_a`为`our $var_a`

```
our $var_a="a";
my $var_b="b";
$var_c="c";

print ${"var_a"},"\n";
print ${"var_b"},"\n";
print ${"var_c"},"\n";

######## RESULTS:
a

c 
```

正如其他人所指出的那样，虽然有一个很好的解释来解释为什么您尝试做的事情不起作用，但您正在做的事情可能是错误的方法。除非没有更好的方法，否则您几乎不应该使用这种方法；没有您的问题，目前尚不清楚更好的方法是什么，但很可能是像 TLP 的答案所说的哈希。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-02T18:56:18.210

如果你想要一个符号引用，你想使用一个哈希。

```
my %user_vars = (var_a => 'what ever');
my $sub_a = 'a';
print $user_vars{"var_$sub_a"};

Output: 'what ever' 
```

不要为此目的使用符号引用，因为它们在您的问题的上下文中是不必要的并且可能非常有害*。*有关更多信息，请参阅[为什么“使用变量作为变量名”很愚蠢？](http://perl.plover.com/varvarname.html). 几乎总是有更好的方法来做到这一点，一种方法是制作`sub_a`和`var_a`数组，其中`sub_a`. `var_a`最好在不使用散列时始终锁定散列以防止[注入攻击](https://www.golemtechnologies.com/articles/shell-injection#how-to-perform-command-injection)，例如：

```
use strict;
use warnings;
use Hash::Util qw(lock_hash unlock_hash);

my @sub_a;
my %var_a;
lock_hash(%var_a);

@sub_a = qw(a b c);          # the keys

unlock_hash(%var_a);
%var_a = (a => 'Value for a', b => 'Value for b', c => 'Value for c');
lock_hash(%var_a);

print $var_a{$sub_a[0]};     # 'Value for a'
print $var_a{'banana'};      # Fatal error when accessing data for banana. 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-02T18:57:49.517

使用字符串作为引用违反了`strict`您应该始终使用的编译指示。如果您想正确执行，最好使用哈希：

```
use strict;
use warnings;

my %hash;

$hash{"var_a"} = "a";
print $hash{"var_a"},"\n"; 
```

# jquery - 如何在 Rails 3 中提交_to_remote

> ID：11783863
> 
> 赞同：1
> 
> 时间：2012-08-02T18:45:53.873
> 
> 标签：jquery, ruby-on-rails, ruby-on-rails-3, form-for

我们曾经在我们的 Rails 2.3.5 应用程序中有一个表单，如下所示，它运行良好

```
<% form_for @quote do |f| -%>
    <%= f.text_field :length %>
    <%= f.text_field :tax, :readonly => true %>
    <%= submit_to_remote 'commit', 'Calculate', :url => { :action => 'create' } %>
    <%= submit_tag 'Submit' %>  
<% end %> 
```

基本上，“计算”按钮会将表单作为 XMLHttpRequest 请求提交，而“提交”按钮将执行简单的 POST。是否可以在 Rails 3 应用程序中执行此操作？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-02T18:48:42.253

添加`:remote => true`到您的`form_for`选项以生成带有 的表单`data-remote="true"`，Rail 的[Unobtrusive JavaScript](http://api.rubyonrails.org/classes/ActionView/Helpers/FormHelper.html#method-i-form_for-label-Unobtrusive+JavaScript)将通过 AJAX 提交该表单。

```
<% form_for @quote, :remote => true do |f| %>
    <%= f.text_field :length %>
    <%= f.text_field :tax, :readonly => true %>
    <%= submit_tag 'Submit' %>  
<% end %> 
```

如果 JavaScript 可用，表单将通过 AJAX 提交，否则回退到常规表单回发。

# asp.net-mvc - 如何从列表中的另一个实体获取一个实体

> ID：11783869
> 
> 赞同：0
> 
> 时间：2012-08-02T18:46:29.713
> 
> 标签：asp.net-mvc, vb.net, asp.net-mvc-3, entity-framework

我正在尝试获取在其个人资料中具有博客 ID 的用户的用户名。

此代码返回所有博客并将其放入列表中：

```
 Dim blogs = db.Blogs.Include(Function(b) b.Company)
        Return View(blogs.ToList()) 
```

我想在列表中包含博客所属的用户名。该数据保存在配置文件实体中（在名为“BlogId”的字段中）。

这是配置文件实体：

```
Imports System.Data.Entity
Imports System.ComponentModel.DataAnnotations

Public Class UserProfile

    Public Property UserProfileId() As Integer
    Public Property UserId() As Guid
    Public Property CompanyId() As Integer
    Public Property BlogId() As Integer
    Public Property IsCompanyOwner As Boolean
    Public Property IsBlogOwner As Boolean

End Class

Public Class UserProfileDbContext

    Inherits DbContext
    Public Property UserProfiles As DbSet(Of UserProfile)
End Class 
```

如何将用户名放入 ToList() 以在我的视图中显示？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-02T21:24:48.900

如果您指的是会员资格的用户，在这种情况下，请使用您的 UserId 指南调用：

```
var user = Membership.GetUser(userId) 
```

然后您可以将名称引用为

```
user.UserName 
```

因此，理想情况下，您需要创建一个新的 ViewModel 类，该类只包含您要发送到视图的数据，而没有其他内容。在这种情况下，加载您的 UserProfile 条目后，您需要枚举每个条目并调用 GetUser() 并使用该结果填充每个 ViewModel 条目。

```
 Public Class UserProfileViewModel

    Public Property UserProfileId() As Integer
    Public Property UserId() As Guid
    Public Property CompanyId() As Integer
    Public Property BlogId() As Integer
    Public Property IsCompanyOwner As Boolean
    Public Property IsBlogOwner As Boolean
    **Public Property UserName as String**

End Class 
```

# python - Tkinter GUI Python 背景颜色

> ID：11783870
> 
> 赞同：2
> 
> 时间：2012-08-02T18:46:31.107
> 
> 标签：python, user-interface, button, tkinter

我正在编写一个带有按钮、图形、滑块等的 Tkinter 应用程序，但我无法让它们的背景颜色统一。

```
import Tkinter
from Tkinter import *
root = Tk()
root.title('Button')
root.configure(bg='gray')

Button(text='Button', bg='gray').pack(side=BOTTOM)
root.mainloop() 
```

如果运行这段代码，主窗口的背景确实是灰色的，但是按钮的图像周围有一个白色区域。有没有办法来解决这个问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-02T19:42:38.517

如果问题是您不喜欢系统上的默认按钮效果，则不必更改边框宽度；相反，您可以`relief='flat'`在按钮声明中进行设置。这样，当您单击按钮时，您仍然会看到“下沉”的外观，如果您只是设置`borderwidth`为 0 或接近它的值，您将不会看到这种外观。减小的另一个问题`borderwidth`是它可能使按钮比预期的要小。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-02T19:40:10.283

扩展 mgilson 的评论，我尝试使用borderwidth=.001，据我所知，它“有效地”删除了按钮上的边框。希望这可以帮助！

```
import Tkinter
from Tkinter import *
root =Tk()
root.title('Button')
root.configure(bg='gray')

Button(text='Button',bg='gray',borderwidth=.001).pack(side=BOTTOM)
root.mainloop() 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-02T22:33:42.470

您所看到的听起来像是`highlightthickness`设置为非零值（这是默认值）的结果。您可以尝试将其设置为零，或设置`highlightbackground`为您的背景颜色。

# python - ImportError：没有名为 abc 的模块

> ID：11783871
> 
> 赞同：3
> 
> 时间：2012-08-02T18:46:34.477
> 
> 标签：python, import

我在 python26 文件夹中创建了一个名为 abc 的类。我试图通过另一个文件引用它

```
def FileRW():
   import re
   import os
   import abc 
```

我收到错误 Traceback（最近一次调用最后一次）：文件“”，第 1 行，在 FileRW() 文件“C:\Python26\pyFileIOprog”，第 4 行，在 FileRW import ChangeList ImportError: No module named abc

谁能告诉我我哪里出错了。我已将环境变量“路径”设置为 C:\python26

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-02T23:37:08.947

`abc`是随 Python 分发的标准库模块的名称，因此我强烈建议您将名称更改为唯一的名称。

假设您已经这样做了，您可以将模块的文件放在与导入它的脚本相同的目录中，然后就会找到它。如果要将其放在其他位置，可以将其位置的路径附加到`sys.path`变量中。这是一个例子：

```
import sys
sys.path.append('path/to/my/module')
# on Windows append something like 'C:\\path\\to\\my\\module' or r'C:\path\to\my\module'  

import my_abc  # should work now

... 
```

请注意，除非您更改模块的名称，否则上述内容将不起作用，因为 Python 会在标准模块查找您附加的目录路径之前找到它。您可以通过在列表开头插入模块路径来覆盖它`sys.path`，但我不建议这样做。

如果您希望您的模块路径自动附加到系统的模块搜索路径，您可以创建一个*名称*.pth 文件并将其放在四个特殊目录之一中。有关详细信息，请参阅该文件的在线文档[`site.py`](http://docs.python.org/library/site.html?highlight=pth)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-03T00:11:04.123

如果您的文件被调用`abc.py`，那么它将尝试导入自身，因此`ImportError`由于循环依赖而引发 an 。请注意不要将您的程序文件命名为与标准库中的模块相同的名称。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-05-16T09:42:13.243

我也遇到过这个问题。我的项目在 python2 中使用了 pymongo 模块，而这个 pymongo 内部使用了 abc 库。我尝试了很多解决方案并进行了很多搜索，但没有一个解决方案成功。所以我计划从我的 Ubuntu 16.04 机器上重新安装或完全删除 python。但是 sudo apt-get install --reinstall python2.7 命令也失败了，并且抛出了相同的 abc 模块未找到错误。所以我终于做了一些黑客攻击和破解。以下是步骤-

手动删除所有 python 版本

*   sudo rm -rf /usr/bin/python2.x 以及 python3.x
*   sudo rm -rf /usr/lib/python2.x 以及 python3.x
*   sudo rm -rf /usr/local/lib/python2.x 以及 python 3.x

更新 Ubuntu

*   sudo apt-get 更新

如果出现此错误，则**需要重新安装软件包 ubuntu**然后运行以下命令

```
sudo vi /var/lib/dpkg/status 
```

并从上面的文件中删除 package_name 上的包的所有行

[现在从https://www.python.org/downloads/](https://www.python.org/downloads/)下载一个 python tgz 文件并将其解压缩和 CD 放入其中

```
./configure
make test
sudo make install 
```

现在应该安装 Python。通过运行 python 检查

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-08-02T18:51:49.320

abc 是模块（abc.py）还是包（abd 目录）？

在任何情况下，检查它们是否存在于与 pyFileIOprog 相同的目录中

# java - HttpURLConnection 不发送帖子数据

> ID：11783873
> 
> 赞同：-1
> 
> 时间：2012-08-02T18:46:49.757
> 
> 标签：java, php, android, httpurlconnection

我一直按照[此处列出](https://stackoverflow.com/a/2793153/620197)的步骤通过`HttpURLConnection`. 就我而言，有一个名为“json”的 POST 参数需要从服务器上拉出`_POST['json']`。

问题是`_POST['json']`，除了我尝试上传文件时， 中没有任何内容；文件数据放置在 中`_POST['json']`，而不是`_FILES['filename']`.

目标是实现这一目标：

```
_POST['json'] = {"fileData":"Some extra data about the file(s)"}
_FILES['filename'] = the file I uploaded. 
```

我构建请求的代码是：

```
try {
            url  = new URL(_requestObject.getUrl());
            conn = (HttpURLConnection)url.openConnection();

            conn.setRequestProperty("Content-Type", MMWebAPIConstants.MM_REQUEST_CONTENT_TYPE_HF + MMWebAPIConstants.MM_REQUEST_BOUNDARY);
            conn.addRequestProperty("Connection", "Keep-Alive");
            conn.setRequestMethod("POST");
            conn.setDoInput(true);
            conn.setDoOutput(true);
            conn.setUseCaches(false);

            if ( ! _requestObject.getAction().equals(MMWebAPIConstants.ACTION_LOGIN) ) {
                for ( String cookie : MMSessionManager.getSharedInstance().getCookies() )
                    conn.addRequestProperty("Cookie", cookie);
            }

            outstream = conn.getOutputStream();
            writer    = new PrintWriter(new OutputStreamWriter(outstream, "UTF-8"), true);

            writer.append("--" + MMWebAPIConstants.MM_REQUEST_BOUNDARY).append(crlf);
            writer.append("Content-Disposition: form-data; name=\"json\"").append(crlf);
            writer.append("Content-Type: text/plain; charset=UTF-8").append(crlf);
            writer.append(postValue.toString()).append(crlf).flush();

            if ( hasfiles ) {
                byte[]      bytes = null;
                InputStream input = null;

                for ( String filename : _requestObject.getFilePaths() ) {
                    String filepath = this.getContext().getFilesDir().getAbsolutePath() + "/" + filename;
                    String type     = URLConnection.guessContentTypeFromName(filename);
                    bytes           = new byte[5120];
                    input           = new FileInputStream(filepath);

                    writer.append("--" + MMWebAPIConstants.MM_REQUEST_BOUNDARY).append(crlf);
                    writer.append("Content-Disposition: form-data; name=\"" + filename + "\"; filename=\"" + filename + "\"").append(crlf);
                    writer.append("Content-Type: " + type).append(crlf);
                    writer.append("Content-Transfer-Encoding: binary").append(crlf);
                    writer.append(crlf).flush();

                    for ( int l = 0; (l = input.read(bytes)) > 0; ) {
                        outstream.write(bytes, 0, l);
                    }

                    outstream.flush();
                    writer.append(crlf).flush();
                }
            }

            writer.append("--" + MMWebAPIConstants.MM_REQUEST_BOUNDARY + "--").append(crlf);

            responseObject = this.getResponse(conn);

            this.getCookiesFromRequest(conn);

        } catch (MalformedURLException e) {
            e.printStackTrace();
        } catch (IOException e) {
            e.printStackTrace();
        } finally {
            if ( writer != null ) writer.close();
            if ( conn != null ) conn.disconnect();
        } 
```

post 和 files 数组如下所示：

```
ERROR - 2012-08-02 18:49:59 --> POST: Array
(
    [json] => PNG

IHDR#JzsBIT|d
4IDATx͒7rcd).`Tv-IHMH @55k.c_@qّ)f3Zz*UK%귿6}OGI~IJ~:M|@eӼXw|0`?b        Fլq^$zAn.;Cضo=
9J2O; e:=Md?DI{a;Lr56xA+~ҍZO|{orB{Iu<VkWL<x<m=+ȡhE5$:ͲI\k `9_5Ofx7EX"D#'NO:ƧjS+uj:gjP=,rɳW3I    s>DM4ޖ)մ_*``@JZ6(ʝZ3\ u5삮*rת@Rkc$o=JRs$%aϮi]ځl;]Q7lI6K  \ `L?OAsشZQOٍߍ*Y7VyoZuJYq,iM`SyYUSJfjѮf["0%y5N_0Z5"\ߚ$/fC!-ca^Mpfizvߚ???,)ak"_bUE>ml,BcMSB[7y')O7I7c>m3;Or6]qrAfe8t]I>0Zc!6Ϡ8
YT0\YA\?<#'GXGI^c"<Ͳ]cU;k$'y/z$Ƣ&N g<-0Џr'IRJAŗ9|ʉj3IL[Yo<fugq2;-acY[cw/Ô#,U /X"0x,k>uF&LRN$snu;דO    ~M</aSQ[Sy˶<*z`(RByP4Wh `L1=X   s3ٖ'9VaJ WML
0&|k:MB|LRNĚU<S|z`AWt7010&)'v/z%{cn=6lU9dW]"۔Ϫ<LFH_cNoy.0&SNT"fR.{0* `l<RKr<Ͳ?O;ÔxyػI~lU;=Jr@]  yMa&y=W}cbrƬs)aO_!<`삣$ea.  jUC~ơ+=6Zu-!8HfJ.B `@MRNDW }\wlҽ$$ߏ=`@]%ɿ9 Uɓq͗g)!Ъ*b!0H `4q|=LVO7>#MW*yp.   A͔m_/srr|We!]}  7GI˫OojRBK>gDK~@|܀W????[v9M8K9V4.Gtq܅'9+zؼU!U5z8:)Mr'9dy~ZB5IxE40  (Ƀ&NRNk(46+ܩU;}5ZnGI(EpA;I.n2Cۣ'`4pj5A]
 ס
&ݱwb<gxGY .nqS*͞0СiسjV4uUߴvB2
!NV~r[;i`@5M    n,k:٬خI4ZԾ6uIt1.Xs  [Jg8ZW$tqQ)ByM3i/moJ@1mo7XnFi=&ͪWBU}Sp%i%xjMIENDB`
)

ERROR - 2012-08-02 18:49:59 --> FILES: Array
(
) 
```

**更新**：

作为试验，我尝试关注[这个线程](https://stackoverflow.com/q/8900337/620197)（它引发了运行时异常），并且我尝试不上传文件，它不会填充`_POST['json']`，但仍然引发运行时异常。

请在这方面寻求帮助。

* * *

## 回答 #1

> 赞同：-2
> 
> 时间：2012-08-02T18:49:09.820

看起来您没有正确添加帖子参数。您需要发布参数。

请参阅：[在 Android 中使用带有 post 参数的 HttpClient 和 HttpPost](https://stackoverflow.com/questions/6028981/using-httpclient-and-httppost-in-android-with-post-parameters)

# python - ImportError：没有名为 bs4 的模块（BeautifulSoup）

> ID：11783875
> 
> 赞同：165
> 
> 时间：2012-08-02T18:47:00.570
> 
> 标签：python, beautifulsoup, flask, importerror

我正在使用 Python 并使用 Flask。当我在我的计算机上运行我的主要 Python 文件时，它运行良好，但是当我激活 venv 并在终端中运行 Flask Python 文件时，它说我的主要 Python 文件有“没有名为 bs4 的模块”。非常感谢任何意见或建议。

* * *

## 回答 #1

> 赞同：262
> 
> 时间：2012-08-02T19:52:18.333

激活 virtualenv，然后安装 BeautifulSoup4：

```
$ pip install BeautifulSoup4 
```

当您使用 安装`bs4`时`easy_install`，您在系统范围内安装了它。所以你的系统 python 可以导入它，但不是你的 virtualenv python。如果你不需要`bs4`安装在你的系统python路径下，卸载它并保留在你的virtualenv中。

有关 virtualenvs 的更多信息，请阅读[此](http://iamzed.com/2009/05/07/a-primer-on-virtualenv/)

* * *

## 回答 #2

> 赞同：61
> 
> 时间：2015-07-04T13:35:50.877

对于**python2.x**：

```
sudo pip install BeautifulSoup4 
```

对于**python3**：

```
sudo apt-get install python3-bs4 
```

* * *

## 回答 #3

> 赞同：17
> 
> 时间：2015-03-14T18:27:31.950

只是标记到巴尔萨扎的答案。跑步

```
pip install BeautifulSoup4 
```

对我不起作用。而是使用

```
pip install beautifulsoup4 
```

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2019-06-10T09:59:36.377

尝试这个：

```
sudo python3 -m pip install bs4 
```

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2018-12-29T21:38:28.220

```
pip3 install BeautifulSoup4 
```

尝试这个。这个对我有用。原因[在这里](https://python-forum.io/Thread-What-s-the-difference-between-pip-and-pip3)很好解释..

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2018-08-10T05:57:00.477

如果您使用 Anaconda 进行包管理，则应执行以下操作：

`conda install -c anaconda beautifulsoup4`

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2016-09-30T18:44:58.963

如果您使用**Pycharm**，请转到`preferences - project interpreter - install bs4`.

如果您尝试安装**BeautifulSoup**，它仍然会显示没有名为`bs4`.

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2018-04-17T18:08:03.200

我会建议您使用以下命令卸载 bs4 库：

> pip卸载bs4

然后使用以下命令安装它：

> sudo apt-get install python3-bs4

当我使用以下命令安装 bs4 库时，我在我的 Linux Ubuntu 中遇到了同样的问题：

> 点安装bs4

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2021-05-06T02:32:49.647

这对我有用。

`pipenv pip install BeautifulSoup4`

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2020-11-11T08:03:32.437

我一直在互联网上广泛搜索。

我正在使用 Python 3.6 和 MacOS。我已经卸载并安装了，`pip3 install bs4`但是没有用。似乎 python 无法检测或搜索`bs4`模块。

这是有效的： `python3 -m pip install bs4`

该`-m`选项允许您添加模块名称。

[https://docs.python.org/3/using/cmdline.html](https://docs.python.org/3/using/cmdline.html)

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2020-07-04T04:03:58.293

我做了@rayid-ali 所说的，除了我在 Windows 10 机器上，所以我省略了 sudo。也就是说，我做了以下事情：

```
python3 -m pip install bs4 
```

它就像一个pycharm。无论如何，它就像一个魅力。

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2021-11-09T21:09:59.680

发现答案与 BeautifulSoup 无关，真是太烦人了。对于 linux 用户，运行命令“python”不同，版本 2 退出，您可能忘记更改 python 的 bash 文件别名。因此，您可能已经使用 3 创建了虚拟环境

```
python3 -m venv .venv 
```

因此，要安装东西，请使用

```
python3 -m pip install beautifulsoup4 
```

不是

```
pip install beautifulsoup4 
```

东西安装在不同的版本中，你对发生的事情摸不着头脑。

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2019-10-07T06:51:06.170

`pip install --user BeautifulSoup4`

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2019-11-03T08:52:52.910

许多教程/参考资料都是为 Python 2 编写的，并告诉您使用 pip install somename。如果您使用的是 Python 3，您希望将其更改为 pip3 install somename。

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2019-09-17T18:27:54.243

```
pip3.7 install bs4 
```

尝试这个。它适用于 python 3.7

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2021-12-31T04:39:27.563

另一种解决方案`PyCharm`：

转到`File -> Settings -> Python Interpreter`，单击`plus`符号并找到`beautifulsoup4`。

单击`install`。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2020-07-29T19:12:27.747

原始查询的附录：modules.py

```
help('modules')

$python modules.py 
```

它列出了模块 bs4 已经安装。

```
_codecs_kr          blinker             json                six
_codecs_tw          brotli              kaitaistruct        smtpd
_collections        bs4                 keyword             smtplib
_collections_abc    builtins            ldap3               sndhdr
_compat_pickle      bz2                 lib2to3             socket 
```

正确的解决方案是：

```
pip install --upgrade bs4 
```

应该解决问题。

不仅如此，它还会对其他模块显示相同的错误。因此，对于那些出错的模块，您必须以与上述相同的方式发出 pip 命令。

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2020-08-17T16:04:26.180

如果您落后于公司代理，请尝试使用以下命令

pip install --proxy=http://www-YOUR_PROXY_URL.com:PROXY_PORT BeautifulSoup4

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2021-11-22T18:29:10.127

更好的方法是（“-U”：将所有软件包升级到最新的可用版本。）：

```
$ python3 -m pip install -U pip && python3 -m pip install -U bs4 
```

或从 apt（Debian、Ubuntu、Mint 等）安装：

```
$ sudo apt install python3-bs4 
```

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2018-04-19T21:45:42.097

最简单的是使用easy_install。

```
easy_install bs4 
```

如果 pip 失败，它将起作用。

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2020-06-19T16:07:04.580

尝试重新安装模块或尝试使用以下命令安装漂亮的汤

```
pip install --ignore-installed BeautifulSoup4 
```

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2020-05-24T18:52:54.597

您可能想尝试安装 bs4

```
pip install --ignore-installed BeautifulSoup4 
```

如果上述方法对您不起作用。

# svn - 运行 svn up 进行修订时，所有以前的修订是否也都更新了？

> ID：11783879
> 
> 赞同：1
> 
> 时间：2012-08-02T18:47:13.990
> 
> 标签：svn

我在 svn 中有一个工作副本，即修订版 1000。我们的修订版可以达到例如 1010。我只想更新到 1005，这是否意味着 1001、1002、1003 和 1004 也会更新我去svn up -r 1005？

非常感谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-02T18:59:00.530

以后的修订版包括在早期修订版中所做的所有更改（除非它被明确撤消）。也就是说，修订版 1005 将包含您之前所做的一切 (1-1004)。

# ios - 访问 alertView 的调用视图

> ID：11783880
> 
> 赞同：2
> 
> 时间：2012-08-02T18:47:18.370
> 
> 标签：ios, uialertview

我有一个 UIAlertView，当用户想要删除 RegionAnnotation 时，它会显示为确认。

我无法弄清楚如何访问调用 UIAlertView 的 RegionAnnotationView，我需要它来删除 RegionAnnotation。

这是我损坏的代码 - 你可以看到我试图将 AlertView 的超级视图转换为 RegionAnnotationView （一个公认的坏主意）。

```
- (void)alertView:(UIAlertView *)alertView clickedButtonAtIndex:(NSInteger)buttonIndex
{
    if(buttonIndex==0)
    {
        NSLog(@"alertView.superview is a %@",alertView.superview);
        RegionAnnotationView *regionView = (RegionAnnotationView *)alertView.superview;
        RegionAnnotation *regionAnnotation = (RegionAnnotation *)regionView.annotation;

        [self.locationManager stopMonitoringForRegion:regionAnnotation.region];
        [regionView removeRadiusOverlay];
        [self.mapView removeAnnotation:regionAnnotation];    
    }

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-02T19:12:02.163

由于在用户删除之前选择了注释，因此您可以从地图视图的`selectedAnnotations`属性中获取对注释的引用。

在警报视图委托方法中，您可以执行以下操作：

```
if (mapView.selectedAnnotations.count == 0)
{
    //shouldn't happen but just in case
}
else
{
    //since only one annotation can be selected at a time,
    //the one selected is at index 0...
    RegionAnnotation *regionAnnotation 
       = [mapView.selectedAnnotations objectAtIndex:0];

    //do something with the annotation...
} 
```

如果未选择注释，另一个简单的替代方法是使用 ivar 保存对需要删除的注释的引用。

MSK 评论的另一个选项是使用 objc_setAssociatedObject。

无论如何，假设视图层次结构以某种方式使用超级视图并不是一个好主意。

# backbone.js - 何时使用 bindTo、绑定或与 Backbone.Marionette 一起使用？

> ID：11783887
> 
> 赞同：20
> 
> 时间：2012-08-02T18:47:44.727
> 
> 标签：backbone.js, marionette

这次我正在努力使用不同的方法来绑定事件。我的代码中有所有提到的方法。我只是不知道，如果我走对了。也许我应该总是使用 bindTo 来确保我的视图在更改后完全关闭（目前这通常会产生错误）？是否有任何最佳实践可以帮助我朝着正确的方向前进？

为了说明我目前对 Marionette 的理解，这是我的应用程序中的一个模块。一如既往，每一个提示都非常受欢迎。

```
PP.module('Grid', function(Grid, PP, Backbone, Marionette, $, _){

  Grid.Product = Backbone.Model.extend({});

  Grid.ProductCollection = Backbone.Collection.extend({
    model: Grid.Product,
    url: '/products/query'
  });

  Grid.ProductView = Backbone.Marionette.ItemView.extend({
    className: 'grid',
    template: 'public/templates/grid-template'
  });

  // Helper Methods
  // -----------------------

  var getGenderCode = function(genderName){
    var genderMap = {
      'men': 'M',
      'women': 'W',
      'unisex': 'A'
    }

    return genderMap.genderName;
  }

  // Public API
  // -------------------

  Grid.renderGrid = function(productCollection){
    Grid.productView = new Grid.ProductView({
      collection: productCollection
    });

    Grid.productView.bind('show', function(){
      $('#isotope-container').isotope({
        itemSelector : '.item',
        containerStyle: {
          position: 'relative',
          zIndex: 1
        }
      });
    });

    PP.Layout.mainRegion.show(Grid.productView);
  }

  // Event Handlers
  // -----------------------

  PP.vent.bind('grid:requested', function(categoryData){
    // use bootstrapped data on first start
    if (PP.App.bootstrappedCategoryName !== categoryData.categoryName) {
      Grid.productCollection.fetch({
        data: {
          gender: getGenderCode(categoryData.categoryName),
          category: categoryData.categoryId
        }
      });
    }
    else {
      PP.vent.trigger('mainview:ready', {
        categoryName: PP.App.bootstrappedCategoryName
      });
    }
  });

  // Initializer
  // --------------------

  PP.addInitializer(function(options){
    Grid.productCollection = new Grid.ProductCollection();

    Grid.productCollection.on('reset', function(){
      Grid.renderGrid(Grid.productCollection);
    });

    Grid.productCollection.reset(options.newArrivalsList);
  });
}); 
```

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2012-08-06T22:11:15.867

一般准则是，只要您有一个对象在应用程序的整个生命周期中被创建和销毁，并且该对象需要绑定到来自其他对象的事件，您应该使用`EventBinder`.

## 视图和内存泄漏

视图就是一个很好的例子。视图一直被创建和销毁。`model`它们还绑定到视图和视图上的许多不同事件`collection`。当视图被销毁时，需要清理这些事件。通过在视图上使用内置`bindTo`方法，将为您清理事件处理程序。如果您不使用`bindTo`而是`on`直接使用，则必须`off`在视图关闭/销毁时手动调用以取消绑定事件。如果你不这样做，你最终会遇到僵尸（内存泄漏）。

如果您还没有阅读它们，请查看以下文章：

[http://lostechies.com/derickbailey/2011/09/15/zombies-run-managing-page-transitions-in-backbone-apps/](http://lostechies.com/derickbailey/2011/09/15/zombies-run-managing-page-transitions-in-backbone-apps/)

[http://lostechies.com/derickbailey/2012/03/19/backbone-js-and-javascript-garbage-collection/](http://lostechies.com/derickbailey/2012/03/19/backbone-js-and-javascript-garbage-collection/)

## 自定义事件分组

但是，视图并不是唯一适用的地方，也不是`EventBinder`.

如果您正在处理少数对象，绑定到它们的事件，并且这些对象可以替换为其他对象实例，那么 an`EventBinder`将很有用。在这种情况下，将 EventBinder 视为相关对象的一个​​集合或一组事件。

假设您有 ObjA、ObjB 和 ObjC。这些中的每一个都会触发一些事件，并且您希望确保在代码完成后清理事件处理程序。这很容易`EventBinder`：

```
 doStuff = {

  start: function(a, b, c){
    this.events = new Marionette.EventBinder();
    this.events.bindTo(a, "foo", this.doSomething, this);
    this.events.bindTo(b, "bar", this.anotherThing, this);
    this.events.bindTo(c, "baz", this.whatever, this);
  },

  doSomething: function(){ /* ... */ },
  anotherThing: function(){ /* ... */ },
  whatever: function(){ /* ... */ },

  stop: function(){
    this.events.unbindAll();
  }

}

doStuff.start(ObjA, ObjB, ObjC);

// ... some time later in the code, stop it

doStuff.stop(); 
```

调用`stop`此代码将正确清理所有用于此用途的事件处理程序。

## 何时使用`on`/`off`直接

与所有这些相反的是，您并不总是需要使用`EventBinder`. 没有它，你总是可以逃脱的。但是您需要记住在必要时清理您的事件。

在不需要清理事件处理程序的情况下，也不需要使用`EventBinder`, 。这可能是路由器触发的事件，也可能是`Marionette.Application`对象触发的事件。对于那些应用程序生命周期事件，或者需要贯穿应用程序整个生命周期的事件，不要为`EventBinder`. 相反，让事件处理程序继续存在。当用户刷新浏览器窗口或导航到不同的站点时，处理程序将在此时被清理。

但是，当您需要管理内存和事件处理程序、清理引用并在不刷新页面或离开页面的情况下关闭事物时，它就`EventBinder`变得很重要，因为它简化了事件管理。

# c - 指针/结构问题 C

> ID：11783892
> 
> 赞同：1
> 
> 时间：2012-08-02T18:48:10.447
> 
> 标签：c, pointers, constructor, segmentation-fault

我有以下段错误的代码，我完全不知道为什么。任何帮助将不胜感激。

当我这样做时会发生段错误（检查所有内容是否已正确初始化）。没有打印任何内容，因此它在第一行出现段错误。不幸的是，我无法使用 valgrind，因为此代码位于我无法访问的沙箱中，因此无法检查那里的问题。

```
for (i = 0 ; i<nb_read ; i++) {

 fprintf(stdout, "Read Lock i %d  %p \n ",i, nap->read_buffer[i]->sem_handle); 
 fprintf(stdout, "Write Lock i %d  %p \n ",i, nap->write_buffer[i]->sem_handle);  
 fprintf(stdout, "Read Buffer i %d  %p \n ",i, nap->read_buffer[i]->buffer); 
 fprintf(stdout, "Write Buffer i %d  %p \n ",i, nap->write_buffer[i]->buffer); 

} 
```

其中 SharedStruct 是具有 char* 缓冲区成员和 int sem_handle 的结构

```
SharedStruct** create_buffer(int nb, int size) {
SharedStruct** result = malloc(nb * sizeof(SharedStruct*));
int i = 0 ;
for (i = 0 ; i<nb ; i++) {
        SharedStruct* res= malloc(nb *sizeof(SharedStruct));
        res->buffer = malloc(size * sizeof(char)); 
        int lock = initialise_protection();
        fprintf(stdout, "\n Semaphore initialised to %d \n ", lock);
        res->sem_handle = lock ;
    }
    return result ;
 } 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-02T18:55:35.407

我没有看到您初始化结果中包含的指针。您刚刚为它们分配了空间，似乎您忘记了在循环中执行 result[i]=res 。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-02T19:03:16.960

第一的。您应该正确缩进代码，否则您无法阅读自己的代码。

接下来，您将其初始化`result`为条目数组`nb`，而根本没有对其进行初始化。

接下来，您`nb`分配一个指向 (SharedStruct*) 的指针，并为每个这样的结构分配一个缓冲区，该缓冲区不会保留在任何地方，因此您以后无法释放它。

# python - 以一对多的方式制作模型参考抽象模型

> ID：11783895
> 
> 赞同：4
> 
> 时间：2012-08-02T18:48:21.427
> 
> 标签：python, django, django-models, foreign-keys, abstract-class

我对 Django 很陌生，现在我正在尝试了解抽象模型的使用。假设您正在编写一个博客服务，并且您希望经过身份验证的用户和匿名用户都能够评论博客文章。

虽然场景对于经过身份验证的用户来说非常简单（只有一个外键来引用特定用户），但当`Authors`不仅仅是`User`s 而是`AnonymousAuthor`s 或`RegisteredAuthor`s 时，情况就不是那么简单了。

这里的直接方法是构建类的层次结构：

```
class Author(models.Model):
  class Meta:
    abstract = True

class AnonymousAuthor(Author):
  name = models.CharField(max_length=128)
  def display_name(self):
    return self.name

class RegisteredAuthor(Author):
  user = models.ForeignKey(User)
  def display_name(self):
    return self.user.user_name 
```

然后`BlogPostComment`可以这样定义：

```
class BlogPostComment(models.Model):
  author = models.ForeignKey(Author)
  ... 
```

我喜欢这种方法，因为无论作者是谁，我都可以轻松地通过迭代`BlogPostComment`s 集并调用`display_name()`每个评论来构建评论列表。这里唯一的问题是它不起作用。姜戈 说：

```
AssertionError: ForeignKey cannot define a relation with abstract class Author 
```

这里有什么解决方案？

**更新**

我知道[通用关系](https://docs.djangoproject.com/en/dev/ref/contrib/contenttypes/#generic-relations)在这里可以提供帮助。但它是唯一的解决方案吗？感觉有点矫枉过正。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-02T19:31:03.003

与模型不同，通用关系是为许多人创建外键的解决方案。一般来说，如果你有继承：

```
class Animal(models.Model):
    ...

class Dog(Animal):
    ... 
```

然后后来：

```
models.ForeignKey(Animal) 
```

您也可以将 a 存储`Dog`为外键，因为 a `Dog`is-a `Animal`。但是，在抽象类的情况下，它们不适合被设置为外键的目标，因为它们不*存在*。Django 的“抽象”模型更接近于“mixin”的定义：它们永远不会被自己实例化，而是用来组成其他被实例化的类。

所以你在这里有三个选择：

1.  更改`Author`为标准模型而不是抽象模型。然后，您可以创建外键`Author`并传入`Author`您喜欢的任何子类。

2.  使用通用外键

3.  首先不要分解模型。

这里的最后一个选择实际上是您最好的选择，因为当唯一的区别在于它们是注册的还是匿名的时，没有理由拥有单独的作者表。那是对象的*状态*，而不是不同类型的对象。就像`BlueCar`上课一样是不合适的。你有一个`Car`类，而“蓝色”是它的`color`属性值。

如果您坚持使用单独的模型。然后，您可以使用代理模型。Where`AnonymousAuthor`和`RegisterAuthor`只是别名`Author`（他们没有自己的表），但是拥有别名允许您更改或添加自定义方法，特别是能够指定一个自定义管理器，该管理器自动过滤`Author`以仅返回“匿名”或“注册”类型，分别。

# java - 如何将列表转换为字符串

> ID：11783904
> 
> 赞同：0
> 
> 时间：2012-08-02T18:49:17.543
> 
> 标签：java, list

我得到前三列的值，但不是最后一列的值。如何将列表转换为字符串，以便获取组织列的值？

这是我的代码：

```
String appname = "abc";
String path = "//home/exportfile//";
String filename = path+"ApplicationExport-"+appname+".txt";
String ret = "false";

        QueryOptions ops = new QueryOptions();
    Filter [] filters = new Filter[1];
    filters[0] = Filter.eq("application.name", appname);
    ops.add(filters);

    List props = new ArrayList();
    props.add("identity.name");

    //Do search
    Iterator it = context.search(Link.class, ops, props);

    //Build file and export header row
    BufferedWriter out = new BufferedWriter(new FileWriter(filename));
    out.write("IdentityName,UserName,WorkforceID,Organization");
    out.newLine();          

    //Iterate Search Results
    if (it!=null)
    {                               
            while ( it.hasNext() ) {

                    //Get link and create object
                    Object [] record = it.next();
                    String identityName = (String) record[0];
                    Identity user = (Identity) context.getObject(Identity.class, identityName);

                    //Get Identity attributes for export
                    String workforceid = (String) user.getAttribute("workforceID");                 

                    //Get application attributes for export
                    String userid="";

                    List links = user.getLinks();
                    if (links!=null)
                    {
                            Iterator lit = links.iterator();
                            while (lit.hasNext())
                            {
                                    Link l = lit.next();
                                    String lname = l.getApplicationName();
                                    if (lname.equalsIgnoreCase(appname))
                                    {
                                              userid = (String) l.getAttribute("User Name");
                                              List organizations = l.getAttribute("Organization");

                                              StringBuilder sb = new StringBuilder();
                                              String listItemsSeparator = ","; // this you can change to anything you want, it separates items from list

                                                                                                            for (Object organization : organizations)
                                                                                                                    {
                                                                                                                            sb.append(organization.toString());
                                                                                                                            sb.append(listItemsSeparator);
                                                                                                                    }

                                                                                                                    org = sb.toString().trim();

                                    }
                            }
                    }                   

                    //Output file
                    out.write(identityName+","+userid+","+workforceid+","+org);                             
                    out.newLine();                                                                          
                    out.flush();
            }

                     ret="true";
    }

    //Close file and return
    out.close();
    return ret; 
```

此代码为 Organization 列的值写入 Void。我怎样才能解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-02T18:53:59.663

您确实没有提供太多关于您的应用程序中发生了什么，或者您为什么要为组织获取列表的信息。但是试试这个：

```
out.write(identityName+","+userid+","+workforceid+","+(String)orgList.get(0)); 
```

你的列表也没有参数化，所以我们不知道列表存储的是什么类型的对象。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-02T18:52:21.117

您需要覆盖列表中对象的默认 toString 方法。对列表调用 toString 将导致调用其中所有对象的 toString 方法。您还可以遍历列表并打印每个值。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-02T18:56:05.580

编辑：你的代码真的很乱，但我想我知道你在问什么：

```
 List links = user.getLinks();
    if (links != null) {
        Iterator lit = links.iterator();
        while (lit.hasNext()) {
            Link l = lit.next();
            String lname = l.getApplicationName();
            if (lname.equalsIgnoreCase(appname)) {
                userid = (String) l.getAttribute("User Name");
                List organizations = l.getAttribute("Organization");

                StringBuilder sb = new StringBuilder();
                String listItemsSeparator = " "; // this you can change to anything you want, it separates items from list

                //iterating over list, to convert it to single String 
                for (Object organization : organizations) {
                    sb.append(organization.toString());
                    sb.append(listItemsSeparator);
                }

                orgList = sb.toString().trim();

            }
        }
    } 
```

编辑2：

```
while (it.hasNext()) {

    //Get link and create object
    Object [] record = it.next();
    String identityName = (String) record[0];
    Identity user = (Identity) context.getObject(Identity.class, identityName);

    //Get Identity attributes for export
    String workforceid = (String) user.getAttribute("workforceID");

    //Get application attributes for export
    String userid="";

    List links = user.getLinks();
    if (links!=null)
    {
        Iterator lit = links.iterator();
        while (lit.hasNext())
        {
            Link l = lit.next();
            String lname = l.getApplicationName();
            if (lname.equalsIgnoreCase(appname))
            {
                userid = (String) l.getAttribute("User Name");
                List orgList = l.getAttribute("Organization");
                if(organization &lt; orgList.size()) {
                    String singleOrganization = orgList.get(organization);
                    organization++;

                    //Output file
                    out.write(identityName+","+userid+","+workforceid+","+orgList);
                    out.newLine();
                    out.flush();

                }

            }
        }
    } 
```

# mysql - 在 Heroku 上的 Play 2.0 应用程序中调试“无法获取连接”错误

> ID：11783906
> 
> 赞同：1
> 
> 时间：2012-08-02T18:49:45.000
> 
> 标签：mysql, heroku, playframework-2.0

我正在切换到 Heroku 并尝试使用 ClearDB 提交 Play 2.0 项目。一切似乎都可以正常编译，除了 Heroku 尝试启动应用程序时出现错误：

```
2012-08-02T18:10:45+00:00 heroku[web.1]: 状态从开始变为开始
2012-08-02T18:10:45+00:00 heroku[slugc]：Slug 编译完成
2012-08-02T18:10:48+00:00 heroku[web.1]：使用 SIGTERM 停止所有进程
2012-08-02T18:10:48+00:00 heroku[web.1]：使用命令`target/start -Dhttp.port=47334 -Ddb.default.url=mysql://bf64fa6afab971:4b5fe3e5@us 启动进程-cdbr-east.cleardb.com/heroku_32ef64c5764c759?reconnect=true -DapplyEvolutions.default=true -Xmx384m -Xss512k -XX:+UseCompressedOops`
2012-08-02T18:10:51+00:00 app[web.1]：播放服务器进程 ID 为 2
2012-08-02T18:10:51+00:00 heroku[web.1]：进程以状态 143 退出
2012-08-02T18:10:52+00:00 app[web.1]:[error] cjbhAbstractConnectionHook - 无法获取连接休眠 1000 毫秒并重试。剩余尝试次数：10。异常：null

```

我已经完成了所有的谷歌搜索和研究，但不知道是什么导致了错误：

**档案**

```
网络：目标/开始 -Dhttp.port=$PORT -Ddb.default.url=$CLEARDB_DATABASE_URL -DapplyEvolutions.default=true $JAVA_OPTS
```

**应用程序.conf**

```
db.default.driver=com.mysql.jdbc.Driver
```

**heroku 会议**

```
CLEARDB_DATABASE_URL：mysql://myusername:mypassword@us-cdbr-east.cleardb.com/heroku_32ef64c5764c759?reconnect=true
DATABASE_URL：postgres://myusername:mypassword@ec2-107-20-235-95.compute-1.amazonaws.com/sbzwmvjnqs
ENVIRONMENT_MODE：阶段
JAVA_OPTS: -Xmx384m -Xss512k -XX:+UseCompressedOops
路径：.sbt_home/bin:/usr/local/bin:/usr/bin:/bin
回购：/app/.sbt_home/.ivy2/cache
SBT_OPTS: -Xmx384m -Xss512k -XX:+UseCompressedOops
SHARED_DATABASE_URL：postgres://myusername:mypassword@ec2-107-20-235-95.compute-1.amazonaws.com/sbzwmvjnqs

```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-02T19:32:55.993

这是我在 Heroku 上让 Play Framework 2.0.2 与 MySQL（通过 ClearDB）一起工作之前的最后一个配置问题。

尽管它没有给出实际错误，但它只是在说：

```
2012-08-02T18:10:52+00:00 app[web.1]:[error] cjbhAbstractConnectionHook - 无法获取连接休眠 1000 毫秒并重试。剩余尝试次数：10。异常：null
```

实际的问题是 Heroku 在“标准免费”模式下，使用 ClearDB 只会给你 10 个同时连接。我之前看到过，默认情况下，play 将使用 60 个连接。

**解决方案：**

在 application.conf 中，添加：

```
db.default.partitionCount=1
db.default.maxConnectionsPerPartition=5
db.default.minConnectionsPerPartition=1
db.default.acquireIncrement=1
db.default.acquireRetryAttempts=1
db.default.acquireRetryDelay=5 秒

```

# django - uwsgi 协议比 http 协议快吗？

> ID：11783907
> 
> 赞同：13
> 
> 时间：2012-08-02T18:49:49.110
> 
> 标签：django, sockets, nginx, wsgi, uwsgi

我正在尝试部署 django 应用程序的各种设置。我的第一选择是使用一个简单的带有 mod_wsgi 的 apache 服务器，这是我之前为私人使用而实现的。由于当前的部署是供公众使用的，我正在考虑各种选项。根据在线提供的信息，使用 nginx 提供静态内容以及动态内容服务器的反向代理似乎很好。现在，鉴于我以前对 Apache 的了解，我正在考虑将其用于动态内容。但后来我遇到了 Gunicorn 和后来的 uWSGI。目前我正在实施 uWSGI。我看到它允许多种协议，包括http。

使用一种协议相对于另一种协议有什么优势。我知道，鉴于我需要在多个服务器上扩展应用程序，这意味着我不能使用 Unix 套接字，这似乎在某些教程中被推荐。所以其他选择是使用 uwsgi 或 http 的 TCP 套接字。他们有很大的理论差异。我不知道 uwsgi 协议的详细信息，并且想知道，如果通过 http 协议使用它会使事情变得更快吗？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-08-02T23:38:16.520

最终，您的瓶颈不会出现在请求的特定路由机制中，除非您真的搞砸了配置。因此，可以说过于专注于根据该级别的事情做出决策是浪费时间。

去观看我在 PyCon 上的演讲，了解瓶颈的真正位置。

[http://lanyrd.com/2012/pycon/spcdg/](http://lanyrd.com/2012/pycon/spcdg/)

# wpf - 在组合框中显示默认值

> ID：11783909
> 
> 赞同：0
> 
> 时间：2012-08-02T18:50:05.530
> 
> 标签：wpf, xaml

我有一个 ComboBox，其 XAML 如下所示：

```
 <StackPanel Grid.Row = "0" Style="{DynamicResource chartStackPanel}">
        <Label    Content="Port:" HorizontalAlignment="Left" Margin="8,0,0,0"/>
        <ComboBox Width="75" Height="24" HorizontalAlignment="Right" Margin="8,0,0,0" SelectedValue="{Binding Port, Mode=OneWayToSource}">
            <ComboBoxItem Content="C43"/>
            <ComboBoxItem Content="C46" IsSelected="True"/>
            <ComboBoxItem Content="C47"/>
            <ComboBoxItem Content="C48"/>
        </ComboBox>
    </StackPanel> 
```

上面引用的样式定义如下：

首次显示 ComboBox 时，我希望在 ComboBox 中显示“C46”项。但是，当它加载时，ComboBox 是空白的。有趣的是，我的 VM 中的源属性设置为“C46”。谁能告诉我做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-02T19:26:07.493

您提到您的 ViewModel 中有一个源集合。所以，为什么要在XAML中一一指定ComboBoxItems呢？我认为您应该在 ViewModel 中有一个 Collection of Items 属性和 SelectedItem 属性。在构造函数中，您可以设置 SelectedItem。它看起来如下：

```
public ObservableCollection<MyClass> Items { get;set; }

public MyClass SelectedItem
{
  get {return this.selectedItem;}
  set {
       this.selectedItem = value;
       RaisePropertyChanged("SelectedItem");
      }
} 
```

在 Items 属性初始化后的构造函数中：

```
this.SelectedItem = Items[x] 
```

您的 XAML 可能如下所示：

```
<ComboBox Width="75" Height="24" HorizontalAlignment="Right" Margin="8,0,0,0" 
                      ItemsSource="{Binding Items}"
                      SelectedItem="{Binding Path=SelectedItem}"
                      DisplayMemberPath="Content"/> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-02T19:23:34.713

我遵循相同的方法，并且在屏幕加载时显示“C46”。但是，VM 将显示`System.Windows.Controls.ComboBoxItem: C46`而不是`C46`因为您没有使用***SelectedValuePath***来指定绑定值路径

我用`SelectedValuePath="Content"`它会显示'C46'

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2015-10-29T18:55:18.023

// 看法

```
<ComboBox x:Name="cbCategories" Width="300" Height="24" ItemsSource="{Binding Categories}"
DisplayMemberPath="CategoryName" SelectedItem="{Binding SelectedCategory}" /> 
```

// 视图模型

```
private CategoryModel _SelectedCategory;
        public CategoryModel SelectedCategory
        {
            get { return _SelectedCategory; }
            set
            {
                _SelectedCategory = value;
                OnPropertyChanged("SelectedCategory");
            }
        }

        private ObservableCollection<CategoryModel> _Categories;
        public ObservableCollection<CategoryModel> Categories
        {
            get { return _Categories; }
            set
            {
                _Categories = value;
                _Categories.Insert(0, new CategoryModel()
                {
                    CategoryId = 0,
                    CategoryName = " -- Select Category -- "
                });
                SelectedCategory = _Categories[0];
                OnPropertyChanged("Categories");

            }
        } 
```

# python - .py 文件可以在 Visual Studio 2010 中调试吗？

> ID：11783911
> 
> 赞同：3
> 
> 时间：2012-08-02T18:50:19.850
> 
> 标签：python, visual-studio-2010

我是 Python 新手，正在使用 Visual Studio 的 Python 工具，但我似乎找不到在 .py 文件上使用 VS 调试器的方法。似乎必须将文件编译为 VS 解决方案的一部分的 .pyc 才能使用调试器。

这是一个遗憾，因为我想在文本编辑器中编写独立的 .py 脚本并根据需要使用 VS 调试器。

我错过了什么吗？有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-02T19:25:35.077

与其尝试使用 Visual Studio 进行调试，不如考虑使用 pdb 模块：[http ://aymanh.com/python-debugging-techniques](http://aymanh.com/python-debugging-techniques)

编辑：我花了一些时间玩 Attach Process，但无法让它工作。我的建议：将 .py 文件放在 VS 解决方案中，使用您喜欢的文本编辑器进行编辑，然后切换回 VS，然后在解决方案资源管理器选项卡中，右键单击该文件并选择 Start With Debugging。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-02T21:26:29.327

调试像 python 这样的动态语言有点不同
（我假设您的意思是要调试 python 代码而不是 python 解释器中的 C 代码。）

有一些很好的免费工具可以将 VS2010 与我过去使用过的 python 结合使用 - 请参阅[Visual Studio 2010 的 Python 集成](http://pytools.codeplex.com/)

# java - JSP 访问类实例

> ID：11783918
> 
> 赞同：0
> 
> 时间：2012-08-02T18:51:19.600
> 
> 标签：java, jsp, web-applications, servlets

我的要求是 Java 类成员变量必须由 3 个或更多 JSP 文件访问。java 类的输入将是一个属性文件。将属性文件传递给构造函数将填充类成员变量。此变量将被 3 个或更多 JSP 文件使用。因此，与其创建具有相同属性文件的不同实例，不如创建一次实例并且如果所有 JSP 都可以访问它，这将是有效的。目前我的想法是将java类作为单例或其他类创建实例并将其保存在会话中并让所有jsp访问它。我觉得单例类更合适。是否有我的决定仪式或任何其他更有效的方式？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-03T06:55:42.923

我只建议将依赖于会话的对象保留在会话中。在这种情况下，由于您必须使变量在 3 个不同的 jsp 中可访问，并且这些值不依赖于单个请求，因此最好将对象存储在应用程序上下文中。

使用 ServletContext 的 getAttribute() 和 setAttribute() 方法。将值存储在 Application Scope 中，您应该永远完成。

# android - Listview背景没有改变

> ID：11783919
> 
> 赞同：0
> 
> 时间：2012-08-02T18:51:24.593
> 
> 标签：android, android-listview

我有`viewpager`一堆，`listviews`当列表未满或为空时，我希望背景为黑色，特别`motorola`是在某些手机上，默认背景为灰色

这是我的带有 viewpager 的 xml

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:layout_width="fill_parent"
android:layout_height="fill_parent"
android:orientation="vertical"
android:background="#000000">

<RelativeLayout android:id="@+id/top_rl"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:background="@drawable/titlebg"
        android:layout_above="@+id/list">

         <ImageView
            android:id="@+id/imgStartupHeader"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:adjustViewBounds="true"
            android:scaleType="centerCrop"
            android:layout_alignParentTop="true"
            android:layout_alignParentLeft="true"
            android:layout_marginLeft="10dp"
            android:src="@drawable/logo"/>

         <ImageView
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:adjustViewBounds="true"
            android:scaleType="centerCrop"
            android:layout_alignParentTop="true"
            android:layout_alignParentRight="true"
            android:layout_marginRight="10dp"
            android:src="@drawable/fire_android"/>
    </RelativeLayout>

<android.support.v4.view.ViewPager
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:id="@+id/pager"
    android:background="#000000"/>

</LinearLayout> 
```

以及保存列表视图的寻呼机 xml

```
<?xml version="1.0" encoding="utf-8"?>
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:layout_width="fill_parent"
android:layout_height="fill_parent" 
android:id="@+id/layout"
android:background="#000000">

    <RelativeLayout
        android:layout_width="match_parent"
        android:layout_height="fill_parent"
        android:layout_above="@+id/bottom_rl"
        android:background="#000000" >

    <ListView
        android:id="@android:id/list"
        android:layout_width="fill_parent"
        android:layout_height="fill_parent"
        android:background="#000000">

    </ListView>

    </RelativeLayout>

    <RelativeLayout android:id="@+id/bottom_rl"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:layout_alignParentBottom="true"
        android:background="@drawable/bottombg">

    <ImageView android:id="@+id/listName"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_centerInParent="true"
        android:src="@drawable/incidents"/>   
    </RelativeLayout>

</RelativeLayout> 
```

在这两个文件中，我都将背景设置为，`#000000`但它仍然显示为灰色背景，我在这里缺少什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-02T19:09:32.633

而不是在背景中使用颜色，我必须使用具有我需要的颜色的可绘制对象 - 这样可以确保所有设备上的背景颜色都相同。不要忘记 `android:scaleType="fitXY"`

ps I know it's not the most elegant solution - but with Android differences becoming more and more difficult to handle accross so many platforms I tend to use basic easy solutions, that do not allow variations as much as possible.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-02T19:24:18.317

Figured it out, if I set the `listview` to `wrap_content` it shows a black background so the listview background but have something specific to it on certain devices

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-02T18:56:13.297

请试试 ：

```
android:background="#000000"
android:cacheColorHint="#000000" 
```

# python - 如何等待 20 秒让用户按下任意键？

> ID：11783920
> 
> 赞同：5
> 
> 时间：2012-08-02T18:51:29.883
> 
> 标签：python, python-2.5

如何等待用户按任意键 20 秒？即我显示消息并且它计数 20 秒，如果经过 20 秒或如果用户按下任何键，代码将继续执行。我怎样才能用python做到这一点？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-02T19:15:52.787

如果您使用的是 Windows：

```
def wait_for_user(secs):
    import msvcrt
    import time
    start = time.time()
    while True:
        if msvcrt.kbhit():
            msvcrt.getch()
            break
        if time.time() - start > secs:
            break 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-02T19:26:57.337

一种可能的解决方案是使用`select`检查值，但我不喜欢它，我觉得我在浪费时间。
另一方面，您可以在 Linux 系统上使用信号来处理问题。一段时间后，将引发异常，`try`失败并且代码继续`except`：

```
import signal

class AlarmException(Exception):
    pass

def alarmHandler(signum, frame):
    raise AlarmException

def nonBlockingRawInput(prompt='', timeout=20):
    signal.signal(signal.SIGALRM, alarmHandler)
    signal.alarm(timeout)
    try:
        text = raw_input(prompt)
        signal.alarm(0)
        return text
    except AlarmException:
        print '\nPrompt timeout. Continuing...'
    signal.signal(signal.SIGALRM, signal.SIG_IGN)
    return '' 
```

代码取自[这里](http://www.garyrobinson.net/2009/10/non-blocking-raw_input-for-python.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-02T19:17:38.820

（警告：未经测试的代码）

就像是：

```
 import sys
 import select

 rlist, _, _ = select.select([sys.stdin], [], [], timeout=20)
 if len(rlist) == 0:
     print "user didnt input anything within 20 secs"
 else:
     print "user input something within 20 secs. Now you just have to read it" 
```

**编辑**见：[http ://docs.python.org/library/select.html](http://docs.python.org/library/select.html)

# entity-framework - 从 EF 迁移到存储过程

> ID：11783921
> 
> 赞同：-1
> 
> 时间：2012-08-02T18:51:35.447
> 
> 标签：entity-framework, entity-framework-4, entity-framework-4.1

我们在 MVC 3 和 EF（我认为是 4.1）中为我们的 Web 商店创建了一个原型。EF 模型已创建

结果我们的 CTO 希望所有生产 SQL 都使用存储过程执行，以避免暴露表名和字段。

有人对我如何在对 C#/EF 代码的干扰最小的情况下引入存储过程有任何建议吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-02T18:56:23.317

您可以将它们作为函数导入导入 EDMX 模型，并使用映射函数将它们映射到实体的插入/更新/删除。

如果您在存储过程中有任何自定义行为，您可以使用执行 SP`ExecuteFunction`

您不应该在实体层之上有太多的中断，但请注意，EF 在它想要定义存储过程的参数方面非常不灵活

[http://msdn.microsoft.com/en-us/library/bb896231.aspx](http://msdn.microsoft.com/en-us/library/bb896231.aspx)

# python - 使用 multiprocessing.Pool 时 Python 例程运行速度要慢得多

> ID：11783923
> 
> 赞同：3
> 
> 时间：2012-08-02T18:51:46.093
> 
> 标签：python, multiprocessing

我有一个 Python 应用程序的子例程，它采用八字符序列号的列表，并在一组目录中搜索包含具有一系列可能扩展名的那些 SN 的文件名。执行它的功能如下。

```
def CompleteSN(SNorig, directories, exts, directoryContents=None):

    # Split SNorig into its directory path and basename
    directory, basename = os.path.split(SNorig)

    #Don't try to complete if it has a directory already
    if len(directory) > 0:
        return SNorig

    # Split the basename into extension (ext) and serial number (SN)
    SN = basename[:8].upper()

    #If we have a cache, check it
    if directoryContents is not None:
        if SN in directoryContents:
            return directoryContents[SN]
        else:
            return None

    possSNs = ['.'.join((SN, ext)) for ext in exts]

    for pSN in possSNs:
        for d in directories:
            dpath = os.path.join(d, pSN)
            if os.path.exists(dpath):
                return dpath

    return None 
```

SN 是要转换成完整路径的序列号，directories 是要在其中查找的目录列表，exts 是要尝试的可能扩展名列表（没有前导点），directoryContents 是 None 或大（数百数以千计的条目) dict 映射目录中文件的序列号以搜索到它们的全名。我的想法是，要完成大量序列号，将所有可以找到的序列号放入字典中以便快速查找它们会更快，而不是为每个序列号进行系统调用。对于要完成的大量 SN，这值得制作 dict 的成本。

正如我预测的那样，一旦填充了目录内容，它就会快得多。但是，只有在不使用多处理时才会出现这种情况。我允许用户切换多处理模式，当 directoryContents 为 None 时，这比预期的更快。（即，当我们通过使用 os.path.exists 检查它们的存在来查找文件时）但是，当检查它们的 dict 时，在 multiprocessing.Pool 中调用 CompleteSN 非常慢，大约不到 10 个 SN/秒. （与不使用多处理时的数千个相比）我对正在发生的事情的最佳猜测是，Python 用于在池工作者（我认为有 8 个）之间共享数据的任何机制都被如此大的 dict 结构所困扰。谁能帮我了解这里发生了什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-02T19:14:10.990

通常，您不应该在多个进程之间共享数据结构。同步中的开销通常会影响性能。也许您可以创建查找字典的单独副本，每个进程一个？

# html - IE 中 colspan > 1 的 td 元素的 CSS 规则

> ID：11783929
> 
> 赞同：20
> 
> 时间：2012-08-02T18:52:03.207
> 
> 标签：html, css, css-selectors

我需要将一些 css 样式应用于具有“colspan”属性且其值大于 1 的 td 元素。

我执行以下操作：

```
td[colspan][colspan!=1] {
 background: red;
} 
```

它适用于所有浏览器而不是 IE（包括最新版本）。请帮忙。我该如何解决。

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2012-08-02T18:56:38.767

这不应该在任何浏览器中工作，因为`[colspan!=1]`它不是有效的 CSS 属性选择器。它仅作为非标准扩展存在于 jQuery 中。

从[jQuery 文档](http://api.jquery.com/attribute-not-equal-selector)：

> 此选择器等效于`:not([attr="value"])`.

这意味着它要在 CSS 中工作，你需要使用它：

```
td[colspan]:not([colspan="1"]) {
 background: red;
} 
```

请记住，`:not()`早于版本 9 的 IE 不支持这一点。如果您需要支持旧版浏览器，您可以使用 jQuery 来应用样式，或者如果您必须使用 CSS，那么您应该覆盖`td`元素的样式`[colspan="1"]`：

```
td {
 background: red;
}

td[colspan="1"] {
 background: transparent;
} 
```

# c++ - 如何在 CMake 文件中添加链接器或编译标志？

> ID：11783932
> 
> 赞同：263
> 
> 时间：2012-08-02T18:52:12.470
> 
> 标签：c++, cmake

我正在使用`arm-linux-androideabi-g++`编译器。当我尝试编译一个简单的“Hello, World!” 程序编译得很好。当我通过在该代码中添加一个简单的异常处理来测试它时，它也可以工作（在添加之后`-fexceptions`.​​. 我猜它默认是禁用的）。

这是针对 Android 设备的，我只想使用 CMake，而不是`ndk-build`.

例如 -`first.cpp`

```
#include <iostream>

using namespace std;

int main()
{
   try
   {
   }
   catch (...)
   {
   }
   return 0;
} 
```

`./arm-linux-androideadi-g++ -o first-test first.cpp -fexceptions`

它工作没有问题...

**问题**...我正在尝试使用 CMake 文件编译该文件。

我想将其添加`-fexceptions`为标志。我试过了

```
set (CMAKE_EXE_LINKER_FLAGS -fexceptions ) or set (CMAKE_EXE_LINKER_FLAGS "fexceptions" ) 
```

和

```
set ( CMAKE_C_FLAGS "fexceptions") 
```

它仍然显示错误。

* * *

## 回答 #1

> 赞同：283
> 
> 时间：2012-08-03T14:02:03.757

注意：鉴于编写此答案后 CMake 的演变，这里的大多数建议现在都已过时/已弃用，并且有更好的选择

* * *

假设您要添加这些标志（最好在常量中声明它们）：

```
SET(GCC_COVERAGE_COMPILE_FLAGS "-fprofile-arcs -ftest-coverage")
SET(GCC_COVERAGE_LINK_FLAGS    "-lgcov") 
```

有几种方法可以添加它们：

1.  最简单的一个（不干净，但简单方便，仅适用于编译标志、C 和 C++）：

    ```
     add_definitions(${GCC_COVERAGE_COMPILE_FLAGS}) 
    ```

2.  附加到相应的 CMake 变量：

    ```
     SET(CMAKE_CXX_FLAGS  "${CMAKE_CXX_FLAGS} ${GCC_COVERAGE_COMPILE_FLAGS}")
     SET(CMAKE_EXE_LINKER_FLAGS  "${CMAKE_EXE_LINKER_FLAGS} ${GCC_COVERAGE_LINK_FLAGS}") 
    ```

3.  使用目标属性，参见。doc [CMake 编译标志目标属性](http://www.cmake.org/cmake/help/v2.8.8/cmake.html#prop_tgt:COMPILE_FLAGS)，需要知道目标名称。

    ```
     get_target_property(TEMP ${THE_TARGET} COMPILE_FLAGS)
     if(TEMP STREQUAL "TEMP-NOTFOUND")
       SET(TEMP "") # Set to empty string
     else()
       SET(TEMP "${TEMP} ") # A space to cleanly separate from existing content
     endif()
     # Append our values
     SET(TEMP "${TEMP}${GCC_COVERAGE_COMPILE_FLAGS}" )
     set_target_properties(${THE_TARGET} PROPERTIES COMPILE_FLAGS ${TEMP} ) 
    ```

现在我使用方法2。

* * *

## 回答 #2

> 赞同：216
> 
> 时间：2015-02-27T20:07:24.550

[`target_compile_options`](http://www.cmake.org/cmake/help/v3.0/command/target_compile_options.html)在较新版本的 CMake 中，您可以分别使用和为单个目标设置编译器和链接器标志[`target_link_libraries`](http://www.cmake.org/cmake/help/v3.0/command/target_link_libraries.html)（是的，后者也设置链接器选项）：

```
target_compile_options(first-test PRIVATE -fexceptions) 
```

`PUBLIC`此方法的优点是您可以通过和控制选项传播到依赖此方法的其他目标`PRIVATE`。

从 CMake 3.13 开始，您还可以使用[`target_link_options`](https://cmake.org/cmake/help/git-stage/command/target_link_options.html)添加链接器选项，使意图更加清晰。

* * *

## 回答 #3

> 赞同：53
> 
> 时间：2012-08-02T19:27:56.100

尝试设置变量`CMAKE_CXX_FLAGS`而不是`CMAKE_C_FLAGS`：

```
set (CMAKE_CXX_FLAGS "-fexceptions") 
```

该变量`CMAKE_C_FLAGS`仅影响 C 编译器，但您正在编译 C++ 代码。

添加标志`CMAKE_EXE_LINKER_FLAGS`是多余的。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2020-08-21T17:30:48.877

指定工具链特定选项的首选方法是使用 CMake 的[工具链工具](https://cmake.org/cmake/help/latest/manual/cmake-toolchains.7.html)。这确保了以下之间的清晰划分：

*   关于如何将源文件组织成目标的说明——以*CMakeLists.txt*文件表示，完全与工具链无关；和
*   应如何配置某些工具链的详细信息 - 分为 CMake 脚本文件，可由项目的未来用户扩展，可扩展。

*理想情况下，您的CMakeLists.txt*文件中不应有编译器/链接器标志——即使在`if`/`endif`块中也是如此。并且您的程序应该使用默认工具链（例如 GNU/Linux 上的 GCC 或 Windows 上的 MSVC）为本地平台构建，而不需要任何额外的标志。

添加工具链的步骤：

1.  使用全局工具链设置创建一个文件，例如*arm-linux-androideadi-gcc.cmake ：*

    ```
    set(CMAKE_CXX_COMPILER arm-linux-gnueabihf-g++)
    set(CMAKE_CXX_FLAGS_INIT "-fexceptions") 
    ```

    [（您可以在此处](https://cmake.org/cmake/help/latest/manual/cmake-toolchains.7.html#cross-compiling-for-linux)找到示例 Linux 交叉编译工具链文件。）

2.  当您想使用此工具链生成构建系统时，请[`CMAKE_TOOLCHAIN_FILE`](https://cmake.org/cmake/help/latest/variable/CMAKE_TOOLCHAIN_FILE.html)在命令行中指定参数：

    ```
    mkdir android-arm-build && cd android-arm-build
    cmake -DCMAKE_TOOLCHAIN_FILE=$(pwd)/../arm-linux-androideadi-gcc.cmake .. 
    ```

    （注意：您不能使用相对路径。）

3.  正常构建：

    ```
    cmake --build . 
    ```

工具链文件使交叉编译更容易，但它们还有其他用途：

*   为您的单元测试提供强化诊断。

    ```
    set(CMAKE_CXX_FLAGS_INIT "-Werror -Wall -Wextra -Wpedantic") 
    ```

*   难以配置的开发工具。

    ```
    # toolchain file for use with gcov
    set(CMAKE_CXX_FLAGS_INIT "--coverage -fno-exceptions -g") 
    ```

*   加强安全检查。

    ```
    # toolchain file for use with gdb
    set(CMAKE_CXX_FLAGS_DEBUG_INIT "-fsanitize=address,undefined -fsanitize-undefined-trap-on-error")
    set(CMAKE_EXE_LINKER_FLAGS_INIT "-fsanitize=address,undefined -static-libasan") 
    ```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2018-04-11T14:29:07.673

您还可以使用以下属性将链接器标志添加到特定目标`LINK_FLAGS`：

```
set_property(TARGET ${target} APPEND_STRING PROPERTY LINK_FLAGS " ${flag}") 
```

如果您想将此更改传播到其他目标，您可以创建一个虚拟目标以链接到。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2021-04-18T23:48:10.427

当我需要一个名为“NO_DEBUG”的预编译定义时，这对我有用：

```
set(CMAKE_CXX_FLAGS "${CMAKE_CXX_FLAGS} -std=c++14 -DNO_DEBUG") 
```

然后从代码

```
#ifdef NO_DEBUG
..... 
```

# ruby - EventMachine 仅在额外按键后触发键盘处理程序的 receive_line

> ID：11783935
> 
> 赞同：4
> 
> 时间：2012-08-02T18:52:26.087
> 
> 标签：ruby, stdin, eventmachine

我这里有一个简单的键盘回显程序来测试 EventMachine，以及不使用 EM 编写的等效代码。似乎 EventMachine 仅在 Windows 上的附加按键之后触发 receive_line 方法。这是事件机器应用程序：

```
class KeyboardHandler < EM::Connection
  include EM::Protocols::LineText2

  def post_init
    prompt
  end

  def prompt
    print "> "
  end

  def receive_line line
    line.chomp!
    case(line)
    when /^exit$/ then
      EM.stop
    else
      puts line
      prompt
    end
  end
end
EventMachine.run {
  EventMachine.open_keyboard KeyboardHandler
} 
```

键入输入然后按 enter 将创建一个换行符，但键入的行不会回显到控制台，直到再次按下按键。
我创建了另一个片段来测试 Windows 控制台是否存在问题，只是没有刷新 STDIN 单元，另一个按键，但这正如人们所期望的那样，在每次返回按键后回显输入：

```
while line = STDIN.readline
  puts "Typed #{line}"
end 
```

关于为什么会发生这种情况的任何想法？我希望 EventMachine 在每次返回按键后立即触发 received_line。

# c# - 使用带有回发的 DbContext？

> ID：11783937
> 
> 赞同：3
> 
> 时间：2012-08-02T18:52:35.983
> 
> 标签：c#, asp.net, entity-framework

也许是一个简单的问题，但我找不到答案。我有一个 web 表单，我在其中声明了我的 dbContext。但是，当页面进行回发时，它会覆盖 dbContext 并且我会丢失对象跟踪。在我准备好处理它之前，如何保证 dbContext 不受更改的影响？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-02T18:55:07.090

使用 DbContext 的建议模式是为每个 HTTP 请求实例化一个新的 DbContext，并在该特定请求的持续时间内使用该实例。

您不应尝试跨 HTTP 请求保留 DbContext 的实例。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-02T19:14:40.353

**你不能`dbContext`在请求之间重用！**

使用的正确模式是为每个 HTTP 请求创建一个新对象（无论是否回发）

```
using (var context = new MyDbContext())
{
    ...
} 
```

**为什么？**
因为`DbContext`它是一个轻量级的结构，但更重要的是它不是线程安全的。

如果您想在回发中更新某些内容，请使用相同的模式，例如

```
object productId = //get it from request
using (var context = new MyDbContext())
{
    //that's your old product
    var product = context.Select(p=>p.Id == product.Id).FirstOrDefault();
} 
```

# javascript - 平滑滚动和突出显示的导航问题

> ID：11783938
> 
> 赞同：0
> 
> 时间：2012-08-02T18:52:37.373
> 
> 标签：javascript, jquery, menu, navigation, smooth-scrolling

在我的网站[http://goo.gl/34oQ8](http://goo.gl/34oQ8)上，我根据本教程[http://trevordavis.net/blog/jquery-one-page-navigation-plugin/](http://trevordavis.net/blog/jquery-one-page-navigation-plugin/)实现了平滑滚动和突出显示的导航， 没有“联系我们”项目，但不能使用它（只有“联系我们”菜单项​​被高亮显示）。你知道为什么吗？怀疑它链接到#inline ref - tks

```
<ul id="nav">
  <li class="current"><a href="#presentation">Home</a></li>
  <li><a href="#equipe">Team</a></li>
  <li><a href="#plan-activite">About us</a></li>
  <li><a href="#medias">Press</a></li>
  <li><a href="#inline" class="modalbox">Contact Us</a></li>
</ul> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-02T19:20:58.927

问题是单页导航插件没有处理隐藏元素。初始化时，它会使用以下行计算每个元素的垂直位置：

```
self.sections[linkHref] = Math.round(topPos) - self.config.scrollOffset; 
```

但是，您隐藏的 #inline 元素的垂直位置为 0，这会抛出当前部分检测代码。

您可以通过使其在页面加载时隐藏的内联元素的位置不为 0 来解决此问题。我建议不要对联系表单使用模式对话框 - 只需使用以 div 为中心的常规表单。

要在不更改代码的情况下查看修复，请使用 chrome 开发人员工具或类似工具在 jquery.nav.js 的第 126 行设置断点。然后，运行'this.sections.inline = 5000;' 在控制台中。删除断点，导航会正确更新。

# c# - 模拟用户

> ID：11783939
> 
> 赞同：-4
> 
> 时间：2012-08-02T18:52:46.057
> 
> 标签：c#, .net, active-directory

我试图冒充用户从我的网站进入需要广告凭据的网站。我知道用户 ID 已经不是密码了。我想知道代码中是否有一种方法可以连接到广告并仅使用用户 ID 模拟用户。

整个目的是允许代理登录服务。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-03T06:12:06.787

以-5票回答问题我有点紧张。我确实想指出存在这样的功能。它被称为[协议转换扩展](http://technet.microsoft.com/en-us/library/cc738207%28v=ws.10%29)。它也被称为[S4USelf](http://msdn.microsoft.com/en-us/magazine/cc188757.aspx)

Microsoft 发明了协议转换，因为 Active Directory 主要使用 Kerberos 进行身份验证。但是，在许多情况下，Kerberos 端口在 Internet 环境中被阻止。因此，应用程序不能使用 Kerberos 进行身份验证。对于 Web 应用程序尤其如此，通常只打开端口 80。为了解决这个问题，Microsoft 允许通过其他机制完成身份验证，例如，使用基于 ASP.NET 表单的身份验证。然后，代理服务器可以获取它刚刚使用自己的机制进行身份验证的任何用户的 Kerberos 票证。在此过程中，不需要 Active Directory 密码。但是，请注意，Microsoft 确实希望使用这种方法获取 Kerberos 票证的应用程序将对用户进行自己的身份验证。例如，您可能有一个存储一组用户名和密码的 SQL 服务器数据库。您的应用程序使用存储在 SQL Server 数据库中的用户名和密码进行身份验证，然后获取指定用户的 Kerberos 票证。

正如你们中的许多人指出的那样，如果这真的发生的话，这看起来像是一个很大的安全漏洞。这是精美的印刷品。为了使用协议转换方法获得 Kerberos 票证，您的进程必须具有**充当操作系统**特权的一部分。这是系统中非常高的特权。为了简单。如果您只是以普通 AD 用户帐户登录并尝试使用 Protocol Transistion 方法运行程序以获取域管理员票证，则它将无法正常工作，因为您没有**充当操作系统**特权的一部分。默认情况下，您的`NT Authority\LocalSystem`帐户将拥有此权限。因此，为了做到这一点，在许多情况下，您只需编写一个服务并将服务帐户设置为使用`NT Authority\LocalSystem`. 该服务将能够从 Active Directory 中获取您需要的任何 Kerberos S4USelf 票证。

等一下。你们中的许多人会说这仍然是一个安全漏洞，因为我可能是特定工作站机器上的本地管理员。然后，我可以安装我喜欢的任何服务。我可以自己创建一个服务并使用 S4USelf 获取域管理员票证并访问企业环境中的一些重要信息。嗯……这不是真的。Microsoft 使 S4USelf Kerberos 票证如此特殊，以至于它只能在请求票证的机器上使用。换句话说，您不能使用网络上的 S4USelf 票证来请求任何其他服务。这听起来更合理，对吧？访问仅限于该特定机器。是的，我知道仍然很难接受一个人可以在不知道密码的情况下冒充另一个用户帐户但该功能存在的事实。

沿着这条线，还有另一个疯狂的东西叫做[约束委派](http://technet.microsoft.com/en-us/library/cc738207%28v=ws.10%29). 它也被称为 S4UProxy。它基本上将这种模拟能力扩展到网络资源。这意味着使用 S4USelf 票证，您可以获得 S4UProxy 票证。使用 S4UProxy 票证，您可以使用模拟身份访问选定的网络资源，而无需向 Active Directory 提供任何密码。同样，这看起来很疯狂，但这里是细节。首先，默认情况下，所有加入 Active Directory 的机器都不能请求 S4UProxy 票证。域管理员必须在计算机对象上打开一个标志，以便有意识地发生这种情况。域管理员应该很清楚，授予这个基本上就像说我将这台机器视为域中的域控制器。它握着王国的钥匙。其次，并不是所有的服务都可以通过 S4UProxy 方式获得。域管理员可以通过在计算机对象上指定 SPN 来明确选择允许哪些服务使用 S4UProxy。这就是为什么它得名约束委派。它看起来很疯狂，但实际上并没有那么糟糕。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-02T18:57:34.603

从来没听说过。AD 中的安全性（通常）设置为防止未经授权的访问，因此您不得不

*   从用户那里获取密码。
*   创建一个“假”用户进行测试。
*   暴力破解密码。

当然，暴力破解密码/帐户不是一个很好的方法，除非它是您自己的网络并且对您自己没有法律后果。

理想情况下，我建议创建一个假用户进行测试。

希望有帮助。

# java - JLabel 不会显示图像

> ID：11783940
> 
> 赞同：4
> 
> 时间：2012-08-02T18:52:48.023
> 
> 标签：java, swing, jbutton, jlabel

我正在使用 Java 创建一个井字游戏。现在，我有它，所以当您单击一个按钮时，该按钮`JButton`将从 中删除，将添加`JPanel`一个`JLabel`包含 X 或 O 图像的按钮，然后`JPanel`重新绘制 。但是，当我单击按钮时，图像不会显示，但按钮会消失。

创建按钮和`JLabel`/ `Image`：

```
package tictactoe;
import javax.swing.*;
import java.awt.*;
import java.awt.event.*;
import javax.swing.ImageIcon;

public class TicTacToe implements ActionListener
{
private JFrame holder = new JFrame();
private GridLayout layout = new GridLayout(3,3);
private FlowLayout panel = new FlowLayout(FlowLayout.CENTER);
private JPanel p11, p12, p13, p21, p22, p23, p31, p32, p33;
private JButton b1, b2, b3, b4, b5, b6, b7, b8, b9;
private ImageIcon iconX = new ImageIcon("iconX.png");
private JLabel xLabel = new JLabel(iconX);
private ImageIcon iconO = new ImageIcon("iconO.png");
private JLabel oLabel = new JLabel(iconO);
private int turn;
private char s1, s2, s3, s4, s5, s6, s7, s8, s9;

public TicTacToe()
{
    paint();
}

private void paint()
{
    holder.setLayout(layout);
    holder.setSize(300,300);

    b1 = new JButton("1");
    p11 = new JPanel();
    p11.setLayout(panel);
    p11.add(b1);
    holder.add(p11);

    //Same block of code for the next 8 buttons/panels inserted here

    holder.setVisible(true);

    b1.addActionListener(this);
    //Other action listeners inserted here

}
@Override
public void actionPerformed(ActionEvent e)
{
    if (e.getSource() == b1)
    {
        ++turn;
        p11.remove(b1);
        if (turn % 2 == 1) { s1 = 'x'; p11.add(xLabel); }
        else if (turn % 2 == 0) { s1 = 'o'; p11.add(oLabel); }
        p11.repaint();
    }
    //Other action events inserted here
}
public static void main(String[] args) 
{
    TicTacToe game = new TicTacToe();
}
} 
```

![问题图片](../Images/b652106faaf7275168b054a4de1f8dc1.png)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-02T18:55:48.397

尝试在您的 s 实例上调用`revalidate();`then ，如下所示：`repaint();``JPanel`

```
 p11.revalidate();
        p11.repaint(); 
```

当`Component`添加或删除 a 时，有必要调用`revalidate()`此调用是一条指令，告诉 a`LayoutManager`根据新`Component`列表进行重置。`revalidate()`将触发`repaint()`对组件认为是“脏区”的调用。显然，并非您的所有区域`JPanel`都被`RepaintManager`.

`repaint()`用于告诉组件重新绘制自己。通常情况下，您需要调用它来清理像您这样的条件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-02T19:07:07.017

```
@Override
public void actionPerformed(final ActionEvent e)
{
    SwingUtilities.invokeLater(new Runnable() {
        @Override
        public void run() {
            if (e.getSource() == b1) {
                ++turn;
                p11.remove(b1);
                if (turn % 2 == 1) { s1 = 'x'; p11.add(new JLabel(iconX)); }
                else { s1 = 'o'; p11.add(new JLabel(iconO)); }
                //p11.revalidate();
                //p11.repaint();
            }
            **Other action events inserted here
        }
    });
} 
```

**invokeLater**构造的语法有点多，但让事件处理线程处理按钮单击，然后*再*进行更改。否则，您不能依赖立即重新绘制，并且 gui 的响应速度会降低。*（Runnable 对象只能从外部访问**final**变量，即：不再分配的变量。）*

组件之类`JLabel`的父组件有一个字段。因此，不能重用一个组件。因此`new JLabel()`.

关于重新粉刷；总是先尝试它而不自己触发它。

# asp.net - 当缺少必需的属性时，如何从自定义服务器控件中抛出 HttpParseException？

> ID：11783941
> 
> 赞同：0
> 
> 时间：2012-08-02T18:52:52.413
> 
> 标签：asp.net, webforms, custom-server-controls

我的服务器控件需要通过这样的标记设置一些属性：

```
<cc:MyControl runat="server" Property="Required" /> 
```

当开发人员忘记添加属性时，我会抛出异常。这发生在公共财产的吸气剂中：

```
public string Property
{
  get { return GetRequiredPropertyFromViewState["Property"]; }
  set { ViewState["Property"] = value; }
} 
```

在 YSOD 中，我得到一个源错误和堆栈跟踪。显示的源是我的自定义控件类的源：

> ```
> Line 173:   throw new ArgumentException(message); 
> ```

我想将控件的标记显示为源错误。那可能吗？

我只知道WebForms页面解析器有时会在源错误中显示带有标记的解析错误。~~但这些实际上并不是例外。~~

编辑：我错了。可以使用[HttpParseException](http://msdn.microsoft.com/en-us/library/system.web.httpparseexception.aspx)引发解析错误。但是您已经指定了文件、源代码和行号。我不知道我是否可以从我的自定义控件中提供这些。我需要这三个，其中我不知道如何获得最后两个：

1.  virtualPath：我可以从 Page.Request.AppRelativeCurrentExecutionFilePath 获得
2.  资源：
3.  线：

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-03T08:07:59.973

我发现您不能从控件本身执行此操作，因为一旦它被初始化，它就无法返回解析器基础结构。

但是您可以将[控件生成器类](http://msdn.microsoft.com/en-us/library/system.web.ui.controlbuilder.aspx)与您的服务器控件相关联。该类参与页面的解析。如果您`HttpParserException`仅从 Init 方法抛出错误消息，则框架会添加代码和控件标记的行。

我想出了这个方法来验证基于数据注释所需的属性：

```
private void ValidateAttribute(PropertyInfo attribute, object value)
{
  // Reflect all the data annotations' validator attributes on the control property...
  object[] validators = attribute.GetCustomAttributes(typeof(ValidationAttribute), false);

  // ...and validate each one
  foreach (ValidationAttribute validator in validators)
  {
    try
    {
      validator.Validate(value, attribute.Name);
    }
    catch (ValidationException exception)
    {
      // Show as parser error in browser
      throw new HttpParseException(exception.Message);
    }
  }
} 
```

调用它[`ControlBuilder.Init()`](http://msdn.microsoft.com/en-us/library/system.web.ui.controlbuilder.init.aspx)并使用[`ControlBuilderAttribute`](http://msdn.microsoft.com/en-us/library/system.web.ui.controlbuilderattribute.aspx).

# mpi - 带有 MPI 的 FFTW3 1D 变换很慢

> ID：11783943
> 
> 赞同：0
> 
> 时间：2012-08-02T18:53:00.550
> 
> 标签：mpi, fft, fftw

我正在使用 MPI 测试 FFTW 1D c2c 变换。在 FFTW3 教程上编译并运行 2D 示例后，我发现使用 8 个节点的执行速度比仅使用一个节点（使用 4096x4096 等大尺寸）快 2 倍。

所以我将这个示例修改为 1D，但出现了问题，因为我看到了这个时间：

```
1 node  = 0.763668 s
2 nodes = 1.540884 s
4 nodes = 1.336446 s
8 nodes = 0.851646 s 
```

我的代码：

```
 #include <fftw3-mpi.h>
    # include <stdlib.h>
    # include <stdio.h>
    #include <sys/stat.h>
    #include <fcntl.h>
    # include <time.h>
    #include <math.h>

    int main(int argc, char **argv)
    {
       //const ptrdiff_t N0 = 4096;
       const ptrdiff_t N0 = 4194304 ;
       //const ptrdiff_t N0 = 8388608;
       fftw_plan planForw,planBack;
       fftw_complex *data,*dataOut,*data2;
       ptrdiff_t alloc_local, local_ni, local_i_start, i, j,local_no, local_o_start;
       int index,size;
       double startwtime, endwtime;
       MPI_Init(&argc, &argv);
       fftw_mpi_init();
       MPI_Comm_rank(MPI_COMM_WORLD,&index);
       MPI_Comm_size(MPI_COMM_WORLD,&size);

       /* get local data size and allocate */
       alloc_local = fftw_mpi_local_size_1d(N0, MPI_COMM_WORLD,FFTW_FORWARD, FFTW_ESTIMATE,
                                                  &local_ni, &local_i_start,&local_no, &local_o_start);
       data = fftw_alloc_complex(alloc_local);
       dataOut = fftw_alloc_complex(alloc_local);
       data2 = fftw_alloc_complex(alloc_local);
             /* create plan  */
       planForw = fftw_mpi_plan_dft_1d(N0, data, data2, MPI_COMM_WORLD,
                                         FFTW_FORWARD, FFTW_ESTIMATE);
       planBack = fftw_mpi_plan_dft_1d(N0, data2, dataOut, MPI_COMM_WORLD,
                                         FFTW_BACKWARD, FFTW_ESTIMATE);
       /* initialize data to some function my_function(x,y) */
       for (i = 0; i < local_ni; ++i) 
       {
        data[i][0] =rand() / (double)RAND_MAX;
        data[i][1] =rand() / (double)RAND_MAX;
       }
       if(index==0){
        startwtime = MPI_Wtime();

        }

        fftw_execute(planForw);
        fftw_execute(planBack);
        if(index==0){
        endwtime = MPI_Wtime();
            printf("wall clock time = %f\n",
                           endwtime-startwtime);

       }

             fftw_destroy_plan(planForw);
         fftw_destroy_plan(planBack);
             MPI_Finalize();
} 
```

# html - CSS Html 显示内联

> ID：11783951
> 
> 赞同：0
> 
> 时间：2012-08-02T18:53:35.107
> 
> 标签：html, css

对 css 有一个小问题，这个网站上的新问题，想知道是否有人可以帮助我 :)，

我正在尝试让菜单图像彼此相邻显示，但目前它们仍显示在彼此下方。

这是它的 css，我知道有些没有被使用，但我目前正在尝试遵循一个教程：[http ://css-tricks.com/video-screencasts/13-converting-a-photoshop-样机第二部分第二集/](http://css-tricks.com/video-screencasts/13-converting-a-photoshop-mockup-part-two-episode-two/)

我在 14 分 23 秒..

这是我的CSS

```
 * { margin: 0; padding: 0; }
 html { overflow-y: scroll; }
 body { font: 62.5% "Helvetica", sans-serif;
 background: url(body-bg.jpg) top left repeat;}

ul { list-style: none inside; }
p { font-size: 1.2em; line-height: 1.2em; margin-bottom: 1.2em; }
a { outline: none; }
a img { border: none; }
/* END RESET */

/* TOOLBOX */
.floatleft { float: left; }
.floatright { float: right; }
.clear { clear: both; }
/* END TOOLBOX */

/* STRUCTURE AND STUFF */
#page-wrap {
width: 654px;
margin: 0 auto;
}

ul#nav {

}
ul#nav li{
    display: inline;
    }
    ul#nav li a {
        display: block;
        height: 62px;
        text-indent:-99999px

}
ul#nav li.articles a {
    width: 200px;
    background:url(nav-articles.jpg)bottom center no-repeat;
    }

ul#nav li.downloads a {
    width:287px;
    background:url(nav-downloads.jpg)bottom center no-repeat;
}
ul#nav li.videos a {
    width:167px;
    background:url(nav-videos.jpg)bottom center no-repeat;
}

/* END STRUCTURE */ 
```

这是我的html

```
<body>

<div id="page-wrap">

<img src="header.jpg" alt="mockup header" />

    <ul id="nav">
        <li class="articles"><a href="#">Articles</a></li>
        <li class="videos"><a href="#">Videos</a></li>
        <li class="downloads"><a href="#">Downloads</a></li>
    </ul>

<p>Main Content</p> 

<div id="sidebar">
</div>    

</div>

<div id=footer">
</div>

</body> 
```

再次感谢任何帮助！！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-02T19:01:00.580

我相信将 li 中的 a 标签设置为 display: block 正在这样做。我建议从以下位置删除 display:block：

```
ul#nav li a {
        display: block;
        height: 62px;
        text-indent:-99999px

} 
```

或者，您可以在该声明中添加 float:left - 这就是我看到您的声明与您发布的链接中的代码之间的区别的地方。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-02T19:02:42.480

更改为`display: inline-black`并添加`white-space: nowrap;`（nowrap 可防止换行，但您可能不需要此操作，具体取决于您正在执行的操作）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-02T19:03:00.980

摆脱`display: block;`在`ul#nav li a`

你可以在这里看到它是如何影响它的：http: [//jsfiddle.net/aWNbC/](http://jsfiddle.net/aWNbC/)

# android - Android 应用程序在等待 HTTP 响应时显示黑屏

> ID：11783952
> 
> 赞同：0
> 
> 时间：2012-08-02T18:53:37.633
> 
> 标签：android, http, camera

我一直在尝试开发一个 Android 应用程序，它可以让用户拍照，然后通过 HTTP 发送图像。我正在使用本机相机。

用户拍照并点击保存按钮后，我在应用程序发送信息并等待响应时出现黑屏。我宁愿显示一个进度对话框，但无论我尝试什么，黑屏都会停留在那里，并且只有在获得响应并点击后退按钮后才能看到进度对话框。我尝试使用 setContentView() 无济于事。线程用于 HTTP 请求。

这是相机开始和结束的代码：

```
protected void startCameraActivity()
{

    File file = new File( _path );
    Uri out = Uri.fromFile( file );

    Intent intent = new Intent(MediaStore.ACTION_IMAGE_CAPTURE );
    intent.putExtra( MediaStore.EXTRA_OUTPUT, out );

    startActivityForResult( intent, 0 );
}

protected void onActivityResult(int requestCode, int resultCode, Intent data) 
{   
    switch( resultCode )
    {
    case 0:
        break;

    case -1:
        m_ProgressDialog = ProgressDialog.show(MainActivity.this, "Please wait...", "Uploading data ...", true, true);
        onPhoto();
        break;
    }
}

protected void onPhoto()
{
    taken = true;

    PipedOutputStream pos = new PipedOutputStream();
    PipedInputStream pis = null;
    try {
        pis = new PipedInputStream(pos);
    } catch (IOException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    }
    Sender sender = new Sender(pos);
    Receiver receiver = new Receiver(pis);
    sender.start();
    receiver.start();
    try {
        sender.join();
        receiver.join();
        try {
            field.setText(receiver.getIn().readUTF());
        } catch (IOException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        }
    } catch (InterruptedException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    }

    try {
        pis.close();
        pos.close();
    } catch (IOException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    }

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-02T19:02:09.907

查看此链接：[如何使用异步任务将文件上传到服务器？](https://stackoverflow.com/questions/10814957/how-can-i-use-async-task-while-uploading-a-file-to-the-server)

您可以在`onPreExecute()`图像处理过程中定义要显示的内容（进度条、微调器...）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-02T19:29:37.437

您可以在任务执行时使用 AsyncTask 并显示 ProgressDialog

```
 private class YourTask extends AsyncTask {
        private ProgressDialog dialog;

        private GetNewsTask(Context context) {
            this.dialog = new ProgressDialog(context);
        }

        @Override
        protected void onPreExecute() {
            this.dialog.setMessage(getResources().getString(R.string.loading));
            this.dialog.show();
        }

        @Override
        protected Object doInBackground(Object... objects) {
            // your hard work
            return something;
        }

        @Override
        protected void onPostExecute(Object result) {
            if (this.dialog.isShowing()) this.dialog.dismiss();
            // hanle results

        }

    } 
```

# sql-server-2005 - 替换 Case 语句

> ID：11783957
> 
> 赞同：0
> 
> 时间：2012-08-02T18:53:50.197
> 
> 标签：sql-server-2005, function, view, case

我有一个函数可以使用两个 case 语句在视图之外工作。问题是由于这个 case 语句，运行该函数需要 25 秒以上。因为它应该只需要大约 3 秒（与具有不调用 case 语句的视图的相同函数相比。）

case 语句在 select 中完成。

有趣的是（对我来说），如果我将其中一个案例陈述更改为直接的内容，即 D.CARS 而不是

```
CASE WHEN D.CAR IS NOT NULL 
THEN D.CAR              
ELSE C.CAR
END AS CAR, 
```

然后它会加速约 3 秒来运行该功能，但会显示一些关闭的结果。因此，如果 select 语句中有两个 case 语句，似乎只需要 25 秒。

无论案例语句的数量如何，视图的填充时间都不会少于 1 秒。

有没有办法加快速度，同时仍然获得正确的结果？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-02T18:57:10.143

`CASE`为什么不使用表达式而不是表达式`COALESCE`？

```
COALESCE(D.CAR, C.CAR) AS CAR 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-08-02T18:57:36.000

您是否尝试过使用函数而不是 case 语句？

# java - 如何防止 <%@page... %> 属性添加

> ID：11783958
> 
> 赞同：1
> 
> 时间：2012-08-02T18:53:54.300
> 
> 标签：java, jsp

我的 JSP 看起来类似于以下内容...

```
<%@page import "java.util.ArrayList"%>
<%@page import "java.util.List%>
<%@page contentType="application/json" pageEncoding="UTF-8"%>
<%
   ...
%> 
```

每个 <%%> 都会产生一个额外的新行...如何防止这种情况发生而不必将所有 %><% 粘合在一起？这导致 3+ 新行（几乎每个导入一个）。如果我将所有导入混合在一起，它仍然会留下至少一个新行。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-02T19:01:21.250

如果您使用 JSP 2.1 或更高版本，您可以使用：

```
<%@ page trimDirectiveWhitespaces="true" %> 
```

对于旧版本，如果您使用的是 tomcat(!)，则可以使用：

```
<init-param>
    <param-name>trimSpaces</param-name>
    <param-value>true</param-value>
</init-param> 
```

在您的 web.xml 中。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-02T19:03:24.927

您可以将它们“粘合”`%><%`在一起，但在单个指令中有新行：

```
<%@page import "java.util.ArrayList"
%><%@page import "java.util.List"
%><%@page contentType="application/json" pageEncoding="UTF-8"%> 
```

# python - 在python中设置环境变量以运行程序

> ID：11783963
> 
> 赞同：1
> 
> 时间：2012-08-02T18:54:11.287
> 
> 标签：python, visual-studio

我正在运行视觉工作室，并运行我通常只是点击的程序`ctrl+F5`。现在我正在尝试编写一个 python 脚本来运行这个具有几种不同配置的程序。

到目前为止，我有类似的东西

```
cmd = "mycmd.exe arg1 arg2"
os.system(cmd) 
```

但这会失败并显示一条消息`ERROR: environment variable TZ not set correctly`。我检查了Visual Studio和属性窗口，在调试选项卡的配置下，有一个`TZ`变量设置，

```
Enviroment   TZ=XXX 
```

如何告诉 python 在运行程序时使用相同的设置？是`os.system`运行此程序的最佳解决方案还是有更好的选择？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-02T18:59:27.227

```
import os
os.environ['FOO'] = 'bar' 
```

Python 会自动调用底层的 os.putenv() 方法

[http://docs.python.org/library/os.html#os.putenv](http://docs.python.org/library/os.html#os.putenv)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-03T13:27:49.463

我在@Maulwurfn 回答后发现的另一种选择如下

```
import subprocess
import os

my env = os.environ
my_env['TZ'] = 'XXX'
p = suprocess.Popen(cmd, shell=True, env=my_env)

while p.poll() is None:
  time.sleep(2) 
```

如果我不添加 while 循环，所有配置几乎同时开始运行。

# ajax - phonegap 使用带有 ajax 的 web 服务

> ID：11783965
> 
> 赞同：0
> 
> 时间：2012-08-02T18:54:17.560
> 
> 标签：ajax, web-services, cordova

我正在使用 ajax 来使用我的网络服务。这是我的 code.js ：

```
//button
$('#my_btn').live('click touchstart', function() {
   GetData();
});

function GetData() {    
    $.ajax({
        type: "POST",
        url: "http://www.safetrace.com.br/safefrigorifico/services/ServicoConsulta.jws?op=consultarDados",
        //url: "http://www.safetrace.com.br/safefrigorifico/services/ServicoConsulta.jws/consultarDados",
        //data: {},
        //contentType: "application/json; charset=utf-8",
        dataType: "json",
        beforeSend : function(jqXHR, settings) {
        alert("1)\njqXHR= " + jqXHR + "\njqXHR.status= " + jqXHR.status + "\njqXHR.readyState= " + jqXHR.readyState + "\nsettings= " + settings);
        },
        success: function(msg) {
           alert("2)\n" + msg);
        },
        error: function (jqXHR, textStatus, errorThrown) {
            alert("3)\njqXHR= " + jqXHR + "\ntextStatus= " + textStatus + "\nerrorThrown= " + errorThrown + "\njqXHR.status= " + jqXHR.status + "\njqXHR.readyState= " + jqXHR.readyState);
        },
        complete : function(jqXHR, textStatus) {
            alert("4)\njqXHR= " + jqXHR + "\ntextStatus= " + textStatus + "\njqXHR.status= " + jqXHR.status + "\njqXHR.readyState= " + jqXHR.readyState);
        }

    });

} 
```

和我的 index.html：

```
<html>
  <head>
    <meta charset="utf-8" />

    <link rel="stylesheet" type="text/css" href="css/style.css" />        

    <script type="text/javascript" src="plugin/jquery-1.7.2.js" ></script>        
    <script type="text/javascript" charset="utf-8" src="plugin/cordova-1.8.0.js"></script>

  </head>

  <body>

    <div id="my_btn"></div>  

  </body>
</html> 
```

当我跑步时，我得到的只是“错误！”

任何人都知道如何使用 ajax 来使用 phonegap 来使用 web 服务？

我知道它可能，但我不知道该怎么做！=/

phonegap 常见问题解答：

> 问：我想为 phonegap 创建一个应用程序，以通过 AJAX 访问外部部署的 Web 服务。如何解决 XmlHttpRequest 的跨域安全策略问题？
> 
> A. 跨域安全策略不影响PhoneGap应用。由于 html 文件由 webkit 使用 file:// 协议调用，因此安全策略不适用。（在 Android 中，您可以通过编辑 AndroidManifest.xml 将 android.permission.INTERNET 授予您的应用程序）

错误打印：[https ://lh3.googleusercontent.com/CJZg3rn3FDKEWHDfrwzRaMbwwQCTg7vYm_5mSba6r006L6eTcbhvRKZyPWNbRsrMaRtDGv-IESw](https://lh3.googleusercontent.com/CJZg3rn3FDKEWHDfrwzRaMbwwQCTg7vYm_5mSba6r006L6eTcbhvRKZyPWNbRsrMaRtDGv-IESw)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-02T18:58:41.333

首先，您的网址似乎是错误的。将它粘贴到浏览器让我：

> 404 在此服务器上未找到请求的 URL /safefrigorifico/services/ServicoConsulta.jws/consultarDados。

修复该问题后，您可以尝试使用 a，`GET`因为您没有发布任何数据并删除`contentType`. 此外，jQuery`.getJSON()`进一步简化了这一点。

### 消除：

```
data: {},
contentType: "application/json; charset=utf-8", 
```

### 改变：

```
type: "GET", 
```

### 或尝试：

```
var jqxhr = $.getJSON( 'http://www.safetrace.com.br/safefrigorifico/services/ServicoConsulta.jws/consultarDados', 
    function() { alert( 'success' ); } )
    .error( function() { alert( 'error' ); } ); 
```

# javascript - 删除的行不断回来

> ID：11783966
> 
> 赞同：0
> 
> 时间：2012-08-02T18:54:18.167
> 
> 标签：javascript, html, row

我无法从表中删除一行。它成功删除了，但在重新使用后，已删除的项目重新出现在我的表格顶部。看起来它以某种方式没有被完全删除。我不经常使用 Javascript/html，所以我不知道为什么。任何见解表示赞赏！

```
 function deleteRow(toDelete) {
        var table = document.getElementById("Table");
        var i = 0;
        alert(table.rows.length + "todelete=" + toDelete);
        for (i = 0; i < table.rows.length; i++) {
            if (table.rows[i].cells[4].innerText == toDelete) {
                alert('Deleting Row' + i);
                table.deleteRow(i);
                i--;
            }
        }
        ReSortTable('Table');
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-02T18:59:24.590

我认为这不会解决您的问题[注释代码过多]，但不是在删除行时减去一个，而是在相反的方向循环。

```
function deleteRow(toDelete) {
    var table = document.getElementById("Table");
    var i;
    alert(table.rows.length + "todelete=" + toDelete);
    for (i = table.rows.length-1; i >= 0 ; i--) {
        if (table.rows[i].cells[4].innerText == toDelete) {
            alert('Deleting Row' + i);
            table.deleteRow(i);                
        }
    }
    ReSortTable('Table');
} 
```

# unit-testing - Visual Studio 2012 RC - 构建后运行单元测试 - 指定要运行的测试类别

> ID：11783969
> 
> 赞同：5
> 
> 时间：2012-08-02T18:54:35.357
> 
> 标签：unit-testing, nunit, visual-studio-2012, test-runner

在 VS2012（RC，即将成为 RTM）中，是否可以选择在每次构建后运行的（nunit）单元测试？我喜欢这个功能，但我有两个测试类别/程序集——一个用于预期快速运行的实际单元测试，另一个用于数据库方案和测试生成数据。我不想在每次构建后都运行后者，但我想将此功能用于常规单元测试。有什么方法可以指定类别/程序集/等。应该在成功构建后执行？谢谢太平绅士

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-06T20:12:58.043

@Gishu 是正确的。如果您将过滤器应用于测试资源管理器，则运行器在选择要运行的测试时将使用该过滤器列表的结果。

我们将继续通过RTM 和post-RTM 向Test Explorer 添加额外的过滤器选项（例如类别、项目等）。请继续关注这方面的更多信息。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-03T10:49:02.530

在测试资源管理器窗口中，有一个搜索框。您可以指定过滤器 - 一个看起来很有希望的过滤器称为 TestFilePath 过滤器。（下拉查看可用的过滤器）

例如 FilePath:"Transaction" 仅过滤 Transactions.cs 文件中的测试。您可以使用它来排除其他程序集中的测试，例如，如果文件夹是单元和数据库。指定 FilePath:"Unit" 应该可以工作。试试看..

[文档：在此处的页面](http://msdn.microsoft.com/en-us/library/tfs/hh270865%28v=vs.110%29.aspx#bkmk_filtering_the_test_list "Filtering the Test list")上搜索“过滤”

# glut - FreeGlut“glutMotionFunc”操作

> ID：11783971
> 
> 赞同：0
> 
> 时间：2012-08-02T18:54:39.540
> 
> 标签：glut, freeglut

我是过剩编程的新手。我只想创建一个窗口并显示鼠标的坐标（在窗口内）。当我按下鼠标按钮（在窗口内）并且光标在窗口外时，glutMotionFunc处于活动状态是正常的吗？如果不是我错在哪里？我在这里发布代码：

```
int lbuttonDown = 0;

void renderScene(void)          //esegue ogni volta che la finestra deve essere ridisegnata
{
 glClear(GL_COLOR_BUFFER_BIT | GL_DEPTH_BUFFER_BIT);

glutSwapBuffers();
}

void entrata_uscita (int state)
{
  if ((state==GLUT_ENTERED))
  {
 printf("DENTRO\n");//playback;  se va fuori continuo la riproduzione con i coefficienti attuali
  }
  else
  {printf("FUORI\n");}
 }

 void processMouseActiveMotion(int x, int y) 
 {
  printf("Mouse premuto mosso a x=%d e y=%d\n",x,y);
 }

 void processMousePassiveMotion(int x, int y)
 {
  printf("Mouse mosso a x=%d e y=%d\n",x,y);
 }

 void playback()
 {

 }

 void processMouse(int button, int state, int x, int y)
 {
 if ((state == GLUT_DOWN) && (button == GLUT_LEFT_BUTTON))
 {
   printf("Mouse premuto a x=%d e y=%d\n",x,y);
       lbuttonDown=1;
 }
 else
 {
   lbuttonDown=0;
 }  
 }

//Main program
int main(int argc, char **argv)
{
// init GLUT and create Window
glutInit(&argc, argv);
glutInitDisplayMode(GLUT_SINGLE | GLUT_RGB );
glutInitWindowPosition(300,20);
 glutInitWindowSize(500,500);
glutCreateWindow("Variation");

// register callbacks
glutDisplayFunc(renderScene);
//quando l'applicazione è inattiva (nessun evento) (eseguire il suono)
glutIdleFunc(playback);
glutMouseFunc(processMouse);                        //Detecting Mouse Clicks
glutMotionFunc(processMouseActiveMotion);           //movimento con un pulsante premuto
glutPassiveMotionFunc(processMousePassiveMotion);   //movimento senza premere i tasti
glutEntryFunc(entrata_uscita);

// enter GLUT event processing cycle
glutMainLoop();
return 0;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-15T01:37:27.860

是的，听起来是正确的。如果您想要不同的行为，您可能应该使用[glutMouseFunc](http://www.opengl.org/resources/libraries/glut/spec3/node50.html)和[glutPassiveMotionFunc](http://www.opengl.org/resources/libraries/glut/spec3/node51.html)的组合。

# java - 用于android的xml中的按钮动画

> ID：11783975
> 
> 赞同：0
> 
> 时间：2012-08-02T18:54:41.820
> 
> 标签：java, android, xml, animation

当我的活动开始时，我无法让我的按钮动画运行，我在这里有点新，任何建议都将不胜感激。这是我在活动开始时所拥有的......

```
 // this is flag for home key press
public static boolean isHome = false;

@Override
protected void onCreate(Bundle savedInstanceState) {
    // TODO Auto-generated method stub
    super.onCreate(savedInstanceState);
    requestWindowFeature(Window.FEATURE_NO_TITLE);
    getWindow().setFlags(WindowManager.LayoutParams.FLAG_FULLSCREEN,
    WindowManager.LayoutParams.FLAG_FULLSCREEN);
    setContentView(R.layout.press);
    setRequestedOrientation(ActivityInfo.SCREEN_ORIENTATION_PORTRAIT);

    // init data
    init();

    // start player display
    start(10000 * 60 * 60 * 24);

    spin++;

    // play background music
    playmp3(R.raw.press);
 }
//HERE IS THE WORKING VERSION THAT WAS CORRECTED BY THE ANSWER BELOW
 public void onWindowFocusChanged(boolean hasFocus) {
     super.onWindowFocusChanged(hasFocus);

     if(hasFocus) {
     final Button b_1 = (Button) findViewById(R.id.bttest);
         b_1.setBackgroundResource(R.drawable.animation);
         AnimationDrawable b1Amin = (AnimationDrawable) b_1.getBackground();
     b1Amin.start();
    }
 } 
```

这是我的可绘制文件中的animation.xml

```
<animation-list xmlns:android="http://schemas.android.com/apk/res/android"
  android:oneshot="false">
<item android:drawable="@drawable/btn1" android:duration="100" />
<item android:drawable="@drawable/btn2" android:duration="100" />
<item android:drawable="@drawable/btn3" android:duration="100" />
<item android:drawable="@drawable/btn4" android:duration="100" />
<item android:drawable="@drawable/btn5" android:duration="100" />
<item android:drawable="@drawable/btn6" android:duration="100" />
<item android:drawable="@drawable/btn7" android:duration="100" />
<item android:drawable="@drawable/btn8" android:duration="100" />

</animation-list> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-02T19:13:26.623

的[API 文档](http://developer.android.com/reference/android/graphics/drawable/AnimationDrawable.html#start%28%29)`AnimationDrawable#start()`明确指出不应调用它，因为`onCreate(Bundle)`尚未`AnimationDrawable`将其附加到窗口。遵循文档中的建议并调用`start()`from `onWindowFocusChanged(boolean)`。

# linux - 是帧数=页数（linux）？

> ID：11783981
> 
> 赞同：3
> 
> 时间：2012-08-02T18:55:11.003
> 
> 标签：linux, linux-kernel, paging, virtual-address-space

我正在研究linux设备驱动程序，发现页数等于帧数。每个页面映射到每个帧。它说就像每当程序需要内存时它都会分配页面。

但是在操作系统书籍中，我发现虚拟地址分为页面，这些页面被加载到框架中。那么页面数如何等于框架？

以上哪个是正确的？linux如何在页表中存储有关虚拟、页面、框架映射的信息？

我完全糊涂了。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-08-03T06:39:51.210

**物理页面**被称为`page frames`（你可以称它们为框架）。该术语是为**虚拟内存中的页面**`page`保留的。

 **虚拟内存被内核分成大小相等的块。物理内存也被划分为相同大小的页面（页框）。

例如，如果我们有 4GB 的 RAM，在 32 位架构上，这意味着：1048576 个大小为 4KB 的页面帧

让我们继续，

内核为每个页框（物理页）维护一个结构`struct page`。这个结构在`linux/mm_types.h`（[https://github.com/torvalds/linux/blob/master/include/linux/mm_types.h](https://github.com/torvalds/linux/blob/master/include/linux/mm_types.h)）中定义，这个结构包含一个名为`mapping`（`struct address_space *mapping`）的成员，它指定页框所在的地址空间位于。还有一个名为的成员`index`表示此映射内的偏移量。

所有结构页面都保存在全局`mem_map`数组中，内核使用该数组来了解虚拟内存和物理内存之间的所有关联。

最后，要将虚拟地址转换为物理地址，内核使用`virt_to_page()`定义的宏`asm-i386/page.h`指向`pfn_to_page`（[https://github.com/torvalds/linux/blob/master/include/asm-generic/memory_model.h](https://github.com/torvalds/linux/blob/master/include/asm-generic/memory_model.h)）。

在举个例子之前，让我们看看 32 位架构中的地址布局

| 10 位 - 目录 | 10 位 - 页表 | 12 位 - 偏移 |

让我们看一个将内存虚拟地址转换为物理地址的示例：

[http://img11.imageshack.us/img11/9426/pagingexample.png](http://img11.imageshack.us/img11/9426/pagingexample.png)

希望这有帮助。

问候。**

# javascript - javascript toUpperCase 在 Firefox 中不起作用

> ID：11783982
> 
> 赞同：0
> 
> 时间：2012-08-02T18:55:13.697
> 
> 标签：javascript, asp.net, firefox

目前我正在尝试在 javascript 方法的文本框中强制大写。此方法设置为在“按键”事件上调用以进入文本框。

这是我通过 IE 和 FF 检测更改为大写的方法。

```
 //some code to detect the kind of key pressed based on numeric value, 
          //if lowercase detected then continue

        var key; 
        if(window.event){ //working IE code                     
                //key = window.event.keyCode;
                window.event.keyCode-=32;
        }

        else if(e){ //broken FF code
                key = String.fromCharCode(keycode).toUpperCase()
                e.value = e.value.toUpperCase();
        } 
```

此当前代码表示 e.value 在 firebug 中未定义。如果我只尝试 e.toUpperCase() 萤火虫说 toUpperCase 不存在。我尝试将 e.value 设置为 'key'，它不会返回错误但不会更改为大写。我曾尝试直接更改 e.which 但当然，它是只读的，并返回这样的错误。

我到底在这里想念什么？我相信无论我在这里更改什么，e.which 仍然设置为小写值，并且因为我无法以任何方式对其进行编辑，所以问题在于原始的小写 e.which 字符被推送到文本框。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-02T19:06:09.480

[KeyEvent](https://developer.mozilla.org/en/DOM/KeyboardEvent)没有`value`属性。您可能希望使用[此代码段](http://www.quirksmode.org/js/events_properties.html#key)来检测按键，并且您可能还想阅读有关[Detecting keystrokes](http://www.quirksmode.org/js/keys.html)的信息。

另请注意，事件属性（通常）是只读的。您需要防止当前事件使用不同的键触发额外的事件。

要将元素中键入的所有内容都大写`<input>`，您无需更改关键事件。只需在字符出现后更改输入本身的值即可。您将需要为此监听事件`keyup`而不是`keypress`事件（[阅读原因](http://www.quirksmode.org/dom/events/keys.html)）：

```
inputEl.onkeyup = function(e) {
    this.value = this.value.toUpperCase();
}; 
```

（[在 jsfiddle.net 上的演示](http://jsfiddle.net/Ngny9/1/)）。它很简单并且适用于所有浏览器，唯一的缺点是当您通过按住键插入多个字符时它不会立即大写（[解决方法](http://jsfiddle.net/Ngny9/2/)）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-02T19:02:00.500

我想我会以另一种方式做到这一点：

```
function keypressHandler() {
  this.value = this.value.toUpperCase();
}

document.getElementById('whatever').onkeypress = keypressHandler;
// or use addEventListener or whatever 
```

*编辑*实际上它与以下黑客一起工作得更好：

```
function keypressHandler(event) {
    var inp = this;
    setTimeout(function() {
        inp.value = inp.value.toUpperCase();
    }, 0);
} 
```

这让导致事件的键在值“固定”之前被添加到值中。

关键是处理键盘事件非常混乱，而且浏览器之间的事情也有所不同。上面的方法通过简单地直接处理由浏览器维护的值来完全避免这种情况。

*编辑*— 请注意，要使此处的代码正常工作，必须按照此代码的操作方式设置事件处理程序。如果你在 HTML 标记的“onkeypress”属性中设置它，它必须是不同的：

```
<input onkeypress='keypressHandler.call(this)'> 
```

# c# - 实体框架在选择整个实体时返回陈旧数据，但在仅选择一个字段时返回最新数据

> ID：11783983
> 
> 赞同：0
> 
> 时间：2012-08-02T18:55:13.687
> 
> 标签：c#, .net, sql-server, entity-framework, entity-framework-4

我的实体框架支持的项目在选择整个实体时返回过时的数据，但在仅从实体中选择一个字段时数据是最新的。

以下是步骤：

1.  **通过 EF/LINQ 查询：**

    ```
    var e  = context.myEntity.First(x=>x.ID==ID);
    string n = context.myEntity.Where(x=>x.ID==ID).Select(x=>x.Name).First(); 
    ```

2.  **直接通过 SQL 更新数据库中的名称字段**

3.  **然后通过 EF/LINQ 再次查询：**

    ```
    var e  = context.myEntity.First(x=>x.ID==ID);
    string n = context.myEntity.Where(x=>x.ID==ID).Select(x=>x.Name).First(); 
    ```

`e.Name`是以前的值，但是`n`是最新的。

我们在调用之间重用相同的上下文。

使用 SQL 分析器，我可以确认即使数据过时，来自 EF 的 SQL 查询也会发生。

什么会导致这种情况？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-02T19:03:52.737

数据缓存在上下文中。理想情况下，您的上下文应该具有较短的生命周期（例如，一个工作单元）以防止这种行为成为问题，但如果您需要强制从数据库进行更新，请将 MergeOption 设置为 OverwriteChanges

```
context.MergeOption = MergeOption.OverwriteChanges 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-02T19:10:11.867

发生这种情况是因为您使用的是默认的上下文合并选项`MergeOption.AppendOnly`。这个选项基本上告诉底层上下文结构永远不要用来自数据源查询的新值替换现有实体。

不过，您还有其他选择，我建议您阅读以下内容，看看其他选项之一是否更适合您想要的场景。

[http://msdn.microsoft.com/en-us/library/system.data.objects.mergeoption.aspx](http://msdn.microsoft.com/en-us/library/system.data.objects.mergeoption.aspx)

听起来你最好的选择可能是`MergeOption.PreserveChanges`

# android - Phonegap 的 FileTransfer.upload() 在 Android 上抛出错误代码 3

> ID：11783985
> 
> 赞同：9
> 
> 时间：2012-08-02T18:55:28.417
> 
> 标签：android, cordova, upload

我正在将图片上传到服务器。我能够使用 iOS 成功上传图像，但是当我尝试使用 android 时，我得到错误代码 3。目前使用 phonegap cordova 1.8.1。

我已经尝试将 true 添加到参数

```
upload(filePath, server, successCallback, errorCallback, options, **true**); 
```

并添加这个

```
options.chunkedMode = false; 
```

我的 AndroidManifest 文件包含：

```
<uses-permission android:name="android.permission.INTERNET" /> 
```

我的 cordova.xml 文件包含：

```
<access origin="*"/> 
```

我错过了什么吗？

谢谢

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2015-11-10T09:40:24.250

问题可能不在Phonegap 中。如果服务器是基于 Windows 的服务器，请尝试使用另一台服务器。另外，不要忘记添加这些行：

```
var options = new FileUploadOptions();
options.chunkedMode = false;
options.headers = {
      Connection: "close"
   }; 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-10-09T09:28:28.427

添加代码：

```
var op;
op = new FileUploadOptions();

op.headers = {
    Connection: "close"
}; 
```

添加后 - 代码开始运行良好，没有错误。更详细的描述：[http://grandiz.com/phonegap-development/phonegap-file-transfer-error-code-3-solved](http://grandiz.com/phonegap-development/phonegap-file-transfer-error-code-3-solved) 希望有帮助！

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-06T12:42:31.943

这也发生在我身上。您应该指定 `chunkedMode=false`（http://stackoverflow.com/questions/8522729/phonegap-filetransfer-upload-fails-on-android）

```
var options = FileUploadOptions();
options.chunkedMode = false; 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2014-11-11T06:40:37.390

这些是我用来克服这个问题的步骤：

添加了以下选项：

```
options.chunkedMode = false;
options.headers = {
      Connection: "close"
   }; 
```

但更重要的是我使用 Genymotion 作为模拟器进行测试。无法将图像上传到本地主机，因为模拟器在虚拟机中运行，本地主机意味着虚拟机的本地主机，而不是 Web 服务器的本地主机。

因此，您不应上传到“localhost”，而应上传到：

```
http://10.0.2.2 
```

并将以下行添加到您的 config.xml：

```
<access origin="10.0.2.2" subdomains="true"/> 
```

我测试了它，它的工作就像一个魅力。不过，我花了 3 天时间才完成这项工作。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-09-07T05:12:28.343

这是 phonegap 库中的一个未修复的错误，因为没有错误修复，我必须通过我的工作来解决它（基本上在每次备用故障时重新上传）：

```
ft.upload(path,
          encodeURI("http://yourdomain.com/upload.php"),
            function(result) {
                alert("Uploaded");
            },
            function(error) {
                ft.upload(path,
                encodeURI("http://yourdomain.com/upload.php"),
                function(result) {
                    alert("Uploaded");                  
                },
                function(error) {
                    alert("Error uploading image");
                },
                { fileName: name, fileKey: "file", mimeType: "image/jpeg", chunkedMode: false }, true);     
            },
            { fileName: name, fileKey: "file", mimeType: "image/jpeg", chunkedMode: false }, true); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-03-19T10:26:04.337

我已经向 Telerik 询问了我在使用 AppBuilder 时遇到的这个问题。根据他们的回复[，这可能是 Cordova 中的一个错误](http://www.telerik.com/forums/code-3-upload-error-on-android-4-3-when-uploading-to-s3)（我使用的是 3.2）。

他们建议更新到最新的[FileTransfer 库](http://plugins.cordova.io/#/org.apache.cordova.file-transfer)（同时更新所有依赖项），看看是否能解决您的问题。实际上，我在编译新库时遇到了另一个问题。

我建议您尝试一下，看看是否适合您。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2015-09-14T08:43:58.717

这也可能是一个原因，并为我解决了它：

iOS 9 和 OSX 10.11 要求您计划从中请求数据的所有主机都使用 TLSv1.2 SSL，除非您在应用程序的 Info.plist 文件中指定异常域。

（[CFNetwork SSLHandshake iOS 9 失败](https://stackoverflow.com/questions/30720813/cfnetwork-sslhandshake-failed-ios-9)）

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2012-08-17T19:09:00.260

您可以尝试以下任一方法：

`android:debuggable="true"`在文件的`<application>`标签中设置`AndroidManifest.xml`。

设置`<access origin=".*"/>`而不是`*`评论部分中建议的设置，如下所示：

```
<!-- <access origin="https://example.com" /> allow any secure requests to example.com -->
<!-- <access origin="https://example.com" subdomains="true" /> such as above, but including subdomains, such as www -->
<!-- <access origin=".*"/> Allow all domains, suggested development use only --> 
```

# android - 从带有标签的 FragmentActivity 启动另一个活动是错误的吗？

> ID：11783998
> 
> 赞同：1
> 
> 时间：2012-08-02T18:56:16.277
> 
> 标签：android, android-fragments, android-actionbar

我有一个 SherlockFragmentActivity，其选项卡中有两个 SherlockFragment。自然，我希望在方向更改以及用户从他们从任一片段启动的活动返回时保持当前选定的选项卡处于活动状态。

所以我使用*onSaveInstanceState来存储选定的选项卡索引并在**onCreate*上重新选择它。这适用于方向变化。但是，如果我启动另一个活动（假设是首选项屏幕）并从中返回，则保存的实例状态在*onCreate*上始终为 null ，即使已调用 *onSaveInstanceState也是如此。*

所以我想问题是我是不是走错了路。如果我使用片段，我是否被迫只使用一个活动，所有子屏幕都作为片段？

还是有其他原因导致我保存的实例状态在活动更改之间消失？

编辑：来自活动 B 的代码

```
@Override
public boolean onOptionsItemSelected(MenuItem item) {
    switch (item.getItemId()) {
        case android.R.id.home:
            Intent intent = new Intent(this, MainActivity.class);
            intent.addFlags(Intent.FLAG_ACTIVITY_CLEAR_TOP);
            startActivity(intent);
            return true;
        default:
            return super.onOptionsItemSelected(item);
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-02T20:05:44.430

将您的`onOptionsItemSelected`代码更改为以下内容。`finish()`结束一个`Activity`而不是重新启动它下面的一个。

```
@Override
public boolean onOptionsItemSelected(MenuItem item) {
    switch (item.getItemId()) {
        case android.R.id.home:
            finish();
            return true;
        default:
            return super.onOptionsItemSelected(item);
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-02T19:23:27.783

你在做什么很好。

可能令人困惑的一件事是，从 Activity A 启动 Activity B 并不能保证 onSaveInstanceState 将被调用。操作系统根据活动 A 是否可能在活动 B 期间被破坏来做出此决定。

所以你真的有两种情况需要考虑：

**情况1**

*   活动 A 已暂停
*   未调用 onSaveInstanceState

**案例2**

*   活动 A 已暂停
*   onSaveInstanceState 被调用

有关更多说明，请参阅[onSaveInstanceState 的文档。](http://developer.android.com/reference/android/app/Activity.html#onSaveInstanceState%28android.os.Bundle%29)