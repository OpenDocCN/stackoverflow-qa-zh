# StackOverflow 问答 000344000-000344999

# c++ - 如何用#include 替换这个预处理器宏？

> ID：344012
> 
> 赞同：2
> 
> 时间：2008-12-05T14:39:39.180
> 
> 标签：c++, macros, include, c-preprocessor

**更新：** 显然，您希望使用模板或基类而不是宏来执行此操作。不幸的是，由于各种原因，我不能使用模板或基类。

* * *

目前我正在使用宏在各种类上定义一堆字段和方法，如下所示：

```
class Example
{
  // Use FIELDS_AND_METHODS macro to define some methods and fields
  FIELDS_AND_METHODS(Example)
}; 
```

`FIELDS_AND_METHODS`是一个使用字符串化和标记粘贴运算符的多行宏。

我想用下面的东西代替它

```
class Example
{
  // Include FieldsNMethods.h, with TYPE_NAME preprocessor symbol
  // defined, to achieve the same result as the macro.
  #define TYPE_NAME Example
  #include "FieldsNMethods.h"
}; 
```

这里我#define类的名称（以前是宏的参数），`FieldsNMethods.h`文件包含原始宏的内容。但是，因为我是#include，所以在调试时我可以在运行时单步执行代码。

但是，我在“字符串化”和“标记粘贴”文件`TYPE_NAME`中的预处理器符号时遇到了麻烦`FieldsNMethods.h`。

例如，我想在 中定义类的析构函数`FieldsNMethods.h`，所以这需要使用如下的值`TYPE_NAME`：

```
~TYPE_NAME()
{
  //...
} 
```

但用`TYPE_NAME`它的价值代替。

我正在尝试的可能吗？我不能直接使用字符串化和标记粘贴运算符，因为我不在宏定义中。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-12-05T14:47:42.347

这需要一个模板。

```
class Example<class T>
{
    ...class definition...
}; 
```

您问题最后一部分的直接答案 - “鉴于我不再处于宏定义中，我如何让粘贴和字符串化运算符工作” - 是“你不能”。这些运算符仅在宏中工作，因此您必须编写宏调用才能使它们工作。

*补充*：

@mackenir 说“模板不是一种选择”。为什么模板不是一个选项？该代码以老式的预标准、预模板方式模拟模板，这样做会造成很多痛苦和悲伤。使用模板可以避免这种痛苦——尽管会有转换操作。

@mackenir 问道“有没有办法让宏工作？” 是的，你可以，但你应该使用模板——它们更可靠和可维护。要使其与宏一起使用，您必须将包含的标头中代码中的函数名称作为宏调用。您需要经过一定程度的间接才能使其正常工作：

```
#define PASTE_NAME(x, y) PASTE_TOKENS(x, y)
#define PASTE_TOKENS(x, y) x ## y

#define TYPE_NAME Example
int PASTE_NAME(TYPE_NAME, _function_suffix)(void) { ... } 
```

对于标记化和字符串化运算符，这种间接级别通常是必要的习惯用法。

* * *

@mackenir 的其他评论表明问题仍然存在。让我们把它具体化。

> 目前我正在使用宏在各种类上定义一堆字段和方法，如下所示：

```
class Example
{
    // Use FIELDS_AND_METHODS macro to define some methods and fields
    FIELDS_AND_METHODS(Example)
}; 
```

> FIELDS_AND_METHODS 是一个使用字符串化和标记粘贴运算符的多行宏。
> 
> 我想用下面的东西代替它

```
class Example
{
    // Include FieldsNMethods.h, with TYPE_NAME preprocessor symbol
    // defined, to achieve the same result as the macro.
    #define TYPE_NAME Example
    #include "FieldsNMethods.h"
}; 
```

好的。为了使这一点具体化，我们需要一个`FIELDS_AND_METHODS(type)`多行的宏并使用标记粘贴（我不打算处理字符串化 - 不过将应用相同的基本机制）。

```
#define FIELDS_AND_METHODS(type) \
    type *next; \
    type() : next(0) { } \
    type * type ## _next() { return next; } 
```

幸运的是，这声明了“指向参数类型的指针”类型的成员、该类型的构造函数以及返回该指针的方法（在本例中为 Example_next）。

所以，这可能是宏 - 我们需要替换它，以便 '#include' 完成相同的工作。

fieldsNmethods.h 的内容变为：

```
#ifndef TYPE_NAME
#error TYPE_NAME not defined
#endif
#define FNM_PASTE_NAME(x, y)    FNM_PASTE_TOKENS(x, y)
#define FNM_PASTE_TOKENS(x, y)  x ## y

TYPE_NAME *next;
TYPE_NAME() : next(0) { }
TYPE_NAME * FNM_PASTE_NAME(TYPE_NAME, _next)() { return next; }

#undef FNM_PASTE_NAME
#undef FNM_PASTE_TOKENS 
```

请注意，标头不会包含多重包含保护；它存在的理由是允许它被包含多次。它还取消定义了它的辅助宏以允许多次包含（好吧，因为重新定义是相同的，它们是“良性的”并且不会导致错误），并且我在它们前面加上`FNM_`了宏的原始名称空间控制。这会生成我期望来自 C 预处理器的代码。并且 G++ 不会机智但会生成一个空的目标文件（因为我的示例代码中没有使用声明的类型）。

请注意，除了问题中概述的之外，这不需要对调用代码进行任何更改。我认为应该使用 SPOT“单点真理”原则（或干“不要重复自己”）来改进这个问题：

```
#define TYPE_NAME Example
class TYPE_NAME
{
    // Include FieldsNMethods.h, with TYPE_NAME preprocessor symbol
    // defined, to achieve the same result as the macro.
    #include "FieldsNMethods.h"
}; 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-12-05T15:41:51.223

您必须添加一层额外的宏：

```
#define STRINGIZE(x) STRINGIZE2(x)
#define STRINGIZE2(x) #x

#define TOKENPASTE(x, y) TOKENPASTE2(x, y)
#define TOKENPASTE2(x, y) x ## y 
```

原因是当你有一个宏时，预处理器通常会在执行宏替换之前递归地扩展参数。但是，如果任何参数与字符串化运算符 # 或标记粘贴运算符 ## 一起使用，则它*不会*被扩展。因此，您需要一个额外的宏层，其中第一层扩展参数，第二层执行字符串化或标记粘贴。

如果需要多次扩展参数（例如`#define A B, #define B C, #define C D, STRINGIZE(A)`），则需要在应用 # 或 ## 运算符之前添加更多层。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-12-05T15:10:39.727

您应该用另一个宏包装字符串化（由于预处理器的工作方式，需要 2 个）

在 FieldsNMethods.h

```
#define MAKE_STR_X( _v ) # _v
#define MAKE_STR( _v ) MAKE_STR_X( _v )

char *method() { return MAKE_STR( TYPE_NAME ); } 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-05T14:55:25.500

不，您不能动态定义类或函数定义。必须通过直接键入它们或在预处理器中定义它们来指定它们。

通常，不需要生成这样的类，并且类定义是在编译之前创建的，无论是通过键入所有内容还是使用某种代码生成。有时会有一个单独的代码生成步骤（例如，在当前的 Visual Studio 中，您可以定义预处理和后处理步骤）。

现在，如果您需要为不同的数据类型创建某些类的不同版本，您可以使用模板。您不能以这种方式创建不同名称的橡皮图章类。

最后一个问题：你为什么要这样做？我从来没有处于这样的位置，这样的东西在 C++ 中看起来很有用，而在这确实有意义的语言中，有一些工具可以做到这一点。

# .net - 跨应用域回收使用自定义性能计数器

> ID：344018
> 
> 赞同：6
> 
> 时间：2008-12-05T14:41:51.300
> 
> 标签：.net, asp.net, appdomain, performancecounter

我有一个 ASP.NET 应用程序，它通过创建和写入自定义性能计数器来跟踪统计信息。有时，我在错误日志中看到指示计数器无法打开，因为它们已在当前进程中使用。我认为这是由于我的 .NET appdomain 已在同一个 w3wp.exe 进程中重置。当我的应用程序域被回收时，如何避免这些错误并重新建立与我的性能计数器的连接？

柜台建设：

```
PerformanceCounter pc = new PerformanceCounter();
pc.CategoryName = category_name;
pc.CounterName = counter_name;
pc.ReadOnly = false;
pc.InstanceLifetime =
PerformanceCounterInstanceLifetime.Process;
pc.InstanceName = instance_name; 
```

计数器用法：

```
pc.Increment() 
```

[2009 年 3 月 26 日更新] 收到的错误消息是：

实例“_lm_w3svc_1_root_myapp”已经存在，进程的生命周期。在它被删除或使用它的进程退出之前，它不能被重新创建或重用。已经存在一个生命周期的进程。

我试图通过初始化性能计数器并在瞬态 AppDomain 中写入其中一个来在控制台应用程序中复制异常。然后我卸载 AppDomain 并在第二个 Appdomain 中再次执行此操作（相同的过程）。他们都成功了。我现在不确定这是什么原因，我对 ASP.NET 中 AppDomain 回收的假设似乎是错误的。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-22T09:06:27.477

[使用基于进程的 WCF 性能计数器](http://blogs.msdn.com/b/wenlong/archive/2007/09/07/how-to-use-performance-counters-to-diagnose-performance-of-wcf-applications.aspx)时，应用程序日志中也可能会遇到上述错误。其症状是应用程序事件日志中的三个错误块：

> 未加载性能计数器。
> 类别名称：ServiceModelService 3.0.0.0
> 计数器名称：调用
> 异常：System.InvalidOperationException：实例“abc@def|service.svc”已经存在，其生命周期为进程。在它被删除或使用它的进程退出之前，它不能被重新创建或重用。

这总是在系统事件日志中的以下信息消息之后立即发生：

> 服务应用程序池“MyAppPool”的进程 ID 为“nnnn”的工作进程已请求回收，因为该工作进程已达到其允许的处理时间限制。

这会导致该服务的性能监视器计数器变得不可用，显然有几个小时。

`ServiceModelService 3.0.0.0`版本号[取决于您使用的 .NET 版本](http://msdn.microsoft.com/en-us/library/ms735098.aspx)（这是使用 .NET 3.5 测试的）。

# 背景

故障是由工作进程达到其处理时间限制触发的，此时它必须被回收。这是在 IIS 应用程序池回收设置中设置的（IIS 6.0 及更高版本，因此是 Windows Server 2003 及更高版本）。工作进程的回收会导致基于新进程的性能计数器名称与旧进程冲突，从而产生错误。这是因为 IIS 使用[重叠回收](http://www.microsoft.com/technet/prodtechnol/WindowsServer2003/Library/IIS/3ee19598-ec90-4570-a4a5-d93a24400b99.mspx?mfr=true)，要终止的工作进程会一直运行，直到新的工作进程启动。

# 再生产

*（在 Windows Server 2003 = IIS 6.0 上测试）*

*   创建 WCF 服务。
*   [将以下内容](http://blogs.msdn.com/b/wenlong/archive/2007/09/07/how-to-use-performance-counters-to-diagnose-performance-of-wcf-applications.aspx)添加到部分`web.config`中`<system.serviceModel>`：
    `<diagnostics performanceCounters="All" />`
*   在属性 → 回收下服务的应用程序池属性中，将回收工作进程设置为 1 分钟。手动回收应用程序池没有任何效果，因为这不会从工作进程创建回收请求（在带有`W3SVC`信息事件的事件查看器系统日志中很明显）。
*   在[soapUI](http://www.soapui.org/)中为WCF 操作创建一个测试套件/测试用例/测试步骤/测试请求。
*   将测试用例添加到soapUI 中的负载测试中，或者使用[loadUI](http://www.loadui.org/)，以每秒 1 次的速率触发调用。
*   每 1 分钟，工作进程将请求一次回收（在系统日志中很明显）。每 2 分钟，这将导致来自`System.ServiceModel 3.0.0.0`.
*   在工作进程再次回收之前，该服务的性能计数器将变得不可用。（注意此时将回收周期设置为更高的值以查看性能计数器不可用的时间将实际回收进程并使计数器再次可用。）

# 可能的解决方案

## 解决方案 1 - 红鲱鱼

修补程序[KB981574](http://support.microsoft.com/kb/981574)取代了修补程序[KB971601](http://support.microsoft.com/kb/971601)。后一个修补程序描述了该问题：

> 修复：当应用程序退出并重新启动并且您在运行 .NET Framework 2.0 的计算机上收到 System.InvalidOperationException 异常时，监视应用程序的性能计数器停止响应

应用以前的修补程序并不能解决问题。应用后一个修补程序会导致应用程序池错误。

## 解决方案 2 - 一个可行的解决方案

可以创建一个[公开自定义服务主机的服务主机工厂](http://kleindublin.blogspot.co.uk/2009/02/wcf-event-log-entry-servicemodelservice.html)：

```
using System;
using System.Diagnostics;
using System.ServiceModel;
using System.ServiceModel.Activation;

namespace MyNamespace
{
    public class WebFarmServiceHostFactory : ServiceHostFactory
    {
        protected override ServiceHost CreateServiceHost(
                   Type serviceType, Uri[] baseAddresses)
        {
            return new WebFarmServiceHost(serviceType, baseAddresses);
        }
    }

    public class WebFarmServiceHost : ServiceHost
    {
        public WebFarmServiceHost(
            Type serviceType, params Uri[] baseAddresses)
            : base(serviceType, baseAddresses) { }

        protected override void ApplyConfiguration()
        {
            base.ApplyConfiguration();

            Description.Name = "W3wp" + Process.GetCurrentProcess().Id +
                               Description.Name;
        }
    }
} 
```

并参考服务标记`.svc`文件中的工厂：

`<%@ ServiceHost Language="C#" Debug="true" Factory="MyNamespace.WebFarmServiceHostFactory" Service="WcfService1.Service1" CodeBehind="Service1.svc.cs" %>`

### 最后的调整

不幸的是，尽管这使得问题发生的频率大大降低，但它仍然会发生（大约减少了大约 30 倍，尽管我没有测量过准确的统计数据）。

一个似乎可以完全解决问题的简单调整是在之前添加一个 sleep 命令`base.ApplyConfiguration();`：

```
Thread.Sleep(1); 
```

这只会在每个工作进程回收时触发一次，因此对服务性能的影响应该可以忽略不计。您可能必须提高此值（您可以使其可配置），尽管 1ms 的最小设置对我有用（关于该命令实际休眠多长时间的争论）。

## 解决方案 3 - 最简单的修复

在 IIS 中有一个[`DisallowOverlappingRotation`Metabase Property](http://www.microsoft.com/technet/prodtechnol/WindowsServer2003/Library/IIS/ec26f50e-dcc9-4439-acc1-d7d8cff8e0ee.mspx?mfr=true)。这[可以设置如下](http://forums.iis.net/t/1155612.aspx)（`MyAppPool`应用程序池的示例）：

```
cscript %SYSTEMDRIVE%\inetpub\adminscripts\adsutil.vbs SET w3svc/AppPools/MyAppPool/DisallowOverlappingRotation TRUE 
```

# 解决方案比较

解决方案#3 将[导致您的站点](http://mtv-on-dotnet-dev.blogspot.co.uk/2010_10_01_archive.html)在工作进程由于没有 IIS 重叠回收而进行回收时停机更长时间。

在使用 5 个线程每秒处理 100 多个事务的基本 Web 服务的 soapUI 负载测试中，每次工作进程回收时，新事务被阻止的“冻结”是明显的几秒钟。当测试更复杂的 Web 服务时，这种冻结时间更长（超过 8 秒）。

解决方案#2 没有产生这样的阻塞，在回收期间有流畅的响应流，并且没有产生性能冲突错误。

# 结论

对于不需要低延迟的 Web 服务，可以使用解决方案 #3。如果您知道一天中的负载分布和安静时间，您甚至可以将回收设置为每天在设定的时间（这可以在 IIS 的同一选项卡中完成）。如果使用网络农场，这甚至可以错开。

对于无法容忍此类延迟的 Web 服务，似乎解决方案 #2 是最好的方法。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-17T18:23:25.690

IIRC，IIS 不会确保您的第一个 AppDomain 在启动第二个之前已关闭，特别是当您手动或自动回收它时。我相信，当启动回收时，首先实例化第二个 AppDomain，一旦成功，新的传入请求就会被定向到它，然后 IIS 等待第一个 AppDomain（正在关闭的那个）完成处理它的任何请求拥有。

结果是存在两个 AppDomain 的重叠，两者都具有相同的`instance_name`.

然而，并不是所有的问题都解决了。我通过将进程 ID 作为实例名称的一部分在我的代码中更正了这个问题。但它似乎引入了另一个问题——我认为是进程范围的性能计数器似乎永远不会在不重新启动计算机的情况下消失。（这可能是我的一个错误，所以 YMMV）。

这是我创建实例名称的例程：

```
 private static string GetFriendlyInstanceName()
    {
        string friendlyName = AppDomain.CurrentDomain.FriendlyName;
        int dashPosition = friendlyName.IndexOf('-');
        if (dashPosition > 0)
        {
            friendlyName = friendlyName.Substring(0, dashPosition);
        }
        friendlyName = friendlyName.TrimStart('_');
        string processID = Process.GetCurrentProcess().Id.ToString();
        string processName = Process.GetCurrentProcess().ProcessName;
        string instanceName = processName + " " + processID + " " + friendlyName.Replace('/', '_').Trim('_').Trim();
        return instanceName;
    } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-26T23:32:28.083

我不是自定义计数器方面的专家，但根据您提供的信息，我认为值得一试，因为当添加域即将被回收时，某些代码可能会尝试使用计数器。在与 dispose 或 destructor 相关的任何事情中寻找计数器的使用。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-30T18:37:16.077

如果您懒惰地创建性能计数器，则可能是线程问题。在进程循环之后，如果同时发生两个页面命中（这并不让我感到惊讶），那么您的性能创建调用可能会运行多次。一方面，您可以放心地忽略此错误。但是如果你想消除它，我建议你用一个锁语句来包装你的性能计数器代码生成，例如

```
lock (this.lockObject)
{
 //Create performance counter
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-11-05T15:21:17.007

我有一个类似的问题：不能在 Visual Studio 中多次创建多实例、进程生命周期计数器，但这是因为我打开了 PerfMon！

我花了一段时间才意识到这一点。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-11-08T10:48:21.380

IIS 保证您的第一个 AppDomain 在启动第二个之前不会关闭，特别是当您手动或自动回收它时，如果您将应用程序池回收“禁用重叠回收”属性设置为 false（默认值）。

如果是共享主机，您可以在 web.config 文件中定义它。

# .net - Using Castle Windsor configuration files is it possible to delegate to another item declaration?

> ID：344019
> 
> 赞同：2
> 
> 时间：2008-12-05T14:41:55.947
> 
> 标签：.net, castle-windsor

Using Castle-Windsor, is it possible to declare a type once and use this declaration for multiple Ids rather than writing it out in full each time.

E.g. we have class Widget that implements IFoo and we want the keys "IFoo.A" and "IFoo.B" to get a Widget from Castle. I want to do something like

```
<id="IFoo.Main"
 type="IFoo"
 service="Widget"/> 
```

then

```
<id="IFoo.A"
 giveme="IFoo.Main/>

<id="IFoo.B"
 giveme="IFoo.Main/> 
```

Thanks.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-08T17:07:09.007

您正在寻找的是我相信的转发类型......看看这些问题：

*   [城堡温莎组件注册上下文中的转发类型是什么](https://stackoverflow.com/questions/197274/what-are-forwardedtypes-in-the-context-of-castle-windsor-component-registration#230949)
*   [温莎城堡是否支持通过 xml 转发的类型](https://stackoverflow.com/questions/274220/does-castle-windsor-support-forwardedtypes-via-xml-configuration#274302)

虽然目前在 xml 配置中不支持开箱即用，但第二个问题有一个答案，详细说明了如何通过编写一个简单的工具来做到这一点。

# visual-studio - 如何将 app.config 与 Visual Studio 加载项一起使用？

> ID：344024
> 
> 赞同：1
> 
> 时间：2008-12-05T14:43:55.710
> 
> 标签：visual-studio, add-in, visual-studio-addins

我正在构建一个简单的 VS2008 插件。存储自定义运行时设置的最佳做法是什么？您在哪里存储 app.config 以及如何从加载项访问它？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-06T03:31:41.573

[用System.IO.IsolatedStorageFile](http://msdn.microsoft.com/en-us/library/system.io.isolatedstorage.isolatedstoragefile_members.aspx)尝试这样的事情（还没有测试示例代码..这只是为了展示这个想法）

**写作**

```
using (IsolatedStorageFile file = IsolatedStorageFile.GetUserStoreForAssembly())
    {
       using (StreamWriter stream = new StreamWriter(new IsolatedStorageFileStream("YourConfig.xml", FileMode.Create, file)))
       {
          stream.Write(YourXmlDocOfConfiguration);
       }
       stream.Flush();
       stream.Close();
     } 
```

**阅读**

```
 string yourConfigXmlString;
    using (IsolatedStorageFile file = IsolatedStorageFile.GetUserStoreForAssembly())
    {
       string[] files = file.GetFileNames("YourConfig.Xml");
       if (files.Length > 0 && files[0] == "YourConfig.xml"))
       {
          using (StreamReader stream = new StreamReader(new IsolatedStorageFileStream("YourConfig.xml", FileMode.Open, file)))
          { 
            yourConfigXmlString = stream.ReadToEnd();
          }             
       }
     } 
```

# web-applications - Web 和桌面应用程序在构建 UI 方面的差异

> ID：344026
> 
> 赞同：5
> 
> 时间：2008-12-05T14:45:31.027
> 
> 标签：web-applications, user-interface, desktop-application

Web 应用程序的 UI 与桌面应用程序的 UI 构造不同。我很想知道在以下领域中两种风格的应用程序在构建 UI 方面的主要区别是什么：

1.使用的技术

2.使用的技术

3.使用的控件

4.换屏行为

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-12-05T14:48:55.747

在网页设计中你不能忽视的一件主要事情是**后退按钮**。成千上万的人试图禁用或绕过它。不要试图绕过后退按钮！而是让后退按钮成为您设计的一部分。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-12-05T18:37:50.247

很多人忽略的一个很大的设计差异是窗户本身的结构。

*   桌面应用程序倾向于为最小高度和宽度分辨率（通常为 800*600）而构建，并尽可能努力地将所有相关信息调整为小于该大小的大小，因为滚动条通常是非常糟糕的做法非表格/列表数据。在需要更多空间的地方，信息通常分为新窗口或子窗口窗格/选项卡。
*   另一方面，Web 应用程序具有基本上无限的垂直高度，因为大多数人习惯于在他们的 Web 浏览器中滚动。滚动条不再是坏事；事实上，在可以使用主要滚动条的*任何地方*使用滚动条通常被认为是不好的形式（当然，也有一些例外）。信息通常在一个“窗口”中描绘，因为将其拆分需要单独的页面加载和重新加载相同的数据（样式、菜单等）。是的，有一个缓存，但它不如不加载单个页）。更多的负载总是更慢，并导致不连续的感觉。有时它们是不可避免的，但您几乎不应该将您的应用程序限制为仅浏览器窗口的可见大小。
*   很多人使用网络浏览器的目的是阅读。新闻、博客、youtube 上的评论等。当你制作一个网络应用程序时，它应该反映这种习惯，因为如果他们在网页和你的应用程序之间切换，你会通过截然不同的布局来刺激人们的大脑（你知道有些会）。看起来你只是在模仿大玩家，但一致性比看起来要重要得多。
*   文本列不应该超宽，因为行越宽，越难跳到下一行继续阅读。坚持类似于书本的东西；它们已经被提炼了*几个世纪*。这就是为什么很多网页都是固定宽度的，并且喜欢列而不是行的部分原因。
*   空白很*重要*。它有助于分离信息，并使其更易于处理。想象一下，在没有任何空格、换行符或项目符号的情况下阅读此回复。

我最讨厌的是执行频繁操作的文本链接。除非您实际上“链接”到一个单独的页面，*否则不要让它看起来像一个链接*。让它成为一个控件、图像或*其他东西*。链接用于在网站中*移动*，按钮用于*执行*操作。大多数人在想做某事时会主动忽略带下划线的蓝色文本，因为他们习惯了“提交表单”按钮或类似的东西。链接也非常小，并且相对难以单击以进行重复操作，并且对我来说*，*在广泛使用时会产生不完整的设计/编码。

我见过的很多网络应用程序通常都失败了，它们试图在浏览器窗口中复制一个桌面应用程序……这将一个圆钉安装到一个方孔中。可以做到，但它们*不是*一回事，几乎在任何情况下都不应该这样对待。
部分例外是网络应用程序复制了桌面应用程序（即 Google 文档）的功能。然后，在大多数情况下，布局仍然应该更多地反映网页而不是应用程序，但控件应该可能模仿桌面应用程序以帮助人们过渡。

大多数人使用桌面上的程序来*做某事*。大多数人使用浏览器来*查看*某些内容（阅读、观看等）。当然，有交叉，但想想大多数人的日常习惯，记住*其他*人会使用你设计的东西；不仅仅是你（和你的克隆人）在那里。

而且，虽然它在重复别人，但后退按钮很*关键*。如果你打破它，用户就会想打破你。覆盖右键单击菜单或行为通常也是一个坏主意，而且大多会惹恼用户（有些人会积极阻止 javascript 这样做，因为它让他们非常恼火（包括我自己））。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-12-05T14:53:02.273

最大的区别是 IMO，在 Web 应用程序中，您对鼠标行为的影响非常有限，而且您所拥有的与已建立的桌面行为背道而驰。例如：

*   在桌面应用程序中，几乎普遍地单击鼠标右键会弹出上下文菜单。在 webapp 中也是如此，但它是浏览器的上下文菜单，您不能（也不应该）更改它。
*   在桌面应用程序中，单击选择某事，双击执行某事；在 web 应用程序中，单击已经“执行”了一个链接，并且不存在双击。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-12-05T15:03:35.920

桌面应用程序倾向于使用“在此事件上执行此代码块”模式编写。Web应用程序更多的是块模式“服务器格式化整个页面，用户填写表单并按下按钮，服务器处理整个表单，服务器格式化另一个整个页面”模式。

AJAX 稍微搅浑了水，因为浏览器可以在后台请求一些数据，并刷新页面的某些部分。然而，基本原则仍然存在。

让桌面 GUI 更容易响应特定的鼠标移动和点击等。另一方面，对于 Web 应用程序，与服务器的唯一通信是“获取”和“发布”请求，因此用户界面更加笨拙。

基于 Web 的应用程序更便携，您在客户端上需要的唯一软件就是兼容的浏览器。这些系统管理优势是人们忍受略逊一筹的 GUI 的原因。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-12-05T15:14:20.033

主要区别在于 Visual 在桌面上构建速度非常快，**无需使用不同的浏览器进行测试**。我总是发现构建桌面的魅力，因为软件的 Visual 部分只是绑定在您的控制器（包含您的模型）上，而您正在旅途中！

另一个区别是加载速度。您不必为显示传输 Javascript 或 CSS...您不必压缩或其他东西，因为它始终在桌面上的源代码中可用。

另一件事是，您可以使用计算机的 RAM 来做困难的事情，这往往会减少在服务端拥有多台计算机的需要，因为您可以使用所有这些计算机来“农场”大进程（如果需要）。

另一方面，部署更难（你有 ClickOnce 和可以帮助你的自动工具），但它从来没有像 web 那样透明。因此，您必须更有计划地进行发布，因为您无法进行“热修复”。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-12-05T15:18:57.090

*   在 Web 浏览器中跨帧通信很困难。例如，让一个 iframe 使用 javascript 影响另一个 iframe。主要是因为加载时间可能不同，所以帧 A 可能需要在定时器循环上等待帧 B 加载。

*   在 Web UI 中，消息传递确实需要考虑请求/响应周期。很难做到“如果数据库中的记录发生更改，则在用户屏幕上弹出一条消息”。此外，如果按下按钮必须刷新 5 个不同的 iframe，您最终可能会收到 5 个对服务器的单独请求。在桌面 UI 中真的不需要担心这一点。

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2008-12-05T15:23:27.893

我发现最不同的一件事是数据绑定。这个概念还是一样的，但是对于网络应用程序，你总是担心是否重新绑定所述控件以根据其他一些事件单击来刷新数据。桌面应用程序的好处在于，这不是一个问题，因为单击其他事件或转到其他选项卡不会使控件中的数据无效。

# c++ - shared_ptr：它是做什么用的

> ID：344031
> 
> 赞同：4
> 
> 时间：2008-12-05T14:49:10.597
> 
> 标签：c++, boost, shared-ptr, raii

我在我的代码中大量使用了 boost::scoped_ptr，它很棒，但我目前正在使用到处使用 shared_ptr 的软件，我想知道我是否遗漏了一些东西。

AFAIK shared_ptr 仅在不同的线程要访问相同的数据并且您不知道线程将要完成的顺序时才有用（shared_ptr 确保对象存在直到最后一个线程完成它）。

还有其他用例吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-12-05T14:54:19.120

> AFAIK shared_ptr 只有在不同的线程要访问相同的数据时才有用

好吧，它适用于多个**所有者**拥有智能指针指向的同一个对象的情况。他们可以从不同的线程访问智能指针，并且**shared_ptr**也可以在该区域使用，但这不是重点。如果最后一个所有者丢失了对所指向对象的引用，shared_ptr 机制将删除该对象。

如果您想要的只是一个指针，当它创建的范围离开时（通过异常，通过*转到*外部位置，或通过正常控制流或其他机制），您可以使用**scoped_ptr 。**如果你这样使用它，则无需更改为 shared_ptr。

 ** * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-12-05T15:06:49.610

线程在这里无关紧要。相关的是是否容易指定对象不再使用的点。

假设几个不同的对象想要使用同一个对象。它可能是一组数据，或者用于输入/输出，或者一些几何对象，或者其他什么。您希望在删除所有使用对象后删除共享对象，而不是之前的一个时钟周期。您可以使用 shared_ptr 来强制执行此行为，而不是弄清楚哪个拥有对象将具有最长的生命周期（如果您更改程序，或者可能通过用户交互，这可能会改变）。

使用对象是在相同的还是不同的线程中都没有关系。即使对象都在同一个线程中，它们也可能具有不可预测的生命周期。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-18T03:58:37.087

scoped_ptr 和 shared_ptr（以及 auto_ptr）的区别主要在于复制语义。

*   scoped_ptr 用于“[资源分配即初始化](http://en.wikipedia.org/wiki/Resource_Allocation_is_Initialization)”，不可复制（不能与其他实例共享，所有权也不能转移）
*   shared_ptr 用于在多方共享时自动回收内存
*   auto_ptr 是可复制的（并在分配时转移所有权）

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2011-07-19T01:26:28.497

shared_ptr 和scoped_ptr 之间的另一个重要区别是只有shared_ptr 与weak_ptr 一起使用。弱指针用于打破共享指针的循环，从而避免内存泄漏，但weak_ptr 的用途不止于此。

共享指针和弱指针可用于表达拥有和非拥有引用之间的区别。数据的明确所有权导致设计更简洁，因此在可能的情况下，数据对象应通过 shared_ptr 由另一个对象**拥有。**所有其他对数据对象的长期引用都应该是弱指针，表示它们对数据的非所有权。任何非拥有模块每次访问数据时，都需要将weak_ptr转换为shared_ptr，此时他们可能会发现数据对象不再存在。然而，当非拥有模块访问数据对象时，它们通过瞬态 shared_ptr 持有它，即使拥有对象要释放数据，也能确保安全操作。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-12-05T17:54:46.387

正如已经回答的那样， shared_ptr 是关于共享所有权。但是，我认为共享所有权通常是一件坏事（存在例外，例如享元模式），最好确定所有者并将 scoped_ptr 放在那里。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-30T05:25:59.043

shared_ptr 是一种执行引用计数的智能指针类型。如果对象只有一个所有者（常见情况），那么 scoped_ptr 是正确的解决方案。如果对象可以在代码的多个部分之间共享，则 shared_ptr 不会让对象被破坏，直到对它的所有引用都被释放。

# linq - 使用 LINQ 查询具有固定长度记录的平面文本文件？

> ID：344034
> 
> 赞同：2
> 
> 时间：2008-12-05T14:49:55.387
> 
> 标签：linq

我有一个文件，里面有这样的记录：

```
NCNSCF1124557200811UPPY19871230 
```

这些代码都是固定长度的，其中一些链接到其他平面文件（有点像关系数据库）。使用 LINQ 查询这些数据的最佳方式是什么？

这是我直观地想到的，但我想知道是否有更优雅的方式：

```
var records = File.ReadAllLines("data.txt");
var table = from record in records 
            select new {    FirstCode = record.Substring(0, 2), 
                            OtherCode = record.Substring(18, 4) }; 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-05T14:56:43.780

一方面，我不会一开始就把它全部读入内存。编写一个 LineReader 类非常容易，它一次遍历文件一行。我在[MiscUtil](http://pobox.com/~skeet/csharp/miscutil)中有一个可以使用的版本。

但是，除非您只想读取一次结果，否则您可能希望在最后调用 ToList() 以避免多次读取文件。（这仍然比读取所有行并将其保存*在*内存中要好 - 您只想进行一次拆分。）

一旦基本上获得了所有表的内存集合，就可以使用普通的 LINQ to Objects 将它们连接在一起等。不过，您可能希望使用更复杂的数据模型来获取索引。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-05T14:54:39.043

我不认为有更好的开箱即用的方法。

可以定义一个平面文件 Linq 提供程序，它可以使整个事情变得更简单，但据我所知，还没有人这样做。

# postgresql - PostgreSQL 与 Postgres Plus

> ID：344038
> 
> 赞同：12
> 
> 时间：2008-12-05T14:50:54.790
> 
> 标签：postgresql

有谁知道[常规 PostgreSQL](http://www.postgresql.org)和[Postgres Plus](http://www.enterprisedb.com/products/postgres_plus.do)之间有什么实质性区别？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-12-05T15:07:16.163

数据库是相同的，这意味着 SQL 与周围的任何其他 PostgreSQL 安装完全兼容（除了 GIS 数据格式）。

主要区别在于 Postgres Plus 捆绑了一堆模块和工具，您必须单独收集和安装，否则您必须自己收集和安装。因此，主要优点是安装方便快捷。

大多数捆绑的东西看起来都可以从其他来源免费获得。Postgres Studio 应用程序看起来很接近 pgAdmin III。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-03-12T14:12:47.420

一个重要的区别是许可证：Postgres Plus 仅对“非生产”使用免费。您可以在这里找到详细的购买选项： [http ://www.enterprisedb.com/products/purchase.do](http://www.enterprisedb.com/products/purchase.do)

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2010-05-05T17:14:48.023

Postgres PLUS 是专有的，PostgreSQL 在许可许可下是开源的（这就是 Postgres PLUS 是专有的原因）。

Postgres PLUS 支持 Oracle PL/SQL，而 PostgreSQL 不支持，至少官方不支持。

这是两个最明显的区别。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-12-05T14:55:06.967

我使用了 8.2，什么时候切换到 8.3 我尝试了 PostGresPlus。

**速度快**了很多。很多我的意思是查询需要 30 秒，现在只需不到 2 秒。我不确定是 8.3 更快还是 Enterprise Plus 更快，但我可以告诉你我印象深刻。

我喜欢的另一件事是我可以**调试**存储的过程。它附带了更多工具。

# asp.net - 在ItemDataBound期间如何访问被数据绑定的项目？

> ID：344047
> 
> 赞同：13
> 
> 时间：2008-12-05T14:54:37.920
> 
> 标签：asp.net, repeater

我想在 asp:repeater 的 ItemDataBound 事件期间获取正在数据绑定的项目。

[我尝试了以下方法（这是stackoverflow 问题](https://stackoverflow.com/questions/284420/datagridview-bindinghow-to-color-line-depending-of-the-object-binded#284470)中不被接受的答案）：

```
protected void myRepeater_ItemDataBound(object sender, RepeaterItemEventArgs e)
{
    Object dataItem = e.Item.DataItem;
    ...
} 
```

但`e.Item.DataItem`为空。

如何在名为 ItemDataBound 的事件期间访问正在绑定数据的项目。我假设 ItemDataBound 事件发生在项目被数据绑定时。

我想了解对象，以便我可以采取措施控制它的显示方式，此外，该对象可能具有其他有用的属性，可以让我丰富它的显示方式。

## 回答

[工具](https://stackoverflow.com/questions/344047/aspnet-how-to-access-the-item-being-data-bound-during-itemdatabound#344073)有正确的答案。答案是`e.Item.Data`只有在`e.Item.ItemType`(Item, AlternatingItem) 时才有效。其他时候它是无效的。就我而言，我在没有 DataItem 的页眉（或页脚）行期间收到了 ItemDataBound 事件：

```
protected void myRepeater_ItemDataBound(object sender, RepeaterItemEventArgs e)
{
   // if the data bound item is an item or alternating item (not the header etc)
   if (e.Item.ItemType != ListItemType.Item && 
         e.Item.ItemType != ListItemType.AlternatingItem)
   {
      return;
   }

   Object dataItem = e.Item.DataItem;
   ...
} 
```

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2008-12-05T15:02:37.013

马上我不得不猜测你需要这个：

```
if (e.Item.ItemType == ListItemType.Item ||
    e.Item.ItemType == ListItemType.AlternatingItem)
{
    //Put stuff here
} 
```

毕竟，项目本身可能代表页眉或页脚行。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2010-09-08T17:01:40.790

我只是想补充一点，我确实通过执行以下操作完成了这一点：

```
protected void rpt_ItemDataBound(object sender, RepeaterItemEventArgs e)
    {
      //determine if the row type is an Item
      if ((e.Item.ItemType == ListItemType.Item) || (e.Item.ItemType == ListItemType.AlternatingItem))
      {
        DataRowView row = (DataRowView)e.Item.DataItem;
        if (row["RowName"].ToString() == "value")
        {
          //INSERT CODE HERE
        }
      }
    } 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-07-25T09:16:19.507

对于中继器

```
if (e.Item.ItemType != ListItemType.Item && e.Item.ItemType... 
```

可以修改为：

```
if (e.Item.DataItem != null) ... 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2017-12-22T08:10:26.353

使用***动态***

```
 dynamic item = e.Item.DataItem;
 string style = item.Style; 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-11T18:35:44.380

如果你正在处理一个 asp:ListView，你可以这样做：

```
 protected void myLV_ItemDataBound(object sender, ListViewItemEventArgs e)
{
    if (e.Item.ItemType != ListViewItemType.DataItem)
        return;

    object dataItem = ((ListViewDataItem)e.Item).DataItem;

} 
```

（问题的标题没有提到asp：repeater ..所以我认为发布asp：listview的代码可能会有所帮助）

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-05-01T21:00:50.733

对于具有自定义模板绑定的转发器；您可以使用以下模板。我用它来创建一个表格，将每个数据项分解为两行以供打印视图。

```
Repeater1.HeaderTemplate = new PrintTemplate(ListItemType.Header);
Repeater1.ItemTemplate = new PrintTemplate(ListItemType.Item);
Repeater1.AlternatingItemTemplate = new  PrintTemplate(ListItemType.AlternatingItem);
Repeater1.FooterTemplate = new PrintTemplate(ListItemType.Footer);

 public class PrintTemplate : ITemplate
{
    ListItemType templateType;

  public PrintTemplate(ListItemType type)
  {
     templateType = type;

  }
  public void InstantiateIn(System.Web.UI.Control container)
  {       
     Literal lc = new Literal();

     switch(templateType)
     {
        case ListItemType.Header:
           lc.Text = "<TABLE>";
           container.Controls.Add(lc);
           break;
        case ListItemType.Item:
        case ListItemType.AlternatingItem:
           //lc.Text = "<TR><TD>";
           lc.DataBinding += new EventHandler(TemplateControl_DataBinding);
           container.Controls.Add(lc);
           break;
        case ListItemType.Footer:
           lc.Text = "</TABLE>";
           container.Controls.Add(lc);
           break;
     }
  }

    private void TemplateControl_DataBinding(object sender,
    System.EventArgs e)
          {

              Literal lc;
              lc = (Literal)sender;
              RepeaterItem container = (RepeaterItem)lc.NamingContainer;
              ListItemType itmType = container.ItemType;

              //construct the repeater row using a custom function that switches on item type; HEADER vs ITEM vs ALTERNATINGITEM
              lc.Text += GetPopulatedRepeaterRow(dataInterface, container.DataItem, container.ItemType); 
              ... 
```

# windows - 如何通过软件重新检测 USB 闪存？

> ID：344049
> 
> 赞同：5
> 
> 时间：2008-12-05T14:54:42.787
> 
> 标签：windows, flash, usb

在Windows系统托盘中选择“安全删除”选项后，有什么方法可以通过代码重新检测我的Flash，而无需将其拔出并再次将其插入计算机USB端口？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-12-06T16:58:38.463

您可以查看重新扫描系统以查找设备。使用 Microsoft 的[devcon](http://support.microsoft.com/kb/311272)工具对此进行测试（这演示了 SetupAPI 和 CfgMgr32 功能）。该工具的源代码可在[Windows DDK](http://www.microsoft.com/whdc/devtools/ddk/default.mspx)中找到。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-19T20:00:21.240

“USB 安全删除”程序可以做到这一点，甚至更多。但是是共享软件。

# visual-studio - 如何处理解决方案资源管理器和四处走动？建议和改进！

> ID：344053
> 
> 赞同：1
> 
> 时间：2008-12-05T14:55:38.150
> 
> 标签：visual-studio, ide

我发现解决方案资源管理器有时运行起来有点慢，并且认为那里可能有更好的 UI 解决方案。我喜欢 Ctrl+T 但有时视觉提示比记住类名更好？

我认为如果你有第二个类似的窗口，它只显示当前会话期间打开的文件会很好吗？任何其他建议

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-05T16:16:34.087

如果您想将您的体验提升到一个新的水平，您需要拥有 Visual AssistX。它可以在您的代码和它所来自的文件之间建立链接。而且它的重量也很轻。您很快就会忘记解决方案资源管理器。

[http://www.wholetomato.com](http://www.wholetomato.com)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-05T16:30:56.633

在工具栏的搜索框中，您可以键入“> of”。当您输入文件名时，它将在您的解决方案中为您提供类似智能感知的文件下拉列表（例如，如果这两个文件在您的解决方案中，则“>of def”将显示“default.aspx”和“default.aspx.vb” ）。

我不确定这是否比 ctrl+t 更神秘/更少，但我想我会把它扔在那里。

# .net - 为什么StartInfo（ProcessStartInfo）总是空的？

> ID：344056
> 
> 赞同：7
> 
> 时间：2008-12-05T14:57:39.567
> 
> 标签：.net, process

根据[MSDN](http://msdn.microsoft.com/en-us/library/system.diagnostics.process.startinfo(VS.80).aspx)：

*如果您没有使用**Start**方法启动进程，则**StartInfo**属性不会反映用于启动进程的参数。例如，如果您使用**GetProcesses**获取计算机上运行的进程数组，则每个**Process的****StartInfo**属性不包含用于启动进程的原始文件名或参数。*

 **好吧，这很有意义。我的问题是为什么即使您使用 Process.Start() 这些参数也是空白的？

例如：

```
 Dim startInfo As New ProcessStartInfo("firefox.exe")
    startInfo.Arguments = "www.stackoverflow.com"
    startInfo.WindowStyle = ProcessWindowStyle.Minimized
    Process.Start(startInfo)
    For Each proc As Process In Process.GetProcessesByName("firefox")
        Debug.Print(String.Format("ProcessID={0}; Arguments={1}", _
        proc.Id, proc.StartInfo.Arguments))
    Next proc 
```

在这种情况下，即使我提供了参数，该属性仍然是空的：

[替代文字 http://www.sg-squared.com/images/startinfo.png](http://www.sg-squared.com/images/startinfo.png)

是什么赋予了？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-05T15:02:13.787

您从 GetProcessesByName 获得了一个不同的 Process 实例，该实例属于 MSDN 上语句的后一种情况。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-05T15:02:39.807

您仍在执行 GetProcess，因此它继续以相同的方式工作。你开始它的事实并没有什么不同。

Process.Start(...) 返回您启动的进程。我希望如果您检查 StartInfo 属性，它将被填充。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-27T20:05:39.710

Process.StartInfo 似乎总是为空！！！

我得到了整个正在运行的进程列表并尝试在 StartInfo 中转储值，但是所有 100 多个进程的 StartInfo 字段都是空的。

来自 MSDN：

“如果你没有使用Start方法启动一个进程，StartInfo属性不会反映用于启动进程的参数。例如，如果你使用GetProcesses获取计算机上运行的进程数组，那么StartInfo属性的每个进程不包含用于启动进程的原始文件名或参数。”

您现在必须使用 WMI 来获取该信息。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-05T15:08:27.657

呃，这很令人沮丧。我认为他们可能会使该文档更清晰一些，因为它很容易阅读为“如果您确实使用 Process.Start 则该信息将可用”。

我想我毕竟必须使用 WMI，嗯。

# deployment - 在哪里指定 Pocket PC 应用程序快捷方式的文本？

> ID：344059
> 
> 赞同：0
> 
> 时间：2008-12-05T14:58:52.233
> 
> 标签：deployment, windows-mobile, windows-ce, pocketpc

我不熟悉Pocket PC 开发，但我必须对VS2005、Pocket PC 2003 设备应用程序进行一些小的改动。其中一项更改（我认为这是微不足道的）是更改应用程序快捷方式的文本，但我无法弄清楚该文本的设置位置。该解决方案包括一个设置项目，所以我正在那里寻找它，但我找不到它。我知道它必须在某个地方，因为构建安装项目会生成一个包含快捷方式信息的 AppSetup.inf 文件。

这不可能那么难。当我在冰箱里找不到就在我面前的芥末瓶时，我正遭受我妻子所说的“男性视觉”的折磨。我在哪里指定此文本？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-05T15:15:06.363

这取决于快捷方式是如何生成的。通常使用 3 种机制。

1.  通过[INF 的 CEShortcuts 部分](http://msdn.microsoft.com/en-us/library/ms938387.aspx)。为此，它是第一个逗号之前的文本
2.  通过 INF 的[CopyFiles 部分](http://msdn.microsoft.com/en-us/library/ms938406.aspx)复制 LNK 文件。使用这种机制，您可以在桌面上创建一个物理 LNK 文件，该文件会滚动到 CAB 中，并像任何其他文件一样被复制。设备上的名称也是逗号前的第一个字符串。
3.  [通过自定义 CE Setup DLL](http://msdn.microsoft.com/en-us/library/aa924308.aspx)中的编程调用（通常是[SHCreateShortcut](http://msdn.microsoft.com/en-us/library/aa453680.aspx)）。

您必须弄清楚在您的部署方案中使用的是哪个，才能准确了解需要更改的内容。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-05T15:21:09.003

考虑更多这一点，您是否试图简单地在安装程序项目的 Studio UI 中找到更改快捷方式的位置？如果是这样，[这篇 MSDN 文章](http://msdn.microsoft.com/en-us/library/aa446504.aspx)可能会有所帮助。非常不直观的是，解决方案资源管理器顶部有一些小图标可以更改安装程序的视图，让您可以查看文件、注册表项等内容。您可能根本没有在看在右侧视图中，您需要选择不同的图标。没有菜单项可以执行这些图标的功能，并且在您第一次开始使用安装程序项目时很难注意到它们。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-05T15:59:09.210

好吧，正如我所怀疑的那样，它就在我面前。我们称这个项目为 PDAProject。在解决方案资源管理器中，PDAProjectSetup 项目下有一个标记为***Primary output from PDAProject (Active)***的项目。如果我**双击此项目**，代码编辑器窗口中会出现两个窗格。最左边的那个显示了一个标有*File System on Target Machine*的文件夹树。在此之下是三个文件夹，分别标记为*Application Folder*、*Program Files Folder*和*Programs Folder*。当我单击*Programs Folder*时，应用程序快捷方式出现在右侧窗格中，我可以修改其文本。

我不知道为什么我从来没有被迫双击*PDAProject（活动）*项目项的主要输出，即使这是您打开任何类或表单进行编辑的方式。我一直右键单击并打开属性。也许是时候放弃编程，开始编织篮子了。

# java - Swing JDialog 远程运行时速度慢

> ID：344063
> 
> 赞同：1
> 
> 时间：2008-12-05T14:59:33.370
> 
> 标签：java, swing, modal-dialog, x11, jdialog

在 X11 上远程运行我的 GUI 时，我遇到了 JDialogs 的性能问题。有谁知道解决方法？

当我在本地计算机上运行 GUI 时，它的速度很快，但有时我们需要在远程服务器上运行它，这会导致显着滞后，直到显示对话框。创建和显示它们大约需要 2 秒。

该问题似乎只适用于模态 JDialogs（包括 JOptionPanes）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-05T15:08:50.230

我在将纹理图像应用到我的窗户背景的外观和感觉上遇到了这个问题。它在 gui 设计器的盒子上运行良好，但是当我们在 LTSP X 终端上尝试它时，它运行缓慢。我们改变了一种无纹理的外观和感觉，事情变得更好了。

# sql - 数据库镜像和日志传送

> ID：344067
> 
> 赞同：1
> 
> 时间：2008-12-05T15:01:25.767
> 
> 标签：sql, sql-server, sql-server-2005, mirroring, log-shipping

我已经在同一实例上的 8 个数据库上设置了镜像和日志传送，每个大小约为 10 GB，但是现在当我想镜像另一个数据库时，显示“数据库属性”页面需要很长时间。对此问题的任何建议。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-09T12:20:30.067

我假设您正在使用“ALTER DATABASE [dbname] SET SAFETY FULL”，因为这将导致数据库同步更新（例如，在两个数据库服务器上提交之前，您的事务将不会完成）。

如果服务器之间的延迟很高，您将获得很大的性能损失。

您可以使用“ALTER DATABASE [dbname] SET SAFETY OFF”，它不会为您提供完整的镜像（从属设备可能落后，您必须手动进行故障转移），但您不会受到性能损失。

有关详细信息，请参阅 BOL。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-05T16:24:21.140

您可以设置跟踪并查看 GUI 调用 SQL 时发生的情况。

我在从 2000 年移至 2005 年的数据库中遇到了类似的问题，但它最终自行解决了。

# sql - SQL Server 聚集索引 - 索引顺序问题

> ID：344068
> 
> 赞同：8
> 
> 时间：2008-12-05T15:01:26.970
> 
> 标签：sql, sql-server, database, performance, indexing

我有一张这样的桌子：

```
keyA keyB data 
```

keyA 和 keyB 一起是唯一的，是我的表的主键并组成了一个聚集索引。

keyB 有 5 个可能的值，但 keyA 的可能值数量不受限制。keyB 通常递增。

例如，根据首先排序哪个键列，可以对以下数据进行 2 种排序：

```
keyA keyB data
A    1    X
B    1    X
A    3    X
B    3    X
A    5    X
B    5    X
A    7    X
B    7    X 
```

或者

```
keyA keyB data
A    1    X
A    3    X
A    5    X
A    7    X
B    1    X
B    3    X
B    5    X
B    7    X 
```

我是否需要告诉聚集索引哪些键列的可能值较少，以允许它首先按该值对数据进行排序？还是就性能而言，先订购哪个无关紧要？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-12-05T16:01:03.387

您应该首先使用最具选择性的列来订购复合聚集索引。这意味着与总行数相比，具有最不同值的列。

“B*TREE 索引提高了从表中选择一小部分行的查询的性能。” [http://www.akadia.com/services/ora_index_selectivity.html](http://www.akadia.com/services/ora_index_selectivity.html)？

本文适用于 Oracle，但仍然适用。

此外，如果您有一个持续运行并返回少量字段的查询，您可以考虑创建一个包含所有字段的复合索引 - 它不必访问基表，而是从索引中提取数据。

ligget78 关于确保提及复合索引中的第一列的评论很重要，请务必记住。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-12-05T15:09:18.483

如果您使用 (keyA, keyB) 创建索引（无论是否聚集），那么这就是值的排序方式，例如第一个 keyA，然后是 keyB（这是您问题中的第二种情况）。如果你想反过来，你需要指定（keyB，keyA）。

它在性能方面可能很重要，当然取决于您的查询。例如，如果您有 (keyA, keyB) 索引并且查询看起来像 WHERE keyB = ...（没有提及 keyA），则无法使用该索引。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-05T15:38:48.593

正如其他人所说，排序基于您在索引创建脚本（或 PK 约束）中指定的方式。不过，关于聚簇索引的一件事是需要牢记很多。

通过在 PK 以外的其他对象上使用聚集索引，您可能会获得更好的整体性能。例如，如果您正在编写财务系统并且报告几乎总是基于活动的日期和时间（过去一年的所有活动等），那么该日期列上的聚集索引可能会更好。正如 HLGEM 所说，排序也会受到您选择的聚集索引的影响。

与其他索引相比，聚集索引对插入的影响也更大。如果您有大量插入并且您的聚集索引位于类似 IDENTITY 列的位置，那么磁盘的特定部分可能会出现争用问题，因为所有新行都被插入到同一个位置。

对于小型查找表，我总是将聚集索引放在 PK 上。对于影响较大的表，尽管在选择最佳索引之前花时间考虑（和测试）各种可能的聚集索引是个好主意。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-05T15:07:24.507

我相信 SQL Server 完全按照您告诉它的方式对其进行排序。它假定您最了解如何访问您的索引。

无论如何，我会说最好在可能的情况下准确地指定您想要的东西，而不是希望数据库能弄清楚。

您也可以尝试两种方式，运行一堆有代表性的查询，然后比较生成的执行计划以确定哪个最适合您。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-12-05T15:46:59.857

请记住，聚集索引是表存储在磁盘上的物理顺序。

因此，如果您的聚集索引被定义为 ColA，ColB 查询在与聚集索引相同的顺序时会更快。如果 SQL 必须对 B、A 进行排序，则需要执行后排序才能获得正确的顺序。

我的建议是在 B、A 上添加第二个非聚集索引。还取决于您的数据列的大小来包含（读取包含的列）它以防止需要键查找。当然，前提是该表没有大量插入，因为您始终必须平衡查询速度与写入速度。

实际上，您的聚集索引应该代表最有可能访问数据的顺序，并保持插入\更新 IO 成本的微妙平衡。如果您的聚集索引经常插入到页面的中间，您可能会在那里遭受性能损失。

就像其他人所说，不知道表格长度、列大小等，就没有正确答案。进行大量测试的反复试验是您最好的选择。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-12-05T16:28:35.607

以防万一这不明显：*索引*的排序顺序并不能保证*查询中结果*的排序顺序。

在您的查询中，您仍然必须添加

```
ORDER BY KeyA, KeyB 
```

或者

```
ORDER BY KeyB, KeyA 
```

优化器可能会很高兴找到已经在索引中按物理顺序排序的数据并节省一些时间，但是每个应该以特定顺序传递数据的查询都必须在其末尾有一个 ORDER BY 子句。如果没有 order by，SQL Server 不会对记录集的顺序做出任何承诺，甚至不会承诺它会以相同的顺序从查询到查询返回。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-12-05T15:07:01.670

您可以做的最好的事情是尝试两种解决方案并测量执行时间。

根据我的经验，索引调优几乎是一门精确的科学。

也许在索引列顺序中在 keyA 之前有 keyB 会更好

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-12-05T15:19:00.460

您可以按照通常希望它们在报告和查询中排序的顺序来指定列。

不过，我会警惕创建多列聚集索引。根据它的宽度，您可能会对您创建的任何其他索引的大小产生巨大影响，因为所有非聚集索引都包含其中的聚集索引值。此外，如果值经常更改，则必须重新排序行，根据我的经验，非代理键往往会更频繁地更改。因此，如果您的值可能会更改，那么将其创建为聚集副非聚集索引可能会耗费更多的服务器资源时间。我并不是说您不应该这样做，因为我不知道您的列实际包含什么类型的数据（尽管我怀疑它们比 A1、a2 等更复杂）；我是说你需要考虑这样做的后果。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2012-06-26T06:27:17.433

是的，您应该建议，通常查询引擎会尝试找出最佳执行计划和要使用的索引，但有时最好强制查询引擎使用特定索引。在规划索引以及在查询中使用索引时，还有其他一些注意事项。例如，索引中的列排序，where 子句中的列排序。您可以参考以下链接了解：

[http://ashishhandelwal.arkutil.com/sql-server/quick-and-short-database-indexes/](http://ashishkhandelwal.arkutil.com/sql-server/quick-and-short-database-indexes/)

*   使用索引的最佳实践
*   如何获得最佳性能表单索引
*   聚集索引注意事项
*   非聚集索引注意事项

我相信这会在您规划索引时帮助您。

# c# - 单元测试项目可以加载目标应用程序的 app.config 文件吗？

> ID：344069
> 
> 赞同：164
> 
> 时间：2008-12-05T15:01:36.360
> 
> 标签：c#, .net, unit-testing, app-config

我正在对使用 app.config 文件加载配置属性的 .NET 应用程序 (.exe) 进行单元测试。单元测试应用程序本身没有 app.config 文件。

当我尝试对利用任何配置属性的方法进行单元测试时，它们返回*null*。我假设这是因为单元测试应用程序不会加载到目标应用程序的 app.config 中。

有没有办法覆盖这个或者我必须编写一个脚本来将目标 app.config 的内容复制到本地 app.config？

[这篇](https://stackoverflow.com/questions/168931/unit-testing-the-appconfig-file-with-nunit)文章有点问这个问题，但作者真的从与我不同的角度看待它。

**编辑：**我应该提到我正在使用 VS08 Team System 进行单元测试。

* * *

## 回答 #1

> 赞同：125
> 
> 时间：2009-10-06T22:27:25.960

在 Visual Studio 2008 中，我将该`app.config`文件作为现有项目添加到测试项目中，并选择复制作为链接以确保它不重复。这样我的解决方案中只有一个副本。有了几个测试项目，它就派上用场了！

[![添加现有项目](https://i.stack.imgur.com/Bl8Ss.png)](https://i.stack.imgur.com/Bl8Ss.png)

[![添加为链接](https://i.stack.imgur.com/j0DWV.png)](https://i.stack.imgur.com/j0DWV.png)

* * *

## 回答 #2

> 赞同：64
> 
> 时间：2008-12-05T15:16:22.523

最简单的方法是`.config`在单元测试的部署部分中添加文件。

为此，请`.testrunconfig`从您的解决方案项中打开该文件。在部署部分中，添加`.config`项目构建目录中的输出文件（大概是`bin\Debug`）。

部署部分中列出的所有内容都将在测试运行之前复制到测试项目的工作文件夹中，因此您的配置相关代码将运行良好。

编辑：我忘了补充，这在所有情况下都不起作用，因此您可能需要包含一个启动脚本，该脚本重命名输出`.config`以匹配单元测试的名称。

* * *

## 回答 #3

> 赞同：56
> 
> 时间：2008-12-05T15:43:18.477

无论您使用的是**Team System Test**还是**NUnit**，最佳实践是为您的测试创建一个单独的类库。 *只需将 App.config 添加到您的测试项目中，就会在您编译时自动复制到您的 bin 文件夹*中。

如果您的代码依赖于特定的配置测试，我将编写的第一个测试验证配置文件是否可用（*这样我就知道我没有发疯*）：

```
<configuration>
   <appSettings>
       <add key="TestValue" value="true" />
   </appSettings>
</configuration> 
```

和测试：

```
[TestFixture]
public class GeneralFixture
{
     [Test]
     public void VerifyAppDomainHasConfigurationSettings()
     {
          string value = ConfigurationManager.AppSettings["TestValue"];
          Assert.IsFalse(String.IsNullOrEmpty(value), "No App.Config found.");
     }
} 
```

理想情况下，您应该编写代码，以便将配置对象传递到您的类中。这不仅将您与配置文件问题分开，而且还允许您为不同的配置场景编写测试。

```
public class MyObject
{
     public void Configure(MyConfigurationObject config)
     {
          _enabled = config.Enabled;
     }

     public string Foo()
     {
         if (_enabled)
         {
             return "foo!";
         }
         return String.Empty;
     }

     private bool _enabled;
}

[TestFixture]
public class MyObjectTestFixture
{
     [Test]
     public void CanInitializeWithProperConfig()
     {
         MyConfigurationObject config = new MyConfigurationObject();
         config.Enabled = true;

         MyObject myObj = new MyObject();
         myObj.Configure(config);

         Assert.AreEqual("foo!", myObj.Foo());
     }
} 
```

* * *

## 回答 #4

> 赞同：24
> 
> 时间：2012-11-10T12:32:56.920

如果您有一个包含例如 Web 应用程序和测试项目的解决方案，您可能希望测试项目使用 Web 应用程序的 web.config。

解决它的一种方法是将 web.config 复制到测试项目并将其重命名为 app.config。

另一个更好的解决方案是修改构建链并使其自动复制 web.config 以测试项目输出目录。为此，请右键单击测试应用程序并选择属性。现在您应该看到项目属性。单击“构建事件”，然后单击“编辑构建后...”按钮。在此处写入以下行：

```
copy "$(SolutionDir)\WebApplication1\web.config" "$(ProjectDir)$(OutDir)$(TargetFileName).config" 
```

然后单击确定。（请注意，您很可能需要将 WebApplication1 更改为您要测试的项目名称）。如果您的 web.config 路径错误，则复制失败，您会在构建失败时注意到它。

**编辑：**

从当前项目复制到测试项目：

```
copy "$(ProjectDir)bin\WebProject.dll.config" "$(SolutionDir)WebProject.Tests\bin\Debug\App.Config" 
```

* * *

## 回答 #5

> 赞同：10
> 
> 时间：2016-03-10T22:50:53.770

这有点旧，但我找到了更好的解决方案。我在这里尝试选择的答案，但看起来 .testrunco​​nfig 已经过时了。

# 1.对于单元测试，包装配置是一个接口（IConfig）

对于单元测试，配置真的不应该是你的测试的一部分，所以创建一个你可以注入的模拟。在这个例子中，我使用的是 Moq。

```
Mock<IConfig> _configMock;
_configMock.Setup(config => config.ConfigKey).Returns("ConfigValue");
var SUT = new SUT(_configMock.Object); 
```

# 2.集成测试，动态添加你需要的配置

```
Configuration config = ConfigurationManager.OpenExeConfiguration(ConfigurationUserLevel.None);
if(config.AppSettings.Settings[configName] != null)
{
    config.AppSettings.Settings.Remove(configName);
}
config.AppSettings.Settings.Add(configName, configValue);
config.Save(ConfigurationSaveMode.Modified, true);
ConfigurationManager.RefreshSection("appSettings"); 
```

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2015-11-24T07:45:42.440

这很容易。

*   右键单击您的测试项目
*   添加-->现有项目
*   您可以在“添加”按钮旁边看到一个小箭头
*   选择配置文件点击“添加为链接”

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2008-12-05T15:18:46.030

如果您使用的是 NUnit，请查看[这篇文章](http://www.cornetdesign.com/2005/08/nunit-appconfig-files-its-all-about.html)。基本上，您需要将 app.config 与 .nunit 文件放在同一目录中。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2013-07-30T14:01:09.717

如果您的应用程序正在使用诸如 Asp.net ConnectionString 之类的设置，您需要将属性 HostType 添加到您的方法中，否则即使您有 App.Config 文件，它们也不会加载。

```
[TestMethod]
[HostType("ASP.NET")] // will load the ConnectionString from the App.Config file
public void Test() {

} 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-12-05T15:20:58.740

我使用**NUnit**，并且在我的项目目录中，我有一个 App.Config 的副本，我更改了一些配置（例如我重定向到测试数据库......）。您需要将它放在测试项目的**同一目录**中，就可以了。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2012-10-29T13:07:01.353

我无法得到任何这些建议来使用 nUnit 2.5.10，所以我最终使用 nUnit 的 Project -> Edit 功能来指定要定位的配置文件（正如其他人所说，它需要与 . nunit 文件本身）。这样做的积极方面是我可以给配置文件一个 Test.config 名称，这使它更清楚它是什么以及它为什么是）

* * *

## 回答 #11

> 赞同：-1
> 
> 时间：2019-12-02T17:36:53.797

您的单元测试被视为运行代码以对其进行测试的环境。就像任何正常的环境一样，你有即分期/生产。您可能还需要`.config`为您的测试项目添加一个文件。一种解决方法是创建一个类库并通过添加必要的 NuGet 包（例如 NUnit 和 NUnit Adapter）将其转换为测试项目。它与 Visual Studio Test Runner 和 Resharper 都可以正常工作，并且您的`app.config`文件在您的测试项目中。 [![在此处输入图像描述](https://i.stack.imgur.com/R55ng.png)](https://i.stack.imgur.com/R55ng.png)

[![在此处输入图像描述](https://i.stack.imgur.com/LMBYU.png)](https://i.stack.imgur.com/LMBYU.png)

[![在此处输入图像描述](https://i.stack.imgur.com/GMWzI.png)](https://i.stack.imgur.com/GMWzI.png)

[![在此处输入图像描述](https://i.stack.imgur.com/EqWxX.png)](https://i.stack.imgur.com/EqWxX.png)

最后从以下位置调试了我的测试和值`App.config`：

[![在此处输入图像描述](https://i.stack.imgur.com/kZehh.png)](https://i.stack.imgur.com/kZehh.png)

# performance - 另一个关于 ajax.net 更新面板性能线程

> ID：344070
> 
> 赞同：1
> 
> 时间：2008-12-05T15:01:50.917
> 
> 标签：performance, ajax.net, panels

再会，

我们刚刚从 asp.net 1.1 迁移到 asp.net 2.0。我们正在使用 ajax 更新面板。

在 Apress 书籍 (Pro asp.net 2008) 中，我读到当您使用更新面板时，您不会减少发送的带宽计数，因为仍然会发送整个页面。

考虑到这一点，我还在许多网站上读到，最好使用多个更新面板而不是只使用一个包含整个页面的更新面板来“减少发送的带宽量”。在我看来，这与 Apress 的书存在矛盾，我想知道你们的想法。

只使用一个包含整个页面的更新面板，还是使用多个更新面板更好？性能是我主要关心的问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-12-05T15:09:37.560

这取决于您希望能够单独加载页面的多少部分，每个部分都需要一个面板。

完整的视图状态始终与回发一起发送到服务器。

问候 K

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-08T09:53:59.693

这取决于您希望能够单独加载页面的多少部分。

每个面板 = 单独的可更新部分

问候 K

# vba - 上个月在 VBA Excel 中

> ID：344072
> 
> 赞同：1
> 
> 时间：2008-12-05T15:02:23.690
> 
> 标签：vba, excel

我有一张包含大量信息的表格，我如何选择最近几个月的价值？（即仅列中的最后 31 个单元格？）

数据在表格中

```
date1       numbers
date2       numbers
.             .
.             .
.             .
daten       numbers 
```

其中 date1 是 dd/mm/ccyy

干杯

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-05T15:17:48.997

理想情况下，会有一个包含日期的列。然后你可以做一个高级过滤器来过滤你需要的日期范围。选择过去 31 天并不总是只选择一个月。它也可以从上个月中选择最多 3 天。

* * *

```
Public Sub selectLastMonth()
  Dim ws As Worksheet
  Dim dStart As Date, dEnd As Date

  Set ws = ActiveSheet
  ws.Range("A:B").Sort key1:=ws.Range("A2"), header:=xlYes

  dEnd = ws.Range("A1").End(xlDown).Value
  dStart = DateSerial(DatePart("yyyy", dEnd), DatePart("m", dEnd), 1)

  ws.Range("A:B").AutoFilter field:=1, Criteria1:=">=" & dStart, Operator:=xlAnd, Criteria2:="<=" & dEnd

  Set ws = Nothing
End Sub 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-05T15:16:17.783

采用

```
LastRow = Sheet.Cells.SpecialCells(Excel.XlCellType.xlCellTypeLastCell).Row 
```

然后，如果您有指定的日期，则可以获取从 LastRow-31 到 LastRow 的范围，然后将起点向前移动直到日期值 = date(if(now.month=1,now.year-1,now.year) , if(now.month=1,12,now.month-1), now.day)

# java - 这是对分布式机制的现实期望吗？

> ID：344078
> 
> 赞同：4
> 
> 时间：2008-12-05T15:03:21.677
> 
> 标签：java, distributed, activemq

我一直在评估 ActiveMQ 作为候选消息代理。我编写了一些测试代码来尝试了解 ActiveMQ 的性能限制。

我可以通过尽可能快地发送消息来在代理中产生失败状态，如下所示：

```
try {
    while(true) {
        byte[] payload = new byte[(int) (Math.random() * 16384)];
        BytesMessage message = session.createBytesMessage();
        message.writeBytes(payload);
        producer.send(message);
} catch (JMSException ex) { ... } 
```

我很惊讶这条线

```
producer.send(message); 
```

当代理进入失败状态时阻塞。我希望会抛出一些异常，所以会有一些迹象表明经纪人失败了。

我意识到我的测试代码正在向代理发送垃圾邮件，并且我希望代理会失败。但是，我更希望经纪人“大声”失败，而不是简单地阻止。

这是不切实际的期望吗？

更新：

Uri 的回答引用了 3 月份提交的 ActiveMQ 错误报告。错误描述包括一个听起来像我正在寻找的提案：“如果传输上的请求有超时（这是为了捕获失败场景，所以一些不应该合理发生的事情），事情就会出错而不是而不是建立等待线程。”

但是，在 8 个月后，该错误目前已通过单次投票取消分配。所以我想问题仍然存在，这是 ActiveMQ 应该（将会？）实现的吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-05T16:02:05.537

您正在测试所有消息代理必须处理的[“慢消费者”和生产者流程控制问题。](http://activemq.apache.org/producer-flow-control.html)你想让生产者失败，阻止他们还是假脱机到磁盘？

基本上，ActiveMQ 中的开箱即用默认设置是块生产者。但是您可以[将消息游标配置为假脱机到磁盘](http://activemq.apache.org/message-cursors.html)。

顺便说一句，您没有说您是使用队列/主题还是持久/非持久；如果您使用的是非持久主题，则可以使用其他策略来丢弃消息等。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-05T16:05:14.797

显然有一个已知问题，不确定是否已修复：

[https://issues.apache.org/activemq/browse/AMQ-1625](https://issues.apache.org/activemq/browse/AMQ-1625)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-05T15:08:30.077

不确定 ActiveMQ 配置，但其他 JMS 提供程序有各种配置选项 - 因此您也许可以让 ActiveMQ 在这种情况下按照您的意愿行事。

我知道 Fiorano 可以选择在这种情况下指定提供者是否阻止。

# msbuild - 在 MSbuild 中检索多个 DLL 的程序集版本信息

> ID：344079
> 
> 赞同：1
> 
> 时间：2008-12-05T15:03:22.893
> 
> 标签：msbuild, assemblies

对于将输出为 DLL 的给定项目，我对编写程序集版本信息相当满意。

但是，我现在要做的是遍历 \Bin 文件夹中的每个 DLL，检索程序集信息并将其写入 versions.txt 文件。

有没有人设法实现了类似的目标？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2010-05-14T09:14:28.677

您可以使用`WriteVersionToFile`下面定义的 MSBuild 目标：

```
<PropertyGroup>
  <VersionsFile>versions.txt</VersionsFile>
</PropertyGroup> 

<ItemGroup>
  <!-- Assemblies for which you want versions-->
  <AssemblyFiles Include="Bin\**\*.dll"/>
</ItemGroup>

<Target Name="ExtractVersions">
  <GetAssemblyIdentity AssemblyFiles="@(AssemblyFiles)">
    <Output TaskParameter="Assemblies" ItemName="MyAssemblyIdentities"/>
  </GetAssemblyIdentity>
  <Message Text="%(MyAssemblyIdentities.Name) - Version %(Version)"/>
</Target>

<Target Name="WriteVersionToFile" DependsOnTargets="ExtractVersions">
  <Delete Files="$(VersionsFile)" />
  <WriteLinesToFile File="$(VersionsFile)"
                    Lines="%(MyAssemblyIdentities.Name) - %(Version)"
                    Overwrite="false"
                    Encoding="Unicode"/>
</Target> 
```

输出文件`versions.txt`将如下所示：

```
ICSharpCode.SharpZipLib - 0.85.4.369
nunit.framework - 2.4.7.0
Test.Rules - 0.2.0.0 
```

# wpf - WPF 椭圆黑色背景

> ID：344085
> 
> 赞同：0
> 
> 时间：2008-12-05T15:06:20.097
> 
> 标签：wpf, background, ellipse

如何去除椭圆角落的黑色背景颜色？

[替代文字 http://publicimages.s3.amazonaws.com/ellipsewithblackbackground.PNG](http://publicimages.s3.amazonaws.com/ellipsewithblackbackground.PNG)

谢谢，

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-05T15:07:52.400

这是解决方案：

AllowsTransparency 应该为真。

# javascript - 您如何保护网页免受慢速广告跟踪网络信标的影响？

> ID：344092
> 
> 赞同：3
> 
> 时间：2008-12-05T15:07:57.003
> 
> 标签：javascript

我为一个大型网站工作。我们的营销部门要求我们在页面中添加更多的网络广告跟踪像素。我对跟踪广告活动的有效性没有任何问题，但是为这些像素提供服务的服务器可能不可靠。我敢肯定，你们中的大多数人都见过拒绝完成加载的网页，因为来自 yieldmanager.com 的像素无法完成下载。

如果像素永远不会完成下载，onLoad 永远不会触发，并且在我们的例子中，如果没有它，页面将无法运行。

我们还有戈麦斯的额外问题。正如您可能知道的那样，他们在世界各地都有测量网站速度的机器人，尽管他们的方法存在缺陷，但让我们在他们的测量中看起来不错是很重要的。他们的机器人执行 onLoad 处理程序。因此，即使我使用运行 onLoad 的脚本在其他所有操作完成后将像素添加到页面，如果像素需要 80 秒加载，我们仍然可以获得糟糕的 Gomez 分数。

我的解决方案是通过 onMouseMove 处理程序将像素添加到页面，因此只有人类会触发它们。你们有更好的想法吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-12-05T15:14:34.463

jQuery 和其他 JavaScript 框架可以通过使用诸如“文档就绪”函数之类的方法来帮助处理该问题，该函数在文档就绪时触发，无需等待所有图像。

我将直接引用 jQuery 教程：

> 大多数 Javascript 程序员最终做的第一件事就是在他们的程序中添加一些代码，类似于：window.onload = function(){ alert("welcome"); 里面是你想在页面加载时运行的代码。然而，有问题的是，直到所有图像下载完成（这包括横幅广告），Javascript 代码才会运行。首先使用 window.onload 的原因是，当您第一次尝试运行代码时，HTML“文档”尚未完成加载。为了避免这两个问题，jQuery 有一个简单的语句来检查文档并等待它准备好被操作，称为就绪事件：

```
 $(document).ready(function(){
   // Your code here
 }); 
```

您可以使用此事件来加载那些有问题的图像。

有关更多信息，请参阅此链接。

[http://docs.jquery.com/Tutorials:How_jQuery_Works](http://docs.jquery.com/Tutorials:How_jQuery_Works)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-07T23:43:29.753

我也为一个大型网站工作，这就是我们所做的：

1.  将广告调用移至页面底部，因此内容将首先显示（因为 JS 是同步的）。

2.  使用 Ajax 调用将广告（以允许页面在广告加载时可用）加载到隐藏元素中。

3.  该位置被移动到 DOM 中的正确位置并且“未隐藏”。

    *   根据页面，我们要么等待广告完成加载再移动位置，要么立即移动位置。

# php - 在同一个 PHP SOAP 服务器中处理对多个类的请求

> ID：344095
> 
> 赞同：4
> 
> 时间：2008-12-05T15:08:07.470
> 
> 标签：php, web-services, soap, wsdl

是否有可能拥有一个 PHP SOAP 服务器来处理对多个类（服务）的请求？

如果是，您能否展示一个示例实现？

如果不是，您能描述一下原因吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-05T15:36:21.580

您可以将其他服务包装在一个类中吗？完全未经测试，这只是一个想法......

```
MySoapService 类
{
  公共函数 __construct()
  {
     $this->_service1 = new Service1();
     $this->_service2 = new Service2();
  }

  // 你可以在这里使用 __call() 并拦截任何调用，
  // 从而避免在包装类中需要这些声明...

  公共函数 add($a, $b)
  {
     返回 $this->_service1->add($a, $b);
  }

  公共函数子（$a，$b）
  {
    返回 $this->_service2->sub($a, $b);
  }
}

服务1类
{
  公共函数 add($a, $b)
  {
    返回 $a + $b;
  }
}

服务类 2
{
  公共函数子（$a，$b）
  {
    返回 $a - $b;
  }
}

```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-06T18:26:56.553

另一个采用相同的一般想法（代理类） - 对于 php5 使用哈希将函数映射到回调。

```
class ServiceProxy {
    private $map = array();

    public function addMethod($name, $callback) {
        if(is_callable($callback)) {
            $this->map[$name] = $callback;
            return true;
        }
        return false;
    }      

    function __call($name, $args) {
        if(isset($map[$name])) {
            return call_user_func_array($map[$name], $args);
        } else {
            return null;
        }
    }
} 
```

例如，此类还可以使用反射 API 并添加来自对象的所有公共方法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-08T14:46:57.043

如果两个类的方法名称相同（但参数不同），那么您可以使用 func_get_args() 来分析参数并以这种方式区分方法。

如果他们采取相同的论点......那么你有点卡住了。

为什么不能只使用两个单独的 Web 服务？

# sql - 自连接查询

> ID：344098
> 
> 赞同：4
> 
> 时间：2008-12-05T15:08:41.027
> 
> 标签：sql, mysql, join, self-join

考虑下表：

```
mysql> select * from phone_numbers;
+-------------+------+-----------+
| number      | type | person_id |
+-------------+------+-----------+
| 17182225465 | home |         1 |
| 19172225465 | cell |         1 |
| 12129876543 | home |         2 |
| 13049876543 | cell |         2 |
| 15064223454 | home |         3 |
| 15064223454 | cell |         3 |
| 18724356798 | home |         4 |
| 19174335465 | cell |         5 |
+-------------+------+-----------+ 
```

我正在努力寻找那些有家用电话但没有手机的人。

此查询有效：

```
mysql> select h.*
    -> from phone_numbers h
    -> left join phone_numbers c
    -> on h.person_id = c.person_id
    -> and c.type = 'cell'
    -> where h.type = 'home'
    -> and c.number is null;
+-------------+------+-----------+
| number      | type | person_id |
+-------------+------+-----------+
| 18724356798 | home |         4 |
+-------------+------+-----------+ 
```

但是这个没有：

```
mysql> select h.*
    -> from phone_numbers h
    -> left join phone_numbers c
    -> on h.person_id = c.person_id
    -> and h.type = 'home'
    -> and c.type = 'cell'
    -> where c.number is null;
+-------------+------+-----------+
| number      | type | person_id |
+-------------+------+-----------+
| 19172225465 | cell |         1 |
| 13049876543 | cell |         2 |
| 15064223454 | cell |         3 |
| 18724356798 | home |         4 |
| 19174335465 | cell |         5 |
+-------------+------+-----------+ 
```

两者之间的唯一区别是`h.type = 'home'`条件的位置 - 第一个它在`where`子句中，第二个它是`on`子句的一部分。

为什么第二个查询不返回与第一个相同的结果？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-12-05T15:16:51.027

在第二个 SQL 中，条件 h.type = 'home' 是外部连接条件的一部分，而不是结果的过滤器。对于 h.type='cell' 的所有记录，条件 h.type = 'home' 为 FALSE，因此找不到“匹配”c 行 - 所以 c.number 为空，这是您唯一的过滤 (WHERE) 条件.

在伪代码中，您的第二个 SQL 的工作方式如下：

```
for each row in phone_numbers h /* Note this is ALL home AND cell phones */
   select c.number from phone_numbers c
   where h.person_id = c.person_id
   and h.type = 'home'
   and c.type = 'cell';
   if c.number is null (i.e. no row found)
     display h.*
   end if
end loop; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-05T15:30:22.403

当做左连接时，我以这种方式处理事情。在连接中，您需要指定实际将两个表链接在一起的 anny 字段以及来自连接右侧（连接中的第二个表）的任何过滤条件（有一个例外，我很快就会谈到）。连接左侧（第一个表）的过滤条件应该在 where 子句中，否则它们会错误地影响连接，如您所见（正如 Tony 很好地解释的那样）。连接右侧应该出现在 where 子句中的唯一情况是，如果您正在该表中查找空值（即，在第一个表中但不在第二个表中的记录）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-05-08T08:43:36.137

```
SEL * 
FROM phone_numbers T1
WHERE typeS='home' AND person_id NOT IN
(SELECT person_id FROM phone_numbers  T2 WHERE T1.person_id=T2.person_id AND  typeS='cell') 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-05-11T08:27:43.900

你可以试试这个查询，我希望它对你有用。

```
select * from phone_numbers
where person_id not in (select person_id from phone_numbers where type='cell') 
```

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2008-12-05T15:15:09.890

我不知道这是否会解决问题，但是...

以“and”开头的语句应该是 WHERE 子句的一部分，而不是 ON 子句的一部分。ON 子句应该**只**包含涉及哪些列用于连接表的语句。

# c++ - 使用 boost 库的多线程

> ID：344101
> 
> 赞同：4
> 
> 时间：2008-12-05T15:09:19.123
> 
> 标签：c++, multithreading, boost-thread, boost-bind

希望同时多次调用一个函数。我希望使用线程来调用一个函数，该函数将充分利用机器的能力。这是一台8核的机器，我的要求是使用机器cpu从10%到100%以上。

我的要求是使用 boost 类。有什么方法可以使用 boost 线程或线程池库来完成此任务吗？或者其他方式来做到这一点？

另外，如果我每次都必须调用具有不同参数的多个函数（使用单独的线程），那么最好的方法是什么？[使用boost或不使用boost]以及如何？

```
#include <iostream>
#include <fstream>
#include <string.h>
#include <time.h>
#include <boost/thread/mutex.hpp>
#include <boost/bind.hpp>

using namespace std;
using boost::mutex;
using boost::thread;

int threadedAPI1( );
int threadedAPI2( );
int threadedAPI3( );
int threadedAPI4( );

int threadedAPI1( ) {
    cout << "Thread0" << endl;
}

int threadedAPI2( ) {
    cout << "Thread1" << endl;
}

int threadedAPI3( ) {
    cout << "Thread2" << endl;
}

int threadedAPI4( ) {
    cout << "Thread3" << endl;
}

int main(int argc, char* argv[]) {

    boost::threadpool::thread_pool<> threads(4);
    // start a new thread that calls the "threadLockedAPI" function
    threads.schedule(boost::bind(&threadedAPI1,0));
    threads.schedule(boost::bind(&threadedAPI2,1));
    threads.schedule(boost::bind(&threadedAPI3,2));
    threads.schedule(boost::bind(&threadedAPI4,3));
    // wait for the thread to finish
    threads.wait();

    return 0;
} 
```

以上不起作用，我不确定为什么？:-(

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-12-05T18:22:53.770

我建议您阅读有关您使用的功能的文档。从您在詹姆斯霍普金的回答中的评论来看，您似乎不知道 boost::bind 的作用，而只是简单地复制粘贴了代码。

boost::bind 接受一个函数（称为 f），以及可选的多个参数，并返回一个函数，该函数在调用时使用指定的参数调用 f。

也就是说，`boost::bind(threadedAPI1, 0)()`（创建一个不带参数并使用参数 0 调用 threadedAPI1() 的函数，然后调用它）等价于`threadedAPI1(0)`.

由于您的线程 API 函数实际上并不接受任何参数，因此您不能将任何参数传递给它们。这只是基本的 C++。您不能调用`threadedAPI1(0)`，而只能调用 ，但是`threadedAPI1()`当您调用该函数时，您尝试（通过 boost::bind）将整数 0 作为参数传递。

因此，您的问题的简单答案是简单地定义 threadedAPI1 如下：

```
int threadedAPI1(int i); 
```

但是，避免 boost::bind 调用的一种方法是在启动线程时调用仿函数而不是自由函数。声明一个类似这样的类：

```
struct threadedAPI {
  threadedAPI(int i) : i(i) {} // A constructor taking the arguments you wish to pass to the thread, and saves them in the class instance.

  void operator()() { // The () operator is the function that is actually called when the thread starts, and because it is just a regular class member function, it can see the 'i' variable initialized by the constructor
    cout << "Thread" << i << endl; // No need to create 4 identical functions. We can just reuse this one, and pass a different `i` each time we call it.
  }
private:
  int i;
}; 
```

最后，根据您的需要，普通线程可能比线程池更适合。一般来说，线程池只运行有限数量的线程，因此它可能会将一些任务排队，直到其中一个线程完成执行。它主要适用于您有许多短期任务的情况。

如果您有固定数量的持续时间较长的任务，则为每个任务创建一个专用线程可能是可行的方法。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-12-05T17:01:33.950

您将参数绑定到不带参数的函数：

```
int threadedAPI1( );

boost::bind(&threadedAPI1,0) 
```

如果没有参数，直接传递函数即可：

```
threads.schedule(&threadedAPI1) 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-12-05T15:24:32.430

如果您对高效使用处理器感兴趣，那么您可能需要考虑英特尔线程构建块[http://www.intel.com/cd/software/products/asmo-na/eng/294797.htm](http://www.intel.com/cd/software/products/asmo-na/eng/294797.htm)。我相信它是专门为使用多核处理器而设计的，而增强线程将控制权留给用户（即，与双核相比，四核上的 TBB 线程会有所不同）。

至于您的代码，您正在绑定不将参数传递给参数的函数。为什么？您可能还想检查计划中的返回代码。

# php - 数组查找（包括数组构建）或 IF 堆栈哪个更快？

> ID：344104
> 
> 赞同：1
> 
> 时间：2008-12-05T15:09:49.603
> 
> 标签：php

我想知道哪个更好：

```
$lookup = array( "a" => 1, "b" => 2, "c" => 3 );
return $lookup[$key]; 
```

或者

```
if ( $key == "a" ) return 1
else if ( $key == "b" ) return 2
else if ( $key == "c" ) return 3 
```

或者也许只是一个不错的开关......

```
switch($key){
case "a": return 1;
case "b": return 2;
case "c": return 3;
} 
```

我总是更喜欢第一种方法，因为我可以将数据与代码分开；在这个规模上，它看起来很傻，但规模更大，有数千行查找条目；PHP 需要多长时间来构建一个数组，然后每个请求只检查 1 或 2 个条目。

我认为它必须经过测试和计时，但我会说阵列越大越复杂，它就会变得越慢。

PHP 应该能够比我在 PHP 代码中更快地处理查找，但是首先构建数组肯定会占用大量时间。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-05T15:18:49.570

对于任何具有可衡量性能的东西（不仅仅是 3 个条目），查找是最快的方法。这就是哈希表的用途。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-05T15:21:17.133

首先，很容易自己测试。

其次，更重要的是，哪个最适合您使用的代码？在任何情况下，您节省的时间都可以忽略不计。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-05T15:14:25.587

将有一个临界点，您只需进行测试即可找到它。我的猜测是使用 if/then/else 的 3 个项目会更好。[这是一篇](http://gurmeetsingh.wordpress.com/2008/08/05/fast-bit-counting-routines/)关于位计数的好文章，它比较了计算位数和使用查找。剧透：查找赢了！

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-05T15:19:36.933

您是每次都构建阵列，还是可以构建一次并缓存它？

如果你每次都在构建它，我看不出它怎么会更快。自行构建数组应该比链式 if() 花费更长的时间（将一项添加到数组中将及时接近一项 if()，但是当您可以退出 if 时，您必须添加每个项（） 早期的）

如果您可以使用缓存数组，那么我认为那将是明显的赢家。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-12-05T16:18:32.897

所以我用*这个*例子做了一些测试，得到了以下结果：

```
emptyfunction:  0.00000087601416110992430969503855231472755349386716
lookuparray:    0.00000136602194309234629100648257538086483009465155
makearrayonly:  0.00000156002373695373539708814922266633118397294311
makearray:      0.00000174602739810943597796187489595842734502184612
ifblock:        0.00000127001986503601083772739543942265072473674081
switchblock:    0.00000131001937389373773757957151314679222764425504 
```

每个都在一个方法中，所以我还包括了一个空方法的时间。它们分别运行 1,000,000 次，然后取平均值。

仅进行查找（不构建数组）实际上比 if 块（使用与我的代码相同的全局查找）慢，并且比 switch 块慢一点。

我不介意将它扩展到数百个 if 语句，但它只是表明 if 语句即使在这个级别上对单个查找也更快。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-05T15:24:02.947

如果您有数千个条目，那么数组查找将胜出。关联数组可能有点慢，但是找到一个数组键比做数千个块要快得多`if()`（更不用说输入它所花费的时间了！）

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-12-05T17:00:50.847

您可以测试查看该值是否也不存在需要多长时间。我的猜测是数组键查找会更快。如果您必须查询它两次或更多次，缓存数组应该会使其更快。

但是速度在这里并不是最重要的。从长远来看，数组键更适合您要添加和删除数据的地方。您将来还可以从其他来源获取数据。

*   如果您只想查找一个值，请使用数组。
*   如果你想采取行动，那么 if 和 switch 都有它们的用途。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-12-05T18:35:29.067

这是对数组操作的一个小测试

```
{
    $x = 0;
    foreach ($test as $k => $v) {
        $x = sprintf(” % s=>%sn”,$k,$v);}
}
{
    $x = 0;
    reset($test);
    while (list($k, $v) = each($test)) {
        $x = sprintf(” % s=>%sn”,$k,$v);
     }
}
{
    $x = 0;
    $k = array_keys($test);
    $co = sizeof($k);
    for ($it = 0; $it < $co; $it++) {
        $x = sprintf(” % s=>%sn”,$k[$it],$test[$k[$it]]);
     }
}
{
    $x = 0;
    reset($test);
    while ($k = key($test)) {
        $x = sprintf(” % s=>%sn”,$k,current($test)); next($test);
     }
} 
```

> 访问时间（毫秒）
> 8.1222
> 10.3221
> 9.7921
> 8.9711

# javascript - 搜索和替换

> ID：344105
> 
> 赞同：4
> 
> 时间：2008-12-05T15:10:26.903
> 
> 标签：javascript

我正在做一个新项目，我想做一些与智能文本广告类似的事情（不知何故）（虽然没有弹出窗口）。事实上，我想在某些单词上添加链接。问题是我不知道如何处理这个问题。

我的意思是，好的，我得到了 document.innerHTML 然后呢？我可以找到任何单词，但有些可能在标签内。我不想替换文本区域中的单词或链接内的文本。输入、选择等也是如此。

此外，我管理事物的方式，我什至替换了 html 标签（`select`例如，如果这个词是，脚本将替换`<select>`标签。我真的不想要这个：P

那么，有什么想法吗？从哪儿开始 ？该怎么办？任何事物？

我希望有一个没有任何库的解决方案，或者，如果是强制性的，可以使用 jquery（这是我所知道的）。

我认为一些正则表达式可能会有所帮助。问题是......我从来不理解他们：s

任何帮助将不胜感激。非常感谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-05T15:14:14.150

jQuery 已经做到了！

只需用于`.text()`获取下面的所有文本。文档和示例[在这里](http://docs.jquery.com/Attributes/text)。

# java - 是否有用于 Java 应用服务器的 .NET 类似物？

> ID：344107
> 
> 赞同：6
> 
> 时间：2008-12-05T15:12:15.870
> 
> 标签：java, .net, servlets

Java 社区中是否有任何被称为 .NET 的“应用程序服务器”的东西？类似于 Tomcat、Resin 和 Jetty。我对 JSP 等价物不感兴趣，我正在寻找一种基于 servlet 的 XML/HTTP 事务处理技术（无 UI）。

如果没有这样的产品，模仿这个的好的堆栈是什么？

微软似乎通过说 Window Server + .NET + IIS + 你的代码 = 应用服务器来避开这一点，但似乎必须编写很多管道代码才能到达与 Tomcat 相同的位置。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-12-05T15:25:42.630

[WCF](http://msdn.microsoft.com/en-us/netframework/aa663324.aspx)或 Web 服务 (ASMX) 似乎都适合您想要的。如果您不想走完整的 SOAP 路线，WCF 可能更合适。您可以在 IIS、控制台应用程序或 Windows 服务中托管 WCF。根据您的需要，它可以使用 SOAP、简单 XML 甚至 Json 进行编码。至于传输，您可以使用 HTTP、IP 或消息队列。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-05T15:18:34.907

[我猜，都柏林](http://www.microsoft.com/net/Dublin.aspx)将是你要找的。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-12-05T15:20:30.723

我认为您正在寻找 Http 处理程序。您可以在没有 aspx 页面的情况下处理低级别的请求。[MSDN 参考](http://msdn.microsoft.com/en-us/library/bb398986.aspx)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-12-05T15:33:45.063

由于 Microsoft 企业应用程序的目标不是在 Java 等任何平台上运行，因此对 .NET 的需求与 WebLogic 或 WebSphere 等 Java 应用服务器相当。Java 应用服务器提供的许多技术是由 Windows 操作系统或 .NET 核心库提供的。您可以直接比较 JMS 与 MSMQ 等单独的技术，但在整体架构中比较少。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-05T18:57:18.973

> 我对 JSP 等价物不感兴趣，我正在寻找一种基于 servlet 的 XML/HTTP 事务处理技术（无 UI）。

听起来像我一直在做的事情。我使用 WCF 进行通信并将程序作为 Windows 服务托管。Windows 服务有很多不错的功能，例如远程监控和在不太可能发生的崩溃时自动重启的能力。

# java - 如何在 JSP / Servlet 中获取用户角色

> ID：344117
> 
> 赞同：11
> 
> 时间：2008-12-05T15:14:32.107
> 
> 标签：java, authentication, jsp, servlets, jboss

有没有办法获得一个字符串 [] 与用户在 JSP 或 Servlet 中的角色？

我知道 request.isUserInRole("role1") 但我也想知道用户的所有角色。

我搜索了 servlet 源，似乎这是不可能的，但这对我来说似乎很奇怪。

所以......有什么想法吗？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-12-05T15:22:58.627

答案很乱。

首先，您需要找出 request.getUserPrincipal() 在您的 web 应用程序中返回的类型。

```
 System.out.println("type = " + request.getUserPrincipal().getClass()); 
```

假设返回 org.apache.catalina.realm.GenericPrincipal。

然后将 getUserPrincipal() 的结果转换为该类型并使用它提供的方法。

```
 final Principal userPrincipal = request.getUserPrincipal();
    GenericPrincipal genericPrincipal = (GenericPrincipal) userPrincipal;
    final String[] roles = genericPrincipal.getRoles(); 
```

我说会很乱。它也不是很便携。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-12-05T15:41:49.650

阅读所有可能的角色，或硬编码一个列表。然后迭代它运行 isUserInRole 并构建用户所在角色的列表，然后将列表转换为数组。

```
String[] allRoles = {"1","2","3"};
HttpServletRequest request = ... (or from method argument)
List userRoles = new ArrayList(allRoles.length);
for(String role : allRoles) {
 if(request.isUserInRole(role)) { 
  userRoles.add(role);
 }
}

// I forgot the exact syntax for list.toArray so this is prob wrong here
return userRoles.toArray(String[].class); 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2016-05-18T11:27:34.107

在 WebLogic 中，您可以这样做：

```
import weblogic.security.Security;
import weblogic.security.SubjectUtils;
...
private List<String> getUserRoles()  {
    return Arrays.asList(SubjectUtils.getPrincipalNames(Security.getCurrentSubject()).split("/"));
} 
```

请注意，列表中的第一个元素是用户名。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2018-01-29T11:07:20.023

在符合 JACC 的应用程序服务器上——理论上每个完整的 Java EE 平台实现——`Policy`可以询问 Java SE 以（几乎）可移植地评估 Servlet 和 EJB 指定的任何类型的声明性安全约束。我说*几乎*是因为 JACC 和 Javadoc 规范`Policy#getPermissions(ProtectionDomain)`实际上都没有要求实现即时计算所有权限，大概是出于性能考虑，以及为授权语句的呈现依赖于附加上下文（远程地址、值某个 HTTP GET 参数等）。尽管如此，`getPermissions`与典型的预安装 JACC 提供程序一起使用通常应该是安全的。

以下示例演示了 Servlet 角色分配测试：

```
package com.example;

import java.security.CodeSource;
import java.security.Permission;
import java.security.PermissionCollection;
import java.security.Policy;
import java.security.Principal;
import java.security.ProtectionDomain;
import java.security.cert.Certificate;
import java.util.Collections;
import java.util.Enumeration;
import java.util.HashSet;
import java.util.Set;

import javax.security.auth.Subject;
import javax.security.jacc.PolicyContext;
import javax.security.jacc.PolicyContextException;
import javax.security.jacc.WebRoleRefPermission;

public final class Util {

    private static final Set<String> NO_ROLES = Collections.emptySet();
    private static final Permission DUMMY_WEB_ROLE_REF_PERM = new WebRoleRefPermission("", "dummy");

    /**
     * Retrieves the declared Servlet security roles that have been mapped to the {@code Principal}s of
     * the currently authenticated {@code Subject}, optionally limited to the scope of the Servlet
     * referenced by {@code servletName}.
     * 
     * @param servletName
     *            The scope; {@code null} indicates Servlet-context-wide matching.
     * @return the roles; empty {@code Set} iff:
     *         <ul>
     *         <li>the remote user is unauthenticated</li>
     *         <li>the remote user has not been associated with any roles declared within the search
     *         scope</li>
     *         <li>the method has not been called within a Servlet invocation context</li>
     *         </ul>
     */
    public static Set<String> getCallerWebRoles(String servletName) {
        // get current subject
        Subject subject = getSubject();
        if (subject == null) {
            // unauthenticated
            return NO_ROLES;
        }
        Set<Principal> principals = subject.getPrincipals();
        if (principals.isEmpty()) {
            // unauthenticated?
            return NO_ROLES;
        }
        // construct a domain for querying the policy; the code source shouldn't matter, as far as
        // JACC permissions are concerned
        ProtectionDomain domain = new ProtectionDomain(new CodeSource(null, (Certificate[]) null), null, null,
                principals.toArray(new Principal[principals.size()]));
        // get all permissions accorded to those principals
        PermissionCollection pc = Policy.getPolicy().getPermissions(domain);
        // cause resolution of WebRoleRefPermissions, if any, in the collection, if still unresolved
        pc.implies(DUMMY_WEB_ROLE_REF_PERM);
        Enumeration<Permission> e = pc.elements();
        if (!e.hasMoreElements()) {
            // nothing granted, hence no roles
            return NO_ROLES;
        }
        Set<String> roleNames = NO_ROLES;
        // iterate over the collection and eliminate duplicates
        while (e.hasMoreElements()) {
            Permission p = e.nextElement();
            // only interested in Servlet container security-role(-ref) permissions
            if (p instanceof WebRoleRefPermission) {
                String candidateRoleName = p.getActions();
                // - ignore the "any-authenticated-user" role (only collect it if your
                // application has actually declared a role named "**")
                // - also restrict to the scope of the Servlet identified by the servletName
                // argument, unless null
                if (!"**".equals(candidateRoleName) && ((servletName == null) || servletName.equals(p.getName()))
                        && ((roleNames == NO_ROLES) || !roleNames.contains(candidateRoleName))) {
                    if (roleNames == NO_ROLES) {
                        roleNames = new HashSet<>();
                    }
                    roleNames.add(candidateRoleName);
                }
            }
        }
        return roleNames;
    }

    private static Subject getSubject() {
        return getFromJaccPolicyContext("javax.security.auth.Subject.container");
    }

    @SuppressWarnings("unchecked")
    private static <T> T getFromJaccPolicyContext(String key) {
        try {
            return (T) PolicyContext.getContext(key);
        }
        catch (PolicyContextException | IllegalArgumentException e) {
            return null;
        }
    }

    private Util() {
    }

} 
```

* * *

参考：

*   [JSR-115 / JACC 规范](https://jcp.org/en/jsr/detail?id=115)
*   [使用 JACC 确定调用者的角色](https://web.archive.org/web/20140620021252/https://blogs.oracle.com/monzillo/entry/using_jacc_to_determine_a)
*   [Java EE 如何将 web.xml 约束转换为 Permission 实例](http://arjan-tijms.omnifaces.org/2015/04/how-java-ee-translates-webxml.html)

# java - 如何将 java.util.Date 对象与 java.sql.Time 对象结合起来？

> ID：344128
> 
> 赞同：6
> 
> 时间：2008-12-05T15:17:11.633
> 
> 标签：java, date, time

我正在从数据库中提取日期和时间。它们存储在单独的字段中，但我想将它们组合成一个适当地反映日期/时间的 java.util.Date 对象。

这是我最初的方法，但它有缺陷。我总是得到一个比它应该是 6 小时的日期/时间。我认为这是因为 Time 和 Date 都有时区偏移量，而我真的只需要其中一个来获得时区偏移量。

有关如何执行此操作的任何建议，以便为我提供正确的日期/时间？

```
import java.sql.Time;
import java.util.Calendar;
import java.util.Date;

import org.apache.commons.lang.time.DateUtils;
    public static Date combineDateTime(Date date, Time time)
        {
            if (date == null)
                return null;
            Date newDate = DateUtils.truncate(date, Calendar.DATE);
            if (time != null)
            {
                Date t = new Date(time.getTime());
                newDate = new Date(newDate.getTime() + t.getTime());
            }
            return newDate;
        } 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-12-05T15:26:16.343

我会将日期和时间都放入日历对象中，然后使用各种日历方法从第二个对象中提取时间值并将它们放入第一个对象中。

```
 Calendar dCal = Calendar.getInstance();
  dCal.setTime(date);
  Calendar tCal = Calendar.getInstance();
  tCal.setTime(time);
  dCal.set(Calendar.HOUR_OF_DAY, tCal.get(Calendar.HOUR_OF_DAY));
  dCal.set(Calendar.MINUTE, tCal.get(Calendar.MINUTE));
  dCal.set(Calendar.SECOND, tCal.get(Calendar.SECOND));
  dCal.set(Calendar.MILLISECOND, tCal.get(Calendar.MILLISECOND));
  date = dCal.getTime(); 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-12-05T15:31:19.750

在做这些类型的事情时，使用 Joda Time 而不是 Java 自己的 Date 类。这是一个非常出色的日期/时间 API，它使您尝试做的事情变得非常简单和可靠。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-12-05T15:35:27.213

@Paul [Tomblin](https://stackoverflow.com/users/3333/paul-tomblin)是控制这个`TimeZone`问题的可靠方法，我知道有人会把“Joda Time”加入其中。其他答案都很好，比以下黑客更强大：

如果您的应用程序以`TimeZone`与数据库中的默认设置相同的方式执行，您可能能够摆脱以下情况：

如果您跳过此步骤：

```
Date t = new Date(time.getTime()); 
```

并直接使用该`java.sql.Time`值，例如：

```
newDate = new Date(newDate.getTime() + time.getTime()); 
```

`TimeZone`不会引入到默认值的转换-`java.sql.Time`应该包含存储的值。

YMMV、买者自保等……

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-05T15:33:00.633

假设您知道从数据库中读取的时间的时区，您需要使用`ResultSet.getTime(String, Calendar)`之前在`Calendar`. JDBC 驱动程序将对时间进行必要的调整。

如果所有代码都在服务器端运行，我强烈建议始终在公共时区（可能是 UTC）上进行标准化，并在 GUI 中显示渲染时进行适当的转换。

我也会使用 JodaTime ( [http://joda-time.sourceforge.net](http://joda-time.sourceforge.net) )，它会在未来让你头疼。

# vbscript - 我可以使用 WMI VB 脚本创建子进程吗？

> ID：344161
> 
> 赞同：1
> 
> 时间：2008-12-05T15:24:39.357
> 
> 标签：vbscript, process, wmi

使用 WMI VB 脚本，我想创建/附加多个子进程到父进程，例如资源管理器进程。

当一个应用程序通过点击启动时，它成为资源管理器进程的子进程。对于 Windows 启动时加载的所有应用程序也是如此。

如果您使用任务管理器中的“结束进程树”上下文菜单选项终止资源管理器进程，它也会终止资源管理器进程的所有子进程（一种快速、强力的方法来清理内存而无需重新启动）。

我有两个脚本 - 一个杀死一堆特定进程，另一个重新启动这些进程。

我脚本中的大多数进程/应用程序都是在启动时加载的，因此它们是资源管理器进程的子进程。如前所述，当我杀死资源管理器进程树时，所有这些进程都会死掉。

当我使用脚本重新启动这些应用程序时，它们不再是资源管理器进程的子进程。当我杀死资源管理器进程树时，脚本启动的应用程序不会死。

现在，我知道我可以使用脚本单独杀死每个进程。但是，在脚本中杀死资源管理器进程树而不必指定我想要杀死的单个应用程序会很好。

因此，如果我有一个脚本可以将我的应用程序作为资源管理器进程的子进程启动，那么我的另一个脚本只需要终止资源管理器进程树。

我有一个脚本可以做到这一点。它循环并杀死资源管理器进程的所有子进程。但是，它仅适用于在启动时加载或被点击的应用程序。

此外，通过阻止这些应用程序在启动时加载，Windows 加载速度要快得多。稍后，我会在需要时单击我的脚本图标来加载我的应用程序。

这就是为什么我想创建一个脚本，可以将应用程序作为资源管理器进程的子进程启动。

一个有趣的旁注：我必须推迟杀死任何命令/控制台进程，否则脚本可能会在获取其余进程之前杀死自己。

任何想法如何做到这一点？

下面是我失败的代码。

```
Option Explicit
dim wmi, rootProcessName, rootProcess, objStartup, objConfig, objProcess, strComputer, dropbox, itunes, skype
strComputer = "."

dropbox="C:\Program Files\Dropbox\Dropbox.exe"
itunes="C:\Program Files\iTunes\iTunes.exe"
skype="C:\Program Files\Skype\Phone\Skype.exe"

Const NORMAL = 32
Set wmi = GetObject("winmgmts:\\" & strComputer & "\root\cimv2")
Set objStartup =  wmi.Get("Win32_ProcessStartup")
Set objConfig = objStartup.SpawnInstance_
objConfig.PriorityClass = NORMAL

rootProcessName = "'explorer.exe'"
set rootProcess = wmi.ExecQuery("Select * from Win32_Process Where Name = " & rootProcessName )
For Each objProcess in rootProcess
    objProcess.Create dropbox, null, objConfig
    objProcess.Create itunes, null, objConfig
    objProcess.Create skype, null, objConfig
Next

WScript.Quit 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-09-05T22:50:37.567

# javascript - 在 javascript 中设置 HTML 元素的样式属性

> ID：344162
> 
> 赞同：33
> 
> 时间：2008-12-05T15:25:04.037
> 
> 标签：javascript, html, styles

我有一堆旧的经典 ASP 页面，其中许多在表中显示数据库数据。这些页面都没有内置任何排序功能：您将受到原始开发人员认为适合使用的任何 ORDER BY 子句的支配。

我正在快速修复通过客户端javascript进行排序的方法。我已经编写了一个脚本，它主要可以满足我的需要。但是，我仍然需要添加一点功能。这些页面中的表格行通常具有交替的行颜色，并且用于实现此目的的机制因页面而异。它可能像更改 CSS 类一样简单，或者样式可能已由 ASP 代码内联呈现。

现在，在对表格进行排序后，每一行都保持着色方案被渲染，因此交替的行不再交替。我希望用这样简单的方法来修复它：

```
/* "table" is a var for the table element I'm sorting.
   I've already verified it exists, and that there are at least three rows.
   At this point the first row (index 0) is always the header row.
 */

// check for alternating row styles:
var RowStyle = table.rows[1].style;
var AltStyle = table.rows[2].style;

// SORT HAPPENS HERE!!
//  snip  

// Apply alternating row styles
if (RowStyle === AltStyle) return true; 
for (var i=1,il=table.rows.length;i<il;i+=1)
{
    if (i%2==0) table.rows[i].style=RowStyle;
    else table.rows[i].style=AltStyle;                 
} 
```

不幸的是，你不能像这样设置元素的样式属性。它抱怨该对象没有设置器。我还能如何简单地做到这一点？这里不允许使用像 jQuery 这样的框架——这不在我的掌控之中。

**更新：**
虽然这将是最好的解决方案，但将 100 多个页面重构为所有使用类而不是内联样式是不切实际的。此外，有时涉及的不仅仅是背景颜色。例如，一行可能比交替行更暗或更亮，其中一种样式也具有不同的前景色以适应。或者交替的样式可能会以不同的方式设置边框。我真的不知道所有这些页面上使用了什么，所以我需要一些可以将*所有*样式从一行应用到另一行的东西。

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2008-12-05T15:38:31.590

您可以尝试抓住`cssText`and `className`。

```
var css1 = table.rows[1].style.cssText;
var css2 = table.rows[2].style.cssText;
var class1 = table.rows[1].className;
var class2 = table.rows[2].className;

// sort

// loop
    if (i%2==0) {
        table.rows[i].style.cssText = css1;
        table.rows[i].className = class1;
    } else {
        table.rows[i].style.cssText = css2;
        table.rows[i].className = class2;
    } 
```

不过，并不完全确定浏览器与`cssText`.

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2008-12-05T16:36:01.413

您可以设置任何元素的样式属性...诀窍是在 IE 中您必须以不同的方式进行操作。（[错误 245](http://webbugtrack.blogspot.com/2007/10/bug-245-setattribute-style-does-not.html)）

```
//Standards base browsers
elem.setAttribute('style', styleString);

//Non Standards based IE browser
elem.style.setAttribute('cssText', styleString); 
```

请注意，在 IE8 中，在标准模式下，第一种方法确实有效。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-12-05T16:08:33.870

对我来说，这有效：

```
function transferAllStyles(elemFrom, elemTo)
{
  var prop;
  for (prop in elemFrom.style)
    if (typeof prop == "string")
      try { elemTo.style[prop] = elemFrom.style[prop]; }
      catch (ex) { /* don't care */ }
} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-12-05T15:36:47.507

我想指出，通常最好更改节点的*类*而不是其样式，并让 CSS 处理这意味着什么。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-12-05T15:37:00.220

DOM 元素**样式**“属性”是元素上定义的所有样式属性的只读集合。（集合属性是只读的，不一定是集合中的项目。）

最好在元素上使用 className“属性”。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-05T15:32:30.493

不要设置样式对象本身，设置样式对象的背景颜色属性是元素的一个属性。

是的，即使你说不，jquery 和[tablesorter](http://www.tablesorter.com)及其斑马条纹插件也可以用 3 行代码为你完成这一切。

并且仅设置类属性会更好，因为那时您可以对更有条理的样式进行非硬编码控制

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-12-05T15:33:37.480

如果您只想更改行的颜色，您可以访问 style.backgroundColor 属性并设置它。

[这](https://web.archive.org/web/20100207224213/http://codepunk.hardwar.org.uk/css2js.htm)是一个 CSS 属性到 JS 转换的快速链接。

# javascript - JS - 关于如何将多个用户输入合并到一个表单域设计的建议

> ID：344168
> 
> 赞同：1
> 
> 时间：2008-12-05T15:26:50.133
> 
> 标签：javascript, layout, mootools

我有一个页面，允许用户输入很多关于他们的信息（元数据），然后他们可以单击一个图标，该图标打开一个模式窗口，其中包含一个允许他们添加位置的 googlemap，以及该位置的标题。

使用 mootools，我可以使用 onclose 将表单字段的值传递回原始表单。然后，主页表单有一个隐藏的输入字段，它作为一个字段进入数据库，序列化。

问题是用户可以根据需要添加任意数量的位置，也有 3 种类型的位置。每个都有自己的一组坐标，可以是单个或多个！

所以我想知道处理所有这些数据的最佳方式，是否可以将其加载到一个表单中，然后使用 Moo 将该表单提交到单个表单字段，或者我可以使用 moo 将所有信息附加到一个隐藏的输入字段，但如果我这样做，用户输入如何进入它。我很难过，并查看了一些有关如何以“最佳”方式进行设置的建议。

目前我有一个表，每个项目都添加为一个新行，当用户单击地图时，JS 会创建一个新行，其中包含有关单击、项目和用户输入字段的详细信息。

如果它是单个位置，则将其添加为“地标”、名称的用户输入字段，然后坐标进入第三个表格单元格。但是，如果它是一个形状，那么第一个单元格包含“形状”，用于名称/描述的用户输入字段，第三个单元格包含每个点的坐标列表，这对于线是相同的。

我遇到的问题是我可以将它们全部写入一个表单字段，但是我如何允许用户输入标题，我需要为此使用表单字段？另一种选择是从表中取出每一行并将其输入到单个表单字段中，由管道或类似字段分隔，但我不确定我是否可以从其他表单字段中读取。

希望上面说的有点道理！！欢迎所有反馈！

我为此使用了mootools，但如果我能理解布局，那么这应该不是问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-05T16:31:15.697

我建议您在用户进行选择时使用一个对象来维护所有位置数据。当提交表单时，将该数据序列化为 JSON 对象的隐藏字段。

因此，当用户在地图窗口中单击时，除了表格之外，您还会在对象中记录信息。填充的对象如下所示：

```
var usersLocations = {"locations": [
        {"type": "point", "coords": [100,200]},
        {"type": "line", "coords": [[200,300],[400,500]]},
        {"type": "shape", "coords": [[200,300],[400,500],[1000,1500]]}
    ]
}; 
```

Mootools 可能有一些 JSON 方法，但如果没有，请查看[http://www.json.org/js.html](http://www.json.org/js.html)以获取工作代码。您可以使用 JSON.stringify() 将对象转换为适合保存在数据库中的纯字符串，当您取出该字符串时，您可以使用 JSON.parse() 再次将其转换为对象。

至于处理用户输入，您可以像现在一样将表格写入页面（或基于上述对象）。然后，当用户在其中一个字段中输入内容时，将该值复制到 usersLocations 对象中。所以在更新数据结构的输入字段上有一个 onBlur 事件处理程序（像这样）：

```
 usersLocations.locations[0]["type"] = "<what the user typed>"; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-05T00:25:14.450

你在找这样的东西吗？

```
usersLocations.locations[0]["name"] = document.getElementById("location0name").value; 
```

# asp.net - Datatable 的行计算函数

> ID：344171
> 
> 赞同：4
> 
> 时间：2008-12-05T15:29:03.043
> 
> 标签：asp.net, datatable

众所周知，通过数据表的计算功能，我们可以得到列的总和。但我想得到一行数据表的总和。我将用一个例子来解释：

我有一个如下图所示的数据表：使用计算功能，我们可以获得每列（产品）的总和。比如product1，2 + 12 + 50 + 13= 77。

我想得到 company1 的总和：2 + 6 + 4 + 3 + 5 = 20

[http://img123.imageshack.us/img123/1517/61519307xx5.jpg](http://img123.imageshack.us/img123/1517/61519307xx5.jpg)

我怎样才能用 asp.net 1.1 做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-05T15:40:16.797

来自[msdn](http://msdn.microsoft.com/en-us/library/system.data.datatable.compute.aspx)：

> 如果必须对两个或更多列执行操作，则应创建一个 DataColumn，将其 Expression 属性设置为适当的表达式，并在结果列上使用聚合表达式。在这种情况下，给定一个名为“total”的 DataColumn，并将 Expression 属性设置为：
> 
> `"Quantity * UnitPrice"`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-05T15:52:59.657

**LINQ 救援：**

```
DataTable dt = WhateverCreatesDataTable();
DataRow dr = dt.Rows[0];
int sum = dt.Columns.Cast<DataColumn>().Sum(dc=>(int)dr[dc]); 
```

对于那些仍然在石器时代（又名 pre-.Net 3.5 和 LINQ）的人：

```
DataTable dt = WhateverCreatesDataTable();
DataRow dr = dt.Rows[0];
int sum = 0;

foreach(DataColumn dc in dt.Columns)
  sum += (int)dr[dc]; 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-07T17:18:21.093

由于您想在 1.1 中解决此问题，因此您可以将其作为一个简单的解决方案

```
DataColumn totalColumn = new DataColumn();
totalColumn.DataType = System.Type.GetType("System.Int32");
totalColumn.ColumnName = "Total";
totalColumn.Expression = "Product1 + Product2 + Product3 + Product4 + Product5";

// Populate and get the DataTable dt then add this computed column to this table

dt.Columns.Add(totalColumn);
//Now if you access the column "Total" of the table you will get the desired result. 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-01-02T08:20:16.890

我们可以将 Datatable 的 Compute() 函数用于以下目的：

*   求和。
*   找到最大值。
*   找到最小值。
*   计算平均值。

以下链接详细解释了 Datatable 的 compute() 函数：

[http://codevariation.blogspot.com/2017/02/using-datatable-compute-function-in-cnet.html](http://codevariation.blogspot.com/2017/02/using-datatable-compute-function-in-cnet.html)

希望这会帮助你。

谢谢。

# dll - 在由多个类库组成的单个 dll 中获取嵌入式资源

> ID：344196
> 
> 赞同：1
> 
> 时间：2008-12-05T15:36:58.147
> 
> 标签：dll, embedded-resource

我的解决方案有多个项目，在其中一个项目中我有从另一个项目获取嵌入式资源（xml 文件）的代码。当所有项目都分开时，所有这些都可以正常工作。但是，当所有类库都嵌入到单个 dll 中时，获取资源文件的代码不起作用，即无法获取嵌入的资源。我想知道当它们在单个 dll 中组合在一起时，对嵌入式资源的引用是否会混淆？

我使用方法 Assembly.GetCallingAssembly().GetManifestResourceStream("namespace..filename");

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-05T15:41:47.667

我不会使用 Assembly.GetCallingAssembly()。我会使用 typeof(SomeClassNextToXmlFile).Assembly 如果您从 exe 文件调用带有嵌入式资源的 dll，它不会在 exe 中查找资源。此外，您可能想尝试使用[Reflector](http://www.red-gate.com/products/reflector/)并确保您正在寻找的资源在您认为的位置。

# php - PHP MySQL 搜索并按相关性排序

> ID：344199
> 
> 赞同：13
> 
> 时间：2008-12-05T15:37:08.363
> 
> 标签：php, mysql, search

我知道如何进行常规的 php mysql 搜索并显示结果。但是，由于我要完成的工作的性质，我需要能够按相关性进行排序。让我更好地解释一下：

普通查询“apple iphone applications”将使用 %apple iphone application% 搜索数据库，但如果没有记录以该确切顺序显示该短语，则搜索将不会产生任何结果。

我基本上需要做的是分别搜索'apple'，'iphone'和'applications'，然后将结果合并为一个，然后我需要通过在记录中找到多少个单词实例来对相关性进行评分. 例如，如果我做了我想做的事情并且它返回了以下内容：

```
Iphone Applications From Apple
Apple Make The Best Apple Iphone Applications
Iphone Applications 
```

他们的排名如下：

```
Apple Make The Best Apple Iphone Applications
Iphone Applications From Apple
Iphone Applications 
```

因为找到了多少个搜索词实例。请参阅突出显示：

```
[Apple] Make The Best [Apple] [Iphone] [Applications]
[Iphone] [Applications] From [Apple]
[Iphone] [Applications] 
```

我希望我已经解释得很好，如果有人能给我任何指示，我将不胜感激。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-12-05T15:41:32.270

看一下[MySQL FULLTEXT 搜索功能](http://dev.mysql.com/doc/refman/5.1/en/fulltext-search.html)，这些应该会自动按相关性返回结果，并让您更好地控制您的搜索

使用全文索引的唯一潜在问题是 InnoDB 表不支持它们。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2015-03-11T16:01:10.197

也许这可能会帮助某人（按相关性排序并保持字数）：

无全文：

```
SELECT *, ( (value_column LIKE '%rusten%') + (value_column LIKE '%dagen%') + (value_column LIKE '%bezoek%') + (value_column LIKE '%moeten%') ) as count_words
FROM data_table
WHERE (value_column LIKE '%dagen%' OR value_column LIKE '%rusten%' OR value_column LIKE '%bezoek%' OR value_column LIKE '%moeten%')
ORDER BY count_words DESC 
```

全文：

```
SELECT * FROM data_table
WHERE MATCH(value_column) AGAINST('+dagen +rusten +bezoek +moeten' IN BOOLEAN MODE)
ORDER BY MATCH(value_column) AGAINST('+dagen +rusten +bezoek +moeten' IN BOOLEAN MODE) DESC; 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-12-05T15:40:08.873

一个快速的谷歌给了我[这个链接](http://www.mysqlperformanceblog.com/?s=select%20match%20against%20as%20relevance)。

例子：

```
select title, match (title,content) against (”internet”) as score 
from cont 
where match (title,content) against (”internet”) limit 10; 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-05T15:55:05.160

```
SELECT field2, field3, ..., MATCH(field1, field2) AGAINST ("search string") AS relevance WHERE MATCH(field1, field2) AGAINST "search string" ORDER BY relevance DESC LIMIT 0,10 
```

在结果集中，会有一个字段“relevance”，这里用来对结果进行排序。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-04-08T03:47:03.570

我不是你想要的，但下面的代码绝对适合你。

```
SELECT ("some text here" or `column_name`) RLIKE "Apple|Iphone|Application" AS Result ORDER BY Result DESC; 
```

用 Bar(|) 分隔所有单词，但结果将分别为 1 或 0。如果您想获得有根据的行，请参见下文。

```
SELECT * FROM "table_name" WHERE `column_name` RLIKE "Apple|Iphone|Application"; 
```

# linux - Linux中每个进程的最大线程数？

> ID：344203
> 
> 赞同：273
> 
> 时间：2008-12-05T15:38:07.130
> 
> 标签：linux, multithreading

Linux下一个进程可以创建的最大线程数是多少？

如何（如果可能）修改这个值？

* * *

## 回答 #1

> 赞同：277
> 
> 时间：2008-12-05T15:56:54.377

Linux 没有每个进程单独的线程限制，只是对系统上进程总数的限制（线程本质上只是在 Linux 上具有共享地址空间的进程），您可以这样查看：

```
cat /proc/sys/kernel/threads-max 
```

默认为内存页数/4。您可以像这样增加：

```
echo 100000 > /proc/sys/kernel/threads-max 
```

单个用户可以创建的进程（以及线程）数量也有限制，请参阅`ulimit/getrlimit`有关这些限制的详细信息。

* * *

## 回答 #2

> 赞同：71
> 
> 时间：2012-02-09T13:39:32.593

说 LINUX 每个进程限制没有单独的线程是错误的。

> **Linux间接实现了每个进程的最大线程数！！**

```
number of threads = total virtual memory / (stack size*1024*1024) 
```

因此，可以通过增加总虚拟内存或减少堆栈大小来增加每个进程的线程数。但是，在最大虚拟内存等于交换内存时，过多减小堆栈大小会导致堆栈溢出导致代码失败。

**检查你的机器：**

总虚拟内存：（`ulimit -v`默认是无限的，因此您需要增加交换内存来增加它）

总堆栈大小：（`ulimit -s`默认为 8Mb）

**增加这些值的命令：**

```
ulimit -s newvalue

ulimit -v newvalue 
```

*将新值替换为您要设置为限制的值。

**参考：**

[http://dustycodes.wordpress.com/2012/02/09/increasing-number-of-threads-per-process/](http://dustycodes.wordpress.com/2012/02/09/increasing-number-of-threads-per-process/)

* * *

## 回答 #3

> 赞同：44
> 
> 时间：2008-12-05T16:03:16.470

实际上，限制通常由堆栈空间决定。如果每个线程都有一个 1MB 的堆栈（我不记得这是否是 Linux 上的默认值），那么您的 32 位系统将在 3000 个线程后耗尽地址空间（假设最后一个 gb 保留给内核） .

但是，如果您使用超过几十个线程，您很可能会遇到糟糕的性能。迟早，你会得到太多的上下文切换开销，太多的调度器开销，等等。（创建大量线程只不过是消耗大量内存而已。但是很多有实际*工作*要做的线程会减慢你的速度，因为它们正在争夺可用的 CPU 时间）

在这个限制甚至相关的情况下，你在做什么？

* * *

## 回答 #4

> 赞同：32
> 
> 时间：2014-10-04T07:50:02.297

linux上正确的100k线程：

```
ulimit -s  256
ulimit -i  120000
echo 120000 > /proc/sys/kernel/threads-max
echo 600000 > /proc/sys/vm/max_map_count
echo 200000 > /proc/sys/kernel/pid_max 

 ./100k-pthread-create-app 
```

@Thomas 在 systemd 系统上的 2018 年更新：

```
/etc/systemd/logind.conf: UserTasksMax=100000 
```

* * *

## 回答 #5

> 赞同：15
> 
> 时间：2013-11-11T19:16:59.737

@dragosrsupercool

Linux不使用虚拟内存来计算线程的最大值，而是系统上安装的物理内存

```
 max_threads = totalram_pages / (8 * 8192 / 4096); 
```

[http://kavassalis.com/2011/03/linux-and-the-maximum-number-of-processes-threads/](http://kavassalis.com/2011/03/linux-and-the-maximum-number-of-processes-threads/)

内核/fork.c

```
/* The default maximum number of threads is set to a safe
 * value: the thread structures can take up at most half
 * of memory.
 */
max_threads = mempages / (8 * THREAD_SIZE / PAGE_SIZE); 
```

所以线程最大值在每个系统之间是不同的，因为安装的内存可以来自不同的大小，我知道 Linux 不需要增加虚拟内存，因为在 32 位上我们有 3 GB 的用户空间和 1 GB 的内核，在 64 位上，我们有 128 TB 的虚拟内存，这发生在 Solaris 上，如果你想增加虚拟内存，你需要添加交换空间。

* * *

## 回答 #6

> 赞同：13
> 
> 时间：2008-12-05T15:50:00.803

要检索它：

```
cat /proc/sys/kernel/threads-max 
```

设置它：

```
echo 123456789 | sudo tee -a /proc/sys/kernel/threads-max 
```

123456789 = 线程数

* * *

## 回答 #7

> 赞同：10
> 
> 时间：2014-02-21T06:19:06.130

线程数限制：

```
$ cat /proc/sys/kernel/threads-max 
```

如何计算：

```
max_threads = mempages / (8 * THREAD_SIZE / PAGE_SIZE); 
```

并且：x86_64页面大小（PAGE_SIZE）为4K；与所有其他架构一样，x86_64 为每个活动线程都有一个内核堆栈。这些线程堆栈是 THREAD_SIZE (2*PAGE_SIZE) 大；

对于内存页：

```
cat /proc/zoneinfo | grep spanned | awk '{totalpages=totalpages+$2} END {print totalpages}'; 
```

所以实际上这个数字与线程内存堆栈大小的限制无关（`ulimit -s`）。

PS：我的rhel VM的线程内存栈限制是10M，而对于1.5G内存，这个VM只能承受150个线程？

* * *

## 回答 #8

> 赞同：6
> 
> 时间：2017-04-01T13:11:10.947

对于现在正在查看此内容的任何人，在 systemd 系统（在我的情况下，特别是 Ubuntu 16.04）上，cgroup pids.max 参数还有另一个限制。

默认设置为 12,288，可以在 /etc/systemd/logind.conf 中覆盖

其他建议仍然适用，包括 pids_max、threads-max、max_maps_count、ulimits 等。

* * *

## 回答 #9

> 赞同：5
> 
> 时间：2017-05-24T11:05:12.080

使用 ulimit 检查每个线程的堆栈大小，在我的例子中是 Redhat Linux 2.6：

```
 ulimit -a
...
    stack size              (kbytes, -s) 10240 
```

您的每个线程都将获得为其堆栈分配的内存量（10MB）。32位程序，最大地址空间4GB，也就是最多只有4096MB / 10MB = 409个线程！！！减去程序代码，减去堆空间可能会导致观察到的最大值。300 个线程。

您应该能够通过在 64 位上编译和运行或设置 ulimit -s 8192 甚至 ulimit -s 4096 来提高这一点。但如果这是可取的，则另作讨论......

* * *

## 回答 #10

> 赞同：4
> 
> 时间：2008-12-05T16:18:55.190

应该没关系吧。将算法设计为使用固定数量的线程（例如，如果您有 4 或 8 个处理器，则为 4 或 8 个），您将获得更好的性能。您可以使用工作队列、异步 IO 或类似 libevent 的东西来做到这一点。

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2009-11-16T18:27:06.807

如果您需要更多线程来执行阻塞的 I/O 调用，请使用`nbio` 非阻塞 i/o 库或其他库

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2013-06-21T18:17:07.770

取决于您的系统，只需编写一个示例程序 [通过在循环中创建进程] 并使用 ps axo pid,ppid,rss,vsz,nlwp,cmd 检查。当它无法再创建线程时，请检查 nlwp 计数 [nlwp 是线程数] 瞧，您得到了万无一失的答案，而不是翻阅书籍

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2016-10-17T15:07:23.673

要永久设置，

```
vim /etc/sysctl.conf 
```

**并添加**

```
kernel.threads-max = "value" 
```

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2021-02-16T03:27:13.753

我认为我们错过了另一个也会阻止新线程创建的限制，这是**kernel.pid_max**限制。

```
root@myhost:~# lsb_release -a
No LSB modules are available.
Distributor ID: Ubuntu
Description:    Ubuntu 16.04.7 LTS
Release:    16.04
Codename:   xenial
root@myhost:~# uname -a
Linux myhost 4.4.0-190-generic #220-Ubuntu SMP Fri Aug 28 23:02:15 UTC 2020 x86_64 x86_64 x86_64 GNU/Linux 
```

我发现至少在我的系统中，这个阈值 kernel.pid_max 是 32768。当我启动任何简单的 JVM 进程时，它会报告如下错误：

```
java/jstack/jstat ...
#
# There is insufficient memory for the Java Runtime Environment to continue.
# Cannot create GC thread. Out of system resources.
# An error report file with more information is saved as:
# /root/hs_err_pid1390.log 
```

检查内存，够用。

```
root@lascorehadoop-15a32:~# free -mh
              total        used        free      shared  buff/cache   available
Mem:           125G         11G         41G        1.2G         72G        111G
Swap:            0B          0B          0B 
```

检查系统线程：

```
~# ps -eLf|wc -l
31506 
```

但我通过 ulimit 检查系统限制：

```
root@myhost:~# ulimit -a
core file size          (blocks, -c) 0
data seg size           (kbytes, -d) unlimited
scheduling priority             (-e) 0
file size               (blocks, -f) unlimited
pending signals                 (-i) 515471
max locked memory       (kbytes, -l) 64
max memory size         (kbytes, -m) unlimited
open files                      (-n) 98000
pipe size            (512 bytes, -p) 8
POSIX message queues     (bytes, -q) 819200
real-time priority              (-r) 0
stack size              (kbytes, -s) 8192
cpu time               (seconds, -t) unlimited
max user processes              (-u) 515471
virtual memory          (kbytes, -v) unlimited
file locks                      (-x) unlimited 
```

从 ulimit 输出中，我们可以看到当前线程数远小于最大用户进程限制。

实际上，达到的极限是`kernel.pid_max`

很容易检查和调整它： [https ://www.cyberciti.biz/tips/howto-linux-increase-pid-limits.html](https://www.cyberciti.biz/tips/howto-linux-increase-pid-limits.html)

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2016-07-25T07:40:54.673

我们可以看到linux下面文件中定义的最大线程数

cat /proc/sys/kernel/threads-max

（或者）

sysctl -a | grep 线程-max

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2018-05-11T10:02:24.507

您可以通过以下命令查看当前值 - cat /proc/sys/kernel/threads-max

您还可以设置值，如

回声 100500 > /proc/sys/kernel/threads-max

您设置的值将根据可用的 RAM 页面进行检查。如果线程结构占用可用 RAM 页的 1/8 以上），则 thread-max 将相应减少。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2018-08-02T22:51:07.017

是的，要增加线程数，您需要增加虚拟内存或减小堆栈大小。在 Raspberry Pi 中，我没有找到增加虚拟内存的方法，如果将堆栈大小从默认的 8MB 减小到 1MB，每个进程可能会获得超过 1000 个线程，但使用“ulimit -s”命令减小堆栈大小为所有线程做这个。因此，我的解决方案是使用“pthread_t”实例“线程类”，因为 pthread_t 让我可以设置每个线程的堆栈大小。最后，我可以在 Raspberry Pi 中为每个进程归档 1000 多个线程，每个线程都有 1MB 的堆栈。

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2021-09-21T06:15:34.120

如果您使用 Suse，则需要使用以下方法之一

[https://www.suse.com/support/kb/doc/?id=000015901](https://www.suse.com/support/kb/doc/?id=000015901)

全球的，

```
/etc/systemd/system.conf
    DefaultTasksMax=Value 
```

对于特定的 ssh 服务

```
/etc/systemd/system/sshd.service.d/override.conf
    TasksMax=Value 
```

# wpf - 关于 WPF 停靠库的建议

> ID：344205
> 
> 赞同：36
> 
> 时间：2008-12-05T15:38:36.443
> 
> 标签：wpf, dockable

我们正在实现一个需要可停靠窗口的应用程序，类似于 Visual Studio 2005/2008，但与 VS 的单一站点不同，它具有多个“停靠站点”。有没有人为此推荐一个好的图书馆 - OSS或商业？我知道 Infragistics 有一个，还有来自 DevComponents 的 Divelement 的 SandDock 和 WPF-Dock，以及 ActiPro 的 Docking & MDI 产品。[CodeProject](http://www.codeproject.com/KB/WPF/WPFdockinglib.aspx)上也有一个。有人用过这些库吗？体验是好是坏？如果您有使用其中之一的经验，它是否支持多个“对接站点”？

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2009-01-07T12:12:59.413

Codeproject 中的一个是[AvalonDock——](https://github.com/xceedsoftware/wpftoolkit/wiki/AvalonDock)我们已经使用了半年多，但我们离发布还很远，所以我们有灵活性。在使用 AvalonDock 之前，我们尝试了 Infragistix、ActiPro、SandDock 以及其他一些。尽管 AvalonDock 不是 100% 没有错误的（那是什么？）没有主要错误，但它非常稳定、快速并且具有所有功能。它确实支持多个对接站点。

它是一个开源项目，正在积极开发中，因此正在发现并修复错误。到目前为止的良好体验。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2008-12-05T17:26:10.640

我已经使用 ActiPro 库几个月了，效果很好。它确实支持多个对接站点。支持非常出色，您可以获得 WPF 中缺少的一些其他控件（日期选择器等）。对我来说，150 美元的钱花得很值。它开箱即用，没有大惊小怪。

我们曾经使用 Divements 来实现 WinForm 控件，但我们认为 Actipro 有更好的支持，所以我们切换到 WPF。

只是我的两分钱。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2008-12-05T17:19:16.973

不要忘记GitHub 上的[AvalonDock](https://stackoverflow.com/questions/344205/recommendations-on-a-wpf-docking-library)（WPF 工具包的一部分）。我在其他地方看到过。

最初我打算使用 ActiPro 库（主要是因为我已经在使用他们的功能区），但我可能会给 AvalonDock 一个机会，因为它是开源的。

有人对 AvalonDock 有任何反馈/意见吗？

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-12-05T18:56:57.680

我使用 DotNetBar，因为它有功能区/底座和更多控件，而且价格便宜。这很棒。

[http://www.devcomponents.com/dotnetbar-wpf/](http://www.devcomponents.com/dotnetbar-wpf/)

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2008-12-05T19:09:56.267

SandDock 没问题。我们将它用于项目的 POC 阶段。我在他们的布局保存机制中发现了一些非常糟糕的错误。它生成了 XML，但随后无法加载该 XML；它抛出了一个异常！实际上，我通读了所有生成的 XML，并且在每次生成 XML 之后都必须编写代码来稍微修改它。这似乎不是一个经过深思熟虑的设计。我希望有常见的 WPF 基本类型，例如

Infragistics 稍微好一点，但有问题。事实上，如果您尝试在只有 .Net 3.0 而没有 .Net 3.5 的机器上运行它，它就无法正常工作。Infragistics 有一个突出的开发问题，我不知道他们在解决这个问题上是否取得了任何进展。在浮动窗口并拖动它时，我也有几次崩溃（怀疑这与上面的 .Net 3.0/3.5 问题有关）。我发现这个控件的样式非常不直观。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2010-03-24T22:59:20.613

我尝试了这里列出的所有库，它们在某种程度上都有问题。虽然它们很贵，但我会推荐 Telerik 和 Infragistics。Nevron 值得一提，因为他们的库是我见过的最好的库，但它是针对 WinForms 的。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2010-11-29T10:21:19.253

1 年后... AvalonDock 现在稳定而强大。还有一个“AvalonDock 包装器”可以简化使用它而不减少它的可能性。请参阅[http://sofawpf.codeplex.com/](http://sofawpf.codeplex.com/)

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2013-06-06T01:15:07.887

这是另一个：

[http://www.essentialobjects.com/Products/EOWpf/DockView.aspx](http://www.essentialobjects.com/Products/EOWpf/DockView.aspx)

这个有许多可以动态切换的内置皮肤。它还有许多可以独立使用的单独控件（例如“Splitter”控件）。

# c# - 如何确定 ASP.Net 缓存的总大小？

> ID：344210
> 
> 赞同：15
> 
> 时间：2008-12-05T15:39:13.493
> 
> 标签：c#, asp.net, caching, performancecounter

我在一个 Web 项目中使用 ASP.net 缓存，我正在为它编写一个“状态”页面，它显示缓存中的项目，以及我能找到的关于缓存的尽可能多的统计信息。有什么方法可以获得缓存数据的总大小（以字节为单位）？每个项目的大小会更好。我想在网页上显示它，所以我认为我不能使用性能计数器。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2008-12-05T16:05:54.123

我正在查看我的性能监视器，在**ASP.NET Apps v2.0.50727**类别下，我有以下与缓存相关的计数器：

**使用的缓存 % 机器内存限制**

**使用的缓存 % 进程内存限制**

此类别下还有许多其他与缓存相关的指标。

这些应该能够为您提供百分比，然后如果您可以通过`Cache.EffectivePrivateBytesLimit`其他电话或其他电话获得允许的总数，您应该能够弄清楚。我没有使用这些计数器的个人经验，因此您必须进行一些研究和测试才能验证。

这是一篇关于从性能计数器读取的快速入门文章：http: [//quickstart.developerfusion.co.uk/quickstart/howto/doc/PCRead.aspx](http://quickstart.developerfusion.co.uk/quickstart/howto/doc/PCRead.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-05T15:59:15.667

没试过。但也许您可以使用[ASP.NET 的缓存管理器插件](http://www.aspalliance.com/CacheManager/Default.aspx)。或者以它为例。

# c# - 如何使用 Javascript 更改 Gridview 中隐藏字段的值？

> ID：344212
> 
> 赞同：1
> 
> 时间：2008-12-05T15:39:58.840
> 
> 标签：c#, javascript, gridview, hidden-field

好的，我需要更改网格视图中隐藏字段的值，这是我目前所拥有的：

```
for(var i = 0; i < gv_Proofs.rows.length; i++)
{
    var tbl_Cell = gv_Proofs.rows[i].cells[0];
    var sdiFound = false;

    for(var x = 0; x < tbl_Cell.childNodes.length; x++)
    {
        if(tbl_Cell.childNodes[x].id == "_ctl0_MasterContentPlaceHolder_gv_Proofs__ctl2_lbl_SDI")
        {
            if(tbl_Cell.childNodes[x].innerHTML == sdi)
                sdiFound = true;
        }
        if(tbl_Cell.childNodes[x].id == "_ctl0_MasterContentPlaceHolder_gv_Proofs__ctl2_lbl_Updated" && sdiFound)
            tbl_Cell.childNodes[x].value = "true";
    }
} 
```

谁能告诉我我做错了什么？谢谢你！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-05T20:17:12.370

我让它工作了。上面的循环工作正常，但显然我的 sdi 值并不总是正确设置，因此我检查的值总是设置为 false。因此，如果有人再次遇到此问题，上述方法在我的情况下非常有效。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-05T15:49:10.553

**编辑：发布前检查的经典案例。[显然](http://www.beansoftware.com/ASP.NET-Tutorials/GridView-Hidden-Column.aspx)设置 hidden=true 实际上可以防止数据绑定，这就是 JS 出现问题的原因。*我*会说这是 ASP.NET 的典型问题之一，这让我诅咒它的名字，但*您*可能只是选择使用许多 googleable 解决方案之一来调整控件。**

*关于在 ASP.NET 中使用元素 ID 的评论保持不变，因为它是邪恶的。*

* * *

没有更多代码很难知道（什么时候准确执行？是否有其他东西覆盖它？标记是什么样的？）但我现在可以说通过它的 ASP.NET 变形 ID 引用一个元素是一个坏主意（TM ）。

如果可以的话，我建议您尝试在为您处理引用的代码隐藏中修改它，或者至少在其中写出可以使用 clientID 的 JS。如果失败了，我会尝试通过扩展的元素搜索器找到元素——你自己的或库工具，如 jquery 等人的“$”函数——这将允许你使用健壮的 CSS 或 Xpath 参数。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-05T15:50:46.870

只有当 childNode id 是（截断的）lbl_SDI 时，您的第一条语句才成立。仅当第一个语句为真（通过 sdiFound）并且 ID 为（截断）lbl_Updated 时，您的第二个语句才为真。

所以第二个陈述永远不可能是真的。*只有当节点 ID不是*lbl_Updated时，变量 sdiFound 才会为真。

我认为很多人可能不同意您也专门引用 .NET ID。您是否考虑过使用：

```
<%= lbl_SDI.ClientID %> 
```

在你的 JavaScript 中？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-05T15:52:25.820

好吧，你能告诉我发生了什么吗？似乎您忘记将 sdiFound 变量重置为 false，或者在找到它时中断循环。

至于你的问题：

如果您将隐藏的 html 输入作为服务器控件运行，那么它将由 GridView 显示，并且它将具有唯一的 ID。然后您可以使用 getElementById 找到它。您可以将其放入为您构建正确 id 的循环中，您应该能够找到您的控件。

# user-interface - Flash人气会变成AIR人气吗？

> ID：344216
> 
> 赞同：1
> 
> 时间：2008-12-05T15:40:33.363
> 
> 标签：user-interface, cross-platform, air, desktop

[这是一个社区 Wiki，所以如果它看起来像是一个投票问题，请**不要**费心投票否决它。这是。]

Adobe 能否将其在 Flash 渗透方面的成功（尽管也值得怀疑，请参阅我的帖子[）](http://compileyouidontevenknowyou.blogspot.com/2008/01/flash-penetration-and-bullshit.html)转化为 Adob​​e AIR？Adobe AIR 是桌面平台中的“下一件大事”，只是另一个播放器（以及其他什么？），还是会无声无息地死去？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-05T16:53:30.487

不幸的是，没有，直到他们至少解决了以下问题：

当您访问需要 Flash 的站点并且您没有安装 Flash 时，您会看到一个非常标准的弹出窗口，询问您是否安装它，并在注释中提到安装不受信任的插件可能不安全。

当您访问一个可让您下载 AIR 应用程序的网站时，它会弹出大红色的尖叫警告，警告您的计算机即将遭到破坏、您的身份被盗以及生活将遭受折磨[1]。当然，除非所有卧室程序员都决定支付*持续*的认证成本。

用户鼓励失败。爱好开发者鼓励失败。技术恐惧症避免失败。

我喜欢 AIR，但我不知道他们对安装程序的想法。Laywers 的办公室离总部的开发商更近还是什么的？

[1]实际信息可能有所不同。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-05T15:45:46.397

简单回答**NO**

将 Flash 的网络成功与桌面或明显原因进行比较是不公平的。

Flash 开发人员已经在使用 Flash 开发桌面应用程序，现在他们有了更好的框架。它会被很多人使用，但我永远不会那么受欢迎。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-05T15:47:31.900

我认为 AIR 将会存在很长时间，它非常适合想要桌面版 Web 应用程序的 Web 极客。

我怀疑它是否会达到主流吸引力，大众需要 Flash 来观看他们有趣的 YouTube 视频，但他们永远不会考虑获得 AIR 来使用 TweetDeck。他们使用的桌面应用程序是已经安装在他们机器上的应用程序。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-05T15:49:41.613

如果 AIR 改进了 HTML 内容的合并，它将非常成功。如果渲染 HTML 内容的能力没有得到提升，那我的拙见是会喜忧参半。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-05T15:58:23.140

不
。桌面应用程序市场的竞争要大得多，用户期望桌面应用程序提供比 Web 应用程序更多的功能和性能，而 AIR 还没有提供性能和桌面功能。

# vb.net - ASP.NET 中的多重答案矩阵

> ID：344225
> 
> 赞同：1
> 
> 时间：2008-12-05T15:42:01.880
> 
> 标签：vb.net, oracle, database-design, asp.net-2.0

我参与了一个制作调查系统的项目。我们一直在敲定一些问题类型的逻辑，我可以就什么是最好的方法提出第二种意见。我们使用带有 Oracle 数据库的 VB(VS2005) 在 ASP.NET 2.0 网站上工作。

在我们的 oracle 服务器中，我们计划一些表来组织我们的数据。我们的调查有一个表格，一个用于问题（键确定它继续进行哪个调查），一个用于答案（同样，键确定它属于哪个问题），还有一个用于收集答案。大多数问题只返回一个响应，这很容易弄清楚。然而，当我们开始考虑返回多个答案的项目时，它开始变得棘手。

例如，如果我们有一个简单的 3x3 矩阵，其中填充了复选框。行是天'星期一'，'星期三'，'星期五'。这些列是“骑自行车”、“跑步”、“驾驶”等活动。用户检查他们在某一天所做的每一项，因此每一行可以有多个响应。我们要考虑的另一个问题是，如果我们有文本框而不是复选框，用户会在其中写入他们在活动上花费了多少分钟的值。

到目前为止，对于收集响应，我喜欢[遍历表单中的控件列表](http://aspnet.4guysfromrolla.com/articles/081402-1.2.aspx)并密切关注收集数据的控件类型的想法。由于控件是在代码中创建的，因此通常会为它们提供一个字符串的 ID，该字符串的末尾附有一个数字，以跟踪它是什么问题类型以及它是什么数字。

问题 #1：从用户返回的数据应该在单个数据库条目中，并用分隔符分隔每个答案，还是每个答案都有自己的条目？

问题 2：确定什么响应与什么答案相匹配的最佳方法是什么（在调查中）？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-12-05T15:59:32.860

问题 #1：从用户返回的数据应该在单个数据库条目中，并用分隔符分隔每个答案，还是每个答案都有自己的条目？

我不这么认为，我认为您需要维护一个简单的交叉引用表，其中包含问题 ID 和答案（如果是多项选择，则为键，如果允许，则为文本）。如果您正在谈论答案网格，那么您的交叉引用表可能还有一列，其 id 为“类别”。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-05T16:01:34.103

假设空间和速度不太可能是该系统中的严重限制问题，我建议您*保持数据标准化*

所以问题 1 的答案是：每个答案都有自己的条目；如有必要，带有序列号

问题2的答案是：通过外键

# .net - 在托管 C++ 中创建 KeyValuePair

> ID：344236
> 
> 赞同：4
> 
> 时间：2008-12-05T15:44:47.333
> 
> 标签：.net, generics, visual-c++, .net-2.0, managed-c++

我还有另一个托管 C++ KeyValuePair 问题，我知道在 C# 中做什么，但是很难转换为托管 C++。这是我想在 C# 中执行的代码：

```
KeyValuePair<String, String> KVP = new KeyValuePair<string, string>("this", "that"); 
```

我已经将它反映到 MC++ 中并得到了这个：

```
KeyValuePair<String __gc*, String __gc*> __gc* KVP = (S"this", S"that"); 
```

我要翻译成：

```
KeyValuePair<String ^, String ^> KVP = (gcnew String("this"), gcnew String("that")); 
```

我从[上一个问题](https://stackoverflow.com/questions/341477/generic-generics-in-managed-c)中知道 KeyValuePair 是一种值类型；问题是它是 C++ 中的值类型和 C# 中的引用类型吗？谁能告诉我如何从 C++ 设置 KeyValuePair 的键和值？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-05T16:07:20.237

这应该这样做：

`KeyValuePair< String ^, String ^> k(gcnew String("Foo"), gcnew String("Bar"));`

KeyValuePair 是一个不可变类型，因此您必须将所有内容传递给构造函数，这看起来与 C# 中的相同，除了如果对象在堆栈上，您可以这样写。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-05T16:19:21.413

尝试

```
System::Collections::Generic::KeyValuePair< System::String^, System::String^>^ k = gcnew System::Collections::Generic::KeyValuePair< System::String^, System::String^>(gcnew System::String("foo") ,gcnew System::String("bar"))   ; 
```

# mysql - Rails 交易

> ID：344247
> 
> 赞同：1
> 
> 时间：2008-12-05T15:46:24.163
> 
> 标签：mysql, ruby-on-rails, activerecord, transactions

我正在尝试使用`ActiveRecord::Base.transaction`. 我认为使用 Rails 1.2.6 和 mysql 5.0 默认情况下回滚不起作用。多玩一点，我发现`autocommit`在 mysql 连接中没有设置为 0。

**问题：**

1）如何禁用所有连接的rails中的自动提交？

2）它会对其他不必是事务性的代码产生一些负面影响吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-05T18:53:53.287

如果您有需要显式事务的代码和可以依赖自动提交的代码的混合，也许您不应该为所有连接禁用自动提交。您走在正确的轨道上，想知道这是否会影响其他代码。如果您禁用自动提交，但其他代码不知道它必须提交才能提交其工作，那么这将是一个问题。当连接关闭时，未提交的工作将回滚。

您应该知道 MySQL 的默认存储引擎是[MyISAM](http://dev.mysql.com/doc/refman/5.0/en/myisam-storage-engine.html)，它根本不支持事务。当您对使用 MyISAM 的表进行更改时，无论您对开始和完成事务的显式请求如何，也无论自动提交的状态如何，更改都会立即有效地提交。因此，无论如何您都无法回滚，除非您使用[InnoDB](http://dev.mysql.com/doc/refman/5.0/en/innodb.html)存储引擎（或其他事务安全存储引擎，例如[BDB](http://dev.mysql.com/doc/refman/5.0/en/bdb-storage-engine.html)）创建表。

在 MySQL 中使用事务不需要禁用自动提交模式[。](http://dev.rubyonrails.org/ticket/4)只需明确地开始交易。在您提交或回滚该事务之前，以下 SQL 语句将成为事务的一部分，无论您当前连接上的 autocommit 值如何。

[http://dev.mysql.com/doc/refman/5.0/en/commit.html](http://dev.mysql.com/doc/refman/5.0/en/commit.html)说：

> 使用 START TRANSACTION，自动提交保持禁用状态，直到您使用 COMMIT 或 ROLLBACK 结束事务。然后自动提交模式恢复到之前的状态。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-05T19:21:32.967

您不必禁用自动提交即可使用事务。当您启动事务自动提交设置没有任何区别时，您必须明确地 COMMIT 或 ROLLBACK。此外，禁用自动提交会影响您的非事务性代码。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-07T06:19:54.523

正确答案。我在交易开始时在我的代码中执行 DROP TABLE IF EXISTS。MySQL 似乎对事务中的 DROP 语句有问题：

[http://bugs.mysql.com/bug.php?id=989](http://bugs.mysql.com/bug.php?id=989)

有趣的是，我猜到了在 DROP 语句之前发送“SET aucotommit = 0”的问题的正确解决方法。

谢谢您的帮助

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-05T21:33:47.660

并不是说我有任何特别不是事务性的代码 - 它主要是所有 ActiveRecord 对象，如果我的方法之一失败，我只想有回滚行为。

我会探索更多，你似乎是对的 - 我可以在 mysql 控制台中确认你的答案。但是，在我的 Rails 应用程序中，我必须执行 connection.execute("set autocommit = 0") 才能使回滚工作。

# php - 在不使用 php api 的情况下在 php cgi 环境中设置 cookie

> ID：344249
> 
> 赞同：-1
> 
> 时间：2008-12-05T15:46:39.967
> 
> 标签：php, cgi, cookies

如何在不使用 PHP 的任何 api 函数的情况下在 php CGI 环境中使用 cookie？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-12-05T15:55:38.390

好的，您想在 CGI 环境中使用 php 设置 cookie？

复制代码并将其命名为whatever.cgi并使其可执行

```
#!/usr/bin/php
function set_cookie($cookiename,$cookievalue,$cookietime){
   echo 'set-cookie: '.$cookiename.'="'.$cookievalue.'"; max-age="'.$cookietime.'";'."\n";  
} 
```

行尾的 \n 是必须的。否则你会遇到麻烦 :) 现在让我们设置一个 cookie：

```
set_cookie("foo","bar",60) 
```

将名称为 foo 的 Cookie 设置为值栏。60 秒后过期。

现在您可以从 HTML Header 开始。

```
echo "Content-Type: text/html\n\n";
echo "<html>\n";
echo "<head>\n";
echo "<title>whatever</title>\n";
echo "</head>\n";
echo "<body>\n"; 
```

如果要删除 cookie，请将 max-age 设置为零

```
function set_cookie($cookiename){
   echo 'set-cookie: '.$cookiename.'="0"; max-age="0";'."\n";  
} 
```

# svn - svn: Path does not exist in revision

> ID：344257
> 
> 赞同：3
> 
> 时间：2008-12-05T15:48:06.390
> 
> 标签：svn, msbuild, copy

I want to create tag in subversion. On the command line I have tried the following:

**svn copy [http://myserver.mycompany.com:8080/svn/SVN_Main/trunk](http://myserver.mycompany.com:8080/svn/SVN_Main/trunk) [http://myserver.mycompany.com:8080/svn/SVN_Main/tag/Build-5.4.3.2](http://myserver.mycompany.com:8080/svn/SVN_Main/tag/Build-5.4.3.2) -m "Build 5.4.3.2 tag"**

I get this error:

**svn: Path '[http://myserver.mycompany.com:8080/svn/SVN_Main/trunk](http://myserver.mycompany.com:8080/svn/SVN_Main/trunk)' does not exist for revision 1234**

The path [http://myserver.mycompany.com:8080/svn/SVN_Main/trunk](http://myserver.mycompany.com:8080/svn/SVN_Main/trunk) is exact same path that I have when I use the repro-browser on that folder. Any ideas on what may be causing this problem? I have also tried it w/wo username/password.

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-05T16:00:30.470

What happens if you just do the copy from within the repository browser (right click on the folder, then copy)

Could it also be a case-sensitivity issue? We run our svn server under Apache on Windows and find that reads are general case-insensitive, but write operations are case sensitive.

This is a real pain if a developer checks out /trunk/somefolder when the name is really /trunk/SomeFolder. They will get an error only when trying to commit.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-05T16:06:40.707

Either that isn't the right path, or you've put a `-r` option in there that you didn't show. Try a `svn ls` on that path to confirm it is correct. If you passed `-r`, make sure you've used the right revision.

# ruby-on-rails - 将参数集合从控制器传递到模型是否会破坏 MVC？

> ID：344263
> 
> 赞同：3
> 
> 时间：2008-12-05T15:49:44.097
> 
> 标签：ruby-on-rails, model-view-controller

我想将参数集合从控制器传递给模型以解析过滤和排序条件。模型中是否有一个从控制器获取参数的方法会破坏 MVC？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-05T16:53:36.587

这取决于。您正在将数据散列传递给模型并说“理解这一点”。

```
class Model < ActiveRecord::Base
  def update_from_params(params)
    ....
  end
end

class ModelsController < ActionController::Base
  def update
    ...
    @model.update_from_params(params)
  end
end 
```

还行吧。但是您可能会发现自己想要通过许多不同的操作来做到这一点。您不太可能在每种情况下都使参数完全相同，因此您需要在模型上使用多种方法，每个操作一个：

```
class Model < ActiveRecord::Base
  def update_from_update_params(params)
    # do stuff
  end

  def update_from_settings_params(params)
    # do different stuff
  end

end

class ModelsController < ActionController::Base
  def update
    ...
    @model.update_from_update_params(params)
  end

  def change_settings
    ...
    @model.update_from_settings_params(params)
  end
end 
```

这是不行的，你正在让模型做控制器工作。一个合理的折衷方案是在您的模型上创建一个接受规范数据散列的方法，然后在控制器中的参数和规范散列之间进行转换：

```
class Model < ActiveRecord::Base
  def update_from_data(hash)
    validate_data!(hash)
    # do stuff
  end
end

class ModelsController < ActionController::Base
  def update
    ...
    @model.update_from_data(translate_update_params)
  end

  def change_settings
    ...
    @model.update_from_data(translate_change_settings_params)
  end
end 
```

尽管您应该确保仔细记录模型接受的数据哈希的格式。实际上，我们甚至使用 YAML 验证库 ( [Rx](http://rjbs.manxome.org/rx/) ) 来确保模型只接受有效数据。

很抱歉，答案很长，但我没有时间写一个较短的答案；）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-27T08:40:22.170

我建议传递一个参数子集，这样你只传递模型需要的东西。

在控制器中：

```
# in controller
def search
  Model.search(params[:search][:options])
end 
```

只需确保您的输入是“命名空间”，以便获得嵌套哈希：

```
<!-- in view -->
<input type='text' name='search[options][keywords]' />
<input type='text' name='search[options][conditions]' />
<input type='text' name='search[options][sort]' /> 
```

然后在你的模型中：

```
def self.do_search(criteria)

        Rental.search(criteria[:keywords], 
                      :per_page => self.per_page,
                      :page => page,
                      :conditions => criteria[:conditions],
                      :order => criteria[:sort])

end 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-05T16:48:53.600

我会说它肯定会。

params 散列有很多你的模型不需要的东西。基本上你忽略了 MVC 的 C 部分。你想做的事情会起作用（又名它会执行）但我认为你应该将参数作为单独的实体传递。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-05T16:33:08.080

我不相信它确实如此，但无论如何我也不是铁路老手。通常，在控制器中使用参数哈希，并且该操作可能会或可能不会读取和写入模型信息，所以我猜如果参数要通过属于模型的方法，那将是同一件事。

无论哪种方式，我认为您仍然需要通过控制器发送参数，那么为什么不在那里进行处理，然后通过模型的方法将处理后的数据发送到模型呢？

# reporting-services - 如何抑制 SQL 报告中的空白页？

> ID：344273
> 
> 赞同：10
> 
> 时间：2008-12-05T15:51:07.743
> 
> 标签：reporting-services, report

我有一个 SQL 报表，它坚持在最后打印一个额外的空白页，即使所有报表项都应该放在一页上。我尝试缩短溢出页面上的元素，但无论我将它们压缩多少，或者第一页上留下多少空白空间，SRS 仍然认为它还需要占用另一页。这很烦人，因为这是一个很常见的问题——只需要一个错误就可以让报告溢出。所以我不是问如何在这份报告中解决这个问题，而是如何在这份报告和未来报告中解决这个问题：是否有一个标志或设置我可以设置来告诉 SRS “无论如何，永远不要打印超过 1 个页”？还是“禁止空白页=真”？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2008-12-05T16:56:06.240

尝试从身体中移除任何“空白空间”。将编辑表面缩小到足以容纳所有 ReportItems，包括高度和宽度。ReportingServices 认为您身体中的空间是有意的，因此它被保留了下来。

如果这没有帮助，并且您在 2005 年注意到此问题，请尝试2 [​​008 版本。](http://www.microsoft.com/downloads/details.aspx?FamilyID=b5d1b8c3-fda5-4508-b0d0-1311d670e336&DisplayLang=en)有一个新属性 ConsumeContainerWhitespace 有助于减少空白页。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2008-12-05T19:19:44.653

在我的经验中，我在报告页面上的数据总是比页边距更宽，所以它认为它需要制作一个新页面......检查页面的边距以及数据的距离在其上延伸。它在报表设计器中可能看起来并不遥远，但我敢打赌这就是答案。我们在这里谈论 PIXELS，所以检查一下，看看它是否有帮助！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-02-18T12:35:28.690

默认情况下`ConsumeContainerWhitespace`在`TRUE`报告属性中使用`FALSE`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-02-19T18:12:03.300

另外，查看页眉和页脚。我专注于报告的中心部分，使所有列都变小了，但它是导致问题的页脚。

# security - 禁用 Windows Mobile 安全功能

> ID：344280
> 
> 赞同：0
> 
> 时间：2008-12-05T15:53:24.900
> 
> 标签：security, windows-mobile

我目前正在为 Windows Mobile 5.0 应用程序编写一个应用程序，它似乎具有一些防火墙类功能，我需要允许运行任何已部署的可执行文件。是否有某种注册表项可用于在开发过程中将其关闭，因为不得不照看设备令人沮丧。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-05T15:55:29.450

你见过[设备安全 Powertoy](http://www.microsoft.com/downloads/details.aspx?FamilyID=7e92628c-d587-47e0-908b-09fee6ea517a&displaylang=en)吗？

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-09T17:03:15.240

在 Windows Mobile SDK 中，提供了一个配置 CPF 文件（类似于 CAB 文件，但仅用于配置）来禁用您正在开发的设备上的安全设置。将 C:\Program Files\Windows Mobile 6 SDK\Tools\Smartphone\SecurityConfiguration\SecurityOff.cpf 复制到您的设备并运行它。然后，您应该不再看到提示。

顺便说一句：听起来您在谈论“未签名提示策略”安全策略。以下是安全策略列表：http: [//msdn.microsoft.com/en-us/library/aa455966.aspx](http://msdn.microsoft.com/en-us/library/aa455966.aspx)

# windows - 谁能为开发人员推荐一个好的备份“系统”？

> ID：344281
> 
> 赞同：3
> 
> 时间：2008-12-05T15:54:13.633
> 
> 标签：windows, version-control, backup

我在办公室里被称为“替补人”。作为一名开发人员，我经常在项目之间来回切换，因此当我返回它们时，我并不总是准确地记得每个项目中存在哪些变化。我通常必须将我的本地更改与我们的源代码控制系统中的更改进行比较，然后我最终会记住这一切。问题是，我并不总是有这样的奢侈。有时我必须快速为客户构建一些东西，所以我备份了工作目录，这样我就可以从源代码管理中获取最新的文件，并快速构建 DLL - 同时知道另一个（in-进展）变化是安全的。

问题是我现在在每个项目目录中都积累了一堆备份文件夹，这使得找到我正在寻找的特定更改变得更加困难。虽然我的实践已经发展到我总是花时间给每个备份文件夹一个信息丰富的名称，但我开始认为我最好还是编写自己的工具。

例如：如果我在 Windows 资源管理器中选择了几个文件夹，我希望有我自己的上下文菜单项来触发我自己的备份应用程序。此应用程序会提示我输入备份名称和描述。然后它将选定的文件夹移动到特定的集中备份目录 - 它还将在其中生成一个“readme.txt”文件，概述备份详细信息。此外，备份也将按日期/时间进行组织。我觉得这会改进我的备份过程，并促进未来的查找。

但是，**我不禁想知道这样的工具是否已经存在**。当然，在备份方面一定有人像我一样痴迷。

您知道任何可以帮助我改进备份的工具吗？

我知道[这篇文章](https://stackoverflow.com/questions/113423/good-secure-backups-developers-at-home)，但与我想要的并不完全一致。我更愿意将备份保存在同一台机器上——我会自己处理将它们转移到其他机器上。

**更新**

澄清一下：如果我正在处理任务 A，突然我需要为客户端（任务 B）构建一些东西，我必须备份我迄今为止为任务 A 所做的内容，并从源代码管理中获取最新的内容到工作目录中. 然后我开始并完成任务 B，然后恢复任务 A。这是一个理想的、简洁的场景。但有时，我一周后才回到任务 A，或者更久——因为我遇到了任务 C、任务 D 等——所有这些都会影响同一个项目。现在，如果计划签入这些更改，那么我可能会随着我的进步而从签入中受益（但老实说，在这家公司，我们通常等到完成后再签入 - 这意味着更少签入未完成的代码）。所以我不确定我的每个备份是否应该等于一个分支 - 因为我有时会过度使用我的备份。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-12-05T15:57:12.737

我想你想要的是一个分布式版本控制系统，比如 git。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-12-05T16:01:04.227

首先，您现有的源代码控制系统可能已经以分支的形式支持这一点。与其只是复制工作目录，不如将其作为一个单独的分支提交，您可以在其中保留该客户端的应用程序版本。

然而，正如skiphoppy所说，分布式源代码控制系统更适合于此。我很喜欢 Bazaar，但 git 也很受欢迎（虽然我不知道它对 Windows 的支持有多好，因为它主要是为 Linux 内核开发的 *nix 工具）

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-12-05T16:04:14.720

使用[TortoiseSVN的](http://tortoisesvn.tigris.org/)[Subversion](http://subversion.tigris.org/)将为您提供此功能。概念不同（修订，而不是“备份名称”）。您提到的 readme.txt 在 Subversion 日志中进行了总结。您提供的任何评论都可以用来指导其他人查看修订版。查看[关于 Subversion 的 Wikipedia 页面](http://en.wikipedia.org/wiki/Subversion_(software))以及下载它和[TortoiseSVN的](http://tortoisesvn.tigris.org/)[主页](http://subversion.tigris.org/)。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-05T16:16:08.533

CloneZilla，备份您的整个硬盘分区，免费且可靠。我用它代替了 Acronis Echo Server，它在 8 分钟内恢复了我的整个系统。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-12-05T16:17:54.553

正如 skiphoppy 所说，DSVN 确实可以提供帮助。Git 提供了搁置你现在正在处理的东西的能力，这样你的工作副本是干净的，但你可以在完成后将当前的工作集从架子上拉下来。这似乎是你真正想要的。

如果您使用 Perforce，也有几个基于 tar 的实用程序可以执行此操作，但我还没有使用它们。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-12-05T16:19:21.210

改变你的工作方式怎么样，听起来如果你继续这样下去，总有一天事情会变得很糟糕。在更改过程中需要构建一个 dll 并且必须备份正在进行的工作，这很公平，但是一旦发布完成，然后立即将您的更改与发布版本重新集成。我永远不会让自己拥有同一个应用程序的多个备份，但是，嘿，这只是我。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2011-11-17T05:39:44.083

我使用混合备份[www.hybridbackup.com.au](http://hybridbackup.com.au)在。花费一点，但业务是我来自并且我确定大多数其他人的数据。

无论如何，只是想指出你应该有一个很棒的备份系统，这样你就不用担心这些事情了。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-12-05T17:22:40.460

我认为每天晚上检查是一个非常合理的做法。有时我每天检查 3 或 4 次，有时 20 次（实际上每次我的代码都在工作）。

如果您的代码始终签入，您应该可以轻松地同步到不同的分支而无需备份任何内容。

如果您无法在一天结束时检查您的更改，一个非常合理的答案是丢弃它们。你很可能在某个洞里难以自拔，第二天你将在一个小时内复制这项工作，并且比第一次做得更好。此外，如果您长时间使用损坏的代码，您将如何测试？

最后，如果你的代码真的不能每天都检查到构建中（它实际上在某些情况下会发生，不管我在上一段中说了什么），分支。

没有更多的备份。

* * *

## 回答 #9

> 赞同：-2
> 
> 时间：2011-01-21T21:04:13.540

我用：

ZenOK[在线备份](http://onlinebackup.zenok.com/)我的文档和小文件（照片、视频和大文件）

爱它。

# security - 保持软件安全漏洞更新的最佳场所

> ID：344314
> 
> 赞同：1
> 
> 时间：2008-12-05T16:02:11.760
> 
> 标签：security, open-source

应该去哪里随时了解所有安全漏洞/问题？特别是在开源时代，我们倾向于使用来自任何地方的库。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-05T16:05:36.247

这是一个快速列表：

*   [CVE](http://cve.mitre.org/)
*   [安全焦点](http://www.securityfocus.com/vulnerabilities)
*   [塞库尼亚](http://secunia.com/)
*   [证书](http://www.cert.org/)
*   [FRSIRT](http://www.frsirt.com/english/)
*   [安全观察](http://secwatch.org/)
*   [OWASP](http://www.owasp.org/index.php/Category:Vulnerability)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-05T17:03:26.613

*   [国防信息系统局 - 信息保障支持环境](http://iase.disa.mil/index2.html)
*   [国防信息系统局 - 安全技术实施指南](http://iase.disa.mil/stigs/index.html)
*   [国防信息系统局 - 安全准备审查评估脚本](http://iase.disa.mil/stigs/SRR/index.html)

我发现这些链接作为国防承包商很有用，但它们也可能用于民用应用。将 SRR 脚本视为检测您要保护的系统上可能存在的漏洞的一种方法。

# php - 在 PHPUnit 中模拟对象以模拟静态方法调用？

> ID：344315
> 
> 赞同：4
> 
> 时间：2008-12-05T16:02:14.710
> 
> 标签：php, static, mocking, phpunit

我正在尝试测试一个管理数据库中数据访问的类（本质上是 CRUD）。我们使用的 DB 库恰好有一个 API，您首先通过静态调用获取表对象：

```
function getFoo($id) {
  $MyTableRepresentation = DB_DataObject::factory("mytable");
  $MyTableRepresentation->get($id);
  ... do some stuff
  return $somedata
} 
```

...你明白了。

我们正在尝试测试此方法，但要模拟 DataObject 的东西，以便 (a) 我们不需要实际的数据库连接来进行测试，并且 (b) 我们甚至不需要包含 DB_DataObject 库来进行测试.

但是，在 PHPUnit 中，我似乎无法让 $this->getMock() 适当地设置静态调用。我有...

```
 $DB_DataObject = $this->getMock('DB_DataObject', array('factory')); 
```

...但测试仍然显示未知方法“工厂”。我知道它正在创建对象，因为在它说找不到 DB_DataObject 之前。现在可以了。但是，没有办法吗？

我真正想做的是有两个模拟对象，一个也用于返回的表对象。所以，我不仅需要指定 factory 是一个静态调用，还需要它返回一些我已经设置的指定的其他模拟对象。

我应该提醒一下，我不久前在 SimpleTest 中做过这个（找不到代码）并且效果很好。

是什么赋予了？

[更新]

我开始明白它与expects()有关

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-06T15:53:45.507

我同意你们俩的观点，最好不要使用静态调用。但是，我想我忘了提到 DB_DataObject 是第三方库，静态调用是*他们*代码使用的最佳实践，而不是我们的。还有其他方法可以使用它们的对象，包括直接构造返回的对象。它只是将那些该死的 include/require 语句留在使用该 DB_DO 类的任何类文件中。这很糟糕，因为如果你同时试图在你的测试中模拟一个同名的类，测试将会中断（或者只是不被隔离）——至少我认为。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2010-07-19T22:20:36.790

当您无法更改库时，请更改您对它的访问权限。将所有对 DB_DataObject::factory() 的调用重构为代码中的实例方法：

```
function getFoo($id) {
  $MyTableRepresentation = $this->getTable("mytable");
  $MyTableRepresentation->get($id);
  ... do some stuff
  return $somedata
}

function getTable($table) {
  return DB_DataObject::factory($table);
} 
```

现在您可以使用您正在测试的类的部分模拟，并让 getTable() 返回一个模拟表对象。

```
function testMyTable() {
  $dao = $this->getMock('MyTableDao', array('getMock'));
  $table = $this->getMock('DB_DataObject', ...);
  $dao->expects($this->any())
      ->method('getTable')
      ->with('mytable')
      ->will($this->returnValue($table));
  $table->expects...
  ...test...
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-05T16:44:22.753

这是代码中依赖关系的一个很好的例子 - 设计使得无法注入 Mock 而不是真正的类。

我的第一个建议是尝试重构代码以使用实例而不是静态调用。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-05T17:04:42.960

DB_DataObject 类中缺少（或没有？）的是在调用工厂方法之前传递准备好的数据库对象的设置器。这样，如果需要，您可以传递一个模拟或自定义数据库对象（具有相同的接口）。

在您的测试设置中：

```
 public function setUp() {
      $mockDb = new MockDb();
      DB_DataObject::setAdapter($mockDb);
 } 
```

factory() 方法应该返回模拟的数据库实例。如果它尚未集成到您的类中，您可能还必须重构 factory() 方法以使其工作。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-08T21:11:48.920

您是否需要/在测试用例中包含 DB_DataObject 的类文件？如果在 PHPUnit 尝试模拟对象之前该类不存在，您可能会收到类似这样的错误。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2011-06-09T20:48:05.650

使用 PHPUnit MockFunction 扩展和 runkit，您还可以模拟静态方法。小心，因为它是猴子补丁，因此只能在极端情况下使用。不能替代良好的编程实践。

[https://github.com/tcz/phpunit-mockfunction](https://github.com/tcz/phpunit-mockfunction)

# jquery - 是否可以在 ASP.NET MVC 的脚本块中引用 ViewData？

> ID：344316
> 
> 赞同：1
> 
> 时间：2008-12-05T16:02:30.840
> 
> 标签：jquery, asp.net-mvc

我想为使用 jQuery 的按钮添加单击处理程序，但处理程序需要引用控制器提供的数据。有没有办法在 ASP.NET MVC 的脚本块中访问 ViewData？还是我需要在控制器中构建脚本？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-05T16:10:52.290

如果脚本块在 ASP.NET 页面中，那么您可以引用它...

例如：

```
<script type="text/javascript">
    jQuery(document).ready(function() {
        jQuery('#group-edit-form').validate({
            rules: {
                title: {
                    required: true,
                    remote: '<%=Url.Action("ValidateGroupName", new { id = ViewData["GroupId"] }) %>?parentId=' + getParentId()
                }
            },
            messages: {
                title: {
                    required: getMessage (7002),
                    remote: '<%= ((MessagingModel)ViewData["Messages"]).GetMessage (9001) %>'
                }
            }
        })

    });
</script> 
```

当运行时引擎处理页面时，会评估 <% ... %> 块中的所有内容，无论它在页面中的位置如何。

# c - gcc 在哪里寻找 C 和 C++ 头文件？

> ID：344317
> 
> 赞同：203
> 
> 时间：2008-12-05T16:02:35.207
> 
> 标签：c, gcc, header

在 Unix 系统上，gcc 在哪里寻找头文件？

今天早上我花了一点时间寻找一些系统头文件，所以我认为这将是一个很好的信息。

* * *

## 回答 #1

> 赞同：238
> 
> 时间：2008-12-05T17:02:48.487

```
`gcc -print-prog-name=cc1plus` -v 
```

该命令询问 gcc 它正在使用哪个**C++**预处理器，然后询问该预处理器它在哪里查找包含。

您将获得针对您的特定设置的可靠答案。

同样，对于**C**预处理器：

```
`gcc -print-prog-name=cpp` -v 
```

* * *

## 回答 #2

> 赞同：44
> 
> 时间：2008-12-05T16:13:00.570

此外，gcc 会在`-I`选项后指定的目录中查找。

* * *

## 回答 #3

> 赞同：32
> 
> 时间：2008-12-05T16:42:55.720

您可以创建一个尝试包含虚假系统标头的文件。如果您在此类源上以详细模式运行 gcc，它将列出所有系统包含位置，以查找虚假标头。

```
$ echo "#include <bogus.h>" > t.c; gcc -v t.c; rm t.c

[..]

#include "..." search starts here:
#include <...> search starts here:
 /usr/local/include
 /usr/lib/gcc/i686-apple-darwin9/4.0.1/include
 /usr/include
 /System/Library/Frameworks (framework directory)
 /Library/Frameworks (framework directory)
End of search list.

[..]

t.c:1:32: error: bogus.h: No such file or directory 
```

* * *

## 回答 #4

> 赞同：18
> 
> 时间：2008-12-05T16:03:23.193

[GCC 手册](http://gcc.gnu.org/onlinedocs/index.html#dir)的[CPP 部分](http://gcc.gnu.org/onlinedocs/gcc-4.3.2/cpp/)指出头文件可能位于以下目录中：

> > GCC 在几个不同的地方寻找标题。在一个普通的 Unix 系统上，如果你没有另外指示它，它会寻找用 #include 请求的头文件：

```
 /usr/local/include
 libdir/gcc/target/version/include
 /usr/target/include
 /usr/include 
```

> > 对于 C++ 程序，它也会首先在 /usr/include/g++-v3 中查找。

* * *

## 回答 #5

> 赞同：10
> 
> 时间：2015-11-02T19:48:10.640

要让 GCC 打印出将在其中查找系统头文件的完整目录集，请像这样调用它：

```
$ LC_ALL=C gcc -v -E -xc - < /dev/null 2>&1 | 
  LC_ALL=C sed -ne '/starts here/,/End of/p' 
```

这将产生形式的输出

```
#include "..." search starts here:
#include <...> search starts here:
 /usr/lib/gcc/x86_64-linux-gnu/5/include
 /usr/local/include
 /usr/lib/gcc/x86_64-linux-gnu/5/include-fixed
 /usr/include/x86_64-linux-gnu
 /usr/include
End of search list. 
```

如果您`-I`在命令行上有 -family 选项，它们将影响打印出来的内容。

（`sed`命令是为了摆脱这个调用打印的所有*其他*垃圾，并且`LC_ALL=C`是为了确保`sed`命令有效——“从这里开始”和“搜索列表结束”短语*被*翻译为 IIRC。）

* * *

## 回答 #6

> 赞同：10
> 
> 时间：2016-12-29T14:29:59.270

```
g++ -print-search-dirs
gcc -print-search-dirs 
```

* * *

## 回答 #7

> 赞同：9
> 
> 时间：2017-01-18T11:53:25.867

可以通过以下命令检查编译器查找头文件的路径集：-

***cpp -v***

如果声明***#include ""***，编译器首先在源文件的当前目录中搜索，如果没有找到，则继续在上面检索到的目录中搜索。

如果您声明***#include <>***，编译器会直接在从上述命令获得的目录中搜索。

来源：- [http://commandlinefanatic.com/cgi-bin/showarticle.cgi?article=art026](http://commandlinefanatic.com/cgi-bin/showarticle.cgi?article=art026)

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2013-10-03T22:58:02.700

通过检查以下内容，可以从 bash 中查看 C 程序的（附加）包含路径：

```
echo $C_INCLUDE_PATH 
```

如果这是空的，可以通过以下方式修改它以添加默认包含位置：

```
export C_INCLUDE_PATH=$C_INCLUDE_PATH:/usr/include 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2017-04-09T08:02:38.987

这些是 gcc 默认查找指定头文件的目录（假设头文件包含在 chevrons <> 中）；1\. /usr/local/include/ --用于第 3 方头文件。2\. /usr/include/ -- 用于系统头文件。

如果您决定将自定义头文件放在上述目录以外的位置，您可以按如下方式包含它们： 1\. 在文件路径中使用引号 ("./custom_header_files/foo.h")，而不是 V 形在包含语句中。2\. 编译代码时使用-I 开关。gcc -I /home/user/custom_headers/ -c foo.c -p foo.o 基本上 -I 开关告诉编译器首先查看 -I 开关指定的目录（在检查标准目录之前）。当使用 -I 开关可以使用 V 形包含头文件。

# visual-c++ - midl.exe 6 和 midl.exe 7 的不同输出

> ID：344320
> 
> 赞同：1
> 
> 时间：2008-12-05T16:03:21.837
> 
> 标签：visual-c++, rpc, midl

我很想将 MSVC 项目从 VS 2005 转换为 VS 2008。它包含一个 IDL 文件，该文件输出用于 RPC 的标头和存根。VS 2005 项目使用 MIDL.exe 版本 6.00.0366。VS 2008 项目使用 MIDL.exe 版本 7.00.0500。

这就是问题所在：MIDL v6 输出以下原型供我在我的服务器代码中实现：

```
HRESULT PRC_Function(UINT input); 
```

具有相同命令行的 MIDL v7 输出此原型：

```
HRESULT RPC_Function(handle_t IDL_handle, UINT input); 
```

我不想将handle_t 参数添加到我现有的所有实现中。（另外，我仍然需要使用 VS 2005 编译一段时间。）

问：如何让 MIDL.exe v7 输出与 v6 相同的 RPC 服务器原型？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-05T17:00:32.470

看来我可以回答我自己的问题...

MIDL v6 似乎自动将服务器原型的句柄类型默认为 auto_handle。MIDL v7 没有，因此解决方案是使用其中包含 auto_handle 设置的 Server.acl 文件。这将输出一个 Server.h 文件，其中的函数原型在 MIDL v6 和 v7 之间是相同的。

但是，它也会输出一条警告，表明“auto_handle”已被贬值。相反，我使用了implicit_handle(handle_t IDL_handle)。

太糟糕了，这个网站没有给我徽章来回答我自己的问题。我也不能将自己的答案标记为正确答案。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-04-19T22:57:25.647

handle_t IDL_handle 用于显式 RPC 绑定句柄。在服务器端，你可以用它做一些很酷的事情，比如通过各种 RPC 函数拉调用客户端的令牌以进行模拟，但如果你不需要使用它，只需将其设置为未引用参数（UNREFERENCED_PARAMETER (IDL_handle);)。现在似乎不推荐使用隐式绑定句柄。

在客户端，您使用绑定到 RPC 服务器时获得的绑定句柄来获取 IDL_handle 参数。

# vb.net - 如何导致我的 VSTO 2005 SE Outlook 插件崩溃以使其被禁用？

> ID：344325
> 
> 赞同：1
> 
> 时间：2008-12-05T16:04:49.290
> 
> 标签：vb.net, outlook, registry, vsto, add-in

出于测试目的，我需要禁用 Outlook 2003 插件 (vb.net)，以便只能通过帮助菜单或从注册表中删除弹性键来重新激活它。

我试图通过在启动事件处理程序期间创建一个未处理的无效强制转换异常来实现这一点，但这无济于事。Outlook 只说它无法加载插件，但它没有禁用它。

如何创建禁用插件的崩溃？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-08T11:53:07.550

我自己找到了一个简单的方法：

*   在插件的启动事件处理程序中设置断点。
*   在调试模式下从 Visual Studio 中启动插件。
*   到达断点时打开任务管理器。
*   终止 Outlook 进程。
*   正常启动 Outlook（不是从 Visual Studio 启动）。

-> Outlook 现在会询问您是否要禁用插件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-15T16:20:46.073

另一个操作可能是在启动调用期间，例如

`System.Threading.Thread.Sleep(10000)`

在任务管理器的这个杀戮前景中。

下次启动 Outlook 时，它会询问您是否要禁用该插件。

# c# - 按名称过滤对象属性

> ID：344327
> 
> 赞同：2
> 
> 时间：2008-12-05T16:05:31.630
> 
> 标签：c#, string, properties

我正在对各种类型进行一些简单的完整性验证。我正在进行的当前测试是检查以确保填充了它们的属性。在这种情况下，填充被定义为不为空，长度大于零（如果是字符串），或者不等于 0（如果是整数）。

此测试的“棘手”部分是某些属性不受此检查的影响。现在我使用一个巨大的 if 语句来清除不需要检查的属性。

```
//Gets all the properties of the currect feature.
System.Reflection.PropertyInfo[] pi = t.GetProperties();

for(int i = 0; i < pi.Length; i++)
{
    if(!pi[i].Name.Equals("PropertyOne") 
    && !pi[i].Name.Equals("PropertyTwo") 
    && !pi[i].Name.Equals("PropertyThree") 
            //... repeat a bunch more times
    && !pi[i].Name.IndexOf("ValueOne") != -1 
    && !pi[i].Name.IndexOf("ValueTwo") != -1 
            //... repeat a bunch more times
    {
        //Perform the validation check.
    }                 
} 
```

在进行分析时，我注意到 if 语句实际上比反射执行得更差（并不是说反射非常快）。有没有更有效的方法来过滤几种不同类型的属性？

我考虑过一个庞大的正则表达式，但我不确定如何格式化它，而且考虑到它的大小，它可能不可读。我也考虑过将值存储在 List 中，然后使用 Linq，但我不确定如何处理使用 String.IndexOf() 来查找属性是否包含某个值的情况。

提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-05T16:09:57.860

使用 PropertyOne、PropertyTwo 等创建一个 HashSet “exactNames”，然后使用 ValueOne、ValueTwo 等创建一个 List “partialNames”。然后：

```
var matchingProperties = pi.Where(exactNames.Contains(pi.Name) ||
                          partialNames.Any(name => pi.Name.Contains(name));

foreach (PropertyInfo property in matchingProperties)
{
    // Stuff
} 
```

（奇怪的缩进只是为了避免换行。）

请注意，您可以缓存一组属性以在每种类型的基础上进行验证，因此您只需对每种类型进行一次此检查。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-05T17:48:48.037

您的想法有助于加快我的程序，谢谢。但是，您遇到了一些语法问题，而且您正在匹配列表中的项目，而我需要不在列表中的项目。这是我最终使用的代码。

```
List<System.Reflection.PropertyInfo> pi = type.GetProperties().ToList();

var matchingProperties = pi.Where( prop => !PropertyExclusionSet.Contains( prop.Name )
&& !PropertiesPartialSet.Any( name => prop.Name.Contains( name ) ) ); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-05T18:04:43.013

您可能会考虑使用属性来装饰您的属性，这些属性告诉您需要对它们执行什么操作。

```
public class MyClass {

   [CheckMe]
   public int PropertyOne { get; set; }

   [DontCheckMe]
   public int PropertyTwo { get; set; }

} 
```

# c# - Windows Mobile (C#) - 手机和 PC 之间的通信

> ID：344335
> 
> 赞同：5
> 
> 时间：2008-12-05T16:08:26.367
> 
> 标签：c#, windows-mobile

我正在做一个项目，其中运行在手机上的程序需要与运行在它所连接的 PC 上的程序进行通信。理想情况下，我想使用 USB、WiFi 等进行通信。

这两个程序应该能够交流电池寿命、短信等内容……但我可以稍后再处理，我只需要让他们说话。

最好的方法是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-05T16:54:37.910

假设您有 wifi 连接，您的 Windows Mobile 程序与您的 PC 通信的一种方法是在 .NET compact framework 3.5 上使用 WCF。

您将创建一个新的 WCF 应用程序来运行您的 PC，并公开一个接口，以公开您希望从 Windows Mobile 设备调用的函数。

Windows Mobile 上的 WCF 需要在您的设备上安装 Compact Framework 3.5。您还需要“Windows Mobile Power Toys”才能生成兼容的代理以从 Windows Mobile 调用。

[.NET Compact Framework 3.5 的强力玩具](http://www.microsoft.com/downloads/details.aspx?FamilyID=c8174c14-a27d-4148-bf01-86c2e0953eab&DisplayLang=en)

从您的 WM 设备调用 WCF 服务还需要您手动设置绑定和端点以传递到您的 Web 服务代理（使用桌面 WCF，这是通过从配置文件加载它们自动完成的）。

Windows Mobile 上的 WCF 目前仅支持基本的 http 绑定（可以根据需要进行加密），但这可能足以满足您的需求。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-05T16:30:44.807

“最佳”实际上是主观的，并且高度依赖于许多因素，如设备、拓扑、防火墙存在、安全需求等。

您需要从哪里发起通信，您是否有 ActiveSync 连接？如果 PC 启动通信并且您拥有 ActiveSync，那么 RAPI 就是您要使用的传输方式，因为它已经完成并准备好所有基础设施。

对于其他任何事情，您都需要某种形式的专有协议和传输机制。通常，我编写一个简单的套接字协议，它具有定义的消息结构（通常是消息 ID、CRC、消息长度和数据有效负载）。然后，我有一些基本消息类来处理我想要的每个特定命令的通信和一组派生消息。对于需要响应的 2-way 的东西，我通常创建一个基本的 Response 类，然后从中派生特定的响应格式。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-05T16:24:49.343

您可以尝试查看 OpeNETCF.Desktop.Communications 库。您可以从[http://www.opennetcf.com/FreeSoftware/tabid/84/Default.aspx](http://www.opennetcf.com/FreeSoftware/tabid/84/Default.aspx)开始，然后按照链接查找必要的下载。（我认为您可能需要从他们的 subversion 存储库中获取它）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-05T20:49:43.100

WIMO 正在研究 WiFi 到桌面的支持，可能会完成。无论哪种方式，都可能值得看一下代码。

[家](http://www.wimobot.com/)

[来源](http://www.wimobot.com/SourceCode.aspx#WimoII)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-04-05T12:17:16.607

在 2015 年发现了这个，所以我认为答案与原始提问者无关，但记录在案：Proximity [https://msdn.microsoft.com/en-us/library/windows/apps/xaml /hh465205.aspx](https://msdn.microsoft.com/en-us/library/windows/apps/xaml/hh465205.aspx)

# windows - SVN说我需要进行清理，但是清理失败

> ID：344341
> 
> 赞同：6
> 
> 时间：2008-12-05T16:10:08.000
> 
> 标签：windows, svn, tortoisesvn, commit

**重复：** [SVN 中的工作副本 XXX 被锁定并且清理失败](https://stackoverflow.com/questions/127932/svn-working-copy-xxx-locked-and-cleanup-failed)

当我尝试提交时：

```
Error: Working copy 'D:\Webs\Drupal 6' locked  
Error: Please execute the "Cleanup" command. 
```

当我尝试进行清理时：

```
Cleanup failed to process the following paths:
D:\Webs\Drupal 6 
```

我怎么解决这个问题？

# signal-processing - 低通滤波器软件？

> ID：344343
> 
> 赞同：2
> 
> 时间：2008-12-05T16:11:22.100
> 
> 标签：signal-processing, filter

我正在为 .net windows 窗体项目寻找数字低通滤波器代码/库/类，最好用 c、c++ 或 c# 编写。我可能需要设置极点数、系数、窗口等。我不能使用任何可用的 gpl 代码，也不知道还有什么。任何建议表示赞赏。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2008-12-05T16:18:31.557

这是我为最近的一个项目编写的巴特沃斯低通滤波器。

它有一些神奇的数字作为给我的常数。如果您能弄清楚如何用极点、系数等创建幻数，那么这可能会有所帮助。

```
using System;
using System.Collections.Generic;
using System.Text;

namespace Filter
{
public class ButterworthLowPassFilter
{

    //filter fc = 2hz, fs = 10hz

    private const int LowPassOrder = 4;

    private double[] inputValueModifier;
    private double[] outputValueModifier;
    private double[] inputValue;
    private double[] outputValue;
    private int valuePosition;

    public ButterworthLowPassFilter()
    {
        inputValueModifier = new double[LowPassOrder];
        inputValueModifier[0] = 0.098531160923927;
        inputValueModifier[1] = 0.295593482771781;
        inputValueModifier[2] = 0.295593482771781;
        inputValueModifier[3] = 0.098531160923927;

        outputValueModifier = new double[LowPassOrder];
        outputValueModifier[0] = 1.0;
        outputValueModifier[1] = -0.577240524806303;
        outputValueModifier[2] = 0.421787048689562;
        outputValueModifier[3] = -0.0562972364918427;
    }

    public double Filter(double inputValue)
    {
        if (this.inputValue == null && this.outputValue == null)
        {
            this.inputValue = new double[LowPassOrder];
            this.outputValue = new double[LowPassOrder];

            valuePosition = -1;

            for (int i=0; i < LowPassOrder; i++)
            {
                this.inputValue[i] = inputValue;
                this.outputValue[i] = inputValue;
            }

            return inputValue;
        }
        else if (this.inputValue != null && this.outputValue != null)
        {
            valuePosition = IncrementLowOrderPosition(valuePosition);

            this.inputValue[valuePosition] = inputValue;
            this.outputValue[valuePosition] = 0;

            int j = valuePosition;

            for (int i = 0; i < LowPassOrder; i++)
            {
                this.outputValue[valuePosition] += inputValueModifier[i] * this.inputValue[j] -
                    outputValueModifier[i] * this.outputValue[j];

                j = DecrementLowOrderPosition(j);
            }

            return this.outputValue[valuePosition];
        }
        else
        {
            throw new Exception("Both inputValue and outputValue should either be null or not null.  This should never be thrown.");
        }
    }

    private int DecrementLowOrderPosition(int j)
    {
        if (--j < 0)
        {
            j += LowPassOrder;
        }
        return j;
    }

    private int IncrementLowOrderPosition(int position)
    {
        return ((position + 1) % LowPassOrder);
    }

}
} 
```

基思

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-18T08:03:49.477

好的，我发现了如何获得您使用的系数。我为 windows 下载了 Octave 并运行了 butter 命令（如在 MatLab 中），如下所示：

[b,a] = 黄油(3, .4, '低')

现在我可以将此代码与其他 fs 和 fc 参数一起使用。

# sql-server - 存储过程修改位标志，不能使用枚举，因为很多应用程序都会修改它，我该怎么办？

> ID：344350
> 
> 赞同：-1
> 
> 时间：2008-12-05T16:14:47.400
> 
> 标签：sql-server, stored-procedures, bit-manipulation

数据库中有一个 INT 类型的列（Sql server）。

这个 int 值用于位标志，所以我将对它进行 AND'ing 和 OR'ing。

我必须将一个参数传递到我的存储过程中，该参数将代表一个特定的标志项。

**我通常会使用枚举并将 int 表示传递给 sproc**，但由于许多不同的模块将访问它，因此它们都拥有我的枚举定义是不切实际的（如果它被更改，那将是一个令人头疼的问题推出）。

所以我应该使用“字符串”还是幻数作为参数值，然后在我的存储过程中我会这样做：

```
IF(@blah = 'approved')
BEGIN
      // bit banging here
END 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-05T16:35:28.543

您可以使用字符串和 CASE 构造：

```
CREATE PROCEDURE BitBang(@Flag AS VARCHAR(50), @Id AS INT)
AS
BEGIN
  DECLARE @Bit INT

  SET @BIT = CASE @Flag
    WHEN 'approved'   THEN 16
    WHEN 'noapproved' THEN 16
    WHEN 'fooflag'    THEN 8
    WHEN 'nofooflag'  THEN 8
  END

  IF @Bit IS NOT NULL
  BEGIN
    IF LEFT(@Flag, 2) = 'no' 
    BEGIN
      UPDATE TheTable SET BitField = BitField & ~@Bit WHERE Id = @Id
    END
    ELSE
    BEGIN
      UPDATE TheTable SET BitField = BitField | @Bit WHERE Id = @Id
    END
  END
END 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-05T16:24:51.060

为什么不使用旧的 0 和 1 作为标志？它已经被广泛接受为位开关，对于 0 和 1 的含义不会有任何混淆或拼写错误。除非你说会有超过 2 个标志并且超过 1 个标志将具有相同的最终含义

# c# - 派生静态成员

> ID：344363
> 
> 赞同：3
> 
> 时间：2008-12-05T16:18:31.573
> 
> 标签：c#, design-patterns, oop

我有一个具有私有静态成员的基类：

```
class Base
{
    private static Base m_instance = new Base();
    public static Base Instance
    {
        get { return m_instance; }
    }
} 
```

我想从中派生多个类：

```
class DerivedA : Base {}
class DerivedB : Base {}
class DerivedC : Base {} 
```

但是，此时调用 DerivedA::Instance 将返回与 DerivedB::Instance 和 DerivedC::Instance 完全相同的对象。我可以通过在派生类中声明实例来解决这个问题，但是每个派生类都需要这样做，这似乎是不必要的。那么有没有办法将所有这些都放在基类中？可以应用设计模式吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-12-05T16:21:56.760

有一种非常讨厌的方法：

```
class Base
{
     // Put common stuff in here...
}

class Base<T> : Base where T : Base<T>, new()
{
    private static T m_instance = new T();

    public static T Instance { get { return m_instance; } }
}

class DerivedA : Base<DerivedA> {}
class DerivedB : Base<DerivedB> {}
class DerivedC : Base<DerivedC> {} 
```

这是有效的，因为*每个构造类型*都有一个静态变量——例如`List<string>`，它是不同的类型`List<int>`，因此会有单独的静态变量。

我也借此机会将其作为派生类的实例——我不知道这是否是你想要的，但我想我至少可以让你使用它:)

但总的来说，这是一件令人讨厌的事情。静态变量并不是真正为这种用途而设计的——我只是滥用泛型的一个特性来获得你所要求的“某种”行为。

另请注意，这将返回与- 属性/变量不“知道”您正在使用`Base<DerivedA>.Instance`的结果相同的结果。我不知道这对你是否重要。`DerivedA.Instance``DerivedA.Instance`

使用额外的非泛型类，您可以编写：

```
Base t = DerivedA.Instance;
t = DerivedB.Instance; 
```

如果你不需要那个，把它拿出来:)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-12-05T16:21:09.710

静态方法不支持多态性，因此，这样的事情是不可能的。

从根本上说，Instance 属性不知道您是如何使用它的。并且它的单个实现将存在，因为它是静态的。如果你真的想这样做，这个“不推荐”的解决方案是可用的（我从乔恩的解决方案中得到了这个想法）：

```
private static Dictionary<Type, Base> instances = new Dictionary<Type, Base>();
public static T GetInstance<T>() where T : Base, new() {
  Type ty = typeof(T);
  T x;
  if (instances.TryGetValue(ty, out x)) return x;
  x = new T();
  instances[ty] = x;
  return x;
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-12-05T16:29:06.997

简短的回答：我不知道。静态成员总是非虚拟的并且不容易支持多态性。

但是，您还应该问自己*为什么*要这样做。通常，静态成员是该类的每个实例（包括派生类）都会发现有用的共享资源。然而，当你创建一个静态实例时，你通常会构建一个单例模式。在这种情况下，您通常希望密封类，这样您就不能拥有派生类，从而使整个问题变得毫无意义。因此，您应该真正分析为什么要这样做并解决该问题。

# tfs - 安装 TFS 2008 SP1 时出错，数据库“master”中的 CREATE TABLE 权限被拒绝

> ID：344372
> 
> 赞同：0
> 
> 时间：2008-12-05T16:19:41.850
> 
> 标签：tfs

刚才 dba 让我使用 Sql Server Management Studio 连接到数据库，这就是我注意到 tfs 设置和服务用户的默认数据库是主数据库的原因，这可以吗？这就是我出现此错误的原因吗？ , 让我发布部分日志和设置用户的属性，以确认用户配置正确。

以下是错误日志的一部分：

```
Using workflow file from location exe. 
Executing workflow 'Quiesce ATDT'... 
Stopping Windows Service 'TFSServerScheduler'... 
Stopping Windows Service 'CoverAn'... 
Stopping Windows Service 'W3SVC'... 
Starting Windows Service 'W3SVC'... 
Disabling SQL Jobs for databases     
FSActivityLogging,TFSBuild,TFSIntegration,TFSVersionControl,TFSWorkItemTracking,TFSWorkItemTrackingAttachments,TFSWarehouse 
CREATE TABLE permission denied in database 'master'. 
Retrying... 
Disabling SQL Jobs for databases
TFSActivityLogging,TFSBuild,TFSIntegration,TFSVersionControl,TFSWorkItemTracking,TFSWorkItemTrackingAttachments,TFSWarehouse 
CREATE TABLE permission denied in database 'master'. 
Retrying... 
Disabling SQL Jobs for databases
TFSActivityLogging,TFSBuild,TFSIntegration,TFSVersionControl,TFSWorkItemTracking,TFSWorkItemTrackingAttachments,TFSWarehouse 
CREATE TABLE permission denied in database 'master'. 
Retrying... 
Disabling SQL Jobs for databases 
TFSActivityLogging,TFSBuild,TFSIntegration,TFSVersionControl,TFSWorkItemTracking,TFSWorkItemTrackingAttachments,TFSWarehouse 
CREATE TABLE permission denied in database 'master'. 
Retrying... 
Disabling SQL Jobs for databases 
TFSActivityLogging,TFSBuild,TFSIntegration,TFSVersionControl,TFSWorkItemTracking,TFSWorkItemTrackingAttachments,TFSWarehouse 
CREATE TABLE permission denied in database 'master'. 
Retrying... 
Disabling SQL Jobs for databases

TFSActivityLogging,TFSBuild,TFSIntegration,TFSVersionControl,TFSWorkItemTracking,TFSWorkItemTrackingAttachments,TFSWarehouse 
SQL Error #1 
SQL Message: CREATE TABLE permission denied in database 'master'. 
SQL LineNumber: 13 
SQL Source: .Net SqlClient Data Provider 
SQL Procedure:  

System.Data.SqlClient.SqlException: CREATE TABLE permission denied in database 'master'. 
   at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection) 
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection) 
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj) 
   at System.Data.SqlClient.TdsParser.Run(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj) 
   at System.Data.SqlClient.SqlCommand.RunExecuteNonQueryTds(String methodName, Boolean async) 
   at System.Data.SqlClient.SqlCommand.InternalExecuteNonQuery(DbAsyncResult result, String methodName, Boolean sendToPipe) 
   at System.Data.SqlClient.SqlCommand.ExecuteNonQuery() 
   at Microsoft.TeamFoundation.Admin.TFSQuiesce.Quiescer.DisableJobs(XPathNavigator workflow) 
   at Microsoft.TeamFoundation.Admin.TFSQuiesce.Quiescer.ProcessSqlDatabaseElement(XPathNavigator workflow, String action, String dbName) 
   at Microsoft.TeamFoundation.Admin.TFSQuiesce.Quiescer.ExecuteWorkflowStep(XPathNavigator workflow, String action, String nameAttribute) 
   at Microsoft.TeamFoundation.Admin.TFSQuiesce.Quiescer.ExecuteWorkflowStepWithRetry(XPathNavigator workflow, String action, String nameAttribute) 
   at Microsoft.TeamFoundation.Admin.TFSQuiesce.Quiescer.RunWorkflow(String workflowName) 
Exception Data: 
Key: HelpLink.ProdName, Value: Microsoft SQL Server 
Key: HelpLink.ProdVer, Value: 09.00.3054 
Key: HelpLink.EvtSrc, Value: MSSQLServer 
Key: HelpLink.EvtID, Value: 262 
Key: HelpLink.BaseHelpUrl, Value: http://go.microsoft.com/fwlink 
Key: HelpLink.LinkId, Value: 20476 

Executing workflow 'Unquiesce ATDT'... 
Enabling SQL Jobs. 
Unblocking service account from accessing database TFSActivityLogging 
Unblocking service account from accessing database TFSBuild 
Unblocking service account from accessing database TFSIntegration 
Unblocking service account from accessing database TFSVersionControl 
Unblocking service account from accessing database TFSWorkItemTracking 
Unblocking service account from accessing database TFSWorkItemTrackingAttachments 
Unblocking service account from accessing database TFSWarehouse 
Stopping Windows Service 'W3SVC'... 
Starting Windows Service 'W3SVC'... 
Starting Windows Service 'TFSServerScheduler'... 
Starting Windows Service 'CoverAn'... 

Workflow 'Quiesce ATDT' failed! ExitCode = 9000\. 
12/03/08 16:29:03 DDSet_Status: Process returned 9000 
12/03/08 16:29:03 DDSet_Status: Found the matching error code  for return value '9000' and it is: '29207' 
12/03/08 16:29:03 DDSet_Error:  9000 
12/03/08 16:29:03 DDSet_CARetVal: 29207 
12/03/08 16:29:03 DDSet_Status: QuietExec returned 29207 
12/03/08 16:29:03 DDSet_Exit: QuietExec ended 
MSI (s) (44:18) [16:29:03:812]: User policy value 'DisableRollback' is 0 
MSI (s) (44:18) [16:29:03:812]: Machine policy value 'DisableRollback' is 0 
Action ended 16:29:03: InstallFinalize. Return value 3\. 
```

以下是 SQL 中设置用户的属性：

**通用**
登录名：CNBYV\SRVSTFTN
Windows 身份验证
默认数据库：master
默认语言：英语

**服务器角色**
dbcreator
public
sercurityadmin

**User Mapping**
Map Database User DefaultSchema Default Role
Checked master CNBYV\SRVSTFTN ... public
Checked
TfsActivityLogging dbo dbo dbo_owner, public Checked TfsBuild dbo dbo dbo_owner, public
Checked TfsIntegration dbo dbo dbo_owner, public
Checked TfsVersionControl dbo dbo dbo_owner, public
Checked TfsWarehouse dbo dbo dbo_owner , public
检查 TfsWorkItemTracking dbo dbo dbo_owner, public
检查 TfsWorkItemTrackingAttachments dbo dbo dbo_owner, public

这些是我发现更重要的设置，如果您需要更多信息，请告诉我。

非常感谢。

PS：发布上面的表格只是很痛苦，我不知道为什么人们喜欢 Markdown，如果有人知道如何修复它，使它看起来像一个表格，请编辑问题*。*

胡安·扎穆迪奥

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-12-18T22:01:52.623

老兄转到文件>源控制>工作区并编辑并删除您已经映射的wspace，这将解决问题

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-06T19:31:28.657

解决方案是将角色“sysadmin”添加到 TFS 的设置用户，我遇到了另一个问题（TfsWarehouse 问题），但是关于 master 中权限被拒绝的问题已经解决。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-10-08T14:05:08.613

实际上，将 sysadmin 角色添加到 TFSSETUP 帐户是一件非常激进的事情。在我的公司里，这只是一个很大的禁忌。DBA 为我创建了一个数据库供我使用。我尝试使用 H_DB_NAME 将 tfsdb（TFS DB 设置实用程序）指向它，但它似乎不起作用。

Microsoft 是否发布了有关可以在 msiproperty.ini 中设置的所有可能属性的任何有用详细信息？Koz，我根本找不到太多有用的东西。

Microsoft，如果您在听，我实际上正在考虑完全放弃 TFS，因为您无法体面地生成和/或记录您的设置过程。

# c# - C#/.NET 上的 ActiveX 文档或类似的东西

> ID：344373
> 
> 赞同：1
> 
> 时间：2008-12-05T16:20:52.333
> 
> 标签：c#, activex, document

如何在 C#/.NET 上实现 ActiveX 文档？（ActiveX 文档可以在 IE 中自己绘制）
**更新：**我需要一个解决方案来在 IE 窗口中绘制我自己的文档类型（如 MS Word 或 MS Excel 在 IE 中绘制其文档）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-05T16:56:26.677

为此，您需要深入了解 OLE。

诸如 IOleDocument、IOleInPlaceSite 之类的东西（参见[MSDN](http://msdn.microsoft.com/en-us/library/ms687196.aspx)）。弄清楚客户端需要哪些接口（因为 IE 将是容器并且需要与您的接口实现进行通信），以及通信是如何进行的，例如何时调用什么。这不是火箭科学，但我相信仍然相当多的工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-05T16:26:31.773

查看[http://msdn.microsoft.com/en-us/library/system.windows.forms.htmldocument.domdocument.aspx](http://msdn.microsoft.com/en-us/library/system.windows.forms.htmldocument.domdocument.aspx)，它是 DOM Document 的 .NET 包装器

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-05T17:00:13.437

我的第一个想法是您可以使用[WPF Page](http://msdn.microsoft.com/en-us/library/system.windows.controls.page.aspx)，它可以托管在 WPF 窗口或 IE 中。

来自 MSDN：

> 封装可以导航到 Windows Internet Explorer、NavigationWindow 和 Frame 并由其托管的内容页面。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-09T03:43:52.763

这是可能的，但很难。糟糕的是缺乏文档……微软对支持这种情况没有兴趣。另一个困难的部分是调试 HTML/DOM 和 ActiveX 控件之间的边界。

对于您正在做的事情，听起来 Silverlight 会是一个更好的选择。它只支持 .Net 的一个子集，但它支持绘制图形。查找文档会容易得多。它将在非 Windows 计算机上运行。

但也许您需要 Silverlight 不具备的功能（例如音频输入支持）。如果是这样的话，有各种不同质量的主题的博客。以下是对我最有帮助的两个：

[http://www.codeproject.com/KB/cs/CreateActiveXDotNet.aspx](http://www.codeproject.com/KB/cs/CreateActiveXDotNet.aspx)

[http://blog.ianchivers.com/wordpress/?p=22](http://blog.ianchivers.com/wordpress/?p=22)

我确实建议使用 OleView 来检查您生成的类型库，并确保它符合您的期望。您也可以这样做以了解如何将事件属性分解为 get/set 函数，这是我在调试某些场景时必须做的事情。

还要认识到“将调试器附加到进程”与脚本或托管调试的区别。在某些时候，当你认为你已经使用了另一个时，你会附上一个。

# asp.net - asp.net 中的高级搜索表单验证

> ID：344379
> 
> 赞同：0
> 
> 时间：2008-12-05T16:22:58.350
> 
> 标签：asp.net, javascript, validation, search, client-side

我正在寻找对一个或多个字段具有值的页面进行验证。我在 asp.net 中有一个高级搜索表单，如果所有字段都为空，我会尝试弹出一个错误并且不回发。我研究了必填字段验证器，但我不确定如何使它们以 AND 类型的方式协同工作，而不是一组必填字段验证器所暗示的 OR 方式。我希望这是有道理的。谢谢您的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-05T16:27:19.760

您可以自己编写 javascript 验证函数来处理这种情况并将其附加到您的搜索按钮。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-05T16:30:21.970

几年前我不得不做类似的事情，那时我正在使用 1.1。我们最终做的是创建必填字段验证器但禁用它们。然后 onload 我们将遍历验证器字典，启用它们并检查它们是否通过。如果其中任何一个通过了，我们就会中断循环并继续执行，否则，如果它们都失败了，那么我们会显示一个警告。不幸的是，这需要回发。

如果您想在客户端完成此操作，那么您可以编写一个简单的 javascript 函数来在回发之前处理它。对于每个控件，放置一个 onBlur 事件。javascript 将检查字段中是否有值并维护一个标志。然后在提交之前，您将检查标志并允许提交或显示警告。

# java - 为什么 Java 日历中的 1 月是 0 月？

> ID：344380
> 
> 赞同：327
> 
> 时间：2008-12-05T16:23:22.920
> 
> 标签：java, calendar

在`java.util.Calendar`中，一月被定义为第 0 个月，而不是第 1 个月。有什么具体原因吗？

我看到很多人对此感到困惑...

* * *

## 回答 #1

> 赞同：344
> 
> 时间：2008-12-05T16:29:41.283

它只是 Java 日期/时间 API 的可怕混乱的一部分。列出它的问题需要很长时间（而且我确信我不知道一半的问题）。诚然，处理日期和时间很棘手，但无论如何。

帮自己一个忙，改用[Joda Time](http://joda-time.sourceforge.net/)或[JSR-310](http://sourceforge.net/apps/mediawiki/threeten/index.php?title=ThreeTen)。

编辑： 至于原因 - 正如其他答案中所述，这很可能是由于旧的 C API，或者只是从 0 开始的一般感觉......当然，除了那些日子从 1 开始。我怀疑原始实施团队之外的任何人是否真的能说明原因 - 但我再次敦促读者不要太担心*为什么*会做出错误的决定，而是要看看整个肮脏的范围`java.util.Calendar`并找到更好的东西。

支持使用基于 0 的索引的一点*是*，它使诸如“名称数组”之类的事情变得更容易：

```
// I "know" there are 12 months
String[] monthNames = new String[12]; // and populate...
String name = monthNames[calendar.get(Calendar.MONTH)]; 
```

当然，一旦你得到一个 13 个月的日历，这就会失败......但至少指定的大小是你期望的月数。

这不是一个*好*理由，但这是*一个*理由......

编辑：作为评论请求一些关于我认为日期/日历有问题的想法：

*   令人惊讶的基数（1900 作为 Date 的年基数，不可否认的是已弃用的构造函数；0 作为两个月基数）
*   可变性——使用不可变类型可以*更*简单地处理真正有效的*值*
*   类型集不足：拥有`Date`和`Calendar`作为不同的东西很好，但是缺少“本地”与“分区”值的分离，日期/时间与日期与时间也是如此
*   一个 API 会导致带有魔法常量的丑陋代码，而不是明确命名的方法
*   一个很难推理的 API - 关于何时重新计算事物等的所有业务
*   使用无参数构造函数默认为“现在”，这导致代码难以测试
*   始终使用系统本地时区的`Date.toString()`实现（以前让许多 Stack Overflow 用户感到困惑）

* * *

## 回答 #2

> 赞同：53
> 
> 时间：2013-08-01T19:34:20.807

因为用几个月做数学要容易得多。

12 月后的 1 个月是 1 月，但要正常计算，您必须获取月份数并进行数学运算

```
12 + 1 = 13 // What month is 13? 
```

我知道！我可以通过使用 12 的模数来快速解决这个问题。

```
(12 + 1) % 12 = 1 
```

这可以正常工作 11 个月，直到 11 月......

```
(11 + 1) % 12 = 0 // What month is 0? 
```

您可以通过在添加月份之前减去 1 来再次完成所有这些工作，然后进行取模，最后再次加 1……也就是解决一个潜在的问题。

```
((11 - 1 + 1) % 12) + 1 = 12 // Lots of magical numbers! 
```

现在让我们考虑一下 0 - 11 个月的问题。

```
(0 + 1) % 12 = 1 // February
(1 + 1) % 12 = 2 // March
(2 + 1) % 12 = 3 // April
(3 + 1) % 12 = 4 // May
(4 + 1) % 12 = 5 // June
(5 + 1) % 12 = 6 // July
(6 + 1) % 12 = 7 // August
(7 + 1) % 12 = 8 // September
(8 + 1) % 12 = 9 // October
(9 + 1) % 12 = 10 // November
(10 + 1) % 12 = 11 // December
(11 + 1) % 12 = 0 // January 
```

所有月份的工作方式都是一样的，不需要解决问题。

* * *

## 回答 #3

> 赞同：37
> 
> 时间：2008-12-05T16:35:42.207

基于 C 的语言在某种程度上复制了 C。`tm`结构（定义在 中）`time.h`有一个整数字段`tm_mon`，（注释）范围为 0-11。

基于 C 的语言在索引 0 处开始数组。因此，这对于在月份名称数组中输出字符串很方便，并`tm_mon`作为索引。

* * *

## 回答 #4

> 赞同：26
> 
> 时间：2011-08-24T16:56:18.933

对此有很多答案，但无论如何我都会就这个问题发表我的看法。如前所述，这种奇怪行为背后的原因来自 POSIX C `time.h`，其中月份存储在范围为 0-11 的 int 中。要解释原因，请这样看；年和日在口语中被认为是数字，但月份有自己的名字。因此，由于一月是第一个月，它将被存储为偏移量 0，即第一个数组元素。`monthname[JANUARY]`将是`"January"`。一年中的第一个月是第一个月数组元素。

另一方面，日期数字，因为它们没有名称，将它们存储在 int 中作为 0-30 会令人困惑，添加很多`day+1`输出指令，当然，容易出现很多错误。

话虽如此，这种不一致是令人困惑的，尤其是在 javascript（它也继承了这个“特性”）中，这是一种脚本语言，它应该被抽象得远离语言。

**TL;DR**：因为月份有名称，而月份中的日期没有。

* * *

## 回答 #5

> 赞同：12
> 
> 时间：2008-12-05T19:25:22.960

在 Java 8 中，有一个更健全的新日期/时间 API [JSR 310 。](http://www.threeten.org/)规范负责人与 JodaTime 的主要作者相同，他们共享许多相似的概念和模式。

* * *

## 回答 #6

> 赞同：10
> 
> 时间：2008-12-05T16:25:13.273

我会说懒惰。数组从 0 开始（每个人都知道）；一年中的月份是一个数组，这让我相信 Sun 的一些工程师只是懒得在 Java 代码中加入这个小细节。

* * *

## 回答 #7

> 赞同：9
> 
> 时间：2008-12-05T16:37:16.090

可能是因为 C 的“struct tm”也是如此。

* * *

## 回答 #8

> 赞同：8
> 
> 时间：2008-12-05T16:26:02.523

因为程序员痴迷于从 0 开始的索引。好的，它比这更复杂一点：当您使用较低级别的逻辑来使用基于 0 的索引时，它更有意义。但总的来说，我仍然会坚持我的第一句话。

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2008-12-05T17:09:57.630

就个人而言，我认为 Java 日历 API 的陌生性表明我需要摆脱以公历为中心的思维方式，并尝试在这方面进行更加不可知论的编程。具体来说，我再次学会了避免像几个月这样的硬编码常量。

以下哪项更可能是正确的？

```
if (date.getMonth() == 3) out.print("March");

if (date.getMonth() == Calendar.MARCH) out.print("March"); 
```

这说明了 Joda Time 让我有点恼火的一件事——它可能会鼓励程序员从硬编码常量的角度来思考。（不过只有一点点。Joda 并没有*强迫*程序员编程不好。）

* * *

## 回答 #10

> 赞同：4
> 
> 时间：2012-04-29T14:26:18.783

对我来说，没有人能比[mindpro.com](http://mindprod.com/jgloss/calendar.html)更好地解释它：

> **陷阱**
> 
> `java.util.GregorianCalendar`与班级相比，错误和陷阱要少得多， `old java.util.Date`但仍然没有野餐。
> 
> 如果在第一次提出夏令时时有程序员，他们会否决它，认为它疯狂且难以处理。对于夏令时，存在根本的歧义。在秋天，当您将时钟拨回凌晨 2 点时，有两个不同的时间点，都称为当地时间凌晨 1:30。仅当您在读数中记录您是打算采用夏令时还是标准时间时，您才能将它们区分开来。
> 
> 不幸的是，无法判断`GregorianCalendar`您的意图。您必须诉诸于使用虚拟 UTC TimeZone 告诉它当地时间，以避免歧义。程序员通常对这个问题视而不见，只希望在这个小时内没有人做任何事情。
> 
> 千年虫。这些错误仍然没有超出日历类。即使在 JDK（Java 开发工具包）1.3 中也存在 2001 错误。考虑以下代码：
> 
> ```
> GregorianCalendar gc = new GregorianCalendar();
> gc.setLenient( false );
> /* Bug only manifests if lenient set false */
> gc.set( 2001, 1, 1, 1, 0, 0 );
> int year = gc.get ( Calendar.YEAR );
> /* throws exception */ 
> ```
> 
> 该错误在 2001 年 1 月 1 日上午 7 点消失，用于 MST。
> 
> `GregorianCalendar`由一大堆无类型的 int 魔法常数控制。这种技术完全破坏了编译时错误检查的任何希望。例如获取您使用的月份 `GregorianCalendar. get(Calendar.MONTH));`
> 
> `GregorianCalendar`有 raw `GregorianCalendar.get(Calendar.ZONE_OFFSET)`和夏时制 `GregorianCalendar. get( Calendar. DST_OFFSET)`，但无法获得正在使用的实际时区偏移量。您必须分别获取这两个并将它们加在一起。
> 
> `GregorianCalendar.set( year, month, day, hour, minute)`不将秒数设置为 0。
> 
> `DateFormat`并且`GregorianCalendar`没有正确啮合。您必须两次指定日历，一次间接指定为日期。
> 
> 如果用户没有正确配置他的时区，它将默认默认为 PST 或 GMT。
> 
> 在 GregorianCalendar 中，月份从一月 = 0 开始编号，而不是像地球上的其他人那样从 1 开始编号。然而，日子从 1 开始，星期天 = 1，星期一 = 2，……星期六 = 7。然而日期格式。parse 以传统方式运行，一月=1。

* * *

## 回答 #11

> 赞同：4
> 
> 时间：2016-06-28T03:41:34.770

# `java.time.Month`

Java 为您提供了另一种使用基于 1 的索引数月的方法。使用[`java.time.Month`](https://docs.oracle.com/javase/8/docs/api/java/time/Month.html)枚举。为十二个月中的每一个月预定义一个对象。他们在 1 月至 12 月分别为 1-12 分配了编号；拨打电话[`getValue`](https://docs.oracle.com/javase/8/docs/api/java/time/Month.html#getValue--)号码。

使用`Month.JULY`（给你 7）而不是`Calendar.JULY`（给你 6）。

```
(import java.time.*;) 
```

* * *

## 回答 #12

> 赞同：4
> 
> 时间：2021-03-17T22:20:44.770

## 真正的原因

> 您可能会认为，当我们弃用大部分 Date 并添加新的 Calendar 类时，我们会解决 Date 的最大烦恼：1 月是第 0 个月这一事实。我们当然应该这样做，但不幸的是我们没有。我们担心如果 Date 使用从零开始的月份而 Calendar 使用从 1 开始的月份，程序员会感到困惑。一些程序员可能会这样做。但事后看来，Calendar 仍然是从零开始的事实引起了极大的混乱，这可能是 Java 国际 API 中最大的单一错误。

引自Laura Werner*的 Java 国际日历*，链接在底部。

## 更好的选择：java.time

这可能只是重复其他人所说的话，抛弃旧的和设计不佳的`Calendar`类并使用现代 Java 日期和时间 API java.time。从 1 月的 1 到 12 月的 12 月份，月份的编号一直很合理。

如果您`Calendar`从尚未升级到 java.time 的遗留 API获取`ZonedDateTime`. 根据您的需要，您可以从那里进行进一步的转换。在世界上大多数地方，`Calendar`你得到的对象几乎总是子类的一个实例`GregorianCalendar`（因为`Calendar`类本身是抽象的）。演示：

```
 Calendar oldfashionedCalendarObject = Calendar.getInstance();
    ZonedDateTime zdt
            = ((GregorianCalendar) oldfashionedCalendarObject).toZonedDateTime();

    System.out.println(zdt);
    System.out.format("Month is %d or %s%n", zdt.getMonthValue(), zdt.getMonth()); 
```

我刚才在我的时区运行时的输出：

> ```
> 2021-03-17T23:18:47.761+01:00[Europe/Copenhagen]
> Month is 3 or MARCH 
> ```

## 链接

*   Laura Werner[的 Java 国际日历](https://icu-project.org/docs/papers/international_calendars_in_java.html)
*   [Oracle 教程：日期时间](https://docs.oracle.com/javase/tutorial/datetime/)解释如何使用 java.time。

* * *

## 回答 #13

> 赞同：3
> 
> 时间：2016-08-30T05:47:28.000

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2008-12-06T14:32:11.770

它本身并不完全定义为零，它被定义为 Calendar.January。这是使用整数而不是枚举作为常量的问题。日历.一月 == 0。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2018-01-09T02:16:30.980

因为语言写作比看起来更难，尤其是处理时间比大多数人想象的要困难得多。有关问题的一小部分（实际上，不是 Java），请参阅[https://www.youtube.com/watch?v=-5wpm-gesOY](https://www.youtube.com/watch?v=-5wpm-gesOY)上的 YouTube 视频“时间和时区问题 - Computerphile” 。如果你的头因混乱的大笑而掉下来，请不要感到惊讶。

* * *

## 回答 #16

> 赞同：-1
> 
> 时间：2008-12-05T16:27:01.070

除了 DannySmurf 对懒惰的回答之外，我还要补充一点，这是为了鼓励您使用常量，例如`Calendar.JANUARY`.

* * *

## 回答 #17

> 赞同：-2
> 
> 时间：2015-11-02T03:10:44.857

因为一切都是从 0 开始的。这是 Java 编程的一个基本事实。如果一件事偏离了这一点，那将导致整个混乱。让我们不要争论它们的形成和代码。

# visual-studio - 单元测试 CLI/MFC 应用程序

> ID：344390
> 
> 赞同：2
> 
> 时间：2008-12-05T16:26:03.710
> 
> 标签：visual-studio, visual-studio-2008, unit-testing, mfc, c++-cli

我有 CLI/MFC 应用程序，我想开始学习如何使用它进行单元测试。我有VS2008 Pro。如果可能的话，我想使用内置的单元测试。感谢您的输入！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-05T16:35:59.743

我在[CPPUnit](http://sourceforge.net/projects/cppunit)和[Google Test](http://code.google.com/p/googletest/)上都取得了成功。对于任何一种情况，您都必须做一些工作才能将测试结果重新集成到 Studio 中。您想要的结果的粒度直接影响工作量。您想要整个测试集的通过/失败，还是单个结果？前者是一个简单的 msbuild 任务，后者需要将结果集输出到 XML，通过转换对其进行按摩，然后将其拉回。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-26T21:34:40.090

我们使用 Gallio 和 MbUnit 来测试我们的 MFC 和 C++/CLI 应用程序。只需在 C++/CLI 中编写测试，然后您就可以在单个框架中测试托管和非托管代码。我们还使用 NMock2 来模拟托管代码。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-27T19:32:03.167

如果您有 Team Test 版本，则可以使用它来测试 C++/CLI 应用程序和库。见[这里](http://msdn.microsoft.com/en-us/library/ms243171.aspx)。

# svn - 如何使用颠覆服务器删除和创建新的存储库？

> ID：344406
> 
> 赞同：3
> 
> 时间：2008-12-05T16:30:57.757
> 
> 标签：svn, administration

好的，所以我只是做了一些愚蠢的事情。

我第一次设置了一个将由承包商使用的颠覆服务器。我进行了 1 单击设置，创建了我的项目，并首次签入了我们的应用程序，我认为稍后我将完成并删除配置文件中连接字符串中的密码信息。

呃...

所以现在我需要在存储库中删除该项目并再次创建它，这样我这次可以在没有密码的情况下进行签入。查看 svnadmin help 的选项，我没有看到任何删除存储库的选项。

我该怎么做呢？简单点在这里！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-12-05T16:35:05.250

您可以删除该文件并清除其所有历史记录，然后将其重新导入干净。

从 SVN 常见问题中检查这一点：

[如何从存储库的历史记录中完全删除文件？](http://subversion.tigris.org/faq.html#removal)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-12-05T16:33:20.810

要删除项目存储库，只需从服务器中删除该文件夹，然后再次执行 svnadmin create。

威尔是对的，我没有正确阅读密码句子。签出和删除无助于安全问题。如有疑问，请[按照本书](http://svnbook.red-bean.com/)或查看 CMS 的链接。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2008-12-05T16:37:17.620

只是从当前版本中删除文件并进行提交无助于解决安全问题。密码仍将存在于已删除文件的存储库的旧版本中。CMS 的 FAQ 链接也应该有所帮助。

# php - 如何在 PHP 中设置绝对包含路径？

> ID：344419
> 
> 赞同：42
> 
> 时间：2008-12-05T16:34:24.020
> 
> 标签：php

在 HTML 中，我可以通过以“/”开头的文件路径找到从**Web 服务器的根文件夹开始的文件。**像：

```
/images/some_image.jpg 
```

我可以将该路径放在任何子目录中的任何文件中，它将指向正确的图像。

使用 PHP，我尝试了类似的方法：

```
include("/includes/header.php"); 
```

...但这不起作用。

我认为[这个页面](http://us2.php.net/manual/en/ini.core.php#ini.include-path)是说我可以设置`include_path`一次，然后假设。但我不太明白语法。这两个例子都以句号开头，它说：

> 用一个 。在包含路径中允许相对包含，因为它表示当前目录。

相对包含正是我**不**想要的。

**如何确保我的所有包含都指向该`root/includes`文件夹？**（奖励：如果我想将该文件夹放在公共目录之外怎么办？）

## 澄清

我的开发文件目前由 XAMPP/Apache 提供服务。这会影响绝对路径吗？（我还不确定生产服务器会是什么。）

## 更新

我不知道我的问题在这里。我上面引用的`include_path`东西正是我要找的东西，而且语法并不令人困惑。我刚试了一下，效果很好。

我想到的一件事是，有些人可能认为“/some/path”是“绝对路径”，因为他们认为操作系统是 Linux。此服务器是 Windows，因此绝对路径必须以驱动器名称开头。

总之，问题解决了！:)

* * *

## 回答 #1

> 赞同：49
> 
> 时间：2008-12-05T16:42:07.173

我所做的是将 config.php 文件放在我的根目录中。这个文件包含在我项目中的所有 PHP 文件中。在那个 config.php 文件中，我然后执行以下操作；

```
define( 'ROOT_DIR', dirname(__FILE__) ); 
```

然后在所有文件中，我知道我的项目的根是什么并且可以做这样的事情

```
require_once( ROOT_DIR.'/include/functions.php' ); 
```

抱歉，离开公共目录没有奖励积分；）这也有一个不幸的副作用，即您仍然需要一个相对路径来查找 config.php，但它使您的其余包含更容易。

* * *

## 回答 #2

> 赞同：27
> 
> 时间：2008-12-05T17:47:06.260

## 一种策略

我不知道这是否是最好的方法，但它对我有用。

```
$root = $_SERVER['DOCUMENT_ROOT'];
include($root."/path/to/file.php"); 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2008-12-05T16:48:13.383

include_path 设置与 unix 中的 $PATH 类似（Windows 中也有类似设置）。它包含多个目录名称，以冒号 (:) 分隔。当您包含或需要文件时，将按顺序搜索这些目录，直到找到匹配项或搜索所有目录。

因此，为了确保您的应用程序始终包含您的路径（如果文件存在），只需将您的包含目录放在目录列表中的第一位。

```
ini_set("include_path", "/your_include_path:".ini_get("include_path")); 
```

这样，首先搜索您的包含目录，然后搜索原始搜索路径（默认为当前目录，然后是 PEAR）。如果您修改 include_path 没有问题，那么这就是您的解决方案。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2008-12-05T16:50:46.220

[include](http://www.php.net/manual/en/function.include.php) / [require](http://www.php.net/manual/en/function.require.php)中没有任何内容禁止您使用绝对路径。所以你的例子

```
include('/includes/header.php'); 
```

应该可以正常工作。假设路径和文件是正确的并且具有正确的权限集。
（从而允许您在文档根目录内外包含您喜欢的任何文件）

然而，这种行为被认为是一种可能的安全风险。因此，系统管理员可以设置[open_basedir](http://www.php.net/features.safe-mode)指令。

该指令配置您可以从哪里包含/要求您的文件，这可能只是您的问题。
一些控制面板（例如plesk）默认将此指令设置为与文档根目录相同。

至于`'.'`语法：

```
/home/username/public_html <- 绝对路径  
public_html <- 相对路径  
./public_html <- 与上面的路径相同  
../username/public_html <- 另一个相对路径  

```

但是，我通常使用稍微不同的选项：

```
require_once(__DIR__ . '/Factories/ViewFactory.php'); 
```

在此版本中，您可以指定相对于包含`require_once()`语句的文件的绝对路径。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2013-08-20T20:47:30.447

另一种选择是在`$_SERVER['DOCUMENT_ROOT']`目录中创建一个包含绝对路径定义的文件。

例如，如果您的`$_SERVER['DOCUMENT_ROOT']`目录是

```
C:\wamp\www\ 
```

创建一个`my_paths.php`包含这个的文件（即）

```
<?php if(!defined('MY_ABS_PATH')) define('MY_ABS_PATH',$_SERVER['DOCUMENT_ROOT'].'MyProyect/') 
```

现在您只需要在 MyProyect 文件夹中的每个文件中包含此文件 ( `my_paths.php`)，因此您可以将用户`MY_ABS_PATH`作为 MyProject 的绝对路径。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-05T16:49:52.600

不直接回答您的问题，但要记住一些事情：

> 在您的ini中使用包含allow_url_include时请注意，当从包含的文件访问会话时，如果从脚本中使用绝对文件引用包含一个文件，然后使用他们的url文件引用从本地服务器上包含第二个文件具有不同的变量范围，并且不会从两个包含的文件中看到相同的会话。从 url 包含的文件中不会看到原始会话。

来自：[http ://us2.php.net/manual/en/function.include.php#84052](http://us2.php.net/manual/en/function.include.php#84052)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-12-05T17:27:15.460

大家好...我的 cms 系统也有类似的问题。对于某些安全方面，我需要一条艰难的道路。认为最好的方法就像 rob 写的。为了快速进行肮脏的编码，认为这也有效..:-)

```
<?php
$path   = getcwd(); 
$myfile = "/test.inc.php";

/* 
```

getcwd() 指向：/usr/srv/apache/htdocs/myworkingdir（例如）

```
echo ($path.$myfile);
would return...

/usr/srv/apache/htdocs/myworkingdir/test.inc.php

access outside your working directory is not allowed.
*/

includ_once ($path.$myfile);

//some code

?> 
```

美好的一天

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-07-25T15:51:11.727

我在这一个上遵循 Wordpress 的例子。我去定义一个根路径，通常是文档根，然后定义一堆其他路径（我的每个类目录都有一个。IE：数据库，用户，html等）。通常我会手动定义根路径，而不是依赖服务器变量。

**例子**

```
if($_SERVER['SERVERNAME'] == "localhost")
{
    定义（“ABS_PATH”，“/path/to/upper/most/directory”）；// 手动的
}
别的
{
    定义（“ABS_PATH，目录名（__FILE__））；
    // 这将路径定义为包含文件的目录，通常是 config.php
}

// 定义其他路径...

包括（ABS_PATH。“/mystuff.php”）；

```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2010-04-29T12:48:39.420

谢谢 - 如果您在谷歌搜索 php apache windows 绝对路径，这是 2 个链接之一。

作为中间 PHP 开发人员的新手，我不明白为什么 apache windows 系统上的绝对路径是 c:\xampp\htdocs （apache 文档根目录 - XAMPP 默认）而不是 /

因此，如果在 http//localhost/myapp/subfolder1/subfolder2/myfile.php 我想包含来自 http//localhost/myapp 的文件

我需要将其指定为： include("c:\xampp\htdocs\myapp\includeme.php") 或 include("../../includeme.php")

并且不包括（“/myapp/includeme.php”）

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2012-08-07T22:48:21.667

我想出了一行代码来设置我的每个 php 脚本的顶部，以补偿：

```
<?php if(!$root) for($i=count(explode("/",$_SERVER["PHP_SELF"]));$i>2;$i--) $root .= "../"; ?> 
```

通过这种将 $root 构建为 bee "../" 的方式，从放置文件的任何位置开始逐步提升层次结构。每当我想包含绝对路径时，该行将是：

```
<?php include($root."some/include/directory/file.php"); ?> 
```

我真的不喜欢它，似乎是一种尴尬的解决方法，但它似乎可以在任何系统 php 上运行以及文件放置在哪里，使其独立于系统。要访问 web 目录之外的文件，请在`../`之后添加更多内容`$root`，例如`$root."../external/file.txt"`.

# project-management - 有没有可以处理估算范围的项目规划工具？

> ID：344421
> 
> 赞同：0
> 
> 时间：2008-12-05T16:35:06.937
> 
> 标签：project-management, estimation

有人建议，在进行估算时，应该对预期交货时间进行上下限。我见过的少数项目工具似乎需要一个固定的日期。是否有任何工具支持这种估计范围的概念？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-05T17:17:26.070

Joel在他们的 FogBugz 6.0 软件中吹捧[基于证据的调度。](http://www.joelonsoftware.com/items/2007/10/26.html)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-05T18:02:49.537

还有一种经典方法，即为每个项目提供最佳、最差和预期的情况估计，然后计算结果

```
computed_result = (b + 4e + w)/6 
```

你可以用它来证明你是如何得出你的估计的。

但是，如果您提供时间范围；所有客户/赞助商/利益相关者将看到的是最低价值。不管你说什么。所以对范围保密，并公布计算结果。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-05T17:22:55.217

我使用[了 Merlin2](http://www.projectwizards.net/en/products/merlin)，它是 Mac 的项目管理产品。当您开始一个新项目时，它会询问您开始日期和结束日期 - 这看起来是固定的，但是当您查看项目计划检查器时，您会发现实际上有一个“最早日期”和“最晚日期”开始和可以编辑的结束日期。默认情况下，它将开始日期添加到“最早开始日期”，将结束日期添加到“最新结束日期” - 您可以根据需要进行调整。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-08T11:44:33.027

“有些人建议，在进行估算时，应该对预期交货时间做出上下限。”

但是您的项目利益相关者想要什么？范围会帮助他们决定为您的项目提供资金吗？

范围并不是真的很重要。此外，大多数人忽略了范围，要么看到低数字，要么看到高数字。乐观主义者有“快乐的眼睛”，看到低数字，当你没有达到它时抱怨，即使你低于高数字。悲观者看到高数字，说它太大，并要求您重新计划项目以使数字更小。

范围如何 - 确切地说 - 将如何帮助您？谁需要范围？该范围将帮助他们获得哪些信息？他们必须做出哪些需要范围的决定？

我建议你现实地计划每一件。

此外，优先考虑您的项目。在确定优先级之后，您会看到有一些必不可少的东西，一些重要但非必要的东西，以及一些可选的东西。这是你的范围。做重要事情的成本很低。做重要但非必要的成本在中间。做可选的东西的成本很高。

当有人要求你“重新计划”时，你会修剪可选的东西。

这不是一个简单的范围。这是对您将完成的工作及其价值的现实看法。

# javascript - javascript函数中返回对象的范围

> ID：344428
> 
> 赞同：3
> 
> 时间：2008-12-05T16:36:10.820
> 
> 标签：javascript

我如何访问下面的“a”？

```
var test = function () {
     return {
        'a' : 1,
        'b' : this.a + 1  //doesn't work
    };
}; 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-12-05T16:44:25.310

你不能这样做。当您在构造一个对象的过程中（这就是您使用花括号实际执行的操作）时，在构造它之前无法访问它的属性。

```
var test = function () {
  var o = {};
  o['a'] = 1;
  o['b'] = o['a'] + 1;
  return o;
}; 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-12-05T16:51:56.857

```
var t = function () 
        {
            return new x();
        };

var x = function ()
        {
            this.a = 1;
            this.b = this.a + 1; //works
        } 
```

抽象层

*为格式化而编辑，并注意到这是从 OLN 转移的*

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-05T16:46:27.850

You can't Object Literal Notion 不支持此访问

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-05T16:59:07.340

```
var test = function () {
    //private members
    var a = 1;
    var b = a + 1;
    //public interface
    return {
        geta : function () {
            return a;
        },
        getb : function () {
            return b;
        }
    }
}(); 
```

# asp.net - Response.Flush 不工作 ASP.NET

> ID：344430
> 
> 赞同：3
> 
> 时间：2008-12-05T16:36:59.740
> 
> 标签：asp.net

我有一个 aspx 页面，我正在处理表中的大量记录并进行一些操作。在每次操作之后，（每条记录），我有一个 Response.Write("Record : "+rec); Response.Flush()

我已将 Response.Buffer 属性设置为 false。它工作正常但是如果我想将输出呈现为表格行，它在 Response.Write 仅在完成循环中的所有记录后不起作用，表格正在打印

如何解决这个问题？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2010-04-20T17:38:48.900

对于其他遇到此问题的人...

请注意，如果您的 IIS 服务器正在使用 GZIP 压缩输出，那么它似乎会忽略所有`Response.Flush`调用。这在 IIS7 和 Windows 7 中默认打开。

而且，如果您使用 Fiddler 进行测试，请务必打开“Streaming”模式，否则 Fiddler 将收集刷新的 HTML 并将其保存到连接完成。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-12-05T16:41:46.313

大多数浏览器在表格完成之前不会呈现表格。您可以尝试将表格设置为固定格式，c​​ss table-layout: fixed，以及指定列大小。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-05T16:43:23.427

我将在 Darryl 的回答中添加您可以尽快关闭表格，然后使用 JQuery 或类似方法填充表格的其余部分。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-05T16:46:01.097

我猜在您写出结束表标记之前，从浏览器的角度来看，该表并不存在。

你可以用一个样式表来写出一堆 div 来控制它们的宽度。

```
.column1 { width: 40px; }
.column2 { width: 40px; }

Response.Write("<div id=\"column1\">some text</div><div id=\"column2\">some text</div>");
Response.Flush(); 
```

或者你可以为每一行写出一个完整的表格......？

```
Response.Write("<table><tr><td>some text</td></tr></table>");
Response.Flush(); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-05T16:48:25.223

肯定是表。为了向自己证明这一点，请将面向表标记的 response.Write()s 更改为纯文本。你会看到它积累。如果表格必须这么大并且您想从服务器呈现它，您应该修复列大小并将表格分解为每行一个或其他一些子集，以便内容按照您的需要逐渐显示。

# performance - 最好在 VBScript 中访问 Windows (XP) 性能计数器

> ID：344437
> 
> 赞同：1
> 
> 时间：2008-12-05T16:39:46.677
> 
> 标签：performance, vbscript, memory-leaks, system-monitoring

我正在使用 Quick Test Professional (QTP) 9.5 和 Internet Explorer 6 测试浏览器内存泄漏的 Web 应用程序。PerfMon 用于监控一段时间内的内存使用情况，但它的数据必须与测试结果同步以找出哪些步骤触发浏览器内存泄漏。由于 QTP 的脚本语言是 VBScript，我怎样才能获得特定的性能计数器（在这种情况下，进程“IExplore.exe”中的“Private Bytes”）？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-05T17:20:33.287

[不要惊慌：您可以使用脚本来监控性能](http://www.microsoft.com/technet/scriptcenter/topics/win2003/perfmon.mspx)。对上一行感到抱歉。这是文章的名称。

# c# - 如何获取哪个页面向aspx中的Application_error抛出异常

> ID：344440
> 
> 赞同：18
> 
> 时间：2008-12-05T16:40:24.710
> 
> 标签：c#, asp.net, exception, application-error

我的 global.asax 中有一个通用异常处理程序 Application_error，我试图在我的所有页面上隔离所有未捕获的异常。我不想使用 Page_error 来捕获异常，因为在这么多页面上调用它是低效的。那么在异常中哪里可以找到实际导致异常的页面呢？

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2008-12-05T16:47:53.773

```
HttpContext con = HttpContext.Current;
con.Request.Url.ToString() 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-07T13:24:52.373

请记住，页面并不（不应该）始终是异常的原因。它可能很容易来自另一个程序集 - 如果您的代码隐藏中没有您的逻辑，它可能来自另一个程序集。不要误会，很高兴知道是哪个页面，从说 X Page 在 Z 汇编中导致 Y 异常的方面。

# python - Windows 通知库

> ID：344442
> 
> 赞同：5
> 
> 时间：2008-12-05T16:41:40.963
> 
> 标签：python, windows, notifications

我正在为 Windows 开发一个小托盘图标应用程序，我需要显示非侵入性的视觉通知，类似于您在 MSN Messenger 或任何其他 IM 应用程序中收到新消息时出现的通知。

我看过[Snarl](http://www.fullphat.net/index.php)，但它似乎是我需要安装的一个单独的应用程序。我想要一些可以与我的应用程序捆绑在一个安装程序中的东西，一个库。

你推荐哪一个？

Python 支持是一个巨大的优势。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-08T15:20:50.377

您可以通过依赖于 GUI 库来做到这一点。

例如，使用 PyQt，可以：

*   [PyQt QSystemTrayIcon 文档](http://pyqt.sourceforge.net/Docs/PyQt4/qsystemtrayicon.html)

*   [QSystemTrayIcon 类参考](http://qt-project.org/doc/qt-4.8/qsystemtrayicon.html)

*   [QSystemTrayIcon 示例](http://qt-project.org/doc/qt-4.8/desktop-systray.html)（C++，易于适配python）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-05T17:28:54.580

[不久前，我为 Genghis 项目（此处链接](http://www.codeplex.com/genghis)）编写了一个 .NET 。看起来它现在已经在 MS CodePlex 结束了。寻找“AniForm”类。 [这](http://www.sellsbrothers.com/tools/genghis/screenshots/AniForm.JPG)是一个屏幕截图。

它具有更多旧版 MSN Messenger 的外观和感觉，但应该可以帮助您入门。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-05T17:53:10.990

您是否正在使用 Python 开发应用程序？这取决于您使用的 GUI 工具包。

如果您使用的是 wxPython，您可以尝试[ToasterBox](http://xoomer.alice.it/infinity77/main/ToasterBox.html)或 wxPopupWindow。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-05T17:35:51.073

你不需要任何东西。只需使用带有 Win32 api 的烤面包机窗口

# nhibernate - 为什么实体框架不支持 ODBC？

> ID：344449
> 
> 赞同：17
> 
> 时间：2008-12-05T16:43:44.750
> 
> 标签：nhibernate, entity-framework, ado.net

EF 是否有特定原因需要新的数据提供程序并且不能使用 ODBC？我认为它必须是一些特定于 ORM 的问题，但 NHibernate 通过 ODBC 可以正常工作。

我正在使用 NHibernate 并且可以继续使用 Nhibernate，但我担心我不能为这里的任何未来程序员假设 Nhibernate 知识。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2008-12-09T16:47:03.290

确切地说，实体框架不需要新的数据提供者。相反，它需要扩展现有数据提供程序的实体框架提供程序，以提供实体框架所需的附加服务，例如复杂的 SQL 生成，这些服务不是现有 ADO.NET 数据模型的一部分。我认为没有什么可以阻止任何人基于现有的 ADO.NET 2.0 ODBC 桥为 ODBC 编写实体框架提供程序。您可以下载[示例 SQL Server 提供程序的源代码，](http://code.msdn.microsoft.com/EFSampleProvider)以详细了解在为实体框架扩展现有 ADO.NET 提供程序时需要哪些服务。

# javascript - 提交前修改表单数据

> ID：344451
> 
> 赞同：4
> 
> 时间：2008-12-05T16:44:12.067
> 
> 标签：javascript, jquery, jquery-forms-plugin

我将 jQuery 与[表单插件](http://malsup.com/jquery/form/)结合使用，我想在提交之前拦截表单数据并进行更改。

表单插件有一个名为 beforeSubmit 的属性，它应该执行此操作，但我似乎无法让我指定的函数运行。

这是表单的标记（省略了一些样式细节）：

```
<form id="form1">
    <fieldset id="login">
        <legend>Please Log In</legend>
        <label for="txtLogin">Login</label>
        <input id="txtLogin" type="text" />
        <label for="txtPassword">Password</label>
        <input id="txtPassword" type="password" />
        <button type="submit" id="btnLogin">Log In</button>
    </fieldset>
</form> 
```

这是我到目前为止的javascript：

```
$(document).ready(function() {
    var options = {
        method: 'post',
        url: 'Login.aspx',
        beforeSubmit: function(formData, form, options) {
            $.each(formData, function() { log.info(this.value); });
            return true;
        }
    };
    $('form#form1').ajaxForm(options);
}); 
```

（log.info() 来自我正在使用的[Blackbird调试器库）](http://www.gscottolson.com/blackbirdjs/)

当我单击提交按钮时，而不是我指定的 POST 动词，它使用 GET 代替，并且我的 beforeSubmit 函数没有记录任何内容。似乎 ajaxForm 插件根本没有应用于表单，但我不明白为什么。有人可以帮忙吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-05T19:51:01.317

我通过 firebug 运行了以下代码，它似乎像宣传的那样工作，但是 beforeSubmit 回调中的 formData 变量为空，因为您没有在文本框上设置 name 属性。

```
<script type="text/javascript">
  $(document).ready(function() {
    var options = {
      beforeSubmit: showData
    };
    $('form#form1').ajaxForm(options);
  });
  function showData(formData, form, options) {
    //var formData = [ { name: 'username', value: 'jresig' }, { name: 'password', value: 'secret' } ];
    $.each(formData, function(i, obj) { log.info(obj.name + " | " + obj.value); });
    return true;
  }
</script>

<form id="form1" action="Login.aspx" method="post">
<fieldset id="login">
    <legend>Please Log In</legend>
    <label for="txtLogin">Login</label>
    <input id="txtLogin" type="text" name="User" />
    <label for="txtPassword">Password</label>
    <input id="txtPassword" type="password" name="Pass" />
    <button type="submit" id="btnLogin">Log In</button>
</fieldset>
</form> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-05T19:58:30.520

对于初学者，根据[这个 API](http://malsup.com/jquery/form/#options-object)，你的 options 对象应该使用`type`and not `method`，或者只是在 HTML 的表单中指定方法属性。

（现在我将添加一些小的文体注释；如果您愿意，可以在此处停止阅读）：

1.  您可以替换`$(document).ready(function...`为`$(function...`.
2.  `$.each(formData, function...`看起来更自然`$(formData).each(function...`

# regex - 为什么我的替换中 1 美元是空的？

> ID：344460
> 
> 赞同：3
> 
> 时间：2008-12-05T16:46:33.123
> 
> 标签：regex, perl, substitution

我试图将括号内的内容放入 img 标记中 src 属性的值中：

```
while(<TOCFILE>)
{
    $toc_line = $_;
    $toc_line =~ s/<inlineFig.*?(\.\.\/pics\/ch09_inline99_*?\.jpg)*?<\/inlineFig>/<img src="${1}" alt="" \/\>/g;
    $new_toc_file .= $toc_line;
} 
```

所以我希望在输出中看到这样的标签：

```
<img src="../pics/ch09_inline99_00" alt="" /> 
```

但相反，我得到：

```
<img src="" alt="" /> 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-12-05T17:19:31.950

您的正则表达式中有一个错误，因此该短语永远不会匹配任何内容：

```
inline99_*?\.jpg
        ^^^ 
```

`\d`从您尝试匹配的示例数据来看，我认为您忘记了在明星面前。

您甚至没有要求它匹配，因为您`*?`在捕获的组之后放置了一个。所以，它只是不匹配任何东西。所以这就是你得到的：什么都没有。

除了：

```
($PATTERN)*? 
```

只会捕获它匹配的最后一个东西。那可能也不是你想要的。例如：

```
$_ = 'one two three';
s/(\w+\s*)*/$1/;
print; 
```

打印“三”。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-05T17:53:16.107

1）可以使用一些你正在解析的例子。

2）如果在表达式末尾使用“x”，可以在正则表达式中添加空格和注释，使其更易于理解

3）此外，通过分解它，您会注意到 ( ) 内的第二部分内容缺少数字匹配...而不是寻找 0 或多个“_”，并在看到数字时中断，因此不匹配。

```
while(<TOCFILE>)
{
    $toc_line = $_;
    $toc_line =~ 
      s/                  # replace the follwoing     

         <inlineFig                     # match this text             
         .*?                            # then any characters until the next sequence matches
         (                              # throw the match into $1
            \.\.\/pics\/ch09_inline99_  # ..\pics\cho9_inline99_
            \d*?\.jpg                   # folowed by 0 or more numbers
         )*?                            # keeping doing that until the next sequence matches
         <\/inlineFig>                  # match this text

       /                  # with the follwoing

         <img src="${1}" alt="" \/\>    # some text and the result of $1 above.

       /xg;  # <- the x makes it ignore whitespace and #comments
    $new_toc_file .= $toc_line;
} 
```

4）如前所述，（）*？只将最后一个匹配返回到 $1，但如果您的输入只是某种格式，这应该不是问题。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-05T18:04:41.250

按照 bart 的建议，修复您的模式，并考虑使用“主题”变量 $_ 而不是将从文件句柄读取的数据显式分配给另一个变量。

```
#!/usr/bin/perl

use warnings;
use strict;

my $new_toc_file;

{
    # localizing $_ protects any existing value in the global $_
    # you should localize $_ even if you choose to assign it to a variable

    local $_;

    while(<DATA>) { 
        # in the absence of the bind operator =~, s/// operates against $_
        s!<inlineFig.*?(\.\./pics/ch09_inline99_.*?\.jpg)</inlineFig>!<img src="$1" alt="" />!g;
        $new_toc_file .= $_;
    }
}

print $new_toc_file, "\n";

__END__
<inlineFig>../pics/ch09_inline99_00.jpg</inlineFig> 
```

# windows - 作为开发人员，您对普通 Windows 安装做了哪些更改？

> ID：344468
> 
> 赞同：80
> 
> 时间：2008-12-05T16:49:22.400
> 
> 标签：windows, configuration

当我得到一个普通的 Windows 系统时，我会更改很多东西以使其对开发人员更友好。

其中一些我每次都记得，其他一些我只在何时做。

例子：

*   显示所有文件类型的扩展名
*   使隐藏和系统文件可见
*   关闭 Windows Defender

我似乎记得 Jeff 关于这个主题的博客文章，但找不到它！

你还做什么，你有什么工具可以自动化这个过程吗？

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2008-12-05T16:58:27.247

事实上，我做了上述，加上停用 Zip 支持（`regsvr32 /u zipfldr.dll`），激活 Alt 快捷方式上的下划线（高级外观），在所有程序设置中用 Andale Mono 替换 Courier New（替换为你最喜欢的字体）（当然是在安装之后），安装我最喜欢的实用程序（UnxUtils、Sysinternals'、SciTE、FileMenu 工具，这里有命令行和许多其他好东西等）等等。
哦，实际上还停用了双键盘支持（法语/英语），停用任务分组，安装 VirtuaWin（4 个桌面），CLCL（剪贴板管理器），AutoHotkey 和我最喜欢的宏，以及许多其他免费软件，或多或少必须有。

没有自动化，唉。

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2008-12-05T17:00:15.233

我安装[Cygwin](http://www.cygwin.com/)以获得 *nix 命令行工具和[Xemacs](http://www.xemacs.org/)以获得有用的编辑器。

* * *

## 回答 #3

> 赞同：17
> 
> 时间：2008-12-05T18:10:23.157

我安装：

*   通常的嫌疑人：Visual Studio、Sql Management Studio、Firefox、Chrome 等...
*   [油漆网](http://paint.net/)
*   [记事本++](http://notepad-plus.sourceforge.net/uk/site.htm)
*   [发射](http://www.launchy.net/)

* * *

## 回答 #4

> 赞同：16
> 
> 时间：2008-12-06T10:13:09.250

我做的第一件事是打开命令提示符，然后打开它的属性：

*   打开快速编辑。为什么默认关闭？
*   增加窗口大小。为什么要限制在邮票大小？
*   将垂直缓冲区增加到可能的最大值。为什么限制在几百行？
*   将前景色改为白色而不是灰色。为什么让它的可读性低于它的可读性？

总结：**为什么？**

* * *

## 回答 #5

> 赞同：12
> 
> 时间：2008-12-06T07:02:56.687

我擦拭它并安装Linux。每个人总是对我的生产力感到惊讶。这是因为我没有花一半的时间与机器战斗。

* * *

## 回答 #6

> 赞同：12
> 
> 时间：2008-12-05T16:54:40.237

使用控制面板中的添加\删除 Windows 组件，我总是删除...

*   游戏
*   文档模板
*   MSN 资源管理器
*   展望快递

对于外观和感觉，我...

*   恢复到经典开始菜单；但是，如果是 Vista，我会保持原样，因为我喜欢索引搜索功能。
*   恢复到带有大图标的经典桌面，并确保我的电脑是第一个图标（而不是我的文档）
*   我也执行你上面提到的事情

在安装任何软件之前，我...

*   安装任何未完成的 Windows 更新
*   运行磁盘清理
*   运行磁盘碎片整理
*   为清理、碎片整理和其他个人工具设置计划任务

对于工具（在我的 IDE 和其他必要的开发工具之外），我安装了..

*   调整用户界面
*   IE6、IE7、Safari、Chrome、Opera 和 Firefox
*   安装我一直用于开发的 Firefox 插件集
*   '在此处打开命令提示符' shell 扩展
*   安装 Consolas 并将其设置为我的编辑器（IDE、Notepad++ 等）的默认字体

* * *

## 回答 #7

> 赞同：11
> 
> 时间：2008-12-05T17:11:31.823

*   安装 Consolas 字体并打开（和调整）ClearType。
*   安装[ZoomIt](http://technet.microsoft.com/en-us/sysinternals/bb897434.aspx)以在演示期间放大显示。
*   安装 FireFox/Firebug
*   安装[XYplorer](http://www.xyplorer.com) Win Explorer 替代品（没有它就活不下去！）
*   安装[DeskPins](http://users.forthnet.gr/pat/efotinis/programs/deskpins.html)可以让任何 Window 暂时置顶。
*   确保 OneNote 随 Office 一起安装。
*   安装 Visio。
*   安装最喜欢的编辑器（无论当时是什么，目前是 SCiTE）。
*   安装 7Zip。
*   修复 Windows 颜色以适合我并将 RatPack（Dean 的我的英雄）的图片作为壁纸。

* * *

## 回答 #8

> 赞同：10
> 
> 时间：2008-12-05T18:47:02.070

禁用 FilterKeys、StickyKeys 和 ToggleKeys 的快捷方式 - 没有什么比不得不处理那个肮脏的功能更让我沮丧的了，因为我在思考时按下 shift 键几次或在之前按住它八秒钟（再次，同时思考）我开始打字！

将文件夹的默认操作更改为探索而不是打开。

* * *

## 回答 #9

> 赞同：8
> 
> 时间：2008-12-11T20:38:44.587

多年来，由于工作场所的变化和计算机的变化（无论是在家里还是在工作中），我已经决定尽可能少地进行定制。

我曾经用 litestep 进行各种疯狂的调整，设置分区等。这些天我将其简化为基础知识，并且设置机器并拥有熟悉的环境并不需要很长时间。

除了通常的“win32dev”设置（经典方案，针对性能进行了优化，没有特殊效果，显示所有文件，资源管理器视图中的详细信息，蓝色背景等），我还有以下堆栈：

*   cygwin（gcc、vim、curl、wget、perl/ruby/python、svn、git、ssh、netcat 等；rxvt 用于终端）
*   ffox + adblock + 开发插件
*   clipx 用于带有预览的简单堆栈式剪贴板
*   文本板 + 一些基本的语法荧光笔
*   virtuawin - 唯一可以满足我所有需要的最小窗口管理器，仅此而已
*   用于基本应用快捷方式的 autoHotKey
*   procexp 替换任务管理器
*   所有其他 sysinternals 工具
*   乌龟svn
*   腻子 + 代理 + 钥匙
*   7zip
*   守望先锋
*   线鲨

我手动安装的所有内容都进入 c:\programs （为了方便无空格，小写路径）。

* * *

## 回答 #10

> 赞同：7
> 
> 时间：2008-12-05T18:42:09.490

### 命令行脚本

为了存储我从命令行使用的脚本，我`Command Line Scripts`在 Program Files 下创建了一个目录并将其添加到 PATH 环境变量中。我使用以下批处理文件来列出和编辑这些脚本：

```
@echo off
setlocal

set UTILPATH=C:\Program Files\System Tools\Command Line Utilities

if not "x%1"=="x" (

start "" "notepad" "%UTILPATH%\%1.bat"

) else (

dir /b "%UTILPATH%" | grep -v com.bat | grep -P "(exe|bat|cmd)" | sed "s/\.\(exe\|bat\|cmd\)//"
echo.

) 
```

（请注意，目录列表的过滤取决于我通过[Cygwin](http://www.cygwin.com/)安装的一些 unix 命令）

我给它命名为 com.bat，（命令的缩写）然后我可以：

*   `com`通过在命令提示符处键入来列出该目录中的脚本
*   `com script-name`通过在命令提示符* 处键入来编辑列表中的任何脚本，类似地：
*   `com new-script-name`通过在命令提示符处键入在该目录中创建新脚本*
*   如果我需要编辑 com.bat 我只需输入`com com`

*** 当我运行 Vista 时，我必须使用提升的命令提示符，因为下面的目录受到`Program Files`保护。要快速启动提升的命令提示符，只需按`Win key`; 类型`cmd`；按`Ctrl+Shift+Enter`；然后点击`Alt+C`确认海拔提示。六次击键提升命令提示符！（[通过][4]）**

 **### 启动脚本

我存储在我的`Command Line Scripts`目录中的脚本之一是在我登录到 Windows 时运行的脚本（通过,在 Vista 开始菜单中`Task Scheduler`键入）。`Task`我使用该脚本设置多个**虚拟驱动器**，使用[subst](http://en.wikipedia.org/wiki/Subst)命令到我经常访问的目录，或者想要在命令提示符下快速访问或**缩短**编译器警告、日志或调试输出中的路径名。

我的启动脚本看起来像这样：

```
@setlocal
@set _MYDOCS_=%USERPROFILE%\Documents

@REM Note: first delete the drives so I can run script again
@REM       to fix drives that failed to get mapped

subst /d W:
subst /d T:
subst /d S:
subst /d R:
subst /d N:
subst /d L:
subst /d H:
subst W: "%_MYDOCS_%\Work\SVN Working Copy\Website\trunk\www"
subst T: "%_MYDOCS_%\Work\SVN Working Copy\project 1\trunk"
subst S: "%_MYDOCS_%\Work\SVN Working Copy"
subst R: "%_MYDOCS_%\Work\SVN Working Copy\project 2\branches\12.50"
subst N: "%_MYDOCS_%\Work\SVN Working Copy\project 2\trunk"
subst L: "%_MYDOCS_%\Work\"
subst H: "%_MYDOCS_%\My Projects\Haslers.info\Working Copy" 
```

请注意，subst 可能有点喜怒无常，有时驱动器不会被创建，我必须再次手动运行启动脚本。

* * *

## 回答 #11

> 赞同：7
> 
> 时间：2008-12-05T18:49:42.500

关于：

> *   显示所有文件类型的扩展名
> *   使隐藏和系统文件可见

我不喜欢让隐藏文件一直可见（它使两个 desktop.ini 在我的 Windows Vista 桌面上对初学者可见），所以我使用资源管理器扩展来轻松打开和关闭它。文件扩展名也有一个对应的：

*   [HiddenFilesToggle 上下文菜单外壳扩展](http://students.kennesaw.edu/~rzillige/shell/HiddenFilesToggle.html)
*   [FileExtensionToggle 上下文菜单外壳扩展](http://students.kennesaw.edu/~rzillige/shell/FileExtensionToggle.html)

* * *

## 回答 #12

> 赞同：7
> 
> 时间：2009-04-16T09:02:57.327

我很惊讶没有人提到[ClipX](http://bluemars.org/clipx/)。我发现没有这个剪贴板历史工具我就无法开发。

* * *

## 回答 #13

> 赞同：6
> 
> 时间：2008-12-11T03:31:19.153

### 第 1 步：修复窗口

*   关闭系统还原
*   关闭 Windows Defender
*   如果是 OEM 盒子，请卸载任何 OEM 提供的防病毒软件或其他垃圾软件
*   获取**SysInternals** [AutoRuns](http://technet.microsoft.com/en-us/sysinternals/bb963902.aspx)并解决所有 8000 个无用的启动项和 vista 对您造成的服务，包括缓慢且无用的 vista 搜索索引服务。

 **### 第2步：安装东西。

现在我闪亮的全新 Core 2 Duo PC 不再像 386 一样运行无用的垃圾，我可以重新构建它

*   安装火狐
*   安装 FlashPlayer firefox 插件（*为什么不和 FF 捆绑？*）
*   运行 Windows 更新并让它下载/重启循环 50 次，直到它满意为止
    *   发生这种情况时，我可以使用 firefox 浏览 stackoverflow 并阅读 reddit :-)
*   获取[UnixUtils](http://unxutils.sourceforge.net/)并将它们解压缩到 system32，或者确保它们在路径中。
    *   这是必要的，因为我受不了cygwin，但是我`ls`尝试打字时肌肉记忆一直在打字`dir`，而windows还没有听说`grep`过
*   安装 Droid Sans Mono 和 Monaco 字体以进行编程
*   安装 E-TextEditor
*   如果我正在安装 Visual Studio，请执行此操作。如果不安装 .NET 框架运行时
*   安装 Firefox 插件（firebug、fission、web developer、adblock）

* * *

## 回答 #14

> 赞同：4
> 
> 时间：2008-12-06T04:30:00.143

我遵循由 Simon Peyton Jones 构建和维护的[使 Windows 系统有用的广泛配方。](http://research.microsoft.com/~simonpj/win32-cheat.html)

* * *

## 回答 #15

> 赞同：4
> 
> 时间：2008-12-05T17:04:40.620

我将写字板添加到发送到上下文菜单中。 [XP的说明在这里](http://support.microsoft.com/kb/310270)。也适用于 Vista。

* * *

## 回答 #16

> 赞同：4
> 
> 时间：2008-12-05T17:13:25.377

有人给了我一个“删除所有 SVN 文件夹”的注册表脚本——这对我来说是必须的，现在（它在[这个](https://stackoverflow.com/questions/224430/xcopy-aspnet-deployment-of-a-subversion-managed-project)线程的某个地方）。

我让 UAC 处于开启状态 - 我想要的最后一件事是编写在 UAC 关闭的情况下工作的代码，但在它开启时却惨遭失败。在我开始使用 Virtual PC 为我的代码设置测试环境之前，我试图让我的桌面尽可能地“香草”——我想在与日常非开发人员用户相当相似的条件下进行测试。

以上所有内容都是针对我的家庭开发系统的。在合理的范围内，我尝试在工作中做同样的事情。除了 SVN 的东西，因为我们在我的办公室使用 TFS。

* * *

## 回答 #17

> 赞同：4
> 
> 时间：2008-12-05T17:58:22.773

我总是安装以下内容，以便更轻松地管理和与 windows 交互

*   [Taskix](http://taskix.robustit.com/) - 重新排序 Windows 任务栏中的按钮
*   [KatMouse](http://ehiti.de/katmouse/) - 在鼠标光标正下方滚动窗口
*   [WinSplit Revolution](http://www.winsplit-revolution.com/) - 通过平铺、调整大小和定位来组织您的窗口
*   [allSnap](http://ivanheckman.com/allsnap/) - 窗口自动捕捉到窗口边缘和（可选）其他窗口的边缘

* * *

## 回答 #18

> 赞同：4
> 
> 时间：2008-12-05T20:01:23.977

我喜欢：

*   使任务栏变大，以便它可以容纳两行应用程序
*   在开始菜单中禁用个性化菜单
*   禁用相似任务栏项目的分组

我还随机打开很多 PuTTY 会话到各种机器，所以我喜欢在我的主文件夹中创建一个“bin”目录，将其添加到 PATH，然后在其中创建一个名为“p”的 PuTTY 快捷方式（以及其他快捷方式）。然后我可以轻松地 Windows-R（运行）并键入`p [putty-session-name]`以打开会话。这为我节省了大量时间/鼠标点击。

* * *

## 回答 #19

> 赞同：3
> 
> 时间：2008-12-08T20:13:24.513

其他人没有提到的几件事

*   为选项卡式 cmd 窗口安装[Console2](http://sourceforge.net/projects/console/)
*   安装 Powershell
*   [用Notepad2](http://www.flos-freeware.ch/notepad2.html)完全取代记事本

* * *

## 回答 #20

> 赞同：3
> 
> 时间：2008-12-05T23:24:07.517

关闭自动运行，这样我就不会意外安装恶意软件或垃圾软件。

以下是其中的几个链接：

[http://antivirus.about.com/od/securitytips/ht/autorun.htm](http://antivirus.about.com/od/securitytips/ht/autorun.htm) [http://news.cnet.com/8301-13554_3-9894970-33.html?tag=mncol;txt](http://news.cnet.com/8301-13554_3-9894970-33.html?tag=mncol;txt)

* * *

## 回答 #21

> 赞同：2
> 
> 时间：2008-12-08T20:43:29.507

我使用[nLite](http://www.nliteos.com/)准备 Windows 安装盘，以便在安装后立即设置一些典型设置。

例如：

*   资源管理器 - 将其他文件类型与记事本相关联
*   Explorer-经典控制面板
*   Explorer-Disable Beep on errors
*   Explorer-Disable Prefix：快捷方式
*   Explorer-显示已知文件类型的扩展名
*   Explorer-显示隐藏的文件和文件夹
*   Explorer-在标题栏中显示完整路径
*   文件和文件夹的性能禁用信息提示
*   性能-禁用文件上的上次访问时间戳
*   任务栏-禁用分组类似的任务栏按钮
*   任务栏-禁用语言-栏
*   任务栏-锁定任务栏-是

您还可以删除系统的无用部分：

*   辅助功能选项
*   公文包
*   剪贴簿查看器

* * *

## 回答 #22

> 赞同：2
> 
> 时间：2008-12-05T16:55:25.210

我至少安装了一些 *nix 命令实用程序和进程资源管理器。

此外，在 XP 系统上，我禁用任何主题并使用 Windows 经典着色。如果没有 Aero 主题，Vista 看起来或无法正常工作，所以我无法在 Vista 上做到这一点而几乎完全疯了。

也忘了，我安装了Chrome。（曾经是 Firefox，但 Chrome 开箱即用更好）

* * *

## 回答 #23

> 赞同：2
> 
> 时间：2008-12-05T20:12:31.880

*   安装完整的 IIS。
*   将分辨率设置得足够高。
*   将背景设置为灰色。
*   显示隐藏文件和系统文件。
*   工具栏 2 或 3 高（我横向运行一台显示器）。
*   始终显示文件扩展名。

* * *

## 回答 #24

> 赞同：1
> 
> 时间：2008-12-11T03:40:38.430

1.  切换到经典菜单
2.  增加任务栏高度以获得更多快捷方式并锁定任务栏
3.  性能选项 -> 调整以获得最佳性能
4.  将所有备份的快捷方式文件复制到收藏夹文件夹
5.  安装必要的软件（JDK、DBMS、Editplus、MS Office 等）
6.  声卡驱动
7.  新的宽带网络连接...

* * *

## 回答 #25

> 赞同：1
> 
> 时间：2008-12-06T00:09:07.037

安装 emacs + 一系列 gnuwin32 软件包。

也proexp替换任务管理器。

* * *

## 回答 #26

> 赞同：1
> 
> 时间：2008-12-05T16:53:51.687

我安装了我通常使用的所有 shell 扩展（例如 TortoiseSVN 和 CommandHere）。

此外，在重新映像机器后，我要做的第一件事就是确保它正确连接到我的所有网络共享。很少有事情会像在不合时宜的时间与网络斗争以获得文件一样快地使我的工作脱轨。

* * *

## 回答 #27

> 赞同：1
> 
> 时间：2008-12-11T02:39:27.353

Edi Weitz 有一篇关于他的自定义的很好的文章：[让 Windows 可用于旧的 Linux 放屁](http://www.weitz.de/win/)

* * *

## 回答 #28

> 赞同：0
> 
> 时间：2008-12-11T03:37:13.383

作为 cygwin 的替代品，我使用[ch](http://www.softintegration.com/)它是一个免费的 unixshell + utils 并且是一个“c”解释器。
他们的网站有点像侄子艺术，但产品非常好。

* * *

## 回答 #29

> 赞同：0
> 
> 时间：2009-03-07T21:21:44.843

1.  安装最新的服务包。通常，我无论如何都会滑流它。

2.  防止应用程序窃取焦点。 [http://xphelpandsupport.mvps.org/how_do_i_prevent_applications_fr.htm](http://xphelpandsupport.mvps.org/how_do_i_prevent_applications_fr.htm)

3.  复制我的命令行应用程序（[基本的 unix 命令](http://unxutils.sourceforge.net/)）和[SysInternals](http://technet.microsoft.com/en-us/sysinternals/default.aspx)应用程序。

4.  Windows 更新

5.  安装 Visual Studio、Eclipse、VirtualBox 等开发人员工具。

我更倾向于将 SQL Server 等基于服务的应用程序安装在基础虚拟机上并从那里运行。这样，我只在需要时运行它，并且可以延长我的 Windows 安装的性能寿命。

* * *

## 回答 #30

> 赞同：0
> 
> 时间：2009-03-07T21:57:23.837

1.  在将盒子连接到 Internet**之前**安装 wipfw（和一个体面的规则集） 。
2.  安装 Far Manager + 一些插件。
3.  安装vim。
4.  安装 gkrellm。

这一切都曾经发生在过去。现在我只使用 Linux，对此我很满意。我不是狂热分子，也不是狂热分子。Linux 只是为我完成了这项工作，所以我坚持使用它。

* * *

## 回答 #31

> 赞同：0
> 
> 时间：2009-01-28T18:12:44.720

主要是：Visual Studio、SQL Server 和一些扩展，比如 Rock Scroll 等。

作为一名网络开发人员，我安装了 4 个其他浏览器（以及 IE）：Opera、Firefox、Chrome 和 Safari。

还 ：

*   SysInternals Process Explorer Altova
*   Altova XML 间谍
*   温安普
*   办公室 2007
*   Altova Diff 狗
*   油漆网
*   雅虎通
*   Skype
*   反射器
*   ViewState 解码器
*   甲骨文 SQL 开发人员
*   FastStone 图像查看器
*   文本板
*   直流++
*   饲料阅读器
*   .NET 内存分析器 (SciTech)
*   HttpLook
*   NetBeans
*   SQLDigger
*   温安普
*   工作狂欢
*   躁狂时间
*   MySQL（包括 alpha 如 6.0）

* * *

## 回答 #32

> 赞同：0
> 
> 时间：2008-12-06T01:05:02.057

安装开发工具（任你选）。源代码控制、数据库、IDE、单元测试工具等。

假设：我对盒子拥有全部权利。

安装最新的驱动程序、Windows 更新、Firefox、[Evernote](http://evernote.com)、[Live Mesh](http://mesh.com)、[7-zip](http://www.7-zip.org)、[Digsby](http://www.digsby.com/?utm_campaign=new_w&utm_content=new&utm_medium=new&utm_source=new)（用于 IM 和社交网络）、[Zune](http://www.zune.net/en-US/default.htm)（用于音乐和播客）

* * *

## 回答 #33

> 赞同：0
> 
> 时间：2008-12-08T17:12:22.570

*   vim (windows 端口相当不错)
*   mssoffice
*   cygwin（cygwin 设置很麻烦，但是我发现它是让 gcc 运行的最简单方法）
*   视觉工作室
*   FF 或铬
*   Adobe阅读器：D
*   如果您有 Linux 安装，或者只是 ext2/3 格式化磁盘或闪存驱动器，还有 [1] 用于 ext2/3 的驱动程序。

我想这还不是全部，只是我脑海中浮现的一切。

[1] [http://www.fs-driver.org/](http://www.fs-driver.org/)

* * *

## 回答 #34

> 赞同：0
> 
> 时间：2008-12-05T18:13:39.500

哇，这是一个非常好的线程......我将不得不阅读所有建议，看看我的任务是什么:)

马上，我安装：

*   谷歌浏览器
*   视觉工作室 2008
*   aShampoo CD 刻录套件（或任何我目前最喜欢的刻录套件）
*   IZArc（或任何我目前最喜欢的）
*   RocketDock - 我用它来代替快速启动。
*   鸣禽

当我使用 XP（我现在在 Vista 上）时，我总是会安装 Tweak UI 并根据自己的喜好调整一切。就像在我的文档之前列出我的电脑一样。我从开始菜单中删除了帮助图标。我这样做是为了在开始菜单中显示网上邻居。我让它显示文件扩展名并显示隐藏文件/文件夹。

* * *

## 回答 #35

> 赞同：0
> 
> 时间：2008-12-05T18:40:55.310

我要做的第一件事是确保所有内容都已更新，并关闭后台所有多余的垃圾。直到最近几年我才重新安装 Windows，所以我忘记了这一步有多痛苦（4-5 小时......）

我做的第一件事就是从[PowerToys 页面](http://www.microsoft.com/windowsxp/downloads/powertoys/xppowertoys.mspx)下载 ClearType Tuner 。我发现无论我在哪个 LCD 上使用，操作系统的默认设置都会给文本带来非常明显的彩色条纹，一段时间后它最终会导致眼睛疲劳。有时我会完全关闭它。

之后我安装了常用的东西；Firefox、gVim、命令提示符 powertoy、7-Zip、...

* * *

## 回答 #36

> 赞同：0
> 
> 时间：2008-12-05T16:55:01.560

我通常让 Windows Defender 在线，但我不使用防病毒软件，所以......

我将开始菜单设置为显示小图标并且没有“最近使用的程序”处于活动状态。相反，我将所有内容都固定到我的开始菜单：

[我的开始菜单 http://www.robpaveza.net/pub/startmenu.png](http://www.robpaveza.net/pub/startmenu.png)

我还确保所有扩展菜单都是实际菜单，而不仅仅是链接，并且我的计算机和用户文件图标显示在桌面上。

* * *

## 回答 #37

> 赞同：0
> 
> 时间：2008-12-05T16:57:31.383

我下载并安装[Cygwin](http://www.cygwin.com/)和[Xming](http://www.straightrunning.com/XmingNotes/)。

* * *

## 回答 #38

> 赞同：0
> 
> 时间：2008-12-11T22:52:31.320

我想知道你们中有多少人使用 nLite/vLite 为 Windows 创建自定义安装程序？？？

我的开发工具已安装：

*   [虚拟盒子](http://www.virtualbox.org/)
*   Firefox 插件（WebDeveloper、FireBug 等）

加上更多...

* * *

## 回答 #39

> 赞同：0
> 
> 时间：2011-05-31T16:56:40.623

安装[Image Resizer](http://imageresizer.codeplex.com/)，一个 Windows XP Powertoys 的克隆；适合 Windows 7 64 位。通过 Windows 资源管理器中的上下文菜单制作缩略图非常方便。

# wpf - 全职 WPF 开发

> ID：344470
> 
> 赞同：4
> 
> 时间：2008-12-05T16:49:59.417
> 
> 标签：wpf

我很幸运能在一家公司工作，我们所有的新开发工作都在 WPF 中。在这种情况下是否还有很多其他开发人员？公司是否正在迅速将其作为他们的主要 UI 平台？作为开发人员，我们都看到了它的价值，但公司是否愿意购买它？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-07T08:48:26.037

我正在一家大型半导体公司进行 WPF 开发。到目前为止，它一直是一次失败的经历。只要我们可以支持 Windows Vista 及更高版本，我就可以自由决定使用什么开发平台。鉴于我对一个相当大的应用程序的开发时间很短，并且只有两个 GUI 开发人员来开发它，因此 WPF 似乎是正确的选择。然而，随着我走得更远，更多的 WPF 缺陷表现出来了......在将 DirectX 与 WPF 的 .NET 3.0 实现集成时，只需研究“空域”问题。或者看看 Visual Studio 2008 中设计器工具的糟糕状态。仍然存在这些问题，与创建支持 RTL 语言和动画的完全可换肤 UI 的开发成本相比，这些问题相对较小。曾经有人（曾在 Microsoft 工作过）建议我将 SDL 视为 WPF 的替代品。对对。

我遇到的另一个问题是设计师仍然没有采用整个 WPF/Blend 工具。我认识的大多数设计师都嘲笑在 Mac 上运行 Adob​​e 工具以外的任何东西。我们的开发人员有责任将他们的设计转化为可行的代码。我讨厌那些穿高领毛衣的混蛋。

无论如何，我的公司将技术决策留给使用它的人。因此，考虑到我的要求，WPF 是一个自然的选择。我不后悔，但我希望在他们与 Vista 一起发布之前它更成熟一点。.NET 3.5 中有一些我需要的关键修复。但是，当 .NET 3.0 在他们的 Vista 系统上时，我不想强​​迫我的用户下载 .NET 3.5。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-12-05T20:42:06.703

我认为公司适应这项新技术的主要问题是

*   XAML 和新 UI 概念的学习曲线
*   开发人员必须忘记他们在 Winforms（或等效的 UI）技术上获得的所有知识，大多数人都不愿意放弃他们的专业知识。
*   需要名为“UX Integrators”的新技能，他们应该能够使用名为 Expression Blend 的新 RIA 工具来设计/集成设计与代码。
*   对新框架要求 (.NET3.5) 和新工具集的需求使公司或客户在采取这条路线之前三思而后行。他们通常认为这可能是一条“冒险”的道路。

[我的公司](http://identitymine.com/)主要专注于 WPF 和 Silverlight 等 Microsoft RIA 技术。我们正在通过创建概念证明/原型应用程序来帮助其他公司引导他们的 WPF 开发工作，以展示 WPF 的强大/易用性。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-07T14:53:38.387

我们公司也在 WPF 中进行大多数新的开发。它对我们来说工作得很好。然而，该组织花了 2-3 个月的时间克服学习曲线并开始“WPF 思维方式”。

与Louis 的观点类似，我认为控制行业缓慢的原因之一是设计师对学习Expression 套件犹豫不决。一旦有足够数量的 Expression 设计师，我认为公司将看到使用 WPF 更直接的好处。

WPF 的主要优点之一是矢量图形。因为我们开发的应用程序可以在小型笔记本电脑和坚固的 PC 上使用，所以 UI 能够扩展到不同尺寸的显示器是非常有益的。

# asp.net - ASP.net：网站或 Web 应用程序项目

> ID：344473
> 
> 赞同：10
> 
> 时间：2008-12-05T16:51:04.750
> 
> 标签：asp.net

网站和Web应用程序项目之间有什么区别吗？如果您正在从事一个网站和应用程序混合的项目怎么办？你应该选择哪个项目？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-12-05T19:32:26.703

我会选择较新的 Web 应用程序项目（总是，不管项目的大小）。

使用 Web 应用程序项目没有什么可失去的，也没有什么可得到的（你不能说只使用“网站”）。

官方差异列表如下：

**当您使用 Web 应用程序项目时**

1.  需要迁移大型 Visual Studio.NET 2003 应用程序
2.  需要控制输出程序集的名称
3.  需要独立类来引用页面和用户控件类
4.  需要使用多个 Web 项目构建一个 Web 应用程序
5.  需要在编译过程中添加预构建和构建后步骤

**在以下情况下使用网站：**

1.  需要为每一页生成一个程序集。
2.  喜欢单页代码模型而不是代码隐藏模型。
3.  更喜欢动态编译和处理页面，而不是在每个页面视图上构建整个站点（即，保存文件然后简单地在浏览器中刷新页面）。
4.  想要在不创建项目文件的情况下将任何目录作为 Web 项目打开和编辑

如果您想了解更多信息，@Mehrdad 的链接是必不可少的[http://msdn.microsoft.com/en-us/library/aa730880(VS.80).aspx#wapp_topic5](http://msdn.microsoft.com/en-us/library/aa730880(VS.80).aspx#wapp_topic5)

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2008-12-05T17:06:10.760

至于选择哪个项目，我会选择Web Application Project，无论大小。将您的所有代码编译成单个 DLL 对托管端的维护和安全性有很大好处。我知道网站项目有预编译选项，但它们似乎更麻烦，对我来说是值得的。

我知道 IIS 过滤器可以防止用户访问您的 .vb 或 .cs 文件，但这仍然让我有点怀疑。

但更重要的是，如果您进行大量编码更改，或者添加一些类并更改处理逻辑，那么您唯一需要合并的就是编译的 DLL，而无需其他任何东西。类似地，如果您进行一些 UI 更改（例如更改样式表或一些控件的位置），您不必担心重新编译应用程序，只需打开更新 .aspx 页面即可。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-05T16:53:34.763

看一看：

[http://msdn.microsoft.com/en-us/library/aa730880(VS.80).aspx#wapp_topic5](http://msdn.microsoft.com/en-us/library/aa730880(VS.80).aspx#wapp_topic5) [http://forums.asp.net/p/1300026/2538628.aspx](http://forums.asp.net/p/1300026/2538628.aspx)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-05T17:08:24.233

当我想创建一个新的 web 应用程序时，我习惯于创建网站。

我当前的项目在编译时遇到了一些问题，所以我切换到了一个 webapplication 项目。这一步并不难。Visual Studio 可帮助您更改所有必要的行。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-05T19:55:32.447

参考帖子中的链接：

[http://www.codersbarn.com/post/2008/06/01/ASPNET-Web-Site-versus-Web-Application-Project.aspx](http://www.codersbarn.com/post/2008/06/01/ASPNET-Web-Site-versus-Web-Application-Project.aspx)

安东尼:-)

# authentication - 网站上的表单认证

> ID：344474
> 
> 赞同：1
> 
> 时间：2008-12-05T16:51:08.777
> 
> 标签：authentication, jsp

这是我们的 Tomcat 网络服务器当前的设置方式。我们正在为网页使用jsp。

*   /webserverpath/main（所有公共页面和登录页面）
*   /webserverpath/secure1（私人页面）
*   /webserverpath/secure2（私人页面）
*   /webserverpath/secure3（私人页面）

我最近发现身份验证非常少。例如，一旦用户登录，他们可以为任何私人页面添加书签，关闭浏览器，打开浏览器备份并转到书签，并且永远不会被要求再次登录（因为我们最近开始禁用用户，所以结果很糟糕）。所有这些都是在我到达之前设置好的。我想知道我能做些什么来增加适当的安全性？我应该将所有文件夹都放在一个主文件夹下（即 /webserverpath/main/secure1 等）还是不理会它？

让我补充一点，我对整个网站身份验证内容很陌生，在不同的文件夹中拥有多个网站，例如 JSP 本身。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-05T17:30:59.350

您可以从这里开始：[使用 Servlet 和 JSP 的声明式 Web 应用程序安全](http://www.informit.com/articles/article.aspx?p=26139&redir=1)
通常，您可能需要一些基于会话的身份验证，如果他们没有经过身份验证，则可以将他们踢出站点的私有部分。

# sql - 使用“NOT IN”的 LINQ to SQL 查询

> ID：344478
> 
> 赞同：29
> 
> 时间：2008-12-05T16:52:53.373
> 
> 标签：sql, .net, linq, linq-to-sql

LINQ to SQL 可以使用**NOT IN**查询吗？

例如，SELECT au_lname, state FROM authors WHERE state NOT IN ('CA', 'IN', 'MD')

* * *

## 回答 #1

> 赞同：51
> 
> 时间：2008-12-05T16:57:48.047

```
 List<string> states = new List<string> { "CA", "IN", "MD" };
    var q = from a in authors
            where !states.Contains(a.state)
            select new { a.au_lname, a.state }; 
```

或者

```
 var q = authors.Where( a => !states.Contains( a.state ) )
                  .Select( a => new { a.au_lname, a.state } ); 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2008-12-05T17:00:11.660

您可以使用包含：

```
 var states = new[]  {"CA", "IN", "MD"};
       var query = db.Authors.Where(x => !states.Contains(x.state)); 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2008-12-05T16:57:25.050

这是一个例子：

```
NorthwindDataContext dc = new NorthwindDataContext();
dc.Log = Console.Out;
var query =
    from c in dc.Customers
    where !(from o in dc.Orders
            select o.CustomerID)
           .Contains(c.CustomerID)
    select c;
foreach (var c in query) Console.WriteLine( c ); 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-12-05T17:03:10.203

是的！

这是我们已经编写的代码示例：

```
 List<long> badUserIDs = new List { 10039309, 38300590, 500170561 };
            BTDataContext dc = new BTDataContext();
            var items = from u in dc.Users
                        where !badUserIDs.Contains(u.FbUserID)
                        select u; 
```

生成的 SQL 结果是：

`{SELECT [t0].[UserID], [t0].[FbUserID], [t0].[FbNetworkID], [t0].[Name], FROM [dbo].[Users] AS [t0] WHERE NOT ([t0].[FbUserID] IN (@p0, @p1, @p2)) }`

# c# - 如何获取 HttpRuntime.Cache 对象的到期日期时间？

> ID：344479
> 
> 赞同：14
> 
> 时间：2008-12-05T16:53:16.510
> 
> 标签：c#, asp.net, caching

是否有可能获得对象的到期`DateTime`时间`HttpRuntime.Cache`？

如果是这样，最好的方法是什么？

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2008-12-08T18:22:13.350

我刚刚浏览了反射器中的 System.Web.Caching.Cache。似乎涉及到期日期的所有内容都标记为内部。我发现公共访问它的唯一地方是通过 Cache.Add 和 Cache.Insert 方法。

所以看起来你很不走运，除非你想进行反思，除非你真的需要那个日期，否则我不建议你这样做。

但是，如果您仍然想这样做，那么这里有一些可以解决问题的代码：

```
private DateTime GetCacheUtcExpiryDateTime(string cacheKey)
{
    object cacheEntry = Cache.GetType().GetMethod("Get", BindingFlags.Instance | BindingFlags.NonPublic).Invoke(Cache, new object[] { cacheKey, 1 });
    PropertyInfo utcExpiresProperty = cacheEntry.GetType().GetProperty("UtcExpires", BindingFlags.NonPublic | BindingFlags.Instance);
    DateTime utcExpiresValue = (DateTime)utcExpiresProperty.GetValue(cacheEntry, null);

    return utcExpiresValue;
} 
```

[由于 .NET 4.5](https://stackoverflow.com/questions/53199635/cant-access-runtime-cache-using-reflection)的内部公共 getter`HttpRuntime.Cache`被替换为静态变体，因此您需要调用/获取静态变体：

```
object cacheEntry = Cache.GetType().GetMethod("Get").Invoke(null, new object[] { cacheKey, 1 }); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2018-10-22T14:20:55.010

正如有人在评论中建议的那样，接受的答案在 .NET 4.7 中不起作用

我在试图弄清楚需要做哪些更改才能使其在 .NET 4.7 中工作时遇到了很多麻烦

这是我为使用 .NET 4.7 的人提供的代码

```
private DateTime GetCacheUtcExpiryDateTime(string cacheKey)
{
    var aspnetcachestoreprovider = System.Web.HttpRuntime.Cache.GetType().GetProperty("InternalCache", BindingFlags.Instance | BindingFlags.NonPublic).GetValue(System.Web.HttpRuntime.Cache, null);
    var intenralcachestore = aspnetcachestoreprovider.GetType().GetField("_cacheInternal", BindingFlags.Instance | BindingFlags.NonPublic).GetValue(aspnetcachestoreprovider);
    Type TEnumCacheGetOptions = System.Web.HttpRuntime.Cache.GetType().Assembly.GetTypes().Where(d => d.Name == "CacheGetOptions").FirstOrDefault();
    object cacheEntry = intenralcachestore.GetType().GetMethod("DoGet", BindingFlags.NonPublic | BindingFlags.Instance, null, CallingConventions.Any, new[] { typeof(bool), typeof(string), TEnumCacheGetOptions }, null).Invoke(intenralcachestore, new Object[] { true, cacheKey, 1 }); ;
    PropertyInfo utcExpiresProperty = cacheEntry.GetType().GetProperty("UtcExpires", BindingFlags.NonPublic | BindingFlags.Instance);
    DateTime utcExpiresValue = (DateTime)utcExpiresProperty.GetValue(cacheEntry, null);

    return utcExpiresValue;
} 
```

对于那些希望代码在多个不同环境中运行的人（使用 .NET 4.5 的沙箱和使用 .NET 4.7 的生产环境），这里有一些补丁工作：

```
private DateTime GetCacheUtcExpiryDateTime(string cacheKey)
{
    MethodInfo GetCacheEntryMethod = null;
    Object CacheStore = null;
    bool GetterFound = true;

    GetCacheEntryMethod = System.Web.HttpRuntime.Cache.GetType().GetMethod("Get", BindingFlags.Instance | BindingFlags.NonPublic);
    if (GetCacheEntryMethod != null)
    {
        GetterFound = true;
        CacheStore = System.Web.HttpRuntime.Cache;
    }
    else
    {
        var aspnetcachestoreprovider = System.Web.HttpRuntime.Cache.GetType().GetProperty("InternalCache", BindingFlags.Instance | BindingFlags.NonPublic).GetValue(System.Web.HttpRuntime.Cache, null);
        var intenralcachestore = aspnetcachestoreprovider.GetType().GetField("_cacheInternal", BindingFlags.Instance | BindingFlags.NonPublic).GetValue(aspnetcachestoreprovider);
        Type TEnumCacheGetOptions = System.Web.HttpRuntime.Cache.GetType().Assembly.GetTypes().Where(d => d.Name == "CacheGetOptions").FirstOrDefault();
        GetCacheEntryMethod = intenralcachestore.GetType().GetMethod("DoGet", BindingFlags.NonPublic | BindingFlags.Instance, null, CallingConventions.Any, new[] { typeof(bool), typeof(string), TEnumCacheGetOptions }, null);
        GetterFound = false;
        CacheStore = intenralcachestore;
    }

    dynamic cacheEntry;
    if (GetterFound)
        cacheEntry = GetCacheEntryMethod.Invoke(CacheStore, new Object[] { cacheKey, 1 });
    else
        cacheEntry = GetCacheEntryMethod.Invoke(CacheStore, new Object[] { true, cacheKey, 1 });

    PropertyInfo utcExpiresProperty = cacheEntry.GetType().GetProperty("UtcExpires", BindingFlags.NonPublic | BindingFlags.Instance);
    DateTime utcExpiresValue = (DateTime)utcExpiresProperty.GetValue(cacheEntry, null);

    return utcExpiresValue;
} 
```

* * *

## 回答 #3

> 赞同：-4
> 
> 时间：2008-12-07T21:39:08.227

缓存本身不会过期。它可以有项目（过期）或根本没有任何项目。

# asp.net - 动态数据：对于使用视图而不是表的 LINQ 类，脚手架是只读的？

> ID：344497
> 
> 赞同：0
> 
> 时间：2008-12-05T16:57:14.223
> 
> 标签：asp.net, dynamic-data

我正在尝试使用 ASP.NET 动态数据功能为我的数据模型生成 CRUD 脚手架。我的模型包含超类型/子类型关系，因此一些逻辑实体在两个表之间拆分：一个用于通用数据，另一个用于特定于子类型的数据。

在 LINQ 上下文中，我将这些实体公开为单个类，由将表连接在一起的视图支持。我还为插入/更新/删除创建了存储过程，并配置了类行为以使用它们。

当我打开脚手架时，它只会生成此数据的只读视图。添加、编辑和删除链接不显示。为什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-05T17:27:21.013

已解决：问题是在将视图拖到表面后，我没有在 LINQ 类上识别主键列。添加 PK 后，CRUD 功能出现了。

# c# - 有没有办法从派生类型中访问另一个对象的“受保护”成员？

> ID：344503
> 
> 赞同：15
> 
> 时间：2008-12-05T16:58:02.257
> 
> 标签：c#, oop

```
class MyBase
{
    protected object PropertyOfBase { get; set; }
}

class MyType : MyBase
{
    void MyMethod(MyBase parameter)
    {
        // I am looking for:
        object p = parameter.PropertyOfBase;  // error CS1540: Cannot access protected member 'MyBase.PropertyOfBase' via a qualifier of type 'MyBase'; the qualifier must be of type 'MyType' (or derived from it)
    }
} 
```

有没有办法从扩展类型中获取类型参数的受保护属性而无需反射？由于扩展类通过其基类型知道该属性，因此如果可能的话，这将是有意义的。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-06-14T08:01:16.233

上次遇到类似问题时，我使用了在基础上添加受保护的静态方法的解决方案：

```
class MyBase
{
    protected object PropertyOfBase { get; set; }

    protected static object GetPropertyOfBaseOf(MyBase obj) 
    {
        return obj.PropertyOfBase;
    }
}

class MyType : MyBase
{
    void MyMethod(MyBase parameter)
    {
        object p = GetPropertyOfBaseOf(parameter);
    }
} 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2008-12-05T17:14:25.423

不，你不能这样做。

您只被允许访问访问类型（或从它派生）的对象的受保护成员。在这里，我们不知道参数是 MyType 类型还是 SomeOtherCompletelyDifferentType。

编辑：C# 3.0 规范的相关位是第 3.5.3 节：

> 当在声明它的类的程序文本之外访问受保护的实例成员时，并且当在声明它的程序的程序文本之外访问受保护的内部实例成员时，访问必须在类内进行从声明它的类派生的声明。此外，访问需要通过派生类类型的实例或从它构造的类类型进行。此限制阻止一个派生类访问其他派生类的受保护成员，即使这些成员是从同一基类继承的。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-12-05T17:58:26.067

你不能这样做是有充分理由的。假设有人写道：

```
class Other : MyBase { }

new MyType().MyMethod(new Other()); 
```

如果语言允许您要求的内容，您可以`Other`通过修改 的值来违反假定的不变量`PropertyOfBase`.

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-12-05T17:59:11.680

我认为你应该问问自己是否有更好的方法来做你想做的事。您希望 PropertyOfBase 在 MyType.MyMethod() 的上下文中充当公共，但在所有其他情况下都受到保护。为什么？

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-12-05T17:19:00.453

受保护的属性只能被派生类的实例访问，不能被派生类的实例访问。

有一个区别，它确实有意义，受保护的成员不应该将它们的值放弃给任何其他实例，即使是从同一类型派生的实例。

（已编辑，让自己有点被束缚了！）

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2018-03-01T22:57:53.717

当您从 MyBase 继承时，您可以使用“base”关键字访问标记为“受保护”的所有字段/属性/方法。

```
public class MyBase
{
    protected object PropertyOfBase { get; set; }
}

public class MyType : MyBase
{
    void MyMethod()
    {
        object p =  base.PropertyOfBase;
    }
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2018-03-06T20:37:19.403

您还可以将 MyType 声明为 MyBase 的嵌套类（而不是继承），这样您可以在将类 MyBase 作为参数发送时访问私有/受保护成员

```
public class MyBase
{
    protected object PropertyOfBase { get; set; }

    public class MyType
    {
        public void MyMethod(MyBase parameter)
        {
            object p = parameter.PropertyOfBase;  
        }
    }
} 
```

要创建 MyType 的实例，只需使用

```
var t = new MyBase.MyType();
t.MyMethod(new MyBase()); 
```

# database-design - 为审计问题状态建模关系实体

> ID：344505
> 
> 赞同：0
> 
> 时间：2008-12-05T16:58:21.587
> 
> 标签：database-design, relational

这让我怀疑了一段时间，所以我认为将它发布在这里以找到一些见解是个好主意，这是一个关系数据库建模问题/怀疑

我有以下问题：

我有必须处于特定“状态”的“问题”，并且必须审核所有状态更改。

我找到了两种解决方案，但我真的看不出它们之间的区别，如果有的话......你怎么看。

这是两个图表的图像。

**编辑：**

选项 A：表“questions”不应包含 state_id，并且 Question_State 不应包含“id”字段。对错误感到抱歉。

**编辑2**：

感谢所有现实世界的例子和洞察力，但这是一个学术问题，与现实世界无关:)。

[![图表](https://i.stack.imgur.com/wE53V.png)](https://i.stack.imgur.com/wE53V.png)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-05T17:28:17.047

我认为您要问的要点是：问题的状态是否应该基于 Questions 和 State 之间的具有时间分量 (A) 的中间表，或者该表是否应该更加静态，但具有面向日志的侧面的历史表（B）。

（注意：如果你想做一个纯版本的（A），那么 Boofus 是对的，你可能不会把 state_id 也放在 Questions 表中，因为它是多余的；但这肯定不方便，因为它会使简单的查询来获得特定状态下的问题要困难得多。所以你在这里有一个混合版本。）

一般来说，如果保留有关状态的历史信息的要求真的只是为了审计目的——也就是说，如果应用程序本身不会定期查询它——你可能最好选择选项 B，因为它是稍微简单一点（实际上只有一个“问题”表，有一个状态参考表，以及一个用于先前状态的“日志”表）。我认为这更好地表明了你的意图。

但是，如果应用程序语义更复杂（例如，如果您有诸如“显示过去 24 小时内处于状态 X 的所有问题......”之类的查询），那么像 (A) 这样的方法可能更有意义。它本质上是把一个问题的状态变成一个与时间相关的事实。如果您这样做，请注意这会使事情变得复杂 - 您的所有查询都更难并且必须考虑时间，或者您必须担心保持 Questions 上的 state_id 与 Questions 表中的最新状态同步。如果你走那条路，也许在 Questions 上称它为“current_state”或其他名称，所以很明显它是一种衍生信息。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-05T21:48:57.427

您可能想在网络上搜索“时态数据库”这一主题。基本上，存储任何变量的变化历史都会引发相同的问题，无论该变量是否捕获问题状态或人的体重或其他什么。

其次，我认为您的问题与数据库设计有关，而不是与概念数据建模有关。如果我的想法正确，那么您是在问哪种桌子设计更好。

第三，我更喜欢选项 B，但这实际上取决于您将如何处理数据。

我询问数据库设计与概念建模的原因是，我很久以前就采用了使用“实体和关系”进行与数据分析相关的概念数据建模的做法。在讨论逻辑数据库设计时，我使用术语“表、列和行”。将分析和设计分开在大型项目中非常有价值。而且做起来并不像听起来那么容易。

对于选项 B，您确实应该在图表中的历史表和状态表之间添加一个箭头。图表的呈现方式几乎看起来就像历史表是一个不相交的表。在这个简单的示例中不是问题，但是如果您在扩展到具有数十个表的数据库时保持相同的做法，您最终会混淆查看图表的每个人。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-05T17:13:27.780

一旦你画了所有的关系，它们是一样的。

我不明白为什么你在问题表中有 state_id - 因为你有历史表，所以在问题表中拥有状态是多余的，并且可能会给你留下不同步的数据。

在我看来，如果你想要一个问题的当前状态，你可以

SELECT State_ID FROM Historical WHERE Question_id = ? ORDER BY Date DESC LIMIT 1

（或任何您的 SQL 风格用来限制为 1 行的方法）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-05T17:53:56.793

假设您在数据库和 OO 之间有良好的抽象层，您可能会考虑将 State 表从数据库中取出并使其成为类中的枚举。这不一定是需要坚持的东西。

然后在 Questions 表和 audit 表中有 State 列。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-05T18:02:45.933

您说已审计，这意味着您只是希望保留历史信息以用于报告目的。在这种情况下，我建议图 B 更清晰，尽管您可能也应该标记问题和历史以及状态和历史之间的一对多关系。

至于实用性，如果情况如上所述，我自己会将历史插入功能封装到问题上的插入/更新触发器中，如果问题表的数量和/或状态更改的数量会很大，我会考虑将历史表放在不同的数据库中。这只是简化了以后的数据库管理。通常我对触发器持谨慎态度，因为过度使用会导致数据库难以维护（因为目前还不清楚发生了什么），但这是一个明显的例子，它们非常适合并且是使用的更好选择应用逻辑。

顺便说一句，您的两个图表都暗示一个问题只能进入每个状态一次（从您的 PK 中） - 您应该考虑这是否正确，因为在大多数现实世界的应用程序中都会犯错误并反转状态。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-07T23:54:25.440

我不明白，像#Boofus 一样，在 Questions 表中有一个 state_id 字段的兴趣。

在我们自己的应用程序中，我一直在使用这样的“状态”概念进行了大量工作。在大多数复杂情况下，我们必须跟踪完整的状态历史以及对象可以具有多个状态的情况，我们使用以下模型：

![替代文字](https://farm4.static.flickr.com/3061/3091196642_6d7d02e6a8_o.png)

对于多状态情况，想法是检查 end_date 值是否为空（另一个想法是在表中有一个布尔字段 isActiveState）。不要低估拥有这种“多状态”配置的兴趣。例子：

一个问题可以是

*   关闭并解决

**或者**

*   关闭且未解决。

这可能对应于两种不同的状态：

*   “关闭并解决”状态

**或者**

*   “已关闭且未解决”状态

但我认为最好的解决方案是同时拥有

*   “打开/关闭”状态

**和**

*   “已解决/未解决”状态

并允许问题有多个状态

# .net - WPF 命名空间问题 - 进程？

> ID：344509
> 
> 赞同：0
> 
> 时间：2008-12-05T16:59:54.547
> 
> 标签：.net, wpf, screen, loading, pleasewait

试图让这个例子从[http://www.munna.shatkotha.com/blog/post/2008/10/26/Light-box-effect-with-WPF.aspx](http://www.munna.shatkotha.com/blog/post/2008/10/26/Light-box-effect-with-WPF.aspx)

但是，我似乎无法为下面的“进程”找到正确的名称空间或语法。

```
<Border x:Name="panelDialog" Visibility="Collapsed">
<Grid>
<Border Background="Black" Opacity="0.49"></Border>
<!--While Xmal Content of the dialog will go here-->
</Grid>
</Border> 
```

博文接着说......

只需将两个函数用于隐藏和显示对话框。总代码如下。在下面的代码中，我显示了一个带有灯箱效果的加载屏幕。显示模式对话框时，只需调用显示和隐藏等待屏幕方法。将您的 cpu 扩展作业发送到后台线程并在后台线程中使用调度程序更新 UI 是很好的。

```
<Page x:Class="Home">
<Grid>
<ScrollViewer HorizontalScrollBarVisibility="Auto" VerticalScrollBarVisibility="Auto">
<!--All the contents will go here-->
</ScrollViewer>
<Border x:Name="panelLoading" Visibility="Collapsed">
<Grid>
<Border Background="Black" Opacity="0.49"></Border>
<local:TMEWaitScreen></local:TMEWaitScreen>
</Grid>
</Border>
</Grid>
</Page> 
```

这是代码隐藏

```
#region About Wait Screen
/// <summary>
/// Show wait screen before a web request
/// </summary>
public void ShowWaitScreen()
{
Process del = new Process(ShowWaitScreenUI);
Dispatcher.Invoke(System.Windows.Threading.DispatcherPriority.Normal, del);
}
private void ShowWaitScreenUI()
{
panelLoading.Visibility = Visibility.Visible;
}
/// <summary>
/// Hide a wait screen after a web request
/// </summary>
public void HideWaitScreen()
{
Process del = new Process(HideWaitScreenUI);
Dispatcher.Invoke(System.Windows.Threading.DispatcherPriority.Normal, del);
}
private void HideWaitScreenUI()
{
panelLoading.Visibility = Visibility.Collapsed;
}
#endregion 
```

我对这行特别有疑问：

```
Process del = new Process(ShowWaitScreenUI); 
```

我能找到的唯一进程是在 System.Diagnostics 中，并且不带任何参数。是我想从中学习的博客文章，还是我只是在错误的地方？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-05T17:35:14.380

看起来写博客的人忘记定义他们的自定义委托，称为 Process（它的名字有点奇怪）。

```
private delegate void Process(); 
```

它现在应该在定义它的情况下编译。

但我喜欢这些名字。

```
private delegate void HideWaitScreenHandler();
private delegate void ShowWaitScreenHandler(); 
```

实际上，您可以对其进行重构以使其更简单。

```
private delegate void ShowWaitScreenUIHandler(bool show);

void ShowWaitScreenUIThreaded(bool show)
{
    Process del = new ShowWaitScreenHandler(OnShowWaitScreenUI);
    Dispatcher.Invoke(DispatcherPriority.Normal, del, show);
}

void OnShowWaitScreenUI(bool show)
{
    panelLoading.Visibility = show ? Visibility.Visible : Visibility.Collapsed;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-05T17:53:55.170

此处输入错误：Process 和 ShowWaitScreenHandler 需要更改为 ShowWaitScreenUIHandler。

DispatcherPriority 需要使用。右键单击 DispatcherPriority 并选择 Resolve。

# .net - 在 Vista Home Edition 中禁用“调整日期/时间”

> ID：344513
> 
> 赞同：0
> 
> 时间：2008-12-05T17:00:15.730
> 
> 标签：.net, registry, windows-vista, group-policy

我的公司在现场有相当多的客户端笔记本电脑。这些笔记本电脑运行的是 Windows Vista Home 版。

最近有人问我是否可以找到一种方法来禁用用户调整系统时间的能力。

*   我的第一个想法是使用 gpedit，但我发现这在家庭版中不可用。

*   然后我寻找我可以使用的注册表编辑，但我画了一个空白。显然 gpedit 的用户权限相关位不涉及注册表设置。

我们通过在笔记本电脑上运行的软件自动调整系统时间。这意味着我们需要一种方法来禁用用户调整日期/时间的能力，但允许我们的程序（在该用户的上下文下运行）为他们调整它。

有没有人有任何想法，或者知道让 gpedit 在家庭版上工作的方法？

*（我们的软件基于 .Net 并具有自动更新功能，因此如果需要，我们可以在解决方案中利用它）。*

**更新：**

Vista Home 版中也没有本地安全设置。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-05T17:19:35.753

简短的回答？不要试图在商业环境中逃避消费产品（我知道，可能不是你的错）。

您可能能够更改本地安全策略，但您必须在以本地管理员身份登录时执行此操作，这意味着要么亲自进行，要么允许用户以管理员身份运行您的软件，并让您的软件执行此操作。

那么问题是用户是管理员，并且仍然可以更改系统时间。

# java - 方法调用 Spring bean

> ID：344516
> 
> 赞同：0
> 
> 时间：2008-12-05T17:00:34.263
> 
> 标签：java, spring, scheduled-tasks

我在我的 Spring 配置中声明了以下 bean

```
<bean id="templateCacheClearingTask" class="org.springframework.scheduling.timer.ScheduledTimerTask">
    <property name="delay" value="5000" />
    <property name="period" value="5000" />

    <property name="timerTask">
        <bean class="org.springframework.scheduling.timer.MethodInvokingTimerTaskFactoryBean">
            <property name="targetObject" ref="templateMailService" />
            <property name="targetMethod" value="clearCache" />
        </bean>
    </property>
</bean> 
```

这应该会导致每 5000 毫秒调用一次 bean 的`clearCache()`方法`templateMailService`，但似乎没有发生任何事情。我错过了什么吗？

干杯，唐

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-05T17:45:15.797

我认为你需要：

```
<bean id="timerFactory" class="org.springframework.scheduling.timer.TimerFactoryBean">
  <property name="scheduledTimerTasks">
    <list>
      <ref bean="templateCacheClearingTask"/>
    </list>
  </property>
</bean> 
```

除了你已经拥有的。

# vb.net - 从 IEnumerable 列表中选择 Distinct 在 .NET 2.0 中

> ID：344519
> 
> 赞同：1
> 
> 时间：2008-12-05T17:01:11.033
> 
> 标签：vb.net, ienumerable

我正在尝试过滤重复值的 IEnumerable 对象，因此我想从中获取不同的值，例如，假设它包含天数：

星期一 星期二 星期三 星期三

我想过滤它并返回：

星期一星期二星期三

在 .net 2.0 中执行此操作的最有效方法是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-05T17:06:57.840

```
Dictionary<object, object> list = new Dictionary<object, object>();
foreach (object o in enumerable)
    if (!list.ContainsKey(o))
    {
        // Do the actual work.
        list[o] = null;
    } 
```

字典将使用哈希表来保存键，因此查找是有效的。

排序最多为 O(n log(n))。具有高效散列函数的散列表通常优于它（O(1) 查找）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-05T17:08:12.377

制作另一个 IEnumerable。对原件进行排序。对于原始项目中的每一项，如果新项目不包含旧项目，则添加它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-05T17:09:02.813

另一种选择是使用 HashSet<T> - HashSet 不允许使用重复项并且不需要键/值对。

# java - javase项目中的Eclipselink问题

> ID：344524
> 
> 赞同：1
> 
> 时间：2008-12-05T17:02:11.687
> 
> 标签：java, jpa, eclipselink

运行 eclipselink 项目时出现此错误。

```
[EL 警告]：2008.12.05 11:47:08.056--java.lang.NoClassDefFoundError: org/jboss/resource/adapter/jdbc/ValidConnectionChecker 在 PersistenceLoadProcessor 尝试加载类 com.mysql.jdbc.integration.jboss 时被抛出.MysqlValidConnectionChecker。该类被忽略。

线程“主”java.lang.NoClassDefFoundError 中的异常：org/jboss/resource/adapter/jdbc/ValidConnectionChecker
        在 java.lang.ClassLoader.defineClass1（本机方法）
        在 java.lang.ClassLoader.defineClass（未知来源）
        在 java.security.SecureClassLoader.defineClass（未知来源）
        在 java.net.URLClassLoader.defineClass（未知来源）
        在 java.net.URLClassLoader.access$000（未知来源）
        在 java.net.URLClassLoader$1.run（未知来源）
        在 java.security.AccessController.doPrivileged（本机方法）
        在 java.net.URLClassLoader.findClass（未知来源）
        在 java.lang.ClassLoader.loadClass（未知来源）
        在 sun.misc.Launcher$AppClassLoader.loadClass（未知来源）
        在 java.lang.ClassLoader.loadClass（未知来源）
        在 org.eclipse.persistence.internal.jpa.deployment.PersistenceUnitProcessor.loadClass(PersistenceUnitProcessor.java:261)
        在 org.eclipse.persistence.internal.jpa.metadata.MetadataProcessor.initPersistenceUnitClasses(MetadataProcessor.java:247)
        在 org.eclipse.persistence.internal.jpa.metadata.MetadataProcessor.processEntityMappings(MetadataProcessor.java:422)
        在 org.eclipse.persistence.internal.jpa.deployment.PersistenceUnitProcessor.processORMetadata(PersistenceUnitProcessor.java:299)
        在 org.eclipse.persistence.internal.jpa.EntityManagerSetupImpl.predeploy(EntityManagerSetupImpl.java:830)
        在 org.eclipse.persistence.internal.jpa.deployment.JPAInitializer.callPredeploy(JPAInitializer.java:101)
        在 org.eclipse.persistence.internal.jpa.deployment.JPAInitializer.initPersistenceUnits(JPAInitializer.java:149)
        在 org.eclipse.persistence.internal.jpa.deployment.JPAInitializer.initialize(JPAInitializer.java:135)
        在 org.eclipse.persistence.jpa.PersistenceProvider.createEntityManagerFactory(PersistenceProvider.java:104)
        在 org.eclipse.persistence.jpa.PersistenceProvider.createEntityManagerFactory(PersistenceProvider.java:64)
        在 javax.persistence.Persistence.createEntityManagerFactory(Persistence.java:83)
        在 javax.persistence.Persistence.createEntityManagerFactory(Persistence.java:60)
        在 Main.main(Main.java:32)
引起：java.lang.ClassNotFoundException：org.jboss.resource.adapter.jdbc.ValidConnectionChecker
        在 java.net.URLClassLoader$1.run（未知来源）
        在 java.security.AccessController.doPrivileged（本机方法）
        在 java.net.URLClassLoader.findClass（未知来源）
        在 java.lang.ClassLoader.loadClass（未知来源）
        在 sun.misc.Launcher$AppClassLoader.loadClass（未知来源）
        在 java.lang.ClassLoader.loadClass（未知来源）
        在 java.lang.ClassLoader.loadClassInternal（未知来源）
        ... 24 更多

```

有任何想法吗？为什么eclipselink需要来自jboss的东西？我需要什么 jboss jar。我会使用 open jpa，但由于某种原因，在我的应用程序中退出一些持续存在后，它开始给出一堆 stackoverflow 错误。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-12-05T18:01:30.257

如果您的项目根本不应该使用 JBoss，但仍然需要一些 JBoss 类，这可能意味着：

*   您的默认服务器是 JBoss（在服务器视图中）
*   或者你的persistence.xml**[确实](http://wiki.eclipse.org/EclipseLink/Examples/JPA/JBoss_Web_Tutorial#Persistence.xml)**`yourProjectEJB/ejbModule/META-INF`引用了JBoss

# silverlight - Silverlight 中的依赖属性

> ID：344533
> 
> 赞同：2
> 
> 时间：2008-12-05T17:05:14.207
> 
> 标签：silverlight, silverlight-2.0

我很难理解 Silverlight 2 中的依赖属性。有没有人有一个很好的解释或链接可以清楚地解释 DependencyObject 和/或 DependencyProperty？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-05T18:14:32.697

**我喜欢“ Jesse Liberty - Silverlight Geek** ”博客 上的这篇文章：**[依赖属性系统 - 深入探讨第 1 部分](http://jesseliberty.com/2008/09/30/dependency-property-system-%E2%80%93-deeper-dive-part-1/)**。

它确实解释了对依赖属性的需求以及如何创建自己的属性，而无需阅读小说即可获得所需的东西。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-05T23:15:56.863

哎呀！忘记插入

[http://www.deepinconcept.net/post/2008/10/31/Silverlight-20-Dependency-Properties-And-Routed-Events.aspx](http://www.deepinconcept.net/post/2008/10/31/Silverlight-20-Dependency-Properties-And-Routed-Events.aspx)

# c - DrScheme 中如何实现尾调用优化？

> ID：344549
> 
> 赞同：3
> 
> 时间：2008-12-05T17:12:15.707
> 
> 标签：c, optimization, programming-languages, scheme, tail-call-optimization

我听说蹦床是实施 TCO 的一种无效方式。DrScheme（PLAI Scheme，技术上）是如何做到的？它是否以“正确”的方式进行（即生成直接分支到尾调用的汇编代码，而不是通过堆栈和蹦床）？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-06T03:28:50.347

MzScheme（现为 PLT Scheme）的主要实现者 Matthew Flatt 在 2008 年 6 月告诉我，他们曾经编译为虚拟机代码，在这种情况下，很容易编写一个可以进行适当尾调用的 VM。然而，现在系统已经足够成熟，在 x86 上他们使用简单的 JIT。在任何一种情况下，都没有蹦床——PLT 计划的人知道他们的业务。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-05T17:15:20.227

[PLT Scheme 的实现者在他们的Google 小组](http://groups.google.com/group/plt-scheme)中非常活跃，在那里您可以从编写代码的人那里得到快速的答复。

不过，我不确定他们是否读过，所以你最好的选择可能是在那里问。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-07T20:55:30.747

Trampolines 用于将 Scheme 代码翻译成不支持正确尾调用的目标语言 X（C、Java 等）的实现。PLT Scheme 采用 JIT 编译 - 因此不需要蹦床。对于使用的确切实施策略，请在 PLT 邮件列表中提问。

PS：您可以在[ReadScheme.org](http://readscheme.org)上提供的各种“Compile Scheme to C”论文中阅读更多关于蹦床的信息。

# regex - $1 在正则表达式中不输出任何字符

> ID：344550
> 
> 赞同：0
> 
> 时间：2008-12-05T17:12:45.037
> 
> 标签：regex

有几个人建议从 ${1} 中删除大括号，但这似乎并没有改变任何东西；1美元仍然一无所获。

我试图将括号内的内容放入 img 标记中 src 属性的值中：

```
$toc_line =~ s!<inlineFig.*?(\.\./pics/ch09_inline99_*?\.jpg)*?</inlineFig>!<img src="$1" alt="" />!g; 
```

img 标签仍然带有 src="" 而不是 src="../pics/ch09_inline99_00"。

谢谢

*请在您现有的问题中添加信息*

**重复：** [为什么在我的替换中 1 美元是空的？](https://stackoverflow.com/questions/344460/1-outputting-no-characters-in-regex-output)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-12-05T17:16:12.203

我认为您想在第二颗和第三颗星之前添加点。

# programming-languages - 为什么尾调用优化需要垃圾收集？

> ID：344557
> 
> 赞同：1
> 
> 时间：2008-12-05T17:15:05.797
> 
> 标签：programming-languages, garbage-collection, tail-call-optimization

为什么尾调用优化需要垃圾收集？是不是因为如果你在一个函数中分配内存，然后你想对它进行尾调用，就没有办法进行尾调用并重新获得该内存？（因此必须保存堆栈，以便在尾调用之后可以回收内存。）

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-12-12T18:27:51.500

像大多数神话一样，这个神话可能有一定的道理。虽然尾调用优化*不需要*GC ，但它在某些情况下肯定会有所*帮助*。假设你在 C++ 中有这样的东西：

```
int foo(int arg) {
    // Base case.

    vector<double> bar(10);
    // Populate bar, do other stuff.

    return foo(someNumber);
} 
```

在这种情况下，返回 foo(someNumber); *看起来*像一个尾调用，但是因为您使用的是 RAII 内存管理，并且您必须释放 bar，所以此行将转换为较低级别，如下所示（在非正式伪代码中）：

```
ret = foo(someNumber);
free(bar);
return ret; 
```

如果你有 GC，编译器就不需要插入指令来释放 bar。因此，这个函数可以优化为尾调用。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-12-05T17:27:33.023

你是从哪里听来的？

即使没有任何类型的垃圾收集器的 C 编译器也能够优化对其迭代等效项的尾递归调用。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-12-05T17:39:54.497

尾调用优化不需要垃圾收集。

在调用堆栈上分配的任何变量都将在递归调用中重用，因此那里没有内存泄漏。

无论是否使用尾调用优化，在堆上分配且未在尾调用之前释放的任何局部变量都会泄漏内存。无论是否使用尾调用优化，在堆上分配并在尾调用之前释放的局部变量都不会泄漏内存。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-12-06T20:53:16.307

确实，尾调用优化并不真正需要垃圾收集。

但是，假设您有 1 GB 的 RAM，并且您想要过滤 900MB 的整数列表以仅保留正数。假设大约一半是正面的，一半是负面的。

在带有 GC 的语言中，您只需编写函数。GC 会发生很多次，你最终会得到一个 450 MB 的列表。代码将如下所示：

```
list *result = filter(make900MBlist(), funcptr); 
```

make900MBlist 将被增量 GCd，因为已通过的部件过滤器不再被任何东西引用。

在没有 GC 的语言中，要保留尾递归，您必须执行以下操作：

```
list *srclist = make900MBlist();
list *result = filter(srclist, funcptr);
freelist(srclist); 
```

这最终将不得不在最终释放 srclist 之前使用 900MB + 450MB，因此程序将耗尽内存并失败。

如果您编写自己的 filter_reclaim，则会释放不再需要的输入列表：

```
list *result = filter_reclaim(make900MBlist(), funcptr); 
```

它不再是尾递归的，你可能会溢出你的堆栈。

# python - 从python中的大量xml文件中提取信息的最有效方法是什么？

> ID：344559
> 
> 赞同：3
> 
> 时间：2008-12-05T17:15:37.230
> 
> 标签：python, xml, performance, large-files, expat-parser

我有一个包含 XML 文件的完整目录（~10 ³、 10 ⁴），我需要从中提取几个字段的内容。我测试了不同的 xml 解析器，因为我不需要验证内容（昂贵），所以我想简单地使用 xml.parsers.expat （最快的）来遍历文件，一个一个地提取数据。

1.  有没有更有效的方法？（简单的文本匹配不起作用）
2.  我是否需要为每个新文件（或字符串）发出一个新的 ParserCreate() 或者我可以为每个文件重复使用相同的 ParserCreate() 吗？
3.  有什么注意事项吗？

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-08T13:01:56.507

通常，我会建议使用 ElementTree 的[`iterparse`](http://effbot.org/zone/element-iterparse.htm)，或者为了额外的速度，使用[lxml](http://codespeak.net/lxml/)中的对应物。还可以尝试使用[Processing](http://pypi.python.org/pypi/processing)（2.6 内置）来并行化。

重要的`iterparse`是您在解析元素（子）结构时得到它们。

```
import xml.etree.cElementTree as ET
xml_it = ET.iterparse("some.xml")
event, elem = xml_it.next() 
```

`event`在这种情况下将始终是字符串`"end"`，但您也可以初始化解析器，以便在解析新元素时告诉您它们的信息。您无法保证此时所有子元素都已被解析，但如果您只对此感兴趣，属性就在那里。

另一点是您可以提前停止从迭代器中读取元素，即在整个文档被处理之前。

如果文件很大（是吗？），有一个常见的习惯用法来保持内存使用量不变，就像在流解析器中一样。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-05T18:08:02.210

最快的方法是匹配字符串（例如，正则表达式）而不是解析 XML——这取决于您的 XML，这实际上可以工作。

但最重要的是：不要考虑几个选项，只需实施它们并在一个小集合上计时。这将花费大致相同的时间，并且会为您提供真实的数字，确实会推动您前进。

编辑：

*   这些文件是在本地驱动器还是网络驱动器上？网络 I/O 会在这里杀死你。
*   问题并行化很简单——您可以在多台计算机（或多核计算机上的多个进程）之间拆分工作。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-05T17:49:00.673

如果您知道 XML 文件是使用相同的算法生成的，那么根本不进行任何 XML 解析可能更有效。例如，如果您知道数据在第 3、4 和 5 行，您可以逐行阅读文件，然后使用正则表达式。

当然，如果文件不是机器生成的，或者来自不同的生成器，或者生成器随时间发生变化，那么这种方法就会失败。但是，我很乐观，它*会*更有效率。

是否回收解析器对象在很大程度上无关紧要。将创建更多对象，因此单个解析器对象并不算多。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-06T00:52:34.390

您没有指出的一件事是您是否正在将 XML 读入某种 DOM。我猜你可能不是，但如果你是，不要。请改用 xml.sax。使用 SAX 而不是 DOM 将显着提升性能。

# powershell - 数据仓库管理命令行应用程序 - PowerShell 或 C# 控制台应用程序

> ID：344561
> 
> 赞同：4
> 
> 时间：2008-12-05T17:16:12.953
> 
> 标签：powershell, console-application

我会先说这是针对 Microsoft 唯一商店的问题。

如果您要编写一个控制台应用程序来管理数据仓库，您会使用什么：
1）为 PowerShell（也就是 Exchange / SQL Server 的最新版本）编写一个自定义环境
2）将其编写为 C# 控制台应用程序

如果 #2 是否有任何框架可以为您减轻编写“菜单系统”或任何其他任务的负担。

如果这个应用程序需要持续 6 到 8 年 - 你会使用 PowerShell 吗？目前团队中没有人拥有 PowerShell 经验，但我们是快速学习者。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-05T19:19:10.770

如果您将管理功能编写为 PowerShell cmdlet，那么您可以通过让人们直接运行 cmdlet 或将它们包装在 GUI 中来展示该功能。使用 PowerShell 可能会为您提供最长期的灵活性，并且随着 MS 实施更多 PowerShell cmdlet，这意味着管理您的数据仓库可以在必要时与其他更大的业务流程合并。我可能不会选择编写 C# 控制台应用程序 - 但我有一个明显更“管理员”的观点。我们管理员已经厌倦了向我们扔自定义控制台应用程序 - PowerShell 的想法是以支持命令行和 GUI 管理的方式标准化所有内容。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-05T18:43:31.827

我认为您可以在两者上都取得成功，并且应该能够在两者之间切换而不会太麻烦。如果您开始构建控制台应用程序但后来学习 PowerShell，您可以丢弃大量控制台应用程序特定的代码（例如命令行解析代码）并构建一些 PowerShell cmdlet 来包装您现有的 API。或者，如果您构建了一堆 Cmdlet，但稍后需要切换到控制台应用程序，您将不会浪费太多时间来编写 Cmdlet。

所以，我真的没有任何强烈的建议。我会说：嘿，去试试 PowerShell。如果你不喜欢它，切换也不是太难。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-05T19:54:50.933

我发现 PowerShell 对于较小的事物来说是一种更易于维护的解决方案。控制台应用程序需要重新链接到新库，并在您依赖的库发生更改时重新编译和重新分发（在我的情况下，来自 Visual Studio 2005 - Visual Studio 2008 的代码覆盖和其他内容）以及您的脚本可能调用 vsinstr、mstest 等的可执行文件. 与 PowerShell 脚本一样，您可以轻松地为您拥有的每个环境进行自定义，而不必为您选择的每个环境进行编译、链接和部署。事实上，如果您从注册表中获取路径信息，则相同的脚本可以在两种环境中运行。

你可以做任何你想做的事情，我只是更喜欢维护一个简单的文本文件，然后是一个控制台应用程序。只是个人喜好。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-05T17:19:20.467

当您说管理数据仓库时，您指的是什么类型的任务？

我会在 T-SQL 中进行的大部分管理（清除、归档、转换）——其接口可能非常薄（甚至不存在）。

好的，根据您的评论，我将拥有在存储过程中使用 .NET 程序集（典型的 API 类库）完成所有工作的代码，尽可能多地在存储过程中，其中的程序集更容易在那里完成或者需要COM或其他什么。然后，我要么将类库包装在 cmdlet 中，要么只从 PowerShell 调用 .NET 对象（请记住，PowerShell 可以实例化对象。）。

现在你有了一个 .NET 库，如果你想要的话，它也可以从网页、GUI 应用程序等中调用，并且你有一个 cmdlet 和一个直接的 .NET 接口——如果它们是的话，还可以选择从 SQL 调用它们在 SQL 层完全实现。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-12T19:57:15.877

实现 PowerShell 而不是一个 cosole 应用程序的美妙之处在于，您不必编写所有参数解析或所有格式的代码。PowerShell 会为您处理所有这些。当然，如果需要，您可以覆盖默认值。您可以免费获得通配符。您还可以让您的 Cmdlet(s) 从管道中获取值，这为自动化开辟了各种可能性和用途。使用 PowerShell，最终用户和开发人员都将获得更好的体验。

# file-upload - gwt-ext文件上传

> ID：344580
> 
> 赞同：1
> 
> 时间：2008-12-05T17:20:00.607
> 
> 标签：file-upload, gwt-ext

我正在尝试从 gwt-ext 上传文件而不打开对话框。为此，我创建了一个 FormPanel 并向其中添加了适当的字段。然后做了一个form.submit()。这似乎不起作用。知道为什么吗？代码如下所示。

```
final FormPanel uploadForm = new FormPanel();
uploadForm.setVisible(false);
uploadForm.setFileUpload(true);
final TextField sourceFile = new TextField("File", "sourceFile");
sourceFile.setVisible(false);
sourceFile.setInputType("file");
sourceFile.setValue("/tmp/test.txt");

final TextField targetFile = new TextField("Upload As", "targetFile");
targetFile.setVisible(false);
targetFile.setValue("different.txt");

uploadForm.add(sourceFile);
uploadForm.add(targetFile);

final String url = GWT.getModuleBaseURL() + "/uploadFile";
uploadForm.getForm().submit(url, null, Connection.POST, null, false); 
```

我用一个简单的 html 表单在服务器端测试了 servlet，它工作正常。只有 GWT-EXT 版本似乎不起作用。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-12-12T19:44:42.453

我发现了为什么上面的代码不起作用。这里的主要问题是，如果上传表单尚未呈现和/或在用户单击提交按钮后表单已被修改，则由于安全原因，文件上传会被浏览器阻止。如果浏览器确实允许这样的事情，那么系统上的任何文件都可以在用户不知情的情况下轻松上传。

解决上述问题的方法是调出对话框，在提交按钮的事件处理程序和表单监听器的onActionComplete方法中进行上传，进行其他处理。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-04T14:18:18.323

没有对话框上传的整个想法对我来说似乎是一个安全漏洞。我可以想象一个应用程序在打开时窃取密码文件，如果只有上述可能的话。

# apache - 如何在 Apache 中实现适用于所有虚拟主机的全局 RewriteCond / RewriteRule？

> ID：344588
> 
> 赞同：21
> 
> 时间：2008-12-05T17:23:25.653
> 
> 标签：apache, mod-rewrite, virtualhost

标题基本概括了所有内容。:-) 我有很多虚拟主机，我想在 httpd.conf 文件的顶部放置一个重写块，无论请求可能被定向到哪个虚拟主机，它都会重写 URL。我该怎么做？

我发现[了这一点](http://www.webmasterworld.com/forum92/1359.htm)，但我的问题是一样的：如何在不使用 .htaccess 文件并为每个虚拟主机执行其他操作的情况下做到这一点？

天哪！

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2015-06-29T09:59:14.750

`RewriteOptions InheritDown`在父范围（例如 httpd.conf）中指定以在不修改子虚拟主机的情况下应用您的规则。

这仅适用于`RewriteEngine`指令设置为的虚拟主机`on`：

> 请注意，虚拟主机不会继承重写配置。这意味着您需要为希望在其中使用重写规则的每个虚拟主机设置一个 RewriteEngine on 指令。

（[来源](https://httpd.apache.org/docs/2.4/mod/mod_rewrite.html#rewriteengine)）

Apache 从 2.4.8 开始支持这一点（在原始问题出现时不可用）。

来自文档`RewriteOptions`：

> **继承下来**
> 
> 如果启用此选项，所有子配置将继承当前配置的配置。相当于在所有子配置中指定 RewriteOptions Inherit。有关如何处理父子关系的更多详细信息，请参阅继承选项。在 Apache HTTP Server 2.4.8 及更高版本中可用。
> 
> **继承之前**
> 
> 与上面的 InheritDown 类似，但当前范围的规则在任何子范围中指定的规则之前应用。在 Apache HTTP Server 2.4.8 及更高版本中可用。
> 
> **忽略继承**
> 
> 此选项强制当前和子配置忽略将从指定 InheritDown 或 InheritDownBefore 的父级继承的所有规则。在 Apache HTTP Server 2.4.8 及更高版本中可用。
> 
> （[http://httpd.apache.org/docs/current/mod/mod_rewrite.html#rewriteoptions](http://httpd.apache.org/docs/current/mod/mod_rewrite.html#rewriteoptions)）

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2011-12-12T04:46:51.060

默认情况下，来自主服务器上下文的 mod_rewrite 配置设置不会被虚拟主机继承。要将主服务器设置应用于虚拟主机，您必须在每个`<VirtualHost>`部分中放置以下指令：

```
RewriteEngine On
RewriteOptions Inherit 
```

单击[http://httpd.apache.org/docs/2.2/mod/mod_rewrite.html](http://httpd.apache.org/docs/2.2/mod/mod_rewrite.html)查找更多信息

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2009-11-20T19:50:27.307

看起来最简单的解决方案是添加

```
RewriteOptions inherit 
```

到每个 VirtualHost 指令。这至少比处理 .htaccess 文件要简单得多。Apache 非常清楚这一事实

> 默认情况下，不会继承重写配置。这意味着您需要为您希望在其中使用它的每个虚拟主机设置一个 RewriteEngine on 指令。（[http://httpd.apache.org/docs/1.3/mod/mod_rewrite.html](http://httpd.apache.org/docs/1.3/mod/mod_rewrite.html)）

显然，更改默认值的方法是通过子项（虚拟主机或导演）中的 RewriteOptions，因此您必须在每个子项中执行*一些操作。*

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2008-12-18T18:49:00.750

我从来没有测试过它，所以它可能不起作用，但我会尝试`include`在所有虚拟主机块中添加一个指令到一个文件中。您必须更改每个虚拟主机配置块一次，但在那之后，您应该有一个可以进行更改的中心位置。YMMV。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2010-07-09T14:39:25.197

如果您只是想改写名称的域部分中的某些内容，例如修复常见的拼写错误，您甚至不需要'inherit' 选项。我设置了一个无名虚拟主机来捕获所有无效的主机名并在重定向它们之前正确地重新拼写它们。

由于这使用重定向，因此将在应用重写后找到适当的虚拟主机。

```
Options +Indexes +FollowSymLinks
RewriteEngine on
# If it begins with only domain.com, prepend www and send to www.domain.com
RewriteCond %{HTTP_HOST} ^domain [NC]
RewriteRule ^(.*) http://www.domain.com$1 [L,R=301]

# Correct misspelling in the domain name, applies to any VirtualHost in the domain
# Requires a subdomain, i.e. (serviceXXX.)domain.com, or the prepended www. from above
RewriteCond %{HTTP_HOST} ^([^.]+\.)dommmmmain\.com\.?(:[0-9]*)?$ [NC]
RewriteRule ^(.*) %{HTTP_HOST}$1 [C]
RewriteRule ^([^.]+\.)?domain.com(.*) http://$1domain.com$2 [L,R=301]

# No-name virtual host to catch all invalid hostnames and mod_rewrite and redirect them
<VirtualHost *>
    RewriteEngine on
    RewriteOptions inherit
</VirtualHost> 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2018-06-02T00:08:49.353

您可能希望使用 InheritDownBefore 以避免向您的虚拟主机添加更多垃圾。

全局 letencrypt 别名的示例：

```
# letsencrypt
<IfModule alias_module>
    Alias /.well-known/ /var/www/html/.well-known/
</IfModule>
<IfModule mod_rewrite.c>
    # prevent vhost rewrites from killing the alias
    RewriteEngine On
    RewriteOptions InheritDownBefore
    RewriteCond %{REQUEST_URI} ^/\.well\-known
    RewriteRule . - [L,PT]
</IfModule> 
```

然后您可以在每个虚拟主机中执行此操作，无需其他指令：

```
<VirtualHost *:80>
    ....
    <IfModule mod_rewrite.c>
        RewriteEngine On
        RewriteRule ^/.*            /index.php [L,PT]
    </IfModule>
</VirtualHost> 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2020-02-06T22:51:08.680

谢谢楼上大家的回答。它帮助我找到了答案。

问题已经得到解答，我只是想添加一个示例，以防您使用 Google Compute Engine。它说它需要`Apache HTTP Server 2.4.8`但它适用于`Apache/2.4.25 (Debian)`. 即使我尝试升级，我也无法过去`Apache/2.4.25`。它说这个版本是最新版本。

这是一个如何实现的示例。

```
RewriteOptions InheritDown
RewriteCond %{HTTP_HOST} ^www\. [NC,OR]
RewriteCond %{HTTP_HOST} !\.co$ [NC]
RewriteCond %{HTTP_HOST} ^(?:www\.)?(.+)\.[^.]+$ [NC]
RewriteRule ^ https://%1.co%{REQUEST_URI} [L,NE,R=301]
<VirtualHost *:80>
 RewriteEngine On
 ServerAlias *.*
</VirtualHost> 
```

**另请注意（用于测试）：**

当你测试你的重写引擎时。由于缓存和cookies，很容易混淆它是否工作。如果你让它在浏览器上工作一次，即使你删除了重写代码，它也会继续工作。测试重写有时真的很烦人。您可能认为它有效，但随后它停止或启动。

测试重写代码的最佳方法是在浏览器中打开一个隐身选项卡，清除或 cookie 和缓存。打开开发者模式以防万一。不要只是刷新。您需要单击 URL 并刷新。或打开新标签。或将 URL 复制/粘贴到新窗口中。如果您使用相同的窗口进行刷新，它可能只是重做过去的结果，而不是更新新代码。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2011-06-26T02:07:26.787

我一直将“包罗万象”的 VHost 用于我想要全面的指令，比如......

```
Listen 80
NameVirtualHost *:80

<VirtualHost *:80>
ErrorLog "/var/log/apache2/error_log"
</VirtualHost>

<VirtualHost *:80>
ServerName alloftherestoftheVHosts.com
DocumentRoot "/ServiceData/.........
............ 
```

而且它*似乎*总是 有效......错误日志被正确组合，等等......但这可能是早期/冲突/志同道合的指令的结果。

个人笔记.. *想出 Apache 配置模式和语法的人是一个 dingbat，或者是一群 dingbat，他们在洞穴中花费了太多时间......整个事情应该被驱除和 XML 化，或者什么！* 尽管它们都有很大的不同...... [Cherokee](http://www.cherokee-project.com/)的 Hello-Kitty 设置过程......到恶毒简洁的[NGinx](http://nginx.net/)配置......两者都更加合乎逻辑......

# wcf - WCF 中的自签名证书问题 - 必须具有私钥

> ID：344590
> 
> 赞同：9
> 
> 时间：2008-12-05T17:24:52.703
> 
> 标签：wcf, ssl, certificate, self-signed

我正在创建一个托管在 Windows Vista SP1 上的 IIS7 中的 WCF 服务。我收到以下错误：

证书“CN=SignedByLocalHost”必须具有能够进行密钥交换的私钥。该进程必须具有私钥的访问权限。

看起来我需要对过去使用已在 Vista 中弃用的 winhttpcertcfg 完成的证书进行主机进程评估。我发现的文章表明使用证书控制台，但我缺少一些东西，因为我看不到任何编辑证书的能力。

任何帮助都会很棒！

谢谢

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-12-05T17:49:14.820

弄清楚了。

假设您在 c:\OutCert 有一个自签名证书，则以下命令将起作用。我已经离开了 -sky 交换。

makecert -sk SignedByCA -iv c:\OutCert.pvk -n "CN=MyLocalHost" -ic c:\OutCert.cer -sr LocalMachine -ss My -sky exchange pe

现在您可以进入 MMC 工具并管理私钥并授予 IIS 对密钥的访问权限。要管理私钥，请右键单击证书并选择`All Tasks / Manage Private Keys`。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2011-08-09T12:06:38.247

您可以使用 IIS 7.0/7.5 只需 Start->Run ->inetmgr 选择服务器 在“Security”面板下，转到“Server Certificates” 在左侧窗格中单击 -“Create Self Signed Certificate”并完成该过程 crtfiticate 将获得安装在**个人**商店名称下的**LocalMachine** StoreLocation 中。现在在您的 WCF 服务中使用此证书，您将不会遇到此错误

 **# build-automation - 如何使用 Nant/TeamCity 跨 DMZ 部署？

> ID：344591
> 
> 赞同：2
> 
> 时间：2008-12-05T17:26:07.067
> 
> 标签：build-automation, nant, teamcity

我在我们的域内构建了服务器（它必须是因为它还与域中的其他框通信），以及一个位于 DMZ 中的网络服务器。

作为我们构建脚本的一部分，我想使用 Nant 复制任务将网站部署到 DMZ 中的网络服务器。问题是，Nant 是从在构建服务器上的系统帐户下运行的 TeamCity 调用的，我无法找到让构建服务器系统帐户访问 DMZ 网络服务器目录的方法。（无论如何，这可能不是一个好主意）。

无论如何告诉 Nant 在不同的 Windows 用户下运行特定任务，还是有另一种解决方案来解决我的问题？

**编辑：**我遇到的另一个限制是我不能创建新的域帐户（好吧，至少在没有经过批准程序的情况下不能）。我可以创建本地计算机帐户，但在这种情况下，runas 似乎无法跨 DMZ 工作。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-07T16:58:18.027

几个选项可能是：

1.  使用[Simple Command Runner](http://www.jetbrains.net/confluence/display/TCD4/Simple+Command+Runner)执行类似[runas](http://technet.microsoft.com/en-us/library/bb490994.aspx)的命令，指定在不同用户帐户下运行的 nant.exe。
2.  更改 TeamCity 服务器运行的帐户；就像有权访问 DMZ 的有限特权用户一样。
3.  尝试使用[NAntContrib提供的](http://nantcontrib.sourceforge.net/)[`<scp`>](http://nantcontrib.sourceforge.net/release/0.85/help/tasks/scp.html)（安全复制）任务。
4.  使用 nant [`<exec`>](http://nant.sourceforge.net/release/0.85/help/tasks/exec.html)任务调用 ftp 程序，该程序将文件放在 DMZ 上。

希望这能提供一点帮助。祝你好运！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-08T16:32:17.690

您可以使用 powershell 远程处理从构建服务器中提取版本。与使用文件副本之类的推送版本相比，服务器将更不容易受到攻击。

我正在使用一个自定义应用程序来执行此操作，该应用程序登录到 teamcity 并下载工件，然后在本地使用 powershell 进行部署。

# ocs - 使用 UCMA 2.0 和 OCS 2007 自定义状态

> ID：344607
> 
> 赞同：0
> 
> 时间：2008-12-05T17:32:52.653
> 
> 标签：ocs, ucma

我最近开始使用统一通信托管 API 2.0 (UCMA) 和 Office Communication Server(OCS) 2007。我需要在我的应用程序中为我的用户创建自定义状态？你们有没有人这样做过，可以指出我正确的方向？

没有太多关于此的文档，所以我在这里挣扎。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-05T18:05:39.687

我还没有使用 2.0 API 完成任何工作，但这些帖子可能对您有用：

[Joe Calev 的博客](http://blogs.msdn.com/jcalev/archive/tags/2.0/default.aspx)（抱歉，如果您已经看过它们）

此外，这里可能有一些有用的掘金（它的 V1，但一些概念是相似的）：

[UCMA 1.0 示例应用程序](http://www.microsoft.com/downloads/details.aspx?FamilyId=16303459-DD75-451F-B7C0-FB2EB0D9A84A&displaylang=en)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-10T23:05:07.457

好的，我得到了答案。我们必须在 OCS 端执行几个存储过程才能在那里添加这些自定义存在。然后我们可以像其他所有人一样发布到那些存在！

# asp.net - 非托管 DLL 无法在 ASP.NET 服务器上加载

> ID：344608
> 
> 赞同：70
> 
> 时间：2008-12-05T17:33:27.023
> 
> 标签：asp.net, dll, iis-6, unmanaged

这个问题与一个 ASP.NET 网站有关，最初在 VS 2005 中开发，现在在 VS 2008 中开发。

该网站使用两个非托管外部 DLL，它们不是 .NET，我没有编译它们的源代码，必须按原样使用它们。

该网站在 Visual Studio 中运行良好，可以正确定位和访问这些外部 DLL。但是，当网站发布在网络服务器（运行 IIS6 和 ASP.NET 2.0）而不是开发 PC 上时，它无法定位和访问这些外部 DLL，并且我收到以下错误：

`Unable to load DLL 'XYZ.dll': The specified module could not be found. (Exception from HRESULT: 0x8007007E)`

外部 DLL 与包装它们的托管 DLL 以及网站的所有其他 DLL 一起位于网站的 bin 目录中。

搜索这个问题显示许多其他人似乎在从 ASP.NET 网站访问外部非 .NET DLL 时遇到同样的问题，但我还没有找到有效的解决方案。

我尝试了以下方法：

*   运行 DEPENDS 检查依赖关系，确定前三个在路径中的 System32 目录中，最后一个在 .NET 2 框架中。
*   我将这两个 DLL 及其依赖项放在 System32 中并重新启动服务器，但网站仍然无法加载这些外部 DLL。
*   授予网站 bin 目录的 ASPNET、IIS_WPG 和 IUSR（对于该服务器）的完全权限并重新启动，但网站仍然无法加载这些外部 DLL。
*   将外部 DLL 作为现有项目添加到项目中，并将其“复制到输出”属性设置为“始终复制”，网站仍然找不到 DLL。
*   还将他们的“构建操作”属性设置为“嵌入式资源”，网站仍然找不到 DLL。

任何有关此问题的帮助将不胜感激！

* * *

## 回答 #1

> 赞同：50
> 
> 时间：2009-05-14T05:23:51.133

发生这种情况是因为托管 dll 将影子复制到 .NET Framework 目录下的临时位置。有关详细信息，请参阅[http://msdn.microsoft.com/en-us/library/ms366723.aspx](http://msdn.microsoft.com/en-us/library/ms366723.aspx)。

不幸的是，非托管 dll 不会被复制，并且 ASP.NET 进程在需要加载它们时将无法找到它们。

一种简单的解决方案是将非托管 dll 放在系统路径中的目录中（在命令行中键入“path”以查看计算机上的路径），以便 ASP.NET 进程可以找到它们。System32 目录*始终*位于路径中，因此将非托管 dll 放在那里总是可以的，但我建议在路径中添加一些其他文件夹，然后在此处添加 dll 以防止污染 System32 目录。此方法的一大缺点是您必须为应用程序的每个版本重命名非托管 dll，并且您可以快速拥有自己的 dll 地狱。

* * *

## 回答 #2

> 赞同：42
> 
> 时间：2011-01-04T21:44:39.760

作为将 dll 放入路径中已经存在的文件夹（如 system32）的替代方法，您可以使用以下代码更改进程中的路径值

```
System.Environment.SetEnvironmentVariable("Path", searchPath + ";" + oldPath) 
```

然后，当 LoadLibrary 尝试查找非托管 DLL 时，它还将扫描 searchPath。这可能比在 System32 或其他文件夹中弄得一团糟。

* * *

## 回答 #3

> 赞同：22
> 
> 时间：2008-12-05T20:31:54.540

尝试将 dll 放在 \System32\Inetsrv 目录中。这是 Windows Server 上 IIS 的工作目录。

如果这不起作用，请尝试将 dll 放在 System32 目录中，并将依赖文件放在 Inetsrv 目录中。

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2009-04-22T16:11:58.647

添加到马特的回答中，这最终对我来说适用于 64 位服务器 2003 / IIS 6：

1.  确保您的 dll / asp.net 版本相同（32 / 64 位）
2.  将非托管 dll 放在 inetsrv 目录中（注意，在 64 位 Windows 中，这是在 syswow64 下，即使创建了 sys32/inetsrv 目录）
3.  将托管 dll 留在 /bin
4.  确保两组 dll 都具有读取/执行权限

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2008-12-05T20:37:21.753

看看[FileMon](http://technet.microsoft.com/en-us/sysinternals/bb896642.aspx)或[ProcMon](http://technet.microsoft.com/en-us/sysinternals/bb896645.aspx)并过滤麻烦的 DLL 的名称。这将向您显示在搜索 DLL 时扫描了哪些目录，以及您可能遇到的任何权限问题。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2012-06-20T16:34:30.550

另一种选择是将本机 DLL 作为资源嵌入到托管 DLL 中。这在 ASP.NET 中更为复杂，因为它需要在运行时写入临时文件夹。 [该技术在另一个 SO answer 中进行了解释](https://stackoverflow.com/a/768429/195755)。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-12-05T20:39:04.433

总是值得[检查环境设置中的路径](http://zaioo.com/Edit-the-PATH-environment-variable-on-Winows-XP-Windows-Server-2003/)变量。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2015-08-26T09:11:56.120

我遇到了同样的问题。我尝试了上述所有选项，复制到 system32、inetpub、设置路径环境等都没有奏效。这个问题最终通过将非托管 dll 复制到 web 应用程序或 web 服务的 bin 目录来解决。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2015-12-12T09:29:53.510

在为这个问题苦苦挣扎了一整天之后，我终于找到了适合我的解决方案。这只是一个测试，但方法是有效的。

```
namespace TestDetNet
{
    static class NativeMethods
    {
        [DllImport("kernel32.dll")]
        public static extern IntPtr LoadLibrary(string dllToLoad);

        [DllImport("kernel32.dll")]
        public static extern IntPtr GetProcAddress(IntPtr hModule, string procedureName);

        [DllImport("kernel32.dll")]
        public static extern bool FreeLibrary(IntPtr hModule);
    }

    public partial class _Default : System.Web.UI.Page
    {
        [UnmanagedFunctionPointer(CallingConvention.StdCall)]
        private delegate int GetRandom();

        protected System.Web.UI.WebControls.Label Label1;
        protected void Page_Load(object sender, EventArgs e)
        {
            Label1.Text = "Hell'ou";
            Label1.Font.Italic = true;
        }

        protected void Button1_Click(object sender, EventArgs e)
        {
            if (File.Exists(System.Web.HttpContext.Current.Server.MapPath("html/bin")+"\\DelphiLibrary.dll")) {
                IntPtr pDll = NativeMethods.LoadLibrary(System.Web.HttpContext.Current.Server.MapPath("html/bin")+"\\DelphiLibrary.dll");
                if (pDll == IntPtr.Zero) { Label1.Text =  "pDll is zero"; }
                else
                {
                  IntPtr pAddressOfFunctionToCall = NativeMethods.GetProcAddress(pDll, "GetRandom");
                  if (pAddressOfFunctionToCall == IntPtr.Zero) { Label1.Text += "IntPtr is zero";   }
                  else
                  {
                    GetRandom _getRandom = (GetRandom)Marshal.GetDelegateForFunctionPointer(pAddressOfFunctionToCall,typeof(GetRandom));

                    int theResult = _getRandom();

                    bool result = NativeMethods.FreeLibrary(pDll);
                    Label1.Text = theResult.ToString();
                  }
                }
          }
        }
    }
} 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-12-05T17:38:54.593

直接在 XYZ.dll 上运行 DEPENDS，在您将其部署到的位置。如果这没有发现任何缺失，请使用平台 SDK 中的 fuslogvw 工具来跟踪加载程序错误。此外，事件日志有时包含有关加载 DLL 失败的信息。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2018-06-30T21:11:21.587

在 Application_start 上使用：（根据需要自定义 /bin/x64 和 bin/dll/x64 文件夹）

```
String _path = String.Concat(System.Environment.GetEnvironmentVariable("PATH")
                ,";"
                , System.Web.Hosting.HostingEnvironment.MapPath("~/bin/x64")
                ,";"
                , System.Web.Hosting.HostingEnvironment.MapPath("~/bin/dll/x64")
                ,";"
                );
            System.Environment.SetEnvironmentVariable("PATH", _path, EnvironmentVariableTarget.Process); 
```

# javascript - 使用“溢出：自动”滚动div的位置

> ID：344615
> 
> 赞同：59
> 
> 时间：2008-12-05T17:36:52.710
> 
> 标签：javascript, html, css, scroll-position

鉴于此 HTML 片段：

```
<div id="box" style="overflow:auto; width:200px; height:200px; border:1px solid black;">
1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>9<br>10<br>
11<br>12<br>13<br>14<br>15<br>16<br>17<br>18<br>19<br>20<br>
21<br>22<br>23<br>24<br>25<br>26<br>27<br>28<br>29<br>30<br>
</div> 
```

您（通常）会得到一个带有滚动条的黑框，其中包含数字 1 到 30，每个数字都位于新行中。

您可以在该框内上下滚动。

我现在需要的是找出盒子在哪个滚动位置的可能性。假设每行 15 像素高，向下滚动到数字 10，我想要得到的结果是数字 150（15 像素 * 10 行）。

我在哪里可以找到这个号码？

我手头有普通的 JavaScript 和 jQuery。

* * *

## 回答 #1

> 赞同：93
> 
> 时间：2008-12-05T17:48:14.357

您需要使用该[`scrollTop`](https://developer.mozilla.org/en/DOM/element.scrollTop)属性。

`document.getElementById('box').scrollTop`

# c# - 忽略 ObsoleteAttribute 编译器错误

> ID：344630
> 
> 赞同：4
> 
> 时间：2008-12-05T17:44:08.577
> 
> 标签：c#

我有一个用以下属性标记的枚举值。第二个参数指示编译器在使用该值时出错。我希望任何实现我的库的人都有这种行为，但我需要在我的库中使用这个枚举值。我如何告诉编译器忽略我的库中的几个用途的过时错误。

```
public enum Choices
{
    One,
    Two,
    [ObsoleteAttribute("don't use me", true)] 
    Three,
    Four
} 
```

* * *

解决方案（谢谢大家）

```
public class EnumHack
{
  static EnumHack()
  {
    // Safety check
    if (Choices!= (Choices)Enum.Parse(typeof(Choices), "Three"))
      throw new Exception("Choices.Three != 3; Who changed my Enum!");
  }

  [Obsolete("Backwards compatible Choices.Three", false)]
  public const Choices ChoicesThree = (Choices)3;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-05T17:46:29.647

像这样私有一个单独的常量：

```
private const Choices BackwardsCompatibleThree = (Choices) 3; 
```

请注意，其他任何人都可以做同样的事情。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-19T13:48:17.187

使用#pragma 禁用特定代码周围的警告怎么样？

```
#pragma warning disable 0612
    // Call obsolete type/enum member here
#pragma warning restore 0612 
```

请注意，这仅适用于类型和枚举成员。据我所知，这不适用于其他类型成员（例如方法、属性等）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-05T17:50:23.867

我看到的是您正在将此公共枚举用于私有逻辑，并且在废弃它之后，您仍然需要在内部使用该逻辑。

我看到 2 个选项：

*   当您将其用于分支逻辑时，将其映射到私有枚举。您应该能够直接从一个投射到另一个。
*   从 int 转换它，因此永远不要在代码中使用实际的 Enum 值。

正如 Jon 在上面指出的那样，任何使用您的库的人都可以并且将（我知道您在哪里工作）无论如何都可以破解它。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-05T17:58:11.153

它可能不是世界上最漂亮的解决方案，但您可以尝试通过为枚举分配值然后强制转换您的内部调用来欺骗编译器。例如这个应用程序运行：

```
namespace ConsoleApplication
{
    class Program
    {
        static void Main(string[] args)
        {
            TestMethod((Choices)3);
        }

        private static int TestMethod(Choices choice) {
            return 1;
        }
    }

    public enum Choices
    {
        One = 1,
        Two = 2,
        [ObsoleteAttribute("don't use me", true)]
        Three = 3,
        Four = 4
    }
} 
```

我认为 Enum.Parse 可以工作，但它会出现运行时错误，所以不要这样做：

```
(Choices)Enum.Parse(typeof(Choices), "Choices.Three") 
```

我没有过时的枚举的经验，所以我建议围绕这个进行一些非常好的测试。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-05T17:57:49.127

TheSoftwareJedi 正确地指出，这不适用于将过时的属性设置为错误。以下“答案”仅在将过时通知作为警告提出时才有效。

* * *

在 Visual Studio 中，您可以基于每个项目执行此操作：

1.  转到您希望能够抑制过时警告的项目的项目属性页面。
2.  转到构建选项卡：错误和警告：抑制警告
3.  输入警告编号，在这种情况下为 0612。

其他项目将继续收到过时警告，但此项目不会。请注意，这将禁用**所有**过时的警告。

# c - 如何在C中找到解码的base64数据的大小

> ID：344634
> 
> 赞同：1
> 
> 时间：2008-12-05T17:46:02.877
> 
> 标签：c, openssl, base64

我有一个函数可以解码二进制数据中的编码 base64 数据，但我不知道如何找到解码数据的长度。我在 openssl 中使用 BIO 函数。

```
unsigned char *unbase64(unsigned char *input, int length)
{
    BIO *b64, *bmem;

    unsigned char *buffer = (unsigned char *)malloc(length);
    memset(buffer, 0, length);

    b64 = BIO_new(BIO_f_base64());
    bmem = BIO_new_mem_buf(input, length);
    bmem = BIO_push(b64, bmem);

    BIO_read(bmem, buffer, length);

    BIO_free_all(bmem);

    return buffer;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-05T17:51:56.970

BIO_read 将返回读取的字节数。无论如何，您应该始终检查返回值。

# c# - 如何以编程方式确定 IIS 站点是否正在接收请求？

> ID：344639
> 
> 赞同：6
> 
> 时间：2008-12-05T17:48:26.617
> 
> 标签：c#, iis, wmi

标题基本概括了所有内容。一些警告是：

*   我需要能够在 C# 中做到这一点
*   它需要能够从远程服务器完成（即，在一台服务器上运行，在另一台服务器上检查 IIS）
*   需要接近实时（1秒内）
*   可以使用 WMI 调用

我试过查看日志文件，但事实证明这还不够接近实时。

谢谢！

编辑：我把它放在对汤姆的回答的评论中，但在这里更明显：

我能够使用此计数器查找更改：

```
var perf = new PerformanceCounter("ASP.NET Apps v2.0.50727", "Requests Total", "_LM_W3SVC_[IIS-Site-ID]_ROOT", "[Server-Name]"); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-05T18:08:04.330

如何读取远程机器上的 ASP.NET requests/sec 性能计数器？

System.Diagnostics.PerformanceCounter 类有一个采用机器名称的构造函数。

# javascript - 在Javascript中将像素存储在椭圆中的算法是什么？

> ID：344647
> 
> 赞同：1
> 
> 时间：2008-12-05T17:50:55.880
> 
> 标签：javascript, drawing, points

如何在 JS 中画一个椭圆？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-05T17:57:33.823

[SVG](http://www.w3.org/Graphics/SVG/) .. 或小 div 和[bresenham](http://en.wikipedia.org/wiki/Bresenham%27s_line_algorithm) .. 或检查[Javascript VectorGraphics 库](http://www.walterzorn.com/jsgraphics/jsgraphics_e.htm)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-05T18:35:16.960

做矢量图的跨平台方法或多或少是使用[Dojo GFX](http://docs.dojocampus.org/dojox/gfx)（[测试](http://archive.dojotoolkit.org/nightly/dojotoolkit/dojox/gfx/tests/)、[演示](http://archive.dojotoolkit.org/nightly/dojotoolkit/dojox/gfx/demos/)、[椭圆示例](http://archive.dojotoolkit.org/nightly/dojotoolkit/dojox/gfx/tests/test_bezier.html)——所有这些链接都指向测试/调试服务器，有时可能很慢）。

# c# - 从头开始实现树

> ID：344657
> 
> 赞同：3
> 
> 时间：2008-12-05T17:55:17.243
> 
> 标签：c#, java, pointers, tree, binary-tree

我正在尝试通过从头开始实现树来了解树。在这种情况下，我想用 C# Java 或 C++ 来做。（不使用内置方法）

所以每个节点都会存储一个字符，每个节点最多有 26 个节点。

我将使用什么数据结构来包含指向每个节点的指针？

基本上我正在尝试从头开始实现基数树。

谢谢，

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-05T17:57:24.073

> > 我将使用什么数据结构来包含指向每个节点的指针？

一个节点。每个节点都应该引用（最多）树中的 26 个其他节点。在 Node 中，您可以将它们存储在数组、LinkedList、ArrayList 或您能想到的任何其他集合中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-05T18:15:09.730

这是我最近发现的一个对于树来说并不是一个糟糕的 API——虽然我需要图表，但它很容易看到它是如何设置来分离它所持有的数据的数据结构的，所以你可以拥有一个与 Iterator 等效的树在树中导航，依此类推。

[https://jsfcompounds.dev.java.net/treeutils/site/apidocs/com/truchsess/util/package-summary.html](https://jsfcompounds.dev.java.net/treeutils/site/apidocs/com/truchsess/util/package-summary.html)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-05T19:13:45.400

如果您实际上对速度比对空间更感兴趣，并且如果每个节点恰好代表一个字母（暗示您的最大值为 26），那么我只需使用一个简单的 26 个插槽数组，每个插槽都引用一个“节点”（节点是包含您的数组的对象）。

固定大小数组的好处是查找速度会更快。如果您正在查找已经保证是小写字母的 char "c"，则查找将非常简单：

```
nextNode=nodes[c-'a']; 
```

字符串的递归查找将是微不足道的。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-05T19:26:50.973

您所描述的并不是*一棵*基数树……在基数树中，一个节点中可以有多个字符，并且子节点的数量没有上限。

您所描述的内容听起来更受字母表的限制...每个节点都可以是 az，并且后面可以跟另一个字母 az 等。区别对于您选择保存下一个节点指针的数据结构至关重要。

在你描述的树中，最容易使用的结构可能是一个简单的指针数组......你需要做的就是将字符（例如'A'）转换为其ascii值（'65'），然后减去开始偏移量（65）以确定您想要的“下一个节点”。占用更多空间，但插入和遍历速度非常快。

在真正的基数树中，您可能有 3、4、78 或 0 个子节点，并且您的“下一个节点”列表将具有排序、插入和删除的开销。慢得多。

我不会说 Java，但如果我在 C# 中实现自定义基数树，我会使用内置的 .NET 集合之一。编写自己的排序列表并不能真正帮助您学习树的概念，而且 .NET 集合的内置优化很难被击败。然后，您的代码很简单：查找下一个节点；如果存在，抓住它就走；如果没有，请将其添加到下一个节点集合中。

您使用哪个集合取决于您通过树实现的具体内容......每种类型的树都涉及插入时间、查找时间等之间的权衡。您所做的选择取决于对应用程序最重要的内容，而不是树.

有道理？

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-12-05T23:32:49.153

感谢您的快速回复。

是的，snogfish 说的是正确的。基本上，它是一棵有 26 个节点 (AZ) + 一个 bool isTerminator 的树。

每个节点都有这些值，并且它们相互链接。

我还没有深入学习指针，所以我今天尝试使用 C# 中的不安全代码从头开始实现这一点，但徒劳无功。

因此，如果有人能为我提供使用内部树类开始使用 C# 的代码，我将不胜感激。一旦我可以开始使用它，我就可以将算法移植到其他语言，然后将其更改为使用指针。

非常感谢，迈克尔

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-05T18:00:09.293

这并不重要。您可以使用链接列表、数组（但这将具有固定大小）或您语言的标准库中的 List 类型。

使用列表/数组将意味着做一些索引簿记来遍历树，所以最简单的方法可能是只保留对父项中子项的引用。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-12-05T19:18:27.903

看看这个 Simeon Pilgrim 博客，“[代码营拼图回顾](http://simeonpilgrim.com/blog/index.php/category/code-camp/)”。其中一个解决方案使用 C# 中的 Radix，您可以下载该解决方案。

# sql - 如何找到未关闭的连接？超时已过。操作完成前超时时间已过或服务器无响应

> ID：344659
> 
> 赞同：3
> 
> 时间：2008-12-05T17:56:57.240
> 
> 标签：sql, debugging, timeout, sqlconnection

我以前遇到过这个问题，发现基本上我的连接关闭得不够快（让连接保持打开状态并等待垃圾收集并不是最佳实践）。

现在我又得到了它，但我似乎找不到我在哪里打开我的连接。当看到错误时，数据库已经清除了旧连接，所以我看不到最后一个命令所有锁定的连接（上次我遇到这个问题时非常有帮助）。

知道如何检测我的代码或数据库来跟踪正在发生的事情，以便找到我的违规代码吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-05T18:18:55.930

您提供的错误并不真正指向打开的连接；更有可能是查询花费的时间比应用程序预期的要长。您可以增加它等待响应的时间，并且您可以使用 Sql 来查找哪些查询是最费力的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-05T18:24:19.133

希望你有一个数据访问层类，而不是一大堆类，每个类都创建自己的连接，对吧？您使用什么语言？如果您使用 C#，则导致此问题的最大原因是 DataReaders 并将这些对象返回给上层。很可能某些客户端类没有关闭它从您的 DAL 类接收到的 DataReader，使连接打开/锁定了谁知道多长时间。追踪您返回的 DataReader 并确保您的客户端类正确关闭/处理它们。

我还开始考虑通过实现 Disposable 模式并可能返回 POCO 而不是 Data (...Tables, ...Sets, ...Readers) 对象来重新设计您的数据访问层。

# biztalk - 恢复 BizTalk 脱水编排

> ID：344664
> 
> 赞同：3
> 
> 时间：2008-12-05T17:58:08.983
> 
> 标签：biztalk

如何恢复脱水的编排？

*   有问题的编排应该是从 MSMQ 队列中检索消息
*   但是队列上没有设置用户标识权限，所以 BizTalk 框无法从队列中读取

更正了权限，但唯一的选项是 teminate 和 suspend ？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-06T00:05:41.100

如果编排尝试启动并在 MSMQ 接收上失败，则它实际上已挂起并且尚未从队列中删除消息。我会终止它。编排应该清除并拾取新消息。您的编排是实现单例模式还是在接收时使用有序交付？这使事情变得更复杂一些。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-10-20T03:15:10.753

您不应该重新启动 MSMQ 的 biztalk 服务实例吗？

脱水意味着编排仍在等待某些东西。我想在您的情况下，您必须等待来自 MQ 的相关消息。如果重新启动接收主机服务实例，它将尝试重新连接所有连接（由服务实例管理的 MSMQ、SQL 等）。然后所有消息都将流向编排。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-05T19:09:04.910

**更新1：**

检查相关的接收位置。由于权限问题，它可能被 biztalk 禁用。您必须手动启用它。

**更新0：**

您不必恢复脱水的编排。从队列中读取的不是编排，而是 msmq 适配器。当 msmq 消息到达时，接收位置会将其路由到消息框。如果所述编排有一个与 msmq 消息匹配的订阅（接收端口），那么它将由 biztalk 引擎恢复。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-05T18:01:59.413

你能暂停，然后恢复吗？

自从我做 BizTalk 以来已经有几年了。像这样的怪癖很烦人。更糟糕的是，当它脱水了 250k 并且您需要编写脚本来重新启动它们时。啊

我对你有感觉。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-06T10:17:00.100

BizTalk 能否恢复取决于它失败的地方和方式，以及它是否可以重播操作的任何部分；在大多数情况下，当编排失败时，需要使用一些编码模式来使其恢复。

# sql - 获取 SQL 中另一列的每个值的最常见值

> ID：344665
> 
> 赞同：31
> 
> 时间：2008-12-05T17:58:10.857
> 
> 标签：sql, postgresql, greatest-n-per-group

我有一张这样的桌子：

```
 Column  | Type | Modifiers 
---------+------+-----------
 country | text | 
 food_id | int  | 
 eaten   | date | 
```

对于每个国家，我都想获得最常吃的食物。我能想到的最好的（我正在使用 postgres）是：

```
CREATE TEMP TABLE counts AS 
   SELECT country, food_id, count(*) as count FROM munch GROUP BY country, food_id;

CREATE TEMP TABLE max_counts AS 
   SELECT country, max(count) as max_count FROM counts GROUP BY country;

SELECT country, max(food_id) FROM counts 
   WHERE (country, count) IN (SELECT * from max_counts) GROUP BY country; 
```

在最后一条语句中，需要 GROUP BY 和 max() 来打破关系，其中两种不同的食物具有相同的计数。

对于概念上简单的东西，这似乎需要做很多工作。有没有更直接的方法来做到这一点？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2017-04-25T14:40:13.223

现在更简单了：PostgreSQL 9.4 引入了这个`mode()`函数：

```
select mode() within group (order by food_id)
from munch
group by country 
```

返回（如 user2247323 的示例）：

```
country | mode
--------------
GB      | 3
US      | 1 
```

请参阅此处的文档： [https ://wiki.postgresql.org/wiki/Aggregate_Mode](https://wiki.postgresql.org/wiki/Aggregate_Mode)

[https://www.postgresql.org/docs/current/static/functions-aggregate.html#FUNCTIONS-ORDEREDSET-TABLE](https://www.postgresql.org/docs/current/static/functions-aggregate.html#FUNCTIONS-ORDEREDSET-TABLE)

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2012-09-16T17:17:31.617

PostgreSQL 在 8.4 中引入了对[窗口函数](http://www.postgresql.org/docs/current/static/functions-window.html)的支持，也就是提出这个问题的第二年。值得注意的是，今天可能会解决如下：

```
SELECT country, food_id
  FROM (SELECT country, food_id, ROW_NUMBER() OVER (PARTITION BY country ORDER BY freq DESC) AS rn
          FROM (  SELECT country, food_id, COUNT('x') AS freq
                    FROM country_foods
                GROUP BY 1, 2) food_freq) ranked_food_req
 WHERE rn = 1; 
```

以上将打破关系。如果你不想打破平局，你可以使用 DENSE_RANK() 代替。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2008-12-05T18:44:03.150

```
SELECT DISTINCT
"F1"."food",
"F1"."country"
FROM "foo" "F1"
WHERE
"F1"."food" =
    (SELECT "food" FROM
        (
            SELECT "food", COUNT(*) AS "count"
            FROM "foo" "F2" 
            WHERE "F2"."country" = "F1"."country" 
            GROUP BY "F2"."food" 
            ORDER BY "count" DESC
        ) AS "F5"
        LIMIT 1
    ) 
```

嗯，我写的很匆忙，并没有仔细检查它。子选择可能很慢，但这是我能想到的最短和最简单的 SQL 语句。当我不那么醉时，我可能会告诉更多。

PS：哦，“foo”是我的表名，“food”包含食物的名称，“country”包含国家/地区的名称。样本输出：

```
 food    |  country   
-----------+------------
 Bratwurst | Germany
 Fisch     | Frankreich 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2008-12-06T19:36:27.787

尝试这个：

```
Select Country, Food_id
From Munch T1
Where Food_id= 
    (Select Food_id
     from Munch T2
     where T1.Country= T2.Country
     group by Food_id
     order by count(Food_id) desc
      limit 1)
group by Country, Food_id 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-12-05T21:31:29.490

```
select country,food_id, count(*) ne  
from   food f1  
group by country,food_id    
having count(*) = (select max(count(*))  
                   from   food f2  
                   where  country = f1.country  
                   group by food_id) 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-12-05T18:17:57.087

尝试这样的事情

```
select country, food_id, count(*) cnt 
into #tempTbl 
from mytable 
group by country, food_id

select country, food_id
from  #tempTbl as x
where cnt = 
  (select max(cnt) 
  from mytable 
  where country=x.country 
  and food_id=x.food_id) 
```

这可以全部放在一个选择中，但我现在没有时间处理它。

祝你好运。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2008-12-05T18:23:30.213

以下是在没有任何临时表的情况下执行此操作的方法：

*编辑：简化*

```
select nf.country, nf.food_id as most_frequent_food_id
from national_foods nf
group by country, food_id 
having
  (country,count(*)) in (  
                        select country, max(cnt)
                        from
                          (
                          select country, food_id, count(*) as cnt
                          from national_foods nf1
                          group by country, food_id
                          )
                        group by country
                        having country = nf.country
                        ) 
```

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2008-12-05T20:50:05.813

```
SELECT country, MAX( food_id )
  FROM( SELECT m1.country, m1.food_id
          FROM munch m1
         INNER JOIN ( SELECT country
                           , food_id
                           , COUNT(*) as food_counts
                        FROM munch m2
                    GROUP BY country, food_id ) as m3
                 ON m1.country = m3.country
         GROUP BY m1.country, m1.food_id 
        HAVING COUNT(*) / COUNT(DISTINCT m3.food_id) = MAX(food_counts) ) AS max_foods
  GROUP BY country 
```

我不喜欢 MAX(.) GROUP BY 打破关系...必须有一种方法可以将吃过的日期以某种方式合并到 JOIN 中，以任意选择最近的一个...

如果您在实时数据上运行它，我对这个东西的查询计划很感兴趣！

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2016-04-13T15:30:58.470

这是一个声明，我相信它可以满足您的需求，并且简单明了：

```
select distinct on (country) country, food_id
from munch
group by country, food_id
order by country, count(*) desc 
```

请让我知道你的想法。

顺便说一句，*独特的*功能仅在 Postgres 中可用。

示例，源数据：

```
country | food_id | eaten
US        1         2017-1-1
US        1         2017-1-1
US        2         2017-1-1
US        3         2017-1-1
GB        3         2017-1-1
GB        3         2017-1-1
GB        2         2017-1-1 
```

输出：

```
country | food_id
US        1
GB        3 
```

# javascript - JS中以螺旋形式存储像素的算法是什么？

> ID：344672
> 
> 赞同：0
> 
> 时间：2008-12-05T17:59:22.197
> 
> 标签：javascript, algorithm, drawing, spiral

JS中以螺旋形式存储像素的算法是什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-05T20:00:16.443

[http://www.mathematische-basteleien.de/spiral.htm](http://www.mathematische-basteleien.de/spiral.htm)

```
var Spiral = function(a) {
    this.initialize(a);
}

Spiral.prototype = {
    _a: 0.5,

    constructor: Spiral,

    initialize: function( a ) {
       if (a != null) this._a = a;
    },

    /* specify the increment in radians */
    points: function( rotations, increment ) {
       var maxAngle = Math.PI * 2 * rotations;
       var points = new Array();

       for (var angle = 0; angle <= maxAngle; angle = angle + increment)
       {
          points.push( this._point( angle ) );
       }

       return points;
    },

    _point: function( t ) {
        var x = this._a * t * Math.cos(t);
        var y = this._a * t * Math.sin(t);
        return { X: x, Y: y };
    }
}

var spiral = new Spiral(0.3);
var points = spiral.points( 2, 0.01 );

plot(points); 
```

* * *

[http://myweb.uiowa.edu/timv/spiral.htm](http://myweb.uiowa.edu/timv/spiral.htm)的示例实现

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-05T19:08:41.680

这个问题有几个问题。首先是你并没有真正具体说明你在做什么。

1) Javascript 并不是真正的存储介质，除非您希望使用 JSON 传输像素，在这种情况下，您可能需要重新表述以明确说明这一点。

2）没有提到你期望螺旋看起来像什么 - 我们是在谈论松散螺旋还是紧密螺旋？单色或渐变或一系列颜色？你在看一个弯曲的螺旋还是一个矩形？

3）这里的最终目标是什么？您是想直接使用 JS 绘制螺旋还是将其传输到其他地方？

# multithreading - 线程和进程

> ID：344682
> 
> 赞同：4
> 
> 时间：2008-12-05T18:03:52.157
> 
> 标签：multithreading, process

线程的最佳定义是什么？什么是进程？如果我调用一个函数，我怎么知道一个线程正在调用它或一个进程（或者我不理解它？？！）。这是在多核系统（四核）中。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-12-05T18:08:06.233

来自[http://wiki.answers.com/Q/What_is_the_difference_between_a_computer_process_and_thread](http://wiki.answers.com/Q/What_is_the_difference_between_a_computer_process_and_thread)：

单个进程可以拥有多个线程，这些线程与运行在同一进程中的其他线程共享全局数据和地址空间，因此可以轻松地对同一数据集进行操作。进程不共享地址空间，如果它们要共享数据，则必须使用不同的机制。

如果我们将运行文字处理程序视为一个进程，那么后台发生的自动保存和拼写检查功能是该进程的不同线程，它们都在同一数据集（您的文档）上运行。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-12-05T19:24:02.867

要添加的一件事是多核处理器如何处理这个问题。将线程视为代码的顺序执行。

CPU 中的一个核心一次只能执行一个线程。因此，如果该线程因为程序正在等待 I/O 操作完成而被阻塞，则该进程被阻塞（非常简单的示例：Word 无响应）。多线程允许我们同时执行多个代码路径。“Same time”有点假，因为在一个内核中一次实际上只能执行一个线程，但 CPU 会为每个线程分配一小部分时间，所以看起来好像所有这些线程都在同一时间执行同时。Word 中的拼写检查器就是一个很好的例子。

如果您有多个内核，唯一的区别是在 N 核 CPU 中，您可以同时执行 N 个线程。为了简化很多，线程属于哪个进程并不重要。更简单地说，您预计性能会提高 N 倍。:-D

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-05T18:31:23.880

在我所知道的每一个现代操作系统中，一切都在一个线程中运行，该线程在一个进程中运行。操作系统可以跟踪多个进程，每个进程可以托管任意数量的线程。所以所有代码都在一个线程*和*一个进程内执行（因为线程在一个进程中运行）。

两者的主要区别在于每个进程都有自己的虚拟地址空间。单独的进程无法访问彼此的数据、文件句柄或其他任何东西，并且基本上不知道存在其他进程。

另一方面，进程中的每个线程共享相同的地址空间，因此所有线程都可以检查或修改彼此的数据，调用相同的函数以及其他一切。

通常（但不总是）一个程序由一个进程和多个线程组成。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-05T18:35:12.717

一个进程由一个或多个线程组成（大多数环境默认为一个）。但是，一个进程可以创建额外的线程。

就像前面的答案所说，每个进程都有自己的内存空间（每个进程都有一个指向 0x12345 的指针，每个进程的内存位置具有不同的值），而进程的所有线程实际上都指向完全相同的内存位置，因为它们都在同一个内存空间中。

调用函数时，几乎总是在调用者运行的同一线程上调用它。在 Objective-C 中，有例外（performSelectorOnMainThread），其他语言也可能有，但只有在特殊情况下才需要这种功能。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-12-05T18:50:35.603

从用户的角度来看，主要区别在于线程彼此共享内存，而进程则不共享。这意味着您可以轻松地在线程之间共享数据，而进程需要某种操作系统调用才能做到这一点。

有人称这是线程的好处，但在多个控制线程之间共享数据充满危险，因此可以说进程导致代码更可靠。

它还有很多其他功能，特别是如果您是操作系统人员。

# sql-server - 非常大的表的 SQL Server 事务复制

> ID：344684
> 
> 赞同：1
> 
> 时间：2008-12-05T18:03:59.643
> 
> 标签：sql-server, replication

我已经在相对较慢的 VPN 连接的不同端的两个 SQL Server 之间设置了事务复制。设置是您的标准“立即加载快照”类型的事情，它在初始化订阅后做的第一件事是删除并重新创建订阅者端的所有表，然后开始对所有数据进行 BCP。问题是有几张表中有几百万行，并且该过程要么 a) 需要很*长时间*，要么 b) 完全失败。当我查看复制监视器时，我不断收到的消息是：

*   该进程正在运行并正在等待来自服务器的响应。
*   查询超时已过期
*   初始化

然后它会尝试重新启动批量加载过程（跳过它已经加载的任何 BCP 文件）。

我目前被困在它一遍又一遍地这样做的地方。它已经运行了几天了。

我的问题是：

1.  鉴于网络连接速度如此之慢，我能做些什么来改善这种情况吗？也许一些设置或什么？只要过程不超时，我不介意等待很长时间。

2.  有一个更好的方法吗？也许做一个备份，压缩它，复制它然后恢复？如果是这样，复制过程如何知道在开始应用事务时从哪里获取，因为更新将在我进行备份和恢复并在另一端运行之间发生。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-05T21:34:28.423

是的。您可以[手动应用初始快照](http://msdn.microsoft.com/en-us/library/aa237138(SQL.80).aspx)。

对我来说已经有一段时间了，但是链接（到 BOL）可以替代设置订阅者。

编辑：从 BOL How-tos，[从备份初始化事务订阅者](http://msdn.microsoft.com/en-us/library/ms147834(SQL.90).aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-07T17:14:10.443

在 SQL 2005 中，您有一个“紧凑快照”选项，可让您减小快照的总大小。当通过网络应用时，快照项目“旅行”压缩到订阅者，然后在订阅者处展开。

我认为您可以通过比较标准快照和压缩快照的大小来轻松计算潜在的速度增益。

顺便说一句，对于合并复制，[这里](https://stackoverflow.com/questions/125849/ms-sql-server-2005-initializing-a-merge-subscription-with-alternate-snapshot-lo)有一个（非常）类似的问题，但我认为在快照级别没有区别。

# .net - 使用 javascript 触发 silverlight 事件

> ID：344686
> 
> 赞同：3
> 
> 时间：2008-12-05T18:04:13.963
> 
> 标签：.net, javascript, silverlight

我可以在页面中使用 javascript 来触发 silverlight 组件中的事件吗？如果是这样，有人有一些代码示例吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-05T18:21:26.817

是的你可以。您需要使用“ScriptableMember”属性在 .NET 代码中的类上装饰一个方法，然后在您的对象上调用 HtmlPage.RegisterScriptableObject 以将其标记为与 javascript 的互操作性。您将创建名为 OnMyEvent(sender As Object, e As MyEventArgs) 之类的 .NET 方法，该方法随后会引发您想要的对象事件。然后你的 javascript 会调用它。

请参阅此链接以获取演练： http: [//msdn.microsoft.com/en-us/library/cc221414 (VS.95).aspx](http://msdn.microsoft.com/en-us/library/cc221414(VS.95).aspx)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-05T18:57:50.190

视频演练在这里：[http ://silverlight.net/learn/learnvideo.aspx?video=65683](http://silverlight.net/learn/learnvideo.aspx?video=65683)

# svn - Subversion：存储库的预期格式“3”；找到格式“5”

> ID：344691
> 
> 赞同：1
> 
> 时间：2008-12-05T18:05:11.560
> 
> 标签：svn, administration

好吧，我已经让自己陷入困境

我做了[颠覆 1 点击设置](http://svn1clicksetup.tigris.org/)，效果很好。但是，在设置我的存储库时，我不小心提交了一个我不应该拥有的文件。我没有跳过清除文件的麻烦，而是删除了存储库，并[按照我的建议](https://stackoverflow.com/questions/344406/how-to-drop-and-create-new-repositories-with-a-subversion-server)使用“svnadmin create”重新创建了它。

但是，现在我收到了臭名昭著的存储库预期格式“3”；当我尝试导入到存储库时发现格式“5”错误，或者只是浏览它。

当我尝试卸载 subversion 以便我可以重新运行 1 单击设置时，卸载失败并且 1 单击设置不会覆盖已经存在的内容。

从谷歌搜索来看，这似乎是某种版本控制错误，但我不明白这是怎么回事，因为我只安装了一个版本。

有人可以帮忙吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-05T18:28:53.213

看起来“一键设置”是基于旧版本的 SVN，但不知何故，您还拥有一个更新版本的 svnadmin，它创建了一个更新的存储库。

我无法帮助您解决安装/卸载失败的问题，但是当您最终摆脱一键式安装的所有碎屑时，我会再试一次，使用更新的东西。

这是一个不错的软件包中的更新版本：

[http://www.collab.net/downloads/subversion/](http://www.collab.net/downloads/subversion/)

这是一个 .ZIP 文件中的相同内容，其中包含您需要的所有位：

[http://subversion.tigris.org/servlets/ProjectDocumentList?folderID=91](http://subversion.tigris.org/servlets/ProjectDocumentList?folderID=91)

# .net - 寻找实时网络服务器分析包

> ID：344693
> 
> 赞同：3
> 
> 时间：2008-12-05T18:06:17.597
> 
> 标签：.net, asp-classic, iis-6, analytics, iis-logs

我是县医院教育部门的程序员。我希望能够在只能在内部访问的 IIS6 Web 服务器上查看一些实时统计信息。我正在寻找类似于 1and1.com 为其客户提供的服务（如果您熟悉他们提供的服务）。

我有一个基于经典 ASP/VBScript 的学习管理系统，我想做一些流量分析，我尝试的最后一个包（它的站点不再存在）运行了一年，然后开始大幅减慢服务器。

没有特别的顺序，我想：

*   我想跟踪谁访问了我们打开了基本身份验证的页面（可选）
*   我想跟踪最常访问的页面
*   我希望能够逐页跟踪给定个人的进度。这是我用旧工具做的事情，发现它非常有用。
*   我想查看浏览器的基本统计信息：窗口大小、颜色深度、类型等。我知道我们的 IST 部门*说*我们都在使用 IE6，并且他们*说*最后一个包显示的其他一些统计信息要少一些比正确。我想知道我需要处理什么。
*   我希望不必远程访问服务器来运行 .exe 或我见过的任何其他有趣、复杂的解决方案......

虽然我更喜欢 ASP/VBScript 解决方案，以便在需要时更轻松地修复它，但我愿意使用基于 PHP 或 ASP.NET 的解决方案，如果我能动手的话。我偶然发现了几个 ASP.NET 包，其中一些看起来可能值得。

先发制人，我想继续说：

*   不，我不会放弃 ASP/VBScript，因为我是唯一的开发人员，只是没有时间。
*   请不要对 IE6 发表评论。它毫无意义，因为我对此无能为力。
*   不，我不能使用 Google Analytics。这是内部的，所以我无法在我的服务器上安装的所有选项都没有了。这是没有商量余地的。
*   所有类似谷歌分析的程序也都出来了。**任何需要回击某些外部服务的东西都已经过时了。**
*   PERL 没有安装，我也不愿意安装。这个不讨论了。

我确定有一些细节我忘记添加到问题中，但我会在我记得时添加它。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-05T19:38:45.507

据我所知，[Splunk](http://www.splunk.com/article/2000)是该领域最好的参与者之一。您每天最多可以免费使用 500MB 的日志。[OSSec](http://www.ossec.net/)的重点稍有不同（入侵检测），但也可能对您的（看似基本的）目的有用。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-27T23:10:33.257

[Piwik](http://piwik.org/) “旨在成为 Google Analytics 的开源替代品。”

它需要 PHP 和 MySQL（将其托管在您自己的服务器上）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-24T15:59:06.987

我在许多网站上使用[Woopra](http://www.woopra.com/)。它显示了丰富的实时信息，甚至可以让您与站点用户进行交互。这是[全屏截图](https://i.stack.imgur.com/gMtpV.jpg)。

![截屏](https://i.stack.imgur.com/gMtpV.jpg)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-12-07T01:47:50.803

试试 Feedjit。付费小部件每月 10 美元，您可以获得您要求的所有统计信息，并且您可以看到用户从一个页面浏览到另一个页面。Feedjit 自己的流量在这里使用商业选项的现场演示：

[http://feedjit.com/pro/feedjitpub/](http://feedjit.com/pro/feedjitpub/)

还有一个免费的小部件。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-05T18:58:26.430

这是我用来分析我的网络日志的产品......它本身不是“实时”的，但它可以配置为运行服务并定期生成报告......

[http://www.nihuo.com/web-log-analyzer.html](http://www.nihuo.com/web-log-analyzer.html)

最重要的是，它并不昂贵:)

[他们在这里](http://www.nihuo.com/sample/index.html)有一份在线样本报告，因此您可以查看它是否是您所追求的。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-03T21:47:26.867

最终选择了[SmarterStats](http://www.smartertools.com/SmarterStats/Features/Web-Log-Analytics-Website-Statistics.aspx)，如下所述：

[IIS监控工具](https://stackoverflow.com/questions/915207/iis-monitoring-tool/915645#915645)

它对一个站点免费（这是我需要监控的全部内容），它几乎可以跟踪我需要跟踪的所有内容，并且到目前为止它运行得非常好。

谢谢大家的答案。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-06-03T23:47:11.447

查看 VisiStat。实时和托管。实时支持和出色的客户服务。Woopra 有一个您需要参与才能获得的列表。它也是一个可能永远不会发布的 BETA 应用程序。VisiStat 是第 6 版并公开提供。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2010-07-12T03:40:01.943

我最近偶然发现了 Chart Beat：

[http://chartbeat.com/](http://chartbeat.com/)

一些大公司使用它们（mahalo等）

这不是一项免费服务（他们的网站说每月 9.95 美元？）

# robots.txt - Googlebots 忽略 robots.txt？

> ID：344697
> 
> 赞同：8
> 
> 时间：2008-12-05T18:08:07.153
> 
> 标签：robots.txt, googlebot, robot

我在根目录中有一个包含以下 robots.txt 的站点：

```
User-agent: *
Disabled: /

User-agent: Googlebot 
Disabled: /

User-agent: Googlebot-Image
Disallow: / 
```

Googlebots 全天都在扫描此站点中的页面。我的文件或 Google 有问题吗？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2008-12-05T18:11:43.730

应该是`Disallow:`，不是`Disabled:`。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-12-05T18:12:37.287

也许试试[Google robots.txt 检查器](http://www.google.com/support/webmasters/bin/answer.py?answer=35237)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-05T18:11:52.077

Google 有一个用于检查 robots.txt 条目的分析工具，[请在此处阅读](http://www.google.com/support/webmasters/bin/answer.py?answer=35237&ctx=sibling)

您可能还想检查“流氓”机器人的 IP 地址，看看它们是否真的归 ​​Google 所有。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-20T23:26:52.960

此外，我相信机器人会进入页面并采用适用于它的第一个指令。在您的情况下，Googlebot 和 Googlebot-Image 永远不会看到他们的具体指令，因为他们会首先尊重“用户代理：*”。

**无视这个答案。我发现信息表明情况并非如此。机器人应该找到特定于它的指令并尊重它**

# user-interface - 你使用什么可用性评估方法？

> ID：344702
> 
> 赞同：-1
> 
> 时间：2008-12-05T18:12:12.060
> 
> 标签：user-interface, usability, evaluation

你使用什么可用性评估方法？

*   戈姆斯？
*   认知演练？
*   大声思考协议？

其他的？（除了“问你妈妈”的提示，这些提示在 SO 的其他地方都有很好的介绍）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-05T22:05:31.573

1.  狗食。使用我们自己的应用程序，我们可以快速找出哪些部件笨重或使用不便。

2.  记录和分析支持电话，并跟踪用户在使用或查找应用程序的哪些部分时遇到问题。

3.  可用性测试。我们写下一个任务，尽可能接近实际用例，并要求一些用户执行它。我们看着他们做，让他们在做的时候大声思考，然后问他们很多问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-05T07:09:30.443

GOMS 对于大多数任务来说太重了（而且离现实太远了）......我建议像 joel spolsky 所倡导的那样更轻量级的东西，比如走廊可用性测试：

[http://www.joelonsoftware.com/articles/fog0000000043.html](http://www.joelonsoftware.com/articles/fog0000000043.html)

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2008-12-05T23:15:54.053

用纸片构建 UI。创建多个任务场景 - 可能不要期望一口气覆盖整个 UI。根据目标受众找到好的测试对象（这可能是最难的部分）。为所述主题提供打印的议程.. 提供一个充当“帮助系统”的人，但要保持安静.. 要求主题“大声思考” - 说出他们的大脑在做什么（为什么很难找到好的主题） ..视频发生了什么并分析。..修复东西，然后迭代。

# flash - 使用 Adob e AIR 构建插件架构

> ID：344705
> 
> 赞同：16
> 
> 时间：2008-12-05T18:12:37.707
> 
> 标签：flash, air, flex3, dynamic-loading, plugin-architecture

我正在考虑选择 Adob​​e AIR 作为即将到来的项目的客户端实施技术。（之前的选择是 C# 和 WPF，但最近我对 Flash/Flex/AIR 印象深刻。）

但我的产品最重要的特性之一将是它的插件架构，它允许第三方开发人员以有趣的方式扩展功能和 GUI。

我知道如何在 C# 中设计架构：插件加载器将枚举本地“app/plugins/”目录中的所有程序集。对于每个程序集，它会枚举所有类，寻找“IPluginFactory”接口的实现。对于工厂创建的每个插件，我会询问它的 MVC 类，并将其 GUI 元素（菜单项、面板等）插入现有 GUI 布局中的适当插槽中。

我想在 AIR 中完成同样的事情（从本地文件系统加载插件，而不是从网络加载插件）。阅读[本文](http://www.adobe.com/devnet/air/articles/introduction_to_air_security.html)后，我的理解是这是可能的，并且基本架构（将 SWF 加载到沙盒应用程序域等）与您在 .NET 中执行的方式非常相似。

但我对这些问题很好奇。

如果你们中的任何人使用 flash 播放器进行了任何动态类加载（最好在混合 flash/flex 应用程序中，特别是在 AIR 主机中），我很想听听您构建插件框架的经验以及遇到棘手情况的地方使用 flash 播放器，以及使用 flash、flex 和 AIR API。

例如，如果有人问我同样的问题，但考虑到 Java 平台，我肯定会提到 JVM 没有“模块”或“程序集”的概念。最高级别的聚合是“类”，因此很难在插件系统中创建组织结构来管理大型项目。我还将讨论多个类加载器的问题，以及每个类加载器如何维护自己的加载类的单独实例（具有自己的单独静态变量）。

* * *

以下是一些对我来说仍然没有答案的具体问题：

1) 动作脚本“Loader”类可以将 SWF 加载到 ApplicationDomain。但是那个 appdomain 到底包含什么？模块？上课？MXML 组件是如何表示的？如何找到所有实现我的插件接口的类？

2）如果您已将插件加载到与主应用程序不同的 ApplicationDomain 中，那么从该其他应用程序域中调用代码是否会更加复杂？对于可以通过跨应用程序域编组层的数据类型是否有任何重要限制？编组是不是非常昂贵？

3) 理想情况下，我想将我自己的大部分主代码开发为插件（主应用程序只不过是一个插件加载外壳），并使用插件架构将该功能提升到应用程序中。是不是让你心里产生了恐惧？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-12-05T21:02:15.603

1.  applicationDomain 更像是一个命名空间，它将类定义分组并将它们放入层次结构中：一个域可以直接访问它自己的域或父域中的符号，但**不能**访问子域或兄弟域（或者更好：它可以' t 直接这样做 - 它必须通过 applicationDomain 对象，询问给定类的定义）；加载外部 swf 时，您可以决定将新符号放在*何处*：子域（默认）、附加到系统的新域（使用 null）、*当前*域、附加到其他地方的域（显式传递新域）。请注意，新符号永远不会覆盖当前域中的符号，但同名可以存在于多个域中。
    不幸的是，您无法枚举给定域中的类（好吧，至少我不知道有什么方法），但常见的解决方案是要求（如“插件接口”中）存在一个众所周知的每个 swf 中的工厂，它将返回插件的定义（类）或插件本身。
2.  您只需以某种方式（工厂）获取对该对象的引用，然后它只是另一个对象。没有编组：域它只是命名空间的逻辑分区（它是系统域的树分支）。
3.  不 :) 但请注意：它可能很容易变成 GC 的地狱，由于引用散布在其他域中，无法卸载未使用的域。我建议看一下多核 PureMVC 框架，可能带有用于确保插件之间严格分离的管道。

顺便说一句，Flash Player 也是一个安全域的概念，但我实际上从未接触过它，所以我不知道这里有什么可能性。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-12-08T14:51:03.650

Luca Tettamanti 已经对你的具体问题给出了很好的回答，所以我将提供一些关于一般主题的额外信息：

我已经使用[`ModuleManager`](http://livedocs.adobe.com/flex/3/langref/mx/modules/ModuleManager.html)该类（以及[`mx.modules`](http://livedocs.adobe.com/flex/3/langref/mx/modules/package-detail.html)包中的其他内容）为 Flex 应用程序实现了一个简单的插件 API。它的要点是您从主机应用程序中子类化插件`ModuleBase`并`ModuleManager`在主机应用程序中使用来加载它们。然后你让插件实现一个公共接口（例如`IMyAppPlugin`）并使用某种[外观](http://en.wikipedia.org/wiki/Facade_pattern)来表示和实现插件可以使用的主机应用程序的接口（例如`MyAppFacade implements IMyAppFacade`。）每当加载插件时，将这个外观引用注入它们。

[Flex 3 帮助中的“模块化应用程序概述”](http://livedocs.adobe.com/flex/3/html/help.html?content=modular_2.html)主题有一些很好的信息（*“模块域”*子章节讨论了模块上下文中的应用程序域。）这是摘录：

> *“默认情况下，模块加载到当前应用程序域的子域中。您可以使用 ModuleLoader 类的 applicationDomain 属性指定不同的应用程序域。”*

[“使用 ApplicationDomain 类”](http://livedocs.adobe.com/flex/3/html/help.html?content=18_Client_System_Environment_5.html#119371)主题对应用程序域的主题进行了更深入的讨论，如果您还没有阅读过，那么您绝对应该阅读它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-24T15:14:01.440

回应关于 Java 作为一种可能的插件架构的声明：

事实证明，Java 多年来一直被用于设计插件架构系统。至于客户端，Equinox OSGi 模块管理框架可能是最著名的。有一次，Eclipse IDE 在 Equinox OSGi 之上重构了他们的插件架构。Eclipse IDE 可能是迄今为止设计的最成功的客户端插件体系结构系统之一 - 从历史的寿命以及用户群的广度和插件开发的后续社区的角度来看。他们还提供他们的插件架构作为设计任意客户端应用程序的基础框架 - Eclipse RCP。

我不得不插话，因为尽管 Java 被定位为可能是一个非常薄弱的​​选择，但它实际上比迄今为止的任何其他语言/运行时环境在提供这种工作系统方面都要成功得多——尤其是与 C# .NET 相比，当然，它对模块有很好的先天设施。有点讽刺意味，但你有它。

至于 Adob​​e AIR，我正在开发管理一个正在 AIR 上设计的项目。在我们的例子中，我们的模块可扩展性总是从 Web 服务器交付——而不是本地目录。Flex 拥有

`<mx:Module/>`

用于创建可以在运行时离散加载的模块的标签。

唉，对 AIR 的失望在于它缺少用于启动其他应用程序的任何类 API。您可以加载 URL 以在用户的​​默认浏览器中加载某些内容，但您无法启动 Excel。Java 和 C# 都有用于将其他应用程序作为外部进程启动的 API。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-08-14T12:09:58.410

您是否尝试过加载子应用程序？
在 AIR 中有很好的文档可以做到这一点，我在几个小时内就成功了。但是，由于子应用程序和主应用程序之间的沙箱冲突，相同的实现在 Flex 中是不同的故事。我花了几个星期把头撞到墙上。

# windows - SVN说我需要进行清理，但是清理失败

> ID：344714
> 
> 赞同：5
> 
> 时间：2008-12-05T18:18:28.163
> 
> 标签：windows, svn, windows-vista, tortoisesvn

！！！这不是一个重复的问题，因为其他主题中提供的解决方案对我不起作用。

当我尝试提交时：

错误：工作副本 'D:\Webs\Drupal 6' 锁定
错误：请执行“清理”命令。

当我尝试进行清理时：

清理未能处理以下路径：D:\Webs\Drupal 6

有谁知道我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-12-05T18:23:58.293

如果你这样做，它会起作用吗

*   新的“干净”结帐
*   使用合并/差异工具将您修改的文件合​​并到新的结帐文件夹中
*   犯罪

?

编辑：根据 derobert 评论更新了第 2 点。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-05T18:29:23.150

如果你还没有修改`D:\Webs\Drupal 6`，那么最简单的方法可能就是对其进行核对，然后让 svn co 再次从服务器中获取它。

或者，如果您修改了文件，您可以尝试divo 的建议，但要小心意外还原其他人的更改。

或者，您可以查看`.svn`目录内部并尝试手动清除锁定。

**编辑：**以下是 nuke/copy 程序如何恢复其他人的更改：

1.  结帐，获取 r1；
2.  修改 foo.c，给 r1 + 修改；
3.  其他人检查了对 foo.c 的更改（当然，您不知道他们已经这样做了，并且正常的检查方式对您来说是错误的），回购中的 foo.c 现在是 r2;
4.  您现在核对您的存储库，除了 foo.c（r1 + 更改）；
5.  你结帐，得到 foo.c r2。
6.  您将 foo.c 替换为您的副本（r1 + 更改）。然而，Subversion 并没有意识到这一点，并认为您的更改基于 r2，而不是 r1。
7.  Checkin，foo.c 现在是 r3，刚刚丢失了对方在 r2 中的更改。

希望澄清该程序如何意外恢复其他人的更改。它可以避免，但前提是你知道它是如何发生的！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-11T14:49:08.483

我刚刚浏览并删除了所有相关的 .svn 文件夹，然后进行了清理。完美运行！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-11-08T19:26:42.303

/*

我遇到了类似的问题。使用 svn cleanup 的建议没有用，因为 cleanup 给出了相同的错误（在这种情况下是递归错误）。最终，我意识到我已经将一个从远程仓库签出的工作区导入到本地仓库，所以我用导出替换了签出，删除了仓库路径，重新创建它，然后签入。在一次失败的签出后，由于发送端和接收端的路径级别不明确（！），我能够毫无问题地结帐。这向我表明，也许旧的 .svn 组件是导入的一部分并且混淆了颠覆，并且它没有足够的知识来忽略它们。每次我尝试创建存储库时，都是一次重新学习的经历。

*/

没关系。我犯了以下错误：1）编辑了导出命令，而不是结帐命令；2) 省略了目的地的完整路径，最终进入了一个隐藏在 Windows 中的 cygwin 子目录！

# c++ - 在 Windows C++ 应用程序中控制主线程

> ID：344715
> 
> 赞同：1
> 
> 时间：2008-12-05T18:18:35.293
> 
> 标签：c++, windows

我正在编写一些希望能够与任何窗口一起工作的代码，例如通过 windows API、MFC、wxWidgets 等创建的窗口。

问题是，对于某些事情，我需要使用创建窗口的同一线程，在许多情况下，它只是位于消息循环中。

我的第一个想法是将回调消息发布到窗口，然后当它使用其中一个参数和某种函数指针接收消息时，它将在我的代码中调用一个函数。但是似乎没有标准的 Windows 消息来执行此操作，而且我无法创建自己的消息，因为我不控制 Windows 代码，因此无法将所需的代码添加到消息处理程序以实现回调......

还有其他方法可以让创建窗口的线程进入我的函数吗？

编辑：John Z suggested 我迷上了 Windows 消息。如果我这样做，是否有某种方法可以获取自定义消息的“ID”，而不会与窗口已有的任何自定义消息发生冲突？

例如我可能会

```
WM_CALLBACK = WM_APP+1 
```

但是，如果我挂钩的窗口已经用 WM_APP+1 做了一些事情，我会遇到问题。

EDIT2：刚刚找到RegisterWindowMessage :)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-05T18:27:06.197

如果您与窗口处于同一进程中，则可以通过子类化来挂钩其消息。查看[http://msdn.microsoft.com/en-us/library/ms633570(VS.85).aspx](http://msdn.microsoft.com/en-us/library/ms633570(VS.85).aspx)

关键 API 是 SetWindowLong。

```
// Subclass the edit control. 
wpOrigEditProc = (WNDPROC) SetWindowLong(hwndEdit, GWL_WNDPROC, (LONG)EditSubclassProc); 

// Remove the subclass from the edit control. 
SetWindowLong(hwndEdit, GWL_WNDPROC, (LONG)wpOrigEditProc); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-05T20:05:27.793

作为子类化的替代方法，您可以使用[SetTimer](http://msdn.microsoft.com/en-us/library/ms644906(VS.85).aspx)在窗口线程中调用函数。

```
VOID CALLBACK Function(      
HWND hwnd,
UINT uMsg,
UINT_PTR idEvent,
DWORD dwTime
)
{
  // stuff
}

SetTimer(hWnd, event, 0, Function); 
```

# security - 您如何打击网站欺骗/网络钓鱼？

> ID：344719
> 
> 赞同：5
> 
> 时间：2008-12-05T18:18:59.333
> 
> 标签：security, user-interface, spoofing, phishing

对于网站 UI 欺骗的威胁，您建议的解决方案是什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-05T18:27:35.353

根据定义，任何依赖于网站在*您登录后*向您显示个性化信息的解决方案都对网络钓鱼无效。如果您尝试登录，**他们已经成功了**！

FWIW，我还不知道真正的答案，也许这个问题会引发一些好主意。然而，我专业从事网络钓鱼、不良域名注册等方面的研究。

我不相信网站开发人员可以实施任何重要的技术解决方案。同样，根据定义，如果您的用户到达网络钓鱼站点，您将不再处于控制之中。

这就是为什么所有当前的反钓鱼技术都驻留在浏览器中，而不是在钓鱼站点中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-05T18:34:57.647

这个问题的关键是识别对真实站点的请求和对欺骗站点的请求之间的一些区别。

最简单的区别是一些基于 cookie 的 UI 首选项。在您的（真实）网站上设置的 cookie 只会返回到您的网站，并且永远不会发送到恶搞网站。

现在有很多原因可能无法将有效的 cookie 发送到您的站点，用户可能正在使用不同的计算机，或者他们可能已经过期/删除了 cookie，但至少您可以保证它不会被发送到恶搞网站。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-05T18:51:39.093

我认为这里唯一的答案是编程更好的人。

只有当有问题的用户真正意识到这些事情是错误的时，才可以进行自定义外观或上传图像之类的操作。我认为除了他们经常访问的网站之外，大多数用户永远不会认出这些东西。即使他们这样做了，他们也可能将其归因于网站设计的变化，而不是网络钓鱼。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-05T18:20:21.420

一种解决方案是为每个用户定制网站。只有当用户对网站的看法基本相同时，欺骗才有效（一个欺骗 - 许多受害者）。因此，例如，如果 eBay 允许您配置自定义背景颜色，您应该能够注意到您正在查看的页面是一些恶搞（不知道您选择的颜色）。一个真正的解决方案要复杂一些（比如可能在浏览器中配置了一个秘密关键字，只有浏览器才能在密码控件或 url 栏中呈现等），但想法是一样的。

自定义每个用户的 UI，这样欺骗（依赖于大多数用户希望看到基本相同的 UI）停止工作。它可以是基于浏览器的解决方案，或者是网站向其用户提供的东西（有些已经这样做了）。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2008-12-05T18:21:49.297

我见过一些网站可以让您选择“个人”图标。每当您登录时，该图标都会显示为您在他们的网站上的证明。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2008-12-05T18:23:08.013

*   您可以在用户登录时提出问题（用户已写下答案的问题）。

*   您可以在用户上传的登录后显示一张图片，如果用户没有看到他的图片（只有他可以看到的私人图片），那么它不是真实的网站。

# seo - 可以防止搜索引擎蜘蛛无限爬取搜索结果上的分页链接吗？

> ID：344721
> 
> 赞同：4
> 
> 时间：2008-12-05T18:20:24.243
> 
> 标签：seo, web-crawler, robots.txt, nofollow

我们的 SEO 团队希望向蜘蛛打开我们的主要动态搜索结果页面，并从元标记中删除“nofollow”。蜘蛛目前可以通过允许 robots.txt 中的路径访问它，但在元标记中使用“nofollow”子句来防止蜘蛛超出第一页。

`<meta name="robots" content="index,nofollow">`

我担心如果我们删除“nofollow”，对我们的搜索系统的影响将是灾难性的，因为蜘蛛将开始爬取结果集中的所有页面。我将不胜感激有关以下方面的建议：

1）有没有办法从元标记中删除“nofollow”，但防止蜘蛛只关注页面上的某些链接？我读过关于 rel="nofollow" 的不同意见，这是一个可行的选择吗？

`<a rel="nofollow" href="http://www.mysite.com/paginglink" >Next Page</a>`

2）有没有办法控制蜘蛛走多远的“深度”？如果他们点击几页然后停止，那也不会那么糟糕。

3）我们的搜索结果页面有标准的下一个/上一个链接，理论上这会导致蜘蛛无限递归地点击页面，这对搜索引擎优化有什么影响？

我了解不同蜘蛛的行为不同，但我主要关注的是大玩家，例如 Google、Yahoo、MSN。

*请注意*，我们的搜索结果页面和分页链接对机器人不友好，因为它们没有被重写并且有一个 ?name=value 查询字符串，但据我所知，蜘蛛不再只是在看到 '? ' 因为结果页面正在以不错的页面排名被索引。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-05T18:30:59.853

我已经看到谷歌索引了一个日历系统，该系统在每个页面上都有相对链接，直到时间结束（2038 年 1 月 19 日 - 参见：[http](http://en.wikipedia.org/wiki/Year_2038_problem) ://en.wikipedia.org/wiki/Year_2038_problem ）。我们没有注意到我们服务器上的负载，直到它暴露了源代码中处理 2038 年日期的错误。

我不了解其他搜索引擎，但 Google 提供了许多有用的工具来控制 googlebot 对您的服务器基础架构的影响程度。请参阅[http://www.google.com/webmasters/](http://www.google.com/webmasters/)。

网站管理员工具中有一个选项可以为您的网站设置抓取速度。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-05T18:39:00.120

老实说，您正在查看**nofollow**错误。搜索蜘蛛很有可能已经在搜索 nofollow 页面，尤其是 Google、Yahoo 和 MSN，因为它们仍然必须点击这些页面来查看它们是否有 noindex。

真正的问题是**nofollow**实际上并不意味着*不关注*，它只是意味着*不要将我的声誉传递给这个链接*。因此，除非您积极阻止机器人（听起来不像您），否则更改链接上的 ROBOTS 元标记和机器人命令不会影响性能，因为它们已经在访问您的站点。要确认这一点，只需查看您的 HTTP 服务器日志。

所以我的投票是，你不会看到取消机器人限制有任何问题。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-05T18:23:33.037

谷歌机器人非常聪明，不会遍历动态生成的页面的整个数据库，只要 URL 给出一些提示它们是动态的（即 .asp 或 .jsp 等文件扩展名和数字 id 作为查询参数）。如果您使用重写规则使您的 URL 变得“友好”，那么机器人将很难确定它们正在阅读的是静态页面还是动态生成的页面。有关动态与静态 URL 的更多信息，请参阅[此 Google 文章](http://googlewebmastercentral.blogspot.com/2008/09/dynamic-urls-vs-static-urls.html)。

您可能还需要考虑创建一个[谷歌站点地图](http://googleblog.blogspot.com/2005/06/webmaster-friendly.html)，让机器人更好地了解您网站上的哪些页面可以被索引，哪些页面不能。

# c# - 基于 DateTime 属性 C#、XPath 对 XML 节点进行排序

> ID：344737
> 
> 赞同：7
> 
> 时间：2008-12-05T18:26:11.423
> 
> 标签：c#, xml, sorting, xpath

我有一个看起来像这样的 XML 结构。

```
<sales>
  <item name="Games" sku="MIC28306200" iCat="28" 
     sTime="11/26/2008 8:41:12 AM" 
     price="1.00" desc="Item Name" />
  <item name="Games" sku="MIC28307100" iCat="28" 
     sTime="11/26/2008 8:42:12 AM" 
     price="1.00" desc="Item Name" />
...
</sales> 
```

我正在尝试找到一种基于 sTime 属性对节点进行排序的方法，该属性是 DateTime.ToString() 值。诀窍是我需要保持节点完好无损，但由于某种原因我找不到这样做的方法。我相当确定 LINQ 和 XPath 有办法做到这一点，但我被困住了，因为我似乎无法根据 DateTime.ToString() 值进行排序。

```
XPathDocument saleResults = new XPathDocument(@"temp/salesData.xml");
XPathNavigator navigator = saleResults.CreateNavigator();

XPathExpression selectExpression = navigator.Compile("sales/item/@sTime");
selectExpression.AddSort("@sTime", 
    XmlSortOrder.Descending, 
    XmlCaseOrder.None, 
    "", 
    XmlDataType.Number);

XPathNodeIterator nodeIterator = navigator.Select(selectExpression);

while( nodeIterator.MoveNext() )
    {
         string checkMe = nodeIterator.Current.Value;
    } 
```

我还需要维护一个指向 NODE 的指针来检索其他属性的值。

也许这并不像我想象的那么简单。

谢谢。

**解决方案**：这是我最终使用的。采用选定的答案和 IComparable 类，这就是我如何根据 sTime 属性对 XML 节点进行排序，然后将所有属性放入适当的数组中以供以后使用。

```
 XPathDocument saleResults = new XPathDocument(@"temp/salesData.xml");
    XPathNavigator navigator = saleResults.CreateNavigator();
    XPathExpression selectExpression = navigator.Compile("sales/item");
    XPathExpression sortExpr = navigator.Compile("@sTime");
    selectExpression.AddSort(sortExpr, new DateTimeComparer());
    XPathNodeIterator nodeIterator = navigator.Select(selectExpression);
    int i = 0;
    while (nodeIterator.MoveNext())
       {
          if (nodeIterator.Current.MoveToFirstAttribute())
          {
              _iNameList.SetValue(nodeIterator.Current.Value, i);
          }
          if (nodeIterator.Current.MoveToNextAttribute())
          {
              _iSkuList.SetValue(nodeIterator.Current.Value, i);
          }
          ...
          nodeIterator.Current.MoveToParent();
          i++;

      } 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-05T18:52:12.637

干得好：

```
XmlDocument myDoc = new XmlDocument();

myDoc.LoadXml(@"
<sales>
<item name=""Games""
    sku=""MIC28306200""
    iCat=""28""
    sTime=""11/26/2008 8:41:12 AM""
    price=""1.00""
    desc=""Item Name"" />
<item name=""Games""
    sku=""MIC28307100""
    iCat=""28""
    sTime=""11/26/2008 8:42:12 AM""
    price=""1.00""
    desc=""Item Name"" />
</sales>
");

var sortedItems = myDoc.GetElementsByTagName("item").OfType<XmlElement>()
    .OrderBy(item => DateTime.ParseExact(item.GetAttribute("sTime"), "MM/dd/yyyy h:mm:ss tt", null));

foreach (var item in sortedItems)
{
    Console.WriteLine(item.OuterXml);
} 
```

这是一个完美运行的控制台应用程序。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-12-05T18:39:28.120

XPathExpression.Addsort 有一个重载，它采用 IComparer 接口。如果您自己将比较实现为 IComparer，则可以使用此机制。

```
 class Program
        {
            static void Main(string[] args)
            {
                XPathDocument saleResults = new XPathDocument( @"salesData.xml" );
                XPathNavigator navigator = saleResults.CreateNavigator( );
                XPathExpression selectExpression = navigator.Compile( "sales/item" );
                XPathExpression sortExpr = navigator.Compile("@sTime");
                selectExpression.AddSort(sortExpr, new DateTimeComparer());
                XPathNodeIterator nodeIterator = navigator.Select( selectExpression );            
                while ( nodeIterator.MoveNext( ) )
                {
                    string checkMe = nodeIterator.Current.Value;
                }
            }
            public class DateTimeComparer : IComparer
            {
                public int Compare(object x, object y)
                {
                    DateTime dt1 = DateTime.Parse( x.ToString( ) );
                    DateTime dt2 = DateTime.Parse( y.ToString( ) );
                    return dt1.CompareTo( dt2 );
                }
            }
        } 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-05T21:04:13.803

## 这是一个 XSLT 解决方案：

```
<xsl:stylesheet 版本="1.0"
 xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
 <xsl:output omit-xml-declaration="yes" indent="yes"/>

    <xsl:template match="销售">
      <销售>
        <xsl:for-each select="item">
          <xsl:sort select="substring(@sTime,7,4)" data-type="number"/>
          <xsl:sort select="substring(@sTime,1,2)" data-type="number"/>
          <xsl:sort select="substring(@sTime,4,2)" data-type="number"/>
          <xsl:sort select="substring-after(substring-after(@sTime,' '),' ')" />
          <xsl:sort data-type="数字" 选择=
           “翻译（
               substring-before(substring-after(@sTime,' '),' '),
               '：'，''
                      )
               " />
          <xsl:copy-of select="."/>
        </xsl:for-each>
      </销售>
    </xsl:模板>
</xsl:样式表>

```

**当此转换应用于以下 XML 文档时**：

```
<销售>
    <项目名称="游戏" sku="MIC28306200" iCat="28"
          sTime="2008 年 11 月 26 日晚上 8 点 41 分 12 秒"
          price="1.00" desc="商品名称" />
    <项目名称="游戏" sku="MIC28307100" iCat="28"
          sTime="11/26/2008 8:42:12 AM"
                price="1.00" desc="商品名称" />
    <项目名称="游戏" sku="MIC28307100" iCat="28"
          sTime="2008 年 11 月 26 日上午 11:42:12"
                price="1.00" desc="商品名称" />
    <项目名称="游戏" sku="MIC28306200" iCat="28"
          sTime="12/23/2008 8:41:12 PM"
          price="1.00" desc="商品名称" />
    <项目名称="游戏" sku="MIC28307100" iCat="28"
          sTime="12/23/2008 8:42:12 AM"
                price="1.00" desc="商品名称" />
</销售>

```

产生正确的结果：

```
<销售>
   <item name="Games" sku="MIC28307100" iCat="28" sTime="11/26/2008 8:42:12 AM" price="1.00" desc="Item Name"/>
   <item name="Games" sku="MIC28307100" iCat="28" sTime="11/26/2008 11:42:12 AM" price="1.00" desc="项目名称"/>
   <item name="Games" sku="MIC28306200" iCat="28" sTime="11/26/2008 8:41:12 PM" price="1.00" desc="Item Name"/>
   <item name="Games" sku="MIC28307100" iCat="28" sTime="12/23/2008 8:42:12 AM" price="1.00" desc="Item Name"/>
   <item name="Games" sku="MIC28306200" iCat="28" sTime="12/23/2008 8:41:12 PM" price="1.00" desc="物品名称"/>
</销售>

```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-05T19:30:44.493

如果正确构造了 XML，那么您尝试做的事情会更容易完成。XML Schema 建议说日期/时间值应该以 ISO8601 格式表示，即`CCCC-MM-DD HH:MM:SS`. （实际上 XML Schema 希望日期和时间之间的分隔符是 T，目前我不记得为什么了。）

以这种方式格式化日期和时间的两个主要优点是：

*   这正是其他 XML 用户所期望的，并且
*   您可以对它们的字符串值进行排序。

在 XSLT 将要处理的 XML 中以任何其他方式格式化日期是一种残酷的做法。

让 .NET 以这种格式发出 DateTime 值很容易（使用“s”格式说明符，它代表 - 等待它 - “可排序”）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-06-24T11:19:17.480

假设你的日期时间是这种格式

2010-06-01T15:16:29+05:00

那么可以做的最简单的方法是

< xsl:sort select="translate(XPATH_RETURNING_DATE,'-T:+','')" order="descending" data-type="number" />

在日期时间中，只需替换我的日期时间格式中的额外字符，我就有额外的字符（ - T : 和 + ）所以只需替换它，然后您的日期时间将采用可以轻松排序的数字格式

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2017-09-25T10:16:28.400

我知道这个问题已经很老了，你可能有一个解决方案，但我想分享我的答案：

```
 private static void  SortElementAttributesBasis(XmlNode rootNode)
    {

        for (int j = 0; j < rootNode.ChildNodes.Count; j++)
        {
            for (int i = 1; i < rootNode.ChildNodes.Count; i++)
            {
                Console.WriteLine(rootNode.OuterXml);
                DateTime dt1 = DateTime.ParseExact(rootNode.ChildNodes[i].Attributes["sTime"].Value, "M/d/yyyy h:mm:ss tt", System.Globalization.CultureInfo.InvariantCulture);
                DateTime dt2 = DateTime.ParseExact(rootNode.ChildNodes[i-1].Attributes["sTime"].Value, "M/d/yyyy h:mm:ss tt", System.Globalization.CultureInfo.InvariantCulture);
                int compare = DateTime.Compare(dt1,dt2);
                if (compare < 0)
                {
                    rootNode.InsertBefore(rootNode.ChildNodes[i], rootNode.ChildNodes[i - 1]);
                    Console.WriteLine(rootNode.OuterXml);
                }

                // Provide the name of Attribute in .Attribute["Name"] based on value you want to sort.

                   //if (String.Compare(rootNode.ChildNodes[i].Attributes["sTime"].Value, rootNode.ChildNodes[1 - 1].Attributes["sTime"].Value) < 0)
                //{
                //    rootNode.InsertBefore(rootNode.ChildNodes[i], rootNode.ChildNodes[i - 1]);

                //}
            }
        }
    } 
```

**输入 XML 是 @Dimitre Novatchev 提供的示例**

```
<sales>
<item name="Games" sku="MIC28306200" iCat="28"
      sTime="11/26/2008 8:41:12 PM"
      price="1.00" desc="Item Name" />
<item name="Games" sku="MIC28307100" iCat="28"
      sTime="11/26/2008 8:42:12 AM"
            price="1.00" desc="Item Name" />
<item name="Games" sku="MIC28307100" iCat="28"
      sTime="11/26/2008 11:42:12 AM"
            price="1.00" desc="Item Name" />
<item name="Games" sku="MIC28306200" iCat="28"
      sTime="12/23/2008 8:41:12 PM"
      price="1.00" desc="Item Name" />
<item name="Games" sku="MIC28307100" iCat="28"
      sTime="12/23/2008 8:42:12 AM"
            price="1.00" desc="Item Name" /> 
```

**输出**

```
<item name="Games" sku="MIC28307100" iCat="28" sTime="11/26/2008 8:42:12 AM" price="1.00" desc="Item Name" /><item name="Games" sku="MIC28307100" iCat="28" sTime="11/26/2008 11:42:12 AM" price="1.00" desc="Item Name" /><item name="Games" sku="MIC28306200" iCat="28" sTime="11/26/2008 8:41:12 PM" price="1.00" desc="Item Name" /><item name="Games" sku="MIC28307100" iCat="28" sTime="12/23/2008 8:42:12 AM" price="1.00" desc="Item Name" /> 
```

# c# - 如何在 C# 中通过解析 Xml 创建表达式树？

> ID：344741
> 
> 赞同：3
> 
> 时间：2008-12-05T18:28:40.857
> 
> 标签：c#, .net, xml, linq, expression-trees

我希望通过使用 C# 解析 xml 来创建表达式树。xml 将如下所示：

```
<Expression>
<If>
  <Condition>
    <GreaterThan>
      <X>
      <Y>
    </GreaterThan>
  </Condition>
  <Expression />
<If>
<Else>
  <Expression />
</Else>
<Expression> 
```

或另一个例子...

```
<Expression>
  <Add>
    <X>
    <Expression>
      <Y>
      <Z>
    </Expression>
  </Add>
</Expression> 
```

...关于从哪里开始的任何指示都会有所帮助。

亲切的问候，

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-05T19:04:02.173

```
using System.Linq.Expressions; //in System.Core.dll

Expression BuildExpr(XmlNode xmlNode)
 { switch(xmlNode.Name)
    { case "Add":
       { return Expression.Add( BuildExpr(xmlNode.ChildNodes[0])
                               ,BuildExpr(xmlNode.ChilNodes[1]));
       } 

      /* ... */

    }
 } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-05T18:42:52.060

我将从查看 DLR 开始，它具有已发布的表达式树机制。

# ruby-on-rails - Rails 缓存数据库查询和最佳实践

> ID：344744
> 
> 赞同：25
> 
> 时间：2008-12-05T18:29:20.857
> 
> 标签：ruby-on-rails, caching, memcached

我网站上的数据库负载变得非常高，所以我是时候缓存那些每小时被调用 1000 次且结果没有变化的常见查询了。因此，例如在我的城市模型上，我执行以下操作：

```
def self.fetch(id)   
  Rails.cache.fetch("city_#{id}") { City.find(id) }   
end 

def after_save
  Rails.cache.delete("city_#{self.id}")
end

def after_destroy
  Rails.cache.delete("city_#{self.id}")
end 
```

所以现在当我第一次访问数据库时可以 City.find(1) 但接下来的 1000 次我从内存中得到结果。伟大的。但是大多数对 city 的调用不是 City.find(1) 而是 @user.city.name 其中 Rails 不使用 fetch 而是再次查询 DB ......这很有意义，但不完全是我想要的。

我可以做 City.find(@user.city_id) 但这很难看。

所以我的问题给你们。聪明人在做什么？这样做的正确方法是什么？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2008-12-06T05:22:48.230

关于缓存，有几点需要注意：

值得使用斜线来分隔对象类型和 id，这是 rails 约定。更好的是，ActiveRecord 模型提供了 cacke_key 实例方法，它将提供表名和 id 的唯一标识符，“cities/13”等。

对 after_save 过滤器的一个小修正。由于您手头有数据，因此最好将其写回缓存而不是删除它。这为您节省了一次访问数据库的时间；）

```
def after_save
  Rails.cache.write(cache_key,self)
结尾

```

至于问题的根源，如果你不断拉@user.city.name，有两个真正的选择：

*   将用户的城市名称非规范化为用户行。@user.city_name（保留 city_id 外键）。此值应在保存时写入。

-或者-

*   实现您的 User.fetch 方法以预先加载城市。仅当城市行的内容从未更改（即名称等）时才执行此操作，否则您可能会针对缓存失效打开一罐蠕虫。

个人意见：实现基本的基于id的fetch方法（或使用插件）与memcached集成，将城市名称非规范化到用户的行。

我个人不是缓存模型样式插件的忠实拥护者，我从来没有见过一个可以节省大量开发时间的插件，而且我还没有匆忙摆脱。

如果你有太多的数据库查询，如果你还没有，那么绝对值得检查一下预加载（通过 :include）。这应该是减少数据库查询数量的第一步。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-04-15T15:54:11.773

如果您需要加快对随时间变化不大的数据的 sql 查询，则可以使用物化视图。

> matview 将查询结果存储到它自己的类似表的结构中，从中可以查询数据。不能添加或删除行，但其余时间它的行为就像一个实际的表。查询速度更快，matview 本身可以被索引。
> 
> 在撰写本文时，matview 已在 Oracle DB、PostgreSQL、Sybase、IBM DB2 和 Microsoft SQL Server 中本地可用。不幸的是，MySQL 不提供对 matviews 的本机支持，但它有开源替代方案。

这是一些关于如何在 Rails 中使用 matviews 的好文章

[sitepoint.com/speed-up-with-materialized-views-on-postgresql-and-rails](https://www.sitepoint.com/speed-up-with-materialized-views-on-postgresql-and-rails/)

[hashrocket.com/materialized-view-strategies-using-postgresql](https://hashrocket.com/blog/posts/materialized-view-strategies-using-postgresql)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-05T19:24:52.133

我会继续看一下现在在 Rails 2.2 中的[Memoization 。](http://guides.rubyonrails.org/2_2_release_notes.html#_memoization)

> “记忆化是一种将方法初始化一次，然后将其值隐藏起来以供重复使用的模式。”

最近有一个很棒的[Railscast 插曲](http://railscasts.com/episodes/137-memoization)，它应该能让你很好地启动和运行。

Railscast 中的快速代码示例：

```
class Product < ActiveRecord::Base
  extend ActiveSupport::Memoizable

  belongs_to :category

  def filesize(num = 1)
    # some expensive operation
    sleep 2
    12345789 * num
  end
  memoize :filesize
end 
```

[更多关于记忆](http://www.railway.at/articles/2008/09/20/a-guide-to-memoization)

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2008-12-05T19:20:03.437

查看[cached_model](http://github.com/netshade/cached_model/tree/master)

# sql-server - 如何在不关闭和重新打开连接的情况下更改 MS SQLServer 身份验证登录？

> ID：344746
> 
> 赞同：0
> 
> 时间：2008-12-05T18:29:50.247
> 
> 标签：sql-server

我有一个到 Microsoft SQL Server 的连接，并希望更改连接身份验证的用户。是否可以在不关闭并重新打开连接的情况下做到这一点？

理想的情况是 Oracle[设置角色](http://www.techonthenet.com/oracle/roles.php)功能。

如果该解决方案也适用于 SQL Server 2000，我会很高兴。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-05T18:34:21.737

据我所知，SQL Server 在传递的帐户上非常不同，即经过身份验证的上下文。以企业管理器和其他工具为例，您必须断开并重新连接才能更改用户。

再加上[连接池](http://msdn.microsoft.com/en-us/library/8xx3tyca.aspx)的工作方式，它表明连接本身是特定于用户的缓存，因此如果您在中途更改执行方，则会导致严重的安全问题。

所以简短的回答，不，据我所知这是不可能的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-05T19:06:46.570

您可能想查看应用程序角色 (sp_setapprole)，但您必须了解一旦更改上下文（例如设置角色）的后果，就无法使用 SQL Server 2000 恢复它（可以使用2005）。这样做的结果是，当在您的代码中关闭连接时，连接实际上是无用的，例如，它不能返回到池中并重用，这会导致可伸缩性问题。

否则，一旦建立了安全上下文，就不可能更改它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-09T21:37:04.790

根据您正在做的事情，EXECUTE AS 可能会在此处为您提供帮助。这允许您在另一个用户的上下文中执行 SQL，其方式与 Windows shell 中可用的 RUN AS 类似。SQL Server 中的探查器和审计跟踪允许您查看原始用户以及运行语句的上下文。

以用户身份执行 = 'newuser'; SELECT ... <-- newuser REVERT 上下文下的 SQL 代码；

注意：这在 SQL Server 2000 下不可用，并且由于像您这样的请求而被添加。

# java - 如何将 jar 中的文件用作 javax.net.ssl.keystore？

> ID：344748
> 
> 赞同：19
> 
> 时间：2008-12-05T18:31:20.977
> 
> 标签：java, jar, executable-jar

我正在尝试做类似的事情

```
URL clientks = com.messaging.SubscriptionManager.class.getResource( "client.ks" );
String path = clientks.toURI().getPath();
System.setProperty( "javax.net.ssl.keyStore", path); 
```

其中 client.ks 是我正在运行的 jar 文件中存储在 com/messaging 中的文件。

读取 javax.net.ssl.keyStore 的东西期待 jar 中 client.ks 文件的路径。如果可能的话，我宁愿不提取文件并放入客户端的机器上。那么是否可以引用 jar 中的文件？

这不起作用，因为 getPath() 返回 null。还有另一种方法可以做到这一点吗？

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2013-06-27T20:51:31.950

仍在努力实现，但我相信可以通过 InputStream 从 jar 加载密钥库并以编程方式显式设置 TrustStore（与设置系统属性相比）。请参阅文章：[在同一个 JVM 上设置多个信任库](https://stackoverflow.com/questions/7591281/setting-multiple-truststore-on-the-same-jvm)

得到它的工作！

```
InputStream keystoreInput = Thread.currentThread().getContextClassLoader()
    .getResourceAsStream(<path in jar>/client.ks");
InputStream truststoreInput = Thread.currentThread().getContextClassLoader()
    .getResourceAsStream(<path in jar>/client.ts");
setSSLFactories(keystoreInput, "password", truststoreInput);
keystoreInput.close();
truststoreInput.close();

private static void setSSLFactories(InputStream keyStream, String keyStorePassword, 
    InputStream trustStream) throws Exception
{    
  // Get keyStore
  KeyStore keyStore = KeyStore.getInstance(KeyStore.getDefaultType());    

  // if your store is password protected then declare it (it can be null however)
  char[] keyPassword = keyStorePassword.toCharArray();

  // load the stream to your store
  keyStore.load(keyStream, keyPassword);

  // initialize a key manager factory with the key store
  KeyManagerFactory keyFactory = 
  KeyManagerFactory.getInstance(KeyManagerFactory.getDefaultAlgorithm());    
  keyFactory.init(keyStore, keyPassword);

  // get the key managers from the factory
  KeyManager[] keyManagers = keyFactory.getKeyManagers();

  // Now get trustStore
  KeyStore trustStore = KeyStore.getInstance(KeyStore.getDefaultType());    

  // if your store is password protected then declare it (it can be null however)
  //char[] trustPassword = password.toCharArray();

  // load the stream to your store
  trustStore.load(trustStream, null);

  // initialize a trust manager factory with the trusted store
  TrustManagerFactory trustFactory = 
  TrustManagerFactory.getInstance(TrustManagerFactory.getDefaultAlgorithm());    
  trustFactory.init(trustStore);

  // get the trust managers from the factory
  TrustManager[] trustManagers = trustFactory.getTrustManagers();

  // initialize an ssl context to use these managers and set as default
  SSLContext sslContext = SSLContext.getInstance("SSL");
  sslContext.init(keyManagers, trustManagers, null);
  SSLContext.setDefault(sslContext);    
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-12-05T18:49:00.333

您可以获取`InputStream`jar 文件中的资源，但不能获取`File`. 如果最终读取密钥库的“事物”需要`File`文件的路径或路径，那么您唯一的选择是将其提取到文件系统中。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2017-08-10T06:43:12.507

[这是user2529737 的答案](https://stackoverflow.com/a/17352927/365237)的清理版本，以防万一。它删除了不需要的信任库设置并添加了必需的导入、密钥库类型和密钥密码的参数。

```
import javax.net.ssl.HttpsURLConnection;
import javax.net.ssl.KeyManager;
import javax.net.ssl.KeyManagerFactory;
import javax.net.ssl.SSLContext;
import java.io.BufferedReader;
import java.io.InputStream;
import java.io.InputStreamReader;
import java.net.URL;
import java.security.KeyStore;

public class PlainJavaHTTPS2Test {

    public void setUp() throws Exception {
        final String KEYSTOREPATH = "clientkeystore.p12"; // or .jks

        // store password can be null if there is no password
        final char[] KEYSTOREPASS = "keystorepass".toCharArray();

        // key password can be null if there is no password
        final char[] KEYPASS = "keypass".toCharArray();

        try (InputStream storeStream = this.getClass().getResourceAsStream(KEYSTOREPATH)) {
            setSSLFactories(storeStream, "PKCS12", KEYSTOREPASS, KEYPASS);
        }
    }
    private static void setSSLFactories(InputStream keyStream, String keystoreType, char[] keyStorePassword, char[] keyPassword) throws Exception
    {
        KeyStore keyStore = KeyStore.getInstance(keystoreType);

        keyStore.load(keyStream, keyStorePassword);

        KeyManagerFactory keyFactory =
                KeyManagerFactory.getInstance(KeyManagerFactory.getDefaultAlgorithm());

        keyFactory.init(keyStore, keyPassword);

        KeyManager[] keyManagers = keyFactory.getKeyManagers();

        SSLContext sslContext = SSLContext.getInstance("SSL");
        sslContext.init(keyManagers, null, null);
        SSLContext.setDefault(sslContext);
    }
} 
```

# python - 导入 PIL 图像库时出现问题

> ID：344753
> 
> 赞同：0
> 
> 时间：2008-12-05T18:34:25.557
> 
> 标签：python, django, image, python-imaging-library

我正在尝试使用 django 中的 PIL Image 库做一些事情，但我遇到了一些问题。

我喜欢这样：

`import Image`

然后我就喜欢这样

`images = map(Image.open, glob.glob(os.path.join(dirpath, '*.thumb.jpg')))`

但是当我尝试运行它时，我得到一个错误，它让我认为它没有正确导入，有人知道吗？

`type object 'Image' has no attribute 'open'`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-05T19:00:03.947

发生上述错误是因为您的文件名为 Image.py 并且您正在尝试自己导入。正如手册所指出的，您应该从 PIL 模块导入 Image，但您还需要重命名文件，使其*不*称为 Image.py。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-05T18:51:53.337

您的示例在我的机器上运行良好。我不知道你为什么会收到这个错误。PIL 文档说你必须以这种方式导入库：

```
from PIL import Image 
```

你应该这样试试。正如我所说，对我来说，这两种方式都有效。

# asp.net - Asp.net MVC 验证动态表单

> ID：344754
> 
> 赞同：2
> 
> 时间：2008-12-05T18:34:42.110
> 
> 标签：asp.net, asp.net-mvc, validation

我正在构建一个带有需要验证的表单的 ASP.NET MVC 应用程序。大部分形式是静态的，但部分形式是动态的。

我需要让用户输入 n 个字符串/日期组合。

字符串/日期组合需要在服务器端进行验证，我需要直接在验证失败的组合旁边向用户提供反馈。

对于静态输入，我执行以下操作：

```
 <%= Html.ValidationMessage("someField") %> 
```

对于动态数据，我该怎么办？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-05T22:23:12.740

在您的控制器中，您需要将错误分配给验证失败的特定字段：

```
ModelState.AddModelError ("textbox1", "You must specify a valid string.");
ModelState.AddModelError ("combobox1", "You must specify a valid date."); 
```

然后所有助手真正做的是检查是否存在以下内容：

```
ViewData.ModelState.ContainsKey("textbox1") 
```

然后创建如下标签

```
<span><%= ViewData.ModelState.ContainsKey("textbox1").Errors[0] %></span> 
```

助手会做更多的空值检查，但你明白了。

# hardware - 感兴趣的软件专业人士的平面图和打包架构资源？

> ID：344755
> 
> 赞同：3
> 
> 时间：2008-12-05T18:34:47.617
> 
> 标签：hardware, silicon

我最近遇到的更有趣的事情之一是布置芯片平面图和确定硅封装的艺术和科学。我想为“感兴趣的软件专家”阅读一些有关该主题的材料。

有没有人有任何建议（网站或书籍，只要质量好）？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-02-07T02:11:42.713

这是我对该主题进行搜索的结果，因为我对您的问题感到好奇，这就是我自己开始的地方。抱歉，我不是该主题的专家，但希望它可以帮助您！

似乎[平面图](http://en.wikipedia.org/wiki/Floorplan_(microelectronics))优化是[组合优化](http://en.wikipedia.org/wiki/Combinatorial_optimization)的问题。

作为开发人员，您需要处理其背后的理论，并且很可能需要一些经过验证的算法。然后，您可能会对以下书籍感兴趣：

*   [计算几何：](https://rads.stackoverflow.com/amzn/click/com/3540779736) Mark de Berg 等人的算法和应用。
*   [Laurence A. Wolsey 等人的整数和组合优化](https://rads.stackoverflow.com/amzn/click/com/0471359432)。
*   Sabih H. Gerez[的 VLSI 设计自动化算法](https://rads.stackoverflow.com/amzn/click/com/0471984892)
*   Charles J. Alpert 等人[的物理设计自动化算法手册。](https://rads.stackoverflow.com/amzn/click/com/0849372429)
*   Rolf Drechsler[的 VLSI CAD 进化算法](https://rads.stackoverflow.com/amzn/click/com/0792381688)

获得关于这个主题的链接有点困难，但如果你是 IEEE Xplore 的成员，你可能想看看[这篇论文](http://ieeexplore.ieee.org/xpl/freeabs_all.jsp?arnumber=4348253)和其他类似的论文。

最后，在[平面图维基百科条目](http://en.wikipedia.org/wiki/Floorplan_(microelectronics))中，您会在可切片平面图上注意到这一点，这可能会为您提供最佳起点：

> 由于多种原因，许多早期 EDA 工具都使用了可切片平面图。**可切片平面图可以方便地用对应于切片顺序的二叉树来表示**。更重要的是，一些 NP-hard 的平面图问题在仅限于可切片平面图时具有多项式时间算法

祝你好运！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-07T21:11:04.457

卡内基梅隆大学似乎有这方面的课程

[超大规模集成电路](http://www.ece.cmu.edu/~ee760/)

一些看起来比其他的更有趣的讲义：

*   [所有笔记](http://www.ece.cmu.edu/~ee760/760assignments.html)
*   [布局](http://www.ece.cmu.edu/~ee760/760docs/lec11.pdf)
*   [“平面设计”](http://www.ece.cmu.edu/~ee760/760docs/lec16-proj3.pdf)
*   [迷宫搜索](http://www.ece.cmu.edu/~ee760/760docs/S99maze.pdf)

该网站引用了此人出版的一本或多本书籍：

*   [马吉德·萨拉夫扎德](http://www.cs.ucla.edu/~majid/)

[我还在这里](http://www.radio-electronics.com/info/data/semicond/asic/asic.php)找到了一个简短的教程

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-11T23:30:48.097

AutoCAD 是经典之作……虽然我的预算有限，但我更喜欢[Rhino 2.0](http://www.rhino3d.com/)。

# c# - 旧版 ASP 中的 WindowsIdentity 令牌

> ID：344774
> 
> 赞同：1
> 
> 时间：2008-12-05T18:44:24.883
> 
> 标签：c#, .net, security, com, interop

我在工作中创建了一个 .Net 库，供我们所有的开发人员使用。它的安全部分使用 Microsoft AzMan 作为安全后端。为了创建一个安全（AzMan）ClientContext，我必须向它传递一个令牌值（作为一个 uint）。这一切都很好，直到我需要为我们的公共库制作一个 COM 包装器，以便我们的一些遗留页面可以利用它而无需现在重写。

我无法弄清楚如何获取令牌值以从旧版 ASP 传递给 AzMan。COM 包装器设置为作为 COM 服务器运行并作为我们在此处用于所有 COM 对象的特定用户运行，因此公共库不能仅使用 .Net 提取身份。

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-12-05T19:27:23.577

您是否在 IIS 配置中使用匿名登录？如果您使用 Windows 身份验证并在经典 ASP 中执行以下操作，您应该获得登录用户：

```
Request.ServerVariables("LOGON_USER") 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-13T12:28:25.690

在经典 ASP 中，您必须从外部 COM 对象获取令牌。

自从我处理经典 ASP 以来已经有很长时间了......但是这里处理过经典 ASP 模拟的人可能有一些他们可以分享的代码片段。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-16T13:48:33.323

如果您无法获取令牌，您可以始终使用**IAzApplication.InitializeClientContextFromName**，同时从您的 asp 页面中的请求中检索用户名并将其传递给您的 com+ 组件。

[http://msdn.microsoft.com/en-us/library/aa377363(VS.85).aspx](http://msdn.microsoft.com/en-us/library/aa377363(VS.85).aspx)

# java - Eclipse 类路径中的嵌套文件夹

> ID：344777
> 
> 赞同：5
> 
> 时间：2008-12-05T18:46:13.210
> 
> 标签：java, eclipse, classpath

我正在尝试将两个文件夹添加到我的 Eclipse 项目的类路径中，假设文件夹 A 和文件夹 B。B 在 A 内。每当我将 A 添加到类路径时

```
<classpathentry kind="lib" path="/A"/> 
```

它工作得很好，但我也需要能够访问 B 中的文件。每当我尝试添加

```
<classpathentry kind="lib" path="/A/B"/> 
```

到类路径，它说

> 不能在库 A 中嵌套“A/B”

在编辑类路径时，我是新手，所以我想知道，是否有办法在 eclipse 类路径中添加一个文件夹，该文件夹嵌套在另一个也在 eclipse 类路径中的文件夹中？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-12-05T18:54:50.337

我认为您不能（或不应该）允许这样做，而且这不是真正的 Eclipse 问题 AFAIK

任何单独的类路径都是 JVM 开始使用标准包表示法查找类的根

因此，假设您的程序在默认包中有一个类 X，在 b 包中有一个 bX 类。如果默认包根是 /a，那么你的包 b 将在 /a/b

如果你有一个指向 /a 的类路径根和一个指向 /a/b 的类路径根，现在你请求类 X，那么可以将你的请求解释为默认包中的 X（因为 A 中有一个根） ，但也作为默认包中的类X相对于路径/a/b，但那是类bX

所以为了防止这些事情发生，你不能有嵌套的类路径根。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2011-12-06T10:12:02.197

尝试这样做，在 eclipse Indigo 上为我工作。

```
<classpathentry kind="lib" path="/A" excluding="B/"/> 
```

# .net - 如何在 .NET 自定义操作中使用企业库日志记录

> ID：344784
> 
> 赞同：5
> 
> 时间：2008-12-05T18:50:15.947
> 
> 标签：.net, windows-installer, enterprise-library, app-config, custom-action

我有一些从我的应用程序中使用的库代码，也被 Visual Studio 安装程序项目中的 .NET 自定义操作使用。库代码反过来使用企业库日志记录块来进行日志记录。如何在 msiexec 中运行的自定义操作的上下文中将配置信息获取到企业库？在我对 EntLib 进行任何调用之前，是否可以在代码中引导配置机制？

更新：我制作了一个看起来可以工作但依赖于使用反射设置非公共静态字段的hack。EntLib 与 .NET ConfigurationManager 的耦合如此紧密，这是一种耻辱。

```
var factory = new LogWriterFactory( new FakeConfigSource( "foo.config" ) );
var field = typeof ( Logger ).GetField( "factory", BindingFlags.Static | BindingFlags.NonPublic );
field.SetValue( null, factory );
Logger.Write( "Test" ); 
```

更新 2：虽然该 hack 在测试平台中有效，但在 msiexec 的上下文中运行时，程序集加载器找不到配置文件中引用的程序集。fuslogvw表示AppBase是windows system32目录，这有点意思。我不明白为什么会找到自定义操作程序集的清单依赖项（位于自定义操作程序集旁边的 [TargetDir] 目录中），但在配置文件中调用的动态加载程序集却没有。看不到任何解决方法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-26T12:05:31.387

无法使用标准的 app.config 方式，因为 app.config 是您在执行 MSI 之前需要编辑的 msiexec.config。我的建议是使用您自己的配置加载方法，该方法从自定义 XML 或 MSI 中的值读取。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-03T00:13:24.020

我认为问题在于您的自定义操作程序集正在加载中[`LoadFrom`context](http://blogs.msdn.com/suzcook/archive/2003/05/29/57143.aspx)，因此其清单依赖关系相对于其代码库已解决。

您可以通过创建一个新的`AppDomain`. 这将使您有机会重置基本目录、加载新`App.config`文件等。使用[AppDomain.CreateDomain(String, Evidence, AppDomainSetup)](http://msdn.microsoft.com/en-us/library/aehss7y0.aspx)创建新的 AppDomain，为 ApplicationBase、ConfigurationFile 等填充[AppDomainSetup 属性。](http://msdn.microsoft.com/en-us/library/system.appdomainsetup_properties.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-24T15:23:15.373

我有一个类似的问题，msiexec 无法加载自定义操作依赖项，目前我的解决方案是将依赖程序集复制到系统目录中。这是一个糟糕的解决方案，但它确实有效。

```
string installDir = System.IO.Path.GetDirectoryName(
                System.Reflection.Assembly.GetExecutingAssembly().Location);
System.IO.File.Copy(
                System.IO.Path.Combine(installDir, "<Insert Assembly Name>.dll"),
                System.IO.Path.Combine(Environment.SystemDirectory, "<Insert Assembly Name>.dll"),
                true); 
```

另一种选择是将企业库程序集安装到 GAC 中。[如果您这样做，您将需要使用Orca](http://www.technipages.com/download-orca-msi-editor.html)之类的东西来编辑 msi ，以使安装程序在运行自定义操作之前安装到 GAC 中，默认情况下自定义操作首先运行。

我仍在寻找一个非常巧妙的解决方案，当我找到它时我会更新这个响应。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-12T06:17:35.713

不确定这是否有帮助，但您可以从自定义操作中写入 msi 日志。（下面的示例 VBScript :)

```
Const msiMessageTypeInfo = &H04000000
Const msiMessageTypeFatalExit = &H00000000
Const msiMessageTypeError = &H01000000
Const msiMessageTypeWarning = &H02000000
Const msiMessageTypeUser = &H03000000 

Dim rec : Set rec = Session.Installer.CreateRecord(1)
rec.StringData(1) = "Your log message."

Session.Message msiMessageTypeInfo, rec 
```

来自 MSDN 的更多信息：http: [//msdn.microsoft.com/en-us/library/aa371672.aspx](http://msdn.microsoft.com/en-us/library/aa371672.aspx)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-02-26T21:01:07.913

这可能会帮助仍在处理 VS 安装程序的人：可以使用自定义操作中动态加载的程序集，您只需要帮助运行时定位程序集即可。

你这样做的方法是处理`AppDomain.AssemblyResolve`事件。我在`Install`我的安装程序类的方法上这样做了，如下所示：

```
internal class MyInstaller : Installer
{
    public override void Install(IDictionary stateSaver)
    {
        base.Install(stateSaver);

        AppDomain.CurrentDomain.AssemblyResolve += (sender, args) =>
        {
            // Resolve assemblies here, e.g.:
            return
                args.Name == "My.Assembly"
                ? Assembly.LoadFrom(this.Context.Parameters["TARGETDIR"] + "\\My.Assembly.dll")
                : null;
        };

        // Continue install...
    }
} 
```

我建议也阅读[有关实现处理程序的 MS Docs 页面](https://docs.microsoft.com/en-us/dotnet/framework/app-domains/resolve-assembly-loads)。

# java - 什么会使单个任务执行者停止处理任务？

> ID：344788
> 
> 赞同：6
> 
> 时间：2008-12-05T18:50:56.867
> 
> 标签：java, multithreading, concurrency, executorservice

我正在使用`java.util.concurrent.ExecutorService`通过调用获得的`Executors.newSingleThreadExecutor()`. 这`ExecutorService`有时会停止处理任务，即使它没有被关闭并继续接受新任务而不抛出异常。`OutOfMemoryError`最终，它建立了足够多的队列，以至于我的应用程序异常关闭。

文档似乎表明，这个单线程执行器应该通过在必要时启动一个新的工作线程来替换一个已经死亡的工作线程来避免任务处理错误。我错过了什么吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-12-05T19:01:37.327

听起来您有两个不同的问题：

1）您过度使用工作队列。你不能一直往队列里塞新任务，而不考虑任务执行者的消耗率。您需要找出一些逻辑来了解何时阻止新添加到工作队列中。

2）任务线程中任何未捕获的异常都可以完全杀死线程。发生这种情况时，ExecutorService 会启动一个新线程来替换它。但这并不意味着您可以忽略导致线程首先死亡的任何问题！找到那些未捕获的异常并捕获它们！

这只是一种预感（因为您的帖子中没有足够的信息来了解其他情况），但我不认为您的问题是任务执行者停止处理任务。我的猜测是它处理任务的速度不如您创建它们的速度快。（而且您的任务有时会过早终止这一事实可能与问题无关。）

至少，这是我使用线程池和任务执行器的经验。

* * *

好的，根据您的评论，这是另一种听起来可行的可能性（一切都会顺利运行几个小时，直到突然停止）......

您的任务线程之间可能会出现罕见的死锁。大多数时候，你很幸运，僵局并没有表现出来。但偶尔，您的两个或多个任务线程会进入等待释放另一个线程持有的锁的状态。此时，无法进行更多任务处理，并且您的工作队列将堆积起来，直到您收到 OutOfMemoryError。

这是我诊断该问题的方法：

消除任务线程之间的所有共享状态。首先，这可能需要每个任务线程制作它所需的所有共享数据结构的防御性副本。一旦你这样做了，就应该完全不可能遇到死锁。

此时，逐渐重新引入共享数据结构，一次一个（具有适当的同步）。在每次微小修改后重新运行您的应用程序以测试死锁。当您再次遇到这种崩溃情况时，请仔细查看共享资源的访问模式并确定您是否真的需要共享它。

就我而言，每当我编写处理带有线程池和执行器的并行任务的代码时，我总是试图消除这些任务之间的**所有**共享状态。就应用程序而言，它们也可能是完全自主的应用程序。寻找死锁是一种拖累，根据我的经验，消除死锁的最佳方法是让每个线程拥有自己的本地状态，而不是与其他任务线程共享任何状态。

祝你好运！

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-05T19:52:20.517

我的猜测是您的任务会无限期地阻塞，而不是死亡。您是否有证据（例如任务结束时的日志声明）表明您的任务已成功完成？

这可能是死锁，或者是与某个阻塞的外部进程的交互。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-05T19:02:22.943

尽管您没有留下足够的细节来确定，但我会尝试的第一件事是让您的任务在顶层捕获“异常”并记录消息。

我知道这看起来不对，但偶尔（取决于很多变量）我处理过代码，其中线程中发生的事情会引发异常并且它永远不会被记录，或者它只是没有出现在控制台——但“执行”代码退出它的顶级循环或任何导致您的任务运行的代码。

我想我只是说，确保你的任务没有抛出异常。

# php - 在 PHP 5 上安装 PEAR？

> ID：344789
> 
> 赞同：1
> 
> 时间：2008-12-05T18:51:32.870
> 
> 标签：php, pear

我想在 PHP 5 上安装 PEAR，所以我可以使用 Spreadsheet_Excel_Writer。

我不知道如何在我的 ISP 或我的个人 MacBook 上安装它。

双方的想法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-05T19:28:20.473

[PEAR 手册](http://pear.php.net/distributions/manual/pear_manual_en.html.gz "梨手册")有一个关于如何在 Windows、*NIX 和 Mac OS X 上安装 PEAR 管理器的非常广泛的[说明](http://pear.php.net/distributions/manual/pear_manual_en.html.gz#installation.getting "得到经理")列表。该手册还有一个关于[远程安装 PEAR](http://pear.php.net/distributions/manual/pear_manual_en.html.gz#AEN1993 "使用 PEAR 1.4.3+ 和 PEAR_RemoteInstaller 的新改进方法")的部分，例如使用 FTP。按照这些说明，您应该能够（几乎）在任何地方安装 PEAR。:)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-05T19:14:31.513

从命令行执行以下操作：

```
pear install Spreadsheet_Excel_Writer 
```

您也可以不使用 PEAR 直接在此处下载包：http: [//download.pear.php.net/package/Spreadsheet_Excel_Writer-0.9.1.tgz](http://download.pear.php.net/package/Spreadsheet_Excel_Writer-0.9.1.tgz)。如果脚本位于包含路径中的任何位置，则它非常易于使用。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-05T19:17:44.033

对于您的个人计算机，使用大多数 PHP 发行版附带的“pear”脚本是个好主意。

对于共享主机，您可以

*   手动跟踪您的依赖关系，并自己将所有适当的文件复制到服务器
*   安装 pear 后，执行*"pear install -R/my/root_dir -a Spreadsheet_Excel_Writer"*。这会将包和所有依赖项安装到指定的根目录。将此安装复制到您的虚拟主机。

您还应该看看*"pear help"*和*"pear help install"*。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-05T19:15:58.173

您无法将 pear 安装到您的 isp 核心。但是您可以从 pear 的站点安装各个文件并将它们上传到您的主机：

[http://pear.php.net/package/Spreadsheet_Excel_Writer/download](http://pear.php.net/package/Spreadsheet_Excel_Writer/download)

# eclipse - 从命令行构建多个 CDT C++ 项目

> ID：344797
> 
> 赞同：36
> 
> 时间：2008-12-05T18:55:53.953
> 
> 标签：eclipse, command-line, eclipse-cdt

从命令行构建多个 CDT C++ 项目的最佳解决方案是什么？这些项目有参考，因此不可能只构建单个项目。

* * *

## 回答 #1

> 赞同：65
> 
> 时间：2009-06-07T19:22:05.793

此功能已在 CDT 6 中添加（最终版本将于 2009 年 6 月 15 日到期）。您可以从构建页面下载最终候选版本：download.eclipse.org/tools/cdt/builds/6.0.0/。

使用 Eclipse 3.5 + CDT 6 版本，您可以使用在命令行中发送到 Eclipse 的以下选项来导入、构建和清理构建项目和工作区：

```
eclipse -nosplash 
        -application org.eclipse.cdt.managedbuilder.core.headlessbuild 
        -import {[uri:/]/path/to/project} 
        -build {project_name | all} 
        -cleanBuild {projec_name | all} 
```

在 Windows 上，使用[`eclipsec.exe`](https://wiki.eclipse.org/FAQ_How_do_I_run_Eclipse%3F)而不是`eclipse.exe`将构建输出写入 stdout/stderr，以便调用阻塞直到完成。

“ *-application* ”开关指示 Eclipse 运行 CDT 无头构建器，而不是启动工作台。其他开关可以单独使用或一起使用。这意味着您可以使用自己的 shell 脚本签出项目，将其“ *-import* ”到工作区，并使用*Managedbuilder*的无头构建器“-build”它。

使用' *-data* '开关来指定要使用的工作区，可以是一个空的临时目录，平台运行时支持的其他开关见运行时文档： [help.eclipse.org/galileo/index.jsp?topic=/ org.eclipse.platform.doc.isv/reference/misc/runtime-options.html](http://help.eclipse.org/galileo/index.jsp?topic=/org.eclipse.platform.doc.isv/reference/misc/runtime-options.html)

有关已提交功能的更多详细信息，请参阅[错误 186847 评论 24及以后。](https://bugs.eclipse.org/bugs/show_bug.cgi?id=186847#c24)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-07T19:57:47.047

在 CDT 6 之前，您可以使用 JDT 的[AptBuilder](http://help.eclipse.org/help32/index.jsp?topic=/org.eclipse.jdt.doc.isv/reference/apt/org/eclipse/jdt/apt/core/build/package-summary.html)（例如包含在经典 Eclipse 中）。

这使您可以构建已配置的工作区。所以你：签出你的源代码，配置一个指向签出项目的工作区。然后，您的自动构建脚本可以更新检出并运行 AptBuilder，而无需启动 GUI。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-29T19:47:15.850

当前不支持使用管理构建器进行无头构建，请参阅[错误 186847 - CDT 内部构建器不支持自动命令行构建](https://bugs.eclipse.org/bugs/show_bug.cgi?id=186847)。

如果您使用非托管（make）构建器，那么您已经拥有可以从命令行使用的 Makefile。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-05T18:29:10.793

如果您在 CDT 下创建了 Make 项目，您可以使用您最喜欢的 shell 并在所有项目目录中执行 make。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2009-01-05T21:31:25.933

我们在现有版本中执行此操作。

在所有外部引用和顶级项目中放置一个生成文件。在您的“全部”规则中，让它运行： make -C ./externalref1 make -C ./externalref2 等

我们实际上在一个变量中定义了外部依赖项：EXT_DEP = externalref1 externalref2 然后使用 subst（替代）命令使用正确的调用启动所有子制作。

# javascript - 优化 YUI 数据表中多行的删除

> ID：344801
> 
> 赞同：2
> 
> 时间：2008-12-05T18:58:02.483
> 
> 标签：javascript, yui, yui-datatable

删除操作似乎是 YUI 数据表中最慢的。我有一个 > 300 行的数据表。我需要删除选定的行。我尝试从 中删除选定的记录`recordset`，然后调用`table.render()`.. 虽然这没关系，但可以做得更好吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-06T20:39:31.637

查看有关数据表小部件的“deleteRow”方法的 API 文档（位于[http://developer.yahoo.com/yui/docs/YAHOO.widget.DataTable.html#method_deleteRow](http://developer.yahoo.com/yui/docs/YAHOO.widget.DataTable.html#method_deleteRow)）。在我看来，这就是您想要的。也许是这样的：

```
var selected = theDataTable.getSelectedRows();
var rset = theDataTable.getRecordSet();

for (var x = 0; x < selected.length; x++) {
    theDataTable.deleteRow(rset.getRecordIndex(rset.getRecord(selected[x]))
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-07T06:40:51.423

不，这比我写的要慢。在这里，您逐行删除，并且每次都必须重新渲染数据表。

我所做的是从他的记录集中删除这些记录，然后将数据渲染一次。那更快，但不是很多。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-08T15:04:25.980

据我所知，这是从 yui 数据表中删除一行的最快方法。但是，为了您的用户着想，除非需要 300 行，否则您应该考虑在 2.6.0 版中改进的分页（并且已被拆分，现在可以用于其他对象，而不仅仅是 DataTable）。

# php - 如何格式化 PHP include() 绝对（而不是相对）路径？

> ID：344823
> 
> 赞同：23
> 
> 时间：2008-12-05T19:10:46.700
> 
> 标签：php, path, include

在我的 PHP 网站的各个页面以及各种嵌套目录中，我想在相对于根目录的路径中包含一个特定文件。

我可以在这两个页面上输入什么命令...

```
http://www.example.com/pageone.php
```

```
http://www.example.com/somedirectory/pagetwo.php
```

...包括此页面：

```
http://www.example.com/includes/analytics.php
```

这不起作用：

```
<?php include('/includes/analytics.php'); ?> 
```

将其托管在 Windows 上的 IIS 中是否重要？

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2008-12-05T19:24:13.100

你可以使用`include $_SERVER['DOCUMENT_ROOT'] . "/includes/analytics.php";`

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2008-12-05T19:31:00.670

从 PHP 的角度来看，root 是 Web 服务器上文件系统的顶部，而不是从 Web 浏览器的角度来看的 root。

大多数人会执行以下操作之一。

在全局配置文件中定义一个常量，并在每次调用 require/include 时使用它。

或者他们使用这样的代码。

```
require_once realpath(dirname(__FILE__).'/config.php');
require_once realpath(dirname(__FILE__).'/lib/Database.php'); 
```

在某些情况下，使用环境变量可能很危险，并且会成为安全问题的根源。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2008-12-05T19:20:53.560

正如@Stefan Mai 所说，PHP 没有“根”路径，但您可以很容易地定义一个 - 大多数网站都有一个每次都包含的页面（例如配置文件），您可以添加：

```
define('ROOT', dirname(__FILE__)); 
```

然后使用包含 ROOT 。'/includes/analytics.php';

auto_prepend 指令也很有用，您可以在 apache 的 .htaccess 中使用它——不确定是否在 IIS 上设置它（尽管您可以在 PHP ini 中使用全局指令）。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2008-12-05T19:25:01.493

如果您给 include() 或 require()（或 *_once 版本）一个绝对路径名，该文件将被包含在内。绝对路径名在 unix 上以“/”开头，在 Windows 上以驱动器号和冒号开头。

如果您给出相对路径（任何其他路径），PHP 将按顺序搜索配置值“include_path”中的目录，直到找到匹配项或没有更多目录可搜索。

因此，简而言之，要包含绝对文件名，请给出绝对文件名。另请参见函数[realpath()](http://www.php.net/realpath)。

如果您想设置自己的包含“root”，请查看[这个问题](https://stackoverflow.com/questions/344419/how-do-i-set-an-absolute-include-path-in-php)（当然特别是我的回答 :-)

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2010-12-13T06:02:47.037

我结合了上述建议并想出了这个。

在我的`config.php`文件中，我将 ROOT 定义为：

`define('ROOT', $_SERVER['DOCUMENT_ROOT']);`

然后我在我的后续文件中使用它：

`include_once(ROOT."/someFile.php");`

`include_once(ROOT."/includes/someFile.php");`

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-12-05T19:15:12.353

使用 .. 上一级目录。所以在 pageone.php

```
include 'includes/analytics.php'; 
```

在 pagetwo.php

```
include '../includes/analytics.php'; 
```

据我所知，在 PHP 中没有您所指的“根”的概念，尽管您可以根据需要定义它。祝你好运！

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-12-05T19:29:09.567

这行得通。

```
<?php include('c:/inetpub/example.com/includes/analytics.php'); ?> 
```

我必须使该`c:/inetpub/example.com/`部分成为某种全局变量，以便它在服务器之间具有一定的可移植性。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-12-05T19:25:23.770

波浪号被 shell 解释为一个特殊字符，因此无论操作系统如何，在 PHP 代码中使用它都不起作用。

如果您尝试访问与用户主目录相关的内容，您可以尝试`getenv()`- 我很确定 Windows 设置了一个等效于`$HOME`.

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2013-09-09T20:18:07.997

我找到的方法是：

```
<?php include $_SERVER['DOCUMENT_ROOT'].'\\Your\\Site\\Path.php' ?> 
```

当您有一些可以转义的特殊字符（即 \n）时，\\ 是必需的，因此 \\ 是字符串上的 \。

因为你在windows中，所以你必须使用\而不是/

# python - 在 Django Schools 的模型设计中寻找输入

> ID：344826
> 
> 赞同：2
> 
> 时间：2008-12-05T19:13:41.047
> 
> 标签：python, django, django-models

今天我开始了一个小项目来创建一个基于 Django 的学校管理程序。我目前正在设计模型及其对应关系。作为 Django 和一般关系数据库的新手，我想要一些输入。

在我向您展示当前的模型布局之前，您需要了解该程序的用途。请记住，我的目标是让各个学校和整个学校系统都可以使用该软件。

特点： - 创建多所学校
- 跟踪每所学校的学生人数
- 跟踪学生人口统计数据、家长联系信息等
- 成绩册
- 成绩单
- 跟踪纪律记录。
- 费用表和付款跟踪
- 生成报告（学生活动、学生成绩单、班级进度、人口统计进度、付款报告、学生班级和人口统计纪律报告）
- 自动 PDF 报告电子邮件发送给家长以获取学生报告。

鉴于这些功能要求，这是我目前拥有的模型布局：

```
* Person
      o ID: char or int
      o FirstName: char
      o MiddleName: char
      o FamilyName: char
      o Sex: multiple choice
      o Ethnicity: multiple choice
      o BirthDate: date
      o Email: char
      o HomePhone: char
      o WordPhone: char
      o CellPhone: char
      o Address: one-to-one with Location
* Student (inherent Person)
      o Classes: one-to-many with Class
      o Parents: one-to-many with Parent
      o Account: one-to-one with PaymentSchedule
      o Tasks: one-to-many with Tasks
      o Diciplin: one-to-many with Discipline
* Parent (inherent Person)
      o Children: one-to-many with Student
* Teacher (inherent Person)
      o Classes: one-to-many with Class
* Location
      o Address: char
      o Address2: char
      o Address3: char
      o City: char
      o StateProvince: char
      o PostalCode: char
      o Country: multiple choice
* Course
      o Name: char
      o Description: text field
      o Grade: int
* Class
      o School: one-to-one with School
      o Course: one-to-one with Course
      o Teacher: one-to-one with Teacher
      o Students: one-to-many with Student
* School
      o ID: char or int
      o Name: char
      o Location: one-to-one with location
* Tasks
      o ID: auto increment
      o Type: multiple choice (assignment, test, etc.)
      o DateAssigned: date
      o DateCompleted: date
      o Score: real
      o Weight: real
      o Class: one-to-one with class
      o Student: one-to-one with Student
* Discipline
      o ID: auto-increment
      o Discription: text-field
      o Reaction: text-field
      o Students: one-to-many with Student
* PaymentSchedule
      o ID: auto-increment
      o YearlyCost: real
      o PaymentSchedule: multiple choice
      o ScholarshipType: multiple choice, None if N/A
      o ScholarshipAmount: real, 0 if N/A
      o Transactions: one-to-many with Payments
* Payments
      o auto-increment
      o Amount: real
      o Date: date 
```

如果您对如何改进这一点有任何想法，我很乐意为他们服务！

# 更新

我已经编写了最初的 models.py 代码，这可能需要很多的爱。如果您想看一下，甚至想加入该项目，请查看链接。
[http://bazaar.launchpad.net/~djangoschools/djangoschools/trunk/files](http://bazaar.launchpad.net/~djangoschools/djangoschools/trunk/files)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-05T21:41:53.027

一些可能的问题：

对于位置对象，如果将来需要为一个人保存家庭地址、工作地址等怎么办？电子邮件地址和电话号码也是如此 - 我将电话号码作为他们自己的对象。

在您的地址对象中包含一个 Address_3。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-05T19:51:46.323

快速浏览一下，我认为它相当全面。也许您应该允许多位教师参与一门课程，并允许在家长和学生之间重复使用地址/位置。

作为一般规则，我会说您应该开始实施，然后您会发现需要改进的地方。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-01-25T19:36:01.463

学生没有班级。他/她参加了一个有他们的班级（在名册中）。这是查看班级情况的另一种方式。（注意模型的名称。那只是因为我倾向于不命名任何“类”，因为这样很容易发生名称冲突。）

```
class SchoolClass(models.Model):
    teacher = models.ManyToManyField(Teacher, related_name='teachers')
    student = models.ManyToManyField(Student, related_name='students')
    prerequisites = models.ForeignKey('self')
    startdate = models.DateField()
    enddate = models.DateField()
    ... and so on ... 
```

这更自然，因为您可以与学生一起上课并根据学生列表进行出勤，或者以自然的方式汇总成绩、学生年龄等。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-05T22:33:48.320

我建议您不要担心底层关系数据库。是的，您需要了解外键是什么以及多对多和一对多之间的区别等，但是您应该根据 Django 类来考虑您的模型。无论如何，这就是你必须编写它们的方式，所以这就是我要开始的地方。模型上的[Django 文档](http://docs.djangoproject.com/en/dev/topics/db/models/)很棒，对你有很大帮助。

我想这里的每个人都会很乐意帮助你学习 Python 课程；您应该使用 Django 重写您的示例。例如，您的 Person 表如下所示：

```
from django.db import models

SEX_CHOICES = (
    ('M', 'Male'),
    ('F', 'Female')
)

ETHNICITY_CHOICES = (
    # follow the same format as SEX_CHOICES:
    # (database_value, human_friendly_name)
)

class Person(models.Model):
    first_name   = models.CharField(max_length=200)
    middle_name  = models.CharField(max_length=200)
    familiy_name = models.CharField(max_length=200) 

    sex = models.CharField(max_length=1, choices=SEX_CHOICES)
    ethnicity  = models.CharField(max_length=1, choices=ETHNICITY_CHOICES)
    birth_date = models.DateField()

    email = models.EmailField()
    home_phone = models.CharField(max_length=10) # USA phone numbers
    work_phone = models.CharField(max_length=10)
    cell_phone = models.CharField(max_length=10)
    address = models.ForeignKey(Location)

class Location(models.Model):
    # left as an exercise for the reader

# more classes... 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-05T20:16:53.667

看起来是一个有趣的项目。请注意，Django 具有比 SQL 更高级别的类型，因此您可以使用电子邮件地址类型之类的东西。

如果您计划以[GAE](http://code.google.com/appengine/)为目标，您应该找到一[组同样丰富的模型类型](http://code.google.com/appengine/docs/datastore/typesandpropertyclasses.html)。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-05T20:19:08.497

嘿...我同意...看起来不错。有人建议我在所有表上使用自动增量，以确保每条记录上确实有一个唯一的 ID。如果你想走那条路，这是你的选择。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-12-05T20:40:28.737

您应该将付款（交易）与相关人员联系起来。

# c# - 如何使用 Linq to SQL 检索存储过程模式？

> ID：344828
> 
> 赞同：1
> 
> 时间：2008-12-05T19:14:24.963
> 
> 标签：c#, visual-studio-2008, linq, linq-to-sql

基本上我正在尝试使用 Linq to SQL 检索存储过程参数列表？有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-05T19:20:45.183

也许[System.Data.SqlClient.SqlCommandBuilder.DeriveParameters()](http://msdn.microsoft.com/en-us/library/system.data.sqlclient.sqlcommandbuilder.deriveparameters.aspx)会有所帮助。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-05T19:25:52.677

在设计时？只需将存储过程拖到 LINQ 设计器表面即可。

* * *

在运行时？

你需要这样的sql：

```
SELECT *
FROM syscolumns
WHERE id =
(
  SELECT id
  FROM sysobjects
  WHERE Name = @ProcName
) 
```

这可能由 LinqToSql 生成，如下所示：

```
var params = 
  db.sysobjects
  .Where(o => o.Name == ProcName)
  .SelectMany(o =>
    db.syscolumns
    .Where(c => c.id == o.id)
  ) 
```

# c++ - 什么是 __kernel_vsyscall？

> ID：344829
> 
> 赞同：15
> 
> 时间：2008-12-05T19:14:28.347
> 
> 标签：c++, gdb

我得到了一个看起来与我通常得到的内核非常不同的内核——大多数线程都在 __kernel_vsyscall() 中：

```
 9 process 11334  0xffffe410 in __kernel_vsyscall ()
  8 process 11453  0xffffe410 in __kernel_vsyscall ()
  7 process 11454  0xffffe410 in __kernel_vsyscall ()
  6 process 11455  0xffffe410 in __kernel_vsyscall ()
  5 process 11474  0xffffe410 in __kernel_vsyscall ()
  4 process 11475  0xffffe410 in __kernel_vsyscall ()
  3 process 11476  0xffffe410 in __kernel_vsyscall ()
  2 process 11477  0xffffe410 in __kernel_vsyscall ()
  1 process 11323  0x08220782 in MyClass::myfunc () 
```

这意味着什么？

编辑：特别是，我通常在“pthread_cond_wait”和“___newselect_nocancel”中看到很多线程，现在这些线程位于每个线程的第二帧 - 为什么这个核心不同？

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2008-12-05T19:19:39.383

`__kernel_vsyscal`是 linux-gate.so（Linux 内核的一部分）使用最快的可用方法（最好是`sysenter`指令）进行系统调用的方法。[Johan Petersson](http://www.trilithium.com/johan/2005/08/linux-gate)正确解释了这件事。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2008-12-05T19:19:26.870

当您进行系统调用（例如从文件读取、与硬件通信、写入套接字）时，您实际上是在创建中断。然后系统在内核模式下处理中断，您的调用将返回结果。在大多数情况下，除非您进行阻塞调用，否则您在系统调用中拥有大量线程是不寻常的，在这种情况下，这是意料之中的。

更具体地说，这意味着线程正在等待内核级系统调用。但这（不幸的是我的观点）已经在名称中了:)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-07T07:33:37.153

除了已经给出的解释什么`linux-gate.so`的良好链接之外，我想回答“为什么这个核心不同？”。最新（比 2.5.68 更新）32 位 Linux 系统使用 VDSO 页面（aka `linux-gate.so.1`），64 位系统也将很快启动（内核 2.6.24 中引入了 64 位 VDSO）。

如果您在较旧的系统上开发，或者使用旧的 glibc，那么您将永远看不到`__kernel_vsyscall()`.

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-08-27T13:03:42.190

正如亚当所说，主要原因是性能。请参阅此链接了解一些旧号码[http://lkml.org/lkml/2002/12/9/13](http://lkml.org/lkml/2002/12/9/13)。

如果你有一个启用 vDSO 的内核，你就没有使用中断来运行系统调用，正如 Stefan 所说，实际上是因为中断变得越来越慢，整个 vDSO 都被添加到了内核中。

# .net - 在 .NET 中与 Exchange 通信

> ID：344834
> 
> 赞同：2
> 
> 时间：2008-12-05T19:16:29.873
> 
> 标签：.net, exchange-server

我想使用 Exchange 电子邮件组作为内部应用程序的身份验证方案。IE，如果用户在某个邮件组中，则允许他们进入。

关于从 .NET 与 Exchange 交谈时在哪里查找信息的任何指示？

编辑：交换 2003。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-07T23:30:51.543

您无需与 Exchange 本身交谈。所有数据都存储在 Active Directory 中，它在 .NET 框架中具有非常易于使用的 API。Exchange 电子邮件组作为全局通讯组存储在 AD 中。您需要做的就是询问用户是否是特定组的成员。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-08T01:54:03.813

您确定要对通讯组执行此操作吗？从长远来看，将这些通讯组转变为安全组并使用 Windows 身份验证不是更易于管理吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-05T19:23:04.197

如果您有 Exchange 2007，则可以使用 Web 服务接口从 .NET 与 Exchange 对话。

> [http://msdn.microsoft.com/en-us/library/bb408417.aspx](http://msdn.microsoft.com/en-us/library/bb408417.aspx)

不过我还没有使用过这个接口，所以我不确定它是否适合你的场景。

否则恐怕你必须使用旧的 MAPI/COM 库。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-05T19:34:57.823

Exchange 2003 支持 webdav 界面。你可能想看看它是否支持你需要的东西。这里有一个用于 Exchange 库的 WebDav .Net：http: [//www.independentsoft.de/webdavex/index.html](http://www.independentsoft.de/webdavex/index.html)

在此处查看更多信息： [使用 WebDAV 访问 Exchange 2003 收件箱](https://stackoverflow.com/questions/263724/using-webdav-to-access-exchange-2003-inbox)

# xml - 在 SQL Server 中轻松使用 Excel 数据

> ID：344845
> 
> 赞同：3
> 
> 时间：2008-12-05T19:20:15.230
> 
> 标签：xml, vba, excel

我经常需要将 Excel 电子表格中发送给我的数据与 SQL Server 中的数据进行比较。我知道您可以将 SQL Server 连接到电子表格，但它总是显得笨拙

这确实是一个炫耀我的解决方案的帖子，但我很想听听其他人的想法。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-05T19:20:37.477

为获得最佳效果，请将以下代码粘贴到您的 personal.xls 文件中的模块中。您将需要添加对 Microsoft Forms 2.0 对象库的引用。

当您运行此例程时，它会获取当前突出显示的区域并创建一个 XML 字符串。它还创建 TSQL 以将该 XML 转换为名为 #tmp 的临时表。它还将 TSQL 粘贴到剪贴板中。它做了很多假设，默认的临时表都是 VARCHAR(100)。

我将此例程绑定到 Cntl-Shift-X。

最终结果是，如果我突出显示一个区域（带有标题），单击 Cntl-Shift-X，然后进入查询窗口，我可以立即访问 SQL 中的电子表格数据。

我没有为我节省大量时间。

欢迎提出改进建议:o)

```
Sub CreateOpenXML()

    Dim cols, rows As Long
    cols = Selection.Columns.Count
    rows = Selection.rows.Count
    Dim Header() As String
    ReDim Preserve Header(cols)
    For i = 1 To cols  '''Each Column In Selection.Rows(0).Columns
        Header(i) = CleanHeader(Selection.Cells(1, i).Value)
        'Header(i) = Application.WorksheetFunction.Substitute(CleanString(Selection.Cells(1, i).Value), " ", "_")
        'Header(i) = Application.WorksheetFunction.Substitute(Header(i), "(", "_")
        'Header(i) = Application.WorksheetFunction.Substitute(Header(i), ")", "_")
        'i = i + 1
    Next
    Dim theXML As String, tmpXML As String, counter As Integer

    theXML = "DECLARE @DocHandle int" & vbCrLf
    theXML = theXML & "DECLARE @XmlDocument varchar(8000)" & vbCrLf
    theXML = theXML & "EXEC sp_xml_preparedocument @DocHandle OUTPUT, N'<theRange>" & vbCrLf
    tmpXML = ""
    counter = 0
    For i = 2 To rows
        tmpXML = tmpXML & vbTab & "<theRow>"
        For j = 1 To cols
            If Selection.Cells(i, j).Text <> "NULL" And Selection.Cells(i, j).Text <> "" Then
                tmpXML = tmpXML & "<" & Header(j) & ">" & CleanString(Selection.Cells(i, j).Text) & "</" & Header(j) & ">"
                'tmpXML = tmpXML & CleanString(Selection.Cells(i, j).Text)
                'tmpXML = tmpXML & "</" & Header(j) & ">"
            End If
        Next j
        tmpXML = tmpXML & "</theRow>" & vbCrLf
        counter = counter + 1
        If counter = 200 Then
            theXML = theXML & tmpXML
            tmpXML = ""
            counter = 0
        End If
    Next i
    theXML = theXML & tmpXML
    theXML = theXML & "</theRange>'" & vbCrLf & vbCrLf
    '''theXML = theXML & "EXEC sp_xml_preparedocument @DocHandle OUTPUT, @XmlDocument" & vbCrLf
    theXML = theXML & "SELECT "
    For i = 1 To cols
        theXML = theXML & "[" & Header(i) & "]"
        If i <> cols Then theXML = theXML & ", "
    Next
    theXML = theXML & vbCrLf
    theXML = theXML & "INTO #tmp"
    theXML = theXML & vbCrLf
    theXML = theXML & "FROM OPENXML (@DocHandle, '/theRange/theRow',2) WITH (" & vbCrLf
    For i = 1 To cols
        theXML = theXML & vbTab & "[" & Header(i) & "] varchar(100)"
        If i <> cols Then theXML = theXML & ","
        theXML = theXML & vbCrLf
    Next
    theXML = theXML & ")" & vbCrLf
    theXML = theXML & "EXEC sp_xml_removedocument @DocHandle" & vbCrLf
    theXML = theXML & vbCrLf
    theXML = theXML & "Select * from #tmp" & vbCrLf
    theXML = theXML & vbCrLf
    theXML = theXML & "--DROP TABLE  #tmp"
    theXML = theXML & vbCrLf
    MsgBox "The XML has been copied to the clipboard"
    Dim dob As New DataObject
    dob.SetText (theXML)
    dob.PutInClipboard

End Sub

Function CleanString(orig As String)
    Dim tmp As String
    tmp = orig
    '''MsgBox InStr(orig, "&")
    If InStr(orig, "&") > 0 Or InStr(orig, "'") > 0 Or InStr(orig, "<") > 0 Or InStr(orig, ">") > 0 Or InStr(orig, """") > 0 Then
        tmp = Application.WorksheetFunction.Substitute(tmp, "&", "&amp;")
        tmp = Application.WorksheetFunction.Substitute(tmp, "'", "&apos;")
        tmp = Application.WorksheetFunction.Substitute(tmp, "<", "&lt;")
        tmp = Application.WorksheetFunction.Substitute(tmp, ">", "&gt;")
        tmp = Application.WorksheetFunction.Substitute(tmp, """", "&quot;")
    End If
    CleanString = tmp

End Function

Function CleanHeader(orig As String)
    Dim tmp As String
    tmp = Trim(orig)
    If InStr(orig, " ") > 0 Or InStr(orig, "(") > 0 Or InStr(orig, ")") > 0 Or InStr(orig, "$") > 0 Or InStr(orig, "/") > 0 Or InStr(orig, "?") > 0 Or InStr(orig, "&") > 0 Or InStr(orig, "'") > 0 Or InStr(orig, "<") > 0 Or InStr(orig, ">") > 0 Or InStr(orig, """") > 0 Then
        tmp = Application.WorksheetFunction.Substitute(tmp, "&", "And")
        tmp = Application.WorksheetFunction.Substitute(tmp, "'", "_")
        tmp = Application.WorksheetFunction.Substitute(tmp, "<", "")
        tmp = Application.WorksheetFunction.Substitute(tmp, ">", "")
        tmp = Application.WorksheetFunction.Substitute(tmp, """", "")
        tmp = Application.WorksheetFunction.Substitute(tmp, " ", "_")
        tmp = Application.WorksheetFunction.Substitute(tmp, "(", "_")
        tmp = Application.WorksheetFunction.Substitute(tmp, ")", "_")
        tmp = Application.WorksheetFunction.Substitute(tmp, "$", "")
        tmp = Application.WorksheetFunction.Substitute(tmp, "/", "")
        tmp = Application.WorksheetFunction.Substitute(tmp, "?", "")
    End If
    CleanHeader = tmp

End Function

Sub MakeText()

    ActiveCell.CurrentRegion.Select
    Dim rng As Range
    Set rng = Selection

    Dim str As String
    For i = 1 To rng.rows.Count
        For j = 1 To rng.Columns.Count
            str = Application.WorksheetFunction.Text(rng.Cells(i, j).Value, "#")
            rng.Cells(i, j).NumberFormat = "@"
            rng.Cells(i, j).Value = str
        Next j
    Next i

End Sub 
```

正如所建议的，这里有一个例子。考虑这个电子表格数据：

```
Name              DOB       Score   Comment
John Smith        7/1/1990  93      Great effort
Sue Jones         1/1/1989  95      Super achievement
Robin Sixpack     12/1/1985 100     OK 
```

此方法将生成以下 TSQL：

```
DECLARE @DocHandle int
DECLARE @XmlDocument varchar(8000)
EXEC sp_xml_preparedocument @DocHandle OUTPUT, N'<theRange>
    <theRow><Name>John Smith</Name><DOB>7/1/1990</DOB><Score>93</Score><Comment>Great effort</Comment></theRow>
    <theRow><Name>Sue Jones</Name><DOB>1/1/1989</DOB><Score>95</Score><Comment>Super achievement</Comment></theRow>
    <theRow><Name>Robin Sixpack</Name><DOB>12/1/1985</DOB><Score>100</Score><Comment>OK</Comment></theRow>
</theRange>'

SELECT [Name], [DOB], [Score], [Comment]
INTO #tmp
FROM OPENXML (@DocHandle, '/theRange/theRow',2) WITH (
    [Name] varchar(100),
    [DOB] varchar(100),
    [Score] varchar(100),
    [Comment] varchar(100)
)
EXEC sp_xml_removedocument @DocHandle

Select * from #tmp

--DROP TABLE  #tmp 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-05T21:23:50.300

我发现当我不得不处理包含不确定格式的数据且可能随时间变化的数据的电子表格时，我往往会突然爆发。

对代码的一些观察：

`Application.WorksheetFunction.Substitute`VB/VBA 有`Replace`功能，功能更简洁一些。从性能的角度来看，这可能并不是特别重要，但通常应该尝试在代码中引用`Application`对象或`Workbook/Worksheets`尽可能少地引用对象，因为从代码到应用程序的往返成本确实会增加。出于这个原因，当遍历 a 时`Range`，将值加载到 a 通常是很有意义的`Variant`，如

```
Dim values as Variant
values = Selection.Values 
```

并循环遍历数组以消除每次引用`.Cells`.

我有点无聊`theXML = theXML &`——很难看到发生了什么。例如，您可能会考虑编写一个小 StringBuilder 类，这样您就可以减少

```
 theXML = theXML & "INTO #tmp" 
```

到

```
 sb.Add "INTO #tmp" 
```

Add 方法也可以处理所有这些`& vbCrLf`事务，坦率地说，这将是一件好事。

也就是说，我想知道需要这种定期检查的业务流程。是否打算确保两个地方的数据相同？重复/协调通常是需要重构的过程的标志。如果您正在寻找差异，是否有更好的记录方法？如何改变事情以使数据只能在数据库中更改？就是想...

# python - Django Admin 的“现场查看”指向 example.com 而不是我的域

> ID：344851
> 
> 赞同：29
> 
> 时间：2008-12-05T19:23:11.823
> 
> 标签：python, django, django-admin

我为我的一个模型添加了一个`get_absolute_url`功能。

```
def get_absolute_url(self):
    return '/foo/bar' 
```

管理站点选择它并向该对象的详细信息页面添加一个“站点视图”链接（当我在那里放置一个真实的 URL 而不是“/foo/bar”时）。

问题不是去`http://localhost:8000/foo/bar`，而是去`http://example.com/foo/bar`。

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2008-12-05T19:46:26.957

您必须更改[默认站点](http://docs.djangoproject.com/en/dev/ref/contrib/sites/#ref-contrib-sites)域值。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2010-02-27T23:30:00.980

最有趣的是“example.com”出现在一个明显的地方。然而，我在一个小时左右的时间内寻找。

只需使用您的管理界面 -> 站点 -> ... 就是这样 :)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-12-17T09:51:40.540

如果您启用了管理员，您可以在 /admin/sites 中更改此设置。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2012-07-10T19:58:13.830

正如其他人所提到的，这与[默认`sites`框架](https://docs.djangoproject.com/en/1.4/ref/contrib/sites/#how-django-uses-the-sites-framework)有关。

如果您使用[South](http://south.aeracode.org)进行数据库迁移（通常可能是一个好主意），您可以[使用数据迁移来避免在部署应用程序](http://codeinthehole.com/writing/a-data-migration-for-every-django-project/)的任何地方都必须进行相同的数据库更改，如下所示

```
from south.v2 import DataMigration
from django.conf import settings

class Migration(DataMigration):

    def forwards(self, orm):
        Site = orm['sites.Site']
        site = Site.objects.get(id=settings.SITE_ID)
        site.domain = 'yoursite.com'
        site.name = 'yoursite'
        site.save() 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2019-03-04T15:58:06.580

如果您使用的是较新版本的 django。数据迁移是这样的：

```
from django.conf import settings
from django.db import migrations

def change_site_name(apps, schema_editor):
    Site = apps.get_model('sites', 'Site')
    site = Site.objects.get(id=settings.SITE_ID)
    site.domain = 'yourdomain.com'
    site.name = 'Your Site'
    site.save()

class Migration(migrations.Migration):

    dependencies = [
        ('app', '0001_initial'),
    ]

    operations = [
        migrations.RunPython(change_site_name),
    ] 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-07-10T19:48:26.317

当您编辑了管理员认为的站点实例后，您需要重新启动 Web 服务器以使更改生效。我想这一定意味着只有在 Web 服务器首次启动时才读取数据库。

# javascript - 打印或回显一个 javascript 变量，不是到文档，而是作为值或值的一部分，到 DOM 元素，特别是表单操作

> ID：344856
> 
> 赞同：0
> 
> 时间：2008-12-05T19:25:07.593
> 
> 标签：javascript, html, dom

我有一个表单操作，需要从变量中设置其值。我需要设置一次变量，它将在整个 DOM 中多次反映。

所以：

变量=“somthing.html”；...

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-05T19:28:40.470

然后，您可以将表单操作更改为等于变量名称。类似于以下内容。

```
var variableName = "myform.htm";

this.form.action = variableName; 
```

编辑，您也可以对其他元素执行此操作，就像使用任何其他 javascript 一样，使用诸如“getElementById()”之类的东西从 DOM 中获取项目

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-05T19:34:21.990

这将导致所有 FORM 获取可变操作：

```
<script src="jquery-1.2.6.pack.js"></script>
<script>
$(document).ready(function() {
    var variable = "something.html";
    $('form').attr("action", variable);
});
</script> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-05T19:31:44.520

我不确定这是否是您要问的，但您可以使用以下命令更改文档的操作：

document.formname.action = "something.html";

# algorithm - 将 N 个列表中的项目组合成一个平衡分布的好算法？

> ID：344860
> 
> 赞同：10
> 
> 时间：2008-12-05T19:26:12.537
> 
> 标签：algorithm, list

假设我有以下三个列表

A1
A2
A3

B1
B2

C1
C2
C3
C4
C5

我想将它们组合成一个列表，每个列表中的项目尽可能均匀分布，如下所示：

C1
A1
C2
B1
C3
A2
C4
B2
A3
C5

我正在使用 .NET 3.5/C#，但我正在寻找更多如何处理它而不是特定代码。

编辑：我需要保留原始列表中元素的顺序。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2008-12-05T19:43:02.720

1.  复制一份成员最多的列表。这将是目的地列表。

2.  然后取出具有下一个最大成员数的列表。

3.  将目标列表长度除以较小的长度，得到大于一的小数值。

4.  对于第二个列表中的每个项目，维护一个浮点计数器。将上一步计算的值相加，并在数学上将其四舍五入到最接近的整数（保持原始浮点计数器不变）。将其插入目标列表中的此位置，并将计数器增加 1 以解决此问题。对第二个列表中的所有列表成员重复此操作。

5.  对所有列表重复步骤 2-5。

编辑：这也具有 O(n) 的优点，这总是很好:)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2015-06-26T03:04:11.610

Andrew Rollings 答案的实施：

```
public List<String> equimix(List<List<String>> input) {

  // sort biggest list to smallest list
  Collections.sort(input, new Comparator<List<String>>() {
     public int compare(List<String> a1, List<String> a2) {
        return a2.size() - a1.size();
     }
  });

  List<String> output = input.get(0);

  for (int i = 1; i < input.size(); i++) {
     output = equimix(output, input.get(i));
  }

  return output;
}

public List<String> equimix(List<String> listA, List<String> listB) {

  if (listB.size() > listA.size()) {
     List<String> temp;
     temp = listB;
     listB = listA;
     listA = temp;
  }

  List<String> output = listA;

  double shiftCoeff = (double) listA.size() / listB.size();
  double floatCounter = shiftCoeff;

  for (String item : listB) {
     int insertionIndex = (int) Math.round(floatCounter);
     output.add(insertionIndex, item);
     floatCounter += (1+shiftCoeff);
  }

  return output;
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-05T19:52:19.580

首先，这个答案更像是一个思路，而不是一个概念解决方案。

好的，所以您有一个包含 3 个项目（A1、A2、A3）的列表，您希望 A1 位于目标列表的前 1/3 中，A2 位于目标列表的第二个 1/3 中，并且 A3在第三个 1/3。同样，您希望 B1 在前 1/2 中，等等...

因此，您将 10 的列表分配为一个数组，然后从包含最多项目的列表开始，在本例中为 C。计算 C1 应落在的位置 (1.5) 将 C1 放在最近的位置，（在本例中，为 1或 2)，然后计算 C2 应该落在哪里 (3.5) 并继续该过程，直到不再有 Cs。

然后使用具有第二多项目数的列表。在这种情况下，A. 计算 A1 的去向 (1.66)，所以先尝试 2。如果您已经将 C1 放在那里，请尝试 1。对 A2 (4.66) 和 A3 (7.66) 执行相同的操作。最后，我们做列表 B。B1 应该在 2.5，所以尝试 2 或 3。如果两者都被采用，请尝试 1 和 4，并继续径向向外移动，直到找到一个空点。对 B2 执行相同的操作。

如果你选择较低的数字，你最终会得到这样的结果：

C1 A1 C2 A2 C3 B1 C4 A3 C5 B2

或者如果您选择较大的数字：

A1 C1 B1 C2 A2 C3 A3 C4 B2 C5

这似乎对您的示例列表非常有效，但我不知道它可以扩展到包含许多项目的许多列表中。试试看，让我知道它是怎么回事。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-05T19:40:41.493

我正在考虑一种分而治之的方法。每次迭代，您将所有元素 > 1 的列表分成两半并递归。当您到达除一个之外的所有列表都属于一个元素的程度时，您可以随机组合它们，弹出一个级别并随机组合从长度为一的帧中删除的列表......等等。

类似以下的事情是我的想法：

```
- filter lists into three categories
    - lists of length 1
    - first half of the elements of lists with > 1 elements
    - second half of the elements of lists with > 1 elements
- recurse on the first and second half of the lists if they have > 1 element
    - combine results of above computation in order
- randomly combine the list of singletons into returned list 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-12-05T22:20:26.490

*   制作列表的哈希表。
*   对于每个列表，将列表中的第 n 个元素存储在键下`(/ n (+ (length list) 1))`
*   可选地，打乱哈希表中每个键下的列表，或以某种方式对它们进行排序
*   通过排序键连接散列中的列表

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-05T19:30:42.853

您可以简单地将三个列表组合成一个列表，然后对该列表进行 UNSORT。未排序的列表应该无需太多努力即可满足您“均匀分布”的要求。

这是 unsort 的一个实现：[http](http://www.vanheusden.com/unsort/) ://www.vanheusden.com/unsort/ 。

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2008-12-05T19:42:25.203

一个快速的建议，在 python-ish 伪代码中：

```
merge = list()
lists = list(list_a, list_b, list_c)
lists.sort_by(length, descending)

while lists is not empty:
    l = lists.remove_first()
    merge.append(l.remove_first())
    if l is not empty:
        next = lists.remove_first()
        lists.append(l)
        lists.sort_by(length, descending)
        lists.prepend(next) 
```

这应该比此处的其他建议更均匀地分配较短列表中的元素。

# windows-mobile - 为windows mobile开发游戏

> ID：344861
> 
> 赞同：1
> 
> 时间：2008-12-05T19:26:12.893
> 
> 标签：windows-mobile

有人知道找到有关 Windows Mobile 游戏开发的好地方吗？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-05T19:29:45.617

您首先需要的是[工具](http://msdn.microsoft.com/en-ca/windowsmobile/bb264337.aspx)和[启动工具包](http://msdn.microsoft.com/en-us/windowsmobile/bb264330.aspx)。此链接适用于 .Net for Windows Mobile。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-09T21:24:40.530

Rob Miles 在 Windows Mobile 设备上进行了[一系列](http://www.robmiles.com/mobile-game-development/)关于游戏编程的网络广播。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-05T19:47:07.063

您还可以查看[MSDN](http://msdn.microsoft.com/en-us/windowsmobile/bb495180.aspx)中的这些视频，这些视频向您展示了 Windows Mobile 上的基本编码（不是游戏，但可以帮助您）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-10-29T08:21:44.073

您可以在 App Hub (http://create.msdn.com/en-US/) 中注册为开发人员并从那里下载所有相关软件。如果您有 WF7 设备并且想要在其上测试您的软件，则需要将其解锁以用于开发目的。您可以在应用程序中心找到执行此操作的指南。
他们似乎有一个很好的文档，加上它是 c#（众所周知并且有据可查）。

祝你好运。

# .net - 在 .Net 中访问网络摄像头时使用哪个 API/库最好？

> ID：344876
> 
> 赞同：3
> 
> 时间：2008-12-05T19:30:56.723
> 
> 标签：.net, desktop-application, webcam, divx

在 .Net 中访问网络摄像头时使用哪个 API 最好？ *（我知道它们可以是特定于网络摄像头的，如果这意味着更好的结果，我愿意购买新的网络摄像头）。*

我想编写一个桌面应用程序，它将从网络摄像头获取视频并将其存储为 MPEG4 格式（DivX、Xvid 等）。我还想从设备访问位图静止图像，以便在帧之间进行图像比较。

我尝试了各种库，但没有一个真正适合（有些存在性能问题（非常不一致的帧速率），有些有图像质量限制，有些似乎无缘无故崩溃了。我想获得高质量的视频（尽可能高据我所知）和不错的帧速率。

我的网络摄像头不仅能胜任这项工作，而且我希望有一个很好的 Managed .Net 库可以帮助我的事业。

网络摄像头 API 都非常糟糕吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-05T20:38:59.190

您从未说过您已经使用过哪些，但我建议您可能想尝试使用 DirectShow.NET 来捕获设备，并尝试使用 FFMPEG 来进行视频转换。您将在 SourceForge 上找到这两个库。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-09-04T00:32:23.887

使用 OpenCV。它是一个计算机视觉库，可以接收来自网络摄像头、图像和视频的输入，并输出视频和图像。它还带有许多图像处理功能，因此它可能是您想要的理想选择。

# asp.net - 从 javascript 触发 ASP.NET 事件

> ID：344881
> 
> 赞同：2
> 
> 时间：2008-12-05T19:33:10.197
> 
> 标签：asp.net, javascript, updatepanel

我正在使用 XMLHTTPRequest 对象从 javascript 进行一些直接的异步调用。成功后，使用某些返回值，我想在更新面板上进行异步回发并运行一些服务器端方法。这是关于我现在如何实施它：

```
<script language="javascript">
      function AjaxCallback_Success(objAjax) {
        if (objAjax.responseText == "refresh") {
                document.getElementById('<%= btnHidden.ClientID %>').click();
         }
      }
    </script>
    <asp:UpdatePanel ID="upStatus" runat="server">
    <ContentTemplate>
<asp:Button ID="btnHidden" runat="server" style="display: none;" OnClick="SomeMethod" />
    <asp:DropDownList ID="ddlStatus" field="Orders_Status" parent="Orders" runat="server">
    </asp:DropDownList>
    </ContentTemplate>
    </asp:UpdatePanel> 
```

这与工作流程有关。如果在您处理订单时，有人为其开具发票，那么状态下拉列表中的可用选项实际上会发生变化。因此，定时甚至会检查更改，如果有更改，这通常不会发生，更新面板会发回，下拉列表会根据来自 ajax 响应文本的各种返回值重新绑定到新数据表.

我的原始代码实际上比这复杂得多，但我已经抽象到足以使我的概念更清晰。是否有更好、更简洁的方法来做到这一点，方法是删除隐藏按钮并进行直接的 javascript 调用，这将导致更新面板异步回发并运行服务器端方法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-05T19:43:43.607

使用 UpdatePanel 时要非常小心，如果使用不当，它们可能会非常沉重，正如我[在此处](http://www.aaron-powell.com/blog.aspx?id=1195)解释的那样。

但是提交表单的 JavaScript 是：

```
__doPostBack('eventTarget','eventArguments'); 
```

所以在你的例子中，你会有类似的东西：

```
__doPostBack('<%= btnHidden.ClientID %>',''); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-05T19:48:01.570

您可以删除隐藏按钮并调用

__doPostBack('upStatus','');

这将导致该更新面板的异步更新

# sql-server - 从 SQL Server 2005 将数据导出为固定宽度文件

> ID：344906
> 
> 赞同：3
> 
> 时间：2008-12-05T19:44:48.317
> 
> 标签：sql-server

我认为将视图中的数据从 SQL Server 2005 导出到固定宽度的文本文件是一项非常简单的任务。但是法师很痛苦。格式不正确。有人知道如何处理吗？或任何更好的方法来做到这一点？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-05T20:42:09.730

将 bcp 与 queryout 选项一起使用 [http://msdn.microsoft.com/en-us/library/ms162802(SQL.90).aspx](http://msdn.microsoft.com/en-us/library/ms162802(SQL.90).aspx)

```
bcp "SELECT * FROM AdventureWorks.Person.Contact" queryout Contacts.txt -c -T 
```

如果您想要固定宽度的输出，请使用格式文件

[http://weblogs.sqlteam.com/brettk/archive/2006/07/06/10504.aspx](http://weblogs.sqlteam.com/brettk/archive/2006/07/06/10504.aspx)

我刚刚尝试在 AdventureWorks 中导出，Fixed Width 也给了我很多问题（与列分隔符相比）我不得不忽略 GUID 列，不包括第一行中的列名等。最后导出了 Sales.Customer 表

如果没有 BCP，您可能必须查看 SSIS 或 SQLCMD

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-05T21:44:29.480

一种选择是使用 OpenDataSource 将行写入文本文件。这要求文本文件已经存在，但相对容易。

这篇文章（为了披露，我写了它，它侧重于读取，但也涉及写入）解释了使用 OpenDataSource 从文本文件读取和写入的基础知识。： [http ://www.sqlservercentral.com/articles/OpenDataSource/61552/](http://www.sqlservercentral.com/articles/OpenDataSource/61552/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-05T20:14:47.553

如果向导中的格式不适合您的需要，您将需要开发自己的 SSIS 包。你确定你真的需要一个固定宽度的文件吗？分隔文件可能更容易正确，因为它们更常见。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-05T23:54:13.010

我发现 SQL2005/SSIS 做看似简单的任务绝非易事。事情总是比他们应该花的时间长 5 倍。我知道我并不孤单。

BCP 应该可以工作。

不了解 sqlcmd - 似乎它不做固定宽度，除非你在你的 sql 语句中做了填充 - 这也会很痛苦。

```
usage: Sqlcmd            [-U login id]          [-P password]
  [-S server]            [-H hostname]          [-E trusted connection]
  [-d use database name] [-l login timeout]     [-t query timeout]
  [-h headers]           [-s colseparator]      [-w screen width]
  [-a packetsize]        [-e echo input]        [-I Enable Quoted Identifiers]
  [-c cmdend]            [-L[c] list servers[clean output]]
  [-q "cmdline query"]   [-Q "cmdline query" and exit]
  [-m errorlevel]        [-V severitylevel]     [-W remove trailing spaces]
  [-u unicode output]    [-r[0|1] msgs to stderr]
  [-i inputfile]         [-o outputfile]        [-z new password]
  [-f <codepage> | i:<codepage>[,o:<codepage>]] [-Z new password and exit]
  [-k[1|2] remove[replace] control characters]
  [-y variable length type display width]
  [-Y fixed length type display width]
  [-p[1] print statistics[colon format]]
  [-R use client regional setting]
  [-b On error batch abort]
  [-v var = "value"...]  [-A dedicated admin connection]
  [-X[1] disable commands, startup script, enviroment variables [and exit]]
  [-x disable variable substitution]
  [-? show syntax summary] 
```

# model-view-controller - 表单处理逻辑在 MVC Web 应用程序中属于哪里？

> ID：344908
> 
> 赞同：5
> 
> 时间：2008-12-05T19:46:09.750
> 
> 标签：model-view-controller, forms, webforms

在使用模型-视图-控制器设计模式的基于 Web 的应用程序中，与处理表单提交相关的逻辑似乎属于模型层和控制器层之间的某个位置。在复杂表单的情况下尤其如此（即表单处理远远超出简单的 CRUD 操作）。

对此进行概念化的最佳方法是什么？表单只是模型和控制器之间的一种粘合剂吗？还是形式逻辑完全属于 M 或 C 阵营？

编辑：我了解 MVC 应用程序中的基本信息流（请参阅chills42 的答案以获取摘要）。我的问题是表单处理逻辑属于哪里 - 在控制器、模型或其他地方？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-05T19:52:18.207

我想说这可能应该被视为两个独立的行动......

1.  提交表格 (V -> C)
2.  处理提交（C -> M）

在泛型方面，我倾向于将每个动作视为部分之间的信息。完整系列的消息将是这样的......

*   显示表格 (C -> V)
*   用户提交（V -> C）
*   处理内容 (C -> M)
*   处理完成 (M -> C)
*   显示结果 (C -> V)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2010-04-14T07:20:08.780

虽然一开始使用 V -> C, C -> M, M -> C 的想法看起来不错，但对表单的任何更改都需要弄乱控制器+模型+视图。应该避免这种情况以保持应用程序逻辑简单。这是一个非常简单的框架扩展，它通过将表单处理逻辑委托给一个单独的类并保持 MVC 架构来处理应用程序逻辑，从而使处理 Web 表单处理变得非常容易。

对于您需要处理的每个表单，创建一个从通用“webform”类或 codeigniter 模型类派生的类。将 validate()、process()、display() 等方法添加到此类。

在控制器中，代码变成了这样。

```
class User_controller
{

    function login()
    {
        $form = new LoginForm(); // this is the class you would create
        if ($form->validate())
        {
            $data = $this->user_model->getUserData( $form->userid );
            // form processing complete, use the main "user" model to fetch userdata for display,
            // or redirect user to another page, update your session, anything you like
        } else {
            $form->display();
        }
    }
} 
```

表单类中的 display 方法加载它自己的视图，并根据需要填充回发数据。通过使用上述，有几个优点：

*   如果表单显示或处理需要更改，则无需更改主控制器。

*   你也不需要改变你的用户模型

*   控制器保持干净并处理主页逻辑

*   用户模型保持干净并且只与数据库交互

框架本身可以更新，以便可以使用加载 web 表单

$this->load->form("登录"); ……

但是，这只是对 codeigniter 团队有用的建议。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2010-03-26T18:05:33.233

同意chills42，但会尽可能多地添加到模型中。
当用户提交 (V->C) 时，它将被提交给某个控制器，我认为最好控制器只是充当调度程序来决定接下来会发生什么，可能基于一些简单的数据点。让模型有一个方法（通常不是严格的 ORM 或基于活动记录）处理原始数据并在适当时将其保存到数据库中，然后简单地返回状态或抛出错误。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-03-26T18:19:58.050

表单处理应该在模型中进行，因为这是应用程序的层，它通过视图的方式从控制器接收和处理数据。控制器移动它，但至于实际的代码执行，它应该发生在你的模型中。

# java - 我可以从 3 个目录深的 jar 中提取文件吗？

> ID：344920
> 
> 赞同：0
> 
> 时间：2008-12-05T19:52:14.980
> 
> 标签：java, jar

我有一个 jar 文件，其中有一个名为“client.ts”的文件（在 ZipGenius 中查看时）“/com/something/messaging”。当我做

```
JarFile jarFile = new JarFile("Client.jar");
JarEntry zipFile = jarFile.getJarEntry("client.ts"); 
```

它找不到“client.ts”文件。如果我将文件打包在“/resources/”中，它可以找到它。是否`JarFile.getEntry()`只向下钻取一个目录？javadoc for[`getJarEntry()`](http://java.sun.com/javase/6/docs/api/java/util/jar/JarFile.html#getJarEntry(java.lang.String))简单地说：返回`ZipEntry`给定条目名称的 或 null 如果未找到。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-05T19:54:34.287

JAR 中条目的完整路径应该有效：

```
JarEntry zipFile = jarFile.getJarEntry("com/something/messaging/client.ts"); 
```

# powershell - 调用 Get-Service 时过滤服务

> ID：344924
> 
> 赞同：7
> 
> 时间：2008-12-05T19:52:39.457
> 
> 标签：powershell

我过去这样做过，但不记得正确的命令（我想我使用的是 instring 或 soemthign？）

我想列出所有运行的 Windows 服务，其中包含“sql”一词。

列出所有 Windows 服务是：

```
Get-Service 
```

是否有执行此操作的 instring 函数？

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2008-12-05T19:56:55.673

```
Get-Service -Name *sql* 
```

更长的选择是：

```
Get-Service | where-object {$_.name -like '*sql*'} 
```

许多 cmdlet 提供内置过滤并支持通配符。如果您检查帮助文件（Get-Help Get-Service -full），您将看到

```
 -name <string[]>
     Specifies the service names of services to be retrieved. Wildcards are
     permitted. By default, Get-Service gets all of the services on the comp
     uter.

     Required?                    false
     Position?                    1
     Default value                *
     Accept pipeline input?       true (ByValue, ByPropertyName)
     Accept wildcard characters?  true 
```

通常，如果过滤内置在 cmdlet 中，这是首选方法，因为它通常更快、更有效。
在这种情况下，可能不会有太多的性能优势，但在 V2 中，您可以从远程计算机中提取服务并进行过滤，这将是首选方法（发送回调用计算机的数据更少）。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-06-29T17:59:24.340

您可以获得所有正在运行并具有单词 sql 的服务。

```
 Get-Service | Where-Object {$_.Status -eq "Running"} | Where-Object {$_.Name -like "*sql*"} 
```

如果您想了解更多信息，请参阅此（差别不大） [http://nisanthkv.blog.com/2012/06/29/get-services-using-powershell](http://nisanthkv.blog.com/2012/06/29/get-services-using-powershell)

希望能帮助到你...

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2017-05-04T03:23:39.543

请输入以下命令：

```
Get-Service -Name '*<search string>*' 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-09-13T17:01:00.680

上面的答案很好，但这更有用：

```
Get-WmiObject -ComputerName <INSERT COMPUTER NAME> -Class Win32_Service | where-object {$_.name -like '*sql*'} 
```

它允许在远程计算机上进行此查询。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-06-20T08:33:53.320

搜索字符串可能在显示名称或服务名称中（例如，搜索服务名称`"*SQL*"`不包括 SQL 集成服务 ...），所以我过滤了两者：

```
get-service | Where-Object {$_.DisplayName -like "*MySearchString*" -or $_.ServiceName -like "*MySearchString*"} 
```

# windows - 如何找到线程本地存储的开始和结束？

> ID：344926
> 
> 赞同：2
> 
> 时间：2008-12-05T19:53:04.230
> 
> 标签：windows, linux, multithreading, winapi, pthreads

在 Windows 和 Linux 下，给定一个线程句柄，我如何确定其对应的静态线程本地存储块的开始和结束？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-05T22:54:49.697

[您可以在线程信息块](http://en.wikipedia.org/wiki/Win32_Thread_Information_Block)中找到此信息。但是请注意，这样做会访问未记录的结构，因此**非常不便携，并且可能会在未来版本的 Windows 中中断**。看来您可以从 TIB获取*当前线程的线程本地存储区；*我不确定你会得到另一个线程的 TLS。

您可以尝试深入研究 TIB 中偏移 0x30 处的进程环境块 (PEB)，但同样，您正在处理可能会更改的未记录结构。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-06T19:40:25.033

Windows 线程信息块给出了 FS:0x2C 处的线程本地存储数组的地址，它是指向每个模块的 TLS 的指针数组。问题是没有指示该数组有多大，或者每个模块 TLS 数据块有多大。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-05T19:59:46.040

有关各种线程本地存储相关功能的详细信息，请参阅[MSDN 。](http://msdn.microsoft.com/en-us/library/6yh4a9k1(VS.80).aspx)您可以使用[TlsGetValue()](http://msdn.microsoft.com/en-us/library/ms686812(VS.85).aspx)来获取特定的 TLS 值；不要在内存中四处寻找，即使它有效 - 你只是在调用未定义的行为，它恰好可以工作，但在未来的 Windows 版本中可能会发生中断。

# html - 我可以在浏览器引发“翻转”事件之前指定延迟吗？

> ID：344928
> 
> 赞同：0
> 
> 时间：2008-12-05T19:54:13.243
> 
> 标签：html, mouseover

我正在开发一个 ASP.NET Web 应用程序，该应用程序需要在 roolover 上弹出一个弹出窗口。我正在使用“OnMouseOver”事件，它按预期工作。问题是事件发生在“触发事件”上；即使鼠标在控件上随意移动也会弹出弹出窗口（然后必须手动关闭）。我想添加一个延迟，以便快速通过相关控件不会触发事件。有没有办法设置这样的延迟，或者我可以使用不同的事件来获得相同的“慢速翻转触发事件”？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-05T19:59:20.410

想到一种解决方案，但可能有更好的方法：

1.  通过延迟`onmouseover`调用函数`setTimeout`
2.  在函数内部，检查鼠标实际上是否在该元素上。

您也可以使用 an`onmouseout`来清除`setTimeout`，但是您必须在全局变量中存储对计时器的引用才能再次获取它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-05T20:27:17.873

我最终做的是如下（oRow 是一个表格行，但它可以是任何控件）：

```
function ItemMouseOver(oRow, "parameters for the popup") 
{
    oRow.showTimer = window.setTimeout(function() 
        { 
            alert('popup');
        }, 1000);
}
function ItemMouseOut(oRow)
{
    if (oRow.showTimer)
        window.clearTimeout(oRow.showTimer); 
```

在 ASP.NET 网格视图 RowDataBound 事件中：我添加了以下代码：

```
protected void ReportGridView_RowDataBound(object sender, GridViewRowEventArgs e)
{
    if (e.Row.RowType == DataControlRowType.DataRow && (
        e.Row.RowState == DataControlRowState.Normal 
        || e.Row.RowState == DataControlRowState.Alternate))
    {
        // get the input values for the popup for the row (stuff deleted)
        e.Row.Attributes["onmouseover"] = "javascript:ItemMouseOver(this,
            "parameters for the popup");";
        e.Row.Attributes["onmouseout"] = "javascript:ItemMouseOut(this);";
    } 
} 
```

它工作得很好。谢谢。

# iphone - UIButton 覆盖一个 UITableViewCell

> ID：344934
> 
> 赞同：7
> 
> 时间：2008-12-05T19:56:56.063
> 
> 标签：iphone

我希望我的表格行中的一个按钮占据我的 UITableView 的一整行。我认为最好的方法是实例化一个 UIButton，并为其赋予与 UITableViewCell 实例相同的帧大小，并将其作为子视图添加到单元格中。我快到了，但有很多像素无法获得完美的触感。有没有更好的方法来解决这个问题，或者也许可以修复我的放置精度以获得完美的对齐？

```
cell = [tv dequeueReusableCellWithIdentifier:CellIdentifier];
if(cell == nil) {
    cell = [self tableviewCellWithReuseIdentifier:CellIdentifier];
}
UIButton *button = [UIButton buttonWithType:UIButtonTypeRoundedRect];
[button setFrame:CGRectMake(0.0f, 5.0f, 320.0f, 44.0f)];

[button setTitle:@"Do Stuff" forState:UIControlStateNormal];
[button addTarget:self action:@selector(doStuff:) forControlEvents:UIControlEventTouchUpInside];
[cell addSubview:button]; 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-12-05T20:42:28.043

你可以在你的 didSelectRowAtIndexPath: 方法中伪造它。让 tableView 单元格充当按钮。

```
[[[self tableView] cellForRowAtIndexPath:indexPath] setSelected:YES animated:YES];
[self doStuff];
[[[self tableView] cellForRowAtIndexPath:indexPath] setSelected:NO animated:YES]; 
```

用于`setSelected: animated:`伪造按钮按下并使其消失。可能会为您解决问题。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-02T10:54:29.517

Class(UITableViewCell) 具有 contentView 属性。所以我把基本按钮放在 UITableViewCell 变量的 contentView 中。

```
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath {
    ・・・
    UIButton *btn = [UIButton buttonWithType:UIButtonTypeRoundedRect];
    btn.frame = CGRectMake(230.0f, 4.0f, 60.0f, 36.0f);
    [btn setTitle:@"OK" forState:UIControlStateNormal];
    [btn setTitle:@"OK" forState:UIControlStateSelected];
    [btn addTarget:self action:@selector(onClickRename:) forControlEvents:UIControlEventTouchUpInside];
    [cell.contentView addSubview:btn];
    ・・・
    return cell;
} 
```

对不起，我的英语很差。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2010-04-05T22:45:01.750

如果您希望它完美契合，只需将单元格的边界称为您的 CGRect。像这样做：

```
button.frame = cell.bounds; 
```

这应该让您的按钮与您的单元格完全相同。希望有帮助！

绳索

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-08T02:28:46.473

FWIW，我将按钮放在我的应用程序中 CGRectMake(9, 0, 302, 45) ，我认为它看起来很完美。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-06T17:04:01.013

我和你有同样的问题。Ryan 给了你答案：使用单元格本身作为按钮，使用 didSelectedRowAtIndexPath: 方法。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-06T17:07:20.083

您还可以将 UIImage 添加到您的 UITableViewCell 以使单元格看起来像一个按钮。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-12-06T21:05:14.147

您还可以使用按钮创建视图并将其放置在其上方部分的页脚中。这样您就不必担心背景中的单元格图像。我这样做是为了在分组表视图中并排放置两个半角按钮。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-12-05T20:50:49.743

这可能是题外话，但您的代码可能存在问题，即每次重新使用单元格时都会向单元格添加另一个按钮。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2010-03-30T08:03:24.013

```
UIButton *btnView = [[UIButton alloc] init];
btnView.frame = CGRectMake(52.0f, 2.0f, 215.0f, 38.0f);
[btnView setImage:[UIImage imageNamed:@"invite.png"] forState:UIControlStateNormal];
[btnView addTarget:self action:@selector(showInviteByMail) forControlEvents:UIControlEventTouchUpInside];
[cell.contentView addSubview:btnView];
[btnView release]; 
```

# c# - 使用 nHibernate 在字段中存储逗号分隔的列表

> ID：344936
> 
> 赞同：2
> 
> 时间：2008-12-05T19:58:08.353
> 
> 标签：c#, nhibernate, nhibernate-mapping

我正在使用 C# 和 nHibernate 为我的数据库持久性构建一个博客。我想让条目可标记，所以我有一个标签属性的 IList。但是如何将其映射到数据库中单个列中的逗号分隔列表？

我想避免为标签使用单独的表格，而只是将它们作为单独的列表保存在一列中。所以我基本上是在尝试将数据库中的逗号分隔列表映射到 IList 属性。这在 nHibernate 中可能吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-05T20:11:56.187

是的，这是可能的：

[http://www.codewrecks.com/blog/index.php/2008/10/21/some-details-on-older-post-about-usertype/](http://www.codewrecks.com/blog/index.php/2008/10/21/some-details-on-older-post-about-usertype/)

将该文件添加到您的程序集中，然后在映射文件中引用它：

```
<property name='ListAsStringProperty'
              type='namespace.StringListUserType, assembly' /> 
```

映射的属性应该是一个简单的集合（List 或 IList），覆盖字符分隔符使其变成逗号。

# xor - 您如何计算 CRC 中使用的 XOR 余数？

> ID：344961
> 
> 赞同：3
> 
> 时间：2008-12-05T20:06:04.530
> 
> 标签：xor, crc, polynomial-math

我试图记住数学是如何计算出循环冗余检查中 XOR 算法的剩余部分以验证网络消息的剩余位的。

我不应该扔掉那本教科书。

这在代码中很容易完成，但它是如何手工完成的呢？

我知道它看起来像一个标准的除法算法，但我不记得从那里去哪里得到余数。

```
 ___________
1010 | 101101000 
```

**注意：**我确实谷歌了它，但无法找到他们在计算剩余部分时映射步骤的地方。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2011-05-12T11:40:03.787

```
1010 | 101101000
       1010
       0001 this result is 1011 XOR 1010 = 0001
          1010
          1010
          0000  thus no remainder. 
```

因此 101101000 是完美的，并且在传输/接收中没有发生错误

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-01-06T10:32:43.460

以我的经验，手动计算时更容易将其转换为多项式，尤其是当有很多零时。

```
1010 = 1*x^3 + 0*x^2 + 1*x^1 + 0*x^0 = x^3 + x = x3 + x
101101000 = x8 + x6 + x5 + x3

       -------------------
x3 + x ) x8 + x6 + x5 + x3 
```

然后*将被除数 ( ) 中的***最大***项****与除数*( )`x^8`中的***第一项***相除，得到。你把这个数字放在上面，然后将*它与除数中的每个项****相乘***。这为第一次迭代产生以下结果：*`x^3``x^5`***

 *****```
 x5
       -------------------
x3 + x ) x8 + x6 + x5 + x3
         x8 + x6 
```

对每个术语进行异或运算然后产生新的股息`x5 + x3`：

```
 x5
       -------------------
x3 + x ) x8 + x6 + x5 + x3
         x8 + x6
       -------------------
         x5 + x3 
```

遵循相同的模式，直到被除数的最大项小于除数的最大项。计算完成后将如下所示：

```
 x5 + x2
       -------------------
x3 + x ) x8 + x6 + x5 + x3
         x8 + x6
       -------------------
         x5 + x3
         x5 + x3
       -------------------
         0 
```

在这种情况下，提醒为 0，这表示传输过程中很可能没有发生错误。

注意：我在上面的示例中进行了缩短`x^y`，`xy`以减少答案中的混乱，因为 SO 不支持数学方程格式。

注意2：从被除数中添加/减去除数的倍数也会给出提醒0，因为`(P(x) + a*C(x)) / C(x) = P(x)/C(x) + a*C(x)/C(x)`给出与提醒相同`P(x)/C(x)`的提醒`a*C(x)/C(x)`为0。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-05T20:14:08.960

它是二进制 11 的长除法。[维基百科](http://en.wikipedia.org/wiki/Computation_of_CRC)上有一个例子。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2022-01-09T16:16:15.703

假设我们要将 101110000 除以 1001。

```
101110000
1001
--------- XOR the 1011 and 1001
0010 
```

现在我们将**删除 XOR 结果开头的零，**即 0010 并**从顶部滑动数字**。

```
101110000
1001
--------- 
  1010 
```

继续对结果进行 XOR 1001。

```
101110000
1001
--------- 
  1010
  1001
---------
  0011
--------- Remove zeros at the beginning
    1100
    1001
---------
    0101
--------- Remove zeros at the beginning
     1010
     1001
---------
     0011 
```

答案是 0011。

# windows - 如何制作一个包含给定扩展名的所有文件路径的文本文件？

> ID：344963
> 
> 赞同：4
> 
> 时间：2008-12-05T20:06:56.167
> 
> 标签：windows, search, file

我正在尝试使用[此问题](https://stackoverflow.com/questions/268045/multi-line-search-and-replace-tool#272325)中建议的免费软件[Multiple Find And Replace 1.00](http://www.nontube.com/products/multiple-find-and-replace/)。

[多重查找和替换 1.00 http://www.nontube.com/images/screenshot-mfar.png](http://www.nontube.com/images/screenshot-mfar.png)

不幸的是，它要求我明确选择我希望它搜索的每个文件。

但是，它确实允许我加载文件路径的文本文件。

```
C:\one.txt  
C:\两个.txt  
C:\somedirectory\three.txt
```

**我想要一个文本文件，其中包含某个目录及其所有子目录（递归）中所有扩展名为 .php 的文件的路径。**

有谁知道我可以用来快速生成这样一个文件列表的现成工具？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-05T20:13:41.690

你可以像这样使用内置的 DOS 命令：

```
cd /d "[base-directory]" && dir /s /b *.php > [list file] 
```

例如

```
cd /d "c:\my files" && dir /s /b *.php > c:\list.txt 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-05T20:11:48.263

`dir /S /B *.php`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-05T20:14:13.670

如果简单：

```
dir /S /B *.php > output.txt 
```

还不够，那么[总指挥官](http://www.ghisler.com/)肯定会完成任务。Total Commander 中的多重重命名工具非常棒。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-05T20:15:39.207

打开命令提示符，cd 到要在其中查找文件的文件夹并运行

```
dir *.html /B /S > somefile.txt 
```

然后查看 somefile.txt

（看起来我输了比赛……！）

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-12-05T20:19:45.127

如果您不介意安装[Cygwin](http://www.cygwin.com/)，以下单行代码将执行查找和替换：

```
find basedir -name \*.php -exec sed -i 's/text-to-find/text-to-replace/g' '{}' '+' 
```

`sed`还支持正则表达式，因此要查找的文本可以是正则表达式，而要替换的文本可以包含对模式文本的组的引用。

# c# - 如何将数据绑定与 Windows 窗体单选按钮一起使用？

> ID：344964
> 
> 赞同：9
> 
> 时间：2008-12-05T20:07:04.480
> 
> 标签：c#, winforms, data-binding, radio-button

我的数据库中有一个二进制字段，很难在 UI 中使用单个“Is XXXX？”类型复选框来描述。我宁愿使用一对单选按钮（例如“Do it the Foo way”和“Do it the Bar way”），但现在我表单上的所有其他字段都是数据绑定到业务对象的。我也想将这对单选按钮数据绑定到业务对象，但还没有想出一个好的方法来做到这一点。我可以将其中一个按钮绑定到该字段，这样如果选择了该按钮，则该字段设置为“true”，但是在选择另一个按钮时会取消选择第一个按钮（即，两个单选按钮已正确配对)，该字段的值不会更新以反映这一点。

我想能够说

```
button1.DataBindings.Add(new Binding("checked", source, "useFoo"));
button2.DataBindings.Add(new Binding("checked", source, "!useFoo")); 
```

但我很确定它运行时会抛出。有没有更简单的方法，或者我应该更多地考虑如何写一个复选框？我不想添加额外的功能来处理这种微不足道的事情......

ETA：一位评论者建议考虑使用下拉菜单（组合框）。我曾考虑过这一点，但我如何将其数据绑定到数据库中的布尔字段/业务对象中的属性？如果我将 SelectedItem 绑定到 useFoo 属性，Items 集合中会包含什么？我是否必须只添加“True”和“False”，或者我是否可以以某种方式添加一个键/值对对象，将显示的项目（“Use Foo”/“Do Not Use Foo”）绑定到它后面的布尔值？我很难找到这方面的文档。

* * *

关于答案：我最终使用的解决方案涉及修改业务对象——基本思想与 Gurge 发布的非常相似，但在阅读他的回复之前，我单独提出了它。简而言之，我添加了一个单独的属性，它只返回`!useFoo`. 一个单选按钮绑定到`source.UseFoo`，另一个绑定到`source.UseBar`（新属性的名称）。确保新属性同时具有 getter 和 setter 非常重要，否则您最终会遇到非常奇怪的行为。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-09-16T10:02:20.693

1.  绑定`RadioButton`直接链接到您的布尔值的 （即在值为 时检查`true`）。
2.  `CheckedChanged`向this 上的事件添加一个事件处理程序，`RadioButton`如下所示：

    ```
    private void radioButton_CheckedChanged(object sender, EventArgs e)
    {
        foreach (Binding b in ((Control)sender).DataBindings)
            b.WriteValue();
    } 
    ```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-06T00:06:54.870

我找到了一种使用 DataSet/DataTable 执行此操作的方法。

我用表达式在 DataTable 中创建了一个计算列`IIF(Foo=true, false, true)`。我们称该列为`Bar`。

`Bar`是布尔类型。现在您可以将一个绑定`RadioButton.Checked`到`Foo`一个，一个绑定到`Bar`.

要让`Bar`检查/取消检查传播回`Foo`您，必须转到生成的 DataTable 代码并添加一行，即此示例中的最后一行：

```
[global::System.Diagnostics.DebuggerNonUserCodeAttribute()]
public bool Bar {
    get {
        try {
            return ((bool)(this[this.tableradio.BarColumn]));
        }
        catch (global::System.InvalidCastException e) {
            throw new global::System.Data.StrongTypingException("The value for column \'Bar\' in table \'radio\' is DBNull.", e);
        }
    }
    set {
        this[this.tableradio.BarColumn] = value;
        this[this.tableradio.FooColumn] = !value;
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-18T17:56:09.780

如果您的业务对象实现了 INotifyPropertyChanged（这使得绑定工作更好），您可以将以下代码添加到可视界面中，`BO`您的业务对象是用事件声明的，并且`BO.Value`是您要绑定到的布尔属性。

```
Public Property NotValue() As Boolean
    Get
        Return Not BO.Value
    End Get
    Set(ByVal value As Boolean)
        BO.Value = Not value
        RaiseEvent PropertyChanged(Me, New PropertyChangedEventArgs("NotValue"))
    End Set
End Property

Private Sub BO_PropertyChanged(ByVal sender As Object, ByVal e As System.ComponentModel.PropertyChangedEventArgs) Handles BO.PropertyChanged
    If e.PropertyName = "Value" Then
        RaiseEvent PropertyChanged(Me, New PropertyChangedEventArgs("NotValue"))
    End If
End Sub 
```

以下绑定将连接单选按钮。

```
RBTrue.DataBindings.Add(New Binding("Checked", Me.BO, "Value", False, DataSourceUpdateMode.OnPropertyChanged))
RBFalse.DataBindings.Add(New Binding("Checked", Me, "NotValue", False, DataSourceUpdateMode.OnPropertyChanged)) 
```

可视界面还应实现 INotifyPropertyChanged。此方法适用于两种方式：如果接口更改，则原始值会更新，如果原始值更改，则接口将正确更新。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2016-03-31T13:23:08.290

我遇到了同样的问题，发现标准数据绑定实际上是可能的：

```
button1.DataBindings.Add(new Binding("checked", source, "useFoo", false, DataSourceUpdateMode.OnPropertyChanged);
// no need to databind button 2, since button1.checked 
// is set to false when button2 is checked 
```

默认情况下，`DataSourceUpdateMode`设置为`OnValidation`。通过将其设置为`OnPropertyChanged`，更改会立即传播到数据绑定对象。

我的业务对象实现`INotifyPropertyChanged`；

通过测试这个解决方案，我发现`OnPropertyChanged`当我单击 时我的事件被触发了两次`button2`。为了防止这种情况，只需设置

```
button1.CausesValidation = false;
button2.CausesValidation = false; 
```

如下所示： [TextBox leave 导致 PropertyChanged 被触发两次](https://stackoverflow.com/questions/20457670/textbox-leave-causes-propertychanged-get-fired-twice)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2017-05-23T11:49:20.103

在代码中手动执行。当您加载表单时，根据您的数据库设置您的单选按钮。当您按下“保存”按钮时，可以根据需要存储状态。此示例将无线电作为位字段存储在数据库中。

```
 // Load radio state
        radioButton1.Checked = ((myModel)myBindingSource.DataSource).boolOption1;
        radioButton2.Checked = ((myModel)myBindingSource.DataSource).boolOption2; 
```

-

```
 // Save radio state
        ((myModel)myBindingSource.DataSource).boolOption1 = radioButton1.Checked;
        ((myModel)myBindingSource.DataSource).boolOption2 = radioButton2.Checked; 
```

I tried to drag items from the "Data Sources" panel in Visual Studio 2015 when I defined my radio buttons as booleans in the table but there is issues with the booleans not being updated to false when another radio button is selected. 当在其他文本输入字段之间跳转时，将“causesValidation”更改为 false 单选按钮时自动取消选中。

* * *

## 回答 #6

> 赞同：-3
> 
> 时间：2008-12-05T22:14:02.073

只要确保它们在同一个组中，您应该只需要绑定其中一个控件。

您也可以考虑使用 DropDown。

# jasper-reports - JasperReports：positionType=''Float'' 是否适用于 staticText？

> ID：344965
> 
> 赞同：8
> 
> 时间：2008-12-05T20:07:26.510
> 
> 标签：jasper-reports

我需要有一个`staticText`浮动在另一个高度可变的元素下方。我正在从书中抽取样本`JasperReports for Java Programmers`。它说有可能做到这一点。与我的示例不同的是，我在 中使用硬编码字符串`textFieldExpression`，它们使用 $F{} 字段。

```
<textField isStretchWithOverflow="true" hyperlinkType="None">
    <reportElement x="0" y="0" width="100" height="24"/>
    <box>
        <pen lineWidth="0.5" lineStyle="Solid"/>
    </box>
    <textElement/>
    <textFieldExpression class="java.lang.String"><![CDATA["jjjjjjjjjjj oooooooooo uuuuuuuuuu aaaaaaaaaa xxxxxxxxx u ttttt"]]></textFieldExpression>
</textField>
<staticText>
    <reportElement positionType="Float" x="0" y="25" width="500" height="30"/>
    <box>
        <pen lineWidth="0.5" lineStyle="Solid"/>
    </box>
    <textElement/>
    <text><![CDATA[ This staticText element has a positionType of "Float" ppp ]]></text>
</staticText> 
```

它说，当您使用y 时`positionType="Float"`，将忽略 y 属性，因为`staticText`位于`textField`. 这似乎可行，但是……他们有可能在骂我吗？有`textField`y=0 和 height=24。有`staticText`y=25。巧合？如果我更改`staticText`'sy，很明显它不会被忽略：元素定位在我告诉它的任何位置。没有浮动！！！书中引用：

`As we can see, setting the positionType attribute of <reportElement> to Float made JasperReports ignore the y position of the <staticText> element, which was pushed down by the stretched <textField> element.`

不，我们看不到它是如何被忽略的，因为 y=25 是我们预期的！`positionType="Float"`完全有用吗`staticText`？谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-12-23T03:21:25.857

我对浮动性质的理解是，如果需要，浮动对象会向下移动，但如果之前的对象小于预期，它不会向上移动。

我不记得浮动对象在必要时实际上没有向下浮动有任何问题，无论它们是静态文本还是文本字段。

另一方面，如果您发现文本字段有效，则可以通过将文本放在文本字段值中的引号中来使用它来显示静态文本（使其成为 Java 对象）。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-12-11T12:02:39.870

[This answer](https://stackoverflow.com/questions/353928/jasperreports-subreports-not-working-with-positiontypefloat#359092) applies (different elements, same situation).

One thing I didn't take right from the book's sample is that the textField's declared height (24) is less than the actual height when the element is stretched. So, y="25" on the staticText would map above its actual position; the element is actually floated down!

# emacs - Emacs 中改进的选项卡

> ID：344966
> 
> 赞同：6
> 
> 时间：2008-12-05T20:07:41.157
> 
> 标签：emacs, elisp, indentation

我想覆盖 emacs 中错误的默认选项卡方案，以便它可以像大多数其他编辑器（eclipse、notepad++）一样工作。我想设置它，以便无论模式如何，选项卡都会插入一个选项卡，然后按 Enter 将使我保持当前的选项卡深度。

我试过这个，但它什么也没做：

```
(global-set-key (kbd "TAB") 'tab-to-tab-stop)
(setq default-tab-width 4) ;; 8 is way too many 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-12-05T21:49:36.257

要使 Enter 键将您带到下一行并自动缩进，您可以输入

```
(global-set-key (kbd "RET") 'newline-and-indent) 
```

在你的`.emacs`. [或者你可以点击`C-j`而不是 Enter。]一旦你有了它，你将永远不需要手动插入制表符，因为 Emacs 会在左大括号等之后自动缩进一个新行到额外的深度。如果你确实想更改缩进，您可以按 TAB 直到它带您到正确的缩进，然后从那里开始输入。[而且当你键入一个右大括号时，Emacs 足够聪明，可以将该大括号向后缩进一级。]

您应该删除`(global-set-key (kbd "TAB") 'tab-to-tab-stop)`它才能正常工作。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-12-05T22:25:47.400

许多主要模式会覆盖`TAB`绑定，例如 cc-mode 绑定`TAB`到`'c-indent-to-column`.

由于`'global-set-key`几乎所有主要模式都覆盖了`TAB`.

可能对您有用的一个技巧是复制`'pabbrev`使用的方法，并定义具有`TAB`界限的全局次要模式。你可以这样做：

```
(defvar just-tab-keymap (make-sparse-keymap) "Keymap for just-tab-mode")
(define-minor-mode just-tab-mode
  "Just want the TAB key to be a TAB"
  :global t :lighter " TAB" :init-value 0 :keymap just-tab-keymap
  (define-key just-tab-keymap (kbd "TAB") 'indent-for-tab-command)) 
```

但是，这会禁用所有`TAB`完成。通过一个一个地覆盖每个主要模式，您可能会获得最佳结果（以避免弄乱`TAB`完成）。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-12-22T15:57:36.487

当我第一次开始使用 Emacs 时，这也困扰着我。不过，我已经爱上它了。如果我想适当缩进，我点击`<tab>;`如果我想插入一个文字标签，我点击`M-i`(Meta and 'i' or <Alt>-<i> in some parlances) 绑定到`tab-to-tab-stop`.

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-01T22:22:12.540

我认为特雷杰克逊的答案可能是你想要的，除了可能使用`'self-insert-command`而不是`'indent-for-tab-command`. 我个人更喜欢 emacs 的默认行为，但`self-insert-command`按照它所说的去做，而不是尝试做任何花哨的事情，比如确保你的代码格式正确。

有几次我实际上*想*插入一个制表符（不是缩进），我按 Mi。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-10-28T02:47:56.927

您可能对我在[http://github.com/vohrta/regtab](http://github.com/vohrta/regtab)创建的这种次要模式感兴趣。

它使得当您按下制表键时，制表符（如果 indent-tabs-mod 不为零）或制表宽度空格将被放置在点处。该模式还能够处理您可能认为在选定文本区域上的常规行为以及使用 shift-tabbing 删除行（或一组行）开头的选项卡。

您可以通过按 Mx regtab-mode 随时启用或禁用它。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-12-05T20:10:05.503

`C-j`执行您希望按 Enter 键的换行符 + 缩进功能。

# java - 使 JDialog 按钮响应 Enter 键

> ID：344969
> 
> 赞同：18
> 
> 时间：2008-12-05T20:09:25.803
> 
> 标签：java, user-interface, swing

我有一个带有文本字段、一个确定按钮和一个取消按钮的 JQueryDialog。

我希望能够在填写文本字段后按回车键，并让它执行与单击“确定”按钮时相同的操作。

* * *

## 回答 #1

> 赞同：42
> 
> 时间：2008-12-05T20:21:12.550

在您的对话框中，调用`getRootPane().setDefaultButton(okButton)`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-08-20T20:56:05.217

代码几乎是正确的。我会更改 if 比较并使用正确的方法，如下所述。

```
if (KeyEvent.VK_ENTER == event.getKeyCode()) {
                yourButton.doClick();
            } 
```

# javascript - 如果打印样式表生效，如何通过 Javascript 检测？

> ID：344973
> 
> 赞同：1
> 
> 时间：2008-12-05T20:11:26.157
> 
> 标签：javascript, printing, stylesheet

我想在网页上的打印样式表期间有替代行为。类似于以下内容：

> 如果正在打印此页面，请不要费心调用 SWFObject 来召唤 .swf 存在。只需保留 Flash 将替换的 HTML。

我已经尝试过诸如将已知元素设置为屏幕存在的已知样式但不用于打印样式表之类的方法。但是通过 Javascript 获得“样式”并不能获得*计算*样式。

摘要：以跨浏览器的方式，是否可以判断哪个样式表有效？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-12-05T20:23:10.627

当您查看打印友好的页面时，您似乎对使用打印样式表感到困惑，但事实并非如此。在用户实际将页面发送到打印机之前，不会应用打印样式表。此时，任何要运行的 javascript 都已经完成。

您想要做的是将您的 SWFObject 放入一个 div 容器中，并将该容器的样式设置为`display:none;`用于打印媒体。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-05T20:23:13.420

您可以使用 JavaScript 访问文档中的样式表，然后检查“打印”样式表是否处于活动状态。一旦您确定了哪个 CSS 处于活动状态，您就可以管理您的内容。

该`getActiveStyleSheet`函数看起来像这样：

```
function getActiveStyleSheet() 
{
    var i, a;

    for (i = 0; (a = document.getElementsByTagName("link")[i]); i++) 
    {
        if (a.getAttribute("rel").indexOf("style") != -1
         && a.getAttribute("title")
         && !a.disabled) 
            return a.getAttribute("title");
    }

    return null;
} 
```

你可以在这里找到代码：[http](http://www.alistapart.com/articles/alternate/) ://www.alistapart.com/articles/alternate/ 。

# vb.net - 图片框变为空白

> ID：344987
> 
> 赞同：3
> 
> 时间：2008-12-05T20:15:18.397
> 
> 标签：vb.net, .net-1.1, picturebox

在 VisualBasic.Net 中，当我激活一个图片框并在其上绘制一些东西时，它会绘制然后立即变为空白。当我重新绘制它时效果很好，但我第一次绘制它时几乎总是搞砸了。这发生在几个不同的程序中，帮助文件没有帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-05T20:18:16.113

尝试设置`DoubleBuffered`属性

[http://msdn.microsoft.com/en-us/library/system.windows.forms.control.doublebuffered.aspx](http://msdn.microsoft.com/en-us/library/system.windows.forms.control.doublebuffered.aspx)

如果不是这样，请提供更多信息。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-11T13:42:43.247

通常，如果您在图片框或另一个控件上绘制某些内容，则必须接管 OnPaint 事件，并且您负责持久化在此事件上绘制的内容。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-05T21:14:57.793

我假设您使用的是标准的 PictureBox 组件。你在 Paint-Handler 中画画吗？如果没有，那么 PictureBox 将在下次被要求重新绘制自身（擦除背景等）时擦除您绘制的内容。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-06T15:18:18.433

是的，我相信我使用的是标准图片框。

通过 Paint-Handler，我假设您的意思是 [Control].PaintEvent 处理程序。不，我没有使用事件处理程序来绘制...绘制我的图表本身并不是一个事件，而是对按钮单击事件的更大响应的一部分。

如果您说将绘图代码作为单独的特定处理程序的一部分可以解决我的问题，那么我想我每次想重绘图表时都可以引发一个内部事件。但我宁愿只是弄清楚是什么导致 PB 在没有被告知的情况下重绘自己。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-06T15:28:50.190

如果您不能使用 DoubleBuffered，则可以隐藏第二个图片框。您在其中进行绘图，一旦完成，您就会回到可见的绘图。这样，绘制过程是在隐藏的过程中完成的，不会显示白色/闪烁。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-05T20:47:46.943

谢谢安德鲁，但没有帮助。我正在使用 .Net Framework 1.1，它不提供 DoubleBuffered 属性……它是 2.0 中的新功能。

不确定要提供哪些附加信息.. 代码长 300 行。单击按钮时，代码会展开我的表单，使两个图片框可见（一个在另一个之上（后面的一个用于一些图形标签），然后使用一些图形画笔和钢笔在前面绘制一个图形框。有一些数据库活动和计算同时在后台进行。

# facebook - OpenID 的命运如何？

> ID：344991
> 
> 赞同：13
> 
> 时间：2008-12-05T20:16:53.463
> 
> 标签：facebook, openid, single-sign-on

谷歌宣布了[Google 朋友连接](http://www.google.com/friendconnect/admin/tos/)，而 Facebook 也宣布了[Facebook 连接](http://developers.facebook.com/news.php?blog=1&story=108)。这两种服务都试图解决单点登录问题。既然 OpenID 就是为了解决这个问题而创建的，那么它会在 Facebook 和 Google 这对双胞胎重量级人物面前失败吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-12-05T20:46:40.907

我认为我们作为开发人员应该支持开放标准和解决方案，因此即使 OpenID 可用性远非无缝，它仍然是我们目前拥有的最好的。此外，将如此多的个人信息信任给某些公司*真的*让我感到害怕......

[这里](http://www.readwriteweb.com/archives/facebook_connect_vs_open_id.php)有更多关于这个话题的讨论。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-12-05T20:26:34.007

OpenID 对大多数用户来说太模糊了——“我在哪里注册？”好吧，这里，这里，这里，这里......

拥有一个可识别的品牌为广大互联网用户推动这一点将加速采用。人们已经信任 Google 和 Facebook，拥有大量个人信息（并且拥有用户名和密码），这对他们来说只是一个自然而简单的扩展。

OpenID 还没有失败，但事情看起来不太好！

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2008-12-05T21:03:51.620

我认为 OpenId 将在人们不知道他们正在使用 OpenId 的情况下起飞。

我喜欢有一个大的“用雅虎登录”或“用谷歌登录”按钮的网站，这样普通的乔更容易进入一个网站。他已经知道他的 Google 密码，因此登录很容易。

[rpxnow.com](http://rpxnow.com)的小部件就是最好的例子。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2008-12-05T21:22:36.827

Google 朋友群*确实*允许您使用 OpenID 登录

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-12-05T20:22:14.497

不要宣布它死了。SSO 肯定是个好东西，OpenID 似乎是一种独立的格式（与 Facebook 和 Google 相比），但它还不是真正无缝的（*咳*Yahoo OpenID*咳*）

有趣的是看看 SSO 是否成功，如果成功，是哪个提供商，但这是通常的鸡蛋问题：我们需要更多高知名度的网站使用它，即使他们这样做，大公司似乎也不愿意参与任何放松他们对社区的“控制”。毕竟，您的个人数据对于营销目的很有价值。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-12-21T00:38:05.190

无论参与者是谁，OpenID 都是未来。它可能最终不会成为 OpenID 的解决方案，但这个概念是互联网的未来。我个人更喜欢称它为我的虚拟身份。它将有效地取代电子邮件作为网站的标识符，并将成为您在名片或聚会上提供给人们的东西，而不是电子邮件地址（类似于人们使用 myspace 屏幕名称的方式）。它将成为每个人/任何人都可以参考您允许发布到世界的所有内容/任何内容的门户。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-09-14T21:36:03.883

我所知道的是 Google 帐户可以用作 OpenID。它只是一种类型的 OpenID。

显然，您所指的是用作 OpenID 的 OpenID 帐户。现在说还为时过早，顺便说一句，我使用 Google 帐户作为我的 OpenID，并且创建一个新 ID（甚至是 OpenID :)）很无聊。

这就是我的看法。别人怎么说？

# asp.net - 如何在母版页中访问用户控件的 div 标签

> ID：344998
> 
> 赞同：0
> 
> 时间：2008-12-05T20:19:38.043
> 
> 标签：asp.net

我们可以在母版页访问用户控件的 div 标签吗？我正在尝试更改某个事件中每个 div 标签的背景颜色。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-05T21:23:58.087

像这样的东西应该可以工作（在 C# 中）：

```
Control myControl = this.Page.Master.FindControl("[Your name here]"); 
```

然后你可以对控件做任何你想做的事情。如果它是面板控件（用于 div），您可以采用这种方式进行转换，或者如果您使用的是 HTML 服务器端控件，则可以采用这种方式进行转换。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-05T20:20:38.480

最好的方法是在用户控件中创建一个公共属性，然后您可以直接从母版页进行设置。**************