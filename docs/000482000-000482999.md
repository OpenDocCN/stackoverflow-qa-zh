# StackOverflow 问答 000482000-000482999

# sql - 如何在 MySQL WHERE 子句中使用别名列？

> ID：482008
> 
> 赞同：0
> 
> 时间：2009-01-27T01:08:37.453
> 
> 标签：sql, mysql, where, having

我有一个这样的 MySQL 查询：

```
SELECT *, SUM(...some SQL removed for brevety) AS Occurrences FROM some_table AS q
WHERE criterion="value" GROUP BY q.P_id ORDER BY Occurrences DESC LIMIT 10; 
```

我想将结果限制为 Occurrences>0 的行。这对我来说似乎很简单，但我似乎无法让它发挥作用。无论我尝试什么，WHERE 或 HAVING，每当我尝试添加此限制时，我都会得到 NO ROWS 作为回报。我很肯定我的表中有应该返回的数据。有谁知道如何完成我正在做的事情？

* * *

我试过这个，但它仍然不起作用。任何想法为什么它仍然不起作用？

```
SELECT *, SUM(...some SQL removed for brevety) AS Occurrences FROM some_table AS q
WHERE criterion="value" HAVING SUM(...some SQL removed for brevety)>0 GROUP BY q.P_id ORDER BY Occurrences DESC LIMIT 10; 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-27T01:15:13.697

我对 MySQL 不像对 SQL Server 那样熟悉，但是在 T-SQL 中，不能在 GROUP BY 子句中使用别名（我最初也认为 ORDER BY 子句，但后来证明这是不正确的） . 在这种情况下，您想根据 GROUP BY 的结果进行过滤，因此我将使用 HAVING 子句，如下所示：

```
SELECT *, SUM(... some SQL removed for brevity ...) AS Occurrences
FROM
    some_table AS q
WHERE
    criterion = 'value'
GROUP BY
    q.P_id
HAVING
    SUM(... some SQL removed for brevity ...) > 0
ORDER BY
    Occurrences DESC
LIMIT 10; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-11T06:59:13.847

这个查询对我有用......

```
select order_id, sum(qty_ordered) as total_qty 
from sales_flat_order_item 
group by order_id 
having total_qty > 10
order by total_qty desc 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-27T01:19:37.323

啊，我找到了它的地方。

现在的声明是：

```
SELECT *, SUM(...some SQL removed for brevety) AS Occurrences FROM some_table AS q
WHERE criterion="value" GROUP BY q.P_id HAVING SUM(...some SQL removed for brevety)>0 ORDER BY Occurrences DESC LIMIT 10; 
```

它似乎与 ORDER BY Occurrences 一起工作正常，

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-27T01:13:48.020

根据 SQL 标准，查询正文中不提供列别名，这是一个令人困惑的麻烦。鉴于您已经尝试过，这听起来好像 MySQL（和其他一些 DBMS）也是如此。您可能必须重复 ORDER BY 子句中的表达式。

此外，GROUP BY 子句应该列出 * 中的每一列，而不仅仅是主键（尽管从逻辑上讲，指定主键就足够了）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-27T01:15:06.693

我相信聚合应该在`HAVING`条款中。不过，诚然，我不确定是否接受别名。

```
HAVING (Occurrences > 0)

HAVING (SUM(...some SQL removed for brevety) > 0) 
```

或者，您可以使用子查询：

```
SELECT *
FROM (
   -- your current query
) AS sub
WHERE (Occurences > 0) 
```

# asp.net - 为什么我的 ASP.NET 项目不在启动项目中时会在开发服务器上运行？

> ID：482012
> 
> 赞同：8
> 
> 时间：2009-01-27T01:10:02.973
> 
> 标签：asp.net, visual-studio, debugging, webdev.webserver

我有一个 Visual Studio 2008 解决方案，其中包括一个 c# 中由 asp.net 托管的远程处理项目。*该解决方案还包含其他 c# 项目和 c++ 项目*。

在调试我的c#客户端和asp.net服务器的交互时，调试的很好。我可以直接进入服务器调用并退出。但是，有时我需要将调试重点放在**没有 asp.net 项目**的独立可执行文件上。

我的麻烦是，将启动项目设置为除 asp.net 项目之外的其他项目后，不会阻止 asp.net 项目在开发服务器（和系统托盘）中启动。它本身似乎不是“调试”，但是当我不希望它运行时，它正在运行并耗尽资源。

我已经检查并重新检查了启动项目设置。它们牢牢地处于“关闭”位置。关于为什么会发生这种情况和/或如何防止它的任何想法？有没有其他人经历过这个？

> **解决方案说明：**将这个记为“哦，那就是那个地方！” Visual Studio 中的现象。此设置不在 ASP.NET 项目属性页面上（右键单击解决方案资源管理器中的项目并选择“属性”），也不在启动项目 UI 上。相反，当在解决方案资源管理器中选择项目时，它位于“常规”属性页面上。即确保属性页面可见（查看-> 属性窗口），然后单击解决方案资源管理器中的 ASP.NET 项目。顶部选项是“始终在调试时启动”，当设置为 false 时，可以解决问题。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-01-27T02:24:38.330

停止开发服务器的启动。

*   单击解决方案资源管理器中的 ASP.net 项目。
*   在属性窗口中将“调试时始终启动”设置为 false

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-27T02:02:18.923

我认为当您点击“调试”时 VS 只会附加到启动项目过程。

运行开发服务器后，附加到 WebDev.Webserver.exe 进程。

转到调试菜单 -> 附加到进程 -> 选择 WebDev.Webserver.exe ->单击附加

你现在应该可以抓住它了。

# python - 您将如何在 Python 中执行相当于预处理器指令的操作？

> ID：482014
> 
> 赞同：74
> 
> 时间：2009-01-27T01:10:43.940
> 
> 标签：python, preprocessor, equivalent, directive

有没有办法在 Python 中执行以下预处理器指令？

```
#if DEBUG

< do some code >

#else

< do some other code >

#endif 
```

* * *

## 回答 #1

> 赞同：122
> 
> 时间：2009-01-27T03:25:06.353

有`__debug__`, 这是编译器进行预处理的特殊值。

```
if __debug__:
  print "If this prints, you're not running python -O."
else:
  print "If this prints, you are running python -O!" 
```

`__debug__`将被编译器替换为常量 0 或 1，并且优化器将`if 0:`在解释您的源代码之前删除任何行。

* * *

## 回答 #2

> 赞同：40
> 
> 时间：2010-06-07T06:46:27.720

我编写了一个名为 pypreprocessor 的 python 预处理器，它完全符合您的描述。

[源代码和文档可在 GitHub 上找到](https://github.com/interpreters/pypreprocessor)。

[该软件包也可以通过 PyPI 下载/安装](http://pypi.python.org/pypi/pypreprocessor/)。

这是一个完成您所描述的示例。

```
from pypreprocessor import pypreprocessor

pypreprocessor.parse()

#define debug

#ifdef debug
print('The source is in debug mode')
#else
print('The source is not in debug mode')
#endif 
```

pypreprocessor 不仅仅是动态预处理。要查看更多用例示例，请查看 Google Code 上的项目。

**更新：有关 pypreprocessor 的更多信息**

我完成预处理的方式很简单。从上面的示例中，预处理器导入在 pypreprocessor 模块中创建的 pypreprocessor 对象。当您在预处理器上调用 parse() 时，它会自行使用它导入的文件并生成自身的临时副本，该副本注释掉所有预处理器代码（以避免预处理器在无限循环中递归调用自身）和注释掉所有未使用的部分。

如果模块抛出异常或崩溃，注释掉这些行而不是删除它们是必要的，以便在错误回溯中保留行号。而且我什至重写了错误回溯以报告反映崩溃模块的正确文件名。

然后，即时执行包含后处理代码的生成文件。

与仅在代码中内联添加一堆 if 语句相比，使用此方法的好处是，不会浪费执行时间来评估无用的语句，因为代码的注释掉部分将从编译的 .pyc 文件中排除。

缺点（也是我创建模块的最初原因）是您不能在同一个文件中同时运行 python 2x 和 python 3x，因为 pythons 解释器在执行代码之前会运行完整的语法检查，并且会拒绝之前的任何版本特定代码允许预处理器运行::sigh::。我最初的目标是能够在同一个文件中并排开发 2x 和 3x 代码，这将根据运行的内容创建特定于版本的字节码。

无论哪种方式，预处理器模块对于实现常见的 c 样式预处理功能仍然非常有用。此外，如果您愿意，预处理器能够将后处理的代码输出到文件以供以后使用。

此外，如果您想生成一个包含所有预处理器指令以及任何被排除的#ifdef 的版本，它就像在调用 parse() 之前在预处理器代码中设置一个标志一样简单。这使得从特定于版本的源文件中删除不需要的代码成为一步过程（而不是爬取代码并手动删除 if 语句）。

* * *

## 回答 #3

> 赞同：26
> 
> 时间：2009-01-27T01:14:24.790

我怀疑你会讨厌这个答案。你在 Python 中这样做的方式是

```
# code here
if DEBUG:
   #debugging code goes here
else:
   # other code here. 
```

由于 python 是一个解释器，因此不需要应用预处理步骤，并且具有特殊语法也没有特别的优势。

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2009-01-27T01:16:14.070

您可以在 Python 中使用预处理器。只需通过 bin 目录中的 cpp（C 预处理器）运行脚本。然而，我已经用 Lua 做到了这一点，并且易于解释的好处超过了更复杂的编译恕我直言。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-01-27T01:14:28.690

您可以只使用正常的语言结构：

```
DEBUG = True
if DEBUG:
  # Define a function, a class or do some crazy stuff
  def f():
    return 23
else:
  def f():
    return 42 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2015-07-07T06:47:17.927

另一种方法是使用 bash 脚本注释掉仅与调试相关的代码部分。下面是一个示例脚本，它注释掉其中包含“#DEBUG”语句的行。它还可以再次删除这些评论标记。

```
if [ "$1" == "off" ]; then
  sed -e '/^#/! {/#DEBUG/ s/^/#/}' -i *.py
  echo "Debug mode to $1"
elif [ "$1" == "on" ]; then
  sed -e '/#DEBUG/ s/^#//' -i *.py
  echo "Debug mode to $1"
else
  echo "usage: $0 on | off"
fi 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2019-01-22T16:30:47.807

*   Python if 不能从数组中消除元素。
*   C 预编译器不处理 #! 或根据需要以 # 开头的其他行。
*   pypreprocessor 似乎是 python 特定的

改用普通的 m4，如下所示：

```
ifelse(DEBUG,True,dnl`
  < do some code >
dnl,dnl`
  < do some other code >dnl
')

ifelse(
  M4_CPU,x86_64,`
    < do some code specific for M4_CPU >
',M4_CPU,arm,`
    < do some code specific for M4_CPU >
',M4_CPU,ppc64le,`
    < do some code specific for M4_CPU >
')

ifelse(
  M4_OS,windows,`
    < do some code specific for M4_OS >
  ',M4_OS,linux,`
    < do some code specific for M4_OS >
  ',M4_OS,android,`
    < do some code specific for M4_OS >
') 
```

> m4 -D DEBUG=True -D M4_OS=android -D M4_CPU=arm test.py.m4 > test.py

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2022-02-22T13:50:40.887

使用[gpp](https://logological.org/gpp) - 一个通用的预处理器。

# java - JComponent 如何通知其父 J(Internal)Frame 的关闭事件？

> ID：482029
> 
> 赞同：0
> 
> 时间：2009-01-27T01:17:24.957
> 
> 标签：java, swing, components, listeners

我想编写一个监视其他活动的组件，但是当组件的窗口关闭时，它的侦听器将被删除。

我不想多次编写此删除代码，但希望组件自己处理它。（我该怎么做？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-30T16:31:52.887

该类`JFrame`（即窗口）有一个`processWindowEvent`回调，它接受一个名为`Windowevent`

注册这个回调，如果参数是`WINDOW_CLOSED`你可以调用里面的删除代码。

最后，删除代码只写一次（如你所愿）。

有关更多详细信息，请参阅[API](http://java.sun.com/j2se/1.5.0/docs/api/javax/swing/JFrame.html)。

**更新：**另请[参阅](http://java.sun.com/docs/books/tutorial/uiswing/events/windowlistener.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-10T22:44:20.933

我会写这样的东西

```
class ListenToWindow
extends WindowAdapter
{
MyInternalFrame frame;

public void windowClosed(event)
   {
   this.frame.removeAllTheRequiredListeners();
   }
}

(...)
JFrame window;
MyInternalFrame frame;
(...)
window.addWindowLister(new ListenToWindow(frame));
(...) 
```

# cocoa - 通过插座将数组控制器链接到 XCode 中的数组

> ID：482033
> 
> 赞同：1
> 
> 时间：2009-01-27T01:20:13.623
> 
> 标签：cocoa, arrays, interface-builder, linker

我正在尝试找到一种将阵列控制器链接到阵列的方法。我知道通过一个插座，我可以在使用 Interface Builder 制作的 .xib 文件中填充文本字段甚至表格视图。

我希望有可能有一个简单的插座（NSArray）并将其放入阵列控制器中。反过来，表格会将其内容字段链接到数组中的内容。这是可能的还是我只是想太多非可可？

现在我在界面构建器中有一个对象引用，它已经通过一对字段和一些动作处理程序传递给按钮。如果我尝试将阵列控制器链接到出口“FilesArray”，我只能将它链接到对象本身，而不是它的出口。

我只是一个初学者，所以我不明白为什么这不可能？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-27T01:32:44.457

您只需要转到界面构建器检查器中的绑定窗格，然后在“控制器内容”下找到需要绑定到所需数组的 NSArrayController。然后你可以将 NSTableColumn 绑定到 NSArray 控制器。

有关 使用 NSArrayController 的示例，请参阅有无[绑定。](http://developer.apple.com/samplecode/WithAndWithoutBindings/index.html)

CocoaDev 还提供了一些更精确的关于使用 NSArrayController 并将其与 TableViews 一起使用的说明[http://www.cocoadev.com/index.pl?NSArrayController](http://www.cocoadev.com/index.pl?NSArrayController)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-27T05:10:00.540

您不为此使用插座。相反，您采用另一种方式，将数组控制器绑定到对象的属性。

1.  删除`IBOutlet`关键字。
2.  在标头中，将实例变量声明为`NSMutableArray`.
3.  在实现中，在 中创建数组并在 中`init`释放它`dealloc`。
4.  在标头中，声明数组的属性。确保使用 copy 属性声明它。
5.  在实现中，为属性合成访问器。
6.  在 IB 中，设置数组控制器的 Content Array 绑定。将其绑定到具有您的数组属性的对象。将模型键路径设置为您在 Xcode 中创建的属性的名称。
7.  在您的实现中，*始终*使用访问器来改变属性（例如，添加或删除对象）。

# vb.net - VB.NET (Of T) 比较运算符

> ID：482036
> 
> 赞同：3
> 
> 时间：2009-01-27T01:21:11.063
> 
> 标签：vb.net, generics, .net-2.0, operator-overloading

在示例代码中，带有“错误注释”的行给出了以下错误 -

*   没有为类型“T”和“T”定义运算符“<”。

为什么 VB 不自动调用适当的 T 运算符？（即如果 T 是整数，则调用整数比较函数。）

是否有可能以优雅的方式完成这项工作？

这适用于 .NET 2.0。

**编辑**- 为任何感兴趣的人更新代码。

```
Public Class TreeNode(Of T)
    Public Left As TreeNode(Of T)
    Public Right As TreeNode(Of T)
    Public Value As IComparable(Of T)
    Public Sub New(ByVal _value As T)
        Value = _value
    End Sub
End Class

Public Class Tree(Of T)

    Private _Root As TreeNode(Of T)

    Public ReadOnly Property Root()
        Get
            Return _Root
        End Get
    End Property

    Public Sub New()
        _Root = Nothing
    End Sub

    Public Function Add(ByVal value As IComparable(Of T)) As TreeNode(Of T)
        If _Root Is Nothing Then
            _Root = New TreeNode(Of T)(value)
        Else
            Dim node As TreeNode(Of T) = _Root
            While node IsNot Nothing
                If value.CompareTo(node.Value) < 0 Then
                    If node.Left IsNot Nothing Then
                        node = node.Left
                    Else
                        node.Left = New TreeNode(Of T)(value)
                        Return node.Left
                    End If
                Else
                    If node.Right IsNot Nothing Then
                        node = node.Right
                    Else
                        node.Right = New TreeNode(Of T)(value)
                        Return node.Right
                    End If
                End If
            End While
        End If
        Return _Root
    End Function

    Public Sub Print(ByVal node As TreeNode(Of T))
        If node IsNot Nothing Then
            Print(node.Left)
            Console.WriteLine(node.Value)
            Print(node.Right)
        End If
    End Sub

End Class 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-27T01:36:06.587

> 为什么 VB 不自动调用适当的 T 运算符？（即如果 T 是整数，则调用整数比较函数。）

因为对 T 没有任何约束可以确保它具有适当的运算符。您可以要求 T 为[IComparable](http://msdn.microsoft.com/en-us/library/system.icomparable.aspx)，并使用它的 CompareTo 方法。

# java - 如何在 JPopupMenu 中选择第一项？

> ID：482041
> 
> 赞同：7
> 
> 时间：2009-01-27T01:25:35.360
> 
> 标签：java, swing, jmenupopup

过去，当一个`JPopupMenu`可见时，默认情况下会选择第一项：[http ://weblogs.java.net/blog/alexfromsun/archive/2008/02/jtrayicon_updat.html](http://weblogs.java.net/blog/alexfromsun/archive/2008/02/jtrayicon_updat.html)

如今，默认行为是弹出菜单而不选择任何项目。我想创建一个`JPopupMenu`带有单个项目的项目，该项目将在鼠标指针下弹出并居中。我设法让该项目在鼠标下方居中弹出，但我`JMenuItem`拒绝渲染，就好像它被选中一样。如果我将鼠标移出项目并重新选择正确。

有任何想法吗？

这是我的测试用例：

```
import java.awt.Component;
import java.awt.Point;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;
import java.awt.event.MouseAdapter;
import java.awt.event.MouseEvent;
import javax.swing.JFrame;
import javax.swing.JMenuItem;
import javax.swing.JPopupMenu;

public class Test extends JFrame
{
    public static void main(String[] args)
    {
        JFrame frame = new JFrame();
        frame.setSize(800, 600);
        frame.getContentPane().addMouseListener(new MouseAdapter()
        {
            @Override
            public void mousePressed(MouseEvent e)
            {
                if (e.isPopupTrigger())
                    popupTriggered(e);
            }

            @Override
            public void mouseReleased(MouseEvent e)
            {
                if (e.isPopupTrigger())
                    popupTriggered(e);
            }

            private void popupTriggered(MouseEvent e)
            {
                JPopupMenu menu = new JPopupMenu();
                final JMenuItem item = new JMenuItem("This is a JMenuItem");
                menu.add(item);
                Point point = e.getPoint();
                int x = point.x - (item.getPreferredSize().width / 2);
                int y = point.y - (item.getPreferredSize().height / 2);
                menu.show((Component) e.getSource(), x, y);
            }
        });
        frame.setDefaultCloseOperation(JFrame.DISPOSE_ON_CLOSE);
        frame.setVisible(true);
    }
} 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-11-27T23:30:51.863

秘密原来是`MenuSelectionManager.defaultManager().setSelectedPath(new MenuElement[]{menu, ...});`

```
import java.awt.event.MouseAdapter;
import java.awt.event.MouseEvent;
import javax.swing.JFrame;
import javax.swing.JMenuItem;
import javax.swing.JPopupMenu;
import javax.swing.MenuElement;
import javax.swing.MenuSelectionManager;
import javax.swing.SwingUtilities;

/**
 * Demonstrates programmatic {@link JMenuItem} selection;
 * specifically how to make the first item selected by default
 */
public class TestPopup extends JFrame {
  public static void main(String[] args) {
    final JFrame frame = new JFrame("TestPopup");
    frame.setSize(640, 480);
    frame.getContentPane().addMouseListener(new MouseAdapter() {
      @Override
      public void mousePressed(MouseEvent e) {
        if (e.isPopupTrigger()) {
          popupTriggered(e);
        }
      }
      private void popupTriggered(MouseEvent e) {
        final JPopupMenu menu = new JPopupMenu();
        final JMenuItem item0 = new JMenuItem("JMenuItem 0");
        final JMenuItem item1 = new JMenuItem("JMenuItem 1");
        menu.add(item0);
        menu.add(item1);
        menu.pack();
        // use invokeLater or just do this after the menu has been shown
        SwingUtilities.invokeLater(new Runnable() {
          public void run() {
            MenuSelectionManager.defaultManager().setSelectedPath(new MenuElement[]{menu, item0});
          }
        });
        int x = (int) ((int) (frame.getSize().width - (menu.getPreferredSize().width / 2.)) / 2.);
        int y = (int) ((int) (frame.getSize().height - (menu.getPreferredSize().height / 2.)) / 2.);
        menu.show(frame, x, y);
        // doesn't work:
        //item0.setSelected(true);
        // doesn't work:
        //menu.getSelectionModel().setSelectedIndex(0);
        // bingo; see also MenuKeyListener / MenuKeyEvent
//        MenuSelectionManager.defaultManager().setSelectedPath(new MenuElement[]{menu, item0});
      }
    });
    frame.setDefaultCloseOperation(JFrame.DISPOSE_ON_CLOSE);
    frame.setLocationRelativeTo(null);
    frame.setVisible(true);
  }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-27T01:40:25.940

> 如今，默认行为是弹出菜单而不选择任何项目。

实际上，我认为这是正确的行为，至少在 Windows 中是这样。其他非 Java 应用程序也这样做。即使菜单中只有一个项目，我认为不值得打破这个约定。如果您不这么认为，您可以按照[sean.bright 的回答](https://stackoverflow.com/questions/482041/how-to-select-first-item-in-jpopupmenu#482047)设置选择索引。

* * *

所以，我终于有机会在 Java 上尝试了一下`1.6.0_11`，发现了一些不一致的行为：如果弹出菜单突出父框架，则自动选择该项目；如果弹出菜单完全出现在父框架内，则不选择任何内容。听起来像一个 Swing 错误，它至少保证了 RFE 的一致行为。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-10-13T13:03:34.090

MenuSelectionManager.defaultManager() 确实是一个很好的解决方案，但是当您尝试预先选择 JPopupMenu 的子菜单时（它会隐藏父菜单），它就不起作用了。此外，它会扰乱其他键盘导航行为（您不能按左键隐藏子菜单等）

不幸的是，在 Swing 中这个问题没有很好的解决方案......我的解决方案很丑陋，但遗憾的是，这项工作做得很完美：

```
public static void setMenuSelectedIndex(final JPopupMenu popupMenu, final int index) {
    SwingUtilities.invokeLater(new Runnable(){public void run()
    {
        for (int i=0; i < index+1; i++) {
            popupMenu.dispatchEvent(new KeyEvent(popupMenu, KeyEvent.KEY_PRESSED, 0, 0, KeyEvent.VK_DOWN, '\0'));
        }
    }});
} 
```

如您所见，我基本上是在弹出菜单上模拟“向下”键盘按键...

更好的解决方案可能不是硬编码模拟 VK_DOWN，而是读取 Popup 的输入映射并确定哪个 KeyCode 表示“选择下一个菜单项” - 但我认为我们大多数人都会与这个 hack 相处......

您可能还想查看此方法，该方法在选择菜单项后选择它它利用先前的方法

```
public static void setSelectedIndexWhenVisible(final JMenu menu, final int index) {
    menu.getPopupMenu().addPopupMenuListener(new PopupMenuListener() {
        @Override
        public void popupMenuWillBecomeVisible(PopupMenuEvent e) {
            PopupUtils.setMenuSelectedIndex(menu.getPopupMenu(), index);
            menu.getPopupMenu().removePopupMenuListener(this);
        }

        @Override
        public void popupMenuWillBecomeInvisible(PopupMenuEvent e) {
        }

        @Override
        public void popupMenuCanceled(PopupMenuEvent e) {
        }
    });
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-28T19:10:37.037

这很奇怪。

我在 Windows 上进行了尝试，在*Java 1.5.0_08*甚至***1.6.0_07***中，第一个元素会自动选择，正如您所期望的那样。

所以我用***1.6.0_11***尝试了它，它不再起作用，最初没有选择第一个元素。在 selectionModel 中选择元素似乎没有帮助。

一种解决方法（我一点也不自豪）是在显示弹出菜单后使用*MouseEvent*的坐标自动移动鼠标。也许有人有更好的主意？

```
import java.awt.AWTException;
import java.awt.Robot;
import java.awt.event.MouseAdapter;
import java.awt.event.MouseEvent;

import javax.swing.JFrame;
import javax.swing.JMenuItem;
import javax.swing.JPopupMenu;

public class SelectedPopupMenu extends JFrame {

    public SelectedPopupMenu() {
        addMouseListener(new MouseAdapter() {
            public void mouseClicked(final MouseEvent e) {
                JPopupMenu popupMenu = new JPopupMenu();
                popupMenu.add(new JMenuItem("Test-Item"));
                popupMenu.add(new JMenuItem("Test-Item-2"));
                // do not care to really hit the center of the popup
                popupMenu.show(SelectedPopupMenu.this, e.getX() - 30, e.getY() - 10);
                try {
                    // shake mouse, so that first element is selected even in Java 1.6.0_11
                    Robot robot = new Robot();
                    robot.mouseMove(e.getX() + 1, e.getY());
                    robot.mouseMove(e.getX(), e.getY());
                } catch (AWTException ex) {
                    ex.printStackTrace();
                }
            }
        });
    }

    public static void main(String[] args) {
        JFrame frame = new SelectedPopupMenu();
        frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        frame.setSize(800, 600);
        frame.setVisible(true);
    }
} 
```

# c# - 在 CF .net 框架中设置 TabIndex

> ID：482044
> 
> 赞同：1
> 
> 时间：2009-01-27T01:30:55.553
> 
> 标签：c#, .net, compact-framework, tabindex

我有一个带有 3 个面板的表单，创建面板是因为在某些时候我需要隐藏/显示某些控件组。到现在为止，它工作得很好——直到我被要求有一种特定的方式来使用 TAB 键导航表单。

首先，我注意到 Panel 对象中没有 TabIndex 属性，最重要的是，我不想遵循嵌套导航算法，我只想设置自己的序列。

从我目前在网上阅读的内容来看，面板不可能做到这一点。我唯一的选择是将表单上的所有控件放在同一个面板中。

有什么想法吗？我不想重新安排应用程序，并开始隐藏和显示各个控件。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-27T07:19:12.747

按 T​​AB 键会将焦点移动到 ControlCollection 中的下一个控件。由于焦点始终在 Panel 内的控件中，而不是在面板本身中，您怎么能期望 Panel 支持选项卡索引？

我建议你再想想你想要做什么。当特定面板可见时，TAB 应该在其中的控件周围导航。TAB 将您移到下一个面板中是没有意义的。这通常通过按钮或其他控件来完成。用户期望 TAB 移动焦点而不执行操作。此外，如果您想让 TAB 让您在面板中移动，那么您需要将所有控件的 Tab Stop 属性设置为 false。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2010-02-01T16:18:26.353

我遇到过同样的问题。我的解决方案是将所有控件放在表单的子面板中。.net 算法的制表符是使用 TabIndex 在“当前”容器内进行制表符。如果容器中的任何 TabIndexes 相同，则 z 顺序中的第一个将是第一个，依此类推。

一旦进入容器（表单就是容器），除了容器（面板）之外的所有控件都首先被选项卡标记。当离开最后一个非容器控件时，面板被递归到。

因此，如果所有控件都放置在同一级别的容器/面板中，则您的选项卡将按照您的预期完成。

示例问题：

```
形式

  控制1 Tabindex = 1

  面板1

    control2 Tabindex=2

    控制3 Tabindex=2

  面板2

    control4 Tabindex=4

    control5 Tabindex=5

  control6 Tabindex=6

```

选项卡将按以下顺序（不是您所期望的）：

```
  控制1

  Control6 <-- 不是您想要/期望的

  控制2

  控制3

  控制4

  控制5

```

要使其正确进入制表符，请按以下模式布局：

```
形式

  面板0

    控制1 Tabindex = 1

  面板1

    control2 Tabindex=2

    控制3 Tabindex=2

  面板2

    control4 Tabindex=4

    control5 Tabindex=5

  面板3

    control6 Tabindex=6

```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-27T02:40:13.683

我认为您几乎被困在那里-我不知道有任何直接的方法可以避免嵌套导航。

*但是，我会说*显示/隐藏控件组真的没什么大不了的：

```
private void SetPrimaryControlVisibility(bool visible)
{
  ctrlA.Visible = visible;
  ctrlB.Visible = visible;
  ctrlF.Visible = visible;
}

private void SetSecondaryControlVisibility(bool visible)
{
  ctrlC.Visible = visible;
  ctrlE.Visible = visible;
  ctrlG.Visible = visible;
} 
```

这需要更多的代码编写——但这花了我 20 秒。如果它们都在表单表面上，您可以使用选项卡索引。

虽然现在我想起来了，他们在自己的面板上有什么问题？如果您使用面板来显示/隐藏，那么无论如何您都不会切换到其他面板。

另一种选择是编写关键事件处理程序，但我会远离——这将是一个无法维护的巨大混乱。

# sql - 为什么你讨厌 Oracle 上的序列？

> ID：482046
> 
> 赞同：4
> 
> 时间：2009-01-27T01:31:43.260
> 
> 标签：sql, oracle, sequences

有些人不喜欢 Oracle 上的序列。为什么？我认为它们非常易于使用并且非常好。您可以在选择、插入、更新、...中使用它们

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-27T01:38:34.570

总而言之，我喜欢序列，但我更喜欢列的自动增量关键字。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-27T02:08:25.930

因为我被 DBA 多次迁移数据库、移动所有对象和数据、错误地重新创建序列、从 0 重新启动它。欢闹随之而来……

序列也可以在 RAC 上为循环抛出一个，除非你指定你希望它们严格递增，否则你会从中得到唯一的数字——但不一定是严格递增的顺序（发生这种情况是因为为了避免间- 每个 sequence.nextval 调用的节点通信，每个节点都会获得即将到来的数字的一小部分）。对各种“select max(sequence_id)”查询造成严重破坏。

哦，自动增量关键字很好，但这只是语法糖——另外两个问题是相当严重的“陷阱”。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-01-28T02:11:26.907

我不。我应该指出，有时人们讨厌他们不理解的东西。

序列对于生成唯一 ID 非常重要。从概念上讲，拥有一种生成不依赖于表内容的 ID 的方法很有用。您无需锁定表即可生成唯一编号。

序列对于在需要唯一的多个表中生成键也很有用。例如，如果我有一个新项目进入系统，并且我想一次将一行放入多个表中，我可以从序列中获取一个 ID，并在插入任意数量的表时重复使用它。正确完成后，我知道 ID 不会与表中已有的值冲突，并且每一行都将具有相同的 ID。

我认为这些事情也可以通过自动增量列实现。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-27T02:01:24.650

我以前更喜欢自动递增列（ala MySQL、SQL Server 和其他），直到我深入研究 JPA。那时，自动递增字段的弱点对我来说变得很明显：您必须先插入才能获得 ID。这是维护对象之间关系的问题。

在 JPA 中使用 Oracle 时，一旦您这样做`entityManger.persist(object)`，它就会选择下一个序列值并将其分配为 ID，而自动递增列在提交之后才会发生。巨大差距。

不过，它们有点难，我猜这就是人们不喜欢它们的原因（或者他们没有看到与自动递增字段相比的优势）。

序列的另一个问题是它们只是松散的排序，很多人想要绝对排序。我认为这是最大的缺点（无论如何我都能看到）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-27T01:34:57.573

因为它们比 IBM Informix Dynamic Server 中的 SERIAL 列更难使用。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-27T03:21:44.660

一些同事不喜欢它们，因为很难记住样板来设置一个普通的自动增量字段。

幸运的是 SQL Developer 会为您填写样板文件，所以现在问题还不错。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-27T10:48:34.710

我不讨厌序列。序列很棒。爱他们！

它们在分布式环境中是安全的；它们可用于在需要时模拟自动增量字段（使用触发器），同时还可以让您事先获取 ID - 当您准备将数据集加载到多个表中并且您在插入之前需要 ID 时，这非常有用。

我接受 Jonathan Leffler 对他自己的回答的评论，但是 - 对我来说 - 控制的平衡一个单独的序列为您提供了 ID 生成，并且相对容易模仿 AUTOINCREMENT 字段的工作。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-28T01:46:41.950

序列的一个问题是，如果您有多个工作人员写入同一个表，所有工作人员都从同一个序列中获取他们的密钥，结果是索引块周围会出现争用，工作人员很有可能正在写入同一个表阻止（意味着他们必须等待）。

对此的一种解决方案是使用反向键索引。

另一种选择是创建一个由以下内容组成的密钥：worker_number||nanoTime()||random_number()

即极有可能提供唯一数字的东西。（例如地球被小行星撞击比得到重复数字更有可能）

# map - 如何在 Sage/Maxima 中制作国家图？

> ID：482048
> 
> 赞同：1
> 
> 时间：2009-01-27T01:31:54.133
> 
> 标签：map, modeling, simulation

今天听说千里马可以在 Sage 中通过 contour_plot 来绘制国家图。我尝试以下方法未能成功导入 Maxima：

```
from Maxima import contour_plot 
```

我想制作一张和[这里](http://dl.getdropbox.com/u/175564/sage-map.png)类似的地图。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-27T21:24:01.760

您可能是指等高线图。快速入门并将此代码粘贴到您的 Sage Notobook：

f = λ x,y: cos(x*y)

轮廓图(f, (-100, 4), (-4, 4))

更多示例：

*   [http://www.flickr.com/photos/sagescreenshots/2131281877/](http://www.flickr.com/photos/sagescreenshots/2131281877/)
*   [http://norsemathology.org/wiki/index.php?title=基准](http://norsemathology.org/wiki/index.php?title=Benchmarks)

# version-control - 有人在公司环境中使用分布式 VCS 吗？

> ID：482049
> 
> 赞同：3
> 
> 时间：2009-01-27T01:32:02.837
> 
> 标签：version-control, dvcs, corporate

我很想知道人们在企业环境中使用分布式版本控制的经验。

具体来说：

1.  被收养难吗？
2.  既然已经到位了，是不是很受欢迎呢？
3.  您使用的是什么“模型”（集线器和辐条？还有什么？）
4.  允许您使用集线器和辐条，推送到中央服务器是否有任何纪律问题？
5.  我想知道是否有人在这种环境中工作的非程序员，最好是艺术家等，VCS 对他们来说可能有点令人生畏。对他们有用吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-27T02:19:29.747

1 - 不，因为我们只是告诉人们他们必须使用它。如果您无法控制您的 VCS 和您的员工，那么您将面临更大的问题......

2 - 好吧，从 SVN 到 Git，我想说大约一半的开发人员抱怨增加的复杂性。另一半对增加的力量表示赞赏。

3 - 按照惯例，我们指定一台服务器作为中央存储库。

4 - 无 - 我的意思是如果人们没有推送到正确的服务器，那么他们的工作就不会被认为是完整的，因此无法集成、QAed 等。如果他们不能遵循此类事情的指导方针......同样如上面的＃1。

5 - 这是个好问题。我们鼓励我们的非技术人员尽可能使用 GUI 工具，这似乎让他们的事情变得更简单。几乎所有开发人员都使用命令行，除非他们正在查看分支历史记录或其他视觉原因。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-27T01:40:22.413

您是否将带有 Multisite 的 IBM Rational (Atria) ClearCase 视为 DVCS？

我们已经使用它 15 年了，其中包括 IBM 收购我们之前的 7 年。它使我们能够在美国和美国以外的地点相当有效地工作。

在大多数情况下，它运作良好，主要是通过保持不碍事。

不确定适用哪种型号。

我们没有很多非程序员使用它 - ID（信息开发 - 意思是 Tech Pubs）团队是使用它的主要非程序员群体。

CC-MS 仍然有一个有点集中的模型 - 分支在特定站点“掌握”，并且该分支上的更改只能在同一站点的视图中进行。这只是意味着您必须小心分支和合并 - 但合并非常好（分支也是如此）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-27T01:58:14.140

目前，在与一些同事讨论之后，我正在考虑在工作中采用 git 的想法。他们无法想象使用 DCVS 是个好主意。主要是因为他们认为合并问题太大了。我在家中将 git 用于自己的小项目，以下是我在工作中使用它的方式和原因：

*   签出我工作的 svn 项目到 git
*   提交而不需要关心破坏构建（或分支实验）
*   避免对中央服务器的查找/合并滞后
*   将最后的结果提交到 svn-trunk

顺便说一句，这似乎（在 Linus 在 Google 上关于 git 的演讲之后）是在工作中使用 DCVS 的一种常见方式：）

# c++ - 如何“调整”函子以与地图/多地图一起使用？

> ID：482059
> 
> 赞同：1
> 
> 时间：2009-01-27T01:38:21.687
> 
> 标签：c++, stl, map, functor, multimap

我在将 std::for_each 和其他算法与多映射一起使用时遇到困难，并且想知道是否有人可以帮助我开发一个可以将适当参数传递给“通用”函数的函子。

我对 map/multimap 的具体问题是它们的迭代器评估为 std::pair 而不是我需要使用的包含值（我的意思是 mapped_type）。所以，我的问题是，有没有办法将正确的值传递给设计用于使用其中一种包含类型的地图/多地图的函数？

这是我的示例代码：

```
// the key type for the multimap
typedef enum { ... } Module;

// my class as the mapped type for the multimap
struct Patch
{
    void Apply(bool enable);
}

// I have some functors designed to work directly with Patch pointers
// because in other places I use set<Patch*> or other containers
struct ApplyOnCondtion: public unary_function<Patch*, void>
{
    void operator() (Patch* patch)
    {
        if(some_condition) patch->Apply(enable_or_not);
    }
}

// somewhere I have a collection of patches attributed to some module
multimap<Module, Patch*> patches;

// the problem is that using for_each with a map or a multimap results in
// a `pair<Module,Patch*>` as argument to the functor, not the Patch* as desired.
for_each(patches.begin(), patches.end(), ApplyOnCondition(...)); 
```

我认为也许 bind1st 或 bind2nd 与 mem_fun 结合可以解决这个问题，或者我能想到的另一种方法是创建一个新的仿函数来存储原始仿函数并传递对的正确成员，但我不是设法得到任何好的结果。有STL经验的人可以给点建议吗？

```
EDIT 1 
```

好的，在不使用 boost 或额外的临时容器的情况下，我能得到的最好的结果如下：

```
#include <functional>
#include <utility>
using namespace std;

//////////////////////////////////////////////////////////////////////////
// any functor to be called must be derived from unary_function or
// have defined result_type and argument_type.
// template 'First' should be set to pair::first_type
template<typename First, typename Func>
class passSecond_t: public unary_function<
                        pair<First,typename Func::argument_type>,
                        typename Func::result_type>
{
    Func* func;

public:
    passSecond_t(Func &functor): func(&functor) {}

    result_type operator()(argument_type value)
    {
        return (*func)(value.second);
    }
};

// construction helper, unfortunately 'First' must be explicitly specified
template <typename First, typename Func>
passSecond_t<First, Func> passSecond(Func& functor)
{
    return passSecond_t<First, Func> (functor);
}

// the following is a sample
#include <map>
#include <algorithm>
#include <iostream>

struct SampleClass 
{
    void execute(char* text)
    {
        cout << "this: " << this << ", text: " << text << endl;
    }
};

struct SampleFunctor: public unary_function<SampleClass*,void>
{
    char* text;
    SampleFunctor(char* text_): text(text_) {}

    result_type operator() (argument_type argu)
    {
        argu->execute(text);
    }
};

void main()
{
    map<int,SampleClass*> mymap;
    SampleClass s1, s2;
    mymap[0] = &s1;
    mymap[1] = &s2;

    SampleFunctor myfunctor("my text");

    for_each(mymap.begin(), mymap.end(), passSecond<int>(myfunctor));
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-27T01:46:47.893

我一开始就有一个提升解决方案：

```
for_each(patches.begin(), patches.end(), 
         boost::bind(ApplyOnCondition(...),
                     boost::bind(&map_type::value_type::second, _1))); 
```

这需要该对的 ::second 成员，并将其推送到 ApplyOnCondition 的 operator()。`map_type`是地图的类型（`multimap<Module, Patch*>`当然）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-27T02:35:03.240

You can grab all the values using `std::transform`:

```
std::multimap<Module, Patch *> patches;

std::vector<Patch *> values(patches.size());
std::transform(patches.begin(), patches.end(), values.begin(),
    std::select2nd<std::multimap<Module, Patch *>::value_type>()); 
```

Then `std::for_each` on that vector:

```
std::for_each(values.begin(), values.end(), ApplyOnCondition(...)); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-08-21T08:36:59.767

这是一个解决方案，它的工作方式更像是在函数式语言中执行此操作：

```
 /**
   * Applies a function to the values in a map, producing a map with the same
   * keys but containing the values produced by the function.
   * In Haskell, the type of this function would be something like
   * mapply :: (a -> b) -> Map c a -> Map c b
   */
  template<typename Function, typename Key, typename InValue, typename OutValue>
  static std::map<Key, OutValue> mapply(Function function, const std::map<Key, InValue>& inMap) {
    typedef typename std::map<Key, InValue>::const_iterator InIterator;
    const InIterator end(inMap.end());
    std::map<Key, OutValue> outMap;
    for (InIterator i(inMap.begin()); i != end; ++i) {
      outMap.insert(std::make_pair(i->first, function(i->second)));
    }
    return outMap;
  } 
```

此代码符合 C++98。在 C++11 中，它可以被简化。

另请注意，该函数按值返回地图。如果您没有迹象表明这是您的性能瓶颈（过早的优化是万恶之源），那没关系，但是如果您有一个巨大的地图并且不相信您的编译器会进行优化，那么您可能宁愿拥有“mapply”函数通过引用获取 out 参数的解决方案：用键值对填充的映射。

# c++ - 在 C++ 中复制一个未知的具体类型

> ID：482073
> 
> 赞同：5
> 
> 时间：2009-01-27T01:42:15.623
> 
> 标签：c++, inheritance, polymorphism

假设我们有以下类层次结构：

```
class Base {
    ...
};

class Derived1 : public Base {
    ...
};

class Derived2 : public Base {
    ...
}; 
```

给定一个`Base*`可以指向a`Derived1`或`Derived2`对象的a，鉴于它的具体类型未知，我如何制作实际对象的副本。我想过定义复制构造函数，但我认为如果不知道所涉及的实际类型，这是不可能的。我能想到的唯一解决方案是为层次结构中的每种类型定义一个`clone()`方法。有人能想到更优雅的东西吗？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-01-27T01:55:11.293

不幸的是，虚拟克隆/复制模式是您唯一真正的选择。

这有一些变化，但基本上它们都归结为为每种类型编写函数，可以返回一个新副本。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-27T02:08:02.717

您需要在层次结构中的每个对象上实现虚拟克隆方法。你的未定义类型的对象怎么知道如何复制自己？

为了使编写派生类的人更清楚这一点，您可能会考虑在您的基类中也使克隆方法抽象，以迫使人们至少编写一些东西。

在我的代码的几个地方，我还测试以确保正确实现 to_string() 方法以将对象序列化为字符串。我在课堂上用来同时测试 clone 和 to_string 的具体测试如下所示：

```
Base *obj1, *obj2;
# initialize obj1 in a reasonable manner
obj2 = obj1->clone();
assert( obj1->to_string() == obj2->to_string() ); 
```

这是测试克隆方法（）和对象序列化到字符串（所以它不是严格的单元测试），但它是一种简单的范式，可以在工厂中的所有对象的循环中包装以确保它们是遵循实现 clone() 和 to_string() 的一些最低标准。

编辑：更新了代码，并根据 strager 的评论进行了更正。谢谢！

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-27T01:51:14.717

我不认为这很容易做到。事实上，在 Effective C++ 中，Meyers 警告说，如果你有一个按值传递的函数，并说你有

```
void foo(Base b) 
```

并且您将 a 传递给`Derived1 d1`，`foo`副本将被切掉 - 即不会复制派生部分。

但是我现在是从记忆中引用的……

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-27T02:09:15.883

复制构造函数是不可能的（据我所知），因为在调用构造函数*之前分配了内存。*使用已知类型的复制构造函数，而不是对象类型。

```
Base *foo = new Derived1();
Base bar = *foo;               // Base's copy constructor is called. 
```

正如您所建议的，您最好的选择是提供一种`clone()`方法。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-27T02:15:43.700

另一种方法是创建一个类似工厂的`Base`，假设您知道所有派生类：

**再想一想，这可能是个坏主意！**

```
class Base {
    public:
        static Base *clone(const Base *obj) {
            if((Derived1 *o = dynamic_cast<Derived1 *>(obj)) {
                return new Derived1(*o);
            } else if((Derived2 *o = dynamic_cast<Derived2 *>(obj)) {
                return new Derived2(*o);
            }

            /* TODO When more classes are added, put them here.  (Probably bad design, yes.) */

            return new Base(obj);
        }

        Base *clone() const {
            return clone(this);
        }
}; 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-27T02:16:48.613

如果您想要一个透明的克隆方法，请查看[Implicit Sharing](http://doc.trolltech.com/4.0/shclass.html)。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-27T02:35:38.480

你是对的`clone()`。您不能使用构造函数，因为它们强制静态绑定。您不能按值返回对象，因为这再次强制静态绑定。因此，您需要一个返回动态分配对象的虚函数。

# .net - Castle ActiveRecord、Web 项目和 Bin 文件夹

> ID：482080
> 
> 赞同：0
> 
> 时间：2009-01-27T01:46:06.210
> 
> 标签：.net, asp.net, castle-activerecord

对于要使用 Castle ActiveRecord 的 ASP.NET 3.5 项目，需要将哪些程序集添加到 Bin 文件夹中？

是不是：
Castle.ActiveRecord.dll
Castle.Core.dll
Iesi.Collections.dll
NHibernate.dll
log4net.dll

还需要什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-27T02:02:48.220

对于 Castle RC3，您缺少 Castle.DynamicProxy.dll 和 Castle.Components.Validator.dll

# c - GDI 泄漏问题

> ID：482083
> 
> 赞同：3
> 
> 时间：2009-01-27T01:47:22.713
> 
> 标签：c, winapi, gdi

我注意到使用任务管理器，以下代码中存在 GDI 泄漏。执行此代码的进程中 GDI 对象的计数每次执行时都会增加 1，但是我似乎找不到问题所在。

任何帮助，将不胜感激。

```
// create new DC based on current    
HDC hDC = CreateCompatibleDC(GetDC());
// select a bitmap into the new DC and keep the old one
HGDIOBJ hOldObj = SelectObject (hDC,hBM);
// do somthing here --> 100% no leak here
SomeFunction (hDC);
// select the old object back from whence it came and delete whats returned   
DeleteObject (SelectObject (hDC,hOldObj));
// delete the DC
DeleteDC(hDC);
// delete the tmp object
DeleteObject (hOldObj); 
```

R M

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-27T02:39:19.003

从评论中复制，我没有把它作为答案，因为我无法测试它，我不确定它是否正确，请测试它。

一般来说，嵌套调用不是一个好主意，即

```
HDC hDC1 = GetDC(); 
HDC hDC2 = CreateCompatibleDC(hDC1); 
.. 
```

代替

```
HDC hDC = CreateCompatibleDC(GetDC()); 
```

（顺便说一句，在您的代码中，GetDC 返回的 HDC 未发布。）

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-27T02:22:20.660

确保您`ReleaseDC`不在`DeleteDC`从`GetDC`.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-11-17T16:58:50.153

我可以建议 deleaker 查找并修复泄漏。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-27T02:16:55.430

（我正要说这个时，我注意到已经有答案的评论 - 归功于 xhantt）

我不认为 GetDC() 在第一行创建的 dc 被释放。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-27T04:56:59.380

我想这个问题已经回答了。我想跳入并推荐可用于 GDI 对象的各种智能指针类和包装器。

MFC 有各种与 GDI 相关的对象，如 CDC 和 CMemoryDC 等。当不再需要它们时，它们将执行正确的删除。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-27T17:20:23.903

阅读 Petzold。GetDC() 是真正的基础。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-27T17:26:24.250

您不应该在最后一行删除 hOldObj

DeleteObject (hOldObj);

# apache-flex - Flex - Mate 框架 - 调度事件

> ID：482085
> 
> 赞同：2
> 
> 时间：2009-01-27T01:48:23.053
> 
> 标签：apache-flex, mate

我最近更改为 Mate 作为 flex 的框架。但是我遇到了一些问题。我想知道如何从通过 methodInvoker 标签生成的类中调度事件。

```
<resultHandlers>
        <MethodInvoker generator="{LoginSuccess}" method="setCurrentUser" arguments="{[resultObject]}"/> 
```

然后在课堂上我想分派一个事件。

```
public function setCurrentUser(calUser:Object):void{
        if(calUser != null){
            Model.instance.currentUser = calUser as CalUser;
            loadOnlineCalendars(Model.instance.currentUser);
        }
    }

    public function loadOnlineCalendars(calUser:CalUser):void{
        for(var i:int = 0 ; i<calUser.calConnectors.length; i++){//logic here
            dispatchEvent(new CalConnectorEvent(calUser.calConnectors as CalConnector,CalConnectorEvent.LOAD_ONLINE_CALENDAR_EVENT,true));
        }
    } 
```

问题是我似乎无法在 eventMap 甚至在应用程序根目录中捕获事件。

如果有人对 Mate 有任何经验，我将不胜感激。也许我做这一切都错了。我只想从服务器获取结果 - 查看结果并根据结果再次联系服务器。应该很简单。

活动地图：

```
 <resultHandlers>
            <MethodInvoker generator="{LoginSuccess}" method="setCurrentUser" arguments="{[resultObject]}"/>
            <ServiceResponseAnnouncer type="result"/>

            </resultHandlers>
            <faultHandlers>
            <ServiceResponseAnnouncer type="fault"/>

            </faultHandlers>
    </RemoteObjectInvoker> 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-27T08:13:29.873

通常的做法是将事件映射的调度程序注入到对象中：

```
<MethodInvoker generator="{MyClass}" method="someMethod" arguments="{[a, b]}">
  <Properties dispatcher="{scope.dispatcher}"/>
</MethodInvoker> 
```

内部`Properties`标记设置由 正在创建的对象`MethodInvoker`的属性，并保证在调用方法之前设置属性。

该类显然需要一个名为`dispatcher`（或您喜欢的任何名称）的公共属性才能正常工作。在事件映射调用中分派您要监听的事件`dispatcher.dispatchEvent(...)`。

如果由创建的对象`MethodInvoker`将被多次使用，如果它是一个经理，比如说，常见的习惯用法是使用一个`ObjectBuilder`被触发的事件处理程序块来创建它`FlexEvent.INITIALIZE`：

```
<EventHandlers type="{FlexEvent.INITIALIZE}">
  <ObjectBuilder generator="{MyClass}" constructorArguments="{scope.dispatcher}"/>
</EventHandlers> 
```

在此示例中，事件调度程序作为构造函数参数注入，但您可以使用内部`Properties`标记，就像使用`MethodInvoker`.

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-27T03:05:55.690

经过一番挖掘[，](http://mate.asfusion.com/forums/topic.php?id=319)我发现你不能从非视图类中调用事件。该论坛帖子描述了优雅的解决方案，并提供了一个快速的解决方法：

```
Application.application.dispatchEvent(new CalConnectorEvent(calUser.calConnectors as CalConnector,CalConnectorEvent.LOAD_ONLINE_CALENDAR_EVENT,true)); 
```

但是请查看论坛帖子-那里有很多肉。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-18T11:24:07.727

您可以从 actionscript 中的类调度事件。为此，它必须扩展 EventDispatcher 类或使用一些调度程序属性并实现 IEventInterface。但这不是正确的方法，因为事件不会冒泡，因为冒泡是特定于显示对象的属性。您可以在目标阶段收听类本身中的事件。如果您希望其他节点监听事件，它必须冒泡。因此，正如 Theo 回答的那样，您必须将 mate 框架的调度程序传递给班级。现在您可以从类中分派事件。这可能是从数据类分派事件的最佳方式。有关更多信息，请参阅此链接[http://www.developria.com/2010/05/pass-the-eventdispatcher-pleas.html](http://www.developria.com/2010/05/pass-the-eventdispatcher-pleas.html)

# wpf - WPF 绑定到 My.Settings 的单选按钮（使用 vb.net）

> ID：482086
> 
> 赞同：0
> 
> 时间：2009-01-27T01:49:47.747
> 
> 标签：wpf, binding, checkbox, radio-button

遵循 [WPF Binding My.Settings collection to Combobox items的建议](https://stackoverflow.com/questions/204779/wpf-binding-my-settings-collection-to-combobox-items)

我能够为复选框绑定工作，但不能为单选按钮工作？

保存 MySettings 后，复选框值是 true 还是 false，具体取决于复选框是否被选中（如预期的那样），而单选按钮始终返回 true。

对我做错了什么有任何见解，或者这是一个错误？

（ps：我找到了解决方法，但是...）

```
 xmlns:self="clr-namespace:myprog"  

                    <CheckBox     Name="cbStartDocked"     IsChecked="{Binding Source={x:Static self:MySettings.Default}, Path=StartDocked}" Margin="8,0,20.706,39" Height="21" VerticalAlignment="Bottom">Start doc_ked</CheckBox>
                    <RadioButton  Name="rbDockLeft"        IsChecked="{Binding Source={x:Static self:MySettings.Default}, Path=DockLeft}"    Margin="25,0,24,24" Height="16" VerticalAlignment="Bottom">Dock _left</RadioButton>
                    <RadioButton  Name="rbDockRight"       IsChecked="{Binding Source={x:Static self:MySettings.Default}, Path=DockRight}"   Margin="25,0,33,2" Height="16" VerticalAlignment="Bottom">Dock _right</RadioButton> 
```

设置应该是正确的大小写，所有布尔值所有用户范围，根据需要默认值为 true 或 false

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-27T22:43:06.920

为了他人的利益，这里是我应用的工作：

Private Sub rbDockLeft_Checked(ByVal sender As Object, ByVal e As System.Windows.RoutedEventArgs) 处理 rbDockLeft.Checked

```
 My.Settings.DockLeft = True
    My.Settings.DockRight = False 
```

结束子

Private Sub rbDockLeft_Unchecked(ByVal sender As Object, ByVal e As System.Windows.RoutedEventArgs) 处理 rbDockLeft.Unchecked

```
 My.Settings.DockLeft = False
    My.Settings.DockRight = True 
```

结束子

# javascript - 使用 JavaScript，我可以更改 SVG 的 Z 索引/图层吗 元素？

> ID：482115
> 
> 赞同：88
> 
> 时间：2009-01-27T02:11:12.133
> 
> 标签：javascript, svg

假设我有几个复合形状 ( `<g>`)。我希望能够单击并拖动它们，但我希望我碰巧正在拖动的那个在 Z 顺序中位于另一个的顶部，这样如果我将它拖动到另一个上，另一个一个应该黯然失色。

* * *

## 回答 #1

> 赞同：117
> 
> 时间：2009-01-27T02:27:58.590

SVG 中的 Z 索引由元素在文档中出现的顺序定义。如果要将特定形状置于顶部，则必须更改元素顺序。

* * *

## 回答 #2

> 赞同：40
> 
> 时间：2011-06-09T08:03:13.897

在树中移动元素的另一种方法是使用`<use>`您更改`xlink:href`属性的元素，以便它为您提供所需的 z 顺序。

这是 svg-developers 邮件列表上的一个[旧线程](http://tech.groups.yahoo.com/group/svg-developers/message/59312)，在想要为某些形状设置动画的背景下讨论这个主题。

**更新：**

```
<svg xmlns="http://www.w3.org/2000/svg" 
     xmlns:xlink="http://www.w3.org/1999/xlink"
     style="width:100%; height: 100%">
    <circle id="c1" cx="50" cy="50" r="40" fill="lime" />
    <rect id="r1" x="4" y="20" width="200" height="50" fill="cyan" />
    <circle id="c2" cx="70" cy="70" r="50" fill="fuchsia" />
    <use id="use" xlink:href="#c1" />
</svg> 
```

在此示例中，<use> 元素是最后一个元素，这使其成为最前面的元素。`xlink:href`我们可以通过更改属性选择任何其他元素作为最前面的元素。在上面的示例中，我们选择了带有 的圆圈`id="c1"`，这使其显示为最顶部的元素。

见[小提琴](http://jsfiddle.net/hkSFf/)。

* * *

## 回答 #3

> 赞同：25
> 
> 时间：2011-11-07T23:46:50.537

这是个老问题，但是...

在 FireFox (7+) 和 Chrome (14+) 上，您可以将 svg_element 拉到顶部。这不会给您完全 z 轴控制的自由，但总比没有好；）

只需再次附加该元素。

```
var svg = doc.createElemNS('svg');
var circle = doc.createElemNS('circle');
var line = doc.createElemNS('line');

svg.appendChild(circle); // appends it
svg.appendChild(line);   // appends it over circle
svg.appendChild(circle); // redraws it over line now 
```

我以为它会抛出错误或其他东西。

> appendChild == 替换自身 == 重绘

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-01-27T02:49:08.517

是的，顺序是指定什么对象将在另一个对象前面。要操作顺序，您需要移动有关 DOM 的内容。SVG wiki 上有一个很好的例子，网址为[https://www.w3.org/TR/SVG11/render.html#RenderingOrder](https://www.w3.org/TR/SVG11/render.html#RenderingOrder)

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2015-03-06T17:49:15.193

另一个未提及的解决方案是将每个 svg 项目/项目集放入一个 div 中。您可以轻松更改 div 的 z-index。

[小提琴：SVG元素循环与容器的z-index](http://jsfiddle.net/3ghn7m6a/)

...按下按钮将该元素“推”到前面。（与重新绘制整个集合并将 1 个元素推到前面，但保持原始顺序与接受的解决方案一样）

拥有相对 z 索引会非常好......

如果它是来自 jsfiddle 的链接，stackOverflow 想让我把代码放在里面吗？......好

```
var orderArray=[0,1,2];
var divArray = document.querySelectorAll('.shape');
var buttonArray = document.querySelectorAll('.button');

for(var i=0;i<buttonArray.length;i++){
    buttonArray[i].onclick=function(){
        var localI = i;
        return function(){clickHandler(orderArray.indexOf(localI));};
    }();
}

function clickHandler(divIndex) {
     orderArray.push(orderArray.splice(divIndex, 1)[0]);
    orderDivs();
}

function orderDivs(){
    for(var i=0;i<orderArray.length;i++){
       divArray[orderArray[i]].style.zIndex=i;        
    }
}
```

```
svg {
    width: 100%;
    height: 100%;
    stroke: black;
    stroke-width:2px;
    pointer-events: all;
}
div{
    position:absolute;
}
div.button{
    top:55%;
    height:5%;
    width:15%;
    border-style: outset;
    cursor:pointer;
    text-align: center;
    background:rgb(175, 175, 234);

}
div.button:hover{
    border-style: inset;
    background:yellow;

}
div.button.first{
    left:0%;
}
div.button.second{
    left:20%;
}
div.button.third{
    left:40%;
}
```

```
<div class="shape">
    <svg>
    <circle cx="50" cy="50" r="40" fill="lime" />
    </svg>
</div>
<div class="shape">
    <svg>
        <rect x="4" y="20" width="200" height="50" fill="cyan" />
    </svg>
</div>
<div class="shape">
    <svg>
        <circle cx="70" cy="70" r="50" fill="fuchsia" />
    </svg>
</div>

<div class='button first'>lime</div>
<div class='button second'>cyan</div>
<div class='button third'>fuchsia</div>
```

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2015-03-13T12:15:44.787

如果您使用[svg.js 库](https://github.com/wout/svg.js/)，则可以使用“.front()”命令将任何元素移动到顶部。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2016-08-26T11:54:48.240

亚当布拉德利对山姆回答的评论完全正确。它只使用 jQuery 而不是 CSS，但他这样说：

```
$('#thing-i-want-on-top').appendTo('#my-svg'); 
```

但是，对于我正在创建的内容，我需要我的 SVG 路径在悬停时高于任何其他路径，但仍低于我的 SVG 文本。所以这就是我想出的：

```
$('#thing-i-want-on-top').insertBefore('#id-for-svg-text'); 
```

appendTo 和 insertBefore 都会将您的元素移动到一个新位置，允许您随意更改 SVG 元素的深度。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2014-01-16T13:03:03.670

`SVG`使用“画家模型”进行渲染。绘画在连续操作中应用于输出设备，以便每个操作在输出设备的某个区域上绘画。当该区域与先前绘制的区域重叠时，新油漆会部分或完全遮盖旧油漆。-[链接到此](http://www.w3.org/TR/SVG/render.html#PaintersModel)

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2016-10-04T21:00:36.537

在 SVG 中，要获得更大的 Z 索引，您应该在 DOM 树中向下移动元素。您可以使用 jQuery 执行此操作，选择 SVG 元素，将其删除并再次附加到您想要的位置：

```
$('g.element').remove().appendTo('svg'); 
```

# sql-server - Firebird 到 SQL Server 的迁移

> ID：482117
> 
> 赞同：3
> 
> 时间：2009-01-27T02:15:20.923
> 
> 标签：sql-server, firebird

1.  是否有 SQL Server 原生的工具来进行迁移（即导入/导出）？

2.  任何其他选项 (SSIS)。

请指点我有用的信息。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-27T02:23:08.757

SQL 服务器带有导入/导出功能。我不太了解 Firebird，但如果它支持 ODBC，您可以将 ODBC 驱动程序安装到您的 SQL 服务器上，然后导入。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-13T20:26:55.497

这是指南[http://forums.devshed.com/firebird-sql-development-61/export-firebird-db-568805.html](http://forums.devshed.com/firebird-sql-development-61/export-firebird-db-568805.html)

还有 fbexport 可以导出为 xml/csv 格式 [http://fbexport.sourceforge.net/](http://fbexport.sourceforge.net/) [http://firebirdsql.org/dotnetfirebird/blog/2005/01/fbexport-command-line-tool-for-data.html](http://firebirdsql.org/dotnetfirebird/blog/2005/01/fbexport-command-line-tool-for-data.html)

ps：也许我应该为它添加一个 json 选项:)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-27T02:32:30.047

您可以编写一个快速应用程序，将您的所有数据从 Firebird 转储为 XML。您的 SSIS 可以从那里获取它。考虑到您没有大量数据，Firebird 是理想的选择

# image - 调整大小与裁剪

> ID：482118
> 
> 赞同：1
> 
> 时间：2009-01-27T02:15:43.700
> 
> 标签：image

假设您正在创建一个类似 eBay 的网站，用户可以在其中列出他们希望出售给其他人的商品，并且您希望允许他们上传图片。为了使站点看起来尽可能“干净”，您决定所有图像缩略图将在主页上呈现为 100x100 像素的正方形（如果需要，完整的图像可以显示在另一个屏幕上）。

这样做的最佳方法是什么？您是否应该简单地将图像调整到特定尺寸并冒着变形的风险，或者裁剪图像并冒着切掉图像的重要部分的风险？或者只是用相同的纵横比缩小它并用一些默认颜色填充额外的空间？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-27T02:22:51.267

我会说将图像大小调整为 100x100 而不考虑原始图像的方面的选项是不可接受的解决方案。在我个人看来，最好的选择是为用户提供一个方形选择工具，允许他们在上传的图像上拖动和移动裁剪区域。一旦他们选择了裁剪区域，您就可以裁剪图像并将其调整为 100x100 像素。这将为您提供最清晰的缩略图图像。由于图像将链接到原始尺寸的全尺寸图像，因此我不担心某些图像会丢失。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-27T02:30:41.110

假设您需要为不能或不会使用图形裁剪工具的用户提供后备解决方案，我会建议一个操作列表供用户选择。

*   信箱（显示黑条，不截断任何内容）
*   裁剪到中心
*   裁剪到 [NE/NW/SE/SW] 角
*   裁剪到 [N/E/S/W] 侧的中间

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-27T02:19:29.823

你可以两者都做。

您可以提供一个滑块，以特定比例调整图像大小，并允许它们在您想要的结果图像大小的剪切区域周围移动。

# javascript - Javascript“这个”问题

> ID：482128
> 
> 赞同：2
> 
> 时间：2009-01-27T02:20:24.893
> 
> 标签：javascript, jquery

为什么当 setTimeout 调用它是匿名回调时，'me' 和 'this' 未定义？

```
 var gMyObj = new MyObj();
    gMyObj.myFunc();

    function MyObj() {
        this.myFunc = function () {
            var me = this;
            alert(me.constructor);  // defined
            setTimeout(function(me) {  
                      alert(me.constructor); // undefined
                  }, 100);
        };
    } 
```

解决方法：选择的答案是正确的，谢谢。我的问题是对我遇到的真正问题的简化，结果证明这是 jQuery 在 click() 方法中修改“this”以使其指向相关 DOM 元素的方式。我创建了一个新变量“me”来保留“this”，并试图将其传递给 click 方法。我需要做的只是在点击事件中使用“我”，并让闭包保持对它的引用。将“我”传递给 click() 失败，原因与本示例中失败的原因相同，即 click() 没有预料到它。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-01-27T02:22:38.710

因为这：

```
function(me) { 
```

做了：

```
function() { 
```

你可以走了。

至于“为什么？” 部分，您正在定义一个匿名函数，该函数接受一个名为`me`. 当`setTimeout()`调用该函数时，它不传递任何参数，含义`me`将是未定义的。`me`从参数列表中删除允许先前定义`me`的在函数中可见。

# c# - 如何建立一种防火墙

> ID：482140
> 
> 赞同：2
> 
> 时间：2009-01-27T02:24:07.163
> 
> 标签：c#, visual-studio, firewall

实际上，我正在尝试构建的就像一种防火墙。它应该能够了解从我的机器发出的所有请求。它应该能够停止选定的那些。我什至不知道如何开始。我正在使用带有框架 2.0 的 VS 2008/2005。请让我知道是否有任何特定的课程我可以开始，是否有任何样品我可以得到。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-27T02:29:14.813

防火墙确实应该在网络堆栈中相当低的位置实现；我强烈建议 NDIS。[这篇文章](http://www.codeproject.com/KB/IP/drvfltip.aspx)可能很有趣。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-27T02:29:19.540

这样的事情可能会帮助您入门：[http ://www.mentalis.org/soft/projects/pmon/](http://www.mentalis.org/soft/projects/pmon/)

> 这个 C# 项目允许 Windows NT 管理员拦截通过计算机上的网络接口之一发送的 IP 数据包。这对于调试网络软件或监视不受信任的应用程序的网络活动非常方便。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-18T10:59:11.087

正如马特所说，它确实必须是 NDIS。

确保分配大量时间来开发驱动程序，我建议 6 - 12 个月只是为了让它进入 alpha 发布阶段。与 NDIS 打过交道后，我可以向您保证，这是一种前所未有的痛苦。

如果您打算向公众发布您的产品，您需要向微软支付一些费用以使驱动程序获得批准（WHQL），否则您的用户将在安装时遇到多个讨厌的对话框（“该软件至关重要不安全”的品种）。审批过程很慢，并且不再适用于 Windows 2000，很可能很快就会不适用于 XP。64 位批准是单独付款。

您被锁定在使用 C 语言中，但任何微小的错误都会被放大为蓝屏（例如空引用或轻微的缓冲区溢出）。你不能创建线程，你的 API 与普通的用户模式 ​​API 有 100% 的不同，实际上试图与用户模式通信意味着处理令人毛骨悚然的 IRP 系统。

NDIS 本身以一种糟糕的 MFC 风格的方式过度设计。您仅限于内核 API 的一个子集（这使得某些事情变得非常困难，例如注册表访问）。不这样做会导致立即取消 WHQL 资格（不，您不会拿回您的钱！）。

每一行代码都需要彻底检查，以确保它在运行的 IRQL 级别上表现正确（它基本上决定了您的代码是否可以被其他进程中断）。在错误的级别调用 API 函数会导致蓝屏。此外，在堆栈上创建超过 500 - 1000 字节的结构会导致堆栈溢出（当然是蓝屏）。当你有一个 15 行深的调用堆栈并且每个函数中有一些小分配时，仅此一项就可以产生一些有趣的调试会话。

尽管如此，尽管 NDIS 已经经历了 6 次修订，但如果您想要挑战，这确实是值得的。奖励是一个卖得很好的软件产品，因为没有多少人敢与这类事情纠缠不清。一项重要要求是了解汇编语言（用于调试）。阅读 Windows 内核的工作原理也很有帮助（不仅仅是 NDIS）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-24T20:59:33.113

几年前，我需要了解 Windows 系统上所有应用程序使用的网络带宽。

在不知道我正在执行的任务的规模的情况下，我开始学习如何编写 TDI 过滤器驱动程序。

大约花了两年时间。两年*全职*，因为我靠一些股票期权为生。不过，NDIS 比 TDI 更容易。Prolly 正如男人所说，全职一年。

您可以在 TDI 级别做防火墙工作，这很好，因为您可以将套接字与应用程序相关联（在 NDIS 无法做到这一点）。您还可以阻止和/或带宽形状发送。您可以阻止接收，但您不能在 TDI 上真正调整接收，因为不允许您暂停（接收代码路径在 DISPATCH_LEVEL 处执行）。我想出了一个解决方法并为此申请了专利，但我不会从技术 POV 推荐它。

OTOH 一个真正的黑客只会绕过 TDI 并直接与 NDIS 驱动程序对话；TDI 防火墙是可以绕过的。

# java - 如果 Sun 没有响应，如何成功打开 Java 错误？

> ID：482141
> 
> 赞同：6
> 
> 时间：2009-01-27T02:24:29.347
> 
> 标签：java, bug-tracking, no-response

去年万圣节，我试图打开一个 Java 错误。我立即得到回复说我的提交被接受了，从那以后就再也没有听到过任何消息。查看 Sun 的网页，我找不到任何可以查询的联系信息。大约两周前，我在[Sun 论坛上](http://forums.sun.com/thread.jspa?threadID=5361055)发了一个帖子，似乎是最合适的区域，但那里也没有任何回应。

有没有人在长时间无响应后成功让 Sun 打开错误报告？有谁知道我可以联系谁来了解我的错误报告的当前状态？

值得一提的是，我得到的内部评论 ID 是 1380005。

编辑，稍后添加：

对于好奇：什么是错误？Java Web Start 客户端在下载 JAR 文件（或其他任何内容）时，**总是**添加一个`If-Modified-Since`标头（时间日期相当于“ `-1`”——1970 年 1 月 1 日午夜前 1 秒——无论 Java 缓存是否空或满）并且**总是**添加一个`No-Cache`标题。注意：这是提供标头的**客户**`No-Cache`端！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-27T02:32:00.673

您是否收到一封电子邮件，告诉您您的错误报告将很快出现在[错误数据库中？](http://bugs.sun.com/)我提交了一次报告，大约花了一周的时间才出现在公共数据库中。还有一些关于由于“[安全原因](http://developers.sun.com/resources/bugsFAQ.html)”而不会出现在公共数据库中的错误的警告。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-28T01:05:26.430

提交错误报告时，我的结果好坏参半。我已经提交了很多与`java.util.regex`包相关的错误报告/RFE；它们总是在几周内出现在公共数据库中，并且通常很快就得到了令我满意的解决。但这可能是因为 regex 包很小而且基本上是独立的。我还提交了一些与 Swing 相关的错误报告，如果它们完全通过的话，它们总是需要很长时间才能通过。

但是我发现了两件事可以加快速度：在[JavaDesktop 论坛](http://forums.java.net/jive/category.jspa?categoryID=53)中发布有关错误的问题，并提交补丁。自从我上次去那里已经一年或更长时间了，但那时确实有 Sun 员工参与了这些论坛，如果他们在你的错误报告中看到了优点，他们可以通过系统引导它——特别是如果你提交了一个补丁。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-27T02:32:38.020

啊。

他们一直坐在关于 Java 编译器和规范中不正确行为的错误上（“异常不能被抛出，但它被抛出”）。

如果您可以在 GPL 的 Java 7 中自己修复它，您可能会有机会，否则您会被淹没。

# python - 是否替换嵌套的 For 循环...

> ID：482146
> 
> 赞同：7
> 
> 时间：2009-01-27T02:27:28.137
> 
> 标签：python, loops, for-loop, nested-loops

我有一个循环遍历一系列四个（或更少）字符串的脚本。例如：

```
aaaa
aaab
aaac
aaad 
```

如果能够使用嵌套的 for 循环来实现它，如下所示：

```
chars = string.digits + string.uppercase + string.lowercase

for a in chars:
    print '%s' % a   
    for b in chars:
        print '%s%s' % (a, b)
        for c in chars:
            print '%s%s%s' % (a, b, c)
            for d in chars:
                print '%s%s%s%s' % (a, b, c, d) 
```

这种循环嵌套是一件坏事吗？如果是这样，完成我正在做的事情的更好方法是什么？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-01-27T02:46:03.343

```
import string
import itertools

chars = string.digits + string.letters
MAX_CHARS = 4
for nletters in range(MAX_CHARS):
    for word in itertools.product(chars, repeat=nletters + 1):
        print (''.join(word)) 
```

这将打印**`15018570`**您要查找的所有单词。如果您想要更多/更少的单词，只需更改`MAX_CHARS`变量即可。对于任意数量的字符，它仍然只有两个`for`s，您不必重复自己。并且可读性很好。.

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-01-27T03:07:09.103

我将提交我的答案作为最具可读性和可扩展性的答案:)

```
import string
chars = [''] + list(string.lowercase)

strings = (a+b+c+d for a in chars
                   for b in chars
                   for c in chars
                   for d in chars)

for string in strings:
    print string 
```

编辑：实际上，这是不正确的，因为它会产生长度<4的所有字符串的重复项。从数组中删除空字符串`chars`只会产生 4 个字符的字符串。

通常我会删除这个答案，但如果你需要生成相同长度的字符串，我仍然有点喜欢它。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-01-27T02:37:32.360

首先为程序员写 - 其次是计算机。
如果它是清晰易懂的，那么它是正确的。

如果速度很重要并且编译器无论如何都没有优化它并且如果你测量它并且这是问题 - 然后想一个更快更聪明的方法！

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-01-27T02:35:03.833

我不认为这是一件坏事，只要你理解（并记录:-)它。我不怀疑可能有更 Pythonic 的方式或更聪明的解决方案（使用 lambdas 或诸如此类），但我一直更喜欢可读性而不是聪明。

由于您必须生成 1、2、3 和 4 字符“单词”的所有可能性，因此此方法与任何方法一样好。我不确定要花多长时间才能有效地生成（非常粗略）1400 万行输出（但可能每个解决方案都会遇到这个问题）。

预先计算公共前缀可能会提高速度，但你最好测量它来检查（**总是**检查，**永远不要**假设）：

```
chars = string.digits + string.uppercase + string.lowercase
for a in chars:
    print a
    for b in chars:
        ab = '%s%s' % (a, b)
        print ab
        for c in chars:
            abc = '%s%s' % (ab, c)
            print abc
            for d in chars:
                print '%s%s' % (abc, d) 
```

编辑：我实际上做了一些基准测试（使用 Windows-Python 2.6.1）——这个版本与原来的 2.84 相比需要大约 2.25 个时间单位，所以它快了 26%。我认为这可能保证它的使用（同样，只要它清楚地记录了它试图实现的目标）。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-01-27T11:01:47.320

[@nosklo](https://stackoverflow.com/questions/482146/replace-nested-for-loops-or-not#482192)和@Triptych[的](https://stackoverflow.com/questions/482146/replace-nested-for-loops-or-not#482217)解决方案产生不同的结果：

```
>>> list(map(''.join, itertools.chain.from_iterable(itertools.product("ab", 
...     repeat=r) for r in range(4)))) # @nosklo's 
```

```
[''，'a'，'b'，'aa'，'ab'，'ba'，'bb'，'aaa'，'aab'，'aba'，'abb'，'baa'，
 'bab'，'bba'，'bbb']

```

```
>>> ab = ['']+list("ab")
>>> list(map(''.join, (a+b+c for a in ab for b in ab for c in ab))) 
```

```
[''，'a'，'b'，'a'，'aa'，'ab'，'b'，'ba'，'bb'，'a'，'aa'，'ab'，'aa ',
 'aaa'，'aab'，'ab'，'aba'，'abb'，'b'，'ba'，'bb'，'ba'，'baa'，'bab'，
 'bb'、'bba'、'bbb']

```

这是修改后的@Triptych 的解决方案，它产生与@nosklo 相同的输出：

```
>>> ab = "ab"
>>> list(map(''.join, itertools.chain([''], ab, (a+b for a in ab for b in ab),
...     (a+b+c for a in ab for b in ab for c in ab)))) 
```

```
[''，'a'，'b'，'aa'，'ab'，'ba'，'bb'，'aaa'，'aab'，'aba'，'abb'，'baa'，
 'bab'，'bba'，'bbb']

```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-27T02:34:44.957

有许多算法可以生成集合的每个排列。你在这里想要的是一个相关的问题，但不是直接类似的。 [推荐阅读](http://en.wikipedia.org/wiki/Permutation#Algorithms_to_generate_permutations)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-01-27T12:15:51.990

它并不能完全回答问题，但这将返回`n`给定最大长度的第 th 个组合和要使用的字母表中的字符：

```
#!/usr/bin/python

def nth_combination(n, maxlen=4, alphabet='abc'):
    """
    >>> print ','.join(nth_combination(n, 1, 'abc') for n in range(3))
    a,b,c
    >>> print ','.join(nth_combination(n, 2, 'abc') for n in range(12))
    a,aa,ab,ac,b,ba,bb,bc,c,ca,cb,cc
    >>> import string ; alphabet = string.ascii_letters + string.digits
    >>> print ','.join(nth_combination(n, 4, alphabet) for n in range(16))
    a,aa,aaa,aaaa,aaab,aaac,aaad,aaae,aaaf,aaag,aaah,aaai,aaaj,aaak,aaal,aaam
    >>> print ','.join(nth_combination(n, 4, alphabet)
    ...                for n in range(0, 14000000, 10**6))
    a,emiL,iyro,mKz2,qWIF,u8Ri,zk0U,Dxav,HJi9,LVrM,P7Ap,UjJ1,YvSE,2H1h
    """
    if maxlen == 1:
        return alphabet[n]
    offset, next_n = divmod(n, 1 + len(alphabet)**(maxlen-1))
    if next_n == 0:
        return alphabet[offset]
    return alphabet[offset] + nth_combination(next_n-1, maxlen-1, alphabet)

if __name__ == '__main__':
    from doctest import testmod
    testmod() 
```

这当然只有当您需要随机访问组合集合而不是总是遍历它们时才有意义。

如果`maxlen`很高，则可以实现一些速度优化，例如通过摆脱字符串连接并重新计算递归的每个级别的`alphabet`长度`maxlen-1`。非递归方法也可能有意义。

# javascript - 谷歌搜索结果的 ASP.NET MVC 服务器端处理

> ID：482159
> 
> 赞同：0
> 
> 时间：2009-01-27T02:31:32.920
> 
> 标签：javascript, asp.net-mvc, server-side

这可能是一个非常简单的问题，但是......

我想做一个谷歌图像搜索（由 Javascript 执行，因为没有其他支持的选项对吗？）并在服务器端调整图像大小。

我的第一个想法是让 Javascript 生成这样的链接：

> [http://example.com/Resize.mvc/（链接）](http://example.com/Resize.mvc/(link))

但是，当我传递链接时出现了一些问题（HTML 400 错误），甚至 URL 编码似乎都没有克服，此外，没有安全措施阻止某人传递他们自己的链接等。

那么如何在服务器端运行 Javascript 搜索并在那里进行所有处理呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-27T02:45:30.350

你应该蚕食[这个 API](http://www.codeproject.com/KB/IP/google_image_search_api.aspx)

# php - 基于 PHP 的表单验证助手？

> ID：482175
> 
> 赞同：2
> 
> 时间：2009-01-27T02:37:38.897
> 
> 标签：php, validation, forms, utilities

从我使用 Ruby On rails 开始，有几个不同的打包/项目可以以可扩展的方式管理验证和错误报告。

自学 Python Pylons 我刚刚被介绍给 HTMLFill，到目前为止，它似乎是表单验证常见任务的优雅解决方案。

我知道这两个示例都是框架的功能，或者在 HTMLFill 的情况下，旨在成为框架的一部分......我仍然不记得在 cakephp、code igniter 甚至 Zend 框架中看到任何远程以及抛光的东西。我是否遗漏了一些东西，或者尝试在 PHP5 中模仿 Python 的 HTMLFill 是否值得？

免责声明：我编写了基于 Ajax 的表单验证系统，这些系统依赖于嵌入元数据，例如 class="data-required data-email" 等，但它们对我来说总是很笨重。

我相信数据验证的胖模型哲学，通过上面的 HTMLFill 示例，我计划尽可能将我的模型与常见的 HTMLFill 方案打包到每个模型中。

链接：HTMLFill - [http://www.formencode.org/htmlfill.html#introduction](http://www.formencode.org/htmlfill.html#introduction)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-13T15:39:59.043

Zebra Form 库非常好，并且会自动生成 javascript 来进行客户端验证。

[http://stefangabos.ro/php-libraries/zebra-form/](http://stefangabos.ro/php-libraries/zebra-form/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-27T02:50:36.547

Zend 框架有这个[`Zend_Validate`](http://framework.zend.com/manual/en/zend.validate.html)类，它为您提供了一组基本的验证器，您还拥有[`Zend_Filter_Input`](http://framework.zend.com/manual/en/zend.filter.input.html)用于数据过滤、验证和转义的类。

我还使用[Propel ORM 验证框架](http://propel.phpdb.org/trac/wiki/Users/Documentation/1.3/Validators)在模型级别进行验证。

您还可以在客户端级别强制验证，我推荐您使用[jQuery Validation 插件](http://bassistance.de/jquery-plugins/jquery-plugin-validation/)，它真的很好用...

# wcf - WCF 测试客户端显示 IMetadataExchange

> ID：482179
> 
> 赞同：3
> 
> 时间：2009-01-27T02:40:02.123
> 
> 标签：wcf, visual-studio-2008-sp1

当我使用 WCF 测试客户端时，它会显示一个 IMetadataExchange 端点，即使我没有定义一个端点。但是，该端点也有一个错误，表明它无法与端点对话。我已经在一些应用程序上对此进行了测试，并且所有这些应用程序都发生了这种情况：

'客户端配置中的合同'IMetadataExchange'与服务合同中的名称不匹配。'

有趣的是，这个客户端属于 Visual Studio 2008，我假设客户端 app.config 是由 VS 在后台某个地方生成的，然后使用它来尝试与服务对话。

有任何想法吗？我正在使用安装了 SP1 的 VSTS Developer。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-27T02:43:30.790

试试[这个](http://blogs.msdn.com/wcftoolsteamblog/archive/2008/08/28/tips-for-wcf-tools-in-vs2008-sp1.aspx)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2010-03-08T10:58:59.390

当您安装了 BizTalk LOB 适配器包时，也会发生这种情况。不幸的是，就我而言，由于我正在使用这些适配器，因此我无法注释掉演练中显示的部分，因此我必须忍受它（无论如何，WCF 测试客户端对于使用复杂的服务没有用输入和输出类型）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-27T05:24:41.323

Ric 的链接非常接近......我在搜索答案的早些时候看到了该链接，但没有考虑它，因为我没有安装任何与 Biztalk 相关的东西。事实证明，实际上是 Azure .Net Services SDK 导致了 machine.config 中的恶意条目。它与一些 Microsoft.ServiceBus dll 相关，我确信无论如何都是从 Biztalk 服务继承的，因此 Biztalk 链接非常接近。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-10-04T08:32:52.227

如果您在您的机器上安装了 Windows Azure SDk，请卸载并运行您的测试客户端。它将完美运行

# php - 将 __call 与静态类一起使用？

> ID：482182
> 
> 赞同：7
> 
> 时间：2009-01-27T02:42:09.870
> 
> 标签：php, oop, static, magic-methods

`__call`静态调用函数时可以使用魔术方法吗？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-01-27T02:43:44.673

还没有，据我所知，管道中有一个提议的（现在可用的）[`__callStatic`^(*Docs*)](http://php.net/language.oop5.overloading#object.callstatic)方法。否则`__call`，除了对象的实例之外，其他`__`任何魔术方法都无法使用。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-01-27T02:43:37.280

您必须使用*另一种*神奇的方法，[`__callStatic`](http://au2.php.net/language.oop5.overloading)- 这仅在 PHP >= 5.3 中可用，实际上尚未发布。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-28T23:44:54.543

如前所述，没有神奇的静态调用者。但是你可以这样编码：

```
 class First {
        public static function test1(){
            return 1;
        }
        public static function test2(){
            return 2;
        }
    }

    class Second {
        public static function test1(){
            if(func_num_args()>0){
                return func_get_args();
            }
            return 21;
        }
        public static function test2(){
            return 22;
        }
    }

    class StaticFactory {
        public static function factory($class, $method){
            if(func_num_args()>2){
                $args = func_get_args();
                array_shift($args);
                array_shift($args);
                return call_user_func_array(array($class,$method), $args);
            }else{
            return call_user_func_array(array($class,$method), array());
            }
        }
    }

    print_r(StaticFactory::factory("Second", "test1", 1, false, true));

    print_r(StaticFactory::factory("First", "test1")); 
```

# php - Is there a performance benefit single quote vs double quote in php?

> ID：482202
> 
> 赞同：57
> 
> 时间：2009-01-27T02:53:07.867
> 
> 标签：php, performance

Are there any performance benefits to using single quotes instead of double quotes in php?

In other words, would there be a performance benefit of:

```
$foo = 'Test'; 
```

versus

```
$foo = "Test"; 
```

# cocoa-touch - 如何为 UITextView 中的某个位置添加书签？

> ID：482203
> 
> 赞同：2
> 
> 时间：2009-01-27T02:53:20.490
> 
> 标签：cocoa-touch

我在 UITextView 中有大量文本。我想让用户按下一个按钮并保存显示在视图顶部的行。然后，当按下同一个按钮时，它会在稍后打开应用程序时跳转到该行。就像物理书签一样。

如何确定文本在哪里，或者滚动在哪里？以后如何自动滚动到该位置？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-27T03:19:27.830

`UITextView`是 的子类[`UIScrollView`](http://developer.apple.com/iphone/library/documentation/UIKit/Reference/UIScrollView_Class/Reference/UIScrollView.html#//apple_ref/occ/cl/UIScrollView)，因此您可以使用`UIScrollView`消息[`contentOffset`](http://developer.apple.com/iphone/library/documentation/UIKit/Reference/UIScrollView_Class/Reference/UIScrollView.html#//apple_ref/occ/instp/UIScrollView/contentOffset)和[`setContentOffset:animated:`](http://developer.apple.com/iphone/library/documentation/UIKit/Reference/UIScrollView_Class/Reference/UIScrollView.html#//apple_ref/occ/instm/UIScrollView/setContentOffset:animated:)分别获取和设置滚动偏移量。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-27T04:24:25.873

我不敢相信那是多么容易...

```
//grab current spot of scrollbar, usage: p.x & p.y as integers
CGPoint p = myText.contentOffset;

//scroll myText to a particular point
[myText setContentOffset:CGPointMake(0, 0) animated:NO]; 
```

# java - Java3D：教程、项目、通用 3D 编程

> ID：482212
> 
> 赞同：4
> 
> 时间：2009-01-27T03:01:48.973
> 
> 标签：java, java-3d

我一直在考虑玩[Java3D](https://java3d.dev.java.net/)。但首先我想知道是否有人对它做了很多工作？你做过什么类型的项目，你用什么教程/例子/指南来学习它？您对 API 的总体看法是什么？是否发达？你能用它编程游戏或做任何物理建模吗？

感谢您的输入。

此外，不确定有哪些好的标签，所以可以随意更改它们。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-27T03:12:39.217

大约 4 到 5 年前，我尝试在其中进行开发，我的印象是，虽然它最初是一个很棒的想法并且有一些好的设计，但 Sun 最终停止了它的工作，并将它移到了“炼狱”中。社区项目”，它已经慢慢消亡。

我当时正在开发一个 3D 会议应用程序，并且在我的平台上的实现中一直绕着障碍运行，还有其他机制（例如 3D 声音）、渲染选项、嵌入等……相比之下，API 还不够丰富你可以通过 DirectX 或 OpenGL 获得什么，但没有得到足够的支持。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-09-02T18:25:11.270

如果您想尝试 3D，启动和运行比尝试使用 DirectX 做任何事情要容易得多（当然，DirectX API 更接近游戏开发人员的实际操作）。

它由社区支持的事实确实意味着您今天不会获得很多丰富性，但对于很多工具来说，它仍然有足够的能力。例如，一个简单的商业数据可视化工具——而不是游戏——在 Java3D 中很容易实现（这是我使用它的主要目的）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-06-22T04:39:22.857

Java 3D 很好上手，而且它使用场景图。但是，我使用过 Java3D，我必须说，至少就 2010 年 5 月的版本而言，它仍然存在内存管理方面的问题。

因此，如果您打算尝试一下，这很好，但如果您正在考虑开发一个更严肃的应用程序，我建议您尝试其他替代方案，因为 Java3D 很可能会导致您进入 OutOfMemory 异常和此类事情，甚至当您使用适当的方法来操作场景图中的节点时...

# javascript - 是否可以在家庭服务器上自动填充文件输入字段？

> ID：482213
> 
> 赞同：0
> 
> 时间：2009-01-27T03:02:12.890
> 
> 标签：javascript, security

使用 JavaScript，很容易让 <input> 元素在页面加载后自动取值，只要它的**type**属性不是“file”；当然，这是非常有意义的，因为只需一行代码就可以将包含敏感数据的表单自动提交到服务器。

但是，在家庭服务器（WAMP，如果它有帮助的话）上，这种威胁被完全根除。那么，在风险实际上为零的情况下，是否有一种方法可以绕过文件输入字段的默认行为？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-27T03:13:43.583

[Firefox 的 iMacros](https://addons.mozilla.org/en-US/firefox/addon/3863)允许您设置小的“浏览器自动化”脚本，这些脚本可能会执行您想要的操作。

# javascript - jQuery Validation `valid()` 方法在 required 不为真时返回 0

> ID：482224
> 
> 赞同：3
> 
> 时间：2009-01-27T03:15:24.407
> 
> 标签：javascript, jquery, validation, jquery-validate

我正在使用[jQuery Validation 插件](http://docs.jquery.com/Plugins/Validation)，并且我有一个带有该类的文本框`digits`来强制它只是数字，但不是必需的。当我在表单上调用 validate 时它工作正常，但是如果我`valid()`在文本框为空时调用它，它会返回 0，尽管没有显示错误消息并且不需要设置。

有谁知道为什么它会为看似有效的输入值返回这个？

这是代码：

```
<input type="text" value="" name="kiloMetresTravelled" id="kiloMetresTravelled" class="digits"/> 
```

和脚本

```
<script type="text/javascript'>
 var isvalid = jQuery('#kiloMetresTravelled').valid(); 
 //isvalid == 0 when kiloMetresTravelled is blank
</script> 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-27T03:32:44.183

从[文档](http://docs.jquery.com/Plugins/Validation/Methods/digits)中检查这一点：

> 使“字段”为必填项且仅数字。

你可以这样做：

```
var isValid = jQuery('#kiloMetresTravelled').valid() || jQuery('#kiloMetresTravelled').val() == ""; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-10-02T10:45:20.177

我认为这有效：

```
var e="#whatever";
var isValid = $(e).valid() || $(e).val()== "" && !$(e).hasClass('required'); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-10-02T11:36:45.800

当规则方法使用“this.optional(element)”检查可选字段时，库中有一个错误。当字段为空时，this.optional 返回“dependency-mismatch”，验证方法返回“undefined”，将字段标记为无效。

完整的解释在这里：

[https://github.com/jzaefferer/jquery-validation/issues/481](https://github.com/jzaefferer/jquery-validation/issues/481)

# php - 作为一名考虑让 Perl 成为次要强项的 PHP 开发人员，我需要知道什么？

> ID：482231
> 
> 赞同：5
> 
> 时间：2009-01-27T03:18:19.877
> 
> 标签：php, perl

我认为自己在 PHP 方面非常流利，并且对几乎所有重要方面和用途以及它的缺陷都很熟悉。考虑到这一点，我认为采用 Perl 的主要问题在于语法。除了这个（一个小障碍，真的，因为我宁愿相信 Perl 的可读性更强），你认为在学习该语言之前我应该​​让自己意识到哪些关键区别？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-01-27T04:40:01.880

一些不同的东西值得一读：

*   包
*   词法作用域
*   正则表达式语法
*   散列、数组和列表（在 PHP 中都一样，在 Perl 中都不同）
*   CPAN

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-01-27T06:54:18.647

在您学习了 Perl 的基础知识之后，我强烈推荐Damian Conway的《 [Perl 最佳实践》一书。](http://oreilly.com/catalog/9780596001735/)

它确实改变了你的写作风格，以及你思考编程的方式，尤其是让你的 Perl 程序更易读、更易于维护。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-01-27T06:32:15.150

在做任何 PHP 之前，我已经使用 Perl 很长时间了，我发现过渡相当容易。

PHP 和 Perl 的语法非常相似。显然存在差异，您必须学习一组新的库（CPAN 具有大多数用途的模块，因此在您实施任何新工具之前，请先了解一下 CPAN）。

正则表达式不那么冗长，而且 imo 在 Perl 中更易于使用。另一方面，如果您了解其他 OO 语言，PHP 中的类看起来更像您所期望的。对我来说，Perl 中的 OO 似乎有点过时了。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-01-27T04:47:42.067

Perl 非常适合文件处理、提取、正则表达式。这是我为任何类型的文本处理选择的第一个工具。

尽管简洁的语法使 Perl 很难阅读，但其内置的正则表达式和文件处理的强大功能使其非常适合在传统语言中实际上要大得多的小程序。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-02-14T00:27:02.923

*   使用严格；使用警告；

*   Perl::Critic，perltidy（将来）

*   CPAN（使用 CPAN shell 安装它们）

*   要使用比当前基于 Python 的更现代的 OO 系统，您需要从 CPAN 安装 OO 系统。试试 Moose（如果 Moose 对你来说太强大了，也可以试试鼠标）。

*   Unicode 不同（集成到语言中）

*   'eq' 和 '==' 而不是 ==/===/strval/intval（重要）

*   测试方向（从 Test::More 开始）

另请参阅[Perl 编程 wiki](http://www.perlfoundation.org/perl5/index.cgi) - 教程和其他有用的链接。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-27T07:57:23.650

在游戏的这一点上，Perl 仍然是一个出色的快速-n-脏解析器应用程序。对于任何语言，您都不应该真正担心语法的简洁性，除非您使用的语言远远超出了它的用途范围。Perl 因其臭名昭著的倾斜牙签综合症而声名狼藉。这主要是因为 l33t 脚本小子喜欢将 5 行 Perl 代码压缩到 1 行。

作为旁注 C + Perl =~ m/PHP/

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2010-05-07T03:39:00.037

对于网络东西来说，看看[Catalyst 吧](http://catalystframework.org)。对于 OO 的东西，看看[Moose](http://www.iinteractive.com/moose/)。对于最佳实践，请遵循线程中其他地方的一些建议。这应该足以让你开始。

# haml - 程序员记事本的 Haml 和 Sass？

> ID：482234
> 
> 赞同：3
> 
> 时间：2009-01-27T03:19:36.300
> 
> 标签：haml, sass, programmers-notepad

有谁知道我在哪里可以找到一些用于程序员记事本的 Haml 和/或 Sass 的很酷的语法突出显示？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-12-16T06:16:02.173

根据[issue 224](http://code.google.com/p/pnotepad/issues/detail?id=224)，已为 HAML 和 SASS 添加了语法突出显示。

# html - Designing pages with CSS disabled

> ID：482235
> 
> 赞同：3
> 
> 时间：2009-01-27T03:19:49.983
> 
> 标签：html, css

I'm currently designing a site which uses a dark background, and just out of interest, I disabled CSS and took a look at it. Because it's been marked up semantically, without styles it's still a coherent document, except for the fact that my heading images are white, and because the default background colour is also white, you can't see the headings at all. (The headings are marked up as h1/h2/h3 and then Javascript replaces them with images).

Now I know this is a minuscule edge case of users who don't have CSS, but do have javascript, so this is a very much more theoretical rather than practical question, but should I go back to the old and outdated way of setting background colours:

```
<body bgcolor="#333333"> 
```

..so that you can still see the white images?

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-01-27T03:31:20.973

I usually insert the heading image via CSS too.

```
<h2 class="my-heading"><span class="hide">My Heading</span></h2> 
```

and then

```
.my-heading {
    width: 100px;
    height: 24px;
    display: block;
    background: #fff url(image/my-heading.jpg) top left no-repeat;
}

.hide {
    display: none;
} 
```

so that users in no-CSS environment got the text version one.

edit: Thanks for [d03boy](https://stackoverflow.com/users/20471/d03boy) for providing a better alternative to do this (text-indent: -9999px;) and [Karan Bhangui](https://stackoverflow.com/users/11110/karan-bhangui) for pointing out the missing stuff (my bad). Check comment section.

edit 2: Thanks [Traingamer](https://stackoverflow.com/users/27609/traingamer). I'll be sure to double-check next-time. ;)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-27T03:28:59.263

No, you shouldn't. Those attributes are deprecated for a reason. There are better ways to work around these sorts of problems. As others suggested, have Javascript detect if CSS is disabled so it won't make the changes in those cases.

Normal users who disable CSS expect to see things not exactly as the creator intended. To handle users who are instead using alternate browsers (such as blind users) make sure you fully and accurately populate the ALT tags of images, etc.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-27T03:31:35.060

Add some intelligence to your JS. I dont know how to do it in JS, but detect if CSS is disabled and then do something different in response. The JS is to blame for making your page unreadable, so it should have the solution. Putting the fix in a style tag just causes more complexity.

For instance, someone without CSS very well might also not support a style tag! Also, it could be a blind user with a screen reader, and them not having any text at all and an image instead is rather insulting. Better set your ALT text etc.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-27T04:29:49.187

非编码解决方案：
如何在标题图像周围添加暗边？在正常的深色背景下，标题图像/文字周围的深色边缘不会太突兀；同时，当 css 被禁用时，标题图像/文本仍然可以作为轮廓读取。

# sunspot - 你推荐使用 SunSPOT 的 TTL、SPI 还是 I2C

> ID：482237
> 
> 赞同：-1
> 
> 时间：2009-01-27T03:21:16.720
> 
> 标签：sunspot, i2c, spi, ttl

我开始尝试与一些外部组件（Skyetek M1 Mini 或 M1 RFID 扫描仪）接口，而不是支持以下协议 TTL、SPI 或 I2C。我想知道您会推荐其中哪一条路线。现场运行的应用程序需要大量的处理时间（一种持续运行的手势匹配算法）并且资源相当昂贵。

任何有关该主题的链接或来源将不胜感激。

我发现的有用链接：

时间：

*   [功能列表](https://projectsunspot.com/docs/Purple/javadoc/com/sun/spot/sensorboard/EDemoController.html)，包括用于 UART 控制的功能列表。
*   [根据这个](https://www.sunspotworld.com/forums/viewtopic.php?t=763)似乎没有很好的缓冲区控制

谢谢你的帮助。

* * *

编辑：

如果它有助于我尝试连接的设备是 Skyetek [M1](http://www.skyetek.com/ProductsServices/EmbeddedRFIDReaders/SkyeModuleM1/tabid/82/Default.aspx)和[M1 mini](http://www.skyetek.com/ProductsServices/EmbeddedRFIDReaders/SkyeModuleM1mini/tabid/338/Default.aspx)。平台/CPU 是 Sun [SunSPOT](https://www.sunspotworld.com/)。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-27T13:47:48.063

TTL是指UART（外围设备自动接收/发送串行流）还是bitbanging（手动设置/重置/切换位）？

我可能会推荐SPI。这是一个相对简单的协议，在主控端，如果必须，你可以对它进行 bit-bang。（但更容易使用内置 SPI 外设。）SPI 主机发送一条时钟线 (SCLK) 和一条数据线 (MOSI = master out slave in)，其中数据位在时钟的指定边沿有效线; 它从从机接收数据线（MISO = 主机输入从机输出），其中数据位在时钟线的指定边沿有效。如果您有多个从机，该技术通常是为每个从机设置一条芯片选择 (CS) 线；如果 CS 为低电平，则相关从机处于活动状态，否则它应该忽略时钟/数据信号并且不干扰 MISO 线。SPI 很简单，甚至可以与 HC594 或 HC595 输出寄存器一起使用（将 MOSI 连接到 SER，SCLK 连接到 SCK，CS 到 RCK）如果您的微控制器在输出端口引脚上短路并且您需要一些额外的引脚。如果您有 3 个以上的 SPI 设备，请考虑使用 HC138 作为解码器，从一组地址位和来自微处理器的主芯片选择线生成单个设备 CS 线。（因为一次应该只有一条 CS 线为低电平）

I2C 很痛苦。它的主要优点是您可以在一堆外围设备之间共享 2 线（+ 电源和接地）来完成所有操作。但是您必须处理地址争用和许多其他事情。它也比 SPI 慢，并且具有开路集电极线，因此它的功耗 + 抗噪性与您在哪里使用上拉电阻（或电流源）有关。

UART 可能是最快的解决方案。SPI 具有与往返传播时间相关的速度限制，因为双方使用相同的时钟信号。（信号路径 = 主机更改 SCLK 引脚，从机看到它并通过更改 MISO 引脚做出响应，然后主机在下一个 SCLK 边沿使用 MISO 信号，因此来自从机的信号应该已经到达）在 UART 中，输入和输出比特流是独立的，延迟并不意味着您的吞吐量会降低，除非高级协议是让 UART 端点 A 向 UART 端点 B 发送命令，等待 B 响应，然后发送下一个命令。真正快速的串行流应该考虑使用[LVDS](http://en.wikipedia.org/wiki/Low-voltage_differential_signaling)保持信号完整性。但是与 SPI 相比，解析 UART 字节有点痛苦。在 SPI 中有明显分隔的数据包，而在 UART 中，您正在处理未分隔的串行流，并且必须通过解析数据本身来完成任何数据包化。

编辑：一个 UART 的另一个优点是，有时处理器可以自动处理大的发送/接收缓冲区，这样你的程序可以排队一大堆要发送的字节，然后在你感觉的时候解析一堆接收到的字节喜欢它。硬件可以处理发送/接收每个单独字节的即时性，并使您的程序不必担心丢失在您的程序执行其他操作时到达的各个字节。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-11T18:39:03.437

杰森的回答要详细得多，但我想我会补充一下我的简短经验。

我使用了通过 TTL 连接到 BASIC Stamp 的 SkyTek M1 Micro RFID 读/写模块。我从来没有遇到过任何问题，而且设置比我选择 I2C 时要简单得多。

它只需要微控制器按照 SkyeTek 协议发送简单的串行 TTL 命令。我在我的面包板上安装并在大约 5 分钟内工作。

# asp.net-mvc - How to pass the FormCollection object for testmethod during Unit Testing

> ID：482241
> 
> 赞同：1
> 
> 时间：2009-01-27T03:23:27.497
> 
> 标签：asp.net-mvc

We are Facing an issue of passing the FormCollection while unit testing. Is there a way to simulate these FormCollection directly without having to set individual parameters. It becomes very tedious process of initializing each and every object value for huge forms. I suppose there can be a direct way of doing it. Does anyone have idea about it ?

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-27T03:53:15.283

与其重写代码来为每个单元测试填充 FormCollection，不如在测试类中创建一个方法，该方法生成一个有效的 FormCollection，您可以将其用于每个测试。您可以从此“基础”FormCollection 添加/删除/修改参数以满足每个单元测试的需要。这样，您只需编写一次大部分代码即可填充 FormCollection。

# .net - 从 .Net - Flex - FlourineFX 返回类型化的对象

> ID：482247
> 
> 赞同：0
> 
> 时间：2009-01-27T03:26:50.203
> 
> 标签：.net, apache-flex, flash, actionscript-3

有没有人有使用flourineFX的经验？我必须修复在后端使用 fluorineFX 为 flex 表示层提供类型化对象的东西。

我的印象是，如果我像这样在 Flex 中注册对象

```
registerClassAlias("Kanpeki.Domain.Staff", Staff);

[Bindable]
public class Staff implements IListable
{
    private var _id:int;
    private var _firstName:String;
    private var _lastName:String;
    private var _email:String;

  public function Staff(){}....etc 
```

如果属性及其类型与相应的 .Net 类匹配，我就不必转换对象。但是，当我将类带入 flex 时，我得到的只是通用对象。这是否意味着我必须手动转换对象？我希望这是有道理的。另外，我假设 webOrb 是相似的，所以如果有人对 flourine 或 webOrb 有任何经验并且可以给我任何指示，我将不胜感激。谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-27T14:24:30.657

当您没有在应用程序中的任何位置引用 Staff 类时，可能会出现此问题。即使您通过 registerClassAlias 或 RemoteClass 元数据添加映射，编译器也不会选择您的类，因此当对象进入时，它们将不会被正确映射。

如果您将 registerClassAlias 添加到应用程序的根目录，则始终会导致在应用程序中编译 Staff 类。

顺便说一句：要使用元数据注册别名，只需添加

```
[RemoteClass(alias="Kanpeki.Domain.Staff")] 
```

在你的类文件中。当然，同样的编译器规则也适用。在某处引用它，否则它不会被编译。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-27T08:40:43.673

如果我把它似乎工作

registerClassAlias("Kanpeki.Domain.Staff", Staff);

在应用程序的根目录中而不是类中。嗯……

# emacs - 是否有一个 Emacs 变量可以关闭具有特定扩展名的文件的备份？

> ID：482256
> 
> 赞同：5
> 
> 时间：2009-01-27T03:32:31.190
> 
> 标签：emacs, backup, elisp

例如，在编辑各种数据文件时，备份数据是没有用的，实际上会绊倒我们的工具。所以我希望能够禁用名称中包含正则表达式的文件的备份。

贾斯汀

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-01-27T03:34:43.930

我讨厌简单地参考其他在线资源来解决此类问题，但这似乎非常适合您的需求。

[http://anirudhs.chaosnet.org/blog/2005.01.21.html](http://anirudhs.chaosnet.org/blog/2005.01.21.html)

一旦您设置了该页面上描述的内容，您可以根据您的 emacs 版本将其添加到您的`.emacs`or文件中：`.emacs.d/init.el`

```
(setq auto-mode-alist (append '(("\\.ext1$" . sensitive-mode)) auto-mode-alist))
(setq auto-mode-alist (append '(("\\.ext2$" . sensitive-mode)) auto-mode-alist))
(setq auto-mode-alist (append '(("\\.ext3$" . sensitive-mode)) auto-mode-alist))
(setq auto-mode-alist (append '(("\\.ext4$" . sensitive-mode)) auto-mode-alist)) 
```

其中`\\.ext1$`,`\\.ext2$`等是与您不想备份的文件名匹配的正则表达式。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-27T14:53:53.390

如果您想使用内置的 Emacs 功能，请执行以下操作：

```
(defvar my-backup-ignore-regexps (list "foo.*" "\\.bar$")
  "*List of filename regexps to not backup")

(defun my-backup-enable-p (name)
  "Filter certain file backups"
  (when (normal-backup-enable-predicate name)
    (let ((backup t))
      (mapc (lambda (re)
              (setq backup (and backup (not (string-match re name)))))
            my-backup-ignore-regexps)
      backup)))

(setq backup-enable-predicate 'my-backup-enable-p) 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-27T12:44:06.910

您总是可以要求 emacs 将备份/自动保存文件放在您的主目录中。

[http://amitp.blogspot.com/2007/03/emacs-move-autosave-and-backup-files.html](http://amitp.blogspot.com/2007/03/emacs-move-autosave-and-backup-files.html)

```
(defvar user-temporary-file-directory
  (concat temporary-file-directory user-login-name "/"))
(make-directory user-temporary-file-directory t)
(setq backup-by-copying t)
(setq backup-directory-alist
      `(("." . ,user-temporary-file-directory)
        (,tramp-file-name-regexp nil)))
(setq auto-save-list-file-prefix
      (concat user-temporary-file-directory ".auto-saves-"))
(setq auto-save-file-name-transforms
      `((".*" ,user-temporary-file-directory t))) 
```

# javascript - 是否有一些 dojo.fx.sleep 函数可以在 dojo.fx.chain 动画中使用？

> ID：482260
> 
> 赞同：1
> 
> 时间：2009-01-27T03:33:51.407
> 
> 标签：javascript, animation, dojo, sleep, method-chaining

我想`fadeIn`超过一秒钟的节点。然后让它保持 10 秒钟。然后再`fadeOut`持续 3 秒。一种链接方式如下：

```
dojo.fx.chain([
   dojo.fadeIn({node:myNode, duration:1000}), // fading in for 1 second
   dojo.fadeIn({node:myNode, duration:10000}), // this does nothing for 10 seconds
   dojo.fadeOut({node:myNode, duration:3000}) // fade out for 3 seconds
]).play(); 
```

在前面的代码中，中间步骤是一种非常愚蠢的一事无成的方法。是否有某种`dojo.fx.sleep`动画在指定的时间内什么都不做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-27T03:56:24.603

肯定的，目前还没有；实现该效果的唯一方法是将代码拆分为 pre-sleep 和 post-sleep 部分，您在这里已经完成了很多工作。我唯一推荐的是让 Dojo 在 1o,ooo-millisecond 持续时间内尽可能少做；正如您现在所拥有的那样，正在调用**fadeIn()**方法，虽然可能可以忽略不计，但它正在运行至少一个条件语句（以检查它是否需要修改 opacity 属性），这绝对是一个比让脚本什么都不做要慢一点。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-30T21:36:59.497

我不是 dojo 用户，但 JQuery 和 Prototype 的常见习语是 delay 属性，它似乎也存在于 Dojo 中：

```
dojo.addOnLoad(function() { 
  var animationArguments = {
    node: “testHeading”,
    duration: 1000,       // ms to run animation
    delay: 250            // ms to stall before playing
  };

  dojo.fadeOut(animationArguments).play();
}); 
```

# python - 初学者级别的 Python 线程问题

> ID：482263
> 
> 赞同：7
> 
> 时间：2009-01-27T03:38:45.467
> 
> 标签：python, multithreading, pygtk

作为 Python（使用 pyGTK）中 GUI 开发的新手，我刚刚开始学习线程。为了测试我的技能，我编写了一个简单的带有开始/停止按钮的小 GTK 界面。目标是当它被点击时，一个线程启动，在文本框中快速增加一个数字，同时保持 GUI 响应。

我的 GUI 工作得很好，但是线程有问题。这可能是一个简单的问题，但我的脑子里全是煎熬。下面我首先粘贴了 Python 解释器的引用，然后是代码。你可以去[http://drop.io/pxgr5id](http://drop.io/pxgr5id)下载。我正在使用 bzr 进行修订控制，因此如果您想进行修改并重新删除它，请提交更改。我还将代码粘贴在[http://dpaste.com/113388/](http://dpaste.com/113388/)因为它可以有行号，而这个降价的东西让我很头疼。

更新 1 月 27 日，美国东部标准时间 15:52：稍微更新的代码可以在这里找到：http: [//drop.io/threagui/asset/thread-gui-rev3-tar-gz](http://drop.io/threagui/asset/thread-gui-rev3-tar-gz)

**追溯**

```
crashsystems@crashsystems-laptop:~/Desktop/thread-gui$ python threadgui.pybtnStartStop clicked
Traceback (most recent call last):
  File "threadgui.py", line 39, in on_btnStartStop_clicked
    self.thread.stop()
  File "threadgui.py", line 20, in stop
    self.join()
  File "/usr/lib/python2.5/threading.py", line 583, in join
    raise RuntimeError("cannot join thread before it is started")
RuntimeError: cannot join thread before it is started
btnStartStop clicked
threadStop = 1
btnStartStop clicked
threadStop = 0
btnStartStop clicked
Traceback (most recent call last):
  File "threadgui.py", line 36, in on_btnStartStop_clicked
    self.thread.start()
  File "/usr/lib/python2.5/threading.py", line 434, in start
    raise RuntimeError("thread already started")
RuntimeError: thread already started
btnExit clicked
exit() called 
```

**代码**

```
#!/usr/bin/bash
import gtk, threading

class ThreadLooper (threading.Thread):
    def __init__ (self, sleep_interval, function, args=[], kwargs={}):
        threading.Thread.__init__(self)
        self.sleep_interval = sleep_interval
        self.function = function
        self.args = args
        self.kwargs = kwargs
        self.finished = threading.Event()

    def stop (self):
        self.finished.set()
        self.join()

    def run (self):
        while not self.finished.isSet():
            self.finished.wait(self.sleep_interval)
            self.function(*self.args, **self.kwargs)

class ThreadGUI:
    # Define signals
    def on_btnStartStop_clicked(self, widget, data=None):
        print "btnStartStop clicked"
        if(self.threadStop == 0):
            self.threadStop = 1
            self.thread.start()
        else:
            self.threadStop = 0
            self.thread.stop()
        print "threadStop = " + str(self.threadStop)

    def on_btnMessageBox_clicked(self, widget, data=None):
        print "btnMessageBox clicked"
        self.lblMessage.set_text("This is a message!")
        self.msgBox.show()

    def on_btnExit_clicked(self, widget, data=None):
        print "btnExit clicked"
        self.exit()

    def on_btnOk_clicked(self, widget, data=None):
        print "btnOk clicked"
        self.msgBox.hide()

    def on_mainWindow_destroy(self, widget, data=None):
        print "mainWindow destroyed!"
        self.exit()

    def exit(self):
        print "exit() called"
        self.threadStop = 1
        gtk.main_quit()

    def threadLoop(self):
        # This will run in a thread
        self.txtThreadView.set_text(str(self.threadCount))
        print "hello world"
        self.threadCount += 1

    def __init__(self):
        # Connect to the xml GUI file
        builder = gtk.Builder()
        builder.add_from_file("threadgui.xml")

        # Connect to GUI widgets
        self.mainWindow = builder.get_object("mainWindow")

        self.txtThreadView = builder.get_object("txtThreadView")
        self.btnStartStop = builder.get_object("btnStartStop")
        self.msgBox = builder.get_object("msgBox")
        self.btnMessageBox = builder.get_object("btnMessageBox")
        self.btnExit = builder.get_object("btnExit")
        self.lblMessage  = builder.get_object("lblMessage")
        self.btnOk = builder.get_object("btnOk")

        # Connect the signals
        builder.connect_signals(self)

        # This global will be used for signaling the thread to stop.
        self.threadStop = 1

        # The thread
        self.thread = ThreadLooper(0.1, self.threadLoop, (1,0,-1))
        self.threadCounter = 0

if __name__ == "__main__":
    # Start GUI instance
    GUI = ThreadGUI()
    GUI.mainWindow.show()
    gtk.main() 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-01-28T10:13:37.540

如果你想做对的话，使用 PyGTK 线程化有点棘手。基本上，您不应该从除主线程之外的任何其他线程中更新 GUI（GUI 库中的常见限制）。通常这是在 PyGTK 中使用队列消息机制（用于工作人员和 GUI 之间的通信）完成的，这些消息使用超时功能定期读取。一旦我在本地 LUG 上就该主题进行了演示，您就可以从[Google 代码存储库](http://code.google.com/p/leechfm/)中获取此演示的示例代码。看看`MainWindow`class in `forms/frmmain.py`，特别是方法`_pulse()`和做了什么`on_entry_activate()`（线程在那里启动加上空闲计时器被创建）。

```
def on_entry_activate(self, entry):
    text = entry.get_text().strip()
    if text:
        store = entry.get_completion().get_model()
        if text not in [row[0] for row in store]:
            store.append((text, ))
        thread = threads.RecommendationsFetcher(text, self.queue)# <- 1
        self.idle_timer = gobject.idle_add(self._pulse)# <- 2
        tv_results = self.widgets.get_widget('tv_results')
        model = tv_results.get_model()
        model.clear()
        thread.setDaemon(True)# <- 3
        progress_update = self.widgets.get_widget('progress_update')
        progress_update.show()
        thread.start()# <- 4 
```

这样，应用程序在“空闲”（通过 GTK 表示）时更新 GUI，不会导致冻结。

*   1：创建线程
*   2：创建空闲定时器
*   3：守护线程，因此应用程序可以在不等待线程完成的情况下关闭
*   4：启动线程

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-27T05:10:24.907

通常，最好尽可能避免使用线程。正确编写线程应用程序非常困难，更难知道自己是否正确。由于您正在编写一个 GUI 应用程序，因此您可以更轻松地可视化如何执行此操作，因为您已经必须在异步框架中编写应用程序。

需要意识到的重要一点是，GUI 应用程序实际上什么也没做。它大部分时间都在等待操作系统告诉它发生了什么事。只要你知道如何编写长时间运行的代码，你就可以在这段空闲时间做很多事情，这样它就不会阻塞。

您可以通过使用超时来解决您原来的问题；告诉您的 GUI 框架在延迟后回调某个函数，然后重置该延迟或启动另一个延迟调用。

另一个常见问题是如何在 GUI 应用程序中通过网络进行通信。网络应用程序就像 GUI 应用程序一样，它们会进行大量等待。使用网络 IO 框架（如[Twisted](http://twistedmatrix.com/)）可以很容易地让应用程序的两个部分合作等待而不是竞争，并再次减少对额外线程的需求。

长时间运行的计算可以迭代而不是同步编写，您可以在 GUI 空闲时进行处理。你可以在 python 中使用生成器很容易地做到这一点。

```
def long_calculation(param, callback):
    result = None
    while True:
        result = calculate_next_part(param, result)
        if calculation_is_done(result):
            break
        else:
            yield
    callback(result) 
```

调用`long_calculation`会给你一个生成器对象，调用`.next()`生成器对象将运行生成器，直到它到达`yield`or `return`。您只需告诉 GUI 框架`long_calculation(some_param, some_callback).next`在有时间时调用，最终将使用结果调用您的回调。

我不太了解 GTK，所以我不能告诉你应该调用哪些 gobject 函数。但是，有了这个解释，您应该能够在文档中找到必要的功能，或者在最坏的情况下，在相关的 IRC 频道上询问。

不幸的是，没有好的一般情况答案。如果您明确说明您要做什么，那么解释为什么在这种情况下不需要线程会更容易。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-27T06:24:06.617

您无法重新启动已停止的线程对象；不要尝试。相反，如果要在对象真正停止并加入后重新启动它，请创建对象的新实例。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-29T14:28:03.107

我使用过不同的工具来帮助清理线程、空闲处理等工作。

make_idle 是一个函数装饰器，允许您在后台协同运行任务。这是一个很好的中间地带，介于足够短以在 UI 线程中运行一次且不影响应用程序的响应能力和在特殊同步中执行完整线程之间。在装饰函数内部，您使用“yield”将处理交还给 GUI，以便它可以保持响应，并且下次 UI 空闲时，它将在您停止的函数中继续。所以要开始这个，你只需调用 idle_add 到装饰函数。

```
def make_idler(func):
    """
    Decorator that makes a generator-function into a function that will
continue execution on next call
    """
    a = []

    @functools.wraps(func)
    def decorated_func(*args, **kwds):
        if not a:
            a.append(func(*args, **kwds))
        try:
            a[0].next()
            return True
        except StopIteration:
            del a[:]
            return False

    return decorated_func 
```

如果您需要进行更多处理，可以在需要时使用上下文管理器锁定 UI 线程，以帮助使代码更安全

```
@contextlib.contextmanager
def gtk_critical_section():
    gtk.gdk.threads_enter()
    try:
        yield
    finally:
        gtk.gdk.threads_leave() 
```

这样你就可以

```
with gtk_critical_section():
    ... processing ... 
```

我还没有完成它，但是结合纯粹在空闲和纯粹在线程中做的事情，我有一个装饰器（尚未测试，所以没有发布），你可以告诉它是否要运行 yield 之后的下一部分在 UI 的空闲时间或线程中。这将允许在 UI 线程中进行一些设置，切换到一个新线程来执行后台操作，然后切换到 UI 的空闲时间进行清理，从而最大限度地减少对锁的需求。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-02T17:18:43.573

我没有详细查看您的代码。但我看到您的问题有两种解决方案：

根本不要使用线程。而是使用超时，如下所示：

```
import gobject

i = 0
def do_print():
    global i
    print i
    i += 1
    if i == 10:
        main_loop.quit()
        return False
    return True

main_loop = gobject.MainLoop()
gobject.timeout_add(250, do_print)
main_loop.run() 
```

使用线程时，您必须确保您的 GUI 代码只能同时从一个线程调用，方法是像这样保护它：

```
import threading
import time

import gobject
import gtk

gtk.gdk.threads_init()

def run_thread():
    for i in xrange(10):
        time.sleep(0.25)
        gtk.gdk.threads_enter()
        # update the view here
        gtk.gdk.threads_leave()
    gtk.gdk.threads_enter()
    main_loop.quit()
    gtk.gdk.threads_leave()

t = threading.Thread(target=run_thread)
t.start()
main_loop = gobject.MainLoop()
main_loop.run() 
```

# iphone - 如何将 TabBar 添加到基于 NavigationController 的 iPhone 应用程序

> ID：482270
> 
> 赞同：11
> 
> 时间：2009-01-27T03:47:49.333
> 
> 标签：iphone, cocoa-touch

我有一个简单的基于 NavigationController 的应用程序。主窗口显示一个 TableView 并选择一个项目加载一个子视图。我将 Interface Builder 用于 UI 视图。

现在我想在应用程序中添加一个 TabBar。我把它放在哪里？我需要一个 TabBarController 吗？它应该放在 MainWindow.xib 还是 RootViewController.xib 中？

如何将它与我的 NavigationController 绑定在一起？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2010-06-13T06:50:01.477

这个问题的*最终*答案在 iPhone 的*View Controller Programming Guide*中的 iPhone SDK 文档中给出。

[视图控制器编程指南：组合视图控制器](http://developer.apple.com/iphone/library/featuredarticles/ViewControllerPGforiPhoneOS/CombiningViewControllers/CombiningViewControllers.html#//apple_ref/doc/uid/TP40007457-CH104-SW2 "视图控制器编程指南：组合视图控制器")

此链接直接进入该部分，并讨论了创建基于导航和标签栏的界面的正确方法。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-29T20:09:11.657

我在我的几个应用程序中执行此操作。将标签栏添加到基于 navigationController 的应用程序的技巧是不使用 TabBarController。将标签栏添加到视图，使该视图的视图控制器成为 TabBarDelegate，并在视图控制器的代码中响应用户在标签栏上的选择。

我使用选项卡栏将其他视图添加到选项卡栏的视图作为子视图，重新加载具有不同数据集的表格视图，重新加载 UIPickerView 等。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-27T04:59:03.653

简单的答案是让它成为一个加载导航控制器的标签栏应用程序。

标签栏将是您的最高级别组件，然后您可以为每个标签加载导航控制器。从那里它应该是相当标准的东西。不久前，我不得不以艰难的方式学习这一点。

您可以从 XCode 中的基本选项卡栏应用程序模板开始，它应该设置一个带有 2 个简单视图的基本选项卡栏。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-16T01:50:56.513

您可以使用 Interface Builder 编辑 MainWindow.xib，并将标签栏控制器添加到您的导航控制器。您还可以使用 IB 的 Inspector 窗口将 UITabBarController 的视图控制器更改为 View/Navigation/Table View/Image Picker Controllers。它会起作用的。

但是，我真的不建议将 Tab Bar Controller 放入 Navigation Controller 中。如果你走得更远（让它更复杂），这些控制器之间的关系会变得混乱。

假设您的标签栏控制器中有表视图控制器，并且想要调出详细视图。按照设计，您可能希望告诉导航控制器将视图推送到堆栈中，但这样做会使详细视图与您的选项卡栏控制器（都在导航控制器下）和表视图控制器保持相同的级别作为详细视图的父级。这很奇怪，至少对我来说......

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-01-27T04:30:54.973

查看 UICatalog 示例代码。它有很多很棒的东西，包括从一个视图到下一个视图的转换。

在您的情况下，您需要使用 UITableView 委托方法

```
- (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath 
```

在该方法中，您将创建并显示您的选项卡视图控制器。这可能是一个带有关联 Nib 的自定义控制器，或者您可以根据您的情况在代码中创建整个东西。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-01-27T06:16:28.770

尽可能在选项卡式应用程序中嵌入导航栏是一个更好的主意。以另一种方式做会产生一些复杂性，用 IB 做起来很困难，并且会带来很多麻烦。

# design-patterns - DataAdapter 使用外观模式还是适配器模式。

> ID：482271
> 
> 赞同：2
> 
> 时间：2009-01-27T03:48:46.913
> 
> 标签：design-patterns, dataadapter, facade

当我看到对象`Update()`的`Fill()`方法时`DataAdapter`，我总是想是否`DataAdapter`使用Facade Pattern？

看起来它会在幕后为我们创建`Command`对象、`Connection`对象并执行它。

或者`DataAdapter`使用适配器模式，因为它是`Dataset`和`Command`对象之间的适配器，连接对象？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-27T05:14:27.350

并非一切都是 GoF 设计模式。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-27T03:52:05.317

我想你也许可以把它想象成 Repository 模式，只是它专注于数据连接。它不是真正的适配器，因为它不促进命令和数据集之间的通信机制 - 它实际上为自己的目的操作和创建自己的命令。

# php - 制作服务器本地副本的 PHP 错误

> ID：482273
> 
> 赞同：0
> 
> 时间：2009-01-27T03:52:52.817
> 
> 标签：php, path, echo

我有一个站点，我正在尝试创建一个本地副本以用于测试目的（清除过去的站点）。我能够正确地取出数据库，并且大多数站点都运行良好。但是，我有些地方加载不正确，只是在花括号中给我错误或消息。

例如，一个 td 类的名称被替换为 {BOX_HEADER} 或在另一个页面上而不是 Flash 加载它只是在 Flash 应该在的位置显示 {PAGE}。有没有人见过这样的错误？

我在想这可能是 PATH/echo 错误，但我正在查看是否有人以前遇到过这样的问题。

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-27T04:11:38.117

很有可能你有一些硬编码的路径（也许还有 URL）。当您复制站点时，您的 docroot / home 目录发生了变化。所以，如果你有 /home/elmer/public_html/site ，你可能需要改变它。

在所有子文件夹（尤其是模板解析器所在的位置）中查找 error_log 文件，您应该能够很快将其根除。如果除了数据库配置之外的所有配置都存储在数据库中，那是首先要检查的地方。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2009-01-27T04:05:54.883

听起来您的模板解决方案无法正常工作。从表面上看，这很难诊断，因为这些不是典型的 php 错误。您可能需要进行一些挖掘或提供更多信息，例如您正在使用的模板引擎。

# iphone - 如何测试 NSString 是否为零？

> ID：482276
> 
> 赞同：4
> 
> 时间：2009-01-27T03:54:35.390
> 
> 标签：iphone, objective-c, string, null

我可以简单地使用

```
if(myString == nil) 
```

出于某种原因，我知道为空的字符串未通过此语句。

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2009-01-27T04:12:09.393

是否有可能您的字符串实际上`nil`不是，而只是一个空字符串？您可以尝试测试是否`[myString length] == 0`.

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2011-11-05T11:20:09.953

您可以[在此处找到有关目标 C 字符串的更多信息。](http://i-phone-dev.blogspot.com/2011/11/iphone-nsstring-operations.html)

```
+ (BOOL ) stringIsEmpty:(NSString *) aString {

    if ((NSNull *) aString == [NSNull null]) {
        return YES;
    }

    if (aString == nil) {
        return YES;
    } else if ([aString length] == 0) {
        return YES;
    } else {
        aString = [aString stringByTrimmingCharactersInSet: [NSCharacterSet whitespaceAndNewlineCharacterSet]];
        if ([aString length] == 0) {
            return YES;
        }
    }

    return NO;  
}

+ (BOOL ) stringIsEmpty:(NSString *) aString shouldCleanWhiteSpace:(BOOL)cleanWhileSpace {

    if ((NSNull *) aString == [NSNull null]) {
        return YES;
    }

    if (aString == nil) {
        return YES;
    } else if ([aString length] == 0) {
        return YES;
    } 

    if (cleanWhileSpace) {
        aString = [aString stringByTrimmingCharactersInSet: [NSCharacterSet whitespaceAndNewlineCharacterSet]];
        if ([aString length] == 0) {
            return YES;
        }
    }

    return NO;  
} 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2012-03-27T11:02:52.753

您可以使用此检查您的获取字符串

```
 if(myString==(id) [NSNull null] || [myString length]==0 || [myString isEqualToString:@""])
    {
     //String is null or bad response
    } 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-01-27T15:26:59.283

调试器中的字符串似乎报告为（null），但这是由于它的分配方式，我修复了它，现在它报告为 nil。这解决了我的问题。

谢谢！

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2011-01-10T04:58:10.127

注意 length = 0 并不一定意味着它是 nil

```
NSString *test1 = @"";
NSString *test2 = nil; 
```

它们是不相同的。虽然两个长度都是0。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2018-04-23T18:13:37.300

您可以使用以下命令隐式检查`nil`（已分配，但未初始化）：

```
if (!myString) { 
    //do something
} 
```

如果`myString`是从字典或数组中分配的，您可能还希望`NSNULL`像这样检查：

```
if ([myString isEqual:[NSNull null]]) {
    //do something
} 
```

最后（正如 Sophie Alpert 提到的），您可以检查空字符串（空值）：

```
if ([myString length] == 0) {
    //do something
} 
```

通常，您可能希望合并表达式：

```
if (!myString || [myString length] == 0) {
    //do something
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2014-11-22T19:00:37.337

我今天遇到了这个问题。尽管将字符串分配为 nil: `NSString *str = nil;`，但测试`if (str == nil)`返回了`FALSE`！但是，将测试更改为`if (!str)`有效。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2018-11-29T05:45:43.060

**检查 NSAttributedString 是否为空：**

```
let isEmpty = atrributedString.string.isEmpty 
```

# geometry - 凸包的测试用例数据

> ID：482278
> 
> 赞同：6
> 
> 时间：2009-01-27T03:56:08.333
> 
> 标签：geometry, testcase, convex-hull

我需要为类分配制作一个 2D 凸包函数，并且我想要一个比分配提供的更强大的测试用例。有没有人知道解决方案的大型测试用例（25 < n < 100）？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2010-11-18T20:42:23.967

这里还有一些测试数据：

下面是一些测试数据：

* * *

测试 1

8 7 7 7 -7 -7 -7 -7 7 9 0 -9 0 0 9 0 -9

测试 2

16 7 7 7 -7 -7 -7 -7 7 9 0 -9 0 0 9 0 -9 0 0 1 2 -2 1 -1 -1 3 4 4 3 -5 4 6 5

测试 3

72 0 0 1 2 -2 1 -1 -1 3 4 4 3 -5 4 6 5 7 7 7 -7 -7 -7 -7 7 9 0 -9 0 0 9 0 -9 -8 0 8 0 -7 0 7 0 -6 0 6 0 -5 0 5 0 -4 0 4 0 -3 0 3 0 -2 0 2 0 -1 0 1 0 0 -8 0 8 0 -7 0 7 0 -6 0 6 0 - 5 0 5 0 -4 0 4 0 -3 0 3 0 -2 0 2 0 -1 0 1 1 1 2 2 3 3 4 4 5 5 6 6 1 -1 2 -2 3 -3 4 -4 5 -5 6 -6 -1 1 -2 2 -3 3 -4 4 -5 5 -6 6 -1 -1 -2 -2 -3 -3 -4 -4 -5 -5 -6 -6

所有答案都相同： 8 (0, -9) (7, -7) (9, 0) (7, 7) (0, 9) (-7, 7) (-9, 0) (-7, -7)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-27T04:06:13.557

Qhull包，包括,和应该可以[解决](http://www.qhull.org/)问题（我自己也将它们用于此目的）。例如，[qconvex](http://www.qhull.org/html/qconvex.htm)示例页面提供以下内容（针对更大的测试用例进行了调整）：`qhull``qconvex``rbox`

```
rbox 100 D3 | qconvex s o TO result 
```

以上计算了 100 个随机点的 3-d 凸包，将摘要写入控制台，并将点和面写入“结果”。

这是一个用于查找 40 个点的 3-d 凸包的示例测试用例。要点是：

```
0.3215426810286406 0.1678336189760208 -0.2203710966001927 
0.2229772524190855 -0.4213242506806965 -0.1966818060695024 
0.3688830163971363 -0.1831502133823468 -0.2056387967482571 
-0.1712592515826777 -0.3542439228428937 0.2223876390814666 
-0.3309556113844324 -0.370961861099081 0.2439994981922204  
-0.1004397059794885 -0.09014152417903909 -0.008600084584765189 
0.458374538420117 -0.09914027349943322 -0.2505798421339875     
-0.4954086979808367 -0.3339869997780649 -0.3195065691317492    
0.053091190339151 0.3036317017894533 0.1380056861210668
0.4615616439483703 0.4665423151725366 0.1766835406205464
-0.4797380864431505 0.0419809916447671 -0.4254776681079321
-0.003168473023146823 -0.2525299883005488 -0.27151530400991
-0.3577162826971303 -0.1375644040643837 -0.04494194644032229
-0.3392973838740004 0.4288679723896719 -0.01599531622230571
0.1667164640191164 0.003605551555385444 -0.4014989499947977
0.00714666676441833 0.1140243407469469 0.407090128778564
-0.03621271768232132 0.3728502838619522 0.4947140370446388
-0.3411871756810576 -0.3328629143842151 -0.4270033635450559
0.3544683273457627 -0.450828987127942 -0.0827870439577727
-0.4018510635028137 0.08917494033386464 -0.2367824197158054
0.3978697768392692 -0.002667689232777493 0.1641431727112673
-0.245701439441835 0.495905311308713 -0.3194406286994373
0.161352035739787 -0.1563404972258401 0.3852604361113724
0.07214279572678994 -0.4960366976410492 0.1112227161519441
0.3201855824516951 0.359077846965825 0.02136723140381946
0.1190541238701475 -0.05734495917087884 0.2032677509852384
0.3210853052521919 0.4807189479290684 0.4433501688235907
0.3862800354941562 0.2085496142586224 0.09336129957191763
0.1233572616459404 0.265491605052251 0.117400122450106
0.1438531872293476 -0.2594872752758556 -0.2026374435076839
0.2724846394476338 -0.3506708492996831 0.2750346518820475
-0.4926118841325975 -0.3279366743079728 0.3683135596740186
0.2459906458351674 0.3647787136629026 -0.1641662355178652
-0.141922976953837 -0.2994764654892278 -0.3009570467294725
-0.1850859398814719 0.2606059478228967 0.004159106876849283
-0.09789466634196664 -0.3156603563722785 -0.303610991503681
0.2100642609503719 -0.4499717643018549 0.3245569875692548
-0.1707163766685095 -0.2301452446078371 -0.05112823569320907
-0.312260808713977 -0.1674135249735914 0.2808831662692904
-0.1966306233747216 0.2291105671125563 -0.3387042454804333 
```

凸包由以下几点组成：

```
0.3215426810286406 0.1678336189760208 -0.2203710966001927 
0.2229772524190855 -0.4213242506806965 -0.1966818060695024 
0.458374538420117 -0.09914027349943322 -0.2505798421339875 
-0.4954086979808367 -0.3339869997780649 -0.3195065691317492 
0.4615616439483703 0.4665423151725366 0.1766835406205464 
-0.4797380864431505 0.0419809916447671 -0.4254776681079321 
-0.3392973838740004 0.4288679723896719 -0.01599531622230571 
0.1667164640191164 0.003605551555385444 -0.4014989499947977 
-0.03621271768232132 0.3728502838619522 0.4947140370446388 
-0.3411871756810576 -0.3328629143842151 -0.4270033635450559 
0.3544683273457627 -0.450828987127942 -0.0827870439577727 
0.3978697768392692 -0.002667689232777493 0.1641431727112673 
-0.245701439441835 0.495905311308713 -0.3194406286994373 
0.161352035739787 -0.1563404972258401 0.3852604361113724 
0.07214279572678994 -0.4960366976410492 0.1112227161519441 
0.3210853052521919 0.4807189479290684 0.4433501688235907 
0.2724846394476338 -0.3506708492996831 0.2750346518820475 
-0.4926118841325975 -0.3279366743079728 0.3683135596740186 
0.2459906458351674 0.3647787136629026 -0.1641662355178652 
0.2100642609503719 -0.4499717643018549 0.3245569875692548 
```

这是一个 2D 测试用例。要点：

```
0.3215348546593775 0.03629583077160248 
0.02402358131857918 -0.2356728797179394 
0.04590851212470659 -0.4156409924995536 
0.3218384001607433 0.1379850698988746   
0.11506479756447 -0.1059521474930943    
0.2622539999543261 -0.29702873322836    
-0.161920957418085 -0.4055339716426413  
0.1905378631228002 0.3698601009043493   
0.2387090918968516 -0.01629827079949742
0.07495888748668034 -0.1659825110491202
0.3319341836794598 -0.1821814101954749
0.07703635755650362 -0.2499430638271785
0.2069242999022122 -0.2232970760420869
0.04604079532068295 -0.1923573186549892
0.05054295812784038 0.4754929463150845
-0.3900589168910486 0.2797829520700341
0.3120693385713448 -0.0506329867529059
0.01138812723698857 0.4002504701728471
0.009645149586391732 0.1060251100976254
-0.03597933197019559 0.2953639456959105
0.1818290866742182 0.001454397571696298
0.444056063372694 0.2502497166863175
-0.05301752458607545 -0.06553921621808712
0.4823896228171788 -0.4776170002088109
-0.3089226845734964 -0.06356112199235814
-0.271780741188471 0.1810810595574612
0.4293626522918815 0.2980897964891882
-0.004796652127799228 0.382663812844701
0.430695573269106 -0.2995073500084759
0.1799668387323309 -0.2973467472915973
0.4932166845474547 0.4928094162538735
-0.3521487911717489 0.4352656197131292
-0.4907368011686362 0.1865826865533206
-0.1047924716070224 -0.247073392148198
0.4374961861758457 -0.001606279519951237
0.003256207800708899 -0.2729194320486108
0.04310378203457577 0.4452604050238248
0.4916198379282093 -0.345391701297268
0.001675087028811806 0.1531837672490476
-0.4404289572876217 -0.2894855991839297 
```

船体：

```
-0.161920957418085 -0.4055339716426413 
0.05054295812784038 0.4754929463150845 
0.4823896228171788 -0.4776170002088109 
0.4932166845474547 0.4928094162538735 
-0.3521487911717489 0.4352656197131292 
-0.4907368011686362 0.1865826865533206 
0.4916198379282093 -0.345391701297268 
-0.4404289572876217 -0.2894855991839297 
```

# c# - 在 C# 中如何使用 XMLTextReader 快速显示 1GB XML 数据...？

> ID：482283
> 
> 赞同：-5
> 
> 时间：2009-01-27T04:01:45.123
> 
> 标签：c#

我有一个 1 GB 的 XML 文件。通过使用 XMLTextReader 如何快速显示此文件的总数据。您的建议很有价值

谢谢，西瓦拉姆

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-27T04:13:53.570

1GB。XML 文件。这两件事不应该出现在同一个句子中，但如果它们出现，请意识到：并非 System.XML 中的所有类都会喜欢这个文档。想象一下 CPU 达到 100% 并且 RAM 已用尽。考虑使用 XmlReader 的自定义解决方案：

[http://www.codeproject.com/KB/XML/XmlParsing.aspx](http://www.codeproject.com/KB/XML/XmlParsing.aspx)

# ruby - 如何在 Ruby 套接字中发送 NULL？

> ID：482300
> 
> 赞同：3
> 
> 时间：2009-01-27T04:14:03.103
> 
> 标签：ruby, sockets, null

我正在开发 Ruby Shoes 中的套接字应用程序，并希望向服务器发送消息。服务器需要 XML 消息，然后是空 (0) 字符。

如何在 Ruby 的 TCP 套接字中发送它？

谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-27T05:15:25.913

我找到了自己的答案...问题不是发送 NULL，而是线程问题。

您可以将 NULL 作为字符串的一部分发送，只需将其连接到字符串的末尾...

NULL = "\000"

... tc = tc + "</endtag>"

tc = tc + NULL

Socket.send(tc, 0)

# java - Ant 找不到外部定义的 taskdef 所需的类

> ID：482303
> 
> 赞同：15
> 
> 时间：2009-01-27T04:20:56.693
> 
> 标签：java, ant, classpath, axis

我正在尝试使用 axis-java2wsdl ant 任务从我的一个 java 类创建一个 wsdl，但我无法正确获取类路径。

我正在使用 Ubuntu 的 libaxis-java 包，它将axis-ant.jar 安装在$ANT_HOME/lib 中，将axis.jar 安装在/usr/share/java 中。我的 build.xml 中有趣的部分如下所示：

```
<property name="library.dir" value="lib"/>
<property name="system.library.dir" value="/usr/share/java"/>
<path id="libraries">
    <fileset dir="${library.dir}">
        <include name="*.jar"/>
    </fileset>
    <fileset dir="${system.library.dir}">
        <include name="*.jar"/>
    </fileset>
</path>

<target name="genwsdl" depends="compile">
    <taskdef resource="axis-tasks.properties" classpathref="libraries"/>
    <axis-java2wsdl>
            details omitted
    </axis-java2wsdl>
</target> 
```

运行`ant genwsdl`结果：

```
/build.xml:50: taskdef A class needed by class
org.apache.axis.tools.ant.wsdl.Wsdl2javaAntTask
cannot be found: org/apache/axis/utils/DefaultAuthenticator 
```

Ant 能够找到axis-java2wsdl 任务的定义，因为axis-ant.jar 位于$ANT_HOME/lib 中，但它无法在axis.jar 中找到类，即使该jar 位于“库”定义的路径上

我知道这是一个类路径问题，因为通过将axis.jar 符号链接到$ANT_HOME/lib 中，我能够通过DefaultAuthenticator 到其他未找到的类。如何在不将所有内容符号链接到 $ANT_HOME/lib 的情况下让 taskdef 识别 /usr/share/lib 或我项目的本地 lib 目录中的 jar 文件？

编辑：

我终于能够用这一行成功生成 wsdl：

```
ant -lib /usr/share/java/axis.jar -lib /usr/share/java/jaxrpc.jar -lib /usr/share/java/wsdl4j.jar -lib /usr/share/java/commons-logging.jar -lib /usr/share/java/commons-discovery.jar -lib build genwsdl 
```

如果有人能告诉我无法在 build.xml 中定义这些库，我仍然会非常感激

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-01-27T06:58:13.630

一般来说，这是可行的。但是您需要非常仔细地检查哪些类在哪里。

**如果您的任务类可以在类加载器层次结构中更高的类加载器中加载（如 CLASSPATH 或 ANT_HOME/lib），那么您的 classpathref 将简单地被忽略**。

阅读[常见问题解答条目](http://ant.apache.org/faq.html#delegating-classloader)以获取更多详细信息。

> Ant 的类加载器实现使用[Java 的委托模型](http://java.sun.com/products/jdk/1.2/docs/api/java/lang/ClassLoader.html)
> 
> ClassLoader 类使用委托模型来搜索类和资源。ClassLoader 的每个实例都有一个关联的父类加载器。当调用来查找类或资源时，ClassLoader 实例将在尝试查找类或资源本身之前将对该类或资源的搜索委托给其父类加载器。虚拟机的内置类加载器称为引导类加载器，它本身没有父级，但可以作为 ClassLoader 实例的父级。

注意：跑步`ant -diagnostics` [也有帮助](http://www.nabble.com/Ant-Diagnostic-td17856450.html)。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-27T05:05:36.027

Ant添加库的[机制](http://ant.apache.org/manual/using.html#external-tasks)是：

*   通过命令行参数 -lib
*   添加到 ${user.home}/.ant/lib
*   添加到 ${ant.home}/lib

仅有的。该[手册](http://ant.apache.org/manual)没有提及有关使用*system.library.dir*属性的任何内容。为此目的，它可能几乎被忽略了。

此外，以详细模式（和 -verbose）运行 ant 以查看幕后操作。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-27T17:12:37.027

为什么不采用最简单的选项并在您的`<taskdef>`?

```
<taskdef resource="axis-tasks.properties">
    <classpath>
        <fileset file="/path/to/axis/jars"/>
    </classpath>
</taskdef> 
```

或者创建一个`<classpath>`子集的第二个条目`library.dir`？

```
<path id="axis-tools-classpath">
    <fileset dir="/path/to/axis/home">
        <include name="*.jar"/>
    </fileset>
    <path refid="library.dir"/>
</path> 
```

乱搞`${ant.home}/lib`不是一个好主意，几乎总是可以避免的。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-09-27T12:09:47.170

正如*matt b*所提到的，我可以直接在 taskdef 任务中指定类路径。对于我的项目，我发现在项目文件夹中包含 taskdef 库并在 ant 构建文件中指定类路径很有用，以便在其他开发 PC 上简单地设置。我使用以下任务定义：

```
<taskdef resource="antenna.properties" classpath="${myprojectroot}/lib/antenna-bin-1.2.1-beta.jar"/> 
```

请注意，这可能不适用于 1.7.0 之前的 ant 版本。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-12-07T13:33:50.047

使用此处的答案和所有部分信息，我想出了一个解决方案。我将 jar 所需的 ant 文件添加到项目中的 lib 文件夹（特别是 mysql jdbc 驱动程序）。然后我在 ant 中运行一个设置任务，该任务复制到用户的主 .ant/lib 文件夹，然后让 ant 失败并显示一条消息以重新启动。它只对用户失败一次，然后每次都有效。如果将 jar 更新到新版本可能会很棘手......

这是蚂蚁 build.xml：

```
<project name="data_source" default="build">

  <!-- BUILD PROPERTIES -->
  <property file="build.properties"/>

  <!-- SQL Server Properties -->
  <property name="sql.driver" value="org.gjt.mm.mysql.Driver"/>
  <property name="sql.url" value="jdbc:mysql://127.0.0.1/datastore"/>
  <property name="sql.user" value="user"/>
  <property name="sql.pass" value="password"/>

  <!-- FILE LOCATIONS  -->
  <property name="sql.dir" location="sql"/>

  <!-- INITIALIZE PROJECT -->
  <target name="init" description="Initialize the project">
      <available property="no.ant.lib.dir" file="${user.home}/.ant/lib/" type="dir" />
  </target>

  <!-- SETUP MYSQL -->
  <target name="setup_mysql" description="Copy the lib so ant can see it" unless="no.ant.lib.dir">
      <mkdir dir="${user.home}/.ant"/>
      <mkdir dir="${user.home}/.ant/lib"/>
      <copy file="lib/mysql-connector-java-5.1.13-bin.jar" todir="${user.home}/.ant/lib"/>

      <!-- ant already missed picking up the jar - we have to restart -->
      <fail message="JDBC mysql class copied to ${user.dir}/.ant/lib/ - please restart ant" />
  </target>

  <!-- BUILD DATA SOURCES -->
  <target name="build" depends="init,setup_mysql,clean_data" description="Create and populate tables">

    <sql driver="${sql.driver}" url="${sql.url}" userid="${sql.user}" password="${sql.pass}" >
      <transaction src="${sql.dir}/create_tables.sql"/>
      <transaction src="${sql.dir}/insert_data.sql"/>
    </sql>
  </target>

   <!-- CLEAN PROJECT -->
  <target name="clean" description="Cleans up project build">
    <!-- Don't clean data sources here - may get called by accident -->
  </target>

  <!-- Delete all tables and data -->
  <target name="clean_data" description="Deletes all data and tables">
    <echo>Dropping all database tables in ${sql.schema}...</echo>
    <property name="exec.command" value="mysqldump -u${sql.user} -p${sql.pass} --add-drop-table --no-data ${sql.schema} | grep ^DROP | mysql -u${sql.user} -p${sql.pass} ${sql.schema}" />
    <exec executable="sh">
      <arg value = "-c"/>
      <arg value="${exec.command}"/>
    </exec>

  </target>

</project> 
```

希望这可以帮助

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-04-15T07:46:50.747

当我将 *.jar 复制到 {ant.home}/libs 时遇到了同样的问题，然后我使用 -lib 来定位 *.jar，它运行正常！我认为是新的罐子无法加载，然后我会测试它！

# ajax - 在 CDN 上托管 Microsoft Ajax？

> ID：482308
> 
> 赞同：1
> 
> 时间：2009-01-27T04:27:33.357
> 
> 标签：ajax, cdn, microsoft-ajax

Google 在以下位置免费托管流行的 ajax 库：

```
http://code.google.com/apis/ajaxlibs/ 
```

您可以利用他们的带宽、他们的[CDN](http://en.wikipedia.org/wiki/Content_Delivery_Network)，最重要的是，用户可能已经从另一个从谷歌检索他们的 JS 文件的站点缓存了它。

只是想知道任何地方的 Microsoft AJAX 是否也是如此？或者在微软网站上的某个地方我可以“窃取”托管服务。

我自己将它托管在像 Amazon A3 这样的 CDN 上也有什么好处。我相信我不会解决[同时下载的数量问题](http://developer.yahoo.com/performance/rules.html#split)，因为 Internet Explorer 会在下载脚本时阻塞。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-09-16T11:42:09.480

Microsoft launched today the [Microsoft AJAX CDN](http://www.asp.net/ajax/cdn/) that will provide Microsoft AJAX and jQuery libraries.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-27T22:33:57.360

你在这里问了几个问题。

首先，据我所知，[雅虎](http://developer.yahoo.com/yui/articles/hosting/)和[谷歌](http://code.google.com/apis/ajaxlibs/)是唯一为 JavaScript 库提供免费 CDN 托管的公司。

其次，会损害您的页面性能的是过多的 DNS 查找。这是关于平衡 DNS 查找的成本与 CDN 与本地服务器相比的速度差异。通常，CDN 和您的服务器之间的差异足以让您从 CDN 获取公共库。

在理想的世界中，您应该使用尽可能少的主机名。您的目标应该是来自服务器的 1 个 HTML 页面、来自 CDN 的 1 个 Javascript 和来自 CDN 的 1 个 CSS。如果您负担不起自己的 CDN 访问费用，则从您的服务器获取 1 个 HTML 页面，从 CDN 获取 1 个 Javascript 库，从您的服务器获取 1 个 Javascript 文件。来自 CDN 的 1 个 CSS 库和来自您服务器的 1 个 CSS 文件就可以了。那仍然只有2个主机。性能指南说 2-4 是您的理想值。

就使用 S3 作为预算 CDN 而言，您应该比较从 S3 和您自己的主机获取文件的速度，以评估这是否值得。您使用的任何 CDN 都只有 1 个主机名，这一点非常重要。因此，如果 S3 将请求重定向到 S3.1.amazon.com 和 S3.2.amazon 任何它都不会成为一个好的解决方案。

我希望这会有所帮助。

# git - 你如何让 git 忽略目录的所有内容？

> ID：482309
> 
> 赞同：53
> 
> 时间：2009-01-27T04:28:34.430
> 
> 标签：git

我有一个 git 目录，其中包含一大堆文件，然后有一个名为“会话”的目录。“会话”包含我的 web.py 程序的 cookie 信息。

我需要将文件夹“会话”保留在 git 存储库中，因为没有该文件夹，程序将无法正常运行。我不需要将文件夹的实际内容存储在 git 目录中。

所以问题是：

如何让 git 忽略文件夹的内容而不是文件夹本身？

* * *

## 回答 #1

> 赞同：58
> 
> 时间：2011-11-16T20:42:00.827

添加一个 session/.gitignore 文件

```
*
!.gitignore 
```

第二行告诉 git 不要忽略 .gitignore 文件，因此该文件夹不为空，但其他所有内容都将被忽略。

* * *

## 回答 #2

> 赞同：52
> 
> 时间：2009-01-27T04:45:48.763

如果我没记错的话，您可以通过在文件夹中创建一个`.gitignore`文件作为其内容来做到这一点。`sessions``[^.]*`

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-27T05:07:03.043

自2007 年[7 月](http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=427078)以来，[gitignore](http://git-scm.com/docs/gitignore)确实描述了排除模式。

> **如果模式以斜杠结尾**，则出于以下描述的目的将其删除，但**它只会找到与 directory 的匹配**项。
> 
> **换句话说， foo/ 将匹配目录 foo 和它下面的路径，但不会匹配常规文件或符号链接 foo**（这与 pathspec 在 git 中的一般工作方式一致）。

如[该线程所示](http://markmail.org/message/k3axwb4sy7dhrz67#query:gitignore%20patterns+page:1+mid:4mcq2kt6o6smdiv7+state:results)，该模式并不总是用“/”表示匹配目录。

# powershell - 在不安装 PowerShell 的情况下运行 PowerShell 脚本？

> ID：482314
> 
> 赞同：10
> 
> 时间：2009-01-27T04:32:15.220
> 
> 标签：powershell

有没有办法捆绑 PowerShell，这样我就不必在操作系统上安装它？理想情况下，我想在我的构建过程中使用它，但我想要一些独立的东西；我不想依赖每台安装 PowerShell 的客户端计算机。我想我会构建一个托管 PowerShell 环境的控制台应用程序，但会在本地捆绑 PowerShell 程序集。

假设有可能，这样的设置是否存在任何版税/许可问题？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-27T18:44:31.817

我不确定我需要多少时间才能查看这些库是否可以在某种程度上独立复制。您希望 .NET Framework 2.0 在机器上吗？

这里有一些信息：http: [//karlprosser.com/coder/2008/06/19/portable-powershell-part-2-roll-your-own-plus-a-challenge/](http://karlprosser.com/coder/2008/06/19/portable-powershell-part-2-roll-your-own-plus-a-challenge/)

但这不是微软官方支持的。Microsoft 的立场可能是您必须使用 msi/msu 安装 PowerShell 或添加该功能。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-27T15:02:17.523

您可以使用 System.Management.Automation dll 在 .net 应用程序中托管 powershell 运行时，但我相信要运行它，您仍然需要访问机器上的 powershell 运行时。除非有办法将整个运行时包含在应用程序中，我的研究似乎不可能，否则您需要在每台机器上安装 powershell。如果有任何安慰的话，Windows 7 默认安装了 powershell。

# c++ - 如何检查无效指针？

> ID：482315
> 
> 赞同：12
> 
> 时间：2009-01-27T04:33:14.857
> 
> 标签：c++, pointers

我当前的代码效果如下：

```
if( objectPointer != NULL){
    delete objectPointer;
} 
```

不起作用，因为编译器将指针设置为无效的十六进制数字，例如：

*   0xbaadf00d
*   0x死牛肉

ETC....

那么在尝试删除对象之前检查无效指针的最佳方法是什么？

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2009-01-27T04:38:25.877

始终将指针初始化为 NULL（即 0）。来自[http://www.lysator.liu.se/c/c-faq/c-1.html](http://www.lysator.liu.se/c/c-faq/c-1.html)：

> 空指针在概念上与未初始化的指针不同。已知空指针不指向任何对象；未初始化的指针可能指向任何地方。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-01-27T04:50:20.410

调用 delete 时不需要检查 not-NULL。它被明确定义为什么都不做。

```
delete NULL; // this is allowed 
```

您正在编写的任何正确代码都不会受到编译器放入未初始化或已释放内存的这些奇怪值的影响。它将这些值放在那里以帮助您找到错误。因此，你有一个错误。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2009-01-27T04:37:44.663

如果它不指向任何东西，最好的方法是将其设置为 NULL。全局变量、其他命名空间中的指针和局部静态指针会自动初始化为空指针。如果您需要针对 NULL 测试类成员和普通本地变量，则应手动将它们初始化为 NULL（有些人喜欢使用它们`0`。当然，这是完全等效的）。

然后，您可以检查 NULL，但也可以立即将指针传递给`delete`，因为删除空指针不会有任何影响（由 C++ 标准保证）。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-01-27T04:43:08.397

你问错问题了。
您的指针不应该首先获得这些值。你不能依赖编译器来设置一个指向某个东西的无效指针。您总是需要通过为其分配 NULL 来自己完成。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2011-09-08T10:59:12.053

“在尝试删除对象之前检查无效指针”的最佳方法是永远不要尝试删除对象。所有调用都`delete`应该在拥有指向数据的对象的析构函数中执行。

标准库中充满了拥有这种所有权的对象，因此您几乎不需要自己编写一个。尝试`unique_ptr`,`vector`或`shared_ptr`任何其他适合您特定需求的容器。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-27T04:46:50.307

在我发布之后发现[了这个。](https://stackoverflow.com/questions/381718/check-for-value-definedness-in-c)

# asp.net-mvc - 我可以从 MVC 操作返回 JsonResult 并仍然利用验证吗？

> ID：482316
> 
> 赞同：0
> 
> 时间：2009-01-27T04:33:58.960
> 
> 标签：asp.net-mvc, validation

我实际上还没有尝试过，并希望快速得到是或否的答案。

我只是从一个[有用的 stackoverflow 问题](https://stackoverflow.com/questions/304233/how-to-use-ajax-beginform-mvc-helper-with-json-result)中了解如何使用 JSonResult 。

我想知道的是我可以使用这种 actionresult，但仍然利用[MVC 模型提供的验证](http://www.asp.net/learn/mvc-videos/video-423.aspx "非常好的视频")吗？

如果我返回 Json 结果并且存在验证错误，它会自动返回由验证 ajax 逻辑捕获的不同结果类型吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-27T12:59:31.263

我所做的是编写我自己的继承自 JsonResult 的 ExtendedJsonResult 类，最初是为了将注册 JavaScriptConverters 的能力添加到序列化过程中，但这后来允许我添加一个 CheckContextForErrors 方法，该方法查看上下文的模型状态错误并添加以及 json 结果数据的错误（属性名称、尝试值、消息）。

我实现了自己的 HandleJsonErrorInfo 类（基于 HandleErrorInfo）和 HandleJsonErrorAttribute，它在 Actions 上声明，将拦截任何未处理的异常并将异常消息作为 JSON 返回。

客户端我可以检查 JSON 响应中是否存在 ExceptionMessages 数组，然后遍历每个错误。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-27T06:58:43.147

不，内置的 JsonResult 只会序列化它提供给 Json 的对象并将其发送到网络中。如果您想发送验证错误，则必须将该信息放入您自己的对象中并通过 Json 发送这些信息。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-27T13:21:40.237

默认验证消息是在您 ModelBind 时创建的（也就是获取请求数据并将其应用于对象）。这可以通过标准表单提交、ajax 或任何其他方式来完成。

验证消息存储在 ViewData.ModelState 中。

验证消息的呈现是使用 HtmlHelpers 完成的，它只查看 ModelState 并呈现任何适用的消息。HtmlHelper 作为渲染视图的一部分在服务器端完成。返回 JSON 会跳过渲染。您可以改为返回一个局部视图，该视图将呈现作为用户控件一部分的任何验证消息。

也就是说，如果您的控制器操作模型绑定并返回 JSON，它仍会在 ViewData.ModelState 中生成正确的验证信息。如果您想使用它，信息就在那里，但需要将其移至您的模型，并且您的客户端 JavaScript 代码需要知道如何处理它。

# php - preg_match 在 regexbuddy 中工作，而不是在 php 中

> ID：482330
> 
> 赞同：0
> 
> 时间：2009-01-27T04:44:32.293
> 
> 标签：php, regex, pcre, regexbuddy

好的，所以我有我创建的这个正则表达式，它在 RegexBuddy 中运行良好，但当我将它加载到 php 中时却不行。下面是一个例子。

使用 RegexBuddy 我可以让它与这个一起工作：

```
\[code\](.*)\[/code\] 
```

检查点匹配换行符，我添加了不区分大小写的，但它也可以这样工作。

这是php：

```
$q = "[code]<div>html code to display on screen</div>[/code]";

$pattern = '/\[code\](.*)\[/code\]/si';

$m = preg_match($pattern, $q, $code); 
```

所以你可以看到我正在使用 [code][/code]，然后一旦我可以提取它，我将在其上运行 htmlentities() 以显示而不是渲染 html 代码。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-27T04:50:16.073

您在模式（/代码）中间包含正斜杠。要么逃避它，要么用其他东西划定你的模式（我更喜欢！）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-27T14:37:40.927

将正则表达式从 RegexBuddy 传输到 PHP 时，可以在 Use 选项卡上生成源代码片段，或者单击顶部工具栏上的 Copy 按钮，然后选择复制为 PHP preg 字符串。然后 RegexBuddy 将自动添加 PHP 需要的分隔符和标志，而不会留下任何未转义的内容。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-27T04:52:21.280

这是因为你没有逃脱结束标记`/`

转义反斜杠也不会受到伤害：

```
$pattern = "/\\[code\\](.*)\\[\\/code\\]/si"; 
```

PHP 允许您选择任何字符作为正则表达式分隔符，因此我会经常使用在正则表达式中也没有使用的字符，例如`@`.

```
$pattern = "@\\[code\\](.*)\\[/code\\]@si"; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-27T05:20:22.767

这有效：

```
$pattern = '/\[code\](.*)\[\/code\]/si'; 
```

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2009-01-27T04:55:27.573

您需要在 /code 中转义正斜杠

```
$pattern = '/\[code\](.*)\[\/code\]/si'; 
```

另外，请意识到匹配项存储在 $code 中，而不是 $m

编辑：被打败了：p

# wcf - 多个 IP 的端点错误

> ID：482337
> 
> 赞同：2
> 
> 时间：2009-01-27T04:48:40.740
> 
> 标签：wcf

部署 WCF 服务时遇到问题。在本地它工作正常，但在我们的测试服务器上，我们在 IIS 中设置了许多不同的服务，它们都具有不同的 IP，例如：

192.168.0.10 <--- 默认 IP 192.168.0.11 192.168.0.12 <--- 我的网络服务 IP

当我尝试浏览到[http://192.168.0.12/mysevervice.svc](http://192.168.0.12/mysevervice.svc)时一切正常。但是，如果我将它添加到 WCF 测试客户端，它会检测到服务正常，但是当我尝试调用服务方法时，它会进行 dns 查找并尝试出现如下错误：

在[http://pcname/mysevervice.svc](http://pcname/mysevervice.svc)上没有可以接受消息的端点侦听。这通常是由不正确的地址或 SOAP 操作引起的。有关更多详细信息，请参阅 InnerException（如果存在）。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-02T15:41:25.780

确保可以从您的客户端 PC 解析“pcname”。您可能会注意到，当您通过以下方式浏览到您的 svc 文件时：[http://SomeIPAddress/Service.svc](http://Http://SomeIPAddress/Service.svc) WCF 服务会显示用于下载 WSDL 的机器名称。

我想如果您通过 VS 生成客户端，那么机器名称将被插入客户端，而不是 IP 地址。检查您的 app.config 以确保您的 URL 都是正确的。

# security - 您在非以 Web 为中心的应用程序的安全性上花费（或应该花费）多少精力？

> ID：482341
> 
> 赞同：4
> 
> 时间：2009-01-27T04:50:29.113
> 
> 标签：security

假设您正在开发的应用程序是专门为客户设计的，以满足特定的“内部”需求，例如工资单信息的数据处理。此应用程序不会公开分发，只会驻留在内部网络上。（理论上，内部网络应该保持 100% 安全。）在这种情况下，开发人员应该在 IA 上花费多少精力？假设数据库是 SQL，您会担心在这种情况下防止 SQL 注入攻击吗？

我很想听听那些从事非以网络为中心的开发人员的反馈（我现在想不出更好的术语，尽管非以网络为中心并不完全正确。它更像是非分布式或非公开或类似的东西这些行。）键入程序以及它们在安全性方面付出了多少努力。

**作为附录，您如何证明对经理类型的这种需求是合理的？**

我目前正在对 IA 进行“内部”软件开发的必要性进行案例研究，因此将不胜感激任何答案。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-27T04:55:43.877

我会对此应用“可能发生的最糟糕的事情”原则。如果这意味着个人信息可能被泄露和/或可能对公司采取法律行动，您应该采取最适当的行动来保护应用程序。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-27T05:14:26.850

我倾向于认为，无论产品的最终用途是什么，作为应用程序开发人员，我都有责任确保应用程序的完整性及其安全性。这提供了两个明确的好处：

1.  防止您可能不会/不会预见的错误。例如，在数据库查询之前转义输入的相同代码也确保像 O'Leary 这样的名称不会破坏应用程序的正常执行。
2.  防止恶意利用#1。

关于#2，如果您作为公司的开发人员为公司工作，并且信息被使用该系统的员工泄露，那么他们可能会因为该软件是他们的产品而承担责任。如果您正在为正在开发该公司使用的软件的第三方工作，那么如果信息通过您的软件中的安全漏洞从公司泄露，您猜他们会去哪里寻找答案？无论哪种方式，作为应用程序架构师和对为什么应用程序一开始并不更安全有疑问的人，这一切都会回到你的身边。

鉴于您的限制和您将要保护的数据的敏感性，我建议您实施最严格的安全措施。如果它在《魔兽世界》中获得高分，那么我会比为银行设计内部应用程序更担心。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-27T05:20:27.493

我参与了一些内部项目的开发。这是一个收集员工血型详细信息和一些个人信息的应用程序。安全部分被忽略了。

我们从内部安全团队收到一封邮件，要求我们保护该应用程序，因为它包含一些个人信息。我们可能会接受供应商并公开应用程序，并且始终建议开发安全代码。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-27T12:21:24.850

根据大多数安全问题，您需要提出的问题是。

1.  您要保护的资产是什么？
2.  谁会想要获得这些资产？
3.  如果这些资产丢失，您/您的客户/您的企业的成本是多少？

您在问题中提到的工资单信息将是您要保护的资产，您网络中的任何人都会对此感兴趣且无权访问此信息吗？如果你发现你的同事的薪水是你的两倍，你会怎么说？如果有人设法更新这些信息会导致他们的银行账户中有更多的钱，会发生什么？

在确定花多少时间在安全上时，您需要问这些问题。

# php - 日文文件名的php readdir问题

> ID：482342
> 
> 赞同：4
> 
> 时间：2009-01-27T04:50:52.810
> 
> 标签：php, readdir

我有以下代码

```
<?php
if ($handle = opendir('C:/xampp/htdocs/movies')) {
    while (false !== ($file = readdir($handle))) {
        if ($file != "." && $file != "..") {
            echo $file."<br />\n";
        }
    }
    closedir($handle);
}
?> 
```

当它确实有 mb 语言（如日语）时，它无法正常显示，而是显示为 kyuukyoku Choujin R ?????~? 而不是 kyuukyoku Choujin R 研极超人あ～る</p>

无论如何让它显示正确的名称或让它仍然可以被其他人下载？

谢谢你帮助我:)

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-03-01T09:36:12.797

我不能肯定地说 PHP，但我怀疑这与 Python 2 的基本问题相同（在后来添加对 Unicode 字符串文件名的特殊支持之前）。

我的信念是 PHP 正在使用标准 C 库“open”等函数处理文件名，这些函数是基于字节的。在 Windows (NT) 上，这些尝试使用系统代码页对真正的 Unicode 文件名进行编码。西方机器上可能是 cp1252（类似于 ISO-8859-1），日本机器上可能是 cp932（类似于 Shift-JIS）。对于系统代码页中不存在的任何字符，您将获得一个“？” 字符，您将无法引用该文件。

为了解决这个问题，PHP 必须像 Python 3.0 一样开始使用 Unicode 字符串作为文件名（以及其他所有内容），使用 '_wopen'-et-al 函数在 Windows 下获得对文件名的本地 Unicode 访问。我预计这将在 PHP6 中发生，但目前您可能已经吃饱了。您可以将系统代码页更改为 cp932 以访问文件名，但您仍然会得到“？” Shift-JIS 中没有的任何其他 Unicode 字符的字符，并且在任何情况下，您*都不*希望将应用程序的内部字符串全部设为 Shift-JIS，因为它是一种非常可怕的编码。

如果是您自己的脚本选择如何存储文件，我强烈建议在本地使用简单的基于主键的文件名，如“4356”，将真实文件名放入数据库，并使用重写/尾随路径部分提供文件网址。将用户提供的文件名保存在您自己的本地文件名中是很困难的，而且即使不必担心 Unicode，也会导致安全灾难。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-01-29T17:45:52.373

*正如@bobince 所提到的，PHP 以System Locale*的指定编码返回文件名，非 Unicode 感知应用程序使用该编码。如果当前系统编码中不存在该字符，则文件名将包含“？” 相反，将无法访问。

您可以尝试`php-wfio.dll`在[https://github.com/kenjiuno/php-wfio](https://github.com/kenjiuno/php-wfio)`wfio://`安装，并通过协议引用文件。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-01T08:52:13.807

sorry :)

tries this:

`<?php if ($handle = opendir('C:/xampp/htdocs/movies')) { while (false !== ($file = readdir($handle))) { $filename_utf16 = iconv( "iso-8859-1", "utf-16", $file); if ($filename_utf16 != "." && $filename_utf16 != "..") { echo $filename_utf16 . "<br />\n"; } } closedir($handle); } ?>`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-27T08:49:06.947

**您错过了对$file**变量 mate的另外两个引用，但这是更好的，因为我认为我可能已经发现了一种更有效的方法；试试这个：

```
<?php
if ($handle = opendir('C:/xampp/htdocs/movies')) {
    while (false !== ($file = readdir($handle))) {
        $file = mb_substr($file, mb_strrpos($file, '/') + 1);
        if ($file != "." && $file != "..") {
            echo $file . "<br />\n";
        }
    }
    closedir($handle);
}
?> 
```

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2009-01-28T13:42:22.550

我认为 Windows 使用 UTF-16 作为文件名。所以尝试从内部编码转换为输出编码的[`mb_convert_encoding`函数：](http://docs.php.net/mb_convert_encoding)

```
// convert from UTF-16 to UTF-8
echo mb_convert_encoding($file, 'UTF-8', 'UTF-16'); 
```

也许您必须先更改一些设置（请参阅 参考资料[`mb_get_info`](http://docs.php.net/mb_get_info)）。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2009-01-27T06:27:05.127

用**mb_substr($file, mb_strrpos($file, '/') + 1)替换****$file**的任何实例，你应该很高兴。用于多字节编码的 Huzzah！

 **# java - 我可以让 Eclipse 文件搜索包含 IvyDE jars 吗？

> ID：482345
> 
> 赞同：2
> 
> 时间：2009-01-27T04:52:26.550
> 
> 标签：java, eclipse, search, jar, ivy

Eclipse 文件搜索对话框似乎与我的[IvyDE](http://ant.apache.org/ivy/ivyde/) (2.0.0beta1) 依赖 jar 不兼容。也就是说，我的 IvyDE 带来了 some-dep.jar/some-dep.zip （类/源），但我没有看到任何方法让我的文件搜索（ctrl+h 搜索）在搜索文本时包含这些资源-- 所以如果 MAGIC_FLAG 只出现在 some-dep 内的 Magic 类中，我将无法找到它。

关于如何修复/扩展/变得更好的任何想法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-27T13:42:05.407

您必须专门创建一个“工作集”以包含该 jar：

Ctrl-H -> File h-> Working Set (Choose) -> "Java" -> (Pick your resources and jars)

# cocoa - 如何制作一个 NSOutlineView ，其中一些整体是按钮？

> ID：482357
> 
> 赞同：2
> 
> 时间：2009-01-27T05:02:50.010
> 
> 标签：cocoa, interface-builder

我想创建一个 NSOutlineView 子类，其中一些条目看起来像按钮。它看起来像这样：

```
+ 水果
  + 有机
    - 苹果
    - 香蕉
    [添加项目]
  + 非有机
    - 樱桃
    [添加项目]
  [添加项目]
+ 蔬菜
  - 萝卜
  [添加项目]

```

所有“[添加项目]”都是按钮。

我有一种感觉，这涉及以某种方式使用 outlineView:willDisplayCell:forTableColumn:item: 委托方法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-27T17:19:52.673

您需要`outlineView:dataCellForTableColumn:item:`在大纲视图的委托中实现该方法，以便为需要按钮的行返回一个 NSButtonCell，为其他行返回一个 NSTextFieldCell。请注意，此委托方法是在 10.5 中添加的，如果您需要支持 10.4 或更早版本，则需要有一个自定义 NSTableColumn 子类来覆盖该`dataCellForRow:`方法。

# jquery - 根据环境有条件地选择 jquery 的版本

> ID：482358
> 
> 赞同：3
> 
> 时间：2009-01-27T05:03:28.730
> 
> 标签：jquery, visual-studio-2008, intellisense

我的母版页中有 2 个对 jQuery 的引用，当前配置为生产版本：

```
<script type="text/javascript"
 src="http://ajax.googleapis.com/ajax/libs/jquery/1.2.6/jquery.min.js">
</script>
<%--<script type="text/javascript" src="../Scripts/jquery-vsdoc.js"></script>--%> 
```

在开发时，我取消注释 vsdoc 版本，以便在 VS2008 中获得智能感知，然后在部署之前将其切换回 - 除了我忘记的时间。有没有办法在开发中拥有智能感知并在产品中使用谷歌 CDN 而不需要编辑来部署？即取决于环境的有条件包含...

编辑：如果我指定此文件：[http](http://ajax.googleapis.com/ajax/libs/jquery/1.2.6/jquery.min.js) ://ajax.googleapis.com/ajax/libs/jquery/1.2.6/jquery.min.js作为我的 JavaScript 文件，那么 VS2008（带补丁）将查找此文件：[http ://ajax.googleapis.com/ajax/libs/jquery/1.2.6/jquery.min-vsdoc.js](http://ajax.googleapis.com/ajax/libs/jquery/1.2.6/jquery.min-vsdoc.js)（在 .js 之前带有 -vsdoc）用于智能感知。问题是 Google 没有在该位置提供第二个命名文件。

另一个可接受的答案是这个问题的答案：“我如何让 Google 将 jquery.min-vsdoc.js 文件放在[http://ajax.googleapis.com/ajax/libs/jquery/1.2.6/](http://ajax.googleapis.com/ajax/libs/jquery/1.2.6/)？ "

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-27T17:10:17.780

[建议](http://blogs.msdn.com/webdevtools/archive/2008/10/28/rich-intellisense-for-jquery.aspx)的解决方法（因为 Google 不托管文档）是以永远不会包含的方式引用文档脚本，例如

```
<% if (false) { %>
    <script type="text/javascript" src="../Scripts/jquery-vsdoc.js"></script>
<% } %> 
```

或者

```
<asp:PlaceHolder runat="server" Visible="False">
    <script type="text/javascript" src="../Scripts/jquery-vsdoc.js"></script>
</asp:PlaceHolder> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-27T05:07:48.393

Visual Studio 应该会自动查找用于智能感知的 vsdoc。

如果页面上的脚本名为“jquery.min.js”，则 Visual Studio 将在同一位置查找“jquery.min-vsdoc.js”。

你需要有这个修补程序：

[http://blogs.msdn.com/webdevtools/archive/2008/11/07/hotfix-to-enable-vsdoc-js-intellisense-doc-files-is-now-available.aspx](http://blogs.msdn.com/webdevtools/archive/2008/11/07/hotfix-to-enable-vsdoc-js-intellisense-doc-files-is-now-available.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-27T06:04:39.977

这是 Scoot Gu 关于 JQuery 智能感知的[博客文章](http://weblogs.asp.net/scottgu/archive/2008/11/21/jquery-intellisense-in-vs-2008.aspx)。
只是想指出这个博客，因为它更详尽，值得一读。

除此之外，我认为约翰博克已经回答了这个问题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-02-01T16:46:11.190

如果您正在寻找与 VS2008 兼容的解决方案，我使用以下内容：

```
<%= "<script type='text/jscript' src='http://ajax.googleapis.com/ajax/libs/jquery/1.3.2/jquery.min.js'></script>" %>
<% /* %><script type="text/javascript" src="../../App_Data/jquery-1.3.2.js"></script><% */ %> 
```

在这里写博客：[jQuery 托管在带有 IntelliSense 的 Google 的 CDN 上](http://nitoprograms.blogspot.com/2010/02/jquery-hosted-on-googles-cdn-with.html)

# jquery - jQuery 的 blockUI 的任何替代方案？

> ID：482359
> 
> 赞同：6
> 
> 时间：2009-01-27T05:04:30.817
> 
> 标签：jquery, html, css, blockui

这个问题说明了一切！**我正在为 jQuery 寻找一个易于使用的 blockUI 替代方案**。几天来，我一直在尝试在 FireFox 和 IE 中使用 blockUI 将对话框居中，但没有机会。它不起作用。我查看了有关居中 blockUI 对话框的问题（[如何使用 jQuery 和 blockUI 使 DIV 居中于页面上？](https://stackoverflow.com/questions/294502/how-can-i-get-a-div-to-centre-on-a-page-using-jquery-and-blockui)），但它仅适用于 Firefox。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2011-04-07T04:31:01.960

你可能想检查这个插件调用[jQuery MSG](http://dreamerslab.com/blog/en/jquery-blockui-alternative-with-jquery-msg-plugin/)。它适用于大多数浏览器，包括 ie6。而且它的重量很轻，只有 4k 的未压缩代码注释。

### 示例代码

```
// this will block the page and shows a `please wait` message
$.msg();

// you can change the content by the following code
$.msg({
  content : '<img src="loading.gif"/> Sending mail :)'
}); 
```

[演示页面](http://dreamerslab.com/demos/jquery-blockui-alternative-with-jquery-msg-plugin)

[github](https://github.com/dreamerslab/jquery.msg)上的源代码

完整的文档和用法请查看[这篇文章](http://dreamerslab.com/blog/en/jquery-blockui-alternative-with-jquery-msg-plugin/)

或者如果你只是想集中一些 DOM 元素，你可以看看这个[jQuery Center 插件](http://dreamerslab.com/blog/en/centralize-html-dom-element-with-jquery-center-plugin/)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-27T22:32:02.700

对于对话框，我已经从 blockUI 切换到[Jquery UI](http://ui.jquery.com/demos/dialog)。我认为这更好。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-27T05:09:02.460

这是我遇到并稍作修改的扩展。现在看，我认为它实际上有点乱，可以使用清理（我认为有一些未使用的变量）

```
$.fn.vCenter = function(options) {
    var pos = {
        sTop : function() {
            return window.pageYOffset || $.boxModel && document.documentElement.scrollTop || document.body.scrollTop;
        },
        wHeight : function() {
            if ($.browser.opera || ($.browser.safari && parseInt($.browser.version) > 520)) {
                return window.innerHeight - (($ (document).height() > window.innerHeight) ? getScrollbarWidth() : 0);
            } else if ($.browser.safari) {
                return window.innerHeight;
            } else {
                return $.boxModel && document.documentElement.clientHeight || document.body.clientHeight;
            }
        }
    };
    return this.each(function(index) {
        if (index == 0) {
            var $this = $(this),
                $w = $(window),
                topPos = ($w.height() - $this.height()) / 2 + $w.scrollTop()
            ;
            if (topPos < 0 && (options == undefined || !options.allowNegative)) topPos = 0;
            $this.css({
                position: 'absolute',
                marginTop: '0',
                top: topPos //pos.sTop() + (pos.wHeight() / 2) - (elHeight / 2)
            });
        }
    });
};
$.fn.hCenter = function(options) {
    return this.each(function(index) {
        if (index == 0) {
            var $this = $(this),
                $d = $(document),
                leftPos = ($d.width() - $this.width()) / 2 + $d.scrollLeft()
            ;
            if (leftPos < 0 && (options == undefined || !options.allowNegative)) leftPos = 0;
            $this.css({
                position: "absolute",
                left: leftPos
            });
        }
    });
};
$.fn.hvCenter = function(options) {
    return this.vCenter(options).hCenter(options);
}; 
```

用法：

```
$('#verticalCenter').vCenter();
$('#horizontalCenter').hCenter();
$('#bothCentered').hvCenter(); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-11-22T18:28:40.180

如果问题是由与最新版本的 jQuery 一起加载的维度插件引起的，那么维度在几个版本之前被合并到核心中并导致冲突。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-01-13T03:40:08.907

从文档中：

# 为什么我在 Linux 上的 FF 中看不到覆盖？

有几个人告诉我，FF/Linux 中的整页不透明度渲染速度非常慢，因此默认情况下该平台禁用它。您可以通过覆盖 applyPlatformOpacityRules 属性来启用它，如下所示：

```
// enable transparent overlay on FF/Linux 
$.blockUI.defaults.applyPlatformOpacityRules = false; 
```

# oop - PhysX NxActor 问题

> ID：482360
> 
> 赞同：2
> 
> 时间：2009-01-27T05:04:41.440
> 
> 标签：oop, api, coding-style, physics

据我所知，使用 PhysX API 获取 NxActor 的唯一方法是使用 createActor 方法从 NxScene 实例中获取。这真的让我很烦。我想保持我的代码干净，但我觉得别无选择，只能将这个场景从构造函数传递到构造函数，以便类可以生成和引用演员。我想，或者，我可以使场景全局化（eek！），但我不认为全局变量是一个好主意。我的一个想法是让我的类简单地存储一个 NxActorDesc（并让他们将它提供给场景以通过消息传递创建演员），但他们确实需要对 NxActor 的引用，以便他们可以将他们的转换与演员同步。

无论如何，我想看看其他人可能有什么见解。你认为我正在以正确的方式处理这个问题（到处传递 NxScene）吗？感觉有点恶心，但也许我只是疯了。如果没有，我如何以更优雅的方式将 Model 类与 NxActor 同步？提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-09-20T17:43:09.447

如果你不希望你的对象直接与演员耦合，我会建议一种不同的方法。您可以想出一种方法来注册对象以让物理对其进行更新。然后，这些对象注册的模块会将每个对象分配给一个 Actor，该 Actor 将用于定期设置对象的信息。这样，您只有一个模块与 Actor/PhysX 管理相结合，而对象只需要一个接口，允许它们使用物理信息进行更新。

# asp.net-mvc - 我的 MVC 控制器真的应该知道 JSON 吗？

> ID：482363
> 
> 赞同：24
> 
> 时间：2009-01-27T05:07:43.323
> 
> 标签：asp.net-mvc, json, design-patterns

JsonResult 类是一种通过 AJAX 将 Json 作为操作返回给客户端的非常有用的方法。

```
public JsonResult JoinMailingList(string txtEmail)
{
        // ...

       return new JsonResult()
       {
           Data = new { foo = "123", success = true }
       };
} 
```

但是（至少根据我的第一印象）这确实不是一个很好的关注点分离。

*   单元测试方法更难编写，因为它们没有很好的强类型数据来测试并且必须知道如何解释 Json。
*   将来，不通过 HTTP（或任何涉及序列化的远程协议）的其他视图更难被“插入”，因为在这种情况下不需要序列化和反序列化响应。
*   如果您有两个不同的地方需要该操作的结果怎么办？一个想要 Json，另一个想要 XML，或者可能是完全[或部分](https://stackoverflow.com/questions/227624/asp-net-mvc-controller-actions-that-return-json-or-partial-html)呈现的视图。

我想知道为什么对象和 Json 之间的转换没有通过属性以声明方式实现。在下面的代码中，您实际上是在告诉 MVC `this method is convertible to Json`，然后如果从 AJAX 客户端调用它，则会检查`new JsonResult()`内部执行的转换的属性。

单元测试可以只采取行动结果（`ObjectActionResult`）并拉出强类型`Foo`。

```
[JsonConvertible]
public ActionResult JoinMailingList(string txtEmail)
{
        // ...

       return new ObjectActionResult()
       {
           Data = new Foo(123, true)
       };
} 
```

我只是好奇人们的想法和任何可以遵循的替代模式。

这些也只是我最初的观察——这可能不是一个理想的设计可能有更多的原因（可能还有很多原因为什么它是一个完全可以接受和实用的设计！）今晚我只是感觉理论和魔鬼的拥护者。

 **免责声明：*我什至还没有开始考虑该属性将如何实现或者它可能有什么副作用或反作用等。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-01-27T05:52:20.907

我认为你正在为无所事事而烦恼。那么，如果控制器在其公共接口中知道 JSON 怎么办？

我曾经被告知：“让你的代码通用，不要让你的应用程序通用。”

您正在此处编写应用程序控制器。应用程序控制器（其职责是在模型和视图之间进行缓和并调用模型中的更改）了解某个视图（JSON、HTML、PList、XML、YAML）是可以的。

在我自己的项目中，我通常有类似的东西：

```
interface IFormatter {
    ActionResult Format(object o);
}
class HtmlFormatter : IFormatter {
    // ...
}
class JsonFormatter : IFormatter {
    // ...
}
class PlistFormatter : IFormatter {
    // ...
}
class XmlFormatter : IFormatter {
    // ...
} 
```

基本上是“格式化程序”，它接受对象并赋予它们不同的表示形式。如果它们的`HtmlFormatter`对象实现了 s ，它们甚至足够聪明地输出表`IEnumerable`。

现在返回数据（或可以使用`HtmlFormatter`s 生成网站部分）的控制器采用“格式”参数：

```
public ActionResult JoinMailingList(string txtEmail, string format) {
    // ...
    return Formatter.For(format).Format(
        new { foo = "123", success = true }
    );
} 
```

您可以为单元测试添加“对象”格式化程序：

```
class ObjectFormatter : IFormatter {
    ActionResult Format(object o) {
        return new ObjectActionResult() {
            Data = o
        };
    }
} 
```

使用这种方法，您的任何查询/操作/过程/ajax 调用，无论您想调用什么，都可以以多种格式输出。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-01-27T06:37:47.633

我一般尽量不担心。Asp.Net MVC 足以将关注点分离以将泄漏降至最低。不过你是对的；测试时有一点障碍。

这是我使用的一个测试助手，它运行良好：

```
protected static Dictionary<string, string> GetJsonProps(JsonResult result)
{
    var properties = new Dictionary<string, string>();
    if (result != null && result.Data != null)
    {
        object o = result.Data;
        foreach (PropertyDescriptor prop in TypeDescriptor.GetProperties(o))
            properties.Add(prop.Name, prop.GetValue(o) as string);
    }
    return properties;
} 
```

您可以使用 Request.IsAjaxRequest() 扩展方法返回不同的 ActionResult 类型：

```
if (this.Request != null && this.Request.IsAjaxRequest())
    return Json(new { Message = "Success" });
else
    return RedirectToAction("Some Action"); 
```

注意：您需要 Request != null 才不会破坏您的测试。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-02-03T20:26:43.303

我并不太担心像以前那样返回 JSON。AJAX 的性质似乎是，您想要在 Javascript 中处理的消息仅适用于该 AJAX 情况。AJAX 对性能的需求只需要以某种方式影响代码。您可能不想将相同的数据返回给不同的客户端。

我注意到了一些关于测试 JSonResult 的事情（我还没有为我的应用程序编写任何测试）：

1）当您从测试方法“接收”的操作方法返回 JSonResult 时，您仍然可以访问原始 Data 对象。起初这对我来说并不明显（尽管有些明显）。Rob 在上面（或者可能在下面！）的答案使用这个事实来获取 Data 参数并从中创建一个字典。如果 Data 是已知类型，那么您当然可以将其转换为该类型。

就我个人而言，我一直只通过 AJAX 返回非常简单的消息，没有任何结构。我想出了一个扩展方法，如果你只有一个从匿名类型构造的简单消息，它可能对测试很有用。如果您的对象有多个“级别” - 您最好创建一个实际的类来表示 JSON 对象，在这种情况下您只需`jsonResult.Data`转换为该类型。

首先使用示例：

**动作方法：**

```
[AcceptVerbs(HttpVerbs.Post)]
public ActionResult ContactUsForm(FormCollection formData){

     // process formData ...

     var result = new JsonResult()
     {
          Data = new { success = true, message = "Thank you " + firstName }
     };

     return result;
} 
```

**单元测试：**

```
var result = controller.ContactUsForm(formsData);
if (result is JSonResult) {

     var json = result as JsonResult;
     bool success = json.GetProperty<bool>("success");
     string message = json.GetProperty<string>("message");

     // validate message and success are as expected
} 
```

然后，您可以在测试中运行断言或任何您想要的东西。此外，如果类型不符合预期，扩展方法将抛出异常。

**扩展方法：**

```
public static TSource GetProperty<TSource>(this JsonResult json, string propertyName) 
{
    if (propertyName == null) 
    {
        throw new ArgumentNullException("propertyName");
    }

    if (json.Data == null)
    {
        throw new ArgumentNullException("JsonResult.Data"); // what exception should this be?
    }

    // reflection time!
    var propertyInfo = json.Data.GetType().GetProperty(propertyName);

    if (propertyInfo == null) {
        throw new ArgumentException("The property '" + propertyName + "' does not exist on class '" + json.Data.GetType() + "'");
    }

    if (propertyInfo.PropertyType != typeof(TSource))
    {
        throw new ArgumentException("The property '" + propertyName + "' was found on class '" + json.Data.GetType() + "' but was not of expected type '" + typeof(TSource).ToString());
    }

    var reflectedValue = (TSource) propertyInfo.GetValue(json.Data, null);
    return reflectedValue;
} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-27T10:50:53.147

我认为你有一个有效的观点 - 为什么不将“接受的响应类型与生成的响应类型解析”委托给它实际所属的某个地方？

它让我想起了 Jeremy Miller 关于如何制作 ASP.NET MVC 应用程序的观点之一：[关于 ASP.NET MVC 的“观点”](http://codebetter.com/blogs/jeremy.miller/archive/2008/10/23/our-opinions-on-the-asp-net-mvc-introducing-the-thunderdome-principle.aspx)

在他们的应用程序中，所有控制器操作都有一个简洁的界面——一些视图模型对象进入，另一个视图模型对象离开。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-29T20:55:59.417

我有同样的想法并实现了一个[JsonPox](http://aleembawany.com/2009/03/27/aspnet-mvc-create-easy-rest-api-with-json-and-xml/)过滤器来做到这一点。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-27T14:18:13.743

我不确定这实际上是一个多大的问题，但是在 ASP.NET MVC 中遵循的“替代模式”将是编写一个 JSON ViewEngine。这实际上并不难，因为框架中内置的 JSON 功能将为您完成大部分繁重的工作。

我确实认为这将是一个更好的设计，但我不确定它是否值得反对实现 JSON 的“官方”方式。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-25T15:13:54.543

或者，如果您不想使用反射，您可以使用结果的 Data 属性创建一个 RouteValueDictionary。使用 OP 的数据...

```
var jsonData = new RouteValueDictionary(result.Data);
Assert.IsNotNull(jsonData);

Assert.AreEqual(2,
                jsonData.Keys.Count);

Assert.AreEqual("123",
                jsonData["foo"]);

Assert.AreEqual(true,
                jsonData["success"]); 
```

# c# - 有没有办法掌握对话框的取消事件

> ID：482368
> 
> 赞同：2
> 
> 时间：2009-01-27T05:10:19.900
> 
> 标签：c#, winforms

C# winform 中有没有办法改变打开或保存对话框的取消按钮事件。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-02T16:34:17.620

这取决于你所说的改变。您无法编辑 ShowDialog 的行为，您只能处理返回的结果并采取适当的操作。[OpenFileDialog](http://msdn.microsoft.com/en-us/library/system.windows.forms.openfiledialog.aspx)是一个密封类，这意味着您不能从它继承并覆盖行为。如果您确实需要控制何时显示 OpenFileDialog，则需要创建自己的表单来处理必要的行为。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-02T16:28:09.087

查看 DialogResult，您会找到所需的内容。

```
Dialog dialog = new <file save dialog>();

if (dialog.ShowDialog() == DialogResult.Cancel)
{
//   your code here
} 
```

[Google 中的对话框结果](http://www.google.ca/search?hl=en&q=dialog+forms+c%23+dialogresult&meta=&aq=f&oq=)

# wordpress - 如何自定义wordpress“评论错误”页面

> ID：482370
> 
> 赞同：2
> 
> 时间：2009-01-27T05:12:11.487
> 
> 标签：wordpress

如果您在评论表单中输入了不正确的信息（缺少姓名、电子邮件等），wordpress 会返回一个带有相关错误消息的空白页面。我用谷歌搜索，但找不到自定义此响应的方法。

有谁知道该怎么做？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2010-01-27T02:44:07.650

对于这个特殊问题，我最终直接修改了 \wp-comments-post.php - 主题引擎不允许您自定义它。

我所做的简短描述是绕过“wp_die()”的使用，而是让脚本在博客评论帖子未验证的情况下执行“my_wp_die()”。

这是一个顺序示例：

1）用户登陆文章页面（在您的主题中调用 single.php）
2）用户在评论字段中输入一些信息（可能会或可能不会验证）
3）使用文章的表单帖子到“wp-comments-post.php” URL 作为参数，因此它可以将验证结果传递回具有适当视觉效果的页面（侧边栏：我无法挂钩我编写的外部模板库，该模板库已集成到主题中，而不是将我的网站模板复制到主题）和用户表单字段。
4) wp-comments-post.php 将`my_wp_die()`在未验证时调用（包括来自 /comment.php:function 的重复检查`wp_allow_comment()`），或者`my_wp_success()`如果评论有效并被发布。
5) wp-comments-post.php 会将用户转发回文章 URL（源自永久链接）。
6) 主题中的 single.php 将显示错误/成功消息和新评论。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-27T05:51:05.870

我无法找到任何关于简单地自定义错误页面的内容，但是快速浏览 wp-comments-post.php 告诉我，当它遇到错误时，它会执行生成错误页面的函数[wp_die 。](https://developer.wordpress.org/reference/functions/wp_die/)似乎需要一些参数来控制错误页面的输出，但找不到有关这些选项可能是什么的任何详细信息。通过对 wp_die 稍加调整，您应该能够让它显示您自己的自定义错误页面。不确定这是否会有所帮助，但这是一个开始的地方。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-05T02:38:42.223

在相关说明中，请确保验证您的错误页面在 Internet Explorer 中正确显示。我只提到这一点是因为我最近遇到了这个问题，不幸的是花了几个小时来解决这个问题。

简而言之，WordPress 生成的一般错误页面（例如，在“用户评论”验证失败后）被发送到带有 HTTP 状态代码“500 Internal Server Error”的浏览器。*奇怪的是，如果页面小于 512 字节*，Internet Explorer（版本 7 之前）将忽略以“500”发送的错误页面，而是显示通用的 Microsoft“无法显示此页面”错误消息。

WordPress 人知道这个错误并编写了 wp_die() 函数，以确保错误页面大于 512 字节。不幸的是，他们忽略了考虑使用 gzip 压缩（即在通过网络发送网页之前缩小网页）的 Web 服务器的性能。**如果 Web 服务器使用 gzip 压缩，Internet Explorer 5/6 将不会显示通用 WordPress（v2.7 和更早版本）错误页面。**

如果对遇到此问题的其他人有任何帮助，我已经写了一篇博客文章，更详细地描述了这个问题（包括屏幕截图），包括我打开的 WordPress 错误的链接以及临时解决方法的说明，可以在正确修复错误之前一直使用。有关更多信息，请参阅[http://www.clintharris.net/2009/ie-512-byte-error-pages-and-wordpress/](http://www.clintharris.net/2009/ie-512-byte-error-pages-and-wordpress/)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-08-24T18:29:25.527

我自己一直对此感到困惑，据我所知，最新版本的 WP 似乎没有任何进一步的增强。

但是，我的解决方案是在 Javascript 中进行一些客户端表单验证。只需将事件处理程序附加到提交按钮（例如，使用 submit.onclick），然后将其链接到您的 JS 验证函数以检查数据并在失败时提供反馈（如违规表单字段周围的红色边框）。

如果数据验证失败，请记住使用 preventDefault 以便表单不会被提交！

当然，如果没有启用 Javascript，表单仍然会提交，在这种情况下，用户仍然会看到默认的 WP 错误页面。要解决这个问题，您可以使用前面讨论的 PHP 选项，但我认为这是更多的工作。

# c - strdup() 函数

> ID：482375
> 
> 赞同：15
> 
> 时间：2009-01-27T05:14:56.537
> 
> 标签：c, strdup

我最近意识到`strdup()`我在 OS X 上非常喜欢使用的功能不是 ANSI C 的一部分，而是 POSIX 的一部分。我不想重写我所有的代码，所以我想我只是要编写自己的`strdup()`函数。这并不难，真的，它只是一个`malloc()`和一个`strcpy()`。无论如何，我有这个函数，但是如果我编写这个函数并将它链接到我的代码，并且它已经存在于 libc 中，我该怎么办？我的链接器或编译器是否允许我基本上定义我自己的函数版本，还是我必须给它另一个名字？如果有一种方法可以重用相同的名称，那将非常方便，这样如果`strcpy()`存在于用户的 libc 中，他们就可以使用它，但如果它不存在于他们的 libc 中，他们可以使用我的版本，只需要很少的代码尽可能地改变。

简短版本：

a) 当我编写自己的函数与内置函数同名时会发生什么？

`strdup()`b) 我能做些什么来避免在没有将我所有的代码重写为 not use的平台上发生不好的事情`strdup()`，这有点乏味？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-01-27T05:19:56.807

通常，您只需`#if`在某个编译器下使用 an 来定义您想要的功能。如果内置库没有定义strdup，那么自己定义也没问题（除非他们以后定义了，你得把它拿出来。）

```
// Only define strdup for platforms that are missing it..
#if COMPILER_XYZ || COMPILER_ABC
char *strdup(const char *)
{
   // ....
}
#endif 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-01-27T05:52:26.570

您可以只使用这样的宏，这样您就可以使用旧名称，但链接器会看到不同的名称；

```
char *my_strdup(const char *s) {
    char *p = malloc(strlen(s) + 1);
    if(p) { strcpy(p, s); }
    return p;
}

/* this goes in whatever header defines my_strdup */
char *my_strdup(const char *s);
#define strdup(x) my_strdup(x) 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-01-27T08:30:52.930

正如 Rob Kennedy 所说，最好的方法是在您的构建脚本中测试此功能是否存在。我知道使用 autoconfig 相当容易，但也可能使用其他跨平台构建脚本工具。

然后你只需放入你的头文件：

```
 #ifndef HAVE_STRDUP
# ifdef HAVE__STRDUP
#  define strdup _strdup
# else
#  define strdup my_strdup
# endif
#endif 
```

如果目标平台上已经存在 strdup，则使用 libc 版本，否则将使用您的自定义 my_strdup 函数。

编辑：我应该添加一个解释为什么它更好。

首先，编译器与 libc 中是否存在函数无关。以函数为例`strlcpy`。它存在于 FreeBSD 但不存在于 Linux (glibc) 上，尽管默认情况下两者都使用 gcc。或者如果有人要用 clang 编译你的代码会发生什么？

其次，平台检查（我不知道是否有标准方法）只有在您为每个要支持正确预处理器条件的平台明确添加时才有效。所以假设你已经掌握了在 OSX 和 Win32 上编译你的应用程序并且你现在想在 Linux 上编译它，你必须通过所有的预处理器条件来查看它们是否适用于 Linux。也许您还想支持 FreeBSD、OpenBSD 等？同样的工作。通过在您的构建脚本中进行测试，它可以在没有任何额外工作的情况下编译。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-01-27T05:23:50.263

> a) 当我编写自己的函数与内置函数同名时会发生什么？

您不能重新定义您包含的头文件中已经存在的函数。这将导致编译错误。

> b) 我可以做些什么来避免在没有 strdup() 的平台上发生坏事而不重写我的所有代码以不使用 strdup()，这有点乏味？

我建议为 strdup 创建自己的**包装函数**，并替换所有调用以使用新的包装函数。例如：

```
char *StringDuplicate(const char *s1)
{
#ifdef POSIX
    return strdup(s1);
#else
    /* Insert your own code here */
#endif
} 
```

将所有调用从 strdup 更改为 StringDuplicate() 应该是一个简单的查找和替换操作，使其成为一种可行的方法。然后，特定于平台的逻辑将保存在一个位置，而不是分散在整个代码库中。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-01-27T07:19:40.060

您还应该考虑避免创建以 str[az] 开头的任何标识符（包括函数）。虽然这不是保留的，但 C 标准 (ISO/IEC 9899:1999) 第 7.26.11 节（未来的库方向）声明“以 str、mem 或 wcs 开头的函数名称和小写字母可以添加到声明中在标题中。”

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-01-27T05:39:06.457

仅供参考：我个人从未见过没有定义 strdup() 的环境。

* * *

## 回答 #7

> 赞同：-3
> 
> 时间：2010-07-13T11:12:11.767

如果其他人读到此：即使可用，也不要使用平台的 strdup()，也不要为了使用它而在 autoconf/automake 上浪费时间/精力。说真的，这有多难：

```
char* mystrdup(const char* str)
{
 return strcpy(malloc( strlen(str) + 1),str);
} 
```

这真的保证#ifdefs 吗？编译器检查？吻

# php - PHP正则表达式分隔符，有什么意义？

> ID：482377
> 
> 赞同：17
> 
> 时间：2009-01-27T05:16:21.400
> 
> 标签：php, regex

为什么 PHP 正则表达式有周围的分隔符？如果将任何模式修饰符作为参数传递给正在使用的任何函数，似乎会更清楚。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-01-27T06:36:58.913

定界符的原因是在模式之后放置标志。可以说标志可以作为单独的参数传递（Java 可以这样做），但 Perl 最初就是这样做的（以及之前的 sed/awk/vi），所以现在就是这样做的。

不要使用正斜杠：它们太常见了。就我个人而言，我几乎总是使用！特点。我几乎从不寻找那个。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-01-27T05:35:56.387

没有技术原因必须这样。

正如评论中所指出的，底层库不需要将标志作为正则表达式的一部分传递 - 事实上，扩展必须将它们剥离并将它们作为单独的参数传递。

看起来好像最初的实现者正试图让它看起来像 grep/sed/awk/perl/etc，以便来自这些工具的程序员更熟悉它。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-01-27T14:31:32.060

我不知道 preg 函数的开发者的动机是什么。我能想到的唯一原因是他们试图以 Perl 的方式做事有点太努力了。

虽然定界符允许将标志与正则表达式一起指定为一个参数，但将标志指定为单独的参数会更简洁。这就是我知道的所有其他正则表达式库（对于不支持文字正则表达式作为语言功能的语言）的方式，包括 PHP 的 preg 函数所基于的 PCRE 库。preg 代码确实必须通过使用正则表达式从字符串中删除正则表达式分隔符的麻烦，然后才能将其传递给 PCRE。

# visual-studio - 如何从 Team Foundation 源代码管理中导出比较文件夹结果

> ID：482379
> 
> 赞同：18
> 
> 时间：2009-01-27T05:16:56.860
> 
> 标签：visual-studio, visual-studio-2008, version-control, tfs

在源代码控制（Visual Studio TFS）中比较了主分支文件夹和给定变更集，并发现了许多差异，我想将结果导出到电子表格中，以便可以传递它并做笔记等...

有什么方法可以从“文件夹差异”屏幕导出此列表结果？

干杯

尼日

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2009-08-27T16:22:47.647

一个好的解决方案是复制并粘贴到 Excel 中。

从顶部开始，选择所有项目 Ctrl+C 然后 Ctrl+V 进入 Excel。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-08-28T03:54:55.927

不要从乔的超酷答案中拿走任何东西，但我应该指出这也可以从命令行中获得。

```
C:\Temp>tf folderdiff /?
TF - Team Foundation Version Control Tool
Copyright (c) Microsoft Corporation.  All rights reserved.

Displays a visual representation of the differences between files in two server
folders, in a server folder and a local folder, or in two local folders.

tf folderdiff [sourcePath] targetPath [/recursive] [/noprompt]
              [/server:serverName:port] [/filter:filter]
              [/filterLocalPathsOnly]
              [/view:same,different,sourceOnly,targetOnly] 
```

通过 /noprompt（又名 /i）将文本显示打印到控制台或将其重定向到文件。例如：

```
tf folderdiff . /r /i > diffs.txt 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2010-10-28T16:02:20.210

我认为这是 TFS 的失败，它不能让你`get`看到差异。

因为它可以用于不是使用 VS 创建的项目，所以在构建补丁等时能够获得差异是有帮助的。大多数其他工具都提供了这个功能。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-27T06:10:12.993

不是直接 afaik，最好的办法是创建一个新工作区，检查特定的变更集，然后使用 Beyond Compare / GNU diff -urw | grep“^diff”/等。把清单拿出来。

# version-control - TFS：数百个单独的应用程序/项目——最好的方法是什么？

> ID：482380
> 
> 赞同：0
> 
> 时间：2009-01-27T05:17:46.547
> 
> 标签：version-control, tfs, team-project

假设该公司有大量独立的中小型应用程序，这些应用程序在逻辑上可以分为少数几个组。

比如我可以有BMW、Mazda、Honda、Ford....、Kawasaki、Harley、....一共几十个甚至上百个应用。

我想我在 TFS 中有 2 个选项：

1.  为每个应用程序创建一个单独的项目。我最终有很多小项目，可能会受到限制，但好处是我可以将所有工作项、错误、报告等单独分配给每个项目，并且每个项目都有一个门户。

2.  创建一个项目“Cars”和一个项目“Motorcycles”，并为每个项目下的每个应用程序创建一个带有分支的源代码控制树。这将提供更好的结构和更少的开销，但我不能再单独为“本田”和“宝马”单独提供门户和工作项、错误、报告等列表。

我错过了什么吗？有没有办法两者兼得 - 一个单独的工作项列表，每个小项目的错误，而没有创建项目堆的开销，有可能达到项目数量的 TFS 限制？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-27T05:46:12.950

我会同意第 2 点。您可以使用 TFS 的“区域”部分将工作项分配给特定的子项目。

为所有这些小型应用程序创建完整的团队项目的开销太大了。这些应用程序中的每一个是否都需要完全独立的生命周期、协作工具（WSS 站点）和一组报告？通常不会。

最坏的情况是，如果项目太大而无法管理，您可以为其中任何一个创建新的团队项目，因为当您创建项目并进入源代码控制屏幕时，可以选择“从现有项目分支”，因此您可以使用它来保留您的源历史记录并创建一个专用项目。

开始敏捷，按需扩展。

# c# - 为什么 C# 与 .NET 框架如此相关？

> ID：482381
> 
> 赞同：1
> 
> 时间：2009-01-27T05:18:24.487
> 
> 标签：c#, .net

也许有VB.net和其他与.Net框架相关的语言。

当我安装 Visual C++ 2008 时，我必须安装 .Net framework 3.5。

但是，为什么人们认为 .Net 主要与 C# 语言有关？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-01-27T05:32:24.257

最简单的方法是将其与 C 语言进行比较。C语言被称为“冯诺依曼机器的脚本语言”。这是最能表达底层机器代码中发生的事情的方式。C# 基本上是 .Net 框架的脚本语言。.Net 框架的设计考虑了 C# 作为其主要语言，部分原因是安德斯是 .Net 框架的主要设计者之一，他设计了 C#（过去也是为 Borland 设计的 Turbo Pascal 和 Delphi）。.Net 框架的设计考虑到了高度的语言兼容性，但 C# 可能永远是“最接近金属”的语言。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-27T05:53:08.753

因为人们喜欢{花括号}！

由于[前三种最流行的编程语言](http://www.tiobe.com/index.php/content/paperinfo/tpci/index.html)都是花括号，因此大多数程序员很容易快速理解和编写 C#。

C# 也是从头开始构建为 .NET 语言的。而在我看来，VB.NET 最初是为现有的 VB Classic 程序员快速迁移到 .NET 世界而创建的，并扩大人们熟悉和喜爱的 Visual Basic 品牌。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-27T05:21:08.037

它是 .NET 中最流行的语言。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-01-27T05:26:31.927

C# 是一种设计简洁的面向对象语言，它与 .NET 之间几乎没有或没有阻抗。至少 VB 开始获得相当多的老化迹象，坦率地说，在引入 .NET 时必须对 VB 进行一些更改，这使得很多人转向更新的技术。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-27T06:12:00.290

C# 的发明考虑了面向对象的编程，而 .NET Framework 严重依赖于 OOP 概念。此外，C# 是与 .NET 一起构建的，作为主要支持它的语言。.NET 已被移植到 C++ 和 VB 中，作为对老项目开发人员的青睐。

VB.net 基本上是支持 OOP 的 VB 的升级版本，但由于原始 VB 的结构，它并不自然。您会注意到 VB 中的语法对于复杂的 OOP 操作会显得混乱或不自然。这与 C 成为 C++ 时发生的情况非常相似。

# php - PHP 标头函数的替代方案

> ID：482392
> 
> 赞同：4
> 
> 时间：2009-01-27T05:28:46.370
> 
> 标签：php, apache, .htaccess, mime-types

我正在一个网站上工作，该网站有许多样式表，所有这些都需要作为 PHP 脚本服务器端处理。我的***.htaccess***文件看起来像这样：

```
<FilesMatch "\.(css)$">
    ForceType application/x-httpd-php
</FilesMatch> 
```

这会导致一个小问题，因为 http-response`Content-Type`字段的 mime 类型随后被设置为`text/html`而不是`text/css`.

显然我可以通过添加`header('Content-Type: text/css')`到我的所有文件来解决这个问题，但有更好的方法吗？

我可以从 .htaccess 文件中执行此操作吗？*[mod_mime](http://httpd.apache.org/docs/2.0/mod/mod_mime.html)*或*[mod_negotiation](http://httpd.apache.org/docs/2.0/mod/mod_negotiation.html)*提供的指令似乎都不是我想要的。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-27T05:41:59.290

尝试：

```
php_value default_mimetype "text/css" 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-27T05:43:18.803

您应该能够为所有 CSS 文件添加一个**.php**扩展名；这将导致服务器传递所有“正常”的 CSS，而您的所有动态的、PHP 生成的 CSS 都应该被解析。之后，只需稍微修改链接样式表的方式：

```
<link rel="stylesheet" type="text/css" href="styles.css.php" /> 
```

尽管这对我来说总是有用的，但您可能需要使用 PHP 的**header()**函数显式声明 CSS 文件的 MIME 类型，如下所示：

```
header('Content-type: text/css'); 
```

# c# - 请解释这个 Convert.ToInt64 InputStringFormat 异常

> ID：482395
> 
> 赞同：0
> 
> 时间：2009-01-27T05:30:23.027
> 
> 标签：c#, .net, type-conversion

谁能告诉我为什么：

```
var nl = Convert.ToInt64("17029268.1650117"); 
```

失败，而您必须这样做：

```
var nl = Convert.ToInt64(Convert.ToDouble("17029268.1650117")); 
```

因为它看起来很愚蠢！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-27T05:37:28.880

[手册](http://msdn.microsoft.com/en-us/library/0zahhahw.aspx)说：

> 格式异常：
> 
> value 不包含可选符号后跟数字序列（0 到 9）。

并且 a`.`不在**`a sequence of digits`**.

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-27T05:42:44.343

您可能还应该使用 long.Parse(str)

long 是一个整数，所以你不能有小数。（试图在推特上告诉你：））

# iphone - iPhone 开发 - 内存释放问题

> ID：482400
> 
> 赞同：5
> 
> 时间：2009-01-27T05:34:23.707
> 
> 标签：iphone, memory, memory-management

我遇到了发布已发布对象的问题，但我一生都无法找出错误发生的位置。我添加了 NSZombieEnabled 标志，这是我在 gdb 中获得的日志。有人可以告诉我如何解决这个问题，或者更确切地说找出错误发生的位置。

```
*** -[CFString release]: message sent to deallocated instance 0x5e4780 
(gdb) where
#0  0x952ff907 in ___forwarding___ ()
#1  0x952ffa12 in __forwarding_prep_0___ ()
#2  0x9260e20f in NSPopAutoreleasePool ()
#3  0x30a564b0 in _UIApplicationHandleEvent ()
#4  0x31563dea in SendEvent ()
#5  0x3156640c in PurpleEventTimerCallBack ()
#6  0x95280615 in CFRunLoopRunSpecific ()
#7  0x95280cf8 in CFRunLoopRunInMode ()
#8  0x31564600 in GSEventRunModal ()
#9  0x315646c5 in GSEventRun ()
#10 0x30a4ec98 in -[UIApplication _run] ()
#11 0x30a5a094 in UIApplicationMain ()
#12 0x00002494 in main (argc=1, argv=0xbfffef9c) at /Users/adminUser/Projects/MyProject/main.m:14 
```

谢谢。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-01-27T06:39:13.917

自动释放池试图释放一个已经释放的对象。

如果您手动释放注册为自动释放的对象，则可能会发生这种情况

```
NSString* foo = [NSString stringWithFormat:@"foo:%d",42];  
[foo release];  /* this release is bad, as this object is already 
registered for autorelease */ 
```

您可以使用以下方法，找到分配点：

1.  将[MallocStackLogging、MallocStackLoggingNoCompact](http://developer.apple.com/documentation/Performance/Conceptual/ManagingMemory/Articles/MallocDebug.html)环境设置为 1。
2.  运行程序，一旦它进入 gdb，使用shell 中的[malloc_history](http://developer.apple.com/documentation/Darwin/Reference/ManPages/man1/malloc_history.1.html)来找出分配的堆栈跟踪：`malloc_history <pid> <addr>`。（NSZombieEnabled 会打印出 gdb 中的地址）

另一种选择（不太可能降低运行时性能）是使用带有“Zombies”模板的 Instruments 工具。它将跟踪僵尸并告诉您僵尸的历史，而无需使用 malloc_history 命令。

# python - 在 Python 中解析包含列数据的文件

> ID：482405
> 
> 赞同：-3
> 
> 时间：2009-01-27T05:38:38.720
> 
> 标签：python, file, parsing

我有一个文件，其中包含`details.Its`行和列形式的符号表。

我需要提取第一列和最后一列。

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-01-27T10:33:39.250

[csv](http://docs.python.org/library/csv)模块是更简单的方法。您可以在此代码中使用任何分隔符：

```
import csv

def import_text(filename, separator):
    for line in csv.reader(open(filename), delimiter=separator, 
                           skipinitialspace=True):
        if line:
            yield line

for data in import_text('somefile.txt', '/'):
    print (data) 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-27T09:05:53.670

解析写入文本文件的表格最方便的方法是使用[csv 模块](http://docs.python.org/library/csv.html)。它支持任何分隔符，使用起来比手动逐行解析更方便。例子：

```
import csv

def get_first_and_last_column(filename, separator):
    with file(filename, 'rb') as file_obj:
        for line in csv.reader(file_obj, 
              delimiter=separator,    # Your custom delimiter.
              skipinitialspace=True): # Strips whitespace after delimiter.
            if line: # Make sure there's at least one entry.
                yield line[0], line[-1]

if __name__ == '__main__':
    for pair in get_first_and_last_column(r'c:\temp\file.txt', ';'):
        print pair 
```

现在，如果你给它一个这样的文件：

```
Edgar; Alan; Poe
John; Smith

Lots;   of;   whitespace; here 
```

它将产生以下输出：

```
('Edgar', 'Poe')
('John', 'Smith')
('Lots', 'here') 
```

**编辑**：自定义参数`csv.reader`也可以作为关键字参数传递（谢谢，nosklo！）。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-01-27T05:53:05.260

您使用的是什么类型的分隔符？也就是说，是什么分隔了您的列？

我假设您使用的是逗号分隔符，如下所示：

```
col1,  col2,  col3
col11, col12, col13
col21, col22, col23
col31, col32, col33 
```

以下代码将解析它并打印每行的第一列和最后一列：

```
# open file to read
f = file('db.txt', 'r')

# iterate over the lines in the file
for line in f:
    # split the line into a list of column values
    columns = line.split(',')
    # clean any whitespace off the items
    columns = [col.strip() for col in columns]

    # ensure the column has at least one value before printing
    if columns:
        print "first", columns[0]  # print the first column
        print "last", columns[-1] # print the last column 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-20T07:06:09.150

根据更新，列用空格分隔。所以它会是：

```
rawfile = open('details.Its', 'r')
table = [line.rstrip().split() for line in rawfile.readlines()]

newtable = [[line[0]]+[line[-1]] for line in table]
print(newtable) 
```

# sql - 运行多个 MS SQL EXPRESS 实例的限制

> ID：482408
> 
> 赞同：2
> 
> 时间：2009-01-27T05:39:42.260
> 
> 标签：sql, sql-server-express

我计划在我的开发服务器上安装 MS SQL EXPRESS 的多个实例。

我希望这能让我绕过 SQL EXPRESS 的[限制](http://msdn.microsoft.com/en-us/library/cc645993.aspx)：

*   1 GB 内存，
*   1 个 CPU
*   数据库大小最大 4 GB

[我理解并希望我能负担得起 SQL Server 的完整许可版本。]

那么，这行得通吗？每个实例都有自己独立的限制吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-27T09:55:05.847

你的问题的答案是肯定的。

所有实例都有自己独立的限制。

您将面临的问题是：

*   明显的性能问题。
*   操作系统将决定他们将使用哪种处理器，并且很有可能他们都将使用相同的处理器。你需要尝试一下。
*   服务器需要监听不同的端口。
*   单独的主数据库，单独的排序规则，没有简单的跨数据库查询。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-27T06:10:30.373

如果您订阅了 MSDN，那么您可以安装开发版本，我认为这没有任何限制……当然，它仅用于开发目的。

您可以通过此链接从 Microsoft 购买 SQL Server Developer Edition...50 美元

[http://store.microsoft.com/microsoft/SQL-Server-2008-Developer-Edition/product/C5EA00C9](http://store.microsoft.com/microsoft/SQL-Server-2008-Developer-Edition/product/C5EA00C9)

* * *

截至 2016 (?) SQL Server Developer Edition 是**免费**的，可在[microsoft.com/sqlserver](http://go.microsoft.com/fwlink/?LinkID=799009)下载。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-27T06:06:40.940

如果你能做到这一点，每个实例都会在相同的限制下运行和运行。此外，您将需要配置端口，因为每个实例都将尝试侦听同一端口。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-27T06:29:59.273

由于它是一个开发服务器，我会推荐使用开发版的副本。开发人员版是企业版的特殊许可版本，它允许您在通常不允许运行企业版的操作系统版本上运行它。问题是它只能用于开发。50 美元，这是非常值得的成本。

运行多个实例的问题是您面临实例之间的 CPU 和内存资源争用的前景。您可以限制每个实例和此类事物的内存，但如果您可以选择，使用 Developer Edition 实例将更简单、更易于管理。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-27T10:04:38.807

问题是，按照设计，SQL Server 将尽可能多地占用内存（缓存越大，性能越好），因此，运行 4 个 SQL Server 只会争夺您的 RAM（1gig 是远远不够。）

也就是说，最大数据库大小是 4 gig，但是，除非您正在处理图像，否则您会惊讶于它的大小。

我们使用了 SQL Express，它适用于我们的用途（10 个用户客户端/服务器应用程序），每秒大量 SQL 和大量查询。我建议使用快速版本，并在未来寻找更好的版本。

仅供参考：Microsoft Small Business Server (SBS) 附带 SQL Server 和 Exchange 的工作站版本，这意味着它对于初创企业来说具有极高的成本效益。

另外，如果你的想法不错，你应该看看微软针对新公司的计划（它曾经被称为赋权，现在它有了一个新名称......）。他们在软件方面真的很棒，尤其是服务器软件。

# python - 如何在 Python 中将字符串转换为双精度值？

> ID：482410
> 
> 赞同：248
> 
> 时间：2009-01-27T05:40:38.513
> 
> 标签：python, string, double

我想知道如何将包含数字的字符串转换为双精度。

* * *

## 回答 #1

> 赞同：369
> 
> 时间：2009-01-27T05:49:18.183

```
>>> x = "2342.34"
>>> float(x)
2342.3400000000001 
```

你去吧。使用 float（其行为与 C、C++ 或 Java double 的行为相似且具有相同的精度）。

* * *

## 回答 #2

> 赞同：55
> 
> 时间：2011-06-17T11:56:28.090

小数运算符可能更符合您要查找的内容：

```
>>> from decimal import Decimal
>>> x = "234243.434"
>>> print Decimal(x)
234243.434 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2018-01-25T01:11:20.520

请注意，如果您的字符串编号包含超过 15 个有效数字`float(s)`，则会将其四舍五入。在这种情况下，最好使用`Decimal`

这是一个解释和一些代码示例： [https ://docs.python.org/3/library/sys.html#sys.float_info](https://docs.python.org/3/library/sys.html#sys.float_info)

# ruby-on-rails - Ruby 真的有设计模式可以解决的设计问题吗？

> ID：482421
> 
> 赞同：3
> 
> 时间：2009-01-27T05:47:55.783
> 
> 标签：ruby-on-rails, ruby, design-patterns

我最近开始研究设计模式。一般来说，我认为*大多数*设计模式解决的设计问题一般不会出现在 Ruby 中。大多数设计问题是由于数据类型（没有动态类型和数组可以一次保存属于同一类的对象等等等等）。作为一名 ruby​​ 和 ruby​​ on rails 开发人员，我意识到没有接口、抽象类、引用、指针等概念，以及诸如模块、动态类型、包含任何类的对象的数组等概念的存在，以及*eval*之类的功能确实让生活更轻松为开发商。我还浏览[了 Russ Olsen 的书](https://rads.stackoverflow.com/amzn/click/com/0321490452). 然而，我认为这本书试图模拟设计模式而不是实际实现它们，原因是设计问题通常不会出现在 Ruby 中。是不是 Ruby 编程语言随着时间的推移而发展，并在内部处理设计问题，使开发人员更多地专注于业务逻辑？

我想知道其他 Ruby 开发人员对此的看法。谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-27T22:09:31.467

*[在软件工程中，设计模式是针对软件设计中常见问题的通用可重用解决方案。](http://en.wikipedia.org/wiki/Design_pattern_(computer_science))*. 自然，通常出现的问题因语言和系统而异。Ruby 确实可以解决一些在其他语言中出现的问题，但它本身也会有常见的问题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-27T07:06:39.010

考虑到[MVC](http://martinfowler.com/eaaCatalog/modelViewController.html)和[ActiveRecord](http://martinfowler.com/eaaCatalog/activeRecord.html) Ruby on Rails 的核心，您选择了一个糟糕的例子来争论[设计模式缺少语言特性](http://c2.com/cgi/wiki?DesignPatternsAreMissingLanguageFeatures)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-27T06:24:15.260

我认为您误解了设计模式。这不是真的

> “大多数设计问题都是由数据类型引起的。”

相反，设计模式通常解决面向对象设计的结构问题。例如，在 Ruby 中，您可能会遇到必须由相同代码处理的不同类的对象的问题。当它们具有不同的接口（这意味着不同的方法集）时，您可能需要适配器模式来解决这种不兼容问题。同样，您可能希望实现不同的行为集并将使用策略模式来执行此操作。

像 Null Object 这样的一些模式可能不相关，因为它们直接集成在语言中，并且出于习惯而使用，而没有将它们视为模式。

一般来说，设计模式适用于 Ruby 以及其他面向对象的语言。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-27T06:43:05.703

Ruby 是一种相对现代的语言，虽然不是那么现代，但它已经存在了大约十年。因此，许多常见的编程模式被设计到语言本身中。

> 在很多地方，有人声称使用 DesignPatterns，尤其是像 VisitorPattern 这样复杂的设计模式，实际上表明所使用的语言不够强大。

[链接到关于此主题的 Wiki（Wiki）](http://c2.com/cgi/wiki?AreDesignPatternsMissingLanguageFeatures)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-27T21:57:52.283

设计模式只是一组关于如何解决一些常见特定问题的“想法”。其中一些是有用的......其中一些是微不足道的，甚至是相反的（查找反模式:) 通常，如果需要遵循与大多数“设计模式”中所述的程度相当的预定义工作流，则意味着一个或以下两项：

1.  使用的语言存在缺陷，因此解决常见问题很困难，需要遵循严格的预定义思维方式（设计模式或反模式），以避免过多的错误和/或根本无法解决问题。由于选择了表达能力差的语言而使用设计反/模式通常会导致胡说八道。

2.  遵循设计模式或反模式的程序员缺乏理解、分析和/或解决问题的技能、知识、创造力或简单的智商，因此他/她选择遵循模式或反模式。由于知识不足而遵循反/模式，而不是在尝试解决方案之前获取该知识，通常会导致胡说八道。

ruby 语言极具表现力，因此解决常见任务，尤其是“设计模式”中概述的任务，通常不需要明确使用或遵循严格的预定义工作流程。设计模式。

# mysql - 带撇号的 SQL Server 全文搜索

> ID：482422
> 
> 赞同：0
> 
> 时间：2009-01-27T05:49:15.063
> 
> 标签：mysql

知道如何在包含撇号的 SQL 中进行搜索吗？例如：我想用sql在数据库中搜索一个用户名o'connel。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-27T05:53:14.697

将 SQL 中普通字符串的引号加倍。不过请看我的评论。

```
...WHERE name = 'O''Connel' 
```

# c# - 哪个本地数据库适合我的情况？

> ID：482431
> 
> 赞同：3
> 
> 时间：2009-01-27T05:54:51.340
> 
> 标签：c#, database, vb6, embedded-database

我将构建一组应用程序。其中一个应用程序是无人值守应用程序（用 VB6 编写），它将从各种来源接收到的数据写入本地数据库。所有其他应用程序（将在 VS 2008/c# 3.0 中编写）将读取此数据，主要是出于报告原因。

我不想要 SQL Server/MySql/Sybase 甚至它的 express 版本，因为分发它是一个问题（例如，需要单独安装等）。我正在寻找一个本地数据库，它具有 VB6（如果我必须接受它，可能是 OLEDB 或 ODBC）和 ADO.NET 的驱动程序。如果数据库支持 ORM（如 NHibernate）或至少 1 对 1 的映射器（如 Subsonic），那也很好，但这不会破坏交易。但我的主要要求是数据库应该非常稳固，这样我就不必浪费时间摆弄它，恢复丢失的数据等......

我从前就有使用 MS Access 的经验，并且没有太多美好的回忆（也不是很糟糕）。我听说过 SQLite、SQL Server Compact Edition、VistaDB 等……但对它们的经验为零，我不知道有谁实际使用过它。

有什么最适合我的情况？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-01-27T05:56:23.647

[SQLite](http://www.sqlite.org/)可能正好符合要求。确保你也[检查了所有可用的包装器](http://www.sqlite.org/cvstrac/wiki?p=SqliteWrappers)。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-01-27T06:48:09.733

你有没有想过[FireBird SQL](http://firebirdsql.org/dotnetfirebird/blog/2005/02/embedded-firebird-and-microsoft-sql.html)？

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-27T07:45:29.167

除非数据库，否则我会推荐 SQLite。我有使用它的经验，我和你一样。System.Data.Sqlite 项目非常好，它们支持 ADO.net 2.0 和所有这些花哨的东西。他们目前也在努力获得对包装器的完整 Linq 支持。我推荐它的原因如下。

1.  低占用空间 - 引擎只有 700 KB 或更少。
2.  可扩展 - 它可以处理相当大的数据库。GB 的顺序。任何比这更大的东西都可能需要一个基于服务器的数据库引擎和大量的 RAM。
3.  耐用 - 他们的测试套件覆盖了大部分代码，并已被证明可以在许多商业应用程序上运行，例如 iPhone
4.  快速 - 这个引擎的开销很小。
5.  当前 - .NET 项目与 Microsoft 提出的最新 .NET 3.5 技术保持同步。
6.  便携——可以在嵌入式系统或桌面上使用。

在此处检查 System.Data.Sqlite 项目[http://sqlite.phxsoftware.com/](http://sqlite.phxsoftware.com/)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-01-27T21:18:38.900

查看 Advantage 数据库服务器。它具有静音安装选项，占地面积小，易于维护。它有很多客户端支持：ODBC、OLE DB、.net 数据提供程序、jdbc、dbi、php 等 免版税本地引擎（只是一个与您的应用程序在进程中运行的 dll）、廉价的客户端/服务器、SQL和直接导航表访问。

[开发区](http://devzone.advantagedatabase.com)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-03-19T17:47:56.487

[SQL Server Compact Edition](http://www.microsoft.com/Sqlserver/2005/en/us/compact.aspx)是进程内的，因此无需单独安装。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-27T05:58:58.493

我也没有太多使用[SQLite](http://sqlite.org/)的经验，但我用过一点。它用于[很多](http://sqlite.org/famous.html)情况和应用程序。那里确实有 100 多个小数据库，但我建议至少将 SQLite 作为起点。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-01-27T07:09:54.340

我可以担保 VistaDB。您可能想要查看的另一个数据库是[Blackfish](http://www.codegear.com/products/blackfish)

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-01-27T07:24:08.383

可以将 SQL Server 用作直接连接到数据库文件的本地数据库。但这需要您安装 sql server express。

查看带有 Membership Provider 的 ASP.Net 的默认设置。它将为网站创建一个基于本地文件的数据库。

使用这种方法可能没问题，因为您可以在开发时使用所有熟悉的工具。

编辑：
我刚刚注意到嵌入的标签。如果您想在 Windows CE 设备上运行该应用程序，您可以选择[SQL Server Compact](http://www.microsoft.com/Sqlserver/2005/en/us/compact.aspx)。它不支持存储过程 AFAIK，但它支持 SQL Server 的大多数其他功能。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-01-27T08:55:41.630

SQLite 的影响非常小，而且写得非常好。它非常适合本地客户端数据库

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-01-27T12:44:56.753

正如其他人提到的 SQLite 与[SQLite.net ADO.net](http://sqlite.phxsoftware.com/)提供程序一样，为了方便 .NET 访问它。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-01-27T12:45:45.737

我使用了 ScimoreDB，并为我的应用程序编写了 log4net 的 appender。结果好坏参半，花了很多时间试图通过文档来让事情按照需要工作。

我正在转向 SqlLite，并且有一个关于使用 SubSonic 和 SqlLite 的链接。

# jquery - JQuery - 为每个实例化的新 DOM 对象执行代码

> ID：482433
> 
> 赞同：1
> 
> 时间：2009-01-27T05:56:56.857
> 
> 标签：jquery, dom, events, on-the-fly

我想知道这在 JQuery 中是否可行。

我有一些 Javascript 代码可以动态创建 DOM 对象，以响应用户操作。其中一些 DOM 对象具有特定的结构——容器始终具有相同的“类”属性。

我想做的是，每次创建具有类“X”的 DOM 对象的新实例时，我都希望执行相同的 Javascript 代码。该代码将向该 DOM 对象添加一个“onclick”事件。

不幸的是，我不能只将分配 onclick 的代码放在 document.Ready() 中，因为它绑定到的对象是在 document.Ready() 执行很久之后动态创建的。

JQuery 是否允许您设置将自动绑定到某种类型的 DOM 对象的持久绑定，即使它是动态生成的？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-27T06:06:59.240

我想我已经在 J​​Query 文档中找到了我自己问题的答案，令人惊讶。

[http://docs.jquery.com/Events/live#typefn](http://docs.jquery.com/Events/live#typefn)

```
live( type, fn ) 
```

在 jQuery 1.3 中添加：将处理程序绑定到所有当前和未来匹配元素的事件（如单击）。也可以绑定自定义事件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-27T06:03:42.057

你看过一个名为[LiveQuery](http://plugins.jquery.com/project/livequery/)的 jQuery 插件吗？

从 LiveQuery 文档页面：

> 例如，您可以使用以下代码将点击事件绑定到所有 A 标签，甚至是您可能通过 AJAX 添加的任何 A 标签。

```
$('a') 
>     .livequery('click', function(event) { 
>         alert('clicked'); 
>         return false; 
>     }); 
```

> 将新的 A 标记添加到文档后，Live Query 将绑定单击事件，无需调用或完成任何其他操作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-09-06T03:29:56.837

在 jQuery 核心中不可能（正如您可能已经意识到其他答案涉及一些插件）......如果您不一定需要类似的所有功能，这可能是一项非常简单的任务`livequery`

对于支持它们的浏览器 - 使用 DOM 2 级事件 - 'DOMNodeInserted'：

[http://www.w3.org/TR/DOM-Level-2-Events/events.html#Events-eventgroupings-mutationevents](http://www.w3.org/TR/DOM-Level-2-Events/events.html#Events-eventgroupings-mutationevents)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-11-22T05:16:43.740

这曾经被“live”、“delegate”或有时“bind”所涵盖。这些现在被替换为“on”，但是这里讨论了一些警告：[Javascript event binding persistence](https://stackoverflow.com/questions/19032597/javascript-event-binding-persistence)

# mysql - 用于 mysql 的精细 db 比较器程序

> ID：482438
> 
> 赞同：2
> 
> 时间：2009-01-27T06:04:37.950
> 
> 标签：mysql, synchronization, comparison

使用 MSSQL，我有几个工具用于比较数据库结构和数据，如 SQL-compare、SQL-delta、SQL-Clarity Effects 等...

MySQL有一些等效的程序吗？？？

我需要一个可以向我展示差异的程序，如果可能的话，准备同步脚本......

如果是免费的就更好了...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-27T22:02:06.940

[Navicat for MySQL](http://www.navicat.com/) - 提供试用版。非常适合 MySQL 管理

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-27T06:10:12.790

[SYNC DATABASE](http://www.spectralcore.com/syncdatabase/features.php)你可以试用一下

[EMS 数据比较器 2007 for MySQL](http://terrificsoft.com/business/databases-tools/ems-data-comparer-for-mysql.html)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-09-24T11:13:20.513

查看 Devart 的 MySQL 数据库比较工具：

*   [MySQL 的 dbForge 模式比较](http://www.devart.com/dbforge/mysql/schemacompare/)
*   [MySQL 的 dbForge 数据比较](http://www.devart.com/dbforge/mysql/datacompare/)

它们不是免费工具，但仍然相当实惠，并且有 30 天的免费试用期。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-02T14:17:47.993

查看[mysqldiff](http://www.adamspiers.org/computing/mysqldiff/)，它是免费的。我自己还没有使用它，但我打算尝试一下。

# windows - 如何让 Windows 控制台保持打开状态？

> ID：482444
> 
> 赞同：1
> 
> 时间：2009-01-27T06:08:19.893
> 
> 标签：windows, console

我正在尝试从 Windows XP 控制台运行脚本。（如果相关，它是一个 WinSCP 命令文件。）当我输入命令以运行脚本时，另一个控制台窗口会弹出大约半秒钟，然后它就消失了。

脚本不工作。错误消息可能在弹出的控制台窗口中。我怎样才能让它保持足够长的时间来阅读它？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-27T06:13:00.523

试着盯着你的脚本

```
cmd /k script 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-27T06:23:10.317

您正在寻找以下问题。它的要求略有不同，但那里给出的答案与您的相同。

[有没有办法查看刚刚关闭的 Windows 命令提示符？](https://stackoverflow.com/questions/334669)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-27T06:10:59.857

使用“暂停”命令。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-27T06:11:25.893

使用“暂停”作为脚本的最后一行。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-27T06:21:07.807

您可以从命令行运行脚本，以便查看是否有任何 echos 命令或是否有任何错误。

如果他们使用了 echo 或者他们没有使用 ">nul 2>&1" 重定向信息/错误，您可以看到正在发生的事情。在这种情况下，从脚本中删除“ >nul 2>&1”。

# ruby-on-rails - 在查找时预加载模型关联

> ID：482461
> 
> 赞同：4
> 
> 时间：2009-01-27T06:18:47.890
> 
> 标签：ruby-on-rails, activerecord

现在我正在尝试调用我的模型，并将其结果吐出为 json/xml 格式。我唯一的问题是，我的数据库关联没有被加载或查询。

通常，我可以运行它

```
@campaign = Campaign.find(:all)
```

然后通过调用获取点击数，`@campaign[0].hits`通过`has_many :hits`.

但是如果你调试输出，它只会调用表上的列。您将如何将其与查询放在一起？

例如：

```
  <广告系列>
    <category>网站</category>
    <created-at type="timestamp">2009-01-24 14:49:02 -0800</created-at>
    <end-at type="date">2009-01-24</end-at>
    <id type="integer">14</id>
    <is-watched type="integer">1</is-watched>
    <name>让</name>
    <slug>c5334415da5c89384e42ce6d72609dda</slug>
    <start-at type="date">2009-01-24</start-at>
    <user-id type="integer">5</user-id>
  </广告系列>

```

然后让它改为添加另一列，但没有点击次数。

```
  <广告系列>
    <category>网站</category>
    <created-at type="timestamp">2009-01-24 14:49:02 -0800</created-at>
    <end-at type="date">2009-01-24</end-at>
    <id type="integer">14</id>
    <is-watched type="integer">1</is-watched>
    <name>让</name>
    <slug>c5334415da5c89384e42ce6d72609dda</slug>
    <start-at type="date">2009-01-24</start-at>
    <user-id type="integer">5</user-id>
    <hits type="integer">123412</hits>
  </广告系列>

```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-27T06:34:24.317

ActiveRecord find() 系列采用 :include 选项，允许您急切加载您的关联。

所以你需要做的就是：

> @campaign = Campaign.find(:all, :include => :hits)

以上将急切加载您的数据库调用，以便访问每个索引 [0]。[1] 等不会发出自己的 SELECT 调用。你打电话时

> @campaign[0].to_json

然后它将不包含任何关联，例如“命中”，然后您还需要：在 to_json 调用中包含它，例如

> @campaign[0].to_json(:include => :hits)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-09-05T22:05:33.543

您可以通过在 Campaign 模型中添加 hits_count 字段来实现您想要的。添加新关联时，这将自动更新。

查看 ActiveRecord[关联](http://api.rubyonrails.org/classes/ActiveRecord/Associations/ClassMethods.html)文档中的 counter_cache

# java - 使用 Unicode 字符

> ID：482466
> 
> 赞同：0
> 
> 时间：2009-01-27T06:22:06.793
> 
> 标签：java, ms-access, unicode

我有 unicode 的问题。我有一个多语言项目。当我以本地语言输入数据时，在 Access 中，数据以“à²…à²®à³à²®”的形式存储，但我希望在后端看到本地语言的这些字符。

您能否建议如何执行此操作？

我正在使用 Java、Windows vista 和 ms-access。我已经使用属性类设置了数据库编码并将其传递给`getConnection`方法。虽然它没有显示我想要的。使用`props.put("charset","utf-8")`我正在使用编辑加编辑器。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-27T06:46:27.897

您需要在每一步检查您的数据，*不仅仅是*将其打印为字符串，还需要查看它包含哪些 unicode 字符。请参阅我的[调试 unicode](http://pobox.com/~skeet/csharp/debuggingunicode.html)页面，该页面是为 C# 编写的，但可以在任何地方应用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-27T12:31:46.593

[Jon Skeet](https://stackoverflow.com/questions/482466/problem-with-unicode-characters#482500)的回答很好。除此之外，我想鼓励您检查从浏览器到数据库的整个过程，因为有时问题出在一个非常尴尬的地方。就我而言，问题是由[Tomcat 中的 RequestDumperValve 中](http://www.rolfje.com/2008/07/20/tomcat-utf-8-and-the-requestdumpervalve/)的错误引起的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-27T06:28:36.187

您使用的（编程）语言是绝对重要的。当然，在不知道这一点的情况下，您仍然可以检查以确保您正在使用该项目的所有计算机都使用相同的编码。如果您使用的是 bash shell，您可以键入`echo $LANG`，它可能会为您提供某种 UTF-8。但是请记住，许多程序*不会*在 shell 的语言环境中运行，而是在它们自己的语言环境中运行（尤其是 C）。了解您的 shell 正在运行的语言环境、您使用的所有程序正在运行的语言环境以及该语言环境对于文本编码的含义是一个好主意。

但是，在不知道您的项目使用什么语言的情况下，我只能做到这一点。而且，根据语言的不同，这可能是我能帮助你的最大努力，但如果我们能弄清楚我们在这里使用的是什么语言，那么其他人肯定会接替我。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-27T06:41:05.693

你用的是什么文本编辑器？确保它们支持 Unicode（最好是 utf8），还将数据库编码设置为 utf8，如果您的语言对 unicode 字符串有特殊表示法，请使用它（对于 Java，我认为所有字符串都是 Unicode，但例如 python 2.5 及更低版本需要使用`u"...."`）。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-27T06:45:38.197

您的数据库是否正确配置为使用 unicode 编码？看起来文本被错误地转换或解释为非 unicode 格式。

# wpf - WPF-有没有一种方法来绑定分配给 ViewModel 的 System.Attribute

> ID：482469
> 
> 赞同：0
> 
> 时间：2009-01-27T06:23:21.517
> 
> 标签：wpf, data-binding

WPF 中有没有一种方法可以将数据绑定到附加到 ViewModel 上的属性的 System.Attribute。例如，我的 ViewModel 类上有一些属性。这些类具有定义字段标签文本或标题的属性。有没有办法将数据绑定到属性中的值。在下面的示例中，我想使用数据绑定来提取标题属性 CaptionText 值。

```
public class Person
{
   [Caption(CaptionText:="First Name")]
   public FirstName {get;set;}
} 
```

谢谢你的帮助。

更新：创建一个 ValueConverter 对我有用。我将很快用一些来源更新它。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-27T06:29:00.943

我能想到的唯一方法是绑定到整个对象（即 {Binding}），然后使用 ValueConverter 使用反射提取属性信息（使用 GetCustomAttributes）。

# sql - 每个 foreign_key 的 SQL 最新记录

> ID：482473
> 
> 赞同：1
> 
> 时间：2009-01-27T06:26:49.183
> 
> 标签：sql, performance, foreign-keys, greatest-n-per-group

我有以下两张桌子：

*   成分（ID，名称）
*   成分_价格（id，成分_id，价格，created_at）

这样一种成分可以有很多价格。获得每种成分最新输入价格的最佳方式是什么？我知道它可以通过子选择轻松完成，但我想知道是否有更有效的方法来做到这一点。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-27T06:41:57.593

我这样做：

```
SELECT i.*, p1.*
FROM ingredients i
 JOIN ingredient_prices p1 ON (i.id = p1.ingredient_id)
 LEFT OUTER JOIN ingredient_prices p2 ON (i.id = p2.ingredient_id 
   AND p1.created_at < p2.created_at)
WHERE p2.id IS NULL; 
```

这将搜索比 p1 更新的价格 (p2)，如果没有找到，则 p1 必须是最近的价格。

如果在给定日期可能有多个价格，那么您需要另一个术语来过滤掉重复项。

# html - CSS浮动和块元素

> ID：482485
> 
> 赞同：3
> 
> 时间：2009-01-27T06:34:31.760
> 
> 标签：html, css, layout, cross-browser

我有一个烦人的 CSS 布局问题。我正在尝试在特定页面上浮动图像：

```
img {
  float: left;
} 
```

我想确保我的标题不以以下方式开始缩进：

```
h3 {
  clear: left;
} 
```

除了某些具有列表（或任何块元素）的图像（或不是根据情况）浮动之外，这一切都很好。这样做的原因在 CSS 规范中实际上很清楚：块元素不流动。行/内联元素可以。

然而，这对于列表来说是一个真正的问题。有没有办法以相当通用和兼容的方式解决它？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-27T06:39:49.830

这是我总是做的以确保浮动始终被清除：

1.  将以下内容添加到 CSS 中：

    ```
    .clearfix:after {
        content: ".";
        display: block;
        clear: both;
        visibility: hidden;
        line-height: 0;
        height: 0;
    }

    .clearfix {
        display: inline-block;
    }

    html[xmlns] .clearfix {
        display: block;
    }

    `*` html .clearfix {
        height: 1%;
    } 
    ```

    您还可以[在此处](http://www.webtoolkit.info/css-clearfix.html)找到此代码。

2.  用 class 标记浮动元素的每个父级`clearfix`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-27T15:51:12.930

听起来问题出在清除浮动上。但正如评论所说，截图会很好。我个人通过设置溢出属性来清除我的浮动：[http ://www.quirksmode.org/css/clearing.html](http://www.quirksmode.org/css/clearing.html)

# ruby-on-rails - Rails 中 Django 的“replace_html”等价物是什么？

> ID：482488
> 
> 赞同：1
> 
> 时间：2009-01-27T06:38:51.377
> 
> 标签：ruby-on-rails, ajax, django

我想知道一个控制器（例如以下 Rails 控制器）在 Django 中会是什么样子，以便在异步表单提交后执行页面的 ajax 更新（假设以下是正确的）：

```
def create
@omelet = Omelet.new(params[:omelet])
render :update do |page|
  if @omelet.save
    page.replace_html 'notice', 'Omelet was successfully cooked'
  else
    page.replace_html 'notice', 'Sorry - the omelet could not be cooked'
  end
  page.replace_html 'omelets', :partial => 'meals/omelet_list',
    :locals => {:omelets =>  @omelet.meals.omelets }
end 
```

结尾

我知道 Django 没有相同的内置 ajax 库。这是否意味着像上面这样的东西在 Django 中会更难/更冗长？

“replace_html”调用确实让 Rails 中的事情变得简单——我希望在 Django 中有一个简单的等价物。

另外，Django 是否像 Rails 那样有“偏音”的概念？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-27T06:48:58.827

Rails 中的“page.replace_html”实际上是 RJS 的一种表现形式——即由服务器生成的 Javascript（并发送正确的 MIME 类型等），然后客户端获取该 Javascript 块并将其插入到DOM（可能替换由 DOM ID 指定的其他一些元素）。所以它确实需要 2 个协调：服务器端将 Javascript 发送回客户端，然后客户端接收并处理接收到的数据。

我不知道 Django 是否支持这一点，但你最好在谷歌上搜索“rjs django”之类的东西，因为本质上你正在寻找 Django 中的 RJS 等价物。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-27T11:27:44.100

Rails 喜欢抽象客户端的实现细节，并试图让这看起来像是服务器端的问题。Django 假设您已经拥有自己的客户端 AJAX 技术，并且只是为您需要的任何服务器端支持提供便利。

不同的理念（Django 从不尝试为您编写 HTML 或 Javascript，除非在最微不足道的情况下）。

典型的解决方案是使用一点 JQuery 或其他任何东西来发出正常的 HTTP 请求，然后根据需要将 HTML 或 JSON 响应插入 DOM（这通常是 JQuery 中的单行）。

只需使用普通的 Django 视图和模板来创建您的响应。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-28T05:05:40.283

目前 Django 只是一个服务器端框架。因此，您将需要使用一些 Javascript 框架来帮助您完成此任务。

诸如 JQuery 之类的框架有一个 .load() 方法，您可以在其中将 HTML 插入 DOM，您可以从 Django 视图中获取任何响应、字符串消息或复杂的 HTML 并将其嵌入到您的页面中。

```
------ HTML ------
<div id="message"></div>
<input class="button" value="Get message"/>

------ Javascript -------
$("input").click(function(){
  $("#message").load("/get_message/");
});

------ Django view ------
def get_message(request):
  return HttpResponse("Your message") 
```

简短的回答，没有等价物，你必须自己写。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-27T06:45:21.737

我在 Django 中没有任何东西可以通过视图函数（服务器端代码）控制页面的特定部分。

您可以在视图函数中做的最接近的事情是返回纯文本而不是 html（或者，返回 JSON 格式的数据），然后您必须在发送请求的模板文件（显示 html）中使用 Javascript，并在接收到响应，决定要操作 DOM 的哪些部分（或要执行哪些其他操作）

**更新**

如果你习惯用这种方式编程，你可能会考虑写一个小的 javascript 框架来处理这样的典型任务，

（实际上我开始喜欢这个想法，可能会自己实现它！！）

# .net - 缓存命中时 HttpWebRequest 不返回响应流，并且 AllowAutoRedirect == false

> ID：482490
> 
> 赞同：0
> 
> 时间：2009-01-27T06:39:27.787
> 
> 标签：.net, caching, httpwebrequest

我有一个 HttpWebRequest，已将 CachePolicy 设置为 CacheIfAvailable，并将 AllowAutoRedirect 设置为 false。现在当缓存命中时，HttpWebResponse.Status == NotModified，并且没有响应流。我需要知道缓存的响应是什么！

如果我将 CachePolicy 设置为 BypassCache，它就可以正常工作。但我需要缓存这些结果。

谁能告诉我在缓存命中的情况下如何检索缓存的响应？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-15T06:44:45.080

事实证明，问题在于我正在设置 HttpWebRequest.IfModifiedSince （对其自身）。是的，该属性的 getter 设置为始终返回 DateTime.Now，直到它被明确设置。所以：request.IfModifiedSince = request.IfModifiedSince; 不是一个安全的无操作。它实际上设置了一个标志，表示实际发送 If-Modified-Since HTTP 标头，这让我很伤心。

# drop-down-menu - 项目未在下拉列表中选择

> ID：482492
> 
> 赞同：1
> 
> 时间：2009-01-27T06:40:45.990
> 
> 标签：drop-down-menu

我的 asp.net 页面上有一个下拉列表。当我在下拉列表中选择一个项目时，即使我将 autopostback 设置为 true，它也会转到下拉列表的第一项。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-27T06:47:09.143

你确定你没有重新绑定 PostBack 上的列表吗？

# delphi - 获取TChart中XY点的TChartSeries

> ID：482497
> 
> 赞同：1
> 
> 时间：2009-01-27T06:44:14.877
> 
> 标签：delphi, charts, delphi-7, teechart

我正在使用**Delphi 7 附带的 TChart 控件，**并希望**在鼠标指针下获得线/栏的系列和值#。**

我知道 OnClickSeries 事件提供了很好的信息，但是当我将***鼠标悬停*****在一个系列上****时我真的想要这些信息***。*

 *编辑：我在 TChart 上找到了一个最热门的方法，它适用于一个图表中的任何系列类型和多个系列，所以我发布了这个并使其成为我接受的答案。特别感谢 GameCat 的努力。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-27T07:36:32.587

您可以检查 OnChartMouseMove（或 OnSeriesMouseMove）

```
procedure TForm5.Chart1MouseMove(Sender: TObject; Shift: TShiftState; X,
  Y: Integer);
var
  i : Integer;
begin
  i := Series1.CalcClickedPie(x,y); // i = index of checked data -1 for none
  Memo1.Lines.Add(IntToStr(i));
end; 
```

好吧，我的错，酒吧的代码是不同的（甚至更容易）：

```
procedure TForm5.Chart1MouseMove(Sender: TObject; Shift: TShiftState; X,
  Y: Integer);
var
  i : Integer;
begin
  i := Series1.GetCursorValueIndex;
  Memo1.Lines.Add(IntToStr(i));
end; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-05T01:07:03.827

我终于发现这种方法适用于图表中的多个系列（甚至不同类型）。

```
TChart.CalcClickedPart(Pos: TPoint; Var Part: TChartClickedPart); 
```

该方法填充 TChartClickedPart 记录，该记录包含以下详细的命中测试信息：

```
TChartClickedPart = record
  Part : TChartClickedPartStyle;
  PointIndex : Integer;
  ASeries : TChartSeries;
  AAxis : TChartAxis;
end; 
```

这包括 Series 和 ValueIndex (PointIndex)，这正是我想要的。

# language-agnostic - 需求的频繁变化是否会导致意大利面条式的代码？

> ID：482506
> 
> 赞同：8
> 
> 时间：2009-01-27T06:50:16.953
> 
> 标签：language-agnostic, methodology

如果需求经常变化，并且您希望及时交付代码，那么用于克服意大利面的最佳解决方案或方法是什么？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-01-27T07:10:21.127

你对意大利面条代码的定义是什么？对我来说，意大利面条式代码是一种太长、非结构化和混乱的方法/功能。这不是由于需求的变化，而是由于开发人员的懒惰。如果你因为事情发生了变化而不得不重写一个方法，你也可以直接清理它而无需太多开销。

如果您的意思是设计不良的对象结构，那您可能是对的。如果需求变化太快，您将很容易得到不再执行其预期用途的类、错误的对象层次结构等。

有一些技巧可以避免这种情况：

*   一开始不要过度设计。尽量使您的方法、类和类层次结构尽可能简单，以降低更改难度。

*   在需求发生变化后，不要立即开始实施，而是退后一步，看看你的代码结构是否需要在新功能适应之前进行更改。

*   与您的客户沟通，更改需要一些时间。如果您知道他们知道更改需求也意味着更改代码结构，那么您将代码压缩到现有结构中的压力就会更小。

*   始终在编码时进行重构。以我的经验，像将冗余代码从几个地方移动到一个方法或类中这样的小重构最有效地保持你的代码干净。时刻注意代码异味并尽快消除它们，以使您的工作更轻松。这需要一些经验，但现在是开始训练的最佳时机 :-)

*   就像 krosenvold 所说，通过在代码中添加测试用例来消除您对重大更改的恐惧，从而确保安全。我自己曾在大型遗留系统上工作过，我知道这种恐惧以及在没有安全网的情况下工作的感觉。当您首先在安全网上工作时，进行必要的更改就不再是冒险了。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-27T07:00:11.317

我认为关键点之一是编写易于更改的代码。这通常有利于具体而不是抽象。还有一些设计模式倾向于通过您的代码构建非常大的支柱。这样的支柱倾向于在错误的地方进行更改，因为您害怕更改您真正应该更改的那些重要的核心代码部分。

测试覆盖率是让您进行无畏重构的真正好帮手。降落伞使疯狂的试飞员和理智的试飞员区分开来。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-27T07:00:30.957

良好的测试覆盖率是防止频繁更改的最佳方法。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-27T07:22:17.967

1.  预测变化，如果/当你可以，如果可能的话概括需求
2.  更重要的是，预测更改之间的时间
3.  将工作/功能/迭代分块，以便它们可以在更改之间的时间内完成
4.  瞧！你现在正在做敏捷，不断变化似乎很正常 8-P
5.  服用阿司匹林，对老板发牢骚，回到#1 ;-)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-01-27T07:38:40.710

频繁更改项目需求，包括添加或删除功能，*不一定*会导致意大利面条式代码，但如果您不编写**模块化软件**，则可能会出现这种情况（请参阅[模块化编程](http://en.wikipedia.org/wiki/Modularity_(programming))）。争取的事情包括以下几点：

*   每个模块（无论是函数、类、库还是完整的应用程序）都有**明确定义的用途**。
*   理想情况下，每个模块的大小**不超过**满足其定义目的所需的大小。
*   模块是**松散耦合**的，这意味着它们可以替换其他模块而不会导致软件中断。
*   模块可以单独**进行测试**，以验证它们是否可以无误地发挥作用。
*   模块的**组织**方式有助于使问题域对其他程序员来说是直观的。

给定组织良好的模块（同样，这些可以是函数、类、库和完整的应用程序）在松散耦合的同时协同工作，处理需求变化的方法是编写新模块、扩展现有模块并连接新方式的模块。

至于如何首先拥有这些优秀的软件模块，[重构](http://www.refactoring.com/)是关键。其他实践，例如[单元测试](http://en.wikipedia.org/wiki/Unit_testing)和开发方法（例如[Scrum](http://en.wikipedia.org/wiki/Scrum_(development))）也很有帮助，但重构是你的生计——这是许多业务环境没有足够时间去做的一件事。

有关编写松散耦合代码的好建议，请对[依赖注入](http://en.wikipedia.org/wiki/Dependency_injection)进行一些研究。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-27T07:02:23.077

满足频繁的需求变化是以下目的：

*   面向对象设计（抽象业务领域并将其拆分为可管理的面向目的的概念）
*   设计模式（重用已建立的编码解决方案）
*   基于MVC的开发（数据、业务逻辑和视图/表示分离）
*   基于架构框架的开发（在提交任何特定于项目的设计和开发之前，您首先设计一个架构框架）

因此，如果您想避免意大利面，请学习并应用上述概念。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-27T07:10:36.477

对于任何要求，设计您的代码以实现最大可能的更改。这可以通过将不变部分与可变部分分开来完成。在开发之前这不会花费太多时间。意大利面条代码大部分时间是由于需求变化而出现的，您的设计和编程应该能够承受它。

[http://www.dreamsongs.org/Files/DesignBeyondHumanAbilitiesSimp.pdf](http://www.dreamsongs.org/Files/DesignBeyondHumanAbilitiesSimp.pdf)会有所帮助。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-27T08:14:56.673

范围蔓延/不良需求分析（不断变化）：

像瘟疫一样避免它是人们可以提供的保证任何质量（代码或其他）的最佳建议，无论您尝试如何计划开发项目，它都会（在所有方面）产生负面影响。

最好的解决方案是设置里程碑并知道何时向不断更改需求的人显示[此链接。](http://www.ibm.com/developerworks/rational/library/4291.html)

您可以在您的方法中成为超级人类，开箱即用地思考并使代码尽可能容易更改，但是如果您只是对所有功能说“是”而不了解这将如何影响项目的质量时间，您仍然会失败-范围金字塔。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-01-27T08:51:43.463

频繁变化的需求是开发敏捷方法来处理的一个问题——它们的创建至少部分是为了认识到需求*确实会*改变的问题，通常是有很好的理由。

如果您尚未实施的需求更改，那么如果您不在前期设计上投入太多精力，而是通过小迭代、持续测试和重构来管理设计演变，那么影响应该是最小的。

如果已经实施的需求发生了变化，而您无法更改完成日期，那么您有三种选择：延长工作时间以弥补损失的时间、放弃需求（缩小范围）以支付额外工作的费用，或降低质量产品（可能是“意大利面条”选项）。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-01-27T11:25:37.007

如果你带着一个建议离开：**重构，重构，重构！经常！**

其他一切都是关于使重构更容易的细节。

# c# - 生成 C# 委托方法存根

> ID：482510
> 
> 赞同：1
> 
> 时间：2009-01-27T06:55:20.377
> 
> 标签：c#, delegates, stub, auto-generate

有人知道如何自动创建委托存根方法吗？

在 WPF 中，我似乎经常不得不传递代表。我希望能够键入一个不存在的方法名称并自动生成一个方法存根……目前我不得不不断地引用文档来获取委托签名，然后手动创建具有匹配签名的方法。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-27T06:59:23.767

使用像 Refactor Pro 这样的 IDE 插件！它还允许您将委托转换为实例方法，或者如果它是单行的，则转换为 lambda。我倾向于使用 lambda 开始输入，然后将光标悬停在参数上会为您提供可用的类型。

或者。等到 Visual Studio 10 将所有这些都内置。但在那之前使用上述任何一个:)

# jquery - 如何制作像“美味”和“谷歌”这样的下拉菜单？

> ID：482524
> 
> 赞同：5
> 
> 时间：2009-01-27T07:07:27.760
> 
> 标签：jquery, css, menu, drop-down-menu

我想在这个[http://delicious.com/search?context=all&p=sql&lc=1](http://delicious.com/search?context=all&p=sql&lc=1)页面上制作一个像delicious 一样的下拉菜单。在此页面中，单击带有“搜索”按钮的箭头。单击它会显示一个下拉菜单，我想要相同的菜单样式，但是在我的页面上我有一个链接，我想要该链接的内容将显示一个简单的小图标，然后单击该链接或该菜单图像，下拉菜单将打开。

谷歌也做了同样的事情，[http://www.google.co.in/firefox?client=firefox](http://www.google.co.in/firefox?client=firefox-a&rls=org.mozilla:en-US:official) -a&rls=org.mozilla:en-US:official点击顶部菜单中的“更多”链接显示。

我想使用最少的 javascript，我更喜欢 JQUERY。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-01-27T07:31:35.093

有很多 JQuery 插件可以创建一个下拉列表（菜单），比如美味。
您可以使用：

1.  [菜单](http://jdsharp.us/jQuery/plugins/jdMenu/)
2.  [带有 jquery 的下拉菜单](http://ayozone.org/2008/02/06/drop-down-menu-with-jquery/#)
3.  [免费的 CSS 下拉菜单框架](http://www.lwis.net/free-css-drop-down-menu/)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-27T09:00:25.677

对于这样的菜单，我总是推荐[Suckerfish 之子。](http://www.htmldog.com/articles/suckerfish/dropdowns/)仅限 CSS，因此它甚至适用于没有脚本的用户，并且非常轻巧且快速。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-10-09T06:59:16.557

这是创建谷歌顶部导航菜单的教程

[http://blog.geotitles.com/2011/09/creating-the-new-top-black-bar-found-in-google-and-all-its-products/](http://blog.geotitles.com/2011/09/creating-the-new-top-black-bar-found-in-google-and-all-its-products/)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-02-16T10:17:26.620

您可能会发现这个 jQuery UI 插件很有用 - [http://filamentgroup.com/lab/jquery_ui_selectmenu_an_aria_accessible_plugin_for_styling_a_html_select/](http://filamentgroup.com/lab/jquery_ui_selectmenu_an_aria_accessible_plugin_for_styling_a_html_select/)

它在构建时考虑了渐进增强。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-27T08:56:44.903

最简单的方法是在 Javascript 中设置菜单。有许多可用的 Javascript 库可以使这更容易。一些比较流行的包括：

*   [雅虎用户库](http://developer.yahoo.com/yui/)
*   [道场](http://dojotoolkit.org)
*   [jQuery](http://jquery.com)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-28T01:32:18.123

您可以[尝试](http://dev.iamntz.com/10/playing-with-lists)使用一些列表。这是我博客上的一篇较早的文章，关于如何使用列表和一些 jquery 制作一个漂亮的面包屑。

# svn - 我正在为远程服务器寻找像“VisualSVN 服务器”这样的 svn 管理员？

> ID：482526
> 
> 赞同：0
> 
> 时间：2009-01-27T07:08:19.350
> 
> 标签：svn, admin, visualsvn-server

我正在寻找 svn admin 一个桌面应用程序，如“VisualSVN 服务器”，仅用于远程服务器 svn 服务器将在 Linux 上运行，但我需要管理工具在我的窗口匹配本地运行，我将无法创建用户组和更改安全性设置创建新的存储库，而不是通过编写命令

有这样的工具吗？如果是的话，你推荐哪一个谢谢

如果很难理解，我只想能够远程管理颠覆服务器，再次感谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-27T07:12:22.963

好吧，如果您可以访问目录，则创建新的存储库非常容易（与[tortoise svn](http://tortoisesvn.tigris.org)一起工作非常好-只需创建一个目录-从 tortoise svn 菜单在此处创建存储库-您就完成了。

另一方面，如果没有全能的 ssh（和 shell）的帮助，我没有解决方案来创建用户组和更改 linux 服务器上的安全设置

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-27T07:42:38.003

我必须说我很难理解你的问题，让我觉得你不确定你想要 svn，而是一个源代码控制/版本工具，你可以在独立的开发机器上使用它......（如果是的话 google Git )

更新：好的，现在我明白你想要什么了：这是一个快速简单的[svn 管理器](http://svnmanager.sourceforge.net/)

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-01-27T15:26:56.630

没有 Apache，试试[svnserve](http://svnbook.red-bean.com/en/1.0/ch06s03.html)

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-02-10T11:46:34.743

没有像我在列表中寻找的桌面应用程序不是免费的

# php - PHP 数组的 CS 定义是什么？

> ID：482540
> 
> 赞同：2
> 
> 时间：2009-01-27T07:22:01.977
> 
> 标签：php, data-structures, computer-science

从严格的实现和计算机科学的角度来看，您将如何对 Php 数组数据结构进行分类？它是一个关联数组吗？哈希？一本字典？... ?

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-27T09:52:03.700

从[PHP 手册](http://uk3.php.net/manual/en/language.types.array.php)：

> PHP 中的数组实际上是一个有序映射。映射是将值与键相关联的类型。这种类型针对几种不同的用途进行了优化；它可以被视为数组、列表（向量）、哈希表（映射的实现）、字典、集合、堆栈、队列等等。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-27T10:47:32.917

好吧，这取决于您希望如何对其进行分类。我会选择按操作性能分类。

例如，计算机科学术语中的真实数组的查找时间为 O(1)，而链表的查找时间为 O(n)。插入和删除在链表中是 O(1)，而在数组中是 O(n)。

我不确定 PHP 数组的实际性能是什么，但是如果您测量它们的一些基本操作并将它们与“真正的计算机科学数据结构”的预期进行比较，您应该能够对其进行分类。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-27T07:42:46.270

在我看来，定义它有点困难。虽然，我认为我会将其归类为关联数组，因为大多数为关联数组定义的操作都可用于 PHP 数组。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-27T17:04:07.837

这取决于您真正想要定义的内容。*字典*或*映射*是指数据类型的行为，而*哈希映射*是指其特定实现。术语*数组*有点色彩 - 严格来说，它指的是具体实现，而*列表*是指任何类似数组的数据类型的通用术语。然而，使用*array*作为*list*的同义词是很常见的。

# jakarta-ee - 实际学习 Java EE 的最佳方法是什么？

> ID：482543
> 
> 赞同：4
> 
> 时间：2009-01-27T07:23:42.657
> 
> 标签：jakarta-ee

在学习 Java EE 概念的同时开始构建一个好的 Web 应用程序，这样这些概念可以实际应用吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-27T07:39:58.850

看看[这个](https://stackoverflow.com/questions/291279/getting-started-with-j2ee)和[这个](https://stackoverflow.com/questions/276245/which-book-would-you-recommend-for-entering-into-the-j2ee-world)问题。我建议从寻找一本或多本适合您需要的书开始。您不仅需要学习 SUN 技术（JSP、servlet、模板），还需要一些开源框架（MVC、IoC、ORM）。有许多以网站为例的书籍。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-06-20T21:46:08.677

从大量阅读开始，像这样 -

[http://download.oracle.com/otndocs/jcp/javaee-6.0-fr-eval-oth-JSpec/](http://download.oracle.com/otndocs/jcp/javaee-6.0-fr-eval-oth-JSpec/)

[http://www.lulu.com/items/volume_63/821000/821310/2/preview/978-1-4116-6824-9-preview.pdf](http://www.lulu.com/items/volume_63/821000/821310/2/preview/978-1-4116-6824-9-preview.pdf)

[http://en.wikipedia.org/wiki/Java_Platform,_Enterprise_Edition](http://en.wikipedia.org/wiki/Java_Platform,_Enterprise_Edition)

然后在eclipse中做一个简单的Java EE。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-27T07:40:14.293

大多数书籍都使用购物车示例来说明 Java EE 概念和 Java EE 规范的各种特性。我认为这是一个足够好的 Web 应用程序，可以开始学习 Java EE 概念。也很实用。

# java - 如何在 swing GUI 中跳转到下一页/上一页

> ID：482547
> 
> 赞同：1
> 
> 时间：2009-01-27T07:25:30.033
> 
> 标签：java, swing

我是 Swing 的新手。我正在尝试使用 Swing 开发应用程序。我设法创建了我的应用程序的第一页。现在我想做的是使用下一个按钮遍历到一个新页面。但我无法找到使用 Swing 的方法。此外，如果我单击上一个按钮，我是否能够获取我在文本框中输入的数据或使用上一页上的单选按钮选择的数据。我认为这在 Struts 中可以很容易地完成，但是如何使用 Swing 来实现。

请帮忙。

非常感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-27T07:49:15.290

我假设您正在尝试构建一个向导式的摆动对话框？swing 没有为此类任务提供开箱即用的框架（但当然它提供了您需要创建的所有 UI 元素/控件）。只需在谷歌上搜索“swing 向导框架”，您就会发现很多灵感——不幸的是，我不能推荐一个最好的（在我的公司，我们已经编写了自己的），但我相信你会找到一个这对你有用，或者你会熟悉一些有助于你自己写的模式——祝你好运！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-27T08:43:17.023

这是旧的，但可能只是让你开始：http: [//java.sun.com/developer/technicalArticles/GUI/swing/wizard/](http://java.sun.com/developer/technicalArticles/GUI/swing/wizard/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-27T13:47:50.823

您可以创建不同的视图，例如“登录”、“配置”、“主页”。视图将包含您要在屏幕上显示的所有组件。您可以实现一个可以处理此视图的 ViewManager（显示其中一个视图）。

在主框架的底部，您可以添加一个按钮区域，其中放置了前进/后退按钮。在框架的中心，您将显示视图。

当按钮被选中时，ViewManager 决定将哪个视图设置为可见。从 ViewManager 中，您可以从所需的视图中获取所有信息。

视图可以进入 ViewManager 并可以从另一个视图中获取它们需要的信息。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-27T18:55:05.337

尝试使用选项卡式窗格或使用 CardLayout。

*   [http://java.sun.com/docs/books/tutorial/uiswing/components/tabbedpane.html](http://java.sun.com/docs/books/tutorial/uiswing/components/tabbedpane.html)
*   [http://java.sun.com/docs/books/tutorial/uiswing/layout/card.html](http://java.sun.com/docs/books/tutorial/uiswing/layout/card.html)

# c++ - 如何在给定自定义 IDL 的情况下编写代码生成器？

> ID：482550
> 
> 赞同：1
> 
> 时间：2009-01-27T07:26:20.983
> 
> 标签：c++, code-generation, idl

如果您有一个包含基本布尔字符串字段的足够简单的模式，那么如何在 C++ 中编写代码生成器。如果你曾经写过，你是如何开始的。欢迎文章/推荐。

编辑：请注意，这不是标准的 CORBA idl。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-27T08:38:15.957

总之：

1.  手动转换一些东西，
2.  将该输出复制到字符串文字中，然后
3.  使用循环和变量而不是固定名称进行概括。

这是使用 TDD 解决的一个特别好的问题 - 首先设置一个框架，例如 CPPUnit（或[许多替代方案之一](https://stackoverflow.com/questions/387272/unit-testing-in-c)），并使用*愚蠢的简单*测试来确保您可以加载文件并通过写出文件来迭代其内容。

非常渐进地接近解决方案 - 获得一些简单和通用的输出，通过测试确认它有效，然后添加更复杂的变体。eg：先处理单参数函数。

对于中等复杂度的代码，只需使用标准 C++ ostream 类编写一长串输出语句，这将允许您编写大量混合文字与任何变量的代码。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-03T17:41:49.447

不幸的是，您的问题缺少有关您要生成的确切内容的详细信息。但是，我会尝试一下，并建议您查看 C++ boost 库精神 ( [http://spirit.sourceforge.net](http://spirit.sourceforge.net) )。使用 Spirit，您可以创建解析器。因此，假设您已经为您的 DSL（领域特定语言 - 您的 IDL）编写了一个精神解析器，在解析您的 IDL 文件后，您将获得一个 AST（抽象语法树），您可以使用访问者模式并创建适当的访问者您可以生成所需的任何输出，例如生成代码。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-27T08:20:26.240

[Comet](http://www.lambdasoft.dk/comet/index.htm)是一个很好的实现 COM 的库。

# java - 如果你在一个 jar 中运行 java，你能在运行时告诉你吗？

> ID：482560
> 
> 赞同：45
> 
> 时间：2009-01-27T07:32:50.173
> 
> 标签：java, jar

我有一个应用程序，我的一些用户从 Eclipse 运行，而其他用户使用 jar 文件运行它。

我希望在从 jar 中运行时执行一些操作，但我不希望在从 Eclipse 中运行时执行它们。

有没有办法在运行时知道当前应用程序是否从 jar 中运行？

谢谢！

迪克拉

* * *

## 回答 #1

> 赞同：44
> 
> 时间：2009-01-27T07:38:39.180

好吧，您可以判断一个类是否已从 JAR 文件加载 - 使用`Foo.class.getResource("Foo.class")`并查看返回的 URL 是否以“jar:”开头

例如，以这个程序为例：

```
public class Foo {

    public static void main(String[] args) {
        System.out.println(Foo.class.getResource("Foo.class"));
    }
} 
```

运行它从文件系统加载文件：

```
file:/C:/Users/Jon/Test/com/whatever/Foo.class 
```

从 jar 文件运行它：

```
jar:file:/C:/Users/Jon/Test/foo.jar!/com/whatever/Foo.class 
```

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2017-12-09T03:57:10.377

我有两个更好的解决方案。第一的：

```
URL url = this.getClass().getClassLoader().getResource("input.txt");
URLConnection urlConnection = url.openConnection();
if (urlConnection instanceof JarURLConnection) {
    // run in jar
} else {
    // run in ide
} 
```

第二：

```
String protocol = this.getClass().getResource(this.getClass.getName() + ".class").getProtocol();
if(Objects.equals(protocol, "jar")){
    // run in jar
} else if(Objects.equals(protocol, "file")) {
    // run in ide
} 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-01-27T07:51:57.547

您可以检查 Equinox 启动器的系统类路径属性：

```
if (System.getProperty("java.class.path").contains("org.eclipse.equinox.launcher")) {
    System.out.println("You're running inside Eclipse");
} 
```

您可以检查一些其他潜在属性，您可以在 Eclipse 中通过`Help -> About -> Configuration Details`.

如果您想知道是从 JAR 运行还是从一堆类文件运行，Jon 的回答很好。但是，如果您在这两种情况下都使用 JAR，那么它不会告诉您您需要什么。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-01-27T07:46:44.920

从[操作方法](http://www.rgagnon.com/javadetails/java-0391.html)

```
package com.rgagnon;

public class HelloClass {
 public static void main(String[] args) {
    new HelloClass().say();
 }

 public void say() {
   String className = this.getClass().getName().replace('.', '/');
   String classJar =  
     this.getClass().getResource("/" + className + ".class").toString();
   if (classJar.startsWith("jar:")) {
     System.out.println("*** running from jar!");
   }
   System.out.println(classJar);
 }
} 
```

会给：

```
>jar cvfm Hello.jar manifest.mft com\rgagnon\HelloClass.class
added manifest
adding: com/rgagnon/HelloClass.class (in=1059) (out=601) (deflated 43%)

>java com.rgagnon.HelloClass
file:/C:/DEV/WORK/JAVA/com/rgagnon/HelloClass.class

>java -jar Hello.jar
*** running from jar!
jar:file:/C:/DEV/WORK/JAVA/Hello.jar!/com/rgagnon/HelloClass.class 
```

* * *

[正如Hosam Aly](https://stackoverflow.com/questions/482560#482587)所指出的，这并不能完全回答这个问题。
我把它留在那里作为一般参考，作为维基答案。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2015-09-24T16:03:13.903

如果您[查询`JAR`文件名](https://stackoverflow.com/a/11159435/3764804)，它将在从`JAR`文件运行时起作用，否则它将返回类似`classes`的内容，因此可以使用以下代码：

```
import java.io.File;

public class JarUtilities
{
    public static String getJarName()
    {
        return new File(JarUtilities.class.getProtectionDomain()
                                .getCodeSource()
                                .getLocation()
                                .getPath())
                       .getName();
    }

    public static boolean runningFromJar()
    {
        return getJarName().contains(".jar");
    }
} 
```

**编辑：**

如果您需要更高的准确性并抵制重命名文件扩展名，请检查文件是否包含`MANIFEST.MF`应该工作：

```
public static boolean runningFromJAR()
{
    try
    {
        String jarFilePath = new File(JarUtilities.class.getProtectionDomain()
                .getCodeSource()
                .getLocation()
                .getPath()).
                toString();
        jarFilePath = URLDecoder.decode(jarFilePath, "UTF-8");

        try (ZipFile zipFile = new ZipFile(jarFilePath))
        {
            ZipEntry zipEntry = zipFile.getEntry("META-INF/MANIFEST.MF");

            return zipEntry != null;
        }
    } catch (Exception exception)
    {
        return false;
    }
} 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2012-06-13T02:22:15.847

这是一些您可以正常运行或作为 jar 运行的代码。

```
import java.applet.Applet;
import java.net.URL;
import java.security.CodeSource;

public class TestApplet extends Applet {

    public TestApplet(){    
        URL path = TestApplet.class.getResource("TestApplet.class");

        if(path.toString().startsWith("jar:"))
            System.out.println("I'm in a jar");
        else
            System.out.println("I'm not in a jar");
    }

    public static void main(String args[]) throws Exception{
        new TestApplet();
    }
} 
```

要将其放入 jar 中并运行它，请使用以下命令：

```
jar cf test.jar TestApplet.class
java -cp test.jar TestApplet 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-01-27T08:03:29.147

另一种方法是将信息放入清单文件中，并测试该信息在运行时是否可用。

如果是，则代码以“-jar”开头。否则，它会以另一种方式启动，例如直接从 Eclipse 启动。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-01-27T10:25:19.470

你可以试试：

```
boolean inJar = false;

try
{
  CodeSource cs = DataResolver.class.getProtectionDomain().getCodeSource();
  inJar = cs.getLocation().toURI().getPath().endsWith(".jar");
}
catch (URISyntaxException e)
{
e.printStackTrace();
} 
```

如果您从 jar 文件运行，则 cs.getLocation().toURI() 将为您提供该文件的 URI；如果您从 Eclipse 内部运行，那么它可能是包含您的类文件的目录的路径。

# design-patterns - 处理 IOC 中的循环依赖

> ID：482575
> 
> 赞同：11
> 
> 时间：2009-01-27T07:44:42.117
> 
> 标签：design-patterns, inversion-of-control

我正在尝试使用 IOC 容器在我的应用程序中创建初始对象图。

我有一个主窗体。此表单依赖于一个 MenuStrip，该 MenuStrip 依赖于多个 MenuStripItem。一些 MenuStripItems 依赖于 MainForm。

目前我为构造函数注入设置了所有依赖项。显然，现在解析 MainForm 会导致堆栈溢出，因为 MainForm 的 MenuStripItem 依赖项会尝试解析 Mainform 等...

解决这种循环依赖的最佳方法是什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-27T08:02:08.680

循环依赖是糟糕设计的标志，无论您是否使用 IoC。我建议您重新设计以避免它。添加辅助对象可能是一种解决方案。

例如，使 MenuStripItems 仅依赖于它们所必需的 MainForm 的一部分，而不是全部。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-27T09:11:11.147

您可以使用 setter 在构造后注入一些依赖项。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2010-04-13T06:53:41.447

我同意kgiannakakis：

> 循环依赖是糟糕设计的标志，无论您是否使用 IoC。我建议您重新设计以避免它。添加辅助对象可能是一种解决方案。

要找出应将哪些方法提取到帮助程序类中，此过程可能会有所帮助：

假设您有一个 A 类和一个 B 类，它们相互引用并创建一个循环依赖项。要找出要提取到外部帮助器对象中的方法，请列出类 A 使用的类 A 中的所有方法，以及类 A 使用的类 B 中的所有方法。这两个列表中较短的是隐藏的帮助器C类。

灵感来自 Miško Hevery [http://misko.hevery.com/2008/08/01/circular-dependency-in-constructors-and-dependency-injection/](http://misko.hevery.com/2008/08/01/circular-dependency-in-constructors-and-dependency-injection/)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-01-27T08:06:49.343

创建一个控制器类，提供 MainForm 和 MenuStripItem 都需要避免循环引用的数据和逻辑。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2017-10-30T07:20:01.823

您需要创建一个**经销商**类（或接口），其中包含您正在使用的两个类的引用。您应该使用这个**经销商**类（或接口）而不是您之前尝试使用它们的每个引用类。

**解释解决方案：**
考虑以下 3 个类：

```
public Class A {
    public Method CommonMethod(){
        //Some implementation...
    }

    Method C(){
        //CommonMethod form class B are using here
        B obj = new B();
        B.CommonMethod();
    }
}

public Class B {
    public Method CommonMethod(){
        //Some implementation...
    }

    Method D(){
        //CommonMethod form class A are using here
        A obj = new A();
        A.CommonMethod();
    }
}

public Class DealerClass {
    private readonly A _inctanceA;
    private readonly B _inctanceB;

    //Cunstructor method of the class
    DealerClass(A inctanceA, B inctanceB){
        _inctanceA = inctanceA;
        _inctanceB = inctanceB;
    }

    //Using CommonMethod of class A
    public UsingCommonMethodA(){
        _inctanceA.CommonMethod();
    }

    //Using CommonMethod of class B
    public UsingCommonMethodB(){
        _inctanceB.CommonMethod();
    }    
} 
```

因此，根据此解决方案，您应该在***`DealerClass`***.

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-27T09:12:16.230

我看不到创建帮助程序类或控制器如何解决循环依赖问题。

我会提供更多细节。MenuStripItems 依赖于 MainForm，因为它们可以设置 MainForm 的内容。按照上述建议，假设我为 MainForm 内容 IFormContent 创建了一个单独的接口。然后 MenuStripItem 可以依赖于 IFormContent。但是 IFormContent 的实现将再次依赖于 MainForm，从而导致循环依赖。

也许我应该在某个地方使用 setter 注入而不是构造函数注入？

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-10-27T22:03:40.387

MenuStrip 和 MenuStripItems 是如何创建的？

当我使用 IOC 时，服务与 IOC 容器为服务提供的依赖项之间始终存在一对一的关系。如果一项服务需要不止一项，那么它将与创建多个项目的单个工厂对象建立一对一的关系。这个工厂方法可以被参数化以允许创建的项目引用回它们的容器。

# asp.net - asp.net 用什么代替 viewstate

> ID：482581
> 
> 赞同：4
> 
> 时间：2009-01-27T07:47:28.303
> 
> 标签：asp.net, viewstate

目前我正在使用视图状态来存储我在分页数据时所在的当前页码。我在页面上有 3 个控件，其中包含可以翻页的数据。

到目前为止，跟踪页码的最简单方法是视图状态，但它变得非常大，我不知道为什么。

所以我想用别的东西来跟踪页码，但我不知道该用什么。我应该将其嵌入为隐藏的表单字段吗？在查询字符串中传递它？其他好的选择？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-27T09:24:20.370

您说您正在使用视图状态来存储当前页码，因此我猜您正在将该数字显式存储在视图状态中。

但是，asp.net 默认会在视图状态中存储*大量数据。*在您的示例中，启用了分页的 3 个控件，asp.net 将存储“控件中的所有数据”，即当前显示在 3 个控件中的所有数据都将存储在视图状态中。

对此的解决方案可能是明确关闭 3 个分页控件上的“关闭”视图状态，不幸的是，这意味着您必须在每个页面加载时重新绑定控件，这可能是您的选择，也可能不是。

如果您只需要存储页码，您可以例如将其移动到控制状态，如[msdn](http://msdn.microsoft.com/en-us/library/1whwt1k7.aspx)和[复数视图](http://www.pluralsight.com/community/blogs/fritz/archive/2004/07/01/472.aspx)中所述。

使用另一个答案中建议的查询字符串。

或者您可以继续使用视图状态，然后继续关闭整个页面或仅分页控件的视图状态，无论对您有用。

我真的建议阅读Mrunal Brahmbhatt 的《[真正理解视图](http://mrunal.blog.co.in/2008/10/08/truly-understanding-viewstate/)状态》，以获得对视图状态的深入解释。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-27T09:59:47.897

由于 HTTP 的无状态特性，很难选择实际存储状态的位置。在您的示例中，我将考虑以下内容而不是视图状态：

1.  **查询字符串**- 页码足够小，可以很好地适合那里。
2.  **Cookies** - 在这种情况下，您的数据将持续更长时间，并将在所有 GET 和 POST 请求中存活。
3.  **会话**- 几乎类似于前一个选项，但数据将存储在服务器上。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-27T07:58:47.360

在 ViewState 中存储页码不应该占用太多空间，所以我认为你应该解决问题的根源。

在 ASP.Net 中，默认情况下每个控件的 ViewState 都是打开的。因此，带有静态文本的简单标签将占用 ViewState 中的空间。关闭它会有很大帮助。

看看这两篇文章，它们在过去帮助了我很多：

[http://www.webreference.com/programming/asp/viewstate/](http://www.webreference.com/programming/asp/viewstate/) [http://www.webpronews.com/expertarticles/2005/11/07/optimize-aspnet-pages-by-reducing-the-size-of-视图状态](http://www.webpronews.com/expertarticles/2005/11/07/optimize-aspnet-pages-by-reducing-the-size-of-the-viewstate)

您正在使用哪个版本的 ASP.Net？ASP.Net 2.0 的 ViewState 比 1.1 小很多。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-27T07:51:01.340

在查询字符串中传递它是一个不错的选择，这使得它“可破解”并且有利于 SEO。所以对于页码，除了网址，我永远不会考虑其他任何东西！

# java - 如何从文件 URI 中提取文件名并为其创建链接？

> ID：482589
> 
> 赞同：8
> 
> 时间：2009-01-27T07:57:54.400
> 
> 标签：java, filepath

我的问题是::

从像“/usr/folder1/folder2/filename.ext”这样的字符串

*   我必须提取文件名仅用于显示（仅 filename.ext）。
    *   我的问题是我应该怎么做？拆分“/”并取最后一个元素是一种方法，但对我来说并不好闻。
*   我必须创建一个使用文件的 URI 作为目标的超链接。这将类似于 file://domain.com/usr/folder1/folder2/filename.ext

我查看了 java.net 中的 URI 和 URL 接口，但在那里找不到任何有用的东西。

此外，在某些情况下，我的文件路径可以包含 COMMA、SPACE 等（Windows 文件夹）。因此，在提出任何想法时请记住这一点。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-01-27T08:15:48.060

你可以尝试这样的事情：

```
File file = new File("/usr/folder1/folder2/filename.ext");
System.out.println(file.getName()); 
```

如果文件不存在，我不确定这是否可行，但刚刚尝试过，它似乎可以正常工作。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2014-03-14T11:49:48.413

[CommonsIO](http://commons.apache.org/proper/commons-io/)针对这个问题提供了解决方案：[`FilenameUtils.getName()`](https://commons.apache.org/proper/commons-io/javadocs/api-release/org/apache/commons/io/FilenameUtils.html#getName%28java.lang.String%29)，返回文件名+扩展名。

```
String filename = FilenameUtils.getName("/usr/folder1/folder2/filename.ext");
System.out.println(filename); // Returns "filename.ext" 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-27T08:06:04.570

你应该看看[File 类](http://java.sun.com/javase/6/docs/api/java/io/File.html)。特别是对于[getName()](http://java.sun.com/javase/6/docs/api/java/io/File.html#getName())方法。

# delphi - 将配置传递给与应用程序无关的模块的最佳方式是什么？

> ID：482590
> 
> 赞同：1
> 
> 时间：2009-01-27T07:58:20.590
> 
> 标签：delphi, configuration-management

我正在开发一个由多个模块组成的应用程序，这些模块也将用于其他应用程序。这些模块中的每一个都需要一些配置选项，但不应该知道其他模块的选项，也不应该要求其他模块存在。一些设置在模块之间共享。

假设模块 A 需要设置 x 和 y，模块 B 需要设置 y 和 z。

设置存储在注册表或一个或多个 .ini 文件中。

到目前为止，我已经考虑了以下方法：

1.  拥有一个包含在所有模块中的全局单元（“global.pas”），并包含带有设置的全局变量。我不太喜欢这种方法，因为它要求所有应用程序都有这样一个单元，并且它必然会收集大量与原始目的无关的附加代码。所以最终每个应用程序都会有自己不兼容的全局单元。
2.  每个模块都有配置类，其中包含该模块所需的所有设置。这些从应用程序的某个中心点传递到模块，该应用程序还处理读取和写入它们到某种永久形式（例如使用 JvAppStorage）。这需要模块之间进行一些同步，因为某些选项将在它们之间共享，因此如果在一个模块中更改了选项，则此更改必须以某种方式反映在另一个模块的配置中（不一定是实时的，而是下一次模块已初始化）。
3.  具有传递给每个模块的通用配置类，其中包含所有模块的设置作为属性。每个模块只访问它知道的那些设置。这里的问题可能是名称冲突可能会在不被注意的情况下发生。此外，我不喜欢传递模块不需要的配置选项的想法。此外，每个应用程序都将包含不同的模块子集，但最终会包含相同的配置类以及所有可能模块的选项。（这与上面的全局单位方法没有太大区别。）
4.  像上面一样，有一个传递给每个模块的通用配置类。但是模块没有属性，而是通过名称访问它们的设置（在最简单的情况下，这可能是 TCustomIniFile）。这避免了所有应用程序中所有模块的设置，但引入了可能的类型兼容性问题，并且名称冲突可能再次成为问题（除非每个模块都为其选项加上其名称的前缀，但它们不能再共享选项）。

我想每个编写模块化系统的人都面临过这个问题，并找到了一些他们后来坚持使用的解决方案，无论他们是否仍然喜欢它们。我也去过那里，几次，仍在寻找金子弹。

也许其他人已经找到了理想的解决方案？

（这是 Delphi 2007 以防万一。我已经在使用 JCL / JVCL。）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-27T09:21:53.870

我可能会创建一个通用配置类，并让每个模块依赖于一个或多个作为单例的具体配置类。一个模块依赖于具有仅对该模块重要的设置的配置类实例，并且可选地依赖于具有与多个模块相关的设置的一个或多个其他配置类实例。由于配置对象是单例的，共享配置对象的模块会自动获得相同的设置。

您将根据功能创建配置类，而不是根据模块使用情况。模块使用的功能暗示它将需要哪些配置对象。

添加到应用程序的每个模块都将所有需要的配置类作为依赖项添加，其他配置类不会添加。单例配置对象在应用程序启动时将自己添加到此类对象的列表（或注册表，如果您愿意的话）。应用程序本身不需要了解详细信息，只需从持久存储加载和保存设置就足够了。如果需要，它可以 OTOH 使用相同的基础设施。

一般来说，我会根据接口来实现所有东西，而将持久性机制留在外面。因此，您以后可以自由地在 INI 文件、注册表甚至数据库中进行配置（这将为您提供一种实现配置更改历史的简单方法）。我发现自从我开始针对接口而不是类层次结构进行编程以来，我并没有将自己锁定在一种做事方式上。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-27T09:02:32.757

我曾经有过这样的应用程序（用 C++Builder 编写）。我有一个基本模块（BaseClass.BPL），所有其他模块（如 Payment.BPL）都继承自 . 因此，您可以使用基类来读取常用参数并覆盖继承的模块以读取特定设置。

```
void PaymentForm::Readsettings()
{
   BaseClass::ReadSettings(); //to read common stuff
   IniFile->ReadString("Payment Module", "setting1,...); //read specific stuff
} 
```

我将设置保存在 INI 文件中 - 更容易处理该注册表。为了避免与相似名称发生冲突，每个模块在 INI 中使用了不同的部分。

```
[Common]
Datapath=...
Server=...

[MainModule]
setting1=..

[Payment module]
setting1=....
setting3=.... 
```

# c# - 以编程方式限制在服务中运行的线程的 CPU 使用率

> ID：482592
> 
> 赞同：8
> 
> 时间：2009-01-27T08:01:31.350
> 
> 标签：c#, multithreading, windows-services, service

我正在使用 VB9 (VS2008)。

我创建了一个定期索引一些文件夹的 Windows 服务。

有没有办法可以根据当前系统状态设置 CPU 使用率上限，即如果系统空闲，线程可以根据需要使用 CPU，但是如果有其他程序/进程正在运行那么它应该以不会使系统变慢的方式使用 CPU。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-01-27T08:13:38.220

[您可以通过Thread.Priority](http://msdn.microsoft.com/en-us/library/system.threading.thread.priority.aspx)在 .Net 中降低线程的优先级

将其设置为BelowNormal将意味着其他线程将被安排在它前面。

这可能导致线程被饿死，但听起来这是一个可以满足您需求的设计决策。

请注意，由于您正在执行大量磁盘 IO，这实际上将是后台任务的主要影响，并且您可能会发现降低优先级是不够的（因为即使线程受到限制，磁盘 IO 也会部分继续。

检查机器使用情况的监视线程（可选地，仅在至少有一个交互式用户存在时才关心）可以暂停索引（或大大限制 IO）。这在有许多可用内核（和超线程虚拟内核）的现代机器上更为重要，这意味着尽管用户实际上做了很多工作，但存在备用资源来执行您的索引线程而不是真正执行磁盘 IO。

您可能还需要考虑是否检查[电源方案](http://msdn.microsoft.com/en-us/library/aa373182(VS.85).aspx)以确定您是否应该在那个时候运行（因为两个重磁盘访问的电池消耗并不是不可忽视的）

如果您希望做更多的事情来减少从 Vista 开始的 Windows 的后台 IO 绑定任务版本的影响，请添加两个有用的 API：

### [低优先级 I/O](http://www.microsoft.com/whdc/driver/priorityio.mspx)

这允许您的代码以低于其他 I/O 的优先级调度 I/O。

### [Windows 任务计划程序](http://technet.microsoft.com/en-us/appcompat/aa906020.aspx)

您可以使用它来安排在“系统空闲时间”运行的东西。这在系统不忙且用户不存在时。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-15T16:04:02.650

在 XP 上，ShuggyCoUk 是正确的。首先要做的就是简单地将线程优先级降低到 8 以下。这意味着任何其他以 8 或更高优先级运行的线程或进程将始终代替您的线程运行。请注意，我不建议将您的进程优先级简单地设置为 <8，而只建议您想要“很好地”运行的线程（或多个线程）。

正如 Shuggy 所指出的，问题不在于 CPU 时间，而是您的服务正在生成的 I/O。在 XP 上，所有 I/O 都被同等对待——因此您的 I/O 可能会干扰其他事情。

Vista（以及很快在 Win7 上）有两件事旨在完全满足您的需求。

第一个是[Windows 任务计划程序](http://technet.microsoft.com/en-us/appcompat/aa906020.aspx)。您可以使用它来安排在“系统空闲时间”运行的东西。这在系统不忙且用户不存在时。

第二个是[低优先级 I/O](http://www.microsoft.com/whdc/driver/priorityio.mspx)。这允许您的代码以低于其他 I/O 的优先级调度 I/O。

这两者一起可以用来开发作为一个好的系统公民的代码。

请注意，当系统使用电池运行时，您还应该通过缩减或禁用后台项目来考虑移动系统。你可以很简单——简单地关闭电池电源；或复杂，考虑到[电源方案](http://msdn.microsoft.com/en-us/library/aa373182(VS.85).aspx)，并将其用作用户的提示。

由于您正在编写一个良好的系统公民服务，因此您还可以做一些其他事情。

1）您可以监控随着时间的推移完成的工作量，如果取得了足够的进展，您可以放慢速度或停止。2）请注意您的内存占用 - 越小越好。这通常不言而喻，但对于 24/7 全天候运行的服务而言尤为重要。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-27T08:12:38.520

如果您使用`SetThreadPriority`API，您可以将线程配置为使用低于正常线程优先级的线程。当系统空闲时，线程将使用所有可用的 CPU 资源，但会将 CPU 时间让给任何具有更高优先级的线程。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-15T15:36:39.707

来自索引进程的大部分系统负担可能是磁盘 I/O，所以除了 ShuggyCoUk 所说的，如果您的进程在 Vista/Windows Server 2008 中工作，您还可以将磁盘 I/O 优先级更改为后台。这就是大多数分页、碎片整理和其他维护任务在这些系统上的工作方式。如果没有，您还可以监视磁盘 i/o 队列，以查看是否有来自用户交互的挂起操作。

# c# - 为什么我需要单例设计模式？

> ID：482594
> 
> 赞同：2
> 
> 时间：2009-01-27T08:02:05.763
> 
> 标签：c#, .net, design-patterns, oop

我尝试学习设计模式，但真的很难理解 OOD 的主要思想。我用经典方法创建了我的软件。另一方面，我想学习OOD。为什么我需要单身人士和其他人？我编写了一些简单的程序：其中一个是古典的（我的风格），另一个是单例模式。请教我为什么需要单例。我的方法比它更好更清晰:)

我的风格：（C#）

```
 public partial class Singletonsuz : System.Web.UI.Page
{
    protected void Page_Load(object sender, EventArgs e)
    {
        Loadbalancer balancer = new Loadbalancer();

        for (int i = 0 ; i < 15 ; i++)
        {
            string server = balancer.Server;
            Response.Write("Dispatch Request to: " + server);
        }
    }
}
class Loadbalancer
{
    private List<string> _servers = new List<string>();
    private Random _random = new Random();
    public Loadbalancer()
        {
            _servers.Add("ServerI");
            _servers.Add("ServerII");
            _servers.Add("ServerIII");
            _servers.Add("ServerIV");
            _servers.Add("ServerV");
        }
    public string Server
    {
        get
        {
            int r = _random.Next(_servers.Count);
            return _servers[r].ToString();
        }
    }
} 
```

单身人士：

```
 public partial class SingletonDP2 : System.Web.UI.Page
    {
        protected void Page_Load(object sender, EventArgs e)
        {
            LoadBalancer balancer = LoadBalancer.GetLoadBalancer();
            for (int i = 0; i < 15; i++)
            {
                string server = balancer.Server;
                Response.Write("Dispatch Request to: " + server );
            }
        }

        class LoadBalancer
        {
            private static LoadBalancer _instance;
            private List<string> _servers = new List<string>();
            private Random _random = new Random();

            private static object syncLock = new object();
            protected LoadBalancer()
            {
                _servers.Add("ServerI");
                _servers.Add("ServerII");
                _servers.Add("ServerIII");
                _servers.Add("ServerIV");
                _servers.Add("ServerV");
            }

            public static LoadBalancer GetLoadBalancer()
            {
                if (_instance == null)
                {
                    lock (syncLock)
                    {
                        if (_instance == null)
                        {
                            _instance = new LoadBalancer();
                        }
                    }
                }
                return _instance;
            }

            public string Server
            {
                get
                {
                    int r = _random.Next(_servers.Count);
                    return _servers[r].ToString();
                }
            }
        }
    } 
```

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2009-01-27T08:46:31.367

设计模式不是一种设计或开发*方法*。它们是一个*词汇表*：它们有助于为软件架构中出现的重复模式命名。根据我的经验，设计一个 FROM 模式的软件最终会导致带有许多单一用途类的毛茸茸的软件，这增加了程序员必须考虑的事情的数量（并且软件开发足够复杂，可以避免让你的大脑充满噪音）。

然而，设计模式在后期非常方便。始终从您的特定问题和领域开始，尝试找到解决方案，并确定过程中的模式。不要从模式开始，试图将你的问题强行融入其中。必须了解最常见的模式，因为它可以简化程序员（无论是开发人员还是库用户）之间的沟通并促进良好的实践。

例如，假设您的问题涉及数据集。在某些时候，您已经构建了数据结构和算法。现在您（或其他人）需要以更高级别的方式访问您的数据。这是 Iterator 或 Visitor 模式可以应用的典型情况。这就是在 C++ STL 中完成的方式，其中所有集合类都理解迭代器。但是，您无需预先考虑可能会或可能不会在此处或那里应用的模式，一旦确定了模式或需求，总有时间重构事物。

设计模式最初来自建筑和体系结构，这在许多方面与软件开发非常相似。根据我的经验，理解 DP 的最佳方式是通过与建筑类比：软件就是建筑，模式是建筑元素的组织方式：窗户、门、走廊、楼梯、灯光……建筑师不会考虑他们的元素想用，但想想自己想要得到的效果。例如，建筑师可能会认为：这个楼梯需要光线。为了实现这一点，他可能会根据建筑限制、建筑规范、客户的品味等使用窗户、天窗、玻璃块、人造灯等。他不会在考虑他试图解决的问题之前随意选择元素解决，除非他试图达到某种效果或风格。而且，如果市场上有另一种解决方案（例如反射阳光隧道），那么他可能会将其集成到他未来项目的可用设计模式中。OTOH，如果他养成在思考问题之前先思考解决方案的习惯，他就会冒着错过替代解决方案、使问题复杂化或根本不解决问题的风险。

在这里，您使用单例模式来处理看似需要动态初始化的全局对象。在这种情况下，单例是可接受的解决方案。然而，有时由于外部约束（例如，您需要按特定顺序初始化对象），您需要更复杂的解决方案，而单例将不再适用。或者该对象只需要静态初始化，一个普通的全局变量就可以满足您的需求。

过度使用设计模式与不在需要的地方使用它们一样糟糕。选择是否使用某种模式通常需要软件设计和开发方面的知识和经验，尤其是您所在的领域。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-01-27T08:17:05.187

你真的不需要模式。您需要的是针对具体问题的解决方案。模式只是众所周知问题的通用解决方案，因此被认为是好的和有效的解决方案。

模式的问题在于，您很容易发现自己正在寻找问题的解决方案。即，您开始搜索适合问题的模式，而您应该反过来思考：考虑问题，然后尝试您的解决方案是否与模式匹配。

当你有一把锤子时，一切看起来都像钉子......

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-01-27T08:08:53.783

单例模式被[广泛认为](http://steve.yegge.googlepages.com/singleton-considered-stupid)不是真正的模式。它更像是一个如何*呈现*模式的示例。

您可能会发现更通用的模式（例如[访问者](http://en.wikipedia.org/wiki/Visitor_pattern)）更有用。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-01-27T08:29:35.753

单例通常被简单地用来证明某些全局状态的存在。

如果你有全局状态接受它并且不觉得有必要将它包装成像单例这样的模式，除非在以下有限的情况下：

## 您正在从库中呈现这种全局状态。

如果您将其公开为普通的公共静态字段，则可能很难改变您依赖全局状态的决定（可能会发生的事情）。

在那些情况下，将值呈现给外部世界，而不是作为单例，而是作为恰好是静态定义的**默认值**，将允许设计更改（并阻止 API 的用户将其视为唯一的实例） ）。

## 这实际上只是您当前正在实施的工厂

因此，构造的“隐藏”是重要的部分，而不是返回值的全局性质。

如果类的消费者是同一构建过程的一部分（即，如果您以某种方式更改类，受影响的代码将在下一次构建时直接受到影响），那么是否需要进行此包装以允许更改点，因为如果需要，您可以直接更改它。这是您不需要它指南的应用程序。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-27T08:32:46.730

单例模式是官方认可的在现代 OOP 语言中执行类似于全局变量的方法。这可以防止全局变量名冲突等，因为它与一个类隔离，因此更容易避免重复的类名（因为你的编译器会出错）。使用“惰性实例化”创建对象也更容易：您可以等到第一次需要该对象时，在单例函数中实例化它。从长远来看，这可以节省一些 CPU 周期。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-27T10:13:22.987

在您的示例中，只有一个 LoadBalancer 实例并没有真正的好处。这使得理解 Singleton 可能带来的好处变得更加困难。

您示例中的 LoadBalancer 仅返回随机服务器。

想象一个 Loadbalancer 类，它跟踪他/她已经返回了哪些服务器，这样 LoadBalancer 可以返回负载最少的服务器。

在这种情况下，所有 Singletonsuz 实例都必须与同一个 LoadBalancer 通信：如果它们都只是创建自己的（不知道其他 LoadBalancer 做了什么），那么就不会有真正的平衡和跟踪返回的服务器会没用。

如果他们都需要与同一个实例通信，他们可以调用静态 GetLoadBalancer，然后该单个实例可以返回一个返回次数最少的服务器。

希望这可以帮助

简

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-27T08:12:31.640

设计模式用于在大型代码库中构建代码。您可以使用适合您正在开发的应用程序的设计模式，而不是每个程序员都使用自己的编码风格并从左到右连接系统。设计模式基本上说明了您应该如何构建代码，以及不同的系统应该如何相互交互。

使用设计模式可以加快开发时间，并可能迫使您以一种可以防止进一步问题的方式进行思考。如果您想在该领域工作，那么学习或至少了解多种设计模式是至关重要的。如果您像牛仔一样开始编写代码，破坏和破坏所选的成语，那么一家拥有大型软件项目的公司将不会对您友好。因为这会使团队中的其他开发人员感到困惑，并且通常会使事情变得更难理解。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-27T08:42:33.873

当您向他人提供代码/库时，单身人士更适合......

您的第一个示例允许多个实例，因此不遵循单例模式。

第二个示例不允许多个实例...在第一个示例中具有公共构造函数允许 LoadBalancer 的多个实例。因为它在第二个示例中是受保护的（私有）并且调用者必须使用检查现有实例的“GetLoadBalancer”，所以它只强制执行一个副本。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-01-27T08:48:04.237

好吧，您需要知道赞助人在哪里使用最重要的东西不是代码特定于上下文 如果您想确保对应用程序中对象的方法和属性的单点访问，可以使用单例。例如，在处理对数据库中表的访问的类中使用。然而，即使你真的不需要单例，单例也会在应用程序中传播

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2016-10-11T07:45:42.607

就面试问题而言，这是最著名的设计模式之一。

想象一下有 G+4 层的建筑物。每层有2个单位，大楼内共8个单位。每间公寓平均有 4 名成员，您至少有 32 名成员使用电梯。

现在考虑一栋 8 层的办公楼。每层至少有5个办公室，每层的员工人数不限。

在第一种情况下，我们不需要多个电梯。在第二种情况下，单部电梯根本不够用。

既然您已经了解了单电梯的需求与多电梯的需求。这为我们理解单例设计模式奠定了基础。

**单件设计模式**

就像前面例子中的电梯一样，单例设计模式也用于创建和使用一个对象的唯一实例。

为什么？因为应用程序不需要多个对象。

如果您见过专业的办公室，您会观察到一台打印机被一层楼的所有员工共享。所有的学生都不会在家里养一台打印机，他们宁愿去他们殖民地的网吧付钱，用他的打印机来满足他们的一时需求。

所有这一切都是因为这里所讨论的对象是昂贵的。从软件的角度来看，当一个对象利用大量资源来执行其操作时，它就是“昂贵的”。

所以现在我们需要单例设计模式：

1) 当应用程序在其整个生命周期中不会多次使用该对象时。

2）当应用程序频繁需要一个对象，但对象本身的计算量非常大时。

**单例设计模式的实现**

单例设计模式指出： 只允许在整个应用程序中创建一个类的实例并提供对其的全局访问点

所以第一部分是指“限制”建设。

从我们早期在 Java 中实现面向对象的过程中，我们知道构造函数是在程序执行期间调用的特殊函数，它们可以设为私有。当构造函数被设为私有时，类外的任何代码都不能创建它的对象。因此，为了实现单例设计模式，我们将需要一个“私有构造函数”，并且我们将使用该构造函数在类中创建一个对象。

我们定义的第二部分讨论了给这个单一对象一个全局句柄。我们将使用公共方法来做到这一点。

# delphi - Delphi中的递归类实例大小

> ID：482604
> 
> 赞同：4
> 
> 时间：2009-01-27T08:07:12.133
> 
> 标签：delphi, memory, size

有没有办法在 Delphi 中获取类实例的实际大小？

我知道 TObject 类的 InstanceSize 方法，但该方法不会递归地为对象成员调用自身。例如，假设我们有两个类：

```
type MyClass1 = class
  private
    myVar1 : integer;
    myVar2 : integer;
end;

type MyClass2 = class
  private
    myOtherVar1 : integer;
    myOtherVar2 : MyClass1;
end; 
```

对于这段代码，MyClass1 的长度为 12 个字节（每个整数 4 个字节加上 4 个用于类开销），MyClass2 的长度为 24 个字节（4 个字节用于类开销，12 个字节来自 myOtherVar2，另外 4 个字节用于 myOtherVar1整数）。由于 myOtherVar2 被解释为指针（4 字节）而不是类引用，因此使用 InstanceSize 将为它们中的每一个产生 12 个字节。

有没有办法获得类的总大小，包括它对其他类实例的引用？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-01-27T08:31:33.973

构造一个 MyClass1 对象和一百万个 MyClass2，使得每个 MyClass2 都指向同一个 MyClass1。

每个 MyClass2 占用多少内存？12.000012 字节？

循环列表需要多少内存？无限，因为您可以永远追逐指针？

在带有指针的语言中，朴素的递归大小算法通常没有用处。您需要编写自己的算法，该算法体现了有关特定于您如何使用对象的聚合/组合、共享和递归引用的知识。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-27T08:09:34.453

不，你想要的不存在。如果你想要这样的东西，你应该自己写。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-27T12:32:06.780

> 有没有办法获得类的总大小，包括它对其他类实例的引用？

你刚才说了。引用是一个指针；它的大小是 4 个字节。InstanceSize 返回的值是为类的实例数据分配的字节数。

例如，myOtherVar2 可能为零。但是 nil 指针值仍然会占用 4 个字节的内存。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-06T19:40:07.967

要找出它使用了多少内存，您可以让对象不被释放并让 FastMM 告诉您泄漏的大小。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-27T09:45:53.590

听起来您想计算对象使用的内存。

如果您需要这样做，您可以检查 FastMM 是如何做到的，并且可能会在创建您的类型的对象时挂钩您的过程。

大量工作目标不明确；你最好在开始之前有充分的理由。

# c# - 具有多种编程语言支持的 ORM（对象关系管理器）解决方案

> ID：482612
> 
> 赞同：7
> 
> 时间：2009-01-27T08:10:48.523
> 
> 标签：c#, c++, python, orm

是否有一个好的 ORM（对象关系管理器）解决方案可以使用来自 C++、C#、Python 的相同数据库？

它也可以是多种解决方案，例如每种语言一种，只要它们可以访问相同的数据库并使用相同的模式。

还需要多平台支持。

## 澄清：

这个想法是拥有一个数据库，并通过用几种不同编程语言编写的软件来访问它。理想情况下，这将由一个具有所有这些语言的 API（或绑定）的 ORM 提供。

另一种解决方案是在每种语言中使用不同的 ORM，使用兼容的模式。但是，我相信在这种情况下，架构迁移将非常困难。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-27T08:37:53.243

使用 SQLAlchemy，您可以使用反射来获取架构，因此它应该与任何受支持的引擎一起使用。

我用它来将数据从旧的 SQLite 迁移到 Postgres。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-25T13:35:20.517

我知道Pascal、C# 的[DataAbstract](http://www.remobjects.com/da.aspx)以及 Mac 和 Iphone 的 Objective C，但不支持 Python。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-30T16:34:06.410

我们有一个具有 C++ 和 C#（实际上是 COM）绑定（在 FOST.3 中）的 O/RM，我们正在将版本 4 中新的 Python 绑定与 Linux 和 Mac 支持放在一起。

# c - 在没有 C 运行时的情况下使用 64 位整数 - 链接错误 __alldiv

> ID：482624
> 
> 赞同：2
> 
> 时间：2009-01-27T08:14:55.893
> 
> 标签：c, html, 64-bit, linker, runtime

我正在尝试在不使用 C 运行时（msvcrt 或 libcmt）的情况下构建 Windows 控制台应用程序。那就是只链接 kernel32.lib 并使用来自 WIN32 API 的控制台函数而不是 printf 等。

我的问题是，在链接期间，编译器无法找到似乎可以处理 32 位应用程序中的 64 位整数除法的 __alldiv。我尝试了微软的编译器和英特尔的。

此函数存在于运行时库中。像 64 位整数这样基本的东西需要完整的 C 运行时，这很烦人。

任何想法如何克服这个问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-27T09:17:24.287

找到了 __alldiv 链接问题的解决方案：

在 msdev 安装中找到**lldiv.obj 。**我可以将该对象文件添加到链接而不是 C 运行时。

对我来说，路径是：

c:\Program Files (x86)\Microsoft Visual Studio 9.0\VC\crt\src\intel\mt_lib\lldiv.obj。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-27T08:58:18.600

可以处理大于硬件除法器可以处理的除数的扩展精度除法例程比您想象的要复杂。我曾经不得不编写一个函数来将 128 个值除以 64 位值，这相当痛苦（在一般情况下很慢）。

看看 Randall Hyde 在他的[“汇编语言艺术”文本（第 4 卷，第 4.2.5 节 - 扩展精度除法）](http://webster.cs.ucr.edu/AoA/Windows/HTML/AdvancedArithmetica2.html)中讨论的算法。

这是一段摘录：

> 您不能使用 DIV 和 IDIV 指令合成一般的 n 位/m 位除法运算。这样的操作必须使用一系列移位和减法指令来执行，并且非常混乱。但是，使用 DIV 指令可以轻松合成一个不太通用的操作，即 n 位数量除以 32 位数量。本节介绍了扩展精度除法的两种方法。
> 
> 在描述如何执行多精度除法运算之前，您应该注意一些运算需要扩展精度除法，即使它们看起来可以使用单个 DIV 或 IDIV 指令计算。将 64 位数量除以 32 位数量很容易，只要得到的商适合 32 位。DIV 和 IDIV 指令将直接处理这个问题。但是，如果商不适合 32 位，那么您必须将此问题作为扩展精度除法来处理。这里的技巧是将被除数的（零或符号扩展的）HO dword 除以除数，然后用余数和被除数的 LO dword 重复该过程。

因此，您可能想要做的一件事是确定您是否真的需要在除数中使用 64 位数量 - 如果不需要，您可以轻松编写一个执行该任务的函数。如果你真的需要用 64 位值除以 64 位值，你仍然可以这样做，但这是一个更困难的问题。更具体地说，它可能不适合编译器“内联” - 因此它是一个库例程。

哦，别忘了——MS 提供了库源代码。 `__alldiv()`是一个汇编语言函数`lldiv.asm`。将该文件添加到您的项目中并在没有库的其余部分的情况下将其链接起来应该不会太难。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-27T08:36:58.843

_alldiv的[msdn](http://msdn.microsoft.com/en-us/library/ms648425(VS.85).aspx)页面说它的使用取决于编译器优化设置，但没有说明它所依赖的设置是什么。

Wine 中还有一个 _alldiv 你可以借用。

# sql - SQL Server，将 .BKP 文件还原为 MDF 文件，而不是 LDF（没有空间）

> ID：482628
> 
> 赞同：0
> 
> 时间：2009-01-27T08:20:12.107
> 
> 标签：sql, restore, mdf, litespeed, ldf

我遇到了一个问题，我没有足够的空间来容纳我们完成的 LiteSpeed 备份中的 MDF 和 LDF 文件。

我想出了以下存储过程：

```
exec master.dbo.xp_restore_database

@database = 'OSiteDB',
@filename = 'L:\OSiteDB_2009_01_07_Wed_LiteSpeed_Full.BKP',
@with = 'move "O1_SITEDB" to "S:\OSiteDB_Data.mdf"',
@with = 'move "O1_SITEDB_Log" to "Some dev null location??" 
```

有没有办法可以将 LDF 位置指定为某个空位置？我不想要LDF，或者，有没有办法告诉它根本不获取ldf？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-10T14:15:51.493

您需要恢复 LDF 以及 MDF。日志是数据库的一个组成部分：没有它，它就不是 RDBMS 意义上的“数据库”。

在紧急情况下，您需要插入外部驱动器或恢复到 NTFS 压缩文件夹。然后，您可以缩小数据库文件。然而，这只是一个快速修复，让你继续，这样你就可以正确地做到这一点。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-29T23:57:57.467

你看过 WITH NORECOVERY 选项吗？

特别是，我相信您可以先恢复数据库 WWITH NOCEOVERY，然后再恢复 LOG WITH RECOVERY（没有日志文件）。

[http://msdn.microsoft.com/en-us/library/ms191253.aspx](http://msdn.microsoft.com/en-us/library/ms191253.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-30T00:01:24.883

我认为您无法避免恢复 LDF 文件。但是，正如您所提到的，您也许可以将其恢复到临时位置。

从[这里](http://blog.sqlauthority.com/2007/02/25/sql-server-restore-database-backup-using-sql-script-t-sql/)：

```
--Step 1: Retrive the Logical file name of the database from backup.
RESTORE FILELISTONLY
FROM DISK = ‘L:\OSiteDB_2009_01_07_Wed_LiteSpeed_Full.BKP’
GO

--Step 2: Use the values in the LogicalName Column in following Step.
—-Make Database to single user Mode
ALTER DATABASE OSiteDB
SET SINGLE_USER WITH
ROLLBACK IMMEDIATE

—-Restore Database
RESTORE DATABASE OSiteDB
FROM DISK = ‘L:\OSiteDB_2009_01_07_Wed_LiteSpeed_Full.BKP’
WITH 
  MOVE ‘O1_SITEDB’ TO ‘S:\OSiteDB_Data.mdf’,
  MOVE ‘O1_SITEDB_Log’ TO ‘C:\OSiteDB_Log.ldf’

/*If there is no error in statement before database will be in multiuser mode.
If error occurs please execute following command it will convert
database in multi user.*/
ALTER DATABASE OSiteDB SET MULTI_USER
GO 
```

更改 LDF 文件的目标位置，看看会发生什么。

# php - 在 PHP 中将构造函数与对象函数调用链接起来

> ID：482631
> 
> 赞同：4
> 
> 时间：2009-01-27T08:22:23.273
> 
> 标签：php

有谁知道在 PHP 的下一个版本中是否可以使用以下表达式？

```
(new A())->a();    // Causes a syntax error 
```

我发现目前必须写 2 行而不是 1 行，这很烦人：

```
$c = new A();
$c->a(); 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-27T08:31:25.017

第一个版本不会导致解析错误，它是完全有效的。第二个确实是不可能的，但是您可以通过一些编码标准轻松克服这样的问题。

如果每个团队成员为每个定义的类创建一个与该类同名的函数，以及一个类似于类构造函数签名的签名，那么您将不会遇到第二个问题。例子：

```
class Foo
{
    public function __construct($param)
    {}

    public function bar()
    {}
}

/**
 * @return Foo
 */
function Foo($param)
{
    return new Foo($param);
}

Foo()->bar(); 
```

当然，您仍然会遇到库代码的问题。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-10-03T09:14:44.840

new-expression 可以用作函数参数。函数调用可以用作成员访问运算符的左侧。因此，您只需要定义一个函数：

```
function with($object) { return $object; }

with(new A()) -> a(); 
```

每个班级都不需要额外的努力。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-11-25T17:33:41.700

[从PHP 5.4+ 起](http://docs.php.net/manual/en/migration54.new-features.php)这是可能的：

> 添加了对实例化的类成员访问，例如 (new Foo)->bar()。

# java - 在Java中，是否可以知道一个类是否已经被加载？

> ID：482633
> 
> 赞同：45
> 
> 时间：2009-01-27T08:23:38.450
> 
> 标签：java, classloader

*是否可以在不*尝试加载的情况下知道是否已加载 Java 类？`Class.forName`尝试加载类，但我不想要这种副作用。还有其他方法吗？

（我不想重写类加载器。我正在寻找一个相对简单的方法。）

* * *

## 回答 #1

> 赞同：44
> 
> 时间：2009-01-27T10:34:56.890

（感谢 Aleksi）这段代码：

```
public class TestLoaded {
     public static void main(String[] args) throws Exception {
          java.lang.reflect.Method m = ClassLoader.class.getDeclaredMethod("findLoadedClass", new Class[] { String.class });
          m.setAccessible(true);
          ClassLoader cl = ClassLoader.getSystemClassLoader();
          Object test1 = m.invoke(cl, "TestLoaded$ClassToTest");
          System.out.println(test1 != null);
          ClassToTest.reportLoaded();
          Object test2 = m.invoke(cl, "TestLoaded$ClassToTest");
          System.out.println(test2 != null);
     }
     static class ClassToTest {
          static {
               System.out.println("Loading " + ClassToTest.class.getName());
          }
          static void reportLoaded() {
               System.out.println("Loaded");
          }
     }
} 
```

产生：

> ```
> false
> Loading TestLoaded$ClassToTest
> Loaded
> true 
> ```

请注意，示例类不在包中。需要完整的[二进制名称](http://java.sun.com/javase/6/docs/api/java/lang/ClassLoader.html#name)。

二进制名称的一个例子是`"java.security.KeyStore$Builder$FileBuilder$1"`

* * *

## 回答 #2

> 赞同：29
> 
> 时间：2009-01-27T08:29:23.790

您可以使用 ClassLoader 中的[findLoadedClass(String)](http://docs.oracle.com/javase/7/docs/api/java/lang/ClassLoader.html#findLoadedClass(java.lang.String))方法。如果类未加载，则返回 null。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-01-27T12:00:02.693

一种方法是使用[检测 API](http://java.sun.com/javase/6/docs/api/java/lang/instrument/package-frame.html)编写 Java 代理。这将允许您记录 JVM 对类的加载。

```
public class ClassLoadedAgent implements ClassFileTransformer {

    private static ClassLoadedAgent AGENT = null;

    /** Agent "main" equivalent */
    public static void premain(String agentArguments,
            Instrumentation instrumentation) {
        AGENT = new ClassLoadedAgent();
        for (Class<?> clazz : instrumentation.getAllLoadedClasses()) {
            AGENT.add(clazz);
        }
        instrumentation.addTransformer(AGENT);
    }

    private final Map<ClassLoader, Set<String>> classMap = new WeakHashMap<ClassLoader, Set<String>>();

    private void add(Class<?> clazz) {
        add(clazz.getClassLoader(), clazz.getName());
    }

    private void add(ClassLoader loader, String className) {
        synchronized (classMap) {
            System.out.println("loaded: " + className);
            Set<String> set = classMap.get(loader);
            if (set == null) {
                set = new HashSet<String>();
                classMap.put(loader, set);
            }
            set.add(className);
        }
    }

    private boolean isLoaded(String className, ClassLoader loader) {
        synchronized (classMap) {
            Set<String> set = classMap.get(loader);
            if (set == null) {
                return false;
            }
            return set.contains(className);
        }
    }

    @Override
    public byte[] transform(ClassLoader loader, String className,
            Class<?> classBeingRedefined, ProtectionDomain protectionDomain,
            byte[] classfileBuffer) throws IllegalClassFormatException {
        add(loader, className);
        return classfileBuffer;
    }

    public static boolean isClassLoaded(String className, ClassLoader loader) {
        if (AGENT == null) {
            throw new IllegalStateException("Agent not initialized");
        }
        if (loader == null || className == null) {
            throw new IllegalArgumentException();
        }
        while (loader != null) {
            if (AGENT.isLoaded(className, loader)) {
                return true;
            }
            loader = loader.getParent();
        }
        return false;
    }

} 
```

元信息/清单.MF：

```
Manifest-Version: 1.0 
Premain-Class: myinstrument.ClassLoadedAgent 
```

缺点是您必须在启动 JVM 时加载代理：

```
java -javaagent:myagent.jar ....etcetera 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-01-27T10:09:53.073

**如果**您可以控制您对是否加载它们感兴趣的类的源（我对此表示怀疑，但您没有在问题中说明），那么您可以在静态初始化程序中注册您的负载.

```
public class TestLoaded {
    public static boolean loaded = false;
    public static void main(String[] args) throws ClassNotFoundException {
        System.out.println(loaded);
        ClassToTest.reportLoaded();
        System.out.println(loaded);
    }
    static class ClassToTest {
        static {
            System.out.println("Loading");
            TestLoaded.loaded = true;
        }
        static void reportLoaded() {
            System.out.println("Loaded");
        }
    }
} 
```

输出：

> ```
> false
> Loading
> Loaded
> true 
> ```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-10-02T01:03:59.703

我最近遇到了类似的问题，我怀疑我的用户正在加载类（可能是通过 -classpath 或类似的方式），这些类与我稍后加载到我自己的类加载器中的类相冲突。

在尝试了这里提到的一些事情之后，以下似乎对我有用。我不确定它是否适用于所有情况，它可能只适用于从 jar 文件加载的 java 类。

```
InputStream is = getResourceAsStream(name); 
```

类文件的路径在哪里`name`，例如`com/blah/blah/blah/foo.class`.

`getResourceAsStream`当类尚未加载到我的类加载器或系统类加载器中时返回`null`，当类已经加载时返回非空。

# database - 使用 slug 而不是 ID 获取记录

> ID：482636
> 
> 赞同：6
> 
> 时间：2009-01-27T08:29:00.920
> 
> 标签：database, performance, url, select, slug

在处理诸如获取带有特定标签或类别或类似内容的记录之类的情况时，我目前正在尝试找到最佳方法（在可用性和性能方面）。

一个好方法（我想做的方式）是使用标签/类别 slug 获取记录，所以 URL 看起来像：

```
http://stackoverflow.com/questions/tagged/language-agnostic 
```

通过 slug 获取记录，这看起来比：

```
http://stackoverflow.com/questions/tag/789/language-agnostic 
```

通过 ID 获取并在后面添加 slug，因此它对搜索引擎更加友好。这在性能方面更好，因为通过整数 ID 获取数据会比字符串快。(cmiiw)

现在，使用 db 架构，如：

```
posts    post_to_tags    tags
-----    ------------    ----
id       id              id
title    post_id         name
content  tag_id          slug
...                      ... 
```

我做对了吗？为了避免性能问题，我需要知道哪些陷阱或最佳实践？（例如，标签不应超过 10,000 条记录，或标签 slug 不应超过 n 个字符，或其他）

提前致谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-27T12:24:02.363

使用第一个 URL 样式和您当前的数据库设计，您可以这样做：

```
select ...
from   posts p
join   posts_to_tags pt on pt.post_id = p.post_id
join   tags t on t.id = pt.tag_id
where  t.slug = [url slug value]; 
```

只要 tags.slug 被索引，这应该是非常有效的，*几乎没有*什么不同

```
select ...
from   posts p
join   posts_to_tags pt on pt.post_id = p.post_id
where  pt.tag_id = [url tag ID]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-11-27T16:08:56.877

第一个更好，但是可以改变蛞蝓吗？在这种情况下，您需要有一个重定向表（例如，“some-article-about-dogs”现在是“article-about-dogs-and-cats”）。

# oracle - 使用 Oracle 调用接口 (OCI) 检测具有默认值的列

> ID：482647
> 
> 赞同：1
> 
> 时间：2009-01-27T08:35:32.390
> 
> 标签：oracle, oracle-call-interface

我正在优化消息传递系统中的定制数据库层以提高性能。

我正在使用 ORACLE OCI OCIDescribeAny 函数来获取有关数据库表中列的元数据。

如何使用 OCI 调用检查元数据以查看列是否设置了默认值（在其架构定义中）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-29T22:25:31.990

看来您不能使用当前的 API。

Call Interface Programmer's Guide的[Column Attributes 部分](http://cs.felk.cvut.cz/10gr2/appdev.102/b14250/oci06des.htm#sthref1021)没有提及它。

[OTN上](http://forums.oracle.com/forums/thread.jspa?messageID=1552894)也问了同样的问题，唯一的回答是指出`*_TAB_COLUMNS`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-27T09:12:06.777

您可以在 all_tab_columns 或 user_tab_columns 中找到它，因为您可以在那里找到列定义。

# javascript - SWF 上的 HTML 对象

> ID：482649
> 
> 赞同：3
> 
> 时间：2009-01-27T08:36:29.877
> 
> 标签：javascript, html, flash

我的网页上有一个 SWF 视频播放器。我想在它上面绘制一个具有高 z-index 的 div 标签作为弹出窗口。它是一个非常通用的弹出窗口。因此我不能让它成为 swf 的一部分。但是，SWF 似乎有非常高的 zIndex 并且不允许任何 HTMLO 实体坐在它上面。我该如何实现这一点，或者是否有替代解决方案。

谢谢。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-01-27T08:41:08.213

为了能够实现这一点，必须将一些参数传递给 SWF 文件。在 HTML 表示中，您应该在 object 标记内放置：

```
<param name="wmode" value="transparent"> 
```

和...

```
<embed wmode="transparent" ... 
```

如果您使用 JS 库来呈现 SWF 对象，则应该应用类似的值。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-27T08:42:52.920

您需要向 flash 对象添加一个参数，`<param NAME="wmode" VALUE="transparent">`这会将其放回“流”中并允许其他 html 元素位于顶部

哦，将 wmode="transparent" 添加到嵌入标签

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-27T08:43:22.997

一种快速而肮脏的技术是每次显示覆盖 div 时用黑白图像替换 swf（只是具有重复背景图像的 swf 容器的不同类），然后在覆盖 div 关闭时将其改回正常.

另一种技术是将 iframe 用于 swf，但我猜这不是太花哨:)

# eclipse - 作为过滤过程的一部分，如何突出显示 TableView 单元格的一部分？

> ID：482670
> 
> 赞同：1
> 
> 时间：2009-01-27T08:43:16.367
> 
> 标签：eclipse, swt, eclipse-rcp, jface, eclipse-pde

背景故事：我正在对 TableView 应用过滤器。这是一个简单的“使用此字符串查找行”过滤器。

要求：我希望突出出现搜索词的实例。

到目前为止，我看不到这样做的任何方法。ITableColorProvider 让我将颜色应用于整个单元格，但不是应用于其中的一小部分。

最欢迎提供线索。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-27T08:52:33.557

看起来该`highlighting`方法适合您

从[3.5M4 开始](http://update.eclipse.org/downloads/drops/S-3.5M4-200812111908/eclipse-news-M4.html)，对 JFace TableViewer 和 TreeViewer 的现有所有者绘制支持已扩展为允许在单元格中使用多种字体。例如，这可用于使用粗体突出显示搜索结果中的匹配文本。

[替代文字 http://update.eclipse.org/downloads/drops/S-3.5M4-200812111908/images/multi-font-labels.png](http://update.eclipse.org/downloads/drops/S-3.5M4-200812111908/images/multi-font-labels.png)

# java - 在 Java 中使用 hessian，如何控制实例化？

> ID：482673
> 
> 赞同：2
> 
> 时间：2009-01-27T08:43:32.763
> 
> 标签：java, hessian

我有一个对象缓存（不是 HTTP 会话属性），并且我希望能够在 Hessian 请求进入时从该缓存中获取一个对象，并让 Hessian 对该对象而不是 servlet 执行调用。

我可以通过在 HessianServlet 上设置 service-class 和 api-class init 参数来控制执行请求的类。但是，它正在执行对象本身的实例化，看起来我无法控制它。

我试图覆盖 HessianServlet 的 execute() 方法并调用 setService() 或 setObject() 但它不使用我传入的对象。相反，它似乎实例化了自己的对象。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-04T13:41:27.410

一个简单的技巧是创建一个服务类，该服务类在您的对象上具有相同的接口，它委托给它获取到池中的对象实例，通过 Hessian 公开该服务。

# java - Java：在类型和实现上指定泛型

> ID：482674
> 
> 赞同：1
> 
> 时间：2009-01-27T08:45:14.740
> 
> 标签：java, generics

我见过的大多数参考资料，以及我的 IDE 代码完成都让我在变量类型及其实现上都指定了一个通用类型，例如。

```
List<String> string = new ArrayList<String>(); 
```

最近我开始在实现上跳过泛型类型，例如。

```
List<String> strings = new ArrayList(); 
```

假设编译器只检查它的类型是否是漂亮的泛型巫术，并且实现不应该关心，因为它的泛型类型在编译时被删除并且根本不应该影响运行时。

我是不是太天真了？是否有理由在实现中包含泛型类型？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-27T08:50:15.900

编译器可能允许您编写具有此类分配的代码（取决于您的警告/错误设置），但它是不安全的。这是一个例子：

```
List<Date> dates = new ArrayList<Date>();
List list = dates;
List<String> strings = list;

strings.add("a");
Date d = dates.get(0); // Boom!! 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-27T09:16:47.687

> 是否有理由在实现中包含泛型类型？

它是必需的，因为它不一定相同：

```
List<? extends Number> numbers = new ArrayList<Integer>(); 
```

在常见情况下避免它的一种方法是使用静态实用程序方法，并让编译器的类型推断完成其余工作：

```
class CollectionUtilities {
   static <T> ArrayList<T> arrayList () { return new ArrayList<T>(); }
}

...

import static CollectionUtilities.*;

List<Integer> numbers = arrayList(); 
```

这是类型安全的，并且在实现中不需要泛型类型。（ itay 的示例不安全的原因是列表变量的类型缺少泛型类型，无论您是否需要在变量的类型和实现上都指定泛型类型，都无济于事。）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-27T13:41:21.210

虽然在这些情况下能够省略类型泛型定义会很好，但它确实会产生警告。（这里有一个严肃的提议，用非原始语法扩展语言来推断类型。）你真的不应该养成忽略编译器警告的习惯。作为 Pete Kirkham，您可以使用已经存在的类型推断（尽管我建议使用较短的名称）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-27T14:06:44.013

在您展示的简单案例中，您的代码完全可行，因为（在类型擦除之后）编译器将生成完全相同的字节码。

但是，在稍微复杂一点的情况下，您可能会遇到麻烦。这就是编译器想要对这种类型的代码发出警告的原因。此外，如果添加了类型具体化（Java 8？），那么这段代码将被破坏。除非 Java 7 首先添加类型推断。:-)

同时，最好编写警告干净的代码。

# windows - 如何在 Windows/DOS 上捕获标准错误？

> ID：482678
> 
> 赞同：35
> 
> 时间：2009-01-27T08:46:41.943
> 
> 标签：windows, scripting, batch-file, cmd, stderr

我想将脚本中的错误捕获到文件而不是屏幕中。

在 *nix 中，这是通过 stderr 重定向完成的，通常

```
echo "Error" 2> errorfile.log 
```

如何在 Windows 下的 CMD 脚本中执行此操作？

* * *

## 回答 #1

> 赞同：45
> 
> 时间：2009-01-27T12:49:11.753

例如：

```
PSKILL NOTEPAD >output.txt 2>&1 
```

这会将 stdout 和 stderr 定向到文件名 output.txt。

有关更多详细信息，请参阅[Windows 批处理文件的未充分利用的功能。](https://stackoverflow.com/questions/245395/underused-features-of-windows-batch-files#246691)

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2009-01-27T08:50:28.177

这也应该在 Win32 中工作。

如果您已经重定向了 stdout，并且希望将 stderr 重定向到同一个文件，则必须使用 2>& 特殊形式，而不是只指定同一个文件两次。否则你会得到一个“文件忙”的错误。

# windows - 适用于 Windows 的 D-Bus 等效项

> ID：482681
> 
> 赞同：23
> 
> 时间：2009-01-27T08:48:36.450
> 
> 标签：windows, winapi, ipc, dbus

有人知道 Windows 的 Linux/D-Bus 机制吗？

谢谢

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2009-01-27T12:44:31.683

选择你的毒药：

[http://msdn.microsoft.com/en-us/library/aa365574%28VS.85%29.aspx](http://msdn.microsoft.com/en-us/library/aa365574%28VS.85%29.aspx)

> Windows 支持以下 IPC 机制：
> 
> *   剪贴板
> *   通讯
> *   数据复制
> *   DDE
> *   文件映射
> *   邮槽
> *   管道
> *   RPC
> *   Windows 套接字

最接近 DBus 的是 COM。

* * *

## 回答 #2

> 赞同：27
> 
> 时间：2010-01-08T17:59:13.740

[参考 D-Bus 实现](http://www.freedesktop.org/wiki/Software/dbus/)本机支持 Windows。以前，可以使用[WinDBus 项目。](http://sourceforge.net/projects/windbus/)如果您想使用 D-Bus，则不需要等效项。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2014-04-29T22:17:08.233

windbus 现在是官方 DBus 版本的一部分，请参阅： [https ://www.freedesktop.org/wiki/Software/dbus/#windowsport](https://www.freedesktop.org/wiki/Software/dbus/#windowsport)

# apache - mod_rewrite 奇怪的问题

> ID：482691
> 
> 赞同：1
> 
> 时间：2009-01-27T08:52:48.827
> 
> 标签：apache, mod-rewrite

我对 mod_rewrite 有一个奇怪的问题，这里相关的规则是：

```
RewriteRule ^(.*)\/igre\-(.*)\.php\?Page=([0-9]+)$ game.php?GameUrl=$2&Page=$3 [L]
RewriteRule ^(.*)\/igre\-(.*)\.php$ game.php?GameUrl=$2&Page=1 [L] 
```

相应的 URL 可能如下所示：

```
example.com/miselne-igre/igre-shirk.php?Page=2
example.com/miselne-igre/igre-shirk.php 
```

问题是第一条规则没有效果。如果我使用示例中的第一个 URL，我总是将 1 输入到 Page 变量中，这表明使用了第二个规则。那么第一个有什么问题呢？如果我说 URL 以“.php”结尾，为什么第二条规则甚至匹配最后带有“.php?Page=XYZ”的 URL？

ps：.htaccess 文件中的其他规则工作正常...

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-27T08:55:53.923

查询字符串不是[`RewriteRule`指令](http://httpd.apache.org/docs/2.2/mod/mod_rewrite.html#rewriterule)正在处理的 URI 路径的一部分。您必须使用该[`RewriteCond`指令](http://httpd.apache.org/docs/2.2/mod/mod_rewrite.html#rewritecond)来处理查询字符串。

```
RewriteCond %{QUERY_STRING} ^Page=[0-9]+$
RewriteRule ^[^/]+/igre-([^/]+)\.php$ game.php?GameUrl=$1&%0 [L]
RewriteRule ^[^/]+/igre-([^/]+)\.php$ game.php?GameUrl=$1&Page=1 [L] 
```

* * *

但是您仍然可以通过使用 QSA 标志（*查询字符串追加*）来简化这一点：

```
RewriteRule ^[^/]+/igre-([^/]+)\.php$ game.php?GameUrl=$1 [L,QSA] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-27T08:55:11.117

mod_rewrite 在它的重写过程中没有使用查询。因此，您首先 RewriteRule 被忽略。您可以将它与[RewriteCond](http://httpd.apache.org/docs/2.0/mod/mod_rewrite.html#rewritecond)（虽然尚未测试）结合起来，如下所示：

```
RewriteCond %{QUERY_STRING} Page=([0-9]+)
RewriteRule ^(.*)\/igre\-(.*)\.php\?Page=([0-9]+)$ game.php?GameUrl=$2 [L, qsappend]
# qsappend appends the original query, in this case (Page=xx) 
```

啊，就像秋葵所说的那样；您还可以使用`%1`反向引用页码。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-01-27T08:56:28.167

是我自己还是你的论点是前后矛盾的？

你的意思是：

```
RewriteRule ^(.*)\/(.*)\-igre\.php\?Page=([0-9]+)$ game.php?GameUrl=$2&Page=$3 [L]
RewriteRule ^(.*)\/(.*)\-igre\.php$ game.php?GameUrl=$2&Page=1 [L] 
```

你想匹配`miselne-igre`not `igre-miselne`。

显然这并没有解决主要问题，但我想我会把它扔进去。

多姆

# vb.net - WinForms 中的嵌入式视频 (AxShockwaveFlash)

> ID：482697
> 
> 赞同：0
> 
> 时间：2009-01-27T08:56:00.240
> 
> 标签：vb.net, winforms, flash, embedded-resource, movie

我在 youtube 上上传了几个教程视频。

在我的 winforms 应用程序中（通过使用 AxShockwaveFlash 对象）我再现了用户选择的视频。

AxShockwaveFlash1.LoadMovie( [http://www.youtube](http://www.youtube) ..video1)

故事来了。

用户第一次选择视频时，复制就像魅力一样。

当用户选择观看第二个视频时 AxShockwaveFlash1.LoadMovie( [http://www.youtube](http://www.youtube) ..video2)

ShockwaveFlash 继续复制第一个选择

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-27T09:05:19.067

尝试使用

```
AxShockwaveFlash1.Stop();
AxShockwaveFlash1.Movie = "Your source";
AxShockwaveFlash1.Play(); 
```

避免留下 flash 参数的模式。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-27T09:02:53.643

在不知道如何将视频集成到表单中的情况下，我要做的方法是在表单中使用 webBrowsercontrol 并将视频嵌入到控件中。 [webBrowsercontrol 上的 msdn](http://msdn.microsoft.com/en-us/library/system.windows.forms.webbrowser.aspx)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-15T23:20:13.653

我曾经遇到过这个问题，并通过将 Ax 对象控件的 Embed 属性更改为 False 来解决它。

我每次都通过电影 URL 嵌入视频，如下所示：

[http://www.youtube.com/v/targetmovie&feature=player_embedded](http://www.youtube.com/v/targetmovie&feature=player_embedded)

工作一种享受

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-05-31T10:56:27.050

您首先需要像这里一样提取 FLV 文件：

[在 .NET 中从 YouTube 获取 FLV](https://stackoverflow.com/questions/1883737/getting-an-flv-from-youtube-in-net)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-27T09:34:53.720

Tamir，视频已嵌入。本地不存储

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2011-02-08T04:15:52.530

这是因为您的应用程序正在从缓存加载 Flash 播放器加载器，然后它从站点加载真正的播放器，最后这会产生安全异常。在 Internet Explorer 中，在 Internet 选项中设置为每次访问页面时检查文档的新版本。

# c++ - 使用 SIGINT

> ID：482702
> 
> 赞同：4
> 
> 时间：2009-01-27T08:56:54.250
> 
> 标签：c++, windows, signals

根据这个[http://www.cplusplus.com/reference/clibrary/csignal/signal.html](http://www.cplusplus.com/reference/clibrary/csignal/signal.html)

`SIGINT`通常由用户使用/引起。我如何`SIGINT`在 c++ 中导致 a ？我看到了一个使用示例，`kill(pid, SIGINT);`但我宁愿以另一种方式引起它。我也在使用窗户。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-27T09:32:28.763

C89 和 C99 在 signal.h 中定义 raise()：

```
#include <signal.h>

int raise(int sig); 
```

该函数向调用进程发送信号，相当于

```
kill(getpid(), sig); 
```

如果平台支持线程，那么调用就相当于

```
pthread_kill(pthread_self(), sig); 
```

成功时返回值为 0，否则为非零。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-01-27T09:09:12.493

`SIGINT`您通过按引起 a `Ctrl+C`。

示例代码：

```
#include <stdio.h>
#include <stdlib.h>
#include <signal.h>

void siginthandler(int param)
{
  printf("User pressed Ctrl+C\n");
  exit(1);
}

int main()
{
  signal(SIGINT, siginthandler);
  while(1);
  return 0;
} 
```

运行时：

```
$ ./a.out 
^CUser pressed Ctrl+C
$ 
```

（请注意，这是纯 C 代码，但应该在 C++ 中工作）

`SIGINT`编辑：除了交互式按下之外，我所知道的唯一发送方法`Ctrl+C`是使用`kill(pid, SIGINT)`你所说的......

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-27T09:03:26.013

你还想什么办法？该`kill()`函数是内核提供以编程方式发送信号的唯一方法。

实际上，您提到您使用的是 Windows。我什至不确定`kill()`在 Windows 上做了什么，因为 Windows 没有与 Unix 派生系统相同的信号架构。Win32 确实提供了 TerminateProcess 功能，它可以做你想做的事。还有[GenerateConsoleCtrlEvent](http://msdn.microsoft.com/en-us/library/ms683155(VS.85).aspx)函数，它适用于控制台程序并模拟 Ctrl+C 或 Ctrl+Break。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2017-04-25T10:43:35.467

```
void SendSIGINT( HANDLE hProcess )
{
    DWORD pid = GetProcessId(hProcess);
    FreeConsole();
    if (AttachConsole(pid))
    {
        // Disable Ctrl-C handling for our program
        SetConsoleCtrlHandler(NULL, true);

        GenerateConsoleCtrlEvent(CTRL_C_EVENT, 0); // SIGINT

        //Re-enable Ctrl-C handling or any subsequently started
        //programs will inherit the disabled state.
        SetConsoleCtrlHandler(NULL, false);

        WaitForSingleObject(hProcess, 10000);
    }
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-27T09:03:40.180

在这方面，“信号”是一个 Unix/POSIX 概念。Windows 没有直接的等价物。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-27T14:02:33.460

我假设这是一个 Win32 应用程序...

对于“受控”或“安全”退出，如果应用程序使用消息循环，您可以在其内部使用 PostQuitMessage API，或在其外部使用 PostMessage。否则，您将需要获取线程/进程 ID 并使用 TerminateThread 或 TerminateProcess API，具体取决于您是想杀死一个线程还是整个进程以及它产生的所有线程。Microsoft（与所有 API 调用一样）在 MSDN 上很好地解释了它：

[http://msdn.microsoft.com/en-us/library/aa450927.aspx](http://msdn.microsoft.com/en-us/library/aa450927.aspx)

# asp.net - 通过将“userid”类型更改为整数来自定义 asp.net 成员资格

> ID：482706
> 
> 赞同：3
> 
> 时间：2009-01-27T09:00:16.817
> 
> 标签：asp.net, database, integer, membership, uniqueidentifier

在 asp.net 成员中，是否可以将“userid”类型从“uniqueidentifier”更改为“integer”？怎么做？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-27T11:01:56.587

asp.net 成员身份 userid 数据类型在表模式中设置为 uniqueidentifier。您可能不想尝试更改列的数据类型，因为这样所有存储过程和 sqlmembership 提供程序也需要更改。但是您可以做的是创建一个查找表，该表将匹配具有指定用户 ID 唯一标识符的整数。查找表将有 2 列，一列用于来自 asp.net 成员身份的 UserId（唯一标识符的数据类型），然后是 int 类型的第二列，它将为您提供您正在寻找的整数。

但是在你继续这个之前，你应该问为什么你首先需要一个整数，或者一个 uniqueidentifier 会这样做吗？如果您尝试在现有数据库（其中 int 用于识别用户）之上改造 asp.net 成员资格提供程序，那么查找表应该可以正常工作。

# amazon-ec2 - Amazon EC2 许可证问题

> ID：482709
> 
> 赞同：2
> 
> 时间：2009-01-27T09:02:30.150
> 
> 标签：amazon-ec2

我想问一下许可如何在多个实例上工作？假设我有一个我之前购买的应用程序，并且我有一个 lincese 密钥来运行它。我将此应用程序安装到基本 AMI，然后输入许可证密钥，并将此实例绑定到新的 AMI。我需要来自这个 AMI 的 5 个实例。如果我从这个 AMI 运行 5 个实例，那么我将有 5 个实例，但我只有 1 个实例的许​​可证密钥。那么它是如何合法运作的呢？我需要使用 5 个不同的许可证密钥创建 5 个 AMI，然后从每个 AMI 创建 1 个实例？

感谢你的回答

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-27T09:32:38.887

这取决于管理您的操作系统的许可证。在这里，每个实例对应一个安装。如果您的许可证用于在 2 台机器上安装，那么您可以使用许可证密钥同时运行 2 个实例。同样，如果您拥有对一次安装有效的许可证密钥，则您只能运行一个实例。

在您的情况下，是的，您需要 5 个一安装许可证或一个 5 个安装实例才能同时运行 5 个实例。

如果您需要运行多个实例，您可能还想查看 OEM 或批量许可证。

希望这可以帮助。

# cocoa - 如何判断“系统偏好设置”中是否打开了旁白？

> ID：482716
> 
> 赞同：2
> 
> 时间：2009-01-27T09:04:34.233
> 
> 标签：cocoa, macos, macos-carbon, assistive

有没有办法，最好向后兼容 Mac OS X 10.3，来判断系统偏好设置中是否激活了“旁白”？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-27T21:21:59.347

这似乎存储在 Universal Access 的首选项文件中。应用标识符是“com.apple.universalaccess”，包含 VoiceOver 开启或关闭标志的键是“voiceOverOnOffKey”。您应该能够使用 CFPreferences API 来检索它，如下所示：

```
CFBooleanRef flag = CFPreferencesCopyAppValue(CFSTR("voiceOverOnOffKey"), CFSTR("com.apple.universalaccess")); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2019-03-11T13:46:48.313

If anyone has the same question, it could be good to know, that Voice Over status is accessible via convenient interface now:

```
NSWorkspace.shared.isVoiceOverEnabled 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2018-09-22T17:09:33.660

Based on Petes excellent answer I’ve created this **Swift 4.2** solution, which I find much easier to read. I also think it’s more handy to use a computed property in this case instead of a function.

```
var hasVoiceOverActivated: Bool {

    let key = "voiceOverOnOffKey" as CFString
    let id = "com.apple.universalaccess" as CFString

    if let voiceOverActivated = CFPreferencesCopyAppValue(key, id) as? Bool {
        return voiceOverActivated
    }

    return false

} 
```

VoiceOver and Accessibility in general are very important topics and it is sad that the lack of Apples documentation especially for macOS makes it so hard for developers to implement it properly.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-08-31T15:21:19.203

Swift 4 中的解决方案如下：

```
func NSIsVoiceOverRunning() -> Bool {

  if let flag = CFPreferencesCopyAppValue("voiceOverOnOffKey" as CFString, "com.apple.universalaccess" as CFString) {
    if let voiceOverOn = flag as? Bool {
      return voiceOverOn
    }
  }

  return false
} 
```

此外，要在 macOS 上使用 VoiceOver 发布文本通知，请执行以下操作：

```
let message = "Hello, World!"
NSAccessibilityPostNotificationWithUserInfo(NSApp.mainWindow!,
  NSAccessibilityNotificationName.announcementRequested,
  [NSAccessibilityNotificationUserInfoKey.announcement: message,
  NSAccessibilityNotificationUserInfoKey.priority:
  NSAccessibilityPriorityLevel.high.rawValue]) 
```

# vba - 如何从另一个工作簿（excel）复制数据？

> ID：482717
> 
> 赞同：6
> 
> 时间：2009-01-27T09:04:49.257
> 
> 标签：vba, excel

我已经有一个创建工作表和其他东西的宏。创建工作表后，我是否想调用另一个宏，将数据从第二个 excel（其打开）复制到第一个和活动的 excel 文件。

首先我想复制到标题，但我无法让它工作 - 不断出错。

```
Sub CopyData(sheetName as String)
  Dim File as String, SheetData as String

  File = "my file.xls"
  SheetData = "name of sheet where data is"

  # Copy headers to sheetName in main file
  Workbooks(File).Worksheets(SheetData).Range("A1").Select  # fails here: Method Select for class Range failed
  Workbooks(File).Worksheets(SheetData).Range(Selection, Selection.End(xlToRight)).Select
  Workbooks(File).Worksheets(SheetData).Selection.Copy ActiveWorkbook.Sheets(sheetName).Cells(1, 1)
End Sub 
```

怎么了 ？

我真的很想避免让“my file.xls”处于活动状态。

编辑：我不得不放弃它并将 SheetData 作为新工作表复制到目标文件，然后它才能工作。 [查找并选择多行](https://stackoverflow.com/questions/482889/how-to-find-and-select-multiple-rows-with-macro-excel)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2011-03-07T13:28:20.857

两年后（在谷歌上找到了这个，所以对于其他人来说）......正如上面提到的，你不需要选择任何东西。这三行：

`Workbooks(File).Worksheets(SheetData).Range("A1").Select
Workbooks(File).Worksheets(SheetData).Range(Selection, Selection.End(xlToRight)).Select
Workbooks(File).Worksheets(SheetData).Selection.Copy ActiveWorkbook.Sheets(sheetName).Cells(1, 1)`

可以换成

`Workbooks(File).Worksheets(SheetData).Range(Workbooks(File).Worksheets(SheetData). _
Range("A1"), Workbooks(File).Worksheets(SheetData).Range("A1").End(xlToRight)).Copy _
Destination:=ActiveWorkbook.Sheets(sheetName).Cells(1, 1)`

这应该可以解决选择错误。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-01-12T19:51:11.560

最佳做法是打开源文件（如果您不想被打扰，则显示错误的可见状态）读取您的数据，然后我们将其关闭。

下面的链接提供了一个工作和干净的代码：

[http://vba-useful.blogspot.fr/2013/12/how-do-i-retrieve-data-from-another.html](http://vba-useful.blogspot.fr/2013/12/how-do-i-retrieve-data-from-another.html)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-27T09:50:30.863

如果“我的文件.xls”不影响屏幕，您是否愿意激活它？关闭屏幕更新是实现此目的的方法，它还具有性能改进（如果您在切换工作表/工作簿时进行循环，这很重要）。

执行此操作的命令是：

```
 Application.ScreenUpdating = False 
```

不要忘记将其转回`True`您的宏完成时。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-29T14:22:12.213

我认为您根本不需要选择任何东西。我打开了两个空白工作簿Book1和Book2，将值“A”放在Book2中Sheet1的Range（“A1”）中，并在即时窗口中提交了以下代码-

Workbooks(2).Worksheets(1).Range("A1").Copy Workbooks(1).Worksheets(1).Range("A1")

Book1 的 Sheet1 中的 Range("A1") 现在包含“A”。

此外，鉴于在您的代码中您试图从 ActiveWorkbook 复制到“myfile.xls”，因此顺序似乎颠倒了，因为 Copy 方法应应用于 ActiveWorkbook 中的范围，以及目标（参数Copy 函数）应该是“myfile.xls”中的适当范围。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-02-27T16:20:19.167

我需要使用 VBA 将数据从一个工作簿复制到另一个工作簿。要求如下所述 1\. 按 Active X 按钮打开对话框以选择需要从中复制数据的文件。2\. 单击确定后，值应从单元格/范围复制到当前工作的工作簿。

我不想使用 open 函数，因为它会打开令人讨厌的工作簿

下面是我在 VBA 中编写的代码。欢迎任何改进或新的替代方案。

代码：这里我将 A1:C4 内容从工作簿复制到当前工作簿的 A1:C4

```
 Private Sub CommandButton1_Click()
        Dim BackUp As String
        Dim cellCollection As New Collection
        Dim strSourceSheetName As String
        Dim strDestinationSheetName As String
        strSourceSheetName = "Sheet1" 'Mention the Source Sheet Name of Source Workbook
        strDestinationSheetName = "Sheet2" 'Mention the Destination Sheet Name of Destination Workbook

        Set cellCollection = GetCellsFromRange("A1:C4") 'Mention the Range you want to copy data from Source Workbook

        With Application.FileDialog(msoFileDialogOpen)
            .AllowMultiSelect = False
            .Show
            '.Filters.Add "Macro Enabled Xl", "*.xlsm;", 1

            For intWorkBookCount = 1 To .SelectedItems.Count
                Dim strWorkBookName As String
                strWorkBookName = .SelectedItems(intWorkBookCount)
                For cellCount = 1 To cellCollection.Count
                    On Error GoTo ErrorHandler
                    BackUp = Sheets(strDestinationSheetName).Range(cellCollection.Item(cellCount))
                    Sheets(strDestinationSheetName).Range(cellCollection.Item(cellCount)) = GetData(strWorkBookName, strSourceSheetName, cellCollection.Item(cellCount))
                    Dim strTempValue As String
                    strTempValue = Sheets(strDestinationSheetName).Range(cellCollection.Item(cellCount)).Value
                    If (strTempValue = "0") Then
                        strTempValue = BackUp
                    End If
Sheets(strDestinationSheetName).Range(cellCollection.Item(cellCount)) = strTempValue 
ErrorHandler:
                    If (Err.Number <> 0) Then
                            Sheets(strDestinationSheetName).Range(cellCollection.Item(cellCount)) = BackUp
                        Exit For
                    End If
                Next cellCount
            Next intWorkBookCount
        End With

    End Sub

    Function GetCellsFromRange(RangeInScope As String) As Collection
        Dim startCell As String
        Dim endCell As String
        Dim intStartColumn As Integer
        Dim intEndColumn As Integer
        Dim intStartRow As Integer
        Dim intEndRow As Integer
        Dim coll As New Collection

        startCell = Left(RangeInScope, InStr(RangeInScope, ":") - 1)
        endCell = Right(RangeInScope, Len(RangeInScope) - InStr(RangeInScope, ":"))
        intStartColumn = Range(startCell).Column
        intEndColumn = Range(endCell).Column
        intStartRow = Range(startCell).Row
        intEndRow = Range(endCell).Row

        For lngColumnCount = intStartColumn To intEndColumn
            For lngRowCount = intStartRow To intEndRow
                coll.Add (Cells(lngRowCount, lngColumnCount).Address(RowAbsolute:=False, ColumnAbsolute:=False))
            Next lngRowCount
        Next lngColumnCount

        Set GetCellsFromRange = coll
    End Function

    Function GetData(FileFullPath As String, SheetName As String, CellInScope As String) As String
        Dim Path As String
        Dim FileName As String
        Dim strFinalValue As String
        Dim doesSheetExist As Boolean

        Path = FileFullPath
        Path = StrReverse(Path)
        FileName = StrReverse(Left(Path, InStr(Path, "\") - 1))
        Path = StrReverse(Right(Path, Len(Path) - InStr(Path, "\") + 1))

        strFinalValue = "='" & Path & "[" & FileName & "]" & SheetName & "'!" & CellInScope
        GetData = strFinalValue
    End Function 
```

# svn - 有没有办法只更新添加的文件？

> ID：482724
> 
> 赞同：0
> 
> 时间：2009-01-27T09:08:59.170
> 
> 标签：svn

我正在寻找一种方法来进行 svn 更新，但只获取自上次以来添加的文件（也就是说，它们对存储库来说是全新的）。我不确定这是否可能，有什么想法吗？

编辑：嗯，问题是这是一个非常大的存储库 - 进行正常更新需要很长时间，对于大多数用户来说，没有每个文件的最新版本是可以的，但所有文件都需要存在才能不休息。这就是为什么能够只获取添加的文件会很好的原因。

编辑：我也忘了提到我要执行此操作的目录不包含代码，所以我不必担心破坏它。对此感到抱歉，并感谢您的建议！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-27T09:25:24.677

如果您在 svn status 上使用 --show-updates 标志，您应该能够知道添加了什么，然后您可以执行一些 shell 脚本魔术来过滤和更新文件。

然而，正如其他人所说，这没有多大意义，而且您最终可能会遇到损坏的代码

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-27T09:12:53.063

除非您知道这些文件的确切名称/路径并逐个更新它们，否则我认为这是不可能的。

请编辑您的问题以解释您想将其用于什么，有人可能知道如何以不同的方式解决它。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-27T09:18:28.807

除非它们都是一个变更集的一部分，否则要找到哪些是新的会有点麻烦。无论如何，就像任何带有变更集的 VCS（不像 CVS 那样面向文件），它没有多大意义。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-27T09:54:46.253

关于我唯一可以推荐的是将解决方案分解为文件夹。然后，您可以只签出您当时正在处理的文件夹并在其中工作。更新和提交应该很快，因为您只在一个文件夹中工作。

但是，根据您的源布局，这可能效果不佳..

# c++ - 当用户杀死进程时发出信号？

> ID：482726
> 
> 赞同：3
> 
> 时间：2009-01-27T09:10:15.907
> 
> 标签：c++, windows-xp, crash, signals, kill-process

我重载了本网站[http://www.cplusplus.com/reference/clibrary/csignal/signal.html上列出的 6 个信号](http://www.cplusplus.com/reference/clibrary/csignal/signal.html)

然后我运行我的应用程序（双击未通过 IDE 运行）并尝试 1）结束任务 2）右上角的 X 和 3）终止进程。我预计前两个会引起某种信号（我在 XP 上），但可惜我什么也没得到。当信号发生时，我是否不允许打开要写入的文件？我猜我是（SIGSEGV 允许我）。

当 Firefox 崩溃或我杀死它时，它会记住我是什么页面。每次我点击一个页面时它都会记录地址还是在信号/崩溃时这样做？

我的主要问题是我可以使用什么信号来捕获终止进程

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-27T09:14:13.277

Win32 不提供拦截被杀死的程序的选项`TerminateProcess`（当您从任务管理器“结束任务”或单击 [X] 时会发生这种情况）。

您可以捕获 SIGSEGV 信号，因为 C 运行时库在 Windows 上运行时提供了此信号的模拟。当您的程序导致 Windows 访问冲突（异常 0xC0000005）时，运行时库可以选择捕获它并为您模拟 Unix 风格的 SIGSEGV。然而，这并不是处理此类异常的最佳方式。如果你正在编写一个 Win32 程序，你通常不应该尝试使用 Unix 风格的服务。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-27T14:31:22.000

如果您覆盖调用 SetUnhandledExceptionFilter 的默认异常处理程序（这是一个 win32 函数，因此不依赖于 C 库仿真），您可以捕获运行时错误，例如访问冲突。这是在程序崩溃时可用于提供“小型转储”的方法。

但是，当您正常关闭应用程序或从任务管理器关闭应用程序时，不会调用此异常处理程序。在最后一种情况下，windows 正在调用 TerminateProcess，这不是完全关闭，而是强制您的程序终止。

我不知道 Firefox 使用的是哪个实现，但是保存当前打开的选项卡可能会运行一个计时器，并且每次运行它都会将历史记录保存到文件和某种脏标记中。

检测程序何时关闭（由防病毒程序和类似程序实现）的其他更复杂的解决方案是运行两个不相关的程序，每个程序检查另一个程序是否仍在运行，如果一个检测到另一个程序已关闭，则再次运行它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-27T15:35:07.953

Windows 应用程序是控制台应用程序或 GUI 应用程序。控制台应用程序倾向于获得 WM_CLOSE，控制台应用程序 CTRL_CLOSE_EVENT。也不是信号。如果您的应用程序通过 TerminateProcess() 结束，则两者都不会发送。

如果您想存储您所在的位置，请使用内存映射文件并在每次操作时更新该文件。当你的进程退出时，内存中的脏页被操作系统写回文件，可能在其他时候也是如此。此解决方案允许操作系统为您管理磁盘 I/O，并且它处于更好的位置。

# c# - C# 遍历枚举？（索引 System.Array）

> ID：482729
> 
> 赞同：125
> 
> 时间：2009-01-27T09:11:44.687
> 
> 标签：c#, enums, iteration, system.array

我有以下代码：

```
// Obtain the string names of all the elements within myEnum 
String[] names = Enum.GetNames( typeof( myEnum ) );

// Obtain the values of all the elements within myEnum 
Array values = Enum.GetValues( typeof( myEnum ) );

// Print the names and values to file
for ( int i = 0; i < names.Length; i++ )
{
    print( names[i], values[i] ); 
} 
```

但是，我无法索引值。有没有更简单的方法来做到这一点？

或者我完全错过了什么！

* * *

## 回答 #1

> 赞同：220
> 
> 时间：2009-01-27T09:16:04.693

```
Array values = Enum.GetValues(typeof(myEnum));

foreach( MyEnum val in values )
{
   Console.WriteLine (String.Format("{0}: {1}", Enum.GetName(typeof(MyEnum), val), val));
} 
```

或者，您可以转换返回的 System.Array：

```
string[] names = Enum.GetNames(typeof(MyEnum));
MyEnum[] values = (MyEnum[])Enum.GetValues(typeof(MyEnum));

for( int i = 0; i < names.Length; i++ )
{
    print(names[i], values[i]);
} 
```

但是，您能确定 GetValues 返回值的顺序与 GetNames 返回名称的顺序相同吗？

* * *

## 回答 #2

> 赞同：35
> 
> 时间：2009-01-27T09:17:14.957

您需要转换数组 - 返回的数组实际上是请求的类型，即`myEnum[]`如果您要求`typeof(myEnum)`：

```
myEnum[] values = (myEnum[]) Enum.GetValues(typeof(myEnum)); 
```

然后`values[0]`等

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2009-01-27T09:21:08.927

您可以将该数组转换为不同类型的数组：

```
myEnum[] values = (myEnum[])Enum.GetValues(typeof(myEnum)); 
```

或者如果你想要整数值：

```
int[] values = (int[])Enum.GetValues(typeof(myEnum)); 
```

您当然可以迭代那些强制转换的数组:)

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2009-01-27T09:25:03.287

字典列表怎么样？

```
Dictionary<string, int> list = new Dictionary<string, int>();
foreach( var item in Enum.GetNames(typeof(MyEnum)) )
{
    list.Add(item, (int)Enum.Parse(typeof(MyEnum), item));
} 
```

当然，您可以将字典值类型更改为您的枚举值。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2010-01-04T23:44:08.993

这是另一个。我们需要为我们的 EnumValues 提供友好的名称。我们使用 System.ComponentModel.DescriptionAttribute 为每个枚举值显示自定义字符串值。

```
public static class StaticClass
{
    public static string GetEnumDescription(Enum currentEnum)
    {
        string description = String.Empty;
        DescriptionAttribute da;

        FieldInfo fi = currentEnum.GetType().
                    GetField(currentEnum.ToString());
        da = (DescriptionAttribute)Attribute.GetCustomAttribute(fi,
                    typeof(DescriptionAttribute));
        if (da != null)
            description = da.Description;
        else
            description = currentEnum.ToString();

        return description;
    }

    public static List<string> GetEnumFormattedNames<TEnum>()
    {
        var enumType = typeof(TEnum);
        if (enumType == typeof(Enum))
            throw new ArgumentException("typeof(TEnum) == System.Enum", "TEnum");

        if (!(enumType.IsEnum))
            throw new ArgumentException(String.Format("typeof({0}).IsEnum == false", enumType), "TEnum");

        List<string> formattedNames = new List<string>();
        var list = Enum.GetValues(enumType).OfType<TEnum>().ToList<TEnum>();

        foreach (TEnum item in list)
        {
            formattedNames.Add(GetEnumDescription(item as Enum));
        }

        return formattedNames;
    }
} 
```

正在使用

```
 public enum TestEnum
 { 
        [Description("Something 1")]
        Dr = 0,
        [Description("Something 2")]
        Mr = 1
 }

    static void Main(string[] args)
    {

        var vals = StaticClass.GetEnumFormattedNames<TestEnum>();
    } 
```

这将结束返回“Something 1”，“Something 2”

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2011-10-03T07:43:20.133

另一种解决方案，具有有趣的可能性：

```
enum Days { Monday, Tuesday, Wednesday, Thursday, Friday, Saturday, Sunday }

static class Helpers
{
public static IEnumerable<Days> AllDays(Days First)
{
  if (First == Days.Monday)
  {
     yield return Days.Monday;
     yield return Days.Tuesday;
     yield return Days.Wednesday;
     yield return Days.Thursday;
     yield return Days.Friday;
     yield return Days.Saturday;
     yield return Days.Sunday;
  } 

  if (First == Days.Saturday)
  {
     yield return Days.Saturday;
     yield return Days.Sunday;
     yield return Days.Monday;
     yield return Days.Tuesday;
     yield return Days.Wednesday;
     yield return Days.Thursday;
     yield return Days.Friday;
  } 
} 
```

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-01-27T09:15:38.300

使用 foreach 循环怎么样，也许你可以使用它？

```
 int i = 0;
  foreach (var o in values)
  {
    print(names[i], o);
    i++;
  } 
```

也许是这样的？

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2013-05-07T16:23:41.637

老问题，但使用 LINQ 的更简洁的方法`.Cast<>()`

```
var values = Enum.GetValues(typeof(MyEnum)).Cast<MyEnum>();

foreach(var val in values)
{
    Console.WriteLine("Member: {0}",val.ToString());     
} 
```

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2016-06-30T18:43:18.020

在 Enum.GetValues 结果中，转换为 int 会产生数值。使用 ToString() 生成友好名称。不需要对 Enum.GetName 进行其他调用。

```
public enum MyEnum
{
    FirstWord,
    SecondWord,
    Another = 5
};

// later in some method  

 StringBuilder sb = new StringBuilder();
 foreach (var val in Enum.GetValues(typeof(MyEnum))) {
   int numberValue = (int)val;
   string friendyName = val.ToString();
   sb.Append("Enum number " + numberValue + " has the name " + friendyName + "\n");
 }
 File.WriteAllText(@"C:\temp\myfile.txt", sb.ToString());

 // Produces the output file contents:
 /*
 Enum number 0 has the name FirstWord
 Enum number 1 has the name SecondWord
 Enum number 5 has the name Another
 */ 
```

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2009-01-27T09:35:07.293

Array 有一个 GetValue(Int32) 方法，您可以使用它来检索指定索引处的值。

[Array.GetValue](http://msdn.microsoft.com/en-us/library/system.array.getvalue.aspx)

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2012-10-12T17:00:56.497

您可以使用格式字符串简化此操作。我在使用消息中使用以下代码段：

```
writer.WriteLine("Exit codes are a combination of the following:");
foreach (ExitCodes value in Enum.GetValues(typeof(ExitCodes)))
{
    writer.WriteLine("   {0,4:D}: {0:G}", value);
} 
```

D 格式说明符将枚举值格式化为十进制。还有一个提供十六进制输出的 X 说明符。

G 说明符将枚举格式化为字符串。如果将 Flags 属性应用于枚举，则也支持组合值。有一个 F 说明符，就好像 Flags 总是存在一样。

请参阅 Enum.Format()。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-09-11T21:27:19.083

这是一种遍历自定义 Enum 对象的简单方法

```
For Each enumValue As Integer In [Enum].GetValues(GetType(MyEnum))

     Print([Enum].GetName(GetType(MyEnum), enumValue).ToString)

Next 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2018-08-01T00:06:10.843

古老的问题，但 3Dave 的回答提供了最简单的方法。我需要一个小助手方法来生成一个 Sql 脚本来解码数据库中的枚举值以进行调试。效果很好：

```
 public static string EnumToCheater<T>() {
        var sql = "";
        foreach (var enumValue in Enum.GetValues(typeof(T)))
            sql += $@"when {(int) enumValue} then '{enumValue}' ";
        return $@"case ?? {sql}else '??' end,";
    } 
```

我有一个静态方法，所以用法是：

```
var cheater = MyStaticClass.EnumToCheater<MyEnum>() 
```

# iphone - iPhone 中的视频拍摄

> ID：482730
> 
> 赞同：0
> 
> 时间：2009-01-27T09:12:02.673
> 
> 标签：iphone, video-capture, iphone-privateapi

有没有办法从 iPhone 捕捉视频？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-27T09:14:20.440

官方，没有。它目前无法通过 Apple 获得，他们也不提供 API。

但是，如果您越狱手机，您可以安装非官方应用程序来执行此操作。或者当然是自己写！

# php - Flash+PHP+cookie

> ID：482736
> 
> 赞同：0
> 
> 时间：2009-01-27T09:13:37.663
> 
> 标签：php, cookies, set

我只想在浏览器中播放一次动画。如果任何用户看过电影并且如果转到任何其他页面或刷新（F5）然后返回动画页面，则动画不应从头开始播放。我想从另一个帧播放它。

我认为这可以通过使用 javascript 或 php 设置 cookie 或 somthing 来完成。

请任何人帮助我。提前致谢。我将不胜感激，如果一些代码帮助请

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-27T09:36:30.800

您可以设置会话

```
session_start(); 
```

然后在flash数据之后设置一个session变量

```
$_SESSION["noflash"] = true; 
```

并在闪光灯上方进行检查

```
if(isset($_SESSION["noflash"]) && $_SESSION["noflash"] == true)
{
    // set the correct flashvars
} 
```

这样会话数据在闪存初始化后设置，当用户再次访问该站点时会话数据仍然打开。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-27T09:52:22.203

你可以做这样的事情

```
<?php
session_start();

$animation_start = isset( $_SESSION['seen_animation'] ) ? 'animation_start=middle' : 'animation_start=start';
$_SESSION['seen_animation'] = true;
?>

<!-- simplified flash embed -->
<object width="550" height="400">
    <param name="movie" value="myflash.swf" />
    <param name="FlashVars" value="<?php echo $animation_start ?>" />
    <embed src="myflash.swf" width="550" height="400" FlashVars = "<?php echo $animation_start ?>"></embed>
</object> 
```

您的 swf 中将有一个名为“animation_start”的全局变量，其中包含“start”或“middle”，让您知道从哪里播放电影

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-27T09:19:34.047

[使用 PHP，您可以使用SetCookie](http://si2.php.net/setcookie)函数设置 cookie 。在 JavaScript 中，您可以这样[设置](http://www.w3schools.com/JS/js_cookies.asp)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-05-18T07:56:18.233

不要忘记将字符串 $domain 设置为 '/' 或者它们可能不适用于所有子目录。问候。

# c++ - 枚举类型的命名空间 - 最佳实践

> ID：482745
> 
> 赞同：111
> 
> 时间：2009-01-27T09:17:19.963
> 
> 标签：c++, enums, scope, nested

通常，需要同时使用多个枚举类型。有时，一个人有一个名字冲突。想到了两个解决方案：使用命名空间，或使用“更大”的枚举元素名称。尽管如此，命名空间解决方案有两种可能的实现方式：一个具有嵌套枚举的虚拟类，或者一个完整的命名空间。

我正在寻找所有三种方法的优缺点。

例子：

```
// oft seen hand-crafted name clash solution
enum eColors { cRed, cColorBlue, cGreen, cYellow, cColorsEnd };
enum eFeelings { cAngry, cFeelingBlue, cHappy, cFeelingsEnd };
void setPenColor( const eColors c ) {
    switch (c) {
        default: assert(false);
        break; case cRed: //...
        break; case cColorBlue: //...
        //...
    }
 }

// (ab)using a class as a namespace
class Colors { enum e { cRed, cBlue, cGreen, cYellow, cEnd }; };
class Feelings { enum e { cAngry, cBlue, cHappy, cEnd }; };
void setPenColor( const Colors::e c ) {
    switch (c) {
        default: assert(false);
        break; case Colors::cRed: //...
        break; case Colors::cBlue: //...
        //...
    }
 }

 // a real namespace?
 namespace Colors { enum e { cRed, cBlue, cGreen, cYellow, cEnd }; };
 namespace Feelings { enum e { cAngry, cBlue, cHappy, cEnd }; };
 void setPenColor( const Colors::e c ) {
    switch (c) {
        default: assert(false);
        break; case Colors::cRed: //...
        break; case Colors::cBlue: //...
        //...
    }
  } 
```

* * *

## 回答 #1

> 赞同：81
> 
> 时间：2009-01-27T17:16:45.380

**原始 C++03 答案：**

a (over a )的*好处*是您可以在需要时使用声明。`namespace``class``using`

使用 a的*问题*`namespace`是命名空间可以在代码的其他地方扩展。在大型项目中，您不能保证两个不同的枚举不会都认为它们被调用`eFeelings`

对于看起来更简单的代码，我使用 a `struct`，因为您可能希望内容是公开的。

如果您正在执行这些实践中的任何一个，那么您就处于领先地位，并且可能不需要进一步审查。

**较新的 C++11 建议：**

如果您使用的是 C++11 或更高版本，`enum class`则将在枚举名称内隐式限定枚举值。

您将失去与`enum class`整数类型的隐式转换和比较，但在实践中，这可能会帮助您发现模棱两可或有缺陷的代码。

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2009-01-27T21:55:27.267

仅供参考，在 C++0x 中，您提到的情况有一种新语法（请参阅[C++0x wiki 页面](http://en.wikipedia.org/wiki/C%2B%2B0x#Strongly_typed_enumerations)）

```
enum class eColors { ... };
enum class eFeelings { ... }; 
```

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2013-02-20T19:20:20.003

我已经将前面的答案混合成这样的：（编辑：这仅对 C++11 之前的版本有用。如果您使用的是 C++11，请使用`enum class`）

我有一个包含我所有项目枚举的大头文件，因为这些枚举在工作类之间共享，将枚举放在工作类本身中是没有意义的。

`struct`避免了 public: 语法糖，并且允许您在其他工作类中实际声明这些枚举的`typedef`变量。

我认为使用命名空间根本没有帮助。也许这是因为我是 C# 程序员，在引用值时*必须*使用枚举类型名称，所以我已经习惯了。

```
 struct KeySource {
        typedef enum { 
            None, 
            Efuse, 
            Bbram
        } Type;
    };

    struct Checksum {
        typedef enum {
            None =0,
            MD5 = 1,
            SHA1 = 2,
            SHA2 = 3
        } Type;
    };

    struct Encryption {
        typedef enum {
            Undetermined,
            None,
            AES
        } Type;
    };

    struct File {
        typedef enum {
            Unknown = 0,
            MCS,
            MEM,
            BIN,
            HEX
        } Type;
    }; 
```

...

```
class Worker {
    File::Type fileType;
    void DoIt() {
       switch(fileType) {
       case File::MCS: ... ;
       case File::MEM: ... ;
       case File::HEX: ... ;
    }
} 
```

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2009-01-27T09:39:34.537

我肯定会避免为此使用课程；改用命名空间。问题归结为是使用命名空间还是对枚举值使用唯一 ID。就个人而言，我会使用命名空间，以便我的 id 可以更短，并且希望更不言自明。然后应用程序代码可以使用“使用命名空间”指令并使所有内容更具可读性。

从你上面的例子：

```
using namespace Colors;

void setPenColor( const e c ) {
    switch (c) {
        default: assert(false);
        break; case cRed: //...
        break; case cBlue: //...
        //...
    }
} 
```

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2012-04-22T15:41:18.637

使用类的好处是你可以在它之上构建一个成熟的类。

```
#include <cassert>

class Color
{
public:
    typedef enum
    {
        Red,
        Blue,
        Green,
        Yellow
    } enum_type;

private:
    enum_type _val;

public:
    Color(enum_type val = Blue)
        : _val(val)
    {
        assert(val <= Yellow);
    }

    operator enum_type() const
    {
        return _val;
    }
};

void SetPenColor(const Color c)
{
    switch (c)
    {
        case Color::Red:
            // ...
            break;
    }
} 
```

如上例所示，通过使用类，您可以：

1.  禁止（遗憾的是，不是编译时）C++ 允许从无效值进行强制转换，
2.  为新创建的枚举设置（非零）默认值，
3.  添加更多方法，例如返回选项的字符串表示。

请注意，您需要声明`operator enum_type()`以便 C++ 知道如何将您的类转换为底层枚举。否则，您将无法将类型传递给`switch`语句。

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2009-01-27T10:58:48.043

使用类或命名空间之间的区别在于，类不能像命名空间那样重新打开。这避免了将来可能滥用命名空间的可能性，但也存在无法添加到枚举集中的问题。

使用类的一个可能的好处是它们可以用作模板类型参数，而命名空间则不是这样：

```
class Colors {
public:
  enum TYPE {
    Red,
    Green,
    Blue
  };
};

template <typename T> void foo (T t) {
  typedef typename T::TYPE EnumType;
  // ...
} 
```

就个人而言，我不喜欢*using*，而且我更喜欢完全限定的名称，所以我并不认为这是命名空间的优点。但是，这可能不是您在项目中做出的最重要的决定！

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2009-01-27T15:25:37.723

由于枚举的范围仅限于它们的封闭范围，因此最好将它们包装在*一些东西*中以避免污染全局命名空间并帮助避免名称冲突。我更喜欢命名空间而不是类，因为`namespace`感觉就像是一个袋子，而`class`感觉就像一个健壮的对象（参见`struct`vs.`class`辩论）。命名空间的一个可能的好处是它可以在以后扩展 - 如果您正在处理无法修改的第三方代码，这很有用。

当然，当我们使用 C++0x 获得枚举类时，这一切都没有实际意义。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2009-09-24T06:47:53.193

我也倾向于将我的枚举封装在类中。

正如 Richard Corden 所指出的，类的好处是它是 c++ 意义上的类型，因此您可以将它与模板一起使用。

我有特殊的 toolbox::Enum 类来满足我的需要，我专门针对每个提供基本功能的模板（主要是：将枚举值映射到 std::string 以便 I/O 更易于阅读）。

我的小模板还具有真正检查允许值的额外好处。编译器在检查值是否真的在枚举中有点松懈：

```
typedef enum { False: 0, True: 2 } boolean;
   // The classic enum you don't want to see around your code ;)

int main(int argc, char* argv[])
{
  boolean x = static_cast<boolean>(1);
  return (x == False || x == True) ? 0 : 1;
} // main 
```

编译器无法捕捉到这一点总是让我感到困扰，因为你留下了一个没有意义的枚举值（而且你不会期望）。

相似地：

```
typedef enum { Zero: 0, One: 1, Two: 2 } example;

int main(int argc, char* argv[])
{
  example y = static_cast<example>(3);
  return (y == Zero || y == One || y == Two) ? 0 : 1;
} // main 
```

main 将再次返回错误。

问题是编译器会将枚举拟合为可用的最小表示（这里我们需要 2 位），并且适合该表示的所有内容都被认为是有效值。

还有一个问题是，有时您宁愿在可能的值上使用循环而不是开关，这样您就不必在每次向枚举添加值时修改所有开关。

总而言之，我的小帮手确实为我的枚举轻松了一些事情（当然，它增加了一些开销），而且这只是可能的，因为我将每个枚举嵌套在它自己的结构中:)

# version-control - 是否有版本控制系统允许您永久删除文件？

> ID：482751
> 
> 赞同：7
> 
> 时间：2009-01-27T09:19:18.463
> 
> 标签：version-control, large-files

我需要保留一些大文件（一些 Gigs）的版本。

我不需要，也不能保留所有版本的文件。我希望能够在某个时刻从我的 VCS 大文件版本中删除。

我想要保留在版本控制之下的文件是大的 .zip 文件或 ISO 映像。这些文件可能包含可执行软件或数据（地震数据、SAR 图像、GNSS 数据），它们由我公司的软件供应商提供。

我可以使用什么控制版本系统？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-27T09:24:21.323

在 CVS 中，您可以通过从 repo 中删除文件来做到这一点。Subversion 允许通过转储 repo 的内容并对其进行过滤以删除文件（这有点麻烦）。Perforce 对此有一个`obliterate`命令。许多较新的分布式 VCS 由于在各处使用散列而变得相当困难，而且您的存储库可能已在其他地方复制的事实也使事情变得复杂。Hg 有一个`strip`命令（`Mq`扩展的一部分），我认为 Git 也可以做到。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-27T09:23:08.627

我认为没有任何版本控制系统可以让您定期执行此操作，因为这与版本控制系统所代表的一切背道而驰。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-01-27T21:20:42.233

不知何故，我觉得你根本不应该使用版本控制系统。如前所述，您尝试做的事情与您首先需要版本控制系统的一切背道而驰。

我建议您创建一个对您要完成的工作有意义的文件系统目录结构，以便您可以构建数据。只需备份这些文件。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-01-27T13:49:28.260

Perforce 通常允许以两种方式放置文件，仅作为主要修订版（因此，您每个人都只有一份副本）或所有修订版。Perforce 确实有管理员级别的 obliterate 命令，可用于删除修订。由您来查询文件列表，可能按日期或修订数量，并指定 obliterate 命令的修订。顾名思义 obliterate 从数据库中永久删除修订，因此，我总是生成脚本来执行此操作并在运行它们之前对其进行检查。如果 obliterate 命令没有使用 -Y 标志运行，它将生成一个将被删除的列表，这也非常有用。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-01-27T13:30:04.883

TFS 有一个 destroy 命令，您可以使用它来永久删除您认为合适的文件或修订。

[此MSDN 文章](http://msdn.microsoft.com/en-us/library/bb386005.aspx)中有更多信息。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-28T23:40:08.147

在我看来，您需要一个智能备份系统，而不是版本控制。

我使用*[SyncBackSE](http://www.2brightsparks.com/syncback/sbse-features.html)*；它允许您保留许多以前的版本，还可以执行诸如“忽略 30 天前更改的所有文件”之类的操作。

它是我使用的少数付费软件之一。我认为值得一试。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-01-27T09:46:58.063

许多版本控制系统允许您以某种方式配置它们，以便它们仅存储文件的多个版本之间的差异并通过它节省空间。

例如，如果您提交了一个 1Gig 文件，更改其中的一部分并再次提交，则只有更改的部分将存储在版本控制系统中。
不会使用 2Gigs（初始文件和新文件），而只会使用 1Gig+sizeOfChanges。

只有一个缺点：如果您存储的文件在修订版本之间更改其全部内容，这也可能适得其反，因为更改占用的空间几乎与原始版本相同。存档文件是此类文件的一个示例，其中（实际）内容中的微小更改可能会导致存档文件的内容完全更改。

我建议您根据您的特定需求和环境自行测试多个版本控制系统，并在服务器端监控每个系统的存储需求如何变化。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-01-27T10:11:45.160

一些分布式版本控制系统允许创建“检查点”，允许您将此版本用作基础修订版，并防止您在每次结帐时提取检查点之前的所有历史记录。因此，您可以删除大文件，创建检查点，然后将存储库从该检查点检出/克隆到新目录。然后你有一个新的小型存储库，但没有检查点之前的历史记录。如果您不需要该历史记录，您可以将旧存储库刻录到 CD 上并从现在开始使用新的、部分存储库。

我只在[darcs](http://darcs.net/)中测试过它，它在那里工作，但 YMMV 取决于版本控制系统和用例。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2010-03-30T13:02:18.270

我认为您在谈论诸如“ AlienBrain”“桶”系统之类的东西，不是吗？从版本控制中删除某些修订的能力。如果你想销毁一个项目，它通常被称为“obliterate”，并且它得到了许多系统的支持。桶，AFAIK 支持：

*   [外星人大脑](http://www.nxn-software.com/)
*   [Accurev](http://www.accurev.com)
*   [塑料单片机](http://www.plasticscm.com)

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2010-05-21T03:48:59.033

I would save such files under a unique name (datestamped, perhaps), and perhaps additionally make a textual reference to the external file in the version control system.

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2010-05-21T03:51:59.113

[Fossil](http://fossil-scm.org) allows you to do this via the "shun" mechanism. Fossil being a distributed SCM, however, means that this does not affect all repositories (for obvious reasons).

# c - 在纯 C 中打印 void 类型

> ID：482757
> 
> 赞同：8
> 
> 时间：2009-01-27T09:22:52.713
> 
> 标签：c, printf, type-conversion, void

我有一个功能

```
void printMe (void *i)
{
    printf("%d", i);
} 
```

我想传递一个 void 指针并将其打印到屏幕上。如果 i 是整数、浮点数或双精度，则上面的示例很好，但如果 i 是字符，则崩溃。C 中没有像我通常在 C++ 中使用的重载。所以问题是这样的，我们是否可以在 C 中创建一个函数来打印它的参数元素，如果是的话，这怎么可能，因为此刻我完全无法理解。

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2009-01-27T09:25:32.367

Q1：*所以问题是这样的，我们可以在 C 中创建一个函数来打印它的参数元素吗？*

答：不是你想要的方式。您必须将信息传递给函数，告诉它您传递的数据类型。

Q2：*如果是的话，这怎么可能，因为此刻我完全无法理解。*

A：它在躲避你，因为它做不到。没有与 void* 关联的元数据，编译器或运行时可以使用这些元数据来确定它们所指向的类型。你需要要么

1.  传递一个包含
    指针和指针指向的信息的结构
    （例如枚举）。
2.  传递一个额外的参数，其中包含有关指针指向的信息

正如代码所示，您可以在这里打印的唯一内容是 i 指向的地址。

一个 void 指针指向原始数据， printf 假定您知道要打印的数据类型，它没有智能并且无法为您“弄清楚”。

就是这么简单。

你可以做的是将类型信息传递给函数，但是你最终会得到非常类似于 printf 它的自我，你传递一个格式化字符串，其中包含关于以下争论中数据的类型信息。

希望这可以帮助。

还 。. . “ *C 中没有我通常在 C++ 中使用的重载*”

即使在 c++ 中，重载也发生在编译时，编译器无法知道哪些数据将传递给该函数，因此即使您习惯于重载，它也永远不会像这样工作（例如，试试这个使用 printf 的东西，但是用 C++ 编译器编译它，你会得到完全相同的结果）。其实试试

```
cout << i; 
```

在上面的函数中，它会给你 i 指向的地址，而不是 i 的“值”。在获得它的价值之前，您需要强制转换 i 并尊重它

```
cout << *(int*)i; 
```

因此，要使上述在 C++ 中工作，您需要有很多重载函数（或模板函数，这实际上是同一件事，除了编译器会为您滚动函数），例如重载函数

```
printMe(int i){...}
printMe(double d){...}
printMe(char c){...}
printMe(char* string){...} 
```

在 c 中，您只需要为这些函数指定特定名称

```
printInt(int i){...}
printDouble(double d){...}
printChar(char c){...}
printString(char* string){...} 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-01-27T09:30:27.053

首先，您打印的是指针，而不是它指向的内容。要打印实际内容，您需要传递`*i`给`printf`，而不是`i`。

如果您真的想这样做，一种解决方案是：

```
void printMe (void *p, int typ) {
    switch(typ) {
        case TYP_INT: printf("%d", *((int*)p)); break;
        case TYP_CHR: printf("%c", *((char*)p)); break;
        /* and so on ... */
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-27T09:36:20.910

> 所以问题是这样的，我们可以在 C 中创建一个函数来打印它的参数元素吗？

我们可以。这样的函数已经是标准库的一部分——它被称为`printf`；）

由于 C 中没有编译时函数重载，因此您必须以某种方式在运行时提供参数的类型。格式字符串可`printf`用于执行此操作，因此当已经有可行的解决方案时，确实没有理由构建自己的包装函数。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-27T15:03:49.280

如果您试图打印出指针值，正确的用法是`printf("%p", i);`. “d”说明符用于整数，“p”用于指针。纠正这些是你的责任，如果你把它们混在一起，就会发生坏事。

我不知道为什么这对于 char * 而不是 int * 会失败，并且您可能还有其他问题导致了这种情况。如果它仍然因 %p 而失败，则其他事情搞砸了。看看您是否可以安装某种内存监控软件来检查悬空指针或双重 free()，因为那时聪明的钱就是您在某处损坏了内存。

# xml - 如何从 XML 样本生成 XSLT

> ID：482759
> 
> 赞同：7
> 
> 时间：2009-01-27T09:24:01.650
> 
> 标签：xml, xslt, xsd

我正在寻找一种用于*半自动*XSLT 生成的工具。

给定 2 个 XML 文件，来源：

```
<elm>XXX</elm> 
```

和目标：

```
<exx>XXX</exx> 
```

该工具应该生成 XSLT 文件，该文件从源中生成目标。查看内容，它应该识别级别、位置、元素名称等方面的变化。 *对此没有通用的解决方案*，但我只需要简单的转换。

可能的实现：

```
1\. scan the source, map XML data "XXX" to element path "elm"
2\. scan the target, map XML data "XXX" to element path "exx"
3\. output target XML structure, output XSLT mapping of "XXX", "elm" -> "exx" 
```

如果发生冲突，则需要人工干预。冲突可能是“XXX”，而不是源中的位置。

如果该工具也支持 XSD/DTD，例如进行手动“字段”映射，那就太好了。

**编辑**：澄清。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-01-27T09:36:55.790

我怀疑即使是简单的转换规则也可以自动生成。

以 XML 为例

```
<family>
  <father>Paul</father>
  <mother>Maria</mother>
  <child>Paul</child>
</family> 
```

和目标

```
<person>Paul</person> 
```

这应该是一个很常见的组合。我什至无法手动决定（没有想要转换的人的帮助）目标`<person`> 是从哪个标签创建的，从`<father`> 或`<child`> 所以我怀疑应用程序会在这里产生一些理智的东西。

**更新：** 如果您可以使用某种拖放式 XSLT 生成方式，那么有一些商业产品可用，但它们无法从目标文件生成 XSLT。但是拖放至少应该是比完全手动编写更好的解决方案：

*   [所见即所得的 XSLT 设计器](http://www.stylusstudio.com/xslt_designer.html)
*   Tiger XSLT Mapper（不再正式提供）

# jquery - JQuery 检查 DOM 中的重复 id

> ID：482763
> 
> 赞同：111
> 
> 时间：2009-01-27T09:24:30.777
> 
> 标签：jquery, dom

我正在使用 ASP.NET MVC 编写应用程序。与传统的 ASP.NET 相比，您更需要负责在生成的页面中创建所有 id。ASP.NET 会给你一些讨厌但独特的 id。

我想添加一个快速的小 jQuery 脚本来检查我的文档是否有重复的 id。它们可能是 DIVS、图像、复选框、按钮等的 id。

```
<div id="pnlMain"> My main panel </div>
<div id="pnlMain"> Oops we accidentally used the same ID </div> 
```

我正在寻找一个 set and forget type 实用程序，当我做某事粗心时它会警告我。

是的，我只会在测试期间使用它，也欢迎替代品（例如萤火虫插件）。

* * *

## 回答 #1

> 赞同：221
> 
> 时间：2009-02-04T03:32:46.327

以下将向控制台记录警告：

```
// Warning Duplicate IDs
$('[id]').each(function(){
  var ids = $('[id="'+this.id+'"]');
  if(ids.length>1 && ids[0]==this)
    console.warn('Multiple IDs #'+this.id);
}); 
```

* * *

## 回答 #2

> 赞同：35
> 
> 时间：2011-02-11T09:10:11.183

这个版本有点快，你可以把它复制到一个书签按钮，使它成为一个书签。

```
javascript:(function () {
  var ids = {};
  var found = false;
  $('[id]').each(function() {
    if (this.id && ids[this.id]) {
      found = true;
      console.warn('Duplicate ID #'+this.id);
    }
    ids[this.id] = 1;
  });
  if (!found) console.log('No duplicate IDs found');
})(); 
```

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2011-03-18T18:15:48.500

我有一个大页面，因此脚本运行速度太慢而无法完成（多个“继续脚本”消息）。这工作正常。

```
(function () {
    var elms = document.getElementsByTagName("*"), i, len, ids = {}, id;
    for (i = 0, len = elms.length; i < len; i += 1) {
        id = elms[i].id || null;
        if (id) {
            ids[id] =  ids.hasOwnProperty(id) ? ids[id] +=1 : 0;
        }
    }
    for (id in ids) {
        if (ids.hasOwnProperty(id)) {
            if (ids[id]) {
                console.warn("Multiple IDs #" + id);
            }
        }
    }
}()); 
```

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2009-01-27T09:31:23.773

您应该尝试[HTML Validator](https://addons.mozilla.org/en-US/firefox/addon/249)（Firefox 扩展）。它肯定会告诉您该页面有重复的 id 等等。

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2009-01-27T09:29:11.563

你为什么不验证你的html？

不允许使用双 ID，通常会出现解析错误。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2020-06-02T06:00:30.343

用 ES6 重写的顶级 jQuery 答案：

```
 [...document.querySelectorAll('[id]')].forEach(el => {
    const dups = document.querySelectorAll(`[id="${el.id}"]`);

    if (dups[1] === el) {
      console.error(`Duplicate IDs #${el.id}`, ...dups);
    }
  }); 
```

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2009-06-11T20:53:21.353

还有另一种定位重复项的方法，但这会添加一类错误，因此它将具有红色文本：

```
// waits for document load then highlights any duplicate element id's
$(function(){ highlight_duplicates();});

function highlight_duplicates() {
  // add errors when duplicate element id's exist
  $('[id]').each(function(){ // iterate all id's on the page
    var elements_with_specified_id = $('[id='+this.id+']');
    if(elements_with_specified_id.length>1){
      elements_with_specified_id.addClass('error');
    }
  });

  // update flash area when warning or errors are present
  var number_of_errors = $('.error').length;
  if(number_of_errors > 0)
    $('#notice').append('<p class="error">The '+number_of_errors+
      ' items below in Red have identical ids.  Please remove one of the items from its associated report!</p>');
} 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-01-27T10:00:29.910

这可能会奏效它会提醒所有重复元素的 id。

```
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<html>
    	<head>
    		<script type="text/javascript" src="jquery-1.3.1.min.js"></script>
    		<script type="text/javascript">
    			function findDupes()
    			{
    			  var all = $("*");
    			  for(var i = 0; i < all.length; i++)
    			  {
    			      if (all[i].id.length > 0 && $("[id='" + all[i].id + "']").length > 1) alert(all[i].id);
    			  }
    			}
    		</script>
    	</head>
    	<body onload="findDupes()">
    		<div id="s"></div>
    		<div id="f"></div>
    		<div id="g"></div>
    		<div id="h"></div>
    		<div id="d"></div>
    		<div id="j"></div>
    		<div id="k"></div>
    		<div id="l"></div>
    		<div id="d"></div>
    		<div id="e"></div>
    	</body>
    </html>
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2014-08-16T04:10:51.717

我喜欢这个，因为它将实际元素吐出到控制台。它使调查正在发生的事情变得更容易。

```
function CheckForDuplicateIds() {
var ids = {};
var duplicates = [];

$("[id]").each(function() {
    var thisId = $(this).attr("id");
    if (ids[thisId] == null) {
        ids[thisId] = true;
    } else {
        if (ids[thisId] == true) {
            duplicates.push(thisId);
            ids[thisId] = false;
        }
    }
});
if (duplicates.length > 0) {
    console.log("=======================================================");
    console.log("The following " + duplicates.length + " ids are used by multiple DOM elements:");
    console.log("=======================================================");
    $(duplicates).each(function() {
        console.warn("Elements with an id of " + this + ":");
        $("[id='" + this + "']").each(function() {
            console.log(this);
        });
        console.log("");
    });
} else {
    console.log("No duplicate ids were found.");
}
return "Duplicate ID check complete."; 
```

}

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2016-03-21T11:15:12.693

您可以使用此解决方案，该解决方案将在控制台中打印出重复 ID 列表（如果存在）。

加载 DOM 后，您可以直接在控制台（复制/粘贴）中运行代码，不需要像 jQuery 那样的额外依赖。

您可以使用它快速找出 HTML 标记中可能存在的错误。

```
 (function (document) {
        var elms = document.body.querySelectorAll('*[id]'),
            ids = [];
        for (var i = 0, len = elms.length; i < len; i++) {
            if (ids.indexOf(elms[i].id) === -1) {
                ids.push(elms[i].id);
            } else {
                console.log('Multiple IDs #' + elms[i].id);
            }
        }
    })(document); 
```

一个例子：

[https://jsbin.com/cigusegube/edit?html，控制台，输出](https://jsbin.com/cigusegube/edit?html,console,output)

（此处代码是在关闭`body`标签之前添加的）

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2015-08-18T18:19:31.747

我创建了一个函数，您可以在其中检查特定元素，在其中或整个页面中搜索重复的 id：

```
function duplicatedIDs(container) {

    var $container  = container ? $(container) : $('body'),
        elements = {},
        duplicatedIDs = 0;
        totalIDs = 0;

    $container.find('[ID]').each(function(){
        var element = this;

        if(elements[element.id]){
            elements[element.id].push(element);
        } else  {
            elements[element.id] = [element];
        }
        totalIDs += 1;

    });

    for( var k in elements ){
        if(elements[k].length > 1){
            console.warn('######################################')
            console.warn('        ' + k )
            console.warn('######################################')
            console.log(elements[k]);
            console.log('---------------------------------------');
            duplicatedIDs += elements[k].length
        }
    }
    console.info('totalIDs', totalIDs);
    console.error('duplicatedIDs', duplicatedIDs);
}

duplicatedIDs('#element'); //find duplicated ids under that element
duplicatedIDs(); // entire page 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2020-12-09T10:30:37.063

我们可以直接将以下脚本粘贴到浏览器控制台中以获取重复 ID

```
[...document.querySelectorAll('[id]')].filter(el => [...document.querySelectorAll('[id]')].map(el => el.id).filter(id => id === el.id).length > 1); 
```

参考：[https ://www.abeautifulsite.net/getting-duplicate-ids-in-an-html-document](https://www.abeautifulsite.net/getting-duplicate-ids-in-an-html-document)

# apache-flex - flex 3 手风琴组件和圆角

> ID：482769
> 
> 赞同：1
> 
> 时间：2009-01-27T09:28:08.430
> 
> 标签：apache-flex, accordion, rounded-corners

我在 Flex 中使用手风琴组件，但似乎无法让标题具有圆角。页脚圆没有问题，但标题仍然是正方形，有什么建议吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-27T14:31:42.780

这是[Doug McCune 的一个深入示例，](http://dougmccune.com/blog/2007/09/22/nifty-flex-accordion-menu-like-on-applecom/)展示了如何自定义 Accordion 控件，并附有源代码和解释，他在其中做了类似的事情。虽然具体情况取决于您要执行的操作，但本质上您需要重新设置手风琴项标题的按钮和/或选择皮肤。

蒙皮可能有点棘手，其中一件看起来应该比实际更容易的事情（而且我个人发现使用 Flash 进行蒙皮对于除了最简单的情况之外的所有情况都是一种痛苦；我更喜欢在代码中进行或标记），但是如果您花一点时间在示例中的代码上，我相信您会看到正在发生的事情并能够应用于您的项目。希望它有所帮助——祝你好运！

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2009-01-27T10:18:09.170

您最好的选择可能是在 flash 中设计皮肤并在 flex 中使用该皮肤。

我建议从这里下载 flex 蒙皮模板

[http://www.adobe.com/cfusion/entitlement/index.cfm?event=custom&sku=RC00530&e=flex_skins](http://www.adobe.com/cfusion/entitlement/index.cfm?event=custom&sku=RC00530&e=flex_skins)

安装它。

当 flash 打开时，转到“从模板创建”并单击更多。选择弹性皮肤。您可以选择只创建手风琴模板或完整的皮肤模板。随心所欲地设计它。运行它以创建一个 swc，然后将该 swc 导入 flex。然后，您可以在手风琴面板中使用该皮肤。

这样你的皮肤可以设计成圆角（确保你启用了 9 级，以便它们正确缩放）

# delphi - 焦点未移至 inputbox() 且框仍位于应用程序后面（Vista）

> ID：482773
> 
> 赞同：0
> 
> 时间：2009-01-27T09:30:16.647
> 
> 标签：delphi

如何使用标准的 vcl inputbox() 函数使我的 delphi 系统托盘应用程序请求焦点，现在对话框似乎保留在任务栏中，并且对话框没有打开到其他应用程序的前面。这是我认为的Vista问题。我相信创建自己的表单会解决它。

ps：如果需要，我可以编辑 dialogs.pas，它似乎正在使用 Tcustomforms.showmodal

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-27T12:58:37.693

您可能正在使用旧版本的 delphi。

一些针对旧版 delphi 版本的特定于 Vista 的解决方法在[这里](http://www.theabsolute.net/sware/delphivista.html)很受欢迎。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-07-16T21:03:08.650

`Application.ProcessMessages;`在输入框调用之前尝试。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-27T13:57:16.450

您 `application.BringtoFront()` 在启动输入框之前尝试过吗？

编辑 dialogs.pas 似乎是个坏主意。我宁愿制作自己的输入框表单。

但是，应用程序窃取焦点可能会很烦人……您如何启动输入框？在计时器上，还是在用户请求上（例如点击图标）？

# windows - Delphi 和 XP 嵌入式

> ID：482777
> 
> 赞同：4
> 
> 时间：2009-01-27T09:31:35.303
> 
> 标签：windows, delphi, embedded

有谁知道 Delphi (Win32) 是否适用于 XP Embedded

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-27T10:43:54.860

是的，它是简短的答案

我们将 Delphi 5 与 WePos（为销售点嵌入的窗口）一起使用，它运行良好。

通过 BDE 运行 Interbase 5.5

我们唯一要做的就是安装一个额外的文件。该文件名为“libraryfiles.exe”，我知道描述性不是很强，这里有更多信息可以帮助您找到它

> Ascentive 库文件
> 
> 版本：2.0.0.24
> 
> 产品名称：Libraryfiles 安装程序

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-27T09:42:02.113

一般来说，它似乎可以工作（[例如XPE 的Delphi 程序](http://www.magsys.co.uk/delphi/magewf.asp)），但是在使用某些特定库（即XML）时可能会出现一些问题，其中XP 嵌入可能与通常的XP 安装不同。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-27T17:58:54.233

我最近完成了一个带有 ActiveForm 的项目，大量使用 OpenGL，内部有大量第三方库，一切都像 XP 嵌入式的魅力一样工作。

顺便说一句，我没有被告知这个东西是要在 XP 嵌入式上运行的......

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-17T10:09:48.473

XP Embedded**就是**XP，具有删除大量内容的能力。几乎任何在 XP 上运行的东西都可以在 XPE 上运行。通常，关键是像[@Re0sless 那样](https://stackoverflow.com/questions/482777/delphi-and-xp-embedded/482933#482933)找到库。

# asp.net - .NET 使用 Cruisecontrol.net + nant 自动构建 - 多重装配结构/最佳实践

> ID：482782
> 
> 赞同：0
> 
> 时间：2009-01-27T09:35:30.443
> 
> 标签：asp.net, build-process, continuous-integration, cruisecontrol.net

我正在处理几个共享的 .NET 程序集和一个通用 Web 应用程序，我希望在我们的 CC.NET/NAnt 构建环境中更好地处理它们。

目前，我们有几个 .NET 程序集（我们在客户端项目中使用的共享公共代码），它们存在于我们 SCM 的不同存储库中的不同 .NET 解决方案中（顺便说一下 Vault）。它们都在 CC.NET 下单独配置，因此我们目前对它们的构建和部署有相当大的控制权。

我们开发了一个 CMS 系统，该系统使用一些 .NET 程序集，包括一个公共管理网站项目和一个模板网站示例项目。在这个解决方案中，我们有以下需要单独管理的元素：

*   管理界面与 .NET 无关，因此它是基于模板的，我们目前正在为其开发 PHP 后端。
*   CMS 共享程序集建立在我们其他常见的公司范围程序集之上。
*   控制每个主要 CMS 构建/发布中的功能。

我希望这个解决方案的构建输出成为一个 Visual Studio 模板，当我们向代码库添加功能时，我们可以使用它来开发其他客户端站点并更好地管理 CMS 本身内的版本更改。

对于这一切，我有一个粗略的方法，并且认为它是可以实现的，但是，我想打开这个话题进行讨论，看看其他人在管理多个解决方案的构建和部署时都在做什么。

我们的主要考虑因素是：

*   我们是否利用 CC.NET 中的集成队列功能来确保构建顺序并在构建时将 CMS 所需的程序集组合在一起？
*   在 CMS 客户端站点内进行调试，即当客户端解决方案是基本 CMS 系统的一个版本并因此是独立的时，单步执行共享程序集的代码。
*   在使用共享程序集时开发和扩展 CMS，即我们是否在开发期间（跨源代码控制存储库）将程序集项目添加到主干解决方案，然后依赖构建将其拉到一起，还是我们完全使用不同的方法？
*   人们可能遇到的任何其他问题可能会改变我们的思维方式？

希望这个问题不是太含糊，你们中的一些人会处理这些问题。期待听听大家的经验。

非常感谢！蒂姆

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-29T19:02:51.400

不幸的是，我无法回答您的所有观点，但让我从这个开始：

> *   我们是否利用 CC.NET 中的集成队列功能来确保构建顺序并在构建时将 CMS 所需的程序集组合在一起？

简短的回答是——是的，你应该这样做。queue 属性确保 CC.NET 运行实例中的构建顺序，并为您提供相互依赖的构建的序列化。要指定哪些项目相互依赖，您应该使用[项目触发器](http://confluence.public.thoughtworks.org/display/CCNET/Project+Trigger)。不要*依赖*此任务的 queuePriority。

您很可能会在构建时拉出构建所需的部分。除非您对个人构建有一些时间限制。

回覆：

> *   在使用共享程序集时开发和扩展 CMS，即我们是否在开发期间（跨源代码控制存储库）将程序集项目添加到主干解决方案，然后依赖构建将其拉到一起，还是我们完全使用不同的方法？

我基本上反对在主干中分发二进制文件，除非它是一些不需要经常更新/更改的库。如果您自己构建共享程序集，您应该考虑从构建服务器上的工件中提取它们。

# asp.net - 有哪些选项可以确定我的 ASP.NET MVC 视图是否不兼容 XHTML

> ID：482787
> 
> 赞同：-1
> 
> 时间：2009-01-27T09:37:26.040
> 
> 标签：asp.net, xhtml, tag-soup

**澄清**：感谢验证 XHTML 的工具的建议。我主要是在寻找一个可以在服务器端（或在客户端使用 jQuery）运行的解决方案，这样我就可以在开发过程中设置它并忘记它——当我遇到问题时被告知，而不必一直运行工具。

* * *

所有这些[标签汤](https://stackoverflow.com/questions/363465/how-do-i-get-over-my-fears-of-in-my-asp-net-mvc-markup)的东西都让我害怕 ASP.NET MVC ！

如果我可以验证来自我的视图生成器的每个视图是否符合 XHTML，我就不会那么害怕了。这对于我计划编写的大量 jQuery 尤其重要。我不想花几个小时调试某些东西，只是为了发现我在某处有一个未关闭的标签，它阻止了选择器的工作。

有什么选择。在我的脑海中，我正在寻找类似以下的解决方案，但不确定其中哪些是实用的：

*   JQuery XHTML 检查器
*   IIS 过滤器
*   浏览器插件（我假设 Firebug 插件可以做到这一点）
*   用 MVC 视图类做一些聪明的事情（我不确定这是否可能或值得说服）。
*   修改 HTML 编写器以检查“flush()”并在输出不是 XHTML 时抛出异常。
*   我不知道要验证页面的 ASP.NET 配置选项。

所有选项欢迎回答！

我更喜欢服务器端技术，因此在调试期间我可以抛出一个硬异常，并且在生产中我可以记录任何错误。它必须在应用母版页后验证整个页面。在 IDE 中寻找警告并不是一个足够好的解决方案！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-27T09:40:25.223

作为插件，Firefox 有[HTML Validator](https://addons.mozilla.org/en-US/firefox/addon/249)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-27T10:01:14.523

[w3c html 验证器](http://validator.w3.org/source/)可用作源代码，因此您可以下载它并用它做几乎任何您想做的事情。您可以使用 URL 列表对其进行设置，以不断爬取您的测试服务器并记录任何错误。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-27T10:13:55.683

正如 Jeremy 所说，W3C 验证器就在那里，但在旁注中检查您的视图/站点的可访问性，您可以[TAW](http://www.tawdis.net/taw3/cms/en)。

我意识到这有点离题，但它仍然是网站开发的重要组成部分。

# jsp - 如何在 JSP 中包含 @include 的运行时文件

> ID：482788
> 
> 赞同：3
> 
> 时间：2009-01-27T09:37:51.140
> 
> 标签：jsp

要在 JSP 中包含另一个文件，我们使用 @include 标记

*<%@ 包含文件="NameOfFile"%>*

在我的情况下，我想包含一个 html 文件，其名称将在运行时已知 - 即来自数据库。

我怎样才能在 JSP 中做到这一点？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-27T09:46:30.983

只需使用 jsp:include ：

```
<jsp:include page="<%= htmlFileName %>" /> 
```

它适用于我的项目，其中文件存储在会话中以正确重新加载使用 ajax 更新的部分

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-06-05T19:32:12.107

您可以使用**包含指令**

```
<%@include file="<%=FileName%>"%> 
```

或**JSP 包含动作**

```
<jsp:include page="<%=FileName%>"/> 
```

不同的是 include 指令在翻译阶段包含一个文件。

而 JSP 包含操作在请求页面时包含一个文件

我推荐 Spring MVC Framework 作为你的控制器来操作。使用 url 模式而不是参数。

例子：

```
www.yourwebsite.com/products 
```

代替

```
www.yourwebsite.com/?p=products 
```

观看此视频[Spring MVC 框架](http://youtu.be/Q6hZQ5SzGyM)

# .net - 为 .Net 中的并发性优化的集合

> ID：482791
> 
> 赞同：1
> 
> 时间：2009-01-27T09:39:46.300
> 
> 标签：.net, collections, concurrency

在 Java 世界中，有一组针对并发任务进行了优化的[类。](http://java.sun.com/j2se/1.5.0/docs/api/java/util/concurrent/package-summary.html "java.util.concurrent")我认为.Net 中有类似的东西，但是在 MSDN 中快速搜索后我找不到任何东西。我正在寻找一个在消费者/生产者情况下使用的具有公平政策的队列。

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-27T09:45:15.167

Parallels Library for .NET 包含一些线程安全的集合。

其中一个是`ConcurrentQueue<T>`

[http://blogs.msdn.com/pfxteam/archive/2008/08/12/8852005.aspx](http://blogs.msdn.com/pfxteam/archive/2008/08/12/8852005.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-27T11:29:58.137

肯定是矛盾的？线程安全的集合可能会获得比所需更多的锁。为了优化，通常将锁定义在更高的位置。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-27T10:11:54.143

非通用 .NET 集合（System.Collections 命名空间）都可以做到这一点。我从[MSDN Queue.SyncRoot 页面](http://msdn.microsoft.com/en-us/library/system.collections.queue.syncroot.aspx)中截取了以下片段：

```
Queue myCollection = new Queue();

lock(myCollection.SyncRoot)
{
   foreach (Object item in myCollection)
   {
      // Insert your code here.
   }
} 
```

或者您可以立即创建一个同步包装器：

```
Queue mySyncCollection = Queue.Synchronized(myCollection);
// No locks required 
```

不幸的是，这不可能与泛型集合有关，因此如果您想使用泛型集合，您可能必须编写自己的包装器/扩展方法。

# c++ - 访问对象层次结构的子集（不是子树）

> ID：482798
> 
> 赞同：0
> 
> 时间：2009-01-27T09:44:09.847
> 
> 标签：c++, oop

我有一个包含子节点列表的基类“节点”。Node 定义了一个“forEachNode”函数，它将回调作为参数并在层次结构中的每个节点上调用它。

我有一个派生自 Node 的类——“SpecialNode”（不是我真正选择的名称——只是一个例子！）。Node 对 SpecialNode 一无所知。

我想只迭代 SpecialNodes。我已经到了 SpecialNode 定义一个回调以传递给“forEachNode”的地步，但我不确定如何仅为 SpecailNodes 调用回调。有什么建议吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-27T09:55:44.833

您可以尝试以下方法：

```
if (dynamic_cast<SpecialNode*>(n) != NULL) {
    do_something();
} 
```

或者你在 Node 中放置一个虚函数以便从回调中调用，你可以在子类中以不同的方式实现。

# c# - C# - 从类内部调用方法

> ID：482800
> 
> 赞同：1
> 
> 时间：2009-01-27T09:45:21.657
> 
> 标签：c#, c#-3.0, reference, methods

如何从客户端代码中定义的类中调用客户端代码方法？

例如，我有一个内存读取类，它可以从某个地址的进程内存中读取值。我还有用于管理从内存中读取的数据类型的类（我正在阅读游戏中的“对象”。在“客户端代码”中，我正在计算该对象在内存中的“基地址”，然后初始化我的“对象类”使用将“基地址”作为参数的构造函数。然后，该基类应该能够通过方法告诉我有关该对象的信息，因为对象知道某个值距基地址有多远，例如“健康”）

我尝试使用这样的代码，它给了我一个错误。'ObjectManager' 是可以从内存中读取值的类。

```
class ObjectManager : Memory
{
    LocalCharacter LocalPlayer = new LocalCharacter(this);
    // other things omitted
}
// Error: Keyword 'this' is not available in the current context 
```

而这个，出于绝望：

```
class ObjectManager : Memory
{
    LocalCharacter LocalPlayer = new LocalCharacter(ObjectManager);
    // other things omitted
}
// Error: Keyword 'this' is not available in the current context 
```

但无济于事。做这个的最好方式是什么？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-01-27T09:47:17.407

如何在构造函数中引用“this”：-

```
class ObjectManager : Memory
{
    ObjectManager()
    {
        LocalPlayer = new LocalCharacter(this);
    }

    LocalCharacter LocalPlayer;
    // other things omitted
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-27T09:48:23.677

因为你不在一个方法中。

您必须声明一个方法来访问它。您的 main 函数将调用该调用。

如果您希望设置类级别字段，则需要在构造函数中进行。您仍然在类定义中声明变量（而不是在方法中）

```
class ObjectManager : Memory
{
   public void mymethod()
   {
      LocalCharacter LocalPlayer = new LocalCharacter(this);
   }
} 
```

# design-patterns - 关于责任链模式，已知的“陷阱”是什么？

> ID：482804
> 
> 赞同：12
> 
> 时间：2009-01-27T09:46:43.477
> 
> 标签：design-patterns, oop, chain-of-responsibility

在我当前的项目中，我发现自己经常使用[责任链](http://en.wikipedia.org/wiki/Chain-of-responsibility_pattern)模式（对我来说经常是 3 次），我想知道我是否对解决方案变得有点过度热情。具体来说，我一直在使用 Apache Commons[链项目](http://commons.apache.org/chain/)。所以，到目前为止，我对它如何将许多复杂的、可互换的应用程序逻辑简化为一个更有凝聚力和组织性的整体印象深刻。然而，该项目的一些新人似乎很难“得到它”。你有什么经验？您在实施过程中遇到了哪些问题？

到目前为止，我注意到的唯一问题是当您尝试处理需要关闭的对象时。当您完成链的执行时，将这些对象存储在您的 Context 类中会很痛苦。我能够使用过滤器而不是命令来解决这个问题，但这似乎有点不直观，因为您的关闭语句通常离对象实例化的位置很远。

无论如何，我很想听听一些对这种模式有更多经验的开发人员的想法。

提前致谢。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-01-27T10:27:24.690

我很想说它对于*非特定*问题（例如框架代码）效果很好，但对于*特定*问题效果较差。框架是为其他人使用而编写的，您希望给客户完全的实施自由。一旦你确切地知道你将要做什么来解决这个问题，我认为其他解决方案会更好。

责任链模式的危险与黑板模式非常相似：很容易最终创建大量抽象，而这些抽象大多不会为实现最终目标提供价值。命令对象和处理对象实际上只是将应用程序的逻辑隐藏在处理链后面，而不是将其放在最重要的代码所在的前面。如果您只编写一个表示完整处理链的方法（或几个方法），而不需要处理链的抽象，那么理解和维护这一点要容易得多。处理链确实可以隐藏你的应用程序的业务逻辑，我认为你将技术工件优先于业务代码。

所以基本上你用更抽象的处理链替换了*本来可以*非常简单易读的应用程序代码*。*你正在做元编程。就我个人而言，我不再进行任何元编程，所以我倾向于同意那些不喜欢它的同事。;)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-27T10:44:53.733

我认为可以公平地说，总的来说，如果给定的设计模式能给你带来更多的好处而不是成本，那么它是值得使用的。每个模式都在代码中引入了额外的间接级别，因此更难遵循，尤其是对于团队的初级成员。话虽如此，我认为如果您不知道哪些类将进行处理（因此在链中），或者您以不同的方式重用这些类，我认为*责任链*模式绝对有用上下文，在不同的场景中创建不同的链等。

一般来说，我认为过度设计您的解决方案是非常糟糕的（因为正如您所说，新人很难理解它），但在某些情况下设计模式非常有用。

# javascript - Javascript function() 文字重载

> ID：482808
> 
> 赞同：2
> 
> 时间：2009-01-27T09:47:22.667
> 
> 标签：javascript, constructor, debugging, overloading

我一直很好奇是否有可能重载函数文字，就像你可以用函数做的那样：

```
var test=Function;
Function=function(arg)
{
      alert('test');
      return test(arg);
}

var b=Function("alert('a')");
var c=Function("alert('x')");
b();
c(); 
```

当然你可以猜到这是调试整个项目的好方法。然而，我在这里所做的任何努力都是徒劳的。

给各位专家的问题是：

1.  也许有一些我不知道的东西，也许有可能重载这个该死的构造函数？（但可能不是）。
2.  如果不是那么 - 如何做到这一点 - 如果可能的话 - 在任何浏览器中（不仅仅是使用 javascript - 而是他们的扩展语言 - 每个浏览器都有这样的东西）。
3.  如果不是那么 - 这是如何通过像萤火虫等插件完成的？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-27T09:55:58.250

您的术语已关闭：`Function()`is the function *constructor*，而`function() {...}`is a *function literal*。

不，我不认为有一种可移植的方式来做到这一点，但对于旧版本的 Firefox 可能有：如果我没记错的话，它曾经可以用来`with() {...}`隐藏内置的构造函数，而 Firefox 会使用即使是文字也有新的。

这似乎不再起作用：

```
var overload = {
    Object : function() {}
};

overload.Object.prototype.foo = 'bar';

with(overload) {
    document.writeln(new Object().foo);
    document.writeln({}.foo);
} 
```

# c# - 远程服务器在远程调用过程中强制关闭客户端连接

> ID：482811
> 
> 赞同：1
> 
> 时间：2009-01-27T09:47:57.250
> 
> 标签：c#, .net, remoting

我有一个由服务器组成的系统，该服务器接受来自客户端的远程调用，TCP 作为底层传输层。它通常像一个魅力，但如果我增加没有。客户端，服务器随机启动以关闭调用中间的 TCP 连接。并非所有呼叫都以这种方式中断。

这真是出乎意料的行为......我在服务器端没有异常，只是客户端异常：

```
System.Net.Sockets.SocketException: An existing connection was forcibly closed by the remote host

Server stack trace: 
   ved System.Net.Sockets.Socket.Receive(Byte[] buffer, Int32 offset, Int32 size, SocketFlags socketFlags)
   ved System.Runtime.Remoting.Channels.SocketStream.Read(Byte[] buffer, Int32 offset, Int32 size)
   ved System.Runtime.Remoting.Channels.SocketHandler.ReadFromSocket(Byte[] buffer, Int32 offset, Int32 count)
   ved System.Runtime.Remoting.Channels.SocketHandler.Read(Byte[] buffer, Int32 offset, Int32 count)
   ved System.Runtime.Remoting.Channels.SocketHandler.ReadAndMatchFourBytes(Byte[] buffer)
   ved System.Runtime.Remoting.Channels.Tcp.TcpSocketHandler.ReadAndMatchPreamble()
   ved System.Runtime.Remoting.Channels.Tcp.TcpSocketHandler.ReadVersionAndOperation(UInt16& operation)
   ved System.Runtime.Remoting.Channels.Tcp.TcpClientSocketHandler.ReadHeaders()
   ved System.Runtime.Remoting.Channels.Tcp.TcpClientTransportSink.ProcessMessage(IMessage msg, ITransportHeaders requestHeaders, Stream requestStream, ITransportHeaders& responseHeaders, Stream& responseStream)
   ved System.Runtime.Remoting.Channels.BinaryClientFormatterSink.SyncProcessMessage(IMessage msg)

Exception rethrown at [0]: 
   ved System.Runtime.Remoting.Proxies.RealProxy.HandleReturnMessage(IMessage reqMsg, IMessage retMsg)
   ved System.Runtime.Remoting.Proxies.RealProxy.PrivateInvoke(MessageData& msgData, Int32 type)
   ved EBH.GuG.AgentKit.Transports.RemotingAgentHostEndPoint.SyncInvoke(Agent a, Int32 port) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-29T01:38:03.447

您对客户端和服务器之间的网络硬件了解多少？

每次我遇到这种问题时，总是被证明是由错误配置的防火墙、负载均衡器等引起的。

如果您在客户端和服务器连接到同一交换机的情况下设置了一个测试环境，您应该能够执行负载测试来确定您的代码是否在不涉及任何其他网络硬件的情况下失败......

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-27T09:50:49.490

你在 Windows XP/2000/98 上运行吗？

如果是这样，XP 具有 10 个出站套接字的内置节流机制（阻止您使用台式机作为服务器来迫使您为 windows 服务器付费）我的预感是您可能会达到这个限制。

额外的：

也许您可以使用回调重新构建您的调用，以便它们在执行工作时不会保持打开的套接字，这应该会提高您的并发吞吐量。

# c - 从主端更改伪 tty 回显模式

> ID：482818
> 
> 赞同：2
> 
> 时间：2009-01-27T09:52:30.610
> 
> 标签：c, linux, pty

在 linux 上，我在 master 端打开了一个伪 tty。虽然从属端没有客户端，但伪 tty 似乎在呼应我写给他的所有内容，这不是我所期望的。考虑以下代码：

```
int  main(int argc, char * argv[])
{
    int ptyfd;
    int rc;     /* return code */
    char readbuf[3];
    ptyfd = open("/dev/ptmx", O_RDWR | O_NOCTTY);
    die_on_error(ptyfd, "open ptmx");

    /* unlock and print slave name */
    rc = unlockpt(ptyfd);
    die_on_error(rc, "unlockpt");
    printf("Slave pts name : %s\n", ptsname(ptyfd));

    write(ptyfd, "C", 1);
    rc=read(ptyfd, readbuf, 1);
    die_on_error(rc, "read");
    printf("read returned %c\n",readbuf[0]);
    return 0;   
} 
```

当我运行这个程序时，我希望 read 调用会阻塞，但它会立即返回并且 readbuf 内容是 C。我怎样才能改变这种行为？当从端没有打开时，我希望主端写的字符要么消失，要么被从端读取。

更改主侧属性是正确的方法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-27T10:23:16.477

我以为 master 端不是 tty，但显然它是，所以你可以调用诸如`tcgettattr`and之类`tcsetattr`的东西，并抑制回声。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2019-11-19T07:35:47.940

较旧的答案都没有提供正确的 C 代码，所以这里是：

```
struct termios tmios;
tcgetattr(ptfd, &tmios);
tmios.c_lflag &= ~(ECHO);
tcsetattr(ptfd, TCSANOW, &tmios); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-11-12T14:00:20.003

您可以使用阻塞`getch()`调用。也`getch()`不会回显内容。

# c# - 将 XML 文件反序列化为 C# 类

> ID：482823
> 
> 赞同：2
> 
> 时间：2009-01-27T09:54:53.883
> 
> 标签：c#, xml, xsd.exe

有谁知道使用 XSD 工具生成的类来探索反序列化的 XML 文件而不是 XPATH 有什么优势（内存/速度）？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-27T10:01:29.703

我想说的好处是你得到了一个更方便使用的强类型类，如果文件中的 XML 数据对于创建对象无效，该类的构造函数也会抛出异常，所以你得到一个免费进行最少的数据验证。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-27T10:10:06.097

如果您不想编写样板代码，并且需要在通过的过程中检查 XML 的任何值，那么 XSD.exe 生成的类不会出错。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-27T09:59:05.323

两者非常不同；但`XmlSerializer`总是反序列化整个对象；使用 XPath，您可以选择。不过，我会`XmlSerializer`亲自使用 - 更难出错。

然而，XPath 是一个依赖于后端的复杂野兽。例如，`XmlDocument`（可变）与`XPathDocument`（只读，优化查询）的行为不同。

# unit-testing - 集成测试所需的数据库数据；由 API 调用或使用导入的数据创建？

> ID：482827
> 
> 赞同：61
> 
> 时间：2009-01-27T09:56:36.297
> 
> 标签：unit-testing, testing, mocking, integration-testing

这个问题或多或少与编程语言无关。但是，由于这些天我主要使用 Java，因此我将从中提取示例。我也在考虑 OOP 案例，所以如果你想测试一个方法，你需要一个该方法类的实例。

**[单元测试](http://en.wikipedia.org/wiki/Unit_testing)**的*核心规则*是它们应该是自治的，这可以通过将一个类与其依赖项隔离来实现。有几种方法可以做到这一点，这取决于您是否使用[IoC](http://en.wikipedia.org/wiki/Inversion_of_control)注入依赖项（在 Java 世界中，我们有 Spring、EJB3 和其他提供注入功能的框架/平台）和/或您是否模拟对象（对于 Java，您有[JMock](http://www.jmock.org/)和[EasyMock](http://www.easymock.org/)）将被测试的类与其依赖项分开。

如果我们需要测试不同类*中的方法组并看到它们很好地集成，我们编写**[集成测试](http://en.wikipedia.org/wiki/Integration_testing)**。这是我的问题！

*   至少在 Web 应用程序中，状态通常被持久化到数据库中。我们可以使用与单元测试相同的工具来实现与数据库的独立性。但是以我的拙见，我认为在某些情况下，不使用数据库进行集成测试是在嘲笑太多（但可以不同意；根本不使用数据库也是一个有效的答案，因为它使问题变得无关紧要）。
*   **当您使用数据库进行集成测试时，如何用数据填充该数据库？**我可以看到两种方法：
    *   存储集成测试的数据库内容并在开始测试之前加载它。如果它被存储为 SQL 转储、数据库文件、XML 或其他东西会很有趣。
    *   通过 API 调用创建必要的数据库结构。这些调用可能会在您的测试代码中拆分为几个方法，并且这些方法中的每一个都*可能*失败。它可以被视为您的集成测试依赖于其他测试。

您如何确定测试所需的数据库数据在您需要时是否存在？你为什么选择你选择的方法？

**请提供带有动机的答案**，因为有趣的部分在于动机。请记住，只是说“这是最佳实践！” 不是*真正的*动机，它只是重复你读过或从某人那里听到的东西。对于这种情况，请解释*为什么*它是最佳实践。

*在我的单元测试定义中，我在同一类的（相同或其他）实例中包含了一种调用其他方法的方法，即使它在技术上可能不正确。随时纠正我，但让我们把它作为一个附带问题。

* * *

## 回答 #1

> 赞同：55
> 
> 时间：2009-02-12T19:13:18.597

我更喜欢使用 API 调用创建测试数据。

在测试开始时，您创建一个空数据库（内存中或生产中使用的相同），运行安装脚本来初始化它，然后创建数据库使用的任何测试数据。例如，可以使用[Object Mother](http://martinfowler.com/bliki/ObjectMother.html)模式来组织测试数据的创建，以便可以在许多测试中重复使用相同的数据，可能会有微小的变化。

您希望在每次测试之前使数据库处于已知状态，以便进行可重现的测试而不会产生副作用。因此，当测试结束时，您应该删除测试数据库或回滚事务，以便下一个测试可以始终以相同的方式重新创建测试数据，而不管之前的测试是通过还是失败。

我会避免导入数据库转储（或类似的）的原因是它将测试数据与数据库模式耦合。当数据库架构更改时，您还需要更改或重新创建测试数据，这可能需要手动工作。

如果测试数据是在代码中指定的，那么您将拥有 IDE 重构工具的强大功能。当您进行影响数据库架构的更改时，它可能还会影响 API 调用，因此您无论如何都需要使用 API 重构代码。通过几乎相同的努力，您还可以重构测试数据的创建 - 特别是如果重构可以自动化（重命名、引入参数等）。但是，如果测试依赖于数据库转储，除了重构使用 API 的代码之外，您还需要手动重构数据库转储。

与数据库集成测试相关的另一件事是测试从以前的数据库模式升级是否正常工作。为此，您可能想阅读《[重构数据库：进化数据库设计](https://rads.stackoverflow.com/amzn/click/com/0321293533)》一书或这篇文章：[http ://martinfowler.com/articles/evodb.html](http://martinfowler.com/articles/evodb.html)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-02-16T08:23:48.677

在集成测试中，您需要使用真实数据库进行测试，因为您必须验证您的应用程序实际上可以与数据库对话。将数据库隔离为依赖项意味着您推迟了对数据库是否正确部署、您的架构是否符合预期以及您的应用程序是否配置了正确的连接字符串的真正测试。当您部署到生产环境时，您不想发现这些问题。

您还想使用预先创建的数据集和空数据集进行测试。您需要测试您的应用程序从仅使用默认初始数据的空数据库开始并开始创建和填充数据的路径以及针对您要测试的特定条件的明确定义的数据集，例如压力、性能和很快。

另外，请确保您在每个状态之前都使数据库处于众所周知的状态。您不希望在集成测试之间存在依赖关系。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-02-16T05:51:49.353

*为什么将这两种方法定义为排他性的？*

*   *对于不*使用预先存在的数据集，尤其是过去引起问题的特定数据， 我看不出任何可行的论据 。

*   我看不到任何可行的论据，即*不* 以您可以想象的所有可能导致问题的条件，*甚至是一些用于集成测试的随机数据，以*编程方式扩展该数据。

在现代[敏捷方法](http://en.wikipedia.org/wiki/Agile_software_development)中，单元测试是每次运行相同测试真正重要的地方。这是因为单元测试的目的不是发现错误，而是在开发应用程序时保留应用程序的功能，允许开发人员根据需要进行重构。

另一方面，集成测试旨在发现您没有预料到的错误。在我看来，每次运行*一些不同的数据甚至会很好。*如果你失败了，你只需要确保你的测试保留失败的数据。请记住，在正式的集成测试中，除了错误修复之外，应用程序本身将被冻结，因此您可以更改测试以测试最大可能数量和种类的错误。在集成中，您可以而且应该将厨房水槽扔给应用程序。

当然，正如其他人所指出的，所有这一切自然取决于您正在开发的应用程序类型以及您所在的组织类型等。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-02-11T23:18:22.777

我使用[DBUnit](http://www.dbunit.org/)对数据库中的记录进行快照并以 XML 格式存储它们。然后我的单元测试（当它们需要数据库时，我们称它们为集成测试），可以在每次测试开始时从 XML 文件中擦除和恢复。

我不确定这是否值得付出努力。一个问题是对其他表的依赖性。我们单独留下了静态引用表，并构建了一些工具来检测和提取所有子表以及请求的记录。我阅读了有人建议禁用集成测试数据库中的所有外键。这将使准备数据变得更容易，但您不再检查测试中的任何引用完整性问题。

另一个问题是数据库架构更改。我们编写了一些工具，可以为自拍摄快照以来添加的列添加默认值。

显然，这些测试比纯单元测试**要慢得多。**

当您尝试测试一些很难为单个类编写单元测试的遗留代码时，这种方法可能是值得的。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-02-13T20:05:35.780

听起来你的问题实际上是两个问题。您应该从测试中排除数据库吗？当你做一个数据库时，那么你应该如何生成数据库中的数据呢？

如果可能，我更喜欢使用实际的数据库。当面对实际数据库时，CRUD 类中的查询（用 SQL、HQL 等编写）通常会返回令人惊讶的结果。最好尽早解决这些问题。开发人员通常会为 CRUD 编写非常精简的单元测试；只测试最良性的病例。使用实际数据库进行测试可以测试您甚至可能没有意识到的各种极端情况。

话虽如此，可能还有其他问题。每次测试后，您都希望将数据库恢复到已知状态。我目前的工作是通过执行所有 DROP 语句然后从头开始完全重新创建所有表来对数据库进行核对。这在 Oracle 上非常慢，但如果您使用像 HSQLDB 这样的内存数据库，则速度会非常快。当我们需要清除 Oracle 特定问题时，我们只需更改数据库 URL 和驱动程序属性，然后针对 Oracle 运行。如果您没有这种数据库可移植性，那么 Oracle 还具有某种数据库快照功能，可以专门用于此目的；将整个数据库回滚到以前的某个状态。我确定其他数据库有什么。

根据数据库中的数据类型，API 或加载方法可能会更好或更差。当您拥有具有许多关系的高度结构化的数据时，API 将使您的生活更轻松，因为我将数据之间的关系明确化。创建测试数据集时，您将更难犯错误。正如其他海报所提到的，重构工具可以自动处理对数据结构的一些更改。我经常发现将 API 生成的测试数据视为一个场景很有用。当用户/系统完成步骤 X、YZ 然后测试将从那里开始。可以实现这些状态，因为您可以编写一个程序来调用您的用户将使用的相同 API。

当您需要大量数据时，加载数据变得更加重要，您的数据之间的关系很少，或者数据中存在无法使用 API 或标准关系机制表达的一致性。我团队的一项工作是为大型网络数据包检测系统编写报告应用程序。当时的数据量相当大。为了触发有用的测试用例子集，我们确实需要嗅探器生成的测试数据。这样，关于一个协议的信息之间的相关性将与关于另一个协议的信息相关联。在 API 中很难捕捉到这一点。

大多数数据库都有工具来导入和导出表格的分隔文本文件。但通常你只想要它们的子集；使使用数据转储变得更加复杂。在我目前的工作中，我们需要转储一些由 Matlab 程序生成并存储在数据库中的实际数据。我们有工具可以转储数据库数据的子集，然后将其与“基本事实”进行比较以进行测试。似乎我们的提取工具正在不断修改。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-01-27T11:09:14.933

我两者都做，具体取决于我需要测试的内容：

*   我从 SQL 脚本或数据库转储中导入静态测试数据。这些数据用于对象加载（反序列化或对象映射）和 SQL 查询测试（当我想知道代码是否会返回正确的结果时）。

    另外，我通常有一些主干数据（配置、名称查找表的值等）。这些也在此步骤中加载。请注意，此加载是单个测试（以及从头开始创建数据库）。

*   当我有修改数据库（对象-> 数据库）的代码时，我通常针对一个活的数据库（在内存中或某处的测试实例中）运行它。这是为了确保代码有效；不要创建任何大量的行。测试后，我回滚事务（遵循测试不得修改全局状态的规则）。

当然，规则也有例外：

*   我还在性能测试中创建了大量行。
*   有时，我必须提交单元测试的结果（否则，测试会变得太大）。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-01-27T10:18:35.487

我一般使用 SQL 脚本来填充您讨论的场景中的数据。

这是直截了当的，非常容易重复。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-27T10:19:47.047

这可能无法回答您的所有问题（如果有的话），但我在一个项目中决定对数据库进行单元测试。在我的情况下，我觉得数据库结构也需要测试，即我的数据库设计是否提供了应用程序所需的内容。在项目后期当我觉得数据库结构稳定时，我可能会远离这个。

为了生成数据，我决定创建一个用“随机”数据填充数据库的外部应用程序，我创建了一个人名和公司名生成器等。

在外部程序中这样做的原因是： 1\. 我可以通过测试修改的数据重新运行测试，即确保我的测试能够运行多次并且测试所做的数据修改是有效的修改。2\. 如果需要，我可以清理数据库并重新开始。

我同意这种方法存在失败点，但在我的情况下，因为例如人员生成是为测试生成数据的业务逻辑的一部分，实际上也在测试该部分。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2021-02-16T21:55:16.220

我们的团队最近面临同样的问题。

之前，我们使用 specflow 进行集成测试。使用 specflow，QA 可以编写每个测试用例，在其中将必要的测试数据填充到 DB。

现在，QA 想使用 postman 来测试 API，他们如何填充数据？一种解决方案是创建用于填充它们的 API。另一个是将 Prod 的历史数据同步到测试环境。

一旦我们尝试不同的解决方案并决定选择哪一个，将更新我的答案。

# .net - WCF 配置 - 将其从 app.config 中拆分出来

> ID：482835
> 
> 赞同：16
> 
> 时间：2009-01-27T10:01:06.210
> 
> 标签：.net, wcf, configuration, app-config

我有一个特定要求，将所有客户端 WCF 配置 (<system.serviceModel>) 从主 app.config 文件中删除，并放入单独的 XML 文件中。我希望看到的行为类似于使用 File="" 指令的 appSettings 部分中可用的行为。事实上，理想情况下，我希望能够为每个使用的服务指定一个单独的文件......

我知道我可以构建一个自定义 ChannelBuilder 工厂，从 XML 文件（或一系列文件）读取配置数据，但我更希望客户端“自动发现”配置数据。

一些基本的谷歌搜索似乎表明这是不可能的，但我想从 SO 那里得到视图——这里有人知道我找不到的东西吗？:)

> 编辑 ：：
> 
> Tim Scott 和 davogones 都提出了一个可能的建议，但它依赖于将 system.serviceModel 部分的组件部分拆分为单独的文件。虽然这不是我想要的（我想离散地定义每个服务及其关联元素，每个服务一个文件），但它*是*一个选项。我会调查并让你知道我的想法。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-01-28T07:37:44.283

您可以使用 configSource 分离出您的 WCF 配置。这里的说明：

[http://weblogs.asp.net/cibrax/archive/2007/07/24/configsource-attribute-on-system-servicemodel-section.aspx](http://weblogs.asp.net/cibrax/archive/2007/07/24/configsource-attribute-on-system-servicemodel-section.aspx)

另一种选择是以编程方式配置 WCF 服务。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2010-12-31T11:45:45.680

```
using System;
using System.Configuration;
using System.IO;
using System.ServiceModel;
using System.ServiceModel.Configuration;

namespace ConsoleHost
{
    public class CustomServiceHost : ServiceHost
    {
        public CustomServiceHost(string customConfigPath, Type serviceType, 
            params Uri[] baseAddresses)
        {
            CustomConfigPath = customConfigPath;
            var collection = new UriSchemeKeyedCollection(baseAddresses);
            InitializeDescription(serviceType, collection);
        }

        public string CustomConfigPath { get; private set; }

        protected override void ApplyConfiguration()
        {
            if (string.IsNullOrEmpty(CustomConfigPath) ||
                !File.Exists(CustomConfigPath))
            {
                base.ApplyConfiguration();
            }
            else
            {
                LoadConfigFromCustomLocation(CustomConfigPath);
            }
        }

        void LoadConfigFromCustomLocation(string configFilename)
        {
            var filemap = new ExeConfigurationFileMap
            {
                ExeConfigFilename = configFilename
            };
            Configuration config = ConfigurationManager.
                OpenMappedExeConfiguration(filemap, ConfigurationUserLevel.None);

            var serviceModel = ServiceModelSectionGroup.GetSectionGroup(config);

            bool loaded = false;
            foreach (ServiceElement se in serviceModel.Services.Services)
            {
                if (se.Name == Description.ConfigurationName)
                {
                    LoadConfigurationSection(se);
                    loaded = true;
                    break;
                }
            }

            if (!loaded)
                throw new ArgumentException("ServiceElement doesn't exist");
        }
    }
} 
```

**在这个类之后就像你通常使用它来初始化服务主机一样使用它**

myServiceHost = new CustomServiceHost(ConfigFileName, typeof(QueryTree));

myServiceHost.Open();

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-01-27T19:29:02.273

我倾向于以编程方式配置我的所有服务设置。

我的客户并不是真正理解 XML 的类型，并要求我将配置文件制作得更像旧的 INI 样式。

这很容易做到（不包括读取 INI 文件代码）：

```
 // create the URI which is used as the service endpoint
        Uri tcpBaseAddress = new Uri(
                string.Format("net.tcp://{0}:{1}",
                    LocalIPAddress.ToString(), GeneralPortNumber));

        // create the net.tcp binding for the service endpoint
        NetTcpBinding ntcBinding = new NetTcpBinding();
        ntcBinding.Security.Mode = SecurityMode.None;
        System.ServiceModel.Channels.Binding tcpBinding = ntcBinding;

        // create the service host and add the endpoint
        Host = new ServiceHost(typeof(WordWarService), tcpBaseAddress); 
```

由于我们可以以编程方式配置主机（和客户端），因此没有什么可以阻止您以您选择的任何方式（数据库、xml、疯狂的文本文件等）提供设置。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2010-06-25T12:55:09.913

我发现这篇文章可以帮助你。我没有尝试过，但它似乎相当简单。

[http://weblogs.asp.net/cibrax/archive/2007/07/24/configsource-attribute-on-system-servicemodel-section.aspx](http://weblogs.asp.net/cibrax/archive/2007/07/24/configsource-attribute-on-system-servicemodel-section.aspx)

" configSource 属性首先在 .NET framework 2.0 中引入，用于支持外部配置文件。该属性可以添加到任何配置节中，以指定该节的外部文件。

不幸的是，system.serviceModel 部分组不支持此属性。如果您尝试添加它，您将收到以下异常：

无法指定属性“configSource”，因为它的名称以保留前缀“config”或“lock”开头

我发现您可以在 system.serviceModel 下的不同部分使用此属性，例如服务、行为或绑定。"

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-01-27T18:18:15.927

我一直渴望做同样的事情 - 基本上更进一步：将我的 WCF 配置放在数据库表中（因为我可以更改它 - 无法访问我的托管提供商上的文件系统来更改配置文件:-() .

不幸的是，这似乎并不简单......

基本上，归结为必须编写自己的自定义“ServiceHost”后代，它可以根据需要处理配置。

[这是从自定义配置位置加载 WCF 配置](http://www.paraesthesia.com/archive/2008/11/26/reading-wcf-configuration-from-a-custom-location.aspx)的示例。

这可能会让你走？我仍然希望有一天我能够弄清楚“从数据库表中加载我的配置”.....我猜只需要安静一周的工作即可:-)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2010-06-25T13:13:47.513

`System.ServiceModel.Configuration.ConfigurationChannelFactory`等人支持从`System.Configuration.Configuration`实例中读取配置。这意味着您可以将这些`<system.servicemodel ...`内容放在一个专用文件中，而无需从 web/app.config 中引用它。您可以有多个配置文件，每个客户端一个。

SharePoint 2010 在其服务应用程序模型中过度使用它，其中每个服务代理都从专用的 .config 读取其设置，该 .config 不一定是 web.config 或 app.config，甚至没有从那里引用。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-27T16:47:31.397

我有一个工作中的应用程序有点像你在这里谈论的。我们在多个项目中有多个 WCF 服务，它们的所有配置信息都驻留在一个配置文件中。

我公司选择的解决方案是从配置文件中读取服务配置，然后根据读取的值以编程方式设置绑定、行为等。配置文件中的值不符合您通常在 WCF 服务中看到的配置内容 - 它被设计为便于帮助程序类在运行时执行所有配置。

尽管如此，我根本不喜欢这样做——太多的耦合发生了，而且很混乱。

不过，它确实表明这是可能的——这是在你的设计中要考虑的一件事。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-27T22:26:36.500

你可以这样做：

```
<system.serviceModel configSource="wcf.config"/> 
```

只需删除您的服务模型部分并将其放在单独的文件中即可。您必须将整个部分放入单独的配置文件中；使用这种方法，你不能让一个部分跨越多个文件 AFAIK。

# iphone - 在线存储我的 ObJ-C 课程。（亚马逊网络服务？）

> ID：482838
> 
> 赞同：2
> 
> 时间：2009-01-27T10:02:16.410
> 
> 标签：iphone, objective-c, cocoa-touch, json, amazon-s3

好的，这是一个相当广泛的问题。这是我的第一个应用程序，我不确定最好的方法。该应用程序在 IPHONE 上。

我有一个“餐厅”课程。餐厅有许多不同的属性和开放时间。我目前将餐厅存储在 nsdata 的实例中（它符合 NSCoding）本地存储很容易，我只使用 nsdata。

我刚刚内置了一个导入/导出功能。我希望这两种方法可以将餐厅“发布”到网络并从网络“获取”餐厅。我知道我可以用 NSUrlConnection 做到这一点，并且我已经启动并工作了。

但是我想更聪明一点。例如，如果我想获取已提交的在线餐厅列表并构建一个也可以与数据交互的 Web 界面怎么办？

到目前为止，这就是我的想法：创建一个“toString”方法，将我的类转换为文本表示。然后将字符串存储在服务器上。这将取代在线存储 nsdata。这听起来合适吗？

但是，我希望能够查询餐馆的数量并对我的在线“数据库”有更多的控制权。XML 是答案吗？我正要开始研究 Amazon Web Services 并学习 Json 或 Rest。

有什么建议吗？

谢谢

担

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-27T10:32:51.763

我对 iPhone 的开发还不是很熟悉，但是如果有相当简单的方法来使用 Web 服务，我会推荐使用带有类型参数的方法。这也将使这些服务对其他系统更“可用”，他们不需要知道如何将对象序列化/打包为字符串，而只需要知道如何调用函数：storeRestaurang(string name, int rating...) 等。

这是一篇我将自己检查的文章，因为我希望更多地进入 iPhone 开发：http: [//icodeblog.com/2008/11/03/iphone-programming-tutorial-intro-to-soap-web-services /](http://icodeblog.com/2008/11/03/iphone-programming-tutorial-intro-to-soap-web-services/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-27T14:51:30.837

看起来你想使用 plist。任何可可集合类都可以写入 plist，这是一种 xml 文件。甜蜜的部分是如果你使用标准的可可值类，你可以写出集合，然后再读回来。

NSString, NSNumber, NSDate, NSData, NSAray, NSDictionary 对象可以被放入一个集合并直接存储到一个 plist 中。其他类必须序列化为 NSData，然后作为 plist 写入磁盘。对于真正的自定义数据，NSKeyedArchiver 可能是您想要的。

对于简单的字符串和数字数据，将其全部打包到 NSDictionary 中，然后将其写入 plist。现在在你的 Mac 上环顾四周，你会发现 plist 有多受欢迎。

[NSDictionary API - 存储字典](http://developer.apple.com/DOCUMENTATION/Cocoa/Reference/Foundation/Classes/NSDictionary_Class/Reference/Reference.html#//apple_ref/doc/uid/20000140-SW15)

[属性列表编程指南](http://developer.apple.com/DOCUMENTATION/Cocoa/Conceptual/PropertyLists/Introduction/chapter_1_section_1.html)

[Cocoa 的归档和序列化编程指南](http://developer.apple.com/documentation/Cocoa/Conceptual/Archiving/Archiving.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-27T14:58:15.253

了解 REST，它是提供基于 Web 的 API 的最简单、最简洁的方式。一些框架，如 Ruby on Rails，为您提供了开箱即用的 REST 接口。

然后，您需要找到一种方法将 iPhone 上的对象转换为 REST 友好格式。XML 和 JSON 都是选项，但不幸的是，我还没有看到任何我可以真正推荐的用于转换为 XML 或 JSON 的代码，因为我还没有尝试过任何代码。但是，有些项目可能会引导您朝着正确的方向前进。最有希望的一个是：

[http://github.com/yfactorial/objectiveresource/tree/master](http://github.com/yfactorial/objectiveresource/tree/master)

# perl - 如何在 Perl 中验证图像文件？

> ID：482839
> 
> 赞同：4
> 
> 时间：2009-01-27T10:02:23.557
> 
> 标签：perl, image, ftp, locking

我将如何验证 jpg 文件是有效的图像文件。我们正在使用 FTP 将文件写入目录，但我们似乎在文件完成写入之前就将其拾取，从而创建了无效图像。我需要能够确定它何时不再被写入。有任何想法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-27T10:14:13.500

最简单的方法可能是将文件写入临时目录，然后在写入完成后将其移动到真实目录。

或者你可以[在这里查看](http://search.cpan.org/~bettelli/Image-MetaData-JPEG-0.15/lib/Image/MetaData/JPEG.pod)。

> JPEG::错误
> 
> [参数：无] 如果在调用 new 后文件引用仍未定义，则该文件将被此模块视为不可解析，并且应该发出一些错误消息并转到另一个文件。可以使用 Error 方法检索解释失败原因的错误消息：

编辑：

[Image::TestJPG](http://search.cpan.org/~jhudge/Image-TestJPG-1.0/TestJPG.pm)可能会更好。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-27T10:46:19.817

你解决了错误的问题，我想。

您应该做的是弄清楚如何判断您正在使用的任何 FTPd 何时完成写入文件 - 这样当您遇到（例如）GIF、DOC 或 MPEG 的相同问题时，您不必再次修复它。

确切地说，您如何做到这一点在很大程度上取决于您正在运行的操作系统上的 FTPd。我相信，有些确实有可以设置为在上传完成时触发的钩子。

如果您可以运行自己的 FTPd，Net::FTPServer 或 POE::Component::Server::FTP 可以自定义以做正确的事情。

在没有那个的情况下：

1) 尝试使用查找“上传完成”消息的 Perl 脚本跟踪日志 2)在尝试复制文件之前，使用类似`lsof`或检查是否有任何东西锁定了文件。`fuser`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-28T08:59:28.410

再次查看 FTP 问题而不是 JPG 问题。

我检查文件上的时间戳以确保它在最后 X (5) 分钟内没有被修改——这样我可以合理地确定他们已经完成上传

```
# time in seconds that the file was last modified
my $last_modified = (stat("$path/$file"))[9];

# get the time in secs since epoch (ie 1970) 
my $epoch_time = time();

# ensure file's not been modified during the last 5 mins, ie still uploading
unless ( $last_modified >= ($epoch_time - 300)) {
    # move / edit or what ever
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-27T12:04:52.310

我曾经遇到过类似的事情，或多或少我所做的是：

```
var oldImageSize = 0;
var currentImageSize;

while((currentImageSize = checkImageSize(imageFile)) != oldImageSize){
    oldImageSize = currentImageSize;
    sleep 10;
}

processImage(imageFile); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-27T17:28:12.797

让 FTP 进程设置`readonly`标志，然后只使用设置了标志的文件`readonly`。

# c# - 在按钮单击上获取 GridView 的当前选定行

> ID：482842
> 
> 赞同：1
> 
> 时间：2009-01-27T10:04:46.577
> 
> 标签：c#, gridview

我想在按钮单击时获取 GridView 的选定行的 DataKey。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-27T10:10:29.437

我会像这样在模板字段中进行个人操作：

```
 <asp:TemplateField>
     <ItemTemplate>
       //EDIT: after a comment it is suggested that you pass the RowIndex as the command argument which would provide access to the entire row
       <asp:LinkButton ID="btnCopy" runat="server"CausesValidation="False"CommandName="MyCommandButton"CommandArgument='<%# Eval("MyDataKeyOrWhateverIWanteverIWantFromTheBindingSource")%>'>
     </ItemTemplate>
    </asp:TemplateField> 
```

**代码隐藏**

```
protect void MyCommandButton(Object sender,CommandArgument e)

{
    int DataKeyOrPK=int32.Parse(e.CommandArgument.ToString());
} 
```

您的其他选择是：

```
<asp:gridview id="myGrid" runat="server"
      width=100% datakeynames="Myid"
      autogeneratecolumns=false
      onSelectedIndexChanged="MyEvent">

<asp:templatefield headertext="Choose your dream home">
 <itemtemplate>
  <asp:linkbutton runat="server" commandname="select" text='<%# Eval ( "Whatever" ) %>' />
 </itemtemplate>
</asp:templatefield> 
```

注意上面的 commandname="select"。

数据绑定控件识别某些命令名称并自动引发和处理控件的适当事件。可以识别以下命令名称： *Cancel、Delete、Edit、Insert、New、Page、Select、Sort 和 Update*。[参考](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.buttonfield.commandname.aspx)

**代码隐藏**

```
private void MyEvent(Object sender, EventArgs e) 
{
   string id = myGrid.SelectedDataKey.Value.ToString();
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-27T10:08:21.687

使用 GridView 的 SelectedDataKey 属性：

```
DataKey currentKey = myGridView.SelectedDataKey; 
```

# php - 预先存储在变量中的数学

> ID：482847
> 
> 赞同：2
> 
> 时间：2009-01-27T10:08:41.670
> 
> 标签：php

我有 3 个这样的变量： $first = 2; $秒 = 5; $操作 = '*';

如何以编程方式将此数学问题的解决方案分配给 $answer 变量？我已经尝试过 eval()，但这不起作用。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-27T10:18:20.123

eval() 对于这样的事情应该工作得很好。记住 eval() 会返回 NULL，除非你告诉它返回一些东西。

```
<?php
$first = 3;
$second = 4;
$operation = "*";

$answer = eval('return '.$first.$operation.$second.';');

echo $answer;
?> 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-01-27T10:14:59.693

```
function add($a, $b) {
    return $a + $b;
}

function multiply($a, $b) {
    return $a * $b;
}

function divide($a, $b) {
    return $a / $b;
}

$operations = array(
    '+' => 'add',
    '*' => 'multiply',
    '/' => 'divide',
);

$a = 2;
$b = 5;
$operation = '*';

echo $operations[$operation]($a, $b); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-27T11:38:36.137

如果您打算经常进行此计算，我强烈建议您不要使用 eval 方法，而是使用上面发布的 Ionut G. Stan 方法。我知道它更复杂，但是每次运行 eval 时，PHP 都会重新加载编译器引擎，因此开销成本很高。如果您使用 Ionut 展示的函数调度方法，您将获得显着的性能提升（大约 10 倍）。看看 PHP 手册中对 eval 函数的评论，你会看到其他人也这么说：[http ://www.php.net/eval](http://www.php.net/eval)

我曾经使用 eval 希望它能让我为 Web 应用程序构建一个快速的模板机制，但是对 eval 的调用非常慢，当我意识到是 eval 导致它时，我切换到了另一种方法。速度提升是惊人的。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-27T10:24:50.810

这对我来说可以：

```
var_dump(eval("return $first $operator $second;")); 
```

但却`eval`是邪恶的。你最好使用这样的函数：

```
function foobar($operator)
{
    $args = func_get_args();
    array_shift($args);
    switch ($operator) {
    case "*":
        if (count($args) < 1) {
            return false;
        }
        $result = array_shift($args) * array_shift($args);
        break;
    /*
        …
    */
    }
    if (count($args)) {
        return call_user_func_array(__FUNCTION__, array_merge(array($operator, $result), $args));
    }
    return $result;
}
var_dump(foobar("*", 3, 5, 7)); 
```

# xml - 从 WCF RESTful 响应中删除 xml 命名空间

> ID：482856
> 
> 赞同：19
> 
> 时间：2009-01-27T10:11:56.390
> 
> 标签：xml, wcf, serialization, namespaces

我正在使用 WCF 向调用者返回一个普通的旧 XML (POX) 文档。我正在使用 XML Serializer 格式化程序将对象转换为 XML。

在返回的文档中，我有一些针对 XML Schema 和实例的无关 xml 命名空间引用（在 ASMX 版本中不存在）。我在网上看到了各种不应该删除的论点，我不赞成返回纯 XML 文档。

从 WCF 中返回的 XML 文档中删除这些 xmlns 引用的最简单方法是什么？

签名看起来像：

```
public ResponseInfo Process(string input) {
} 
```

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-03-03T01:45:02.317

您可以通过将 DataContract 属性的 Namespace 参数设置为空字符串来移除 XML 命名空间，如下所示：

```
[DataContract(Namespace = "")]
public class ResponseInfo
{
    // ...
} 
```

我希望这有帮助...

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2011-01-06T18:59:38.273

我有同样的问题。将**BodyStyle:=WebMessageBodyStyle.Bare**添加 到 WebInvoke 对我有用。响应不再包含在元数据中。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-02-05T18:36:43.350

我假设你正在尝试而不是在你的 xml 开头得到这样的东西：

```
<ResponseInfo 
   xmlns="http://schemas.datacontract.org/2004/07/ResponseInfo"
   xmlns:i="http://www.w3.org/2001/XMLSchema-instance" > 
```

你只想：

```
<ResponseInfo> 
```

可悲的是，我还没有看到删除这些字段的简单方法。我在谷歌上搜索解决方案，大多数删除它的选项需要创建你自己的消息检查器或你自己的编码器。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-03-14T07:37:57.450

如果要更改 Xml，其中一种方法是使用 XslTransform。我有一个类似的情况，我需要从 Xml Post 请求中删除 xmlns 属性。

在 WCF 中，您可以通过实现 IClientMessageInspector 或 IDispatchMessageInspector，在外出之前或在处理它们之前“拦截” Xml 消息，具体取决于您在客户端还是服务器端需要它。

例如，为了将命名空间属性从传出的 Xml 消息剥离到 Web 服务，我使用以下代码实现了 IClientMessageInspector：

```
#region IClientMessageInspector Members
    public void AfterReceiveReply(ref Message reply, object correlationState)
    {   
        //Console.WriteLine(reply.ToString());
    }

    private XslCompiledTransform xt = null;

    public object BeforeSendRequest(ref Message request, IClientChannel channel)
    {
        Console.WriteLine(request.ToString());
        if (!request.IsEmpty)
        {
            XmlReader bodyReader =
                request.GetReaderAtBodyContents().ReadSubtree();

            MemoryStream ms = new MemoryStream();
            XmlWriter xw = XmlWriter.Create(ms);

            if (xt == null)
            {
                xt = new XslCompiledTransform(true);
                xt.Load("StripXmlnsi.xslt");
            }
            xt.Transform(bodyReader, xw);

            ms.Flush();
            ms.Seek(0, SeekOrigin.Begin);

            bodyReader = XmlReader.Create(ms);

            Message changedMessage = Message.CreateMessage(request.Version, null, bodyReader);
            changedMessage.Headers.CopyHeadersFrom(request.Headers);
            changedMessage.Properties.CopyProperties(request.Properties);
            request = changedMessage;
        }
        return null;
    }
    #endregion 
```

并使用以下变换：

```
 <?xml version="1.0" encoding="UTF-8" ?>
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
  <xsl:template match="*">
    <!-- remove element prefix (if any) -->
    <xsl:element name="{local-name()}">
      <!-- process attributes -->
      <xsl:for-each select="@*">
        <!-- remove attribute prefix (if any) -->
        <xsl:attribute name="{local-name()}">
          <xsl:value-of select="." />
        </xsl:attribute>
      </xsl:for-each>
      <xsl:apply-templates />
    </xsl:element>
  </xsl:template>
</xsl:stylesheet> 
```

希望这会有所帮助。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2012-02-13T20:07:51.187

我找到了一个很好的解决这个问题的方法，它可以让你将自己的 XmlSerializer 注入到 WCF 中，在序列化和反序列化请求时使用它。此 XmlSerializer 可以设置为完全省略 XML 名称空间（包括`xmlns:i="w3.org/2001/XMLSchema-instance"`）或您希望的任何其他方式。

我的解决方案使用[WcfRestContrib](https://github.com/mikeobrien/WcfRestContrib)。您几乎可以使用包含的[POX 格式化程序](https://github.com/mikeobrien/WcfRestContrib/wiki/POX-Formatter-Overview)，但在我们的例子中，我们希望支持属性，因此我们编写了自己的简单格式化程序。

指示：

1) 从您的项目中引用 WcfRestContrib。

2）创建一个`IWebFormatter`实现：

```
public class NamespacelessXmlFormatter : IWebFormatter {
    public object Deserialize(WebFormatterDeserializationContext context, Type type) {
        if (context.ContentFormat != WebFormatterDeserializationContext.DeserializationFormat.Xml) {
            throw new InvalidDataException("Data must be in xml format.");
        }

        return NamespacelessXmlSerializer.Deserialize(context.XmlReader, type);
    }

    public WebFormatterSerializationContext Serialize(object data, Type type) {
        using (var stream = NamespacelessXmlSerializer.Serialize(data, type)) {
            using (var binaryReader = new BinaryReader(stream)) {
                byte[] bytes = binaryReader.ReadBytes((int)stream.Length);
                return WebFormatterSerializationContext.CreateBinary(bytes);
            }
        }
    }
} 
```

它利用了满足您需求的 XmlSerializer（这是我们的，它只是省略了所有命名空间）：

```
public static class NamespacelessXmlSerializer {

    private static readonly XmlSerializerNamespaces _customNamespace = new XmlSerializerNamespaces();

    private static readonly XmlWriterSettings _xmlSettings = new XmlWriterSettings {
        OmitXmlDeclaration = true
    };

    static NamespacelessXmlSerializer() {
        // to make sure .NET serializer doesn't add namespaces
        _customNamespace.Add(String.Empty, String.Empty);
    }

    /// <summary>
    /// Deserializes object from its XML representation.
    /// </summary>
    /// <typeparam name="T"></typeparam>
    /// <param name="stream"></param>
    /// <returns></returns>
    public static T Deserialize<T>(Stream stream) {
        return (T)Deserialize(stream, typeof(T));
    }

    /// <summary>
    /// Deserializes object from its XML representation.
    /// </summary>
    public static object Deserialize(Stream stream, Type type) {
        var ds = new XmlSerializer(type);
        var d = ds.Deserialize(stream);
        return d;
    }

    public static object Deserialize(XmlDictionaryReader xmlReader, Type type) {
        var ds = new XmlSerializer(type);
        var d = ds.Deserialize(xmlReader);
        return d;
    }

    /// <summary>
    /// Serializes object to XML representation.
    /// </summary>
    /// <exception cref="InvalidOperationException">
    /// Is thrown when there was an error generating XML document. This can happen 
    /// for example if the object has string with invalid XML characters:
    /// http://www.w3.org/TR/2004/REC-xml-20040204/#charsets.
    /// See this article for other potential issues:
    /// http://msdn.microsoft.com/en-us/library/aa302290.aspx
    /// </exception>
    public static Stream Serialize<T>(T objectToSerialize) {
        return Serialize(objectToSerialize, typeof(T));
    }

    /// <summary>
    /// Serializes object to XML representation.
    /// </summary>
    /// <exception cref="InvalidOperationException">
    /// Is thrown when there was an error generating XML document. This can happen 
    /// for example if the object has string with invalid XML characters:
    /// http://www.w3.org/TR/2004/REC-xml-20040204/#charsets.
    /// See this article for other potential issues:
    /// http://msdn.microsoft.com/en-us/library/aa302290.aspx
    /// </exception>
    public static Stream Serialize(object objectToSerialize, Type type) {
        var stream = new MemoryStream();

        XmlWriter writer = XmlWriter.Create(stream, _xmlSettings);
        var x = new XmlSerializer(type);
        x.Serialize(writer, objectToSerialize, _customNamespace);

        stream.Position = 0;

        return stream;
    }
} 
```

3）`WebDispatchFormatter...`使用您的自定义实现作为类型将属性应用于您的服务（基于此[文档](https://github.com/mikeobrien/WcfRestContrib/wiki/De-serialization-Overview)）：

```
[WebDispatchFormatterConfiguration("application/xml")]
[WebDispatchFormatterMimeType(typeof(NamespacelessXmlFormatter), "application/xml")] 
```

4) 将该`WebDispatchFormatter`属性应用于您的所有服务方法（基于此[文档](https://github.com/mikeobrien/WcfRestContrib/wiki/De-serialization-Overview)）。

5) 就是这样。测试您的服务并确认它现在按预期运行。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-04-14T09:51:13.250

只是给出另一个观点，如果命名空间对您的项目是唯一的，例如：

[http://mycompany.com/myapi/](http://mycompany.com/myapi/)

那么它应该被保留。

这样的命名空间是最佳实践，它们将向任何 XPath 调用添加不到 1 行样板代码（您可以将其转换为辅助方法），并且需要大约 15 行辅助代码来生成前缀/URI 映射，但这是只有缺点，你不会总是遇到它。

作为交换，您可以获得每个元素的明确名称，这意味着您可以不受惩罚地组成第三方名称空间，例如理论上您可以直接返回 XHTML 而无需应用程序级编码。

出现的其他命名空间不太可能成为问题，因为它们不太可能用于您在项目中定义的任何标签。事实上，如果它们是，那么某处存在错误。存在的可能解释是框架添加它们以防万一它需要在声明它们的位置下方的某个位置添加一个元素，这可能不是您必须关心的位置。

另一个答案提到了[http://www.w3.org/2001/XMLSchema-instance](http://www.w3.org/2001/XMLSchema-instance)这有点特别，也许你可以说添加了哪些命名空间。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2011-11-30T22:42:11.980

不确定这是否会有所帮助，但我们遇到了类似的问题。我们发现，如果我们的 WCF 服务使用 XmlSerializerFormat 代替，我们可以轻松地反序列化我们的对象，而不是使用 DataContract/DataMember 属性装饰数千个数据元素并使用（默认）DataContractSerializer。

```
[System.ServiceModel.ServiceContract]
public interface IRestService
{
    [System.ServiceModel.OperationContract]
    // Added this attribute to use XmlSerializer instead of DataContractSerializer
    [System.ServiceModel.XmlSerializerFormat(
        Style=System.ServiceModel.OperationFormatStyle.Document)]
    [System.ServiceModel.Web.WebGet(
        ResponseFormat = System.ServiceModel.Web.WebMessageFormat.Xml,
        UriTemplate = "xml/objects/{myObjectIdentifier}")]
    MyObject GetMyObject(int myObjectIdentifier);
} 
```

这就是我们反序列化对象的方式：

```
public static T DeserializeTypedObjectFromXmlString<T>(string input)
{
    T result;

    try
    {
        System.Xml.Serialization.XmlSerializer xs = new System.Xml.Serialization.XmlSerializer(typeof(T));
        using (System.IO.TextReader textReader = new System.IO.StringReader(input))
        {
            result = (T)xs.Deserialize(textReader);
        }
    }
    catch
    {
        throw;
    }

    return result;
} 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-02-01T15:19:14.530

在我在 WCF RESTful 入门工具包之前编写的 RESTful WCF 服务中，我执行了以下操作，这给了我很好、干净的结果。

首先，确保设置了 webHttp 端点行为：

```
 <endpointBehaviors>
    <behavior name="Web">
      <webHttp/>
    </behavior>
  </endpointBehaviors> 
```

您的端点应该看起来像这样（为简单起见减去合同）：

```
<endpoint address="" binding="webHttpBinding" behaviorConfiguration="Web" /> 
```

我的服务合同中有这些操作合同：

```
 [WebGet(UriTemplate="tasks", ResponseFormat=WebMessageFormat.Xml )]
    [OperationContract]
    Task[] GetTasks();

    [WebGet(UriTemplate="tasks/{id}", ResponseFormat=WebMessageFormat.Xml)]
    [OperationContract]
    Task GetTask(string id); 
```

服务实现本身并没有什么特别之处。您可以尝试更改 WebMessageFormat，但枚举中唯一的其他项目是“json”。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2016-09-04T07:49:28.063

当我使用 ASMX 客户端时，我遇到了同样的问题，对我来说，这解决了问题：

添加到您的服务接口：

```
[XmlSerializerFormat(Use = OperationFormatUse.Literal, Style = OperationFormatStyle.Document)] 
```

添加到操作：

```
[OperationContract(Action = "http://www.YourNameSpace.com/ActionName",ReplyAction = "http://www.YourNameSpace.com/ActionName")] 
```

# gis - SHX 文件如何工作？

> ID：482857
> 
> 赞同：3
> 
> 时间：2009-01-27T10:13:01.973
> 
> 标签：gis, shapefile

如果您将地理数据存储在 ESRI 形状中，则至少有三个文件：一个以包含矢量数据的 .shp 结尾，一个以包含属性的 .dbf 结尾，以及一个以包含索引的 .shx 结尾的文件。

我对 shx 文件感兴趣。它是如何工作的？它是否包含完整的映射，例如每个几何的“第一个几何映射到 dbf 中的第三行，第二个几何映射到第一行”？或者它的工作方式不同？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-27T10:40:19.687

根据[规范](http://www.esri.com/library/whitepapers/pdfs/shapefile.pdf)，shx 包含一个 100 字节的标头，后跟一系列 8 字节的记录。每条记录存储主 .shp 数据文件中记录的 4 字节偏移量和 4 字节内容长度。

```
+-----------------------------------------------+
| header (100 bytes)                            |
+-----------------+------------------+----------+
| offset(4 bytes) | length (4 bytes) | 
+-----------------+------------------+
| offset(4 bytes) | length (4 bytes) | 
+-----------------+------------------+
| offset(4 bytes) | length (4 bytes) | 
+-----------------+------------------+
| offset(4 bytes) | length (4 bytes) | 
+-----------------+------------------+
| ....                               | 
+-----------------+------------------+ 
```

请注意，偏移量以 16 位字指定，因此第一条记录的偏移量为 50（因为 .shp 标头是 100 字节或 50 字长）。内容长度也以 16 位字指定。

因此，您可以从 中找出记录数`(index_file_length-100)/8`，并使用索引随机或按顺序访问 .shp 文件中的特定形状记录。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-19T22:11:56.647

Paul Dixon 的回答很好。

虽然我想知道你打算用它做什么！如果您要编写代码来读取或写入 SHP 文件，我强烈建议您改用库 - 有一些很好的免费开源库，例如[GDAL](http://www.gdal.org/)，也有一些很好的商业库。

# c# - PushbackInputStream 的 C# 实现

> ID：482864
> 
> 赞同：3
> 
> 时间：2009-01-27T10:15:05.510
> 
> 标签：c#

我需要 Java 的 PushbackInputStream 的 C# 实现。我已经制作了自己的非常基本的版本，但我想知道是否有一个经过良好测试且性能良好的版本已经在某处可用。碰巧我总是推回我读过的相同字节，所以实际上它只需要能够向后重新定位，缓冲我指定的字节数。（就像 Java 的带有 mark 和 reset 方法的 BufferedInputStream 一样）。

**更新：**我应该补充一点，我不能简单地重新定位流，因为 CanSeek 可能是错误的。（例如，当输入流是[NetworkStream](http://msdn.microsoft.com/en-us/library/system.net.sockets.networkstream.canseek.aspx)时）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-27T10:38:06.790

将数据推回流中的问题在于，位于流*顶部*的任何读取器可能已经具有本地数据缓冲区。这使得这种方法非常脆弱。就个人而言，我会尽量避免这种情况，并在不需要回推或可以使用单字节 Peek 等的地方使用数据结构。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-27T10:40:52.743

您需要构建一个包装器类，该类既可用作流，但支持最后 X 字节的缓冲区，因此您至少可以在有限的距离内回溯，或者在您确实可以找到的根本不是流的地方“将数据推回输入流”。

无论哪种方式，您都将不得不自己写一些东西。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-27T10:18:59.997

您不能只使用 System.IO.Stream 并在从当前位置读取后向后搜索吗？

```
stream.Seek(-1, System.IO.SeekOrigin.Current) 
```

其中 -1 可能是您想要返回多远的变量？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-27T10:24:56.177

只要流表明它支持搜索（CanSeek），那么

```
stream.Seek(-offset, System.IO.SeekOrigin.Current) 
```

会没事的。

# .net - 两个列表的叉积

> ID：482866
> 
> 赞同：15
> 
> 时间：2009-01-27T10:16:47.660
> 
> 标签：.net, f#

*搞乱 List 模块的“扩展功能”。（我花了很长时间开发“mapfold”——它线程化了一个像 fold 这样的累加器，但使用它作为参数来创建像 map 这样的新值——然后发现这就是`List.scan_left`它的作用）*

为了生成测试数据，我需要做两个列表的叉积，这就是我想出的：

```
///Perform cross product of two lists, return tuple
let crossproduct l1 l2 =
    let product lst v2 = List.map (fun v1 -> (v1, v2)) lst
    List.map_concat (product l1) l2 
```

这有什么好处，还是已经有更好的方法来做到这一点？

同样的问题：

```
///Perform cross product of three lists, return tuple
let crossproduct3 l1 l2 l3 =
    let tuplelist = crossproduct l1 l2 //not sure this is the best way...
    let product3 lst2 v3 = List.map (fun (v1, v2) -> (v1, v2, v3)) lst2
    List.map_concat (product3 tuplelist) l3 
```

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2009-01-27T10:40:24.727

另一种选择是使用 F#“序列表达式”并编写如下内容：

```
let crossproduct l1 l2 =
  seq { for el1 in l1 do
          for el2 in l2 do
            yield el1, el2 };; 
```

（其实和你写的差不多，因为'for .. in .. do'在序列表达式中可以看成map_concat）。这适用于（惰性）序列，但如果您想使用列表，您只需将代码包装在 [ ... ] 中而不是 seq { ... } 中。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2018-05-12T13:54:20.393

从 F# 4.0 开始，您可以使用[`List.allPairs`](https://fsharp.github.io/fsharp-core-docs/reference/fsharp-collections-listmodule.html#allPairs)给出两个列表的笛卡尔积。

如果您有两个以上的列表，请参阅[如何在 F# 中计算 n 个序列的笛卡尔积？](https://stackoverflow.com/questions/3334429/how-do-i-compute-the-cartesian-product-of-n-sequences-in-f/50306962#50306962)

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2011-05-16T05:51:53.060

刚刚使用计算表达式遇到了一个相当优雅的解决方案：

```
type Product () =
  member this.Bind (l,f) = List.collect f l    
  member this.Return n = [n]

let enumeratedPizzas = 
  Product() {
    let! x = ["New York";"Chicago"]
    let! y = ["Pepperoni";"Sausage"]
    let! z = ["Cheese";"Double Cheese"]
    return x,y,z
  } 
```

通过技术，从 fssnip.net 复制[，](https://stackoverflow.com/users/388553/techneilogy)[点击](http://fssnip.net/4L)链接查看注释代码。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-27T13:31:02.683

您的叉积函数看起来不错（您可能已经注意到缺少“in”关键字）。我更喜欢这个版本的 crossproduct3，但这只是我：

```
let crossproduct3 l1 l2 l3 = 
List.map_concat 
(fun z ->
 (List.map_concat (fun y -> List.map (fun x -> (x, y, z)) l3) l2)) l1;; 
```

您的函数具有等效的算法复杂性。

*最后，在显式空*列表上使用 crossproduct 时，您可能会遇到*[值限制](http://thread.gmane.org/gmane.comp.lang.fsharp.general/264)*（粗略地说，一种确保编译器仅推断语法值的多态类型的限制），这在 F# 中特别严格。解决方案是通过以下方式注释使用空列表的调用（如果您希望第二个列表由整数组成）：

```
(crossproduct [3; 4] [] : (int * int) list) 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2017-07-10T16:43:05.953

我用 Benjol 回答了一段时间，直到我发现你几乎可以用`Linq`. Benjol 的解决方案可能仍然是最优雅的，但如果有人想要一个您也可以使用的解决方案，那么您可以`C#`在这里：

```
query {
  for i in [1, 2] do
  for j in [3, 4] do
  select (i, j)
} 
```

这与 Tomas Petricek 的解决方案几乎完全相同，只是该解决方案不需要嵌套`for`循环，因此稍微简单一些。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-10T10:06:42.163

我最近需要类似的东西——我必须将一个序列列表压缩到一个列表序列中——所以`[(a1,a2,a3,...);(b1,b2,b3,...);(c1,c2,c3,...)] -> ([a1;b1;c1], [a2;b2;c3], ...)`

以下代码将执行此操作：

```
 let rec listZip (sl : 'a seq list) =   
       seq {  
           match sl with  
           | [] -> yield []  
           | hd::tl ->  
              for h in hd do  
              for t in listZip tl do  
              yield (h::t)  
   } 
```

# wpf - XAML 中硬编码大小的最佳实践

> ID：482873
> 
> 赞同：1
> 
> 时间：2009-01-27T10:19:15.190
> 
> 标签：wpf, silverlight, xaml

我知道在 WPF 中，您希望控件的大小尽可能灵活，以便它们可以根据上下文（如 CSS）流动和扩展。

但是我遇到的大多数代码示例都是硬编码大小，例如本示例中的高度：

```
<Grid.ColumnDefinitions>
    <ColumnDefinition Width="0.5*"/>
    <ColumnDefinition Width="0.5*"/>
</Grid.ColumnDefinitions>
<Grid.RowDefinitions>
    <RowDefinition Height="31"/>
    <RowDefinition Height="31"/>
    <RowDefinition Height="31"/>
</Grid.RowDefinitions> 
```

为每一行分配高度“31”不是一种不应该效仿的坏习惯吗？或者这是有原因的？或者可能是作者在设计视图中创建了这些示例，而只是不清理硬编码的高度。

有没有人有任何关于元素大小的最佳实践（尤其是关于使用 * 语法），那些开始使用 XAML 的人可以从一开始就养成良好的习惯？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-27T10:43:40.883

一般来说，最好在 XAML 中使用动态大小，因为正如您所说，WPF 的概念是独立于固定尺寸的。在您的特定示例中，我不知道作者是否需要它，请记住，仍然存在一些涉及硬编码值的情况（可能是自定义菜单栏或您希望保持其大小一致的面板）。符号“2*”表示该值将是其他列值的两倍，因此，在每列中使用星号表示法不是很有用。

如果您正在寻找一些示例，我可以将您发送到这[两个](http://learnwpf.com/Posts/Post.aspx?postId=c76411d6-5350-4a10-b6bb-f1481c167ecf) [站点](http://blogs.interknowlogy.com/johnbowen/archive/2007/08/27/21132.aspx)（但如果您在谷歌上搜索“WPF 星号”或类似的内容，您会找到其他站点）。另外，如果您正在寻找一本关于 WPF 的非常好的书，我当然可以为您指出[Adam Nathan 的 Windows Presentation Foundation](https://rads.stackoverflow.com/amzn/click/com/0672328917)。它是我的最爱之一，它写得很好，充满了彩色示例，涵盖了 WPF 的各个方面。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-27T14:50:00.620

在大多数情况下，最好使用动态大小，但 Stefano 指出的某些情况除外。您应该记住，WPF 是一项相当新的技术，很多人都在尝试学习它。通常，当学习一项新技术时，人们会从制作他们所知道的东西开始（例如，用 C# 编写，就好像它是 Java 一样），然后在他们学会一点之后才开始以“正确”的方式编写代码。始终对博客文章持保留态度。

但是，根据您发布的代码，我猜他们使用 Blend 来创建 XAML。它总是做一些愚蠢的事情，比如添加行高并使两列都为“0.5 *”。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-29T19:59:04.513

有时您无法摆脱明确的大小调整，特别是当您使用设计器资产时，这些资产通常会在诸如表达式设计之类的工具中转换为调整大小的路径。当您想要布局具有显式大小的控件，然后像动态大小的对象一样转身使用它时，您应该使用 Viewbox。

在 WPF 中，在 Viewbox 中包装一个大小的控件将负责动态执行转换，以便它可以正确缩放。这可能对性能有影响，但我不知道它比动态定义大小差多少。在 Silverlight 中，没有开箱即用的 Viewbox，但您可以使用 Silverlight Toolkit 的原型 Viewbox 为您提供同等体验。

# iphone - iPhone 开发 - 我在哪里可以获得应用程序接收到的所有信号的列表以及它们的含义

> ID：482876
> 
> 赞同：4
> 
> 时间：2009-01-27T10:20:34.547
> 
> 标签：iphone, debugging

在手机上进行测试时，我的应用程序在特定时间点崩溃。控制台显示此消息

```
Tue Jan 27 15:47:14 unknown SpringBoard[22] <Warning>: Application <SBApplication: 0x3f26180> com.myprof.test activate:  deactivate:  exited abnormally with signal 10: Bus error 
```

我在哪里可以找到包含所有这些信号含义的列表？谢谢。

***编辑：*** 有没有办法知道为什么会发生错误？根据信号手册页，信号 10 是总线错误（顺便说一句，从错误中清除）但它是什么意思以及如何删除它？

再次感谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-27T12:49:08.290

[信号手册页](http://developer.apple.com/DOCUMENTATION/Darwin/Reference/ManPages/man3/signal.3.html)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-27T13:24:57.843

总线错误意味着您正在尝试访问[CPU 无法物理访问](http://en.wikipedia.org/wiki/Bus_error)的内存。与分段错误相反，这意味着您正在访问不属于您的内存。无论哪种方式，您都可能有一个流浪指针。

尝试在 XCode (Guard Malloc) 中使用内存分配调试器。它只会在模拟器中运行并且会减慢很多速度，但我发现它非常有用。

# xslt - XSLT 编码问题，结果中有问号

> ID：482877
> 
> 赞同：2
> 
> 时间：2009-01-27T10:21:20.663
> 
> 标签：xslt, encoding, saxon

我正在尝试运行 XSLT 转换，但像 ëöï 这样的字符被替换为文字 '?' 在输出中（我用十六进制编辑器检查）。源文件具有正确的字符，样式表具有：

```
<xsl:output encoding="UTF-8" indent="yes" method="xml"/> 
```

我还缺少什么？

如果这很重要，我正在使用撒克逊人作为变压器。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-27T10:31:32.793

问题很可能出在您调用变压器的方式上。*我的猜测是，如果您使用java -jar saxon.jar*调用它，它会正常工作...

 *一般来说，当您使用带有 InputStream/OutputStream 的 XML 工具时，这些工具会确保编码是正确的。

当您混合使用 Streams 和 Writers 时，您必须确保从一个到另一个的编码与您告诉 XSLT 处理器生成的编码相匹配。始终明确设置编码。可能有默认值，但在编码方面，它们往往是错误的。

# api - 获取 Google API 帐户

> ID：482883
> 
> 赞同：4
> 
> 时间：2009-01-27T10:24:06.803
> 
> 标签：api, seo

我可以访问哪个 URL 来获取自己的 Google API 帐户？虽然网站指向[http://www.google.com/apis](http://www.google.com/apis)并谈论“简单的步骤”，但我就是想不通。

### 背景：

如果您向他们提供您的 Google API 帐户密钥（在我的情况下为[http://www.freesitemapgenerator.com](http://www.freesitemapgenerator.com)和索引检索），网络上的某些地方会提供 google 服务。

他们说去[http://www.google.com/apis](http://www.google.com/apis)，但这只是将我重定向到[http://code.google.com](http://code.google.com)。我没有“简单的说明”来获取帐户。

我在这里疯了吗？（我已经激活了分析和网站管理员工具等，所以我有点知道我在做什么）。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-27T10:36:47.980

[自 2006 年 12 月起，Google 不再发布这些 API 密钥](http://code.google.com/apis/soapsearch/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-27T10:30:46.617

据我了解，您申请了 API*密钥*，您可以使用任何 Google 帐户进行申请。各种 API 似乎需要不同的密钥。要获取 Maps API 的密钥，请访问：

[http://code.google.com/apis/maps/signup.html](http://code.google.com/apis/maps/signup.html)

[谷歌代码](http://code.google.com/)上的[产品目录](http://code.google.com/more/)列出了谷歌似乎为开发者提供某种交互的每个产品，其中一些具有 API 密钥。查看该页面并访问每个产品的主页以获得密钥。

具体来说，您可以查看[Google AJAX API 的](http://code.google.com/apis/ajax/)页面，该页面展示了存在 AJAX API 的每种产品。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-05-31T07:35:02.997

您需要创建项目，因为 API 密钥与项目相关联。在这里你可以这样做 [https://code.google.com/apis/console/](https://code.google.com/apis/console/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-27T10:31:55.117

也许看看[这里](http://code.google.com/intl/it-IT/apis/maps/signup.html)并记住“单个 Maps API 密钥对单个“目录”或域有效”。

# c - C99 中的 struct 与 ANSI-C 有什么区别？

> ID：482884
> 
> 赞同：1
> 
> 时间：2009-01-27T10:24:13.480
> 
> 标签：c, struct, c99, splint

此代码在 ANSI-C 中似乎不正确，但在 C99 中可以：

```
struct a { int x; int y; } z; 
```

C99 和 ANSI-C 中的 struct 有什么区别？

编辑：我忘记了“a”，我的错。此代码在 C99 模式下使用 gcc 编译正常，但在 splint 上出现解析错误，已知它不支持所有 C99 扩展。

Edit2：这是 splint 的输出：

```
Splint 3.1.2 --- 19 Dec 2007

build/ecos_install/include/cyg/fileio/fileio.h:151:5:
Parse Error. Attempting to continue.
build/ecos_install/include/cyg/fileio/fileio.h:151:25:
Cannot recover from parse error.
*** Cannot continue. 
```

Edit3：这个文件是 eCos fileio.h（这个片段的最后一行是第 152 行）：

```
typedef CYG_ADDRWORD cyg_dir;

//=============================================================================
// Filesystem table entry

typedef int     cyg_fsop_mount    ( cyg_fstab_entry *fste, cyg_mtab_entry *mte );
typedef int     cyg_fsop_umount   ( cyg_mtab_entry *mte );
typedef int     cyg_fsop_open     ( cyg_mtab_entry *mte, cyg_dir dir, const char *name,
                                    int mode,  cyg_file *fte );
typedef int     cyg_fsop_unlink   ( cyg_mtab_entry *mte, cyg_dir dir, const char *name );
typedef int     cyg_fsop_mkdir    ( cyg_mtab_entry *mte, cyg_dir dir, const char *name );
typedef int     cyg_fsop_rmdir    ( cyg_mtab_entry *mte, cyg_dir dir, const char *name );
typedef int     cyg_fsop_rename   ( cyg_mtab_entry *mte, cyg_dir dir1, const char *name1,
                                    cyg_dir dir2, const char *name2 );
typedef int     cyg_fsop_link     ( cyg_mtab_entry *mte, cyg_dir dir1, const char *name1,
                                    cyg_dir dir2, const char *name2, int type );
typedef int     cyg_fsop_opendir  ( cyg_mtab_entry *mte, cyg_dir dir, const char *name,
                                    cyg_file *fte );
typedef int     cyg_fsop_chdir    ( cyg_mtab_entry *mte, cyg_dir dir, const char *name,
                                    cyg_dir *dir_out );
typedef int     cyg_fsop_stat     ( cyg_mtab_entry *mte, cyg_dir dir, const char *name,
                                    struct stat *buf);
typedef int     cyg_fsop_getinfo  ( cyg_mtab_entry *mte, cyg_dir dir, const char *name,
                                    int key, void *buf, int len );
typedef int     cyg_fsop_setinfo  ( cyg_mtab_entry *mte, cyg_dir dir, const char *name,
                                    int key, void *buf, int len );

struct cyg_fstab_entry
{
    const char          *name;          // filesystem name
    CYG_ADDRWORD        data;           // private data value
    cyg_uint32          syncmode;       // synchronization mode

    cyg_fsop_mount      *mount;
    cyg_fsop_umount     *umount;
    cyg_fsop_open       *open;
    cyg_fsop_unlink     *unlink;
    cyg_fsop_mkdir      *mkdir;
    cyg_fsop_rmdir      *rmdir;
    cyg_fsop_rename     *rename;
    cyg_fsop_link       *link;
    cyg_fsop_opendir    *opendir;
    cyg_fsop_chdir      *chdir;
    cyg_fsop_stat       *stat;
    cyg_fsop_getinfo    *getinfo;
    cyg_fsop_setinfo    *setinfo;
} CYG_HAL_TABLE_TYPE; 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-27T10:48:37.533

```
struct { int x; int y; } z; 
```

从 1978 年以来的每个 C 版本（可能更早），这段代码都是有效的 C，具有相同的语义。它定义了一个名为 z 的变量，它的类型是一个无名结构类型，它由两个整数组成。

ofaurax，你会得到什么错误信息来断定它不起作用？

（迂腐的尼特：“ANSI C”是指由美国国家标准协会（ANSI）标准化的 C 版本。1989 年版本的 ANSI C 标准被国际标准化组织 ISO 采用。1999 年 ISO 制定了新版本的C 标准，然后 ANSI 采用了该标准。）

编辑：

```
struct a { int x; int y; } z; 
```

这定义了一个结构类型，称为“struct a”，由两个 int 和一个该类型的变量 z 组成。即使在 1978 年版本的 C（“K&R”）中，这仍然是格式良好的。我不知道什么是拆分，但确切的错误消息仍然可能帮助我们找出问题所在。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-27T11:44:12.477

[Splint 3.1.2](http://www.splint.org/)可以很好地解析包含该代码的文件。

您能否提供一个简单、完整的示例来展示您所描述的行为？

快速进行一些实验表明，夹板似乎不支持混合代码和声明，这会让我无法使用它。所以你自己发布的代码*是*可以的，但这会产生解析错误：

```
void foo () {
   int x = 1;
   ++x;
   struct a { int x; int y; } z;
} 
```

对语法的这种更改将允许它解析上面的简单混合代码和声明，然后它*似乎*可以工作，但我没有对它进行详尽的测试。

```
$ diff original/src/cgrammar.y src/cgrammar.y
1711a1712
>  | initializer 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-27T11:03:33.977

你能显示实际的编译器警告、编译器标志和代码的相关行吗？你的例子绝对没有错。或者，也许是指向导致您得出结论的文档的链接？

如果您信任编译器来告诉您区别，那么您使用的是什么编译器/版本？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-27T10:36:26.827

不太确定，但是在“旧”编译器中，我记得必须将其写为

```
typedef struct _Z {int x; int y;} z; or just typedef struct {int x; int y;} z; 
```

# sql - 仅当外键约束存在于 sql server 中时，如何删除它？

> ID：482885
> 
> 赞同：269
> 
> 时间：2009-01-27T10:24:13.747
> 
> 标签：sql, sql-server, sql-server-2005, tsql

如果表存在，我可以使用以下代码删除表，但不知道如何对约束执行相同操作：

```
IF EXISTS(SELECT 1 FROM sys.objects WHERE OBJECT_ID = OBJECT_ID(N'TableName') AND type = (N'U')) DROP TABLE TableName
go 
```

我还使用以下代码添加了约束：

```
ALTER TABLE [dbo].[TableName] 
  WITH CHECK ADD CONSTRAINT [FK_TableName_TableName2] FOREIGN KEY([FK_Name])
    REFERENCES [dbo].[TableName2] ([ID])
go 
```

* * *

## 回答 #1

> 赞同：362
> 
> 时间：2012-11-01T23:10:56.053

这比当前提出的解决方案简单得多：

```
IF (OBJECT_ID('dbo.FK_ConstraintName', 'F') IS NOT NULL)
BEGIN
    ALTER TABLE dbo.TableName DROP CONSTRAINT FK_ConstraintName
END 
```

如果您需要删除另一种类型的约束，这些是在第二个参数位置传递给 OBJECT_ID() 函数的适用代码：

```
C = CHECK constraint
D = DEFAULT (constraint or stand-alone)
F = FOREIGN KEY constraint
PK = PRIMARY KEY constraint
UQ = UNIQUE constraint 
```

您也可以使用不带第二个参数的 OBJECT_ID。

[此处](http://technet.microsoft.com/en-us/library/ms190324.aspx)的完整类型列表：

对象类型：

> ```
> AF = Aggregate function (CLR)
> C = CHECK constraint
> D = DEFAULT (constraint or stand-alone)
> F = FOREIGN KEY constraint
> FN = SQL scalar function
> FS = Assembly (CLR) scalar-function
> FT = Assembly (CLR) table-valued function
> IF = SQL inline table-valued function
> IT = Internal table
> P = SQL Stored Procedure
> PC = Assembly (CLR) stored-procedure
> PG = Plan guide
> PK = PRIMARY KEY constraint
> R = Rule (old-style, stand-alone)
> RF = Replication-filter-procedure
> S = System base table
> SN = Synonym
> SO = Sequence object 
> ```

**适用于：SQL Server 2012 到 SQL Server 2014。**

> ```
> SQ = Service queue
> TA = Assembly (CLR) DML trigger
> TF = SQL table-valued-function
> TR = SQL DML trigger
> TT = Table type
> U = Table (user-defined)
> UQ = UNIQUE constraint
> V = View
> X = Extended stored procedure 
> ```

* * *

## 回答 #2

> 赞同：345
> 
> 时间：2009-01-27T10:26:14.693

[Eric Isaacs 的](https://stackoverflow.com/a/13186918)回答中提供了更简单的解决方案。但是，它会在任何表上找到约束。如果要针对特定​​表的外键约束，请使用以下命令：

```
IF EXISTS (SELECT * 
  FROM sys.foreign_keys 
   WHERE object_id = OBJECT_ID(N'FK_TableName_TableName2')
   AND parent_object_id = OBJECT_ID(N'dbo.TableName')
)
  ALTER TABLE [dbo].[TableName] DROP CONSTRAINT [FK_TableName_TableName2] 
```

* * *

## 回答 #3

> 赞同：56
> 
> 时间：2015-11-03T13:22:28.030

在 SQL Server 2016 中，您可以使用 DROP IF EXISTS：

```
CREATE TABLE t(id int primary key, 
               parentid int
                    constraint tpartnt foreign key references t(id))
GO
ALTER TABLE t
DROP CONSTRAINT IF EXISTS tpartnt
GO
DROP TABLE IF EXISTS t 
```

请参阅[https://web.archive.org/web/20151105064708/http://blogs.msdn.com/b/sqlserverstorageengine/archive/2015/11/03/drop-if-exists-new-thing-in-sql -server-2016.aspx](https://web.archive.org/web/20151105064708/http://blogs.msdn.com/b/sqlserverstorageengine/archive/2015/11/03/drop-if-exists-new-thing-in-sql-server-2016.aspx)

* * *

## 回答 #4

> 赞同：17
> 
> 时间：2012-05-31T14:23:35.687

```
IF (OBJECT_ID('DF_Constraint') IS NOT NULL)
BEGIN
    ALTER TABLE [dbo].[tableName]
    DROP CONSTRAINT DF_Constraint
END 
```

* * *

## 回答 #5

> 赞同：16
> 
> 时间：2012-02-01T03:13:30.307

如果您知道实际约束的名称，[詹姆斯的答案就可以了。](https://stackoverflow.com/a/482890/1501497)棘手的是，在遗留和其他现实世界场景中，您可能不**知道**约束被称为什么。

如果是这种情况，您可能会创建重复的约束，为避免您可以使用：

```
create function fnGetForeignKeyName
(
    @ParentTableName nvarchar(255), 
    @ParentColumnName nvarchar(255),
    @ReferencedTableName nvarchar(255),
    @ReferencedColumnName nvarchar(255)
)
returns nvarchar(255)
as
begin 
    declare @name nvarchar(255)

    select @name = fk.name  from sys.foreign_key_columns fc
    join sys.columns pc on pc.column_id = parent_column_id and parent_object_id = pc.object_id
    join sys.columns rc on rc.column_id = referenced_column_id and referenced_object_id = rc.object_id 
    join sys.objects po on po.object_id = pc.object_id
    join sys.objects ro on ro.object_id = rc.object_id 
    join sys.foreign_keys fk on fk.object_id = fc.constraint_object_id
    where 
        po.object_id = object_id(@ParentTableName) and 
        ro.object_id = object_id(@ReferencedTableName) and
        pc.name = @ParentColumnName and 
        rc.name = @ReferencedColumnName

    return @name
end

go

declare @name nvarchar(255)
declare @sql nvarchar(4000)
-- hunt for the constraint name on 'Badges.BadgeReasonTypeId' table refs the 'BadgeReasonTypes.Id'
select @name = dbo.fnGetForeignKeyName('dbo.Badges', 'BadgeReasonTypeId', 'dbo.BadgeReasonTypes', 'Id')
-- if we find it, the name will not be null
if @name is not null 
begin 
    set @sql = 'alter table Badges drop constraint ' + replace(@name,']', ']]')
    exec (@sql)
end 
```

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2009-01-27T10:26:41.290

```
ALTER TABLE [dbo].[TableName]
    DROP CONSTRAINT FK_TableName_TableName2 
```

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2012-02-02T12:42:25.803

```
Declare @FKeyRemoveQuery NVarchar(max)

IF EXISTS(SELECT 1 FROM sys.foreign_keys WHERE parent_object_id = OBJECT_ID(N'dbo.TableName'))

BEGIN
    SELECT @FKeyRemoveQuery='ALTER TABLE dbo.TableName DROP CONSTRAINT [' + LTRIM(RTRIM([name])) + ']'   
    FROM sys.foreign_keys
    WHERE parent_object_id = OBJECT_ID(N'dbo.TableName')

    EXECUTE Sp_executesql @FKeyRemoveQuery 

END 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2013-12-31T12:38:02.117

我想这会对你有所帮助...

```
 DECLARE @ConstraintName nvarchar(200)
SELECT 
    @ConstraintName = KCU.CONSTRAINT_NAME
FROM INFORMATION_SCHEMA.REFERENTIAL_CONSTRAINTS AS RC 
INNER JOIN INFORMATION_SCHEMA.KEY_COLUMN_USAGE AS KCU
    ON KCU.CONSTRAINT_CATALOG = RC.CONSTRAINT_CATALOG  
    AND KCU.CONSTRAINT_SCHEMA = RC.CONSTRAINT_SCHEMA 
    AND KCU.CONSTRAINT_NAME = RC.CONSTRAINT_NAME
WHERE
    KCU.TABLE_NAME = 'TABLE_NAME' AND
    KCU.COLUMN_NAME = 'TABLE_COLUMN_NAME'
IF @ConstraintName IS NOT NULL EXEC('alter table TABLE_NAME drop  CONSTRAINT ' + @ConstraintName) 
```

它将根据特定的表和列删除外键约束。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2017-09-21T02:08:16.930

关于这个问题的公认答案似乎对我不起作用。我用稍微不同的方法实现了同样的事情：

```
IF (select object_id from sys.foreign_keys where [name] = 'FK_TableName_TableName2') IS NOT NULL
BEGIN
    ALTER TABLE dbo.TableName DROP CONSTRAINT FK_TableName_TableName2
END 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2015-10-29T23:34:03.700

您可以使用这些查询来查找表的所有 FK。

```
Declare @SchemaName VarChar(200) = 'Schema Name'
Declare @TableName VarChar(200) = 'Table name'

-- Find FK in This table.
SELECT 
    'IF  EXISTS (SELECT * FROM sys.foreign_keys WHERE object_id = OBJECT_ID(N''' + 
      '[' + OBJECT_SCHEMA_NAME(FK.parent_object_id) + '].[' + FK.name + ']' 
      + ''') AND parent_object_id = OBJECT_ID(N''' + 
      '[' + OBJECT_SCHEMA_NAME(FK.parent_object_id) + '].[' 
      + OBJECT_NAME(FK.parent_object_id) + ']' + ''')) ' +

    'ALTER TABLE ' +  OBJECT_SCHEMA_NAME(FK.parent_object_id) +
    '.[' + OBJECT_NAME(FK.parent_object_id) + 
    '] DROP CONSTRAINT ' + FK.name
    , S.name , O.name, OBJECT_NAME(FK.parent_object_id)
FROM sys.foreign_keys AS FK
INNER JOIN Sys.objects As O 
  ON (O.object_id = FK.parent_object_id )
INNER JOIN SYS.schemas AS S 
  ON (O.schema_id = S.schema_id)  
WHERE 
      O.name = @TableName
      And S.name = @SchemaName

-- Find the FKs in the tables in which this table is used
  SELECT 
    ' IF  EXISTS (SELECT * FROM sys.foreign_keys WHERE object_id = OBJECT_ID(N''' + 
      '[' + OBJECT_SCHEMA_NAME(FK.parent_object_id) + '].[' + FK.name + ']' 
      + ''') AND parent_object_id = OBJECT_ID(N''' + 
      '[' + OBJECT_SCHEMA_NAME(FK.parent_object_id) + '].[' 
      + OBJECT_NAME(FK.parent_object_id) + ']' + ''')) ' +

    ' ALTER TABLE ' +  OBJECT_SCHEMA_NAME(FK.parent_object_id) +
    '.[' + OBJECT_NAME(FK.parent_object_id) + 
    '] DROP CONSTRAINT ' + FK.name
    , S.name , O.name, OBJECT_NAME(FK.parent_object_id)
FROM sys.foreign_keys AS FK
INNER JOIN Sys.objects As O 
  ON (O.object_id = FK.referenced_object_id )
INNER JOIN SYS.schemas AS S 
  ON (O.schema_id = S.schema_id)  
WHERE 
      O.name = @TableName
      And S.name = @SchemaName 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2020-10-15T20:23:10.177

好的，我知道我迟到了，但这是我认为最好的语法。如果需要，将模式名称添加到 OBJECT_ID 子句。

```
IF OBJECTPROPERTY(OBJECT_ID(N'My_FK_name'),'IsConstraint') =1
ALTER TABLE dbo.TableName DROP CONSTRAINT My_FK_name 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2021-10-11T09:37:56.093

所有表约束都将存储在 INFORMATION_SCHEMA.TABLE_CONSTRAINTS

```
IF EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLE_CONSTRAINTS AS C WHERE C.CONSTRAINT_NAME = '<CONSTRAINT NAME>' AND C.TABLE_NAME = '<TABLE NAME>')
BEGIN
    ALTER TABLE <TABLE NAME>
        DROP CONSTRAINT <CONSTRAINT NAME>
END
GO 
```

# vba - 查找并选择多行

> ID：482889
> 
> 赞同：4
> 
> 时间：2009-01-27T10:25:47.470
> 
> 标签：vba, excel

如何在列中搜索文本并选择与搜索文本匹配的所有列和行？

样品表：

```
 ColA  ColB  ColC  ColD
Row1        Bob
Row2        Jane
Row3        Joe
Row4        Joe
Row5        Jack
Row6        Jack
Row7        Jack
Row8        Peter
Row9        Susan 
```

因此，marco 搜索“Jack”，然后它应该选择 ColA-D 中的所有 Row5-7。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-28T09:34:25.700

我最终做了一些与我的问题略有不同的事情。

该宏将搜索源工作表中的每一行并将其复制到目标工作表，这是参数。数据不必排序，但这会延长宏的运行时间。您可以通过比较前一行搜索的不同值来解决此问题。目标工作表必须存在，并且任何数据都将被覆盖（无法撤消！）

```
Sub Search_SelectAndCopy(sheetname As String)

Dim SheetData As String
Dim DataRowNum As Integer, SheetRowNum As Integer

SheetData = "name of sheet to search in" //' Source sheet
DataRowNum = 2 //' Begin search at row 2
SheetRowNum = 2 //' Begin saving data to row 2 in "sheetname"

//' Select sheetname, as its apparently required before copying is allowed !
Worksheets(SheetData).Select

//' Search and copy the data
While Not IsEmpty(Cells(DataRowNum, 2)) //' Loop until column B gets blank
    //' Search in column B for our value, which is the same as the target sheet name "sheetname"
    If Range("B" & CStr(DataRowNum)).Value = sheetname Then
       //' Select entire row
       Rows(CStr(DataRowNum) & ":" & CStr(DataRowNum)).Select
       Selection.Copy

       //' Select target sheet to store the data "sheetname" and paste to next row
       Sheets(sheetname).Select
       Rows(CStr(SheetRowNum) & ":" & CStr(SheetRowNum)).Select
       ActiveSheet.Paste

       SheetRowNum = SheetRowNum + 1 //' Move to next row

       //' Select source sheet "SheetData" so searching can continue
       Sheets(SheetData).Select
   End If

   DataRowNum = DataRowNum + 1 //' Search next row
Wend

//' Search and copying complete. Lets make the columns neat
Sheets(sheetname).Columns.AutoFit

//' Finish off with freezing the top row
Sheets(sheetname).Select
Range("A2").Select
ActiveWindow.FreezePanes = True
End Sub 
```

使用前删除每一对 //。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-27T21:44:39.317

这并不像它可能的那样漂亮，但它完成了工作：

```
Public Sub SelectMultiple()
    Dim wbkthis As Workbook
    Dim shtthis As Worksheet
    Dim rngThis As Range
    Dim rngFind As Range
    Dim firstAddress As String
    Dim addSelection As String

    Set wbkthis = ThisWorkbook
    Set shtthis = wbkthis.Worksheets("Sheet1")

    // Set our range to search
    Set rngThis = shtthis.Range("B2", "B10")

    // Loop through it
    With rngThis

        // Find our required text
        Set rngFind = .Find("Jack")

        // If we find it then...
        If Not rngFind Is Nothing Then
            firstAddress = rngFind.Address // Take a note of where we first found it
            addSelection = addSelection & rngFind.Address & "," // Add the cell's range to our selection

            // Loop through the rest of our range and find any other instances.
            Do
                Set rngFind = .FindNext(rngFind)
                addSelection = addSelection & rngFind.Address & ","
            Loop While Not rngFind Is Nothing And rngFind.Address <> firstAddress

        End If
    End With

    // Trim the last comma from our string
    addSelection = Mid(addSelection, 1, Len(addSelection) - 1)
    shtthis.Range(addSelection).Rows.Select // Select our rows!

    Set rngThis = Nothing
    Set shtthis = Nothing
    Set wbkthis = Nothing

End Sub 
```

请注意：我已将 VBA ' 注释替换为 C# // 注释，以使此代码示例更清晰易读。

# c# - Clarion：可以使用 C# 程序集吗？

> ID：482902
> 
> 赞同：1
> 
> 时间：2009-01-27T10:32:12.730
> 
> 标签：c#, dll, clarion

是否可以使用 Clarion 的 C# 程序集？如果不。是否可以运行用 C# 编写的简单控制台应用程序并将其输出读回 Clarion？在这两种情况下，你会怎么做？在装配的情况下，您是否需要对它做一些特别的事情才能让 Clarion 访问它？在这两种情况下，您将如何在 Clarion 中做到这一点？

原因是我们有两个用 C# 编写的方法，供用 C# 编写的应用程序使用。但我们也需要在 Clarion 应用程序中使用相同的方法。而且我们真的不想再为 Clarion 编写方法，因为它们有点复杂......

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-02-09T10:52:35.787

除非您需要在您的 clarion 程序中显示 .Net UserControl，否则我建议您使用此处描述的技术：

Robert Giesecke -[用于非托管导出的 C# 项目模板](http://sites.google.com/site/robertgiesecke/Home/uploads/csharpprojecttemplateforunmanagedexports)

在 Clarion 方面，您只需像使用任何其他非托管 DLL 一样链接和使用 .Net 程序集。我发现使用 LoadLibrary API 在运行时加载 DLL 也很方便。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-01-13T20:36:39.100

Clarion 程序不会轻易或很好地调用 C# DLL，尽管反过来不一定正确。

在我的一个项目中，我决定使用 TCP/IP 将 Clarion 程序和 C# 程序集之间的耦合降至最低。

这个想法是让 Clarion 程序连接到您的迷你服务器的侦听端口，发送请求并接收回复，就像使用参数调用函数并接收结果一样。

在 C# 程序集中添加一个类来充当 TCP/IP 服务器很容易。在 Clarion 方面，有一些很好的模板可以提供 TCP/IP 功能。我们多年来一直在使用 CapeSoft 的 NetTalk 模板，它几乎坚如磐石。

根据您的要求的紧迫性，您可以考虑这条路线。

-射线。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-30T01:31:10.973

什么是歌乐？它是非托管应用程序吗？如果是，那么您将对程序集执行的“特殊操作”称为 Com Interop：http: [//msdn.microsoft.com/en-us/magazine/cc163494.aspx](http://msdn.microsoft.com/en-us/magazine/cc163494.aspx)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-31T11:48:51.430

Clarion 是一种编程语言。自己不知道。我工作的旧系统的一部分是用它制作的，我们正在努力将它移植到 C# .NET。所以有一段时间他们不得不并肩生活。我们找到了解决方法，因此不再需要它。但感谢您提供信息 :) 也许我们会在未来需要它。虽然我希望不会……呵呵。

对于那些好奇的人：[en.wikipedia.org/wiki/Clarion_(programming_language)](http://en.wikipedia.org/wiki/Clarion_%28programming_language%29)

# sharepoint - 是否可以将 Web 部件添加到“我的网站”的“我的个人资料”页面？

> ID：482904
> 
> 赞同：1
> 
> 时间：2009-01-27T10:32:56.037
> 
> 标签：sharepoint, moss, wss

**是否可以像在“我的主页”上一样**个性化“我的个人资料”页面？

![我的简历](https://i.stack.imgur.com/y2B2n.png)

我想删除默认的 Web 部件并添加其他的。
我不想使用 SharePoint Designer 或手动编辑任何文件。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-05T00:01:54.007

是的 - 页面右上角的“站点操作”菜单将允许您添加/删除 Web 部件。任何对自己的 MySite 有“完全控制权”的人（即每个人）都应该能够做到这一点。

# .net - 在计划任务中模拟 .NET 中的用户时出错

> ID：482905
> 
> 赞同：1
> 
> 时间：2009-01-27T10:33:28.127
> 
> 标签：.net, process, windows-server-2003, scheduled-tasks, impersonation

我有一个在 Windows Server 2003 上运行的 .NET 控制台应用程序，作为计划任务。

这使用 Process 类来运行另一个小控制台应用程序，但它使用 Process.StartInfo.Username 来模拟用户来运行它。

如果在管理员的计划任务中模拟的帐户，那么它可以正常工作，但如果不是，那么我会收到错误：

> '应用程序初始化失败（0xc0000142）'</p>

我曾尝试让用户“作为批处理作业登录”和“本地登录”，但这似乎没有任何效果。控制台应用程序确实以模拟用户身份启动，但随后失败。

查看 Process Monitor，它失败之前的最后一个事件是：

> Tool1.exe - 加载映像 - C:\WINDOWS\system32\kernel32.dll - 成功

我已经运行了 Depends on the tool，它报告这是错误：

> GetProcAddress(0x77E40000 [c:\windows\system32\KERNEL32.DLL], "FlsAlloc") 从地址 0x7900746D 的 "c:\windows\system32\MSCOREE.DLL" 调用并由线程 1 返回 0x77E6B49C。退出 "c:\stfinstall \stf\tools\tool1\TOOL1.EXE"（进程 0xB3C），线程 1 的代码为 1282 (0x502)。

如果有人知道可能导致此错误的原因，或者更好的是，我该如何解决它，请告诉我！

也欢迎提出替代方法的建议

谢谢 ：）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-13T08:42:37.513

我已经解决了这个问题，问题是它无法访问计划任务运行的用户的桌面，所以它失败了。管理员似乎能够拥有此访问权限。

我解决的方法是让用户以永久登录的方式运行任务，因此始终可以访问桌面，这可以正常工作。丑我知道！

# .net - WinForms 中的组框

> ID：482910
> 
> 赞同：1
> 
> 时间：2009-01-27T10:36:19.320
> 
> 标签：.net, winforms

我有一个关于设计winforms的问题。

我应该在表单中使用还是不使用分组框？对用户有好处吗？给我一些优点还是缺点？

有些人认为它不够好用。

你怎么看待这件事？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-27T10:52:16.230

一个原因是对 RadioButtons 进行分组。

对于添加到 UI 中的每个元素，您都应该问自己几个问题：

*   为什么要添加元素？
*   为什么会设在这个位置？
*   为什么是这个颜色？
*   为什么我不使用标准控件/颜色/字体/...
*   等等

如果你能找到这个问题的好答案，你可以把它包括在内。但是你应该能够解释你为什么使用它。

因此，对于组框，您可能会说：

*   它节省了我的表单空间，因为我可以防止标签重复。
*   它明确区分了其他控件
*   用户知道它用于对控件进行分组

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-27T10:52:40.803

GroupBox 是大多数 Windows 应用程序中常见的 UI 部分，因此它们被用户普遍识别。我认为它们对于向用户传达某些控件以某种方式相关（例如 RadioBox 或 CheckBox）非常有用，而且由于包含的元素被视为子元素，因此您可以更轻松地管理它们。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-27T11:15:38.913

大多数应用程序需要某种控制分组，否则它们看起来会很混乱。

GroupBox is a good thing because the user is used to it. But likely the user will recognize other grouping mechanisms as well. I like the Krypton Toolkit with its HeaderGroup approach to grouping, because it allows to display more group-related information in the top and bottom header. But if you don't need that, a traditional group box should be fine. On a dialog box, that is. On main windows, it doesn't fit in my oppinion, in contrast to the mentioned HeaderGroup, which easily fits both scenarios.

# sql - SQL 按年、月、周、日、小时分组 SQL 与过程性能

> ID：482912
> 
> 赞同：24
> 
> 时间：2009-01-27T10:36:35.857
> 
> 标签：sql, sql-server, performance

我需要编写一个查询，该查询将按从年到小时的时间段对大量记录进行分组。

我最初的方法是在 C# 中以程序方式确定周期，遍历每个周期并运行 SQL 以获取该周期的数据，同时构建数据集。

```
SELECT Sum(someValues)
FROM table1
WHERE deliveryDate BETWEEN @fromDate AND @ toDate 
```

后来我发现我可以使用 Year()、Month() Day() 和 datepart(week, date) 和 datepart(hh, date) 对记录进行分组。

```
SELECT Sum(someValues)
FROM table1
GROUP BY Year(deliveryDate), Month(deliveryDate), Day(deliveryDate) 
```

我担心的是，由于不能有效地使用 datetime 字段上的索引，因此在 group by 中使用 datepart 会导致性能比在一段时间内多次运行查询更差；关于这是否属实的任何想法？

谢谢。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-01-27T10:44:26.543

与任何与性能相关的**Measure**

为第二种方法检查查询计划将提前告诉您任何明显的问题（当您知道不需要时进行全表扫描），但无法替代测量。在 SQL 性能测试中，应该使用适当大小的测试数据进行测量。

由于这是一个复杂的情况，您不是简单地比较两种不同的方法来执行单个查询，而是将单个查询方法与迭代方法进行比较，环境的各个方面可能在实际性能中起主要作用。

具体来说

1.  您的应用程序和数据库之间的“距离”，因为与一个大查询方法相比，每次调用的延迟都会浪费时间
2.  无论您是否使用准备好的语句（在每个查询上导致数据库引擎的额外解析工作）
3.  范围查询本身的构建是否成本高昂（受 2 的严重影响）

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-01-27T10:47:11.687

如果将公式放入比较的字段部分，**则会得到 table scan**。

索引在字段上，而不是在 datepart(field) 上，**所以必须计算所有字段**- 所以我认为你的预感是正确的。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-01-27T11:16:16.697

你可以做类似的事情：

```
SELECT Sum(someValues)
FROM 
(
    SELECT *, Year(deliveryDate) as Y, Month(deliveryDate) as M, Day(deliveryDate) as D
    FROM table1
    WHERE deliveryDate BETWEEN @fromDate AND @ toDate
) t
GROUP BY Y, M, D 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-01-27T11:59:36.610

如果您可以容忍再加入一张桌子对性能造成的影响，我有一个看起来很奇怪但效果很好的建议。

创建一个我将称之为 ALMANAC 的表，其中包含工作日、月份、年份等列。您甚至可以为日期的公司特定功能添加列，例如该日期是否为公司假日。您可能想要添加开始和结束时间戳，如下所述。

虽然你可能每天排一排，但当我这样做时，我发现每班排一排很方便，一天三班。即使按照这样的速度，十年的时间也只有一万多行。

当您编写 SQL 来填充此表时，您可以利用所有面向日期的内置函数来简化工作。当您进行查询时，您可以使用日期列作为连接条件，或者您可能需要两个时间戳来提供一个范围以捕获该范围内的时间戳。其余部分与处理任何其他类型的数据一样简单。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-03-16T15:46:00.157

我一直在为报告目的寻找类似的解决方案，并偶然发现了这篇名为[Group by Month (and other time period) 的](http://weblogs.sqlteam.com/jeffs/archive/2007/09/10/group-by-month-sql.aspx)文章。它显示了按日期时间字段分组的各种方式，无论好坏。绝对值得一看。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-27T10:44:57.387

我认为您应该对其进行基准测试以获得可靠的结果，但是，恕我直言，我的第一个想法是让数据库处理它（您的第二种方法）会比您在客户端代码中执行它时快得多。使用第一种方法，您可以多次往返数据库，我认为这会贵得多。:)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-01-27T15:08:51.127

您可能想查看一种维度方法（这与 Walter Mitty 建议的类似），其中每一行都有一个指向日期和/或时间维度的外键。这允许通过连接到预先计算这些部分的该表进行非常灵活的求和。在这些情况下，密钥通常是格式为 YYYYMMDD 和 HHMMSS 的自然整数密钥，其性能相对较高且人类可读。

另一种选择可能是索引视图，其中每个日期部分都有单独的表达式。

或计算列。

但是必须测试性能并检查执行计划......

# asp.net - 从 ASP.NET MVC 应用程序调用带有 ASP.NET AJAX 仅客户端脚本的 Web 服务？

> ID：482916
> 
> 赞同：2
> 
> 时间：2009-01-27T10:39:19.627
> 
> 标签：asp.net, asp.net-mvc, web-services, asp.net-ajax

我正在寻找一个基本示例，说明如何使用 ASP.NET Ajax Toolkit 附带的客户端 JavaScript 调用 Web 服务。

我已经找到了一些例子来展示你如何使用 ASP.NET WebForms 来做这件事，但是我使用的是 ASP.NET MVC，所以对我来说没有花哨的 ScriptManager :(

有人知道有关此主题的有见地的博客文章吗？

蒂亚

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-27T10:48:09.157

我推荐使用 JQuery，本指南对于调用 ASP.NET Web 服务非常简单：

[http://encosia.com/2008/03/27/using-jquery-to-consume-aspnet-json-web-services/](http://encosia.com/2008/03/27/using-jquery-to-consume-aspnet-json-web-services/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-27T10:46:52.827

也许这可以帮助你？

1.  [在 ASP.NET MVC 中使用 jQuery](http://www.chadmyers.com/Blog/archive/2007/12/13/using-jquery-with-asp.net-mvc.aspx)
2.  [带有 ASP.NET MVC 的 AJAX 面板](http://www.singingeels.com/Articles/AJAX_Panels_with_ASPNET_MVC.aspx)
3.  [向 ASP.NET MVC 框架添加 Ajax 支持](http://www.infoq.com/news/2007/12/ajax-aspnet-mvc)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-27T11:50:26.753

有关如何使用 AJAX for ASP.NET MVC 来完成此操作的说明，[请参阅这篇文章。](http://www.techtribe.com/viewBlogEntry.html?blogEntryId=693a3f1a-47bd-102b-9fc2-000f1f68a9bf)

如果您可以自己控制服务，并且如果可能的话，您可以考虑通过 WebHttpBinding 和 WCF 将其公开为类似 REST 的接口。然后使用 jQuery 查询服务。

# java - 在 JSTL 中将字符串转换为标题大小写

> ID：482925
> 
> 赞同：11
> 
> 时间：2009-01-27T10:41:47.283
> 
> 标签：java, string, jstl

有没有办法使用 JSTL 标签将字符串转换为标题大小写？

提前致谢。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-01-27T13:52:02.937

在服务器上转换字符串的另一种方法是[让 CSS 完成工作](http://www.w3.org/TR/CSS2/text.html#caps-prop)：

```
text-transform: capitalize 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-01-27T10:51:13.877

一个想法：

在一个类中，创建一个使用来自 Apache Commons Lang 的 WordUtils 的简单方法，该方法将操纵您的字符串：

```
import org.apache.commons.lang.WordUtils;

...

public static String titleCase(String input){
   return WordUtils.capitalize(input);;
} 
```

现在，创建您自己的标签（在 function.tld 中）：

```
<?xml version="1.0" encoding="UTF-8" ?>
<taglib xmlns="http://java.sun.com/xml/ns/j2ee"
  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xsi:schemaLocation="http://java.sun.com/xml/ns/j2ee http://java.sun.com/xml/ns/j2ee/web-jsptaglibrary_2_0.xsd"
  version="2.0">
  <description>functions library</description>
  <display-name>functions</display-name>
  <tlib-version>1.1</tlib-version>
  <short-name>xfn</short-name>
  <uri>http://yourdomain/functions.tld</uri>
  <function>
    <description>
      Title case a String
    </description>
    <name>titleCase</name>
    <function-class>Functions</function-class>
    <function-signature>java.lang.String titleCase(java.lang.String)</function-signature>
    <example>
      ${xfn:titleCase(string)}
    </example>
  </function>
</taglib> 
```

ps：我从[这篇文章](https://stackoverflow.com/questions/74248/in-jstl-jsp-given-a-java-util-date-how-do-i-find-the-next-day)中得到了很大的启发来给出我的答案。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2010-08-10T19:21:34.510

在 JSTL 中并不太难...

```
${fn:toUpperCase(fn:substring(user.firstName, 0, 1))}${fn:toLowerCase(fn:substring(user.firstName, 1, -1))} 
```

# .net - Windows窗体：如何获取列表框中项目的实际宽度

> ID：482926
> 
> 赞同：1
> 
> 时间：2009-01-27T10:41:50.027
> 
> 标签：.net, winforms, listbox

为了确保列表框项目中的文本不会被截断，我想将其宽度调整为文本最长的项目的宽度。

有没有办法获得基于项目文本的列表框项目的“实际”宽度。

ListBox.GetItemRectangle 似乎没有返回这个实际宽度。

谢谢你。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-27T10:51:20.913

MeasureString 方法：（从 msdn 复制粘贴）

```
Graphics g = control.CreateGraphics();
int width = (int)g.MeasureString(aString, control.Font).Width;
g.dispose(); 
```

将文本框的宽度（左侧和右侧）添加到值

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-27T10:48:29.033

查看[MeasureString](http://msdn.microsoft.com/en-us/library/6xe5hazb.aspx)方法。

# performance - ActionScript2 性能：迭代对象属性

> ID：482954
> 
> 赞同：0
> 
> 时间：2009-01-27T10:48:50.247
> 
> 标签：performance, actionscript, actionscript-2, iteration

迭代对象属性与迭代数组时是否会影响性能？

示例，使用对象：

```
var x:Object = {one: 1, two: 2, three: 3};
for (var s:String in x) {
 trace(x[s]);
} 
```

VS 使用数组

```
var a:Array = [1, 2, 3];
var len:Number = a.length;
for (var i:Number = 0; i < len; ++i) {
 trace(a[i]);
} 
```

那么 - 哪个更快，最重要的是什么因素？

IIRC，在某些 JavaScript 实现中，迭代对象属性的速度慢达 20 倍，但我无法为 ActionScript2 找到这样的测量值。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-27T22:32:17.393

我刚刚尝试了一个非常相似的测试，但只迭代了超过 200k 个元素，结果相反：

```
Task build-arr: 2221ms
Task iter-arr: 516ms

Task build-obj: 1410ms
Task iter-obj: 953ms 
```

我怀疑 Luke 的测试主要是循环开销，这在数组情况下似乎更大。另外，请注意，数组首先需要更长的时间来填充，所以如果您的任务是插入繁重的，那么 ymmv。

此外，在我的测试中，将 arr.length 存储在局部变量中可以显着提高大约 15% 的性能。

***更新：***

根据大众的需求，我发布了我使用的代码。

```
var iter:Number = 200000;
var time:Number = 0;
var obj:Object = {};
var arr:Array = [];

time = getTimer();
for (var i:Number = 0; i < iter; ++i) {
  arr[i] = i;
}
trace("Task build-arr: " + (getTimer() - time) + "ms");

time = getTimer();
for (var i:Number = 0; i < iter; ++i) {
  arr[i] = arr[i];
}
trace("Task iter-arr: " + (getTimer() - time) + "ms");

time = getTimer();
for (var i:Number = 0; i < iter; ++i) {
  obj[String(i)] = i;
}
trace("Task build-obj: " + (getTimer() - time) + "ms");

time = getTimer();
for (var i:String in obj) {
  obj[i] = obj[i];
}
trace("Task iter-obj: " + (getTimer() - time) + "ms"); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-27T21:11:06.887

好的。为什么不做一些简单的测量？

```
var time : Number;

time = getTimer();

var x:Object = {one: 1, two: 2, three: 3};

for( i = 0; i < 100000; i++ )
{
    for (var s:String in x) 
    {
        // lets not trace but do a simple assignment instead. 
        x[s] = x[s];
    }
}

trace( getTimer() - time + "ms");

time = getTimer();

var a:Array = [1, 2, 3];
var len:Number = a.length;

for( i = 0; i < 100000; i++ )
{
    for ( var j : Number = 0; j < len; j++) 
    {
        a[j] = a[j];
    }
}

trace( getTimer() - time + "ms"); 
```

在我的机器上，数组迭代有点慢。这可能是因为 ActionScript 2 没有“真实”数组，而只有关联数组（映射）。显然，要使用数组，编译器必须产生一些代码开销。我还没有研究过这个细节，但我可以想象这可能是这种情况。

顺便提一句。进行此测试还可能表明将数组长度值放入变量中也不会真正提高性能。放手吧....

更新：尽管 ActionScript 和 JavaScript 在语法上相关，但底层执行机制完全不同。例如，FireFox 使用[SpiderMonkey](http://www.mozilla.org/js/spidermonkey/)，而 IE 可能会使用 Microsoft 实现，而 AS2 由 Adob​​e 的 AVM1 执行。

# c# - 为什么从 Java 和 C# 中删除 constness？

> ID：482955
> 
> 赞同：12
> 
> 时间：2009-01-27T10:49:20.870
> 
> 标签：c#, java, c++, programming-languages, language-features

我知道这已经讨论过很多次了，但我不确定我是否真的理解*为什么*Java 和 C# 设计者选择从这些语言中省略这个特性。我对如何解决问题（使用接口、克隆或任何其他替代方法）不感兴趣，而是对决定背后的基本原理感兴趣。

*从语言设计的角度来看，为什么这个功能被拒绝了？*

PS：我使用了诸如“省略”之类的词，有些人可能会觉得这不够用，因为 C# 是按照加法（而不是减法）方法设计的。但是，我之所以使用这些词，是因为该功能在设计这些语言之前就存在于 C++ 中，因此在从程序员的工具箱中删除的意义上省略了它。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-01-27T10:58:20.837

在[这次](http://www.artima.com/intv/choicesP.html)采访中，安德斯说：

> 安德斯·海尔斯伯格：是的。关于 const，这很有趣，因为我们也经常听到这样的抱怨：“你为什么没有 const？” 问题中隐含的是，“为什么你没有运行时强制执行的 const ？” 这确实是人们在问的问题，尽管他们不会这样说。
> 
> const 在 C++ 中起作用的原因是你可以抛弃它。如果你不能把它扔掉，那么你的世界就会糟透了。如果你声明一个接受 const Bla 的方法，你可以传递一个非常量 Bla。但是如果反过来就不行了。如果您声明一个采用非常量 Bla 的方法，则不能将其传递给 const Bla。所以现在你被卡住了。所以你逐渐需要一个非 const 的东西的 const 版本，你最终会得到一个影子世界。在 C++ 中你可以摆脱它，因为与 C++ 中的任何东西一样，无论你是否想要这个检查都是完全可选的。如果你不喜欢它，你可以把它打掉。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-01-27T10:57:29.857

我想主要是因为：

*   即使在 C++ 中也无法正确执行它（您可以强制转换它）
*   底部的单个 const 可以强制调用树中的整个 const 链

两者都可能有问题。但尤其是第一个：如果不能保证，那有什么用？更好的选择可能是：

*   不可变类型（完全不可变或冰棒不可变）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-27T10:58:31.507

至于他们为什么这样做，相关人士是这么说的：

[http://blogs.msdn.com/ericgu/archive/2004/04/22/118238.aspx](http://blogs.msdn.com/ericgu/archive/2004/04/22/118238.aspx) [http://blogs.msdn.com/slippman/archive/2004/01/22/61712.aspx](http://blogs.msdn.com/slippman/archive/2004/01/22/61712.aspx) Raymond 也提到陈 [http://blogs.msdn.com/oldnewthing/archive/2004/04/27/121049.aspx](http://blogs.msdn.com/oldnewthing/archive/2004/04/27/121049.aspx)

在多语言系统中，这将非常复杂。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-27T11:11:56.380

至于Java，您将如何拥有这样的属性？已经有使对象不可变的技术，这可以说是实现这一目标的更好方法，并具有额外的好处。事实上，你可以通过声明一个只实现不改变状态的方法的超类/超接口，然后拥有一个实现变异方法的子类/子接口来模拟 const 行为。通过将可变类向上转换为没有写入方法的类实例，其他代码位无法修改对象，除非专门将其转换回可变版本（相当于丢弃`const`）。

即使您不希望对象是严格不可变的，如果您真的想要（我不推荐），您也可以在其上设置某种“锁定”模式，以便它只能在解锁时发生变异。让锁定/解锁方法是私有的，或者适当地受到保护，并且您可以在那里获得某种程度的访问控制。或者，如果您根本不打算使用将其作为参数的方法来修改它，请传入该对象的副本，或者如果复制整个对象过于繁重，那么其他一些仅包含必要的轻量级数据对象信息。您甚至可以使用动态代理来为您的对象创建一个代理，它将对突变方法的任何调用转换为无操作。

基本上已经有很多方法可以防止类被变异，这让您可以选择最适合您的情况的方法（提示：尽可能选择纯不变性，因为它使对象变得简单线程安全并且通常更容易推理）。对于如何`const`实现这些技术没有明显的语义，这将是对这些技术的改进，这将是另一回事，要么缺乏灵活性，要么灵活到无用。

也就是说，除非我错过了什么，这是完全可能的。:-)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-27T13:01:45.893

Java 有自己的 const 版本；最终的。Joshua Bloch 在其[Effective Java](https://rads.stackoverflow.com/amzn/click/com/0321356683)中描述了 如何有效地使用 final 关键字。（顺便说一句，const 是 Java 中的保留关键字，以备将来出现差异）

# iphone - QuartzCore.framework 问题

> ID：482963
> 
> 赞同：2
> 
> 时间：2009-01-27T10:51:27.700
> 
> 标签：iphone, objective-c, cocoa-touch, cocos2d-iphone, quartz-graphics

我正在尝试使用 QuartzCore 框架，但是在将这个框架添加到我的 iPhone 应用程序时，我被告知文件（例如 CIColor.h 和其他文件）丢失了，但这些丢失的文件存在于我的硬盘驱动器下的 /system/library/

除了 QuartzCore Frame 工作之外，我还在使用以下框架：cocos2d、cocoa.framework、openGLES.framework、openAL.framework、foundation.framework、UIKit.framework 和 APPKit 框架。

有什么想法可能是错的吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-27T15:29:26.377

您包含错误的框架。iPhone 框架位于

/Developer/Platforms/iPhoneOS.platform/Developer/SDKs/iPhoneOS2.x.sdk/System/Library/Frameworks

请注意，CoreImage 类（包括 CIColor）不包含在 iPhone 的 QuartzCore 框架中。

# inheritance - C# - 构造函数和继承

> ID：482971
> 
> 赞同：3
> 
> 时间：2009-01-27T10:55:21.467
> 
> 标签：inheritance, c#-3.0, constructor

我有两个这样声明的类：

```
class Object1
{
    protected ulong guid;
    protected uint type;

    public Object1(ulong Guid, uint Type)
    {
        this.guid = Guid;
        this.type = Type
    }
    // other details omitted
}

class Object2 : Object1
{
    // details omitted
} 
```

在客户端代码中，我希望能够像这样创建每个对象的实例：

```
Object1 MyObject1 = new Object1(123456789, 555);
Object2 MyObject2 = new Object2(987654321, 111); 
```

我怎样才能让 Object2 像这样使用 Object1 的构造函数？谢谢你。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-01-27T10:57:09.233

```
class Object2 : Object1
{
   Object2(ulong l, uint i ) : base (l, i)
   {
   }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-27T10:58:25.797

您必须为 Object2 提供具有相同签名的构造函数，然后调用基类的构造函数：

```
class Object2 : Object1
{
    public Object2(ulong Guid, uint Type) : base(Guid, Type) {}
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-27T10:59:03.440

给 Object2 一个这样的构造函数：-

```
public Object2(ulong Guid, uint Type): base(Guid, Type) 
```

# php - 在 PHP 中提供数字产品下载的最佳方式是什么？

> ID：482972
> 
> 赞同：3
> 
> 时间：2009-01-27T10:55:23.807
> 
> 标签：php, download

客户为下载链接付费的数字商业产品。

我已将所有压缩文件（产品）放在网络文档根目录之外，买家通过与 paypal IPN 集成的 php 脚本下载它们，以确保下载者是付费买家。

有点像：[http ://www.mysite.com/download.php?buyer_id=xxx](http://www.mysite.com/download.php?buyer_id=xxx)

到目前为止，这一切都只解决一个问题。我通过上述 URL 下载的 zip 文件已损坏，无法使用 WinRAR 正确打开。但是，直接下载 zip 就可以了。

我的代码：

```
$path = WAREHOUSE_PATH.'/products/'.$identifier.'.zip';
$mm_type="application/octet-stream";
header("Pragma: public");
header("Expires: 0");
header("Cache-Control: must-revalidate, post-check=0, pre-check=0");
header("Cache-Control: public");
header("Content-Description: File Transfer");
header("Content-Type: " . $mm_type);
header("Content-Length: " .(string)(filesize($path)) );
header('Content-Disposition: attachment; filename="'.basename($path).'"');
header("Content-Transfer-Encoding: binary\n");

$fp = @fopen($path,"rb");
if ($fp) {
  while(!feof($fp)) {
    print(fread($fp, 1024*8));
    flush();
    if (connection_status()!=0) {
      @fclose($fp);
      die();
    }
  }
  @fclose($fp);
} 
```

有什么问题？谢谢！

问题已解决：谢谢大家的提示。事实证明，下载的软件包包含一些不应该存在的额外空白。愚蠢的。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-27T11:00:15.653

我建议改变这个：

```
$fp = @fopen($path,"rb");
if ($fp) {
  while(!feof($fp)) {
    print(fread($fp, 1024*8));
    flush();
    if (connection_status()!=0) {
      @fclose($fp);
      die();
    }
  }
  @fclose($fp);
} 
```

对此

```
readfile($path); 
```

[您可以在此处](http://php.net/readfile)找到有关 readfile 的更多信息，但基本上它会完成您的循环所做的一切。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-27T10:59:17.107

您的 Content-Transfer-Encoding 标头有一个额外的换行符 - 也许这会导致最后一个标头和正文之间有三个换行符？

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-27T11:01:25.637

你最好只使用[`readfile()`](http://www.php.net/readfile). 除非您打开了 ignore_user_abort，否则如果用户取消，脚本将自动终止。

如果您仍然遇到问题，请在十六进制编辑器中加载文件并比较前几个字符和最后几个字符。

# c# - 如何更新 XML 节点？

> ID：482986
> 
> 赞同：3
> 
> 时间：2009-01-27T11:00:30.053
> 
> 标签：c#, asp.net, xml

读取 XML 文件并获得准确的节点文本很容易，但是如何使用新值更新该节点？

读书：

```
public static String GetSettings(SettingsType type, SectionType section)
{
    XmlTextReader reader = new XmlTextReader(HttpContext.Current.Request.MapPath(APPSETTINGSPATH));
    XmlDocument document = new XmlDocument();
    document.Load(reader);

    XmlNode node = document.SelectSingleNode(
                        String.Format("/MyRootName/MySubNode/{0}/{1}",
                        Enum.Parse(typeof(SettingsType), type.ToString()),
                        Enum.Parse(typeof(SectionType), section.ToString())));       
    return node.InnerText;
} 
```

来写 ...？

```
public static void SetSettings(SettingsType type, SectionType section, String value)
{
    try
    {
        XmlTextReader reader = new XmlTextReader(HttpContext.Current.Request.MapPath(APPSETTINGSPATH));
        XmlDocument document = new XmlDocument();
        document.Load(reader);

        XmlNode node = document.SelectSingleNode(
                            String.Format("/MyRootName/MySubNode/{0}/{1}",
                            Enum.Parse(typeof(SettingsType), type.ToString()),
                            Enum.Parse(typeof(SectionType), section.ToString())));
        node.InnerText = value;
        node.Update();
    }
    catch (Exception ex)
    {
        throw new Exception("Error:", ex);
    }
} 
```

**注意**这一行，node.Update(); 不存在，但这就是我想要的:)

我看到了 XmlTextWriter 对象，但它会将整个 XML 写入一个新文件，我只需要更新原始 Node 中的一个值，我可以另存为新文件，然后将新文件重命名为原始名称但是。 ..这样做必须更简单吗？

你们中的任何人都有一个示例代码来执行此操作吗？

谢谢

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-27T11:06:32.380

您不需要“更新”方法 - 设置 InnerText 属性会更新它。但是，它仅在内存中应用更新。不过，您*确实*需要重写整个文件 - 您不能只更新其中的一小部分（至少，不是没有*大量*工作，也没有开箱即用的支持）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-27T11:04:16.863

`XmlDocument.Load`有一个重载，将直接采用文件名，因此不需要阅读器。

同样，当您完成后，`XmlDocument.Save`将获取一个文件名，它将保存文档。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2010-07-26T18:42:47.133

nodeValue 属性可用于更改文本节点的值。

以下代码更改第一个元素的文本节点值： 示例：

```
xmlDoc=loadXMLDoc("books.xml");

x=xmlDoc.getElementsByTagName("title")[0].childNodes[0];
x.nodeValue="Easy Cooking"; 
```

来源：[http ://www.w3schools.com/DOM/dom_nodes_set.asp](http://www.w3schools.com/DOM/dom_nodes_set.asp)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-27T11:07:18.603

您正在更新xml 文档*的内存*表示中的节点，AFAIK 无法直接在物理文件中更新节点。您必须将其全部转储回文件。****