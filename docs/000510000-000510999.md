# StackOverflow 问答 000510000-000510999

# java - 在两个用户之间交换屏幕

> ID：510000
> 
> 赞同：1
> 
> 时间：2009-02-04T03:53:37.423
> 
> 标签：java, hibernate, jboss, struts

我们有一个带有技术堆栈的基于 Web 的应用程序 - 1\. 基于 Java Struts 2\. Hibernate 3\. DB - Oracle 4\. App 服务器 - JBoss 服务器

我们正面临与两个或更多用户同时使用应用程序相关的问题。当我正在执行操作并提交更改时，出现的下一页或成功消息是另一个用户同时执行的不同操作。

用户以不同的用户身份登录，因此使用不同的会话。

我们不知道问题出在哪里，所以我不确定我可以提供哪些其他细节。

有没有其他人遇到过这样的问题或任何指示？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-04T04:09:25.817

您是否使用应用程序上下文而不是会话上下文？此外，正如 Eed3si9n 所说，提防单例，这可能是造成这种情况的原因。

“另外检查静态字段的使用。我被带入修复的一个应用程序使用静态字符串作为错误消息。一旦任何用户收到错误，他们都会这样做。工作正常，直到有多个并发用户。” ——**迈克尔·卢瑟福（作为评论发表）**

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-04T06:14:30.743

检查表单是否定义为应用程序范围以及您在屏幕上显示的消息是否来自该表单。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-04T04:07:11.407

我不熟悉您正在使用的特定库，但让我试试。

你的应用程序代码有多无状态？您是否有任何类型的全局状态，例如带有成员字段的单例？如果服务是有状态的并且使用单例，你可能会有这样的混淆。

# html - 基于 Flash 的网站有什么邪恶之处？

> ID：510010
> 
> 赞同：74
> 
> 时间：2009-02-04T03:57:15.700
> 
> 标签：html, flash, silverlight

我觉得基于[Flash](http://en.wikipedia.org/wiki/Adobe_Flash)（或基于[Silverlight](http://en.wikipedia.org/wiki/Microsoft_Silverlight)）的网站通常不受欢迎，除非您正在创建游戏或多媒体内容丰富的应用程序。为什么会这样？

* * *

## 回答 #1

> 赞同：143
> 
> 时间：2009-02-04T03:59:50.033

Flash 因其较差的可访问性而臭名昭著。

键盘导航通常不起作用，而且 Flash（直到最近）还没有搜索引擎支持。

Flash 应用程序不适用于手机和其他便携式设备。

iPhone中没有Flash！

Flash 由一家公司 (Adobe) 控制，因此它没有遵循任何明确定义的 Internet 标准。

Internet 的美妙之处在于您可以随时查看您所在的任何网站的源代码。这样您就可以在您的网站中使用相同的编程/设计技术，或者您可以发现 Web 应用程序中的安全漏洞。这在 Flash 中是不可能的。在 Flash 中，源代码是关闭的。

最大的问题是，“除了在创建游戏或多媒体内容丰富的应用程序时”为什么要使用 Flash？

> [jtyost2](https://stackoverflow.com/users/657/jtyost2)说：“我还要补充一点，您不能直接链接到 Flash 站点内的任何内容，从而破坏了构成 Internet、Internet、链接的主要因素之一。”

* * *

## 回答 #2

> 赞同：42
> 
> 时间：2009-02-04T04:00:02.933

1.  内容权重
2.  可用性
3.  搜索引擎机器人的可抓取性
4.  可访问性
5.  易用性（有争议）
6.  技术负担（访问网站所需的附加软件）
7.  安全问题（需要添加软件会带来与安装或运行该软件/内容播放器有关的问题）

**[编辑]**为什么我将可用性和易用性分开在[这个链接中得到了最好的解释](http://www.wqusability.com/articles/more-than-ease-of-use.html)

> 可用性：
> 
> *   结果——可用的软件；
> *   用于创建可用软件的过程，也称为以用户为中心的设计；
> *   用于实现该结果的一组技术，例如上下文观察和可用性测试；或者
> *   满足用户需求的设计理念？
> 
> 便于使用：
> 
> *   有效的
> *   高效的
> *   引人入胜
> *   容错
> *   简单易学

我同意该网站上的评论，但这都是有争议的......可能是一个很好的stackoverflow问题：可用性和易用性是否相同？IMO可用性的*一部分*是易用性，反之亦然，但它们不一定相同。

我希望我不会因为这个编辑而激怒对语义更敏感的人:-)

* * *

## 回答 #3

> 赞同：36
> 
> 时间：2009-02-05T03:46:06.673

有趣的是，这里的每个人都在抨击 Flash/Silverlight，您最好认识到这只是硬币的一方面。

Flash（和[Flex](http://en.wikipedia.org/wiki/Adobe_Flex)）允许网站设计者为他们的网站提供更大的灵活性和更丰富的内容，这适用于各种情况 - 例如与电影或乐队有关的网站、儿童网站、游戏网站等。

[当然，不选择 Flash/Flex/ Silverlight](http://en.wikipedia.org/wiki/Microsoft_Silverlight)的原因有很多，但如今人们可以做的网站与 JavaScript 中无法访问的网站一样。我以前曾使用过对盲人或网络爬虫没有合理可用性的 JavaScript 产品。

Flash 渗透率（肯定来自有偏见的来源）是 99%+（[http://www.adobe.com/products/player_census/flashplayer/version_penetration.html](http://www.adobe.com/products/player_census/flashplayer/version_penetration.html)），这意味着那些说“永远不会访问 Flash 网站的人” ” 属于 1% 的不安装 Flash、不在线观看 YouTube 或电影预告片的人群。

所以，你需要注意你的听众。对于某些受众和情况，使用纯 HTML 页面和最少的 JavaScript 肯定会更好（政府网站、编程网站是我想到的两个领域）。其他时候是因为观众是不允许在浏览器中安装 Flash 的上班族。

富 Internet 应用程序 (RIA) 是 Fl​​ex/Silverlight 和 JavaScript/CSS/HTML 方面之间存在明显冲突/斗争的一个领域。我已经使用过这两个插件，我现在认为需要 Flex/Silverlight 插件是相当合理的，但如果应用程序是公开的，您仍然可能会失去一些访问者。

总而言之-您最好确定您的受众，确定他们愿意/能够使用什么，然后根据这些限制决定您的技术。

* * *

## 回答 #4

> 赞同：23
> 
> 时间：2009-02-04T04:27:38.353

基于 Flash 和 Silverlight 的站点的封闭模型通常违反基本的 Internet 惯例。

例如，大多数基于 Flash 和 Silverlight 的网站：

*   忽略后退/前进按钮。
*   不允许您向任何人发送指向网站特定位置的 URL，或通过浏览器为特定位置添加书签以供日后使用
*   将互联网放在一个固定大小的盒子里。对于更宽的显示器或更高的分辨率，没有动态调整大小。

* * *

## 回答 #5

> 赞同：12
> 
> 时间：2009-02-04T23:20:36.617

“我正要点击结帐，但我想改变一些东西，所以我点击了后退按钮”

* * *

## 回答 #6

> 赞同：11
> 
> 时间：2009-02-04T04:40:55.987

在接下来的咆哮中 s/Flash/Flash 或 Silverlight/g

1.  Flash 应用程序/插件是一个封闭源代码的罐子，其中包含严重的未公开安全漏洞，这些漏洞会暴露私人数据，允许修改硬盘上的任意文件等。
2.  Flash 文件对于基本内容来说是巨大的。有更有效的做事方式
3.  闪光灯很慢。我的 Windows PC 上的插件可以占用 100% 的 CPU 时间来播放一些糟糕的网站。
4.  闪光灯是非标准的。到处都没有安装受支持的 Flash 插件。Linux 用户无法在不跳过包管理的情况下运行它。默认情况下，Windows 上的 Firefox 用户不会得到它（好吧，我上次没有检查过）。
5.  Flash很烦人；您的用户不希望仅仅为了获取一些基本信息而被动画、广告歌曲和垃圾内容轰炸。
6.  没有后退/前进功能，除非 Flash 设计者想在
7.  如果不等待构成该“页面”的所有内容/脚本加载，则无法查看单个页面。如果你的用户想要的只是一段文本，而你强迫多媒体进入他们的喉咙，那真的很痛苦。
8.  大多数只有 Flash 的网站都非常糟糕。设计师似乎更关心使用闪存引擎的所有功能，而不是向用户展示简洁有用的东西。

* * *

## 回答 #7

> 赞同：10
> 
> 时间：2009-07-31T14:38:57.993

我是一名 Flash 开发人员。我工作的公司很容易找到希望我们为他们构建基于 Flash 的产品的客户。有一组应用程序在 Flash 中开发比在我使用的其他环境中容易得多。

但是Flash有它的问题。上面的一些人抱怨 Flash 应用程序不包括键盘支持。其他人说这是因为开发人员懒得实现它。事实上，许多 Flash 标配的组件都是有缺陷的。在我的公司，我们不得不编写自己的替代品。有问题的一项功能是键盘支持。我实现了自己对键盘交互的支持。它运作良好，但需要付出努力。如果我正在编写一个 Windows VB 应用程序，将提供键盘导航，并且开箱即用。

深度链接、后退按钮支持等也是如此。聪明的开发人员将能够使 Flash 应用程序表现良好。一些开源库在这里是不可缺少的。

至于流动布局，我也刚刚完成了一个概念验证（在 AS3 中）。这是可能的，但需要付出很多努力。我为什么要努力？因为Flash做得很好的其他事情。

* * *

## 回答 #8

> 赞同：10
> 
> 时间：2009-09-16T11:19:14.570

我对 Flash 最大的不满是它把你“从浏览器中”带到了它自己完全独立的应用程序中。这打破了“浏览器标准”——即我可以在浏览器中执行的功能：

*   右键点击
*   中键（用于在其他选项卡中打开链接）
*   选择文本
*   复制粘贴
*   印刷
*   键盘快捷键（因为 Flash 会窃取键盘焦点）
*   后退/前进按钮和整个“页面”概念
*   Javascript 与页面上其他元素的交互（我认为这是不可能的）。
*   Firebug 或 Chrome 中的“检查元素”，如果我想查看 Flash 文件特定部分的来源，或者查找正在使用的图像。

* * *

## 回答 #9

> 赞同：9
> 
> 时间：2009-02-06T02:58:11.060

Flash 有它的用途。它适用于内容，而不是网页。

* * *

## 回答 #10

> 赞同：7
> 
> 时间：2009-02-04T04:10:57.967

我认为这是选择成本最低的媒体来接触目标受众的问题，无论是 Flash、Silverlight、JavaScript 还是纯文本。

如果您有钱，您可以拥有纯文本、纯 JavaScript 等版本的网站，并且您的目标受众具有不同的优先级。

所以我要问你的问题是：你的网站是否有不喜欢 Flash 的人作为其目标受众？如果是，你需要远离它。如果没有，请使用任何方法为您的访问者提供良好的体验。

* * *

## 回答 #11

> 赞同：7
> 
> 时间：2009-08-18T12:13:26.977

打印通常得不到很好的支持，并且后退按钮不起作用。

* * *

## 回答 #12

> 赞同：7
> 
> 时间：2010-04-30T06:50:49.337

请参阅史蒂夫乔布斯关于 Flash 的想法：http: [//www.apple.com/hotnews/thoughts-on-flash/](http://www.apple.com/hotnews/thoughts-on-flash/)

* * *

## 回答 #13

> 赞同：6
> 
> 时间：2009-02-06T02:40:50.640

有人知道一个叫**YouTube**的网站吗？没有闪光灯就不会存在。Flash 具有不可忽视的出色视频/多媒体功能。

当以正确的方式、在适当的情况下以及当设计人员/编码人员注意嵌入基本的可访问性功能时，Flash 是惊人的。

问题是，就像所有好东西一样，有很多滥用行为（flashturbation）。尤其是在刚开始的时候，人们只是想在任何可以炫耀的地方拍Flash。

但我强烈反对 Flash 网站不好：如果制作得当，并具有良好的 UI 设计和可访问性，它们会给网络带来全新的维度。

* * *

## 回答 #14

> 赞同：5
> 
> 时间：2009-02-04T07:50:00.957

SEO是首要问题。仍然 Flash 不可抓取。但 Adob​​e 正在努力。[http://www.adobe.com/devnet/flashplayer/articles/swf_searchability.html](http://www.adobe.com/devnet/flashplayer/articles/swf_searchability.html)以获得更好的 swf 索引。

* * *

## 回答 #15

> 赞同：5
> 
> 时间：2009-02-05T11:06:07.470

让我们不要忘记，**Flash**允许网站显示视频、动画、用户交互等，它允许这成为一个简单的过程或一个极客的技术人员，这取决于你想要做什么。许多糟糕的 Flash 网站都归咎于作者。

如果您不喜欢 Flash，那么答案很简单，不要使用它。请勿安装 Flash 插件，或在 Firefox 上安装[Flashblock等浏览器插件。](http://en.wikipedia.org/wiki/Flashblock)这将使用播放按钮替换任何 Flash 电影，阻止并下载，直到它被单击。

比这更好的是，如果您不喜欢 Adob​​e 或 Microsoft 给您的解决方案，那么想出一个更好的解决方案，或者至少让他们知道您不喜欢什么，他们会认真对待反馈。支持一些为 Flash 中的可访问性改进而运动的人，例如访问[http://niquimerret.com](http://niquimerret.com)。

可访问性是一个持续存在的问题，并且不会消失，Flash 可访问性正在为身体残疾的人改善。在某些情况下，使用 Flash 可以增强有认知和学习障碍的人的体验，当一个概念或想法以动画而不是一页文字和静态图像呈现时可以更好地解释。

* * *

## 回答 #16

> 赞同：3
> 
> 时间：2009-02-04T04:39:18.173

Flash 添加了正确查看网页所需的另一个重量级组件。Flash 插件通常有问题，可能会使浏览器崩溃。Flash 页面通常用于制作可爱的动画和其他使快速浏览网站变得更加困难的东西。

* * *

## 回答 #17

> 赞同：3
> 
> 时间：2009-02-06T02:46:06.963

以上所有内容都适用于野生网络。

但是，对于内部业务应用程序，Flash 和 Silverlight 允许用户在其浏览器中拥有接近成熟应用程序的东西。可访问性、SEO 和封闭源代码在内部应用程序中并不是很重要。重要的是让用户的生活更轻松。

* * *

## 回答 #18

> 赞同：2
> 
> 时间：2009-02-05T09:39:36.647

为了辩护，这里提出的大多数问题都是关于人们如何在他们的网站中实施 Flash，而不是关于 Flash 本身。Flash 确实支持可访问性，只是大多数人在构建网站时没有考虑到它。Flash 确实可以在手机上运行 - 它是[Flash Lite](http://en.wikipedia.org/wiki/Adobe_Flash_Lite)，尽管[ActionScript](http://en.wikipedia.org/wiki/ActionScript)在早期版本中受到限制。

为什么任何人都应该自动拥有查看网站源代码的权利？一位网络作者花费了时间和精力来构思他们的代码，以便通过网络媒体分享他们的想法。如果你想知道某件事是如何运作的，为什么不自己付出一点努力，然后解决它呢？网络的美妙之处在于信息，而不是媒介。

那么，如果 Flash 归一家公司所有怎么办——Adobe 购买它是有原因的，那是因为它是一个很棒的工具包。问题来自网络作者没有正确使用它，试图让它做它从未打算做的事情，或者只是在使用 Flash 开发时没有将标准应用于他们的网站。

基于 Flash 的网站有什么邪恶之处？绝对没有。这就像问一把枪有什么邪恶之处。没有。有问题的是挥舞它的白痴。

* * *

## 回答 #19

> 赞同：2
> 
> 时间：2009-08-18T12:07:20.510

我是一名 Flash 开发人员。我发现虽然 Flash 在编码方面需要更多的努力，但潜力是巨大的。您可以创建带有简单过渡的非常简单的网站，如此微妙，看起来就像是一个普通的 HTML 页面，同时仍然很轻。

同时，您可以将 OOP 与 ActionScript 结合使用来创建一个既复杂又具有包容性的网站，并且在感觉和行为上都像桌面应用程序一样。同时也很轻！（仅按需加载所需的内容，与包含太多信息的 4 列 HTML 站点相反。）

如今，这仍然没有迁移到 ActionScript 3，但仍然使用 ActionScript 2，我的 flash 文件仅包含 2 或 3 行 ActionScript，只有一帧和一个空的舞台。其他一切都是在运行时动态创建或添加的。

Flash 的问题不在于 Flash，而在于懒惰的开发。

* * *

## 回答 #20

> 赞同：2
> 
> 时间：2009-08-18T12:09:53.080

我不喜欢基于 Flash 的网站，因为如果您的浏览器崩溃或您的连接暂时中断，会发生什么情况？您必须再次加载它并返回菜单，然后选择您想要阅读的项目，依此类推。

只是不要这样做。:S

* * *

## 回答 #21

> 赞同：2
> 
> 时间：2009-08-18T17:55:09.863

可能出于同样的原因，C 程序员回避 Win32 API、Win32 程序员回避 MFC 和 MFC 程序员回避 Windows 窗体。使用和理解起来很棘手 - 我已经尝试过在 Flex 中编程并且相处得很好，但它本身并不是为典型的 Web 应用程序设计而设计的，例如，没有对数据库或 cookie 或会话的本机（至少在 Flex 3 之前）支持 -您需要将所有 3 个放在 PHP 或另一个服务器端页面中，然后从[ActionScript调用](http://en.wikipedia.org/wiki/ActionScript)*它*。

尝试使用 PHP 制作一个简单的注册/登录页面，然后再次使用 Flex/Flash，您会看到所有服务器端的处理都是由其他人完成的 - 同样，这可能是设计使然，因为我们前面有 HTML/JavaScript -与 ColdFusion 或 PHP 等混合用于“传统”Web 应用程序的后端。

就像其他人开始的一样，Flash 在键盘上很糟糕 - 当嵌入在 HTML 页面中的 Flash 对象具有焦点（鼠标悬停）时，尝试在 Firefox 中按 Ctrl-T - 这可能会让用户感到沮丧......

说了这么多，我还是宁愿用 Flash/Flex 做一个 Web 应用程序前端，而不是 HTML/JavaScript/CSS，因为后者需要一个尖锐的学习曲线，一段时间后会变得相当令人困惑，因为你必须考虑“好“ CSS 和 JavaScript 的设计方面以及不好的方面 - 以及 JavaScript/CSS 固有的缺陷以及 JavaScript 库供应商（雅虎的[YUI](http://en.wikipedia.org/wiki/Yahoo!_UI_Library)、谷歌的 Ajax API、[script.aculo.us](http://en.wikipedia.org/wiki/Script.aculo.us)等）引入的缺陷。

如果您已经是一名非常了解 CSS/HTML/JavaScript 的 Web 程序员，并且在您的 PC 上设置了一个良好的开发环境，其中包含所有必需的代码检查器和运行时调试器等，那么继续在这方面工作很容易（不是考虑到最终用户的偏好），但是如果您像我一样想要快速准备好 Web 应用程序并可供使用，并且想要快速添加功能同时使其始终保持美观，那么 Flash/Flex 会更好选项，恕我直言。

* * *

## 回答 #22

> 赞同：2
> 
> 时间：2009-10-18T18:39:50.550

我没有在我的浏览器上安装 Flash，主要是为了逃避动画广告的滋扰，但也出于其他人提到的所有安全和隐私原因。

因此，就我而言，完全在 Flash 中完成的网站是不存在的。（Wrt Youtube，我将视频直接下载到 Miro。）

* * *

## 回答 #23

> 赞同：1
> 
> 时间：2009-02-04T04:04:48.837

Flash 很糟糕，我拒绝访问基于 Flash 的网站。为什么？因为我做不到。为什么？因为 Adob​​e 太[无知](http://www.adobe.com/go/6b3af6c9)了，不会为 64 位浏览器编写插件。

* * *

## 回答 #24

> 赞同：1
> 
> 时间：2009-02-04T04:17:04.443

以上所有答案都集中在Flash上​​，Silverlight同样糟糕或更糟。如果您使用[NoScript](http://en.wikipedia.org/wiki/NoScript)运行 Firefox （您应该这样做），那么您必须单击您希望允许运行的每个脚本。

因此，使用脚本、Flash 和 Silverlight 构建您的网站。只要确保他们仍然与他们一起工作被禁用。当我们打开一个网站却什么也看不到时，我们中的许多人只会继续前进。

* * *

## 回答 #25

> 赞同：1
> 
> 时间：2009-07-31T16:16:12.907

看看任何主要汽车制造商的网站，它们都在 Flash 中。这取决于你在做什么。如果您的目标是提供一个丰富、性感的网站，Flash/Silverlight 将在开发时间方面为您提供巨大的优势。如果您提供内容/数据 HTML 和 JavaScript（例如 jQuery）可以为您提供很多 whizbang，而无需额外的软件插件（Flash/Silverlight）。

* * *

## 回答 #26

> 赞同：1
> 
> 时间：2010-01-08T23:05:53.300

Flash Player 是导致更多 Mac OS X 崩溃的罪魁祸首。它的稳定性并不是众所周知的。

* * *

## 回答 #27

> 赞同：1
> 
> 时间：2010-01-30T10:13:58.250

我们中的许多人在基于 Flash 的网站上都有过不好的经历，这些网站传播了 Flash 是“邪恶”的想法。我真的不认为将邪恶的标签应用于任何技术或框架是公平的，它们每个都是为了迎合特定场景而设计的，其中许多在这些场景中表现良好，例如，我对使用的网站没有问题闪视频。

其他一些回应涉及到 Flash 的使用与我们在互联网上使用的许多标准隐喻（例如链接和导航按钮）相矛盾的事实，我和下一个网络用户一样讨厌这个，但这并没有真正使闪邪也。

虽然有人说 Flash/Flex 中有一些机制可以添加对这些东西的支持，但根据我的经验，这些机制很少实现，这不是 Flash 本身的直接错误，但对用户来说非常烦人。

也许邪恶不是 Flash/Flex，而是 Adob​​e 没有让开发人员更容易或更容易看到这些东西。

郑重声明，我从未在 Flash 中开发过

* * *

## 回答 #28

> 赞同：0
> 
> 时间：2010-02-01T03:11:53.580

Flash 并不邪恶，人们用它做的事情才是邪恶的。

对于愚蠢的矢量动画，甚至可能是 360 度产品视图或交互式图表，是的。Flash 可以使用 ~15 % cpu 在我的古老盒子上以 60 fps 的速度制作精美的全高清动画。

对于网络视频，如果你别无选择，我想。

但是对于整个网站和这些称为“RIA”的东西，没有。

令人震惊的是，一项技术更适合它的设计目标。

* * *

## 回答 #29

> 赞同：0
> 
> 时间：2014-05-28T16:06:10.497

Flash 是 Web 开发中要学习的另一种东西。不，谢谢！已经太多了。如果我可以在没有它的情况下完成我的工作，我就不需要它。

编程的报酬每天都在减少。

# mysql - 获取两个日期之间的日期列表

> ID：510012
> 
> 赞同：94
> 
> 时间：2009-02-04T03:58:00.647
> 
> 标签：mysql, sql, date, gaps-and-islands

使用标准 mysql 函数有一种方法可以编写一个查询，该查询将返回两个日期之间的天数列表。

例如，给定 2009-01-01 和 2009-01-13 它将返回一个包含值的单列表：

```
 2009-01-01 
 2009-01-02 
 2009-01-03
 2009-01-04 
 2009-01-05
 2009-01-06
 2009-01-07
 2009-01-08 
 2009-01-09
 2009-01-10
 2009-01-11
 2009-01-12
 2009-01-13 
```

编辑：看来我还不清楚。我想生成这个列表。我有存储在数据库中的值（按日期时间），但希望它们在左外连接上聚合到上面的日期列表（我希望这些连接的右侧有几天为空，并将处理这个）。

* * *

## 回答 #1

> 赞同：69
> 
> 时间：2009-02-04T06:02:57.100

我将使用此存储过程将您需要的时间间隔生成到名为**time_intervals**的临时表中，然后将您的数据表与临时**time_intervals**表连接并聚合。

该过程可以生成您在其中指定的所有不同类型的间隔：

```
call make_intervals('2009-01-01 00:00:00','2009-01-10 00:00:00',1,'DAY')
.
select * from time_intervals  
.
interval_start      interval_end        
------------------- ------------------- 
2009-01-01 00:00:00 2009-01-01 23:59:59 
2009-01-02 00:00:00 2009-01-02 23:59:59 
2009-01-03 00:00:00 2009-01-03 23:59:59 
2009-01-04 00:00:00 2009-01-04 23:59:59 
2009-01-05 00:00:00 2009-01-05 23:59:59 
2009-01-06 00:00:00 2009-01-06 23:59:59 
2009-01-07 00:00:00 2009-01-07 23:59:59 
2009-01-08 00:00:00 2009-01-08 23:59:59 
2009-01-09 00:00:00 2009-01-09 23:59:59 
.
call make_intervals('2009-01-01 00:00:00','2009-01-01 02:00:00',10,'MINUTE')
. 
select * from time_intervals
.  
interval_start      interval_end        
------------------- ------------------- 
2009-01-01 00:00:00 2009-01-01 00:09:59 
2009-01-01 00:10:00 2009-01-01 00:19:59 
2009-01-01 00:20:00 2009-01-01 00:29:59 
2009-01-01 00:30:00 2009-01-01 00:39:59 
2009-01-01 00:40:00 2009-01-01 00:49:59 
2009-01-01 00:50:00 2009-01-01 00:59:59 
2009-01-01 01:00:00 2009-01-01 01:09:59 
2009-01-01 01:10:00 2009-01-01 01:19:59 
2009-01-01 01:20:00 2009-01-01 01:29:59 
2009-01-01 01:30:00 2009-01-01 01:39:59 
2009-01-01 01:40:00 2009-01-01 01:49:59 
2009-01-01 01:50:00 2009-01-01 01:59:59 
.
I specified an interval_start and interval_end so you can aggregate the 
data timestamps with a "between interval_start and interval_end" type of JOIN.
.
Code for the proc:
.
-- drop procedure make_intervals
.
CREATE PROCEDURE make_intervals(startdate timestamp, enddate timestamp, intval integer, unitval varchar(10))
BEGIN
-- *************************************************************************
-- Procedure: make_intervals()
--    Author: Ron Savage
--      Date: 02/03/2009
--
-- Description:
-- This procedure creates a temporary table named time_intervals with the
-- interval_start and interval_end fields specifed from the startdate and
-- enddate arguments, at intervals of intval (unitval) size.
-- *************************************************************************
   declare thisDate timestamp;
   declare nextDate timestamp;
   set thisDate = startdate;

   -- *************************************************************************
   -- Drop / create the temp table
   -- *************************************************************************
   drop temporary table if exists time_intervals;
   create temporary table if not exists time_intervals
      (
      interval_start timestamp,
      interval_end timestamp
      );

   -- *************************************************************************
   -- Loop through the startdate adding each intval interval until enddate
   -- *************************************************************************
   repeat
      select
         case unitval
            when 'MICROSECOND' then timestampadd(MICROSECOND, intval, thisDate)
            when 'SECOND'      then timestampadd(SECOND, intval, thisDate)
            when 'MINUTE'      then timestampadd(MINUTE, intval, thisDate)
            when 'HOUR'        then timestampadd(HOUR, intval, thisDate)
            when 'DAY'         then timestampadd(DAY, intval, thisDate)
            when 'WEEK'        then timestampadd(WEEK, intval, thisDate)
            when 'MONTH'       then timestampadd(MONTH, intval, thisDate)
            when 'QUARTER'     then timestampadd(QUARTER, intval, thisDate)
            when 'YEAR'        then timestampadd(YEAR, intval, thisDate)
         end into nextDate;

      insert into time_intervals select thisDate, timestampadd(MICROSECOND, -1, nextDate);
      set thisDate = nextDate;
   until thisDate >= enddate
   end repeat;

 END; 
```

[这篇文章](https://stackoverflow.com/questions/373490/insert-dates-in-the-return-from-a-query-where-there-is-none/373734#373734)底部的类似示例数据场景，我为 SQL Server 构建了一个类似的函数。

* * *

## 回答 #2

> 赞同：30
> 
> 时间：2011-11-18T14:20:51.810

对于 MSSQL，您可以使用它。它非常快。

您可以将其包装在表值函数或存储过程中，并将开始和结束日期解析为变量。

```
DECLARE @startDate DATETIME
DECLARE @endDate DATETIME

SET @startDate = '2011-01-01'
SET @endDate = '2011-01-31';

WITH dates(Date) AS 
(
    SELECT @startdate as Date
    UNION ALL
    SELECT DATEADD(d,1,[Date])
    FROM dates 
    WHERE DATE < @enddate
)

SELECT Date
FROM dates
OPTION (MAXRECURSION 0)
GO 
```

**编辑 2021/01（V 博士）：** 我喜欢这个解决方案并使它适用于 mySQL V8。这是代码，将其包装到一个过程中：

```
DELIMITER //

CREATE PROCEDURE dates_between (IN from_date DATETIME,
                               IN to_date DATETIME) BEGIN
    WITH RECURSIVE dates(Date) AS
    (
        SELECT from_date as Date
        UNION ALL
        SELECT DATE_ADD(Date, INTERVAL 1 day) FROM dates WHERE Date < to_date
    )
    SELECT DATE(Date) FROM dates;
END//

DELIMITER ; 
```

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2009-02-04T05:10:05.397

您可以像这样使用 MySQL 的[用户变量](http://dev.mysql.com/doc/refman/5.1/en/user-variables.html)：

```
SET @num = -1;
SELECT DATE_ADD( '2009-01-01', interval @num := @num+1 day) AS date_sequence, 
your_table.* FROM your_table
WHERE your_table.other_column IS NOT NULL
HAVING DATE_ADD('2009-01-01', interval @num day) <= '2009-01-13' 
```

@num 是 -1，因为您在第一次使用它时添加了它。此外，您不能使用“HAVING date_sequence”，因为这会使用户变量每行增加两次。

* * *

## 回答 #4

> 赞同：14
> 
> 时间：2009-02-04T05:19:16.253

我们在 BIRT 报告中遇到了类似的问题，因为我们想报告那些没有数据的日子。由于这些日期没有条目，对我们来说最简单的解决方案是创建一个简单的表来存储所有日期并使用它来获取范围或连接以获取该日期的零值。

我们有一个每月运行的工作，以确保该表在未来 5 年内填充。该表是这样创建的：

```
create table all_dates (
    dt date primary key
); 
```

毫无疑问，使用不同的 DBMS 有一些神奇的棘手方法可以做到这一点，但我们总是选择最简单的解决方案。表的存储需求很小，它使查询变得更加简单和可移植。从性能的角度来看，这种解决方案几乎总是更好，因为它不需要对数据进行每行计算。

另一个选项（我们之前使用过）是确保每个日期的表中都有一个条目。我们定期扫描表格并为不存在的日期和/或时间添加零条目。在您的情况下，这可能不是一个选项，它取决于存储的数据。

如果您**真的**认为保留`all_dates`表格很麻烦，那么可以使用存储过程来返回包含这些日期的数据集。这几乎肯定会更慢，因为您必须在每次调用它时计算范围，而不是仅仅从表中提取预先计算的数据。

但是，老实说，您可以将表格填充 1000 年而不会出现任何严重的数据存储问题 - 365,000 个 16 字节（例如）日期加上复制日期的索引加上 20% 的安全开销，我粗略估计为大约 14M [365,000 * 16 * 2 * 1.2 = 14,016,000 字节]），这是事物计划中的一个小表格。

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2009-02-04T05:48:19.237

[从这个](https://stackoverflow.com/questions/273623/mysql-select-from-a-list-of-numbers-those-without-a-counterpart-in-the-id-field/273703#273703)答案中借用一个想法，您可以设置一个包含 0 到 9 的表格，并使用它来生成您的日期列表。

```
CREATE TABLE num (i int);
INSERT INTO num (i) VALUES (0), (1), (2), (3), (4), (5), (6), (7), (8), (9);

select adddate('2009-01-01', numlist.id) as `date` from
(SELECT n1.i + n10.i*10 + n100.i*100 AS id
   FROM num n1 cross join num as n10 cross join num as n100) as numlist
where adddate('2009-01-01', numlist.id) <= '2009-01-13'; 
```

这将允许您生成最多 1000 个日期的列表。如果需要更大，可以在内部查询中添加另一个交叉连接。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2019-02-05T16:27:37.520

在 MariaDB >= 10.3 和 MySQL >= 8.0 中使用新的递归（通用表表达式）功能的优雅解决方案。

```
WITH RECURSIVE t as (
    select '2019-01-01' as dt
  UNION
    SELECT DATE_ADD(t.dt, INTERVAL 1 DAY) FROM t WHERE DATE_ADD(t.dt, INTERVAL 1 DAY) <= '2019-04-30'
)
select * FROM t; 
```

以上返回“2019-01-01”和“2019-04-30”之间的日期表。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2011-08-23T17:46:36.437

对于 Access（或任何 SQL 语言）

1.  创建一个包含 2 个字段的表，我们将调用此表`tempRunDates`：--
    Fields`fromDate`和--然后`toDate`
    仅插入 1 条记录，该记录具有开始日期和结束日期。

2.  创建另一个表：`Time_Day_Ref`
    --将日期列表（在 excel 中制作列表很容易）导入到此表中。
    -- 在我的例子中，字段名称是`Greg_Dt`, 表示公历日期
    -- 我从 2009 年 1 月 1 日到 2020 年 1 月 1 日列出了我的列表。

3.  运行查询：

    ```
    SELECT Time_Day_Ref.GREG_DT
    FROM tempRunDates, Time_Day_Ref
    WHERE Time_Day_Ref.greg_dt>=tempRunDates.fromDate And greg_dt<=tempRunDates.toDate; 
    ```

简单的！

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-02-04T06:12:40.343

通常，人们会使用一个您通常为此目的保留的辅助数字表，但对此有一些变化：

```
SELECT *
FROM (
    SELECT DATEADD(d, number - 1, '2009-01-01') AS dt
    FROM Numbers
    WHERE number BETWEEN 1 AND DATEDIFF(d, '2009-01-01', '2009-01-13') + 1
) AS DateRange
LEFT JOIN YourStuff
    ON DateRange.dt = YourStuff.DateColumn 
```

我已经看到了表值函数等的变化。

您还可以保留永久的日期列表。我们的数据仓库中有它以及一天中的时间列表。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2012-01-24T21:42:28.607

```
CREATE FUNCTION [dbo].[_DATES]
(
    @startDate DATETIME,
    @endDate DATETIME
)
RETURNS 
@DATES TABLE(
    DATE1 DATETIME
)
AS
BEGIN
    WHILE @startDate <= @endDate
    BEGIN 
        INSERT INTO @DATES (DATE1)
            SELECT @startDate   
    SELECT @startDate = DATEADD(d,1,@startDate) 
    END
RETURN
END 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2011-06-08T23:05:39.677

我们在 HRMS 系统中使用了它，您会发现它很有用

```
SELECT CAST(DAYNAME(daydate) as CHAR) as dayname,daydate
    FROM
    (select CAST((date_add('20110101', interval H.i*100 + T.i*10 + U.i day) )as DATE) as daydate
      from erp_integers as H
    cross
      join erp_integers as T
    cross
      join erp_integers as U
     where date_add('20110101', interval H.i*100 + T.i*10 + U.i day ) <= '20110228'
    order
        by daydate ASC
        )Days 
```

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2011-08-04T06:42:39.667

此解决方案正在使用 MySQL 5.0
创建一个表 - `mytable`.
架构并不重要。重要的是其中的行数。
因此，您可以只保留一列 INT 类型的 10 行值 - 1 到 10。

SQL：

```
set @tempDate=date('2011-07-01') - interval 1 day;
select
date(@tempDate := (date(@tempDate) + interval 1 day)) as theDate
from mytable x,mytable y
group by theDate
having theDate <= '2011-07-31'; 
```

限制：上述查询返回的最大日期数为
`(rows in mytable)*(rows in mytable) = 10*10 = 100.`

你可以通过改变sql中的form part来增加这个范围：
from mytable x,mytable y, mytable z
所以，范围是`10*10*10 =1000`等等。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2020-08-05T15:45:31.947

你可以用这个

```
SELECT CAST(cal.date_list AS DATE) day_year
FROM (
  SELECT SUBDATE('2019-01-01', INTERVAL 1 YEAR) + INTERVAL xc DAY AS date_list
  FROM (
        SELECT @xi:=@xi+1 as xc from
        (SELECT 1 UNION SELECT 2 UNION SELECT 3 UNION SELECT 4) xc1,
        (SELECT 1 UNION SELECT 2 UNION SELECT 3 UNION SELECT 4) xc2,
        (SELECT 1 UNION SELECT 2 UNION SELECT 3 UNION SELECT 4) xc3,
        (SELECT 1 UNION SELECT 2 UNION SELECT 3 UNION SELECT 4) xc4,
        (SELECT 1 UNION SELECT 2 UNION SELECT 3 UNION SELECT 4) xc5,
        (SELECT @xi:=-1) xc0
    ) xxc1
) cal
WHERE cal.date_list BETWEEN '2019-01-01' AND '2019-12-31'
ORDER BY cal.date_list DESC; 
```

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2021-07-17T16:07:57.243

# 没有临时表 | 无程序 | 无功能

下面的示例显示一个月的日期范围 - 从同一个月的第 1 天到最后一天。您可以通过使用@e `INTERVAL` 值来更改日期范围。

```
SET @s := CAST('2021-12-01' AS DATE); -- start at 2021-12-01
SET @e := @s + INTERVAL 1 MONTH - INTERVAL 1 DAY; -- ends at 2021-12-31

WITH RECURSIVE d_range AS
(
       SELECT @s AS gdate -- generated dates
       UNION ALL
       SELECT gdate + INTERVAL 1 day
       FROM   d_range
       WHERE  gdate < @e
)
SELECT *
FROM   d_range; 
```

结果：

```
| gdate       |
+------------+
| 2021-12-01 |
| 2021-12-02 |
| 2021-12-03 |
| 2021-12-04 |
| 2021-12-05 |
| 2021-12-06 |
| 2021-12-07 |
| 2021-12-08 |
| 2021-12-09 |
| 2021-12-10 |
| 2021-12-11 |
| 2021-12-12 |
| 2021-12-13 |
| 2021-12-14 |
| 2021-12-15 |
| 2021-12-16 |
| 2021-12-17 |
| 2021-12-18 |
| 2021-12-19 |
| 2021-12-20 |
| 2021-12-21 |
| 2021-12-22 |
| 2021-12-23 |
| 2021-12-24 |
| 2021-12-25 |
| 2021-12-26 |
| 2021-12-27 |
| 2021-12-28 |
| 2021-12-29 |
| 2021-12-30 |
| 2021-12-31 |
+------------+
-> 31 rows in set (0.037 sec) 
```

> 笔记。此查询在那里使用递归，因为它`31 rows in set (0.037 sec)`在选择较长的日期范围时会变得更慢。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2009-02-04T04:46:01.390

创建一个带有两个参数 a_begin 和 a_end 的存储过程。在其中创建一个名为 t 的临时表，声明一个变量 d，将 a_begin 分配给 d，然后运行一个`WHILE`循环`INSERT`d 到 t 中并调用`ADDDATE`函数来增加值 d。最后`SELECT * FROM t`。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2010-08-19T10:49:34.827

我会使用类似的东西：

```
DECLARE @DATEFROM AS DATETIME
DECLARE @DATETO AS DATETIME
DECLARE @HOLDER TABLE(DATE DATETIME)

SET @DATEFROM = '2010-08-10'
SET @DATETO = '2010-09-11'

INSERT INTO
    @HOLDER
        (DATE)
VALUES
    (@DATEFROM)

WHILE @DATEFROM < @DATETO
BEGIN

    SELECT @DATEFROM = DATEADD(D, 1, @DATEFROM)
    INSERT 
    INTO
        @HOLDER
            (DATE)
    VALUES
        (@DATEFROM)
END

SELECT 
    DATE
FROM
    @HOLDER 
```

然后`@HOLDER`变量表保存这两个日期之间按天递增的所有日期，随时可以加入。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2012-04-06T17:58:21.027

我已经为此奋斗了很长一段时间。由于这是我搜索解决方案时在 Google 上的第一次点击，所以让我发布到目前为止我所获得的信息。

```
SET @d := '2011-09-01';
SELECT @d AS d, cast( @d := DATE_ADD( @d , INTERVAL 1 DAY ) AS DATE ) AS new_d
  FROM [yourTable]
  WHERE @d <= '2012-05-01'; 
```

替换`[yourTable]`为数据库中的表。诀窍是您选择的表中的行数必须 >= 您要返回的日期数。我尝试使用表格占位符 DUAL，但它只会返回一行。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2013-08-15T16:27:29.677

```
select * from table_name where col_Date between '2011/02/25' AND DATEADD(s,-1,DATEADD(d,1,'2011/02/27')) 
```

在这里，首先给当前的 endDate 添加一天，它将是 2011-02-28 00:00:00，然后减去一秒以使结束日期为 2011-02-27 23:59:59。通过这样做，您可以获得给定间隔之间的所有日期。

产量：
2011/02/25
2011/02/26
2011/02/27

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2014-07-10T20:33:17.953

```
DELIMITER $$  
CREATE PROCEDURE popula_calendario_controle()
   BEGIN
      DECLARE a INT Default 0;
      DECLARE first_day_of_year DATE;
      set first_day_of_year = CONCAT(DATE_FORMAT(curdate(),'%Y'),'-01-01');
      one_by_one: LOOP
         IF dayofweek(adddate(first_day_of_year,a)) <> 1 THEN
            INSERT INTO calendario.controle VALUES(null,150,adddate(first_day_of_year,a),adddate(first_day_of_year,a),1);
         END IF;
         SET a=a+1;
         IF a=365 THEN
            LEAVE one_by_one;
         END IF;
      END LOOP one_by_one;
END $$ 
```

这个程序将插入从年初到现在的所有日期，只需替换“开始”和“结束”的日子，你就可以开始了！

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2016-08-31T09:11:47.250

我需要一个包含两个日期之间所有月份的列表来进行统计。这两个日期是订阅的开始日期和结束日期。 **因此，该列表显示了所有月份和每月的订阅量。**

MYSQL

```
CREATE PROCEDURE `get_amount_subscription_per_month`()
BEGIN
   -- Select the ultimate start and enddate from subscribers
   select @startdate := min(DATE_FORMAT(a.startdate, "%Y-%m-01")), 
          @enddate := max(DATE_FORMAT(a.enddate, "%Y-%m-01")) + interval 1 MONTH
   from subscription a;

   -- Tmp table with all months (dates), you can always format them with DATE_FORMAT) 
   DROP TABLE IF EXISTS tmp_months;
   create temporary table tmp_months (
      year_month date,
      PRIMARY KEY (year_month)
   );

   set @tempDate=@startdate;  #- interval 1 MONTH;

   -- Insert every month in tmp table
   WHILE @tempDate <= @enddate DO
     insert into tmp_months (year_month) values (@tempDate);
     set @tempDate = (date(@tempDate) + interval 1 MONTH);
   END WHILE;

   -- All months
   select year_month from tmp_months;

   -- If you want the amount of subscription per month else leave it out
   select mnd.year_month, sum(subscription.amount) as subscription_amount
   from tmp_months mnd
   LEFT JOIN subscription ON mnd.year_month >= DATE_FORMAT(subscription.startdate, "%Y-%m-01") and mnd.year_month <= DATE_FORMAT(subscription.enddate, "%Y-%m-01")
   GROUP BY mnd.year_month;

 END 
```

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2021-07-17T15:35:02.010

# 没有功能，没有程序

```
SET @s := '2020-01-01';
SET @e := @s + INTERVAL 1 YEAR - INTERVAL 1 DAY; -- set end date to select

SELECT CAST((DATE(@s)+INTERVAL (H+T+U) DAY) AS DATE) d -- generate a list of 400 days starting from @s date so @e can not be more then @s + 
FROM ( SELECT 0 H
    UNION ALL SELECT 100 UNION ALL SELECT 200 UNION ALL SELECT 300
  ) H CROSS JOIN ( SELECT 0 T
    UNION ALL SELECT  10 UNION ALL SELECT  20 UNION ALL SELECT  30
    UNION ALL SELECT  40 UNION ALL SELECT  50 UNION ALL SELECT  60
    UNION ALL SELECT  70 UNION ALL SELECT  80 UNION ALL SELECT  90
  ) T CROSS JOIN ( SELECT 0 U
    UNION ALL SELECT   1 UNION ALL SELECT   2 UNION ALL SELECT   3
    UNION ALL SELECT   4 UNION ALL SELECT   5 UNION ALL SELECT   6
    UNION ALL SELECT   7 UNION ALL SELECT   8 UNION ALL SELECT   9
  ) U
 -- generated lenght of date list can be calculated as fallow 1 * H(3 + 1) * T(9 + 1) * U(9 + 1) = 400
 -- it is crucial to preserve the numbering convention as 1, 2 ... 20, 30..., 100, 200, ... to retrieve chronological date selection
 -- add more UNION 400, 500, 600, ... H(6 + 1) if you want to select from more than 700 days!
WHERE
  (DATE(@s+INTERVAL (H+T+U) DAY)) <= DATE((@e))
ORDER BY d; 
```

UNIONS 定义可供选择的可用日期的长度和范围。因此，请始终确保使其记录足够多。

```
SELECT 1 * (3 + 1) * (9 + 1) * (9 + 1); -- 400 days starting from from @s 
```

基于[本文](https://jeffgarretson.blog/2012/05/04/generating-a-range-of-dates-in-mysql/)
测试并按预期工作

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2021-09-08T21:52:41.400

改进[@brad](https://stackoverflow.com/users/472966/brad)答案，我使用了带有光标的 CTE：

```
DECLARE cursorPeriod CURSOR FOR SELECT * FROM (
   WITH RECURSIVE period as
        (
             SELECT '2019-01-01' as dt
             UNION
             SELECT DATE_ADD(period.dt, INTERVAL 1 DAY) FROM period WHERE DATE_ADD(period.dt, INTERVAL 1 DAY) <= '2019-04-30'
        )
   SELECT DATE(dt) FROM period ORDER BY dt ) AS derived_table;

DECLARE CONTINUE HANDLER FOR NOT FOUND SET exit_loop = TRUE; 
```

* * *

## 回答 #22

> 赞同：-3
> 
> 时间：2018-04-19T02:11:27.080

我在用**`Server version: 5.7.11-log MySQL Community Server (GPL)`**

现在我们将以一种简单的方式解决这个问题。

我创建了一个名为**“datetable”的表**

```
mysql> describe datetable;
+---------+---------+------+-----+---------+-------+
| Field   | Type    | Null | Key | Default | Extra |
+---------+---------+------+-----+---------+-------+
| colid   | int(11) | NO   | PRI | NULL    |       |
| coldate | date    | YES  |     | NULL    |       |
+---------+---------+------+-----+---------+-------+
2 rows in set (0.00 sec) 
```

现在，wee 将看到其中插入的记录。

```
mysql> select * from datetable;
+-------+------------+
| colid | coldate    |
+-------+------------+
|   101 | 2015-01-01 |
|   102 | 2015-05-01 |
|   103 | 2016-01-01 |
+-------+------------+
3 rows in set (0.00 sec) 
```

在这里我们的查询是在两个日期而不是那些日期内获取记录。

```
mysql> select * from datetable where coldate > '2015-01-01' and coldate < '2016-01-01';
+-------+------------+
| colid | coldate    |
+-------+------------+
|   102 | 2015-05-01 |
+-------+------------+
1 row in set (0.00 sec) 
```

希望这会帮助很多人。

# c# - 运行托管代码的非托管线程

> ID：510018
> 
> 赞同：0
> 
> 时间：2009-02-04T04:00:46.817
> 
> 标签：c#, c++, multithreading

我制作了一个加载客户制作的外部模块的软件。

该软件应该是 HA（高可用性），这意味着它不能被允许崩溃。为此，我创建了一个类，该类创建一个线程，在其中运行客户端模块函数，然后返回。该类允许一定的时间来执行函数，如果时间过长，它会杀死线程。像这样，如果客户通过在他的代码中使用无限循环或其他任何东西来搞砸他的模块，那么系统的其余部分就不会冻结。

现在，我有一个问题......如果运行该函数的线程是在非托管代码（C++）中创建的，并且在其中运行的模块函数是托管代码，那么杀死线程会遇到什么样的问题？

谢谢，

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-04T04:40:17.330

一般来说，杀死正在运行的进程中的线程是不安全的；[请参阅TerminateThread](http://msdn.microsoft.com/en-us/library/ms686717(VS.85).aspx)中的警告和注释。

如果我正在做这样一个应用程序，我会倾向于研究如何在具有明确定义的通信接口的单独进程中托管第 3 方模块；例如：在 COM+ 应用程序中。如果它“失控”，这将允许您杀死整个进程，而不会影响“主机”进程的稳定性。

# .net - 使用 .NET Framework 捕获麦克风音频流

> ID：510019
> 
> 赞同：16
> 
> 时间：2009-02-04T04:02:37.407
> 
> 标签：.net, audio, input, stream, microphone

我需要在我的应用程序中捕获来自麦克风的输入流，该应用程序是用 VB.NET 编写的。我需要能够将这些数据流式传输到文件或通过 HTTP，并可能使用 LAME MP3 对其进行编码。有人可以帮我开始吗？

谢谢！

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2009-02-04T07:43:42.873

如果您想要一个 .NET 解决方案，您可以查看[NAudio](https://github.com/naudio/NAudio)，它是一个开源音频库。查看`WaveInStream`类（或`WaveIn`最新代码）。这将让您打开麦克风，并接收包含最新捕获字节的事件。这将很容易传递给流。

至于使用 LAME 编码 MP3，我见过的一种方法是通过标准输入将音频传递给 lame.exe，然后从标准输出读取 mp3。我认为这比获取 LAME DLL 并为其编写互操作包装器更容易。

**更新：**我创建了一个示例项目，它使用 NAudio 从麦克风录制，并在[http://voicerecorder.codeplex.com](http://voicerecorder.codeplex.com)上将 LAME 保存为 MP3 。[在此处](http://blogs.msdn.com/coding4fun/archive/2009/10/08/9905168.aspx)查看我在 Coding4Fun 上的文章。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-04T04:07:38.240

也许不是最新的体验，但我记得我在玩[http://nyxtom.vox.com/library/post/recording-audio-in-c.html](http://nyxtom.vox.com/library/post/recording-audio-in-c.html)

对于更专业的事情，您可能需要查看 DirectSound API。

干杯。

# delphi - 具有“线程安全”读/写操作的 Delphi 数据类型列表？

> ID：510031
> 
> 赞同：10
> 
> 时间：2009-02-04T04:09:52.290
> 
> 标签：delphi, thread-safety, atomic

'布尔'变量对于从任何线程读取和写入是线程安全的吗？我已经看到一些新闻组引用说它们是。是否有任何其他数据类型可用？（枚举类型，也许是短整数？）

最好有一个可以从任何线程安全读取的所有数据类型的列表，以及另一个可以在任何线程中安全写入的列表，而无需求助于各种同步方法。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-02-04T11:49:57.137

请注意，您基本上可以使 delphi 中的所有内容都成为非线程安全的。虽然其他人提到布尔值的对齐问题，但这在某种程度上隐藏了真正的问题。

是的，如果正确对齐，您可以在任何线程中读取布尔值并写入任何线程中的布尔值。但是从你改变的布尔值中读取并不一定是“线程安全的”。假设您在更新数字时将布尔值设置为 true，以便另一个线程读取该数字。

```
if NumberUpdated then
begin
  LocalNumber = TheNumber;
end; 
```

由于优化，处理器使 TheNumber 可能在 NumberUpdated 被读取之前被读取，因此即使您最后更新 NumberUpdated，您也可能获得 TheNumber 的旧值。

又名，您的代码可能变为：

```
temp = TheNumber;
if NumberUpdated the
begin
  LocalNumber = temp;
end; 
```

恕我直言，一个基本的经验法则：
“读取是线程安全的。写入不是线程安全的。”
因此，如果您要对数据进行写保护，并在您读取值的**任何地方进行同步，同时****可能**会发生写入。
另一方面，如果你只在一个线程中读取和写入一个值，那么它是线程安全的。因此，您可以在临时位置进行大量写入，然后同步更新应用程序范围的数据。

奖金简介：

VCL 不是线程安全的。将所有 ui 内容的修改保留在主线程中。在主线程中保留所有 ui 内容的创建。

许多函数也不是线程安全的，而其他函数则通常取决于底层的 winapi 调用。

我认为“列表”不会有帮助，因为“线程安全”可能意味着很多东西。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-02-04T06:51:31.747

这不是数据类型是否线程安全的问题，而是您如何处理它们的问题。没有锁定的任何操作都是线程安全的，包括加载一个值，然后更改它，然后将其写回：递增或递减一个数字，清除或设置集合中的一个元素——它们都不是线程安全的。

有许多允许原子操作的函数：互锁递增、互锁递减和互锁交换。这是一个常见的概念，与 Windows、x86 或 Delphi 无关。对于 Delphi，您可以使用 Windows API 的 InterlockedFoo() 函数，这些函数也有几个包装器。或者自己写。这些函数对整数进行操作，因此您可以与它们进行整数（32 位）的原子递增、递减和交换。

您还可以使用带有锁定前缀的汇编程序和前缀操作。

有关更多信息，另请参阅[此 StackOverflow](https://stackoverflow.com/questions/443500/are-incrementers-decrementers-var-var-etc-thread-safe)问题。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-02-04T06:33:22.827

在 32 位架构上，只有正确对齐的 32 位或更少的数据类型才应被视为原子数据类型。32 位值必须是 4 对齐的（数据的地址必须能被 4 整除）。您可能不会在如此紧密的级别上遇到交错，但理论上您可以进行双重、Int64 或扩展的非原子写入。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2016-03-11T14:18:14.190

由于现代处理器混合了多核 RISC 处理和独立的核心高速缓存，任何“微不足道”的高级语言读取或写入构造（或就此而言许多曾经- a-time 8086 'atomic' 汇编指令）可以被认为是原子的。事实上，除非汇编指令是专门设计为原子的，否则它可能不是原子的——这包括大多数内存读取机制。即使是汇编程序级别的长整数读取也可能被来自共享相同内存的另一个处理器内核的同时写入破坏，并在 RISC 处理器级别使用异步缓存更新操作。请记住，在包含多个 RISC 内核的处理器上，即使是汇编语言指令实际上也只是“高级”代码指令！您永远不会真正知道它们是如何在位级别实现的，如果您正在阅读旧的 8086（单核）汇编器手册，它可能与您期望的不太一样。Windows 确实提供了与本机系统兼容的原子操作符，建议您使用这些操作符，而不是对原子操作做任何基本假设。

为什么使用 Windows 运算符？因为 Windows 所做的第一件事就是确定运行它的机器是什么。它确保正确的关键方面之一是存在哪些原子操作以及它们将如何工作。如果您希望您的代码在未来的任何处理器上运行良好，您可以在自己的代码中复制（并不断更新）所有这些工作，或者您可以利用 Windows 在启动时已经完成所有这些工作的事实。然后，它在运行时将必要的代码合并到其 API 中。

阅读有关原子操作的 MSDN 页面。Windows API 为您呈现这些。它们有时可能看起来笨重或笨拙 - 但它们是未来的证明，它们将始终按照锡上所说的那样工作。

我怎么知道这个？好吧，因为如果他们不这样做 - 那么您将无法运行 Windows。句号。没关系运行自己的代码。

[每当您编写代码时，了解Parsimony](http://www.merriam-webster.com/dictionary/parsimony)并考虑[Occam 剃刀](https://en.wikipedia.org/wiki/Occam%27s_razor)总是一个好主意。换句话说，如果 Windows 已经这样做了，并且你的代码需要 Windows 来运行，那么就使用 Windows 已经在做的事情，而不是尝试许多替代的和越来越复杂的假设解决方案，这些解决方案可能有效也可能无效。做任何其他事情都只是在浪费你的时间（当然，除非你是这样做的）。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-21T18:49:26.680

Indy 代码在 IdThreadSafe.pas 中包含一些原子/线程安全的数据类型：

*   TIdThreadSafeInteger
*   TIdThreadSafeBoolean
*   TIdThreadSafeString
*   TIdThreadSafeStringList 等等...

# apache-flex - 使 Flex 在 AreaSeries 中显示最近的 DataTip

> ID：510044
> 
> 赞同：3
> 
> 时间：2009-02-04T04:13:57.150
> 
> 标签：apache-flex, charts

我正在构建一个包含面积图的 Flex 应用程序，当用户将鼠标悬停在 AreaSeries 上时，我希望他们看到该系列中最近数据点的 DataTip。问题是，据我所知（我现在应该承认对 Flex 还很陌生），mouseSensitivity 是控制何时出现数据提示的唯一方法。

如果我将其设置为 1000 像素并告诉 Flex 只显示一个数据提示，这有时会起作用，但通常情况下，最近的数据点不是用户悬停的系列中的一个（无论如何，如此高的鼠标灵敏度，它开始表现得很奇怪）。

因此，简而言之，我的问题是如何对在任何给定时间显示的数据提示进行相当直接的控制。先感谢您。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-04T15:04:22.483

不幸的是，我认为仅使用图表默认成员就没有直接的方法来实现这一目标。我希望您需要扩展您正在使用的图表组件并与图表的内部工作相结合。这不是一件容易的事，而且图表组件的内部工作非常复杂。某些类中相当混乱的实现无济于事。

显然有几个方向可以解决这个特定问题，其中一些方向比其他方向更优雅。

这绝对是可能的，但对于一个相对较新的人来说，这可能不是一份工作。如果我是您，我可能会尝试找到您的要求的折衷方案，直到您更愿意深入研究图表组件代码。

如果你决定试一试，那么你应该带着具体的问题回来，因为我自己和其他人可能不愿意解决这么大的问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-14T01:22:07.657

请记住 hitTest() 方法：这通常是与鼠标相关的最后手段。

干杯

# solaris - 试图让 vncserver 在 solaris 上运行：致命的服务器错误：无法打开默认字体“已修复”

> ID：510046
> 
> 赞同：1
> 
> 时间：2009-02-04T04:14:18.380
> 
> 标签：solaris, x11, vnc

我查看了所有网页，有一些很好的建议，但没有一个对我有用。Solaris sparc 盒，SunOS 5.10 Generic_120011-14 sun4u sparc SUNW，UltraAX-i2

这台机器安装了 openwin，并带有来自所有常用 X11 目录的符号链接。

xfs 正在运行并且所有字体目录都在那里，我运行了 mkfontdir 和 fc-cache 并且一切都正确地构建了索引，但是无论如何我都无法让它找到默认字体。（如果这确实是问题）我以 root 身份运行，没有帮助。

致命的服务器错误：无法打开默认字体“已修复”

有什么建议么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-04T14:58:08.957

Solaris 10 4/08（更新 5）及更高版本中包含的 vncserver 默认情况下应正确设置所有字体路径。

对于其他版本的 vncserver/Xvnc：

*   您可以使用 xfs，但不需要。如果您正在使用它，您可以将
    Xvnc 字体路径设置为类似 tcp/localhost:7100
*   X 服务器不使用 fc-cache 和 fontconfig 来查找字体，仅由
    X 客户端使用，因此它们无济于事
*   Solaris 10 下的 X11 字体目录位于 /usr/openwin/lib/X11/fonts 中，符号链接位于 /usr/X11/lib/X11/fonts 下 Solaris 10 捆绑的 Xvnc 服务器的默认 X11 字体路径为：/usr/ X11/lib/X11/fonts/TrueType/,/usr/X11/lib/X11/fonts/Type1/,/usr/X11/lib/X11/fonts/Type1/sun/,/usr/X11/lib/X11/ fonts/F3bitmaps/,/usr/X11/lib/X11/fonts/misc/,/usr/X11/lib/X11/fonts/100dpi/,/usr/X11/lib/X11/fonts/75dpi/

让 X 服务器找到“已修复”是一个多步骤过程，每一步都有可能出现问题，因此您应该检查所有这些：

*   字体路径需要包含具有固定字体的目录：/usr/openwin/lib/X11/fonts/misc/（X 中的字体路径不是递归的，所以不能只列出 /usr/openwin/lib/ X11/fonts 并让它找到所有子目录）
*   /usr/openwin/lib/X11/fonts/misc/fonts.alias 列出了将短名称“固定”转换为完整 X11 字体名称的别名：

    固定“-misc-fixed-medium-r-semicondensed--13-120-75-75-c-60-iso8859-1”

*   /usr/openwin/lib/X11/fonts/misc/fonts.dir 列出了具有该全名的字体的文件名：

    7x13.pcf -misc-fixed-medium-r-normal--13-120-75-75-c-70-iso8859-1

*   /usr/openwin/lib/X11/fonts/misc/7x13.pcf 存在并且是世界可读的

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-04T05:24:17.383

在 Linux 版本上设置 vnc 后，我自己也遇到了类似的问题。事实证明，启动 Xwindows 服务器的脚本没有正确的字体路径。一旦我修复它就可以了。

我不知道您使用的是什么版本的 vnc，但您可以尝试编辑 vncserver 脚本以包含字体的显式路径，看看是否有帮助。在我使用的版本（RHEL5 上的 TightVNC）中，有一部分脚本设置了为启动 vnc Xwindows 系统（Xvnc）而发出的确切命令。作为此设置的一部分，有一行（在我的当前版本中已注释掉）使用*-fp*标志设置字体路径。有问题的代码片段如下所示：

```
# Now start the X VNC Server

$cmd = "Xvnc :$displayNumber";
$cmd .= " -desktop " . &quotedString($desktopName);
$cmd .= " -httpd $vncJavaFiles" if ($vncJavaFiles && ! $nohttpd);
$cmd .= " -auth $xauthorityFile";
$cmd .= " -geometry $geometry" if ($geometry);
$cmd .= " -depth $depth" if ($depth);
$cmd .= " -pixelformat $pixelformat" if ($pixelformat);
$cmd .= " -rfbwait 30000";
$cmd .= " -rfbauth $vncUserDir/passwd";
$cmd .= " -rfbport $vncPort";
$cmd .= " -pn";

# Add font path and color database stuff here, e.g.:
#
# $cmd .= " -fp /usr/lib/X11/fonts/misc/,/usr/lib/X11/fonts/75dpi/";
# $cmd .= " -co /usr/lib/X11/rgb";
# 
```

设置字体路径的行在末尾的注释掉部分。您可以尝试在启动脚本中找到类似的部分，并明确设置字体的路径，看看这是否至少能让您摆脱致命错误。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-02T13:33:39.040

在 Solaris 10 x86_64 update 7 (05/09) 上，我在 ESX 上作为 VM 安装时遇到了类似的问题。以下行能够纠正该问题：

```
 mkfontdir "/usr/X11/lib/X11/fonts/TrueType/"
mkfontdir "/usr/X11/lib/X11/fonts/Type1/"
mkfontdir "/usr/X11/lib/X11/fonts/Type1/sun/"
mkfontdir "/usr/X11/lib/X11/fonts/F3bitmaps/"
mkfontdir "/usr/X11/lib/X11/fonts/misc/"
mkfontdir "/usr/X11/lib/X11/fonts/100dpi/"
mkfontdir "/usr/X11/lib/X11/fonts/75dpi/"
echo -e 'fixed "-misc-fixed-medium-r-semicondensed--13-120-75-75-c-60-iso8859-1"' > /usr/openwin/lib/X11/fonts/misc/fonts.alias 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-09-03T14:18:22.970

PS：同时我发现我的安装ISO已损坏（MD5和不匹配）。安装中有一些包损坏。下载另一个 ISO 后，我的问题就消失了。

# rhino-mocks - 在同一对象上的方法之前存根属性获取器 - Rhino.Mocks 3.5

> ID：510050
> 
> 赞同：1
> 
> 时间：2009-02-04T04:17:26.753
> 
> 标签：rhino-mocks

我在这里有 Rhino.Mocks 3.5 的一个可能的错误场景：[http](http://groups.google.com/group/RhinoMocks/browse_thread/thread/b38d09b276e66ec7) ://groups.google.com/group/RhinoMocks/browse_thread/thread/b38d09b276e66ec7 有谁知道是什么问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-10T22:41:46.667

看起来你已经在那个线程上得到了回答。这对你有帮助吗？如果有，你想结束这个问题吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-13T04:47:50.820

这是一个错误（我在用户组的帖子得到了回答[http://groups.google.com/group/RhinoMocks/browse_thread/thread/b38d09b276e66ec7](http://groups.google.com/group/RhinoMocks/browse_thread/thread/b38d09b276e66ec7)）。

# javascript - 如何使用 jQuery 在屏幕上移动 div

> ID：510055
> 
> 赞同：26
> 
> 时间：2009-02-04T04:21:39.770
> 
> 标签：javascript, jquery

我需要让多个 div 在屏幕上从右向左移动，并在它到达边缘时停止。我最近一直在玩 jQuery，看起来我想要的东西可以用它来完成。有谁知道或知道我在哪里可以找到这样的例子？

* * *

## 回答 #1

> 赞同：43
> 
> 时间：2009-02-04T04:32:42.917

您将需要查看 jQuery animate() 功能。执行此操作的标准方法是绝对定位元素，然后为“左”或“右”CSS 属性设置动画。一种同样流行的方法是增加/减少左边距或右边距。

现在，话虽如此，您需要注意任何持续时间超过一两秒的动画类型的严重性能损失。Javascript 根本不适合处理长时间、持续、缓慢的动画。这与动画的每个“帧”重绘和重新计算 DOM 元素的方式有关。如果您正在制作持续超过几秒钟的页面宽度动画，预计您的处理器会飙升 50% 或更多。如果您使用的是 IE6，请准备好看到您的计算机自发燃烧成一个浏览器无能的燃烧球。

要阅读此内容，请查看[此线程](https://stackoverflow.com/questions/459302/cross-browser-jquery-transition-animation/459547#459547)（来自我的第一篇 Stackoverflow 帖子）！

这是 animate() 功能的 jQuery 文档的链接：http: [//docs.jquery.com/Effects/animate](http://docs.jquery.com/Effects/animate)

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-02-04T09:53:12.597

在 jQuery 1.2 和更新版本中，您不再需要绝对定位元素；您可以使用正常的相对定位并使用 += 或 -= 来添加或减去属性，例如

```
$("#startAnimation").click(function(){
    $(".toBeAnimated").animate({ 
        marginLeft: "+=250px",
    }, 1000 );
}); 
```

并回应第一个回答的人的建议：Javascript 不是高性能的。不要过度使用动画，或者期望在 Chrome 上的高性能 PC 上运行良好和快速的东西在运行 IE 的沼泽标准 PC 上看起来不错。测试它，并确保它能够很好地降解！

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-04-20T16:38:45.210

使用 jQuery

html

```
<div id="b">&nbsp;</div> 
```

css

```
div#b {
    position: fixed;
    top:40px;
    left:0;
    width: 40px;
    height: 40px;
    background: url(http://www.wiredforwords.com/IMAGES/FlyingBee.gif) 0 0 no-repeat;
} 
```

脚本

```
var b = function($b,speed){

    $b.animate({
        "left": "50%"
    }, speed);
};

$(function(){
    b($("#b"), 5000);
}); 
```

见 jsfiddle [http://jsfiddle.net/vishnurajv/Q4Jsh/](http://jsfiddle.net/vishnurajv/Q4Jsh/)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-30T10:55:01.337

在这里，我为上述查询完成了完整的垃圾箱。下面是演示链接，我想它可以帮助你

**演示：** [http ://codebins.com/bin/4ldqp9b/1](http://codebins.com/bin/4ldqp9b/1)

**HTML：**

```
<div id="edge">
  <div class="box" style="top:20; background:#f8a2a4;">
  </div>
  <div class="box" style="top:70; background:#a2f8a4;">
  </div>
  <div class="box" style="top:120; background:#5599fd;">
  </div>
</div>
<br/>
<input type="button" id="btnAnimate" name="btnAnimate" value="Animate" /> 
```

**CSS：**

```
body{
  background:#ffffef;
}
#edge{
  width:500px;
  height:200px;
  border:1px solid #3377af;
  padding:5px;
}

.box{
  position:absolute;
  left:10;
  width:40px;
  height:40px;
  border:1px solid #a82244;
} 
```

**查询：**

```
$(function() {
    $("#btnAnimate").click(function() {
        var move = "";
        if ($(".box:eq(0)").css('left') == "10px") {
            move = "+=" + ($("#edge").width() - 35);
        } else {
            move = "-=" + ($("#edge").width() - 35);
        }
        $(".box").animate({
            left: move
        }, 500, function() {
            if ($(".box:eq(0)").css('left') == "475px") {
                $(this).css('background', '#afa799');
            } else {
                $(".box:eq(0)").css('background', '#f8a2a4');
                $(".box:eq(1)").css('background', '#a2f8a4');
                $(".box:eq(2)").css('background', '#5599fd');
            }

        });
    });
}); 
```

**演示：** [http ://codebins.com/bin/4ldqp9b/1](http://codebins.com/bin/4ldqp9b/1)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-03-23T17:31:02.057

只是我鼓吹的一个快速的小功能，可以将 DIV 从当前位置移动到目标位置，一次一个像素步长。我尽我所能发表评论，但您感兴趣的部分在示例 1 和示例 2 中，就在 [$(function() { *// jquery document.ready* ] 之后。将边界检查代码放在那里, 满足条件则退出区间，需要jQuery。

首先是**演示**：http: [//jsfiddle.net/pnYWY/](http://jsfiddle.net/pnYWY/)

首先是DIV...

```
<style>
  .moveDiv {
    position:absolute;
    left:20px;
    top:20px;
    width:10px;
    height:10px;
    background-color:#ccc;
  }

  .moveDivB {
    position:absolute;
    left:20px;
    top:20px;
    width:10px;
    height:10px;
    background-color:#ccc;
  }
</style>

<div class="moveDiv"></div>
<div class="moveDivB"></div> 
```

示例 1) 开始

```
// first animation (fire right away)
var myVar = setInterval(function(){
    $(function() { // jquery document.ready

        // returns true if it just took a step
        // returns false if the div has arrived
        if( !move_div_step(55,25,'.moveDiv') )
        {
            // arrived...
            console.log('arrived'); 
            clearInterval(myVar);
        }

    });
},50); // set speed here in ms for your delay 
```

示例 2) 延迟启动

```
// pause and then fire an animation..
setTimeout(function(){
    var myVarB = setInterval(function(){
        $(function() { // jquery document.ready
            // returns true if it just took a step
            // returns false if the div has arrived
            if( !move_div_step(25,55,'.moveDivB') )
            {
                // arrived...
                console.log('arrived'); 
                clearInterval(myVarB);
            }
        });
    },50); // set speed here in ms for your delay
},5000);// set speed here for delay before firing 
```

现在的功能：

```
function move_div_step(xx,yy,target) // takes one pixel step toward target
{
    // using a line algorithm to move a div one step toward a given coordinate.
    var div_target = $(target);

    // get current x and current y
    var x = div_target.position().left; // offset is relative to document; position() is relative to parent;
    var y = div_target.position().top;

    // if x and y are = to xx and yy (destination), then div has arrived at it's destination.
    if(x == xx && y == yy)
        return false;

    // find the distances travelled
    var dx = xx - x;
    var dy = yy - y;

    // preventing time travel
    if(dx < 0)          dx *= -1;
    if(dy < 0)          dy *= -1;

    // determine speed of pixel travel...
    var sx=1, sy=1;

    if(dx > dy)         sy = dy/dx;
    else if(dy > dx)    sx = dx/dy;

    // find our one...
    if(sx == sy) // both are one..
    {
        if(x <= xx) // are we going forwards?
        {
            x++; y++;
        }
        else  // .. we are going backwards.
        {
            x--; y--;
        }       
    }
    else if(sx > sy) // x is the 1
    {
        if(x <= xx) // are we going forwards..?
            x++;
        else  // or backwards?
            x--;

        y += sy;
    }
    else if(sy > sx) // y is the 1 (eg: for every 1 pixel step in the y dir, we take 0.xxx step in the x
    {
        if(y <= yy) // going forwards?
            y++;
        else  // .. or backwards?
            y--;

        x += sx;
    }

    // move the div
    div_target.css("left", x);
    div_target.css("top",  y);

    return true;
}  // END :: function move_div_step(xx,yy,target) 
```

# asp.net-mvc - Telerik Controls with ASP.NET MVC：这是否违反了 MVC 模型？

> ID：510059
> 
> 赞同：5
> 
> 时间：2009-02-04T04:23:25.897
> 
> 标签：asp.net-mvc, telerik

1.  将[启用 MVC 的 Telerik 控件](http://blogs.telerik.com/AtanasKorchev/Posts/08-11-06/ASP_NET_Ajax_Controls_in_ASP_NET_MVC.aspx)与 ASP.NET MVC 一起使用会违反 MVC 模型吗？

2.  如果没有，使用 Telerik 控件而不是手动编码 HTML 会有什么样的性能影响（相对于功能和开发速度）？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-02-04T16:29:13.763

由于我是构建该演示的人，我想我也可以分享我的意见。根据我的说法，这个示例应用程序不违反 MVC 原则。RadControls 不依赖于 MVC 应用程序中的 ViewState 或回发（您可以检查生成的输出以自己查看 - 没有 __doPostBack 或 __VIEWSTATE）。实际上，您需要编写一些代码来绑定网格或填充菜单 - 但代码仍然在视图 (ASPX) 中，并且与演示文稿完全相关（这只是我的观点，所以我可能错了）。

我还应该提到确实存在一些限制 - 一些内置功能（依赖于回发）在 MVC 中不起作用。但是将努力解决它们。如果您对 RadControls 和 ASP.NET MVC 有任何特殊问题，请随时打开支持票证或论坛主题。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-05T16:31:50.120

对于您的第二个问题，关于性能影响与手动编码，我认为这取决于您使用的控件。例如，如果您在 MVC 中使用任何 Telerik 导航控件，例如 Menu、TabStrip 或 PanelBar，您将节省大量手动编码（因为菜单/标签条/等需要大量客户端提供交互功能的代码（如下拉选项）和许多复杂的 CSS）。因此，MVC 中的 RadControls 将有助于恢复您在构建丰富的 ASPNET 应用程序时习惯的*生产力。*

对于更复杂的控件，例如 Grid，它在很大程度上依赖于回发，您主要从提供的样式中受益。为了适应 MVC 模型，像 Grid 这样的控件需要相当多的“自定义”编码才能将回发事件“转换”为 URL 操作，因此与 MVC 网格模板相比，您可能不会节省大量代码。但是，您将在样式上节省大量时间，并且性能差异应该可以忽略不计。

希望有帮助。

-托德

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-04T04:33:01.340

我很确定这些依赖于 WebForms 中的 PostBack 模型，并且与 MVC 视图不兼容。您可能会找到一种让它们工作的方法，但这不符合 MVC 原则。如果需要，您可以在同一个网站中混合/匹配 WebForms 和 MVC 视图，但我不建议这样做。

使用 Telerik 控件将失去的是 MVC 的大部分好处：清晰的关注点分离、增强的可测试性、更精简的 HTML、更简洁的架构。我不会惊讶地发现 Telerik 最终推出了 MVC 控件。现在，如果您需要重用一些通用组件，我会查看客户端的纯 Javascript 实现或手动编码的 ViewUserControls。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-04T18:19:57.567

就个人而言，我不会将当前的 Telerik 控件与 MVC 一起使用。我认为它们在某些情况下工作（[http://telerikwatch.com/2009/01/telerik-mvc-demo-app-now-available.html](http://telerikwatch.com/2009/01/telerik-mvc-demo-app-now-available.html)），但我认为它们非常以视图状态/回发为中心。知道telerik，他们会推出兼容MVC的版本，但看起来他们面前还有很多工作要做......

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-03-12T00:13:21.850

我意识到这是一个老问题，但[Telerik 的 ASP.NET MVC 控件](http://docs.telerik.com/kendo-ui/aspnet-mvc/asp-net-mvc-5)只是控件，如日期选择器、网格、面板栏、标签条。这些都不是 MVC*框架*的竞争对手。他们**与它***一起* 工作。您的问题告诉我您不了解，或者至少*不了解*MVC 的真正含义。

 ***为了其他可能感到困惑的人的利益，MVC 代表*Model-View-Controller*。有一个*Model*，表示您用于存储或检索值的对象，一个*View*，它显示这些对象值并可以通过使用*控件*（例如 Telerik 的日期选择器、网格等）和*Controller*来设置它们，它包含渲染视图并与模型元素交互的功能。您用于更新模型的控件必须能够与该模型交互以符合 MVC。如果他们不这样做，那么他们首先不能被宣传为 MVC 控件，所以是的，他们的控件与 MVC 框架一起工作，并且不会“违反”MVC 框架。

这是日期选择器控件与模型一起使用的一种方式：

**看法：**

```
@model MyViewModel

<%= Html.Kendo().DateTimePickerFor(model => model.ExpirationDate)
    .Name("datetimepicker")
    .Value(model.ExpirationDate)        
%> 
```

**VIEWMODEL：（** 或型号）

```
public MyViewModel() {
    public DateTime ExpirationDate { get; set; }
} 
```

**控制器：**

```
public ActionResult Index(int id)
{
    var data = dataContext.SomeTable.Where(e => e.ID == id).FirstOrDefault();
    // return View(data); // this would allow you to use @model SomeTable 
    // in your view, and not require a ViewModel, but returns the whole 
    // record for the given ID

    // ViewModels allow you flexibility in what you return
    MyViewModel mvm = new MyViewModel();
    mvm.ExpirationDate = data.ExpirationDate;
    return View(mvm);
} 
```

为了使用 Telerik 的演示对它们进行编码，需要对您输入的特定模型和数据进行大量复制/粘贴和各种小编辑（如上所示）。代码也少得多，因为控件几乎所有东西都是内置的，所以当然生产时间会大大减少，过滤、分页、[网格](http://demos.telerik.com/aspnet-mvc/grid/index)排序等东西已经存在——你只需添加说，就可以打开它`Filterable()`，用于过滤。例如，不必创建单独的 DataColumns 并将它们添加到 DataTable，然后将其绑定到网格，然后担心单独的`OnDataBound`事件（您仍然可以这样做，但需要的更少），您可以实例化一个网格，添加您的列，设置你的控制器函数来创建、读取、更新和删除项目，并设置网格上的任何属性，你就完成了：

```
<%: Html.Kendo().Grid<Models.ViewModels.MyViewModel>()
    .Name("grid")
    .Columns(columns =>
    {
        columns.Bound(c => c.ExpirationDate).Format("MM/DD/YYYY");
    })
    .HtmlAttributes(new { style = "height: 380px;" })
    .Scrollable()
    .Sortable()
    .Filterable()
    .Pageable(pageable => pageable
        .Refresh(true)
        .PageSizes(true)
        .ButtonCount(5))
    .DataSource(dataSource => dataSource
        .Ajax()
        .Read(read => read.Action("Customers_Read", "Grid"))
        .Create(create => create.Action("Customers_Create", "Grid"))
        .Update(update=> update.Action("Customers_Update", "Grid"))
        .Delete(delete => create.Action("Customers_Delete", "Grid"))
    )
 %> 
```

“读取”就像将`public ActionResult Index()`上面的前 2 行放入一个`public Customers_Read([DataSourceRequest] DataSourceRequest request) {}`返回`data`为`.ToDataSourceResult()`. 更新类似于该函数中的最后 3 行，因为您实例化模型，复制从网格传入的模型中的值，然后执行类似`dataContext.SaveChanges()`保存的操作。保存后，网格会自动进行另一次读取，因此它将看到最新的值。无需在回发时运行其他任何东西来重新绑定数据，因此无需编写更多代码。

只需查看此处的代码示例以更好地了解： [http ://demos.telerik.com/aspnet-mvc/](http://demos.telerik.com/aspnet-mvc/)

# inheritance - dojo：具有默认值的继承 - 不会发生 mixin

> ID：510060
> 
> 赞同：1
> 
> 时间：2009-02-04T04:24:42.493
> 
> 标签：inheritance, constructor, dojo, mixins, declare

我希望声明一个从现有 dojo 类继承的新 dojo 类，但我自己选择了类属性的默认值。（用户仍然可以覆盖这些值。）

我正在声明我自己的版本`dijit.form.FilteringSelect`：

*   该`hasDownArrow`属性默认为`false`（而不是标准`true`）和
*   有一个额外的可能属性`storeUrl`允许我连接`FilteringSelect`到相应的`QueryReadStore`.

这是我所做的，但没有成功：

```
dojo.provide("my.FilteringSelect");
dojo.require("dijit.form.FilteringSelect");
dojo.require("dojox.data.QueryReadStore");
dojo.declare(
   "my.FilteringSelect",
   [
      dijit.form.FilteringSelect,  /* base superclass */
      { hasDownArrow:false, storeUrl:"/" }  /* mixin */
   ],
   {
      constructor: function(params, srcNodeRef){
         console.debug("Constructing my.FilteringSelect with storeUrl "
                        + this.storeUrl);
         this.store = new dojox.data.QueryReadStore({url:this.storeUrl});
      }
   }
); 
```

说，我尝试在 HTML 中以声明方式生成这样一个版本`my.FilteringSelect`：

```
<input type="text" id="birthplace" name="birthplace"
       promptMessage="Start typing, and choose among the suggestions"
       storeUrl="/query/regions"
       dojoType="my.FilteringSelect" /> 
```

这确实会创建一个`FilteringSelect`具有所需的`promptMessage`（这意味着超类正确获取参数），但是`hasDownArrow`是`true`（与我的默认混合）和`store`是`null`（并且 Firebug 控制台报告`storeUrl`是“ `undefined`”）。

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-04T04:51:08.090

哎呀！我真的有事情在他们头上。我找到了正确的方法。以下作品：

```
dojo.provide("my.FilteringSelect");
dojo.require("dijit.form.FilteringSelect");
dojo.require("dojox.data.QueryReadStore");
dojo.declare(
   "my.FilteringSelect",
   dijit.form.FilteringSelect,
   {
      hasDownArrow : false,
      storeUrl : "/",
      constructor: function(params, srcNodeRef){
         dojo.mixin(this, params);
         console.debug("Constructing my.FilteringSelect with storeUrl "
                        + this.storeUrl);
         this.store = new dojox.data.QueryReadStore({url:this.storeUrl});
      }
   }
); 
```

# java - 如果在转换为字节码的过程中丢失了信息，是否可以编写一个像样的 Java 优化器？

> ID：510061
> 
> 赞同：1
> 
> 时间：2009-02-04T04:25:27.143
> 
> 标签：java, optimization

我突然想到，当你编写一个 C 程序时，编译器知道源平台和目标平台（因为没有更好的术语），并且可以针对它构建代码的机器进行优化。但是在java中，编译器能做的最好的就是优化字节码，这可能很棒，但是jvm中仍然有一个层必须解释字节码，并且字节码离最终机器架构的翻译距离越远, 要做的工作越多。

在我看来，字节码优化器不会那么好，因为它丢失了原始源代码中可用的所有语义信息（可能已经被 java 编译器的优化器扼杀了。）

那么，甚至有可能使用 java 编译器达到 C 的效率吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-04T04:56:21.837

实际上，字节码 JIT 编译器在许多情况下可以*超过*静态编译语言的性能，因为它可以在实际执行上下文中实时评估字节码。因此，应用程序的性能会随着它继续运行而提高。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-04T04:57:04.880

凯文所说的。此外，字节码优化器 (JIT) 还可以利用运行时信息来执行更好的优化。例如，它知道哪些代码执行得更多（热点），因此它不会花时间优化很少执行的代码。它可以完成配置文件引导优化为您提供的大部分内容（分支预测等），但无论目标处理器是什么，它都可以即时完成。这就是为什么 JVM 通常需要在达到最佳性能之前“预热”。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-04T04:40:06.223

从理论上讲，两个优化器的行为都应该“相同”，因为 c/c++ 编译器对生成的程序集而不是源代码执行优化是标准做法，因此您已经丢失了任何语义信息。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-04T07:02:47.747

如果您阅读字节码，您可能会发现编译器并没有很好地优化代码。然而，JIT 可以优化代码，所以这并不重要。

假设您在 x86 机器上编译代码并且出现了新架构，我们称之为 x64，即使在编译代码时它可能不存在，相同的 Java 二进制文件也可以利用该架构的新功能。这意味着您可以使用旧的库发行版并利用最新的硬件特定优化。你不能用 C/C++ 做到这一点。

Java 可以优化虚拟方法的内联调用。假设您有一个具有许多不同可能实现的虚拟方法。但是，假设在现实中大部分时间都调用一两个实现。JIT 可以检测到这一点并内联最多两个方法实现，但如果您碰巧调用另一个实现，它仍然可以正常运行。你不能用 C/C++ 做到这一点

Java 7 支持对锁定/同步对象的转义分析，它可以检测到一个对象仅在本地上下文中使用并删除该对象的同步。在当前版本的 Java 中，它可以检测两个连续的方法是否锁定同一个对象并在它们之间保持锁定（而不是释放并重新获取锁定）你不能用 C/C++ 做到这一点，因为没有一种语言对锁的理解水平。

# css - 如何使文本在 CSS 中从上到下运行？

> ID：510068
> 
> 赞同：20
> 
> 时间：2009-02-04T04:30:55.180
> 
> 标签：css, vertical-alignment, text-alignment

有谁知道如何使文本在 div 中从上到下对齐。

所以甚至不会让我演示它。. . 我只希望字母在页面下方垂直堆叠，就像建筑物的故事一样。希望我不需要用图像来做。

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2018-12-02T02:47:35.683

# 让您的文本沿着垂直线运行而无需 HACKS

### `writing-mode`

[CSS`writing-mode`属性](https://developer.mozilla.org/en-US/docs/Web/CSS/writing-mode)让您的文本垂直运行。

```
.traditional-vertical-writing
{
  writing-mode: vertical-rl;
}
```

```
<p class="traditional-vertical-writing">
  This text runs vertically.<br>
  『只是』 （(but the thing is)），since Latin alphabets are not for vertical writing,
  not only the lines but each of the non-vertical-writing letters also gets rotated.<br>
  0123456789
</p>
```

* * *

### `text-orientation`

如果你不希望非垂直书写的字母在垂直线上旋转，你也可以使用[CSS`text-orientation`属性](https://developer.mozilla.org/en-US/docs/Web/CSS/text-orientation)。

```
.vertical-writing
{
  writing-mode: vertical-rl;
  text-orientation: upright;
}
```

```
<p class="vertical-writing">
  This text runs vertically.<br>
  『それに』 （(and in addition)）、now you don't have to turn your head 90 degrees clockwise
  to read these non-vertical-writing letters!<br>
  0123456789
</p>
```

* * *

如果你要做一些*tate-chuu-yoko* ^([[1]](https://ja.wikipedia.org/wiki/%E7%B8%A6%E4%B8%AD%E6%A8%AA) [[2]](https://www.w3.org/TR/jlreq#handling_of_tatechuyoko) [[3]](https://www.w3.org/TR/klreq#h-mixed-vertical))（垂直书写时有点横向书写），

考虑使用[`text-combine-upright`](https://developer.mozilla.org/en-US/docs/Web/CSS/text-combine-upright).

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2013-04-12T00:25:46.103

在保持正常方向的同时使字母从上到下，如下所示：

F

○

○

HTML：

```
<div class="toptobottom">letters</div> 
```

CSS：

```
.toptobottom{
  width: 0;
  word-wrap: break-word;
} 
```

word-wrap 允许单词在中间被打破，所以这将使字母从上到下。它也得到了很好的支持：[https ://developer.mozilla.org/en-US/docs/CSS/word-wrap](https://developer.mozilla.org/en-US/docs/CSS/word-wrap)

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-09-05T12:25:14.940

**html:**

```
<div class="bottomtotop">Hello!</div> 
```

**CSS：**

```
.bottomtotop { transform:rotate(270deg); } 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2020-09-26T09:15:35.987

这是我用过的，它对我有用：

CSS

```
.traditional-vertical-writing
 {
   writing-mode: vertical-rl;
   transform:rotate(180deg);
 } 
```

HTML，记得把你的文字放进去

标签

```
<th rowspan="2" class="text-sm"><p class="traditional-vertical-writing">S/N</p></th> 
```

结果 [![在此处输入图像描述](https://i.stack.imgur.com/TgkQU.png)](https://i.stack.imgur.com/TgkQU.png)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-09-04T15:05:45.850

NJCodeMonkey 的回答很接近。

对我来说，我不得不使用[`word-break`](http://www.w3schools.com/cssref/pr_text_word-spacing.asp). 这[有点](https://stackoverflow.com/a/15137272/839501)不同`word-wrap:break-word;`

所以它看起来像这样。

## HTML：

```
<div class="VerticalText">LongTextWithNoSpaces</div> 
```

## CSS：

```
.VerticalText
{
   width: 1px;
   word-break: break-all;
} 
```

这在 Firefox 24、IE 8 和 IE 11 中对我有用。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2009-02-04T04:35:41.927

根据您的字体大小，进行相应调整：

```
<div style='width:12px'>a b c d</div> 
```

# registry - 通过 WMI 读取的磁盘驱动器属性

> ID：510069
> 
> 赞同：0
> 
> 时间：2009-02-04T04:31:15.930
> 
> 标签：registry, wmi, hard-drive, disk

我正在使用 WMI 来查询一些属性磁盘驱动器。WMI 是从驱动器本身读取此信息还是查询注册表？如何直接从驱动器读取属性？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-04T05:10:25.023

[Win32_LogicalDisk 类](http://msdn.microsoft.com/en-us/library/aa394173.aspx)必须查询实际驱动器。我在 powershell 中使用它来显示驱动器的使用情况，它不包含在注册表中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-04T19:09:19.120

它不必是单一来源。如果 WMi 类的属性具有 MappingStrings 限定符，您可以在那里找到该属性的来源。例如：

Win32_LogicalDisk.VolumeName - Win32API|文件系统函数|GetVolumeInformation

Win32_LogicalDisk.MediaType - Win32API|设备输入和输出函数|DeviceIoControl

Win32_LogicalDisk.NumberOfBlocks - MIB.IETF|HOST-RESOURCES-MIB.hrStorageSize

所以看起来主要是Win32 API和[MIB](http://msdn.microsoft.com/en-us/library/aa379157(VS.85).aspx)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-07-13T14:12:15.740

WMI 直接查询驱动器。特别是，[Win32_DiskDrive](http://msdn.microsoft.com/en-us/library/aa394132(VS.85).aspx)和[Win32_LogicalDisk](http://msdn.microsoft.com/en-us/library/aa394173(VS.85).aspx)类将查询有关驱动器的各种属性。DiskDrive 查询物理属性和配置，而 LogicalDisk 查询驱动器本身的卷和分区（如 C: 等）。并非所有 WMI 属性都会为特定驱动器设置；驱动器可能不支持某些驱动器。

[Scriptomatic](http://www.microsoft.com/downloads/details.aspx?FamilyID=09dfc342-648b-4119-b7eb-783b0f7d1178&displaylang=en)是一个 Microsoft 实用程序，如果您想检查它，可以编写一个快速脚本来提取每个类的所有属性，以及您可能希望的任何其他 WMI 相关的属性。它甚至可以在 Perl 中完成！

# .net - 在“沙盒环境”中从 .Net 应用程序加载程序集

> ID：510071
> 
> 赞同：2
> 
> 时间：2009-02-04T04:31:33.730
> 
> 标签：.net, assemblies, sandbox

我[目前正在开发一个应用程序](https://stackoverflow.com/questions/505040/developing-a-robocode-type-game-with-net-for-a-school-assignment)，用户将在其中动态选择 dll，应用程序将执行该 dll 中的一些方法。（*如果您点击第一个链接，您会看到我正在使用 .Net Framework开发一种[Robocode](http://robocode.sourceforge.net/)*游戏应用程序）。

例如，当战斗开始时，`run`会执行 dll 中的方法。

由于将执行 run 方法中指定的任何内容，因此必须应用相当多的安全约束。

例如，如果编写 dll 的用户不只使用界面中适用的方法（机器人用来行走和射击等的方法），而是调用将检索文件甚至可能删除的方法来自硬盘的文件......当另一个用户将该 dll 加载到他的计算机中时，这些方法将在他的电脑上调用，并且他的文件将被此恶意代码修改。

因此，我需要以某种方式使这个应用程序从一种**沙盒环境**中运行，这样无论调用什么方法，它都不会影响打开 dll 的计算机的硬盘。

关于我应该如何开始这样做的任何想法？

这是一个关于我如何加载这些 dll 并调用它们的方法的示例：

```
for (int i = 0; i < robotList.Count; i++)
{
    IRunnable o = robotList[i];
    new Thread(delegate()
    {
        o.run();    
    }).Start();
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-04T06:21:46.737

通常情况下，你可能只是和

```
AppDomain newDomain = AppDomain.CreateDomain(name);
Assembly asm = newDomain.Load(System.IO.File.ReadAllBytes(name)); 
```

但有趣的一点是，AppDomain.Load 方法会将程序集加载到新的应用程序域*以及当前域。*

更优雅的解决方案是在 3.5 中使用 System.AddIn 命名空间。- [http://msdn.microsoft.com/en-us/magazine/cc163476.aspx](http://msdn.microsoft.com/en-us/magazine/cc163476.aspx)

然后，您实际上可以使用 AddinSecurityLevel 为您的插件指定信任级别

```
//Activate the selected AddInToken in a new
//application domain with the Internet trust level.
Calculator CalcAddIn = selectedToken.Activate<Calculator>(AddInSecurityLevel.Internet); 
```

有关详细信息，请参阅[http://msdn.microsoft.com/en-us/library/bb355219.aspx](http://msdn.microsoft.com/en-us/library/bb355219.aspx)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-04T05:11:36.423

您要做的基本上是在单独的应用程序域中运行程序集。查看 MSDN 上的此页面以获得良好的起点。这实际上是相当东方的事情：

[http://msdn.microsoft.com/en-us/library/ms173139(VS.80).aspx](http://msdn.microsoft.com/en-us/library/ms173139(VS.80).aspx)

# c# - 使用 Windows 服务/Web 应用程序的计时器

> ID：510077
> 
> 赞同：1
> 
> 时间：2009-02-04T04:33:53.897
> 
> 标签：c#, timer

1）在我的应用程序中安排会议。2) 正在为购买一件物品收取分期付款（它有付款到期日）。3) 现在我想向用户发送通知 i) 安排活动我需要在会议时间前 5 分钟发送通知 ii) 付款我需要从一周前到付款到期日发送通知

我的应用程序是一个网络应用程序

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-04T04:46:44.307

> 1）在我的应用程序中安排会议。

将已安排的会议日期永久存储在某个地方（例如，在数据库中）。

> 2) 正在为购买一件物品收取分期付款（它有付款到期日）。

将付款到期日存储在某个持久性位置（例如，在数据库中）。

> 3）现在我想向用户发送通知

通过电子邮件发送通知？或者当他们导航到您的 Web 应用程序时，通过 HTML 向他们的浏览器发送通知？

> i) 对于安排活动，我需要在会议时间前 5 分钟发送通知

偶尔（例如每分钟一次）查询您的数据库以查看哪些用户在接下来的 5 分钟内安排了会议。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-04T05:06:53.627

ASP.NET 不适合这样的事情，因为不能保证您的应用程序将在它需要执行必要处理的那一刻运行。

最好编写 Windows 服务或控制台应用程序（由 Windows 任务计划程序触发）。服务/应用程序可以使用计时器（或轮询/睡眠循环）来检查需要处理的项目。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-04T07:25:48.713

你需要一个像[Quartz.Net这样的调度框架](http://quartznet.sourceforge.net/)

# street-address - 你如何处理重复的街道后缀？

> ID：510078
> 
> 赞同：1
> 
> 时间：2009-02-04T04:34:51.867
> 
> 标签：street-address, abbreviation

我有一个用户需要输入地址的系统。当然，我正在尝试限制重复，我开始注意到一个大问题是一些用户输入“Road”而其他用户输入“Rd”，因此重复出现。

我查看了 USPS 街道后缀缩写列表，但我仍然有一个无法找到答案的问题。我可以用 USPS 标准缩写替换街道地址中的所有单词吗？一个例子是“123 Forest Hill Road”。如果我用缩写来代替它，那么它将是“123 Frst Hl Rd”，或者 USPS 所指的“街道后缀”是否意味着他们只希望您前往“123 Forest Hill Rd”？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-04T04:46:23.370

[USPS 有一个 API](http://www.usps.com/webtools/htm/Address-Information.htm)，可以为您提供格式正确的地址。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-04T04:41:20.683

您必须询问 USPS 才能确定，但​​我想如果您开始用“123 Frst Hl Rd”替换“123 Forest Hill Rd”，您的应用程序和数据将会遇到麻烦。

我已经对地址进行了一些工作，让我告诉你，即使是正确地进行远程操作也是非常复杂和耗时的。在大多数情况下，您最好使用现有的软件包。例如，您会惊讶于通过几个简单的调用免费的 Google Maps API 可以实现什么。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-04T04:43:39.087

您能否通过扩展所有术语而不是尝试缩写任何术语来避免整个问题？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-04T04:44:04.390

在重复项上，只是想知道您是否最好让用户从地址类型的下拉列表中进行选择。将其从用户手中拿走。

关于缩写，您问这个是因为 USPS 需要某种特定格式的地址吗？只是想知道缩写有什么目的。如果我错过了标记，请道歉。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-04T04:55:26.660

您还可以查看 USPS 邮政地址标准，其中解释了各种地址示例的首选和可接受的格式。

[http://pe.usps.gov/text/pub28/pub28c2_toc.htm](http://pe.usps.gov/text/pub28/pub28c2_toc.htm)

在示例案例中，相关部分是 23 Delivery Address Line。

[http://pe.usps.gov/text/pub28/pub28c2_012.htm](http://pe.usps.gov/text/pub28/pub28c2_012.htm)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2011-10-13T01:53:51.127

尝试自己扩展/收缩地址的问题在于，缩写通常可能是*街道*甚至城市名称的一部分。例如：“100 Avenue A”，其中 Avenue 不应缩写。或“900 St Louis Loop”。在这种情况下，St 不是指街道，而是指圣人。

在美国，有一个认证地址的组成部分，称为交货点条形码 (DPBC)。它是一个唯一的 12 位值，可用作地址的唯一标识符。要获得此值，您需要使用地址验证或地址标准化 Web 服务 API，根据您向其发出的请求量，其成本约为 20 美元/月。使用它，您可以轻松防止重复或进行欺诈预防/检测等。

为了全面披露，我是 SmartyStreets 的创始人。我们提供了一个名为 LiveAddress的[地址验证 Web 服务 API 。](http://www.smartystreets.com/Products/LiveAddress-API/)如果您有任何问题，我们非常欢迎您亲自与我联系。

# c++ - 如何从外语线程（C++）调用python函数

> ID：510085
> 
> 赞同：5
> 
> 时间：2009-02-04T04:39:02.747
> 
> 标签：c++, python, multithreading, boost, locking

我正在开发一个使用 DirectShow 从媒体文件中获取音频数据的程序。DirectShow 使用线程将音频数据传递给我程序中的回调函数，我让该回调函数调用 Python 中的另一个函数。

我使用 Boost.Python 来包装我的库，回调函数：

```
class PythonCallback {
private:
    object m_Function;
public:
    PythonCallback(object obj)
        : m_Function(obj)
    {}

    void operator() (double time, const AudioData &data) {
        // Call the callback function in python
        m_Function(time, data);
    }

}; 
```

问题来了，DirectShow的一个线程调用我的PythonCallback，即调用Python中的函数。一旦它调用，我的程序就会崩溃。我发现这应该是线程问题。然后我找到了这个文件：

[http://docs.python.org/c-api/init.html](http://docs.python.org/c-api/init.html)

看来我的程序不能直接从线程调用Python的函数，因为有全局解释器锁。python 的 GIL 太复杂了，我不知道它是如何工作的。对不起，我能做的就是问问。我的问题是。从线程调用 Python 函数之前和之后应该做什么？

它可能看起来像这样。

```
void operator() (double time, const AudioData &data) {
    // acquire lock
    m_Function(time, data);
    // release lock
} 
```

谢谢。维克多·林。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-04T15:06:30.123

看看 PEP 311 [http://www.python.org/dev/peps/pep-0311/中的 PyGILState_Ensure()/PyGILState_Release()](http://www.python.org/dev/peps/pep-0311/)

以下是取自 PEP 本身的示例：

```
void SomeCFunction(void)
{
    /* ensure we hold the lock */
    PyGILState_STATE state = PyGILState_Ensure();
    /* Use the Python API */
    ...
    /* Restore the state of Python */
    PyGILState_Release(state);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-04T04:42:12.960

让 c++ 回调将数据放入队列中。让 python 代码轮询队列以提取数据。

# c# - RichTextBox 控件中的破碎表（自动换行）

> ID：510093
> 
> 赞同：4
> 
> 时间：2009-02-04T04:42:06.500
> 
> 标签：c#, .net, richtextbox, rtf

> **可能重复：**
> [为什么richtextbox 不能正确显示此表？](https://stackoverflow.com/questions/1928853/why-isnt-the-richtextbox-displaying-this-table-properly)

我们在 Visual Studio 2008 中遇到了 Windows.Forms.RichTextBox 控件的问题。

我们正在尝试在 Windows 窗体应用程序 (.NET 3.5) 中显示由第三方作为 RTF 文件提供的文本。在这个 RTF 文本文件中有表格，其中包含跨越多行的文本。使用写字板或 Word 2003 打开时，RTF 文件可以正确显示。

但是，当我们将 RTF 文件加载到 RichTextBox 控件中，或者将整个文本（包括表格）复制并粘贴到控件中时，表格无法正确显示 - 单元格只有单行，没有换行。

以下是显示确切问题的图像的链接：

*   [在写字板中正确显示](http://www.coredumped.de/pics/rtf-good.jpg)

*   [RichTextBox 控件中显示不正确](http://www.coredumped.de/pics/rtf-bad.jpg)

我搜索了解决方案和第 3 方 .net RTF 控件，但没有成功。我在另一个论坛上发现了这个确切的问题，但没有答案（事实上这就是图片链接的来源）所以我希望堆栈溢出做得更好;-)

我首选的解决方案是使用可以正确呈现 RTF 的代码或第 3 方控件。但是，我怀疑问题在于 RichTextBox 控件仅支持完整 RTF 规范的子集，因此另一种选择是直接修改 RTF 以删除不受支持的控制代码或以其他方式修复 RTF 文件本身（在这种情况下，任何信息至于需要删除或修改哪些控制代码将是一个巨大的帮助）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-04T08:01:08.877

.NET 的富文本框非常有问题。

在 RTF 中，定义表格的方式实际上与您习惯使用 HTML 时所期望的完全不同。

HTML：

```
<table>
<tr>
    <td>Mycell</td>
</tr>
</table> 
```

在 RTF 中，表格只是一系列段落，其中包含定义行、单元格和边框的控制字。表格的开始/结束没有组标签。

RTF：

```
\trowd\trgraph \cellx1000 Mycell \cell\row\pard\par 
```

如果要在单元格内添加段落，请使用 \par 和控件 \intbl (in table) 来指示段落在表格内。

.NET RTB 只能处理非常小的 RTF 控制字子集，并且不支持绝大多数可用命令。从表面上看，\intbl 是它不支持的一长串控制字的一部分，如果它实际上解析了 \par ，那么显示就会被破坏。

不幸的是，我没有解决方案，但我希望上面的小解释能帮助你理解这个问题。

不要太相信我的 RTF 样本。它有效，但它绝对是简单的。您可以从 Microsoft 网站下载 RTF 规范： [Word 2007 RTF 规范](http://www.microsoft.com/downloadS/details.aspx?familyid=DD422B8D-FF06-4207-B476-6B5396A18A2B&displaylang=en)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-04T06:42:32.683

您可以使用旧的 COM 控件代替新的 .NET 控件，还是需要“纯”.NET 解决方案？

换句话说，进入 Visual Studio 工具箱，右键单击，选择“Choose Items”，查看 COM Components 选项卡并选中 Microsoft Rich Textbox Control 6.0。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-20T13:35:34.577

Step 1，使用旧的COM Microsoft Rich Textbox Control 6.0；第二步，复制Windows\System32\MsftEdit.dll，然后重命名为riched20.dll；第 3 步，将riched20.dll 复制到您的应用程序文件夹，例如 bin\bebug。这工作正常，表格显示正确。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-06T06:45:49.540

在这里回答我自己的问题，但只是由于 Joel 和 sylverdrag 的帮助......

简短的回答是 .Net 和底层 COM RichTextBox 都不支持表格中的自动换行。我最终敲开了一个测试应用程序并使用了 COM 和 .Net RichTextBox 控件，它们都表现出相同的（损坏的）行为。

我还从 sylverdrag 提供的链接下载了 RTF 规范，在修改了 MS Word 和 RichTextEdit 控件中的手工制作的 RTF 文档后，我可以确认 TichTextBox 不正确支持 \intbl 控制字 - 这是自动换行所必需的表。

似乎有三种可能的解决方案：

1.  使用[TX 文本控制](http://www.textcontrol.com/products/client_side/dotnet/features/)。我已经使用试用版确认了这项工作，但价格昂贵 - 每位开发人员的起价为 549 美元。

2.  [使用Code Project](http://www.codeproject.com/KB/miscctrl/winwordcontrol.aspx?msg=2911786)中讨论的嵌入式 MS Word 实例。请注意，Code Project 上提供的代码示例不是开箱即用的，但我确实让它与 Office 2003 和 VS 2008 一起使用。经过一番折腾后，我们遇到了一个意外的显示停止 - 我们希望文档是只读的所以我们 Protect() 文件。虽然这可行，但当用户尝试编辑文档时，MS Word“保护文档”侧栏会从控件的右侧弹出。我们不能忍受这个，我无法关闭它（从谷歌搜索来看，我并不孤单）。

3.  放弃 RTF 并改用 HTML，然后在 WebBrowser 控件而不是 RichTextEdit 控件中呈现文档。这是我们正在采用的选项，因为事实证明源文档可以以任何一种格式提供。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-04T05:05:10.977

写字板通常是富编辑控件的一个非常薄的包装器，因此如果它在那里正确显示，那么 Windows 应该能够处理它。

也许您正在实例化错误版本的富编辑控件？有很多，Windows 继续提供旧版本以实现向后兼容性。 [http://msdn.microsoft.com/en-us/library/bb787873(VS.85).aspx](http://msdn.microsoft.com/en-us/library/bb787873(VS.85).aspx)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-06-04T09:23:14.520

只需创建一个新控件。这对我来说可以。

```
using System;
using System.ComponentModel;
using System.Windows.Forms;
using System.Runtime.InteropServices;

public class RichTextBox5 : RichTextBox {
  private static IntPtr moduleHandle;

  protected override CreateParams CreateParams {
    get {
      if (moduleHandle == IntPtr.Zero) {
        moduleHandle = LoadLibrary("msftedit.dll");
        if ((long)moduleHandle < 0x20) throw new Win32Exception(Marshal.GetLastWin32Error(), "Could not load Msftedit.dll");
      }
      CreateParams createParams = base.CreateParams;
      createParams.ClassName = "RichEdit50W";
      if (this.Multiline) {
        if (((this.ScrollBars & RichTextBoxScrollBars.Horizontal) != RichTextBoxScrollBars.None) && !base.WordWrap) {
          createParams.Style |= 0x100000;
          if ((this.ScrollBars & ((RichTextBoxScrollBars)0x10)) != RichTextBoxScrollBars.None) {
            createParams.Style |= 0x2000;
          }
        }
        if ((this.ScrollBars & RichTextBoxScrollBars.Vertical) != RichTextBoxScrollBars.None) {
          createParams.Style |= 0x200000;
          if ((this.ScrollBars & ((RichTextBoxScrollBars)0x10)) != RichTextBoxScrollBars.None) {
            createParams.Style |= 0x2000;
          }
        }
      }
      if ((BorderStyle.FixedSingle == base.BorderStyle) && ((createParams.Style & 0x800000) != 0)) {
        createParams.Style &= -8388609;
        createParams.ExStyle |= 0x200;
      }
      return createParams;
    }
  }
  // P/Invoke declarations
  [DllImport("kernel32.dll", SetLastError = true, CharSet = CharSet.Auto)]
  private static extern IntPtr LoadLibrary(string path);

} 
```

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2009-12-28T06:42:06.740

这不是 .net 中提供的 RitchText Control 的问题。新版本的 Ms-office (2007) 中更改了一些 Ritchtext 规则 (Ritchtext Synatax)。但是 .net 中使用的组件无法更新以适应新规则，因此会出现问题。

阿南德

# jquery - MVC 局部视图中的命名约定以避免 ID 冲突

> ID：510097
> 
> 赞同：7
> 
> 时间：2009-02-04T04:44:14.123
> 
> 标签：jquery, asp.net-mvc

任何来自 ASP.NET（MVC 之前）的人都已经习惯于能够为他们的控件提供他们想要的任何 ID。您可以创建`Email`在`.asmx`文件中调用的字段`Email`、在主页中调用的字段`Email`、在母版页中调用的字段，将文件的多个实例`.asmx`放在页面上，它们都会获得自己的唯一 ID。

现在有[一个大问题](https://stackoverflow.com/questions/497802/how-to-stop-asp-net-from-changing-ids-in-order-to-use-jquery)，以前[都讨论过](https://stackoverflow.com/questions/38998/can-i-stop-net-eating-ids)。通常建议的解决方案是“[切换到 MVC](https://stackoverflow.com/questions/46031/why-does-the-asp-net-web-forms-model-suck) ”，您可以在其中控制您的 ID。太棒了！...除了...

...如果你不小心，你最终遇到的问题（在切换到 MVC 之后）类似于以下内容：

*   页面上的两个表单都包含一个带有 `Email`ID 的电子邮件字段。
*   浏览器会很好地呈现（重复的 id 不是“XHTML 允许的”，但它们不会被浏览器拒绝）
*   甚至表单提交也会起作用，因为`FORM`它将自己的相应内容发送到服务器操作。

如果您是一个不关心标准的非常糟糕的程序员，那么您可以逃脱惩罚。但是，如果您开始使用 jQuery 甚至只是`getElementById(..)`：

比方说：

*   您有两个用户控件，一个用于“提交评论”，一个用于“加入邮件列表”。每个`Email`内部都有一个字段。他们每个人都有`id="Email"`
*   您在“提交评论”控件中有 javascript 进行验证：

    ```
    if ( $("#Email").val().indexOf("@") == -1 ) {
        // invalid email 
    } 
    ```

*   哎呀！选择`#Email`器将选择页面上的第一个实例`<input id="Email">`。因此，您最终可能会在提交 SECOND 表单时实际验证 FIRST Email 字段的值。但是检查数据库 - 你会得到正确的值。这可以快速推动您的质量检查；-)

我正在寻找任何人可能想出的任何聪明的技巧。我在问题中发现了一些有趣的想法：[ASP.NET MVC View User Control - how to set IDs](https://stackoverflow.com/questions/265508/asp-net-mvc-view-user-control-how-to-set-ids)但我觉得答案还不够深入，也没有充分利用一些最新的绑定模型。

您可以做一些显而易见的事情，例如始终使用唯一的 IDS，方法是在每个 ID 前加上控制前缀或其他东西。这很快开始看起来像 ASP.NET 1.0 ！

您可以做的另一件事是使用选择器`$('#contatUsForm #Email')`来获取电子邮件 ID。但前提是您对没有 XHTML 感到满意。我认为这个解决方案非常糟糕。事实上，它太糟糕了，我什至没有测试过 jQuery 是否能让你运行它！

[我想出的](https://stackoverflow.com/questions/482763#509965)一件有用的事情（在[sunsean](https://stackoverflow.com/users/60785/sunsean "好的，所以他想出了 - 不是我")的帮助下）是以下 jQuery 函数——我把它放在我的母版页上，并且肯定会一直保留到我拒绝为止。

```
// Warning Duplicate IDs - place on master page in $(function() { ... });
$('[id]').each(function(){
  var ids = $('[id='+this.id+']');
  if(ids.length>1 && ids[0]==this)
    alet('Multiple IDs #'+this.id);
}); 
```

这将帮助您快速找到哪些控件可能会出现此问题，但让我仍在寻找一个优雅的解决方案。

我对与模型绑定结合使用的解决方案特别感兴趣。一旦我开始手动添加前缀，我将开始在所有地方破坏模型绑定。

一定有比我聪明的人已经想通了……

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-04T04:48:12.667

我觉得你想多了。简单的答案是，它们不一样，所以不要给它们相同的 ID。如果它们有相似之处，那就是类的用途。如果一个输入是用于注册时事通讯，则将其称为 NewsletterEmail。如果另一个用于用户登录表单，则将其命名为 UserEmail。使用更具描述性的 ID 是好的 HTML，甚至远不及 Webforms 造成的混乱。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-04T04:54:11.343

就表单字段而言，我认为您将`id`属性与`name`属性混淆了。

您提到的 jQuery 适用于表单字段（稍作调整）：

```
$('#contactUsForm input[name="Email"]') 
```

# c++ - g++ 递归包含所有 /usr/include

> ID：510098
> 
> 赞同：13
> 
> 时间：2009-02-04T04:45:31.407
> 
> 标签：c++, g++

我正在尝试编译一个简单的程序，

```
#include <gtkmm.h> 
```

的路径`gtkmm.h`是`/usr/include/gtkmm-2.4/gtkmm.h`。g++ 看不到这个文件，除非我特别告诉它`-I /usr/include/gtkmm-2.4`。

我的问题是，我怎样才能让 g++ 自动递归地查看所有目录中`/usr/include`包含的所有头文件，为什么这不是默认操作？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-02-04T05:17:49.063

在这种情况下，正确的做法是`pkg-config`在您的`Makefile`或 buildscripts 中使用：

```
# Makefile
ifeq ($(shell pkg-config --modversion gtkmm-2.4),)
  $(error Package gtkmm-2.4 needed to compile)
endif

CXXFLAGS += `pkg-config --cflags gtkmm-2.4`
LDLIBS += `pkg-config --libs gtkmm-2.4`

BINS = program
program_OBJS = a.o b.o c.o

all: $(BINS)

program: $(program_OBJS)
        $(CXX) $(LDFLAGS) $^ $(LOADLIBES) $(LDLIBS) -o $@

# this part is actually optional, since it's covered by gmake's implicit rules
%.o: %.cc
        $(CXX) -c $(CPPFLAGS) $(CXXFLAGS) $< -o $@ 
```

如果你失踪了`gtkmm-2.4`，这将产生

```
$ 制作
在 pkg-config 搜索路径中找不到包 gtkmm-2.4。
也许你应该添加包含 `gtkmm-2.4.pc' 的目录
到 PKG_CONFIG_PATH 环境变量
找不到包“gtkmm-2.4”
Makefile:3: *** 包 gtkmm-2.4 需要编译。停止。
```

否则，您将获得所有适当的路径和库，而无需手动指定它们。（检查`pkg-config --cflags --libs gtkmm-2.4`: 的输出，这远远超过您想要手动输入的内容。）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-04T05:02:41.123

我猜你没有使用makefile？唯一可能令人讨厌的是*每次*编译程序时都必须输入 long -I 选项。makefile 使它变得容易得多。

例如，您可以将[wikipedia中的](http://en.wikipedia.org/wiki/Make_(software))*hello world* makefile修改为如下内容：

```
INC=-I/usr/include/gtkmm-2.4/

helloworld: helloworld.o
    g++ -o $@ $<

helloworld.o: helloworld.c
    g++ $(INC) -c -o $@ $<

.PHONY: clean

clean:
    rm -f helloworld helloworld.o 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-04T04:53:11.017

你不能。包含路径的全部意义在于您可以选择所需的内容和版本。

你能做的是..

```
#include <gtkmm-2.4/gtkmm.h> 
```

这将达到相同的效果。

# windows - RealGetWindowClass 和 GetClassName 有什么区别？（或者什么是“窗口类型”与“窗口类名”？）

> ID：510106
> 
> 赞同：5
> 
> 时间：2009-02-04T04:50:25.657
> 
> 标签：windows, user-interface, winapi

MSDN上的描述有所不同，但是，我不明白文字的含义是什么。

该`GetClassName`函数检索指定窗口所属的类的名称。RealGetWindowClass 函数检索指定窗口类型的字符串。

例如使用 windows calc.exe
从 GetClassName 你得到“SciCalc”
从 RealGetWindowClass 你得到“#32770”

我想我真正要问的是什么是“窗口类型”与“窗口类名”？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-04T05:00:32.797

请参阅以下文章：[http](http://forums.wincustomize.com/3258) : //forums.wincustomize.com/3258 deadlink 更新链接[https://blogs.msdn.microsoft.com/oldnewthing/20101231-00/?p=11863](https://blogs.msdn.microsoft.com/oldnewthing/20101231-00/?p=11863)

**摘要：**
添加了 Real... 函数以支持 Windows 可访问性。RealGetWindowClass 的目标是帮助辅助工具识别它正在使用哪种类型的窗口，即使应用程序以超类的形式做了一些伪装。

如果您向 RealGetWindowClass 询问窗口的类名，它会挖掘所有超类并返回基类的名称（如果基类是标准窗口管理器类之一）。例如，如果您的应用程序超类化了按钮类，则对 GetClassName 的调用将返回 AwesomeButton，但对 RealGetWindowClass 的调用将返回按钮。

# sql-server - 删除后在 SQL Server 中重置 AutoIncrement

> ID：510121
> 
> 赞同：310
> 
> 时间：2009-02-04T05:00:27.650
> 
> 标签：sql-server, auto-increment, delete-row

我已经从 SQL Server 数据库的表中删除了一些记录。

表中的 ID 如下所示：

> 99 100 101 1200 1201...

我想删除后面的记录（ID > 1200），然后我想重置自动增量，以便下一个自动生成的 ID 为 102。所以我的记录是连续的，有没有办法在 SQL Server 中做到这一点？

* * *

## 回答 #1

> 赞同：521
> 
> 时间：2009-02-04T05:05:24.347

发出以下命令以重新设置 mytable 以从 1 开始：

```
DBCC CHECKIDENT (mytable, RESEED, 0) 
```

在在线书籍（BOL、SQL 帮助）中阅读有关它的信息。另请注意，您的记录不要高于您设置的种子。

* * *

## 回答 #2

> 赞同：102
> 
> 时间：2012-06-20T08:09:11.120

```
DBCC CHECKIDENT('databasename.dbo.tablename', RESEED, number) 
```

如果 number=0 则在下一次插入中，自动增量字段将包含值 1

如果 number=101 那么在下一次插入中，自动增量字段将包含值 102

**一些附加信息... 可能对您有用**

在上述查询中给出自动增量之前`number`，您必须确保现有表的自动增量列包含的值小于`number`.

要从表（table1）中获取列（column_name）的最大值，可以使用以下查询

```
 SELECT MAX(column_name) FROM table1 
```

* * *

## 回答 #3

> 赞同：46
> 
> 时间：2012-05-01T18:31:28.263

半白痴：

```
declare @max int;  
select @max = max(key) from table;  
dbcc checkident(table,reseed,@max) 
```

[http://sqlserverplanet.com/tsql/using-dbcc-checkident-to-reseed-a-table-after-delete](http://sqlserverplanet.com/tsql/using-dbcc-checkident-to-reseed-a-table-after-delete)

* * *

## 回答 #4

> 赞同：22
> 
> 时间：2013-06-28T10:52:46.113

如果您使用的是 MySQL，请尝试以下操作：

```
ALTER TABLE tablename AUTO_INCREMENT = 1 
```

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2009-02-04T05:12:06.067

我想到了。它的：

```
 DBCC CHECKIDENT ('tablename', RESEED, newseed) 
```

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2014-03-17T07:59:53.817

删除并重新设置数据库中的所有表。

```
 USE [DatabaseName]
    EXEC sp_msforeachtable "ALTER TABLE ? NOCHECK CONSTRAINT all"       -- Disable All the constraints
    EXEC sp_MSForEachTable "DELETE FROM ?"    -- Delete All the Table data
    Exec sp_MSforeachtable 'DBCC CHECKIDENT(''?'', RESEED, 0)' -- Reseed All the table to 0
    Exec sp_msforeachtable "ALTER TABLE ? WITH CHECK CHECK CONSTRAINT all"  -- Enable All  the constraints back

-- You may ignore the errors that shows the table without Auto increment field. 
```

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2016-04-07T12:58:01.087

根据接受的答案，对于那些遇到类似问题且具有完整架构资格的人：

( `[MyDataBase].[MySchemaName].[MyTable]`)... 导致错误，您需要在该数据库的上下文中

也就是说，以下将引发错误：

```
DBCC CHECKIDENT ([MyDataBase].[MySchemaName].[MyTable], RESEED, 0) 
```

用单引号将完全限定的表名括起来：

```
DBCC CHECKIDENT ('[MyDataBase].[MySchemaName].[MyTable]', RESEED, 0) 
```

* * *

## 回答 #8

> 赞同：6
> 
> 时间：2017-04-02T20:59:58.163

几个答案建议使用类似这样的语句：

```
DBCC CHECKIDENT (mytable, RESEED, 0) 
```

但是 OP 说“删除了一些记录”，这可能不是全部，所以值 0 并不总是正确的。另一个答案建议自动找到最大当前值并重新设置该值，但如果表中没有记录，则会遇到麻烦，因此 max() 将返回 NULL。建议使用简单的评论

```
DBCC CHECKIDENT (mytable) 
```

重置该值，但另一条评论正确地指出，这只会将值增加到表中已有的最大值；如果它已经高于表中的最大值，这不会减少值，这是 OP 想要做的。

一个更好的解决方案结合了这些想法。第一个 CHECKIDENT 将值重置为 0，第二个将其重置为表中当前的最大值，以防表中有记录：

```
DBCC CHECKIDENT (mytable, RESEED, 0)
DBCC CHECKIDENT (mytable) 
```

正如多条评论所指出的，确保其他表中没有指向已删除记录的外键。否则，这些外键将指向您在重新设置表后创建的记录，这几乎肯定不是您的想法。

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2017-10-21T09:47:44.463

我想添加这个答案，因为`DBCC CHECKIDENT`当您将模式用于表时，-approach 会产生问题。使用它来确保：

```
DECLARE @Table AS NVARCHAR(500) = 'myschema.mytable';
DBCC CHECKIDENT (@Table, RESEED, 0); 
```

如果要检查操作是否成功，请使用

```
SELECT IDENT_CURRENT(@Table); 
```

应该`0`在上面的示例中输出。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-02-05T19:09:57.370

您一般不希望这样做。Reseed 会造成数据完整性问题。它实际上仅适用于您要清除所有测试数据并重新开始的开发系统。如果尚未删除所有相关记录，则不应在生产系统上使用它（并非每个应具有外键关系的表！）。这样做可能会造成混乱，特别是如果您打算在每次删除后定期执行此操作。担心身份字段值的差距是个坏主意。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2021-10-30T22:00:20.530

要将数据库中的每个键重置为从最后一个最高键的最大值自动递增：

```
Exec sp_MSforeachtable 'DBCC CHECKIDENT(''?'', RESEED, 0)'

Exec sp_MSforeachtable 'DBCC CHECKIDENT(''?'', RESEED)' 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2019-03-05T00:17:01.607

那这个呢？

```
ALTER TABLE `table_name`
  MODIFY `id` int(12) NOT NULL AUTO_INCREMENT, AUTO_INCREMENT=0; 
```

这是将自动增量更改为 0 或您想要的任何数字的快速简单的方法。我通过导出数据库并自己阅读代码来解决这个问题。

您也可以这样编写它以使其成为单行解决方案：

```
ALTER TABLE `table_name` MODIFY `id` int(12) NOT NULL AUTO_INCREMENT, AUTO_INCREMENT=0; 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2021-06-11T16:56:13.713

如果您只想重置主键/序列以在 SQL 服务器中以您想要的序列开头，这里是解决方案 -

标识：

> 99 100 101 1200 1201...

1.  删除 ID >= 1200 的行。（如果您有与这些相关的外键约束，必须处理或删除这些约束才能删除它。）
2.  现在您要确保您知道 MAX ID 以确保：

> 将@max_id 声明为 int = (SELECT MAX( *your_column_name* ) FROM *your_table* )+1;

（注：+1 表示最大值后的 ID 序列）

3.  重新启动您的序列：

> exec('alter sequence *your_column_name* restart with ' + @max_id);

（注意：with 后面的空格是必须的） 现在新记录将以**102**作为 ID 开头。

# prototype - 一个简单而强大的网站地图设计工具？

> ID：510128
> 
> 赞同：2
> 
> 时间：2009-02-04T05:05:02.757
> 
> 标签：prototype, user-interface, sitemap

我只需要将站点地图绘制为文档。Visio 概念站点地图是一种矫枉过正且不友好的做法。我还没有尝试过概念图。我正在寻找的是一个简单的精简工具。如果我可以制作 flash 或 exe 导出，以便将其发送给客户端，那就太好了。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2011-04-13T09:07:04.873

我更喜欢[XMind](http://www.xmind.net/)来完成这种任务。它是免费的，而且非常好，并且适用于所有主要平台。

XMind 示例：

![在此处输入图像描述](https://i.stack.imgur.com/bNnMt.png)

如果您在 Mac 下工作，您也可以尝试使用[Omnigraffle](http://www.omnigroup.com/products/omnigraffle/)来完成此类任务。但它要花钱。但这绝对值得。:)

[yED](http://www.yworks.com/en/products_yed_about.html)也很酷。它是免费的。这是通过 yEd 完成的：

![用 yEd 完成的结构](https://i.stack.imgur.com/fO93I.png)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2011-08-28T09:30:50.520

对于我的尝试，思维导图是规划站点地图的最简单方法。这似乎是表现力和易用性（以及低学习曲线）的正确平衡。

我现在正在使用[FreeMind](http://freemind.sourceforge.net/wiki/index.php/Main_Page)设计我的站点地图。

*   我能够在不到 1 小时内开始有效地使用它
*   它真的很容易使用和高效（只需几个按键即可操作）
*   注释部分非常适合写下页面的妙语
*   最后但并非最不重要的一点是，它是在 Java 中，所以跨平台

该工具非常适合其主要目的 - 思维导图。最终结果在图形上并不吸引人。在上方，您可以将地图导出为各种便携式/独立格式（HTML/Java 小程序/Flash）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-08-21T16:51:15.083

我也喜欢freemind。该工具有一个粗略的用户界面，但键盘快捷键使得构建思维导图的速度非常快。我对在其中制作站点地图（我目前正在这样做）的一个小问题是它希望您的层次结构向左或向右流动，我希望我的站点地图向下流动。

我还想要一个工具，它允许我为站点地图中的每个页面添加多条信息，例如标题、网址、元描述、关键字等。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-02-20T13:54:44.307

我尝试了很多工具，但[Google Docs Drawings](http://docs.google/drawings)似乎是最好的。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-11-25T07:59:43.757

我的建议是[http://creately.com](http://creately.com)简单且免费试用。还提供了例子！

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-07-28T13:44:49.293

如果您对独立应用软件不严格。

**和**

如果您希望使用 Web 技术开发站点地图行为。我可以给你几个选项。

这里的优势是您可以及时向您的客户提供直接**的网络链接**。

一些很酷的选项如下：

**1\. JS - 思维导图**

样品预览：

![在此处输入图像描述](https://i.stack.imgur.com/ZBSIg.png)

它是基于**jquery**的库。有良好的动画备份。很适合做简单的思维导图。**加上开源。**

链接：- [https://github.com/kennethkufluk/js-mindmap](https://github.com/kennethkufluk/js-mindmap)

**______________________________________________________________________________________**

**2 JS 铅垂**

样品预览：

[此处](http://jsplumbtoolkit.com/demo/chart/jquery.html)提供了许多预览选项。一个样本如下。

![在此处输入图像描述](https://i.stack.imgur.com/Q7DPI.png)

JS Plumb 库使我们能够以管道工的方式开发东西。他们有各种选项 Pipes 、 Nodes 、 Endpoints 等。它可以在各种技术中实现，如 JQuery 、 Mootools 等。 **此外，它在 MIT 许可证下是开源的。**

链接：- [http://jsplumbtoolkit.com/doc/home.html](http://jsplumbtoolkit.com/doc/home.html)

**______________________________________________________________________________________**

**3.乔木JS**

样品预览：

![在此处输入图像描述](https://i.stack.imgur.com/6ygEL.png)

Arbor 是一个使用 Web Worker 和 jQuery 构建的图形可视化库。arbor 并没有试图成为一个包罗万象的框架，而是提供了一种高效的、强制导向的布局算法以及用于图形组织和屏幕刷新处理的抽象。

链接：[https ://github.com/samizdatco/arbor](https://github.com/samizdatco/arbor)

**_____________________________________________________________________________________**

除此之外，还有一些其他的建议......

**Infovis** - [http://philogb.github.io/jit/static/v20/Jit/Examples/Spacetree/example1.html](http://philogb.github.io/jit/static/v20/Jit/Examples/Spacetree/example1.html)

**d3.js** - [http://d3js.org/](http://d3js.org/)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2018-07-24T14:01:16.530

无论您的操作系统如何，您都可以使用可用的基于云的应用程序之一。我正在使用 Slickplan。它具有许多高级功能，例如站点爬虫、设计模型、流程图制作器、通过社交媒体共享、Basecamp、团队合作；以多种文件格式导出。我什至可以与我的客户实时合作并使用聊天进行交流。他们还提供多种计划，因此您可以根据需要进行调整。

# templates - Web 开发者的项目模板目录

> ID：510129
> 
> 赞同：18
> 
> 时间：2009-02-04T05:05:02.850
> 
> 标签：templates, performance, project

**重要提示：**接受的答案在赏金后被接受，不一定是因为我认为这是最好的答案。

* * *

我发现自己在开始新项目时一遍又一遍地做事。我创建了一个包含子文件夹的文件夹，然后复制一些标准项目，如 css 重置文件、famfamfam 图标、jquery 等。

这让我想到了理想的起始模板是什么。我问的原因是我再次经历并且想知道我应该在我的模板中包含什么，这样我就不必在将来返回并在我开始的每个新网站上重新做一遍.

我目前拥有的如下：

项目模板文件夹

*   index.html *-- XHTML 1.0 严格的文档类型。元标签。引用的 CSS/js 文件。*
*   css/
    *   default.css——*空的。为用户样式保留。*
    *   [960](http://www.960.gs) / *-- 960 用于 CSS 布局的网格系统。*
        *   960.css
        *   重置.css
        *   文本.css
*   js/
    *   default.js——*空的。为用户脚本保留。*
    *   [jQuery](http://www.jquery.com) / *-- 轻量级 Javascript 框架*
        *   jquery-1.3.1.min.js
*   图片/
    *   [famfamfam](http://www.famfamfam.com) / *-- 优秀的 png 图标集合*
        *   图标/
            *   接受.png
            *   添加.png
            *   ...ETC

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-04T09:40:28.613

我有类似的结构和命名约定，但对于 CSS，我使用[BluePrint](http://www.blueprintcss.org/)，我发现它更具可扩展性。也更喜欢最近从原型切换的jQuery。此外，我还有一个 common.js 文件，它是一个带有 jQ​​uery 自定义函数的扩展。

包含架构定义的 .sql 文件的 /db/ 文件夹。用于常见中间层库的 /lib/ 文件夹。

我还将有一个 /src/ 文件夹，其中有时会包含原始文件，例如 Photoshop 模板、自述文件、待办事项列表等。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-11T18:11:06.463

如果您有很多具有很多共同静态内容的项目（例如 jquery、css 框架等），请让自己成为服务所有这些的媒体服务器。然后，您无需从“模板”创建一堆文件夹结构，而是在项目的 html 中包含正确的文件。如果你真的想要一个模板，你的模板变成一个 html 文件而不是一个目录结构。

这也为您提供了一种为您的站点更新静态媒体的简单方法（例如，迁移到 960 的下一个版本）。你只需要在一个地方做。当然，您仍然必须确保您的更新不会破坏现有网站！:)

如果某些项目有重叠的需求但与其他项目不同，您可以使该方案更复杂一些。只需在服务器的顶层为每个设置创建一个目录，并且每个设置对应一个 html“模板”。主要思想是只需要处理所有常见内容的一个副本。

您当然可以在小型 VM（例如[linode](http://linode.com)）上以 20 美元/月的价格执行此操作，或者在您当前的 Web 服务器上使用虚拟 Web 服务器。您实际上并不需要服务器，就此而言，您只需要一个文件夹。但是，我认为您可以通过拥有专用媒体服务器获得一些显着的性能提升。为此，我建议使用经过微调的 apache 或[nginx 。](http://linode.com)

至于特定于站点的静态文件，它们位于媒体服务器上也是一个好主意，并且目录结构可能正是您所拥有的，但它们将/应该是空目录。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-12T11:21:14.987

我的 Web 开发框架位于 git 存储库中。通用代码，例如通用 PHP 类在 master 分支中开发。特定网站的所有工作都在一个分支上完成，然后将有助于未来工作的更改合并回 master。

这种方法对我很有效，因为我对所有网站都有完整的版本控制，如果我在分支上工作时碰巧修复了错误或实现了新功能，我可以进行合并，然后一切都会受益。

这是我的模板的样子：

```
/
|-.htaccess            //mod_rewrite skeleton
|-admin/               //custom admin frontend to the CMS
|-classes/             //common PHP classes
|-dwoo/                //template system
|-config/              //configuration files (database, etc)
|-controllers/         //PHP scripts that handle particular URLs
|-javascript/
      |-tinyMCE/
      |-jquery/
|-modules              //these are modules for our custom CMS
      |-news/
      |-mailing_list/
      |-others
|-private/             //this contains files that won't be uploaded (.fla, .psd, etc)
      |-.htaccess      //just in case it gets uploaded, deny all
|-templates/           //template source files for dwoo 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-12T23:29:24.410

我使用类似的布局，但有一个主要例外：所有这些目录都位于顶级 media/ 目录下。这有几个原因：

1.  这个目录被同步到另外两个处理所有静态媒体请求的服务器。
2.  拥有多个主机允许某些浏览器对支持文件发出更多并行请求。
3.  media/ 目录有自己的 .htaccess 文件，该文件从路径中剥离了一个伪目录，该路径是图像（或其他任何内容）的最后修改日期时间。

一个自定义模板标签（我在 2 个 Django 项目中使用过这个，但你可以在 PHP 等中做到这一点）生成 url，其中 a) 半随机选择一个媒体服务器，b) 添加基于时间的伪目录到路径，并且 c) 给对象一个现在 + 10 年的过期时间。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-04T18:46:50.913

我觉得结构很好。添加一些其他文件夹取决于您正在完成的工作类型。

对于自由职业者等，添加 PSD 文件夹、客户评论将是一个不错的补充。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-11T11:42:04.183

一个非常 MS 倾斜的观点，但我现在的 SOP 大致如下：

*   文件/
    *   架构/（你可能称之为代码文档）
    *   通讯/（重要的客户文档）
    *   规格/
    *   白皮书/
*   图形/
    *   *.psd
*   来源/

    *   com.mycompany.projectname.solutionA/
    *   com.mycompany.projectname.solutionB/
    *   com.mycompany.projectname.solutionC/
    *   com.mycompany.projectname.solutionX/ *（这里是商业意义上的项目）*

        *   商业逻辑/
            *   *.cs *（或其他）*
        *   *（进一步的项目——在视觉工作室的意义上）*
        *   地点/

            *   handlers/ *（这些天我很少使用实际的.html）*
            *   模块/
            *   资源/

                *   img/ *(pngs jpegs, gifs 随便)*

                    *   皮肤/
                        *   图标/
                        *   背景/
                *   js/ *（发布时压缩）*

                    *   库/ *（标准代码）*
                    *   common/ *（应用程序特定代码）*
                    *   *.js *（应用程序特定代码，希望为零）*
                *   css/
                    *   skinX/ *（即使只有“默认”）*
                        *   扩展名.css
                    *   base.css
                *   transforms/ *（总是通过配置或构建过程对公众隐藏）*
                    *   *.xslt
        *   单元测试/
            *   模拟/
            *   testmain.cs（或其他）
*   第三方/
    *   依赖关系

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-02-12T01:56:41.070

我绝对喜欢拥有这样一个骨架模板文件夹的想法，但如果您使用几种不同的技术，一定要密切注意结构。与 PHP 相比，我的 VB.net 文件夹结构具有完全不同的设置。这听起来像是常识，但我看到人们以同样的方式处理这两种方法。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-02-12T12:34:40.693

在工作中，我们使用 Code Igniter 作为我们 Web 应用程序的 PHP 框架，并创建了一个新的项目模板，它正是这样做的：简单的目录结构、Blueprint CSS、jQuery 和 Code Igniter 应用程序文件夹，其中包含几个常用库（身份验证，常用数据库的一些特殊模型...）。

这里的主要座右铭是：*删除组件总是比添加组件更容易。所以填写你的模板。*

（当我在业余时间开始一个新项目时，我非常想念那个模板......）

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-02-12T14:45:37.023

我认为您在这里拥有的东西很棒......您列出的内容当然都是关于您的应用程序的公共前端。我对此的唯一补充是尽可能将所有后端代码和源代码保留在公共网络空间之外，因为公共空间中的东西越少，应用程序就越安全。

所以我建议你把你的整棵树放进去：

```
httpdocs/(all you had in your project template folder) 
```

然后将所有后端代码（例如 php 库、sql 文件等）放在相邻的子目录中：

```
httpdocs/(all you had in your project template folder)
phplibs/
sql/ 
```

等等

而且，即使对于您的前端内容，请确保您不要复制任何可能与您的前端库一起提供的示例文件，因为示例本身可能存在安全问题，允许人们使用 XSS 或以其他方式危害您的网站。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-02-12T19:39:14.917

我已经使用以下设置一段时间了，效果很好：

*   /site：这是我实际工作网站所在的位置。创建模板后，我将在此目录中安装我的 CMS 或平台。
    *   .htaccess *（我通常会发现自己启用的基本调整）*
    *   robots.txt *（所以我以后不要忘记禁止 /admin 之类的项目）*
*   /source: 包含任何comps、notes、documents、specifications等。

*   /模板：从这里开始！创建最终需要移植到 CMS 或 /site 框架中的所有静态模板。

    *   /行为
        *   global.js *（特定于站点的代码；可以根据需要分解为多个文件）*
    *   /media：图像、可下载文件等。根据需要进行组织

    *   /style：我更喜欢模块化 CSS 开发，所以我通常会为网站的每个独特部分制作许多样式表。[Blender](http://github.com/cgriego/front-end-blender/tree/master)可以很好地清理这个问题 - 我强烈推荐这个工具！

        *   behavior.css *（任何需要支持 JS 的浏览器的样式）*
        *   print.css *（最终会被混合，所以使用@media print）*
        *   reset.css *（[埃里克迈耶的](http://meyerweb.com/eric/tools/css/reset/)）*
        *   screen.css *（用于@media screen，手持）*
    *   /vendor：所有第 3 方代码（jQuery、shadowbox 等）

    *   Blendfile.yaml *（用于 Blender；见上文）*

    *   template.html *（基本起始模板；可以为每个唯一模板复制和重命名）*

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-02-13T04:59:25.757

我喜欢将 OP 作为默认起点。您的标准模板应该在简单性上犯错，只有在需要时才能增加复杂性。

一项补充：

/机器人.txt

# python - 创建空白字段并使用 sqlite、python 接收 INTEGER PRIMARY KEY

> ID：510135
> 
> 赞同：3
> 
> 时间：2009-02-04T05:06:34.720
> 
> 标签：python, sqlite

我在 python 中使用 sqlite。当我插入表 A 时，我需要从表 B 中为其提供一个 ID。所以我想做的是将默认数据插入 B，获取 id（这是自动递增的）并在表 A 中使用它。什么是最好的方法从我刚刚插入的表中接收密钥？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-04T05:34:27.050

正如克里斯蒂安所说，`sqlite3_last_insert_rowid()`这就是你想要的......但那是 C 级 API，你正在使用 SQLite 的 Python DB-API 绑定。

看起来游标方法`lastrowid`会做你想做[的事（在文档中搜索“lastrowid”以获取更多信息）](http://docs.python.org/library/sqlite3.html)。用 插入您的行`cursor.execute( ... )`，然后执行类似`lastid = cursor.lastrowid`检查最后插入的 ID 的操作。

*你说你需要“一个”ID 让我担心，不过……你拥有哪个*ID并不重要？除非您将刚刚插入 B 的数据用于某事，在这种情况下您需要*该*行 ID，否则如果您只需要表 B 的任何旧行 ID，您的数据库结构就会严重搞砸。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-04T05:28:16.220

查看[sqlite3_last_insert_rowid()](http://www.sqlite.org/c3ref/last_insert_rowid.html) - 这可能是您正在寻找的：

> SQLite 表中的每个条目都有一个唯一的 64 位有符号整数键，称为“rowid”。只要显式声明的列未使用这些名称，rowid 始终可用作名为 ROWID、OID 或 _ROWID_ 的未声明列。如果表具有 INTEGER PRIMARY KEY 类型的列，则该列是 rowid 的另一个别名。
> 
> 此例程从第一个参数中的数据库连接返回最近成功 INSERT 到数据库中的 rowid。如果该数据库连接上从未发生过成功的 INSERT，则返回零。

希望能帮助到你！（有关 ROWID 的更多信息可[在此处](http://www.sqlite.org/lang_createtable.html#rowid)和[此处](http://www.sqlite.org/lang_corefunc.html)获得。）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-04T14:36:36.737

只需使用：

```
SELECT last_insert_rowid(); 
```

但是，如果您有多个连接写入数据库，您可能无法取回您期望的密钥。

# c# - 编程技能测试员（问题）

> ID：510138
> 
> 赞同：1
> 
> 时间：2009-02-04T05:07:24.547
> 
> 标签：c#, winforms

我正在开发一个程序，该程序将根据 Code Complete 第 2 版中的 32 个主题来判断程序员处于初级、中级或专家的哪个级别。我正在使用 32 个复选框和一种方法来判断哪些是被点击的。问题是，当我检查复选框的选中属性是否等于 true 时，它​​会在复选框实际被选中之前得到结果。这是我所有的源代码（到目前为止）：

```
public partial class Main : Form
{
    private int baseScore = 0;

    public Main()
    {
        InitializeComponent();
    }

    private void buttonCalculateScore_Click(object sender, EventArgs e)
    {
        DetermineLevelOfProgrammer();
    }

    private void DetermineLevelOfProgrammer()
    {
        if ((baseScore >= 0) || (baseScore <= 14))
        {
            labelYourScore.Text += " " + baseScore.ToString();
            labelDescription.Text = "You are a beginning programmer, probably in your first year of computer \n"+
                                    "science in school or teaching yourself your first programming language. ";
        }

        // Do the other checks here!

    }

    // If checkbox is checked then increment base score,
    // otherwise decrement base score.
    private void checkBoxVariant_CheckedChanged(object sender, EventArgs e)
    {
        if (checkBoxVariant.Checked)
            baseScore++;
        else
            baseScore--;
    }
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-04T05:51:03.693

我不确定 checkBoxVariant 是什么，但是......

我认为问题在于 checkBoxVariant 只是 32 个 CheckBox 中的 1 个。我假设您将所有 32 个 CheckChanged 事件连接到 checkBoxVariant_CheckedChanged 方法。

它应该是这样的：

```
// If checkbox is checked then increment base score,
// otherwise decrement base score.
private void checkBoxVariant_CheckedChanged(object sender, EventArgs e)
{
   if (((CheckBox)sender).Checked)
      baseScore++;
   else
      baseScore--;
} 
```

sender 是一个 Object，它指向引发事件的实际 Object。由于任何事情都可能引发事件，因此它只是一个必须强制转换为 CheckBox 的对象。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-02-04T05:51:59.790

if ((baseScore >= 0) || (baseScore <= 14))

小心 - 这将始终评估为真。您可能打算使用 &&。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-04T05:15:44.733

CheckedChanged 事件仅应在检查后触发，因此我认为这不是您的问题。但是，也许您应该在单击提交按钮后选中所有复选框，这样可能会更简单。

# perl - 如何在不先选择记录的情况下在 Class::DBI 中进行更新？

> ID：510139
> 
> 赞同：5
> 
> 时间：2009-02-04T05:09:47.193
> 
> 标签：perl, class-dbi

要使用 Class::DBI 进行插入，您可以简单地执行以下操作：

```
my $object = Object::DB->insert({ a => 1, b => 2, c => 3, ...}); 
```

但是没有这样的更新。我能想到的最好的办法是先选择记录然后更新它：

```
my $object = Object::DB->retrieve($id);
my $object->set( a => 1, b => 2, c => 3, ...};
$object->update; 
```

这效率不高，因为我必须先执行 SELECT，然后执行 UPDATE 而不是仅执行一次 UPDATE。

Class::DBI 有没有更好的方法来做到这一点？我不想做 42 $object->a(1), $object->b(2), etc., $object->update;

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-04T13:43:39.887

据我所知，Class::DBI 没有很好的方法来做到这一点，正如您所指出的，它的`update()`方法是在以前从数据库加载的对象上调用的。

但是，您可以通过以下方式说服 Class::DBI 做您想做的事情：

```
# Make new "empty" object
my $o = My::CDBI::Object->new;

# Set the primary key column and discard the change
$o->set(your_pk_column => 123);
$o->discard_changes;

# Set your other columns
$o->set(a => 'foo', b => 'bar');

# Do the update
$o->update; 
```

如果此功能对您很重要，并且您的项目还没有走得太远，那么使用较新的 Perl ORM 之一（例如[Rose::DB::Object](http://www.perlfoundation.org/perl5/index.cgi?rose_db_object)或[DBIx::Class](http://www.perlfoundation.org/perl5/index.cgi?dbix_class) ）肯定会更好。DBIx::Class 甚至包括[一个 Class::DBI 兼容层](http://search.cpan.org/dist/DBIx-Class/lib/DBIx/Class/CDBICompat.pm)。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-04T14:33:00.380

我发现这样做的一种方法是覆盖对象的默认迭代器类。这允许您使用集合上的更新方法来拥有单个对象的集合。Class::DBI 为此提供了一个方法：

```
__PACKAGE__->iterator_class('MyClass::CDBI::Iterator'); 
```

这允许您`update`在迭代器类中创建一个方法，该方法可以保存集合中的所有对象。因此，您的代码可能如下所示：

```
my $collection = Object::DB->search_where({id => {'>=', 0}});
foreach my $obj ($collection->next()) {
  $obj->a('bob');
  $obj->b('tom');
}
$collection->update(); 
```

这使得一些非常好的自我记录的代码。如果你走这条路，我还建议`is_changed`在 update() 发生时将该方法投入使用。它将通过不更新未更改的行来帮助您节省时间。

# iphone - iPhone 上原始 PCM 的有损压缩格式

> ID：510145
> 
> 赞同：3
> 
> 时间：2009-02-04T05:11:09.063
> 
> 标签：iphone, audio, pcm, codec

`unsigned char`我想从一个文件大小适中的音频文件开始，并以一个可以加载到 OpenAL中的 s 数组结束`alBufferData`。我的麻烦是中间发生的步骤。

我认为 AAC 将是要走的路，但根据 Apple 代表[Rincewind](https://devforums.apple.com/message/18257#18257)（大约 12/08）的说法：

> iPhone OS 目前不支持硬件辅助压缩格式进行解码。这些格式是 AAC、MP3 和 ALAC。

与客户端格式集一起使用`ExtAudioFile`会产生PERM错误，所以他没有编造。

所以，勇敢的知识拥有者，我在这里有什么选择？将应用程序与 .wav 打包在一起，然后下载大量文件？自己写解码器？

任何指向您可能拥有的资源或建议的链接将不胜感激。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-22T09:22:22.823

现在可以离线渲染压缩音频，请参阅[QA1562](http://developer.apple.com/iphone/library/qa/qa2009/qa1562.html)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-09T06:31:10.697

虽然 Vorbis 和其他人的建议很好，但它们在 iPhone 上可能相当慢，因为没有硬件加速。

一种本机支持的编解码器（但压缩比只有 4:1）是 ADPCM，即 ima4。它是通过 ExtAudioFile 接口处理的，并且只比直接加载 .wav 慢一点。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-04T05:57:32.353

您可以使用一些不错的开源音频解码库：

*   [mpg123](http://www.mpg123.de/)
*   [FAAC](http://www.audiocoding.com/faac.html)

两者都在 LGPL 下获得许可，这意味着您可以在封闭源代码的应用程序中使用它们，只要对库的修改（如果有的话）是开源的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-04T05:18:15.397

您总是可以将您的波形文件设为单声道，从而将您的波形文件大小减半。但这可能不是您的最佳选择

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-04T21:20:54.020

自己解码的另一个选择是[Ogg Vorbis](http://xiph.org/vorbis/)。他们甚至还有一个用于整数处理器的低内存版本的库，称为[“Tremor”](http://svn.xiph.org/branches/lowmem-branch/Tremor/)。

# sql - 从 SQLDataReader 填充数据集的最佳方法

> ID：510153
> 
> 赞同：8
> 
> 时间：2009-02-04T05:18:14.320
> 
> 标签：sql, dataset, sqldatareader

我正在研究异步获取 DataReader 的 DAL。

我想编写一个将 DataReader 转换为 DataSet 的方法。它需要处理不同的模式，以便这个方法可以处理我所有的获取需求。

PS我正在异步填充SQLDataReader，请不要给出摆脱DataReader的答案。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-06-22T04:07:19.913

[DataTable.load()](http://msdn.microsoft.com/en-us/library/system.data.datatable.load.aspx)可用于通用方法。

```
do {
    var table = new DataTable();
    table.Load(reader);
    dataset.Tables.Add(table);
} while(!reader.IsClosed); 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-02-04T06:40:09.803

试试[DataSet.Load()](http://msdn.microsoft.com/en-us/library/5fd1ahe2.aspx)。它有几个采用 IDataReader 的重载。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-11-06T14:47:28.317

如果由于某种原因 Load 方法失​​败，这是一种手动方法：

```
 DataTable dt = new DataTable();
                    dt = sdr.GetSchemaTable();
                    //dt.Constraints.Clear();
                    //dt.PrimaryKey = null;
                    //dt.BeginLoadData();
                    if (sdr.HasRows)
                    {
                        DataRow row;
                        while (sdr.Read())
                        {
                            row = dt.NewRow();
                            sdr.GetValues(row.ItemArray);
                            dt.Rows.Add(row);
                        } 
```

另一种方法是使用 SqlTableAdapter：

```
var adapter = new SqlDataAdapter(command);
DataSet ds = new DataSet();
adapter.Fill(ds); 
```

# windows - 批处理脚本中是否有办法仅在从 Windows 管理器调用时才保持控制台打开？

> ID：510156
> 
> 赞同：11
> 
> 时间：2009-02-04T05:20:11.960
> 
> 标签：windows, command-line, batch-file, scripting, dos

我有一个 DOS 批处理脚本，它调用一个通过控制台 UI 与用户交互的 java 应用程序。为了论证起见，我们称其为`runapp.bat`，其内容为

```
java com.example.myApp 
```

如果在控制台中调用批处理脚本，一切正常。但是，如果从窗口管理器调用脚本，则新打开的控制台会在应用程序完成执行后立即关闭。我想要的是控制台在所有情况下都保持打开状态。

我知道以下技巧：

*   `pause`在脚本末尾添加命令。`runapp.bat`如果从命令行调用，这有点难看。

*   创建一个新的 shell`cmd /K java com.example.myApp`这是我迄今为止找到的最好的解决方案，但是当从命令行调用时会留下一个额外的 shell 环境，因此调用`exit`实际上并不会关闭 shell。

有没有更好的办法？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-02-04T12:02:44.100

看到这个问题：[Detecting how a batch file was executed](https://stackoverflow.com/questions/377407/detecting-how-a-batch-file-was-executed/377933#377933)

如果从命令控制台运行此脚本不会暂停，但如果在资源管理器中双击则会暂停：

```
@echo off
setlocal enableextensions

set SCRIPT=%0
set DQUOTE="

:: Detect how script was launched
@echo %SCRIPT:~0,1% | findstr /l %DQUOTE% > NUL
if %ERRORLEVEL% EQU 0 set PAUSE_ON_CLOSE=1

:: Run your app
java com.example.myApp

:EXIT
if defined PAUSE_ON_CLOSE pause 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-04T19:57:42.563

我更喜欢使用`%cmdcmdline%`评论中发布的内容，而不是帕特里克对另一个问题的回答（虽然看起来我没有找到）。这样，即使有人决定使用引号来调用批处理脚本，也不会触发误报。

我的最终解决方案：

```
@echo off
java com.example.myApp %1 %2

REM "%SystemRoot%\system32.cmd.exe"   when from console
REM cmd /c ""[d:\path\script.bat]" "  when from windows explorer

@echo %cmdcmdline% | findstr /l "\"\"" >NUL
if %ERRORLEVEL% EQU 0 pause 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-06-10T15:59:10.977

```
cmd /K java com.example.myApp & pause & exit 
```

将完成这项工作。& 将一个接一个地执行命令。如果你使用 && 如果一个失败，你可以打破。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-12-04T18:27:22.760

将此行包含在批处理文件中，然后在资源管理器中双击批处理文件：

cmd /k "这些引号内的脚本命令由 && 分隔"

例如

cmd /k "cd ../.. && 目录 && cd some_directory"

可以在[此处找到 cmd 的完整选项](http://www.microsoft.com/resources/documentation/windows/xp/all/proddocs/en-us/cmd.mspx?mfr=true)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-03T04:27:34.150

我经常使用备用外壳（主要是来自 jpsoft.com 的 TCC/LE）和子外壳。我发现这段代码适用于更广泛、更一般的情况（并且不需要 FINDSTR）：

```
@echo off & setlocal
if "%CMDEXTVERSION%"=="" ( echo REQUIRES command extensions & exit /b 1 ) &:: REQUIRES command extensions for %cmdcmdline% and %~$PATH:1 syntax

call :_is_similar_command _FROM_CONSOLE "%COMSPEC%" %cmdcmdline%
if "%_PAUSE_NEEDED%"=="0" ( goto :_START )
if "%_PAUSE_NEEDED%"=="1" ( goto :_START )
set _PAUSE_NEEDED=0
if %_FROM_CONSOLE% equ 0 ( set _PAUSE_NEEDED=1 )
goto :_START
::
:_is_similar_command VARNAME FILENAME1 FILENAME2
:: NOTE: not _is_SAME_command; that would entail parsing PATHEXT and concatenating each EXT for any argument with a NULL extension
setlocal
set _RETVAL=0
:: more than 3 ARGS implies %cmdcmdline% has multiple parts (therefore, NOT direct console execution)
if NOT [%4]==[] ( goto :_is_similar_command_RETURN )
:: deal with NULL extensions (if both NULL, leave alone; otherwise, use the non-NULL extension for both)
set _EXT_2=%~x2
set _EXT_3=%~x3
if NOT "%_EXT_2%"=="%_EXT_3%" if "%_EXT_2%"=="" (
    call :_is_similar_command _RETVAL "%~2%_EXT_3%" "%~3"
    goto :_is_similar_command_RETURN
    )
if NOT "%_EXT_2%"=="%_EXT_3%" if "%_EXT_3%"=="" (
    call :_is_similar_command _RETVAL "%~2" "%~3%_EXT_2%"
    goto :_is_similar_command_RETURN
    )
::if /i "%~f2"=="%~f3" ( set _RETVAL=1 )  &:: FAILS for shells executed with non-fully qualified paths (eg, subshells called with 'cmd.exe' or 'tcc')
if /i "%~$PATH:2"=="%~$PATH:3" ( set _RETVAL=1 )
:_is_similar_command_RETURN
endlocal & set "%~1=%_RETVAL%"
goto :EOF
::

:_START

if %_FROM_CONSOLE% EQU 1 (
    echo EXEC directly from command line
  ) else (
    echo EXEC indirectly [from explorer, dopus, perl system call, cmd /c COMMAND, subshell with switches/ARGS, ...]
    )
if %_PAUSE_NEEDED% EQU 1 ( pause ) 
```

最初，我`if /i "%~f2"=="%~f3"`在`_is_similar_command`子程序中使用过。对 NULL 扩展的更改`if /i "%~$PATH:2"=="%~$PATH:3"`和附加代码检查允许代码适用于以非完全限定路径打开的 shell/子shell（例如，仅使用“cmd.exe”或“tcc”调用的子shell）。

对于没有扩展名的参数，此代码不会解析和使用来自 %PATHEXT% 的扩展名。它基本上忽略了 CMD.exe 在搜索没有扩展名的命令时使用的扩展名的层次结构（首先尝试 FOO.com，然后是 FOO.exe，然后是 FOO.bat，等等）。因此，`_is_similar_command`检查两个参数之间的相似性，而不是等价性作为 shell 命令。这可能是混淆/错误的来源，但很可能在此应用程序的实践中不会出现问题。

**编辑：**初始代码是旧版本。代码现在更新到最新版本，它具有：（1）交换`%COMSPEC%`并`%cmdcmdline%`在初始调用中，（2）添加了对多个`%cmdcmdline%`参数的检查，（3）回显的消息更具体地说明检测到的内容，以及（4 ) 添加了一个新变量`%_PAUSE_NEEDED%`。

需要注意的是，`%_FROM_CONSOLE%`具体是根据批处理文件是直接从控制台命令行执行还是通过资源管理器或其他方式间接执行的。这些“其他方式”可以包括 perl system() 调用或通过执行诸如`cmd /c COMMAND`.

添加了该变量`%_PAUSE_NEEDED%`，以便间接执行批处理文件的进程（例如 perl）可以绕过批处理文件中的暂停。这在输出未通过管道传输到可见控制台（例如，`perl -e "$o = qx{COMMAND}"`）的情况下很重要。如果在这种情况下发生暂停，“按任意键继续......” 暂停提示永远不会显示给用户，并且进程将挂起等待未经提示的用户输入。在用户交互不可能或不允许的情况下，该`%_PAUSE_NEEDED%`变量可以预设为“0”或“1”（分别为假或真）。`%_FROM_CONSOLE%`仍由代码正确设置，但 的值`%_PAUSE_NEEDED%`随后并未基于`%_FROM_CONSOLE%`. 它只是通过。

还要注意，`%_FROM_CONSOLE%`如果使用包含开关/选项（例如，）的命令打开子shell，代码将错误地检测到子shell 内的间接执行（=0 `cmd /x`）。通常这不是一个大问题，因为子shell 通常在没有额外开关的情况下打开，并且`%_PAUSE_NEEDED%`可以在必要时设置为 0。

警告编码。

* * *

## 回答 #6

> 赞同：-2
> 
> 时间：2014-04-17T20:47:10.847

@echo %CMDCMDLINE% | 查找 /I " /c " >nul && 暂停

# asp.net - 在 ASP.NET 应用程序中访问水晶报表？

> ID：510160
> 
> 赞同：0
> 
> 时间：2009-02-04T05:22:41.457
> 
> 标签：asp.net, crystal-reports

我需要访问部署在 Crystal Report 服务器上的 Crystal Report。

我想在我的 ASP.NET 页面上显示此报告。但是，我不想在我的项目中包含报告文件。我需要使用部署在水晶报表服务器上的报表文件。

你能指导我如何做到这一点吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-11-11T18:05:10.073

尝试

```
ReportDocument.Load(<filePath>, OpenReportMethod.OpenReportByTempCopy) 
```

# resources - 您如何与其他编码人员实时协作？

> ID：510163
> 
> 赞同：18
> 
> 时间：2009-02-04T05:24:14.370
> 
> 标签：resources, collaboration, devtools

假装你打我一些关于 IM 的 javascript 帮助。您如何让我尽可能轻松地帮助您的代码正常工作？

我一直遇到这个。我正在使用即时通讯工具，有人在问我一个问题（或者可能是我在问他们），我们有很多来回沟通，试图处理相同的代码。即时通讯工具不太适合这种情况。电子邮件很慢，如果来回足够多，有点难以理解。

**这是我尝试过的：**

[Google Docs：](http://google.com/docs) - 需要一个 google 帐户并且不完全是实时的。很难知道其他用户何时/何地可能正在编辑。

[Pastie.org](http://pastie.org) - 这非常适合共享代码，但不适用于双向协作。我喜欢界面（[示例](http://pastie.org/379097)），但我无法与其他人实时编辑。

[EtherPad](http://etherpad.com/) - 看起来很有希望，但只有少数用户在负载下屈服。工作中的一些人试图让我们使用它，但我们一直遇到性能问题，甚至出现几次浏览器崩溃。

[CollabEdit](http://collabedit.com/) - 这个看起来很棒（*现在才*发现）。我实际上还没有和任何人一起使用它。它感觉轻巧且反应灵敏。有人有这个运气吗？

[Gobby](http://gobby.0x539.de/trac/) - 当他们/我真正需要的是一些快速的临时协作时，我很难让人们安装这样的东西。话虽如此 - 也许值得我经常与之合作的人寻找？有人用过吗？

[JSbin](http://jsbin.com/) - 我们曾多次尝试使用它，因为与我一起工作的大多数人都是 javascript 人员（我们在 Web 开发机构工作）。“沙盒”javascript 功能非常棒。但是，我们无法实时协作。我们可以在编辑代码后生成新链接，但这仅比通过电子邮件发送给对方（或使用 Pastie.org）好一小步

屏幕共享 - 我只见过 Mac 用户之间的这种工作方式。如果其他开发人员使用的是 OSX 10.5 (Leopard)，则在 iChat 中共享屏幕是微不足道的。除此之外，我不知道免费、可靠、简单的屏幕共享。

-- 已添加 -- VNC - 这个入门门槛太高了。安装软件，绕过网络防火墙，向本地防火墙添加例外......糟糕。**我说得*很快*“嘿，这些线条看起来对吗？” 在这里合作。** - /结尾 -

**……哇。**

**好的，那你用什么？**

我认为理想的服务应该是免费的、基于网络的、以目的为导向的（嘿……有点像 Stackoverflow）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-04T05:31:16.120

我使用[GNU 屏幕](http://www.gnu.org/software/screen/)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-04T05:31:53.297

对于一般解决方案，您可以尝试使用 VNC 选项（例如，tightVNC）。这将允许您共享同一个桌面。例如，我认为 UltraVNC 只会让您共享一个窗口。

Windows 特定的解决方案可能是 NetMeeting（开始 -> 运行 -> conf），您可以在其中共享一个“白板”，如果您尝试，我很确定您也可以共享一个窗口。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-04T06:46:44.610

Github 有一个很好的粘贴分享网站，叫做[gist](http://gist.github.com)。如果您需要查看差异，您可以非常轻松地将要点克隆到桌面。不幸的是，没有在线差异......（那将是一个非常好的功能！）

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-05T00:46:12.857

您的问题听起来像是危险线索，其答案是“什么是[Basecamp](http://www.basecamphq.com/)？” 或者也许[营火](http://www.campfirenow.com/)。或者两者兼而有之。两者都有免费计划。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-04T05:28:25.347

结合 Twitter，[http://snipt.org/](http://snipt.org/)看起来不错。没怎么用过，不过我也用的不多。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-04T05:34:24.443

如果它不仅仅是您想要共享的代码，而是一个完整的设置，那么您可以使用谷歌搜索大量的在线桌面（例如：[DesktopTwo ）。](http://www.desktoptwo.com/)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-02-04T05:54:24.683

任何基于 Web 的东西，我发现最简单的方法是双方只需在单个服务器上工作。这表示：

*   或者轮流编辑服务器上的文件，然后在浏览器中按“重新加载”，这样你们俩就可以同时看到结果。
*   或者双方都在使用版本控制存储库（Subversion，或者这里已经提到过的 Git）并不断在服务器上更新它。

这需要具有这些能力的某种服务器，但是由于任何人都可以在自己的计算机上安装类似的东西，或者只需每月支付几美元让别人为他托管它，它似乎并没有那么大交易。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-02-05T00:36:26.073

我讨厌做广告，但我通常使用[FogBugz](http://www.fogbugz.com)。

最近的一项发现是[Balsamiq](http://www.balsamiq.com)。如果将它集成到 FogBugz 中，那将更接近于涅槃。对 Google Docs 也大加赞赏。

我也听说过有关 Adob​​e Acrobat Connect Pro 的好消息，请查看他们的其中一个截屏视频并自己想象一下。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-02-06T21:23:20.080

如果在距离之内，就会大喊大叫。

IRC 如果没有。专用渠道，问题解决。轻松记录。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-02-04T05:29:18.603

[github](http://github.com/)

为什么我说[git](http://git-scm.com/)，因为您提到需要查看已更改的内容，因为您想要快速的东西。我提到了 github，因为它是一个足够好的存储库。

您还可以使用像[adrive](http://www.adrive.com/)这样的转储空间网站，无论是否使用 git 来对源代码进行版本控制。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-02-04T05:35:54.317

我通常在 Skype 上呼叫其他用户，然后分别启动桌面共享应用程序，如 Windows 远程桌面协助、Windows 会议空间、VNC 等。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-02-04T05:37:16.187

您可以将[VNC](http://www.realvnc.com/products/download.html)安装到他们的机器上并在那里协同工作。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-02-04T05:38:55.077

如果通信将是远程的。我更喜欢电话或Skype，以使事情变得清晰，如果您想使用可能已经使用Netmeeting的工具轻松共享屏幕，则可以共享数据。或者你可以试试interwise、gotomeeting、logmein等软件。甚至大型电子邮件都比 IM 更好

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2009-02-04T05:43:14.443

我的公司使用[WebeX](http://www.webex.com/)，我个人喜欢[DimDim](http://www.dimdim.com/)

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2009-02-06T21:59:06.920

这里我们使用 IM、irc 和[pastebin](http://pastebin.com/)。这并不理想，但它可以完成工作。

我宁愿有一个非常好的协作式白板工具，但我不知道有一个。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2009-10-11T22:18:50.583

因此，几个月后，我确定了一个非常有效的解决方案：[EtherPad](http://etherpad.com)。

他们进行了相当大的重新设计，它拥有我需要的一切。它是基于浏览器的、免费的、即时的、实时的，它甚至可以保存可以在延时视图中回放的修订。

杰出的！

2012 年更新：因此，显然谷歌收购、吸收并关闭了 Etherpad。谢谢古格！

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2012-06-25T21:51:49.763

所以，现在是几年后了。自从我第一次提出这个问题以来，服务已经开始、购买、出售等。似乎这些天使用的主要服务（至少用于测试/共享 html、js 和 css 是[jsfiddle](http://jsfiddle.net/)。

如果您正在寻找 Etherpad（已被 Google 购买并关闭）的替代品，那么您可以尝试[typewith.me](http://typewith.me)，尽管我发现每次 Chrome 更新时该服务都会出现问题。

# reporting-services - Reporting Service 2005：动态数据集

> ID：510165
> 
> 赞同：2
> 
> 时间：2009-02-04T05:27:04.850
> 
> 标签：reporting-services

假设我有这样的查询：

```
SELECT column1, column2, column3, column4, column5, Qty, Amount
FROM Source 
```

我想让这个动态，所以用户将能够`Column1`通过使用复选框来选择等。如果用户选择`Column2, Column3`查询将是：

```
SELECT Column2, Column3, SUM(QTY), SUM(AMOUNT) FROM Source 
GROUP BY Column2, Column3 
```

就查询而言，我可以在存储过程中构建这个没有问题，但是如何将它放入`Reporting Service`动态显示呢？因为我知道您必须设置要显示的字段值的表格报告项？

感谢您的帮助

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-04T13:36:14.097

您可以通过不更改查询和隐藏列来做到这一点。您可以使用列提示用户，并有一个显示/隐藏或类似的东西。

[这是我用谷歌搜索的隐藏列的示例。](http://www.theruntime.com/blogs/thomasswilliams/archive/2008/09/29/hiding-and-showing-columns-based-on-a-parameter-in-reporting.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-04T13:58:49.107

关键是用于填充表中列的 Field 元素可以使用如下索引器：Field("Column1").Value。您可以将包含这些列名的字符串数组作为参数传递给您的报表，并将它们用作字段索引器。

此外，报告中的大多数元素都可以通过包括可见性和分组元素在内的表达式来控制。

# windows - “本地系统”帐户和“网络服务”帐户之间的区别？

> ID：510170
> 
> 赞同：417
> 
> 时间：2009-02-04T05:30:33.283
> 
> 标签：windows, security

我编写了一个 Windows 服务，它产生一个单独的进程。此过程创建一个 COM 对象。如果服务在“本地系统”帐户下运行，一切正常，但如果服务在“网络服务”帐户下运行，则外部进程启动但无法创建 COM 对象。COM 对象创建返回的错误不是标准的 COM 错误（我认为它特定于正在创建的 COM 对象）。

那么，如何确定“本地系统”和“网络服务”这两个帐户有何不同？这些内置帐户看起来很神秘，似乎没有人知道太多关于它们的信息。

* * *

## 回答 #1

> 赞同：750
> 
> 时间：2009-02-04T05:55:31.733

由于标准服务帐户的功能存在很多混淆，我将尝试快速介绍一下。

首先是实际账户：

*   [**LocalService**帐户](http://msdn.microsoft.com/en-us/library/windows/desktop/ms684188%28v=vs.85%29.aspx)（首选）

    一个与网络服务非常相似的受限服务帐户，旨在运行标准的最低特权服务。但是，与网络服务不同，它以*匿名*用户身份访问网络。

    *   姓名：`NT AUTHORITY\LocalService`
    *   该帐户没有密码（您提供的任何密码信息都会被忽略）
    *   HKCU 代表**LocalService**用户帐户
    *   在本地计算机上具有*最低权限*
    *   在网络上提供*匿名*凭据
    *   **SID** : S-1-5-19
    *   **在HKEY_USERS**注册表项 ( `HKEY_USERS\S-1-5-19`)下有自己的配置文件
*   [**网络服务**帐户](http://msdn.microsoft.com/en-us/library/windows/desktop/ms684272%28v=vs.85%29.aspx)

    旨在运行标准特权服务的有限服务帐户。此帐户远比本地系统（甚至管理员）受限得多，但仍然有权作为机器访问网络（请参阅上面的警告）。

    *   `NT AUTHORITY\NetworkService`
    *   该帐户没有密码（您提供的任何密码信息都会被忽略）
    *   HKCU 代表**NetworkService**用户帐户
    *   在本地计算机上具有*最低权限*
    *   将计算机的凭据（例如`MANGO$`）提供给远程服务器
    *   **SID** : S-1-5-20
    *   **在HKEY_USERS**注册表项 ( `HKEY_USERS\S-1-5-20`)下有自己的配置文件
    *   如果尝试使用它来安排任务，请进入`NETWORK SERVICE`“*选择用户或组*”对话框
*   [**LocalSystem**帐户](http://msdn.microsoft.com/en-us/library/windows/desktop/ms684190%28v=vs.85%29.aspx) *（危险，请勿使用！）*

    完全受信任的帐户，比管理员帐户更重要。单个盒子上没有什么是这个账号不能做的，它有权作为机器访问网络（这需要Active Directory并授予机器账号对某事的权限）

    *   名称：（`.\LocalSystem`也可以使用`LocalSystem`or `ComputerName\LocalSystem`）
    *   该帐户没有密码（您提供的任何密码信息都会被忽略）
    *   **SID** : S-1-5-18
    *   没有任何自己的个人资料（`HKCU`代表**默认**用户）
    *   在本地计算机上拥有*广泛的权限*
    *   将计算机的凭据（例如`MANGO$`）提供给远程服务器

上面谈到访问网络时，仅指[SPNEGO](http://en.wikipedia.org/wiki/SPNEGO)（协商）、NTLM 和 Kerberos，而不是任何其他身份验证机制。例如，运行 as`LocalService`的处理仍然可以访问 Internet。

作为标准开箱即用帐户运行的一般问题是，如果您修改任何默认权限，您正在扩展以该帐户运行的所有内容的集合。因此，如果您将 DBO 授予数据库，则不仅您作为本地服务或网络服务运行的服务可以访问该数据库，而且以这些帐户运行的所有其他内容也可以访问。如果每个开发人员都这样做，计算机将拥有一个服务帐户，该服务帐户几乎可以执行任何操作（更具体地说，是授予该帐户的所有不同附加权限的超集）。

从安全的角度来看，始终最好作为您自己的服务帐户运行，该服务帐户具有执行您的服务所需的权限而不是其他任何事情。但是，这种方法的成本是设置您的服务帐户和管理密码。这是每个应用程序需要管理的平衡行为。

在您的具体情况下，您可能看到的问题是 DCOM 或 COM+ 激活仅限于给定的一组帐户。在 Windows XP SP2、Windows Server 2003 及更高版本中，激活权限受到很大限制。您应该使用组件服务 MMC 管理单元来检查您的特定 COM 对象并查看激活权限。如果您没有以计算机帐户身份访问网络上的任何内容，您应该认真考虑使用**本地服务**（不是本地系统，它基本上是操作系统）。

* * *

在 Windows Server 2003中[，您**不能**将计划任务运行](https://serverfault.com/a/513829/4822)为

*   `NT_AUTHORITY\LocalService`（又名本地服务帐户），或
*   `NT AUTHORITY\NetworkService`（又名网络服务帐户）。

该功能仅在 Task [Scheduler 2.0](http://msdn.microsoft.com/en-us/library/windows/desktop/aa383614%28v=vs.85%29.aspx)中添加，仅存在于 Windows Vista/Windows Server 2008 和更高版本中。

运行为的服务`NetworkService`在网络上提供机器凭据。这意味着如果您的计算机被调用`mango`，[它将显示为机器帐户](https://serverfault.com/a/135874/4822) `MANGO$`：

![在此处输入图像描述](https://i.stack.imgur.com/exvfr.png)

# sharepoint - 根据页面属性显示图标

> ID：510171
> 
> 赞同：1
> 
> 时间：2009-02-04T05:31:01.223
> 
> 标签：sharepoint, moss

在 SharePoint (MOSS 2007) 网站中的内容类型上，如果属性是某个值，我想显示一个图标。

该列是“是/否”，因此所选值应该很容易确定。

那么我怎样才能在 ASPX 中显示读取值呢？我知道我需要修改 web.config 以允许页面内 C#，但我只是不确定如何找到该属性。我想我需要使用`SPContext.Current`，但我不确定里面是什么。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-04T08:13:29.380

您需要从列表中的项目中获取值。最重要的是，我认为这会起作用：

```
SPList list = SPContext.Current.Web.Lists["my list name"];
SPListItem item = list.items.GetItemById(ItemId);

//the following 2 lines are not strictly necessary
//but since you explicitly mentioned this is related to ContentTypes
//this is how you can ensure the item you retrieved is of the apprpriate type
SPContentTypeId myContentTypeId = GetContentTypeId();
if (list.ContentTypes.BestMatch(myContentTypeId).Equals(item.ContentType.Id))
{
  string value = item["interesting field name"].ToString();
  //if the value is of interest, do your thing
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-04T20:07:53.497

我会回应 EvilGoatBob 的评论吗？因为通过 XSLT 显示通常要容易得多。如果这不适合您的情况，编码解决方案可能会起作用。如果想在表单输入页面显示，可以试试[自定义字段控件](http://msdn.microsoft.com/en-us/library/bb417414.aspx)

这将更容易在使用该字段的任何位置始终显示图标。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-18T05:42:00.233

好吧，我已经找到了如何做到这一点：

```
var item = SPContext.Current.File.Item; //returns the SPListItem for the current context
var myField = item["SomeFieldName"]; //this will throw a NullReferenceException if there is no data for the field yet though
Response.Write(myField.ToString()); 
```

# c# - 如何从类文件 Visual Studio 中获取最近修改的方法名称

> ID：510172
> 
> 赞同：0
> 
> 时间：2009-02-04T05:31:09.770
> 
> 标签：c#, visual-studio-2005

有没有办法使用 Visual Studio IDE 2005 查找最近在给定类文件中修改了哪些方法

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-04T05:34:50.030

如果您有源代码控制，请使用源代码控制。

否则，您可以使用 NDepend 之类的工具。

# xcode - 在 Xcode 中保存文件之前，如何让脚本自动运行？

> ID：510184
> 
> 赞同：4
> 
> 时间：2009-02-04T05:34:51.307
> 
> 标签：xcode, macos

我希望 Xcode 在保存任何文件之前运行特定的脚本。

有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-06T05:05:38.103

不，没有。

# iphone - 触摸得到缓冲

> ID：510191
> 
> 赞同：1
> 
> 时间：2009-02-04T05:38:00.897
> 
> 标签：iphone, cocoa-touch

在我的游戏中，当我非常快速地对子视图应用触摸时，它只是缓冲了所有触摸并在一段时间后检测到它。它一次应用所有的触摸结果。意味着检测到我在 iphone 上的触摸需要明显的延迟，所以请任何人告诉我如何解决这个问题。所以当我做 touchesBegan 时它会检测到我的触摸。还告诉我有必要在我的程序中进行 hitTest。

请尽快回复，这对我很重要。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-04T14:08:53.890

这听起来与[您之前](https://stackoverflow.com/questions/487355/nstimer-conflict-touch-event)关于在计时器触发时丢失触摸事件的问题有关。正如那里所建议的，您需要将处理器密集型任务移动到后台线程，以便用户界面可以保持响应。确保该后台线程中的处理任务足够细化，以便在用户输入更改条件时可以中断它们。

UIView 通常不需要使用 hitTest，因为它们自己处理触摸事件。如果您的用户正在与独立的 CALayers 交互，则可能需要它。

# latex - 为什么我的 LaTeX 子图不能与 a0poster 一起使用？

> ID：510193
> 
> 赞同：2
> 
> 时间：2009-02-04T05:38:54.623
> 
> 标签：latex, subfigure, a0poster

这是我的问题。我有一堆已经写在 LaTeX 文档中的数字，我想将它们重新用于海报。该图的代码如下所示：

```
\begin{figure}[htp]
  \begin{center}  
    \subfigure[Figure A]{\label{fig:Sample-a}\includegraphics[scale=5]{Image1.png}} 
    \subfigure[Figure B]{\label{fig:Sampple-b}\includegraphics[scale=5]{Image2.png}} 
  \end{center}
  \caption{This is my caption!}
\label{LineJustification}
\end{figure} 
```

当我把它放在开头时它就起作用了：

```
\usepackage{subfigure}
\usepackage{graphicx} 
```

当我把海报放在一起时，我使用的是我在[这个网站上在线找到的模板，](http://nxg.me.uk/docs/posters/)包如下：

```
\documentclass[a0]{a0poster}
\pagestyle{empty}
\setcounter{secnumdepth}{0}
\usepackage[absolute]{textpos}
\usepackage[it]{subfigure} 
```

（我已经从横向文件中注释掉了 graphics、wrapfig 和 times 包，以防它们干扰）。

那么给了什么？当我尝试将相同的图形放入 a0poster 文档时，为什么会出现以下错误？如果我不使用子图，文件会编译，但是我必须重新处理我的所有图，这会很痛苦。

```
!Undefined control sequence
 <argument> if\@captype
              topcap
 I.154  \subfigure 
       [Figure A]{\label{fig:Sample-a} 
```

（我正在使用 mactex，如果这意味着什么）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-04T09:59:11.273

下面的 TeX 文件在 PDFLaTeX 中对我来说很好用。您需要更详细地描述您的问题，也许通过尝试将其精简为一个最小的示例。

```
\documentclass[a0]{a0poster}
\pagestyle{empty}
\setcounter{secnumdepth}{0}
\usepackage[absolute]{textpos}
\usepackage[it]{subfigure}
\usepackage{graphicx}
\begin{document}
\begin{figure}[htp]
  \begin{center}  
    \subfigure[Figure A]{\label{fig:Sample-a}\includegraphics[scale=5]{Image1.png}} 
    \subfigure[Figure B]{\label{fig:Sampple-b}\includegraphics[scale=5]{Image2.png}} 
  \end{center}
  \caption{This is my caption!}
\label{LineJustification}
\end{figure}
\end{document} 
```

我的pdfTeX、LaTeX、a0poster.cls、subfigure.sty的版本号如下：

```
This is pdfTeXk, Version 3.1415926-1.40.9 (Web2C 7.5.7)
LaTeX2e <2005/12/01>
\ProvidesClass{a0poster}[2004/01/31 v1.22b a0poster class (GK, MW)]
\ProvidesPackage{subfigure}[2002/03/15 v2.1.5 subfigure package] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-04T06:00:18.480

我听说过一个智慧：你应该把你的海报做成一页A4大小的文章，然后打印成A0。只需使用足够小的字体，例如`\footnotesize`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-02T21:44:03.553

我通过不使用子图解决了这个问题，而是明确而准确地放置数字。有点肮脏的黑客，但海报很好。

# ruby-on-rails - Rails 固定装置——你如何设置外键？

> ID：510195
> 
> 赞同：29
> 
> 时间：2009-02-04T05:41:10.453
> 
> 标签：ruby-on-rails, unit-testing, testing, tdd, fixtures

我正在阅读本[指南](http://guides.rubyonrails.org/testing_rails_applications.html#_the_low_down_on_fixtures)中的 Rails 固定装置（谢谢，trevorturk）。看来您在 Yaml 文件中定义了类，它们会自动加载到`test`数据库中——很酷。

但是如果你想指定这个食谱属于那本食谱（或其他什么）你怎么做呢？

您是否应该在 Yaml 代码中手动`cookbook.id`指定值？`recipe.cookbook_id`（只是一个猜测——指南没有显示类似的内容。）或者有更合适的方法吗？

* * *

## 回答 #1

> 赞同：63
> 
> 时间：2009-02-04T05:51:25.673

您应该使用命名的固定装置，它会在您不提供的地方自动为您生成一个 ID 号。这些 id 数字本质上是您使用的任何字符串的整数哈希。如果您引用命名版本，请不要添加“_id”：

```
# recipes.yml
chicken_soup:
  cookbook: my_recipes

# cookbooks.yml
my_recipes:
  title: My Test Cookbook 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2016-12-14T08:55:51.573

此外，如果您希望有一个多对多关联（ HABTM ），您只需在夹具中为关联提供一个数组：

```
# recipes.yml
chicken_soup:
  cookbooks: [my_recipes, another_recipe] 
```

# c++ - 如何在 C 中实现 RFC 3393（Ipdv 数据包延迟变化）？

> ID：510198
> 
> 赞同：4
> 
> 时间：2009-02-04T05:41:38.330
> 
> 标签：c++, c, networking, rfc, ip-protocol

我正在构建一个以太网应用程序，我将从一侧发送数据包并在另一侧接收它。我想在接收方计算数据包的延迟，如 RFC 3393 中所示。所以我必须在发送方的数据包中放置一个时间戳，然后在收到数据包后立即在接收方获取时间戳。减去这些值，我将得到时间戳的差异，然后用随后的差异减去这个值，我将得到一种方式 ipdv 延迟。**两个时钟都不同步。** 因此，非常感谢任何帮助。谢谢你。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-04T22:14:43.740

RFC 3393 用于测量数据包延迟的*变化*，而不是用于测量延迟本身。

举个例子：你正在编写一个视频流应用程序。您希望缓冲尽可能少的视频数据（以便视频尽快开始播放）。假设数据从机器 A 到机器 B*总是*需要 20 毫秒。在这种情况下（假设机器 A 可以尽可能快地发送视频数据，因为它需要播放），你根本不需要任何缓冲区。一旦你收到第一帧，你就可以开始玩了，安全地知道在需要下一帧的时候，它已经到达了（因为数据总是需要 20 毫秒才能到达，并且机器 A 至少发送播放速度快）。

无论 20ms 有多长，只要它始终相同，这都有效。它可能是 1000 毫秒 - 第一帧需要 1000 毫秒才能到达，但您仍然可以在它到达后立即开始播放，因为下一帧也需要 1000 毫秒并且在第一帧之后发送 - 换句话说，它已经在它的方式和将在这里片刻。显然，现实世界不是这样的。

采取另一个极端：大多数时候，数据在 20 毫秒内到达。除了有时，当它需要 5000 毫秒时。如果您没有保留缓冲区并且第 1 到第 50 帧的延迟为 20 毫秒，那么您可以毫无问题地播放前 50 帧。然后第 51 帧需要 5000 毫秒才能到达，而您在 5000 毫秒内没有任何视频数据。用户去另一个网站访问他们可爱的猫视频。你真正需要的是一个 5000 毫秒数据的缓冲区——那么你就可以了。

长示例，短点：您对数据包的*绝对*延迟不感兴趣，您对该延迟的*差异*感兴趣- 这就是您的缓冲区必须有多大。

要测量*绝对*延迟，您必须使两台机器上的时钟同步。机器 A 将发送一个时间戳为 12337849227 **28的数据包，当该数据包在时间 12337849227** **48**到达机器 B 时，您会知道数据包花了 20 毫秒才到达那里。

但是由于您对方*差*感兴趣，因此您需要（如 RFC 3393 所述）来自机器 A 的几个数据包。机器 A 发送数据包 1，时间戳为 1233784922 **72** 8，然后 10 毫秒后发送数据包 2，时间戳为 1233784922 **73** 8，然后 10 毫秒后发送时间戳为 1233784922 **74** 8 的数据包 3。

机器 B 在它认为是时间戳 1233784922 **12** 8 处接收数据包 1。在这种情况下（从机器 B 的角度来看）机器 A 和机器 B 之间的单向延迟为 -600 毫秒。这显然是完全的垃圾，但我们不在乎。机器 B 在它认为是时间戳 1233784922 **15** 8 处接收到数据包 2。单向延迟为 -580 毫秒。机器 B 在它认为是时间戳 1233784922 **16** 8 处接收到数据包 3。单向延迟再次为 -580 毫秒。

如上所述，我们不关心绝对延迟是多少——所以我们甚至不关心它是负数，还是三个小时，或者其他什么。我们关心的是延迟量变化 20ms。所以你需要一个 20ms 的数据缓冲区。

请注意，我在这里完全掩盖了时钟漂移的问题（也就是说，机器 A 和 B 上的时钟以略微不同的速率运行，因此例如机器 A 的时间以每秒 1.00001 秒的速率前进，实际上通过）。虽然这确实会导致测量不准确，但其实际效果在大多数应用中不太可能成为问题。

# c# - 如何将其从 C# 转换为 VB.NET？

> ID：510201
> 
> 赞同：-3
> 
> 时间：2009-02-04T05:43:31.807
> 
> 标签：c#, asp.net-mvc, vb.net

ASP.NET MVC - 在 VB.NET 中这是什么？

```
Html.TextBox( "name", null, new { @class = "css-class" } ); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-04T06:00:43.720

几乎完全相同 [：c# 匿名类型代码的 VB.Net 代码等效项是什么？](https://stackoverflow.com/questions/407586/what-is-the-vb-net-code-equivelant-for-c-anonymous-type-code)

> 这称为匿名类型，VB 等价物是：
> 
> 新的 {.Name = "value"}

# logging - 将格式应用于 Unix shell

> ID：510202
> 
> 赞同：8
> 
> 时间：2009-02-04T05:45:29.883
> 
> 标签：logging, tail

我一直在查看`tail -f`最近使用的一些服务器日志，并且认为如果我可以格式化输出会更容易看到一些东西。实际上，我正在寻找的只是一种可能为某些单词着色（由正则表达式确定）并可能删除某些单词（再次由正则表达式确定）的方法。

我[知道](https://stackoverflow.com/questions/113121/best-tail-log-file-visualization-freeware-tool) [有](https://stackoverflow.com/questions/133821/the-best-tail-gui)一些程序可以实时可视化服务器日志等等，但我对此更感兴趣。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-02-04T06:09:29.287

`tail -f`将into的输出通过管道传输`sed`，并添加一些[ANSI 转义码](http://en.wikipedia.org/wiki/ANSI_escape_code)。例如，以下代码会将所有数字着色为红色（颜色 31），将所有引用的字符串着色为亮黄色（颜色 93）：

```
RED=`echo -en '\e[31m'`
YELLOW=`echo -en '\e[93m'`
RESET=`echo -en '\e[00m'`
tail -f file | sed -E "s/([0-9]+)/$RED\1$RESET/g;s/(\"[^\"]*\")/$YELLOW\1$RESET/g" 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-04T06:02:12.203

我认为您正在寻找的是某种`sed`脚本，它将使用 ANSI 颜色转义序列围绕您选择的单词。（嗯......让我看看）。

**编辑**好的，明白了：

这是一个以深红色输出“Hello”的示例：

```
echo -e "\033[31mHello\033[0m" 
```

发生了什么？首先，我使用`echo -e`它`echo`不会将斜杠转换为屏幕上的斜杠，而是将转义序列读取`\033`为单个转义字符。这实际上只是八进制的 33，即 27（ESC 键的序数）。

所以真正被发送到屏幕上的是这样的：

```
<ESC>[32mHello<ESC>[0m 
```

ANSI 显示将其解释为“首先执行命令`32m`，输出“Hello”，然后执行命令`0m`。

在这种情况下，命令的`32m`意思是“将前景色设置为 2”，由于颜色 #2 是深红色，终端使用的“笔”现在将是深红色。这意味着从此时起，屏幕上显示的所有文本都将变为深红色。

当我们完成输出应该是红色的文本时，我们希望重置颜色，所以我们调用将`0m`颜色重置为正常的命令。

有关所有转义码的列表，请在 [ [http://en.wikipedia.org/wiki/ANSI_escape_code](http://en.wikipedia.org/wiki/ANSI_escape_code) Wikipedia] 中查找，或者直接在 google 中查找。

因此，您的 sed 脚本所要做的就是将您选择的单词替换为被颜色包围的单词。例如，要替换 中的单词“Feb” `/var/log/messages`，请执行以下操作：

```
tail /var/log/messages | sed -e "s/Feb/\\o033[31m&\\o033[0m/" 
```

（您可能必须以 root 身份执行此操作才能实际阅读`/var/log/messages`）

所做`sed`的只是搜索单词“Feb”并用我们上面使用的相同转义序列包围它。

您可以将其扩展为为多个单词着色：

```
tail /var/log/messages | sed -e "s/\(Feb\|Mar\|Apr\)/\\o033[31m&\\o033[0m/g" 
```

它将为“Feb”、“Mar”、“Apr”着色 - 每个都是深红色。

我希望这能让您对如何做您需要的事情有所了解！

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-04T13:28:44.003

感谢 scraimer 和 Adam，我想出了很多我想要的东西，我想我会在这里分享给其他人：

```
RED=`echo -en '\e[31m'`
YELLOW=`echo -en '\e[93m'`
RESET=`echo -en '\e[00m'`

# line breaks here are just for formatting
tail -f ~/access-logs/access.log | sed -e "s@\([0-9\.]\+\) - - 
    \[[0-9]\+/[a-zA-Z]\+/[0-9]\+:\([0-9]\+:[0-9]\+:[0-9]\+\) +[0-9]\+] \"
    \(.\+\) HTTP/1\.[01]\" \([0-9]\+\) \([-0-9]\+\) \"\([^\"]\+\)\".*
    @\n\2 $YELLOW\4$RESET (\1)\n$RED\3$RESET\nBytes: \5\nFrom: \6@g"

# here's the full line if you wanted to copy it
# tail -f ~/access-logs/access.log | sed -e "s@\([0-9\.]\+\) - - \[[0-9]\+/[a-zA-Z]\+/[0-9]\+:\([0-9]\+:[0-9]\+:[0-9]\+\) +[0-9]\+] \"\(.\+\) HTTP/1\.[01]\" \([0-9]\+\) \([-0-9]\+\) \"\([^\"]\+\)\".*@\n\2 $YELLOW\4$RESET (\1)\n$RED\3$RESET\nBytes: \5\nFrom: \6@g" 
```

这变成了这样：

```
182.108.1.20 - - [04/Feb/2009:23:24:41 +1000] "GET /images/exam_room.jpg HTTP/1.0" 200 8559 "http://www.myserver.com/courses/" "Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1)" 
```

进入这个（但有一些颜色）：

```
23:24:41 200 (182.108.1.20)
GET /images/exam_room.jpg
Bytes: 8559
From: http://www.myserver.com/courses/ 
```

# asp.net - ASP.Net MVC RC1 RouteCollection.MapRoute 问题

> ID：510205
> 
> 赞同：1
> 
> 时间：2009-02-04T05:46:25.903
> 
> 标签：asp.net, asp.net-mvc, url-rewriting, actionlink

我对 ASP.Net MVC 的 RC1 版本有疑问。每当我在“默认”路由之前添加一个路由时，创建的结果 URL 是为添加的第一个路由。

这是我在 Global.asax.cs 中的路由

```
routes.MapRoute(
            "product-detailed",
            "Products/{controller}/{action}/{id}",
            new { controller = "ProductSubType", action = "Index", id = "" }
        );

        routes.MapRoute(
            "Default",                                              
            "{controller}/{action}/{id}",                           
            new { controller = "Home", action = "Index", id = "" }  
        ); 
```

我的网址创建：

```
 <%= Html.ActionLink("Bikes", "Index", "Bikes") %><br />
        <%= Html.RouteLink("Bikes", "product-detailed", new { controller = "Bikes", action = "Index" }) %> 
```

我希望第一个 ActionLink 创建一个像“/Bikes/Index”这样的 Url，第二个 RouteLink 创建一个“/Products/Bikes/Index”，但两个 Url 最终都是“/Products/Bikes/Index”。

我在路由上缺少什么？

谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-04T05:58:28.780

你没有错过任何东西。它按设计工作。

由于控制器和动作在顶部路由中都是可变的，对有效值没有限制，因此该路由对控制器和动作的所有值都有效。

潜在的解决方法：

*   修复控制器和/或操作值，使它们不属于 URL
*   为控制器和/或操作值的顶部路由添加限制
*   始终使用路由链接而不是操作链接，因为它们明确说明哪条路由是正确的路由。

# sql-server - SQL Server 2008 Management Studio - 运行参数化查询

> ID：510207
> 
> 赞同：2
> 
> 时间：2009-02-04T05:46:58.287
> 
> 标签：sql-server, ssms, sql-server-2008

我希望能够从 SSMS 中运行已经参数化的查询：

```
select name
from aTable
where id = @id 
```

我知道其他 IDE（例如 TOAD）允许参数绑定 - 这在 SSMS 2008 中可用吗？

谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-04T05:50:20.107

我不相信这是可能的。

在这种情况下，我通常所做的只是将以下内容添加到窗口顶部：

```
declare @id int
set @id = 10

-- followed by the parameterized query 
```

实际上，我认为 2008 现在支持初始化：

```
declare @id int = 10 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2010-10-26T07:53:39.260

我通常会使用`CTRL-Shift-M`SSMS 中的功能。请参阅以下示例和说明。有点乏味，但嘿，总比没有好。

```
--===============================================  
-- Purpose: Search all objects for specified Text  
--===============================================  
-- Instructions: CTRL-A + CTRL-Shift-M, enter text   
-- to search, click Ok and press F5\.  
-- To repeat search with other text: CTRL-Z (undo)  
-- and then repeat above.  
SELECT o.Name   AS [Object Name]  
    ,o.xType AS [Object Type]  
    ,s.TEXT  AS [Object Text]  
FROM sySobjects o,  
     sysComments s  
WHERE  o.Id = s.Id  
  AND TEXT LIKE '%&lt;Text To Search,,&gt;%' 
```

# javascript - 回流在 DOM 环境中何时发生？

> ID：510213
> 
> 赞同：52
> 
> 时间：2009-02-04T05:50:42.260
> 
> 标签：javascript, performance, dom, reflow

什么样的活动会触发带有 DOM 的网页回流？

似乎有不同的观点。根据[http://www.nczonline.net/blog/2009/02/03/speed-up-your-javascript-part-4/](http://www.nczonline.net/blog/2009/02/03/speed-up-your-javascript-part-4/)，它发生了

*   添加或删除 DOM 节点时。
*   当您动态应用样式时（例如 element.style.width="10px"）。
*   当您检索必须计算的度量时，例如访问 offsetWidth、clientHeight 或任何计算的 CSS 值（通过 DOM 兼容浏览器中的 getComputedStyle() 或 IE 中的 currentStyle）。

但是，根据[http://dev.opera.com/articles/view/efficient-javascript/?page=3](http://dev.opera.com/articles/view/efficient-javascript/?page=3)，仅当已经有回流操作排队时才进行测量触发回流。

有人有更多的想法吗？

* * *

## 回答 #1

> 赞同：49
> 
> 时间：2009-08-14T14:33:37.907

两篇文章都是正确的。可以有把握地假设，每当你在做一些合理地需要计算 DOM 中元素的尺寸的事情时，你就会触发重排。

此外，据我所知，两篇文章都说了同样的话。

第一篇文章说回流发生在：

> 当您**检索必须计算的测量值**时，例如访问**offsetWidth**、**clientHeight**或任何计算的 CSS 值（通过DOM 兼容浏览器中的**getComputedStyle()**或 IE 中的 currentStyle ），同时 DOM 更改排队等待进行。

第二条规定：

> 如前所述，浏览器可能会为您缓存多个更改，并在所有更改完成后仅重排一次。但是，请注意，**对元素进行测量将迫使其回流**，因此测量结果将是正确的。更改可能会或可能不会明显重绘，但回流本身仍然必须在幕后进行。
> 
> **当使用诸如offsetWidth 之**类的属性或使用诸如**getComputedStyle 之**类的方法进行测量时，会创建此效果。即使没有使用数字，只要在浏览器仍在缓存更改时使用其中任何一个，就足以触发隐藏的重排。如果重复进行这些测量，您应该考虑只进行一次，并存储结果，以便以后使用。

我认为这与他们之前所说的相同。Opera 将尽最大努力为您缓存值并避免重排，但您不应该依赖它这样做的能力。

出于所有意图和目的，当他们说所有三种类型的交互都可能导致回流时，请相信他们俩所说的话。

干杯。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2010-09-21T15:20:52.730

查看[了解 Internet Explorer 渲染行为](http://blog.dynatrace.com/2009/12/12/understanding-internet-explorer-rendering-behaviour/)的“由属性读取访问触发的渲染”部分，其中 IE 中的以下代码将导致渲染活动。

```
function askforHeight () {
  $("#lower").height();  
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-04T07:45:02.043

```
document.body.style.display = 'none';
document.body.style.display = 'block'; 
```

这通常可以解决那些难以理解的布局错误。

# sql-server - 为什么参数化查询产生比非参数化查询慢得多的查询计划

> ID：510214
> 
> 赞同：24
> 
> 时间：2009-02-04T05:51:02.727
> 
> 标签：sql-server

在 SQL Server 2005 数据库中，我正在处理这个查询：

> select *
> from foo
> join bar on bar.x = foo.x
> join baz on baz.y = foo.y
> where foo.x = 1000

与以下参数化版本相比，它具有截然不同且更快的查询计划。

> 声明@p0 int
> set @p0 = 1000
> select *
> from foo
> join bar on bar.x = foo.x
> join baz on baz.y = foo.y
> where foo.x = @p0

在我的特殊情况下，带有文字的版本在亚秒时间内运行。参数化版本需要 2-3 秒。鉴于它们是相同的查询，我希望它们是相同的。

为什么他们得到不同的查询计划？

有什么办法可以让参数化版本和文字版本有同样的性能？

以下是查询计划。我的真实查询与我上面给出的通用查询有很大不同，但是产生这些计划的两个查询之间的唯一区别是参数。为什么用参数替换文字会导致如此截然不同的计划？

*   [文字查询计划](http://www.freeimagehosting.net/image.php?c5ac690e59.jpg)
*   [参数化查询计划](http://www.freeimagehosting.net/image.php?10c12c2e59.jpg)

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-02-04T08:03:09.993

查询计划器似乎已根据其已有的信息在文字查询中做出决定。它将具有统计信息，可以根据您的特定文字中给出的数据分布有效地查询这些统计信息。

参数化查询选择了它认为对表中所有数据最公平的查询，您会注意到这是许多嵌套循环（性能 = 差）。

也许您可以尝试在您的数据库上运行数据库优化工具，看看某些索引是否可以帮助您？

特别是在您的查询中，试试这个：

```
declare @p0 int
set @p0 = 1000
select *
from foo
join bar on bar.x = foo.x
join baz on baz.y = foo.y
where foo.x = @p0
OPTION ( OPTIMIZE FOR (@p0 = 1000)) 
```

但如果不确定此查询中包含的数据不会改变，并且您对此计划的查询总是更有效，我会谨慎行事。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-02-04T14:22:19.980

我认为您正在与“[参数嗅探](http://groups.google.ch/group/microsoft.public.sqlserver.programming/msg/1e4a2438bed08aca)”发生冲突。基本上，这意味着 SQL Server 尝试使用尽可能多的信息来计算查询的最佳执行计划。对于您的第一个查询，您有一个在编译时已知的常量值，因此引擎可以直接针对该值优化查询计划。

在第二个中，您在编译时使用了一个变量掩码了引擎中的值这一事实（您认为它应该能够弄清楚，但实际上我在使用简单的常量表达式时遇到了类似的问题！ )，导致性能不佳。

您可以尝试解决此问题的一种方法是将查询包装在存储过程中，该存储过程直接获取参数，然后将其应用于查询——如下所示：

```
CREATE PROCEDURE test
  @p0 int
AS
BEGIN
  select *
  from foo
  join bar on bar.x = foo.x
  join baz on baz.y = foo.y
  where foo.x = @p0
END 
```

这应该允许优化器准确地“嗅探”您使用的参数并为您生成最佳查询计划。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2014-08-19T15:26:31.227

在我的例子中，在 DB 表中，列类型被定义为 VarChar，而在参数化查询中，参数类型被定义为 NVarChar，这`CONVERT_IMPLICIT`在实际执行计划中引入以在比较之前匹配数据类型，这是母猪性能的罪魁祸首，2 秒对 11 秒。只需更正参数类型，就可以使参数化查询与非参数化版本一样快。

希望这可以帮助有类似问题的人。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-04T06:22:12.273

您的起点应该是 SQL 分析器。通过探查器运行两者，并查看每种情况下的查询计划是什么......然后更新问题以描述这两个计划。

我认为*可能*存在问题的一件事是，如果您有一个带有一组值的参数化查询，优化器可能会查看一些统计信息/索引并选择一种方法，然后为所有查询重用该计划 -尽管它不是特别适合一组不同的值。同样，如果计划是在有一组数据时确定的（例如，当一个表很小时，鼓励进行表扫描），然后您添加数据桶负载，则该计划可能不合适。但是，这些都不会影响作为准备好的语句的第一个查询不好的查询。

# iphone - 即使您不打开设置应用程序，您能否将 Settings.bundle 中的设置设为默认值

> ID：510216
> 
> 赞同：58
> 
> 时间：2009-02-04T05:51:15.597
> 
> 标签：iphone, cocoa-touch

我有一个带有 settings.bundle 的 iPhone 应用程序，用于处理我的应用程序的各种设置。我可以在我的 root.plist 文件中设置默认值（使用 DefaultValue 属性），但这些仅在用户第一次打开设置应用程序时使用。有什么方法可以在您的应用程序安装时写出这些值？我知道我可以编写代码来检查我的应用程序的第一次启动，然后将它们写出来，但是它们在两个不同的地方。

以下是我的 root.plist 中的一个条目作为示例：

```
<dict>
    <key>Type</key>
    <string>PSToggleSwitchSpecifier</string>
    <key>Title</key>
    <string>Open To Top Location</string>
    <key>Key</key>
    <string>open_top_location</string>
    <key>DefaultValue</key>
    <string>YES</string>
    <key>TrueValue</key>
    <string>YES</string>
    <key>FalseValue</key>
    <string>NO</string>
</dict> 
```

最终结果应该是，如果我要求“open_to_top_location”，我会得到“是”，而不是在用户第一次打开“设置”应用程序之前它根本不存在。

有任何想法吗？

* * *

## 回答 #1

> 赞同：96
> 
> 时间：2009-02-04T06:57:24.650

如果我理解正确，您希望避免两次指定默认值（一次作为 Settings.bundle/Root.plist 文件中的“DefaultValue”键，一次在您的应用程序初始化代码中），因此您不必保留它们同步。

由于 Settings.bundle 存储在应用程序包本身中，因此您只需读取那里给出的默认值即可。我整理了一些示例代码，查看设置包并读取那里每个键的默认值。请注意，这不会写出默认键；如果它们不存在，您需要在每次启动时阅读并注册它们（随时更改）。我只做了一些粗略的测试，所以请确保它在所有情况下都适合你。

```
- (void)applicationDidFinishLaunching:(UIApplication *)application {    
    NSString *name = [[NSUserDefaults standardUserDefaults] stringForKey:@"name"];
    NSLog(@"name before is %@", name);

    // Note: this will not work for boolean values as noted by bpapa below.
    // If you use booleans, you should use objectForKey above and check for null
    if(!name) {
        [self registerDefaultsFromSettingsBundle];
        name = [[NSUserDefaults standardUserDefaults] stringForKey:@"name"];
    }
    NSLog(@"name after is %@", name);
}

- (void)registerDefaultsFromSettingsBundle {
    NSString *settingsBundle = [[NSBundle mainBundle] pathForResource:@"Settings" ofType:@"bundle"];
    if(!settingsBundle) {
        NSLog(@"Could not find Settings.bundle");
        return;
    }

    NSDictionary *settings = [NSDictionary dictionaryWithContentsOfFile:[settingsBundle stringByAppendingPathComponent:@"Root.plist"]];
    NSArray *preferences = [settings objectForKey:@"PreferenceSpecifiers"];

    NSMutableDictionary *defaultsToRegister = [[NSMutableDictionary alloc] initWithCapacity:[preferences count]];
    for(NSDictionary *prefSpecification in preferences) {
        NSString *key = [prefSpecification objectForKey:@"Key"];
        if(key && [[prefSpecification allKeys] containsObject:@"DefaultValue"]) {
            [defaultsToRegister setObject:[prefSpecification objectForKey:@"DefaultValue"] forKey:key];
        }
    }

    [[NSUserDefaults standardUserDefaults] registerDefaults:defaultsToRegister];
    [defaultsToRegister release];
} 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2011-10-31T16:37:01.757

这是我基于@PCheese 的[答案](https://stackoverflow.com/questions/510216/can-you-make-the-settings-in-settings-bundle-default-even-if-you-dont-open-the/510329#510329)的代码，它增加了对没有默认值和子窗格的键的支持。

```
- (void)registerDefaultsFromSettingsBundle {
    [[NSUserDefaults standardUserDefaults] registerDefaults:[self defaultsFromPlistNamed:@"Root"]];
}

- (NSDictionary *)defaultsFromPlistNamed:(NSString *)plistName {
    NSString *settingsBundle = [[NSBundle mainBundle] pathForResource:@"Settings" ofType:@"bundle"];
    NSAssert(settingsBundle, @"Could not find Settings.bundle while loading defaults.");

    NSString *plistFullName = [NSString stringWithFormat:@"%@.plist", plistName];

    NSDictionary *settings = [NSDictionary dictionaryWithContentsOfFile:[settingsBundle stringByAppendingPathComponent:plistFullName]];
    NSAssert1(settings, @"Could not load plist '%@' while loading defaults.", plistFullName);

    NSArray *preferences = [settings objectForKey:@"PreferenceSpecifiers"];
    NSAssert1(preferences, @"Could not find preferences entry in plist '%@' while loading defaults.", plistFullName);

    NSMutableDictionary *defaults = [NSMutableDictionary dictionary];
    for(NSDictionary *prefSpecification in preferences) {
        NSString *key = [prefSpecification objectForKey:@"Key"];
        id value = [prefSpecification objectForKey:@"DefaultValue"];
        if(key && value) {
            [defaults setObject:value forKey:key];
        } 

        NSString *type = [prefSpecification objectForKey:@"Type"];
        if ([type isEqualToString:@"PSChildPaneSpecifier"]) {
            NSString *file = [prefSpecification objectForKey:@"File"];
            NSAssert1(file, @"Unable to get child plist name from plist '%@'", plistFullName);
            [defaults addEntriesFromDictionary:[self defaultsFromPlistNamed:file]];
        }        
    }

    return defaults;
} 
```

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2015-01-14T17:39:32.390

这是 Swift 版本：从以下位置调用它：

```
func application(application: UIApplication, didFinishLaunchingWithOptions launchOptions: [NSObject: AnyObject]?) -> Bool {
    // Override point for customization after application launch.
    self.registerDefaultsFromSettingsBundle()

    return true
} 
```

转换函数：

```
func registerDefaultsFromSettingsBundle(){
    //NSLog("Registering default values from Settings.bundle");
    let defs: NSUserDefaults = NSUserDefaults.standardUserDefaults()
    defs.synchronize()

    var settingsBundle: NSString = NSBundle.mainBundle().pathForResource("Settings", ofType: "bundle")!    
    if(settingsBundle.containsString("")){
        NSLog("Could not find Settings.bundle");
        return;
    }
    var settings: NSDictionary = NSDictionary(contentsOfFile: settingsBundle.stringByAppendingPathComponent("Root.plist"))!
    var preferences: NSArray = settings.objectForKey("PreferenceSpecifiers") as NSArray
    var defaultsToRegister: NSMutableDictionary = NSMutableDictionary(capacity: preferences.count)

    for prefSpecification in preferences {
        if (prefSpecification.objectForKey("Key") != nil) {
            let key: NSString = prefSpecification.objectForKey("Key")! as NSString
            if !key.containsString("") {
                let currentObject: AnyObject? = defs.objectForKey(key)
                if currentObject == nil {
                    // not readable: set value from Settings.bundle
                    let objectToSet: AnyObject? = prefSpecification.objectForKey("DefaultValue")
                    defaultsToRegister.setObject(objectToSet!, forKey: key)
                    NSLog("Setting object \(objectToSet) for key \(key)")
                }else{
                    //already readable: don't touch
                    //NSLog("Key \(key) is readable (value: \(currentObject)), nothing written to defaults.");
                }
            }
        }
    }
    defs.registerDefaults(defaultsToRegister)
    defs.synchronize()
} 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2016-11-21T09:36:05.640

斯威夫特 3 版本

```
 func registerDefaultsFromSettingsBundle(){
    guard let settingsBundle = Bundle.main.path(forResource: "Settings", ofType: "bundle") else {
        print("Could not locate Settings.bundle")
        return
    }

    guard let settings = NSDictionary(contentsOfFile: settingsBundle+"/Root.plist") else {
        print("Could not read Root.plist")
        return
    }

    let preferences = settings["PreferenceSpecifiers"] as! NSArray
    var defaultsToRegister = [String: AnyObject]()
    for prefSpecification in preferences {
        if let post = prefSpecification as? [String: AnyObject] {
            guard let key = post["Key"] as? String,
                let defaultValue = post["DefaultValue"] else {
                    continue
            }
            defaultsToRegister[key] = defaultValue
        }
    }
    UserDefaults.standard.register(defaults: defaultsToRegister)
} 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2015-11-19T05:56:19.767

兼容 Swift 2 的版本

```
func registerDefaultsFromSettingsBundle(){

    let defaults = NSUserDefaults.standardUserDefaults()
    defaults.synchronize()

    let settingsBundle: NSString = NSBundle.mainBundle().pathForResource("Settings", ofType: "bundle")!
    if(settingsBundle.containsString("")){
        NSLog("Could not find Settings.bundle");
        return;
    }
    let settings = NSDictionary(contentsOfFile: settingsBundle.stringByAppendingPathComponent("Root.plist"))!
    let preferences = settings.objectForKey("PreferenceSpecifiers") as! NSArray;
    var defaultsToRegister = [String: AnyObject](minimumCapacity: preferences.count);

    for prefSpecification in preferences {
        if (prefSpecification.objectForKey("Key") != nil) {
            let key = prefSpecification.objectForKey("Key")! as! String
            if !key.containsString("") {
                let currentObject = defaults.objectForKey(key)
                if currentObject == nil {
                    // not readable: set value from Settings.bundle
                    let objectToSet = prefSpecification.objectForKey("DefaultValue")
                    defaultsToRegister[key] = objectToSet!
                    NSLog("Setting object \(objectToSet) for key \(key)")
                }
            }
        }
    }
    defaults.registerDefaults(defaultsToRegister)
    defaults.synchronize()
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2011-11-23T11:46:40.780

同一主题的另一个版本。我保留了 Lawrence Johnston 对子窗格的支持，并添加了 i18n/l10n 支持。

```
// This code is folklore, first created by an unknown person and copied, pasted
// and published by many different programmers, each (hopefully) of whom added
// some improvemrnts. (c) the People of the Earth
- (NSDictionary *)defaultsFromPlistNamed:(NSString *)plistName {
    NSString *settingsBundlePath = [[NSBundle mainBundle] pathForResource:@"Settings" ofType:@"bundle"];
    if (!settingsBundlePath) {
        NSAssert(settingsBundlePath, @"Could not find Settings.bundle while loading defaults.");
        return nil;
    }

    NSBundle *settingsBundle = [NSBundle bundleWithPath:settingsBundlePath];
    if (!settingsBundlePath) {
        NSAssert(settingsBundle, @"Could not load Settings.bundle while loading defaults.");
        return nil;
    }

    NSString *plistFullName = [settingsBundle pathForResource:plistName ofType:@"plist"];
    if (!plistName) {
        NSAssert1(settings, @"Could not find plist '%@' while loading defaults.", plistFullName);
        return nil;
    }

    NSDictionary *settings_dic = [NSDictionary dictionaryWithContentsOfFile:plistFullName];
    if (!settings_dic) {
        NSAssert1(settings_dic, @"Could not load plist '%@' while loading defaults.", plistFullName);
        return nil;
    }

    NSArray *preferences = [settings_dic objectForKey:@"PreferenceSpecifiers"];
    NSAssert1(preferences, @"Could not find preferences entry in plist '%@' while loading defaults.", plistFullName);

    NSMutableDictionary *defaults = [NSMutableDictionary dictionary];
    for(NSDictionary *prefSpecification in preferences) {
        NSString *key = [prefSpecification objectForKey:@"Key"];
        if (key) {
            id value = [prefSpecification objectForKey:@"DefaultValue"];
            if(value) {
                [defaults setObject:value forKey:key];
                NSLog(@"setting %@ = %@",key,value);
            } 
        }

        NSString *type = [prefSpecification objectForKey:@"Type"];
        if ([type isEqualToString:@"PSChildPaneSpecifier"]) {
            NSString *file = [prefSpecification objectForKey:@"File"];
            NSAssert1(file, @"Unable to get child plist name from plist '%@'", plistFullName);
            if (file) {
                [defaults addEntriesFromDictionary:[self defaultsFromPlistNamed:file]];
            }
        }        
    }

    return defaults;
}

- (void)registerDefaultsFromSettingsBundle {
    [[NSUserDefaults standardUserDefaults] registerDefaults:[self defaultsFromPlistNamed:@"Root"]];
} 
```

来自`[self registerDefaultsFromSettingsBundle];`_`- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions`

`if(x) {NSAssert(x);return nil;}`看起来很愚蠢，但我懒得做点什么。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2011-12-01T21:55:28.283

另一种方法：代码生成

下面生成一个带有单个函数的 Objective-C 文件，该函数为 Root.plist 注册默认值。

```
xsltproc settings.xslt Settings.bundle/Root.plist > registerDefaults.m 
```

可以使用 XCode 中的“运行脚本”构建阶段自动运行。该阶段应放在“编译源”之前。（xsltproc 随 OS X 一起提供。）

![](https://i.stack.imgur.com/EH2av.png)

这有点基本，不处理嵌套文件，但也许有人可以使用它。

## 设置.xslt

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
  <xsl:output method="text" encoding="UTF-8" omit-xml-declaration="yes" indent="no" />

  <xsl:template match="dict">
    <xsl:choose>
      <xsl:when test="key[.='DefaultValue']/following-sibling::*[position()=1 and self::true]">
        @"YES",
      </xsl:when>
      <xsl:when test="key[.='DefaultValue']/following-sibling::*[position()=1 and self::false]">
        @"NO",
      </xsl:when>
      <xsl:otherwise>
        @"<xsl:value-of select="key[.='DefaultValue']/following-sibling::*[1]"/>",
      </xsl:otherwise>
    </xsl:choose>
    @"<xsl:value-of select="key[.='Key']/following-sibling::*[1]"/>",
  </xsl:template>

  <xsl:template match="/">
    void registerDefaults() {

    NSDictionary *defaults =
    [NSDictionary dictionaryWithObjectsAndKeys:
    <xsl:apply-templates select="descendant::key[.='DefaultValue']/.."/>
    nil];

    [[NSUserDefaults standardUserDefaults] registerDefaults: defaults];
    }
  </xsl:template>

</xsl:stylesheet> 
```

这是基于[Benjamin Ragheb](http://www.benzado.com/blog/post/275/xsl-for-default-plist)的作品。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2016-04-07T11:57:13.157

一个更简洁的 swift 2.2 版本，需要对字符串进行快速扩展才能恢复`stringByAppendingPathComponent`：

```
extension String {
    func stringByAppendingPathComponent(path: String) -> String {
        let nsSt = self as NSString
        return nsSt.stringByAppendingPathComponent(path)
    }
}

func registerDefaultsFromSettingsBundle() {
    guard let settingsBundle = NSBundle.mainBundle().pathForResource("Settings", ofType: "bundle") else {
        log.debug("Could not find Settings.bundle")
        return
    }

    let settings = NSDictionary(contentsOfFile: settingsBundle.stringByAppendingPathComponent("Root.plist"))!

    let preferences = settings["PreferenceSpecifiers"] as! NSArray

    var defaultsToRegister = [String: AnyObject]()

    for prefSpecification in preferences {
        guard let key = prefSpecification["Key"] as? String,
        let defaultValue = prefSpecification["DefaultValue"] else {
            continue
        }

        defaultsToRegister[key] = defaultValue
    }
    NSUserDefaults.standardUserDefaults().registerDefaults(defaultsToRegister)
} 
```

# asp.net - 有没有免费的基于网络的 web.config 编辑器？

> ID：510218
> 
> 赞同：0
> 
> 时间：2009-02-04T05:51:31.930
> 
> 标签：asp.net, web-config

有谁知道 web.config 的基于 Web 的编辑器？我想通过一个漂亮的网络界面提供更改和添加设置的可能性。

**更新：**我知道安全问题，但我仍然想让它成为可能。该应用程序是一个内部应用程序，不可用于外部。我在 web.config 中配置授权，并希望能够管理能够访问该应用程序的用户。此外，我有一些我想要更新的应用程序设置。例如邮件服务器、连接字符串等。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-04T06:03:35.073

在这一点上，我倾向于同意 GregD... 公开 web.config 根本不是一个好主意。如果您真的希望用户能够配置一些设置，请为其提供一个接口，允许用户根据需要设置值。如果需要示例，请查看内置的 ASP.NET 网站管理工具。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-04T05:55:38.833

无法从 Internet 读取 web.config 是有充分理由的。不要这样做。

**编辑添加** 您希望通过打开 web.config 来完成什么？web.config 是您存储数据库连接字符串、关闭/打开调试、在本地或远程显示错误消息等的地方。通过 Web 界面打开 web.config 以“编辑”，真的是在找人破解它，从而获得对您的应用程序的完全访问权限。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-06T00:45:07.957

我同意你可能不应该这样做......但是因为我们都是成年人，所以违背了原则......

如果您的网站在完全信任模式下运行，则可以修改 web.config。例如，如果您托管在 GoDaddy 上，那么您可能不走运。

话虽如此，您可以利用[我为 BlogEngine 编写的管理页面，](http://www.dscoduc.com/post/2008/06/Manage-Files-Extension.aspx)它允许您编辑您已授予 AppPool 服务编辑权限的任何文件。您可能希望将其重新制作为用户控件，然后将其添加到**受保护**的url 地址和/或文件夹中。

# c# - 使用 OledbConnection 的 Linq to XML 和 Excel 之间的速度差异？

> ID：510232
> 
> 赞同：3
> 
> 时间：2009-02-04T05:58:25.130
> 
> 标签：c#, xml, linq, excel, linq-to-xml

我目前的一个要求是接收一个用户每周更新一次的 Excel 电子表格，并能够查询该文档的某些字段。

截至目前，我运行并将所有 Excel (2007) 数据推送到一个 xml 文件中（当他们上传文件时只有一次，然后我只使用 xml），然后保存所有需要的数据（不是所有电子表格中的列）用于通过 Linq-to-XML 进行查询；请注意，xml 文件比 excel 小。

现在我的问题是，使用 Linq 查询 XML 文件和使用 OledbConnection 查询 Excel 文件之间是否存在性能差异？我只是添加了另一个不必要的步骤吗？我想接下来的问题是，为了易于使用而继续将其推送到 xml 是否值得。

该文件有大约 1000 行。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-06T14:20:00.947

对于每周只做一次的事情，我认为不需要执行任何优化。相反，您应该专注于对您和将来维护解决方案的人来说是可维护和可理解的。

使用您认为最自然的任何解决方案:-)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2010-12-21T05:01:46.327

据我了解，访问 Excel 数据的性能方面就是这样。

最快到最慢
1\. 直接在 Excel 文件类型上使用 C++ 自定义第三方供应商软件。
2\. 如果数据类型需要，OleDbConnection 方法使用模式文件，将 Excel 视为平面文件数据库。
3\. Linq 2 XML 方法仅适用于 Excel 2007 文件格式的读取/写入数据的高级方法。
4\. 使用 OOXML SDK 和可选的第 3 方 xml 库直接进行 XML 数据操作。再次仅限于 Excel 2007 文件格式。
5\. 使用 Object[,] 数组读取单元格区域（使用 .Value2 属性），并将 Object[,] 数组再次传回单元格区域（再次使用 .Value2 属性）以写入数据。
6\. 使用 .Cells(x,y) 和 .Offset(x,y) 属性访问器单独更新和读取单元格。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-05T01:13:57.027

您不能使用 SqlConnection 访问 Excel 电子表格。您很可能使用的是 OleDbConnection 或 OdbcConnection。

话虽如此，我*猜想*使用 OleDbConnection 访问 Excel 工作表会更快，因为您正在本地处理数据，但了解*您*正在使用的数据的唯一方法是使用 Stopwatch 类自己测试它在 System.Diagnostics 命名空间中，或使用分析工具。

如果您有大量数据要处理，您可能还需要考虑将其放入 SQL Server 中，然后对其进行查询（当然，这取决于查询与保存数据所需时间的比率）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-06T14:11:32.387

我认为讨论您对文件执行的查询类型很重要。我必须相信，使用 LINQ 进行查询要比使用 oledbconnection 容易得多，尽管我说的更多是经验。

# sql - 为自定义产品类型定义通用数据模型

> ID：510234
> 
> 赞同：6
> 
> 时间：2009-02-04T05:59:53.393
> 
> 标签：sql, sql-server, database, database-design, data-modeling

我想创建一个产品目录，允许目录中每种产品类型的复杂细节。产品类型具有与之关联的截然不同的数据；有些只有通用数据，有些有一些额外的数据字段，有些有许多特定于该产品类型的字段。我需要轻松地将新产品类型添加到系统中并尊重它们的配置，并且我喜欢关于如何为这些产品设计数据模型以及如何处理持久性和检索的提示。

有些产品将非常通用，我计划使用通用 UI 来编辑这些产品。具有与之关联的可扩展配置的产品将获得为其编辑创建的新视图（和控制器）。我希望所有定制产品都定义自己的模型，但共享一个公共基类。基类将表示没有自定义字段的通用产品。

需要处理的示例产品：

1.  通用产品
    *   描述
2.  灯泡
    *   描述
    *   类型（包括荧光灯、白炽灯、卤素灯、led 灯）
    *   瓦数
    *   样式（洪水、斑点等的枚举）
3.  冰箱
    *   描述
    *   制作
    *   模型
    *   样式（在域模型中有一个枚举）
    *   滤水器信息
        *   零件号
        *   描述

我希望使用 MEF 来发现系统中可用的产品类型。我计划创建包含产品类型模型、视图和控制器的程序集，将这些程序集放入 bin 中，并让应用程序发现新的产品类型，并在导航中显示它们。

1.  使用 SQL Server 2008，存储这些不同类型的产品的最佳方式是什么，允许添加新类型而无需增加数据库架构？

2.  从数据库中检索数据时，将这些多态实体转换为正确的域模型的最佳方法是什么？

* * *

## 更新和说明

1.  为了避免内部平台效应，如果每种产品类型都有一个数据库表（用于存储该类型的产品），那么我仍然需要一种方法来检索跨产品类型的所有产品。那将如何实现？

2.  我与 Nikhilk 就他的 SharePoint 参考进行了更详细的交谈。具体来说，他在谈论这个：http: [//msdn.microsoft.com/en-us/library/ms998711.aspx](http://msdn.microsoft.com/en-us/library/ms998711.aspx)。它实际上看起来很有吸引力。无需解析 XML；并且可以进行一些索引，以允许对数据进行简单快速的查询。例如，我可以通过知道该行中的第一个 int 列是该行代表一个灯泡时的瓦数来说“找到所有 75 瓦的灯泡”。应用层中的某些东西（NHibernate？）将定义从产品类型到用户数据模式的映射。

3.  否决了具有属性表的模式，因为这可能导致每个产品有很多行。这可能会导致索引困难，而且所有查询基本上都必须对数据进行透视。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-04T17:08:31.033

使用 Sharepoint 样式的 UserData 表，该表具有一组字符串列、一组 int 列等和一个 Type 列。

然后你有一个类型表的列表，它指定了每种类型的架构——它的属性，以及它们在 UserData 表中映射到的特定列。

使用 Azure 和其他实用程序计算存储之类的东西，您甚至不需要定义表。每个 store 对象基本上都是一个字典。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-04T06:52:35.503

我认为您需要使用类似的数据模型-

**产品表**

*   产品 ID (PK)
*   产品名称
*   细节

**属性表**

*   属性 ID (PK)
*   产品 ID (FK)
*   ParentPropertyId（FK - 自引用以对属性进行分类）
*   属性名称
*   适当的价值
*   属性值类型 ID

**属性值查找表**

*   PropertyValueLookupId (PK)
*   属性 ID (FK)
*   查找值

然后有一个基于此的动态视图。您可以使用 PropertyValueTypeId 列来标识类型，使用约定，例如（0-字符串、1-整数、2-浮点数、3-图像等） - 但最终您可以仅存储无类型的所有内容。您还可以使用此列选择控件模板以将相应的属性呈现给用户。

您可以使用值查找表来查找特定属性（以便用户可以从列表中选择它）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-09T15:16:26.033

总结一下，让我们看看正在考虑的存储产品信息的选项：1）数据库中的一些 xml 格式

2）类似于上面关于有x个类型定义列的帖子（sharepoint方法）

3）通过具有存储在查找表中的名称和类型定义的通用表以及具有列 id、propertyid、value 的辅助表中的值（类似于＃2，但是这种方法将提供无限的属性信息

4) 上述选项的一些混合，其中产品表将有 x 个公共列（用于存储所有产品共有的属性）和 y 个用户定义的列（这可能是整数类型的 m 和 varchar 类型的 n）。这可能会充分利用#2 和标准化结构，就好像您知道所有产品的所有属性一样。您将获得最常使用的属性（可能是所有产品中常见的属性）的最佳 sql 性能，同时仍允许为每个产品的特定属性自定义列。

还有其他选择吗？在我看来，我认为上述 4 是组合的最佳混合。

*   戴夫

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-04T06:35:52.510

将尽可能多的共享预期结构放入传统的规范化 3NF 模型中，然后酌情增加 XML 列。

我看不到 MEF（或任何其他 ORM）能够透明地完成所有这些工作。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-04T07:07:25.067

我认为您应该避免[内部平台效应](http://en.wikipedia.org/wiki/Inner-Platform_Effect)并实际为您的专业实体构建表。您将编写特定的代码来管理它们，那么为什么不也有适当的后备表呢？

它会使您的部署稍微困难一些 - 放入一个程序集并运行一个脚本 - 但从长远来看，它可能会为您节省很多痛苦。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-04T18:04:09.423

杰夫，

我们目前使用 Products 表中的 XML 字段来处理所有特定于产品的数据。因此，我们的 Products 表有一些所有产品共享的公共字段，一个包含特定产品额外需要的 XML 的 XML，以及一些抓取到 XML 中并将一些经常查询的字段显示为“虚拟”字段的计算字段。 Products 表（例如，“Style”将设置为当前产品定义的任何内容，如果产品没有 Style 属性，则设置为 NULL）。

到目前为止，我们已经非常灵活地使用了这种方法——如果您为 XML 创建了一些不错的 XSD 模式，您甚至可以为这些字段创建 C# 代理类。

对我们来说效果很好 - 加入了关系和 XML 世界的精华。

马克

# c# - 从绝对名称 C# 获取 URI/URL 的父名称

> ID：510240
> 
> 赞同：21
> 
> 时间：2009-02-04T06:03:15.010
> 
> 标签：c#, uri

给定一个绝对 URI/URL，我想得到一个不包含叶子部分的 URI/URL。例如：给定[http://foo.com/bar/baz.html](http://foo.com/bar/baz.html)，我应该得到[http://foo.com/bar/](http://foo.com/bar/)。

我能想出的代码似乎有点冗长，所以我想知道是否有更好的方法。

```
static string GetParentUriString(Uri uri)
    {            
        StringBuilder parentName = new StringBuilder();

        // Append the scheme: http, ftp etc.
        parentName.Append(uri.Scheme);            

        // Appned the '://' after the http, ftp etc.
        parentName.Append("://");

        // Append the host name www.foo.com
        parentName.Append(uri.Host);

        // Append each segment except the last one. The last one is the
        // leaf and we will ignore it.
        for (int i = 0; i < uri.Segments.Length - 1; i++)
        {
            parentName.Append(uri.Segments[i]);
        }
        return parentName.ToString();
    } 
```

一个人会使用这样的功能：

```
 static void Main(string[] args)
    {            
        Uri uri = new Uri("http://foo.com/bar/baz.html");
        // Should return http://foo.com/bar/
        string parentName = GetParentUriString(uri);                        
    } 
```

谢谢，罗希特

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2011-02-17T04:18:29.760

你试过这个吗？看起来很简单。

```
Uri parent = new Uri(uri, ".."); 
```

* * *

## 回答 #2

> 赞同：32
> 
> 时间：2009-02-04T06:09:26.980

这是我能想到的最短的：

```
static string GetParentUriString(Uri uri)
{
    return uri.AbsoluteUri.Remove(uri.AbsoluteUri.Length - uri.Segments.Last().Length);
} 
```

如果要使用 Last() 方法，则必须包含 System.Linq。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-05-21T06:20:22.417

必须有一种更简单的方法可以使用内置的 uri 方法来执行此操作，但这是我对 @unknown (yahoo) 建议的看法。
在这个版本中你不需要`System.Linq`它，它还处理带有查询字符串的 URI：

```
private static string GetParentUriString(Uri uri)
{
    return uri.AbsoluteUri.Remove(uri.AbsoluteUri.Length - uri.Segments[uri.Segments.Length -1].Length - uri.Query.Length);
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-04T06:12:16.303

又快又脏

```
int pos = uriString.LastIndexOf('/');
if (pos > 0) { uriString = uriString.Substring(0, pos); } 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-04-13T18:27:08.857

我发现的最短方法：

```
static Uri GetParent(Uri uri) {
    return new Uri(uri, Path.GetDirectoryName(uri.LocalPath) + "/");
} 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-08-08T00:38:45.090

PapyRef 的答案不正确，`UriPartial.Path`包括文件名。

```
new Uri(uri, ".").ToString() 
```

似乎是请求功能的最干净/最简单的实现。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2016-07-22T11:43:58.003

我在这里阅读了很多答案，但没有找到我喜欢的答案，因为它们在某些情况下会中断。

所以，我正在使用这个：

```
public Uri GetParentUri(Uri uri) {
    var withoutQuery = new Uri(uri.GetComponents(UriComponents.Scheme |
                                                 UriComponents.UserInfo |
                                                 UriComponents.Host |
                                                 UriComponents.Port |
                                                 UriComponents.Path, UriFormat.UriEscaped));
    var trimmed = new Uri(withoutQuery.AbsoluteUri.TrimEnd('/'));
    var result = new Uri(trimmed, ".");
    return result;
} 
```

**注意：**它会故意删除查询和片段。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2011-03-10T18:26:18.743

```
new Uri(uri.AbsoluteUri + "/../") 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2015-05-07T06:01:39.243

获取 url 的分段

```
url="http://localhost:9572/School/Common/Admin/Default.aspx"

Dim name() As String = HttpContext.Current.Request.Url.Segments

now simply using for loop or by index, get parent directory name

code = name(2).Remove(name(2).IndexOf("/")) 
```

这让我回到“普通”

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2018-06-11T13:35:22.697

以为我会插话；尽管已经将近 10 年了，但随着云的出现，获取父 Uri 是一个相当普遍（并且 IMO 更有价值）的场景，因此在这里结合一些答案，您只需使用（扩展）Uri 语义：

```
public static Uri Parent(this Uri uri)
{
    return new Uri(uri.AbsoluteUri.Remove(uri.AbsoluteUri.Length - uri.Segments.Last().Length - uri.Query.Length).TrimEnd('/'));
}

var source = new Uri("https://foo.azure.com/bar/source/baz.html?q=1");

var parent = source.Parent();         // https://foo.azure.com/bar/source
var folder = parent.Segments.Last();  // source 
```

我不能说我已经测试了所有场景，所以建议谨慎。

# java - log4j API 中 FileAppender 的疑问

> ID：510254
> 
> 赞同：0
> 
> 时间：2009-02-04T06:12:59.187
> 
> 标签：java, logging, log4j

我创建了 java 程序，它将处理进入特定文件夹的不同文件。在我的程序中，我需要为每个传入文件创建日志文件，以记录该文件的异常。我为此使用了以下代码。我面临的问题是它创建日志文件和日志记录异常的第一个文件。当第二个文件文件出现时，它会创建单独的日志文件并记录第二个文件的异常，同时将第二个文件的异常与第一个文件的异常一起记录在第一个文件的日志文件中。我不希望将第二个文件的异常附加到第一个文件的日志文件中。怎么做？

```
private Appender myAppender;
private Logger logger = Logger.getLogger(ConfigFileReader.class.getName());

//filename is dynamic based on the incoming file
myAppender = new FileAppender(new AppXMLLayout(),filename+".log",true);
logger.addAppender(myAppender); 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-04T06:18:21.173

当您为新文件添加附加程序时，您需要使用 removeAppender 删除早期文件的附加程序。简而言之，一旦您对第一个文件的处理完成删除附加程序。

# delphi - Delphi2009中如何使用ReverseString函数？

> ID：510257
> 
> 赞同：1
> 
> 时间：2009-02-04T06:15:57.420
> 
> 标签：delphi, string, reverse

`ReverseString`Delphi2009如何使用该功能？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-04T06:18:23.357

我对Delphi一无所知，但[简单的谷歌搜索“ReverseString Delphi 2009”](http://www.google.com/search?q=ReverseString+Delphi+2009)会让你得到这个答案：

```
var s : string;

s:='ABOUT DELPHI PROGRAMMING';
s:=ReverseString(s);

//s='GNIMMARGORP IHPLED TUOBA'
// this code is from about.com 
```

所以，我假设你遇到了其他问题？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-19T20:43:37.347

@Pax - 我将它用于朋友的提词器程序。不知道还有什么其他用途，但这是我找到的。我很高兴找到一个内置函数，所以我不必自己做...... :-)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-19T20:47:17.870

很久以前，我在我的 ZX Spectrum 上为此编写了一个函数来查找押韵的单词。至少在瑞典语中，反转单词然后对其进行排序会产生不错的结果。

# .net - 帮助 Castle Active Record DeleteAll HQL 字符串

> ID：510258
> 
> 赞同：0
> 
> 时间：2009-02-04T06:15:59.197
> 
> 标签：.net, castle-activerecord

所以我基本上想在我的 AR 类中有一个静态方法来删除指定表达式上的所有记录。但显然 Castle Active Record 没有 IQuery 参数过载（至少不是我使用的版本）。

这就是我“有效地”试图实现的目标：

```
public static void Delete(string pAppIdentifier) {
  DeleteAll(new EqExpression("AppIdentifier", pAppIdentifier));
} 
```

可以使用 HQL（因为 DeleteAll 的重载之一允许使用 where HQL 字符串，但我真的还没有完全理解 HQL 及其所有功能，我希望我的 Stack Overflow 同行之一可以帮助我把上面的例子变成高质量的。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-05T11:52:27.160

```
DeleteAll(string.Format("AppIdentifier='{0}'", pAppIdentifier)) 
```

这被翻译成：

```
session.Delete(string.Format("from {0} where {1}", type.Name, where)); 
```

顺便说一句，请确保 pAppIdentifier 参数是安全的，否则您将有潜在的 SQL 注入漏洞。

[ActiveRecord wiki](http://using.castleproject.org/display/AR/FAQ)中的这个和其他常见问题。

# programming-languages - 你如何保持所有语言的正确性？

> ID：510261
> 
> 赞同：11
> 
> 时间：2009-02-04T06:18:31.580
> 
> 标签：programming-languages

我想我有点疯了。

现在，我正在使用以下语言（我只是在做一个心理清单）：

*   C++ - 我们的游戏引擎
*   汇编器 - 低级调试和一些协处理器特定例程
*   Lua - 我们的游戏引擎脚本语言
*   HLSL - 用于着色器
*   Python - 我们的构建系统和实用工具
*   Objective C/C++ - Mac 和 iPhone 的游戏引擎平台代码
*   C# - 我们海外办事处开发的一些工具
*   ExtendScript - Photoshop 导出工具
*   ActionScript - UI 脚本
*   VBScript - 一些电子表格相关的东西
*   PHP - 一些与网络相关的东西
*   SQL - 一些网络和工具相关的东西

除此之外，还有大量的 API，它们通常有许多不同的方式来做同样的事情：std library、boost、.NET、wxWidgets、Cocoa、Carbon、Python、Lua 等的本机脚本库、OpenGL、Direct3d、GDI ，阿克娅，哎呀！

我发现自己无意中将语言和 api 混为一谈，直到出现语法错误才意识到自己在做什么。我觉得我不可能跟上它，我不可能精通所有这些领域。尤其是在 C++ 和 Python 领域之外，我发现自己更多地通过查看记忆手册来进行编程。

你有类似的问题吗？划分的想法让你更有效率？决定你想在哪里保持精通？组织提示？记住从 Lua 切换到 C++ 时需要重新开始使用分号的好方法？抱怨我们程序员为自己做的事情有多复杂？

欢迎任何想法！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-04T09:43:01.277

我做了一些事情来让他们分开......

为不同的语言使用不同的 IDE/编辑器/配色方案。你开始将语言与环境联系起来，当你切换窗口时，你的大脑会得到一个很大的视觉提示，它需要上下文切换到新语言。

尝试一次将上下文切换限制为 2 或 3 种活动语言。完成后关闭任何其他 IDE 或编辑器窗口。

试着忘记“一劳永逸”的东西。您列出的许多语言似乎不是您每天都在积极编码的东西，而是您用来自动化日常任务的工具。尽可能尝试有一个“工具日”，在那里你可以在这些工具上做任何你需要做的工作。尽可能将它与你的日常编码分开，这样你的大脑就不必担心页面一直在交换那些东西。

-- 编辑提示，而不是队列。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-04T06:27:53.150

我想一段时间后它对你来说很自然。当我第一次认真对待编程时，我使用了多种语言——尤其是 Java 和 C#。我发现自己不小心在 C# 中使用了某些 Java 特性，反之亦然。对我来说幸运的是，它们的很多功能都是相同的，所以它把我救到了那里，但是当我继续前进时，这并不是一个真正的问题。

尝试在每种语言上花费大量时间。坐下来阅读一本关于每种语言的好书（或几本）并熟悉它。问问你的老板，你是否可以一次将大部分时间花在一个部分上。在你犯错之前，你会开始发现更多的错误。对于那些你不知道的人，这就是创建调试器的原因——程序员最好的朋友。我有一个糟糕的记忆力，我的意思是可怕的。您可能认为这让我的编程变得更加困难，但事实并非如此。在使用一种语言很长一段时间后，这些功能似乎就来了。

因此，请尝试在每种语言上花费更多时间，而不是跳来跳去尝试一次学习所有语言。这些信息会更好地与你联系，当编码时间到来时，你会变得不那么慌乱和困惑。尝试做一些有助于在编程时保持专注的事情。如果大量咖啡因有帮助，那就去吧！如果听你最喜欢的音乐有帮助，那就去吧！（对我来说，我无法专注于最小的声音，但每个人都不同）。

祝你好运！

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-02-04T09:25:16.053

对于我打算彻底学习的任何语言，我将在 Vim 中编写自己的语法高亮。我尝试使着色严格，以便在我键入时着色会发现明显的错误。这有助于我记住将某些语法项放在哪里，以防我忘记（所以 // 在 python 中看起来不像注释，而且我总是难以记住在 C 中将 * 或 [] 放在哪里）。如果我不记得某个函数或方法的名称，我猜它，如果它以颜色显示，我知道我拼写正确。我还尝试选择不同的颜色，以便不同的语言相互突出，这有助于我的大脑记住我正在写的语言。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-02-04T09:35:44.753

当我从一种语言更改为另一种语言时，我第一次无法正确使用的功能是数组。它们总是有不同的语法，我最终每次都查找它们。以下是我最常用的语言列表以及如何在其中实现数组：

```
//Java:
int[] array1 = new int[5];
int[] array2 = {0, 1, 2, 3, 4};
//C/C++:
int array1[5];
int array2[5] = {0, 1, 2, 3, 4};
//JavaScript:
var array1 = new Array(5);
var array2 = [0, 1, 2, 3, 4];
//PHP:
$array1 = array(5);
$array2 = array(0, 1, 2, 3, 4);
//Python:
array1 = []#According to the comments, we don't care about size!
arary2 = [0, 1, 2, 3, 4]; #Could use range to create a sequence 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-02-04T09:41:10.780

您在 web-dev 中发现的一件事是，几乎按照定义，如果您想要能够进行端到端工作，您需要至少能够使用 5 种语言（SQL、中间层、html、css、js） ，并且每个稍微不同的项目都会添加*其他东西*（jQuery？Flash？XML？）。

我认为您必须自然地理解这一点，但有两件事确实有帮助：

*   **学习概念，而不是语法**，并在需要时依靠 IDE 和谷歌（另一个原因是语言特定的面试问题没有意义），因为这些适用于任何事情，并且更容易看到特定领域的组件滑入和滑出而不是认为你正在学习完全不同的东西

*   **在可能的情况下坚持使用类似的语言语法系列**- 我知道我个人发现 C# 比 PHP 更自然，因为它与 JS 和 Actionscript、XML 共享语法，因为我对 HTML 很熟悉

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-02-04T10:28:48.157

我同意：那里有太多的语言和 API。

如果您是客户，并且语言和 API 就像 T 恤一样，那么您会很高兴您拥有最大的选择。嘿，如果您想要一种静态类型的语言，它可以为您提供很大的灵活性和高性能，请选择 C++！如果您想要更容易维护的东西，请使用 Java、Python 或 Ruby，或者您自己命名。你有选择。你应该感到高兴。

但事实是，你更像是一个盖房子的人，而语言和 API 就像螺丝钉和螺栓：它们是你的工具。如果您有 1000 种不同类型的螺钉和螺栓，每种都有不同的特性和局限性，那么您的工作将是一场噩梦。你会更专注于你的工具而不是你正在建造的房子（这是否敲响了警钟？）。当然，我知道没有万能的螺栓，但您当然可以想象生活中只有几种不同类型的螺栓，不是吗？

我认为问题在于建筑行业的人喜欢他们正在建造的房屋……而我们开发人员只是喜欢螺栓。我也不例外：我只是喜欢学习一门新的语言或框架。螺栓太漂亮了。;-)

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-02-04T06:40:25.043

如果没有六个 API 和语言参考书签放在我的桌面上，我个人几乎没有前进的希望。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-02-04T07:02:47.980

我感觉到你的痛苦，兄弟。

不过，我不知道；我认为多语言能力（或至少多语言通用意识）只是我们生活的世界，也是我们即将习惯的东西。不知何故。唉，不过，我不知道保持理智的秘诀是什么。（虽然对我来说，我可以说啤酒绝对有帮助。）

我团队中的一些人（顺便说一下，我也在 Real 工作）在 Windows 上使用 C++ 开发，用于 Windows，仅此而已 - 这就是他们多年来一直在做的事情，他们很擅长，他们喜欢它，他们很高兴能把这件事做得很好。

另一方面，我——我从来没有能够适应任何一种语言，而且我想我也不想这样做；一般来说，在过去的十年中，我每年都会学习一门语言，其中一些与其他语言不同（ColdFusion，有人吗？），而这些天来，我几乎所有的工作都是在 Flash、Flex 和 ActionScript 中完成的。如果你两年前告诉我我今天要做什么，我敢肯定我会笑的。跟上有时会让人筋疲力尽（不久前我也[发布了类似](https://stackoverflow.com/questions/455328/how-do-you-manage-your-continuing-education)的帖子——也有其他人的一些好答案），但我似乎无法抗拒检查新内容、保持最新状态等。

不过，继 John T 和 Scott 的评论之后，我要说的一件事是：书籍是唯一的出路。书籍，至少对我而言，以及阅读大量（好的——不坏的）代码，是让一种语言逐渐、紧密地渗入你的大脑的最佳方式，而这只是需要时间。就像我说的，我使用 Flash 已经快两年了，而且我现在才开始觉得我可以流利地说 ActionScript。总而言之，我的桌子上可能有十本 AS 书，而一旦我读完我正在阅读的那本，楼下还有两本书在等着我。

它永远不会结束。呜呼！

PS：VBScript，但是？呃，这太可怕了。对不起。;)

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-02-04T09:02:58.097

我工作的优势之一是我能够从一个项目切换到另一个项目，使用不同的语言、操作系统、编码规则、QA 要求……

我发现保持领先的唯一方法不是了解每种语言的每一点，而是了解参考文档是什么以及在哪里可以找到它们。例如，我对 perl、TCL/TK 和各种风格的 Unix 和 Linux 使用 man 命令，Ada 的在线语言参考手册，Objective-C 和 Cocoa 的 Apple 开发人员资源。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2010-03-19T00:07:54.883

您可以执行的任何项目调度以最小化上下文切换可能会有所帮助。你能在 C++ 代码稳定之前推迟 Web 开发吗？

我尝试做的另一件事是有一个新语言的良好“工作示例”。尝试找到您当前使用的语言的中小型样本，并将其放在手边。我发现从我有点熟悉的一段示例代码中获取语法细节通常比从参考手册中挖掘细节要快。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2011-11-06T22:16:38.943

人类不能多任务。时期。

[http://www.joelonsoftware.com/articles/fog0000000022.html](http://www.joelonsoftware.com/articles/fog0000000022.html)

如果你不允许让其他人做这项工作，因为他们已经有完整的盘子，那么请雇用更多的人。如果不允许你雇佣更多的人，那么也许人们至少可以转移优先级，这样每个人都可以更加专注。

例如：如果你全职在引擎上，或者除了错误修复之外的任何级别的承诺，你为什么要研究游戏逻辑？和内容工具？ *并*构建工具？ **和**网络开发？如果你不是在谈论一年的时间跨度，也许每个月都专注于一个单独的固定月份，那么听起来你完成了所有的编程，而其他人只是摆弄他们的拇指。

当然，您只是其中一个领域的专家，而不是所有领域的专家。有整个“如果你被公共汽车撞了”的事情。如果你是那个人，那么这对你来说是工作保障，但对你的公司*和你的理智*来说却很糟糕。

您可以尝试更多地匹配工具。将尽可能多的东西转移到 Python 或 .Net，因为我认为你不能为你的游戏放弃你的核心技术。

# css - 同一 HTML 出现在多个页面上时设置样式的最佳策略

> ID：510268
> 
> 赞同：3
> 
> 时间：2009-02-04T06:25:14.093
> 
> 标签：css

我有一个简单的 HTML 表格，它有 2 列，其中包含文本字段和“名称”、“评论”和“电子邮件”的标题。

如果要出现在多个页面上，我正在寻找样式化此 HTML 片段的最佳策略 - 每个页面上需要不同的尺寸。我最近读了很多关于 CSS 的文章，但没有偶然发现足够的信息，但这真的让我很舒服地知道设计此类 .css 的最佳方式。

例如，我可能会在“评论”页面上以 50% 的宽度显示评论表单，但在网站上一些其他位置的侧边栏中仅显示 20% 的宽度。

我主要关心的是框的宽度的样式 - 但当然同样的方法适用于文本。例如，名称字段不应与电子邮件字段一样宽。我认为固定宽度比百分比好。

显然有很多方法来设计它。假设我已经有 1 个主 css 文件。

1）在标签上放置百分比宽度`input`，然后外部div对于它包含的任何面板都是100％宽度。这不需要特定于页面的css，但我不喜欢`td`标签内百分比的想法，而且我不能改变轻松的高度`textarea`。

2) 在每个单独的页面中为#Name、#Comments 和#Email 创建样式，作为`<head><style>`*中的附加样式

3) 基于页面特定 css 文件中的#Name、#Comments 和#Email 的样式。特定于页面的文件是好是坏？我什至不确定我是否喜欢这里基于 id 的样式，因为它们是动态生成的，如果由于某种原因需要更改，我必须在任何地方更新 css。

4) 基于#Name、#Comments 和#Email 的样式，但使用特定于每个页面的后代选择器来限定它们。`.faqPage #Name`因此，当它出现在常见问题解答页面上时，我将不得不这样做。显然这些都在我的主 css 文件中。

`,`5) 为“emailField nameField commentsField ”创建类名`and`[此选项重复选项 2、3、4]

`,`6) 为“shortField fullWidthField textInputField ”创建类名`and`[此选项重复选项 2、3、4]

7）你明白了：）

8) 别的东西

我对所有的选择有点不知所措。我如何去决定哪个是最好的方法？一个特定的目标是能够在多个页面上设置相同的 HTML 样式（显然这就是 css 的全部内容 - 但它确实会影响我可以使用的选项）。

```
<div id="pnlSubmitComments">
<table class="fieldTable"> 
    <tr> 
    <td align="right"> 
        <label for="Comments">Name:</label> 
    </td> 
    <td> 
        <input id="Name" name="Name" type="text" value="" /> 
    </td> 
    </tr> 
    <tr> 
    <td align="right"> 
        <label for="Comments">Email:</label> 
    </td> 
    <td> 
        <input id="Email" name="Email" type="text" value="" /> 
    </td> 
    </tr> 
     <tr> 
    <td align="right" valign="top"> 
        <label for="Comments">Questions:</label> 
    </td> 
    <td> 
        <textarea id="Comments" name="Comments"> 
</textarea> 
    </td> 
    </tr> 
    <tr> 
    <td> 
    </td> 
    <td> 
        <input id="btnSubmitComments" name="btnSubmitComments" type="submit" value="Submit Questions" /> 
    </td> 
    </tr> 
</table> 
</div> 
```

*   PS。实际的字段名称更具体，例如`CommentsName`- 为了便于阅读，它更容易放在`Name`这里。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-04T06:50:48.097

旁注：也许您不应该使用表格来布局此表单，而是使用字段集，它会给您带来更大的灵活性。例如，如果您决定将标签和输入字段放在一个更窄的列中...

您没有表格的示例（看起来也更漂亮）：

```
<style type="text/css">
<!--

form { /* set width in form, not fieldset (still takes up more room w/ fieldset width */
    font: 100% verdana, arial, sans-serif;
    margin: 0;
    padding: 0;
    min-width: 500px;
    max-width: 600px;
    width: 560px;
}

form fieldset {
    /* clear: both; note that this clear causes inputs to break to left in ie5.x mac, commented out */
    border-color: #000;
    border-width: 1px;
    border-style: solid;
    padding: 10px; /* padding in fieldset support spotty in IE */
    margin: 0;
}

form fieldset legend {
    font-size: 1.1em; /* bump up legend font size, not too large or it'll overwrite border on left */
    /* be careful with padding, it'll shift the nice offset on top of border  */
}

form label {
    display: block; /* block float the labels to left column, set a width */
    float: left;
    width: 150px;
    padding: 0;
    margin: 5px 0 0; /* set top margin same as form input - textarea etc. elements */
    text-align: right;
}

form input, form textarea {
    /* display: inline; inline display must not be set or will hide submit buttons in IE 5x mac */
    width: auto; /* set width of form elements to auto-size, otherwise watch for wrap on resize */
    margin: 5px 0 0 10px; /* set margin on left of form elements rather than right of
     label aligns textarea better in IE */
}

textarea {
    overflow: auto;
}

 /* uses class instead of div, more efficient */
form br {
    clear: left; /* setting clear on inputs didn't work consistently, so brs added for degrade */
}
-->
</style>
<div id="pnlSubmitComments">
    <form>
        <fieldset>
            <label for="Comments">
                Name:
            </label>
            <input id="Name" name="Name" type="text" value="" /><br />
            <label for="Comments">
                Email:
            </label>
            <input id="Email" name="Email" type="text" value="" /><br />
            <label for="Comments">
                Questions:
            </label>
            <textarea id="Comments" name="Comments">
            </textarea><br />
            <label for="spacing"></label>
            <input id="btnSubmitComments" name="btnSubmitComments" type="submit" value="Submit Questions" />
        </fieldset>
    </form>
</div> 
```

现在到你的主要问题。我会这样做：

我会使用我想在其中使用表单的不同布局列的 id。所以如果我在我的主列 () 中使用它，我会相应地编写 CSS，如下所示：

```
#main .pnlSubmitComments form fieldset {
    /*your CSS*/ 
} 
```

和侧柱分别

```
#side .pnlSubmitComments form fieldset {
    /*your CSS*/
} 
```

您可以通过分配如下类来控制每个元素：

```
<input type="text" class="email" name="email" id="email" /> 
```

然后你完全按照上面的描述做：

```
#main .email {
   /*your css for the .email textbox/*
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-04T08:04:13.457

如果您可以在容器元素上添加样式类，则可以使用一个 css 文件轻松完成。

例如，第 1 页将具有以下 html：

```
<body class="page1">
  <!-- repeated html here -->
  <input />
</body> 
```

在第 2 页上，您将拥有：

```
<body class="page2">
  <!-- repeated html here -->
  <input />
</body> 
```

在您的单个 css 文件中，您可以根据 body 元素的类定位输入标签：

```
body.page1 input { width: 25%; }
body.page2 input { width: 50%; } 
```

因此，您保持 html 相同，只需更改容器元素的类（或 id），并使用它来编写不同的 css 规则。

更新：重读您的列表后，我发现这或多或少在您的列表中排在第 4 位。如果您可以使用它，我认为这是一个不错的选择。我还使用它来定位不同的浏览器，方法是在 body 标记上添加一个指示浏览器的类。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-04T06:49:00.770

1）使用常见的css并在后面的代码中设置一些值，如宽度。

2）为不同的需求创建多个css文件，并使用后面的代码将正确的css链接到页面。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-06-20T00:22:10.047

抱歉这么久才回复你！

CSS-GRID with`grid-template-areas`是一个很棒的方法！

您可以命名区域，然后使用响应式媒体查询切换 css 并更改布局，而无需重新排列 HTML。

[https://developer.mozilla.org/en-US/docs/Web/CSS/grid-template-areas](https://developer.mozilla.org/en-US/docs/Web/CSS/grid-template-areas)

# objective-c - Objective-C 中用于连接 NSString 的快捷方式

> ID：510269
> 
> 赞同：1159
> 
> 时间：2009-02-04T06:26:19.240
> 
> 标签：objective-c, nsstring, string-concatenation

在 Objective-C 中是否有 ( `stringByAppendingString:`) 字符串连接的快捷方式，或`NSString`一般使用的快捷方式？

例如，我想做：

```
NSString *myString = @"This";
NSString *test = [myString stringByAppendingString:@" is just a test"]; 
```

更像是：

```
string myString = "This";
string test = myString + " is just a test"; 
```

* * *

## 回答 #1

> 赞同：1163
> 
> 时间：2009-02-04T07:53:32.213

## 一个选项：

```
[NSString stringWithFormat:@"%@/%@/%@", one, two, three]; 
```

## 另外一个选项：

我猜你对多个附加 (a+b+c+d) 不满意，在这种情况下你可以这样做：

```
NSLog(@"%@", [Util append:one, @" ", two, nil]); // "one two"
NSLog(@"%@", [Util append:three, @"/", two, @"/", one, nil]); // three/two/one 
```

使用类似的东西

```
+ (NSString *) append:(id) first, ...
{
    NSString * result = @"";
    id eachArg;
    va_list alist;
    if(first)
    {
        result = [result stringByAppendingString:first];
        va_start(alist, first);
        while (eachArg = va_arg(alist, id)) 
        result = [result stringByAppendingString:eachArg];
        va_end(alist);
    }
    return result;
} 
```

* * *

## 回答 #2

> 赞同：631
> 
> 时间：2009-02-04T06:44:42.353

我能想到的两个答案......都没有一个连接运算符那么特别令人愉快。

首先，使用`NSMutableString`具有`appendString`方法的 ，消除对额外临时字符串的一些需求。

其次，使用 an`NSArray`通过`componentsJoinedByString`方法连接。

* * *

## 回答 #3

> 赞同：156
> 
> 时间：2011-03-17T11:59:13.837

如果你有 2 个 NSString**文字**，你也可以这样做：

```
NSString *joinedFromLiterals = @"ONE " @"MILLION " @"YEARS " @"DUNGEON!!!"; 
```

这对于加入#defines 也很有用：

```
#define STRINGA @"Also, I don't know "
#define STRINGB @"where food comes from."
#define JOINED STRINGA STRINGB 
```

享受。

* * *

## 回答 #4

> 赞同：82
> 
> 时间：2012-08-11T06:51:02.400

我不断返回这篇文章，并总是最终对答案进行排序，以找到这个简单的解决方案，它可以根据需要使用尽可能多的变量：

```
[NSString stringWithFormat:@"%@/%@/%@", three, two, one]; 
```

例如：

```
NSString *urlForHttpGet = [NSString stringWithFormat:@"http://example.com/login/username/%@/userid/%i", userName, userId]; 
```

* * *

## 回答 #5

> 赞同：53
> 
> 时间：2011-10-03T22:29:02.840

创建一个方法：

```
- (NSString *)strCat: (NSString *)one: (NSString *)two
{
    NSString *myString;
    myString = [NSString stringWithFormat:@"%@%@", one , two];
    return myString;
} 
```

然后，在您需要它的任何函数中，将您的字符串或文本字段或其他任何内容设置为此函数的返回值。

或者，要创建一个快捷方式，将 NSString 转换为 C++ 字符串并在此处使用“+”。

* * *

## 回答 #6

> 赞同：45
> 
> 时间：2012-03-16T00:41:54.720

好吧，由于冒号是一种特殊符号，但它*是*方法签名的一部分，因此可以扩展`NSString`with 类别以添加这种**非惯用**的字符串连接样式：

```
[@"This " : @"feels " : @"almost like " : @"concatenation with operators"]; 
```

您可以定义尽可能多的冒号分隔的参数，只要您觉得有用... ;-)

作为一个很好的衡量标准，我还添加`concat:`了可变参数，这些参数采用`nil`终止的字符串列表。

```
//  NSString+Concatenation.h

#import <Foundation/Foundation.h>

@interface NSString (Concatenation)

- (NSString *):(NSString *)a;
- (NSString *):(NSString *)a :(NSString *)b;
- (NSString *):(NSString *)a :(NSString *)b :(NSString *)c;
- (NSString *):(NSString *)a :(NSString *)b :(NSString *)c :(NSString *)d;

- (NSString *)concat:(NSString *)strings, ...;

@end

//  NSString+Concatenation.m

#import "NSString+Concatenation.h"

@implementation NSString (Concatenation)

- (NSString *):(NSString *)a { return [self stringByAppendingString:a];}
- (NSString *):(NSString *)a :(NSString *)b { return [[self:a]:b];}
- (NSString *):(NSString *)a :(NSString *)b :(NSString *)c
    { return [[[self:a]:b]:c]; }
- (NSString *):(NSString *)a :(NSString *)b :(NSString *)c :(NSString *)d
    { return [[[[self:a]:b]:c]:d];}

- (NSString *)concat:(NSString *)strings, ...
{
    va_list args;
    va_start(args, strings);

    NSString *s;    
    NSString *con = [self stringByAppendingString:strings];

    while((s = va_arg(args, NSString *))) 
        con = [con stringByAppendingString:s];

    va_end(args);
    return con;
}
@end

//  NSString+ConcatenationTest.h

#import <SenTestingKit/SenTestingKit.h>
#import "NSString+Concatenation.h"

@interface NSString_ConcatenationTest : SenTestCase

@end

//  NSString+ConcatenationTest.m

#import "NSString+ConcatenationTest.h"

@implementation NSString_ConcatenationTest

- (void)testSimpleConcatenation 
{
    STAssertEqualObjects([@"a":@"b"], @"ab", nil);
    STAssertEqualObjects([@"a":@"b":@"c"], @"abc", nil);
    STAssertEqualObjects([@"a":@"b":@"c":@"d"], @"abcd", nil);
    STAssertEqualObjects([@"a":@"b":@"c":@"d":@"e"], @"abcde", nil);
    STAssertEqualObjects([@"this " : @"is " : @"string " : @"concatenation"],
     @"this is string concatenation", nil);
}

- (void)testVarArgConcatenation 
{
    NSString *concatenation = [@"a" concat:@"b", nil];
    STAssertEqualObjects(concatenation, @"ab", nil);

    concatenation = [concatenation concat:@"c", @"d", concatenation, nil];
    STAssertEqualObjects(concatenation, @"abcdab", nil);
} 
```

* * *

## 回答 #7

> 赞同：37
> 
> 时间：2010-07-26T16:04:03.143

使用`stringByAppendingString:`这种方式：

```
NSString *string1, *string2, *result;

string1 = @"This is ";
string2 = @"my string.";

result = [result stringByAppendingString:string1];
result = [result stringByAppendingString:string2]; 
```

或者

```
result = [result stringByAppendingString:@"This is "];
result = [result stringByAppendingString:@"my string."]; 
```

* * *

## 回答 #8

> 赞同：31
> 
> 时间：2013-05-31T17:07:51.677

**宏：**

```
// stringConcat(...)
//     A shortcut for concatenating strings (or objects' string representations).
//     Input: Any number of non-nil NSObjects.
//     Output: All arguments concatenated together into a single NSString.

#define stringConcat(...) \
    [@[__VA_ARGS__] componentsJoinedByString:@""] 
```

**测试用例：**

```
- (void)testStringConcat {
    NSString *actual;

    actual = stringConcat(); //might not make sense, but it's still a valid expression.
    STAssertEqualObjects(@"", actual, @"stringConcat");

    actual = stringConcat(@"A");
    STAssertEqualObjects(@"A", actual, @"stringConcat");

    actual = stringConcat(@"A", @"B");
    STAssertEqualObjects(@"AB", actual, @"stringConcat");

    actual = stringConcat(@"A", @"B", @"C");
    STAssertEqualObjects(@"ABC", actual, @"stringConcat");

    // works on all NSObjects (not just strings):
    actual = stringConcat(@1, @" ", @2, @" ", @3);
    STAssertEqualObjects(@"1 2 3", actual, @"stringConcat");
} 
```

* * *

**备用宏：（**如果您想强制执行最少数量的参数）

```
// stringConcat(...)
//     A shortcut for concatenating strings (or objects' string representations).
//     Input: Two or more non-nil NSObjects.
//     Output: All arguments concatenated together into a single NSString.

#define stringConcat(str1, str2, ...) \
    [@[ str1, str2, ##__VA_ARGS__] componentsJoinedByString:@""]; 
```

* * *

## 回答 #9

> 赞同：27
> 
> 时间：2009-07-18T05:38:30.367

通过创建 AppendString (AS) 宏的快捷方式...

```
#define AS(A,B) [(A) stringByAppendingString:(B)]

NSString *myString = @"这个";

NSString *test = AS(myString,@" 只是一个测试");

```

**笔记：**

如果使用宏，当然只需使用可变参数即可，请参阅 EthanB 的答案。

* * *

## 回答 #10

> 赞同：27
> 
> 时间：2012-03-16T14:24:43.240

在构建 Web 服务请求时，我发现执行以下操作非常容易，并且可以在 Xcode 中使串联可读：

```
NSString* postBody = {
    @"<?xml version=\"1.0\" encoding=\"utf-8\"?>"
    @"<soap:Envelope xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:soap=\"http://schemas.xmlsoap.org/soap/envelope/\">"
    @" <soap:Body>"
    @"  <WebServiceMethod xmlns=\"\">"
    @"   <parameter>test</parameter>"
    @"  </WebServiceMethod>"
    @" </soap:Body>"
    @"</soap:Envelope>"
}; 
```

* * *

## 回答 #11

> 赞同：13
> 
> 时间：2010-06-10T09:50:33.863

```
NSString *label1 = @"Process Name: ";
NSString *label2 = @"Process Id: ";
NSString *processName = [[NSProcessInfo processInfo] processName];
NSString *processID = [NSString stringWithFormat:@"%d", [[NSProcessInfo processInfo] processIdentifier]];
NSString *testConcat = [NSString stringWithFormat:@"%@ %@ %@ %@", label1, processName, label2, processID]; 
```

* * *

## 回答 #12

> 赞同：11
> 
> 时间：2012-08-30T02:29:57.343

这是一个简单的方法，使用新的数组字面量语法：

```
NSString * s = [@[@"one ", @"two ", @"three"] componentsJoinedByString:@""];
                  ^^^^^^^ create array ^^^^^
                                               ^^^^^^^ concatenate ^^^^^ 
```

* * *

## 回答 #13

> 赞同：9
> 
> 时间：2013-08-01T13:13:10.803

```
NSString *myString = @"This";
NSString *test = [myString stringByAppendingString:@" is just a test"]; 
```

在使用 Objective CI 几年后，认为这是使用 Objective C 实现您想要实现的目标的最佳方式。

在您的 Xcode 应用程序中开始键入“N”，它会自动完成为“NSString”。键入“str”，它会自动完成“stringByAppendingString”。所以击键是相当有限的。

一旦你掌握了按“@”键和制表符的窍门，编写可读代码的过程就不再是问题了。这只是适应的问题。

* * *

## 回答 #14

> 赞同：8
> 
> 时间：2009-02-04T07:25:32.113

缩短时间的唯一方法`c = [a stringByAppendingString: b]`是在该`st`点附近使用自动完成功能。运算符是 C的`+`一部分，它不了解 Objective-C 对象。

* * *

## 回答 #15

> 赞同：8
> 
> 时间：2012-07-03T22:36:29.943

如何缩短`stringByAppendingString`并使用**#define**：

```
#define and stringByAppendingString 
```

因此，您将使用：

```
NSString* myString = [@"Hello " and @"world"]; 
```

问题是它仅适用于两个字符串，您需要包装额外的括号以进行更多附加：

```
NSString* myString = [[@"Hello" and: @" world"] and: @" again"]; 
```

* * *

## 回答 #16

> 赞同：8
> 
> 时间：2013-04-29T07:35:26.753

```
NSString *result=[NSString stringWithFormat:@"%@ %@", @"Hello", @"World"]; 
```

* * *

## 回答 #17

> 赞同：7
> 
> 时间：2009-06-20T17:38:10.623

```
NSString *label1 = @"Process Name: ";
NSString *label2 = @"Process Id: ";
NSString *processName = [[NSProcessInfo processInfo] processName];
NSString *processID = [NSString stringWithFormat:@"%d", [[NSProcessInfo processInfo] processIdentifier]];
NSString *testConcat = [NSString stringWithFormat:@"%@ %@ %@ %@", label1, processName, label2, processID]; 
```

* * *

## 回答 #18

> 赞同：6
> 
> 时间：2013-05-11T16:38:10.857

我试过这段代码。它对我有用。

```
NSMutableString * myString=[[NSMutableString alloc]init];
myString=[myString stringByAppendingString:@"first value"];
myString=[myString stringByAppendingString:@"second string"]; 
```

* * *

## 回答 #19

> 赞同：6
> 
> 时间：2014-04-07T11:45:00.340

`lldb`在窗格中尝试以下操作

```
[NSString stringWithFormat:@"%@/%@/%@", three, two, one]; 
```

哪些错误。

而是使用 alloc 和`initWithFormat`方法：

```
[[NSString alloc] initWithFormat:@"%@/%@/%@", @"three", @"two", @"one"]; 
```

* * *

## 回答 #20

> 赞同：4
> 
> 时间：2011-03-23T17:37:16.933

这是为了更好的记录，并且只记录 - 基于 dicius 优秀的多参数方法。我定义了一个 Logger 类，并像这样调用它：

```
[Logger log: @"foobar ", @" asdads ", theString, nil]; 
```

几乎很好，除了必须用“nil”结束var args，但我想在Objective-C中没有办法解决这个问题。

记录器.h

```
@interface Logger : NSObject {
}
+ (void) log: (id) first, ...;
@end 
```

记录器.m

```
@implementation Logger

+ (void) log: (id) first, ...
{
    // TODO: make efficient; handle arguments other than strings
    // thanks to @diciu http://stackoverflow.com/questions/510269/how-do-i-concatenate-strings-in-objective-c
    NSString * result = @"";
    id eachArg;
    va_list alist;
    if(first)
    {
        result = [result stringByAppendingString:first];
        va_start(alist, first);
        while (eachArg = va_arg(alist, id)) 
        {
            result = [result stringByAppendingString:eachArg];
        }
        va_end(alist);
    }
    NSLog(@"%@", result);
}

@end 
```

为了只**连接**字符串，我将在 NSString 上定义一个 Category 并向其添加一个静态 (+) 连接方法，该方法看起来与上面的 log 方法完全相同，只是它返回字符串。它在 NSString 上，因为它是一个字符串方法，它是静态的，因为您想从 1-N 个字符串创建一个新字符串，而不是在作为附加部分的任何一个字符串上调用它。

* * *

## 回答 #21

> 赞同：4
> 
> 时间：2016-01-20T13:42:08.703

```
NSNumber *lat = [NSNumber numberWithDouble:destinationMapView.camera.target.latitude];
NSNumber *lon = [NSNumber numberWithDouble:destinationMapView.camera.target.longitude];
NSString *DesconCatenated = [NSString stringWithFormat:@"%@|%@",lat,lon]; 
```

* * *

## 回答 #22

> 赞同：3
> 
> 时间：2012-11-11T18:28:04.673

试试 stringWithFormat：

```
NSString *myString = [NSString stringWithFormat:@"%@ %@ %@ %d", "The", "Answer", "Is", 42]; 
```

* * *

## 回答 #23

> 赞同：3
> 
> 时间：2012-11-14T13:41:42.067

经常处理字符串时，我发现制作源文件 ObjC++ 更容易，然后我可以使用问题中显示的第二种方法连接 std::strings 。

```
std::string stdstr = [nsstr UTF8String];

//easier to read and more portable string manipulation goes here...

NSString* nsstr = [NSString stringWithUTF8String:stdstr.c_str()]; 
```

* * *

## 回答 #24

> 赞同：3
> 
> 时间：2013-04-05T05:38:00.580

您可以使用 NSArray 作为

```
NSString *string1=@"This"

NSString *string2=@"is just"

NSString *string3=@"a test"  

NSArray *myStrings = [[NSArray alloc] initWithObjects:string1, string2, string3,nil];

NSString *fullLengthString = [myStrings componentsJoinedByString:@" "]; 
```

或者

您可以使用

```
NSString *imageFullName=[NSString stringWithFormat:@"%@ %@ %@.", string1,string2,string3]; 
```

* * *

## 回答 #25

> 赞同：3
> 
> 时间：2013-05-03T16:40:46.693

我的首选方法是这样的：

```
NSString *firstString = @"foo";
NSString *secondString = @"bar";
NSString *thirdString = @"baz";

NSString *joinedString = [@[firstString, secondString, thirdString] join]; 
```

您可以通过将 join 方法添加到具有类别的 NSArray 来实现：

```
#import "NSArray+Join.h"
@implementation NSArray (Join)
-(NSString *)join
{
    return [self componentsJoinedByString:@""];
}
@end 
```

`@[]`这是 的简短定义`NSArray`，我认为这是连接字符串的最快方法。

如果不想使用类别，直接使用`componentsJoinedByString:`方法：

```
NSString *joinedString = [@[firstString, secondString, thirdString] componentsJoinedByString:@""]; 
```

* * *

## 回答 #26

> 赞同：1
> 
> 时间：2016-01-28T20:36:03.760

当我测试时，这些格式中的任何一种都可以在 XCode7 中使用：

```
NSString *sTest1 = {@"This" " and that" " and one more"};
NSString *sTest2 = {
  @"This"
  " and that"
  " and one more"
};

NSLog(@"\n%@\n\n%@",sTest1,sTest2); 
```

出于某种原因，您只需要在组合的第一个字符串上使用 @ 运算符字符。

但是，它不适用于变量插入。为此，您可以使用[这个极其简单的解决方案](https://stackoverflow.com/a/11320175/105539)，除了在“cat”上使用宏而不是“and”。

* * *

## 回答 #27

> 赞同：1
> 
> 时间：2016-06-07T08:45:00.043

对于所有在 UI 测试中需要此功能的 Objective C 爱好者：

```
-(void) clearTextField:(XCUIElement*) textField{

    NSString* currentInput = (NSString*) textField.value;
    NSMutableString* deleteString = [NSMutableString new];

    for(int i = 0; i < currentInput.length; ++i) {
        [deleteString appendString: [NSString stringWithFormat:@"%c", 8]];
    }
    [textField typeText:deleteString];
} 
```

* * *

## 回答 #28

> 赞同：0
> 
> 时间：2013-01-22T04:10:27.317

```
listOfCatalogIDs =[@[@"id[]=",listOfCatalogIDs] componentsJoinedByString:@""]; 
```

* * *

## 回答 #29

> 赞同：0
> 
> 时间：2016-05-27T08:08:35.937

让我们想象一下，你不知道那里有多少个字符串。

```
NSMutableArray *arrForStrings = [[NSMutableArray alloc] init];
for (int i=0; i<[allMyStrings count]; i++) {
    NSString *str = [allMyStrings objectAtIndex:i];
    [arrForStrings addObject:str];
}
NSString *readyString = [[arrForStrings mutableCopy] componentsJoinedByString:@", "]; 
```

* * *

## 回答 #30

> 赞同：0
> 
> 时间：2020-10-27T06:26:51.757

受`NSMutableString`克里斯的想法启发，我做了一个完美的宏恕我直言。它支持插入 nil 元素而没有任何异常。

```
#import <libextobjc/metamacros.h>

#define STR_CONCAT(...) \
    ({ \
        __auto_type str__ = [NSMutableString string]; \
        metamacro_foreach_cxt(never_use_immediately_str_concatify_,, str__, __VA_ARGS__) \
        (NSString *)str__.copy; \
    })

#define never_use_immediately_str_concatify_(INDEX, CONTEXT, VAR) \
    [CONTEXT appendString:VAR ?: @""]; 
```

例子：

```
STR_CONCAT(@"button_bg_", @(count).stringValue, @".png"); 
// button_bg_2.png 
```

如果你喜欢，你可以使用`id`type 作为参数，`[VAR description]`而不是`NSString`.

# java - 如何处理不完整的文件？获取异常

> ID：510270
> 
> 赞同：8
> 
> 时间：2009-02-04T06:26:34.463
> 
> 标签：java, multithreading, file-io, ftp

我需要创建一个 java 程序，该程序将创建线程来搜索特定文件夹（源文件夹）中的文件，并在找到源文件夹中的文件后立即选择该文件进行处理工作（将其转换为 csv 文件格式）。我现在面临的问题是源文件夹中的文件很大（FTP工具用于将文件从服务器复制到源文件夹），线程在它完全复制到源文件夹之前立即选择该文件并抛出异常。我如何停止线程，直到文件完全复制到源文件夹中？只有在文件完全复制到源文件夹后，它才必须选择文件进行处理。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-04T06:48:34.310

最安全的方法是将文件下载到其他位置，然后将其移动到目标文件夹。

Bombe 提到的另一个变体是在下载后将文件名更改为其他扩展名，并仅查找具有该扩展名的文件。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-04T07:56:35.267

我只读取未处于写入模式的文件。这是最安全的，因为这意味着没有其他进程正在写入此文件。您可以使用 File 类的 canWrite 方法检查文件是否处于写入模式。

这个解决方案对我来说很好，因为我也有你面临的完全相同的情况。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-04T06:42:13.903

你可以尝试不同的东西：

*   ~~反复检查文件的最后修改日期和大小，直到它在给定的时间内不再更改，然后处理它。~~（正如 qbeuek 所指出的，这既不安全也不具有确定性。）
*   仅处理名称与特定条件匹配的文件（例如 *.dat）。将 FTP 上传/下载过程更改为上传/下载具有不同名称的文件（例如 *.dat.temp），并在文件完成后重命名文件。
*   将文件下载到其他位置，并在完成后将它们移动到您的处理目录。
*   正如醋所说，如果第一次不起作用，请稍后再试。:)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-04T06:41:44.700

如果您对执行 FTP 的进程有一些控制权，您可能会在大文件的 ftp 完成后立即在源目录中创建一个“标志文件”。

然后你的 Java 线程必须检查这个标志文件的存在，如果它存在，那么在源目录中有一个准备好处理的文件。在处理大文件之前，线程应该删除标志文件。

标志文件可以是任何东西（甚至是空文件）。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-04T06:33:08.257

假设您无法控制 FTP 进程...

让它成为这样。当你得到异常时，下次尝试再次处理它。重复它直到文件被处理。最好保留一些属性以防万一以后检查它，例如；名称、上次修改时间、大小。

在决定稍后处理之前检查确切的异常，异常可能由于其他原因而发生。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-04T08:02:52.367

如果您的操作系统是 Linux，并且您的内核 > 2.6.13，您可以使用名为[inotify](http://en.wikipedia.org/wiki/Inotify)的文件系统事件通知 API 。这里有一个 Java 实现：[https](https://bitbucket.org/nbargnesi/inotify-java) ://bitbucket.org/nbargnesi/inotify-java 。

这是一个示例代码（来自网站的大量启发）。

```
 try {
        Inotify i = new Inotify();
        InotifyEventListener e = new InotifyEventListener() {

            @Override
            public void filesystemEventOccurred(InotifyEvent e) {
                System.out.println("inotify event occurred!");
            }

            @Override
            public void queueFull(EventQueueFull e) {
                System.out.println("inotify event queue: " + e.getSource() +
                        " is full!");
            }

        };
        i.addInotifyEventListener(e);
        i.addWatch(System.getProperty("user.home"), Constants.IN_CLOSE_WRITE);
    } catch (UnsatisfiedLinkError e) {
        System.err.println("unsatisfied link error");
    } catch (UserLimitException e) {
        System.err.println("user limit exception");
    } catch (SystemLimitException e) {
        System.err.println("system limit exception");
    } catch (InsufficientKernelMemoryException e) {
        System.err.println("insufficient kernel memory exception");
    } 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-10-08T19:52:54.700

这是在 Grails 中，我正在使用`FileUtils`来自 Apache commons 的库。该`sizeof`函数以字节为单位返回大小。

```
 def fileModified = sourceFile.lastModified()
    def fileSize = FileUtils.sizeOf(sourceFile)

    Thread.sleep(3000) //sleep to calculate size difference if the file is currently getting copied

    if((fileSize != FileUtils.sizeOf(sourceFile)) && (fileModified != sourceFile.lastModified())) //the file is still getting copied to return 
    {
        if(log.infoEnabled)
            log.info("File is getting copied!")
        return
    } 

    Thread.sleep(1000) //breather for picking up file just copied. 
```

* * *

请注意，这还取决于您用于传输文件的实用程序或操作系统。最安全的选择是将已复制或已复制的文件复制到不同的文件或目录。复制过程是一个强大的过程，它可以确保文件在复制过程之后存在。我正在使用的一个来自 commons API。

FileUtils.copyFileToDirectory（文件 f，目录 D）

如果您正在复制一个正在复制的大文件，请注意这将花费一些时间，您可能希望在并行线程中启动它，或者最好有一个专门用于传输过程的单独应用程序。

# events - 如何将 MouseDown 事件处理程序添加到 控制？

> ID：510272
> 
> 赞同：0
> 
> 时间：2009-02-04T06:27:43.010
> 
> 标签：events

我有一个包含“asp:RequiredFieldValidator”控件的aspx页面；问题是当每个“asp:RequiredFieldValidator”控件激活并显示它们的消息时；我页面中的其他控件甚至“取消”按钮都不起作用！！！我想在我的“NEXT”按钮 MouseDown 中启用控件，然后在我的“NEXT”按钮 MouseUp 禁用它们。感谢您提供任何其他解决方案...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-04T06:57:40.080

专门回答您标题中所述的问题：要将其他事件处理程序添加到 asp:button 或其他非复合的服务器控件，您只需将处理程序添加到元素。包括 onmousedown="myMouseDownHandler(this);" 在元素中，javascript 函数 myMouseDownHandler 将触发。

但是，我**认为**有更好的方法来完成您的要求，但问题的描述不够连贯，我无法完全弄清楚您的要求。我意识到你可能不是以英语为母语的人，但也许你可以再给它一次通过。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-04T07:30:51.573

在已验证的控件和触发验证的控件（例如保存/更新按钮）和验证器上使用**ValidationGroup属性。**
此外，在每个不需要触发验证的按钮（取消按钮）上将**CausesValidation属性设置为 false。**

# algorithm - 在图或树中查找冗余边的算法

> ID：510277
> 
> 赞同：26
> 
> 时间：2009-02-04T06:29:01.697
> 
> 标签：algorithm, language-agnostic, tree, graph-theory

是否存在用于在图中查找冗余边的既定算法？

比如我想发现 a->d 和 a->e 是多余的，然后去掉它们，像这样：

![替代文字](https://upload.wikimedia.org/wikipedia/commons/thumb/5/51/Tred-G.png/124px-Tred-G.png)=>![替代文字](https://upload.wikimedia.org/wikipedia/commons/thumb/1/1f/Tred-Gprime.png/80px-Tred-Gprime.png)

编辑：Strilanc 很好地为我读懂了我的想法。“冗余”这个词太强了，因为在上面的例子中，a->b 或 a->c 都不被认为是冗余的，但 a->d 是。

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2009-02-04T07:03:27.340

您想要计算保持顶点可达性的最小图。

这称为图的[传递约简](http://en.wikipedia.org/wiki/Transitive_reduction)。维基百科文章应该让你开始走上正确的道路。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2019-06-25T08:53:32.533

由于@Craig 提到的 Wikipedia 文章只对实现产生了影响，因此我使用 Java 8 流发布了我的实现：

```
Map<String, Set<String>> reduction = usages.entrySet().stream()
                .collect(toMap(
                        Entry::getKey,
                        (Entry<String, Set<String>> entry) -> {
                            String start = entry.getKey();
                            Set<String> neighbours = entry.getValue();
                            Set<String> visited = new HashSet<>();
                            Queue<String> queue = new LinkedList<>(neighbours);

                            while (!queue.isEmpty()) {
                                String node = queue.remove();
                                usages.getOrDefault(node, emptySet()).forEach(next -> {
                                    if (next.equals(start)) {
                                        throw new RuntimeException("Cycle detected!");
                                    }
                                    if (visited.add(next)) {
                                        queue.add(next);
                                    }
                                });
                            }

                            return neighbours.stream()
                                    .filter(s -> !visited.contains(s))
                                    .collect(toSet());
                        }
                )); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-04T06:53:58.700

有几种方法可以解决这个问题，但首先你需要更精确地定义问题。首先，你这里的图是非循环的和有向的：这总是正确的吗？

接下来，您需要定义“冗余边缘”的含义。在这种情况下，您从一个具有两条路径 a->c 的图开始：一条通过 b，一条直接通过。由此我推断，“冗余”是指这样的东西。令*G=< V, E >*是一个图，其中*V*是*顶点*集，*E ⊆ V×V*是边集。看起来您将所有从*vi*到*v [j的边都定义]**[为]*比最长边短的“冗余”。所以最简单的方法是使用深度优先搜索，枚举路径，当你找到一个更长的新路径时，将其保存为最佳候选。

不过，我无法想象你想要它做什么。你能告诉？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-04T07:00:00.340

我认为最简单的方法是，想象一下它在实际工作中的样子，想象一下如果你有关节，比如

(A->B)(B->C)(A->C)，想象如果近图之间的距离等于1，那么

(A->B) = 1，(B->C) = 1，(A->C) = 2。

所以你可以移除关节（A->C）。

换句话说，最小化。

这只是我一开始的想法。网上有各种各样的文章和资源，你可以看看它们并深入了解。

**资源，这将帮助您：**

[去除非二进制 CSP 对偶图中冗余边的算法](http://consystlab.unl.edu/our_work/StudentReports/DualGraphReduction.pdf)

[图数据结构和基本图算法](http://www.mozart-oz.org/mogul/doc/smiele/graph/index.html#acyclic-transitive-reduction)

[谷歌图书，关于找到最小的两个连接子图](http://books.google.lt/books?id=fuB8dMhKBzsC&pg=PA179&lpg=PA179&dq=redundant+edges+in+a+graph&source=web&ots=Pg8XEGBrJ1&sig=UDWZVHYHpnpZOJi9zTEOCj_4bbU&hl=en&sa=X&oi=book_result&resnum=1&ct=result#PPA178,M1)

[图形缩减](http://en.wikipedia.org/wiki/Graph_reduction)

[用于在任意顶点冗余或边冗余图中进行预先计划恢复的冗余树](http://ieeexplore.ieee.org/Xplore/login.jsp?url=/ielx5/90/17436/00803380.pdf?arnumber=803380)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-06-29T07:29:24.893

我有一个类似的问题，并最终以这种方式解决它：

我的数据结构由`dependends`字典组成，从节点 id 到依赖它的节点列表（即 DAG 中的追随者）。请注意，它仅适用于 DAG - 即有向无环图。

我还没有计算出它的确切复杂性，但它在一瞬间吞噬了我的数千张图表。

```
_transitive_closure_cache = {}
def transitive_closure(self, node_id):
    """returns a set of all the nodes (ids) reachable from given node(_id)"""
    global _transitive_closure_cache
    if node_id in _transitive_closure_cache:
        return _transitive_closure_cache[node_id]
    c = set(d.id for d in dependents[node_id])
    for d in dependents[node_id]:
        c.update(transitive_closure(d.id))  # for the non-pythonists - update is update self to Union result
    _transitive_closure_cache[node_id] = c
    return c

def can_reduce(self, source_id, dest_id):
    """returns True if the edge (source_id, dest_id) is redundant (can reach from source_id to dest_id without it)"""
    for d in dependents[source_id]:
        if d.id == dest_id:
            continue
        if dest_id in transitive_closure(d.id):
            return True # the dest node can be reached in a less direct path, then this link is redundant
    return False

# Reduce redundant edges:
for node in nodes:      
    dependents[node.id] = [d for d in dependents[node.id] if not can_reduce(node.id, d.id)] 
```

# iphone - 有没有办法在没有 iPhone 的情况下在 iPhone 上测试网站？

> ID：510278
> 
> 赞同：12
> 
> 时间：2009-02-04T06:29:09.390
> 
> 标签：iphone, cross-browser, web-testing

我想测试一个网站以了解它如何与 iPhone 配合使用，但我没有 iPhone 或 iPod touch。有没有一种方法可以在不拥有网站的情况下测试该网站如何在它们上运行？

我真正想要的是修复 Stackoverflow 的 WMD 降价编辑器在 iPhone 上的工作方式。我听说超链接和图像提示创建得太高了。我想我知道如何解决这个问题，但是盲目发展非常困难。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-02-04T06:42:25.743

如果您拥有 Mac，您可以下载 iPhone 模拟器附带的 iPhone SDK。它不仅适用于调试本机应用程序，还适用于浏览网页。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-02-04T06:58:18.283

如果您的计算机上有 Safari，则可以在“首选项”>“高级”>“在菜单栏中显示开发菜单”下启用“开发”菜单。

启用此功能后，您可以转到开发 > 用户代理，并将用户代理字符串更改为您希望浏览器向 Web 服务器报告的设备。通过将窗口大小调整到适当的宽度，您可以模拟网站在 iPhone 上的外观。

这样做的好处是它很快，它可以在 Windows 和 Mac 上运行，而且你不需要安装 iPhone SDK。您还可以浏览直接从您的 PC 捕获用户代理字符串的 iPhone 特定版本的网站。

缺点显然是您 PC 上的 Safari 浏览器会比实际设备上运行得更快（尤其是在 javascript 性能方面）；它显示插件并显示实际 iPhone OS 上可能不可用的字体；滚动时缺乏多点触控支持和“对齐”列；没有自动旋转；没有多点触控/双指缩放；小部件看起来会有所不同；等等

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2010-11-20T18:03:21.003

只是关于这个旧线程的通知 - 我们现在已经通过 CrossBrowserTesting.com 上的 vnc 在 iPhone 和 iPad 上启用了实时测试。肯 - 创始人

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-04T12:43:30.007

mac上有一个模拟iPhone浏览器的免费应用：[iPhoney](http://marketcircle.com/iphoney/)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-04T06:32:22.377

我并没有声称所做的不仅仅是网络搜索，但这个问题似乎可以通过几个“iPhone 网络应用程序模拟器”产品来解决。

[http://www.testiphone.com/](http://www.testiphone.com/)

[http://marketcircle.com/iphoney/](http://marketcircle.com/iphoney/)

# html - 定位副标题内容而不影响另一个 HTML 列表

> ID：510279
> 
> 赞同：0
> 
> 时间：2009-02-04T06:30:59.883
> 
> 标签：html, css, positioning

我正在制作一个带有标题和副标题的列表。我的主要列表 Home1 后面是一个副标题。如何在不影响另一个列表的情况下准确定位子标题内容？

```
<div id="wrapper">
    <ul id="testnav">
        <li>
            <a href="#">Home</a>
            <ul id="subnav">
                <div style=" float : left; width :70%;" >
                    <li><a href="#">Sub Heading</a></li>
                    <li><a href="#">Sub Heading</a></li>
                    <li><a href="#">Sub Heading</a></li>
                </div>
                <div STYLE="float : left; width :30%; height:900px;">
                    Sub Heading Content
                </div>
            </ul>
        </li>
        <li><a href="#">Home2</a></li>
        <li><a href="#">Home3</a></li>
        <li><a href="#">Home4</a></li>
        <li><a href="#">Home5</a></li>
    </ul>
</div>

#testnav {
    list-style: none;
    padding: 0;
    marigin: 10px 10px 10px 0;
    width: 900px;
}
#subnav {
    list-style: none;
    padding: 0;
    marigin: 10px 10px 10px 0;
    width: 300px;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-04T06:34:30.890

此外，ul > div 不是有效的 HTML。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-04T06:39:52.020

我很难理解这个问题，但看看你的标记，我发现你有一个 DIV 作为 UL 的直接后代。只有 LI 元素可以是 UL 的子元素。

```
<ul id="subnav">
  <div style=" float : left; width :70%;" > <!-- THIS DIV CANNOT BE HERE -->
    <li><a href="#">Sub Heading</a></li>
    <li><a href="#">Sub Heading</a></li>
    <li><a href="#">Sub Heading</a></li>
  </div> <!-- THIS DIV CANNOT BE HERE -->
  <div STYLE="float : left; width :30%; height:900px;"> <!-- THIS DIV CANNOT BE HERE -->
    Sub Heading Content
  </div> <!-- THIS DIV CANNOT BE HERE -->
</ul> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-04T12:03:12.350

解决问题的第一步是确保您的标记是正确的，正如 Andy Ford 所建议的那样。其次，确保代码中 CSS 的拼写正确可能会有所帮助。

从我可以从你的问题中解读出来，你试图确保它`#subnav`相对于`#testnav`.

```
<ul id="testnav">
    <li>
        <a href="#">Home</a>
        <ul id="subnav">
            <li><a href="#">Sub Heading</a></li>
            <li><a href="#">Sub Heading</a></li>
            <li><a href="#">Sub Heading</a></li>
        </ul>
    </li>
    <li><a href="#">Home2</a></li>
    <li><a href="#">Home3</a></li>
    <li><a href="#">Home4</a></li>
    <li><a href="#">Home5</a></li>
</ul>
#testnav, #subnav { list-style:none; padding:0; }
#subnav {
    position: absolute;
    width: 300px;
} 
```

我不确定这是否是您想要的，但通常找出 CSS 出了什么问题的第一步是尽可能删除所有无关的添加。

# asp.net - 如何为 .NET 开发创建我的第一个数据库？

> ID：510286
> 
> 赞同：2
> 
> 时间：2009-02-04T06:33:55.743
> 
> 标签：asp.net, visual-studio, sql-server-2005

行！我已经准备好第一次开始一些 .NET 开发了。

我最近安装了 Microsoft Visual Studio，其中包括 Microsoft SQL Sever 2005。

针对开发数据库进行编程的首选方法是什么？我想编写一个使用数据库的 ASP.NET 应用程序，但我不知道如何创建一个。在我的 SQL Server 2005 开始菜单中，我只有：

*   SQL Server 配置管理器
*   SQL Server 错误和使用情况报告
*   SQL Server 外围应用配置

我没有在该列表上看到一个直观的程序来创建和设计数据库，那么我该怎么做呢？！我会创建一个完整的 SQL Server 数据库还是一个“平面文件”假数据库来编程？

有人可以告诉我创建我的第一个 MS SQL Server 2005 数据库的过程吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-04T06:35:57.033

如果您有 Visual Studio，只需转到服务器资源管理器，将新的数据库连接添加到您的数据库，然后开始。

或者，在 Visual Studio 中新建一个网站项目，右键单击 App_Data 文件夹->添加新项目，然后添加一个 SQL Server 数据库 mdf 文件，该文件将在您运行应用程序时附加到 sql server。在进行生产发布时，您需要部署 mdf 文件 :)

您可能想在 ASP.NET 网站[http://www.asp.net/learn/上观看视频](http://www.asp.net/learn/)

否则，请考虑使用 Microsoft SQL Server Management Studio（也可以使用速成版）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-04T06:40:06.607

您正在寻找[Microsoft SQL Server Management Studio Express](http://www.microsoft.com/downloads/details.aspx?FamilyId=C243A5AE-4BD1-4E3D-94B8-5A0F62BF7796&displaylang=en)。一旦您了解它，添加数据库非常容易。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-04T06:41:40.970

需要明确的是，Visual Studio 中包含的 SQL Server 是一个速成版。但是，它缺少的一件事是 SQL Server Management Studio (Express)。我会下载并安装包含管理工作室的[express 版本](http://www.microsoft.com/express/2005/sql/register/)（请注意，VS 2005 和 2008 包括 SQL Express 2005，您可以使用 SQL Express 2005 或 2008 来满足您的目的）。

您可以在 VS IDE 中创建一个新数据库并执行所需的一切操作，但您可能会发现 SQL Management Studio 环境更直观，更易于初学者使用。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-05T08:27:41.800

关于 SQL Express 的快速说明 - 由于 Express 可以查看/使用的 RAM 数量的限制以及其他一些因素，Microsoft 不建议将其用于“生产”环境。这是我同意的少数情况之一 - 如果您正在做任何涉及大型数据库或数十名用户的复杂事情，那么至少投资 MSSQL Workgroup Edition，或者对于企业项目使用 MSSQL Standard 或 Enterprise 版本。

# iphone - 当你推送一个新视图时，UINavigationViewController 中的根视图会发生什么？

> ID：510289
> 
> 赞同：2
> 
> 时间：2009-02-04T06:35:55.227
> 
> 标签：iphone, cocoa-touch, memory-management

具体来说，在推送新的视图控制器后，我应该如何处理现在隐藏的视图？
在我的情况下，我有一个动画视图，在视图离开屏幕后继续执行。

有一些公认的约定吗？我是否从内存中删除视图控制器和视图？
Cocoa Touch 是否有一种方便的方法来“暂停”视图（和控制器）并将其从内存中删除，并在需要时（在弹出后）将其恢复存在？我必须自己存档然后取消存档吗？

你有什么例子可以指点我吗？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-05T03:15:30.183

另一种可能的解决方案是实现以下两种方法：

```
– viewWillAppear:  
– viewDidAppear:  
– viewWillDisappear:  
– viewDidDisappear: 
```

您可能会在 or 中停止动画，然后在 or`viewWillDisappear`中`viewDidDisappear`重新启动它。您还可以在停止动画之前存储有关动画的任何必要状态信息。`viewWillAppear``viewDidAppear`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-04T07:55:01.227

在内存不足的情况下，如果控制器的 'view' 属性不在屏幕上，它将自动设置为 nil。然后视图将在需要时再次自动加载 - 并且此时应该调用 viewDidLoad。

如果您的视图控制器保留了顶级视图的任何子视图，那么您可能需要覆盖视图控制器的 setView: 方法，检查视图是否设置为 nil，如果是，则释放您保留的子视图。否则，顶级视图可能永远不会被释放。

```
- (void)setView:(UIView *)view
{
    [super setView:view];
    if (view == nil)
    {
        // Release other views
        // self.someView = nil;
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-07T09:41:15.613

每当你调用 pushViewController 时，当前的 viewcontroller 都会被导航控制器存储在一个数组中（这可以使用 navcontroller 的 viewControllers 属性来访问）。

把它想象成一个堆栈。当你调用 pushViewController 时，一个新的 viewcontroller 被添加到当前 viewcontroller 顶部的堆栈中。但是您的 rootviewcontroller 仍在内存中。当您调用 popViewController 时，该视图控制器将从堆栈中移除并释放。

因此，如果您想在视图消失时停止动画，请使用 Andy 建议的 viewWillDisappear 方法。

# c# - InstallPrintQueue：如何创建新端口？(.net,c#)

> ID：510291
> 
> 赞同：0
> 
> 时间：2009-02-04T06:36:08.063
> 
> 标签：c#, .net, sysadmin, system.printing

我在这里与 .net 框架的 System.Printing 命名空间作斗争。在 MS 管理我的打印服务器的所有工具中，我一直认为它们缺乏端口和驱动程序管理功能。

所以我被困在这里的一段代码有效：

```
 PrintServer _ps = new PrintServer(PServer,
PrintSystemDesiredAccess.AdministrateServer );
 _ps.InstallPrintQueue(QToCreate.Name, QToCreate.Driver,new string [] {"LPT1:"}, "winprint", PrintQueueAttributes.None); 
```

它确实使用我指定的驱动程序在远程服务器上为我创建了一个队列，但驱动程序应该已经存在于我可以使用的服务器上，但我未能找到在我的打印服务器上创建新 TCP/IP 端口的方法，因此以这种方式安装新的打印队列可能是有用的。我不明白为什么我只允许使用现有端口安装新队列。有点让我失望。如果有人知道如何创建一个端口和一个队列，我想看看如何。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-04T07:26:51.020

gah ..当没有希望时 - 做更多研究

简短的回答 - “你不能使用 system.printing 添加端口”

长答案 - 使用 wmi

vb 示例如下：

```
Set objWMIService = GetObject("winmgmts:")
Set objNewPort = objWMIService.Get _
    ("Win32_TCPIPPrinterPort").SpawnInstance_
' Use IP of Printer or Machine sharing printer
objNewPort.Name = "IP_192.168.1.1"
objNewPort.Protocol = 1
objNewPort.HostAddress = "192.168.1.1"
' Enter Port number you would like to use
objNewPort.PortNumber = "9999"
objNewPort.SNMPEnabled = False
objNewPort.Put_ 
```

# asp.net - 如何获取 autocad(dwg) 文件的缩略图并将它们显示到“asp:image”控件中？

> ID：510293
> 
> 赞同：1
> 
> 时间：2009-02-04T06:36:49.793
> 
> 标签：asp.net

我正在尝试编写一个基于 Web 的文档管理系统（ASP.NET，C#），现在我需要在用户查看它们时显示接收文件的缩略图。感谢任何解决方案...

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-08T07:43:00.420

在这里尝试初学者 - [http://through-the-interface.typepad.com/through_the_interface/2007/10/au-handouts-t-1.html](http://through-the-interface.typepad.com/through_the_interface/2007/10/au-handouts-t-1.html)

这是一个很好的 AutoCAD 编程博客。仅供参考，DWG Trueview 是免费的。我不知道 COM 接口是否仍然可以访问，但值得一试。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-09-09T10:22:34.613

您可以尝试使用开放设计联盟提供的软件。 [开放设计联盟](http://www.opendwg.org/)

上次我尝试使用 DWG TrueView 程序（连接到 COM 接口）时，它非常不稳定，情况可能有所改善。

# c# - 在 AC# 项目中自动包含文件

> ID：510295
> 
> 赞同：2
> 
> 时间：2009-02-04T06:38:29.387
> 
> 标签：c#, windows, visual-studio-2008

这听起来可能并不难做到，但它目前正在杀死我。目前我有一个 Visual Studio 2008 C# 项目，我将它与 DAL 生成器结合使用，除了生成可以在项目中用于访问数据库的文件之外，它并没有什么特别之处。

我遇到的问题是，在生成器运行并创建文件后，它们永远不会出现在我的项目中（新文件，旧的现有文件都可以）。要添加它们，我必须显示隐藏文件（在 Visual Studio 中），然后手动包含所有文件。无论如何，是否可以将这些文件自动包含到我的项目中。

提前致谢

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-04T07:05:42.590

在 VS2008 中：

1）右键单击您的项目节点。

2) 选择“卸载项目”。

3) 右键单击​​项目节点。

4) 选择“编辑 foo.csproj”

5）在元素中添加一个元素，其中包含使用通配符的 DAL 文件，例如：

```
<Compile Include="DAL_*.cs" /> 
```

或者

```
<Compile Include="DataAccessLayer\*.cs" /> 
```

6) 文件.保存

7) 右键单击​​项目节点。

8) 选择“重新加载项目”。

要了解有关此内容的更多信息，请阅读 MSBuild。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-04T06:43:22.527

我想最简单的方法是编写一个工具来自动修改 .csproj 文件，它只是 XML，以便它包含您的新项目。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-04T07:01:32.850

我会比 mquander 更进一步，说为你的 DAL 生成整个项目文件。当它发生变化时，我认为 VS 应该提示您重新加载它。

csproj 是一个[msbuild](http://msdn.microsoft.com/en-us/library/0k6kkbsd.aspx)文件，并不难理解。

# javascript - 在 contentEditable iframe (Firefox) 中获取和设置插入符号位置

> ID：510296
> 
> 赞同：4
> 
> 时间：2009-02-04T06:39:28.540
> 
> 标签：javascript, firefox

我已经为 IE7 成功地做到了这一点。FF，没有骰子。

有任何想法吗？谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-04T13:51:04.880

```
var range= window.getSelection().getRangeAt(0);
alert('Current position: '+range.startOffset+' inside '+range.startContainer);
range.setStart(newParent, textOffset);
range.setEnd(newParent, textOffset); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2011-08-29T21:49:07.267

这是我对 OpenWYSIWYG 的解决方案，用于在将焦点设置到编辑器后将光标移动到 FireFox 中的指定位置：

```
focusEditor: function (n) {
    var editor = this.getEditorWindow(n);

    if (WYSIWYG_Core.isFF) {

        editor.document.body.focus();

        try {
            var sel = this.getSelection(n);
            var range = sel.getRangeAt(0);
            range.setStart(sel.anchorNode.childNodes[0], 1);
            range.setEnd(sel.anchorNode.childNodes[0], 0);
            sel.addRange(range);
        }
        catch (err) {
            //alert(err.description);
        }
    }
}, 
```

# java - 如何在 Ibatis 中实现一对多关系？

> ID：510305
> 
> 赞同：5
> 
> 时间：2009-02-04T06:42:19.440
> 
> 标签：java, ibatis, one-to-many

假设我有这个类：

```
 Class A {
        int id;
        int[] b;
        // Other properties
    }

    Class B {
        int id;
        // Other properties
    } 
```

A 类与 B 类具有一对多的关系。我已经有一个服务可以缓存 B 对象并在 id 上返回它们。

表架构看起来像这样

```
 Table a:
    -------
      int id,
      prop1,
      etc

    Table a_to_b_map
    ----------------
      int a_id,
      int b_id 
```

现在，我如何在 iBatis 中映射它？

由于 B 对象已经被缓存，我想将 id 列表获取到 A 对象中，然后使用该服务来丰富 As。

有人可以建议如何去做吗？

我能想到的两种可能的选择是：

1.  在 A（AtoB 映射）中创建一个内部类，并在 iBatis 配置中使用选择查询来填充它
2.  在 iBatis resultMap/select 中使用另一个选择来获取 B id 列表（不太清楚如何在配置中执行此操作）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2010-10-20T13:46:34.437

在 mybatis 3 中有点不同。您可以通过指定两个 select 语句来做到这一点，或者您可以使用 join 然后创建带有集合标签的 resultMap。

```
<resultMap id=”blogResult” type=”Blog”&gt;
   <collection property="posts" javaType=”ArrayList” column="blog_id"
      ofType="Post" select=”selectPostsForBlog”/>
</resultMap>

<select id=”selectBlog” parameterType=”int” resultMap=”blogResult”&gt;
    SELECT * FROM BLOG WHERE ID = #{id}
    </select>
<select id=”selectPostsForBlog” parameterType=”int” resultType="Author">
    SELECT * FROM POST WHERE BLOG_ID = #{id}
    </select> 
```

或者你可以使用加入

```
<select id="selectBlog" parameterType="int" resultMap="blogResult">
select
    B.id as blog_id,
    B.title as blog_title,
    B.author_id as blog_author_id,
    P.id as post_id,
    P.subject as post_subject,
    P.body as post_body,
from Blog B
    left outer join Post P on B.id = P.blog_id
where B.id = #{id}
</select> 
```

并做结果图

```
<resultMap id="blogResult" type="Blog">
  <id property=”id” column="blog_id" />
  <result property="title" column="blog_title"/>
  <collection property="posts" ofType="Post">
    <id property="id" column="post_id"/>
    <result property="subject" column="post_subject"/>
    <result property="body" column="post_body"/>
  </collection>
</resultMap> 
```

您可以在此处从 ibatis 用户指南获得完整的教程：

[http://svn.apache.org/repos/asf/ibatis/java/ibatis-3/trunk/doc/en/iBATIS-3-User-Guide.pdf](http://svn.apache.org/repos/asf/ibatis/java/ibatis-3/trunk/doc/en/iBATIS-3-User-Guide.pdf)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-04T07:26:55.387

不确定我是否正确理解了您的问题。

假设你会根据A的id进行查询，那么在ibatis中写一个连接两个表的查询怎么样？

```
select * 
from a, a_to_b_map 
where a.id = #id# and a.id = a_to_b_map.a_id 
```

然后，您可以使用“queryForMap”返回 a_id vs（来自查询的记录集合）的哈希图。使用自定义方法将此数据结构转换为 'A' 的对象

# visual-c++ - 编译过程

> ID：510309
> 
> 赞同：7
> 
> 时间：2009-02-04T06:43:11.200
> 
> 标签：visual-c++, compiler-construction, lua, visual-c++-6

谁能解释编译是如何工作的？

我似乎无法弄清楚编译是如何工作的..

更具体地说，这是一个示例。我正在尝试在 MSVC++ 6 中编写一些代码来加载 Lua 状态。

我已经：

*   设置库的附加目录并将文件包含到正确的目录
*   使用了 extern "C" （因为 Lua 只是 C 或者我听说的）
*   # 包含正确的头文件

但是我仍然在 MSVC++6 中遇到一些关于未解析外部符号的错误（对于我使用的 Lua 函数）。

尽管我很想知道如何解决这个问题并继续前进，但我认为如果我了解所涉及的底层过程对我来说会更好，那么任何人都可以为此写一个很好的解释吗？我想知道的是过程..它可能看起来像这样：

第1步：

*   输入：源代码
*   过程：解析（也许在这里添加更多细节）
*   输出：这里输出什么..

第2步：

*   输入：步骤 1 输出的任何内容，以及可能需要的任何其他内容（库？DLL？.so？.lib？）
*   过程：对输入所做的任何事情
*   输出：输出什么

等等..

谢谢..

也许这将解释什么是符号，究竟是什么“链接”，什么是“对象”代码或其他什么......

谢谢。。对不起，我是个菜鸟。。

PS这不一定是特定语言的..但是请随意用您最熟悉的语言表达它.. :)

**编辑**：所以无论如何，我能够解决错误，事实证明我必须手动将 .lib 文件添加到项目中；简单地在 IDE 设置或项目设置中指定库目录（.lib 所在的位置）不起作用..

但是，下面的答案在一定程度上帮助我更好地理解了这个过程。非常感谢！.. 如果有人还想写一个详尽的指南，请做.. :)

**编辑**：仅供参考，我发现一位作者（Mike Diehl）的两篇文章很好地解释了这一点.. :) [检查编译过程：第 1 部分](http://www.linuxjournal.com/content/examining-compilation-process-part-1) [检查编译过程：第 2 部分](http://www.linuxjournal.com/content/examining-compilation-process-part-2)

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-02-04T07:17:47.933

对于 C 语言和相关语言，从源代码到可执行文件通常是一个两阶段的过程，尽管 IDE 可能将其呈现为单个过程。

1/ 您编写源代码并通过编译器运行它。这个阶段的编译器需要你的源代码和你要链接的其他东西的头文件（见下文）。

编译包括将源文件转换为目标文件。目标文件有你的编译代码和足够的信息来知道他们需要什么其他东西，但*不知道*在哪里可以找到其他东西（例如，LUA 库）。

2/ 链接，下一个阶段，是将所有目标文件与库组合以创建可执行文件。我不会在这里介绍动态链接，因为这会使解释复杂化而没有什么好处。

您不仅需要指定链接器可以找到其他代码的目录，还需要指定包含该代码的实际库。您得到未解决的外部问题的事实表明您还没有这样做。

例如，考虑以下简化的 C 代码 ( `xx.c`) 和命令。

```
#include <bob.h>
int x = bob_fn(7);

cc -c -o xx.obj xx.c 
```

这会将`xx.c`文件编译为`xx.obj`. `bob.h`包含原型，以便`bob_fn()`编译成功。指示编译器`-c`生成目标文件而不是可执行文件，并`-o xx.obj`设置输出文件名。

但实际*代码*`bob_fn()`不在头文件中，而是在 中，`/bob/libs/libbob.so`因此要链接，您需要类似以下内容：

```
cc -o xx.exe xx.obj -L/bob/libs;/usr/lib -lbob 
```

这`xx.exe`从`xx.obj`, 使用形式的库（在给定路径中搜索）创建`libbob.so`（lib 和 .so 通常由链接器添加）。在此示例中，`-L`设置库的搜索路径。如有必要，`-l`指定要查找以包含在可执行文件中的库。链接器通常采用“bob”并在`-L`.

库文件实际上是目标文件的集合（类似于 zip 文件如何包含多个其他文件，但不一定是压缩的） - 当找到第一个相关的未定义外部出现时，将从库中复制目标文件并添加到可执行文件，就像你的`xx.obj`文件一样。这通常会持续到没有更多未解决的外部因素。'relevant' 库是对 "bob" 文本的修改，它可能会查找`libbob.a`, `libbob.dll`, `libbob.so`, `bob.a`, `bob.dll`,`bob.so`等等。相关性由链接器本身决定，并应记录在案。

它的工作方式取决于链接器，但基本上就是这样。

1/ 你所有的目标文件都包含一个他们需要解决的未解决外部的列表。链接器将所有这些对象放在一起并修复它们之间的链接（解决尽可能多的外部问题）。

*2/ 然后，对于每个仍未*解析的外部，链接器梳理库文件，寻找可以满足链接的目标文件。如果它找到它，它会将其拉入 - 这可能会导致更多未解决的外部，因为拉入的对象可能有自己的需要满足的外部列表。

3/ 重复第 2 步，直到没有更多未解析的外部或无法从库列表中解析它们（这是您的开发所在，因为您没有包含 LUA 库文件）。

我之前提到的复杂性是动态链接。那是您链接例程的存根（某种标记）而不是实际例程的地方，后者稍后在加载时（当您运行可执行文件时）解决。诸如 Windows 通用控件之类的东西都在这些 DLL 中，因此它们可以更改，而无需将对象重新链接到新的可执行文件中。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-04T07:10:50.880

第 1 步 - 编译器：

*   输入：源代码文件[s]
*   流程：解析源代码并翻译成机器码
*   输出：目标文件[s]，包括[s]：
    *   此对象中定义的符号名称，以及此对象文件“导出”的符号名称
    *   与此目标文件中定义的每个符号关联的机器代码
    *   未在该目标文件中定义但该目标文件中的软件所依赖且随后必须链接到的符号的名称，即该目标文件“导入”的名称

第 2 步 - 链接：

*   输入：
    *   步骤 1 中的目标文件
    *   其他对象的库（例如来自操作系统和其他软件）
*   过程：
    *   对于您要链接的每个对象
    *   获取此对象导入的符号列表
    *   在其他库中找到这些符号
    *   将相应的库链接到您的目标文件
*   输出：单个可执行文件，其中包括所有对象的机器代码，以及导入（链接）到对象的库中的对象。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-04T07:16:31.463

两个主要步骤是编译和链接。

编译采用单个编译单元（这些只是源文件，包含它们的所有头文件），并创建目标文件。现在，在这些目标文件中，在特定位置（地址）定义了很多函数（和其他东西，如静态数据）。在下一步，链接中，还需要一些关于这些函数的额外信息：它们的名称。所以这些也被存储了。单个对象文件可以引用实际上在其他对象文件中的函数（因为它想在代码运行时调用它们），但是由于我们在这里处理单个对象文件，因此只有符号引用（它们的“名称”）那些其他函数存储在目标文件中。

接下来是链接（让我们在这里限制自己的静态链接）。链接是将第一步中创建的目标文件（直接创建，或将它们一起放入 .lib 文件后）放在一起并创建可执行文件的地方。在链接步骤中，通过在正确的对象中查找名称、找到函数的地址并将地址放在正确的对象中，解析从一个对象文件或 lib 到另一个对象文件或 lib 的所有那些符号引用（如果可以的话）地方。

现在，解释一下你需要的'extern "C"'的东西：

C没有函数重载。一个函数总是可以通过它的名字来识别的。因此，当您将代码编译为 C 代码时，只有函数的真实名称存储在目标文件中。

然而，C++ 有一种叫做“函数/方法重载”的东西。这意味着函数的名称不再足以识别它。因此，C++ 编译器为包含函数原型的函数创建“名称”（因为名称加上原型将唯一标识一个函数）。这被称为“名称修改”。

当您想使用从 C++ 项目编译为“C”代码（例如，预编译的 Lua 二进制文件）的库时，需要“extern "C"”规范。

对于您的确切问题：如果它仍然不起作用，这些提示可能会有所帮助： * Lua 二进制文件是否使用相同版本的 VC++ 编译？* 你能简单地自己编译 Lua，无论是在你的 VC 解决方案中，还是作为 C++ 代码的单独项目？*你确定你所有的'extern "C"'都正确吗？

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-04T07:00:01.543

您必须进入项目设置并在“链接器”选项卡上的某处添加一个目录，其中包含该 LUA 库 *.lib 文件。设置称为“包括库”之类的，抱歉我无法查找。

您得到“未解析的外部符号”的原因是因为 C++ 中的编译分两个阶段进行。首先，代码被编译，每个 .cpp 文件在它自己的 .obj 文件中，然后“链接器”启动并将所有 .obj 文件连接到 .exe 文件中。.lib 文件只是一堆 .obj 文件合并在一起，使库的分发更简单一点。因此，通过添加所有“#include”和 extern 声明，您告诉编译器可以在某个地方找到具有这些签名的代码，但链接器找不到该代码，因为它不知道那些带有实际代码的 .lib 文件在哪里被放置。

确保您已阅读该库的 REDME，通常它们对您必须执行哪些操作才能将其包含在代码中进行了相当详细的解释。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-08T20:45:26.207

您可能还想看看这个：[编译器、汇编器、链接器和加载器：一个简短的故事](http://www.tenouk.com/ModuleW.html)。

# asp.net-mvc - 我应该如何在我的 ASP.NET MVC 站点中实现用户成员资格？

> ID：510315
> 
> 赞同：10
> 
> 时间：2009-02-04T06:48:54.090
> 
> 标签：asp.net-mvc, login, asp.net-membership, membership

我正在创建一个 ASP.NET MVC 站点，我需要实现登录和成员资格功能。

这是我自己推出的东西吗？我的数据库中已经有一个成员表，我应该创建一个用户名和密码哈希字段并检查它吗？如何让用户使用过期的 cookie 登录？

这是您将使用 ASP.NET 的内置成员服务的实例吗？

ASP.NET MVC 新手寻求帮助。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-02-04T14:30:56.687

当你创建一个新的 ASP.NET MVC 站点时，它已经内置了成员资格。另一个回复中提到的 CodePlex 项目仅在特殊情况下需要，即：

*   您正在使用 MVC 框架的早期测试版，它没有成员资格功能。
*   您想使用像 OpenID 这样的身份验证系统，MVC 不支持“开箱即用”。
*   您希望不包含“开箱即用”的会员管理功能

但是，就像我说的，基本的会员功能已经存在于 MVC 站点中。只需将该`[Authorize]`属性添加到任何需要登录的操作即可。这是常规表单身份验证，因此您在 Web.config 中配置为非 MVC 站点（指定数据库等；网上有很多关于此的信息）。

默认的 MVC 站点将包含一个“帐户”控制器和视图，您可以对其进行自定义以满足您的需求。

要回答这个显而易见的问题，不，你不应该“自己动手”。即使您需要自定义身份验证，创建一个常规的 ASP.NET 成员资格提供程序也比创建一个全新的成员资格框架要好。

**更新**：[CodePlex 项目](http://mvcmembership.codeplex.com/)已更新为与 MVC 1.0 一起使用

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-04T07:59:00.487

如果您想使用安全的东西开始，请使用新项目的模板成员资格或考虑使用[http://www.codeplex.com/MvcMembership](http://www.codeplex.com/MvcMembership)。

# c# - 编程技能测试器(问题) v2.0

> ID：510319
> 
> 赞同：1
> 
> 时间：2009-02-04T06:50:39.737
> 
> 标签：c#, winforms

如果您还没有阅读第[一个](https://stackoverflow.com/questions/510138/programming-skill-tester-problem)问题，请知道要跟上速度。那么，我该如何清除这些复选框呢？我尝试使用@colithium 告诉我用于检查所有复选框状态的相同方法，但是当我运行程序并单击清除时，出现以下运行时错误：

无法将“System.Windows.Forms.Button”类型的对象转换为“System.Windows.Forms.CheckBox”类型。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-04T07:29:25.507

我猜您正在对所有控件运行 foreach 并忘记查看控件是否实际上是一个复选框。

```
foreach (Control c in this.Controls) {
    CheckBox cb = c as CheckBox;
    if (cb!=null) {
        //do your logic
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-04T07:13:55.150

将[CheckBox.Checked](http://msdn.microsoft.com/en-us/library/system.windows.forms.checkbox.checked.aspx)设置为 false。如果这不是您需要的，请在问题中提供更多信息。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-04T13:31:48.897

我假设你的方法看起来像这样：

```
private void clearButton_Click(object sender, EventArgs e)  
{  
    CheckBox cb = (CheckBox)sender;  
    cb.Checked = false;  
} 
```

在这种情况下，“发件人”是清除按钮，而不是复选框。借用 Stormenet 的回答：

```
private void clearButton_click(object sender, EventArgs e)  
{    
    foreach (Control c in this.Controls)   
    {  
        CheckBox cb = c as CheckBox;  
        if (cb != null)  
        {  
            cb.Checked = false;  
        }
    }
} 
```

# visual-studio-2005 - 如何在 VS 2005 IDE 中将壁纸设置为背景

> ID：510321
> 
> 赞同：1
> 
> 时间：2009-02-04T06:50:54.977
> 
> 标签：visual-studio-2005

有没有办法我们可以将图像而不是纯色设置为 VS 2005 IDE 背景

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-04T06:59:31.840

看起来您将不得不编写自己的加载项，因为这似乎不是一个非常受欢迎的请求。

以下是在 VS2003 中的操作方法：http: [//www.codeproject.com/KB/macros/VSWallpaper.aspx](http://www.codeproject.com/KB/macros/VSWallpaper.aspx)

这是 VS2005 的 SDK：http: [//www.microsoft.com/downloads/details.aspx? familyid=51A5C65B-C020-4E08-8AC0-3EB9C06996F4&displaylang=en](http://www.microsoft.com/downloads/details.aspx?familyid=51A5C65B-C020-4E08-8AC0-3EB9C06996F4&displaylang=en)

SDK 中有很多文档和其他示例插件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-04T06:59:31.450

我使用[SlickEdit 免费小工具](http://www.slickedit.com/content/view/441)为我的工作区背景渲染图像。

# vim - 如何一次关闭所有打开的标签？

> ID：510325
> 
> 赞同：432
> 
> 时间：2009-02-04T06:53:37.640
> 
> 标签：vim, vi, shortcuts

如果我打开了 10 个选项卡，我必须分别使用 ":q" 关闭每个选项卡。

我怎样才能一次关闭它们？

* * *

## 回答 #1

> 赞同：643
> 
> 时间：2009-02-04T06:58:37.177

最短/最简单/最快的方法是：

```
:qa 
```

保存所有选项卡中的工作并退出：

```
:wqa 
```

* * *

## 回答 #2

> 赞同：222
> 
> 时间：2009-02-04T07:18:51.193

我经常使用**`:tabo`**( `:tabonly`) 来关闭所有其他选项卡。

* * *

## 回答 #3

> 赞同：28
> 
> 时间：2009-02-04T06:57:15.853

这可以使用以下命令完成（在正常或转义模式下）：

> ```
> :tabdo :q 
> ```

“tabdo”显然对所有打开的选项卡执行命令。

* * *

## 回答 #4

> 赞同：19
> 
> 时间：2009-02-04T07:02:58.633

添加到 fuentesjr 所说的内容：

```
:qa! 
```

如果您不关心保存，将强制退出所有选项卡。

* * *

## 回答 #5

> 赞同：18
> 
> 时间：2016-11-17T23:06:07.307

你可以使用这些 Vim *Ex 命令*中的任何一个来**退出多个窗口和缓冲区**：

1.  `:qa` `:qall`

    退出 Vim，除非有一些缓冲区已被更改。（`:bmod`用于转到下一个修改的缓冲区）。当设置 'autowriteall' 时，所有更改的缓冲区都将被写入，例如`:wqall`.

2.  `:conf qa` `:confirm qall`

    退出 Vim。当某些缓冲区已更改时，会出现提示。见`:confirm`。

3.  `:qa!` `:qall!`

    退出 Vim。对缓冲区的任何更改都将丢失。另请参阅`:cquit`，它的作用相同，但以非零值退出。

4.  `:quita` `:quitall` `:quita!` `:quitall!`

    与 相同`:qall`。

5.  `:wqa` `:wqall` `:xa` `:xall`

    写入所有更改的缓冲区并退出 Vim。如果存在没有文件名的缓冲区，它们是只读的或由于其他原因不能写入，Vim 将不会退出。

6.  `:conf wqa` `:confirm wqall` `:conf xa` `:confirm xall`

    写入所有更改的缓冲区并退出 Vim。当某些缓冲区是只读的或由于其他原因无法写入时，会出现提示。见`:confirm`。

7.  `:wqa!` `:xa!` `:wqall!` `:xall!`

    写入所有更改的缓冲区，即使是只读的，然后退出 Vim。如果有没有文件名的缓冲区或由于其他原因而无法写入的缓冲区，Vim 将不会退出。

要在 Vim 中阅读这些内容，请键入以下 Ex 命令

```
:help window-exit 
```

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2009-02-04T06:56:13.080

```
:qall 
```

这将关闭所有选项卡并打开缓冲区。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2019-05-15T13:06:08.730

这是在 Linux/Mac 上关闭所有 VIM 实例的黑暗方式

```
:!killall vim -9 
```

不要使用它。它可以满足您的要求，但可能不是最好的方式，但很有趣

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2020-06-25T04:17:59.963

我在 VSCode 中使用 VIM 插件，我正在寻找一种方法来关闭当前窗口上打开的所有选项卡。

这些命令不起作用，因为它们关闭了所有窗口中的所有选项卡`:qa`。`:wqa`

该命令`:tabonly`关闭了当前窗口中除当前选项卡之外的所有选项卡。

因为我通常同时只使用 2 个窗口，所以我越接近我的需要就是专注于另一个窗口并运行命令：

```
:on 
```

( `:only`) 它关闭除当前窗口之外的所有窗口。

# python - 我如何使用 django mptt？

> ID：510339
> 
> 赞同：1
> 
> 时间：2009-02-04T07:01:32.570
> 
> 标签：python, django, django-models, django-mptt

我有一个模型：

```
class Company(models.Model):
    name = models.CharField( max_length=100)
    parent = models.ForeignKey('self', null=True, blank=True, related_name='children')
mptt.register(Company, order_insertion_by=['name']) 
```

和

```
class Financials(models.Model):
    year = models.IntegerField()
    revenue = models.DecimalField(max_digits = 10, decimal_places = 2) 
```

那么我怎样才能在 mptt 树结构中添加`Financials`一个孩子呢？`Company`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-04T10:45:07.047

我不太明白你的问题。一棵树存储一种类型的对象，在您的情况下为公司。要将财务链接到公司，只需将外键从财务添加到公司。

如果这没有帮助，请扩展您的问题，向我们提供有关您要实现的目标的更多详细信息。

# c# - 强制接口的子类实现 ToString

> ID：510341
> 
> 赞同：70
> 
> 时间：2009-02-04T07:01:56.093
> 
> 标签：c#, oop

假设我有一个接口`IFoo`，我希望它的所有子类都`IFoo`覆盖 Object 的`ToString`方法。这可能吗？

简单地将方法签名添加到 IFoo 是行不通的：

```
interface IFoo
{
    String ToString();
} 
```

由于所有子类都以`Object`这种方式扩展并提供实现，因此编译器不会抱怨它。有什么建议么？

* * *

## 回答 #1

> 赞同：104
> 
> 时间：2009-02-04T07:08:20.807

我不相信你可以用界面来做到这一点。您可以使用抽象基类：

```
public abstract class Base
{
    public abstract override string ToString(); 
} 
```

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2009-02-04T07:08:26.127

```
abstract class Foo
{
    public override abstract string ToString();
}

class Bar : Foo
{
    // need to override ToString()
} 
```

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-06-06T00:58:04.300

Jon & Andrew：这个抽象的把戏真的很有用；我不知道您可以通过将其声明为抽象来结束链条。干杯:)

过去，当我要求在派生类中重写 ToString() 时，我总是使用如下模式：

```
public abstract class BaseClass
{
    public abstract string ToStringImpl();

    public override string ToString()
    {
        return ToStringImpl();
    }    
} 
```

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2018-06-19T13:58:08.800

很抱歉从坟墓中埋葬了这条旧线，特别是我们亲爱的@jon-skeet[已经提供了他自己的答案](https://stackoverflow.com/a/510358/734181)。

但是，如果您想保留接口而不使用抽象类，我想这仍然可以通过让您的接口实现[System.IFormattable](https://msdn.microsoft.com/en-us/library/system.iformattable(v=vs.110).aspx)接口来实现。

```
interface IFoo : IFormattable
{
} 
```

唯一要记住的是，要正确实现这个 IFormattable，具体实现也应该覆盖它`Object.ToString()`。

[这在这个不错的帖子中得到了清楚的解释。](https://stackoverflow.com/a/14268961/734181)

你的具体课程现在就像

```
public class Bar : IFoo
{
    public string ToString(string format, IFormatProvider formatProvider)
    {
        return $"{nameof(Bar)}";
    }

    public override string ToString()
    {
        return ToString(null, System.Globalization.CultureInfo.CurrentCulture);
    }
} 
```

希望这仍然可以帮助任何人。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-04T07:13:09.223

实现接口方法隐式地密封该方法（以及覆盖它）。因此，除非您另有说明，否则接口的第一个实现将结束 C# 中的覆盖链。

[基本.NET](http://www.amazon.com/exec/obidos/tg/detail/-/0201734117/qid=1120928552/sr=8-1/ref=pd_bbs_ur_1?v=glance&s=books&n=507846)

抽象类 = 你的朋友

检查[这个问题](https://stackoverflow.com/questions/239408/can-i-force-subclasses-to-override-a-method-without-making-it-abstract)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2011-08-04T17:07:14.617

我知道这不能回答您的问题，但是由于无法按照您的要求进行操作，因此我想我会分享自己的方法供其​​他人查看。

我使用了 Mark 和 Andrew 提出的解决方案的混合体。

在我的应用程序中，所有域实体都派生自一个抽象基类：

```
public abstract class Entity
{
    /// <summary>
    /// Returns a <see cref="System.String"/> that represents this instance.
    /// </summary>
    public override string ToString()
    {
        return this is IHasDescription
                   ? ((IHasDescription) this).EntityDescription
                   : base.ToString();
    }
} 
```

接口本身只定义了一个简单的访问器：

```
public interface IHasDescription : IEntity
{
    /// <summary>
    /// Creates a description (in english) of the Entity.
    /// </summary>
    string EntityDescription { get; }
} 
```

所以现在有一个内置的回退机制 - 或者换句话说，一个`Entity`实现`IHasDescription`必须提供的`EntityDescription`，但任何`Entity`仍然可以转换为字符串。

我知道这与这里提出的其他解决方案没有根本不同，但我喜欢最小化基`Entity`类型的责任的想法，因此实现描述接口仍然是可选的，但你被迫实际实现描述-方法，如果你正在实现接口。

恕我直言，由`object`基类实现的接口不应“算作”已实现 - 最好有一个编译器选项，但是，哦，好吧......

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-04T07:08:43.613

我认为您不能强制任何子类*覆盖*任何基类的虚拟方法，除非这些方法是抽象的。

# sql - 更新 postgres 表中的行时出错

> ID：510343
> 
> 赞同：1
> 
> 时间：2009-02-04T07:02:39.743
> 
> 标签：sql, postgresql

我的桌子是：

```
CREATE TABLE A(
    id serial NOT NULL,
    date timestamp without time zone,
    type text,
    sub_type text,
    filename text,
    filepath text,
    filesize integer,
); 
```

我有一个更新程序：

```
$Query = "UPDATE A SET type=\"" . $strType . "\" where id=" . intval($ID); 
```

问题：

当 $strType 是一个字符串时，比如“lettuce”，我得到这个错误：

```
ERROR:  column "lettuce" does not exist 
```

当它是一个 int 时，没有错误。

想法？

更多背景：

*   插入代码成功添加文件名，文件路径，两种文本类型

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-04T07:25:17.030

在 SQL 中，双引号是标识符分隔符。您的 UPDATE 语句试图将该列设置为该`type`列的值，`"lettuce"`如果没有名为 lettuce 的列，这是一个错误。

您想在 SQL 中使用单引号来分隔字符串文字：

```
$Query = "UPDATE A SET type='" . $strType . "' where id=" . intval($ID); 
```

另请参阅“[不同的数据库是否使用不同的名称引用？](https://stackoverflow.com/questions/214309/do-different-databases-use-different-name-quote/214344#214344) ”

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-04T07:29:04.883

您的编码对 SQL 注入开放。使用占位符（可能是不带引号的问号）并单独传递值。这避免了[XKCD](http://xkcd.org/327)的问题。

Bill 可以回答您关于列名与字符串的直接问题。

# python - 如何在 Python 中进行时间延迟？

> ID：510348
> 
> 赞同：3058
> 
> 时间：2009-02-04T07:04:09.647
> 
> 标签：python, python-3.x, delay, sleep, timedelay

我想知道如何在 Python 脚本中设置时间延迟。

* * *

## 回答 #1

> 赞同：3277
> 
> 时间：2009-02-04T07:05:59.533

```
import time
time.sleep(5)   # Delays for 5 seconds. You can also use a float value. 
```

这是另一个大约每分钟运行一次的示例：

```
import time
while True:
    print("This prints once a minute.")
    time.sleep(60) # Delay for 1 minute (60 seconds). 
```

* * *

## 回答 #2

> 赞同：849
> 
> 时间：2008-09-15T16:34:29.780

您可以使用[模块](https://docs.python.org/library/time.html#time.sleep)[`sleep()`中的功能`time`](https://docs.python.org/library/time.html#time.sleep)。它可以采用浮点参数进行亚秒级分辨率。

```
from time import sleep
sleep(0.1) # Time in seconds 
```

* * *

## 回答 #3

> 赞同：108
> 
> 时间：2017-06-21T03:25:05.187

> # 如何在 Python 中进行时间延迟？

在一个线程中，我建议使用[sleep 功能](https://docs.python.org/3/library/time.html#time.sleep)：

```
>>> from time import sleep

>>> sleep(4) 
```

这个函数实际上暂停了操作系统调用它的线程的处理，允许其他线程和进程在它休眠时执行。

将其用于该目的，或仅用于延迟执行功能。例如：

```
>>> def party_time():
...     print('hooray!')
...
>>> sleep(3); party_time()
hooray! 
```

“万岁！” 在我点击 3 秒后打印`Enter`。

### `sleep`使用多个线程和进程的示例

再次，`sleep`暂停您的线程 - 它使用几乎为零的处理能力。

`party_later`为了演示，创建一个这样的脚本（我首先在交互式 Python 3.5 shell 中尝试了这个，但由于某种原因子进程找不到该函数）：

```
from concurrent.futures import ThreadPoolExecutor, ProcessPoolExecutor, as_completed
from time import sleep, time

def party_later(kind='', n=''):
    sleep(3)
    return kind + n + ' party time!: ' + __name__

def main():
    with ProcessPoolExecutor() as proc_executor:
        with ThreadPoolExecutor() as thread_executor:
            start_time = time()
            proc_future1 = proc_executor.submit(party_later, kind='proc', n='1')
            proc_future2 = proc_executor.submit(party_later, kind='proc', n='2')
            thread_future1 = thread_executor.submit(party_later, kind='thread', n='1')
            thread_future2 = thread_executor.submit(party_later, kind='thread', n='2')
            for f in as_completed([
              proc_future1, proc_future2, thread_future1, thread_future2,]):
                print(f.result())
            end_time = time()
    print('total time to execute four 3-sec functions:', end_time - start_time)

if __name__ == '__main__':
    main() 
```

此脚本的示例输出：

```
thread1 party time!: __main__
thread2 party time!: __main__
proc1 party time!: __mp_main__
proc2 party time!: __mp_main__
total time to execute four 3-sec functions: 3.4519670009613037 
```

## 多线程

`Timer` [您可以使用线程](https://docs.python.org/3/library/threading.html)对象触发稍后在单独线程中调用的函数：

```
>>> from threading import Timer
>>> t = Timer(3, party_time, args=None, kwargs=None)
>>> t.start()
>>>
>>> hooray!

>>> 
```

空白行说明该函数打印到我的标准输出，我必须点击`Enter`以确保我在提示符下。

这种方法的好处是，当`Timer`线程等待时，我可以做其他事情，在这种情况下，`Enter`在函数执行之前点击一次（见第一个空提示）。

[多处理库](https://docs.python.org/3/library/multiprocessing.html)中没有相应的对象。您可以创建一个，但它可能由于某种原因不存在。对于一个简单的计时器来说，一个子线程比一个全新的子进程更有意义。

* * *

## 回答 #4

> 赞同：81
> 
> 时间：2018-01-05T10:41:24.263

延迟也可以通过以下方法实现。

第一种方法：

```
import time
time.sleep(5) # Delay for 5 seconds. 
```

第二种延迟方法是使用隐式等待方法：

```
 driver.implicitly_wait(5) 
```

当您必须等到特定操作完成或找到元素时，第三种方法更有用：

```
self.wait.until(EC.presence_of_element_located((By.ID, 'UserName')) 
```

* * *

## 回答 #5

> 赞同：57
> 
> 时间：2018-07-05T20:47:48.973

我知道有五种方法：`time.sleep()`, `pygame.time.wait()`, matplotlib's `pyplot.pause()`, `.after()`, 和`asyncio.sleep()`.

* * *

`time.sleep()`示例（如果使用 tkinter，请勿使用）：

```
import time
print('Hello')
time.sleep(5) # Number of seconds
print('Bye') 
```

* * *

`pygame.time.wait()`示例（如果您不使用 pygame 窗口，则不推荐，但您可以立即退出窗口）：

```
import pygame
# If you are going to use the time module
# don't do "from pygame import *"
pygame.init()
print('Hello')
pygame.time.wait(5000) # Milliseconds
print('Bye') 
```

* * *

matplotlib 的函数`pyplot.pause()`示例（不使用图形时不推荐，但可以立即退出图形）：

```
import matplotlib
print('Hello')
matplotlib.pyplot.pause(5) # Seconds
print('Bye') 
```

* * *

方法（最好使用`.after()`Tkinter）：

```
import tkinter as tk # Tkinter for Python&nbsp;2
root = tk.Tk()
print('Hello')
def ohhi():
    print('Oh, hi!')
root.after(5000, ohhi) # Milliseconds and then a function
print('Bye') 
```

* * *

最后，`asyncio.sleep()`方法：

```
import asyncio
asyncio.sleep(5) 
```

* * *

## 回答 #6

> 赞同：55
> 
> 时间：2014-05-14T21:30:35.883

一个昏昏欲睡的[发电机](https://wiki.python.org/moin/Generators)有点乐趣。

问题是关于时间延迟。它可以是固定时间，但在某些情况下，我们可能需要测量自上次以来的延迟。这是一种可能的解决方案：

# 自上次以来测量的延迟（定期醒来）

情况可能是，我们想尽可能有规律地做某事，我们不想打扰我们代码周围的所有东西`last_time`。`next_time`

## 蜂鸣器发生器

以下代码 ( **sleepy.py** ) 定义了一个`buzzergen`生成器：

```
import time
from itertools import count

def buzzergen(period):
    nexttime = time.time() + period
    for i in count():
        now = time.time()
        tosleep = nexttime - now
        if tosleep > 0:
            time.sleep(tosleep)
            nexttime += period
        else:
            nexttime = now + period
        yield i, nexttime 
```

## 调用常规蜂鸣器

```
from sleepy import buzzergen
import time
buzzer = buzzergen(3) # Planning to wake up each 3 seconds
print time.time()
buzzer.next()
print time.time()
time.sleep(2)
buzzer.next()
print time.time()
time.sleep(5) # Sleeping a bit longer than usually
buzzer.next()
print time.time()
buzzer.next()
print time.time() 
```

运行它，我们看到：

```
1400102636.46
1400102639.46
1400102642.46
1400102647.47
1400102650.47 
```

我们也可以直接循环使用：

```
import random
for ring in buzzergen(3):
    print "now", time.time()
    print "ring", ring
    time.sleep(random.choice([0, 2, 4, 6])) 
```

运行它我们可能会看到：

```
now 1400102751.46
ring (0, 1400102754.461676)
now 1400102754.46
ring (1, 1400102757.461676)
now 1400102757.46
ring (2, 1400102760.461676)
now 1400102760.46
ring (3, 1400102763.461676)
now 1400102766.47
ring (4, 1400102769.47115)
now 1400102769.47
ring (5, 1400102772.47115)
now 1400102772.47
ring (6, 1400102775.47115)
now 1400102775.47
ring (7, 1400102778.47115) 
```

正如我们所看到的，这个蜂鸣器不是太死板，即使我们睡过头并且超出了正常的日程安排，也能让我们赶上定期的困倦时间。

* * *

## 回答 #7

> 赞同：34
> 
> 时间：2017-02-28T19:45:40.240

Python 标准库中的[Tkinter](http://en.wikipedia.org/wiki/Tkinter)库是一个可以导入的交互式工具。基本上，您可以创建按钮和框以及弹出窗口和显示为您使用代码操作的窗口的东西。

如果您使用 Tkinter，***请不要使用`time.sleep()`***，因为它会破坏您的程序。这发生在我身上。取而代之的是，使用`root.after()`并用毫秒替换值。例如，`time.sleep(1)`相当于`root.after(1000)`在 Tkinter 中。

否则，`time.sleep()`许多答案已经指出，这是要走的路。

* * *

## 回答 #8

> 赞同：28
> 
> 时间：2017-06-13T19:04:18.173

延迟是通过[时间库](https://docs.python.org/2/library/time.html)完成的，特别是[`time.sleep()`](https://docs.python.org/2/library/time.html#time.sleep)函数。

让它等待一秒钟：

```
from time import sleep
sleep(1) 
```

这是有效的，因为这样做：

```
from time import sleep 
```

**您仅从**[time library](https://docs.python.org/2/library/time.html)中提取[sleep 函数](https://docs.python.org/2/library/time.html#time.sleep) ，这意味着您可以使用以下命令调用它：

 **```
sleep(seconds) 
```

而不必打字

```
time.sleep() 
```

打字太长了。

使用此方法，您将无法访问[时间库](https://docs.python.org/2/library/time.html)的其他功能，并且您无法拥有名为`sleep`. 但是您可以创建一个名为`time`.

[`from [library] import [function] (, [function2])`](https://docs.python.org/2/tutorial/modules.html#more-on-modules)如果您只想要模块的某些部分，那么这样做很好。

你同样可以这样做：

```
import time
time.sleep(1) 
```

只要您键入，您就可以访问[时间库](https://docs.python.org/2/library/time.html)的其他功能，但是您无法创建变量 time 因为它会覆盖导入。解决这个问题[`time.clock()`](https://docs.python.org/2/library/time.html#time.clock)`time.[function]()`

```
import time as t 
```

这将允许您将[时间库](https://docs.python.org/2/library/time.html)引用为`t`，允许您执行以下操作：

```
t.sleep() 
```

这适用于任何图书馆。

* * *

## 回答 #9

> 赞同：14
> 
> 时间：2019-01-10T12:13:25.860

### 如果您想在 Python 脚本中设置时间延迟：

使用**`time.sleep`**或**`Event().wait`**像这样：

```
from threading import Event
from time import sleep

delay_in_sec = 2

# Use time.sleep like this
sleep(delay_in_sec)         # Returns None
print(f'slept for {delay_in_sec} seconds')

# Or use Event().wait like this
Event().wait(delay_in_sec)  # Returns False
print(f'waited for {delay_in_sec} seconds') 
```

# 但是，如果您想延迟函数的执行，请执行以下操作：

像这样使用[**`threading.Timer`**](https://docs.python.org/2.7/library/threading.html?highlight=timer#threading.Timer)：

```
from threading import Timer

delay_in_sec = 2

def hello(delay_in_sec):
    print(f'function called after {delay_in_sec} seconds')

t = Timer(delay_in_sec, hello, [delay_in_sec])  # Hello function will be called 2 seconds later with [delay_in_sec] as the *args parameter
t.start()  # Returns None
print("Started") 
```

输出：

```
Started
function called after 2 seconds 
```

### 为什么使用后一种方法？

*   它不会**停止**整个脚本的执行（您传递给它的函数除外）。
*   启动计时器后，您也可以通过执行来停止它`timer_obj.cancel()`。

* * *

## 回答 #10

> 赞同：13
> 
> 时间：2018-12-03T19:12:52.497

## 异步睡眠

请注意，在最近的 Python 版本（Python 3.4 或更高版本）中，您可以使用`asyncio.sleep`. 它与异步编程和asyncio有关。查看下一个示例：

```
import asyncio
from datetime import datetime

@asyncio.coroutine
def countdown(iteration_name, countdown_sec):
    """
    Just count for some countdown_sec seconds and do nothing else
    """
    while countdown_sec > 0:
       print(f'{iteration_name} iterates: {countdown_sec} seconds')
       yield from asyncio.sleep(1)
       countdown_sec -= 1

loop = asyncio.get_event_loop()
tasks = [asyncio.ensure_future(countdown('First Count', 2)),
         asyncio.ensure_future(countdown('Second Count', 3))]

start_time = datetime.utcnow()

# Run both methods. How much time will both run...?
loop.run_until_complete(asyncio.wait(tasks))

loop.close()

print(f'total running time: {datetime.utcnow() - start_time}') 
```

我们可能会认为它会在第一种方法中“休眠”2 秒，然后在第二种方法中“休眠”3 秒，这段代码总共运行了 5 秒。但它会打印：

```
total_running_time: 0:00:03.01286 
```

建议阅读[asyncio 官方文档](https://docs.python.org/3/library/asyncio.html)了解更多详情。

* * *

## 回答 #11

> 赞同：9
> 
> 时间：2018-06-05T07:10:14.920

虽然其他人都建议使用事实上的`time`模块，但我想我会使用`matplotlib`'s`pyplot`函数分享不同的方法，[`pause`](https://matplotlib.org/api/_as_gen/matplotlib.pyplot.pause.html).

### 一个例子

```
from matplotlib import pyplot as plt
plt.pause(5)    # Pauses the program for 5 seconds 
```

通常，这用于防止情节在绘制后立即消失或制作粗略的动画。

`import`如果您已经`matplotlib`导入，这将节省您的时间。

* * *

## 回答 #12

> 赞同：8
> 
> 时间：2018-09-16T08:14:05.107

这是时间延迟的一个简单示例：

```
import time

def delay(period='5'):
    # If the user enters nothing, it'll wait 5 seconds
    try:
        # If the user not enters a int, I'll just return ''
        time.sleep(period)
    except:
        return '' 
```

另一个，在[Tkinter](http://en.wikipedia.org/wiki/Tkinter)中：

```
import tkinter

def tick():
    pass

root = Tk()
delay = 100 # Time in milliseconds
root.after(delay, tick)
root.mainloop() 
```

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2019-04-13T06:09:22.323

你也可以试试这个：

```
import time
# The time now
start = time.time() 
while time.time() - start < 10: # Run 1- seconds
    pass
# Do the job 
```

现在外壳不会崩溃或没有反应。

# python - 如何从用户那里读取单个字符？

> ID：510357
> 
> 赞同：298
> 
> 时间：2009-02-04T07:08:03.117
> 
> 标签：python, input

有没有办法从用户输入中读取一个字符？例如，他们在终端上按一个键并返回（有点像`getch()`）。我知道 Windows 中有一个功能，但我想要跨平台的东西。

* * *

## 回答 #1

> 赞同：219
> 
> 时间：2009-02-04T07:11:04.313

这是 ActiveState Recipes 站点的链接，该站点说明了如何在 Windows、Linux 和 OSX 中读取单个字符：

    [在 Windows 和 Unix 上从标准输入读取类似 getch() 的无缓冲字符](https://code.activestate.com/recipes/134892/)

```
class _Getch:
    """Gets a single character from standard input.  Does not echo to the
screen."""
    def __init__(self):
        try:
            self.impl = _GetchWindows()
        except ImportError:
            self.impl = _GetchUnix()

    def __call__(self): return self.impl()

class _GetchUnix:
    def __init__(self):
        import tty, sys

    def __call__(self):
        import sys, tty, termios
        fd = sys.stdin.fileno()
        old_settings = termios.tcgetattr(fd)
        try:
            tty.setraw(sys.stdin.fileno())
            ch = sys.stdin.read(1)
        finally:
            termios.tcsetattr(fd, termios.TCSADRAIN, old_settings)
        return ch

class _GetchWindows:
    def __init__(self):
        import msvcrt

    def __call__(self):
        import msvcrt
        return msvcrt.getch()

getch = _Getch() 
```

* * *

## 回答 #2

> 赞同：92
> 
> 时间：2009-02-04T07:30:51.713

```
sys.stdin.read(1) 
```

基本上会从 STDIN 读取 1 个字节。

如果您必须使用不等待的方法，`\n`您可以按照上一个答案中的建议使用此代码：

```
class _Getch:
    """Gets a single character from standard input.  Does not echo to the screen."""
    def __init__(self):
        try:
            self.impl = _GetchWindows()
        except ImportError:
            self.impl = _GetchUnix()

    def __call__(self): return self.impl()

class _GetchUnix:
    def __init__(self):
        import tty, sys

    def __call__(self):
        import sys, tty, termios
        fd = sys.stdin.fileno()
        old_settings = termios.tcgetattr(fd)
        try:
            tty.setraw(sys.stdin.fileno())
            ch = sys.stdin.read(1)
        finally:
            termios.tcsetattr(fd, termios.TCSADRAIN, old_settings)
        return ch

class _GetchWindows:
    def __init__(self):
        import msvcrt

    def __call__(self):
        import msvcrt
        return msvcrt.getch()

getch = _Getch() 
```

（*取自* [*http://code.activestate.com/recipes/134892/*](http://code.activestate.com/recipes/134892/)）

* * *

## 回答 #3

> 赞同：77
> 
> 时间：2014-02-09T13:27:42.640

在两个答案中逐字引用的 ActiveState[配方](http://code.activestate.com/recipes/134892/)是过度设计的。可以归结为：

```
def _find_getch():
    try:
        import termios
    except ImportError:
        # Non-POSIX. Return msvcrt's (Windows') getch.
        import msvcrt
        return msvcrt.getch

    # POSIX system. Create and return a getch that manipulates the tty.
    import sys, tty
    def _getch():
        fd = sys.stdin.fileno()
        old_settings = termios.tcgetattr(fd)
        try:
            tty.setraw(fd)
            ch = sys.stdin.read(1)
        finally:
            termios.tcsetattr(fd, termios.TCSADRAIN, old_settings)
        return ch

    return _getch

getch = _find_getch() 
```

* * *

## 回答 #4

> 赞同：68
> 
> 时间：2014-08-16T18:47:41.187

同样值得尝试的是[readchar](https://github.com/magmax/python-readchar)库，它部分基于其他答案中提到的 ActiveState 配方。

安装：

```
pip install readchar 
```

用法：

```
import readchar
print("Reading a char:")
print(repr(readchar.readchar()))
print("Reading a key:")
print(repr(readchar.readkey())) 
```

使用 Python 2.7 在 Windows 和 Linux 上测试。

在 Windows 上，仅支持映射到字母或 ASCII 控制代码的键（`Backspace`、`Enter`、`Esc`、`Tab`、`Ctrl`+*字母*）。在 GNU/Linux 上（可能取决于确切的终端？）您还可以得到`Insert`, `Delete`, `Pg Up`, `Pg Dn`, `Home`,`End`和键...但是，将这些特殊键与.`F *n*``Esc`

警告：就像这里的大多数（全部？）答案一样，信号键（如`Ctrl`+ `C`、`Ctrl`+`D`和`Ctrl`+ `Z`）被捕获并返回（分别为`'\x03'`和`'\x04'`）`'\x1a'`；您的程序可能很难中止。

* * *

## 回答 #5

> 赞同：21
> 
> 时间：2011-08-31T15:30:40.340

另一种方法：

```
import os
import sys    
import termios
import fcntl

def getch():
  fd = sys.stdin.fileno()

  oldterm = termios.tcgetattr(fd)
  newattr = termios.tcgetattr(fd)
  newattr[3] = newattr[3] & ~termios.ICANON & ~termios.ECHO
  termios.tcsetattr(fd, termios.TCSANOW, newattr)

  oldflags = fcntl.fcntl(fd, fcntl.F_GETFL)
  fcntl.fcntl(fd, fcntl.F_SETFL, oldflags | os.O_NONBLOCK)

  try:        
    while 1:            
      try:
        c = sys.stdin.read(1)
        break
      except IOError: pass
  finally:
    termios.tcsetattr(fd, termios.TCSAFLUSH, oldterm)
    fcntl.fcntl(fd, fcntl.F_SETFL, oldflags)
  return c 
```

从[这篇博文](http://love-python.blogspot.com/2010/03/getch-in-python-get-single-character.html)。

* * *

## 回答 #6

> 赞同：13
> 
> 时间：2016-05-02T02:49:47.370

（当前）排名靠前的答案（使用 ActiveState 代码）过于复杂。当仅仅一个函数就足够时，我看不到使用类的理由。下面是两个实现相同的功能但代码更易读的实现。

**这两种实现：**

1.  在 Python 2 或 Python 3 中工作得很好
2.  在 Windows、OSX 和 Linux 上工作
3.  只读取一个字节（即，他们不等待换行符）
4.  不依赖任何外部库
5.  是自包含的（函数定义之外没有代码）

**版本 1：可读且简单**

```
def getChar():
    try:
        # for Windows-based systems
        import msvcrt # If successful, we are on Windows
        return msvcrt.getch()

    except ImportError:
        # for POSIX-based systems (with termios & tty support)
        import tty, sys, termios  # raises ImportError if unsupported

        fd = sys.stdin.fileno()
        oldSettings = termios.tcgetattr(fd)

        try:
            tty.setcbreak(fd)
            answer = sys.stdin.read(1)
        finally:
            termios.tcsetattr(fd, termios.TCSADRAIN, oldSettings)

        return answer 
```

**版本 2：避免重复导入和异常处理：**

**[编辑]**我错过了 ActiveState 代码的一个优势。如果您计划多次读取字符，则该代码避免了在类 Unix 系统上重复 Windows 导入和 ImportError 异常处理的（可忽略的）成本。虽然您可能应该更关心代码的可读性而不是微不足道的优化，但这里有一个替代方法（它类似于 Louis 的答案，但 getChar() 是自包含的），其功能与 ActiveState 代码相同并且更具可读性：

```
def getChar():
    # figure out which function to use once, and store it in _func
    if "_func" not in getChar.__dict__:
        try:
            # for Windows-based systems
            import msvcrt # If successful, we are on Windows
            getChar._func=msvcrt.getch

        except ImportError:
            # for POSIX-based systems (with termios & tty support)
            import tty, sys, termios # raises ImportError if unsupported

            def _ttyRead():
                fd = sys.stdin.fileno()
                oldSettings = termios.tcgetattr(fd)

                try:
                    tty.setcbreak(fd)
                    answer = sys.stdin.read(1)
                finally:
                    termios.tcsetattr(fd, termios.TCSADRAIN, oldSettings)

                return answer

            getChar._func=_ttyRead

    return getChar._func() 
```

**执行上述任一 getChar() 版本的示例代码：**

```
from __future__ import print_function # put at top of file if using Python 2

# Example of a prompt for one character of input
promptStr   = "Please give me a character:"
responseStr = "Thank you for giving me a '{}'."
print(promptStr, end="\n> ")
answer = getChar()
print("\n")
print(responseStr.format(answer)) 
```

* * *

## 回答 #7

> 赞同：12
> 
> 时间：2014-01-01T05:13:33.227

如果按下+或+ ，此代码基于[此处](http://code.activestate.com/recipes/134892/)，将正确引发 KeyboardInterrupt 和 EOFError 。`Ctrl``C``Ctrl``D`

应该在 Windows 和 Linux 上工作。OS X 版本可从原始来源获得。

```
class _Getch:
    """Gets a single character from standard input.  Does not echo to the screen."""
    def __init__(self):
        try:
            self.impl = _GetchWindows()
        except ImportError:
            self.impl = _GetchUnix()

    def __call__(self): 
        char = self.impl()
        if char == '\x03':
            raise KeyboardInterrupt
        elif char == '\x04':
            raise EOFError
        return char

class _GetchUnix:
    def __init__(self):
        import tty
        import sys

    def __call__(self):
        import sys
        import tty
        import termios
        fd = sys.stdin.fileno()
        old_settings = termios.tcgetattr(fd)
        try:
            tty.setraw(sys.stdin.fileno())
            ch = sys.stdin.read(1)
        finally:
            termios.tcsetattr(fd, termios.TCSADRAIN, old_settings)
        return ch

class _GetchWindows:
    def __init__(self):
        import msvcrt

    def __call__(self):
        import msvcrt
        return msvcrt.getch()

getch = _Getch() 
```

* * *

## 回答 #8

> 赞同：8
> 
> 时间：2015-07-21T21:42:36.843

尝试使用这个：[http](http://home.wlu.edu/~levys/software/kbhit.py) ://home.wlu.edu/~levys/software/kbhit.py 它是非阻塞的（这意味着你可以有一个while循环并检测按键而不停止它）和跨平台。

```
import os

# Windows
if os.name == 'nt':
    import msvcrt

# Posix (Linux, OS X)
else:
    import sys
    import termios
    import atexit
    from select import select

class KBHit:

    def __init__(self):
        '''Creates a KBHit object that you can call to do various keyboard things.'''

        if os.name == 'nt':
            pass

        else:

            # Save the terminal settings
            self.fd = sys.stdin.fileno()
            self.new_term = termios.tcgetattr(self.fd)
            self.old_term = termios.tcgetattr(self.fd)

            # New terminal setting unbuffered
            self.new_term[3] = (self.new_term[3] & ~termios.ICANON & ~termios.ECHO)
            termios.tcsetattr(self.fd, termios.TCSAFLUSH, self.new_term)

            # Support normal-terminal reset at exit
            atexit.register(self.set_normal_term)

    def set_normal_term(self):
        ''' Resets to normal terminal.  On Windows this is a no-op.
        '''

        if os.name == 'nt':
            pass

        else:
            termios.tcsetattr(self.fd, termios.TCSAFLUSH, self.old_term)

    def getch(self):
        ''' Returns a keyboard character after kbhit() has been called.
            Should not be called in the same program as getarrow().
        '''

        s = ''

        if os.name == 'nt':
            return msvcrt.getch().decode('utf-8')

        else:
            return sys.stdin.read(1)

    def getarrow(self):
        ''' Returns an arrow-key code after kbhit() has been called. Codes are
        0 : up
        1 : right
        2 : down
        3 : left
        Should not be called in the same program as getch().
        '''

        if os.name == 'nt':
            msvcrt.getch() # skip 0xE0
            c = msvcrt.getch()
            vals = [72, 77, 80, 75]

        else:
            c = sys.stdin.read(3)[2]
            vals = [65, 67, 66, 68]

        return vals.index(ord(c.decode('utf-8')))

    def kbhit(self):
        ''' Returns True if keyboard character was hit, False otherwise.
        '''
        if os.name == 'nt':
            return msvcrt.kbhit()

        else:
            dr,dw,de = select([sys.stdin], [], [], 0)
            return dr != [] 
```

一个使用这个的例子：

```
import kbhit

kb = kbhit.KBHit()

while(True): 
    print("Key not pressed") #Do something
    if kb.kbhit(): #If a key is pressed:
        k_in = kb.getch() #Detect what key was pressed
        print("You pressed ", k_in, "!") #Do something
kb.set_normal_term() 
```

或者你可以使用[PyPi 的 getch 模块](https://pypi.python.org/pypi/getch)。但这会阻塞while循环

* * *

## 回答 #9

> 赞同：8
> 
> 时间：2015-07-31T15:17:50.213

[这里](http://code.activestate.com/recipes/134892-getch-like-unbuffered-character-reading-from-stdin/)的答案提供了丰富的信息，但是我还想要一种方法来异步获取按键并在单独的事件中触发按键，所有这些都以线程安全、跨平台的方式进行。PyGame 对我来说也太臃肿了。所以我做了以下（在 Python 2.7 中，但我怀疑它很容易移植），我想我会在这里分享，以防它对其他人有用。我将它存储在一个名为 keyPress.py 的文件中。

```
class _Getch:
    """Gets a single character from standard input.  Does not echo to the
screen. From http://code.activestate.com/recipes/134892/"""
    def __init__(self):
        try:
            self.impl = _GetchWindows()
        except ImportError:
            try:
                self.impl = _GetchMacCarbon()
            except(AttributeError, ImportError):
                self.impl = _GetchUnix()

    def __call__(self): return self.impl()

class _GetchUnix:
    def __init__(self):
        import tty, sys, termios # import termios now or else you'll get the Unix version on the Mac

    def __call__(self):
        import sys, tty, termios
        fd = sys.stdin.fileno()
        old_settings = termios.tcgetattr(fd)
        try:
            tty.setraw(sys.stdin.fileno())
            ch = sys.stdin.read(1)
        finally:
            termios.tcsetattr(fd, termios.TCSADRAIN, old_settings)
        return ch

class _GetchWindows:
    def __init__(self):
        import msvcrt

    def __call__(self):
        import msvcrt
        return msvcrt.getch()

class _GetchMacCarbon:
    """
    A function which returns the current ASCII key that is down;
    if no ASCII key is down, the null string is returned.  The
    page http://www.mactech.com/macintosh-c/chap02-1.html was
    very helpful in figuring out how to do this.
    """
    def __init__(self):
        import Carbon
        Carbon.Evt #see if it has this (in Unix, it doesn't)

    def __call__(self):
        import Carbon
        if Carbon.Evt.EventAvail(0x0008)[0]==0: # 0x0008 is the keyDownMask
            return ''
        else:
            #
            # The event contains the following info:
            # (what,msg,when,where,mod)=Carbon.Evt.GetNextEvent(0x0008)[1]
            #
            # The message (msg) contains the ASCII char which is
            # extracted with the 0x000000FF charCodeMask; this
            # number is converted to an ASCII character with chr() and
            # returned
            #
            (what,msg,when,where,mod)=Carbon.Evt.GetNextEvent(0x0008)[1]
            return chr(msg & 0x000000FF)

import threading

# From  https://stackoverflow.com/a/2022629/2924421
class Event(list):
    def __call__(self, *args, **kwargs):
        for f in self:
            f(*args, **kwargs)

    def __repr__(self):
        return "Event(%s)" % list.__repr__(self)            

def getKey():
    inkey = _Getch()
    import sys
    for i in xrange(sys.maxint):
        k=inkey()
        if k<>'':break
    return k

class KeyCallbackFunction():
    callbackParam = None
    actualFunction = None

    def __init__(self, actualFunction, callbackParam):
        self.actualFunction = actualFunction
        self.callbackParam = callbackParam

    def doCallback(self, inputKey):
        if not self.actualFunction is None:
            if self.callbackParam is None:
                callbackFunctionThread = threading.Thread(target=self.actualFunction, args=(inputKey,))
            else:
                callbackFunctionThread = threading.Thread(target=self.actualFunction, args=(inputKey,self.callbackParam))

            callbackFunctionThread.daemon = True
            callbackFunctionThread.start()

class KeyCapture():

    gotKeyLock = threading.Lock()
    gotKeys = []
    gotKeyEvent = threading.Event()

    keyBlockingSetKeyLock = threading.Lock()

    addingEventsLock = threading.Lock()
    keyReceiveEvents = Event()

    keysGotLock = threading.Lock()
    keysGot = []

    keyBlockingKeyLockLossy = threading.Lock()
    keyBlockingKeyLossy = None
    keyBlockingEventLossy = threading.Event()

    keysBlockingGotLock = threading.Lock()
    keysBlockingGot = []
    keyBlockingGotEvent = threading.Event()

    wantToStopLock = threading.Lock()
    wantToStop = False

    stoppedLock = threading.Lock()
    stopped = True

    isRunningEvent = False

    getKeyThread = None

    keyFunction = None
    keyArgs = None

    # Begin capturing keys. A seperate thread is launched that
    # captures key presses, and then these can be received via get,
    # getAsync, and adding an event via addEvent. Note that this
    # will prevent the system to accept keys as normal (say, if
    # you are in a python shell) because it overrides that key
    # capturing behavior.

    # If you start capture when it's already been started, a
    # InterruptedError("Keys are still being captured")
    # will be thrown

    # Note that get(), getAsync() and events are independent, so if a key is pressed:
    #
    # 1: Any calls to get() that are waiting, with lossy on, will return
    #    that key
    # 2: It will be stored in the queue of get keys, so that get() with lossy
    #    off will return the oldest key pressed not returned by get() yet.
    # 3: All events will be fired with that key as their input
    # 4: It will be stored in the list of getAsync() keys, where that list
    #    will be returned and set to empty list on the next call to getAsync().
    # get() call with it, aand add it to the getAsync() list.
    def startCapture(self, keyFunction=None, args=None):
        # Make sure we aren't already capturing keys
        self.stoppedLock.acquire()
        if not self.stopped:
            self.stoppedLock.release()
            raise InterruptedError("Keys are still being captured")
            return
        self.stopped = False
        self.stoppedLock.release()

        # If we have captured before, we need to allow the get() calls to actually
        # wait for key presses now by clearing the event
        if self.keyBlockingEventLossy.is_set():
            self.keyBlockingEventLossy.clear()

        # Have one function that we call every time a key is captured, intended for stopping capture
        # as desired
        self.keyFunction = keyFunction
        self.keyArgs = args

        # Begin capturing keys (in a seperate thread)
        self.getKeyThread = threading.Thread(target=self._threadProcessKeyPresses)
        self.getKeyThread.daemon = True
        self.getKeyThread.start()

        # Process key captures (in a seperate thread)
        self.getKeyThread = threading.Thread(target=self._threadStoreKeyPresses)
        self.getKeyThread.daemon = True
        self.getKeyThread.start()

    def capturing(self):
        self.stoppedLock.acquire()
        isCapturing = not self.stopped
        self.stoppedLock.release()
        return isCapturing
    # Stops the thread that is capturing keys on the first opporunity
    # has to do so. It usually can't stop immediately because getting a key
    # is a blocking process, so this will probably stop capturing after the
    # next key is pressed.
    #
    # However, Sometimes if you call stopCapture it will stop before starting capturing the
    # next key, due to multithreading race conditions. So if you want to stop capturing
    # reliably, call stopCapture in a function added via addEvent. Then you are
    # guaranteed that capturing will stop immediately after the rest of the callback
    # functions are called (before starting to capture the next key).
    def stopCapture(self):
        self.wantToStopLock.acquire()
        self.wantToStop = True 
        self.wantToStopLock.release()

    # Takes in a function that will be called every time a key is pressed (with that
    # key passed in as the first paramater in that function)
    def addEvent(self, keyPressEventFunction, args=None):   
        self.addingEventsLock.acquire()
        callbackHolder = KeyCallbackFunction(keyPressEventFunction, args)
        self.keyReceiveEvents.append(callbackHolder.doCallback)
        self.addingEventsLock.release()
    def clearEvents(self):
        self.addingEventsLock.acquire()
        self.keyReceiveEvents = Event()
        self.addingEventsLock.release()
    # Gets a key captured by this KeyCapture, blocking until a key is pressed.
    # There is an optional lossy paramater:
    # If True all keys before this call are ignored, and the next pressed key
    #   will be returned.
    # If False this will return the oldest key captured that hasn't
    #   been returned by get yet. False is the default.
    def get(self, lossy=False):
        if lossy:
            # Wait for the next key to be pressed
            self.keyBlockingEventLossy.wait()
            self.keyBlockingKeyLockLossy.acquire()
            keyReceived = self.keyBlockingKeyLossy
            self.keyBlockingKeyLockLossy.release()
            return keyReceived
        else:
            while True:
                # Wait until a key is pressed
                self.keyBlockingGotEvent.wait()

                # Get the key pressed
                readKey = None
                self.keysBlockingGotLock.acquire()
                # Get a key if it exists
                if len(self.keysBlockingGot) != 0:
                    readKey = self.keysBlockingGot.pop(0)
                # If we got the last one, tell us to wait
                if len(self.keysBlockingGot) == 0:
                    self.keyBlockingGotEvent.clear()
                self.keysBlockingGotLock.release()

                # Process the key (if it actually exists)
                if not readKey is None:
                    return readKey

                # Exit if we are stopping
                self.wantToStopLock.acquire()
                if self.wantToStop:
                    self.wantToStopLock.release()
                    return None
                self.wantToStopLock.release()

    def clearGetList(self):
        self.keysBlockingGotLock.acquire()
        self.keysBlockingGot = []
        self.keysBlockingGotLock.release()

    # Gets a list of all keys pressed since the last call to getAsync, in order
    # from first pressed, second pressed, .., most recent pressed
    def getAsync(self):
        self.keysGotLock.acquire();
        keysPressedList = list(self.keysGot)
        self.keysGot = []
        self.keysGotLock.release()
        return keysPressedList

    def clearAsyncList(self):
        self.keysGotLock.acquire();
        self.keysGot = []
        self.keysGotLock.release();

    def _processKey(self, readKey):
        # Append to list for GetKeyAsync
        self.keysGotLock.acquire()
        self.keysGot.append(readKey)
        self.keysGotLock.release()

        # Call lossy blocking key events
        self.keyBlockingKeyLockLossy.acquire()
        self.keyBlockingKeyLossy = readKey
        self.keyBlockingEventLossy.set()
        self.keyBlockingEventLossy.clear()
        self.keyBlockingKeyLockLossy.release()

        # Call non-lossy blocking key events
        self.keysBlockingGotLock.acquire()
        self.keysBlockingGot.append(readKey)
        if len(self.keysBlockingGot) == 1:
            self.keyBlockingGotEvent.set()
        self.keysBlockingGotLock.release()

        # Call events added by AddEvent
        self.addingEventsLock.acquire()
        self.keyReceiveEvents(readKey)
        self.addingEventsLock.release()

    def _threadProcessKeyPresses(self):
        while True:
            # Wait until a key is pressed
            self.gotKeyEvent.wait()

            # Get the key pressed
            readKey = None
            self.gotKeyLock.acquire()
            # Get a key if it exists
            if len(self.gotKeys) != 0:
                readKey = self.gotKeys.pop(0)
            # If we got the last one, tell us to wait
            if len(self.gotKeys) == 0:
                self.gotKeyEvent.clear()
            self.gotKeyLock.release()

            # Process the key (if it actually exists)
            if not readKey is None:
                self._processKey(readKey)

            # Exit if we are stopping
            self.wantToStopLock.acquire()
            if self.wantToStop:
                self.wantToStopLock.release()
                break
            self.wantToStopLock.release()

    def _threadStoreKeyPresses(self):
        while True:
            # Get a key
            readKey = getKey()

            # Run the potential shut down function
            if not self.keyFunction is None:
                self.keyFunction(readKey, self.keyArgs)

            # Add the key to the list of pressed keys
            self.gotKeyLock.acquire()
            self.gotKeys.append(readKey)
            if len(self.gotKeys) == 1:
                self.gotKeyEvent.set()
            self.gotKeyLock.release()

            # Exit if we are stopping
            self.wantToStopLock.acquire()
            if self.wantToStop:
                self.wantToStopLock.release()
                self.gotKeyEvent.set()
                break
            self.wantToStopLock.release()

        # If we have reached here we stopped capturing

        # All we need to do to clean up is ensure that
        # all the calls to .get() now return None.
        # To ensure no calls are stuck never returning,
        # we will leave the event set so any tasks waiting
        # for it immediately exit. This will be unset upon
        # starting key capturing again.

        self.stoppedLock.acquire()

        # We also need to set this to True so we can start up
        # capturing again.
        self.stopped = True
        self.stopped = True

        self.keyBlockingKeyLockLossy.acquire()
        self.keyBlockingKeyLossy = None
        self.keyBlockingEventLossy.set()
        self.keyBlockingKeyLockLossy.release()

        self.keysBlockingGotLock.acquire()
        self.keyBlockingGotEvent.set()
        self.keysBlockingGotLock.release()

        self.stoppedLock.release() 
```

这个想法是您可以简单地调用`keyPress.getKey()`，它将从键盘读取一个键，然后返回它。

如果你想要更多的东西，我做了一个`KeyCapture`对象。您可以通过类似`keys = keyPress.KeyCapture()`.

然后你可以做三件事：

`addEvent(functionName)`接受任何接受一个参数的函数。然后每次按下一个键时，都会调用这个函数，并在输入时使用该键的字符串。这些在单独的线程中运行，因此您可以阻止所有您想要的，它不会弄乱 KeyCapturer 的功能，也不会延迟其他事件。

`get()`以与以前相同的阻塞方式返回一个键。现在在这里需要它，因为现在正在通过`KeyCapture`对象捕获键，因此`keyPress.getKey()`会与该行为发生冲突，并且它们都会丢失一些键，因为一次只能捕获一个键。另外，假设用户按'a'，然后按'b'，你打电话`get()`，用户按'c'。该`get()`调用将立即返回'a'，然后如果再次调用它，它将返回'b'，然后是'c'。如果再次调用它，它将阻塞，直到按下另一个键。这样可以确保您不会错过任何键，如果需要，可以采用阻塞方式。`keyPress.getKey()`所以这种方式和以前有点不同

如果你想要`getKey()`back 的行为，`get(lossy=True)`就像`get()`，除了它只返回调用*后*`get()`按下的键。所以在上面的例子中，`get()`会阻塞直到用户按下'c'，然后如果你再次调用它，它将阻塞直到按下另一个键。

`getAsync()`有点不同。它是为进行大量处理而设计的，然后偶尔会返回并检查按下了哪些键。因此`getAsync()`返回自上次调用以来按下的所有键的列表，`getAsync()`从最旧的键按下到最近按下的键。它也不会阻塞，这意味着如果自上次调用以来没有按下任何键，则将返回`getAsync()`一个空 值。`[]`

要真正开始捕获键，您需要使用上面创建`keys.startCapture()`的`keys`对象进行调用。`startCapture`是非阻塞的，只需启动一个只记录按键的线程，另一个线程来处理这些按键。有两个线程来确保记录按键的线程不会错过任何键。

如果您想停止捕获密钥，您可以调用`keys.stopCapture()`它会停止捕获密钥。但是，由于捕获键是一种阻塞操作，因此捕获键的线程可能会在调用之后再捕获一个键`stopCapture()`。

为了防止这种情况，您可以将一个可选参数传递给`startCapture(functionName, args)`一个函数，该函数只执行检查键是否等于“c”然后退出之类的操作。重要的是这个函数之前做的很少，例如，这里的睡眠会导致我们错过按键。

但是，如果`stopCapture()`在此函数中调用，键捕获将立即停止，不再尝试捕获，并且所有`get()`调用将立即返回，如果尚未按下任何键，则返回 None。

此外，由于`get()`并`getAsync()`存储所有先前按下的键（直到您检索它们），您可以调用`clearGetList()`并`clearAsyncList()`忘记先前按下的键。

注意`get()`,`getAsync()`和 事件是独立的，所以如果按下一个键：

1.  一个正在等待的呼叫`get()`，有损打开，将返回该密钥。其他等待呼叫（如果有）将继续等待。
2.  该键将存储在获取键的队列中，因此`get()`有损关闭将返回尚未返回的最旧的键`get()`。
3.  所有事件都将使用该键作为输入触发
4.  该键将存储在`getAsync()`键列表中，该列表将被返回并在下一次调用时设置为空列表`getAsync()`

如果这一切都太多了，这里有一个示例用例：

```
import keyPress
import time
import threading

def KeyPressed(k, printLock):
    printLock.acquire()
    print "Event: " + k
    printLock.release()
    time.sleep(4)
    printLock.acquire()
    print "Event after delay: " + k
    printLock.release()

def GetKeyBlocking(keys, printLock):    
    while keys.capturing():
        keyReceived = keys.get()
        time.sleep(1)
        printLock.acquire()
        if not keyReceived is None:
            print "Block " + keyReceived
        else:
            print "Block None"
        printLock.release()

def GetKeyBlockingLossy(keys, printLock):   
    while keys.capturing():
        keyReceived = keys.get(lossy=True)
        time.sleep(1)
        printLock.acquire()
        if not keyReceived is None:
            print "Lossy: " + keyReceived
        else:
            print "Lossy: None"
        printLock.release()

def CheckToClose(k, (keys, printLock)):
    printLock.acquire()
    print "Close: " + k
    printLock.release()
    if k == "c":
        keys.stopCapture()

printLock = threading.Lock()

print "Press a key:"
print "You pressed: " + keyPress.getKey()
print ""

keys = keyPress.KeyCapture()

keys.addEvent(KeyPressed, printLock)

print "Starting capture"

keys.startCapture(CheckToClose, (keys, printLock))

getKeyBlockingThread = threading.Thread(target=GetKeyBlocking, args=(keys, printLock))
getKeyBlockingThread.daemon = True
getKeyBlockingThread.start()

getKeyBlockingThreadLossy = threading.Thread(target=GetKeyBlockingLossy, args=(keys, printLock))
getKeyBlockingThreadLossy.daemon = True
getKeyBlockingThreadLossy.start()

while keys.capturing():
    keysPressed = keys.getAsync()
    printLock.acquire()
    if keysPressed != []:
        print "Async: " + str(keysPressed)
    printLock.release()
    time.sleep(1)

print "done capturing" 
```

从我所做的简单测试来看，它对我来说效果很好，但如果我错过了一些东西，我也会很乐意接受其他人的反馈。

我[也在这里](https://stackoverflow.com/a/31736883/2924421)发布了这个。

* * *

## 回答 #10

> 赞同：5
> 
> 时间：2014-09-28T20:07:19.743

这可能是上下文管理器的一个用例。抛开 Windows 操作系统的津贴，这是我的建议：

```
#!/usr/bin/env python3
# file: 'readchar.py'
"""
Implementation of a way to get a single character of input
without waiting for the user to hit <Enter>.
(OS is Linux, Ubuntu 14.04)
"""

import tty, sys, termios

class ReadChar():
    def __enter__(self):
        self.fd = sys.stdin.fileno()
        self.old_settings = termios.tcgetattr(self.fd)
        tty.setraw(sys.stdin.fileno())
        return sys.stdin.read(1)
    def __exit__(self, type, value, traceback):
        termios.tcsetattr(self.fd, termios.TCSADRAIN, self.old_settings)

def test():
    while True:
        with ReadChar() as rc:
            char = rc
        if ord(char) <= 32:
            print("You entered character with ordinal {}."\
                        .format(ord(char)))
        else:
            print("You entered character '{}'."\
                        .format(char))
        if char in "^C^D":
            sys.exit()

if __name__ == "__main__":
    test() 
```

* * *

## 回答 #11

> 赞同：5
> 
> 时间：2018-09-23T00:07:19.833

如果我正在做一些复杂的事情，我会使用 curses 来读取密钥。但是很多时候我只想要一个简单的 Python 3 脚本，它使用标准库并且可以读取箭头键，所以我这样做：

```
import sys, termios, tty

key_Enter = 13
key_Esc = 27
key_Up = '\033[A'
key_Dn = '\033[B'
key_Rt = '\033[C'
key_Lt = '\033[D'

fdInput = sys.stdin.fileno()
termAttr = termios.tcgetattr(0)

def getch():
    tty.setraw(fdInput)
    ch = sys.stdin.buffer.raw.read(4).decode(sys.stdin.encoding)
    if len(ch) == 1:
        if ord(ch) < 32 or ord(ch) > 126:
            ch = ord(ch)
    elif ord(ch[0]) == 27:
        ch = '\033' + ch[1:]
    termios.tcsetattr(fdInput, termios.TCSADRAIN, termAttr)
    return ch 
```

* * *

## 回答 #12

> 赞同：4
> 
> 时间：2014-06-22T20:40:36.597

这是非阻塞的，读取一个键并将其存储在 keypress.key 中。

```
import Tkinter as tk

class Keypress:
    def __init__(self):
        self.root = tk.Tk()
        self.root.geometry('300x200')
        self.root.bind('<KeyPress>', self.onKeyPress)

    def onKeyPress(self, event):
        self.key = event.char

    def __eq__(self, other):
        return self.key == other

    def __str__(self):
        return self.key 
```

在你的程序中

```
keypress = Keypress()

while something:
   do something
   if keypress == 'c':
        break
   elif keypress == 'i': 
       print('info')
   else:
       print("i dont understand %s" % keypress) 
```

* * *

## 回答 #13

> 赞同：4
> 
> 时间：2018-01-07T10:09:21.063

ActiveState 的配方似乎包含一个防止`Ctrl-C`中断的“posix”系统的小错误（我使用的是 Mac）。如果我将以下代码放入我的脚本中：

```
while(True):
    print(getch()) 
```

我将永远无法用 终止脚本`Ctrl-C`，我必须杀死我的终端才能逃脱。

我相信下面这行是原因，也太残酷了：

```
tty.setraw(sys.stdin.fileno()) 
```

除此之外，包装`tty`并不是真正需要的，`termios`足以处理它。

以下是适用于我的改进代码（`Ctrl-C`将中断），具有在您键入时回显字符的额外`getche`功能：

```
if sys.platform == 'win32':
    import msvcrt
    getch = msvcrt.getch
    getche = msvcrt.getche
else:
    import sys
    import termios
    def __gen_ch_getter(echo):
        def __fun():
            fd = sys.stdin.fileno()
            oldattr = termios.tcgetattr(fd)
            newattr = oldattr[:]
            try:
                if echo:
                    # disable ctrl character printing, otherwise, backspace will be printed as "^?"
                    lflag = ~(termios.ICANON | termios.ECHOCTL)
                else:
                    lflag = ~(termios.ICANON | termios.ECHO)
                newattr[3] &= lflag
                termios.tcsetattr(fd, termios.TCSADRAIN, newattr)
                ch = sys.stdin.read(1)
                if echo and ord(ch) == 127: # backspace
                    # emulate backspace erasing
                    # https://stackoverflow.com/a/47962872/404271
                    sys.stdout.write('\b \b')
            finally:
                termios.tcsetattr(fd, termios.TCSADRAIN, oldattr)
            return ch
        return __fun
    getch = __gen_ch_getter(False)
    getche = __gen_ch_getter(True) 
```

参考：

*   [https://pypi.python.org/pypi/getch](https://pypi.python.org/pypi/getch)

* * *

## 回答 #14

> 赞同：3
> 
> 时间：2015-02-21T00:36:21.317

用 pygame 试试这个：

```
import pygame
pygame.init()             // eliminate error, pygame.error: video system not initialized
keys = pygame.key.get_pressed()

if keys[pygame.K_SPACE]:
    d = "space key"

print "You pressed the", d, "." 
```

* * *

## 回答 #15

> 赞同：3
> 
> 时间：2017-07-23T15:17:19.160

其他答案之一中的评论提到了 cbreak 模式，这对于 Unix 实现很重要，因为您通常不希望 ^C ( `KeyboardError`) 被 getchar 使用（就像当您将终端设置为原始模式时一样，通过大多数其他答案）。

另一个重要的细节是，如果你想读取一个*字符*而不是一个*字节*，你应该从输入流中读取 4 个字节，因为这是 UTF-8 中单个字符包含的最大字节数（Python 3+ ）。对于多字节字符（如键盘箭头），只读取一个字节会产生意想不到的结果。

这是我为 Unix 更改的实现：

```
import contextlib
import os
import sys
import termios
import tty

_MAX_CHARACTER_BYTE_LENGTH = 4

@contextlib.contextmanager
def _tty_reset(file_descriptor):
    """
    A context manager that saves the tty flags of a file descriptor upon
    entering and restores them upon exiting.
    """
    old_settings = termios.tcgetattr(file_descriptor)
    try:
        yield
    finally:
        termios.tcsetattr(file_descriptor, termios.TCSADRAIN, old_settings)

def get_character(file=sys.stdin):
    """
    Read a single character from the given input stream (defaults to sys.stdin).
    """
    file_descriptor = file.fileno()
    with _tty_reset(file_descriptor):
        tty.setcbreak(file_descriptor)
        return os.read(file_descriptor, _MAX_CHARACTER_BYTE_LENGTH) 
```

* * *

## 回答 #16

> 赞同：3
> 
> 时间：2021-08-17T16:07:30.800

您可以使用[click](https://click.palletsprojects.com/en/8.0.x/utils/#getting-characters-from-terminal)。它经过充分测试，可在 Linux、Mac 和 Windows 上运行。

```
import click

print('Continue? [yn] ')
c = click.getchar()   # Gets a single character

if c == 'y':
    print('We will go on')
elif c == 'n':
    print('Abort!')
else:
    print('Invalid input :(') 
```

* * *

## 回答 #17

> 赞同：2
> 
> 时间：2014-12-29T17:38:01.803

python中的`curses`包可用于从终端输入“原始”模式，只需几条语句。Curses的主要用途是接管屏幕进行输出，这可能不是你想要的。此代码片段使用`print()`了可用的语句，但您必须了解 curses 如何更改附加到输出的行尾。

```
#!/usr/bin/python3
# Demo of single char terminal input in raw mode with the curses package.
import sys, curses

def run_one_char(dummy):
    'Run until a carriage return is entered'
    char = ' '
    print('Welcome to curses', flush=True)
    while ord(char) != 13:
        char = one_char()

def one_char():
    'Read one character from the keyboard'
    print('\r? ', flush= True, end = '')

    ## A blocking single char read in raw mode. 
    char = sys.stdin.read(1)
    print('You entered %s\r' % char)
    return char

## Must init curses before calling any functions
curses.initscr()
## To make sure the terminal returns to its initial settings,
## and to set raw mode and guarantee cleanup on exit. 
curses.wrapper(run_one_char)
print('Curses be gone!') 
```

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2017-11-29T09:14:25.800

我相信这是最优雅的解决方案之一。

```
import os

if os.name == 'nt':
    import msvcrt
    def getch():
        return msvcrt.getch().decode()
else:
    import sys, tty, termios
    fd = sys.stdin.fileno()
    old_settings = termios.tcgetattr(fd)
    def getch():
        try:
            tty.setraw(sys.stdin.fileno())
            ch = sys.stdin.read(1)
        finally:
            termios.tcsetattr(fd, termios.TCSADRAIN, old_settings)
        return ch 
```

然后在代码中使用它：

```
if getch() == chr(ESC_ASCII_VALUE):
    print("ESC!") 
```

* * *

## 回答 #19

> 赞同：1
> 
> 时间：2021-10-28T07:44:56.660

最简单的跨平台解决方案是[sshkeyboard](https://github.com/ollipal/sshkeyboard)。安装`pip install sshkeyboard`，

然后编写脚本，例如：

```
from sshkeyboard import listen_keyboard

def press(key):
    print(f"'{key}' pressed")

def release(key):
    print(f"'{key}' released")

listen_keyboard(
    on_press=press,
    on_release=release,
) 
```

它会打印：

```
'a' pressed
'a' released 
```

When `A` key is pressed. `ESC` key ends the listening by default.

It requires less coding than for example curses, tkinter and getch.

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2016-01-28T01:24:52.527

我对 python3 的解决方案，不依赖于任何 pip 包。

```
# precondition: import tty, sys
def query_yes_no(question, default=True):
    """
    Ask the user a yes/no question.
    Returns immediately upon reading one-char answer.
    Accepts multiple language characters for yes/no.
    """
    if not sys.stdin.isatty():
        return default
    if default:
        prompt = "[Y/n]?"
        other_answers = "n"
    else:
        prompt = "[y/N]?"
        other_answers = "yjosiá"

    print(question,prompt,flush= True,end=" ")
    oldttysettings = tty.tcgetattr(sys.stdin.fileno())
    try:
        tty.setraw(sys.stdin.fileno())
        return not sys.stdin.read(1).lower() in other_answers
    except:
        return default
    finally:
        tty.tcsetattr(sys.stdin.fileno(), tty.TCSADRAIN , oldttysettings)
        sys.stdout.write("\r\n")
        tty.tcdrain(sys.stdin.fileno()) 
```

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2019-07-22T00:17:24.290

接受的答案对我来说表现不佳（我会按住一个键，什么都不会发生，然后我会按另一个键，它会起作用）。

在了解了*curses*模块之后，这似乎是正确的方法。现在可以通过[windows-cursors](https://pypi.org/project/windows-curses/)（通过 pip 获得）在 Windows 上使用它，因此您可以以与平台无关的方式进行编程。这是一个受YouTube 上这个[不错的教程](https://www.youtube.com/watch?v=zwMsmBsC1GM)启发的示例：

```
import curses                                                                                                                                       
def getkey(stdscr):
    curses.curs_set(0)
    while True:
        key = stdscr.getch()
        if key != -1:
            break
    return key

if __name__ == "__main__":
    print(curses.wrapper(getkey)) 
```

`.py`使用扩展名保存它，或`curses.wrapper(getkey)`以交互模式运行。

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2019-09-01T07:38:25.770

在这里回答：[python中的raw_input而不按回车](https://stackoverflow.com/questions/3523174/raw-input-in-python-without-pressing-enter/57503192#57503192)

使用此代码-

```
from tkinter import Tk, Frame

def __set_key(e, root):
    """
    e - event with attribute 'char', the released key
    """
    global key_pressed
    if e.char:
        key_pressed = e.char
        root.destroy()

def get_key(msg="Press any key ...", time_to_sleep=3):
    """
    msg - set to empty string if you don't want to print anything
    time_to_sleep - default 3 seconds
    """
    global key_pressed
    if msg:
        print(msg)
    key_pressed = None
    root = Tk()
    root.overrideredirect(True)
    frame = Frame(root, width=0, height=0)
    frame.bind("<KeyRelease>", lambda f: __set_key(f, root))
    frame.pack()
    root.focus_set()
    frame.focus_set()
    frame.focus_force()  # doesn't work in a while loop without it
    root.after(time_to_sleep * 1000, func=root.destroy)
    root.mainloop()
    root = None  # just in case
    return key_pressed

def __main():
        c = None
        while not c:
                c = get_key("Choose your weapon ... ", 2)
        print(c)

if __name__ == "__main__":
    __main() 
```

参考：[https ://github.com/unfor19/mg-tools/blob/master/mgtools/get_key_pressed.py](https://github.com/unfor19/mg-tools/blob/master/mgtools/get_key_pressed.py)

* * *

## 回答 #23

> 赞同：0
> 
> 时间：2019-10-07T11:39:57.957

如果您只想注册一个按键，即使用户按下它不止一次或按住按键的时间更长。为避免获得多个按下的输入，请使用 while 循环并传递它。

```
import keyboard

while(True):
  if(keyboard.is_pressed('w')):
      s+=1
      while(keyboard.is_pressed('w')):
        pass
  if(keyboard.is_pressed('s')):
      s-=1
      while(keyboard.is_pressed('s')):
        pass
  print(s) 
```

* * *

## 回答 #24

> 赞同：-2
> 
> 时间：2015-12-15T20:51:36.410

内置 raw_input 应该会有所帮助。

```
for i in range(3):
    print ("So much work to do!")
k = raw_input("Press any key to continue...")
print ("Ok, back to work.") 
```

* * *

## 回答 #25

> 赞同：-2
> 
> 时间：2020-01-01T17:42:02.083

如果您只想按住屏幕以便在终端上看到结果，只需编写

```
input() 
```

在代码的末尾，它将保持屏幕

# web-analytics - 网络分析工具如何工作？

> ID：510361
> 
> 赞同：4
> 
> 时间：2009-02-04T07:09:16.967
> 
> 标签：web-analytics, web-analytics-tools

我正在为我的下一个任务收集有关网络分析工具（如谷歌网络分析）的信息，但我找不到任何好的信息。我在寻找：

1.  使用的关键术语。
2.  哪些媒介可用于数据收集以及它们是如何工作的。
3.  任何参考书、白皮书等（技术和非技术）。
4.  任何开源实现（尤其是在 .NET 中）。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-04T07:25:14.173

以下是使用的**关键术语**：

*   命中（互联网）
*   页面预览
*   参观/会议
*   第一次访问/第一次会议
*   访客/唯一访客/唯一用户
*   重复访客
*   新访客
*   印象
*   单身人士
*   跳出率
*   ％ 出口
*   可见时间
*   会话持续时间
*   页面浏览时长/页面停留时间
*   每个会话的页面深度/页面浏览量
*   每个唯一身份的频率/会话
*   点击路径

**使用方法**：

*   Web 服务器日志文件分析
*   页面标记

**Web 服务器日志文件分析**

在这种方法中，您编写脚本以从日志文件中刮取详细信息，然后将其写入数据库。此方法不会为您提供实时统计信息。[您可以在此处](http://en.wikipedia.org/wiki/Web_log_analysis_software)阅读有关网络日志分析软件的更多信息。

**页面标记**

添加 javascript 代码或仅添加图像，然后使用该代码获取有关页面、referrr、访问者等的所有详细信息。

> ...这些是包含在网页中的图像，显​​示了图像被请求的次数，这是对该页面访问次数的估计。在 1990 年代后期，这一概念演变为包括一个小的不可见图像而不是可见图像，并且通过使用 JavaScript，与图像请求一起传递有关页面和访问者的某些信息。然后，这些信息可以由网络分析公司远程处理，并生成大量统计数据......

如果您在自己的网站中使用分析，则可以使用[Eytan Levit 提供的代码](https://stackoverflow.com/questions/510361/how-do-the-web-analytics-tools-work/510401#510401)

信用[维基百科](http://en.wikipedia.org/wiki/Web_analytics)。可以在那里找到更多信息。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-04T07:30:20.420

好，

我不是专家，但您可以检索以下一些常见数据来构建您自己的分析：

```
string str;
str += "Refferer:" + Request.UrlReferrer.AbsolutePath.ToString() + "<BR>";
str += "Form data:" + Request.Form.ToString() + "<br>";
str += "User Agent:" + Request.ServerVariables["HTTP_USER_AGENT"] + "<br>";
str += "IP Address:" + Request.UserHostAddress.ToString() + "<BR>";
str += "Browser:" + Request.Browser.Browser + " Version: " + Request.Browser.Version + " Platform: " + Request.Browser.Platform + "<BR>";
str += "Is Crawler: " + Request.Browser.Crawler.ToString() + "<BR>";
str += "QueryString" + Request.QueryString.ToString() + "<BR>"; 
```

您还可以解析用户访问您网站的关键字，如下所示：

```
protected string GetKeywordFromReferrer(string url)
{
    if (url.Trim() == "")
    {
        return "no url";
    }
    string urlEscaped = Uri.UnescapeDataString(url).Replace('+', ' ');
    string terms = "";
    string site = "";

    Match searchQuery = Regex.Match(urlEscaped, @"[\&\?][qp]\=([^\&]*)");
    if (searchQuery.Success)
    {
        terms = searchQuery.Groups[1].Value;
    }
    else
    {
        Match siteDomain = Regex.Match(urlEscaped, @"http\:\/\/(.+?)\/");
        if (siteDomain.Success)
        {
            site = siteDomain.Groups[1].Value;
        }
    }
    if (terms != "")
    {
        return terms;
    }
    if (site != "")
    {
        return site;
    }

    return "Direct Access";

} 
```

希望这有所帮助。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-11T22:45:33.017

**1\. 使用的关键术语**
与答案 1相同

**2\. 哪些媒介可用于数据收集以及它们是如何工作的。**
来自 Apache、IIS 的日志文件。ASP.NET 或您的实际页面的 HTTP 处理程序。Javascript 包括（Javascript 可用的对象为您提供有关客户端所需的大部分信息）

**3\. 任何参考书、白皮书等（技术和非技术）**
HTTP 上的 RFC 很有用，它为您提供了大部分可捕获的请求标头。

**4.任何开源实现（尤其是.NET）。**

我写了一个已经完成分析的解析部分（在我看来是最难的部分）。由于它已有 4 年历史，因此需要在某些领域进行一些调整：

*   [Statmagic](http://www.codeplex.com/Statmagic)（用于日志文件）

它缺少 DAL，这比听起来更难 - 主要障碍是确保您不会复制日志每一行所具有的确切数据，因为您也可以只使用日志文件。另一部分是以一种很好的格式显示这些聚合数据。我的目标是将它存储在 SQL Server 和 db4o 格式中以适应较小的网站。

Statmagic 项目的“可悲”部分是 Google 出现并彻底消灭了竞争对手以及我完成它的任何一点。

# ios - 如何在 iOS 上生成随机数？

> ID：510367
> 
> 赞同：22
> 
> 时间：2009-02-04T07:12:12.593
> 
> 标签：ios, objective-c, random

在 iOS 上使用 Objective-C 生成随机数的最佳方法是什么？
如果我`(int)((double) rand() / ((double)(RAND_MAX) + (double) 1) * 5.0)`用来生成一个从 0 到 4 的数字，那么每次我在 iPhone 上启动该程序时，它都会生成相同的数字。

* * *

## 回答 #1

> 赞同：71
> 
> 时间：2009-02-04T07:29:41.187

[StackOverFlow 上](https://stackoverflow.com/questions/160890/generating-random-numbers-in-objective-c)有一个非常相似的问题。这是更好的解决方案之一（无需播种）：

```
int r = arc4random() % 5; 
```

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2009-02-04T16:44:35.823

我用

```
#define RANDOM_SEED() srandom(time(NULL))
#define RANDOM_INT(__MIN__, __MAX__) ((__MIN__) + random() % ((__MAX__+1) - (__MIN__))) 
```

所以你可以给出一个最小值和最大值

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2009-02-04T07:16:12.913

您应该使用当前时间播种随机数生成器。

```
srand(time(0)); 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-02-04T07:18:17.417

你需要多随机？如果你想要足够随机的加密，那么使用 SecRandomCopyBytes()。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-02-04T07:16:05.207

在程序开始时调用`srand()`，它将重新生成随机数生成器

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2012-09-11T08:10:53.573

随机数生成的简单函数：

```
int r = arc4random() % 42;  // generate number up to 42 (limit) 
```

# windows - 如何在 Windows 中监视进程/程序执行？

> ID：510372
> 
> 赞同：10
> 
> 时间：2009-02-04T07:15:16.783
> 
> 标签：windows, events, process, executable

我们正在尝试开发一个小型应用程序，可以监视在 Windows 机器中执行的程序/进程。

如果程序/进程不应该运行，它应该被阻止。它的工作原理类似于防病毒软件。

这是基本思想。

我想知道如何连接到操作系统以获取有关试图在机器中运行的每个程序/进程的通知。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-02-15T04:04:43.267

最简单的方法是使用 WMI。专门监视 Win32_ProcessStartTrace。这比 Win32_Process 更好，因为它设置为使用事件，而 Win32_Process 需要轮询，这更占用 CPU。下面是如何在 C# 中执行此操作。首先确保将 System.Management 设置为项目的参考。

```
 public System.Management.ManagementEventWatcher mgmtWtch;

    public Form1()
    {
        InitializeComponent();
        mgmtWtch = new System.Management.ManagementEventWatcher("Select * From Win32_ProcessStartTrace");
        mgmtWtch.EventArrived += new System.Management.EventArrivedEventHandler(mgmtWtch_EventArrived);
        mgmtWtch.Start();
    }

    void mgmtWtch_EventArrived(object sender, System.Management.EventArrivedEventArgs e)
    {
        MessageBox.Show((string)e.NewEvent["ProcessName"]);
    }

    private void Form1_FormClosing(object sender, FormClosingEventArgs e)
    {
        mgmtWtch.Stop();
    } 
```

每次启动新进程时，代码都会生成一个消息框。从那里您可以检查白名单/黑名单并采取适当的行动。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-04T07:51:39.393

我还没有尝试获得实时通知。然而，这里是如何在 C# 中运行进程

```
using System.Diagnostics;

 //Somewhere in your method

Process[] runningList = Process.GetProcesses();

foreach(Process p in runningList){
Console.WriteLine("Process: {0} ID: {1}", p.ProcessName, p.Id);
} 
```

您还可以使用进程的以下道具

*   StartTime - 显示进程开始的时间
*   TotalProcessorTime - 显示进程占用的 CPU 时间量
*   线程 - 允许访问进程中的线程集合

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-04T08:30:32.280

我会使用常量 WH_GETMESSAGE 检查 Win32-api **SetWindowsHookEx**，以便在创建新窗口时向您的程序添加回调。

[http://pinvoke.net/default.aspx/user32.SetWindowsHookEx](http://pinvoke.net/default.aspx/user32.SetWindowsHookEx)

谷歌该 API 和 WH_GETMESSAGE 以了解更多信息。

另请查看以下文章/代码库： [http ://www.vbaccelerator.com/home/Vb/Code/Libraries/Hooks/vbAccelerator_Hook_Library/article.asp](http://www.vbaccelerator.com/home/Vb/Code/Libraries/Hooks/vbAccelerator_Hook_Library/article.asp)

[http://www.codeproject.com/KB/DLL/hooks.aspx?fid=2061&df=90&mpp=25&noise=3&sort=Position&view=Quick&fr=76&select=726975](http://www.codeproject.com/KB/DLL/hooks.aspx?fid=2061&df=90&mpp=25&noise=3&sort=Position&view=Quick&fr=76&select=726975)

# mysql - 如何将 lucene 索引存储在数据库中？

> ID：510373
> 
> 赞同：3
> 
> 时间：2009-02-04T07:16:02.413
> 
> 标签：mysql, lucene, compass-lucene

这是我的示例代码：

```
MysqlDataSource dataSource = new MysqlDataSource();

dataSource.setUser("root");
dataSource.setPassword("ncl");
dataSource.setDatabaseName("userdb");
dataSource.setEmulateLocators(true); //This is important because we are dealing with a blob type data field
try{    
    JdbcDirectory jdbcDir = new JdbcDirectory(dataSource, new MySQLDialect(), "tttable");
    StandardAnalyzer analyzer = new StandardAnalyzer();
    IndexWriter writer = new IndexWriter(jdbcDir, analyzer,false);
    writer.optimize();
    writer.close();
}catch(Exception e){
System.out.print(e);
} 
```

我被困在这条线上：`IndexWriter writer = new IndexWriter(jdbcDir, analyzer,false);`

每次我尝试运行此代码时，都会收到以下异常：

> ------“org.apache.lucene.store.LockObtainFailedException：锁获取超时：PhantomReadLock[write.lock/tttable]”------------

我找不到代码有什么问题。可能是jar兼容性问题。

我无法获得 IndexWriter 对象。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-04T11:06:20.857

好像索引被锁定了。如果您确定它不应该被锁定，那么可能某些进程在没有适当清理的情况下崩溃了。

尝试添加行

```
jdbcDir.clearLock(); 
```

在创建 indexWriter 之前。

不要把它留在那里，强硬。您通常希望让 Lucene 管理锁，以禁止两个 IndexWriter 写入同一个索引。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-01-19T09:21:16.770

您应该先创建表。

尝试使用这样的代码：

```
if (!dir.tableExists())
    {
        dir.create();
    } 
```

锁是由 IndexWriter 生成的。如果有问题，锁不会被释放，所以你需要在创建新写入器之前释放所有锁（IndexWriter类有静态方法）

```
IndexWriter.unlock(dir); 
```

# visual-studio-2008 - Visual Studio 2008 停止调试 平滑退出

> ID：510376
> 
> 赞同：2
> 
> 时间：2009-02-04T07:16:15.673
> 
> 标签：visual-studio-2008, debugging

我们使用 Visual Studio 2008 进行 C# 应用程序开发。

当我们的应用程序启动时，我们启动三个进程，当我们关闭应用程序时，我们关闭启动的进程。

但通常在调试过程中，我们倾向于通过 Shift-F5 关闭调试器，这会立即停止应用程序。所以我们需要手动关闭应用程序启动的进程。

关闭应用程序的最佳方法是什么，这样我们就不会在调试停止期间关闭应用程序而感到沮丧。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-04T07:24:49.277

启动的应用程序是您自己的应用程序吗？如果是这样，他们能否检测到他们的父进程何时死亡，并在这种情况下终止自己？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-04T12:06:16.120

您如何正常关闭进程？

如果你可以制作一个批处理文件、一个单独的应用程序甚至是一个 AutoHotKey 脚本来关闭进程，那么你可以在 VS 工具栏（工具->外部工具）上放置一个快捷方式。

我知道这比自动完成更笨拙，但它可能比你现在必须做的更好：D

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-05T23:00:49.463

使用*多个启动进程*来启动调试器下的所有三个进程。然后，当您停止调试时，它也会杀死所有三个。

可能现在其中一个进程启动了另外两个进程，您可能必须对其进行修改，以便可以将其关闭以进行调试（例如，通过命令行开关）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-21T15:40:14.550

我有同样的问题，所以我写了一个宏来做到这一点：

```
Sub StopDebugAndKillProcesses()
    Dim dbg As EnvDTE80.Debugger2 = DTE.Debugger
    dbg.Stop()
    Dim shell_string As String
    shell_string = "taskkill /F /IM TheProcessToKill.exe"
    Shell(shell_string)
End Sub 
```

将它分配给一个按钮，把它放在原来的“停止”按钮旁边，你就完成了。

# asp.net - .NET 3.5 GridView - 使用 Control 键选择多行

> ID：510378
> 
> 赞同：0
> 
> 时间：2009-02-04T07:16:36.313
> 
> 标签：asp.net, .net-3.5, gridview

我正在开发一个 .NET 3.5 Web 应用程序，并且正在使用 GridView。

当用户按下控制键并单击行时，我想选择多行。

如果在不按控制键的情况下点击我只想做单行选择。

如何检查用户是否在 javascript 中按下了 Control 键并突出显示所有选定的行？

谢谢

阿肖克

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-04T11:49:53.517

I hope this can provide you some help defintely.
You can capture the onkeypress and onkeyup event of each row in GridView something like this:

```
var isCtrl = false;

$('.GridViewRow').keyup(function (e) {<br/>
if(e.which == 17) isCtrl=false;<br/>
}).keydown(function (e) {<br/>
if(e.which == 17) isCtrl=true;<br/>
}<br/>
});<br/> 
```

It will match all the rows whose class is "GridViewRow". So you need to specify this class to your GridView rows.
Next, toggle the background color of clicked row on its onclick event.

```
$('.GridViewRow').onclick(function (e) {
      // your row on click code goes here
}); 
```

Here, I have used theJQuery and you also need to include a script reference of Jquery like this:

```
<script language="JavaScript" src="JQuery.js"></script> 
```

# ios - 如何在 iPhone 上创建圆角 UILabel？

> ID：510382
> 
> 赞同：150
> 
> 时间：2009-02-04T07:19:49.117
> 
> 标签：ios, objective-c, cocoa-touch, uilabel, rounded-corners

是否有创建圆角 UILabel 的内置方法？如果答案是否定的，人们将如何创建这样一个对象？

* * *

## 回答 #1

> 赞同：233
> 
> 时间：2009-02-04T09:22:10.553

## iOS 3.0 及更高版本

iPhone OS 3.0 及更高版本支持该类的`cornerRadius`属性`CALayer`。每个视图都有一个`CALayer`可以操作的实例。这意味着您可以在一行中获得圆角：

```
view.layer.cornerRadius = 8; 
```

您需要`#import <QuartzCore/QuartzCore.h>`链接到 QuartzCore 框架才能访问 CALayer 的标头和属性。

## iOS 3.0 之前

我最近使用的一种方法是创建一个 UIView 子类，它简单地绘制一个圆角矩形，然后在其中创建 UILabel 或在我的情况下为 UITextView 的子视图。具体来说：

1.  创建一个`UIView`子类并将其命名为`RoundRectView`.
2.  在`RoundRectView`'s`drawRect:`方法中，使用核心图形调用（如边缘的 CGContextAddLineToPoint() 和圆角的 CGContextAddArcToPoint() ）围绕视图边界绘制路径。
3.  创建一个`UILabel`实例并使其成为 RoundRectView 的子视图。
4.  将标签的框架设置为 RoundRectView 边界的几个像素。（例如，`label.frame = CGRectInset(roundRectView.bounds, 8, 8);`）

如果您创建通用 UIView 然后使用检查器更改其类，则可以使用 Interface Builder 将 RoundRectView 放置在视图上。在编译并运行应用程序之前，您不会看到矩形，但至少您可以放置​​子视图并将其连接到出口或操作（如果需要）。

* * *

## 回答 #2

> 赞同：145
> 
> 时间：2014-04-04T07:54:08.130

对于 iOS 7.1 或更高版本的设备，您需要添加：

```
yourUILabel.layer.masksToBounds = YES;
yourUILabel.layer.cornerRadius = 8.0; 
```

* * *

## 回答 #3

> 赞同：23
> 
> 时间：2015-08-17T16:08:23.050

对于基于 OScarsWyck 答案的 Swift IOS8 及更高版本：

```
yourUILabel.layer.masksToBounds = true
yourUILabel.layer.cornerRadius = 8.0 
```

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2012-12-04T10:08:52.497

1.  你有一个`UILabel`叫：`myLabel`。
2.  在您的“m”或“h”文件导入中：`#import <QuartzCore/QuartzCore.h>`
3.  在你`viewDidLoad`写这一行：`self.myLabel.layer.cornerRadius = 8;`

    *   取决于您希望如何将cornerRadius 值从 8 更改为其他数字:)

祝你好运

* * *

## 回答 #5

> 赞同：11
> 
> 时间：2014-02-13T08:09:36.323

您可以通过以下方式制作具有任何控件边框宽度的圆角边框：-

```
CALayer * l1 = [lblName layer];
[l1 setMasksToBounds:YES];
[l1 setCornerRadius:5.0];

// You can even add a border
[l1 setBorderWidth:5.0];
[l1 setBorderColor:[[UIColor darkGrayColor] CGColor]]; 
```

只需替换`lblName`为您的`UILabel`.

**注意：-**不要忘记导入`<QuartzCore/QuartzCore.h>`

* * *

## 回答 #6

> 赞同：9
> 
> 时间：2016-03-30T14:16:52.173

我做了一个快速的`UILabel`子类来实现这个效果。此外，我自动将文本颜色设置为黑色或白色，以获得最大对比度。

### 结果

[![颜色圆形边框](https://i.stack.imgur.com/gTOTb.png)](https://i.stack.imgur.com/gTOTb.png)

使用过的SO帖子：

*   [如何在 UILabel 周围绘制边框？](https://stackoverflow.com/a/33015915/784318)
*   [在 UIView 之外添加边框](https://stackoverflow.com/a/15184257/784318)
*   [检查 UIColor 是暗还是亮？](https://stackoverflow.com/a/29044899/784318)

### 操场

只需将其粘贴到 iOS Playground 中：

```
//: Playground - noun: a place where people can play

import UIKit

class PillLabel : UILabel{

    @IBInspectable var color = UIColor.lightGrayColor()
    @IBInspectable var cornerRadius: CGFloat = 8
    @IBInspectable var labelText: String = "None"
    @IBInspectable var fontSize: CGFloat = 10.5

    // This has to be balanced with the number of spaces prefixed to the text
    let borderWidth: CGFloat = 3

    init(text: String, color: UIColor = UIColor.lightGrayColor()) {
        super.init(frame: CGRectMake(0, 0, 1, 1))
        labelText = text
        self.color = color
        setup()
    }

    required init?(coder aDecoder: NSCoder) {
        super.init(coder: aDecoder)
        setup()
    }

    func setup(){
        // This has to be balanced with the borderWidth property
        text = "  \(labelText)".uppercaseString

        // Credits to https://stackoverflow.com/a/33015915/784318
        layer.borderWidth = borderWidth
        layer.cornerRadius = cornerRadius
        backgroundColor = color
        layer.borderColor = color.CGColor
        layer.masksToBounds = true
        font = UIFont.boldSystemFontOfSize(fontSize)
        textColor = color.contrastColor
        sizeToFit()

        // Credits to https://stackoverflow.com/a/15184257/784318
        frame = CGRectInset(self.frame, -borderWidth, -borderWidth)
    }
}

extension UIColor {
    // Credits to https://stackoverflow.com/a/29044899/784318
    func isLight() -> Bool{
        var green: CGFloat = 0.0, red: CGFloat = 0.0, blue: CGFloat = 0.0, alpha: CGFloat = 0.0
        self.getRed(&red, green: &green, blue: &blue, alpha: &alpha)
        let brightness = ((red * 299) + (green * 587) + (blue * 114) ) / 1000

        return brightness < 0.5 ? false : true
    }

    var contrastColor: UIColor{
        return self.isLight() ? UIColor.blackColor() : UIColor.whiteColor()
    }
}

var label = PillLabel(text: "yellow", color: .yellowColor())

label = PillLabel(text: "green", color: .greenColor())

label = PillLabel(text: "white", color: .whiteColor())

label = PillLabel(text: "black", color: .blackColor()) 
```

* * *

## 回答 #7

> 赞同：7
> 
> 时间：2016-07-21T11:22:58.730

xCode 7.3.1 iOS 9.3.2

```
 _siteLabel.layer.masksToBounds = true;
  _siteLabel.layer.cornerRadius = 8; 
```

* * *

## 回答 #8

> 赞同：7
> 
> 时间：2017-06-28T10:49:47.687

如果您想通过情节提要对 UI 对象（如 ( `UILabel`, `UIView`, `UIButton`, ) 进行圆角设置，则设置true 并将Key path 设置为 ，type = Number 和 value = 9 （根据您的要求）`UIImageView``clip to bounds``User Defined Runtime Attributes``layer.cornerRadius`

[![将剪辑设置为边界](https://i.stack.imgur.com/4v3Pd.png)](https://i.stack.imgur.com/4v3Pd.png) [![将用户定义的运行时属性设置为](https://i.stack.imgur.com/OnLPd.png)](https://i.stack.imgur.com/OnLPd.png)

* * *

## 回答 #9

> 赞同：6
> 
> 时间：2009-02-04T17:24:23.950

另一种方法是在 UILabel 后面放置一个 png。我有几个标签的视图，这些标签覆盖了一个背景 png，其中包含各个标签的所有艺术品。

* * *

## 回答 #10

> 赞同：6
> 
> 时间：2017-05-29T21:52:03.177

## 斯威夫特 3

如果您想要带有背景颜色的圆形标签，除了大多数其他答案之外，您还需要设置`layer`背景颜色。`view`设置背景颜色时不起作用。

```
label.layer.cornerRadius = 8
label.layer.masksToBounds = true
label.layer.backgroundColor = UIColor.lightGray.cgColor 
```

如果您使用自动布局，想要在标签周围进行一些填充并且不想手动设置标签的大小，您可以创建 UILabel 子类并覆盖`intrinsincContentSize`属性：

```
class LabelWithPadding: UILabel {
    override var intrinsicContentSize: CGSize {
        let defaultSize = super.intrinsicContentSize
        return CGSize(width: defaultSize.width + 12, height: defaultSize.height + 8)
    }
} 
```

要将两者结合起来，您还需要设置`label.textAlignment = center`，否则文本将左对齐。

* * *

## 回答 #11

> 赞同：4
> 
> 时间：2014-05-21T06:44:52.650

```
 UILabel *label = [[UILabel alloc] initWithFrame:CGRectMake(0, 0, 100, 30)];
    label.text = @"Your String.";
    label.layer.cornerRadius = 8.0;
    [self.view addSubview:label]; 
```

* * *

## 回答 #12

> 赞同：4
> 
> 时间：2017-08-15T13:25:06.160

> 在带有 Swift 3 的 Xcode 8.1.2 中运行良好

`.cornerRadius`是设置圆角边缘的关键属性。如果您对应用程序中的所有标签使用相同的样式，我建议您使用扩展方法。

**代码：**

```
 // extension Class
extension UILabel {

    // extension user defined Method
    func setRoundEdge() {
        let myGreenColor = (UIColor(red: -0.108958, green: 0.714926, blue: 0.758113, alpha: 1.0))
        //Width of border
        self.layer.borderWidth = 1.0
        //How much the edge to be rounded
        self.layer.cornerRadius = 5.0

        // following properties are optional
        //color for border
        self.layer.borderColor = myGreenColor.cgColor
        //color for text
        self.textColor = UIColor.red
        // Mask the bound
        self.layer.masksToBounds = true
        //clip the pixel contents
        self.clipsToBounds = true
    }
} 
```

**输出：**

[![在此处输入图像描述](https://i.stack.imgur.com/Q12sq.png)](https://i.stack.imgur.com/Q12sq.png)

**为什么要扩展方法？**

创建一个 Swift 文件并将以下代码添加到“UILabel”类中，该方法具有 Extention 方法，其中此方法是用户定义的，但适用于应用程序中的所有标签，并且有助于保持一致性和干净的代码，如果你将来更改任何样式只需要在扩展方法中。

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2009-03-09T20:45:14.603

您是否尝试使用`UIButton`Interface builder 中的 （具有圆角）并尝试设置以使其看起来像一个标签。如果您只想在其中显示静态文本。

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2016-01-14T14:23:05.480

在 Monotouch / Xamarin.iOS 中，我解决了同样的问题：

```
UILabel exampleLabel = new UILabel(new CGRect(0, 0, 100, 50))
        {
            Text = "Hello Monotouch red label"
        };
        exampleLabel.Layer.MasksToBounds = true;
        exampleLabel.Layer.CornerRadius = 8;
        exampleLabel.Layer.BorderColor = UIColor.Red.CGColor;
        exampleLabel.Layer.BorderWidth = 2; 
```

* * *

## 回答 #15

> 赞同：2
> 
> 时间：2016-04-16T22:02:15.507

在 Swift 2.0 中完美运行

```
 @IBOutlet var theImage: UIImageView! //you can replace this with any UIObject eg: label etc

    override func viewDidLoad() {
        super.viewDidLoad()
//Make sure the width and height are same
        self.theImage.layer.cornerRadius = self.theImage.frame.size.width / 2
        self.theImage.layer.borderWidth = 2.0
        self.theImage.layer.borderColor = UIColor.whiteColor().CGColor
        self.theImage.clipsToBounds = true

    } 
```

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2011-11-05T00:55:53.377

根据您正在做什么，您可以制作图像并以编程方式将其设置为背景。

# .net - 如何阻止 DateTimeOffset 刻度在 linq to Sql 中导致 ChangeConflictException？

> ID：510384
> 
> 赞同：2
> 
> 时间：2009-02-04T07:20:12.313
> 
> 标签：.net, linq-to-sql, sql-server-2008, concurrency, datetimeoffset

以下代码尝试创建新记录，然后在将其提交到数据库后对其进行修改。最后一次 SubmitChanges() 调用引发 ChangeConflictException。

```
ItemA itemA = new ItemA();
itemA.Foo = "a";
itemA.Created = DateTimeOffset.Now.UtcDateTime;

ItemAs.InsertOnSubmit(itemA);
SubmitChanges();

itemA.Foo = "b";
SubmitChanges(); 
```

通过检查 dataContext.ChangeConflicts，我发现“Created”列存在冲突，即使报告的 CurrentValue 和 DatabaseValue 看起来相同。经过仔细检查，我发现蜱虫略有不同。因为我已将数据库中的 DateTimeOffset 列设置为 3，即毫秒，所以它与 .NET 版本的值不同，我认为它的比例为 7。因此 Linq to Sql注意到不匹配，并认为在上面显示的插入和更新之间，有些东西修改了数据库。

除了编写扩展方法或我可以用来修改.NET 中的精度的东西之外，还有更好的方法来处理这个问题吗？

* * *

**更新**

我不得不依赖在模型上设置 DateTimeOffset 列时必须调用的扩展方法。

```
public static DateTimeOffset ToUniversalTime(this DateTimeOffset dto, int scale) {
    DateTimeOffset utc = dto.ToUniversalTime();
    return utc.AddTicks(-(utc.Ticks % (int)Math.Pow(10, 7 - scale)));
} 
```

然后可以称为：

```
EntityFoo.Created = DateTimeOffset.Now.ToUniversalTime(3) 
```

我不太喜欢这种方法，因为这意味着我必须手动设置我认为数据上下文应该执行的比例。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-10T05:53:49.883

由于您总是使用世界时，我看不出 DateTimeOffset 比 DateTime 有什么优势。您可以使用 DateTime.UtcNow，它与 Sql Server 的 DateTime 具有相同的精度。

或者，当您使用 Sql Server 2008 时，您可以将字段作为 DateTime2 存储在数据库中：这具有您需要的额外准确性。

# ios - 如何将变量传递给 UIButton 操作

> ID：510393
> 
> 赞同：16
> 
> 时间：2009-02-04T07:26:48.103
> 
> 标签：ios, uibutton

例如，我想将变量传递给 UIButton 操作

```
NSString *string=@"one";
[downbutton addTarget:self action:@selector(action1:string)
     forControlEvents:UIControlEventTouchUpInside]; 
```

我的动作功能是这样的：

```
-(void) action1:(NSString *)string{
} 
```

但是，它返回语法错误。如何将变量传递给 UIButton 动作？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-02-04T08:28:34.657

将其更改为：

```
[downbutton addTarget:self action:@selector(action1:) forControlEvents:UIControlEventTouchUpInside]; 
```

我不了解 Iphone SDK，但按钮操作的目标可能会收到一个 id（通常命名为发件人）。

```
- (void) buttonPress:(id)sender; 
```

在方法调用中，sender 应该是您案例中的按钮，允许您读取属性，例如它的名称、标签等。

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2010-06-14T14:16:09.857

如果您需要区分多个按钮，则可以使用如下标签标记按钮：

```
[downbutton addTarget:self action:@selector(buttonPress:) forControlEvents:UIControlEventTouchUpInside];
downButton.tag = 15; 
```

然后，在您的操作委托方法中，您可以根据之前设置的标签处理每个按钮：

```
(void) buttonPress:(id)sender {
    NSInteger tid = ((UIControl *) sender).tag;
    if (tid == 15) {
        // deal with downButton event here ..
    }
    //...
} 
```

更新： sender.tag 应该是 a`NSInteger`而不是 a`NSInteger *`

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-03-02T10:20:35.887

您可以使用[关联引用](https://developer.apple.com/library/ios/#documentation/Cocoa/Conceptual/ObjectiveC/Chapters/ocAssociativeReferences.html#//apple_ref/doc/uid/TP30001163-CH24-SW3)将任意数据添加到您的 UIButton：

```
static char myDataKey;
...
UIButton *myButton = ...
NSString *myData = @"This could be any object type";
objc_setAssociatedObject (myButton, &myDataKey, myData, 
  OBJC_ASSOCIATION_RETAIN); 
```

对于策略字段 (OBJC_ASSOCIATION_RETAIN)，请为您的案例指定适当的策略。在动作委托方法上：

```
(void) buttonPress:(id)sender {
  NSString *myData =
    (NSString *)objc_getAssociatedObject(sender, &myDataKey);
  ...
} 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2013-12-22T12:39:12.793

传递变量的另一个选项，我发现它比 leviatan 的答案中的标记更直接，是在 accessHint 中传递一个字符串。例如：

```
button.accessibilityHint = [user objectId]; 
```

然后在按钮的action方法中：

```
-(void) someAction:(id) sender {
    UIButton *temp = (UIButton*) sender;
    NSString *variable = temp.accessibilityHint;
    // anything you want to do with this variable
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-29T13:53:47.517

我发现这样做的唯一方法是在调用操作之前设置一个实例变量

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2015-04-23T14:56:23.167

您可以扩展 UIButton 并添加自定义属性

```
//UIButtonDictionary.h
#import <UIKit/UIKit.h>

@interface UIButtonDictionary : UIButton

@property(nonatomic, strong) NSMutableDictionary* attributes;

@end

//UIButtonDictionary.m
#import "UIButtonDictionary.h"

@implementation UIButtonDictionary
@synthesize attributes;

@end 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2014-09-12T16:42:50.137

您可以设置按钮的标签并从发送者访问它

```
[btnHome addTarget:self action:@selector(btnMenuClicked:)     forControlEvents:UIControlEventTouchUpInside];
                    btnHome.userInteractionEnabled = YES;
                    btnHome.tag = 123; 
```

在被调用函数中

```
-(void)btnMenuClicked:(id)sender
{
[sender tag];

    if ([sender tag] == 123) {
        // Do Anything
    }
} 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2015-10-21T13:22:51.170

您可以使用您不使用的 UIControlStates 的字符串：

```
NSString *string=@"one";
[downbutton setTitle:string forState:UIControlStateApplication];
[downbutton addTarget:self action:@selector(action1:) forControlEvents:UIControlEventTouchUpInside]; 
```

和动作功能：

```
-(void)action1:(UIButton*)sender{
    NSLog(@"My string: %@",[sender titleForState:UIControlStateApplication]);
} 
```

# c# - ResourceProviderFactory 定期刷新

> ID：510396
> 
> 赞同：3
> 
> 时间：2009-02-04T07:27:02.110
> 
> 标签：c#, .net, resourceproviderfactory

我创建了一个自定义资源提供程序，它从我们的数据库返回字符串以用于任何用途。

问题是我还没有找到一种方法来“破坏”这些项目上的缓存并从数据库中重新加载它们。理想情况下，当我们更新缓存并想要重新加载它时，我会每 x 分钟或手动执行此操作。

从技术上讲，这很容易。我将所有内容都存储在哈希表中，所以只需核对它并在需要时重新加载。但是，由于 ResourceProviderFactory 处理每个资源类的加载，我不确定如何枚举它创建的类。

代码概览：

```
public class ResourceProvider : IResourceProvider
{

    private Dictionary<string, Dictionary<string, object>> _resourceCache
        = new Dictionary<string, Dictionary<string, object>>();

    private string _virtualPath;
    private string _className;

    public ResourceProvider(string virtualPath, string className)
    {
        _virtualPath = virtualPath;
        _className = className;
    }

    public object GetObject(string resourceKey, CultureInfo culture)
    {
        ...
    }
}

public class ResourceProviderFactory :System.Web.Compilation.ResourceProviderFactory
{
    public override IResourceProvider CreateGlobalResourceProvider(string classKey)
    {
        return new Cannla.Business.Resource.ResourceProvider(string.Empty, classKey);
    }
        ...
        ...
} 
```

我打算做的是每次调用 CreateGlobalResourceProvider 时添加一个引用（例如，将新对象添加到一个集合中，然后枚举它并在需要时删除该对象内的所有内容）但我不确定这是否会做ResourceProviderFactory 有点奇怪。

在我构建所有这些代码之前，是否有任何 ResourceProviderFactory IEnumerable 方法或可以以简单的方式为我提供所有这些对象的方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-10-08T14:52:15.397

**如果可以使用 ASP.Net 缓存系统** 就使用它。您可以使用 HttpRuntime.Cache 访问它并添加定时失效检查以下示例：

```
var Key = "Resources:" + ResourceType + ResourceKey + Cutlure.Name;
HttpRuntime.Cache.Insert(Key, ValueToCache,
    null, DateTime.Now.AddMinutes(1d), 
    System.Web.Caching.Cache.NoSlidingExpiration); 
```

**如果不能使用 ASP.Net 缓存系统**

您可以将触发缓存失效的逻辑放在 IResourceProvider 中。IE。如果缓存过期，只需检查 GetObject。

# c# - 如何在 C# 中将数字输出为一串位？

> ID：510402
> 
> 赞同：3
> 
> 时间：2009-02-04T07:30:42.400
> 
> 标签：c#, .net, formatting, binary, base-conversion

在 C# 中，如何将数字作为二进制输出到控制台？例如，如果我有一个值为 20 的 uint，我如何打印到控制台：00010100（二进制为 20）？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-02-04T07:34:53.937

Convert.ToString (myValue, 2);

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-02-13T07:22:00.297

使用填充使值成为一个字节：

```
Console.WriteLine(Convert.ToString(number, 2).PadLeft(8, '0')); 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-04T07:37:14.760

```
int x = 3;
string binaryString = Convert.ToString(x, 2);
Console.WriteLine(binaryString); 
```

控制台将显示 11。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-04T07:38:42.680

```
Console.WriteLine(Convert.ToString(20, 2)); 
```

# python - 有没有办法在 Python 中获取对象的当前引用计数？

> ID：510406
> 
> 赞同：116
> 
> 时间：2009-02-04T07:32:51.460
> 
> 标签：python, refcounting

有没有办法在 Python 中获取对象的当前引用计数？

* * *

## 回答 #1

> 赞同：127
> 
> 时间：2009-02-04T07:39:03.833

根据 Python[文档](https://docs.python.org/dev/library/sys.html#sys.getrefcount)，该`sys`模块包含一个函数：

```
import sys
sys.getrefcount(object) #-- Returns the reference count of the object. 
```

由于对象 arg 临时引用，通常比您预期的高 1。

* * *

## 回答 #2

> 赞同：74
> 
> 时间：2009-02-04T07:36:25.477

使用`gc`模块，垃圾收集器的接口，您可以调用`gc.get_referrers(foo)`以获取所有引用的列表`foo`。

因此，`len(gc.get_referrers(foo))`将为您提供该列表的长度：推荐人的数量，这就是您所追求的。

另请参阅[`gc`模块文档](http://docs.python.org/library/gc.html)。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2016-12-10T23:00:21.247

有`gc.get_referrers()`和`sys.getrefcount()`。但是，很难看出如何`sys.getrefcount(X)`才能达到传统引用计数的目的。考虑：

```
import sys

def function(X):
    sub_function(X)

def sub_function(X):
    sub_sub_function(X)

def sub_sub_function(X):
    print sys.getrefcount(X) 
```

然后`function(SomeObject)`交付'7'，
`sub_function(SomeObject)`交付'5'，
`sub_sub_function(SomeObject)`交付'3'，
`sys.getrefcount(SomeObject)`交付'2'。

换句话说：如果你使用`sys.getrefcount()`你必须知道函数调用的深度。对于`gc.get_referrers()`一个可能必须过滤推荐人列表。

我建议为诸如“更改隔离”之类的目的进行**手动引用计数，即“如果在其他地方引用则克隆”。**

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2019-10-21T19:31:46.313

```
import ctypes

my_var = 'hello python'
my_var_address = id(my_var)

ctypes.c_long.from_address(my_var_address).value 
```

`ctypes`将变量的地址作为参数。使用`ctypes`over的优点`sys.getRefCount`是您不需要从结果中减去 1。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-12-03T13:02:25.870

Python 中的每个对象都有一个引用计数和一个指向类型的指针。**我们可以使用sys 模块**获取对象的当前引用计数。您可以使用**sys.getrefcount(object)**，**但请记住，将对象传递给 getrefcount() 会使引用计数增加 1**。

```
import sys

name = "Steve"

# 2 references, 1 from the name variable and 1 from getrefcount
sys.getrefcount(name) 
```

# mysql - 在 MySQL 中获取表元数据

> ID：510410
> 
> 赞同：19
> 
> 时间：2009-02-04T07:35:43.780
> 
> 标签：mysql, syntax, constraints

我试图找出如何从 MySQL 5.0 中的表中获取以下约束信息：

*   首要的关键
*   外键和表引用
*   独特的列

这样做的查询或查询的语法是什么？我觉得我很接近[这个](http://dev.mysql.com/doc/refman/5.0/en/table-constraints-table.html)，但没有例子。

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2015-12-26T15:28:28.407

对于 MySQL：

**1) 获取表/字段元数据**

```
SELECT table_schema, table_name, column_name, ordinal_position, data_type, 
       numeric_precision, column_type, column_default, is_nullable, column_comment 
  FROM information_schema.columns 
  WHERE (table_schema='schema_name' and table_name = 'table_name')
  order by ordinal_position; 
```

**或者**

```
show fields from 'table_name' 
```

* * *

**2) 获取外键引用表**

```
SELECT `REFERENCED_TABLE_NAME` 
   FROM `information_schema`.`KEY_COLUMN_USAGE`
   WHERE
       `TABLE_NAME` = 'table_name' AND
       `COLUMN_NAME` = 'Column_Name' 
```

**3) 获取表的索引（主索引和外索引）**

```
show keys from `table_name` 
```

* * *

**5）获取所有索引和引用表**

```
SELECT *
  FROM `KEY_COLUMN_USAGE`
  WHERE
      `TABLE_NAME` = 'table_name' AND
      `TABLE_SCHEMA` = 'schema_name' 
```

**或者**

```
SELECT *
  FROM `REFERENTIAL_CONSTRAINTS`
  WHERE
      `TABLE_NAME` = 'table_name' AND
      `CONSTRAINT_SCHEMA` = 'schema_name' 
```

* * *

**6) 获取存储过程**

```
SELECT * 
  FROM `ROUTINES`
  WHERE
     `ROUTINE_SCHEMA` = 'schema_name' 
```

* * *

**7) 获得触发器**

```
SELECT * 
  FROM `TRIGGERS`
  WHERE 
     `TRIGGER_SCHEMA` = 'schema_name' 
```

* * *

**8) 获取事件**

```
SELECT * 
  FROM `EVENTS`
  WHERE 
     `EVENT_SCHEMA` = 'schema_name' 
```

* * *

**9) 获得意见**

```
SELECT *
  FROM `VIEWS`
  WHERE
      `TABLE_NAME` = 'table_name' AND
      `TABLE_SCHEMA` = 'schema_name' 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-02-04T07:46:17.953

[SHOW COLUMNS](http://dev.mysql.com/doc/refman/5.0/en/show-columns.html "显示列")命令将显示表的主键和唯一列。

至于外键，您**可以**使用[SHOW CREATE TABLE](http://dev.mysql.com/doc/refman/5.0/en/show-create-table.html)命令之类的命令，该命令将输出复制表所需的 DDL 语句。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2011-09-16T12:31:06.770

采用

```
 show fields from table_name
 show keys from table_name 
```

获取主键、外键、唯一键等。

要获取外键引用的表，请使用：

```
 SELECT `REFERENCED_TABLE_NAME` 
 FROM `information_schema`.`KEY_COLUMN_USAGE` 
 WHERE 
     `TABLE_NAME` = '[table_containing_foreign_key]' AND 
     `COLUMN_NAME` = '[foreign_key]' 
```

`[table_containing_foreign_key]`用你的`[foreign_key]`价值观代替

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-04T07:39:26.643

你应该试试看。INFORMATION_SCHEMA 是某些标准的一部分，并且在其他数据库中以（大部分）类似的方式得到支持；该标准应记录在案 - 您可以查找该文档。

但主要的方法是创建一堆测试表，然后看看 INFORMATION_SCHEMA 看看有什么。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2013-07-23T21:57:33.847

使用以下内容使用 Select Query 获得相同的结果：

```
SELECT table_schema, table_name, column_name, ordinal_position, data_type, numeric_precision, column_type FROM information_schema.columns WHERE table_name = '[TABLE_NAME]'; 
```

# computer-science - 熵的计算机科学定义是什么？

> ID：510412
> 
> 赞同：67
> 
> 时间：2009-02-04T07:36:26.930
> 
> 标签：computer-science, information-theory, entropy, data-compression

我最近在我的大学开设了一门数据压缩课程。然而，我发现“熵”这个词在计算机科学中的使用相当含糊。据我所知，它粗略地转化为系统或结构的“随机性”。

计算机科学“熵”的正确定义是什么？

* * *

## 回答 #1

> 赞同：63
> 
> 时间：2009-02-04T07:41:53.983

熵可能意味着不同的东西：

[**计算**](http://en.wikipedia.org/wiki/Entropy_(computing))

> 在计算中，熵是操作系统或应用程序收集的随机性，用于密码学或其他需要随机数据的用途。这种随机性通常是从硬件来源收集的，要么是预先存在的，例如鼠标移动，要么是专门提供的随机性生成器。

[**信息论**](http://en.wikipedia.org/wiki/Entropy_(information_theory))

> 在信息论中，熵是与随机变量相关的不确定性的度量。在这种情况下，该术语本身通常指的是香农熵，它在预期值的意义上量化了消息中包含的信息，通常以比特等单位为单位。等价地，香农熵是当一个人不知道随机变量的值时所丢失的平均信息内容的量度

**数据压缩中的熵**

数据压缩中的熵可能表示您输入到压缩算法的数据的随机性。熵越大，压缩比越小。这意味着文本越随机，您可以压缩的越少。

> 香农的熵表示对任何通信的最佳可能无损压缩的绝对限制：将要编码的消息视为一系列独立且同分布的随机变量，香农的源编码定理表明，在限制中，最短的平均长度对给定字母表中的消息进行编码的可能表示是它们的熵除以目标字母表中符号数量的对数。

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2009-02-04T07:55:13.630

在Andrew Hunt 和 David Thomas的优秀著作[The Pragmatic Programmer: From Journeyman to Master](http://www.pragprog.com/the-pragmatic-programmer)的第 1 章中可以找到我最喜欢的定义，该定义更加注重实际：

> **软件熵**
> 
> 虽然软件开发几乎不受所有物理定律的影响，但熵对我们的打击很大。熵是物理学中的一个术语，指的是系统中“无序”的数量。不幸的是，热力学定律保证宇宙中的熵趋于最大值。当软件中的混乱增加时，程序员称之为“软件腐烂”。
> 
> 有许多因素会导致软件腐烂。最重要的似乎是在项目中起作用的心理学或文化。即使你是一个人的团队，你的项目心理也可能是一件非常微妙的事情。尽管有最好的计划和最好的人，一个项目在其生命周期中仍然会经历毁灭和衰败。然而，还有其他一些项目，尽管遇到了巨大的困难和不断的挫折，但成功地对抗了大自然的无序倾向，并取得了相当不错的成绩。
> 
> ...
> 
> ...
> 
> **一扇破碎的窗户。**
> 
> 一扇破碎的窗户，长时间未修复，给建筑物的居民灌输一种被遗弃的感觉——一种当权者不关心建筑物的感觉。所以另一个窗口被打破了。人们开始乱扔垃圾。涂鸦出现。开始严重的结构损坏。在相对较短的时间内，建筑物的损坏超出了业主的修复意愿，被遗弃的感觉变成了现实。
> 
> “破窗理论”启发了纽约和其他主要城市的警察部门打击小事，以阻止大事。它很管用：随时注意破窗、涂鸦和其他轻微违规行为，从而降低了严重犯罪水平。
> 
> 提示 4
> 
> 不要忍受破碎的窗户
> 
> 不要让“破窗”（糟糕的设计、错误的决定或糟糕的代码）得不到修复。发现后立即修复。如果没有足够的时间来正确修复它，然后将其登上。也许您可以注释掉有问题的代码，或者显示“未实现”消息，或者替换为虚拟数据。采取一些措施来防止进一步的损害，并表明你已经掌握了局势。

文字取自： http: [//pragprog.com/the-pragmatic-programmer/extracts/software-entropy](http://pragprog.com/the-pragmatic-programmer/extracts/software-entropy)

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2009-02-04T07:41:16.780

我总是遇到香农熵意义上的熵。

来自[http://en.wikipedia.org/wiki/Information_entropy](http://en.wikipedia.org/wiki/Information_entropy)：

在信息论中，熵是与随机变量相关的不确定性的度量。在这种情况下，该术语本身通常指的是香农熵，它在预期值的意义上量化了消息中包含的信息，通常以比特等单位为单位。等效地，香农熵是当一个人不知道随机变量的值时丢失的平均信息内容的量度。

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2009-02-04T07:42:54.327

[![替代文字](https://i.stack.imgur.com/06giD.jpg)](https://i.stack.imgur.com/06giD.jpg)
[（来源：[mit.edu](http://ocw.mit.edu/NR/rdonlyres/Electrical-Engineering-and-Computer-Science/6-050JSpring-2008/9CD33A23-A58F-4CCD-8C34-DF5A83D56435/0/chp_telegraph_1.jpg)）]

来自[墨西哥大学](http://www.cs.unm.edu/~saia/infotheory.html)

> 熵的信息论概念是物理概念的概括。有很多方法可以描述熵。它是对随机变量的随机性的度量。它也是随机变量或随机过程包含的信息量的度量。它也是消息可压缩量的下限。最后是需要询问关于随机实体以确定其价值的是/否问题的平均数量。

用于概率计算的示例应用程序中的熵方程：

> 它是该值的概率乘以该概率的对数的所有值的总和（即 p(x)logp(x)）。这个方程可以从信息属性的第一原理推导出来。

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2016-01-17T18:07:26.467

这是信息论中*熵*的一个很好的替代解释。

> 熵是**进行预测时所涉及的不确定性**的量度。

我们也可以将熵描述为，如果我们在做出初步预测后得到结果，我们会有多*惊讶。*

假设我们有一个弯曲的硬币，它在 99% 的情况下给我们正面，在 1% 的情况下给我们一个反面。由于只有百分之一的机会得到尾巴，如果我们真的得到尾巴，我们会非常惊讶。另一方面，如果我们得到正面，也不会太令人惊讶，因为我们已经有 99% 的机会获得正面。

假设我们有一个名为的函数`Surprise(x)`，它会给我们每个结果带来的惊喜量；然后我们可以平均概率分布上的惊喜量。这个平均惊喜量也可以用来衡量我们的不确定性。这种不确定性称为***熵***。

更新：

我做了这个可视化来描述动物图像分类器模型（机器学习）中预测类的熵和置信度之间的关系。在这里，**熵**被用来**衡量分类器模型对其预测的置信度**。

[![熵作为置信度度量](https://i.stack.imgur.com/zw1Z6.png)](https://i.stack.imgur.com/zw1Z6.png) 该图显示了来自两个分类器模型的预测熵值的比较。右图以相对较高的置信度（较低熵）预测马的图像，而左边的分类器无法真正区分（较高熵）它是马、牛还是长颈鹿。

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2009-02-07T17:42:11.103

在压缩和信息论方面，源的熵是来自源的符号可以传达的平均信息量（以比特为单位）。通俗地说，一个符号越不可能出现，它的出现带来的惊喜就越多。

如果您的来源有两个符号，比如说`A`和`B`，并且它们的可能性相同，那么每个符号都传达相同数量的信息（一位）。具有四个同等可能符号的源每个符号传送两个比特。

举个更有趣的例子，如果您的来源包含三个符号 、`A`和`B`，`C`其中前两个的可能性是第三个的两倍，那么第三个更令人惊讶，但可能性也较小。该源的净熵为 1.52，计算如下。

您将熵计算为“平均惊喜”，其中每个符号的“惊喜”是其概率乘以概率的负二进制对数：

```
 binary
symbol  weight  probability   log    surprise
  A        2        0.4      -1.32    0.53
  B        2        0.4      -1.32    0.53
  C        1        0.2      -2.32    0.46
total      5        1.0               1.52 
```

（当然）使用二进制日志的负数，因为值在 0 和 1（不包括）之间的日志是负数。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2014-05-19T20:07:29.493

# 超级简单的定义

熵这个词可以用一句话来定义：

## “描述一个系统所需的信息量。”

举个宇宙膨胀的例子：从一开始，所有物质都聚集在大爆炸之前的一个小点上，所以我们可以用“所有物质都在一个点之内”来描述这个系统。虽然今天需要更多的信息来描述系统（即宇宙），但需要描述所有行星的位置、它们的运动、它们上面的东西等。就信息论而言，该定义也适用：例如：添加到密码（系统）中的字母越多，描述密码所需的信息就越多。然后你可以用不同的单位来测量它，例如位或字符，比如“你好”= 5 个字符熵 = 40 位熵（如果 charsize 是 8 位）。

这也意味着您拥有的信息越多，您可以安排这些信息的方式就越多。如果您有 40 位，则可以有 2^40 种不同的方式来安排它们。如果我们在这里谈论密码，那么信息（位）的可能排列越多，破解所需的时间就越长（使用蛮力或字典攻击）。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2016-02-05T15:03:07.780

简而言之，熵定义了随机性。它更像是不可预测的事情。用更专业的术语来说，“在计算中，熵是操作系统或应用程序收集的随机性，用于密码学或其他需要随机数据的用途。这种随机性通常是从硬件来源收集的，要么是预先存在的，例如鼠标移动，要么是专门提供的随机性发生器。” 由维基百科定义。

现在可以很容易地得出关于文件的熵的含义，作为对文件中字节的无序程度的度量。有多种单位用于定义熵，例如 nat、shannon 或 hartley。嗯，最常用的单位是香农。根据香农算法，文件的熵必须进入的值范围是 0 到 8。因此，当熵值为零时，可以说结果是确定的。相反，当熵值为 8 时，结果是最不可预测的。香农给出的衡量事件结果随机性的公式是：

```
 Entropy = ∑ pi log(1/pi) 
```

其中*i*是概率为*pi*的事件。

这个等式的结果总是在 0 到 8 之间。

有关更多信息，请访问链接：[https ://www.talentcookie.com/2016/02/file-entropy-in-malware-analysis/](https://www.talentcookie.com/2016/02/file-entropy-in-malware-analysis/)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-02-04T11:18:22.067

熵就像病毒研究人员的哈希码一样。您获得的熵越少，这意味着它可能是加密或压缩代码，可能是病毒。

标准二进制文件的熵将高于压缩或加密的二进制文件。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-02-07T17:41:10.417

熵通常在计算机科学中具有许多含义。这取决于上下文。在安全性中，熵意味着您放置了多少随机性，例如，当您生成私钥时，许多应用程序要求您移动鼠标以生成熵。这通过获取随机性的“人”元素并将其添加到生成密钥的散列过程中来生成熵。

现在还有一个关于熵的软件工程的定义。这个定义代表过时的代码，或者已经有许多开发人员编写的代码。通常用于参考何时重构您的软件项目。“该项目的代码具有大量的熵，因为许多维护它的人目前不在该项目中”。

这是我也记得的第三个示例用法。在模拟退火的主题中（就计算机科学而言），熵被描述为在评估算法期间发生了多少衰减。

我想回答你的问题，除了你可以在字典中找到的那些之外，“熵”这个词没有一个具体的定义。计算机科学如何倾向于应用该术语取决于所使用术语的上下文以及它所应用于的内容。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-03-21T01:09:28.460

用熵很容易做大事。在我看来，这是一个非常[简单和有用的概念](https://stackoverflow.com/questions/3255/big-o-how-do-you-calculate-approximate-it/630142#630142)。

基本上，它量化了平均而言，您将从事件中学到什么，例如掷硬币、执行分支指令或索引数组。

就像搜索算法中间的比较操作一样，有一定概率 P 取一个分支，1-P 取另一个分支。

假设 P 是 1/2，因为它在二进制搜索中。然后，如果你选择那个分支，你知道的比以前多 1 位，因为 log(2/1)，以 2 为底，是 1。另一方面，如果你选择另一个分支，你也会学到 1 位。

要获得您将学习的平均信息量，请将您在第一个分支上学到的内容乘以您选择该分支的概率，再加上您在第二个分支上学到的内容乘以该分支的概率。

1/2 乘以 1 位，再加上 1/2 乘以 1 位，就是 1/2 位加上 1/2 位，或总共 1 位熵。这就是您可以期望从该决定中平均学到的东西。

另一方面，假设您在一个包含 1024 个条目的表中进行线性搜索。

在第一个 == 测试中，YES 的概率是 1/1024，所以在那个决定 YES 的熵是

```
1/1024 times log(1024/1) 
```

或 1/1024 * 10 = 大约 1/100 位。

因此，如果答案是肯定的，您将学习 10 位，但这种机会大约是千分之一。

另一方面，NO 的可能性更大。它的熵是

```
1023/1024 * log(1024/1023) 
```

或大约 1 倍大约为零 = 大约为零。

将两者相加，平均而言，您将了解该决定的 1/100。

这就是线性搜索慢的原因。每个决策的熵（您可以期望学习多少）太小，因为您必须学习 10 位才能找到表中的条目。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2010-06-05T04:40:42.390

计算机科学中的熵通常是指一串位的随机性。以下问题是关于使其精确：

[如何计算位串的近似熵？](https://stackoverflow.com/questions/2979174/how-do-i-compute-the-approximate-entropy-of-a-bit-string)

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2017-03-21T16:03:54.910

简单来说，如果你知道语言中符号的概率，就可以计算出语言中符号的平均信息量。

或者

一种语言的熵是该语言中一个平均符号的信息内容的量度

考虑一个公平的硬币；

有两个符号，每个符号的概率为 1/2，因此熵计算为

h =-(1/2*log1/2 +1/2*log1/2)=1

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2017-06-27T15:10:33.673

熵是指偶尔根据客户要求对软件进行重构的程度，因此为满足客户需求而对其进行重构的成本变得最大。

* * *

## 回答 #15

> 赞同：-1
> 
> 时间：2009-02-04T07:50:08.010

我听说人们滥用熵 wrt CS 的热力学定义。

例如，在这个系统中熵肯定在增加。

当他们的意思是这段代码变得越来越糟糕时！

# command-line - 如何从 Windows 命令行写入并行端口？

> ID：510420
> 
> 赞同：2
> 
> 时间：2009-02-04T07:39:52.337
> 
> 标签：command-line, windows-xp, parallel-port

如何通过 Windows XP 命令行写入并口？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-04T08:13:24.700

查看您对 Zoredache 的回复，您真正的问题不是输出到并行端口，这是微不足道的。

您真正的问题是如何在标准输出上获得 0xff 字符。这可以通过`.com`调用相关软中断的简单可执行文件来实现，但老实说，创建​​一个包含单个 0xff 字符的文件，然后`copy`将其发送到打印机可能更容易：

```
> copy /b data.bin lpt1 
```

请注意`/b`告诉副本该文件是二进制文件的标志。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-04T07:48:46.593

在 DOS 时代，我们经常使用**type filename.txt > lpt1**之类的命令来打印我们的文本文件。

# apache-flex - Flex Builder 项目中哪些文件应该进入源代码管理？

> ID：510421
> 
> 赞同：5
> 
> 时间：2009-02-04T07:40:16.967
> 
> 标签：apache-flex, eclipse, svn, version-control, flexbuilder

我注意到 Eclipse (Flex Builder) 生成了数百个元数据文件。我应该将它们检查到我的源代码管理中吗？它们似乎是必要的，因为如果我删除它们，Flex Builder 只会打开一个空工作台......

其中一些文件显然不属于源代码管理（如 .history 文件和一些缓存文件）。如果我删除它们，我的项目会再次顺利打开。但是列表很长，并且包含属于源代码管理的文件和不属于源代码管理的文件的文件夹之间似乎没有明确的分隔。

我不能把它们全部塞进 svn，即使我要忽略效率低下，因为 Eclipse 会不断生成新的，具有不同的名称，这反过来似乎对于加载项目也很重要。

有人可以启发我吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-04T08:20:28.133

不要签入数百个元数据文件。如果您希望能够以可以导入的方式签出项目，请签入：

```
.actionScriptProperties
.project
.flexProperties 
```

还有“html-template”和“libs”。正如克里斯蒂安所说，你所依赖的任何资源。不过，我通常将它们保留为单独的 Flex 库项目。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-04T07:55:44.893

我通常将所有源代码放在 src 下，并签入 src 及其所有后代。如果我的项目依赖于任何外部依赖项（例如，Cairngorm SWC、as3corelib 等）、Flash/图形资产、样式表或资源文件，我也会将它们签入。但是我不会检查任何生成的（bin-*）、中间或特定于 IDE 的东西，因为在源代码控制中拥有这些东西似乎并没有提供太多实际的好处，而且根据我的经验，这只会让我头疼；一般来说，我会签入我需要的最小集合——假设一个干净的 FlexBuilder 安装（或者根本没有——例如，如果我使用 mxmlc 或 compc 编译）和一个空项目——成功构建项目。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-11T16:45:44.970

大多数 Eclipse 项目文件，如 .project、.properties 以及 .settings 中的所有内容，都可以进入您的源代码管理。只要文件没有文件路径或本地 url 等与用户相关的设置，就可以了。

我们使用的一种方法是创建在 SCM 中不使用但包含在可以使用的本地属性文件中。IE 一个 ant 构建文件，包括一个具有本地元数据的 local.properties 文件。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-27T17:56:07.370

如果 .actionScriptProperties、.project 或 .flexProperties 中包含与用户相关的内容怎么办？通常这将是 url 或路径信息。将其外部化的最佳实践方式是什么？我尝试创建路径变量，但这显然只适用于路径。不适用于主机名等。

# .net - 如何在编辑控件中拦截 Tab 键

> ID：510429
> 
> 赞同：2
> 
> 时间：2009-02-04T07:45:03.043
> 
> 标签：.net, winforms, key

我需要 RichTextEdit 控件中制表键的自定义行为。

目前我拥有的最好的是：

```
editBox.PreviewKeyDown += new System.Windows.Forms.PreviewKeyDownEventHandler(this.field_PreviewKeyPress);

  private void field_PreviewKeyPress(object sender, PreviewKeyDownEventArgs e)
        {
            switch (e.KeyCode)
            {
                case Keys.Tab: 
                     //Some code here
                break;
            }
        } 
```

tab 键注册得很好，但之后控件无论如何都会处理该键并将焦点移动到下一个控件。似乎没有办法消费这个关键事件。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-04T07:52:33.870

也许这篇 CodeProject 文章可以给你一些提示：

[TabKeyIntercept - 拦截并处理 Windows.Forms 表单中的 Tab 键](http://www.codeproject.com/KB/dialog/TabKeyIntercept.aspx)

> [...] 幸运的是，在 Form 基类中，存在该`protected override bool ProcessTabKey(bool forward)` 方法。使用这种方法，我们可以拦截并“使用” Tab 键。
> 
> 而且，事实证明，如果 `ProcessTabKey()`方法的返回值为 false，Tab 键确实会进入 OnKeyDown() 方法。但是，当然，如果您的代码“使用”方法中的 Tab 键`ProcessTabKey()`，您可能不需要在`OnKeyDown()`方法中处理它。
> 
> 此外，Control-Tab 组合使其成为`OnKeyDown()`方法。
> 
> 所以，知道了这些，我们准备为 Tab 键定义一个自定义用途——我们可以对表单进行编码，以允许用户使用 Control-Tab 组合在 Tab 键的正常使用/含义和我们的自定义使用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-04T10:23:34.890

自己找到了一个解决方案 - 覆盖 bool RichTextEdit.ProcessCmdKey(ref Message m, Keys keyData)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-04T07:50:08.180

您说您使用的是“RichTextEdit”控件，但我猜您的意思是 RichTextBox。如果是这样，您应该能够将[AcceptsTab](http://msdn.microsoft.com/en-us/library/system.windows.forms.textboxbase.acceptstab.aspx)属性设置为 True 以允许它处理制表键。

# c++ - 创建多少线程以及何时创建？

> ID：510441
> 
> 赞同：10
> 
> 时间：2009-02-04T07:52:10.047
> 
> 标签：c++, linux, multithreading, networking

我有一个网络 Linux 应用程序，它接收来自多个目的地的 RTP 流，进行非常简单的数据包修改，然后将流转发到最终目的地。

我如何决定我应该有多少线程来处理数据？我想，我不能为每个 RTP 流打开一个线程，因为可能有数千个。我应该考虑CPU内核的数量吗？还有什么重要的？谢谢。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-02-04T08:23:23.307

了解在服务器上使用多个线程的目的很重要；服务器中的许多线程用于减少[延迟](http://en.wikipedia.org/wiki/Latency_(engineering))而不是提高速度。您不会通过拥有更多线程来使 cpu 更快，但您更有可能在给定的时间内总是出现一个线程来处理请求。

拥有一堆只并行移动数据的线程是一种相当低效的霰弹枪（每个请求创建一个线程自然会完全失败）。使用[线程池](http://en.wikipedia.org/wiki/Thread_pool_pattern)模式可能是减少延迟的更有效、更集中的方法。

现在，在线程池中，您希望至少拥有与 CPU/内核一样多的线程。你可以拥有更多，但额外的线程只会减少延迟而不是提高速度。

将组织服务器线程的问题想象成类似于在超市中组织一条生产线。您想拥有很多工作速度较慢的收银员还是一名工作速度超快的收银员？快速收银员的问题不在于速度，而是一位拥有大量杂货的顾客可能仍会占用大量时间。对许多线程的需求来自于一些请求会花费大量时间并阻塞所有线程的可能性。通过这种推理，您是否受益于许多速度较慢的收银员取决于您是否拥有相同数量的杂货或数量差异很大的杂货。回到基本模型，这意味着你必须使用你的线程数来确定给定流量的特定特征什么是最佳的，查看处理每个请求所花费的时间。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-02-04T08:22:10.377

传统上，合理线程的数量取决于执行单元的数量、IO 与计算的比率以及可用内存。

### 执行单元数 ( `XU`)

这计算了有多少线程可以同时处于活动状态。根据您的计算可能会或可能不会计算超线程之类的东西 - 混合指令工作负载会更好地工作。

### IO 与计算的比率 ( `%IO`)

如果线程从不等待 IO 而总是计算 (%IO = 0)，那么使用比 XU 更多的线程只会增加内存压力和上下文切换的开销。如果线程总是等待 IO 并且从不计算 (%IO = 1)，那么使用`poll()`or的变体`select()`可能是个好主意。

对于所有其他情况`XU / %IO`，给出了完全使用可用 XU 需要多少线程的近似值。

### 可用内存 ( `Mem`)

这更像是一个上限。每个线程使用一定数量的系统资源 ( `MemUse`)。 `Mem / MemUse`为您提供系统可以支持多少线程的近似值。

### 其他因素

即使您可以猜测或（更好地）测量上述数字，整个系统的性能仍然会受到其他因素的限制。例如，系统上可能正在运行另一个服务，它使用一些 XU 和内存。另一个问题是一般可用的 IO 带宽 ( `IOCap`)。如果您需要比 XU 提供的每个传输字节更少的计算资源，那么显然您不需要关心完全使用它们，而更多地关心增加 IO 吞吐量。

有关后一个问题的更多信息，请参阅[Google Talk about the Roofline Model](http://www.youtube.com/watch?v=A2H_SrpAPZU)。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-02-04T08:29:31.190

我会说，尝试只使用一个线程；它使编程变得更加容易。尽管您需要使用 libevent 之类的东西来多路复用连接，但您不会遇到任何意外的同步问题。

一旦你有了一个有效的单线程实现，你就可以进行性能测试并决定是否需要多线程。

即使多线程实现是必要的，如果它们没有大量共享数据。

您还可以考虑使用 Python 的“Twisted”之类的东西来简化实现（这就是它的设计目的）。

确实，在进程上使用线程可能不是一个好例子——但也许在你的情况下，很难说。这取决于您需要在线程之间共享多少数据。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-04T07:57:53.920

我会研究这个应用程序的线程池。

[http://threadpool.sourceforge.net/](http://threadpool.sourceforge.net/)

允许线程池管理您的线程和队列。

您可以稍后根据性能分析调整使用的最大和最小线程数。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-02-04T08:55:50.967

听听人们建议您使用 libevent（或特定于操作系统的实用程序，例如 epoll/kqueue）。在许多连接的情况下，这是绝对必须的，因为就像您说的那样，创建线程将极大地影响性能，而 select() 也不能完全削减它。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-04T10:50:55.383

让你的程序决定。向其添加代码以测量吞吐量并动态增加/减少线程数以使其最大化。

这样，无论执行核心的数量和其他因素如何，您的应用程序都将始终运行良好

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-04T08:04:08.793

避免尝试为每个客户端请求创建一个（甚至 N 个）线程是一个好主意。这种方法在传统上是不可扩展的，您肯定会遇到内存使用或上下文切换的问题。您应该考虑使用线程池方法，并将传入请求视为池中任何线程要处理的任务。这种方法的可扩展性受到池中理想线程数的限制——通常这与 CPU 内核的数量有关。您想尝试让每个线程在单个内核上准确使用 100% 的 CPU - 所以在理想情况下，每个内核有 1 个线程，这会将上下文切换减少到零。根据任务的性质，这可能是不可能的，也许线程必须等待外部数据，

# python - 对 ssdeep 的模糊.dll 使用 Python Ctypes 但收到错误

> ID：510443
> 
> 赞同：2
> 
> 时间：2009-02-04T07:52:50.390
> 
> 标签：python, ctypes

我正在尝试使用 Python 和 ctypes 来使用`fuzzy.dll`from ssdeep。到目前为止，我尝试过的一切都因访问冲突错误而失败。这是我在更改到包含`fuzzy.dll`和`fuzzy.def`文件的正确目录后所做的：

```
>>> import os,sys
>>> from ctypes import *
>>> fn = create_string_buffer(os.path.abspath("fuzzy.def"))
>>> fuzz = windll.fuzzy
>>> chash = c_char_p(512)
>>> hstat = fuzz.fuzzy_hash_filename(fn,chash)
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
WindowsError: exception: access violation writing 0x00000200
>>> 
```

据我了解，我已经通过了正确的`c_types`. 来自`fuzzy.h`：

```
extern int fuzzy_hash_filename(char * filename, char * result) 
```

我只是无法克服访问冲突。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-04T15:09:27.047

您的代码有两个问题：

1.  你不应该使用`windll.fuzzy`，但是`cdll.fuzzy`——来自[ctypes 文档](http://docs.python.org/library/ctypes.html#loading-dynamic-link-libraries)：

    > cdll 加载使用标准 cdecl 调用约定导出函数的库，而 windll 库使用 stdcall 调用约定调用函数。

2.  对于返回值 ( `chash`)，您应该声明一个缓冲区而不是创建指向`0x0000200`(=512) 的指针——这就是访问冲突的来源。改为使用`create_string_buffer('\000' * 512)`。

所以你的例子应该是这样的：

```
>>> import os, sys
>>> from ctypes import *
>>> fn = create_string_buffer(os.path.abspath("fuzzy.def"))
>>> fuzz = cdll.fuzzy
>>> chash = create_string_buffer('\000' * 512)
>>> hstat = fuzz.fuzzy_hash_filename(fn,chash)
>>> print hstat
0 # == success 
```

# internet-explorer - 如何让 IE 页面请求保持活动状态超过 1 分钟？

> ID：510455
> 
> 赞同：1
> 
> 时间：2009-02-04T08:01:03.323
> 
> 标签：internet-explorer, http, registry, http-headers, settings

如果您直接连接到 Internet（而不是通过代理）并在 Internet Explorer 7 中请求页面（获取/发布），则默认超时为 1 分钟。如果来自 Web 服务器的响应时间超过一分钟，那么您最终会从 IE 中收到“网络错误”。

如何在 IE 中增加此超时？

Microsoft 已经记录[了如何更改 Internet Explorer 中的默认保持活动超时值](http://support.microsoft.com/kb/813827)，但这在我的 PC（Windows XP SP2、IE 7.0）中不起作用。

有没有人知道如何实现这一目标？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-04T13:35:08.047

KB813827 讨论的是 HTTP 1.1 keepalives，它与在请求之外保持与服务器的 TCP 连接保持打开状态有关。这与您的问题不同，即在请求期间保持连接处于活动状态。要配置每个连接超时，请参阅[KB181050](http://support.microsoft.com/kb/181050)。

假设这里的编程角度是您正在尝试编写一个需要很长时间才能完成的服务器端脚本：

为避免请求超时，您需要让服务器端脚本每隔一段时间返回*一些*内容，以向浏览器保证服务器没有死机并且结果即将到来。

具体如何执行此操作取决于您使用的服务器端技术。在将任何内容发送回客户端之前等待整个响应正文和标头完成的任何内容都已被淘汰。在例如。CGI 你可以返回一个带有“Transfer-Encoding: chunked”的响应体，以每隔一段时间吐出几个字节并保持连接活跃。

或者，立即返回一个页面并在后台生成长进程，然后让客户端页面轮询其完成。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-04T08:05:30.800

从同一篇文章中，

> 如果客户端浏览器 (Internet Explorer) 或 Web 服务器的 KeepAlive 值较低，则它是限制因素。例如，如果客户端有 2 分钟超时，而 Web 服务器有 1 分钟超时，则最大超时为 1 分钟。客户端或服务器都可能是限制因素。

这可能是设置不适合您的原因。

# sql - 验证数据库中的数据：sql vs code

> ID：510461
> 
> 赞同：0
> 
> 时间：2009-02-04T08:03:10.633
> 
> 标签：sql

我的数据库架构具有“锁定”设置，这意味着一旦设置条目就无法更改。

在设置锁定标志之前，我们可以更新其他属性。所以：

*   你会检查代码中的锁定标志，然后更新条目

或者

*   将其组合到 SQL 查询中会更好吗，如果是这样，有什么例子吗？

编辑：您如何将更新和检查合并到一个 SQL 语句中？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-04T08:15:28.097

你应该两者都做。数据库应该使用更新触发器来决定是否可以更新行 - 这将防止任何人意外地更新后表中的行。并且应用程序应该检查它是否应该能够更新行并采取相应的行动。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-04T16:06:02.000

“您如何将更新和检查合并到一个 SQL 语句中？”

```
update table
set ...
where key = ...
and locked ='N'; 
```

这不会引发错误，但会更新 0 行 - 您应该能够在更新后进行测试。

至于哪个更好，我的观点是，如果这个锁定标志很重要，那么：

*   您**必须**在数据库中检查/执行它，以确保它不会被任何访问方法违反
*   您**也可以** **在**应用程序中检查/强制执行它，如果这对用户更友好

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-04T08:07:17.023

我会检查代码中的锁定标志，然后（假设记录未锁定）运行更新查询，同时在查询中设置锁定标志。这样它就可以被包装在一个事务中并一次提交/回滚。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-04T08:08:59.390

如果您的 DBMS 提供此功能来强制执行标志，我将使用触发器。如果设置标志，所有更新都会失败。

然后你可以创建一个特殊的查询来更新标志。您的触发器可以检查所谓的更新，并在必要时允许标志弹回。这样，无论 TSQL 是好的还是恶意的，一旦设置了标志，就没有人可以更新您的行。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-04T08:22:33.170

根据经验，我总是更喜欢检查代码中的所有内容，然后考虑编写数据库约束。让数据库为您执行一致性检查很酷，并且公认比在您的代码中执行它更快，但是您将一些逻辑放入数据库中并且必须付出一些代价。这些限制可能变得依赖于供应商，更糟糕的是，您能否在开发环境中对这些限制执行自动化测试？

所以我会考虑将这种检查作为附加的安全网放在数据库中，但不会单独依赖它们。

# java - System.nanoTime() 完全没用吗？

> ID：510462
> 
> 赞同：160
> 
> 时间：2009-02-04T08:03:41.523
> 
> 标签：java, nanotime

正如博文*[Beware of System.nanoTime() in Java 中](http://www.principiaprogramatica.com/2008/04/25/beware-of-systemnanotime-in-java/)*所述，在 x86 系统上，Java 的 System.nanoTime() 使用[CPU](http://en.wikipedia.org/wiki/Central_processing_unit)特定的计数器返回时间值。现在考虑以下我用来测量通话时间的案例：

```
long time1= System.nanoTime();
foo();
long time2 = System.nanoTime();
long timeSpent = time2-time1; 
```

现在在多核系统中，可能是在测量time1之后，线程被调度到另一个处理器，其计数器小于前一个CPU的计数器。因此，我们可以在 time2 中得到一个*小于*time1 的值。因此，我们会在 timeSpent 中得到一个负值。

考虑到这种情况，是不是 System.nanotime 现在几乎没用了？

我知道更改系统时间不会影响纳米时间。这不是我上面描述的问题。问题是每个 CPU 将保持不同的计数器，因为它被打开。与第一个 CPU 相比，第二个 CPU 上的此计数器可能更低。由于线程可以在获取time1后被操作系统调度到第二个CPU，所以timeSpent的值可能不正确，甚至是负数。

* * *

## 回答 #1

> 赞同：212
> 
> 时间：2011-01-03T21:36:46.703

**这个答案是在 2011 年写的，从当时在操作系统上运行的 Sun JDK 实际做了什么的角度来看。那是很久以前的事！[leventov 的回答](https://stackoverflow.com/a/54566928/116639)提供了一个更新的视角。**

那个帖子是错误的，并且`nanoTime`是安全的。这篇文章有一条评论链接到Sun 的实时并发专家[David Holmes 的博客文章。](https://blogs.oracle.com/dholmes/entry/inside_the_hotspot_vm_clocks)它说：

> System.nanoTime() 是使用 QueryPerformanceCounter/QueryPerformanceFrequency API 实现的 [...] QPC 使用的默认机制由硬件抽象层 (HAL) 确定 [...] 此默认值不仅会跨硬件更改，还会跨操作系统更改版本。例如，Windows XP Service Pack 2 改变了使用电源管理计时器 (PMTimer) 而不是处理器时间戳计数器 (TSC) 的问题，因为 TSC 在 SMP 系统中的不同处理器上不同步，并且由于其频率的事实可以根据电源管理设置而变化（因此它与经过时间的关系）。

因此，在 Windows 上，在 WinXP SP2 之前这*是*一个问题，但现在不是了。

我找不到关于其他平台的第二部分（或更多），但那篇文章确实包含了 Linux 遇到并以相同方式解决相同问题的评论，并提供了指向[clock_gettime(CLOCK_REALTIME) 的常见问题解答](http://juliusdavies.ca/posix_clocks/clock_realtime_linux_faq.html)的链接，其中说：

> 1.  所有处理器/内核的clock_gettime(CLOCK_REALTIME) 是否一致？（拱门重要吗？例如 ppc、arm、x86、amd64、sparc）。
> 
> 它*应该*或被认为是错误的。
> 
> 但是，在 x86/x86_64 上，可能会看到不同步或可变频率 TSC 导致时间不一致。2.4 内核确实对此没有任何保护，早期的 2.6 内核在这里也做得不太好。从 2.6.18 及更高版本开始，检测这一点的逻辑会更好，我们通常会退回到安全的时钟源。
> 
> ppc 总是有一个同步的时基，所以这应该不是问题。

因此，如果 Holmes 的链接可以被解读为暗示`nanoTime`调用`clock_gettime(CLOCK_REALTIME)`，那么它在 x86 上的内核 2.6.18 上是安全的，并且始终在 PowerPC 上（因为 IBM 和摩托罗拉，与英特尔不同，实际上知道如何设计微处理器）。

遗憾的是，没有提到 SPARC 或 Solaris。当然，我们不知道 IBM JVM 做了什么。但是现代 Windows 和 Linux 上的 Sun JVM 做到了这一点。

编辑：这个答案基于它引用的来源。但我仍然担心它实际上可能是完全错误的。一些更新的信息将非常有价值。我刚刚看到[一篇关于 Linux 时钟的四年新文章](http://geekwhisperer.blogspot.co.uk/2010/01/twisty-maze-of-linux-clocks-all.html)的链接，这可能很有用。

* * *

## 回答 #2

> 赞同：35
> 
> 时间：2009-02-04T11:21:17.303

我做了一些搜索，发现如果一个人是迂腐的，那么是的，它可能被认为是无用的......在特定情况下......这取决于您的要求对时间的敏感程度......

看看Java Sun 网站上的[这句话](http://java.sun.com/javase/technologies/realtime/faq.jsp#50)：

> 实时时钟和 System.nanoTime() 都基于相同的系统调用，因此是相同的时钟。
> 
> 使用 Java RTS，所有基于时间的 API（例如，计时器、定期线程、截止日期监控等）都基于高分辨率计时器。并且，与实时优先级一起，它们可以确保在正确的时间执行适当的代码以实现实时约束。相比之下，普通的 Java SE API 只提供了一些能够处理高分辨率时间的方法，并且不能保证在给定时间执行。在代码中的各个点之间使用 System.nanoTime() 来执行经过时间的测量应该总是准确的。

Java 还[对 nanoTime()](http://java.sun.com/j2se/1.5.0/docs/api/java/lang/System.html#nanoTime())方法有一个警告：

> 此方法只能用于测量经过的时间，与系统或挂钟时间的任何其他概念无关。返回的值表示自某个固定但任意时间以来的纳秒（可能在将来，因此值可能为负数）。此方法提供纳秒精度，但不一定提供纳秒精度。不保证值的变化频率。 由于数值溢出，超过大约 292.3 年（2 ^(63纳秒）的连续调用的差异将无法准确计算经过的时间。)

似乎可以得出的唯一结论是 nanoTime() 不能作为准确值依赖。因此，如果您不需要测量仅相隔纳秒的时间，那么即使返回的结果为负值，此方法也足够好。但是，如果您需要更高的精度，他们似乎建议您使用 JAVA RTS。

所以要回答你的问题...... no nanoTime() 不是没用的......它只是不是在每种情况下使用的最谨慎的方法。

* * *

## 回答 #3

> 赞同：27
> 
> 时间：2019-02-07T05:35:40.617

**从 Java 7 开始，`System.nanoTime()`JDK 规范保证是安全的。** [`System.nanoTime()`的 Javadoc](https://docs.oracle.com/javase/7/docs/api/java/lang/System.html#nanoTime())清楚地表明，在 JVM 中（即跨所有线程）观察到的所有调用都是单调的：

> 返回的值表示自某个固定但任意的原始时间以来的纳秒（可能在将来，因此值可能为负数）。在 Java 虚拟机实例中，此方法的所有调用都使用相同的来源；其他虚拟机实例可能使用不同的来源。

JVM/JDK 实现负责消除调用底层操作系统实用程序时可能观察到的不一致（例如[汤姆安德森的回答](https://stackoverflow.com/a/4588605/648955)中提到的那些）。

这个问题的大多数其他旧答案（写于 2009-2012 年）都表达了 FUD，它可能与 Java 5 或 Java 6 相关，但不再与现代版本的 Java 相关。

然而，值得一提的是，尽管 JDK 保证`nanoTime()`了安全，但 OpenJDK 中存在一些错误，使其在某些平台或某些情况下不支持此保证（例如[JDK-8040140](https://bugs.openjdk.java.net/browse/JDK-8040140)、[JDK-8184271](https://bugs.openjdk.java.net/browse/JDK-8184271)）。目前 OpenJDK wrt 中没有公开的（已知的）错误`nanoTime()`，但发现新的此类错误或 OpenJDK 较新版本中的回归不应该让任何人感到震惊。

考虑到这一点，用于定时阻塞、间隔等待、超时等的*代码`nanoTime()`最好将负时间差（超时）视为零，而不是抛出异常。*这种做法也是可取的，因为它与 中的所有类中的所有定时等待方法的行为一致`java.util.concurrent.*`，例如[`Semaphore.tryAcquire()`](https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/util/concurrent/Semaphore.html#tryAcquire(int,long,java.util.concurrent.TimeUnit))、`Lock.tryLock()`、[`BlockingQueue.poll()`](https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/util/concurrent/BlockingQueue.html#poll(long,java.util.concurrent.TimeUnit))等。

尽管如此，`nanoTime()`仍然应该首选实现定时阻塞、间隔等待、超时等，`currentTimeMillis()`因为后者是“时间倒退”现象的对象（例如由于服务器时间校正），即*`currentTimeMillis()`不适合测量时间间隔一点也不。*有关更多信息，请参阅[此答案](https://stackoverflow.com/a/351571/648955)。

最好使用专门的基准测试框架和分析器，而不是`nanoTime()`直接用于代码执行时间测量，例如[JMH](https://openjdk.java.net/projects/code-tools/jmh/)和[async-profiler](https://github.com/jvm-profiling-tools/async-profiler) in [wall-clock profiling mode](https://github.com/jvm-profiling-tools/async-profiler#wall-clock-profiling)。

* * *

## 回答 #4

> 赞同：18
> 
> 时间：2011-04-01T17:07:25.093

无需辩论，只需使用来源即可。在这里，Linux 的 SE 6，得出你自己的结论：

```
jlong os::javaTimeMillis() {
  timeval time;
  int status = gettimeofday(&time, NULL);
  assert(status != -1, "linux error");
  return jlong(time.tv_sec) * 1000  +  jlong(time.tv_usec / 1000);
}

jlong os::javaTimeNanos() {
  if (Linux::supports_monotonic_clock()) {
    struct timespec tp;
    int status = Linux::clock_gettime(CLOCK_MONOTONIC, &tp);
    assert(status == 0, "gettime error");
    jlong result = jlong(tp.tv_sec) * (1000 * 1000 * 1000) + jlong(tp.tv_nsec);
    return result;
  } else {
    timeval time;
    int status = gettimeofday(&time, NULL);
    assert(status != -1, "linux error");
    jlong usecs = jlong(time.tv_sec) * (1000 * 1000) + jlong(time.tv_usec);
    return 1000 * usecs;
  }
} 
```

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2009-02-05T23:17:48.290

Linux 纠正了 CPU 之间的差异，但 Windows 没有。我建议您假设 System.nanoTime() 仅精确到 1 微秒左右。获得更长时间的一种简单方法是调用 foo() 1000 次或更多次，然后将时间除以 1000。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2010-03-31T13:27:09.373

绝对不是没用的。计时爱好者正确地指出了多核问题，但在实际应用程序中，它通常比 currentTimeMillis() 好得多。

当计算帧刷新中的图形位置时，nanoTime() 会导致我的程序中的运动更加平滑。

而且我只在多核机器上测试。

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2011-01-03T20:23:10.717

我看到使用 System.nanoTime() 报告了一个负的*经过时间。*需要明确的是，有问题的代码是：

```
 long startNanos = System.nanoTime();

    Object returnValue = joinPoint.proceed();

    long elapsedNanos = System.nanoTime() - startNanos; 
```

并且变量“elapsedNanos”具有负值。（我很肯定中间调用也用了不到 293 年，这是存储在 long 中的 nanos 的溢出点：）

这发生在运行 AIX 的 IBM P690（多核）硬件上使用 IBM v1.5 JRE 64 位。我只见过这个错误发生一次，所以它似乎非常罕见。我不知道原因——它是特定于硬件的问题，还是 JVM 缺陷——我不知道。我也不知道一般 nanoTime() 准确性的含义。

为了回答最初的问题，我不认为 nanoTime 是无用的——它提供了亚毫秒级的时间，但是你需要考虑到它不准确的实际（不仅仅是理论上的）风险。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-02-04T08:13:25.763

不，它不是......它只取决于你的 CPU，检查[高精度事件计时器](http://en.wikipedia.org/wiki/High_Precision_Event_Timer)，了解如何/为什么根据 CPU 对事物进行不同的处理。

基本上，阅读 Java 的源代码并检查您的版本对该函数的作用，如果它对 CPU 有效，您将在其上运行它。

[IBM 甚至建议](http://www.ibm.com/developerworks/java/library/j-benchmark1.html)您将其用于性能基准测试（2008 年的一篇文章，但已更新）。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-02-04T10:05:59.263

这在运行 Windows XP 和 JRE 1.5.0_06 的 Core 2 Duo 上似乎不是问题。

在三个线程的测试中，我没有看到 System.nanoTime() 倒退。处理器都很忙，线程偶尔会进入睡眠状态以激发移动线程。

[编辑] 我猜它只发生在物理上独立的处理器上，即计数器对于同一个芯片上的多个内核是同步的。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2016-02-20T02:03:14.023

我正在链接到本质上与彼得劳里提供了一个很好的答案的讨论相同的讨论。 [为什么我使用 System.nanoTime() 得到一个负的经过时间？](https://stackoverflow.com/questions/7866206/why-i-get-a-negative-elapsed-time-using-system-nanotime)

许多人提到在 Java System.nanoTime() 中可能会返回负时间。我为重复其他人已经说过的话而道歉。

1.  nanoTime() 不是时钟而是 CPU 周期计数器。
2.  返回值除以频率看起来像时间。
3.  CPU 频率可能会波动。
4.  当您的线程被安排在另一个 CPU 上时，有可能会得到 nanoTime() ，这会导致负差异。这是合乎逻辑的。跨 CPU 的计数器不同步。
5.  在许多情况下，您可能会得到相当误导的结果，但您无法判断，因为 delta 不是负数。想想看。
6.  （未经证实）我认为如果重新排序指令，即使在同一个 CPU 上，您也可能会得到否定的结果。为了防止这种情况，您必须调用一个内存屏障来序列化您的指令。

如果 System.nanoTime() 在它执行的地方返回 coreID，那就太酷了。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2011-09-21T10:30:32.627

Java 是跨平台的，nanoTime 是平台相关的。如果你使用 Java - 什么时候不要使用 nanoTime。我发现这个函数在不同的 jvm 实现中存在真正的错误。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-02-04T08:31:06.053

Java 5 文档还建议将此方法用于相同目的。

> 此方法只能用于测量经过的时间，与系统或挂钟时间的任何其他概念无关。

[Java 5 API 文档](http://java.sun.com/j2se/1.5.0/docs/api/java/lang/System.html#nanoTime())

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2015-08-20T12:14:12.437

此外，`System.currentTimeMillies()`当您更改系统时钟时会发生变化，而`System.nanoTime()`不会发生变化，因此后者更安全地测量持续时间。

* * *

## 回答 #14

> 赞同：-3
> 
> 时间：2012-04-24T04:46:18.713

`nanoTime`时间安排非常不安全。我在我的基本素数测试算法上进行了尝试，它给出的答案对于相同的输入实际上相差一秒。不要使用那种荒谬的方法。我需要比 get time millis 更准确和精确的东西，但不如`nanoTime`.

# delphi - DELPHI 和 WANT 或 NANT

> ID：510476
> 
> 赞同：2
> 
> 时间：2009-02-04T08:10:33.163
> 
> 标签：delphi, cruisecontrol.net, nant

我们使用[Cruise control .net](http://confluence.public.thoughtworks.org/display/CCNET/Welcome+to+CruiseControl.NET) 在 Delphi 2006 应用程序中进行持续集成。我们使用类似于[此处](http://www.stevetrefethen.com/blog/VideoSettingUpAContinuousIntegrationEnvironment.aspx)描述的设置。

**问题：**

1) 用于实现构建脚本的最佳脚本工具/语言是什么？

2) 使用[WANT](http://sourceforge.net/projects/want/)比使用[NANT](http://nant.sourceforge.net/)有什么优势吗？

（注意：D2006 与 MSBuild 不兼容）

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-02-04T08:38:17.973

我从未使用过 WANT，但 NANT 可以在任何 Delphi 版本中正常工作。我认为 NANT 也得到了更好的支持，并且具有更多您可以使用的功能，因为它的使用范围比 WANT 更广泛。

顺便说一句：如果需要，您仍然可以使用 MSBuild 并调用 dcc32。这样，它与 NANT 相同。如果您迁移到 Delphi 2007，则 MSBuild 比 NANT 具有更大的优势，因为 Delphi 项目采用 MSBuild 格式。但即便如此，您仍然可以使用 NANT 作为构建脚本。它只会调用 MSBuild 来进行单独的构建。

另一个值得一试的构建工具是[FinalBuilder](http://www.finalbuilder.com/)。它非常完整，并且知道Delphi。它应该，因为它是使用 Delphi 构建的。他们还提供了类似于 CruiseControl 的持续集成解决方案。缺点是 FinalBuilder 不是免费的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-10T19:52:38.040

就在几天前，我设法实现了一个复杂的 NANT 脚本来编译我们的项目（它使用 d7-2009 编译器、VC++ 2005 和颠覆）。[与NantGui](http://nantgui.berlios.de/)一起使用时，设置和工作非常容易。与MSBuild 不同，您不必在系统中安装特定版本的 .NET。

对于使用 dcc32 编译项目，请查看[delphi3000](http://www.delphi3000.com/articles/article_4585.asp?SK=)文章

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-21T18:43:58.973

我使用 XSL 自动生成 Cruisecontrol 项目文件。我们有一个大型项目，其中包含许多已经使用通用 Ant 脚本的 Delphi 应用程序。因此使用脚本生成 CC 项目文件是一个自然的解决方案。

另一个与 Ant（和许多其他）一起使用的持续集成解决方案是 TeamCity。它最多可以免费使用一定数量的构建代理/项目。用户界面很棒。

I successfully use Ant for many years now for all kinds of Delphi projects, from small component libraries to multi-project multi-tier applications.

# c# - 直接在 C# 中设置属性的属性

> ID：510477
> 
> 赞同：6
> 
> 时间：2009-02-04T08:11:08.513
> 
> 标签：c#, .net, properties

让我们考虑一下我有一个名为 AvatarSize 的公共属性，如下所示，

```
public class Foo
{
  ...

  public Size AvatarSize
  {
    get { return myAvatarSize; }
    set { myAvatarSize = value; }
  }

  ...
} 
```

现在如果一个目标类想要设置这个属性，那么他们需要按照以下方式进行，

```
myFoo.AvatarSize = new Size(20, 20);  //this is one possible way 
```

但如果我尝试这样设置，

```
myFoo.AvatarSize.Height = 20;  //.NET style
myFoo.AvatarSize.Width = 20;  //error 
```

编译器给我一个错误，指出它不能修改返回值。我知道它为什么会发生，但我希望它也支持第二种方式。请帮我解决。

PS对不起，如果标题很荒谬

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-02-04T08:23:34.667

`Size`是一个结构。作为一个 ValueType 它是不可变的。如果你像这样改变它的属性，它只会修改堆栈中的一个对象实例，而不是实际的字段。在您的情况下`AvatarSize`，只能使用结构构造函数设置属性：`new Size(20, 20)`。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-04T08:25:35.300

你可以做你想做的唯一方法是定义

```
public class MutableSize{
  public int Height{get;set;}
  public int Width{get;set;}
} 
```

然后让 AvatarSize 返回其中之一而不是 Size。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-02-04T09:05:47.200

这实际上只是[Petoj 答案](https://stackoverflow.com/questions/510477/setting-propertys-property-directly-in-c/510483#510483)的扩展。我不会选择可变的大小——在我看来，让事情变得可变会导致更难理解代码。

相反，引入两个新属性，`AvatarHeight`和`AvatarWidth`：

```
public class Foo
{
  ...

  public Size AvatarSize
  {
    get { return myAvatarSize; }
    set { myAvatarSize = value; }
  }

  public int AvatarHeight
  {
    get { return AvatarSize.Height; }
    set { AvatarSize = new Size(AvatarWidth, value); }
  }

  public int AvatarWidth
  {
    get { return AvatarSize.Width; }
    set { AvatarSize = new Size(value, AvatarHeight); }
  }

  ...
} 
```

你仍然不会写`myFoo.AvatarSize.Width = 20`，但你*可以*写`myFoo.AvatarWidth = 20`。请注意，单独设置宽度和高度会比一次性设置它们的效率低。

顺便说一下，这是 Windows 窗体采用的方法。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-04T08:14:11.830

您可以创建 2 个新属性 myFoo.AvatarSizeWidth 并使此属性更改宽度，与高度相同。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-02-04T08:29:41.547

唯一的方法是将自己的 Size 类型作为类（引用）而不是结构（值）。

```
 public class Size
  {
    public Int32 Width;
    public Int32 Height;
  } 
```

但这当然会使 Size 失去作为值类型的一些优势......

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-04T08:21:12.517

这些 Size 对象是否具有高度和宽度的写入属性？还是它们是只读的？

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-02-04T08:34:17.217

如果您想将结构视为类，则必须创建一个包装类，该类具有到结构类型的隐式转换。下面你可以看到包装类（命名为 Size，你可以随意命名，没关系），具有 Size 属性的 Class1 类，然后是一个在 Form1 类中如何使用它的示例：

编辑：我用逆转换（从 System.Drawing.Size 到这个 Size 类）和一些评论更新了 Size 类。

```
public class Size
{
    public Size(){}

    public Size(int width, int height)
    {
        this.Width = width;
        this.Height = height;
    }

    public int Width { get; set; }

    public int Height { get; set; }

    static public implicit operator System.Drawing.Size(Size convertMe)
    {
       return new System.Drawing.Size(convertMe.Width, convertMe.Height);
    }

    static public implicit operator Size(System.Drawing.Size convertMe)
    {
       return new Size(convertMe.Width, convertMe.Height);
    }
}

class Class1
{
    public Class1()
    {
        this.TheSize = new Size();
    }

    public Size TheSize { get; set; }
}

public partial class Form1 : Form
{
    public Form1()
    {
        InitializeComponent();
    }

    private void Form1_Load(object sender, EventArgs e)
    {
        /// Style 1.
        Class1 a = new Class1();

        a.TheSize = new Size(5, 10);

        /// Style 2.
        Class1 c = new Class1();

        c.TheSize.Width = 400;
        c.TheSize.Height = 800;

        /// The conversion from our Size to System.Drawing.Size
        this.Size = c.TheSize;

        Class1 b = new Class1();

        /// The opposite conversion
        b.TheSize = this.Size;

        Debug.Print("b Size: {0} x {1}", b.TheSize.Width, b.TheSize.Height);

    }
} 
```

# java - 可以以及如何将 RandomAccessFile 与 FTP 服务器上包含的文件一起使用？

> ID：510492
> 
> 赞同：0
> 
> 时间：2009-02-04T08:20:57.337
> 
> 标签：java, ftp, random-access

这个问题与Java有关

通过使用 RandomAccessFile，我打算也能够修改文件而不将其清空。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-04T08:23:18.643

FTP 协议仅勉强支持随机访问读写。

也就是说，FTP 客户端可以使用该`REST`命令从特定偏移量开始读取或写入，但它总是会从该点截断文件。

# c# - C# 问题：如何从另一个表单操作一个表单上的文本框？

> ID：510497
> 
> 赞同：0
> 
> 时间：2009-02-04T08:22:15.697
> 
> 标签：c#, .net, winforms

我正在尝试为我正在处理的项目创建自己的错误窗口。当我显示我的错误窗口时，我无法将错误消息和用户消息传递给错误窗口，因为在我制作的类中看不到“ErrorMessage.Text”。

我进入表单设计器生成的代码并尝试使 TextBox 静态，但这只会破坏事情。我可以将 TextBox 设为公共/静态，以便可以从其他表单更改它吗？

1.  如何使 TextBox 静态公共，以便我可以在其他表单中操作它，或者是否有另一种方法可以做到这一点？

**编辑：**

好的，要了解更多信息...

我创建了自己的表单。它被称为“formErrorWindow”。我需要显示我预先设计的表单，其中包含来自另一个表单的消息集。我可以做到这一点的唯一方法是，如果我在窗体设计器区域中创建一个函数，并使用“this.errorMsg.text = error”设置变量。我可以看到该功能的唯一方法是将其设置为静态。如果我将函数设置为静态，当我尝试输入“this.errorMsg.Text = error”时，我会收到此错误：*非静态字段、方法或属性需要对象引用。*

这是我尝试过的：

```
 namespace LCR_ShepherdStaffupdater_1._0
    {
        partial class formErrorWindow
        {
            /// <summary>
            /// Required designer variable.
            /// </summary>
            public System.ComponentModel.IContainer components = null;

            /// <summary>
            /// Clean up any resources being used.
            /// </summary>
            /// <param name="disposing">true if managed resources should be disposed; otherwise, false.</param>
            /// 

            protected override void Dispose(bool disposing)
            {
                if (disposing && (components != null))
                {
                    components.Dispose();
                }
                base.Dispose(disposing);
            }

            #region Windows Form Designer generated code

            /// <summary>
            /// Required method for Designer support - do not modify
            /// the contents of this method with the code editor.
            /// </summary>
// ********* HERE IS THE FUNCTION THAT IVE ADDED BELOW. THIS WOULD WORK BUT.... *********
     public static void showError(string errorTitle, string usrMsg, string errorMsg)
    {
        formErrorWindow errorWindow = new formErrorWindow();
        errorMsgItem.Text = errorMsg;
        errorTitleItem.Text = "Error! : " + errorTitle;
        usrMsgItem.Text = usrMsg;
        errorWindow.ShowDialog();
    }
// ********* HERE IS THE FUNCTION THAT IVE ADDED ABOVE. THIS WOULD WORK BUT.... *********
// ********* I get an error: "An object reference is required for the non-static field, method, or property." *********
            public void InitializeComponent()
            {
                System.ComponentModel.ComponentResourceManager resources = new System.ComponentModel.ComponentResourceManager(typeof(formErrorWindow));
                this.usrMsgItem = new System.Windows.Forms.TextBox();
                this.errorTitleItem = new System.Windows.Forms.Label();
                this.errorMsgItem = new System.Windows.Forms.TextBox();
                this.button1 = new System.Windows.Forms.Button();
                this.panel1 = new System.Windows.Forms.Panel();
                this.label2 = new System.Windows.Forms.Label();
                this.panel1.SuspendLayout();
                this.SuspendLayout();
                // 
                // usrMsgItem
                // 
                this.usrMsgItem.Enabled = false;
                this.usrMsgItem.Location = new System.Drawing.Point(13, 37);
                this.usrMsgItem.Multiline = true;
                this.usrMsgItem.Name = "usrMsgItem";
                this.usrMsgItem.Size = new System.Drawing.Size(334, 81);
                this.usrMsgItem.TabIndex = 0;
                this.usrMsgItem.Text = "Undefined";
                // 
                // errorTitleItem
                // 
                this.errorTitleItem.AutoSize = true;
                this.errorTitleItem.Font = new System.Drawing.Font("Microsoft Sans Serif", 12F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Point, ((byte)(0)));
                this.errorTitleItem.ForeColor = System.Drawing.Color.Red;
                this.errorTitleItem.Location = new System.Drawing.Point(12, 9);
                this.errorTitleItem.Name = "errorTitleItem";
                this.errorTitleItem.Size = new System.Drawing.Size(152, 20);
                this.errorTitleItem.TabIndex = 1;
                this.errorTitleItem.Text = "Error! : Undefined";
                // 
                // errorMsgItem
                // 
                this.errorMsgItem.Enabled = false;
                this.errorMsgItem.Location = new System.Drawing.Point(0, 21);
                this.errorMsgItem.Multiline = true;
                this.errorMsgItem.Name = "errorMsgItem";
                this.errorMsgItem.Size = new System.Drawing.Size(329, 101);
                this.errorMsgItem.TabIndex = 2;
                this.errorMsgItem.Text = "Undefined";
                // 
                // button1
                // 
                this.button1.Location = new System.Drawing.Point(272, 256);
                this.button1.Name = "button1";
                this.button1.Size = new System.Drawing.Size(75, 23);
                this.button1.TabIndex = 3;
                this.button1.Text = "Continue";
                this.button1.UseVisualStyleBackColor = true;
                this.button1.Click += new System.EventHandler(this.button1_Click);
                // 
                // panel1
                // 
                this.panel1.BackColor = System.Drawing.Color.FromArgb(((int)(((byte)(255)))), ((int)(((byte)(128)))), ((int)(((byte)(128)))));
                this.panel1.Controls.Add(this.label2);
                this.panel1.Controls.Add(this.errorMsgItem);
                this.panel1.Location = new System.Drawing.Point(12, 124);
                this.panel1.Name = "panel1";
                this.panel1.Size = new System.Drawing.Size(335, 126);
                this.panel1.TabIndex = 4;
                // 
                // label2
                // 
                this.label2.AutoSize = true;
                this.label2.Font = new System.Drawing.Font("Microsoft Sans Serif", 10F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Point, ((byte)(0)));
                this.label2.Location = new System.Drawing.Point(68, 1);
                this.label2.Name = "label2";
                this.label2.Size = new System.Drawing.Size(189, 17);
                this.label2.TabIndex = 3;
                this.label2.Text = "Technical Error Message";
                // 
                // formErrorWindow
                // 
                this.AutoScaleDimensions = new System.Drawing.SizeF(6F, 13F);
                this.AutoScaleMode = System.Windows.Forms.AutoScaleMode.Font;
                this.BackColor = System.Drawing.Color.FromArgb(((int)(((byte)(255)))), ((int)(((byte)(192)))), ((int)(((byte)(192)))));
                this.ClientSize = new System.Drawing.Size(359, 290);
                this.Controls.Add(this.panel1);
                this.Controls.Add(this.button1);
                this.Controls.Add(this.errorTitleItem);
                this.Controls.Add(this.usrMsgItem);
                this.FormBorderStyle = System.Windows.Forms.FormBorderStyle.FixedToolWindow;
                this.Icon = ((System.Drawing.Icon)(resources.GetObject("$this.Icon")));
                this.MaximizeBox = false;
                this.MinimizeBox = false;
                this.Name = "formErrorWindow";
                this.StartPosition = System.Windows.Forms.FormStartPosition.CenterParent;
                this.Text = "Error!";
                this.VisibleChanged += new System.EventHandler(this.formErrorWindow_VisibleChanged);
                this.panel1.ResumeLayout(false);
                this.panel1.PerformLayout();
                this.ResumeLayout(false);
                this.PerformLayout();

            }

            #endregion

            private System.Windows.Forms.Button button1;
            private System.Windows.Forms.Panel panel1;
            private System.Windows.Forms.Label label2;
            public System.Windows.Forms.TextBox usrMsgItem;
            public System.Windows.Forms.Label errorTitleItem;
            public System.Windows.Forms.TextBox errorMsgItem;
        }
    } 
```

寻找我在上面添加的功能。我如何让它编译并执行我希望它执行的操作而不会出现我不断收到的错误：**非静态字段、方法或属性需要对象引用。**

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-04T08:25:45.300

我只是将消息作为构造函数参数传递。

```
MyMessageBox messageBox = new MyMessageBox("My error message");
messageBox.Show(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-04T08:25:36.267

是的！有一个公开的函数可以接收这个文本：

```
pseudo: public void updateTextBox(string new_text) 
```

并让函数从那里更新文本框。

不要将 UI 与逻辑混为一谈。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-06-07T06:05:15.037

```
public partial class Form1 : Form
    {
        private static TextBox box;

        public Form1()
        {
            InitializeComponent();
        }

        private void Form1_Load(object sender, EventArgs e)
        {

            // box
            box = new TextBox();
            box.Location = new System.Drawing.Point(87, 230);
            box.Name = "box";
            box.Size = new System.Drawing.Size(100, 20);
            box.TabIndex = 1;

            this.Controls.Add(box);

        }
    } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-04T08:25:31.260

您可以首先公开 TextBox。其次制作一个静态表单（表单的名称）变量，并在每次加载时将表单放在那里......在我看来这不是一个好的解决方案，但在不了解您的设计的情况下这是我能想到的最好的...... .

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-04T08:27:24.737

允许公共访问包含在您的类中的对象可能是一种设计。如何在调用的错误窗口类中编写一个属性，`ErrorText`并在该属性中将 设置`ErrorMessage.Text`为传递的字符串？还是我错过了什么？

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-04T08:28:14.297

如果您真的想直接访问控件：

```
 public Form2(Form1 form1)
        {
            InitializeComponent();

            Owner = form1;
            _form1 = form1;
        } 
```

现在您可以通过这种方式访问​​ form1 上的控件：

```
_form1.theForm1ControlName 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-04T08:31:02.777

您可以在错误窗口的类中创建一个方法，可能类似于：

```
public void SetErrorText(string errorText)
{
   this.ErrorMessage.Text = errorText; // assuming the TextBox' ID is ErrorMessage.
} 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-02-08T01:53:57.990

通过添加您所做的公共功能，听起来您走在正确的轨道上，但您不必将其设为静态。作为一般规则，如果您必须进入设计器生成的代码，有些事情是不正确的，所以让我们离开那里 - 这并不意味着您不能将代码添加到表单中，显然，但不要在那个部分做:)

我相信你得到的错误源于一个未实例化的对象（即创建错误形式，如：

```
formErrorWindow myErrorWindow; 
```

而不是像这样实例化它/创建它的实例：

```
formErrorWindow myErrorWindow = new formErrorWindow(); 
```

您已将函数设为静态，因此您可以从任何地方看到它，但是该函数实际上不能做任何事情，因为它运行的表单在您使用“= new formErrorWindow();”之前还不存在。

因此，如果我在一个名为“MainForm”的表单中并且我想显示一个错误，使用您提供的函数的名称，它会像这样完成：

```
formErrorWindow myErrorWindow = new formErrorWindow();
myErrorWindow.showError("Title", "User Message Here", "Error Message Here");
myErrorWindow.ShowDialog(); 
```

关键是要确保没有什么是静态的，然后确保你使用 = new formErrorWindow(); 初始化 formErrorWindow；

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2018-08-29T20:23:03.403

像这样将 TextBox 传递给函数/方法

```
public static void myFunc(TextBox textBox1)
{
    textBox1.Text = "do stuff";
{ 
```

# .net - MySQL .NET 连接器中的连接池

> ID：510500
> 
> 赞同：0
> 
> 时间：2009-02-04T08:23:20.237
> 
> 标签：.net, mysql

我正在用 asp.net 和 mysql 创建一个网站，我注意到 mysql .net 连接器中连接池的性能至少可以说是可怕的！例如 sql server 在连接池（连接到 sql server 的 sql server .net 提供程序）中快 10 倍，我能做些什么来加快连接池吗？当连接返回到导致速度变慢的池时，mysql .net 连接器是否会进行任何检查？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-04T17:57:02.993

确保您使用的是最新版本的 MySQL .Net 连接器。当前版本是 5.2.5。

此外，连接字符串具有属性连接生命周期（默认值 0）。您可以尝试更改该值。更多信息可以在[这里](http://dev.mysql.com/doc/refman/5.1/en/connector-net-using-connection-pooling.html)和[这里找到](http://dev.mysql.com/doc/refman/5.1/en/connector-net-examples-mysqlconnection.html#connector-net-examples-mysqlconnection-connectionstring)

# vim - Ctrl+Space 用于 vim 中的全向和关键字补全

> ID：510503
> 
> 赞同：27
> 
> 时间：2009-02-04T08:25:00.043
> 
> 标签：vim, code-completion

我想在 vim 中使用`Ctrl`+`Space`进行全补（如果没有全补，则使用关键字补全）。我试过这个我在网上某处找到的：

```
inoremap <expr> <c-space> pumvisible() ? "\<C-n>" : "\<C-x>\<C-o>\<C-n>\<C-p>\<C-r>=pumvisible() ? \"\\<Down>\" : \"\\<CR>\"" 
```

但是它不起作用。任何为此使用`Ctrl`+`Space`的人都可以向我展示正确的方法（有效的方法）吗？

值得注意的是，它需要在终端版本的 vim 而不是 gvim 中工作。

* * *

## 回答 #1

> 赞同：43
> 
> 时间：2009-02-04T08:54:04.387

试试这个：

```
inoremap <expr> <C-Space> pumvisible() \|\| &omnifunc == '' ?
\ "\<lt>C-n>" :
\ "\<lt>C-x>\<lt>C-o><c-r>=pumvisible() ?" .
\ "\"\\<lt>c-n>\\<lt>c-p>\\<lt>c-n>\" :" .
\ "\" \\<lt>bs>\\<lt>C-n>\"\<CR>"
imap <C-@> <C-Space> 
```

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2013-08-28T11:01:32.930

上述方式是“某种”工作，但它是如此难以理解，几乎没有人能说出它实际上做了什么。**上面的解决方案不好。**

**简短的回答 - 使用这个：**

```
function! Auto_complete_string()
    if pumvisible()
        return "\<C-n>"
    else
        return "\<C-x>\<C-o>\<C-r>=Auto_complete_opened()\<CR>"
    end
endfunction

function! Auto_complete_opened()
    if pumvisible()
        return "\<Down>"
    end
    return ""
endfunction

inoremap <expr> <Nul> Auto_complete_string()
inoremap <expr> <C-Space> Auto_complete_string() 
```

这个答案还尊重 Ctrl+Space:`<C-Space>`和`<Nul>`.

[我使用与jedi-vim](http://github.com/davidhalter/jedi-vim)中的第一种方法类似的方法，但更可定制。

* * *

**长答案 - 以上内容：**

上述答案的整个转义是如此令人困惑，以至于我将上述答案拆分为可读格式：

```
function! Auto_complete_string()                               
    if pumvisible()                                            
        return "\<C-n>"                                        
    else                                                       
        return "\<C-x>\<C-o>\<C-r>=Auto_complete_opened()\<CR>"
    end                                                        
endfunction                                                    

function! Auto_complete_opened()                               
    if pumvisible()                                            
        return "\<c-n>\<c-p>\<c-n>"                            
    else                                                       
        return "\<bs>\<C-n>"                                   
    end                                                        
endfunction                                                    

inoremap <expr> <Nul> Auto_complete_string() 
```

这清楚地表明了它在做什么。中发生了一些奇怪的事情`Auto_complete_opened`。它不仅仅是完成，它在尝试完成后还做了两件事：

*   当尝试使用omnicompletion时，它会以某种方式执行a `<C-n><C-p><C-n>`，恕我直言，它可以缩写为`<C-n>`。
*   如果完成不成功，它会使用退格并再次完成，而不是`<C-o><C-x>`but `<C-n>`，这没有多大意义。

我并不是说这不是某些用户可能想要的，但它可能不是大多数用户想要的！我的简短回答对此表示赞赏，并为您提供了一种简单的编辑方法。您现在可以根据需要轻松更改内容（例如`<Down>`，`<C-n>`如果您希望从头开始写入第一个条目）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-08-09T21:58:16.127

对于 iterm2 和 vim，这些行对我有用，我来自 jedi-vim

```
" Next three lines are to enable C-Space to autocomplete, omnicomplete
inoremap <C-Space> <C-x><C-o>
imap <buffer> <Nul> <C-Space>
smap <buffer> <Nul> <C-Space> 
```

# java - 是否有使用 OLE 自动化（来自 Java）的良好参考？

> ID：510506
> 
> 赞同：2
> 
> 时间：2009-02-04T08:25:21.807
> 
> 标签：java, automation, ole

我正在尝试从 Java/SWT 应用程序与 Excel 进行通信。我已经能够打开工作表，打开文件并保存它，但仅此而已。

谁能指出我的一些文档/示例？我特别需要知道哪些命令可用。我确实尝试记录宏来检查。这很有用，但并没有给我想要的一切。

这是迄今为止我一直在尝试的示例：

```
private static OleAutomation openFile(
        OleAutomation automation, String fileName) {
    Variant workbooks = automation.getProperty(0x0000023c);// get User
                                                            // Defined
                                                            // Workbooks
    Variant[] arguments = new Variant[1];

    arguments[0] = new Variant(fileName);
    System.out.println("workbooks::\t" + workbooks);

    IDispatch p1 = workbooks.getDispatch();
    int[] rgdispid = workbooks.getAutomation().getIDsOfNames(new String[] { "Open" });
    int dispIdMember = rgdispid[0];
    Variant workbook = workbooks.getAutomation().invoke(dispIdMember, arguments);
    System.out.println("Opened the Work Book");
    try {
        Thread.sleep(500);
    } catch (InterruptedException e) {
        e.printStackTrace();
    }
    int id = workbook.getAutomation().getIDsOfNames(new String[] { "ActiveSheet" })[0];
    System.out.println(id);
    Variant sheet = workbook.getAutomation().getProperty(id);
    OleAutomation sheetAutomation = sheet.getAutomation();

    return (sheetAutomation);
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-12-29T12:38:19.600

使用 VBA 帮助 MSOffice。您也可以在 Office 的 VB 编辑器中使用对象浏览器。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-04T11:39:04.083

不是文档，而是因为您询问了通过自动化提供的可用命令：您是否尝试过 Windows 2000 资源工具包附带的 OLE/COM 对象查看器？[在这里](http://download.microsoft.com/download/win2000platform/oleview/1.00.0.1/nt5/en-us/oleview_setup.exe)下载 。

# asp.net - Fluent Nhibernate 在 3 个表上映射内部联接

> ID：510511
> 
> 赞同：2
> 
> 时间：2009-02-04T08:25:47.547
> 
> 标签：asp.net, nhibernate, fluent-nhibernate, nhibernate-mapping

数据结构为：

*   Table[Questionnaire] 顶部节点
*   Table[QuestionGroup] 只是标题等的分组
*   表[QuestionnaireQuestion]映射[Question]<->[QuestionGroup]的多对多关系和[Questionnaire]<->[Question]的多对多关系
*   表[问题]

出于报告目的，一个问题可以存在于许多问卷/问题组中。QuestionnaireQuestion 表还包含 Question 的一些属性，这些属性可能因调查问卷而异，例如是否需要？验证等。我想不通的是如何映射 Question.Required?。该属性是唯一的，过滤时对问卷调查问卷的问题表中的问卷_id 和问题_id

当我加载问卷时，我提供了一个问卷 ID，然后给我一个 QuestionGroups 列表，每个组都包含一个问题列表（尽管缺少验证属性）。

到目前为止，我的映射是：

```
 public class QuestionnaireMap : ClassMap<Questionnaire>
    {
        public QuestionnaireMap(){
            WithTable("ida_questionnaire");
            SetAttribute("lazy", "false");
            Id(x => x.ID, "ida_questionnaire_id")
                .WithUnsavedValue(0)
                .GeneratedBy.UuidHex("");

        Map(x => x.Description);

        HasMany<QuestionGroup>(x => x.QuestionGroups)
            .IsInverse()
            .WithKeyColumn("ida_questionnaire_id")
            .AsBag().SetAttribute("cascade", "all");
    }
}

public class QuestionGroupMap : ClassMap<QuestionGroup>
{
    public QuestionGroupMap()
    {
        WithTable("ida_questionnaire_group");
        SetAttribute("lazy", "false");
        Id(x => x.ID, "ida_questionnaire_group_id")
            .WithUnsavedValue(0)
            .GeneratedBy
            .UuidHex("");
        Map(x => x.Description).AsReadOnly();

        //References(x => x.Parent, "ida_questionnaire_id");

        HasManyToMany<Question>(x => x.Questions)
            .WithTableName("ida_questionnaire_question")
            .WithParentKeyColumn("ida_questionnaire_group_id")
            .WithChildKeyColumn("ida_question_id")
            .Cascade.All()
            .IsInverse();
    }
}

public class QuestionMap : ClassMap<Question>
{
    public QuestionMap()
    {
        WithTable("ida_question");
        Id(x => x.ID, "ida_question_id").WithUnsavedValue(0).GeneratedBy.UuidHex("");
        Map(x => x.Description, "description").AsReadOnly();
        Map(x => x.Type, "ida_question_type_id").AsReadOnly();

        Component<Core.Validator>(x => x.MyValidator, m =>
            {
                m.Map(x => x.Type, "ida_question_type_id");
                m.Map(x => x.RangeMin, "validate_min");
                m.Map(x => x.RangeMax, "validate_max");
            });

        HasMany<Alternative>(x => x.Alternatives)
            .IsInverse()
            .WithKeyColumn("ida_question_id")
            .AsBag().SetAttribute("cascade", "all");
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-04T10:11:58.207

您需要将 QuestionnaireQuestion 映射为一个单独的实体。Kyle Bailey 在他与 NHibernate帖子[中附加的数据的多对多关系中给出了一个很好的例子。](http://codebetter.com/blogs/kyle.baley/archive/2008/12/24/many-to-many-relationships-with-data-attached-in-nhibernate.aspx)

# asp.net - 如何使用 jquery/ajax 将参数传递给 asp.net 页面方法？

> ID：510528
> 
> 赞同：0
> 
> 时间：2009-02-04T08:31:22.560
> 
> 标签：asp.net, jquery, web-services, asmx

我正在尝试将参数传递给我的静态 Web 方法（位于 asp.net 页面中）。我试图通过值为“myvalue”的“test1”参数。关于我做错了什么的任何想法？

```
$.ajax({
    type: "POST",
    url: "WebForm1.aspx/WebMethod1",
    data: {"test1": "myvalue"},
    contentType: "application/json; charset=utf-8",
    dataType: "json",
    success: function(msg) {
        alert(msg.d);
    }
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-08T07:37:01.917

我的“数据”部分是错误的。它需要是“{'test1':'myvalue'}”

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-04T13:08:11.563

你遇到了什么错误？

我之前使用过原型（类似于 jQuery for ajax），并且您不引用参数名称。所以你的数据参数可能应该是：

```
data: {test1: "myvalue"} 
```

试一试。

您也可以尝试设置 Fiddler 并查看正在发出的实际请求。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-04T20:28:59.397

按照您的设置方式，ajax 调用中可能发生的任何错误都会被默默地吞下。我建议添加这样的错误回调：

```
$.ajax({
    type: "POST",
    url: "WebForm1.aspx/WebMethod1",
    data: {"test1": "myvalue"},
    contentType: "application/json; charset=utf-8",
    dataType: "json",
    success: function(msg) {
        alert(msg.d);
    },
    error: function(response) {
        $('body',document).html(response.responseText);
    }
}); 
```

此外，如果您使用的是 Visual Studio，则可以在调试模式下运行 ASP.NET 应用程序以捕获任何服务器端错误。您还可以在服务器端代码中的某处放置断点，以确保它完全被命中，并检查 Request.Form 集合。

希望这可以帮助。

# .net - 您最喜欢的 LINQ-to-Objects 查询

> ID：510531
> 
> 赞同：20
> 
> 时间：2009-02-04T08:33:37.657
> 
> 标签：.net, linq, linq-to-objects, sample

使用 LINQ，可以更轻松地解决许多编程问题 - 并且使用更少的代码行。

你写过哪些最好的真实世界的**LINQ-to-Objects**查询？

（与 C# 2.0 / 命令式方法相比，最佳 = 简单和优雅）。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-04T09:04:14.147

过滤掉列表中的空项。

```
var nonnull = somelist.Where(a => a != null); 
```

创建一个字典，其中键是属性的值，值是该属性在列表中出现的次数。

```
var countDictionary = somelist
    .GroupBy(a => a.SomeProperty)
    .ToDictionary(g => g.Key, g => g.Count()); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-04T20:03:11.010

LINQ 只是在 C#/VB 中添加了一些函数式编程概念。因此，是的，大多数事情都会变得容易得多。C# 2.0 实际上有一些这样的——例如，参见 List 方法。（尽管 C# 2.0 中的匿名方法语法过于冗长。）

这是一个小例子：

```
static readonly string badChars = "!@#$%^&*()";
bool IsUserNameValid(string userName) {
  return userName.Intersect(badChars).Any();
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-21T06:45:23.577

**示例 1**

返回本地网络中所有可用 SQL Server 实例名称的列表

```
private List<string> GetServerNames()
{
    return SqlDataSourceEnumerator.Instance.GetDataSources().Rows.
        Cast<DataRow>().
        Select
        (
            row => row["ServerName"].ToString() + 
                  (row["InstanceName"] != DBNull.Value ? "\\" + row["InstanceName"].ToString() : "") + 
                  (row["Version"] != DBNull.Value ? " (" + row["Version"].ToString().Substring(0, 3) + ")" : "")
        ).
        OrderBy(s => s).
        ToList();
} 
```

**示例 2**

为新文件生成未使用的名称

```
private string NewName(string newNamePrefix, List<string> existingFileNames)
{
    return newNamePrefix + 
        (existingFileNames.
            Select
            (
                n =>
                {
                    if (n.StartsWith(newNamePrefix))
                    {
                        int i;
                        if (int.TryParse(n.Replace(newNamePrefix, ""), out i))
                            return i;
                    }

                    return 0;
                }
            ).
            OrderBy(i => i).
            Last() + 1
        );
} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2010-02-18T07:57:24.107

我有两个我喜欢的非常荒谬但优雅的例子

```
public static IEnumerable<bool> Information(this byte x)
{
    return Enumerable.Range(0, 8).Select(i => ((x >> i) & 1) == 1);
}

public static IEnumerable<bool> Information(this IEnumerable<byte> xs)
{
    return xs.SelectMany(Information);
} 
```

尽管这些被封装为查询运算符，因此您可以重用它们，例如用于二进制解析

```
var n = bytes.Information().Skip(3).Take(16).ToInt(); 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2010-02-18T08:04:03.930

如果你有一个分隔`Name=Value`字符串，比如`"ID=2;Name=James;Age=32;"`你想快速把它变成字典，你可以使用：

```
var dict = value.Split(new[] { ";" }, StringSplitOptions.RemoveEmptyEntries)
    .Select(str => str.Split('='))
    .ToDictionary(pair => pair[0], pair => pair[1]); 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-20T23:46:41.920

如果您有一个列表 (ie `List<Palette> palettes`)，其中包含包含另一个列表 (ie `Palette.Colors`) 的对象，并且想要将所有这些子列表扁平化为一个：

```
List<Color> allColors = palettes.SelectMany(p => p.Colors); 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2011-02-21T23:23:18.147

在移植代码时，我喜欢在文本上使用 LINQ：

例如：

```
String.Join("\n", @"some VB6 code
    that I could refactor automatically
    if FindAndReplace were a bit more powerfully
    And I don't want to refactor by hand".Split('\n').Trim().Select(line =>
    {
        if(line.Contains("FindAndReplace") && !line.StartsWith("//"))
        {
            return line.Split(" ").Last();
        }
        else
        {
            return String.Join("_", line.Split(" ").Take(3));
        }
    }); 
```

你明白了。Linq 让我可以将 C# 的全部功能应用于文本转换。通常，当我想要以一种复杂的方式提取和操作一种语言的代码时，我会使用它，我将文本单独放在 LinqPad 中并在引号上执行“查找替换”，用双引号替换它们，然后我围着它`@"..."`开始工作。我通常可以在 30 秒左右完成大量的代码转换。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-02-04T08:38:53.323

让我开始了，它太棒了！

```
var myList = from list in myObjectList select list 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2013-06-11T08:32:24.917

我最喜欢的是以下 Linq 示例，用于从[Northwind](http://msdn.microsoft.com/en-us/library/ms143221%28v=sql.105%29.aspx)数据库中**动态排序 SQL 表：**

```
void Main()
{

// Demonstrates dynamic ordering

var SortExpression = "Total"; // choose ProductName or Total
var sortAscending = true; // choose true for ascending, false for descending

// the query to sort
var data = (from pd in Products
                    join od in OrderDetails on pd.ProductID equals od.ProductID into DetailsByProduct
                    select new { ProductName = pd.ProductName, Total = DetailsByProduct.Count()}).ToList();

// the data source you can use for data binding                     
var ds= (sortAscending) 
    ? data.OrderBy(x => x.GetType().GetProperty(SortExpression).GetValue(x, null))
    : data.OrderByDescending(x => x.GetType().GetProperty(SortExpression).GetValue(x, null));

ds.Dump();
} 
```

它允许您通过简单地指定变量中的字段和变量中`SortExpression`的排序顺序来动态排序`sortAscending`。

通过使用`.Take(x)`，`.Skip(y)`您也可以轻松**实现分页**。

# memory - 虚拟内存

> ID：510544
> 
> 赞同：5
> 
> 时间：2009-02-04T08:41:23.927
> 
> 标签：memory, memory-management, virtual

大多数关于虚拟内存的文献都指出，作为应用程序开发人员，了解虚拟内存可以帮助我利用其强大的功能。我参与在 Linux 上开发应用程序已有一段时间了，但在编写代码时并不关心虚拟内存的复杂性。我错过了什么吗？如果是这样，请阐明我如何利用虚拟内存的工作原理。否则，如果我对这个问题没有意义，请告诉我！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-04T08:51:53.190

嗯，这个概念实际上很简单。我不会在这里重复，但你应该拿起任何关于操作系统设计的书，它会在那里解释。我推荐 Silberscahtz 和 Galvin 的“操作系统概念”——这是我在大学时必须使用的，而且很好。

我能想到的虚拟内存知识可能会给你的几件事是：

*   学习在页面边界分配内存以避免浪费（仅适用于虚拟内存，不适用于通常的堆/堆栈内存）；
*   将某些页面锁定在 RAM 中，这样它们就不会被交换到 HDD；
*   监护人页面；
*   保留一些地址范围并稍后提交实际内存；
*   也许使用 NX（不可执行）位来提高安全性，但我不确定这一点。
*   PAE 用于在 32 位系统上访问 >4GB。

尽管如此，所有这些东西都只能在非常特定的场景中使用。事实上，99% 的应用程序不需要关心这一点。

**补充：**也就是说，了解所有这些事情绝对是件好事，这样您就可以在出现此类情况时识别它们。请注意 - 权力带来责任。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-04T08:51:57.977

这是一个有点模糊的问题。

使用虚拟内存的方式主要是通过使用内存映射文件。有关更多详细信息，请参见 mmap() 手册页。

虽然，您可能无论如何都在隐式使用它，因为任何动态库都是作为映射文件实现的，并且许多数据库库也使用它们。

使用来自高级语言的映射文件的界面通常很不方便，这使得它们不太有用。

使用映射文件的主要好处是：

*   访问文件的某些部分时没有系统调用开销（这实际上可能是一个缺点，因为页面错误可能无论如何都会有同样多的开销，如果它发生）
*   无需将数据从操作系统缓冲区复制到应用程序缓冲区 - 这可以提高性能
*   能够在进程之间共享内存。

一些缺点是：

*   32 位机器很容易用完地址空间
*   难以正确处理文件扩展
*   没有简单的方法来查看当前驻留了多少/哪些页面（但是可能有一些方法）
*   不适合实时应用程序，因为页面错误可能会导致 IO 请求，从而阻塞线程（但是文件可以锁定在内存中，但前提是内存足够多）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-04T08:45:03.233

对于当今的大多数应用程序，程序员可以不知道计算机内存的工作情况而不会造成任何伤害。但有时——例如，当你想改善程序的占用空间时——你最终不得不自己操作内存。在这种情况下，了解内存的设计方式至关重要。

换句话说，虽然没有它你确实可以生存，但学习虚拟内存只会让你成为一个更好的程序员。

我认为[维基百科的文章](http://en.wikipedia.org/wiki/Virtual_memory)可以是一个好的开始。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-04T08:49:25.563

在 10 种情况下，可能有 9 种情况您无需担心虚拟内存管理。这就是内核的工作。可能在一些高度专业化的应用程序中，您是否需要围绕它们进行调整。

我知道一篇关于计算机内存管理的文章，重点是 Linux [ [http://lwn.net/Articles/250967](http://lwn.net/Articles/250967) ]。希望这可以帮助。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-04T09:25:25.227

如果您关心性能 - 了解内存层次结构很重要。

对于完全包含在物理内存中的小型数据集，您需要关注缓存（从缓存中访问内存要快得多）。

在处理大型数据集时——可能由于缺少物理内存而被分页，您需要小心保持访问模式的本地化。

例如，如果您在 C ( `int a[rows][cols]`) 中声明一个矩阵，它是按行分配的。因此，在扫描矩阵时，您需要按行而不是按列进行扫描。否则，您将多次进出相同的数据。

Another issue is the difference between *dirty* and *clean* data held in memory. Clean data is information loaded from file that was not modified by the program. The OS may page out clean data (perhaps depending on how it was loaded) without writing it to disk. Dirty pages must first be written to the swap file.

# javascript - Firefox 侧边栏扩展链接已加载到新的浏览器选项卡中。如何？

> ID：510545
> 
> 赞同：1
> 
> 时间：2009-02-04T08:42:15.267
> 
> 标签：javascript, html, firefox, firefox-addon, sidebar

我有一个 friefox 侧边栏扩展。如果通过单击工具栏图标打开它，我会用一个网页（我创作的）加载它。现在，如果用户单击网页上的链接（加载到侧边栏），我希望链接的网页在主窗口的新选项卡中打开。我在我的网页标记中尝试了这个：

```
<a target="_content" href="http://www.google.com">Google</a> 
```

但是该链接在具有焦点的选项卡中打开，而不是在新选项卡中打开。

请帮忙。

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-04T08:49:13.630

如果您改用 target="_blank"，则 FF（版本 3）应为其打开一个新选项卡。还没有从侧边栏尝试过，但值得一试。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-17T13:36:46.827

实际上，没有办法将网页（其链接位于加载到侧边栏扩展中的另一个网页中）加载到浏览器的新选项卡上。唯一的方法是使用javascript。这必须在特权条件下执行（意味着作为扩展的一部分），如下所示：

```
gBrowser.addTab("http://www.google.com/"); 
```

编辑：

上述添加浏览器选项卡的技术在这种情况下不起作用。根据[这篇文章](https://developer.mozilla.org/En/Code_snippets/Tabbed_browser)，在侧边栏中运行的代码无法访问主窗口。所以首先我在使用 gBrowser 之前可以访问浏览器窗口。这是从我使用并正常工作的网站上获取的代码：

```
var mainWindow = window.QueryInterface(Components.interfaces.nsIInterfaceRequestor)
.getInterface(Components.interfaces.nsIWebNavigation)
.QueryInterface(Components.interfaces.nsIDocShellTreeItem)
.rootTreeItem
.QueryInterface(Components.interfaces.nsIInterfaceRequestor)
.getInterface(Components.interfaces.nsIDOMWindow); 
```

在我访问浏览器窗口后，我通过 getBrowser 函数访问了 gBrowser，如下所示：

```
mainWindow.getBrowser().addTab("http://www.google.com/"); 
```

在主窗口浏览器中打开一个新选项卡。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-04T08:45:03.047

```
<a href="http://www.google.com" target="new">Google</a> 
```

这更多地取决于正在使用的浏览器。Firefox 和 Opera，我敢肯定最新的 IE 将“新窗口”显示为新选项卡，除非用户偏好另有规定。

# c# - 从代码编写 Visual Studio 项目

> ID：510555
> 
> 赞同：3
> 
> 时间：2009-02-04T08:46:59.860
> 
> 标签：c#, xml, vb.net, visual-studio

有什么方法可以轻松编写 Visual Studio 项目文件，还是我必须查看 xml 格式并手动编写？.net 框架（3.5）中是否有任何库？

我使用 vb.net 但 c# 也可以工作..

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-04T09:03:01.497

自 2005 版以来的 Visual Studio 使用[MSBuild](http://msdn.microsoft.com/en-us/library/0k6kkbsd.aspx)格式来存储 C# 和 VB 项目文件。

您可以阅读此入门[http://www.informit.com/guides/content.aspx?g=dotnet&seqNum=472](http://www.informit.com/guides/content.aspx?g=dotnet&seqNum=472)或在 Web 上搜索更多示例。

对于编程访问，您可以使用`[Microsoft.Build.BuildEngine](http://msdn.microsoft.com/en-us/library/microsoft.build.buildengine.project_members.aspx)`命名空间中的类。可能这`[Project](http://msdn.microsoft.com/en-us/library/microsoft.build.buildengine.project_members.aspx)`门课是你最感兴趣的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-04T09:05:31.897

我自己没有尝试过，但你可能想看看[http://msdn.microsoft.com/en-us/library/microsoft.build.buildengine.project.aspx](http://msdn.microsoft.com/en-us/library/microsoft.build.buildengine.project.aspx)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-04T09:40:06.273

我们通过几个内部工具来做到这一点。Visual Studio 的项目文件存储为 XML，因此您可以使用您喜欢的任何 XML 类。请务必注意 GUID，因为它们用于将 Visual Studio 中各种文件之间的所有内容联系在一起。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-04T09:02:09.610

框架中没有对此的支持。Visual Studio 项目文件格式特定于 Visual Studio。MSBuild 库中可能有支持，但您需要将它们作为参考包含在内并以这种方式与之交互。你想做什么需要你创建一个 VS 项目文件？

[此处](https://stackoverflow.com/questions/510555/write-visual-studio-project-from-code/510597#510597)提供的链接应该可以满足您的需求。

# multithreading - Delphi 中 100% 的 CPU 使用率

> ID：510559
> 
> 赞同：6
> 
> 时间：2009-02-04T08:49:05.423
> 
> 标签：multithreading, delphi, udp

我将 Indy 9 与 Delphi 5 一起使用。在我的应用程序中，我想通过 UDP 与网络设备通信。所以我使用UDPServer comp。在从 TThread 派生的类中。当我编写类似于以下代码时，CPU 使用率为 100%。

在线程中：

```
while not terminated do begin
  if GetMessage(Msg, 0, 0, 0) then begin
    if Msg.message = WM_UDPMSG then
      Break
    else
      DispatchMessage(Msg);
  end;
end; 
```

和 OnUDPRead 事件：

```
 try    
    // Processing the data here
  except
    PostThreadMessage(ThreadId, WM_UDPMSG, 0, 0);
  end; 
```

当我在 while-do 循环或 OnUDPRead 事件中使用睡眠功能时，没有任何变化。CPU使用率仍然是100％。

我的线程优先级是正常的。

我该如何解决我的问题？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-04T09:25:06.523

您遇到的问题是因为您在 GUI 线程中接收 UDP 数据，但想在另一个线程中处理数据。

真正的问题是您尝试以阻塞方式使用异步组件。更好的解决方案是使用真正的阻塞 UDP 通信库，例如[synapse](http://www.ararat.cz/synapse/doku.php/features)。然后很容易等待新数据在您的线程中接收。

你可以写：

```
while not Terminated do
begin
  BytesRead := FSocker.RecvBufferEx(@(Buffer[0]), BufferSize, Timeout);
  if (BytesRead = 0) then
  begin
    // continue or exit if the receiving Failed
    case FSocket.LastError of
      0, WSAETIMEDOUT: Continue;
      WSAECONNRESET, WSAENETRESET,
        WSAENOTCONN, WSAECONNABORTED,
        WSAENETDOWN:
        begin
          CloseConnection;
          Exit;
        end;
    else
      CloseConnection;
      Exit;
    end;    
  end;
  // process the data in the buffer
end; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-04T08:57:46.267

我对 delphi 代码并不熟悉，但你正在运行一个[*繁忙的等待*](http://en.wikipedia.org/wiki/Busy_waiting)机制，它正在磨削你的 CPU。

在循环中引入睡眠或延迟只会隐藏问题。我建议使用更好的方法来接收您的消息/事件。存在许多解决方案，例如观察者-侦听器模式，或线程等待和通知方案。

* * *

针对您的评论的一些有用链接：

*   [delphi中的线程等待通知](http://newsgroups.cryer.info/borland/public.delphi.nativeapi.win32/200506/0506011396.html)
*   [观察者模式](http://en.wikipedia.org/wiki/Observer_pattern)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-04T09:13:00.400

1 我认为您需要比 9.0.0.18 更新的 Indy 版本。较旧的有显示停止线程错误。这包括与 Delphi 一起交付的所有版本的 Indy，直到版本 7。

2 查看有关如何使用 Indy 的示例代码。

[http://www.indyproject.org/demos/index.html](http://www.indyproject.org/demos/index.html)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-04T09:01:00.673

是否存在等待（阻塞线程）直到消息到达的 GetMessage 版本？

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-04T09:11:11.370

我不知道 GetMassage 的版本。但它像这样在 Windows.pas 中声明

```
function GetMessage; external user32 name 'GetMessageA'; 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-04T09:22:47.043

这个项目是一个非常大的项目。所以更新 Indy 对我来说很困难。但是如果你确定问题是因为旧版本的 Indy，我会更新它。

我看过所有的 Indy 演示。这些演示非常简单。在我的项目中，我的数据传输速度非常快。（像实时录音机）

# wpf - 如何使用户能够在页面上的任何位置拖放 WPF 用户控件？

> ID：510572
> 
> 赞同：11
> 
> 时间：2009-02-04T08:55:06.740
> 
> 标签：wpf, user-controls, drag-and-drop

现在我可以在 WPF 中制作有用的用户控件（感谢[这个 stackoverflow 答案](https://stackoverflow.com/questions/507832/how-to-read-a-passed-parameter-in-a-wpf-usercontrol/508738#508738)），我希望能够将大量用户控件放在一个页面上的两列中，并使用户能够根据偏好移动它们，拖动他们使用最多的那些，等等。

谁能指出我这样做的代码、教程等？我可以想象这在 WPF 中很容易做到。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-04T09:18:17.613

[这](http://blogs.msdn.com/marcelolr/archive/2006/03/02/542641.aspx)是一篇博客文章，可帮助您开始使用 WPF 中的拖放功能。

玩得开心。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-04T09:32:32.733

还有[我如何在数据绑定的 ItemsControls 之间拖放项目？](http://bea.stollnitz.com/blog/?p=53)通过比斯托尔尼茨。

这篇文章讨论了一组可重用的装饰器，它们可以在控件之间进行拖放。

它有点先进，但非常有用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-04T09:41:50.980

一系列使用附加属性处理拖放的博客[文章。](http://blog.pixelingene.com/?p=9)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-04T09:33:05.023

我知道这不是你所需要的，但它可能会让你接近！！！

[Martin Grayson](http://blogs.msdn.com/mgrayson/default.aspx)在 Codeplex 上有一个名为[Blacklight](http://mightymeaty.members.winisp.net/blacklight.silverlight/)的项目……查看 Drag Dock 面板！！！

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-12-30T00:51:00.457

我也在寻找一种简单的方法来完成此操作，并遇到了以下网页：[http](http://dotnetslackers.com/ADO_NET/re-191632_Generic_WPF_Drag_and_Drop_Adorner.aspx) ://dotnetslackers.com/ADO_NET/re-191632_Generic_WPF_Drag_and_Drop_Adorner.aspx看起来这个实现有一些不错的功能。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2011-11-18T11:00:55.323

为了将来参考，codeproject 上有一个很棒的库，它有一个 DragCanvas，可以让您拖动放置在其上的任何控件：

[http://www.codeproject.com/KB/WPF/WPFJoshSmith.aspx](http://www.codeproject.com/KB/WPF/WPFJoshSmith.aspx)

It also contains a CenteredContentControl if you want to make "attachments" between controls.

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-02-04T00:06:03.470

Correction:

```
private void Control_MouseLeftButtonDown(object sender, MouseButtonEventArgs e) {
        isDragging = true;
        var draggableControl = sender as UserControl;
        clickPosition = e.GetPosition(this.Parent as UIElement);
        var transform = RenderTransform as TranslateTransform;
        if (transform != null) {
            clickPosition.X -= transform.X;
            clickPosition.Y -= transform.Y;
        }
        draggableControl.CaptureMouse();
} 
```

# ms-access - Access中有多个键？

> ID：510574
> 
> 赞同：0
> 
> 时间：2009-02-04T08:56:24.193
> 
> 标签：ms-access, key

几年前，我在 MS Excel 中创建了一个数据库来跟踪我的照片。我设计它的方式如下。我有一个主表，其中有一个主键，每张照片都有一个序号 ID。然后我在工作簿中有几张包含同一主题的特定照片的工作表，例如风景（LS）、海景（SC）、日落（SS）等。这些工作表中的每一张都有一个主键，用于对照片 ID 进行排序那个主题。我编写了一个表单，以便在我需要输入新照片时打开。当表单打开时，它将确定主表中的最后一条记录，并将主键增加到序列中的下一个数字。然后我会选择什么表（照片类型 - LS，SC，SS 等），它将确定该特定工作表上的最后一个记录号，并将其输入到表格中。然后我可以输入有关该照片的详细信息，例如曝光设置、位置、拍摄日期、关键词等。然后它将所有这些信息写入主表和特定主题表中。不是最优雅的，但它对我有用。

我想在 MS Access 中复制它，但在打开主表单时，我无法弄清楚如何同时增加主照片编号和主题照片编号。

在 MS Access 中，我创建了一个主表，其中包含 Excel 工作簿主表中存在的所有字段。母版和主题表之间的唯一区别是母版有两列，一列用于主键（主照片编号），另一列用于特定照片的主题。下一列包含特定主题的照片编号。因此，例如，主工作表中的两个连续记录可能如下 slideID = 1245 subject = LS subjectID = 245，然后 slideID = 1246 subject = SS subjectID = 127。在主题工作表中 subjectID 是唯一的唯一标识符。有关照片的所有其他相关信息都复制在主表和主题表中。

所以在 MS Access 中，我有一张主表。我有一个用于输入照片信息的表格。一旦我从表格中选择了主题，如何让它增加主照片 ID 号，目前是表的主键，并增加主题 ID 号？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-04T10:53:25.143

由于您是唯一输入数据的人，因此使用 DMax 是安全的，因为没有其他人可以获取相同的数字。您甚至可以在文本框的默认值中使用 DMax，这意味着每次创建新记录时都会建议该号码，如果创建了记录，建议的号码将变为实际号码。

```
=DMax("[slideID]","TableNameHere")+1 
```

如果您打算学习数据库设计，还有更多工作要做，因为您的表需要规范化，您不妨阅读[关系数据库设计基础，Paul Litwin，2003](http://r937.com/relational.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-04T13:56:05.447

您的主照片表应该包含任何给定照片所需的所有信息。如果您只想查看“风景”，只需创建一个按主题过滤主表的查询。这消除了重复条目。主题表中有关照片的任何字段/数据都可以移动到主表中。

如果您希望您的照片有多个主题，则需要一个 Photo_Subject 表。它需要的唯一字段是：Photo_Subject_ID（自动编号）、PhotoID（来自主表）、SubjectID（或者只是输入主题的名称）。这样，您可以根据需要多次输入同一张照片，并将其与任意数量的主题相关联。您可以在 PhotoID 和 SubjectID 上添加一个索引，以避免重复输入。（是的，我建议避免使用复合主键）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-04T08:58:52.520

你有没有研究过你可以形成的不同类型的关系？例如，一对多关系。您目前在 Access 中建立了哪些关系？

# apache-flex - 在 Flex 中是否存在处理 RDF/XML 文档的“标签搜索”方法？

> ID：510583
> 
> 赞同：1
> 
> 时间：2009-02-04T09:00:33.403
> 
> 标签：apache-flex, actionscript, rdf

我正在我的应用程序中处理 RDF 文件。我使用 URLLoader 加载它，并导入了 flash.xml.* 类以操作我的 RDF 文件的内容。我需要以有效的方式计算某些标签（“描述”）。我正在搜索的标签数量是可变的，现在我在 while cicles 中使用了 firstChild、lastChild、nextSibling 方法的组合，以便从文档中获取我需要的信息。我的问题是，是否有一种更直接和通用的“搜索方法”可以帮助我避免我所做的那种复杂而不优雅的搜索。语法@Property 用于直接访问标签的属性，对吧？你认为解决我的问题对我有用吗？谢谢大家的帮助

大卫

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-04T09:27:40.543

当然。试试这个：

```
// assuming xml is the XML object containing your document
var numberOfDescriptionElements:int = xml..Description.length(); 
```

通常，您应该查看 E4X（ECMAScript for XML）的详细信息，这是一种非常方便且简洁的 ActionScript 子语言，用于访问 XML 结构。

# javascript - JavaScript 中的 Array.length 问题

> ID：510589
> 
> 赞同：0
> 
> 时间：2009-02-04T09:02:50.203
> 
> 标签：javascript

我编写了这个示例代码来打印 x 的长度。但由于某种原因，我什么也没得到！帮助！

```
<html>
<head>
<script type = "text/javascript">
function myF()
{
   var x = [1,2,3,4];
   var y = document.getElementById("thing");
   y.innerHtml = x.length;
}
</script>
</head>

<body onload = "myF();" >

<div id = "thing" >
PRINT TEST
</div>

</body>
</html> 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-04T09:05:54.813

属性名称是innerHTML 而不是innerHtml。

# .net - ASP.NET MVC - 操作 HTTP Post

> ID：510600
> 
> 赞同：3
> 
> 时间：2009-02-04T09:06:06.123
> 
> 标签：.net, asp.net-mvc

当表单回传到服务器时，是否可以在控制器操作中操作、更改、设置 HTTP Post 中包含的值？我想删除用户输入的某些文本框值，以便始终必须重新输入这些值（例如密码字段）。默认情况下，Html 助手从 HTTP Post 信息中提取 HTML 控件的初始值。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-04T14:18:59.020

您不需要自定义 ModelBinder。

```
 [Bind(Exclude="Foo,Bar")]
    public ActionResult Insert(T model) 
```

现在 Foo 和 Bar 为空。

这可以满足您的要求，但我实际上不确定这是您的意思。:)

我的猜测是您的操作确实需要查看用户输入的密码（或其他密码）。但是，例如，如果需要重新输入不同的字段，则您不想在重新显示表单时填充密码。这是个好主意。但在这种情况下，模型绑定器甚至不会进入。您只需在重新显示视图之前将该字段设置为 null。

```
 public ActionResult Insert(T model)
    {
        try
        {
            Repository.Add(model);
        }
        catch (Exception ex)
        {
            ViewData["Message"] = ex.Message;
            model.Password = null;
            return View(model);
        }
        // success!
        return RedirectToRoute( //...
   } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-04T10:54:45.280

您可以创建一个自定义 ModelBinder，它允许您操作发布的数据。

[ScottGu 的帖子](http://weblogs.asp.net/scottgu/archive/2008/09/02/asp-net-mvc-preview-5-and-form-posting-scenarios.aspx)涵盖了这个主题。

# sql - SQL 聚合函数

> ID：510601
> 
> 赞同：1
> 
> 时间：2009-02-04T09:06:38.260
> 
> 标签：sql, aggregate

我对这个[SQL products/productsales有类似的问题](https://stackoverflow.com/questions/501347/sql-products-productsales)

我想做同样的查询，但不是只检查数量，而是要检查“总计”（即数量 * 价格）。“价格”是销售表中的一个字段。

这是该链接上建议的原始查询：

```
SELECT p.[name]
 FROM products p
 WHERE p.product_id in (SELECT s.product_id
     FROM productsales s
     WHERE s.[date] between @dateStart and @dateEnd
     GROUP BY s.product_id
     HAVING Sum(s.quantity) > @X ) 
```

因此，我需要将每次销售的 (s.quantity*s.price) 相加，然后与 @X 进行比较，而不是 Sum(s.quantity)。（每次销售价格可能不同）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-04T09:12:50.400

```
HAVING (Sum(s.quantity*s.price)) > @X 
```

可以解决问题吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-04T14:37:49.963

（Cagcowboy 的回答被标记为已接受，但评论似乎表明它不起作用，所以这是另一种方法）

此代码使用派生表首先计算出每个产品的“总计”，然后将分组等分层。

```
SELECT p.name from products p
WHERE p.product_id IN
    (SELECT product_id from 
        (SELECT product_id, (quantity * price) as total
         FROM productsales WHERE date between @dateStart and @dateEnd) as s
    GROUP by s.product_id
    HAVING sum(total) > @x) 
```

# jboss - 使用 twiddle 检索调用统计信息

> ID：510603
> 
> 赞同：0
> 
> 时间：2009-02-04T09:08:44.730
> 
> 标签：jboss

有没有办法使用 twiddle 命令行工具获取调用统计信息

我试过

`twiddle.sh get "jboss.j2ee:jndiName=jaas/foo/bar/MyBean,service=EJB" InvokeStats`

但我得到 java.io.NotSerializableException: org.jboss.invocation.InvocationStatistics。

jboss web-console 是收集统计信息的唯一方法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-04T13:44:25.580

谷歌搜索了一下后，我找到了答案。实际上，正确的命令是

`twiddle.bat --user="user" --password="pwd" get "jboss.management.local:name=jaas/foo/bar/MyBean,J2EEServer=Local,EJBModule=my_ejb.jar,J2EEApplication=my_ear.ear,j2eeType=StatelessSessionBean" stats`

还需要将 jboss-management.jar 添加到类路径中，twiddle 忘了这样做。

# sharepoint - 搬家MOSS共享服务商

> ID：510604
> 
> 赞同：1
> 
> 时间：2009-02-04T09:09:01.953
> 
> 标签：sharepoint, moss, sharedservicesprovider

我正在将完整的共享点安装移动到另一台服务器。

谁能告诉我是否可以只移动现有的共享服务提供商而不是从头开始？

祝一切顺利

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-04T09:27:58.107

是的，创建一个新的 SSP 并移动应用程序。

如何在[此处迁移应用程序](http://www.sharepointblogs.com/sam/archive/2009/01/11/migrating-web-applications-from-windows-sharepoint-services-to-moss-2007-by-moving-content-databases.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-04T20:42:50.850

用于将[SSP 移动到新场](http://technet.microsoft.com/en-us/library/cc896556.aspx) 或尝试[Microsoft SharePoint Administration ToolKit v2.0](http://www.microsoft.com/downloads/details.aspx?FamilyId=263CD480-F6EB-4FA3-9F2E-2D47618505F2&displaylang=en)

[对于这个的另一种看法](http://blogs.msdn.com/cjohnson/archive/2006/09/15/754902.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-18T15:56:33.720

您确实需要将 SSP 与场中的其他所有内容一起移动。要移动的两件事是 1\. 数据库和 2\. 文件系统。

1.  用于移动所有 SharePoint 数据库的 .doc 文件已在[此处](http://go.microsoft.com/fwlink/?LinkId=141259)发布。[根据To The SharePoint](http://blogs.technet.com/tothesharepoint/archive/2009/01/28/3193875.aspx)博客，微软很快将在 TechNet 上发布更新程序。

2.  然后，为了掩盖任何文件系统更改，我将设置 SharePoint 的全新安装（如果您不需要按照上面提到的文档进行操作）并在源和目标 SharePoint 应用程序服务器之间进行文件比较。我通常免费使用[WinMerge](http://winmerge.org/)，但[Beyond Compare](http://www.scootersoftware.com/)也不错。还要检查是否在您的目标服务器上部署了任何自定义解决方案。

通过确保您的数据库正确移动并且所有文件都在适当的位置，您应该没问题。确保在擦除源数据库和文件之前测试目标服务器上的每个自定义组件（更好的是，存档源）。

# apache-flex - flex 3 从 actionscript 代码访问主 mxml

> ID：510609
> 
> 赞同：4
> 
> 时间：2009-02-04T09:10:46.753
> 
> 标签：apache-flex, actionscript, mxml

我正在编写一个 actionScript 类来处理我的 Web 服务调用。当我检索结果时，我想在我的主 mxml 应用程序中调用 setter 方法。我的问题是我不知道如何从我的 actionscript 类访问我的主 mxml 类的 actionScript 部分中的方法，有什么想法吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-04T13:00:08.350

David 是对的——虽然您可以从应用程序的任何位置静态访问 Application.mxml 对象的公共成员，但从设计角度来看，这有点禁忌。最好努力实现对象之间的松散耦合，而在 Flex 惯用语中所做的方式通常是扩展 EventDispatcher 并分派事件。例如，您的 WebService 包装器可能如下所示：

```
public class MyWrapperClass extends EventDispatcher
{
    [Event(name="webserviceComplete", type="flash.events.Event")]

    public function MyWrapperClass(target:IEventDispatcher=null)
    {
        super(target);
    }

    private function handleWebServiceLoadComplete(event:ResultEvent):void
    {
        dispatchEvent(new Event("webserviceComplete"));
    }

    public function doWork():void
    {
        // Load the service, etc., and ultimately call handleWebServiceLoadComplete()...
    }       
} 
```

...和你的 Main.mxml 文件是这样的：

```
<mx:Script>
    <![CDATA[

        private function app_creationComplete(event:Event):void
        {
            var myWrapper:MyWrapperClass = new MyWrapperClass();
            myWrapper.addEventListener("webserviceComplete", mywrapper_webServiceComplete, false, 0, true);
            myWrapper.doWork();
        }

        private function mywrapper_webServiceComplete(event:Event):void
        {
            // Do the work you would've otherwise done in the public method
        }

    ]]>
</mx:Script> 
```

在这种情况下，最终结果是相同的——完成 Web 服务加载会触发 Main.mxml 中的函数。但请注意`mywrapper_webServiceComplete()`是如何私下声明的——它不是由`MyWrapperClass`. Main.mxml 只是简单地订阅（用`addEventListener()`）在 MyWrapperClass 完成它的工作时得到通知，然后做它自己的工作；MyWrapperClass 对 Main.mxml 的实现细节一无所知，Main.mxml 除了调度一个`webserviceComplete`事件并公开一个公共`doWork()`方法之外，对 MyWrapperClass 也一无所知。松散耦合和信息隐藏在行动中。

祝你好运！

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-02-04T09:22:37.447

如果您的类是添加到组件树的 UIComponent，那么您可以使用它的`parentApplication`属性。否则，使用静态`Application.application`属性，但仅在应用程序初始化完成之后。在此之前，该字段是`null`. 私有字段和方法显然无法访问。在 MXML 部分中用显式`id`s 声明的元素是公共的。

但是，添加这样的调用会创建一个严格的绑定。您可能需要考虑分派一个事件，并在主应用程序中处理此事件。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-07-22T06:44:41.453

如果有人遇到同样的问题：

mx.core.FlexGlobals.topLevelApplication.YOUR_FUNCTION

是访问 main.mxml 中公共函数的语法。

# java - Java JTree 仅扩展一级节点

> ID：510610
> 
> 赞同：12
> 
> 时间：2009-02-04T09:10:58.220
> 
> 标签：java, swing, jtree

使用 JTree，假设根节点为 0 级，并且根节点下方最多可能有 5 级，我如何轻松扩展所有 1 级节点，以便所有 1 级和 2 级分支和叶子都可见，但 3 级及以下不是吗？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-02-04T09:46:42.750

感谢你们的快速反应。但是，我现在找到了我正在寻找的简单解决方案。出于某种原因，我在 JavaDocs 中看不到 DefaultMutableTreeNode.getLevel() ！仅供参考，我现在正在做的是：

```
DefaultMutableTreeNode currentNode = treeTop.getNextNode();
do {
    if (currentNode.getLevel() == 1) 
        myTree.expandPath(new TreePath(currentNode.getPath()));
    currentNode = currentNode.getNextNode();
} while (currentNode != null); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-04T09:38:01.847

您有一些 Tree 实用程序类，它们正是这样做的：

像[这个](http://www.koders.com/java/fid73C19EA27E58706B007DAAF35EE56BF2AE0F3D8B.aspx?s=jtree+expand+level#L3)：

```
public class SimpleNavigatorTreeUtil {

   /**
    * Expands/Collapse specified tree to a certain level.
    * 
    * @param tree jtree to expand to a certain level
    * @param level the level of expansion
    */
   public static void expandOrCollapsToLevel(JTree tree, TreePath treePath,int level,boolean expand) {
      try {
         expandOrCollapsePath(tree,treePath,level,0,expand);
      }catch(Exception e) {
e.printStackTrace();
         //do nothing
      }
   }

   public static void expandOrCollapsePath (JTree tree,TreePath treePath,int level,int currentLevel,boolean expand) {
//      System.err.println("Exp level "+currentLevel+", exp="+expand);
      if (expand && level<=currentLevel && level>0) return;

      TreeNode treeNode = ( TreeNode ) treePath.getLastPathComponent();
      TreeModel treeModel=tree.getModel();
      if ( treeModel.getChildCount(treeNode) >= 0 ) {
         for ( int i = 0; i < treeModel.getChildCount(treeNode); i++  ) {
            TreeNode n = ( TreeNode )treeModel.getChild(treeNode, i);
            TreePath path = treePath.pathByAddingChild( n );
            expandOrCollapsePath(tree,path,level,currentLevel+1,expand);
         }
         if (!expand && currentLevel<level) return;
      }      
      if (expand) {
         tree.expandPath( treePath );
//         System.err.println("Path expanded at level "+currentLevel+"-"+treePath);
      } else {
         tree.collapsePath(treePath);
//         System.err.println("Path collapsed at level "+currentLevel+"-"+treePath);
      }
   }

} 
```

* * *

基本上，您需要探索子节点，直到满足您的标准（此处为深度级别），然后展开所有节点直到该点。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-04T09:54:39.863

以下适用于第一级儿童。要扩展所有子级，请将 .children() 替换为 .breadthFirstEnumeration()

```
import javax.swing.*;
import javax.swing.tree.*;
import java.awt.BorderLayout;
import java.awt.event.*;
import java.util.*;

public class Tree {
    public static void main(String[] args) {
        JPanel panel = new JPanel(new BorderLayout());
        final JTree tree = new JTree();
        panel.add(new JScrollPane(tree));
        JButton btn = new JButton("Press Me");
        btn.addActionListener(new ActionListener() {
            public void actionPerformed(ActionEvent ae) {
                for (Enumeration e = ((TreeNode)tree.getModel().getRoot()).children();e.hasMoreElements();) {
                    TreeNode tn = (TreeNode)e.nextElement();
                    tree.expandPath(new TreePath(((DefaultTreeModel)tree.getModel()).getPathToRoot(tn)));
                }
            }
        });
        panel.add(btn, BorderLayout.SOUTH);
        JFrame frame = new JFrame("");
        frame.getContentPane().add(panel);
        frame.setSize(300, 300);
        frame.setLocation(100, 100);
        frame.pack();
        frame.show();
    }
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-02T10:05:42.627

由于您的 1 级节点都是根节点的子节点，并且假设您正在使用`DefaultMutableTreeNode`（需要调用`getPath()`），您可以像这样迭代根节点的子节点：

```
Enumeration<?> topLevelNodes
    = ((TreeNode)tree.getModel().getRoot()).children();
while(topLevelNodes.hasMoreElements()) {
    DefaultMutableTreeNode node
        = (DefaultMutableTreeNode)topLevelNodes.nextElement();
    tree.expandPath(new TreePath(node.getPath()));
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-04T09:19:01.603

对所有 2 级节点使用[expand(TreePath)](http://java.sun.com/j2se/1.5.0/docs/api/javax/swing/JTree.html#expandPath(javax.swing.tree.TreePath))。

# .net - ASP.NET ObjectDataSource - 参数名称的引用静态属性

> ID：510629
> 
> 赞同：1
> 
> 时间：2009-02-04T09:21:28.480
> 
> 标签：.net, asp.net, session, .net-2.0

我在我的网站项目中使用了很多 ObjectDataSources (ods)。几乎我所有的 ods 都使用 SessionParameters；在 ods 的 SessionField 属性中键入会话参数名称很烦人并且容易出现拼写错误。

我有一个静态 SessionParams 类，我在其中存储所有会话参数名称，是否可以在 ods 中引用该类的成员？我试过这样做，但它从来没有奏效。

这是我现在拥有的：

```
<asp:ObjectDataSource ID="ods" runat="server" OldValuesParameterFormatString="original_{0}"
SelectMethod="GetStuff" TypeName="RM.Stuff">
<SelectParameters>
    <asp:SessionParameter  SessionField="HAVE_TO_TYPE_EVERY_TIME" Name="somename" Type="Int32" />
</SelectParameters> 
```

这就是我想要的：

```
<asp:ObjectDataSource ID="ods" runat="server" OldValuesParameterFormatString="original_{0}"
SelectMethod="GetStuff" TypeName="RM.Stuff">
<SelectParameters>
    <asp:SessionParameter  SessionField='<%= RM.SessionParams.SESSION_PAREMETER_NAME %>' Name="somename" Type="Int32" />
</SelectParameters> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-04T09:46:18.837

据我所知，这些参数不是数据绑定的（也是默认值）。但你可以分配他们@codebhind

# java - ConcurrentHashMap 和 Collections.synchronizedMap(Map) 有什么区别？

> ID：510632
> 
> 赞同：635
> 
> 时间：2009-02-04T09:22:46.747
> 
> 标签：java, dictionary, concurrency

我有一个 Map 将由多个线程同时修改。

Java API 中似乎存在三种不同的同步 Map 实现：

*   `Hashtable`
*   `Collections.synchronizedMap(Map)`
*   `ConcurrentHashMap`

据我了解，`Hashtable`是一个旧的实现（扩展过时的`Dictionary`类），后来经过调整以适应`Map`接口。虽然它*是*同步的，但它似乎存在严重的[可伸缩性问题](http://www.ibm.com/developerworks/java/library/j-jtp07233.html)，并且不鼓励用于新项目。

但是另外两个呢？`Collections.synchronizedMap(Map)`和s返回的Maps有什么区别`ConcurrentHashMap`？哪一种适合哪一种情况？

* * *

## 回答 #1

> 赞同：442
> 
> 时间：2009-02-04T09:32:57.333

根据您的需要，使用`ConcurrentHashMap`. 它允许从多个线程同时修改 Map 而无需阻塞它们。`Collections.synchronizedMap(map)`创建一个会降低性能的阻塞 Map，尽管可以确保一致性（如果使用得当）。

如果您需要确保数据一致性，请使用第二个选项，并且每个线程都需要拥有最新的地图视图。如果性能很关键，则使用第一个，并且每个线程只将数据插入到映射中，读取发生的频率较低。

* * *

## 回答 #2

> 赞同：252
> 
> 时间：2013-07-21T20:09:39.913

```
╔═══════════════╦═══════════════════╦═══════════════════╦═════════════════════╗
║   Property    ║     HashMap       ║    Hashtable      ║  ConcurrentHashMap  ║
╠═══════════════╬═══════════════════╬═══════════════════╩═════════════════════╣ 
║      Null     ║     allowed       ║              not allowed                ║
║  values/keys  ║                   ║                                         ║
╠═══════════════╬═══════════════════╬═════════════════════════════════════════╣
║ Thread-safety ║                   ║                                         ║
║   features    ║       no          ║                  yes                    ║
╠═══════════════╬═══════════════════╬═══════════════════╦═════════════════════╣
║     Lock      ║       not         ║ locks the whole   ║ locks the portion   ║        
║  mechanism    ║    applicable     ║       map         ║                     ║ 
╠═══════════════╬═══════════════════╩═══════════════════╬═════════════════════╣
║   Iterator    ║               fail-fast               ║ weakly consistent   ║ 
╚═══════════════╩═══════════════════════════════════════╩═════════════════════╝ 
```

关于锁定机制： `Hashtable` [锁定对象](http://grepcode.com/file/repository.grepcode.com/java/root/jdk/openjdk/6-b14/java/util/Hashtable.java#Hashtable.put%28java.lang.Object%2Cjava.lang.Object%29)，而只`ConcurrentHashMap`锁定[桶](http://grepcode.com/file/repository.grepcode.com/java/root/jdk/openjdk/8u40-b25/java/util/concurrent/ConcurrentHashMap.java#ConcurrentHashMap.putVal%28java.lang.Object%2Cjava.lang.Object%2Cboolean%29)。

* * *

## 回答 #3

> 赞同：145
> 
> 时间：2009-02-04T09:43:18.327

的“可扩展性问题”以`Hashtable`完全相同的方式存在`Collections.synchronizedMap(Map)`- 它们使用非常简单的同步，这意味着只有一个线程可以同时访问映射。

当您进行简单的插入和查找时，这不是什么大问题（除非您非常密集地执行此操作），但是当您需要遍历整个 Map 时，这会成为一个大问题，这对于大型 Map 可能需要很长时间 - 而一个线程执行此操作，所有其他线程如果要插入或查找任何内容，则必须等待。

使用`ConcurrentHashMap`非常复杂的技术来减少同步的需求并允许多个线程在不同步的情况下进行并行读取访问，更重要的是，提供了`Iterator`不需要同步甚至允许在交互期间修改 Map（尽管它不保证是否或不会返回在迭代期间插入的元素）。

* * *

## 回答 #4

> 赞同：36
> 
> 时间：2014-11-16T15:53:17.400

这两者之间的主要区别在于，`ConcurrentHashMap`只会锁定正在更新的部分数据，而其他部分的数据可以被其他线程访问。但是，`Collections.synchronizedMap()`更新时会锁定所有数据，其他线程只有在锁定释放时才能访问数据。如果更新操作较多，而读取操作相对较少，则应选择`ConcurrentHashMap`.

另一个区别是`ConcurrentHashMap`不会保留传入的 Map 中元素的顺序。这与`HashMap`存储数据时类似。不能保证保留元素顺序。While`Collections.synchronizedMap()`将保留传入的 Map 的元素顺序。例如，如果您将 a 传递`TreeMap`给`ConcurrentHashMap`，则 中的元素顺序`ConcurrentHashMap`可能与 中的顺序不同`TreeMap`，但`Collections.synchronizedMap()`会保留顺序。

此外，`ConcurrentHashMap`可以保证`ConcurrentModificationException`一个线程在更新map，另一个线程在遍历从map获取的迭代器时不抛出异常。但是，`Collections.synchronizedMap()`不能保证这一点。

有[一篇文章](http://www.pixelstech.net/article/1394026282-ConcurrentHashMap-vs-Collections-synchronizedMap%28%29)展示了这两者的区别，还有`ConcurrentSkipListMap`.

* * *

## 回答 #5

> 赞同：35
> 
> 时间：2009-02-04T09:34:04.507

当您可以使用 ConcurrentHashMap 时，它是首选 - 尽管它至少需要 Java 5。

它被设计为在被多个线程使用时可以很好地扩展。当一次只有一个线程访问 Map 时，性能可能会稍差一些，但当多个线程同时访问 Map 时性能会好很多。

我发现了一个[博客条目](https://unserializableone.blogspot.com/2007/04/performance-comparision-between.html)，它复制了优秀书籍[Java Concurrency In Practice](http://www.javaconcurrencyinpractice.com/)中的一个表，我强烈推荐这本书。

Collections.synchronizedMap 仅在您需要包装具有其他一些特征的地图时才有意义，也许是某种有序地图，例如 TreeMap。

* * *

## 回答 #6

> 赞同：16
> 
> 时间：2017-12-26T18:56:28.850

**同步地图：**

Synchronized Map 也与 Hashtable 没有太大区别，并且在并发 Java 程序中提供类似的性能。Hashtable 和 SynchronizedMap 之间的唯一区别是 SynchronizedMap 不是遗留的，您可以使用 Collections.synchronizedMap() 方法包装任何 Map 以创建它的同步版本。

**并发哈希映射：**

ConcurrentHashMap 类提供标准 HashMap 的并发版本。这是对 Collections 类中提供的 synchronizedMap 功能的改进。

与 Hashtable 和 Synchronized Map 不同，它从不锁定整个 Map，而是将 Map 划分为段并在这些段上完成锁定。如果读取器线程的数量大于写入器线程的数量，它的性能会更好。

ConcurrentHashMap 默认分为 16 个区域并应用锁。可以在初始化 ConcurrentHashMap 实例时设置此默认数字。在特定段中设置数据时，将获得该段的锁定。这意味着如果两个更新都影响单独的存储桶，两个更新仍然可以同时安全地执行，从而最大限度地减少锁争用，从而最大限度地提高性能。

ConcurrentHashMap 不会抛出 ConcurrentModificationException

如果一个线程尝试修改它而另一个线程正在迭代它，则 ConcurrentHashMap 不会抛出 ConcurrentModificationException

**synchornizedMap 和 ConcurrentHashMap 的区别**

Collections.synchornizedMap(HashMap) 将返回一个几乎等同于 Hashtable 的集合，其中对 Map 的每个修改操作都锁定在 Map 对象上，而在 ConcurrentHashMap 的情况下，通过根据并发级别将整个 Map 划分为不同的分区来实现线程安全并且只锁定特定部分而不是锁定整个地图。

ConcurrentHashMap 不允许空键或空值，而同步 HashMap 允许一个空键。

**类似链接**

[链接1](http://javarevisited.blogspot.in/2011/04/difference-between-concurrenthashmap.html)

[链接2](https://www.pixelstech.net/article/1394026282-ConcurrentHashMap-vs-Collections-synchronizedMap%28%29)

[性能比较](http://www.programering.com/a/MzM4MjNwATE.html)

* * *

## 回答 #7

> 赞同：14
> 
> 时间：2012-10-28T18:00:09.573

在`ConcurrentHashMap`中，锁应用于一个段而不是整个 Map。每个段管理自己的内部哈希表。该锁仅适用于更新操作。`Collections.synchronizedMap(Map)`同步整个地图。

* * *

## 回答 #8

> 赞同：12
> 
> 时间：2009-02-04T09:36:09.807

*   [`Hashtable`](http://java.sun.com/javase/6/docs/api/java/util/Hashtable.html)并且[`ConcurrentHashMap`](http://java.sun.com/javase/6/docs/api/java/util/concurrent/ConcurrentHashMap.html)不允许`null`键或`null`值。

*   [`Collections.synchronizedMap(Map)`](http://java.sun.com/javase/6/docs/api/java/util/Collections.html#synchronizedMap(java.util.Map))同步**所有**操作（`get`、`put`、`size`等）。

*   [`ConcurrentHashMap`](http://java.sun.com/javase/6/docs/api/java/util/concurrent/ConcurrentHashMap.html)支持检索的完全并发，以及可调整的预期更新并发。

像往常一样，涉及到并发——开销——速度的权衡。您确实需要考虑应用程序的详细并发要求才能做出决定，然后测试您的代码以查看它是否足够好。

* * *

## 回答 #9

> 赞同：9
> 
> 时间：2009-02-04T09:38:34.623

你是对的`HashTable`，你可以忘记它。

[您的文章](http://www.ibm.com/developerworks/java/library/j-jtp07233.html)提到了这样一个事实，虽然 HashTable 和同步包装类通过一次只允许一个线程访问映射来提供基本线程安全，但这不是“真正的”线程安全，因为许多复合操作仍然需要额外的同步，因为例子：

```
synchronized (records) {
  Record rec = records.get(id);
  if (rec == null) {
      rec = new Record(id);
      records.put(id, rec);
  }
  return rec;
} 
```

但是，不要认为这`ConcurrentHashMap`是`HashMap`具有典型`synchronized`块的简单替代方案，如上所示。阅读[本文](http://dmy999.com/article/34/correct-use-of-concurrenthashmap)以更好地了解其复杂性。

* * *

## 回答 #10

> 赞同：7
> 
> 时间：2011-11-24T07:32:19.363

这里有几个：

1) ConcurrentHashMap 只锁定 Map 的一部分，而 SynchronizedMap 锁定整个 MAp。
2) ConcurrentHashMap 比 SynchronizedMap 性能更好，可扩展性更强。
3）如果是多个阅读器和单个作者 ConcurrentHashMap 是最好的选择。

本文来自[Java 中 ConcurrentHashMap 和 hashtable 的区别](http://javarevisited.blogspot.com/2011/04/difference-between-concurrenthashmap.html)

* * *

## 回答 #11

> 赞同：7
> 
> 时间：2017-03-09T13:12:34.800

我们可以通过使用 ConcurrentHashMap 和 synchronisedHashmap 和 Hashtable 来实现线程安全。但是如果你看看他们的架构，就会有很大的不同。

1.  **同步Hashmap和Hashtable**

> 两者都将在对象级别保持锁定。因此，如果您想执行 put/get 之类的任何操作，则必须先获取锁。同时，不允许其他线程执行任何操作。因此，一次只能有一个线程对此进行操作。所以这里的等待时间会增加。与 ConcurrentHashMap 相比，我们可以说性能相对较低。

2.  **并发哈希映射**

> 它将保持段级别的锁定。它有 16 个段，默认保持并发级别为 16。所以一次可以有 16 个线程对 ConcurrentHashMap 进行操作。此外，读操作不需要锁。所以任意数量的线程都可以对其执行get操作。
> 
> 如果thread1想在segment 2上执行put操作，thread2想在segment 4上执行put操作，那么这里是允许的。也就是说，16 个线程一次可以对 ConcurrentHashMap 执行更新（放置/删除）操作。
> 
> 这样这里的等待时间就会减少。因此性能相对优于 synchronisedHashmap 和 Hashtable。

* * *

## 回答 #12

> 赞同：6
> 
> 时间：2015-12-19T03:39:09.593

**并发哈希映射**

*   ConcurrentHashMap 用于性能关键型应用程序，其中写入操作远多于读取操作。
*   它是线程安全的，无需同步整个地图。
*   使用锁完成写入时，读取可能会非常快。
*   在对象级别没有锁定。
*   锁定在哈希图存储桶级别的粒度要细得多。
*   如果一个线程尝试修改它而另一个线程正在对其进行迭代，则 ConcurrentHashMap 不会引发 ConcurrentModificationException。
*   ConcurrentHashMap 使用大量锁。
*   读操作是非阻塞的，而写操作对特定的段或存储桶进行锁定。

**同步HashMap**

*   对象级别的同步。
*   每个读/写操作都需要获取锁。
*   锁定整个集合是一种性能开销。
*   这实质上只允许访问整个映射的一个线程并阻止所有其他线程。
*   它可能会引起争用。
*   SynchronizedHashMap 返回迭代器，它在并发修改时快速失败。

**Collection.synchronizedMap()**

*   Collections 实用程序类提供了对集合进行操作并返回包装集合的多态算法。它的 synchronizedMap() 方法提供了线程安全的功能。
*   当数据一致性至关重要时，我们需要使用 Collections.synchronizedMap()。

[来源](http://crunchify.com/hashmap-vs-concurrenthashmap-vs-synchronizedmap-how-a-hashmap-can-be-synchronized-in-java/)

* * *

## 回答 #13

> 赞同：4
> 
> 时间：2009-02-04T09:36:25.937

ConcurrentHashMap 针对并发访问进行了优化。

访问不会锁定整个地图，而是使用更细粒度的策略，从而提高可伸缩性。还有专门针对并发访问的功能改进，例如并发迭代器。

* * *

## 回答 #14

> 赞同：4
> 
> 时间：2016-08-02T18:29:37.720

除了它提供的并发特性之外，还有**一个关键特性**需要注意，那就是**故障安全**迭代器。我见过开发人员使用只是因为他们想编辑入口集——在迭代它时放置/删除。 不提供**故障安全**迭代器，但它提供了**快速故障**迭代器。快速失败迭代器使用在迭代期间无法编辑的地图大小的快照。`ConcurrentHashMap`**`ConcurrentHashMap``Collections.synchronizedMap(Map)`**

 ******* * *

## 回答 #15

> 赞同：3
> 
> 时间：2012-10-29T10:29:28.610

1.  如果数据一致性非常重要 - 使用 Hashtable 或 Collections.synchronizedMap(Map)。
2.  如果速度/性能非常重要并且数据更新可能会受到影响 - 使用 ConcurrentHashMap。

* * *

## 回答 #16

> 赞同：2
> 
> 时间：2011-06-30T20:34:55.357

一般来说，如果你想使用`ConcurrentHashMap`确保你准备好错过“更新”
（即打印 HashMap 的内容并不能确保它会打印最新的 Map）并使用 API`CyclicBarrier`来确保整个程序的一致性生命周期。

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2016-02-14T13:48:27.670

Collections.synchronizedMap() 方法同步了 HashMap 的所有方法，并有效地将其简化为一个线程一次可以进入的数据结构，因为它将每个方法都锁定在一个公共锁上。

在 ConcurrentHashMap 中，同步的方式稍有不同。ConcurrentHashMap 不是将每个方法都锁定在一个公共锁上，而是对单独的桶使用单独的锁，因此只锁定 Map 的一部分。默认情况下，有 16 个存储桶，并且为不同的存储桶提供单独的锁。所以默认并发级别是 16。这意味着理论上任何给定时间 16 个线程都可以访问 ConcurrentHashMap，如果它们都将要分离的存储桶。

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2020-01-31T15:40:14.803

ConcurrentHashMap 作为并发包的一部分在 Java 1.5 中作为 Hashtable 的替代品出现。使用ConcurrentHashMap，不仅可以在并发多线程环境中安全使用，而且提供比Hashtable和synchronizedMap更好的性能，是您更好的选择。ConcurrentHashMap 性能更好，因为它锁定了 Map 的一部分。它允许并发读取操作，同时通过同步写入操作来保持完整性。

## ConcurrentHashMap 是如何实现的

ConcurrentHashMap 是作为 Hashtable 的替代品而开发的，它以附加的能力支持 Hashtable 的所有功能，即所谓的并发级别。ConcurrentHashMap 允许多个读取器同时读取而不使用块。通过将 Map 分成不同的部分并在更新中仅阻止 Map 的一部分，这成为可能。默认情况下，并发级别为 16，因此 Map 被拆分为 16 个部分，每个部分由单独的块管理。这意味着，如果它们与 Map 的不同部分一起工作，则 16 个线程可以同时与 Map 一起工作。它使 ConcurrentHashMap 高效，并且不会降低线程安全性。

如果您对 ConcurrentHashMap 的一些重要特性以及何时应该使用 Map 的这种实现感兴趣 - 我只是放了一篇好文章的链接 - [How to use ConcurrentHashMap in Java](http://poltora.info/blog/how-to-use-concurrenthashmap-in-java/)

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2017-10-22T10:03:55.763

除了建议的内容外，我还想发布与`SynchronizedMap`.

为了使`Map`线程安全，我们可以使用`Collections.synchronizedMap`语句并输入地图实例作为参数。

`synchronizedMap`in的实现`Collections`如下

```
 public static <K,V> Map<K,V> synchronizedMap(Map<K,V> m) {
        return new SynchronizedMap<>(m);
    } 
```

如您所见，输入`Map`对象被对象包裹`SynchronizedMap`。
让我们深入研究`SynchronizedMap`,

```
 private static class SynchronizedMap<K,V>
        implements Map<K,V>, Serializable {
        private static final long serialVersionUID = 1978198479659022715L;

        private final Map<K,V> m;     // Backing Map
        final Object      mutex;        // Object on which to synchronize

        SynchronizedMap(Map<K,V> m) {
            this.m = Objects.requireNonNull(m);
            mutex = this;
        }

        SynchronizedMap(Map<K,V> m, Object mutex) {
            this.m = m;
            this.mutex = mutex;
        }

        public int size() {
            synchronized (mutex) {return m.size();}
        }
        public boolean isEmpty() {
            synchronized (mutex) {return m.isEmpty();}
        }
        public boolean containsKey(Object key) {
            synchronized (mutex) {return m.containsKey(key);}
        }
        public boolean containsValue(Object value) {
            synchronized (mutex) {return m.containsValue(value);}
        }
        public V get(Object key) {
            synchronized (mutex) {return m.get(key);}
        }

        public V put(K key, V value) {
            synchronized (mutex) {return m.put(key, value);}
        }
        public V remove(Object key) {
            synchronized (mutex) {return m.remove(key);}
        }
        public void putAll(Map<? extends K, ? extends V> map) {
            synchronized (mutex) {m.putAll(map);}
        }
        public void clear() {
            synchronized (mutex) {m.clear();}
        }

        private transient Set<K> keySet;
        private transient Set<Map.Entry<K,V>> entrySet;
        private transient Collection<V> values;

        public Set<K> keySet() {
            synchronized (mutex) {
                if (keySet==null)
                    keySet = new SynchronizedSet<>(m.keySet(), mutex);
                return keySet;
            }
        }

        public Set<Map.Entry<K,V>> entrySet() {
            synchronized (mutex) {
                if (entrySet==null)
                    entrySet = new SynchronizedSet<>(m.entrySet(), mutex);
                return entrySet;
            }
        }

        public Collection<V> values() {
            synchronized (mutex) {
                if (values==null)
                    values = new SynchronizedCollection<>(m.values(), mutex);
                return values;
            }
        }

        public boolean equals(Object o) {
            if (this == o)
                return true;
            synchronized (mutex) {return m.equals(o);}
        }
        public int hashCode() {
            synchronized (mutex) {return m.hashCode();}
        }
        public String toString() {
            synchronized (mutex) {return m.toString();}
        }

        // Override default methods in Map
        @Override
        public V getOrDefault(Object k, V defaultValue) {
            synchronized (mutex) {return m.getOrDefault(k, defaultValue);}
        }
        @Override
        public void forEach(BiConsumer<? super K, ? super V> action) {
            synchronized (mutex) {m.forEach(action);}
        }
        @Override
        public void replaceAll(BiFunction<? super K, ? super V, ? extends V> function) {
            synchronized (mutex) {m.replaceAll(function);}
        }
        @Override
        public V putIfAbsent(K key, V value) {
            synchronized (mutex) {return m.putIfAbsent(key, value);}
        }
        @Override
        public boolean remove(Object key, Object value) {
            synchronized (mutex) {return m.remove(key, value);}
        }
        @Override
        public boolean replace(K key, V oldValue, V newValue) {
            synchronized (mutex) {return m.replace(key, oldValue, newValue);}
        }
        @Override
        public V replace(K key, V value) {
            synchronized (mutex) {return m.replace(key, value);}
        }
        @Override
        public V computeIfAbsent(K key,
                Function<? super K, ? extends V> mappingFunction) {
            synchronized (mutex) {return m.computeIfAbsent(key, mappingFunction);}
        }
        @Override
        public V computeIfPresent(K key,
                BiFunction<? super K, ? super V, ? extends V> remappingFunction) {
            synchronized (mutex) {return m.computeIfPresent(key, remappingFunction);}
        }
        @Override
        public V compute(K key,
                BiFunction<? super K, ? super V, ? extends V> remappingFunction) {
            synchronized (mutex) {return m.compute(key, remappingFunction);}
        }
        @Override
        public V merge(K key, V value,
                BiFunction<? super V, ? super V, ? extends V> remappingFunction) {
            synchronized (mutex) {return m.merge(key, value, remappingFunction);}
        }

        private void writeObject(ObjectOutputStream s) throws IOException {
            synchronized (mutex) {s.defaultWriteObject();}
        }
    } 
```

什么`SynchronizedMap`可以概括为向输入`Map`对象的主要方法添加单个锁。所有被锁保护的方法不能被多个线程同时访问。这意味着像`put`并且`get`可以由单个线程同时对`Map`对象中的所有数据执行的正常操作。

它现在使`Map`对象线程安全，但在某些情况下性能可能会成为问题。

实现上`ConcurrentMap`要复杂得多，具体可以参考[构建更好的HashMap](https://www.ibm.com/developerworks/java/library/j-jtp08223/index.html)。简而言之，它的实现同时考虑了线程安全和性能。

# google-maps - 创建美国动态热图的最简单方法

> ID：510636
> 
> 赞同：5
> 
> 时间：2009-02-04T09:23:53.857
> 
> 标签：google-maps, mapping, heatmap

感谢过去几天的所有帮助。我希望有人知道这个。

我希望根据用户输入动态创建数据热图，然后根据响应为某些状态着色。例如，投票投票。我想做这样的事情...... [http://www.trulia.com/home_prices/](http://www.trulia.com/home_prices/)

最简单的方法是什么？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-02-04T09:31:55.683

[Google Chart API](http://code.google.com/apis/chart/)也提供地图。

这是一个（完全虚构的）示例： ![替代文字](https://chart.apis.google.com/chart?cht=t&chs=440x220&chd=t:0,100,50,32,60,40,43,12,14,54,98,17,70,76,18,29&chco=FFFFFF,FF0000,FFFF00,00FF00&chld=ALCACOSCUTNMARILNMWIAKIAMDTNNDOH&chtm=usa&chf=bg,s,EAF7FE)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2011-02-21T17:07:22.477

另一个非常简单的解决方案是[OpenHeatMap.com](http://www.openheatmap.com)。它们支持将数据与各种地图形状挂钩，包括美国各州。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-04T09:31:46.133

[OpenLayers](http://openlayers.org/)是一个 javascript 库，用于在这些瓦片上显示​​瓦片地图和相关元素（多边形、线等）。

它支持许多地图数据的后端，包括谷歌的数据。

样品可[在此处获得](http://openlayers.org/dev/examples)

# html - 有没有很好的 XSL 预览工具？

> ID：510637
> 
> 赞同：7
> 
> 时间：2009-02-04T09:23:55.417
> 
> 标签：html, xslt, preview

我是 Perl 的 LAMP Web 开发人员，在我目前的位置，我们使用 Perl 来检索数据，将它们放入 XML 中，然后将 XML 传递给 XSL 文件。而这一切都由[全能的 AxKit](http://axkit.org/)神奇地处理。因此，您可能可以想象我的 XSL 充满了 XSLT 行，即`if test,@value`等。

我想知道是否有任何工具、IDE 等可用于打开 XSL 文件并检查 HTML 预览，而无需修改当前 XSL 中的任何内容？

只要能完成工作，我愿意接受建议。谢谢。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-04T14:08:09.697

*XSLT IDE*（交互式开发环境）：

*   **[XSelerator](http://sourceforge.net/projects/xselerator)**（我已经使用了 6-7 年的那个）。免费，具有 MSXML 调试器，具有 XSLT 1.0 和 XSLT 2.0 的智能感知。此外还有一些动态智能感知。调试器有断点、数据断点、可视化临时树、变量、测试条件、当前输出……等。
*   **[VS2008——](http://www.microsoft.com/visualstudio/default.mspx)**一个很好的 XML 编辑器 + XSLT 调试器。良好的静态智能。匹配模式是静态检查的。断点、数据断点、变量和当前输出的可视化。
*   **[氧](http://www.oxygenxml.com/)**
*   **[XML-SPY](http://www.altova.com/products/xmlspy/xml_editor.html) (Altova)**
*   **[手写笔工作室](http://www.stylusstudio.com/)**

*XPath 工具*：

**更新**：

由于 Lars Huttar 的热情好客，XPath Visualizer 的 IE 和 FF 版本现在都有一个新的、安全的家。下面的链接指向新的安全站点。

*   **[XPath Visualizer](http://www.huttar.net/dimitre/XPV/TopXML-XPV.html)** - 一个流行**的**基于 IE 的工具，用于通过玩 XPath 表达式[**来学习 XPath**](http://www.huttar.net/dimitre/XPV-Zip-2008.zip)和**[基于 FF 的工具。](http://www.huttar.net/dimitre/XPV-FF.zip)**免费和开源。允许针对给定的 XML 文档评估任何 XPath 表达式，并在 xml 文档（如果它们是节点）或单独的框中（如果结果是原子值）中高亮显示结果。允许定义 xsl:variable-s，然后在 XPath 表达式中使用。允许定义 xsl:key-s，然后由 XPath 表达式中的 key() 函数引用。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-04T09:46:24.810

我目前正在使用 Visual Studio，在 Visual Studio 中打开您的 xml 文件，从 XML 菜单单击显示 xslt 输出。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-04T09:46:37.103

我发现[Stylus Studio](http://www.stylusstudio.com/)是满足我所有 XML 需求的宝贵工具。不过，我从来没有用过粗酒。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-04T09:56:27.583

我使用免费的炉灶面。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-04T10:11:22.310

试试微软[XML 记事本](http://www.microsoft.com/downloads/details.aspx?familyid=72d6aa49-787d-4118-ba5f-4f30fe913628&displaylang=en)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-07-23T18:31:57.383

我正在使用 Visual Web Developer 2008 Express Edition...在我的 XML 菜单下，当我打开一个 XSL 文件时，我看到的只是“Schemas...”。我是否错过了为其他选项安装组件？

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-06-23T22:22:35.813

一些尚未提及的替代方案：

*   [**XML Copy Editor**](http://sourceforge.net/projects/xml-copy-editor/) - 好的，但需要一个中间步骤来生成 HTML，然后在外部浏览器中打开 HTML。
*   [**WMHelp XMLPad**](http://www.wmhelp.com/download.htm) - 许多小错误和烦恼，但在其他方面非常有用：可以在 IDE 中查看和调试转换。

我写了一篇文章来描述这些和其他一些工具，以防有人感兴趣：[*如何测试 XSL 转换*](http://alekdavis.blogspot.com/2009/06/how-to-test-xsl-transformations.html)。

# testing - 在小型商店中对服务器应用程序进行负载测试（即模拟大量客户端）的推荐策略是什么？

> ID：510646
> 
> 赞同：4
> 
> 时间：2009-02-04T09:29:44.110
> 
> 标签：testing, virtualization

我开发了一个基于网络的多组件软件系统，旨在在任意数量的机器上运行。我假设典型设置为 1 到 4 台机器。

我想认真地测试系统，我已经在一台强大的 PC 上建立了一个虚拟机网络，我可以用它来模拟网络交互。但是，该设置还不够。

例如，由于虚拟化（我使用 qemu），每个节点总是只在一个内核上运行，所以我无法在为多核使用而设计的代码上测试性能问题。如果我有时可以在整个 PC 上运行任何一个虚拟机，看看它有什么不同，尤其是在性能方面，以及检查一些多线程问题，那就太好了。

购买更多的机器并使用硬盘分区而不是虚拟磁盘映像是选项，但有更优雅的方法吗？我在这里创办了一家公司，但实际上还买不起大量的硬件，而且不得不为每台机器处理真实的物理媒体，而不仅仅是移动图像文件，这肯定是更多的工作。

**ETA**：应用程序是一个中间件系统，并没有真正的用户界面。测试是通过虚拟客户端完成的，并将数据输入到另一端再次提取的系统中。它不是网站，通常不在 Internet 上使用，而是在本地网络中使用。UI 和 Internet 界面将在稍后阶段由连接到系统的一些组件提供。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-04T10:30:24.160

到目前为止，这个话题已经在 SO 上出现过几次：

*   [你用什么来测试你的网络服务和它的自定义协议？](https://stackoverflow.com/questions/434438/what-have-you-used-to-test-functional-load-stress-your-network-service-with-its).
*   [负载测试/压力测试 Web 服务](https://stackoverflow.com/questions/351938/load-test-stress-test-web-services)
*   [对网站进行压力测试的最佳方法](https://stackoverflow.com/questions/340564/best-way-to-stress-test-a-website)
*   [您如何测试网站的性能？](https://stackoverflow.com/questions/53738/how-do-you-test-the-performance-of-a-website)

有许多工具可以进行网络压力测试，但您可能需要调整它们以修复您的网络配置。例如，我正在做一个做很多流媒体的项目，所以我们必须编写自己的流媒体客户端来测试网络。

另一件事是您可能需要建立一个小型网络来测试您的生产网络——网络负载测试工具也需要相当多的 CPU，因此您通常需要多台机器同时运行它们才能真正运行网络。在我们的例子中，我们有一个 1:2 的比率——也就是说，我们要测试的每 2 台服务器对应 1 个测试客户端。您将不得不尝试一些事情来确定您需要多少个测试盒，但只需关注您的测试机器的性能，这样您就可以了解您需要多少个才能有效地进行基准测试您的网站。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-04T23:04:26.133

我建议使用[VMware Workstation](http://www.vmware.com/products/ws/)，它使您能够为 VM 配置多个处理器。单个许可证非常便宜，您可以使用[VMware Server](http://www.vmware.com/products/server/)（免费），但我认为 Workstation 在短期内会更强大。

此外，我建议您使用第二台能够从 USB 启动的 PC，您可以在其上存储物理 VM 分区。一台低端双核 PC 并不昂贵，特别是如果它只需要启动到文本模式。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-02-04T10:10:54.603

您可以聘请某人（也许是远程）来执行测试。如果您聘请远程工作者，您将能够测试您的应用程序在 Internet 上的运行情况

# .net - 用于写入/读取文件柜 (.cab) 文件的托管代码库

> ID：510648
> 
> 赞同：3
> 
> 时间：2009-02-04T09:30:30.100
> 
> 标签：.net, api, cab

我正在寻找一个托管代码库/API 或示例，让我可以编写和读取cabinet (.cab) 文件。这里有一个 CAB SDK：http: [//support.microsoft.com/kb/310618](http://support.microsoft.com/kb/310618)但它附带的 DLL 仅支持本机代码。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-04T09:34:10.687

[这](http://www.codeproject.com/KB/files/CABCompressExtract.aspx)是带有 c++ 和 .net 版本的代码项目文章。

玩得开心

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-04T09:34:01.170

可以使用 CAB SDK 中的平台 Invoke 吗？如果可以的话，您可以支持本机代码。

# java - JGoodies 绑定与 JSR 295

> ID：510655
> 
> 赞同：14
> 
> 时间：2009-02-04T09:33:01.700
> 
> 标签：java, binding, javabeans

JGoodies Binding 和 JSR 295，Beans Binding 之间的实际区别是什么？他们似乎都出于相同的目的并完成了工作（方法略有不同）。JGoodies Binding 更加成熟，但 JSR 295 最终在 Java 7 中成为 JDK 的一部分。

使用 JDK 的标准部分肯定比为同一功能使用单独的库更好，但是还有其他因素需要考虑吗？还有其他选择吗？在这些之间进行选择是非常不可逆转的架构决策......

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-02-04T11:42:12.517

只需使用 JGoodies，因为它成熟且有效。JGoodies 框架中肯定有一些想法被合并到 JSR 中，但由于目前还没有，所以选择有限。

目前的状态似乎是 JSR 甚至不会进入 JDK 7，所以我们必须等待 JDK 8。Alex Miller 有一个很棒的页面，它提供了一个很好的概述，介绍了 jdk7 中哪些东西会进入，哪些不会. [http://tech.puredanger.com/java7](http://tech.puredanger.com/java7)

Beans Binding 有一个红色的 NO，所以...

万岁，JGoodies。

干杯

# rad - 有哪些 RAD 工具？

> ID：510664
> 
> 赞同：42
> 
> 时间：2009-02-04T09:35:50.307
> 
> 标签：rad

我们都知道这个练习：你有一个（小）模型，你需要持久化它，你需要一个 UI（网络、桌面、移动设备，其中一些，全部）。

这是一个如此重复的过程，我不禁想知道为什么我们仍然坚持使用 POJO、OR 映射器和手工编写 UI（因为大多数 UI“设计师”甚至不知道继承，你需要构建每个从头开始包含多个字段的确定/取消对话框）。[RAD](http://en.wikipedia.org/wiki/Rapid_application_development)工具/平台承诺会解决这个问题，但我还没有看到任何真实的东西。这个 wiki 的想法是收集所有工具，让您在几分钟内充实一个想法并从那里构建。简单的事情（例如为模型创建简单的 UI 或将其保存在数据库中）应该很简单。将一个相当复杂的对象附加到对话框以对其进行编辑应该只需要一行代码或更少；）

所以挑战来了：有哪些 RAD 工具可以在 8 小时内构建一个小型应用程序。为了让您了解它应该能够做什么，这里是规范：

*   你有“知识”节点。每个这样的节点都有名称和附加的详细描述（单行和多行字符串）

*   每个知识节点可以有任意数量的知识节点作为子节点（1:* 排序的父/子关系）。子节点需要维护顺序（即使用列表，而不是集合）

*   每个知识节点可以附加任意数量的标签（1：*不同类型之间的无序关系）

*   任意两个知识节点可以连接任意数量的关系（n:m 关系）

*   应该可以毫不费力地从/作为 XML 和从/在数据库中加载/保存模型

*   用户希望今天撤消/重做

UI 应提供标准操作：创建、重新排序和删除知识节点。重新排序应使用拖放。它应该允许从知识节点添加/删除标签。应该有一种简单的方法可以通过关系连接两个知识节点（比如以特殊模式将一个节点拖到另一个节点上）。

UI 还应该允许搜索具有特定标签或关系的节点。对于奖励积分，它应该提供一种导航关系图的简单方法。

有什么挑战吗？像往常一样，首选[OSS 。](http://en.wikipedia.org/wiki/Open-source_software)

背景：我现在开发软件已经超过 25 年了。尽管如此，这个简单的应用程序需要数周甚至数月的时间来使用我迄今为止遇到的任何语言进行编码：[Groovy](http://groovy.codehaus.org/)、[Java](http://java.com/)、[Python](http://www.python.org/)、[Tcl/Tk](http://www.tcl.tk/)、[Grails](http://grails.org/)、[OpenOffice](http://www.openoffice.org/)、[MS Access](http://office.microsoft.com/access)、[TreeLine](http://treeline.bellz.org/)、[TurboGears][10]、 [思想特征][11]，.net。

关于竞争者的一些反馈。请注意，我试图在一个句子中突出重点，所以下一节要持保留态度，好吗？

**Groovy**语言不错，代码紧凑。关闭但缺乏 UI 部门。他们正在努力，但只是不在那里。对于持久性，只有开箱即用的 Java 序列化。

**Java** Java 在十年前问世时很棒，但它并没有发展太多。它是一种老化的语言，拥有大量的库，但你只需要太多的代码来完成工作，而且每一行代码都需要时间来编写。

**Python**几乎得到了它需要的所有东西，但由于某种原因，它从未真正成为像 Java 这样的主流。[使用PyQt4](http://www.riverbankcomputing.co.uk/software/pyqt/download)设置了一个不错的 UI ，这是一个带有[SQLAlchemy](http://www.sqlalchemy.org/)的很酷的 OR 映射器，但我们仍然没有看到它在全速前进。只有随着单元测试的出现，编写更大的项目才变得可行。任务级别太低。

**Tcl/Tk**不错的小部件集，但是当代码大小超过某个点时，语言很糟糕。现在显示它的年龄。

**OpenOffice**从 2.0 开始，OO 带有一个内置数据库和一个“Access-like”工具。它还处于起步阶段，但他们会到达那里......最终。无法处理父/子关系，因为 UI 不允许指定它们（[请参阅错误](http://www.openoffice.org/issues/show_bug.cgi?id=89456)）。在 3.1 中修复。使用 3.1，您可以创建模型，但编写 UI 仍然需要大量时间。

**MS Access**几乎我们需要的任何东西，但 UI 选项非常有限。令人沮丧。

**TreeLine**无法实现关系，并且对于大多数其他用例来说过于受限（你根本无法用它做很多其他事情）

**.net**我没有这方面的经验，主要是因为它只是 Windows。我认为这个可能非常接近，但让我们面对现实：锁定四分之一的人类有什么意义？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-02-04T10:43:27.863

用于 pascal/delphi 语言的[Delphi RAD Studio](http://www.codegear.com/products/radstudio)和[Lazarus IDE 。](http://www.lazarus.freepascal.org/)

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2011-09-24T06:40:11.047

[WAVEMAKER](http://www.wavemaker.com/)是有史以来最好的 rad 工具。您所说的可以在几个小时内完成。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-02-04T09:43:18.343

这取决于你的市场是谁。我可以告诉你一件事，你的市场永远不会包括全人类。因此，地球上可能有 25% 的人不使用 Windows 的事实对您来说并不重要。

*对您而言，重要的是您的市场中*有多少人使用任何操作系统？如果您正在编写商业/金融应用程序并且只为 Windows 开发，那么您可能只遗漏了大约 0.05% 的市场（因为您最后一次听说使用 Mac 或 Linux 的会计师是什么时候？ ）。

但是，如果您正在编写一个用于制作音乐的程序（如 FruityLoops）并且只编写 Windows，那么您可能会遗漏 50% 的市场份额。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2010-08-04T07:47:21.940

[微软灯开关](http://blogs.msdn.com/b/jasonz/archive/2010/08/03/introducing-microsoft-visual-studio-lightswitch.aspx)。很难想象有什么“更快”的。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-02-04T10:45:58.170

我猜[WinDev 也](http://www.windev.com/)遵循 RAD 的想法。

注意：仅在 Windows 上运行，价格从 990 欧元起。附带多种工具。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-02-04T13:12:45.050

Visual Studio - 最好的 RAD 工作室。如果你认为它不仅用于微软的开发工具，Delphi Prism 也使用它，SQL Server 的 SQL 管理工具都使用它，你就会知道它的灵活性。它也是免费的（RAD 工具/IDE - 不是开发工具）。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-02-04T09:42:37.923

[Magic uniPaas](http://www.magicsoftware.com/2559-en/uniPaaS.aspx)：在我的第一份工作中使用它来开发 GUI。这是一个严肃的 RAD 工具，所有内容都是基于表格的。它还提供了一个运行时环境。当时它被称为 Magic eDeveloper。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2009-02-04T15:57:04.907

号角（[http://softvelocity.com](http://softvelocity.com)）。

我可以/可以在几个小时内为这样的项目制作一个演示。

一个透视缺陷是它创建了 Win32 可执行文件。当然，这可以通过用它创建一个网络系统来解决。

另一个是 Clarion 绝对不是开源的。这会让很多人望而却步。

* * *

好的。我的最后一条评论是大约 2 小时前。所以在那段时间里，这就是我在 Clarion 中设法完成的事情。

~~[http://125.214.67.190:5824/](http://125.214.67.190:5824/)~~

我写这个不是为了炫耀。老实说，我相信 Clarion 可以在很短的时间内做出惊人的事情。

“知识”系统在很大程度上是一个演示。您只能将标签和关系添加到父节点。没有适当的标签/关系搜索（只有单数）。没有图像或像样的图形设计或 UI。

但是框架，基础是存在的。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2011-01-11T11:14:38.910

**Oracle Application Express** ( [http://htmldb.oracle.com/pls/otn/f?p=4600:6:171781307324519::NO:::](http://htmldb.oracle.com/pls/otn/f?p=4600:6:171781307324519%3a%3aNO%3a%3a%3a) :)

***仅使用 Web 浏览器***和***有限的编程经验***，您就可以在几分钟内开发以数据为中心的应用程序。基于浏览器的开发使您能够仅使用现代 Web 浏览器在大多数计算机上开发应用程序。

***使用简单的向导和声明式编程***来创建功能强大的报告和数据输入应用程序。您可以从电子表格上传或现有数据库表和视图创建应用程序。Oracle Application Express 包括用于创建和管理支持您的应用程序的数据库对象的 SQL Workshop。

使用 Application Express，***编码是声明性的***。这意味着不会生成或编译任何代码。您与向导和属性表进行交互。由于 SQL 语言用于定义报表和图表，因此了解一些 SQL 知识是有帮助的。如果需要过程逻辑，您可以使用 PL/SQL 编写代码片段。声明式代码在开发人员之间产生的差异更少，这种一致性使 Application Express 应用程序易于维护和管理。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-05-01T20:01:17.290

[Lazarus LCL](http://www.lazarus.freepascal.org/) is a Delphi like VCL over existing widget sets.

It can be GTK1, GTK2, QT, Win32/64, WinCE and Carbon. There are others (like a COCOA bridge) but those are mostly only in their initial stages.

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-02-04T09:48:39.017

[REALbasic](http://www.realsoftware.com/realbasic/)是一个 RAD 工具工具 - 它的编译器生成本机可执行文件。它也是一个交叉编译器，这意味着您可以从任何平台构建任何平台。

仅专业版支持完全数据库访问（400 欧元）。个人版售价 75 欧元，可以连接到 REALSQLDatabase（也来自 RealSoft）。

与[Hibernate](http://www.hibernate.org/)或[SQLAlchemy](http://www.sqlalchemy.org/)不同，您必须自己编写 DB 层。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2009-02-04T13:07:24.873

Netbeans 的 Matisse 可视化编辑器非常适合 Swing 开发。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2009-02-04T13:37:13.580

[Grails](http://grails.org/)是一个快速构建 Web 应用程序的框架。它基于[Groovy](http://groovy.codehaus.org/)。您定义模型，从命令行运行两个命令，然后设置一个简单的[CRUD](http://en.wikipedia.org/wiki/Create,_read,_update_and_delete) UI，您可以在 Web 浏览器中编辑模型。

[仅限 Web，有很多好主意，但由于这个错误](http://jira.codehaus.org/browse/GRAILS-3126)，您不能有父/子关系，希望在 1.0.5 版本中修复。对于认真的开发，您将需要[AJAX/Rich Client 插件](http://grails.org/Plugins)之一，因为 Grails 没有非常强大的小部件。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2012-03-01T10:41:45.210

[来自 ++Technologies 的XPower++](http://gridplusplus.com/index.jax?page=xpower) - 适用于 Windows、Linux、Mac、Android、iOS 等的跨平台 IDE。

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2010-01-15T19:24:15.387

Qt Toolkit，位于：http: [//qt.nokia.com/products](http://qt.nokia.com/products)，用于 C++ 跨平台 GUI 开发，也非常适合桌面和移动应用程序构建。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2009-02-04T09:45:21.303

该答案与您的问题没有直接关系，但相似。对于我的项目，我使用的最接近的东西是[NEsper](http://esper.codehaus.org/about/nesper/nesper.html)，它是一个开源复杂事件处理框架 (CEP)。在过去的两个晚上，我为我正在组装的交易系统构建了一个回测器，正是 NEsper 让它如此之快——我想我是在你的 8 小时目标内完成的。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2009-02-04T13:40:14.433

[TurboGears](http://turbogears.org/)是一个使用 Python 快速构建 Web 应用程序的框架。主要特点：您定义模型，TG 创建所有其他内容，然后可以根据您的需要进行调整。模型中的更改需要重新启动开发服务器，其他一切都在下次重新加载 Web 浏览器时发生（TG 会通知您何时需要重新启动）。

向前迈出了一大步，尤其是 2.0 版本（应该“很快，现在”就发布了——没有冒犯，伙计们，我知道你们已经为此努力了好几年……但几年来我没有 TG 2.0 , 或者 :( ) 仅适用于 Web。所以我们必须自己实现所有的拖放操作，找到一种方法来绘制可导航的图表。令人沮丧的关闭。

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2009-02-04T13:44:56.060

[Enthought Traits](http://code.enthought.com/)是一个很棒的框架，可以从模型构建默认 UI。易于使用，功能强大，默认情况下是您大部分时间想要的，它可以满足您的期望

但是没有数据库持久性。事实上，根本没有坚持。您必须自己编写代码来保存/加载模型。对 XML 执行此操作非常简单（有一个抽象 API 可用于模型中的任何对象），因此无论您的模型多么复杂，您只需要编写一个类，例如 50 行代码。

UI 控件不容易扩展，所以如果你需要一些不附带的东西，祝你好运。

上面提到的模型可以在一个小时内实现，另一个小时从 XML 读取/写入它。使用 Qt 中的画布小部件，关系的图形导航将需要几天时间。

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2009-02-04T14:14:09.763

[Panther](http://www.prolifics.com/panther.htm)（和它的 OSS 版本[POSSL](http://sourceforge.net/projects/possl/files/)）似乎是一个构建 Web 应用程序的框架。我无法安装它，因为它只带有一个 Unix shell 脚本作为安装程序。有其他人有这方面的经验吗？那么请编辑此条目。

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2009-02-04T14:29:45.673

我认为[nbandroid](http://kenai.com/projects/nbandroid/)值得一提。它是使用 NetBeans IDE 开发 Google Android 软件的 RAD 工具。

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2009-05-07T14:31:57.017

[Visual DataFlex](http://visualdataflex.com "Visual DataFlex")是我们使用的一个很棒的 RAD 工具。它专门针对创建数据库驱动的业务应用程序。不幸的是，它不是免费的，但它是一个很棒的环境/语言，并且[数据访问](http://www.dataaccess.com/ "数据访问")提供了很好的支持。

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2010-08-21T04:52:39.010

[DragonRAD](http://www.dragonrad.com/)刚刚宣布用于黑莓应用程序开发。目前处于封闭测试阶段。

* * *

## 回答 #23

> 赞同：-1
> 
> 时间：2009-02-04T14:04:00.250

[Boa Constructor](http://boa-constructor.sourceforge.net/)是一个跨平台的 Python IDE 和 wxPython GUI Builder。

它在 Wikipedia 上被列为跨平台 RAD，但我猜它更像是一个 IDE（而不是您可以在几个小时内构建上述应用程序的东西）。

# smtp - 从 Web 服务器发送电子邮件以减少退信和垃圾邮件块的最佳方式是什么？

> ID：510669
> 
> 赞同：3
> 
> 时间：2009-02-04T09:36:55.920
> 
> 标签：smtp, email-spam

我有一个向世界各地的客户发送电子邮件（来自 IIS 5.1）的 Web 服务器。我发现有时电子邮件会在有效地址上被退回，或者它们永远不会到达，或者被视为垃圾邮件。

我正在考虑使用外部 SMTP 服务。

这会有帮助吗？还有其他方法/提示吗？

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-04T09:42:21.357

在处理垃圾邮件过滤器时，使用正确维护的 SMTP 服务[1] 可能[2] 避免许多问题。

要获得更具体的帮助，您必须描述特定的错误消息，发布带有标题和退回消息的示例邮件。[而且，您应该在http://serverfault.com](http://serverfault.com)上这样做，这是解决此类问题的更好社区。

[1] 即具有适当的 DNS 记录、不做鼠软件、创建适当的标头并且不在任何 DUL 或 RBL 上的设备。

[2] 当然，如果您触发基于内容的过滤器，它也无济于事。

# vba - 将范围值与查找一起使用

> ID：510674
> 
> 赞同：0
> 
> 时间：2009-02-04T09:38:02.580
> 
> 标签：vba, excel

我正在使用 .Find 查找字符串，但我要搜索的单元格中有公式；我想在这些公式的结果中进行比较。到目前为止，我有：

`cellrow = Range("A1:D4").Find("string").Row`

但除非任何单元格中存在真正的文本“字符串”，否则它将返回错误。如何修改它，以便它在我指定的范围内查找每个单元格的值？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-04T09:52:40.960

知道了。.Find 中有一个属性可让您查找范围的公式或值。：LookIn

# c - 我可以在 C 编程中使用乘法和除法来移位吗？

> ID：510681
> 
> 赞同：2
> 
> 时间：2009-02-04T09:40:42.980
> 
> 标签：c, bit-shift

代替使用`>>`和`<<`移位，是否可以使用`*`和`/`左右移位？

对于 8 位：0x01 * 2 = 0000|0010。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-02-04T09:45:52.487

您当然可以（对于整数数学）使用乘以 2 进行左移，并使用除以 2 进行右移。

你不应该这样做。

有非常好的左移和右移运算符，它们“完全按照他们所说的那样做”。为什么要让您的编译器或其他阅读您的代码的人感到困惑？

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-02-04T09:50:59.200

你可以，但你为什么要这样做？移位操作是 CPU 可以最快完成的事情之一。

实际上，通常建议相反作为性能优化：使用移位来实现 2 的幂的乘法/除法。

但是任何半体面的编译器都会为你做这件事，所以你绝对不应该手动做：保持你的代码清晰是最重要的，所以如果你在做数学，使用乘法和除法，如果你使用位移位'重新操作位。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-02-04T09:50:53.663

除了进行位操作外，您应该避免在所有情况下进行移位。写 << 而不是 * 2 会使代码不那么易读。除非您明确需要，否则不要使用位移位。

编译器无论如何都会优化`*2`^(n 。)`<<`

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-02-04T09:43:29.247

您可以，但是将其优化为实际的位移位将是一个智能编译器！另外，如果你的意思是“转变”，你最好写 <<。当你的意思是“乘”时，写 *.

请注意，浮点根本不会移动：它们的指数只会增长。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-02-04T10:18:49.130

是的，除了一个问题：在处理负数时，除法的工作方式*可能*与右移不同。负数右移的行为是编译器定义的。

您当然可以通过使用无符号整数来避免这个问题。

正如其他人所说，无论您使用移位还是乘法/除法，现代编译器都可能产生相同的输出。因此，请使用使代码更易于遵循和维护的任何内容。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-04T09:45:02.317

是的你可以。以你为例：

```
int main() {
  if ((1*2) == (1 << 1)) printf("you certainly can!\n");
  else printf("doesn't work that way\n");
} 
```

它产生的输出：

```
you certainly can! 
```

请参阅对此回复的评论，了解为什么我们同意 (0x01*2 == 0000|0010) 比 ((1*2) == (1 << 1)) 更成问题，这是一个更简洁的版本。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-02-04T09:51:25.657

你可以，

```
x << 1 == x * 2
x << 2 == x * 4
etc... 
```

反过来

```
x >> 1 == x / 2
x >> 2 == x / 4
etc... 
```

尽管我认为经验丰富的 c 程序员应该能够查看位移操作并知道这两种方法是相似的。考虑到选择，我总是会使用位移，因为很清楚你的意图是什么。如果您确实使用了乘法/或除法选项，您显然需要评论为什么突然将值乘以看似随机的数字。而位移清楚地记录了您正在尝试位移位。

至于任何优化注释，除非*绝对*必要，例如时间要求严格的嵌入式编程，否则我不会过分担心代码的优化。代码可读性和可维护性应该是您的重点，而不是优化！如果在开发结束时，您需要更高的性能，您可以随时返回并进行优化（确保您仔细记录您所做的一切！）。但是在开发过程中，我会选择最容易阅读和维护的东西，例如使用'<<' / '>>'。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-02-05T14:25:37.613

是的，您总是可以用 2 次乘法的幂来替换班次，但正如已经指出的那样，为什么？没有被指出的是，有时用移位代替乘法是有用的，而不仅仅是简单的 2 的幂。例如，在 320 * 200 像素缓冲区的好日子里，像素字节的偏移量是 y* 320+x。这可以按如下方式完成：

```
int OffsetXY( int x, int y)
{
    int offset;

    y <<= 6;
    offset = y;
    offset += y << 2;  // offset = original y * 320
    return offset + x;
} 
```

虽然这种类型现在对大多数开发人员来说只是学术兴趣，但它在嵌入式世界中可能很有用（最近在 DS 上做了一些编码，这种东西很有用）。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-02-04T13:23:31.050

所有其他人都说这是完全有可能做到的。这也是没有意义的。如果你的意思是转移，那么转移。如果你的意思是相乘，那就相乘。不要将代码的读者与无用的“优化”混淆。

除了问题：

您的编译器将查看任何整数乘法/除以一个常数，并将表达式减少为几乎所有时间的一系列移位/加法操作。这样做是因为二进制乘法不是一件容易的事，而且它比移位和加法花费的时间要长得多，一旦它们被传递到 ALU 就可以在一个时钟周期内完成。有趣的是，CPU 中的整数乘法器大致相似，但是以自动化的方式 - 使用单独的移位/加法操作仍然稍微快一些，因为您不需要停止并测试您正在执行的每个移位级别的条件。

我可以在这里为你起草基本算法，但现在快午夜了，所以你可以用谷歌搜索它。如果有足够的需求，我会编辑帖子并在明天发布。

这种优化尤其适用于乘以 2^n 变量的常数，因为它是单次移位操作。

# shell - 管道时，Awk 似乎断开了我的 DB2 会话

> ID：510697
> 
> 赞同：0
> 
> 时间：2009-02-04T09:43:21.010
> 
> 标签：shell, scripting, awk, db2, ksh

我正在尝试在 KornShell (ksh) 中运行以下命令：

```
set -A INDEXES `db2 "describe indexes for table ${TABSCHEMA}.${TABNAME} show detail" | awk '{print $1"."$2}'` 
```

我试图实现的是将特定表上的索引列表放入一个数组中，稍后我可以遍历该数组。

问题是，当我运行上述命令时，数组的内容以“SQL1024N”的错误消息开头（这告诉我数据库连接不存在）。

但是，如果我这样删除`awk`语句末尾的 ：

```
set -A INDEXES `db2 "describe indexes for table ${TABSCHEMA}.${TABNAME} show detail"` 
```

它工作得很好（嗯，在某种程度上它正在返回数据。显然没有`awk`我没有捕获正确的数据）。

有谁知道为什么`awk`会有这种影响？

我很欣赏有不止一种方法可以获取这些数据，但它让我困惑为什么会发生这种情况。

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-04T10:19:21.263

我怀疑它本身就是 awk 。也许 db2 对连接到 tty 或控制台的标准输出特别感兴趣？或者至少不喜欢它连接到管道时。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-19T20:15:40.323

在这种情况下，当 DB2 CLP 说它没有连接到数据库时，这是因为 shell 打开了一个子进程，该子进程需要自己的专用 db2bp 后端进程，它无法访问原始 shell 进程打开的连接。并不是什么东西断开了，而是一个新创建的 shell 进程（及其伴随的 db2bp 进程）正在创建，但没有被告知连接到数据库。解决此问题的一种方法是在您知道自己处于其中一种情况时显式连接（或重新连接）到数据库。

```
set -A INDEXES `db2 connect to watevrDB >/dev/null;db2 -x describe indexes for table ${TABSCHEMA}.${TABNAME} show detail | awk {'print $1"."$2'}` 
```

I realize that this question is more about scripting and awk with DB2 than about the system catalog, or else I would have recommended some straightforward catalog queries to produce the same result.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-04T18:44:00.777

这是一个不寻常的问题，正如 Pez 所说，这可能是一个 db2 怪癖。

例如，在 db2 命令字符串之前使用 time 或 timex 时，我看到了类似的问题，其中 db2 没有定义的数据库要连接到。

有一个环境变量 DB2DBDFT 为隐式连接设置默认数据库。很抱歉，我不确定此变量是否可供非 DBA 用户使用（假设您是应用程序开发人员）。如果通过以下方式设置此变量，则值得研究：

db2set DB2DBDFT=${your_db_name}

并重试您的查询。

如果您的环境可以连接到多个数据库，那么您可以在完成工作后取消设置 DB2DBDFT 变量。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-11T13:17:39.697

尝试带有 -x 开关的 db2 命令：

`db2 **-x** "describe indexes for table ${TABSCHEMA}.${TABNAME} show detail"`……

我遇到过这样的情况，这解决了我无法通过管道输出到 awk 的问题。

# .net - .NET 远程处理教程

> ID：510709
> 
> 赞同：1
> 
> 时间：2009-02-04T09:48:02.763
> 
> 标签：.net, remoting

我一直在寻找一些关于 .NET 远程处理（旧式 MarshallByRef）的不错的教程，并且遇到了一些，但没有什么令我满意的。有谁知道周围有什么像样的教程吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-04T09:55:15.823

查看一个也是唯一的 Ingo Rammer 的[.NET Remoting FAQ](http://www.thinktecture.com/resourcearchive)。这些信息可能有些过时，因为 .NET Remoting。

这是一个名为[.NET Remoting 简介](http://www.ilmservice.com/twincitiesnet/Presentations/RemotingIntro.ppt)的 PowerPoint 演示文稿，可帮助您了解使用图形/图形进行远程处理的基本概念。

最后，如果您在配置远程处理时经常在 app.config 文件中迷失（像我一样），这里是来自 MSDN 的[远程处理设置架构。](http://msdn.microsoft.com/en-us/library/z415cf9a(VS.80).aspx)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-04T09:56:41.530

我知道你可能想要一些在线的东西，但是我从 Ingo Rammer 的书[Advanced .Net Remoting](https://rads.stackoverflow.com/amzn/click/com/1590590252)中学到了这些东西，它非常详细、深入且可读。

虽然这都是 .Net 1 的东西（2002 年 4 月），所以它可能已经过时了，而且这些天可能有更好的资源。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-04T09:56:49.640

请检查
[.NET Remoting](http://www.developer.com/net/cplus/article.php/1479761)
http://msdn.microsoft.com/en-us/library/kwdt6w2k(VS.71).aspx">MSDN - .NET Remoting Overview

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-11-12T09:29:44.843

以下是我自己在搜索此主题时收藏的相关文章：http: [//delicious.com/dreikanter/remoting](http://delicious.com/dreikanter/remoting)第一篇是最全面的。

（我尝试在此处复制这些链接，但垃圾邮件预防机制将最大链接数限制为每个帖子一个 :)

# crystal-reports - 如何在水晶报表中从组中找到第一条记录？

> ID：510712
> 
> 赞同：5
> 
> 时间：2009-02-04T09:49:56.567
> 
> 标签：crystal-reports

如何在水晶报表中从组中找到第一条记录？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-03T07:34:20.153

您可以在公式中使用 Previous(Group_Field) 函数来指示组的开始。在线公式函数帮助提供了一个示例。基本上，您会看到要分组的字段的先前值是否与当前值不同。如果是，那么您刚刚开始了一个新组。

```
If Previous ({table.GroupingField}) = ({table.GroupingField}) Then 
    False
Else
    True 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-08-25T16:18:29.537

打印组标题时，您位于组中的第一条记录上。有时你可以在那里完成工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-18T19:23:12.063

```
 Previous ({ItemNum}) = ({ItemNum}) 
```

这将隐藏显示组中的第一条记录 ItemNum，并隐藏其余的直到下一个不同的 ItemNum。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-06-09T10:07:52.837

您可以使用：NthSmallest (1, {yourField},{theGrouping}) 或 NthLargest (1, {yourField},{theGrouping})

奇迹般有效

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-03-23T14:05:16.793

要确定组中的第一个子组，您可以使用 Previous 但这不会显示第一个子组，因此请使用以下命令：

```
if GroupNumber = 1 Then 
"This is first group in subgroup" 
else 
if Previous({Group1}) <> {Group1} Then 
"This is first group in subgroup"
else 
"This is NOT the first group in subgroup" 
```

# .net - 如何从 .NET 中的图标文件中提取特定图像？

> ID：510717
> 
> 赞同：4
> 
> 时间：2009-02-04T09:52:24.907
> 
> 标签：.net, image, gdi+, icons

图标文件 (*.ico) 可能包含多个不同大小和不同颜色深度的图像。

如何`System.Drawing.Image`从`.ico`文件中获取对象？

一种选择是`Image.FromFile(...)`，但对于具有多个图像的图标文件，无法指定要返回的图像大小和颜色深度。

理想情况下，该解决方案将仅使用托管代码，但我也很高兴听到有关 Win32 函数的互操作调用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-21T11:08:26.863

简单回答您的所有问题：[IconLib](http://www.codeproject.com/KB/cs/IconLib.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-04T09:55:29.020

System.Drawing.Icon 可以从文件加载指定大小。不过，我不知道深度。 [http://msdn.microsoft.com/en-us/library/ms142130.aspx](http://msdn.microsoft.com/en-us/library/ms142130.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-05T21:53:32.367

您将需要使用

```
Dim icon As System.Drawing.Icon
icon = icon.FromHandle(hIcon) 
```

在 hIcon 结构中，您可以指定颜色深度

此链接将引导您朝着正确的方向前进：

*   [http://www.geekpedia.com/tutorial219_Extracting-Icons-from-Files.html](http://www.geekpedia.com/tutorial219_Extracting-Icons-from-Files.html)
*   [http://bytes.com/groups/net/120863-system-drawing-icon-hicon-ptr-iconimage-structure](http://bytes.com/groups/net/120863-system-drawing-icon-hicon-ptr-iconimage-structure)

# ruby - RSpec 和慢性的问题

> ID：510718
> 
> 赞同：0
> 
> 时间：2009-02-04T09:52:39.727
> 
> 标签：ruby, rubygems, rspec, chronic

我正在尝试在我的非 Rails 项目中使用 Chronic。当我尝试使用“spec”获取规格时，出现以下错误：

```
$ spec spec/parsers/parser_english_spec.rb

/Library/Ruby/Site/1.8/rubygems/custom_require.rb:31:in `gem_original_require': no such file to load -- chronic (LoadError)
from /Library/Ruby/Site/1.8/rubygems/custom_require.rb:31:in `require'
from ./spec/parsers/../../lib/recurring_events.rb:6
from /Library/Ruby/Site/1.8/rubygems/custom_require.rb:31:in `gem_original_require'
from /Library/Ruby/Site/1.8/rubygems/custom_require.rb:31:in `require'
from ./spec/parsers/../spec_helper.rb:3
from /Library/Ruby/Site/1.8/rubygems/custom_require.rb:31:in `gem_original_require'
from /Library/Ruby/Site/1.8/rubygems/custom_require.rb:31:in `require'
from ./spec/parsers/parser_english_spec.rb:1
from /Library/Ruby/Gems/1.8/gems/rspec-1.1.12/lib/spec/runner/example_group_runner.rb:15:in `load'
from /Library/Ruby/Gems/1.8/gems/rspec-1.1.12/lib/spec/runner/example_group_runner.rb:15:in `load_files'
from /Library/Ruby/Gems/1.8/gems/rspec-1.1.12/lib/spec/runner/example_group_runner.rb:14:in `each'
from /Library/Ruby/Gems/1.8/gems/rspec-1.1.12/lib/spec/runner/example_group_runner.rb:14:in `load_files'
from /Library/Ruby/Gems/1.8/gems/rspec-1.1.12/lib/spec/runner/options.rb:94:in `run_examples'
from /Library/Ruby/Gems/1.8/gems/rspec-1.1.12/lib/spec/runner/command_line.rb:9:in `run'
from /Library/Ruby/Gems/1.8/gems/rspec-1.1.12/bin/spec:4
from /usr/bin/spec:19:in `load' 
```

如果我手动运行它，一切正常：

```
$ ruby -rrubygems  spec/parsers/parser_english_spec.rb 
```

这就是我在 spec_helper.rb 中的内容

```
require 'rubygems'
require 'spec'
require File.dirname(__FILE__) + "/../lib/recurring_events" 
```

有什么想法可能会出错吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-05T06:27:22.043

我现在已经修复了它，事实证明 spec 命令正在运行 OS X 附带的旧版本，所以它找不到 gem。

# windows - 如果用户卸载您的程序，您将如何处理用户数据？

> ID：510722
> 
> 赞同：5
> 
> 时间：2009-02-04T09:53:20.943
> 
> 标签：windows, installation, uninstallation

我是一名需要弹药的开发人员。

如果用户选择卸载您的程序，您将如何处理程序保存在 HKEY_CURRENT_USER 中的数据以及用户配置文件的其他部分？

该程序将用户数据（日志等）存储在用户文件夹中。客户希望卸载以删除所有这些数据……为所有用户。同时，普通的非管理员用户应该可以进行卸载。

我找不到白皮书、文档或其他说明*不应该这样做*的内容。关闭是 Raymond Chen 的帖子：http: [//blogs.msdn.com/oldnewthing/archive/2007/09/17/4948130.aspx](http://blogs.msdn.com/oldnewthing/archive/2007/09/17/4948130.aspx)

但是博客文章是弱弹药。

替代方法：在安装期间创建 %SYSTEMDRIVE%\FooProgramData。所有用户都写入此文件夹。这很丑，我知道。但这是我能想到的唯一可以满足“on-uninstall-all-files-must-be-cleared”要求的方法。

想法？我需要更好的替代品（如果存在）或可靠的白皮书、文档或徽标要求，说明卸载不应删除用户数据。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-04T09:59:55.517

*“同时，普通的非管理员用户应该可以进行卸载。”*

非管理员帐户不应该（也不应该）更改其他用户的数据。

在这种情况下，您最多可以做的就是删除当前用户的数据，即使这样，您也应该提示或发出警告。

和雷蒙德一起去吧，它可能只是一篇博文，但雷蒙德可以被认为不是普通的博主:)

编辑：我刚刚找到[http://msdn.microsoft.com/en-us/library/bb204770.aspx#uninstall_clean](http://msdn.microsoft.com/en-us/library/bb204770.aspx#uninstall_clean)但它没有明确说明用户数据

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-04T09:58:09.123

卸载应该删除所有客户端数据，除非客户端不希望它:)

或者，换一种说法，通用卸载程序应该让用户选择是否删除数据。

在您的情况下，如果您有一个特别希望删除数据的客户，我想这就是您必须要做的，但是如果卸载将由非运行，则没有干净的方法可以做到这一点-admin 除非您按照您的建议进行操作，并将数据存储在每个用户都可以完全访问文件系统的地方。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-04T09:58:31.680

我不知道 Windows 的特殊性，但作为用户，我希望我的数据在卸载软件时不会丢失。一些论点是：

*   其他程序可能能够处理相同的数据
*   我以后可以改变主意并重新安装软件
*   其他人可能需要数据，我可以邮寄给他们

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-04T22:52:53.880

删除所有每个用户的数据应该是一个单独的卸载过程。

我的建议（以及我们所做的）是创建一个单独的“清理”实用程序，该实用程序必须以管理员身份运行，并将通过删除其他用户文件的配置文件进行枚举。或者，它还可以枚举用户注册表配置单元并删除其他注册表项等。我们的一个客户有自己的自定义脚本可以做到这一点。

然后，我会为客户提供此清理工具，并在卸载后说，如果您想删除所有用户数据，请使用此工具。

考虑以下情况

*   客户在安装新版本之前卸载
*   重大升级（将卸载旧版本，因此您需要注意这一点）
*   不应该这样做但有能力这样做的用户意外卸载

我能想到的为所有用户删除这些数据的最简洁的方法是利用[Active Setup](http://www.etlengineering.com/installer/activesetup.txt)并使用它来触发每个用户的脚本，该脚本在每个用户下次登录时运行。卸载过程中不会删除数据，但会在下次登录时删除。而且您会留下一些注册表项，但是与枚举用户配置文件相比，它不太可能导致损坏。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-04T09:57:59.717

卸载时我*永远不会*删除用户和/或配置数据。如果用户真的希望这一切都消失，她应该自己做。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-10-04T15:40:53.963

我知道我参加这个聚会晚了几年，但是当我自己现在正在寻找这个问题的答案时，我遇到了以下新的 MSDN 文章：http: [//msdn.microsoft.com/en-us/库/windows/apps/jj553522.aspx](http://msdn.microsoft.com/en-us/library/windows/apps/jj553522.aspx)。

它与 Metro Style 应用程序有关，但可能与其他类型的应用程序有关。他们的解释在不同类型的用户数据之间提供了一些非常需要的区别，它可以帮助开发人员决定是否删除文件。没有这个区别，在卸载过程中是否删除文件存在如此不同的意见是可以理解的：

> 应用程序经常管理或与之交互的数据有两种：
> 
> **应用程序数据**
> 
> 应用程序本身创建和管理的数据。它是特定于特定应用程序的内部功能或配置的可变数据。它包括运行时状态、用户偏好、参考内容（例如字典应用程序中的字典定义）和其他设置。***应用程序数据与应用程序的存在相关，并且仅对该应用程序有意义。***
> 
> **用户数据**
> 
> 用户在使用应用程序时创建和管理的数据。它包括文档或媒体文件、电子邮件或通信记录，或保存用户创建的内容的数据库记录。***请注意，用户选择的首选项或应用配置选项被视为应用数据，而不是用户数据。***独立于单个应用程序的用户数据可能对多个应用程序有用或有意义。通常，这是用户想要作为独立于应用程序本身的实体（例如文档）来操作或传输的数据。

注意这里用粗斜体显示的句子。如果有问题的文件在没有应用程序的情况下毫无意义，如果它们包含该应用程序的用户首选项（例如`user.config`），那么即使它可能位于用户数据目录中，也不应将其视为用户数据。它应该被认为属于应用程序并在卸载时被删除。

话虽如此，我仍在为当前用户以外的其他用户寻找简单的方法！我正在考虑将所有这些数据移动到应用数据的目录中，这样我就可以更轻松地删除它们，而不必弄乱单个用户的用户数据存储。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-11-06T17:30:15.107

我最近的“聪明的想法”倾注于建议在程序首次运行时在相应用户的文件夹中创建“readme.txt”文件。该文件应包含说明哪些文件是什么，还有一个免责声明“请随意清理此文件夹”:-)

只是为了澄清这个问题，我又创建了一个，专门与 Windows 徽标认证相关： [Windows Logo clean uninstall](https://stackoverflow.com/questions/13253267/windows-logo-clean-uninstall/13253762)。

我提出了一个老难题，但想知道微软推荐哪一种选择。

# sql - 如果值不存在，但仅适用于某些条件，如何插入表中？（MS SQL 服务器）

> ID：510733
> 
> 赞同：2
> 
> 时间：2009-02-04T09:57:25.710
> 
> 标签：sql, sql-server, select, insert

我对 SQL 很陌生，但需要编写一个查询来执行以下操作。使用 MS SQL Server 2005。

```
配置文件定义中的配置文件定义
------ -------- ----------      
ProfileID 定义ID 定义ID
ProfileType ProfileID 定义类型
个人资料名称                                          

```

在定义表中，定义Type可以是TypeA、TypeB……TypeZ。我想确保对于某个配置文件类型，ProfileTypeA 定义具有所有类型，TypeA -> TypeZ。

但有些类型已经存在于表中，我不想重复。

```
所以它就像
从 ProfileType = ProfileTypeA 的 Profile 中选择 ProfileID
对于每个 ProfileID
   如果在定义类型 A 中不存在
   将 TypeA 插入定义
   将 ProfileID、DefinitionID 插入 DefinitionInProfile

   ...对 TypeB、TypeC 重复...
结尾

```

1.  我需要获取 ProfileType = ProfileTypeA 的所有实例

2.  然后获取第一个 Profile.profileID

3.  然后检查DefinitioninProfile 表以获取其中profileID = Profile.ProfileID 的DefinitionID 列表

4.  然后对于所有这些定义 ID，检查是否有一个名为“TypeA”的定义类型，如果没有插入，则忽略它。然后对'TypeB'做同样的事情，对typec重复，.. typeZ

返回第 2 步并获取下一个 Profile.ProfileID 并为该配置文件 ID 重复 3 和 4。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-04T10:19:49.330

试试这个：

```
INSERT DefinitionInProfile 
    (ProfileID, DefinitionID)
SELECT
    P.ProfileID, D.DefinitionID
FROM
    --All permutations of P and D
    Profile P
    CROSS JOIN
    Definition D
WHERE
    --Edit (added 2 rows)
    --But filter and lookup type -> id
    P.ProfileType = ProfileTypeA
    AND
    --End edit
    --But not where the defid is already there for that profileid
    NOT EXISTS (SELECT * --or 1!!
        FROM
            DefinitionInProfile DP
        WHERE
            DP.ProfileID = P.ProfileID AND
            DP.DefinitionID= D.DefinitionID) 
```

# windows - 如何确定屏幕保护程序正在运行？

> ID：510734
> 
> 赞同：4
> 
> 时间：2009-02-04T09:57:39.763
> 
> 标签：windows, winapi, screensaver

可以建议的一种解决方案是定期查找特殊的“屏幕保护程序”桌面，如果存在，则将其视为正在运行的屏幕保护程序。

但显然，并非所有屏幕保护程序都是如此，因为某些提到的桌面始终存在。

有没有更可靠的解决方案？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-02-06T20:16:59.463

请参阅带有 SPI_GETSCREENSAVERRUNNING 参数的 WINAPI 函数 SystemParametersInfo()。这是检测屏幕保护程序当前是否正在运行的唯一记录方法。（您也可以查看是否启用了屏幕保护，获取并设置超时值，并使用此功能启动屏幕保护。）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-04T10:09:21.113

我认为关键是通过其窗口类（“WindowsScreenSaverClass”）来识别屏幕保护程序。我找到了这个页面 [如何启动、检测和停止屏幕保护程序？](http://bobmoore.mvps.org/Win32/w32tip22.htm)有一些代码示例和解释。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-04T10:01:23.720

[如何：使用 Visual Basic 6.0 确定屏幕保护程序是否正在运行](http://support.microsoft.com/kb/315725)

我知道这是针对 VB6 的，但它肯定是一个很好的起点。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2016-04-29T19:35:12.830

[这](https://stackoverflow.com/a/36945940/410624)是我对屏幕保护程序事件检测的实现。

笔记：

*   `SPI_GETSCREENSAVERRUNNING`检测到在我的情况下不准确的 Windows 事件 id 4802 和 4803，请查看[我的问题](https://stackoverflow.com/questions/36941113/windows-event-id-4802-and-4803-triggered-at-the-same-time-invoke-dismissal-of)，因此添加了用户空闲时间计算
*   `GetLastInputInfo`如果进程是服务，显然不起作用。

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2009-02-04T10:18:32.750

在 .MainModule.FileName 中搜索带有 .scr 的进程的进程

# sql - 为什么 UDF 比子查询慢得多？

> ID：510743
> 
> 赞同：13
> 
> 时间：2009-02-04T10:01:00.147
> 
> 标签：sql, sql-server, performance, sql-server-2008, user-defined-functions

我有一个案例，我需要从同一个表中翻译（查找）几个值。我写它的第一种方式是使用子查询：

```
SELECT
    (SELECT id FROM user WHERE user_pk = created_by) AS creator,
    (SELECT id FROM user WHERE user_pk = updated_by) AS updater,
    (SELECT id FROM user WHERE user_pk = owned_by) AS owner,
    [name]
FROM asset 
```

因为我经常使用这个子查询（也就是说，我有大约 50 个包含这些字段的表），我可能需要向子查询添加更多代码（例如， "AND active = 1" ）我想我' d 将它们放入用户定义的函数[UDF](http://en.wikipedia.org/wiki/User-defined_function)并使用它。但是使用该 UDF 的性能非常糟糕。

```
CREATE FUNCTION dbo.get_user ( @user_pk INT )
RETURNS INT
AS BEGIN 
    RETURN ( SELECT id
             FROM   ice.dbo.[user]
             WHERE  user_pk = @user_pk )
END

SELECT dbo.get_user(created_by) as creator, [name]
FROM asset 
```

#1 的性能不到 1 秒。#2 的性能大约是 30 秒...

为什么，或者更重要的是，有什么方法可以在 SQL Server 2008 中编码，这样我就不必使用这么多子查询了？

### 编辑：

只是对何时有用的更多解释。当我想为用户获取文本时，这个简单的查询（即获取用户 ID）变得更加复杂，因为我必须加入个人资料才能获取语言，并与公司一起查看是否应该获取语言'而是从那里编辑，并使用翻译表来获取翻译后的文本。对于这些查询中的大多数，性能是可读性和可维护性的次要问题。

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2009-02-04T10:09:14.653

UDF 对查询优化器来说是一个黑盒，因此它会针对每一行执行。您正在执行逐行游标。对于资产中的每一行，在另一个表中查找 id 三次。当您使用标量或多语句 UDF 时会发生这种情况（内联 UDF 只是扩展到外部查询的宏）

关于这个问题的许多文章之一是“[标量函数、内联和性能：无聊帖子的有趣标题](http://dataeducation.com/scalar-functions-inlining-and-performance-an-entertaining-title-for-a-boring-post/)”。

可以优化子查询以关联并避免逐行操作。

你真正想要的是：

```
SELECT
   uc.id AS creator,
   uu.id AS updater,
   uo.id AS owner,
   a.[name]
FROM
    asset a
    JOIN
    user uc ON uc.user_pk = a.created_by
    JOIN
    user uu ON uu.user_pk = a.updated_by
    JOIN
    user uo ON uo.user_pk = a.owned_by 
```

2019 年 2 月更新

SQL Server 2019 开始修复这个问题。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-02-04T11:54:54.177

正如其他海报所建议的那样，使用连接肯定会给你最好的整体性能。

但是，由于您已声明您不想为维护 50 个类似的连接或子查询而头疼，请尝试使用如下内联表值函数：

```
CREATE FUNCTION dbo.get_user_inline (@user_pk INT)
RETURNS TABLE AS
RETURN
(
    SELECT TOP 1 id
    FROM ice.dbo.[user]
    WHERE user_pk = @user_pk
        -- AND active = 1
) 
```

然后，您的原始查询将变为：

```
SELECT
    (SELECT TOP 1 id FROM dbo.get_user_inline(created_by)) AS creator,
    (SELECT TOP 1 id FROM dbo.get_user_inline(updated_by)) AS updater,
    (SELECT TOP 1 id FROM dbo.get_user_inline(owned_by)) AS owner,
    [name]
FROM asset 
```

内[联表值函数](http://www.sommarskog.se/share_data.html#inlineUDF)应该比标量函数或多语句表值函数具有更好的性能。

性能应该与您的原始查询大致相当，但是可以在 UDF 中进行任何未来的更改，使其更易于维护。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-04T10:40:10.723

获得相同的结果（如果用户被删除或不活动，则为 NULL）。

```
 select 
    u1.id as creator,
    u2.id as updater,
    u3.id as owner,
    [a.name]
 FROM asset a
        LEFT JOIN user u1 ON (u1.user_pk = a.created_by AND u1.active=1) 
        LEFT JOIN user u2 ON (u2.user_pk = a.created_by AND u2.active=1) 
        LEFT JOIN user u3 ON (u3.user_pk = a.created_by AND u3.active=1) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-04T14:53:11.353

我错过了什么吗？为什么这行不通？您只选择表中已有的 id：

```
select created_by as creator, updated_by as updater, 
owned_by as owner, [name]
from asset 
```

顺便说一句，在设计时，您确实应该避免使用关键字，例如`name`，作为字段名称。

# c# - SmtpClient 向垃圾邮件发送电子邮件

> ID：510748
> 
> 赞同：2
> 
> 时间：2009-02-04T10:06:21.947
> 
> 标签：c#, email, smtp

我尝试使用 SmtpClient.Send() 从 c# 发送电子邮件，但它总是进入垃圾箱。如果我从 Outlook 发送它，它工作正常。有没有办法解决这个问题？有人告诉我修改电子邮件标题，但我不知道怎么做。提前致谢。这是我的代码

```
SmtpClient client = new SmtpClient();
client.Host = "smtp.server.com";
client.Credentials = new System.Net.NetworkCredential("user", "password");
MailAddress mailFrom = new MailAddress("mymail@server.com");
MailAddress mailTo = new MailAddress("yourmail@server.com");
MailAddress mailReply = new MailAddress("mymail@server.com");
MailMessage message = new MailMessage(mailFrom, mailTo);
message.Body = "This is a test message.";
message.Subject = "test message";
message.SubjectEncoding = System.Text.Encoding.UTF8;
message.BodyEncoding = System.Text.Encoding.UTF8;
client.Send(message); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-04T11:20:53.340

a) 代码示例实际上并未使用 mailReply 地址。

b) 当您发送更真实的信息时，问题可能会消失。如果不是，那么您将不得不找出为什么邮件被标记为垃圾邮件，从垃圾邮件箱中获取邮件并查看标题或类似的东西。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-04T10:10:45.260

垃圾邮件过滤器可能会丢弃包含无效条目的邮件。

尝试输入发件人、回复和发件人的有效（现有）地址。

# python - 产生期望控制台输入而不阻塞的子进程？

> ID：510751
> 
> 赞同：4
> 
> 时间：2009-02-04T10:07:18.840
> 
> 标签：python, windows, subprocess

我正在尝试通过调用 cvs.exe 进程从 Python 进行 CVS 登录。当手动调用 cvs.exe 时，它​​会向控制台打印一条消息，然后等待用户输入密码。

当用 subprocess.Popen 调用它时，我注意到调用阻塞了。代码是

```
subprocess.Popen(cvscmd, shell = True, stdin = subprocess.PIPE, stdout = subprocess.PIPE,
    stderr = subprocess.PIPE) 
```

我假设它阻塞是因为它正在等待输入，但我的期望是调用 Popen 会立即返回，然后我可以调用 subprocess.communicate() 来输入实际密码。如何实现这种行为并避免阻塞 Popen？

操作系统：Windows XP
Python：2.6
cvs.exe：1.11

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-04T11:00:35.707

*   拆下`shell=True`零件。你的外壳与它无关。使用`shell=True` 是麻烦的常见原因。
*   使用 cmd 的参数列表。

例子：

```
cmd = ['cvs', 
       '-d:pserver:anonymous@bayonne.cvs.sourceforge.net:/cvsroot/bayonne', 
       'login']
p = subprocess.Popen(cmd, stdin=subprocess.PIPE, stdout=subprocess.PIPE) 
```

这不会阻止我的系统（我的脚本继续执行）。然而，由于 cvs 直接从终端读取密码（而不是从标准输入或输出），您**不能**只将密码写入子进程的标准输入。

您可以做的是将密码作为 CVSROOT 规范的一部分传递，如下所示：

```
:pserver:<user>[:<passwd>]@<server>:/<path> 
```

即登录到 sourceforge 项目的功能：

```
import subprocess

def login_to_sourceforge_cvs(project, username='anonymous', password=''):
    host = '%s.cvs.sourceforge.net' % project
    path = '/cvsroot/%s' % project
    cmd = ['cvs', 
           '-d:pserver:%s:%s@%s:%s' % (username, password, host, path), 
           'login']
    p = subprocess.Popen(cmd, stdin=subprocess.PIPE, 
                              stdout=subprocess.PIPE
                              stderr=subprocess.STDOUT) 
    return p 
```

这对我有用。打电话

```
login_to_sourceforge_cvs('bayonne') 
```

将匿名登录到bayonne 项目的cvs。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-04T21:50:13.540

如果您正在自动化需要输入（如密码）的外部程序，那么您最好的选择可能是使用[pexpect](http://www.noah.org/wiki/Pexpect)。

# sql-server - 如何更改 SQL Server 中手动执行查询的超时时间？

> ID：510752
> 
> 赞同：10
> 
> 时间：2009-02-04T10:07:19.370
> 
> 标签：sql-server, visual-studio, timeout

我有一个简单的 SQL 脚本，可以从 Visual Studio 手动执行。这是一个数据生成脚本，所以我预计它需要几分钟才能运行。但我收到以下错误。

> 超时已过。在操作完成之前超时时间已过或服务器没有响应。

我不想更改任何全局服务器设置来运行这个文件。是否有任何命令可以放在文件顶部以增加该脚本/事务的超时？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-02-04T12:18:07.890

如果您使用 SQL Management Studio，选项中有两个设置（我指的是我使用的 SQL Server 2005 中的 Management Studio）：（
*我的 Management Studio 是德文的，所以我希望我将名称正确翻译成英文)*

您可以在“附加”->“选项”下的菜单中找到两者

在选项中，第一个在“查询执行”下，您可以在那里设置“执行超时”（我的已经为零）

第二个（我认为这是您需要的）是“Designer”下的第一个选项，它表示“Override Timeout for table Designer updates”之类的内容，您可以选中一个框并在那里输入一个值。
前段时间，我遇到了和你类似的问题（在大表上运行 ALTER TABLE 时出现超时消息），我通过将此选项设置为更高的值来解决它。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2010-10-04T19:13:49.007

增加 CommandTimeout 属性将解决问题，即

SqlCommandObject.CommandTimeout = 500000

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-03-21T21:26:55.680

使用下面记录的过程增加 Visual Studio 中的查询超时和连接超时值。更改查询超时：

在 Visual Studio IDE 中，导航到工具 -> 选项 -> 数据库工具 -> 查询和视图设计器 您可以取消选中“取消长时间运行的查询”选项，或者将“取消后”选项的值更改为更高的值。更改连接超时：

在 Visual Studio IDE 中，通过导航到 View -> Server Explorer 来启用 Server Explorer 在 Server Explorer 中，右键单击与正在部署 CLR 对象的 SQL Server 的连接，然后选择 Modify Connection。单击“修改连接”窗口上的“高级”按钮。在“高级属性”窗口中，将“初始化”部分下的“连接超时”值更改为更高的值。

[http://support.microsoft.com/kb/2011805](http://support.microsoft.com/kb/2011805)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-01-20T18:44:08.420

@christian 答案对我不起作用（更改 SQL Management Studio 中的设置）。

Biswa回答对我有用。我将包括代码来澄清

```
SqlCommand cmd = new SqlCommand("MyReport", conn);
cmd.CommandType = CommandType.StoredProcedure;
cmd.CommandTimeout = 60;  /* note default is 30 sec */ 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-04T11:58:22.190

SQL Server 在返回给用户之前将无限期地等待。很可能设置了客户端超时属性。例如，您可以[为 ADO 命令对象设置超时属性](http://msdn.microsoft.com/en-us/library/ms678265(VS.85).aspx)。

干杯，安迪。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-12-27T18:20:20.360

只是想澄清 Microsoft SQL Server Management Studio 2005 的具体步骤......即使在“查询执行”部分将“设计器”默认设置为“0”，因为“设计器”变量覆盖了“查询执行”，也肯定需要调整它'设置。

1.  打开 Microsoft SQL Server Management Studio 2005
2.  工具>>选项
3.  展开“设计师”
4.  我发现将“事务超时后”设置为 120 可以很好地更新具有数百万条记录的表。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-04T11:00:24.100

没关系，我可以使用 SQL Management Studio 很好地运行它。

# jquery - JQuery在淡出后删除DOM元素

> ID：510761
> 
> 赞同：40
> 
> 时间：2009-02-04T10:11:03.357
> 
> 标签：jquery, dom, fadeout

我想在淡出后立即删除一个 DOM 元素。到目前为止我所做的是

```
$(element).click(function()
{
    $(this).fadeOut(500, function() { $().remove(this); });
}); 
```

但现在我总是在 Firebug 中遇到这个错误：http: [//dl.getdropbox.com/u/5912/Jing/2009-02-04_1109.png](http://dl.getdropbox.com/u/5912/Jing/2009-02-04_1109.png)

我想这是因为当回调被调用时，fadeOut 函数并没有真正完成。而且我不能`$.remove()`在 fadeOut 调用之后放置该部分，否则它会立即被删除。

所以你知道我有什么办法可以做得更好吗？

* * *

## 回答 #1

> 赞同：109
> 
> 时间：2009-02-04T10:19:38.253

您[`remove()`](http://docs.jquery.com/Manipulation/remove)错误地使用了该功能。

```
$(element).click(function() {
    $(this).fadeOut(500, function() { $(this).remove(); });
}); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2011-02-14T08:57:13.460

为什么在这里搞砸只是使用 $('#anydiv').remove();

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-09-08T22:02:25.897

或 $.remove($(this));

# c# - C# winforms 启动（Splash）表单不隐藏

> ID：510765
> 
> 赞同：10
> 
> 时间：2009-02-04T10:12:26.177
> 
> 标签：c#, winforms, show-hide

我有一个 winforms 应用程序，我在其中使用 2 个表单来显示所有必要的控件。第一个表单是一个启动屏幕，它告诉用户它正在加载等。所以我使用以下代码：

```
Application.Run( new SplashForm() ); 
```

应用程序完成加载后，我希望 SplashForm 隐藏或将我发送到后面并显示主要来源。我目前正在使用以下内容：

```
private void showMainForm()
{
    this.Hide();
    this.SendToBack();

    // Show the GUI
    mainForm.Show();
    mainForm.BringToFront();
} 
```

我看到的是 MainForm 已显示，但 SplashForm 仍然在“顶部”可见。我目前正在做的是单击 MainForm 以手动将其置于前面。关于为什么会发生这种情况的任何想法？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-02-04T10:19:48.050

可能您只想关闭启动表单，而不是将其发送回。

我在一个单独的线程上运行启动表单（这是 SplashForm 类）：

```
class SplashForm
{
    //Delegate for cross thread call to close
    private delegate void CloseDelegate();

    //The type of form to be displayed as the splash screen.
    private static SplashForm splashForm;

    static public void ShowSplashScreen()
    {
        // Make sure it is only launched once.

        if (splashForm != null)
            return;
        Thread thread = new Thread(new ThreadStart(SplashForm.ShowForm));
        thread.IsBackground = true;
        thread.SetApartmentState(ApartmentState.STA);
        thread.Start();           
    }

    static private void ShowForm()
    {
        splashForm = new SplashForm();
        Application.Run(splashForm);
    }

    static public void CloseForm()
    {
        splashForm.Invoke(new CloseDelegate(SplashForm.CloseFormInternal));
    }

    static private void CloseFormInternal()
    {
        splashForm.Close();
        splashForm = null;
    }
...
} 
```

主程序功能如下所示：

```
[STAThread]
static void Main(string[] args)
{
    SplashForm.ShowSplashScreen();
    MainForm mainForm = new MainForm(); //this takes ages
    SplashForm.CloseForm();
    Application.Run(mainForm);
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-11-05T19:10:42.580

这对于防止您的启动画面在关闭后窃取您的焦点并将您的主窗体推到后台至关重要：

```
protected override bool ShowWithoutActivation {
    get { return true; }
} 
```

将此添加到您的初始表单类。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-04T10:24:55.373

如果我理解正确，您应该只在主窗体上使用 Application.Run 。所以要么先显示你的飞溅，只需使用类似的东西：

```
using(MySplash form = new MySplash())
   form.ShowDialog(); 
```

然后随时在 MySplash 中手动关闭它。

或者在你的主窗体中显示它 Load 事件处理程序，然后等待它关闭或其他任何东西，直到你让 Load 方法完成。（可能在显示之前将 Visible 设置为 false，然后再将其设置为 true。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-04T11:20:45.167

我相信这可能是我当前设计的设计缺陷！

我认为实现我需要的最好方法是从 MainForm 控制一切。所以我可以使用：

```
Application.Run(new MainForm()); 
```

这将负责显示/更新/隐藏 SplashScreen。通过这种方式，我可以对 MainForm 管理的系统的其余部分进行必要的复杂操作。

# c# - 在 WCF 客户端/服务器应用程序中计算 UTC/本地日期时间转换的最佳方法

> ID：510767
> 
> 赞同：4
> 
> 时间：2009-02-04T10:13:35.223
> 
> 标签：c#, .net, wcf, datetime, timezone

我有一个客户端/服务器应用程序，用 WCF / C#3.5 编写。

服务器位于我的本地时区，客户端分布在世界各地。

我目前的策略是在服务器和数据库中的任何地方使用 UTC DateTime，并让客户端正确处理他们收到的 UTC DateTime。

这意味着每次客户端收到一条消息时，它的第一个任务就是将消息中包含的 DateTimes 从 UTC 转换为 Local。

我定义了一个接口，由我的所有 [DataContract] 对象实现以帮助完成此任务：

```
public interface IConvertToLocalTime {
   void ConvertToLocalTime();
} 
```

所以我通常以这种方式处理来自服务器的消息：

```
public void ServerCallbackFoo(MyObject a, MyObject2 b)
{
  a.ConvertToLocalTime();
  b.ConvertToLocalTime();
  // my business code goes there
} 
```

这很好用，但我对必须手动调用转换方法这一事实并不满意。

在我看来，这个任务应该由 WCF 框架来管理。我在那里错过了什么吗？有没有更好的方法来自动化转换？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-04T20:46:29.797

我可能不理解这个问题，但是根据需要使用内置的 DateTime.ToLocalTime 和 DateTime.ToUniversalTime 会不会更容易，因为您将 .NET 用于服务和客户端。您应该能够检查 .Kind 属性以查看 DateTime 是本地时间还是 UTC。

```
DateTime test = DateTime.Now; //already local time
DateTime LocalTest = test.ToLocalTime();
DateTime UtcTest = test.ToUniversalTime(); 
```

您可能还想查看有关处理 DateTime 序列化的[SO Question 。](https://stackoverflow.com/questions/65164/best-practices-for-datetime-serialization-in-net-framework-35sql-server-2008)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-04T14:38:15.627

据我所知，WCF 不提供任何类型的自动化来帮助时间转换，而且我个人也不希望它这样做。

我同意你的看法。必须手动调用转换例程并不理想。它不会“感觉”优雅。

对我来说，一个更优雅的解决方案是根据需要“懒惰地”评估 DateTime 。无需提供必须调用才能将 UTC 时间转换为本地时间的函数，而是将此逻辑放在每个 DateTime 属性的 get 函数中。这样，当从对象中检索 DateTime 时，它​​会自动转换为本地时间。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-31T20:19:55.973

您可以让客户端在向用户呈现信息时精确地转换为/从本地时间转换，反之，在读取用户输入的数据时首先执行此操作。然后客户端的其余部分可以使用 UTC。

# sql - 计算返回结果的 Sql 查询

> ID：510769
> 
> 赞同：1
> 
> 时间：2009-02-04T10:14:08.530
> 
> 标签：sql

如何编写一个 SQL 查询，从表中选择一列但返回两列，其中另一列包含行的索引（一个新的，从 1 到 n 开始）。它必须不使用执行此操作的函数（如 row_number()）。
有任何想法吗？

编辑：它必须是单选查询

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-04T11:07:54.023

您可以在任何数据库上执行此操作：

```
SELECT  (SELECT COUNT (1) FROM field_company fc2
         WHERE fc2.field_company_id <= fc.field_company_id) AS row_num,
        fc.field_company_name
FROM    field_company fc 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-04T10:26:01.470

```
SET NOCOUNT ON

DECLARE @item_table TABLE
(
 row_num INT IDENTITY(1, 1) NOT NULL PRIMARY KEY, --THE IDENTITY STATEMENT IS IMPORTANT!
 field_company_name VARCHAR(255)
)

INSERT INTO @item_table 
    SELECT field_company_name FROM field_company

SELECT  * FROM @item_table 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-04T10:26:59.860

如果您使用的是 Oracle 或支持序列对象的数据库，请为此创建一个新的 db 序列对象。接下来创建一个视图，然后运行它。

作为 select column_name, sequence.next from table 插入视图

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-04T10:51:00.903

在 mysql 中，您可以：

```
SELECT Row,Column1
FROM (SELECT @row := @row + 1 AS Row, Column1 FROM table1 ) 
As derived1 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-04T11:25:24.657

我想出了一个骇人听闻的方法来做到这一点，我有点惭愧。在 Postgres 8.1 上：

SELECT generate_series, (SELECT username FROM users LIMIT 1 OFFSET generate_series) FROM generate_series(0,(SELECT count(*) - 1 FROM users));

我相信即使您的源表没有唯一的 id 或标识符，这种技术也会起作用。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-07T10:39:37.803

在 SQL Server 2005 及更高版本上，您可以使用 OVER 来完成此操作：

SELECT rank() over (order by company_id) as rownum , company_name FROM company

# .net - 用于替换 signtool.exe 的 API/库

> ID：510773
> 
> 赞同：11
> 
> 时间：2009-02-04T10:15:55.733
> 
> 标签：.net, certificate, signing

Windows SDK 附带一个名为 signtool.exe 的工具，可让您使用证书对文件进行签名。我需要在后台服务中做同样的事情，所以我正在寻找一个库（最好是托管代码，但 COM 会做）来做同样的事情。有任何想法吗？

找到了答案。以下是如何使用 X.509 证书在 .NET 中对文件进行签名：

```
CmsSigner signer = new CmsSigner();
signer.Certificate = new X509Certificate2(certificate);

SignedCms content = new SignedCms(new ContentInfo(File.ReadAllBytes(fileToSign)));
content.ComputeSignature(signer, true);
byte[] signedFile = content.Encode();

string signedFileName = fileToSign + ".signed";
File.WriteAllBytes(signedFileName, signedFile);

Console.WriteLine("Signed file: " + signedFileName); 
```

这里，**certificate**是包含证书的 .pfx 文件的路径，而**fileToSign**是要签名的文件。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-04T10:29:34.020

SignTool 正在使用 CAPICOM，它是 Crypto API 的 COM 包装器。您可以使用任何一种。如果您使用 CAPICOM，您可以在[此处](http://msdn.microsoft.com/en-us/library/aa375732(VS.85).aspx#_crypto2_digital_signature_objects)查看信息。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2017-11-17T09:58:38.790

对于到达这里的谷歌旅行者：

[这个 MSDN 论坛帖子](https://social.msdn.microsoft.com/Forums/en-US/76413815-0dc5-428c-856c-a0aacf7ff762/programmatically-signing-an-exe-using-net-authenticode?forum=netfxbcl)说 Windows 中有一个[CryptUIWizDigitalSign](http://msdn.microsoft.com/en-us/library/aa380292(VS.85).aspx) API。它还指向Alejandro Campos Magencio 的[一篇博客文章](https://blogs.msdn.microsoft.com/alejacma/2008/02/20/how-to-sign-exe-files-with-an-authenticode-certificate-vb-net/)，该文章展示了 VB.NET 中的示例实现。

由于似乎缺少 C# 版本，我将 Alejandro 的代码转换为 C#。请注意，以下代码仅适用于文件（尚未）。

```
using System;
using System.Security.Cryptography.X509Certificates;
using System.ComponentModel;
using System.Runtime.InteropServices;

namespace ConsoleApp1
{
    /// <summary>
    /// Provides code signing functionality via Windows COM Cryptui.dll.
    /// </summary>
    class Signer
    {

        public const Int32 CRYPTUI_WIZ_NO_UI = 1;
        public const Int32 CRYPTUI_WIZ_DIGITAL_SIGN_SUBJECT_FILE = 1;
        public const Int32 CRYPTUI_WIZ_DIGITAL_SIGN_CERT = 1;

        public struct CRYPTUI_WIZ_DIGITAL_SIGN_INFO
        {
            public Int32 dwSize;
            public Int32 dwSubjectChoice;
            [MarshalAs(UnmanagedType.LPWStr)]
            public string pwszFileName;
            public Int32 dwSigningCertChoice;
            public IntPtr pSigningCertContext;
            public string pwszTimestampURL;
            public Int32 dwAdditionalCertChoice;
            public IntPtr pSignExtInfo;
        }

        [StructLayout(LayoutKind.Sequential)]
        public struct CRYPTUI_WIZ_DIGITAL_SIGN_CONTEXT
        {
            public Int32 dwSize;
            public Int32 cbBlob;
            public IntPtr pbBlob;
        }

        [DllImport("Cryptui.dll", CharSet = CharSet.Unicode, SetLastError = true)]
        public static extern bool CryptUIWizDigitalSign(Int32 dwFlags, IntPtr hwndParent, string pwszWizardTitle, ref CRYPTUI_WIZ_DIGITAL_SIGN_INFO pDigitalSignInfo, ref IntPtr ppSignContext);

        [DllImport("Cryptui.dll", CharSet = CharSet.Auto, SetLastError = true)]
        public static extern bool CryptUIWizFreeDigitalSignContext(IntPtr pSignContext);

        /// <summary>
        /// Signs the executable at the given path with the given code signing certificate.
        /// </summary>
        /// <example>
        ///    string certPath = @"C:\certs\CodeSigningTestCert.pfx";
        ///    string exePath = @"C:\temp\ConsoleApp2ToBeSigned.exe";
        ///    string certPwd = "myGreatSecurePassword";
        ///    
        ///    try
        ///    {
        ///        string resultingSignature = Signer.SignExecutable(certPath, exePath, certPwd);
        ///    }
        ///    catch (Win32Exception ex)
        ///    {
        ///        Console.WriteLine(ex.Message + ", Native error code: " + ex.NativeErrorCode.ToString());
        ///    }
        ///    catch (Exception ex)
        ///    {
        ///        // Any unexpected errors?
        ///        Console.WriteLine(ex.Message);
        ///    }
        /// 
        /// </example>
        /// <param name="certPath">The absolute path to the PFX file to be used for signing the exe file.</param>
        /// <param name="exePath">The absolute path to the executable to be signed.</param>
        /// <param name="certPwd">The password for the PFX file.</param>
        public static string SignExecutable(string certPath, string exePath, string certPwd)
        {
            X509Certificate2 cert = default(X509Certificate2);

            CRYPTUI_WIZ_DIGITAL_SIGN_INFO digitalSignInfo = default(CRYPTUI_WIZ_DIGITAL_SIGN_INFO);
            CRYPTUI_WIZ_DIGITAL_SIGN_CONTEXT signContext = default(CRYPTUI_WIZ_DIGITAL_SIGN_CONTEXT);

            IntPtr pSignContext = default(IntPtr);
            IntPtr pSigningCertContext = default(IntPtr);

            // Get certificate context
            cert = new X509Certificate2(certPath, certPwd);
            pSigningCertContext = cert.Handle;

            // Prepare signing info: exe and cert
            digitalSignInfo = new CRYPTUI_WIZ_DIGITAL_SIGN_INFO();
            digitalSignInfo.dwSize = Marshal.SizeOf(digitalSignInfo);
            digitalSignInfo.dwSubjectChoice = CRYPTUI_WIZ_DIGITAL_SIGN_SUBJECT_FILE;
            digitalSignInfo.pwszFileName = exePath;
            digitalSignInfo.dwSigningCertChoice = CRYPTUI_WIZ_DIGITAL_SIGN_CERT;
            digitalSignInfo.pSigningCertContext = pSigningCertContext;
            digitalSignInfo.pwszTimestampURL = null;
            digitalSignInfo.dwAdditionalCertChoice = 0;
            digitalSignInfo.pSignExtInfo = IntPtr.Zero;

            // Sign exe
            if ((!CryptUIWizDigitalSign(CRYPTUI_WIZ_NO_UI, IntPtr.Zero, null, ref digitalSignInfo, ref pSignContext)))
                throw new Win32Exception(Marshal.GetLastWin32Error(), "CryptUIWizDigitalSign");

            // Get the blob with the signature
            signContext = (CRYPTUI_WIZ_DIGITAL_SIGN_CONTEXT)Marshal.PtrToStructure(pSignContext, typeof(CRYPTUI_WIZ_DIGITAL_SIGN_CONTEXT));
            byte[] blob = new byte[signContext.cbBlob + 1];
            Marshal.Copy(signContext.pbBlob, blob, 0, signContext.cbBlob);

            // Free blob memory
            if ((!CryptUIWizFreeDigitalSignContext(pSignContext)))
                throw new Win32Exception(Marshal.GetLastWin32Error(), "CryptUIWizFreeDigitalSignContext");

            return System.Text.Encoding.Default.GetString(blob);
        }
    }
} 
```

希望能帮助到你！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-10-12T15:26:10.730

我遇到了和塞巴斯蒂安一样的问题。查看 API，这似乎是用于对封装消息进行签名。Authenticode - signtool 所做的代码签名 - 是不同的，这就是 EXE 在签名后不运行的原因。

我仍在寻找替代品。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-02-04T10:30:51.243

您不能只是编写脚本来解决它吗？编写一个简单的批处理文件，为其提供正确的参数和输入？至少当我们在 UNIX 服务器上看到这个问题时，我们会这样做。

# database - 在表中维护有效记录

> ID：510774
> 
> 赞同：0
> 
> 时间：2009-02-04T10:16:27.433
> 
> 标签：database

我有一张包含航班时刻表数据的表格。每个时间表都有一个有效的从和有效的日期。我从没有提供有效日期和有效日期的平面文件中加载此表。因此，在加载时，我会向用户询问此信息。

假设用户从日期为当前日期，到日期为 3 月 31 日。现在在 3 月 1 日，用户加载了一个新的航班时刻表，并且用户给出了从日期作为当前日期到日期作为 5 月 31 日的日期。

如果我查询表以获取 3 月 1 日至 3 月 31 日之间的生效日期，则查询返回每个航班的两条记录，而我只需要每个航班的一条记录，这应该是最新的记录。

我该怎么做呢？我应该通过查询还是在加载检查和更正数据时处理这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-04T10:21:35.067

您需要确定数据的主键（可能是“业务”键）。必须有一些东西可以唯一地标识每个航班时刻表（听起来它不应该包括 Effective_from。一旦建立了该密钥，您在导入时检查它，然后更新现有记录或插入新记录。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-04T12:06:37.367

我假设每个航班都有一些唯一的 ID，否则如何区分它们。然后您可以将“活动”添加到计划表的额外字段中。加载新计划时 - 首先查询具有相同航班 ID 的现有记录并将它们设置为 Active=false。使用 Active=true 输入新记录。

查询很简单：select * from schedule where active=1

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-05T03:08:55.143

我开发了这个解决方案，但如果可能的话，我会寻找更好的解决方案。

```
表时间表{
scheduleId, flightNumber, Effective_from, Effective_to
}

计划表中的数据 {
1, XYZ12, 01/01/2009, 31/03/2009
2, ABC12, 01/01/2009, 30/04/2009
}

```

现在用户加载另一条记录 3, XYZ12, 01/03/2009, 31/05/2009

从 Schedule 中选择 scheduleId，其中 flightNumber = 'XYZ12' and (effective_from < '01/03/2009' and effective_to > '01/03/2009' or effective_from < '31/05/2009' and effective_to > '31/05/2009' ')

如果上面的查询向我返回任何意味着它重叠的结果，我应该向用户抛出一个错误。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-06T00:03:06.793

问题描述和对其中一项建议的评论给出了业务规则：

*   查询具有生效日期的航班应仅返回每个航班的一条记录
*   返回的记录应该是最新的记录
*   以前的时间表必须保存在表格中

答案的关键是如何确定哪条记录是最新的——最简单的答案是添加一列，记录插入行时的时间戳。现在，当您查询航班和给定的生效日期时，您只会得到带有最新插入时间戳的结果（可以使用 ORDER BY DESC 完成并获取返回的第一行）。

您可以只使用生效日期进行类似的查询并返回所有航班 - 同样，对于每个航班，您只想返回包含生效日期但具有最大时间戳的行。有一个巧妙的技巧可以逐组查找最大值 - 将结果与自身左连接，以便左 < 右，然后最大值是左值，其中右值为空。[High Performance MySQL 的作者给出了一个简单的例子。](http://www.xaprb.com/blog/2007/03/14/how-to-find-the-max-row-per-group-in-sql-without-subqueries/)

这比尝试追溯更正旧的时间表要容易得多 - 而且，从事物的声音来看，旧的时间表必须保持不变以满足您的业务需求。这也意味着你可以回答历史问题——你总是可以找出你的日程表在给定日期过去的样子——这意味着它在生成诸如“本月日程变化”之类的报告时非常方便。

# c# - 添加或总和，如 13:30+00:00:20=13:30:20 但如何？

> ID：510778
> 
> 赞同：7
> 
> 时间：2009-02-04T10:18:15.400
> 
> 标签：c#, .net, algorithm, datetime

我想在日期时间值（可能是存储的字符串类型）上添加秒（00:00:02）或分钟（00:00:20）但是如何？例子：

```
13:30+02:02:02= 15:32:02 ,
13:30+00:00:01= 13:30:01 ,
13:30+00:01:00=13:31:00 or 13:30 (not important) 
```

你能帮助我吗？我需要你的酷算法 :) 再次感谢...

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-02-04T10:22:48.137

```
myDateTimeVariable.Add(new TimeSpan(2,2,2)); 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-02-04T11:39:29.823

如果您选择使用 TimeSpan，请注意 Days 部分：

```
TimeSpan t1 = TimeSpan.Parse("23:30");
TimeSpan t2 = TimeSpan.Parse("00:40:00");
TimeSpan t3 = t1.Add(t2);
Console.WriteLine(t3); // 1.00:10:00 
```

使用日期时间：

```
DateTime d1 = DateTime.Parse("23:30");
DateTime d2 = DateTime.Parse("00:40:00");
DateTime d3 = d1.Add(d2.TimeOfDay); 
Console.WriteLine(d3.TimeOfDay); // 00:10:00 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-02-04T10:55:40.880

从字符串中添加两个日期时间：

```
var result = DateTime.Parse(firstDate) + DateTime.Parse(secondDate); 
```

将字符串时间添加到日期时间：

```
var result = existingDateTime.Add(TimeSpan.Parse(stringTime); 
```

如您的示例中所示添加时间：

```
var result = TimeSpan.Parse("12:30:22") + TimeSpan.Parse("11:20:22"); 
```

最后，您的示例作为日期（未经测试！）：

```
var result = DateTime.Parse("12:30:22") + DateTime.Parse("11:20:22"); 
```

请注意，这是草率的编码，但您明白了。您需要以某种方式验证该字符串实际上是可解析的。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-04T10:22:32.647

不太确定你在追求什么，但你能不能只使用 C# 的 DateTime 对象的内置函数？

```
DateTime myDate = DateTime.Now;

myDate = myDate.AddHours(1);
myDate = myDate.AddMinutes(30);
myDate = myDate.AddSeconds(45); 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-02-04T11:58:55.370

这个问题比较抽象。如前所述，在 .NET 中有两种类型 -`DateTime`和`TimeSpan`. 该`DateTime`类型表示特定的时间点。这不是时间间隔。自宇宙诞生以来，它一直是一个特定的位置。即使您将年/月/日组件设置为 0，它仍然代表某个绝对时间点。不是一段时间。

`TimeSpan`另一方面代表一些间隔。1分钟，2天，随便。它没有指定何时，只是多久。

因此，如果您要减去两个 DateTime 对象，您将得到一个 TimeSpan 对象，该对象指定它们之间的时间。如果您将 TimeSpan 添加到 DateTime，您将获得另一个 DateTime。但是您不能将 DateTime 添加到另一个 DateTime - 这没有任何意义。

在我看来，您应该一直使用`TimeSpan`s，因为您处理的是时间长度，而不是绝对时间点。如果您从源中获取这些长度作为 DateTime 那么这实际上是不正确的，您应该以`TimeSpan`某种方式将它们转换为 s 。解析方法是建议的一种方法，但您也可以尝试从中减去零`DateTime`。这可能会更快，更独立于文化。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-04T10:23:46.920

使用 TimeSpan 结构。您可以将 TimeSpan 添加在一起，也可以将 TimeSpan 添加到 DateTime 以生成新的 DateTime。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-02-04T10:59:50.810

你应该看看[TimeSpan.Parse](http://msdn.microsoft.com/en-us/library/system.timespan.parse.aspx)。这会将字符串转换为 TimeSpan 对象。这样你就可以做类似的事情

```
TimeSpan a = TimeSpan.Parse(timeStringA)+TimeSpan.Parse(TimeStringB); 
```

要拆分像 "00:00:20+00:01:00" 这样的字符串，请查看[string.split](http://msdn.microsoft.com/en-us/library/system.string.split.aspx)

```
stringA = timeSting.split('+')[0];
stringb = timeSting.split('+')[1]; 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-08-06T21:50:39.620

```
return string.Format("{0}:{1}:{2}", mytimespan.Hours 
    + (mytimespan.Days*24),mytimespan.Minutes,mytimespan.Seconds); 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2015-03-23T03:50:01.107

```
 static void Main(string[] args)
    {
        String timeText = "3/23/2015 12:00:13 AM"; 
        String timeText2 = "3/23/2015 1:45:03 AM"; 

        DateTime time = Convert.ToDateTime(timeText);
        string temp = time.ToString("HH:mm:ss");

        DateTime time2 = Convert.ToDateTime(timeText2);
        string temp2 = time2.ToString("HH:mm:ss");

        TimeSpan t1 = TimeSpan.Parse(temp);
        TimeSpan t2 = TimeSpan.Parse(temp2);

        Console.Out.WriteLine(t1 + t2);  // 01:45:16

        Console.ReadLine();
    } 
```

# javascript - 调用从 Ajax 响应返回的 JavaScript 函数

> ID：510779
> 
> 赞同：69
> 
> 时间：2009-02-04T10:18:21.500
> 
> 标签：javascript, ajax, function

我有一个发送 Ajax 命令的系统，该命令返回一个包含函数的脚本块。将此数据正确插入 DIV 后，我希望能够调用此函数来执行所需的操作。

这可能吗？

* * *

## 回答 #1

> 赞同：74
> 
> 时间：2009-02-04T13:10:31.043

我想以这种形式正确解释您的问题：“好的，我已经完成了所有 Ajax 的工作；我只想知道我的 Ajax 回调插入到 DIV 中的 JavaScript 函数是否可以从那一刻起随时调用，也就是说，我不想在上下文中调用它来回调“返回”。

好的，如果您的意思是这样的话，答案是肯定的，您可以在浏览器中页面持久化期间的任何时候调用您的新代码，条件如下：

1) Ajax 回调返回的 JavaScript 代码在语法上必须是正确的；
2）即使你的函数声明被插入到`<script>`现有`<div>`元素的块中，浏览器也不会知道新函数的存在，因为声明代码从未被执行过。因此，您必须`eval()`由 Ajax 回调返回您的声明代码，以便有效地声明您的新函数并使其在整个页面生命周期内可用。

即使很愚蠢，这段代码也解释了这个想法：

```
<html>
    <body>
        <div id="div1">
        </div>
        <div id="div2">
            <input type="button" value="Go!" onclick="go()" />
        </div>
        <script type="text/javascript">
            var newsc = '<script id="sc1" type="text/javascript">function go() { alert("GO!") }<\/script>';
            var e = document.getElementById('div1');
            e.innerHTML = newsc;
            eval(document.getElementById('sc1').innerHTML);
        </script>
    </body>
</html> 
```

我没有使用 Ajax，但概念是一样的（即使我选择的示例肯定不是很聪明:-)

一般来说，我不质疑您的解决方案设计，即在单独的 .js 文件等中外部化 + 概括功能是否或多或少合适，但请注意，这样的解决方案可能会引发进一步的问题，特别是如果您的 Ajax 调用应该重复，即如果同一函数的上下文应该更改，或者是否应该考虑声明的函数持久性，所以也许您应该认真考虑将您的设计更改为该线程中建议的示例之一。

最后，如果我误解了您的问题，并且您在谈论Ajax 回调返回时函数的*上下文*调用，那么我的感觉是建议[krosenvold 描述](https://stackoverflow.com/questions/510779/calling-a-javascript-function-returned-from-a-ajax-response/510818#510818)的 Prototype 方法，因为它是跨浏览器、经过测试且功能齐全，这可以为您未来的实施提供更好的路线图。

* * *

## 回答 #2

> 赞同：42
> 
> 时间：2012-04-09T12:46:11.900

> **注意**： eval() 很容易被滥用，假设请求被第三方拦截并向您发送不受信任的代码。然后使用 eval() 您将运行这个不受信任的代码。请参阅此处了解[eval() 的危险](https://stackoverflow.com/questions/197769/when-is-javascripts-eval-not-evil)。

* * *

在返回的 HTML/Ajax/JavaScript 文件中，您将拥有一个 JavaScript 标记。给它一个 ID，比如*runscript*。在这些标签中添加 id 并不常见，但需要专门引用它。

```
<script type="text/javascript" id="runscript">
    alert("running from main");
</script> 
```

在主窗口中，通过仅评估新的 JavaScript 代码块来调用 eval 函数（在本例中，它称为*runscript*）：

```
eval(document.getElementById("runscript").innerHTML); 
```

它至少在 Internet Explorer 9 和 Google Chrome 中有效。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-02-04T10:29:00.387

这是完全可能的，甚至有一些相当合理的用例。使用[Prototype](http://en.wikipedia.org/wiki/Prototype_JavaScript_Framework)框架完成如下。

```
new Ajax.Updater('items', '/items.url', {
    parameters: { evalJS: true}
}); 
```

请参阅Ajax 更新程序的[文档](http://www.prototypejs.org/api/ajax/updater)。这些选项在[通用选项集中](http://www.prototypejs.org/api/ajax/options)。像往常一样，有一些关于“this”指向的警告，所以请阅读细则。

JavaScript 代码将在加载时进行评估。如果内容包含功能`myFunc(),` ，您真的可以`myFunc()`事后说。也许如下。

```
if (window["myFunc"])
   myFunc() 
```

这将检查函数是否存在。也许有人有更好的跨浏览器方式来做这在 Internet Explorer 6 中有效。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-02-04T10:21:52.163

对于您的代码来说，这似乎是一个相当奇怪的设计 - 通常让您的函数直接从 .js 文件调用更有意义，然后只使用 Ajax 调用检索数据。

但是，我相信它应该通过在响应上调用[eval()来工作——只要它是语法正确的 JavaScript 代码。](http://www.w3schools.com/jsref/jsref_eval.asp)

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-02-04T10:22:27.983

使用 jQuery，我会使用[getScript](http://docs.jquery.com/Ajax/jQuery.getScript#urlcallback)

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2011-02-24T17:52:03.013

请记住，如果您通过 ajax 以下面的方式创建函数...

```
function foo()
{
    console.log('foo');
} 
```

...并通过 eval 执行它，您可能会遇到上下文问题。将此作为您的回调函数：

```
function callback(result)
{
    responseDiv = document.getElementById('responseDiv');
    responseDiv.innerHTML = result;
    scripts = responseDiv.getElementsByTagName('script');
    eval(scripts[0]);
} 
```

您将在函数内部声明一个函数，因此这个新函数只能在该范围内访问。

如果你想在这种情况下创建一个全局函数，你可以这样声明它：

```
window.foo = function ()
{
    console.log('foo');
}; 
```

但是，我也认为你不应该这样做......

抱歉这里有任何错误...

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2012-06-25T13:55:35.353

我想补充一点，jQuery 中有一个 eval 函数，允许您全局评估代码，这应该可以让您摆脱任何上下文问题。该函数称为[globalEval()](http://api.jquery.com/jQuery.globalEval/)，它对我的​​目的非常有用。它的文档可以在[这里](http://api.jquery.com/jQuery.globalEval/)找到。

这是 jQuery API 文档提供的示例代码：

```
function test()
{
  jQuery.globalEval("var newVar = true;")
}

test();
// newVar === true 
```

在动态加载您显然试图做的外部脚本时，此功能非常有用。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2011-07-07T12:43:28.317

做这样的事情的清单：

1.  返回的 Ajax 响应是 eval(ed)。
2.  函数以形式声明`func_name = function() {...}`

[更好的是，使用像Prototype](http://en.wikipedia.org/wiki/Prototype_JavaScript_Framework)一样处理它的框架。你有`Ajax.updater`.

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2013-07-02T12:44:19.083

PHP 端代码 文件名 class.sendCode.php

```
<?php
class  sendCode{ 

function __construct($dateini,$datefin) {

            echo $this->printCode($dateini,$datefin);
        }

    function printCode($dateini,$datefin){

        $code =" alert ('code Coming from AJAX {$this->dateini} and {$this->datefin}');";
//Insert all the code you want to execute, 
//only javascript or Jquery code , dont incluce <script> tags
            return $code ;
    }
}
new sendCode($_POST['dateini'],$_POST['datefin']); 
```

现在，您必须从您的 Html 页面触发 ajax 函数来发送数据。

```
....  <script src="http://code.jquery.com/jquery-1.9.1.js"></script> ....
Date begin: <input type="text" id="startdate"><br>
Date end : <input type="text" id="enddate"><br>
<input type="button" value="validate'" onclick="triggerAjax()"/> 
```

现在在我们的本地 script.js 中，我们将定义 ajax

```
function triggerAjax() {
    $.ajax({
            type: "POST",
            url: 'class.sendCode.php',
            dataType: "HTML",
            data : {

                dateini : $('#startdate').val(),
                datefin : $('#enddate').val()},

                  success: function(data){
                      $.globalEval(data);
// here is where the magic is made by executing the data that comes from
// the php class.  That is our javascript code to be executed
                  }

        });
} 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2013-06-26T14:11:01.967

此代码也可以工作，而不是评估 html 我将脚本附加到头部

```
function RunJS(objID) {
//alert(http_request.responseText);
var c="";
var ob = document.getElementById(objID).getElementsByTagName("script");
for (var i=0; i < ob.length - 1; i++) {
    if (ob[i + 1].text != null) 
       c+=ob[i + 1].text;
}
var s = document.createElement("script");
s.type = "text/javascript";
s.text = c;
document.getElementsByTagName("head")[0].appendChild(s);
} 
```

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2016-07-27T11:43:27.800

我常用的ajax调用函数：

```
function xhr_new(targetId, url, busyMsg, finishCB)
{
    var xhr;

    if(busyMsg !== undefined)
        document.getElementById(targetId).innerHTML = busyMsg;

    try { xhr = new ActiveXObject('Msxml2.XMLHTTP'); }
    catch(e)
    {
        try { xhr = new ActiveXObject('Microsoft.XMLHTTP'); }
        catch(e2)
        {
            try { xhr = new XMLHttpRequest(); }
            catch(e3) { xhr = false; }
        }
    }

    xhr.onreadystatechange = function()
    {
        if(xhr.readyState == 4)
        {
            if(xhr.status == 200)
            {
                var target = document.getElementById(targetId)
                target.innerHTML = xhr.responseText;
                var scriptElements = target.getElementsByTagName("script");
                var i;
                for(i = 0; i < scriptElements.length; i++)
                    eval(scriptElements[i].innerHTML);
                if(finishCB !== undefined)
                    finishCB();
            }
            else
                document.getElementById(targetId).innerHTML = 'Error code: ' + xhr.status;
        }
    };

    xhr.open('GET', url, true);
    xhr.send(null);
    // return xhr;
} 
```

一些解释：
`targetId`是一个（通常是 div）元素 ID，ajax 调用结果文本将放在其中。
`url`是 ajax 调用 url。
`busyMsg`将是目标元素中的临时文本。
`finishCB`将在 ajax 事务成功完成时调用。
如您所见，`xhr.onreadystatechange = function() {...}`所有`<script>`元素都将从 ajax 响应中收集，并将一一运行。它似乎对我很有效。最后两个参数是可选的。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-02-04T10:23:23.237

这听起来不是一个好主意。

您应该从 Ajax 方法返回的数据中抽象出要包含在其余 JavaScript 代码中的函数。

但是，对于它的价值（我不明白为什么要在 div 中插入脚本块？），即使是在脚本块中编写的内联脚本方法也可以访问。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2011-12-31T20:10:07.253

我已经对此进行了测试，并且可以正常工作。有什么问题？只需将新函数放入您的 javascript 元素中，然后调用它。它会起作用的。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2012-12-09T15:02:54.330

我尝试了这里提供的所有技术，但最终可行的方法是将 JavaScript 函数放在应该发生的页面/文件中，并从 Ajax 的响应部分简单地作为函数调用它：

```
...
}, function(data) {
    afterOrder();
} 
```

这是第一次尝试，所以我决定分享。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2014-02-05T22:00:05.840

我今天通过将我的 JavaScript 放在响应 HTML 的底部解决了这个问题。

我有一个 AJAX 请求，它返回了一堆显示在叠加层中的 HTML。我需要将点击事件附加到返回的响应 HTML/覆盖中的按钮。在普通页面上，我会将我的 JavaScript 包装在“window.onload”或“$(document).ready”中，以便在呈现新叠加层的 DOM 后，它将事件处理程序附加到 DOM 对象，但是因为这是 AJAX 响应而不是新页面加载，所以该事件从未发生，浏览器从未执行我的 JavaScript，我的事件处理程序从未附加到 DOM 元素，我的新功能也不起作用。同样，我通过不在文档头部使用“$(document).ready”解决了我的“在 AJAX 响应问题中执行 JavaScript”，

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2015-10-09T20:30:25.590

如果您的 AJAX 脚本运行时间超过几毫秒，则 eval() 将始终提前运行并在 AJAX 使用您尝试执行的脚本填充它之前评估空响应元素。

与其纠结于时间和 eval()，这里有一个非常简单的解决方法，它应该适用于大多数情况，并且可能更安全一些。使用 eval() 通常不受欢迎，因为被评估为代码的字符很容易在客户端进行操作。

## 概念

1.  在主页中包含您的 javascript 函数。编写它以便可以接受任何动态元素作为参数。
2.  在您的 AJAX 文件中，使用官方 DOM 事件（onclick、onfocus、onblur、onload 等）调用该函数。根据您的响应中的其他元素，您可以非常巧妙地让它感觉无缝。将您的动态元素作为参数传递。
3.  当您的响应元素被填充并且事件发生时，该函数将运行。

## 例子

在此示例中，我想在将元素添加到页面后将来自 jquery-ui 库的动态自动完成列表附加到 AJAX 元素。容易，对吧？

**开始.php**

```
<!DOCTYPE html>
<html>
<head>
<title>Demo</title>
<!-- these libraries are for the autocomplete() function -->
<link rel="stylesheet" type="text/css" href="http://ajax.googleapis.com/ajax/libs/jqueryui/1.11.4/themes/ui-lightness/jquery-ui.css">
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
<script src="http://ajax.googleapis.com/ajax/libs/jqueryui/1.11.4/jquery-ui.min.js"></script>
<script type="text/javascript">
<!--
// this is the ajax call
function editDemoText(ElementID,initialValue) {
    try { ajaxRequest = new XMLHttpRequest();
    } catch (e) {
    try { ajaxRequest = new ActiveXObject("Msxml2.XMLHTTP");
    } catch (e) {
    try { ajaxRequest = new ActiveXObject("Microsoft.XMLHTTP");
    } catch (e) {
    return false;
    }}}
    ajaxRequest.onreadystatechange = function() {
        if ( ajaxRequest.readyState == 4 ) {
            var ajaxDisplay = document.getElementById('responseDiv');
            ajaxDisplay.innerHTML = ajaxRequest.responseText;
            }
        }
    var queryString = "?ElementID="+ElementID+"&initialValue="+initialValue;
    ajaxRequest.open("GET", "ajaxRequest.php"+queryString, true);
    ajaxRequest.send(null);
    }

// this is the function we wanted to call in AJAX, 
// but we put it here instead with an argument (ElementID)
function AttachAutocomplete(ElementID) {
    // this list is static, but can easily be pulled in from 
    // a database using PHP. That would look something like this:
    /*
     * $list = "";
     * $r = mysqli_query($mysqli_link, "SELECT element FROM table");
     * while ( $row = mysqli_fetch_array($r) ) {
     *    $list .= "\".str_replace('"','\"',$row['element'])."\",";
     *    }
     * $list = rtrim($list,",");
     */
    var availableIDs = ["Demo1","Demo2","Demo3","Demo4"];
    $("#"+ElementID).autocomplete({ source: availableIDs });
    }
//-->
</script>
</head>
<body>
<!-- this is where the AJAX response sneaks in after DOM is loaded -->
<!-- we're using an onclick event to trigger the initial AJAX call -->
<div id="responseDiv"><a href="javascript:void(0);" onclick="editDemoText('EditableText','I am editable!');">I am editable!</a></div>
</body>
</html> 
```

**ajaxRequest.php**

```
<?php
// for this application, onfocus works well because we wouldn't really 
// need the autocomplete populated until the user begins typing
echo "<input type=\"text\" id=\"".$_GET['ElementID']."\" onfocus=\"AttachAutocomplete('".$_GET['ElementID']."');\" value=\"".$_GET['initialValue']."\" />\n";
?> 
```

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2021-03-02T16:31:49.510

我需要做点什么，我发现这对我来说已经工作了很长时间，只是将其作为众多解决方案之一发布在这里，我喜欢没有 jQuery 的解决方案，以下功能可能会对您有所帮助，您可以通过包含脚本标签的完整html，它将解析和执行。

```
function parseScript(_source) {
    var source = _source;
    var scripts = new Array();

    // Strip out tags
    while(source.indexOf("<script") > -1 || source.indexOf("</script") > -1) {
        var s = source.indexOf("<script");
        var s_e = source.indexOf(">", s);
        var e = source.indexOf("</script", s);
        var e_e = source.indexOf(">", e);

        // Add to scripts array
        scripts.push(source.substring(s_e+1, e));
        // Strip from source
        source = source.substring(0, s) + source.substring(e_e+1);
        }

        // Loop through every script collected and eval it
        for(var i=0; i<scripts.length; i++) {
        try {
        if (scripts[i] != '')
        {
        try  {          //IE
            execScript(scripts[i]);
        }
        catch(ex)           //Firefox
        {
            window.eval(scripts[i]);
        }

        }
        }
        catch(e) {
           // do what you want here when a script fails
           if (e instanceof SyntaxError) console.log (e.message+' - '+scripts[i]);
        }
        }
        // Return the cleaned source
        return source;
} 
```

* * *

## 回答 #18

> 赞同：-1
> 
> 时间：2016-07-13T15:50:13.517

[Federico Zancan 的回答](https://stackoverflow.com/a/511273/531524)是正确的，但您不必为脚本提供 ID 并评估所有脚本。只需评估您的函数名称即可调用它。

为了在我们的项目中实现这一点，我们编写了一个代理函数来调用 Ajax 响应中返回的函数。

```
function FunctionProxy(functionName){
    var func = eval(functionName);
    func();
} 
```

# java - Java 中的继承 - “找不到符号构造函数”

> ID：510784
> 
> 赞同：10
> 
> 时间：2009-02-04T10:19:36.460
> 
> 标签：java, inheritance, polymorphism

我正在研究一个从另一个类继承的类，但我收到一个编译器错误，提示“找不到符号构造函数 Account()”。基本上，我要做的是创建一个从 Account 扩展的类 InvestmentAccount - Account 旨在通过提取/存入资金的方法保持余额，而 InvestmentAccount 类似，但余额存储在股票中，股价决定如何给定特定数量的资金，许多股票被存入或取出。这是子类 InvestmentAccount 的前几行（编译器指出问题的地方）：

```
public class InvestmentAccount extends Account
{
    protected int sharePrice;
    protected int numShares;
    private Person customer;

    public InvestmentAccount(Person customer, int sharePrice)
    {
        this.customer = customer;
        sharePrice = sharePrice;
    }
    // etc... 
```

Person 类保存在另一个文件 (Person.java) 中。现在这里是超类 Account 的前几行：

```
public class Account 
{
    private Person customer;
    protected int balanceInPence;

    public Account(Person customer)
    {
        this.customer = customer;
        balanceInPence = 0;
    }
    // etc... 
```

为什么编译器不只是从 Account 类中读取 Account 的符号构造函数？或者我是否需要在 InvestmentAccount 中为 Account 定义一个新的构造函数，告诉它继承所有内容？

谢谢

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2009-02-04T10:21:38.123

`super(customer)`在`InvestmentAccount`s 构造函数中使用。

Java 无法知道如何调用**唯一**的构造函数`Account`，因为它不是*空的构造函数*。`super()`只有当你的基类有一个空的构造函数时，你才能省略。

改变

```
public InvestmentAccount(Person customer, int sharePrice)
{
        this.customer = customer;
        sharePrice = sharePrice;
} 
```

到

```
public InvestmentAccount(Person customer, int sharePrice)
{
        super(customer);
        sharePrice = sharePrice;
} 
```

那可行。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-04T10:28:45.427

您必须调用超类构造函数，否则 Java 将不知道您正在调用哪个构造函数来在子类上构建超类。

```
public class InvestmentAccount extends Account {
    protected int sharePrice;
    protected int numShares;
    private Person customer;

    public InvestmentAccount(Person customer, int sharePrice) {
        super(customer);
        this.customer = customer;
        sharePrice = sharePrice;
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-04T10:23:07.513

如果基类没有默认构造函数（没有参数的构造函数），则必须显式调用基类的构造函数。

在您的情况下，构造函数应该是：

```
public InvestmentAccount(Person customer, int sharePrice) {
    super(customer);
    sharePrice = sharePrice;
} 
```

并且不要重新定义`customer`为子类的实例变量！

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-04T10:23:39.913

调用 super() 方法。如果要调用 Account(Person) 构造函数，请使用语句 super(customer); 这也应该是您的 InvestmentAccount 构造函数中的第一个语句

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-04T10:23:55.217

在类中定义一个默认构造函数`Account`：

```
public Account() {} 
```

或者调用`super(customer)`构造`InvestmentAccount`函数。

# c++ - 如何将接口指针传递给线程？

> ID：510788
> 
> 赞同：6
> 
> 时间：2009-02-04T10:20:13.820
> 
> 标签：c++, multithreading, com, interface, marshalling

**笔记：**

*   使用**原始 Win32** CreateTheard() API
*   没有 MFC
*   接口只是一个指向 vtable 的指针

**问题：**

*   如何将接口指针传递给线程？

**插图：**

```
IS8Simulation *pis8 = NULL;

...

CoCreateInstance(
                 clsid,
                 NULL,
                 CLSCTX_LOCAL_SERVER,
                 __uuidof(IS8Simulation),
                 (void **) &pis8);

...

hThread = CreateThread(
                NULL,
                0,
                SecondaryThread,
                //interface pointer pis8
                0,
                &dwGenericThreadID);

...

DWORD WINAPI SecondaryThread(LPVOID iValue)
{
    //using iValue accordingly
    //E.g.: iValue->Open 
```

问候

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-04T10:23:39.570

如下所述，`COM`在线程之间传递接口指针是不安全的。

假设您知道自己在做什么：

```
hThread = CreateThread(
                NULL,
                        0,
                        SecondaryThread,
                        (LPVOID) pis8
                        0,
                        &dwGenericThreadID);

DWORD WINAPI SecondaryThread(LPVOID iValue)
{
   ((IS8Simulation*) iValue)->Open();
} 
```

线程安全版本：

```
void MainThread()
{
    IStream* psis8;
    HRESULT res = CoMarshalInterThreadInterfaceInStream (IID_IS8SIMULATION, pis8, &psis8);
    if (FAILED(res))
         return;
    hThread = CreateThread(
                NULL,
                0,
                SecondaryThread,
                (LPVOID) psis8
                0,
                &dwGenericThreadID
          );
}

DWORD WINAPI SecondaryThread(LPVOID iValue)
{
   IS8Simulation* pis8;
   HRESULT res = CoGetInterfaceAndReleaseStream((IStream*) iValue, IID_IS8SIMULATION, &pis8);
   if (FAILED(res))
      return (DWORD) res;
   pis8->Open();
} 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-02-04T13:58:51.510

如果您问题中的接口是 COM 接口，则 Quassnoi 提供的方法可能还不够。您必须注意正在使用的 COM 对象的线程模型。如果辅助线程将加入与创建 COM 对象的 COM 单元不同的 COM 单元，并且如果该对象不是*apartment-agile*，则需要编组该接口指针，以便辅助线程获得代理，并且不是指向对象的直接指针。

COM 对象通常通过使用 IMarshal 的特殊实现来实现单元敏捷。最简单的方法是聚合 Free Threaded Marshaler。

一些有用的链接...

*   [CoMarshalInterThreadInterfaceInStream](http://msdn.microsoft.com/en-us/library/ms693316.aspx)
*   [全局接口表 (GIT)](http://msdn.microsoft.com/en-us/library/ms693729(VS.85).aspx)
*   [CoCreateFreeThreadedMarshaler](http://msdn.microsoft.com/en-us/library/ms694500.aspx)

更新：关于自由线程编组器...

从有关该主题的评论中可以清楚地看出，有些人会建议您永远不要触摸 FTM。虽然“Effective COM”是一本优秀的书，但我认为它的一些建议是可以解释的。第 33 条说“小心 FTM”；它没有说“永远不要使用 FTM”。非常明智地，它建议谨慎，特别是当您的单元敏捷对象包含对其他对象的引用时，因为它们可能不是单元敏捷的。所以真正的建议是：在构建公寓敏捷对象时要仔细考虑，无论他们是否使用 FTM 来实现他们的敏捷性。如果您确定您可以构建一个灵活的公寓对象，我认为您没有理由不使用 FTM 来实现这一目标。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-04T14:25:20.113

您基本上需要执行以下操作：

*   `CoMashalInterThreadInterfaceInStream`==> 你得到一个 IStream 接口。
*   将该IStream 传递给线程，例如Quassnoi 所说的。
*   在 SecondaryThread 中，调用`CoGetInterfaceAndReleaseStream`以获取接口（或它的代理，如有必要）。

除非创建线程失败，否则不要释放 IStream 接口，直到调用`CoGetInterfaceAndReleaseStream`.

COM 运行时会自动为您创建代理。代理确保在创建它的线程上调用例如单元线程 COM 组件。但是，这也需要：

*   接口为IDispatch，或者为接口注册了proxy/stub组件
*   创建组件的线程有一个消息循环并处理消息

# winapi - Win32 控制台应用程序是否可以检测它是否已从资源管理器运行？

> ID：510805
> 
> 赞同：38
> 
> 时间：2009-02-04T10:25:01.330
> 
> 标签：winapi, console

我必须创建一个需要某些参数的控制台应用程序。如果它们丢失或错误，我会打印出错误消息。

现在的问题：如果有人通过双击控制台窗口从资源管理器启动程序立即消失。（但该应用程序在资源管理器中并非完全没用，您可以将文件拖到它上面就可以了）

我*总是*可以等待按键，但如果用户确实从命令行启动它，我不希望这样。

有什么方法可以区分这些情况吗？

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2009-02-04T22:03:00.563

请参阅[http://support.microsoft.com/kb/99115](http://support.microsoft.com/kb/99115)，“信息：防止控制台窗口消失”。

这个想法是使用 GetConsoleScreenBufferInfo 来确定光标没有从最初的 0,0 位置移动。

来自@tomlogic 的代码示例，基于参考的知识库文章：

```
// call in main() before printing to stdout
// returns TRUE if program is in its own console (cursor at 0,0) or
// FALSE if it was launched from an existing console.
// See http://support.microsoft.com/kb/99115
#include <stdio.h>
#include <windows.h>
int separate_console( void)
{
    CONSOLE_SCREEN_BUFFER_INFO csbi;

    if (!GetConsoleScreenBufferInfo( GetStdHandle( STD_OUTPUT_HANDLE), &csbi))
    {
        printf( "GetConsoleScreenBufferInfo failed: %lu\n", GetLastError());
        return FALSE;
    }

    // if cursor position is (0,0) then we were launched in a separate console
    return ((!csbi.dwCursorPosition.X) && (!csbi.dwCursorPosition.Y));
} 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2010-08-10T12:11:23.477

[`GetConsoleTitle()`](http://msdn.microsoft.com/en-us/library/ms683174%28VS.85%29.aspx)

我见过执行的代码

```
if (!GetConsoleTitle(NULL, 0) && GetLastError() == ERROR_SUCCESS) {
    // Console
} else {
    // GUI
} 
```

但是...我发现这[`AttachConsole()`](http://msdn.microsoft.com/en-us/library/ms681952%28VS.85%29.aspx)更有帮助

在 C++ 中（在我脑海中，我不是 C++ 程序员）

```
if (!AttachConsole(ATTACH_PARENT_PROCESS)) {
    // GUI
} else {
    // Console, and you have a handle to the console that already exists.
} 
```

更有效。此外，如果您发现自己处于 GUI 环境中并希望尽可能长时间地呆在那里，但后来发现发生了一些灾难性的事情，这可能真正使用转储到控制台窗口（您不能因为编写编辑框而感到羞耻）窗口将其批量或附加到 NT 系统日志并抛出一个`MessageBox()`) ，然后您可以`AllocConsole()`稍后在该过程中，当 GUI 方法失败时。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2020-11-15T08:46:43.653

我找到了一个更好的解决方案，使用 GetConsoleProcessList 将附加的进程计数获取到当前控制台。如果此进程是唯一附加的进程，它将在进程存在时关闭。

我在帖子中找到它[https://devblogs.microsoft.com/oldnewthing/20160125-00/?p=92922](https://devblogs.microsoft.com/oldnewthing/20160125-00/?p=92922) 但它有一个错误（至少在 Windows 10 中），因为文档禁止使用 null 调用此函数。

我的解决方案是：

```
DWORD procId;
DWORD count = GetConsoleProcessList(&procId, 1);
if (count < 2) ... 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-02-04T11:06:25.243

我相信`cmd.exe`在启动时会设置 CMDCMDLINE 和 CMDEXTVERSION 环境变量。因此，如果设置了这些，您的程序很可能是从 shell 启动的。

这不是万无一失的，但它是一些东西。

也可以通过一些复杂且可能不可靠的方式确定您的父 PID，或者我收集。你可能想调查一下。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2021-10-20T10:55:54.697

这是适用于 C# 的 @DanielBenSassoon 的出色答案。在 Visual Studio 2019 和 Windows 10 中测试。

```
// Gets a list of the process IDs attached to this console
[DllImport("kernel32.dll", SetLastError = true)]
private static extern uint GetConsoleProcessList(uint[] processList, uint processCount);

public static bool IsFinalProcess()
{
    // See: https://devblogs.microsoft.com/oldnewthing/20160125-00/?p=92922
    uint[] procIDs = new uint[64];
    uint processCount = GetConsoleProcessList(procIDs, 64);
    return (processCount < 2);
} 
```

这种方法允许您区分四种情况：

*   从 IDE 调试 (F5) [进程计数 = 1]
*   从 IDE 运行，但不调试 (Ctrl + F5) [进程计数 = 2]
*   在资源管理器中双击 [进程计数 = 1]
*   从命令提示符窗口运行 [进程计数 = 2]

当`IsFinalProcess`为 true 时，您可以使用它`Console.ReadKey(false);`来防止应用程序退出后控制台窗口消失。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-07-10T07:47:35.253

**编辑：我已经成功使用这个 .bat/.cmd 包装器几年了：**

```
@ECHO OFF

REM Determine if script was executed from an interactive shell
(echo %CMDCMDLINE% | find /i "%~0" >NUL 2>&1) && (set IS_INTERACTIVE=false) || (set IS_INTERACTIVE=true)

<call console application here>

REM Wait for keystroke
if "%IS_INTERACTIVE%" == "false" (
        echo.
        echo Hit any key to close.
        pause >NUL 2>&1
) 
```

这里的优点是这将适用于所有控制台应用程序，无论是您自己的还是其他人的（您可能没有可以修改的源）。缺点是，你有一个单独的包装器。

* * *

**我在 2014 年的原始答案是这样的：**

这就像一个魅力：

```
@echo off
for %%x in (%cmdcmdline%) do if /i "%%~x"=="/c" goto nonconsole

:console
<do something>
goto exit

:nonconsole
<do something>
pause

:exit 
```

[从这个线程](https://stackoverflow.com/questions/3551888/pausing-a-batch-file-when-double-clicked-but-not-when-run-from-a-console-window)复制。我也尝试自己评估 %cmdcmdline%，但是存在关于引号字符 (") 的问题，这会阻止*if "%cmdcmdline%" == "%ComSpec%" goto [target] 之*类的工作。

# cocoa-touch - 在单个 UINavigationController 中的两个 UITableViewController 之间切换

> ID：510810
> 
> 赞同：1
> 
> 时间：2009-02-04T10:26:36.117
> 
> 标签：cocoa-touch

我有一个 UINavigationController。在它的工具栏中是一个带有两个按钮的分段控件。每个按钮都与它自己的 UITableViewController 相关。

我想要实现的是以某种方式连接导航控制器，以便根据分段控件中的哪个按钮处于活动状态来切换视图。

我假设我应该保留表格控制器，因为我想保留每个视图中的滚动位置，例如，如果用户位于表格 1 的顶部和表格 2 的底部，那么应该保留此信息切换时。

任何建议将不胜感激！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-04T10:46:03.130

是否可以只切换数据源而不必处理两个单独的表视图？保留滚动位置仍然可以很容易地完成，并且您最终会使用更少的内存（一个表视图和两个数据源，而不是两个表视图和两个数据源）。

只有 128MB 的空闲空间，内存效率是 iPhone 的王者。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-04T13:29:45.687

乔尔的建议很好。另一种可能性是在您的视图控制器中使用两个不同的 UITableView，然后手动将它们换掉。UITableViewController 没有什么特别之处；它只是一个 UIViewController，它为你设置了 tableView。使用标准的 UIViewController，为表格添加两个出口，隐藏一个，并在切换 UISegmentedControl 时交换它们。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-04T17:20:01.650

我用过乔尔的方法。非常有效率。

使用分段控件调用设置变量的方法，然后发送[tableView reloadData]。

然后 tableView: numberOfRowsInSection: 和 tableView: cellForRowAtIndexPath: 根据分段控件方法设置的变量值检索它们的数据。

# sql - VS2008 将查询结果保存到文件/xml

> ID：510812
> 
> 赞同：1
> 
> 时间：2009-02-04T10:27:37.957
> 
> 标签：sql, visual-studio-2008

当我在 VS2008 中使用查询设计器时，如何将结果保存到文件中？

输出窗口正在截断 XML 数据类型 - 即使它没有截断，它仍然需要剪切和粘贴才能将结果保存到文件中。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-22T21:18:20.183

我不认为内置的 VS2008 查询设计器是为该任务设计的。它适用于设计和调整查询 - 但如果您需要真正提取数据，我建议您使用 MS SQL Server Management Studio（如果您使用 SQL Server）或任何其他数据库系统专用前端.

# java - 实时 Java 互操作性

> ID：510820
> 
> 赞同：5
> 
> 时间：2009-02-04T10:29:10.747
> 
> 标签：java, real-time, rtsj, real-time-java

我想知道 JRE6 和 rtsj 的 JVM 之间的互操作性[如何](http://www.rtsj.org)。看来我只能使用它们的实现（因为代码将使用它们的 JVM 来解释），所以我不能使用 Java 6 必须提供的许多特性。它可以支持图形用户界面吗？（例如修改工业过程的参数）。

我可能是错的，希望得到你的一些反馈。

此外，Java 似乎是更实时的实现。你用过哪一个，你最喜欢哪一个？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-16T14:38:50.693

为了提供实时行为，JVM 需要经过专门设计。这包括在操作系统级别进行集成，以访问主机操作系统的实时调度功能。

例如，Sun 实时 JVM 与 J2SE5 兼容。[http://java.sun.com/javase/technologies/realtime/faq.jsp#4](http://java.sun.com/javase/technologies/realtime/faq.jsp#4)

通常，任何提供小众功能（如安全性或实时行为）的系统（OS、JVM 等）的专用实例往往是通用版本之后的发布。

至于使用实时 GUI，您应该使用 JMX、RMI 或 Web 服务（以最轻量级为准）之类的东西来研究使用实时过程的 2 层客户端-服务器控制。在实时代码中直接使用 GUI 似乎会给应用程序带来许多潜在问题，因为它试图在实时约束下执行。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-10T02:29:53.203

有关RTSJ 商业级实现的更多示例，请参阅[我对另一个问题的回答。](https://stackoverflow.com/questions/697916/what-languages-are-used-for-real-time-systems-programming/736502#736502)最新版本 (2.1) 与 JDK1.5 兼容，因此您应该可以使用 Swing/AWT。

虽然编写 GUI 以在与实时进程相同的 JVM 中执行是可行的，但尚不清楚这是否是一个好的架构决策。您更有可能更喜欢隔离 JVM 中的实时行为，并提供一个可分离的接口，该接口在单独的内存空间中实现 GUI。

原则上，您应该能够编写 RTSJ 代码，使其在具有非实时线程的同一个 JVM 中运行（我已经做了很多这样的工作），但要正确同步可能很困难。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-04T13:14:59.617

正如[本书](http://www.informit.com/store/product.aspx?isbn=0130282618)所描述的，Sun Java 的 JRE 和 rtsj 实现之间可以有互操作性。

# python - 如何为用 Python 编写的 DBUS 服务编写功能测试？

> ID：510821
> 
> 赞同：12
> 
> 时间：2009-02-04T10:29:14.193
> 
> 标签：python, unit-testing, dbus

（标题是：“如何为用 Python 编写的 DBUS 服务编写单元测试？”）

我已经开始使用 dbus-python 编写 DBUS 服务，但是我在为它编写测试用例时遇到了麻烦。

这是我正在尝试创建的测试示例。请注意，我在 setUp() 中放置了一个 GLib 事件循环，这就是问题所在：

```
import unittest

import gobject
import dbus
import dbus.service
import dbus.glib

class MyDBUSService(dbus.service.Object):
    def __init__(self):
        bus_name = dbus.service.BusName('test.helloservice', bus = dbus.SessionBus())
        dbus.service.Object.__init__(self, bus_name, '/test/helloservice')

    @dbus.service.method('test.helloservice')
    def hello(self):
        return "Hello World!"

class BaseTestCase(unittest.TestCase):

    def setUp(self):
        myservice = MyDBUSService()
        loop = gobject.MainLoop()
        loop.run()
        # === Test blocks here ===

    def testHelloService(self):
        bus = dbus.SessionBus()
        helloservice = bus.get_object('test.helloservice', '/test/helloservice')
        hello = helloservice.get_dbus_method('hello', 'test.helloservice')
        assert hello() == "Hello World!"

if __name__ == '__main__':
    unittest.main() 
```

我的问题是 DBUS 实现需要您启动一个事件循环，以便它可以开始调度事件。常见的方法是使用 GLib 的 gobject.MainLoop().start() （虽然我不喜欢这种方法，如果有人有更好的建议）。如果您不启动事件循环，服务仍然会阻塞，您也无法查询它。

如果我在测试中启动我的服务，事件循环会阻止测试完成。我知道该服务正在运行，因为我可以使用 qdbus 工具从外部查询该服务，但我无法在启动它的测试中自动执行此操作。

我正在考虑在测试中进行某种进程分叉来处理这个问题，但我希望有人可能有一个更简洁的解决方案，或者至少是我编写这样一个测试的一个好的起点。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-04T18:46:09.540

在 Ali A 的帖子的帮助下，我设法解决了我的问题。需要将阻塞事件循环启动到一个单独的进程中，以便它可以在不阻塞测试的情况下监听事件。

请注意我的问题标题包含一些不正确的术语，我试图编写功能测试，而不是单元测试。我意识到了这种区别，但直到后来才意识到我的错误。

我已经调整了我的问题中的示例。它与“test_pidavim.py”示例大致相似，但使用“dbus.glib”的导入来处理 glib 循环依赖项，而不是在所有 DBusGMainLoop 内容中进行编码：

```
import unittest

import os
import sys
import subprocess
import time

import dbus
import dbus.service
import dbus.glib
import gobject

class MyDBUSService(dbus.service.Object):

    def __init__(self):
        bus_name = dbus.service.BusName('test.helloservice', bus = dbus.SessionBus())
        dbus.service.Object.__init__(self, bus_name, '/test/helloservice')

    def listen(self):
        loop = gobject.MainLoop()
        loop.run()

    @dbus.service.method('test.helloservice')
    def hello(self):
        return "Hello World!"

class BaseTestCase(unittest.TestCase):

    def setUp(self):
        env = os.environ.copy()
        self.p = subprocess.Popen(['python', './dbus_practice.py', 'server'], env=env)
        # Wait for the service to become available
        time.sleep(1)
        assert self.p.stdout == None
        assert self.p.stderr == None

    def testHelloService(self):
        bus = dbus.SessionBus()
        helloservice = bus.get_object('test.helloservice', '/test/helloservice')
        hello = helloservice.get_dbus_method('hello', 'test.helloservice')
        assert hello() == "Hello World!"

    def tearDown(self):
        # terminate() not supported in Python 2.5
        #self.p.terminate()
        os.kill(self.p.pid, 15)

if __name__ == '__main__':

    arg = ""
    if len(sys.argv) > 1:
        arg = sys.argv[1]

    if arg == "server":
        myservice = MyDBUSService()
        myservice.listen()

    else:
        unittest.main() 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-04T10:52:45.753

简单的解决方案：不要通过 dbus 进行单元测试。

而是编写单元测试来直接调用您的方法。这更自然地符合单元测试的性质。

您可能还需要一些自动化集成测试，通过 dbus 检查运行，但它们不需要如此完整，也不需要单独运行。您可以在单独的进程中进行设置以启动服务器的真实实例。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-04T11:10:34.920

在这里我可能有点不合群，因为我不了解 python 并且只是稍微了解这个神奇的“dbus”是什么，但如果我理解正确，它需要你创建一个带有 runloops 的相当不寻常的测试环境，扩展安装/拆卸等。

您的问题的答案是使用[mocking](http://en.wikipedia.org/wiki/Mock_object)。创建一个定义接口的抽象类，然后从中构建一个对象以在您的实际代码中使用。出于测试的目的，您构建了一个模拟对象，通过相同的接口进行通信，但具有*您*为测试目的而定义的行为。您可以使用这种方法来“模拟” dbus 对象在事件循环中运行、执行一些工作等，然后只需专注于测试您的类应该如何对该对象完成的“工作”结果做出反应。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-04T12:36:02.613

您只需要确保正确处理主循环。

```
def refresh_ui():
    while gtk.events_pending():
       gtk.main_iteration_do(False) 
```

这将运行 gtk 主循环，直到它处理完所有内容，而不仅仅是运行它并阻塞。

有关实践中的完整示例，对 dbus 接口进行单元测试，请访问此处： http: [//pida.co.uk/trac/browser/pida/editors/vim/test_pidavim.py](http://pida.co.uk/trac/browser/pida/editors/vim/test_pidavim.py)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-04-17T20:27:17.623

您也可以在 setUp 方法中非常简单地在单独的线程中启动主循环。

像这样的东西：

```
import threading
class BaseTestCase(unittest.TestCase):
    def setUp(self):
        myservice = MyDBUSService()
        self.loop = gobject.MainLoop()
        threading.Thread(name='glib mainloop', target=self.loop.run)
    def tearDown(self):
        self.loop.quit() 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-09-30T23:13:35.360

查看[python-dbusmock](https://pypi.python.org/pypi/python-dbusmock/0.7.2)库。

它将丑陋的子流程逻辑隐藏在您的眼前，因此您不必在测试中担心它。

# asp.net - 对 .net Web 服务（asmx、wcf 等）进行 AJAX (jquery) 调用时的授权、身份验证，我需要知道什么？

> ID：510827
> 
> 赞同：3
> 
> 时间：2009-02-04T10:39:42.613
> 
> 标签：asp.net, jquery, ajax, authentication, authorization

我正在对基于 AJAX 的 Web 应用程序进行原型设计，该应用程序在 ASP.NET 上运行，我需要对站点的不同部分具有一般授权，并且还必须确保未经授权的用户不能调用各种 Web 方法/Web 服务（例如，来自 rouge html 页面）。

有什么我需要注意的吗，或者做的事情就像我在做常规的 ASP.NET 一样工作？

一组最佳实践或需要注意的事情会很棒。

一个附带问题，与 ASMX 相比，使用 WCF 可以获得什么？

问候，埃吉尔。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-17T04:14:58.750

它的工作方式与常规 ASP.NET 和 ASMX/WCF 基本相同。最大的不同是您需要从客户端使用 Membership API（ASP.NET AJAX 完全支持）。

查看这些资源：

[endpoint.tv - 使用 ASP.NET 成员身份保护 RESTful 服务](http://channel9.msdn.com/shows/Endpoint/endpointtv-Securing-RESTful-services-with-ASPNET-Membership/)

[我如何：使用 ASP.NET AJAX 配置文件服务？](http://www.asp.net/learn/ajax-videos/video-166.aspx)

# javascript - 如何从 JSF 组件中的 javascript 调用中引用“this”？

> ID：510831
> 
> 赞同：1
> 
> 时间：2009-02-04T10:43:48.393
> 
> 标签：javascript, jsf

```
 <h:commandLink id="#{id}" value="#{value}" action="#{actionBean.getAction}" onclick="alert(this);"/> 
```

在前面的简化示例中，Javascript 函数中使用的 'this' 关键字不会引用生成的 A HREF 元素，而是会引用全局窗口，因为 JSF 生成以下（简化的）代码：

```
<a onclick="var a=function(){alert(this)};var b=function(){if(typeof jsfcljs == 'function'){jsfcljs(document.forms['mainForm'],'generatedId,action,action','');}return false};return (a()==false) ? false : b();" href="#" id="generatedId">text</a> 
```

所以因为 JSF 将用户定义的 onclick 包装在一个函数中，这将指向全局窗口。我无权访问元素的 id，因为我的代码用于可用于循环等的通用组件中，并且我不使用支持 bean（Facelets + JSF）。

所以我的问题是，有没有办法从我的 onclick javascript 函数中访问 A HREF 元素，而不知道 id？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-04T12:47:05.927

> var a=function(){alert(this)};var b=function(){if(typeof jsfcljs == 'function'){jsfcljs(document.forms['mainForm'],'generatedId,action,action', '');}return false};return (a()==false) ? 假：b（）；

哦，亲爱的主！这太可怕了。

不，它似乎在你有机会看到它之前就把它扔掉了——它*应该*说“return (a.call(this)==false)?false : b()”。

只有在 IE 上，您才能从 window.event 中读取 srcElement，但这非常难看。

通过使用不显眼的脚本来完全避免 JSF 的奇怪事件处理如何？例如。省略 onclick 并说：

```
document.getElementById('generatedId').onclick= function() {
    alert(this);
    return false; // if you want to not follow the link
} 
```

如果您需要链接继续 JSF 的事件处理，您必须保存旧的 onclick 事件处理程序并在函数末尾调用它，或者使用 Element.addEventListener（IE 上的attachEvent）将您的脚本挂钩放在比 onclick 更早的阶段。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-09T11:25:55.697

编辑：

转到此处获取用于从*id*获取*clientId*的小型库/示例代码：[JSF：使用组件 ID](http://illegalargumentexception.blogspot.com/2009/02/jsf-working-with-component-ids.html)

 ** * *

JSF 控件发出的 HTML ID 被命名空间以避免冲突（例如，控件是 UIData 的子项并多次发出，或者容器是[portlet](http://en.wikipedia.org/wiki/Java_Portlet_Specification)，因此视图可以在一个 HTML 页面中多次呈现）。此 ID 称为 clientId，与 JSF 控件上设置的 ID 不同。

如果要在视图中发出 clientId，可以使用托管 bean 来完成。

```
public class JavaScriptBean {

    public String getOnclickButton1() {
        String id = "button1";
        String clientId = getClientId(id);
        return "alert('You clicked element id=" + clientId + "');";
    }

    public String getOnclickButton2() {
        String id = "button2";
        String clientId = getClientId(id);
        return clientId;
    }

    private String getClientId(String id) {
        FacesContext context = FacesContext.getCurrentInstance();
        UIViewRoot view = context.getViewRoot();
        UIComponent component = find(view, id);
        return component.getClientId(context);
    }

    private UIComponent find(UIComponent component, String id) {
        if (id.equals(component.getId())) {
            return component;
        }

        Iterator<UIComponent> kids = component.getFacetsAndChildren();
        while (kids.hasNext()) {
            UIComponent kid = kids.next();
            UIComponent found = find(kid, id);
            if (found == null) {
                continue;
            }
            return found;
        }

        return null;
    }

} 
```

这是在应用程序的[faces-config.xml](http://java.sun.com/javaee/5/docs/tutorial/doc/bnawp.html)中配置的，并使用表达式语言绑定到视图：

```
<f:view>
    <h:form>
        <h:commandButton id="button1" value="b1"
            onclick="#{javaScriptBean.onclickButton1}" />
        <h:commandButton id="button2" value="b2"
            onclick="alert('You clicked element id=#{javaScriptBean.onclickButton2}');" />
    </h:form>
</f:view> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-10-16T11:46:30.353

```
<head>
..
<script type="text/javascript">
var myCommandLinkId = "undefined";
</script>
..
</head>

..

<h:commandLink id="myCommandLink" value="Click Me" onmousedown="myCommandLinkId=this.id;" onclick="alert(myCommandLinkId);" /> 
```

# c# - 什么时候创建自己的 dll 里面应该有什么

> ID：510833
> 
> 赞同：5
> 
> 时间：2009-02-04T10:44:17.657
> 
> 标签：c#, dll

到目前为止，我还没有必要在 .NET 中创建 dll，因为我的程序往往彼此不同（而且我编程的时间不长）。然而，我现在开始收集一个经常使用的方法库，这些方法往往在我的许多程序中都有副本（或可以变得更通用的类似方法）。

据我了解，应该创建一个 dll 来在程序之间共享通用方法。

所以我可以把我的方法放在 dll 中，比如自定义对话框和常用表单之类的东西呢。我目前有一个自定义错误表单和一个打印预览对话框，几乎在我的所有程序中都使用了它们。将这些放在 dll 中是一种好习惯吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-04T10:57:19.223

在这种情况下，“良好做法”实际上取决于您减少了多少代码重复。如果这些对话在您的许多程序中都使用并且它们占用了大量代码，那么是的，将它们移动到共享空间可能是一个好主意。

但不要试图把所有东西都扔进去。您会发现自己不得不重写它，并且到那时您可能会编写比以前更多的代码。保持简单。保持通用。让它们有用。

但是，在开始之前，请注意您正在创建依赖关系树。如果您更新您的库，您将不得不花一些时间维护使用它的应用程序......但这与使用第三方库没有什么不同。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-04T10:53:07.967

要创建一个新的 dll，您只需将新项目（库）添加到您的解决方案中，并将其作为项目引用添加到您的主程序中。

可以将任何你想要的东西放到这个项目中。所有对话框、用户控件等都只是类，因此您可以像任何其他类一样轻松地共享它们。我认为尽可能多地分享是一种很好的做法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-04T10:54:06.560

确定为什么不呢？

您在这里构建的实际上是一个小型框架，与 .Net 框架本身非常相似。您认为应用程序之间通用的所有内容都可以放入程序集中：表单、方法、业务逻辑、异常、通用数据访问。

当您的框架增长时，您可能希望拆分该公共 DLL。例如，如果您在 DLL 中有通用表单，并且您还开发了批处理应用程序，那么它们不需要引用包含 WinForms 特定类的 DLL。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-04T11:03:43.907

或者，您可以将这些方法的源文件放在一个公共位置，并在将它们包含在项目/解决方案中时将它们作为链接添加。

# oop - 在类名中使用“Base”

> ID：510839
> 
> 赞同：31
> 
> 时间：2009-02-04T10:47:28.743
> 
> 标签：oop, inheritance, coding-style

在继承树底部的类名中使用“Base”一词是否可以接受？

我一直觉得这有点逃避，只是想知道是否有人同意我的观点。

例如，如果我将 MyClassA 和 MyClassB 中的某些元素重构为一个公共基类，我会很想创建一个 MyBaseClass 来继承两者。

但是如果我需要重构 MyBaseClass 会发生什么？MyBaseBaseClass？现在这很愚蠢。

我知道 Rocky Lhotka 不介意他的 CSLA 框架，但我总是对编程中的“确定性”感到不安。

想法？

让我澄清一下*为什么*我什至担心这一点。

我有两个命名空间 - MySpecificNamespace 和 MyCommonNamespace。如您所料，MyNamespace 使用 MyCommonNamespace。

现在，我喜欢尽可能地使用命名空间来描述问题的上下文，并避免将上下文添加到类名中。因此，例如，假设我在 MyNamespace 中有一个类，它是从 MyCommonNamespace 中的一个类继承而来的。

选项 A

我*可以*称之为

```
MySpecificClass: MyClass
{
} 
```

但后来我在名称中添加了“特定”（上下文）——这是多余的，因为它已经在 MySpecificNamespace 中。

选项 B

```
MyClass: MyCommonNamespace.MyClass
{
} 
```

您可以看到我们在这里会感到困惑，对吗？

选项 C

我认为是可疑的一个：

```
MyClass: MyBaseClass
{
} 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-02-05T20:08:18.267

“你所有的 BaseClass 都属于我们。”

我坚决反对，只有一个例外。如果您正在编写一个应用程序来管理军事设施或棒球场，那就去吧。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-02-04T10:56:25.777

我倾向于在基类的名称中添加 Base 后缀，前提是它从技术角度存在（以共享一些代码），并且它本身并不真正构成任何可用的类（因此所有这些类都是抽象的）。不过，这些都是非常罕见的情况，应该像 Helper 类一样避免。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-02-04T10:51:57.737

由于您引用的重构原因，我支持“不”。

一个类应该以其逻辑表示的内容命名，除了 Object 类之外，没有什么是*真正*的Base。形而上学ftw :)

* * *

回复：选项B，没有什么令人困惑的

```
namespace MySpecificNamespace
{
  MyClass: MyCommonNamespace.MyClass
  {
  }
} 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-02-04T20:54:33.387

与它们的父类同名的类让我烦恼不已。在 Java 中，java.sql.Date 扩展了 java.util.Date。这很烦人，因为您必须指定要导入的确切类，或者完全指定类名（包括包/命名空间）。

就我个人而言，我更喜欢按原样命名事物；如果 Base 或 Abstract 类的存在只是为了提供某事物的部分实现，并且不代表该事物的接口，通常可以在其名称中加上 Abstract 或 Base 一词。但是，如果该类也代表接口，那么您应该以它的作用命名它。

例如，在 Java 中，我们有 Connection 接口（用于 DB 连接）。它只是称为连接，而不是 IConnection。你像这样使用它：

```
Connection con = getConnectionFromSomewhere(); 
```

如果您正在制作 JDBC 驱动程序并需要实现连接，则可以有一个 ConnectionBase 或 AbstractConnection，这是您特定连接的实现细节的较低层。你可能有

```
abstract class AbstractConnection implements Connection

class OracleConnection extends AbstractConnection 
```

或类似的东西。但是，您的代码的客户端永远不会看到 AbstractConnection 也不会看到 OracleConnection，他们只会看到 Connection。

因此，一般来说，通常有用的类应该以它们所代表/所做的命名，而作为代码维护/组织助手的类可以根据它们的本质命名。

*ps 我讨厌用 I 来命名接口。人们会用 C 来命名他们所有的类吗？这是2009年！您的 IDE 可以告诉您这是什么类型的对象，在奇怪的情况下，如果它是接口或类，它甚至很重要。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-02-04T10:51:51.653

我认为这个问题值得 wiki-fing。

FWIW，我同意。我通常会尝试为我的基类找到一个更“通用”的术语。因此，如果我有一个“Customer”类并且需要为其引入一个新的基类，我会选择“Contact”或其他东西而不是“CustomerBase”。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-02-04T11:08:22.553

我也建议不，但不要一成不变...

遵循 OO 口头禅，您的命名系统应该最好地代表代码应该封装的底层对象。真的不应该有与其中选择的编程语言的实际语法构成有关的“元语言”。

也就是说，如果您的对象是真正抽象的并且您真的看不到它很快会发生变化，那么有一个论点是添加“Base”有助于提高一般可读性。

与大多数事情一样，没有一概而论的正确和错误答案 - 这取决于您的代码库的整体布局、这个特定代码应该代表什么以及您拥有的内部风格。试着保持一致。

基地在其他地方使用吗？

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-02-04T11:38:37.563

In Java I tend to provide a base implementation of an interface Foo in an abstract class FooBase. I think that is perfectly ok, and makes the connection to the interface very clear and regular.

Without the interface I would call the abstract base class Foo.

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-02-04T20:35:17.277

我通常将 IFoo 用于接口，将 AbstractFoo 用于骨架实现，这是 .NET 和 Java 约定的混合。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-02-04T10:59:25.943

我也支持无营地...今天在那里放置一个 Base，6 个月后有人会在你不看的时候在你的代码库中敲击 MyDerivedClass 类。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-02-04T11:16:48.560

“抽象”*前缀*可能吗？

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-02-04T20:40:27.703

我同意，AbstractFoo 是一个不错的解决方案。我尝试选择不需要额外形容词的名称。我会回避使用 Base。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-02-04T10:50:45.053

我认为应该尽可能避免使用实际描述它的标识符！

这个问题很难回答，因为它很抽象。例如，我可以考虑将 MyClassA 和 MyClassB 的基称为“MyClass”。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2020-06-05T07:49:37.873

似乎任何有原则的答案最终都不会......但是，逗号，当我查看我不是特别熟悉的代码时，这在 python 中经常发生（源代码有时是唯一可靠的文档），我发现当有课程时它真的很有帮助`Base`。Python 与其他使用“抽象”或“接口”说明符定义类的 OO 语言不同。对于命名，我喜欢问自己“如果我以前从未见过这段代码，哪种方式更容易让我理解这段代码？” （然后，根据我的懒惰程度，我相应地命名）。

# javascript - struts 2 中的 AJAX 验证

> ID：510843
> 
> 赞同：0
> 
> 时间：2009-02-04T10:49:41.530
> 
> 标签：javascript, ajax, validation

我们可以在 struts 2 应用程序中使用 AJAX 进行客户端验证吗？如果是，请告诉我程序。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2010-01-17T15:59:18.557

答案就在这里。

[http://struts.apache.org/2.x/docs/ajax-validation.html](http://struts.apache.org/2.x/docs/ajax-validation.html) 甚至提供原型示例而不是dojo

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-04T10:53:16.080

AJAX 是您可以调用服务器端验证的机制。AJAX 中的“J”代表 Javascript。

您通常会使用 AJAX（以及因此的 Javascript）来调用某种不适合客户端验证的服务器端验证。例如，根据可接受值表验证邮政编码。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-04T11:23:58.687

As Sergio said, you could use this, for example, in a registration form where you have fields like:

```
Username
E-mail
Password
Repeat Password 
```

You can set up some javascript to validate the form before the user submits it, or better yet, don't enable the submit form until all required fields are complete, avoiding user frustration (you tell him specifically where the error is and how to correct it) and adding another layer of validation to it.

In this case you can pre-validate `Username` and `E-mail` against the server to see they are not taken yet. You can do something like this (in jQuery, from memory):

```
$("#email").change(function(e) {
    var $elem = $(this);
    var val = $elem.val();
    if (!val) {
            myMarkField($elem, "not-valid");
            myValidateForm("myForm");
    } else if (!/^[a-z0-9_+.-]+\@([a-z0-9-]+\.)+[a-z0-9]{2,7}$/i.test(val)) {
            myMarkField($elem, "not-valid");
            myValidateForm("myForm");
    } else {
        $.getJSON("isEmailAvailable.php", {email:val}, function(result){
            if (result.available) {
                myMarkField($elem, "valid");
                myValidateForm("myForm");
            } else {
                myMarkField($elem, "not-valid");
                myValidateForm("myForm");
            }
        });
    }
}); 
```

Where `isEmailAvailable.php` should return something like `{ available: true }`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-04T10:53:38.997

你会怎么做？您使用 JS 进行客户端编程（包括验证），它与服务器端无关。

此外：通过客户端 JS 进行服务器端验证是个坏主意，因为您的所有验证代码都会暴露给用户。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-04T10:54:12.880

如果您要进行服务器端输入验证，那么您需要使用 JavaScript 做什么？

我将假设您在服务器端使用 PHP，在这种情况下，您将希望在那里验证它，而不是发出另一个不必要的请求。

如果您想使用 AJAX 进行一些服务器端验证（并且您正在使用 JQuery），这至少应该让您开始：

```
function validate(fieldName)
 {
    $.get('/validation.php',
          {'value' : fieldName.value, 'name' : fieldName.name},
          function(data, textStatus) 
           {
               if(data)
                {
                   fieldName.style.class = 'validFormInput';
                }
               else
                {
                   fieldName.style.class = 'invalidFormInput';
                }
           })
 } 
```

我不是 JS/JQuery 专家，我没有对此进行测试，所以这只是为了让您入门。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-04T11:32:07.437

In short, the AJAX application architecture enables the client (i.e. a piece of JavaScript running in a web browser) to actively ask for information from a server. Most often, the JavaScript client will use the received information to update small portions of the browser's document using the DOM.

Also, the JavaScript client code can do some obvious validation of e.g. a form to be sent to a server (as shown so nicely by [Danita's answer](https://stackoverflow.com/questions/510843/server-side-validations/510946#510946)).

The server can be anything. It may just return a plain xhtml file, or may respond to the request by calling a complex PHP script that generates a response. Heck, it may even be a dedicated mobile device entirely implemented in bare C. As long as it implements the http protocol the client's request was transmitted in. This *might* be JavaScript. Improbable but true.

So Yes: it can be done using 'server-side' JavaScript, if you have a server running JavaScript. But No: that's not probable.

And Yes: you apparently need to read upon AJAX. (I'm not a webdesigner, and even I seem to know more than you ;) Don't leave it that way!)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-04T11:08:03.630

我认为您需要阅读一些有关 AJAX 的信息。

我推荐这个链接：[http ://rajshekhar.net/blog/archives/85-Rasmus-30-second-AJAX-Tutorial.html](http://rajshekhar.net/blog/archives/85-Rasmus-30-second-AJAX-Tutorial.html)

我认为它简单易懂。

基本上你有服务器和客户端代码。JavaScript（客户端）可以使用 Ajax（异步 JavaScript 和 XML）调用 URL，这与使用浏览器调用任何其他 URL 非常相似。主要区别在于没有页面重新加载。

您的 JavaScript 需要等待回复才能处理它（在您的示例中显示或隐藏错误消息）。

基本上，它允许您在服务器上执行一些代码来更新您的页面，而无需刷新页面。

# c++ - 如何判断当前窗口是否为活动窗口？

> ID：510845
> 
> 赞同：10
> 
> 时间：2009-02-04T10:50:19.673
> 
> 标签：c++, windows, winapi, mfc

如何判断我的窗口是否是当前活动窗口？我目前的猜测是做 GetForegroundWindow 并将 HWND 与我的窗口进行比较。还有比这更好的方法吗？

我正在使用 Win32 API / MFC。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-02-04T11:20:48.863

是的，这是我知道的唯一方法。

但是您必须处理 GFW 可以返回 NULL 的事实。通常，当另一个桌面（例如屏幕保护程序桌面）处于活动状态时会发生这种情况。请注意，使用保护程序密码会影响是否使用不同的桌面（这取决于 Windows 版本，我不记得不同版本如何工作的详细信息）。

此外，此代码在 Visual Studio 下的调试模式下也无法正常工作，因为您将获得 VS 的窗口句柄。

除此之外，一切都很美好:-)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-10T12:44:11.077

您可以尝试使用 WM_ACTIVATEAPP 消息。
首先定义一个 bool 变量`bool wActive = false`，在 WndProc 过程中，下面是一段代码：

```
case WM_ACTIVATEAPP:
     wActive = (bool)wParam;
return 0; 
```

你可以去[MSDN](https://docs.microsoft.com/en-us/windows/win32/winmsg/wm-activateapp?redirectedfrom=MSDN)找到更多关于`WM_ACTIVATEAPP`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-04T11:20:53.263

是的，除非您想检查每个线程的活动窗口，否则您是正确的。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-04T13:27:35.160

我假设您的意思是当您说“活动窗口”时具有输入焦点的窗口？

在这种情况下，忘记 GetForegroundWindow() API。这将返回最顶层的窗口 - 并不总是具有输入焦点的窗口。

请改用[GetFocus()](http://msdn.microsoft.com/en-us/library/ms646294(VS.85).aspx)。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-09-09T04:40:05.993

是的， GetForgroundWindow() 是一种很好的检查方法，即使使用“始终在顶部”窗口（又名 HWND_TOPMOST）也能正常运行。

另一种方法是使用 GetActiveWindow()

```
 HWND temp = GetActiveWindow();
    if (temp == hWnd) // Then your current window has focus 
```

或者，如果焦点发生变化，以下消息会报告

```
 case WM_KILLFOCUS:
        // windowHasFocus = false
    break;

    case WM_SETFOCUS:
        // windowHasFocus = true;
    break; 
```

# java - 如何从使用选民的 AccessDecisionManager 抛出信息异常

> ID：510846
> 
> 赞同：2
> 
> 时间：2009-02-04T10:50:26.803
> 
> 标签：java, authorization, spring-security

我有以下情况：我的应用程序的授权机制是使用Spring security实现的。中心类实现**AccessDecisionManager**并使用投票者（每个投票者都实现**AccessDecisionVoter**）来决定是否授予对某些方法的访问权限。计算选票的算法是自定义的：

```
public class PermissionManagerImpl extends AbstractAccessDecisionManager {

    public void decide(
            Authentication authentication,
            Object object,
            ConfigAttributeDefinition config) throws AccessDeniedException {
        Iterator<?> iter = getDecisionVoters().iterator();
        boolean wasDenied = false;

        while (iter.hasNext()) {
            AccessDecisionVoter voter = (AccessDecisionVoter) iter.next();
            int result = voter.vote(authentication, object, config);

            switch (result) {
                // Some tallying calculations
            }
        }

        if (wasDenied) {
            throw new AccessDeniedException("Access is denied");
        }               
    }

} 
```

在拒绝对某个方法的访问后，应用程序的客户端有兴趣获得一个信息异常，该异常指定了拒绝访问的确切**原因**。这意味着将一些信息从选民传递给决策经理。不幸的是，标准**AccessDecisionVoter**传递回决策管理器的唯一信息是可能的返回值之一（**ACCESS_GRANTED**、**ACCESS_ABSTAIN**或**ACCESS_DENIED**）。

最好的方法是什么？

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-04T12:18:08.310

好吧，在这种情况下，`AccesssDecisionVoter`接口实际上返回了一个。`int`当然，内置的投票者实现总是只返回您提到的三个常量之一（这些是标准访问决策管理器检查的内容），但是它们实际上并没有任何额外的返回 -`RoleVoter`例如将拒绝当且仅当主体没有所需的角色时才访问。

由于您使用自己的选民和访问决策管理器实现，因此我认为您有几个可用的选项：

1.  以某种形式的错误代码返回其他整数值；将`ACCESS_GRANTED`,`ACCESS_ABSTAIN`和`ACCESS_DENIED`视为它们的典型值，但将任何其他整数视为带有错误代码的“拒绝访问”。理想情况下，有一个可用的错误代码查找表——本质上是一个穷人的枚举。
2.  在你的投票者中，`ACCESS_DENIED`像往常一样返回，并设置一些可公开访问的属性（在投票者对象本身或一些静态可访问的字段上）以及错误原因。在您的经理中，如果您的自定义选民拒绝访问，请检查属性以获取详细信息。
3.  如上，在voter中设置一个error属性；但要确保`Authentication`传入的实例是您自己的自定义子类之一，它提供了设置/检索此信息的良好位置。
4.  `AccessDeniedException`从您的选民本身中抛出一个（或合适的子类）。这并不理想，因为它预设了访问决策管理器中的逻辑；但是您可以直接让这个冒泡，或者如果需要在管理器中捕获它（自定义子类肯定会对此有好处）并在访问确实被拒绝时重新抛出（类似于`ProviderManager`该类对其`lastException`变量所做的事情）。

这些都不是明显正确和优雅的答案，但是您应该能够从最合适的答案中获得可行的答案。由于选民框架内没有*明确*支持沟通原因（从根本上说，这是一个直接的布尔响应），我认为你不能做得更好。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-05T11:48:32.003

感谢回答的人。

我想我找到了一种非常优雅的方式来做我想做的事情，并且仍然使用标准的 voters API。*AccessDecisionVoter的**投票*方法的第二个参数是安全对象。我可以在决策经理和选民之间创建一个合同，这个对象是一个特定的类/接口，它是一个**包装器**，通过它可以获取原始的安全对象，并且拒绝的选民也可以添加其他信息使用权。

 ***我在其他框架中也看到了这样的模式。与其他可能的解决方案相比，该解决方案具有以下优点：

*   选民可以保持无国籍状态，因此他们可以是单身人士
*   使用 AccessDecisionVoter 的标准接口，没有添加新的返回值
*   附加信息保存在自动丢弃的对象中，因为在*AbstactDecisionManager*的*决定*方法之后没有人使用它，因此不需要清理代码

干杯。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-04T12:28:43.687

你`AccessDecisionManager`不能不使用选民直接实施吗？然后，您可以`AccessDeniedException`使用正确的信息抛出一个。也许`RoleVoter`s 不是在您的情况下使用的正确抽象。

# css - div内的IE7换行符弄乱了底部边距

> ID：510847
> 
> 赞同：2
> 
> 时间：2009-02-04T10:50:32.030
> 
> 标签：css, html, internet-explorer-7, line, break

我注意到 IE7 中的奇怪行为在 Firefox 中没有发生。如果您在“testing 2”“div”中注意到，当我在这个 div 的底部添加 2 个换行符时，它不尊重为这个 div 设置的边距，并且“test 3” div 就在它的正下方，没有边距。当我删除“br”时，“test 2”和“test 3”div 之间有边距。

这是 IE7 错误还是有解决方法？

```
 <div style="border: dotted 1px red;">

    <div id="main" style="border: solid 1px black; padding: 10px; margin: 5px; float:left ">
    testing 1

       <div style="border: solid 1px black; padding: 10px; margin: 10px;">
             testing 2
             <br><br>       <!--   THIS LINE -->
         </div>

        <div style="border: solid 1px black; padding: 10px; margin: 10px; ">

        testing 3
        </div>

    </div>

    <div style="border: solid 1px black; padding: 10px; margin: 20px; float: left">

        testing 4
    </div>

    <div style="clear:both"></div>

    </div>

<\html><\body> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-04T11:14:01.543

我不确定 IE 为什么要这样做，但一个相当巧妙的解决方案是将“测试 2”div 的内容与另一个 div 包装起来，如下所示：

```
<div style="border: solid 1px black; padding: 10px; margin: 10px;">
    <div>
        testing 2
        <br/>
        <br/>
        <!--   THIS LINE -->
    </div>
</div> 
```

但是，如果您能提供帮助，我建议不要使用 <br/>；如果可以的话，使用 CSS 对其进行排序！:)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-13T09:15:56.340

IE7 确实存在[嵌套元素及其边距的](http://www.brunildo.org/test/IEMargCollLay.html)问题。

您可以通过强制“测试 2”[具有 layout](http://www.satzansatz.de/cssd/onhavinglayout.html)`div`来解决此问题。

在这种情况下，设置`height:100%;`为“测试 2”`div`将恢复边距。我创建了一个[工作示例](http://webignition.net/examples/ie7nestedelementmargin/)来演示修复。

值得注意的是，很大一部分 IE CSS 错误可以通过从元素中强制或删除布局来解决。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-13T02:43:59.747

从语义上讲，您应该将该文本放在`<p>`,`<blockquote>`或其他块级元素中。尽量避免将文本直接放在 a`<div>`中，因为它们旨在用于指示页面中的分区或部分。

例如：

```
<div style="border: 1px solid black; padding: 10px; margin: 10px;">
    <p style="margin: 0 0 10px 0;">testing 2</p>
</div> 
```

这解决了您在 IE7 中的问题，并且也将在其他浏览器中更一致地呈现。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-09T21:53:10.837

在您的 div 上，在规则**之后**`<br>`使用，而不是使用。`padding-bottom` **`padding`**

 *** * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-04T11:13:51.967

可能不是最好的解决方案，但在标签帮助后添加一个不间断的空格：更改

```
 <br><br>       <!--   THIS LINE --> 
```

进入：

```
 <br><br>&nbsp;       <!--   THIS LINE --> 
```

...好吧由于某种原因它不会通过...不间断的空间是“＆nbsp;” （没有引号，中间没有空格）

# windows - Windows Vista 中的 ODBC 文件 DSN

> ID：510852
> 
> 赞同：3
> 
> 时间：2009-02-04T10:51:26.473
> 
> 标签：windows, windows-vista, registry

在 Windows XP、2003 中，注册表中有一个条目用于系统中的 ODBC 文件 DNS 位置：

HKEY_LOCAL_MACHINE\SOFTWARE\ODBC\ODBC.INI\ODBC 文件 DSN\DefaultDSNDir

在哪里可以获得 Windows Vista 和/或 Windows 2008 中的默认 DSN 文件夹

谢谢，

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-17T21:11:38.120

您提到的注册表项是由 Microsoft Office 放在那里的。还有一个每个用户版本，在`HKEY_CURRENT_USER\Software\ODBC\odbc.ini\ODBC File DSN\DefaultDSNDir`. 请参阅[http://support.microsoft.com/kb/165866](http://support.microsoft.com/kb/165866 "KB165866")

# servlets - servlet 中的 init() 方法

> ID：510863
> 
> 赞同：1
> 
> 时间：2009-02-04T10:53:52.273
> 
> 标签：servlets, methods, init

我们可以更改 servlet 的 init() 方法的名称吗？我的意思是说生活应该是- xyz()-service()-destroy() 而不是 init()-service()-destroy()

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-02-04T10:55:29.007

No.`init()`是在 servlet 基类中定义的方法 - 如果您使用不同的方法名称，您将不会覆盖现有方法。

您当然可以编写一个`init()`只调用`xyz()`的方法 - 并在所有 servlet 使用的基类中这样做。不过，这似乎不是一个好主意——你为什么要首先这样做？

# java - 远程编译和执行Java

> ID：510869
> 
> 赞同：1
> 
> 时间：2009-02-04T10:54:45.827
> 
> 标签：java

如果您的计算机中没有安装 Java，是否可以通过指向安装了 Java 的 PC 来编译和执行 Java 程序？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-04T11:02:42.737

如果您的机器上安装了 Java，则压缩整个目录并将其提供给这些人。他们可以将其提取到他们的机器上，他们不需要管理员权限。大功告成，可以使用javac和java编译运行了。您可以将 bin 目录添加到您的 PATH 中，然后您可以从任何地方执行这些命令。

您也可以登录到安装了 JDK 的远程计算机，并且登录的用户具有执行权限。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-04T14:20:48.437

伙计，您有组织问题，而不是 java 问题。如果高层不希望程序员破解常规盒子，那么你真的不应该试图绕过保护。遇到严重麻烦的方法。

以正确的方式进行 - 与有权安装 jdk 和 eclipse（或 netbeans，如果您坚持的话）的人交谈。

作为最后的手段 - 任何想学习 Java 的人都将拥有一台家用 PC 或笔记本电脑。请记住，如果您必须使用您的家用 PC 来学习 Java，那么您不欠您的雇主*任何*忠诚或使用您为他们工作的新技能的义务。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-04T11:03:04.110

如果他们能够登录到安装了 JDK 和 JRE 的 PC，那么他们应该能够从该 PC 编译和运行他们的 Java 程序。他们是远程登录还是本地登录应该没有区别。Java 可以以与任何其他程序可以远程运行的方式大致相同的方式远程运行——尽管这种方式究竟是什么可能取决于使用的远程登录方法（SSH、远程桌面等）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-04T11:03:06.433

从理论上讲，他们可以使用[VNC](http://en.wikipedia.org/wiki/Virtual_Network_Computing)之类的远程桌面解决方案在另一台计算机上编译和运行他们的程序，但使用起来会很慢而且不舒服，可能会给他们留下 Java 的坏印象。此外，如果您公司的 IT 政策像听起来那样偏执，那么您很可能永远不会获得运行 VNC 服务器的许可。

游说管理层在这些人的 PC 上安装 JDK 会好得多。强调员工获得新技能的价值。

如果公司功能失调以至于不允许这样做，请认真考虑在其他地方找到工作。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-04T11:04:13.123

是的，请查看 Java6 的 The Java Compiler API。它允许您编译以字符串形式给出的代码，并具有很好的错误支持。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-04T11:10:54.843

这对他们未来使用将是非常痛苦的。你不能安装JDK吗？

如另一个答案中所述，您应该能够将预安装的 JDK 复制到本地驱动器，只需设置一个批处理文件来设置 JAVA_HOME 并添加到路径。

您也可以在本地复制 Eclipse - 您不需要安装它。

# castle-activerecord - ActiveRecord 是不好的做法吗？

> ID：510872
> 
> 赞同：3
> 
> 时间：2009-02-04T10:55:41.440
> 
> 标签：castle-activerecord, castle

我正在开始一个新项目，我最近发现了城堡项目 activerecord，这似乎是一个很棒的解决方案，但同时，它看起来确实非常规。我想知道，这种感觉是来自于学习新东西（我应该习惯它）还是真的很糟糕？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-21T03:15:42.683

我对使用 ActiveRecord 感到奇怪的部分原因是必须继承 from `ActiveRecordBase<T>`，并在您的对象上拥有所有这些持久性方法（`Save`等等）。

但事实证明你不必！而不是拥有，说：

```
[ActiveRecord]
class Customer : ActiveRecordBase<Customer> { } 
```

你可以有

```
[ActiveRecord]
class Customer : inherit from whatever you want { } 
```

然后使用`ActiveRecordMediator<Customer>`. 它具有基本相同的静态方法`ActiveRecordBase<T>`，但这样您就不必将对象模型与它们混淆。如果您不需要 中的各种受保护方法事件挂钩`ActiveRecordBase<T>`，这可以使事情变得更简单。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-04T11:00:56.783

[ActiveRecord](http://en.wikipedia.org/wiki/Active_record_pattern)是由 Martin Fowler 在*企业应用程序架构模式中*首次命名的设计模式。它相当普遍，并在流行的 Ruby 框架 Rails 中广泛使用。

它与 .Net 世界中使用 DAO 的更常见的开发风格形成鲜明对比，这也许可以解释为什么你会感到不安。

一个建议：阅读一些与您自己的项目相似的 Ruby on Rails 应用程序的源代码，并评估您对大量使用 ActiveRecord 所产生的设计风格的喜欢程度。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-04T11:12:41.860

这不是一个糟糕的解决方案，但它有它的缺点。

在企业应用程序架构模式中，Martin Fowler 描述了几种设计构建在数据库之上的应用程序的方法。这些方法的不同之处在于应用程序与数据库的分离方式。他还描述了更多的解耦使更复杂的应用成为可能。Active Record 被描述为一种设计更简单应用程序的方法，但对于具有更复杂行为的应用程序，您需要一个独立于数据库的域模型以及介于两者之间的对象关系映射器之类的东西。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-04T11:17:37.387

ActiveRecord 在 Ruby 中工作得很好，但它不容易转移到所有语言。AR 的核心壮举是*table=class, row=instance*的隐喻。这在 Ruby 中非常优雅，因为类也是对象。在其他语言中，类通常是一种特殊的构造，然后您必须经历各种麻烦才能使其正常工作。这带走了它在 Ruby 中的一些自然感觉。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-04T11:19:57.040

不，这不是坏习惯。即使在 .NET 中，它现在也是一个相当成熟的模式。SubSonic ( [http://subsonicproject.com](http://subsonicproject.com) ) 和 LINQ to SQL 也使用该模式。

该模式的实现，例如 Subsonic，非常适合快速轻松地创建一个数据访问层来管理您的应用程序的 CRUD。

这并不意味着它对所有系统都是一个好的解决方案。对于大型复杂系统，您可能希望减少与数据存储的耦合。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-04T11:21:41.297

域对象与服务层的混合是最大的不好的做法（如果你认为这是一种不好的做法）。你最终调用了 user.Save() 这意味着如果你想改变你的 ORM，你依赖于这个模式。两个替代方案是一个层，也就是一组外观类来执行你的 CRUD 操作，或者把它放在域对象中，就像

```
User.Service.Save(user); 
```

如果您使用的是 .NET，那么 ActiveRecord 显然是基于 ActiveRecord、Coolstorage、Subsonic 和[其他一些](http://www.sloppycode.net/articles/net-orms---object-relational-mappers-orms.aspx)。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-09-05T00:53:56.430

我认为 ActiveRecord 与 Castle 关系不大，因此，这个问题的答案[ActiveRecord 模式是否遵循/鼓励 SOLID 设计原则？](https://softwareengineering.stackexchange.com/questions/119352/does-the-activerecord-pattern-follow-encourage-the-solid-design-principles)可能对许多人更有启发性。

# c# - ASP.net MVC 路由

> ID：510874
> 
> 赞同：1
> 
> 时间：2009-02-04T10:55:51.097
> 
> 标签：c#, asp.net, asp.net-mvc

我目前正在创建我公司网站的移动版本，并将其用作学习 asp.net mvc 的时间。

我打算创建的 URL 如下

Jobs/in/location
Jobs/for/jobTitle
Jobs/in/location/for/jobtitle
jobs/for/jobtitle/in/location

现在我们添加的类型越多，我需要添加的路径就越多，我需要的路径也就越多，所以不需要真正维护。

所以目前在我的 Global.asax.cs 是

```
 //Jobs
            routes.MapRoute(
                "DefaultJobs",                                              // Route name
                "Jobs/{pagenumber}",                           // URL with parameters
                new { controller = "Jobs", action = "Default", pagenumber = "1" }  // Parameter defaults
            );

            //Jobs by Location

            routes.MapRoute(
                "JobsByLocation",                                              // Route name
                "Jobs/in/{location}/{pagenumber}",                           // URL with parameters
                new { controller = "Jobs", action = "Default", location = "", pagenumber = "1" }  // Parameter defaults
            );

            //Jobs by Title

            routes.MapRoute(
                "JobsByTitle",                                              // Route name
                "Jobs/for/{title}/{pagenumber}",                           // URL with parameters
                new { controller = "Jobs", action = "Default", title= "", pagenumber = "1" }  // Parameter defaults
            );

            //Jobs by Title and Location

            routes.MapRoute(
                "JobsByTitleAndLocation",                                              // Route name
                "Jobs/for/{title}/in/{location}/{pagenumber}",                           // URL with parameters
                new { controller = "Jobs", action = "Default", location = "", title = "", pagenumber = "1" }  // Parameter defaults
            ); 

```

所以我不确定这是否正确，因为在我的 JobsController 中我确实有“in”作为控制器，但我只能得到一个参数。所以我选择了一个默认的，它抓住了一切。

```
 public ActionResult Default(string location, string title, string pagenumber)
        {
            return Content("Location " + location + " Title " + title + " Page " + pagenumber);
        } 
```

现在这是正确的做法吗？还是我错过了什么？

为了调用这个方法，我有这个

```
 [AcceptVerbs(HttpVerbs.Post)]
        public ActionResult SearchContinent(string Continents)
        {
            try
            {
                // TODO: Add update logic here

                //return RedirectToAction("Default","Jobs",
                    //new {
                       // location = Continents
                        // }); 

                return RedirectToRoute(new { controller = "Jobs", action = "Default", location = Continents, pagenumber = "1" });

                //return Redirect("Jobs/in/" + Continents);
            }
            catch
            {
                return View();
            }
        } 
```

现在这不会产生正确的 url，因为它缺少“in”并将“location”作为参数传递，这有效但不正确。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-04T12:22:39.410

使用 RedirectToRoute 您应该传递您要定位的路由名称，因此：

```
return RedirectToRoute("JobsByLocation", new { location = Continents, pagenumber = "1" }); 
```

# java - 具有原型范围的自定义 Spring 原型注释？

> ID：510876
> 
> 赞同：3
> 
> 时间：2009-02-04T10:56:29.177
> 
> 标签：java, spring

我创建了一个自定义构造型@Action，Spring 设法在我在配置中配置的包扫描中检测到它。

我想做的下一步是告诉 Spring 所有带有 @Action 的类都应该使用原型创建，而不是单例。

我的@Action 界面如下：

```
@Target({ElementType.TYPE})
@Retention(RetentionPolicy.RUNTIME)
@Documented
@Component
public @interface Action {
} 
```

我试图用 @Scope("prototype") 标记它，但这似乎没有帮助。

我渴望的可能吗？

肯特

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-05T02:19:48.410

context:component-scan 可以配置自定义范围解析器，它实现了 org.springframework.context.annotation.ScopeMetadataResolver。

我创建了一个自定义范围解析器，它不仅检查 bean 的 @Scope 注释（使用 org.springframework.context.annotation.AnnotationScopeMetadataResolver 的默认解析器），而且还查找注释的注释（递归）。

不过需要注意的一点是，递归查找注解可能会陷入死循环，因为 java.lang.annotation.Documented 使用 java.lang.annotation.Documented 进行了注解。最好维护一个表，指示已经查找了哪个注释。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-04T11:10:22.347

不幸的是，spring 2.5.X 没有。您的 @Component-annotation 描述了bean 的*角色*，而范围是一个单独的轴，因此角色和范围描述符通常必须单独应用于实现类。当以这种方式查看时，它是有道理*的*（编辑：至少它这样做了几秒钟，无论如何）

我不知道这将如何改变我春天 3.x，这不是太远。似乎还有一些改进的余地。

# logging - WebSphere Portal 6.0 Portlet 错误记录

> ID：510880
> 
> 赞同：0
> 
> 时间：2009-02-04T10:57:56.023
> 
> 标签：logging, portlet, portal, websphere-portal

在哪里可以找到部署到 WebSphere Portal 6.0 (Linux) 的 portlet 的错误日志

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-07-03T08:16:20.067

您将在 SystemOut.log 和 SystemErr.log 中找到日志

在默认的 Webpshere Portal 6.0 安装日志（SystemOut.log、SystemErr.log）位于`<PortalServer>`\log\

找出这些文件位置的最佳方法是检查 Websphere 管理控制台。在管理控制台中，在 Environment > Websphere variables 下，查找变量 SERVER `_LOG_`ROOT

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-09-14T03:22:31.990

您应该真正考虑使用 JCL（Jakarta Commons Logging）和 Log4j 而不是 Portal 的默认日志记录。但要小心，有几个 Logging gotchyas：

[http://mycrapytechnologyblog.wordpress.com/2009/08/18/websphere-portal-log4j-hell/](http://mycrappytechnologyblog.wordpress.com/2009/08/18/websphere-portal-log4j-hell/)

# c# - Reporting Services 中的继承

> ID：510885
> 
> 赞同：0
> 
> 时间：2009-02-04T11:00:08.577
> 
> 标签：c#, visual-studio-2008, inheritance, reporting-services

有什么方法可以在 Reporting Services 中实现继承？我想要一份主报告，其中包含标准页眉和页脚 + 报告开头的一些信息，以及一些报告参数。然后我想创建一个继承主报告设计的新报告，然后我可以向该报告添加特定内容。然后，如果我需要更改标题徽标或其他内容，我只需更改主报告，该更改将传播到所有继承的报告。我正在寻找与 asp.net masterpage 在网站上提供的类似功能。

使用 Reporting Services 2005、Visual Studio 2008 和 c# 是否有可能？或者是否有任何解决方法可以帮助我实现这一目标？

顺便说一句，我将所有报告都呈现为 pdf。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-04T12:12:43.983

我有同样的问题 - 但无法在给定的时间内解决它，所以我将我需要的所有页眉、页脚和侧边栏信息放在子报表中的每个报表中，并将子报表集成到所有需要的报表中。

这是一个非常快速且肮脏的复制粘贴解决方案，但现在可以使用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-05T16:40:45.533

您应该能够使用子报告来实现这一点

# c# - MultipleActiveResultSets=True 还是多个连接？

> ID：510899
> 
> 赞同：96
> 
> 时间：2009-02-04T11:05:42.810
> 
> 标签：c#, .net, sql-server, sql-server-2005, ado.net

我有一些 C#，在其中我在连接 () 上创建了一个阅读器`ExecuteReader`，然后对于该阅读器中的每一行，执行另一个命令 (with `ExecuteNonQuery`)。在这种情况下，我是`MultipleActiveResultSets=True`在我的连接上使用还是使用多个连接更好？

* * *

## 回答 #1

> 赞同：111
> 
> 时间：2009-02-04T11:50:45.137

专门为此类操作添加了多个活动结果集 (MARS)，因此您不必同时打开两个连接即可从 SqlDataReader 读取并执行其他批处理。

MARS 与 SQL Server 2005 及更高版本兼容。引用 MSDN 文档：

> 在引入多活动结果集 (MARS) 之前，开发人员必须使用多连接或服务器端游标来解决某些场景。

有关更多信息，请参阅：

> [MSDN 库 - MARS 概述](http://msdn.microsoft.com/en-gb/library/cfa084cz.aspx)

工作示例读取和更新数据：

> [MSDN 库 - 操作数据 (MARS)](http://msdn.microsoft.com/en-gb/library/yf1a7f4f.aspx)向下滚动到“使用 MARS 读取和更新数据”

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2009-02-04T11:12:42.547

据我所知，这是添加 MARS 的原因，所以是的，我认为您应该使用它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-04T11:15:58.250

最好的测试方法是启动 SQLServer Profiler，看看服务器端到底发生了什么。

我的猜测是它不会更好，因为您使用的是 ExecuteNonQuery()。所以，事实上，你不会处理多个结果。

# internet-explorer - CSS 背景 url () 没有出现在 IE 中，在 FF/Safari 中有效

> ID：510903
> 
> 赞同：3
> 
> 时间：2009-02-04T11:07:27.970
> 
> 标签：internet-explorer, cross-browser

我正在为可怕的 IE6 调试我的网站，但我被正式难住了。

在 Firefox 中的外观：http: [//dl-client.getdropbox.com/u/5822/firefox.tiff](http://dl-client.getdropbox.com/u/5822/firefox.tiff)

IE6中的外观：http: [//dl-client.getdropbox.com/u/5822/ie6.tiff](http://dl-client.getdropbox.com/u/5822/ie6.tiff)

直播网站：[Motolistr.com](http://motolistr.com)

下面的 CSS 在 FF 和 Safari 中效果很好，但在 IE6 中不行。

```
#search_sort{
background-image:url('../images/nav/bg-form.jpg');
padding:10px; 
border:1px solid #d13a3b;
margin-top:5px;
} 
```

以下 CSS 在 IE6 中有效，并且看起来相同...（wtf）

```
#email_seller{
border:1px solid #d13a3b;
background-image:url('../images/nav/email-form-bg.jpg');
} 
```

此外，我的链接/跨度按钮也没有出现——我认为这是同一类型的问题。

```
a.button {
    background: transparent url('../images/nav/button_bg_right4.gif') no-repeat scroll top right;
    color: #000;
    display: block;
    float: left;
    font: normal 18px arial, sans-serif;
    height: 36px;
    margin-right: 6px;
    padding-right: 18px; /* sliding doors padding */
    text-decoration: none;
}

a.button span {
    background: transparent url('../images/nav/button_bg4.gif') no-repeat;
    display: block;
    line-height: 24px;
    padding: 5px 0 7px 18px;
} 
```

有任何想法吗？

谢谢，尼克

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-25T20:45:03.293

似乎这个问题得到了很好的回答，但我想补充一下：

在 IE 中工作：

```
background:transparent url('../images/nav/button_bg4.gif') no-repeat; 
```

适用于 Firefox 和 Chrome，但不适用于 IE：

```
background:transparent url('../images/nav/button_bg4.gif')no-repeat; 
```

如果不知道 IE 需要那个空间（这似乎是非常边缘的格式），您可能会浪费大量时间，不是吗？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-04T11:11:43.000

正如我所见，属性的顺序是错误的。您需要在开始时放置透明。

```
background:transparent url('../images/nav/button_bg4.gif') no-repeat; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-04T11:12:51.390

背景属性简写顺序为：彩色图片重复位置附件

我建议您更正提供所有属性的格式，如果失败（并且您可以确认已应用样式）尝试上下修改图像路径以查看您的基本位置是否是您认为的那样。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-09-16T03:31:41.953

在 Internet Explorer 中，CSS 中的 URL 是相对于当前页面的。在其他浏览器中，CSS 中的 URL 是相对于 CSS 位置的。最好对两者都使用修复 URL。如果您使用 Java servlet，您可以使用虚拟 URL 并在后台处理来自 servlet 的请求。

# sql - 如何比较同一张表（SQL Server）中的 2 行？

> ID：510916
> 
> 赞同：23
> 
> 时间：2009-02-04T11:13:12.903
> 
> 标签：sql, sql-server, tsql

我需要创建一个后台作业来处理一个表，以查找与具有不同状态的特定 id 匹配的行。它将行数据存储在字符串中，以将数据与具有匹配 id 的行进行比较。

我知道获取行数据的语法，但我以前从未尝试过比较同一张表中的 2 行。它是如何完成的？我需要使用变量来存储每个变量的数据吗？还是其他方式？

（使用 SQL Server 2008）

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2009-02-04T11:51:05.057

You can join a table to itself as many times as you require, it is called a [self join](http://msdn.microsoft.com/en-us/library/ms177490.aspx).

An alias is assigned to each instance of the table (as in the example below) to differentiate one from another.

```
SELECT a.SelfJoinTableID
FROM   dbo.SelfJoinTable a
       INNER JOIN dbo.SelfJoinTable b
         ON a.SelfJoinTableID = b.SelfJoinTableID
       INNER JOIN dbo.SelfJoinTable c
         ON a.SelfJoinTableID = c.SelfJoinTableID
WHERE  a.Status = 'Status to filter a'
       AND b.Status = 'Status to filter b'
       AND c.Status = 'Status to filter c' 
```

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-02-04T11:16:55.797

好的，2 年后终于到了更正语法的时候了：

```
SELECT  t1.value, t2.value
FROM    MyTable t1
JOIN    MyTable t2
ON      t1.id = t2.id
WHERE   t1.id = @id
        AND t1.status = @status1
        AND t2.status = @status2 
```

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-02-04T11:27:39.457

Some people find the following alternative syntax easier to see what is going on:

```
select t1.value,t2.value
from MyTable t1
    inner join MyTable t2 on
        t1.id = t2.id
where t1.id = @id 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-12-10T18:47:25.257

`SELECT COUNT(*) FROM (SELECT * FROM tbl WHERE id=1 UNION SELECT * FROM tbl WHERE id=2) a`

如果你有两行，它们就不同，如果一个 - 相同。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2010-04-16T06:21:43.143

```
SELECT * FROM A AS b INNER JOIN A AS c ON b.a = c.a
WHERE b.a = 'some column value' 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2020-09-24T13:39:06.900

我有一种情况，我需要将表的每一行与*下一*行进行比较，（下一个是相对于我的问题规范）在示例中，下一行是使用 row_number() 函数中的 order by 子句指定的。

所以我写了这个：

```
DECLARE @T TABLE (col1 nvarchar(50));

insert into @T VALUES ('A'),('B'),('C'),('D'),('E')

select I1.col1 Instance_One_Col, I2.col1 Instance_Two_Col  from (
 select col1,row_number() over (order by col1) as row_num
 FROM @T
) AS I1
left join (
 select col1,row_number() over (order by col1) as row_num
 FROM @T
) AS I2 on I1.row_num = I2.row_num - 1 
```

之后，我可以根据需要将每一行与*下一行进行比较*

# oop - OOP 概念混乱？

> ID：510921
> 
> 赞同：7
> 
> 时间：2009-02-04T11:15:47.780
> 
> 标签：oop

在阅读一些编程书籍时，我注意到作者说，在 OOP 中，您在理解 OOP 的主要思想时可能会有些困惑。

和地狱是啊！我有些困惑。您是否也遇到过这种情况？是什么让程序员（甚至是经验丰富的程序员）感到困惑？！

如果你有它，你怎么能打败它？！

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-04T11:27:51.110

这个**`Animal`**比喻在向大多数人解释时是有效的。

*（更多有用的链接[在这里](http://www.unfitforprint.com/articles/2005/11/22/explaining-oop-without-mentioning-classes-part-1)和[这里](https://stackoverflow.com/questions/355796/how-do-you-explain-oo-to-new-programmers)）*

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-04T11:35:36.557

学习 OOP 时的许多困惑来自于尝试选择对象和对象类之间的正确关系，尤其是是否：

*   `Object` **包含** （`Some other Object`或`Object1` **有**`Object2`）
*   `Object` **是一个**实例`Class`

如果我能想到一个很好的例子来说明其中任何一个都可能合适的情况，我会添加它......

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-04T12:34:49.400

OOP 采用“面向问题”的编程方法，*而不是*像 C 和 Pascal 等语言中使用的传统“面向机器”的方法。如果您使用过程/功能语言进行了广泛的编程，那么学习 OOP 可能会非常困难。对这些程序员来说，事情往往更令人困惑。如果您是编程新手，您可能会发现事情不那么令人困惑，因为您是从一个全新的头脑开始的。

话虽如此，我已经看到许多程序员广泛使用 Java 等语言，并声称自己是优秀的 OOP 程序员，但实际上他们远非如此。当然，他们使用 Java 语言特性，如接口、继承等，并创建“作为类的实例”的对象，以及“向对象发送消息”。大多数人使用很多 OOP 术语，因为他们接触过它。但是当涉及到编写一个简单的应用程序时，他们生成的代码暴露了他们的理解不足。

我对你的建议是不要仅仅使用行话。认真地质疑和学习基本概念。当您学习多态性以及它为代码可重用性带来的好处时，您可能会遇到第一个半涅槃（就像我一样）。当您了解通过继承重用和通过组合重用之间的权衡时，另一个半涅槃。最后，如果你设计得好，你就会知道你已经很好地理解了 OOP，或者更确切地说，一个好的 OO 设计很容易很好地衡量你对 OOP 的理解程度。

如果您对 OOP 很认真，您应该阅读[GOF 关于设计模式的书](https://rads.stackoverflow.com/amzn/click/com/0201633612)的前两章。这对新程序员来说可能有点困难，但它奠定了 OOP 背后思想的关键。这本书是任何认真的 OOP 程序员都应该拥有的重要参考书。如果你很好地理解了本书中的概念，那么认为自己是一个优秀的 OO 程序员。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-04T12:19:15.343

是的，我最初经历了一些困惑。这是在 OO 刚刚开始成为主流的时候，所以有很多书都涵盖了它，但是对于那些还不知道它是什么的人来说，并没有很好地解释它。结果，我开始认为对象和类在很大程度上可以互换，并为我想要创建的每个对象定义一个新类。

我终于通过在 LambdaMOO 上玩玩“搞定”了，这是一种 MUD（想想魔兽世界，但没有图形），具有面向对象的游戏内编程语言。具有讽刺意味的是，MOOCode 没有区分类和对象——对象直接继承自其他对象。（它确实有一个旨在用作“基类”的对象约定，将其命名为“通用 Foo”，以将它们与特定（“实例”）Foos区分开来，但这与它的类/对象区别一样接近有。）

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-02-04T16:09:46.987

事实上，我认为过于强调“阶级”的概念。

我理解的最大飞跃是在阅读“告诉，不要问”原则时。

我只是在玩（和阅读）像 Ruby、JavaScript、Python 等鸭子类型的环境时才开始“感受”面向对象……在 8 年愉快地用 C++ 创建大量类之后。

静态类型语言非常适合生产代码，但是在尝试了解面向对象时需要付出很多开销。

此外，在常用术语 OOP 旁边，人们常常忘记首先是 OO **A**和 OO **D**。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-04T11:31:35.520

我认为，尤其是在面向函数的语言开发方面经验丰富的程序员，很难理解 OOP 的概念。至少，这让我很困惑，我在使用 OOP 语言（Java）时做了很多事情来编程功能。

但我也认为 OOP 方法对初学者来说是一件好事，因为这种方法非常“自然”。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-02-04T11:44:49.593

我从来没有真正感到困惑，但我沿着它演变的时间轴学习了编程。所以我有汇编、c、c++、java、c# 和其他在这里不相关的负载。您必须接受的是，一切都应由对象表示，并且对象包含描述自身（属性）的信息，并且它们可以执行与它们相关的任务（方法 iE：Car.GetAllCars();）。

对于继承和多态性以及所有其他我建议练习。练习一切——因为熟能生巧。尝试开发所有书中给出的例子。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-02-04T11:52:40.390

一旦您了解了 oo 基础知识，请查看设计模式和设计原则（例如，通过阅读[Head First Design Patterns](https://rads.stackoverflow.com/amzn/click/com/0596007124)）。它将教您如何实际使用 oo 提供的工具。虽然这不能替代实践经验，但它肯定可以加快学习过程。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-02-04T11:40:24.253

谢谢您的回答。

我认为给出例子效果最好，但不是每次都这样，对吧？！

我听 C++ 的创造者说，这需要时间和耐心，你会通过尝试更好地理解它。

# c# - 从 tryParse() 获取 errorInfo

> ID：510949
> 
> 赞同：2
> 
> 时间：2009-02-04T11:25:34.487
> 
> 标签：c#, asp.net

我在玩 TryParse()

但是让我们说解析失败，然后返回false，然后......什么都没有......有没有办法获取有关解析失败的信息？

我在 codeproject 看到了类似的东西，但我并没有真正理解它。

谢谢 ：）

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-04T11:29:24.773

不，没有办法从正常的 .NET 例程中获取这些信息。您可以手动检查一些事情：

*   尝试将数字解析为小数。如果这样有效，但解析为整数不起作用，那么它要么超出整数范围，要么不是整数。
*   查找非小数、非 +/-、非小数点字符
*   检查是否为空字符串

您还没有说出您要解析的内容（整数、双精度等）或您想要的选项（允许十六进制、千位分隔符等），这使得提供一个好的检查事项列表变得更加困难。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-04T11:40:58.497

当您希望免受任何异常的影响时，可以使用 TryParse() 方法。

如果您想查看异常，那么为什么不在 try/catch 块中使用标准 Parse() 方法，这将允许您查看抛出的任何 FormatExceptions 等？正如预期的那样，通过异常处理，这可能会影响性能，但是如果 Parse() 预计会成功，那么这应该是可以容忍的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-04T11:43:53.777

为什么不直接使用常规的 Parse 方法呢？

# c++ - finding the caller of a constructor in C++

> ID：510955
> 
> 赞同：3
> 
> 时间：2009-02-04T11:30:46.550
> 
> 标签：c++, windows, memory-leaks

Looking for a quick and dirty way to identify the caller of a constructor (or any function for that matter) I am writing macros to help identify memory leaks by dumping the `this` pointers to `OutputDebugString`.

Knowing where ctor and dtor was called from would help identify the problem.

tnx \0

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-04T12:21:41.393

如果您使用的是 Visual Studio，则可以附加调试器，而不是让断点有一个跟踪点。您可以通过右键单击断点并选择`When Hit...`. 然后选择打印包含堆栈跟踪的消息。此消息将发送到输出窗格，您可以在闲暇时分析所有呼叫。

[![命中点](https://i.stack.imgur.com/bq35B.jpg)](https://i.stack.imgur.com/bq35B.jpg)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-02-04T11:33:00.757

The best way I can think of is to run your program in a debugger and put a breakpoint in the constructor. Next, examine the call stack.

If you want to target one specific allocation in one specific class, you can keep an allocation count and see which allocation number doesn't get freed. Run the program again, and break on the right allocation number.

* * *

If you need to have the call stack dumped to a log, I know it is possible to generate a stack dump using for example win32 API. A more general approach would be to keep an explicit call stack as a global/thread specific state, for example in an `std::vector<std::string>`-object. (Use RAII to ensure that every `push_back` is accompanied by a `pop_back`)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-04T12:31:59.920

似乎您在 Windows 上（OutputDebugString）。因此，您可以使用 StackWalk64 api 来获取堆栈跟踪。有关详细信息，请参阅“[在 C++ (MSVC) 中打印堆栈跟踪](https://stackoverflow.com/questions/348833/how-to-know-the-exact-line-of-code-where-where-an-exception-has-been-caused-c)”问题。

还有很多泄漏检测工具可用（BoundsChecker 等）。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-04T11:33:22.770

There is no quick and dirty way for this, C++ does not offer any portable way of looking into a stack-trace. If you want to search for memory-leaks, I'd recommend looking into `valgrind` and similar tools, they do a great job. As coding guideline, avoid memory-leaks in the first place by using RAII (always have an owner for a resource).

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-04T11:37:58.580

Using gcc? Why not [generate a stack trace](https://stackoverflow.com/questions/77005/how-to-generate-a-stacktrace-when-my-gcc-c-app-crashes)?

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-04T11:44:54.523

If you're using Linux then [Valgrind](http://www.valgrind.org) does everything you want and more. I find it indispensable when developing in C++.

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-02-04T12:09:50.777

如果您使用的是 g++，则可以构建您的项目以进行覆盖。[当您运行一些示例代码时，您可以使用gcov](http://gcc.gnu.org/onlinedocs/gcc/Gcov.html)查看程序的覆盖率。

此输出包括调用树，您应该能够看到对构造函数的调用以及调用它们的函数。

我能想到的唯一缺点是你只会得到实际执行的代码的输出，所以你需要有好的测试用例。话虽如此，无论如何执行覆盖率分析都是值得的。最后，强烈推荐大家使用[lcov](http://ltp.sourceforge.net/coverage/lcov.php)查看结果！

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-02-04T11:34:20.223

You running under Windows? [Visual Leak Detector](http://dmoulding.googlepages.com/vld) has helped me in the past find memory leaks.

Using [RAII](http://en.wikipedia.org/wiki/Resource_acquisition_is_initialization) helps reduce memory leaks too.

If you are feeling adventurous then you can overload the new and delete functions. [Paul Nettle does this in his MMGR](http://www.paulnettle.com/).

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-02-04T11:36:55.040

Can you manipulate the ctor and dtor? I'm no C++ developer and you should easily see this, but perhaps in this case you could pass i.e. a reference on the caller to the constructor.

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-02-04T11:46:30.793

Basically you don't, instead of you save all allocation/deallocation and discover who don´t free objects/areas.

See this answers
[Heap corruption under Win32; how to locate?](https://stackoverflow.com/questions/1069/heap-corruption-under-win32-how-to-locate/380781#380781)

Good lock.

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-02-04T12:05:39.333

使用调试器和调用堆栈的建议是合理的，可能是最好的解决方案。但是，如果您没有调试器，那将无济于事。

你知道[调用约定吗](http://www.unixwiz.net/techtips/win32-callconv-asm.html)被用于您的构造函数？如果是这样，您可以使用一些内联汇编器（如果您的编译器支持它）来检查函数调用的顺序。使用 std 调用（Win32 最常见的约定），弹出堆栈将显示指向函数调用后要返回的地址的指针（即调用函数中的某个位置）。这并不理想，但是您可以从该点向后退，直到到达您知道是函数开始的地址。这里唯一的问题是您需要获取所有函数的地址才能执行此操作......这可以使用一个简单的技巧来完成，将 eip 的值放入函数顶部的另一个寄存器中，然后将此值移动到一个数组中，以便稍后在调试时进行检查，例如（intel 语法）：

```
call label
label:
pop eax
mov [address of next array entry], eax 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-02-04T13:51:30.167

感谢大家的反馈。由于即使在程序的短暂生命周期中也有数百次对新对象的调用，所以在 ctor 中设置断点不是一种选择。

跟踪 ctor 和 dtor 中的宏就可以了。

Visual Leak Detector 和 Stackwalk64 看起来很有前途

还找到了 AfxDumpStack(AFX_STACK_DUMP_TARGET_ODS); // OutputDebugString
但它非常嘈杂

# latex - LaTeX 中的长线

> ID：510961
> 
> 赞同：4
> 
> 时间：2009-02-04T11:33:51.287
> 
> 标签：latex, long-lines

我在逐字环境中编写了一些代码。有时，行太长，生成的 pdf 看起来很丑 - 文本行超出了右边距。我能做些什么来自动打破这些长线？有什么比逐字环境更好的吗？

谢谢，卢锡安

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-02-04T11:40:35.687

当然，你有很棒的“列表”包。它甚至支持（如果您愿意）许多源代码语言的漂亮打印，以及根据显示的语言“智能中断”长行。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-02-04T11:39:12.353

你可以只使用固定宽度的字体吗，例如`\texttt{}`？如果您需要更复杂的东西，请尝试[moreverb](http://www.ctan.org/tex-archive/macros/latex/contrib/moreverb/)、[Listings](http://www.ctan.org/tex-archive/macros/latex/contrib/listings/)或[algorithmicx](http://www.ctan.org/tex-archive/macros/latex/contrib/algorithmicx/)包。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-06-20T19:15:11.220

我强烈建议为此使用 Listings 包。它将很好地格式化代码，并支持大量的语言（参见[Pg12](http://www.ctan.org/tex-archive/macros/latex/contrib/listings/listings.pdf)），并以三种方式有效地使用：

1.  使用`\lstinline!int x = 0;!`命令包含内联代码段
2.  键入的代码块，在`lstlisting`环境中，例如以下

    ```
    \begin{lstlisting}
    for i:=maxint to 0 do
    begin
    { do nothing }
    end;
    \end{lstlisting} 
    ```

3.  导入的代码块，其中代码直接从源代码文件嵌入到文档中，例如，使用`\lstinputlisting{source.py}`

这个包可以配置很多很多选项，例如，换行和包含行号，完整的详细信息可以在[包文档中找到，但是在](http://www.ctan.org/tex-archive/macros/latex/contrib/listings/listings.pdf)[wikibook 条目](http://en.wikibooks.org/wiki/LaTeX/Packages/Listings)中提供了一个很好的基本设置：

```
\lstset{ %
language=C,                     % choose the language of the code
basicstyle=\footnotesize,       % the size of the fonts that are used for the code
numbers=left,                   % where to put the line-numbers
numberstyle=\footnotesize,      % the size of the fonts that are used for the line-numbers
stepnumber=2,                   % the step between two line-numbers. If it's 1 each line will be numbered
numbersep=5pt,                  % how far the line-numbers are from the code
backgroundcolor=\color{white},  % choose the background color. You must add \usepackage{color}
showspaces=false,               % show spaces adding particular underscores
showstringspaces=false,         % underline spaces within strings
showtabs=false,                 % show tabs within strings adding particular underscores
frame=single,                  % adds a frame around the code
tabsize=2,                    % sets default tabsize to 2 spaces
captionpos=b,                   % sets the caption-position to bottom
breaklines=true,                % sets automatic line breaking
breakatwhitespace=false,        % sets if automatic breaks should only happen at whitespace
escapeinside={\%*}{*)}          % if you want to add a comment within your code
} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-04T11:39:48.030

你可以试试像 LGrind 这样的漂亮打印包。否则，您将不得不手动换行。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-04T19:15:06.300

您可能还对[fancyvrb 包](http://www.ctan.org/tex-archive/macros/latex/contrib/fancyvrb/)感兴趣。

# apache-flex - 从弹性中继器中删除 XML 节点不起作用？

> ID：510967
> 
> 赞同：2
> 
> 时间：2009-02-04T11:36:37.770
> 
> 标签：apache-flex, actionscript, mxml

我有以下中继器代码：

```
<mx:Repeater id="chapterRepeater" dataProvider="{Library.Book.Chapter}">
   <mx:FormItem label="Chapter" direction="horizontal">
      <mx:TextInput  width="100" text="{ chapterRepeater.currentItem.@Name}" 
                     change="event.currentTarget.getRepeaterItem().@Name = event.target.text"/>
      <mx:NumericStepper maximum="2000" minimum="0" value="{chapterRepeater.currentItem.@Value}" 
                    change="event.currentTarget.getRepeaterItem().@Value = event.target.value"/>
      <mx:Button label="x" width="20" click="delete event.currentTarget.getRepeaterItem()"/>
  </mx:FormItem>
</mx:Repeater> 
```

作用于以下 XML

```
<Library Name="TestLibrary1">
   <Book Name="TestBook1">
      <Chapter Name="TestChapter1" Words="530"/>
      <Chapter Name="TestChapter2" Words="490"/>
      <Chapter Name="TestChapter3" Words="1030"/>
   </Book>
</Library> 
```

这允许用户编辑章节对象的名称和值。但是，“删除”操作由于某种原因不起作用？

谁能告诉我如何在转发器中引用项目以删除它们？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-04T13:23:49.647

嗯......这个我花了一段时间至少找到某种解决方案。在您的点击事件（以及随后的文本区域和 numericStepper 上的更改事件）中，您访问 currentTarget。CurrentTarget 实际上将返回对按钮本身的引用。因为它是一个按钮而不是中继器，所以 getRepeaterItem() 不会返回任何内容。我真的很惊讶调用 getRepeatItem() 并没有引发错误。不用说，我认为他们没有更新 xml。

我的解决方案将 FormItem 外部化到它自己的组件中（这样，当点击被触发时，我可以从 FormItem 中冒泡事件。这样我总是知道事件来自哪个 formItem），然后通过 xmlListCollection 删除该项目。

所以我有一个名为 ChapterFormItem.mxml 的单独组件，其中包含

```
<?xml version="1.0" encoding="utf-8"?>
<mx:FormItem xmlns:mx="http://www.adobe.com/2006/mxml">
    <mx:Script>
        <![CDATA[
            private var _chapterData : XML;

            [Bindable]
            public function get chapterData() : XML
            {
                return _chapterData;
            }

            public function set chapterData(value : XML) : void
            {
                _chapterData = value;   
            }

            private function clickHandler(event : MouseEvent) : void
            {
                dispatchEvent(new Event("deleteChapter"));
            }

            private function textInputChangeHandler(event : Event) : void
            {
                chapterData.@Name = textInput.text;
            }

            private function numericStepperChangeHandler(event : Event) : void
            {
                chapterData.@Value = numericStepper.value;
            }
        ]]>
    </mx:Script>

    <mx:Metadata>
        [Event(name="deleteChapter", type="flash.events.Event")]
    </mx:Metadata>

    <mx:TextInput id="textInput" width="100" text="{chapterData.@Name}" change="textInputChangeHandler(event)"/>
    <mx:NumericStepper id="numericStepper" maximum="2000" minimum="0" value="{chapterData.@Value}" change="numericStepperChangeHandler(event)"/>
    <mx:Button label="x" width="20" click="clickHandler(event)"/>
</mx:FormItem> 
```

在主应用程序 xml 中（对于这个例子）我有

```
<?xml version="1.0" encoding="utf-8"?>
<mx:Application xmlns:mx="http://www.adobe.com/2006/mxml" layout="vertical" xmlns:local="*">
    <mx:Script>
        <![CDATA[
            import mx.collections.XMLListCollection;

        import mx.collections.ArrayCollection;

        [Bindable]
        private var xml:XML = <Library Name="TestLibrary1">
                                   <Book Name="TestBook1">
                                      <Chapter Name="TestChapter1" Words="530"/>
                                      <Chapter Name="TestChapter2" Words="490"/>
                                      <Chapter Name="TestChapter3" Words="1030"/>
                                   </Book>
                                </Library>;

        private function itemDeleteHandler(event : Event) : void
        {

            var chapterItem : ChapterFormItem = event.currentTarget as ChapterFormItem;
            var chapterData : XML = chapterItem.chapterData;

            var xmlListCollection : XMLListCollection = new XMLListCollection(xml.Book.Chapter);
            var chapterDataIndex : int = xmlListCollection.getItemIndex(chapterData);

            xmlListCollection.removeItemAt(chapterDataIndex);
        }

        ]]>
    </mx:Script>

    <mx:Form width="100%" height="100%">

       <mx:Repeater id="chapterRepeater" dataProvider="{xml.Book.Chapter}">
          <local:ChapterFormItem label="Chapter" 
                                 direction="horizontal" 
                                 chapterData="{chapterRepeater.currentItem}"
                                 deleteChapter="itemDeleteHandler(event)"  />
        </mx:Repeater>

    </mx:Form>

</mx:Application> 
```

# delphi - How to convert OWL/BP7 application to Delphi?

> ID：510968
> 
> 赞同：4
> 
> 时间：2009-02-04T11:36:45.743
> 
> 标签：delphi, pascal, 16-bit

Which tool/approach would you suggest to convert of a large 16bit Windows GUI application, written in old Borland Pascal 7 / OWL, to Delphi?

Understanding the pretty heavy differences between OWL and VCL, as well as the differences between the pointer manipulations in 16bit pascal and the state-of-art using of strings and objects in Delphi - are there any ways/tools which could help to avoid almost complete rewrite of the application?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-04T13:21:17.933

我认为您需要确定；

a) 有多少代码与业务逻辑、数据（库）操作以及专有文件结构、数学处理等有关？这可能会在很大程度上“按原样”提升，因为它更有可能用 OWL/BP7 的更小、更明显的元素以“pascal”编写。例如，当我使用应用程序执行此操作时，我有一系列单元处理加载/保存专有文件、计算复活节的东西、对数组进行数学运算的东西等等——所有这些东西都从 BP7 到 Delphi (1)几乎没有变化。

b) 有多少代码与 GUI 相关（仅此而已） - 消息循环处理程序、对话框元素构造函数、控件属性等。这些东西需要大量工作才能移植到 Delphi，除非你能找到某人在 .RES->.DFM （或类似的）中有一条很好的线，我想你会考虑从头开始构建这个位。没有坏事，因为如果它是一个 16 位 Windows 应用程序，那么您可能希望借此机会至少让它看起来更“现代”一点。我认为这将是该项目中劳动力最密集的部分。

c) 有多少代码正在使用您知道在 Delphi 中可以以不同方式完成的东西，但现在它可以在 pascal 中工作？这就是@BloodySmartie 关于迁移到旧版本的 Delphi 的观点对我来说有意义的地方。您应该能够将该项目移植到诸如 Delphi 5/7 之类的东西上，从而对字符串操作之类的东西进行明显（并且易于理解）的更改。在我看来，你可以留下的这些东西越多，就越好。获取可以运行并检查基本行为的东西，然后在资源允许的情况下开始重构/改进以充分利用 Delphi。你可能（和我一样）在 BP7 中有指针数组，每个指针指向一个指针数组，最终指向一个对象——这就是我们在 16 位 Windows 世界中解决内存限制的方法。当我第一次移植我的应用程序时，这些指向指针数组的指针数组在 Delphi 中仍然可以正常工作，我不理会它们，直到我有时间对这些结构做一些更“类似 Delphi”的事情。

但在你做所有这些之前 - 你为什么要移植应用程序？如果您要移植它是因为无论如何您都要对应用程序的功能进行合理数量的更改，那么现在可能是重写应用程序的正确时机。当您在 Delphi 中重写时，您仍然可以使用基于业务规则的大量函数和过程，因此它不一定是从头开始的完整和完全重写。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-04T11:49:58.290

I guess there is no tool to support your migration but i'd try to start in an old Delphi Version like 1,2 or 3\. This syntax should be much nearer on BP7 than the syntax of newer Delphi Versions.

At this time, you should first try to just bring your app logic to delphi, without any visual stuff. Then use the form designer to rebuild your GUI.

A important point you should pay attention to is that a DOS string is an ASCII-String, while the Delphi strings up to Delphi 2007 are ANSI-encoded. In Delphi 2009, the string keyword describes a unicode string.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-04T12:00:05.010

很久以前，当我将 OWL 换成 VCL（在 C++ 中）时，从头开始编写一切变得更加容易。可能有一些代码部分不处理用户界面和字符串操作，但除此之外它完全不同。

事实上，我最大的应用程序之一仍在 OWL 中，因为我只是懒得重写它。只要它有效，就让它吧。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-09-16T13:46:29.780

我们也有 - 并且仍然有 - 大量的 owl 应用程序。所以我们确实将 16 位 owl 移植到 32 位 owl，因此仍在开发和维护我们基于 owl 的应用程序（实际上是使用 Delphi 2007 for win32）。

您可能会发现这种方式比切换到 vcl 更容易、更快捷。

欢呼安德烈

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-07-21T12:32:08.543

FrameworkPascal.com 提供了一个有效的解决方案，只需对原始 Windows 3.1 代码进行少量更改。我们做了一段时间，但现在我们提供了一个带有 32 位兼容 OWL 单元的完整解决方案。我们还提供 ODBC SQL 单元、基于 MAC 地址的安全技术和类似 CRT 的特殊单元，这些单元可以处理为 DOS 文本和图形模式模式编写的代码、混合和新的 32 位图形，并针对 Windows 32/64 GUI 应用程序. 可以使用 OWL Windows MDI 编译的遗留代码从可以快速修改的模型应用程序演示开始。

# c# - C# memcpy 等价物

> ID：510971
> 
> 赞同：7
> 
> 时间：2009-02-04T11:37:47.300
> 
> 标签：c#, serialization, copying

我有 2 个相同类型的对象，我想将一种状态浅复制到另一种状态。在 C++ 中，我有很棒的 memcpy。我怎么能在 C# 中做到这一点？MemberwiseClone() 不够好，因为它创建并返回一个新对象，我喜欢复制到现有对象。我想过使用反射，但我担心它对于生产代码来说太慢了。我也想过使用.Net 序列化程序之一，但我认为它们也会创建对象而不是设置现有对象。

**我的用例：**

我有一个模板对象（类而不是结构），它需要由它的一个实例（由该模板制成的对象）更新

有任何想法吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-04T11:43:36.930

在`C#`（以及在`C++`）中，“新对象”和“现有对象的副本”之间没有区别，只要它们的所有成员彼此相等。

鉴于：

```
Int32 a = 5; 
```

, 两种操作：

```
Int32 b = 5;
Int32 b = a; 
```

产生相同的结果。

如[MSDN 参考](http://msdn.microsoft.com/en-us/library/system.object.memberwiseclone.aspx)中所述：

> MemberwiseClone 方法通过创建一个新对象，然后将当前对象的非静态字段复制到新对象来创建浅拷贝。
> 
> 如果字段是值类型，则执行该字段的逐位复制。
> 
> 如果字段是引用类型，则复制引用但不复制引用的对象；因此，原始对象及其克隆引用同一个对象。

，即它的作用`memcpy()`与`C++`

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-04T11:48:12.927

[编辑] 关于您的说明：据我了解，您有 N 个对象，每个对象都有一个对模板对象的（直接）引用。您想写回模板，以便所有对象“看到”这些更改。

建议：实现一个模板代理。

```
class TemplateProvider
{
   public MyData Template { get; set; }
} 
```

将模板提供程序传递给对象，而不是传递模板。

为了简化组件中的语法，您可以添加一个（私有/内部？）属性

```
MyData Template { get { return m_templateProvider.Template; } }
void UpdateTemplate() { m_templateProvider.Template = 
                            (MyData) this.MemberwiseClone(); } 
```

模板提供程序还简化了多线程场景中的锁定。

* * *

简而言之，除非你自己做，否则没有办法。但是，如果您仍然覆盖所有属性，为什么不创建一个新对象呢？

`memcopy`不支持类似的低级构造，因为它们破坏了环境做出的保证。

结构的浅拷贝是通过赋值进行的。对于类，`MemberwiseClone`是执行此操作的方法-但正如您所说，这会创建一个新对象。

没有内置的方法，因为它可能会破坏封装，所以无论如何都应该小心使用。

您可以使用反射构建一个通用例程，但它是否有效取决于类本身。是的，ti 会比较慢。

剩下的是通过自定义界面支持它。您可以提供一个通用的“浅拷贝”例程来检查接口并使用它，并在没有时回退到反射。这使得该功能普遍可用，并且您可以在以后优化性能重要的类。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-04T14:33:25.650

```
namespace WindowsFormsApplication7
{

    [Serializable] // just put this in your class
    class Mate
    {
        public string SomeProperty { get; set; }
    }

    public partial class Form1 : Form
    {
        public Form1()
        {
            InitializeComponent();

            var mA = new Mate();
            mA.SomeProperty = "Hey";

            var vf = new BinaryFormatter();
            var ns = new MemoryStream();
            vf.Serialize(ns, mA);
            byte[] vytes = ns.ToArray();

            var vfx = new BinaryFormatter();
            var nsx = new MemoryStream();            
            nsx.Write(vytes, 0, vytes.Length);
            nsx.Seek(0, 0);
            var mB = (Mate)vfx.Deserialize(nsx);

            mA.SomeProperty = "Yo";

            MessageBox.Show(mA.SomeProperty); // Yo
            MessageBox.Show(mB.SomeProperty); // Hey
        }
    }
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-04T11:45:33.713

我想你可以这样做：

```
YourObjectType A = new YourObjectType();
YourObjectType B = a.MemberwiseClone(); 
```

这将在 MemberwiseClone 方法中创建一个新对象，并使 B 对象引用它。我想它符合你的目的。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-04T13:51:24.427

出于所有意图和目的，将一个结构分配给另一个结构的工作方式与 C++ 中的 POD 对象*完全*一样`memcpy`。

如果您觉得这不适用于您的情况，那么我可以向您保证您的 C++ 代码不符合标准（即，包含未定义行为形式的错误）。请指定（*在问题中*）您想要达到的效果。这将比谈论用另一种语言复制未定义的行为更有用。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-04T14:41:30.673

```
namespace WindowsFormsApplication7
{
    public partial class Form1 : Form
    {
        public Form1()
        {
            InitializeComponent();

            var dt = new DataTable();
            dt.Columns.Add("lastname", typeof(string));
            dt.Columns.Add("firstname", typeof(string));

            dt.Rows.Add("lennon", "john");
            dt.Rows.Add("mccartney", "paul");

            var ms = new MemoryStream();
            var bf = new BinaryFormatter();
            bf.Serialize(ms, dt);
            byte[] bytes = ms.ToArray();

            var bfx = new BinaryFormatter();
            var msx = new MemoryStream();
            msx.Write(bytes, 0, bytes.Length);
            msx.Seek(0, 0);

            // doesn't just copy reference, copy all contents
            var dtx = (DataTable)bfx.Deserialize(msx);

            dtx.Rows[0]["lastname"] = "Ono";

            // just copy reference
            var dty = dt;

            dty.Rows[0]["lastname"] = "Winston";

            MessageBox.Show(dt.Rows[0]["lastname"].ToString()); // Winston
            MessageBox.Show(dtx.Rows[0]["lastname"].ToString()); // Ono
            MessageBox.Show(dty.Rows[0]["lastname"].ToString()); // Winston

        }
    }
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-04T13:46:00.410

我不能使用新创建的对象，因为我喜欢根据其中一个实例的状态来更改**模板对象（即由该模板构成的实例）**

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-02-04T13:48:28.143

当我想到它时 - 查看 MemberWiseClone() 方法实现的代码并了解 Microsoft 如何解决我的问题非常有趣。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2021-05-17T10:12:05.297

C# / .Net memcpy 等效为**Buffer.MemoryCopy**。

```
void MemoryCopy (void* source, void* destination, long destinationSizeInBytes, long sourceBytesToCopy); 
```

[https://docs.microsoft.com/en-us/dotnet/api/system.buffer.memorycopy?view=net-5.0](https://docs.microsoft.com/en-us/dotnet/api/system.buffer.memorycopy?view=net-5.0)

# python - 获取实例的类名？

> ID：510972
> 
> 赞同：1771
> 
> 时间：2009-02-04T11:37:48.407
> 
> 标签：python, introspection, instanceof, python-datamodel

如果我正在执行此操作的函数是派生实例类的基类，我如何找出在 Python 中创建对象实例的类的名称？

在想也许[检查模块](https://docs.python.org/2/library/inspect.html "inspect — 检查活动对象")可能在这里帮助了我，但它似乎并没有给我想要的东西。并且缺少解析`__class__`成员，我不确定如何获取此信息。

* * *

## 回答 #1

> 赞同：2324
> 
> 时间：2009-02-04T12:02:12.960

你试过类的[`__name__`属性](https://docs.python.org/library/stdtypes.html#definition.__name__)吗？即`type(x).__name__`会给你班级的名字，我认为这是你想要的。

```
>>> import itertools
>>> x = itertools.count(0)
>>> type(x).__name__
'count' 
```

如果您仍在使用 Python 2，请注意上述方法仅适用于[新式类](https://wiki.python.org/moin/NewClassVsClassicClass)（在 Python 3+ 中，所有类都是“新式”类）。您的代码可能会使用一些旧式类。以下适用于两者：

```
x.__class__.__name__ 
```

* * *

## 回答 #2

> 赞同：491
> 
> 时间：2009-02-04T12:02:16.597

你想要类名作为字符串吗？

```
instance.__class__.__name__ 
```

* * *

## 回答 #3

> 赞同：147
> 
> 时间：2009-02-04T11:42:31.767

[`type()`](https://docs.python.org/3/library/functions.html#type)?

```
>>> class A:
...     def whoami(self):
...         print(type(self).__name__)
...
>>>
>>> class B(A):
...     pass
...
>>>
>>>
>>> o = B()
>>> o.whoami()
'B'
>>> 
```

* * *

## 回答 #4

> 赞同：47
> 
> 时间：2014-06-09T23:04:17.907

```
class A:
  pass

a = A()
str(a.__class__) 
```

上面的示例代码（在交互式解释器中输入时）将产生`'__main__.A'`，而不是在调用属性时`'A'`产生。`__name__`只需将结果传递`A.__class__`给`str`构造函数，即可为您处理解析。但是，如果您想要更明确的内容，也可以使用以下代码。

```
"{0}.{1}".format(a.__class__.__module__,a.__class__.__name__) 
```

如果您在单独的模块中定义了具有相同名称的类，则此行为可能更可取。

**上面提供的示例代码在 Python 2.7.5 中进行了测试。**

* * *

## 回答 #5

> 赞同：30
> 
> 时间：2013-04-30T05:50:38.277

在 Python 2 中，

```
type(instance).__name__ != instance.__class__.__name__
# if class A is defined like
class A():
   ...

type(instance) == instance.__class__
# if class A is defined like
class A(object):
  ... 
```

例子：

```
>>> class aclass(object):
...   pass
...
>>> a = aclass()
>>> type(a)
<class '__main__.aclass'>
>>> a.__class__
<class '__main__.aclass'>
>>>
>>> type(a).__name__
'aclass'
>>>
>>> a.__class__.__name__
'aclass'
>>>

>>> class bclass():
...   pass
...
>>> b = bclass()
>>>
>>> type(b)
<type 'instance'>
>>> b.__class__
<class __main__.bclass at 0xb765047c>
>>> type(b).__name__
'instance'
>>>
>>> b.__class__.__name__
'bclass'
>>> 
```

* * *

## 回答 #6

> 赞同：18
> 
> 时间：2017-09-13T19:11:19.797

或者，您可以使用`classmethod`装饰器：

```
class A:
    @classmethod
    def get_classname(cls):
        return cls.__name__

    def use_classname(self):
        return self.get_classname() 
```

**用法**：

```
>>> A.get_classname()
'A'
>>> a = A()
>>> a.get_classname()
'A'
>>> a.use_classname()
'A' 
```

* * *

## 回答 #7

> 赞同：16
> 
> 时间：2012-02-21T19:07:40.763

好问题。

这是一个基于 GHZ 的简单示例，可能对某人有所帮助：

```
>>> class person(object):
        def init(self,name):
            self.name=name
        def info(self)
            print "My name is {0}, I am a {1}".format(self.name,self.__class__.__name__)
>>> bob = person(name='Robert')
>>> bob.info()
My name is Robert, I am a person 
```

* * *

## 回答 #8

> 赞同：12
> 
> 时间：2017-07-12T15:01:54.767

除了获取特殊[`__name__`](https://docs.python.org/3/library/stdtypes.html#definition.__name__)属性之外，您可能会发现自己需要给定类/函数的[限定名称](https://www.python.org/dev/peps/pep-3155/)。这是通过抓取类型来完成的`__qualname__`。

在大多数情况下，它们是完全相同的，但是，在处理嵌套类/方法时，它们的输出会有所不同。例如：

```
class Spam:
    def meth(self):
        pass
    class Bar:
        pass

>>> s = Spam()
>>> type(s).__name__ 
'Spam'
>>> type(s).__qualname__
'Spam'
>>> type(s).Bar.__name__       # type not needed here
'Bar'
>>> type(s).Bar.__qualname__   # type not needed here 
'Spam.Bar'
>>> type(s).meth.__name__
'meth'
>>> type(s).meth.__qualname__
'Spam.meth' 
```

由于内省是您所追求的，因此您可能始终需要考虑这一点。

* * *

## 回答 #9

> 赞同：8
> 
> 时间：2020-11-15T10:12:51.177

您可以简单地使用`__qualname__`which 代表函数或类的限定名称

例子：

```
>>> class C:
...     class D:
...         def meth(self):
...             pass
...
>>> C.__qualname__
'C'
>>> C.D.__qualname__
'C.D'
>>> C.D.meth.__qualname__
'C.D.meth' 
```

文档链接[**qualname**](https://docs.python.org/3/glossary.html#term-qualified-name)

* * *

## 回答 #10

> 赞同：5
> 
> 时间：2020-05-21T15:03:36.170

获取实例类名：

```
type(instance).__name__ 
```

或者

```
instance.__class__.__name__ 
```

两者都是一样的

# java - 调用方法时如何绕过Java中的继承

> ID：510976
> 
> 赞同：1
> 
> 时间：2009-02-04T11:38:52.167
> 
> 标签：java, inheritance, oop

```
 class Super {

        public void anotherMethod(String s) {
            retValue(s)
        }

        public String retValue(String s) {
            return "Super " + s;
        }

    }

    class Sub extends Super {

        public void anotherMethod(String s) {
            retValue(s)
        }

        public String retValue(String s) {
            return "Sub " + s;
        }

    } 
```

> 如果主要假设，

```
Super s = new Sub();
s.anotherMethod("Test"); 
```

> 输出将是，子测试

谁能帮助我告诉如何使用 main 中的给定序列获得输出**Super** **Test**。

 **> > *让我解释一下为什么我想要这个，比如说我有一个类，它有方法 test() 并且它可以被子类覆盖，在某些情况下我想要覆盖的 test() 并且在某些情况下我想要 test()超级类本身，有很多方法可以做到这一点，最好的建议会有所帮助。*

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-02-04T11:43:41.063

你为什么要那样做？？

多态性的全部意义在于调用正确的方法，而无需知道您拥有哪种实例...

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-02-04T12:27:21.273

每当我发现自己问（或被问到）这样的问题时，我明确地**知道**我在设计和/或对象定义中犯了一个错误。回到您的对象层次结构并检查、反复检查和三次检查每个继承关系是否代表“IS-A”，而不是“HAS-A”或更弱的东西。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-04T12:32:05.943

> *让我解释一下为什么我想要这个，比如说我有一个类，它有方法 test() 并且它可以被子类覆盖，在某些情况下我想要覆盖 test() 和在某些情况下超类本身的 test()，有很多方法可以做到这一点，如果有人能成为最好的解决方案，那将会很有帮助。*

如果您的子类覆盖`test()`，**那么它会覆盖 test()** - 这是对象继承的重点。您只需调用对象上的方法，这些方法会根据对象的运行时类动态解析为适当的实现。这就是多态类型的美妙之处，事实上，调用者根本不需要知道这些，子类决定了它们的行为与超类有何不同。

如果您有时希望它充当其超类方法，有时又希望它充当其子类方法，那么您需要提供执行此操作所需的上下文。您可以定义两种测试类型方法；一个永远不会被覆盖，因此总是返回超类的行为（您甚至可以用标记定义`final`以确保它不会被覆盖），以及您的正常一个，它会被子类酌情覆盖。

或者，如果有一些上下文信息可用，您可以让子类决定如何处理它；例如，他们的实现可以检查一些属性，并据此决定是调用`super.test()`还是继续他们自己的覆盖实现。

您选择哪一个在概念上取决于您的`main`方法（即调用者）或（子）类对象本身是否将处于判断是否应该调用超类的方法的最佳位置。

但是在任何情况下，您都不能覆盖一个方法并期望它有时会神奇地不被覆盖。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-04T11:53:05.287

你将不得不走的路线：

```
Super s = new Super();
s.anotherMethod("Test"); 
```

...但是如果您还需要 Sub 所拥有的任何东西，那将破坏继承的目的。你可以像下面那样破解它，但这似乎是一种不雅的方式。

```
class Sub extends Super {

    public String anotherMethod( String s, boolean bSuper ) {
        if( bSuper )
            return super.retValue(s);
        else
            return retValue(s);
    }

    public String retValue(String s) {
        return "Sub " + s;
    }

} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-04T11:45:39.843

从类 Sub 你可以调用 super.anotherMethod("bla")，但是你不能在你的 main 方法中访问超类的方法——这与使用子类的整个想法背道而驰。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-04T11:45:47.783

的运行时类型`s`是`Sub`，因此您只调用该类的方法。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-04T11:57:08.900

虽然我同意其他海报的观点，即这不是世界上最好的主意，但我相信只要稍加修改就可以完成。

如果您的子类定义为：

```
 class Sub extends Super {

        public void anotherMethod(String s) {
            retValue(s)
        }

        public void yetAnotherMethodString s) {
            super.retValue(s)
        }

        public String retValue(String s) {
            return "Sub " + s;
        }

    } 
```

然后在你的 main 中调用这个新方法，你就可以打印出“Super Test”。

似乎不是一个很好的计划。如果您想从子类访问父功能，请不要覆盖您的父方法，只需编写一个新方法！

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-02-04T12:03:26.843

我不愿将此作为答案发布，因为这个问题非常可怕 - 但静态方法大致可以满足 OP 似乎想要的。具体来说，它们在变量的编译时声明的类上解析，而不是在运行时在该变量中保存的实例的类上解析。

所以修改原来的例子：

```
class Super {

        public static void staticMethod(String s) {
            System.out.println("Super " + s);
        }
}

```
class Sub extends Super {

    public static void staticMethod(String s) {
        System.out.println("Sub " + s);
    }

}

public static void main(String[] args) {

    Super s = new Sub();
    s.staticMethod("Test");

} 
``` 
然后 main() 将打印出“超级测试”。但是在你明白你为什么要这样做之前，仍然*不要这样做，并且你认识到你正在引入子类，然后无偿地围绕它们存在的点进行工作。*例如，大多数 IDE 会用大量警告标记上述示例，说您不应该在实例变量上调用静态方法（即更喜欢`Super.staticMethod("Test")`而不是`s.staticMethod("Test")`），正是出于这个原因。

            回答 #9

赞同：0

时间：2009-02-04T12:57:27.157

您不能直接修改 Sub 或 Super 吗？如果您可以控制使用哪个 Sub 实例，您可以执行以下操作：

```
Super sub = new Sub() {
  @Override
  public String retValue() {
    // re-implement Super.retValue()
  }
};
otherObject.use(sub); 
```

当然，这要求您拥有或能够重现 Super.retValue() 的源代码，并且此方法不能使用您无法从匿名孩子那里访问的任何内容。如果 API 设计得这么糟糕，您最好考虑将其更改为其他内容。

            回答 #10

赞同：-1

时间：2009-02-04T12:00:20.860

谁能帮我告诉我如何`Super Test`用给定的序列来获得输出“” `main`。

*   首先不要覆盖`anotherMethod()`和`retValue()`。`Sub`

*   在 S`ub.anotherMethod()`中，返回而不是。**`super`**`.retValue(s)``retValue(s)`

        sql-server - SSRS - html 报告中损坏/丢失的切换图像

ID：510978

赞同：2

时间：2009-02-04T11:39:07.547

标签：sql-server, sql-server-2005, reporting-services

*   SSRS 版本是 Windows 2003 x64 sp2 和 IIS 6 上的 SQL 2005 x64 sp2
*   客户端在 Win2k sp4 和 WinXP sp3 的混合上运行 IE 6
*   通过标准 SSRS html 查看器访问报告

正如标题所暗示的，我的问题是，在使用切换按钮来控制部分可见性的 SSRS 报告中，切换按钮的图形将不会显示或显示为断开的链接（标准 IE 缺少图像占位符）。在任何一种情况下，当单击链接时，切换操作都会继续运行。

这种情况大约每执行五次报告就会发生一次。

我已经使用 Fiddler 来确定无论图像链接是否损坏或图像不可见，浏览器都不会从服务器请求它。

这听起来很像[http://support.microsoft.com/default.aspx?scid=kb;en-us;319546](http://support.microsoft.com/default.aspx?scid=kb;en-us;319546)中描述的 IE“功能” ，我以前被咬过但能够绕过因为我控制了网络应用程序的源代码。

在这种情况下，组件由 MS 提供，源不可访问。

有没有其他人遇到过这个问题？你有什么建议我可以解决它吗？

**更新：**我已经单独使用 SP2 + CU10、SP3 和 SP3 + CU1 进行了测试（CU 10 和 CU 11 没有进入 SP3，并在 SP3 的 CU1 中发布）。

*   SP3 似乎减少了损坏图像故障的实例
*   SP2 + CU10 和 SP3 + CU1 似乎都消除了损坏的图像故障。

但是，在所有情况下，不可见图像问题都会以大致相同的频率继续发生。在以后的 CU 中缺少修复，我对完整的解决方案没有太大希望。

            回答 #1

赞同：1

时间：2009-02-10T20:49:43.847

当我们的打印控制出现问题时，我已经看到了这个问题。自从我们更新到最新版本的 SSRS 后，我再也没有看到它。您是否安装了 SP2 的累积更新？

        asp.net-mvc - ASP.NET MVC 下 AJAXToolKit 的问题

ID：510994

赞同：-1

时间：2009-02-04T11:44:01.127

标签：asp.net-mvc, ajax

我在我的 MVC 应用程序中使用 AjaxToolKit，如
[http://stephenwalther.com所示](http://stephenwalther.com)

自动完成和日历工作正常，但我无法将属性传递给 js 部分。我生成的 javascript 看起来像这样

```
<script type='text/javascript'>
Sys.Application.add_init(function(){
$create(AjaxControlToolkit.CalendarBehavior,{'Format':'MMMM d, yyyy','PopupButtonID':'Image1'},null,null,$get('Birthday'))});
</script> 
```

但是日历仍然使用默认格式，我知道它必须是一个小错误但我没有找到它:(

蒂亚

            回答 #1

赞同：0

时间：2009-02-08T18:36:05.393

我自己发现了问题，javascript 是区分大小写的 dohh :)

        javascript - 使用 jQuery 解析 xml 响应

ID：510995

赞同：23

时间：2009-02-04T11:44:03.997

标签：javascript, jquery, xml

大家好，

我使用 jQuery 来解析我的 xml 响应。

我有这个 xml：

```
<?xml version="1.0" encoding="UTF-8"?>
<response status="ok">
  <client_id>185</client_id>
</response> 
```

我想获得“client_id”的价值。

            回答 #1

赞同：39

时间：2009-02-04T11:54:30.247

要在您的请求中将预期的响应数据类型固定为 XML，请将`dataType`参数设置为“xml”。如果你不这样做，jQuery 会使用响应头来进行猜测。

它支持`$.ajax()`作为对象的一部分的函数`options`，以及 on`$.get()`和`$.post()`：

```
jQuery.ajax( options )
jQuery.get( url, data, callback, type )
jQuery.post( url, data, callback, type ) 
```

所以你可以这样做：

```
$.ajax({
  type: 'GET',
  url: "foo.aspx",
  data: {
    key: "value"
  },
  dataType: "xml",
  success: function (xml){
    var clientid = $(xml).find('client_id').first().text();
    alert(clientid);
  }   
}); 
```

请注意，从 jQuery 1.5 开始，您可以使用上述 Ajax 请求的更好版本：

```
$.get("foo.aspx", {
  key: "value"
})
.done(function (xml){
  var clientid = $(xml).find('client_id').first().text();
  alert(clientid);
}); 
```

            回答 #2

赞同：38

时间：2009-02-04T11:51:55.027

首先，使用 $.get 或您想要的任何方式请求 XML。然后：

```
clientID = $(myXML).find("client_id").text(); 
```

            回答 #3

赞同：2

时间：2009-02-04T12:08:37.300

使用这样的东西：

```
$.ajax({ type: 'GET', url: 'test.xml', dataType: 'xml', success: function(xml){
            $('response', xml).each(function() {alert($(this).find('client_id').text());});         
            }}); 
```

            回答 #4

赞同：2

时间：2009-04-30T07:50:17.183

只是为了补充，我使用 $.get：

```
$.get($('file.xml').val(),{  } , doSomethingWithData); 
```

函数doSomethingWithData（数据）{

```
 $(data).find("marker").each(function() {

        var marker = $(this);

     alert(marker.attr("lat"));

 }); 
```

这里 tpicall 使用的 request.responseXML 是本例中的数据，您必须将其封装在 $(data) 中才能工作（这让我头疼了大约 3 小时；S）  

```
 //    alert(markerh);

                } 
```

        asp.net - 文字控件用于什么，与 asp.net 中的标签控件有什么区别？

ID：510998

赞同：16

时间：2009-02-04T11:44:44.930

标签：asp.net, controls

在 asp.net 中使用什么文字控件？它们和标签控件有什么区别？

            回答 #1

赞同：20

时间：2009-02-04T11:51:28.647

主要区别在于**标签**控件将跨度标签添加到您设置的文本（属性）中，允许对其应用样式：

```
<span>My Label text</span> 
```

**Literal** Control 允许您呈现任何类型的内容。您可以使用它来呈现脚本、hmtl 和任何其他类型的文档内容。它不会更改您在 Text 属性中提供的字符串。

*注意：Label 控件也允许您直接呈现 HTML，但它会将您的所有文本放在 span 标记中，如前所述。因此，对于呈现较大的 HTML 部分，文字控件是要走的路。*

**PS：**在*HTML*中有一个`<label>`标签。如果您使用`AssociatedControlId`Label 控件的属性，它将呈现为 HTML `<label>` *（感谢 Ray 指出这一点。）*

例如：

```
<asp:Label runat="server" id="FirstNameLabel" AssociatedControlId="FirstNameTextBox">
Input First Name:
</asp:Label>
<asp:Textbox runat="server" id="FirstNameTextBox" /> 
```

将呈现为：

```
<label for="FirstNameTextbox" id="FirstNameLabel">Input first name:</label>
<input type="text" id="FirstNameTextbox" name="FirstNameTextBox" /> 
```

另请参阅[此处](http://www.w3schools.com/tags/tag_label.asp)的 W3 学校。

            回答 #2

赞同：4

时间：2009-07-18T23:07:19.130

还要注意的一件事是，如果您只是使用它来显示某些内容并且不需要格式化文本，请使用 Literal 控件。ViewState 与 Literal 与 Label 控件相比没有那么重，当您在使用 ViewState 的页面上拥有许多这样的控件时，它确实会使您的页面大小膨胀。

我总是问自己，我需要应用自定义样式或格式吗？是的，使用标签。不，使用文字。

            回答 #3

赞同：2

时间：2009-02-04T11:47:25.237

它用于在页面上显示文本，显示的文本可以在运行时通过服务器端代码设置。

            回答 #4

赞同：2

时间：2009-02-04T12:00:12.950

标签控件还具有将标签与另一个控件相关联的 AssociatedControlId 属性。一个有用的例子是文本框控件。一旦将这些关联起来，屏幕阅读器就能够提供更好的结果。

另一个例子是带有标签的单选按钮允许您单击标签，如果设置了 AssociatedControlId 属性，单选按钮将选择。

[在 AssoicatedControlId 上的 MSDN](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.label.associatedcontrolid.aspx)

            回答 #5

赞同：1

时间：2009-02-04T12:58:15.623

正如 splattne 所提到的，标签将其文本包含在一个跨度中，而文字只是一个占位符。但是，在假设 ASP.Net 控件将如何呈现时要小心。它可能取决于您使用的用户代理。例如，面板控件在 IE 中呈现为 div，但在 Firefox 中呈现为表格。

            回答 #6

赞同：0

时间：2009-02-04T11:51:12.577

它会在字面上放置您在页面上放置的任何文本。您可以使用它来编写 html、JavaScript 或纯文本。

            回答 #7

赞同：0

时间：2014-01-17T14:05:53.917

*   我们可以在标题标签中使用文字控制，而标签不能在标题标签中使用
*   标签可用于将焦点设置在文本框等其他控件上。而 Literal 只是简单地排列网页上的静态文本

```*******************