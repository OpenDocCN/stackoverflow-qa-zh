# StackOverflow 问答 11143000-11143999

# wordpress - first class for every first post on page wordpress

> ID：11143001
> 
> 赞同：1
> 
> 时间：2012-06-21T16:53:55.423
> 
> 标签：wordpress, class, post

how could i get for every post on a page a post_class "first"?

with this code a managed a class "first_post" for the really first post of the loop, but i need it also on the second, third and so on page of the loop.

function.php

```
function firstpost_class($class) {
    global $post, $posts;
    if ( is_home() && !is_paged() && ($post == $posts[0]) ) $class[] = 'firstpost';
    return $class;
}
add_filter('post_class', 'firstpost_class'); 
```

Thanks for your help. Google couldn't help yet.

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-06-22T17:11:47.990

I've seen this kind of thing done on the loop itself -- comment to clarify if you want to do this site-wide, or particularly want to hook into post_class (then again, you can edit loop.php or a content-LOOPTYPE.php and reuse it over and over). Here's an example loop:

```
<?php
$counter = 0;
if ( have_posts() ) : while ( have_posts() ) : the_post();
$counter++;
?>

<div class="post <?php echo 'item-' . $counter; ?>">
  <?php the_title(); ?>
  <?php the_content(); ?>
</div>

<?php endwhile; endif; ?> 
```

This would give you item-1, item-2, etc. etc.

# java - 在 JTable 中使用自定义渲染器时遇到问题

> ID：11143002
> 
> 赞同：0
> 
> 时间：2012-06-21T16:53:55.920
> 
> 标签：java, swing

以下是我的单元格渲染器和编辑器：

```
package org.lims.register.gui;

import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;

import javax.swing.JButton;
import javax.swing.JPanel;
import javax.swing.JTextField;

public class EmpNamePanel extends JPanel {  

    private static final long serialVersionUID = 934032676749762710L;

    private JTextField empNameTF;
    private JButton browseB;

    public EmpNamePanel(){
        super(null);
        empNameTF=new JTextField();
        empNameTF.setEditable(false);
        empNameTF.setBounds(0, 0, 150, 30);
        add(empNameTF);
        browseB=new JButton("Browse");
        browseB.addActionListener(new ActionListener(){
            public void actionPerformed(ActionEvent event){
                empNameTF.setText("Murali");
            }
        });
        browseB.setBounds(150,0, 100, 30);
        add(browseB);
    }

    /**
     * @return the empNameTF
     */
    public JTextField getEmpNameTF() {
        return empNameTF;
    }

    /**
     * @return the browseB
     */
    public JButton getBrowseB() {
        return browseB;
    }
} 
```

* * *

```
package org.lims.register.gui.model;

import java.awt.Component;

import javax.swing.JTable;
import javax.swing.table.TableCellRenderer;

import org.lims.register.gui.EmpNamePanel;

public class EmpNamePanelRenderer extends EmpNamePanel implements TableCellRenderer{

    private static final long serialVersionUID = 5637984468556275113L;

    /* (non-Javadoc)
     * @see javax.swing.table.TableCellRenderer#getTableCellRendererComponent(javax.swing.JTable, java.lang.Object, boolean, boolean, int, int)
     */
    @Override
    public Component getTableCellRendererComponent(JTable table, Object value,
            boolean isSelected, boolean hasFocus, int row, int column) {
        if (isSelected) {
            setForeground(table.getSelectionForeground());
            super.setBackground(table.getSelectionBackground());
        } else {
            setForeground(table.getForeground());
            setBackground(table.getBackground());
        }
        System.out.println("value ;"+value);
        getEmpNameTF().setText((String)value);
        return this;
    }
} 
```

* * *

```
package org.lims.register.gui.model;

import java.awt.Component;

import javax.swing.AbstractCellEditor;
import javax.swing.JTable;
import javax.swing.table.TableCellEditor;

import org.lims.register.gui.EmpNamePanel;

public class EmpNamePanelEditor extends AbstractCellEditor implements TableCellEditor{

    private static final long serialVersionUID = -5575645761840609401L;
    private EmpNamePanel enp;

    /* (non-Javadoc)
     * @see javax.swing.CellEditor#getCellEditorValue()
     */
    @Override
    public Object getCellEditorValue() {
        String value=enp.getEmpNameTF().getText();
        return value;
    }

    /* (non-Javadoc)
     * @see javax.swing.table.TableCellEditor#getTableCellEditorComponent(javax.swing.JTable, java.lang.Object, boolean, int, int)
     */
    @Override
    public Component getTableCellEditorComponent(JTable table, Object value,
            boolean isSelected, int row, int column) {
        enp=new EmpNamePanel();
        return enp;
    }
} 
```

我正在使用这个渲染器和编辑器。一切正常。当我单击浏览按钮时，文本显示在文本字段中，当我专注于表格中的其他列时，文本在 textField 中正确显示，但是当我离开此列并且当我返回文本字段时，文本正在消失，文本字段为空白。我的期望是，在我通过单击浏览按钮更改文本之前，应该显示相同的文本。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-22T09:02:10.820

没有 actionListeners 或 eventListeners。当 focusGained 和 FocusLost 时你需要它们。使用 java 文档，添加和实现适当的监听器

# javascript - 在文本框中按下回车后，防止模糊和 keyup 事件触发

> ID：11143011
> 
> 赞同：14
> 
> 时间：2012-06-21T16:54:20.583
> 
> 标签：javascript, jquery

按下后`enter`，我希望只有`keyup`事件被触发，但`blur`首先被触发。被解雇`blur`时如何取消？`keyup``enter`

请不要建议将两者绑定`blur`到`keyup`一个`live()`方法中。

```
$(".textbox").on("blur",function () { 
    alert("blur Event fired");
});

$(".textbox").on("keyup",function (event) { 
    if(event.keyCode == 13){ // Detect Enter
        alert("KeyUp fired after pressing Enter");
    }
}); 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-21T16:59:22.417

**编辑**

为了防止这两个事件触发，您必须以某种方式标记元素，然后才能使其失去焦点。这样，您的`blur`事件处理程序可以判断该事件是否是 keyup 的主题，或者它是否合法地失去了焦点。像这样的东西：

```
$(".textbox").live("blur",function (event) {
    if (!$(this).hasClass('keyupping'))
        alert("blur Event fired");
});

$(".textbox").live("keyup",function (event) {
    $(this).addClass('keyupping');
    if(event.keyCode == 13){ // Detect Enter
        alert("KeyUp fired after pressing Enter");
    }
    $(this).removeClass('keyupping');
}); 
```

试试看：http: [//jsfiddle.net/GRMule/sR6zm/](http://jsfiddle.net/GRMule/sR6zm/)

* * *

**原始答案**

当`keyup`触发事件时，它准备绘制浏览器警报对话框，该对话框从文档中获取焦点并将其应用于模式对话框。这会触发模糊事件。

然后该事件会在知道什么击中它`blur`之前跳入并完成其执行上下文。`keyup`

这可以通过使用*不会*将焦点从元素上移开的东西来证明，例如：http `console.log`: [//jsfiddle.net/GRMule/7vRLW/](http://jsfiddle.net/GRMule/7vRLW/)

事件触发的顺序是特定于实现的，这意味着您不能像 IE 一样依赖 Firefox。请参阅规范：[http](http://www.w3.org/TR/2000/REC-DOM-Level-2-Events-20001113/events.html#Events-eventgroupings) ://www.w3.org/TR/2000/REC-DOM-Level-2-Events-20001113/events.html#Events-eventgroupings 。尝试在 IE 中使用警报，在这种情况下，您会看到`blur`之前`keyup`在 IE 7 中确实出现过——并且`blur`在 Chrome 中不会触发！

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2014-07-07T01:56:39.243

我有一个类似的问题。我允许用户编辑单个字段，当他们按 Enter 或移出该字段时，我会发送一个 Ajax 请求来更新它。我发现当我按下 Enter 时，Ajax 请求被发送了两次。

因此，我没有在 Enter 上调用我的请求，而是尝试调用`$input.blur()`，并且成功了！这让我想到......如果 Enter 键导致模糊，我什至需要尝试捕捉它吗？

就我而言，我不需要。我发现我需要的只是模糊，因为无论如何 Enter 键都会触发它。我不确定在所有浏览器中是否 100%，但我确实在 Chrome、Firefox、IE 和 Safari 的当前版本上进行了测试，所有这些都运行良好。

因此，我建议您要么根本不捕获 Enter，要么只需调用 blur() 来触发所需的操作。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2017-06-03T02:44:27.537

我有一个输入，用户可以在其中更改、聚焦或按 Enter。但是当你按下回车键和模糊被触发，所以`myFunction()`被触发两次。

因此，不必为`keydown`and编写两个单独的函数`blur`，而是可以将它们放入一个函数中：

```
my_input.on('keydown blur', function (e) {

    // was it the Enter key?
    if (e.which == 13) {
        $(this).blur();
    }

    if (e.type == 'blur') {
        myFunction();
    }

}); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-08-05T06:39:08.957

试试下面的。**添加**一个类——在本例中，在 keyup 事件处理程序中添加并修改模糊事件的选择器将阻止模糊事件处理程序触发。

```
$(".textbox:not(.added)").on("blur", function () { 
    alert("blur Event fired");
});

$(".textbox").on("keyup", function (event) { 
    if (event.keyCode == 13) {
        $(event.currentTarget).addClass('added');
        alert("KeyUp fired after pressing Enter");
    }
}); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-03-13T14:36:55.107

下面的代码对我有用，在 primefaces 5.2.5

`<p:inputText onkeydown="if (event.keyCode === 13) {return false; }" value="#{myForm.name}"> <p:ajax event="blur" update="@this" listener="#{bean.func()}" /> </p:inputText>`

即使按下 Enter 键，也不会触发模糊事件。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2020-01-24T16:36:00.887

基本上，`keyup`是`blur`事件的触发器。当 keyup 触发时，您应该添加一个标志：

```
 $('#exemple').keyup(function (e) {
        if (e.which == 13) {
            $('#exemple').addClass('keyupfired');
            alert('whatever');
        }
    }); 
```

然后，当`blur`被解雇时，它也应该询问是否`keyup`已经被解雇。如果您希望在用户离开文本框时触发事件，请记住删除该标志：

```
$('#exemple').on("blur", function () {
        if (!$('#exemple').hasClass('keyupfired')) {
            alert('whatever');
        }
        $('#exemple').removeClass('keyupfired');
    }); 
```

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2014-09-27T06:23:00.373

我无法更改`class`属性，所以我最终得到了，

```
$(".textbox").on("blur",function () { 
    if($(this).attr('flag')!='1') 
        alert("blur Event fired");
});

$(".textbox").on("keyup",function (event) { 
    $(this).attr('flag','1');
    if(event.keyCode == 13){ // Detect Enter
        alert("KeyUp fired after pressing Enter");
    }
    $(this).attr('flag','0');
}); 
```

* * *

## 回答 #8

> 赞同：-3
> 
> 时间：2012-06-21T17:20:39.593

它引起了我的注意，而不是提供提示，我应该给出更完整的解释和代码示例，所以这里是：总是有设置外部变量的廉价方法：

```
var triggerBlur = true;
$(".textbox")
    .live({
       blur : function () { 
        if (triggerBlur) {// if not preceded by keyup 'Enter' event
            alert("blur Event fired");
        }
        // reset variable to true to allow the blur event to be triggered subsequently when not preceded by keyup 'Enter' event
        triggerBlur = true;
      },
      keyup : function (event) { 
        if(event.which === 13){ // Detect Enter
            alert("KeyUp fired after pressing Enter");
            triggerBlur = false;
        }
      }); 
```

此外，最好使用 event.which 而不是 event.keyCode（请参阅[http://api.jquery.com/event.which/](http://api.jquery.com/event.which/)了解原因），并且建议使用身份运算符 '===' 而不是javascript 中的相等 '=='，因为后者被破坏了（请参阅[应在 JavaScript 比较中使用哪个等号运算符 (== vs ===)？](https://stackoverflow.com/questions/359494/javascript-vs-does-it-matter-which-equal-operator-i-use)）

# excel - 运行宏时使用 Excel

> ID：11143013
> 
> 赞同：2
> 
> 时间：2012-06-21T16:54:29.130
> 
> 标签：excel, vba

我不确定这是否可以做到，但是如果用户可以在宏在后端运行时使用 excel 电子表格，那就太好了。有什么办法可以做到这一点？谢谢。

编辑：用户通过宏重复（> 10 ^ 5 次）在 n 项（n ~ 100）上生成随机排列。这可能需要大约 10-15 分钟（或更长时间）才能完成。因此，如果用户可以在宏运行时打开 Excel 工作簿来执行其他任务，那就太好了。（它通常是与运行宏的工作簿不同的工作簿）。请让我知道这是否可以完成，如果可以，它可能对正在运行的宏产生任何性能影响。谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-22T09:54:35.827

用户可以在宏运行时打开 Excel 应用程序的第二个实例，并在其他工作簿上正常工作。同一个工作簿也可以打开，但只读。

# java - 在子类中完成 Main()

> ID：11143014
> 
> 赞同：-1
> 
> 时间：2012-06-21T16:54:32.937
> 
> 标签：java, terminate

我有一个 Main() 按计划作为 Thread 执行。如果发生异常（e.printStackTrace），线程将中止并等待下一次启动。

我希望能够在不抛出异常的情况下中止线程。在 Main()-Class 中它相当简单，只需“返回 false”，线程就结束了。

但是当我在一个类的类/对象中时，我不能这样做。如何从子类中中止/完成 Main？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-21T17:01:04.650

如果我理解你的话，你不想关闭整个程序，只是一些线程？

你需要从你进入的所有子方法中返回。你能展示你的方法`run()`在你的线程中的样子吗？

例如：如果您从某个函数（`doSomething()`）返回，则需要从方法返回`run()`：

```
@Override
public void run() {
    while (true) {
        doSomething(); // - your main function
    }
} 
```

只是检查一些条件。如果要退出设置值`boolean exiting = true;`并在循环中检查它：`if (exiting) return;`

关闭任何线程的正确方法就是从方法返回`run`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-21T17:00:50.187

您要中止线程，还是要关闭 VM？

如果要停止 VM，请尝试 Runtime.getRuntime().exit(0);

停止任意正在运行的线程通常是不安全的，请尝试阅读： [http ://docs.oracle.com/javase/6/docs/technotes/guides/concurrency/threadPrimitiveDeprecation.html](http://docs.oracle.com/javase/6/docs/technotes/guides/concurrency/threadPrimitiveDeprecation.html)

以便更好地说明情况。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-06-21T16:58:43.317

你可以试试 System.exit(0)。

让我们知道这是否有效。

# sql-server - 为什么这条 SQL 语句不运行

> ID：11143016
> 
> 赞同：1
> 
> 时间：2012-06-21T16:54:59.387
> 
> 标签：sql-server, tsql

```
SELECT * FROM agency
INNER JOIN TUser
[agency].[dbo].[Matrix_Branch_ID]=[TUser].[dbo].[client_id]
Microsoft SQL Server Managment Studio gives me: 
```

SQL Server Management Studio 给了我：

> 消息 170，级别 15，状态 1，第 3
> 行第 3 行：“.”附近的语法不正确。

**编辑**

修复语法错误后

```
SELECT * FROM agency
INNER JOIN TUser
ON dbo.agency.Matrix_Branch_ID=dbo.TUser.client_id 
```

SQL Server Management Studio 现在给了我：

> 消息 208，级别 16，状态 1，第 1 行
> 无效的对象名称“机构”。
> 消息 208，级别 16，状态 1，第 1 行
> 无效的对象名称“TUser”。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-21T17:58:46.867

如果您在 SSMS 中运行它 - 您在正确的数据库中吗？包含这两个表的那个？

![在此处输入图像描述](../Images/95567c41e3be81a343fb7185b1bc180f.png)

当查询窗口处于活动状态时，您可以看到您所在的当前数据库 - 无论是在工具栏上的下拉菜单中，还是在查询窗口的页脚中。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-06-21T16:56:04.047

您缺少`ON`关键字请参阅[FROM (Transact-SQL)](http://msdn.microsoft.com/en-us/library/ms177634.aspx)`<joined table>`中的语法

> ```
> <joined_table> ::=  {
>    <table_source> <join_type> <table_source> ON <search_condition> 
>    | <table_source> CROSS JOIN <table_source> 
>    | left_table_source { CROSS | OUTER } APPLY right_table_source 
>    | [ ( ] <joined_table> [ ) ]  } 
> ```

此外，`[dbo]`我认为表和字段名称之间的关系是错误的。请参阅[使用标识符作为对象名称](http://msdn.microsoft.com/en-us/library/ms187879%28SQL.105%29.aspx)

这应该工作

```
SELECT * FROM agency
INNER JOIN TUser
ON [agency].[Matrix_Branch_ID]=[TUser].[client_id] 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-21T17:26:00.817

您是否选择了正确的数据库？SQL Server 默认使用主数据库，这可能不是您想要的。

您可能想要限定表上的模式，而不是您选择的项目。例如：

```
Use [Database_name]

SELECT * FROM dbo.agency
INNER JOIN dbo.TUser ON agency.Matrix_Branch_ID=TUser.client_id 
```

# php - 无法导入资源错误

> ID：11143017
> 
> 赞同：1
> 
> 时间：2012-06-21T16:55:00.100
> 
> 标签：php, symfony

我刚刚安装了 FOSRestBundle 运行缓存时出现此错误：清除

```
[Symfony\Component\Config\Exception\FileLoaderLoadException]

  Cannot import resource "/Users/gitek/www/hotel/src/Gitek/RegistroBundle/Resources/config/routing_incidencia.yml" from "/Users/gitek/www/hotel/app/config/routing.yml".  

  [RuntimeException]                                                                                                                                                                                                                                                                                         

  The autoloader expected class "Gitek\RegistroBundle\Controller\IncidenciaController" to be defined in file "/Users/gitek/www/hotel/app/../src/Gitek/RegistroBundle/Controller/IncidenciaController.php". The file was found but the class was not in it, the class name or namespace probably has a typo. 
```

这是我的控制器：

```
<?php

namespace Gitek\RegistroBundle\Controller;

use Symfony\Bundle\FrameworkBundle\Controller\Controller;
use FOS\RestBundle\View\View;
use Gitek\RegistroBundle\Entity\Registro;
use Gitek\HotelBundle\Entity\Incidencia;

class UsuarioController extends Controller
{

    public function putIncidenciaAction($registro_id, $incidencia_id)
    {
        $em         = $this->get('doctrine')->getEntityManager();
        $registro   = $em->getRepository('RegistroBundle:Registro')->find($registro_id);
        $incidencia = $em->getRepository('HotelBundle:Incidencia')->find($incidencia_id);

        $request = $this->getRequest();

        $registro->setIncidencia($incidencia);
        $em->persist($registro);
        $em->flush();

        $view = View::create();
        $view->setData($registro);

        return $view;
    } // "put_incidencia"     [PUT] /incidencia/{registro_id, incidencia_id}

} 
```

这是我的#app/config/routing.yml

```
incidencias:
    resource: "@RegistroBundle/Resources/config/routing_incidencia.yml"
    prefix:   /
    type: rest 
```

这是我的#src/Gitek/RegistroBundle/Resources/config/routing_incidencia.yml

```
incidencia:
    type:     rest
    resource: Gitek\RegistroBundle\Controller\IncidenciaController
    name_prefix:  api_ 
```

最后，这是我在#app/config.yml 上对 fos_rest 的配置：

```
fos_rest:
    routing_loader:
        default_format: null
    view:
        default_engine: twig
        force_redirects:
            html: true
        formats:
            json: true
            xml: true
        templating_formats:
            html: true
        view_response_listener: 'force'
        failed_validation: HTTP_BAD_REQUEST
    exception:
        codes: ~
        messages: ~
    body_listener:
        decoders:
            json: fos_rest.decoder.json
            xml: fos_rest.decoder.xml
    format_listener:
        default_priorities: [json, html, '*/*']
        fallback_format: html
        prefer_extension: true
    service:
        router: router
        templating: templating
        serializer: serializer
        view_handler: fos_rest.view_handler.default 
```

任何帮助或线索？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-21T17:26:12.590

你的控制器类应该被命名`IncidenciaController`而不是`UsuarioController`

# c - 注意带有 R 代码的 C 函数名称

> ID：11143023
> 
> 赞同：4
> 
> 时间：2012-06-21T16:55:16.477
> 
> 标签：c, r

所以这里有点疯狂。

如果您有一些由 R 函数（作为共享对象）调用的 C 代码，请尝试将其添加到代码中

```
void warn() {

 int i; // just so the function has some work, but you could make it empty to, or do other stuff

} 
```

如果您随后调用`warn()`R 函数调用的 C 代码中的任何位置，则会出现段错误；

```
 *** caught segfault ***
 address 0xa, cause 'memory not mapped'
Traceback:
  1: .C("C_function_called_by_R", as.double(L), as.double(G), as.double(T), as.integer(nrow),     as.integer(ncolL), as.integer(ncolG), as.integer(ncolT),     as.integer(trios), as.integer(seed), as.double(pval), as.double(pval1),     as.double(pval2), as.double(pval3), as.double(pval4), as.integer(ntest),     as.integer(maxit), as.integer(threads), as.integer(quietly))
  2: package_name::R_function(L, G, T, trios)
  3: func()
  4: system.time(func())
  5: doTryCatch(return(expr), name, parentenv, handler)
  6: tryCatchOne(expr, names, parentenv, handlers[[1L]])
  7: tryCatchList(expr, classes, parentenv, handlers)
  8: tryCatch(expr, error = function(e) {    call <- conditionCall(e)    if (!is.null(call)) {        if (identical(call[[1L]], quote(doTryCatch)))             call <- sys.call(-4L)        dcall <- deparse(call)[1L]        prefix <- paste("Error in", dcall, ": ")        LONG <- 75L        msg <- conditionMessage(e)        sm <- strsplit(msg, "\n")[[1L]]        w <- 14L + nchar(dcall, type = "w") + nchar(sm[1L], type = "w")        if (is.na(w))             w <- 14L + nchar(dcall, type = "b") + nchar(sm[1L],                 type = "b")        if (w > LONG)             prefix <- paste(prefix, "\n  ", sep = "")    }    else prefix <- "Error : "    msg <- paste(prefix, conditionMessage(e), "\n", sep = "")    .Internal(seterrmessage(msg[1L]))    if (!silent && identical(getOption("show.error.messages"),         TRUE)) {        cat(msg, file = stderr())        .Internal(printDeferredWarnings())    }    invisible(structure(msg, class = "try-error", condition = e))})
  9: try(system.time(func()))
 10: .executeTestCase(funcName, envir = sandbox, setUpFunc = .setUp,     tearDownFunc = .tearDown)
 11: .sourceTestFile(testFile, testSuite$testFuncRegexp)
 12: runTestSuite(testSuite)
 aborting ...
 Segmentation fault (core dumped)
 (END) 
```

不用说，如果您从 C 或 C++ 包装器而不是 R 函数调用相同的函数，则代码运行良好。如果您重命名`warn()`它也可以正常工作。

有任何想法吗？这是受保护的名称/符号吗？有这样的名字列表吗？我在 Ubuntu 12.01（i686-pc-linux-gnu（32 位））上使用 R 版本 2.14.1。C 代码使用 GNU GCC 4.6.3 编译。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-21T19:23:38.200

这似乎是一个非常有趣的问题。这是我的最小示例，在`test.c`我拥有的文件中

```
void warn() {}
void my_fun() { warn(); } 
```

我编译它然后运行

```
$ R CMD SHLIB test.c
$ R -e "dyn.load('test.so'); .C('my_fun')" 
```

使用我的 linux gcc 4.6.3 版，R 输出为

```
> dyn.load('test.so'); .C('my_fun')
R: Success
list() 
```

来自`warn`libc 中定义的函数的“R: Success”（参见`man warn`err.h 中定义）。发生的情况是R理所当然地加载了几个动态库，然后按照指示加载了test.so。当调用 my_fun 时，动态链接器解析`warn`，但解析规则是*全局*搜索`warn`符号，而不仅仅是在 test.so 中。我真的不知道全局搜索规则是什么，也许是按照打开 .so 的顺序，但无论如何，分辨率都不是我所期望的。

什么是要做？指定

```
static void warn() {} 
```

在编译时强制解析，当创建 .o 时，从而避免问题。`warn`例如，如果在一个文件 (utilities.c) 和另一个文件中定义，这将不起作用`my_fun`。在 Linux 上`dlopen`（用于加载共享对象的函数）可以提供一个标志`RTLD_DEEPBIND`，该标志在全局之前在本地进行符号解析，但是（a）R 不使用`dlopen`这种方式，并且（b）有[几个](http://smilax.org/135/dsohowto.pdf)（参见第 9 页）保留用这种方法。据我所知，最好的做法是尽可能使用`static`，并仔细命名函数以避免名称冲突。后者并不像看起来那么糟糕，因为 R 加载包共享对象，因此包符号本身不会添加到全局名称空间（参见`?dyn.load`和`local`论点，还请注意特定于操作系统的警告）。

我有兴趣听到更强大的“最佳实践”。

# serial-port - 如何发送/接收串行通信

> ID：11143024
> 
> 赞同：1
> 
> 时间：2012-06-21T16:55:17.320
> 
> 标签：serial-port, arduino, serial-communication

如何通过 Java 或 Python 的串行通信发送字符串？我有一个非常小的 arduino 程序，它将接收一个 CSV 整数字符串，每个整数控制不同的继电器（我从他们的例子中改编了它）。

我刚得到一个 Arduino，我正在尝试用它来远程打开和关闭继电器。我有它打开和关闭继电器，没问题。但就使用串行通信而言，我真的不知道从哪里开始。

我有一个可以连接的蓝牙加密狗，但是一旦我这样做了，我就迷路了。

此外，这是我第一次使用串行通信，也是我第一次使用 Arduino。因此，如果我对我所问的一些事情完全不满意，我很抱歉。我所知道的只是我从谷歌那里学到的东西。

非常感谢你

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-23T21:57:45.123

您可以使用任何 Java 或 Python 串行端口类和方法。但是，您需要注意一件事。

较新的 arduino 具有称为 AutoReset 的功能。这是通过使用电容器等将来自串行端口的 DTR 信号连接到芯片上的复位线来实现的。IDE 使用它来重置板以激活引导加载程序并启动将代码上传到 arduino。IDE 中的串行监视器知道这一点，并且在与设备通信时不会切换 DTR 线（除非它最初连接时）。

有几种方法可以击败此功能，您可以[在此处阅读有关它们的信息](http://www.arduino.cc/playground/Main/DisablingAutoResetOnSerialConnection)。

至于实际与设备通信，有几个关于 Java 和 Python 串行通信的教程。

[Pyserial](http://pyserial.sourceforge.net/)包括在打开端口时不使用 DTR 行的选项。

这是[一个](http://silveiraneto.net/2009/03/01/arduino-and-java/)解释如何使用 RXTX（Java 库）与 Arduino 通信的网站

祝你好运。

# jquery - node.js“回答问题”：向其他连接的客户端广播

> ID：11143025
> 
> 赞同：0
> 
> 时间：2012-06-21T16:55:17.777
> 
> 标签：jquery, json, node.js, real-time, javascript-framework

我试着：

在客户端上为“answer”事件构建一个监听，它将向我们发送问题和答案，我们希望将其广播给其他连接的客户端。

应用程序.js =

```
var express = require('express');
var app = express.createServer();
var socket = require('socket.io');
var io = socket.listen(app);

io.sockets.on('connection', function(client) {
    console.log("Client connected...");

    // listen for answers here

   client.on('question', function(question) {
       client.get('question_asked', function(asked) {
           if(!asked) {
               client.set('question_asked', true);
               client.broadcast.emit('question', question);
           }
       });
   });
}); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-21T19:42:54.350

您可以使用[hook.io](https://github.com/hookio)与所有客户交谈。 [这](https://github.com/hookio/hook.js)可能是一个很好的起点。

# go - Go 中的条件编译

> ID：11143026
> 
> 赞同：6
> 
> 时间：2012-06-21T16:55:21.810
> 
> 标签：go, cgo

我正在尝试使用[CGo](http://golang.org/cmd/cgo/)为[ENet编写一个 Go](https://github.com/lsalzman/enet)[包装器](https://github.com/deft-code/go-enet)。

当我尝试在 Mac 上编译包装器时，库较旧并且界面略有不同。99% 的代码是相同的，只是需要更改几个 C 调用。

在 Go 中处理此类问题的最佳实践是什么？
有没有办法进行条件编译或条件导入？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-06-21T17:55:31.273

将特定于平台的东西分离到一个单独的文件中，例如 stuff.go

现在将 stuff.go 替换为不同平台的版本，例如 stuff_darwin.go（适用于 Mac）、stuff_windows.go、stuff_linux.go 等。

如果一个文件有这样的后缀，go 命令将只在指定的平台上编译它。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-21T17:49:54.723

Go 没有条件编译或条件导入。处理 C 代码中的类型差异。

[[Go] 作者是否反对预处理？](https://groups.google.com/group/golang-nuts/msg/055c255e18d9b963)

# java - Java执行需要su的Linux命令？

> ID：11143027
> 
> 赞同：0
> 
> 时间：2012-06-21T16:55:23.653
> 
> 标签：java, linux, debian, sudo, su

使用 Java 运行需要“su”的 Linux 命令的最佳方式是什么？我希望它非常可靠，至于安全性，我不太在意系统不是生产服务器。除了我自己，没有人连接到这台机器。我考虑过以 root 身份登录，这样我就不必处理 su 命令，并且默认情况下它是禁用的。我正在使用 Debian 6。

唯一的一点是，我的要求之一是程序应该在普通用户登录后启动，无需任何进一步的用户输入。我会为普通用户设置自动登录，当计算机打开时，在普通用户登录后，我希望 Java 程序在没有任何用户输入的情况下以 sudo、su 运行。那可能吗？

请告诉我一个简单可靠的解决方案。

问候

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-21T16:58:15.617

改为使用`sudo`。可以将其配置为允许在不输入密码的情况下运行特定命令。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-21T17:26:38.740

对于运行需要 root 访问权限的程序，它们应该使用`sudo`. 将要求用户输入密码。如上一个答案中所述，`sudo`可用于将命令配置为以 root 身份运行而无需输入密码。尝试查看手册页以`sudo`获取有关此的更多信息。

如果要在系统启动时运行程序，可以编写一个 bash 脚本`gksudo java -jar path`在用户登录时运行该命令。这将通过一个对话框提示用户输入密码。

我还建议在程序开始时进行系统调用以确保 root 访问。

# c# - 仅使用类型的类型制作编译的构造函数表达式

> ID：11143029
> 
> 赞同：5
> 
> 时间：2012-06-21T16:55:29.400
> 
> 标签：c#, reflection, delegates, lambda

我一直在玩，部分地重新发明轮子，这样我就可以理解正确的轮子是如何旋转的。

考虑这个用于编译和返回类型的默认构造函数的泛型函数。

```
public static Func<TConcrete> Creator<TConcrete>()
{
    // All checking removed for brevity
    var ctor = typeof(TConcrete).GetConstructor(new Type[0]);
    var lambda = Expression.Lambda<Func<TConcrete>>(Expression.New(ctor));
    return lambda.Compile();
} 
```

我相信这会给我返回一个很好的类型化委托，我可以用它来实例化传递的类型。

现在考虑，我想要一个可以为一组不同类型执行此操作的函数，我该怎么做？我在想...

```
public static IEnumerable<Delegate> Creators(IEnumerable<Type> types)
{
    foreach (var type in types)
    {
        var ctor = type.GetConstructor(new Type[0]);
        var lamda = Expression.Lambda<Func<????>>(Expression.New(ctor));
        yield return lambda.Compile();
    }
} 
```

正如你所看到的，`????`这就是我被卡住的地方。有没有办法做到这一点，还是我的方法有缺陷？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-21T16:59:03.907

您可以使用不同的[`Expression.Lambda`](http://msdn.microsoft.com/en-us/library/system.linq.expressions.expression.lambda.aspx)调用，它将委托类型作为`Type`：

```
Type delegateType = typeof(Func<>).MakeGenericType(type);
var lambda = Expression.Lambda(delegateType, Expression.New(ctor));
yield return lambda.Compile(); 
```

请注意，这种重载`Lambda`返回的是非泛型[`LambdaExpression`](http://msdn.microsoft.com/en-us/library/system.linq.expressions.lambdaexpression.aspx)类型而不是`Expression<TDelegate>`- 但它仍然公开了一个[`Compile`](http://msdn.microsoft.com/en-us/library/bb356928.aspx)返回的方法`Delegate`，这就是您在这里所需要的。基本上，它只是避免了您从“已知委托类型”代码中受益的一些编译时类型检查。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-06-21T16:57:34.870

结合使用非泛型重载`MakeGenericType`：

```
var lamda = Expression.Lambda<Func<????>>(Expression.New(ctor)); 
```

应该变成：

```
var funcType = typeof(Func<>).MakeGenericType(type);
var lamda = Expression.Lambda(funcType, Expression.New(ctor)); 
```

# .net - .NET setup.exe 项目和提示重启 msi 标志

> ID：11143032
> 
> 赞同：0
> 
> 时间：2012-06-21T16:55:47.397
> 
> 标签：.net, windows-installer, setup-project

我有一个 setup.exe 项目，我使用以下命令行参数运行该项目以进行安装：

> /被动 /promptrestart CMDCODE=InstallComplete

我也试过这个：

```
/quiet /promptrestart CMDCODE=InstallComplete 
```

在这两种情况下，如果需要重新启动，用户不会被询问甚至警告，它只是在安装完成后启动。

我怀疑这可能是因为 promptrestart 是后来添加的，而 MS 在调用 MSI 时从未更新 setup.exe 以传递它。任何人都可以确认或否认这一点吗？该选项对您有用吗？我应该使用其他选项吗？

CMDCODE= 部分只是我们内部使用的东西。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-21T19:16:11.413

到目前为止只在 XP 上进行了测试，但它似乎改变了这个工作：

> /qb /promptrestart CMDCODE=InstallComplete

因此将 /quiet 或 /passive 更改为 /qb。我真的不需要“始终被动”安装，事实上我希望它会提示是否已经安装了较新的版本，或者对于任何错误，我只是不希望它在正常安装下询问用户任何问题（没有重新启动，没有错误）。

# android - android - 活动完成后如何显示对话框

> ID：11143033
> 
> 赞同：9
> 
> 时间：2012-06-21T16:55:53.917
> 
> 标签：android

假设我们有两个活动，Activity1 和 Activity2。

在 Activity1 的 onClick() 方法中，如果按下某个按钮，我们将调用启动 Activity 2：

```
Intent myIntent = new Intent(Activity1.this, Activity2.class);
Activity1.this.startActivity(myIntent); 
```

在 Activity2 中调用 finish() 并恢复 Activity1 后，一旦恢复，我需要在 Activity1 中显示一个对话框。

之前，我只是在 Activity1 的 onClick() 方法的同一块中调用了 showDialog(id)：

```
public void onClick(View v) {
     if(v == addHole){
     //...
     Intent myIntent = new Intent(Activity1.this, Activity2.class);
     Activity1.this.startActivity(myIntent);
     showDialog(END_DIALOG_ID);
     }
} 
```

问题是，Activity1 恢复后，END_DIALOG_ID 对应的对话框不可见，但屏幕变暗且无响应（好像对话框存在），直到按下返回键。

我曾尝试将 showDialog() 调用放在 Activity1 的 onResume() 和 onRestart() 方法中，但它们都会使程序崩溃。

我还尝试在 Activity2 中创建 AsyncTask 方法，并在其 onPostExecute() 中调用 showDialog()，但该对话框在 Activity2 中不可见。

```
private class ShowDialogTask extends AsyncTask<Void, Void, Integer> {
    /** The system calls this to perform work in a worker thread and
     * delivers it the parameters given to AsyncTask.execute() */
    protected Integer doInBackground(Void... id) {
        //do nothing
        return END_DIALOG_ID;
    }

    /** The system calls this to perform work in the UI thread and delivers
     * the result from doInBackground() */
    protected void onPostExecute(Integer id) {
        super.onPostExecute(id);
        showDialog(id);

    }
} 
```

我现在正试图通过调用来实现这一点

```
Activity1.this.startActivityForResult(myIntent, END_DIALOG_REQUEST); 
```

使用来自 Activity1 的相应 setResult() 和 onActivityResult() 方法，但似乎应该有更好的实践来实现这一点。我只需要在 Activity2 完成时显示一个对话框。

感谢您的任何帮助，您可以提供。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-06-21T17:01:13.543

就像你建议的那样，`startActivityForResult`开始时打电话`Activity2`。然后，覆盖`onActivityResult`并检查`RESULT_OK`，然后显示您的对话框。对于做你想做的事情来说，这是一种完全可以接受的做法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-21T17:09:51.517

您可以使用 onResume 方法（如果您没有从活动 2 中查看任何内容）

```
@Override
public void onResume(){
    super.onResume();
    //do something
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-05-07T09:42:42.710

我必须返回根活动 - MainActivity，可能会关闭几个活动，然后显示对话框。所以我选择了另一种方式。

```
MyDialog {
    public static synchronized void planToShowDialog(String info) {
        if (info != null) {
            saveInfoToPreferences(info);
        }
    }

    public static synchronized void showDialogIfNecessary(Context context) {
        String info = readInfoFromPreferences(); 
        if (info != null) {
            saveInfoToPreferences(null); // Show dialog once for given info.
            new MyDialog(context, info).show();
        }
    }

    private static String readInfoFromPreferences() {
        //...
    }

    private static void saveInfoToPreferences(String info) {
        //...
    }
} 
```

我从 MainActivity.onPostResume() 方法调用 MyDialog.showDialogIfNecessary() 。

# image - 使用scrapy从多个网址下载谷歌图片

> ID：11143037
> 
> 赞同：1
> 
> 时间：2012-06-21T16:56:08.727
> 
> 标签：image, url, scrapy

我正在尝试通过谷歌图片搜索从多个网址下载图片。

但是，我只想要每个 url 中的 15 张图片。

```
class imageSpider(BaseSpider):
    name = "image"
    start_urls = [
        'https://google.com/search?q=simpsons&tbm=isch'
        'https://google.com/search?q=futurama&tbm=isch'
        ]

def parse(self,response):
    hxs = HtmlXPathSelector(response)
    items = []
    images = hxs.select("//div[@id='ires']//div//a[@href]")
    count = 0
    for image in images:
        count += 1
        item = ImageItem()
        image_url = image.select(".//img[@src]")[0].extract()
        import urlparse
        image_absolute_url = urlparse.urljoin(response.url, image_url.strip())
        index = image_absolute_url.index("src")
        changedUrl = image_absolute_url[index+5:len(image_absolute_url)-2]
        item['image_urls'] = [changedUrl]
        index1 = site['url'].index("search?q=")
        index2 = site['url'].index("&tbm=isch")
        imageName = site['url'][index1+9:index2]
        download(changedUrl,imageName + str(count)+".png")
        items.append(item)
        if count == 15:
            break
    return items 
```

下载功能下载图像（我有代码。这不是问题）。

问题是，当我中断时，它会在第一个 url 处停止，并且永远不会继续到下一个 url。我怎样才能让它为第一个网址下载 15 张图片，然后为第二个网址下载 15 张图片。我正在使用 break 因为每个 google 图片页面中大约有 1000 张图片，我不想要那么多。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-22T00:59:23.280

问题不在于`break`陈述。您在 . 中遗漏了一个逗号`start_urls`。

它应该是这样的：

```
start_urls = [
    'http://google.com/search?q=simpsons&tbm=isch',
    'http://google.com/search?q=futurama&tbm=isch'
] 
```

# c# - 是否列出 .Last() 枚举集合？

> ID：11143042
> 
> 赞同：10
> 
> 时间：2012-06-21T16:56:25.617
> 
> 标签：c#, .net, list, collections, linq-to-objects

考虑到 a 的边界[`List`](http://msdn.microsoft.com/en-us/library/6sh2ey19.aspx)是已知的，是否`.Last()`枚举集合？

我问这个是因为[文档](http://msdn.microsoft.com/en-us/library/bb358775.aspx)说它是由`Enumerable`（在这种情况下它*需要*枚举集合）定义的

如果它*确实*枚举了集合，那么我可以简单地通过索引访问最后一个元素（正如我们所知道的`.Count`a `List<T>`）但是必须这样做似乎很愚蠢......

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-06-21T16:59:50.047

如果集合是一个`IEnumerable<T>`而不是一个`IList<T>`（使用数组或列表，将使用索引），它会枚举集合。

`Enumerable.Last`以以下方式实现（ILSpy）：

```
public static TSource Last<TSource>(this IEnumerable<TSource> source)
{
    if (source == null)
    {
        throw Error.ArgumentNull("source");
    }
    IList<TSource> list = source as IList<TSource>;
    if (list != null)
    {
        int count = list.Count;
        if (count > 0)
        {
            return list[count - 1];
        }
    }
    else
    {
        using (IEnumerator<TSource> enumerator = source.GetEnumerator())
        {
            if (enumerator.MoveNext())
            {
                TSource current;
                do
                {
                    current = enumerator.Current;
                }
                while (enumerator.MoveNext());
                return current;
            }
        }
    }
    throw Error.NoElements();
} 
```

# javascript - 如何让 Adob e Acrobat 中的 JavaScript 休眠

> ID：11143048
> 
> 赞同：0
> 
> 时间：2012-06-21T16:56:54.167
> 
> 标签：javascript, sleep, acrobat

我正在尝试让 JavaScript 在 acrobat 中休眠。我在跑

```
this.saveAs(saveFileName); 
```

保存文件需要时间，但 JavaScript 会继续运行并破坏以后的代码。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-21T23:57:57.400

问题是保存文件时，以后的代码看不到文件完全下载。我所要做的就是关闭文件并重新打开文件，之后的代码运行正常。

# php - 如何使用php检查用户是否在线与另一个会话

> ID：11143050
> 
> 赞同：0
> 
> 时间：2012-06-21T16:56:56.117
> 
> 标签：php, session, cookies, login, login-control

我有一个跨越多个网络的系统。

有一个用户表：

```
Users:
ID
Name
Sessionhandle 
```

*   当用户登录时，会生成一个会话句柄，放在表中并设置为 cookie。

*   当用户注销时，会话句柄 cookie 被删除并且表中的字段被设置为空。

这适用于单个网络，现在我正在使用不同的前端和域扩展我的社区。现在用户可以在一个前端注销，但在其他前端保持登录状态。

我想做的是：

*   更改会话句柄，一旦用户在用户 dable 中使用 sessionhandle = null 登录。

*   一旦用户注销（并且未使用不同的前端/域登录），将表中的字段设置为 null。

我的问题是：当用户点击“退出”时，我怎么知道他是否仍然在线使用不同的前端？有没有办法在服务器上搜索任何持有他的会话句柄的 cookie？解决这个问题的最佳方法是什么？

提前致谢！

# python - PyGTK：需要帮助一起滚动多个 TextView

> ID：11143053
> 
> 赞同：3
> 
> 时间：2012-06-21T16:57:05.073
> 
> 标签：python, gtk, pygtk

我正在尝试使用 PyGTK 编写一个文本查看器小部件，它在主查看窗口旁边显示行号。当然，我希望行号和主窗口彼此同步滚动。不过，我不知道如何让它工作。现在我正在这样做。TextViewer 是 HBox 的子类，它创建两个 TextView 并将它们打包到自身的属性名称 linenums 和 mainview 下。

```
self.textviewer = TextViewer.TextViewer(self.toplevel)

sw = gtk.ScrolledWindow()
sw.set_vadjustment(self.textviewer.mainview.get_vadjustment())
sw.set_hadjustment(self.textviewer.mainview.get_hadjustment())

sw.add_with_viewport(self.textviewer)

sw.set_policy(gtk.POLICY_AUTOMATIC, gtk.POLICY_AUTOMATIC) 
```

如果我取出两条 set_Xadjustment 行，则嵌入的 TextViews 的 scroll_to_mark 函数不起作用，这对我的应用程序来说是不可接受的。加入它们后，主文本窗口的滚动速度是行号窗口的两倍，如果我将 ScrolledWindow 的调整设置为 self.textviewer.linenums 的调整，反之亦然。我强烈怀疑这是一个错误。我还尝试自己设置视口并将其调整设置为其中一个 TextView 的调整，但 scroll_to_mark 函数再次停止工作。如何将两个 TextView 同步为一个滚动，以便对其中一个的任何滚动更改同样影响另一个？

编辑：这是我设置小部件的主应用程序中的代码。

```
self.textviewer = TextViewer.TextViewer(self.toplevel)

sw = gtk.ScrolledWindow()
#These are the lines that toggle between the two problems when (un)commented
sw.set_vadjustment(self.textviewer.mainview.get_vadjustment())
sw.set_hadjustment(self.textviewer.mainview.get_hadjustment())

sw.add_with_viewport(self.textviewer)

sw.set_policy(gtk.POLICY_AUTOMATIC, gtk.POLICY_AUTOMATIC) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-21T18:00:07.833

我很难理解你是如何将这两个`gtk.TextView`s 打包在`HBox`. 它们是否都包装在单独的包装中`gtk.ScrolledWindow`，然后包装在`HBox`其中，然后再包装到另一个`gtk.ScrolledWindow`中（您的帖子中提到的那个）？在我看来，这两个`gtk.TextView`s 都包含在`gtk.ScrolledWindow`您的`TextViewer`包装器小部件中。

如果是这种情况，一个简单的解决您的问题的方法，假设两个`gtk.TextView`s 的高度相同（因此行号与主视图对齐），我建议将它们简单地包装在您的`Hbox`without `ScrolledWindow`s 中。然后您可以使用上面的代码，添加它们，`ScrolledWindow`并且视口将两者一起移动，就好像它们是一个小部件一样。

如果这不是您的问题，您能否提供有关您的 TextViewer 包装器的更多信息，也许还有更多示例代码？

另外：您可能对[gtksourceview](http://www.pygtk.org/pygtksourceview/class-gtksourceview.html)感兴趣。使用 gtksourceview2 包，您可以获得 View 小部件的实例：

```
import gtksourceview2
view = gtksourceview2.View() 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-21T18:14:05.910

您可能想检查它是如何在 Meld 中实现的。特别是[filediff 代码](http://git.gnome.org/browse/meld/tree/meld/filediff.py)（在此处搜索搜索同步）。

# eclipse - 升级到 Eclipse 3.7 - IBM ClearCase 插件开始挂起连接到具有高 CPU 的 ClearCase

> ID：11143056
> 
> 赞同：2
> 
> 时间：2012-06-21T16:57:07.653
> 
> 标签：eclipse, eclipse-plugin, clearcase

使用相同的 Rational ClearCase SCM Adapter 7.6.0.v201105111445 在 Eclipse 3.5 中没有挂起

回答正在进行的问题：JDK 6、ClearCase、Windows XP 32 位。

# php - 将 Magento 安装移动到新服务器

> ID：11143060
> 
> 赞同：2
> 
> 时间：2012-06-21T16:57:21.920
> 
> 标签：php, mysql, magento, amazon-web-services

我已经尝试了几个小时来将我们的 Magento 安装从 dev 转移到 live。我在网上找到了多个链接，说要移动 Magento 安装，您需要`/app/etc/local.xml`使用新的 MySQL 凭据编辑和更新它，然后删除其中的内容`/var/cache/`（一些甚至建议删除整个`/var`文件夹。我还删除了`/var/session/`.我们的内容）服务器未缓存（没有 memcached、varnish 等）。我什至重新启动了 apache 以查看是否可以刷新任何可能正在运行的缓存。

所以问题是我们的 Magento 安装仍在尝试以某种方式连接到旧数据库。我们收到此错误：

```
SQLSTATE[28000] [1045] Access denied for user 'oldDBUsername'@'localhost' (using password: YES) 
```

如果有人对如何解决这个问题有任何想法，我还没有提到，将不胜感激。

编辑：

这是 Magento 还报告的堆栈跟踪：

```
Trace:
#0 fileroot/lib/Zend/Db/Adapter/Pdo/Mysql.php(96): Zend_Db_Adapter_Pdo_Abstract->_connect()
#1 fileroot/lib/Varien/Db/Adapter/Pdo/Mysql.php(300): Zend_Db_Adapter_Pdo_Mysql->_connect()
#2 fileroot/lib/Zend/Db/Adapter/Abstract.php(459): Varien_Db_Adapter_Pdo_Mysql->_connect()
#3 fileroot/lib/Zend/Db/Adapter/Pdo/Abstract.php(238): Zend_Db_Adapter_Abstract->query('SET NAMES utf8', Array)
#4 fileroot/lib/Varien/Db/Adapter/Pdo/Mysql.php(389): Zend_Db_Adapter_Pdo_Abstract->query('SET NAMES utf8', Array)
#5 fileroot/app/code/core/Mage/Core/Model/Resource.php(169): Varien_Db_Adapter_Pdo_Mysql->query('SET NAMES utf8')
#6 fileroot/app/code/core/Mage/Core/Model/Resource.php(110): Mage_Core_Model_Resource->_newConnection('pdo_mysql', Object(Mage_Core_Model_Config_Element))
#7 fileroot/app/code/core/Mage/Core/Model/Resource/Db/Abstract.php(320): Mage_Core_Model_Resource->getConnection('core_read')
#8 fileroot/app/code/core/Mage/Core/Model/Resource/Db/Abstract.php(335): Mage_Core_Model_Resource_Db_Abstract->_getConnection('read')
#9 fileroot/app/code/core/Mage/Core/Model/Resource/Cache.php(53): Mage_Core_Model_Resource_Db_Abstract->_getReadAdapter()
#10 fileroot/app/code/core/Mage/Core/Model/Cache.php(449): Mage_Core_Model_Resource_Cache->getAllOptions()
#11 fileroot/app/code/core/Mage/Core/Model/Cache.php(491): Mage_Core_Model_Cache->_initOptions()
#12 fileroot/app/code/core/Mage/Core/Model/App.php(1175): Mage_Core_Model_Cache->canUse('config')
#13 fileroot/app/code/core/Mage/Core/Model/Config.php(414): Mage_Core_Model_App->useCache('config')
#14 fileroot/app/code/core/Mage/Core/Model/Config.php(294): Mage_Core_Model_Config->_canUseCacheForInit()
#15 fileroot/app/code/core/Mage/Core/Model/App.php(408): Mage_Core_Model_Config->loadModulesCache()
#16 fileroot/app/code/core/Mage/Core/Model/App.php(338): Mage_Core_Model_App->_initModules()
#17 fileroot/app/Mage.php(640): Mage_Core_Model_App->run(Array)
#18 fileroot/index.php(80): Mage::run('', 'store')
#19 {main} 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-06-21T18:29:41.330

我想到了。

当我将 dev 安装带入生活时`local.xml`，`local_bk.xml`我发现 Magento 将尝试自动加载文件`/app/etc/`夹中的所有 xml 文件，因此它正在尝试加载我的备份文件，只要我将备份重命名为没有的东西以 .xml 结尾，它起作用了。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-21T17:46:24.713

安装 magento 时，您必须选择缓存和会话数据是存储在文件系统还是数据库中。

可能是local.xml中的下面这行，现在记不太清了。

```
<session_save><![CDATA[files]]></session_save> 
```

如果您使用的是数据库，那么它将数据存储在 core_cache 表中，可能在数据库中。

如果没有截断它们，请查看您的数据库缓存表是否为空。

您还需要在 core_config_data 中更新安全和不安全的基本 url

请参阅以下 SQL 进行更新

[http://www.magentocommerce.com/wiki/1_-_installation_and_configuration/update_site_url_in_core_config_data](http://www.magentocommerce.com/wiki/1_-_installation_and_configuration/update_site_url_in_core_config_data)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-21T17:22:02.010

正确的路径是

```
app/etc/local.xml 
```

代替：

```
etc/app/local.xml 
```

这能解决您的问题吗？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-21T19:33:29.627

对于将来遇到此问题的其他人，这里是 Magento wiki 上的一些文档。[http://www.magentocommerce.com/wiki/groups/227/moving_magento_to_another_server](http://www.magentocommerce.com/wiki/groups/227/moving_magento_to_another_server)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-09-15T02:14:00.003

你的回答救了我！我在这个问题上花了很多时间，只是偶然发现了这个答案。我通常复制和粘贴来搜索错误，所以我想提供更多实际错误，以便其他人受益。

我将我的 local.xml 文件命名为 local.bak，这就是我的错误所在。与工作中的 Magento 实例的所有文件进行比较仅产生额外的文件。

该错误使我相信 mySQL 可能是问题所在，但与此无关。也许有人可以发布日志或方法来显示实际使用的文件。我没有看到任何写入任何日志的通知。

这是更多错误，不包括任何特定于站点的错误：

```
"SQLSTATE[HY000] [1045] Access denied for user '*myuser*'@'localhost' (using password: YES) /lib/Zend/Db/Adapter/Pdo/Mysql.php(111): Zend_Db_Adapter_Pdo_Abstract->_connect() 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2018-02-22T11:36:30.373

在删除**中间**的 .xml 时更改我的**文件名**也对我有用：`app/etc/`

 **`local.xml.template`去`local.template`和`local.xml.additional` 去`local.additional`

谢谢@彼得。

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2012-06-21T17:30:20.907

在您的 magento 文件夹中，您需要像 Gershon 提到的那样编辑 app/etc/local.xml。

您还需要以 root 或 sudo 的身份删除 magento 创建的 magento 文件夹的 var/cache 中的所有文件和目录。**

# configuration - 让 CMake 在不包装脚本的情况下从源代码构建

> ID：11143062
> 
> 赞同：31
> 
> 时间：2012-06-21T16:57:23.690
> 
> 标签：configuration, cmake

我试图让 CMake 构建到一个目录“build”中，如`project/build`CMakeLists.txt 所在的目录`project/`。

我知道我可以做到：

```
mkdir build
cd build
cmake ../ 
```

但这很麻烦。我可以把它放在一个脚本中并调用它，但是向 CMake 提供不同的参数（比如 -G "MSYS Makefiles"）是不愉快的，或者我需要在每个平台上编辑这个文件。

最好我会`SET(CMAKE_OUTPUT_DIR build)`在主 CMakeLists.txt 中执行类似的操作。请告诉我这是可能的，如果可以，怎么做？或者其他一些可以轻松指定不同参数的源代码构建方法？

* * *

## 回答 #1

> 赞同：53
> 
> 时间：2012-06-21T18:05:20.553

CMake 3.13 或更高版本支持[命令行选项](https://cmake.org/cmake/help/latest/manual/cmake.1.html) `-S`并`-B`分别指定源和二进制目录。

```
cmake -S . -B build -G "MSYS Makefiles" 
```

这将`CMakeLists.txt`在当前文件夹中查找并在其中创建一个`build`文件夹（如果它尚不存在）。

对于旧版本的 CMake，您可以使用未记录的 CMake 选项`-H`并`-B`在调用时指定源和二进制目录`cmake`：

```
cmake -H. -Bbuild -G "MSYS Makefiles" 
```

请注意，选项和目录路径之间不能有空格字符。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2015-04-16T15:10:59.873

我最近发现的一个解决方案是将外源构建概念与 Makefile 包装器相结合。

在我的顶级 CMakeLists.txt 文件中，我包含以下内容以防止源内构建：

```
if ( ${CMAKE_SOURCE_DIR} STREQUAL ${CMAKE_BINARY_DIR} )
    message( FATAL_ERROR "In-source builds not allowed. Please make a new directory (called a build directory) and run CMake from there. You may need to remove CMakeCache.txt." )
endif() 
```

然后，我创建一个顶级 Makefile，并包括以下内容：

```
# -----------------------------------------------------------------------------
# CMake project wrapper Makefile ----------------------------------------------
# -----------------------------------------------------------------------------

SHELL := /bin/bash
RM    := rm -rf
MKDIR := mkdir -p

all: ./build/Makefile
    @ $(MAKE) -C build

./build/Makefile:
    @  ($(MKDIR) build > /dev/null)
    @  (cd build > /dev/null 2>&1 && cmake ..)

distclean:
    @  ($(MKDIR) build > /dev/null)
    @  (cd build > /dev/null 2>&1 && cmake .. > /dev/null 2>&1)
    @- $(MAKE) --silent -C build clean || true
    @- $(RM) ./build/Makefile
    @- $(RM) ./build/src
    @- $(RM) ./build/test
    @- $(RM) ./build/CMake*
    @- $(RM) ./build/cmake.*
    @- $(RM) ./build/*.cmake
    @- $(RM) ./build/*.txt

ifeq ($(findstring distclean,$(MAKECMDGOALS)),)
    $(MAKECMDGOALS): ./build/Makefile
    @ $(MAKE) -C build $(MAKECMDGOALS)
endif 
```

默认目标`all`通过键入`make`调用，并调用目标`./build/Makefile`。

目标做的第一件事`./build/Makefile`是使用 来创建`build`目录`$(MKDIR)`，它是`mkdir -p`. 该目录`build`是我们将执行我们的源代码外构建的地方。我们提供参数`-p`以确保`mkdir`不会因为试图创建可能已经存在的目录而对我们大喊大叫。

目标所做的第二件事`./build/Makefile`是将目录更改为`build`目录并调用`cmake`.

回到`all`目标，我们调用`$(MAKE) -C build`，其中`$(MAKE)`是为 自动生成的 Makefile 变量`make`。`make -C`在做任何事情之前更改目录。因此，使用`$(MAKE) -C build`相当于做`cd build; make`。

总而言之，用`make all`or调用这个 Makefile 包装器`make`相当于：

```
mkdir build
cd build
cmake ..
make 
```

目标`distclean`调用`cmake ..`, 然后`make -C build clean`, 最后从`build`目录中删除所有内容。我相信这正是您在问题中所要求的。

Makefile 的最后一部分评估用户提供的目标是否是`distclean`。`build`如果没有，它将在调用它之前将目录更改为。这非常强大，因为用户可以键入，例如，`make clean`Makefile 会将其转换为`cd build; make clean`.

总之，这个 Makefile 包装器与强制的源外构建 CMake 配置相结合，使用户永远不必与命令交互`cmake`。`build`此解决方案还提供了一种从目录中删除所有 CMake 输出文件的优雅方法。

PS 在 Makefile 中，我们使用前缀`@`来抑制 shell 命令的输出，并使用前缀`@-`来忽略 shell 命令的错误。当`rm`作为`distclean`目标的一部分使用时，如果文件不存在，该命令将返回错误（它们可能已经使用带有 的命令行被删除`rm -rf build`，或者它们从一开始就没有生成）。这个返回错误将强制我们的 Makefile 退出。我们使用前缀`@-`来防止这种情况。如果文件已经被删除是可以接受的；我们希望我们的 Makefile 继续运行并删除其余部分。

另一件需要注意的事情：如果您使用可变数量的 CMake 变量来构建项目，则此 Makefile 可能不起作用，例如，`cmake .. -DSOMEBUILDSUSETHIS:STRING="foo" -DSOMEOTHERBUILDSUSETHISTOO:STRING="bar"`. 此 Makefile 假定您以一致的方式调用 CMake，通过键入`cmake ..`或提供`cmake`一致数量的参数（可以包含在 Makefile 中）。

最后，信用到期。这个 Makefile 包装器改编自[C++ Application Project Template](http://code.google.com/p/cpp-project-template/)提供的 Makefile 。

这个答案最初发布[在这里](https://stackoverflow.com/questions/9680420/looking-for-a-cmake-clean-command-to-clear-up-cmake-output/29678706#29678706)。我认为它也适用于你的情况。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2016-05-31T08:35:30.033

根据之前的答案，我编写了以下模块，您可以包含该模块以强制执行源外构建。

```
set(DEFAULT_OUT_OF_SOURCE_FOLDER "cmake_output")

if (${CMAKE_SOURCE_DIR} STREQUAL ${CMAKE_BINARY_DIR})
    message(WARNING "In-source builds not allowed. CMake will now be run with arguments:
        cmake -H. -B${DEFAULT_OUT_OF_SOURCE_FOLDER}
")

    # Run CMake with out of source flag
    execute_process(
            COMMAND ${CMAKE_COMMAND} -H. -B${DEFAULT_OUT_OF_SOURCE_FOLDER}
            WORKING_DIRECTORY ${CMAKE_SOURCE_DIR})

    # Cause fatal error to stop the script from further execution
    message(FATAL_ERROR "CMake has been ran to create an out of source build.
This error prevents CMake from running an in-source build.")
endif () 
```

这行得通，但是我已经注意到两个缺点：

*   当用户懒惰并简单地运行`cmake .`时，他们总是会看到一个`FATAL_ERROR`. 我找不到另一种方法来阻止 CMake 执行任何其他操作并提前退出。
*   传递给原始调用的任何命令行参数`cmake`都不会传递给“源外构建调用”。

欢迎提出改进此模块的建议。

# soap - 我可以使用 Salesforce 会话 ID 获取 Salesforce 的实例特定服务器 URL 吗？

> ID：11143064
> 
> 赞同：0
> 
> 时间：2012-06-21T16:57:28.687
> 
> 标签：soap, salesforce

我正在尝试仅使用会话 ID 访问 Salesforce 的用户名（使用 SOAP 调用），我无权访问实例特定的服务器 URL。（我知道当你得到会话 id 时，你也会得到服务器 url，这是一个很长的故事，对于我的用例，我只有会话 id）。

任何反馈将不胜感激！

谢谢，尼特什

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-21T17:09:08.350

如果您唯一拥有的是 sessionId，那么我认为您无法找到它，您需要 sessionId + instanceUrl 或 sessionId + user id service Url。

# jquery - jquery选择器中的加号（+）是什么

> ID：11143085
> 
> 赞同：9
> 
> 时间：2012-06-21T16:58:30.937
> 
> 标签：jquery, jquery-selectors

我看到了这个选择器

```
 $( 'a + .firstSection a' ).live( 'click', function(){ 
```

在我的 js 文件中。这里 + 号的目的是什么？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-06-21T16:59:28.460

来自 jquery 文档：

> 选择与“下一个”匹配的所有下一个元素，这些元素紧跟在同级“上一个”之前。匹配第一个选择器旁边的元素的选择器。

阅读有关[`prev + next`](http://api.jquery.com/next-adjacent-Selector/)选择器的更多信息

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-21T17:01:19.490

1.  浏览[关于选择器的 jQuery 文档](http://api.jquery.com/category/selectors/)
2.  查找[下一个相邻选择器（“prev + next”）](http://api.jquery.com/next-adjacent-Selector/)
3.  阅读

    > 选择与“下一个”匹配的所有下一个元素，这些元素紧跟在同级“上一个”之前。

    *注意：即使您不理解这一点（以及示例！），现在您也可以搜索关键字！*

# python - 使用python解析C代码

> ID：11143095
> 
> 赞同：18
> 
> 时间：2012-06-21T16:59:14.700
> 
> 标签：python, parsing

我有一个巨大的 C 文件（约 100k 行），我需要能够解析它。主要是我需要能够从其定义中获取有关每个结构的各个字段的详细信息（例如结构中每个字段的字段名称和类型）。有没有一种好的（开源，我可以在我的代码中使用）方法来做到这一点？或者我应该为此编写自己的解析器。如果我必须自己写，有人可以建议一个好的起点吗？我以前从未使用过python。

谢谢

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-06-21T17:07:19.173

查看[此链接](http://wiki.python.org/moin/LanguageParsing)以获取可用于 Python 的解析工具的广泛列表。具体来说，对于解析 c 代码，请尝试[pycparser](https://github.com/eliben/pycparser)

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-06-21T17:11:35.880

做到这一点的正确方法几乎可以肯定是与现有编译器的前端接口，例如 gcc，然后使用中间表示，而不是尝试用任何语言创建自己的解析器。

但是，正如 Dhara 所建议的那样， [pycparser](https://github.com/eliben/pycparser)可能是一个很好的替代品，而且绝对比任何尝试自己动手的尝试都要好。

# .htaccess - 使用 htaccess 重写静态 URL 隐藏完整 URL 路径和 .html

> ID：11143100
> 
> 赞同：0
> 
> 时间：2012-06-21T16:59:26.863
> 
> 标签：.htaccess, url, redirect, path, rewrite

我的网址是 ukneurology.com，一个特定程序的网址是[http://ukneurology.com/html/clinicInfo/stroke.html](http://ukneurology.com/html/clinicInfo/stroke.html)。我想将第二个 URL 更改为 ukneurology.com/stroke 以及其他所有页面（它们都有不同的路径）。我见过很多动态页面，但我的页面 URL 都不像我在其他示例中看到的那样。我只需要一个 htaccess 文件，我可以在其中输入真实的 URL，然后输入我希望它在浏览器中显示的内容以及人们可以使用的内容。有我可以使用的模板吗？或者更好的是，一个可以为我做这件事的发电机？我什么也找不到！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-21T20:20:12.640

你可以使用这样的东西：`RewriteRule newPageName oldPageName [L]`注意：你必须`.`像这样在 newPageName 中转义：`\.`。NewPageName 和 oldPageName 不包括您的域。

在您的示例中，这是正确`RewriteRule stroke html/clinicInfo/stroke.html [L]` 的：如果用户尝试访问[http://ukneurology.com/stroke](http://ukneurology.com/stroke)，他将看到页面[http://ukneurology.com/html/clinicInfo/stroke.html](http://ukneurology.com/html/clinicInfo/stroke.html)没有重定向（因此URL 保持不变）。`[L]`避免满足任何其他 RewriteRule 。

如果您有特殊方案（例如`http://ukneurology.com/abc`=> `http://ukneurology.com/html/clinicInfo/abc.html`），您可以使用正则表达式来避免手动编写数千个 RewriteRules：`RewriteRule ([^/]+) html/clinicInfo/$1.html [L]`

# solr - 我正在关注 Nutch 教程，并收到“没有要获取的 URL”错误

> ID：11143103
> 
> 赞同：0
> 
> 时间：2012-06-21T16:59:32.033
> 
> 标签：solr, lucene, nutch

在此处遵循 Apache Nutch 教程：

如教程中所述，我已将 regex-urlfilter.txt 的最后一行设置为：

```
+^http://([a-z0-9]*\.)*nutch.apache.org/ 
```

我的 nutch-site.xml 文件仅包含以下行

```
<property>
 <name>http.agent.name</name>
 <value>My Nutch Spider</value>
</property> 
```

我的 seed.txt 文件是：

```
http://nutch.apache.org/ 
```

但是，当我爬行时

```
bin/nutch crawl urls -dir crawl -depth 3 -topN 5 
```

我收到“没有要获取的 URL”错误。有谁知道为什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-23T05:12:36.863

配置对我来说看起来不错。您已经在运行时/本地文件夹中进行了这些更改，对吗？seed.txt 将在 NUTCH_HOME/runtime/local/urls 文件夹中，而 regex-urlfilter.txt 和 nutch-site.xml 将在 NUTCH_HOME/runtime/local/conf 文件夹中

NUTCH_HOME 是安装目录

# html - 常规 HTML 中是否可以使用颜色渐变？

> ID：11143105
> 
> 赞同：1
> 
> 时间：2012-06-21T16:59:35.410
> 
> 标签：html

我正在寻找一种在表格中的单元格内获取颜色渐变的方法。我在网上找到了几个涉及 CSS 或 Javascript 的示例，但我试图远离这些。

例如，我发现了这个：

```
<table style="filter:progid:DXImageTransform.Microsoft.Gradient(endColorstr='#C0CFE2', startColorstr='#FFFFFF', gradientType='0');"> 
```

`Mircorosft" 有点担心兼容性。这是用于电子邮件营销，所以它需要尽可能简单，因为电子邮件客户端在呈现 html 方面相当有限。有什么建议吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-21T17:04:14.843

电子邮件客户端在呈现 HTML 和 CSS 方面是最差的，所以尽量做到简约。CSS 渐变在 90% 的客户端中不起作用，因此请避免使用它。

最好的解决方案可能是放置一个纯色背景颜色（因此它将在加载图像之前显示，如果已加载）并添加背景图像。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-21T17:04:22.597

不，没有适用于电子邮件客户端的通用解决方案。您最好的选择是使用预先生成的背景图像，但现在大多数客户端默认阻止图像

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-21T17:02:48.227

我会放背景图片。这将确保电子邮件客户端会显示它。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-21T17:00:55.773

查看 CSS3 渐变。网上有很多生成器可供试用，例如这个。[http://gradients.glrzad.com/](http://gradients.glrzad.com/)

在浏览器兼容性方面，此表将向您展示方式：

[http://caniuse.com/#feat=css-gradients](http://caniuse.com/#feat=css-gradients)

# php - 使用 php curl 将抓取的数据插入 MySQL

> ID：11143108
> 
> 赞同：0
> 
> 时间：2012-06-21T16:59:41.607
> 
> 标签：php, mysql, curl, insert, screen-scraping

最近几天我一直在研究这个脚本，似乎找不到将数据插入 MySQL 的方法。我是 PHP/MYSQL 的初学者，之前只写过几个简单的脚本。我能够回显抓取的数据并且没有收到错误消息，但是当我检查 phpmyadmin 时，查询不起作用（结果没有输入到数据库中）。

这是我一直在处理的代码

```
require ("mysqli_connect.php"); 
include('../simple_html_dom.php');

ini_set('user_agent', 
  'Mozilla/5.0 (Windows; U; Windows NT 6.0; en-GB; rv:1.9.0.3) Gecko/2008092417 Firefox/3.0.3');

// get DOM from URL or file
$html = file_get_html('http://www.asos.com/Women/Jeans/Cat/pgecategory.aspx?cid=3630&via=lhn');
// find all images

foreach($html->find('#items') as $a)       
    echo $a->innertext .'<br>';

foreach($html->find('span.price') as $p)
    echo $p->innertext .',';    

$q = "INSERT INTO jeans (`image`, `price`) VALUES ('$a', '$p')";
$r = @mysqli_query ($dbc, $q) or die ("Update query failed : " . mysql_error());;  //Run the Query. 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-21T17:03:59.560

在您的示例代码中， $a 和 $p 是对象，请尝试以下操作：

```
$a = '';
foreach($html->find('#items') as $item) {
    $a.= $item->innertext .'<br>';
}

$p = '';
foreach($html->find('span.price') as $price) {
    $p.= $price->innertext.',';    
} 
```

接下来，从@mysqli_query 中删除@，尽量不要使用它，而是尝试正确地捕获/处理错误。

接下来，请花几分钟时间研究参数化查询和 PDO，不要接受未知输入（至少来自第 3 方）并将它们直接注入到您的 sql 中：

```
$q = "INSERT INTO jeans (`image`, `price`) VALUES ('$a', '$p')"; 
```

即：不要那样做^

最后，您可能想要验证 get 的响应。

希望有帮助！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-21T17:06:39.053

您通过在前面加上 @ 来抑制错误`mysqli_query`

尝试改变这个：

```
$q = "INSERT INTO jeans ('image', 'price') VALUES ('$a', '$p')";
mysqli_query ($dbc, $q) or die ("Update query failed : " . mysql_error());;  //Run the Query. 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-21T18:00:54.650

我想我知道出了什么问题。

如果你只是使用

```
echo file_get_contents("http://www.asos.com/Women/Jeans/Cat/pgecategory.aspx?cid=3630"); 
```

（或者只是 asos.com，没关系），你会注意到你总会回来的：

> 抱歉，我们找不到该页面或出现问题...
> 
> 返回或在这里尝试：
> 
> 女性男性家庭服务台

因为您指定的所有元素都不在此页面上，所以您的代码不会返回任何内容。

**我的猜测是 asos.com 会阻止从他们的网站上进行抓取。**

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-25T00:40:38.570

请记住使用 mysql_real_escape_string 函数以避免保存内容的麻烦。下面的例子。

```
$query2 = sprintf("INSERT INTO jeans(image, price)  
                 VALUES ('%s','%s')",mysql_real_escape_string($a),
                                     mysql_real_escape_string($p))
mysql_query($query2) or die(mysql_error()."<br />".$query2); 
```

# c++ - valarray 是否具有连续的内存对齐？

> ID：11143109
> 
> 赞同：7
> 
> 时间：2012-06-21T16:59:46.350
> 
> 标签：c++, arrays, stl, memory-alignment

是否`valarray`有连续的内存对齐？

我想将一个 valarray 传递给一个函数（来自 IPPS），它只需要指针，通过传递`&myValarray[0]`. 但因此我应该确定，valarray 的内存对齐是连续的。

谢谢！

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-06-21T17:05:35.410

假设您要询问是否保证 valarray 管理的内存是*连续的*，那么答案是肯定的，至少如果对象不是`const`（C++03，§26.3.2.3/3 或 C++11， §26.6.2.4/2）：

> 对于所有 size_t i 和 size_t j ，表达式 &a[i+j] == &a[i] + j 的计算结果为真，使得 i+j 小于非常数数组 a 的长度。

# nhibernate - nHibernate多对多没有获取检索对象上的子对象列表

> ID：11143111
> 
> 赞同：0
> 
> 时间：2012-06-21T16:59:58.553
> 
> 标签：nhibernate, many-to-many

```
 // load the client and any many to one relationships
        var clientRootQuery = session.QueryOver(() => clientAlias);
        clientRootQuery.Left.JoinAlias(() => clientAlias.Person, () => personAlias)
        .Left.JoinAlias(() => personAlias.SexType, () => sexTypeAlias)
        .Left.JoinAlias(() => personAlias.EyeColorType, () => eyeColorTypeAlias)
        .Left.JoinAlias(() => clientAlias.Organization, () => organizationAlias)
        .Left.JoinAlias(() => clientAlias.ClientStatusType, () => clientStatusTypeAlias)
        .Left.JoinAlias(() => clientAlias.Notes, () => noteAlias)
        .Left.JoinAlias(() => noteAlias.Comments, () => commentAlias)
        .Where(() => clientAlias.Id == clientId)
        .Future<Client>();

        // load the note collection into the nhibernate session 
        // todo ******************** this doesn't work.  nhibernate is still firing off queries in the adapter fill method rather than using the values pulled here.
        var notes = session.QueryOver(() => clientAlias)
        .Left.JoinAlias(() => clientAlias.Notes, () => noteAlias)
        .Left.JoinAlias(() => noteAlias.Comments, () => commentAlias)
        .Where(() => clientAlias.Id == clientId)
        .Future<Client>();

return clientRootQuery.Take(1).SingleOrDefault(); 
```

这不会返回客户端对象上的许多地址，也不会返回许多注释。这应该有效。有一个客户有很多笔记和很多地址。

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-25T14:04:38.120

clientAddresses 未初始化的原因是因为您在它们上设置了过滤器，因此 NHibernate 假定并非所有 clientAddresses 都已加载以完全初始化集合。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-25T14:09:55.937

```
var clientRootQuery = session.QueryOver(() => clientAlias)
        .Left.JoinAlias(() => clientAlias.Person, () => personAlias)
        .Left.JoinAlias(() => personAlias.SexType, () => sexTypeAlias)
        .Left.JoinAlias(() => personAlias.EyeColorType, () => eyeColorTypeAlias)
        .Left.JoinAlias(() => clientAlias.Organization, () => organizationAlias)
        .Left.JoinAlias(() => clientAlias.ClientStatusType, () => clientStatusTypeAlias)
        .Where(() => clientAlias.Id == clientId)
        .Future();

 var notes = session.QueryOver(() => clientAlias)
        .Left.JoinAlias(() => clientAlias.Notes, () => noteAlias)
        .Where(() => noteAlias.Client.Id == clientId)
        .Future();

var list = clientRootQuery.ToList();
        return list.FirstOrDefault(); 
```

它必须是左连接。

# sqlite - SQLite 日期比较奇怪

> ID：11143113
> 
> 赞同：1
> 
> 时间：2012-06-21T17:00:17.650
> 
> 标签：sqlite, datetime, date, compare

我将日期作为字符串存储在我的数据库中，格式如下：

```
YYYY-MM-DD HH:MM 
```

在我的数据库中，我有行（所有列都是字符串）：

```
 COL1        |     COL2
----------------------------------
'2012-06-21 18:53' |   'item1'
'2012-06-21 18:54' |   'item2'
'2012-06-21 18:55' |   'item3' 
```

现在我想比较这些存储的日期（嗯，字符串），这很奇怪：

这个查询

```
select * 
  from MyTable 
  where col1 > Datetime('2012-06-21 18:53') 
```

返回 2 行（除第一行之外的所有行） - 这是正确的。

但是这个查询

```
select * 
      from MyTable 
      where col1 >= Datetime('2012-06-21 18:53') 
```

也只返回 2 行，但它应该返回所有 3 行，就像我使用`>=`的那样，而不是`>`.

我做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-21T17:09:50.970

```
sqlite> SELECT datetime('2012-06-21 18:53');
2012-06-21 18:53:00 
```

datetime() 返回格式与数据库字段不同的字符串。您可以只使用字符串作为 WHERE，例如

```
select * 
      from MyTable 
      where col1 >= '2012-06-21 18:53' 
```

# c# - 这个 Null 异常是如何可能的。需要帮助解释调用堆栈

> ID：11143116
> 
> 赞同：2
> 
> 时间：2012-06-21T17:00:27.450
> 
> 标签：c#, .net, wcf, nullpointerexception

在我的 REST WCF 服务中，我在 WCF 堆栈级别（`IErrorHandler`）上记录所有异常

这是我的代码：

```
public void PostPositions(List<Position> positions)
{
    if (!this.ValidateRequest()) return;
    foreach (var position in positions)
    { 
```

我得到例外：

> 你调用的对象是空的。
> 
> 在C:\CodeWorkspace\ClientServerCode\Web.Services\Rest\MobileService.cs: SyncInvokePostPositions(Object , Object[] , Object[] ) 中的 Web.Services.MobileService.PostPositions(List`1 个位置)中的第 1170 行。 ServiceModel.Dispatcher.SyncMethodInvoker.Invoke（对象实例，对象 [] 输入，对象 [] 和输出）

我的代码中的第 1170 行是`if (!this.ValidateRequest()) return;`

这是什么意思？没有静态方法，我使用类的实例并且`this`肯定存在。如果内部发生异常，`ValidateRequest()`我希望堆栈跟踪能够显示这一点。

任何指针？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-21T18:43:26.440

我愿意打赌那`positions`是空的，这`foreach(var position in positions)`就是在调用`GetEnumerator()`位置时抛出异常的原因。

```
if(positions != null)
{
    foreach(var position in positions)
    {
        ...
    }
} 
```

正如您可能猜到的那样，行号计算在这里很容易变得有点混乱，因为`foreach`循环只是这样的语法糖：

```
IEnumerator<Position> enumerator = positions.GetEnumerator();

try
{
    Position position;

    while(enumerator.MoveNext())
    {
        position = enumerator.Current;

        //The code from the body of your foreach loop goes here
    }
 }
 finally
 {
     //Clean up the enumerator
 } 
```

# mysql - mysql 仅在子查询中查找唯一记录并显示计数

> ID：11143119
> 
> 赞同：0
> 
> 时间：2012-06-21T17:00:40.093
> 
> 标签：mysql, subquery

我有两张表我想从中获取信息。

登录表 - 包含员工列表

项目表 - 包含项目

简而言之，我正在尝试编写一个查询，该查询将选择撰稿人并对每个撰稿人执行一个子查询，该子查询将返回一个名为“open_projects”的字段。这个，我可以开始使用下面的sql：

```
select web_login_id,
                (select count(project_web_id) from project
                where copywriter = web_login_id
                and (`status` = 'open' or `status` = 'qual')) as open_projects from login
                where roles like '%copywriter%'
                and tierLevel like '%c1%'
                order by open_projects asc 
```

这会返回类似：

1982983 3

1982690 22

2987398 5

这样做的问题是，有时 5 或 6 个项目将属于同一个客户，并且实际上并没有被处理，因为它们是以排队的方式处理的。

我的问题是如何修改上面的 sql 以便子查询将基于 client_login_id 字段进行 GROUP 子集。

这个 sql 给了我一个错误：子查询返回超过 1 行

```
select web_login_id,
                (select count(project_web_id) from project
                where copywriter = web_login_id
                and (`status` = 'open' or `status` = 'qual') group by client_login_id) as open_projects from login
                where roles like '%copywriter%'
                and tierLevel like '%c1%'
                order by open_projects asc 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-21T17:38:14.020

您需要将其改写为显式连接。我认为以下方法可以解决问题：

```
select web_login_id, cw.open_projects
from login l left outer join
      (select copywriter, count(project_web_id) as open_projects
       from project
       where `status`  in ('open', 'qual')
       group by copywriter
      ) cw
      on l.web_login_id = cw.copywriter
where l.roles like '%copywriter%' and l.tierLevel like '%c1%' 
order by open_projects asc 
```

我不确定“按 client_login_id 分组”在做什么。似乎没有必要。

完成此操作后，您可以从子查询中返回任意数量的列。

# solr - Solr NativeFSLock 超时

> ID：11143129
> 
> 赞同：3
> 
> 时间：2012-06-21T17:01:07.590
> 
> 标签：solr

**设置：** 我在 CentOS 5.7 linux 2.6.32-042stab044.5 上的码头容器中运行 Apache Solr。服务器是具有 4GB 专用 RAM 和 2GB 的“突发”RAM 的 VPS。

我正在使用以下选项运行 Solr（换行符以提高可读性）：

```
/opt/jre/bin/java -Dsolr.solr.home=/opt/solr/solr 
                  -Xms2048m -Xmx2048m 
                  -Djetty.logs=/var/log/solr
                  -Djetty.home=/opt/solr
                  -Djava.io.tmpdir=/tmp 
                  -jar /opt/solr/start.jar
                  /opt/solr/etc/jetty-logging.xml 
                  /opt/solr/etc/jetty.xml 
```

我的 Solr 配置使用了大约 500 个内核，每个内核使用 13MB，磁盘总数为 6.8GB。

**问题：** solr 服务器大约每 2 周开始响应缓慢。当我检查 stderror 日志时，我看到很多这样的条目：

```
Jun 21, 2012 9:36:11 AM org.apache.solr.common.SolrException log
SEVERE: org.apache.lucene.store.LockObtainFailedException: Lock obtain timed out: NativeFSLock@/opt/solr/solr/examplestore/data/index/write.lock
        at org.apache.lucene.store.Lock.obtain(Lock.java:84)
        at org.apache.lucene.index.IndexWriter.<init>(IndexWriter.java:1108)
        at org.apache.solr.update.SolrIndexWriter.<init>(SolrIndexWriter.java:83)
        at org.apache.solr.update.UpdateHandler.createMainIndexWriter(UpdateHandler.java:101)
        at org.apache.solr.update.DirectUpdateHandler2.openWriter(DirectUpdateHandler2.java:171)
        at org.apache.solr.update.DirectUpdateHandler2.addDoc(DirectUpdateHandler2.java:219)
        at org.apache.solr.update.processor.RunUpdateProcessor.processAdd(RunUpdateProcessorFactory.java:61)
        at org.apache.solr.update.processor.LogUpdateProcessor.processAdd(LogUpdateProcessorFactory.java:115)
        at org.apache.solr.handler.XMLLoader.processUpdate(XMLLoader.java:158)
        at org.apache.solr.handler.XMLLoader.load(XMLLoader.java:79)
        at org.apache.solr.handler.ContentStreamHandlerBase.handleRequestBody(ContentStreamHandlerBase.java:58)
        at org.apache.solr.handler.RequestHandlerBase.handleRequest(RequestHandlerBase.java:129)
        at org.apache.solr.core.SolrCore.execute(SolrCore.java:1372)
        at org.apache.solr.servlet.SolrDispatchFilter.execute(SolrDispatchFilter.java:356)
        at org.apache.solr.servlet.SolrDispatchFilter.doFilter(SolrDispatchFilter.java:252)
        at org.mortbay.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1212)
        at org.mortbay.jetty.servlet.ServletHandler.handle(ServletHandler.java:399)
        at org.mortbay.jetty.security.SecurityHandler.handle(SecurityHandler.java:216)
        at org.mortbay.jetty.servlet.SessionHandler.handle(SessionHandler.java:182)
        at org.mortbay.jetty.handler.ContextHandler.handle(ContextHandler.java:766)
        at org.mortbay.jetty.webapp.WebAppContext.handle(WebAppContext.java:450)
        at org.mortbay.jetty.handler.ContextHandlerCollection.handle(ContextHandlerCollection.java:230)
        at org.mortbay.jetty.handler.HandlerCollection.handle(HandlerCollection.java:114)
        at org.mortbay.jetty.handler.HandlerWrapper.handle(HandlerWrapper.java:152)
        at org.mortbay.jetty.Server.handle(Server.java:326)
        at org.mortbay.jetty.HttpConnection.handleRequest(HttpConnection.java:542)
        at org.mortbay.jetty.HttpConnection$RequestHandler.content(HttpConnection.java:945)
        at org.mortbay.jetty.HttpParser.parseNext(HttpParser.java:756)
        at org.mortbay.jetty.HttpParser.parseAvailable(HttpParser.java:212)
        at org.mortbay.jetty.HttpConnection.handle(HttpConnection.java:404)
        at org.mortbay.jetty.bio.SocketConnector$Connection.run(SocketConnector.java:228)
        at org.mortbay.thread.QueuedThreadPool$PoolThread.run(QueuedThreadPool.java:582) 
```

当我检查内存使用情况时，码头进程正在使用 3GB，并`free -m`报告 ~3GB 正在使用中。

我目前的解决方法是重新启动码头进程（/etc/init.d/solr restart）。“锁定获取超时”异常停止并且性能再过一两周是合理的。

SolrPerformance [wiki](http://wiki.apache.org/solr/SolrPerformanceFactors#OutOfMemoryErrors)表明这是一个内存问题，这就是为什么我将内存使用量设置为 2GB 并在终止进程之前检查内存使用量。但是，我不确定这是否是问题所在，因为有可用内存（3GB 使用 4GB 专用，加上 2GB 的“突发”RAM）。

**问题：** 我可以做些什么来防止“锁定获取超时”异常并最终提高我的 Solr 设置的稳定性，这样我就不必每 2 周重新启动一次？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-22T01:33:07.933

不了解您的应用程序，我不应该发表太多评论...但是对于该索引大小和处理器内核数量（我怀疑，不超过 4 个）而言，500 个内核似乎很高。

您可以重新加载 solr 核心，根据我的经验，它有助于从某些长期存在的对象中回收内存。 [http://wiki.apache.org/solr/CoreAdmin#RELOAD](http://wiki.apache.org/solr/CoreAdmin#RELOAD)

您真的注意到日志中的内存不足错误吗？您可以从启用 verbosegc 开始，并将您注意到的错误与详细 gc 输出相关联。

# javascript - 获取每一行的总金额

> ID：11143135
> 
> 赞同：-2
> 
> 时间：2012-06-21T17:01:47.760
> 
> 标签：javascript, jquery

我目前正在研究，我需要将 2 个输入值（数量和数量）相乘，然后得到总数。我的问题在于理想情况下在 keyup 上获取每个“行”的总数，因为将有多个行/字段集。

HTML：

```
<fieldset>

<p>Title</p>
<label id="">Quantity</label><input type="text" class="quantity" id="" value="Quantity" name="">
<label id="">Amount</label><input type="text" class="amount" id="" value="Amount" name="">
<label id="">Total</label><input type="text" class="total" id="" value="Total" name="">

</fieldset>

<fieldset>

<p>Title</p>
<label id="">Quantity</label><input type="text" class="quantity" id="" value="Quantity" name="">
<label id="">Amount</label><input type="text" class="amount" id="" value="Amount" name="">
<label id="">Total</label><input type="text" class="total" id="" value="Total" name="">

</fieldset> 
```

可以通过一个按钮添加多行。任何帮助是极大的赞赏。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-21T17:12:52.340

在[`keyup`](http://api.jquery.com/keyup/)每个输入中，您可以使用[`.val()`](http://api.jquery.com/val/)然后相乘来获取每个文本框的值。

```
$("fieldset input").keyup(function() {
    var quantity = $(this).parent().find(".quantity").val();
    var amount = $(this).parent().find(".amount").val();

    $(this).parent().find(".total").val(quantity * amount);
}); 
```

[演示](http://jsfiddle.net/twMSG/6/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-21T17:14:51.747

像这样的东西：

```
$(document).delegate(".total", "keyup", function() {
  var $fieldset = $(this).closest("fieldset"),
      total = $fieldset.find(".quantity").val() * $fieldset.find(".amount").val();
  $(this).val(total);
}); 
```

# mysql - BINARY(16) 上的 MySQL 索引。什么尺寸？

> ID：11143136
> 
> 赞同：4
> 
> 时间：2012-06-21T17:01:48.743
> 
> 标签：mysql, indexing

我有一张超过 660 万行的表格。

我有一个字段，名为`trip_id`who's in `BINARY(16)`。我发现我的查询太慢了（`0.2 seconds`）。此查询几乎每 3 秒运行一次。

在做任何愚蠢的事情之前，我想知道如果我将索引大小`trip_id`从 full 降低到 12，会有所不同吗？

如果我尝试更多地调整我的查询，会有所不同吗？

谢谢

编辑：

询问 ：

```
SELECT      stop_times.stop_id
FROM        trips
LEFT JOIN   stop_times ON trips.trip_id = stop_times.trip_id
WHERE       trips.route_id  = '141'
GROUP BY    stop_times.stop_id
ORDER BY    trips.trip_headsign ASC,
            stop_times.stop_sequence ASC 
```

`trip_id BINARY(16)`

`route_id SMALLINT(3)`

`trip_headsign VARCHAR(50)`

`stop_sequence SMALLINT(3)`

查询说明： ![查询说明](../Images/1a946fac1ad3d03cac092121c38cff22.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-21T20:49:13.973

经过研究，我发现了问题，因为是的，0.2 秒很慢。

```
SELECT      t.trip_headsign, st.stop_sequence, s.stop_code, s.stop_name
FROM        stop_times AS st
JOIN        stops AS s USING (stop_id)
JOIN        (   SELECT  trip_id,
                        route_id,
                        trip_headsign
                FROM    trips
                WHERE   route_id = '141'
                LIMIT   2
            ) AS t
WHERE       t.trip_id = st.trip_id
GROUP BY    st.stop_id 
```

首先，在这里更快`LEFT JOIN`，而不是做 a 。`JOIN`但重要的一点是，我匹配 WHERE 语句中的所有旅行结果。

但是，由于一辆公共汽车只能有 2 个方向，所以我只需要将结果限制为 2。现在，我的结果接近 0.018。超过 1000% 的改进。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-21T17:47:33.280

您的“额外”列中有“使用临时”和“使用文件排序”。

这些是肯定的迹象，表明你可以改进事情。这些出现的原因是因为您的 GROUP 和 ORDER 子句。

第一步：它们真的有必要吗？您可能会发现，端到端地使用使用这些数据的语言对它们进行排序更便宜。

第二步：如果您仍然需要`ORDER BY`，请查看MySQL 文档中的[ORDER BY Optimization](http://dev.mysql.com/doc/refman/5.0/en/order-by-optimization.html)。此处不使用索引进行排序的原因是不同的`GROUP BY`和`ORDER BY`子句。

跳出框框思考。您没有进行任何聚合，因此可能不需要分组。也许只是拉所有的行，然后忽略重复的 id。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-21T20:03:36.630

尝试将 trip_headsign 添加到您的“路线”索引中。因为您在 ORDER BY 中使用它，所以 mysql 需要转到实际表以获取它在与 route_id 匹配的索引中找到的每条记录。如果在说明的 Extra 列中没有看到“Using index”，则意味着 MySQL 被迫返回实际表以获取更多信息。

# html - 原型函数未被调用

> ID：11143138
> 
> 赞同：3
> 
> 时间：2012-06-21T17:01:59.270
> 
> 标签：html, prototypejs

以下是否有任何原因不起作用，它似乎适用于除以下情况之外的所有情况：

我的 html/asp.net

```
<div class="submitContainerConfirm" id="submit_Div">       
    <asp:PlaceHolder runat="server" id="phContinue">
        <asp:ImageButton CausesValidation="false" CssClass="ShowPleaseWait button" runat="server" ID="ibtnContinue" OnClick="ibtnContinue_OnClick" />
    </asp:PlaceHolder>
</div> 
```

我的原型

```
function pageLoad() {

$$(".ShowPleaseWait").each(function (el) {
    el.observe("click", function (event) {
        if (Page_IsValid) {
            el.hide();
            el.insert({ after: '<img src="/content/images/processing.gif" /> Please Wait...' });
            alert('Is Valid');
        }
        alert('Is not Valid');
    });
});

} 
```

尝试二：

```
Event.observe(window, 'load', function () {

Event.observe("click", function (event) {
    if (Page_IsValid) {
        event.hide();
        event.insert({ after: '<img src="/content/images/processing.gif" /> Please Wait...' });
        alert('Is Valid');
    }
    alert('Is not Valid');
});

Event.observe("click", function (event) {
    if (Page_IsValid) {
        event.hide();
        event.insert({ after: '<img src="/content/images/processing.gif" /> Processing...' });
        alert('Is Valid');
    }
    alert('Is not Valid');
});

}); 
```

// 这也不起作用。请不要jquery。

[在 html + prototypejs 中呈现的 asp 示例奇怪地不起作用。](http://jsfiddle.net/VUPKx/3)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-25T08:42:36.657

在您的第二次尝试中，您没有为要监听`element`的`observe`事件指定任何内容，它如何知道单击了哪个元素？

试试这个：

```
Event.observe(window, 'load', function() {
    $$('.ShowPleaseWait').each(function(el) {
        el.observe('click', function(ev) {
            if (Page_IsValid) {
                el.hide();
                el.insert({ 
                    after: '<img src="/content/images/processing.gif" /> Please Wait...'
                });

                alert('Is Valid');
            }

            alert('Is not Valid');
        });
    }); 
}); 
```

**更新**

查看[JSFiddle 生成页面的截图](http://imgur.com/fwYX6)，这是[这个](http://jsfiddle.net/VUPKx/5/)fiddle的直接输出

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-26T00:19:47.667

抱歉，我目前无法发表评论，但我现在看到的情况似乎不会触发 Page_IsValid，因为表单没有验证控件。通过使用@epochs JS 解决方案，您可以触发预期结果。

注意：我没有为您的 OnClick 事件使用任何 EventHandlers

通过添加示例文本框来强制进行验证，看看以下是否有帮助...

```
<div class="submitContainerConfirm" id="submit_Div">       
<asp:PlaceHolder runat="server" id="phContinue">
    <asp:TextBox ID="required" runat="server"></asp:TextBox>
    <asp:RangeValidator
        ID="rangeValidator"
        ErrorMessage="Enter 0-10"
        runat="server"
        MinimumValue="0"
        MaximumValue="10"
        ControlToValidate="required"></asp:RangeValidator>
    <asp:ImageButton CausesValidation="false" CssClass="ShowPleaseWait button" runat="server" ID="ibtnContinue" OnClick="ibtnContinue_OnClick" />
</asp:PlaceHolder> 
```

# ios - ios和涉及EXC_BAD_ACCESS的情况

> ID：11143139
> 
> 赞同：2
> 
> 时间：2012-06-21T17:02:02.410
> 
> 标签：ios, exc-bad-access, nsnotificationcenter, userinfo

我在以下场景中苦苦挣扎，可以使用一些不同的观点来阐明我：

当你点击返回按钮时，我有一个`self.backstack`“返回”到的部分数组。在特定情况下按下后退按钮时，我会得到一个`EXC_BAD_ACCESS`提示，但我不确定代码对哪个对象感到疯狂，因为一切似乎都在那里。

如果您查看图像的左下角，您会看到`self`、`backStack`和`userInfo`都在那里。不仅如此，他们各自的印刷品也记录在右下角。

有什么想法可能是什么问题？谢谢。

![在此处输入图像描述](../Images/19482fd701ebcbfb8fe82bd3cef2ad57.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-21T17:05:54.387

我怀疑您有一个通知观察者，该通知在未注册通知之前已被解除分配。

通知是同步的，这意味着在您崩溃的线路上，它正在尝试运行所有观察者回调。检查您为这些注册的任何地方，并确保这些对象要么保留在其他地方，要么在它们被释放时被正确地取消注册（removeObserver iirc）。

# javascript - 将页面元素索引到 JSON 对象？还是每次都使用 jQuery 选择器呢？

> ID：11143142
> 
> 赞同：2
> 
> 时间：2012-06-21T17:02:44.667
> 
> 标签：javascript, jquery, json, dom

我有一个`DOM`：

```
<body>
      <div>
         <h1 id="header1">home1</h1>
         <a id="link1">link1</a>
         <p id="para1">things1</p>
      </div>
      <span>
         <h1 id="header2">home2</h1>
         <a id="link2">link2</a>
         <p id="para2">para2</p>
      </span>
</body> 
```

我想索引这个`JSON`喜欢：

```
{
"body": {
    "div": [
        {
            "h1": "header1",
            "a": "link1",
            "p": "para1"
        }
    ],
    "span": [
        {
            "h1": "header2",
            "a": "link2",
            "p": "para2"
        }
    ]
  }
} 
```

我试过这个：

```
 function indexELEMS()
  {
    listy = $("*[id]").map(function(){

        outy = this.tagName+":"+this.id;

        return outy;
    }).get();

    DOMobj = $.extend({}, listy);

    console.log(DOMobj);

  } 
```

但我得到这样的东西：

```
0:"h1:home"
1:"a:link1"
2:"p:things1" 
```

可以理解，我刚刚告诉函数这样做。

`h1`但是，如果我在's上试一下，就像这样：

```
 function indexELEMS()
  {
           outy = {};
    listy = $("h1[id]").map(function(){

        outy.h1s = this.tagName+":"+this.id;

        return outy;
    }).get();

    DOMobj = $.extend({}, listy);

    console.log(DOMobj);

  } 
```

它将`outy.h1s`用最后一个覆盖，我如何将它添加到（JSON）对象？

或者更好的是，我如何以漂亮的 JSON 形式获得整个文档元素结构输出？

我可以这样做：`$('document > body > div > h1').attr('id')`每次，但这是非常低效和资源密集型的，我想缓存所有元素，然后将它们读出，当它们发生变化时，（也许我会用 观察对象`.watch`），或者被添加到对象中，在适当的位置创建一个元素。

或者有没有更好的方法来了解哪些元素有`ID`s （并检查它`ID`是否重复），一些本机功能？

我还担心 JSON 对象不允许多个`div:`条目？

还是我应该完全使用 jQuery 选择器，不再抱怨效率？

（编辑：好的，多个 div 部分可能是不可能的，或者我不能用 .div[1] 访问第二个部分？）

所以，我的主要问题是，如果你使用 indexELEMS 函数，我怎样才能得到一个可以通过以下方式访问的对象：

```
DOMobj.body.div.h1 
```

所以我可以`If ==`在上面做一个，或者`div.[index]`在一个循环中`$.each`循环

我想，通过 DOMobj.body[index] 而不是 $(' *') 循环，哦等等，我真的可以访问从 $('* ') 创建的对象吗？像.body？不可能那么容易..

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-21T18:45:50.370

您的结构在内部是不一致的：`<body>`有一个对象子对象，但它的所有子对象都是带有单个对象的数组。这应该映射到任何页面 DOM 还是只是您自己的一些自定义页面？

如果您希望任何 DOM 都能够表示为 JSON，那么您所寻求的就是这样的东西吗？

```
[ { "tag": "body"
  , "children":
    [ { "tag": "div"
      , "children":
        [ { "tag": "h1"
          , "id": "header1"
          }
        , { "tag": "a"
          , "id": "link1"
          }
        , { "tag": "p"
          , "id": "para1"
          }
        ]
      }
    , { "tag": "span"
      , "children":
        [ { "tag": "h1"
          , "id": "header2"
          }
        , { "tag": "a"
          , "id": "link2"
          }
        , { "tag": "p"
          , "id": "para2"
          }
        ]
      }
    ]
  }
] 
```

如果您只使用此 JSON 对象的案例来回答有关 DOM 的查询，并进行一些迭代，您可能最好使用 $('your.selector.here').each 和类似的代码来执行您想要的测试。

如果您想手动索引整个 DOM（找到`<body>`的第二个`<div>`孩子的第五个`<a>`元素，并告诉我它的`id`属性是否为`"link5"`），您需要 XPath：

```
document.evaluate('//body/div[2]/a[5]/@id = "link5"', document).booleanValue 
```

# ios - 使用 NSDictionary 解析 JSON 并按键查找值

> ID：11143146
> 
> 赞同：1
> 
> 时间：2012-06-21T17:02:57.787
> 
> 标签：ios, json, nsdictionary

我有一个简单`NSDictionary`的方法，我试图通过返回的 JSON 填充来自外部站点的数据。返回的 JSON 很好，但我无法获取特定键的实际数据。

这是打印到控制台的 JSON 数据。

这是我的 JSON 数据：

```
(
        {
        CategoryID = 12345;
        CategoryName = "Baked Goods";
    },
        {
        CategoryID = 12346;
        CategoryName = Beverages;
    },
        {
        CategoryID = 12347;
        CategoryName = "Dried Goods";
    },
        {
        CategoryID = 12348;
        CategoryName = "Frozen Fruit & Vegetables";
    },
        {
        CategoryID = 12349;
        CategoryName = Fruit;
    },
        {
        CategoryID = 12340;
        CategoryName = "Purees & Soups";
    },
        {
        CategoryID = 12341;
        CategoryName = Salad;
    },
        {
        CategoryID = 12342;
        CategoryName = "Snack Items";
    },
        {
        CategoryID = 12343;
        CategoryName = Vegetables;
    }
) 
```

我得到的错误是：

> 由于未捕获的异常“NSInvalidArgumentException”而终止应用程序，原因：“-[__NSCFArray enumerateKeysAndObjectsUsingBlock:]：无法识别的选择器发送到实例 0x6884000”

```
- (void)connection:(NSURLConnection *)connection didReceiveData:(NSData *)data {

    NSError *error = nil;
    // Get the JSON data from the website
    NSDictionary *categories = [NSJSONSerialization JSONObjectWithData:data  options:kNilOptions error:&error];

    if (categories.count > 0){
        NSLog(@"This is my JSON data %@", categories);

        [categories enumerateKeysAndObjectsUsingBlock: ^(__strong id key, __strong id obj, BOOL *stop) {
        NSLog(@"Key = %@, Object For Key = %@", key, obj); }];
} 
```

我不确定为什么会发生这种情况，但我确定这很简单，就像我使用了不正确的对象或其他东西一样。

帮助表示赞赏。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-21T17:57:19.863

`+JSONObjectWithData:options:error:`正在返回 NSArray 而不是 NSDictionary。`'-[__NSCFArray enumerateKeysAndObjectsUsingBlock:]`是错误信息的关键部分。它告诉你你正在调用`-enumerateKeysAndObjectsUsingBlock:`一个数组。

* * *

对于这种情况，您可以`-enumerateObjectsUsingBlock:`改用。

如果您不确定是否会返回 NSArray 或 NSDictionary，您可以使用`-isKindOf:`

```
id result = [NSJSONSerialization …];
if ([result isKindOf:[NSArray class]]) {
    NSArray *categories = result;
    // Process the array
} else if ([result isKindOf:[NSDictionary class]]) {
    NSDictionary *categories = result;
    // Process the dictionary
} 
```

* * *

来自[enumerateObjectsUsingBlock：](https://developer.apple.com/library/ios/#documentation/Cocoa/Reference/Foundation/Classes/NSArray_Class/NSArray.html#//apple_ref/occ/instm/NSArray/enumerateObjectsUsingBlock:)

> 使用数组中的每个对象执行给定的块，从第一个对象开始，一直到数组中的最后一个对象。
> 
> *   (void)enumerateObjectsUsingBlock:(void (^)(id obj, NSUInteger idx, BOOL *stop))block

所以应该这样称呼它

```
[categories enumerateObjectsUsingBlock:^(id obj, NSUInteger idx, BOOL *stop) {
    NSLog(@"index = %d, Object For Key = %@", idx, obj);
}]; 
```

快速阅读文档确实可以为您节省很多挫败感。

# java - 查明 HTTPS 网址是否在线

> ID：11143148
> 
> 赞同：1
> 
> 时间：2012-06-21T17:03:03.060
> 
> 标签：java, android, ssl

如果安全网站的证书由 CA 签名，我需要一个返回 true 的函数。在 Android 中，如果您尝试连接到自签名证书，它会抛出 SSLException，在这种情况下，我只是捕获它并返回 false。您可以检查代码：

```
public static boolean isValidCertificate(URL url) throws IOException {
    HttpsURLConnection con;
    try {
        con = (HttpsURLConnection) url.openConnection();
        con.connect();
        con.disconnect();
        return true;
    } catch (SSLException e) {
        return false;
    } 
} 
```

我的问题是，如果站点不可用，我希望函数抛出异常。但我刚刚发现 Android 在这种情况下会抛出相同的 SSLException，并带有相同的消息：“没有受信任的服务器证书”。

无论证书是否有效，有没有办法知道服务器是否在线？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-21T17:15:11.163

使用诸如“https://flimflam.asdfasdfasdfg.com”之类的虚假 URL 对其进行测试，看看您的情况会发生什么。

`IOException`如果没有基于该`openConnection`方法建立连接，则应该触发。很可能这更像是超时，您将花时间等待超时时间。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-21T17:21:58.783

尝试使用`con.getResponseCode();`before`con.disconnect();`来获得你想要的异常。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-21T20:49:32.160

我找到了解决方案。我只需要在调用此函数之前检查 URL 是否在线。我可以在没有 CA 签名检查的情况下使用我的 httpsclient 并获得响应，然后，我调用此方法。

# c# - 如何在不调试的情况下测试方法？

> ID：11143149
> 
> 赞同：0
> 
> 时间：2012-06-21T17:03:04.470
> 
> 标签：c#, visual-studio-2010, debugging, methods

我有一种方法可以对输入字符串进行哈希处理以从中生成 MD5 通行证，我可以在不调试的情况下测试他的输入和输出

```
private string getMD5hash(string input)
{
    //create a new instance of MD5 object
    MD5 md5Hasher = MD5.Create(); 
    //convert the input value to byte array
    byte[] data = md5Hasher.ComputeHash(Encoding.Default.GetBytes(input));
    StringBuilder sBuilder = new StringBuilder();

    for (int i = 0; i < data.Length  ; i++)
    {
        sBuilder.Append(data[i].ToString("x2"));
    }
    return sBuilder.ToString();
} 
```

我正在使用 Visual Studio 2010

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-16T20:04:28.300

在 Visual Studio 2010/2012 中在您正在处理的程序集中打开一个文件。
打开即时窗口 (Ctrl+D,I) 或调试 -> 窗口 -> 即时。

* * *

输入方法的全名：（*错误的 IntelliSense 不起作用*）

```
new ConsoleApplication1.Program().getMD5hash("stringToHash"); 
```

* * *

我没有在其他版本的 Visual Studio 上测试过这个。另外，请记住，执行命令时，代码编辑器应该在感兴趣的项目中打开一个文件。切换到另一个项目中的另一个文件将不允许代码运行。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-21T17:22:23.420

我能想到的最快和最简单的方法是在 Visual Studio 中创建一个控制台应用程序，并将该函数放在主类中。

然后在`main`函数中调用带有适当输出的上述函数，例如

```
void main()
{
   string inputStr = "teststring";
   Console.WriteLine(string.Format("{0} = {1}", inputStr, getMD5hash(inputStr)));
   inputStr = "anotherstring";
   Console.WriteLine(string.Format("{0} = {1}", inputStr, getMD5hash(inputStr)));
   Console.ReadKey(); // Pause at the end
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-21T17:36:29.820

一切都很好

```
namespace ConsoleApplication1
{
    class Program
    {
        static void Main(string[] args)
        {
            string inputstr = Console.ReadLine();

           Console.WriteLine(string.Format("{0} = {1}", inputstr, getMD5hash(inputstr)));

            Console.ReadKey();

        }

        public static string getMD5hash(string input)
        {
            //create a new instance of MD5 object
            MD5 md5Hasher = MD5.Create();
            //convert the input value to byte array
            byte[] data = md5Hasher.ComputeHash(Encoding.Default.GetBytes(input));
            StringBuilder sBuilder = new StringBuilder();

            for (int i = 0; i < data.Length; i++)
            {
                sBuilder.Append(data[i].ToString("x2"));
            }
            return sBuilder.ToString();
        }

    }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-17T00:40:43.917

一般建议是使用单元测试。这样，测试仍然存在，并且您可以通过一种简单的方法来运行它们。

# .net - ASP.NET MVC3。如何根据模型的布尔值将验证设置为需要两个字段之一？

> ID：11143151
> 
> 赞同：0
> 
> 时间：2012-06-21T17:03:14.220
> 
> 标签：.net, asp.net-mvc-3, validation

这是我的模型：

```
public class RestoreRequestModel : IDataErrorInfo
{
    //true seems Value contains phone email otherwise
    public bool IsPhoneMode { get; set; }

    //Contains phone or email address.
    public string Value { get; set; }
} 
```

并查看：

```
@using (Html.BeginForm()) {
@Html.ValidationSummary(true)
<fieldset>
    <legend>RestoreModel</legend>

    <label for="email">By Email</label>
    @Html.RadioButtonFor(x => x.IsPhoneMode, Constants.RESTORE_BY_EMAIL, new { id="email" })

    <label for="phone">By Phone</label>
    @Html.RadioButtonFor(x => x.IsPhoneMode, Constants.RESTORE_BY_PHONE, new { id = "phone" })

    <div class="editor-label">
        @Html.LabelFor(model => model.Value)
    </div>
    <div class="editor-field">
        @Html.EditorFor(model => model.Value)
        @Html.ValidationMessageFor(model => model.Value)
    </div>

    <p>
        <input type="submit" value="Create" />
    </p>
</fieldset>} 
```

是否可以根据 model.IsPhoneMode 状态设置验证？我可以通过向模型属性添加属性来设置验证，但必须有不同的验证条件，具体取决于 RadioButton 状态。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-21T17:48:15.303

你需要的是实现你自己的属性，这个属性是有条件的，你可以搜索很多关于该主题的博客文章，或者你可以下载[Mvc.ValidationTookit](http://blogs.msdn.com/b/simonince/archive/2011/09/29/mvc-validationtookit-alpha-release-conditional-validation-with-mvc-3.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-21T17:49:40.007

Nuget FoolProof 验证包。它完全适用于这种情况。

# ios - TableViewCell(s) 可以有不同的高度吗？

> ID：11143152
> 
> 赞同：0
> 
> 时间：2012-06-21T17:03:15.060
> 
> 标签：ios

作为桌子的一部分，是否可以`TableViewCell`有不同的高度？

如果是这样，如何做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-21T17:04:54.573

使用`UITableViewDelegate`方法：

```
- (CGFloat)tableView:(UITableView *)tableView heightForRowAtIndexPath:(NSIndexPath *)indexPath 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-21T17:05:05.960

是的，您必须为您的 tableview 数据源委托覆盖以下函数：

```
- (CGFloat) tableView:(UITableView *)tableView heightForRowAtIndexPath:(NSIndexPath *)indexPath 
```

# javascript - 移动图像，显示值并保存当前值

> ID：11143153
> 
> 赞同：0
> 
> 时间：2012-06-21T17:03:26.137
> 
> 标签：javascript, image, get

我怎样才能得到它移动多长时间的价值并保存它。所以每次有人点击它都会加起来

```
var imgObj = null;
function init(){

   imgObj = document.getElementById('myImage');
   imgObj.style.position= 'relative'; 
   imgObj.style.left = '0px'; 
}
function moveRight(){
  if(parseInt(imgObj.style.left) < 700){
   imgObj.style.left = parseInt(imgObj.style.left) + 10 + 'px';  
    }
    if(parseInt(imgObj.style.left) == 700){
   imgObj.style.left = parseInt(imgObj.style.left) + 0 + 'px';
    } 
}
window.onload =init; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-21T18:02:36.967

如果您希望在有人单击 #myImage 时执行移动功能，请使用[事件处理程序](https://developer.mozilla.org/en/DOM/element.addEventListener)。您可以使用[高级模型](http://www.quirksmode.org/js/events_advanced.html)，也可以只使用[传统](http://www.quirksmode.org/js/events_tradmod.html)模型，因为您已将其用于 onload。

```
imgObj.onclick = moveRight; // do not execute 
```

# c# - 如何将值从父页面中的gridview传递到弹出页面中的表单

> ID：11143154
> 
> 赞同：0
> 
> 时间：2012-06-21T17:03:27.973
> 
> 标签：c#, javascript, visual-studio-2010, gridview, oracle11g

我只在页面中有一个gridview，单击按钮列字段Gridview1_RowCommand被执行。我坚持的是如何将单个refno（在网格中）传递给弹出页面。我想使用这个refno生成对此的查询帮助将非常感谢我使用的以下代码，并且我被困在这里..

```
protected void GridView1_RowCommand(object sender, GridViewCommandEventArgs e)
{

    Page.RegisterStartupScript("test", "<script language='javascript'>Openpopup();</script>");
}

 <script language='javascript'>
   var popupobj;
  function Openpopup() 
{
      popupobj = window.open("popup.aspx", "_blank", "width=1000,height=500,statusbar=no,toolbar=no,scrollbars=no,resizable=no,navbar=no,screenX=800,screenY=800top=100,left=100");
    popupobj.focus();
}
 </script> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-21T17:25:22.407

由于您使用的是 RowCommand 事件，为了能够将此值发送到弹出窗口，您需要将 RowIndex 设置为您单击以打开弹出窗口的按钮的 CommandArgument。将 Value(refno) 设置为传递给 DataKey 中的 Popup。

```
protected void GridView1_RowDataBound(object sender, GridViewRowEventArgs e)
{
    var Button1= e.Row.FindControl("Button1") as Button;
    Button1.CommandName = "ButtonClick";
    // cast RowIndex in line code to string if e.CommandArgument accepts string
    Button1.CommandArgument = e.Row.RowIndex;
} 
```

现在在 RowCommand

```
protected void GridView1_RowCommand(object sender, GridViewRowCommandArgs e)
{
    if(e.CommandName == "ButtonClick")
    {
        var refno = GridView1.DataKeys[Convert.ToInt32(e.CommandArgument)]["refno"];
        Page.RegisterStartupScript("test", "<script language='javascript'>Openpopup(' + refno + ');</script>"); 
    }
} 
```

这样，现在您在 Javascript 函数参数中有 refno。将此参数作为 Javascript 弹出函数中的查询字符串传递。

这样您就可以在 Popup 页面中访问 refno。

# http - 这条线在萤火虫中是什么意思？右手边的蓝字

> ID：11143159
> 
> 赞同：1
> 
> 时间：2012-06-21T17:03:49.670
> 
> 标签：http, firebug, fiddler, mvc-mini-profiler

我安装了萤火虫，我可以在我的一个“网络”请求中看到右侧有一些“蓝色”字样......我想知道这是什么？

![在此处输入图像描述](../Images/b38c34b93a5a53ad053ff53376a2c6b0.png)

我正在使用迷你分析器。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-25T03:12:55.110

像这样的蓝色链接指向一行相关的源代码。您会在 Firebug 的各个部分找到它们。

例如，类似的链接出现在控制台日志消息旁边。

![Firebug 控制台消息](../Images/2761d8a985c364bac4dca0e40a02b435.png)

单击此类链接将显示调用*console.log()*的 JavaScript 行。

同样，在 HTML *Style*子窗格下，有指向 CSS 文件中相关规则定义的链接。

![CSS 链接](../Images/e246fa051b966900780c897b3d50afbe.png)

在您的情况下，该蓝色链接指向发送 XMLHttpRequest 的 JavaScript 代码行。单击该链接将在“*脚本*”选项卡下显示有问题的行。

![XHR 链接](../Images/1ff0e54821523469d70741c847d30242.png)

尽管该请求似乎是从 jQuery 库的缩小副本深处的某个地方发起的。查看该代码不会有太大帮助。

要了解发生了什么，您可以单击“*网络*”选项卡下请求的左边距以设置断点。

![Net 选项卡下的断点](../Images/a83b86d35183c8cf94d15b7c21e9d187.png)

在下一个此类请求中，查看堆栈跟踪以查看代码的哪一部分导致该请求发生。

![堆栈跟踪](../Images/244cc0d2e4f2a00c60b92709d5e3c71d.png)

# html - 如何为块元素设置动态宽度？

> ID：11143163
> 
> 赞同：1
> 
> 时间：2012-06-21T17:04:15.590
> 
> 标签：html, css

我有 30 个元素，其类`.lollipop`具有`line-height: 30px; height: 30px;`.

```
<a class="lollipop">Random text</a>
<a class="lollipop">Random text longer</a>
<a class="lollipop">Short</a>
... 
```

我如何编写 CSS 以具有动态宽度（它们的宽度会根据它们内部的文本量进行调整，就像通常那样）并且每行只有一个这些元素，可能不添加其他 HTML 元素？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-21T17:10:47.920

可能最简单的方法是：

```
a {
    float: left;
    clear: left;
} 
```

有了这个，您不必更改 HTML。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-21T17:18:01.377

`display: table-row`如果您希望所有链接的宽度相等，您可以尝试，灵活宽度被计算为链接的最大宽度。

或者您可以使用`:before`伪来创建一种没有浮动和清除的清除，以防它在您的设计中引起问题。

小提琴：http:
[//jsfiddle.net/PhilippeVay/Sm8tK/](http://jsfiddle.net/PhilippeVay/Sm8tK/)

# jsf - 带有 JSF/Richfaces（移动 Web 应用程序）的无限列表（模式）

> ID：11143164
> 
> 赞同：2
> 
> 时间：2012-06-21T17:04:18.223
> 
> 标签：jsf, richfaces, infinite-scroll

我目前正在介绍我们的网络应用程序的移动友好版本。

在第一步中，我将一个包含很多列的rich:dataTable 转换为一个只包含几列作为值的rich:dataList。

旧表使用分页，我想在新列表中重新使用这个现有机制。但是，在新列表中，我不想分页而是**追加**！因此，当我单击“加载更多”按钮时，我想将新元素附加到已经存在的元素上。但是，追加不应**发生**在服务器端，而应发生在客户端。因为正常的机制是在“加载更多”的支持 bean 的列表上附加元素，然后触发一些重新渲染（例如 via ）。这样做的结果是再次从服务器获取旧数据，这是我不想要的。我只想将新数据（即下一个分页）附加到已经存在的数据中。

有人有想法，我怎么能意识到这一点？

（限制因素：JSF 1.X 和 Richfaces 3.X [结合 jQuery mobile]）

列表分页示例（它是 primefaces，因为我找不到richface 示例）： http: [//www.primefaces.org/showcase/ui/dataListAjax.jsf](http://www.primefaces.org/showcase/ui/dataListAjax.jsf)像这样我想转换成一个无限列表“加载更多”按钮。

非常感谢您对此的帮助和/或想法！

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-22T08:14:17.057

以防万一其他人对此感兴趣......我找到了一个解决方案或更确切地说是一种解决方法：

我介绍了另一个rich:dataList，每次单击“加载更多”时都会重新呈现。“加载更多”按钮是一个“a4j:commandButton”，它的动作会触发分页。最后，我使用它的 oncomplete-attribute 调用一个 JavaScript 函数，该函数通过 jQuery DOM 操作将下一个分页（临时列表）移动到我的主列表中。

它工作得很好

# php - 卷曲慢连接时间

> ID：11143180
> 
> 赞同：6
> 
> 时间：2012-06-21T17:05:08.837
> 
> 标签：php, curl

在我的 VPS 服务器上的 php 文件中考虑以下代码：

```
<?php $url = 'http://www.google.com';
$ch = curl_init();
curl_setopt($ch, CURLOPT_URL, $url);
curl_setopt($ch, CURLOPT_USERAGENT, "Mozilla/5.0 (Windows; U; Windows NT 5.1; rv:1.7.3)     Gecko/20041001 Firefox/0.10.1" );
curl_setopt($ch, CURLOPT_HEADER, 0);
curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);
$content = curl_exec($ch);
$ci = curl_getinfo($ch);
curl_close($ch);
var_dump($ci); ?> 
```

返回这个

```
array(22) { 
["url"]=> string(21) "http://www.google.com" 
["content_type"]=> string(24) "text/html; charset=UTF-8" 
["http_code"]=> int(200) 
["header_size"]=> int(2055) 
["request_size"]=> int(147) 
["filetime"]=> int(-1) 
["ssl_verify_result"]=> int(0) 
["redirect_count"]=> int(0) 
["total_time"]=> float(50.095466) 
["namelookup_time"]=> float(0.001114) 
["connect_time"]=> float(50.019724) 
["pretransfer_time"]=> float(50.019825) 
["size_upload"]=> float(0) 
["size_download"]=> float(23156) 
["speed_download"]=> float(462) 
["speed_upload"]=> float(0) 
["download_content_length"]=> float(-1) 
["upload_content_length"]=> float(0) 
["starttransfer_time"]=> float(50.070702) 
["redirect_time"]=> float(0) 
["certinfo"]=> array(0) { } 
["redirect_url"]=> string(0) 
"" } 
```

在一天中的几次测试之后，“connect_time”始终保持在 50 秒标记处。我相信如果不是在 1 秒及以下，它应该快 10 倍。

我不了解服务器配置，但有人告诉我，我的服务器的 CPU 或 RAM 可能有问题。我使用顶部命令行显示以下内容，这对我来说似乎很好：

> 任务：共 80 个，运行 1 个，睡眠 79 个，停止 0 个，僵尸 0 个
> 
> 中央处理器：0.0%us、0.0%sy、0.0%ni、100.0%id、0.0%wa、0.0%hi、0.0%si、0.0%st
> 
> 内存：总共 2097152k，已使用 1273128k，可用 824024k，0k 缓冲区
> 
> 交换：总共 0k，使用 0k，免费 0k，缓存 0k

我想知道这个问题的根源是什么？

编辑：附加信息

ping www.google.com 结果。似乎它可以一直持续，所以我在第 195 行之后停止了命令

> PING www.l.google.com (74.125.224.178) 56(84) 字节数据。
> 
> 来自 lax02s01-in-f18.1e100.net (74.125.224.178) 的 64 个字节：icmp_seq=1 ttl=56 time=12.0 ms
> 
> 来自 lax02s01-in-f18.1e100.net (74.125.224.178) 的 64 个字节：icmp_seq=2 ttl=56 time=12.1 ms
> 
> 来自 lax02s01-in-f18.1e100.net (74.125.224.178) 的 64 个字节：icmp_seq=3 ttl=56 time=11.9 ms
> 
> ...
> 
> 来自 lax02s01-in-f18.1e100.net (74.125.224.178) 的 64 个字节：icmp_seq=194 ttl=56 time=11.9 ms
> 
> 来自 lax02s01-in-f18.1e100.net (74.125.224.178) 的 64 字节：icmp_seq=195 ttl=56 time=11.9 ms
> 
> --- www.l.google.com ping 统计 --- 发送 195 个数据包，接收 194 个数据包，0% 数据包丢失，时间 194711ms

traceroute wwww.google.com 结果

> 跟踪路由到 www.google.com (74.125.224.180)，最多 30 跳，60 字节数据包
> 
> 1 ip- *-* -*- *.ip.secureserver.net (* .*. *.* ) 0.585 毫秒 0.642 毫秒 0.778 毫秒
> 
> 2 be10.trmd0215-01.ars.mgmt.phx3.gdg (208.109.112.126) 0.599 毫秒 0.777 毫秒 0.893 毫秒
> 
> 3 ip-97-74-253-122.ip.secureserver.net (97.74.253.122) 11.840 毫秒 12.119 毫秒 12.275 毫秒
> 
> 4 ip-97-74-253-122.ip.secureserver.net (97.74.253.122) 12.389 毫秒 12.482 毫秒 12.600 毫秒
> 
> 5 PR01.LAX03.google.com (206.223.123.21) 11.739 毫秒 11.709 毫秒 11.707 毫秒
> 
> 6 209.85.248.185 (209.85.248.185) 11.986 毫秒 11.797 毫秒 11.781 毫秒
> 
> 7 72.14.236.11 (72.14.236.11) 12.606 毫秒 12.363 毫秒 12.328 毫秒
> 
> 8 lax02s01-in-f20.1e100.net (74.125.224.180) 11.774 毫秒 11.864 毫秒 11.842 毫秒

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-06-21T20:47:04.007

尝试：

```
curl_setopt($ch, CURLOPT_IPRESOLVE, CURL_IPRESOLVE_V4 ); 
```

以上将阻止 cURL 先尝试 IPv6。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-21T17:13:20.863

我刚刚运行了您提供的相同配置并得到以下信息：

```
array
  'url' => string 'http://www.google.com' (length=21)
  'content_type' => string 'text/html; charset=UTF-8' (length=24)
  'http_code' => int 200
  'header_size' => int 2079
  'request_size' => int 151
  'filetime' => int -1
  'ssl_verify_result' => int 0
  'redirect_count' => int 0
  'total_time' => float 0.281
  'namelookup_time' => float 0
  'connect_time' => float 0
  'pretransfer_time' => float 0
  'size_upload' => float 0
  'size_download' => float 23168
  'speed_download' => float 82448
  'speed_upload' => float 0
  'download_content_length' => float -1
  'upload_content_length' => float 0
  'starttransfer_time' => float 0.187
  'redirect_time' => float 0
  'certinfo' => 
  array
    empty
  'redirect_url' => string '' (length=0) 
```

我的猜测是您的服务器连接本身可能存在带宽问题和/或被另一个进程以某种方式征税。

# facebook-graph-api - 怎么认识取得这个成就的朋友？

> ID：11143185
> 
> 赞同：1
> 
> 时间：2012-06-21T17:05:35.793
> 
> 标签：facebook-graph-api, achievements

无法找到在成就页面上显示实现它的朋友的方式。

*   /USER_ID/achievements - 返回用户成就
*   /FRIEND_ID/achievements - 返回我朋友的一项成就
*   /APP_ID/achievements - 返回定义列表

请帮帮我！我是否需要为我的每个朋友做很多请求（我认为这不是好方法）？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-22T10:44:11.410

是的，您需要单独检索朋友的成就。

不过，您可以拨打电话`/achievements?ids=[CSV_LIST_OF_FRIENDS]`- 拨打电话`/[USER]/friends?fields=installed`会显示哪些朋友安装了该应用程序，以帮助您限制需要在第一个查询中包含在 CSV 列表中的 ID 数量。

# solr - Solrj 全选

> ID：11143188
> 
> 赞同：0
> 
> 时间：2012-06-21T17:05:57.533
> 
> 标签：solr, lucene

我在通过 Solrj（运行 Tomcat）选择我的 25 个文档 Solr (3.6) 索引中的所有内容时遇到问题。

```
public static void main(String[] args) throws MalformedURLException, SolrServerException { 

        SolrServer solr = new HttpSolrServer("http://localhost:8080/solr");
        ModifiableSolrParams parameters = new ModifiableSolrParams();
        parameters.set("?q", "*:*");
        parameters.set("wt", "json");

        QueryResponse response = solr.query(parameters);
            System.out.println(response); 
    } 
```

我得到的结果是：

```
{responseHeader={status=0,QTime=0,params={?q=*:*,wt=javabin,version=2}},response={numFound=0,start=0,docs=[]}} 
```

另外，如果我选择“？” 我`parameters.set("?q", "*:*");`必须终止编译，否则它会超时。如果我更换

```
"*:*" 
```

只需

```
"*" 
```

另外，我尝试过`parameters.set("qt", "/select");`也无济于事。

您如何选择所有并通过 Solrj 实际获得结果？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-26T14:17:28.667

我不确定为什么会这样，但在一百个想法失败后，这个想法是：

```
public static void main(String[] args) throws MalformedURLException, SolrServerException { 

        SolrServer solr = new HttpSolrServer("http://localhost:8080/solr");
        ModifiableSolrParams parameters = new ModifiableSolrParams();
          parameters.set("q", "*:*"); //query everything thanks to user1452132!
          parameters.set("facet", true);//without this I cant select all
          parameters.set("fl", "id");//send back just the id values
          parameters.set("wt", "json");//Id like this in json format please

        QueryResponse response = solr.query(parameters);
            System.out.println(response); 
    } 
```

希望这可以帮助那里的人。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-21T19:51:39.177

您应该使用“q”作为参数，以下是正确的语法。

```
parameters.set("?q", "*:*"); 
```

它返回 "?q" 的原因是没有要运行的查询，所以它返回得很快。

首先，请通过浏览器进行测试。您还可以设置要返回的行数，这样您就不会返回大型结果集。

```
parameters.set("rows", 5); 
```

一旦 solr 查询返回，您必须对结果进行分页。如果您有大量收藏，您将无法一次性检索所有这些。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-12T08:04:45.217

我认为您应该尝试在引用 SolrServer 对象时也指定您的核心，即写

```
SolrServer solr = new HttpSolrServer("http://localhost:8080/solr/collection1"); 
```

其中 collection1 是您要使用的核心的名称。

# ruby-on-rails-3 - Rails“自动”路线不起作用，每次都必须指定get“控制器/方法”吗？

> ID：11143189
> 
> 赞同：1
> 
> 时间：2012-06-21T17:05:58.290
> 
> 标签：ruby-on-rails-3, routes

我做了

`rails generate controller home index`

但它将此行添加到我的 routes.rb

`get "home/index"`

我认为 Rails 可以自动从 URL 中推断出控制器/方法？为什么我需要指定每个获取/发布页面？

这是我完整的 routes.rb 文件：

```
Callisto2::Application.routes.draw do
  root :to => "home#index"
  resources :assets
end 
```

根“/”工作正常。/assets/* 也是如此。

/home/index 有什么问题？我得到错误：

**路由错误**

`No route matches [GET] "/home/index"`

尝试运行 rake 路线以获取有关可用路线的更多信息。

`rake routes`（以 apache 用户身份运行）给我以下输出：

```
root  / home#index 
```

感谢您的任何澄清。不知道我错过了什么。

编辑：我没有说清楚：我从 routes.rb 手动删除 get /home/index 以保持该文件干净。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-21T17:15:33.043

Rails 用于在路由文件的底部添加所谓的 catch all 路由：

```
match ':controller(/:action(/:id(.:format)))' 
```

这些 url 没有什么“自动”或神奇的，只是每个 rails 应用程序都在他们的 routes.rb 中使用这条路线开始

这已经失宠，至少部分是因为它使一切都可以通过 get 访问，而

```
resources :books 
```

使用适当的 http 动词添加每个路由。与 Rails 刚开始时相比，显式列出路由也少了很多。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-21T17:12:46.013

如果您的控制器是`home`并且动作是`index`您的路径就是`/home`.

[您可以在此处](http://guides.rubyonrails.org/routing.html#crud-verbs-and-actions)找到更多信息。

# asp.net - 连接asp.net中服务器标签中的字段

> ID：11143190
> 
> 赞同：0
> 
> 时间：2012-06-21T17:05:58.473
> 
> 标签：asp.net

我想组合名字和姓氏并将它们呈现在中继器中。以下不连接字符串。我如何让它工作。

```
Text='<%#Eval("FirstName")%>' '<%Eval("LastName")%>' 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-21T17:15:34.140

```
Text='<%# Eval("FirstName") %> <%# Eval("LastName") %>' 
```

或者

```
Text='<%# Eval("FirstName") + " " + Eval("LastName") %>' 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-21T17:14:45.600

尝试：

```
Text='<%#Eval("FirstName") & " " & Eval("LastName")%>' [for VB.Net]

Text='<%#Eval("FirstName") + " " + Eval("LastName")%>' [for C#.Net] 
```

# excel - Outlook 邮件正文为空白

> ID：11143193
> 
> 赞同：0
> 
> 时间：2012-06-21T17:06:23.527
> 
> 标签：excel, vba

我有以下要发送的电子邮件，其中包含我的 Excel 工作表中的一系列单元格。

电子邮件以正确的主题和抄送发送。

该单元格范围（A：B）中有数据，但我无法在体内得到任何东西。它保持空白。

```
Sub SendEmail()

SendEmail Macro

Dim rng As Range
Dim OutApp As Object
Dim OutMail As Object

With Application
    .EnableEvents = False
    .ScreenUpdating = False
End With

Set OutApp = CreateObject("Outlook.Application")
Set OutMail = OutApp.CreateItem(0)

On Error Resume Next
With OutMail
    .To = Sheets("Test1").Range("F2").Value
    .CC = Sheets("Test1").Range("F3").Value
    .BCC = ""
    .Subject = Sheets("Test1").Range("E1").Text
    .Body = Sheets("Test1").Range("A:B")
    .Send
End With
On Error GoTo 0

With Application
    .EnableEvents = True
    .ScreenUpdating = True
End With

Set OutMail = Nothing
Set OutApp = Nothing

End Sub 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-21T17:22:14.710

您的错误捕获隐藏了错误：`13 - Type Mismatch`

您将不得不`.Body`通过遍历值来构造

这是要循环的代码：

```
Dim I As Long
Dim LastRowColA As Long
Dim BodyString As String

BodyString = ""
LastRowColA = Sheets("Test1").Range("A65536").End(xlUp).Row
For I = 1 To LastRowColA
    BodyString = BodyString & Sheets("Test1").Range("A" & I).Value & vbTab & Sheets("Test1").Range("B" & I).Value & vbCrLf
Next I
.Body = BodyString ' instead of = Sheets("Test1").Range("A:B") 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-21T17:20:06.183

尝试改变

```
Sheets("Test1").Range("E1").Text 
```

到

```
Sheets("Test1").Range("E1").Value 
```

# php - 替换字符串以匹配复数或单数

> ID：11143194
> 
> 赞同：3
> 
> 时间：2012-06-21T17:06:28.010
> 
> 标签：php, regex, string

你能帮我用一个函数来替换字符串，如下所示：

该字符串`the boo[k|ks] [is|are] on the table`将输出`the book is on the table`或`the books are on the table`根据一个参数。

```
<?php
    $unformated_str = "the boo[k|ks] [is|are] on the table";
    $plural = true;

    echo formatstr($unformated_str, $plural);
?> 
```

输出：

```
the books are on the table 
```

原谅我糟糕的英语。我希望我的问题足够清楚。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-21T17:13:07.123

这是一个使用的函数[`preg_replace_callback()`](http://php.net/preg_replace_callback)：

```
function formatstr( $unformatted_str, $plural) {
    return preg_replace_callback( '#\[([^\]]+)\]#i', function( $match) use ($plural) {
        $choices = explode( '|', $match[1]);
        return ( $plural) ? $choices[1] : $choices[0];
    }, $unformatted_str);
}

$unformated_str = "the boo[k|ks] [is|are] on the table";

echo formatstr($unformated_str, false); // the book is on the table
echo formatstr($unformated_str, true); // the books are on the table 
```

[试试看](http://codepad.viper-7.com/POWnG2)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-06-26T14:47:23.770

```
function plural (str, num) {// https://gist.github.com/kjantzer/4957176
    var indx = num == 1 ? 1 : 0;
    str = str.replace(/\[num\]/, num);
    str = str.replace(/{(.[^}]*)}/g, function(wholematch,firstmatch){
        var values = firstmatch.split('|');
        return values[indx] || '';
    });
    return str;
}
plural('There {are|is} [num] book{s}.', 21); //"There are 21 books."
plural('There {are|is} [num] book{s}.', 1);  //"There is 1 book. 
```

# video - 让多个用户彼此同步观看视频的方法？

> ID：11143203
> 
> 赞同：1
> 
> 时间：2012-06-21T17:06:48.440
> 
> 标签：video

我们有一个系统，委员会需要讨论和评估视频。现在，每个委员会成员都分别在线观看视频，但他们真正想要的是在参加电话会议时所有人都能够“同步”观看（电话会议不需要成为解决方案的一部分）。所以他们都会去一个给定的页面观看视频，演示者会开始视频，在讨论过程中根据需要暂停视频等，每个参与者都会看到演示者控制的视频。

如果有人可以为我提供有助于构建此类东西的代码或工具的线索，我将不胜感激。我们当前的堆栈主要是 ColdFusion（这意味着我们也可以加载 Java 库）、SQL Server 和 jQuery，但我愿意接受任何想法。

谢谢！

吉姆

# javascript - 在 iframe 中打印 PDF 时 IE9“调用对象无效”

> ID：11143204
> 
> 赞同：8
> 
> 时间：2012-06-21T17:06:58.710
> 
> 标签：javascript, pdf, iframe, acrobat

我在 iframe 中打开一个可编辑的 PDF 表单（通过 acrobat 插件打开）：

```
<iframe name="iframe_content" id="iframe_content" src="mypdf.pdf"></iframe> 
```

有一个按钮调用以下打印函数：

```
function printContent(){
    window.frames["iframe_content"].focus();
    window.frames["iframe_content"].print();
} 
```

它适用于 Chrome、Safari、IE8，但不适用于 IE9。
在 IE9 中，我收到有关该`printContent()`函数的以下错误：

```
Invalid calling object 
```

我认为这可能是让它工作的诀窍，但我不确定如何`window.frames`适应这个结构：http: [//msdn.microsoft.com/en-us/library/ie/gg622930%28v=vs .85%29.aspx](http://msdn.microsoft.com/en-us/library/ie/gg622930%28v=vs.85%29.aspx)

**更新**：决定对于这个单一页面，最简单的解决方案是使用`<meta>`标签强制浏览器进入 IE8 兼容模式和`X-UA-Compatible`

* * *

## 回答 #1

> 赞同：-3
> 
> 时间：2012-06-21T17:25:29.427

您必须将您的打印功能放在 Iframe 的页面中并从父页面调用它。

在 iframe 中：

```
function printMe() {
    window.print()
} 
```

在父级中（假设这是您页面上的第一个 iframe）：

```
frames[0].printMe() 
```

# asp.net - 如何将 CSS 类应用于 ASP.NET 中控件的所有实例

> ID：11143205
> 
> 赞同：0
> 
> 时间：2012-06-21T17:07:04.473
> 
> 标签：asp.net, css, jquery-ui, webforms

我正在尝试为我的 ASP.NET 项目实现 jQuery UI 框架。我想这样做的方法是将 CSS 应用于我的控件。

例如，我有一堆 GridView 控件。有没有一种简单的方法可以一次将 CSS 类应用于所有这些类，而不是像我在网上阅读的那样在每个实例上使用“onRender”事件？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-21T17:10:30.190

您可以创建一个 .skin 文件，指定要应用于每个 GridView 的 CssClass。有关详细信息，请参阅MSDN 库中的[ASP.NET 主题和外观](http://msdn.microsoft.com/en-us/library/ykzx33wh.aspx)。

```
// In your App_Themes/SomeTheme/Default.skin file:
<asp:GridView runat="server" CssClass="YourCssClass" />

// In Web.config:
<pages styleSheetTheme="SomeTheme" /> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-21T17:11:40.517

如果您想将 css 类应用于 GridViews 的所有实例是您的 ASP.NET 应用程序，您可以查看 ASP.NET 主题的外观文件。

[http://msdn.microsoft.com/en-us/library/ykzx33wh.aspx#ThemesAndControlSkins](http://msdn.microsoft.com/en-us/library/ykzx33wh.aspx#ThemesAndControlSkins)

# c++ - std::map - 擦除最后一个元素

> ID：11143214
> 
> 赞同：6
> 
> 时间：2012-06-21T17:07:44.060
> 
> 标签：c++, stl, map, erase

我的地图是这样定义的： `map<string, LocationStruct> myLocations;`其中键是时间字符串

我在这张地图中只保留了 40 件物品，当我达到 40 件物品时，我想放弃地图中的最后一件物品。我知道我做不到`myLocations.erase(myLocations.end())`，那我该怎么做呢？

我确实打算让地图中的最后一项是最旧的，因此是 FIFO。数据将很快进入（大约 20Hz），所以我希望地图能跟上它。我确实需要根据时间查找数据，所以我确实需要它作为关键，但我愿意接受其他方法来实现这一点。

字符串的格式是一个非常冗长的“Thursday June 21 18:44:21:281”，但为了简单起见，我可以将其缩减为自纪元以来的秒数。这是我第一次尝试，还没有过多考虑格式。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-06-21T17:32:30.653

最惯用的方法是：

```
myLocations.erase( std::prev( myLocations.end() ) ); 
```

如果您没有 C++11，请使用工具箱中的相应函数。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2014-01-25T09:05:01.363

试试这个，它有效：

```
map<string, LocationStruct>::iterator it = myLocations.end();
it--;
myLocations.erase(it); 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-06-21T17:14:32.347

我假设当您说“擦除最后一个元素”时，您的意思是“擦除*最旧*的元素”。

我不会使用字符串作为时间，而是使用日期/时间类型（如 unix 时间戳）。然后它们将按时间排序，而不是按字典顺序排序，你可以`myLocations.erase(myLocations.begin())`，因为最旧的总是在开头。

更好的是，使用 a和 use按时间查找元素。这将自动为您删除最旧的，并且在按时间查找元素时具有相同的逻辑复杂度。添加数据时也更快。对于您的情况，这几乎是全赢的。如果您真的想避免，那么 a最适合您的需求，并提供出色的性能，但如果您已经有工作，那么留在 a可能是最好的。[`boost::circular_buffer`](http://www.boost.org/doc/libs/1_49_0/libs/circular_buffer/doc/circular_buffer.html)`<std::pair<timetype, LocationStruct>>`[`std::lower_bound`](http://msdn.microsoft.com/en-us/library/34hhk3zb%28v=vs.71%29.aspx)`boost``std::deque``map``std::map`

以下是如何在 a 中进行查找`deque`：

```
typedef ???? timetype;
typedef std::pair<Timetype, LocationStruct> TimeLocPair
typedef std::deque<TimeLocPair> LocationContainer;
typedef LocationContainer::const_iterator LocationIterator;

bool compareTimeLocPair(const TimeLocPair& lhs, const TimeLocPair& rhs)
{return lhs.first < rhs.first;}

LocationIterator find(const LocationContainer& cont, timetype time) {
    TimeLocPair finder(time, LocationStruct());
    LocationIterator it = std::lower_bound(cont.begin(), cont.end(), finder, compareTimeLocPair);
    if (it == cont.end() || it->first != time)
        return cont.end();
    return it;
} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-06-21T17:17:22.173

好吧，对 g++ 4.4 的快速检查表明这很好用：

```
myLocations.erase(myLocations.rbegin()->first); 
```

虽然我必须承认我不知道为什么它不喜欢只接受迭代器本身。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-21T17:16:32.823

由于您将时间存储为键 String 。最后一个元素（考虑到从 00:00 到 24:00 的时间，一天中最早的时间）将是一个下限元素，因此您可以像这样获取迭代器

```
 `map<string, LocationStruct>::iterator it;`
      it=myLocations.lower_bound ('00:00');
      myLocations.erase ( it, it+1); 
```

但是`if it belongs to different dates`，您甚至需要考虑这一天并相应地修改您的代码。正如您提到`data is coming quick enough`的，您不需要考虑日期。但是`The safe way here would be take the entire date in terms of second and remove the lowest one as mentioned above`。即使新数据到达的频率非常慢，这也会引起注意。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2019-05-23T14:24:42.737

`map::erase`对于没有 TS 绑定的最后一个元素，只需使用以下内容：

```
myLocations.erase ((--myLocations.end())); 
```

# sql-server - 通过批处理脚本运行 SQLCMD 以从存储的事务创建格式化的 XML 文件

> ID：11143215
> 
> 赞同：2
> 
> 时间：2012-06-21T17:08:17.550
> 
> 标签：sql-server, xml, ssms, sqlcmd

我正在尝试使用 SQLCMD 自动化在数据库中运行存储过程的过程。SQL Server Management Studio 2008 安装在 Windows Server 上，这一切都试图在其中发生。SQLCMD 将通过批处理脚本被调用，并被告知执行存储过程并将输出保存到 XML 文件中。我无法显示存储过程，因为它包含敏感材料，但它包含 FOR XML PATH('') 的用法。

我从各种网站阅读了几篇文章，人们说要使用 :XML ON 来获取实际 XML 格式而不是表格格式的输出，以及“-h-1 -y 0”的​​开关以确保输出不会被截断。我正在尝试通过批处理脚本运行 SQLCMD，以便它可以全部自动化。

我当前的批处理脚本（变量都定义在脚本的这一行之前）：

```
 sqlcmd -X -Q -h-1 -y 0 "EXEC %TransactionName%" -d %Database% -S %ServerInstance% -o "%OutFilename%_%currDATE%.xml" 
```

我尝试在事务中添加 :XML ON 并创建一个单独的 SQL 脚本，内容如下：

```
 Run_Transact.sql
    :XML ON
    EXEC storedProcedure 
```

因此批处理文件将读取：

```
 sqlcmd -X -Q -h-1 -y 0 -i runTransact.sql -d %Database% -S %ServerInstance% -o "%OutFilename%_%currDATE%.xml" 
```

我得到了错误：

HResult 0x80004005，级别 16，状态 1 未提供说明

如果我不使用 :XML ON 那么我得到的输出看起来像是表格格式，它包括一个标题以及只有第一条记录，但不是全部（它被截断）。

我的问题是如何让 XML 文件中的输出看起来像 XML 并且不会被截断？

提前非常感谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-06-11T13:10:12.770

这种方法对我有用。我从 xml 列中检索了 2 百万行 xml usinq sqlcmd。我的步骤：

1）使用查询创建文件，这是我的：

```
:XML ON
USE <DB_NAME>
SELECT TOP 1 <COLUMN_NAME> FROM <TABLE>
WHERE <SOMETHING>
FOR XML PATH('') 
```

2）在sqlcmd中执行命令

```
sqlcmd -d <DB_NAME> -i <PATH>\query.sql >result.txt 
```

并在 <> 中替换您需要的内容

在您的情况下，您有存储过程。也许它会引起问题？但是你可以尝试类似的东西；

```
USE<DB_NAME>
DECLARE @XMLV XML
EXEC @XMLV = EXEC StoredProcedure
SELECT @XMLV
FOR XML PATH('') 
```

我知道这个问题已经很老了，但也许它会对某人有所帮助。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2014-04-04T09:53:36.030

```
SELECT ( SELECT 'White' AS Color1,
'Blue' AS Color2,
'Black' AS Color3,
'Light' AS 'Color4/@Special',
'Green' AS Color4,
'Red' AS Color5
FOR
XML PATH('Colors'),
TYPE
),
( SELECT 'Apple' AS Fruits1,
'Pineapple' AS Fruits2,
'Grapes' AS Fruits3,
'Melon' AS Fruits4
FOR
XML PATH('Fruits'),
TYPE
)
FOR XML PATH(''),
ROOT('SampleXML')
GO 
```

# java - Java中引用对象的垃圾收集

> ID：11143217
> 
> 赞同：1
> 
> 时间：2012-06-21T17:08:27.743
> 
> 标签：java

我有以下代码：

```
class Test {
   public static void main(String[] args) {
      String a,b,c;
      a = new String(args[0]);
      b = a;
      a = null;
      b = null;
   }
} 
```

有人可以告诉我什么时候有资格进行垃圾收集。我认为这是在 b 设为 null 之后，因为 a 和 b 不引用同一个对象吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-21T17:11:47.423

`new String(args[0]);`一旦不再有对它的任何引用，您创建的对象, 将有资格被收集。因此，让我们逐步执行代码：

```
a = new String(args[0]); 
```

`a`指向您的字符串，它不符合收集条件。

```
b = a; 
```

`a`并`b`指向您的字符串，不符合条件。

```
a = null; 
```

`b`指向您的字符串，不符合条件。

```
b = null; 
```

没有引用您的字符串，垃圾收集器很高兴！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-21T17:20:52.397

也投出我的答案。正如其他答案所说，一旦不再可访问 String/ 对象（您不再拥有它的句柄），它就可用于垃圾收集。

所以如果你有一个单向链表......`[1] -> [2] -> [3]`并且你有一个句柄`[1]`（它有一个句柄`[2]`）。如果您将句柄设置`[1]`为 null，您会将整个列表提供给垃圾收集器。正如[这个答案](https://stackoverflow.com/a/3315292/1403780)所说，您可以调用 System.gc() 来*请求*垃圾收集器运行，但不能保证它会。

我相信这个答案的主要焦点是当对象*无法访问*时垃圾收集器可以使用对象，这并不一定意味着没有对它的引用。在我上面的例子中，即使有,`[1]`的句柄也可用于垃圾收集器，因为没有.`[2]``[2]``[1]`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-21T17:12:00.267

你是什​​么意思`a`？`a`是一个*参考*，只有*对象*被垃圾收集。

`a`当, 然后引用的字符串`b`不再引用它时，它就有资格进行垃圾收集。在这种情况下，这是在对字符串 (`a`和`b`) 的两个引用都已更改为引用其他内容之后；在这种情况下，`null`。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-21T17:12:21.717

您必须根据分配的对象进行推理：一旦您将和`String`都无效，任何人都不会引用您分配的。从那时起，垃圾收集器有权完成其工作。`a``b`

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-21T17:12:50.243

```
class Test {
   public static void main(String[] args) {
      String a,b,c; // you dont have objects yet
      a = new String(args[0]); // here u make a new object
      b = a; // b references to the same object as a
      a = null; // a points to null, reference is removed.
      b = null; // b point to null, reference is removed
   }
} 
```

在您的程序中，创建并分配给 a 和 b 的对象将在删除引用后被垃圾收集。

垃圾收集器将清理没有根且未被任何东西引用的对象。

# mysql - 随机返回行然后排序

> ID：11143219
> 
> 赞同：0
> 
> 时间：2012-06-21T17:08:33.120
> 
> 标签：mysql, mysqli

我有这个查询，它通过 focus.name ASC 对其进行排序来返回结果。我想对此进行扩展，首先按 rand() 排序，然后按 focus.name 排序并将其限制为 10。

```
$query = mysqli_query($db,"SELECT * FROM vendor_products WHERE 
vendor_products.focus_id IN (SELECT focus.id FROM focus WHERE
focus.name='".mysqli_real_escape_string($db,$focus_name)."' AND 
mydelete='0' ORDER BY focus.name ASC) AND product_id='".mysqli_real_escape_string($db,$product['id'])."' 
AND mydelete='0' ORDER BY focus_id ASC"); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-21T17:17:47.107

做这样的事情

```
select t1.* 
from table t1, (select id from table order by rand() limit 10) t2
where t1.id = T2.id
order by t1.name 
```

看[这里](http://sqlfiddle.com/#!2/a9a82/3)

# c# - SignalR 组 - 在客户端或服务器上处理过滤？

> ID：11143220
> 
> 赞同：15
> 
> 时间：2012-06-21T17:08:33.343
> 
> 标签：c#, asp.net, signalr

我一直在阅读有关 SignalR 集线器和组的大量内容。特别是，我注意到您无法计算特定组中的连接数。

组过滤是在客户端还是服务器上处理？如果是服务器，为什么 SignalR 不能公开计数？如果在客户端，有没有办法只向特定客户端发送消息？

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2012-06-22T16:06:21.977

当您将消息发送到特定连接的特定组时，过滤会在服务器上进行（没有过滤，您只是针对一个连接或组）。

SignalR 基于 pub sub，因此本身没有连接列表。如果要跟踪连接列表，则必须处理连接和断开连接事件并将它们保存在内存或某些持久存储中。

我们不给你一个连接列表的原因是因为我们存储的任何状态都会伤害跨节点的扩展。如果我们给你一个连接列表，这是一个失败的坑，因为如果你向你的农场添加另一个 web 节点，你突然必须在它之间同步状态。我们允许您通过其标识符来处理单个连接或组，这允许我们使用消息总线向该标识符的所有订阅者发布。

# php - yii 使用 CSqlDataProvider 获取数据

> ID：11143224
> 
> 赞同：0
> 
> 时间：2012-06-21T17:08:47.630
> 
> 标签：php, yii

我尝试使用 CSQLDataProvider 获取值，但收到一条错误消息。未定义索引：id K:\yii-1.1.8.r3324\framework\web\CSqlDataProvider.php(116)

这是我的代码

楷模

```
class Product extends CActiveRecord{
...
public function getProductsForIndexPage(){
        $sql = '
            SELECT P.*  FROM Product P, Make M, Company C
            WHERE M.makeId=P.makeId AND C.companyId= P.companyId
        ';
        return new CSqlDataProvider($sql);
}
} 
```

看法

```
$model = new Product(); 
$this->widget('zii.widgets.grid.CGridView', array(
        'dataProvider'=>$model->getProductsForIndexPage(),
        'columns'=>array(
                'name'

        ),
)); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-21T17:15:01.607

尝试这个：

```
 return new CSqlDataProvider($sql, array('keyField' => 'productId')); 
```

Where `'productId'`- 表中的 id 字段`Product`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-07-23T09:44:26.777

```
Try this

In model

public function reportSearch()
    {
        $query = "SELECT * FROM (";

        $countQuery = 'SELECT count(*) FROM (';

        $qryBody = "
            SELECT p_id, name, sum(stock_qty) as stock_qty, sum(sales_qty) as sales_qty, (sum(stock_qty) - sum(sales_qty)) as stock_in_hand FROM 
            ( 
                SELECT p.id as p_id, p.name as name, 0 as stock_qty, 0 as sales_qty FROM jubal.product p where status != 'D'
                UNION 
                SELECT ps.product_id as p_id, '-' as name, sum(ps.qty) as stock_qty, 0 as sales_qty FROM jubal.product_stock ps 
                ".($this->shortDate ? "where ps.purchase_date <= '".Product::dateFormat($this->shortDate)."'" : "")." group by ps.product_id 
                UNION 
                SELECT si.product_id as p_id, '-' as name, 0 as stock_qty, sum(si.quantity) as sales_qty FROM jubal.sales_bill si where status!= 'D'
                ".($this->shortDate ? "AND si.sales_date <= '".Product::dateFormat($this->shortDate)."'" : "")." group by si.product_id
            ) ss GROUP BY p_id 
            ) res";

        $query .= $qryBody;
        /*print_r($query);
        exit();*/
        $countQuery .= $qryBody; 

        $condition = "";
        if(!empty($this->id)){
            $condition .= "p_id like'%". $this->id. "%'";
        }

        if(!empty($this->name)){
            $condition = (!empty($condition) ? $condition." and " : '');
            $condition .= "name like '%". $this->name. "%'";
        }

        if(!empty($this->stock_qty)){
            $condition = (!empty($condition) ? $condition." and " : '');
            $condition .= "stock_qty = '". $this->stock_qty. "'";
        }

        if(!empty($this->sales_qty)){
            $condition = (!empty($condition) ? $condition." and " : '');
            $condition .= "sales_qty = '". $this->sales_qty. "'";
        }

        if(!empty($this->stock_in_hand)){
            $condition = (!empty($condition) ? $condition." and " : '');
            $condition .= "stock_in_hand = '". $this->stock_in_hand. "'";
        }

        $query .= (!empty($condition) ? " where ". $condition : '');

        $countQuery .= (!empty($condition) ? " where ". $condition : '');

       /* print_r($query);
        exit();*/
       /* print_r($countQuery);
        exit();*/

        // SELECT p_id, name, sum(stock_qty) as stock_qty, sum(sales_qty) as sales_qty, (sum(stock_qty) - sum(sales_qty)) as stock_in_hand

        $count=Yii::app()->db->createCommand($countQuery)->queryScalar();
        return new CSqlDataProvider($query, array(
            'totalItemCount'=>$count,
            'keyField' => 'p_id',
            'sort'=>array(
                'attributes'=>array(
                     'p_id', 'name', 'stock_qty', 'sales_qty', 'stock_in_hand'
                ),
            ),
            'pagination'=>array(
                'pageSize'=> Yii::app()->user->getState( 'pageSize', Yii::app()->params[ 'defaultPageSize' ] ),
            ),
        ));
    }

In view page(cgridview)

<?php 
                        $this -> widget('booster.widgets.TbExtendedGridView', 
                            array(
                                'id' => 'Stock-report-grid',
                                'dataProvider' => $model -> reportSearch(),
                                'filter' => $model,
                                'type' => 'bordered condensed',
                                'htmlOptions'=>array('style'=>'0px'),
                                'columns' => 
                                    array(
                                        array(
                                            'header' => 'ID',
                                             'name'=>'p_id',
                                            'value'=>'$data["p_id"]',
                                            'type' => 'raw',
                                            // 'filterHtmlOptions'=>array('style'=>'width: 20%;')
                                            ),
                                        array(
                                            'header' => 'Name',
                                             'name'=>'name',
                                            'value'=>'$data["name"]',
                                            'type' => 'raw',
                                            // 'filterHtmlOptions'=>array('style'=>'width: 20%;')
                                            ),
                                        array(
                                            'header' => 'Stock',
                                             'name'=>'stock_qty',
                                            'value'=>'$data["stock_qty"]',
                                            'type' => 'raw',
                                            // 'filterHtmlOptions'=>array('style'=>'width: 20%;')
                                            ),
                                        array(
                                            'header' => 'Sales',
                                            'name'=>'sales_qty',
                                            'value'=>'$data["sales_qty"]',
                                            'type' => 'raw',
                                            // 'filterHtmlOptions'=>array('style'=>'width: 20%;')
                                            ),
                                        array(
                                            'header' => 'Current Quantity',
                                            'name'=>'stock_in_hand',
                                            'value'=>'$data["stock_in_hand"]',
                                            'type' => 'raw',
                                            // 'filterHtmlOptions'=>array('style'=>'width: 20%;')
                                            ),
                                        array(
                                            'class'=>'bootstrap.widgets.TbButtonColumn',
                                            'template'=>'{showStockHistory}',
                                            'buttons'=>array(
                                                'showStockHistory'=>array(
                                                        'label'=>'',
                                                        'url'=>'$data["p_id"]',
                                                        'options'=>array(
                                                            'title'=>'StockHistory',
                                                            'class'=>'glyphicon glyphicon-folder-open',
                                                            ),
                                                        'click'=>'js:function(evt){
                                                                 evt.stopPropagation();
                                                                 evt.preventDefault();
                                                                 var id = $(this).attr("href");
                                                                 showStockHistory(id);
                                                            }'
                                                    ),
                                            ),
                                        ),
                                    ),
                                )
                            );
                    ?> 
```

# checkstyle - checkstyle-5.5.jar 和 checkstyle-5.5-all.jar 的区别？

> ID：11143225
> 
> 赞同：1
> 
> 时间：2012-06-21T17:08:55.400
> 
> 标签：checkstyle

我最近下载了[checkstyle 5.5 发行版](http://sourceforge.net/projects/checkstyle/files/checkstyle/5.5/)。它包含两个 JAR 文件，*checkstyle-5.5.jar*和*checkstyle-5.5 **-all** .jar*。

这两个 JAR 有什么区别？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-21T23:34:12.807

`checkstyle-5.5.jar`依赖于其他几个`.jar`文件，如`antlr-2.7.7.jar`, `commons-cli-1.2.jar`, `google-collections-1.0.jar`,`commons-beanutils-core-1.8.3.jar`等。

Checkstyle 及其所有依赖项都捆绑在`checkstyle-5.5-all.jar`.

# ajax - 跨子域 AJAX 适用于 Chrome，而不是 IE

> ID：11143226
> 
> 赞同：2
> 
> 时间：2012-06-21T17:08:55.877
> 
> 标签：ajax, internet-explorer, cross-domain-policy

我在 local.mydomain.com 上运行了我的站点的本地版本。我正在向在 AWS 服务器上运行并返回 JSON 的 api.mydomain.com 发出 ajax 请求。在 Chrome 中，我可以调用 API 没有问题。但在 IE 中，我得到拒绝访问。

经过研究，似乎是跨（子）域限制。但我的印象是这个限制将适用于两种浏览器。任何人都可以看到这里可能出了什么问题，以及为什么它可能在某些浏览器中运行而不是在其他浏览器中运行？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-28T21:44:09.390

看起来问题出在 IE8+ 希望您使用的传输对象中。jQuery 使用 ActiveXObject（用于 IE）或 XMLHttpRequest（所有其他），但 IE 8 及更高版本需要用于 ajax 的 XDomainRequest。

你可以做的是像这样通过 $.ajaxSettings.xhr 返回一个自定义的 xhr 对象，

```
// override xhr for browser that use XDR
if ('XDomainRequest' in window && window.XDomainRequest !== null) {

  // override default jQuery transport
  jQuery.ajaxSettings.xhr = function() {
      try { return new XDomainRequest(); }
      catch(e) {
        console.log('test'); 
      }
  };

  // also, override the support check
  jQuery.support.cors = true;
} 
```

我从这里的主题讨论中提取了这段代码：http: [//graphicmaniacs.com/note/getting-a-cross-domain-json-with-jquery-in-internet-explorer-8-and-later/](http://graphicmaniacs.com/note/getting-a-cross-domain-json-with-jquery-in-internet-explorer-8-and-later/)

如果您认为自己遇到了同样的问题，请务必查看一下。

# objective-c - 让按钮覆盖其他进程

> ID：11143228
> 
> 赞同：1
> 
> 时间：2012-06-21T17:09:03.767
> 
> 标签：objective-c, ios, cocoa-touch, uibutton, viewdidappear

在我的应用程序中，根视图控制器从 Internet 获取信息，对其进行解析，并将其显示在`viewDidAppear`. 我使用这种方法是因为我的应用程序嵌入在 a 中`UINavigationController`，这样当用户按下后退按钮并弹出到根视图时，根视图控制器将重新加载其数据。

发生这种情况时，需要一些时间来获取和显示来自 Internet 的信息。在此期间，如果用户单击按钮移动到不同的视图，则在视图控制器完成获取 Web 数据的过程之前，不会发生按钮动作。

我怎样才能使按钮覆盖其他进程并立即切换视图？这安全吗？提前致谢。

**编辑**

这是我从站点中获取信息的部分示例（我的应用程序解析 HTML）。

```
NSURL *siteURL = [NSURL URLWithString:@"http://www.ridgefield.org/ajax/dist/emergency-announcements"];
NSError *error;
NSString *source = [NSString stringWithContentsOfURL:siteURL 
                                            encoding:NSUTF8StringEncoding
                                               error:&error]; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-21T17:14:48.923

这是苹果人会追捕的地方，“不要阻塞主线程！”。

这种工作流的主要建议是使用单独的线程（读取：队列）从网络加载数据。然后完成加载的工作人员可以在您的视图控制器上设置一些属性，并且在该设置器内部是应该更新 UI 的地方。请记住在主线程上调用 setter。

有几种方法可以剥去并发猫的皮肤，但是这个特定问题的答案使它们超出了范围。简短的回答是不要在主线程中加载，这应该会引导你到正确的地方。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-21T17:24:34.890

NSString 方法 stringWithContentsOfURL 是同步的，会阻塞你的主线程。

您可以使用异步 URL 请求，而不是使用后台线程来解决问题。这不会阻塞用户界面，因为委托协议用于让您知道请求何时完成。例如：

```
 NSURL *url = [NSURL URLWithString:@""http://www.ridgefield.org/ajax/dist/emergency-announcements""];
        NSMutableURLRequest *request = [NSMutableURLRequest requestWithURL:url];
        NSURLConnection* theConnection = [[NSURLConnection alloc] initWithRequest:request delegate:self]; 
```

然后你的一些委托方法是：

```
-(void)connection:(NSURLConnection*)connection didReceiveResponse:(NSURLResponse*)theResponse
{
    // create received data array
    _receivedData = [[NSMutableData alloc] init]; 
}

-(void)connection:(NSURLConnection*)connection didReceiveData:(NSData*)theData
{
    // append to received data.
    [_receivedData appendData:theData];
}

-(void)connectionDidFinishLoading:(NSURLConnection*)connection
{
    // now the connection is complete
    NSString* strResult = [[NSString alloc] initWithData: _receivedData encoding:NSUTF8StringEncoding];

    // now parse strResult
} 
```

# ruby-on-rails - 将单个复杂应用程序拆分为单独的应用程序是否有利于代码库的可维护性？

> ID：11143229
> 
> 赞同：3
> 
> 时间：2012-06-21T17:09:04.493
> 
> 标签：ruby-on-rails, architecture

我是 Rails 应用程序的主要开发人员，该应用程序允许客户管理艺术家作品集网站。系统需要四种截然不同的行为类型：

*   **管理员**行为，允许登录用户管理其投资组合的内容
*   **投资组合显示**行为，将用户的投资组合呈现给一般访问者
*   **转化漏斗**行为，显示有关服务的信息并吸引新用户注册
*   **超级管理员**行为，向服务所有者显示其他三种行为的统计信息

目前，这四组行为被分解为命名空间控制器——但它们都共享相同的模型。我想知道，由于系统的四个部分几乎不共享任何行为，将应用程序拆分为四个单独的应用程序或引擎是否有任何好处（并将任何共享行为提取到 gems 中。）

例如，处理用户统计数据的系统部分不需要“知道”渲染 YouTube 嵌入到投资组合中，处理显示投资组合的系统部分不需要“知道”A/B测试，处理注册新用户的系统部分除了注册新用户之外不需要“了解”很多其他内容。

此外，我想解决的一个具体问题是，我希望没有经验的团队成员能够为处理注册新用户的网站部分贡献一点代码。如果在站点的该部分中将一两个错误推送到生产环境中，这不会是世界末日，但在显示用户投资组合的系统部分中不允许生产中的错误是非常重要的。

那么，就代码库的可维护性和易读性而言，将这四个组件分成单独的应用程序是否有意义？这样做会在多大程度上简单地将复杂性推入系统的不同层而不消除它？通过创建更清晰解耦的类和模块可以更好地实现这种类型的分离吗？

非常感谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-22T04:34:07.043

半**隔离引擎**将实现您允许孤岛代码工作的目标，并且您可以轻松共享所有资源，例如样式表（这可能很重要，因为您仍然提供一项服务）。

可**安装的引擎**也可以实现您的目标，但共享更加困难，因为它似乎最好作为孤立的。

具有许多面向功能的应用程序向一个或多个前端应用程序提供 API 的面向**服务的架构可能会起作用。**前期工作会更多，但从长远来看，如果您看到整体服务随着时间的推移变得更加复杂，它可能会带来回报。

有趣的选择！

# javascript - Android 应用程序的“共享图像”按钮

> ID：11143232
> 
> 赞同：0
> 
> 时间：2012-06-21T17:09:15.440
> 
> 标签：javascript, android, facebook, html, twitter

假设我有一个 Android html5 应用程序，其中包含使用 Javascript 生成的图片，方法是将画布传递给 base64，然后将其附加到 DOM。我想在我的应用程序中添加一些按钮，以便至少在 Twitter 和 Facebook 中共享该图像。

我也已经看到了如何用 Java 触发“Intent”对话框。有没有办法用 Javascript 做到这一点？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-21T23:38:24.573

你用PhoneGap吗？如果是这样，[试试这个](http://mobile.dzone.com/articles/example-intents-phonegap)。

您无法从常规网页触发 Intent 对话。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-21T23:39:14.687

如果您的应用程序具有嵌入式`WebView`，您可以使用 javascript 桥来触发本机共享对话框。

Android 文档有更多信息：http: [//developer.android.com/reference/android/webkit/WebView.html](http://developer.android.com/reference/android/webkit/WebView.html)

我发表了关于创建 javascript 桥的演讲。以下是幻灯片： [http ://www.sqisland.com/talks/progressive-webview](http://www.sqisland.com/talks/progressive-webview)

# c# - XmlNode 一直说没有节点但有

> ID：11143233
> 
> 赞同：1
> 
> 时间：2012-06-21T17:09:21.560
> 
> 标签：c#, xml, get

```
using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Drawing;
using System.Linq;
using System.Net;
using System.Text;
using System.Windows.Forms;
using System.Xml;

namespace WindowsFormsApplication1
{
    public partial class Form1 : Form
    {
        public Form1()
        {
            InitializeComponent();
        }

        private void Plus_Click(object sender, EventArgs e)
        {
            string FValue = id.Text;
            string SValue = id2.Text;
            string ending;
            string url = "http://localhost:56254/api/add?id=" + FValue + "&id2=" + SValue;
            WebClient client = new WebClient();
            client.Headers["User-Agent"] = "Mozilla/5.0 (Windows NT 6.1) AppleWebKit/535.1 (KHTML, like Gecko) Chrome/14.0.835.202 Safari/535.1";
            client.Headers["Accept"] = "text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8";
            string data = client.DownloadString(url);
            XmlDocument xdoc = new XmlDocument();

            xdoc.LoadXml(data);
   -->      XmlNode xnode = xdoc.SelectSingleNode("End");
            ending = xnode.InnerText;
            Answer.Text = ending;
        }
    }
} 
```

这是我的代码，它在结束时一直给我一个空值，如果我在箭头处放置一个断路器，它会告诉我 count = 0。这是我的 xml：

```
- <Calcs xmlns:i="http://www.w3.org/2001/XMLSchema-instance" xmlns="http://schemas.datacontract.org/2004/07/Calculator.Models">
              <End>10</End> 
              <FValue>5</FValue> 
              <SValue>5</SValue> 
  </Calcs> 
```

当我打电话给 End 时，它一直告诉我没有节点被称为 End.... 并且一直给我 null 我做错了什么吗？ [http://i45.tinypic.com/24cgkld.png](http://i45.tinypic.com/24cgkld.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-21T17:14:25.710

该`SelectSingleNode`方法需要一个 XPath 表达式，试试这个：

```
XmlNode xnode = xdoc.SelectSingleNode("//End"); 
```

编辑：这是一个命名空间问题，请尝试以下操作：

```
XmlDocument xdoc = new XmlDocument();
xdoc.LoadXml(xml);

XmlNamespaceManager nsmgr = new XmlNamespaceManager(xdoc.NameTable);
nsmgr.AddNamespace("cm", "http://schemas.datacontract.org/2004/07/Calculator.Models");

XmlNode xnode = xdoc.SelectSingleNode("//cm:End", nsmgr); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-21T17:17:01.793

```
XmlNode xnode = doc.SelectSingleNode("Calcs/End"); 
```

# java - 将android UI xml转换为代码

> ID：11143236
> 
> 赞同：3
> 
> 时间：2012-06-21T17:09:24.747
> 
> 标签：java, android, xml, user-interface

所以，我正在尝试制作一个动态 UI，并且我想为其添加一个分隔符。不幸的是，我只能找出如何用 XML 做一个。可以转这个吗

```
<ImageView
    xmlns:android="http://schemas.android.com/apk/res/android"
    android:id="@+id/seperator"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:paddingBottom="2dp"
    android:paddingLeft="5dp"
    android:paddingRight="5dp"
    android:paddingTop="2dp"
    android:scaleType="fitXY"
    android:src="@android:drawable/divider_horizontal_dark" /> 
```

进入程序代码？

我最好的尝试是

```
ImageView seperator=new ImageView(this);
seperator.setImageDrawable(drawable.divider_horizontal_dark); 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-21T17:13:06.583

将它放在一个额外的布局文件中，并在您需要时在代码中对其进行扩充 - 我认为您想要做的应该是最简单的方法。

在您的活动中：

```
View v = LayoutInflater.from(this).inflate(R.layout.seperator, null); 
```

如果你膨胀一个布局：

```
LinearLayout ll = (LinearLayout) LayoutInflater.from(this).inflate(R.layout.custom_layout, null);
TextView tv = (TextView) ll.findViewById(R.id.tv); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-05-07T07:38:06.367

有一个网站可以为您转换。您可以设计界面，`eclipse`然后将生成的 xml 提交到[XMLtoJAVA](http://www.xmltojava.com)在线转换器，它应该会为您完成。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-21T17:37:32.623

您还可以创建视图，定义背景并使用 LayoutParams 添加它

```
 ViewGroup container = (ViewGroup) findViewById(R.id.container); 
    View separator = new View(context);
    separator.setBackgroundColor(Color.Black);
    LayoutParams layoutParams = new LayoutParams(LayoutParams.MATCH_PARENT, 2);

    container.addView(separator, layoutParams); 
```

# jquery - jquery modal 对话框只显示一次

> ID：11143237
> 
> 赞同：0
> 
> 时间：2012-06-21T17:09:28.583
> 
> 标签：jquery, jquery-ui

我知道有多个关于此的帖子，但我仍然无法正确处理。我尝试了很多组合。当您单击按钮时，我正在尝试创建一个对话框。对话框内部是一个表单，但现在这并不重要。我可以让对话框显示一次，但不能在第二次单击时显示。这是我现在所拥有的：

```
var $dialog = $('#cameraform').dialog({
    modal:true,
    autoOpen: false,
    resizable:false,
    width: 625,
    close: function() {
        $(this).remove();
    }
}); //init dialog

//events            
$('.addwebcam').click(function(e) {
    $dialog.dialog('open');
}); 
```

HTML：

```
<button class="addwebcam">Add Webcam</button>
<div id="cameraform" title="Add a camera">
...//my form
</div> 
```

我也尝试过在点击事件中初始化对话框，但这根本不起作用。我究竟做错了什么。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-21T17:16:24.027

这行代码不

> $(this).remove();

从 DOM 中删除您的对话框？

我想关闭对话框，你会使用：

> $( 这个 ).dialog( "关闭" );

# ssl - SSL 证书细节

> ID：11143239
> 
> 赞同：3
> 
> 时间：2012-06-21T17:09:47.507
> 
> 标签：ssl

我一直在阅读 SSL 如何工作的技术基础知识（在外行/非技术文章/教程/视频的**海洋中很难找到）。**我有 3 个小问题，它们本身感觉太小，无法将 SO 弄乱，但总的来说，我认为提供了一些关于 SSL 工作原理的见解，并解决了似乎没有充分记录的问题：

1.  **为什么**（不是*何时*或*如何*！）SSL 证书过期？这些只是在 AES 等密码/算法上运行的公钥/私钥对。我认为这里有幕后的财务/商业动机？！？

2.  一个组织需要多少 SSL 证书？在你说“这取决于你的组织”之前，我想这个问题的核心是：**是什么驱动因素**让公司说，哦，我想我们需要*另一个*证书，或者 10 个以上的证书，等等。换句话说：**为什么 1 个证书对于一个组织来说通常是不够的？**

3.  为什么公司要求 CA 提供根证书，然后从该根中获取子证书？这个“证书树”有什么好处？（而不是仅仅获得单独的证书。）？

提前致谢！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-21T17:35:13.960

> 1) 为什么 SSL 证书会过期？

当证书过期时，您基本上是在说这个公钥/私钥对已被放弃。从技术上讲，您仍然可以使用此证书来加密数据，但到期日期是为了减少撤销等。但是，此外，在 X.509 规范中列出了到期的具体原因：

```
4.1.2.5 Validity

The certificate validity period is the time interval during which the
CA warrants that it will maintain information about the status of the
certificate. 
```

CA 发布有关证书的吊销状态信息，这意味着他们需要跟踪它们。当证书过期时，CA 已在证书期限内完成了自己的工作，并停止跟踪该证书的信息。您实际上是在向 CA 支付费用以授权该证书有效。

过期还有其他原因。如果我仍在使用 2002 年签署的证书（这是可能的），加密级别可能达不到今天使用的标准。通过为证书设置端点，您还可以设置需要升级的日期。

现在，当然，我认为你不能否认到期背后的最大动力之一是金钱[需要引用]，但它背后至少有一些技术和合理的想法。

> 2) 一个组织需要多少 SSL 证书/哪些驱动因素帮助他们做出决定？

它确实取决于您的组织。传统 SSL 证书与域名匹配。但是，任何东西都可以使用密钥对（开发人员证书等）进行签名。因此，对于 SSL，它取决于您要保护的域的数量。对于传统证书，www.domain.com 和 example.domain.com 是完全不同的实体。还可以购买其他类型的证书，例如通配符证书等，具体取决于您的业务需求。说真的，你可能会变得非常复杂或非常简单。以下是保护网站的一些基本和不同类型的概要：[SSL 证书类型](http://www.sslshopper.com/special-ssl-certificate-types.html)

> 3) [拥有]“证书树”提供什么好处，而不是仅仅获得单独的证书？

你基本上是说你信任这个 CA 来生成证书。这就是为什么浏览器必须安装根 CA 才能接受证书的原因。他们说，“我相信这个机构只为有效和受信任的来源签署了证书。”

在实践中，最终并非如此，因为许多 CA 在颁发证书之前没有严格检查他们向谁提供证书。并非总是如此，但它确实减轻了一些危险。问题是当 CA 根证书私钥被泄露时，因为任何人都可以伪造合法证书。

希望这能回答你的一些问题。

# python - Python 正则表达式匹配或标记

> ID：11143243
> 
> 赞同：2
> 
> 时间：2012-06-21T17:09:54.973
> 
> 标签：python, regex, tokenize

我有一个数据结构的转储，我正在尝试将其转换为 XML。该结构中有许多嵌套结构。所以我有点不知道如何开始，因为我能想到的所有正则表达式都不适用于嵌套表达式。

例如，假设有这样的结构转储：

```
abc = (  
        bcd = (efg = 0, ghr = 5, lmn = 10), 
        ghd = 5, 
        zde = (dfs = 10, fge =20, dfg = (sdf = 3, ert = 5), juh = 0)) 
```

我想得到这样的输出：

```
< abc >
  < bcd >   
    < efg >0< /efg >  
    < ghr >5< /ghr >  
    < lmn >10< /lmn >  
  < /bcd >  
.....  
< /abc > 
```

那么什么是一个好的方法呢？标记表达式、聪明的正则表达式还是使用堆栈？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-21T17:16:21.473

使用 pyparsing。

```
$ cat parsing.py 
from pyparsing import nestedExpr

abc = """(  
        bcd = (efg = 0, ghr = 5, lmn 10), 
        ghd = 5, 
        zde = (dfs = 10, fge =20, dfg = (sdf = 3, ert = 5), juh = 0))"""
print nestedExpr().parseString(abc).asList()

$ python parsing.py
[['bcd', '=', ['efg', '=', '0,', 'ghr', '=', '5,', 'lmn', '10'], ',', 'ghd', '=', '5,', 'zde', '=', ['dfs', '=', '10,', 'fge', '=20,', 'dfg', '=', ['sdf', '=', '3,', 'ert', '=', '5'], ',', 'juh', '=', '0']]] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-21T21:43:32.410

这是一个更习惯使用 pyparsing 的替代答案。因为它为可以看到什么输入以及应该返回什么结果提供了详细的语法，所以解析的数据并不“混乱”。因此`toXML()`不需要努力工作，也不需要做任何真正的清理工作。

```
print "\n----- ORIGINAL -----\n"

dump = """
abc = (  
        bcd = (efg = 0, ghr = 5, lmn 10), 
        ghd = 5, 
        zde = (dfs = 10, fge =20, dfg = (sdf = 3, ert = 5), juh = 0))
""".strip()

print dump

print "\n----- PARSED INTO LIST -----\n"

from pyparsing import Word, alphas, nums, Optional, Forward, delimitedList, Group, Suppress

def Syntax():
    """Define grammar and parser."""

    # building blocks
    name   = Word(alphas)
    number = Word(nums)
    _equals = Optional(Suppress('='))
    _lpar   = Suppress('(')
    _rpar   = Suppress(')')

    # larger constructs
    expr = Forward()
    value = number | Group( _lpar + delimitedList(expr) + _rpar )
    expr << name + _equals + value

    return expr

parsed = Syntax().parseString(dump)
print parsed

print "\n----- SERIALIZED INTO XML ----\n"

def toXML(part, level=0):

    xml = ""
    indent = "    " * level
    while part:
        tag     = part.pop(0)
        payload = part.pop(0)

        insides = payload if isinstance(payload, str) \
                          else "\n" + toXML(payload, level+1) + indent

        xml += "{indent}<{tag}>{insides}</{tag}>\n".format(**locals())

    return xml

print toXML(parsed) 
```

输入和 XML 输出与我的其他答案相同。返回的数据`parseString()`是唯一真正的变化：

```
----- PARSED INTO LIST -----

['abc', ['bcd', ['efg', '0', 'ghr', '5', 'lmn', '10'], 'ghd', '5', 'zde',
['dfs', '10', 'fge', '20', 'dfg', ['sdf', '3', 'ert', '5'], 'juh', '0']]] 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-21T18:54:32.553

我喜欢 Igor Chubin 的“使用 pyparsing”答案，因为一般来说，正则表达式对嵌套结构的处理非常差（尽管 thg435 的迭代替换解决方案是一个聪明的解决方法）。

但是一旦 pyparsing 完成了它的工作，您就需要一个例程来遍历列表并发出 XML。它需要对 pyparsing 的结果的缺陷保持智能。例如，`fge =20,`不会产生`['fge', '=', '20']`你想要的，但是`['fge', '=20,']`. 有时也会在无用的地方添加逗号。我是这样做的：

```
from pyparsing import nestedExpr

dump = """
abc = (  
        bcd = (efg = 0, ghr = 5, lmn 10), 
        ghd = 5, 
        zde = (dfs = 10, fge =20, dfg = (sdf = 3, ert = 5), juh = 0))
"""

dump = dump.strip()

print "\n----- ORIGINAL -----\n"
print dump

wrapped = dump if dump.startswith('(') else "({})".format(dump)
parsed = nestedExpr().parseString(wrapped).asList()

print "\n----- PARSED INTO LIST -----\n"
print parsed

def toXML(part, level=0):

    def grab_tag():
        return part.pop(0).lstrip(",")

    def grab_payload():
        payload = part.pop(0)
        if isinstance(payload, str):
            payload = payload.lstrip("=").rstrip(",")
        return payload

    xml = ""
    indent = "    " * level
    while part:
        tag     = grab_tag() or grab_tag()
        payload = grab_payload() or grab_payload()
        # grab twice, possibly, if '=' or ',' is in the way of what you're grabbing

        insides = payload if isinstance(payload, str) \
                          else "\n" + toXML(payload, level+1) + indent

        xml += "{indent}<{tag}>{insides}</{tag}>\n".format(**locals())

    return xml

print "\n----- SERIALIZED INTO XML ----\n"
print toXML(parsed[0]) 
```

导致：

```
----- ORIGINAL -----

abc = (  
        bcd = (efg = 0, ghr = 5, lmn 10), 
        ghd = 5, 
        zde = (dfs = 10, fge =20, dfg = (sdf = 3, ert = 5), juh = 0))

----- PARSED INTO LIST -----

[['abc', '=', ['bcd', '=', ['efg', '=', '0,', 'ghr', '=', '5,', 'lmn', '10'], ',', 'ghd', '=', '5,', 'zde', '=', ['dfs', '=', '10,', 'fge', '=20,', 'dfg', '=', ['sdf', '=', '3,', 'ert', '=', '5'], ',', 'juh', '=', '0']]]]

----- SERIALIZED INTO XML ----

<abc>
    <bcd>
        <efg>0</efg>
        <ghr>5</ghr>
        <lmn>10</lmn>
    </bcd>
    <ghd>5</ghd>
    <zde>
        <dfs>10</dfs>
        <fge>20</fge>
        <dfg>
            <sdf>3</sdf>
            <ert>5</ert>
        </dfg>
        <juh>0</juh>
    </zde>
</abc> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-21T18:12:43.070

我不认为正则表达式是这里最好的方法，但对于那些好奇的人来说，可以这样做：

```
def expr(m):
    out = []
    for item in m.group(1).split(','):
        a, b = map(str.strip, item.split('='))
        out.append('<%s>%s</%s>' % (a, b, a))
    return '\n'.join(out)

rr = r'\(([^()]*)\)'
while re.search(rr, data):
    data = re.sub(rr, expr, data) 
```

基本上，我们反复用`(no parens here)`xml 块替换最下面的括号，直到没有更多的括号。为简单起见，我也将主要表达式包含在括号中，如果不是这种情况，请`data='(%s)' % data`在解析之前执行。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-21T20:01:45.523

您可以使用`re`模块来解析嵌套表达式（尽管不推荐）：

```
import re

def repl_flat(m):
    return "\n".join("<{0}>{1}</{0}>".format(*map(str.strip, s.partition('=')[::2]))
                     for s in m.group(1).split(','))

def eval_nested(expr):
    val, n = re.subn(r"\(([^)(]+)\)", repl_flat, expr)
    return val if n == 0 else eval_nested(val) 
```

### [例子](http://ideone.com/Ld4Ug)

```
print eval_nested("(%s)" % (data,)) 
```

### 输出

```
<abc><bcd><efg>0</efg>
<ghr>5</ghr>
<lmn>10</lmn></bcd>
<ghd>5</ghd>
<zde><dfs>10</dfs>
<fge>20</fge>
<dfg><sdf>3</sdf>
<ert>5</ert></dfg>
<juh>0</juh></zde></abc> 
```

# ruby-on-rails-3 - 使用 Capistrano 部署 Rails 3.2.6 应用程序时遇到问题

> ID：11143245
> 
> 赞同：1
> 
> 时间：2012-06-21T17:10:03.437
> 
> 标签：ruby-on-rails-3, postgresql, deployment, capistrano

我已经使用 nginx、passenger、ruby 1.9.3-p194 和 rails 3.2.6 正确设置了我的 Linode VPS。我构建了一个简单的 Cap 配方（见下文），它通过了 deploy:setup 和 deploy:check 但在资产预编译阶段失败。我会尝试在远程服务器上手动运行预编译，但 Cap 回滚，所以我不能这样做。

该错误看起来像一个 PG 错误，但是我已经根据我的 database.yml 设置手动测试了与服务器的连接，它运行良好。知道这可能是什么吗？

```
deploy.rb
require "bundler/capistrano"

server "50.116.25.145", :web, :app, :db, primary: true

set :application, "exigencad"
set :user, "deploy"
set :deploy_to, "/home/#{user}/#{application}"
set :deploy_via, :remote_cache
set :use_sudo, false

set :scm, "git"
set :repository, "git@github.com:teknull/#{application}.git"
set :branch, "master"

default_run_options[:pty] = true
ssh_options[:forward_agent] = true

after "deploy", "deploy:cleanup" # keep only the last 5 releases

namespace :deploy do
  task :start do ; end
  task :stop do ; end
  task :restart, :roles => :app, :except => { :no_release => true } do
    run "#{try_sudo} touch #{File.join(current_path,'tmp','restart.txt')}"
  end
end

task :after_update_code do  
run "ln -nfs #{deploy_to}/shared/config/database.yml #{release_path}/config/database.yml"
end

after :deploy, "assets:precompile"

Error from Capistrano:
executing `deploy:assets:precompile'
  * executing "cd /home/deploy/exigencad/releases/20120621170601 && bundle exec rake RAILS_ENV=production RAILS_GROUPS=assets assets:precompile"
    servers: ["50.116.25.145"]
    [50.116.25.145] executing command
 ** [out :: 50.116.25.145] rake aborted!
 ** [out :: 50.116.25.145] FATAL:  Peer authentication failed for user "exigen"
 ** [out :: 50.116.25.145] 
 ** [out :: 50.116.25.145] Tasks: TOP => environment
 ** [out :: 50.116.25.145] 
 ** [out :: 50.116.25.145] (See full trace by running task with --trace)
    command finished in 6433ms
*** [deploy:update_code] rolling back 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-25T16:06:33.883

might be totally unrelated to your problem, but since i just hit the same error while running cap deploy:migrate i'll mention it. did you set host: localhost for your production db in database.yml? adding that line fixed the problem for me.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-10-24T14:54:31.640

尝试添加`config.assets.initialize_on_precompile = false`到您的**application.rb**文件中，这对我有帮助。

# android - 检测蓝牙设备何时在 Android 上消失

> ID：11143247
> 
> 赞同：0
> 
> 时间：2012-06-21T17:10:06.993
> 
> 标签：android, listview, bluetooth, android-arrayadapter

我正在创建一个简单的应用程序，它将通过蓝牙进行通信。我已经创建了一个简单的活动，列出了附近打开了蓝牙的设备，但不幸的是，我不知道如何检测到某些设备何时从蓝牙网络中消失（bt 被关闭），以便我可以从名单。

这是我编写的将附近的 BT 设备添加到 ListView 的代码：

```
mNewDevicesArrayAdapter = new BluetoothDeviceArrayAdapter(this, 0, new ArrayList<BluetoothDevice>());

lvDiscovered = (ListView)findViewById(R.id.bt_dev_discovered_list);
lvDiscovered.setAdapter(mNewDevicesArrayAdapter);

...

// The BroadcastReceiver that listens for discovered devices and
// changes the title when discovery is finished
private final BroadcastReceiver mReceiver = new BroadcastReceiver() {
      @Override
      public void onReceive(Context context, Intent intent) {
          String action = intent.getAction();
          if (BluetoothDevice.ACTION_FOUND.equals(action)) {
              // Get the BluetoothDevice object from the Intent
              BluetoothDevice device = intent.getParcelableExtra(BluetoothDevice.EXTRA_DEVICE);
              // If it's already paired, skip it, because it's been listed already
              if (device.getBondState() != BluetoothDevice.BOND_BONDED) {
                  mNewDevicesArrayAdapter.add(device);
              }
          // When discovery is finished, change the Activity title
          } else if (BluetoothAdapter.ACTION_DISCOVERY_FINISHED.equals(action)) {
              // TODO show no devices found!
          }              
      }
  }; 
```

当设备消失时，我发现没有适用的 ACTION 意图。也许可以使用 ACTION_DISCOVERY_FINISHED，但是如何使用呢？

提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-21T20:35:49.250

我找到了一种从先前发现的列表中删除这些设备的简单方法。

在上面扩展我的代码时，我介绍了一个`update list`存储新发现设备的位置。当`ACTION_DISCOVERY_FINISHED`出现时，我将`ListView`使用此更新列表进行更新。

```
...
private ArrayList<BluetoothDevice>   btDevicesUpdateList;
...

// The BroadcastReceiver that listens for discovered devices and
// changes the title when discovery is finished
private final BroadcastReceiver mReceiver = new BroadcastReceiver() {
    @Override
    public void onReceive(Context context, Intent intent) {
        String action = intent.getAction();
        if (BluetoothDevice.ACTION_FOUND.equals(action)) {                  
            // Get the BluetoothDevice object from the Intent
            BluetoothDevice device = intent.getParcelableExtra(BluetoothDevice.EXTRA_DEVICE);

            // If it's already paired, skip it, because it's been listed already
            // in the paired devices list
            if (device.getBondState() != BluetoothDevice.BOND_BONDED) {
                if(mNewDevicesArrayAdapter.getCount() == 0){
                   // if the list is empty we add the device immediately to it
                    mNewDevicesArrayAdapter.add(device);
                }
                btDevicesUpdateList.add(device);                      
             }
        }
        else if (BluetoothAdapter.ACTION_DISCOVERY_FINISHED.equals(action)) {
           mNewDevicesArrayAdapter.setItems(btDevicesUpdateList);
           btDevicesUpdateList.clear();
           mBtAdapter.startDiscovery();
        }
    }
}  

// BluetoothDeviceArrayAdapter.java
public void setItems(ArrayList<BluetoothDevice> items){
    this.items.clear();
    this.items.addAll(items);
} 
```

不可用的设备将不在列表中。

# java - 在 Java 中强制解析 xsl:include、xsl:import

> ID：11143248
> 
> 赞同：0
> 
> 时间：2012-06-21T17:10:07.917
> 
> 标签：java, xslt, saxon

我正在使用 Saxon 9.3 HE 和 Java 1.6。我可以通过在实例上提供解析器来解析 xsl 中的语句`xsl:include`。`xsl:import``setURIResolver``TransformerFactory`

但是，`Source resolve(String includee, String includer)`如果文件之前已解析，则不会调用该方法。这对我来说是个问题，因为我想根据`includer`文件进行不同的解决。例如`<xsl:include href="foo.xsl"/>`in`file1.xsl`将是与`<xsl:include href="foo.xsl"/>`in不同的文件`file2.xsl`，`file1.xsl`并且`file2.xsl`将包含在`file3.xsl`. 我有一些“基本”代码和“客户特定”代码可以覆盖模板文件，我需要为我正在构建的框架以不同的方式解决它们。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-25T20:14:03.947

XSLT 规范很清楚，必须根据处理相对 URI 的标准规则来解析 href 属性中的相对 URI 与包含元素的基本 URI，而取消引用生成的绝对 URI 可以通过实现喜欢的任何方式来完成。我建议重新考虑您的设计以考虑到这一点。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-21T23:15:10.263

我会预料到，因为其中包含的两个 XSL 具有不同的基本 URI，因此需要为每个基本 URI 调用 URIResolver（如果它们位于不同的目录中怎么办？）。

为 file1.xsl 和 file2.xsl 创建源时，它们的系统 ID 是什么？如果它们为空，存在于同一目录中或没有任何路径信息（即 systemId 只是`file1.xsl`and `file2.xsl`），则可能 Saxon 正在尝试通过假设它们位于同一目录中来进行优化，因此假设`foo.xsl`每个都引用的是同一个文件。

也许尝试显式[设置基础文件源的 systemId](http://docs.oracle.com/javase/6/docs/api/javax/xml/transform/Source.html#setSystemId%28java.lang.String%29)并使它们具有不同的目录？

# django - Django：我可以将模板变量的输出映射到另一个字符串吗？

> ID：11143249
> 
> 赞同：1
> 
> 时间：2012-06-21T17:10:09.973
> 
> 标签：django, django-templates

我正在使用 Django 的通用视图，特别是`django.views.generic.date_based.archive_month`.

此视图将模板上下文设置为包含`date_list`其中包含相关 python`datetime.datetime`对象的列表。（见[https://docs.djangoproject.com/en/1.4/ref/generic-views/#django-views-generic-date-based-archive-month](https://docs.djangoproject.com/en/1.4/ref/generic-views/#django-views-generic-date-based-archive-month)）

这是我使用此视图的简单模板：

```
<html>
        <head>
                <title>Entries index</title>
        </head>
        <body>
                <h1>Entries index by month: {{ month|date:"F" }}</h1>
                <h2>Day:</h2>
                {% for datetime_object in date_list %}
                        <ul><a href="/weblog/{{ year }}/{{ month.month }}/{{ datetime_object.day }}/">{{ datetime_object.day }}</a></ul>
                {% endfor %}
        </body>
</html> 
```

我的问题是，虽然我可以得到数字月份，比如 3 表示三月，但我的网址设置为使用三个字母表示，即`mar`三月，所以该`<a href=`块没有指向正确的网址。

如何设置映射以将每个月的数值映射到它们的三个字母表示？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-21T22:16:37.837

您可以使用带有格式字符[的内置`date`模板标签。](https://docs.djangoproject.com/en/dev/ref/templates/builtins/?from=olddocs#date) 应用示例如下： `b`

```
<ul>
  <!-- whitespace added below solely for readability 
       I do not recommend adding such whitespace in your code -->
  <a href="/weblog/{{ year }}/{{ month|date:"b" }}/{{ datetime_object.day }}/">
    {{ datetime_object.day }}
  </a>
</ul> 
```

# java - 在 Java 中比较 int 和 long 是否可以

> ID：11143253
> 
> 赞同：62
> 
> 时间：2012-06-21T17:10:33.437
> 
> 标签：java, long-integer

在Java中比较int和long是否可以...

```
long l = 800L
int i = 4

if (i < l) {
 // i is less than l
} 
```

* * *

## 回答 #1

> 赞同：106
> 
> 时间：2012-06-21T17:12:23.337

是的，没关系。将`int`隐式转换为 a `long`，这始终可以在不丢失任何信息的情况下完成。

* * *

## 回答 #2

> 赞同：-4
> 
> 时间：2018-08-08T09:49:23.977

您可以直接比较 long 和 int ，但**不建议这样做。**
在比较之前最好将 long 转换为整数，因为 long 值可以高于 int 限制

```
long l = Integer.MAX_VALUE;       //2147483647
int i = Integer.MAX_VALUE;        //2147483647
System.out.println(i == l);       // true
 l++;                             //2147483648
 i++;                             //-2147483648
System.out.println(i == l);       // false
System.out.println(i == (int)l);  // true 
```

# maven - Maven 程序集 - 创建 zip 的 zip

> ID：11143254
> 
> 赞同：0
> 
> 时间：2012-06-21T17:10:43.057
> 
> 标签：maven, plugins, zip, maven-assembly-plugin

如何使用 Maven 程序集创建 zip 的 zip 并安装包含其他 zip 的 zip？

例如，我需要创建 A.zip、B.zip、C.zip，最后要安装一些 D.zip（包含 A、B 和 C）。

当我有以下内容时，会发生什么是 Maven 创建了所有 A、B、C 和 D zip 文件，但它随机安装了一个 zip（从某种意义上说它安装了 B.zip 而我想要 D.zip 到安装）。

任何建议如何解决这个问题？

```
<executions>
                    <execution>
                        <id>A</id>
                        <phase>package</phase>
                        <goals>
                            <goal>single</goal>
                        </goals>                        
                    </execution>
                    <execution>
                        <id>B</id>
                        <phase>package</phase>
                        <goals>
                            <goal>single</goal>
                        </goals>                        
                    </execution>
                    <execution>
                        <id>C</id>
                        <phase>package</phase>
                        <goals>
                            <goal>single</goal>
                        </goals>                        
                    </execution>
                    <execution>
                        <id>D</id>
                        <phase>package</phase>
                        <goals>
                            <goal>single</goal>
                        </goals>                        
                    </execution>
                </executions> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-21T19:53:09.100

我建议将 a、b 和 c 放入 prepare-package 阶段而不是 package 阶段，而 D 将留在 package 阶段。您必须更改 A、B 和 C 的配置，如下所示：

```
<execution>
  <id>A</id>
  <phase>prepare-package</phase>
  <goals>
    <goal>single</goal>
  </goals>
  <configuration>
    <attach>false</attach>
  </configuration>
</execution> 
```

保持 D 的配置不变。

# reportviewer - RDLC 子报表过滤器错误

> ID：11143256
> 
> 赞同：0
> 
> 时间：2012-06-21T17:10:45.940
> 
> 标签：reportviewer, rdlc, reportviewer2008

我在 Report Viewer 2008 中使用本地报告。

我正在尝试做一些我认为应该非常简单的事情。我有一个子报表，我想对其进行一些过滤。我想做一个skip/take功能，虽然我什至不能让最基本的过滤器工作。

子报表有一个矩阵。我尝试将过滤器添加到报表数据源（报表 -> 数据源... -> 属性... -> 过滤器）和矩阵本身。除非我对过滤器执行 =true 之类的操作，否则我会收到错误消息，无法显示子报表。

例如，我的数据源中有一个名为 Order 的整数。我以为我可以做 =Fields!Order.Value > 1 ，这将使报告使用除第一行之外的每一行，但我得到子报告错误。

在调试器中运行应用程序将显示报告警告输出。我期待一些更有帮助的东西，但没有运气......

警告：执行子报表“ImageSubreport”时出错：报表处理过程中出错。(rsErrorExecutingSubreport)

我以前使用过很多过滤器，所以我有点困惑为什么这不起作用。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-21T18:09:03.853

我想我开始有所收获了。我想我可以将我的过滤器写成一个大表达式，并在过滤器编辑器中将其与真/假进行比较。我将我的简单过滤器表达式更改为 =Fields!Order.Value，在下拉列表中选择“>”，然后将比较设置为 =CInt(1)。我认为关键主要是 CInt 调用。不过，我仍在尝试将其调整为我的特定过滤器，但我认为我可以到达那里。

# sqlite - SQLite：如何找到行数的每日/每周/每月/每年平均值

> ID：11143264
> 
> 赞同：2
> 
> 时间：2012-06-21T17:11:20.673
> 
> 标签：sqlite, csv

我刚刚开始学习 SQLite，并且有一个问题。

这是我的意思的一个例子。

这是我的 CSV：

```
date
2010-10-24
2010-10-31
2010-11-01
2011-02-14
2011-02-15
2011-02-16
2011-10-01
2012-01-15
2012-05-12
2012-05-14
2012-08-12
2012-08-26 
```

我的代码：

```
SELECT STRFTIME('%Y-%m', date) AS 'month', COUNT() AS 'month_count'
    FROM tableName 
    GROUP BY STRFTIME('%Y-%m', date); 
```

结果（以逗号分隔的形式）：

```
month, month_count
2010-10, 2
2010-11, 1
2011-02, 3
2011-10, 1
2012-01, 1
2012-05, 2
2012-08, 2 
```

我现在正在寻找的是一种获取每月“month_count”平均数的方法，这当然与“month_count”的平均值不同。也就是说，前者等于0.55，而后者等于1.71，我正在尝试计算前者。

我尝试使用 AVG(COUNT())，尽管这显然没有逻辑意义。

我猜我必须将代码生成的表存储为临时文件，然后从中获取平均值，尽管我不确定如何正确编写它。

有谁知道我错过了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-21T17:17:37.517

试试下面的代码：

```
create table test(date date);
insert into test values ('2010-10-24');
insert into test values ('2010-10-31');
insert into test values ('2010-11-01');
insert into test values ('2011-02-14');
insert into test values ('2011-02-15');
insert into test values ('2011-02-16');
insert into test values ('2011-10-01');
insert into test values ('2012-01-15');
insert into test values ('2012-05-12');
insert into test values ('2012-05-14');
insert into test values ('2012-08-12');
insert into test values ('2012-08-26');

SELECT a.tot_months 
     , b.month_diff
     , cast(a.tot_months as float) / b.month_diff avg_count
  FROM (SELECT COUNT(*) tot_months FROM test) a
     , (SELECT cast((strftime('%m',max(date))+12*strftime('%Y',max(date))) as int) -
               cast((strftime('%m',min(date))+12*strftime('%Y',min(date))) as int) as 'month_diff'
          FROM test) b
; 
```

输出：

```
C:\scripts>sqlite3 < foo.sql
12|22|0.545454545454545 
```

# c# - 用户控件的基本使用，关闭一个用户控件并打开另一个，用户控件参数

> ID：11143269
> 
> 赞同：0
> 
> 时间：2012-06-21T17:11:41.797
> 
> 标签：c#, user-controls, parameters

女士们先生们，不幸的是，我再次用新手的东西来打扰你们。我已经搜索了几个小时的信息，所以如果有一个我想要的线程，它的埋藏比我能找到的更深。

[这](https://stackoverflow.com/questions/10934425/in-c-sharp-winforms-how-can-i-get-rid-of-the-childs-control-bar)是我在这里的第一个问题，Mark Hall 很友好地让我直截了当。从那时起，我创建了一个新项目，并将我的前三个屏幕重新创建为用户控件——一个容器/登录、一个选择屏幕和一个主屏幕（当前为空）。如果用户拥有多个集合，则会弹出选择屏幕并允许他们选择一个集合。

我确实遇到了参数问题，但我通过重载表单声明来解决这个问题（解决方案在这里找到）——是的，我知道通过调用发送参数要好得多，但我不想必须创建一个调用对于每个参数（我是吗？）和......好吧，好吧，我比{get，set}更擅长这个。伙计，我讨厌成为新手。

无论如何，我在选择表单时遇到了问题——我似乎无法调用它，关闭它，然后转到主表单。我直接进入主表单没有问题（如果只有一个集合），那就是该死的选择表单。是的，我知道我可以选择 datagridview，但我们的一些最终用户不是工具棚中最锋利的灯泡，需要手持。无论如何，这是代码。

容器/登录屏幕

```
namespace DeleteThis
{
    public partial class ContainerForm : Form
    {
        Main Main = new Main();
        LoginCollectionChoice LoginChoice = new LoginCollectionChoice();
        DataTable dtPermissions = new DataTable();
        public ContainerForm()
        {
            InitializeComponent();
            Main.ExitEvent += new Main.ExitEventHandler(Main_ExitEvent);
            LoginChoice.ExitEvent += new
            LoginCollectionChoice.ExitEventHandler(LoginChoice_ExitEvent);
        }

        void LoginChoice_ExitEvent(object sender, EventArgs e)
        {
            pnlcontainer.Controls.Remove(LoginChoice);
        }

        void Main_ExitEvent(object sender, EventArgs e)
        {
            pnlcontainer.Controls.Remove(Main);
        }

    private void btnLogin_Click(object sender, EventArgs e)
    {
        LoginProcedure();
    }

    private void LoginProcedure()
    {
        DataTable dtPermissions = AdminClass.GetCollectionsForUser(int.Parse(txtbxUserName.Text));
        if (dtPermissions.Rows.Count == 1)
        {
            //Valid user, one collection.  Head right in.
            pnlcontainer.Controls.Add(Main);
            Main.BringToFront();
        }
        else
        {
            //More than one collection found.  Giving user choice
            LoginCollectionChoice LoginChoice = new LoginCollectionChoice(dtPermissions);

            pnlcontainer.Controls.Add(LoginChoice);
            LoginChoice.BringToFront();

        }
    }

    private void btnExitProgram_Click(object sender, EventArgs e)
    {
        this.Close();
    }
} 
```

}

我希望我没有在剪断中杀死任何东西。现在是选择屏幕……</p>

```
public partial class LoginCollectionChoice : UserControl
{
    public delegate void ExitEventHandler(object sender, EventArgs e);
    public event ExitEventHandler ExitEvent;
    private static DataTable dtPermit;
    DataTable dtPermissions = new DataTable();

    public LoginCollectionChoice()
    {
    }

    public LoginCollectionChoice(DataTable dtPermissions)
    {
        InitializeComponent();
        GrdCollection.DataSource = dtPermissions;
        dtPermit = dtPermissions;
    }

    private void btnChoose_Click(object sender, EventArgs e)
    {
    //Code for the user to choose a collection
    ExitEvent(this, new EventArgs());
    }
} 
```

我已经剪掉了所有不相关的代码，希望各位先生女士们可以帮助这个新手走上正确的道路。求你了，温柔点，你不会想看到我哭吧？：） 哦！如果你知道任何很棒的教程网站，请发邮件给我。我宁愿花一周的时间在教程上，也不愿花一周的时间在这里磕磕绊绊和提问。非常感谢大家。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-21T17:19:28.107

你在调用 logonForm.Show() 吗？

看来您需要以这种方式展示它。

您使用了 BringToFront()，但我认为它需要首先显示。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-21T17:21:53.743

我首先想到的是你在打电话

```
LoginCollectionChoice LoginChoice = new LoginCollectionChoice(dtPermissions); 
```

它正在创建一个名为 LoginChoice 的局部变量，即使它们共享相同的名称，它也与您的类变量不同。

您要做的是不在该方法中声明局部变量。将该行更改为

```
LoginChoice = new LoginCollectionChoice(dtPermissions); 
```

话虽如此，我相信 tylerjgarland 你需要先调用 .Show() 。而且你关闭表格的方式肯定很奇怪。我会创建一个表单，showDialog，获取结果，然后以这种方式关闭表单。

# ios - 使用 Google Analytics 和 Adob e Air for iOS 访问数据问题

> ID：11143270
> 
> 赞同：0
> 
> 时间：2012-06-21T17:11:44.447
> 
> 标签：ios, air, google-analytics, adobe

我们在通过 Adob​​e Air 移植的 iOS 应用程序中使用 GA for Flash，并且看到 Google Analytics 中收集了一些时髦的数字。我们进行了一些测试，发现每次打开应用程序时，它都会计算一次新访问和一次新的唯一访问，即使它只是最小化并重新打开。

我们假设 30 分钟的超时将在这里生效，即使快速最小化并重新打开，GA 也会将其视为一次访问。情况似乎并非如此。

有谁知道我们如何设置 GA 实现以根据首次启动应用程序时提供的用户 ID 记录唯一访问，和/或让它准确计算访问次数？

有没有人见过类似的东西？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-22T10:49:12.067

Google Analytics allows you to set up [Custom Events](https://developers.google.com/analytics/devguides/collection/gajs/eventTrackerGuide#SettingUpEventTracking) to track user interactions so this could be dispatched depending on a flag stored in a config file (to determine if it is the first time the application is run).

Depending on your implementation of Air, i.e AS3 / Javascript, if you are using AS3 you may have to utilise the [ExternalInterface](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/flash/external/ExternalInterface.html) api to call a javscript method from the application.

This would then allow you to track these custom events and ignore the erroneous default visits?

# html - 相对于另一个 DIV 定位 DIV？

> ID：11143273
> 
> 赞同：53
> 
> 时间：2012-06-21T17:11:50.217
> 
> 标签：html, css

是否可以相对于另一个 DIV 定位 DIV？我想这可以通过首先将其放在参考 DIV 中，然后使用`position: relative`. 但是，我无法弄清楚如何在不影响参考 DIV 的内容的情况下执行此操作。我怎样才能正确地做到这一点？

见：http: [//jsfiddle.net/CDmGQ](http://jsfiddle.net/CDmGQ)

* * *

## 回答 #1

> 赞同：96
> 
> 时间：2012-06-21T17:14:31.413

首先将`position`父 DIV 设置为（不需要`relative`指定偏移量，即`left`等），然后使用所需的偏移量应用于子 DIV。 这很简单，应该做得很好。`top``position: absolute`

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-06-21T17:19:48.823

您需要设置`postion:relative`外部 DIV 和位置：内部 div 的绝对值。
试试这个。这是[演示](http://jsfiddle.net/CDmGQ/4/)

```
#one
{
    background-color: #EEE;
    margin: 62px 258px;
    padding: 5px;
    width: 200px;
    position: relative;   
}

#two
{
    background-color: #F00;
    display: inline-block;
    height: 30px;
    position: absolute;
    width: 100px;
    top:10px;
}​ 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-06-21T17:15:38.847

您想`position: absolute`在另一个 div 内使用。

[演示](http://jsfiddle.net/CDmGQ/1/)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2017-05-18T12:00:52.487

您可以`position:relative;`在#one div 和`position:absolute`#two div 内使用。 [你可以看到](http://jsfiddle.net/wUrdM/)

# azure - 在 Azure 辅助角色的 onStart 方法中捕获异常？

> ID：11143280
> 
> 赞同：5
> 
> 时间：2012-06-21T17:12:29.120
> 
> 标签：azure, azure-storage, azure-blob-storage, azure-worker-roles

我遇到了一个问题，我的部署循环通过回收。从 Visual Studio：

“在更新或升级操作期间，角色实例被回收了一定次数。这表明您的服务的新版本或您在配置服务时提供的配置设置阻止了角色实例的运行。最可能的原因是您的代码引发未处理的异常。请考虑修复您的服务或更改配置设置，以便角色实例不会引发未处理的异常。然后开始另一个更新或升级操作。在您开始另一个更新或升级操作之前，Windows Azure 将继续尝试将您的服务更新到您提供的新版本或配置”

我的问题：捕获异常的最佳方法是什么？我对 C# 有点陌生。我的 onStart 的精简版以防万一：

```
public override void Run()
    {
        // This is a sample worker implementation. Replace with your logic.
        Trace.WriteLine("WorkerRole1 entry point called", "Information");

        while (true)
        {
            Thread.Sleep(10000);
            Trace.WriteLine("Working", "Information");
        }
    }

public override bool OnStart()
    {

        // Set the maximum number of concurrent connections 
        ServicePointManager.DefaultConnectionLimit = 12;

        // Retrieve storage account from Connection String
        CloudStorageAccount storageAccount = CloudStorageAccount.Parse(CloudConfigurationManager.GetSetting("StorageConnectionString"));

        // Create blob client
        CloudBlobClient blobClient = storageAccount.CreateCloudBlobClient();

        // retrieve reference to container (blob resides within container)
        CloudBlobContainer container = blobClient.GetContainerReference("mycontainer");

        // create container if it doesn't already exist
        container.CreateIfNotExist();

        // make container public *temp*
        container.SetPermissions(new BlobContainerPermissions { PublicAccess = BlobContainerPublicAccessType.Blob });

        // Retrieve references to required blobs
        CloudBlob batch = container.GetBlobReference("batch.bat");

        // Download batch file
        using (var fileStream = System.IO.File.OpenWrite(@"C:\batch.bat"))
        {
            zip.DownloadToStream(fileStream);
        }

        // run batch file

        System.Diagnostics.Process proc = new System.Diagnostics.Process();
        proc.StartInfo.FileName = "C:\\batch.bat";
        proc.StartInfo.RedirectStandardError = false;
        proc.StartInfo.RedirectStandardOutput = false;
        proc.StartInfo.UseShellExecute = false;
        proc.Start();
        proc.WaitForExit();

        return base.OnStart();
    }
} 
```

}

此外，如果它有帮助，这里是来自 RDP 的堆栈跟踪：

```
Stack:

at System.IO.__Error.WinIOError(Int32, System.String)
at System.IO.FileStream.Init(System.String, System.IO.FileMode, System.IO.FileAccess, Int32, Boolean, System.IO.FileShare, Int32, System.IO.FileOptions, SECURITY_ATTRIBUTES, System.String, Boolean, Boolean)
at System.IO.FileStream..ctor(System.String, System.IO.FileMode, System.IO.FileAccess, System.IO.FileShare, Int32, System.IO.FileOptions, System.String, Boolean)
at System.IO.FileStream..ctor(System.String, System.IO.FileMode, System.IO.FileAccess, System.IO.FileShare)
at System.IO.File.OpenWrite(System.String)
at WorkerRole1.WorkerRole.OnStart()
at Microsoft.WindowsAzure.ServiceRuntime.RoleEnvironment.InitializeRoleInternal(Microsoft.WindowsAzure.ServiceRuntime.Implementation.Loader.RoleType)
at Microsoft.WindowsAzure.ServiceRuntime.Implementation.Loader.RoleRuntimeBridge.<InitializeRole>b__0()
at System.Threading.ExecutionContext.Run(System.Threading.ExecutionContext, System.Threading.ContextCallback, System.Object, Boolean)
at System.Threading.ExecutionContext.Run(System.Threading.ExecutionContext, System.Threading.ContextCallback, System.Object)
at System.Threading.ThreadHelper.ThreadStart() 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-21T18:08:45.320

我在云端的博[文 Printf("HERE")](http://blog.smarx.com/posts/printf-here-in-the-cloud)可能会有所帮助。本质上，将整个事情包装在 try/catch 中并记录错误。

# tfs - 刷新 TFS 进程模板

> ID：11143281
> 
> 赞同：0
> 
> 时间：2012-06-21T17:12:29.213
> 
> 标签：tfs, tfs-workitem, tfs-process-template

我创建了一个带有更改的工作项的自定义 TFS 流程模板。在我将模板上传到 TFS 并开始测试新流程后，我意识到我忘记了其中一个工作项的一些状态转换。我更改了 XML 以包含新的转换状态，并将流程模板再次上传到 TFS。但是，新的过渡状态仍未出现在状态下拉列表中。我还需要做些什么来刷新工作项或流程模板，以便新的过渡状态出现在状态下拉列表中？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-21T18:26:00.743

[您必须按照此处](https://stackoverflow.com/a/11121611/147211)所述从 Team Explorer 刷新 TFS 数据。

# apache - mod_rewrite 在子目录中

> ID：11143284
> 
> 赞同：4
> 
> 时间：2012-06-21T17:12:46.570
> 
> 标签：apache, mod-rewrite

我们的网络服务器结构如下

```
/path-to-docdir     [Contains main pages]
        ./app/      [Some application not directly related to the main content] 
```

主要页面服务良好。在应用程序目录中，我尝试使用 mod_rewrite 将所有页面重定向到`index.php`公共目录中

所以请求

```
/server/app/start/login/ => /server/app/public/index.php 
/server/app/start/login  => /server/app/public/index.php
/server/app/start/login?name=someone => /server/app/public/index.php?name=someone 
```

前端控制器依赖于`REQUEST_URI`字符串的最后两个组件来解释控制器和动作。

为此，我在目录中创建了以下`.htaccess`文件`app`

```
<IfModule mod_rewrite.c>
  RewriteEngine On
  RewriteRule ^$     public/   [L]
  RewriteRule ^(.*)$ public/$1 [L]
</IfModule> 
```

在这里，我发现服务器进入了上述 URL 的重定向循环。我尝试替换`$1`为`index.php`并且确实打开了页面，但是页面内对脚本文件的内部引用遇到了错误。

经过一番搜索，我添加了以下行：

```
RewriteBase /app/ 
```

这似乎没有任何区别。我还应该注意，如果我将 app 目录设为服务器根目录，一切都会按预期工作。

我还打开了调试日志记录，我可以从中收集到的只是服务器确实进入了重定向循环。

```
[perdir /path-to-docdir/app/] 内部重定向 /app/public/public/public/public/public/public/public/public/public/public/public/start/login/ [INTERNAL REDIRECT]

```

我不确定从哪里开始研究这一点，因此非常感谢任何帮助或让我更进一步的指示。

编辑：

这个 htaccess 文件对我有用 - 如果其他人正在寻找解决方案。显然，我错过了重写条件

```
<IfModule mod_rewrite.c>
RewriteEngine On
RewriteCond %{SCRIPT_FILENAME} !-f
RewriteCond %{SCRIPT_FILENAME} !-d
RewriteRule ^(.*)$ public/index.php?$1 [L]
</IfModule> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-21T21:17:33.177

几点：

路径不需要`RewriteBase`尾部斜杠，所以`RewriteBase /app/`应该是`RewriteBase /app`.

`RewriteRule ^(.*)$ public/$1`变得`RewriteRule ^$ public/`多余。前者将匹配`http://yourserver/app`并在内部重写为`http://yourserver/app/public`，因此不需要后者。

最后，尝试添加重写条件：

```
RewriteEngine On
RewriteBase /app
RewriteCond %{REQUEST_URI} !^/app/public/
RewriteRule ^(.*)$ public/$1 [L] 
```

# jquery - Uploadifive jQuery Upload 非flash版本

> ID：11143295
> 
> 赞同：1
> 
> 时间：2012-06-21T17:13:17.070
> 
> 标签：jquery, uploadify

我使用名为uploadifive的jQuery Upload库uploadify非Flash版本我安装了它但是当你点击浏览/选择文件按钮时出现一个奇怪的问题没有任何其他问题遇到这个问题，如果是这样如何解决谢谢。HTML 基本上很简单，只是上传输入和一个 div 标签

```
 $(function() {
  $('#file_upload').uploadifive({
    'debug'             : true,
    'auto'              : true,
    'formData'          : {'test' : 'something'},
    'queueID'           : 'queue',
    'buttonText'        : 'ATTACH FILE',
    'uploadScript'      : '".base_application_url()."upload_license/',
    'onUploadComplete'  : function(file, data) {
    console.log(data);
     });
}); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-18T14:57:21.800

# tl;博士

将您的代码更改为：

```
$(function() {
  $('#file_upload').uploadifive({
    'debug'             : true,
    'auto'              : true,
    'formData'          : {'test' : 'something'},
    'queueID'           : 'queue',
    'buttonText'        : 'ATTACH FILE',
    'uploadScript'      : '/upload_license',
    'onUploadComplete'  : function(file, data) {
      console.log(data);
    },
    'onFallback': function(){
      alert('HTML5 is not supported in this browser.');
    }
  });
}); 
```

# 说明

我一直在使用 Uploadifive，效果很好。尽管他们的示例和文档都使用 PHP，但我在 .NET 中也很容易使用它。

我在您的代码中看到的第一个问题是`uploadScipt`值，它相当于`action`HTML 表单中的属性。我可以看到您正在尝试从 获取绝对 URL `".base_application_url()."upload_license/`，但您只需要相对 URL，例如`/upload_license`or `/upload_license.php`。我将它与 .NET MVC4 一起使用，所以我`uploadScript`的设置为`/upload`.

另一种可能是您的浏览器可能不支持 HTML5 版本（可能已过时）。为了方便测试，请在初始化上传器时添加此选项

```
'onFallback': function () {
    alert('HTML5 is not supported in this browser');
} 
```

如果 Uploadifive 不受支持，此代码将显示警报。如果是这种情况，请同时下载 flash 版本并在`onFallback`回调中对其进行初始化。

# c - 调用函数后检测到 C 堆栈粉碎

> ID：11143297
> 
> 赞同：0
> 
> 时间：2012-06-21T17:13:27.367
> 
> 标签：c, stack-overflow, stack-smash

有一个对我来说毫无意义的问题。所以这里是：

我有一个函数可以计算一个单词在文件中出现的次数，因此这个函数返回一个整数（int）。所以在另一个函数上它使用“计数器”。现在由于某种原因，它决定开始启动堆栈粉碎检测到的错误。我已经对整个程序进行了 2 周的测试，它运行得非常完美。现在我得到了那个错误，这真的没有意义。世界上到底发生了什么？错误就在那里，在函数有计数器并返回后，它会启动堆栈粉碎检测到的错误。

编辑：我一直在搜索，是的，当返回一个 int 函数时，我得到一个堆栈粉碎检测错误。有任何想法吗？如果我取出该代码，它不会崩溃。真的我不知道

有什么建议吗？

谢谢...

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-21T17:51:58.797

我可以建议使用调试信息编译您的程序并在[Valgrind](http://www.valgrind.org/)下运行它吗？另请参阅[此相关问题](https://stackoverflow.com/q/2307233/507519)。

如果您需要它，我在我[的旧答案中](https://stackoverflow.com/a/4297799/507519)发布了一些关于使用 Valgrind 的提示。

# javascript - 小胡子 JS 表格条纹

> ID：11143298
> 
> 赞同：5
> 
> 时间：2012-06-21T17:13:37.627
> 
> 标签：javascript, templates, mustache

几个小时前我已经开始使用“Mustache JS”。我想知道是否有办法在 tr 中添加一个类以使表格条带化。我知道我可以检测到变量的值是 null 还是 undefined，但事实并非如此。变量中总会有一个值。有没有办法做到这一点？

我启动并运行了以下代码：

**模板：**

```
template = "\
        {{#tr}}\
            <tr>\
                <td>{{tit}}</td>\
                <td>{{ord}}</td>\
                <td>{{prazo}}</td>\
                <td>{{id}}</td>\
            </tr>\
        {{/tr}}"; 
```

**风景：**

```
view = {
                "tr" : [
                    {
                        id : val.ID, 
                        ord : val.Ordem, 
                        prazo : val.Prazo, 
                        tit : val.Título
                    }
                ]
            }; 
```

我知道我可以在视图中设置一个功能。但不知道如何在其中正确设置一个mod，用于条带化。任何帮助都会很棒。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-21T22:12:46.047

我已经这样做了：

**模板：**

```
template = "\
        {{#tr}}\
            <tr class="{{even_or_odd}}">\
                <td>{{tit}}</td>\
                <td>{{ord}}</td>\
                <td>{{prazo}}</td>\
                <td>{{id}}</td>\
            </tr>\
        {{/tr}}"; 
```

**视图：（类似这样，假设您可以为 iteratorValue 设置一个值）**

```
var interatorValue == 0;
// your other code
view = {
                "tr" : [
                    {
                        id : val.ID, 
                        ord : val.Ordem, 
                        prazo : val.Prazo, 
                        tit : val.Título,
                        even_or_odd: ((iteratorValue % 2 == 0) ? 'even' : 'odd')
                    }
                ]
            };
iteratorValue++; 
```

然后添加 css for`tr.odd`和`tr.even`.

# java - 如何使用poi将作者姓名设置为excel文件

> ID：11143303
> 
> 赞同：21
> 
> 时间：2012-06-21T17:13:53.507
> 
> 标签：java, apache-poi

我正在使用 poi (java) 创建一个 excel (.xlsx) 文件。创建excel文件后，我看到excel文件作者为“Apache POI”。有什么办法可以改变吗？

这是我用来创建excel文件的代码...

```
import java.io.FileOutputStream;

import org.apache.poi.ss.usermodel.Cell;
import org.apache.poi.ss.usermodel.Row;
import org.apache.poi.ss.usermodel.Sheet;
import org.apache.poi.xssf.usermodel.XSSFWorkbook;

public class CreateExcelFile {

    public static void main(String[] args) {
        /** Name of excel file that we are going to create **/
        String fileName = "C:\\temp\\testPOIWrite.xlsx";
        writeDataToExcelFile(fileName);
    }

    /** This method writes data to new excel file **/
    private static void writeDataToExcelFile(String fileName) {

        String[][] excelData = preapreDataToWriteToExcel();

        XSSFWorkbook myWorkBook = new XSSFWorkbook();
        Sheet mySheet = myWorkBook.createSheet();
        Row myRow = null;
        Cell myCell = null;

        for (int rowNum = 0; rowNum < excelData[0].length; rowNum++) {
            myRow = mySheet.createRow(rowNum);

            for (int cellNum = 0; cellNum < 4; cellNum++) {
                myCell = myRow.createCell(cellNum);
                myCell.setCellValue(excelData[rowNum][cellNum]);
            }
        }

        try {
            FileOutputStream out = new FileOutputStream(fileName);
            myWorkBook.write(out);
            out.flush();
            out.close();
        } catch (Exception e) {
            e.printStackTrace();
        }

    }

    /** Prepare some demo data as excel file content **/
    public static String[][] preapreDataToWriteToExcel() {
        String[][] excelData = new String[4][4];
        excelData[0][0] = "First Name";
        excelData[0][1] = "Last Name";
        excelData[0][2] = "Telephone";
        excelData[0][3] = "Address";

        excelData[1][0] = "Kushal";
        excelData[1][1] = "Paudyal";
        excelData[1][2] = "000-000-0000";
        excelData[1][3] = "IL,USA";

        excelData[2][0] = "Randy";
        excelData[2][1] = "Ram Robinson";
        excelData[2][2] = "111-111-1111";
        excelData[2][3] = "TX, USA";

        excelData[3][0] = "Phil";
        excelData[3][1] = "Collins";
        excelData[3][2] = "222-222-2222";
        excelData[3][3] = "NY, USA";

        return excelData;

    }
} 
```

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2012-06-21T18:43:03.363

这很简单：

**HSSF：**

```
SummaryInformation summaryInfo = workbook.getSummaryInformation();
summaryInfo.setAuthor(author); 
```

**XSSF：**

```
POIXMLProperties xmlProps = workbook.getProperties();    
POIXMLProperties.CoreProperties coreProps =  xmlProps.getCoreProperties();
coreProps.setCreator(author); 
```

玩得开心 ：）

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2014-02-10T14:54:23.217

不是一个直接的答案，但如果有人需要在 NPOI（POI 的 .NET 端口）中执行此操作，这是我想出的扩展方法......这基本上是 Olivier 建议的 - 仅在 C# 中实现：

```
/// <summary>
/// Sets the author of this workbook.
/// </summary>
/// <param name="workbook"></param>
/// <param name="author"></param>
public static void SetAuthor(this IWorkbook workbook, string author)
{
    if (workbook is NPOI.XSSF.UserModel.XSSFWorkbook)
    {
        var xssfWorkbook = workbook as NPOI.XSSF.UserModel.XSSFWorkbook;
        var xmlProps = xssfWorkbook.GetProperties();
        var coreProps = xmlProps.CoreProperties;
        coreProps.Creator = author;
        return;
    }

    if (workbook is NPOI.HSSF.UserModel.HSSFWorkbook)
    {
        var hssfWorkbook = workbook as NPOI.HSSF.UserModel.HSSFWorkbook;
        var summaryInfo = hssfWorkbook.SummaryInformation;

        if (summaryInfo != null)
        {
            summaryInfo.Author = author;
            return;
        }

        var newDocInfo = NPOI.HPSF.PropertySetFactory.CreateDocumentSummaryInformation();

        var newInfo = NPOI.HPSF.PropertySetFactory.CreateSummaryInformation();
        newInfo.Author = author;

        hssfWorkbook.DocumentSummaryInformation = newDocInfo;
        hssfWorkbook.SummaryInformation = newInfo;

        return;
    }
} 
```

# java - Java 程序，它告诉从 1 美分到 99 美分的任何数量的零钱应该派出什么硬币

> ID：11143304
> 
> 赞同：2
> 
> 时间：2012-06-21T17:14:04.680
> 
> 标签：java, methods

我必须编写一个 Java 程序来告诉从 1 美分到 99 美分的任何数量的零钱应该派出什么硬币。例如，如果金额为 86 美分，则输出将类似于以下内容：

> 86 美分可以分为 3 个季度、1 毛钱和 1 便士。

使用面额为 25、10、5 和 1 的硬币。您的程序将使用以下方法（以及其他方法）：

```
public static int computeCoin(int coinValue,);
// Precondition: 0 < coinValue < 100; 
// Postcondition: returned value has been set equal to the maximum 
//number of coins of the denomination coinValue cents that can be 
//obtained from amount (a different variable) cents. amount has been 
//decreased by the value of the coins, that is, decreased by     
//returnedValue*coinValue. 
```

到目前为止，这就是我所拥有的，但我想我想念的更多，有人可以帮帮我吗？而且我也不应该使用双打代替int。

```
public class Assignment6{
   public static void main(String [] args){
   amount = (int)(Double.parseDouble(args[0])*100);

   System.out.println("Five: " + computeCoin(500));
   System.out.println("one: " + computeCoin(100) );
   System.out.println("Q : " + computeCoin(25) );
   System.out.println("D : " + computeCoin(10) );
   System.out.println("N : " + computeCoin(5) );
   System.out.println("P : " + computeCoin(1) );
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-21T17:24:10.543

```
public class Assignment6 {
    private static int amount = 0;
    public static void main(String[] args) {
        amount = (int)(Double.parseDouble(args[0])*100);
        System.out.println("Five: " + computeCoin(500));
        System.out.println("one: " + computeCoin(100) );
        System.out.println("Q : " + computeCoin(25) );
        System.out.println("D : " + computeCoin(10) );
        System.out.println("N : " + computeCoin(5) );
        System.out.println("P : " + computeCoin(1) );
    }

    public static int computeCoin(int cointValue) {
        int val = amount / cointValue;
        amount -= val * cointValue;
        return val;
    }
} 
```

这里的技巧在于`computeCoin`方法，事实上除法是*整数除法*，因此`val`将保存`coinValue`总价值不超过的给定值 ( )的硬币的“最大”数量`amount`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-21T17:23:05.183

像这样？

```
public class Assignment6 {
    public static int amount;
    public static int amountPreserv;

    public static void main(String[] args) {
        amount = (int) (Double.parseDouble(args[0]) * 100);
                amountPreserv = amount;

        System.out.println("Five: " + computeCoin(500));
        System.out.println("one: " + computeCoin(100));
        System.out.println("Q : " + computeCoin(25));
        System.out.println("D : " + computeCoin(10));
        System.out.println("N : " + computeCoin(5));
        System.out.println("P : " + computeCoin(1));
        System.out.println("Value inputed : " + amountPreserv);
    }

    private static int computeCoin(int i) {
        int cont = 0;
        while (amount > i) {
            amount -= i;
            cont++;
        }
        return cont;
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-21T22:11:12.177

最重要的一点是，做出改变是一种贪心算法，这意味着在任何给定时间让你最接近目标的选项是最有效的选择。因此，对于任何数量和任何面额，最有效的算法应该是这样的：

```
int total;
int[] denom = { w, x, y, z };
int[] count = new int[denom.length]
int i = 0;
while (i < denom.length && total > 0) {
  while ( total >= denom[i] )
  {
    total -= denom[i];
    count[i]++;
  }
  i++
} 
```

编辑：任何教派实际上都有点野心。只有你有一个最低面额，才能保证每次都能做出改变。

# regex - 使用正则表达式查找包含五个字母 abcde 的单词，每个字母按任意顺序仅出现一次，中间没有中断

> ID：11143306
> 
> 赞同：14
> 
> 时间：2012-06-21T17:14:25.570
> 
> 标签：regex, perl

例如，单词*debacle*会因为**debac 起作用**，但*seabed*不会起作用，因为：1\. 任何 5 个字符的序列中都没有可以形成的 c，以及 2\. 字母 e 出现两次。另一个例子，*反馈*会因为**edbac 起作用**。请记住，解决方案必须仅使用正则表达式来完成。

我尝试实施的一个策略是：如果第一个字母在 [ae] 内，则匹配它，并记住它。然后在 [ae] 中找到下一个字母，但不是第一个字母。等等。我不确定语法是什么（或者即使存在某些语法）所以我的代码不起作用：

```
open(DICT, "dictionary.txt");
@words = <DICT>;

foreach my $word(@words){

if ($word =~ /([a-e])([a-e^\1])([a-e^\1^\2])([a-e^\1^\2^\3])([a-e^\1^\2^\3^\4])/
){
    print $word;
}
} 
```

我也在考虑使用 (?=regex) 和 \G 但我不确定它会如何工作。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-06-21T17:40:05.590

```
/
   (?= .{0,4}a )
   (?= .{0,4}b )
   (?= .{0,4}c )
   (?= .{0,4}d )
   (?= .{0,4}e )
/xs 
```

* * *

它可能会导致更快的匹配以从所有组合中生成模式。

```
use Algorithm::Loops qw( NextPermute );
my @pats;
my @chars = 'a'..'e';
do { push @pats, quotemeta join '', @chars; } while NextPermute(@chars);
my $re = join '|', @pats; 
```

abcde|abced|abdce|abdec|abecd|abedc|acbde|acbed|acdbe|acdeb|acebd|acedb|adbce|adbec|adcbe|adceb|adebc|adecb|aebcd|aebdc|aecbd|aecdb|aedbc|aedcb|bacde| baced|badce|badec|baecd|baedc|bcade|bcaed|bcdae|bcdea|bcead|bceda|bdace|bdaec|bdcae|bdcea|bdeac|bdeca|beacd|beadc|becad|becda|bedac|bedca|cabde|cabed| cadbe|cadeb|caebd|caedb|cbade|cbaed|cbdae|cbdea|cbead|cbeda|cdabe|cdaeb|cdbae|cdbea|cdeab|cdeba|ceabd|ceadb|cebad|cebda|cedab|cedba|dabce|dabec|dacbe| daceb|daebc|daecb|dbace|dbaec|dbcae|dbcea|dbeac|dbeca|dcabe|dcaeb|dcbae|dcbea|dceab|dceba|deabc|deacb|debac|debca|decab|decba|eabcd|eabdc|eacbd|eacdb| eadbc|eadcb|ebacd|ebadc|ebcad|ebcda|ebdac|ebdca|ecabd|ecadb|ecbad|ecbda|ecdab|ecdba|edabc|edacb|edbac|edbca|edcab|edcba

（这将在 Perl 5.10+ 中优化为 trie。在 5.10 之前，使用 Regexp::List。）

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-06-21T17:46:19.347

正如您发现的那样，您的解决方案很聪明，但不幸的`[a-e^...]`是不起作用。我不相信有一种方法可以混合常规和否定字符类。我可以想到一个使用前瞻的解决方法：

```
 /(([a-e])(?!\2)([a-e])(?!\2)(?!\3)([a-e])(?!\2)(?!\3)(?!\4])([a-e])(?!\2)(?!\3)(?!\4])(?!\5)([a-e]))/ 
```

在这里查看：[http](http://rubular.com/r/6pFrJe78b6) ://rubular.com/r/6pFrJe78b6 。

**更新：** Mob 在下面的评论中指出，可以使用交替来压缩上述内容：

```
 /(([a-e])(?!\2)([a-e])(?!\2|\3)([a-e])(?!\2|\3|\4])([a-e])(?!\2|\3|\4|\5)([a-e]))/ 
```

新演示：[http](http://rubular.com/r/UUS7mrz6Ze) ://rubular.com/r/UUS7mrz6Ze 。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-06-21T17:44:33.273

```
#! perl -lw
for (qw(debacle seabed feedback)) {
    print if /([a-e])(?!\1)
        ([a-e])(?!\1)(?!\2)
        ([a-e])(?!\1)(?!\2)(?!\3)
        ([a-e])(?!\1)(?!\2)(?!\3)(?!\4)
        ([a-e])/x;
} 
```

# google-maps - 谷歌地图加载缓慢

> ID：11143308
> 
> 赞同：0
> 
> 时间：2012-06-21T17:14:26.557
> 
> 标签：google-maps, google-maps-api-3

我有谷歌地图的问题在我的java脚本代码中加载和制作中心如果我们刷新页面或slick on fire bug它工作正常。请尽快帮助我，代码位于链接 [http://www.myl.elocaldevelopment.com/ca/los-angeles/chiropractor/的地图视图中](http://www.myl.elocaldevelopment.com/ca/los-angeles/chiropractor/)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-21T17:47:34.680

等待初始化地图，直到它的画布成为页面上的可见元素。如果您在隐藏元素上创建地图，那么您需要在它变得可见时调用 google.maps.event.trigger(map,'resize')。

# excel - 用于在两个不同列中搜索两个值并使用它在第三列中填充信息的宏

> ID：11143309
> 
> 赞同：1
> 
> 时间：2012-06-21T17:14:29.997
> 
> 标签：excel, vba

我正在创建一个时间表，并且一直在寻找为以下内容开发宏：

*   第 1 列和第 2 列包含员工的名字和姓氏。
*   第 3 列包含员工编号。
*   第 5 列包含每周约定的小时数（已填充）。
*   第 6 列包含该月的周结束日期（每月有 4 或 5 周，因此我们每个员工有 5 行）。

我正在寻找的是一个宏按钮，它将向用户询问员工编号，然后询问用户他们想要哪个周结束日期。这应该标识单行。基于此，我想要一个输入框来修改第 5 列中的每周小时数。

时间表将已被填充，并且此功能将只允许对每周时间进行修改。他们不能直接输入的原因是单元格将被锁定，我们不希望最终用户不必要地访问它们。

我知道听起来很啰嗦，但我们有大约 800 个时间表要分发给具有不同 Excel 经验的人，锁定所有这些单元格可以防止他们不必要地删除数据。

提前感谢您的帮助！

**2012 年 8 月 14 日修订：**

这是我遇到的问题的最终解决方案（由 Siddarth Rout 提供），效果非常好，并且有很多参数可以确保 Excel 中的绝对初学者可以舒适地使用它：

```
 Private Sub AmendWeeklyHoursCommandButton_Click()

 Unload AmendEmployeeUserForm

 ' Turn off screen updating to speed up macro.
 Application.ScreenUpdating = False

 ActiveSheet.Unprotect Password:="control"

 'Find employee number
Dim EmployeeNumber As String
Dim Continue As Boolean
Dim aCell As Range

Continue = True

Do While Continue = True
 Again: EmployeeNumber = InputBox("Please enter the employee number:", "Amend the employee's weekly contracted hours")

 If StrPtr(EmployeeNumber) = 0 Then
        ActiveSheet.Protect Password:="control"
        AmendEmployeeUserForm.Show
        '~~> User pressed cancel
        Exit Sub
    Else
        '~~> User pressed OK with something filled
        If EmployeeNumber <> "" Then
            With ActiveSheet
                Set aCell = .Columns(3).Find(What:=EmployeeNumber, LookIn:=xlValues, _
                LookAt:=xlWhole, SearchOrder:=xlByRows, SearchDirection:=xlNext, _
                MatchCase:=False, SearchFormat:=False)

                If Not aCell Is Nothing Then
                    Selection.AutoFilter field:=3, Criteria1:=EmployeeNumber
                    Continue = False
                'If an invalid entry is entered
                Else
                    If MsgBox("You entered an invalid employee number - Try again?", _
                    vbYesNo + vbQuestion, "Search Again?") = vbYes Then GoTo Again
                    If vbNo Then Range("G6").Select
                    ActiveSheet.Protect Password:="control"
                    AmendEmployeeUserForm.Show
                    Exit Sub

                End If
            End With
        '~~> User pressed OK WITHOUT anything filled
        Else
            MsgBox "You didn't enter a value. Please enter the employee number or press cancel."
            Continue = True
        End If
    End If
Loop

 'Find Week Ending Date
Dim WeekEnding As String
Dim Continue1 As Boolean
Dim bCell As Range

Continue1 = True

Do While Continue1 = True
 Again1:        WeekEnding = InputBox("Please enter the week ending date:", "Amend the employee's weekly contracted hours")

 If StrPtr(WeekEnding) = 0 Then
        '~~> User pressed cancel
        ActiveSheet.ShowAllData
        Range("G6").Select
        ActiveSheet.Protect Password:="control"
        AmendEmployeeUserForm.Show
        Exit Sub
    Else
        '~~> User pressed OK with something filled
        If WeekEnding <> "" Then
            With ActiveSheet
                Set bCell = .Columns(6).Find(What:=WeekEnding, LookIn:=xlValues, _
                LookAt:=xlWhole, SearchOrder:=xlByRows, SearchDirection:=xlNext, _
                MatchCase:=False, SearchFormat:=False)

                If Not bCell Is Nothing Then
                    Selection.AutoFilter field:=6, Criteria1:=WeekEnding
                    Continue1 = False
                Else
                'If an invalid entry is entered
                    If MsgBox("You entered an invalid week ending date - Try again?", _
                    vbYesNo + vbQuestion, "Search again?") = vbYes Then GoTo Again1
                    If vbNo Then ActiveSheet.ShowAllData
                    Range("G6").Select
                    ActiveSheet.Protect Password:="control"
                    AmendEmployeeUserForm.Show
                    Exit Sub

                End If
            End With
        Else
            '~~> User pressed OK WITHOUT anything filled
            MsgBox "You didn't enter a value. Please enter the week ending date or press cancel."
            Continue1 = True
        End If
    End If
Loop

 'Control + home
Dim Rng As Range
With ActiveSheet.AutoFilter
    Set Rng = .Range.Offset(1, 0).Resize(.Range.Rows.Count - 1)
    Rng.SpecialCells(xlCellTypeVisible).Cells(1, 1).Select
End With

 'Select hours column
 ActiveCell.Offset(0, 4).Activate

 'Enter hours
 Dim NewHours As String
 Dim Continue2 As Boolean

 Continue2 = True

Do While Continue2 = True
NewHours = InputBox("Please enter the new hours:", "Enter New Contracted Hours")

 If StrPtr(NewHours) = 0 Then
        '~~> User pressed cancel
        ActiveSheet.ShowAllData
        Range("G6").Select
        ActiveSheet.Protect Password:="control"
        AmendEmployeeUserForm.Show
        Exit Sub

        'User pressed OK WITH something filled
        ElseIf NewHours <> "" Then
        ActiveCell = NewHours
        Continue2 = False
    Else
        '~~> User pressed OK WITHOUT anything filled
        MsgBox "You didn't enter a value. Please enter the number of hours or press cancel."
        Continue2 = True
End If
 Loop

'Completion message
MsgBox "You have successfully amended the details for " & aCell.Offset(0, -1).Value     & " " & aCell.Offset(0, -2).Value

'Show all data
ActiveSheet.ShowAllData

 ActiveSheet.Protect Password:="control"

 Application.ScreenUpdating = True

 Range("G6").Select

 End Sub 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-09T11:54:01.153

完整答案：

```
Private Sub AmendWeeklyHoursCommandButton_Click()

Unload AmendEmployeeUserForm

 ' Turn off screen updating to speed up macro.
 Application.ScreenUpdating = False

 ActiveSheet.Unprotect Password:="control"

 'Find employee number
 Dim EmployeeNumber As String
 Dim Continue As Boolean
 Dim aCell As Range

 Continue = True

 Do While Continue = True
  Again: EmployeeNumber = InputBox("Please enter the employee number:", "Amend the      employee's weekly contracted hours")

  If StrPtr(EmployeeNumber) = 0 Then
    ActiveSheet.Protect Password:="control"
    AmendEmployeeUserForm.Show
    '~~> User pressed cancel
    Exit Sub
Else
    '~~> User pressed OK with something filled
    If EmployeeNumber <> "" Then
        With ActiveSheet
            Set aCell = .Columns(3).Find(What:=EmployeeNumber, LookIn:=xlValues, _
            LookAt:=xlWhole, SearchOrder:=xlByRows, SearchDirection:=xlNext, _
            MatchCase:=False, SearchFormat:=False)

            If Not aCell Is Nothing Then
                Selection.AutoFilter field:=3, Criteria1:=EmployeeNumber
                Continue = False
            'If an invalid entry is entered
            Else
                If MsgBox("You entered an invalid employee number - Try again?", _
                vbYesNo + vbQuestion, "Search Again?") = vbYes Then GoTo Again
                If vbNo Then Range("G6").Select
                ActiveSheet.Protect Password:="control"
                AmendEmployeeUserForm.Show
                Exit Sub

            End If
        End With
    '~~> User pressed OK WITHOUT anything filled
    Else
        MsgBox "You didn't enter a value. Please enter the employee number or press cancel."
        Continue = True
    End If
End If
 Loop

 'Find Week Ending Date
 Dim WeekEnding As String
 Dim Continue1 As Boolean
 Dim bCell As Range

 Continue1 = True

 Do While Continue1 = True
 Again1:        WeekEnding = InputBox("Please enter the week ending date:", "Amend the employee's weekly contracted hours")

 If StrPtr(WeekEnding) = 0 Then
    '~~> User pressed cancel
    ActiveSheet.ShowAllData
    Range("G6").Select
    ActiveSheet.Protect Password:="control"
    AmendEmployeeUserForm.Show
    Exit Sub
Else
    '~~> User pressed OK with something filled
    If WeekEnding <> "" Then
        With ActiveSheet
            Set bCell = .Columns(6).Find(What:=WeekEnding, LookIn:=xlValues, _
            LookAt:=xlWhole, SearchOrder:=xlByRows, SearchDirection:=xlNext, _
            MatchCase:=False, SearchFormat:=False)

            If Not bCell Is Nothing Then
                Selection.AutoFilter field:=6, Criteria1:=WeekEnding
                Continue1 = False
            Else
            'If an invalid entry is entered
                If MsgBox("You entered an invalid week ending date - Try again?", _
                vbYesNo + vbQuestion, "Search again?") = vbYes Then GoTo Again1
                If vbNo Then ActiveSheet.ShowAllData
                Range("G6").Select
                ActiveSheet.Protect Password:="control"
                AmendEmployeeUserForm.Show
                Exit Sub

            End If
        End With
    Else
        '~~> User pressed OK WITHOUT anything filled
        MsgBox "You didn't enter a value. Please enter the week ending date or press cancel."
        Continue1 = True
    End If
End If
 Loop

 'Control + home
 Dim Rng As Range
 With ActiveSheet.AutoFilter
Set Rng = .Range.Offset(1, 0).Resize(.Range.Rows.Count - 1)
Rng.SpecialCells(xlCellTypeVisible).Cells(1, 1).Select
 End With

 'Select hours column
 ActiveCell.Offset(0, 4).Activate

 'Enter hours
 Dim NewHours As String
 Dim Continue2 As Boolean

 Continue2 = True

 Do While Continue2 = True
 NewHours = InputBox("Please enter the new hours:", "Enter New Contracted Hours")

 If StrPtr(NewHours) = 0 Then
    '~~> User pressed cancel
    ActiveSheet.ShowAllData
    Range("G6").Select
    ActiveSheet.Protect Password:="control"
    AmendEmployeeUserForm.Show
    Exit Sub

    'User pressed OK WITH something filled
    ElseIf NewHours <> "" Then
    ActiveCell = NewHours
    Continue2 = False
Else
    '~~> User pressed OK WITHOUT anything filled
    MsgBox "You didn't enter a value. Please enter the number of hours or press cancel."
    Continue2 = True
 End If
 Loop

 'Completion message
 MsgBox "You have successfully amended the details for " & aCell.Offset(0, -1).Value     & " " & aCell.Offset(0, -2).Value

 'Show all data
 ActiveSheet.ShowAllData

 ActiveSheet.Protect Password:="control"

 Application.ScreenUpdating = True

 Range("G6").Select

 End Sub 
```

# java - 虚线 Java JAR 命名约定

> ID：11143312
> 
> 赞同：0
> 
> 时间：2012-06-21T17:14:33.073
> 
> 标签：java, jar

我在 Sun 官方文档（或 Sun 在线教程）中阅读了有关 jar 档案的点命名的信息。是否曾鼓励将 jar 工件命名为*com.company.project.smallestdistributable.jar*？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-21T17:45:17.533

通常这种情况不时发生，因为点命名约定可以模拟系统中的命名空间，而该系统并不真正处理命名空间。

在您的情况下，您将模拟文件系统中的“com.company.project”命名空间，分辨率为“smallestdistributable.jar”。

我读过的任何 Java 文档（大约从 1.2 开始）都没有建议*对 JAR 文件*使用这样的命名系统。虽然人们无法确定为什么它从未被推荐，但可以猜测。早期的系统并没有将虚线扩展仅仅视为名称的一部分，但有时将它们视为分类器。在最早的系统中，名称和分类器对允许的字符数有非常严格的限制，文件系统只允许使用 [NAME].[CLASSIFIER] 的模式。包含额外句点的 JAR 文件（顺便说一下，它是 3 个字符，因为如果您希望文件名可移植，那是文件系统上可用的最长分类器和最短分类器）会破坏文件系统对文件的理解，所以

```
com.company.project.smallestdistributable.jar 
```

将被视为

```
file: com
extension: company.project.smallestdistributable.jar 
```

但实际上它甚至不会走那么远，因为扩展不能有扩展。

我见过一些较新的项目，它们与 [8].[3] 无关 命名约定将命名空间添加到 jar 文件名中，但这似乎是一个新想法，而不是在这些开发领域之外明确推广的东西。

# ruby - 为什么使用 Ruby 的 DBM 库

> ID：11143316
> 
> 赞同：4
> 
> 时间：2012-06-21T17:14:51.060
> 
> 标签：ruby, dbm

有人知道 Ruby 的 DBM 库的实际（现实生活）使用吗？它是否可以替代 Redis 等更“广泛”的持久键值存储？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-21T17:36:20.840

我从未使用过它，但显而易见的答案是它是标准库的一部分，因此可以在 Ruby 所在的任何地方使用。这可能使其在非常有限的情况下非常有用，即当您需要键值存储但最终用户处于无法使用更强大的解决方案的环境中时，例如 Redis 无法安装或运行或没有互联网连接来下载 gem。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-21T18:11:40.250

*   DBM 是一个非常古老的“标准”（有多个版本，请参阅[帖子](http://unixpapa.com/incnote/dbm.html)。）
*   读/写 DBM 的软件比更新的 Redis 广泛得多。

如果您需要与其他使用或生成 DBM 的软件兼容，请使用它。

否则，您可能正确地研究包括 Redis 在内的新技术。但是不要停止使用 Redis——您还应该研究其他 NoSQL 解决方案。[找到最好的](http://nosql.findthebest.com/)

# node.js - Node.js 和 MongoDB - 没有插入数据

> ID：11143318
> 
> 赞同：0
> 
> 时间：2012-06-21T17:14:51.950
> 
> 标签：node.js, mongodb

我正在尝试进行一个简单的测试 - 使用 Node.js 将一些数据从 SQL Server 移动到 MongoDB 不确定这段代码有什么问题，但我有三个问题。

1）“为什么这行打印不止一次？” 打印 2 次到控制台
编辑 - 这是因为来自浏览器的 favicon 请求（已修复）
2）没有数据插入到 MongoDB
3）服务器在一个请求结束时退出 - 没有错误

```
var http = require('http');
var sql = require('node-sqlserver');
var _ = require('underscore')._;

var connstr = "Driver={SQL Server Native Client 11.0};Server=ProdSqlServer;" + 
              "Database=CDDB;Trusted_Connection={Yes}";

http.createServer(function(req, res) {

    res.writeHead(200, { 'Content-Type': 'application/json' });
    var mongoUrl = "mongodb://localhost:27017/test";
    var stmt = "select top 10000 PersonID as Id, * from People";

    require('mongodb').connect(mongoUrl, function(err, conn){
        sql.query(connstr, stmt, function(err, results) {
            if(err) console.log(err);
            var jsonResults = JSON.stringify(results);
            res.write(jsonResults, 'utf8');

            conn.collection('tracks', function(err, collection) {
                if(err) console.log(err);
                _.each(results, function(x) {
                    collection.insert(x);
                });
            });
            console.log('why does this print more than once?');
            res.end();
        });
    });
}).listen(process.env.PORT || 8080); 
```

# c# - NPGSQL + dataGridView + 代码中 dg 的变化

> ID：11143321
> 
> 赞同：1
> 
> 时间：2012-06-21T17:14:59.890
> 
> 标签：c#, datagridview, npgsql

我的应用程序有一个问题。我正在使用 NPGSQL 库连接到 PostgreSQL 服务器。一切都好。但 ：）

我感觉dataGridView是这样的：

```
dataSetUzytkownicy = new DataSet("users");
dataAdapterUzytkownicy = new NpgsqlDataAdapter();
dataAdapterUzytkownicy.SelectCommand = new NpgsqlCommand("select * from users", bazaDanych.Connection);
dataAdapterUzytkownicy.Fill(dataSetUzytkownicy, "users");
dataTableUzytkownicy = dataSetUzytkownicy.Tables["users"];
dgUzytkownicy.DataSource = dataTableUzytkownicy; 
```

接下来我调用插入、更新和删除的方法。它运作良好。我还有一个按钮。我需要点击它后，将一行中的一个值从 true 更改为 false。我在这段代码中这样做：

```
dgUzytkownicy.SelectedRows[0].Cells[5].Value = false;
dataAdapterUzytkownicy.Update(dataSetUzytkownicy, "users"); 
```

它改变了dataGrid中的值，但是在我点击保存之后：

```
dataAdapterUzytkownicy.Update(dataSetUzytkownicy, "users"); 
```

它不会改变数据库。我认为这很简单，但我不知道该怎么做。

谢谢回答。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-21T19:20:31.127

答案是：

```
dataTableUzytkownicy.Rows[dgUzytkownicy.SelectedRows[0].Index][5] = false; 
```

# java - 与 Windows 路径变量中的 Java 的“bin”目录混淆 - 我该如何解决这个问题？

> ID：11143329
> 
> 赞同：0
> 
> 时间：2012-06-21T17:15:34.223
> 
> 标签：java, windows, variables, path

因此，在运行 Windows Server 2008 x64 R2 的服务器上，我安装了 Java JDK 7 Update 5。我将“C:\Program Files\Java\jdk1.7.0_05\bin”添加到系统“路径”变量中。

现在在控制台中，某些 Java 可执行文件（如 java.exe）可以工作，但其他 Java 可执行文件（如 javac.exe）仅在我实际位于该“bin”目录时才工作。

有谁知道我做错了什么以及如何解决这个问题？

编辑：每当我输入“javac”时，它都会返回：

```
'javac' is not recognized as an internal or external command,
operable program or batch file. 
```

当我输入“PATH”时，我得到：

```
PATH=C:\PROGRA~2\PARALL~1\Plesk\ADDITI~1\Perl\site\bin;C:\PROGRA~2\PARALL~1\Ples
k\ADDITI~1\Perl\bin;C:\Program Files (x86)\Parallels\Plesk\Mail Servers\Mail Ena
ble\BIN;C:\Program Files (x86)\Parallels\Plesk\Additional\Python\Scripts;C:\Prog
ram Files (x86)\Parallels\Plesk\Additional\Python\;C:\zpanel\bin\apache\bin;C:\z
panel\bin\mysql\bin;C:\zpanel\bin\php;C:\zpanel\bin\wget;C:\zpanel\bin\bind\bin;
C:\Windows\system32;C:\Windows;C:\Windows\System32\Wbem;C:\Windows\System32\Wind
owsPowerShell\v1.0\;c:\Program Files\Microsoft SQL Server\100\DTS\Binn";C:\Progr
am Files\MySQL\MySQL Server 5.5\bin;C:\Program Files (x86)\Parallels\Plesk\Mail
Servers\Mail Enable\BIN64;C:\Program Files\TortoiseSVN\bin;C:\Program Files (x86
)\Git\cmd;C:\Program Files\SlikSvn\bin;C:\Program Files\Java\jdk1.7.0_05\bin; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-21T17:19:37.893

还创建一个带有 java 路径的环境变量 JAVA_HOME

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-21T17:32:30.257

试试这个，

例如：

我的 JDK 位于我的 C:\Program Files\Java

因此，您必须执行以下操作：

`Copy C:\Program Files\Java\jdk1.7.0\bin , then goto your "Path" variable and set this...`

`And yes.. open you command prompt and give the following command..`

**gpupdate / 强制**

# php - 仅当文件已更改时，如何在 PHP 中创建 ZIP？

> ID：11143336
> 
> 赞同：0
> 
> 时间：2012-06-21T17:15:47.923
> 
> 标签：php, caching, ziparchive

我在培训站点上有一个页面，其中显示了几个下载，其 id 是从数据库中提取的。在底部，我已经成功编码将所有这些文件压缩成 zip 以供下载。

但是，每次页面加载时，都会重新创建 zip 并覆盖之前的 zip 文件。可以想象，这会导致一些不太理想的加载时间。

我想知道如何让 PHP 检查自上次页面加载（最后一个视图打开页面）以来是否有任何文件发生更改，如果是，则重新创建 zip 并覆盖。

浏览 PHP 文档，它似乎`filemtime()`与它有关，但我没有这方面的经验，甚至不确定我是否可以在网站上使用它。仔细研究一下，我担心我可能需要涉及缓存，我也没有经验。

任何帮助、建议或线索都会非常有帮助。让我知道我是否可以更有意义或提供我现有的任何代码作为背景。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-21T18:16:34.580

出于索引目的，我将答案留在这里。

您可以将 设置`filename`为等于最后一次更改文件时`timestamp`返回的`filemtime()`日期，从而能够将当前日期`timestamp`与`filename`自身进行比较。它可能会迫使您将`zip`文件夹结构分解为更复杂的东西以避免冲突，但是您也可以再次制作`filename`：

```
$timestamp = time();
$id = uniqid();
echo "Filename : {$timestamp}-{$id}.zip"; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-03T16:52:53.753

我确信 Yoda 提供的解决方案会奏效，但我选择了（我认为）更简单的解决方案。

出于我的目的，我需要随着时间的推移保持 zip 文件名不变（无法将时间戳放在文件名中）。相反，我使用 filemtime() 从文件中收集了最新的时间戳。然后我将它们与我的 zip 文件的时间戳进行了比较。如果压缩时间较新，压缩不存在，或者列表中的文件数量与压缩中的数量不匹配，我重新创建压缩，否则，我只显示压缩。

我的情况有点独特，因为我通过 wordpress 插件（下载监视器）存储和显示可下载文件。这基本上是我所做的：

```
/*Functions*/

//Convert url to absolute path
function url2path($url){
    $parsed = parse_url($url);
    if(!is_array($parsed)) return false;
    $path = $_SERVER['DOCUMENT_ROOT'].$parsed['path'];
    return $path;
}
//Returns the highest number (works with Unix Timestamps)
function get_highest_number($numbers){
    if(!is_array($numbers)) return false;
    $highest = $numbers[0];
    foreach($numbers as $number) if($highest < $number) $highest = $number;
    return $highest;
}

$dtimes = array();
foreach($dl as $d) { //iterate through my array of downloads
    $dtimes[] = filemtime(url2path($d->filename));
    //$dtimes is an array containing all the unix timestamps of my downloads
    //other code to display individual downloads, etc
}

//Zip Details
$uploads = wp_upload_dir();
$parent = get_page($post->post_parent);
$zip_url = $uploads[baseurl].'/downloads/zips/'.$parent->post_name.'_'.$post->post_name.'.zip';

if($dtimes){
    $latesttime = get_highest_number($dtimes); //latest UNIX timestamp of files
    //If ZIP already exists, get timestamp of when ZIP was created
    //I create the ZIP file name from the page title and store them all in 1 directory, thus, I would have to know the full zip filename to retrieve it.
    if($ziptime = filemtime(url2path($zip_url))){   
        $zip = new ZipArchive(); 
        $zip->open(url2path($zip_url));

        //If ZIP timestamp is more recent than file, show ZIP
        if($ziptime > $latesttime && $zip->numFiles == count($dtimes)) $result = url2path($zip_url);
        else $result = cat has create_zip($downloads,$zip_url,true);    
    }
//If ZIP doesn't exist or ZIP timestampe is less recent than files, create/rewrite ZIP
    else $result = create_zip($downloads,$zip_url,true);
    //regardless of what has happened, $result should now hold the path to the zip archive.
} 
```

希望这可以帮助有类似问题的人。如果您对演示感兴趣，“培训库”中的几乎所有页面都使用此代码（即[http://chesapeakestormwater.net/training-library/all-about-stormwater/impervious-cover-and-stream-health /](http://chesapeakestormwater.net/training-library/all-about-stormwater/impervious-cover-and-stream-health/) )

# algorithm - 在 Octave 中重叠二维矩阵

> ID：11143338
> 
> 赞同：1
> 
> 时间：2012-06-21T17:15:58.290
> 
> 标签：algorithm, matlab, octave

![在此处输入图像描述](../Images/5d3cc556fe4b7f7fff56a798011a6b73.png) 假设我有一个矩阵。这个矩阵是空白的，除了一些创建相同大小的矩形的点。创建矩形的每个点都有一个正数，该正数对于该矩形的所有点都相等。这个矩阵有可能有几个矩形，每个矩形都有相同的数字。

现在想象一下，我有第二个具有相同结构的矩阵，但现在矩形位于其他位置，具有其他大小和其他值，就像图片中的矩阵 A 和 B 一样。

我想将两个矩阵结合起来，所以如果某个矩形有交集，则删除具有最小数量的矩形。

最好的方法是什么？我认为它可以做 fors 但我想做 30 次，所以如果我不改进它，Octave 将需要很长时间才能完成它。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-21T17:45:14.820

我制作了这个似乎可以完成这项工作的小代码：

```
A=[0 0 1 1 1 0 ;
   0 0 1 1 1 0 ;
   0 0 0 0 0 0 ;
   2 2 0 0 0 0 ;
   2 2 0 0 0 0 ;
   2 2 0 0 0 0 ];

B=[3 0 2 2 0 0 ;
   3 0 2 2 0 0 ;
   0 0 2 2 0 0 ;
   0 0 0 0 0 0 ;
   1 1 1 1 1 0 ;
   1 1 1 1 1 0 ];

%give a unique id to each rectangle
lblA=bwlabel(A);
lblB=bwlabel(B);

%search for overlap
overlap= A & B;

% find out overlaping rectangle s unique id
overlapLbl= unique([lblA(overlap(:)) lblB(overlap(:))],'rows');

%eliminate rectangle with lower score
for ov=1:size(overlapLbl,1)
  scoreA=A(find((lblA==overlapLbl(ov,1)),1));
  scoreB=B(find((lblB==overlapLbl(ov,2)),1));
  if scoreA>scoreB
    B(B==scoreB)=0;
  else
    A(A==scoreA)=0;
  end
end
C=A+B 
```

输出：

```
C =
     3     0     2     2     0     0
     3     0     2     2     0     0
     0     0     2     2     0     0
     2     2     0     0     0     0
     2     2     0     0     0     0
     2     2     0     0     0     0 
```

# php - 如何遍历目录中的文件并将每个文件的内容输出到目录中

> ID：11143340
> 
> 赞同：0
> 
> 时间：2012-06-21T17:16:09.400
> 
> 标签：php

> **可能重复：**
> [目录中每个文件的循环代码](https://stackoverflow.com/questions/6155533/loop-code-for-each-file-in-a-directory)

我认为我可以使用以下代码来实现这一点，但我认为我在这段代码中犯了一些错误 `include($file[$])`

```
<?php
$dir= opendir(".") or die ('Cannot open directory');
$div="<div class=\"left1\">\n";
echo "<div class=\"wrapper\">\n";
for( $i=0; $i<6; $i++){
    while(($file = readdir($dir)) != false){
    if(preg_match("/php$/", $file)){
    echo $div;
    include($file[$i]); // HERE ITS NOT WORKING AS I WANT
    echo "</div>\n";
    }
    }
}
echo "</div>\n";

?> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-21T17:18:29.700

readdir 将实际文件名作为字符串返回，因此您尝试将该文件名作为一个数组访问，这将只提取该文件名的一个字符。

尝试：

```
include($file); 
```

反而。除此之外，不需要 opendir/readdir，你可以使用[glob()](http://php.net/glob)：

```
$phpfiles = glob('*.php');
foreach($phpfiles as $file) {
    include($file);
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-21T17:18:16.877

`$file`此时是纯字符串，而不是数组。因此`include($file[$i])`，您只需要`include($file)`.

```
while(($file = readdir($dir)) !== false){
  if(preg_match("/php$/", $file)){
      echo $div;
      include($file);
      echo "</div>\n";
   }
} 
```

整个外`for`循环似乎是不必要的。

# eclipse - 关闭黄色弹出窗口

> ID：11143343
> 
> 赞同：0
> 
> 时间：2012-06-21T17:16:21.793
> 
> 标签：eclipse, user-interface

当您将鼠标光标悬停在某些代码上时，您如何关闭那些出现的黄色弹出窗口？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-21T17:27:57.507

在 Eclipse 3.7.2 中，您可以转到菜单 Window->Preferences，然后展开 Java/Editor 并选择 Hovers。

取消选中所有复选框（组合悬停等）。

# c++ - 在 2D 图像数组中裁剪/插入 - 内存分配问题

> ID：11143348
> 
> 赞同：0
> 
> 时间：2012-06-21T17:16:34.770
> 
> 标签：c++, memory-management, image-processing, multidimensional-array

我最后的实验室任务是从图像中裁剪部分，将裁剪后的图像插入原始背面，旋转并调整大小。

我们将图像作为 txt 文件中的二维数组，Matlab 将文本文件转换为图像/图像文件到 txt，因此我们可以看到我们的结果。

当我裁剪一个正方形（`image.extract_sub_image(0,0,100,100);`）时使用我的代码，没有问题，但是它将裁剪的图像插入到相反的坐标，我不知道为什么。此外，当我裁剪一个矩形（`image.extract_sub_image(0,0,100,50);`）时，程序崩溃了。也不知道为什么:(

PS：

read、write、get_dimensions函数都是教授给的，都是常数，头文件也是教授给的，`**p2matr2D`是他的主意，我改不了。

我的代码：[http ://codepad.org/F0mfR7dN](http://codepad.org/F0mfR7dN)

goldhill.txt 文件：[http ://codepad.org/jfbeKLII](http://codepad.org/jfbeKLII)

如果我根据 x,y 坐标系没有弄错，x 应该是列，y 应该是行，这就是我对相反插入的意思：http: [//i.imgur.com/wgYsj.png](https://i.imgur.com/wgYsj.png)，绿色框是我想要的，红框就是出来的...

文本文件中的前 2 个值确定图像尺寸，这就是教授安排他的 Matlab 脚本和 C++ 代码的方式。

我会很高兴您的提示和意见来解决问题。我知道代码很长，但我认为我需要粘贴所有内容以解释我面临的问题。问题应该出在 CCTOR、=op、extract 或 insert 函数中。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-22T08:05:40.303

在我看来，在某种程度上，你正在用你的行反转你的列。这可以解释为什么当高度与宽度不同时，你会得到一个异常，以及为什么当它们相同时它会翻转你的图片。

我没有查看您的代码，但我想您只是在二维数组中使用列数组的行索引和行数组的列索引。这是最简单的原因。

另外，给您一个提示：如果您将其重写为大小为 height*width 的一维数组，您将获得显着的速度提升。编写一个接受 x 和 y 坐标的方法，并将这些坐标转换为一维数组的单个索引并返回该值，这样您在创建此方法后就不必担心细节。

# actionscript-3 - 复杂柱形图

> ID：11143351
> 
> 赞同：1
> 
> 时间：2012-06-21T17:16:45.007
> 
> 标签：actionscript-3, apache-flex, flex3, flexbuilder

我正在尝试使用此 xml 安装柱形图，我的想法是使用`<CategoryAxis categoryField="INICIO_CICLO"/>`和上面一样的系列制作水平轴，但有两个条形图（客户）值 C1 和 C2，但用户可以选择 C1 或 C2 或两者兼而有之。我怎样才能安装这个？谢谢你帮助我。

```
<mx:ColumnSet type="stacked">
    <mx:series>
        <mx:ColumnSeries xField="INICIO_CICLO" yField="CUSTOMER" displayName="Customer"/>
        <mx:ColumnSeries xField="INICIO_CICLO" yField="VALIDACAO_CONTAS" displayName="Tempo Validação Contas"/>
        <mx:ColumnSeries xField="INICIO_CICLO" yField="VALOR_FATURA" displayName="Tempo Valor Fatura"/>
        <mx:ColumnSeries xField="INICIO_CICLO" yField="GERA_NF" displayName="Tempo Gera NF"/>
        <mx:ColumnSeries xField="INICIO_CICLO" yField="GERA_FATURA" displayName="Tempo Gera Fatura"/>
        <mx:ColumnSeries xField="INICIO_CICLO" yField="ENVIO_VENDOR" displayName="Tempo Envio Vendor"/>
    </mx:series>
</mx:ColumnSet> 
```

XML:

```
<dados>
<dado>
<CUSTOMER>c2</CUSTOMER>
<INICIO_CICLO>17-MAY-12</INICIO_CICLO>
<VALIDACAO_CONTAS>201</VALIDACAO_CONTAS>
<VALOR_FATURA>117</VALOR_FATURA>
<GERA_NF>61</GERA_NF>
<GERA_FATURA>44</GERA_FATURA>
<ENVIO_VENDOR>220</ENVIO_VENDOR>
<TEMPO_TOTAL_CICLO>642</TEMPO_TOTAL_CICLO>
<QTD_CONTAS_BIP>1918</QTD_CONTAS_BIP>
<QTD_CONTAS_NOBILL>531</QTD_CONTAS_NOBILL>
<QTD_ERRO_BIP>0</QTD_ERRO_BIP>
<QTD_SKIP_BIP>11</QTD_SKIP_BIP>
<QTD_ERRO_EIF>0</QTD_ERRO_EIF>
<QTD_FAT_ZERADA>159</QTD_FAT_ZERADA>
<QTD_ENV_ABNC>3425</QTD_ENV_ABNC>
<QTD_CDR>34.3726</QTD_CDR>
<QTD_TOTAL_LEVANTADAS>5583</QTD_TOTAL_LEVANTADAS>
<QTD_N_INSTANCIA_ATIVA>5220</QTD_N_INSTANCIA_ATIVA>
</dado>
<dado>
<CUSTOMER>c1</CUSTOMER>
<INICIO_CICLO>17-MAY-12</INICIO_CICLO>
<VALIDACAO_CONTAS>199</VALIDACAO_CONTAS>
<VALOR_FATURA>212</VALOR_FATURA>
<GERA_NF>63</GERA_NF>
<GERA_FATURA>111</GERA_FATURA>
<ENVIO_VENDOR>58</ENVIO_VENDOR>
<TEMPO_TOTAL_CICLO>642</TEMPO_TOTAL_CICLO>
<QTD_CONTAS_BIP>2011</QTD_CONTAS_BIP>
<QTD_CONTAS_NOBILL>629</QTD_CONTAS_NOBILL>
<QTD_ERRO_BIP>2</QTD_ERRO_BIP>
<QTD_SKIP_BIP>53</QTD_SKIP_BIP>
<QTD_ERRO_EIF>0</QTD_ERRO_EIF>
<QTD_FAT_ZERADA>79</QTD_FAT_ZERADA>
<QTD_ENV_ABNC>3425</QTD_ENV_ABNC>
<QTD_CDR>68.14276</QTD_CDR>
<QTD_TOTAL_LEVANTADAS>5016</QTD_TOTAL_LEVANTADAS><QTD_N_INSTANCIA_ATIVA>3723</QTD_N_INSTANCIA_ATIVA>
</dado>
<dado>
<CUSTOMER>c1</CUSTOMER>
<INICIO_CICLO>17-JUN-12</INICIO_CICLO>
<VALIDACAO_CONTAS>399</VALIDACAO_CONTAS>
<VALOR_FATURA>141</VALOR_FATURA>
<GERA_NF>48</GERA_NF>
<GERA_FATURA>22</GERA_FATURA>
<ENVIO_VENDOR>5</ENVIO_VENDOR>
<TEMPO_TOTAL_CICLO>614</TEMPO_TOTAL_CICLO>
<QTD_CONTAS_BIP>2057</QTD_CONTAS_BIP>
<QTD_CONTAS_NOBILL>664</QTD_CONTAS_NOBILL>
<QTD_ERRO_BIP>4</QTD_ERRO_BIP>
<QTD_SKIP_BIP>74</QTD_SKIP_BIP>
<QTD_ERRO_EIF>0</QTD_ERRO_EIF>
<QTD_FAT_ZERADA>82</QTD_FAT_ZERADA>
<QTD_ENV_ABNC>3480</QTD_ENV_ABNC>
<QTD_CDR>67.2716</QTD_CDR>
<QTD_TOTAL_LEVANTADAS>5153</QTD_TOTAL_LEVANTADAS><QTD_N_INSTANCIA_ATIVA>3854</QTD_N_INSTANCIA_ATIVA>
</dado>
<dado>
<CUSTOMER>c2</CUSTOMER>
<INICIO_CICLO>17-JUN-12</INICIO_CICLO>
<VALIDACAO_CONTAS>213</VALIDACAO_CONTAS>
<VALOR_FATURA>92</VALOR_FATURA>
<GERA_NF>28</GERA_NF>
<GERA_FATURA>46</GERA_FATURA>
<ENVIO_VENDOR>235</ENVIO_VENDOR>
<TEMPO_TOTAL_CICLO>614</TEMPO_TOTAL_CICLO>
<QTD_CONTAS_BIP>2122</QTD_CONTAS_BIP>
<QTD_CONTAS_NOBILL>553</QTD_CONTAS_NOBILL>
<QTD_ERRO_BIP>0</QTD_ERRO_BIP>
<QTD_SKIP_BIP>8</QTD_SKIP_BIP>
<QTD_ERRO_EIF>0</QTD_ERRO_EIF>
<QTD_FAT_ZERADA>162</QTD_FAT_ZERADA>
<QTD_ENV_ABNC>3480</QTD_ENV_ABNC>
<QTD_CDR>42.55141</QTD_CDR>
<QTD_TOTAL_LEVANTADAS>5767</QTD_TOTAL_LEVANTADAS><QTD_N_INSTANCIA_ATIVA>5131</QTD_N_INSTANCIA_ATIVA>
</dado>
</dados> 
```

# c++ - 为什么在 ubuntu linux 中用于 c++ 的 g++ 编译器中的局部变量初始化为 0？

> ID：11143354
> 
> 赞同：1
> 
> 时间：2012-06-21T17:17:03.283
> 
> 标签：c++

根据任何有关 c++ 的书，任何未初始化的 c++ 局部变量都将包含垃圾值。但是，请查看以下程序：

```
#include<iostream>
using namespace std;
float a;
class A
{
public:
float b;
};
int main()
{
float c;
static float d;
static float e = 0;
A f;
cout<<"\n global a : "<<a<<"\n class variable b : "<<f.b;
cout<<"\n local c : "<<c<<"\n static local d : "<<d
<<"\n static initialized local e : "<<e;
} 
```

如果在 ubuntu linux 上使用 g++ 编译，它会给出以下输出：

```
global a : 0
class variable b : 6.94896e-36
local c : 0
static local d : 0
static initialized local e : 0 
```

奇怪的是它为局部变量 c 提供了一个 0 值，而这应该是未初始化的并且包含一些垃圾值。同一个程序在 windows 的 Visual c++ 中的工作方式不同，并为 c 提供了一个垃圾值，这是您所期望的。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-06-21T17:23:35.230

局部变量`c`未*初始化*。正如您所说，这意味着它具有*垃圾值。* 该对象可以具有任何值，包括`0`. 零是有效的“垃圾值”。一般情况下，不允许读取尚未初始化的对象。

为什么值`c`为零？可能是编译器（g++）在输入函数时对堆栈进行零初始化，以“帮助”您的程序“正确”执行，即使它使用未初始化的变量。或者，可能是操作系统在将内存页提供给您的程序之前对其进行了零初始化。或者，也许之前调用的函数将`main`零值存储在现在由 占用的字节数组中`c`，因此它的值为零。

* * *

使用 Visual C++ 编译的二进制文件的行为取决于它的编译方式。在发布二进制文件中，性能比可调试性更重要，当进入函数时堆栈不会隐式初始化，因此`c`将保持未初始化并具有垃圾值。

在调试二进制文件中，可调试性更重要，所有局部变量都用 byte 初始化`0xcc`。这可以帮助您跟踪和调试未初始化变量的使用情况。类似地，调试堆使用 byte 初始化新分配的存储，并在分配和释放内存时使用[不同的位模式](http://www.nobugs.org/developer/win32/debug_crt_heap.html#table)`0xcd`填充内存，以帮助您调试程序的状态。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-21T17:25:27.863

读取未初始化的变量是未定义的行为，但一般来说，您将获得该位置的内存中的位碰巧表示的任何值（这可能是一个陷阱 NaN）。在这种情况下，有问题的内存从未用于其他任何用途，并且当您从系统获取内存时，出于安全原因，它通常会被清除。将变量放在一个函数中，先调用几个其他函数，然后看看你得到了什么。

# php - 寻找与 SQL 匹配的自然语言

> ID：11143355
> 
> 赞同：0
> 
> 时间：2012-06-21T17:17:05.640
> 
> 标签：php, mysql, regex, match-against

我正在使用**match() against()**来匹配相似表中的不同值，但是它无法匹配以下两个值：

`WERE HERE BECAUSE WERE LARGE`和`ANATHEMA were here because TS M`

即使它**能够**匹配以下内容：

`ANTHOLOGY 3`和`BEATLES anthology 3 ALBUM COVER BADGE`

但是你可以看到它们非常相似，有没有办法让 match()against() 意识到它们有多相似？因为就字母而言，它们包含这两个值比任何其他可能的值都更相似，因此它们可以匹配它们。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-21T17:22:39.757

我相信您正在寻找的词是[停用词](http://dev.mysql.com/doc/refman//5.5/en/fulltext-stopwords.html)。由于这个原因，他们无法匹配。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-21T17:23:08.120

这是由于 MySql[全文停用词](http://dev.mysql.com/doc/refman/5.5/en/fulltext-stopwords.html) **是**停用词

您只需将其添加到您的**.cnf 文件**中，重新启动 mysql 引擎并重建索引：

```
ft_stopword_file = "" 
```

# javascript - jquery，追加完成后的砌体

> ID：11143357
> 
> 赞同：0
> 
> 时间：2012-06-21T17:17:16.830
> 
> 标签：javascript, jquery, for-loop, append, jquery-masonry

我在 **[http://jsfiddle.net/XMdYw/7/下面有 jQuery](http://jsfiddle.net/XMdYw/7/)**

```
var elements = '';
var ELEMENT_COUNT_PER_PAGE = 301;
var page = 1;

for (var i = (ELEMENT_COUNT_PER_PAGE * (page - 1)); i <= (ELEMENT_COUNT_PER_PAGE * page); i++) {
    elements+= '<div class="imgwrap"><img src="lq/'+i+'.jpg" class="image-'+i+'"/></div>'
}

$('.imagecontainer').append(elements).masonry();​ 
```

它的问题是图像重叠，刷新它修复的页面后，但一旦网站完全重新加载，它又出现了问题。

## 部分工作

我说它部分起作用的原因是因为 img 上没有 div.imgwrap 包装

```
var elements = '';
var ELEMENT_COUNT_PER_PAGE = 301;
var page = 1;

for (var i = (ELEMENT_COUNT_PER_PAGE * (page - 1)); i <= (ELEMENT_COUNT_PER_PAGE * page); i++) {
    elements+= '<img src="lq/'+i+'.jpg" class="image-'+i+'"/>'
}
var $img = $(elements);
$img.on('load', function() {
    $('.imagecontainer').masonry('reload');
});
$('.imagecontainer').append(elements).masonry(); 
```

我尝试了以下

```
 var elements = '';
    var ELEMENT_COUNT_PER_PAGE = 301;
    var page = 1;

    for (var i = (ELEMENT_COUNT_PER_PAGE * (page - 1)); i <= (ELEMENT_COUNT_PER_PAGE * page); i++) {
        elements+= '<div class="imgwrap"><img src="lq/'+i+'.jpg" class="image-'+i+'"/></div>'
if(i==301){
$('.imagecontainer').masonry('reload');​
}
    }

    $('.imagecontainer').append(elements).masonry();​ 
```

我也试过

```
 var elements = '';
    var ELEMENT_COUNT_PER_PAGE = 301;
    var page = 1;

    for (var i = (ELEMENT_COUNT_PER_PAGE * (page - 1)); i <= (ELEMENT_COUNT_PER_PAGE * page); i++) {
        elements+= '<div class="imgwrap"><img src="lq/'+i+'.jpg" class="image-'+i+'"/></div>'
    }
var $imgs = $(elements);

    $('.imagecontainer').append($imgs).masonry( 'appended', $imgs ); 
```

## 所以

有没有办法在追加完成时捕获，然后使用`.masonry();`具有 div 包装的 img应用

## 此外

你会发现一个 window.setTimeout 也是解决方案，但有些图像在 2 秒内没有加载，而且长时间看重叠的图像并不吸引人

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-21T18:15:57.877

1.  我建议您将高度和宽度添加到图像中，然后附加砖石。
2.  附加所有图像后，调用 masonry.reload() 函数。
3.  当图像加载时间过长时，使用 masonry 文档中描述的 imageloaded 函数

# objective-c - 何时释放 CMBlockBufferRef？

> ID：11143359
> 
> 赞同：1
> 
> 时间：2012-06-21T17:17:29.953
> 
> 标签：objective-c, ios, avfoundation

我正在通过 AV Foundation 的导出功能从 iPod 库中的曲目中读取 LPCM 样本。我的大部分代码都是从[Chris Adamson 的示例](http://www.subfurther.com/blog/2010/12/13/from-ipod-library-to-pcm-samples-in-far-fewer-steps-than-were-previously-necessary/)中借用的。

我正在设置一个新的`CMBlockBufferRef`并保留它`CMSampleBufferGetAudioBufferListWithRetainedBlockBuffer`。根据苹果[CFType 参考](http://developer.apple.com/library/ios/#documentation/CoreFoundation/Reference/CFTypeRef/Reference/reference.html#//apple_ref/c/func/CFRelease)，我需要`CFRelease`在我明确保留的任何对象上使用。

问题是我似乎无法弄清楚究竟在哪里释放`CMBlockBufferRef`对象。如果我根本不释放它，我会得到很大的内存泄漏。如果我尝试在循环中的任何位置释放它，应用程序会在我的 GrabAudioData 方法中崩溃并出现 EXC_BAD_ACCESS 错误。如果我尝试在循环之外启动并释放它，内存泄漏仍然存在。在发布之前，我已经尝试测试是否为`blockBuffer`is `NULL`，但这不起作用。请帮忙！

```
while (assetReader.status != AVAssetReaderStatusCompleted)
{
    if (assetReader.status == AVAssetReaderStatusReading)
    {
        CMSampleBufferRef nextBuffer = [readerOutput copyNextSampleBuffer];

        if (nextBuffer)
        {
            AudioBufferList bufferList;
            CMBlockBufferRef blockBuffer;
            CMSampleBufferGetAudioBufferListWithRetainedBlockBuffer(nextBuffer, NULL, &bufferList, sizeof(bufferList), NULL, NULL, kCMSampleBufferFlag_AudioBufferList_Assure16ByteAlignment, &blockBuffer);

            // Using the AudioBufferList
            bufferManager->GrabAudioData(&bufferList); 

            CMSampleBufferInvalidate(nextBuffer);
            CFRelease(nextBuffer);

            // Releasing here causes a crash
            // CFRelease(blockBuffer);
        }
        else
        {
            break;
        }
    }    
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-11T06:18:25.610

blockBuffer 是从 nextBuffer 中保留的，因此应该在 nextBuffer 之前释放它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-27T02:02:22.297

除了@sinn246 的回答，您还必须检查 CMSampleBufferGetAudioBufferListWithRetainedBlockBuffer 的返回：

```
OSStatus err = CMSampleBufferGetAudioBufferListWithRetainedBlockBuffer(nextBuffer, NULL, &bufferList, sizeof(bufferList), NULL, NULL, kCMSampleBufferFlag_AudioBufferList_Assure16ByteAlignment, &blockBuffer);

if (!err && blockBuffer && bufferList.mBuffers[0].mData && (bufferList.mBuffers[0].mDataByteSize > 0))
{
    // Using the AudioBufferList
    bufferManager->GrabAudioData(&bufferList);
}

if (blockBuffer) // Double check that what you are releasing actually exists!
{
    CFRelease(blockBuffer);
}

CMSampleBufferInvalidate(nextBuffer);
CFRelease(nextBuffer); 
```

# java - Java中的SSL证书验证

> ID：11143360
> 
> 赞同：19
> 
> 时间：2012-06-21T17:17:33.760
> 
> 标签：java, ssl

假设我有两个我编写的 Java 应用程序：它们被部署`Ping.jar`并`Pong.jar`运行在两个单独的服务器上（`Ping.jar`部署到`srv-01.myorg.com`和`Pong.jar`部署到`srv-02.myorg.com`），这两个应用程序需要通过 SSL 相互通信（双向）。我们还假设每个应用程序都有自己的 SSL 证书。

*   作为一名 Java 程序员，我如何编写代码`Ping`并`Pong`验证彼此的 SSL 证书？每个 CA 是否都提供某种我可以使用的 RESTful API，例如，`HttpClient`？Java 是否有自己的证书验证 API？是否有我可以使用的开源第三方 JAR 或服务？

当我在网上搜索这个时，我对出现的很少感到惊讶。

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2012-06-21T19:25:30.577

如果您使用 Java SE SSL/TLS 类（例如`SSLSocket`或`SSLEngine`）进行连接，则您使用的是[Java Secure Socket Extension (JSSE)](http://docs.oracle.com/javase/7/docs/technotes/guides/security/jsse/JSSERefGuide.html)。

它将根据`SSLContext`用于创建此`SSLSocket`或`SSLEngine`.

这`SSLContext`将使用[`TrustManager`](http://docs.oracle.com/javase/7/docs/api/javax/net/ssl/TrustManager.html)指示如何建立信任来初始化。

除非您需要特定配置，否则您通常可以依赖[默认值](http://docs.oracle.com/javase/7/docs/technotes/guides/security/jsse/JSSERefGuide.html#Customization)：这将依赖 PKIX 算法（RFC 3280）根据一组信任锚（`cacerts`默认情况下）验证证书。`cacerts`，Oracle JRE 附带的是一个 JKS 密钥库，您可以向其中添加其他证书。`keytool`您可以使用例如显式添加证书。

您还可以以编程方式创建`X509TrustManager`基于自定义密钥库的密钥库（如[本答案](https://stackoverflow.com/a/859271/372643)`SSLContext`中所述），并在不影响默认密钥的特定密钥库中使用它。

除此之外，如果您使用自己的协议，则需要验证您获得的证书是否与您正在寻找的主机名匹配（请参阅 RFC 6125）。通常，您可以在`X509Certificate`您获得的主题备用名称中查找（从 获取链中的第一个对等证书`SSLSession`），如果失败，请`CN`在主题可分辨名称中查找 RDN。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-22T00:15:04.133

您可以通过将 a 附加`HandshakeCompletedListener`到`SSLSocket`并从事件中获取证书，或者通过`SSLSession`从 the 中`SSLSocket`获取并从会话中获取对等证书来获取对等证书。

SSL 提供对等身份的隐私、完整性和身份验证。该对等身份是否是应用程序期望的身份，以及该身份在应用程序中被允许做什么，如有必要，应由应用程序检查。这是“授权”步骤，SSL 无法为您完成。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-05-13T09:24:25.820

AFAIK 证书验证应包括以下步骤：

1.  证书形式验证通过验证其签名、当前时间的有效性和使用给定证书的域的有效性。无需任何额外的网络通信即可检查这些内容。
2.  检查证书是否未被吊销 - 这是@Bruno 给出的答案中缺少的内容（否则我同意他的观点）。我认为只有在从签署证书的 CA（与 CA 的网络通信）获得新的 CRL（证书吊销列表）后才能进行此检查。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-06-21T18:56:15.700

您不必手动检查彼此的证书。

您只需将每个服务器证书导入到彼此的 cacerts 中，这样两个应用程序服务器就会自动相互信任。

# java - 向 JSONObject 添加数据

> ID：11143363
> 
> 赞同：25
> 
> 时间：2012-06-21T17:17:39.117
> 
> 标签：java, json

我试图弄清楚如何将以下数据添加到我的 json 对象中。有人可以告诉我如何做到这一点。

网站示例

```
$(document).ready(function() {
  $('#example').dataTable( {
    "aoColumnDefs": [
     { "aDataSort": [ 0, 1 ], "aTargets": [ 0 ] },
     { "aDataSort": [ 1, 0 ], "aTargets": [ 1 ] },
     { "aDataSort": [ 2, 3, 4 ], "aTargets": [ 2 ] }
   ]
  } );
} ); 
```

我的 JSONObject 需要合并上面的例子。

```
 JSONObject json = new JSONObject();
    json.put("aoColumnDefs", ); 
```

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2012-06-21T17:26:42.937

为了得到这个结果：

```
{"aoColumnDefs":[{"aTargets":[0],"aDataSort":[0,1]},{"aTargets":[1],"aDataSort":[1,0]},{"aTargets":[2],"aDataSort":[2,3,4]}]} 
```

包含与以下相同的数据：

```
 {
    "aoColumnDefs": [
     { "aDataSort": [ 0, 1 ], "aTargets": [ 0 ] },
     { "aDataSort": [ 1, 0 ], "aTargets": [ 1 ] },
     { "aDataSort": [ 2, 3, 4 ], "aTargets": [ 2 ] }
   ]
  } 
```

您可以使用以下代码：

```
 JSONObject jo = new JSONObject();
    Collection<JSONObject> items = new ArrayList<JSONObject>();

    JSONObject item1 = new JSONObject();
    item1.put("aDataSort", new JSONArray(0, 1));
    item1.put("aTargets", new JSONArray(0));
    items.add(item1);
    JSONObject item2 = new JSONObject();
    item2.put("aDataSort", new JSONArray(1, 0));
    item2.put("aTargets", new JSONArray(1));
    items.add(item2);
    JSONObject item3 = new JSONObject();
    item3.put("aDataSort", new JSONArray(2, 3, 4));
    item3.put("aTargets", new JSONArray(2));
    items.add(item3);

    jo.put("aoColumnDefs", new JSONArray(items));

    System.out.println(jo.toString()); 
```

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2012-06-21T17:23:37.970

答案是也使用[JSONArray](https://github.com/stleary/JSON-java/blob/master/JSONArray.java)，并“深入”到树结构中：

```
JSONArray arr = new JSONArray();
arr.put (...); // a new JSONObject()
arr.put (...); // a new JSONObject()

JSONObject json = new JSONObject();
json.put ("aoColumnDefs",arr); 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2016-09-22T16:36:00.847

Francisco Spaeth 接受的答案有效且易于理解。但是，我认为构建 JSON 的方法很糟糕！这对我来说真的很重要，因为我将一些 Python 转换为 Java，我可以在其中使用字典和嵌套列表等轻松地构建 JSON。

我真正不喜欢的是必须实例化单独的对象（通常甚至命名它们）来构建这些嵌套。如果你有很多对象或数据要处理，或者你的使用比较抽象，那真的很痛苦！

我尝试通过清除和重用 temp json 对象和列表来解决其中的一些问题，但这对我不起作用，因为这些 Java 对象中的所有 put 和 get 等都是通过引用而不是 value 工作的。所以，在仍然有一些丑陋（尽管风格不同）的代码之后，我最终会得到包含一堆乱七八糟数据的 JSON 对象。

所以，这就是我想出的清理它的方法。它可以使用进一步的开发，但这应该有助于为那些寻找更合理的 JSON 构建代码的人提供基础：

```
import java.util.AbstractMap.SimpleEntry;
import java.util.ArrayList;
import java.util.List;
import org.json.simple.JSONObject;

//  create and initialize an object 
public static JSONObject buildObject( final SimpleEntry... entries ) { 
    JSONObject object = new JSONObject();
    for( SimpleEntry e : entries ) object.put( e.getKey(), e.getValue() );
    return object;
}

//  nest a list of objects inside another                          
public static void putObjects( final JSONObject parentObject, final String key,
                               final JSONObject... objects ) { 
    List objectList = new ArrayList<JSONObject>();
    for( JSONObject o : objects ) objectList.add( o );
    parentObject.put( key, objectList );
} 
```

实现示例：

```
JSONObject jsonRequest = new JSONObject();
putObjects( jsonRequest, "parent1Key",
    buildObject( 
        new SimpleEntry( "child1Key1", "someValue" )
      , new SimpleEntry( "child1Key2", "someValue" ) 
    )
  , buildObject( 
        new SimpleEntry( "child2Key1", "someValue" )
      , new SimpleEntry( "child2Key2", "someValue" ) 
    )
); 
```

# c - 将 system() 调用的输出存储到变量中

> ID：11143365
> 
> 赞同：0
> 
> 时间：2012-06-21T17:17:44.977
> 
> 标签：c, linux, terminal

我在 C 程序中使用 system() 函数来获取字符串。但 system() 函数实际上显示输出并返回一个整数值（成功执行时为 0）。但我想要的是 system() 函数的输出必须存储到字符串变量中。例如：

```
char a[5];
a = system("echo \"hi\"");
printf("The string is: %s",a); 
```

这种`a`存储值`hi`和输出的东西是`The string is: hi` 请帮助。提前致谢。运行平台：Linux

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-21T17:20:23.970

您需要（或至少想要）使用[`popen`](http://linux.die.net/man/3/popen)而不是`system`为此。但是，它不会将输出直接存储到字符串中——它为您提供了一个文件句柄，您可以从中读取子节点的输出。可以使用类似的东西`fgets`将数据从那里读取到字符串中。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-21T17:22:38.157

system() 只会为您提供退出状态。

如果您想获得 STDOUT 上打印的内容，您需要确保您有另一个可以读取的文件描述符，并捕获此输出。通常，您`pipe()`首先使用命令（创建连接的描述符）执行此操作`fork`，然后`dup(pipin, 0)`强制 pipe() 的输出之一成为子进程的 STDOUT。

`popen()`也可能有帮助。

# javascript - Jquery .on('click') 奇怪的行为 - 选择具有相同类名的所有元素

> ID：11143374
> 
> 赞同：0
> 
> 时间：2012-06-21T17:18:20.803
> 
> 标签：javascript, jquery

`<li>`当用户单击元素时，我试图将包含在元素中的文本添加到输入字段中`#private_users`。问题是，如果列表如下所示：

```
<ul>
<li class="user_li_selection">Jane</li>
<li class="user_li_selection">John</li>
<ul> 
```

然后用户点击“John”，输入框中的字符串看起来像`John, Jane, John`。然后，在第一次选择之后，脚本的行为通常只附加选定的名称。基本上，脚本似乎附加了所有 li 元素中包含的文本，然后附加了所选元素的文本。我不明白为什么会这样。需要注意的是，`<li>`元素是通过不同的脚本动态附加的。

```
$(document).on('click', '.user_li_selection', function(e) {
             e.preventDefault; 
             var selection = $(this).html();
             var current_string = $('#private_users').val();

             arr = current_string.split(','), i;
             length =  arr.length;

             if (length != 1) {
             arr[length-1] = ' '+selection+', ';
             } else {
             arr[length-1] =  selection+', ';
             }

             $('#private_users').val(arr);

             //$('.input_auto_complete').remove();

          });

     $('#private_users').keyup(function() {

        var input = $(this).val();

        arr = input.split(', '), i; 
        length =  arr.length;
        var current_input = arr[length-1];

        var input_box = $('#private_users');
        var position = input_box.position();

        if ($('.input_auto_complete').length == 0 && input !== '') {
            $('body').append('<div class="input_auto_complete"></div>');
        }

        if (input == '') {
            $('.input_auto_complete').remove();
        }

        $('.input_auto_complete').css('top',position.top + 24);
        $('.input_auto_complete').css('left',position.left);
        $('.input_auto_complete').show();

        $.post('/username-query', {
        'user_input': current_input
        }, function(data) {
        $('.input_auto_complete').empty().append(data);
        }); 

     });

     $('#private_users').blur(function () {

        if ( !$('.user_li_selection').click() ) {
         $('.input_auto_complete').remove();
        }

     }); 
```

我要定位的输入字段只是一个简单的文本输入，如下所示：

```
<input type="text" id="private_users" /> 
```

[**JS FIDDLE 示例：（**](http://jsfiddle.net/JtGdv/1/)确保在从列表中选择项目之前选择输入字段，否则不会出现问题。）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-21T17:23:40.457

您可以使用 获取单击的文本`li`，`e.target`如下所示：

```
$(document).ready(function () {
  $(".user_li_selection").on('click', function (e) {
    e.preventDefault();
    var text = $(e.target).text();
    $("#private_users").val(text);
  });
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-21T17:23:25.370

试试这个 - [http://jsfiddle.net/5V6PP/](http://jsfiddle.net/5V6PP/)

```
$(document).on('click', '.user_li_selection', function(e) {
    e.preventDefault;
    var selection = $(this).html();
    var current_string = $('#private_users').val();

    arr = current_string.split(',');
    i = 0;
    length =  arr.length;

    if (length != 1) {
        arr[length-1] = ' ' + selection + ', ';
    } else {
        arr[length-1] = selection + ', ';
    }

    $('#private_users').val(arr);

    //$('.input_auto_complete').remove();

}); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-21T18:40:38.637

罪魁祸首是这一行：

```
if ( !$('.user_li_selection').click() ) 
```

当文本框失去焦点时，您模拟单击所有列表元素。

我不确定你想用这条线做什么，if 语句真的没有意义。

# javascript - 用于聚合外部数据的 javascript 设计模式

> ID：11143376
> 
> 赞同：0
> 
> 时间：2012-06-21T17:18:45.317
> 
> 标签：javascript, design-patterns, jquery

我有点不确定如何问这个问题，所以我会尽可能从我所在的地方开始。我有一个数据类型，我称之为“程序”，我从单个数据源加载一些核心信息。我已经为中央数据模型制定了加载/缓存逻辑，但是我的框架需要根据项目设置将外部加载的节点附加到数据模型中。

我正在寻找的是一种设计模式，它允许我在项目需要时加载这些附加的数据节点，并且在加载所有数据之前不执行程序。我可以假设我会提前知道节点是什么以及在需要时从哪里获取数据。我当前的设置如下所示：

```
var programs = {},
    loadCuePoints = function (uuid, callback) {
        //will call the callback with the data once loaded and add the program
        //to programs, keyed by the uuid
    },
    loadLinkedFiles = function (uuid, callback) {
        //will append the data to programs[uuid] and call the callback with the
        //data once loaded
    },
    loadProgram = function (uuid, callback) {
        //will append the data to programs[uuid] and call the callback with the
        //data once loaded
    },
    // hash where the key is the node on program and the value is the function
    // used to load the data, this will be based on project settings, but I'm not
    // concerned with this logic for this question
    requiredData = {
        cuePoints : loadCuePoints,
        linkedFiles : loadLinkedFiles
    },
    getProgram = function(uuid, callback) {
        if (programs[uuid]) {
            callback(programs[uuid]);
        } else {
            //assume the key in the requiredData hash is the required node on
            //Program, and that the value is the callback method, the functions
            //in this table sre already set up to load the data and return it
            //via the callback once loaded
        }
    } 
```

我当然可以解决这个问题，所以我并没有要求太多的解决方案（除非你有一些效果很好或特别优雅的东西），因为我在问是否有一个既定的模式来排队回调异步操作的集合。如果解释不清楚，我很乐意详细说明。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-21T17:32:54.313

如果使用 javascript 进行异步编程，您应该使用 Promise 模式。When.js 或 jquery.defered 可以用来解决你的问题。使用jquery的伪代码写在下面

```
 function oneArrayJquery(value) {
            var deffered = jQuery.Deferred();
            deffered.resolve(value);
            return deffered;
        }

        function loadAllArrayValues(imagearray) {
            var deffered = [];
            for (var i = 0; i < imagearray.length; i++) {
                deffered.push(oneArrayJquery(imagearray[i]));
            }
            return deffered;
        }

        var arrayvalue = [1, 3, 4];

        jQuery.when(loadAllArrayValues(arrayvalue)[0], loadAllArrayValues(arrayvalue)[1]).then(function (value1,value2) {
            alert(value1);
            }
        ) 
```

# linux - Fred 的 ImageMagick Scripts-3DRotation 不起作用，（3Drotate.sh：第 384 行：bc：找不到命令）

> ID：11143377
> 
> 赞同：0
> 
> 时间：2012-06-21T17:18:55.770
> 
> 标签：linux, bash, imagemagick

在 Fred 的 ImageMagick 脚本中，我尝试运行 3DRotate.sh，但收到错误消息。但是我可以运行 cartoon.sh 我不知道为什么？请如果有人知道这...帮助我...

我收到这样的错误消息。

```
 root@vps-1100110-10106 [~/imagick]# ./3Drotate.sh pan=45 auto=zc test.jpg testfile.jpg
./3Drotate.sh: line 195: bc: command not found
expr: warning: unportable BRE: `^[0-9][0-9]*$': using `^' as the first character
of the basic regular expression is not portable; it is being ignored
expr: warning: unportable BRE: `^[+-][0-9][0-9]*$': using `^' as the first character
of the basic regular expression is not portable; it is being ignored
expr: warning: unportable BRE: `^[0-9]*[\\.][0-9]*$': using `^' as the first character
of the basic regular expression is not portable; it is being ignored
expr: warning: unportable BRE: `^[+-][0-9]*[\\.][0-9]*$': using `^' as the first character
of the basic regular expression is not portable; it is being ignored
./3Drotate.sh: line 384: bc: command not found
./3Drotate.sh: line 385: bc: command not found
./3Drotate.sh: line 387: [: too many arguments
./3Drotate.sh: line 388: bc: command not found
./3Drotate.sh: line 389: bc: command not found
./3Drotate.sh: line 390: bc: command not found
./3Drotate.sh: line 391: bc: command not found
./3Drotate.sh: line 230: bc: command not found
./3Drotate.sh: line 230: bc: command not found
./3Drotate.sh: line 230: bc: command not found
./3Drotate.sh: line 230: bc: command not found
./3Drotate.sh: line 230: bc: command not found
./3Drotate.sh: line 230: bc: command not found
./3Drotate.sh: line 230: bc: command not found
./3Drotate.sh: line 230: bc: command not found
./3Drotate.sh: line 230: bc: command not found
./3Drotate.sh: line 576: bc: command not found
./3Drotate.sh: line 577: bc: command not found
./3Drotate.sh: line 578: bc: command not found
./3Drotate.sh: line 579: bc: command not found
./3Drotate.sh: line 582: bc: command not found
./3Drotate.sh: line 582: [: -eq: unary operator expected
./3Drotate.sh: line 586: bc: command not found
./3Drotate.sh: line 586: [: -eq: unary operator expected
./3Drotate.sh: line 646: bc: command not found
./3Drotate.sh: line 660: bc: command not found
./3Drotate.sh: line 661: bc: command not found
./3Drotate.sh: line 662: bc: command not found
./3Drotate.sh: line 663: bc: command not found
./3Drotate.sh: line 664: bc: command not found
./3Drotate.sh: line 665: bc: command not found
./3Drotate.sh: line 669: bc: command not found
./3Drotate.sh: line 670: bc: command not found
./3Drotate.sh: line 676: bc: command not found
./3Drotate.sh: line 689: bc: command not found
./3Drotate.sh: line 690: bc: command not found
./3Drotate.sh: line 691: bc: command not found
./3Drotate.sh: line 692: bc: command not found
./3Drotate.sh: line 693: bc: command not found
./3Drotate.sh: line 701: bc: command not found
./3Drotate.sh: line 230: bc: command not found
./3Drotate.sh: line 230: bc: command not found
./3Drotate.sh: line 230: bc: command not found
./3Drotate.sh: line 230: bc: command not found
./3Drotate.sh: line 230: bc: command not found
./3Drotate.sh: line 230: bc: command not found
./3Drotate.sh: line 230: bc: command not found
./3Drotate.sh: line 230: bc: command not found
./3Drotate.sh: line 230: bc: command not found

--- NOT A VALID SET OF MATRIX ROWS --- 
```

我的 Imagemagick

> `Version: ImageMagick 6.7.1-7 2012-06-18 Q16`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-21T19:20:27.333

BC 是一个计算器/数学程序，我假设它没有安装在您的服务器上。您可以要求您的主机安装它。

我认为这与您之前的帖子有关，并且使用 Freds 代码执行的操作可以在 Imagemagick 中完成，无论如何您需要计算出您想要的内容，并且可以使用标准 php 函数而不是 bc 来执行计算。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-21T18:55:55.000

尝试安装 bc： http: [//linux.about.com/od/commands/l/blcmdl1_bc.htm](http://linux.about.com/od/commands/l/blcmdl1_bc.htm)

（请注意，我假设您使用的是某种 *nix 风格）。

# ruby-on-rails - Rails 动作把我踢出去了，但仅限于 ajax 请求

> ID：11143378
> 
> 赞同：0
> 
> 时间：2012-06-21T17:19:04.607
> 
> 标签：ruby-on-rails, ajax, security

我有以下行动`appointments_for_week`：

```
class StylistsController < ApplicationController

  def appointments_for_week
    stylist = Stylist.find(params[:id])
    date = Time.zone.parse(params[:date])
    appointments = stylist.salon.appointments_flat(stylist.id,
                                                   (date + 1.day).beginning_of_week.advance(:days => -1),
                                                   (date + 1.day).end_of_week.advance(:days => -1) + 1.day)
    respond_to do |format|
      format.json { render :json => @appointments }
    end 
  end 
```

真正奇怪的事情正在发生。如果我登录然后简单地浏览到此操作的路线，则不会发生任何事情。我得到一个空白页，这是我所期望的。如果我然后转到另一个页面并刷新，我仍然登录，这当然是我所期望的。

但是，如果我通过 ajax 对此操作提出请求，它会将我踢出去。我觉得这非常奇怪。如果我添加一个`before_filter`跳过身份验证，我不再被踢出，但我当然不想跳过身份验证。我不明白为什么可以通过常规请求而不是 ajax 请求访问此操作。

这里会发生什么？

（我在 Rails 3.2.1 上，以防万一。）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-21T17:22:04.530

好吧，在我花了很长时间整理我的问题两秒钟后，我想通了。

ajax 请求是`POST`. 切换到`GET`使其工作。

有趣的是，它是`POST`以前的，并且完全相同的 JavaScript 工作。我唯一改变的是我更新了我的 jQuery 版本，所以我想它一定与它有关。

# django - django-messages messages_inbox_count 模板标签未按预期工作

> ID：11143382
> 
> 赞同：0
> 
> 时间：2012-06-21T17:19:26.267
> 
> 标签：django, django-templates

我是 django 的新手，并尝试使用 django-messages 为我的网站用户添加收件箱/撰写/发件箱/垃圾箱功能。从文档中，我完成了以下步骤：

1.  pip install django-messages
2.  添加`'messages',`到`INSTALLED_APPS`
3.  将 django-messages`'messages.context_processors.inbox',`上下文处理器添加到`TEMPLATE_CONTEXT_PROCESSORS`

最后，我尝试`messages_inbox_count`在我的一个模板中使用标签，如下所示：

```
<a href="/messages/inbox/">Inbox ({{ messages_inbox_count }})</a> 
```

但是，正如预期的那样，这不会在页面上显示任何收件箱计数。另外，使用 django-debug-toolbar 我可以看到它们确实是一个变量名messages_inbox_count。以下是django-debug-toolbar 的*模板侧边栏的片段：*

```
Context processors
django.contrib.auth.context_processors.auth
▶ Toggle Context
social_auth.context_processors.social_auth_by_name_backends
▶ Toggle Context
messages.context_processors.inbox
▼ Toggle Context
{'messages_inbox_count': 1}
django.core.context_processors.csrf
▶ Toggle Context
social_auth.context_processors.social_auth_backends
▶ Toggle Context 
```

我在这里真的做错了什么？修复似乎是一件愚蠢的事情，但我没有运气:(

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-22T11:46:44.547

您是使用 RequestContext-Instance 来呈现没有出现值的模板，还是只是一个上下文？

（例如：如果你使用 render_to_response，你需要确保包含一个`context_instance=RequestContext(request)`参数。）

# c# - VS2010 C# 表单不显示脏

> ID：11143383
> 
> 赞同：1
> 
> 时间：2012-06-21T17:19:26.723
> 
> 标签：c#, winforms, visual-studio-2010

我在一个项目中有一些表单在添加组件或控件后没有显示为“脏”。这导致表单无法保存 Designer.cs 文件。关闭表单并重新打开后，新控件将丢失。这不会发生在所有表单上，所以我知道它是特定于表单的。有什么想法吗？

# javascript - HTML 锚链接 - 带有确认对话框的 href

> ID：11143388
> 
> 赞同：0
> 
> 时间：2012-06-21T17:19:43.443
> 
> 标签：javascript, html, anchor

我想为锚标签使用确认对话框。所以我做了下面的代码：

```
<a href="javascript:a=2;if(confirm('sdsd'))__doPostBack('id','START');"> click </a> 
```

我使用伪协议来显示确认对话框。如果我在 doPostBack 中使用单行，如下所示：

```
<a href="javascript:if(confirm('sdsd'))__doPostBack('id','START');"> click </a> 
```

它工作正常。如果我使用另一行，则确认对话框取消工作很奇怪。我想使用内联脚本。是否可以在伪协议中使用多行？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-21T17:43:11.663

`href`将 JavaScript 包装在自执行函数中的丑陋属性中。

```
<a href="javascript:(function(){
    a=2;
    if(confirm('sdsd'))__doPostBack('id','START');
})()"> click </a> 
```

但更好的解决方案是：

```
<a href="#" onclick="(function(){
    a=2;
    if(confirm('sdsd'))__doPostBack('id','START');
})(); return false;"> click </a> 
```

# java - WebSphere 中 @PostConstruct 异常处理的行为

> ID：11143391
> 
> 赞同：3
> 
> 时间：2012-06-21T17:19:52.677
> 
> 标签：java, jsf, websphere-7, websphere-portal, postconstruct

简短：(Portlet-)Container 吞下支持 bean 中 @PostConstruct 方法抛出的异常。

这种行为是故意的，是错误还是容器特定？

Long：我在 WebSphere Portal 7 上运行一个 portlet，我在 PhaseListener 中强制构建托管 bean，以便当系统在 Bean 构建/构建后遇到不可恢复的问题时，它可以将用户发送回起始页面。

我正在使用以下代码来“强制”构造：

```
@SuppressWarnings("unchecked")
public static <T> T getManagedBean(final String beanName)
{
    final FacesContext context = getFacesContext();
    return (T)context.getApplication().evaluateExpressionGet(context, "#{" + beanName + "}", Object.class);
} 
```

我测试了从 @PostConstruct 方法抛出 RuntimeException

```
@PostConstruct
public void initialize()
{
    throw new RuntimeException("test");
} 
```

堆栈跟踪最终出现在 RAD(Eclipse) 日志中：

```
com.ibm.ws.webcontainer.annotation.WASAnnotationHelper doInvoke unable to invoke method --> [initialize] on class --> [foo.bar.UpdateAddress]
                             java.lang.reflect.InvocationTargetException
at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:60)
at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:37)
at java.lang.reflect.Method.invoke(Method.java:611)
at com.ibm.ws.webcontainer.annotation.WASAnnotationHelper.doInvokeSingle(WASAnnotationHelper.java:432)
at com.ibm.ws.webcontainer.annotation.WASAnnotationHelper.doInvokeChain(WASAnnotationHelper.java:400)
at com.ibm.ws.webcontainer.annotation.WASAnnotationHelper.doPostConstruct(WASAnnotationHelper.java:220)
at com.sun.faces.vendor.WebSphereInjectionProvider.invokePostConstruct(WebSphereInjectionProvider.java:86)
at com.sun.faces.mgbean.BeanBuilder.invokePostConstruct(BeanBuilder.java:225)
...
Caused by: java.lang.RuntimeException: test
    at foo.bar.UpdateAddress.initialize(UpdateAddress.java:119)
    ... 121 more 
```

但是在我的 PhaseListener 中没有异常可以捕获，并且在 @PostConstruct 期间它会愉快地继续，而不会意识到异常。

这种行为是故意的，是错误还是容器特定？

看起来至少 JBoss 有类似的处理方式：http: [//www.coderanch.com/t/499013/JSF/java/PostConstruct-exception-handling](http://www.coderanch.com/t/499013/JSF/java/PostConstruct-exception-handling)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-25T13:53:18.977

根据 Servlet 3.0 规范的第 15.5.9 节：

> 所有支持依赖注入的类都必须支持 @PostConstruct 注解，并且即使该类不请求注入任何资源，也必须调用该注解。如果方法抛出未经检查的异常**，则不得将类投入使用**，并且不能调用该实例上的任何方法。

如果您看到不同的行为，那么这看起来像是产品缺陷。如果 servlet 没有投入使用但异常被吞下，这听起来像是一个可服务性缺陷。无论哪种情况，我都建议与 IBM 建立 PMR。请注意，您的服务条款不太可能允许反编译 WebSphere Application Server 类，即使是出于调试目的。

# django - password_Reset_confirm 上的 NoReverseMatch

> ID：11143393
> 
> 赞同：19
> 
> 时间：2012-06-21T17:19:54.280
> 
> 标签：django

我在让 password_Reset_confirm 位工作时遇到问题。

网址：

```
(r'^password_reset/$', 'django.contrib.auth.views.password_reset'),
(r'^password_reset_done/$', 'django.contrib.auth.views.password_reset_done'),
(r'^password_reset_confirm/(?P<uidb36>[0-9A-Za-z]+)-(?P<token>.+)/$', 'django.contrib.auth.views.password_reset_confirm'), 
```

**password_reset_email.html**，其中包括：

```
{% load url from future %}
Someone asked for password reset for email {{ email }}. Follow the link below:
{{ protocol}}://{{ domain }}{% url 'password_reset_confirm' uidb36=uid token=token %} 
```

但是在提交我的重置密码的电子邮件后，我收到了以下错误消息：

> NoReverseMatch at /password_reset/ 使用参数 '()' 和关键字参数 '{'uidb36': '1', 'token': '38d-b5ec0b2a2321f522f954'}' 反向匹配'password_reset_confirm'。

我想既然这是使用构建视图，我就不必照顾其他任何事情了？

谢谢你的建议，

**更新：**

使用完整路径后，它似乎工作。但是它会发送两封电子邮件：每封都有不同的链接。这是为什么？我在哪里设置 {{ domain }}？谢谢

```
Follow the link below:
http://example.com/password_reset_confirm/1-38d-b5ec0b2a2321f522f954/

Follow the link below:
http://example.com/password_reset_confirm/2-38d-18482e1f129c84b9c2bc/ 
```

**更新 2**

我想到了。以防万一其他人有这个问题。您需要将您的域名设置为您的应用程序的站点：

在管理员或 django 控制台中：

```
>>> my_site = Site.objects.get(pk=1)
>>> my_site.domain = 'somedomain.com'
>>> my_site.name = 'Some Domain'
>>> my_site.save() 
```

重置时可能会收到两封电子邮件的另一个问题是，您可以将多个用户名与同一个电子邮件地址关联。它很傻。这是我接下来要解决的问题。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2014-04-30T10:03:35.303

要将 url 传递给`url`模板标签，您可以`name`在`urls.py`

```
url(r'^reset/(?P<uidb64>[0-9A-Za-z_\-]+)/(?P<token>[0-9A-Za-z]{1,13}-[0-9A-Za-z]{1,20})/$', 
views.password_reset_confirm, name='password_reset_confirm'), 
```

然后您可以使用带有 url 名称的标签

```
{% url 'password_reset_confirm' uidb64=uid token=token %} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-06-22T17:17:21.987

使用`url`模板标签时，您需要指定视图而不是 url 本身。由于您`'django.contrib.auth.views.password_reset_confirm'`在 URLConf 中使用，您应该像这样使用它：

```
{% url 'django.contrib.auth.views.password_reset_confirm' ... %} 
```

更多关于`url`Django 的[内置模板标签和过滤器](https://docs.djangoproject.com/en/dev/ref/templates/builtins/?from=olddocs#url)文档的模板标签。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-01-20T14:14:46.290

确保在你的 urls.py 中有这个：

```
urlpatterns = [
    url('^', include('django.contrib.auth.urls'))
] 
```

请参阅[https://docs.djangoproject.com/en/1.8/topics/auth/default/#django.contrib.auth.views.password_reset](https://docs.djangoproject.com/en/1.8/topics/auth/default/#django.contrib.auth.views.password_reset) 部分：身份验证视图

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-21T18:23:51.507

它可能是一个内置视图，但您仍然需要它的 URL。您应该在 urls.py 中定义一个并将其链接到`password_reset_confirm`视图。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-12-31T04:50:38.210

只需将此 URL 复制到您的主 urls.py 文件，以便它识别 URL 名称

> url(r'^reset/(?P[0-9A-Za-z_-]+)/(?P[0-9A-Za-z]{1,13}-[0-9A-Za-z] {1,20})/$', 'django.contrib.auth.views.password_reset_confirm', name='password_reset_confirm'),

# algorithm - 非唯一排序数组中的第 k 个最小元素

> ID：11143401
> 
> 赞同：9
> 
> 时间：2012-06-21T17:20:29.017
> 
> 标签：algorithm, data-structures, language-agnostic

这可能是一个微软面试问题。

从排序数组中找到第 k 个最小的元素（忽略重复项）。
**[编辑]**：数组可能包含重复项（未指定）。

想了很多次，但还是在问自己：**还有更好的解决方案吗？**

## 方法一：

取一个最大堆并插入前 k 个唯一元素[可以很容易地检查]。堆化堆。
现在，当一个新元素小于堆头时，用这个新元素替换堆头。最后，如果堆的大小为 k，则堆头指示第 k 个最小元素，否则第 k 个最小元素不存在。

时间复杂度：O(NlogK)
空间复杂度：O(K)

## 方法2[更好的方法]：

元素可以正确复制。因此，通过与之前的元素进行比较来检查唯一元素，如果到目前为止发现的唯一变量计数为 k，则停止。
时间复杂度：O(N)
空间复杂度：O(1)

## 方法3[更好的方法（可能）]：

也可以使用快速排序分区算法的修改版本。但可能会导致最坏的情况，因为数组已经排序。
这里出现了两个问题：
1.**如果数组包含重复项，它是否有效？**
2.**它会比我的第二个方法更好吗？**

* * *

我想知道**是否存在任何 O(logn) 解决方案？**

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-21T17:46:37.070

这是一个 O(kLogN) 解决方案：

使用二分搜索的变体来查找给定值的最后一次出现，

1.  获取第一个值 - O(1)。
2.  搜索该值的最后一次出现 O(logN)，然后查看下一个元素以获得第二个值 - O(1)。
3.  重复直到找到第 k 个值。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-06-21T17:41:17.430

*第k*个最小元素似乎有两种不同的解释。我假设它的意思是“第*k*个最小的元素，忽略重复项”。

最好的解决方案是 O(n) 时间和 O(1) 空间，正如您在方法 2 中描述的那样。我们可以证明这一点。

*   我们无法改进 O(1) 空间（至少不是在 O 表示法中）。
*   考虑一种运行时间小于 O(n) 的方法。这种方法不能考虑数组中的每个元素。考虑一个这样的遗漏元素。不知道该元素是否是它之前或之后的值的副本¹，并且需要此信息来断言数组中的哪个值对应于第*k*个最小值。

¹ 在两个不相邻的数组元素具有相同值的特殊情况下，可以推断出排序数组的任意长子序列的值：所有中间元素必须共享该值。但这不是一个典型的案例，所以我忽略了它。

# java - 具有多个继承类的通用返回类型的自引用方法

> ID：11143404
> 
> 赞同：10
> 
> 时间：2012-06-21T17:20:41.170
> 
> 标签：java, generics, inheritance, self-reference

可能有点难以描述。但是，我会尝试的；）

遵循流利的风格，一个类的方法通常返回类实例本身（this）。

```
public class A {

    public A doSomething() {

        // do something here

        return this;
    }

} 
```

当扩展这样一个流畅的样式类时，可以在第一个继承步骤中通过泛型类型很容易地做到这一点，并将返回类型转换为超类中的这个泛型类型。

```
public class A<T extends A<T>> {

    public T doSomething() {

        // do something here

        return (T) this;
    }

}

public class B extends A<B> {

    // an extended class of class A

} 
```

但是，当在这个扩展类上执行另一个继承步骤时，我在尝试定义方法的通用返回类型（在上层类中）和类描述本身时遇到了麻烦，例如，在 super-super 中的方法class 不会返回扩展类的类型，而是返回超类的类型。然而，我的意图是这些流畅的风格方法应该总是返回当前类的类型（而不是上层类）。

那么是否可以通过使用泛型来定义解决方案？

PS：我知道，一个简单的解决方法可能是覆盖扩展类中的所有这些方法并将它们转换为当前类型。但是，我对更优雅的解决方案感兴趣；）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-20T15:40:58.140

你可以试试：

```
class A<T> { }

class B<T extends A<? super T>> extends A<T> { }

class C extends B<C> { } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-21T17:46:21.967

你可以这样做：

```
public class TestFluent<T extends TestFluent<?>> {

    public T get() {
        return (T) this;
    }

    public static void main(final String[] args) {
        TestFluent2<TestFluent2<?>> f2 = new TestFluent2<TestFluent2<?>>();
        TestFluent2<?> result2 = f2.get();

        TestFluent3<TestFluent3<?>> t3 = new TestFluent3<TestFluent3<?>>();
        TestFluent3<?> result3 = t3.get();

        System.out.println(result2);
        System.out.println(result3);
    }
}

class TestFluent2<T extends TestFluent2<?>> extends TestFluent<T> {
}

class TestFluent3<T extends TestFluent3<?>> extends TestFluent2<T> {
} 
```

这将返回：

```
TestFluent2@7919298d
TestFluent3@62f72617 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-21T18:15:50.043

一般不可能“返回当前类的类型”。

即使您在上面发布的代码也不安全：`public class C extends A<B>`是合法的，但是调用`doSomething()`它，期待 a `B`，会崩溃。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-22T18:05:13.440

使用委托来实现可扩展的流畅接口。优点：没有演员表。缺点：冗长。

```
public interface FluentGranddad< C extends FluentGranddad< C > > {
    C appendFoo( Foo foo );
}
public interface FluentDad< C extends FluentDad< C > > extends FluentGranddad< C > {
    C appendBar( Bar b );
}
public interface FluentKid< C extends FluentKid< C > > extends FluentDad< C > {
    C appendSplat( Splat s );
}

public class Babbler implements FluentKid< Babbler > {
    FluentDad< ? > dad;
    public Babbler( FluentDad< ? > dad ) {
        this.dad = dad;
    }

    // delegation methods
    @Override public Babbler appendFoo( Foo foo ) {
        dad.appendFoo( foo );
        return this;
    }
    @Override public Babbler appendBar( Bar bar ) {
        dad.appendBar( bar );
        return this;
    }

    // example instance method
    @Override public Babbler appendSplat( Splat s ) {
        dad.getState().append( s.toString() );
        return this;
    }
} 
```

# .htaccess - 当来自外部链接时，将所有链接从 page1 重定向到 page2

> ID：11143405
> 
> 赞同：0
> 
> 时间：2012-06-21T17:20:41.350
> 
> 标签：.htaccess, redirect, rewrite

如何将所有**外部**链接（即从 Google 指向我的网站的点击）从 product.php?id=1&cat=2&show=3 重定向到 new_product.php?id=1&cat=2&show=3 ？

原因是，product.php 仅在没有页眉/页脚/菜单等的颜色框窗口中用于已经在网站上的用户。如果有人从 Google 结果直接链接到此页面，他们将获得不完整的布局，而 new_product.php 具有完整的布局。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-21T18:48:58.857

编辑：

你尝试过这样的事情吗？

```
RewriteCond %{HTTP_REFERER} !^$
RewriteCond %{HTTP_REFERER} !^http://(www\.)?yourdomain.com/.*$ [NC] 
```

现在规则如下：

```
RewriteRule ^product.php? http://yourdomain.com/new_product.php? [L,QSA,R=301] 
```

# r - 在 Hadoop 节点上临时安装 R 包以进行流式作业

> ID：11143406
> 
> 赞同：3
> 
> 时间：2012-06-21T17:20:42.797
> 
> 标签：r, hadoop, streaming

我可以访问具有基本 R (2.14.1) 但没有在每个节点中安装其他软件包的 Hadoop 集群。我一直在编写基本的 R 映射器和化简器流脚本来解决我没有其他包的事实。但是，我已经到了需要使用某些包（主要是 rjson）作为我的脚本的一部分的地步。

我在集群上没有管理员权限，并且用户帐户受到相当的限制。让集群管理员在每个节点上安装软件包不是一个选项（目前），并且集群没有外部互联网访问权限。

我已将 rjson_0.2.8.tar.gz 源文件上传到我的网关节点。是否可以通过添加`install.packages("rjson_0.2.8.tar.gz", repos = NULL, lib = /tmp)`或沿这些行临时安装 R 包，以便在脚本启动时安装包，并通过流作业的 -cacheArchive 参数传递源？我希望将软件包安装在临时位置，以便在作业完成后消失。

这甚至可能吗？

我知道我会得到一些“使用 python”的答案，因为它用于处理 JSON，这是一个选项，但问题是针对任何包。:)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-21T21:22:30.333

我是 rmr（项目 RHadoop）的作者。我们正在尝试一种非常激进的方法来回避安装问题。我们使用您描述的流式传输功能将整个 R 发行版、软件包和所有内容打包在一个 jar 中，但具有一定程度的间接性。R 发行版加载到用户 hdfs 目录，而不是 tmp 目录。流然后将其移动到每个节点。只要作业不存在，作业本身就会将其移动到最终目的地。我们这样做是因为整个发行版并不小，而且我们想利用流式传输的缓存功能，而且 R 的组件不可重定位。因此，每当您更新某些内容或添加包时，您都会重建 jar 并将其移动到 hdfs。其余的都是自动的，仅在需要时发生（hdfs->nodes->final location）。我什至从 Hortonworks 的人那里得到了一些指导来做正确的事。我们在分支 0-install 中有一个概念证明，但它仅适用于 ubuntu/EC2，显然我设法硬编码了一些我不应该拥有的路径，并且我正在做出许多其他假设，所以这只是对于愿意参与的开发人员，但主要成分都已到位。当然，这取决于您使用 rmr 编写工作，这是一个单独的决定，或者您可以查看代码并为您的目的重现该方法。但我宁愿为每个人一劳永逸地解决这个问题。准备 jar 的脚本是这样的：没有，我正在做一些其他的假设，所以这仅适用于愿意参与的开发人员，但主要成分都已经到位。当然，这取决于您使用 rmr 编写工作，这是一个单独的决定，或者您可以查看代码并为您的目的重现该方法。但我宁愿为每个人一劳永逸地解决这个问题。准备 jar 的脚本是这样的：没有，我正在做一些其他的假设，所以这仅适用于愿意参与的开发人员，但主要成分都已经到位。当然，这取决于您使用 rmr 编写工作，这是一个单独的决定，或者您可以查看代码并为您的目的重现该方法。但我宁愿为每个人一劳永逸地解决这个问题。准备 jar 的脚本是这样的：[https://github.com/RevolutionAnalytics/RHadoop/blob/0-install/rmr/pkg/tools/0-install/setup-jar](https://github.com/RevolutionAnalytics/RHadoop/blob/0-install/rmr/pkg/tools/0-install/setup-jar)其余操作在 rmr:::rhstream

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-21T17:50:21.297

您应该能够按照您对`-cacheArchive`参数的建议进行操作 - 但请注意，这已被弃用，您应该`-archives`改用它。

还有一点需要注意，使用`-archives`over`-files`意味着任务跟踪器将解压缩您的 tar.gz 文件（而不是您必须手动解压缩它）。

无论哪种方式，当您的代码执行时，文件或解压文件都将在当前工作目录中可用，并且从那里您将能够根据 R 中可用的机制注册模块包（我从未使用过 R，所以您'从这里你自己）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-25T11:13:17.660

您可以创建一个临时目录（例如，使用**R**中的 tempfile或python 中的**mkdtemp**）。确保目录的名称是唯一的，否则当多个映射器同时将包安装到同一位置时， **R**会报错。此临时目录可用作`install.packages`. 该目录位于`mapred.child.tmp`属性定义的位置。默认设置下，对应的mapper完成后会被移除。您还可以将 mapred.child.tmp 设置为特定位置（例如，`-D mapred.child.tmp=/tmp/`），但 Hadoop 可能不会删除临时目录。

# objective-c - 拉动刷新崩溃应用

> ID：11143407
> 
> 赞同：0
> 
> 时间：2012-06-21T17:20:47.057
> 
> 标签：objective-c, ios, xcode

我是 Objective-c 的新手，所以我有点难过，我在我的应用程序的另一部分有它，并且工作完美，但是当我在我的应用程序的不同视图上使用它时，它会使应用程序崩溃，我很确定我以相同的方式设置它。

我让 Xcode 在搞砸的代码和这段代码的第一行设置断点

```
 NSArray *timesArray = [self.tableDataArray objectAtIndex:2];
    NSDictionary *dictionary = [timesArray objectAtIndex:indexPath.row];
    cell.timeLabel.text = [dictionary objectForKey:@"time"];
    cell.destinationLabel.text = [dictionary objectForKey:@"destination"]; 
```

NSArray *timesArray 是停止的地方，但没有给出其他错误或任何东西，所以我有点不知道要改变什么。

编辑编号 1：为清楚起见，删除了旧编辑。

编辑编号 2

好的，所以我再次慢慢检查，结果是它对数据进行了 3 次完整解析，并输出了我拥有的所有内容。

```
2012-06-21 13:37:09.148 NextBus[5990:1a603] Array: (
    {
    routeName = "Oxford West";
    routeNumber = 17;
    stopDirection = Westbound;
    stopName = "Griffith At Commissioners Sb";
    stopNumber = 811;
},
"Next 3 Vehicles Arrive At:",
    (
            {
        destination = "To Byron Baseline / Griffith";
        time = "1:58 P.M.";
    },
            {
        destination = "To Byron Baseline / Griffith";
        time = "2:15 P.M.";
    },
            {
        destination = "To Byron Baseline / Griffith";
        time = "2:35 P.M.";
    }
),
"Prediction Last Updated 1:37:06 Pm 6/21/2012"
)
2012-06-21 13:37:09.148 NextBus[5990:1a603] Array: (
    {
    routeName = "Oxford West";
    routeNumber = 17;
    stopDirection = Westbound;
    stopName = "Griffith At Commissioners Sb";
    stopNumber = 811;
},
"Next 3 Vehicles Arrive At:",
    (
            {
        destination = "To Byron Baseline / Griffith";
        time = "1:58 P.M.";
    },
            {
        destination = "To Byron Baseline / Griffith";
        time = "2:15 P.M.";
    },
            {
        destination = "To Byron Baseline / Griffith";
        time = "2:35 P.M.";
    }
),
"Prediction Last Updated 1:37:06 Pm 6/21/2012"
)
2012-06-21 13:37:09.149 NextBus[5990:1a603] Array: (
    {
    routeName = "Oxford West";
    routeNumber = 17;
    stopDirection = Westbound;
    stopName = "Griffith At Commissioners Sb";
    stopNumber = 811;
},
"Next 3 Vehicles Arrive At:",
    (
            {
        destination = "To Byron Baseline / Griffith";
        time = "1:58 P.M.";
    },
            {
        destination = "To Byron Baseline / Griffith";
        time = "2:15 P.M.";
    },
            {
        destination = "To Byron Baseline / Griffith";
        time = "2:35 P.M.";
    }
),
"Prediction Last Updated 1:37:06 Pm 6/21/2012"
) 
```

当我拉动刷新它时

```
2012-06-21 13:37:45.590 NextBus[5990:1a603] Array: (
    {
    routeName = "Oxford West";
    routeNumber = 17;
    stopDirection = Westbound;
    stopName = "Griffith At Commissioners Sb";
    stopNumber = 811;
}
) 
```

然后由于某种原因崩溃，它停止解析。

它是 EGO 拉动刷新套件。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-21T17:30:01.100

编辑：

当您的查询返回的数据不足时，似乎会发生崩溃，例如，当没有时间可用于下一班车时。如果您可以确认这一点，那么修复是微不足道的：

```
if ([self.tableDataArray count] > 1) {
  NSArray *timesArray = [self.tableDataArray objectAtIndex:2];
  NSDictionary *dictionary = [timesArray objectAtIndex:indexPath.row];
  cell.timeLabel.text = [dictionary objectForKey:@"time"];
  cell.destinationLabel.text = [dictionary objectForKey:@"destination"];
} else {
  //-- do something to show that no times are available
} 
```

您可能试图访问超出其边界的数组：

```
 NSArray *timesArray = [self.tableDataArray objectAtIndex:2]; 
```

`timesArray`没有3个元素，然后程序崩溃......

您应该查看填充数组的方式与您对此操作的期望。

编辑：

根据您对问题所做的编辑，您似乎正在执行您多次发布的行，并且只是最后一次程序崩溃。如您所见，在前几次迭代中，您的数组填充了足够的元素；在最后一种情况下：

```
2012-06-21 13:25:03.448 NextBus[5964:1a603] Array: (
{
routeName = Springbank;
routeNumber = 5;
stopDirection = Eastbound;
stopName = "Berkshire At Berkshire Place Sb";
stopNumber = 2196;
} 
```

数组只有一个对象。这是一个你应该以不同方式处理的极端情况吗？

# c - 带有 URL 内容的 C char*

> ID：11143413
> 
> 赞同：0
> 
> 时间：2012-06-21T17:21:09.733
> 
> 标签：c, stream, char

我正在这里做一些功课，但我已经完全没有想法了。我需要用 C 语言制作一个简单的网络浏览器，其中必须包括简单的 HTML 阅读。这通常很容易，但挑战在于：挑战自己，我想使用尽可能少的库。*如果必须，*我可以使用任何库。

我需要用 C 中的 URL 的内容填充一个 char*，但我不知道该怎么做。对此有什么想法吗？

请注意，这不是类似问题的重复，因为我问的是 C，而不是库。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-21T18:44:25.480

您需要编写一个基本的 HTTP 客户端。以下基本操作是必要的：

1.  解析 URL 并提取服务器部分和路径部分。
2.  使用套接字连接到服务器。套接字是您读取和写入的通道。
3.  使用路径编写 HTTP GET 请求。
4.  读取 HTTP 响应，该响应由一些标头和正文组成。
5.  将标头解析为有意义的数据，例如状态、正文长度、mime 类型和编码。
6.  如有必要，解码“分块”编码。

您现在应该可以开始使用 Google 搜索了。

# git - 在 git 历史中，压缩提交相距甚远

> ID：11143414
> 
> 赞同：1
> 
> 时间：2012-06-21T17:21:15.060
> 
> 标签：git, git-rebase

说，我有 3 个`git`提交`A, B`和`C`. 是否可以在继续使用的`squash` `A`同时`C`一起`B`使用`git rebase`？如果是，我该如何做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-21T17:24:07.307

是的，你可以这样做——只要它不冲突（或者你可以在冲突中修复它）。

在交互模式 ( `git rebase -i`) 中重新排列线条以将它们放在一起并将它们标记为壁球。

您可以使用相同的方法重新排序/删除任何提交。

# ocaml - 为什么使用 sexp 返回注释类型会导致未绑定值 int_of_sexp？

> ID：11143415
> 
> 赞同：6
> 
> 时间：2012-06-21T17:21:17.260
> 
> 标签：ocaml, camlp4

使用 sexplib 语法扩展为一个类型自动生成序列化代码，网上很多简单的例子都有展示：

```
open Sexplib
type t = { foo : int; bar : string; } with sexp
let v = { foo = 3; bar = "baz"; } in
sexp_of_t v 
```

编译失败，有`Error: Unbound value int_of_sexp`.

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-21T17:21:18.367

在较新版本的 sexplib 中，您需要首先`open Sexplib.Std`在生成代码的命名空间中包含标准类型序列化例程。

所以：

```
open Sexplib
open Sexplib.Std (* newly essential import *)
type t = { foo : int; bar : string; } with sexp
let v = { foo = 3; bar = "baz"; } in
sexp_of_t v 
```

作品。

# wordpress - 特定日期的 Wordpress 提要参数

> ID：11143417
> 
> 赞同：1
> 
> 时间：2012-06-21T17:21:29.823
> 
> 标签：wordpress, rss

是否可以查询股票 wordpress 博客以返回日期 A 和 B 之间项目的 RSS 提要？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-23T23:22:21.997

我一直在寻找这个问题的答案，并在[WordPress Codex WP_Query 类参考中发现了以下注释](http://codex.wordpress.org/Class_Reference/WP_Query#Time_Parameters)

> 注意：以上查询返回历史中特定日期时间段的帖子，即“X 年 X 月 X 日的帖子”。他们无法从相对于现在的时间跨度中获取帖子，因此基本查询无法使用诸如“过去 30 天的帖子”或“去年的帖子”之类的查询，并且需要使用 posts_where 过滤器完全的。

因此，从 Wordpress 3.4.2 开始，这仍然不可能使用具有合适查询参数的提要 URL。

如果您正在为 Wordpress 编码，您将需要使用 post_where，或者通过检查提要 XML 中 pubDate 元素中的日期来创建自己的脚本来解决此问题。

# c - 在 C 中读取一行未知格式

> ID：11143419
> 
> 赞同：0
> 
> 时间：2012-06-21T17:21:42.693
> 
> 标签：c, string, file, scanf

我需要用 C 编写一个程序来读取文本，并用另一个字母替换一个字母。我是编程新手，到目前为止我一直使用该`fscanf`功能。如何在不知道格式的情况下阅读一行文本？

我什至不知道文件的长度...

有我的“file.txt”：

```
Nel mezzo del cammin di nostra vita
mi ritrovai per una selva oscura,
ché la diritta via era smarrita.
Ahi quanto a dir qual era è cosa dura
esta selva selvaggia e aspra e forte
che nel pensier rinova la paura!
Tant' è amara che poco è più morte;
ma per trattar del ben ch'i' vi trovai,
dirò de l'altre cose ch'i' v'ho scorte.
Io non so ben ridir com' i' v'intrai,
tant' era pien di sonno a quel punto
che la verace via abbandonai. 
```

我需要用“n”更改每个“m”，然后打印出结果。感谢您的帮助

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-21T17:24:49.287

只需确定最大缓冲区长度并使用以下命令读取它[`fgets`](http://www.cplusplus.com/reference/clibrary/cstdio/fgets/)：

```
FILE *file = fopen(...);
char buffer[256];

fgets(line,256,file); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-21T18:04:31.497

```
#include <stdio.h>

enum { OLDCH = 'm', NEWCH = 'n' };

int main()
{
    int c;

    while ( (c = getchar()) != EOF ) {
        if( c == OLDCH )
            c = NEWCH;
        putchar(c);
    }

    return 0;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-21T23:21:43.470

```
#include <stdio.h>

char* repchar(char *str, char from, char to){
    if(str != NULL){
        char *p;
        for(p=str;*p;++p){
            if(*p == from)
                *p = to;
        }
    }
    return str;
}

int main(){
    char line[256];
    FILE *fp;
    fp=fopen("file.txt","r");
    //input of one line to char[] by scanf
    //%[^\n] order takes as input a non '\n'
    //%*[\n] ignore input '\n'
    while(fscanf(fp, "%[^\n]%*[\n]", line)==1){
        printf("%s\n", repchar(line, 'm', 'n'));
    }
    fclose(fp);
} 
```

# c++ - C++ MFC 程序是完全原生的吗？

> ID：11143420
> 
> 赞同：2
> 
> 时间：2012-06-21T17:21:44.700
> 
> 标签：c++, windows, mfc

我希望创建一个不需要任何环境依赖项（如 Java JRE 或 .NET）的 Windows 程序。我需要该程序开箱即用并在 95 到 7 之间的任何版本的 Windows 上工作。

使用 C++ 和 MFC 创建它是可行的方法吗？

谢谢，

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-21T17:31:43.727

是的，它是“本地的”，但这并不意味着您不会有依赖项（我认为这就是您要问的）。

如果您与 MFC 动态链接，您将依赖 MFC，您必须[重新分配](http://msdn.microsoft.com/en-us/library/ms235264%28v=vs.100%29.aspx)

您可以与 MFC 库进行静态链接，在这种情况下，所需的所有目标代码都包含在您的可执行文件中。但[不推荐静态链接](http://msdn.microsoft.com/en-us/library/ms235316.aspx)（原因之一是出于安全考虑 - 除非您这样做，否则无法将 MFC 的安全更新推送到您的应用程序）。

# php - 在 html 页面上，如何让 PHP 使用多行？

> ID：11143422
> 
> 赞同：0
> 
> 时间：2012-06-21T17:21:58.120
> 
> 标签：php, html

html 页面上的这段代码是一行。为什么反斜杠 n 不起作用？

```
 <?php
        $text1 =  "I don't understand how this works!  \nHow the hell do I get this thing to use \nmulti lines in PHP???!!!";
        echo $text1;
    ?> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-21T17:23:24.563

结果是多行的。HTML 只是忽略换行符（请参阅页面的源代码以查看它）。您可能想`<br>`在 HTML 中使用换行符。

```
<?php
$text_to_echo =
    "I don't understand how this works!<br>\n
How the hell do I get this thing to use <br>\n
multi lines in PHP???!!!";
echo $text_to_echo; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-21T17:31:46.007

像这样使用[nl2br()](http://in.php.net/nl2br)函数。

```
<?php
        $text1 =  nl2br("I don't understand how this works!  \nHow the hell do I get this thing to use \nmulti lines in PHP???!!!");
        echo $text1;
    ?> 
```

# ruby - 使用 RVG 创建新图像时，RMagick 会忽略不透明度

> ID：11143427
> 
> 赞同：4
> 
> 时间：2012-06-21T17:22:12.720
> 
> 标签：ruby, imagemagick, rmagick

我正在尝试生成具有透明背景的图像，但甚至没有创建只是透明 png 作品的图像。我试过这个：

```
require "rvg/rvg"

rvg = Magick::RVG.new(100, 100)
rvg.background_fill = "pink" # Shouldn't matter
rvg.background_fill_opacity = 0
rvg.draw.write("transparent.png") 
```

生成：

![在此处输入图像描述](../Images/ae7581cf1b61dc0048d0ae2d449aa77a.png)

我也试过：

```
rvg.background_fill.opacity = 0
rvg.styles(:fill_opacity => 0)
rvg.styles(:opacity => 0) 
```

他们都以一个纯粉红色的矩形结束。

如何使用 RMagick 的 RVG 生成透明 png？

**更新**：图像似乎甚至不打算是透明的：

```
1.9.2p320 :007 > rvg.draw
 => transparent.png  100x100 DirectClass 8-bit 
1.9.2p320 :008 > rvg.draw.alpha
 => false 
1.9.2p320 :009 > rvg.draw.alpha?
 => false 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2015-01-11T23:29:40.207

在 rvg.image.write 之前，添加以下行：

rvg.draw.alpha(Magick::ActivateAlphaChannel)

然后你不需要设置 background_fill 并且生成的图像将是漂亮、平滑的透明图像。

# opengl - 具有交错数组缓冲区的 glNormalPointer

> ID：11143431
> 
> 赞同：1
> 
> 时间：2012-06-21T17:22:31.897
> 
> 标签：opengl

我在 C++ 中创建了一个交错的顶点数组：

```
struct vertex
{
    GLfloat position[3];
    GLbyte normal[3];
};
std::vector< vertex > vertices;
// fill in vertices... 
```

我将数组复制到 gl 缓冲区：

```
GLuint vertsBuffer;
glBindBuffer (GL_ARRAY_BUFFER, vertsBuffer);
glBufferData (GL_ARRAY_BUFFER, vertices.size () * sizeof (vertex), vertices.data (), GL_STATIC_DRAW); 
```

例如，是否可以将 glNormalPointer 与这样的交错数据一起使用？

```
glBindBuffer (GL_ARRAY_BUFFER, vertsBuffer);
glEnableClientState (GL_NORMAL_ARRAY);
glNormalPointer (GL_BYTE, sizeof (vertex), (GLvoid*) offsetof (vertex, normal)); 
```

还是我必须改用 glVertexAttribPointer ？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-21T17:27:39.453

`gl_Normal` [如果您使用内置](http://www.opengl.org/registry/doc/GLSLangSpec.Full.1.20.8.pdf)的遗留 GLSL（第 7.3 节，第 49 页），那应该可以正常工作。

`glVertexAttribPointer()`虽然更向前兼容。

# algorithm - 预约调度算法（N 人有 N 个空闲-忙碌时隙，约束-满足）

> ID：11143439
> 
> 赞同：27
> 
> 时间：2012-06-21T17:22:55.450
> 
> 标签：algorithm, graph, constraint-programming

**问题陈述**

我们有一个雇主想要面试 N 个人，因此安排了 N 个面试名额。每个人都有这些时段的闲忙时间表。如果可能，请给出一个算法，将 N 人安排到 N 个插槽中，如果不可能，则返回标志 / 错误 / 等。最快的运行时复杂度是多少？

**到目前为止我的方法**

天真：有N个！安排N个人的方法。遍历所有这些，对于每个排列，检查它是否可行。在！ ）

回溯：

1.  寻找任何只能有 1 人的面试时间段。安排此人，将其从候选人列表中删除并删除空档。
2.  寻找任何只能进入 1 个位置的候选人。安排此人，将其从候选人列表中删除并删除空档。
3.  重复 1 和 2，直到不再有类似的组合。
4.  选择一个人，将他们随机安排到他们可用的位置之一。记住这个操作。
5.  重复 1、2、3，直到我们有时间表或出现无法解决的冲突。如果我们有时间表，请将其退回。如果存在无法解决的冲突，请回溯。

这是 O(n!) 最坏的情况，我认为 - 这也好不到哪里去。

也可能有一个 DP 解决方案 - 但我还没有看到它。

**其他想法**

问题可以用 NxN 矩阵表示，其中行是“槽”，列是“人”，值为“1”表示空闲，“0”表示忙碌。然后，我们在这个矩阵中寻找一个行列交换的单位矩阵。步骤 1 和 2 正在寻找只有一个“1”的行或列。（如果矩阵的秩=N，则表示有解。但反之不成立）另一种看待它的方法是将矩阵视为未加权的有向图边矩阵。然后，每个节点代表 1 个候选和 1 个槽。然后，我们正在寻找一组边，以便图中的每个节点都有一条出边和一条入边。或者，如果有 2 个节点，它将是一个二分图。

矩阵示例：

```
1 1 1 1
0 1 1 0
1 0 0 1
1 0 0 1 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-06-21T18:12:41.627

正如您所指出的，该问题等效于在二分图中找到最大匹配的问题（一组顶点是人的集合，另一组在插槽集上，人和插槽之间有一条边如果此人有空）。

这个问题可以用[Hopcroft-Karp 算法](http://en.wikipedia.org/wiki/Hopcroft%E2%80%93Karp_algorithm)来解决。

最坏情况下的复杂度为 O(n^(5/2))，如果图稀疏则更好。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2012-06-21T18:38:15.640

至于约束编程方法，它可以以不同的方式建模，例如使用矩阵方法和基于集合的方法。

下面以高级 CP 语言[MiniZinc](http://www.g12.csse.unimelb.edu.au/minizinc/)显示了基于集合的方法。s 是每个时间段可用的人（使用集合表示法）；决策变量是数组 x（每次应该分配给哪个人）。

```
包括“globals.mzn”；
整数：n = 4；

每个时段的空闲人数百分比
数组 [1..n] 的 int 集合：s =  
[{1,2,3,4},
 {2,3},
 {1,4},
 {1,4}];

% 决策变量
% 人员分配到一个位置（预约号 1..n）
var 1..n 的数组 [1..n]: x;

解决满足；

约束
  % 确保指定时间段的人员空闲
  forall(i in 1..n) (
    x[i] 在 s[i]
  )
  /\ % 确保每个人都有一个不同的时间段
  不同的（x）
;

输出[显示（x）]；

```

模型输出这 4 个解决方案（在 0.5 毫秒内），例如时间 1 分配给人员 3 等。

```
x: [3, 2, 4, 1]
----------
x: [2, 3, 4, 1]
----------
x: [3, 2, 1, 4]
----------
x: [2, 3, 1, 4]

```

MiniZinc 模型在这里：[appointment_scheduling_set.mzn](http://www.hakank.org/minizinc/appointment_scheduling_set.mzn)

矩阵方法模型在这里（没有输出部分）并使用标准整数编程方法：[约会](http://www.hakank.org/minizinc/appointment_scheduling.mzn)_调度.mzn 。

```
整数：n = 4；

% 行是时隙
% 列是人
int 的数组 [1..n, 1..n]：m = array2d(1..n, 1..n,
[
1, 1, 1, 1,
0, 1, 1, 0,
1, 0, 0, 1,
1, 0, 0, 1,
]);

% 决策变量
% 人员分配到一个位置（预约号 1..n）
var 0..1 的数组 [1..n, 1..n]: x;

解决满足；

约束
  forall(i in 1..n) (
    % 确保一个空闲槽
    sum([m[i,j]*x[i,j] | j in 1..n]) = 1

    /\ % 确保每个位置和每个人分配一个
    sum([x[i,j] | j in 1..n]) = 1
    /\
    sum([x[j,i] | j in 1..n]) = 1
  )
;

```

该模型的解决方案是相同的，尽管以另一种（更冗长）的方式呈现，并且 - 碰巧 - 与基于集合的方法的顺序相同

```
插槽 1：3
插槽 2：2
插槽 3：4
插槽 4：1
----------
插槽 1：2
插槽 2：3
插槽 3：4
插槽 4：1
----------
插槽 1：3
插槽 2：2
插槽 3：1
插槽 4：4
----------
插槽 1：2
插槽 2：3
插槽 3：1
插槽 4：4

```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-06-21T18:05:09.550

我相信你可以使用[网络流](http://en.wikipedia.org/wiki/Maximum_flow_problem)。

*   `u_i`为候选者创建一个顶点`i`，`v_j`为槽创建一个顶点`j`。
*   创建一个源节点`s`并将（有向）边从`s`每个`u_i` 容量 1 放置。
*   制作一个汇节点`t`并从每个容量为 1 的`v_j`to放置一条边。`t`
*   如果候选人可以在插槽中面试，则将优势从`u_i`到。`v_j``i``j`
*   我们有`O(N)`顶点和`O(N^2)`边，最大*可能的*流量是`N`。
*   例如，使用[Ford-Fulkerson 算法](http://en.wikipedia.org/wiki/Ford%E2%80%93Fulkerson_algorithm)求最大流，`O(E*f)`其中`E`是边数，`f`是最大流的值，所以需要`O(N^3)`。
*   如果最大流是`N`，那么我们有一个时间表：如果边缘有流 1，那么我们在 slot中`(u_i,v_j)`面试候选人，否则是不可能的。`i``j`

根据积分流定理，最大流将在边上具有整数流，即 0 或 1，因此我们确实有一个有效的时间表。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-06-21T18:14:28.677

这是[最大二分匹配问题](http://en.wikipedia.org/wiki/Matching_%28graph_theory%29#Maximum_matchings_in_bipartite_graphs)。

根据图的密度，最快的解决方案可能是[Hopcroft-Karp 算法](http://en.wikipedia.org/wiki/Hopcroft-Karp_algorithm)，它最多在 O(N^(5/2)) 时间内运行，但可能要快得多。

# javascript - 显示提及某人的最后 N 条推文

> ID：11143440
> 
> 赞同：0
> 
> 时间：2012-06-21T17:22:58.440
> 
> 标签：javascript, jquery, http, twitter

我希望实现以下目标：

对于一个特定的人，比如说 BarackObama，我想看看他被**提及**的最后 100 次。所以不是他自己的推文，而是包含@BarackObama 的其他人的推文。

我一直在尝试使用 Twitter API，取得了成功，但没有成功解决上述问题。

提前非常感谢！大号

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-22T11:46:12.447

仅供参考，我在下面找到了脚本，这应该可以满足我的需求！需要在我的服务器上安装 Python，仅此而已。只有以下问题仍然存在：

**C:\Users\Administrator\Desktop>get_tweets.py Traceback（最近一次调用最后）：文件“C:\Users\Administrator\Desktop\get_tweets.py”，第 32 行，在 csv_writer.writerow(('User',' Tweet')) TypeError: 'str' 不支持缓冲区接口**

这意味着什么？谢谢！

```
## Retrieve a user's tweets
## Sample usage -- python get_tweets.py user_name_list.txt output.csv

##import urllib2
import sys
import csv
import urllib
##import simplejson
import json as simplejson
import traceback

COUNT=100

URL_LOCATION="https://api.twitter.com/1/statuses/user_timeline.json?"
params = {'include_entities':'true',
         'include_rts':'true',
         'screen_name':'Ilse_.....=>fill in username here',
         'count':COUNT
         }

def check_unicode(text):
    if isinstance(text,unicode):
        text = text.encode("UTF-8","ignore")
        return text
    elif isinstance(text,str):
        text= unicode(text,"UTF-8").encode("UTF-8","ignore")
    return text    

csv_writer = csv.writer(open(sys.argv[2],"wb"))
csv_writer.writerow(["User","tweet"])
user_list = open(sys.argv[1],"rb")
cnt=0
for each_user in user_list:
    print(cnt) 
    params['screen_name']=each_user
    encoded_url = urllib.urlencode(params)
    API_CALL = URL_LOCATION + encoded_url
    print(API_CALL) 
    try:
        data = urllib.urlopen(API_CALL).read()
        json_data = simplejson.loads(data)
        for each_timeline in json_data:
            csv_writer.writerow([each_user,check_unicode(each_timeline['text'])])            
    except:
        # Some Crap Failed !!!
        print(traceback.format_exc()) 
    cnt+=1 
```

# sencha-touch-2 - 如何取消嵌套列表的 listchange 事件？

> ID：11143441
> 
> 赞同：0
> 
> 时间：2012-06-21T17:22:58.490
> 
> 标签：sencha-touch-2, sencha-architect

我在嵌套列表的项目模板中有一个按钮，当用户单击时，我不想在列表之间移动。谢谢你的帮助

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-21T21:57:37.433

我认为，一个简单`return false`的听众应该可以解决问题

```
...
listeners:{
  listchange:function(){
    return false
  }
}
... 
```

希望这可以帮助

# mysql - 动态访问的 URL 与 CodeIgniter 中存储在数据库中的 url 不同

> ID：11143444
> 
> 赞同：1
> 
> 时间：2012-06-21T17:23:09.087
> 
> 标签：mysql, codeigniter, codeigniter-url, codeigniter-datamapper

我正在创建一个 cms，用户可以在其中上传带有标题的 url。这些 URL 和标题，我在网站的首页动态访问。假设我上传了一个网址：www.google.com 和标题：google；然后我的首页显示网址：**http://localhost/project/index.php/www.google.com**和标题：google

这是我在视图页面中运行的 foreach 循环，用于显示 url 和标题。

```
 <?php foreach($links as $a) { ?>
        <a href="<?php echo $a -> url; ?>" class="quicklinks"><b><?php echo $a -> url_title; ?></b></a>
 <?php } ?> 
```

回声**$a -> 网址；**指向表中的**URL**列并**echo $a -> url_title**；是指向表的**url 标题列**。我正在使用 datampper 进行数据库编码。请帮我只显示 www.google.com 。非常感谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-21T17:43:51.107

只需在存储的 URL 前添加“http://”（如果它不包含此 URL）或修改您的脚本以在插入之前将“http://”（或“https://”）添加到提交的链接中入数据库。

为此，您可以使用`prep_url()`URL 助手中的 CodeIgniter 函数：

[http://codeigniter.com/user_guide/helpers/url_helper.html](http://codeigniter.com/user_guide/helpers/url_helper.html)

# c# - C# Visual Web Developer：将目录中的所有文件列为 DropDownList

> ID：11143450
> 
> 赞同：0
> 
> 时间：2012-06-21T17:23:35.630
> 
> 标签：c#

我正在开发一个显示报告的网页。该报告每月更新一次，我希望可以选择显示以前的报告以及当前的报告。我什至不知道从哪里开始，我希望得到建议。我能想到的就是以某种方式在 DropDownList 中显示目录中的所有报告（如果可能的话）。

任何建议表示赞赏。

问候。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-21T17:38:39.537

使用[Directory.GetFiles](http://msdn.microsoft.com/en-us/library/07wt70x2.aspx)方法获取目录中的文件列表。

然后，您可以将此列表用作 DropDownList 控件的数据源

```
var fileList = Directory.GetFiles("path to your dir");
DropDownList ddl = new DropDownList();
ddl.DataSource = fileList;
ddl.DataBind(); 
```

# data-structures - 优先队列的时间？

> ID：11143451
> 
> 赞同：0
> 
> 时间：2012-06-21T17:23:36.493
> 
> 标签：data-structures, computer-science

*   一个优先级列表构建一个包含 n 个节点的列表需要多长时间？它是如何在上述时间内做到这一点的？

*   *delete-min*函数（检索最小元素并将其从列表中删除）需要多长时间？它是如何在上述时间内做到这一点的？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-21T17:27:30.847

取决于您如何构建优先队列。如果您使用的是堆结构，则需要 nlogn 来构建优先级队列。我记得建立最小堆的方法也可以在 O(N) 中完成。查看 CLRS 了解更多信息。

查看堆结构以了解它是如何构建堆结构的。本质上，您的比较器将是节点的优先级。

delete-min 需要 O(logn)。再看堆数据结构。

[http://en.wikipedia.org/wiki/Heap_%28data_structure%29](http://en.wikipedia.org/wiki/Heap_%28data_structure%29)

您还可以将链表用于优先级队列。对于链表，delete min 也是常量。但是，根据您的输入，构建优先级队列可能会上升到 O(N^2)。

# android - 使用单选按钮选择要播放的 mp3 文件

> ID：11143453
> 
> 赞同：0
> 
> 时间：2012-06-21T17:23:39.270
> 
> 标签：android

我不一定要求代码，而是更多关于如何实现以下内容的概念。

我正在创建一个鸟鸣应用程序，其中我有一个按钮，当用户选择一个或另一个时，它需要播放两个不同的 mp3 文件。我希望有一个“播放”按钮，然后是一个单选按钮，用于选择要播放的 mp3_A 或 mp3_B。

我将如何实现这一目标？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-21T17:35:01.653

如果你真的需要一些很可能有人已经有教程的东西，请尝试谷歌关键字。

这是谷歌搜索的第一种类型：[site。](http://www.hrupin.com/2010/12/simple-android-mp3-media-player)

哦，完全忘记了只使用媒体播放器类的基础知识，例如在单击单选按钮时停止和打开应该可以解决您的这个请求。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-25T16:19:32.853

多谢你们。本主题描述了一个很好的修复！

[http://blog.nelsondev.net/?p=385](http://blog.nelsondev.net/?p=385)

# ssl - CSR 如何融入 SSL 证书生命周期

> ID：11143457
> 
> 赞同：3
> 
> 时间：2012-06-21T17:23:44.740
> 
> 标签：ssl

因此，您决定使用像 VeriSign 这样的 CA（或任何人，对这个问题无关紧要）。您向他们申请 SSL 证书。该 CA 会调查您以确保您在申请中提供的信息是真实的，并且您就是您所说的那个人。最后，CA 授予您 SSL 证书。

我对企业社会责任、它们是什么、谁发布它们、谁响应它们以及它们在哪里/如何适应上述场景感到非常困惑**：**

*   **证书签名请求**：对我来说，这意味着“签署证书的请求”。那么，谁提出请求呢？谁签字？为什么这是必要的？
*   何时生成 CSR？什么时候采取行动？CSR 支持哪些后续程序/行动（在签署过程中）？
*   CSR 如何适应上述场景？

提前致谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-21T18:01:45.133

这个名字令人困惑——它不是一个证书签名请求，而是一个证书*请求*。当您需要从 CA 获取证书时，请执行以下操作：

在客户端，您生成一个密钥对（公钥和私钥）。您将私钥保存在安全的地方，并且您（您的生成器软件）通常以 PKCS#10 格式创建证书请求（使用了另外一种格式，这种格式比较少见）。此请求是由您和您的软件填写的各种字段的二进制 ASN.1 序列。该请求还包括您的公钥。

接下来，证书请求被发送到 CA（通常通过 HTTPS 传输）。CA 通过解析请求并*创建*包含您的公钥的证书来处理请求。请求中提供的一些信息（主要是您的姓名/组织名称，称为 Subject Name）被复制到证书中。证书使用 CA 的私钥签名。

该程序可以自动化，但通常需要人工验证，因为您需要提供身份信息（公司文件、您的文件等）。

最后，您会收到来自 CA 的签名证书。您可以将其与私钥结合使用，也可以将它们分开。

# java - 将 DLL 包装到 Java 中

> ID：11143460
> 
> 赞同：0
> 
> 时间：2012-06-21T17:23:56.327
> 
> 标签：java, c++, swig, jna

我有一些代码可以与 Windows 上使用 C++ 工作的硬件设备通信。代码做了一些非常简单的事情来对设备上的按钮做出反应，我将它编译成一个带有观察者的 dll，当按钮被按下时调用该观察者。我现在需要将它与一个大型 Java 程序连接起来。

我打算使用 JNA，但它只适用于 C，我看不到如何使用 C 中的观察者模式来做到这一点。我研究过使用 BridJ 和 SWIG（这两个 cliam 都可以在 C++ DLL 上工作）来创建一个与已编译 dll 的接口（带有关联的头文件），但 BridJ 创建了大量文件（在 JNAeratorStudio 中），然后因错误而停止，我看不到如何使用 SWIG 在 Windows 上开始（我使用的是 Visual Studio Express 而不是比完整的 Visual Studio）。

有谁知道有关将 C++ DLL 与 Java 程序集成的教程 - SWIG 看起来很有希望，但这些教程是“沼泽”。

我放了一些简单的 C 代码来与下面的 DLL 对话：

```
#include <iostream>
#include <stdio.h>

#include "DeepFocusControlDll.h"

using namespace std;
using namespace DeepFocusControl;

class MyObserver : public DeepFocusControl::DeepFocusObserver{
    void Event(){
        printf("***Button Pushed***");
    }
};

int main()
{
    DeepFocusControl::AVA6Control* dfc = new DeepFocusControl::AVA6Control();
    MyObserver* observer = new MyObserver();
    dfc->AddObserver(observer);
    bool connected = dfc->IsConnected();
    printf("Connected %s\n", (connected)?"true":"false");
    bool connectresult = dfc->Connect();
    printf("Connecting %s\n", (connectresult)?"true":"false");
    connected = dfc->IsConnected();
    printf("Connected %s\n", (connected)?"true":"false");
    dfc->SetHardwareAppLaunch(false);
    char waitChar;
    cin >> waitChar;
    dfc->SetHardwareAppLaunch(true);
    dfc->RemoveObserver(observer);
    dfc->Disconnect();
    printf("Disconnected\n");
    cin >> waitChar;
} 
```

如果有人知道在此使用观察者模式的更简单方法，我也可以很高兴地重新编码 C 端。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-22T15:11:01.440

听起来您正在寻找 SWIG 的[导演功能](http://www.swig.org/Doc1.3/Java.html#java_directors)。在最简单的形式中，您可以通过提供如下接口文件来使用带有 SWIG 的导向器：

```
%module(directors=1) MyModule
%feature("director");         

%{
#include "mydll.h"
%}

%include "mydll.h" 
```

给定一个头文件“mydll.h”：

```
class Observer {
public:
  virtual void frobination() = 0;
  virtual ~Observer() {}
};

inline void bar(Observer *o) {
  o->frobination();
} 
```

然后你可以运行 SWIG：

```
痛饮 -Wall -java -c++ mymodule.i

```

这将生成三个 Java 类`MyModule`：`MyModuleJNI`和`Observer`。其中`MyModule`将包含头文件中的所有自由函数，作为`static`成员函数公开，因为 Java 没有自由函数之类的东西。您可以放心地忽略`MyModuleJNI`- 它是 SWIG 生成的胶水，用于连接`MyModule`到真正的 C++ 实现。您需要编译 mymodule_wrap.cxx 以便`MyModuleJNI`（因此）才能正常工作，并在从它们调用任何函数之前`MyModule`使用加载 DLL 。`System.loadLibrary`

该类`Observer`直接对应 中的 Observer 接口`mydll.h`。您应该在 Java 中从它派生并覆盖该`frobinate`函数以提供您自己的实现：

```
public class Test extends Observer {
  @Override
  public void frobination() {
    System.out.println("go go gadget frobinator");
  }

  public static void main(String[] argv) {
    System.loadLibrary("mymodule");
    Test t = new Test();
    MyModule.bar(t);    
  }
} 
```

我可以编译并运行它来完全按照您的希望进行。

如果你愿意，你可以`System.loadLibrary`通过添加来自动调用：

```
%pragma(java) jniclasscode=%{
  static {
    try {
        System.loadLibrary("mymodule");
    } catch (UnsatisfiedLinkError e) {
      System.err.println("Native code library failed to load. \n" + e);
      System.exit(1);
    }
  }
%} 
```

到您的 SWIG 接口文件。

如果您真正的头文件如此简单，那么获得相同结果也应该如此简单。如果它更复杂，您可以指示 SWIG 以各种方式对其进行特殊处理。

# javascript - 选中单选按钮上的启用输入字段

> ID：11143461
> 
> 赞同：1
> 
> 时间：2012-06-21T17:23:58.523
> 
> 标签：javascript, jquery

我有 2 个单选按钮和 2 个输入字段。我想将单选按钮与输入字段相关联，因此仅启用所选单选按钮的输入字段，而禁用其他单选按钮。

我的 html 标记是：

```
<div>
    <input type="radio" checked="checked" name="co" data-for="s" />
    <input type="text" id="s" />
    <br /><br />

    <input type="radio" name="co" data-for="u"/>
    <input type="text" id="u" disabled="disabled" />
</div> 
```

所以目前第一个单选按钮被选中，并且它的输入字段被启用。我怎样才能用一点 jquery 代码做到这一点？

**编辑**

我试过这个：

```
$("input[type=radio][name=co]").bind({
  change: function () { 
    if ($(this).attr("checked") == "checked")
       $("#" + $(this).attr("data-for")).removeAttr("disabled"); 
    else 
       $("#" + $(this).attr("data-for")).attr("disabled", "disabled"); 
  } 
}); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-21T17:28:14.357

试试这个 - [http://jsfiddle.net/DMasH/](http://jsfiddle.net/DMasH/)

```
$("input:radio").on("click", function() {
    $("input:text").attr("disabled", true);

    $(this).next("input").attr("disabled", false)
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-21T17:29:13.780

```
$("input[type='radio']").click(function() {
    $("input[type='text']").attr("disabled", "disabled");
    if ($(this).next().attr("disabled") == "disabled") $(this).next().removeAttr("disabled");
    else $(this).next().attr("disabled", "disabled");
}); 
```

禁用所有框，然后仅启用下一个框。

[http://jsfiddle.net/reygonzales/sJZD7/](http://jsfiddle.net/reygonzales/sJZD7/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-21T17:30:35.307

解决方案 - [http://jsfiddle.net/4uQqE/2/](http://jsfiddle.net/4uQqE/2/)

```
$('input[data-for]').change(function() {
target = $('#'+$(this).data('for'));
$('input[type="text"]').attr('disabled','disabled');
if($(this).is(":checked")) {
    target.removeAttr('disabled');
}});​ 
```

# c# - 如何在 Silverlight 中共享列表？

> ID：11143462
> 
> 赞同：0
> 
> 时间：2012-06-21T17:23:58.757
> 
> 标签：c#, list, silverlight-4.0

在 Silverlight 应用程序中，我有 2 个功能
第一个：

```
private void LoadData()
        {
            ServiceReference2.Service1Client webService = new ServiceReference2.Service1Client();
            webService.GetContentCompleted += new EventHandler<ServiceReference2.GetContentCompletedEventArgs>(webService_GetContentCompleted);
            webService.GetContentAsync();

        } 
```

第二个：

```
private void webService_GetContentCompleted(object sender, ServiceReference2.GetContentCompletedEventArgs e)
        {
            IEnumerable<ServiceReference2.MediaContent> list = e.Result as IEnumerable<ServiceReference2.MediaContent>;
            dataGrid1.ItemsSource = list;
        } 
```

如何`list`从项目中的其他功能中获取信息？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-21T17:35:53.960

这是你想要的？

```
 private void LoadData()
    {
        ServiceReference2.Service1Client webService = new ServiceReference2.Service1Client();
        webService.GetContentCompleted += new EventHandler<ServiceReference2.GetContentCompletedEventArgs>(webService_GetContentCompleted);
        webService.GetContentAsync();
    }

    private void webService_GetContentCompleted(object sender, ServiceReference2.GetContentCompletedEventArgs e)
    {
        IEnumerable<ServiceReference2.MediaContent> list = e.Result as IEnumerable<ServiceReference2.MediaContent>;
        dataGrid1.ItemsSource = list;

        ThirdMethod(list);
    }

    private void ThirdMethod(IEnumerable<ServiceReference2.MediaContent> list)
    {
        something = list;
    } 
```

# javascript - youtube url rel=0 在 javascript 中不起作用

> ID：11143464
> 
> 赞同：0
> 
> 时间：2012-06-21T17:24:04.570
> 
> 标签：javascript, youtube-javascript-api

youtube url 在 javascript 中不起作用，为什么？我的代码中的错误在哪里：

```
 $(document).ready(function(){ 
  api_images = ['http://www.youtube.com/watchv=OyQoHmcunk&amp;rel=0&amp;fs=0&amp;width=640&amp;height=360'];
 api_titles = ['Title 1'];
 api_descriptions = ['']
 $.prettyPhoto.open(api_images,api_titles,api_descriptions);
 }); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-21T17:55:48.750

您缺少`?`实际将路径与查询字符串分开的内容：

```
api_images = ['http://www.youtube.com/watch?v=OyQoHmcunk&amp;rel=0&amp;fs=0&amp;width=640&amp;height=360'];
//                                         ^ 
```

没有它，您应该会收到 404 响应，这是一个不错的 javascript 调试器会告诉您的。您正在使用调试器，[对](http://www.browserstack.com/debugging-tools)吗？

此外，根据`DOCTYPE`使用情况以及这是来自 inline 还是 external ，可能需要`<script>`对 s 进行 HTML 编码或其他问题来源：`&`

```
api_images = ['http://www.youtube.com/watch?v=OyQoHmcunk&rel=0&fs=0&width=640&height=360'];
//                                                      ^     ^    ^         ^ 
```

# yii - ActiveRecord 没有更新数据

> ID：11143468
> 
> 赞同：5
> 
> 时间：2012-06-21T17:24:14.297
> 
> 标签：yii

这是我的一段代码

```
$file=Files::model()->findByPk($id);   
if($file == null) {
     throw new CHttpException(404,'Not found');   
}
$count = $file->count;           
$count++;                             
$file->count = $count;           
$file->save();                                      
$this->redirect(Yii::app()->request->hostInfo."/".$file->path); 
```

该`Files`模型包含一个`count`字段。代码没问题，没有警告，但是保存方法不起作用。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-21T17:58:56.877

尝试`$file->getErrors()`在 save() 之后和重定向之前显示，看看是否有错误

这会告诉你什么是问题。最常见的是您没有填充模型在数据库中插入行所需的依赖项

以良好的格式使用

```
CVarDumper::Dump($file->getErrors(),100,true) 
```

# java - 数组jquery文本框旁边的消息

> ID：11143470
> 
> 赞同：1
> 
> 时间：2012-06-21T17:24:33.673
> 
> 标签：java, jquery, jsp

我正在根据数据库验证在文本框中输入的值，并希望显示正确或错误的图标正确的文本框。

我的html代码在这里

```
<tr>
 <td><input type="textbox" class="process-order serial" name="serialNumber" id="serialNumber"/> <span name="validsn" id="validsn">
</td>
</tr> 
<tr>
<td><input type="textbox" class="process-order serial" name="serialNumber" id="serialNumber"/> <span name="validsn" id="validsn">
</td>
</tr> 
<tr>
<td><input type="textbox" class="process-order serial" name="serialNumber" id="serialNumber"/> <span name="validsn" id="validsn">
</td>
</tr> 
```

当在 serialNumber 字段中输入值时，我正在验证 onblur，我会得到 true 或 false，而在 jquery 中我就是这样做的。

```
$.post("validateSN", {value:$(this).val()},function(data){
    $("#validsn").text(data);
}); 
```

当我每次显示数据时，错误消息或成功消息只出现在第一个旁边。

**更新：**序列号文本框是动态的，并且根据文本框大小与跨度相同。

有人可以帮助我正确地在每个文本框旁边显示错误/成功消息的正确方法。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-21T17:28:02.393

这是因为您添加了

```
<span name="validsn" id="validsn"> 
```

靠近第一个输入文本（然后重复使用相同的 ID）

你应该这样做

```
<span name="validsn" id="validsn1">
<span name="validsn" id="validsn2">
<span name="validsn" id="validsn3"> 
```

然后在java脚本中

```
 var index = 1;
   for (index = 1 ; index <= 3;index++){ $("#validsn"+index).text(data);} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-27T15:38:46.317

我遵循了[Jigar Joshi](https://stackoverflow.com/users/260990/jigar-joshi)的建议并稍作修改

模糊

```
$(".serial").live("blur", function(){
//got the index of textbox where serial number is entered
var index = $(".serial").index(this);

$.ajax({
 url:"validateSN",
 data: "value="+sn,
 success : function(data){
 $("#validsn"+index).show();
     if(data=="true"){
    $("#validsn"+index).attr('src',"images/icons/valid_icon.png");
     } else if(data=="false"){
        $("#validsn"+index).attr("src", "images/icons/invalid_icon.png");
     }
}); 
```

然后它工作得很好。感谢 Jigar Joshi 帮助我前进。

# java - 在 Java 7 下运行的 tomcat 上使用 Java 6 字节码查询 Web 应用程序

> ID：11143476
> 
> 赞同：0
> 
> 时间：2012-06-21T17:24:56.490
> 
> 标签：java, tomcat, java-7, java-6

我有以下情况。

我的 Web 应用程序使用 Java 6 字节码，我将它部署在运行 Java 7 的 tomcat 上。我可以通过 java api 查询 Web 应用程序。

现在我的问题是：使用 java 6 查询 Web 应用程序是否有意义？或者只有使用 java 7 查询才有意义，因为 tomcat 在 java 7 下运行？

任何帮助，将不胜感激？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-21T18:00:48.363

没关系，我没有看到任何优点或缺点。你的 webapp 暴露了什么样的 API？如果它是真正的 API，则该 API 不应绑定到任何编程语言。想象有一个 REST 接口，您只使用 HTTP 请求来获取和发布 JSON 消息。你可以用任何语言来做到这一点，而不仅仅是 Java。

或者您是在谈论远程代码调用，例如使用 EJB？在这种情况下，您必须遵循标准如何定义 Java 6 应用程序的调用代码。

# makefile - 我的 Makefile 正在尝试编译一个不存在/编造的文件名

> ID：11143481
> 
> 赞同：0
> 
> 时间：2012-06-21T17:25:11.233
> 
> 标签：makefile

这是我的第一个 Makefile，所以我剪切并粘贴了我在网上找到的垃圾。我的目录结构非常平坦，并没有考虑到 Makefile。它是：Project/Project/Control Project/NodeMgmt Project/Common Project/Interfaces

我正在为 Control 编写 Makefile，并希望它在 Control 内部独立。它需要包含来自 Common & Interfaces 的编译和包含。这是我的Makefile：

```
CC = g++

CFLAGS = -Wall -c

INCLUDES = -I/usr/local/include -I/SuperCool/Ion-1.0.0-snapshot-1/include -I/SuperCool/FastrakSDK-4.0.1-snapshot-1/include/Fastrak/Engine/Core/CoreIpc -I/Projects/Common -I/Projects/Interfaces -I/Projects/NodeMgmt -I/Projects/Controller 

LFLAGS = -L/usr/local/lib -L/SuperCool/FastrakSDK-4.0.1-snapshot-1/lib

LIBS = -lCoreIpc4 -lIonOs

VPATH = ../Interfaces/
VPATH = ../Common/
VPATH = ../NodeMgmt/

SRCS = *.cc

OBJS = $(SRCS:.cc=.o)

MAIN = controller

.PHONY: clean

all:    $(MAIN)
    @echo Built Controller

$(MAIN): $(OBJS)
    $(CC) $(CFLAGS) $(INCLUDES) -o $(MAIN) $(OBJS) $(LFLAGS) $(LIBS)

.cc.o:
    $(CC) $(CFLAGS) $(INCLUDES) -c $< -o $@

clean:
    $(RM) *.o $(MAIN) 
```

它正在编译它找到的第一个 .cc 文件“-c Controller.cc -o *.o”，这是有道理的，但这就是它正在编译的全部内容，我得到一个 *.o 输出文件，而不是 Controller.o 文件。它不编译任何其他文件。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-21T17:38:58.320

这是一个问题：

```
SRCS = *.cc 
```

Make 不理解没有该`wildcard`功能的通配符：

```
SRCS = $(wildcard *.cc) 
```

那应该可以正常工作；我们以后可以做一些小的改进。

# java - 如何获取文本文件中的特定行

> ID：11143483
> 
> 赞同：0
> 
> 时间：2012-06-21T17:25:17.247
> 
> 标签：java, text-files

我正在尝试读取文本文件的内容。这个想法是用'title：'关键字获取第一行，读取文件，再次获取下一个'title：'关键字，继续这样做直到读取文件。我正在尝试将其存储在数据库中。这样做的其他想法也受到欢迎。谢谢。

这是我试图从中读取的文本文件。

标题：母亲节

马蒂贝尔：是的！一部从头到尾都让我着迷的电影！喜欢看这种类型的电影。所有人都必须看到！享受！

标题： 穿着高跟鞋怀孕

CuittePie：我什么都看不到。:@

标题 : The Flintstones Row_Sweet_Girl : 很好看

标题：以物易物之王 dragon3476：以物易物之王 - 第 1 季第 4 集 - 摇滚和硬地播出日期：19/06/2012 摘要：商人以物易物换取汽车和台球桌。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-21T17:35:38.710

我认为最简单的方法是使用来自[Apache Commons IO的](http://commons.apache.org/io/)[FileUtils](http://commons.apache.org/io/api-1.4/org/apache/commons/io/FileUtils.html) ，如下所示：

```
import java.io.File;
import java.io.IOException;
import java.util.List;

import org.apache.commons.io.FileUtils;

public class ReadFileLines {

    public static void main(final String[] args) throws IOException {
        List lines = FileUtils.readLines(new File("/tmp/myFile.txt"), "UTF-8");
        for (Object line : lines) {
            if (String.valueOf(line).startsWith("title : ")) {
                System.out.println(line); // here you store it
            }
        }
    }

} 
```

# c# - c#中复杂的json解析

> ID：11143485
> 
> 赞同：1
> 
> 时间：2012-06-21T17:25:27.563
> 
> 标签：c#, json, parsing, c#-4.0, gridview

我正在用 C# (ASP) 进行 json 解析。问题是当来自 klout 的 JSON 非常复杂时，这就是响应

```
{"myInfluencers":[{"entity":{"id":"851563","payload":{"kloutId":"851563","nick":"YouTube","score":{"score":100.0},"scoreDeltas":{"dayChange":0.0,"weekChange":0.0,"monthChange":0.0}}}},{"entity":{"id":"100768049884337217","payload":{"kloutId":"100768049884337217","nick":"JessicaBiel","score":{"score":65.81697082519531}}}},{"entity":{"id":"879345","payload":{"kloutId":"879345","nick":"brokemogul","score":{"score":65.55970764160156},"scoreDeltas":{"dayChange":-0.2452850341796875,"weekChange":-0.6857528686523438,"monthChange":-2.5359420776367188}}}},{"entity":{"id":"25332752669424610","payload":{"kloutId":"25332752669424610","nick":"EsteeStanley","score":{"score":64.1717529296875}}}},{"entity":{"id":"28710452389286536","payload":{"kloutId":"28710452389286536","nick":"robknox_ys","score":{"score":60.353816986083984}}}}],"myInfluencees":[{"entity":{"id":"98516250154496343","payload":{"kloutId":"98516250154496343","nick":"LYNASXD","score":{"score":14.632675170898438}}}},{"entity":{"id":"42784201225370648","payload":{"kloutId":"42784201225370648","nick":"JenThackray","score":{"score":14.392120361328125}}}},{"entity":{"id":"52635827290381715","payload":{"kloutId":"52635827290381715","nick":"JTChile","score":{"score":13.279963493347168}}}},{"entity":{"id":"60235650788244656","payload":{"kloutId":"60235650788244656","nick":"upallnight356","score":{"score":11.61323070526123}}}},{"entity":{"id":"97108875505882083","payload":{"kloutId":"97108875505882083","nick":"anisahmutiahna","score":{"score":10.5490140914917}}}}],"myInfluencersCount":14,"myInfluenceesCount":25} 
```

生成的类如下

```
public class Score
{
    public double score { get; set; }
}

public class ScoreDeltas
{
    public double dayChange { get; set; }
    public double weekChange { get; set; }
    public double monthChange { get; set; }
}

public class Payload
{
    public string kloutId { get; set; }
    public string nick { get; set; }
    public Score score { get; set; }
    public ScoreDeltas scoreDeltas { get; set; }
}

public class Entity
{
    public string id { get; set; }
    public Payload payload { get; set; }
}

public class MyInfluencer
{
    public Entity entity { get; set; }
}

public class Score2
{
    public double score { get; set; }
}

public class Payload2
{
    public string kloutId { get; set; }
    public string nick { get; set; }
    public Score2 score { get; set; }
}

public class Entity2
{
    public string id { get; set; }
    public Payload2 payload { get; set; }
}

public class MyInfluencee
{
    public Entity2 entity { get; set; }
}

public class RootObject
{
    public List<MyInfluencer> myInfluencers { get; set; }
    public List<MyInfluencee> myInfluencees { get; set; }
    public int myInfluencersCount { get; set; }
    public int myInfluenceesCount { get; set; }
} 
```

我想将结果与gridview绑定。即使我使用JSON.NET，我们也无法一一提取。我以前使用`deserialize`过，但这里的场景太嵌套了。任何可以帮助我找到解决此问题的好方法的人。谢谢你的温柔

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-21T17:40:39.700

您的 json 确实嵌套得很深。我不会声明很多小类，而是这样：

```
var jobj = (JObject)JsonConvert.DeserializeObject(json);

var myInfluencers = jobj["myInfluencers"]
                        .Children()
                        .Select(x => (dynamic)x["entity"])
                        .Select(x => new
                        {
                            id = x.id.ToString(),
                            kloutId = x.payload.kloutId.ToString(),
                            nick = x.payload.nick.ToString(),
                            score = x.payload.score.score.ToString(),
                        })
                        .ToArray(); 
```

`myInfluencees`具有相同的结构`myInfluencers`

即使你不想使用匿名类，你也不需要比这更多的类

```
public class DummyClass
{
    public string id;
    public string kloutId; 
    public string nick; 
    public string score; 
    //a few fields more??
 } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-21T21:54:59.333

我发现的最佳解决方案是创建小班

*   使用 JSON.NET

    JObject o = JObject.Parse(text_klout); Impacte = o.SelectToken("myInfluencees").ToString(); 影响者 = o.SelectToken("myInfluencers").ToString(); 将它们分开然后使用

    JavaScriptSerializer _jsserializer = new JavaScriptSerializer(); 有用...

# shell - Grep 用于在单个文件中显示多个字符串的计数

> ID：11143488
> 
> 赞同：0
> 
> 时间：2012-06-21T17:25:34.740
> 
> 标签：shell, unix, grep

另一个问题......我可以得到唯一项目的数量......如果在我之前的案例中，我只是举了一个简单的例子。我的业务需求在这里......
我有如下字符串快乐=7
快乐=5快乐=5，基本上我将使用正则表达式来搜索快乐这个词，我会给出“快乐=*”......我需要输出为“快乐计数 = 2”，因为有一个重复的实例......

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-21T17:48:03.010

使用 awk：

```
awk '/happy/{ happy+=1 } /sad/ {sad += 1 } 
    END { print "happy =", happy+0, "sad = ", sad+0 }' 
```

请注意，like`grep -c`不计算每个单词的出现次数，而是计算与每个单词匹配的行数。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-21T17:48:29.347

您最好使用 perl 或 awk 之类的东西，您可以在其中根据条件语句增加计数器。

# python - Python：运行脚本一次写入多个文件

> ID：11143489
> 
> 赞同：2
> 
> 时间：2012-06-21T17:25:36.593
> 
> 标签：python, xml, performance, beautifulsoup

编程新手。我编写了一个 Python 代码（在 stackoverflow 的帮助下）读取目录中的 XML 文件，并使用 BeautifulSoup 复制元素的文本并将其写入输出目录。这是我的代码：

```
from bs4 import BeautifulSoup
import os, sys

source_folder='/Python27/source_xml'

for article in os.listdir(source_folder):
    soup=BeautifulSoup(open(source_folder+'/'+article))

    #I think this strips any tags that are nested in the sample_tag
    clean_text=soup.sample_tag.get_text("  ",strip=True)

    #This grabs an ID which I used as the output file name
    article_id=soup.article_id.get_text("  ",strip=True)

    with open(article_id,"wb") as f:
        f.write(clean_text.encode("UTF-8")) 
```

问题是我需要它来运行 100,000 个 XML 文件。我昨晚启动了这个程序，据我估计它需要 15 个小时才能运行。例如，有没有一种方法可以一次读取/写入 100 个或 1000 个，而不是一次读取和写入一个？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-21T17:31:56.100

多处理模块是您的朋友。[您可以使用这样的进程池](http://docs.python.org/library/multiprocessing.html#module-multiprocessing.pool)在所有 cpu 上自动扩展代码：

```
from bs4 import BeautifulSoup
import os, sys
from multiprocessing import Pool

source_folder='/Python27/source_xml'

def extract_text(article):
    soup=BeautifulSoup(open(source_folder+'/'+article))

    #I think this strips any tags that are nested in the sample_tag
    clean_text=soup.sample_tag.get_text("  ",strip=True)

    #This grabs an ID which I used as the output file name
    article_id=soup.article_id.get_text("  ",strip=True)

    with open(article_id,"wb") as f:
            f.write(clean_text.encode("UTF-8"))

def main():
    pool = Pool()
    pool.map(extract_text, os.listdir(source_folder))

if __name__ == '__main__':
    main() 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-21T17:30:11.407

尽管我很讨厌这个主意，但您可以使用线程。python 中的 GIL 在 I/O 操作上发布，因此您可以运行线程池并只使用作业。

# java - 对象是一个未保存的瞬态实例 - 在合并之前保存瞬态实例

> ID：11143491
> 
> 赞同：1
> 
> 时间：2012-06-21T17:25:48.560
> 
> 标签：java, hibernate, struts2

我有一个添加新公寓的表单，在这个表单中我有一个下拉列表，用户可以在其中选择负责的人员。

显然，当您从下拉列表中选择并尝试保存 Appartment 时，我的应用程序认为 Person 已被修改。它给了我下面的错误，表明我应该先保存这个人。但是 Person 没有被修改。只有 Appartment 应该与对不同 Person 的引用一起保存。

`object is an unsaved transient instance - save the transient instance before merging`

我怎样才能让我的应用程序了解 Person 本人没有被修改。只有公寓？

这是我的代码：

```
@Entity
@Table(name = "Person")
public class Person{
    @Id
    private Long id;
    private String fullName;
    ....
}

@Entity
@Table(name = "Appartment")
public class Appartment{
    ....
    @ManyToOne (fetch = FetchType.LAZY)
    @JoinColumn (name = "client_contact_person_id")
    private Person clientResponsiblePerson;
} 
```

该操作将所有人员加载到 List ResponsiblePersons 中。

和 JSP：

```
<s:select name="appartment.clientResponsiblePerson.id" list="responsiblePersons"
        listKey="id" listValue="fullName" headerKey="-1"
        label="%{getText('appartment.clientContact.ourContact')}" headerValue="%{getText('person.choose')}"
        required="true" cssClass="select medium" /> 
```

有任何想法吗？我已经搜索和调试了几个小时没有任何解决方案...... :(

更新：史蒂文建议我从`appartment.clientResponsiblePerson.id`. 这是一个合理的建议。我只是尝试过，但似乎我的应用程序不知道如何将表单提交的值映射到个人对象。由于我设置`listKey="id"`提交的值是人员的 ID。

我收到以下错误： `Invalid field value for field "appartment.clientResponsiblePerson".`

`tag 'select', field 'list', name 'appartment.clientResponsiblePerson': The requested list key 'responsiblePeople' could not be resolved as a collection/array/map/enumeration/iterator type. Example: people or people.{name} - [unknown location]`

所以我最初的想法是，也许我应该从我的 s:select 中删除 listKey 和 listValue。也许struts会自动检测对象的id并使用toString作为值？但我也试过了，没有更多的运气。

另一个非常奇怪的事情是，我以另一种形式做同样的事情。在那种形式中，我从下拉列表中选择区域。我正在使用 appartment.area.id 作为名称。它在那里完美运行。奇怪..我还检查了 Area - Appartment 引用没有设置为自动保留或合并。

令我震惊的是，我想要实现的目标应该是直截了当的。我没有到达这里是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-21T21:06:06.483

> 显然，当您从下拉列表中选择并尝试保存 Appartment 时，我的应用程序认为 Person 已被修改。

这正是您的代码正在做的事情。以下行是罪魁祸首：

```
appartment.clientResponsiblePerson.id 
```

那就是告诉 Struts2 框架获取您在下拉列表中选择的人的 id 并将其传递给`getAppartment().getClientResponsiblePerson().setId(id)`. 这不会更改为新的负责人，它会更改现有人员的主键。调用 setClientResponsiblePerson(Person) 会改变这个人。

尝试`appartment.clientResponsiblePerson`改用，看看它对你有用。

**更新**

> 另一个非常奇怪的事情是，我以另一种形式做同样的事情。

我也不知道那会如何工作。

Struts2 不知道 a`Person`是什么，所以你有几个选择：

1.  创建一个类型转换器来告诉 Struts2 如何将“1”（或从下拉列表中传入的任何内容）转换为 Person 的实例。
2.  在您的操作上添加一个`setPerson(Integer)`方法，该方法将根据传入的 Integer 主键查找适当的 Person 实体，然后将您的 s:select 更新为`<s:select name="person" list="responsiblePersons" .../>`

就个人而言，我使用#1。

# java - Jersey @Path 用于同一类中的复数/单个 REST 名词

> ID：11143492
> 
> 赞同：9
> 
> 时间：2012-06-21T17:25:56.097
> 
> 标签：java, rest, jersey

我有一个类，它的注释`@Path`如下：

```
@Path("widgets")
@Produces(MediaType.APPLICATION_XML)
public class WidgetResource {

    @GET
    public Response getWidgets(@QueryParam("limit"))
    {
     //This class returns the plural noun, a list of widgets
    //...}

@GET
@Path("widget/{id}")
    public Response getWidgetById(@PathParam("id") long id)
    {
     //This class returns a single widget by id
    //...} 
```

当我启动测试客户端时，localhost/widgets 按预期映射，但是当`getWidgetById`方法映射到`localhost/widgets/widget/{id}`. 这不是我想要的——我想要`localhost/widgets and localhost/widget/{id}`

我曾尝试在类级别省略`@Path`注释，但这会阻止 Jersey 将此类识别为 REST 资源（我尝试了`ScanningResourceConfig`和`ClassNameResourceConfig`- 两者都未能将类加载为资源，除非`@Path`在类级别有 a ）。

我想一个（丑陋的）解决方法是在`WidgetResource`类和`WidgetsResource`类之间拆分方法。我认为这是一个糟糕的解决方案，因为这两种方法在同一个类中共享资源，但我真的需要 REST-ful `localhost/widget`（对于单个实体）和`localhost/widgets`（对于复数）。

`@Path`我是否遗漏了什么 - 如果我只是注释方法（我无法让它工作），我是否可以通过某种方式让 Jersey 将该类作为资源类拾取，如果没有，我可以强制绝对映射（ `@Path(/widget/{id})`）或一些相对映射 ( `@Path(../widget/id`) - 这些在现实中都不起作用 - 只是我所追求的类比。谢谢！

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-06-21T17:53:08.237

**这部分是关于你*需要*什么：**

就个人而言，我发现您的映射很奇怪且令人困惑。保持这样的状态：

```
@Path("widgets")
@Produces(MediaType.APPLICATION_XML)
public class WidgetResource {

  @GET
  public Response getWidgets(@QueryParam("limit")) {
   //This method returns the plural noun, a list of widgets
   // it's also possible to limit the number returned by
   // using a query parameter. You could easily implement
   // pagination by adding further query parameters like
   // 'offset', 'sortOrder', etc.
   //...
  }

  @GET
  @Path("{id}")
  public Response getWidgetById(@PathParam("id") long id) {
    //This method returns a single widget by id
    //...
  }
} 
```

将路径附加到具有 ID 的集合以从集合中获取对象似乎很自然。真的没必要做`widgets/widget/{id}`。该`widget`部分是显而易见的和不必要的。

这是一个关于 RESTful API 的非常简洁的教程： [apigee 的“Teach a dog to REST”](http://blog.apigee.com/detail/restful_api_design/)我认为这是一个非常好的视频。作者提出了几个很好的观点。[这是同一演示文稿](http://blog.apigee.com/detail/slides_for_restful_api_design_second_edition_webinar)的更长版本的链接

* * *

**这部分是关于你*想要*什么：**

如果你真的想保留复数/单数二元论（我真的不推荐），你可以像这样注释你的代码： **但这真的很难看**

```
@Path("/")
@Produces(MediaType.APPLICATION_XML)
public class WidgetResource {

  @GET
  @Path("widgets")
  public Response getWidgets(@QueryParam("limit")) {
   //This method returns the plural noun, a list of widgets
  //...}

  @GET
  @Path("widget/{id}")
  public Response getWidgetById(@PathParam("id") long id) {
    //This method returns a single widget by id
    //...
  }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-21T17:46:30.673

我的建议是让你的路径是： `"widgets"`和`"widgets/id/{id}"`。或者，如果您知道您永远不会通过 id 以外的任何东西进行查询，那么您的第二个可能只是`"widgets/{id}"`.

我不会在你的路径中切换复数和单数。由于您为两者访问相同类型的资源，因此您的根目录应该相同。第二种形式只是对其进行了更多的指定——一种基于矢量的方法来获得更具体的信息。

# java - 使用 Java SAX 的智能 XML 遍历

> ID：11143493
> 
> 赞同：0
> 
> 时间：2012-06-21T17:25:57.367
> 
> 标签：java, xml, design-patterns, sax

**背景：**

最近，我的任务是从 HTML 表单中解析出大量数据并将其构建到一个可用的数据库表中。有问题的 HTML 页面是很久以前生成的，原始源数据已失传。因此，我决定放弃 Java 中的快速解析器来获取这些数据并对其进行适当的格式化。将利用 SAX，因为我不需要以任何方式修改层次结构，只需要一次传递。下面包含一个非常小的 HTML 示例：

```
<html>
 <table>
  <tr>
   <table>
    <tr>
     <td><div>District 1</div><td></tr>
    <tr>
     <td><div>Valid Code 1</div></td>
     <td><div>Valid Code 2</div></td>
     <td><div>Valid Code 3</div></td>
    </tr>
   </table>
  </tr>
ETC... 
```

显然，HTML 不仅仅是上面概述的内容，但这应该给出结构的概念。

**问题：**

我正在寻找一种智能的、可扩展的、自记录的和（如果可能的话）快速/精简的方法来使用 SAX 解析器跟踪我在 XML 层次结构中的当前位置。由于使用 SAX，我有三个仅针对单个元素触发的离散方法调用，因此此状态必须是持久且可存储的。这样做的最明显和最简单的方法是使用大量布尔变量，但这不是我之前列出的四个租户。我还考虑过使用位掩码来维护大量标志，但这很难自我记录或非常可扩展。最后，我考虑了一个有限状态自动机（或其他类似的衍生产品，例如下推自动机），但对于一次性机器来说，这些似乎有点矫枉过正。

也许我过度思考一次性代码的问题，我一直在寻求扩展我的技能组合，因为我不得不编写不是一次性的代码。提前感谢您的时间和帮助。

**参考：**

[http://www.mkyong.com/java/how-to-read-xml-file-in-java-sax-parser/](http://www.mkyong.com/java/how-to-read-xml-file-in-java-sax-parser/)

[大型嵌套 switch 语句的设计模式](https://stackoverflow.com/questions/6581382/design-pattern-for-a-large-nested-switch-statements) （与 XML 没有直接关系，但给出了一些关于使用大量离散条件进行设计的想法）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-22T19:51:48.323

我会保留一堆结构`{element, count}`，并且对于每个结构，`startElement()`我都会增加父结构`count`和`push`一个新元素，然后在.`endElement()``pop`

这样，您将能够在给定文档中保留唯一位置，并构造 XPath，如`/html/table/tr[23]/td[1]`. 或者，更快但可能会消耗更多内存，您可以复制当前堆栈。

# python - 通过查看字典中的值来识别键

> ID：11143496
> 
> 赞同：0
> 
> 时间：2012-06-21T17:26:01.897
> 
> 标签：python

*   我有一本带有键值对的字典，例如`{a : (b,c,d,e)}`.
*   如果我遇到一个元组`(b,c,d,e)`，我想在字典中查找，该键与一个值具有相同的元组，然后从字典中删除该键。可以在python中这样做吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-21T17:34:55.463

use `list()`, `set()`, or `tuple()`because `list(dict)`or `tuple(dict)`or`set(dict)` 返回字典的键，您可以遍历这些返回的键并从字典中弹出项目，并且正如 Lattyware 建议的那样，在删除一个 value use`break`语句后停止迭代`pop()`。

```
div={'a':(1,2,3,4),'b':[1,2],'c':(1,2,3,4)}
tup=(1,2,3,4)
for x in set(div):
    if div[x]==tup:
        div.pop(x)

print(div)        

{'b': [1,2]} 
```

# php - QR 码和 URL 缩短器 - 最简单的方法？

> ID：11143497
> 
> 赞同：1
> 
> 时间：2012-06-21T17:26:05.050
> 
> 标签：php, forms, qr-code

我正在寻找一种在提交表单时创建二维码和缩短链接的方法。我有二维码位，但链接对我来说太长了，二维码看起来又吓人又复杂。它的工作方式是；用户输入（在这种情况下）合同号。然后，在该合同号的服务器上创建一个文件夹。(www.mysite.com/QR/$contractnumber)。然后，再次使用 PHP，我通过 Google 创建了一个二维码，因为我知道每个二维码都会链接到同一个地方，只是链接的结尾不同。唯一改变的是 $POST...

我想知道是否有办法在链接到 Google 之前缩短链接？它必须通过php。用户在表单中输入联系人号码，然后该号码（通常约为 5/6 位）将被输入到已经存在的命令中？我不是任何方面的专家，我只知道一些非常随机的代码片段......当然还有 HTML 和 CSS。

任何帮助将不胜感激，并根据我一直在搜索的几天来判断，我认为它可能会在未来帮助一些人。我还想确认解决方案不能是这个视觉 URLShorteners 之一。如果是，它只需要作为它的后端，内置到现有的表单和 QR 生成器中。简单的？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-21T17:35:04.540

我们的一个内部应用程序也遇到了类似的挑战，由于任何快捷方式系统（据我所知）都依赖数据库来翻译短网址的*真正*含义，我们选择从已经完成的事情开始工作，而不是重新发明轮子并将我们的解决方案基于[yourls.org](http://yourls.org/)。

我们安装了它，并从我们的 PHP 中填充了数据库，除了测试和统计数据之外，没有真正使用提供的接口进行任何操作。它相当灵活，虽然它确实需要一些标准改进，但我们感兴趣的核心代码（如您所愿）是合理的，并且对我们来说工作得很好。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-24T20:38:14.057

听起来您也许可以使用 TagLabs 解决方案。查看开发者网站；developer.taglabsinc.com 并在 portal.taglabsinc.com 创建一个免费帐户。该平台将创建二维码和缩短的网址。您可以手动创建二维码或利用 API。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-09-12T19:53:19.353

对于它的价值，这正是[https://a.zat.is](https://a.zat.is)的用途。

# jquery - 在 jquery onclick 事件中得到意想不到的结果

> ID：11143500
> 
> 赞同：0
> 
> 时间：2012-06-21T17:26:15.040
> 
> 标签：jquery

我正在尝试`on-click` 为我正在做的 jquery 事件添加类

我的 html 文件

```
<head>
        <style type="text/css">
            .red{ color:red; }
        </style>
         <script type="text/javascript" src="jquery.js"></script>
        <script type="text/javascript" src="js.js"></script>
    </head>
<body>
    <ul id="list">
        <li><a href="">1</a></li>
        <li><a href="">2</a></li>
    </ul>
</body> 
```

javascript 文件 js.js 是

```
$(document).ready(function(){
     $("li").onclick(function(){ // if i comment this and only add the line billow the all ul>li will red
        $("#list").addClass("red");
    });
}); 
```

当我点击`li`的颜色`li`将变为红色时，这让我感到困惑，`on-click`我正在将类添加`.red`到，`ul`所以两个链接都应该是红色的，但点击时只有我点击的链接变成红色

![在此处输入图像描述](../Images/eb7bfffd7539042ac74b1ec5d893463d.png)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-21T17:29:42.123

您将 jQuery 的[`.click()`](http://api.jquery.com/click/)方法与 vanilla JavaScript混淆了[`element.onclick = functionRef;`](https://developer.mozilla.org/en/DOM/element.onclick)

在您的代码示例中，您需要：

```
$("li").click(function(){
    $("#list").addClass("red");
}); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-21T17:30:22.017

没有调用 jQuery 函数`onclick()`。有`on`和`click`，但没有`onclick`。您的列表元素变为红色是因为链接被激活，而不是因为您的 javascript。

使用任一`on`：

```
$(document).ready(function(){
     $("li").on('click', function(){
        $("#list").addClass("red");
    });
}); 
```

或`click`：

```
$(document).ready(function(){
     $("li").click(function(){
        $("#list").addClass("red");
    });
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-21T17:32:36.020

是[`.click()`](http://api.jquery.com/click/)，不是`onclick`

这是一个按预期工作的[演示](http://jsfiddle.net/u9L8C/)。我删除了`<a>`标签，所以链接颜色会干扰你正在做的事情。

# login - 一次登录重定向到密码更改页面

> ID：11143503
> 
> 赞同：1
> 
> 时间：2012-06-21T17:26:45.653
> 
> 标签：login, change-password

在 D7 中，当他/她使用一次性登录时，我如何重定向用户。我的目标是单击一次登录按钮后，用户必须重定向以更改密码。任何人都可以帮助解决这个问题......

# jquery - vTicker jQuery 插件，内容闪存

> ID：11143504
> 
> 赞同：0
> 
> 时间：2012-06-21T17:26:49.953
> 
> 标签：jquery, vticker

我正在使用著名的 jQuery vTicker 插件进行垂直滚动内容。但是，当一个人加载页面时，内容“`<li>`我的情况下的元素”会出现几分之一秒，然后再次隐藏内容并开始按预期工作。

有针对这个的解决方法吗？

这是我的代码：

```
 <script type="text/javascript">
        $(document).ready(function () {
            $('#lastminute').vTicker({
                speed: 500,
                pause: 3000,
                animation: 'fade',
                mousePause: true,
                showItems: 1
            });
        });
    </script>

    <div id="lastminute">
        <li>item 1</li>
        <li>item 2</li>
        <li>item 3</li>
    </div> 
```

![这是它的外观](../Images/e004c5c143ab9230042031ab98d964b6.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-21T17:31:43.237

为所有你不想闪烁的元素添加一个类，它的 css 属性为`visibility:hidden`.

在您的处理程序中删除此类`$(document).ready()`。

这样，在您准备好按照您想要的方式显示它们之前，这些元素对用户来说是不可见的。

CSS -

```
.hideuntilready{
    visibility:hidden;
} 
```

JS-

```
<script type="text/javascript">
    $(document).ready(function () {
        $('#lastminute').removeClass("hideuntilready").vTicker({
            speed: 500,
            pause: 3000,
            animation: 'fade',
            mousePause: true,
            showItems: 1
        });
    });
</script> 
```

HTML -

```
<div id="lastminute" class="hideuntilready">
    <ul>
    <li>item 1</li>
    <li>item 2</li>
    <li>item 3</li>
    </ul>
</div> 
```

# ruby - Rake DB 出错：为 Devise:Module 迁移未定义的方法 `confirm_within='

> ID：11143505
> 
> 赞同：0
> 
> 时间：2012-06-21T17:26:51.977
> 
> 标签：ruby, devise

当我尝试运行 DB:Rake 时出现此错误：

```
** Invoke db:migrate (first_time)
** Invoke environment (first_time) 
** Execute environment
Resolved collector.newrelic.com to 204.93.223.153
 rake aborted!
 undefined method `confirm_within=' for Devise:Module
 /Users/jasonvdm/development/rails/config/initializers/devise.rb:66:in `block in <top   (required)>'
 /Users/jasonvdm/.rvm/gems/ruby-1.9.3-p194@wheelz/gems/devise-2.1.2/lib/devise.rb:247:in    `setup'
 /Users/jasonvdm/development/rails/config/initializers/devise.rb:3:in `<top (required)>'
 /Users/jasonvdm/.rvm/gems/ruby-1.9.3-p194@wheelz/gems/activesupport-3.1.3/lib/active_support/dependencies.rb:234:in `load'
 /Users/jasonvdm/.rvm/gems/ruby-1.9.3-p194@wheelz/gems/activesupport-3.1.3/lib/active_support/dependencies.rb:234:in `block in load'
 /Users/jasonvdm/.rvm/gems/ruby-1.9.3-p194@wheelz/gems/activesupport-3.1.3/lib/active_support/dependencies.rb:223:in `block in load_dependency'
 /Users/jasonvdm/.rvm/gems/ruby-1.9.3-p194@wheelz/gems/activesupport-3.1.3/lib/active_support/dependencies.rb:640:in `new_constants_in'
 /Users/jasonvdm/.rvm/gems/ruby-1.9.3-p194@wheelz/gems/activesupport-3.1.3/lib/active_support/dependencies.rb:223:in `load_dependency'
 /Users/jasonvdm/.rvm/gems/ruby-1.9.3-p194@wheelz/gems/activesupport-3.1.3/lib/active_support/dependencies.rb:234:in `load'
 /Users/jasonvdm/.rvm/gems/ruby-1.9.3-p194@wheelz/gems/railties-3.1.3/lib/rails/engine.rb:556:in `block (2 levels) in <class:Engine>'
 /Users/jasonvdm/.rvm/gems/ruby-1.9.3-p194@wheelz/gems/railties-3.1.3/lib/rails/engine.rb:555:in `each'
 /Users/jasonvdm/.rvm/gems/ruby-1.9.3-p194@wheelz/gems/railties-3.1.3/lib/rails/engine.rb:555:in `block in <class:Engine>'
 /Users/jasonvdm/.rvm/gems/ruby-1.9.3-p194@wheelz/gems/railties-3.1.3/lib/rails/initializable.rb:30:in `instance_exec'
 /Users/jasonvdm/.rvm/gems/ruby-1.9.3-p194@wheelz/gems/railties-3.1.3/lib/rails/initializable.rb:30:in `run'
 /Users/jasonvdm/.rvm/gems/ruby-1.9.3-p194@wheelz/gems/railties-3.1.3/lib/rails/initializable.rb:55:in `block in run_initializers'
 /Users/jasonvdm/.rvm/gems/ruby-1.9.3-p194@wheelz/gems/railties-3.1.3/lib/rails/initializable.rb:54:in `each'
 /Users/jasonvdm/.rvm/gems/ruby-1.9.3-p194@wheelz/gems/railties-3.1.3/lib/rails/initializable.rb:54:in `run_initializers'
 /Users/jasonvdm/.rvm/gems/ruby-1.9.3-p194@wheelz/gems/railties-3.1.3/lib/rails/application.rb:96:in `initialize!'
 /Users/jasonvdm/.rvm/gems/ruby-1.9.3-p194@wheelz/gems/railties-3.1.3/lib/rails/railtie/configurable.rb:30:in `method_missing'
 /Users/jasonvdm/development/rails/config/environment.rb:5:in `<top (required)>'
 /Users/jasonvdm/.rvm/gems/ruby-1.9.3-p194@wheelz/gems/activesupport-3.1.3/lib/active_support/dependencies.rb:240:in `require'
 /Users/jasonvdm/.rvm/gems/ruby-1.9.3-p194@wheelz/gems/activesupport-3.1.3/lib/active_support/dependencies.rb:240:in `block in require'
 /Users/jasonvdm/.rvm/gems/ruby-1.9.3-p194@wheelz/gems/activesupport-3.1.3/lib/active_support/dependencies.rb:223:in `block in load_dependency'
 /Users/jasonvdm/.rvm/gems/ruby-1.9.3-p194@wheelz/gems/activesupport- 3.1.3/lib/active_support/dependencies.rb:640:in `new_constants_in' 
```

不知道为什么我会收到这些错误。

这就是我的 gemfile，省略了一些私有的结尾部分。

```
source 'http://rubygems.org'

gem 'rails', '3.1.3'

# Bundle edge Rails instead:
# gem 'rails', :git => 'git://github.com/rails/rails.git'

gem 'mysql2', '~> 0.3.11'
# gem 'sqlite3'

group :production do
  gem 'thin'
  gem 'pg'
end

# Use unicorn as the web server
# gem 'unicorn'

# Deploy with Capistrano
# gem 'capistrano'

# To use debugger (ruby-debug for Ruby 1.8.7+, ruby-debug19 for Ruby 1.9.2+)
# gem 'ruby-debug'
# gem 'ruby-debug19', :require => 'ruby-debug'

# Bundle the extra gems:
 gem 'typus', '~> 3.1.8'
 gem "ckeditor-rails", :git => "https://github.com/fesplugas/rails-ckeditor.git" # for     typus _text_with_ckeditor.html.erb
gem 'nokogiri'
gem 'aws-s3', :require => 'aws/s3'
gem 'aws-sdk'
gem 'paperclip', '~> 2.5.0'
gem 'devise'
gem 'omniauth-facebook'
gem 'cancan'
gem 'koala'
gem 'rc_rails'
gem 'dynamic_form' # to get back old 'error_messages_on' behavior
gem 'role_model'
gem 'renum'
gem 'geokit', "1.6.0"
gem 'rails3-settings', '~> 1.0.0', :require => 'settings', :git =>  'git://github.com/jlaxson/rails-settings'
gem 'acts_as_api'
gem 'twilio-ruby'
gem 'xml-simple', :require => 'xmlsimple'
gem 'braintree', '>= 2.15.0'
gem 'carmen'
gem 'state_machine', :git => 'git://github.com/pluginaweek/state_machine.git' 
```

由于隐私，休息是隐藏的

帮助？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-21T17:56:08.710

看起来您在`config/initializers/devise.rb`（第 66 行）中有错误。在没有看到该代码的情况下，您似乎正在调用 Devise 上的一个方法，该方法在 Devise 2.0`confirm_within`中被重命名为。`allow_unconfirmed_access_for`

[https://github.com/plataformatec/devise/wiki/How-To:-Upgrade-to-Devise-2.0](https://github.com/plataformatec/devise/wiki/How-To:-Upgrade-to-Devise-2.0)

# objective-c - 具有标量返回值的不可用 Objective C 选择器

> ID：11143510
> 
> 赞同：2
> 
> 时间：2012-06-21T17:27:04.340
> 
> 标签：objective-c

过去，当我不得不在 Snow Leopard（或任何较旧的 Mac OS X）上编译某些东西并使用 Lion 及更高版本上可用的一些 @selector 时，我做了这样的事情：

```
if([foo respondsToSelector:@selector(awesomeLionSelector)]) {
    [foo awesomeLionSelector]
} 
```

这效果很好。所以，现在我正在尝试对一个返回浮点数的新方法做同样的事情，但是下面的行：

```
float f = [foo awesomeLionSelectorWhichReturnsFloat]; 
```

引发编译错误：“无法在赋值中将 'objc_object*' 转换为 'float'”。这是因为编译器不知道该方法并且必须假定返回类型为“id”。

解决此问题的正确方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-21T17:38:10.847

不是最优雅的修复，但仍然是一个修复。

```
#ifdef SnowLeopard
float f = [foo awesomeLionSelectorWhichReturnsFloat];
#endif 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-21T17:39:18.710

编辑：根据 John Caswell 的评论，要使用的正确运行时函数是`objc_msgSend_fpret()`，它返回一个双精度值。

我认为您应该尝试以下方式：[objc_msgSend_stret()](https://developer.apple.com/library/mac/documentation/Cocoa/Reference/ObjCRuntimeRef/Reference/reference.html#//apple_ref/doc/c_ref/objc_msgSend_stret)：

> objc_msgSend_stret
> 
> 将带有数据结构返回值的消息发送到类的实例。
> 
> ```
>  void objc_msgSend_stret(void * stretAddr, id theReceiver, SEL theSelector,  ...) 
> ```

就像是：

```
objc_msgSend_stret(&myFloatReturnValue, foo, @selector(awesomeLionSelector)); 
```

# xcode - 自动化 Xcode Organizer 分发？

> ID：11143511
> 
> 赞同：1
> 
> 时间：2012-06-21T17:27:07.273
> 
> 标签：xcode, archive, ipa, distribute

我们有一个供应商为我们开发 iOS 应用程序。他们正在为我们提供构建的 .xcarchive 文件。我们一直在使用 Xcode“Organizer”窗口将构建分发为 .ipa 文件。这是一个相当小的任务，但它是乏味和重复的。

我见过很多使用 xcrun 生成 .ipa 文件的示例，但是否可以自动化这部分？

# iphone - 目标c中sqlite的读写访问

> ID：11143512
> 
> 赞同：0
> 
> 时间：2012-06-21T17:27:19.937
> 
> 标签：iphone, objective-c, xcode, sqlite, read-write

希望这是有道理的。我的文档文件夹中有一个 sqlite 数据库。我还有一个函数可以检查目录中是否存在该文件，如果不存在，则将其从主包中移到那里。所以我知道数据库位于正确的访问位置。但是，当我运行我的应用程序时，我收到错误：没有这样的表：databaseName。问题可能与sqlite数据库的读写访问有关吗？如果是这样，我如何检查并纠正问题？

```
#define kFilename   @"foods.sqlite"

- (NSString *)dataFilePath {
NSString* documentsPath = [NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES) objectAtIndex:0];
NSString* sqliteFile = [documentsPath stringByAppendingPathComponent:kFilename];
BOOL fileExists = [[NSFileManager defaultManager] fileExistsAtPath:sqliteFile];
if(fileExists)
    return sqliteFile;
else {

    NSString *sourcePath = [[[NSBundle mainBundle] resourcePath] stringByAppendingPathComponent:kFilename];
    NSString *folderPath = [documentsPath stringByAppendingPathComponent:kFilename];

    NSError *error;

    [[NSFileManager defaultManager] copyItemAtPath:sourcePath 
                                            toPath:folderPath
                                             error:&error];

    NSLog(@"Error description-%@ \n", [error localizedDescription]);
    NSLog(@"Error reason-%@", [error localizedFailureReason]);
}
return [documentsPath stringByAppendingPathComponent:kFilename];
}

-(void) viewWillAppear:(BOOL)animated{

sqlite3 *database;
if (sqlite3_open([[self dataFilePath] UTF8String], &database)
    != SQLITE_OK) { 

    sqlite3_close(database);
    NSAssert(0, @"Failed to open database");
}

sqlite3_stmt *statement;
//why is this if statement failing?

if (sqlite3_prepare_v2(database, [sqlStatement UTF8String],
                       -1, &statement, nil) == SQLITE_OK) {
    while (sqlite3_step(statement) == SQLITE_ROW) {
        //int row = sqlite3_column_int(statement, 0);
        char *rowData = (char *)sqlite3_column_text(statement, 1);
        foodName = [[NSString alloc] initWithUTF8String:rowData];
        [foodArray addObject:foodName];
    }
    sqlite3_finalize(statement); 
}
else {

    NSLog(@"%i", sqlite3_prepare_v2(database, [sqlStatement UTF8String],
                              -1, &statement, nil)); 
    NSLog(@"Statement: %s", sqlite3_errmsg(database));

}
sqlite3_close(database);
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-21T18:51:31.823

您收到的错误表明您的数据库文件中不存在表“databaseName”。

您没有收到无法打开数据库的错误，所以这不是问题。

看起来你的 sqlStatement 是错误的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-21T18:36:11.190

改用这种方式。跳过中间目录步骤，直接与数据库对话。

```
- (void)checkAndCreateDB {

    NSString *dbPath = [[[NSBundle mainBundle] bundlePath]stringByAppendingPathComponent:@"../Documents/yourDB.sqlite"];

    // Check if the SQL database has already been saved to the users phone, if not then copy it over
    BOOL success;

    // Check if the database has already been created in the users filesystem
    success = [[NSFileManager defaultManager] fileExistsAtPath:dbPath];

    if(!success) {

    NSString *databasePathFromApp = [[[NSBundle mainBundle] resourcePath] stringByAppendingPathComponent:@"yourDB.sqlite"];

    [fileManager copyItemAtPath:databasePathFromApp toPath:dbPath error:nil];

    NSLog(@"readandwrite is available");
    }

if(!(sqlite3_open([dbPath UTF8String], &dB) == SQLITE_OK))
    {
        NSLog(@"An error has occurred.");
    }

} 
```

# jquery - IE8 渲染问题

> ID：11143515
> 
> 赞同：0
> 
> 时间：2012-06-21T17:27:24.380
> 
> 标签：jquery, html, css, html-table, internet-explorer-8

将表格中的 td 显示设置为无时，表格在 IE8 中无法正确调整大小。

如果我有一张桌子，我用这样的东西删除一整列：

```
$("th:first, th:last, tr td:first-child, tr td:last-child").toggle(0); 
```

它适用于除 IE8 之外的所有浏览器，将剩余的单元格保持在其原始宽度，并且不会调整到可用空间的宽度。

任何人都知道什么在这里不起作用？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-21T17:37:17.603

这是一个答案..但我对这里的其他人感兴趣：

好的，所以以下不起作用

```
$("table").hide().show(); 
```

但这确实有效：

```
$("table").hide().fadeIn(0); 
```

# css - 在渐变中使颜色更亮

> ID：11143517
> 
> 赞同：0
> 
> 时间：2012-06-21T17:27:36.930
> 
> 标签：css

假设我有一个使用以下 CSS 样式设置的按钮：

```
background-image: linear-gradient(bottom, rgb(112,166,30) 41%, rgb(150,222,42) 71%);
background-image: -o-linear-gradient(bottom, rgb(112,166,30) 41%, rgb(150,222,42) 71%);
background-image: -moz-linear-gradient(bottom, rgb(112,166,30) 41%, rgb(150,222,42) 71%);
background-image: -webkit-linear-gradient(bottom, rgb(112,166,30) 41%, rgb(150,222,42) 71%);
background-image: -ms-linear-gradient(bottom, rgb(112,166,30) 41%, rgb(150,222,42) 71%);
background-image: -webkit-gradient(
 linear,
 left bottom,
 left top,
 color-stop(0.41, rgb(112,166,30)),
 color-stop(0.71, rgb(150,222,42))
); 
```

有什么简单的方法可以保持颜色相同但**更亮**？基本上是在悬停输入元素时改变样式。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-21T17:31:35.387

使用两个类：

```
.button {
... your existing css
} 
```

然后为 :hover 使用一组单独的颜色

```
.button:hover {
... your existing css with different colours
} 
```

您实际上使用 CSS 设置不同的颜色值。

这是一个方便的工具： http: [//www.colorzilla.com/gradient-editor/](http://www.colorzilla.com/gradient-editor/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-21T17:30:09.647

使用 CSS3，您现在可以使用更有趣的颜色模型：[HSL](http://www.w3.org/TR/css3-color/#hsl-color)，其中 L 是光。当您想让颜色的亮度发生变化时，这是一个很好的模型。如果你想让它更亮（而不是在上面使用白色层更苍白），这就是要走的路。

如果您不想更改 CSS，则必须编写代码。例如，您可以读取和解析 css 颜色（使用[jquery css 函数](http://api.jquery.com/css/)）并在悬停对象时将其动态设置为灯光组件的不同值。

但是，如果您有许多颜色和渐变，最好的解决方案可能是使用动态样式表，例如[less](http://lesscss.org/)，您可以在其中简单地定义 2 个（或更多）亮度值以包含在您的 css 规则中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-21T17:31:24.890

您的云在渐变元素后面有一个白色背景元素（将当前代码包装在 div 或其他东西中），然后在悬停时更改颜色的不透明度。否则，您将需要完全不同的颜色。

希望有帮助。:)

# java - 使用 CacheBuilder 的缓存作为 Map

> ID：11143528
> 
> 赞同：4
> 
> 时间：2012-06-21T17:28:09.367
> 
> 标签：java, guava

我目前`ConcurrentHashMap`在我的应用程序中使用 a，但我需要添加在超时期限后有效地使条目过期的功能（expireAfterWrite），并在删除条目时通知删除侦听器。

我看到它`CacheBuilder`可以提供我需要的东西，但我对使用它犹豫不决，因为我需要的是地图，而不是缓存。我这么说（地图和缓存之间的区别）是因为番石榴缓存文档说明了这一点

> 通常，Guava 缓存实用程序适用于以下情况：
> 
> *   你愿意花一些内存来提高速度。
> *   您希望键有时会被多次查询。
> *   原则上，如果每个值都立即从缓存中逐出，您的应用程序将正常工作——但您正在尝试减少重复工作。

特别是第三个要点在我的应用程序中是不合适的。我将值存储在我想稍后检索的地图/缓存中（直到它到期）。此外，我的密钥通常只被查询一两次，而不是很多次才能看到缓存的好处。所以你看我的要求是地图，而不是某种意义上的缓存。使用 CacheBuilder 作为映射来存储将 expireAfterWrite 并提供removingListener 功能的值仍然是一个好主意吗？任何人都足够了解 CacheBuilder 实现的内部结构来提供建议吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-21T18:53:50.023

**编辑：**当然`MapMaker`不赞成使用缓存功能[`CacheBuilder`](http://docs.guava-libraries.googlecode.com/git-history/v12.0/javadoc/com/google/common/cache/CacheBuilder.html)，我的错。不要犹豫使用它：

```
Cache<Key, Graph> graphs = CacheBuilder.newBuilder()
    .concurrencyLevel(4) // read docs for more details
    .expireAfterWrite(yourExpireTime, TimeUnit.MINUTES)
    .build(); 
```

[`Cache#asMap()`](http://docs.guava-libraries.googlecode.com/git-history/v12.0/javadoc/com/google/common/cache/Cache.html#asMap%28%29)如果您希望将其视为 ConcurrentMap ，然后使用。

~~使用 Guava - [MapMaker](http://docs.guava-libraries.googlecode.com/git-history/v12.0/javadoc/com/google/common/collect/MapMaker.html)的另一个实用程序。来自文档：~~

> 具有以下特性的任意组合的 ConcurrentMap 实例的构建器：
> 
> *   键或值自动包装在弱引用或软引用中
> *   超过最大大小时最近最少使用的驱逐
> *   **条目的基于时间的过期**，自上次访问或**上次写入以来测量**
> *   被驱逐（或以其他方式删除）条目的通知
> *   按需计算尚未存在的键的值
> 
> (...)
> 
> ~~返回的映射实现为具有与 ConcurrentHashMap 类似的性能特征的哈希表。它支持 ConcurrentMap 接口的所有可选操作。它不允许空键或值。~~

# xslt - XSL 命名空间问题

> ID：11143530
> 
> 赞同：0
> 
> 时间：2012-06-21T17:28:16.727
> 
> 标签：xslt, xsd, xslt-1.0

我有一个 XSL，它将一个 XSD 转换为另一个格式略有不同的 XSD。（基本上，目标文件将被规范化）。目标的另一个主要区别是添加了默认命名空间和目标命名空间。我实际上在获取命名空间时遇到了麻烦。这是我的 XSL 的一个片段：

```
<?xml version="1.0"?>
<xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform" xmlns:xsd="http://www.w3.org/2001/XMLSchema" version="1.0">
    <xsl:output method="xml" version="1.0" encoding="UTF-8"/>
    <xsl:variable name="Unions" select="'Yes'"/>
    <xsl:variable name="myname" select="//Table/Name"/>
    <xsl:variable name="namespace" select="concat('http://mynamespace/', $myname)"/>
  <xsl:template match="/">
    <xsl:element name="xsd:schema" namespace="http://www.w3.org/2001/XMLSchema" xmlns="$namespace"

      <xsl:attribute name="targetNamespace">
        <xsl:value-of select="$namespace"/>
      </xsl:attribute>
      <xsl:attribute name="elementFormDefault">qualified</xsl:attribute>
      <xsl:attribute name="attributeFormDefault">unqualified</xsl:attribute>
...
    </xsl:element>
  </xsl:template>
</xsl:stylesheet> 
```

这就是我得到的：

```
<?xml version="1.0" encoding="utf-8"?>
<xsd:schema targetNamespace="http://mynamespace/somename" elementFormDefault="qualified" attributeFormDefault="unqualified" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns="">
...
</xsd:schema> 
```

并且 xmlns="$namespace" 被标记到每个子节点上。我不是 XSLT 方面的绝对专家。我不必自己开发它，因为 BizTalk 映射会为您生成所有这些，但是这个 XSL 比我可以让 BizTalk 映射处理的要复杂得多。

哦，我仅限于 XSLT 1.0

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-21T17:56:36.020

使用动态生成的值生成名称空间节点是 XSLT 1 无法真正做到的。XSLT 2`xsl:namespace`专门添加了构造这样的东西。

您说您被困在 XSLT 1 中。您是否有 EXSLT 或任何其他可用的扩展命名空间来为您提供 node-set() 扩展？如果是这样你可以去

```
 <xsl:template match="/">

 <xsl:variable name="x">
 <xsl:element name="x" namespace="{$namespace}">
   <xsl:element name="xsd:schema" namespace="http://www.w3.org/2001/XMLSchema">
   ....
 </xsl:variable>
 <xsl:copy-of select="xx:node-set($x)/*/*"/>
</xsl:template> 
```

`<x>`在所需的命名空间中创建一个虚假元素，这会强制命名空间节点进入其子`xs:schema`元素，如果您有节点集扩展功能，您可以提取该子元素。

# java - 在 gwt 中使用 jar

> ID：11143531
> 
> 赞同：1
> 
> 时间：2012-06-21T17:28:28.480
> 
> 标签：java, gwt, jar

一个快速而简单的问题:)。

我有一个带有许多类的 .jar，我想在客户端（GWT）和服务器端都使用它们。

如果我将 .jar 添加到 Web 服务器 lib 文件夹，GWT 编译器无法访问它。并且放置 .shared 文件夹也不起作用。

那么，我可以做些什么来访问服务器端和 Java google web 工具包客户端代码中的 .jar 容器中的类？

PS：我显然不想从 .jar 容器中取出所有的类。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-21T17:46:54.927

AFAIK 在这种情况下（共享类）源必须由 GWT 编译，因此您不能只删除任何带有预编译类的 .jar。如果您不想将类解包到单独的项目（对于那些源类）并包含到主项目中，您可以将源文件包含在 .jar 中。无论哪种方式，您都需要源类。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-21T18:12:36.907

你应该记住一件事。你的 jar 应该包含能够被 gwt 编译器编译的代码。因为如果你想共享，所以它应该与服务器和客户端都兼容。同一服务器无法理解客户端代码，反之亦然。它只需将 jar 放入库路径或使项目依赖即可。

# c# - SolrNet - 具有自定义连接的多个实例

> ID：11143534
> 
> 赞同：1
> 
> 时间：2012-06-21T17:28:55.737
> 
> 标签：c#, solr, castle-windsor, castle, solrnet

我在我的应用程序中使用 Solr.NET。在应用程序中，我需要连接到两个不同的 solr 服务器。这两个 solr 服务器都返回相同类型的文档，我们将文档类型称为 Foo。

此外，我需要使用自定义连接，以便始终将所有查询发布到 solr。

这是我到目前为止所拥有的：

```
StartUp.Init<Foo>(new PostOnlyConnection(connectionString1))
StartUp.Init<Foo>(new PostOnlyConnection(connectionString2)) 
```

显然，IoC 容器对此会抛出错误，因为这两种类型是相同的。我尝试使用[本文](http://code.google.com/p/solrnet/wiki/MultiCoreAccess#With_Windsor_facility)中的信息解决此问题，但 Windsor 工具不允许我传入自定义连接对象，只能传入连接字符串。有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-22T15:53:59.007

看起来您仍在使用仅限于不同文档类型的内置容器（启动）。您发布的[文章](http://code.google.com/p/solrnet/wiki/MultiCoreAccess#With_Windsor_facility)包含温莎的示例。

我对 Windsor 不太熟悉，但您应该可以`ISolrConnection`使用您的 custom重新注册`PostOnlyConnection`。

参考：

[SolrNet 连接说明](https://stackoverflow.com/questions/6830623/question-about-solrnet-connection)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-26T19:59:11.030

如果 Windsor 选项不起作用，您可以创建 2 个继承自同一个类的类，以初始化具有不同类型的 solr 连接。

```
class Foo {}
class FooA : Foo {}
class FooB : Foo {}

StartUp.Init<FooA>(new PostOnlyConnection(connectionString1))
StartUp.Init<FooB>(new PostOnlyConnection(connectionString2)) 
```

我有超过 1 个核心，这是我使用的解决方案。它带来了一些挑战，这意味着您将需要一些模板方法来查询每个 solr 实例中的数据。

# javascript - 为接受事件的函数调用设置超时不适用于 IE7

> ID：11143535
> 
> 赞同：0
> 
> 时间：2012-06-21T17:28:59.020
> 
> 标签：javascript, jquery, internet-explorer

我对 Web 开发相当陌生，我想我已经掌握了窍门，我一直遇到的唯一主要问题是跨浏览器兼容性问题。

我在网页上有一个文本区域，它将在用户完成输入后调用一个函数。为了做到这一点，我使用 jQuery 和 setTimeout 在调用函数之前稍等片刻。这样可以确保在每次按键后都不会调用该函数。我不希望在每次按键后调用它，因为该函数向一个 servlet 发送一个请求，该 servlet 进行一些处理并返回。

该代码在 Chrome 上运行良好（我使用 Chrome 进行调试），但它不适用于 IE7。这里是：

```
var timer = null;
$("#scriptInput").keypress(function() {
    clearTimeout(timer);
    var thisEvent = window.event;
    timer = setTimeout(function() {validateScript(thisEvent);}, 500);           
});

function validateScript(evt) {
  var code = (evt.keyCode) ? evt.keyCode : evt.which;

  //check which key was pressed...
  //don't need to send a request on key presses of CAPSLOCK, SHIFT, and ARROW keys
  if(code != 20 && code != 16 && code != 37 && code != 38 && code != 39 && code !=40){ 
    sendRequest(2);
  }
} 
```

如您所见，我已经多次尝试实现与 IE7 的兼容性，但无济于事：\

它必须至少与 IE7 兼容，因为它将被许多使用 IE7 并且没有升级权限的机器使用。

如果您需要更多信息，请告诉我！谢谢！

PS“scriptInput”是正在影响的文本区域的 id。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-21T17:34:03.267

`var thisEvent = window.event;`不跨浏览器兼容 - 并非所有浏览器都使用全局`event`对象，而是使用函数参数。

jQuery 总是为您提供一个事件对象作为函数参数，因此只需删除上述分配并更改您的代码，如下所示：

```
$("#scriptInput").keypress(function(thisEvent) {
    ...
}); 
```

jQuery 还将按键的各种属性标准化，`e.which`以便您可以摆脱`var code = (evt.keyCode) ? evt.keyCode : evt.which;`并简单地`evt.which`一直使用。

* * *

您还可以进一步改进/缩短整个事情。如果添加另一个库很好，我会使用[`_.debounce`](http://documentcloud.github.com/underscore/#debounce)Underscore.js 来进行计时：

```
$("#scriptInput").keypress(_.debounce(validateScript, 500)); 
```

除了 Underscore.js，您还可以使用[提供该功能的 jQuery 插件](http://code.google.com/p/jquery-debounce/)。

如果添加额外的第三方代码不是一个选项，我会将计时器存储在元素上而不是（可能是全局的）变量上：

```
$("#scriptInput").keypress(function(e) {
    var $this = $(this);
    window.clearTimeout($this.data('timer'));
    $this.data('timer', window.setTimeout(function() {
        validateScript(e)
    }, 500));
}); 
```

# entity-framework - 选择非 EF DTO 类型时如何保存更改？

> ID：11143536
> 
> 赞同：0
> 
> 时间：2012-06-21T17:29:06.150
> 
> 标签：entity-framework, entity-framework-4, entity-framework-4.1, devexpress

我正在使用以下代码使用来自 DB 优先模型的数据填充 DevExpress XtraGrid。调用`SaveChanges`没有效果，我认为这是因为没有与我为网格选择的对象匹配的缓存对象。

有什么方法可以告诉 EF`Id`在保存更改期间使用 PK, , 将新值应用于缓存对象？`SaveChanges`如果我将整个 Employee 对象用于网格，则调用有效。

```
private void EmployeeFormLoad(object sender, EventArgs e)
{
    empsGridView.OptionsBehavior.Editable = true;
    var emps = context.Employees.Select(emp => new EmployeeDescriptor
    {
        Id = emp.Id,
        FirstName = emp.FullNames,
        LastName = emp.Surname
    });

    employeeDescriptorBindingSource.DataSource = emps.ToList();
}

private void button1_Click(object sender, EventArgs e)
{
    employeeDescriptorBindingSource.EndEdit();
    context.SaveChanges();
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-21T17:42:59.973

匿名类型在 C# 中是不可变的。在 VB 中，您可以使用“Key”关键字使它们可变，尽管我不确定 EF 是否支持更新。如果您希望您的模型可编辑，请将概念模型更改为仅包含您需要的字段，并确保未使用的表列都可以为空。

# java - OutOfMemoryError：Java 堆空间：尝试转换约 570 万条记录数据集

> ID：11143538
> 
> 赞同：1
> 
> 时间：2012-06-21T17:29:15.547
> 
> 标签：java, dataset, heap-memory

我有一个稀疏的 2D 数据集，其中包含大约 600 万条记录，每条记录最多包含大约 20 个特征。我想将其转换为只有零和一的非稀疏二维数据集，但我不断收到 OutOfMemoryError。

这是我的数据集的示例：

```
1: 1723762 2737 2 283
2: 239 220 12 19237 2795
3: 3910 2931 86043 26354 349874 73736 2611 93921 4123830
4: 5
5: 4728 2
...(up to ~6mil) 
```

我想将其转换为：

```
0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 ...(up to ~6mil)
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 
0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 
0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 
...(up to ~6mil) 
```

请注意，在第一行，第 2 列有一个 1，因为它在原始数据集中具有该特征，在第 4 行第 5 列和第 5 行第 2 列相同。

我为此创建了一个代码，但是当我尝试以下操作时它已经耗尽了内存：

```
 File data = new File("dataSet.txt");
    Scanner in = new Scanner(data);

    //check how many rows
    int nRows = 0;
    while (in.hasNextLine()) {
        in.nextLine();
        nRows++;
    }        

    //initializing the matrix
    in.close();
    in = new Scanner(data);
    int[][] matrix = new int[nRows][nRows]; 
```

似乎它甚至无法处理那么大的数组？获得一个非稀疏矩阵至关重要。有没有办法解决这个内存错误？

亲切的问候，

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-21T17:40:24.857

将阵列分配到更小、更易于管理的部分中，在对它们进行处理后使这些部分保持不变，然后根据需要再次查找它们。这里的问题是你不能一次将整个事情排序并处理到内存中。您正在处理大量数据，如果您想构建一个 6Mx6M 矩阵，那么再多的额外堆空间也无济于事。

# javascript - Chrome 内容脚本无法附加侦听器

> ID：11143540
> 
> 赞同：0
> 
> 时间：2012-06-21T17:29:31.830
> 
> 标签：javascript, javascript-events, google-chrome-extension

据我所知，您应该能够从内容脚本中附加事件侦听器。为了把它归结为最基本的东西，我有这个内容脚本：

```
if (document.getElementsByTagName('img')) {
    alert('This will fire');
    document.getElementsByTagName('img')[0].addEventListener('onclick', function() {
        alert('This will not fire');
    });
} 
```

我什至尝试使用内容脚本将脚本元素注入页面。但是，注入的脚本也不能附加事件处理程序。

作为参考，这是我的 manifest.json 的片段：

```
 "content_scripts": [{
    "matches": [
        "http://*/*",
        "https://*/*"
    ],
    "run_at": "document_end",
    "js": ["js/contentscript.js"],
    "all_frames": true
  }] 
```

我过度使用权限只是为了确定这不是问题。

具体来说，我想处理`img.onclick`and `window.onresize`。我可能哪里出错了？

* * *

编辑：好的，由于一个愚蠢的错字，它现在可以在常规内容脚本中工作，但是当页面加载到 iframe 中时我无法让它工作。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-21T17:34:38.257

```
element.addEventListener('click', function(){}); 
```

或者

```
element.onclick = function(){}; 
```

代替

```
element.addEventListener('onclick', function(){}); 
```

# sql-server - AdventureWorks 无法创建 ado.net 实体数据模型

> ID：11143541
> 
> 赞同：7
> 
> 时间：2012-06-21T17:29:39.237
> 
> 标签：sql-server, visual-studio-2010, ado.net

我正在尝试使用微软的示例数据库 AdventureWorks2008R2... 当我尝试创建 ADO.NET 实体数据模型时，我收到此错误：

```
Unable to generate the model because of the following exception: 'The table 'C:\USERS\XXXX\DOCUMENTS\VISUAL STUDIO 2010\PROJECTS\ANOTHERWORKS\ANOTHERWORKS\APP_DATA\ADVENTUREWORKS2008R2_DATA.MDF.Production.Document' was referenced by a relationship, but was not found.'.
Loading metadata from the database took 00:00:06.2308687.
Generating the model took 00:00:04.5808698.
Added the connection string to the Web.Config file.
Successfully registered the assembly 'System.Data.Entity, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089' in the Web.Config file.
Writing the .edmx file took 00:00:00.0015898. 
```

有人遇到并解决了这个问题吗？或者知道在某个地方我可以下载该数据库的工作版本（除此之外： http: [//msftdbprodsamples.codeplex.com/releases/view/59211](http://msftdbprodsamples.codeplex.com/releases/view/59211)这是我得到它的地方）

或者有人可以指向我可以下载并在实体框架中使用的示例数据库。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-27T06:27:38.787

**EDIT**

The new EF designer (Beta 1 available [here](http://www.microsoft.com/en-us/download/details.aspx?id=39076)) will not try creating relationships to non-existing tables so instead of the error and empty model you will get a model where invalid entity types/sets and relationships are commented out.

**

I looked at it for AdventureWorks for Sql Server 2012 but I think it is the same thing you hit for 2008R2/ The issue here is that the Production.Document table has a key that is of HierarchyId type and EF currently does not support HierarchyId type. EF ignores columns of types it does not understand when creating the model however if it does not understand a key column it will exclude the entire entity from the model. For excluded entities you should be able to find them commented out in the model when you open it with an Xml/Text editor. In this particular case this is what will see:

```
<EntityContainer Name="AdventureWorksModelStoreContainer" />
    <!--Errors Found During Generation:
  warning 6005: The data type 'hierarchyid' is currently not supported for the target .NET Framework version; the column 'DocumentNode' in table 'AdventureWorks.Production.Document' was excluded.
  warning 6031: The column 'DocumentNode' on the table/view 'AdventureWorks.Production.Document' was excluded, and is a key column.  The table/view has been excluded.  Please fix the entity in the schema file, and uncomment.

  <EntityType Name="Document">
    <Property Name="DocumentLevel" Type="smallint" StoreGeneratedPattern="Computed" />
    <Property Name="Title" Type="nvarchar" Nullable="false" MaxLength="50" />
    <Property Name="Owner" Type="int" Nullable="false" />
    <Property Name="FolderFlag" Type="bit" Nullable="false" />
    <Property Name="FileName" Type="nvarchar" Nullable="false" MaxLength="400" />
    <Property Name="FileExtension" Type="nvarchar" Nullable="false" MaxLength="8" />
    <Property Name="Revision" Type="nchar" Nullable="false" MaxLength="5" />
    <Property Name="ChangeNumber" Type="int" Nullable="false" />
    <Property Name="Status" Type="tinyint" Nullable="false" />
    <Property Name="DocumentSummary" Type="nvarchar(max)" />
    <Property Name="Document" Type="varbinary(max)" />
    <Property Name="rowguid" Type="uniqueidentifier" Nullable="false" />
    <Property Name="ModifiedDate" Type="datetime" Nullable="false" />
  </EntityType>-->
  </Schema> 
```

Notice this warning:
warning 6031: The column 'DocumentNode' on the table/view 'AdventureWorks.Production.Document' was excluded, and is a key column. The table/view has been excluded. Please fix the entity in the schema file, and uncomment.

Now in the AdventureWorks database the Production.Document table is referenced by Production.ProductDocument table. Since no entity for Production.Document table was created EF is unable to create the reference from Production.ProductDocument entity and hence the "Production.Document' is referenced by a relationship, but cannot be found.' error.

Since the Production.Document table cannot be really used "as is" by EF the easiest workaround is to exclude this entity when generating the model from entity - check all tables but Production.Document in the wizard and you should be good to go. EF will ignore all references to this entity since you excluded it and therefore there should be no error.

[Link to a related work item on Entity Framework codeplex site](http://entityframework.codeplex.com/workitem/695)

# hbase - 把桌子放在桌子上

> ID：11143542
> 
> 赞同：0
> 
> 时间：2012-06-21T17:29:40.017
> 
> 标签：hbase, schema-design

我有一个看起来像这样的架构设计：

```
Table: User
    Row                Column Family
                       User
    u1                 User:name
                       User:mail

                       Table: Tags
                       Row                  Column
                       t1                   tag_id 
```

所以，它是表中的表。我的问题是，如何使用 HBase shell 在表中添加表？我知道将值添加到特定列族中的列的“put”命令。但是，它使我无法在表格中添加表格。有谁知道如何做到这一点？

谢谢，利安德

**6月25日更新，**

谢谢塔里克！我以这种方式修复了它（受您的回答启发）

```
Table: User
u1                    User:name
                      User:mail
                      User:tags = ['t1', 't2', 't4']

Table: Tags
t1                    Tag:tag_id
                      Tag:users = ['u1', 'u2'] 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-21T22:02:43.910

这是不可能的。但是，您可以明智地设计架构以使其符合您的要求。例如，创建一个表“用户”，就像你展示的那样。然后再创建一个名为“标签”的表，其中包含一个列族“tag_id”。就像你指定的那样，为“用户”表创建行键上面和“标签”表通过将“t1”后缀添加到“u1”来创建行键，这样特定用户的所有标签都将转到同一行。所以你的键看起来有点像“abc+t1” ..这将帮助您有效地获取特定用户的标签..如果您发现它适合您的用例，请告诉我。

# javascript - Three.js 中的 SpotLight 旋转

> ID：11143544
> 
> 赞同：6
> 
> 时间：2012-06-21T17:29:58.333
> 
> 标签：javascript, 3d, three.js

我正在尝试旋转聚光灯。我的代码是：

```
var light   = new THREE.SpotLight( color, intensity, distance );
light.position.set( 0, 100, 0 );
light.rotation.set( 0, Math.PI, 0 );
light.shadowCameraFar = 50;
light.shadowCameraNear      = 0.01;     
light.castShadow        = true;
light.shadowDarkness        = 0.5;
light.shadowCameraVisible   = true;
light.shadowCameraFar = 800;
light.shadowCameraFov = 15;
scene.add( light ); 
```

我想知道我做错了什么。聚光灯不会改变它的旋转独立于我输入的值。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-21T19:22:00.973

`light.target`确定聚光灯的阴影相机方向。例如，如果您的场景中有一个名为 myObject 的对象，您可以执行以下操作：

```
light.target = myObject; 
```

请记住，`light.target`是一个`Object3D`，而不是一个位置向量。

三.js r.49

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-05-17T09:27:24.120

因此，您可以通过直接分配来定位灯光目标：

```
myLight.target.position = new THREE.Object3D( 10, 20, 30 ); 
```

或者通过定义灯光目标对象属性：

```
myLight.target.position.x = 10;
myLight.target.position.y = 20;
myLight.target.position.z = 30; 
```

# php - PHP 类 - 将变量发送到 INSERT QUERY

> ID：11143547
> 
> 赞同：0
> 
> 时间：2012-06-21T17:30:01.690
> 
> 标签：php, jquery

我需要一些有关 PHP 类的帮助。我对它的工作原理知之甚少，我正在尝试更多地了解它。同时，我有一个问题，我需要在变量通过类中的这些函数运行后获取它。

```
protected function upcount_name_callback($matches) {
        $index = isset($matches[1]) ? intval($matches[1]) + 1 : 1;
        $ext = isset($matches[2]) ? $matches[2] : '';
        return ' ('.$index.')'.$ext;
    }

    protected function upcount_name($name) {
        return preg_replace_callback(
            '/(?:(?: \(([\d]+)\))?(\.[^.]+))?$/',
            array($this, 'upcount_name_callback'),
            $name,
            1
        );
    } 
```

我需要在下面的 JS 语句中检索这个变量并发送到我的 INSERT php 文件。

```
$('#albumBack.fileupload').bind('fileuploaddone',function(e,data) {

    //Loop through each page and return object and write to DB
    $.each(data.files, function (index, file) {
        var filename = file.name;
        $.ajax({ 
            type: "POST",
            url: "../albumUploader/queries/albumPages.php",
            data: {file: filename}
        });
    });
}); 
```

我当前获得的文件名是原始名称，而不是附加名称。感谢您对此的任何帮助。

专辑页面.php

```
//Variables for gallerimage table
    $originalName = $_POST['file'];
    $clientRef = $_SESSION['clientRef'];
    $galleryID = $_SESSION['newGalleryId'];
    $galleryLayout = $_SESSION['layoutID'];
    $imageID = rand();

    //Find the sort# for the gallery
    $qSortOrder = mysql_query("SELECT MAX(sort) AS sortOrder
                                    ,id
                                    ,clientRef
                                    ,galleryId
                                    FROM galleryimage
                                    WHERE galleryId='{$galleryID}' 
                                    AND clientRef= '{$clientRef}'
                                    ");
    $fsortOrder = mysql_fetch_array($qSortOrder);
    //Latest revision
    $orderNumber = $fsortOrder['sortOrder'];
    $order = $orderNumber + 1;

    $query = "INSERT INTO galleryimage 
            (
                galleryId
                ,image
                ,OrgImageName
                ,clientRef
                ,sort
                ,layout
            ) VALUES (
                '{$galleryID}'
                ,'{$imageID}'
                ,'{$originalName}'
                ,'{$clientRef}'
                ,'{$order}'
                ,'{$galleryLayout}'
            )";
    $return = mysql_query($query); 
```

$originalName 是我需要定义为 img.jpg、$img(1).jpg 等的 $variable。我只是 POSTING 文件，它最终是从输入中选择的原始文件。

这是选择文件的表格。

```
<form class="fileupload" id="albumBack" action="../js/jQuery-file-upload/server/php/" method="POST" enctype="multipart/form-data" >
                <!-- The fileupload-buttonbar contains buttons to add/delete files and start/cancel the upload -->
                <div class="row fileupload-buttonbar">
                        <span class="btn btn-success fileinput-button">
                            <span>Choose Back</span>
                            <input type="file" name="files[]">
                        </span>
                    </div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-21T17:53:42.383

在不知道albumBack.php 的内容的情况下，很难确切地确定您将看到的行为。但是让我们假设albumBack.php`upcount_name($name)`在某个时候调用。

然后会发生[preg_replace_callback](http://php.net/manual/en/function.preg-replace-callback.php)被调用。这个函数专门接受一个字符串和一个正则表达式，以及一个额外的“回调”函数。它在字符串上运行正则表达式并获取一组匹配项，然后将其传递给回调函数。回调允许您以灵活的方式“注入”行为：在这种情况下，回调是一种定义每个正则表达式匹配的替换字符串的方式。

该`upcount_name_callback`函数就是这里调用的函数。要了解它的作用，您必须了解正则表达式。这有点复杂，但本质上它是在寻找一些数字（`[\d]+`部分），`.`然后是行尾。`upcount_name_callback`将 this 作为一个数字，它递增和一个扩展，如果它存在，它会按原样返回，如果不存在则作为空字符串。

结果是这似乎将“blah.jpg”更改为“blah1.jpg”，将“blah1.jpg”更改为“blah2.jpg”。但是，看起来如果您返回的名称相同，它实际上并没有被执行。您需要发布来自 albumBack.php 的调用代码行来确认这一点。

# c# - 具有类似行为的 C# 多个按钮

> ID：11143549
> 
> 赞同：3
> 
> 时间：2012-06-21T17:30:09.833
> 
> 标签：c#

我是 C# 新手，目前正在关注这个 C# 教程。在本教程中，我遇到了开发计算器的练习。

[AC# .Net 计算器 - 设计阶段](http://www.homeandlearn.co.uk/csharp/csharp_s2p15.html)

在练习中给出的解决方案中，每个数字按钮都有一个 btn*_click 方法，可以很容易地推广。

[![1](../Images/030d26d0d578f995567f4f20fbdcade1.png)](https://i.stack.imgur.com/wk0Oj.gif)
[（来源：[homeandlearn.co.uk](http://www.homeandlearn.co.uk/csharp/images/calculator/buttonCode_Numbers.gif)）]

我们如何编写代码，以便我们可以概括这 10 个功能？我虽然可以通过修改 initializeComponent() 来完成，但是关于它的评论说它不应该使用代码编辑器进行修改。

如何解决这个问题。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-06-21T17:33:33.203

您可以将所有按钮绑定到同一个单击事件处理程序，并用于`sender`获取文本：

```
private void btnAnyButton_Click(object sender, EventArgs e)
{
    Button theButton = sender as Button;
    txtDisplay.Text += theButton.Text;
} 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-06-21T17:41:54.330

您发布的教程是在视觉工作室中使用视觉编辑器。默认情况下，设计器将使用约定 {controlname}_{eventname} 生成代码，您可以在属性窗口中显式分配不同的事件名称，并且所有按钮*可以*共享相同的事件方法。

![在此处输入图像描述](../Images/df029c1e5a3af20cc7d48eda232c8147.png)

然后看起来你*可以*像这样重构：

```
private void btn_click(object sender, EventArgs e)
{
    Button btn = sender as Button;
    if(btn != null)
       txtDisplay.Text += btn.Text;
} 
```

我希望这会有所帮助。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-21T17:32:33.937

`tag`您可以从代码中动态生成这些按钮，并在属性中为它们分配一些值。从那里，您可以将它们全部连接到同一个事件处理程序（我们正在谈论数字按钮，如 0、1、2、3、4...）。在 onClick 事件处理程序中，您将获得`tag`调用者的值并执行您必须执行的操作。

伪代码：

```
void onClick(Button caller){
  int btnNb = (int) caller.Tag;
  //do what you have to do
} 
```

该`tag`属性不是*必需*的，但我发现它比获取按钮文本并转换为 int 更干净。

# c++ - 与守护进程对话

> ID：11143556
> 
> 赞同：4
> 
> 时间：2012-06-21T17:30:37.823
> 
> 标签：c++, c, linux, daemon

我最近看到了一些可以作为守护进程启动的程序（例如 linphonecsh），但也提供了第二种调用方法，可以与正在运行的守护进程交换信息。在 linpohone 的情况下，带有一组参数的 linephonecsh 启动守护进程，但如果使用一组不同的参数调用，它可以查询守护进程的状态（呼叫进行中、呼叫持续时间、挂断、退出等）。

所以，由于我需要编写一个可以运行任何一种方式的应用程序，应用程序或守护程序，我一直在思考如何实现这个巧妙的技巧。我想 UNIX 域套接字可以像命名的进程间管道一样工作。可能是 D 总线？

在哪里可以看到一个很好的 C/C++ 示例？

征求任何建议和替代方法。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-21T17:43:29.253

你有几个选择：

1.  共享内存
2.  管道
3.  UNIX 域套接字。

你应该根据你的任务细节决定哪一个最适合你。我假设您使用的是 Linux，因此[“高级 Linux 编程”一书中有关进程间通信的章节](http://www.advancedlinuxprogramming.com/alp-folder/alp-ch05-ipc.pdf)会有所帮助。它也提供了代码示例。

# xml - Anti-XML 中的拉链

> ID：11143558
> 
> 赞同：3
> 
> 时间：2012-06-21T17:30:45.353
> 
> 标签：xml, scala, zipper, anti-xml

在[这个问题](https://stackoverflow.com/q/11130684/334519)中，提问者想要像这样转换文档：

```
<text>
  The capitals of Bolivia are <blank/> and <blank/>.
</text> 
```

进入这个：

```
<text>
  The capitals of Bolivia are <input name="blank.1"> and <input name="blank.2">.
</text> 
```

正如我在[那里的回答中](https://stackoverflow.com/a/11143012/334519)指出的那样，[Anti-XML](http://anti-xml.org/)的[拉链](http://anti-xml.org/zippers.html)为这个问题提供了一个干净的解决方案。例如，以下内容可用于重命名空白元素：

```
import com.codecommit.antixml._

val q = <text>The capitals of Bolivia are <blank/> and <blank/>.</text>.convert

(q \\ "blank").map(_.copy(name = "input")).unselect 
```

不幸的是，以下方法不起作用：

```
(q \\ "blank").zipWithIndex.map { case (el, i) => el.copy(
  name = "input",
  attrs = Attributes("name" -> "blank.%d".format(i + 1))
)}.unselect 
```

因为当然，一旦我们`zipWithIndex`-ed zipper，我们就不再有 zipper，只是`IndexedSeq`- 我们不能有 a `Zipper[(Node, Int)]`，因为定义是`trait Zipper[+A <: Node] ...`.

是否有一种干净的方式来使用`zip`或`zipWithIndex`在 Anti-XML 拉链上，使用 等进行一些其他操作`map`，最终得到仍然是拉链的东西？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-22T16:15:31.080

我想不出一种直接的方法来实现您所需要的，但是如果您愿意使用较低级别的功能，则可以使用 a `fold`，例如：

```
val blanks = q \\ "blank"

(0 until blanks.size).foldLeft(blanks) {case (z, i) => z.updated(i, z(i).copy(
  name = "input",
  attrs = Attributes("name" -> "blank.%d".format(i + 1)))
)}.unselect 
```

请注意，拉链是一个随机访问容器，因此在这种情况下效率不应该成为问题。

# c++ - 清理 RAM（也许是 win32 api）？

> ID：11143559
> 
> 赞同：0
> 
> 时间：2012-06-21T17:31:09.063
> 
> 标签：c++, c, winapi, memory, ram

每隔一段时间，我就会看到提供 RAM 清理功能的“加速您的 PC”程序。

他们声称会整理碎片并释放未使用的内存，例如垃圾收集器或其他东西……不确定。

这里有些例子：

[http://www.softpedia.com/get/Tweak/Memory-Tweak/Clean-Ram.shtml](http://www.softpedia.com/get/Tweak/Memory-Tweak/Clean-Ram.shtml)

[http://download.cnet.com/Instant-Memory-Cleaner/3000-2086_4-10571833.html](http://download.cnet.com/Instant-Memory-Cleaner/3000-2086_4-10571833.html)

[http://www.uniblue.com/software/speedupmypc/](http://www.uniblue.com/software/speedupmypc/)

如果有人知道的话，我有兴趣了解他们正在使用的 Win32 C API。

我听说过 advapi32.dll 技巧中的 ProcessIdleTasks()，但查看该函数的文档看起来不太合法。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-21T17:40:31.687

我不知道这些特定程序是如何工作的，但在过去我看到了类似程序的源代码。

它基本上一次性分配了大量的 RAM，然后释放它。

系统 RAM 被“释放”，因为其他程序必须交换到磁盘。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-21T18:05:24.010

如果你真的坚持这样做，你可以枚举进程，打开每个进程的句柄，然后调用[`SetProcessWorkingSetSize(process_handle, -1, -1);`](http://msdn.microsoft.com/en-us/library/windows/desktop/ms686234.aspx)每个进程（但你*真的*不想这样做）。

# ruby - Heroku db:pull Taps Load Error: no such file to load -- pg

> ID：11143561
> 
> 赞同：6
> 
> 时间：2012-06-21T17:31:13.697
> 
> 标签：ruby, heroku, ruby-1.9.2, ruby-1.9.3, taps

使用 ruby​​ 1.9.2-p320 和 Heroku 的 Taps-使用“db”命令时，我遇到了以下错误，例如：

```
heroku db:pull --app my-app 
```

这会产生如下错误：

```
Taps Load Error: no such file to load -- sqlite3 
```

-或者-

```
Taps Load Error: no such file to load -- pg 
```

（是的，顺便说一句，我拥有所有正确的 gem，包括 postgres——在本地运行良好——和 sqlite3，以及卸载、重新安装和更新了 taps 和 heroku gem，包括它们以及不将它们包含在我的 Gemfile 中。我正在运行 Rails 3.2.6）

尽管有一个已知的错误会导致“时区位移”错误：[heroku db:push not working, using taps gem](https://stackoverflow.com/questions/10472728/heroku-dbpush-not-working-using-taps-gem?rq=1)，但我还没有看到任何直接解决此问题的 SO 帖子。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-06-21T19:16:40.973

在 postgres 实例之间迁移数据时，不再推荐使用 Taps 工具。请改为尝试[heroku-pg-transfer 。](https://github.com/ddollar/heroku-pg-transfer)

这仅在您使用[生产数据库](https://postgres.heroku.com/pricing)之一或新的[Heroku postgres dev 或 basic plan](https://devcenter.heroku.com/categories/heroku-postgres)时才有效。如果您仍在使用旧的共享数据库计划，我建议您切换到新的开发计划。

首先，在 Heroku 上找到您的数据库的 URL：

```
$ heroku config:get DATABASE_URL
postgres://yada:yada@ec2-107-21-122-141.compute-1.amazonaws.com:5432/123 
```

然后从 heroku 数据库转移到本地数据库：

```
$ heroku plugins:install https://github.com/ddollar/heroku-pg-transfer
$ heroku pg:transfer -t postgres://localhost/dbname -f postgres://yada:yada@ec2.../123 
```

由于 heroku-pg-transfer 工具利用了 postgres 的本机 pg_dump 工具，它是一个更具可预测性和弹性的工具。

我在这里写了更多关于它的内容：[使用 heroku pg:transfer 迁移 Postres 数据库](http://www.ryandaigle.com/a/pgtransfer-is-the-new-taps)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-18T18:48:53.383

我的解决方案是将 taps gem 和 sqlite3 gem（即使我在应用程序的任何地方都没有 sqlite）添加到 gemfile（正在开发中）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-21T17:31:14.213

我找到的解决方案，使用来自[https://github.com/ricardochimal/taps/issues/92](https://github.com/ricardochimal/taps/issues/92)的提示在此处详细介绍：[https ://github.com/ricardochimal/taps/issues/92#issuecomment-6486535](https://github.com/ricardochimal/taps/issues/92#issuecomment-6486535)

简而言之，据我所知，ruby 1.9.2-p320 似乎是问题所在。降级到 ruby​​ 1.9.2-p290 为我修复了它。这可能与上述链接中谈到的 ruby​​ 1.9.3 问题有关，不确定。

如果您仍然在使用 Taps，请[在 GH 上查看此评论](https://github.com/ricardochimal/taps/issues/92#issuecomment-11996909)，因为海报 doshea 似乎比我或 jfeust 更彻底地研究了它。

我还要在这里重申，如果你*不需要*Taps，那么 heroku-pgtransfer 就是你的朋友。请在此处查看[Ryan 对我的问题的回答](https://stackoverflow.com/a/11145211/492404)以及他关于使用更新工具[的出色博客文章。](http://www.ryandaigle.com/a/pgtransfer-is-the-new-taps)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-13T05:16:08.853

根据@likethesky，您可以降级。或者，只是

```
~/.rvm/bin/ruby-1.9.2-p320 /usr/bin/heroku db:push 
```

当然，这需要安装 p320 并安装 tap 和 sqllite3 gems。很容易就位。

# android - 如何使数字时钟只显示小时和分钟

> ID：11143568
> 
> 赞同：1
> 
> 时间：2012-06-21T17:31:30.453
> 
> 标签：android, clock, digital, hour, minute

我的应用程序中有一个活动的数字时钟，我只想在上面显示小时和分钟，不想显示秒。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-21T17:36:21.370

请在此处查看此答案，据我所知，您正在寻找类似/相同的东西：

[Android：DigitalClock 删除秒](https://stackoverflow.com/questions/7610549/android-digitalclock-remove-seconds)

回答的主要内容如下：

像 AnalogClock，但是是数字的。显示秒。FIXME：实现小时/分钟/秒的单独视图，因此比例字体不会影响渲染。

从 FIXME 来看，隐藏部分 DigitalClock 的能力最终可能会实现。我目前在 Javadoc 或源代码中没有找到任何可以执行您想要的操作的内容。除非您想编写自己的类来扩展 DigitalClock（或您自己的时钟实现），否则您可以只用另一个元素覆盖 DigitalClock 的秒部分，如果它符合您的目的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-07-14T19:20:01.760

系统根据系统时钟在每分钟的确切开始发送广播事件。最可靠的方法是这样做：

```
BroadcastReceiver _broadcastReceiver;
private final SimpleDateFormat _sdfWatchTime = new SimpleDateFormat("HH:mm");
private TextView _tvTime;

@Override
public void onStart() {
    super.onStart();
    _broadcastReceiver = new BroadcastReceiver() {
            @Override
            public void onReceive(Context ctx, Intent intent) {
                if (intent.getAction().compareTo(Intent.ACTION_TIME_TICK) == 0)
                    _tvTime.setText(_sdfWatchTime.format(new Date()));
            }
        };

    registerReceiver(_broadcastReceiver, new IntentFilter(Intent.ACTION_TIME_TICK));
}

@Override
public void onStop() {
    super.onStop();
    if (_broadcastReceiver != null)
        unregisterReceiver(_broadcastReceiver);
} 
```

但是不要忘记预先初始化您的 TextView（到当前系统时间），因为您可能会在一分钟的中间弹出您的 UI，并且 TextView 直到下一分钟才会更新。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-06-09T09:26:36.773

```
import android.content.Context;
import android.database.ContentObserver;
import android.os.Handler;
import android.os.SystemClock;
import android.provider.Settings;
import android.text.format.DateFormat;
import android.util.AttributeSet;
import android.widget.TextView;

import java.util.Calendar;

public class DigitalClock extends TextView {

    Calendar mCalendar;
    private final static String m24 = "k:mm";
    private FormatChangeObserver mFormatChangeObserver;

    private Runnable mTicker;
    private Handler mHandler;

    private boolean mTickerStopped = false;

    String mFormat;

    public DigitalClock(Context context) {
        super(context);
        initClock(context);
    }

    public DigitalClock(Context context, AttributeSet attrs) {
        super(context, attrs);
        initClock(context);
    }

    private void initClock(Context context) {
        if (mCalendar == null) {
            mCalendar = Calendar.getInstance();
        }

        mFormatChangeObserver = new FormatChangeObserver();
        getContext().getContentResolver().registerContentObserver(
                Settings.System.CONTENT_URI, true, mFormatChangeObserver);

        setFormat();
    }

    @Override
    protected void onAttachedToWindow() {
        mTickerStopped = false;
        super.onAttachedToWindow();
        mHandler = new Handler();

        /**
         * requests a tick on the next hard-second boundary
         */
        mTicker = new Runnable() {
                public void run() {
                    if (mTickerStopped) return;
                    mCalendar.setTimeInMillis(System.currentTimeMillis());
                    setText(DateFormat.format(mFormat, mCalendar));
                    invalidate();
                    long now = SystemClock.uptimeMillis();
                    long next = now + (1000 - now % 1000);
                    mHandler.postAtTime(mTicker, next);
                }
            };
        mTicker.run();
    }

    @Override
    protected void onDetachedFromWindow() {
        super.onDetachedFromWindow();
        mTickerStopped = true;
    }

    private void setFormat() {
            mFormat = m24;

    }

    private class FormatChangeObserver extends ContentObserver {
        public FormatChangeObserver() {
            super(new Handler());
        }

        @Override
        public void onChange(boolean selfChange) {
            setFormat();
        }
    }
} 
```

您可以使用此自定义视图。这也适用于姜饼。根据自己的喜好更改时间格式。(m24)

# ruby-on-rails - 带有vagrant和chef的windows中jruby rails的开发环境

> ID：11143573
> 
> 赞同：0
> 
> 时间：2012-06-21T17:31:44.900
> 
> 标签：ruby-on-rails, windows, chef-infra, vagrant

是否值得用 vagrant 设置厨师在 Windows 中开发 Rails 应用程序（对 jruby 感兴趣）然后将其部署到云中？我试图弄清楚如何为 Windows（Windows 7 64 位）设置一个好的开发环境，但我有点迷茫。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-27T20:10:43.703

Vagrant 是在本地机器上复制生产环境的好工具。它允许您配置一个或多个 VM 以在您的计算机上模拟负载平衡器、Web 服务器和生产数据存储系统。

有些人发现安装 Vagrant 作为开发环境也更简单。您将获得一个共享文件夹，允许您在主机操作系统上编写代码，然后立即“部署”到模拟生产环境并在您的机器上进行测试。然而，这不是 100% 必要的，一些开发人员不喜欢启动 VM 来开始编码。

我使用两者的组合。我在本地开发并在本地测试更改，然后我使用 Vagrant 启动虚拟机并在模拟环境中测试我的代码。

# mongodb - 如何在 RockMongo 或 mViewer 上的 mongodb 客户端中运行聚合查询

> ID：11143575
> 
> 赞同：5
> 
> 时间：2012-06-21T17:31:52.183
> 
> 标签：mongodb, database

我刚刚开始使用 mongo db，我正在使用 rockmongo 客户端和我的 ubuntu 终端作为另一个客户端。我已经实现了使用组聚合的查询，如下所示：

```
 db.archiveImpl.group(
 {
   key: {accountID: true, phone: true },
   cond: {'userId': "oiuoifas2309u"},
   reduce: function(object, prev){ },
   initial:{}

 } 
```

)

并且上面的查询没有在 中运行`rockmongo`，我最初认为查询是错误的。我跑进了终端，它把数据拉给我。所以我下载并安装`mViewer`了它也没有工作所以我相信有一种方法可以在 mongo Web 客户端中运行这些查询

感谢您阅读本文。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-09-11T08:14:08.687

您可以在rockmongo主页的“tools->command”面板中运行聚合查询。您可以像这样在输入面板中输入查询：

```
{ 
  aggregate : "ns",                                          
  pipeline : [
               ...
             ]                
} 
```

那会好的！我试过了，它有效！

完整示例：

```
{ aggregate : "COLLECTION_NAME",
  pipeline : [
    { $unwind : "$SUB_ARRAY" },
    { $match: {"SUB_ARRAY.field": "value"}},
  ]
} 
```

# iphone - 使用 Ad Hoc Profile 安装 iOS 应用程序时出错

> ID：11143576
> 
> 赞同：1
> 
> 时间：2012-06-21T17:31:55.570
> 
> 标签：iphone, objective-c, ios, xcode

我已经完成了一个又大又重的应用程序的开发。它是通用的（适用于 iPhone 和 iPad），现在我正在尝试在 App Store 中发布它。我其他时候也这样做过，所以我知道这有多烦人。

我正在使用 Xcode 4.2 和具有许多 iOS 版本（4.2.1、5.0、5.1）的设备。我的应用程序已启用发送推送通知，但它不使用 iCloud。

我已经使用开发证书对其进行了测试，并且可以正常工作。现在我已经生成并下载了 Ad Hoc Distribution Provisioning Profile，以便在我的 iPhone 和 iPad 上进行测试。看起来一切正常，但是当我要在任何设备中使用 Xcode 安装应用程序（使用 Ad Hoc Distribution Provisioning 配置文件）时，Xcode 显示错误：“启动远程程序时出错：无法获取进程任务”。

我已阅读[此](http://developer.apple.com/library/ios/#qa/qa1682/_index.html)链接，它提出了两个原因：

*   在我的设备中调试应用程序时，我正在使用 Ad Hoc Distribution Provisioning 配置文件。这不是问题，因为我没有调试应用程序。
*   我在我的构建设置中指定了一个代码签名权利属性列表，其中不包括“get-task-allow”或“Can be debugged”属性。这不是问题，因为我没有指定任何权利属性列表，因为我不需要它（或者我认为如此）。

一些有同样问题的人解决了将“get-task-allow”属性添加到权利属性列表中的问题。但是我没有那个文件。所以问题是，我需要创建它只是为了添加“get-task-allow”属性吗？

如果我不这样做，那是什么问题？我没有尝试调试，我的应用程序中没有权利 p-list。

虽然我的应用程序不需要权利 p-list，但我尝试创建它并在[此](http://developer.apple.com/library/ios/#qa/qa1710/_index.html)之后在 OFF 中添加“get-task-allow”属性，但这并没有解决问题。

我还要说，虽然 Xcode 在设备中安装过程中显示错误并且应用程序关闭，但当我再次启动应用程序时，安装完成并且应用程序运行没有问题。

我阅读了以下类似的帖子，但他们没有解决我的问题：

*   [iPhone 调试：如何解决“无法获取进程任务”？](https://stackoverflow.com/questions/1488600/iphone-debugging-how-to-resolve-failed-to-get-the-task-for-process)
*   [配置文件错误（启动远程程序时出错：无法获取进程 XXX 的任务。）](https://stackoverflow.com/questions/4720597/profile-bug-error-launching-remote-program-failed-to-get-the-task-for-process)
*   [iPhone调试错误启动远程程序：无法获取进程907的任务](https://stackoverflow.com/questions/2182249/iphone-debugging-error-launching-remote-program-failed-to-get-the-task-for-proc)
*   [启动远程程序时出错：无法获取进程 699 的任务](https://stackoverflow.com/questions/5959645/error-launching-remote-program-failed-to-get-the-task-for-process-699)

非常感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-21T18:00:40.750

> 在我的设备中调试应用程序时，我正在使用 Ad Hoc Distribution Provisioning 配置文件。这不是问题，因为我没有调试应用程序。

这正是问题所在。
您正在尝试从 XCode 运行临时应用程序 - 这意味着调试它。

您应该存档您的应用程序并安装它（一个 ipa 文件）以及正确的配置文件。

有几种安装应用程序的方法：

*   使用 iTunes - 不简单
*   使用 iPhone 配置实用程序 - 更轻松
*   使用一些 OTA（无线）安装服务（例如 TestFlight 站点） - 我一直使用它，几次之后它变得非常容易，您可以将您的 Beta 版本分发到远程设备（例如客户端、朋友等）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-21T18:09:10.890

问题看起来像您正在使用 Ad Hoc Distribution Provisioning profile 从 Xcode 运行 App。

从 Xcode 归档（产品菜单 > 归档）应用程序后，您可以获得 ipa。

1.  如果您的设备已经与您的 iTunes 应用程序同步，您可以通过 iTunes 安装 ipa。
2.  [https://testflightapp.com/](https://testflightapp.com/)，我正在使用 testflightapp 来测试应用程序。它易于使用，我们可以分发给测试用户。

# asp.net - 使会话与 FormsAuthentication 保持同步

> ID：11143581
> 
> 赞同：0
> 
> 时间：2012-06-21T17:32:14.477
> 
> 标签：asp.net, security, session, login, forms-authentication

当用户通过我的登录页面登录时，我使用 FormsAuthentication 对他们进行身份验证，并设置一些保存用户特定信息的会话，例如 UserID 和 RoleID。我根据这些值设置网站内容。

问题是当会话过期并且用户仍然登录时 - 事情搞砸了，因为会话为空但用户仍然登录。

如何使它们保持同步，以便会话仅在它们退出或退出时才会过期。

谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-21T17:33:58.500

当 global.asax 中的会话结束 (Session_OnEnd) 时，您可以终止表单身份验证 cookie。这样做会在任何后续请求时将用户重定向到默认页面（或登录页面，具体取决于您的设置方式）。当用户手动注销时，您还应该终止身份验证 cookie - 效果相同。

要终止身份验证 cookie：

```
FormsAuthentication.SignOut(); 
```

# delphi - 为什么我会收到“E2026 Constant expression expected”？

> ID：11143582
> 
> 赞同：6
> 
> 时间：2012-06-21T17:32:15.480
> 
> 标签：delphi, constants

我必须在 system32 文件夹中移动一个文件，我使用了以下代码：

```
//-----------FUNCTION----------------
function GetWindowsSystemDir(): String;
var
  vlBuff: Array[0..MAX_PATH-1] of Char;
begin
  getSystemDirectory(vlBuff, MAX_PATH);
  Result := vlBuff;
end;
//-----------------------------------

const
  SMyFile = GetWindowsSystemDir+'\intructions.txt'; //error here, line 87
var
  S: TStringList;
begin
  S := TStringList.Create;
  try
    S.Add('intructions');
    S.SaveToFile(SMyFile);
  finally
    S.Free;
  end;
end; 
```

编译时给我错误：

```
[DCC Error] Unit1.pas(87): E2026 Constant expression expected 
```

谢谢。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-06-21T17:34:31.340

正如编译器错误消息所示，它需要一个常量表达式，您正在初始化 const。但是你在那里调用一个函数，编译器不会在编译时评估它。

改为声明一个*变量*，并将其分配在代码的常规 begin-end 块中：

```
var
  SMyFile: string;
  S: TStringList;
begin
  S := TStringList.Create;
  try
    S.Add('intructions');
    SMyFile := GetWindowsSystemDir+'\intructions.txt';
    S.SaveToFile(SMyFile);
  finally
    S.Free;
  end;
end; 
```

# ruby-on-rails - 如何让 RubyMine 识别 Twitter-Bootstrap 变量？

> ID：11143591
> 
> 赞同：1
> 
> 时间：2012-06-21T17:33:08.477
> 
> 标签：ruby-on-rails, twitter-bootstrap, rubymine

理想情况下，我希望 intellij 与此合作，但只是让它们被认为是可接受的就是下一个最好的事情。例子：

```
$white
$grayLight 
```

等等

谢谢 ：）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-21T20:55:00.223

感谢 CrazyCoder 和 baptme 我发现

[http://youtrack.jetbrains.com/issue/WI-5342?query=with](http://youtrack.jetbrains.com/issue/WI-5342?query=with)

这给了我一些提示。

我发现必须手动包含每个 .scss 文件。

为了找到文件，我 ctrl 点击了“bootstrap”

```
@import "bootstrap" 
```

虽然 ctrl+shft+r 然后输入 _variables 可能也可以。

例如我的导入看起来像这样：

```
@import "C:/Ruby193/lib/ruby/gems/1.9.1/gems/bootstrap-sass-2.0.3.1/vendor/assets/stylesheets/bootstrap/_variables.scss"; 
```

TLDR：您需要导入您引用的每个 .scss 文件，因为 RubyMine 不会自动搜索所有目录文件。

# jquery - 为 json 解析设置 jQuery ajax 转换器

> ID：11143592
> 
> 赞同：0
> 
> 时间：2012-06-21T17:33:16.473
> 
> 标签：jquery, ajax, json, asp.net-mvc-3, converter

我正在尝试解析 JSON 响应以将 ASP.NET 日期转换为 javascript 日期。

实际响应如下所示：

```
{"Id":1,"Title":null,"Description":null,"Content":null,"PropagateModel":false,"Status":0,"ComponentPublishDate":"\/Date(1340299653555)\/"} 
```

我扩展了 javascript 字符串对象以将正则表达式转换`\/Date(1340299653555)\/`为`new Date(1340298914781)`

```
String.prototype.parseWithJSONDate = function () {
   return this.replace(/\/Date\((.*?)\)\//gi, 'new Date($1)');
}; 
```

然后我设置了一个~~转换器~~过滤器进行实际解析。

```
 $.ajaxSetup({
      dataFilter: function(data, dataType) {
        if (dataType === "json") {
          return data.parseWithJSONDate();
        }
        return data;
      }
    }); 
```

这个转换器不起作用。我遇到的第一个问题是转换器返回后响应会以某种方式损坏。我通过在函数结束时`JSON.parse`这样调用来解决这个问题。`return JSON.parse(res)`为什么我需要解析一个已经是 JSON 字符串的字符串？

第二个问题是实际的正则表达式似乎没有替换值。奇怪的是，我在函数之外的示例 JSON 字符串上对其进行了测试，它工作得很好。

任何人都可以提出任何建议吗？谢谢！

**更新 1** 我想我找到了第一个问题的答案。我的转换器针对 json 和 text 数据类型运行。这可能是我必须将返回值显式转换为 JSON 的原因。我从转换器中删除了文本数据类型，并相应地更新了其余代码。

**更新 2** 我最终创建了一个新的视图模型，其中日期是一个格式化的字符串。不是世界上最好的事情，但比搞砸 jQuery ajax 事件要好。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-21T17:45:18.043

尝试使用 a`dataFilter`代替：

```
$.ajaxSetup({
    dataFilter: function(data,dataType) {
        if (dataType === "json") {
            return data.parseWithJSONDate();
        }
        return data;
    }
}); 
```

这假定您的`parseWithJSONDate`方法返回一个有效的 json 字符串。然后，您只需将其`json`用作您的数据类型。

dataFilter 方法的目的是清理原始响应文本，我认为这非常适合这种情况。只要您返回有效的 json，jquery 就会对其进行解析并将其转换为正常的 javascript 对象。

编辑：现在我考虑它可能会失败，`new Date()`因为那不是有效的json。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-12T03:40:26.943

我最终在服务器上将所有日期转换为适当的格式并将值返回给客户端。不是最佳解决方案，但我无法弄清楚如何使用数据过滤器进行转换。

# regex - 使用 Regex.Replace 增加正则表达式匹配

> ID：11143594
> 
> 赞同：0
> 
> 时间：2012-06-21T17:33:20.933
> 
> 标签：regex, vb.net, vb.net-2010

我正在 VB.NET 中创建一个程序来输出多个图像。某些图像将具有相同的文件名。如果有多个同名文件，我想在文件名末尾添加“_1_”。如果“_1_”文件已经存在，我想将 1 增加到“_2_”。如果这个文件已经存在，我想继续增加数字直到它不存在。例如“文件名”、“文件名_1_”、“文件名_2_”等。这是我尝试过的代码

```
Dim usedFiles As New List(Of String)
While usedFiles.Contains(returnValue)
    If Regex.IsMatch(returnValue, "[_]([0-9]{1,})[_]$") Then
        returnValue = Regex.Replace(returnValue, "[_]([0-9]{1,})[_]$", "_" + (CType("$1", Integer) + 1).ToString() + "_")
    Else
        returnValue += "_1_"
    End If
End While
usedFiles.Add(returnValue) 
```

不工作的行是：

```
returnValue = Regex.Replace(returnValue, "[_]([0-9]{1,})[_]$", "_" + (CType("$1", Integer) + 1).ToString() + "_") 
```

每次输出“filename_2_”。我也试过：

```
returnValue = Regex.Replace(returnValue, "[_]([0-9]{1,})[_]$", "_($1+1)_") 
```

但是这会返回“filename_($1+1)_”。我知道我可以删除“_”，然后在数字上加 1，然后将“_”放回两边，但我也知道这可以使用正则表达式在其他语言（如 php）中完成。

有任何想法吗？

谢谢！

瑞安

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-21T18:08:01.947

我没有花时间弄清楚您的 RegEx 表达式有什么问题，因为它对我来说似乎很愚蠢。你想多了。您需要做的就是这样简单的事情：

```
Dim fileName As String = returnValue
Dim i As Integer = 0
While usedFiles.Contains(returnValue)
    i = i + 1
    returnValue = fileName + "_" + i.ToString() + "_"
End While 
```

# c - 在不同的文件中拆分进程

> ID：11143596
> 
> 赞同：1
> 
> 时间：2012-06-21T17:33:26.147
> 
> 标签：c, ipc, multiprocessing, pipe, header-files

所以我做了一个程序，它使用四个不同的进程来做一些事情。我工作得很好，但现在我想把它分开，这样每个进程都有自己的 .c 文件。我尝试使用具有所有进程的函数原型的头文件“processes.h”来做到这一点。它看起来像这样：

```
#ifndef PROCESSES_H_
#define PROCESSES_H_

/*------------------------------------------------------------------------------
                definitions (defines, typedefs, ...)
------------------------------------------------------------------------------*/
#define NR_OF_PROCESSES 4

enum errCode {
    ERR_NONE = 0, ERR_SYNTAX, ERR_OPEN, ERR_TOKEN, ERR_ARG, ERR_END
};
typedef enum errCode ErrCode;

enum toktype {
    NUMBER = 0, OPERATOR, ENDOFLINE, ENDOFFILE
};
typedef enum toktype Token;

/*------------------------------------------------------------------------------
                function prototypes               
------------------------------------------------------------------------------*/
void readProcess(int pfds[5][2]);
void tokenProcess(int pfds[5][2]);
void calculatorProcess(int pfds[5][2]);
void errorProcess(int pfds[5][2]);

/*------------------------------------------------------------------------------
                global variable declarations                   
------------------------------------------------------------------------------*/
void (*functionTable[NR_OF_PROCESSES]) (int pfds[5][2]) = {
    readProcess,
    tokenProcess,
    calculatorProcess,
    errorProcess
};

#endif /*PROCESSES_H_*/ 
```

所有包含函数#include "processes.h" 实现的.c 文件和主函数（使用functionTable 设置进程）也包括processes.h。

当我尝试编译时出现错误：

```
ld: duplicate symbol _functionTable in /var/folders/eH/eHF8LmdvHzSsNgT01V3jyk+++TI/-Tmp-//ccDgTW2X.o and /var/folders/eH/eHF8LmdvHzSsNgT01V3jyk+++TI/-Tmp-//ccp7zO9L.o
collect2: ld returned 1 exit status 
```

这是拆分成不同文件的正确方法吗？还是每个 .c 文件都需要一个单独的 .h 文件？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-21T17:56:02.487

一种方法是把

```
#ifdef GENERATE_DEFINITIONS
#define EXTERN
#define INITIALIZE(x) = x
#else
#define EXTERN extern
#define INITIALIZE(x)
#endif

EXTERN void (*functionTable[NR_OF_PROCESSES]) (int pfds[5][2])
  INITIALIZE({
    readProcess,
    tokenProcess,
    calculatorProcess,
    errorProcess
  }); 
```

在 processes.h 中，然后放入

```
#define GENERATE_DEFINITIONS 
```

之前

```
#include "processes.h" 
```

仅在其中一个源文件中（例如，包含 main() 的源文件）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-21T17:39:36.623

把它放在你的 .h 中：

```
extern void *functionTable; 
```

然后把它放在一个文件中，例如带有“main()”的源文件：

```
#include "processes.h"
...
void (*functionTable[NR_OF_PROCESSES]) (int pfds[5][2]) = {
    readProcess,
    tokenProcess,
    calculatorProcess,
    errorProcess
}; 
```

# javascript - Javascript - 处理加载后生成内容的最佳方式

> ID：11143597
> 
> 赞同：0
> 
> 时间：2012-06-21T17:33:27.117
> 
> 标签：javascript

我一直想知道如何有效且通用地处理任何用户操作后生成的内容。

例如，假设我的脚本在页面加载时处理 Facebook 的所有段落，以使它们闪烁。使稍后显示的文本（例如由于无限滚动）闪烁的最响应方式是什么？

提前感谢您的想法，

罗尔夫

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-21T17:56:56.283

您可以将 blink 函数添加到包含所有子对象的父对象。

换句话说，如果您使用 jquery，您将在注册子闪烁事件时将事件选择器指定为 (".parent .child")。这样，您不需要注册任何额外的 jquery "dom_mods" 函数或调用任何其他浪费内存和时间的东西。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-21T17:41:12.210

就个人而言，我定义了一个名为`dom_mods()`修改页面的函数，以应用任何特殊效果，例如自动完成、默认值`<select>`、自动调整文本区域大小等。每当我向文档添加内容时，我都会调用`dom_mods()`.

唯一的问题是确保你不会两次影响相同的元素，或者如果你这样做了，它不需要有所作为。例如，可能有一个类定义了一组要影响的元素，因此应该删除该类，`dom_mods()`这样它就不会得到两次处理。

# c# - 使用 LINQ 存储库时使用 Func T、bool 的可能方法

> ID：11143602
> 
> 赞同：0
> 
> 时间：2012-06-21T17:33:49.070
> 
> 标签：c#, .net, linq, linq-to-sql, repository-pattern

我发现了许多使用 LINQ to SQL 的通用存储库示例。然而，关于如何调用这些函数的例子并不多。您能否举例说明客户如何使用以下功能？

注意：我的问题是关于**Func T,bool**的使用。有哪些**可能**的使用方法？

注意：BankAccount 是一个实体。

```
class MyRepository<T> : IRepository<T> where T : class
{
    ..........

    public IEnumerable<T> FindAll(Func<T,bool> predicate)
    {
        return Context.GetTable<T>().Where(predicate);
    }

    public T FindByID(Func<T,bool> predicate)
    {
        return Context.GetTable<T>().SingleOrDefault(predicate);
    }
} 
```

**编辑**

根据响应，我使用它如下；

```
 public RepositoryLayer.Account FindFirstAccount()
    {
        Func<RepositoryLayer.Account, bool> predicate = (p => p.AccountNumber == 1);
        List<RepositoryLayer.Account> accList =  (accountRepository.FindAll(predicate)).ToList();
        return accList[0];
    } 
```

注意：列出 RepositoryLayer.Account accList = (List RepositoryLayer.Account) accountRepository.FindAll(predicate); 不管用

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-21T17:37:38.000

例如：

```
var repository = new MyRepository<Person>();
var personsOlderThan50 = repository.FindAll(p=>p.Age > 50); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-21T17:43:59.237

Func T, bool 是一个接受泛型参数 T 并返回 bool 的委托。在您的情况下，您将使用存储库，例如

```
var repository = new MyRepository<BankAccount>;
var account = repository.FindByID(a=>a.AccountId == 10); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-21T17:42:07.220

有几种方法可以指定 Func，它本质上是一个`delegate`接受一个参数并返回一个布尔值的方法。

大多数情况下最方便的方法是将其指定为 Lambda 表达式，例如：

```
var repo = new Repository<BankAccount>();
repo.FindById(account=>account.Id == 15); 
```

指定 Func 的其他方法最好[在此处](http://msdn.microsoft.com/en-us/library/bb549151.aspx)进行描述。

编辑：要修复您的最新错误，您需要将结果作为列表。删除您的显式演员并尝试：

```
accountRepository.FindAll(predicate).ToList(); 
```

# javascript - 将JS代码的值赋给DIV

> ID：11143603
> 
> 赞同：0
> 
> 时间：2012-06-21T17:33:51.673
> 
> 标签：javascript

我试图让 JS 代码中的变量显示在表格的 DIV 中。为了简单起见，我已经将代码缩减了，只是为了让它正常工作。

Firebug 报告：

```
document.getElementById("valuelabel") is null 
```

这是代码：

```
<table>
  <tbody>
    <tr>
      <td>
        Value:
      </td>
      <td>
        <div id="valuelabel"></div>
      </td>
    </tr>
  </tbody>
</table>

<script language="javascript" type="text/javascript">
  var mktValue = "12000";
  document.getElementById("valuelabel").value = mktValue;
</script> 
```

mktValue 将是一个动态分配的数值；来自另一个表单的文本框条目。我只是为了测试目的而输入“12000”。

在 Firebug 中，它显示了以下动态分配的值。

```
var mktValue = '120700'; 
```

谢谢..

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-21T17:35:11.470

Div 没有“价值”，但它们确实有“innerHTML”

```
document.getElementById("valuelabel").innerHTML = mktValue; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-11-19T18:07:16.887

`div`元素没有`value`（只有表单域有）。您可以`div`通过`textContent`（仅文本）或通过`innerHTML`（HTML）设置 的内容：

```
document.getElementById("target1").textContent = "This is normal text, <and> aren't special here.";
document.getElementById("target2").innerHTML = "This is HTML text, so <strong>tags</strong> are rendered as elements.";
```

```
<div id="target1"></div>
<div id="target2"></div>
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-06-21T17:40:50.220

您可以使用 jquery 通过使用将值插入特定 id

`$("#valuelabel").html(mktValue)`

# asp.net-mvc - MVC3 一个视图 - 多个 PartialViews - 每个 PartialView 一个模型

> ID：11143604
> 
> 赞同：0
> 
> 时间：2012-06-21T17:33:56.683
> 
> 标签：asp.net-mvc, asp.net-mvc-3, razor

我是整个 MVC 3 风格编码的新手。我遇到了一个问题，但首先这是我的网站布局方式。

_Layout.cshtml 包含

```
 @if (Request.IsAuthenticated)
        {
            <div class="span2">
                @Html.Partial("_NavigationPartial")
            </div>
            <div class="span10">
                @RenderBody()
            </div>
        }
        else
        { 
            @RenderBody()
        } 
```

`@RenderBody`将显示我的 Profile.cshtml 文件，其中包含以下内容：

```
@{
    ViewBag.Title = "My Profile";
}
<div class="row-fluid well">
    <div class="page-header">
        <h1>
            Profile</h1>
    </div>
    @{ 
        Html.RenderPartial("ChangePersonalInformationPartial");
        Html.RenderPartial("ChangePasswordPartial");
        }
</div> 
```

如您所见，我有两个部分（一个用于更改个人信息，另一个用于更改密码）。

这些 Partials 中的每一个都使用它自己的 Model (`ChangePersonalInformationModel`和`ChangePasswordModel`)。

当我点击提交时，我的问题出现了`ChangePasswordPartial`，它重新加载了 _Layout.cshtml 页面，但这次只加载了`ChangePasswordPartial.cshtml`。我需要它来加载 Profile.cshtml。但是，如果我继续在我`AccountController.cs`的`return View();`to下进行更改，`return View("Profile");`我会收到一条错误消息：

> 传入字典的模型项的类型为“PROJECT.Models.ChangePasswordModel”，但该字典需要“PROJECT.Models.ChangePersonalInformationModel”类型的模型项。

我该如何解决这个问题？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-21T17:42:31.487

基本上，您必须在`ChangePassword`保存密码信息后重定向到操作中的配置文件操作。

**更新：**

首先，您应该有一个通用模型说`ProfileModel`包含`ChangePasswordModel`and `ChangePersonalInformationModel`。

因此，这里是显示用于查看和编辑的配置文件信息的操作。

```
// this action will returns a views that displays profile info
public ViewResult Profile(string username)
{
  ProfileModel model = .. get the profile from database based on username

  return View(model);
}

// this action will returns the profile info for editing or adding a new profile
public ViewResult EditProfile(string username)
{
   .. if the profile already exists get from database
   ProfileModel model = 

   .. if this is a new profile create an empty model
   ProfileModel model = new ProfileModel();
   model.ChangePasswordModel = new ChangePasswordModel();
   model.ChangePersonalInformationModel = new ChangePersonalInformationModel();

   return View(model);
} 
```

你的`EditProfile.cshtml`会是这样的

```
@model Models.ProfileModel

...
@{ 
   Html.RenderPartial("ChangePersonalInformationPartial", 
                                  Model.ChangePersonalInformationModel);
   Html.RenderPartial("ChangePasswordPartial", Model.ChangePasswordModel);
}
... 
```

这将是你的`ChangePassword`行动

```
[HttpPost]
public ActionResult ChangePassword(ChangePasswordModel model)
{
  if(ModelState.IsValid)
  {
     // save the ChangePasswordModel to database and display the profile info
     // or even you can redirect to EditProfile for more editing
     return RedirectToAction("Profile"); 
  }      

   .. there are validation errors so get the complete profile model from database
   .. the ChangePasswordModel form will be filled by the details entered in the form
   .. and not from the db details this will be taken care by the framework itself.
   ProfileModel model = 
   return View("EditProfile", model);     
} 
```

# string - 如何在 java 中将 String[] 解析为 int[]？

> ID：11143608
> 
> 赞同：2
> 
> 时间：2012-06-21T17:34:04.883
> 
> 标签：string, casting, int

我有代码：

```
String s = "a,b,c,d,e";
int[] i = s.split(","); 
```

但是这个演员表不可用。

有人可以帮助我吗？谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-21T17:34:52.230

您必须遍历数组中的每个元素并一个一个地转换它们。

像这样：

```
String s = "a,b,c,d,e";
String[] strings = s.split(",");
int[] i = new int[strings.length];
for(int j = 0; j < strings.length; j++)
{
    i[j] = Integer.parseInt(strings[j]);            
} 
```

请注意，此代码将崩溃，因为字符串数组中的元素不是整数。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-21T17:45:33.197

Java 是[强类型的](http://en.wikipedia.org/wiki/Strong_typing)，这意味着它不允许您在不兼容的类型之间进行转换。为了在整数和字符串之间进行转换，您需要显式地进行转换。 `Integer.parseInt`可以将字符串转换为整数。因此，您需要遍历数组并将每个整数分别转换为字符串。

```
String[] strings = "a,b,c,d,e".split(",");
int parsedIntegers[] = new int[strings.length];
for (int i = 0; i < strings.length; i++) {
    parsedIntegers[i] = Integer.parseInt(strings[i]);
} 
```

# javascript - 内部函数的 Javascript 范围问题

> ID：11143609
> 
> 赞同：0
> 
> 时间：2012-06-21T17:34:17.503
> 
> 标签：javascript, firefox

很确定这已经被问过了，但我不知道要搜索什么。反正，

```
var livemarks = [];

var livemarkIds = PlacesUtils.annotations.getItemsWithAnnotation("livemark/feedURI", {});

for (var i = 0; i < livemarkIds.length; i++){

    PlacesUtils.livemarks.getLivemark( {id : livemarkIds[i]}, function(result, livemark){

        if (result == Components.results.NS_OK){
            livemarks.push(livemark);
        }

    });

}

alert(livemarks.length); 
```

我正在尝试使用不再由其创建者维护的 Firefox 插件，只是为了学习一点。我最近收到一条错误消息，说 getFeedURI 将被弃用，我想更改他的旧功能。

**编辑：**

**从函数（内部函数）中定义的函数，我无法访问父级中定义的 var。为什么？例如，我无法从 getLivemark() 或其他类似的内部函数中访问 var livemarks。**

我正在检查（完全向下滚动）：[这](https://github.com/cfinke/RSS-Ticker/blob/master/rss-ticker/chrome/content/ticker.object.js)和他的代码工作正常。那么我的代码有什么问题？如果可能的话，我只是想避免递归。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-21T17:37:25.230

我怀疑该`PlacesUtils.livemarks.getLivemark`函数以*异步*方式完成其工作，因此*在*您提醒`length`. 将警报*放入*回调中，您应该会看到正确的长度（最终）。这是一种方法：

```
var expecting = livemarkIds.length;
for (var i = 0; i < livemarkIds.length; i++){

    PlacesUtils.livemarks.getLivemark( {id : livemarkIds[i]}, function(result, livemark){

        if (result == Components.results.NS_OK){
            livemarks.push(livemark);

            // ***New stuff***
            if (livemarks.length === expecting) {
                // Now you have them all, now you can do the next thing
                doSomethingWithTheLiveMarks(livemarks);
            }
        }

    });
} 
```

请注意，我放在那里`livemarkIds.length`，`expecting`以防您`livemarkIds`在函数运行时执行其他操作。如果你不是，你可以直接使用它。

* * *

在下面回复您的评论：

> 然而，系统的工作原理是这样的：我在一个数组中获得了 livemarks。这段代码实际上是在一个类（和方法）中，所以另一个类初始化这个并调用函数 getFeeds()，它将返回那个 livemarks 数组。

如果`PlacesUtils.livemarks.getLivemark`是异步的，则*不可能*`getFeeds`将数组作为*返回值返回*。例如，它*不能*像这样使用：

```
a = b;
c = 42;
feeds = getFeeds(feedIds);
if (feeds.length === 0) {
    // Do something
}
else {
    // Do something else
} 
```

好消息是它真的很容易修复：`getFeeds`接受一个回调函数，当它有提要时调用它。上面的代码更改为如下所示：

```
a = b;
c = 42;
feeds = getFeeds(feedIds, function(feeds) {
    if (feeds.length === 0) {
        // Do something
    }
    else {
        // Do something else
    }
}); 
```

如您所见，这是一个非常简单的更改。假设上面的循环是*所有*的`getFeeds`，那么`getFeeds`最终看起来像这样：

```
function getFeeds(livemarkIds, callback) {

    var livemarks = [];
    for (var i = 0; i < livemarkIds.length; i++){

        PlacesUtils.livemarks.getLivemark( {id : livemarkIds[i]}, function(result, livemark){

            if (result == Components.results.NS_OK){
                livemarks.push(livemark);

                if (livemarks.length === livemarkIds.length) {
                    // Done, trigger the callback
                    callback(livemarks);
                }
            }

        });
    }
} 
```

并且模式继续：如果代码调用`getFeeds`被其他期望异步返回值的东西调用，而不是返回该值，您让*该*代码接受回调，并从回调中调用`getFeeds`回调。等等。

一旦你习惯了它，这很容易做到。习惯它可能会很棘手。:-)

# c# - 用于比较两个数据集的图表

> ID：11143610
> 
> 赞同：0
> 
> 时间：2012-06-21T17:34:27.673
> 
> 标签：c#

我有两个数据集，每个数据集都包含图像的像素值。我需要验证两个数据集的差异是线性的还是类似的。

哪些开放库可用于绘制图形以使用 C# 比较两个数据集？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-21T17:42:24.693

我一直在 codeplex 上使用这个 Compare .NET Objects。

[http://comparenetobjects.codeplex.com/](http://comparenetobjects.codeplex.com/)

当我需要断言两个复杂对象的相等性时，我更多地使用它进行测试。

# sql-server-2008 - 无法将 2008 R2 数据库附加到 2008 实例

> ID：11143612
> 
> 赞同：0
> 
> 时间：2012-06-21T17:34:28.413
> 
> 标签：sql-server-2008, sql-server-2008-r2

所以我制作了一个设置文件并将其安装到没有 .Net 4.0 或 SQL Server 2008 的目标计算机上。

我将它们添加为先决条件，并从 Internet 下载 .Net 4.0 和 SQL Server 2008。安装成功完成。

当我运行程序时，它给出了一个异常：

> 无法打开 xxxxxx.mdf 文件。它是 650 版。而你的是 xxx ......

查了一下，发现目标计算机上安装的SQL Server比我创建的数据库文件要低（数据库文件是在SQL Server 2008 R2中创建的）。

因此，无法打开任何连接。

为了解决这个问题，我该怎么办？

谢谢...

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-21T17:38:15.537

您不能将 2008 R2 数据库附加到 2008 实例 - 您只能前进，而不能后退。因此，要么在目的地安装 2008 R2，要么必须在 2008 年重新创建数据库。如果将 2008 与 2008 R2 一起在本地安装，则可以在 2008 年创建一个空数据库并使用[Red-Gate 的 SQL 比较 / SQL Data Compare或](http://www.red-gate.com/products/sql-development/)[SQL Server Data Tools](http://msdn.microsoft.com/en-us/data/tools.aspx)中的模式比较功能，可以相对快速地转换您的数据库。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-21T17:39:45.583

无法使用较低版本的 SQLServer 打开 MDF 文件。
当然，您可以添加 SQLServer 2008 R2（快速或完整）作为先决条件。
但最好的方法是分发包含模式和数据的 SQL 脚本。

这可以使用 SqlServer Management Studio 来完成，

*   右键单击数据库
*   选择任务
*   选择生成脚本。
*   跟随向导。

在向导的最后一页中，您可以找到按钮`Advanced`
单击它将使您完全控制在脚本中放置的内容。
该脚本可以与您的应用程序一起分发，其中包含有关如何在目标机器上执行的说明。

# python - 在python中的Set中插入一个变量

> ID：11143614
> 
> 赞同：-1
> 
> 时间：2012-06-21T17:34:35.967
> 
> 标签：python, list, insert, set, add

我在 Python 集中插入变量时遇到问题。有谁知道我得到了什么： **s.insert(len(s),x)**？

我的问题是当我想将 x**插入**或**添加**到集合或列表中时。

为什么我做不到？以及如何解决这个问题？

我的代码：

```
import nltk
import Set

FILE=open("out.txt", "w")
FILE.writelines("this is to show why using NNs :)!!!!\n")

text1=raw_input()
FILE.writelines("first text loaded.....\n")
sentences1=text1.split('.')
FILE.writelines("first text splited.....\n")

text2=raw_input()
FILE.writelines("second text loaded.....\n")
sentences2=text2.split('.')
FILE.writelines("second text splited.....\n")

s=['a','b']
FILE.writelines("\n NNs for first:\n")
for sen in sentences1:
    tokens1= nltk.word_tokenize(sen)
    tagged1 = nltk.pos_tag(tokens1)
    for (x, y) in tagged1:
        if y=='NN':
            FILE.writelines(x+",")
            s.insert(len(s),x)
FILE.writelines(len(s1))

FILE.writelines("\n NNs for second:\n")
for sen in sentences2:
    tokens2= nltk.word_tokenize(sen)
    tagged2 = nltk.pos_tag(tokens2)
    for (x, y) in tagged2:
        if y=='NN':
            FILE.writelines(x+",")
            s2[len(s2)]= x
FILE.writelines(len(s2))

print "********temoum**********"
FILE.close() 
```

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-06-21T17:38:05.247

何时`s`是列表，您可以执行以下操作：

```
s.insert(len(s),x) 
```

这意味着：“将元素`x`插入列表`s`的位置`len(s)`”，这意味着您将元素插入到列表的末尾。

什么时候`s`是一个集合，你可以这样做：

```
s.add(x) 
```

集合没有顺序，因此您无需指定位置。一个集合也不包含重复项，如果您需要它会很有用。如果没有，您可以改用列表。

* * *

意外的 IndentationError 可以在这里找到：

```
if y=='NN':
    FILE.writelines(x+",")
        s.insert(len(s),x) 
```

这应该是这样的：

```
if y=='NN':
    FILE.writelines(x+",")
    s.insert(len(s),x) 
```

# mercurial - 创建 Mercurial 子存 储库，同时维护历史记录

> ID：11143615
> 
> 赞同：1
> 
> 时间：2012-06-21T17:34:37.893
> 
> 标签：mercurial, subrepos

我即将对我的 Mercurial 存储库进行一些重大更改。由于我将使用[最后手段的功能](http://mercurial.selenic.com/wiki/FeaturesOfLastResort)，我正在寻找一些建议和保证，我不会做愚蠢的事情。

# 我在哪里：

我有一个 Mercurial 存储库，其中包含所有这些文件的完整历史记录：

```
/source
    /secret_subsystem
    /unclassified_subsystem
    /common_files 
```

源是 Mercurial 存储库。秘密子系统文件夹包含我们想要保留在内部的知识产权代码。未分类的子系统文件夹包含我们想要外包给第三方维护的代码。公共文件夹包含两个子系统所依赖的代码。我们将保留所有权，但我们希望与第三方共享。

显然，我不能将我的整个存储库推送给第三方公司。第三方会看到太多。

# 我想去的地方：

[在](http://mercurial.selenic.com/wiki/ConvertExtension) [阅读](http://mercurial.aragost.com/kick-start/en/subrepositories/) [了](https://stackoverflow.com/questions/4602452/how-to-convert-an-existing-mercurial-repository-to-use-subrepositories-and-keep) [subrepositories](http://www.selenic.com/mercurial/hg.1.html#graft) 之后，我认为我需[要这样做：](http://mercurial.selenic.com/wiki/Subrepository)

有三个子存储库：secret_subsystem、unclassified_subsystem、common_files。[由于此建议](http://mercurial.selenic.com/wiki/Subrepository#Use_a_thin_shell_repository_to_manage_your_subrepositories)，请确保 /source 级别没有其他文件。

让外包商在其机器上的源代码级别创建一个全新的存储库，以及两个相应的子存储库。

将 unclassified_subsystem 和 common_files 推送到外包商，根据需要拉回 unclassified_subsystem，根据需要推送新的 common_files 存储库。

# 维护历史：

我想尽可能多地维护所有子系统的提交历史。

为此，我将运行[hg convert](http://mercurial.selenic.com/wiki/ConvertExtension)扩展命令 3 次，每个子存储库运行一次。我将过滤到仅属于每个子存储库的文件。我可能还需要映射文件名以将文件从 ./common_files/foo.py 移动到 ./foo.py （例如）。

# 我的问题：

1）将存储库划分为子存储库是实现安全性的合理方式 - 即。第三方只能查看和编辑我们的一些文件？

2) 是否使用`hg convert`合理的方式从现有存储库创建子存储库，同时仍保留历史记录？

3)`hg convert`的过滤器会去掉 (a) 所有关于不在过滤存储库中的文件的提交消息吗？它会过滤掉不在过滤存储库中的文件的所有差异吗？

还有另一个隐含的问题：我是否正在进入一个受伤的世界？如果是这样，我将简单地放弃保留文件历史记录，甚至将它们设为单独的存储库并忘记跨存储库提交。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-22T08:57:01.267

到目前为止我还没有使用过 subrepos，但我可以回答 2) 和 3)：

2）是的，听起来很合理。

3) 是的。

2天前有一个类似的问题：[Convert mercurial repository to subrepositories with full history (like hg log -f)](https://stackoverflow.com/questions/11105567/convert-mercurial-repository-to-subrepositories-with-full-history-like-hg-log)

# python - 在pylab的graph下添加图描述

> ID：11143619
> 
> 赞同：6
> 
> 时间：2012-06-21T17:34:47.783
> 
> 标签：python, matplotlib

> **可能重复：**
> [有没有办法在 matplotlib 中绘制标题框](https://stackoverflow.com/questions/5777576/is-there-a-way-of-drawing-a-caption-box-in-matplotlib)

是否可以在pylab的图形下添加图形描述？

假设我绘制了以下图表：

```
import pylab

x = [1,2,3,2,4,5,6,4,7,8]

pylab.plot(x)
pylab.title('My Plot')
pylab.xlabel('My x values')
pylab.ylabel('My y values')

pylab.show() 
```

我还想插入几行描述图表，可能是这样的（不是真正的代码）：

```
pylab.description('Figure 1.1 is designed for me to learn basics of Pylab') 
```

那可能吗？

另外，我对`pylab`和之间的区别含糊不清`matplotlib`，所以如果有一个在使用时有效的解决方案`matplotlib`，它可能会起作用。

先感谢您

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-06-21T20:03:35.280

[`figtext`](http://matplotlib.sourceforge.net/api/pyplot_api.html#matplotlib.pyplot.figtext)对此很有用，因为它在图形坐标中添加文本，即 x 和 y 的 0 到 1，而与轴无关。这是一个例子：

```
from pylab import *

figure()
gca().set_position((.1, .3, .8, .6)) # to make a bit of room for extra text
plot([1,2], [3,4])
figtext(.95, .9, "This is text on the side of the figure", rotation='vertical')
figtext(.02, .02, "This is text on the bottom of the figure.\nHere I've made extra room for adding more text.\n" + ("blah "*16+"\n")*3)
xlabel("an interesting axis label")    
show() 
```

![在此处输入图像描述](../Images/b329c2da535adf95f214c4784f88ed74.png)

在这里，我曾经`axes.set_position()`通过使轴更小一些来在图的底部腾出一些额外的空间。在这里，我为大量文本添加了空间，因此文本不会碰到轴标签，尽管它可能有点过分。

虽然你要求底部有文字，但我通常把这样的标签放在一边，所以它们是更清楚的注释，而不是图形的一部分。（我发现它很有用，例如，有一个小函数可以自动将生成每个图形的文件的名称放到图形上。）

# jquery - 用于复选框的动态标签的 Jquery 选择器

> ID：11143631
> 
> 赞同：0
> 
> 时间：2012-06-21T17:35:16.277
> 
> 标签：jquery, css, toggleclass

[与此](https://stackoverflow.com/questions/1186416/jquery-selector-for-the-label-of-a-checkbox)非常相似，但是，在我的情况下，标签的值可以更改。我正在尝试在单击时更改字体。这是我迄今为止所拥有的：

```
 // Job Type Button
    $('fieldset.workexperience input').on('change', function() {
        if ($(this).hasClass('jobtype') && ($(this).attr("name")!="")) {
            $('.'+$(this).attr("name")).toggle("slow");
            //Change color to white to show hidden
                $('label[for=$(this)]').toggleClass("hidden");

                $(this).toggleClass("hidden");

                var $this = $(this).attr("label");
                $('label[$this]').toggleClass("hidden");
        } else {

        }
    }); 
```

尝试了三种，第一次通过它的标签访问，第二次直接访问（但是$(this)是复选框，不是标签），第二次是尝试获取标签的值，然后将其作为参数传入。

任何帮助将不胜感激。

顺便说一句：CSS是：

```
 .hidden {
    color: white;
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-21T17:36:31.033

```
$('label[for=$(this)]').toggleClass("hidden"); 
```

应该

```
$('label[for="'+ $(this).attr('id') +'"]').toggleClass("hidden"); 
```

例如：

```
<label for="somecheckbox">Checkbox</label>
<input type="checkbox" id="somecheckbox"> 
```

所以`$(this).attr('id')`会得到`id`，它等于`label`'`for`属性。

# tree - 查询复杂度为 O(log n) 的数据结构

> ID：11143632
> 
> 赞同：0
> 
> 时间：2012-06-21T17:35:16.497
> 
> 标签：tree, time-complexity

给定客户数据库，找到具有特定 DOB 的所有客户。您将使用哪种数据结构。O(logn) 映射>m; 查找给定 DOB 之间的所有客户。纯 O(logn)

我想我应该使用段树来解决同样的问题......在创建段树之后......我应该如何用O（logn）找到特定的DOB......我最多可以得到最低的DOB 的值在该复杂度范围内与段树 ...

解决办法是什么 ？还有其他一些我可以使用的数据结构吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-25T12:08:50.343

一旦你在给定范围内获得最小 DOB，使用该 DOB 作为范围内的最小 DOB 并再次调用你的函数重复此操作，直到你获得该范围内的所有日期.. :)

# c++ - 使用 boost.python 返回内部引用的间歇性错误

> ID：11143634
> 
> 赞同：2
> 
> 时间：2012-06-21T17:35:19.123
> 
> 标签：c++, boost, c++11, boost-python

我有以下课程：

```
#include <array>

template<unsigned short D>
class Point {
private:
    std::array<float, D> coordinates;
public:
    Point() { for(int i=D-1; i>=0; --i) coordinates[i] = 0.0; }
    Point(const Point& rhs) = default;
    Point& operator=(const Point& rhs) = default;
    ~Point() = default;

    float& get_ref(const unsigned short dimension)
        { return coordinates[dimension-1]; }
}; 
```

我试图用以下方式包装它：

```
#include <boost/python.hpp>

BOOST_PYTHON_MODULE(fernpy) {
    using namespace boost::python;

    class_< Point<2> >("point")
        .def("__call__", &Point<2>::get_ref, return_internal_reference<>());
} 
```

我在 Fedora 17 上使用 gcc-4.7 编译 boost 1.48、python-2.7。所有代码都是一个名为 testpy.cpp 的文件。我正在使用这些命令进行编译：

```
g++ -std=c++11 -g -fPIC -I/usr/include/python2.7 -c testpy.cpp
g++ -shared -g -lpython2.7 -lboost_python -o libfern.so testpy.o 
```

编译器返回一堆 boost 内部错误，太多了，无法在此处发布。这段摘录似乎是它的核心。在它之前有一堆“required from”，在它之后有“note”。

```
/usr/include/boost/python/object/make_instance.hpp:27:9: error: no matching function for call to ‘assertion_failed(mpl_::failed************ boost::mpl::or_<boost::is_class<float>, boost::is_union<float>, mpl_::bool_<false>, mpl_::bool_<false>, mpl_::bool_<false> >::************)’ 
```

如果我从 get_ref 返回一个普通的浮点数并从包装器的 .def 行中删除 return_internal_reference<>() 参数，它工作得很好。这很奇怪，因为我正在用另一个更复杂的类模板做同样的事情，而且它在那里也能正常工作。我已经在谷歌上搜索了将近一整天的时间。有人知道到底发生了什么吗？

**更新：**

我最终使用了 python 中的“getitem”和“setitem”特殊方法，比如[这个链接](http://wiki.python.org/moin/boost.python/StlContainers)。该链接显示了如何使用访问函数的静态包装器定义漂亮的结构模板，因此您不必弄乱原始 C++ 类的接口。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-21T18:45:10.037

从 python 的角度来看，`floats`是不可变类型。因此，python 不允许更改值。

例如，在python中会发生以下情况：

```
coordinates = [ 5, 10, 15 ]
x = cooardinates[ 2 ] # Bind x to refer to the int(15) object.
x = 5                 # Rebind x to refer to the int(5) object. 
                      # Does not modify coordinates. 
```

现在，考虑以下几点：

```
from fernpy import point
p = point()
x = p(2) # Bind x to refer to the float(p(2)) object.
x = 5    # Rebind x to refer to the int(5) object.
         # Does not set p.coordinates[2] to 5. 
```

因此，`boost::python`防止返回对在 python 中不可变的类型的引用，因为 Python 不支持它。 `x`不存储值`5`；相反，它包含对该`5`对象的引用。如果分配给`x`没有重新绑定`x`，那么无意义的陈述，例如`6 = 5`是可能的。

编译错误是一个静态检查，仅限`return_internal_reference`于使用类或联合，因为它们将是 Python 中的可变类型。我想工作的“更复杂的类模板”正在返回对用户类型的引用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-21T18:19:54.673

简短的回答可能是您不想返回对浮点数的内部引用。在 Python 中，数字是不可变的，因此只返回一个副本更安全，并且不会牺牲任何特性或速度。

如果你想返回更复杂的东西（比如列表或对另一个包装类的引用），你可以，但它仍然几乎总是不是你想要的；一个对象对另一个对象的依赖引入了脆弱性。如果您希望能够修改对象的内部状态，您最好使用 getter 和 setter，并将数据复制进出。

# ejb - 如何在实体 (EJB3) 中插入 Null 值？

> ID：11143636
> 
> 赞同：2
> 
> 时间：2012-06-21T17:35:35.653
> 
> 标签：ejb, entity, ejb-3.0, entity-relationship, ejb-3.1

我正在研究 EJB3。我想在表中插入 Null 值。

例如。我有一个名为“学生”的表，其中包含列字段，例如

```
String name;
String class;
Set<Subjects> subjects; 
```

科目字段有 JoinTable "student_subjects" 字段`joinColumns`"student_name" 的 "Students" 表和`inverseJoinColumns`"subjects_name" 的 "subjects" 表

我想要的是当我添加一个新学生时，“学生”表中会有一个条目。

也在“student_subjects”表中。但对于“subjects_name”，值必须是 student_name（非空）和 NULL。是否可以？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-23T21:50:35.797

您需要使用[@Column](http://docs.oracle.com/javaee/6/api/javax/persistence/Column.html) JPA 注释的可为[空](http://docs.oracle.com/javaee/6/api/javax/persistence/Column.html#nullable%28%29)属性。

```
@Column(nullable = false)
private String studentName;

@Column(nullable = true)
private String subjectsName; 
```

# c# - 执行责任链变化

> ID：11143637
> 
> 赞同：5
> 
> 时间：2012-06-21T17:35:37.923
> 
> 标签：c#, linq, c#-4.0, chain-of-responsibility

我有一个任务管道，基本上是责任链模式的变体。

我的管道中的一个任务如下所示

```
internal interface IPTask<T>
{
    bool CanExecute(T instance);
    T Process(T instance);
} 
```

..我的处理器看起来像

```
internal interface IProcessor<T>
{
    T Execute(T instance);
} 
```

我的具体实现如下所示：

```
public class Processor<T> : IProcessor<T>
{
    private readonly ITasks<T> tasks;

    public Processor(ITasks<T> tasks)
    {
        this.tasks= tasks;
    }

    public T Execute(T instance)
    {
         var taskstoExecute = tasks.GetTasks()
                                   .Where(task => task.CanExecute(instance));

         taskstoExecute.ToList().ForEach(task=>task.Process(instance));

         return T;
    }
} 
```

..我的任务如下所示：

```
internal interface ITasks<T>
{
    IEnumerable<IPTask<T>> GetTasks();
} 
```

T 可以是不同的实例，但受通用合同的约束。其中一项任务是将传入对象映射到完全不同的对象并从那里转发该实例。

现在如您所见，我正在执行管道中的所有任务，我想将其修改为以下内容：

*   下一个任务的方法的输入`Execute`应该来自先前执行的任务。
*   如果`CanExecute`任务失败，则管道应停止处理任务。

你能帮我弄到这个吗？此外，您是否希望为此目的代码结构不同？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-21T22:38:05.867

使用此实现，`CanProcess`实际用于触发将停止进程的异常。

我添加了第二个实现，称为`ExecuteWithPartial`，它处理异常，以防这是您所期望的行为。它会处理，但如果有错误，它会返回到该点的部分结果。

```
public class Processor<T> : IProcessor<T>
{
    //... rest of your code

    public T Execute(T instance)
    {
        return this._tasks.GetTasks().Aggregate(instance, (current, task) => InternalExecute(task, current));
    }

    public T ExecuteWithPartial(T instance)
    {
        var target = instance;
        try
        {
            foreach (var task in this._tasks.GetTasks())
            {
                target = InternalExecute(task, target);
            }
            return target;
        }
        catch (CantExecuteException)
        {
            return target;
        }
    }

    private static T InternalExecute(IPTask<T> task, T instance)
    {
        if (!task.CanExecute(instance))
            throw new CantExecuteException();
        return task.Process(instance);
    }
} 
```

新的异常类是：

```
public class CantExecuteException : Exception
{
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-22T04:56:05.353

这个怎么样：

```
public T Execute(T instance)
{
     T result = instance;
     foreach(var individual in tasks.GetTasks())
     {
         if(!individual.CanExecute()) break;

         result = individual.Process(result);
     }

     return result;
} 
```

正如您目前所拥有的，它更像是一种复合模式，而不是责任链。这种变化使它更接近于 CoR。但更重要的是要注意它是否满足您的需求，而不是使用正确的设计模式行话。:)

# php - 读取 XML 中的页面 URL？或者在 XML 文件中使用 PHP

> ID：11143640
> 
> 赞同：-1
> 
> 时间：2012-06-21T17:35:47.290
> 
> 标签：php, xml, url

我有一个带有 settings.xml 文件的 flash 元素（我知道，但请不要）。

XML 文件中的值之一取决于 URL，因此我不想拥有多个 flash 文件夹实例，而是要执行以下操作：

```
value="<?php $rest = substr(<?php echo curPageURL(); ?>, -2, -1) ?>" 
```

我徒劳地尝试过，但正如您可能已经知道的那样，那是行不通的。

所以我要么需要一种方法来用 XML 编写它，要么在 XML 文件中允许那行 PHP。

```
function curPageURL() {
    $pageURL = 'http';
    if ($_SERVER["HTTPS"] == "on") {
        $pageURL. = "s";
    }
    $pageURL. = "://";
    if ($_SERVER["SERVER_PORT"] != "80") {
        $pageURL. = $ _SERVER["SERVER_NAME"].":".$_SERVER["SERVER_PORT"].$_SERVER["REQUEST_URI"];
    } else {
        $pageURL. = $ _SERVER["SERVER_NAME"].$_SERVER["REQUEST_URI"];
    }
    return $pageURL;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-21T17:40:45.317

为此，您需要两件事：

1.  您的服务器需要配置为将 XML 文件解析为 PHP 文件。如果您使用的是 Apache，那么您的配置中的内容类似于：

    ```
    AddHandler application/x-httpd-php5s .xml 
    ```

2.  您需要使用有效的 PHP 语法，如下所示：

    ```
    value="<?php echo substr( curPageURL(), -2, -1); ?>" 
    ```

    假设这`curPageURL()`是 PHP 中定义的函数。

最后，您应该确保该`short_open_tag`指令`Off`在您的`php.ini`配置中设置为，否则 PHP 在遇到 XML 开始标记时会抛出语法错误，例如`<?xml`. 这可以在 .htaccess 中使用类似于

```
php_value short_open_tag Off 
```

# android - 将图片发布到 Facebook 墙时出现空指针异常 (android)

> ID：11143644
> 
> 赞同：0
> 
> 时间：2012-06-21T17:36:01.863
> 
> 标签：android, facebook, nullpointerexception

我的应用程序旨在允许用户拍照，然后将其上传到他们的 Facebook 墙上。以下代码与在与此完全相同的问题有关的其他 SO 问题上给出的许多其他工作代码示例非常相似，但仍然给了我空指针异常：

```
 private void postOnWall()
    {
        final String response = "";
    try
    {
        Bundle params = new Bundle();
        params.putString("message", getMessage());
        params.putByteArray("picture", byteArray);
        mAsyncRunner.request(me/feed, params, "POST", new SampleUploadListener(),
        null);
    }
    catch (Exception e)
    {
        e.printStackTrace();
    }       
} 
```

我只想让图像上传工作，然后再继续添加消息。有任何想法吗？

编辑：这是与 AsyncRunner(...) 行一起使用的 SampleUploadListener() ：

```
public class SampleUploadListener extends BaseRequestListener {
    public void onComplete(final String response, final Object state) {
        try {
            // process the response here: (executed in background thread)
            Log.d("Facebook-Example", "Response: " + response.toString());
            JSONObject json = Util.parseJson(response);
            final String src = json.getString("src");

            // then post the processed result back to the UI thread
            // if we do not do this, an runtime exception will be generated
            // e.g. "CalledFromWrongThreadException: Only the original
            // thread that created a view hierarchy can touch its views."

        } catch (JSONException e) {
            Log.w("Facebook-Example", "JSON Error in response");
        } catch (FacebookError e) {
            Log.w("Facebook-Example", "Facebook Error: " + e.getMessage());
        }
    }

    @Override
    public void onFacebookError(FacebookError e, Object state) {
        // TODO Auto-generated method stub

    }
} 
```

日志猫：

```
06-22 13:23:45.136: W/System.err(20667): java.lang.NullPointerException
06-22 13:23:45.136: W/System.err(20667):    at     com.uncc.cci.TrashPickup.TrashPickupActivity.postwall(TrashPickupActivity.java:475)
06-22 13:23:45.136: W/System.err(20667):    at com.uncc.cci.TrashPickup.TrashPickupActivity$5$1.onClick(TrashPickupActivity.java:230)
06-22 13:23:45.140: W/System.err(20667):    at android.view.View.performClick(View.java:3511)
06-22 13:23:45.140: W/System.err(20667):    at android.view.View$PerformClick.run(View.java:14105)
06-22 13:23:45.140: W/System.err(20667):    at android.os.Handler.handleCallback(Handler.java:605)
06-22 13:23:45.140: W/System.err(20667):    at android.os.Handler.dispatchMessage(Handler.java:92)
06-22 13:23:45.140: W/System.err(20667):    at android.os.Looper.loop(Looper.java:137)
06-22 13:23:45.140: W/System.err(20667):    at android.app.ActivityThread.main(ActivityThread.java:4424)
06-22 13:23:45.144: W/System.err(20667):    at java.lang.reflect.Method.invokeNative(Native Method)
06-22 13:23:45.144: W/System.err(20667):    at java.lang.reflect.Method.invoke(Method.java:511)
06-22 13:23:45.144: W/System.err(20667):    at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:784)
06-22 13:23:45.144: W/System.err(20667):    at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:551)
06-22 13:23:45.148: W/System.err(20667):    at dalvik.system.NativeStart.main(Native Method) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-21T18:28:28.953

应该：

```
private void postOnWall() {
    Bundle params = new Bundle();            
    params.putString("message", "New picture");
    params.putByteArray("source", byteArray);
    mAsyncRunner.request("me/photos", params, "POST", new SampleUploadListener(), null);
} 
```

您将路径作为 null 发送，这可能就是您得到空指针异常的原因。
另外根据[文档](http://developers.facebook.com/docs/reference/api/user/#photos)，图像参数名称是`source`.

* * *

# 编辑

试试这个来检查 mAsyncRunner 是否为空：

```
private void postOnWall() {
    Bundle params = new Bundle();            
    params.putString("message", "New picture");
    params.putByteArray("source", byteArray);
    Log.d("Facebook-Example", mAsyncRunner == null ? "mAsyncRunner is null" : "mAsyncRunner not null");
    mAsyncRunner.request("me/photos", params, "POST", new SampleUploadListener(), null);
} 
```

由于该行中引发了错误，因此这似乎是唯一可能的事情。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-22T20:34:04.220

当您纠正了此处的任何错误时，您会不幸地发现，此时无法通过将实际图像字节直接上传到 facebook 来将图像发布到您的墙上。您可以将照片上传到他们的照片库，但不能上传到他们的墙上。要将照片发布到墙上，它必须已经在线，并且您需要提供指向它所在位置的链接以及其他数据。如果我弄错了，那么这是一个非常新的发展，因为几个月前我刚刚遇到了这一切，甚至向 Facebook 提交了一个错误，他们拒绝说“这不是错误，这是我们想要的事情”。

如果您可以将照片放在他们的画廊中（如果它是画廊中唯一的照片，它将看起来几乎与普通的墙贴一样），这就是这样做的方法： [Android 将图片发布到 Facebook 墙上](https://stackoverflow.com/questions/5168145/android-post-picture-to-facebook-wall)

# emacs - Emacs org 模式：如果我忘记打卡，如何调整以前的时钟

> ID：11143645
> 
> 赞同：17
> 
> 时间：2012-06-21T17:36:09.633
> 
> 标签：emacs, org-mode

现在使用 emacs org 模式大约一个月来跟踪我所有的项目和任务。

我全天为所有活动计时，而不仅仅是与工作相关的活动。

我的问题是——我经常忘记打卡参加一项新活动（比如吃午饭）。当我返回并打卡回到工作活动时，我需要先打卡吃午饭，然后调整它的开始时间戳。这对于午餐活动来说是可以的，但是它并没有调整我吃午餐之前之前的工作工作相关任务，所以净是之前的任务与午餐重叠并且不准确。

有没有办法改变行为，以便调整之前的任务？我不希望使用空闲功能来执行此操作；我希望自动进行调整。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-07-25T18:41:06.817

**ETA：**这也再次出现在邮件列表中，似乎最近对代码库的提交提供了另一种 [也许更好的] 方式来做到这一点。请参阅有关Bastien（组织模式维护者）输入[的邮件列表讨论：](http://www.mail-archive.com/emacs-orgmode@gnu.org/msg57752.html)

> 时钟时间戳上的 SM-[up/down] 也会尝试更新上一个/下一个时钟时间戳。

（实际上，`bzg's`下面的建议就是这个确切的东西......它只是没有包含上面的快捷方式，所以我认为他的答案看起来比上面的更难/更不吸引人，这真的很容易。）

* * *

您也可以使用`org-resolve-clocks`. 请参阅[解决空闲时间](http://www.gnu.org/software/emacs/manual/html_node/org/Resolving-idle-time.html)。

本质上，您有一些标题并被打卡：

```
* Work
  :LOGBOOK:
  CLOCK: [2012-07-25 Wed 8:26]
  :END: 
```

我吃完午饭回来，意识到我忘了打卡下班和吃午饭。

我运行`M-x org-resolve-clocks`并得到以下提示：

```
Select a Clock Resolution Command:

i/q/C-g  Ignore this question; the same as keeping all the idle time.

k/K      Keep X minutes of the idle time (default is all).  If this
         amount is less than the default, you will be clocked out
         that many minutes after the time that idling began, and then
         clocked back in at the present time.
g/G      Indicate that you "got back" X minutes ago.  This is quite
         different from 'k': it clocks you out from the beginning of
         the idle period and clock you back in X minutes ago.
s/S      Subtract the idle time from the current clock.  This is the
         same as keeping 0 minutes.
C        Cancel the open timer altogether.  It will be as though you
         never clocked in.
j/J      Jump to the current clock, to make manual adjustments.

For all these options, using uppercase makes your final state
to be CLOCKED OUT. 
```

因为我想`K`暂停 X 分钟的工作，打卡，然后打卡进入午餐，我按`K`，它提示我（现在是 ~1:30p）：

```
Keep how many minutes? (default 303) 
```

我可以按 Enter 保留所有这些，但假设我在 12 点左右吃午饭。那是大约 3.5 小时的工作，所以我将进入`210 RET`。

现在，我进入午餐并得到这个提示：

```
You stopped another clock 101 minutes ago; start this one from them? (y or n) 
```

我进入`y RET`，午餐在上午 11:56 打卡。如果您从午餐回来又开始工作（或开始工作却忘记了），请重复此过程：

```
M-x org-resolve-clocks
K
____ RET ;; for how many minutes you at lunch
C-c C-x C-i ;; to clock in on Work again
y RET ;; clock in at when you stopped lunch 
```

最终结果：

```
* Work
  :LOGBOOK:
  CLOCK: [2012-07-25 Wed 12:41]
  CLOCK: [2012-07-25 Wed 8:26]--[2012-07-25 Wed 11:56] =>  3:30
  :END:

* Lunch
  :LOGBOOK:
  CLOCK: [2012-07-25 Wed 11:56]--[2012-07-25 Wed 12:41] =>  0:45
  :END: 
```

希望这可以帮助。org-mode 时钟向导[Bernt Hansen](http://doc.norang.ca/org-mode.html)[通过 org-mode mailing list thread](http://www.mail-archive.com/emacs-orgmode@gnu.org/msg40499.html)向我解释了这一点。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-07-12T12:10:09.750

现在已实现（检查[http://orgmode.org/w/?p=org-mode.git;a=commit;h=3528fc](http://orgmode.org/w/?p=org-mode.git;a=commit;h=3528fc)）。

`(setq org-clock-continuously t)`在您的 .emacs.el 中，新时钟将从最后一个时钟关闭的时间开始。

`C-u C-u C-u M-x org-clock-in RET`并且`C-u C-u M-x org-clock-in-last RET`也会这样做，即使`org-clock-continuously`设置为`nil`.

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-07-02T01:22:08.390

如果我正确理解您的问题，您想在下班后调整时间戳。有一个命令；您可以查看功能：

`org-timestamp-up`

`org-timestamp-down`

我认为这些是默认绑定的，但似乎它们不是，所以你会想要将它们绑定到一个键序列，也许像`C-c T u`and之类的东西`C-c T d`，或者任何漂浮在你船上的东西。用法很简单，只需将光标移到要调整的字段上，然后向上或向下运行。它仅适用于时间戳本身，**而不**适用于右侧显示的计算持续时间。

你也可以看看

`org-timestamp-change`

前两个函数是包装器。您可能还需要自定义变量

`org-time-stamp-rounding-minutes`

默认情况下，它会将时间戳从原始打卡开始算起 +/- 5 分钟，您在修改时间戳时可能会感到困惑。

就个人而言，我更喜欢在我`(setq org-time-stamp-rounding-minutes '(0 1))`打卡的确切分钟（零）启动计时器，并使用 1 分钟的粒度来更改时间戳。此外，您可以`C-u 4 7 C-c T u`在时间戳的分钟部分使用前缀，并且 org-mode 会做正确的事情 - 甚至将小时四舍五入。

**概括：**

```
(setq org-time-stamp-rounding-minutes '(0 1))
(add-hook 'org-mode-hook
  '(lambda ()
     (local-set-key (kbd "C-c T u") 'org-timestamp-up)
     (local-set-key (kbd "C-c T d") 'org-timestamp-down))) 
```

# c# - 在 WPF C# 中将下载的文件保存到桌面时遇到问题

> ID：11143652
> 
> 赞同：3
> 
> 时间：2012-06-21T17:36:31.700
> 
> 标签：c#, wpf, webclient

当我使用：

```
 WebClient web = new WebClient();
  web.DownloadProgressChanged += new DownloadProgressChangedEventHandler(ProgressChangedWeb);
  web.DownloadFileAsync(new Uri("http://www.website.com/Webs.exe"),
                            Environment.SpecialFolder.Desktop + @"\Webs.exe"); 
```

...没有下载。

但是，如果我将其更改为“

```
 WebClient web = new WebClient();
  web.DownloadProgressChanged += new DownloadProgressChangedEventHandler(ProgressChangedWeb);
  web.DownloadFileAsync(new Uri("http://www.website.com/Webs.exe"),
                            Environment.SpecialFolder.Desktop + "Webs.exe"); 
```

然后它下载，但我得到一个名为“desktopWebs.exe”的文件。那么如何将文件保存到桌面呢？

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-21T17:45:50.643

你要的是这个...

```
Environment.GetFolderPath(Environment.SpecialFolder.Desktop) + @"\Webs.exe"; 
```

否则，您只是在添加单词 desktop 而不是实际路径。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-21T17:40:33.357

您可以使用 Path.Combine

```
web.DownloadFileAsync(new Uri("http://www.website.com/Webs.exe"),
                        Path.Combine(Environment.GetFolderPath(Environment.SpecialFolder.DesktopDirectory), "Webs.exe")); 
```

此功能将自动插入（或删除）斜杠以及适应正在使用的任何文件系统

您还应该考虑使用 Environment.SpecialFolder.DesktopDirectory，它指向磁盘上桌面文件夹的实际物理位置。

# java - 适用于 SSL 的 Java Keytool：CSR 别名、密钥和密钥库

> ID：11143653
> 
> 赞同：0
> 
> 时间：2012-06-21T17:36:32.423
> 
> 标签：java, ssl

我阅读[了这篇](http://www.youtube.com/watch?v=W3pbP-7lx-c)关于如何使用`keytool`为您的组织生成 CSR 的文章。它简单易行，但给我留下了一些我无法找到明确的描述性答案的问题：

*   Java 的 CSR 概念是什么`alias`？为什么要使用它？这个别名字段存储在哪里，还有哪些其他工具/API 可以访问它？
*   a`key`和 a 和有什么不一样`keystore`？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-21T17:53:15.887

### *Java 的 CSR 别名的概念是什么，为什么要使用一个？这个别名字段存储在哪里，还有哪些其他工具/API 可以访问它？*

首先，java 使用*密钥库*将*密钥*（和*证书*）保存在内部。单个*密钥库*可以保存许多证书，因此您需要一种方法来区分它们。这就是*别名*的用途。拥有一个*keystore*，一个*别名*（如果需要，还有一个密码），您可以使用[Java Crypto API](http://docs.oracle.com/javase/1.4.2/docs/guide/security/CryptoSpec.html)（特别是类，如）从*keystore获取**证书*。在这里，您有一个[示例，说明如何使用 Crypto API 从密钥库加载密钥](http://www.java2s.com/Code/Java/Security/RetrievingaKeyPairfromaKeyStore.htm)*[`Keystore`](http://docs.oracle.com/javase/1.4.2/docs/api/java/security/KeyStore.html)*

 *### *密钥和密钥库有什么区别？*

*密钥库*是一个容器。*密钥*保存在密钥*库*中。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-21T17:55:46.127

密钥库是用于保存证书和私钥的文件格式，别名用于标识密钥库中的每个条目。*

# ruby-on-rails - UserSession.find 更改密码后返回 nil

> ID：11143656
> 
> 赞同：0
> 
> 时间：2012-06-21T17:36:50.307
> 
> 标签：ruby-on-rails, ruby-on-rails-3.1, authlogic

我最近创建了一种更改当前用户密码的方法，但是在保存记录后，我的 UserSession.find 返回 nil，我尝试通过编写 UserSession.new({...}).save 没有运气，任何关于如何解决这个问题？

这是我的代码，请注意通过 AJAX 请求运行（这是 UserSessionController 下的方法）：

定义

```
 change_my_password
    #print "--------------RECORD: #{current_user_session.record.as_json}-------- #{current_user_session.user.as_json}"
    user = current_user
    user_email = user.email
    user_remember_me = user.remember_created_at
    response = {
      :success => false,
      :message_code => Extjs::MessageCodes::ERROR,
      :message => 'Si è verificato un errore',
      :total => 0,
      :root => []
    }
    if user.valid_password?(params[:old_password], true)
      user.password = params[:new_password]
      user.password_confirmation = params[:confirm_password]
      response[:message] = 'La nuova password e la conferma non coincidono o sono troppo brevi'
      if user.save
        response[:success] = true
        response[:message_code] = Extjs::MessageCodes::SUCCESS
        response[:message] = 'Password modificata con successo'
      end
    else
      response[:message] = 'La password precedente non coincide con quella attualmente in uso'
    end

    respond_to do |format|
      format.extjson { render :json => response }
    end
  end 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-21T18:48:51.777

确保您没有将[maintain_sessions](https://github.com/binarylogic/authlogic/blob/master/lib/authlogic/acts_as_authentic/session_maintenance.rb#L35)参数设置为false，即：

```
acts_as_authentic do |c|
  c.maintain_sessions = false # change this to true.
end 
```

**或者**

保存后手动更新会话：

```
user.send(:update_sessions) 
```

**或者**

保存后重新创建会话：

```
UserSession.create(user) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-26T02:17:35.297

实际上我没有找到解决这个问题的方法：我通过在更改密码后再次强制登录来解决（甚至增加了安全性，所以还不错）。

我认为 KandadaBoggu 的回答是正确的，但我测试了所有这些，但它们对我不起作用。

也许这是我的代码中有问题造成的问题，我真的不知道。目前我只是将其视为解决方案，因为它实际上适用于我的软件。

如果找到更好的答案，我很乐意标记它。

谢谢大家。

# android - 使用 Proguard 和 GoogleAdMobAdsSdk-6.0.1.jar (AdMob) 时出错

> ID：11143665
> 
> 赞同：1
> 
> 时间：2012-06-21T17:37:41.367
> 
> 标签：android, proguard

并提前感谢！

我已经尝试了几个小时，6 个或更长时间！但是每次我尝试生成签名/未签名的 apk 时，Proguard 都会删除此错误消息：

* * *

```
[2012-06-21 19:24:30 - SuperMarket] Proguard returned with error code 1\. See console
[2012-06-21 19:24:30 - SuperMarket] Note: there were 2919 duplicate class definitions.
[2012-06-21 19:24:30 - SuperMarket] Warning: com.google.ads.util.g: can't find referenced method 'void setLayerType(int,android.graphics.Paint)' in class android.view.View
[2012-06-21 19:24:30 - SuperMarket] Warning: com.google.ads.util.g: can't find referenced method 'void setDisplayZoomControls(boolean)' in class android.webkit.WebSettings
[2012-06-21 19:24:30 - SuperMarket] Warning: com.google.ads.util.g$b: can't find referenced class android.webkit.WebResourceResponse
[2012-06-21 19:24:30 - SuperMarket] Warning: com.google.ads.util.g$b: can't find referenced class android.webkit.WebResourceResponse
[2012-06-21 19:24:30 - SuperMarket] Warning: com.google.ads.util.g$b: can't find referenced method 'android.webkit.WebResourceResponse shouldInterceptRequest(android.webkit.WebView,java.lang.String)' in class com.google.ads.internal.i
[2012-06-21 19:24:30 - SuperMarket] Warning: com.google.ads.util.g$b: can't find referenced class android.webkit.WebResourceResponse
[2012-06-21 19:24:30 - SuperMarket] Warning: com.google.ads.util.g$b: can't find referenced class android.webkit.WebResourceResponse
[2012-06-21 19:24:30 - SuperMarket]       You should check if you need to specify additional program jars.
[2012-06-21 19:24:30 - SuperMarket] Warning: there were 4 unresolved references to classes or interfaces.
[2012-06-21 19:24:30 - SuperMarket]          You may need to specify additional library jars (using '-libraryjars').
[2012-06-21 19:24:30 - SuperMarket] Warning: there were 3 unresolved references to program class members.
[2012-06-21 19:24:30 - SuperMarket]          Your input classes appear to be inconsistent.
[2012-06-21 19:24:30 - SuperMarket]          You may need to recompile them and try again.
[2012-06-21 19:24:30 - SuperMarket]          Alternatively, you may have to specify the option 
[2012-06-21 19:24:30 - SuperMarket]          '-dontskipnonpubliclibraryclassmembers'.
[2012-06-21 19:24:30 - SuperMarket] Error: Please correct the above warnings first. 
```

* * *

我试过这个 proguard.cfg：

* * *

```
-dontpreverify
-repackageclasses ''
-allowaccessmodification
-optimizations !code/simplification/arithmetic
-keepattributes *Annotation*

-injar C:\Users\Jordi\android-sdks\platforms\android-10\android.jar
-libraryjars C:\Users\Jordi\android-sdks\extras\google\admob_ads_sdk\GoogleAdMobAdsSdk-6.0.1.jar
-libraryjars C:\Users\Jordi\android-sdks\tools\support\annotations.jar

-keep public class * extends android.app.Activity
-keep public class * extends android.app.Application
-keep public class * extends android.app.Service
-keep public class * extends android.content.BroadcastReceiver
-keep public class * extends android.content.ContentProvider

-keep public class * extends android.view.View {
    public <init>(android.content.Context);
    public <init>(android.content.Context, android.util.AttributeSet);
    public <init>(android.content.Context, android.util.AttributeSet, int);
    public void set*(...);
}

-keepclasseswithmembers class * {
    public <init>(android.content.Context, android.util.AttributeSet);
}

-keepclasseswithmembers class * {
    public <init>(android.content.Context, android.util.AttributeSet, int);
}

-keepclassmembers class * extends android.content.Context {
   public void *(android.view.View);
   public void *(android.view.MenuItem);
}

-keepclassmembers class * implements android.os.Parcelable {
    static android.os.Parcelable$Creator CREATOR;
}

-keepclassmembers class **.R$* {
    public static <fields>;
}

-keep public class com.google.ads.** { public protected *; } 
```

* * *

以及许多其他的 injar/libraryjars 组合！任何人都知道问题可能出在哪里！任何反馈将不胜感激！

再次感谢，问候！！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-24T13:50:49.263

你试过保留所有的包裹吗？

-keep class com.google.ads** { *; }

# exchange-server - 如何在 Exchange WebDav 的日历查询中过滤掉私人事件？

> ID：11143666
> 
> 赞同：0
> 
> 时间：2012-06-21T17:37:46.363
> 
> 标签：exchange-server, webdav, exchange-server-2003

我需要从 Exchange 2003 中的用户日历中提取所有非私人项目。我已经完成了以下工作，它会提取他们的所有项目（包括 Private 字段）：

```
<?xml version="1.0"?>
<g:searchrequest xmlns:g="DAV:" xmlns:mapi="http://schemas.microsoft.com/mapi/">
    <g:sql>
        SELECT "http://schemas.microsoft.com/mapi/Private", "urn:schemas:calendar:uid", "urn:schemas:calendar:location", "urn:schemas:httpmail:subject", "urn:schemas:calendar:dtstart", "urn:schemas:calendar:dtend", "urn:schemas:calendar:busystatus", "urn:schemas:calendar:meetingstatus", "urn:schemas:calendar:instancetype" 
        FROM Scope('SHALLOW TRAVERSAL OF "%s"') 
        WHERE NOT "urn:schemas:calendar:instancetype" = 1 AND "DAV:contentclass" = 'urn:content-classes:appointment' AND "urn:schemas:calendar:dtstart" > '2003/06/01 00:00:00' AND "mapiPrivate" = 0 
        ORDER BY "urn:schemas:calendar:dtstart" ASC
    </g:sql>
</g:searchrequest> 
```

但是，当我尝试将 Private 字段添加到时，`WHERE`我得到一个`BAD REQUEST`错误响应。以下代码是我将 Private 字段添加到`WHERE`子句的方式。

```
<?xml version="1.0"?>
<g:searchrequest xmlns:g="DAV:" xmlns:mapi="http://schemas.microsoft.com/mapi/">
    <g:sql>
        SELECT "http://schemas.microsoft.com/mapi/Private", "urn:schemas:calendar:uid", "urn:schemas:calendar:location", "urn:schemas:httpmail:subject", "urn:schemas:calendar:dtstart", "urn:schemas:calendar:dtend", "urn:schemas:calendar:busystatus", "urn:schemas:calendar:meetingstatus", "urn:schemas:calendar:instancetype" 
        FROM Scope('SHALLOW TRAVERSAL OF "%s"') 
        WHERE NOT "urn:schemas:calendar:instancetype" = 1 AND "DAV:contentclass" = 'urn:content-classes:appointment' AND "urn:schemas:calendar:dtstart" > '2003/06/01 00:00:00' AND "mapiPrivate" = 0 AND "http://schemas.microsoft.com/mapi/Private" = 0
        ORDER BY "urn:schemas:calendar:dtstart" ASC
    </g:sql>
</g:searchrequest> 
```

我究竟做错了什么？这不可能吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-21T17:55:42.003

您需要请求 PR_SENSITIVITY 属性（DASL 名称[http://schemas.microsoft.com/mapi/proptag/0x00360003](http://schemas.microsoft.com/mapi/proptag/0x00360003)）。对于私有 apppoitments，其值为 SENSITIVITY_PRIVATE (=2)

# sql - 如何选择所有版本最高的条目？

> ID：11143667
> 
> 赞同：1
> 
> 时间：2012-06-21T17:37:49.690
> 
> 标签：sql

我有一个名为的表`documents`，其中包含字段 id、title、version 和 content。

现在我想为每个具有最高版本的标题获取所有 ID（或行）。

假设我有以下数据：

```
+----+-------+---------+---------+
| id | title | version | content |
+----+-------+---------+---------+
|  2 | foo   |       1 | abc1    |
|  3 | foo   |       2 | abc2    |
|  4 | foo   |       3 | abc3    |
|  5 | bar   |       1 | abcd1   |
|  6 | bar   |       2 | abcd2   |
|  7 | baz   |       1 | abcde1  |
+----+-------+---------+---------+ 
```

我想接收这些条目的 ids 4、6、7 或整行。

性能不是问题，因为只有几百个条目。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-21T17:41:15.570

要检索整行，您需要`GROUP BY version`使用`MAX()`聚合，并将其作为子查询连接到整个表以提取剩余的列。条件将`JOIN`需要反对组合，`title, version`因为它们一起唯一地标识了标题的最佳版本。

以下应独立于您使用的 RDBMS 工作：

```
SELECT 
  documents.id,
  documents.title, 
  documents.version,
  documents.content
FROM 
  documents
  JOIN (
    /* subquery pulls greatest version per title */
    SELECT
      title,
      MAX(version) AS version
    FROM documents
    GROUP BY title
    /* title, version pair is joined back against the main table */
  ) maxversions ON (documents.title = maxversions.title AND documents.version = maxversions.version) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-21T17:41:37.167

这是一个简单的分组：

```
select max(version)
from documents
group by title 
```

如果愿意，您可以加入回文档以获取完整的文档信息。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-21T18:02:14.187

这将获得您想要的 ID：

```
 Select max(id) as id from documents
group by title
  having count(1) = max(version)
order by id 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-21T17:40:56.413

怎么样：

```
SELECT * FROM dataz
WHERE version IN (
  SELECT TOP 1 version
  FROM dataz
  ORDER BY version DESC
) 
```

# c# - 您如何处理 2 个非常相似的 sql 表上的服务方法

> ID：11143668
> 
> 赞同：0
> 
> 时间：2012-06-21T17:37:50.903
> 
> 标签：c#, sql, ado.net, data-access-layer, business-logic-layer

我有 2 个非常相似的 sql 表。每个表只有外键不同。

```
TemplateUnit table:

Id (PK)
ParentId
Name
TemplateId (FK)

TestplanUnit table:

Id (PK)
ParentId
Name
TestplanId (FK) 
```

当我选择 2 个内容几乎相同的表时——只是 FK 不同——你真的在你的服务和数据提供者中创建了你的 CRUD 方法的副本（使用 ado.net pure）吗？

如何改进服务，以便在服务和数据提供者类中只使用一种 Get/Add/Update/Delete 方法？我也不想进行重复的单元测试...

更新：

到目前为止，这是我的解决方案：

```
public class Unit
    {
        public string Name { get; set; }
        public int Id { get; set; }
        public Nullable<int> ParentId { get; set; }
        public int TemplateId { get; set; }      
        public bool IsLazy { get; set; }         
    }

public class UnitDTO
    {
        public UnitDTO(UnitMode mode)
        {
            switch (mode)
            {
                case UnitMode.Template:
                    this.ForeinKeyName = "TemplateId";
                    this.TableName = "TemplateUnit";
                    break;
                case UnitMode.Testplan:
                    this.ForeinKeyName = "TestplanId";
                    this.TableName = "TestplanUnit";
                    break;
            }

            UnitBO = new Unit();
        }

        public string TableName { get; private set; }        
        public string ForeinKeyName { get; private set; }
        public Unit UnitBO { get; private set; }
    }

    public enum UnitMode
    {
        Template = 0,
        Testplan = 1,
    } 
```

我在 BLL 和 DAL 中的 Get/Add/Delete 方法获得了一个 UnitDTO 对象，其中包含所需的所有信息。

那么一个缺点可能是 - 如果这个项目将在一个团队中完成 - 当您创建 UnitDTO 并将其传递给每个 CRUD 方法的 BLL 时，您必须知道在 DAL 中使用/需要哪个变量。

你怎么看？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-22T00:19:32.943

我认为如果您像以下步骤一样明确指定您的类型会更好。

```
public enum TableTypeEnum
{
    Template =0,
    TestPlan =1
}

public abstract class UnitBase
{   
    public int Id { get; set; }
    public Nullable<int> ParentId { get; set; }
    public string Name { get; set; }

    public TableTypeEnum TableType { get; private set; }

    protected UnitBase(TableTypeEnum  type)
    {
        TableType = type;
    }
}

public class TemplateUnit:UnitBase
{
    public int TemplateForeignKeyId { get; set; }
    public TemplateUnit() : base(TableTypeEnum.Template)
    {}
}

public class TestPlanUnit:UnitBase
{
    public Guid TestplanForeignKeyId { get; set; }
    public TestPlanUnit():base(TableTypeEnum.TestPlan)
    {}
} 
```

而DAL类可能是这样的

```
public class  DAL
    {
        public void Insert(UnitBase unit)
        {
            switch (unit.TableType)
            {
                case  TableTypeEnum.Template:
                    //insert into the template table
                    break;
                case TableTypeEnum.TestPlan:
                     //insert into the testplan table
                    break;
            }
        }

    } 
```

通过这样做，当其他人调用您的代码时，他们确切地知道他们正在使用哪种类型的单元，并且您可以避免重复您的代码。希望这有帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-22T07:55:44.893

好的，我建议您不要合并 CRUD 操作。为什么Unit可以存储在两个表中？您的域中必须有某种规则来确定将其存储在哪个表中？此“规则”表明您的单元可以具有多个含义/定义/规范，无论它可能多么轻微。当这些规范中的一个发生变化时（可能是额外的列等），您将留下一组 CRUD 操作，这些操作会被条件语句混淆，这可能会变得复杂。

如果这两个单元之间存在根本区别，我什至会说创建单独的业务对象，并使用它们自己的规则。保持你的设计纯粹，保持独立。是的，它的代码更多，但更简单。

# ruby-on-rails-3 - capistrano 总是部署旧版本？

> ID：11143669
> 
> 赞同：1
> 
> 时间：2012-06-21T17:37:56.440
> 
> 标签：ruby-on-rails-3, capistrano, rvm-capistrano

我一直遇到一个问题，capistrano 将从我们的 git repo 部署旧修订版，除非我们指定要部署到的确切修订版。

```
#this will deploy a revision from a couple weeks ago
cap staging deploy:migrations

#this will deploy correctly a new revision
cap staging deploy:migrations -S revision=74d27c00363cdcd456942d6951230564893ccb28 
```

有谁知道为什么会发生这种情况？

这是帽部署文件：

```
set :rvm_ruby_string, 'ruby-1.9.3-p194@ac_helenefrance_01' # Or:
#set :rvm_ruby_string, ENV['GEM_HOME'].gsub(/.*\//,"") # Read from local system

require "rvm/capistrano" # Load RVM's capistrano plugin.
require "bundler/capistrano"

# set :verbose ,1

require 'capistrano/ext/multistage'
set :stages, %w(staging production)
set :default_stage, "staging"

set :user, "webm"
# set :deploy_via, :remote_cache
set :use_sudo, false

set :scm, "git"
set :repository, "git@aliencom.beanstalkapp.com:/ac_helenefrance_01.git"

# :branch is being set in stage files

default_run_options[:pty] = true
# ssh_options[:forward_agent] = true

after "deploy", "deploy:cleanup" # keep only the last 5 releases

namespace :deploy do
   %w[start stop restart].each do |command|
   desc "#{command} unicorn server"
   task command, roles: :app, except: {no_release: true} do
     run "#{sudo} service unicorn_#{server_configuration} #{command}"
   end
 end

 desc "build missing paperclip styles"
 task :build_missing_paperclip_styles, :roles=> :app do
   run "cd #{release_path}; RAILS_ENV=production bundle exec rake paperclip:refresh:missing_styles"
 end
 after "deploy:update", "deploy:build_missing_paperclip_styles"

 task :setup_config, roles: :app do
   puts "#making symlink to nginx sites-enabled"
   run "#{sudo} ln -fs #{current_path}/config/server/#{server_configuration}/nginx.conf /etc/nginx/sites-enabled/#{server_configuration}"
   puts "#making symlink to unicorn service script"
   run "#{sudo} ln -fs #{current_path}/config/server/#{server_configuration}/unicorn_init.sh /etc/init.d/unicorn_#{server_configuration}"
   puts "#making a the new config directory"
   run "mkdir -p #{shared_path}/config"
   run "sunique 1"
   put File.read("config/database.yml"), "#{shared_path}/config/database.yml"
   run "sunique 0"
   puts "Now edit the config files in #{shared_path}."
 end
 after "deploy:setup", "deploy:setup_config"

 task :symlink_config, roles: :app do
   run "ln -nfs #{shared_path}/config/database.yml #{release_path}/config/database.yml"

   puts "#for reference:"
   puts "#rvm wrapper 1.9.3@ac_helenefrance_01 ruby-1.9.3-p194@#{server_configuration} unicorn cap"
   puts "#now be sure to run: sudo update-rc.d unicorn_#{server_configuration} defaults"
 end
 after "deploy:finalize_update", "deploy:symlink_config"

end 
```

以及默认多级环境的 environment/stage.rb。

```
server "xxx.xxx.xxx.xxx", :web, :app, :db, primary: true

set :branch, "sitemap"
set :isRemote, true
set :server_configuration, "st_ac_helenefrance_01"

set :application, "#{server_configuration}"
set :deploy_to, "/home/#{user}/#{server_configuration}" 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-22T17:52:43.317

它被设置到一个旧分支>:(

我的同事不小心进行了他正在做的一项测试。

# ruby - Ruby：使用带有 return 语句的 unless 关键字

> ID：11143671
> 
> 赞同：2
> 
> 时间：2012-06-21T17:38:06.020
> 
> 标签：ruby

我目前正在开发一个项目，其中的代码如下所示：

```
 # the first return is the one causing problems
  def collect
    return Hash["IdentANode", Array[@id, ",", @ident_a_node.collect]] unless @ident_a_node.nil? and @id.nil?
    return Hash["IdentANode", @id] unless @id.nil?
  end 
```

我使用除非运算符有条件地执行 return 语句。由于某种原因，即使is ，此代码*仍会*执行。执行时我收到此消息：`@ident_a_node``nil`

> IdentANode.rb:14:in `collect': undefined method`collect' for nil:NilClass (NoMethodError)

这让我感到困惑，因为我曾认为除非关键字会阻止这种情况发生。当我将声明更改为这种形式时：

```
if not @ident_a_node.nil? and not @id.nil?
  return Hash["IdentANode", Array[@id, ",", @ident_a_node.collect]]
end 
```

或这种形式：

```
return Hash["IdentANode", Array[@id, ",", @ident_a_node.collect]] if not @ident_a_node.nil? and not @id.nil? 
```

return 语句*没有*执行，什么给出？为什么这两种说法有区别？`unless`关键字有多个条件会导致问题吗？

任何想法，将不胜感激

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-21T17:48:41.407

你那里有一个逻辑故障。您正在测试它们是否*都是* `nil`为了避免在您应该测试是否*为*`nil`. 你可能因为有太多的否定层而让自己陷入这种境地。任何超过一个都是不可接受的。

换句话说，您可以选择“如果没有下雨”，但不应该使用“除非`is_not_raining`标志未设置为 false 的倒数”之类的内容。

我个人的观点是，除非很明显它们存在，否则不应使用尾随条件。正如您在示例中看到的，您必须水平滚动才能找到条件，向开发人员隐藏重要信息。

就风格而言，不要使用`not`何时`!`会做同样的工作。其次，您正在专门针对`nil`您可能只需要某种定义的值进行测试。

其他问题包括使用`Hash[]`，`Array[]`这肯定是使用需要它们的语言的产物。Ruby 和 JavaScript 一样，允许使用`{ }`和`[ ]`分别隐式声明它们。

您的代码的正确 Ruby 样式版本是：

```
if (@ident_a_node and @id)
  return { "IdentANode" => [ @id, ",", @ident_a_node.collect ] }
end 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-21T17:44:51.930

除非与和/或一起使用，否则不要使用，这简直令人困惑。`unless @ident_a_node.nil? and @id.nil?`表示`if !(@ident_a_node.nil? and @id.nil?)`，这意味着只要两个实例变量之一不为零，它将返回。

```
if !(@ident_a_node.nil? and @id.nil?) 
```

是相同的

```
if !@ident_a_node.nil? or !@id.nil? 
```

这应该更清楚，为什么它不一样

```
if not @ident_a_node.nil? and not @id.nil? 
```

# c# - 在 Azure 上刷新 HttpRuntime.Cache

> ID：11143673
> 
> 赞同：4
> 
> 时间：2012-06-21T17:38:08.443
> 
> 标签：c#, asp.net, azure

有没有一种方法可以在 Azure 上刷新 HttpRuntime.Cache 而无需重新启动实例？

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-21T19:42:21.837

当您将项目添加到缓存时，您应该使用带有全局键的[CacheDependency添加它们。](http://msdn.microsoft.com/en-us/library/system.web.caching.cachedependency.aspx)这使您可以让您的项目在给定时间后过期，但也可以清除与此密钥链接的所有项目。

[这是清除所有项目（ CacheProvider.cs](http://www.marcwils.be.eu.org/posts/building-a-httpruntime-cache-that-supports-invalidation)）的方法的示例实现：

```
/// <summary>
/// Caching provider
/// </summary>
public static class CacheProvider
{
    const string CacheDependencyKey = "1FADE275-2C84-4a9b-B3E1-68ABB15E53C8";
    static readonly object SyncRoot = new object();

    /// <summary>
    /// Gets an item from cache. If the item does not exist, one will be
    /// created and added to the cache.
    /// </summary>
    /// <param name="key">Caching key</param>
    /// <param name="valueFactory">Function to create the item of it does not exist in the cache.</param>
    /// <param name="expiresAfter">Time after the item wille be removed from cache.</param>
    public static TValue GetOrAdd<TValue>(string key, Func<TValue> valueFactory, TimeSpan expiresAfter)
    {
        object itemFromCache = HttpRuntime.Cache.Get(key);
        if (itemFromCache == null)
        {
            lock (SyncRoot)
            {
                itemFromCache = HttpRuntime.Cache.Get(key);
                if (itemFromCache == null)
                {
                    TValue value = valueFactory();
                    if (value != null)
                    {
                        if (HttpRuntime.Cache[CacheDependencyKey] == null)
                            HttpRuntime.Cache[CacheDependencyKey] = string.Empty;

                        HttpRuntime.Cache.Add(key, value, new CacheDependency(null, new string[] { CacheDependencyKey }), DateTime.Now.Add(expiresAfter), Cache.NoSlidingExpiration, CacheItemPriority.Normal, null);
                    }
                    return value;
                }
            }
        }
        return (TValue)itemFromCache;
    }

    /// <summary>
    /// Invalidate all the items from the cache.
    /// </summary>
    public static void InvalidateCache()
    {
        HttpRuntime.Cache.Remove(CacheDependencyKey);
    }
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-21T21:50:09.577

```
public void Clear()
{
   var itemsToRemove = new List<string>();

   var enumerator = HttpContext.Current.Cache.GetEnumerator();
   while (enumerator.MoveNext())
   {
      itemsToRemove.Add(enumerator.Key.ToString());
   }

   foreach (string itemToRemove in itemsToRemove)
   {
      HttpContext.Current.Cache.Remove(itemToRemove);
   }
} 
```

# profiling - How to make simple profiling tool for OpenCL programs?

> ID：11143675
> 
> 赞同：0
> 
> 时间：2012-06-21T17:38:13.723
> 
> 标签：profiling, opencl

I have a task to make a **simple** profiling tool (winOS) for performance/timing/event analysis of OpenCL programs. Can someone give advice how to start?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-22T01:29:52.727

The simplest one and works accurately on all platforms:

```
 cl_event perfEvent;
  cl_ulong start=0, end=0;
  float t_kernel;

  /* Enqueue kernel */
  clEnqueueNDRangeKernel(commandQueue, kernel, 1, NULL, globalWorkSize, localWorkSize, 0, NULL, &perfEvent);
  clWaitForEvents( 1, &perfEvent );

  /* Get the execution time */
  clGetEventProfilingInfo(perfEvent, CL_PROFILING_COMMAND_START, sizeof(cl_ulong), &start, NULL);
  clGetEventProfilingInfo(perfEvent, CL_PROFILING_COMMAND_END, sizeof(cl_ulong), &end, NULL);
  t_kernel = (end-start)/1000000.0f;
  std::cout << t_kernel << std::endl; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-05-25T10:45:38.987

Take a look at [AMD CodeXL](http://developer.amd.com/tools-and-sdks/opencl-zone/codexl/). It's free and it might be just what you are looking for. Inside CodeXL, use the Application Timeline Trace mode (Profile -> Application Timeline Trace), which executes a program and generates a visual timeline that displays OpenCL events like kernel dispatch and data transfer operations.

# forms - OpenERP建模/视图：相关对象内联

> ID：11143678
> 
> 赞同：1
> 
> 时间：2012-06-21T17:38:15.957
> 
> 标签：forms, view, model, openerp

我已经安装了内置的 OpenERP 6.1 模块 crm。

因此，我现在有 res.lead 处于活动状态并且在“销售->机会”中可见。

我想编辑此对象/视图以显示合作伙伴的帐单邮寄地址。

由于我想在 Opportunities 表单上执行此操作，因此已经有一个 partner_id。

复制另一个模块，我这样定义我的新模块：

```
class crm_lead(osv.osv):
    _name = _inherit = 'crm.lead'
    _columns = {
    'billing_address_id': fields.many2one('res.partner.address', 'Partner Billing Address', domain="[('partner_id','=',partner_id),('type','in',['invoice', 'default'])]"),
    } 
```

我将 update_xml 更改为：

```
 <record model="ir.ui.view" id="crm_case_form_view_oppor">
        <field name="name">Opportunity form (inherit)</field>
        <field name="model">crm.lead</field>
        <field name="inherit_id" ref="crm.crm_case_form_view_oppor"/>
        <field name="arch" type="xml">
            <data>
                <separator string="Details" position="replace" />
                <field name="description" position="replace">
                    <group colspan="2" col="4">
                        <separator colspan="4" string="Billing" />
                        <field widget="one2many_list" mode="form,tree" name="billing_address_id" colspan="4" nolabel="1" />
                    </group>
                    <group colspan="2" col="4">
                        <separator colspan="4" string="Details" />
                        <field name="description" nolabel="1" colspan="4" />
                    </group>
                </field>
            </data>
        </field>
    </record> 
```

问题是相关对象显示了所有相关字段（正如我猜想的那样）。特别是，它显示了 partner_id 和 company 字段，我想隐藏它们，因为它们应该默认/继承于此机会（或链接的合作伙伴）。

如何隐藏这些字段？我不能简单地添加一堆“相关”字段，因为可能有多个帐单地址。

谢谢您的帮助！

* * *

编辑：为了更清楚，一个机会应该只有一个选择的账单地址，从合作伙伴的发票/默认地址中选择。它应该内联显示，以便于编辑。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-21T17:57:03.207

有几种方法可以像这样[指定相关字段的视图](http://doc.openerp.com/v6.1/developer/03_modules_3.html#specify-views-for-related-fields)。您可以像这样使用上下文：

```
<field 
    name="order_line" 
    colspan="4" 
    nolabel="1"
    context="{'form_view_ref': 'module.view_id', 'tree_view_ref': 'model.view_id'}"/> 
```

您还可以将子记录的整个视图指定[为父](http://doc.openerp.com/v6.1/developer/03_modules_3.html#using-subviews)视图中的子视图，如下所示：

```
 <!-- <=== order_line is a one2many field -->
    <field name="order_line" colspan="4" nolabel="1">
        <form>
            <field name="qty"/>
            ...
        </form>
        <tree>
            <field name="qty"/>
            ...
        </tree>
    </field> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-22T00:15:59.330

好的，我有点困惑，因为您将 one2many 小部件放在 many2one 字段上。

如果要控制 one2many 字段的显示方式，请使用我在[其他答案](https://stackoverflow.com/a/11143997/4794)中提到的子视图或上下文方法。

如果您想控制一个 many2one 字段的显示方式，您可能可以使用相关字段从您选择的记录中提取字段，但我对此表示怀疑。只读可能有效，但我认为编辑多个相关字段并能够更改所选记录没有意义。您也许可以将一些功能字段与可让您写回相关记录的存储功能组合在一起，但它似乎真的会让您的用户感到困惑。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-22T04:37:27.497

## 在任何 OE 关系字段上，您可以定义内部视图，如：

```
 <field name=""  mode="tree,form">
        <!--Internal tree view for your Relation field model-->
        <tree>
        </tree>

        <!--Internal Form view for your Relation field model-->
        <form>
        </form>
  </field> 
```

插件下[的示例 1 单击示例](http://bazaar.launchpad.net/~openerp/openobject-addons/trunk/view/head:/marketing_campaign/marketing_campaign_view.xml#L271) [2 单击查看示例](http://bazaar.launchpad.net/~openerp/openobject-addons/trunk/view/head:/marketing_campaign/marketing_campaign_view.xml#L287)

希望对你有帮助，。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-22T05:12:54.783

现在，如果你想在你的 m2o 文件上添加特定的细节，那么我们还有一些可选的方法，你必须在`def name_get`你的关系模型中，namge 看起来像：

```
name_get(cr, user, ids, context=None)
   Returns the preferred display value (text representation) for the records with 
   the given ids. By default this will be the value of the name column, unless the
   model implements a custom behavior. Can sometimes be seen as the inverse function
   of name_search(), but it is not guaranteed to be.

   Rtype :  list(tuple)
   Return : list of pairs (id,text_repr) for all records with the given ids. 
```

因此，在此方法中，您可以决定要显示关系字段的字符串。 [例子](http://bazaar.launchpad.net/~openerp/openobject-server/trunk/view/head:/openerp/addons/base/res/res_partner.py#L40)

我猜这将部分解决您的问题。

# google-apps-script - 是否可以在 Google Apps 脚本中执行 ImportRange？

> ID：11143684
> 
> 赞同：7
> 
> 时间：2012-06-21T17:38:43.053
> 
> 标签：google-apps-script, google-sheets

我今天一直在玩 Google Apps Script，我正在尝试编写一些自定义电子表格函数。我进行了一些搜索，但找不到我的查询的答案。

我知道在 Google 电子表格上，您可以在电子表格的单元格中使用 ImportRange，如下所示：

```
=ImportRange(spreadsheet_key;sheet!range_of_cells) 
```

我的问题是是否可以在 Google Apps 脚本中执行类似的操作，如果可以，如何操作？

我想从另一个电子表格上的工作表中导入一系列单元格（而不是脚本所在的电子表格上的工作表）。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-21T18:07:17.457

是的，这是完全可能的。您只需要调用`SpreadsheetApp.openById`然后正常获取所需的工作表和范围。

请查看[文档](https://developers.google.com/apps-script/class_range)：`range.getValues()`并且`range.setValues()`是非常基本的 GAS 方法，并且描述得很好。

阅读[教程](https://developers.google.com/apps-script/guide_common_tasks)。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2015-07-01T21:23:55.153

Google 似乎以其无限的智慧改变了 openById 和类似函数的行为。在自定义函数的上下文中不再允许使用它们。

有关更多详细信息，请参阅[https://code.google.com/p/google-apps-script-issues/issues/detail?id=5174](https://code.google.com/p/google-apps-script-issues/issues/detail?id=5174)。

他们建议使用 IMPORTRANGE 作为解决方法，但如前所述，这需要在单元格内调用。

我们的解决方案是在工作表中使用 IMPORTRANGE，并将获取的数据传递到我们的自定义函数中，因为数据集很小。我希望这个信息帮助！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-28T08:34:05.183

我最近需要这样做。这就是我想出的，简单地将电子表格键和范围硬编码到ahab的`myImportRange`函数中

```
// to be used in the spreadsheet like so:  = myScriptedImportRange( GoogleClock() )
// no need to include key or range because they are in the script here
// 
// the third parameter - GoogleClock() - triggers an automatic update every minute.
// updated 2011-07-17 (ahab): better regex to strip sheetname of *outer* single quotes
// updated 2013-01-27 (ben) to hard-code key and range 
function myScriptedImportRange(  ) { 
 var key = "PUT YOUR DATA_SPREADSHEET_ID IN HERE"
 var sheetrange = "PUT YOUR SHEET AND CELL RANGE IN HERE"
 var shra = sheetrange.split("!") ;
 if (shra.length==1) shra[1]=shra[0], shra[0]="";  

 var sheetstring = shra[0].replace( /^'(.*)'$/g , "$1") // was: replace( /'/g , "") ; updated 2011-07-17 (ahab)
 var rangestring = shra[1] 

 var source = SpreadsheetApp.openById( key )    
 if ( sheetstring.length==0 ) sheet = source.getSheets()[0] ;
 else sheet = source.getSheetByName( sheetstring ) ;

 return  sheet.getRange( rangestring ).getValues(); 
} 
```

在我的情况下，我有一组私有工作表，一个中间工作表使用常规`myImportRange`和 VMERGE 与一些 SQL 将私人工作表中的选择组合到中间工作表中，然后是一个公共工作表，它只有一个单元格包含`= myScriptedImportRange( GoogleClock() )`

请注意，这里有类似的方法：[https ://stackoverflow.com/a/11857014](https://stackoverflow.com/a/11857014)

另请注意，`ImportRange`当源工作簿打开/未打开时，该功能和相关功能通常会出现不显示导入数据的问题。此处的评论中描述了一种简单的解决方法：[https ://stackoverflow.com/a/11786797](https://stackoverflow.com/a/11786797)

# javascript - 如何让 javascript 单例通过 $.post 返回数据？

> ID：11143686
> 
> 赞同：0
> 
> 时间：2012-06-21T17:38:48.940
> 
> 标签：javascript, jquery, ajax

我想在单例上创建一个方法，`dp.DatapodManager`以便它通过 $.post 加载一次数据，然后我可以通过调用单例上的方法来使用该数据。

以下代码的输出是：

```
111

222
test data 
```

我必须做什么才能`dp.DatapodManager.loadDirectly();`将文本文件的内容添加到`div#content`？

![在此处输入图像描述](../Images/43fb953713e7dc283a5351e31c68adc0.png)

```
<html>
    <head>
        <title>test load</title>
        <script type="text/javascript" src="js/jquery-1.7.2.min.js"></script>
        <script type="text/javascript">
            $(document).ready(function() {
                $('div#content').append('<p>1111</p>');
                $('div#content').append('<p>222</p>');
                $('div#content').append(dp.DatapodManager.getTestData());
                dp.DatapodManager.loadDirectly(function(html) {
                    $('div#content').append(html);
                });
            });

            var dp = dp || {
                VERSION : '0.00.05'
            };

            dp.DatapodManager = (function() {
                return {
                    loadDirectly: function(callback) {
                        dp.qsys.loadDataFromExternalWebsite(function(stringBlock) {
                            var lines = dp.qstr.convertStringBlockToLines(stringBlock);
                            var html = dp.qstr.appendBrToLines(lines);
                            callback(html); //never executes, cannot set breakpoint here in firebug
                        });     
                        callback('<p>this is returned</p>');
                    },
                    getTestData: function() {
                        return 'test data';
                    }
                }
            }());

            dp.qsys = {
                loadDataFromExternalWebsite : function(callback) {
                    url = 'http://localhost/webs/dpjs/data/data.txt';

                    var json = '';
                    (function() {
                        var json = null;
                        $.post(url, {}, function(jsonString) {
                            callback(jsonString);
                        });

                        return json;
                    })();
                }
            };

            dp.qstr = {
                convertStringBlockToLines: function(block, trimLines) {
                    var trimLines = trimLines || true;
                    var lines = block.split(dp.qstr.NEW_LINE());
                    if(trimLines && lines.length > 0) {
                        for(x=0; x<lines.length; x++) {
                            lines[x] = lines[x].trim(); 
                        }
                    }
                    return lines;
                },

                NEW_LINE: function() {
                    return '\r\n';
                }, 

                appendBrToLines: function(lines) {
                    var r = '';
                    if(lines.length > 0) {
                        for(x=0; x<lines.length; x++) {
                            r += lines[x] + '<br/>';
                        }
                    }
                    return r;
                }
            };

        </script>
    </head>
<body>
    <div id="content"></div>

</body>
</html> 
```

# git - 如何将我的代码推送到 github fork

> ID：11143688
> 
> 赞同：2
> 
> 时间：2012-06-21T17:38:58.990
> 
> 标签：git, github, push, pull

我是 github 的新手。我一直在研究从 github 获取的代码。现在我完成了我的修改，我想将我的代码推送到 github。我想为我处理的原始代码创建一个分支，并将我开发的代码推送到该分支上。然而，当我从事开发工作时，原始代码发生了一些变化。因此，当我尝试将新代码推送到 fork 时，出现以下错误：

```
git push original master 
To https://github.com/<username>/<projectName>.git
 ! [rejected]        master -> master (non-fast-forward)
error: failed to push some refs to 'https://github.com/<username>/<projectName>.git'
To prevent you from losing history, non-fast-forward updates were rejected
Merge the remote changes (e.g. 'git pull') before pushing again.  See the
'Note about fast-forwards' section of 'git push --help' for details. 
```

然后我用

```
git pull 
```

输出以下内容：

```
Pull is not possible because you have unmerged files.
Please, fix them up in the work tree, and then use 'git add/rm <file>'
as appropriate to mark resolution, or use 'git commit -a'. 
```

我不能从这一点上继续。我应该怎么做才能提交我的项目？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-21T17:52:28.547

好吧，git 告诉你该怎么做。如果你想拉，你需要先完成不完整的合并。 `Git status`应该告诉您哪些文件尚未合并。您需要解决合并冲突，然后`git add`在文件上使用以告诉 git 冲突已解决。

话虽如此，如果您的目标是完成一个分支，您应该首先分支代码，克隆分支代码，对其进行修改，然后将您的更改推送回分支。完成后，您可以向原始项目的作者提交拉取请求以集成您的更改。

* * *

## 回答 #2

> 赞同：-5
> 
> 时间：2012-06-21T19:04:15.503

[危险] 如果您在团队中工作，请勿尝试

试试这个。

```
git push -f original master 
```

总是节省一天...

# mysql - MySQL 文档说明；触发访问另一个表

> ID：11143689
> 
> 赞同：0
> 
> 时间：2012-06-21T17:38:59.837
> 
> 标签：mysql, triggers

这是否意味着如果我使用 MySQL < 5.0.10，我无法从触发器更新另一个表

[MySQL 文档：](http://dev.mysql.com/doc/refman/5.0/en/create-trigger.html)

> 注意 在 MySQL 5.0.10 之前，触发器不能包含按名称直接引用表。从 MySQL 5.0.10 开始，您可以编写触发器，例如本例中显示的名为 testref 的触发器...

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-21T18:15:50.180

这是对的。[此常见问题解答](http://dev.mysql.com/doc/refman/5.0/en/faqs-triggers.html#qandaitem-B-5-1-9)以一种不那么含糊的方式陈述了这一事实：

> MySQL 5.0.10之前，一个触发器不能修改其他表

请注意，v5.5 和 v5.6 中仍然存在[以下限制：](http://dev.mysql.com/doc/refman/5.6/en/faqs-triggers.html#qandaitem-B-5-1-9)

> 触发器 (...) 不允许修改已被调用函数或触发器的语句使用（用于读取或写入）的表。

# authentication - 如何使用 WSS4j 通过 usernameToken 记录服务器成功和不成功的 Web 服务身份验证尝试

> ID：11143692
> 
> 赞同：0
> 
> 时间：2012-06-21T17:39:23.773
> 
> 标签：authentication, cxf, ws-security, wss4j

如何使用 WSS4j 通过 usernameToken 登录服务器成功和不成功的 Web 服务身份验证尝试？据我了解，检查登录/密码是否符合 WSS4j 内部，如果身份验证成功，则调用 Web 服务的方法，否则根本不调用

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-25T19:32:04.977

使用用户名令牌有两种情况：

纯文本密码和密码摘要。

在纯文本密码情况下，您可以完全控制请求的身份验证。这是因为，身份验证是由您作为开发人员提供的回调处理程序实现执行的。回调处理程序实现将根据您的实现根据存储的值对传入的用户名/密码对进行身份验证。因此，您将能够记录成功和不成功的尝试。

但是，在密码摘要情况下，回调处理程序由您实现，以向 WSS4J 提供传入用户名的密码。在这种情况下，WSS4J 计算密码摘要值并进行身份验证。在这种情况下，您没有上述控制权来在回调处理程序中记录结果。

# ssas - 在 SSAS 中创建层次结构有什么好处？

> ID：11143694
> 
> 赞同：3
> 
> 时间：2012-06-21T17:39:29.577
> 
> 标签：ssas

在 SSAS 中创建层次结构有什么好处？在浏览器上拖放年份，月份和单个层次结构有什么区别？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-26T12:24:41.057

主要是：

*   聚合：如果您想要每年的总和并且每月有聚合，SSAS 将汇总所有每月的汇总，而不是汇总该特定年份的所有值

*   在某种层次结构中添加大维度并将 AttributeHierarchyVisible 属性设置为 false 是 Microsoft 的最佳实践，因此可以通过层次结构而不是单独浏览该属性。这可以防止用户将具有 100 万行的属性拖动到多维数据集，这会破坏它

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-23T00:33:23.203

创建层次结构的优点是您为用户（多维数据集用户）提供了一个预定义的层次结构，该层次结构对所有用户都是通用的。您将为他们节省大量时间，而不必每次都拖放 3 - 4 个成员。此外，如果您正在使用 PPS 或任何其他报告层，您的过滤器可以直接在层次结构上工作，为用户提供 1 个具有向下钻取选项的过滤器，而不是让他们从 3 到 4 个过滤器中进行选择。最后，如果您使用 PPS，层次结构将允许用户在 PPS 图表中执行自动向下钻取。

这些只是层次结构的一小部分好处，还有一些与聚合性能相关的好处，在使用日期层次结构和创建自定义度量时具有更大的灵活性。

# cmyk - 在 cmyk 中计算白色

> ID：11143695
> 
> 赞同：0
> 
> 时间：2012-06-21T17:39:31.197
> 
> 标签：cmyk

我想计算 cmyk 颜色的覆盖率 + 白色的覆盖率。我只是不知道如何计算白色。

如果 c、m、y 和 k 从 0 变为 1，则为白色：

`w = 1 - (c+m+y+k/4)`

或者是：

`w = 1- c-m-y-k` （并且钳位为 0 或更高，所以它不会减去一些东西）

还是比那更复杂？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-21T18:03:21.267

在 CMYK 的一个“标准定义”中，从 RGB 转换如下：

```
K=min(R,G,B)
C=(1-R-K)/(1-K)
M=(1-G-K)/(1-K)
Y=(1-B-K)/(1-K) 
```

我认为颜色中的白色水平只是 W = 1-K，但我不完全确定这是否是你要问的......

# ruby - Rails：来自 Lib 的类方法助手

> ID：11143696
> 
> 赞同：0
> 
> 时间：2012-06-21T17:39:33.410
> 
> 标签：ruby, ruby-on-rails-3

抱歉，标题可能不是很清楚。基本上，我在 lib/ab_feature/ab_feature.rb 中有一个名为 ABFeature 的 Split gem 包装器

在我看来，我希望能够像这样称呼我的助手：

```
ABFeature.current_settings 
```

但这不起作用，这是我遇到的错误：

```
undefined local variable or method `session' for ABFeature:Module 
```

session 是 ActionController 的一种方法，似乎我无法访问它...

这是我的代码：

```
require 'split'

module ABFeature
  class << self
    include Split::Helper

    def current_settings
      ...
    end
  end
end

class ActionController::Base
  ActionController::Base.send :extend, ABFeature
end 
```

有什么想法吗？，格雷格

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-21T18:26:05.180

我不确定结果应该是什么，但如果你想在控制器中使用 current_settings 方法，我认为你可以做到

```
module ABFeature
  include Split::Helper

  def current_settings
  end
end 
```

接着

```
class ApplicationController < ActionController::Base
  include ABFeature
end 
```

我认为您通常将助手称为实例方法。然后他们应该与控制器共享上下文。

# javascript - 如何将正则表达式作为函数参数传递

> ID：11143702
> 
> 赞同：9
> 
> 时间：2012-06-21T17:39:44.577
> 
> 标签：javascript, regex

为什么这会返回 false 而不是 true。

```
function doit(expression) {

    var regex = new RegExp(expression, 'g');

    alert(regex.test('mename@memail.com'));
}

doit("/^\w+([-+.\']\w+)*@\w+([-.]\w+)*\.\w+([-.]\w+)*/");
​ 
```

[http://jsfiddle.net/hAV8Q/](http://jsfiddle.net/hAV8Q/)

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-06-21T17:41:33.120

正确格式化您的表达式：

```
function doit(expression) {
    var regex = new RegExp(expression, 'g');
    alert(regex.test('mename@memail.com'));
}

doit("^\\w+([-+.\\']\\w+)*@\\w+([-.]\\w+)*\\.\\w+([-.]\\w+)*");
// no / here, escape \ 
```

或直接传递表达式：

```
function doit(expression) {
    alert(expression.test('mename@memail.com'));
}

doit(/^\w+([-+.\']\w+)*@\w+([-.]\w+)*\.\w+([-.]\w+)*/g); 
```

​</p>

* * *

斜杠 ( `/`) 不是表达式的一部分，它们表示*正则表达式文字*。如果使用包含表达式的字符串，则必须省略它们并转义每个反斜杠，因为反斜杠也是字符串中的转义字符。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-21T17:42:18.733

因为在使用 创建正则表达式时`new RegExp()`，您不使用分隔符。`/`从字符串之前和之后删除。

或者，通过删除前后的引号来传递正则表达式本身，并省略`new RegExp()`调用。

# ssh - 在 Amazon EC2 中使用基于 Java 的 (SSH) 客户端连接时连接超时

> ID：11143706
> 
> 赞同：1
> 
> 时间：2012-06-21T17:39:58.113
> 
> 标签：ssh, amazon-ec2, amazon-web-services

我是服务器的新手。我正在尝试使用[Connect Using a Java-Based (SSH) Client](http://docs.amazonwebservices.com/AWSEC2/latest/UserGuide/AccessingInstancesLinux.html#connect-from-browser_steps)连接到 Amazon EC2 微实例，但出现错误`Connection timed out`，如下图所示。

![在此处输入图像描述](../Images/a0d4c0202e9e59bdf5fbcf2320e1c52f.png)

此外，只有当我尝试通过无线互联网连接进行 SSH 时，我才会收到超时消息，以防有线连接可以通过 SSH 连接到实例。

我无法归零错误在哪里？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-11T16:33:05.343

我想出了这里的问题。您必须[在与您尝试连接的实例关联的安全组中允许您的特定 IP 地址或 IP 地址范围用于入站 SSH 流量](http://docs.amazonwebservices.com/AWSEC2/latest/UserGuide/using-network-security.html#adding-security-group-rule)。[使用您的 IP 地址（或 IP 地址范围）和相应的CIDR 子网掩码](http://doc.m0n0.ch/quickstartpc/intro-CIDR.html)为 SSH 创建一个新的入站 TCP 规则，之后您应该能够使用 Java SSH 或任何 SSH 客户端进行连接。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-21T21:09:31.577

您是否有可用于尝试连接到实例的本地 SSH 客户端？如果是这样，那行得通吗？

您是否记得确保允许您的 IP 地址（或网络块）向您刚刚部署的实例的安全组中的 TCP 端口 22 发送流量？您可以通过从 EC2 工具包运行“ec2-describe-group”命令来检查这一点，或者使用亚马逊的控制台并前往 EC2 -> 安全组并查看分配给该实例的安全组。

# asp.net - 如何将“IHtmlString”更改为“MvcHtmlString”？

> ID：11143707
> 
> 赞同：1
> 
> 时间：2012-06-21T17:40:00.193
> 
> 标签：asp.net, asp.net-mvc-3

目前我正在编写 2 个辅助方法来扩展我使用“IHtmlString”的实现，如何使用“MvcHtmlString”将其转换为一种方法？帮助...

```
public static IHtmlString ExceptionValidationSummary(this HtmlHelper helper)
    {
        const string template = "<div class=\"ui-widget\"><div class=\"ui-state-error ui-corner-all\" style=\"padding:0 .7em\"><div>" +
                                "<span class=\"ui-icon ui-icon-alert\" style=\"float: left; margin-right: .3em;\"></span>" +
                                "<strong>Validation Exceptions:</strong></div><div style=\"margin-top: 5px;\"> " + 
                                "<ul style=\"font-weight: normal;\">{0}</ul></div></div></div>";

        StringBuilder exceptionList = new StringBuilder();

        // Iterate through the exceptions
        foreach (var error in helper.ViewData.ModelState.SelectMany(modelState => modelState.Value.Errors))
        {
            exceptionList.Append(string.Format("<li>{0}</li>", error.ErrorMessage));
        }

        return exceptionList.Length.Equals(0) ? string.Format("").Raw() : string.Format(template, exceptionList).Raw();

    }

    public static IHtmlString Raw(this string value)
    {
        return new HtmlString(value);
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-26T20:10:47.123

虽然我希望该`StringBuilder.ToString()`方法被隐式调用`string.Format()`，但如果没有发生这种情况，请`ToString()`像这样显式调用该方法：

```
string.Format(template, exceptionList.ToString()) 
```

此外，您的方法被声明为返回一个`IHtmlString`. 如果您将签名更改为 use `MvcHtmlString`，这将告诉编译器您想要的返回类型。此时，只需确保返回值与更新后的声明匹配即可：

```
return MvcHtmlString.Create(string.Format(template, exceptionList.ToString())); 
```

# c# - C# 中的卷影复制 (VSS) 示例？

> ID：11143710
> 
> 赞同：3
> 
> 时间：2012-06-21T17:40:07.627
> 
> 标签：c#, .net, api, volume-shadow-service

我在[这里](https://stackoverflow.com/questions/6673826/how-to-use-volume-shadow-copy-using-c-sharp-in-vs2008)看到了这个问题，但是我很难理解如何实现一个系统来从我的系统中读取现有的卷影副本。

有人可以提供一个简短的代码示例，让我使用 MS API 或 Alpha 浏览现有的卷影副本吗？

仅供参考 -[这是较旧的代码](http://alphavss.codeplex.com/workitem/8328)，不容易适应（或者至少从我的角度来看不是）

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-20T02:19:25.407

使用[AlphaVSS](https://github.com/alphaleonis/AlphaVSS)。它是 Windows API 调用的包装器。特别是，“QuerySnapshots”功能将适用于您。

为了查看您需要下载 AlphaVSS 的文档——别担心，它是免费的。

如果您正在寻找示例，请下载源代码并查看`Alpha-1.2\Source\Samples`

# eclipse - 将“打开文件”按钮添加到 Eclipse 工具栏

> ID：11143715
> 
> 赞同：0
> 
> 时间：2012-06-21T17:40:43.913
> 
> 标签：eclipse, customization, toolbar

我知道您可以通过编写自定义插件向 Eclipse 工具栏添加新按钮，但我将如何像大多数编辑器一样添加一个简单的“打开文件”按钮？

我想我可以用它作为模板来做我想做的事，但是“打开文件对话框”的 commandId 是什么：

[如何在 Eclipse 的工具栏上添加撤消/重做按钮？](https://stackoverflow.com/questions/819846/how-to-add-undo-redo-buttons-to-toolbar-in-eclipse)

谢谢你！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-21T19:13:32.797

如果您想要一个工具栏按钮来模仿菜单 File->Open File... 的行为，那么您正在搜索命令 id

```
org.eclipse.ui.edit.text.openLocalFile 
```

您希望使用它来代替示例中撤消/重做的命令 ID。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-21T18:52:36.093

我不相信您可以在工具栏或菜单中使用用于打开文件对话框的特定 commandId。您必须创建一个实现`IHandler`接口的类并使用类似的东西`JFileChooser`来处理文件的选择。

# php - 替换php中的多字节utf8字符

> ID：11143717
> 
> 赞同：1
> 
> 时间：2012-06-21T17:40:45.870
> 
> 标签：php, utf-8, replace, multibyte

我正在尝试将 UTF 中欧元的多字节字符（在我的 html 中显示为 â¬）preg_replace 为“$”，将 * 替换为“@”

```
$orig = "2 **** reviews  â¬ 19,99 price";
$orig = mb_ereg_replace(mb_convert_encoding('&#x20ac;', 'UTF-8', 'HTML-ENTITIES'), "$", $orig);
$orig = preg_replace("/[\$\;\?\!\{\}\(\)\[\]\/\*\>\<]/", "@", $orig);
$a = htmlentities($orig);
$b = html_entity_decode($a); 
```

“*”被替换，但“â¬”没有被替换......

也尝试将其替换为

```
$orig = preg_replace("/[\xe2\x82\xac]/", "$", $orig); 
```

也不转换....

另一个不起作用的计划：

```
$orig= mb_ereg_replace(mb_convert_encoding('&#x20ac;', 'UTF-8', 'HTML-ENTITIES'), "$", $orig); 
```

Brrr 有人知道如何摆脱这个 utf8 欧元字符：

```
echo html_entity_decode('&euro;'); 
```

（使我抓狂）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-21T19:14:49.443

这可能是由两个原因造成的：

1.  实际的源文本是 UTF8 编码的，但您的 PHP 代码不是。您可以通过使用这一行来解决这个问题并保存您的文件 UTF8 编码（尝试使用记事本++）。

    str_replace('€', '$', $source);

2.  源文本已损坏：多字节字符被转换为 latin1（错误的数据库字符集？）。您可以尝试将它们转换回 latin1：

    str_replace('€', '$', utf8_decode($source))

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-21T18:23:44.587

在此处粘贴我的评论作为答案，以便您标记它！

不会

```
str_replace(html_entity_decode('&euro;'), '$', $source) 
```

工作？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-20T16:32:36.630

# c# - SQL 数据库 VS。多个平面文件（数千个小 CSV）

> ID：11143724
> 
> 赞同：5
> 
> 时间：2012-06-21T17:41:10.173
> 
> 标签：c#, sql-server, database, c++-cli, flat-file

我们正在设计对当前系统（C++\CLI 和 C#）的更新。该系统将从约 10K 设备（在不久的将来）收集少量（约 1Mb）数据。目前，它们用于将设备数据保存在 CSV（表格）中，并将所有这些数据存储在一个宽文件夹结构中。

仅插入数据（创建/附加到文件，创建文件夹）从不更新/删除。数据处理是通过将许多 CSV 读取到外部程序（如 Matlab）来完成的。主要用于统计分析。

可以选择开始将此数据保存到 MS-SQL 数据库。处理时间（将 CSV 读取到外部程序）可能长达几分钟。

*   我们应该如何选择使用哪种方法？
*   其中一种方法是否比另一种方法占用更多的存储空间？
*   粗略地说，什么时候从数据库中读取原始数据比读取 CSV 更快？（10 个文件，100 个文件？...）

感谢您的回答，欢迎利弊。

感谢您的时间。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-21T17:48:37.110

好吧，如果您使用一个 CSV 中的数据来获取另一个 CSV 中的数据，我猜想 SQL Server 会比您想出的任何东西都要快。我怀疑 SQL Server 在大多数情况下会更快，但我不能肯定地说。Microsoft 已投入大量资源来制作一个完全符合您的要求的 DBMS。

根据您的描述，听起来您几乎已经根据表数据和文件夹结构创建了自己的 DBMS。我怀疑，如果您改用 SQL Server，您可能会发现许多领域的事情变得更快、更容易。

可能的优点：

*   更快的访问
*   更容易管理
*   如果您需要，更容易扩展
*   更容易实施数据完整性
*   更容易设计更复杂的关系

可能的缺点：

*   您将不得不重写现有代码以使用 SQL Server 而不是当前系统
*   您可能需要为 SQL Server 付费，您必须检查是否可以使用 Express

祝你好运！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-21T18:20:17.430

我想试着把这些问题打得有点乱。

> 粗略地说，什么时候从数据库中读取原始数据比读取 CSV 更快？（10 个文件，100 个文件？...）

立即地。数据库经过优化（假设您已完成作业）以惊人的速度读取数据。

> 其中一种方法是否比另一种方法占用更多的存储空间？

在您处理数以万计的文件之前，它可能不会有太大的不同。空间很便宜，对吧？但是，一旦您进入大联盟，您会注意到数据库占用的空间要少得多。

> 我们应该如何选择使用哪种方法？

好问题。数据库中的所有内容总是回归到可伸缩性。如果您只有一个 CSV 文件要读取，那么您就可以开始了。不需要数据库。几十个也没问题。

看起来您最终可能会扩展到您肯定希望数据库引擎很快支持您的数据的级别。如有疑问，创建数据库是安全的选择，因为您仍然可以在一秒钟内查询 100 GB 的数据。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-21T17:53:32.260

在我工作的地方，我们的许多客户都有这个问题。除非您需要现有基础架构的平面文件，或者您认为自己无法计算出 SQL Server，或者如果您只有几个文件需要管理少量数据，那么使用 SQL Server 会更好。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-21T17:57:02.837

如果您可以选择使用 ms-sql 数据库，我会这样做。

在宽文件夹结构中维护数据绝不是一个好主意。读取您的数据将涉及读取多个文件。这些可以存储在磁盘上的任何位置。您的文件 io 时间会非常长。作为生产数据库的 SQL 服务器已经解决了这些问题。

你在这里重新发明轮子。这就是 foxpro 管理数据的方式，每个表一个文件。除非您实际上是在制作数据库服务器，否则使用经过验证的技术通常是一个好主意。

我这里没有任何测试统计数据，但是如果您要处理大量数据，读取多个文件几乎总是比数据库慢。鉴于您大约有 10k 台设备，您应该考虑使用标准数据库。

# ruby - 在浏览器中进行 Ruby pdf 测试

> ID：11143735
> 
> 赞同：1
> 
> 时间：2012-06-21T17:41:43.980
> 
> 标签：ruby, testing, pdf, webdriver, watir

有没有人能够找到一种在浏览器中使用 ruby​​ 测试 pdf 的方法？我尝试了几种不同的方法，唯一能让任何 pdf 测试工作的方法是保存 pdf 并使用 pdf_reader gem。这似乎只适用于 pdf，当单击链接时，会打开一个对话框，其中包含打开或保存 pdf 的选项。不幸的是，我无法找到一种方法来使用在浏览器中打开的 pdf 执行类似的操作，并且没有对话框选项来保存它。有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-21T20:23:58.633

也许在浏览器中测试它不是最好的方法。当您说测试pdf时，您要做什么？如果我是你，我不会在浏览器中测试 pdf。

如果您想验证其内容， 请尝试[docsplit 。](http://documentcloud.github.com/docsplit/)`Docsplit is a command-line utility and Ruby library for splitting apart documents into their component parts: searchable UTF-8 plain text via OCR if necessary, page images or thumbnails in any format, PDFs, single pages, and document metadata (title, author, number of pages...)`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-22T11:01:42.507

您可以使用 gem 'mechanize' 在您的计算机上下载在线 PDF（浏览器中的 PDF），然后通过 gem PDF 阅读器阅读。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-22T01:23:22.600

您不是在发明浏览器或 PDF 生成器。

使用单元测试来检查您的后端模块是否可以接收数据，并写出 PDF，然后在网站中提供 PDF 并让浏览器完成它的工作。测试（Rails 称之为“功能测试”）MVC 将生成一个包含 PDF 链接的网页，然后您就完成了。

# mysql - 什么是 mysql 索引以及如何创建索引？

> ID：11143739
> 
> 赞同：0
> 
> 时间：2012-06-21T17:41:52.487
> 
> 标签：mysql

好的，mysql索引。索引仅仅是为将在 WHERE 子句中使用的每一行都有一个唯一的 ID 吗？

索引表时，该过程是否会向表中添加任何信息？例如，某处的另一列或值。

检索值时是否会即时进行索引，或者是否像插入或更新函数一样将值放入表中？

任何更多信息来清楚地解释 mysql 索引将不胜感激。并且请不要只放置指向 mysql 文档的链接，这会造成混淆，最好从专业人士那里获得个人回复。

最后，为什么索引不同于告诉 mysql 在两个值之间查找值。例如：WHERE create_time >= 'AweekAgo'

我问是因为我的一个表是 220,000+ 行，并且使用非常简单的 mysql select 语句返回值需要一分钟多的时间，我希望索引能够加快这一速度。

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-21T17:56:22.647

您被否决是因为您没有努力阅读或搜索您所要求的内容。[在 google 中进行一个简单的搜索就可以向您展示](http://en.wikipedia.org/wiki/Database_index)[Database Index](http://en.wikipedia.org/wiki/Database_index)的优点和缺点。这是[StackOverflow 上的一个相关问题](https://stackoverflow.com/questions/1108/how-does-database-indexing-work)。我相信有很多这样的问题。

为了简化行话，如果您根据专业领域排列书架，则在图书馆中查找书籍会更容易。你可以很容易地告诉某人去一个特定的位置并挑选这本书——这就是索引的作用

另一个例子：想象一个按字母顺序排列的录取名单。如果您的名字以 Z 开头，您将跳过 A 到 Y 并到达 Z - 更快？否则，你将不得不搜索和搜索，如果你不仔细看甚至可能找不到它

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-21T17:53:56.690

数据库索引是一种提高表中操作速度的数据结构。可以使用一列或多列创建索引，为快速随机查找和对记录访问的有效排序提供基础。

您可以像这样创建索引：

```
CREATE INDEX index_name
ON table_name ( column1, column2,...); 
```

您可能正在处理更复杂的数据库，因此最好记住一些简单的规则。

*   索引会减慢插入和更新速度，因此您希望在频繁更新的列上谨慎使用它们。

*   索引加速 where 子句和 order by。

有关更多详细信息，您可以阅读：

[http://dev.mysql.com/doc/refman/5.0/en/mysql-indexes.html](http://dev.mysql.com/doc/refman/5.0/en/mysql-indexes.html)

[http://www.tutorialspoint.com/mysql/mysql-indexes.htm](http://www.tutorialspoint.com/mysql/mysql-indexes.htm)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-21T17:57:23.300

有很多索引，例如哈希、trie、空间索引。这取决于价值。很可能它是哈希和二叉搜索树。没有什么真正花哨的东西，因为花哨的东西很可能很昂贵。

# android - Contact_ID ContactsContract.Contacts 列无效

> ID：11143740
> 
> 赞同：3
> 
> 时间：2012-06-21T17:41:53.290
> 
> 标签：android, cursor, android-contacts

当用户键入我的 android 应用程序时，我正在尝试使用以下代码来`AutoComplete`联系详细信息。

```
public class MakePayment extends Activity {
    private AutoCompleteTextView mAuto;

    /** Called when the activity is first created. */
    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.makepayment);

        mAuto = (AutoCompleteTextView)findViewById(R.id.autoCompleteTextViewTest);
        ContentResolver content = getContentResolver();
        Cursor cursor = content.query(ContactsContract.Contacts.CONTENT_URI,
                PEOPLE_PROJECTION, null, null, null);

        ContactListAdapter adapter = new ContactListAdapter(this, cursor);
        mAuto.setAdapter(adapter);
    }

     public static class ContactListAdapter extends CursorAdapter implements Filterable {
            public ContactListAdapter(Context context, Cursor c) {
                super(context, c);
                mContent = context.getContentResolver();
            }

            @Override
            public View newView(Context context, Cursor cursor, ViewGroup parent) {
                 final LayoutInflater inflater = LayoutInflater.from(context);
                    final TextView view = (TextView) inflater.inflate(
                            android.R.layout.simple_dropdown_item_1line, parent, false);
                    view.setText(cursor.getString(3));
                    return view;
            }        

            @Override
            public void bindView(View view, Context context, Cursor cursor) {
                ((TextView) view).setText(cursor.getString(3));

            }

            @Override
            public String convertToString(Cursor cursor) {
                return cursor.getString(3);
            }

            @Override
            public Cursor runQueryOnBackgroundThread(CharSequence constraint) {
                if (getFilterQueryProvider() != null) {
                    return getFilterQueryProvider().runQuery(constraint);
                }

                StringBuilder buffer = null;
                String[] args = null;
                if (constraint != null) {
                    buffer = new StringBuilder();
                    buffer.append("UPPER(");
                    buffer.append(ContactsContract.Contacts.DISPLAY_NAME);
                    buffer.append(") GLOB ?");
                    args = new String[] { constraint.toString().toUpperCase() + "*" };
                }

                return mContent.query(ContactsContract.Contacts.CONTENT_URI, PEOPLE_PROJECTION,
                        buffer == null ? null : buffer.toString(), args,
                        null);
            }

            private ContentResolver mContent;           
        }

     private static final String[] PEOPLE_PROJECTION = new String[] {
            ContactsContract.CommonDataKinds.Phone.CONTACT_ID,
            ContactsContract.CommonDataKinds.Phone.NUMBER,
            ContactsContract.CommonDataKinds.Email.DATA,
            ContactsContract.Contacts.DISPLAY_NAME,
        };

} 
```

但是我的应用程序关闭并出现以下错误：

```
06-21 10:33:26.970: E/AndroidRuntime(31086): FATAL EXCEPTION: main
06-21 10:33:26.970: E/AndroidRuntime(31086): java.lang.RuntimeException: Unable to start activity ComponentInfo{com.MyApp/com.MyApp.MakePayment}: java.lang.IllegalArgumentException: Invalid column contact_id
06-21 10:33:26.970: E/AndroidRuntime(31086):    at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1713)
06-21 10:33:26.970: E/AndroidRuntime(31086):    at android.app.ActivityThread.startActivityNow(ActivityThread.java:1541)
06-21 10:33:26.970: E/AndroidRuntime(31086):    at android.app.LocalActivityManager.moveToState(LocalActivityManager.java:127)
06-21 10:33:26.970: E/AndroidRuntime(31086):    at android.app.LocalActivityManager.startActivity(LocalActivityManager.java:339)
06-21 10:33:26.970: E/AndroidRuntime(31086):    at android.widget.TabHost$IntentContentStrategy.getContentView(TabHost.java:696)
06-21 10:33:26.970: E/AndroidRuntime(31086):    at android.widget.TabHost.setCurrentTab(TabHost.java:328)
06-21 10:33:26.970: E/AndroidRuntime(31086):    at android.widget.TabHost$2.onTabSelectionChanged(TabHost.java:134)
06-21 10:33:26.970: E/AndroidRuntime(31086):    at android.widget.TabWidget$TabClickListener.onClick(TabWidget.java:518)
06-21 10:33:26.970: E/AndroidRuntime(31086):    at android.view.View.performClick(View.java:2485)
06-21 10:33:26.970: E/AndroidRuntime(31086):    at android.view.View$PerformClick.run(View.java:9089)
06-21 10:33:26.970: E/AndroidRuntime(31086):    at android.os.Handler.handleCallback(Handler.java:587)
06-21 10:33:26.970: E/AndroidRuntime(31086):    at android.os.Handler.dispatchMessage(Handler.java:92)
06-21 10:33:26.970: E/AndroidRuntime(31086):    at android.os.Looper.loop(Looper.java:130)
06-21 10:33:26.970: E/AndroidRuntime(31086):    at android.app.ActivityThread.main(ActivityThread.java:3906)
06-21 10:33:26.970: E/AndroidRuntime(31086):    at java.lang.reflect.Method.invokeNative(Native Method)
06-21 10:33:26.970: E/AndroidRuntime(31086):    at java.lang.reflect.Method.invoke(Method.java:507)
06-21 10:33:26.970: E/AndroidRuntime(31086):    at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:840)
06-21 10:33:26.970: E/AndroidRuntime(31086):    at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:598)
06-21 10:33:26.970: E/AndroidRuntime(31086):    at dalvik.system.NativeStart.main(Native Method)
06-21 10:33:26.970: E/AndroidRuntime(31086): Caused by: java.lang.IllegalArgumentException: Invalid column contact_id
06-21 10:33:26.970: E/AndroidRuntime(31086):    at android.database.DatabaseUtils.readExceptionFromParcel(DatabaseUtils.java:167)
06-21 10:33:26.970: E/AndroidRuntime(31086):    at android.database.DatabaseUtils.readExceptionFromParcel(DatabaseUtils.java:137)
06-21 10:33:26.970: E/AndroidRuntime(31086):    at android.content.ContentProviderProxy.bulkQueryInternal(ContentProviderNative.java:372)
06-21 10:33:26.970: E/AndroidRuntime(31086):    at android.content.ContentProviderProxy.query(ContentProviderNative.java:408)
06-21 10:33:26.970: E/AndroidRuntime(31086):    at android.content.ContentResolver.query(ContentResolver.java:266)
06-21 10:33:26.970: E/AndroidRuntime(31086):    at com.MyApp.MakePayment.onCreate(MakePayment.java:28)
06-21 10:33:26.970: E/AndroidRuntime(31086):    at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1047)
06-21 10:33:26.970: E/AndroidRuntime(31086):    at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1677) 
```

它说无效列`contacts_id`。我在这里做错什么了吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-06-21T17:45:04.480

利用

```
 Cursor cursor = content.query(ContactsContract.CommonDataKinds.Phone.CONTENT_URI,
                PEOPLE_PROJECTION, null, null, null); 
```

代替

```
 Cursor cursor = content.query(ContactsContract.Contacts.CONTENT_URI,
                PEOPLE_PROJECTION, null, null, null); 
```

并查看[ContactsContract.Contacts](http://developer.android.com/reference/android/provider/ContactsContract.Contacts.html)的文档CONTACT_ID、NUMBER、DATA 和 DISPLAY_NAME 未归档，`ContactsContract.Contacts`这些都在[ContactsContract.CommonDataKinds](http://developer.android.com/reference/android/provider/ContactsContract.CommonDataKinds.html)

# php - 使用 PHP 从本地主机调用 LinkedIn oauth2

> ID：11143745
> 
> 赞同：-1
> 
> 时间：2012-06-21T17:42:11.110
> 
> 标签：php, oauth, linkedin

我正在尝试制作获取用户个人资料的 LinkedIn 插件。我为此目的使用 REST API，但是当我从 localhost 进行调用时，它显示以下错误

```
Simple-LinkedIn: library not compatible with installed PECL OAuth extension. Please disable this extension to use the Simple-LinkedIn library. 
```

请指导我。

[索引文件](http://pastebin.com/0Hmd1WMJ)

[oauth 文件](http://pastebin.com/nFWZMgG7)

在这两个文件中，仅更改了键值。

我在我的窗口 7 32 位上使用 XAMPP 服务器。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-21T20:39:01.947

你真的有两个选择。

首先，您可以按照上面消息中的建议，卸载与 Simple-LinkedIn 库冲突的 PECL oauth 模块。PECL 扩展可以通过以下方式卸载：

```
pecl uninstall xxx 
```

其中 xxx 是模块。

其次，您可以使用已安装的 oauth 模块进行 LinkedIn 调用。可以在 LinkedIn 开发人员网站上找到有关使用此库进行调用的详细信息：

[https://developer.linkedin.com/documents/reading-data#toggleview:id=php](https://developer.linkedin.com/documents/reading-data#toggleview%3aid=php) [https://developer.linkedin.com/documents/writing-linkedin-apis#toggleview:id=php](https://developer.linkedin.com/documents/writing-linkedin-apis#toggleview%3aid=php)

# vba - 如何使用 VBA 中的 format() 函数以 [h]:mm excel 格式格式化时间

> ID：11143746
> 
> 赞同：10
> 
> 时间：2012-06-21T17:42:13.467
> 
> 标签：vba, excel

是否可以使用 VBA 以 [h]:mm 格式格式化时间？

excel 中的 [h]:mm 格式将 25 小时显示为 25:00，将 125 小时显示为 125:00

我尝试了几件事，例如：

```
format(datetime, "[h]:mm")
format(datetime, "H:mm")
format(datetime, "hh:mm") 
```

这些都没有预期的效果。我还查看了 MS 帮助，但找不到任何有用的东西。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-06-21T20:48:33.867

通过应用程序对象使用 TEXT 工作表函数，如下所示：

```
 x = Application.Text(.294,"[h]:mm") 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-21T20:29:24.077

JFC 打败了我，但这就是我想出的……

```
Sub Test()
    Debug.Print FormatHM(24 / 24)       '24:00
    Debug.Print FormatHM(25 / 24)       '25:00
    Debug.Print FormatHM(48 / 24)       '48:00
    Debug.Print FormatHM(48.6 / 24) '48:36
End Sub

Function FormatHM(v As Double) As String
    FormatHM = Format(Application.Floor(v * 24, 1), "00") & _
                 ":" & Format((v * 1440) Mod 60, "00")

End Function 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-21T18:13:08.653

不使用格式功能，但您可以使用`Range(MyData).NumberFormat = "[h]:mm"`

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-21T20:19:33.863

看起来 VBA 的`Format`函数没有内置的方法来做到这一点。（翻白眼。）

这个自制的功能可以解决问题：

```
Function HoursAndMinutes(datetime As Date) As String
    Dim hours As Integer
    Dim minutes As Integer
    hours = Int(datetime) * 24 + Hour(datetime) ' the unit of Date type is 1 day
    minutes = Round((datetime * 24 - hours) * 60)
    HoursAndMinutes = hours & ":" & Format(minutes, "00")
End Function 
```

用法：

```
 Dim datetime As Date
    datetime = TimeSerial(125, 9, 0) ' 125 hours and 9 minutes
    Debug.Print HoursAndMinutes(datetime) ' 125:09 
```

# linux - Linux makefile 检查所需的最低 linux 内核版本

> ID：11143749
> 
> 赞同：1
> 
> 时间：2012-06-21T17:42:20.443
> 
> 标签：linux, makefile

我有一个需要在 2 个不同内核版本上编译的 linux makefile。makefile 不是从 automake/autoconf 生成的。

C 代码已经使用宏为不同的内核版本生成不同的代码，但是 makefile 中的某些功能也需要进行调节。

有没有办法在makefile中做：

```
if (kernel_version > 2.6.30)
    newer_kernel = 1
else
    newer_kernel = 0
endif 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-21T18:25:28.593

好吧，我可以想到一种使用 bash 的快速方法：

```
KERNEL_VERSION=`uname -r`
HIGHER_VERSION=`echo -e "$KERNEL_VERSION\n2.6.30" | sort -g -t '.' | tail --lines=1`
if [ "$HIGHER_VERSION" == "2.6.30" ]
   # its an older kernel
else
  # its a newer kernel
fi 
```

基本上，您使用 uname 获取当前内核的版本，然后将其与 2.6.30 使用`sort`（-g 标志启用数字排序，`-t '.'`意味着使用点作为字段分隔符）进行比较，然后使用 tail 确定两个版本中的哪一个在列表中更高。不完全是一个漂亮的解决方案，但它会起作用。

您可以将其放入单独的脚本或直接放入 makefile 配方

# javascript - 将选中的项目写入数组

> ID：11143750
> 
> 赞同：0
> 
> 时间：2012-06-21T17:42:24.087
> 
> 标签：javascript, jquery, asp.net, html

这些是我的许多复选框，我需要在保存时抓取选定的复选框并创建一个将被保存的数组/数字字符串。

```
<asp:CheckBox ID="4" runat="server" ClientIDMode="Static"/> 
```

我是否需要添加一个带有数字的值，以便我可以获得复选框的数字，以便我可以获得类似“1、4、8、9”（选中的复选框）之类的内容，或者我可以从 ID 中获取它吗？

我正在看这样的例子：

```
$(function(){
  $('#btnClick').click(function(){
    var val = [];
    $(':checkbox:checked').each(function(i){
      val[i] = $(this).val();
    });
  });
}); 
```

编辑：

有没有办法通过启动 ID 来专门获取复选框，而不是从页面中获取每一个复选框？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-21T17:46:21.720

您可以`.push`像这样在 Array 上使用：

```
val.push(this.id); 
```

这是一个例子：http: [//jsfiddle.net/dpMp2/3/](http://jsfiddle.net/dpMp2/3/)

或者

你可以这样做：

```
var val = $.makeArray($(':checkbox:checked')); 
```

有关信息`makeArray`可以在这里找到：http: [//api.jquery.com/jQuery.makeArray/](http://api.jquery.com/jQuery.makeArray/) *注意*如下`am not i am`所述，数组将是对象，您必须从每个 obj 获取 id 或值。阅读文档以获取更多信息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-21T17:46:57.053

我会用[`map`](http://api.jquery.com/jQuery.map/)

```
$(':checkbox:checked').map(function(){ return $(this).val(); }) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-21T17:48:55.960

由于 val 是一个对象，因此您必须使用`push`函数来分配数据。

```
$(function(){
  $('#btnClick').click(function(){
    var val = [];
    $(':checkbox:checked').each(function(i){
      val.push($(this).val());
    });
  });
}); 
```

# algorithm - 找出在 n 个不同数组中共有的最大元素？

> ID：11143760
> 
> 赞同：0
> 
> 时间：2012-06-21T17:43:10.213
> 
> 标签：algorithm

今天早些时候我问了类似的问题来找到两个数组中常见的最大元素。我在这里得到了几个很好的解决方案（[找到两个数组中常见的最大元素？](https://stackoverflow.com/questions/11141571/find-the-maximum-element-which-is-common-in-two-arrays)）。

现在我想到了，如果我们必须找到在 n 个不同数组中共有的最大元素而不是两个数组，该怎么办？

例子：

```
 array1 = [1,5,2,4,6,88,34]
 array2 = [1,5,6,2,34]
 array3 = [1,34]
 array4 = [7,99,34]

Here the maximum element which is common in all the arrays is 34. 
```

单独创建 array1, array2 ..... array(N-1) 的哈希图，然后检查每个哈希图中 arrayN 的每个元素，以跟踪最大元素（当存在于所有哈希图中)?

我们能有比这更好的解决方案吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-21T20:25:22.987

```
For each array A_n:
  Add all elements in A_n to a hashset, H_n

Create a hashmap, M, which maps values to counts.
For each hashset H_n:
  For each value, v, in H_n:
    M[v]++

Go through M for the highest value with count == N 
```

这将在 O(n) 时间和空间中运行，其中 n 是所有数组中元素的总数。它还可以正确处理在单个数组中重复的元素，您没有提到，但这可能会导致某些算法出现问题。如果您知道单个数组中不会有重复元素，则可以跳过第一步，直接从数组中向 M 添加值。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-21T17:46:27.997

hashmap 不利于跟踪最大元素。你想要的是一个最大堆或哈希集。

您创建 n 个最大堆并遍历其中的 n 个。您采用常见的最大元素。这可能很难实施。

另一种方法是找到所有集合的交集并从交集中获取最大值。在这种情况下，您可以使用 hashset。

# java - 管理 javadoc 以使用 jdk 1.7

> ID：11143762
> 
> 赞同：1
> 
> 时间：2012-06-21T17:43:14.537
> 
> 标签：java, linux, javadoc

我正在尝试生成用 java 7 编写的项目的文档。
我使用了 java 7 的东西，例如 try with resource 语句，当我尝试生成项目的文档时：

```
javadoc -d mydocks truckingCompany 
```

（truckingCompany 是包含所有 java 文件的目录）我得到很多语法错误。如果我尝试使用 javac 1.7 编译项目，我不会得到所有这些错误。所以我很确定这些错误是由于事实上，javadoc 仍在使用 javac 的 1.6 版本。如何更改版本？

PS：错误的一个例子是：

```
home/ramy/Desktop/./truckingCompany/TCUtil.java:175: not a statement
catch( IOException | ClassNotFoundException | ClassCastException e)
      ^ 
```

Java 7 中所有正确的东西。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-21T18:02:03.247

Javadoc 不是一个独立的程序，而是 Java 开发工具包 (JDK) 的一部分（它包含在 tools.jar 中。）也就是说，您需要将运行时环境更新为 Java 7 而不是 Java 6。

由于您正在运行 Linux，这*应该*像指向`/usr/bin/java`JDK 7一样简单。`java -version`应该返回 Java 7（或类似的）以表明这是正确的。

# sql - VBScript 和 SQL Server 2008 问题

> ID：11143764
> 
> 赞同：0
> 
> 时间：2012-06-21T17:43:27.710
> 
> 标签：sql, sql-server-2008, vbscript

所以我对 SQL 或 VBScript 了解不多，更不用说将两者放在一起了。

我正在尝试连接到运行 SQL 2008 的 SQL Server。我想做的只是连接，但我似乎做不到。我不断收到各种错误，包括：

*   “未找到数据源名称且未指定默认驱动程序”
*   “用户‘用户’登录失败”
*   “无效字符”

我已经知道[http://www.connectionstrings.com](http://www.connectionstrings.com)，但我不知道很多事情是什么意思。什么是数据源？什么是初始目录？

这是我到目前为止所拥有的。

```
Dim result
Set cn = CreateObject("ADODB.Connection")
cn.ConnectionString = "Provider=SQLOLEDB.1;Server=MyIP;Database=SQLDatabase;User ID=user;Password=pass"
cn.Open
strQry = "select * from Users"
set result = cn.execute(strQry) 
```

有人可以帮我弄清楚这个吗？

编辑 1：这是我在服务器配置管理器中看到的；

![在此处输入图像描述](../Images/574761c6827aa6191e2a62b9d459e082.png)

编辑2：我很抱歉没有说清楚。我没有连接到本地机器。我正在连接到我网络上的一台机器。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-21T17:47:36.330

数据源 = 您要连接的数据库引擎的实例，可以是主机名，也可以是与命名实例组合的主机名。通常这是`localhost`或`localhost\SQLEXPRESS`但它也可以是 IP 地址或完全限定的域名（在您的网络内部或外部）。

初始目录 = 要连接的数据库。与连接字符串中使用的用户名/密码相关联的登录名必须属于特定的服务器角色，或者与数据库中至少属于公共角色的用户相关联。

如果您已安装 SQL Server Express Edition，则您的连接字符串*应*为：

```
cn.ConnectionString = "Provider=SQLNCLI10;" & _
  "Data Source=myIP\SQLExpress;" & _
  "Initial Catalog=SQLDatabase;" & _
  "User ID=user;Password=pass" 
```

我们无法确定这是否是正确的连接字符串 - 例如，如果您安装了默认实例或者您将实例命名为其他名称。您可以尝试其他变体（因为您说您没有安装 Express），以防出现以下问题`myIP`：

```
"Data Source=localhost;" & _ 
```

或者

```
"Data Source=(local);" & _ 
```

或者

```
"Data Source=.;" & _ 
```

或者

```
"Data Source=127.0.0.1;" & _ 
```

要查看您实际安装的内容，您可以转到开始 > 所有程序 > SQL Server 2008 > 配置工具 > SQL Server 配置管理器，然后单击 SQL Server 服务。在右侧窗格中，您应该会看到如下内容：

![在此处输入图像描述](../Images/897a6dafa93072af6971c17e1530a9ee.png)

尽管您的实例名称可能与我的不匹配。如果您看到`SQL Server (MSSQLSERVER)`，这是一个默认实例，您的连接字符串中的数据源将是`.`or`(local)`或`(localhost)`。如果你看到`SQL Server (something other than MSSQLSERVER)`那么它会是`.\something other than MSSQLSERVER`等等。你还可以看到实例是否正在运行，这可能是另一个问题。如果您要连接的实例已停止，您将无法连接到它，直到您右键单击并选择启动。您可能还想右键单击实例并选择属性，以便您可以将服务设置为自动启动，这样您下次重新启动时就不必重复此过程。如果您希望服务一直运行。

如果您向我们展示您在配置管理器中看到的内容，我们可以帮助您提供所需的确切连接字符串。

**编辑**

现在我看到更新的错误消息，其中包含：

```
[DBNETLIB][ConnectionOpen (Connect()).] 
```

您可以尝试几个选项：

(1) 确保 TCP/IP 已启用。在配置管理器中，在 SQL Server 网络配置 > MSSQLSERVER 的协议下，右键单击 TCP/IP，然后选择启用。您需要重新启动 SQL Server。（虽然您应该能够使用共享内存，但这是我过去总是配置经典 ASP 的方式。）

(2) 将以下内容添加到您的连接字符串中：

```
cn.ConnectionString = "Provider=SQLNCLI10;" & _
  "Data Source=localhost;" & _
  "Initial Catalog=SQLDatabase;" & _
  "User ID=user;Password=pass;" & _
  "Network=DBMSSOCN;" 
```

# python - 如何在 Python 中使用进度条进行下载？

> ID：11143767
> 
> 赞同：3
> 
> 时间：2012-06-21T17:43:35.777
> 
> 标签：python, progress-bar

我正在尝试在下载如下文件时实现这个包[http://code.google.com/p/python-progressbar/ ：](http://code.google.com/p/python-progressbar/)

```
 def dlProgress(count, blockSize, totalSize):
        widgets = ['Test: ', Percentage(), ' ', Bar(marker=RotatingMarker()), ' ', ETA(), ' ', FileTransferSpeed()]
        pbar = ProgressBar(widgets=widgets, maxval=totalSize).start()
        for count in range(totalSize):
            #print count
            pbar.update(int(count*blockSize*100/totalSize))
        pbar.finish()            
    urllib.urlretrieve(url, fileName, reporthook=dlProgress) 
```

问题是进度条在真正的下载进度完成之前就到了 100%，并继续开始新的进度条，如下所示：

```
Test: 100% |||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||| Time: 0:00:31 402.06 kB/s
Test: 100% |||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||| Time: 0:00:31 408.39 kB/s
Test: 100% |||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||| Time: 0:00:32 389.47 kB/s 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-21T18:26:19.033

您应该在进度回调之外初始化进度条。然后在第一次回调时，检查并设置 maxval 并启动它：

```
widgets = ['Test: ', Percentage(), ' ', Bar(marker=RotatingMarker()), ' ', ETA(), ' ', FileTransferSpeed()]
pbar = ProgressBar(widgets=widgets)

def dlProgress(count, blockSize, totalSize):
    if pbar.maxval is None:
        pbar.maxval = totalSize
        pbar.start()

    pbar.update(min(count*blockSize, totalSize))

urllib.urlretrieve(url, fileName, reporthook=dlProgress)
pbar.finish() 
```

作为旁注，最后一个块不会是一个完整的块，所以你要确保你没有超过 totalSize。

# javascript - Jquery Range Slider Handle css 不起作用？

> ID：11143768
> 
> 赞同：0
> 
> 时间：2012-06-21T17:43:44.997
> 
> 标签：javascript, jquery-ui

在我的 jsp 页面中有 2 个范围滑块。一种是根据时间（0-24 小时）按结果过滤，另一种是根据票价（0,1000）过滤结果。我正在使用 jquery UI 滑块。我想要每个滑块的不同/单独的滑块手柄。我更改了css，但第二个滑块句柄覆盖了第一个滑块句柄？我怎样才能实现单独的句柄？我的代码在这里[我的示例代码][1]：http: [//jsfiddle.net/hari034/ypAdf/](http://jsfiddle.net/hari034/ypAdf/)。我正在使用 query.ui.core.js、jquery.ui.widget.js、jquery.ui.mouse.js、uery.slider.js、query-ui-custom.css 文件。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-20T16:07:59.013

您可以使用不同的 div 包装以不同的方式设置它们的样式

## html

```
<table>
<tr>
  <td colspan="2" nowrap="nowrap">
    <div class="timesliderwrap">
       <div id="track6" class="...">
      <a id="track_time" style="..." href="#"></a>
     </div>
   </div>
 </td>
</tr>
 <!--Slider For Filter By Fare-->
 <tr valign="top">
    <td colspan="2">
       <div class="faresliderwrap">
          <div id="track7" class="..." style="...">
            <a id="track_price"  style="left: 0%;" class="..." href="#"></a>
          </div>
       </div>
    </td>
</tr>
</table> 
```

## CSS

```
.timesliderwrap .ui-slider-horizontal-time .ui-state-default {background:url(images/time_indicator1.gif) no-repeat scroll 50% 50%;}

.faresliderwrap .ui-slider-horizontal-price .ui-state-default {background:url(images/price_indicator1.gif) no-repeat scroll 50% 50%;} 
```

# blackberry - 黑莓中的 youtube 播放器

> ID：11143777
> 
> 赞同：1
> 
> 时间：2012-06-21T17:44:35.427
> 
> 标签：blackberry, youtube

我在 youtube 上有 url 视频，我想在黑莓上的 youtube 默认应用程序中播放视频，而不调用浏览器播放

```
enter code here 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-22T23:26:59.673

我从来没有找到一种方法来做到这一点。[BlackBerry Invoke 类没有为 Youtube 应用程序定义常量](http://www.blackberry.com/developers/docs/7.0.0api/net/rim/blackberry/api/invoke/Invoke.html#APP_TYPE_ADDRESSBOOK)，您可以使用它来打开其他内置应用程序。

我知道这不是你**喜欢**做的，但其他几个选择是：

*   在浏览器中打开 Youtube 视频，如下所示：

```
Browser.getDefaultSession().displayPage("http://www.youtube.com/watch?v=ciB6ExQa5SM"); 
```

*   查看[BlackBerry Youtube Client 示例](https://github.com/blackberry/Samples-for-Java/tree/master/YouTube%20Client)，它允许您构建嵌入式 Youtube 播放器。[也可以在此处找到](http://devblog.blackberry.com/2011/01/communication-api-2/)配套的博客文章。 **注意**：示例可能不会在模拟器中显示视频，因为我认为您需要为网络设置有效的蜂窝运营商设置（APN 设置等）才能允许 youtube 流式传输。

# ruby-on-rails-3 - 在 Rails 中为 Comments & Critic 设计数据库关系时遇到问题

> ID：11143779
> 
> 赞同：0
> 
> 时间：2012-06-21T17:44:46.813
> 
> 标签：ruby-on-rails-3, database-design

我仍在学习如何为我的应用程序设计数据库，并且需要一些帮助来组织 Movie Critic 应用程序的数据库。

一个评论家有很多评论，一条评论只能属于一个评论家。我需要链接表吗？

我的理解如下：

**评论表**

*   ID
*   评论
*   批评者ID

**评论表**

*   ID
*   名
*   姓

我了解如何通过critic_id 将评论链接到评论家。但是，评论家可以有多个评论，我对如何将其设计到数据库中感到困惑。显然，评论家不能在同一数据库行中有多个评论，所以我的假设是我需要某种链接表。

我正在使用rails，并且可以从有关如何正确设置模型中的关系的详细信息中真正受益（例如：has_many、belongs_to 等）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-21T18:22:26.127

由于您具有一对多的关系，因此您的设计很好。同一评论家的多条评论将在`Comment`表中具有多行，每行都有自己的`id`但共享相同的`critic_id`.

您只需要考虑是保留您现在拥有的非识别关系还是使用[识别](http://www.gc.maricopa.edu/business/sylvester/cis164/er2b.htm)关系。

只有当你有一个多对多的关系时，你才需要一个链接（又名联结）表。

# c# - C# 泛型实例化

> ID：11143781
> 
> 赞同：7
> 
> 时间：2012-06-21T17:44:59.223
> 
> 标签：c#, generics

所有，我有一个返回列表的方法。该方法用于根据名称返回 SQL StoredProcedures、Views 和 Functions 的参数。我想要做的是创建一个对象列表并将这个列表返回给调用者。方法如下

```
private List<T> GetInputParameters<T>(string spFunViewName)
{
    string strSql = String.Format(
        "SELECT PARAMETER_NAME, DATA_TYPE FROM INFORMATION_SCHEMA.PARAMETERS " +
        "WHERE SPECIFIC_NAME = '{0}' AND PARAMETER_MODE = 'IN';",
        spFunViewName);
    List<string[]> paramInfoList = new List<string[]>();
    DataTable paramDt = Utilities.DTFromDB(conn, "InputParmaters", strSql);
    if (paramDt != null)
    {
        Converter<DataRow, string[]> rowConverter =
            new Converter<DataRow, string[]>(Utilities.RowColConvert);
        paramInfoList = Utilities.ConvertRowsToList<string[]>(paramDt, rowConverter);
    }
    else
        return null;

    // Build the input parameter list.
    List<T> paramList = new List<T>();
    foreach (string[] paramInfo in paramInfoList)
    {
        T t = new T(paramInfo[NAME], paramInfo[TYPE], Convert.ToInt32(paramInfo[CHARMAXLEN]));
        columnList.Add(column);
    }
    return columnList;   
} 
```

我*显然*无法`T`通过实例化`new`并传递给构造函数，但应该清楚我正在尝试做什么。有没有办法在没有另外三种方法的情况下做我想做的事？

笔记。主要问题是我传递给 T 的参数数量可以是两个**或**三个。

谢谢你的时间。

*编辑：`struct`我使用的 s 如下*

```
public struct Database
{
    public string name { get; set; }
    public string filename { get; set; }
    public List<Table> tables { get; set; }
    public List<StoredProcedure> sps { get; set; }
    public List<Function> funcs { get; set; }
    public List<View> views { get; set; }
    public Database(string name, string filename)
    {
        this.name = name;
        this.filename = filename;
    }
}

protected internal struct StoredProcedure
{
    public string name { get; set; }
    public List<string[]> parameters { get; set; }
    public StoredProcedure(string name, List<string[]> parameters)
    {
        this.name = name;
        this.parameters = parameters;
    }
}

protected internal struct Function
{
    public string name { get; set; }
    public string output { get; set; }
    public List<string[]> parameters { get; set; }
    public Function(string name, string output, List<string[]> parameters)
    {
        this.name = name;
        this.output = output;
        this.parameters = parameters;
    }
}

protected internal struct View
{
    public string name {get; set;} 
    public List<string[]> parameters { get; set; }
    public View(string name, List<string[]> parameters)
    {
        this.name = name;
        this.parameters = parameters;
    }
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-21T17:47:39.503

使用`Activator`类来创建`T`和传递参数。

```
Type type = typeof(T);
var result = (T)Activator.CreateInstance(type, new object[] { yourParameters }); 
```

在您的代码片段中使用：

```
T t = Activator.CreateInstance(type, colInfo[NAME], colInfo[TYPE], Convert.ToInt32(colInfo[CHARMAXLEN])); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-21T17:48:34.777

我既不认可也不贬低这种技术，但你可以使用：

```
(T) Activator.CreateInstance( typeof(T), colInfo[TYPE], Convert.ToInt32(colInfo[CHARMAXLEN]) ); 
```

我想我宁愿有单独的工厂方法。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-06-21T17:53:58.870

您可以`Activator.CreateInstance()`像其他提到的那样使用或传递 `Func<string, string, int, T>`避免反射开销的委托。

```
 List<T> GetInputParameters<T>(string spFunViewName, Func<string, string, int, T> itemCreator)
 {

    ....
    List<T> paramList = new List<T>();     
    foreach (string[] paramInfo in paramInfoList)     
    {         
       T t = itemCreator(paramInfo[NAME], paramInfo[TYPE], 
            Convert.ToInt32(paramInfo[CHARMAXLEN]));         
      paramList.Add(t);     
    }     

    return columnList;    
 } 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-06-21T17:58:35.967

> 我显然不能通过 new 实例化 T 并传递给构造函数

正如所写，不；但是，如果*您*将类型参数限制为仅接受带有构造函数的类型，则可以：

```
private List<T> GetInputParameters<T>(string spFunViewName) where T : new()
{
    // your code here
} 
```

在上面的示例中，您可以说：

```
T myItem = new T(); 
```

在您的特定情况下，您似乎希望每个泛型类型共享一些共同点。还考虑使用接口约束类型：

```
private List<T> GetInputParameters<T>(string spFunViewName) where T : new(), ISomeInterface
{
    // your code here
} 
```

这将允许您在实例化对象后将值应用于接口上的任何属性：

```
T myItem = new T();

myItem.SomeProperty = somevalue;
myItem.AnotherProperty = anothervalue; 
```

有关更多信息，请查看MSDN[上的类型参数约束（C# 编程指南）](http://msdn.microsoft.com/en-us/library/d5x73970%28v=vs.80%29.aspx)以获取有关泛型类型约束的更多信息。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-06-21T17:56:58.600

[您可以使用 ADO.NET DbProviderFactories](http://msdn.microsoft.com/en-us/library/wda6c36e)创建通用数据库参数（以及连接和命令等）。

> System.Data.Common 命名空间提供了用于创建 DbProviderFactory 实例以处理特定数据源的类。当您创建 DbProviderFactory 实例并向其传递有关数据提供者的信息时，DbProviderFactory 可以根据提供的信息确定要返回的正确的强类型连接对象。

在您的代码中，您可以创建一个`DbProviderFactory`然后调用[`CreateParameter()`](http://msdn.microsoft.com/en-us/library/system.data.common.dbproviderfactory.createparameter).

```
string providerName = ConfigurationManager.ConnectionStrings["YourConnectionString"].ProviderName;
DbProviderFactory factory = DbProviderFactories.GetFactory(providerName);
DbParameter parameter = factory.CreateParameter(); 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-06-21T17:49:24.000

你可以只使用 List< [DbParameter](http://msdn.microsoft.com/en-us/library/system.data.sqlclient.sqlparameter.aspx) >

这更明显一点。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-06-21T17:50:09.673

你可以试试这个：

```
var constructor = typeof(T).GetConstructor(typeof(string), typeof(string), typeof(int));
constructor.Invoke(colInfo[NAME], colInfo[TYPE], Convert.ToInt32(colInfo[CHARMAXLEN])); 
```

# android - 将消息传递给活动以关闭自身

> ID：11143788
> 
> 赞同：0
> 
> 时间：2012-06-21T17:45:17.950
> 
> 标签：android, broadcastreceiver, android-activity

我有一个 PhoneStateListener 来监听来电和呼叫空闲状态。在来电时，我启动一个活动以将我的屏幕覆盖在默认的 InCallScreen 上，并在按下 End Call 时关闭该活动。

但是当呼叫者自己在我们接听之前结束呼叫（未接来电）时存在一个问题，在这种情况下，我的活动不知道它应该自己关闭。

我应该使用什么机制，将此消息传递给活动，以便它知道何时关闭自己。

请指导。奥姆卡尔·盖萨斯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-21T17:46:28.387

我认为添加`finish();`到`PhoneStateListener`应该`Activity`为你结束。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-21T17:49:58.917

[Telephony API](http://androidapps.org.ua/i_sect18_d1e18123.html)可能会有一些用处。您可以使用它来监控呼叫是否正在进行，一旦呼叫结束，就在您的活动上调用 finish()。

# html - FireFox - HTML5 视频在我的本地非现场网站上工作

> ID：11143795
> 
> 赞同：0
> 
> 时间：2012-06-21T17:45:46.413
> 
> 标签：html, firefox, video, html5-video

我正在尝试使用 HTML5 在网站上显示一些视频。在我的本地副本上，视频在每个浏览器上都能完美运行（即...Chrome - 版本 19.0.1084.56、Safari - 5.1.7 和 FireFox - 13.0.1。）但是，一旦我将视频推送到实时站点 FireFox 似乎停止工作。我得到的只是文字说明“找不到视频和支持的格式和 MIME 类型”。我浏览了整个网络，似乎无法弄清楚这一点。

到目前为止，我已经尝试过：

1.) 更改视频源的顺序（将 FireFox 视频类型移到顶部）。

2.) 我已将视频重新加载到实时网站。

3.) 将“编解码器”添加到文件时间。似乎没有任何效果。我错过了什么吗？我能看到的唯一区别是实时站点是 (https://)。不过这应该没关系。任何想法或帮助都会很棒！

```
 <video width="685" height="451" controls  preload="none" poster="/video/office_safety.jpg" id="video">
      <source type='video/mp4; codecs="avc1.4D401E, mp4a.40.2"' src="/video/office_safety.mp4" ></source>
      <source type='video/ogg; codecs="theora, vorbis"' src="/video/office_safety.ogv"></source>
      <source type='video/webm; codecs="vp8.0, vorbis"' src="/video/office_safety.webm"></source>
    </video> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-21T17:49:19.143

也许您需要将 mime 类型添加到 htaccess 文件中：

```
#AddType TYPE/SUBTYPE EXTENSION
AddType audio/mpeg mp3
AddType audio/mp4 m4a
AddType audio/ogg ogg
AddType audio/ogg oga
AddType audio/webm webma
AddType audio/wav wav

AddType video/mp4 mp4
AddType video/mp4 m4v
AddType video/ogg ogv
AddType video/webm webm
AddType video/webm webmv 
```

# php - PHP - 仅在文本链接中将空格转换为 %20

> ID：11143798
> 
> 赞同：2
> 
> 时间：2012-06-21T17:46:08.567
> 
> 标签：php, regex

我有一个包含超链接的文本，一些超链接包含空格，我想将它们转换为 %20。

例如：

制作超链接`<a href="http://www.link-to-my-page.com/page 1.html">Page 1</a>`

如果我使用 rawurlencode 函数转换上面的文本，它会返回

`To%20make%20hyperlinks%20%3Ca%20href%3D%22http%3A%2F%2Fwww.link-to-my-page.com%2Fpage%201.html%22%3EPage%201%3C%2Fa%3E`

我编写了以下 RE，仅将链接中的空间转换为 %20，但我不确定如何使用 preg_replace 应用空间 (\s)*。

```
/(http|https|ftp|ftps)(\:\/\/[a-zA-Z0-9\-\.]+)(\s)*\.[a-zA-Z]{2,4}(\/\S*)?/ 
```

任何帮助将不胜感激。

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-21T17:55:39.787

最简单的方法是使用[DOMDocument](http://php.net/domdocument)并[让它为您解决这个问题](http://codepad.viper-7.com/7Lr1F4)：

```
$html = 'To make hyperlinks <a href="http://www.link-to-my-page.com/page 1.html">Page 1</a>';
$doc = new DOMDocument();
$doc->loadHTML( $html);

// Save the fixed HTML
$innerHTML = '';
foreach( $doc->getElementsByTagName('p')->item(0)->childNodes as $child) {
    $innerHTML .= $doc->saveHTML($child);
}

echo $innerHTML; 
```

输出，[感谢这个 SO 问题](https://stackoverflow.com/questions/4879946/domdocument-savehtml-without-html-wrapper)：

```
To make hyperlinks <a href="http://www.link-to-my-page.com/page%201.html">Page 1</a> 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-21T17:48:56.287

这里的正确答案不是正则表达式。这是 urlencode() [http://php.net/manual/en/function.urlencode.php](http://php.net/manual/en/function.urlencode.php)

# google-app-engine - 确定搜索 API 索引是否存在

> ID：11143812
> 
> 赞同：0
> 
> 时间：2012-06-21T17:46:40.220
> 
> 标签：google-app-engine, full-text-search

在我的业务逻辑中，我首先需要检查 Appengine Search API 索引是否存在。如果存在，然后我确定长度。

```
for index in search.list_indexes(fetch_schema=False):
   if name == index.name:
        indexed = True 
```

问题是没有返回整个列表。所以我尝试了以下方法：

```
for index in search.list_indexes(fetch_schema=False, limit=500):
    logging.info("sent name: " + name + " : official index name: " + index.name) 
```

结果是将其限制为 100 个索引。我肯定错过了什么。

我的问题有两个：

1.  有没有更好的方法来检查索引是否存在？（我的方式感觉不对）

2.  当我们显然有更多时，为什么 list_indexes 只返回 100？

编辑： - - - - - - - - - - - - - - - - - - - - -

根据@skreft 的建议，我更新了我的代码：

```
 for index in search.list_indexes(fetch_schema=False, include_start_index=True, start_index_name="some_index", limit=1000):
        logging.info("sent name: " + name + " : official index name: " + index.name)
        if name == index.name:
            indexed = True`enter code here` 
```

但问题是我收到了一条非常神秘的错误消息，并且我非常明确地遵循了文档。其他人有这种情况吗？（以下错误）：

```
Traceback (most recent call last):
  File "/base/data/home/apps/s~searchbertha-hrd/82.359784956262345840/models.py", line 1898, in build_searchable_index
    for index in search.list_indexes(fetch_schema=False, include_start_index=True, start_index_name=name, limit=1000):
  File "/base/python_runtime/python_lib/versions/1/google/appengine/api/search/search.py", line 675, in list_indexes
    raise _ToSearchError(e)
InvalidRequest 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-21T17:54:38.783

尝试使用参数 start_index_name 和 include_start_index。

有关更多信息，请参阅[文档](https://developers.google.com/appengine/docs/python/search/functions)。

# c# - NHIbernate SQLQuery 和枚举

> ID：11143815
> 
> 赞同：1
> 
> 时间：2012-06-21T17:46:44.010
> 
> 标签：c#, nhibernate

我正在尝试将枚举字段映射到 dto 属性。我正在使用 PositionalToBeanResultTransformer，如下所示：

```
PositionalToBeanResultTransformer trans = new PositionalToBeanResultTransformer(typeof(DTOClass), new string[] { "Id", "EnumProperty" });
var data = Sesion.CreateSQLQuery("SELECT Id, EnumField FROM Table")
        .AddScalar("EnumField", NHibernateUtil.Custom(typeof(Enumerador)))
        .SetResultTransformer(trans)
        .List<DTOClass>();

public class DTOClass
{
    public int Id { get; set; }
    public Enumerador EnumProperty { get; set; }
} 
```

DTOClass 没有被映射，所以我不能使用 AddEntity() 并且带有 AddScalar() 的代码会抛出一个错误，我必须实现 NHibernate.UserTypes.IUserType。如何将数据库的字符串字段转换为 SQLQuery 中的枚举？

在此先感谢您的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-21T19:45:46.267

如果您不使用 AutoMapping，请在 ClassMap 中添加类似的行，如下所示：

```
Table("MyClass");
Id(x => x.Id).GeneratedBy.Identity();
Map(x => x.Type).CustomType(typeof(Enumerations.MyType));

public virtual int Id { get; set; }
public virtual Enumerations.MyType Type { get; set; } 
```

我通常将我的枚举作为整数存储在数据库中，ClassMap 将适当地映射回枚举。

# powershell - 调用命令和启动进程问题

> ID：11143820
> 
> 赞同：1
> 
> 时间：2012-06-21T17:47:07.280
> 
> 标签：powershell, powershell-2.0

我正在尝试执行以下脚本：

```
$Cred = Get-Credential
Invoke-Command -Computername Localhost -Cred $Cred -Scriptblock {Start "Notepad.exe" -Wait} 
```

好吧，记事本以管理员身份出现没有问题，但在当前用户的帐户中不可见。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-21T19:46:05.257

我认为不可能在具有不同凭据的交互式会话中看到 gui，它存在于另一个用户会话中。

解决方法：

```
start-process notepad.exe -Credential $Cred 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-21T19:38:58.743

我在使用 PS Remoting 时遇到了这个问题，并且无法找到一种方法来让应用程序在一组凭据下运行以显示在不同用户的交互式桌面上。我最终放弃并使用了 SysInternals 实用程序[psexec](http://technet.microsoft.com/en-us/sysinternals/bb897553.aspx)及其`-i`参数。

# xml - 将几个 XML 文件读入一个数组并用 Perl 解析它们

> ID：11143821
> 
> 赞同：1
> 
> 时间：2012-06-21T17:47:12.797
> 
> 标签：xml, arrays, perl

我想读取一个数组中的多个 XML 文件，然后一个一个地解析它们。

这是我正在做的事情：

```
my $output = "c:\documents\outputfiles";
opendir (FILE, $output) or die "can't open the $output";

my @files = readdir File;
print @files; 
```

这将列出“输出文件”目录下的所有文件。我如何只读取 XML 文件？

我也试过：

```
my @files = grep {*.xml} readdir FILE; 
```

这不起作用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-21T17:53:16.153

试试这个：

```
@files = glob("C:/documents/outputfiles/*.xml"); 
```

@files 是所有 xml 文件的列表。

编辑：根据[TLP](https://stackoverflow.com/users/725418/tlp)的评论在 glob 函数中插入完整路径。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-21T17:51:22.113

您需要像这样向[grep](http://perldoc.perl.org/functions/grep.html)提供模式：

```
my @files = grep {/\.xml$/i} readdir FILE; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-21T17:56:42.373

Grep 将表达式或块作为其第一个参数。还考虑使用`autodie`：

```
use autodie;
my $path = './files';

opendir(DIR, $path);
my @files = grep { -f "$path/$_" && m/.xml$/ } readdir(DIR);
closedir(DIR);

say for @files; 
```

# python - 在 Python 2.7 中使用 urllib2 从 URL 下载任意数量的文件。相当于 urllib2 的“os.walk”？

> ID：11143827
> 
> 赞同：0
> 
> 时间：2012-06-21T17:47:30.080
> 
> 标签：python, download, urllib2, os.walk

我想下载已知 URL 的特定目录中的所有文件。这些文件的名称不一定是已知的，但它们的名称都包含一个通用关键字，并且具有相同的扩展名 (.xml)。

urllib2 是否有等效的“os.walk”，这样我就可以简单地浏览目录中存在的任何文件并打开它们进行解析？

我在网上看到的唯一示例涉及一个已知名称的文件，其中包含目录中所有文件名的列表。我不想这样做...

其他可能相关的信息：这些文件位于 apache 服务器上，并且可以公开访问。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-21T17:55:59.933

如果不知道文件名，这是不可能的 - 您必须随机尝试所有可能的名称，因为您知道是否存在具有此名称的文件的唯一方法是请求 url 并查看是否得到响应。但是您可以让 Apache 网络服务器为您生成一个目录索引（使用[mod_autoindex](https://httpd.apache.org/docs/2.0/mod/mod_autoindex.html)）并解析它以获取文件名。

# c# - 使用接口类型作为泛型

> ID：11143828
> 
> 赞同：1
> 
> 时间：2012-06-21T17:47:33.197
> 
> 标签：c#

我有一个必须实现以下属性的类

```
public ICollection<IType> Items
{
     get { return this.items;}
} 
```

我的问题是当类型`this.items`是`List<MyType>`where `MyType`implements时如何实现`IType`。我需要确保以下几点：

1.  尽可能避免不必要的列表枚举
2.  该类可以在内部将元素`this.items`视为其具体类型
3.  外部调用者可以向此集合添加和删除元素

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-21T18:00:34.527

就像保罗提到的那样，你不能同时拥有#2 和#3。您必须选择其中一个，或者将具体类型公开给外部调用者。但是，对于您的实际要求，最好的办法是在内部将您的集合存储为 List ，并在需要通过具体类型获取成员时使用一种方法。像这样的东西：

```
private List<IType> items = new List<IType>();

private TType GetItem<TType>(int index)
    where TType : IType
{
    return (TType)items[index];
}

public ICollection<IType> Items
{
    get
    {
        return this.items;
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-21T18:01:00.387

正如@PaulPhillips 在对这个问题的评论中指出的那样：

> 要求 (2) 和 (3) 是矛盾的。

一种方法是更改​​ to 的类型`Items`并`IEnumerable<IType>`具有 的另一个属性`ICollection<MyType>`。这将意味着一些重新设计，但显然我无论如何都做错了。

谢谢！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-21T18:01:20.203

如果您想将其公开为，则声明`this.items`为 a ，从而允许外部调用者添加not 。`List<IType>``ICollection<IType>``ITypes``MyTypes`

在列表的项目上像这样在内部工作

```
var myObj = this.items[i] as MyType;
if (myObj == null) {
    work with this.items[i] and treat it as a IType
} else {
    work with myObj which is a MyType
} 
```

或者

将公共财产声明为

```
public ICollection<MyType> Items { get return this.items; } } 
```

从而允许外部调用者只添加 type 的项目`MyType`。

很抱歉，您不能同时满足条件（2）和（3）

* * *

**更新**

另一种选择是只允许外部调用者获取列表中的项目而不是添加项目，方法是使用只有一个 getter 的索引器。

```
public IType this[int i]
{
    get { return this.items[i]; }
} 
```

然后外部调用者可以访问这样的项目

```
var obj = new ClassImplementingThisStuff();
int i = 5;
IType x = obj[i]; 
```

还添加一个计数属性

```
public int Count { 
    get { return this items.Count; }
} 
```

该解决方案避免了不必要的枚举。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-21T18:04:00.663

怎么`Items`样`IEnumerable<IType>`？IEnumerable 是协变的，因此代码无需更改即可工作。另一方面，您可以使用另一种专用方法将元素添加到内部列表。

```
class MainClass
{
  public static void Main()
  {
    ShowMeHowToDoIt show = new ShowMeHowToDoIt();
    show.Add( new TheType() );

    foreach ( var item in show.Items )
    {
   Console.WriteLine( item );
    }     
  }
}

public class ShowMeHowToDoIt
{
  private List<TheType> items = new List<TheType>();

  public void Add( TheType item ) { items.Add( item ); }

  public IEnumerable<IType> Items
  {
    get { return items; }
  }
}

public interface IType { }

public class TheType : IType { } 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-21T18:03:24.780

我认为评论中关于这可能是一个糟糕的设计的观点是正确的，但是你仍然可以做这样的事情并逃脱它：

```
interface IFruit
{
    string Name { get; }
    string SerialNumber { get; }
}

class Apple : IFruit
{

    private string _serial = Guid.NewGuid().ToString();

    public string Name {
        get {
            return "Apple";
        }
    }

    public string SerialNumber {
        get { return _serial; }
    }
}

class AppleBasket : IEnumerable<IFruit>
{
    private List<Apple> _items = new List<Apple>();

    public void Add(Apple apple) {
        _items.Add(apple);
    }

    public IEnumerator<IFruit> GetEnumerator() {
        return _items.GetEnumerator();
    }

    System.Collections.IEnumerator System.Collections.IEnumerable.GetEnumerator() {
        return _items.GetEnumerator();
    }
}

/******************/

AppleBasket basket = new AppleBasket();
Apple apple1 = new Apple();
basket.Add(apple1);

Apple apple2 = new Apple();
basket.Add(apple2);

foreach (IFruit fruit in basket) {
    Console.WriteLine(fruit.SerialNumber);
} 
```

我*建议*你重新考虑你的方法。

# sql - 需要帮助编写使用事务的存储过程

> ID：11143833
> 
> 赞同：1
> 
> 时间：2012-06-21T17:47:40.767
> 
> 标签：sql, sql-server, sql-server-2008, sql-server-2008-r2

我正在尝试编写一个存储过程来检查某个值并返回错误或继续更新语句。我已经尝试编写 proc 并且一切似乎在语法上都是正确的，但是它似乎只检查某个值，当没有找到它时，它似乎只是跳过了需要发生的更新。我当前的代码如下：

```
declare @newID varchar = 099393
declare @oldID varchar = 260260
Declare @pMsg   varchar(255) 

if exists (select * from req where dept_id=@oldID)
begin
    SET @pMsg = 'The department ID ' + @oldID + ' cannot be changed at this time.'
    return
end 

Begin Try
    Begin TRAN   
        update dbo.dept
        set dept_id = @newID
    where dept_id = @oldID
COMMIT TRAN
END TRY
BEGIN CATCH
  ROLLBACK TRAN
    update dbo.dept
    set dept_id = @oldID
    where dept_id = @oldID
END CATCH

select dept_id=@newID
return 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-21T19:32:25.637

好吧，您的整个 Try-Catch 块毫无意义，并且在功能上等于以下内容

```
declare @newID varchar = 099393 
declare @oldID varchar = 260260 
declare @pMsg  varchar(255)  

if exists (select * from req where dept_id=@oldID) 
begin 
    set @pMsg = 'The department ID ' + @oldID + ' cannot be changed at this time.' 
    return 
end

update dbo.dept 
set dept_id = @newID 
where dept_id = @oldID 
```

笔记; 我已经删除了尾随的部门 ID 选择和返回关键字。您已经知道新的 ID，所以为什么还要选择它。我保留了@pMsg 分配，因为我认为这是一个输出参数。

*因此， dept 更新*不起作用的唯一原因（当 req 表中不存在旧 id 时）将是如果旧 id 不存在于 dept 表中。

**哇，我多么愚蠢，没有发现这一点，你没有设置你的 varchars 的长度，所以 newid 和 oldie 的长度都是 1，因此不会采用分配的值 099393 和 260260**

至少他们应该是

```
declare @newID varchar(6) = 099393 
declare @oldID varchar(6) = 260260 
```

# ios - 如何将 iOS.m 文件拆分为更多文件？

> ID：11143836
> 
> 赞同：3
> 
> 时间：2012-06-21T17:47:59.763
> 
> 标签：ios, xcode

我有一个 .m 文件，其中包含一个 @implementation ，但它变得太大了，我正试图将一些方法函数移动到第二个文件。

两个 .m 文件都以

```
@implementation GesticulatorViewController

@synthesize score_display;
@synthesize game_status;
@synthesize player_options;
@synthesize total_players_field;
@synthesize gesticulation_sentence;
@synthesize gesticulation_input;
@synthesize main_view_manager;
@synthesize game_state; 
```

但我收到链接器警告：“ld：重复符号_OBJC_IVAR__$_GesticulatorViewController.gesticulation_input”

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-21T17:51:15.193

您不能在两个不同的文件中拥有相同的类实现。

在您的情况下，您不能将**GesticulatorViewController**的实现拆分为两个*.m*文件。

**编辑：**

我会使用 Objective-C 类别来分散实现。

通过类别，您有机会将执行类似任务的方法组合在一起。

这是Apple文档中对“类别和扩展”的解释： [https ://developer.apple.com/library/mac/#documentation/cocoa/Conceptual/ObjectiveC/Chapters/ocCategories.html#//apple_ref/doc/uid/ TP30001163-CH20-SW1](https://developer.apple.com/library/mac/#documentation/cocoa/Conceptual/ObjectiveC/Chapters/ocCategories.html#//apple_ref/doc/uid/TP30001163-CH20-SW1)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-21T17:57:04.360

我建议制作多个控制器。每个控制器处理不同的部分。

我正在制作一个视频应用程序。我有一个 PlayerControlsViewController，它的视图中有所有的播放和暂停按钮。

我还有一个工具控制器，其中包含选择工具和任何菜单项。

这些控制器的属性使控制器查看并从超级视图中删除。然后将视图设置在它自己的视图中的某个位置并将其连接到 PlayerController。将玩家安置在其中。

这些控制器中的每一个都包含自己的代码来处理其任务。并通过每个协议将消息发送回主视图控制器。

这将在其他控制器之间来回传递命令，并维护主视图控制器上的设置。

我相信这是应用程序正常运行且易于维护的预期操作标准。

此方法也适用于导航控制器和选项卡控制器。由于它们维护自己的代码，因此您可以在自己的视图中添加另一个视图控制器视图。

请记住在将其添加到您的视图之前将其从其超级视图中删除。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-21T18:07:07.913

如果这一切都需要在一个视图中，但你认为实现太大，你总是可以做分类:) 只需转到 File->New->Objective-C Category。然后在您的视图控制器上创建类别，然后添加它！

请记住，您不能在类别中添加新的 ivars 或属性。但是，您可以利用原始类中的属性和 ivars。

此外，如果您发现 .m 视图控制器文件中有大量代码，您可能会考虑进一步研究 MVC 范例，将一些功能拆分为其他类。请记住，视图控制器应该只处理视图更改 - 数据操作等应该由其他类完成 :)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-21T18:46:14.103

另一种选择是将某些方法的源代码复制到另一个 .m 文件，然后在主 .m 文件中#include 该文件。将#include 放在从主文件中剪切方法的位置。

完成这项工作的技巧是将#included 源文件添加到您的项目中，但取消选中所有目标。您不希望 Xcode 尝试自己编译文件 - 只需将其 #include 到您的主视图控制器文件中。

# linux - 如何配置嵌入式 Linux USB？

> ID：11143841
> 
> 赞同：5
> 
> 时间：2012-06-21T17:48:24.650
> 
> 标签：linux, usb, embedded-linux

为什么这不能[正确](http://designsomething.org/leopardboard/f/23/p/743/2753.aspx#2753)配置 file_storage 设备 USB？

在嵌入式 linux 目标上：

```
/ # modprobe g_file_storage file=/dev/mmcblk0
musb_hdrc: version 6.0, cppi-dma, peripheral, debug=0
musb_hdrc: USB Peripheral mode controller at fec64000 using DMA, IRQ 12 
g_file_storage gadget: File-backed Storage Gadget, version: 20 November 2008
g_file_storage gadget: Number of LUNs=1 
g_file_storage gadget-lun0: ro=0, file: /dev/mmcblk0

/ # lsusb
lsusb: /sys/bus/usb/devices: No such file or directory

/ # cat /lib/modules/2.6.32-17-ridgerun/modules.dep | grep usb
kernel/drivers/usb/otg/nop-usb-xceiv.ko:
kernel/drivers/usb/musb/musb_hdrc.ko: kernel/drivers/usb/otg/nop-usb-xceiv.ko
kernel/drivers/usb/gadget/g_file_storage.ko: kernel/drivers/usb/musb/musb_hdrc.ko kernel/drivers/usb/otg/nop-usb-xceiv.ko 
```

在 Ubuntu 10.04 主机上：

```
$ fgrep USB $DEVDIR/kernel/linux*/.config | grep -v '^#'
CONFIG_USB_SUPPORT=y
CONFIG_USB_ARCH_HAS_HCD=y
CONFIG_USB_MUSB_HDRC=m
CONFIG_USB_MUSB_SOC=y
CONFIG_USB_MUSB_PERIPHERAL=y
CONFIG_USB_GADGET_MUSB_HDRC=y
CONFIG_USB_TI_CPPI_DMA=y
CONFIG_USB_GADGET=m
CONFIG_USB_GADGET_VBUS_DRAW=2
CONFIG_USB_GADGET_SELECTED=y
CONFIG_USB_GADGET_DUALSPEED=y
CONFIG_USB_FILE_STORAGE=m
CONFIG_USB_OTG_UTILS=y
CONFIG_NOP_USB_XCEIV=m

$ lsusb
Bus 002 Device 003: ID 067b:2303 Prolific Technology, Inc. PL2303 Serial Port 
Bus 002 Device 002: ID 8087:0024 
Bus 002 Device 001: ID 1d6b:0002 Linux Foundation 2.0 root hub 
Bus 001 Device 005: ID 058f:6362 Alcor Micro Corp. Hi-Speed 21-in-1 Flash Card Reader/Writer (Internal/External) 
Bus 001 Device 004: ID 04ca:003a Lite-On Technology Corp. 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-05T21:08:34.873

需要[usb_composite_msd_acm.patch （在](https://docs.google.com/open?id=0B63baHkhSwOmRGVmQ3lCRjlCLUE)[RidgeRun](https://www.ridgerun.com/)的帮助下解决）。

# python - app.yaml 和服务器设计中的问题

> ID：11143844
> 
> 赞同：0
> 
> 时间：2012-06-21T17:48:30.827
> 
> 标签：python, django, google-app-engine, yaml

我需要在此服务器中实现一些基本功能：

1.  显示一个漂亮的主屏幕（html），带有 < select > 小部件和 2 个按钮（一个用于从高清中选择图像以上传，另一个用于发送）+ TextEditBox 用于输入消息
2.  当用户单击“发送”时 - 从选择小部件中选择用户并
3.  图片将被上传

我已经设法单独实现所有这些，现在当我让它们一起工作时，由于设计不好，我遇到了 app.yaml url 路径的问题。

app.yaml 看起来像：

```
runtime: python    

handlers:
- url: /(.+)
  static_files: images/\1
  upload: images/(.*)

- url: /.*
  script: kserver.py 
```

kserver.py：

```
class StartPage(webapp.RequestHandler):
    def get(self):
        select_items = db.GqlQuery( "SELECT * FROM Registration" )
        upload_url = blobstore.create_upload_url('/upload')
        self.response.out.write(template.render("tst.html", {'select_items': select_items}))

class UploadHandler(blobstore_handlers.BlobstoreUploadHandler):
    def post(self):
        upload_files = self.get_uploads('file')
        image = self.request.get("img")
        photo = Photo()
        photo.imageblob = db.Blob(image)
        photo.put()
        blob_info = upload_files[0]
        self.redirect('/serve/%s' % blob_info.key())

class DownloadImage(webapp.RequestHandler):
    def get(self):
        photo= db.get(self.request.get("photo_id"))
        if photo:
            self.response.headers['Content-Type'] = "image/jpeg"
            self.response.out.write(photo.imageblob)
        else:
            self.response.out.write("Image not available")

class Sender(webapp.RequestHandler):
    def post(self):
        ...
        ...
        self.response.headers['Content-Type'] = 'text/html'     # reply with 200 OK
        self.response.set_status( 200,"OK" )
        ...
        ...

class TokenService(webapp.RequestHandler):
    def post(self):
        self.response.headers['Content-Type'] = 'text/plain'
        self.response.set_status( 200,"Registration accepted" )
        ...

application = webapp.WSGIApplication([('/', StartPage),
                                      ('/sender',Sender),
                                      ('/upload', UploadHandler),
                                      ('/i', DownloadImage),
                                      ('/serve/([^/]+)?', ServeHandler),
                                      ('/token',TokenService)],
                                      debug=True)
def main():
    run_wsgi_app(application)

if __name__ == "__main__":
    main() 
```

这是 tst.html ：

```
<html>
    <body>
        <select name="accountName">
            <option value=\"ALL\">ALL</option>
            {% for item in select_items %}
        <option value="{{ item.accountName }}">{{ item.accountName }}</option>
            {% endfor %}
        </select>
        <form action="sender" method="POST">
            <input  type="text" id="TextEditBox_1">
            <input  type="submit" name="submit">
            <input  type="file" name="img" id="Choose_file">
        </form>
    </body>
</html> 
```

请注意，标识很好，它只是代码的一部分。

在项目中，我有一个包含 app.ico 和背景图像（静态）的图像目录

好的，现在问题是我进入了 GAE 日志：

```
Static file referenced by handler not found: images/token
Static file referenced by handler not found: images/sender 
```

这不是故意的。我认为它应该在'/'中

和

```
"/token 404 48ms 0kb            No handlers matched this URL." 
```

此外，当点击“发送”时，它会将我重定向到一个新页面：

```
The requested URL /sender was not found on this server. 
```

此 /token 是来自外部的 POST，用于注册到服务器 - 服务器比将注册存储在 db 中。当按下“发送”按钮时，它应该使用这个 db.register 令牌。

欢迎对这个主题发表任何评论。谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-21T17:59:33.077

app.yaml 中的模式过于笼统：

```
- url: /(.+)
  static_files: images/\1
  upload: images/(.*) 
```

几乎可以匹配任何东西，因此本应由代码处理的请求永远不会到达那里。尝试这样的事情：

```
- url: /(.*\.(gif|png|jpg))
  static_files: static/\1
  upload: static/(.*\.(gif|png|jpg)) 
```

它将仅处理以 gif、png 或 jpg 结尾的文件。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-21T17:52:55.977

您的第一个处理程序匹配第一个斜线后至少有一个字符的任何内容；您需要使用 /images/.* 之类的 url 或仅匹配以 结尾的文件`(jpg|gif|png|ico)`，例如

# ruby-on-rails - 使用 Cucumber 更新 paths.rb 后导航到详细信息页面时出错

> ID：11143845
> 
> 赞同：0
> 
> 时间：2012-06-21T17:48:31.787
> 
> 标签：ruby-on-rails, cucumber, bdd

我有以下黄瓜场景：

```
Scenario: find vegetable with same color
  Given I am on the details page for "Potato" 
```

因为我能够背负 web_step：

```
Given /^(?:|I )am on (.+)$/ do |page_name|
  visit path_to(page_name)
end 
```

我所要做的就是和我所做的paths.rb文件：

```
def path_to(page_name)
  case page_name

  when /^the edit page for "(.*)"$/
    edit_vegetable_path(Vegetable.find_by_name($1))
  when /^the details page for "(.*)"$/
    vegetable_path(Vegetable.find_by_title($1)) 
```

但是，一旦我运行 cucumber，我就会收到以下错误：

```
Given I am on the details page for "Potato"              # features/step_definitions/web_steps.rb:44
      undefined method `strftime' for nil:NilClass (ActionView::Template::Error)
      /usr/local/lib/ruby/gems/1.9.1/gems/activesupport-3.1.0/lib/active_support/whiny_nil.rb:48:in `method_missing'
      ./app/views/vegetables/show.html.haml:14:in `_app_views_vegetables_show_html_haml___295190995_93073700'
      /usr/local/lib/ruby/gems/1.9.1/gems/actionpack-3.1.0/lib/action_view/template.rb:144:in `block in render'
      /usr/local/lib/ruby/gems/1.9.1/gems/activesupport-3.1.0/lib/active_support/notifications.rb:55:in `instrument'
      /usr/local/lib/ruby/gems/1.9.1/gems/actionpack-3.1.0/lib/action_view/template.rb:142:in `render' 
```

ETC...

我不确定为什么 edit_vegetable_path 有效，但vegetable_path 无效。我什至尝试硬编码一个特定的蔬菜页面（就像一个测试），我得到了同样的错误：

```
when /^the details page for "(.*)"$/
    '/vegetables/1' 
```

我现在不知道如何进一步调试这个问题。任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-05T16:51:51.080

我发现我的视图文件存在问题。一旦我做出改变，一切都解决了。

# grails - 安装 Grails CXF 插件

> ID：11143848
> 
> 赞同：0
> 
> 时间：2012-06-21T17:48:37.147
> 
> 标签：grails, cxf

我正在运行 Grails v2.4.0，并且一直在尝试为 Web 服务安装 Grails CXF 插件。我下载了插件的 .zip 文件，然后运行 ​​grails install-plugin /path/to/zip。在尝试安装时，它给了我一个错误，它找不到这个依赖项：**org.apache.cxf:cxf-rt-frontend-jaxws:2.3.0**。我下载此插件的页面提到所需的一切都在 zip 中。我无法使用 maven 自动下载所需文件，因为我的工作位置不允许下载任何内容。是否有我可以参考的手动安装 CXF 所需的文件列表？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-22T11:42:55.687

您应该向 BuildConfig.groovy 的相关部分添加依赖项，而不是使用`install-plugin`，并确保`mavenCentral()`启用了存储库。卸载您已经安装的 zip 插件，然后编辑您的 BuildConfig：

```
grails.project.dependency.resolution = {
    // ...
    repositories {
        // other repositories as before
        mavenCentral()
    }

    plugins {
        // other plugins as before
        compile ":cxf:0.9.0"
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-22T13:43:19.493

由于您无法使用 Maven 下载传递依赖项，因此您应该能够像这样排除它们：

```
grails.project.dependency.resolution = {

plugins {

    compile ":cxf:0.9.0" {
       excludes([ group: 'org.apache.cxf', name: 'cxf-rt-frontend-jaxws']
       // you may need to exclude quite a few...
    }
} 
```

然后手动下载依赖项并将它们放在您的 lib 目录中。例如，从这里下载 cxf-rt-frontend-jaxws： [http ://search.maven.org/#search|ga|1|g%3A%22org.apache.cxf%22%20AND%20a%3A% 22cxf-rt-frontend-jaxws%22%20AND%20v%3A%222.3.0%22](http://search.maven.org/#search|ga|1|g%3A%22org.apache.cxf%22%20AND%20a%3A%22cxf-rt-frontend-jaxws%22%20AND%20v%3A%222.3.0%22)

# javascript - jQuery - 使用 .hover 而不是 .click

> ID：11143851
> 
> 赞同：2
> 
> 时间：2012-06-21T17:48:53.377
> 
> 标签：javascript, jquery

我的页面上有以下代码。

[http://jsfiddle.net/SO_AMK/r7ZDm/](http://jsfiddle.net/SO_AMK/r7ZDm/)

如您所见，它是一个链接列表，每次单击链接时，都会在相关链接下方打开弹出框。

现在，我需要做的基本相同，只是我需要使用 .hover 事件并将执行延迟 2 秒。因此，用户应该将光标停留在链接上 2 秒钟，而不是单击。

听起来很简单，但我无法让定位正常工作。这是我尝试过的：

```
$('a.showreranks').hover(function()
    {   
    $(this).data('timeout', window.setTimeout(function()
        {
            position = $(this).position();   
        $('#rerank_details').css('top', position.top + 17);   
        $('#rerank_details').slideToggle(300);    
        }, 2000));
    },
    function()
    {
        clearTimeout($(this).data('timeout'));
    }); 
```

有人可以修改它以使其工作吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-21T17:53:24.163

试试这样：

```
$('a.showreranks').hover(function()
{   
    var self = this;
    $(this).data('timeout', window.setTimeout(function() {
        var position = $(self).offset();   
        $('#rerank_details').css('top', position.top + 17);   
        $('#rerank_details').slideToggle(300);    
    }, 2000));
},
function()
{
    clearTimeout($(this).data('timeout'));
}); 
```

[**演示**](http://jsfiddle.net/sWYTF/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-21T17:59:29.823

## *[jsFiddle 演示](http://jsfiddle.net/roXon/sPYdC/2/)*

```
$('ul').on('mousemove','li',function(e){

    var m = {x: e.pageX, y: e.pageY};
    $('#rerank_details').css({left: m.x+20, top: m.y-10});

}).on('mouseenter','li',function(){

    var t = setTimeout(function() {
        $('#rerank_details').stop().slideDown(300);
    },2000);
    $(this).data('timeout', t);

}).on('mouseleave','li',function(){

    $('#rerank_details').stop().slideUp(300);
    clearTimeout($(this).data('timeout'));

}); 
```

这`setTimeout`将像一个*悬停意图*，实际上将执行延迟 2 秒
，并计算悬停在`data`悬停元素的属性内的时间 - 在 mouseleave 时“无效”。
我还添加了几行代码，使您的*工具提示*跟随鼠标移动。

# solr - 在 Solr 中自定义 KStem 过滤器

> ID：11143855
> 
> 赞同：0
> 
> 时间：2012-06-21T17:48:56.847
> 
> 标签：solr, lucene, stemming, porter-stemmer

我正在尝试评估将 Solr 中的词干过滤器从 Porter 切换到 KStem。我看到了有关通过 direct_conflations.txt 文件和其他文件配置 KStem 的能力的参考，但我似乎找不到有关如何格式化此文件或如何告诉 KStem 加载此配置文件的文档。

这是加载 KStem 的 schema.xml 中的示例 solr 配置

```
<analyzer type="query">
  <tokenizer class="solr.StandardTokenizerFactory"/>
    <filter class="solr.StandardFilterFactory"/>
    <filter class="solr.LowerCaseFilterFactory"/>
    <filter class="solr.SynonymFilterFactory" synonyms="synonyms.txt" ignoreCase="true" expand="false"/>
    <filter class="solr.KStemFilterFactory"/>
</analyzer> 
```

使用 Porter，您可以像这样配置受保护的字：

```
<filter class="solr.EnglishPorterFilterFactory" protected="protwords.txt"/> 
```

我想知道是否有类似的方式来配置 KStem，有人知道或有人知道这在哪里记录吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-21T20:16:50.473

你最好的朋友正在查看 solr 源代码。我快速浏览了一下，发现与 EnglishPorterFilterFactory 不同，KStemFilterFactory 不查找受保护的令牌列表。HTH。

# zend-framework - 如果未找到匹配项，则 Zend 自定义路由

> ID：11143857
> 
> 赞同：1
> 
> 时间：2012-06-21T17:49:14.103
> 
> 标签：zend-framework, zend-route, zend-router

我有一个带有几个模块的 ZF 应用程序：（像往常一样）

```
root\
    \application\
                \default
                \items
                \me
                   \controllers
                   \views 
```

该应用程序使用默认路由，例如`/module/controller/action`；

我想要的是：如果没有找到默认 Zend 路由的匹配项（没有找到操作/控制器/模块），则路由到**所需的路径**，并将 url 端点吐入参数中。

例如：

*   `mydomain.lh/me`-> 将匹配模块`me`、控制器`index`、动作`index`（默认）

*   `mydomain.lh/my_category_name`-> 将匹配模块`items`、控制器`index`、操作`index`、`params`：类别 => my_category_name -> 使用**所需的路径**路由

    *   不`my_category_name`存在可匹配的模块

我已经尝试过，进入 bootstrap.php：

```
 public function _initRoutes ()
{
    $router = $this->_front->getRouter(); // returns a rewrite router by default

    $router->addRoute(
        'cat-item',
        new Zend_Controller_Router_Route('/:category',
                                         array(
                                            'module' => 'items',
                                            'controller' => 'index',
                                            'action' => 'index'))
    );
} 
```

女巫指向正确的位置（我知道，因为我 var_dump 将请求 url 编辑到`items/index/index`操作中，并且预期的 url 和参数在那里，但如果我不执行`var_dump(something);exit;`操作，则会提供一个空白页面。

*   没有输出但也没有产生错误，请求状态是 200 - OK

任何人都可以有一个建议吗？

谢谢！

# javascript - JSON 根据 ID 显示实际数据

> ID：11143858
> 
> 赞同：1
> 
> 时间：2012-06-21T17:49:14.583
> 
> 标签：javascript, jquery, json, google-maps, google-maps-api-3

> [http://jsfiddle.net/Zyjwb/5/](http://jsfiddle.net/Zyjwb/5/)

如何根据指定的**id**在每个**房屋/公寓的信息窗口内显示****所有者**的实际姓名？

 ****因此，如果**房屋**元素具有`1`并在**所有者**属性中`3`列出- 将它们转换为以及何时为每个标记打开**信息窗口。****`Jim``Peter`**

 ***** * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-21T17:54:38.820

您用来存储所有者的结构使得实现这一点非常困难。

```
var owners = [{
    id: '1',
    name: 'Jim'},
{
    id: '3',
    name: 'Peter'},
{
    id: '54',
    name: 'Harry'}]; 
```

如果改成下面这样就很简单了`owners[elem.owner]`

```
var owners = {
    '1': 'Jim',
    '3': 'Peter',
    '54': 'Harry'
} 
```

当前结构需要遍历数组以找到具有指定 id 的对象。

**更新**工作演示（基于评论）：http: [//jsfiddle.net/Zyjwb/12/](http://jsfiddle.net/Zyjwb/12/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-21T18:01:16.943

您需要先提取所有者信息：

上面：`var content = '<div id="info">';`，添加：

```
var ownerInfo = '';
var ownerList =  elem.owner;
for(var ow=0;ow<ownerList.length;ow++) {
            ownerInfo += "&bull; " + owners[ow].name +"<br />";
} 
```

然后在你的代码中降低：

```
content += '<h3>Owners:</h3>' + ownerInfo; 
```********

# sql-server - 更新 SQL Server 2008 视图

> ID：11143859
> 
> 赞同：1
> 
> 时间：2012-06-21T17:49:18.657
> 
> 标签：sql-server, sql-server-2008

我正在尝试更新 SQL Server 2008 视图，当我运行以下脚本时，我收到以下错误。

```
IF EXISTS (SELECT TABLE_NAME FROM INFORMATION_SCHEMA.VIEWS 
WHERE TABLE_NAME = 'oas_AppVend') 
```

错误：

```
Msg 102, Level 15, State 1, Line 2
Incorrect syntax near ')'. 
```

如果我像下面那样运行 sript（没有 if 和没有括号），结果会显示“VIEW”。

```
SELECT TABLE_NAME FROM INFORMATION_SCHEMA.VIEWS 
WHERE TABLE_NAME = 'oas_AppVend' 
```

结果：

```
TABLE_NAME
oas_AppVend 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-21T18:33:32.367

该错误仅仅是因为您编写的脚本还不够。SQL 引擎仍然需要知道 if 之后要做什么。

```
IF EXISTS (SELECT TABLE_NAME FROM INFORMATION_SCHEMA.VIEWS  
WHERE TABLE_NAME = 'oas_AppVend') 
BEGIN 
   /* VALID SQL STATEMENT MUST EXIST HERE */
END 
```

注意：即使上面的代码也会返回一个错误，直到您将有效的 sql 语句放入我提到的块中。如果您对 else 有想要的结果，它看起来像这样，但在您真正完成之前，这不是一个有效的陈述。

```
IF EXISTS (SELECT TABLE_NAME FROM INFORMATION_SCHEMA.VIEWS  
WHERE TABLE_NAME = 'oas_AppVend') 
BEGIN 
   /* VALID SQL STATEMENT MUST EXIST HERE */
END
ELSE
BEGIN
   /* DO SOMETHING ELSE */
END 
```

# sql - SQL中的单位换 算表

> ID：11143863
> 
> 赞同：1
> 
> 时间：2012-06-21T17:49:34.273
> 
> 标签：sql, database, sql-server-2008

我想在数据库中实现质量、体积、温度等单位的单位转换功能。我的背景是软件开发，所以我自然倾向于为此任务创建一堆用户定义的函数。但我偷偷怀疑有一种更“SQLish”的方式来实现这一点。

基于表格的方法，例如[此处](https://stackoverflow.com/questions/3956044/how-do-you-model-a-table-for-unit-conversion)或[此处](https://stackoverflow.com/questions/4495813/sql-custom-unit-conversion)描述的方法会非常好，但我认为没有简单的方法可以将这种方法扩展到与单个乘数无关的单位，例如温度（F-to-C，C -to-F) 或原子质量 (kgmol-to-kg)。我见过多步骤方法（例如[此处](https://dba.stackexchange.com/a/18556/8521)描述的方法），但这些方法似乎过于复杂而无用。

我在这里遗漏了一些明显的东西，还是函数真的是唯一的方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-21T17:55:36.877

要处理温度转换，您的转换表应该有一个乘数和一个偏移量。例如，对于 F --> C，偏移量为 -32，乘数为 5/9。

如果您事先知道所有可能的单位，那么基于表格的消息就可以正常工作。但是，如果您想要一个完全灵活的系统，例如米^5*升到英寸^5*加仑，那么您需要一个贝司单位表和一个用户定义的函数来进行转换。此函数可能会使用递归 cte 来解析单位表达式。所有这些都会相当复杂，所以希望你有一个完整的单位列表。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-03T22:31:50.927

最后，我决定坚持使用 UDF。该决定的主要动机是基于表格的方法的复杂性似乎不合理，因为这项任务的频率很低。此外，一些函数（例如`ConvertMass()`）依赖于子查询（例如，确定给定组件的原子量）。因此，UDF 似乎是最谨慎的方法。

# windows-7 - 詹金斯在映射驱动器上调用批处理文件

> ID：11143876
> 
> 赞同：1
> 
> 时间：2012-06-21T17:50:25.443
> 
> 标签：windows-7, batch-file, jenkins, clearcase

我有一个调用 ClearCase 驱动器 (V:) 上的批处理文件的 Jenkins 作业。

我的 Jenkins 从代理使用本地管理员帐户作为服务运行。Jenkins 的工作如下：

```
cleartool startview MY_VIEW
cd /d "V:\MY_VIEW\Build"
call PrepareBuild.bat 
```

当我运行 Jenkins 作业时，我不断收到“访问被拒绝”。在控制台输出中尝试调用批处理文件时。但是，如果我在命令提示符下手动运行上述命令，它会成功完成。

我在 Windows XP 下没有这个问题。有人知道为什么在 Windows 7（32 位）上会发生这种情况吗？

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-21T18:14:00.597

[是通过windows 命令](http://en.wikipedia.org/wiki/Subst)获得的`V:\`虚拟驱动器。 它是动态视图的根目录 ( ) 和虚拟驱动器之间的快捷方式。 （即，没有特别链接到 ClearCase。它只是用户希望关联到某个 ClearCase 视图根目录的驱动器号）[**`subst`**](http://en.wikipedia.org/wiki/Subst)
`M:\yourView`
`V:\`

但是，ClearCase 在注册表中注册了该关联`HKCU/software/atria/...`。

这意味着在 Jenkins 的本地管理员帐户下运行的 ClearCase 会话不会知道所述关联以及恢复该虚拟驱动器的需要。

一种解决方法是使用**[psubst](http://code.google.com/p/psubst/)**使该驱动器永久化。
在 中注册驱动器路径`[HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Session Manager\DOS Devices]`，并且`HKLM`可以从所有帐户访问。
请参阅“[如何使 SUBST 映射在重新启动后保持不变？](https://superuser.com/questions/29072/how-to-make-subst-mapping-persistent-across-reboots) ”

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-08-27T06:24:49.327

我有同样的问题。有一个更简单的解决方案。

Jenkins 无权访问只有用户有权访问的文件夹（即使它由用户运行）。因此，访问被拒绝的文件夹您需要为所有人而不是用户设置文件夹权限

# java - Java 图像加载不显示在 jar 中

> ID：11143878
> 
> 赞同：0
> 
> 时间：2012-06-21T17:50:35.820
> 
> 标签：java, eclipse, image, jar

我创建了一个小型图像加载应用程序，它只是在 res 文件夹中加载一个 .png。在 eclipse 运行中它会正常工作。但是当我将它导出到 jar 时，图像不包含在 jar 中，因此无法加载它。我试图将 res 文件夹添加到源路径，它将包含图像，但它包含在文件夹的根目录中（这不是图像应该在的位置）有谁知道我怎么能在jar中添加res文件夹？当我手动（使用 Lubuntus archivemanager）将 res 文件夹放入 jar 时，它会加载图像。

有什么想法可以用 Eclipse 将它添加到 jar 中吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-21T17:59:12.400

尝试将“res”文件夹设置为 java 源文件夹时，您走在正确的轨道上。如果您想在 JAR 中资源的最终路径中保留“res”，则 res 文件夹必须位于指定为源文件夹的文件夹内。

您可以将 res 文件夹移动到 src 文件夹下，也可以创建一个父文件夹来保存 res ...

选项1：

```
src (source folder)
.. res
.. .. image.png 
```

选项 2：

```
src (source folder)
resources (source folder)
.. res
.. .. image.png 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-21T18:02:58.473

如果您选择了“导出 -> JAR 文件”选项，则可以选择所有要包含的文件夹和文件。这些将被正确地包括在内，即他们的全名。

如果您选择了“Export -> Runnable JAR file”选项，这是不可能的。在这种情况下，您可以将导出脚本保存为 ANT 构建文件。在构建文件中，您可以编辑导出目标以包含 res 文件夹及其内容。

话虽如此，从长远来看，对于发布/JAR，Eclipse 的内置功能是可悲的。你真的想走蚂蚁/行家的路。它需要一些阅读，但之后它是自动的，比 Eclipse 提供的任何东西都少得多麻烦和灵活得多。

# java - 为什么 InetAddress.getLocalHost().getHostName() 返回与 bash“主机名”不同的值？

> ID：11143880
> 
> 赞同：15
> 
> 时间：2012-06-21T17:50:38.877
> 
> 标签：java, jenkins, gradle

我有一个 build.gradle 任务，它在我的开发盒上像冠军一样工作，生成一个属性文件，记录生成构建的机器的名称。逻辑很简单……

```
def hostname = InetAddress.getLocalHost().getHostName(); 
```

在我的开发盒上，这总是产生与我从 bash shell 生成主机名相同的值。

```
bobk-mbp:DM_Server bobk$ hostname
bobk-mbp.local 
```

然而，在我们的 jenkins CI 服务器上，bash 主机名返回一件事，但我调用 InetAddress.getLocalHost().getHostName(); 返回别的东西。詹金斯机器上需要改变什么才能让这两个返回相同的值？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-06-21T19:02:17.197

假设你在 linux 上，从 o/s 执行的 hostname 命令返回内核配置的主机名。

InetAddress.getHostName() 正在使用您的操作系统中配置的命名服务 (DNS) 对服务器的 IP 地址进行反向查找。

如果您需要操作系统理解的主机名，通过 System.getenv 从环境变量中获取它可能是最简单的选择。这不是一种完全可靠的方法，但它可能就足够了，无需深入研究网络或系统管理员。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-06-21T18:56:00.310

来自 InetAddress.getHostName() 的 API 文档；

> 如果这个 InetAddress 是用一个主机名创建的，这个主机名会被记住并返回；否则，将执行反向名称查找，并根据系统配置的名称查找服务返回结果。如果需要查找名称服务，请调用 getCanonicalHostName。

所以你可能需要在 Jenkins 服务器上配置 DNS。最简单的方法是编辑 /etc/hosts （我假设你的 Jenkins 在 Linux 上运行）并确保它看起来像这样：

```
127.0.0.1           localhost       localhost.localdomain
<public IP address> <hostname>      <hostname>.<domain> 
```

# asp.net-mvc - KnockoutJS 模型绑定之前的 MVC 模型绑定

> ID：11143882
> 
> 赞同：1
> 
> 时间：2012-06-21T17:50:41.410
> 
> 标签：asp.net-mvc, razor, knockout.js

所以如果你的控制器动作返回一个带有预填充值的模型，你如何让 KnockoutJS 知道它们呢？

例如：

`@Html.TextBoxFor(m => m.Title, new { data_bind="value: title"} )`

但是，在`$(document).ready()`我绑定 knockout.js ViewModel 的位置上，此值尚未填充：

```
$(document).ready({
  var viewModel = {
    title: ko.observable($("#Title").val()) // too early for this?!
  }

  ko.applyBindings(viewModel);​
}); 
```

你如何让 KnockoutJS 与 MVC 的模型绑定一起工作？我发现的一种解决方法是在我的 Razor 视图中设置 JavaScript 变量，如下所示：

```
<script>
  var strTitle = '@Model.Title';
</script> 
```

而不是在 Knockout 模型绑定中使用它。这行得通，但我讨厌它。如果您的表单有数百个字段怎么办？您不希望页面中有那么多 JavaScript 变量。我在这里错过了显而易见的事情吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-21T20:51:41.307

这似乎类似于[这个问题](https://stackoverflow.com/questions/10886795/knockout-js-load-form-into-viewmodel/10887875#10887875)。通常，您可以通过在脚本中将 @Model 转换为 JSON 来设置视图模型：

```
<script type="text/javascript">
var model = @(new HtmlString(new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(Model)));
</script> 
```

您还可以创建自己的绑定处理程序，该处理程序最初将根据控制值加载视图模型。这个新`myvalue`的处理程序基本上调用现有的`value`处理程序，除了它*从*init 的初始控制值更新视图模型。

```
ko.bindingHandlers['myvalue'] = {
    'init': function (element, valueAccessor, allBindingsAccessor) {
        // call existing value init code
        ko.bindingHandlers['value'].init(element, valueAccessor, allBindingsAccessor);

        // valueUpdateHandler() code
        var modelValue = valueAccessor();
        var elementValue = ko.selectExtensions.readValue(element);
        modelValue(elementValue); // simplified next line, writeValueToProperty isn't exported
        //ko.jsonExpressionRewriting.writeValueToProperty(modelValue, allBindingsAccessor, 'value', elementValue, /* checkIfDifferent: */ true);
    },
    'update': function (element, valueAccessor) {
        // call existing value update code
        ko.bindingHandlers['value'].update(element, valueAccessor);
    }
}; 
```

然后，当您调用 ko.applyBindings 时，您的 observable 将根据控件的初始值进行设置：

```
<input type="text" data-bind="myvalue: Title" value="This Title will be used" />
<input type="text" data-bind="value: Title" value="This will not be used" />
<!-- MVC -->
@Html.TextBoxFor(m => m.Title, new { data_bind="myvalue: Title"} ) 
```

[样品小提琴](http://jsfiddle.net/YG8Tu/3/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-21T18:07:55.957

使用 JSON.NET 或类似方法将整个页面模型简单地序列化为 json 怎么样。然后，您的页面将通过非 js 用户的普通 razor 视图绑定填充。然后你的页面脚本可以是这样的：

```
<script>
    ko.applyBindings(@Html.ToJSON(Model));
</script> 
```

或者，如果您有一个类型化的 viewModel

```
<script>
    var viewModel = new MyViewModel(@Html.ToJSON(Model));
    ko.applyBindings(viewModel);
</script> 
```

将客户端和实际视图模型构造成相同是有意义的，因此不需要对 json 形状进行操作。

**编辑**

toJSON 帮助程序的示例。

```
public static MvcHtmlString ToJson(this HtmlHelper html, object obj)
{
  JavaScriptSerializer serializer = new JavaScriptSerializer();
  return MvcHtmlString.Create(serializer.Serialize(obj));
} 
```

希望这可以帮助。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2015-06-04T13:46:04.807

因为我没有 50 分的声誉来为[Jason Goemaat 答案](https://stackoverflow.com/questions/10643940/knockout-js-access-viewmodel-in-javascript-function-outside-viewmodels-scope/10644169#10644169 "Jason Goemaat 回答")添加评论，所以我决定在此处添加我的评论作为答案。

所有的功劳都归杰森·戈马特所有。

我无法让代码为我工作。所以我不得不做一个小小的改变。

```
 ko.bindingHandlers['myvalue'] = {
    'init': function (element, valueAccessor, allBindingsAccessor) {
        //get initial state of the element            
        var modelValue = valueAccessor();
        var elementValue = ko.selectExtensions.readValue(element);

        // call existing value init code
        ko.bindingHandlers['value'].init(element, valueAccessor, allBindingsAccessor);

        //Save initial state
        modelValue(elementValue);
    },
    'update': function (element, valueAccessor) {
        // call existing value update code
        ko.bindingHandlers['value'].update(element, valueAccessor);
    }
}; 
```

如果我在顶部有这条线，

```
// call existing value init code
ko.bindingHandlers['value'].init(element, valueAccessor, allBindingsAccessor); 
```

它正在删除元素的原始状态。所以无论我在输入字段中有什么值，它都被删除了。

在模型里面我有这个：

```
//publishing comment
self.publishingComment = ko.observable(); 
```

我的 MVC 看起来像这样

```
@Html.TextBoxFor(model => model.Comment, new { data_bind = "myvalue: publishingComment" }) 
```

# java - 在 JXLabel 中的图标上显示文本

> ID：11143884
> 
> 赞同：1
> 
> 时间：2012-06-21T17:50:47.237
> 
> 标签：java, swing, jlabel, swingx

我正在使用 SwingX 标签进行图像选择/预览。
我需要同时显示文本和图标，但是当我设置图标时，文本消失了！
如何在 JXLabel 上的图标上显示文本？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-21T18:11:23.797

没有问题，有两种方法

1.正确的方式（在API中实现，好习惯，blablabla）

```
JLabel.setHorizontalTextPosition(JLabel.CENTER); 
// search for equivalent in SwingX 
```

2.疯狂的方式来设置适当`LayoutManager`的位置`JXLabel`并将另一个放置`JXLabel`到所需的坐标`Location`

# string - 在TCL中如何操作字符串？

> ID：11143892
> 
> 赞同：0
> 
> 时间：2012-06-21T17:51:10.117
> 
> 标签：string, tcl

我对 TCL 中的字符串有疑问：

```
HANDLE_NAME "/group1/team1/RON"

proc HANDLE_NAME {playerName} {
    #do something here
} 
```

我们将字符串“/group1/team1/RON”传递给proc，但是在HANDLE_NAME内部的某个地方，我们只需要最后一部分“RON”，如何操作输入字符串并获取输入的最后一部分（只有RON）并将其设置为变量？

谁能帮忙？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-21T18:24:37.287

```
proc HANDLE_NAME {playerName} {
    set lastPart [lindex [split $playerName "/"] end]
    # ...
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-27T10:55:37.380

并添加第四个答案，如果字符串实际上是文件的路径，请使用`file`：

```
set filename [file tail $playerName] 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-21T18:26:36.863

使用字符串 last 查找最后一个正斜杠。然后使用字符串范围获取之后的文本。 [http://tcl.tk/man/tcl8.5/TclCmd/string.htm](http://tcl.tk/man/tcl8.5/TclCmd/string.htm)

```
set mystring "/group1/team1/RON"
set slash_pos [string last "/" $mystring]
set ron_start_pos [incr slash_pos]
set ron [string range $mystring $ron_start_pos end] 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-24T14:19:41.283

要添加第三个答案，您也可以`regexp`在字符串末尾使用锚定。

```
regexp {/([^/]+)$} $playerName -> lastPart 
```

但是如果您使用的字符串类似于文件路径，那么 acheong87 的 lindex/split 解决方案肯定是更自然的方式。

# c#-4.0 - 如何在 CRM 2011 On-Premise 中将地理位置添加到服务调度

> ID：11143899
> 
> 赞同：2
> 
> 时间：2012-06-21T17:51:50.387
> 
> 标签：c#-4.0, plugins, dynamics-crm, dynamics-crm-2011, crm

这更多是关于设计方法的一般问题，而不是特定的编程挑战。我们有安排资源的业务需求，但为了降低差旅成本，我们需要能够为地理位置相近的客户预约安排资源。这些约会通常在客户家中，而不是在指定地点。

进行地理定位的过程是获取客户的位置和选择的服务活动，找到在该时间范围内可用的所有资源，然后根据他们之前的预约位置按接近顺序对它们进行排名。

这一切都很好，但我遇到的问题是我在哪里插入这个逻辑？它会在通过插件在服务预约实体上的“预订”消息期间出现吗？这对最终用户会有什么影响？我是否必须在自定义 aspx 页面中模拟服务日历功能才能完成此操作？

有没有更好的方法来做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-21T19:56:32.423

您可以通过 JavaScript 执行此操作...

1) 创建与服务预约实体的服务代表关系。将服务代表查找添加到服务预约实体。

2）创建一个虚拟文本属性并添加到服务预约表单

3) 获取满足您的可用性标准的所有记录，并使用第三方地图服务或基于 lng/lat 距离来确定谁是最近的。

[FetchXML - GeoCode 按距离搜索距离](https://stackoverflow.com/questions/11077376/fetchxml-geocode-distance-search-by-distance/11143868#11143868)

4) 将您的虚拟文本框切换为选择并添加 10 个最近的服务代表的选项及其姓名和距离（即 Paul Way - 1.2 英里）

5）当新的选择框值改变时，填充表单上的rep属性。

6）测试后，通过javascript隐藏rep属性，以便保存更改，但用户被迫使用自定义选择框。

# iphone - 高流量网站。每天超过 1000 万用户。VPS还是专用服务器？

> ID：11143903
> 
> 赞同：1
> 
> 时间：2012-06-21T17:52:00.093
> 
> 标签：iphone, ios, debian, vps

我们即将推出一款 iPhone 应用程序，如果一切顺利，我们每天可能会接触到数千万用户。

您会为此使用什么服务器解决方案？我想一个小的 VPS 是不够的。专用服务器是更好的选择吗？有没有好的托管服务提供商可以提供这样的服务器？

我是服务器方面的新手，想了解一些有关如何处理此问题的基本信息。

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-21T18:09:50.850

不幸的是，在应用程序启动之前，您不会真正了解应用程序的要求。这完全取决于应用程序需要与服务器进行多少通信，以及用户使用该应用程序的频率。根据这些变量甚至更多，一个 VPS 可能就足够了，或者您可能需要一个或多个专用盒子。它还很大程度上取决于 VPS 和专用盒子的性能，此外还取决于您需要多少访问系统。

最终，您似乎甚至不知道该应用程序的性能如何，因此我建议您采取廉价/高效的方式使用云计算。这样，当您的应用程序的用户群较小时，您将首先限制您的费用。然后，您的性能可以根据您的应用程序的需要快速提升（当然价格也会如此）。这就是云计算的好处，在你有足够的用户群来使用你的服务器到它的极限之前，你一开始不会亏本。此外，当/如果您的服务器不再足够时，您没有停机时间等。

查看[Google 的云计算](https://developers.google.com/appengine/)以了解可能的情况。我个人喜欢谷歌的云体验，但你有更多的选择和不同程度的自由，你必须检查一下。[亚马逊](http://aws.amazon.com/)当然是另一种可能性。

# c# - 如何防止表单在仍接收鼠标点击的同时窃取焦点？

> ID：11143905
> 
> 赞同：6
> 
> 时间：2012-06-21T17:52:13.763
> 
> 标签：c#, winforms

我正在尝试在 WinForms 中创建自定义 AutoCompleteTextBox 控件。基本 TextBox 提供的 AutoComplete 仅提供结果，`(string).StartsWith`而不是`(string).Contains`.

我将自动完成搜索结果显示在`ListBox`停靠在单独的`Form`. 我可以防止`Form`最初使用通过以下方式窃取焦点：

```
protected override bool ShowWithoutActivation
{
   get { return true; }
} 
```

然后，我可以通过以下方式覆盖该方法来防止`Form`完全获得焦点：`WndProc`

```
protected override void WndProc( ref Message m )
{
    base.WndProc( ref m );
    switch ( m.Msg )
    {
        case WM_MOUSEACTIVATE:
            m.Result = ( IntPtr ) MA_NOACTIVATEANDEAT;
            break;

        default:
            break;
    } 
```

当我这样做时，`ListBox`包含在`Form`将接收`MouseMoved`事件，但不接收`MouseClicked`事件。

更改`MA_NOACTIVATEANDEAT`为只会`MA_NOACTIVATE`将鼠标事件传递给`ListBox`，但随后会导致单击以从驻留中`ListBox`窃取焦点- 将其传递给“浮动”所在。`Form``ListBox``Form``ListBox`

有什么办法可以防止“浮动”`Form`从“主要”集中注意力，`Form`同时仍然在`MouseClick`内部获取事件`ListBox`？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-29T15:58:50.907

除了 Angshuman Agarwal 先前的回答：如果您希望主窗体在 UserControl 显示为浮动窗体时不停用，请修改一些代码到您的 UserControl：

```
private Control _mControl;

[DllImport("user32.dll")]
static extern IntPtr SendMessage(IntPtr hwnd, int wMsg, IntPtr wParam, IntPtr lParam);

public new void Show(Control c)
{
    if (c == null) throw new ArgumentNullException();
    _mControl = c;
    if (this.Handle == IntPtr.Zero) base.CreateControl();
    SetParent(base.Handle, IntPtr.Zero);
    ShowWindow(base.Handle, 1);
}

protected override void WndProc(ref Message m)
{
    if (m.Msg == 0x86)  //WM_NCACTIVATE
    {
        if (m.WParam != IntPtr.Zero) //activate
        {
            SendMessage(_mControl.Handle, 0x86, (IntPtr)1, IntPtr.Zero);
        }
        this.DefWndProc(ref m);
        return;
    }
    base.WndProc(ref m);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-01-30T16:08:12.913

我创建了一些类似的东西，我的解决方案与 lAbstract 建议的类似。floatin 表单有一个事件 DoReturnFocus ，自定义 TextBox（在本例中为 AutoCompleteTextBox 控件）订阅了该事件，并将焦点设置回自身。为了防止主窗体出现在浮动窗体的前面，我将主窗体设置为浮动窗体的**所有者**，因为拥有的窗体永远不会显示在其所有者窗体的后面。

更多关于[Form.Owner 属性](http://msdn.microsoft.com/en-us/library/system.windows.forms.form.owner%28v=vs.110%29.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-21T22:33:15.657

将您的浮动表单转换`Usercontrol`为如下所示：- 将 ListBox 拉到其上并挂接到 Click 事件以模拟您的 Focus 场景。

```
using System.Text;
using System.Windows.Forms;
using System.Runtime.InteropServices;

namespace WindowsFormsApplication3
{
    public partial class InactiveForm : UserControl
    {
        private const int WS_EX_TOOLWINDOW = 0x00000080;
        private const int WS_EX_NOACTIVATE = 0x08000000;
        private const int WS_EX_TOPMOST = 0x00000008;

        [DllImport("user32")]
        public static extern int SetParent
         (IntPtr hWndChild, IntPtr hWndNewParent);

        [DllImport("user32")]
        public static extern int ShowWindow
         (IntPtr hWnd, int nCmdShow);

        protected override CreateParams CreateParams
        {
            get
            {

                CreateParams p = base.CreateParams;
                p.ExStyle |= (WS_EX_NOACTIVATE | WS_EX_TOOLWINDOW | WS_EX_TOPMOST);
                p.Parent = IntPtr.Zero;
                return p;
            }
        }

        public InactiveForm()
        {
            InitializeComponent();
        }

        public new void Show()
        {
            if (this.Handle == IntPtr.Zero) base.CreateControl();

            SetParent(base.Handle, IntPtr.Zero);
            ShowWindow(base.Handle, 1);
        }

        private void OnListBoxClicked(object sender, EventArgs e)
        {
            MessageBox.Show("Clicked List Box on floating control");

        }
    }
} 
```

**MainForm 中的代码（带有按钮及其单击处理程序）：-**

这将调用带有 ListBox 的浮动控件。

```
namespace WindowsFormsApplication3
{
    public partial class Form1 : Form
    {
        public Form1()
        {
            InitializeComponent();
        }

        private void button1_Click(object sender, EventArgs e)
        {
            InactiveForm f = new InactiveForm();
             f.Show();
        }
    }
} 
```

当您将 UserControl（无边框表单）显示为浮动表单时，您会注意到`it wont receive focus even if you clicked (selected) any of its children`. 在这种情况下，子项是用户控件上的 ListBox。

请参阅[此处](http://forums.codeguru.com/showthread.php?469933-Adding-NoActivate-to-a-New-Form)和[此处](http://social.msdn.microsoft.com/forums/en-US/winforms/thread/3f1c4191-38f4-4d15-a633-9f57cff289e4/)。

# direct3d - 如何检测 PIX 是否正在运行？

> ID：11143906
> 
> 赞同：0
> 
> 时间：2012-06-21T17:52:13.883
> 
> 标签：direct3d

我的应用程序以几种不同的方式适应缓慢的帧速率。当我运行 PIX 实验时，渲染变得慢得多，因此这些技术被激活。当我想使用 PIX 时，我想禁用它而不必进行单独的构建。就像是：

```
if (running_slow() && !running_pix()) {
    reduce_graphics();
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-22T23:23:05.587

在 DirectX 2010 年 6 月 SDK 中：

```
bool running_pix() {
    return D3DPERF_GetStatus() != 0;
} 
```

# ios - FlashBuilder 4.6 - 如何为移动和桌面发布设置项目？

> ID：11143907
> 
> 赞同：3
> 
> 时间：2012-06-21T17:52:23.460
> 
> 标签：ios, flash, apache-flex, air, flash-builder

我有一个使用 FlashBuilder 4.6 创建的项目作为针对 iOS 的“Actionscript Mobile Project”。

我希望能够为桌面编译相同的项目。如何更改项目，以便在 IPA 文件旁边还创建一个桌面 AIR 文件 - 或者如何在两者之间快速切换？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-09-10T18:36:44.450

好吧，您可以从 Actionscript 移动项目中部署到桌面，但您只能获得有限的选项：

转到“导出发布版本”->“导出为”，选择“用于...桌面的签名 AIR 包”。

而已。刚刚做到了，对此感到有些满意。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-04-08T12:03:16.687

我知道这不会真正回答这个问题，但实际上看起来不可能做到这一点。

我发现实现这个目标的最好方法（1个代码-> destop + mobile）是制作2个项目1个用于移动设备，1个用于桌面，共享同一个包含我的应用程序类的单个库+共享资产等......唯一不能共享的是描述符 xml 文件 + 基类文件（尽管设置这些文件是一次性任务）。

可以在 Chris Campbell reversi 项目页面上找到有关工作原理的一个很好的说明：[在此处查看他帖子中的最后一个屏幕截图](http://blogs.adobe.com/cantrell/archives/2010/04/one_application_five_screens.html)

我希望这有帮助...

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-21T18:16:43.030

您不能从同一个 Flash Builder 项目同时部署到桌面设备和移动设备。

一种选择是将您的共享代码移动到库项目中，然后为移动设备和桌面创建一个项目，每个项目都依赖于库中的共享代码。

另一种选择是使用命令行工具进行编译。

# python - 在python中将具有时区缩写的非UTC时间字符串转换为UTC时间，同时考虑夏令时

> ID：11143910
> 
> 赞同：5
> 
> 时间：2012-06-21T17:52:28.350
> 
> 标签：python, utc, dst, pytz, python-dateutil

由于时区缩写，我很难将非 UTC 时间的字符串表示形式转换为 UTC。

**（更新：似乎[时区缩写可能不是唯一的](https://stackoverflow.com/questions/5946499/how-to-get-the-common-name-for-a-pytz-timezone-eg-est-edt-for-america-new-york?rq=1)。如果是这样，也许我也应该考虑到这一点。**）

我一直在尝试使用 datetutil 和 pytz 寻找解决此问题的方法，但没有任何运气。

建议或解决方法将不胜感激。

```
string = "Jun 20, 4:00PM EDT" 
```

**我想将其转换为 UTC 时间，并在适当的时候考虑夏令时。**

**更新：**找到一些可以帮助更有经验的用户回答问题的参考资料。

从本质上讲，我会想象部分解决方案会与[此](https://stackoverflow.com/questions/5946499/how-to-get-the-common-name-for-a-pytz-timezone-eg-est-edt-for-america-new-york?rq=1)相反。

**最终更新（重要）**

取自[dateutil 文档示例](http://labix.org/python-dateutil#head-587bd3efc48f897f55c179abc520a34330ee0a62)。

**一些基于 date 命令的简单示例，使用 TZOFFSET 字典提供 BRST 时区偏移量。**

> > > parse("Thu Sep 25 10:36:28 BRST 2003", tzinfos=TZOFFSETS) datetime.datetime(2003, 9, 25, 10, 36, 28, tzinfo=tzoffset('BRST', -10800))
> > > 
> > > parse("2003 10:36:28 BRST 25 Sep Thu", tzinfos=TZOFFSETS) datetime.datetime(2003, 9, 25, 10, 36, 28, tzinfo=tzoffset('BRST', -10800))

**[将此与此处](https://stackoverflow.com/questions/1703546/parsing-date-time-string-with-timezone-abbreviated-name-in-python/4766400#4766400)的库相结合。你将有一个解决这个问题的方法。**

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-21T19:03:47.243

使用[Nas Banov 出色的字典](https://stackoverflow.com/a/4766400/366335)将时区缩写映射到 UTC 偏移量：

```
import dateutil
import pytz

# timezone dictionary built here: https://stackoverflow.com/a/4766400/366335
# tzd = {...}

string = 'Jun 20, 4:00PM EDT'
date = dateutil.parser.parse(string, tzinfos=tzd).astimezone(pytz.utc) 
```

# c# - c# TreeView 获取父节点索引

> ID：11143915
> 
> 赞同：0
> 
> 时间：2012-06-21T17:52:49.513
> 
> 标签：c#, asp.net, treeview

在展开 asp:treeView 如何获取已花费的索引？

我试图调查： ontreenodeexpanded="Node_Expand" 但我找不到被点击的父根的索引。

谢谢，

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-21T17:59:47.180

您展开的节点是[事件参数](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.treenodeeventargs.aspx)的 Node 属性：

```
// Inside the event handler method
TreeNode clickedNode = e.Node; 
```

您可以使用存储节点的[TreeNodeCollection的](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.treenodecollection.aspx)[IndexOf](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.treenodecollection.indexof.aspx)方法获取其索引。

# android - findeViewById 返回 null

> ID：11143921
> 
> 赞同：0
> 
> 时间：2012-06-21T17:53:23.550
> 
> 标签：android

我正在尝试基于 hello map tutorial 构建一个简单的 Maps 应用程序，但`MapView`获得的`findViewById`返回 null。但是，地图在模拟器中正确显示。所以该应用程序有效，但我无法在代码中检索地图视图。我错过了什么？

代码：

```
public class HelloMapActivity extends MapActivity {

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        MapView mapView = (MapView) findViewById(R.id.mapview);
        if (mapView == null) {
            Log.d("onCreate", "map is null"); //log shows that mapView is null
        }
        setContentView(R.layout.main);
    }

    @Override
    protected boolean isRouteDisplayed() {
        return false;
    }
} 
```

布局：

```
<?xml version="1.0" encoding="utf-8"?>
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:id="@+id/mainlayout"
    android:orientation="vertical"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent" >

    <com.google.android.maps.MapView
        android:id="@+id/mapview"
        android:layout_width="fill_parent"
        android:layout_height="fill_parent"
        android:clickable="true"
        android:apiKey="the key"
    />

</RelativeLayout> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-21T17:54:39.067

`setContentView(R.layout.main)`必须在您的`MapView`.

```
@Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);
        MapView mapView = (MapView) findViewById(R.id.mapview);
        if (mapView == null) {
            Log.d("onCreate", "map is null"); //log shows that mapView is null
        }
    } 
```

我建议您`setContentView`在致电后立即 添加`super.onCreate(savedInstanceState)`。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-21T17:54:17.360

`setContentView(R.layout.main);`应该来`before` `MapView mapView = (MapView) findViewById(R.id.mapview);`

```
@Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);

         setContentView(R.layout.main); //<----------------------------------------

        MapView mapView = (MapView) findViewById(R.id.mapview);
        if (mapView == null) {
            Log.d("onCreate", "map is null"); //log shows that mapView is null
        }

    } 
```

# symfony - 命令行中带有教义：生成：实体的可空或唯一字段？

> ID：11143923
> 
> 赞同：4
> 
> 时间：2012-06-21T17:53:26.827
> 
> 标签：symfony, doctrine-orm

我正在学习 Symfony2 中使用 Doctrine 的数据库，我想知道是否也可以使用以下命令直接将字段设置为空或唯一：

> php 应用程序/控制台原则：generate:entity --entity="JeflopoStoreBundle:Product" --fields="myfield:text"

任何人都知道如何做到这一点或是否有可能？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-07-26T09:31:05.277

不幸的是，这似乎是不可能的。我检查了`Sensio\Bundle\GeneratorBundle\Command\GenerateDoctrineEntityCommand`课程，并在那里发现了它是如何解析给定字段的。它使用私有方法`parseFields`，并且有解析字段的所有逻辑。不幸的是，它只解析`name`,`type`和`length`，因此无法使用命令指定`nullable`或`unique`字段选项。`doctrine:generate:entity`

唯一的方法是自己扩展`Sensio\Bundle\GeneratorBundle\Command\GenerateDoctrineEntityCommand`类。

# sql - 将 DT_NTEXT 转换为 DT_Text

> ID：11143924
> 
> 赞同：1
> 
> 时间：2012-06-21T17:53:29.577
> 
> 标签：sql, sql-server, tsql, ssis

因此，我使用以下代码将日期转换为 MMDDYYYY：

```
replace(convert(varchar(10), Absent_Date, 101), '/', '') as Absent_Date 
```

当我在 Navicat 中运行它时，它运行良好，但是当我使用 SSIS 从存储过程导出到平面文件时，它收到以下错误消息

![在此处输入图像描述](../Images/e0af5155e5b3aea15cac80f4c431702c.png)

我从这里和其他论坛网站上阅读了大约 20 篇不同的帖子，但还没有找到适合我的帖子。我尝试使用数据转换对象，但无法让它工作。老实说，我不在乎它是什么格式，只要 SSIS 允许我导出到一个平面文件我有大约 20 个文本文件，其中的日期需要采用相同的格式。任何帮助是极大的赞赏！

我在 Sql Server 2008 R2

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-21T22:33:07.090

根据您捕获的错误，我假设来自您的源（OLE、ADO 等）的元数据表明 Absent_Date 列是 DT_NTEXT。然后，解决方案是将其转化为“有效”的东西。我通常将两个数据转换任务 NTEXT 应用到 TEXT，然后将该 TEXT 转换为字符串类型。如果您的数据是 unicode，那么它只是 NTEXT 到 WSTR 的转换，但我是一个愚蠢的美国人。

在这里，您可以看到我的 OLE DB 源的输出元数据表明 Absent_Date 是 NTEXT。最后一步（位桶）将显示长度为 10 的新列 STR_Absent_Date，数据类型为 DT_STR（代码页 1252）

![在此处输入图像描述](../Images/863192889c31a717e47d835ce59897bc.png)

采用这种方法应该允许您将 NTEXT 数据转换为与平面文件目标兼容的内容。

# c# - 从具有 read_stream 权限的 facebook 图表中获取空的“数据”：[]

> ID：11143928
> 
> 赞同：0
> 
> 时间：2012-06-21T17:53:43.507
> 
> 标签：c#, facebook, json, facebook-graph-api

当我使用**read_stream**权限时，我从**json facebook graph**得到空的“数据”：[]

 ****但是**我从这个页面获取了一个令牌：http: [//developers.facebook.com/docs/reference/api/#auth](http://developers.facebook.com/docs/reference/api/#auth)

我正在获取**完整数据**

它们都具有相同的**read_stream**权限....

该怎么办？我了解代币是临时的

**顺便说一句：发布代币不安全吗？**

**更新！！我没有在 BAD Token 中添加*书签：1* .. 我如何得到它？**

示例::

**坏不工作令牌：**

[https://graph.facebook.com/717054208/links&fields=link,picture,id,name?access_token=AAABkiSd72F4BAB8lZB6ZBzBv7ZChNDINOD60tmsxrxmjCDzOOD6XDrnFPuA1Es0Lp5GDFHUsGkz7WnIgYxr8GBYZBtOtrHipV0AQzTOVFAZDZD](https://graph.facebook.com/717054208/links&fields=link,picture,id,name?access_token=AAABkiSd72F4BAB8lZB6ZBzBv7ZChNDINOD60tmsxrxmjCDzOOD6XDrnFPuA1Es0Lp5GDFHUsGkz7WnIgYxr8GBYZBtOtrHipV0AQzTOVFAZDZD)

> {数据：[{已安装：1，read_stream：1，user_status：1，书签：1}]}

.

.

**良好的工作令牌：**

[https://graph.facebook.com/717054208/links&fields=link,picture,id,name?access_token=AAAAAAITEghMBABD81Bg6CZCCWkHPfgE0pQN3bQmGdsZBeNcEwVmEuluyWaon7ZBUXhjflgiWFQzfyPFTlyPVAKvhit15bhDAcIrl3gCsgZDZD](https://graph.facebook.com/717054208/links&fields=link,picture,id,name?access_token=AAAAAAITEghMBABD81Bg6CZCCWkHPfgE0pQN3bQmGdsZBeNcEwVmEuluyWaon7ZBUXhjflgiWFQzfyPFTlyPVAKvhit15bhDAcIrl3gCsgZDZD)

> {数据：[{已安装：1，read_stream：1，user_status：1，书签：1}]}

**如您所见，这是相同的前提！！！**

它不工作....

**请查看 GOOD 令牌......它具有相同的权限......**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-25T08:18:44.277

这是 Facebook API 中随机发生的已知错误。

在我与支持开发人员交谈后，它现在已修复

谢谢大家！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-21T18:11:34.073

您对[第二个令牌](https://developers.facebook.com/tools/debug/access_token?q=AAAAAAITEghMBABD81Bg6CZCCWkHPfgE0pQN3bQmGdsZBeNcEwVmEuluyWaon7ZBUXhjflgiWFQzfyPFTlyPVAKvhit15bhDAcIrl3gCsgZDZD)的权限比您在上面示例中列出的[第一个令牌的权限多得多。](https://developers.facebook.com/tools/debug/access_token?q=AAABkiSd72F4BANDddHRuaZAyXLxmHzFFPC57Pnmb9vRkZBfZCr9py146fyEJZBNveiCq702thsAhZClYr3UHGKZCJS4PZBZCxpk9nZAqenZAFfEgZDZD)

[您查询的 object_id](https://developers.facebook.com/tools/explorer?method=GET&path=717054208)看起来不像是您自己的个人资料，因此您可能需要一个类似`friends_activies`.

顺便说一句：在上面的示例中，您的令牌权限已被反转。**

# java - 将 JCheckBoxes 添加到除最后一个单元格之外的列中的所有单元格

> ID：11143929
> 
> 赞同：0
> 
> 时间：2012-06-21T17:53:45.013
> 
> 标签：java, jtable, jcheckbox

在我的表格模型中，我返回`Boolean.class`以便`getColumnClass`复选框显示在第一列中。是否可以在除最后一个单元格（总计旁边）之外的第一列中的所有单元格中添加复选框？见截图。谢谢！

![在此处输入图像描述](../Images/4ced1f4f198625a9c0b2206b2fd95c44.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-21T18:01:02.747

当然，您只需要实现一个`TableCellRenderer`在呈现最后一行 && 第一列时返回 null 的方法，如下所示：

```
public class CustomTableCellRenderer implements TableCellRenderer {

    private final TableCellRenderer decorate;

    public CustomTableCellRenderer(final TableCellRenderer decorate) {
        super();
        this.decorate = decorate;
    }

    public Component getTableCellRendererComponent(final JTable table, final Object value,
            final boolean isSelected, final boolean hasFocus, final int row, final int column) {
        if (column == 0 && row == table.getRowCount() - 1) {
            return null;
        }
        return decorate.getTableCellRendererComponent(table, value, isSelected, hasFocus, row, column);
    }
} 
```

现在您需要使用此实现的实例设置布尔单元格的 CellRenderer，例如：

```
 TableColumn column = table.getColumnModel().getColumn(0);
    column.setCellRenderer(new CustomTableCellRenderer(table.getDefaultRenderer(Boolean.class))); 
```

使用此实现，最后一行/第一列将显示为空。

# facebook - 无法从 Facebook iOS 应用中的通知中获取 request_ids

> ID：11143931
> 
> 赞同：0
> 
> 时间：2012-06-21T17:53:47.440
> 
> 标签：facebook, facebook-app-requests

我有一个 iOS 应用程序可以通过 facebook ios sdk 发送 apprequest。我还在developers.facebook.com 中设置了Canvas URL 和Native iOS App。

发送 apprequest 时，facebook iOS 应用的通知列表中会显示通知，点击通知，我的 iOS 应用已启动并调用 openURL 方法，但 URL 不包含 request_ids。

像这样的网址：

fb[myappid]://authorize#expires_in=3600&access_token=xxx&target_url=http://apps.facebook.com/apps/application.php?id=[myappid]

难道我做错了什么？

PS。画布 URL 工作正常，当单击 facebook 网站上的通知时，request_ids 按预期传递给画布 URL。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-17T08:55:47.193

确保您不仅为“Facebook 上的应用程序”设置了画布 URL，而且还设置为**“移动网站”**并插入“移动站点 URL”。

这里是 Facebook iOS SDK HowTo 的截图[：发送请求](https://developers.facebook.com/docs/howtos/send-requests-using-ios-sdk/)

![移动网络](../Images/ac8a24e0bafc44f02106110bc408e347.png)

# tomcat - 重新配置/配置 Tomcat 日志记录？

> ID：11143933
> 
> 赞同：0
> 
> 时间：2012-06-21T17:53:53.937
> 
> 标签：tomcat, logging, configuration

我已经阅读了 Tomcat 的文档并在线查看了如何执行此操作，但我似乎无法让它工作。2010 年，我用 Tomcat 搞砸了我的生产 VPS 上的配置。很大程度上是由于脑瘤，我不记得我对我的 Tomcat 日志文件做了什么，我正在尝试为我配置的每个应用程序重建它，`server .xml`如下所示：

```
<Host appBase="webapps/buhaugane.com" name="buhaugane.com" 
    unpackWARs="true" autoDeploy="true">
    <Alias>www.buhaugane.com</Alias>
    <Logger className="org.apache.catalina.logger.FileLogger" prefix="buhaugane" 
        suffix=".txt"  directory="logs" timestamp="true"/>
    <Context path="" docBase="buhaugane" debug="0" reloadable="true"/>
</Host>

<Host appBase="webapps/thejarbar.org" name="thejarbar.org" 
    unpackWARs="true" autoDeploy="true">
    <Alias>www.thejarbar.org</Alias>
    <Context path="" docBase="tjb" debug="0" directory="logs" reloadable="true"/>
    <Logger classname="org.apache.catalina.logger.FileLogger" prefix="thejarbar" 
        suffix=".txt" directory="logs" timestamp="true"/>
</Host> 
```

我在我的 VPS 上的 Putty 中完成了以下操作：

*   `touch /opt/tomcat7/logs/buhaugane.txt`
*   `touch /opt/tomcat7/logs/thejarbar.txt`
*   `chown tomcat:tomcat /opt/tomcat7/logs/buhaugane.txt`
*   `chown tomcat:tomcat /opt/tomcat7/logs/thejarbar.txt`

然后我重新启动了服务器并请求了一个错误的请求，请求一个“404”预期失败的日志活动。

这似乎不是为每个应用程序配置 Tomcat 日志记录的正确方法，那么我该如何实现呢？我在正确的道路上吗？我不是在寻找 log4j 方法，因为我试图让我的 VPS 在生病前达到类似的状态。

社区可以帮助我，并可能解释 Tomcat 是否应该为我创建这些日志文件？如果是，为什么 Tomcat 不这样做，我可以预计它们位于哪里？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-23T22:16:28.017

我解决了我的问题。我的托管服务提供商有关于 Tomcat 日志文件位置的过时文档。即我`catalina.out`在`var/log/tomcat7`location 下，无处可下`/opt/tomcat7`。

# c# - 找不到类型或命名空间名称“T”

> ID：11143934
> 
> 赞同：56
> 
> 时间：2012-06-21T17:53:56.487
> 
> 标签：c#, generics

我有以下在 .NET 4.0 项目中编译的代码

```
namespace ConsoleApplication1  
{  
    class Program  
    {  
        static void Main(string[] args)  
        {  

        }  
    }  

    public static class Utility  
    {  
        public static IEnumerable<T> Filter1(this IEnumerable<T> input, Func<T, bool> predicate)  
        {  
            foreach (var item in input)  
            {  
                if (predicate(item))  
                {  
                    yield return item;  
                }  
            }  
        }  
    }  
} 
```

但出现以下错误。我已经将 System.dll 作为默认值包含在引用中。我可能做错了什么？

```
Error   1   The type or namespace name 'T' could not be found (are you missing a using directive or an assembly reference?) 

Error   2   The type or namespace name 'T' could not be found (are you missing a using directive or an assembly reference?) 

Error   3   The type or namespace name 'T' could not be found (are you missing a using directive or an assembly reference?) 
```

* * *

## 回答 #1

> 赞同：75
> 
> 时间：2012-06-21T17:55:33.210

您必须将类型参数放在函数本身上。

```
public static IEnumerable<T> Filter1<T>(...) 
```

* * *

## 回答 #2

> 赞同：50
> 
> 时间：2012-06-21T17:55:41.453

```
public static class Utility 
{  
    public static IEnumerable<T> Filter1<T>( // Type argument on the function
       this IEnumerable<T> input, Func<T, bool> predicate)  
    { 
```

如果您不关心它是否是扩展方法，则可以向类添加通用约束。我的猜测是你想要扩展方法。

```
public static class Utility<T> // Type argument on class
{  
    public static IEnumerable<T> Filter1( // No longer an extension method
       IEnumerable<T> input, Func<T, bool> predicate)  
    { 
```

* * *

## 回答 #3

> 赞同：18
> 
> 时间：2012-06-21T17:55:35.450

您需要声明`T`，它出现在方法名或类名之后。将您的方法声明更改为：

```
public static IEnumerable<T> 
    Filter1<T>(this IEnumerable<T> input, Func<T, bool> predicate) 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2019-05-17T14:26:28.340

我有同样的错误，但所需的解决方案略有不同。我需要改变这个：

```
public static void AllItemsSatisy(this CollectionAssert collectionAssert, ICollection<T> collection, Predicate<T> predicate) 
{ ... } 
```

对此：

```
public static void AllItemsSatisy<T>(this CollectionAssert collectionAssert, ICollection<T> collection, Predicate<T> predicate) 
{ ... } 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-21T17:55:39.153

<T> 表示对象的类型

```
IEnumerable<yourObject> 
```

在这里您可以获得更多信息：http: [//msdn.microsoft.com/en-us/library/9eekhta0.aspx](http://msdn.microsoft.com/en-us/library/9eekhta0.aspx)

# java - 为什么这个 JComponent 不能正确绘制？

> ID：11143937
> 
> 赞同：0
> 
> 时间：2012-06-21T17:53:59.057
> 
> 标签：java, swing, graphics, awt, paintcomponent

如果移动和调整大小，以下组件会正确绘制，但如果从屏幕外拖出则不会。

为什么？

```
public class Test_ShapeDraw {
public static class JShape extends JComponent {

    private Shape shape;
    private AffineTransform tx;
    private Rectangle2D bounds;

    public JShape() {
    }

    public void setShape(Shape value) {
        this.shape = value;
        bounds = shape.getBounds2D();
        setPreferredSize(new Dimension((int) bounds.getWidth(), (int)bounds.getHeight()));
        tx = AffineTransform.getTranslateInstance(-bounds.getMinX(), -bounds.getMinY());

    }

    public Shape getShape() {
        return shape;
    }

    @Override
    protected void paintComponent(Graphics g) {
        super.paintComponent(g);

        if( shape != null ) {
            Graphics2D g2d = (Graphics2D)g;
            g2d.setTransform(tx);
            g2d.setRenderingHint(RenderingHints.KEY_ANTIALIASING, RenderingHints.VALUE_ANTIALIAS_ON);
            ((Graphics2D)g).draw(shape);
        }

    }

}

public static void main(String[] args) {
    SwingUtilities.invokeLater(new Runnable() {
        @Override
        public void run() {
            createAndShowGUI();
        }
    });
}

private static void createAndShowGUI() {

    Shape shape = new Ellipse2D.Double(0,0,300,300);

    JShape jShape = new JShape();
    jShape.setShape(shape);

    JFrame f = new JFrame("Shape Test");
    f.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
    f.add(jShape);
    f.pack();
    f.setVisible(true);
}
} 
```

![如果从屏幕左边缘拖出，这就是它所绘制的](../Images/4e789335a377e54159fc6a9b7f6811a1.png)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-21T19:19:48.990

```
 AffineTransform originalTransform = g2d.getTransform();
            g2d.transform(tx);

            g2d.setRenderingHint(RenderingHints.KEY_ANTIALIASING, RenderingHints.VALUE_ANTIALIAS_ON);
            ((Graphics2D)g).draw(shape);

            g2d.setTransform(originalTransform); 
```

说明：请参阅 Graphics2D.setTransform 的 JavaDoc：警告：此方法绝不能用于在现有变换之上应用新的坐标变换，因为 Graphics2D 可能已经具有其他用途所需的变换，例如渲染 Swing 组件或应用缩放变换来调整打印机的分辨率。

要添加坐标变换，请使用变换、旋转、缩放或剪切方法。setTransform 方法仅用于在渲染后恢复原始 Graphics2D 变换。

[http://docs.oracle.com/javase/6/docs/api/java/awt/Graphics2D.html#setTransform%28java.awt.geom.AffineTransform%29](http://docs.oracle.com/javase/6/docs/api/java/awt/Graphics2D.html#setTransform%28java.awt.geom.AffineTransform%29)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-21T18:11:32.500

尝试删除 getPreferredSize() 方法并在 setShape 方法中使用 setPreferredSize() ：

```
public void setShape(Shape value) {
    this.shape = value;
    bounds = shape.getBounds2D();
    setPreferredSize(new Dimension((int) bounds.getWidth(), (int)bounds.getHeight()));
    tx = AffineTransform.getTranslateInstance(-bounds.getMinX(), -bounds.getMinY());
} 
```

# asp.net-mvc - ASP.NET MVC 4 - 嵌套模型 - 如何设置正确的关联？

> ID：11143939
> 
> 赞同：6
> 
> 时间：2012-06-21T17:54:05.340
> 
> 标签：asp.net-mvc, asp.net-mvc-3

我从 Rails 的背景来到 asp.net MVC 4，我在弄清楚如何处理嵌套模型时遇到了一些麻烦。

我正在使用带有 CodeFirst 方法的 Entity Framework 4.3。

该应用程序相当简单，并且有一个**Set**模型 - 它有许多**Franchises**。它有一个特许经营模式 - 属于 Sets。

POCO 类是与适当的导航属性一起创建的，然后我用视图搭建了控制器，然后生成了数据库。

以下是课程：

**放**

```
 namespace FranchiseManagerTest.Models
    {
        public class Set
        {        
            [Key]
            public int SetID { get; set; }
            public string SetName { get; set; }
            public string MainAddress { get; set; }
            public string TimeZone { get; set; }       
            public virtual ICollection<Franchise> Franchises { get; set; }
        }
    } 
```

**特许经营**

```
namespace FranchiseManagerTest.Models
{
    public class Franchise
    {
        [Key]
        public int FranchiseID { get; set; }        
        public int SetID { get; set; }
        public string FranchiseName { get; set; }
        public string FranchiseNumber { get; set; }     

        public virtual Set Set { get; set; }

    }
} 
```

然后我创建了一些测试特许经营集和特许经营权。

这是主要视图：

![在此处输入图像描述](../Images/805c517712bcb7b436edf19230964e65.png)

该项目要求与 Set 相关的所有特许经营权在相应的 Set 中可见。此外，当我在 Set 的详细信息中时，我需要能够向 Set 添加特许经营权。

我创建了一个屏幕截图来说明单击主视图上的“详细信息”后的样子：

![在此处输入图像描述](../Images/1e9e1786687738d422f546962155ce2b.png)

**New Franchise**按钮​​是使用如下所示的 ActionLink 创建的：

```
@Html.ActionLink("New Franchise", "Create", "Franchise", null,  new { @class = "btn btn-large btn-primary" }) 
```

这会将我带到如下所示的 Franchise Create 页面：

![在此处输入图像描述](../Images/355d1ff7259c95baed4fd53e38f9f01e.png)

**如您所见，问题在于未预先填充应包含相关集模型的下拉列表 - 相反，我必须单击下拉列表并重新选择我已经在其中的集。**

**下拉列表*正在*填充 - 但由所有现有的集合 - 而不是我所在的集合。**

这是我单击它时的下拉列表：

![在此处输入图像描述](../Images/8c36bba74dee930e4b1e6b73b61fccc2.png)

在**Franchise Create View**内部，下拉列表及其标签如下所示：

```
 <div class="editor-label">
            @Html.LabelFor(model => model.SetID, "Set")
        </div>
        <div class="editor-field">
            @Html.DropDownList("SetID", String.Empty)
            @Html.ValidationMessageFor(model => model.SetID)
        </div> 
```

**这是我尝试过的：**

* * *

我尝试使用 ActionLink将**SetID值传递给视图：**

```
@Html.ActionLink("New Franchise", "Create", "Franchise", Model.SetID,  new { @class = "btn btn-large btn-primary" }) 
```

然后我尝试将 Create View 的 String.Empty 属性更改为：

```
 <div class="editor-label">
        @Html.LabelFor(model => model.SetID, "Set")
    </div>
    <div class="editor-field">
        @Html.DropDownList("SetID", Model.SetID)
        @Html.ValidationMessageFor(model => model.SetID)
    </div> 
```

但是，这不起作用并产生了**无效参数**错误。

**这是一个可能的线索（或另一个问题？）**

当我从我所在的关联集中访问 Create Franchise View 时，URL 如下所示：

![在此处输入图像描述](../Images/c57e596f322b2a4a4a09659742d25848.png)

我假设如果**Set**和**Franchise**之间的关联是正确的，并且当我在 Set 中添加 Franchise 时，URL 将如下所示：

```
localhost:52987/Set/1/Franchise/Create 
```

这是一个错误的假设吗 - 这可能在 .NET MVC 中实现吗？

**非常感谢这里的任何建议！**

* * *

**编辑**

* * *

如果这有帮助，这是我的 Global.asax 文件中的路线：

```
public static void RegisterRoutes(RouteCollection routes)
        {
            routes.IgnoreRoute("{resource}.axd/{*pathInfo}");

            routes.MapHttpRoute(
                name: "DefaultApi",
                routeTemplate: "api/{controller}/{id}",
                defaults: new { id = RouteParameter.Optional }
            );

            routes.MapRoute(
                name: "Default",
                url: "{controller}/{action}/{id}",
                defaults: new { controller = "Set", action = "Index", id = UrlParameter.Optional }
            );
        } 
```

根据要求 - 以下是特许经营控制器的 GET 和 POST Create 方法：

```
 //
    // GET: /Franchise/Create

    public ActionResult Create()
    {
        ViewBag.SetID = new SelectList(db.Sets, "SetID", "SetName");
        return View();
    }

    //
    // POST: /Franchise/Create

    [HttpPost]
    public ActionResult Create(Franchise franchise)
    {
        if (ModelState.IsValid)
        {
            db.Franchises.Add(franchise);
            db.SaveChanges();
            return RedirectToAction("Index");
        }

        ViewBag.SetID = new SelectList(db.Sets, "SetID", "SetName", franchise.SetID);
        return View(franchise);
    } 
```

只要让我知道更多代码是否会有所帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-21T20:57:12.030

我对您要做什么感到有些困惑，但我建议进行一些更改：

我会改变这个：

```
<div class="editor-label">
    @Html.LabelFor(model => model.SetID, "Set")
</div>
<div class="editor-field">
    @Html.DropDownList("SetID", Model.SetID)
    @Html.ValidationMessageFor(model => model.SetID)
</div> 
```

对此：

```
<div class="editor-label">
    @Html.LabelFor(model => model.SetID, "Set")
</div>
<div class="editor-field">
    @Html.DropDownListFor(model => model.SetID, (SelectList)ViewBag.FranchiseSets)
    @Html.ValidationMessageFor(model => model.SetID)
</div> 
```

如果您将**SetID**值传递给您的**Create** ActionMethod 并分配它，它应该被传递给视图。看起来您没有填充 DropDownList，因此选择列表中没有要选择的选项。

```
public ActionResult Create(int SetID)
{
    ViewBag.FranchiseSets = new SelectList(...);
    var franchise = new Franchise { SetID = SetID };
    return View(franchise);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-21T17:59:25.930

目前尚不清楚您的操作和路线是如何设置的，但您可能想试试这个：

```
@Html.ActionLink("New Franchise", "Create", "Franchise", new{Model.SetID},  new { @class = "btn btn-large btn-primary" }) 
```

通过创建具有`SetID`属性的对象，MVC 将知道该参数应该命名为“SetID”。

PS-我可以建议重命名`Set`为 (`FranchiseSet`或`FranchiseGroup`等)，以避免命名冲突吗？`Set` [是英语中最模棱两可和最常见](http://dictionary.reference.com/browse/set?r=75&src=ref&ch=dic)的词之一。

# security - 反越狱

> ID：11143941
> 
> 赞同：0
> 
> 时间：2012-06-21T17:54:13.217
> 
> 标签：security, operating-system

这是一个好奇的问题，我只是在寻找了解更多信息的指针；我们社区中成千上万的人肯定也好奇的一个话题：

背景：以Apple iPhone为例：Apple每隔一段时间就会发布一个新版本的操作系统，该版本与以前旨在“越狱”操作系统的软件不兼容。然后越狱软件作者发布了与新操作系统兼容的新越狱。然后苹果发布一个新的操作系统版本，循环重复。大多数人认为，Apple 有兴趣通过不断发布使先前越狱无效的操作系统更新来防止越狱。

**问：一般来说，公司（比如 Apple）的软件开发人员在发布新版本的操作系统时如何防止越狱？我在询问一般操作系统架构/安全性和其他相关主题。外行的解释是什么？**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-21T17:57:51.633

“越狱”是一种在未经 Apple, Inc. 签名和认证的 iOS 上运行代码的方式。

由于 iOS 从一开始就不允许这样做，并且没有任何更改操作系统属性的应用程序经过 Apple 认证，因此“越狱”成功的唯一方法是利用操作系统中的*缺陷*。

因此，“防止越狱”（被动地）只是消除正在被利用的最新漏洞的问题。他们检索越狱，对其进行逆向工程，发现它利用的漏洞，并修补操作系统以消除漏洞。

从理论上讲，这意味着最终苹果会“获胜”，并且不会留下任何漏洞，从而允许越狱所依赖的权限升级。实际上，总会多出一个错误。

值得注意的是，还有其他方法可以打破操作系统锁定：例如，附加专用硬件来触发可操纵的操作系统故障。但是这些方法没有那么吸引人，因为它们比纯软件漏洞更难开发且应用要求更高。

打破 Apple 控制的最后一种方法是破坏他们用于签署应用程序的密钥。这没有发生，尽管有一天它可能会发生。

# android - Android (AndEngine) - Leadbolt 通知减慢我的应用程序

> ID：11143945
> 
> 赞同：0
> 
> 时间：2012-06-21T17:54:24.037
> 
> 标签：android, andengine, leadbolt

**[我对Leadbolt](http://www.leadbolt.com)**通知有疑问。

当我的手机上没有互联网连接时，Leadbolt 每 10-15 秒开始减慢我的应用程序（我在两个应用程序上尝试过）。

有谁知道为什么会这样？

我的代码：

**清单**文件：

```
<uses-permission android:name="android.permission.READ_PHONE_STATE" />
<uses-permission android:name="android.permission.INTERNET" />
<uses-permission android:name="android.permission.ACCESS_NETWORK_STATE" />
<uses-permission android:name="android.permission.ACCESS_LOCATION_EXTRA_COMMANDS" />
<uses-permission android:name="android.permission.ACCESS_FINE_LOCATION" />
<uses-permission android:name="android.permission.ACCESS_COARSE_LOCATION" />
<uses-permission android:name="android.permission.WAKE_LOCK" />

<application>
   ...
   <receiver android:name="com.Leadbolt.AdNotification" />
</application> 
```

主要活动：

```
import com.Leadbolt.AdController;

@Override
public Engine onLoadEngine() {

AdController myController;
myController = new AdController(getApplicationContext(),"MY_APP_ID");
myController.setAsynchTask(true);
myController.loadNotification();
...

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-02T12:25:48.830

如果没有更多信息，很难提出解决方案，可能是 Leadbolt 导致了问题，但同样可能是由您的应用程序和 Leadbolt 的某种组合引起的。您可以尝试使用这个适用于 Android 的应用程序资源优化器工具来找出问题所在。你可以在这里[https://developer.att.com/developer/forward.jsp?passedItemId=9700312](https://developer.att.com/developer/forward.jsp?passedItemId=9700312)

# c# - 使用 ViewBag 传递控制器计算逻辑来查看

> ID：11143948
> 
> 赞同：0
> 
> 时间：2012-06-21T17:54:35.273
> 
> 标签：c#, asp.net-mvc, asp.net-mvc-3, entity-framework, viewbag

我有一个对数据运行一些计算的控制器，然后我需要将计算返回到视图。我知道我可以通过 来完成此操作`ViewBag`，但我想知道执行此操作的最佳实践。这些`LINQ`查询是否应该在 中执行`View`？

```
public ViewResult Results()
{
    var surveyresponsemodels = db.SurveyResponseModels.Include(
        s => s.SurveyProgramModel).Include(s => s.PersonModel);

    ViewBag.PatientFollowUpResult = db.SurveyResponseModels.Count(
        r => r.PatientFollowUp);

    ViewBag.ChangeCodingPractice = db.SurveyResponseModels.Count(
        r => r.ChangeCodingPractice);

    ViewBag.CountTotal = db.SurveyResponseModels.Count();

    return View(surveyresponsemodels.ToList());
 } 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-21T17:57:01.240

最佳做法是根本不使用`ViewBag`。

将您想要使用的所有数据放入**ViewModel**中的视图中。

保持视图清洁以进行计算，并仅将其用于演示。

# silverlight - Mo' Silverlight，Mo' 麻烦...将 DataGrid 放置在 HeaderedContentControl 内的 ScrollViewer 中

> ID：11143954
> 
> 赞同：0
> 
> 时间：2012-06-21T17:54:44.013
> 
> 标签：silverlight, scrollviewer

我正在使用这个 XAML：

```
 <Border x:Name="border1" Grid.Row="1">
        <toolkit:HeaderedContentControl Header="HeaderedContentControl" HorizontalContentAlignment="Stretch" VerticalContentAlignment="Stretch" MaxWidth="{Binding ActualWidth, ElementName=border1}" MaxHeight="{Binding ActualHeight, ElementName=border1}">
            <Grid HorizontalAlignment="Left">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>
                <Grid.RowDefinitions>
                    <RowDefinition/>
                    <RowDefinition Height="32"/>
                </Grid.RowDefinitions>
                <ScrollViewer Grid.ColumnSpan="2" Margin="0" MinHeight="75" d:LayoutOverrides="Width, Height" ScrollViewer.VerticalScrollBarVisibility="Auto" Padding="0" ScrollViewer.HorizontalScrollBarVisibility="Auto" HorizontalContentAlignment="Stretch" VerticalContentAlignment="Stretch">
                    <sdk:DataGrid ItemsSource="{Binding ItemSummaries}">
                    </sdk:DataGrid>
                </ScrollViewer>
                <Button res:Strings.Assignment="Content=ItemsView.SaveButtonText" Grid.Row="1" Margin="5" Command="{Binding SaveCommand}" Grid.Column="1" d:LayoutOverrides="GridBox"/>
            </Grid>
        </toolkit:HeaderedContentControl>
    </Border> 
```

我的目标是防止 HeaderedContentControl 超出其包含的边框，我已经这样做了，但是一旦 DataGrid 超出其分配的空间，我希望它开始滚动。我已经尝试过使用或不使用父 ScrollViewer 的组合，Grid 超出了 HeaderedContentControl 的范围，并且没有出现滚动条。我到底在这里做错了什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-21T19:05:08.613

decyclone给出的上述答案奏效了。基本上，我在资源字典中添加了以下内容，以将 HeaderedContentControl 的所有实例更改为使用 Grid 而不是默认的 StackPanel：

```
<ControlTemplate TargetType="HeaderedContentControl">
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="*" />
        </Grid.RowDefinitions>
        <ContentControl Content="{TemplateBinding Header}" Grid.Row="0" />
        <ContentControl Content="{TemplateBinding Content}" Grid.Row="1" />
    </Grid>
</ControlTemplate> 
```

这是在[上面给出](https://stackoverflow.com/questions/5066450/wpf-how-to-make-headeredcontentcontrol-content-fit-height/5066955#5066955)的链接上找到的代码。

# jquery - 如何使用jquery重命名单选按钮上的标签

> ID：11143956
> 
> 赞同：0
> 
> 时间：2012-06-21T17:55:07.983
> 
> 标签：jquery, radio-button, label, radio-group, renaming

嗨，我有以下

```
<label>
    <INPUT style="DISPLAY: inline; VERTICAL-ALIGN: middle" class=fieldValue  name=radioOpt    value=1 CHECKED type=radio>&nbsp;Option1
</label>
<label>
    <INPUT style="DISPLAY: inline; VERTICAL-ALIGN: middle" class=fieldValue  name=radioOpt    value=2 CHECKED type=radio>&nbsp;Option2
</label>
<label>
    <INPUT style="DISPLAY: inline; VERTICAL-ALIGN: middle" class=fieldValue  name=radioOpt    value=3 CHECKED type=radio>&nbsp;Option3
</label> 
```

我想重命名选项 x 以根据某些事件测试 x。

```
var radioOpt = $("input[name=radioOpt][value=1]"); 
```

会给我单选按钮。我将如何重命名它的标签？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-21T18:02:26.670

尝试如下，

```
$(function () {
    $("input[name=radioOpt]").parent().contents().each(function () {
        if (this.nodeType == 3 && this.nodeValue.indexOf('Option') != -1) {
            this.nodeValue = 'Test';
        }
    });
}); 
```

**演示：http:** [//jsfiddle.net/skram/Cgv2f/2/](http://jsfiddle.net/skram/Cgv2f/2/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-21T18:06:53.607

如果您不想更改标记，您可以执行以下操作来更改这种情况下的文本

```
$(function(){
     $("input[name=radioOpt][value=1]")
      .parent()
      .contents()
      .last()[0].nodeValue = 'Test 1';
}); 
```

**演示** [http://jsfiddle.net/joycse06/U7TMs/](http://jsfiddle.net/joycse06/U7TMs/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-21T17:57:00.837

我建议如下：

```
var labelForOpt = radioOpt.parent(); 
```

但是`label`，出于可访问性的原因，应该有`for`属性来指定`input`它“属于”哪个，例如：

```
<label for="radioElement1">For radio One:</label>
<input id="radioElement1" /> 
```

这意味着您不必将 嵌套`input`在 中`label`，单击`label`将触发对关联的`input`.

还值得指出的是您的 HTML 无效：

```
<label>
    <INPUT style="DISPLAY: inline; VERTICAL-ALIGN: middle" class=fieldValue ) name=radioOpt value=1 CHECKED type=radio>&nbsp;Option1
</label> 
```

元素`)`的 HTML 中不应该有浮动。`input`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-21T17:57:13.413

```
radioOpt.closest("label"); 
```

这将为您提供最接近的`label`元素，它是所选元素的祖先（或元素本身，但事实并非如此）。然后，您可以使用`.html(function)`或通过迭代替换文本`.contents()`，过滤文本节点（where ）并替换值。[`this.nodeType`](https://developer.mozilla.org/en/nodeType)`=== 3`

与您的实际问题无关，但我想通知您，您的 HTML 中有很多标记错误。`)`属性后面不应该有一个`class`，您不能检查多个具有相同名称的单选按钮，并且当您可以使用类来使用 CSS 设置样式时，使用内联样式是一个坏主意。

```
<label>
    <input type="radio" name="radioOpt" class="fieldValue" value="1" checked/> Option1
</label>
<label>
    <input type="radio" name="radioOpt" class="fieldValue" value="2"/> Option2
</label>
<label>
    <input type="radio" name="radioOpt" class="fieldValue" value="3"/> Option3
</label> 
```

然后，将样式放入 CSS 样式表中：

```
input.fieldValue {
    display: inline;
    vertical-align: middle;
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-21T18:15:17.623

试试这个 ：

**HTML**：

```
 <INPUT style="DISPLAY: inline; VERTICAL-ALIGN: middle" class=fieldValue ) name=radioOpt    value=1 CHECKED type=radio id="op1"><label for = "op1">Option1
</label>
<label>
    <INPUT style="DISPLAY: inline; VERTICAL-ALIGN: middle" class="fieldValue" name="radioOpt" id="op2"   value="2" CHECKED type="radio"><label for = "op2">Option2
</label>
<label>
    <INPUT id="op3" style="DISPLAY: inline; VERTICAL-ALIGN: middle" class=fieldValue ) name=radioOpt    value=3 CHECKED type=radio><label for = "op3" >Option3

</label>​ 
```

**jQuery：**

```
$("input[name=radioOpt]").click(function(){
    var id = $(this).attr('id');
    $('label[for='+id+']').text('test_'+$(this).attr('value'));
});
​ 
```

这是[演示](http://jsfiddle.net/3UFJw/1/)

# sockets - TCP 套接字如何知道它已读取所有内容？

> ID：11143959
> 
> 赞同：1
> 
> 时间：2012-06-21T17:55:23.443
> 
> 标签：sockets, tcp, boost-asio

有一个非常简单的`socket`服务器由`boost::asio`.

```
tcp::acceptor a(io_service, tcp::endpoint(tcp::v4(), port));
tcp::socket(io_service) sock;
a.accept(sock);
char data[1024];
boost::system::error_code error;
size_t length = sock->read_some(boost::asio::buffer(data), error);
std::cout << "Got: " << data << std::endl; 
```

它的客户端看起来像：

```
size_t request_length = strlen(request);
boost::asio::write(s, boost::asio::buffer(request, request_length)); 
```

（均来自[官方示例](http://www.boost.org/doc/libs/1_46_0/doc/html/boost_asio/example/echo/blocking_tcp_echo_server.cpp)）

当我发送`hello, world!`到套接字时，我`Got: hello, world!`立即得到了。但它的缓冲区有 1024 个字节。它怎么知道什么时候读完？

**编辑：**

抱歉我的描述不佳。我的问题是如何`read_some()`知道它何时应该返回。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-21T18:18:11.710

`read_some()`当它从接收缓冲区读取至少一个字节时将返回。如果接收缓冲区中有数据，它将尝试读取尽可能多的数据，直到达到指定的大小。它可能会或可能不会在单次阅读期间阅读整个消息。

在您的情况下，您似乎偶然得到了整个消息。`read_some()`很可能只读取一个字节。您最好`read_some()`从循环中调用，将缓冲区的起始索引增加上一次读取的长度。

就像是：

```
size_t length = 0;
while(length < MESSAGE_LENGTH)
{
    length += sock->read_some(boost::asio::buffer(&data[lenth], 1024 - length), error);
} 
```

这当然是为了说明而简化的。您还应该注意错误情况等。但这应该足以让您入门。

# jakarta-ee - 如何编写可以看到我的 EJB 服务的 JUnit 测试？

> ID：11143960
> 
> 赞同：2
> 
> 时间：2012-06-21T17:55:26.423
> 
> 标签：jakarta-ee, junit, ejb

我有一个在 WebSphere 7 上运行的 Java EE 应用程序（使用 IBM RAD 7.5 / Eclipse）。

它基本上是 user.JSP -> UserServlet -> @Stateless UserService -> UserDAO -> Oracle

我想为 UserService 编写一些 JUnit 测试。

我从 Eclipse 中启动应用程序，它在 WebSphere 上运行。我在 Eclipse 的一个新 Java 项目中有一个 JUnit 测试。我的问题是，我的 JUnit 测试如何访问对 UserService 的引用？

有没有办法让我做类似 @EJB 注释的事情：

```
public class UserTests extends TestCase {

  @EJB  
  private UserServiceLocal userService;

  public void test1() throws Exception {
    Assert.assertTrue("userService is not null", (userService != null));
  }

} 
```

这是我的 UserService 的基本版本：

```
@Stateless
public class UserService implements UserServiceLocal {

  @EJB
  private UserDAOLocal userDAO;

  /* ... */
} 
```

注意：@EJB 不注入任何东西。

注意：`userService = (UserServiceLocal)new InitiatContext().lookup(UserServiceLocal.JNDI);`也不起作用，说“NamingManager.getURLContext 找不到该方案的工厂：ejblocal”

```
@Local
public class interface UserServiceLocal {

  public static final String JNDI = "ejblocal:com.myapp.service.UserServiceLocal";

  /* ... */
} 
```

任何建议都非常感谢！

抢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-21T19:06:10.743

请使用嵌入式容器来解决您的问题，或考虑使用 Arquilian 来完成此任务。Arquillian 将让您即时构建“Java EE 部署”（即通过代码）并使用[Arquilian](http://www.jboss.org/arquillian.html)将其部署 到您的应用程序服务器，因此您将能够运行 JUnit，并通过您的 JUnit 测试在您的服务器上实际运行代码.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-22T17:25:37.143

归根结底，我的解决方案是向要从 JUnit 测试的 EJB 添加一个远程 EJB 接口。

我创建了一个新的“应用程序客户端项目”并将我的 JUnit 测试放在那里。我的 JUnit 测试对 EJB 进行远程查找。似乎工作正常。

但是，使用 WebSphere 7，我必须使用 createEJBStubs 命令来生成所需的存根。更多细节在这里和这里：

[http://www-01.ibm.com/support/docview.wss?uid=swg21393419](http://www-01.ibm.com/support/docview.wss?uid=swg21393419)

[http://pic.dhe.ibm.com/infocenter/wasinfo/v7r0/index.jsp?topic=%2Fcom.ibm.websphere.express.doc%2Finfo%2Fexp%2Fae%2Frejb_3stubscmd.html](http://pic.dhe.ibm.com/infocenter/wasinfo/v7r0/index.jsp?topic=%2Fcom.ibm.websphere.express.doc%2Finfo%2Fexp%2Fae%2Frejb_3stubscmd.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-05-08T17:07:56.937

我为 createEJBStub 脚本创建了一个[maven-plugin 包装器。](https://github.com/lsiu/websphere-maven-plugin)

**为什么？**

这使我们能够构建测试 maven 项目，这些项目作为 CI 设置的一部分在部署后针对我们的应用程序运行。

更具体地说，与 maven 一起，这使我们的测试项目能够：

1.  利用 Maven 依赖管理将我们发布的 API jar 提取到我们的内部 nexus 存储库
2.  创建存根类作为“生成源”maven 生命周期的一部分
3.  使用 EJB 针对应用程序服务器运行 junit 测试用例以进行集成测试。

# c# - 刷新列表视图使程序非常慢

> ID：11143965
> 
> 赞同：0
> 
> 时间：2012-06-21T17:55:36.183
> 
> 标签：c#, winforms, multithreading, listview

我是 C# 和 .NET 编程的新手，我正在尝试开发一个类似于 Windows TaskManager 的 Windows 窗体应用程序。我首先使用从 System.Diagnostics.Process 收集的信息填充 listView，然后使用 MethodInvoker 委托启动 System.Threading.Timer，该委托尝试每秒刷新列表视图数据。

问题是应用程序***真的很***慢，而且，可以肯定的是，我正在做一些不合适的事情。

```
 public partial class Form1 : Form
    {
        private System.Threading.Timer t;
        private Process[] procVett;

        public Form1()
        {
            InitializeComponent();

        }

        private void Form1_Load(object sender, EventArgs e)
        {
            this.loadAppInfo(null);
            TimerCallback timerDelegate = new TimerCallback(this.refresh);
            this.t = new System.Threading.Timer(timerDelegate, null, 1000, 3000);
        }

        private void refresh(Object stateInfo)
        {
            procVett = Process.GetProcesses();

            this.BeginInvoke( (MethodInvoker)delegate
            {
                ListView.ListViewItemCollection ic = this.appList.Items;
                ListView.ListViewItemCollection procIc = this.procList.Items;
                time.Text = DateTime.Now.ToLongTimeString();
                int count = 0;
                procList.BeginUpdate();

                foreach (Process p in procVett)
                {

                    try
                    {
                        string cputime = p.TotalProcessorTime.TotalMinutes.ToString();

                        procIc[count].SubItems[1].Text = ("");
                        procIc[count].SubItems[2].Text = (cputime);
                        procIc[count].SubItems[3].Text =(p.WorkingSet64.ToString());
                        procIc[count].SubItems[4].Text = ("");

                    }
                    catch (System.Exception)
                    {

                    }

                    count++;
                }
                procList.EndUpdate();

            }, null);

        }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-21T18:32:47.640

您基本上走在正确的轨道上，但我会避免调用 BeginInvoke 方法，直到您循环遍历数组中的进程以收集 TotalProcessorTime 时间值。

基本上，经验法则是尽可能少地在 UI 线程上花费时间——尽可能多地使用后台进程来完成工作。

另外，请确保线程池中没有线程或调度堆积。来自 Timer 类的 MSDN 文档：

> 如果 SynchronizingObject 属性是空引用（在 Visual Basic 中为 Nothing），则在 ThreadPool 线程上引发 Elapsed 事件。如果 Elapsed 事件的处理持续时间超过 Interval，则该事件可能会在另一个 ThreadPool 线程上再次引发。在这种情况下，事件处理程序应该是可重入的。

因此，注意重入，或者忽略重入计时器事件，或者终止旧线程上的处理（使用一些线程安全的信号机制）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-21T18:10:50.467

除了我在评论中所说的：

我会说创建一个单独的 ListViewItems 集合，将进程信息解析到另一个线程（[BackgroundWorker](http://msdn.microsoft.com/en-us/library/system.componentmodel.backgroundworker.aspx)或简单的另一个线程）中，并在完成更新后在 ListView 中使用该集合，这样当前显示的列表就不会是冻结。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-21T19:11:00.013

我建议在 ListView 上使用 VirtualMode，它只显示当前视图中的项目。如果你有 1,000,000 个项目，并且它只绘制 #1,000-1020，它会请求这些，你告诉它如何从内存中的项目列表中获取它们，然后它会绘制它们。

它比自己添加 ListViewItems 快得多，这非常慢。

这是它的入门教程：[Virtual Mode ListView](http://www.codeproject.com/Articles/42229/Virtual-Mode-ListView)

另外，我今天早上才开始使用[ObjectListView ，非常棒。](http://objectlistview.sourceforge.net/cs/index.html)

# activerecord - 如何在 Yii 中使用 dataprovider 获取连接表的所有列？

> ID：11143975
> 
> 赞同：2
> 
> 时间：2012-06-21T17:55:58.077
> 
> 标签：activerecord, orm, yii

我的控制器

```
$criteria = new CDbCriteria();
$criteria -> select = 't.*,b.*';
$criteria -> join = 'INNER JOIN tbl_b b on b.b_id = t.id ';
$criteria -> join .= 'INNER JOIN tbl_c c on c.id = b.c_id';
$criteria -> condition = 'c.id = :cid';
$criteria -> params = array(':cid' => 1);
$dataProvider = new CActiveDataProvider('tbl_a',array(
            'criteria' => $criteria
        ));
$this->render('view',array('dataProvider' => $dataProvider)); 
```

我的观点

```
$this->widget('zii.widgets.grid.CGridView', array(
'id' => 'my-grid',
'dataProvider' => $dataProvider,
'columns' => array(
    'name',
    'description',
    array(
        'header' => 'Column from tbl_b',
        'value' => ''
    ),      
        array(
        'class'=>'CButtonColumn',
        'template' => '{view}'
), ),)); 
```

我的问题是：**如何显示**来自`tbl_b`. 由于在 中`dataprovider`，我已经指定`tbl_a`，它只是从中提取数据，`tbl_a`而不是从`tbl_b`其中选择所有记录`tbl_b`。

据我所知，它应该显示为`$data -> tbl_b -> col_b`. 但这给出了`tbl_a.tbl_b`未定义的错误。**我想知道是什么问题？**

`Is it something regarding the relation?` `tbl_a`并且通过`tbl_c`相关。ie有两列链接 和 的主要id 。`MANY_MANY``tbl_b``tbl_b``tbl_a``tbl_c`

注意：名称和描述来自 tbl_a 并显示出来。

请建议！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-21T22:25:47.110

我通常为这种事情做的是在 ActiveRecord 中创建一个属性。

```
class A extends CActiveRecord {

    public $bAttribute1

} 
```

当我`A`用 table加入 table 时`B`，我重命名了`B`我想用我创建的属性显示的字段（在这种情况下`bAttribute`，

```
$dataProvider = new CActiveDataProvider('A', array(
    'criteria' => array(
        'select' => array('t.*', 'b.attribute1 AS bAttribute1'),
        'join' => 'JOIN B AS b ON b.joinId = t.id',
    )
)); 
```

然后我可以`bAttribute1`在 GridView 中显示，

```
$this->widget('zii.widgets.grid.CGridView', array(
    'dataProvider' => $dataProvider,
    'columns' => array(
        'bAttribute1',  
))); 
```

这应该有效。但缺点是，如果要显示连接表中的大量列，则必须创建大量属性。

**更新**

很奇怪，所以我试着从头开始做例子。我创建了两个表`ModelA`，`ModelB`如下所示。

```
CREATE TABLE IF NOT EXISTS `ModelA` (
  `id` int(11) NOT NULL,
  `attribute2` int(11) NOT NULL,
  `attribute3` int(11) NOT NULL
) ENGINE=MyISAM DEFAULT CHARSET=latin1;

CREATE TABLE IF NOT EXISTS `ModelB` (
  `id` int(11) NOT NULL,
  `aId` int(11) NOT NULL,
  `attribute3` int(11) NOT NULL,
  `attribute4` int(11) NOT NULL
) ENGINE=MyISAM DEFAULT CHARSET=latin1; 
```

如您所见，`aId`in`ModelB`是`ModelA`. 然后我举了一些例子。

```
INSERT INTO `ModelA` (`id`, `attribute2`, `attribute3`) VALUES
(1, 1, 1),
(2, 2, 2);
INSERT INTO `ModelB` (`id`, `aId`, `attribute3`, `attribute4`) VALUES
(1, 1, 10, 100),
(2, 2, 20, 200),
(3, 1, 30, 300),
(4, 1, 40, 400); 
```

因此，条目 #1 in`ModelA`将被 3 个条目引用，`ModelB`而条目 #2 只有 1 个。

然后我创建了模型代码。

```
class ModelA extends CActiveRecord {
    public $bAttribute3;
    public $bAttribute4;
    public static function model($className = __CLASS__) {
            return parent::model($className);
    }
} 
```

查看模型中的`bAttribute3`and `bAttribute4`，我分别将表`attribute3`和`attribute4`from放在`ModelB`那里。然后在控制器中我创建了 DataProvider

```
public function actionIndex(){
    $dataProvider = new CActiveDataProvider('ModelA', array(
        'criteria' => array(
            'select' => array(
                '`t`.*', 
                '`b`.`attribute3` AS `bAttribute3`',
                '`b`.`attribute4` AS `bAttribute4`'
            ),
            'join' => 'JOIN `ModelB` AS `b` ON `b`.`aId` = `t`.`id`',
        )
    ));
    $this->render('index', array(
        'dataProvider' => $dataProvider,
    ));
} 
```

在视图中，我做这个

```
$this->widget('zii.widgets.grid.CGridView', array(
    'id' => 'my-grid',
    'dataProvider' => $dataProvider,
    'columns' => array(
        'id',
        'attribute2',
        'attribute3',
        'bAttribute3',
        'bAttribute4',
    ),
)); 
```

所以，这就是我所看到的

![伊姆古尔](../Images/3f2c33959840951d09e74a01be7660ed.png)

是你想要的吗？即使对于 CActiveDataProvider，我通常也这样做。我认为您可能会错过代码中的某些内容。

# python - 在 HBase 中存储类型值

> ID：11143979
> 
> 赞同：1
> 
> 时间：2012-06-21T17:56:11.093
> 
> 标签：python, types, hbase, thrift

有没有办法在 HBase 中存储类型值（例如，浮点数、整数）并从不同的客户端访问这些值？

我发现的 Java 客户端示例使用 Bytes 类的静态方法来手动编码和解码值。我还没有找到任何存储类型值的 Thrift 客户端示例。hbase.thrift 没有指定浮点数和整数类型。

简而言之，我已准备好将字段类型存储在外部资源中。我只想能够从一个客户端（例如Java）写入，从另一个客户端（例如shell 或通过Python 的Thrift）读取，而不必担心二进制编码问题。如果那不可能，我想学习为多个客户端进行编码/解码的最佳实践。

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-21T18:19:00.607

不; HBase 存储字节，仅此而已。任何进一步的编码或解码都必须由您完成。

# c# - 如何将文件拖放到 DataGridView 并将文件名记录到单元格 C# 中？

> ID：11143981
> 
> 赞同：3
> 
> 时间：2012-06-21T17:56:18.193
> 
> 标签：c#, datagridview, drag-and-drop

我创建了一个具有单列的绑定 DataGridView。我希望能够将文件拖放到 DataGridView 上，并且只将文件名（路径和名称）存储到列的单元格中。我一直在做研究，这样做的方法是使用事件 DragDrop 和 DragEnter 并尝试了几种不同的方法，但都没有奏效。有谁知道如何做到这一点？

我的代码：

```
 private void PlaylistDataGridDragEnter(object sender, DragEventArgs e)
    {
        if (e.Data.GetDataPresent(DataFormats.FileDrop))
            e.Effect = DragDropEffects.All;
        else
            e.Effect = DragDropEffects.None;
    }

    private void PlaylistDataGridDragDrop(object sender, DragEventArgs e)
    {      
        if (e.Data.GetDataPresent(DataFormats.FileDrop))
        {
            var files = (string[])e.Data.GetData(DataFormats.FileDrop);
            foreach (var filePath in files)
            {
                var a = (DataRowView) PlaylistBindingSource.AddNew();
                a.BeginEdit();
                a[0] = filePath;
                a.EndEdit();
            }
        }
    } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-21T18:21:31.673

你需要像你说的那样实现[DragEnter](http://msdn.microsoft.com/en-us/library/system.windows.forms.control.dragenter.aspx)和[DragDrop](http://msdn.microsoft.com/en-us/library/system.windows.forms.control.dragdrop.aspx)事件。[这](http://www.techrepublic.com/blog/howdoi/how-do-i-implement-drag-n-drop-in-c-applications/148)是一篇关于如何做到这一点的好文章。您在我输入时添加了代码。您只需要调整将项目添加到 DataGridView 的方式。您需要添加一个新行，然后处理最后一行：

```
PlaylistDataGrid.Rows.Add();
PlayListDataGrid[0,PlaylistDataGrid.RowCount-1].Value = filePath 
```

这假定您要将数据放在 DataGridView 的第一列中。

# css - 将 div 调整为图像大小

> ID：11143983
> 
> 赞同：3
> 
> 时间：2012-06-21T17:56:26.290
> 
> 标签：css, image, html

通常，我曾经根据使用背景图像的宽度和高度属性将图像调整为 div。现在我有完全相反的问题。

我想要做的是将 div 大小调整为图像，但具有最大宽度和高度。假设如果图像是 200x200，则 div 必须调整到这个大小，但如果图像超过 300x300，它必须受到限制。

知道我该怎么做吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-21T18:00:17.850

您可以将`max-width`和`max-height`样式属性应用于图像元素。

根据您需要对包含元素执行的操作，这可能会起作用：

```
<div>
    <div style="position: absolute;">Element content here</div>
    <img src="image.png" style="max-width: 300px; max-height: 300px;" />
</div> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-21T18:09:46.207

你的页面结构是什么？

我猜你会使用这样的东西：

```
<div id="container">
    <img src="img.jpg" />
</div>

<style>
    #container {
        display: inline-block;
        border:1px solid blue;
        max-width:300px;
        max-height:300px;
    }
</style> 
```

# java - 如何知道 App 创建的文件的文件路径

> ID：11143984
> 
> 赞同：0
> 
> 时间：2012-06-21T17:56:27.223
> 
> 标签：java, android, file-io

我正在创建一个文件“abc.txt”并存储数据。我没有安卓手机，我怎么知道 SD 卡中的数据在哪里？

```
 try {
FileOutputStream fos = openFileOutput("abc.txt",MODE_PRIVATE);
 String s = "Data to be written ok fine cool";fos.write(s.getBytes());
 } catch (Exception e) {
e.printStackTrace();
} 
```

我想要那个文件，以便我可以附加它并在后台作为电子邮件发送

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-21T18:15:02.217

您的文件未写入 SD 卡。您的文件将写入手机上的私有数据区域，您的应用程序的私有文件将在其中写入。如果您想知道它在哪里（在不同的设备上有所不同），您可以使用

```
String whereAreMyFiles = getFilesDir().getAbsolutePath(); 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-06-21T18:09:02.603

正如 Dheeresh Singh 所说，它没有被放置到的地方。你没有给它一个合适的位置。这是一个答案。

# git - 擦除硬盘后的Git

> ID：11143986
> 
> 赞同：1
> 
> 时间：2012-06-21T17:56:37.343
> 
> 标签：git, pull, corrupt

我有一个用 git 托管的项目。我最近不得不重新安装 ubuntu，并且正在重新设置所有内容。我能够重新登录 git 并取回我的所有文件，但现在遇到了一些麻烦。

当我尝试使用与通常相同的语法进行拉动时，我得到了这个：

```
$ git pull Peter master
fatal: 'Peter' does not appear to be a git repository
fatal: The remote end hung up unexpectedly 
```

我的 git 配置如下所示：

```
$ git config --list
user.name=Peter
user.email=****@***.com
branch.master.remote=Peter
branch.master.merge=refs/heads/master 
```

Git 分支如下所示：

```
$ git branch -a
* master
  remotes/Peter/HEAD -> Peter/master
  remotes/Peter/master 
```

有没有人有任何想法？我很乐意提供任何其他必要的信息。谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-21T18:00:21.427

您需要在配置中定义一个遥控器，如下所示：

```
[remote "Peter"]
    url = ssh:/xxxx/git/ccc.git
    fetch = +refs/heads/*:refs/remotes/peter/* 
```

用来`git remote add Peter xxxx`添加它

# asp.net - 在自动完成时显示多条记录

> ID：11143999
> 
> 赞同：1
> 
> 时间：2012-06-21T17:57:08.250
> 
> 标签：asp.net, sql, autocomplete, jquery-autocomplete

我有一个带有 JQuery 的 ASP.NET 文本框自动完成功能，工作正常，我键入部分人名并显示包含所有可能选项的列表，但现在我希望当我搜索名称时，我会在结果列表中显示姓名旁边的电子邮件地址，姓名和电子邮件在 SQL 数据库中，我希望当我输入 John 时，我会得到列表

约翰·安德鲁斯 John@email.com

约翰·史密斯 Smith@email.com

等等......这是代码：

```
 <%@ WebHandler Language="C#" Class="Search_CS" %>
    using System;
    using System.Web;
    using System.Data.SqlClient;
    using System.Configuration;
    using System.Text;

    public class Search_CS : IHttpHandler {

    public void ProcessRequest (HttpContext context) {
        string prefixText = context.Request.QueryString["q"];
        using (SqlConnection conn = new SqlConnection())
        {
            conn.ConnectionString = ConfigurationManager
                    .ConnectionStrings["constr"].ConnectionString;
            using (SqlCommand cmd = new SqlCommand())
            {
                cmd.CommandText = "select * from directory where name like @SearchText + '%'";
                cmd.Parameters.AddWithValue("@SearchText", prefixText);
                cmd.Connection = conn;
                StringBuilder sb = new StringBuilder(); 
                conn.Open();
                using (SqlDataReader sdr = cmd.ExecuteReader())
                {
                    while (sdr.Read())
                    {
                        sb.Append(sdr["name"])
                            .Append(Environment.NewLine);
                    }
                }
                conn.Close();
                context.Response.Write(sb.ToString()); 
            }
        }
    }

    public bool IsReusable {
        get {
            return false;
        }
    }
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-21T18:12:48.240

jQuery 自动完成功能允许您显示两个字段。为此，您应该使用 jsonp 数据源：

看看这里的[演示](http://jqueryui.com/demos/autocomplete/#remote-jsonp)。

要获取您的 json 数据，您必须将 IHttpHandler 更改为输出 json

为此，您需要创建一个对象列表，并使用 JavaScriptSerializer 将其序列化为 json。

例如：

```
//myList = your list of objects with name and email.
JavaScriptSerializer serializer = new JavaScriptSerializer();
string jsonString = serializer.Serialize(myList); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-21T18:11:42.220

当您将名称添加到字符串生成器时，还要添加电子邮件.. 此代码应该可以工作

```
while (sdr.Read())
{
    sb.Append(sdr["name"] + " " + sdr['email']).Append(Environment.NewLine);
} 
```

或者

```
while (sdr.Read())
{
    sb.Append(sdr["name"])
    sb.Append(" ") //space between name and email
    sb.Append(sdr['email'])
    sb.Append(Environment.NewLine);
} 
```