# StackOverflow 问答 1013000-1013999

# sql-server - SQL 2005 维护计划中的备份数据库任务

> ID：1013001
> 
> 赞同：0
> 
> 时间：2009-06-18T14:36:27.577
> 
> 标签：sql-server

我有一个备份数据库任务设置来对所有用户数据库进行完整备份。但是，我发现添加新数据库时，它们不会自动包含在备份计划中。

每次添加新数据库时，我都被迫打开计划并选择所有用户数据库单选按钮并保存要添加到备份任务的新数据库的包。

此外，新数据库不会显示在备份任务属性的 SelectedDatabases 集合中。

有任何想法吗？

谢谢，拉吉

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-21T18:15:15.153

这是一个错误，已在 SP3 中修复，请参阅[此文档](http://connect.microsoft.com/SQLServer/feedback/ViewFeedback.aspx?FeedbackID=403969)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-18T14:51:38.683

编写一个遍历所有数据库的 SQL 脚本，并安排一个作业定期运行此脚本 这是一个示例

```
declare cur_databases cursor
for select name from sysdatabases
where not name in ('master', 'model', 'tempdb', 'msdb')

declare @sql nvarchar(1000)
declare @name nvarchar(100)

open cur_databases

fetch cur_databases into @name

while (@@fetch_status = 0)
begin

    select @sql = 'BACKUP DATABASE [' + @name + '] TO  DISK = N''D:\Backup\' + @name + '.bak'''  +
    ' WITH NOFORMAT, NOINIT, NAME = N''' + @name + ' Database Backup'', SKIP, NOREWIND, NOUNLOAD,  STATS = 10 '

    print @sql
    exec (@sql)

    fetch cur_databases into @name

end

close cur_databases
deallocate cur_databases 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-18T16:21:58.813

您的计划配置有些奇怪，因为可以添加新数据库 - 下次计划运行时它们会自动获取。至少在我照顾的服务器上是这样。

谁是每个数据库的“所有者” - 是否是权限问题导致您的工作无法看到这些新数据库，因为它们由另一个用户拥有？

# sql - 将对象从一个父级移动到另一个父级时，在事务中绕过 DELETE_ORPHANS，休眠

> ID：1013005
> 
> 赞同：0
> 
> 时间：2009-06-18T14:36:48.980
> 
> 标签：sql, hibernate, merge

我正在使用 Spring 2.5.6 和 Hibernate Annotations 的组合。我正在考虑三个对象（表格或 w/e）：客户、地址、订单。客户为地址设置了 Cascade DELETE_ORPHANS 属性。

我正在做的是客户合并，我将所有地址和订单从一个客户转移到另一个客户，然后在旧客户上设置一个禁用位。我通过从 CustB 中删除地址并将它们添加到 CustA 来做到这一点。然后我用 .update(custA) 保存 CustA，地址和订单会适当移动，但是当我用禁用位更新 custB 时，它会删除我移动的地址！

当我注释掉 DELETE_ORPHANS 时，它工作正常。

如何阻止 DELETE_ORPHANS 删除移动的地址？我不应该将它们从 custB 中删除而只更改他们的客户参考吗？如果我在事务中完成所有操作，而不是在每个操作之间分离对象，它们会在启用 DELETE_ORPHAN 的情况下正确更新吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-18T16:13:20.200

我在 hibernate 的论坛上找到了这篇文章：[https ://forum.hibernate.org/viewtopic.php?f=1&t=961777&start=0](https://forum.hibernate.org/viewtopic.php?f=1&t=961777&start=0)

来自 hibernate 团队的 Christian 谈到 DELETE_ORPHANS 是一种 hack，它确保 hibernate 在从对象中删除关联对象时可以删除。他说要谨慎使用它。

基本上，如果您能提供帮助，请不要使用 delete_orphans。

如果您决定使用它，则必须执行额外的查询以删除条目，然后使用附加到新父对象的新标识符重新创建它们。

# forms - 从 PDF 创建可填写的 PDF

> ID：1013014
> 
> 赞同：3
> 
> 时间：2009-06-18T14:38:09.570
> 
> 标签：forms, pdf, image-processing, automation

我正在尝试从现有 PDF 创建可编辑的 PDF。有文本框字段，但是，我的 PDF 有类似于复选框的图像。Acrobat Pro 不会将这些控件检测为复选框。我的 PDf 中有大约 200 个复选框，手动将它们替换为复选框控件很繁琐。有没有办法以编程方式将这些图像识别为复选框并自动创建控件？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-11-28T14:38:17.330

如果您使用**高级**版 OmniForm，您可以将其转换为 PDF，然后在 Acrobat 中进行最终编辑。比尝试使用 Acrobat Pro 9 表单向导从纸质或电子文档创建表单要容易得多。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-18T14:47:12.233

不，没有。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-11-12T03:54:43.493

尝试 Scansoft/Nuance 的 Omniform .. 对于某些人来说，它比 Acrobat Pro 9 在检测图像上的复选框等结构方面效果更好。

# logging - 使用命令行更改文件名和位置

> ID：1013022
> 
> 赞同：0
> 
> 时间：2009-06-18T14:39:11.690
> 
> 标签：logging, command-line

所以我目前正在运行一个程序，它将一个 html 文件输出到一个静态位置/名称，我想保留所有这些文件，几乎是一个日志。

我将如何将该文件的名称更改为不同且唯一的名称，并可能通过命令行将其位置更改为日志文件夹。我正在考虑在文件名中添加一个时间戳，但我不知道如何去做，这就是我在这里的原因。

编辑：我在 Windows Server 2003 上执行此操作。所以它将在 cmd.exe 外壳中。我通过 CC.NET 运行这一切，所以我可以轻松地运行一个包含命令的批处理文件。CC.NET 项目每次都会在同一位置构建一个同名的 HTML 文件，因此它会覆盖旧的。

所以我想移动旧的并重命名它，这样我就不会在将它们移动到不同的位置时遇到同样的覆盖问题。

简短而简单：如何在 windows 命令 shell 中获取文件、移动文件、唯一地重命名（时间戳？）？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-18T14:47:33.623

在 Bash 中，您可以执行以下操作：

```
#!/bin/bash

FILE=$(date +%Y-%B-%d_%H:%M:%S)  # FILE will contain `2009-June-18_20:17:13'
mv OLD_FILE, FILE 
```

或者，只需使用自 1970 年以来经过的秒数：`date +%s`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-18T15:22:27.077

最简单的方法是使用 %RANDOM% - 例如：

```
ren foo.txt foo-%RANDOM%.txt 
```

你可能会发疯并有两个随机数来减少碰撞的机会（或者只是编写一个简单的错误处理循环） - 比如：

```
ren foo.txt foo-%RANDOM%-%RANDOM%.txt 
```

如果您真的想要时间，另一种选择是您可以解析出 %TIME% 环境变量。我不知道这在不同的语言环境中是如何工作的，并且当系统时间更改时，您可能会面临重复值的风险......但这是理解它的过程：

先来看：

```
> echo %TIME% 
```

它是这样的：

11:16:19.74

让我们把 11:16 拉到“1116”

```
> echo %time:~,2%%time:~3,2% 
```

我们要做的是通过指示变量中的起点和终点来提取子字符串。你可以一直到百分之一秒 - 即你可以得到：

11161974

# c# - 使用 C# 将非托管结构编组为托管代码

> ID：1013024
> 
> 赞同：1
> 
> 时间：2009-06-18T14:39:20.673
> 
> 标签：c#, .net, struct, unmanaged, marshalling

当我从外部应用程序获取时，我需要处理 bytes[] 。外部应用程序也是用 C# 完成的，它们通过 UDP 发送字节。他们正在发送从 struct 转换而来的字节，如下所述：

```
public struct DISPATCH_MESSAGE
{
    [MarshalAs(UnmanagedType.ByValArray, SizeConst = 16)]
    public char[] federation_name; // Units: nil     Range: nil
} 
```

所以，当我得到字节时，我需要取出里面的 char[]，然后从那个 char[] 中取出字符串。

我是这种非托管编码的新手。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-18T14:45:48.603

可能您应该将其声明为`ByValTStr`（取决于字符串的性质，它可能会有所不同）：

```
 [StructLayout(LayoutKind.Sequential, CharSet = CharSet.Unicode)]
 public struct DISPATCH_MESSAGE{ 
    [MarshalAs(UnmanagedType.ByValTStr, SizeConst = 16)]   
    public string federation_name; 
 } 
```

**更新：**如果它已经给出了 a `char[]`，它可能正在正确地进行必要的转换（包括处理编码），所以我认为你只需要：

```
string str = new string(instance.federation_name); 
```

# css - chrome 中的第二个浮动 div 在第一个 div 之前清除

> ID：1013027
> 
> 赞同：13
> 
> 时间：2009-06-18T14:39:55.197
> 
> 标签：css, google-chrome, html, css-float

两个 div 彼此相邻，都在包装器内浮动。在 IE 和 firefox 中，它们显示正确，但在 Chrome 中，第二个浮动 div 会在 Div A 下方清除。当我在 css 中删除“float:left”时，它会转到 Chrome 中的正确位置，但在 IE 和 firefox 中会清除（正如它应该）。我不知道为什么它在 Chrome 中以这种方式出现。有任何想法吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-06-18T14:44:58.307

1.  HTML 和 CSS 将有助于回答这个问题。

2.  如果您只有两个 div，并且希望它们彼此相邻浮动，则在每个 div 上设置一个宽度，让一个向左浮动，另一个向右浮动。记得在两者之间留一些空间。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-01-16T09:12:03.837

在我的情况下，我使用`display:inline-table`浮动元素的父元素..即使它不是表格。

我使用它`display:inline-table`来修复谷歌浏览器遇到的错误..

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-30T09:41:36.347

解决方案很简单 - 只需将包含所有这些 div 的 div 添加一个属性：`display: table;`- 它应该可以解决问题。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2011-12-16T14:55:06.283

我在 Chrome 中遇到了同样的问题，我通过给`display:inline-table`父 div 来解决它

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-11-28T23:44:32.510

我有多个 css 浮动左侧 div，里面有文本链接，容器在每个右侧重叠。修复是删除链接显示文本中的空格。例如。`...> TEXT </a>`至`...>TEXT</a>`

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2011-10-05T15:38:42.173

你必须给 1 div 高度

例如

第 1 部分

```
.oneColFixCtrHdr #mainContent {
    background: #FFFFFF;
    width: 375px;
    height: 0px; /* deze hoogte op 0 instellen, die bepaal je met de onderstaande div. */
    position: relative;
    display: block;
    float: left;
    padding-left: 10px;
    margin-bottom: 20px;
    padding-bottom: 0px;
    padding-top: 20px;
} 
```

第 2 部分

```
.oneColFixCtrHdr #maincontent2 {
    background: #FFFFFF;
    width: 390px;
    height: auto;
    position: relative;
    display: inline-block;
    float: right;
    margin-top: 0px;
    margin-right: 0px;
    margin-bottom: 0px;
    margin-left: 5px;
    padding-bottom: 0px;
    padding-top: 20px;
    padding-left: 20px;
    border-left-style: groove; 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2013-05-25T08:18:32.163

我把所有东西都包起来`<div style="display:inline;"> ... code .. </div>`并解决了这个问题。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2013-01-25T01:44:51.563

我在使用 Div 时遇到了同样的问题，它的 Children Span 都具有正确的浮动，为了解决我刚刚将显示内联添加到 Div 父级，现在它在 Chrome 和 Safari 中都可以正常工作。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2011-12-29T21:46:29.267

在 Chrome 中 - 似乎这个问题与父元素的*显示属性有关。*我有同样的问题并且做了很多搜索。最后我通过删除父 TD 标记的*显示CSS 属性来修复它。*我还观察到一件奇怪的事情。当我有*display:block;* 对于 TD 表元素的父级，在 Chrome 中，**colspan**不起作用（在 IE 中它工作正常）。我抓了很多头发发现这个问题。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2011-09-02T17:41:05.753

我遇到了同样的问题。我有两个带浮动的 div：left 在表 td 内——我必须将表 td 样式设置为包含 style="text-align: left;" 让他们正确对齐。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2010-09-09T19:05:35.937

我有一个问题，我有一个容器 div，里面有一堆内部 div，这些 div 设置了 float:left 属性。我的最后一个内部 div（最右边）也结束了。我通过确保带有边距的组合内部 div 不超过容器 div 的宽度来解决我的问题。

Chrome 的类似于 firebug 的开发人员工具在帮助我解决问题方面非常有用。对于我的容器 div，我没有明确设置宽度，但 chrome 的开发人员工具可以向我显示继承的宽度。然后我查看了合并的内部 div 的所有宽度，然后调整了一些内部 div 的宽度。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2011-04-15T17:28:50.983

浮动子div也有类似的问题。在我的情况下..我将一个周围的 div 浮动到右侧，其中包含 h3 元素（具有 text-align 属性） - 后跟 2 个子块元素。

**意图**中心 h3 文本，与其下方的子块元素相关。

-

**问题？**我没有为块子元素设置**宽度**。为什么？我希望宽度相对于该容器中的文本量在左/右保持不同的填充。例如。**填充：10px 30px；**

**解决方案**我采用为周围和子 div 设置宽度，同时将子 div 上的文本居中对齐，以提供与第一次尝试类似的结果。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2010-05-05T10:04:55.753

我遇到了同样的问题。Chrome 错误地显示带有浮动的 div。该块显示在第一个下方。不谈我的预期。解决方案很简单！***用div*****包围两个块，其中没有任何其他姐妹块***。*

 ** * *

## 回答 #14

> 赞同：0
> 
> 时间：2009-06-18T14:49:38.937

1.  没有代码示例，这真的只是猜测

2.  我不确定 Chrome 是如何工作的，但我知道 IE 广告有自己的风格。你用了css重置吗？大多数跨浏览器问题都可以通过这个解决。

3.  听起来 2 个浮动 div 的组合宽度超过了包装器的宽度。尝试将包装器宽度设置为 100% 或无宽度...或减小两个浮动 div 的宽度。

4.  您是否在这些 div 中设置了任何 display: inline、block 等样式属性？

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2009-06-18T14:50:36.753

如何设置 display:inline-block 和两个 div 的宽度？

编辑：假设没有设置填充/边距，为每个浏览器设置 %50 的最大宽度将适用于除 IE6 之外的所有浏览器。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2012-06-04T16:02:47.897

我不是 HTML 英雄，所以在我的情况下，这个问题真的很愚蠢。

> 这只是一个**语法错误**，所以在你像我一样开始拔头发之前，一定要检查所有的语法。
> 
> SAFARI 完全忽略了它并正确显示 div 浮动，所以我真的很困惑。

基本上，这是一个未封闭的 div 标签，它造成了问题：

```
<div class="seperator" </div>    instead of    <div class="seperator"> </div> 
```*

# sql - LINQ 中的 JOIN 和 LEFT JOIN 等效项

> ID：1013031
> 
> 赞同：6
> 
> 时间：2009-06-18T14:40:09.300
> 
> 标签：sql, linq, join, left-join

我正在使用以下 SQL 查询：

```
SELECT 
a.AppointmentId,
a.Status,
a.Type,
a.Title,
b.Days,
d.Description,
e.FormId
FROM Appointment a (nolock)
LEFT JOIN AppointmentFormula b (nolock)
ON a.AppointmentId = b.AppointmentId and b.RowStatus = 1
JOIN Type d (nolock)
ON a.Type = d.TypeId
LEFT JOIN AppointmentForm e (nolock)
ON e.AppointmentId = a.AppointmentId
WHERE a.RowStatus = 1
AND a.Type = 1
ORDER BY a.Type 
```

我不确定如何在 LINQ 中实现 JOIN。我所有的表都有外键关系。

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2009-06-19T04:30:56.953

```
SELECT A.X, B.Y
FROM A JOIN B ON A.X = B.Y 
```

这个 linq 方法调用（to Join）会生成上面的 Join。

```
var query = A.Join
(
  B,
  a => a.x,
  b => b.y,
  (a, b) => new {a.x, b.y} //if you want more columns - add them here.
); 
```

* * *

```
SELECT A.X, B.Y
FROM A LEFT JOIN B ON A.X = B.Y 
```

These linq method calls (to GroupJoin, SelectMany, DefaultIfEmpty) will produce the above Left Join

```
var query = A.GroupJoin
(
  B,
  a => a.x,
  b => b.y,
  (a, g) => new {a, g}
).SelectMany
(
  z => z.g.DefaultIfEmpty(),
  (z, b) =>
    new  { x = z.a.x, y = b.y } //if you want more columns - add them here.
); 
```

The key concept here is that Linq's methods produce hierarchically shaped results, not flattened row-column shapes.

*   Linq's `GroupBy` produces results shaped in a hierarchy with a grouping key matched to a **collection** of elements (which may not be empty). SQL's `GroupBy` clause produces a grouping key with **aggregated values** - there is no sub-collection to work with.
*   Similarly, Linq's `GroupJoin` produces a hierarchical shape - a parent record matched to a **collection** of child records (which may be empty). Sql's `LEFT JOIN` produces a parent record matched to each child record, or a null child record if there are no other matches. To get to Sql's shape from Linq's shape, one must unpack the collection of child records with `SelectMany` - and deal with empty collections of child records using `DefaultIfEmpty`.

* * *

And here's my attempt at linquifying that sql in the question:

```
var query =
  from a in Appointment
  where a.RowStatus == 1
  where a.Type == 1
  from b in a.AppointmentFormula.Where(af => af.RowStatus == 1).DefaultIfEmpty()
  from d in a.TypeRecord //a has a type column and is related to a table named type, disambiguate the names
  from e in a.AppointmentForm.DefaultIfEmpty()
  order by a.Type
  select new { a.AppointmentId, a.Status, a.Type, a.Title, b.Days, d.Description, e.Form } 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-06-18T14:59:33.257

你可能需要稍微调整一下，因为我正在袖手旁观，但有几件重要的事情要记住。如果您在 dbml 中正确设置了关系，您应该能够隐式地进行内部连接，并且只需通过初始表访问数据。此外，LINQ 中的左连接并不像我们希望的那样直接，您必须通过 DefaultIfEmpty 语法才能实现它。我在这里创建了一个匿名类型，但您可能想要放入 DTO 类或类似的东西。我也不知道你想在 null 的情况下做什么，但你可以使用 ?? 语法来定义一个值以在值为 null 时给出变量。如果您还有其他问题，请告诉我...

```
var query = (from a in context.Appointment
join b in context.AppointmentFormula on a.AppointmentId equals b.AppointmentId into temp
from c in temp.DefaultIfEmpty()
join d in context.AppointmentForm on a.AppointmentID equals e.AppointmentID into temp2
from e in temp2.DefaultIfEmpty()
where a.RowStatus == 1 && c.RowStatus == 1 && a.Type == 1
select new {a.AppointmentId, a.Status, a.Type, a.Title, c.Days ?? 0, a.Type.Description, e.FormID ?? 0}).OrderBy(a.Type); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-06-09T01:40:54.740

If you want to preserve the (NOLOCK) hints, I have [blogged a handy solution](http://ryancoder.blogspot.com/2010/06/execute-linq-queries-without-locking.html) using extension methods in C#. Note that this is the same as adding nolock hints to every table in the query.

# java - Spring Security 的编程使用

> ID：1013032
> 
> 赞同：39
> 
> 时间：2009-06-18T14:40:14.247
> 
> 标签：java, spring, spring-security, wicket

我将[Wicket](http://wicket.apache.org/)与 Wicket Auth Project 一起用于我的表示层，因此我将它与 Spring Security 集成。这是 Wicket 为我调用的身份验证方法：

```
@Override
public boolean authenticate(String username, String password) {
    try {
        Authentication request = new UsernamePasswordAuthenticationToken(
                username, password);
        Authentication result = authenticationManager.authenticate(request);
        SecurityContextHolder.getContext().setAuthentication(result);
    } catch (AuthenticationException e) {
        return false;
    }
    return true;
} 
```

我的 Spring Security XML 配置的内容（内部）是：

```
<http path-type="regex">
    <form-login login-page="/signin"/>
<logout logout-url="/logout" />
</http>
<global-method-security secured-annotations="enabled" />
<authentication-manager alias="authenticationManager"/>
<authentication-provider user-service-ref="userService">
    <password-encoder ref="bcryptpasswordencoder" />
</authentication-provider> 
```

第[2.3.6 节。](http://static.springframework.org/spring-security/site/docs/2.0.x/reference/ns-config.html#ns-session-fixation)参考文档的[会话固定攻击保护说：](http://static.springframework.org/spring-security/site/docs/2.0.x/reference/ns-config.html#ns-session-fixation)

> 会话固定攻击是一种潜在风险，恶意攻击者可能通过访问站点来创建会话，然后说服另一个用户使用相同的会话登录（通过向他们发送包含会话标识符作为参数的链接，例如例子）。Spring Security 通过在用户登录时创建一个新会话来自动防止这种情况发生。如果您不需要此保护，或者它与其他一些要求冲突，您可以使用 session-fixation-protection 属性控制该行为有三个选项：
> 
> *   migrateSession - 创建一个新会话并将现有会话属性复制到新会话。这是默认设置。
> *   none - 不做任何事情。原始会话将被保留。
> *   newSession - 创建一个新的“干净”会话，而不复制现有会话数据。

**身份验证有效，但由于我对 Spring Security 还很陌生，所以我也有一些问题需要回答：**

*   通常对于登录，我会将身份验证信息发布到`j_spring_security_check`并让 Spring Security 执行实际的身份验证代码。我想要保护免受会话固定攻击，当我像我一样执行程序登录时会得到它吗？如果没有，我该怎么做才能得到它？
*   如何执行程序化注销？
*   由于我将使用编程登录和注销，我如何禁用 Spring 拦截这些 URL？

**更新：** 对于会话固定攻击保护，似乎我需要使用签名调用 SessionUtils 类中的方法`startNewSessionIfRequired(HttpServletRequest request, boolean migrateAttributes, SessionRegistry sessionRegistry)`。

如何获取需要传入的 SessionRegistry 实例？我找不到任何方法为其创建别名 ID，或者如何获取它的 ID 或名称。

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2009-06-19T11:04:51.037

也许它不是您问题的完整答案，但也许它可能会对您有所帮助。

当您不使用编程登录时调用的代码，但可以在此处找到标准代码：

`org.springframework.security.ui.webapp.AuthenticationProcessingFilter`

我猜你在你的代码中受到了启发。它看起来非常相似。

同样，`/j_spring_security_logout`在标准方法中访问时执行的代码可在此处找到：

`org.springframework.security.ui.logout.LogoutFilter`

LogoutFilter 调用多个处理程序。我们正在使用的处理程序称为： `org.springframework.security.ui.logout.SecurityContextLogoutHandler`，因此您可能会在您的方法中调用相同的代码。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-06-21T20:39:41.200

您确实会对会话固定攻击持开放态度。为了解决这个问题，您可以再次受到 Spring 代码的“启发”。要创建一个新会话，您显然需要访问 httpsession，因此您可能需要进行一些重构。

如果你看到方法[`SessionUtils`](https://fisheye.springsource.org/browse/~raw,r=3640/spring-security/trunk/web/src/main/java/org/springframework/security/web/session/SessionUtils.java)。`startNewSessionIfRequired`.

这会将身份验证迁移到新会话。您也许可以直接调用此方法，或者只是稍微重构一下代码。

至于程序化注销，您只需`session.invalidate()`在需要注销此人时调用即可。从一般安全角度来看，这将完成所有必要的事情，但请记住，尽管您可能需要清理会话中的一些内容。如果您有一组非常复杂的过滤器等，并且您需要确保用户在请求的其余部分已注销，那么您可以添加：

```
SecurityContextHolder.getContext().setAuthentication(null); 
```

至于拦截网址，您可以将它们设置为未使用的内容并忽略它！我不确定你是否可以在配置中关闭拦截 - 如果你真的想删除它然后看看`AuthenticationProcessingFilter`- 你可以自定义它。如果你这样做，那么你将不得不手动设置 spring security xml，而不是使用提供的命名空间。不过这并不难——查看一些较旧的文档，您将了解如何执行此操作。

希望这可以帮助！

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-06-23T22:26:27.117

1) 程序化注销

1.  调用 HttpServletRequest.getSession(false).invalidate
2.  调用 SecurityContextHolder.clearContext()

2) 告诉 Spring Security 不要拦截某些 URL，这取决于你的应用程序 url 空间是如何设置的。如果您的所有页面（除了 /logIn 和 /logout）都位于上下文 /myApp 中，那么您可以这样做：

```
<http ....>
  <intercept-url pattern="/myApp/**" ..>
 ....
</http> 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-11-03T13:51:40.700

我遇到了程序登录问题。我调用了所有的`authenticationManager.authenticate(...)`和`SecurityContextHolder.getContext().setAuthentication(...)`方法，但在会话中遇到了一些问题。我必须添加以下几行才能正确管理会话：

```
HttpSession session = request.getSession();
session.setAttribute("SPRING_SECURITY_CONTEXT", SecurityContextHolder.getContext()); 
```

从上面发布的示例代码中并不清楚这一点。有关更多信息，请查看[http://forum.springsource.org/showthread.php?t=69761](http://forum.springsource.org/showthread.php?t=69761)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-07-16T07:27:42.060

要进行编程注销，也可以抛出`org.springframework.security.core.AuthenticationException`. 例如，`SessionAuthenticationException`。在这种情况下`ExceptionTranslationFilter`启动注销。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-03-19T14:53:22.500

你可以试试这个

```
 try {
        HttpSession session = request.getSession(false);
        if (session != null) {
            session.invalidate();
        }

        SecurityContextHolder.clearContext();

    } catch (Exception e) {
        logger.log(LogLevel.INFO, "Problem logging out.");
    } 
```

# svn - SVN - 更改现有存储库上的目录结构

> ID：1013034
> 
> 赞同：15
> 
> 时间：2009-06-18T14:40:19.800
> 
> 标签：svn

是否可以更改现有 SVN 存储库的目录结构？

我有以下结构：

```
\trunk

\branches

\releases 
```

我想将 \releases 文件夹更改为 \tags

干杯肖恩

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-06-18T14:47:08.023

没问题，使用svn move。您可以在本地进行移动，然后进行签入（在这种情况下，它需要您签出整个 svn 存储库）。

您也可以远程进行移动：

```
svn move svn+ssh:user@host//myrepo/releases svn+ssh:user@host//myrepo/tags 
```

如果您使用 TortoiseSVN，您可以在浏览存储库时执行此操作。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-06-18T14:47:06.760

如果您想在*所有已从 root 签出*的工作副本上执行此操作，那么 Andrew 和 Artem 的答案很好。不要忘记提交更改！

我不喜欢检查我的所有标签，所以在这种情况下，您需要使用 URL 参数。

例如：

```
svn move svn://svnmachine/repository/release svn://svnmachine/repository/tags 
```

仅供参考：`mv`, `rename`, `move`, and`ren`都是相同的命令，相当于 a `copy`and `delete`。

[svn move 命令的帮助](http://svnbook.red-bean.com/en/1.7/svn.ref.svn.c.move.html)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-06-18T14:42:27.237

当然——它们只是目录。做就是了

```
svn move releases tags 
```

或使用视觉 SVN 客户端进行移动，例如 SmartSVN

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-06-18T14:41:50.467

```
svn mv releases/ tags/
svn commit -m "move releases/ to tags/" 
```

然后，如果您想重新创建发布文件夹

```
svn mkdir releases
svn commit -m "recreate releases folder" 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-18T14:45:48.837

“重命名”命令可能是您需要的。它将保留修订历史记录并允许您更改文件目录。

# php - Zend Framework headMeta() - 关键字不附加

> ID：1013035
> 
> 赞同：4
> 
> 时间：2009-06-18T14:40:23.293
> 
> 标签：php, zend-framework, view-helpers

我正在使用 Zend Framework 1.8。我遇到了 headMeta() 复制元关键字的问题。

在我的 layout.phtml 中，我有
`<?php echo $this->headMeta(); ?>`

我有一个自定义`Controller_Plugin_ViewSetup`（扩展`Zend_Controller_Plugin_Abstract`），其中包含以下代码，在`dispatchLoopStartup()`函数中：
`$view->headMeta()->setHttpEquiv('Content-Type', 'text/html;charset=utf-8');` `$view->headMeta()->setName('keywords', 'global,generic,keywords,');`

最后，在我的视图脚本中，我有以下内容：
`$this->headMeta()->appendName('keywords', 'view,specific,keywords');`

我期待在我的 HTML 源代码中，我会看到：
`<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />`
`<meta name="keywords" content="global,generic,keywords,view,specific,keywords" />`

但是，我实际上看到了这一点：
`<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />`
`<meta name="keywords" content="global,generic,keywords," />`
`<meta name="keywords" content="view,specific,keywords" />`

换句话说，元关键字没有按应有的方式连接在一起。我究竟做错了什么？

干杯，
马特

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-18T15:19:34.150

那是因为 append 方法不会将更多的关键词附加到已经定义的列表中。append 方法会将下一个标签附加到已经定义的标签上。同样，如果您选择 prepend，这会将您的新标签添加到您在插件中定义的标签之前。

我认为，最好的办法是从插件中删除关键字占位符并将您的默认关键字存储在您的配置对象中，并在添加其他关键字的同时将它们插入到您的视图中。

# php - MySQL：更新将字段设置为 0 的所有行，但将一行的字段设置为 1

> ID：1013042
> 
> 赞同：12
> 
> 时间：2009-06-18T14:41:54.977
> 
> 标签：php, mysql

是否有一种有效的方法可以将选择的行的字段更新为 0，但根据 ID 将这些行之一设置为 1。

基本上，我在数据库中有多个对象，我想在哪个对象“正在使用”之间切换，因此查询会将其中一行（按 id）设置为 inuse=1，其他行设置为 inuse=0。

谢谢 ：）

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2009-06-18T14:48:52.077

```
UPDATE `table`
SET `inuse` = (`id` = 23) 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-06-18T14:44:03.630

当然

```
UPDATE table SET inuse=IF(id=ABCD, 1, 0) 
```

如果 id 为 ABCD，则将 inuse 字段设置为 1，否则设置为 0。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-18T14:51:44.533

```
UPDATE  table
SET     inuse = (id = @id)
WHERE   id = @id
        OR inuse 
```

这将仅更新相关行。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-18T14:44:53.910

```
UPDATE myTable
SET Field = 0
WHERE FieldID <> [WhateverID]

UPDATE myTable 
SET Field = 1
WHERE FieldId = [WhateverID] 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-18T14:49:04.867

尝试

```
update tbl set inuse = if(test, 1, 0); 
```

或更短

```
update tbl set inuse = test; 
```

例如

```
update tbl set inuse = name = 'foo'; 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-18T14:57:13.930

如果你想设置一个标志，那么代码的其他部分不会同时使用同一个对象，最好是调用代码设置 inuse=1 并在完成后重置它。否则，您将结束一个线程将对象（行）标记为正在使用，然后如果另一个线程需要另一个对象，它将重置第一个对象，同时仍在使用中。

如果不是这种情况，并且您只想能够为一个设置 inuse 并重置所有其他，您可以使用：

```
UPDATE myTable
SET InUse = CASE
   WHEN myTable.id = @id THEN 1
   ELSE 0
END 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-06-18T15:06:09.700

如果您的数据库使用事务，这是最好的方法：

```
update myTable set inuse = 0;
update myTable set inuse = 1 where id = ?; 
```

如果您不使用事务，那么使用 CASE 的另一个答案是最佳选择，因为它是可移植的。但它比两个 UPDATE 语句需要更多的 CPU 时间。

# sql-server - 如何获取单个表中每组键值的最大行数？

> ID：1013043
> 
> 赞同：1
> 
> 时间：2009-06-18T14:41:59.810
> 
> 标签：sql-server, tsql

我有一个有很多重复条目的 MSSQL 2000 表。每行都有一个 EffectiveChange 数据列。我想通过获取每个键值的 max(EffectiveChange) 行来获取最新的行。

这是一些示例数据：

```
NPANXX TZONE EFFCHANGE RATE
555555 1     01/01/09   1
555555 1     05/01/09   6
214555 2     01/01/09   1
214555 2     05/01/09   3
657555 3     05/01/09   1
657555 1     01/01/09   1 
```

我想出了这个：

```
SELECT DISTINCT
  NPANXX,
  TZONE,
  RATE
FROM AreaCodes
INNER JOIN (SELECT DISTINCT NPANXX, EFFCHANGE FROM AREACODES) b
  ON b.NPANXX = AreaCodes.NPANXX
GROUP BY 
  NPANXX, 
  TZONE, 
  RATE 
HAVING AreadCodes.EFFCHANGE = max(b.EFFCHANGE) 
```

我的问题是这个查询是否会给我每个键 (NPANXX) 的最大 EFFCHANGE 行，还是只会给我整个表的 MAX(EFFCHANGE) 行？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-18T14:44:58.323

一种方法，因为您在 2005 年及以上使用 2000，您也可以使用 row_number()

```
SELECT t1.* 
from AreaCodes t1
INNER JOIN (SELECT NPANXX, max(EFFCHANGE) as MaxDate FROM AREACODES
group by NPANXX) t2 
  ON t1.NPANXX = t2.NPANXX
and t1.EFFCHANGE = t2.MaxDate 
```

这是完整的代码，包括 DML 和 DDL

```
create table AreaCodes(NPANXX int,TZONE int,EFFCHANGE datetime,RATE int)

insert AreaCodes values(555555,1,'20090101',1)
insert AreaCodes values(555555,1,'20090501',6)
insert AreaCodes values(214555,2,'20090101',1)
insert AreaCodes values(214555,2,'20090501',3)
insert AreaCodes values(657555,3,'20090501',1)
insert AreaCodes values(657555,1,'20090101',1)

SELECT t1.* 
from AreaCodes t1
INNER JOIN (SELECT NPANXX, max(EFFCHANGE) as MaxDate FROM AREACODES
group by NPANXX) t2 
  ON t1.NPANXX = t2.NPANXX
and t1.EFFCHANGE = t2.MaxDate

output
657555  3   2009-05-01 00:00:00.000 1
555555  1   2009-05-01 00:00:00.000 6
214555  2   2009-05-01 00:00:00.000 3 
```

# windows-vista - windows vista荷兰版安装程序

> ID：1013044
> 
> 赞同：0
> 
> 时间：2009-06-18T14:42:22.260
> 
> 标签：windows-vista, windows-installer, installation

我有一个程序可以很好地安装在英文版的 vista 上，但是当我们尝试在荷兰语版本上安装它时，我们会收到以下错误消息。错误 1001 “Kan een aantal of alle id-verwijzingen niet omzetten” Google 翻译将其转换为：“Could some or all id refers not convert” 此错误发生在 msi 安装期间。在谷歌上搜索这个没有结果。有谁知道我需要做些什么来解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-18T14:50:07.113

我找到了这个参考：

这表示如果您重命名管理员帐户，可能会导致此错误：[ [http://www.codeplex.com/sqlnexus/WorkItem/View.aspx?WorkItemId=9486]](http://www.codeplex.com/sqlnexus/WorkItem/View.aspx?WorkItemId=9486])

显然，此错误转换为“无法翻译部分或全部身份参考”，我在 Google 中找到了很多结果。

# vb.net - 确定事件是否已附加到

> ID：1013048
> 
> 赞同：9
> 
> 时间：2009-06-18T14:42:36.580
> 
> 标签：vb.net, events, event-handling

我有两个对象 - 一个包含一些将触发事件的代码，另一个包含该事件的处理程序。我不能在第一个对象的加载中“添加处理程序”，因为第二个对象的实例还不存在。当我引发我的事件时，我想检查是否已实例化 object2 的副本（很容易做到），以及是否已将处理程序附加到事件（不确定如何执行此操作）。

我也愿意接受有关如何执行此操作的另一项建议。如果我在 Object1.Load 中执行 AddHandler，而 Object2 还不存在，那么即使我稍后创建它，它也永远不会处理我的事件。现在，在触发事件的代码中，我只是在每次引发事件时都使用 RemoveHandler 和 AddHandler ，然后我知道当对象最终存在时我会附加，但我知道这一点是一个蹩脚的方法。

我看到一篇关于类似内容的文章（[确定绑定到事件的事件处理程序列表](https://stackoverflow.com/questions/660480/determine-list-of-event-handlers-bound-to-event)），也许我在翻译中遗漏了一些东西，但我无法让代码在 VB.NET 中处理我的自定义事件。

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2012-06-21T16:21:44.900

VB.Net 创建一个特殊的私有成员变量，`<YourEvent>Event`然后您可以使用它来测试 Nothing。

```
Public Event MyClick As EventHandler

Private Sub OnMyClick()
    If MyClickEvent IsNot Nothing Then
        RaiseEvent MyClick(Me, New EventArgs())
    Else
        ' No event handler has been set.
        MsgBox("There is no event handler. That makes me sad.")
    End If
End Sub 
```

[http://blogs.msdn.com/b/vbteam/archive/2009/09/25/testing-events-for-nothing-null-doug-rothaus.aspx](http://blogs.msdn.com/b/vbteam/archive/2009/09/25/testing-events-for-nothing-null-doug-rothaus.aspx)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-18T15:09:12.190

您也可以在挂钩事件之前检查一个 bool 字段。

```
if not eventHooked then
 addhandler
 eventHooked = true
end if 
```

此外，如果您需要一个好的 c# 到 vb 转换器[http://www.tangiblesoftwaresolutions.com/](http://www.tangiblesoftwaresolutions.com/)有一个可以即时翻译 100 行或更少的内容，或者免费翻译 1000 行的项目。不仅如此，您还必须购买它，但通常这些限制可以正常工作。不，我不是想为他们做广告:-)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-30T16:01:49.193

根据这里的回复：http: [//social.msdn.microsoft.com/Forums/en-US/netfxbcl/thread/9ec8ff1c-eb9b-4cb3-8960-9cd4b25434f2](http://social.msdn.microsoft.com/Forums/en-US/netfxbcl/thread/9ec8ff1c-eb9b-4cb3-8960-9cd4b25434f2)（根据我的测试似乎有效），检查现有事件处理程序在调用 RaiseEvent 时完成。如果您不想引发事件而只需要检查是否附加了任何处理程序，则可以检查名为 <your_event_name>Event 的隐藏变量的值，例如：

```
Public Event Foo As ActionFoo

If FooEvent IsNot Nothing Then... 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-18T14:52:43.567

如果您只想知道是否附加了任何处理程序，您应该能够检查事件是否为空。

```
if (MyButton.Click == null)
{
    MyButton.Click += myEventHandler;
} 
```

（我会让你把它翻译成VB）

# iphone - 在子视图中调用方法

> ID：1013049
> 
> 赞同：2
> 
> 时间：2009-06-18T14:42:37.830
> 
> 标签：iphone, objective-c

大家好！我有这个小问题：

我有一个 ViewController，它在我的 ViewController 中添加了 2 个子视图，所以我有这样的东西：

```
//in my viewController.m i have this:
- (void)startIcons
{
    IconHolder *newIconHolder = [[IconHolder alloc] initWithItem:@"SomeItenName"];
    [self.view addSubview:newIconHolder];
}
- (void)onPressIcon targetIcon(IconHolder *)pressedIcon
{
    NSLog(@"IconPressed %@", [pressedIcon getName]);
} 
```

这是我的子类接触：

```
//And in my IconHolder.m i have this:
- (void)touchesEnded:(NSSet *)touches withEvent:(UIEvent *)event 
{
    //Here i need to call the method onPressIcon from my ViewController
} 
```

现在：我该怎么做？最好的方法是在我的构造函数中创建一个链接来保存我的 ViewController？我该怎么做？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-18T15:14:33.223

是的，您应该像您怀疑的那样创建该链接。

只需在视图中添加一个成员变量`MyViewController* viewController`并在创建视图时进行设置。如果您想变得聪明，可以将其创建为属性。

请注意，您不应该从视图中保留 viewController - 视图已经被控制器保留，如果您有一个保留以相反的方式，您将生成一个保留周期并导致泄漏。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-19T02:54:45.177

创建链接的另一种方法是使用通知。

例如，在 IconHolder.h

```
extern const NSString* kIconHolderTouchedNotification; 
```

在 IconHolder.m 中

const NSString* kIconHolderTouchedNotification = @"IconHolderTouchedNotification";

```
- (void)touchesEnded:(NSSet *)touches withEvent:(UIEvent *)event 
{
    //Here i need to call the method onPressIcon from my ViewController
    [[NSNotificationCenter defaultCenter] kIconHolderTouchedNotification object:self];
} 
```

然后在你的控制器中

```
- (void) doApplicationRepeatingTimeChanged:(NSNotification *)notification
{
   IconHolder* source = [notification object];
}

- (IBAction) awakeFromNib;
{
    [[NSNotificationCenter defaultCenter] addObserver:self selector:@selector(doIconHolderTouched:) name:kIconHolderTouchedNotification object:pressedIcon];
}

- (void) dealloc
{
    [[NSNotificationCenter defaultCenter] removeObserver:self name: kIconHolderTouchedNotification object:pressedIcon];
    [super dealloc];
} 
```

如果您希望对象之间的链接非常弱并且不需要双向通信（即，IconHolder 不需要向控制器询问信息），或者如果您需要通知多个对象的更改，则通知特别好。

# c++ - 有限状态机编译器

> ID：1013050
> 
> 赞同：7
> 
> 时间：2009-06-18T14:42:47.953
> 
> 标签：c++, compiler-construction, state-machine

可以生成 c++ 代码的最好的开源 FSM 编译器是什么？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-06-18T14:50:52.820

我不知道*最好*的，但你可以看看[Ragel](http://www.complang.org/ragel/)：

> Ragel 从常规语言编译可执行的有限状态机。Ragel 针对 C、C++、Objective-C、D、Java 和 Ruby。Ragel 状态机不仅可以像正则表达式机器那样识别字节序列，而且还可以在识别正则语言的任意点执行代码。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-06-18T16:03:41.320

请参考我给[这个问题](https://stackoverflow.com/questions/632391)的答案，[SMC](http://smc.sourceforge.net)也可以生成C++代码。我无法评论生成的 C++ 的质量，但对于 C# 来说它是令人满意的。

# .net - Windows 服务开源框架

> ID：1013056
> 
> 赞同：9
> 
> 时间：2009-06-18T14:44:20.120
> 
> 标签：.net, open-source, windows-services

不久前我正在听一个关于开源项目的播客。我不记得这个项目叫什么了，但是做这件事的人说他们会把他们的 Windows 服务支持拆分成一个单独的开源项目。

就像我说的，我不记得那个项目或他们所说的突破项目。我只记得它在.NET 中包装了Windows 服务。

有谁知道这是什么项目？

干杯

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-06-18T15:15:21.897

也许您正在考虑[Topshelf](http://topshelf-project.com/)。

以下是有关它的一些信息：

*   [使用 Topshelf 创建 Windows 服务](http://mookid.dk/oncode/archives/336)
*   [CodeBetter 上的文章](http://codebetter.com/blogs/dru.sellers/archive/2009/01/11/topshelf.aspx)

# css - 如何使用 Richfaces 和 CSS 在 JSF 应用程序中添加背景图像？

> ID：1013057
> 
> 赞同：11
> 
> 时间：2009-06-18T14:44:21.443
> 
> 标签：css, jsf, richfaces

我正在使用 JSF 和 Richfaces 制作网站，但我需要在下拉菜单标签上做一些背景图片。我看到您可以通过执行来使用样式属性

```
.rich-ddmenu-label {

    background-image: url("images/the_image.gif");

} 
```

但这似乎并没有尝试将图像放在任何地方。

我可以使用图像

```
<h:graphicImage/> 
```

我不知道如何将文本放在上面。

我究竟做错了什么？如何在某些文本后面插入背景图像？

* * *

## 回答 #1

> 赞同：69
> 
> 时间：2010-01-09T15:23:37.297

我刚刚遇到了与**JSF 2.0**相同的问题。我不得不使用 CSS 并且具有相对路径的解决方案对我也不起作用（就像 Choghere 发布的那样）。

在我的书中，我读到**当您将 Facelets 用作 VDL（视图声明语言）时，即使在纯 HTML 页面中也可以使用表达式**。所以我想到了将 EL 直接放在我的 CSS 中。注意：我不必更改文件名或任何东西。

这就是我所做的。但首先我的文件结构：

*   /resources/common/overlay.xhtml -> 这个包含以下css（它是一个复合组件）
*   /resources/common/overlay.css
*   /resources/images/logo.png

现在来了 CSS：

```
.someclass { 
    background-image:url("#{resource['images:logo.png']}"); 
} 
```

在这种情况下，*资源*是JSF 2的**隐式对象，***图像*是 JSF 应该查看的**库**（jsf 期望资源下的所有库/文件，至少是默认的 ResourceHandler），然后是资源的名称。

对于更深的结构，它将是：

```
#{resource['images/folder:logo.png']} 
```

希望有帮助；）

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-06-18T16:14:18.327

假设有问题的元素被`class="rich-ddmenu-label"`应用到它，问题很可能是背景图像的路径。

路径相对于 CSS 所在的位置。如果它在一个外部文件中，它应该是相对的，例如：

```
/css/styles.css
/images/the_image.gif 
```

CSS应该是：

```
background-image: url("../images/the_image.gif"); 
```

如果 CSS 在 HTML 页面上是内联的，它将相对于当前路径。因此，如果页面位于 at `http://server/path/to/page`，它将`http://server/path/to/page/images/the_image.gif`在您可能想要的位置查找图像`http://server/images/the_image.gif`。

如果这不能回答它，请发布生成的 HTML。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-18T14:52:58.167

您是否按照[Richfaces 演示站点](http://livedemo.exadel.com/richfaces-demo/richfaces/dropDownMenu.jsf;jsessionid=5A4E4F0D809B18C3C1B1EC91E71EA001?c=dropDownMenu&tab=usage)上的示例进行操作？IE。使用构面并将图像和文本放置在封闭元素内（例如跨度或 div）

```
<rich:dropDownMenu>
    <f:facet name="label"> 
        <h:panelGroup>
            <h:graphicImage value="/images/icons/copy.gif" styleClass="pic"/>
            <h:outputText value="File"/>
        </h:panelGroup>
    </f:facet>
    <rich:menuItem submitMode="ajax" value="New"
        action="#{ddmenu.doNew}" icon="/images/icons/create_doc.gif">
    </rich:menuItem>
    ...
</rich:dropDownMenu> 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2010-04-28T12:23:33.783

我的文件夹结构如下：

网页->资源->css //css页面

网页->资源->图片//图像

网页//xhtml 文件

试试下面的：

```
background-image :url("../pics/logo.gif"); 
```

.. 将您向上移动一个文件夹级别 /pics 将您移动到 ​​pics 目录 /logo.gif 为您提供文件

希望这可以帮助。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2011-01-25T16:35:45.770

我得到了这个解决方案：用这个内容创建一个新的 .css 文件

```
body {
background-image: url(../resources/images/Fondo.GIF);
} 
```

这将以与 html 相同的方式加载文件。这样，您将能够在正文级别（在整个页面上）加载背景文件。之后，您可以在 jsf 文件中使用以下指令加载 css 文件：

```
<h:head>
    <h:outputStylesheet name="ps-pagolinea.css" library="css" />
    <h:outputScript name="corrigePoliza.js" library="scripts"/>
</h:head> 
```

# continuous-integration - 为我的需要选择正确的 CI 服务器

> ID：1013060
> 
> 赞同：4
> 
> 时间：2009-06-18T14:44:51.350
> 
> 标签：continuous-integration

我正在为一个重大项目研究/设置持续集成服务器，并且需要建议或批评。

**Need**
CI 只是我们前进道路上的下一步。它是在正确的时间被授权的，因为一个主要项目正在筹备中。

**局限性**

*   需要能够与我们的 SCM 系统 (SVN) 在同一台服务器上运行
*   服务器（不幸的是）是一台 XP Pro 机器。
*   需要处理 .NET 构建。
*   希望有一些分析能力。或者可以在以后添加。
*   预算，免费的首选。
*   虽然我们有能力，但配置更容易。
*   我们的 SVN Web 前端使用的是 apache。希望 CI 的前端也这样做，但可以处理 IIS。
*   使用 NAnt 构建

**到目前为止，我已经缩小了范围，**
我目前正在查看 4 个选项：

*   巡航
*   CruiseControl.NET
*   TeamCity - 目前正在测试，到目前为止似乎还不错，免费的专业版有足够多的代理用于我们的项目。
*   哈德逊

**什么是我真正的问题**
根据您对上述任何或所有内容的经验，您所看到的任何批评或整洁的事情是什么。在设置过程中需要注意或注意什么？如果让你重来一遍，你会选择同样的事情吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-06-18T15:20:27.347

你见过/考虑过哈德逊吗？

[https://hudson.dev.java.net/](https://hudson.dev.java.net/)

例如，如果您使用 NAnt 构建 .NET 项目，它有一个插件可以满足您的需求。

它与大多数 SCM 系统、错误跟踪器等集成，并且具有极强的可扩展性。

根据我的经验，Hudson 在大多数方面都优于 Cruise*。每当我需要将它连接到其他东西时，有人已经创建了一个插件。

它易于配置，具有适用于当前软件工程实践的大多数方面的插件。它包括 Winstone，可以完全独立运行，也可以在任何 Java App/Servlet 容器中运行。例如，我在 Tomcat 和 Glassfish 中运行它时遇到的问题为零。

这是其当前插件的列表

[http://wiki.hudson-ci.org/display/HUDSON/Plugins](http://wiki.hudson-ci.org/display/HUDSON/Plugins)

它似乎达到了你的目标

```
* Needs to be able to live on the same server as our SCM system (SVN) 
```

没问题

```
* The Server is (unfortunately) an XP Pro Machine. 
```

我个人在 Win XP 上运行独立变体没有任何问题，虽然没有在 XP 上的其他服务器/容器上尝试过。

```
* Needs to handle .NET builds. 
```

假设 NAnt 满足您的需求或者您已经在使用它，应该很快就到这里

```
* Would like to have some profiling capability. Or the ability to add at a later date. 
```

如果现有插件无法满足您的需求，插件框架非常好，您可以自行开发。

```
* Budget, free preferred. 
```

免费且积极开发/维护

```
* While we're more than capable, configuration would be preferred to be easy. 
```

配置快速简单。

```
* Our SVN web front end is using apache. Would like the CI's front end to do the same, but can deal with IIS otherwise. 
```

这可能是一个症结所在，但如果包含的 Winstone 不起作用，它需要一个 App/Servlet 容器。

我已经将一些使用 CruiseControl 的项目转换为 Hudson，并且没有回头。我也尽可能将其用于新项目。

问候

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-08-07T18:48:56.733

您可能想查看[CI 工厂](http://www.cifactory.org/joomla/)。它满足您的所有要求。CI Factory 使用 CruiseControl.Net，它带有用于构建、svn、FXCop、Nunit 等的 Nant 插件。我将它用于我的所有项目。DNR.tv 有一个很好的设置服务器的演练：[screen cast](http://www.dnrtv.com/default.aspx?showID=64)。

# python - 为什么这个 python 代码在导入/编译时挂起但在 shell 中工作？

> ID：1013064
> 
> 赞同：3
> 
> 时间：2009-06-18T14:45:19.617
> 
> 标签：python, shell, compilation, sftp

我正在尝试使用 python 来 sftp 文件，并且代码在交互式 shell 中运行良好——甚至可以一次将其粘贴。

当我尝试导入文件（只是为了编译它）时，代码挂起，没有异常或明显错误。

我如何让代码编译，或者是否有人有通过其他方法完成 sftp 的工作代码？

此代码挂在 ssh.connect() 语句中：

```
""" 问题演示.py
    从 paramiko 演示文件中删除。

    此代码在 shell 中有效，但在我尝试导入时挂起！
"""
从时间导入睡眠
导入操作系统

进口帕拉米科

sOutputFilename = "redacted.htm" #-- 有效负载文件

主机名 = "redacted.com"
＃＃＃＃ -  警告！嵌入式密码！尽快删除。
sUsername = "已编辑"
sPassword = "已编辑"
sTargetDir = "已编辑"

#-- 获取主机密钥，如果我们知道的话。
主机键类型 = 无
主机键 = 无
主机键 = {}
尝试：
    host_keys = paramiko.util.load_host_keys(os.path.expanduser('~/.ssh/known_hosts'))
除了 IOError：
    尝试：
        # 也试试 ~/ssh/，因为 windows 不能有一个名为 ~/.ssh/ 的文件夹
        host_keys = paramiko.util.load_host_keys(os.path.expanduser('~/ssh/known_hosts'))
    除了 IOError：
        print '*** 无法打开主机密钥文件'
        主机键 = {}

如果 host_keys.has_key（主机名）：
    hostkeytype = host_keys[主机名].keys()[0]
    hostkey = host_keys[hostname][hostkeytype]
    print '使用类型为 %s 的主机密钥' % hostkeytype

ssh = paramiko.Transport((主机名, 22))

ssh.connect(username=sUsername, password=sPassword, hostkey=hostkey)

sftp = paramiko.SFTPClient.from_transport(ssh)

sftp.chdir（目标目录）

sftp.put (sOutputFilename, sOutputFilename)

ssh.close()

```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-18T15:09:50.207

在导入时执行这种代码确实是个坏主意，尽管我不确定它为什么会挂起 - 可能是导入机制做了一些奇怪的事情，与 paramiko 交互不良（可能是线程相关问题？）。无论如何，通常的解决方案是将功能实现为函数：

```
def my_expensive_function(args):
    pass

if __name__ == '__main__':
    import sys
    my_expensive_functions(sys.args) 
```

这样，仅导入模块不会做任何事情，但运行脚本将在命令行使用给定参数执行函数。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-18T14:54:21.957

这可能不是直接原因，但**您很少**希望在导入时执行“功能”。通常你应该定义一个*类*或*函数*，然后像这样调用：

```
import mymodule
mymodule.run() 
```

您在导入中运行的“全局”代码通常应仅限于导入、变量定义、函数和类定义等......

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-18T15:29:12.617

除了奇怪之外，我只是使用 import 来编译代码。对于这种应用程序来说，将脚本变成函数似乎是不必要的复杂化。

搜索了另一种编译方式，发现：

```
导入 py_compile
py_compile.compile("ProblemDemo.py")

```

这会生成一个按预期工作的 pyc 文件。所以吸取的教训是 import 不是编译 python 脚本的可靠方法。

# javascript - 如何使用 JavaScript 替换文本？

> ID：1013065
> 
> 赞同：0
> 
> 时间：2009-06-18T14:45:31.880
> 
> 标签：javascript, xhtml

有大型网站所有数据都来自数据库，

我想删除此页面上公司名称旁边的所有“（MHC）”实例，以及超过 12 个其他页面。

像“ **Northfield Bancorp Inc. (MHC)** ”到“Northfield Bancorp Inc.”

有没有这方面的 JavaScript？我尝试过[xslt 解决方案](https://stackoverflow.com/questions/1003981/replacing-xml-value-in-xslt)，但仍然更喜欢 JavaScript 解决方案。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-06-18T14:48:54.977

首先，我只是更改数据库条目...

此外，您应该在服务器端执行此删除操作。例如，您可以在将数据输出给用户之前使用 PHP 重新格式化数据。只需使用 PHP 进行数据库查询，将其存储在 PHP 变量中，然后适当地解析字符串。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-18T14:49:44.163

只需进行替换：

```
var data = "Northfield Bancorp Inc. (MHC)";
var newData  = data.replace(" (MHC)", "", "ig"); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-18T14:50:52.603

您可以使用[javascript 正则表达式](http://programming.top54u.com/post/Javascript-RegExp-Replace-String-Function.aspx)来解析您的文本

# c# - 序列化 POCO 排除类成员

> ID：1013067
> 
> 赞同：4
> 
> 时间：2009-06-18T14:45:44.750
> 
> 标签：c#, serialization, poco, class-hierarchy

我希望在其类层次结构树中创建一个 POCO [Serializable] 但不是任何其他类成员。我知道有 [NonSerialized] 仅适用于字段，但是有没有办法在 POCO 上使用 [Serializable] 排除它们或选择特定成员？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-18T14:48:12.780

你应该看看[`DataContractSerializer`](http://msdn.microsoft.com/en-us/library/system.runtime.serialization.datacontractserializer.aspx); 它使用“选择加入”方法进行序列化。

此外，阅读[XmlSerializer 与 DataContractSerializer：Wcf](http://www.danrigsby.com/blog/index.php/2008/03/07/xmlserializer-vs-datacontractserializer-serialization-in-wcf/)中的序列化以作为示例以及 和 之间的比较`DataContractSerializer`也是一个好主意`XmlSerializer`。

> XmlSerializer 从 1.0 版开始就在 .Net 中，并且为我们提供了很好的服务，从 Remoting、Web 服务、序列化到文件等。但是在 .Net 3.0 中出现了 DataContractSerializer。突然之间，很多指导建议我们应该使用它而不是旧的、经过验证的 XmlSerializer。Wcf 甚至将其用作序列化的默认机制。问题是，“真的更好吗？”。结论是肯定的，否定的。像大多数事情一样，它取决于您的实施和您的需要。对于 Wcf，您应该更喜欢使用 DataContractSerializer。如果您需要完全控制 xml 的外观，您应该返回到 XmlSerializer。

# c++ - 如何向我的程序添加描述（-> 任务管理器中的描述列）（VS 2008，C++）

> ID：1013071
> 
> 赞同：13
> 
> 时间：2009-06-18T14:45:56.357
> 
> 标签：c++, visual-studio-2008, taskmanager

我在 Visual Studio 2008 中有一个简单的非托管 c++ 项目，并且想添加描述文本。现在我只在任务管理器描述列（进程选项卡）中看到可执行文件的名称，但我想在那里提供我自己的文本。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-06-18T15:01:26.950

您需要将 VERSIONINFO 资源添加到项目中，并将“FileDescription”属性设置为要显示的字符串。

[MSDN VERSIONINFO 文章](http://msdn.microsoft.com/en-us/library/aa381058.aspx)

```
VS_VERSION_INFO VERSIONINFO
 FILEVERSION 4,0,0,0
 PRODUCTVERSION 4,0,0,0
 FILEFLAGSMASK 0x3fL
#ifdef _DEBUG
 FILEFLAGS 0x1L
#else
 FILEFLAGS 0x0L
#endif
 FILEOS 0x4L
 FILETYPE 0x1L
 FILESUBTYPE 0x0L
BEGIN
    BLOCK "StringFileInfo"
    BEGIN
        BLOCK "040904e4"
        BEGIN
            VALUE "Comments", "\0"
            VALUE "CompanyName", "Acme Tea Company\0"
            VALUE "FileDescription", "Acme Automatic Tea Dispenser\0"
        END
    END
    BLOCK "VarFileInfo"
    BEGIN
        VALUE "Translation", 0x409, 1252
    END
END 
```

# keyboard - 通过关键字调用我的应用程序

> ID：1013073
> 
> 赞同：1
> 
> 时间：2009-06-18T14:46:36.043
> 
> 标签：keyboard, key

我的问题很简单，但实现起来很困难！

我希望每当用户使用某些组合键（在他的键盘上）时启动我的应用程序（Windows Application:: Visual C# .net）。

例如它键入`Ctrl`++并启动我的应用程序，仅此`W`而已`W`，我想要最简单的实现，更少的代码，更少的内存......

感谢：D

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-18T14:55:47.663

您需要结合您的应用程序编写一个键盘记录器类型的应用程序来监视键盘事件。一旦触发了您的特定快捷方式，您就可以加载您的应用程序。

有关如何捕获击键的信息，请参见[此处。](http://blogs.msdn.com/toub/archive/2006/05/03/589423.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-18T15:08:23.363

创建应用程序的快捷方式，并为快捷方式分配热键组合。根据操作系统的不同，并非每个按键组合都可以分配给快捷键，例如，您可以分配 Ctrl+Alt+W 但不能分配 Ctrl+W+W。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-18T15:12:53.853

在 Windows 上，您可以创建应用程序的快捷方式（在桌面上）。

当您打开快捷方式的属性时，在第二个选项卡（标记为“快捷方式”）上，您可以分配一个快捷方式键。但是您只能使用`Ctrl`+ `Alt`+ 快捷键。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-18T14:53:36.637

我认为您提出这个问题的方式是不可能的。然而，有可能的是让您的应用程序在启动时自动运行而不显示任何表单，让它连接到 Windows 以监视所有击键（我不确定如何执行该部分，确切地说），然后在出现时显示一个表单用户按下特定的键序列。

因此，换句话说，您的应用程序必须从 Windows 启动时开始运行，但仅在用户单击特定键序列时才显示自身（使表单可见）。

**更新**：这里是一篇文章的链接，该文章讨论了如何使用 C# 进行全局击键捕获：http: [//blogs.msdn.com/toub/archive/2006/05/03/589423.aspx](http://blogs.msdn.com/toub/archive/2006/05/03/589423.aspx)。

# c# - 占位符控制需要双重回发

> ID：1013074
> 
> 赞同：0
> 
> 时间：2009-06-18T14:47:04.340
> 
> 标签：c#, asp.net

这是一个有趣的问题。有问题的页面是类似页面的向导。这是场景-

1.  用户单击链接按钮以进入向导的第 2 步。（回发是不可避免的。基于 URL 的导航不是一个选项。）
2.  用户单击单选按钮/链接按钮/任何需要回发以进行客户端-服务器交互的控件。
3.  页面重新加载，好像什么也没发生。
4.  用户重复第 2 步。一切正常。

我做的是这个——

对于向导的所有步骤，我只有一页。根据该步骤，将适当的控件加载到页面中。此控件添加到 OnLoad 事件中的占位符控件。在 OnInit 或 OnPreRender 中这样做是行不通的。这个添加步骤引入了我上面描述的奇怪行为。

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-18T16:32:53.287

非常简单，您必须在每个回发上重新添加控件，重新附加事件处理程序并为动态加载的控件提供相同的 Id。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-18T15:47:29.260

由于您在运行时向页面添加控件以使向导显示在一个页面上，因此我认为这是重新排列一些代码的简单问题。

请参阅[CodeProject 上的这篇文章](http://www.codeproject.com/KB/aspnet/aspnetviewstatepagecycle.aspx)——特别是在名为“演练 6：视图状态和动态控件”的部分中讨论视图状态和动态控件的部分。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-23T07:31:41.677

该应用程序使用自定义控制框架。这个问题与框架有关。不得不重新设计方法。

# django - Django 停止打印到标准输出

> ID：1013084
> 
> 赞同：1
> 
> 时间：2009-06-18T14:47:56.663
> 
> 标签：django

首先，我使用的是 Windows，只是为了说明这一点。我习惯`cmd.exe`了`manage runserver`，服务器运行得很好。然而，有时，在看似随机的基础上，Django 只是停止写入标准输出！服务器响应我的请求和所有内容，但没有打印任何内容。

为了更清楚，我什至没有`print`在我的 Django 代码中谈论，所以这不是问题。我说的是当它打印时，例如`GET /someurl HTTP/1.1`yada-yada... 点击 Ctrl+Break 并重新启动服务器没有帮助。但是，如果我退出命令提示符并启动一个新命令提示符并在该命令提示符中运行服务器，它会再次开始工作。

关于发生了什么的任何想法？这是 Django 1.0.2 final 和 Python 2.6.2。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-19T10:16:11.027

`sys.stdout`您是否在代码中或`sys.stderr`在某个时间点分配了一些东西？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-22T11:26:35.220

开发服务器有时会表现得很奇怪，只需使用 ctrl-break 停止它，然后重新启动它。

您可以尝试一件事，以确保服务器本身没有停止，就是执行硬刷新（ctrl-F5），如果它没有响应，那么服务器实际上已经死了，而您只是看到页面的缓存版本。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-22T11:28:11.080

这可能看起来很愚蠢，但是您检查过日志文件吗？此外，您可以从 urllib 或您想要的任何 Web 客户端发出大量请求，并尝试重现该请求。也许你会看到为什么会发生这种情况的模式。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-23T20:05:53.857

也许有点牵强，但是在使用 Twisted 框架（而不是 Django）的 Linux 下的 Python 2.6 下，每当我的应用程序向 stdout 发送 NULL 并且 stdout 被重定向到 syslog 时，我都会发生这种行为。我曾认为这是扭曲框架的 syslog 实现中的一个错误，但可能还有更多。您能否从日志记录或客户端活动中看出它在丢失标准输出之前所做的最后一件事，看看它是否是 a) 总是在少数几个地方之一和 2) 如果您当时发送任何时髦的东西？

# flash - 将两个 Flash Player 窗口链接在一起

> ID：1013087
> 
> 赞同：0
> 
> 时间：2009-06-18T14:48:49.253
> 
> 标签：flash, firefox, flex3

我们有一个 Flex 3 应用程序，它的主要 .swf 文件在 Firefox 中运行。让我们将此应用程序称为 Main.swf。

我需要创建一个辅助 .swf，将其命名为 Panel.swf，它将嵌入到单独的 Firefox 弹出窗口中，该窗口将通过 ExternalInterface 从 Main.swf 调用 JavaScript 来调用。

是否可以以我可以启用从 Panel.swf 拖放到 Main.swf 的方式链接 Main.swf 和 Panel.swf？

我们的想法是让我们的 Main.swf RIA 运行，例如在用户主监视器上，然后让 Firefox 弹出窗口，其中包含在用户其他附加监视器上运行的单独 Panel.swf，如果他有一个......或至少一个单独的最小化窗口。

例如，Panel.swf 包含一些缩略图，用户可以将这些图像从 Panel.swf 拖放到 Main.swf。

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-18T15:05:36.783

我不确定拖放，但您可以使用本地连接轻松链接两者。可以在这里找到一个不错的助手类[http://www.gskinner.com/blog/archives/2007/07/swfbridge_easie.html](http://www.gskinner.com/blog/archives/2007/07/swfbridge_easie.html)

您可以在您的第一部电影的翻转中出现一个链接，该链接将图像“发送”到您的第二部电影。

希望有帮助，

乔什

# c# - 在 C# 中使用在 Delphi 7 中编译的 DLL

> ID：1013088
> 
> 赞同：2
> 
> 时间：2009-06-18T14:48:51.250
> 
> 标签：c#, delphi, dll

我需要在我的 C# 应用程序中使用在 Delphi 7 中制作的 DLL（硬件 ID 提取器）。

此 DLL 导出的函数有：

导出函数：

```
// CPU
function GetCPUSpeed: Double;
function CPUFamily: ShortString; { Get cpu identifier from the windows registry }
function GetCpuTheoreticSpeed: Integer; { Get cpu speed (in MHz) }
function IsCPUIDAvailable: Boolean; Register;
function GetCPUID (CpuCore: byte): ShortString;
Function GetCPUVendor: ShortString;

// RAM
function MemoryStatus (MemType: Integer): cardinal; { in Bytes }
function MemoryStatus_MB (MemType: Integer): ShortString; { in MB }

// HDD
function GetPartitionID (Partition : PChar): ShortString; { Get the ID of the specified patition. Example of parameter: 'C:' }
function GetIDESerialNumber(DriveNumber: Byte ): PChar; { DriveNr is from 0 to 4 } 
```

* * *

我知道（显然）Delphi 中的字符串不是空终止的，而是字节（ASCII）。但我不知道如何将这些 Delphi 字符串映射到 C#。

谢谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-06-18T15:42:56.723

问题来自您设计导出函数的方式。DLL（除其他外）是一种提供代码的机制，可以从以不同编程语言编写的应用程序（或其他 DLL）中使用它。

看看 Windows API，有很多函数返回文本。不幸的是，这是通过很多不同的方式完成的，Windows API 没有真正的标准。但是，我很确定您不会像您那样找到返回“字符串”（Pascal 或 C（空终止）字符串）的单个函数。原因很简单：这会使为不同的模块使用不同的编程语言变得非常困难甚至不可能。您的 DLL 将为字符串分配内存，一旦调用者处理完字符串，它就需要释放内存。因此，两个模块都需要共享该内存片的管理器。C# 程序如何使用您的 DLL，因为它们使用完全不同的内存管理器？

从 DLL 中获取字符串值的惯用方法是使用预分配的缓冲区和参数中的缓冲区长度调用函数，让函数用字符串内容填充该缓冲区，并让函数结果表示成功或失败。例如，传递大小不足的缓冲区将是失败的原因之一。不同的 Windows API 函数以不同的方式处理此问题，对您来说最简单的方法可能是使用常量定义最大字符串长度，`MAX_PATH`例如。

为了解决您的问题，您应该以一个您知道如何从 C# 调用并在缓冲区中返回字符串结果的 Windows API 函数为例。在此示例之后对导出的函数进行建模，并且应该很容易从 C# 程序中调用它们。

**编辑：**

我记得前段时间我看到过一个类似的问题（[如何从 Delphi 制作的 DLL 中导入函数？ ），现在我发现它也是你的。](https://stackoverflow.com/questions/609970/how-to-import-a-function-from-a-dll-made-in-delphi)

您当时写道，您没有该 DLL 的源代码，因此更改导出的函数是不可能的。您可以做的是在 Delphi 中创建一个包装 DLL（或 COM 对象），调用原始文件`HardwareIDExtractor.dll`并在其之上提供一个健全的 API。这将允许您同时提供导出函数的 AnsiChar 和 WideChar 版本。

如果您想减少混乱（需要两个 DLL 而不是一个），您还可以将原始`HardwareIDExtractor.dll`文件作为资源放入包装 DLL，如本博文所述：[在 Delphi 程序中使用存储为资源的 DLL](http://www.jasontpenny.com/blog/2009/05/01/using-dlls-stored-as-resources-in-delphi-programs/)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-06-18T14:55:09.567

下面是如何在 C# 中声明 GetCPUSpeed 函数的示例：

```
class Program
{
    [DllImport("the_name_of_the_delphi_library.dll")]
    public static extern double GetCPUSpeed();

    static void Main(string[] args)
    {
        double cpuSpeed = GetCPUSpeed();
        Console.WriteLine("CPU speed: {0}", cpuSpeed);
    }
} 
```

您还可以尝试其他声明：

```
[DllImport("the_name_of_the_delphi_library.dll")]
public static extern string CPUFamily();

[DllImport("the_name_of_the_delphi_library.dll")]
public static extern int GetCpuTheoreticSpeed();

[DllImport("the_name_of_the_delphi_library.dll")]
public static extern bool IsCPUIDAvailable();

[DllImport("the_name_of_the_delphi_library.dll")]
public static extern string GetCPUID(byte cpuCore);

[DllImport("the_name_of_the_delphi_library.dll")]
public static extern string GetCPUVendor();

[DllImport("the_name_of_the_delphi_library.dll")]
public static extern uint MemoryStatus(int memType);

[DllImport("the_name_of_the_delphi_library.dll")]
public static extern string MemoryStatus_MB(int memType);

[DllImport("the_name_of_the_delphi_library.dll")]
public static extern string GetPartitionID(char partition);

[DllImport("the_name_of_the_delphi_library.dll")]
public static extern string GetIDESerialNumber(byte driveNumber); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-18T21:13:19.190

如果您有 D7 dll 的源代码，您可以更改导出的函数以使 ShortString 函数返回 PChar。您可以创建调用原始函数并进行类型转换的新函数——这是最简单的方法。如果您遵循此路径，则对 Integer 和 Cardinal 类型执行相同的操作（分别将它们转换为 LongInt 和 LongWord）。下面的一些代码（我想像 Hausladen 先生这样的法师有一个更优雅的方法，但这有效:-)）

```
var
  SInput: ShortString;
  POutput: PAnsiChar;
  Tam: Integer;
  pt: Pointer;
begin
  SInput := 'Alphabet'; //ShortString
  pt := @SInput[1]; // Points to the first char of the string;
  Tam := (Length(SInput))+1; // Size the string
  POutput := StrAlloc(tam); // Allocate;
  CopyMemory(POutput,pt,tam); // Do the copy
  POutput[tam-1] := #0; // Put the null to finish
  MessageBox(0, POutput, 'Algo', MB_ICONWARNING or MB_OK);
  StrDispose(POutput);

end; 
```

这是因为内部 ShortString 是 Char 的数组 [0..255]。我手头没有 D2009 来查看 SizeOf(char) 是否必须更改为 SizeOf(AnsiChar)。*但*原理是一样的：分配 PAnsiChar，获取指向 ShortString 的第一个字符的指针，然后复制（在本例中我使用 CopyMemory）到 PAnsiChar。并将 null 放在它的位置。

或者你可以按照[mghie的](https://stackoverflow.com/questions/1013088/use-dll-compiled-in-delphi-7-in-c/1013463#1013463)方式创建一个包装器并在那里进行演员表。

# php - 邮政编码中的空格

> ID：1013091
> 
> 赞同：3
> 
> 时间：2009-06-18T14:48:59.347
> 
> 标签：php

我有一个脚本，要求输入邮政编码在其中有一个空格，否则它将失败。直截了当，但英国邮政编码在不同的地方可能有差距，即 W1 4SB、NW2 6PT 或 SG14 1LB 如果没有使用 PHP 输入正确格式的差距，我将如何更改用户输入？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-06-18T15:01:55.123

[邮政编码总是以 digit-letter-letter 结尾](http://www.govtalk.gov.uk/gdsc/html/frames/Postcode.htm)。只需在字符串末尾的第 4 个字符处查找空格，如果不存在，则插入它。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-06-18T15:11:57.380

对于完全合格的英国邮政编码，该空间实际上始终位于同一位置。就在最后 3 位数字/字母之前

所以首先验证它是一个真正的英国邮政编码并且它与格式匹配，然后执行以下操作：

```
$postcode = 'E154EZ';
if( isValidPostcode($postcode) ){
  $postcode = str_replace(' ','',$postcode);
  $postcode = wordwrap($postcode, strlen($postcode)-3,' ', true);
} 
```

PS。[您可以从这里](http://en.wikipedia.org/wiki/UK_postcodes#Validation)获取英国邮政编码验证正则表达式 + 额外信息

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-06-18T14:57:57.347

如果它总是在同一个地方（根据你的例子），你可以这样做：

```
<?php
//...assuming postalcode has already been loaded into $postalcode...

//If the fourth-to-last char isn't a space, add one in that position
if (substr($postalcode, -4, 1) != " ") {
    $postalcode = substr($postalcode, 0, strlen($postalcode) - 3).
                  " ".substr($postalcode, -3);
}

//do whatever with $postalcode you'd normally do...
?> 
```

可能想对此进行更多检查，例如最小长度等。但这应该可以帮助您。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-06-19T08:54:39.223

有效的解决方案是：

```
$postcode = trim(strip_tags($_REQUEST['postcode']));
$test = $postcode;
if(substr($test, -3) == " ") {
  $postcode = $postcode; 
  } 
  else {
  function stringrpl($x,$r,$str)
    {
    $out = "";
    $temp = substr($str,$x);
    $out = substr_replace($str,"$r",$x);
    $out .= $temp;
    return $out;
    }

    $test = stringrpl(-3," ",$test);
$postcode = $test;
  } 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2016-05-14T12:08:26.333

两个对准备和验证邮政编码有用的函数：

```
function prep_postcode($str){
    $str = strtoupper($str);
    $str = trim($str);
    if(substr($str, -4, 1) != ' ')
        $str = substr($str, 0, strlen($str) - 3) . " " . substr($str, -3);
    return $str;
}

function is_postcode($postcode){
    $postcode = str_replace(' ','',$postcode);
    return
        preg_match("/^[A-Z]{1,2}[0-9]{2,3}[A-Z]{2}$/", $postcode)
        || preg_match("/^[A-Z]{1,2}[0-9]{1}[A-Z]{1}[0-9]{1}[A-Z]{2}$/", $postcode)
        || preg_match("/^GIR0[A-Z]{2}$/", $postcode);
} 
```

使用示例：

```
$postcode = prep_postcode($postcode);
if(is_postcode($postcode)){
  // do something
} 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2012-03-08T21:34:30.353

```
$pcode_title = trim(strip_tags($_GET['pcode_title']));
$pcode_title = eregi_replace(" ", "", $pcode_title);
$pcode_first = substr($pcode_title, 0, -3); 
$pcode_last = substr($pcode_title, -3); 
$postcode = "$pcode_first"." "."$pcode_last"; 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-10-30T19:33:26.533

下面的函数将首先验证邮政编码，如果无效，则返回 false。如果有效，它将返回一个在 outcode 和 incode 之间有空格的邮政编码，无论你是否给它一个带空格的邮政编码。

```
function checkPostcode (&$toCheck) {
  // Permitted letters depend upon their position in the postcode.
  $alpha1 = "[abcdefghijklmnoprstuwyz]";                          // Character 1
  $alpha2 = "[abcdefghklmnopqrstuvwxy]";                          // Character 2
  $alpha3 = "[abcdefghjkpmnrstuvwxy]";                            // Character 3
  $alpha4 = "[abehmnprvwxy]";                                     // Character 4
  $alpha5 = "[abdefghjlnpqrstuwxyz]";                             // Character 5

  // Expression for postcodes: AN NAA, ANN NAA, AAN NAA, and AANN NAA with a space
  $pcexp[0] = '^('.$alpha1.'{1}'.$alpha2.'{0,1}[0-9]{1,2})([[:space:]]{0,})([0-9]{1}'.$alpha5.'{2})$';

  // Expression for postcodes: ANA NAA
  $pcexp[1] =  '^('.$alpha1.'{1}[0-9]{1}'.$alpha3.'{1})([[:space:]]{0,})([0-9]{1}'.$alpha5.'{2})$';

  // Expression for postcodes: AANA NAA
  $pcexp[2] =  '^('.$alpha1.'{1}'.$alpha2.'{1}[0-9]{1}'.$alpha4.')([[:space:]]{0,})([0-9]{1}'.$alpha5.'{2})$';

  // Exception for the special postcode GIR 0AA
  $pcexp[3] =  '^(gir)(0aa)$';

  // Standard BFPO numbers
  $pcexp[4] = '^(bfpo)([0-9]{1,4})$';

  // c/o BFPO numbers
  $pcexp[5] = '^(bfpo)(c\/o[0-9]{1,3})$';

  // Overseas Territories
  $pcexp[6] = '^([a-z]{4})(1zz)$/i';

  // Load up the string to check, converting into lowercase
  $postcode = strtolower($toCheck);

  // Assume we are not going to find a valid postcode
  $valid = false;

  // Check the string against the six types of postcodes
  foreach ($pcexp as $regexp) {

    if (ereg($regexp,$postcode, $matches)) {

      // Load new postcode back into the form element  
          $postcode = strtoupper ($matches[1] . ' ' . $matches [3]);

      // Take account of the special BFPO c/o format
      $postcode = ereg_replace ('C\/O', 'c/o ', $postcode);

      // Remember that we have found that the code is valid and break from loop
      $valid = true;
      break;
    }
  }

  // Return with the reformatted valid postcode in uppercase if the postcode was 
  // valid
  if ($valid){
      $toCheck = $postcode; 
        return true;
    } 
    else return false;
} 
```

# c# - 在 *.settings 文件中保留 WPF 控件

> ID：1013095
> 
> 赞同：1
> 
> 时间：2009-06-18T14:49:24.790
> 
> 标签：c#, .net, serialization, wpf-controls

是否可以将 WPF 控件或任何其他重要对象持久保存到 .NET 应用程序中的 *.settings 文件？我认为这很容易，因为 *.settings 文件允许我为每个单独的设置指定任意类型，不幸的是，它似乎对我不起作用。

我要做的是将*System.Windows.Controls.ListBox*持久化到我的应用程序的 *.settings 文件中。问题是，我的列表框实例实际上并没有被保存。当我再次运行我的应用程序时，当我去加载它时它只是*空的。*

这是我用来加载/保存我的 ListBox 实例的内容

```
 private void PersistListBoxToSettings(System.Windows.Controls.ListBox projectsListBox)
    {
        Properties.Settings.Default.ListBoxData = projectsListBox;
        Properties.Settings.Default.Save();
    }

    private void LoadProjectListBox()
    {
        projectsListBox = Properties.Settings.Default.ListBoxData; // Always null after application restart.
    } 
```

我测试了我的 *.settings 文件，以确保它甚至可以通过保存/加载一个简单的字符串来工作——它按预期运行。

我正在尝试做的只是一个非常糟糕的主意吗？我应该停止尝试变得聪明并使用正确的对象序列化到磁盘吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-18T15:12:30.717

我的信念是，您保存到 .settings 文件的对象必须是可序列化的，实现 ISerializable。我怀疑控件是否已实现此功能。这个链接似乎支持了我的想法：

[字节网论坛](http://bytes.com/groups/net-c/450453-properties-settings-arraylist-custom-object)

您可能可以制作一个包装器来保存它，实现 ISerializable 并使用 [SettingsSerializeAs(SettingsSerializeAs.Binary)] 作为解决此问题的链接建议。

# visual-studio-2008 - VS2008找不到测试项目

> ID：1013099
> 
> 赞同：0
> 
> 时间：2009-06-18T14:50:24.943
> 
> 标签：visual-studio-2008, unit-testing

我在 VS2008 中找不到测试项目。

谁能指出我需要安装哪些组件？

PS：我买不起Resharper。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-18T14:53:43.283

测试项目随团队版和专业版一起提供。

我要假设你有 Pro。有关如何创建和运行单元测试的信息，请访问[msdn：在 VIsual Studio 专业版中使用测试工具](http://msdn.microsoft.com/en-us/library/bb385902.aspx)。

如果您没有 Pro 或更好的，那么您可以获取[nUnit 测试框架](http://www.nunit.org/index.php)。它是免费的，并且是 MS 对其框架的建模。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-18T14:53:35.123

您使用的是哪个版本的 Visual Studio 2008？Professional 及更高版本支持测试项目，但 Express 不支持 - 我*认为*它们也不属于 Standard。

（请注意，测试项目仅在 VS2005 的团队版中，但它们已移至 VS2008 的 Pro。）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-18T14:53:35.280

确保您使用的是 Team System 或 Professional 版本。买不起 ReSharper ？？？伙计，这就是我所说的预算紧张。祝你好运！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-01-03T09:45:14.723

当您安装 VS2008 >= **PROFESIONAL时，您是否将****Unit Test Tools**选项切换为**on**？

 ****[![VS 2008 安装程序](../Images/088c54593a991fbbc48c52b3e5eb768d.png)](https://i.stack.imgur.com/THfAo.png)****

# django - 在给定的日期/时间范围内确定项目的流行度

> ID：1013101
> 
> 赞同：0
> 
> 时间：2009-06-18T14:50:48.547
> 
> 标签：django

我正在开发一个 django 网站，该网站需要跟踪给定日期/时间范围内项目的流行度。我需要能够在今天、本周、所有时间等获得最多观看次数……

[github](http://github.com/dokterbob/django-popularity/tree/master)上有一个“django-popularity”应用程序，看起来很有希望，但*只*适用于mysql（我使用的是postgresql）。

我最初的想法是创建一个通用的 ViewCounter 模型，该模型记录所有跟踪对象的视图，然后运行一个 cron 将这些数字压缩成每个项目的相关基于时间的统计信息。

期待听到您的想法。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-12-14T14:40:49.570

该应用程序仅在 MySQL 上进行了*测试*，但只需稍作调整即可完全适用于 Postgres。如果你确实设法让它工作：请通知我。（我是开发人员。）我很想能够告诉人们这个产品也可用于 Postgres。

而且; 所有依赖于原始 SQL 的功能都会检查是否真的有一个 MySQL 数据库在使用中。如果不是，它应该抛出一个断言错误。

此外，通用视图计数器已经在我的包中（它被称为 ViewTracker，但地狱）。如果我们也可以进行 SQL 或 Django 缓存，那么 cron 工作对我来说似乎太麻烦了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-18T14:54:45.247

你用 postgres 尝试过 django-popularity 吗？github页面只是说开发人员没有用MySQL以外的任何东西对其进行测试。

# ajax - 当试图将一个网站与另一个网站集成时，该怎么做？iframe 还是拉取内容？

> ID：1013107
> 
> 赞同：3
> 
> 时间：2009-06-18T14:51:21.680
> 
> 标签：ajax, security, iframe, xss, dynamic-data

我的公司有多家供应商，它们都有自己的网站。我正在创建一个充当仪表板的网站，客户可以在其中访问所有供应商的网站。我想知道这样做的最佳选择是什么？

这是我到目前为止所拥有的：

框架

*   可以带入整个网站
*   似乎足够安全（不确定我是否遗漏了有关此安全问题的任何信息）
*   用户可以通过我们的网站与供应商的网站进行交互
*   我们的网站无法与供应商的网站完全互动（这里也可能缺少信息）

拉入内容

*   可以带入整个网站
*   从我听到的情况来看不是很安全（有些网站实际上说拉另一个网站是违反安全性的，并且会提醒用户这个或类似的东西......
*   用户可以通过我们的网站与他们的网站互动
*   我们的网站可以与供应商的网站充分互动

任何人有任何其他选择...？

引入带有 iframe 的网站有哪些缺点，这真的是我们做这种事情的唯一选择吗？

最理想的情况是，我们希望在不使用 iframe 的情况下将他们的网站拉入我们的网站——我们在这个级别上有哪些选择？有什么比 iframe 更好的吗？

请尽可能多地添加有关 iframe、拉取内容、安全性和此类网站交互的信息。任何要添加的东西都会受到赞赏。

谢谢，
马特

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-18T16:39:28.680

就“拉取内容”而言，我不建议这样做，因为它可能会破坏。只需要对它们进行简单的 HTML 更改，您的机器人就会崩溃。此外，为一个站点执行此操作比您想象的要多，更不用说您所说的许多站点了。但是，如果您有预算，可以使用 3rd 方应用程序为您执行此操作。

您可以使用 iframe/frames，但是，许多网站可能会尝试摆脱它们，这可能会破坏框架内网站的用户体验。

我的建议是为仪表板中的每个链接使用以下 HTML。

```
<a href="http://www.VendorSite.com" target="_blank">Vendor Site Link</a> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-07-05T22:00:08.417

如果您可以让要嵌入的站点添加一些客户端脚本，那么您可以使用[easyXSS](http://easyxss.net)。它允许轻松传输数据，还可以跨域边界调用 javascript 方法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-07-05T22:22:20.353

我会推荐 iFrame。虽然不是最吸引人的元素，但许多支付服务提供商使用 iFrame 进行 Visa/Mastercard 安全代码集成验证。

# javascript - 我应该在哪里声明页面中使用的 JavaScript 文件？在或附近？

> ID：1013112
> 
> 赞同：41
> 
> 时间：2009-06-18T14:51:49.667
> 
> 标签：javascript, html

我正在阅读一个教程，作者提到在 HTML 的结束`body`标记 ( `</body>`) 附近包含 JavaScript 文件。

对于哪些类型的功能，我不应该在该部分中声明/定义 JavaScript 包括`head`？对我来说，在结束标记附近包含像[Google Analytics这样的 JavaScript 是有意义的。](https://en.wikipedia.org/wiki/Google_Analytics)在结束标记`body`附近定义 JavaScript 包含时应该注意哪些地方？`body`

* * *

## 回答 #1

> 赞同：42
> 
> 时间：2009-06-18T14:54:26.527

经常有人争辩说，出于速度目的，您应该将脚本标签放在文档的末尾（在结束的正文标签之前）。虽然这将导致最快的页面加载，但它有一些严重的缺点。

首先，网页开发的一个常见习语是在中间有一个头文件、一个页脚文件和你的内容。为了尽量减少不必要的 JavaScript 代码，您通常希望将代码片段放在单独的页面中。

例如，如果您在文档末尾包含[jQuery](https://en.wikipedia.org/wiki/JQuery)，那么您的 jQuery 代码片段（如文档就绪的东西）必须在此**之后**发生。从开发的角度来看，这可能很尴尬。

其次，根据我的经验，由于页面加载速度更快，您最终可能会注意到某些效果正在应用，因为在应用它们时页面已经加载。

例如，如果您将表格放在文档中，并且在正文关闭标记之前放置：

```
$(function() {
  $("tr:nth-child(odd)").addClass("odd");
}); 
```

通过适当的样式，应用的效果通常是可见的。我个人认为这可能会导致糟糕的用户体验。我认为如果你没有得到令人不安的视觉效果，通常你最好让页面加载**稍微慢一点（通过将脚本放在顶部）。**

我通常提倡有效的缓存策略，因此您只需要在 JavaScript 文件发生更改时下载它们，就像在[PHP 中为 JavaScript 增压](http://www.cforcoding.com/2009/05/supercharging-javascript.html)（但这些原则适用于任何语言，而不仅仅是 PHP）并且仍然将脚本放在顶部。这要方便得多。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-06-18T14:56:46.710

通过将它们放入其中，`<head/>`您可以强制浏览器在呈现页面之前下载文件。这会导致感知的加载时间变慢。

通过将它们放在页脚中，就在结束 body 标记之前，浏览器将不会加载它们，直到它到达 HTML 解析的那个点。这意味着脚本将在页面加载过程中稍后运行，但不会阻止资产下载和呈现过程。

哪种效果最好取决于您以及您如何开发代码。

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2009-06-18T14:54:37.460

[雅虎 YSlow 工具](http://developer.yahoo.com/performance/rules.html#js_bottom)对此有建议：

> 脚本引起的问题是它们会阻止并行下载。HTTP/1.1 规范建议浏览器每个主机名并行下载不超过两个组件。如果您从多个主机名提供图像，则可以同时进行两次以上的下载。但是，在下载脚本时，浏览器不会启动任何其他下载，即使在不同的主机名上也是如此。
> 
> 在某些情况下，将脚本移到底部并不容易。例如，如果脚本使用 document.write 插入部分页面内容，则不能将其移至页面下方。也可能存在范围问题。在许多情况下，有一些方法可以解决这些情况。
> 
> 经常出现的另一种建议是使用延迟脚本。DEFER 属性指示脚本不包含 document.write，并且是浏览器可以继续呈现的线索。不幸的是，Firefox 不支持 DEFER 属性。在 Internet Explorer 中，脚本可能会被延迟，但不会像期望的那样延迟。如果可以推迟脚本，也可以将其移至页面底部。这将使您的网页加载速度更快。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-06-18T15:04:14.213

Google [pagespeed](http://code.google.com/speed/page-speed/)对如何并行下载脚本有一些[很好的解释。](http://code.google.com/speed/page-speed/docs/rtt.html#PutStylesBeforeScripts)

他们的建议仍然是将它们放在页面的顶部。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-06-18T14:55:09.550

脚本标签通常应该在 head 部分。例外情况是当他们进行重要的即时处理时，应尽可能延迟到页面加载时，以避免干扰即将出现的页面，如谷歌分析，或者当脚本标签的实际放置是其行为的一部分时。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-06-18T14:54:53.077

声明接近尾声的原因是您的页面可以在等待获取 .js 之前开始绘制。

因此，您最后想要的东西对页面渲染没有影响，反之亦然。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-06-19T01:01:49.087

我喜欢在头部加载一个小的 js 文件，它处理 (1) 页面呈现之前发生的任何事情，以及 (2) 在页面加载之后或根据需要加载其他脚本文件。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2010-01-05T17:12:48.557

我相信最好将脚本标签放在结束正文标签之前。因为：

*   如果元素位于脚本下方，则它们将被阻止渲染。
*   在[Internet Explorer 6](https://en.wikipedia.org/wiki/Internet_Explorer_6)和[Internet Explorer 7](https://en.wikipedia.org/wiki/Internet_Explorer_7)中，如果页面中的资源位于脚本下方，则它们将被阻止下载。

它来自[这篇文章](http://www.stevesouders.com/blog/2009/04/27/loading-scripts-without-blocking/)。此外，雅虎的性能规则 6 是[将脚本移至底部](http://developer.yahoo.net/blog/archives/2007/07/high_performanc_5.html)。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2012-05-19T11:58:01.410

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2015-05-30T14:56:45.460

你应该把 JavaScript 放在`</body>`. 理想情况下，您的 HTML 应该在没有 JavaScript 的情况下运行，因此它应该是最后加载的内容之一。

请记住，您应该使用 CSS 而不是 JavaScript 来隐藏元素。这样可以避免在页面加载时看到元素出现和消失。

您可能还会遇到以下问题...

### 问题

在这种情况下，我将使用 PHP 作为示例。

您的`footer.php`文件当前可能如下所示：

```
<script src="jquery.js"></script>
<script src="custom.js"></script>
</body>
</html> 
```

但是在极少数情况下您想`<script>`为一页专门添加一些会发生什么？你不能把它放在后面，`footer.php`因为你不再在`<body>`标签中，但你不能把它放在前面，因为这样你`jquery.js`的代码就会丢失。

### 解决方案

有一个`footer-start.php`文件：

```
<script src="jquery.js"></script>
<script src="custom.js"></script> 
```

还有一个`footer-end.php`文件：

```
</body>
</html> 
```

让你`footer.php`变得简单：

```
<?php
  require 'footer-start.php';
  require 'footer-end.php'; 
```

然后，在极少数情况下您需要`<script>`为一页使用自定义，请执行以下操作：

```
<?php require 'footer-start.php'; ?>
<script>...</script>
<?php require 'footer-end.php'; ?> 
```

这样做意味着您不必更改所有以前`footer.php`引用的代码。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-06-18T14:55:12.750

你应该在附近做`</body>`。原因很简单：如果把它放到`head`区域中，必须先加载文件，然后body区域才可以。那时，用户只看到一个白屏。

但这取决于您的网站。我会在头部区域加载诸如 mootools 之类的框架，事件或 AJAX 的其他功能或应该在`</body>`.

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-06-18T14:56:03.340

将其放在正文末尾附近的唯一原因，AFAIK，是为了能够在 Web 浏览器解析您的 HTML 文档*后执行 JavaScript。*例如，如果您的 JavaScript 处理“所有名为`hello`”的元素，则浏览器需要在执行 JavaScript 之前读取整个文档。有道理，对吧？

在例如 jQuery 中，您可以将 JavaScript 放在文档中的任何位置并使用：

```
$(document).ready(function () {
  // Your code here
}); 
```

...在执行内部函数之前确保整个文档已加载到[DOM中。](https://en.wikipedia.org/wiki/Document_Object_Model)当然，这也可以使用普通的 JavaScript 来完成，但要注意不要破坏与某些浏览器的兼容性，因为它们的需求往往会有很大差异。

# database - 我应该在存储到数据库之前修剪字符串吗？

> ID：1013125
> 
> 赞同：1
> 
> 时间：2009-06-18T14:53:29.227
> 
> 标签：database

我遇到的情况是这样的。当存储实体的代码（必须在数据库中唯一）时，从技术上讲，有人可以将“12345”和“12345”作为代码，数据库会认为它们是唯一的，但对于最终用户来说，显示空间使其看起来它们是重复的，可能会导致混淆。

在这种情况下，我肯定会在存储前修剪。

这应该成为所有字符串的标准吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-06-18T14:57:12.980

我认为除非空间对数据很重要，否则您应该将其删除。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-06-18T15:00:46.000

这是答案为“视情况而定”的问题之一。

您需要记住的是最小惊讶原则。用户会非常惊讶地看到两个看起来相同的代码，特别是当您将其显示在表单或表格中时，最后的空间基本上消失了。用户还期望这些代码是唯一的，并且他们可能期望您的系统强制执行此操作。对于用户来说，空间并不是他们真正期望引起差异的东西。

在其他一些情况下，例如在内容管理系统或文字处理器中，当用户有意识地放入空格时，他希望底层数据存储能够保留他的空格。在这种情况下，用户可能会放入空格以对齐内容或出于视觉目的。在这种情况下，最后删除空格会让用户感到惊讶。

所以总是尽可能地为用户的工作流程建模。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-18T14:56:42.230

如果您使用 varchar，请在表上设置一个不允许前导空格的约束，还记得 GIGO 吗？如果代码是数字，则使用数字数据类型

# c++ - 使用 bcc32 生成预处理文件

> ID：1013131
> 
> 赞同：1
> 
> 时间：2009-06-18T14:53:43.003
> 
> 标签：c++, c-preprocessor, borland-c++

有谁知道使用`bcc32.exe`（5.6.4 版）生成预处理文件的命令行选项是什么？我知道使用`gcc`你可以`-E`用来生成`.i`文件。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-18T15:04:03.933

不要使用 bcc32.exe，而是使用 cpp32.exe。

有关其命令行选项的更多信息，请参见[此处](http://pjtsalina.codigolivre.org.br/doc/c/C++Builder5Examples/WinTools/CPP32.TXT)或使用“cpp32.exe -?”。

# iphone - 在黑色背景的 MoreNavigationController 中不可见的选项卡栏项目图像

> ID：1013134
> 
> 赞同：2
> 
> 时间：2009-06-18T14:54:20.457
> 
> 标签：iphone, uitabbarcontroller

我有一个带有“更多”视图控制器的选项卡栏 (UITabBarController) 应用程序，因为它有 5 个以上的视图。我的应用程序的其余部分具有黑色背景和白色文本，我已经能够自定义此表以匹配它。然而，因此，通常出现在“更多”表左侧的选项卡栏图像是不可见的（因为它们适用于白色背景）。我需要找到一种方法来使标签栏图像显示为它们在标签栏中的显示方式，该标签栏本身具有黑色背景。

例子：

[黑色背景（不可见图像）](https://imgur.com/oQM9N.png)

我将 TabBarController 子类化并更改了“MoreTableView”的数据源：

**TabBarController.m**

```
- (void)viewDidLoad {

    [super viewDidLoad];

    UINavigationController *moreController = self.moreNavigationController;

    moreController.navigationBar.barStyle = UIBarStyleBlackOpaque;

    if ([moreController.topViewController.view isKindOfClass:[UITableView class]])
    {
        UITableView *view = (UITableView *)moreController.topViewController.view;
        view.separatorColor = [[UIColor alloc] initWithRed:0.3 green:0.3 blue:0.3 alpha:1.0];    
        view.backgroundColor = [UIColor blackColor];
        view.dataSource = [[MoreTableViewDataSource alloc] initWithDataSource:view.dataSource];
    }
} 
```

**MoreTableViewDataSource.m**

```
-(MoreTableViewDataSource *) initWithDataSource:(id<UITableViewDataSource>) dataSource
{
    originalDataSource = dataSource;
    [super init];
    return self;
}

- (NSInteger)tableView:(UITableView *)table numberOfRowsInSection:(NSInteger)section
{
    return [originalDataSource tableView:table numberOfRowsInSection:section];
}

- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{
    UITableViewCell *cell = [originalDataSource tableView:tableView cellForRowAtIndexPath:indexPath];
    cell.textColor = [[UIColor alloc] initWithRed:1 green:0.55 blue:0 alpha:1.0];
    cell.accessoryView = [[UIImageView alloc] initWithImage:[UIImage imageNamed:@"customAccessory.png"]];
    return cell;
} 
```

在此先感谢，
朱利安

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-19T08:26:22.247

做事`moreController.topViewController.view`有点危险。

我建议您将自己创建的选项卡放入带有普通图标的更多列表，然后通过普通导航控制器方法打开更多列表下的其他选项卡。当然，您需要从标签栏中删除所有溢出的标签项。

然而，可能有一种更优雅的方式来做到这一点。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-12-30T18:46:56.503

首先，感谢您发布标签栏控制器的子类。我将它包含在我正在编写的应用程序中并遇到了同样的问题。

我的解决方案是简单地交换图像和突出显示的图像。为此，您必须更改 的方法`tableView:cellForRowAtIndexPath:`， `MoreTableViewDataSource.m`例如：

```
- (UITableViewCell *) tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath {
    UITableViewCell *cell = [dataSource tableView:tableView cellForRowAtIndexPath:indexPath];
    UIImageView *imageView = [cell imageView];
    UIImage *image = [imageView image];
    [imageView setImage:[imageView highlightedImage]];
    [imageView setHighlightedImage:image];
    return cell;
} 
```

干杯，迈克尔

# wix - 如何检查 CustomAction 的属性（Wix）？

> ID：1013140
> 
> 赞同：1
> 
> 时间：2009-06-18T14:54:54.840
> 
> 标签：wix, windows-installer, wix3

我正在尝试在 Wix 中组合一个小的“先决条件”对话框，以让用户相信他们拥有运行我的软件所需的所有必需品：

例如，我需要托管 DirectX，所以我寻找一些 DLL：

```
<Property Id="MANAGED_DIRECTX">
  <DirectorySearch Path="$(env.SystemRoot)\Microsoft.NET\DirectX for Managed Code\1.0.2902.0" Depth="0" Id="MDXDir">
    <FileSearch Name="Microsoft.DirectX.dll"/>
  </DirectorySearch>
</Property>

<Property Id="MANAGED_DIRECTX_DIRECTINPUT">
  <DirectorySearch Path="$(env.SystemRoot)\Microsoft.NET\DirectX for Managed Code\1.0.2902.0" Depth="0" Id="MDXInputDir">
    <FileSearch Name="Microsoft.DirectX.DirectInput.dll"/>
  </DirectorySearch>
</Property> 
```

我还有一个 CustomAction 来组合我的条件逻辑：

```
<CustomAction Id="SetManagedDirectXInstalled"
              Property="MANAGED_DIRECTX_INSTALLED"
              Value="NOT([MANAGED_DIRECTX] = '') AND NOT ([MANAGED_DIRECTX_DIRECTINPUT] = ''")/> 
```

此 CustomAction 是按顺序排列的：

```
<InstallExecuteSequence>
  <Custom Action="SetManagedDirectXInstalled" After="AppSearch" />
  <RemoveExistingProducts After="InstallInitialize" />
</InstallExecuteSequence> 
```

我现在应该能够做的是使用“MANAGED DIRECTX INSTALLED”来做一些事情，例如

```
 <Control Id="NoManagedDirectX" Type="Text" X="20" Y="50" Width="300" Height="60" Transparent="yes" NoPrefix="yes" Hidden="yes">
      <Text>Microsoft Managed DirectX (MDX) for DirectX 9.0 is NOT installed</Text>
      <Condition Action="show">NOT MANAGED_DIRECTX_INSTALLED</Condition>
    </Control>
    <Control Id="ManagedDirectX" Type="Text" X="20" Y="50" Width="300" Height="60" Transparent="yes" NoPrefix="yes" Hidden="yes">
      <Text>Microsoft Managed DirectX (MDX) for DirectX 9.0 is correctly installed</Text>
      <Condition Action="show">MANAGED_DIRECTX_INSTALLED</Condition>
    </Control> 
```

不管我做什么，即使我知道文件在那里，条件总是错误的（例如未安装）。使用带有 /l*vx 的 msiexec 命令不会在任何地方显示 MANAGED DIRECTX INSTALLED 属性。

当 <Condition> 与以下内容一起使用时，它会成功阻止安装（尽管在这种情况下我不再想阻止安装，只是建议）。

```
<Condition Message="You must have Microsoft Managed DirectX (MDX) for DirectX 9.0 installed">
  MANAGED_DIRECTX AND MANAGED_DIRECTX_DIRECTINPUT
</Condition> 
```

我怎样才能跟踪/调试这个（或者我做错了什么？）

* * *

***编辑***- 我现在确定我的 CustomAction 甚至没有被调用，将其设置为以下也没有显示预期的结果！

```
<CustomAction Id='SetManagedDirectXInstalled'
              Property='MANAGED_DIRECTX_INSTALLED'
              Value='Something hard-coded'/> 
```

或者

```
<CustomAction Id='SetManagedDirectXInstalled'
              Error='Some error should show!'/> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-18T17:30:07.493

我想我可能已经找到了答案，但是直到我下一次在我的开发 PC 上我才能尝试它。

看来我必须将值与 TRUE/FALSE （或空字符串）进行比较，而不仅仅是期望它作为布尔值（[Source](http://www.tramontana.co.hu/wix/lesson5.php#expression)）

> 在这些表达式中，您可以使用属性名称（请记住它们区分大小写）。不存在的属性名称将被视为空字符串。属性的逻辑值反映了它是否已被设置——这意味着您不能仅通过使用该属性来检查逻辑值：
> 
> *   PROPERTY
>     如果该属性已设置并具有任何值，即使该值为 false，这将评估为 true。
> *   NOT PROPERTY
>     如果根本没有设置属性，这将评估为 true。
> *   属性 = 真
> *   PROPERTY = FALSE
>     这是检查逻辑属性值的正确方法。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-18T18:57:37.287

1.  要进行调试，请使用详细日志文件。它将向您显示您的属性的状态，因为它们发生了变化。然后，您应该能够使用该知识评估条件

2.  不久前我在这里回答了同样的问题。使用属性名称的条件是对存在性的测试。如果 Property 有任何值，则 Property 的存在性测试评估为 true。如果你想检查一个属性的值，你需要明确地这样做。

# cakephp - 从 Cake PHP 中关联表字段名 = 'x' 的表中选择

> ID：1013149
> 
> 赞同：0
> 
> 时间：2009-06-18T14:55:37.227
> 
> 标签：cakephp, mysql, associations

在 CakePHP 中，我有两个表，国家和网络。他们有 HABTM 关系，并由 countries_networks 加入。

我正在尝试从国家/地区表中获取所有国家/地区，其中 Networks 中的“名称”字段 = 'o2'

我意识到我不能使用基本的 find() 来做到这一点，所以我一直在试验可包含的行为。我设法限制了返回的数据，但看起来“可包含”并不能完全按照我的意愿工作。这是我的代码：

```
$countries = $this->Country->find('all', array('contain' => array(
                                'Network' => array(
                                'conditions' => array('Network.name =' => "o2"),
    )
    ))); 
```

但是，此查询返回所有国家，如果它是“o2”，则返回 Network.name。我真正需要做的是只返回 Network.name 为“o2”的国家/地区，而不返回其他国家/地区。

任何人都可以帮忙吗？谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-18T15:50:02.267

"=' =>" 是什么？“Network.name”后无需使用“=”符号

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-18T16:16:48.297

你应该能够做这样的事情：

```
$this->Country->hasAndBelongsToMany['Network']['conditions'] = array('Network.name'=>'o2');
$myCountries = $this->Country->find('all'); 
```

我还没有测试过这个，但它应该让你非常接近你需要的地方。

另外，请记住，像这样更改 hasAndBelongsToMany 数组将影响当前页面加载期间对该模型的所有后续查询（但它将在下一次实例化模型时重置）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-18T19:49:54.973

我在出门的路上，很抱歉简短的解释。

我认为您想要的是 HABTM 关系，但能够根据关联模型的数据进行过滤。为此，请查看 Cake 手册中的“可包含”行为。很确定这就是你所追求的。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-19T10:22:16.350

您的查询将准确返回您的要求。尝试从网络中选择。

```
$countries = $this->Country->Network->find('first', array(
    'conditions' => array('Network.name' => "o2"),
    'contain' => array('Country')
));

$countries = $countries['Country']; 
```

# ruby-on-rails - 一个控制器使用另一个控制器的视图进行渲染

> ID：1013152
> 
> 赞同：40
> 
> 时间：2009-06-18T14:55:51.530
> 
> 标签：ruby-on-rails, view, controller, render

我有 QuestionController 我现在有 AnotherQuestionController 的动作应该使用 app/views/question/ 中的模板和部分呈现这可能吗？似乎应该如此。

我试过了

```
render :template => "question/answer" 
```

但 answer.html.erb 包含部分内容，我收到类似的错误

“视图路径中缺少模板 another_question/_my_partial.erb”

那么有没有办法告诉Rails“将AnotherQuestionController视为它的QuestionController并在app/views/question中查找视图和部分”？或者我是否必须创建 app/views/another_question - 这将导致重复（这不能是 Rails 方式）。

谢谢

* * *

## 回答 #1

> 赞同：60
> 
> 时间：2009-06-18T14:58:13.117

模板渲染应该实际工作

```
 render :template => "question/answer" 
```

你遇到的问题是局部看错了地方。修复很简单，只需在任何共享模板中使您的部分绝对。例如，question/answer.html.erb 应该有

```
<%= render :partial => 'question/some_partial' %> 
```

而不是通常的

```
<%= render :partial => 'some_partial' %> 
```

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-06-18T15:13:52.523

您可以通过以下方式实现：

```
render 'question/answer' 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2019-01-03T17:58:39.957

Rails 使用前缀列表来解析模板和部分。虽然您*可以*显式指定前缀（“问题/答案”），如另一个答案中所建议的，但如果模板本身包含对其他部分的非限定引用，则此方法将失败。

假设您有一个 ApplicationController 超类，并且 QuestionController 继承自它，那么 Rails 查找模板的位置依次是“app/views/question/”和“app/views/application/”。（实际上它也会在一系列视图路径中查看，但为了简单起见，我对此进行了掩饰。）

鉴于以下情况：

```
class QuestionController < ApplicationController
end

class AnotherQuestionController < ApplicationController
end

QuestionController._prefixes
# => ["question", "application"]
AnotherQuestionController._prefixes
# => ["another_question", "application"] 
```

**解决方案#1。** 将部分放在“app/views/application/”而不是“app/views/question/”下，两个控制器都可以使用它。

**解决方案#2。** 如果合适，从 QuestionController 继承。

```
class AnotherQuestionController < QuestionController
end
=> nil
AnotherQuestionController._prefixes
# => ["another_question", "question", "application"] 
```

**解决方案#3。** 定义类方法AnotherQuestionController:: [local_prefixes](https://github.com/rails/rails/blob/3b68b404a4d1bc2e304d13317366d36c4ffd3611/actionview/lib/action_view/view_paths.rb#L25)

这是在 Rails 4.2 中添加的。

```
class AnotherQuestionController < ApplicationController
  def self.local_prefixes
    super + ['question']
  end
end
AnotherQuestionController._prefixes
# => ["another_question", "question", "application"] 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-06-18T15:07:14.143

[您可以尝试我在此问题](https://stackoverflow.com/questions/998190/rails-abstract-shared-views/998561#998561)的答案中提到的 inherit_views 插件 ( [http://github.com/ianwhite/inherit_views/tree/master](http://github.com/ianwhite/inherit_views/tree/master) ) 。

# android - Android：如何使用现有的图形元素

> ID：1013157
> 
> 赞同：1
> 
> 时间：2009-06-18T14:56:30.063
> 
> 标签：android, uiimageview, reusability

我想创建一个包含网络指示图标（3G、WiFi ...）的用户界面，并且我想使用显示在通知栏中的现有图形元素。

有谁知道如何获取这些现有元素并在自定义布局中使用它？

我猜这些图标都是 ImageView 元素，我想知道是否可以用`findViewById()`方法检索它们。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-18T16:47:39.207

它们是 android.R.drawable 中的可绘制对象。在可绘制列表中有 1.0 的可用[绘制列表](http://www.screaming-penguin.com/info/android_drawables/android_drawables.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-18T16:51:55.227

您可以访问[http://source.android.com/download](http://source.android.com/download)以获取有关如何下载 Android 资源（包括图像/drawables）的说明，搜索 *.pngs，然后像这样引用您需要的资源：getResources()。 getDrawable(android.R.drawable.ic_menu_save)。

PS至少有一些drawables带有sdk：$SDK_PATH\platforms\android-1.5\data\res\drawable

# java - 从 Java 访问 NexusDB

> ID：1013161
> 
> 赞同：1
> 
> 时间：2009-06-18T14:57:06.817
> 
> 标签：java, sql, jdbc, odbc, nexusdb

我正在尝试使用 java 从名为 NexusDB 的嵌入式数据库中获取信息。

## 备选方案 1：

我在[NexusDB 网站](http://www.nexusdb.com/support/index.php?q=node/10046)上读到有一个 ODBC 驱动程序，所以我可以将它与 unixODBC 一起使用。然后我需要按照[此处](http://www.easysoft.com/developer/interfaces/odbc/linux.html#jdbc_odbc)所述进行 JDBC-ODBC 桥接。

## 备选方案 2：

获取某种应用程序以将 NexusDB 数据库迁移到另一个数据库。想知道一个。

我想知道是否有人遇到过这种情况，最好的解决方案是什么？

谢谢阅读。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-19T16:10:14.223

## 备选方案 1：

不可能。

unixODBC 需要 linux 驱动程序，而 nexusDB 不需要。

## 备选方案 2：

没找到。

## 到目前为止的解决方案

使用 delphi 编写一个小型 web 服务或获取 odbc 并在小型代理中使用它。换句话说，不是连接到 nexusdb 服务器，而是连接到专用应用程序或 web 服务传递信息，并且该应用程序确实连接到 nexusd 并写入数据。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-04-09T17:54:27.433

我在 wine 下运行 nexusDB 取得了一些成功。

我能够设置一个 WINEPREFIX，按照[此处](http://wiki.winehq.org/NativeOdbc)的说明进入 wine 的 odbc 管理面板（默认情况下它通过管道连接到 unixODBC，正如 Macarse 指出的那样，这是一个死胡同），在那里设置一个 DSN 并测试它是否可以访问数据。

我尝试的下一件事是安装 win32 PHP 并使用 odbc_connect 编写一个快速而肮脏的测试。在意外地使用 linux php 二进制文件并想知道为什么它不能使用（仅在 win32 上内置）函数 odbc_connect 浪费了大量时间之后，我确实让它工作了。

提示：为了避免像用头撞砖墙的感觉，请记住，在此环境中运行 php 脚本的任何尝试都必须如下所示

`WINEPREFIX=/home/you/yourprefix wine php c:\phptest.php`

不是

`WINEPREFIX=/home/you/yourprefix php c:\phptest.php`

第二个版本将使用 linux php 二进制文件。在运行第二个版本几十次之后感觉很愚蠢，并在意识到出了什么问题之前用谷歌搜索了一些错误——我想我需要晚点起床才能在凌晨 4 点继续工作:(

（上面示例中的 c:\ 路径可以按照`/home/you/yourprefix/drive_c/whatever`您的喜好传递 - 相对路径也可以）

是的，我知道这是一个 necro 帖子，但这是一个非常小众的情况，没有很多信息可以让 nexusdb 和 odbc 在 linux 上运行良好，如果几个月前我可以获得这些信息我在谷歌上搜索并发现了这个线程，它可以为我节省很多时间。希望其他人觉得它有帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-24T14:00:12.103

如果您通过 .NET 连接到 Nexus，也许您可​​以使用[IKVM](http://www.ikvm.net/)运行您的 Java 应用程序并通过 .NET api 连接？

否则，我认为您自己的“到目前为止的解决方案”听起来不错。

最佳安德斯

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-24T19:22:53.540

由于它是嵌入式的（并且您可能拥有对机器的完全访问权限），那么如何将数据库文件复制到 Windows 系统，设置 NexusDB 及其 ODBC 驱动程序，然后在该机器上使用 ODBC-JDBC 桥接器呢？桥运行后，您可以设置一个新的与 JDBC 兼容的 DBMS，您可以选择连接并使用一些代码从 NexusDB 中选择并插入到您的新数据库中。

如果您希望迁移到另一个嵌入式 DBMS，我正在使用[H2 Database](http://www.h2database.com/html/features.html) for Java，我不得不说它真的很棒。嵌入式和客户端/服务器模式，跨平台，对于 1M 行以下的任何内容都非常快速。几乎支持您在嵌入式 DBMS 中拥有的任何功能，然后是一些功能。

# sql - 使用 SQL Server 生成资源忙/闲查询

> ID：1013173
> 
> 赞同：0
> 
> 时间：2009-06-18T14:58:23.787
> 
> 标签：sql, sql-server, sql-server-2005

在 SQL Server 2005 中，我有一个包含以下列的表：

```
Table Reservations:
ID
arrival datetime
departure datetime
reservation_object (FK to objects table) 
```

现在我需要生成一个报告，显示指定时间段内对象的状态。该报告必须如下所示：

```
 6/1/09  6/2/09  6/3/09  6/4/09 ... 
object 1    free    free    busy    busy
object 2    busy    free    busy    busy
... 
```

从 SQL Server 获取此信息的最佳方式是什么？我将在 C#.Net 中使用它。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-18T15:04:34.463

您可能会发现数据客户端更容易进行旋转 - 因此，请向 SQL Server 询问在您感兴趣的日期窗口结束之前开始的所有约会，但只询问在您感兴趣的日期窗口开始之后完成的约会有兴趣。

然后，您可以创建一个二维数组，该数组在一个维度上是逻辑上可预订的资源，在另一个维度上是日期，每个单元格都有一个（潜在的）预订列表——这将允许您在没有服务器轮次的情况下按天钻取详细信息-旅行也...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-19T15:08:12.637

我决定使用[http://www.daypilot.org/scheduler-lite.html](http://www.daypilot.org/scheduler-lite.html)。

# .net - 跟踪过滤

> ID：1013174
> 
> 赞同：0
> 
> 时间：2009-06-18T14:58:33.710
> 
> 标签：.net, debugging, trace

如何在内置跟踪侦听器（例如`System.Diagnostics.DefaultTraceListener`和）上使用过滤`System.Diagnostics.TextWriterTraceListener`？

我不想重写 write 方法并显式检查过滤，但是我找不到将级别附加到跟踪信息的方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-18T19:31:33.717

您可以使用跟踪开关进行一些过滤。在您的配置文件中添加一个跟踪开关，然后将级别设置为 0、1、2、3 或 4（分别表示关闭、错误、警告、信息、详细）。然后，您将使用 WriteLineIf(traceSwitch.Error, ....) 仅在跟踪开关配置为错误时打印，如果跟踪开关设置为错误或警告，则使用 WriteLineIF(traceSwitch.Warning, ...) 打印， ETC...

# lemmatization - 如何使用 Morpha Lemmatizer？

> ID：1013190
> 
> 赞同：2
> 
> 时间：2009-06-18T15:01:43.593
> 
> 标签：lemmatization

我打算使用 WordNet 的 SQL 版本，但我在寻找一种方法来对词进行词形还原以便在数据库中找到它们时遇到了问题；我不能使用 WordNet lemmatizer 本身，因为它适用于 WorldNet 的文本版本。

我在这里读到有一个很好的词形还原器可以返回真实的单词——这正是我所需要的。我下载了建议的词形还原器“Morpha”，但我不明白如何使用它。

*   是否需要任何编译？
*   我应该使用哪个文件？
*   如何在访问 WordNet SQL DB 的应用程序中使用它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-23T17:47:51.387

UW 已将[morpha stemmer 上传到 Maven central](http://mvnrepository.com/artifact/edu.washington.cs.knowitall/morpha-stemmer)。有一个包装器使它更易于使用。您只需将其添加为依赖项并使用`edu.washington.cs.knowitall.morpha.MorphaStemmer`该类。实例是线程安全的（原来的 JFlex 有不必要的局部变量的类字段）。实例化一个类并运行`morpha`你想要阻止的单词。

```
new MorphaStemmer().morpha("climbed") // goes to "climb" 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-08-22T11:07:19.947

您可能还想查看 TTT2，这是一个 NLP 管道，可以单独或单独进行标记、词形还原等。易于使用且有据可查： [http ://www.ltg.ed.ac.uk/software/lt-ttt2](http://www.ltg.ed.ac.uk/software/lt-ttt2)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-07-27T14:34:56.260

[Minnen et al's paper on Morpha](http://www.informatics.susx.ac.uk/research/groups/nlp/carroll/papers/minnen.pdf) might be a good place to start to understand how the lemmatizer works. It's been a while since I'd had any experience with it myself, but I'm pretty sure it works just as an off-the-shelf binary.

Depending on performance, you may need to POS-tag your terms beforehand, but that's about the same issue you'll have querying WordNet, so it's starting to sound like you'll need to climb that hill either way.

You would basically use the root form when querying the Wordnet DB, but if you're using it just for that, I'd urge you to try the Morphy stemmer, which was specifically designed for Wordnet, and will reliably match to the root forms listed therein.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-01-22T11:36:23.893

您现在一定已经找到了答案，但对于任何可能偶然发现这篇关于 Morpha 的帖子的人来说：

您可以直接从以下网址下载 Morpha：http: [//www.informatics.susx.ac.uk/research/groups/nlp/carroll/morph.html](http://www.informatics.susx.ac.uk/research/groups/nlp/carroll/morph.html)

但这需要先安装 flex，解压并编译（我使用的是下面的 Linux 终端命令行）：

```
tar -xzf flex-for-morph.tar.gz 
```

然后将当前工作目录更改为 flex 并使其：

```
./configure
make 
```

如果 make 命令给出以下错误：

制作：yacc：找不到命令 Makefile：105：目标“parse.c”的配方失败制作：*** [parse.c] 错误 127

这意味着它无法获取yacc；所以你需要通过命令行安装野牛：

```
sudo apt-get install bison 
```

现在再次运行 make 命令，它应该在最后一行给你类似的东西：

```
gcc -g -O -o flex  ccl.o dfa.o ecs.o gen.o main.o misc.o nfa.o parse.o scan.o skel.o sym.o tblcmp.o yylex.o  libfl.a 
```

现在你可以编译 Morpha（你从上面的链接下载的）：

```
../flex-2.5.4/flex -i -Cfe -8 -omorpha.yy.c morpha.lex
gcc -o morpha morpha.yy.c 
```

Morpha 将已经带有 POS 标记的文件作为输入。要对单个文件进行 lemmatise，请使用：

```
./morpha -t  < ~/path to your file/yourfile.tag 
```

上面的 -t 选项还打印 POS 标签以及词形还原形式；使用区分大小写的选项使用 -c 和两个选项一起使用 -ct

希望能帮助到你！

# nhibernate - 我将如何在 nHibernate 中映射它？

> ID：1013196
> 
> 赞同：0
> 
> 时间：2009-06-18T15:02:19.553
> 
> 标签：nhibernate, fluent-nhibernate, nhibernate-mapping

试图将我的头包裹在 nHibernate 周围，很好奇如何处理这个场景：

```
Post (postID, title, content, dateCreated)
Category (categoryID, name, postCount)

post_to_categories (postID, categoryID) 
```

如果我创建一个`Post`，它应该插入到`Post`，插入`post_to_categories`并更新`postCount`in `Category`。

我`iRepository`也计划使用该模式。

这将如何使用 nHibernate 完成？（映射文件示例？）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-18T15:14:12.587

这其中的“硬”部分似乎是更新类别表中的帖子计数......但为什么要更新它呢？您可以像这样定义值（在映射文件中`Category`）：

```
<property name="PostCount" formula="select count(*) from Posts p where p.Id = Id" /> 
```

如果您的帖子类别是多对多的，则应该可以扩展上述内容以支持它。

# security - 使用 content-dispositon HTTP 标头有哪些安全注意事项？

> ID：1013200
> 
> 赞同：2
> 
> 时间：2009-06-18T15:03:17.240
> 
> 标签：security, http, http-headers, content-disposition

对此[，](https://stackoverflow.com/questions/1012437/uses-of-content-disposition-in-an-http-response-header/1012461#1012461)使用 content-disposition HTTP 标头时有哪些安全注意事项？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-18T15:07:33.567

呃...它们在[RFC 2183中进行了说明，链接到](http://www.ietf.org/rfc/rfc2183.txt)*您*链接到的答案！

> 5.  安全注意事项
>     
>     
>     
>     任何时候用户交换数据都会涉及安全问题。虽然这些不应被最小化，但这份备忘录也不会改变这方面的现状，除非有一个例子。
>     
>     
>     
>     由于此备忘录为发送者提供了一种建议文件名的方式，因此接收 MUA 必须注意发送者建议的文件名不代表危险。以 UNIX 为例，一些危险将是：
>     
>     
>     *   创建启动文件（例如，“.login”）。
>         
>         
>     *   创建或覆盖系统文件（例如，“/etc/passwd”）。
>         
>         
>     *   覆盖任何现有文件。
>         
>         
>     *   将可执行文件放入任何命令搜索路径（例如，“~/bin/more”）。
>         
>         
>     *   将文件发送到管道（例如，“| sh”）。
>         
>         
>     
>     通常，接收 MUA 不应该命名或放置文件，以便在没有用户明确启动操作的情况下解释或执行文件。
>     
>     
>     
>     需要注意的是，这不是一份详尽的清单。它仅用作一小部分示例。实施者必须警惕其目标系统的潜在危险。

# c# - 如何确保我的 LINQ 查询在 DAL 中调用时执行，而不是以延迟方式执行？

> ID：1013201
> 
> 赞同：8
> 
> 时间：2009-06-18T15:03:22.687
> 
> 标签：c#, linq, linq-to-sql, delayed-execution

我有一个 DAL，它由一堆在我的数据库上执行 LINQ 查询的方法组成。

如何确保在从数据库返回 IEnumberable 或类似内容之前，我确保 LINQ 查询执行*then*，而不是以某种延迟方式仅在使用结果时执行？

我知道我可以在我的方法中对我的结果调用 .ToList() 来强制它执行，但这是最好的方法吗？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-06-18T15:07:01.460

调用[`ToList`](http://msdn.microsoft.com/en-us/library/bb342261.aspx)or [`ToArray`](http://msdn.microsoft.com/en-us/library/bb298736.aspx)really 是强制它执行并获取整个序列的最佳方法（请参阅下面 Randolpho 的评论，了解将强制执行序列的单个元素的其他方法）。

您是否有特定的理由要避免延期执行？

# c# - Active Directory 密码错误尝试重复计算

> ID：1013202
> 
> 赞同：2
> 
> 时间：2009-06-18T15:03:48.037
> 
> 标签：c#, active-directory

我正在使用以下 C# 代码连接到活动目录并验证登录，

```
 DirectoryEntry de = new DirectoryEntry(); 
    string username = "myuser", path = "LDAP://addev2.dev.mycompany.com/CN=myuser,DC=dev,DC=mycompany,DC=com", password = "test";
    for (int i = 0; i < 4;i++ )
    {

        try
        {

            de.AuthenticationType = AuthenticationTypes.Sealing | AuthenticationTypes.Secure | AuthenticationTypes.FastBind;
            de.Username = username;
            de.Password = password;

            de.Path = path;

      //de.RefreshCache();
            Object obj = de.NativeObject;
        }
        catch (Exception ex)
        {
            Console.WriteLine(ex.Message);
        } 
```

当密码正确时，这可以正常工作。但是，当密码不正确时，这将在 AD 中显示为 2 次无效尝试。因此，当 AD 管理员允许 5 次无效尝试时，用户会在第 3 次尝试时被锁定。当我查看 AD 的事件日志 1 时，看到 2 个条目。

1）预认证失败：

2）登录尝试：

```
MICROSOFT_AUTHENTICATION_PACKAGE_V1_0
     Logon account: m0707b@dev.mycompany.com
     Source Workstation: WKSXXXX
     Error Code:    0xC000006A 
```

单步执行代码，我在该行看到 2 个事件条目

```
 de.RefreshCache() 
```

我尝试使用 de.NativeObject 来查看是否可以解决问题。没有骰子

有人有任何指示吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2010-05-21T13:49:53.167

终于找到了这个令人困惑的问题的答案，当您使用格式 username@domain 时，IIS 应用程序使用 Kerebros 使用 2 次调用，而当使用 NTLM 失败导致重复计数时，解决方法是使用以下格式进行身份验证域\用户名，并且解决了这个问题。 [http://support.microsoft.com/kb/264678/EN-US/](http://support.microsoft.com/kb/264678/EN-US/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-18T15:19:14.683

您可以查看 System.DirectoryServices.AccountManagement 命名空间。您可以访问一个帐户，然后将其具有的一种方法转换为 DirectoryEntry 对象。它可能会解决您的双重身份验证问题，并且更易于使用。

# wpf - 如何告诉我的 ViewModel 用户正在更改 TextBox 中的文本？

> ID：1013208
> 
> 赞同：3
> 
> 时间：2009-06-18T15:04:19.203
> 
> 标签：wpf, mvvm, binding

因此，假设我有一个**MVVM**应用程序，我希望用户填写一个**TextBox**，**在他填写**的同时，我想检查他是否已经输入了客户的**姓氏**。

以下是我如何让我的 ViewModel 知道用户何时**更改了 ComboBox 中的项目**：

```
<ComboBox 
    ItemsSource="{Binding Customers}"
    ItemTemplate="{StaticResource CustomerComboBoxTemplate}"
    Margin="20"
    HorizontalAlignment="Left"
    SelectedItem="{Binding SelectedCustomer, Mode=TwoWay}"/> 
```

以下是我如何让我的 ViewModel 知道用户何时**移动了 Slider**：

```
<Slider Minimum="0" 
        Margin="10"
        Width="400"
        IsSnapToTickEnabled="True"
        Maximum="{Binding HighestCustomerIndex, Mode=TwoWay}" 
        Value="{Binding SelectedCustomerIndex, Mode=TwoWay}"/> 
```

下面是我如何让我的 ViewModel 知道用户何时**更改了 TextBox 中的文本并将焦点从 TextBox 移开**：

```
<TextBox
    Width="200"
    Text="{Binding TypedCustomerName}"/> 
```

但是我如何让我的 ViewModel 知道用户在输入时**更改了 TextBox 中的文本**，例如：

**PSEUDO-CODE（由于 TextChanged 是一个事件而导致错误）：**

```
<TextBox
    Width="200"
    TextChanged="{Binding CurrentTextInTextBox}"/> 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-06-18T15:35:20.233

如果您愿意，您可以将其设置为在输入时更新，而不是仅在 TextBox 失去焦点时更新 ViewModel。TextBox 的 Text 绑定属性上的[UpdateSourceTrigger](http://msdn.microsoft.com/en-us/library/system.windows.data.binding.updatesourcetrigger.aspx)默认设置为 LostFocus 而不是像大多数其他控件一样的 PropertyChanged，但是您可以在绑定中显式设置它。通过这样做，VM 或 M 中的 TypedCustomerName 属性将随着 UI 中的更改而更新。

```
<TextBox
Width="200"
Text="{Binding TypedCustomerName, UpdateSourceTrigger=PropertyChanged}"/> 
```

如果这不是您要查找的内容，您还可以使用[AttachedCommandBehaviors](http://marlongrech.wordpress.com/2008/12/13/attachedcommandbehavior-v2-aka-acb/)将 TextChanged 路由事件绑定到视图模型中存在的 ICommand。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-18T15:33:57.337

TextBoxex 默认是在 LostFocus 上更新。将 UpdateSourceTrigger="PropertyChanged" 设置为在用户键入时更新。

# database - 如何在主/从关系中插入记录

> ID：1013213
> 
> 赞同：2
> 
> 时间：2009-06-18T15:05:27.330
> 
> 标签：database, delphi, master-detail

我有两张桌子：

输出包（主）

```
|PackageID| 
```

输出项目（详细）

```
|ItemID|PackageID| 
```

OutputItems 在 PackageID 列上设置了一个名为“idxPackage”的索引。ItemID 设置为自动递增。

这是我用来将主数据/详细信息插入这些表的代码：

```
//fill packages table
for i := 1 to 10 do
begin
  Package := TfPackage(dlgSummary.fcPackageForms.Forms[i]);

if Package.PackageLoaded then
begin
  with tblOutputPackages do
  begin
    Insert;
    FieldByName('PackageID').AsInteger := Package.ourNum;
    FieldByName('Description').AsString := Package.Title;
    FieldByName('Total').AsCurrency := Package.Total;
    Post;
  end;

  //fill items table
  for ii := 1 to 10 do
  begin
    Item := TfPackagedItemEdit(Package.fc.Forms[ii]);
    if Item.Activated then
    begin
      with tblOutputItems do
      begin
        Append;
        FieldByName('PackageID').AsInteger := Package.ourNum;
        FieldByName('Description').AsString := Item.Description;
        FieldByName('Comment').AsString := Item.Comment;
        FieldByName('Price').AsCurrency := Item.Price;
        Post; //this causes the primary key exception
      end;
    end;
  end;
end; 
```

只要我不弄乱 IDE 中的 MasterSource/MasterFields 属性，它就可以正常工作。但是一旦我设置它并运行此代码，我就会收到一个错误，提示我有一个重复的主键“ItemID”。

我不确定发生了什么 - 这是我第一次涉足主/细节，所以可能设置错误。我正在为这个项目使用 ComponentAce 的绝对数据库。

我怎样才能让它正确插入？

**更新**

好的，我删除了我的数据库中的主键限制，我看到由于某种原因，OutputItems 表的自动增量功能没有像我预期的那样工作。以下是运行上述代码后 OutputItems 表的外观：

```
ItemID|PackageID|
1     |1        |
1     |1        |
2     |2        |
2     |2        | 
```

我仍然不明白为什么所有 ItemID 值都不是唯一的......有什么想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-18T21:24:02.507

在 items 表上使用 insert 而不是 append 的行为有什么不同吗？我的猜测是细节上的附加“看到”一个空数据集，因此自动增量逻辑从一个开始，下一个记录二等，即使这些值已经被分配......只是到不同的主记录.

我过去使用的一个解决方案是创建一个名为 UniqueNums 的新表，它保存了我将要使用的下一个可用记录 ID 号。当我使用一个数字时，我会锁定该表，增加值并将其写回然后解锁并使用。这可能会帮助您解决您遇到的特定问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-21T13:23:48.807

首先，在我看来，自动增量和通过代码设置 ID 的想法是冲突的。明确的路径是在代码中自己生成密钥。特别是对于需要插入主/详细信息的多用户应用程序，很难为详细信息插入正确的密钥。

所以通过代码生成一个ID。设计表格时，将 ID 字段设置为主键但不自动递增。如果我没记错的话 Append 用于操作。

此外，您似乎在启用视觉控件时进行迭代？（项目。激活）。但操作本质上是一个批处理过程。对于 GUI 性能，您应该考虑禁用已连接的数据库控件，然后执行操作。在主/详细范围内，这可能是其他两个游标未按预期迭代的问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-05-16T07:14:34.613

您是否尝试过用 Edit 替换 Append/Insert？
并跳过“FieldByName('PackageID').AsInteger := Package.ourNum;” 线。

我认为 M/D 关系会根据需要自动追加明细记录，并设置明细表的主键。

这也可能是重复主键错误的原因。当您尝试追加/插入另一个记录时，该记录已由 M/D 关系创建。

# c# - 对datagridview中的行子集进行排序

> ID：1013215
> 
> 赞同：0
> 
> 时间：2009-06-18T15:05:49.810
> 
> 标签：c#, datagridview, sorting

我正在尝试在 c# 中将一个可以处理分层数据（目前只有 2 个级别）的 datagridview 组合在一起，因为我找不到一个可以正常工作并且看起来完全符合我需要的第 3 方控件。

我已经设法让展开/折叠和全局排序工作（按顶级组排序，然后在每个组内排序），但我想添加一个功能，您可以在顶级组内进行排序。所以想象一个两列的例子，例如

```
 column1     | column2
    group 1     |  6
      group 1 a |  1
      group 1 b |  2
      group 1 c |  3
    group 2     |  15
      group 2 a |  4
      group 2 b |  5
      group 2 c |  6 
```

我希望用户能够双击“15”单元格，并让它只对“group 2 X”行进行排序，而所有其他行都保持在原位。每个单元格的标签告诉它它的父级是什么，所以我知道给定的行对是否属于同一个子组。虽然我不太明白其中的逻辑。我尝试为不在同一组中的任何一对行设置 SortResult = 0，但我仍然必须处理一行在子组中而另一行不在子组中的情况。有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-18T15:11:13.513

您可以将数据网格放在列内。我认为这将实现您的目标

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-18T15:33:40.847

想通了 - 我有一个 && 条件，我应该有一个 ||... 基本上，如果要比较的一对行中的任何一个不在同一个子组中，只需设置 SortResult 以反映之前显示的是哪一个另一个，确保根据升序或降序翻转结果。如果两行都在同一个子组中，则照常排序。现在清理我凌乱的代码:)

# asp.net - 在浏览器中嵌入来自服务器的 PDF

> ID：1013218
> 
> 赞同：0
> 
> 时间：2009-06-18T15:06:24.443
> 
> 标签：asp.net, browser

我有一个 ASP.NET Web 应用程序。我的服务器中有一些 PDF 文件。我想通过浏览器在新窗口中向用户显示这些文件。如何在浏览器中嵌入 PDF？我希望用户可以使用保存选项来保存 PDF。如何继续

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-18T15:14:35.173

看一眼

[http://pdfobject.com/](http://pdfobject.com/)

```
<html> 
<head> 
<script type="text/javascript" src="/scripts/pdfobject.js"></script> 
<script type="text/javascript"> 

window.onload = function (){

var success = new PDFObject({ url: "/pdf/sample.pdf" }).embed("pdf");

};

</script> 
</head> 

    <body> 

    <div id="pdf">It appears you don't have Adobe Reader 
    or PDF support in this web browser.
    <a href="/pdf/sample.pdf">Click here to download the PDF</a></div> 

    </body> 

</html> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-08-07T09:58:46.553

我遇到了同样的问题，来自 Adob​​e 的一个人有一篇关于它的（旧）博客文章[链接文本](http://blogs.adobe.com/pdfdevjunkie/2007/08/using_the_html_embed_tag_to_di.html)

它适用于带有默认 Adob​​e Reader 插件的 IE、FF、Chrome。

现在我剩下的唯一问题是在插件检索动态生成的 PDF 文件时显示一个很好的加载内容。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-18T15:24:14.983

在浏览器中打开的 PDF 文件[可能会受到 XSS](http://shiflett.org/blog/2007/jan/adobe-pdf-xss-vulnerability)的影响，因此通常最好配置服务器，以便当用户请求 PDF 时，它会在其本机应用程序（例如 Adob​​e Reader）中打开。

要配置 IIS，请打开 IIS 管理器并：

1.  右键单击站点上保存 PDF 文件的文件夹，然后选择“属性”
2.  转到 HTTP 标头选项卡
3.  单击 MIME 映射部分下的“文件类型”按钮
4.  点击“新类型”
5.  添加“.pdf”作为扩展名和“appliction/octet-stream”作为内容类型
6.  单击确定并应用更改

现在，当用户单击指向 PDF 的链接时，应使用您所追求的“打开或保存”对话框提示他们。

# c# - 什么是适合 Web 服务的 XML 类型？

> ID：1013219
> 
> 赞同：2
> 
> 时间：2009-06-18T15:06:25.270
> 
> 标签：c#, xml, wcf, xmldocument, xelement

**当前实施**

Sql Server 2005 数据库带有一个名为 messages 的表和一个名为 MessageXml 的 xml 类型的列。

具有 Linq to Sql 类的 C# 库项目，该类生成一个名为 Message 的类，其中包含一个名为 MessageXml 的 XElement 类型的字段。

WCF Web 服务公开一个 MessagePayload 类，该类具有一个名为 MessageXml 的 XElement 类型的属性。

该网络服务不提供我由 Linq to Sql 创建的 Message 类。我使用一个轻量级的物体作为中间人。

**问题**

XElement 真的是我想在 WCF 服务中使用的类型，还是有更好的类型。打算传递给服务的 xml 应该是一个完整的文档。此外，我在将 xml 文档作为 XElement 加载时遇到了一些麻烦。我认为我应该在服务的轻量级类中公开一个完整的 xml 文档类型，但我对 XDocument 和 XmlDocument 之间的区别有点困惑。

最重要的是，我无法使用 XDocument 类型的属性公开 WCF Message 类，因为它包含无法序列化的 XDeclaration 类型的属性。

如果我使用 XmlDocument，那么我必须在 Linq 类和轻量级类之间的翻译中对 xml 类型进行这种奇怪的转换。

```
 XmlDocument doc = new XmlDocument();
 doc.LoadXml(message.MessageXml.ToString());

 MessageEnvelope retVal = new MessageEnvelope()
 {
      MessageXml = doc,
 }; 
```

XmlDocument 似乎是正确的，我知道我必须做一些翻译，但希望尽可能接近合适。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-07-27T03:27:07.927

您可以使用 XElement 或 XmlElement：

```
public XmlElement GetXmlElement()
{
    var doc = new XmlDocument();
    doc.Load(PREFIX + @"Enumerations.wsdl");

    return doc.DocumentElement;
}

public XElement GetXElement()
{
    var doc = XDocument.Load(PREFIX + @"Enumerations.wsdl");
    return doc.Root;
} 
```

你既不想要`XDocument`也不想要`XmlDocument`。请记住，您返回的任何内容都将位于包含 SOAP 信封的 XML 文档的中间。您不能在文档中包含文档，因此您想要的是一个元素。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-12-10T00:19:26.720

约翰桑德斯在这里赚钱。稍微详细说明一下，如果您查看在返回 an`XmlElement`或 an时生成的 WSDL `XElement`，您会看到如下内容：

```
<xs:complexType>
  <xs:sequence>
    <xs:any minOccurs="0" processContents="lax"/>
  </xs:sequence>
</xs:complexType> 
```

就是这样。这基本上意味着任何 XML 都可以放在这里。这也意味着，与 Chansik 的建议相反，它不会将返回类型绑定到 .NET 特定类型。

所以是的，你不需要使用字符串。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-06-18T15:17:11.333

使用您需要的任何类型来序列化类（字符串对我来说一直很有效），然后在需要时在服务器或客户端进行转换以保持文档的完整性。你也可以用一个或多个 XElement 构建一个 XDocument，所以我会选择 XElement。

最坏的情况，你甚至可以覆盖你的类的序列化行为（如果你擅长反射，那就不太糟糕了）。

XmlDocument 是旧的非 Linq 文档。它们是在不同类中实现的相同概念。

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2009-07-27T03:55:00.260

一般来说，并且`XDocument`在性能方面`XElememnt`更可取。`XmlDocument``XmlElement`

但是，我建议使用`string`通过 WCF 服务发送 XML 文档，原因如下：

1.  **互操作性**
    *   客户端不依赖于特定的 .NET 框架版本（客户端可以选择使用`XDocument`或`XmlDocument`。即使是基于 Java 的客户端也可以支持，只要 WCF 服务以这种方式配置即可）。
2.  如果原始 XML 文档包含 Xml 声明，则正确处理它。

注意：请确保适当调整配置以支持大型 xml 文档。例如，`basicHttpBinding`的默认最大消息大小为 64KB。

# zend-framework - 在 Zend 框架中，我应该将自定义验证器放在哪里？

> ID：1013233
> 
> 赞同：3
> 
> 时间：2009-06-18T15:09:54.903
> 
> 标签：zend-framework

我把类放在
application\validate\PasswordConfirmation.php 下

它不起作用。

未找到错误
类“Default_Validate_PasswordConfirmation”

仍然发生。

以前有人有这个问题吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-18T15:15:04.817

我通常把它们放在`/library/CV/Validate/`

例子：

```
/library/CV/Validate/EmpresaNueva.php:
class CV_Validate_EmpresaNueva extends Zend_Validate_Abstract {
    //Validator code
} 
```

图书馆是您拥有 Zend 的地方。

index.php@/public 的内容：

```
$root = dirname(dirname(__FILE__));

set_include_path($root.'/application' . PATH_SEPARATOR
    .$root.'/library' . PATH_SEPARATOR
    . get_include_path()
); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-18T16:09:19.543

对于客户验证器，您需要将它们放在包含路径上的位置。此外，您需要添加您的验证器以使用`Zend_Validate::addValidator()`.

有关更多信息，请参阅[文档](http://framework.zend.com/manual/en/zend.validate.writing_validators.html)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-01-08T16:39:36.213

让我回答我自己的问题：

I add the validator successfully according to this post: [Where should My_Validate_PasswordConfirmation put in Zend framework?](https://stackoverflow.com/questions/1010265/where-should-myvalidatepasswordconfirmation-put-in-zend-framework)

# sharepoint - WSS 3.0 多域

> ID：1013236
> 
> 赞同：1
> 
> 时间：2009-06-18T15:10:11.220
> 
> 标签：sharepoint, wss-3.0, sitecollection

我们一直在为我们的 Intranet 运行 WSS 3.0。我们将把我们的网站迁移到 WSS 3.0。绝大多数人将匿名访问新的互联网站点。我的问题是关于需要进行身份验证以便他们可以从 Internet 访问 Intranet 材料的少数人。

我们将在同一台服务器上托管 Intranet 和 Internet 站点。已经为我们的 Intranet 安装、更新和配置了 WSS 3.0。什么是设置 Internet 站点集合以便可以匿名访问它并且当用户进行身份验证时他们也可以访问 Intranet 内容的最佳方法是什么？目前访问 Intranet 的唯一方法是在公司域上使用有权访问它的凭据。如果可能的话，我们想做的是使用 WSS 中内置的登录表单来提供对 Intranet 内容的访问，而不是设置子域。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-19T20:52:31.263

您可以使用本文所述的 SharePoint 替代映射功能。

[在 Windows SharePoint Services 3.0 中使用备用访问映射配置多个身份验证机制](http://msdn.microsoft.com/en-us/library/cc441429.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-23T09:21:53.497

您还可以为您的 Intranet 使用创建一个 Web 应用程序，以便域中的用户通过经过身份验证的内部 URL 获得访问权限，然后将该 Web 应用程序扩展为用于匿名用户的 Extranet 应用程序......

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-24T15:36:36.260

我假设您的 Internet 网站集和 Intranet 网站集与我将要编写的网站集不是同一个网站集。但是，我假设它们位于同一个 Web 应用程序中。如果是这种情况（并且我对细节了解足够多），那么您将如何执行您正在尝试做的事情：

1.  建立一个 Web 应用程序来存放您的网站集。您已经处理了这一点（因为您在内部可以使用您的网站集）。在设置 Web 应用程序时，它（默认情况下）通过默认区域映射在 URL（或服务器：端口）上公开。出于我们的目的，我们假设这是您想要在内部（在您的 Intranet 上）访问该站点的 URL。

2.  为了通过 Internet 公开您的网站集，您需要扩展容纳它们的 Web 应用程序。这是通过中央管理 > 应用程序管理 > 创建或扩展 Web 应用程序来完成的。在扩展 Web 应用程序时，您正在创建另一个具有（理想情况下）可公开访问的 URL 的 IIS 站点，该 URL 可以暴露给 Internet。作为该过程的一部分，您将被要求选择一个区域；鉴于您的需求，我会选择“互联网”。

3.  此时，Internet 区域（您刚刚扩展）仍设置为使用 Windows 身份验证和 Active Directory 作为其成员资格提供程序。尽管您可能希望将 AD 保留为会员提供商（根据您所说的），但您可能希望查看在您的 Internet 区域中启用基于表单的身份验证 (FBA)。微软在这里有一个视频：[http](http://technet.microsoft.com/en-us/windowsserver/sharepoint/dd355701.aspx) ://technet.microsoft.com/en-us/windowsserver/sharepoint/dd355701.aspx 。注意：如果您打算继续使用 Active Directory 帐户，您将不想使用 SQL 成员资格提供程序。相反，您必须为 FBA 连接 Active Directory Membership Provider。一些信息可以在这里找到：http: [//blogs.msdn.com/solutions/archive/2007/08/27/forms-based-authentication-fba-in-wss-3-0-moss-2007。](http://blogs.msdn.com/solutions/archive/2007/08/27/forms-based-authentication-fba-in-wss-3-0-moss-2007.aspx)

4.  此时，您的默认区域站点应使用 NTLM 和 Intranet 可用的 URL。您的 Internet 区域站点应使用 FBA 并具有 Internet 可用的 URL。您需要在 Internet 区域的公共网站集上启用匿名访问。这是通过中央管理更改和网站集本身的更改（[http://www.mindsharpblogs.com/ben/archive/2007/02/11/1557.aspx](http://www.mindsharpblogs.com/ben/archive/2007/02/11/1557.aspx)）的组合来完成的。重要一点：进入网站集启用匿名访问时，一定要通过*Internet* URL；不要通过默认区域（即 Intranet 区域）。

有了所有这些东西，并且您的网站集（或者更具体地说，服务于 Internet 区域 Web 应用程序的 IIS 网站）连接到外部世界，您应该可以开始了。

我在写这篇文章时做了一些假设，所以你可能（显然）需要调整。设置匿名访问并不太难，但有很多步骤。如果您在此过程中遇到问题，请不要害怕寻找答案。许多人已经成功地做到了……但通常情况下，在此过程中会遇到挑战。

祝你好运！

# javascript - 我可以在 JavaScript 中获取当前正在运行的函数的名称吗？

> ID：1013239
> 
> 赞同：214
> 
> 时间：2009-06-18T15:10:34.043
> 
> 标签：javascript, jquery, dojo-1.6

是否有可能做到这一点：

```
myfile.js:
function foo() {
    alert(<my-function-name>);
    // pops-up "foo"
    // or even better: "myfile.js : foo"
} 
```

我的堆栈中有 Dojo 和 jQuery 框架，所以如果其中任何一个更容易，它们都是可用的。

* * *

## 回答 #1

> 赞同：213
> 
> 时间：2009-06-18T15:15:52.350

在 ES5 及更高版本中，无法访问该信息。

在旧版本的 JS 中，您可以使用`arguments.callee`.

不过，您可能必须解析名称，因为它可能包含一些额外的垃圾。不过，在某些实现中，您可以简单地使用`arguments.callee.name`.

解析：

```
function DisplayMyName() 
{
   var myName = arguments.callee.toString();
   myName = myName.substr('function '.length);
   myName = myName.substr(0, myName.indexOf('('));

   alert(myName);
} 
```

> 来源：[Javascript - 获取当前函数名称](http://www.tek-tips.com/viewthread.cfm?qid=1209619)。

* * *

## 回答 #2

> 赞同：87
> 
> 时间：2009-06-18T15:19:31.797

对于非匿名函数

```
function foo()
{ 
    alert(arguments.callee.name)
} 
```

但是在错误处理程序的情况下，结果将是错误处理程序函数的名称，不是吗？

* * *

## 回答 #3

> 赞同：71
> 
> 时间：2018-02-04T23:10:59.433

您所需要的一切都很简单。创建函数：

```
function getFuncName() {
   return getFuncName.caller.name
} 
```

之后，只要您需要，您只需使用：

```
function foo() { 
  console.log(getFuncName())
}

foo() 
// Logs: "foo" 
```

* * *

## 回答 #4

> 赞同：36
> 
> 时间：2016-01-23T16:33:14.280

根据[MDN](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Functions/arguments/callee)

> **警告：** ECMAScript (ES5) 第 5 版禁止在严格模式下使用 arguments.callee()。避免使用 arguments.callee()，方法是给函数表达式命名或在函数必须调用自身的地方使用函数声明。

如前所述，这仅适用于**您**的脚本使用“严格模式”的情况。这主要是出于安全原因，遗憾的是目前没有其他选择。

* * *

## 回答 #5

> 赞同：22
> 
> 时间：2016-09-05T21:09:47.010

下面`getMyName`片段中的函数返回调用函数的名称。这是一个 hack，依赖于[非标准](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Error/Stack)功能：`Error.prototype.stack`. 请注意，返回的字符串格式`Error.prototype.stack`在不同的引擎中实现不同，因此这可能不适用于所有地方：

```
function getMyName() {
  var e = new Error('dummy');
  var stack = e.stack
                .split('\n')[2]
                // " at functionName ( ..." => "functionName"
                .replace(/^\s+at\s+(.+?)\s.+/g, '$1' );
                return stack
}

function foo(){
  return getMyName()
}

function bar() {
  return foo()
}

console.log(bar())
```

关于其他解决方案：`arguments.callee` [在严格模式下是不允许的](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Functions/arguments/callee)，`Function.prototype.caller`是[非标准的，在严格模式下是不允许的](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Function/caller)。

* * *

## 回答 #6

> 赞同：21
> 
> 时间：2009-06-18T15:20:23.447

这应该这样做：

```
var fn = arguments.callee.toString().match(/function\s+([^\s\(]+)/);
alert(fn[1]); 
```

对于调用者，只需使用`caller.toString()`.

* * *

## 回答 #7

> 赞同：14
> 
> 时间：2017-01-12T19:34:04.800

这是一种可行的方法：

```
export function getFunctionCallerName (){
  // gets the text between whitespace for second part of stacktrace
  return (new Error()).stack.match(/at (\S+)/g)[1].slice(3);
} 
```

然后在你的测试中：

```
import { expect } from 'chai';
import { getFunctionCallerName } from '../../../lib/util/functions';

describe('Testing caller name', () => {

    it('should return the name of the function', () => {
      function getThisName(){
        return getFunctionCallerName();
      }

      const functionName = getThisName();

      expect(functionName).to.equal('getThisName');
    });

  it('should work with an anonymous function', () => {

    const anonymousFn = function (){
      return getFunctionCallerName();
    };

    const functionName = anonymousFn();

    expect(functionName).to.equal('anonymousFn');
  });

  it('should work with an anonymous function', () => {
    const fnName = (function (){
      return getFunctionCallerName();
    })();

    expect(/\/util\/functions\.js/.test(fnName)).to.eql(true);
  });

}); 
```

请注意，第三个测试仅在测试位于 /util/functions 时才有效

* * *

## 回答 #8

> 赞同：11
> 
> 时间：2009-06-18T15:29:47.797

这必须归类为“世界上最丑陋的黑客”，但你去吧。

首先，打印*当前*函数的名称（如其他答案）似乎对我来说用途有限，因为您已经知道该函数是什么！

但是，找出*调用*函数的名称对于跟踪函数可能非常有用。这是使用正则表达式，但使用 indexOf 会快 3 倍：

```
function getFunctionName() {
    var re = /function (.*?)\(/
    var s = getFunctionName.caller.toString();
    var m = re.exec( s )
    return m[1];
}

function me() {
    console.log( getFunctionName() );
}

me(); 
```

* * *

## 回答 #9

> 赞同：5
> 
> 时间：2019-11-09T00:10:40.707

自从提出这个问题以来，当前函数的名称及其获取方式似乎在过去 10 年中发生了变化。

现在，不是一个了解所有浏览器的所有历史的专业网络开发人员，以下是它在 2019 年 chrome 浏览器中的工作方式：

```
function callerName() {
    return callerName.caller.name;
}
function foo() {
    let myname = callerName();
    // do something with it...
} 
```

其他一些答案遇到了一些关于严格的 javascript 代码和诸如此类的 chrome 错误。

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2010-06-11T03:27:01.307

另一个用例可能是在运行时绑定的事件调度程序：

```
MyClass = function () {
  this.events = {};

  // Fire up an event (most probably from inside an instance method)
  this.OnFirstRun();

  // Fire up other event (most probably from inside an instance method)
  this.OnLastRun();

}

MyClass.prototype.dispatchEvents = function () {
  var EventStack=this.events[GetFunctionName()], i=EventStack.length-1;

  do EventStack[i]();
  while (i--);
}

MyClass.prototype.setEvent = function (event, callback) {
  this.events[event] = [];
  this.events[event].push(callback);
  this["On"+event] = this.dispatchEvents;
}

MyObject = new MyClass();
MyObject.setEvent ("FirstRun", somecallback);
MyObject.setEvent ("FirstRun", someothercallback);
MyObject.setEvent ("LastRun", yetanothercallback); 
```

这里的优点是调度程序可以轻松重用，并且不必接收调度队列作为参数，而是隐含调用名称......

最后，这里介绍的一般情况是“使用函数名称作为参数，因此您不必显式传递它”，这在许多情况下可能很有用，例如 jquery animate() 可选回调，或在超时/间隔回调中，（即您只传递一个函数名称）。

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2018-06-22T13:59:01.060

```
(function f() {
    console.log(f.name);  //logs f
})(); 
```

打字稿变体：

```
function f1() {} 
function f2(f:Function) {
   console.log(f.name);
}

f2(f1);  //Logs f1 
```

注意仅在 ES6/ES2015 兼容引擎中可用。 [更多见](https://stackoverflow.com/questions/50989721/currently-running-javascript-function-name/50994045#50994045)

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2009-06-18T15:14:00.793

既然您已经编写了一个名为的函数`foo`并且您知道它在`myfile.js`为什么需要动态获取此信息？

话虽如此，您可以`arguments.callee.toString()`在函数内部使用（这是整个函数的字符串表示形式）并正则表达式输出函数名称的值。

这是一个会吐出自己名字的函数：

```
function foo() {
    re = /^function\s+([^(]+)/
    alert(re.exec(arguments.callee.toString())[1]);             
} 
```

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2014-07-25T13:33:55.350

我在这里看到的几个回复的组合。（在 FF、Chrome、IE11 中测试）

```
function functionName() 
{
   var myName = functionName.caller.toString();
   myName = myName.substr('function '.length);
   myName = myName.substr(0, myName.indexOf('('));
   return myName;
}

function randomFunction(){
    var proof = "This proves that I found the name '" + functionName() + "'";
    alert(proof);
} 
```

调用 randomFunction() 将警告包含函数名称的字符串。

JS 小提琴演示：http: [//jsfiddle.net/mjgqfhbe/](http://jsfiddle.net/mjgqfhbe/)

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2015-02-13T05:11:48.953

可以在此答案中找到对此的更新答案： [https ://stackoverflow.com/a/2161470/632495](https://stackoverflow.com/a/2161470/632495)

并且，如果您不想点击：

```
function test() {
  var z = arguments.callee.name;
  console.log(z);
} 
```

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2016-11-30T20:18:10.997

信息以 2016 年为准。

* * *

## 函数声明的结果

结果在歌剧院

```
>>> (function func11 (){
...     console.log(
...         'Function name:',
...         arguments.callee.toString().match(/function\s+([_\w]+)/)[1])
... })();
... 
... (function func12 (){
...     console.log('Function name:', arguments.callee.name)
... })();
Function name:, func11
Function name:, func12 
```

结果在 Chrome

```
(function func11 (){
    console.log(
        'Function name:',
        arguments.callee.toString().match(/function\s+([_\w]+)/)[1])
})();

(function func12 (){
    console.log('Function name:', arguments.callee.name)
})();
Function name: func11
Function name: func12 
```

结果在 NodeJS

```
> (function func11 (){
...     console.log(
.....         'Function name:',
.....         arguments.callee.toString().match(/function\s+([_\w]+)/)[1])
... })();
Function name: func11
undefined
> (function func12 (){
...     console.log('Function name:', arguments.callee.name)
... })();
Function name: func12 
```

在 Firefox 中不起作用。在 IE 和 Edge 上未经测试。

* * *

## 函数表达式的结果

结果在 NodeJS

```
> var func11 = function(){
...     console.log('Function name:', arguments.callee.name)
... }; func11();
Function name: func11 
```

结果在 Chrome

```
var func11 = function(){
    console.log('Function name:', arguments.callee.name)
}; func11();
Function name: func11 
```

不适用于 Firefox、Opera。在 IE 和 Edge 上未经测试。

笔记：

1.  匿名功能检查没有意义。
2.  测试环境

* * *

```
~ $ google-chrome --version
Google Chrome 53.0.2785.116           
~ $ opera --version
Opera 12.16 Build 1860 for Linux x86_64.
~ $ firefox --version
Mozilla Firefox 49.0
~ $ node
node    nodejs  
~ $ nodejs --version
v6.8.1
~ $ uname -a
Linux wlysenko-Aspire 3.13.0-37-generic #64-Ubuntu SMP Mon Sep 22 21:28:38 UTC 2014 x86_64 x86_64 x86_64 GNU/Linux 
```

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2021-07-25T15:05:52.997

由于 arguments.callee.name 是非标准的，并且在 ECMAScript 5 严格模式（[https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Functions/arguments/callee](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Functions/arguments/callee)）中被禁止，一个简单的动态检索函数名称[如魔术变量]的解决方案是使用范围变量和 Function.name 属性。

```
{
  function foo() {
    alert (a.name);
  }; let a = foo
}
{
  function foo2() {
    alert(a.name)
  }; let a = foo2
};
foo();//logs foo
foo2();//logs foo2 
```

注意：嵌套函数不再是源元素，因此不会被提升。此外，此技术不能与匿名函数一起使用。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2016-11-03T15:27:42.550

这是一个单行：

```
 arguments.callee.toString().split('\n')[0].substr('function '.length).replace(/\(.*/, "").replace('\r', '') 
```

像这样：

```
 function logChanges() {
      let whoami = arguments.callee.toString().split('\n')[0].substr('function '.length).replace(/\(.*/, "").replace('\r', '');
      console.log(whoami + ': just getting started.');
    } 
```

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2019-02-12T17:00:11.427

这是[Igor Ostroumov](https://stackoverflow.com/a/48613926/7573223)答案的变体：

如果您想将其用作参数的默认值，则需要考虑对“调用者”进行第二级调用：

```
function getFunctionsNameThatCalledThisFunction()
{
  return getFunctionsNameThatCalledThisFunction.caller.caller.name;
} 
```

这将动态地允许在多个功能中实现可重用。

```
function getFunctionsNameThatCalledThisFunction()
{
  return getFunctionsNameThatCalledThisFunction.caller.caller.name;
}

function bar(myFunctionName = getFunctionsNameThatCalledThisFunction())
{ 
  alert(myFunctionName);
}

// pops-up "foo"
function foo()
{
  bar();
}

function crow()
{
  bar();
}

foo();
crow();
```

如果您也想要文件名，这是使用[F-3000](https://stackoverflow.com/a/18689343/7573223)回答另一个问题的解决方案：

```
function getCurrentFileName()
{
  let currentFilePath = document.scripts[document.scripts.length-1].src 
  let fileName = currentFilePath.split('/').pop() // formatted to the OP's preference

  return fileName 
}

function bar(fileName = getCurrentFileName(),  myFunctionName = getFunctionsNameThatCalledThisFunction())
{
  alert(fileName + ' : ' + myFunctionName);
}

// or even better: "myfile.js : foo"
function foo()
{
  bar();
} 
```

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2022-01-19T05:18:26.323

arguments 对象是所有非箭头函数中可用的局部变量。
您可以通过使用其参数对象来引用该函数内部的函数参数。
它对调用函数的每个参数都有条目，第一个条目的索引为 0。

因此，您基本上可以使用`arguments.callee.name`但在命名函数中，如下所示：

```
function i_have_a_name() {
    console.log(`My name is:`, arguments.callee.name)
} 
```

```
> i_have_a_name()
My name is: i_have_a_name 
```

不幸的是，它在箭头函数中不可用：

```
const i_have_a_name = () => {
    console.log(`My name is:`, arguments.callee.name)
} 
```

```
> i_have_a_name()
Uncaught ReferenceError: arguments is not defined
    at i_have_a_name (REPL3:2:32) 
```

来源：[https ://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Functions/arguments](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Functions/arguments)

* * *

## 回答 #20

> 赞同：-1
> 
> 时间：2009-06-18T15:14:18.997

尝试：

```
alert(arguments.callee.toString()); 
```

* * *

## 回答 #21

> 赞同：-7
> 
> 时间：2011-07-20T10:59:33.313

答案很简短：`alert(arguments.callee.name);`

# c# - 通过反射将 GUID 转换为字符串

> ID：1013244
> 
> 赞同：0
> 
> 时间：2009-06-18T15:11:15.837
> 
> 标签：c#, reflection, properties

我正在使用反射通过 PropertyInfo.SetValue(); 设置属性值；有问题的属性是一个字符串，我从中获取值的对象实际上是一个 GUID。我想在此过程中从 GUID 转换为字符串 - 有没有办法定义某种隐式强制转换来实现这一点？目前我收到一个错误：

```
"Object of type 'System.Guid' cannot be converted to type 'System.String'." 
```

我想我可以进行类型检查并在必要时手动转换，但如果有一种优雅的方式在幕后进行，那将是更可取的！

非常感谢。

* * *

**编辑：** 我真的不能只在 GUID 上调用 .ToString() 方法，因为我非常希望我的代码看起来像这样：

```
propertyInfoInstance.SetValue(classInstance, objectWithValue, null) 
```

其中 objectWithValue 是一个 int/bool/string/GUID。这适用于除 GUID 之外的所有内容，因为（我认为！！）有一个可用的隐式转换。我可以事先进行类型检查，然后将 GUID 转换为字符串，但我只是得到“必须有更好的方法......”的感觉。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-18T15:15:27.623

我不相信字符串和 guid 之间存在隐式转换。尝试这个：

```
guid.ToString(); 
```

对于问题 2：

```
if(propertyInfoInstance.PropertyType == typeof(string) && objectWithValue != null)
{
    objectWithValue = objectWithValue.ToString();
}
propertyInfoInstance.SetValue(classInstance, objectWithValue, null); 
```

我不认为它太乱了。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-18T15:16:18.790

这是我的理解（如果这是错误的，请有人纠正我）你只能为你自己的对象定义隐式转换运算符。

您需要手动处理将 GUID 转储到字符串 w/`guid.ToString();`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-18T15:16:32.817

您是否在 GUID 参考上尝试过 .ToString() ？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-18T15:20:43.087

你可以这样写：

```
object myValue = /* source the value from wherever */;
if (!(myValue is string)) myValue = myValue.ToString(); 
```

然后用 myValue 调用 PropertyInfo.SetValue()。

# c++ - 如何绘制具有透明背景 (GDI) 的 patternBrush？

> ID：1013245
> 
> 赞同：0
> 
> 时间：2009-06-18T15:11:37.803
> 
> 标签：c++, mfc, gdi

我无法绘制具有透明背景的图案。这是我的片段：

```
bitmap.CreateBitmap(8, 8, 1, 1, &bits)
brush.CreatePatternBrush(&bitmap)
hbrush = pCgrCurrentDC->SelectObject(&brush);
// set text color 
TextCol = pCgrCurrentDC->SetTextColor(CgrColourPalRGB);  
int oldBkgrdMode = pCgrCurrentDC->SetBkMode(TRANSPARENT);
//draw polygon 
pCgrCurrentDC->Polygon(CgrBuffer, n); 
```

[msdn](http://msdn.microsoft.com/en-us/library/dce1hh4s(VS.80).aspx)上的文档没有提到任何关于透明度的内容。我猜这个模式可以用吗？或者这是一个错误？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-18T20:50:25.553

模式`TRANSPARENT`意味着在绘制画笔之前不会填充背景。但是您的画笔中不包含任何透明像素，并且无论如何它都会重绘背景像素。`CreateBitmap`在您的示例中，第四个参数 in设置为 1。这意味着位图是单色的。

您需要使用 32 位位图在画笔中使用透明度。GDI 支持透明度，但有一些限制。使用 GDI+ 获得完全透明的支持。

# python - 从 Bat 文件调用 Python 并获取返回码

> ID：1013246
> 
> 赞同：17
> 
> 时间：2009-06-18T15:11:43.073
> 
> 标签：python, batch-file

我正在寻找一种从批处理文件中调用 python 脚本并从 python 脚本中获取返回码的方法。我知道令人困惑，但它基于当前正在使用的系统。我会重新编写它，但这种方式会快得多。

所以：

```
Bat ---------------------> Python
     * call python file *

Bat <--------------------------------- Python
      * python does a load of work *
      * and returns a return code  * 
```

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-06-18T15:17:46.837

windows shell 将返回码保存在`ERRORLEVEL`变量中：

```
python somescript.py
echo %ERRORLEVEL% 
```

在 python 脚本中，您可以退出脚本并通过调用设置返回值`exit()`：

```
exit(15) 
```

在旧版本的 python 中，您可能首先必须从模块中导入`exit()`函数：`sys`

```
from sys import exit
exit(15) 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-18T15:18:16.727

尝试：

```
import os
os._exit(ret_value) 
```

您还应该检查：

*   [sys.exit()](http://bytes.com/groups/python/585533-sys-exit-versus-raise-systemexit)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-09-03T16:31:36.147

您可以为此尝试此批处理脚本：

```
@echo off

REM     %1 - This is the parameter we pass with the desired return code for the Python script that will be captured by the ErrorLevel env. variable.  
REM     A value of 0 is the default exit code, meaning it has all gone well. A value greater than 0 implies an error
REM     and this value can be captured and used for any error control logic and handling within the script

set ERRORLEVEL=
set RETURN_CODE=%1

echo (Before Python script run) ERRORLEVEL VALUE IS: [ %ERRORLEVEL% ]
echo.

call python -c "import sys; exit_code = %RETURN_CODE%; print('(Inside python script now) Setting up exit code to ' + str(exit_code)); sys.exit(exit_code)"

echo.
echo (After Python script run) ERRORLEVEL VALUE IS: [ %ERRORLEVEL% ]
echo. 
```

当您使用不同的返回码值运行它几次时，您可以看到预期的行为：

```
PS C:\Scripts\ScriptTests> & '\TestPythonReturnCodes.cmd' 5

(Before Python script run) ERRORLEVEL VALUE IS: [ 0 ]

(Inside python script now) Setting up exit code to 5

(After Python script run) ERRORLEVEL VALUE IS: [ 5 ]

PS C:\Scripts\ScriptTests> & '\TestPythonReturnCodes.cmd' 3

(Before Python script run) ERRORLEVEL VALUE IS: [ 0 ]

(Inside python script now) Setting up exit code to 3

(After Python script run) ERRORLEVEL VALUE IS: [ 3 ]

PS C:\Scripts\ScriptTests 
```

# c# - c#,excel：获取范围信息

> ID：1013248
> 
> 赞同：0
> 
> 时间：2009-06-18T15:11:56.053
> 
> 标签：c#, excel, excel-2007, excel-formula

我有 ac# 代码，它获取（excel-2007）工作表使用范围如下

```
 Excel.Worksheet ws = (Excel.Worksheet)Globals.ThisAddIn.GetActiveWorksheet();
 Excel.Range range = (Excel.Range)ws.UsedRange; 
```

对于当前的工作表，我确切地知道范围是 A1：HM232，...但是将来该范围可能会改变...如何从使用的范围信息中获取范围信息，例如 A1：HM232？

我可以获得rows.count 和columns.count ......但是如何获得诸如“HM”之类的信息？

这背后的原因是我想稍后把它放在一个公式上

```
=Sheet1!A1:HM232... 
```

提前致谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-18T15:55:08.947

我这个方法应该这样做：

```
range.get_AddressLocal(range.Rows.Count ,range.Columns.Count ,XlReferenceStyle.xlA1 ,null ,ws.UsedRange); 
```

# svn - 在其他版本控制系统中就地导入？光盘？

> ID：1013255
> 
> 赞同：0
> 
> 时间：2009-06-18T15:13:35.973
> 
> 标签：svn, version-control, import

我使用 subversion 的就地导入[（详情请阅读）](http://subversion.tigris.org/faq.html#in-place-import)在 /etc 和我的主目录中进行配置文件版本控制。它对我来说效果很好，但我已经看到很多更好/更快的版本控制系统出现并想要转换。我尝试了 mercurial，但它并不真正支持在存储库中检出单个子文件夹的工作副本的功能 - 它似乎希望您一次检出整个内容。

其他版本控制系统是否允许这样做？我只尝试过 cvs、mercurial 和 subversion。欢迎举例。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-18T15:33:11.440

对于[git](http://git-scm.com/)（假设它已经安装）：

```
cd /etc
git init-db
chmod og-rwx .git
git add .
git commit -a -m"initial import" 
```

使用 apt 时具有自动更新的更详细的版本：

[用 git 维护 /etc](http://www.jukie.net/~bart/blog/20070312134706)

* * *

对于[Mercurial](http://www.selenic.com/mercurial/wiki/)（假设已经安装）：

```
cd /etc
hg init
chmod og-rwx .hg
hg add
hg ci -m "initial checkin" 
```

使用 apt 时具有自动更新的更详细的版本：

[使用 mercurial 维护 /etc](http://michael-prokop.at/blog/2007/03/14/maintain-etc-with-mercurial-on-debian/)

# sql - 如何在多个键上使用反向 JOIN 插入？

> ID：1013257
> 
> 赞同：2
> 
> 时间：2009-06-18T15:13:48.857
> 
> 标签：sql, sql-server

如何使用多个键列进行反向连接？

在这个婴儿玩具 SqlServer 示例中，我有以下内容

```
CREATE TABLE [dbo].[CarList](
 [myID] [int] IDENTITY(1,1) NOT NULL,
 [CarColour] [varchar](32) NOT NULL,
 [CarName] [varchar](128) NOT NULL,
 [CarCompany] [varchar](32) NOT NULL,

 CONSTRAINT [PK_CarList] PRIMARY KEY CLUSTERED(
  [myID] ASC,
  [CarColour] ASC,
  [CarName] ASC,
  [CarCompany] ASC
 )
)

GO

INSERT INTO CarList (CarColour, CarName, CarCompany)
VALUES('blue', 'Abe', 'Ford') 
```

在数据库的其他地方，我有一张像

```
CREATE TABLE [dbo].[NewCars](
 [CarColour] [varchar](32) NOT NULL,
 [CarName] [varchar](128) NOT NULL,
 [CarCompany] [varchar](32) NOT NULL,
)

GO

INSERT INTO NewCars (CarColour, CarName, CarCompany)
SELECT 'blue', 'Abe', 'Ford'
 UNION ALL
SELECT 'blue', 'Abe', 'GM'
 UNION ALL
SELECT 'blue', 'Betty', 'Ford'
 UNION ALL
SELECT 'green', 'Abe', 'Honda' 
```

现在我想在 CarList 表中插入我还没有的汽车

就像是...

```
INSERT INTO CarList ( CarColour, CarName, CarCompany)
 SELECT DISTINCT new.CarColour, new.CarName, new.CarCompany
 FROM    NewCars new, CarList old
 WHERE   new.CarColour  <> old.CarColour
     AND new.CarName    <> old.CarName
     AND new.CarCompany <> old.CarCompany 
```

这不起作用，因为“蓝色”、“贝蒂”、“福特”行将被过滤掉......

如果这只是某种类型的单个 ID，那将非常容易

```
INSERT INTO myTable (myID, param1, param2, etc)
SELECT param1, param2, etc
FROM someOtherTable new
WHERE new.myID NOT IN (SELECT myID FROM myTable) 
```

由于我真的不想进入的原因，我无法从与 CarList 匹配的 NewCars 中删除行。如果可能的话，我还需要一次性完成。

[编辑] 谢谢大家！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-18T15:17:43.873

感谢 DDL 和 DML

这是一种方法

```
INSERT INTO CarList ( CarColour, CarName, CarCompany)
 SELECT DISTINCT *
 FROM    NewCars n
where not exists (select 1 from CarList c where c.CarColour =n.CarColour
and c.CarName = n.CarName
and c.CarCompany = n.CarCompany) 
```

至少有 4 种不同的方法可以做到这一点

*   NOT IN （不会像您一样适用于超过 1 列）
*   不存在
*   左右连接
*   外部应用 (2005+)
*   除外（2005 年以上）

读取[从一个表中选择另一表中不存在的所有行](http://blogs.lessthandot.com/index.php/DataMgmt/DataDesign/the-ten-most-asked-sql-server-questions--1#4)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-06-18T15:19:07.880

```
INSERT
INTO    CarList ( CarColour, CarName, CarCompany)
SELECT  CarColour, CarName, CarCompany
FROM    NewCars nc
WHERE   NOT EXISTS
        (
        SELECT  1
        FROM    CarList cl
        WHERE   cl.CarColor = nc.CarColor
                AND cl.CarName  = nc.CarName
                AND cl.CarCompany = nc.CarCompany
        ) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-18T15:23:34.923

```
INSERT INTO CarList ( CarColour, CarName, CarCompany) 
SELECT DISTINCT new.CarColor, new.CarName, new.CarCompany 
FROM    NewCar new
where not exists (select 0 
         from  CarList old 
         WHERE   new.CarColour  = old.CarColour     
         AND new.CarName    = old.CarName     
         AND new.CarCompany = old.CarCompany)
--This statement matches all that does exists in carlist
--and insert everything that does not exists in Carlist 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-18T16:06:07.607

我可能会使用：

```
INSERT INTO CarList(CarColour, CarName, CarCompany)
SELECT
     NC.CarColour,
     NC.CarName,
     NC.CarCompany
FROM
     NewCars NC
LEFT OUTER JOIN CarList CL ON
     CL.CarColour = NC.CarColour AND
     CL.CarName = NC.CarName AND
     CL.CarCompany = NC.CarCompany
WHERE
     CL.MyID IS NULL 
```

# svn - Web 开发项目管理的良好实践

> ID：1013263
> 
> 赞同：4
> 
> 时间：2009-06-18T15:14:03.490
> 
> 标签：svn, version-control, project-management

我意识到“良好实践”这个词有点可疑和过度使用，但我认为它适用于我的问题。

我有一些良好的 Web 开发经验，但我想听听在做自由职业者和项目管理时有哪些好的基本实践。

例如，我有目标域 mydomain.com。我是否应该在受 .htaccess 或其他方式保护的子域（即 dev.mydomain.com）上进行所有测试？

我熟悉 SVN，但不熟悉 Web 开发。对网站进行版本控制的最佳方式是什么？

我已经建立了两个数据库，mydb `_`dev 和 mydb `_`rel。在 _dev 上完成我的所有工作然后将结构转移到 _rel 是否有意义？第一次发布后会发生什么？

如果您可以回答其中一些问题或将我链接到一个好的资源，那就太好了。到目前为止，我的搜索只产生了 HTML 教程！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-18T15:35:21.747

我一般建议如下。团队应该有 3 种“部署”环境：

*   开发环境：这是开发人员工作并可以发布的地方
*   测试环境：这是进行测试的地方，也可能向客户展示。此处只应部署工作产品。
*   生产环境：运行和使用产品的最终部署

[这](http://juristr.com/blog/2009/03/best-practices-deploying-webapps-contd_20/)是处理这个概念的东西。我的建议是“测试环境”（或预发布环境）位于与最终“生产环境”具有相同配置的同一台服务器上。

对于版本控制，我只会将它用于版本控制源代码。你可以使用任何你喜欢的版本控制（甚至配置管理工具）。在这里进行分支是一种很好的做法，因此每当您发布产品（将其部署到生产环境）时，您都会创建一个具有相应版本号的分支。同时，您继续在主分支上进行开发。这样做的好处是，您可以对发布中可能发生的错误进行修复，并且您可以重新部署分支副本，而无需重新部署同时已添加到主开发分支上的新功能。在网上搜索有关分支的最佳实践，周围有很多东西。但是，我不会使用 SVN 或其他东西直接对您的网站进行版本控制……至少我从未听说过这种做法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-18T15:37:42.447

我发现对我自己的工作有帮助的一些技巧：

*   我为每个项目维护一个个人 wiki 页面，其中包含*所有*与项目相关的数据。由于只是个人消费，我可以根据需要将每一个有机地组织起来。

*   保留在整个项目过程中突然出现的问题日志（在 wiki 页面或其他地方）。与其用随机电子邮件轰炸您的客户或不小心忘记及时提出问题，不如保留日志让您每隔几天发送一封连贯且经过编译的电子邮件，其中包含与项目相关的问题。

*   在本地进行所有开发（MAMP、XAMPP 等）。这样，当您在网站上工作时，您的客户*永远不会*访问该网站，因此绕过了不必要的混乱（为什么我现在得到空白屏幕？！？他们在 5 分钟前工作！！）。

*   [通过Capistrano](http://www.capify.org/)从本地开发推送到您的登台服务器。这可以再次用于生产。更容易跟踪任何构建脚本（例如，缩小 JS）并且比 FTP 更有效

*   使用 SVN 管理所有资产 - 内容、模板、组合、您的工作站点、数据库导出等。如果您从一开始就设置好，组织良好的存储库就不会失控。拥有额外的备份永远不会有什么坏处，即使您知道您永远不会再接触文件。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-18T15:27:24.573

我们所做的。

1.  使用允许在已部署的 Web 服务器之外进行测试的框架。我们在笔记本电脑上进行开发和测试。有些人使用在 Eclipse 下运行的 Glassfish 进行测试。其他使用独立运行的 Django。我们的笔记本电脑上有用于开发和测试的数据库。我们使用配置文件来确保我们使用数据库、目录等的“开发”名称。

2.  在 VM 上进行集成测试。我们的主机是基于 Red Hat Enterprise Linux 的，所以我们有 Fedora VM，用于测试 Apache 和 MySQL（或 Oracle）以及整个技术堆栈。我们在 VM 环境中有集成测试数据库。我们使用配置文件来确保我们使用数据库、目录等的“测试”名称。

3.  我们使用部署非常整齐的产品。Glassfish/Java 应用程序使用 WAR 或 EAR 文件进行部署。Django 应用程序使用 Python 的`setup.py`安装程序。这样我们就可以安装到生产环境中，摆弄数据库，然后我们就可以启动并运行了。我们使用配置文件来确保我们使用数据库、目录等的“生产”名称。

第一个版本涉及第一次构建数据库。我们提供了一个脚本（或者对于 Django，我们运行`manage.py syncdb`命令）来构建数据库。

在进行架构更改时，我们要么有脚本，要么有说明。我们必须在测试和生产中再次这样做。

当部署到对世界可见的生产时，我们会这样做。

1.  我们的托管环境中有一个“暂存”的虚拟机。我们让它发挥作用。它在互联网上是不可见的。我们检查我们的组件，安装它们，运行数据库模式更改脚本（或者如果它很复杂，则执行手动步骤）。通常，我们处理生产数据库的副本。

2.  然后，我们克隆该 VM 以创建生产 VM。我们更改生产配置以使用生产数据库的升级副本。

我们没有名为“prod”的数据库，这很难使用。我们在生产中使用“prod_3”，在升级时使用“prod_4”。然后我们将配置文件更改为使用“prod_4”。“prod_3”可以挂起，直到我们需要磁盘空间来创建“prod_5”。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-18T15:18:56.320

至于版本控制，我想说的是把所有不是动态创建的东西都放在控制之下。例如，如果您的应用程序动态生成一堆 .txt 文件，则不需要对这些文件进行版本控制，但是只创建一次的任何内容都需要处于版本控制之下。

至于您选择的版本控制系统，我会推荐 SVN 以外的东西（可能是 Git 或 Mercurial），但这只是我个人的偏好，而不是任何实质性的原因。

# wpf - XAML 中的错误-“样式”的 TypeConverter 不支持从字符串转换

> ID：1013266
> 
> 赞同：5
> 
> 时间：2009-06-18T15:14:20.480
> 
> 标签：wpf, styles

我有一个要加水印的文本框。在我的 window.resources 部分中，我添加了下面完整包含的样式。

当我在文本框上设置样式时，Blend 3 Beta 显示以下消息：

'“样式”的 TypeConverter 不支持从字符串转换'

发生了什么事，我该如何解决？

```
<Style x:Key="WaterMarkTextBoxStyle" BasedOn="{StaticResource {x:Type TextBox}}" TargetType="{x:Type TextBox}">
    <Setter Property="Template">
        <Setter.Value>
            <ControlTemplate TargetType="{x:Type TextBox}">
                <Grid>
                    <ScrollViewer x:Name="PART_ContentHost" SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}" />
                    <TextBlock x:Name="textBlock" Opacity="0.345" Text="Enter Text Here" TextWrapping="Wrap" Visibility="Hidden" />
                </Grid>
                <ControlTemplate.Triggers>
                    <MultiTrigger>
                        <MultiTrigger.Conditions>
                            <Condition Property="IsFocused" Value="False" />
                            <Condition Property="Text" Value="" />
                        </MultiTrigger.Conditions>
                        <Setter Property="Visibility" TargetName="textBlock" Value="Visible" />
                    </MultiTrigger>
                </ControlTemplate.Triggers>
            </ControlTemplate>
        </Setter.Value>
    </Setter>
</Style> 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-06-18T15:27:43.340

你应该写，

```
<TextBox Style="{StaticResource WaterMarkTextBoxStyle}" /> 
```

假设你`Style`在`Resources`.

# ruby-on-rails - 在 Windows 上使用 Ruby 进行开发

> ID：1013270
> 
> 赞同：38
> 
> 时间：2009-06-18T15:14:49.013
> 
> 标签：ruby-on-rails, windows, ruby

我即将开始一份新工作，我将在 Windows 机器上使用 Ruby 和 Rails 进行开发。我已经多年没有使用 Windows，Textmate、Git 和 Bash 之类的工具是使用 Mac 的工作流程不可或缺的一部分。

那么，对于使用的最佳工具或工作策略，是否有人有任何建议或建议？还是要避免的陷阱？

当然，我尤其对最好的文本编辑器感兴趣。（我正在认真考虑借此机会学习 Vim 或 Emacs，或任何 Windows 端口的名称，但欢迎任何其他想法。）

此外，任何有用的插件、工具或程序的想法都会受到赞赏。

如果您认为我已经完全失去理智，请随时告诉我 ;-)

干杯！

* * *

## 回答 #1

> 赞同：65
> 
> 时间：2009-06-18T15:28:11.123

## Ruby 和 Rails

*   [适用于 Windows 的 RubyInstaller](http://rubyinstaller.org/)
*   [适用于 Windows 的 RubyStack 安装程序](http://bitnami.org/stack/rubystack)
*   [导轨](https://github.com/rails/rails)

## 开发环境

### IDE

*   [红宝石矿](http://www.jetbrains.com/ruby)
*   [NetBeans](http://www.netbeans.org/)
*   [Aptana RadRails](http://www.aptana.com/)

### 文本编辑器

*   [崇高的文字 2](http://www.sublimetext.com/dev)
*   ~~[e](http://www.e-texteditor.com/)（又名 TextMate for Windows）~~（似乎已被放弃）
*   [Vim/红宝石](http://vim-ruby.rubyforge.org/)

## bash 环境

*   [赛格温](http://www.cygwin.com/)

## 源代码控制

*   [吉特](http://kerneltrap.org/Linux/Git_on_Windows)

## 有用的网址

*   [在 Windows XP 上设置 Rails 开发环境](http://beans.seartipy.com/2008/06/09/setting-up-rails-development-environment-on-windows-vistaxp/)

*   [RubyonWindows 博客](http://rubyonwindows.blogspot.com/)

*   [Windows 是 Ruby 的一流平台吗？](http://www.rubyinside.com/is-windows-a-first-class-platform-for-ruby-823.html)

## 相关问题

*   [为什么 ruby​​ 在 Windows 上这么慢？](https://stackoverflow.com/questions/920201/why-is-ruby-so-much-slower-on-windows)
*   [在 Windows 上运行 Ruby/Rails 的限制](https://stackoverflow.com/questions/164896/limitations-in-running-ruby-rails-on-windows)
*   [使用带有 Rails 的 IDE 会妨碍我吗？](https://stackoverflow.com/questions/1007825/will-using-an-ide-with-rails-hinder-me)
*   [Windows 中 Ruby 的 GUI 编辑器](https://stackoverflow.com/questions/685572/gui-editor-for-ruby-in-windows)
*   [您在 Windows 上为 Ruby 使用什么 IDE/编辑器？](https://stackoverflow.com/questions/256365/what-ide-editor-do-you-use-for-ruby-on-windows)
*   [https://stackoverflow.com/questions/826164/a-definitive-list-of-ides-for-ruby-on-rails](https://stackoverflow.com/questions/826164/a-definitive-list-of-ides-for-ruby-on-rails)
*   [Ruby On Rails 与 Windows Vista - 最佳设置？](https://stackoverflow.com/questions/3408/ruby-on-rails-with-windows-vista-best-setup)
*   [https://stackoverflow.com/search?q=ruby+on+windows](https://stackoverflow.com/search?q=ruby+on+windows)

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2009-06-18T15:19:41.950

[RubyMine](http://www.jetbrains.com/ruby/)应该是一流的 IDE。JetBrains 始终生产出色的产品。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-06-18T15:18:56.117

**NetBeans**或**e**作为 IDE

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-06-19T00:39:32.627

[这是我非常详细的Windows Server 2003](http://wiki.devchix.com/index.php?title=Server_2003)设置指南，它在 XP Pro 和 Vista 上基本保持不变。请参阅此[通用安装列表](http://wiki.devchix.com/index.php?title=Workshop_Installation_Notes)，如果您得到不同的结果，请修改说明。它们是为刚接触编程的人准备的，因此它们可能会过于明确地用于您的目的。

IMO，您绝对需要的一件事是 *nix 风格的外壳。这与你喜欢 dir 还是 ls 无关——你需要能够运行 shell 脚本，否则你不会走得太远。

git bash（与[msysgit](http://code.google.com/p/msysgit/)一起提供）是我在 cmd.exe 窗口风暴中的灯塔。它本质上是 Windows 上的 bash，可以让您运行几乎任何可以在 *nix 上运行的脚本。这包括所有 gem 命令行可执行文件。

在某些地方会变得很奇怪。

*   文件权限 - 在 Windows ACL 和 POSIX 文件权限之间映射没有一个很好的方法。Cygwin 人[已经投入了多年的时间来解决它](http://www.cygwin.com/cygwin-ug-net/ntsec.html)，但它仍然不能一直工作。git bash 的方法是在被要求做 a (例如) 时不做任何事情`FileUtils.chmod`。这意味着您可能需要手动创建更多目录，并且您确实需要非常清楚何时更改文件权限。

例如，当我在 Windows 上安装 Heroku gem 时，它试图将我的 Heroku 凭证文件（其中包含我的 Heroku 明文密码）的权限设置为`u+r go-rwx`. 如果您在共享计算机上，您肯定希望更改该文件的 ACL。

*   脚本与 .bat 文件 - 我想将 git 的默认编辑器从 vi 更改为 SCiTE（并不是我不喜欢 vi；这是针对新用户研讨会的，我不想解释编辑模式）。我必须创建一个实际上是 shell 脚本的 .bat 文件。在此处查看完整说明：

[如何设置编辑器以在 Windows 上使用 Git](https://stackoverflow.com/questions/10564/how-can-i-set-up-an-editor-to-work-with-git-on-windows#773973)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-06-20T07:47:32.960

也许每天早上带一张 LiveCD 和你一起工作..

如果您使用足够小的发行版/足够大的驱动器，您甚至可以将它放在 USB 闪存驱动器上...

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-06-18T15:19:14.683

我正在使用 Netbeans，它是一个很好的整体编辑器（至少对我而言）。

对于简单的项目，我使用 JEdit。

[您可以在NetBeans IDE](http://www.netbeans.org/downloads/index.html)中找到该链接

你可以在 JEdit 找到[JEdit](http://www.jedit.org/)

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-06-18T15:20:11.107

git 在 Windows 上可用：[http](http://code.google.com/p/msysgit/) ://code.google.com/p/msysgit/或[http://kerneltrap.org/Linux/Git_on_Windows](http://kerneltrap.org/Linux/Git_on_Windows)

基本上，你需要决定是走[Cygwin](http://www.cygwin.com/)路线还是[MingW](http://www.mingw.org/)路线。两者都将为您提供 Bash。

[GVim](http://www.vim.org/)效果很好。我使用本地端口而不是 Cygwin 版本。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-06-18T15:22:24.300

如果您的开发生活正在转向 Windows，那么您可能希望您的雇主对此进行投资：

> [SapphireSteel Software 的 Ruby In Steel](http://www.sapphiresteel.com/)

我过去在开始修补 Ruby on Rails 时使用过它，现在非常好并且相当成熟。此外，它建立在 Visual Studio 之上，我仍然认为它是最重要的开发环境之一。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-07-15T00:40:05.383

你没有说你是否自愿使用 Windows。但是，这条线向我表明，也许是这样：

“如果你认为我已经完全失去了理智，那你也可以告诉我”

如果您对此有**任何**选择，我强烈建议您使用基于 Unix 的系统而不是 Windows。如果您不得不经历不便、花钱或跳槽来避免在 Windows 上进行 Ruby/Rails 开发，那将是值得的。

由于遗留系统和其他开发人员的偏好，我最近不得不在 Windows 上处理 Ruby 和 Rails。在基于 Unix 的系统上进行 Rails 开发效率更高**。**区别并不微妙。

也就是说，正如其他人所提到的，安装[mysysgit](http://code.google.com/p/msysgit/)即使您不使用 Git

至于文本编辑器，我喜欢[Notepad++](http://notepad-plus.sourceforge.net/uk/site.htm)。

[NetBeans](http://www.netbeans.org/)是一个非常适合 Rails 开发的 IDE。体面的语法突出显示，代码完成，错误突出显示。方便的导航键盘快捷键。这个很不错。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-06-18T17:29:27.743

This may not be applicable in your situation (IT restrictions, etc), but another option might be virtualization. You could install VirtualBox, VMWare, or some equivalent, and run Ubuntu (or your preferred Linux distribution, of course) that way, gaining access to the full UNIX toolset.

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-06-18T15:17:00.397

Cygwin 作为命令行工具

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2009-06-18T15:20:55.707

我用过的两个最好的 RoR IDE 是[NetBeans](http://www.netbeans.org/)和[Aptana Studio](http://www.aptana.com/studio)。然而，在大多数情况下，我坚持使用[Notepad++](http://notepad-plus.sourceforge.net/)及其各种插件（[资源管理器](http://sourceforge.net/project/showfiles.php?group_id=189927&package_id=223667)和[HTML 标签](http://sourceforge.net/project/showfiles.php?group_id=189927&package_id=242320)是两个重要的）。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2010-09-15T13:26:16.523

我使用 virtual box、putty 和 xming 在隔离的 linux 环境中进行开发。[我在这里](http://hoolihan.net/blog-tim/2010/07/08/developing-for-open-source-languages-on-windows-the-better-way/)写了完整的设置

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2013-10-16T08:47:18.787

我在 Windows 上的 Rails 开发中遇到了很多困难。在某些时候，我需要一个在 Windows 上不起作用的特定 gem。我更喜欢使用[Vagrant使用 VM](http://www.vagrantup.com/)

[这是我写的一篇博客文章](http://manuel.manuelles.nl/blog/2013/07/23/developing-ruby-on-rails-on-windows/)，我如何使用 Chef 和 Vagrant 设置我的项目

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2009-06-18T15:23:19.510

[IntelliJ IDEA](http://www.jetbrains.com/idea/index.html)

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2009-06-18T15:36:45.583

我在Windows下的RoR开发了几年，可以忍受，但是Linux（或Mac）在这方面要好得多。许多 gems 和插件很难在 Windows 上安装（例如 quixml）。

Windows下我最喜欢的文本编辑器是Textpad，Eclipse也不错。

如果你想在 Windows 控制台中使用 ls、find、grep...，只需下载一些他们的 Win32 端口[包](http://unxutils.sourceforge.net/)，安装它们并添加到你的 PATH 中（Cygwin 肯定更好，但也更难安装）。你也可以试试 Powershell，它应该是微软的 unix 命令行的替代品。

# asp.net - 错误：尝试在 ASP.NET 中打开 PDF 时

> ID：1013271
> 
> 赞同：0
> 
> 时间：2009-06-18T15:14:49.120
> 
> 标签：asp.net, pdf

在我的 ASP.NET 应用程序中，当我尝试使用以下代码打开 PDF 文件时，出现错误

用于显示 PDF 文件的代码

```
FileStream MyFileStream = new FileStream(filePath, FileMode.Open);
long FileSize = MyFileStream.Length;
byte[] Buffer = new byte[(int)FileSize + 1];
MyFileStream.Read(Buffer, 0, (int)MyFileStream.Length);
MyFileStream.Close();
Response.ContentType = "application/pdf";
Response.AddHeader("content-disposition", "attachment; filename="+filePath);
Response.BinaryWrite(Buffer); 
```

我收到的错误

“打开此文档时出错。文件已损坏，无法打开”

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-18T22:46:03.683

听起来您使用 aspx 文件来输出 pdf。您是否考虑过使用作为 HttpHandler 的 ashx 文件？它绕过了所有典型的 aspx 开销，并且对于提供原始数据更有效。

这是使用您的代码的 ashx 示例：

```
<% WebHandler Language="c#" class="ViewPDF" %>
public class ViewPDF : IHttpHandler
{
    public void ProcessRequest(HttpContext context)
    {
        FileStream MyFileStream = new FileStream(filePath, FileMode.Open);
        long FileSize = MyFileStream.Length;
        byte[] Buffer = new byte[(int)FileSize + 1];
        MyFileStream.Read(Buffer, 0, (int)MyFileStream.Length);
        MyFileStream.Close();
        Response.ContentType = "application/pdf";
        Response.AddHeader("content-disposition", "attachment; filename="+filePath);
        Response.BinaryWrite(Buffer);
    }

    public bool IsReusable
    {
        get { return false; }
    }
} 
```

如果你还想用aspx页面。确保您正在执行以下操作：

```
// At the beginning before you do any response stuff do:
Response.Clear();

// When you are done all your response stuff do:
Response.End(); 
```

那应该可以解决您的问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-18T15:16:14.203

您必须刷新响应，否则它会被部分传输。

```
Response.Flush(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-18T15:23:34.500

除了 ocedcio 的回复之外，您还需要注意`Stream.Read()`不一定会读取所有请求的字节。`Stream.Read()`如果读取的字节数少于请求的字节数，您应该检查返回值并继续读取。

有关详细信息，请参阅此问题和答案：[从流中创建字节数组](https://stackoverflow.com/questions/221925/creating-a-byte-array-from-a-stream)

# python - 这个 Python 字符串切片语句中的两个冒号的目的是什么？

> ID：1013272
> 
> 赞同：13
> 
> 时间：2009-06-18T15:14:57.467
> 
> 标签：python, slice

例如，

```
str = "hello"
str[1::3] 
```

在 Python 文档中哪里可以找到它？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-06-18T15:18:13.547

在[序列的描述中](http://docs.python.org/library/stdtypes.html#index-510)：

```
s[i:j:k]    slice of s from i to j with step k 
```

> `s`from `i`to `j`with step的切片`k`被定义为具有索引的项目序列，`x = i + n*k`使得`0 <= n < (j-i)/k`. 换句话说，索引是`i`、`i+k`、等`i+2*k`，在达到`i+3*k`时停止`j`（但从不包括`j`）。如果`i`或`j`大于`len(s)`，则使用`len(s`)。**如果`i`or`j`被省略 or `None`，它们将成为“结束”值（结束取决于 的符号`k`）**。注意，`k`不能为零。如果`k`是`None`，则将其视为 1。

# c# - IDisposable、Finalizers 和非托管资源的定义

> ID：1013275
> 
> 赞同：5
> 
> 时间：2009-06-18T15:15:26.873
> 
> 标签：c#, .net, garbage-collection, idisposable, finalizer

我正在努力确保我的理解`IDisposable`是正确的，并且有些事情我仍然不太确定。

`IDisposable`似乎有两个目的。

1.  提供按需“关闭”托管对象的约定。
2.  提供一个约定以释放托管对象持有的“非托管资源”。

我的困惑来自于确定哪些场景有“非托管资源”在起作用。

假设您正在使用 Microsoft 提供的`IDisposable`实现（托管）类（例如，与数据库或套接字相关的）。

1.  你怎么知道它是`IDisposable`只为上面的**1**还是**1&2**实现的？
2.  您是否负责确保释放内部可能持有或不持有的非托管资源？您是否应该向您自己的调用 instanceOfMsSuppliedClass.Dispose() 的类添加终结器（这将是正确的机制吗？）？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-06-18T15:22:36.017

> 1.  你怎么知道它是为上面的 1 还是 1&2 实现 IDisposable ？

你的第一个问题的答案是“你不应该知道”。如果您使用的是第三方代码，那么您在某种程度上是它的怜悯 - 当您调用 Dispose 时，您必须相信它会正确处理自己。如果你不确定或者你认为有错误，你总是可以尝试使用 Reflector() 来反汇编它（如果可能的话）并检查它在做什么。

> 2.  我是否负责确保释放内部可能持有或不持有的非托管资源？我是否应该向我自己的调用 instanceOfMsSuppliedClass.Dispose() 的类添加终结器（这将是正确的机制吗？）？

如果您使用的是 .Net 2.0 或更高版本，您应该很少（如果有的话）需要为您的类实现终结器。终结器会为您的类增加开销，并且通常不会提供比仅实现 Dispose 所需的更多功能。我[强烈建议您访问这篇文章](http://www.codeproject.com/KB/cs/idisposable.aspx)，以获得有关正确处理的一个很好的概述。在您的情况下，您可能希望调用`instanceofMSSuppliedClass.Dispose()`自己的 Dispose() 方法。

归根结底，对对象调用 Dispose() 是一种很好的做法，因为它明确地让 GC 知道你已经完成了资源并允许用户立即清理它，并通过让其他程序员知道间接记录代码该对象此时已使用资源完成。但是即使您忘记显式调用它，它最终也会在对象无根时发生（毕竟.Net 是一个托管平台）。仅当您的对象具有需要隐式清理的非托管资源时才应实现终结器（即，消费者有可能忘记清理它，这将是有问题的）。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-06-18T15:21:49.653

您应该始终对实现 IDisposable 的对象调用 Dispose（除非他们明确告诉您这是一个有用的约定，例如 ASP.NET MVC 的 HtmlHelper.BeginForm）。您可以使用“使用”语句来简化此操作。如果您将类中 IDisposable 的引用作为成员字段挂起，那么您应该使用[Disposable Pattern](http://www.codeproject.com/KB/cs/idisposable.aspx)来实现 IDisposable 以清理这些成员。如果您运行像 FxCop 这样的静态分析工具，它会告诉您相同的结果。

你不应该试图猜测界面。今天，该类可能不会使用非托管资源，但下一个版本呢？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-18T15:23:08.667

您不对对象的内容负责。Dispose() 应该是透明的，并且释放它需要释放的东西。之后，您无需为此负责。

非托管资源是您在（托管）C++ 中创建的资源，您可以在其中通过指针和“new”语句而不是“gcnew”语句分配内存。当您在 C++ 中创建一个类时，您有责任删除此内存，因为它是本机内存或非托管内存，而垃圾收集器不关心它。您还可以通过 Marshal 分配创建此非托管内存，并且我假设是不安全的代码。

使用托管 C++ 时，您也不必手动实现 IDisposable 类。当您编写解构器时，它将被编译为 Dispose() 函数。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-18T15:35:37.830

如果有问题的类是 Microsoft 提供的（即数据库等），那么 Dispose 的处理（来自 IDisposable）很可能已经被处理了，这取决于你来调用它。例如，使用数据库的标准做法如下所示：

```
//...
using (IDataReader dataRead = new DataReaderObject())
{
   //Call database
} 
```

这与写作基本相同：

```
IDataReader dataRead = null;
try
{
    dataRead = new DataReaderObject()
    //Call database
}
finally
{
    if(dataRead != null)
    {
        dataRead.Dispose();
    }
} 
```

据我了解，在从 IDisposable 继承的对象上使用前者通常是一种好习惯，因为它将确保正确释放资源。

至于自己使用 IDisposable ，实现由您决定。从它继承后，您应该确保该方法包含处理您可能手动创建的任何数据库连接所需的代码，释放可能保留的资源或防止对象被破坏，或者只是清理大型资源池（如图像）。这也包括非托管资源，例如，标记在“不安全”块内的代码本质上是非托管代码，可以允许直接内存操作，这肯定需要清理。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2011-02-20T21:30:21.263

术语“非托管资源”有点用词不当。基本概念是成对动作的概念——执行一个动作会产生执行某些清理动作的需要。打开文件需要关闭它。拨调制解调器需要挂机。系统可能会在未能执行清理操作的情况下幸存下来，但后果可能很严重。

*当一个对象被称为“持有非托管资源”时，真正的意思是该对象具有对其他*实体执行某些必需的清理操作所需的信息和动力，并且没有特别的理由相信信息和动力存在于任何地方别的。如果唯一拥有这些信息和动力的对象被完全抛弃，则永远不会发生所需的清理操作。.Dispose 的目的是强制对象执行任何所需的清理，以便可以安全地放弃它。

为了防止代码在没有首先调用 Dispose 的情况下放弃对象，系统允许类注册“终结”。如果某个已注册类的对象被废弃，系统会在该对象被永久废弃之前，给它一个机会对其他实体执行清理操作。但是，无法保证系统会以多快的速度注意到对象已被丢弃，并且各种情况可能会阻止对象被提供清理的机会。术语“托管资源”有时用于指代一个对象，该对象必须在放弃之前执行一些清理，但如果有人未能调用 Dispose，它将自动注册并尝试执行此类清理。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-18T15:21:01.043

**是的，您有责任调用该`Dispose`方法 - 或更好的使用`using`语句。如果一个对象正在实现`IDisposable`，无论如何你都应该处理它。**

```
using (var myObj = new Whatever())
{
   // ..
} 
```

类似于

```
{
  var myObj;
  try
  {
     myObj = new Whatever();
     // ..
  } 
  finally
  {
    if (myObj != null)
    {
      ((IDisposable)myObj).Dispose();
    }
  }
} // object scope ends here 
```

**编辑**：添加了尝试/最后感谢 Talljoe - 哇，要正确处理它很复杂 :)

**EDIT2：**我并不是说您应该使用第二个变体。我只是想表明“使用”对于一堆可能变得非常混乱且难以正确处理的代码来说是很好的语法糖。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-06-18T15:24:35.467

为什么这对你很重要？

如果可能，我将一次性对象的范围包装在 using 中。这会在使用结束时调用 dispose。当我不再需要该对象时，我会显式调用 dispose 。

无论是原因 1 还是原因 2 都没有必要。

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2009-06-19T13:12:24.603

这里缺少的一件是终结器 - 我的习惯是，如果我实现 IDisposable 我还有一个终结器来调用 Dispose() 以防万一我的客户没有。是的，它增加了开销，但如果调用 Dispose() ，则调用 GC.SuppressFinalize(this) 会消除它。

# perl - foreach my $var (@list) -- $var 是参考吗？

> ID：1013277
> 
> 赞同：9
> 
> 时间：2009-06-18T15:15:40.570
> 
> 标签：perl, foreach, perlsyn

所以，我从来不知道这一点，我想澄清一下。我知道如果你这样做

```
foreach (@list){ 
```

如果您在该循环中更改 $_ ，它将影响实际数据。但是，我不知道如果你这样做了

```
foreach my $var1 (@list){ 
```

如果您在循环中更改了 $var1 ，它将更改实际数据。:-/ 那么，有没有办法循环 @list 但将变量保留为只读副本，或者如果更改不会更改 @list 中的值的副本？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-06-18T15:22:25.363

`$var`依次为每个项目起别名。

请参阅[http://perldoc.perl.org/perlsyn.html#Foreach-Loops](http://perldoc.perl.org/perlsyn.html#Foreach-Loops)

> 如果 LIST 的任何元素是左值，您可以通过修改循环内的 VAR 来修改它。相反，如果 LIST 的任何元素不是左值，则任何修改该元素的尝试都将失败。换句话说，foreach 循环索引变量是您正在循环的列表中每个项目的隐式别名。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-06-18T15:21:45.143

最简单的方法就是复制它：

```
foreach my $var1 (@list) {
    my $var1_scratch = $var1; 
```

或者

```
foreach my $var1 ( map $_, @list ) { 
```

但是如果 $var1 是一个引用，那么 $var1_scratch 将是对同一事物的引用。为了真正安全，您必须使用 Storable::dclone 之类的东西来进行深层复制：

```
foreach my $var1 ( @{ Storable::dclone( \@list ) } ) {
} 
```

（未经测试）。然后您应该能够安全地更改 $var1。但是如果@list 是一个大数据结构，它可能会很昂贵。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-06-18T15:51:46.607

它是别名，而不是参考。如果您想创建自己的别名（在 for 之外），您可以使用[Data::Alias](http://search.cpan.org/dist/Data-Alias/lib/Data/Alias.pm)。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-06-18T16:26:50.497

这些循环之间的唯一区别：

```
foreach (@array) { ... }
foreach my $var (@array) { ... } 
```

是循环变量。别名是 的函数`foreach`，而不是隐式变量`$_`。请注意，这是*别名*（同一事物的另一个名称）而不是*引用*（指向事物的指针）。

在简单（和常见）的情况下，您可以通过复制来打破别名：

```
foreach my $var (@array) {
    my $copy = $var;
    # do something that changes $copy
} 
```

这适用于普通的标量值。对于引用（或对象），您需要使用[Storable](http://perldoc.perl.org/Storable.html)或[Clone](http://search.cpan.org/perldoc?Clone)进行深层复制，这可能会很昂贵。绑定变量也是有问题的，[perlsyn](http://perldoc.perl.org/perlsyn.html#Foreach-Loops)建议完全避免这种情况。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-18T15:22:55.423

我不知道如何在 foreach 语句本身中强制变量按值而不是按引用。你可以复制`$_`虽然的值。

```
#!/usr/perl/bin
use warnings;
use strict;

use Data::Dumper;

my @data = (1, 2, 3, 4);

print "Before:\n", Dumper(\@data), "\n\n\n";

foreach (@data) {
    my $v = $_;
    $v++;
}

print "After:\n", Dumper(\@data), "\n\n\n";

__END__ 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2011-09-10T04:23:00.273

在 for 语句中复制@list：

```
foreach my $var1 (() = @list) {
  # modify $var without modifying @list here
} 
```

# remote-desktop - 在我的应用程序中使用的远程桌面软件

> ID：1013280
> 
> 赞同：2
> 
> 时间：2009-06-18T15:15:56.997
> 
> 标签：remote-desktop, logmein

有人知道在另一个应用程序（即我正在开发的应用程序）中使用的好的、免费的远程桌面解决方案吗？

我的应用程序显示本地网络上当前可用的计算机列表。我希望用户能够选择其中一个，并与它建立远程桌面连接。

Windows 桌面连接对我不起作用，因为它会注销当前使用该特定 PC 的用户。[我需要LogMeIn Free](https://secure.logmein.com/products/free/)之类的东西，它可以直接控制鼠标和键盘，但只能在本地网络上工作，不需要互联网连接，就像 Windows 远程桌面连接一样；当然可以通过另一个应用程序调用。

谢谢大家。

编辑：

我意识到实际上没有必要在我的应用程序中嵌入远程桌面软件，一个简单的远程桌面 .exe 通过命令行接受参数会好得多。我需要输入远程 PC 的名称或 IP、Windows 帐户的用户名和密码，然后只需连接到显示单个窗口的远程 PC。

那个怎么样？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-18T15:19:35.383

[有什么理由不使用VNC](http://en.wikipedia.org/wiki/VNC)的各种实现之一？有各种许可证下可用的实现，因此您应该能够找到满足您需求的一种。如果您需要更高的安全性，您可以通过某种 VPN 对其进行隧道传输。

VNC 没有注销任何现有用户的副作用。但是，它确实需要安装客户端 - Windows 远程桌面以外的任何解决方案（只需要正确的权限）都需要安装。

（作为旁注，我刚刚发现有[一个用 C# 编写的开源 VNC 客户端](http://dnvnccl.sourceforge.net/)——你的项目是用什么语言编写的？）

此外，[维基百科对远程访问软件进行了全面的比较](http://en.wikipedia.org/wiki/Comparison_of_remote_desktop_software)

[有一个名为Terminals](http://www.codeplex.com/Terminals)的开源 .NET 应用程序，它的工作方式似乎与您所描述的非常相似。它支持 RDP 和 VNC - 它可能为您的应用程序提供一个很好的起点？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-18T15:17:12.160

[FogCreek CoPilot](https://www.copilot.com/)怎么样？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-18T15:23:16.607

这是一个名为 SupportSmith SDK 的产品，它支持您正在寻找的东西。它是一组 ActiveX 和 .NET 组件，可让您轻松地为您的应用程序添加远程支持：

[支持史密斯 SDK](http://www.componentsource.com/products/supportsmith-sdk/index.html)

# python - python ORM允许创建表和批量插入？

> ID：1013282
> 
> 赞同：2
> 
> 时间：2009-06-18T15:16:00.773
> 
> 标签：python, database, orm

我正在寻找一个允许我进行批量插入以及基于 python 类创建代码的 ORM。我尝试了 sqlobject，它可以很好地创建表，但是对于我想要插入的数据量来说，插入速度慢得让人无法接受。如果这样的 ORM 不存在任何可以帮助处理诸如清理输入和构建 SQL 字符串的类的指针，我们将不胜感激。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-18T15:19:38.613

您可能想尝试[SQLAlchemy](http://www.sqlalchemy.org/ "SQL炼金术")。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-19T01:31:10.137

我不熟悉 sqlobject，但对于批量插入，通常您希望确保这是在事务中完成的，因此您不会提交每个操作。

在 sqlobject 中，您似乎可以通过使用 transactions 对象来控制提交来做到这一点。您可能还需要关闭默认的 AutoCommit 标志才能正常运行。

[http://www.sqlobject.org/SQLObject.html#id45](http://www.sqlobject.org/SQLObject.html#id45)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-18T15:20:31.560

我相信 sqlalchemy 有批量插入，但我从未使用过它。然而，根据[这个评论者](http://pyinsci.blogspot.com/2007/07/fastest-python-database-interface.html)的说法，它在基准测试中表现良好。

编辑：似乎不清楚他是如何使用 SQLAlchemy 的......无论是实际的 ORM 还是只是查询代码。阅读博客条目，我认为重点是使用 ORM，但一些评论者似乎认为他正在使用查询代码，如果是 ORM，它会慢得多。

# c# - 我可以通过 T.Property 吗？另外，改进这种方法的想法？

> ID：1013285
> 
> 赞同：5
> 
> 时间：2009-06-18T15:16:22.020
> 
> 标签：c#, .net, nhibernate, .net-3.5, orm

或者可能有更好的方法。

我正在为 NHibernate 构建一个动态查询构建器，我们不想将 HQL 直接放入应用程序中，我们希望它尽可能与 ORM 无关。目前看起来像这样：

```
 public override IEnumerable<T> SelectQuery(Dictionary<string, string> dictionary)
    {
        string t = Convert.ToString(typeof (T).Name);
        string criteria = string.Empty;
        foreach (KeyValuePair<string, string> item in dictionary)
        {
            if (criteria != string.Empty)
                  criteria += " and ";

            criteria += item.Key + " = '" + item.Value + "'"; 
        }

        string query = " from " + t;

        if (criteria != string.Empty)
            query += " where " + criteria;

        return FindByHql(query);
    } 
```

好的，很好，但是....这里有两件事会造成问题：

1.  这个查询只处理“and”，我最初的想法是通过构建一个方法来动态构建字典，该字典接受属性名称、值和运算符“and”或“or”，并与数组一起构建字典的运营商。这听起来像是正确的做法吗？

2.  好的，所以，这很好用，但是，当有一个整数时，它会因为单引号而失败。我认为最好的方法是让字典接受`<T.Property, string>`然后反映到 T.Property 以找到数据类型并相应地表现。我是否过于复杂了？

谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-18T15:28:16.363

这样的事情怎么办。

你有一个操作的枚举。不是为字典传递一个字符串，而是传递一种 QueryObject 类型，该类型具有值的类型和值的操作。你可以在下面看到。

```
public enum Operation
{
    And,
    Or
}

public class QueryObject
{
    public string Value { get; set; }
    public Type Type { get; set; }
    public Operation Operation { get; set; }
}

public override IEnumerable<T> SelectQuery(Dictionary<string, QueryObject> dictionary)
{
    string t = Convert.ToString(typeof(T).Name);
    string criteria = string.Empty;
    foreach (KeyValuePair<string, QueryObject> item in dictionary)
    {
        if (!string.IsNullOrEmpty(criteria))
        {
            switch (item.Value.Operation)
            {
                case Operation.And:
                    criteria += " and ";
                    break;
                case Operation.Or:
                    criteria += " or ";
                    break;
                default:
                    break;
            }
        }

        if (item.Value.Type == typeof(int))
        {
            criteria += item.Key + " = " + item.Value + " ";    
        }
        else
        {
            criteria += item.Key + " = '" + item.Value + "'";
        }
    }

    string query = " from " + t;

    if (criteria != string.Empty)
        query += " where " + criteria;

    return FindByHql(query);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-18T15:25:26.043

我建议可能创建一个具有您需要的所有属性的类：

```
Name,
Value,
Type,
JoinType (possibly an enum with Or / And) 
```

然后，让您的方法采用这些类型的集合，而不是字典。这样，您可以轻松检查是否需要做和/或，以及检查是否需要报价...

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-18T15:47:37.417

我最初的想法是创建这样的东西不太明智。您正在编写生成 HQL 的代码。依次传递给生成 SQL 的 nhibernate。

我建议看看 NHibernate[标准](https://www.hibernate.org/hib_docs/nhibernate/html/querycriteria.html "标准")查询。首先作为动态构建 NHibernate 查询的更简单方法。但也让您了解滚动您自己的动态查询构建器可能有多复杂。

那就是说。如果我这样做，我可能会使用 NHibernate Criteria 作为任何类型的动态查询构建器的基础。它没有理由不能生成另一个 ORM 使用的查询。

该问题的一个更通用的解决方案是抽象您的数据访问，以便如果您想切换 ORM，那么您只需要更改抽象背后的代码。这当然是更多的工作，但我不相信保持数据访问代码 ORM 独立是特别重要的事情。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-18T15:49:06.933

那么你正在做的另一种方法是传递一个 Expression> 而不是字典，然后解析 Linq 表达式以获得你想要的。我提出的一个小建议是使用 Criteria 查询而不是 HQL。当然，解析 Linq 表达式可能比你在这里的要复杂得多。

您也许能够处理字典并制作出色的 HQL，但考虑这样做会让我头疼。标准查询似乎是为这类事情设计的。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-21T21:36:06.187

如果您要使用 Criteria API，那么已经有“通过示例查询”（又名 QBE）功能，它使用实体属性来生成查询。

请看第 12.6 节：

[https://www.hibernate.org/hib_docs/nhibernate/html/querycriteria.html](https://www.hibernate.org/hib_docs/nhibernate/html/querycriteria.html)

# c++ - 命名空间类和结构

> ID：1013291
> 
> 赞同：1
> 
> 时间：2009-06-18T15:17:40.300
> 
> 标签：c++, namespaces

我有一个看起来像这样的文件：

```
namespace myName
{
  typedef HRESULT (*PFN_HANDLE)(myName::myStruct);

  class MyClass{
  //...
  public:
    BOOL RegisterCallback (PFN_HANDLE foo);
  //...
  };

  struct myStruct{
  //...
  };
} 
```

但我收到编译错误“myStruct”不是“myName”的成员。谁能告诉我发生了什么？在我的头文件中声明一个结构是可以的，对吧？是命名空间问题吗？我很抱歉这么密集。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-06-18T15:20:48.237

您在声明之前尝试使用类型名称 myStruct。要么将整个结构定义放在 typedef 之前，要么将此声明放在 typedef 之前：

```
struct myStruct; 
```

这被称为“前向声明”。它告诉编译器稍后会有一个具有该名称的类型，但没有确切说明该类型是如何定义的。

# c# - 如何使用 TcpListener/Client 通过 tcp 发送文件？Socket异常问题

> ID：1013294
> 
> 赞同：4
> 
> 时间：2009-06-18T15:18:07.757
> 
> 标签：c#, .net, file, tcp

我正在开发一个简单的应用程序来使用 TCPListener 和 TCPClient 类通过 TCP 发送文件。这是发送文件的代码。

Stop 是一个 volatile 布尔值，有助于随时停止进程，并且 WRITE_BUFFER_SIZE 可能会在运行时更改（另一个 volatile）

```
while (remaining > 0 && !stop)
{
  DateTime current = DateTime.Now;
  int bufferSize = WRITTE_BUFFER_SIZE;
  buffer = new byte[bufferSize];
  int readed = fileStream.Read(buffer, 0, bufferSize);
  stream.Write(buffer, 0, readed);
  stream.Flush();
  remaining -= readed;
  // Wait in order to guarantee send speed
  TimeSpan difference = DateTime.Now.Subtract(current);
  double seconds = (bufferSize / Speed);
  int wait = (int)Math.Floor(seconds * 1000);
  wait -= difference.Milliseconds;
  if (wait > 10)
    Thread.Sleep(wait);
}                
stream.Close(); 
```

这是处理接收方的代码：

```
do
{
  readed = stream.Read(buffer, 0, READ_BUFFER_SIZE);
  // write to .part file and flush to disk
  outputStream.Write(buffer, 0, readed);
  outputStream.Flush();
  offset += readed;
} while (!stop && readed > 0); 
```

现在，当速度较低（大约 5KBps）时，一切正常，但是随着速度的提高，接收器大小变得更容易在从流中读取时引发 SocketException。我猜这与在读取所有数据之前关闭远程套接字有关，但是正确的方法是什么？我应该什么时候关闭发送客户端？

我没有在谷歌上找到任何好的文件传输示例，而我发现的那些与我正在做的事情有类似的实现，所以我想我错过了一些东西。

**编辑：**我收到此错误“无法从传输连接读取数据”。这是一个 IOException，其内部异常是 SocketException。

我已经在 sender 函数中添加了这个，但我仍然得到同样的错误，代码永远不会到达 stream.close()，当然 tcpclient 永远不会真正关闭......所以我现在完全迷路了。

```
buffer = new byte[1];
client.Client.Receive(buffer);
stream.Close(); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-18T15:29:25.690

通常，您希望在套接字上设置 LINGER 选项。在 C++ 下这将是 SO_LINGER，但在 Windows 下这实际上并没有按预期工作。你真的想这样做：

*   完成发送数据。
*   在 how 参数设置为 1 的情况下调用 shutdown()。
*   循环 recv() 直到它返回 0。
*   调用 closesocket()。

取自：[http ://tangentsoft.net/wskfaq/newbie.html#howclose](http://tangentsoft.net/wskfaq/newbie.html#howclose)

C# sharp 可能已经在其库中纠正了这一点，但我对此表示怀疑，因为它们是建立在 winsock API 之上的。

**编辑：**

更详细地查看您的代码。我看到你根本没有发送任何标题，所以在接收端你不知道你实际上应该读取多少字节。知道要读取的套接字的字节数使这个问题更容易调试。请记住，如果您没有正确关闭它，关闭套接字仍然可以截断最后一点数据。

此外，让您的缓冲区大小可变不是线程安全的，并且真的不会给您带来任何好处。使用 stop 作为 volatile 是安全的，但不要指望它是即时的。换句话说，循环可以在获得更新的停止值之前再运行几次。在多处理器机器上尤其如此。

**编辑_02：**

对于 TCPClientClass 您想要执行以下操作（据我所知，目前无法访问 C#）。

```
// write all the bytes
// Then do the following

client.client.Shutdown(Shutdown.Send) // This assumes you have access to this protected member
while (stream.read(buffer, 0, READ_BUFFER_SIZE) != 0);
client.close() 
```

# python - Windows错误和python

> ID：1013311
> 
> 赞同：1
> 
> 时间：2009-06-18T15:20:11.827
> 
> 标签：python, popen

我正在编写一些代码，该代码应该在我的系统上的文件夹中运行一个 exe 文件，并收到一条错误消息...

WindowsError: [错误 3] 系统找不到指定的路径。这是一些代码：

```
exepath = os.path.join(EXE file localtion)
exepath = '"' + os.path.normpath(exepath) + '"'
cmd = [exepath, '-el', str(el), '-n', str(z)]

print 'The python program is running this command:'
print cmd

process = Popen(cmd, stderr=STDOUT, stdout=PIPE)
outputstring = process.communicate()[0] 
```

我已经导入了子流程，也从子流程导入*

例如，这就是我展示的代码的第一行中我的 exe 文件位置的样子：

```
 exepath= os.path.join('/Program Files','next folder','next folder','blah.exe') 
```

我错过了什么吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-18T15:24:27.557

您需要正确转义可执行路径中的空间

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-18T15:31:21.053

除了正确转义可能导致问题的空格和其他字符（例如 /），您还可以使用 8 个字符的旧 DOS 路径。

例如，程序文件将是：

Progra~1 ，确保为最后两个字符附加 ~1 。

编辑：您可以在字符串的前面添加一个 r ，使其成为原始文字。Python 会逐个字符地读取字符串。像这样：

r "\程序文件"

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-18T15:23:54.393

如果我没记错的话，你不需要像第二行那样引用你的可执行文件路径。

编辑：好吧，只是抓住附近的 Windows 盒子并测试了它。无论路径是否被引用，Popen 的工作方式都是一样的。所以这不是问题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-18T15:28:53.070

`cmd.exe`AFAIK，除非涉及运行程序，否则无需将路径括在引号中。

此外，您可能希望使用环境变量`ProgramFiles`找出“程序文件”的实际位置，因为这取决于区域设置，也可以使用 TweakUI 进行调整。

# cocoa-touch - 如何创建 UILabel 的 NSMutableArray？

> ID：1013325
> 
> 赞同：0
> 
> 时间：2009-06-18T15:22:21.477
> 
> 标签：cocoa-touch, nsmutablearray, uilabel

我这里有问题。我正在动态创建 UILabel 以显示到 UIView 中。这是代码：

```
for (flower in flowerList)
{               

    // Create the Qty label
    CGRect rectQty = CGRectMake(x , y, 25, labelHeight);
    UILabel *flowerQuantityLabel = [[UILabel alloc] initWithFrame:rectQty];
    NSString *fQty = [[NSString alloc] initWithFormat:@"%d", flower.flowerQty];
    [flowerQuantityLabel setText:fQty];
    // Loading refrence into a array  
        // here is the problem 
    [flowersQtyLabels addObject:flowerQuantityLabel];

    // Create the name label
    CGRect rectName = CGRectMake((x+offset) , y, labelWidth, labelHeight);
    UILabel *flowerNameLabel = [[UILabel alloc] initWithFrame:rectName];
    [flowerNameLabel setText:flower.flowerName];

    y = y + 40.0;
    [self.view addSubview:flowerQuantityLabel];
    [self.view addSubview:flowerNameLabel];

} 
```

*   数组中元素的数量每次都会改变。
*   我需要重新计算“flower.flowerQty”并将结果更新到标签（flowerQuantityLabel）中。
*   我尝试将每个flowerQuantityLabel 的引用加载到 NSMuttableArray (flowersQtyLabels) 中，以便使用重新计算的结果更改其内容。
*   在 for 的末尾，数组 flowersQtyLabels 为空。我不知道问题是什么。

我希望有一个人可以帮助我。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-18T23:13:31.007

我`NSMuttableArray`没有正确初始化。

# c# - 当页面实际存在时，您何时会收到 404？

> ID：1013329
> 
> 赞同：3
> 
> 时间：2009-06-18T15:22:31.150
> 
> 标签：c#, asp.net, iis

我有一个 aspx 页面，上面有一个简单的数据绑定数据网格；一些用户得到的页面就好了。其他人得到404。如果页面有问题，我会不会收到 asp.net 错误，而不是 404？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-18T15:27:18.237

出于安全原因，IIS6 可以发送 404，而实际上结果应该是权限被拒绝或禁止。试图获得恶意访问的人不会被警告他们可能会集中精力处理的页面的存在。

我不记得这是默认配置还是需要打开。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-18T15:25:19.413

它是什么样的404？（是来自 IIS 还是来自 ASP .Net？）

如果它是 ASP .Net 404，则您的代码可能（但不太可能）抛出假 404（搜索`throw new HttpException`）

你有服务器集群吗？如果是这样，一台服务器可能有一个过期的副本。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-18T15:25:35.293

您是否有任何执行重定向的全局错误处理程序？

Global.asax 或 web.config 中的内容？

# c# - 线程中的powershell /运行空间

> ID：1013331
> 
> 赞同：2
> 
> 时间：2009-06-18T15:22:52.880
> 
> 标签：c#, multithreading, powershell

我正在运行以下代码：

```
RunspaceConfiguration config = RunspaceConfiguration.Create();
PSSnapInException warning;
config.AddPSSnapIn("Microsoft.Exchange.Management.PowerShell.Admin", out warning);
if (warning != null) throw warning;            

Runspace thisRunspace = RunspaceFactory.CreateRunspace(config);
thisRunspace.Open();

string alias = usr.AD.CN.Replace(' ', '.');
string letter = usr.AD.CN.Substring(0, 1);
string email = alias + "@" + (!usr.Mdph ? Constantes.AD_DOMAIN : Constantes.MDPH_DOMAIN) + "." + Constantes.AD_LANG;
string db = "CN=IS-" + letter + ",CN=SG-" + letter + ",CN=InformationStore,CN=" + ((char)letter.ToCharArray()[0] < 'K' ? Constantes.EXC_SRVC : Constantes.EXC_SRVD) + Constantes.EXC_DBMEL;
string cmd = "Enable-Mailbox -Identity \"" + usr.AD.CN + "\" -Alias " + alias + " -PrimarySmtpAddress " + email + " -DisplayName \"" + usr.AD.CN + "\" -Database \"" + db + "\"";
Pipeline thisPipeline = thisRunspace.CreatePipeline(cmd);
thisPipeline.Invoke(); 
```

代码在以这种方式创建的线程中运行：

```
 t.WorkThread = new Thread(cu.CreerUser);
        t.WorkThread.Start(); 
```

如果我直接运行代码（而不是通过线程），它就可以工作。

在线程中时，它会引发以下异常： ObjectDisposedException “安全句柄已关闭。” （从法语翻译）

然后我用“OpenAsync”替换了“Open”，这有助于没有得到以前的异常。但是在调用时我得到以下异常： InvalidRunspaceStateException “无法调用管道，因为它的执行状态不是打开。它的当前状态是打开。” （也从法语翻译）

我一无所知...

欢迎任何帮助！谢谢 ！！！

* * *

打开：

```
 à Microsoft.Win32.Win32Native.GetTokenInformation(SafeTokenHandle TokenHandle, UInt32 TokenInformationClass, SafeLocalAllocHandle TokenInformation, UInt32 TokenInformationLength, UInt32& ReturnLength)
   à System.Security.Principal.WindowsIdentity.GetTokenInformation(SafeTokenHandle tokenHandle, TokenInformationClass tokenInformationClass, UInt32& dwLength)
   à System.Security.Principal.WindowsIdentity.get_User()
   à System.Security.Principal.WindowsIdentity.GetName()
   à System.Security.Principal.WindowsIdentity.get_Name()
   à System.Management.Automation.MshLog.GetLogContext(ExecutionContext executionContext, InvocationInfo invocationInfo, Severity severity)
   à System.Management.Automation.MshLog.GetLogContext(ExecutionContext executionContext, InvocationInfo invocationInfo)
   à System.Management.Automation.MshLog.LogEngineLifecycleEvent(ExecutionContext executionContext, EngineState engineState, InvocationInfo invocationInfo)
   à System.Management.Automation.MshLog.LogEngineLifecycleEvent(ExecutionContext executionContext, EngineState engineState)
   à System.Management.Automation.Runspaces.LocalRunspace.OpenHelper()
   à System.Management.Automation.Runspaces.RunspaceBase.CoreOpen(Boolean syncCall)
   à System.Management.Automation.Runspaces.RunspaceBase.Open()
   à Cg62.ComposantsCommuns.ActiveDirectory.Exchange.BoitesAuxLettres.CreationBAL(User usr, IList`1 log) dans D:\Applications\Commun\Sources  .Net\COMIAD\COMIAD\Exchange.cs:ligne 141
   à Cg62.ComposantsCommuns.ActiveDirectory.ComptesUtilisateurs.CreationUser.CreerUser() dans D:\Applications\Commun\Sources  .Net\COMIAD\COMIAD\ComptesUtilisateurs.cs:ligne 199
   à System.Threading.ThreadHelper.ThreadStart_Context(Object state)
   à System.Threading.ExecutionContext.runTryCode(Object userData)
   à System.Runtime.CompilerServices.RuntimeHelpers.ExecuteCodeWithGuaranteedCleanup(TryCode code, CleanupCode backoutCode, Object userData)
   à System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   à System.Threading.ExecutionContext.Run(ExecutionContext executionContext, ContextCallback callback, Object state)
   à System.Threading.ThreadHelper.ThreadStart() 
```

使用 OpenAsync：

```
 à System.Management.Automation.Runspaces.RunspaceBase.AddToRunningPipelineList(PipelineBase pipeline)
   à System.Management.Automation.Runspaces.RunspaceBase.DoConcurrentCheckAndAddToRunningPipelines(PipelineBase pipeline, Boolean syncCall)
   à System.Management.Automation.Runspaces.PipelineBase.CoreInvoke(IEnumerable input, Boolean syncCall)
   à System.Management.Automation.Runspaces.PipelineBase.Invoke(IEnumerable input)
   à System.Management.Automation.Runspaces.Pipeline.Invoke()
   à Cg62.ComposantsCommuns.ActiveDirectory.Exchange.BoitesAuxLettres.CreationBAL(User usr, IList`1 log) dans D:\Applications\Commun\Sources  .Net\COMIAD\COMIAD\Exchange.cs:ligne 149
   à Cg62.ComposantsCommuns.ActiveDirectory.ComptesUtilisateurs.CreationUser.CreerUser() dans D:\Applications\Commun\Sources  .Net\COMIAD\COMIAD\ComptesUtilisateurs.cs:ligne 199
   à System.Threading.ThreadHelper.ThreadStart_Context(Object state)
   à System.Threading.ExecutionContext.runTryCode(Object userData)
   à System.Runtime.CompilerServices.RuntimeHelpers.ExecuteCodeWithGuaranteedCleanup(TryCode code, CleanupCode backoutCode, Object userData)
   à System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   à System.Threading.ExecutionContext.Run(ExecutionContext executionContext, ContextCallback callback, Object state)
   à System.Threading.ThreadHelper.ThreadStart() 
```

抱歉回复晚了……我有很多事情要做

* * *

升级到 Powershell 2.0，我克服了 Open 错误，但现在我在 Invoke 上有以下内容。我将命令更改为：

```
Enable-Mailbox -Identity "Aagtest Abe" -Alias Aagtest.Abe -PrimarySmtpAddress smtp.address@domain.com -DisplayName "Aagtest Abe" -Database "myDb" -DomainController adc.domain.int 
```

该命令在 powershell 中运行良好。我收到以下异常 CmdletInvocationException：“一个异常 a été levée par l'initialiseur de type pour '<Module>'。” 不知道怎么翻译。。。

堆栈跟踪 ：

```
 à Microsoft.Exchange.Data.Directory.DSAccessTopologyProvider..ctor(String machineName)
   à Microsoft.Exchange.Data.Directory.DSAccessTopologyProvider..ctor()
   à Microsoft.Exchange.Data.Directory.DirectoryServicesTopologyProvider.DiscoverConfigDC()
   à Microsoft.Exchange.Data.Directory.DirectoryServicesTopologyProvider..ctor()
   à Microsoft.Exchange.Data.Directory.TopologyProvider.InitializeInstance()
   à Microsoft.Exchange.Data.Directory.TopologyProvider.GetInstance()
   à Microsoft.Exchange.Data.Directory.ADSession.GetConnection(String preferredServer, Boolean isWriteOperation, Boolean isNotifyOperation, ADObjectId& rootId)
   à Microsoft.Exchange.Data.Directory.ADSession.GetReadConnection(String preferredServer, ADObjectId& rootId)
   à Microsoft.Exchange.Data.Directory.ADSession.IsReadConnectionAvailable()
   à Microsoft.Exchange.Configuration.Tasks.RecipientObjectActionTask`2.InternalBeginProcessing()
   à Microsoft.Exchange.Management.RecipientTasks.EnableMailbox.InternalBeginProcessing()
   à Microsoft.Exchange.Configuration.Tasks.Task.BeginProcessing()
   à System.Management.Automation.Cmdlet.DoBeginProcessing()
   à System.Management.Automation.CommandProcessorBase.DoBegin() 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-22T13:03:40.597

因此，该问题的最终答案是，如果您通过 advapi32 LogonUser 进行模拟，您将无法执行远程 Exchange powershell 命令。

就我测试而言，命令是否在线程中执行并不重要。

似乎正确的方法——对我有用的方法——是在连接到运行空间后立即进行身份验证。

至于为什么会发生这种情况......请随时告诉我！

模拟时**不得**执行此代码。

```
 IContexteRemotePowerShell crp:
        crp.ConfigurationName = "Microsoft.Exchange";
        crp.RemoteUri = "http://exhangeserver/powershell";
        crp.User = "account who has rights to do stuff on the exchange server";
        crp.Password = "its password";
        crp.Domaine = "Domain";

private static void Connect(IContexteRemotePowerShell contexte)
    {
        try
        {
            Espace = RunspaceFactory.CreateRunspace();
            Espace.Open();
        }
        catch (InvalidRunspaceStateException ex)
        {
            throw new TechniqueException(MethodBase.GetCurrentMethod(), "Error while creating runspace.", ex);
        }

        // Create secure password
        SecureString password = new SecureString();
        foreach (char c in contexte.Password)
        {
            password.AppendChar(c);
        }

        // Create credential
        PSCredential psc = new PSCredential(contexte.User, password);

        PSCommand command = new PSCommand();
        command.AddCommand("New-PSSession");
        command.AddParameter("Credential", psc);

        if (!String.IsNullOrEmpty(contexte.Serveur))
            command.AddParameter("computername", contexte.Serveur);
        if (!String.IsNullOrEmpty(contexte.RemoteUri))
            command.AddParameter("ConnectionUri", new Uri(contexte.RemoteUri));
        if (!string.IsNullOrEmpty(contexte.ConfigurationName))
            command.AddParameter("ConfigurationName", contexte.ConfigurationName);

        //// Create the session
        PowerShell powershell = PowerShell.Create();
        powershell.Commands = command;
        powershell.Runspace = Espace;
        Collection<PSObject> result = ExecuterCommande(command);

        if (result.Count != 1)
            throw new TechniqueException(MethodBase.GetCurrentMethod(),
                                            "Error while connecting.");

        // Create session variable
        command = new PSCommand();
        command.AddCommand("Set-Variable");
        command.AddParameter("Name", "ra");
        command.AddParameter("Value", result[0]);
        ExecuterCommande(command);
    }

private const string InvokeCommand = "Invoke-Command -ScriptBlock {{ {0} }} -Session $ra";

    private static string ExecuteRemoteScript(string cmd)
    {
        PSCommand command = new PSCommand();
        command.AddScript(string.Format(InvokeCommand, cmd));
        Collection<PSObject> result = ExecuterCommande(command);

        StringBuilder sb = new StringBuilder();
        foreach (PSObject obj in result)
        {
            sb.AppendLine(obj.ToString());
        }
        return sb.ToString().Trim();
    } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-09-15T14:12:02.070

你试过这个吗？

```
//set the default runspace for this thread
System.Management.Automation.Runspaces.Runspace.DefaultRunspace = runspace; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-09-28T06:47:39.940

从另一个线程调用时出现的问题是[此处](http://winterdom.com/2008/12/crashingyourprocesswithtimers)`Runspace.Open`描述的相同问题的症状。我在一个 Web 项目中遇到了完全相同的问题，我从提供请求的线程开始了一个新线程。新线程最终调用了cmdlet。`Enable-Mailbox`

就我而言，问题是 Web 请求本身在调用发生之前很久就完成了`Runspace.Open`。Web 请求与[`WindowsIdentity`](http://msdn.microsoft.com/en-us/library/system.security.principal.windowsidentity.aspx)存储在线程上的 a 相关联。身份被传递给调用`Runspace.Open`. 但是，由于处理 Web 请求的线程在此调用之前完成，因此在打开运行空间之前就已处理了身份。在调用过程中的某处`Runspace.Open`，尝试获取现在处理的身份的安全令牌（请参阅堆栈跟踪中的第一行：）`Microsoft.Win32.Win32Native.GetTokenInformation`。这失败了`ObjectDisposedException`。

有两种方法可以解决此问题：

1.  不要`Runspace.Open`从另一个线程调用。至少在调用线程完成之前`Runspace.Open`不会被调用。
2.  在调用之前确保线程上有另一个身份`Runspace.Open`。例如，您可以执行以下操作：

    ```
    Thread.CurrentPrincipal =
        new GenericPrincipal(new GenericIdentity("PSTest"), null) 
    ```

    您填写的名称`GenericIdentity`并不重要。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-04-28T22:03:50.650

谢谢你，罗纳德。即使您的回答对 OP 没有帮助，它也对我有所帮助。

我只是尝试在 Web 服务器上的 AppDomain 中启动某些东西时遇到了问题。就在这条线上：

```
ObjectHandle handle = domain.CreateInstance(_assemblyName, _className); 
```

...它因 ObjectDisposedException 而爆炸。我一辈子都想不通——AppDomain 中没有任何东西被处理，这似乎在其他服务器上工作。

我进入反汇编，看到它试图序列化线程执行上下文，其中包含的逻辑调用上下文，以及其中包含的主体，而主体就是它爆炸的对象。

事实证明，运行它的线程是在用户登录时创建的，并且 IIS 处于“模拟”模式，因此线程的当前主体是该原始用户的过期主体。

我把它放在代码周围：

```
IPrincipal oldPrincipal = Thread.CurrentPrincipal;
try
{
    Thread.CurrentPrincipal = new GenericPrincipal(
        new GenericIdentity("NetPlugins"), null);
    ObjectHandle handle = domain.CreateInstance(_assemblyName, _className);
    // unwrapping and calling code omitted
}
finally
{
    Thread.CurrentPrincipal = oldPrincipal;
} 
```

我可能不需要放回旧的主体，也可以通过在创建相关线程之前更改当前主体来解决这个问题，但是谢谢你，罗纳德：这就像一个顶部！

# entity-framework - 实体框架和 SQL Server 视图

> ID：1013333
> 
> 赞同：137
> 
> 时间：2009-06-18T15:23:02.663
> 
> 标签：entity-framework, sql-server-2005, .net-3.5, primary-key, sql-view

由于几个我无权谈论的原因，我们在 Sql Server 2005 数据库上定义一个视图，如下所示：

```
CREATE VIEW [dbo].[MeterProvingStatisticsPoint]
AS
SELECT
    CAST(0 AS BIGINT) AS 'RowNumber',
    CAST(0 AS BIGINT) AS 'ProverTicketId',
    CAST(0 AS INT) AS 'ReportNumber',
    GETDATE() AS 'CompletedDateTime',
    CAST(1.1 AS float) AS 'MeterFactor',
    CAST(1.1 AS float) AS 'Density',
    CAST(1.1 AS float) AS 'FlowRate',
    CAST(1.1 AS float) AS 'Average',
    CAST(1.1 AS float) AS 'StandardDeviation',
    CAST(1.1 AS float) AS 'MeanPlus2XStandardDeviation',
    CAST(1.1 AS float) AS 'MeanMinus2XStandardDeviation'
WHERE 0 = 1 
```

这个想法是实体框架将基于此查询创建一个实体，它确实这样做了，但它生成它时会出现一个错误，指出以下内容：

> 警告 6002：表/视图“Keystone_Local.dbo.MeterProvingStatisticsPoint”没有定义主键。已推断出密钥，并将定义创建为只读表/视图。

它决定 CompletedDateTime 字段将是这个实体的主键。

我们正在使用 EdmGen 来生成模型。有没有办法不让实体框架包含这个视图的任何字段作为主键？

* * *

## 回答 #1

> 赞同：253
> 
> 时间：2010-04-26T17:00:42.057

我们遇到了同样的问题，这是解决方案：

要强制实体框架使用列作为主键，请使用 ISNULL。

要强制实体框架不使用列作为主键，请使用 NULLIF。

一种简单的应用方法是将视图的选择语句包装在另一个选择中。

例子：

```
SELECT
  ISNULL(MyPrimaryID,-999) MyPrimaryID,
  NULLIF(AnotherProperty,'') AnotherProperty
  FROM ( ... ) AS temp 
```

* * *

## 回答 #2

> 赞同：68
> 
> 时间：2014-01-18T19:04:28.797

我能够使用设计器解决这个问题。

1.  打开模型浏览器。
2.  在图中找到视图。
3.  右键单击主键，并确保选中“实体键”。
4.  多选所有非主键。使用 Ctrl 或 Shift 键。
5.  在“属性”窗口中（如果需要，请按 F4 键查看），将“实体键”下拉菜单更改为 False。
6.  保存更改。
7.  关闭 Visual Studio 并重新打开它。我正在使用带有 EF 6 的 Visual Studio 2013，我必须这样做才能让警告消失。

我不必改变我的观点来使用 ISNULL、NULLIF 或 COALESCE 变通办法。如果您从数据库更新模型，警告将重新出现，但如果您关闭并重新打开 VS，警告就会消失。您在设计器中所做的更改将被保留，并且不受刷新影响。

* * *

## 回答 #3

> 赞同：46
> 
> 时间：2012-05-04T19:24:57.167

同意@Tillito，但是在大多数情况下，它会破坏 SQL 优化器并且不会使用正确的索引。

这对某些人来说可能很明显，但我使用 Tillito 解决方案解决了性能问题花费了数小时。假设你有这张桌子：

```
 Create table OrderDetail
    (  
       Id int primary key,
       CustomerId int references Customer(Id),
       Amount decimal default(0)
    );
 Create index ix_customer on OrderDetail(CustomerId); 
```

你的观点是这样的

```
 Create view CustomerView
    As
      Select 
          IsNull(CustomerId, -1) as CustomerId, -- forcing EF to use it as key
          Sum(Amount) as Amount
      From OrderDetail
      Group by CustomerId 
```

Sql 优化器将不使用索引 ix_customer，它将对主索引执行表扫描，但如果不是：

```
Group by CustomerId 
```

你用

```
Group by IsNull(CustomerId, -1) 
```

它将使 MS SQL（至少 2008 年）在计划中包含正确的索引。

如果

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2013-01-29T23:07:46.713

这种方法对我很有效。我对主键字段使用 ISNULL()，如果该字段不应该是主键，我使用 COALESCE()，但也应该有一个不可为空的值。此示例生成具有不可为空主键的 ID 字段。其他字段不是键，并且具有 (None) 作为它们的 Nullable 属性。

```
SELECT      
ISNULL(P.ID, - 1) AS ID,  
COALESCE (P.PurchaseAgent, U.[User Nickname]) AS PurchaseAgent,  
COALESCE (P.PurchaseAuthority, 0) AS PurchaseAuthority,  
COALESCE (P.AgencyCode, '') AS AgencyCode,  
COALESCE (P.UserID, U.ID) AS UserID,  
COALESCE (P.AssignPOs, 'false') AS AssignPOs,  
COALESCE (P.AuthString, '') AS AuthString,  
COALESCE (P.AssignVendors, 'false') AS AssignVendors 
FROM Users AS U  
INNER JOIN Users AS AU ON U.Login = AU.UserName  
LEFT OUTER JOIN PurchaseAgents AS P ON U.ID = P.UserID 
```

如果你真的没有主键，你可以通过使用 ROW_NUMBER 来生成一个被你的代码忽略的伪键来欺骗一个。例如：

```
SELECT
ROW_NUMBER() OVER(ORDER BY A,B) AS Id,
A, B
FROM SOMETABLE 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-10-07T18:54:56.900

当前的实体框架 EDM 生成器将从视图中的所有不可为空的字段创建一个复合键。为了对此进行控制，当您不希望它们成为主键的一部分时，您需要修改视图和基础表列，将这些列设置为可为空。反之亦然，正如我遇到的那样，EDM 生成的键导致数据重复问题，因此我必须将一个可为空的列定义为不可为空，以强制 EDM 中的复合键包含该列。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-06-18T15:55:19.710

看起来这是 EdmGen 的一个已知问题：http: [//social.msdn.microsoft.com/forums/en-US/adodotnetentityframework/thread/12aaac4d-2be8-44f3-9448-d7c659585945/](http://social.msdn.microsoft.com/forums/en-US/adodotnetentityframework/thread/12aaac4d-2be8-44f3-9448-d7c659585945/)

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2010-02-22T23:02:49.870

为了获得一个视图，我只需要显示*一个*主键列，我创建了第二个视图，它指向第一个视图，并使用 NULLIF 使类型可以为空。这对我有用，让 EF 认为视图中只有一个主键。

不确定这是否会对您有所帮助，因为我不相信 EF 会接受没有主键的实体。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2014-02-25T13:22:19.360

如果您不想弄乱应该是主键的内容，我建议：

1.  纳入`ROW_NUMBER`您的选择
2.  将其设置为主键
3.  在模型中将所有其他列/成员设置为非主要的

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2014-08-03T20:05:28.403

由于上述问题，我更喜欢表值函数。

如果你有这个：

```
CREATE VIEW [dbo].[MyView] AS SELECT A, B FROM dbo.Something 
```

创建这个：

```
CREATE FUNCTION MyFunction() RETURNS TABLE AS RETURN (SELECT * FROM [dbo].[MyView]) 
```

然后您只需导入函数而不是视图。

# algorithm - 多核 - 如何合并在每个核心上找到的本地数据组？

> ID：1013334
> 
> 赞同：3
> 
> 时间：2009-06-18T15:23:03.817
> 
> 标签：algorithm, multicore, mpi

我有大量分布在 3D 网格上的标量值（每个顶点一个值。）

我的目标是展示：

*   网格中值大于阈值的所有点。
*   AND 对连接的点进行分组（以简化显示。）

所以我的基本解决方案是：

1.  找到通过阈值测试的点
2.  对于每个尚未分组的点，创建一个新组并将所有连接的点递归地放入该组。

这很好，直到我开始使用多核解决方案：

*   数据集已划分为多个核心
*   每个核心都知道其他核心共享的边界点。
*   我正在使用 MPI 在内核之间进行通信。

我使用我的原始算法来查找“本地”组单个核心。

我的挑战是将“本地”组合并到全局组中。问题变得复杂的原因有很多： 相互关联的群体可以跨越许多核心边界。在一个核心上看起来独立的组可以由第二个核心上的一组连接。

提前致谢。杰夫

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-19T05:10:53.797

阈值测试可以在本地进行，因此为了简单起见，我们可以将其从讨论中删除。您想要的是有一个**分布式算法来计算图中的连接组件**。这篇论文应该非常相关：

[http://citeseerx.ist.psu.edu/viewdoc/summary?doi=10.1.1.46.1091](http://citeseerx.ist.psu.edu/viewdoc/summary?doi=10.1.1.46.1091)

# javascript - 定义全局变量 x 时让 Firebug 中断

> ID：1013346
> 
> 赞同：15
> 
> 时间：2009-06-18T15:24:30.367
> 
> 标签：javascript, debugging, firefox, scope, firebug

我们有一个非常大的 JavaScript 应用程序，经过几个月的编码后，不可避免地出现了一些范围失误，其中定义了一个变量而不使用`var`以下方式的关键字：

```
function() {  
  x = 5; ...  
} 
```

代替：

```
function() {  
  var x = 5; ...  
} 
```

这发生在某个地方——我们不确定在哪里——而且搜索有问题的变量名很困难，因为它是一个常见的词，在我们的源代码中出现了 1000 次。

有没有办法让 Firebug 在首先创建给定全局变量的行上中断？为了澄清，我想在`window.x`切换`undefined`到定义值的瞬间中断，并中断语句。

我已经尝试创建一个监视表达式，并希望我可以将它变成一个断点，但我似乎无法在没有某种上下文或范围的情况下创建监视表达式。

如果这在 Firebug 上是不可能的，我会对任何可以在 Firefox 中实现这一点的东西感兴趣。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-06-18T15:38:15.470

提供了一些东西

1.  你知道变量名
2.  您在全局范围内没有具有该名称的变量（在函数外部声明），而只有在函数内部。
3.  有对声明变量的函数的调用。

这个小脚本可以解决问题：

```
<script type="text/javascript">
window.__defineSetter__("x", function(value) { console.trace(); });
x = 1;
</script> 
```

您将在分配之前获得执行代码的跟踪。

它可能无法报告某些情况，因此请查看[JSLint](http://www.jslint.com/)。在那里加载所有 JS 文件并对其进行 lint。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-18T18:38:03.467

这是我通过修改 Ionut G. Stan 的解决方案最终使用的解决方案：

```
window.__defineSetter__("name", function(value) {
  if (value=="div") {
    debugger;
  }
}); 
```

我用`debugger`了代替`console.trace()`，所以我可以在执行过程中停下来看看它。由于`console.trace()`这条线执行了很多次，我得到了无数的跟踪语句。

泄漏的作用域原来隐藏在 Dojo 中，Dojo 在其中将该变量设置为已处理元素的名称。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-29T14:00:50.497

这是另一种仅适用于 Firefox 的解决方案，因为它使用 Firefox 特定的[`watch`](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Object/watch)方法。

将这段 Javascript 放在 html 页面的最顶部，就在`<head>`标签之后：

```
<script>
window.watch('x', function() { debugger });
</script> 
```

请注意，`watch`适用于任何 Javascript 对象（`window`是全局 Javascript 对象）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-19T11:46:28.253

在 SeaMonkey 浏览器（我使用 1.1.16 版）上查看您的网页并查看错误控制台，您将看到每次分配给未声明变量的此类消息：

```
Warning: assignment to undeclared variable x
Source File: http://....js
Line: ## 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-05-31T08:57:14.507

除了调试之外，我建议使用[JSLint](http://jslint.com/)检查您的代码，它会将全局范围内的意外分配报告为错误。

有几个 jslint 的命令行包，例如[jslint4java](https://code.google.com/p/jslint4java/)，可以在[Ant 构建脚本](http://addyosmani.com/blog/client-side-build-process/)中跨平台使用。

# database - Oracle 多模式聚合实时视图

> ID：1013351
> 
> 赞同：2
> 
> 时间：2009-06-18T15:26:20.783
> 
> 标签：database, database-design, architecture, oracle-apex

全部，

寻找一些关于我目前正在尝试评估的 Oracle 设计决策的指导：

**问题**

我在同一个 oracle 数据库服务器上的三个不同模式中有数据。我正在寻找一个应用程序来显示来自所有三个模式的数据，但是显示的数据将基于应用于全局数据的实时排序和优先级规则（即：基于应用的优先级权重我可能从三个模式中的任何一个中拉回数据）。

**暂定解决方案**

在数据库中创建一个视图，它维护三个模式中相关列的逻辑链接，编写一个接受参数化优先级权重的存储过程。应用程序随后调用存储过程以从视图中选择“优先”行，然后根据返回的行直接查询关联的架构以获取其他数据。

我担心在执行每个查询时对数据进行排序/优先级排序的性能，但由于优先级规则会经常更改，因此无法解决此问题。我们谈论的是每个模式 2-3 百万行的数据集。

有没有人对如何提供数据的聚合和排序视图有其他建议？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-18T15:33:21.720

从多个模式（甚至[多个数据库](http://it.toolbox.com/blogs/oracle-guide/database-links-a-definition-in-plain-english-7023)）进行查询并不是什么大问题，即使在同一个查询中也是如此。只需在表名前面加上您感兴趣的模式，如

```
SELECT SOMETHING
FROM
  SCHEMA1.SOME_TABLE ST1, SCHEMA2.SOME_TABLE ST2
WHERE ST1.PK_FIELD = ST2.PK_FIELD 
```

如果性能成为问题，那么这是一个大话题……优化查询计划、索引和您的数据库连接方法都可以发挥作用。想到的一件事是，如果它不必是实时的，那么您可以使用[物化视图（又名“快照”）](http://download.oracle.com/docs/cd/B10501_01/server.920/a96567/repmview.htm)将数据缓存在一个地方。然后你可以以合理的性能查询它。

只需将快照设置为以适合您需要的间隔刷新即可。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-08-19T22:32:57.187

数据来自 3 个模式并不重要，真的。重要的是要知道数据更改的频率、标准更改的频率以及查询的频率。

如果有一组有限的标准（即，将以有限的方式查看数据）每隔几天就会更改一次并且会被疯狂地查询，那么您可能应该查看物化视图。

如果标准几乎是无限的，那么创建物化视图就没有意义了，因为它们不太可能被重用。如果标准本身变化非常频繁，情况也是如此，在这种情况下，物化视图中的数据也无济于事。

另一个未回答的问题是源数据的更新频率，以及拥有最新信息的重要性。频繁更新的源日期可能意味着物化视图将在一段时间内“陈旧”，或者您可能会花费大量时间不必要地刷新物化视图以保持数据“新鲜”。

老实说，考虑到足够的硬件，2-3 百万条记录对于 Oracle 来说已经不算多。在尝试花哨的（物化）视图之前，我可能会先对简单的动态查询进行基准测试。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-08-20T08:47:04.067

正如其他人所说，在 Oracle 中查询几百万行并不是一个真正的问题，但这取决于您执行此操作的频率 - 每十分之一秒可能会导致数据库服务器上的一些负载！

如果没有更多的业务需求细节和良好的数据模型，总是很难提供好的性能想法。它通常归结为提出一个理论，然后针对您的数据库尝试它并访问它是否“足够快”。

您可能还需要退后一步，问问自己结果需要多准确。企业是否真的需要此查询的准确值或可以接受的良好估计

Tom Kyte（Ask Tom 成名）在这些领域总是有一些有趣的想法（和实际事实）。[本文描述了生成正确的动态搜索查询 - 但 Tom 指出，当您查询 Google 时，它​​从不会尝试获取查询的准确命中数 - 它会给您一个猜测](http://asktom.oracle.com/pls/asktom/f?p=100:11:0::::P11_QUESTION_ID:127412348064#5339362301235)。如果您可以应用良好的估计，那么您可以真正提高查询性能时间

# c# - 如何检查机器类型？笔记本电脑还是台式机？

> ID：1013354
> 
> 赞同：16
> 
> 时间：2009-06-18T15:27:22.840
> 
> 标签：c#, wmi

如何查看当前机器类型？笔记本电脑还是台式机？

我从[http://blog.csdn.net/antimatterworld/archive/2007/11/11/1878710.aspx](http://blog.csdn.net/antimatterworld/archive/2007/11/11/1878710.aspx)得到这个，它在我的家用机器上运行良好（笔记本电脑上的 Win2003），它返回“便携式”，但失败了我的工作机器（笔记本电脑上的 Vista），它返回“其他”。

这是代码：

```
 public enum ChassisTypes
{
    Other = 1,
    Unknown,
    Desktop,
    LowProfileDesktop,
    PizzaBox,
    MiniTower,
    Tower,
    Portable,
    Laptop,
    Notebook,
    Handheld,
    DockingStation,
    AllInOne,
    SubNotebook,
    SpaceSaving,
    LunchBox,
    MainSystemChassis,
    ExpansionChassis,
    SubChassis,
    BusExpansionChassis,
    PeripheralChassis,
    StorageChassis,
    RackMountChassis,
    SealedCasePC
}

public static ChassisTypes GetCurrentChassisType()
{
    ManagementClass systemEnclosures = new ManagementClass("Win32_SystemEnclosure");
    foreach (ManagementObject obj in systemEnclosures.GetInstances())
    {
        foreach (int i in (UInt16[  ])(obj["ChassisTypes"]))
        {
             if (i > 0 && i < 25)
            {
                return (ChassisTypes)i;
            }
        }
    }
    return ChassisTypes.Unknown;
} 

```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-06-18T15:53:47.137

这是一篇不错的 Microsoft 文章，建议查看其他一些 WMI 类，以更好地了解计算机是笔记本电脑还是台式机：
[http://technet.microsoft.com/en-us/library/cc180825.aspx](http://technet.microsoft.com/en-us/library/cc180825.aspx)

```
Win32_SystemEnclosure, ChassisTypes(1)=10
Win32_Battery or Win32_PortableBattery
Win32_PCMCIAController
Win32_DriverVXD.Name = "pccard"
Win32_ComputerSystem.Manufacturer
Win32_ComputerSystem.Model 
```

它还建议在注册表中查找电源方案。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2011-02-01T23:14:16.530

好吧，我可能想在这里复活死者，但我建议确定笔记本电脑的最可靠方法是提供盖子状态开关。请参阅[GetPwrCapabilities](http://msdn.microsoft.com/en-us/library/aa372691%28v=vs.85%29.aspx) 和[System_power_Capabilities](http://msdn.microsoft.com/en-us/library/aa373215%28v=vs.85%29.aspx)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2011-08-31T07:00:41.773

不需要同时进行**Other**和**Unknown**检查。

将条件更改为 `i > 1 && i < 25`并记住`ChassisTypes`是一个数组，操作系统返回他认为您的系统是什么。

可以匹配多个类型。您的代码仅返回第一个匹配项。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-06-18T15:38:34.767

我很确定这将取决于制造商是否费心在当前芯片组上提供该数据。如果他们没有，那么“其他”是你能做的最好的。

[看看这篇有点相关的文章](https://blogs.msdn.microsoft.com/oldnewthing/20081218-00/?p=19783)，它也建议[直接查询 BIOS](http://www.codeguru.com/cpp/misc/misc/tools/article.php/c12347#Sample)。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-06-18T15:41:07.400

请参阅[http://www.microsoft.com/technet/scriptcenter/resources/qanda/sept04/hey0921.mspx](http://www.microsoft.com/technet/scriptcenter/resources/qanda/sept04/hey0921.mspx)和[http://msdn.microsoft.com/en-us/library/aa387204(VS.85).aspx](http://msdn.microsoft.com/en-us/library/aa387204(VS.85).aspx)指出：

> 本文档源自 DMTF 发布的 CIM 类描述。

据推测，这意味着制造商必须为 Windows 提供一些信息才能发现它。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-06-18T15:53:10.710

我认为对此没有明确的正确答案，我发现 WMI 对此不可靠，但我一直在使用 Win32 函数 GetSystemPowerStatus() 来确定是否有系统电池，显然是系统电池 == 便携式计算机。

不过，我从来没有在带 UPS 的台式机上尝试过这个？！

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2016-01-22T10:11:43.230

为了检查机器是笔记本电脑还是台式机，您可以尝试使用 SystemPowerCapabilites.LidPresent 或两者来检查电池状态。

电池：

```
if(SystemInformation.PowerStatus.BatteryChargeStatus ==BatteryChargeStatus.NoSystemBattery){
  //desktop 
}
else{
  //laptop
} 
```

SystemPowerCapabilites.LidPresent：

```
public SYSTEM_POWER_CAPABILITIES getSystemPowerCapabilites(){
{
    SYSTEM_POWER_CAPABILITIES systemPowerCapabilites;
    GetPwrCapabilities(out systemPowerCapabilites);
    return systemPowerCapabilites;
}

getSystemPowerCapabilites().LidPresent; 
```

GetPwrCapabilities 定义：[http ://www.pinvoke.net/default.aspx/powrprof/GetPwrCapabilities.html](http://www.pinvoke.net/default.aspx/powrprof/GetPwrCapabilities.html)

* * *

## 回答 #8

> 赞同：-3
> 
> 时间：2009-07-13T02:33:54.477

从 HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\pcmcia 读取注册表项，'Start' 值，如果 start = 0 则为笔记本电脑，否则如果 start 不存在或 start != 0 则为台式机。

# wpf - WPF 数据绑定 CheckBox.IsChecked

> ID：1013358
> 
> 赞同：7
> 
> 时间：2009-06-18T15:27:48.207
> 
> 标签：wpf, data-binding, checkbox

如何将 CheckBox 的 IsChecked 成员绑定到表单中的成员变量？

（我意识到我可以直接访问它，但我正在尝试了解数据绑定和 WPF）

以下是我尝试使其正常工作的失败尝试。

XAML：

```
<Window x:Class="MyProject.Form1"
xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
Title="Title" Height="386" Width="563" WindowStyle="SingleBorderWindow">
<Grid>
    <CheckBox Name="checkBoxShowPending" 
              TabIndex="2" Margin="0,12,30,0" 
              Checked="checkBoxShowPending_CheckedChanged" 
              Height="17" Width="92" 
              VerticalAlignment="Top" HorizontalAlignment="Right" 
              Content="Show Pending" IsChecked="{Binding ShowPending}">
    </CheckBox>
</Grid>
</Window> 
```

代码：

```
namespace MyProject
{
    public partial class Form1 : Window
    {
        private ListViewColumnSorter lvwColumnSorter;

        public bool? ShowPending
        {
            get { return this.showPending; }
            set { this.showPending = value; }
        }

        private bool showPending = false;

        private void checkBoxShowPending_CheckedChanged(object sender, EventArgs e)
        {
            //checking showPending.Value here.  It's always false
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-06-18T15:37:40.713

```
<Window ... Name="MyWindow">
  <Grid>
    <CheckBox ... IsChecked="{Binding ElementName=MyWindow, Path=ShowPending}"/>
  </Grid>
</Window> 
```

请注意，我添加了一个名称`<Window>`，并更改了 CheckBox 中的绑定。[`DependencyProperty`](http://msdn.microsoft.com/en-us/library/system.windows.dependencyproperty.aspx)如果您希望它能够在更改时更新，您还需要实现 ShowPending 。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2010-10-08T16:53:32.047

@Will 答案的附录：这`DependencyProperty`可能是您的样子（使用[WPF 博士的片段](http://drwpf.com/blog/2007/11/17/my-wpf-code-snippets/)创建）：

```
#region ShowPending

/// <summary>
/// ShowPending Dependency Property
/// </summary>
public static readonly DependencyProperty ShowPendingProperty =
    DependencyProperty.Register("ShowPending", typeof(bool), typeof(MainViewModel),
        new FrameworkPropertyMetadata((bool)false));

/// <summary>
/// Gets or sets the ShowPending property. This dependency property 
/// indicates ....
/// </summary>
public bool ShowPending
{
    get { return (bool)GetValue(ShowPendingProperty); }
    set { SetValue(ShowPendingProperty, value); }
}

#endregion 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-02-03T09:21:28.627

您必须将绑定模式设置为 TwoWay ：

```
<Checkbox IsChecked="{Binding Path=ShowPending, Mode=TwoWay}"/> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-05-19T15:44:53.683

如果您只有一个控件要绑定到代码隐藏的属性，则可以通过如下方式将其指定为绑定中的源`RelativeSource`：

```
<CheckBox ...
IsChecked="{Binding ShowPending, RelativeSource={RelativeSource Mode=FindAncestor, AncestorType={x:Type Window}}}"> 
```

* * *

这可能是答案的结尾。但更一般地说，您将拥有多个控件并希望将它们绑定到您的类上的各种属性。在这种情况下，利用属性（这是数据绑定的默认源对象）通过控件层次结构向下继承这一事实更加简洁和方便`DataContext`，因此将其设置在顶层将使其对所有人可用孩子控制。

没有默认值`DataContext`，但至少有两种方法可以将`DataContext`Window 元素的属性设置为指向自身：

*   通过`DataContext = this`在代码隐藏构造函数中设置。这非常简单，但有些人可能会争辩说，在 XAML 中并不清楚 DataContext 指向的位置。
*   通过`DataContext`使用 DataBinding 在 XAML 中设置

在 XAML 中的 Window/UserControl 级别设置 DataContext 的最简单且我认为最优雅的方法非常简单；只需添加`DataContext="{Binding RelativeSource={RelativeSource Self}}"`到您的`Window`元素。 `RelativeSource Self`只是意味着“直接绑定到对象”，在这种情况下就是`Window`对象。缺少`Path`属性会导致默认值`Path`，即源对象本身（即 Window）。

```
<Window x:Class="MyProject.Form1"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    DataContext="{Binding RelativeSource={RelativeSource Self}}">
    <Grid>
        <CheckBox ... 
            IsChecked="{Binding ShowPending}">
        </CheckBox>
    </Grid>
</Window> 
```

完成此操作后，`DataContext`所有子控件的属性都将成为`Window`类，因此数据绑定到代码隐藏中的属性将很自然。

如果由于某种原因您不想`DataContext`在 Window 上设置 ，但希望将其设置在控件层次结构的较低位置，那么您可以使用该`FindAncestor`机制来实现。例如，如果你想在 Grid 元素和 Grid 的所有子元素上设置它：

```
<Grid DataContext="{Binding RelativeSource={RelativeSource Mode=FindAncestor, AncestorType={x:Type Window}}}">
    <CheckBox ...
          IsChecked="{Binding ShowPending}">
    </CheckBox>
</Grid> 
```

在这一点上可能值得注意的是，到目前为止，我们已经实现了将 UI 控件绑定到代码隐藏类的属性的能力，并且该代码隐藏属性随着对用户界面元素。因此，如果用户选中 CheckBox，则该`ShowPending`属性将被更新。

但很多时候你也希望反过来是真的；对源属性的更改应反映在 UI 控件的相应更改中。您可以通过将另一个 CheckBox 控件添加到您的窗口并绑定到相同的`ShowPending`属性来看到这一点。当您单击一个复选框时，您可能希望或期望另一个复选框被同步，但它不会发生。为了实现这一点，您的代码隐藏类应该（a）实现[`INotifyPropertyChanged`](https://docs.microsoft.com/en-us/dotnet/framework/winforms/how-to-implement-the-inotifypropertychanged-interface)，（b）添加`ShowPendingChanged`事件或（c）创建`ShowPending`一个[依赖属性](https://docs.microsoft.com/en-us/dotnet/framework/wpf/advanced/dependency-properties-overview "依赖属性")。在这 3 个中，我建议`INotifyPropertryChanged`在您的代码隐藏上实现是最常见的机制。

# iphone - iPhone：检索“文档”目录的内容

> ID：1013365
> 
> 赞同：1
> 
> 时间：2009-06-18T15:29:03.460
> 
> 标签：iphone, cocoa-touch

是否有任何开发工具可以访问 iPhone 上“文档”目录的内容？

我想访问由我的应用程序创建的 SQLITE 数据库以修复一些错误。

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-18T15:39:15.250

在 Xcode 中，拉起 Window>Organizer。点击你的手机。在应用程序列表中，对于您的应用程序（使用 Xcode 安装的），将有一个可用的“下载”按钮，该按钮将拉取应用程序的整个主目录。

# ios - 球击球时改变角度

> ID：1013367
> 
> 赞同：1
> 
> 时间：2009-06-18T15:29:13.960
> 
> 标签：ios, objective-c, iphone, cocoa-touch, uiimageview

我想根据球击中桨的位置以一定角度偏转球。现在，我只改变 y 坐标，这会导致无意义的偏转。它会倾斜，但与桨的撞击位置无关。我想要更有趣的东西。速度、动量、质量和其他因素不需要考虑。只是角度取决于桨的撞击位置。我已经阅读[过在 iphone 应用程序中进行碰撞检测的 Not a number error (NAN)，](https://stackoverflow.com/questions/656002/not-a-number-error-nan-doing-collision-detection-in-an-iphone-app)但对于我正在寻找的内容来说似乎过于复杂。有没有更简单的方法来计算偏转？

对象是两个 UIImageViews。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-18T15:56:40.587

好吧，没有什么现实的，但你可以做一些事情，使出站角度仅取决于它击中桨的位置。

我从来没有做过任何 iPhone 或客观的 C 编码，所以我只会用伪/C 代码写一些东西。

首先我会计算速度，即速度向量的长度，或者：

```
double speed = sqrt(velX * velX + velY * velY); // trigonometry, a^2 + o^2 = h^2 
```

然后我们想根据我们击球的位置来计算新的角度。我将假设您将 X 碰撞存储在 ImpactX 中，并将桨的长度存储在 paddleLength 中。这样我们就可以计算出外角。首先让我们弄清楚如何计算范围，以便我们得到一个介于 -1 和 1 之间的值。

```
double proportionOfPaddle = impactX / (double) paddleLength; // between 0 and 1
double impactRange = proportionOfPaddle * 2 - 1; // adjust to -1 and 1 
```

假设我们不想将球完全偏向一边，或 90 度，因为这很难恢复。由于我将使用 ImpactRange 作为新的 velY，因此我将其缩小到 -0.9 到 0.9。

```
impactRange = impactRange * 0.9; 
```

现在我们需要计算 velX 以使速度保持不变。

```
double newVelX = impactRange;
double newVelY = sqrt(speed * speed - newVelX * newVelX); // trigonometry again 
```

现在你返回 newVelX 和 newVelY 并且你有一个影响和速度依赖的反弹。

祝你好运！

（很可能是这里的错误，我可能已经颠倒了 X 或 Y，但我希望你能得到大致的想法）。

*编辑*：添加一些关于获得 ImpactX 的想法。

假设你有 ball.center.x 和 paddle.center.x （不知道你怎么称呼它，但让我们假设 paddle.center.x 会给我们桨的中心）我们应该能够从中计算影响范围。

我们还需要球半径（我假设 ball.width 作为直径）和桨大小（paddle.width？）。

```
int ballPaddleDiff = paddle.center.x - ball.center.x;
int totalRange = paddle.width + ball.width; 
```

ballPaddleDiff 的最小值是当球刚刚接触到球拍的一侧时。那 ballPaddleDiff 将是 paddle.width/2 + ball.width/2。因此，新的 ImpactRange 将是

```
double impactRange = ballPaddleDiff / (double) totalRange / 2; 
```

您可能应该检查impactRange 以便它实际上在-1 和1 之间，这样球就不会射向星星或其他东西。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-18T15:43:06.617

你不一定想要现实，你想要乐趣。这些并不总是相同的。如果你想要逼真，你不能丢掉速度、动量、质量等。在正常的乒乓球比赛中，击球点并不重要，没有网球拍上的甜蜜点.

开发一个数学函数，该函数将返回一个输出向量，或一个速度和一个单位向量，表示球的输出角度和速度，给出输入角度、速度、球拍上的撞击点和球拍的速度。

我们已经期望输出角度 = -1 * 输入角度。输出速度也应为 -1 * 输入速度。因此，如果您想混合使用，请调整它们。您可以增加与桨中心距离成比例的输出角度。您还可以增加与桨击中时的速度成比例的角度或速度。

有很多方法可以做到这一点，所以我不能准确地告诉你你会使用什么功能，你必须通过测试和玩来弄清楚。如果您仍需要更多信息，请为您的问题添加更多细节。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-19T09:44:57.860

以下代码（C++，但很容易转换为 ObjC），采用传入的 2D 向量并根据表面法线（乒乓球的面）反射它。

您可以通过随机化一个偏移量来添加一些随机的“有趣因素”，该偏移量可以应用于“标量”——以改变速度，或应用于表面法线，以改变反射角。

我在我的 iPhone 项目中使用它，它工作正常 :)

```
void vec2ReflectScalar(vec2& vResult, const vec2& v1, const vec2& normal, float scalar)
{
    vec2  _2ndotvn;
    float dotVal = vec2DotProduct(v1, normal); 

    vec2Scale(_2ndotvn, normal, scalar * 2.f * dotVal);
    vec2Subtract(vResult, v1, _2ndotvn); 
}

void vec2Reflect(vec2& vResult, const vec2& v1, const vec2& normal)
{
    vec2ReflectScalar(vResult, v1, normal, 1.f);
} 
```

# javascript - 如果父窗口关闭，如何关闭子窗口？

> ID：1013368
> 
> 赞同：4
> 
> 时间：2009-06-18T15:29:17.143
> 
> 标签：javascript, windows, browser

我有一个弹出另一个窗口的 Web 应用程序。
如果此人关闭主浏览器窗口，我也需要关闭子窗口。

这可能吗？如果是这样，怎么做？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-18T23:16:44.540

当您调用 window.open() 时，返回值是创建的新窗口的句柄。使用它，您可以保留已打开的窗口数组，然后在 unload 事件处理程序中对它们调用 close：

```
var win = winodw.open(URL, title, options);
window.MyOpenWindows.push(win); 
```

稍后，在为卸载事件注册的函数中：

```
function closeWindows(){
    for (i=0;i<window.MyOpenWindows.length;i++)
    {
        window.MyOpenWindows[i].close();
    }
} 
```

# asp.net - 在 ASP.NET 中使用 Visual Studio 和 TFS 中的引用

> ID：1013374
> 
> 赞同：0
> 
> 时间：2009-06-18T15:30:31.507
> 
> 标签：asp.net, visual-studio, tfs

我是第一次使用 Team Foundation Server 和 Visual Studio 2008。我有一个使用 Visual Web Developer Express 完成的网站项目，我已将其转换为包含 Web 应用程序项目、TFS 源代码控制设置等的解决方案。

TFS 在签入/上传我引用的一些 DDL（特别是 AjaxControlToolKit）时遇到问题，说找不到 /bin/AjaxControlToolKit.pdb 之类的东西。我删除了引用，删除了 /bin 中的所有内容（它创建了很多文件夹，如 /ar、/cs、/de 等以及 /bin/AjaxControlTookKit.dll 等其他文件），然后重新添加了引用到 AjaxControlToolKit。它现在将上传，并且在本地可以正常工作，但它没有在 /bin 中重新创建任何内容。我有其他可以正常工作的参考资料，并且在 /bin 中有信息（即：/References/LinqKit.dll 和 /bin/LinqKit.dll） 我还不能在服务器上进行构建，但在本地它可以工作。那么，当它建立在服务器上时，它会起作用吗？为什么没有 它会在 /bin 文件夹中重新创建任何内容吗？这与 Visual Web Developer 网站与 Visual Studio Web 应用程序/解决方案有关吗？任何信息表示赞赏！谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-18T21:57:36.790

引用是*引用*，而不是程序集的副本。您要使用的程序集在哪里？

通常，您需要签入您未维护源代码的第三方程序集。然后，您需要更改文件引用以指向源代码管理中的版本。

当然，这意味着您的所有开发人员和构建机器都需要在磁盘上维护相同的文件夹结构。

# c++ - 好的在线 C++ 语法参考？

> ID：1013375
> 
> 赞同：10
> 
> 时间：2009-06-18T15:30:35.313
> 
> 标签：c++, syntax

您知道精确而简洁的在线 C++ 语法参考吗？请提供链接...

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-06-18T15:33:16.743

[cppreference.com](http://www.cppreference.com/wiki/)

微软具体[参考](http://msdn.microsoft.com/en-us/library/3bstk3k5.aspx)。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-06-18T17:25:12.740

[http://www.parashift.com/c++-faq-lite/](http://www.parashift.com/c++-faq-lite/)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-06-18T15:34:19.083

鉴于 C++ 的复杂性，我认为不可能有简明的 C++ 语法参考。:) 对于不太简洁的参考，请看[这里](http://www.cplusplus.com)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-06-18T15:34:18.693

[http://www.cprogramming.com/reference/](http://www.cprogramming.com/reference/)

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-06-18T15:35:25.787

我最喜欢的肯定是[http://www.grepdocs.com/](http://www.grepdocs.com/)因为它也提供其他语言，但对于特定的 c++ 参考，我前往[http://www.cppreference.com/wiki/](http://www.cppreference.com/wiki/)

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-06-18T15:34:20.657

[http://cplusplus.com/](http://cplusplus.com/)是一个很好的 C/C++ 在线参考，我不确定这是否是您所追求的。

它对标准库有很好的覆盖。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-06-18T15:35:06.943

有一堆。我经常使用这些。

[cplusplus.com](http://www.cplusplus.com/reference/)和[cppreference.com](http://www.cppreference.com/wiki/)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-06-18T15:33:09.850

尝试[http://www.cplusplus.com/reference/](http://www.cplusplus.com/reference/)作为图书馆。

尝试[http://www.kuzbass.ru:8086/docs/isocpp/](http://www.kuzbass.ru:8086/docs/isocpp/)获取 C++98 国际标准最终草案。

尝试[http://www.open-std.org/JTC1/SC22/WG21/docs/papers/2008/n2798.pdf](http://www.open-std.org/JTC1/SC22/WG21/docs/papers/2008/n2798.pdf)获取 C++0X 工作草案标准。

# windows-mobile - 是否有任何 Windows Mobile 客户端/服务器文件同步 API？

> ID：1013376
> 
> 赞同：2
> 
> 时间：2009-06-18T15:30:38.137
> 
> 标签：windows-mobile, mobile, synchronization, windows-ce, activesync

MS 有一个很好的文件/目录同步框架，称为 Windows.Synchronization.Files，但它不适用于 Mobile！有谁知道在 Windows Mobile 上获得此功能的标准方法是什么？我知道 ActiveSync 允许您传输和同步文件，但到目前为止我还没有找到他们用于此目的的 API。它是开放的还是只是 ActiveSync 服务的闭源部分？

试图避免滚动我自己。:)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-18T18:06:30.147

试用新的[Microsoft Sync Framework](http://msdn.microsoft.com/en-us/sync/default.aspx)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-19T05:23:54.857

同步很难。所以我想说你最好的选择是使用 Microsoft Sync Framework（正如 Rui 在他的帖子中所说）并编写你自己的文件同步提供程序。然后，您可以在以后使用更新的 v2 同步框架来替换它。

其他选项可能是：

*   自己滚。如果您不关心同步的棘手问题，那么这可能是一种快速简便的方法。
*   使用基于[OMA](http://www.openmobilealliance.org/)的[SyncML](http://en.wikipedia.org/wiki/SyncML)客户端，例如[Funambol](http://www.funambol.com/) [Windows Mobile 客户端](https://www.forge.funambol.org/download/)（我认为它支持文件，但我已经有一段时间没有看过了）。很好的是，Funambol 代码都是开源的。它可以更容易地集成到您自己的产品中。如果您进行谷歌搜索，那么您应该能够找到许多基于 SyncML 的客户端。

# javascript - 源函数未加载到当前文件中

> ID：1013377
> 
> 赞同：-1
> 
> 时间：2009-06-18T15:30:39.557
> 
> 标签：javascript, html

```
<script language="JavaScript1.2" src="aj.js"> 
```

我正在为我的图像加载事件调用函数 a()。但我收到错误 - 函数 a() [a.js has function] 未定义。

如何解决此问题

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-18T15:34:03.653

添加结束脚本标记。此外，mime 类型比几乎每个浏览器都会忽略的“语言”属性更重要。

```
<script type="text/javascript" language="JavaScript" src="aj.js"></script> 
```

当然，这假设您的`src`点指向正确的位置。

# sql - SQL Server 复制数据库后速度变慢

> ID：1013378
> 
> 赞同：2
> 
> 时间：2009-06-18T15:30:49.777
> 
> 标签：sql, sql-server, database, performance

由于数据库变得相当大，我最近将一堆表从现有数据库移到了新数据库中。这样做之后，我注意到在针对新数据库运行时，我的查询性能急剧下降。

**我重新创建新数据库的过程是这样的：**

1.  使用 sql server 自动脚本
    生成器生成表 CREATE 脚本。
2.  运行创建表脚本
3.  使用 INSERT INTO 将所有数据插入到新数据库中，并从现有数据库中进行选择。
4.  运行所有修改脚本以创建外键和任何索引

**是否有人对我的流程可能存在的问题有任何想法，或者我缺少导致此性能问题的某些关键步骤？**

谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-18T15:33:47.460

首先，我至少要确保启用了**自动创建统计信息**，您还可以将**自动更新统计信息**设置为 true

之后我会通过运行更新统计信息

```
sp_updatestats 
```

或者

```
UPDATE STATISTICS 
```

还要意识到，第一次点击查询时它会变慢，因为没有任何东西会缓存在 RAM 中。第二击应该快得多

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-06-18T15:34:45.697

您是否从原始数据库中的表中编写了索引？缺少索引肯定会导致性能不佳。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-06-18T17:15:23.313

在运行这些查询时，您是否尝试过查看每台服务器上的执行计划 - 这应该可以让您轻松查看它们是否正在执行不同的操作，例如由于缺少索引、统计信息不佳等导致的表扫描。

两个数据库是否位于同一个盒子上，它们的数据文件位于同一个驱动器阵列上？

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-06-18T16:13:26.347

你能说出*那些*查询变慢的原因吗？新的访问计划？相同的计划，但执行速度较慢？他们*执行*得更慢还是*暂停*更多？*是所有*查询都变慢了还是只有一些？最后但并非最不重要的一点是，*你怎么知道*，即。你到底测量了什么以及如何测量？

一些常见的嫌疑人可能是：

*   新的存储速度要慢得多（慢速磁盘上的.mdf，或繁忙的磁盘上）
*   您在移动期间更改了数据结构（即某些索引没有被移植）
*   您更改了数据大小（即压缩选项），导致相同数据的页面更多
*   是否同时发生了其他任何变化，新的应用程序代码或类似的东西？
*   通过扩展数据大小（您没有提到*删除*旧表），您现在正在破坏缓冲池（性能计数器中的页面寿命预期是否降低了？）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-18T15:33:14.153

查看您如何设置初始大小和增长选项。如果您一开始就没有给它足够的空间，或者您一次增长 1MB，这可能会导致性能问题。

# c# - 一个应用程序如何访问另一个应用程序设置的环境变量？

> ID：1013383
> 
> 赞同：4
> 
> 时间：2009-06-18T15:32:03.890
> 
> 标签：c#, environment-variables, environment

在这种情况下，设置环境变量的应用程序在/从需要访问 env.var 的应用程序中执行。[Main() 返回值（C# 编程指南）](http://msdn.microsoft.com/en-us/library/0fwzzxz2(VS.80).aspx) msdn 文章讨论了它在批处理文件中的使用。如果我尝试相同，一切都很好；但需要的不是从批处理脚本运行，而是从应用程序内部运行。

```
Process.Start("app","args"); // app sets the env.var.
string envVar = System.Environment.GetEnvironmentVariable("ERRORLEVEL"); 
```

显然是不成功的。我相信 Process.Start 使“应用程序”在完全不同的环境中工作。换句话说，我需要在与调用者应用程序相同的环境中运行“app”，才能访问它设置的环境变量。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-06-18T19:12:00.900

如果您只是想从父母那里设置孩子的环境：

```
var p = new Process();
p.StartInfo.EnvironmentVariables["TEST_ENV"] = "From parent";
p.StartInfo.UseShellExecute = false;
p.StartInfo.FileName = @"C:\src\bin\Debug\ChildProc.exe";
p.Start(); 
```

如果不希望子进程继承父进程环境：

```
var psi = new ProcessStartInfo();
psi.EnvironmentVariables["TEST_ENV"] = "From parent";
psi.UseShellExecute = false;
psi.FileName = @"C:\src\bin\Debug\ChildProc.exe";
Process.Start(psi); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-18T15:39:59.803

每个应用程序都使用自己的环境副本运行，因此子进程不能影响父进程的环境。一直到 CreateProcess 都是如此，其中环境是输入/可选参数 - 即单向。

您可以使用许多 IPC 机制，从命名管道到套接字到共享内存再到文件……不胜枚举。

但是怀疑文件对你来说是最简单的。

您可以让子进程创建一个文件，其中包含您想要的名称/值对，然后调用应用程序可以加载和使用该文件。格式可能是基本的，例如：

键=值键2=值2

更复杂一点（但可能更容易使用），例如 XML ...或您想要的任何自定义格式。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-18T15:35:08.237

环境变量被继承给子进程，但每个子进程都会获得一个副本 - 如果您之后更改父进程的环境，这将不会反映在子进程中。

这是出于安全原因：如果变量是共享的，则进程可以查看彼此的内存，这会导致各种问题。

所以解决方法是在开始新进程之前设置变量。

如果您需要与现有的子进程通信，请使用管道。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-10-18T12:39:50.343

该命令必须在当前进程的环境中执行。通常，bash 会将所有进程作为子进程执行，该子进程将获得父环境的只读副本，并在修改变量时创建一个新条目。

点 (.) 是一个不应与当前目录的规范混淆的命令。dot 命令导致在父环境中执行以下命令。这样，进程的环境变量就是调用进程的环境变量。

# javascript - JavaScript中的函数表达式与声明有什么区别？

> ID：1013385
> 
> 赞同：496
> 
> 时间：2009-06-18T15:32:28.273
> 
> 标签：javascript

以下代码行有什么区别？

```
//Function declaration
function foo() { return 5; }

//Anonymous function expression
var foo = function() { return 5; }

//Named function expression
var foo = function foo() { return 5; } 
```

*   什么是命名/匿名函数表达式？
*   什么是声明函数？
*   浏览器如何以不同的方式处理这些结构？

对类似问题（[var functionName = function() {} vs function functionName() {}](https://stackoverflow.com/questions/336859/javascript-var-functionname-function-vs-function-functionname)）的回答有什么不完全正确的？

* * *

## 回答 #1

> 赞同：422
> 
> 时间：2010-07-27T14:00:25.793

它们实际上非常相似。你如何称呼它们是完全一样的。不同之处在于浏览器如何将它们加载到执行上下文中。

在执行任何代码之前加载函数声明。

仅当解释器到达该行代码时才加载函数表达式。

所以如果你试图在加载之前调用一个函数表达式，你会得到一个错误！如果您改为调用函数声明，它将始终有效，因为在加载所有声明之前无法调用任何代码。

**示例：函数表达式**

```
alert(foo()); // ERROR! foo wasn't loaded yet
var foo = function() { return 5; } 
```

**示例：函数声明**

```
alert(foo()); // Alerts 5\. Declarations are loaded before any code can run.
function foo() { return 5; } 
```

至于你问题的第二部分：

`var foo = function foo() { return 5; }`真的和其他两个一样。只是这行代码曾经在 safari 中导致错误，尽管它不再如此。

* * *

## 回答 #2

> 赞同：111
> 
> 时间：2012-11-20T20:02:12.027

# 函数声明

```
function foo() { ... } 
```

由于**函数提升**，以这种方式声明的函数可以在定义之后和之前调用。

# 函数表达式

1.  **命名函数表达式**

    ```
    var foo = function bar() { ... } 
    ```

2.  **匿名函数表达式**

    ```
    var foo = function() { ... } 
    ```

`foo()`只能在创建后调用。

# [立即调用函数表达式 (IIFE)](http://benalman.com/news/2010/11/immediately-invoked-function-expression/#iife)

```
(function() { ... }()); 
```

# 结论

Crockford 建议使用函数表达式，因为它清楚地表明这`foo`是一个包含函数值的变量。好吧，就个人而言，我更喜欢使用声明，除非有表达的理由。

* * *

## 回答 #3

> 赞同：20
> 
> 时间：2013-02-08T10:49:58.547

关于第三个定义：

```
var foo = function foo() { return 5; } 
```

下面是一个示例，展示了如何使用递归调用的可能性：

```
a = function b(i) { 
  if (i>10) {
    return i;
  }
  else {
    return b(++i);
  }
}

console.log(a(5));  // outputs 11
console.log(a(10)); // outputs 11
console.log(a(11)); // outputs 11
console.log(a(15)); // outputs 15 
```

编辑：更有趣的闭包示例：

```
a = function(c) {
 return function b(i){
  if (i>c) {
   return i;
  }
  return b(++i);
 }
}
d = a(5);
console.log(d(3)); // outputs 6
console.log(d(8)); // outputs 8 
```

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2009-06-18T16:04:46.703

第一条语句取决于声明它的上下文。

如果它在全局上下文中声明，它将创建一个名为“foo”的隐含全局变量，该变量将是一个指向函数的变量。因此，函数调用“foo()”可以在您的 javascript 程序中的任何位置进行。

如果函数是在闭包中创建的，它将创建一个名为“foo”的隐含局部变量，然后您可以使用该变量在闭包内调用“foo()”函数

**编辑：**

我还应该说函数语句（第一个）在函数表达式（其他 2 个）之前解析。这意味着如果您在脚本底部声明该函数，您仍然可以在顶部使用它。函数表达式只有在被执行代码命中时才会被评估。

**结束编辑**

语句 2 和 3 几乎是等价的。同样，如果在全局上下文中使用它们将创建全局变量，如果在闭包中使用将创建局部变量。但是值得注意的是，语句 3 将忽略函数名称，因此本质上您可以调用任何函数。所以

```
var foo = function foo() { return 5; } 
```

是相同的

```
var foo = function fooYou() { return 5; } 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-06-07T09:35:28.480

尽管完全的区别更复杂，但我关心的唯一区别是机器创建函数对象的时间。在声明的情况下，是在执行任何语句之前但在调用语句体之后（是全局代码体或子函数），而在表达式的情况下，是在执行它所在的语句时。除此之外，出于所有意图和目的，浏览器对它们一视同仁。

为了帮助您理解，请看一下这个性能[测试](http://jsperf.com/local-vs-global/7)，它打破了我所做的假设，即在调用外部函数时不需要由机器重新创建内部声明的函数。有点遗憾，因为我喜欢这样写代码。

# c# - SQLCLR 社区扩展或公共库

> ID：1013392
> 
> 赞同：5
> 
> 时间：2009-06-18T15:33:14.390
> 
> 标签：c#, .net, sqlclr

刚刚完成了第五次为 SQLCLR 编写 Regex 替换和匹配函数和 tvf 后，我坐下来思考是否有一组用于 SQLCLR 的公共社区扩展，用于您在数据库中想要但从未提供过的最常见的东西。

例如，Powershell 有一组出色的社区扩展，涵盖了盒子中未包含的大量附加功能。没有它我不会使用 Powershell。

我想也许 SQLCLR 有类似的东西。我正在寻找类似的东西：

*   正则表达式支持（isMatch、Replace、Match）
*   Base64 编码/解码支持
*   字符串格式（日期时间、字节数组、整数浮点数和小数等）
*   散列，使用任意算法加密（我知道 SQL 2k5、2k8 支持一些基本的东西，但不支持 SHA2？这是怎么回事？）
*   常见的附加聚合；OR 位、AND 位、cat 字符串 (String.Join)
*   压缩/解压

有谁知道有这样一个我们一遍又一遍地编写的具有通用例程功能的库？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-07-01T02:49:37.180

Peter 看一下 SQL#，它是由 Solomon Rutzky 创建的 SQLCLR 程序集，有两个版本，免费版和付费版。您会发现免费版包含您上面提到的许多项目。

[http://www.sqlsharp.com/](http://www.sqlsharp.com/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-07-01T00:09:33.510

SplitString() 和许多其他的可以被添加。也许我们创建了一个 SqlClrContrib 站点？人们可以在哪里将他们的想法发布到开源项目中，我们可以添加这样的功能？

# php - 为什么我不能覆盖默认验证错误消息？

> ID：1013401
> 
> 赞同：2
> 
> 时间：2009-06-18T15:34:18.553
> 
> 标签：php, zend-framework, validation

我[`Zend_Validate`](http://framework.zend.com/manual/en/zend.validate.html)用来验证一些表单输入（Zend Framework 版本是 1.8.2）。出于某种原因，使用[此处](http://framework.zend.com/manual/en/zend.filter.input.html)[`Zend_Filter_Input`](http://framework.zend.com/manual/en/zend.filter.input.html)描述的界面不起作用：

```
$data = $_POST;
$filters = array('*' => array('StringTrim'));
$validators = array('driverName' => array('NotEmpty','messages' => 'This should override the default message but does not!'));
$inputFilter = new Zend_Filter_Input($filters,$validators,$data);
$messages = $inputFilter->getMessages();
debug($messages); //show me the variable contents 
```

输出`debug($messages)`：

```
Array
(
    [driverName] => Array
        (
            [isEmpty] => You must give a non-empty value for field 'driverName'
        )

) 
```

无论我做什么，我都无法覆盖该消息。如果我直接使用验证器，即：

```
$notEmpty = new Zend_Validate_NotEmpty();      
$notEmpty->setMessage('This WILL override the default validation error message');
if (!$notEmpty->isValid($_POST['driverName'])) {
    $messages = $notEmpty->getMessages();
    debug($messages);
} 
```

输出`debug($messages)`：

```
Array
(
    [isEmpty] => Please enter your name
) 
```

底线。我可以让验证器工作，但是如果没有`Zend_Filter_Input`验证接口方法的好处，我还不如编写自己的验证类！

有没有人知道为什么会发生这种情况，以及如何解决？

这可能是一个错误吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-18T15:39:57.870

验证器数组中的`messages`键必须传递一个键/值对数组，其中键是验证消息常量，值是您自定义的错误消息。这是一个例子：

```
 $validators = array(

        'excerpt' => array(
            'allowEmpty' => true,
            array('StringLength', 0, Ctrl::getOption('blog/excerpt/length')), 
            'messages' => array(Zend_Validate_StringLength::TOO_LONG => 'The post excerpt must not exceed '.Ctrl::getOption('blog/excerpt/length').' characters.')
        ),

    ); 
```

但是，在您的情况下，您收到的错误消息来自`allowEmpty`Zend_Filter_Input 的元命令。这不是一个真正的标准验证器。你可以这样设置：

```
$options = array(
    'notEmptyMessage' => "A non-empty value is required for field '%field%'"
);

$input = new Zend_Filter_Input($filters, $validators, $data, $options);

// alternative method:

$input = new Zend_Filter_Input($filters, $validators, $data);
$input->setOptions($options); 
```

如果每个字段需要不同的非空消息，我建议设置`allowEmpty => true`并添加`NotEmpty`带有自定义消息的验证器。

供您参考，`NotEmpty`验证器的正确消息密钥是`Zend_Validate_NotEmpty::IS_EMPTY`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-18T15:41:37.943

MESSAGES 参数采用数组，而不是字符串。试试这个：

```
$validators = array('driverName' => 
                     array('NotEmpty',
                           'messages' => array(
                                0 => 'This should override the default message but does not!'
                            )
                     )
              ); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-08-13T17:45:30.690

这是一个错误，它在 Zend Framework 的 JIRA 中......

# asp.net-mvc - asp.net MVC 应用程序中的客户端和服务器端验证

> ID：1013405
> 
> 赞同：4
> 
> 时间：2009-06-18T15:34:26.273
> 
> 标签：asp.net-mvc, validation

我们正在启动一个新的 ASP.NET 3.5 MVC 应用程序。以下是验证的要求：

*   客户端和服务器端验证。
*   验证规则集中在一处。
*   解决了“密码”和“确认密码”等常见场景。

**选项：**

*   DataAnnotation（仅进行服务器端验证）
*   EL 4.1 验证应用程序块（仅进行服务器端验证）
*   [xVal](http://xval.codeplex.com)框架
*   [验证库](http://www.codeplex.com/aspmvcvalidation)框架
*   [验证工具包](http://mvcvalidatortoolkit.codeplex.com)框架
*   **其他的 ？**

xVal 和“验证库”都可以使用 DataAnnotation 和 jQuery 验证插件。

**如果表单具有“创建”所需但“更新”不需要的字段，这些框架中的哪一个可以处理这种情况？**

请告知哪个是 MVC 客户端和服务器验证的最佳选择？

谢谢你。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-18T15:41:14.420

我可以回答**其他**问题:)

[FluentValidation](http://www.codeplex.com/FluentValidation)看起来很有趣。它们提供了流畅的语法，例如：

```
public class CustomerValidator: AbstractValidator<Customer> {
    public CustomerValidator() {
        RuleFor(customer => customer.Surname).NotEmpty();
        RuleFor(customer => customer.Forename).NotEmpty().WithMessage("Missing first name");
    }
} 
```

它还与 ASP.NET MVC 进行了一些小集成，您可以在其中将验证结果添加到 ModelState，如下所示：

```
public ActionResult Save(Customer customer) {
    var validator = new CustomerValidator();
    var results = validator.Validate(customer);
    results.AddToModelState(ModelState, "customer");
} 
```

# objective-c - Emacs 模式问题

> ID：1013417
> 
> 赞同：8
> 
> 时间：2009-06-18T15:35:33.103
> 
> 标签：objective-c, emacs

我开始使用目标 C，目标 C 模式工作得非常好。但是，ObjC 使用 .h 文件，就像 C 和 C++ 一样。我需要能够使用所有三个。有谁知道如何让 emacs 判断它应该处于 objC 模式还是 C/C++ 模式？

编辑：我的要求似乎有些混乱。问题是我有一些与 .m 文件相关联的 .h 文件，以及一些与 .c 文件相关联的 .h 文件和一些与 .cpp 文件相关联的文件。我*想要*的是我可以粘贴在我的 c-mode-common-hook 或其他地方的东西，它可以检查它是否是一个目标 C .h 文件，然后强制它进入目标 C 模式，或其他东西。这个想法是我可以打开一个 .h 文件，它会自动处于正确的模式。

显然，当我在文件中时，我可以手动更改模式，但这很痛苦，而且我经常忘记，直到我点击标签并且发生了一些古怪的事情。这是我现在使用的解决方案。

我认为标题注释可能是这样做的正确方法，但为了让它真正有用，我需要弄清楚如何让 XCode 在它为我创建文件时将注释放在那里......

编辑2：

我目前正在使用 header-comment 解决方案。在我弄清楚如何让 XCode 自动添加注释之前，我正在使用以下 elisp 函数：

```
(defun bp-add-objC-comment ()
  "Adds the /* -*- mode: objc -*- */ line at the top of the file"
  (interactive)
  (objc-mode)
  (let((p (point)))
    (goto-char 0)
    (insert "/* -*- mode: objc -*- */\n")
    (goto-char (+ p  (length "/* -*- mode: objc -*- */\n"))))) 
```

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-06-18T15:47:49.197

您可以在文件的第一行添加这样的注释：

```
/* -*- mode: objc -*- */ 
```

或者

```
// -*- mode: c++ -*- 
```

作为适当的。Emacs 手册中的[指定文件变量](http://www.gnu.org/software/emacs/manual/html_node/emacs/Specifying-File-Variables.html)中的更多详细信息。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-06-19T04:56:18.807

好的，不需要在文件中添加特殊注释的解决方案怎么样？

看一下这个：

```
;; need find-file to do this
(require 'find-file)
;; find-file doesn't grok objc files for some reason, add that
(push ".m" (cadr (assoc "\\.h\\'" cc-other-file-alist)))

(defun my-find-proper-mode ()
  (interactive)
  ;; only run on .h files
  (when (string-match "\\.h\\'" (buffer-file-name))
    (save-window-excursion
      (save-excursion
        (let* ((alist (append auto-mode-alist nil))  ;; use whatever auto-mode-alist has
               (ff-ignore-include t)                 ;; operate on buffer name only
               (src (ff-other-file-name))            ;; find the src file corresponding to .h
               re mode)
          ;; go through the association list
          ;; and find the mode associated with the source file
          ;; that is the mode we want to use for the .h file
          (while (and alist
                      (setq mode (cdar alist))
                      (setq re (caar alist))
                      (not (string-match re src)))
            (setq alist (cdr alist)))
          (when mode (funcall mode)))))))

(add-hook 'find-file-hook 'my-find-proper-mode) 
```

这使用 Emacs 的内置包来查找相应的 .h/.cc 文件。因此，如果您刚刚打开的头文件对应于 c++ 模式下的文件，则 .h 文件将置于该模式下，如果源是 objc 模式文件，则将头文件置于该模式下。

注释中不需要特殊的 Emacs 变量。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-18T17:29:37.947

我会使用[eproject](http://github.com/jrockway/eproject/)来帮助我处理这个问题。假设我不在给定项目中混合匹配语言，我可以`.eproject`在项目根目录中创建一个包含文本的文件：

```
:cc-header-type :objc 
```

然后，我会为 .h 文件设置某种默认模式：

```
(add-to-list 'auto-mode-alist '("[.]h$" . c-mode)) 
```

然后，为该模式添加一个钩子：

```
(add-hook 'c-mode-hook (lambda ()
    (let ((header-style (eproject-attribute :cc-header-type)))
        (when (and header-style
                   (string-match "[.]h$" (buffer-file-name)))
            (case header-style
                (:objc (objc-mode))
                (:c++  (c++-mode))
                (:c    (c-mode)))))) 
```

现在模式将根据您在`.eproject`文件中所做的设置自动更改。（请注意，该`.eproject`文件不是为 eproject 设置变量的唯一方法；如果您有检测目标 c 项目的启发式方法，eproject 也可以通过这种方式获取变量。）

无论如何，如果这对您有用，请告诉我，以便我可以将其添加到[eproject wiki](http://wiki.github.com/jrockway/eproject/)中。

# visual-studio-2008 - Visual Studio 编译后将 .dll 和 .pdb 添加到项目中

> ID：1013419
> 
> 赞同：0
> 
> 时间：2009-06-18T15:35:40.267
> 
> 标签：visual-studio-2008

在我的 Visual Studio 2008 web vbproj 中，我只在 bin 文件夹中包含了某些文件。我正在使用 browserhawk，它需要有一些浏览器定义文件（maindefs.bdd 等...）。我现在在部署 Web 应用程序时总是拥有它们。

当我编译我的应用程序时，VS 会自动将新编译的 .dll 添加到项目中。我曾尝试对添加的文件使用“从项目中排除”，但在我清理解决方案后，它会再次重新添加它们。

如何禁用此操作？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-18T16:01:15.063

如果您的 bin 文件夹包含在您的项目中，您将无法这样做。相反，您可以将浏览器定义文件放在项目中的单独文件夹下，或者就在项目下，然后在您要转到 bin 文件夹的每个文件的属性。这样，文件就成为项目的一部分，并自动添加到 bin 文件夹中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-07-23T20:33:07.240

使用 Post Build Event 复制文件。确保浏览器 hawk 文件构建操作设置为“不复制”。然后转到您的项目属性，选择“构建事件”选项卡并将以下内容添加到构建后事件命令行：

复制 "$(ProjectDir)\common\browserhawk*.*" "$(TargetDir)"

如果您的项目路径中有空格，请务必包含引号。

# ms-access - 显示来自直通代码的代码（以毫秒访问）

> ID：1013425
> 
> 赞同：1
> 
> 时间：2009-06-18T15:37:17.093
> 
> 标签：ms-access, vba

制作一个主要供其他程序员和技术管理人员使用的 Access 数据库（2003 年），作为数据验证的工具。我想在运行代码的表单部分放置一个按钮，以显示正在运行的代码。所以程序员可以现场编辑。这适用于经常更改代码的数据验证项目。让我们假设代码在一个模块中，因此不需要保存表单或处于编辑模式。只需按下按钮并在代码视图中弹出代码。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-18T19:47:03.137

您可能仅限于模块中的代码。但是在表单上的按钮中，您可以将点击事件设置为：

DoCmd.OpenModule "module_name", "the_name_of_some_function"

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-18T16:36:35.063

它对你有用吗？

```
Private Sub Command0_Click()
While True
Debug.Print "tt"
If pressed And debugmode Then
   Stop
   pressed = False
End If
DoEvents

Wend
End Sub

Private Sub Command1_Click()
    pressed = True
    ' You can just put here Stop 
End Sub 
```

编辑：我的意思是使用 DoEvents 和 Stop

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-18T17:29:31.643

查看代码并不难，编辑它也不是那么难。但我应该警告你一些陷阱。首先，您正在讨论的方法相当于自我修改代码，这会导致很多防病毒软件出错。其次，腐败是 Access 的一个持续危险，而自我修改的代码只会加剧这个问题。您提出的任何解决方案都应该尽量减少编辑，并且您还应该有一个非常强大的备份和恢复计划。第三，自我修改代码将阻止您编译数据库（使用 mdes）或锁定项目。这可能导致一些非常难以控制和维护的源代码。
相反，我建议您考虑使用纯 SQL 进行数据修改。然后，您可以在表中存储和修改 SQL，然后只需使用 CurrentDB.Execute 来运行它。

# wcf - 如何从 Excel 2003 VBA 调用 WCF 客户端？

> ID：1013428
> 
> 赞同：12
> 
> 时间：2009-06-18T15:37:26.313
> 
> 标签：wcf, web-services, vba, excel

正如问题所问，我如何从 Excel 2003 VBA 调用 WCF 客户端？

我看到有一个地方可以调用网络服务，但是我通过谷歌搜索，我得到的所有结果都不可能从 VBA 调用 WCF 客户端。

在我对我的代码做任何事情之前，我想知道使用什么方法，不想浪费时间，后来发现这是不可能的。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-07-06T06:57:15.203

您可能想查看使用 WCF 服务名字对象，它允许您从 VBA 调用 WCF 服务，而无需在 Excel 客户端计算机上安装任何东西，而不是 .NET Framework。

```
Dim addr As String
addr = "service:mexAddress=""net.tcp://localhost:7891/Test/WcfService1/Service1/Mex"","
addr = addr + "address=""net.tcp://localhost:7891/Test/WcfService1/Service1/"","
addr = addr + "contract=""IService1"", contractNamespace=""http://tempuri.org/"","
addr = addr + "binding=""NetTcpBinding_IService1"",bindingNamespace=""http://tempuri.org/"""

Dim service1 As Object
Set service1 = GetObject(addr)

MsgBox service1.GetData(12) 
```

我已经写了一个[完整的分步示例](http://damianblog.com/2009/07/05/excel-wcf/)。

/达米安

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-23T06:27:52.293

在这种情况下，我不会使用 VSTO。COM Interop 可能是最好的方法，只要您不希望 SOAP 消息有任何安全性。

1.  编写 WCF 客户端，具有必要的绑定
2.  公开 COM 互操作的程序集
3.  在 Excel VBA 中引用公开的程序集

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-18T18:03:39.670

我尝试了很长一段时间从 excel vba 调用基于 SOAP 的 wcf 服务，但没有任何运气。

相反，我将服务更改为 REST 绑定 (webHttpBinding)。这样我就可以将数据直接加载到 xml 映射中，就像它是任何其他 xml 文件一样。对我来说效果很好，但我只是想导入一些数据。

至于肥皂；[这个问题](https://stackoverflow.com/questions/241725/calling-a-webservice-from-vba-using-soap)的答案提到了我可以找到建议使用的所有示例的 Web 服务工具包。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-18T18:15:12.943

我使用[Office 2003 Web Services Toolkit](http://www.microsoft.com/Downloads/details.aspx?familyid=FA36018A-E1CF-48A3-9B35-169D819ECF18&displaylang=en)完成了这项工作，但取得了有限的成功，但并非没有一些痛苦。

请注意，这不受 Microsoft 支持，并且有许多限制可能使其不适合生产使用。例如，它不支持返回空集合的 Web 服务：请参阅[这个 StackOverflow 问题](https://stackoverflow.com/questions/174517/can-generic-type-mapper-mssoap-toolkit-be-persuaded-to-handle-empty-arrays)。

如果您想在不受支持的情况下使用这条路线，请下载该工具包并在此处发布您遇到的任何问题。

Microsoft 建议使用 VSTO，但这并不容易与 VBA 集成...

# asp.net - Javascript 在 IE 和 FF 中被调用，但在 Chrome 中没有，为什么？

> ID：1013432
> 
> 赞同：0
> 
> 时间：2009-06-18T15:37:56.453
> 
> 标签：asp.net, javascript, button, onclick, onclientclick

我在下面的代码中有一个 aspx 页面上的按钮。当它被点击时，它应该调用一个 javascript 来打印该 div 中的文本。在 IE 和 Firefox 中一切正常，但在 chrome 中尝试时，就好像 OnClientClick 没有启动 javascript。我没有收到任何错误，它现在可以在 IE 和 FF 中使用。

下面是调用 javascript 的按钮的代码。

```
<asp:Button ID="btnEULAPrint" Text="Print" runat="server" ValidationGroup="EULA"
            OnClientClick="javascript:CallPrint('EULA');return false;"/> 
```

有人有任何想法或链接可以分享给我指明方向吗？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2010-03-24T17:07:19.783

我不得不问，您是否尝试`javascript:`从属性中删除？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-18T15:40:05.997

可能是一些来源问题。因为它在 Chrome 中对我有用

# c# - 使用 Lambda 表达式查询字典

> ID：1013440
> 
> 赞同：1
> 
> 时间：2009-06-18T15:39:15.953
> 
> 标签：c#, dictionary, lambda

我在下面创建了一些示例代码，并尝试使用 lambda 表达式来查询 SoftwareComponents Dictionary。问题是查询返回一个 IGrouping 类型的 var，而我需要做的是进一步细化查询，以便它返回一个 IGrouping 类型，其中第一个字符串是 SoftwareComponent.ComponentName，第二个字符串是 SoftwareComponent。组件描述。有人知道怎么做吗？

我希望返回的数据看起来像：“新类型描述”“component1”“component2”“旧类型描述”“component3”“component4”

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Web;
using System.Web.UI;
using System.Web.UI.WebControls;

public partial class _Default : System.Web.UI.Page 
{

    protected void Page_Load(object sender, EventArgs e)
    {
        UnOwnedSoftware software = new UnOwnedSoftware();

        var components = software.SoftwareComponents.Values.
            GroupBy(s => s.ComponentName);
    }
}

public class UnOwnedSoftware
{
    public Dictionary<int, SoftwareComponent> SoftwareComponents
        = new Dictionary<int, SoftwareComponent>();

    public UnOwnedSoftware()
    {
        SoftwareComponent component1 = new SoftwareComponent
            ("component1", 1, "New Type Description");
        SoftwareComponent component2 = new SoftwareComponent
            ("component2", 2, "New Type Description");
        SoftwareComponent component3 = new SoftwareComponent
            ("component3", 3, "Old Type Description");
        SoftwareComponent component4 = new SoftwareComponent
            ("component4", 4, "Old Type Description");

        SoftwareComponents.Add(1, component1);
        SoftwareComponents.Add(2, component2);
        SoftwareComponents.Add(3, component3);
        SoftwareComponents.Add(4, component4);
    }   
}

public class SoftwareComponent
{
    public string ComponentName { get; set; }
    public int ID { get; set; }
    public string ComponentDescription { get; set; }

    public SoftwareComponent(string componentName, int id, string componentDescription)
    {
        ComponentName = componentName;
        ID = id;
        ComponentDescription = componentDescription;
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-18T16:02:22.600

试试这个：

```
var components = (from s in software.SoftwareComponents.Values
                  select new
                  {
                      Name = s.ComponentName,
                      Description = s.ComponentDescription
                  })
                 .ToList().GroupBy(s=>s.Name); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-18T16:09:52.523

鉴于您提供的示例数据，按 ComponentName 分组不会产生任何有用的组。我不确定您的数据是否实际上对每个组件都有一个唯一的名称，但如果有，那么分组实际上不会提供任何价值。

但是，要实际实现所需的分组，您可以执行以下操作：

```
var components = from v in software.SoftwareComponents.Values
                 group v by v.name into g
                 select new { ComponentName = g.Key, Description = g.First(v => v.Description); 
```

这应该会导致枚举具有 ComponentName 和 Description 的组件。请注意，从组中检索值的唯一方法是选择第一个或最后一个条目，或者执行聚合总和、平均值等。唯一可直接选择的值是键（可能是复合的，因此有多个值.)

# python - 如何将 C lib 与 python 链接以在 Windows 下嵌入？

> ID：1013441
> 
> 赞同：1
> 
> 时间：2009-06-18T15:39:16.887
> 
> 标签：python, c, windows, gcc, linker

我正在开发一个用 C 编写的应用程序。应用程序的一部分应该嵌入 python，这是我当前的问题。我尝试将我的源代码链接到 Python 库，但它不起作用。

当我使用 MinGW 时，我使用 dlltool 从 python26.lib 创建了 python26.a 文件，并将 *.a 文件放入`C:/Program Files (x86)/python/2.6/libs`.

因此，我使用以下命令编译文件：

```
gcc -shared -o mod_python.dll mod_python.o "-LC:\Program Files (x86)\python\2.6\libs" -lpython26 -Wl,--out-implib,libmod_python.a -Wl,--output-def,mod_python.def 
```

我得到了这些错误：

```
Creating library file: libmod_python.a
mod_python.o: In function `module_init':
mod_python.c:34: undefined reference to `__imp__Py_Initialize'
mod_python.c:35: undefined reference to `__imp__PyEval_InitThreads'
... and so on ... 
```

*   我的 Python“根”文件夹是`C:\Program Files (x86)\python\2.6`
*   开发系统是 Windows Server 2008
*   海合会信息：`Reading specs from C:/Program Files (x86)/MinGW/bin/../lib/gcc/mingw32/3.4.5/specs Configured with: ../gcc-3.4.5-20060117-3/configure --with-gcc --with-gnu-ld --with-gnu-as --host=mingw32 --target=mingw32 --prefix=/mingw --enable-threads --disable-nls --enable-languages=c,c++,f77,ada,objc,java --disable-win32-registry --disable-shared --enable-sjlj-exceptions --enable-libgcj --disable-java-awt --without-x --enable-java-gc=boehm --disable-libgcj-debug --enable-interpreter --enable-hash-synchronization --enable-libstdcxx-debug Thread model: win32 gcc version 3.4.5 (mingw-vista special r3)`

我做错了什么？我如何编译和链接它:-)？

干杯，格雷戈尔

* * *

**编辑：** 我忘了写关于我的 Python 安装的信息：这是官方 python.org 安装 2.6.1

...以及我如何创建 python.a 文件：

```
dlltool -z python.def --export-all-symbols -v c:\windows\system32\python26.dll

dlltool --dllname c:\Windows\system32\python26.dll --def python.def -v --output-lib python26.a 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-19T09:53:03.647

好吧，在 Windows 上，python 发行版已经在 libs 子目录中附带了一个`libpython26.a`，因此无需`.a`使用 dll 工具生成文件。

我确实尝试了一个使用单个 C 文件 toto.c 的小示例：

```
gcc -shared -o ./toto.dll ./toto.c -I/Python26/include/ -L/Python26/libs -lpython26 
```

它就像一个魅力。希望它会有所帮助:-)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-18T15:54:45.653

Python（至少是我的发行版）带有一个“python-config”程序，它可以为各种情况自动创建正确的编译器和链接器选项。但是，我从未在 Windows 上使用过它。也许这个工具可以帮助你？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-18T16:05:02.647

IIRC，dlltool 并不总是有效。拥有 python 2.6 + Wow 让事情变得更不可能工作。对于 numpy，这就是我的[做法](http://github.com/cournape/numpy/blob/a069480e25d79b76e6da96e951cd3ac66828d75d/numpy/distutils/mingw32ccompiler.py)。基本上，我使用 obdump.exe 从 dll 构建表，然后解析它以生成 .def。您应该检查您丢失的符号是否在 .def 中，否则它将不起作用。

# c# - C# MethodInfo getReturnType

> ID：1013443
> 
> 赞同：3
> 
> 时间：2009-06-18T15:39:33.830
> 
> 标签：c#, .net, reflection, void, methodinfo

我创建了一个 MethodInfo 实例：

```
MethodInfo theMethod = typeof(Reciever).GetMethod("methodName", parameterTypes); 
```

现在我想知道 theMethod 的返回类型是否为 void。如何？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-06-18T15:41:32.640

简单的：

```
theMethod.ReturnType == typeof(void) 
```

# python - 在模块中组合 C 和 Python 函数

> ID：1013449
> 
> 赞同：0
> 
> 时间：2009-06-18T15:41:00.393
> 
> 标签：python, cpython

我有一个 C 扩展模块，我想向其中添加一些 Python 实用程序函数。有推荐的方法吗？

例如：

```
import my_module

my_module.super_fast_written_in_C()
my_module.written_in_Python__easy_to_maintain() 
```

我主要对 Python 2.x 感兴趣。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-06-18T16:00:29.697

这样做的常用方法是：mymod.py 包含用 Python 编写的实用程序函数，并在 _mymod 模块中导入好东西，该模块用 C 编写并从 _mymod.so 或 _mymod.pyd 导入。例如，查看 Python 发行版中的 .../Lib/csv.py。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-06-18T15:52:28.760

使用下划线为您的原生扩展添加前缀。然后，在 Python 中，创建一个包装器模块，用于导入该原生扩展并在其之上添加一些其他非原生例程。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-19T00:59:43.303

现有答案描述了最常用的方法：它具有允许在编译后的 C 扩展不可用的平台（包括 Jython 和 IronPython）上实现纯 Python（或其他语言）的潜在优势。

然而，在少数情况下，可能不值得将模块拆分为 C 层和 Python 层，只是为了提供一些用 Python 编写的比用 C 更合理的附加功能。例如，[gmpy](http://code.google.com/p/gmpy/source/browse/trunk/src/gmpy.c)（第 7113 行 ff 在此time)，为了启用`gmpy`' 类型的实例的酸洗，使用：

```
copy_reg_module = PyImport_ImportModule("copy_reg");
if (copy_reg_module) {
    char* enable_pickle =
        "def mpz_reducer(an_mpz): return (gmpy.mpz, (an_mpz.binary(), 256))\n"
        "def mpq_reducer(an_mpq): return (gmpy.mpq, (an_mpq.binary(), 256))\n"
        "def mpf_reducer(an_mpf): return (gmpy.mpf, (an_mpf.binary(), 0, 256))\n"
        "copy_reg.pickle(type(gmpy.mpz(0)), mpz_reducer)\n"
        "copy_reg.pickle(type(gmpy.mpq(0)), mpq_reducer)\n"
        "copy_reg.pickle(type(gmpy.mpf(0)), mpf_reducer)\n"
    ;
    PyObject* namespace = PyDict_New();
    PyObject* result = NULL;
    if (options.debug)
        fprintf(stderr, "gmpy_module imported copy_reg OK\n");
    PyDict_SetItemString(namespace, "copy_reg", copy_reg_module);
    PyDict_SetItemString(namespace, "gmpy", gmpy_module);
    PyDict_SetItemString(namespace, "type", (PyObject*)&PyType_Type);
    result = PyRun_String(enable_pickle, Py_file_input,
                          namespace, namespace); 
```

如果您希望这些额外的功能在您的模块中“保留”（在本例中不是必需的），您当然会使用由`Py_InitModule3`（或任何其他方法）构建的模块对象及其`PyModule_GetDict`而不是瞬态字典作为命名空间`PyRun_String`。当然，还有比你需要`PyRun_String`的`def`and`class`语句更复杂的方法，但是，对于足够简单的情况，这种简单的方法实际上可能就足够了。

# c++ - Windows 的可用内存调试器？

> ID：1013455
> 
> 赞同：4
> 
> 时间：2009-06-18T15:41:47.007
> 
> 标签：c++, windows, memory, debugging

> **可能重复：**
> [是否有一个好的 Valgrind 替代 Windows？](https://stackoverflow.com/questions/413477/is-there-a-good-valgrind-substitute-for-windows)

我正在寻找适用于 Windows 的免费内存调试器，适合调试使用 VC 构建的 C++ 应用程序，具有与 Insure++ 或 Purify 类似的功能。

有什么推荐吗？

*   图形用户界面是一个加号

*   与 VS 集成是一个更大的优势

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-18T16:11:28.903

[Ollydbg](http://ollydbg.de/)也非常有用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-18T15:43:53.277

valgrind + cygwin

ANSIMD（Ansi 内存调试器）

UPS 调试器

GoBug 调试器

微软调试工具

堆栈跟踪分析工具 (STAT)

单迁移分析

[http://www.debuginfo.com/](http://www.debuginfo.com/) - 可能是你可以在那里找到的一些工具

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-08-28T01:11:32.640

试试[DUMA](http://duma.sourceforge.net/)，我以前用过，它是跨平台的，最新版本是最近的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-18T16:23:50.733

Purify 是一个内存分析器。你可以试试windows提供的DebugDiag。它可以给你内存转储，在不同的地方你可以检查内存泄漏。

Windbg也不错。

# c++ - 在 iPhone 上浏览源代码

> ID：1013461
> 
> 赞同：4
> 
> 时间：2009-06-18T15:42:46.070
> 
> 标签：c++, iphone, c

我是那种喜欢在业余时间阅读源代码的傻瓜。我也是那种有 iPhone 的笨蛋。在这种设备上阅读和浏览代码的最佳方式是什么？

我最初的想法是使用[LXR](http://sourceforge.net/projects/lxr)之类的东西来生成超链接页面，并将它们上传到我的个人服务器，但我对更好/更简单的方法感兴趣。

我主要阅读 C 和 C++ 代码，但对其他语言的支持会很棒。

我不想越狱我的 iPhone。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-18T16:31:52.757

[Air Sharing](http://www.avatron.com/products/airsharing/)让您可以通过 WebDav 复制文件以便在手机上查看。它甚至语法颜色源代码。根据该站点，支持的语言是“C/C++、Objective C/C++、C#、Java、Javascript、XML、shell 脚本、Perl、Ruby、Python 等”。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-18T16:26:14.383

[vim](http://www.iphonefaq.org/node/212)与 ctags。只是一个想法

# java - 检测/控制过程

> ID：1013462
> 
> 赞同：2
> 
> 时间：2009-06-18T15:42:52.560
> 
> 标签：java, process, detection

我有一个 java 应用程序，我想在其中检查应用程序是否正在运行。如果它没有运行，我想启动它。如果它正在运行，我想杀死它然后重新启动它。

有人可以告诉我该怎么做吗？我可以使用 ProcessBuilder 轻松启动/停止程序。但我无法检测到已经在运行的进程。

谢谢你的帮助！约翰

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-18T15:54:51.257

如果没有应用程序的合作（理想情况下让它监听网络端口），这可能是不可能的（您的 Java 应用程序可能无权终止应用程序）并且需要特定于操作系统的代码。在 Linux 上，您将使用`ps`and`kill`命令。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-18T15:51:23.703

听起来可能很傻，但是您可以在应用程序启动时创建一个具有已知名称的文件。不需要包含任何东西。要检查您的应用程序是否正在运行，请检查该文件是否存在。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-18T16:56:28.347

其他应用程序（您正在监控的过程）是否由您负责？如果是这样，您可以使用几年前我在某些高可用性系统中使用的方法：打开与其他应用程序的连接并“ping”它。如果另一个应用程序在给定的超时时间内没有响应，则它要么关闭要么“挂起”，这同样糟糕（并且您无法通过进程监控检测到。打开连接可以使用套接字完成，或者更复杂协议（SOAP？）。另一种方法是让应用程序每隔一段时间发送一条“我还活着”消息。如果您有一段时间没有收到它 - 您的应用程序需要重新启动。为了真正“杀死”其他进程，您可以保留从 exec() 方法获得的 Process 实例，并在您选择时销毁它。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-18T17:09:18.737

感谢您的回复。这就是我害怕的。我们正在尝试不向我要启动的应用程序添加更多内容。我们基本上是在尝试将远程控制 Web 界面添加到应用程序集合中。

我正在编写的 Web 服务器应用程序基本上会启动/停止 3 个应用程序，它们都相互通信以实现目标。如果我的网络服务器启动和停止它们，一切都很好。但是，如果由于某种原因，当我尝试启动它们时它们已经在运行，就会发生不好的事情。

这是我知道我可以用 Visual Studio (C++/C#/etc) 处理的东西。但是由于平台独立性的要求，这个项目必须用 java 编写。

谢谢大家的帮助！

# popup - 如果在 Web 应用程序中关闭主窗口，关闭子窗口是否合理？

> ID：1013465
> 
> 赞同：3
> 
> 时间：2009-06-18T15:43:21.000
> 
> 标签：popup, web-applications

在 Web 应用程序中，有时您在应用程序中有弹出窗口。

当用户关闭主窗口时，关闭所有打开的子弹出窗口是否合理？

请记住，主窗口不会停留在同一页面上，用户可能会导航到同一应用程序中的其他页面（这意味着即使您保留对所有打开的子窗口的引用，新页面请求也会失去对已打开窗口的引用等）。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-18T15:46:48.917

是的，我认为这是合理的要求。

当您调用时，`window.open`您可以存储从此函数返回的窗口的句柄，然后迭代该集合并`close`在父窗口关闭时调用它们。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-18T16:10:26.487

如何在您的弹出窗口中添加一些 javascript，每隔 x 秒检查父页面是否存在，以及是否使用“会话超时”消息刷新内容。我认为您应该能够使用弹出窗口中的“window.opener.closed”属性来检查父级是否已关闭......只是一个想法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-18T15:50:00.583

这可能是出于安全原因 - 这些子窗口可能会保留在用户退出主窗口时应销毁的会话信息。您不想让用户面临其他人出现并稍后使用他们打开的浏览器并访问他们的会话的危险。

但从 UI 的角度来看，我同意它非常糟糕。我认为这种情况对于 Intranet 解决方案来说是合理的，但对于 Internet 来说是个坏主意。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-18T15:45:48.433

您可以在隐藏的 iframe 中保留对打开的子弹出窗口的引用，并在 iframe 检测到浏览器关闭时关闭它们。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-18T16:03:16.670

这有什么帮助吗？您始终可以尝试在页面之间传递包含所有子项的数组。

[http://www.codeproject.com/KB/scripting/WebChildren.aspx](http://www.codeproject.com/KB/scripting/WebChildren.aspx)

# asp.net-mvc - ASP.NET MVC 将数据从视图传递到控制器

> ID：1013468
> 
> 赞同：13
> 
> 时间：2009-06-18T15:44:40.373
> 
> 标签：asp.net-mvc

我有一个网格视图，其中包含添加到工作站的项目。用户可以从下拉列表中选择一个项目并单击一个动作链接，该链接调用一个控制器，该控制器将该项目添加到工作站。我可以通过在控制器的 Post 操作中读取 FormCollection 对象来使其工作。

```
<p>
    <% using(Html.BeginForm("AddItem", "Home")) { %>
    <label for="ItemID">Item:</label>
    <%= Html.DropDownList("ItemID", Model.ItemsList) %>
    <%= Html.Hidden("WorkstationID", Model.Workstation.RecordID) %>
    <input type="submit" value="Submit" />
    <% } %>
</p> 
```

* * *

```
[AcceptVerbs(HttpVerbs.Post)]
public ActionResult AddItem(FormCollection formValue)
{
    long workstationId = Convert.ToInt64(formValue["WorkstationID"]);
    long itemId = Convert.ToInt64(formValue["ItemID"]);

    Workstation workstation = itilRepository.FindWorkstation(workstationId);
    Item item = itilRepository.FindItem(itemId);

    itilRepository.AddItem(workstation, item);
    itilRepository.Save();

    return Content("Item added successfully!");
} 
```

我想要做的是能够使用 Ajax.ActionLink 将工作站 ID 和 itemId 这两个参数提交给控制器，并将添加的新项目插入到网格中。我正在渲染这样的网格：

```
<table>
      <tr>
        <th></th>
      <th>
        Name
      </th>
      <th>
        Service Tag
      </th>
      <th>
        Serial Number
      </th>
    </tr>

    <% foreach (var item in Model.Items) { %>

    <tr>
      <td>
        <%= Html.ActionLink("Edit", "ItemEdit", new { id = item.RecordID }) %> |
        <%= Html.ActionLink("Details", "ItemDetails", new { id = item.RecordID   })%>
      </td>
      <td>
        <%= Html.Encode(item.Name) %>
      </td>
      <td>
        <%= Html.Encode(item.ServiceTag) %>
      </td>
      <td>
        <%= Html.Encode(item.SerialNumber) %>
      </td>
    </tr>

    <% } %>

</table> 
```

我遇到的问题是，当我使用 ActionLink 提交时，我无法弄清楚如何将参数传递给控制器​​以及如何在不重新加载整个视图的情况下更新网格。

我真的很感激这方面的一些帮助，甚至是做类似事情的教程的链接。

谢谢你！

这是工作版本，一个问题是当控制器返回部分视图时，实际页面消失了。

```
<% using (Ajax.BeginForm("AddItem", null, 
        new AjaxOptions
        {
            UpdateTargetId = "ResultsGoHere",
            InsertionMode = InsertionMode.Replace
        }, 
        new { @id = "itemForm" } ))
{ %>

    <label for="ItemID">Item:</label>
    <%= Html.DropDownList("itemId", Model.ItemsList) %>
    <%= Html.Hidden("workstationId", Model.Workstation.RecordID) %>

    <a href="#" onclick="$('#itemForm').submit();">Submit</a>

    <div id="ResultsGoHere">
        <% Html.RenderPartial("WorkstationItems", Model.Items); %>
    </div>

<% } %> 
```

不确定原因是什么，之前更换工作正常，但控制器没有获得下拉值。现在控制器正在获取值，但返回的部分视图替换了整个页面。

行动方法：

```
[AcceptVerbs(HttpVerbs.Post)]
public ActionResult AddItem(string workstationId, string itemId)
{
    long lworkstationId = Convert.ToInt64(workstationId);
    long litemId = Convert.ToInt64(itemId);

    Workstation workstation = itilRepository.FindWorkstation(lworkstationId);
    Item item = itilRepository.FindItem(litemId);

    IQueryable<Item> items = itilRepository.AddItem(workstation, item);
    itilRepository.Save();

    return PartialView("WorkstationItems", items);
} 
```

这是完成所有工作的视图的 HTML：

```
<%@ Page Title="" Language="C#" MasterPageFile="~/Views/Shared/Site.Master" Inherits="System.Web.Mvc.ViewPage<ITILDatabase.Models.WorkstationFormViewModel>" %>

<asp:Content ID="Content1" ContentPlaceHolderID="TitleContent" runat="server">
    Workstation Details
</asp:Content>
<asp:Content ID="Content2" ContentPlaceHolderID="MainContent" runat="server">

    <script src="/Scripts/MicrosoftAjax.js" type="text/javascript"></script>
    <script src="/Scripts/MicrosoftMvcAjax.js" type="text/javascript"></script>
    <link type="text/css" href="/../Content/css/ui-lightness/jquery-ui-1.7.2.custom.css" rel="stylesheet" />    
    <script type="text/javascript" src="/../Content/js/jquery-1.3.2.min.js"></script>
    <script type="text/javascript" src="/../Content/js/jquery-ui-1.7.2.custom.min.js"></script>

    <h2>
        Workstation Details</h2>
    <fieldset>
        <legend>Fields</legend>
        <p>
            Record ID:
            <%= Html.Encode(Model.Workstation.RecordID) %>
        </p>
        <p>
            Name:
            <%= Html.Encode(Model.Workstation.Name) %>
        </p>
        <p>
            Description:
            <%= Html.Encode(Model.Workstation.Description) %>
        </p>
        <p>
            Site:
            <%= Html.Encode(Model.Workstation.Site.Name) %>
        </p>
        <p>
            Modified By:
            <%= Html.Encode(Model.Workstation.ModifiedBy) %>
        </p>
        <p>
            Modified On:
            <%= Html.Encode(String.Format("{0:g}", Model.Workstation.ModifiedOn)) %>
        </p>
        <p>
            Created By:
            <%= Html.Encode(Model.Workstation.CreatedBy) %>
        </p>
        <p>
            Created On:
            <%= Html.Encode(String.Format("{0:g}", Model.Workstation.CreatedOn)) %>
        </p>
    </fieldset>
    <fieldset>
        <legend>People</legend>
        <% Html.RenderPartial("WorkstationPeople", Model.People); %>
    </fieldset>
    <fieldset>
        <legend>Positions</legend>
        <% Html.RenderPartial("WorkstationPositions", Model.Positions); %>
    </fieldset>
    <fieldset>
        <legend>Items</legend>

            <% using (Ajax.BeginForm("AddItem", "Home", null, 
                    new AjaxOptions
                    {
                        UpdateTargetId = "ResultsGoHere",
                        InsertionMode = InsertionMode.Replace
                    }, 
                    new { @id = "itemForm" } ))
            { %>

                <label for="ItemID">Item:</label>
                <%= Html.DropDownList("itemId", Model.ItemsList) %>
                <%= Html.Hidden("workstationId", Model.Workstation.RecordID) %>

                <a href="#" onclick="$('#itemForm').submit();">Submit</a>

                <div id="ResultsGoHere">
                    <% Html.RenderPartial("WorkstationItems", Model.Items); %>
                </div>

            <% } %>
    </fieldset>
    <br />
    <p>
        <%=Html.ActionLink("Edit", "WorkstationEdit", new { id = Model.Workstation.RecordID }) %>
        |
        <%=Html.ActionLink("Back to List", "Index") %>
    </p>
</asp:Content> 
```

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-06-18T16:07:14.597

您期望 AJAX 调用的结果是什么？

您可以使用`AjaxHelper`对象的辅助方法而不是`HtmlHelper`来呈现链接。例如，要使用 AJAX HttpPOST 调用获取新内容并将其插入`<div>`id 设置为`ResultsGoHere`您呈现以下链接：

```
<%= Ajax.ActionLink("Edit", "ItemEdit", 
                         new {
                             itemId = item.RecordId, 
                             workstationId = myWorkStationId
                         },
                         new AjaxOptions {
                             HttpMethod="POST",
                             UpdateTargetId="ResultsGoHere",
                             InsertionMode = InsertionMode.Replace 
                         }) %> 
```

在您的`AcionMethod`中，您可以简单地测试`Request.IsAjaxRequest()`以决定返回什么：

```
[AcceptVerbs(HttpVerbs.Post)]
public ActionResult ItemEdit(string itemId, string workstationId) {
    // edit the item and get it back

    if (Request.IsAjaxRequest()) {
        return PartialView("SingleItem", item);
    }
    return RedirectToAction("ItemEdit", new { itemId = item.RecordId, workstationId = workstationId });
}

// fallback for get requests
public ActionResult ItemEdit(string itemId, string workstationId)
{
    // do stuff and return view
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-18T19:45:09.287

这是您可以使用该`Ajax.BeginForm()`方法代替的方法：

```
<% using (Ajax.BeginForm("ItemEdit", null, new AjaxOptions
            {
                UpdateTargetId = "ResultsGoHere",
                InsertionMode = InsertionMode.Replace
            }, new { @id = "itemForm" } )
{ %>
<p>
    <%= Html.DropDownList("itemId") %></p>
<p>
    <%= Html.DropDownList("workstationId") %></p>
<p>
    <a href="#" onclick="$('#itemForm').submit();">Submit</a>
</p>
<% } %> 
```

请注意，代码处于当前状态，无法完全正常运行 - 下拉列表不会从任何地方获取它们的项目，没有`<div>`处理 AJAX 请求的结果，以及`onclick`提交的链接上的属性form 要求包含 jQuery（在这种情况下，最好给链接一个 id 并`click()`从一个单独的`js`文件中添加一个事件处理程序......）

编辑：哦，我还没有验证可以将`null`值传递给`routeValues`参数。如果没有，只需提供控制器和操作名称，就可以了。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-10-11T09:07:06.090

如何使用 ajax.actionlink 将模型从视图传递到控制器的创建后操作？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-09-03T12:35:54.527

在这里，据我所知，我们可以通过两种方式将数据从视图传递到控制器......

1.  像这样使用`Formcollection`内置关键字..

    ```
    [HttpPost]
    public string filter(FormCollection fc)
    {
        return "welcome to filtering : "+fc[0];
                        (or)
        return "welcome to filtering : "+fc["here id of the control in view"];

    } 
    ```

`FormCollection`仅当您单击表单内的任何按钮时才有效。在其他情况下，它只包含空数据

1.  使用模型类

    ```
    [HttpPost]
    public string filter(classname cn)
    {
        return "welcome to filtering : "+cn.Empid+""+cn.Empname;
    } 
    ```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-09-24T07:53:02.577

这就是您能够通过 actionLink 发送多个参数的方式。
对于这种情况，请参考下面的代码：

```
@Html.ActionLink("Link text", "Action Name", null, routeValues: new { pram_serviceLine = Model.ServiceLine_ID, pram_Month = Model.Month, pram_Year = Model.Year, flag = "ROTATION" } 
```

如果有效，请回复。

# android - 在 Android 中制作类似向导的应用程序

> ID：1013469
> 
> 赞同：29
> 
> 时间：2009-06-18T15:44:41.807
> 
> 标签：android, user-interface, wizard, user-experience

您认为这是在 Android 平台上执行类似向导的应用程序的最佳方式（用户可以使用下一步和后退按钮在屏幕之间导航，并且每个屏幕都必须保存一些状态数据）。

我主要可以考虑两种方法：

1.  每个屏幕都有一个活动+视图，然后我通过调用每个活动来切换屏幕。这样做的好处是我可以使用系统后退按钮作为我的后退处理程序，而我不必自己处理，因为每个活动都会保存它自己的状态。

2.  拥有一个活动和多个视图，以及我在每个屏幕中切换视图的内容都会发生变化，这有助于我重用更多代码，但会使保存状态变得一团糟。

你怎么看？在 Android 上执行此操作的最佳方法是什么？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2013-04-01T20:19:07.717

## 这个库不再被开发。

使用结合 ViewModel 的[Android 导航组件来构建向导流程。](https://developer.android.com/guide/navigation/navigation-getting-started)

* * *

我开发了一个轻量级的 Android 库，它建立在 Android 的 ViewPager 之上，可用于创建类似向导的活动。看看：[WizarDroid](https://github.com/nimrodda/wizardroid)。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-06-18T16:57:50.373

我建议使用 2，因为它符合活动和视图的目标。在这种情况下保存状态很容易 - 如果您使用 MVC 模式，您可以简单地拥有一个传递给视图的模型对象。每个视图都有可以读/写的模型部分。无论您身在何处，模型都应始终具有当前状态。如果您被丢弃，只需保存模型。恢复会自动进行，因为您在显示每一页时已经从模型中读取。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-06-18T16:47:29.677

我选择了第一种方法，因为它看起来更自然。另一个应用程序`ViewFlipper`用于切换视图，但这与向导相去甚远。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2018-12-04T10:22:03.957

9 年前，这显然是一锅非常不同的鱼——但我认为现在最好的方法是使用 Fragments。

向导中的每个“页面”都有一个片段，让它处理自己的生命周期和状态。

[使用Fragment.getFragmentManager()](https://developer.android.com/reference/android/support/v4/app/Fragment#getfragmentmanager)从每个 Fragment 中更改页面- 这会从父 Activity 返回 FragmentManager，从而允许 Fragment 替换自身。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-18T16:43:05.637

我觉得2更好。将每个“页面”放在一个视图中，然后在显示和隐藏它们之间交替。使做漂亮的过渡变得微不足道。你想保持什么状态？唯一不能自动工作的就是焦点，我想你可能想在每次切换页面时重置它。如果您认为这对您的应用程序来说是正确的行为，那么回击也是微不足道的。

使用 1 您可以重用几乎所有代码（只需定义您自己的 WizardBase 类），但我认为活动的启动（并且需要更多内存）比在视图之间切换要慢得多。

# windows - 注册表项和值名的有效字符是什么？

> ID：1013473
> 
> 赞同：29
> 
> 时间：2009-06-18T15:45:54.817
> 
> 标签：windows, regex, registry

更具体地说，该信息的权威来源是什么？

这可能看起来像一个非编程问题，但我需要知道提供给我的代码的注册表路径是否包含正则表达式。我决定最好的方法是假设任何出现的无效字符（如'*'）都意味着通配符搜索。

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2009-06-18T15:55:57.013

[有关允许的键和值名称，请参阅注册表结构上](http://msdn.microsoft.com/en-us/library/ms724946(VS.85).aspx)的 MSDN 页面。尤其：

> 每个键都有一个由一个或多个可打印字符组成的名称。键名不区分大小写。键名不能包含反斜杠字符 (\)，但可以使用任何其他可打印字符。值名称和数据可以包含反斜杠字符。

注册表值类型[在 MSDN here 上有详细说明](http://msdn.microsoft.com/en-us/library/ms724884(VS.85).aspx)，以防您需要知道允许的值。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-06-18T16:00:17.170

对于 Windows 的所有内容，MSDN 必须是权威来源——关于 [注册表元素大小限制](http://msdn.microsoft.com/en-us/library/ms724872(VS.85).aspx)的文章暗示 Unicode 是好的，[注册表结构](http://msdn.microsoft.com/en-us/library/ms724946(VS.85).aspx)说反斜杠和不可打印的字符在键名中是不允许的。值只需是完全可打印的字符。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2019-01-17T14:38:17.887

刚刚对 Windows 7 注册表做了一个实验：以编程方式在单词“TEST”前面使用 01 Hex *(ASCII SOH)字符创建一个键名（在 Delphi 中是字符串：#1'Test'）。*这是 REGEDIT 不允许您通过键入来执行的操作 - 即使使用 ALT-Keypad 操作也是如此。

它不仅创建了密钥，而且在 REGEDIT 中将密钥显示为具有 #1 字符所在的“宽”空间。

将这个新的子键名称复制并粘贴到 TEXTPAD 中，我可以验证它确实仍然是 #1 字符。

我从来没有读过 #1 被认为是“可打印”的任何地方，但在 Windows 中，除了 00 Hex 之外的任何东西都可以放入打印字符串中，并且实际上任何东西都可以发送到打印机，所以我猜 MSDN 关于这个限制的声明是矛盾的说法：因为在 Windows 中作为*字符*意味着可打印，因此*不可打印的字符*变得……嗯，毫无意义。

虽然您***不能***将#1 字符作为键名直接输入到 REGEDIT（使用 ALT-keypad-number 输入方法），但您***可以***将其从 TEXTPAD 粘贴回 REGEDIT 作为重命名操作的一部分。如果您粘贴它以将另一个对等子项重命名为原始子项，REGEDIT 甚至会抱怨，因为“指定的密钥已经存在”。

有趣的是，我还尝试了字符#256（它不再是 ASCII，但理论上是 Unicode Widechar，但如果输入、存储或输出机制的任何部分拒绝它，则不一定被视为“可打印”）。

虽然我可以以编程方式创建这样的密钥，并在 REGEDIT 中看到一个看起来很奇怪的“A”，但它在剪切和粘贴中变得不太可靠。我猜剪贴板操作和与不同应用程序的交互使这种事情成为一种非常可疑的做法，例如，因为 TEXTPAD 可能会假设您是在粘贴与 REGEDIT 不完全匹配的字节字符还是宽字符放入剪贴板 - 反之亦然。如果这些操作背后的代码只是期待 ANSI 字符串或 UTF-16 宽字符串，并且被赋予了一些不同的东西，包括字节顺序差异和 UTF-8 或他们没有预料到的类似差异，那么事情很可能出错。

最后，我尝试尝试注入一个 0FFFF hex 顺序的widechar。这实际上并没有在 REGEDIT 中给出角色的任何视觉存在 -*那是多么“不可打印”？*. 但这个名字确实包含了***隐形***字符。我通过实际尝试在没有违规字符的 REGEDIT 中创建一个单独的对等子键来确认这一点，结果获得了视觉上看起来像两个相同的键！

总而言之：似乎您可以将任何字符放入子键名称中，只要它不是'\'。但这样做可能不是一个好主意。而且我认为 Windows 中的“不可打印”一词通常仅适用于 00 hex - 那是因为它通常用作字符串终止符，因此通过注册表 API 作为字符“发送”有点困难！

What is quite worrying is the ability that this gives hackers to confuse and mislead. You could quite literally create a whole raft of registry subkeys that appear to have no names at all and can only be meaningfully used by applications, not humans. Yes, you could do that with space-characters, but some unicode characters (like FFFFh) have no width, and you can use any number of them together to create a unique and invisible name, or parts in a name! This makes them almost impossible to detect without using a laborious cut-and-paste, or a dedicated automated tool. In REGEDIT they all just look like identically named, or indeed unnamed, keys.

# windows-installer - 为什么我的新 Windows Installer 文件 (MSI) 不能正确安装在旧版本的 MSI 上？

> ID：1013475
> 
> 赞同：3
> 
> 时间：2009-06-18T15:46:45.297
> 
> 标签：windows-installer

### 症状

我有新创建的安装程序包 (MSI)，用于安装我的应用程序的新版本。

我有一个新的 ProductCode 用于我的安装，但我将 UpgradeCode 保持不变。

因此，当我执行新的 MSI 时，它首先会正确卸载旧版本。甚至 Program Files\MyProduct 目录也被删除。

但是在卸载旧版本后，安装程序只会部分安装新版本。如果我修复损坏的新安装（使用添加删除程序->修改安装->修复），一切都修复了。

如果我首先使用“添加删除程序”卸载旧版本，然后安装新版本，一切都会很好。仅当我在旧版本之上安装新版本时才会出现此问题。

### 可能的原因

旧版本中各种 dll 和 exe 的版本号弄乱了。旧的 exe 版本是 4.11.1234。新 exe 的版本是 4.5.1234。根据“文件版本控制规则”，新文件不会覆盖旧文件。我挠头的原因是，当 InstallFiles 操作执行时，目标文件不再驻留在磁盘上。

### 其他信息

我的目标是 Windows Installer 3.1。

我的安装执行顺序大致是：

```
...
InstallValidate
RemoveExistingProducts
InstallInitialize
...
InstallFiles
...
InstallExecute
InstallFinalize
.... 
```

如果这个上下文没有把问题说清楚，请告诉我......

谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-19T02:47:31.027

我假设你也改变了`PackageCode`and `ProductVersion`？

> “我摸不着头脑的原因是，当 InstallFiles 操作执行时，目标文件不再驻留在磁盘上。”

是的，但是 MSI 在文件被物理删除之前决定安装/不安装文件——该决定是在第一次通过 InstallExecute 序列时做出的，此时文件仍在硬盘驱动器上。

我遇到了您遇到的问题，我可以通过将文件的版本更改为比硬盘驱动器上已有的版本更新来解决它 - 你能做到吗？

另一种选择：您使用的是 InstallShield 吗？您可以选择在可以解决问题的单个文件上设置两个属性之一：1) 始终覆盖，2) 覆盖系统版本。“始终覆盖”会自动将版本号设置为 65535.0.0.0，从而启用安装。“覆盖系统版本”允许您输入自己的版本，高于实际文件版本，从而也启用安装。右键单击文件并查看属性以设置这些选项。

# sharepoint - Sharepoint SPDisposeCheck

> ID：1013476
> 
> 赞同：4
> 
> 时间：2009-06-18T15:46:45.423
> 
> 标签：sharepoint, dispose

SPDisposeCheck 实用程序提醒我有一个未正确处理的**SPWeb.Add**调用。正如您在下面看到的，典型的**using(SPWeb NewWeb = webs.add(siteUrl ....)**方法将不起作用，因为**RunWithElevatedPrivileges**会使**return newWeb**脱离上下文。

通过查看下面的**newWeb = webs.Add()**行，任何人都可以建议一种正确处理新 SPWeb 对象的方法吗？提前致谢。

```
public partial class SiteHelper                         
{                               
    public static SPWeb CreateSiteFromSTP(SPWeb parentWeb, string newSiteSTP, int teamId)   
    {                               
        try                     
        {                       
            SPWeb newWeb = null;        
            SPSecurity.RunWithElevatedPrivileges(delegate()    
            {                   
                string siteUrl = teamId.ToString();         
                SPWebCollection webs = parentWeb.Webs;      
                newWeb = webs.Add(siteUrl,.,.,.,);
                TraceProvider.WriteLine("Activating Feature : MembersFeature ");        
                newWeb.Features.Add(new Guid(TeamSiteAttributes.MembersFeature), true);     
                TraceProvider.WriteLine("Activating Feature : BadgeAwardsFeature ");        
                newWeb.Features.Add(new Guid(TeamSiteAttributes.BadgeAwardsFeature), true);     
                TraceProvider.WriteLine("Activating Feature : ProjectBenefitsFeature ");    
                newWeb.Features.Add(new Guid(TeamSiteAttributes.ProjectBenefitsFeature), true);     
                TraceProvider.WriteLine("Activating Feature : TeamScoreFeature ");          
                newWeb.Features.Add(new Guid(TeamSiteAttributes.TeamScoreFeature), true);   
                newWeb.Update();            
                parentWeb.Update();             
            });                     
            return newWeb;              
        }   
        catch (Exception ex)        
        {                       
            TraceProvider.WriteLine("Error", ex);           
            throw;
        }
    }   
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-06-18T15:55:02.300

SPDisposeCheck 将此报告为错误，因为一旦您从该方法返回它，它就不够聪明，无法知道您在用 newWeb 做什么。只要在调用 CreateSiteFromSTP() 之后处理 newWeb，就不会发生内存泄漏。

如果您确信在此方法中没有内存泄漏，您可以设置 SPDisposeCheck 以忽略此特定警告。只需在您的 CreateSiteFromSTP 方法上方添加以下声明（使用您收到的正确 SPDisposeCheckID 编号）：

```
[SPDisposeCheckIgnore(SPDisposeCheckID.SPDisposeCheckID_110, "Caller will dispose")] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-08-24T13:14:27.827

处理你的新的正确方法`SPWeb`是在它被创建的范围内。如果你需要在你的新网站上执行额外的操作，只需传入一个委托来调用：

```
public static void CreateSiteFromSTP(SPWeb parentWeb, string newSiteSTP, int teamId, Action<SPWeb> actionOnCreate)       
{                                                           
    // ...
    using(var newWeb = webs.Add(...))
    {
        // ...
        newWeb.Update();
        actionOnCreate(newWeb);
    }
} 
```

然后你可以传入一个方法（匿名或命名）来操纵你的 new `SPWeb`，而无需负责传递处置。这种方法还有一个好处，就是不需要您返回`SPWeb`高架块的外部，这是不受支持且不可靠的。

事实上，我会惊讶地发现您的代码实际上按您的意图工作：现有的 SharePoint 对象（特别是`parentWeb`）在创建时设置了它们的权限，也不应该传递到提升的上下文中。在 SharePoint 中提升权限的更好方法是使用 SPSite 模拟。使用[此处](http://solutionizing.net/2009/01/06/elegant-spsite-elevation/)`RunAsSystem`定义的方法，我将重构您的代码，如下所示：

```
public static void ElevateToCreateSiteFromSTP(SPWeb parentWeb, string newSiteSTP, int teamId, Action<SPWeb> actionOnCreate)
{
    parentWeb.RunAsSystem(elevWeb =>
        CreateSiteFromSTP(elevWeb, newSiteSTP, teamId, actionOnCreate));
}

private static void CreateSiteFromSTP(SPWeb parentWeb, string newSiteSTP, int teamId, Action<SPWeb> actionOnCreate)
{                                                           
    try                                     
    {
        string siteUrl = teamId.ToString();             
        SPWebCollection webs = parentWeb.Webs;          
        using(var newWeb = webs.Add(siteUrl, ...))
        {
            var newWebFeatures = newWeb.Features;

            TraceProvider.WriteLine("Activating Feature : MembersFeature ");           
            newWebFeatures.Add(new Guid(TeamSiteAttributes.MembersFeature), true);         
            TraceProvider.WriteLine("Activating Feature : BadgeAwardsFeature ");            
            newWebFeatures.Add(new Guid(TeamSiteAttributes.BadgeAwardsFeature), true);     
            TraceProvider.WriteLine("Activating Feature : ProjectBenefitsFeature ");        
            newWebFeatures.Add(new Guid(TeamSiteAttributes.ProjectBenefitsFeature), true);
            TraceProvider.WriteLine("Activating Feature : TeamScoreFeature ");              
            newWebFeatures.Add(new Guid(TeamSiteAttributes.TeamScoreFeature), true);       

            newWeb.Update();                        
            parentWeb.Update();                     

            if(actionOnCreate != null)
                actionOnCreate(newWeb);
        }
    }       
    catch (Exception ex)
    {                                               
            TraceProvider.WriteLine("Error", ex);                   
            throw;
    }
} 
```

这具有将您的高程问题与创建`SPWeb`. 我也更愿意让我的代码在不同权限下运行的位置非常明显。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-18T19:06:48.707

在这种情况下，这主要是安全清理的最佳实践问题......这种方法返回 GUID 或新 SPWeb 的 url 而不是创建的实际 SPWeb 会更好吗？这样，此方法可以正确处理它创建的 SPWeb，调用者仍然有机会轻松创建另一个生命周期不那么神秘的 SPWeb。与传递一个并可能忽略适当清理的风险相比，创建一个 SPWeb 的实际成本是多少？

# javascript - 将计算的 CSS 样式映射到指定的样式？

> ID：1013478
> 
> 赞同：0
> 
> 时间：2009-06-18T15:46:55.423
> 
> 标签：javascript, html, css, dom

有没有办法将dom 元素的[计算样式](http://www.w3.org/TR/DOM-Level-2-Style/css.html#CSS-ViewCSS)[`window.getComputedStyle`](http://www.w3.org/TR/DOM-Level-2-Style/css.html#CSS-CSSview-getComputedStyle)（由 检索）映射到对应`CSSStyleRule`的 in `document.styleSheets`？

我的最终目标是检索dom 元素的[*指定值*](http://www.w3.org/TR/CSS2/cascade.html#specified-value)（而不是[计算值](http://www.w3.org/TR/CSS2/cascade.html#computed-value)或[实际值](http://www.w3.org/TR/CSS2/cascade.html#actual-value)）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-18T16:04:13.707

据我所知，只有 IE（带有 element.currentStyle）允许 JS 检索指定的值，这在我看来是件好事。所有其他浏览器都返回计算值。

我曾经需要指定的值，而我唯一想到的就是制作一个 CSS 解析器，它可以根据元素的 xpath 将元素映射到规则。它可能是某种颠倒的 jQuery，您将在其中提供一个 DOM 元素，并在解析所有加载的 CSS 后返回与其关联的 CSS 规则。不幸的是，我没有时间开始这个项目。

# java - 调用 JTabbedPane.removeAll() 后，JTabbedPane 仍然有 x 个选项卡？

> ID：1013479
> 
> 赞同：2
> 
> 时间：2009-06-18T15:47:08.447
> 
> 标签：java, swing, jtabbedpane

在我的`JTabbedPane`中，我以两种不同的方式删除标签：

```
tabbedPane.remove(index) 
```

和

```
tabbedPane.removeAll() 
```

两者在关闭选项卡方面都可以正常工作。但是，我有一个更改侦听器，`TabbedPane`它回调另一个模块以报告选项卡更改。这就是问题所在。

使用 添加和删除选项卡时，方法中`remove(index)`的源 TabbedPane 在`stateChanged()`检查时包含正确数量的选项卡`tabbedPane.getTabCount()`。

但是，在调用`tabbedPane.getTabCount()`after时`tabbedPane.removeAll()`，计数仍然是紧接在 之前的计数`removeAll()`。

有没有人有什么建议？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-06-18T16:02:46.093

查看源代码后，我知道发生了什么。

`JTabbedPane``ChangeEvents`更改“选定”选项卡时发射。但是要删除所有选项卡，它首先将选定选项卡设置为 -1，*然后*删除所有选项卡。因此，当`ChangeListener`捕获事件时，所有选项卡仍然存在。

如果您想随时知道选项卡的数量，恐怕您必须自己遍历选项卡并逐个删除它们。

```
while (myTabbedPane.getTabCount() > 0)
    myTabbedPane.remove(0); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-18T16:30:36.593

干得好; 改用 ContainerListener：

```
import java.awt.event.ContainerEvent;
import java.awt.event.ContainerListener;

import javax.swing.JPanel;
import javax.swing.JTabbedPane;

import junit.framework.TestCase;

public class JTabbedPaneTest extends TestCase {
    private JTabbedPane pane;
    private int         count   = 0;

    protected void setUp() throws Exception {
        pane = new JTabbedPane();
        ContainerListener containerListener = new ContainerListener() {
            public void componentAdded(ContainerEvent e) {
                count++;
            }

            public void componentRemoved(ContainerEvent e) {
                count--;
            }
        };
        pane.addContainerListener(containerListener);
        JPanel panel1 = new JPanel();
        JPanel panel2 = new JPanel();
        pane.add(panel1);
        pane.add(panel2);
    }

    public void testOne() throws Exception {
        assertEquals(2, count);
        assertEquals(2, pane.getTabCount());
        pane.remove(0);
        pane.remove(0);
        assertEquals(0, count);
        assertEquals(0, pane.getTabCount());
    }

    public void testMany() throws Exception {
        assertEquals(2, count);
        assertEquals(2, pane.getTabCount());
        pane.removeAll();
        assertEquals(0, count);
        assertEquals(0, pane.getTabCount());
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-18T16:01:34.487

查看`JTabbedPane`代码（第 6 版），两个代码都通过`removeTabAt`，这应该会减少计数。但是，它可能会为每个选项卡触发一个事件，这意味着第一个事件应该`getTabCount()`比`removeAll()`.

你确定`getTabCount()`来电吗？如果您手动删除所有标签（从最后）会发生什么？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-18T16:12:40.997

这是一个有助于暴露问题的测试用例。

```
import javax.swing.JPanel;
import javax.swing.JTabbedPane;
import javax.swing.event.ChangeEvent;
import javax.swing.event.ChangeListener;

import junit.framework.TestCase;

public class JTabbedPaneTest extends TestCase {
    private JTabbedPane     pane;
    private int             count = 0;

    protected void setUp() throws Exception {
        pane = new JTabbedPane();
        ChangeListener listener = new ChangeListener() {
            public void stateChanged(ChangeEvent e) {
                JTabbedPane pane = (JTabbedPane)e.getSource();
                int before = count;
                count = pane.getTabCount();
                System.out.println(String.format("%s --> %s", before, count));
            }
        };
        pane.addChangeListener(listener);
        JPanel panel1 = new JPanel();
        JPanel panel2 = new JPanel();
        pane.add(panel1);
        pane.add(panel2);
    }

    public void testOne() throws Exception {
        assertEquals(1, count); // I actually expect 2
        assertEquals(2, pane.getTabCount());
        pane.remove(0);
        pane.remove(0);
        assertEquals(0, count);
        assertEquals(0, pane.getTabCount());
    }

    public void testMany() throws Exception {
        assertEquals(1, count); // I actually expect 2
        assertEquals(2, pane.getTabCount());
        pane.removeAll();
        assertEquals(2, count); // I actually expect 0
        assertEquals(0, pane.getTabCount());
    }
} 
```

我认为存在同步问题；输出是：

```
0 --> 1
1 --> 1
1 --> 0
0 --> 1
1 --> 2 
```

看起来好像一些更改事件正在丢失。

**更新**：为后代保留它，​​但这是错误的；正如 mmyers 指出的那样，事件仅在选择更改时触发。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-18T16:16:57.753

尝试调用[validate](http://java.sun.com/j2se/1.5.0/docs/api/java/awt/Container.html#validate())或[revalidate](http://java.sun.com/j2se/1.5.0/docs/api/javax/swing/JComponent.html#revalidate())

# c# - 解析 FtpWebRequest ListDirectoryDe tails 行

> ID：1013486
> 
> 赞同：12
> 
> 时间：2009-06-18T15:48:01.083
> 
> 标签：c#, parsing, ftp, ftpwebrequest

我需要一些帮助来解析`ListDirectoryDetails`C# 中的响应。

我只需要以下字段。

*   文件名/目录名
*   创建日期
*   和文件大小。

这是我运行时某些行的样子`ListDirectoryDetails`：

```
d--x--x--x    2 ftp      ftp          4096 Mar 07  2002 bin
-rw-r--r--    1 ftp      ftp        659450 Jun 15 05:07 TEST.TXT
-rw-r--r--    1 ftp      ftp      101786380 Sep 08  2008 TEST03-05.TXT
drwxrwxr-x    2 ftp      ftp          4096 May 06 12:24 dropoff 
```

提前致谢。

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2009-08-25T15:33:09.393

不知道你是否还需要这个，但这是我想出的解决方案：

```
Regex regex = new Regex ( @"^([d-])([rwxt-]{3}){3}\s+\d{1,}\s+.*?(\d{1,})\s+(\w+\s+\d{1,2}\s+(?:\d{4})?)(\d{1,2}:\d{2})?\s+(.+?)\s?$",
    RegexOptions.Compiled | RegexOptions.Multiline | RegexOptions.IgnoreCase | RegexOptions.IgnorePatternWhitespace ); 
```

比赛组：

1.  对象类型：
    *   d：目录
    *   - ： 文件
2.  权限数组[3] (rwx-)
3.  文件大小
4.  最后修改日期
5.  上次修改时间
6.  文件/目录名称

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2016-10-14T14:40:14.787

对于此特定列表，以下代码将执行：

```
var request = (FtpWebRequest)WebRequest.Create("ftp://ftp.example.com/");
request.Credentials = new NetworkCredential("user", "password");
request.Method = WebRequestMethods.Ftp.ListDirectoryDetails;
var reader = new StreamReader(request.GetResponse().GetResponseStream());

string pattern =
    @"^([\w-]+)\s+(\d+)\s+(\w+)\s+(\w+)\s+(\d+)\s+" +
    @"(\w+\s+\d+\s+\d+|\w+\s+\d+\s+\d+:\d+)\s+(.+)$";
Regex regex = new Regex(pattern);
IFormatProvider culture = CultureInfo.GetCultureInfo("en-us");
string[] hourMinFormats =
    new[] { "MMM dd HH:mm", "MMM dd H:mm", "MMM d HH:mm", "MMM d H:mm" };
string[] yearFormats =
    new[] { "MMM dd yyyy", "MMM d yyyy" };

while (!reader.EndOfStream)
{
    string line = reader.ReadLine();
    Match match = regex.Match(line);
    string permissions = match.Groups[1].Value;
    int inode = int.Parse(match.Groups[2].Value, culture);
    string owner = match.Groups[3].Value;
    string group = match.Groups[4].Value;
    long size = long.Parse(match.Groups[5].Value, culture);
    string s = Regex.Replace(match.Groups[6].Value, @"\s+", " ");

    string[] formats = (s.IndexOf(':') >= 0) ? hourMinFormats : yearFormats;
    var modified = DateTime.ParseExact(s, formats, culture, DateTimeStyles.None);
    string name = match.Groups[7].Value;

    Console.WriteLine(
        "{0,-16} permissions = {1}  size = {2, 9}  modified = {3}",
        name, permissions, size, modified.ToString("yyyy-MM-dd HH:mm"));
} 
```

您将获得（截至 2016 年）：

```
bin              permissions = d--x--x--x  size =      4096  modified = 2002-03-07 00:00
TEST.TXT         permissions = -rw-r--r--  size =    659450  modified = 2016-06-15 05:07
TEST03-05.TXT    permissions = -rw-r--r--  size = 101786380  modified = 2008-09-08 00:00
dropoff          permissions = drwxrwxr-x  size =      4096  modified = 2016-05-06 12:24 
```

* * *

但是，实际上尝试解析返回的列表`ListDirectoryDetails`并不是正确的方法。

您希望使用支持现代命令的 FTP 客户端，该命令以[RFC 3659](https://datatracker.ietf.org/doc/html/rfc3659)`MLSD`中指定的机器可读格式返回目录列表。在与不支持该命令的过时 FTP 服务器（如 Microsoft IIS FTP 服务器）通信时，解析由古老命令返回的人类可读格式（由for 其方法内部使用）应作为最后的选择.`LIST``FtpWebRequest``ListDirectoryDetails``MLSD`

`LIST`许多服务器对命令响应使用不同的格式。特别是 IIS 可以使用 DOS 格式。请参阅[C# 类以解析 WebRequestMethods.Ftp.ListDirectoryDe​​tails FTP 响应](https://stackoverflow.com/q/7060983/850848#39771146)。

* * *

例如，使用[WinSCP .NET 程序集](https://winscp.net/eng/docs/library)，您可以使用它的[`Session.ListDirectory`](https://winscp.net/eng/docs/library_session_listdirectory)或[`Session.EnumerateRemoteFiles`](https://winscp.net/eng/docs/library_session_enumerateremotefiles)方法。

他们在内部使用该`MLSD`命令，但可以回退到该`LIST`命令并支持数十种不同的人类可读列表格式。

返回的列表显示为具有以下属性的[`RemoteFileInfo`实例集合：](https://winscp.net/eng/docs/library_remotefileinfo)

*   `Name`
*   `LastWriteTime`（使用正确的时区）
*   `Length`
*   `FilePermissions`（解析为个人权利）
*   `Group`
*   `Owner`
*   `IsDirectory`
*   `IsParentDirectory`
*   `IsThisDirectory`

*（我是WinSCP的作者）*

* * *

大多数其他 3rd 方库也会这样做。为此目的使用[`FtpWebRequest`该类是不可靠的。](https://docs.microsoft.com/en-us/dotnet/api/system.net.ftpwebrequest)不幸的是，.NET 框架中没有其他内置的 FTP 客户端。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2017-09-06T08:10:12.263

基于**Ryan Conrad**的正则表达式思想，这是我的最终阅读代码：

```
protected static Regex m_FtpListingRegex = new Regex(@"^([d-])((?:[rwxt-]{3}){3})\s+(\d{1,})\s+(\w+)?\s+(\w+)?\s+(\d{1,})\s+(\w+)\s+(\d{1,2})\s+(\d{4})?(\d{1,2}:\d{2})?\s+(.+?)\s?$",
            RegexOptions.Compiled | RegexOptions.Multiline | RegexOptions.IgnoreCase | RegexOptions.IgnorePatternWhitespace);
protected static readonly String Timeformat = "MMM dd yyyy HH:mm";

/// <summary>
/// Handles file info given in the form of a string in standard unix ls output format.
/// </summary>
/// <param name="filesListing">The file listing string.</param>
/// <returns>A list of FtpFileInfo objects</returns>
public static List<FtpFileInfo> GetFilesListFromFtpListingUnix(String filesListing)
{
    List<FtpFileInfo> files = new List<FtpFileInfo>();
    MatchCollection matches = m_FtpListingRegex.Matches(filesListing);
    if (matches.Count == 0 && filesListing.Trim('\r','\n','\t',' ').Length != 0)
        return null; // parse error. Could throw some kind of exception here too.
    foreach (Match match in matches)
    {
        FtpFileInfo fileInfo = new FtpFileInfo();
        Char dirchar = match.Groups[1].Value.ToLowerInvariant()[0];
        fileInfo.IsDirectory = dirchar == 'd';
        fileInfo.Permissions = match.Groups[2].Value.ToCharArray();
        // No clue what "inodes" actually means...
        Int32 inodes;
        fileInfo.NrOfInodes = Int32.TryParse(match.Groups[3].Value, out inodes) ? inodes : 1;
        fileInfo.User = match.Groups[4].Success ? match.Groups[4].Value : null;
        fileInfo.Group = match.Groups[5].Success ? match.Groups[5].Value : null;
        Int64 fileSize;
        Int64.TryParse(match.Groups[6].Value, out fileSize);
        fileInfo.FileSize = fileSize;
        String month = match.Groups[7].Value;
        String day = match.Groups[8].Value.PadLeft(2, '0');
        String year = match.Groups[9].Success ? match.Groups[9].Value : DateTime.Now.Year.ToString(CultureInfo.InvariantCulture);
        String time = match.Groups[10].Success ? match.Groups[10].Value.PadLeft(5, '0') : "00:00";
        String timeString = month + " " + day + " " + year + " " + time;
        DateTime lastModifiedDate;
        if (!DateTime.TryParseExact(timeString, Timeformat, CultureInfo.InvariantCulture, DateTimeStyles.None, out lastModifiedDate))
            lastModifiedDate = DateTime.MinValue;
        fileInfo.LastModifiedDate = lastModifiedDate;
        fileInfo.FileName = match.Groups[11].Value;
        files.Add(fileInfo);
    }
    return files;
} 
```

以及已填充的 FtpFileInfo 类：

```
public class FtpFileInfo
{
    public Boolean IsDirectory { get; set; }
    public Char[] Permissions { get; set; }
    public Int32 NrOfInodes { get; set; }
    public String User { get; set; }
    public String Group { get; set; }
    public Int64 FileSize { get; set; }
    public DateTime LastModifiedDate { get; set; }
    public String FileName { get; set; }
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-08-13T06:53:16.207

这是我获取文件/目录名称、创建日期、属性（文件/目录）、大小的算法。希望这可以帮助...

```
 FtpWebRequest _fwr = FtpWebRequest.Create(uri) as FtpWebRequest     
        _fwr.Credentials = cred;
        _fwr.UseBinary = true;
        _fwr.UsePassive = true;
        _fwr.KeepAlive = true;
        _fwr.Method = WebRequestMethods.Ftp.ListDirectoryDetails;
        StreamReader _sr = new StreamReader(_fwr.GetResponse().GetResponseStream());

        List<object> _dirlist = new List<object>();
        List<object> _attlist = new List<object>();
        List<object> _datelist = new List<object>();
        List<long> _szlist = new List<long>();
        while (!_sr.EndOfStream)
        {
            string[] buf = _sr.ReadLine().Split(' ');
            //string Att, Dir;
            int numcnt = 0, offset = 4; ;
            long sz = 0;
            for (int i = 0; i < buf.Length; i++)
            {
                //Count the number value markers, first before the ftp markers and second
                //the file size.
                if (long.TryParse(buf[i], out sz)) numcnt++;
                if (numcnt == 2)
                {
                    //Get the attribute
                    string cbuf = "", dbuf = "", abuf = "";
                    if (buf[0][0] == 'd') abuf = "Dir"; else abuf = "File";
                    //Get the Date
                    if (!buf[i+3].Contains(':')) offset++;
                    for (int j = i + 1; j < i + offset; j++)
                    {
                        dbuf += buf[j];
                        if (j < buf.Length - 1) dbuf += " ";
                    }
                    //Get the File/Dir name
                    for (int j = i + offset; j < buf.Length; j++)
                    {
                        cbuf += buf[j];
                        if (j < buf.Length - 1) cbuf += " ";
                    }
                    //Store to a list.
                    _dirlist.Add(cbuf);
                    _attlist.Add(abuf);
                    _datelist.Add(dbuf);
                    _szlist.Add(sz);

                    offset = 0;
                    break;
                }
            }
        } 
```

# delphi - Delphi 2009 和旧式对象类型的问题

> ID：1013489
> 
> 赞同：3
> 
> 时间：2009-06-18T15:48:31.330
> 
> 标签：delphi, object, delphi-2009

我有很多旧代码使用我试图在 Delphi 2009 中使用的旧式 pascal 对象类型。它可以编译，但处理虚拟方法似乎存在一些问题。看来这个问题已经在 Quality Central 上报告了：

[http://qc.embarcadero.com/wc/qcmain.aspx?d=71723](http://qc.embarcadero.com/wc/qcmain.aspx?d=71723)

我希望任何仍在使用这些的人（也许是 PatrickvL？）可以提供更多信息。我们有很多使用对象的代码，如果不能解决这个问题，我们就会陷入困境。提前致谢！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-06-18T18:51:19.827

如果您使用虚拟方法，那么您显然是通过引用访问对象，而不是通过值。这就是类在 Delphi 中的工作方式，因此切换到类应该不会太难。

对于任何*没有*虚方法的对象类型，您应该能够将它们变成记录。现在允许记录具有方法以及可见性说明符。但是，不支持继承。

自 1994 年 2 月 14 日（即 Delphi 第一个版本的发布日期）以来，旧式对象已被弃用。从那以后，它们一直在恶化。你应该在几年前离开他们。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-18T20:18:15.133

我必须承认我喝了几杯啤酒，只是为了挑战:) 你需要一些神奇的字节。根据传说，如果您使用任何虚拟方法，旧样式对象只会为指针创建空间。没有虚拟方法没有 VMT。

VMT 指针总是在新样式对象的前面，因为它们都声明了虚拟方法。似乎有人忘记了旧式对象的 VMT 可以稍后出现。所以假设它只有一个指针，这使它可以在我的 D2009 上工作。我不喜欢编译器，一个名叫 Dave Jewell 的人曾经为 PC pro 编写过可能会证实这将是稳定的......

```
Type
  PObject1 = ^TObject1;
  TObject1 = Object
    Magic: Array[0..3] of Byte; //or integer or whatever I was playing with the size
    FCount     : Integer;
    Constructor Init;
    Procedure Add; virtual; 
    Procedure Deduct; virtual; 
    end;

Type
  PObject2   = ^TObject2;
  TObject2   = Object(TObject1)
    Constructor Init;
    end; 
```

然后在构建这些工作之后：

```
.
.
.
Object2^.Add;
Object2^.Deduct; 
```

我得到了适当的控制台输出

我添加了一个额外的过程只是为了确保它适用于 2 个虚拟 :)

顺便说一句，无论您是否输入 ^ 2009 都知道您的意思，它们都有效:(

缺少来自 embracodeland 的适当修复 您可能仍然需要更改每个 BASE 对象定义。希望您可以使用查找和插入/替换或 Grep 来做到这一点...祝您好运。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-06-19T12:18:41.030

好的 - 完成了 - 我不能让它失败.... 您的 D2009 是否已完全修补？项目/编译器选项？

为了绝对确定和比较，这里是我的单位：

---------------项目文件

```
program testD2009;

{$APPTYPE CONSOLE}

uses
  SysUtils,
  Object1U in 'Object1U.pas',
  Object2U in 'Object2U.pas';

Var
  Object1 : PObject1;
  Object2 : PObject2;
begin
  try
    Object1 := New(PObject1,Init);
    Object1^.Add;
    Object1^.Deduct;

    Object2 := New(PObject2,Init);
    Object2^.Add;
    Object2^.Deduct;
    readln;
  except
    on E:Exception do
      Writeln(E.Classname, ': ', E.Message);
  end;
end. 
```

--------------Object1单元

```
unit Object1U;

interface

uses SysUtils;

Type
  PObject1 = ^TObject1;
  TObject1 = Object
    Magic: Array[0..3] of Byte;
    FCount     : Integer;
    Constructor Init;
    Procedure Add; virtual; { removing virtual allows the program to run }
    Procedure Deduct; virtual; { removing virtual allows the program to run }
    end;

implementation

Procedure TObject1.Add;
begin
  Writeln('Object1 Add');
end;

procedure TObject1.Deduct;
begin
  Writeln('Object1 Deduct');
end;

Constructor TObject1.Init;
begin
  inherited;
  FCount      := 0;
  Writeln('TObject1 Init');
end;

end. 
```

----------------对象2单元

```
unit Object2U;

interface

uses Object1U;

Type
  PObject2   = ^TObject2;
  TObject2   = Object(TObject1)
    Constructor Init;
    Procedure Add; virtual; { removing virtual allows the program to run }
    Procedure Deduct; virtual; { removing virtual allows the program to run }
   end;

implementation

procedure TObject2.Add;
begin
  Writeln('Object2 Add');
  inherited;
end;

procedure TObject2.Deduct;
begin
  Writeln('Object2 Deduct');
  inherited;
end;

Constructor TObject2.Init;
begin
  Inherited Init;
  fCount := 1;
  Writeln('TObject2:Init');
end;

end. 
```

----------------程序输出：

```
TObject1 初始化
对象 1 添加
对象1扣除
TObject1 初始化
TObject2：初始化
对象 2 添加
对象 1 添加
对象2扣除
对象1扣除

```

我很困惑:)。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-06-22T10:44:51.730

关于这个问题，我向 Embarcadero 的当地代表发送了一封电子邮件，并让他们参考 Quality Central 的报告。他们基本上告诉我们将所有对象移动到类，所以我猜他们不打算修复这个......永远。我想我们已经基本接受了，如果我们想继续前进，这是我们必须走的路，所以现在我们只需要安排好这项工作，然后才能继续升级到 Delphi 2009。

只是想感谢所有试图提供帮助的人，但我相信在这一点上这是一个失败的事业:-(

# sql-server - SQL Server：避免在还原时重新生成 GUID？

> ID：1013492
> 
> 赞同：0
> 
> 时间：2009-06-18T15:49:08.697
> 
> 标签：sql-server

我有一个表，其中主键是 GUID，默认为 NewID。如果在我备份 PK 列时它的值为 XYZ，我希望 XYZ 在恢复的表中。事实上，我得到了 PQR（以及 GUID 等价物）。看起来 GUID 会在还原时重新生成。这是否真的发生了（看起来有点疯狂），如果发生了，如何避免？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-18T15:54:04.483

没有人在恢复时更改您的数据（我假设您的意思是备份/恢复是真正的 BACKUP/RESTORE 语句，而不是一些自定义数据复制解决方案）。如果 guid 已更改，您要么已恢复不同的数据，要么您正在自己更改数据并且您不确切知道何时（触发器？应用程序？）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-18T16:27:17.097

不，这不可能仅通过还原发生

我还想指出，如果您在 uniqueidentifier 列上有一个 PK 以使用[NEWSEQUENTIALID()](http://msdn.microsoft.com/en-us/library/ms189786.aspx)而不是 NEWID() 因为 NEWID() 会在聚集索引上导致可怕的页面拆分（默认情况下主键是）

我有一些代码只是在这里显示了区别：[一些简单的代码来显示 Newid 和 Newsequentialid 之间的区别](http://sqlblog.com/blogs/denis_gobo/archive/2009/02/05/11743.aspx)

# php - PHP的合并功能？

> ID：1013493
> 
> 赞同：133
> 
> 时间：2009-06-18T15:49:14.653
> 
> 标签：php, optimization, null-coalescing-operator

许多编程语言都有一个合并函数（返回第一个非 NULL 值，[例如](http://www.postgresql.org/docs/9.3/static/functions-conditional.html#FUNCTIONS-COALESCE-NVL-IFNULL)）。PHP，遗憾的是在 2009 年没有。

在 PHP 本身获得合并函数之前，在 PHP 中实现一个的好方法是什么？

* * *

## 回答 #1

> 赞同：199
> 
> 时间：2009-12-12T01:32:16.670

php 5.3 中有一个新的运算符可以执行此操作：`?:`

```
// A
echo 'A' ?: 'B';

// B
echo '' ?: 'B';

// B
echo false ?: 'B';

// B
echo null ?: 'B'; 
```

来源：[http ://www.php.net/ChangeLog-5.php#5.3.0](http://www.php.net/ChangeLog-5.php#5.3.0)

* * *

## 回答 #2

> 赞同：69
> 
> 时间：2015-06-24T08:35:01.407

PHP 7 引入了一个真正的[合并操作符](http://php.net/manual/en/migration70.new-features.php#migration70.new-features.null-coalesce-op)：

```
echo $_GET['doesNotExist'] ?? 'fallback'; // prints 'fallback' 
```

如果前面的值`??`不存在或者是`null`后面的值`??`。

对上述`?:`运算符的改进是，`??`它还可以处理未定义的变量而不抛出`E_NOTICE`.

* * *

## 回答 #3

> 赞同：30
> 
> 时间：2009-06-18T15:51:34.407

在谷歌上首次点击“php coalesce”。

```
function coalesce() {
  $args = func_get_args();
  foreach ($args as $arg) {
    if (!empty($arg)) {
      return $arg;
    }
  }
  return NULL;
} 
```

[http://drupial.com/content/php-coalesce](http://drupial.com/content/php-coalesce)

* * *

## 回答 #4

> 赞同：18
> 
> 时间：2011-01-14T04:58:25.753

我真的很喜欢 ?: 运算符。不幸的是，它还没有在我的生产环境中实现。所以我使用这个等价物：

```
function coalesce() {
  return array_shift(array_filter(func_get_args()));
} 
```

* * *

## 回答 #5

> 赞同：10
> 
> 时间：2010-05-16T19:03:07.577

值得注意的是，由于 PHP 对未初始化变量和数组索引的处理，任何类型的合并函数的使用都是有限的。我希望能够做到这一点：

```
$id = coalesce($_GET['id'], $_SESSION['id'], null); 
```

但是，在大多数情况下，这会导致 PHP 出错并显示 E_NOTICE。在使用变量之前测试变量是否存在的唯一安全方法是直接在 empty() 或 isset() 中使用它。如果您知道合并中的所有选项都已知已初始化，则 Kevin 建议的三元运算符是最佳选择。

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2009-06-18T16:43:18.600

确保您确定您希望此函数如何与某些类型一起使用。PHP 有各种各样的类型检查或类似功能，因此请确保您知道它们是如何工作的。这是 is_null() 和 empty() 的示例比较

```
$testData = array(
  'FALSE'   => FALSE
  ,'0'      => 0
  ,'"0"'    => "0"  
  ,'NULL'   => NULL
  ,'array()'=> array()
  ,'new stdClass()' => new stdClass()
  ,'$undef' => $undef
);

foreach ( $testData as $key => $var )
{
  echo "$key " . (( empty( $var ) ) ? 'is' : 'is not') . " empty<br>";
  echo "$key " . (( is_null( $var ) ) ? 'is' : 'is not')  . " null<br>";
  echo '<hr>';
} 
```

如您所见，empty() 对所有这些都返回 true，但 is_null() 仅对其中 2 个返回 true。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2013-02-20T22:27:36.273

[我正在扩展Ethan Kent](https://stackoverflow.com/a/4688108/177920)发布的答案。[由于array_filter](http://php.net/manual/en/function.array-filter.php)的内部工作原理，该答案将丢弃评估为 false 的非空参数，这不是`coalesce`函数通常所做的。例如：

```
echo 42 === coalesce(null, 0, 42) ? 'Oops' : 'Hooray'; 
```

> 哎呀

为了克服这个问题，需要第二个参数和函数定义。可*调用*函数负责告知`array_filter`是否将当前数组值添加到结果数组中：

```
// "callable"
function not_null($i){
    return !is_null($i);  // strictly non-null, 'isset' possibly not as much
}

function coalesce(){
    // pass callable to array_filter
    return array_shift(array_filter(func_get_args(), 'not_null'));
} 
```

如果您可以简单地将`isset`or`'isset'`作为第二个参数传递给，那就太好了`array_filter`，但没有这样的运气。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-06-18T15:54:44.377

我目前正在使用它，但我想知道它是否无法通过 PHP 5 中的一些新功能进行改进。

```
function coalesce() {
  $args = func_get_args();
  foreach ($args as $arg) {
    if (!empty($arg)) {
    return $arg;
    }
  }
  return $args[0];
} 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2014-09-02T20:21:54.690

PHP 5.3+，带闭包：

```
function coalesce()
{
    return array_shift(array_filter(func_get_args(), function ($value) {
        return !is_null($value);
    }));
} 
```

演示：[https ://eval.in/187365](https://eval.in/187365)

# php - 使用 PHP 去除 HTML 注释但保留条件

> ID：1013499
> 
> 赞同：7
> 
> 时间：2009-06-18T15:51:28.710
> 
> 标签：php, regex, comments, conditional, strip

我目前正在使用 PHP 和正则表达式从页面中删除所有 HTML 注释。该脚本运行良好......有点太好了。它会删除所有评论，包括我在 . 这是我所拥有的：

```
<?php
  function callback($buffer)
  {
        return preg_replace('/<!--(.|\s)*?-->/', '', $buffer);
  }

  ob_start("callback");
?>
... HTML source goes here ...
<?php ob_end_flush(); ?> 
```

由于我的正则表达式不太热，我很难弄清楚如何修改模式以排除条件注释，例如：

```
<!--[if !IE]><!-->
<link rel="stylesheet" href="/css/screen.css" type="text/css" media="screen" />
<!-- <![endif]-->

<!--[if IE 7]>
<link rel="stylesheet" href="/css/ie7.css" type="text/css" media="screen" />
<![endif]-->

<!--[if IE 6]>
<link rel="stylesheet" href="/css/ie6.css" type="text/css" media="screen" />
<![endif]--> 
```

干杯

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2009-06-18T16:52:18.987

由于注释不能嵌套在 HTML 中，理论上，正则表达式可以完成这项工作。尽管如此，使用某种解析器将是更好的选择，尤其是在您的输入不能保证格式正确的情况下。

这是我的尝试。要仅匹配普通评论，这将起作用。它已经变成了一个怪物，对此感到抱歉。我已经对它进行了广泛的测试，它似乎做得很好，但我不做任何保证。

```
<!--(?!\s*(?:\[if [^\]]+]|<!|>))(?:(?!-->).)*--> 
```

解释：

```
<!--                #01: "<!--"
(?!                 #02: look-ahead: a position not followed by:
  \s*               #03:   any number of space
  (?:               #04:   non-capturing group, any of:
    \[if [^\]]+]    #05:     "[if ...]"
    |<!             #06:     or "<!"
    |>              #07:     or ">"
  )                 #08:   end non-capturing group
)                   #09: end look-ahead
(?:                 #10: non-capturing group:
  (?!-->)           #11:   a position not followed by "-->"
  .                 #12:   eat the following char, it's part of the comment
)*                  #13: end non-capturing group, repeat
-->                 #14: "-->" 
```

步骤#02 和#11 至关重要。#02 确保以下字符不表示条件注释。之后，#11 确保后面的字符不表示注释的结尾，而 #12 和 #13 导致实际匹配。

应用“global”和“dotall”标志。

做相反的事情（只匹配条件注释），它会是这样的：

```
<!(--)?(?=\[)(?:(?!<!\[endif\]\1>).)*<!\[endif\]\1> 
```

解释：

```
<!                  #01: "<!"
(--)?               #02: two dashes, optional
(?=\[)              #03: a position followed by "["
(?:                 #04: non-capturing group:
  (?!               #05:   a position not followed by
    <!\[endif\]\1>  #06:     "<![endif]>" or "<![endif]-->" (depends on #02)
  )                 #07:   end of look-ahead
  .                 #08:   eat the following char, it's part of the comment
)*                  #09: end of non-capturing group, repeat
<!\[endif\]\1>      #10: "<![endif]>" or "<![endif]-->" (depends on #02) 
```

同样，应用“global”和“dotall”标志。

步骤#02 是因为“downlevel-revealed”语法，请参阅：[“MSDN - About Conditional Comments”](http://msdn.microsoft.com/en-us/library/ms537512(VS.85).aspx)。

我不完全确定允许或预期的空间。在适当的地方添加`\s*`到表达式中。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-18T16:10:30.713

如果你不能让它与一个正则表达式一起工作，或者你发现你想保留更多你可以使用的注释[`preg_replace_callback`](http://php.net/preg_replace_callback)。然后，您可以定义一个函数来单独处理评论。

```
<?php
function callback($buffer) {
    return preg_replace_callback('/<!--.*-->/U', 'comment_replace_func', $buffer);
}

function comment_replace_func($m) {
    if (preg_match( '/^\<\!--\[if \!/i', $m[0])) {
        return $m[0];   
    }              

    return '';
}   

ob_start("callback");
?>

... HTML source goes here ...

<?php ob_end_flush(); ?> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-23T08:46:03.210

总之，这似乎是最好的解决方案：

```
<?php
  function callback($buffer) {
    return preg_replace('/<!--[^\[](.|\s)*?-->/', '', $buffer);
  }
  ob_start("callback");
?>
... HTML source goes here ...
<?php ob_end_flush(); ?> 
```

它去除了所有注释并留下除最上面的条件之外的条件：

```
<!--[if !IE]><!-->
<link rel="stylesheet" href="/css/screen.css" type="text/css" media="screen" />
<!-- <![endif]--> 
```

额外的似乎导致问题的地方。

如果有人可以建议考虑到这一点的正则表达式并将该条件也保留在适当的位置，那将是完美的。

Tomalak 的解决方案看起来不错，但作为一个新手并且没有进一步的指导方针，我不知道如何实施它，尽管如果有人可以详细说明如何应用它，我想尝试一下？

谢谢

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-18T16:06:43.460

像这样的东西可能会起作用：

```
/<!--[^\[](.|\s)*?-->/ 
```

它与您的相同，只是它忽略了评论，评论开始标签后面有一个左括号。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-18T16:07:04.583

我不确定 PHP 的正则表达式引擎是否会喜欢以下内容，但请尝试以下模式：

```
'/<!--(.|\s)*(\[if .*\]){0}(.|\s)*?-->/' 
```

# .net - 有没有办法将枚举映射到 C#.NET 3.5 中的另一个枚举？

> ID：1013500
> 
> 赞同：0
> 
> 时间：2009-06-18T15:51:32.533
> 
> 标签：.net, c#-3.0, enums

我正在尝试设置将某些特定于项目的值映射到标准 System.Drawing.Color 枚举的枚举。

这是我想做的事情的想法：

```
public enum SessionColors
{
     Highlights = Color.HotPink,
     Overlays   = Color.LightBlue,
     Redaction  = Color.Black   
} 
```

目标是拥有它，以便我可以将 SessionColors.Highlights 用于我识别为突出显示的内容，但是，我可以稍后更改枚举映射并影响所有后续颜色。

我意识到我可以查找 Color.HotPink 等的值，然后使用这些值，但不是很清楚。那里有更好的主意吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-06-18T15:55:30.320

只需使用公共常量即可：

```
public static class SessionColors
{
    public static readonly Color Highlights = Color.HotPink;
    public static readonly Color Overlays   = Color.LightBlue;
    public static readonly Color Redaction  = Color.Black;
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-18T15:56:40.257

Colors.HotPink 不是枚举值，它是返回 Color 值的静态类 Colors 的静态属性。并且那个颜色值是一个结构，而不是一个整数。

因此，您不能使用 Color 作为枚举的基础值，因为它仅限于整数类型。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-18T15:58:18.790

我个人会使用静态类中的颜色属性而不是枚举来完成。这样做有很多优点，但可能最有益的是，这可以让您在运行时从 app.config（或其他配置源）加载颜色，而无需强制重新编译。

# ruby-on-rails - 您如何将 Ruby 应用程序中“require”的完整序列和顺序作为树来跟踪？

> ID：1013507
> 
> 赞同：8
> 
> 时间：2009-06-18T15:52:15.390
> 
> 标签：ruby-on-rails, ruby, require, autoload

如何显示 Ruby 应用程序中发生的“要求”的层次结构？

某些文件需要需要附加文件的文件。

但是，通过在调试模式下运行应用程序，您只会触发所需文件的子集 - 仅触发您的应用程序在任何给定时间点使用的任何功能子集使用的文件。

**您如何将应用程序中所有需求的综合层次结构显示为树？**

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-06-18T16:21:05.850

问题是在开发模式下，所有文件都是加载的，`load`而不是`require`在每个请求时都可以重新加载。在生产中，它们只加载一次。除了一些框架类之外，大多数文件仍然只在第一次使用时才加载。发生这种情况是因为 ActiveSupport 覆盖 const_missing 以自动尝试从具有适当命名方案（`ConstantName.to_s.underscore`将给出`require 'constant_name'`）的文件中加载未知常量。当然，这确实混淆了“要求”层次结构。

对于一个琐碎的情况，您可以修改以下内容以满足您的一些需求（另请查看 active_support 中的依赖项）

```
 $require_level = []
  alias :orig_require :require
  def require(file)
    puts "#{$require_level.join}#{file}"
    $require_level << "-"
    r = orig_require(file)
    $require_level.pop
    r
  end

  require 'foo'
  require 'baz'

 ben@legba-2:~ $ ruby check_requires.rb 
 foo
 -bar
 baz 
```

祝你好运

编辑：解释

这样做是创建一个全局数组来存储需求的嵌套级别。第一个 puts 输出所需的文件。然后将破折号添加到嵌套级别。然后实际上需要该文件。如果加载的文件调用 require，那么整个过程会重新开始，除了嵌套级别为 1 深，因此 "-#{file}" 是 puts-ed。除非嵌套级别增加，否则此过程会重复，破折号也会重复。加载文件及其所有依赖项后，require 会删除它添加的破折号，以便嵌套级别处于与 require 启动时相同的状态。这使树结构保持准确。

const_missing 类似于 method_missing。基本上，就像当你调用`AnObject.some_unknown_method`ruby​​ 时会`AnObject.method_missing(:some_unknown_method)`在引发 NoMethodError 之前调用一样，使用 SomeUnknownConstant`const_missing(:SomeUnknownConstant)`在引发 NameError 之前会触发 a。Rails 定义了 const_missing 以便它会在某些指定的路径中搜索可能定义缺失常量的文件。它使用命名约定来促进这一点，例如`SomeUnknownConstant`预计在`some_unknown_constant.rb`

有一种方法可以解决很多这种疯狂的问题。

# ruby-on-rails - 识别 ApplicationController (RoR) 中方法的调用者

> ID：1013513
> 
> 赞同：0
> 
> 时间：2009-06-18T15:53:25.310
> 
> 标签：ruby-on-rails, ruby

我的 ApplicationController 中有一个方法，它是 before_filter 的一部分。如何识别哪个控制器正在调用该方法，我可以向它传递参数吗？

可能是最坏的情况，我可以创建一个使用控制器名称和值的新对象，然后使用 NewObject.find(:first, :conditions => ['controller_name = ?', controller_name] 在 before_filter 方法中直接调用它，但是闻起来很糟糕。

所以我对想法持开放态度。提前致谢。

伪短代码：

```
class ApplicationController < ActionController::Base
    before_filter :someMethod
    ....
    def someMethod
        Do stuff
    end

class SomeController < ApplicationController
    # presumably the before_filter runs here
    @someValueIWantToPass = some.value
    ... 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-06-18T16:09:21.837

`params[:controller]`并`params[:action]`包含请求的控制器和操作，并且可从过滤器内部获得。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-18T16:09:13.210

使用 self.class 会告诉你哪个控制器调用了 before_filter。

```
class HomeController < ApplicationController
  before_filter :awesome

  def index
    render :text => @blah
  end

  def awesome
    @blah = self.class
  end
end 
```

将呈现“HomeController”

# unix - 众所周知的 UID 是什么？

> ID：1013516
> 
> 赞同：5
> 
> 时间：2009-06-18T15:53:49.570
> 
> 标签：unix

根据`useradd`手册页，低于 1000 的 UID 通常保留给系统帐户。

我正在开发一项将作为自己的用户运行的服务。我知道可以在`/etc/services`.

有没有一个地方可以让我找到那里有哪些著名的 UID？我想避免与其他人的 UID 崩溃。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-06-18T16:04:29.777

[`getpwent(3)`](http://linux.die.net/man/3/getpwent)遍历密码数据库（通常`/etc/passwd`，但不一定；例如，系统可能位于 NIS 域中）。系统已知的任何 UID 都应在此处表示。

为了演示，下面的 shell 片段和 C 代码都应该打印系统上所有已知的 UID。

```
$ 获取密码 | 剪切-d：-f3

```

```
#include <pwd.h>
#include <stdio.h>
int main() {
    struct passwd *pw;
    while ((pw = getpwent()))
        printf("%d\n", pw->pw_uid);
} 
```

UID 0 始终是 root 并且通常 UID 65534 是`nobody`，但是您不应该指望它，也不能指望其他任何东西。使用的 UID 因操作系统、发行版甚至系统而异——例如，Gentoo 上的许多系统服务在安装时分配 UID。没有使用中的 UID 中央数据库。

此外，`/etc/login.defs`定义什么是“系统 UID”。在我的桌面上，它被配置为将 UID 100-999 视为系统帐户，而 UIDS 1000-60000 是用户帐户，但这很容易更改。

如果您正在编写服务，我建议您编写包安装脚本以根据需要分配 UID，并且您的软件可配置为使用任何 UID/用户名。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2017-06-15T12:22:50.377

我知道这是一篇旧帖子，但由于我 2017 年来到这里，仍然试图回答一个类似的问题，我认为这些附加信息与处于同一位置的其他任何人相关。

“众所周知的 UID”的概念可以追溯到 unix 的早期，那时还没有大量的发行版和 unix 变体。“众所周知”的 UID 被认为是用于系统用户的那些，例如 adm、daemon、lp、sync、operator、news、mail 等，并且是所有各种系统的标准，以避免 UID 冲突。这些用户仍然存在于现代类 Unix 操作系统中。

在整个组织中标准化 uid 是避免这些问题的关键。正如上面评论中指出的那样，这些天您选择的任何 uid 都可能在“某处”使用，因此系统管理员可以瞄准的最佳目标是确保 uid 在他们维护的所有系统中都是标准的，然后分配应用程序的新 uid 变得简单。

为此，多年来我发现下面链接的帖子非常宝贵，遗憾的是，关于该主题的类似帖子并不多，而且很难找到。

[UNIX/Linux：分析用户/组 UID/GID 冲突](https://web.archive.org/web/20180420155349/https://www.ibm.com/developerworks/community/blogs/brian/entry/unix_linux_analyzing_user_group_uid_gid_conflicts1?lang=en)

如果您在“uid”标签下搜索该博客，还有其他相关文章，包括一个脚本，用于自动化在 Linux 下跨多个主机标准化 uid 的过程。

This [User ID Definition](http://www.linfo.org/uid.html) is also an invaluable resource.

The short answer is, that it doesn't really matter which uid's you use, as long as they are unique and standard across your organisation, to avoid clashes.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-18T16:00:26.890

我不确定这样的列表是否存在。**通过/etc/passwd**文件、**/etc/shadow**文件和**NIS 全局用户列表**注意正在使用的 UID，并注意正在使用的 UID怎么样？然后使用一个不是！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-22T23:25:11.503

在 Linux 中，这是在`/etc/login.defs`. 有时，当我安装基于 Debian 的系统时，我将“uid start”选项（我忘记它的名字，我现在不在 Linux 上）从 1000 更改为 500，以便与其他 Red Hat-y 机器保持一致。

`man login.defs`应该给你你想要的所有信息。

# windows - Windows 7：利用自动提升来提升我自己的流程？

> ID：1013531
> 
> 赞同：5
> 
> 时间：2009-06-18T15:55:25.420
> 
> 标签：windows, windows-7, uac, elevation, rootkit

从 2009 年 7 月 Technet 一篇题为[Inside Windows 7 User Account Control](http://technet.microsoft.com/en-us/magazine/2009.07.uac.aspx)的文章中，**Mark Russinovish**描述了以标准用户身份运行的应用程序可以静默提升并获得管理权限：

> ...在具有标准用户权限的 PA（受保护的管理员）帐户中运行的第三方软件可以利用自动提升来获得管理权限。例如，该软件可以使用 [WriteProcessMemory API](http://msdn.microsoft.com/en-us/library/ms681674.aspx)将代码注入*Explorer*，并使用 [CreateRemoteThread API](http://msdn.microsoft.com/en-us/library/ms682437(VS.85).aspx)执行该代码，这种技术称为*DLL 注入*。由于代码在资源管理器（Windows 可执行文件）中执行，因此它可以利用自动提升的 COM 对象（如复制/移动/重命名/删除/链接对象）来修改系统注册表项或目录并赋予软件管理权限权利。

他继续提到恶意软件永远不会这样做，因为这太难了：

> ...这些步骤需要刻意的意图，而不是微不足道的...

最后

> ...恶意软件可以使用相同的技术获得管理权限。

所以我很想看到一个实际的实现。

* * *

我原以为**[PROCESS_VM_WRITE](http://msdn.microsoft.com/en-us/library/ms684880.aspx)**将是不授予标准用户的权利。

**注意：**我自己永远不会做任何坏事，就像世界上所有其他开发人员一样。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-19T13:51:05.490

Long Zheng，在[istartedsomething.com](http://istartedsomething.com)上有几篇关于自动提升应用程序的帖子。他不是源代码的作者，但他链接到制作概念验证的人。

[你可以在这里](http://www.istartedsomething.com/20090613/windows-7-uac-code-injection-vulnerability-video-demonstration-source-code-released/ "Windows 7 UAC代码注入漏洞：视频演示，源码发布")阅读更多关于它的信息。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-08-10T18:00:39.913

您是在谈论使用进程注入吗？还是提升特权？

如果您想查看进程注入的代码示例，此线程有一些示例： [http ://www.rohitab.com/discuss/index.php?showtopic=23539&hl=bypassing+firewall](http://www.rohitab.com/discuss/index.php?showtopic=23539&hl=bypassing+firewall)

# wpf - Linq 和 ObservableCollection

> ID：1013533
> 
> 赞同：1
> 
> 时间：2009-06-18T15:55:49.617
> 
> 标签：wpf, linq, observablecollection, entityset

我的 WPF 应用程序中的 Linq 和 ObservableCollections 有问题。

问题的背景：

我创建了一个非常简单的 SQL 数据库，其中包含两个表：User 和 BankAccounts。User 表与 BankAccounts 表具有一对多的关系。接下来我创建了 Linq-to-SQL 数据类，它运行良好 ==> 两个表之间的关联也被检测到。

接下来我创建了一个函数来检索所有正常工作的用户：

```
DataClassesDataContext dc = new DataClassesDataContext

var query = from u in dc.Users
            select u; 
```

现在假设我想为每个用户添加一个新的 BankAccount（不太可能但仍然如此）。我可以添加以下代码

```
for each(User u in query)
{
   u.BankAccounts.Add(New BankAccount());
} 
```

以上工作一切正常。由于数据库和 Linq DataClasses 中的关联，BankAccounts 属性自动成为 User 类的一部分。

但是，在我的应用程序中，我首先将查询结果添加到 ObservableCollection。因此，我可以使用各种数据绑定和更改通知。这是通过以下代码完成的；

```
ObservableCollection<User> oUsers = new ObservableCollection<User>(query); 
```

**问题：**在 ObservableCollection 中，我不能对用户的 BankAccounts 属性做任何事情，因为它现在是 EntitySet<> 类型。所以我不能再做下面的陈述了。

```
for each(User u in oUsers)
{
   u.BankAccounts.Add(New BankAccount());
} 
```

不知何故，当查询结果被添加到 observablecollection 时，就不可能再访问 user.BankAccounts 属性了。但是，可以将 BankAccounts 属性绑定到任何控件，如列表框，并且它包含正确的数据。

有人现在如何创建一个 observableColction （或类似的集合），我可以访问这些“关联”属性吗？我真的很期待一个解决方案。

提前致谢！此致，

Bas Zweeris 邮箱：Bas.Zweeris@Capgemini.com

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-12-09T19:53:50.893

跟踪`query`将实现 IQueryable 的原始版本，您可以针对它运行任何进一步的查询。

ObservableCollection 应该只是让 WPF 有一些东西可以绑定 - 如果您想添加一个新的集合项但在用户有机会编辑它之前没有将它推送到数据库，它非常有用。

例如。

```
// Create a new blank client type
var ct = new ClientType()
{
    IsArchived = false,
    Description = "<new client type>",
    Code = "CT000",
    CanLoginOnline = true
};

// Tell the data source to keep track of this object
db.ClientTypes.InsertOnSubmit(ct);

// Also add the object to the observable collection so that it can immediately be shown in the UI and editted without hitting the db
clienttypes.Add(ct); 
```

# ruby-on-rails - Ruby on Rails - 变量中的变量

> ID：1013541
> 
> 赞同：1
> 
> 时间：2009-06-18T15:57:30.477
> 
> 标签：ruby-on-rails, variables

好的。所以我有一个叫做联系人的表。在此表中，我有人员和联系信息以及他们首选的联系方式（电话、地址、电子邮件或传真）。我希望能够让 ruby​​ 以我可以复制粘贴到电子邮件地址栏等的方式输出所述人员的列表。

```
<% @contacts.each do |contact| %>
      <%=h contact.contact_name %> < <%=h contact.preferred_method %> >,
<% end %> 
```

这行得通，但它并没有做我想做的事，而且我没想到会这样做。因此，对于首选电子邮件的人员列表，它将列表输出为。

迈克 < 电子邮件 >、乔 < 电子邮件 >、约翰 < 地址 >、莎拉 < 电话 >

代替

```
Mike <mike@yahoo.com>, Joe <joe@aol.com>, John <2014 Street>, Sarah <111-111-1111> 
```

它调用了preferred_method，但我真正想要它做的是......

```
<% @contacts.each do |contact| %>
      <%=h contact.contact_name %> < <%=h contact.<%=h contact.preferred_method %> >,
<% end %> 
```

所以我会根据他们的preferred_method 获得contact.address 或contact.phone。但显然这行不通。所以我想尝试分配 `<%=h contact.preferred_method %>`给一个变量。

```
x = contact.preferred_method 
```

然后有

```
<% @contacts.each do |contact| %>
      <%=h contact.contact_name %> < <%=h contact.x %> >,
<% end %> 
```

但这也不起作用。

任何帮助，将不胜感激。

麦克风

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-18T16:41:56.590

您可以使用发送方法。

```
<%=h contact.send(contact.preferred_method.downcase) %> 
```

调用由接收对象上的符号或字符串标识的方法。

```
contact.send(:email) 
contact.send('address') 
```

请注意，我在 contact.preferred_method 上设置了一个小写字母，因为我假设您的方法名称是“电子邮件”而不是“电子邮件”

# flash - 时间线操作不起作用 CS3

> ID：1013542
> 
> 赞同：0
> 
> 时间：2009-06-18T15:57:38.370
> 
> 标签：flash, actionscript-3, timeline

这是一个很简单的问题。我可以在 CS3 中创建一个全新的 FLA 并添加

```
trace("hello"); 
```

到第一帧，运行它，没有任何反应。我在 CS4 中创建了具有相同帧动作的相同文件，并且“hello”出现在输出窗口中。这不是主要的，因为通常我不编写任何时间线脚本，但如果我想编写一个快速测试，最好不必制作单独的文档类。

谁能提供任何关于为什么失败的见解？是否按顺序重新安装？我发现 CS4 非常不愉快，除非我需要一些 FP10 功能，否则我很想继续使用 3。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-18T16:01:51.477

在发布设置中，在 Flash 选项卡下，有一个“省略跟踪操作”复选框，请确保未选中。如果不是这样，请尝试在“控制”>“删除 ASO 文件”下，然后重试。我希望这两个中的一个对你有帮助！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-18T16:15:09.157

您的评论可能表明某些事情在 as3 中到达您的跟踪之前出现了故障。有没有编译错误？

乔什

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-02-10T11:44:52.950

我有同样的问题。

事实证明，我试图实例化未在第一帧中导出且未在舞台上其他任何地方使用的影片剪辑。剪辑已创建，但所有时间线操作均无效。

就我而言，解决方案是在第一帧中导出。将剪辑放在舞台上的某个地方也应该有效。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-18T23:55:27.490

@josh，没有编译错误。我不确定我是否完全理解原因，但我的 Actionscript 路径中的某些东西导致了失败。我删除了所有路径，然后将默认路径添加回库，你瞧，动作又开始起作用了。

# c# - 如何从 Uri 打印图像？

> ID：1013544
> 
> 赞同：0
> 
> 时间：2009-06-18T15:58:02.927
> 
> 标签：c#, wpf, printing

我正在尝试打印我使用 Uri 对象引用的 JPEG 文件，但遇到了一些困难。我发现在打印图像时，它被略微裁剪并被翻转和镜像。我猜测裁剪是由于尺寸设置不正确造成的，但不知道为什么它会被翻转和旋转。假设这很奇怪，我试图通过对 drawingContext 对象应用转换来解决这个问题，但这会导致打印一个空白页。这是我的代码：

```
public void Print(List<Uri> ListToBePrinted)
{
    XpsDocumentWriter writer = 
       PrintQueue.CreateXpsDocumentWriter(this.SelectedPrinter.PrintQueue);

    PrintCapabilities printerCapabilities = 
       this.SelectedPrinter.PrintQueue.GetPrintCapabilities();

    Size PageSize = 
       new Size(printerCapabilities.PageImageableArea.ExtentWidth,
                printerCapabilities.PageImageableArea.ExtentHeight);

    foreach (Uri aUri in ListToBePrinted)
    {
        BitmapImage anImage = new BitmapImage(aUri);

        //create new visual which would be initialized by image
        DrawingVisual drawingVisual = new DrawingVisual();

        //create a drawing context so that image can be rendered to print
        DrawingContext drawingContext = drawingVisual.RenderOpen();

        // Flips along X and Y axis (flips and mirrors)
        drawingContext.PushTransform(new ScaleTransform(-1, -1));

        drawingContext.DrawImage(anImage, new Rect(PageSize));

        drawingContext.Close();

        writer.Write(drawingVisual);
    }
} 
```

任何帮助将不胜感激 - 谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-23T18:44:13.927

这就是我最终得到的结果：

```
public void Print(List<Uri> ListToBePrinted)
{
    XpsDocumentWriter writer =
        PrintQueue.CreateXpsDocumentWriter(this.SelectedPrinter.PrintQueue);

    PrintCapabilities printerCapabilities =
        this.SelectedPrinter.PrintQueue.GetPrintCapabilities();

    Size PrintableImageSize =
        new Size(printerCapabilities.PageImageableArea.ExtentWidth,
                 printerCapabilities.PageImageableArea.ExtentHeight);

    foreach (Uri aUri in ListToBePrinted)
    {
        DrawingVisual drawVisual = new DrawingVisual();

        ImageBrush imageBrush = new ImageBrush();
        imageBrush.ImageSource = new BitmapImage(aUri);
        imageBrush.Stretch = Stretch.Fill;
        imageBrush.TileMode = TileMode.None;
        imageBrush.AlignmentX = AlignmentX.Center;
        imageBrush.AlignmentY = AlignmentY.Center;

        using (DrawingContext drawingContext = drawVisual.RenderOpen())
        {
            // Flips along X and Y axis (flips and mirrors)
            drawingContext.PushTransform(new ScaleTransform(-1, 1, PrintableImageSize.Width / 2, PrintableImageSize.Height / 2));
            drawingContext.PushTransform(new RotateTransform(180, PrintableImageSize.Width / 2, PrintableImageSize.Height / 2)); // Rotates 180 degree

            drawingContext.DrawRectangle(imageBrush, null, new Rect(25, -25, PrintableImageSize.Width, PrintableImageSize.Height));
        }

        writer.Write(drawVisual);
    }
} 
```

图像有点模糊，但肯定可以接受。我仍然不确定为什么我的图像需要翻转或镜像。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-18T18:33:17.763

你能做类似的事情：

```
BitmapImage anImage = new BitmapImage(aUri);

Image image = new Image();
image.BeginInit();
image.Source = anImage;
image.EndInit();
image.Measure(PageSize);
image.InvalidateVisual(); 
```

然后只需打印 Image 对象，因为它是从 Visual 派生的...您需要调用 InvalidateVisual 以便调用 OnRender，如果不这样做会导致空白图像...

# asp.net-mvc - 无法在 VB MVC 应用程序中创建 HtmlHelper 方法

> ID：1013546
> 
> 赞同：1
> 
> 时间：2009-06-18T15:58:15.733
> 
> 标签：asp.net-mvc, vb.net, model-view-controller, html-helper

我无法弄清楚以下代码中缺少什么。我有一个方法应该添加一个（虚拟）助手扩展：

```
Imports System.Runtime.CompilerServices

Namespace HtmlHelpers

    Public Module HelpExtensions

        <Extension()> _
        Public Function HelpMe(ByVal HtmlHelper As HtmlHelper) As String
            Return "<a>HELP</a>"
        End Function

    End Module

End Namespace 
```

我的观点是这样的：

```
<%@ Page Language="VB" MasterPageFile="~/Views/Shared/Site.Master" Inherits="System.Web.Mvc.ViewPage" %>

<%@ Import Namespace="HtmlHelpers" %>
<asp:Content ID="indexContent" ContentPlaceHolderID="body" runat="server">
    <%=Html.HelpMe()%>
</asp:Content> 
```

但这给了我以下错误：

```
'HelpMe' is not a member of 'System.Web.Mvc.HtmlHelper'. 
```

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-07-21T12:26:25.143

不知道为什么 Import Namespace 指令没有起到作用，但我补充说

```
<add namespace="MyProject.HtmlHelpers"/> 
```

到`<namespaces>`web.config 部分，它现在正在工作。也许如果我做了

```
<%@ Import Namespace="MyProject.HtmlHelpers" %> 
```

它也会起作用吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-07-20T23:09:13.717

在尝试使用扩展方法之前，您是否尝试过重建解决方案？为了让编译器能够识别我的扩展方法的存在，我不得不用 VB.NET 来做这件事。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-02-20T09:31:10.900

我想我刚刚找到了解决方案。

您的助手模块需要位于**App_Code**目录中。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-01-25T06:56:08.800

正如 gfrizzle 所说，将名称空间引用添加到 Views 文件夹中的 web.config 可以使页面正确显示。但是，我必须重新启动客户端才能让 Intellisense 正常工作。我还必须`Import`为已全局导入到带有扩展模块的文件的命名空间显式添加语句。

例如，扩展时`System.Web.Mvc.HtmlHelper`我必须添加该行

`Imports System.Web.Mvc`

尽管应用程序编译正确并且在项目引用选项卡上检查了命名空间，但为了使页面正确显示。

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2011-11-22T14:26:46.393

问题可能是您同时安装了 MVC2 和 MVC3。如果是这样，当您使用 VB.NET Visual Studio 编写 HTMLHelper Custom 时，会抛出错误“YourClass”不是“System.Web.Mvc.HtmlHelper”的成员。

但是，如果您运行该页面，它就可以正常工作。

这是解决方案： [http ://forums.asp.net/t/1694828.aspx/1](http://forums.asp.net/t/1694828.aspx/1)

解决方案 1）将您的项目升级到 MVC3 解决方案 2）卸载 MVC3 解决方案 3）将 .NET 框架更改为 3.5 而不是 4.0（禁用 MVC3） 解决方案 4）用 C# 编写代码，你不会有任何问题

马可

# jquery - 修复相对于浏览器 Chrome 的 HTML 页面元素

> ID：1013548
> 
> 赞同：2
> 
> 时间：2009-06-18T15:58:40.740
> 
> 标签：jquery, html, css, css-position

我正在尝试将 div 放置在页面的左上角，并且无论浏览器窗口大小调整或页面滚动如何，我都希望它留在那里。

如何使用纯 CSS（如果可能）或使用 jQuery 来做到这一点？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-06-18T16:01:40.913

使用 css 位置：固定；

```
#fixedDiv {
    position: fixed;
    left: 20px;
    top:20px;
    width: 50px;
    height: 50px;
} 
```

对于 IE6，请参阅[http://www.cssplay.co.uk/layouts/fixed.html](http://www.cssplay.co.uk/layouts/fixed.html)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-18T16:02:58.370

```
css-selector {
    position: fixed;
    top: 0;
    left: 0;
} 
```

注意 z-index。更高 = 前景。

# version-control - 在 Mercurial 存储库历史记录中快速查找已删除的文件？

> ID：1013550
> 
> 赞同：62
> 
> 时间：2009-06-18T15:58:57.280
> 
> 标签：version-control, mercurial

您可以使用`hg grep`，但它会搜索所有文件的内容。

如果我只想搜索已删除文件的文件名来恢复一个怎么办？

我试过`hg grep -I <file-name-pattern> <pattern>`了，但这似乎没有返回任何结果。

* * *

## 回答 #1

> 赞同：87
> 
> 时间：2009-06-18T16:12:48.390

使用[模板很简单](http://hgbook.red-bean.com/read/customizing-the-output-of-mercurial.html)：

```
$ hg log --template "{rev}: {file_dels}\n" 
```

* * *

## 回答 #2

> 赞同：52
> 
> 时间：2010-09-06T12:21:21.257

### Mercurial 1.6 更新

您也可以为此使用[revsets](http://www.selenic.com/mercurial/hg.1.html#specifying-revision-sets "hg帮助修订")：

```
hg log -r "removes('**')" 
```

*（**编辑：**注意双`*`-[单检测仅从存储库的根目录中删除](http://www.selenic.com/mercurial/hg.1.html#file-name-patterns "hg 帮助模式")。）*

* * *

**编辑**：正如 Mathieu Longtin 所建议的，这可以与 dfa 答案中的模板结合使用，以[向](https://stackoverflow.com/a/1013628/351301)[您](http://www.selenic.com/mercurial/hg.1.html#template-usage "hg 帮助模板")显示每个列出的修订删除了*哪些文件：*

 *```
hg log -r "removes('**')" --template "{rev}: {file_dels}\n" 
```

这具有每行列出一个修订的优点（对于机器可读性），但是您可以通过使用`%`格式化删除列表中的每个项目来使输出对人类更漂亮：

```
hg log -r "removes('**')" --template "{rev}:\n{file_dels % '{file}\n'}\n" 
```

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2016-09-08T07:33:05.597

如果您使用的是 TortoiseHg 工作台，一种方便的方法是使用修订过滤器。只需点击`ctrl+s`，然后键入

```
removes("**/FileYouWantToFind.txt") 
```

`**/`表示您要在存储库中递归搜索。您也可以在文件名中使用`*`通配符。`and`您可以使用,运算符将此查询与其他修订集组合`or`。

还有这个高级查询编辑器： [![在此处输入图像描述](../Images/0b45b63143a3c0302090089e4cb95711.png)](https://i.stack.imgur.com/uK6zy.png)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2017-08-13T22:22:57.987

我已经采取了其他答案并对其进行了改进。

添加了“--no-merges”。在有开发团队的大型项目中，会有很多合并。--no-merger 将过滤掉日志噪音。

更改`removes("**")`为`sort(removes("**"), -rev)`。对于具有超过 100K 变更集的大型项目，这将更快地获取删除的最新文件。这将顺序从 rev 0 开始反转为从 tip 开始。

将 {author} 和 {desc} 添加到输出。这将通过显示日志注释和执行者来提供有关文件被删除的原因的上下文。

所以对于我的用例，它是`hg log --template "File(s) deleted in rev {rev}: {author} \n {desc}\n {file_dels % '\n {file}'}\n\n" -r 'sort(removes("**"), -rev)' --no-merges`

样本输出：

```
File(s) deleted in rev 52363: Ansariel 
 STORM-2141: Fix various inventory floater related issues:
* Opening new inventory via Control-Shift-I shortcut uses legacy and potentinally dangerous code path
* Closing new inventory windows don't release memory
* During shutdown legacy and inoperable code for inventory window cleanup is called
* Remove old and unused inventory legacy code

  indra/newview/llfloaterinventory.cpp
  indra/newview/llfloaterinventory.h

File(s) deleted in rev 51951: Ansariel 
 Remove readme.md file - again...

  README.md

File(s) deleted in rev 51856: Brad Payne (Vir Linden) <vir@lindenlab.com> 
 SL-276 WIP - removed avatar_skeleton_spine_joints.xml

  indra/newview/character/avatar_skeleton_spine_joints.xml

File(s) deleted in rev 51821: Brad Payne (Vir Linden) <vir@lindenlab.com> 
 SL-276 WIP - removed avatar_XXX_orig.xml files.

  indra/newview/character/avatar_lad_orig.xml
  indra/newview/character/avatar_skeleton_orig.xml 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-05-20T18:07:41.093

搜索您有效删除的特定文件，并很好地格式化结果：

```
hg log --template "File(s) deleted in rev {rev}: {file_dels % '\n  {file}'}\n\n" -r 'removes("**/FileYouWantToFind.txt")' 
```

样本输出：

```
File(s) deleted in rev 33336: 
  class/WebEngineX/Database/RawSql.php

File(s) deleted in rev 34468: 
  class/PdoPlus/AccessDeniedException.php
  class/PdoPlus/BulkInsert.php
  class/PdoPlus/BulkInsertInfo.php
  class/PdoPlus/CannotAddForeignKeyException.php
  class/PdoPlus/DuplicateEntryException.php
  class/PdoPlus/Escaper.php
  class/PdoPlus/MsPdo.php
  class/PdoPlus/MyPdo.php
  class/PdoPlus/MyPdoException.php
  class/PdoPlus/NoSuchTableException.php
  class/PdoPlus/PdoPlus.php
  class/PdoPlus/PdoPlusException.php
  class/PdoPlus/PdoPlusStatement.php
  class/PdoPlus/RawSql.php 
```

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2016-03-14T15:02:37.267

从项目根目录

```
hg status . | grep "\!" >> /tmp/filesmissinginrepo.txt 
```*

# c# - 如何测试按钮单击是否打开带有 NUnitForms 的新表单？

> ID：1013552
> 
> 赞同：4
> 
> 时间：2009-06-18T15:59:49.713
> 
> 标签：c#, unit-testing, nunit

我是 C# 新手，并试图用 NUnit 和 NUnitForms 编写一个简单的 GUI 单元测试。我想测试单击按钮是否会打开一个新表单。我的应用程序有两个表单，主表单 (Form1) 带有一个打开新表单（密码）的按钮：

```
private void button2_Click(object sender, EventArgs e)
{
    Password pw = new Password();
    pw.Show();
} 
```

我的测试的源代码如下所示：

```
using NUnit.Framework;
using NUnit.Extensions.Forms;

namespace Foobar
{
    [TestFixture]
    public class Form1Test : NUnitFormTest
    {
        [Test]
        public void TestNewForm()
        {
            Form1 f1 = new Form1();
            f1.Show();

            ExpectModal("Enter Password", "CloseDialog");

            // Check if Button has the right Text
            ButtonTester bt = new ButtonTester("button2", f1);
            Assert.AreEqual("Load Game", bt.Text);

            bt.Click();
        }
        public void CloseDialog()
        {
            ButtonTester btnClose = new ButtonTester("button2");
            btnClose.Click();
        }
    }
} 
```

NUnit 输出为：

```
 NUnit.Extensions.Forms.FormsTestAssertionException : expected 1 invocations of modal, but was invoked 0 times (Form Caption = Enter Password) 
```

按钮文本检查成功。问题是**ExpectModal**方法。我也尝试过使用表单的名称，但没有成功。

有谁知道可能出了什么问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-26T20:55:35.063

我自己想通了。可以通过两种方式显示 Windows 窗体：

*   **模态**：“必须关闭或隐藏模态表单或对话框，然后才能继续使用应用程序的其余部分”
*   **无模式**：“......让您在表单和另一个表单之间转移焦点，而无需关闭初始表单。用户可以在显示表单时继续在任何应用程序的其他位置工作。”

使用 Show() 方法打开无模式窗口，使用 ShowDialog() 打开模态窗口。**NUnitForms 只能跟踪模态对话框**（这也是该方法被命名为“ExpectModal”的原因）。

我将源代码中的每个“Show()”都更改为“ShowDialog()”，NUnitForms 运行良好。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-03-28T19:50:02.167

如果您希望表单实际作为模态对话框打开，我只会将您的源代码更改为使用 ShowDialog()。

你是正确的，因为 NUnitForms 支持“期望模态”，但没有“期望非模态”。您可以使用 FormTester 类相对轻松地自己实现这一点。FormTester 是一个可从 NUnitForms 的最新存储库中获得的扩展类。您传入要检查的表单的 .Name 属性的字符串，以查看它是否显示。

```
 public static bool IsFormVisible(string formName)
    {
        var tester = new FormTester(formName);
        var form = (Form) tester.TheObject;
        return form.Visible;
    } 
```

# vb6 - 如何在 VB6 中从 xBase/Clipper 文件中读取数据？

> ID：1013553
> 
> 赞同：0
> 
> 时间：2009-06-18T16:00:01.023
> 
> 标签：vb6, adodb, clipper, xbase

*   DBF 文件位于`C:\dbase\clip53\PRG\stkmenu\WPACK3\`
*   调用 DBF 文件`WPACKS.CFG`（故意不是 .DBF）

ActiveX EXE 中用于打开数据库和记录集的 VB6 代码：

```
Function OpenDatabase(sFile As Variant, Optional sProvider As Variant = "Provider=Microsoft.Jet.OLEDB.4.0") As Variant  ' ADODB.Connection
    Dim nErr As Long
    Dim sErr As String
    Dim oConnection As Object 'ADODB.Connection
    Set oConnection = CreateObject("ADODB.Connection")
    On Error Resume Next
    oConnection.open sProvider & ";Data Source=" & sFile
    nErr = Err.Number
    sErr = Err.Description
    On Error GoTo 0
    If nErr <> 0 Then
        Err.Raise OPENDATABASE_E_NOTFOUND, , sErr
    End If
    Set OpenDatabase = oConnection
End Function

Function OpenRecordSet(ByRef oDb As Variant, sQuery As Variant, Optional bCmdText As Boolean = False) As Variant ''ADODB.Connection ADODB.Recordset
    Const adOpenForwardOnly  As Long = 0
    Const adOpenStatic As Long = 3
    Const adOpenDynamic As Long = 2
    Const adOpenKeyset As Long = 1
    Const adLockOptimistic As Long = 3
    Const adCmdText As Long = 1
    Dim oRecordSet As Object 'ADODB.Recordset
    Set oRecordSet = CreateObject("ADODB.RecordSet")
    If bCmdText Then
        oRecordSet.open sQuery, , , adCmdText
    Else
        oRecordSet.open sQuery, oDb, adOpenKeyset, adLockOptimistic
    End If
    Set OpenRecordSet = oRecordSet
End Function 
```

访问这些方法的脚本看起来有点像 VBScript。它是 VBScript，但由前面提到的 ActiveX EXE 执行，它使用 MSScript 控件并有一大堆对象可供脚本引擎使用。一种 VBScript-on-steroids 方法。

```
uses database
uses system
dim db
dim rs
set db = database.opendatabase("C:\dbase\clip53\PRG\stkmenu\WPACK3\","Provider=Microsoft.Jet.OLEDB.4.0;Extended Properties=dBase III;User ID=Admin;Password=")
set rs = database.openrecordset(db, "SELECT * FROM WPACKS.CFG",true)
system.consolewriteline rs.recordcount 
```

我的问题是，`The connection cannot be used to perform this operation. It is either closed or invalid in this context.`当它遇到`oRecordSet.open sQuery, , , adCmdText`（我从 Microsoft 网站获得的）时，我一直在收到。

这有点烦人。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-18T16:17:48.097

当我需要连接一个 DBF 文件时，我使用的连接字符串通常是这样的：

```
"Driver={Microsoft dBase Driver (*.dbf)};dbq=<filePath>" 
```

这对我来说可以。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-18T16:11:51.667

尝试使用最新最好的 FoxPro 驱动程序。

# wpf - ContextMenu 中 MenuItem 的 ElementName 绑定

> ID：1013558
> 
> 赞同：68
> 
> 时间：2009-06-18T16:00:37.293
> 
> 标签：wpf, data-binding, contextmenu, elementname

有没有其他人注意到带有 ElementName 的绑定不能正确解析`MenuItem`对象中包含的`ContextMenu`对象？查看此示例：

```
<Window x:Class="EmptyWPF.Window1"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    Title="Window1" Height="300" Width="300"
    x:Name="window">
    <Grid x:Name="grid" Background="Wheat">
        <Grid.ContextMenu>
            <ContextMenu x:Name="menu">
                <MenuItem x:Name="menuItem" Header="Window" Tag="{Binding ElementName=window}" Click="MenuItem_Click"/>
                <MenuItem Header="Grid" Tag="{Binding ElementName=grid}" Click="MenuItem_Click"/>
                <MenuItem Header="Menu" Tag="{Binding ElementName=menu}" Click="MenuItem_Click"/>
                <MenuItem Header="Menu Item" Tag="{Binding ElementName=menuItem}" Click="MenuItem_Click"/>
            </ContextMenu>
        </Grid.ContextMenu>
        <Button Content="Menu" 
                HorizontalAlignment="Center" VerticalAlignment="Center" 
                Click="MenuItem_Click" Tag="{Binding ElementName=menu}"/>
        <Menu HorizontalAlignment="Center" VerticalAlignment="Bottom">
            <MenuItem x:Name="anotherMenuItem" Header="Window" Tag="{Binding ElementName=window}" Click="MenuItem_Click"/>
            <MenuItem Header="Grid" Tag="{Binding ElementName=grid}" Click="MenuItem_Click"/>
            <MenuItem Header="Menu" Tag="{Binding ElementName=menu}" Click="MenuItem_Click"/>
            <MenuItem Header="Menu Item" Tag="{Binding ElementName=anotherMenuItem}" Click="MenuItem_Click"/>
        </Menu>
    </Grid>
</Window> 
```

除了 ContextMenu 中包含的绑定之外，所有绑定都工作得很好。它们在运行时将错误打印到输出窗口。

有人知道任何解决方法吗？这里发生了什么？

* * *

## 回答 #1

> 赞同：58
> 
> 时间：2009-06-30T20:54:54.293

我找到了一个更简单的解决方案。

在 UserControl 后面的代码中：

```
NameScope.SetNameScope(contextMenu, NameScope.GetNameScope(this)); 
```

* * *

## 回答 #2

> 赞同：31
> 
> 时间：2016-08-16T09:47:46.963

正如其他人所说，“ContextMenu”不包含在可视化树中，“ElementName”绑定不起作用。仅当上下文菜单未在“DataTemplate”中定义时，才可以按照接受的答案的建议设置上下文菜单的“NameScope”。我已经通过使用[{x:Reference} 标记扩展](https://msdn.microsoft.com/en-us/library/ee795380.aspx)解决了这个问题，它类似于“元素名称”绑定，但以不同方式解析绑定，绕过可视化树。我认为这比使用“PlacementTarget”更具可读性。这是一个例子：

```
<Image Source="{Binding Image}">       
    <Image.ContextMenu>
        <ContextMenu>
            <MenuItem Header="Delete" 
                      Command="{Binding Source={x:Reference Name=Root}, Path=DataContext.RemoveImage}"
                      CommandParameter="{Binding}" />
        </ContextMenu>
    </Image.ContextMenu>
</Image> 
```

根据 MSDN 文档

> x:Reference 是在 XAML 2009 中定义的构造。在 WPF 中，您可以使用 XAML 2009 功能，但仅适用于非 WPF 标记编译的 XAML。标记编译的 XAML 和 XAML 的 BAML 形式目前不支持 XAML 2009 语言关键字和功能。

不管这意味着什么……不过对我有用。

* * *

## 回答 #3

> 赞同：20
> 
> 时间：2011-03-18T19:51:20.353

这是另一个仅限 xaml 的解决方法。**（这也假设你想要DataContext**里面的东西，例如，你正在*MVVMing*它）

选项一，其中**ContextMenu**的父元素不在**DataTemplate**中：

```
Command="{Binding PlacementTarget.DataContext.MyCommand, 
         RelativeSource={RelativeSource AncestorType=ContextMenu}}" 
```

这适用于OP的问题。**如果您在DataTemplate**内部，这将不起作用。在这些情况下，**DataContext**通常是集合中的多个之一，您希望绑定到的*ICommand是同一 ViewModel 中集合的兄弟属性（例如，Window 的***DataContext**）。

在这些情况下，您可以利用[**Tag**](http://msdn.microsoft.com/en-us/library/system.windows.frameworkelement.tag.aspx)临时保存包含集合和您的 ICommand的父**DataContext ：**

```
class ViewModel
{
    public ObservableCollection<Derp> Derps { get;set;}
    public ICommand DeleteDerp {get; set;}
} 
```

并在 xaml

```
<!-- ItemsSource binds to Derps in the DataContext -->
<StackPanel
    Tag="{Binding DataContext, ElementName=root}">
    <StackPanel.ContextMenu>
        <ContextMenu>
            <MenuItem
                Header="Derp"                       
                Command="{Binding PlacementTarget.Tag.DeleteDerp, 
                RelativeSource={RelativeSource 
                                    AncestorType=ContextMenu}}"
                CommandParameter="{Binding PlacementTarget.DataContext, 
                RelativeSource={RelativeSource AncestorType=ContextMenu}}">
            </MenuItem> 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-06-18T18:15:49.150

上下文菜单很难绑定。它们存在于控件的可视化树之外，因此它们找不到您的元素名称。

尝试将上下文菜单的数据上下文设置为其放置目标。你必须使用RelativeSource。

```
<ContextMenu 
   DataContext="{Binding PlacementTarget, RelativeSource={RelativeSource Self}}"> ... 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-06-18T16:24:06.660

经过一番试验，我发现了一种解决方法：

对顶层控件进行顶层`Window`/`UserControl`实施`INameScope`和设置。`NameScope``ContextMenu`

```
public class Window1 : Window, INameScope
{
    public Window1()
    {
        InitializeComponent();
        NameScope.SetNameScope(contextMenu, this);
    }

    // Event handlers and etc...

    // Implement INameScope similar to this:
    #region INameScope Members

    Dictionary<string, object> items = new Dictionary<string, object>();

    object INameScope.FindName(string name)
    {
        return items[name];
    }

    void INameScope.RegisterName(string name, object scopedElement)
    {
        items.Add(name, scopedElement);
    }

    void INameScope.UnregisterName(string name)
    {
        items.Remove(name);
    }

    #endregion
} 
```

这允许上下文菜单在`Window`. 还有其他选择吗？

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2011-06-18T12:36:56.643

我不确定为什么要使用魔术来避免事件处理程序中的一行代码用于您已经处理的鼠标单击：

```
 private void MenuItem_Click(object sender, System.Windows.RoutedEventArgs e)
    {
        // this would be your tag - whatever control can be put as string intot he tag
        UIElement elm = Window.GetWindow(sender as MenuItem).FindName("whatever control") as UIElement;
    } 
```

# java - 如何从 Java 中的 Matcher 获取多个正则表达式组？

> ID：1013569
> 
> 赞同：1
> 
> 时间：2009-06-18T16:02:42.910
> 
> 标签：java, regex, matcher

我有一个 Java 程序可以进行一些字符串匹配。我正在寻找与`\d+x\d+`字符串匹配的任何内容。这工作，使用`Pattern`和`Matcher`类。但是，要解析`String`我找到的部分，我必须手动解析`String`我从`Matcher.find()`and得到的部分`Matcher.group()`。我怎样才能告诉`Pattern`我正在寻找某种形式的东西`(\d+)x(\d+)`并让他们`Matcher`分别返回这些组？所以我想得到两个字符串，而不是字符串“1x23”，“1”和“23”。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-06-18T16:04:45.907

使用[`Matcher.group(int)`](http://java.sun.com/javase/6/docs/api/java/util/regex/Matcher.html#group(int))，不使用[`Matcher.group()`](http://java.sun.com/javase/6/docs/api/java/util/regex/Matcher.html#group())。
使用给定的正则表达式和输入，`group(1)`应该是“1”并且`group(2)`应该是“23”。

# asp.net - Javascript 弹出窗口打开函数

> ID：1013577
> 
> 赞同：1
> 
> 时间：2009-06-18T16:03:48.200
> 
> 标签：asp.net, javascript, popupwindow

我正在使用以下 JS 函数打开一个弹出窗口来显示另一个网站：

```
<script language="javascript" type="text/javascript">
function link()
{
   window.open("www.google.com")
}

onClick="Link()" 
```

上例中的 URL 仅用于测试。我实际上打算用来自列表框中的文本值替换 URL，它是 URL 的形式。无论如何，当我在 Visual Studio 中启动调试器并执行 onClick 时，弹出窗口会打开并给我一个页面，说明存在服务器错误。具体来说，`Server error in '/' application... resource cannot be found`。另外，我注意到我的 URL 放置如下：`http://localhost:49456/www.google.com`. 我以为这个功能会给我一个以谷歌为网站的弹出窗口。这是 Visual Studio 调试器问题，是我的代码错误，还是我在错误的上下文中使用了代码？任何建议将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-18T16:06:09.013

您需要在网址中指定 http:// 例如

```
window.open("http://google.com"); 
```

如果没有指定该协议，浏览器会认为 URL 是相对于当前文档的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-18T16:06:14.287

添加`http://`到您的域，即`http://www.google.com`.

# c# - C# decimal ToString() 方法存在差异

> ID：1013579
> 
> 赞同：4
> 
> 时间：2009-06-18T16:04:20.477
> 
> 标签：c#

任何人都可以解释什么是错的？

我的 row[i] 是十进制的，当调用“ToString()”时，它给出了带有 4 个尾随零的整数。

我也有 ((object)35m) 也是装箱的，但它没有给出零。

怎么可能发生？除非是调试器问题或 C# 硬代码，否则我没有任何想法。

我是stackoverflow的新手，所以我不能附加图片。以下 url 是调试器的快照。 [http://img200.imageshack.us/img200/8749/decimalissuek.jpg](http://img200.imageshack.us/img200/8749/decimalissuek.jpg)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-18T16:10:56.923

小数在其中存储零的数量（或者更确切地说，它们的整体精度，可以包括尾随零）：

```
Console.WriteLine(35m);
Console.WriteLine(35.0m);
Console.WriteLine(35.00m);
Console.WriteLine(35.000m);
Console.WriteLine(35.0000m); 
```

...你会看到零被保留。我的猜测是您的 row[i] 确实有 4 个尾随零。

# asp.net - 当密码存储为哈希值时检索密码

> ID：1013581
> 
> 赞同：6
> 
> 时间：2009-06-18T16:04:39.060
> 
> 标签：asp.net, hash, passwords, dotnetnuke

如果密码存储为哈希值，用户是否可以要求将密码通过电子邮件发送给自己？

有什么方法可以将哈希值转换为具有正确信息的明文值（以及您需要什么信息）？

如果用户在两个站点上存储了相同的密码哈希值，那么两个站点的密码是否相同？

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2009-06-18T16:09:53.053

如果您只存储密码的哈希值，那么不会。...无论如何，您应该只存储他们密码的正确加盐哈希。

密码重置机制是正确的选择。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-06-18T16:09:03.880

散列密码通常无法检索（这取决于散列函数，无法检索安全散列）。如果他们在两个站点上具有相同的哈希，则他们可能具有相同的密码，这取决于站点使用的哈希盐，什么方法等。

如果您的密码安全地存储在一个良好的散列系统中，提供商将永远无法通过电子邮件将您的密码发送给您，如果您忘记了密码，您必须重置密码。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-06-18T16:08:43.083

简而言之，没有。对于大多数散列算法，您可以有多个输入和相同的输出。提供密码重置选项通常会更好。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-06-18T16:11:02.790

有不同类型的哈希算法。有些比其他的更安全。MD5 是一种流行但不安全的方法。SHA 系列是另一组更安全的算法。

根据定义，哈希是单向函数。它无法逆转。

[http://en.wikipedia.org/wiki/Sha-1](http://en.wikipedia.org/wiki/Sha-1)

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-06-18T16:12:45.863

如果有一种简单的方法可以恢复明文密码，那么一开始就对密码进行散列是没有意义的。那时你还不如只使用 base64 或 ROT13 它们。（不要那样做！）

正如其他人提到的，使用其他密码恢复方法。访问明文密码确实没有充分的理由。

如果两个站点的哈希值相同，则用户很可能在两个站点都具有相同的密码。然而，不能 100% 保证，可能会发生哈希冲突，但这是极不可能的。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-06-18T17:25:21.150

没有办法反转常用的哈希值。它们可以被暴力破解（尝试每一个可能的密码），或者您可以结合使用单词列表（使用常用密码列表）来暴力破解以加快速度，但这仍然是一个非常缓慢且 CPU 密集型的过程。

许多网站使用的最佳方法是创建一个“密码重置”按钮，您可以在其中输入您的用户名和电子邮件，如果它们匹配，它会向您发送一个随机密码并为您提供登录页面的链接，您可以登录使用您的随机密码并更改您的密码。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2010-07-05T23:34:37.217

为此，您必须有一个包含以下字段的模型：

```
Hashed_password
Salt 
```

你需要知道方法用户来散列密码（这里我使用SHA1）然后你可以在你的控制器中定义：

```
def self.encrypted_password(password, salt)
   string_to_hash = password + "wibble" + salt
   Digest::SHA1.hexdigest(string_to_hash)
end 
```

接下来可以比较：

```
user.Hashed_password == encrypted_password(password, user.salt) 
```

True 表示“password”是用户“user”的密码

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2009-06-18T16:20:11.870

存储密码哈希的一般想法是确保密码是安全的……即使是那些有权访问数据库的人也是如此。信任从来不是隐含的。哈希是一种单向算法，因此无法从哈希码中导出原始密码。通常，当用户需要恢复存储为哈希的密码时，您应该向他们询问他们的秘密问题，然后通过电子邮件向他们发送临时密码，或者通过电子邮件向他们发送可以更改密码的临时链接。这样可以确保密码永远不会以明文形式存储，并且不会被所有人窥探，即使是那些可能被认为值得信赖的人。

# javascript - AJAX responseXML 错误

> ID：1013582
> 
> 赞同：4
> 
> 时间：2009-06-18T16:04:43.223
> 
> 标签：javascript, ajax, cross-browser

在发出 AJAX 请求和处理响应时，我遇到了一些奇怪的问题。

我正在对 xml 文件进行 ajax 调用。但是，当我得到响应时，xhr.responseText 属性在 Firefox 中可以正常工作，但在 IE 中却不行。另一件事是我试图将 xhr.responseXML 作为 XMLDocument 访问，但它告诉我在 Firefox 中它告诉我 xhr.responseXML 是未定义的，即它甚至没有向我显示未定义的错误或显示输出。

这是我用来发出请求的代码：

```
var ajaxReq = function(url, callback) {
    //initialize the xhr object and settings
    var xhr = window.ActiveXObject ?
            new ActiveXObject("Microsoft.XMLHTTP") : new XMLHttpRequest(),
    //set the successful connection function
        httpSuccess = function(xhr) {
            try {
                // IE error sometimes returns 1223 when it should be 204
                //  so treat it as success, see XMLHTTPRequest #1450
                // this code is taken from the jQuery library with some modification.
                return !xhr.status && xhr.status == 0 ||
                        (xhr.status >= 200 && xhr.status < 300) ||
                        xhr.status == 304 || xhr.status == 1223;
            } catch (e) { }
            return false;
        };

    //making sure the request is created
    if (!xhr) {
        return 404; // Not Found
    }

    //setting the function that is going to be called after the request is made
    xhr.onreadystatechange = function() {
        if (!httpSuccess(xhr)) {
            return 503; //Service Unavailable
        }
        if (xhr.responseXML != null && xhr.responseText != null &&
                xhr.responseXML != undefined && xhr.responseText != undefined) {
            callback(xhr);
        }
    };

    //open request call
    xhr.open('GET', url, true);

    //setup the headers
    try {
        xhr.setRequestHeader("Content-Type", "application/x-www-form-urlencoded");
        xhr.setRequestHeader("Accept", "text/xml, application/xml, text/plain");
    } catch ( ex ) {
        window.alert('error' + ex.toString());
    }

    //send the request
    try {
        xhr.send('');
    } catch (e) {
        return 400; //bad request
    }

    return xhr;
}; 
```

这就是我调用函数来测试结果的方式：

```
window.onload = function() {
    ajaxReq('ConferenceRoomSchedules.xml', function(xhr) {
        //in firefox this line works fine,
        //but in ie it doesnt not even showing an error
        window.document.getElementById('schedule').innerHTML = xhr.responseText;
        //firefox says ''xhr.responseXML is undefined'.
        //and ie doesn't even show error or even alerts it.
        window.alert(xhr.reponseXML.documentElement.nodeName);
    });
} 
```

这也是我第一次尝试使用 AJAX，所以可能有些东西我看不正确。我一直在疯狂寻找任何关于为什么或如何解决它的迹象，但没有运气。任何想法都会很棒。

**编辑：**

我知道使用框架会更好，但是老板不想为仅 ajax 功能添加框架（'just' 对于 ajax 来说不是一个公平的词：P）。所以我用纯javascript来做。

XML 文件格式正确，我在 Web 浏览器中可以很好地看到它，但为了完成，这是我正在使用的测试文件：

```
<?xml version="1.0" encoding="utf-8"?>
<rooms>
  <room id="Blue_Room">
    <administrator>somebody@department</administrator>
    <schedule>
      <event>
        <requester>
          <name>Johnny Bravo</name>
          <email>jbravo@department</email>
        </requester>
        <date>2009/09/03</date>
        <start_time>11:00:00 GMT-0600</start_time>
        <end_time>12:00:00 GMT-0600</end_time>
      </event>
    </schedule>
  </room>
  <room id="Red_Room">
    <administrator>somebody@department</administrator>
    <schedule>
    </schedule>
  </room>
  <room id="Yellow_Room">
    <administrator>somebody@department</administrator>
    <schedule>
    </schedule>
  </room>
</rooms> 
```

**编辑 2：** 好消息是我说服了我的老板使用 jQuery，坏消息是 AJAX 仍然让我感到困惑。出于好奇，我会阅读更多有关它的信息。感谢您的提示，我将答案归功于 Heat Miser，因为他是最接近的工作提示。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-18T19:27:36.360

几年前我遇到了同样的问题，然后我放弃了 responseXML 并开始一直使用 responseText。这个解析功能一直对我有用：

```
function parseXml(xmlText){
    try{
        var text = xmlText;
        //text = replaceAll(text,"&lt;","<");
        //text = replaceAll(text,"&gt;",">");
        //text = replaceAll(text,"&quot;","\"");
        //alert(text);
        //var myWin = window.open('','win','resize=yes,scrollbars=yes');
        //myWin.document.getElementsByTagName('body')[0].innerHTML = text;
        if (typeof DOMParser != "undefined") { 
            // Mozilla, Firefox, and related browsers 
            var parser=new DOMParser();
            var doc=parser.parseFromString(text,"text/xml");
            //alert(text);
            return doc; 
        }else if (typeof ActiveXObject != "undefined") { 
            // Internet Explorer. 
        var doc = new ActiveXObject("Microsoft.XMLDOM");  // Create an empty document 
            doc.loadXML(text);            // Parse text into it 
            return doc;                   // Return it 
        }else{ 
            // As a last resort, try loading the document from a data: URL 
            // This is supposed to work in Safari. Thanks to Manos Batsis and 
            // his Sarissa library (sarissa.sourceforge.net) for this technique. 
            var url = "data:text/xml;charset=utf-8," + encodeURIComponent(text); 
            var request = new XMLHttpRequest(); 
            request.open("GET", url, false); 
            request.send(null); 
            return request.responseXML; 
        }
    }catch(err){
        alert("There was a problem parsing the xml:\n" + err.message);
    }
} 
```

使用此 XMLHttpRequest 对象：

```
// The XMLHttpRequest class object

debug = false;

function Request (url,oFunction,type) {
    this.funct = "";
    // this.req = "";
    this.url = url;
    this.oFunction = oFunction;
    this.type = type;
    this.doXmlhttp = doXmlhttp;
    this.loadXMLDoc = loadXMLDoc;
}

function doXmlhttp() {
    //var funct = "";
    if (this.type == 'text') {
        this.funct = this.oFunction + '(req.responseText)';
    } else {
        this.funct = this.oFunction + '(req.responseXML)';
    }
    this.loadXMLDoc();
    return false;
}

function loadXMLDoc() {
    //alert(url);
    var functionA = this.funct;
    var req;
    req = false;

    function processReqChange() {
        // alert('reqChange is being called');
        // only if req shows "loaded"
        if (req.readyState == 4) {
            // only if "OK"
            if (req.status == 200) {
                // ...processing statements go here...
                eval(functionA);
                if(debug){
                    var debugWin = window.open('','aWindow','width=600,height=600,scrollbars=yes');
                    debugWin.document.body.innerHTML = req.responseText;
                }
            } else {
                alert("There was a problem retrieving the data:\n" +
                    req.statusText + '\nstatus: ' + req.status);
                if(debug){
                    var debugWin = window.open('','aWindow','width=600,height=600,scrollbars=yes');
                    debugWin.document.body.innerHTML = req.responseText;
                }
            }
            }
    }

    // branch for native XMLHttpRequest object
    if(window.XMLHttpRequest) {
        try {
            req = new XMLHttpRequest();
        } catch(e) {
            req = false;
        }
    // branch for IE/Windows ActiveX version
    } else if(window.ActiveXObject) {
        try {
                req = new ActiveXObject("Msxml2.XMLHTTP");
        } catch(e) {
                try {
                    req = new ActiveXObject("Microsoft.XMLHTTP");
                } catch(e) {
                    req = false;
                }
        }
    }

    if(req) {
        req.onreadystatechange = processReqChange;
        if(this.url.length > 2000){
            var urlSpl = this.url.split('?');
            req.open("POST",urlSpl[0],true);
            req.setRequestHeader('Content-Type','application/x-www-form-urlencoded');
            req.send(urlSpl[1]);
        } else {
            req.open("GET", this.url, true);
            req.send("");
        }
    }
}

function browserSniffer(){
    if(navigator.userAgent.toLowerCase().indexOf("msie") != -1){
        if(navigator.userAgent.toLowerCase().indexOf("6")){
            return 8;
        }else{
            return 1;
        }
    }
    if(navigator.userAgent.toLowerCase().indexOf("firefox") != -1){
        return 2;
    }
    if(navigator.userAgent.toLowerCase().indexOf("opera") != -1){
        return 3;
    }
    if(navigator.userAgent.toLowerCase().indexOf("safari") != -1){
        return 4;
    }
    return 5;
} 
```

当然，这是非常古老的代码，但它仍然适用于我几年前建立的网站。我同意其他所有人的观点，尽管我现在通常使用框架，所以我不必再使用这个代码或类似的东西了。

您可以在 Request onreadystate 函数中忽略拆分等的一些细节。如果请求超过一定长度，它应该将请求转换为帖子，但我只是决定做一个帖子总是更好。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2010-01-17T15:35:31.237

此问题主要发生在浏览器错误检测到内容类型或未正确发送时。

覆盖它更容易：

```
var request = new XMLHttpRequest(); 
request.open("GET", url, false); 
request.overrideMimeType("text/xml");
request.send(null); 
return request.responseXML; 
```

不知道为什么...这个问题只发生在 Safari 和 Chrome（WebKit 浏览器，服务器正确发送标头）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-18T16:07:40.883

我可以建议您查看为您隐藏和管理这些跨浏览器问题的框架（以可靠的方式）。这里的一个好点是[jQuery](http://jquery.com)。自己做这些事情会变得非常困难和复杂。

[这](http://www.tutorialized.com/view/tutorial/Use-jQuery-To-Retrieve-Data-From-An-XML-File/38192)可能是您需要的。

**//编辑：** 这是[w3school](http://www.w3schools.com/AJAX/ajax_browsers.asp)显示它的方式：

```
function ajaxFunction()
{
var xmlhttp;
if (window.XMLHttpRequest)
  {
  // code for IE7+, Firefox, Chrome, Opera, Safari
  xmlhttp=new XMLHttpRequest();
  }
else if (window.ActiveXObject)
  {
  // code for IE6, IE5
  xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
  }
else
  {
  alert("Your browser does not support XMLHTTP!");
  }
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-18T16:12:27.470

您是否正在调用相对于当前文档的 URL？由于 IE 将使用 ActiveXObject，它可能需要一个绝对路径，例如：

[http://some.url/ConferenceRoomSchedules.xml](http://some.url/ConferenceRoomSchedules.xml)

至于 XML，你确定它格式正确吗？例如，它是否加载到 XML 编辑器中？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-18T16:12:18.327

为了避免您的跨浏览器问题（并节省您自己编写大量强大社区已经开发、测试和审查的项目），您应该选择一个 javascript 库。JQuery 和 Dojo 是不错的选择。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-01-04T11:29:01.437

我相信您的 Web 服务器需要使用“ConferenceRoomSchedules.xml”提供正确的响应标头，例如 Content-Type: text/xml 或任何其他 xml 类型。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-01-24T20:49:48.993

Aron 在[https://stackoverflow.com/a/2081466/657416](https://stackoverflow.com/a/2081466/657416)中提供的答案在我看来是最简单（也是最好）的答案。这是我的工作代码：

```
ajax = ajaxRequest();
ajax.overrideMimeType("text/xml");
ajax.open("GET", myurl; 
```

# asp.net-mvc - Django的Http动词装饰器？

> ID：1013587
> 
> 赞同：5
> 
> 时间：2009-06-18T16:05:25.423
> 
> 标签：asp.net-mvc, django, django-views, httpverbs

在 ASP.NET MVC 中，您可以使用 AcceptVerbs 属性将视图函数与动词相关联：

```
public ActionResult Create()
{
    // do get stuff
} 

[AcceptVerbs(HttpVerbs.Post)]
public ActionResult Create(FormCollection collection)
{
    // do post stuff
} 
```

[Django Book](http://www.djangobook.com/en/2.0/chapter08/)建议是这样的：

```
def method_splitter(request, *args, **kwargs):
    get_view = kwargs.pop('GET', None)
    post_view = kwargs.pop('POST', None)
    if request.method == 'GET' and get_view is not None:
        return get_view(request, *args, **kwargs)
    elif request.method == 'POST' and post_view is not None:
        return post_view(request, *args, **kwargs)
    raise Http404 
```

网址.py：

```
urlpatterns = patterns('',
    # ...
    (r'^somepage/$', views.method_splitter, {'GET': views.some_page_get, 
        'POST': views.some_page_post}),
    # ...
) 
```

这对我来说似乎有点难看 - 是否有一个装饰器可以将 HTTP 动词与视图、ASP.NET MVC 样式或其他公认的方式相关联？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-06-19T05:53:49.140

有标准的内置装饰器用于要求特定的 HTTP 方法或允许的方法列表。

查看代码：[http](http://code.djangoproject.com/browser/django/trunk/django/views/decorators/http.py) ://code.djangoproject.com/browser/django/trunk/django/views/decorators/http.py 。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-06-18T16:24:03.400

**2016 年更新的答案：**现代 Django 内置了所有必要的内容，并可通过[基于类的视图](https://docs.djangoproject.com/en/stable/topics/class-based-views/)获得。在最原始的形式中，规范方法是子类化`django.views.generic.View`和实现以 HTTP 动词命名的类方法：

```
class MyView(View):
    def get(self, request, *args, **kwargs):
        # ...

    def post(self, request, *args, **kwargs):
        # ... 
```

在内部，它的工作方式与我下面的古老代码非常相似（它是在 Django 具有基于类的视图之前编写的）。有一种`View.dispatch`方法基本上是查找要调用的内容，如果找不到任何内容，则返回 405：`getattr(self, request.method.lower(), self.http_method_not_allowed)`.

当然，如果您进行表单处理、模板渲染或常见的 CRUD 工作，请务必查看可用的`View`子类。

* * *

**下面是 2009 年的旧版答案。**该代码在 2016 年仍然有效，但不是 DRY 解决方案，所以不要使用它。2011 年，Django 获得了基于类的视图，如今它们已成为标准的工作方式。我将其保留在这里仅出于历史目的。旧答案文本如下：

在一个特定的视图中，我需要为不同的 HTTP 方法（这是我的小型 WebDAV 实现）提供单独的代码，我正在做这样的事情：

```
class SomeView(object):
    def method_get(self, request, ...):
        ...

    def __call__(self, request, *args, **kwargs):
        m = getattr(self, 'method_%s' % request.method.lower(), None)
        if m is not None:
            return m(request, user, *args, **kwargs)
        return HttpResponseNotAllowed("405 Method Not Allowed")

# Then url(r'...', SomeView()), 
```

*添加/编辑：*嗯，我想了一下并实际实现了装饰器方法。它并没有我最初想的那么糟糕。

```
def method_not_allowed_view(request, *args, **kwargs):
    return HttpResponseNotAllowed("405 Method Not Allowed")

def http_method(*methods):
    methods = map(lambda m: m.lower(), methods)
    def __method_wrapper(f):
        this_module = __import__(__name__)
        chain = getattr(this_module, f.__name__, method_not_allowed_view)
        base_view_func = lambda request, *args, **kwargs: \
            f(request, *args, **kwargs) if request.method.lower() in methods \
                                        else chain(request, *args, **kwargs)
        setattr(this_module, f.__name__, base_view_func)
        return base_view_func
    return __method_wrapper

@http_method('get')
def my_view(request):
    return HttpResponse("Thank you for GETting.")

@http_method('post', 'put')
def my_view(request):
    return HttpResponse("Thank you for POSTing or PUTting.")

# url(r'...', 'app.my_view'), 
```

无论如何，这篇文章是一个社区维基，所以如果你喜欢这个想法，请随时改进！并且修订历史还包含一些我在写这篇文章之前尝试过的一些不同的方法......

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-03-01T21:53:09.313

您可以使用[视图装饰器](https://docs.djangoproject.com/en/dev/topics/http/decorators/)

从文档：

```
from django.views.decorators.http import require_http_methods

@require_http_methods(["GET", "POST"])
def my_view(request):
    # I can assume now that only GET or POST requests make it this far
    # ...
    pass 
```

# c# - 将泛型数据存储在非泛型类中

> ID：1013604
> 
> 赞同：0
> 
> 时间：2009-06-18T16:09:22.337
> 
> 标签：c#, generics

我有一个我想用来存储通用数据的 DataGridView。我想在 DataGridView 类中保留一个类型化的数据列表，以便可以在内部处理所有排序等。但我不想在 DataGridView 上设置类型，因为在调用 InitializeData 方法之前我不会知道数据类型。

```
public class MyDataGridView : DataGridView {
    private List<T> m_data;
    public InitializeData<T>(List<T> data) {
       m_data = data;
    }
    ... internal events to know when the datagrid wants to sort ...
    m_data.Sort<T>(...)
} 
```

这可能吗？如果是这样，怎么做？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-18T16:17:17.207

如果您在调用 之前不知道类型`InitializeData`，那么该类型显然不能是对象的编译时部分。

当您打电话时，您知道有关排序的所有信息`InitializeData<T>`吗？如果是这样，您如何执行以下操作：

```
private IList m_data;
private Action m_sorter;

public InitializeData<T>(List<T> data)
{
    m_data = data;
    // This captures the data variable. You'll need to
    // do something different if that's not good enough
    m_sorter = () => data.Sort();
} 
```

然后当您需要稍后排序时，您可以调用`m_sorter()`.

如果您可能对不同的事物进行排序，则可能会将其从`Action`to`Action<string>`或您需要能够排序的任何内容更改。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-18T17:33:13.353

如果乔恩的回答不够，这里有一个更通用（但更复杂，可能更令人困惑）的方法：

```
/// <summary>
/// Allows a list of any type to be used to get a result of type TResult
/// </summary>
/// <typeparam name="TResult">The result type after using the list</typeparam>
interface IListUser<TResult>
{
    TResult Use<T>(List<T> list);
}

/// <summary>
/// Allows a list of any type to be used (with no return value)
/// </summary>
interface IListUser
{
    void Use<T>(List<T> list);
}

/// <summary>
/// Here's a class that can sort lists of any type
/// </summary>
class GenericSorter : IListUser
{
    #region IListUser Members

    public void Use<T>(List<T> list)
    {
        // do generic sorting stuff here
    }

    #endregion
}

/// <summary>
/// Wraps a list of some unknown type.  Allows list users (either with or without return values) to use the wrapped list.
/// </summary>
interface IExistsList
{
    TResult Apply<TResult>(IListUser<TResult> user);
    void Apply(IListUser user);
}

/// <summary>
/// Wraps a list of type T, hiding the type itself.
/// </summary>
/// <typeparam name="T">The type of element contained in the list</typeparam>
class ExistsList<T> : IExistsList
{

    List<T> list;

    public ExistsList(List<T> list)
    {
        this.list = list;
    }

    #region IExistsList Members

    public TResult Apply<TResult>(IListUser<TResult> user)
    {
        return user.Use(list);
    }

    public void Apply(IListUser user)
    {
        user.Use(list);
    }

    #endregion
}

/// <summary>
/// Your logic goes here
/// </summary>
class MyDataGridView
{
    private IExistsList list;
    public void InitializeData<T>(List<T> list)
    {
        this.list = new ExistsList<T>(list);
    }

    public void Sort()
    {
        list.Apply(new GenericSorter());
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-18T17:40:21.453

您应该为需要在运行时执行的任何通用操作定义 delgate 或接口。正如 Jon Skeet 所提到的，如果您在编译时不知道类型，则无法对数据网格进行强类型化。

框架就是这样做的。例如：

```
Array.Sort(); 
```

有几种使用方法：

*   向它发送一个对象数组，这些对象实现[`IComparable`](http://msdn.microsoft.com/en-us/library/system.icomparable.aspx)或[`IComparable<T>`](http://msdn.microsoft.com/en-us/library/4d7sx9hd.aspx)
*   发送第二个参数，这是一个实现[`IComparer`](http://msdn.microsoft.com/en-us/library/system.collections.icomparer.aspx)or的类[`IComparer<T>`](http://msdn.microsoft.com/en-us/library/8ehhxeaf.aspx)。用于比较对象以进行排序。
*   发送第二个参数，它是一个[`Comparison<T>`](http://msdn.microsoft.com/en-us/library/tfakywbh.aspx)委托，可用于比较数组中的对象。

这是您如何解决问题的示例。在最基本的层面上，您的场景可以通过[策略模式](http://en.wikipedia.org/wiki/Strategy_pattern)来解决，这就是 Array.Sort() 所做的。

如果您需要在运行时动态排序，我将创建一个 IComparer 类，该类将您想要排序的列作为其构造函数中的参数。然后在您的比较方法中，将该列用作排序类型。

这是一个使用一些基本示例类的示例。一旦你设置了这些类，你就可以将它们传递到你的数据网格中并在适当的地方使用它们。

```
public class Car
{
    public string Make { get; set; }
    public string Model { get; set; }
    public string Year { get; set; }
}

public class CarComparer : IComparer
{
    string sortColumn;

    public CarComparer(string sortColumn)
    {
        this.sortColumn = sortColumn;
    }

    public int Compare(object x, object y)
    {
        Car carX = x as Car;
        Car carY = y as Car;
        if (carX == null && carY == null)
            return 0;
        if (carX != null && carY == null)
            return 1;
        if (carY != null && carX == null)
            return -1;

        switch (sortColumn)
        {
            case "Make":
                return carX.Make.CompareTo(carY.Make);
            case "Model":
                return carX.Model.CompareTo(carY.Model);
            case "Year":
            default:
                return carX.Year.CompareTo(carY.Year);
        }
    }
} 
```

# .net - .NET 2.0 编译的应用程序在没有 .NET 3.5 运行时的机器上失败

> ID：1013614
> 
> 赞同：1
> 
> 时间：2009-06-18T16:11:19.887
> 
> 标签：.net, .net-2.0

我在一台还包含 VS 2008 Express 的机器上使用 C# 2005 Express 编译了一个 NET 2.0 应用程序。当我在具有 .NET 2.0 SP1 运行时的机器上运行应用程序时，只有应用程序不执行并引发关于向 Microsoft 等发送报告的错误。我的印象是编译器默默地引用了某些 3.5 库并且是可执行的期待它在目标机器上。如何强制编译为纯 .NET 2.0？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-18T16:39:21.630

除了针对[marr75 提到](https://stackoverflow.com/questions/1013614/net-2-0-compiled-app-fails-on-machine-without-net-3-5-runtime/1013645#1013645)的特定框架之外，您还需要验证您引用的任何其他程序集是否针对 .net 2.0。如果您使用任何第 3 方程序集，它们可能对 .NET 3.5 有要求。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-18T16:16:06.817

在使用 Visual Studio 2008 的项目属性页面中，您可以针对特定的框架版本。但是，如果您在 VS2005 中编译它，如果这是您的问题，那就奇怪了，尽管发生了奇怪的事情。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-18T16:16:57.657

检查事件日志中的错误并使用融合日志记录来尝试识别它试图引用的程序集（如果您认为它试图在 DotNet 3.5 框架中加载程序集）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-18T17:00:16.080

您提到您使用 2005 年“编译”了该应用程序，但它最初是使用 2005 年还是 2008 年“创建”的？如果创建于 2008 年，则配置文件或参考中可能有需要查看的内容。

# c# - 在 VS2010 中制作 WPF 表单会比现在更容易吗？

> ID：1013622
> 
> 赞同：1
> 
> 时间：2009-06-18T16:12:23.617
> 
> 标签：c#, wpf

在 VS2010 中制作 WPF 表单会比现在更容易吗？我只是一个初学者，我发现仅仅学习 C# 本身就是大量的信息让我了解。但是我已经看到一些使用 WPF 完成的项目，它们看起来很棒。我现在是否值得花时间开始研究 WPF，或者等到 VS2010，如果我理解正确，有更好的工具可以使用它吗？谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-18T16:42:47.120

即使经过改进，VS 2010 也不会突然成为 WPF 应用程序创建的圣杯。现在最好学习 .NET 3.0/3.5 的基础知识（绑定、模板、命令等）。如果您对 WPF 的视觉方面感兴趣，我还建议您下载[Expression Blend的试用版。](http://www.microsoft.com/Expression/products/Overview.aspx?key=blend)虽然您当然可以手动完成大多数 XAML 编码，但 Blend 使它更快。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-18T16:15:13.273

Visual Studio 将提供更好的工具来使用 WPF，请参阅[此处了解详细信息。](http://blogs.msdn.com/tims/archive/2008/11/03/wpf-developers-pdc-wrap-up-and-visual-studio-tooling-update.aspx)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-02-16T00:25:21.177

我们当然希望您会发现新的 Visual Studio 2010 WPF 和 Silverlight 设计器有助于使使用 Forms 比在 Visual Studio 2008 中更容易。

查看此链接以获取有关新设计师的一些有用资源：http: [//blogs.msdn.com/wpfsldesigner/pages/faq-for-wpf-and-silverlight-designer-in-visual-studio-2010.aspx](http://blogs.msdn.com/wpfsldesigner/pages/faq-for-wpf-and-silverlight-designer-in-visual-studio-2010.aspx)

让我们知道您的想法！

Mark Wilson-Thomas 项目经理，WPF 和 Silverlight 设计师，Visual Studio

# c# - Linq to Entities - 使用主键增加一列

> ID：1013626
> 
> 赞同：0
> 
> 时间：2009-06-18T16:12:43.803
> 
> 标签：c#, linq, linq-to-entities

我有这个代码：

```
 Message message = new Message();
    message.Id = 5;
    message.EntityKey = context.CreateEntityKey("MessageSet", entity);
    message.Votes++;
    context.Attach(entity);
    context.ObjectStateManager.GetObjectStateEntry(entity.EntityKey).SetModifiedProperty("Votes");
    Save(); 
```

当然，Votes 初始化为 0。

如何生成类似的东西

```
Update Messages set Votes=Votes+1 where Id = 5 
```

?? 谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-18T16:25:47.533

由于 LINQ to Entities 是一个 OR 映射器，因此一般的想法是，您将首先查询需要更新的一个或多个实体，使用代码中的对象更新它们，然后在 ObjectContext 上发出更新命令以持久保存对这些实体的更改. 这是一个关键的东西，但通常很难在早期掌握，但使用像实体框架、NHibernate、LINQ to SQL 等 ORM 的原因是为了消除编写 SQL 的需要，而是使用对象。

以下应该是您需要的：

```
Message msg = context.Messages.First(m => m.Id == 5);
msg.Votes += 1;

context.SaveChanges(); 
```

The call to SaveChanges will generate SQL CUD statements for you, one for each update, insert, and/or delete.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-18T16:19:52.650

我不认为你可以直接实现这一点，但是，你可以使用一些**导入函数**并使用 SP 来做你需要的事情。

# unit-testing - 使用 groovy 模拟包装类

> ID：1013631
> 
> 赞同：0
> 
> 时间：2009-06-18T16:13:42.510
> 
> 标签：unit-testing, groovy, mocking

我目前正在尝试回过头来为一些包装现有类的代码编写单元测试。我正在寻找的函数的代码如下所示......

```
private OldObject oldObject
...
public Boolean method(){
  Boolean returnValue = false
  if(oldObject.method(100)){
    returnValue = true  
  }
  if(oldObject.method(101)){
    returnValue = true
  }
} 
```

我曾考虑过使用元类，例如 OldObject.metaClass.method{return true} 但我不确定如何在下一次测试之前将其删除。

有人对这种情况有最佳实践/帮助吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-19T01:53:29.093

要模拟该方法，请使用：

```
OldObject.metaClass.method = {return true} 
```

请注意，这将模拟 OldObject 的*所有*实例的方法，但也可以仅模拟单个实例的方法。当您想删除模拟方法时，只需将 metaClass 设置为 null：

```
OldObject.metaClass = null 
```

我认为您至少需要使用 Groovy 1.6 才能使其正常工作。

# asp.net - 在 IE8 中意外缓存 AJAX 结果

> ID：1013637
> 
> 赞同：135
> 
> 时间：2009-06-18T16:14:58.517
> 
> 标签：asp.net, jquery, ajax, internet-explorer

我对来自 JQuery Ajax 请求的 Internet Explorer 缓存结果存在严重问题。

我的网页上有标题，每次用户导航到新页面时都会更新。加载页面后，我会这样做

```
$.get("/game/getpuzzleinfo", null, function(data, status) {
    var content = "<h1>Wikipedia Maze</h1>";
    content += "<p class='endtopic'>Looking for <span><a title='Opens the topic you are looking for in a separate tab or window' href='" + data.EndTopicUrl + "' target='_blank'>" + data.EndTopic + "<a/></span></p>";
    content += "<p class='step'>Step <span>" + data.StepCount + "</span></p>";
    content += "<p class='level'>Level <span>" + data.PuzzleLevel.toString() + "</span></p>";
    content += "<p class='startover'><a href='/game/start/" + data.PuzzleId.toString() + "'>Start Over</a></p>";

    $("#wikiheader").append(content);

}, "json"); 
```

它只是将标题信息注入页面。您可以通过访问[www.wikipediamaze.com](http://www.wikipediamaze.com)来查看它，然后登录并开始一个新的谜题。

在我测试过的所有浏览器（Google Chrome、Firefox、Safari、Internet Explorer）中，**除了**IE 之外，它都运行良好。**Eveything第一次**在 IE 中被注入就好了，但之后它甚至再也没有调用`/game/getpuzzleinfo`. 就像它已经缓存了结果或其他东西。

如果我将呼叫更改为`$.post("/game/getpuzzleinfo", ...`IE 就可以了。但随后 Firefox 停止工作。

有人可以解释一下为什么 IE 会缓存我的`$.get`ajax 调用吗？

**更新**

根据下面的建议，我已将我的 ajax 请求更改为此，这解决了我的问题：

```
$.ajax({
    type: "GET",
    url: "/game/getpuzzleinfo",
    dataType: "json",
    cache: false,
    success: function(data) { ... }
}); 
```

* * *

## 回答 #1

> 赞同：177
> 
> 时间：2009-06-18T16:31:02.587

IE 因其对 Ajax 响应的激进缓存而臭名昭著。当您使用 jQuery 时，您可以设置一个全局选项：

```
$.ajaxSetup({
    cache: false
}); 
```

这将导致 jQuery 向请求查询字符串添加一个随机值，从而防止 IE 缓存响应。

请注意，如果您有其他 Ajax 调用在您想要缓存的地方进行，这也会为这些调用禁用它。在这种情况下，切换到使用 $.ajax() 方法并为必要的请求显式启用该选项。

有关详细信息，请参阅[http://docs.jquery.com/Ajax/jQuery.ajaxSetup](http://docs.jquery.com/Ajax/jQuery.ajaxSetup)。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-06-18T16:30:26.453

正如[marr75](https://stackoverflow.com/questions/1013637/unexpected-caching-of-ajax-results-in-ie8/1013661#1013661)提到的，`GET`'s 被缓存。

有几种方法可以解决这个问题。除了修改响应标头之外，您还可以将随机生成的查询字符串变量附加到目标 URL 的末尾。这样，每次请求时，IE 都会认为它是不同的 URL。

有多种方法可以做到这一点（例如使用`Math.random()`、日期的变化等）。

这是您可以做到的一种方法：

```
var oDate = new Date();
var sURL = "/game/getpuzzleinfo?randomSeed=" + oDate.getMilliseconds();
$.get(sURL, null, function(data, status) {
    // your work
}); 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-06-18T16:19:22.293

获取始终是可缓存的。一种可行的策略是编辑响应标头并告诉客户端不要缓存信息或很快使缓存过期。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2011-08-30T09:36:35.723

如果您正在调用 ashx 页面，您还可以使用以下代码禁用服务器上的缓存：

```
context.Response.Cache.SetCacheability(HttpCacheability.NoCache);
context.Response.Cache.SetRevalidation(HttpCacheRevalidation.AllCaches); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-18T16:36:07.933

这就是我为 ajax 调用所做的：

```
var url = "/mypage.aspx";
// my other vars i want to add go here
url = url + "&sid=" + Math.random();
// make ajax call 
```

它对我来说效果很好。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-12-16T17:39:36.823

NickFitz 给出了一个很好的答案，但是您还需要在 IE9 中关闭缓存。为了只针对 IE8 和 IE9，您可以这样做；

```
<!--[if lte IE 9]>
<script>
    $.ajaxSetup({
        cache: false
    });
</script>
<![endif]--> 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2010-04-27T15:08:46.100

这里的答案对于那些使用 jQuery 或出于某种原因直接使用 xmlHttpRequest 对象的人非常有帮助......

如果您使用的是自动生成的 Microsoft 服务代理，则解决起来并不简单。

诀窍是在事件处理程序中使用 Sys.Net.WebRequestManager.add_invokingRequest 方法更改请求 url：

```
networkRequestEventArgs._webRequest._url = networkRequestEventArgs._webRequest._url + '&nocache=' + new Date().getMilliseconds(); 
```

我在博客上写过这个：http: [//yoavniran.wordpress.com/2010/04/27/ie-caching-ajax-results-how-to-fix/](http://yoavniran.wordpress.com/2010/04/27/ie-caching-ajax-results-how-to-fix/)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2010-10-06T06:16:00.293

刚刚写了一篇关于这个确切问题的博客，只使用 ExtJS ( [http://thecodeabode.blogspot.com/2010/10/cache-busting-ajax-requests-in-ie.html](http://thecodeabode.blogspot.com/2010/10/cache-busting-ajax-requests-in-ie.html) )

问题是当我使用特定的 url 重写格式时，我不能使用常规的查询字符串参数 (?param=value)，所以我将缓存破坏参数写为发布的变量......我本来以为使用 POST 变量比 GET 更安全，因为很多 MVC 框架都使用该模式

协议：//主机/控制器/动作/param1/param2

所以变量名到值的映射丢失了，参数被简单地堆叠了......所以当使用 GET 缓存破坏者参数时

即协议：//主机/控制器/动作/param1/param2/no_cache122300201

no_cache122300201 可能被误认为是一个可能具有默认值的 $param3 参数

IE

公共函数操作($param1, $param2, $param3 = "默认值") { //..// }

POSTED 缓存破坏者不会发生这种情况

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2015-10-23T13:57:00.717

如果您使用的是 ASP.NET MVC，只需在控制器操作的顶部添加这一行：

```
[OutputCache(NoStore=true, Duration = 0, VaryByParam = "None")]
public ActionResult getSomething()
{

} 
```

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2016-04-05T19:24:02.370

IE 有权进行此缓存；为确保项目不被缓存，应相应地设置标题。

如果您使用的是 ASP.NET MVC，您可以编写一个`ActionFilter`; 在`OnResultExecuted`，检查`filterContext.HttpContext.Request.IsAjaxRequest()`。如果是这样，请设置响应的过期标头：`filterContext.HttpContext.Response.Expires = -1;`

根据[http://www.dashbay.com/2011/05/internet-explorer-caches-ajax/](http://www.dashbay.com/2011/05/internet-explorer-caches-ajax/)：

> 有些人更喜欢使用 Cache - Control: no - 缓存头而不是 expires。区别如下：
> Cache-Control:no-cache – 绝对没有缓存
> Expires:-1 – 浏览器“通常”通过条件 If-Modified-Since 请求联系 Web 服务器以更新该页面。但是，该页面仍保留在磁盘缓存中，并在不联系远程 Web 服务器的适当情况下使用，例如当使用 BACK 和 FORWARD 按钮访问导航历史或浏览器处于脱机模式时。

# asp.net - 筛选 ASP.NET Linq-to-Entities 中的子元素

> ID：1013642
> 
> 赞同：1
> 
> 时间：2009-06-18T16:15:46.097
> 
> 标签：asp.net, asp.net-mvc, linq, entity-framework, linq-to-entities

我有以下类型的情况：

```
TABLE Customers (
    CustomerID int,
    etc... )

TABLE Orders (
    OrderID int,
    CustomerID int,
    Active bit,
    etc... ) 
```

我在使用 Linq-to-Entities 的 ASP.NET MVC Web 应用程序中使用它。我想选择所有客户并填充 Customer.Orders 导航属性，并且应该只填充订单 where `Active==true`。

我已经看到其他指向 的问题`DataLoadOptions.AssociateWith`，但似乎我无法在 ASP.NET 中使用它。我也看过[这篇文章](http://www.eggheadcafe.com/aspnet/how-to/3908044/sorting-child-collections.aspx)，但在我列举客户时，我认为我需要调用 CreateSourceQuery()。我想这是可能的，但似乎打破了 MVC 范式。

这似乎与“[使用子集合过滤子集合](https://stackoverflow.com/questions/503876/filter-child-collection-using-a-child-collection-of-the-child)”的情况类似，但我需要解决方案来解决 Linq-to-Entities 而不是 NHibernate。谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-18T17:54:25.720

[您可以在此提示](http://blogs.msdn.com/alexj/archive/2009/06/02/tip-22-how-to-make-include-really-include.aspx)中找到答案。

# html - IE CSS 浮动问题

> ID：1013644
> 
> 赞同：2
> 
> 时间：2009-06-18T16:15:49.110
> 
> 标签：html, css

此代码的输出在 Windows 上的 FF、Chrome 和 Safari 中看起来几乎相同。在 IE7 中它看起来很奇怪。

对于所有其他浏览器，即使在框架中有一个 24X24 的 div 但在画布之外，框架 div 也会完全包裹画布 div。IE7 在画布上方的框架中为“蓝框”div 留出了额外的空间。一旦漂浮，我认为它本来占据的空间会坍塌。这就是我在其他浏览器中看到的行为。

是否有一些技巧可以让 IE7 像其他人一样折叠空间？

编辑：只是想知道这个例子应该代表什么。它应该代表一个嵌入式小部件。“画布”是内容所属的地方。“框架”是托管站点用来控制小部件与页面其余部分之间的外观和行为的东西。红框和蓝框 div 代表小部件中的控件。红框是放在那里我的小部件代码的控件。蓝框表示由框架添加的控件（可能是允许在页面周围拖动小部件的句柄）

这是完整的示例

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en" >
<head>
<title>CSS Positioning</title>
<style type="text/css">
#frame {
  position: relative;      /* so subelements can be positioned             */
  width: 400px;            /* an arbitrary width                           */
  border: 1px solid black; /* a border so you can see it                   */
}
#canvas {
  position: relative;      /* so subelements can be positioned             */
  width: 400px;            /* an arbitrary width                           */
  border: 1px solid black; /* a border so you can see it                   */
}
#blue-box{
  position: relative;      /* so I can position this element               */
  float: right;            /* I want this element all the way to the right */
  width: 24px;             /* set size of eventual graphic replacement     */
  height: 24px;
}
#red-box{
  position: relative;      /* so I can position this element               */
  width: 24px;             /* set size of eventual graphic replacement     */
  height: 24px;
}

</style>
</head>
<body>

<div id="frame">
  <div id="blue-box">blue</div>
  <div id="canvas">
    <div id="red-box">red</div>
  </div>
</div>

</body>  
</html> 
```

艾米丽的额外示例 =============================================== ======

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en" >
<head>
<title>CSS Positioning</title>
<style type="text/css">
* {
  margin: 0;
  padding: 0;
}
#one {
  background-color: red;
  float: right;
}
#two {
  background-color: blue;
  border: 1px solid black;
}

</style>
</head>
<body>

<div id="one">one</div>
<div id="two">two</div>

</body>  
</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-18T16:25:07.080

我以前遇到过这个问题，我很难记住它发生了什么。我想你需要`position: relative`脱掉`#blue-box`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-18T16:26:24.960

“框架”和“画布”div 的大小可能存在问题。看起来它们的大小都相同，加上边框的大小（它被添加到元素的总大小中）。尝试不为您的“画布”div 指定大小，但给它留出一个边距，以便与“蓝框”div 适当地隔开。

如有疑问，请通过将边距/填充设置为 0 一个可疑元素来重置元素。如果未定义，浏览器之间可能会出现默认间距。

另外，我认为这里不需要“位置：相对”。

橡子

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-18T16:51:06.053

`#frame`包含`#canvas`宽度为 400 像素和宽度为 24 像素`#blue-box`的内容。

`#frame`宽度必须至少为 424 像素（可能需要更多...取决于元素上的填充），但`#frame`宽度仅为 400 像素。

尝试将宽度更改`#frame`为 430px 以使两个框位于同一行。根据移除 css 重置的填充，您可以使 #frame 的宽度更小。

* * *

然后你需要把`#blue-box`里面`#canvas`

```
<div id="frame">
  <div id="canvas">
    <div id="blue-box">blue</div>
    <div id="red-box">red</div>
  </div>
</div> 
```

浮动 div 不会重叠或“向下延伸到它们下方的 div”。[这是一篇关于CSS Floats](http://www.smashingmagazine.com/2007/05/01/css-float-theory-things-you-should-know/)的好文章

* * *

这是我推荐使用绝对定位的一次。 `position: absolute`从文档流中删除元素——就像你想要的`#blue-box`.

```
#frame {
  position: relative;      /* so subelements can be positioned             */
  width: 400px;            /* an arbitrary width                           */
  border: 1px solid black; /* a border so you can see it                   */
}
#canvas {
  width: 400px;            /* an arbitrary width                           */
  border: 1px solid black; /* a border so you can see it                   */
}
#blue-box{
  position: absolute;      /* so I can position this element               */
  right: 0;                /* I want this element all the way to the right */
  top:0;
  width: 24px;             /* set size of eventual graphic replacement     */
  height: 24px;
}
#red-box{
  width: 24px;             /* set size of eventual graphic replacement     */
  height: 24px;
}

<div id="frame">
   <div id="blue-box">blue</div>
  <div id="canvas">
    <div id="red-box">red</div>
  </div>
</div> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-18T16:23:54.290

IE 增加了一些额外的填充和边距。您应该使用[reset.css 文件并重](http://meyerweb.com/eric/tools/css/reset/)试。

通常，IE 的行为不像浏览器那样，因此您可能需要创建 IE 特定的样式表。

```
<!--[if IE]><link rel="stylesheet" type="text/css" href="/public/stylesheets/ie.css" /><![endif]-->

<!--[if IE 6]><link rel="stylesheet" type="text/css" href="/public/stylesheets/ie6.css" /><![endif]-->

<!--[if IE 7]><link rel="stylesheet" type="text/css" href="/public/stylesheets/ie7.css" /><![endif]--> 
```

* * *

**编辑**：

包装画布是一个搞砸的东西，因为它与框架的大小相同。如果你这样做：

```
#frame {
  position: relative;      /* so subelements can be positioned             */
  width: 460px;            /* an arbitrary width                           */
  border: 1px solid black; /* a border so you can see it                   */
} 
```

它解决了这个问题。您只需调整宽度即可获得所需的尺寸。

**EDIT2**：我看到您的一条评论说您希望 IE 表现得像其他浏览器一样......这不会发生，这个浏览器太糟糕了。您可能希望完全重构代码以避免导致 IE 出现问题的不必要包装器

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-18T16:25:24.180

您是否尝试过删除代码中的空格。ie7 对空白可能很有趣。

```
<div id="frame"><div id="blue-box">blue</div><div id="canvas"><div id="red-box">red</div></div></div> 
```

乔什

# iphone - 过滤输入到 UITextField 中的字符

> ID：1013647
> 
> 赞同：13
> 
> 时间：2009-06-18T16:16:14.320
> 
> 标签：iphone, objective-c, uitextfield

我的应用程序中有一个 UITextField。我想将可以输入到字段中的字符集限制为我定义的字符集。当使用 UITextFieldDelegate 方法提交文本时，我可以过滤输入到字段中的字符：

```
- (BOOL)textFieldShouldReturn:(UITextField*)textField 
```

但是，这会给用户一种错误的印象，因为尽管限制字符已从最终值中删除，但在按下 Return/Done/etc 之前，它们仍然可见地输入到文本字段中。防止在键盘上选择受限字符时出现在文本字段中的最佳方法是什么？

**注意：**我在假设我几乎无法控制 iPhone 键盘提供哪些键的情况下进行操作。我知道我可以在各种键盘实现之间切换，但我的印象是我无法禁用特定键。这个假设可能是不正确的。

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2009-06-18T21:25:06.373

我按照marcc的建议做了，效果很好。示例实现如下。

**注意：**为简洁起见选择了变量名称，并不反映我的编码标准：

```
 ...
    myCharSet = [NSCharacterSet characterSetWithCharactersInString:@"xyzXYZ"];
    ...
}

- (BOOL) textField:(UITextField*)textField shouldChangeCharactersInRange:(NSRange)range replacementString:(NSString*)textEntered {
    for (int i = 0; i < [textEntered length]; i++) {
        unichar c = [textEntered characterAtIndex:i];
        if (![myCharSet characterIsMember:c]) {
            return NO;
        }
    }
    return YES;
} 
```

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2009-06-18T16:50:09.550

看着`textField:shouldChangeCharactersInRange`

`UITextFieldDelegate`每当键入新字符或从文本字段中删除现有字符时，都会调用此方法。您可以返回 NO 以不允许更改。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-07-25T14:03:53.683

这是限制在 UITextField 中输入的字符的最简洁的方法之一。这种方法允许使用多个预定义的 NSCharacterSet。

```
-(BOOL)textField:(UITextField *)textField shouldChangeCharactersInRange:(NSRange)range replacementString:(NSString *)string{

    NSMutableCharacterSet *allowedCharacters = [NSMutableCharacterSet alphanumericCharacterSet];
    [allowedCharacters formUnionWithCharacterSet:[NSCharacterSet whitespaceCharacterSet]];
    [allowedCharacters formUnionWithCharacterSet:[NSCharacterSet symbolCharacterSet]];

    if([string rangeOfCharacterFromSet:allowedCharacters.invertedSet].location == NSNotFound){

        return YES;

    }

    return NO;

} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-06-18T16:51:13.963

看`UITextViewDelegate`方法`- (BOOL)textField:(UITextField *)textField shouldChangeCharactersInRange:(NSRange)range replacementString:(NSString *)string`。

这正是您所需要的。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2014-09-23T16:03:45.073

这就是我用来将用户限制为大写 AZ 的方法。根据口味调整正则表达式变量：

```
- (BOOL)textField:(UITextField *)textField shouldChangeCharactersInRange:(NSRange)range replacementString:(NSString *)string {

    NSString* regex = @"[^A-Z]";
    return ([string rangeOfString: regex
                      options:NSRegularExpressionSearch].location == NSNotFound);
}; 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-04-06T05:43:37.273

这个怎么样？

```
- (BOOL)textField:(UITextField *)textField shouldChangeCharactersInRange:(NSRange)range replacementString:(NSString *)string {

    NSString* regex = @"[^a-z]";
    return ([[string lowercaseString] rangeOfString: regex
                      options:NSRegularExpressionSearch].location == NSNotFound);
}; 
```

笔记：

我将所有字符都设为小写`[string lowercaseString]`，这样您就不需要用正则表达式来写大写/小写字母。

* * *

## 回答 #7

> 赞同：-6
> 
> 时间：2009-06-18T16:51:18.583

一旦调用了 DidBeginEditing 方法，您可以循环并继续检查 UITextField.text 属性是否已更改。如果有，请检查文本并删除错误字符。

# c# - 为什么 DateTime.TryParse 在给定真实年份字符串时返回 false？

> ID：1013650
> 
> 赞同：3
> 
> 时间：2009-06-18T16:16:51.153
> 
> 标签：c#, .net, datetime, tryparse

在下面的代码中，我给函数一个 sTransactionDate="1999" 并且我试图将它转换为日期 x/x/1999。

```
DateTime dTransactionDate = new DateTime();
if(DateTime.TryParse(sTransactionDate, out dTransactionDate))
{ //Happy 
}else
{ //Sad 
} 
```

如果字符串是“1999”，它总是会以悲伤结尾。有任何想法吗？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-06-18T16:20:34.447

尝试这样的事情（适当调整`CultureInfo`和`DateTimeStyles`）：

```
DateTime.TryParseExact
  ("1999",
   "yyyy",
   CultureInfo.InvariantCulture,
   DateTimeStyles.None,
   out dTransactionDate) 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-06-18T16:28:04.350

怎么样...

```
DateTime dTransactionDate = new DateTime();
if (DateTime.TryParseExact(sTransactionDate, "yyyy",
    CultureInfo.InvariantCulture, DateTimeStyles.None, out dTransactionDate))
{
    // Happy
}
else
{
    // Sad
} 
```

...甚至只是...

```
DateTime dTransactionDate = new DateTime(int.Parse(sTransactionDate), 1, 1);
// Happy 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-18T16:19:54.507

“1999”不是日期，而是一年尝试 1/1/1999

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-09-20T19:38:44.260

还要在系统日历上验证您尝试解析的日期是否存在。就像您会发现 "2/29/1949" 也将返回 false 一样，因为它在日历上从未存在过。

# c - 使用 Cygwin 编译 C 程序；执行错误

> ID：1013651
> 
> 赞同：18
> 
> 时间：2009-06-18T16:16:52.120
> 
> 标签：c, gcc, cygwin

我注册了一个硕士计算机科学课程。该课程使用C语言，如果我们使用Windows ，讲师希望我们使用[Cygwin编译程序。](http://www.cygwin.com/)

我已经下载并安装了[Cygwin](http://www.cygwin.com/)，并确保我已经安装了[GCC 编译器](http://gcc.gnu.org/)。

但我不知道从这里去哪里。我需要编译具有基本包含的单个源文件。

```
#include <stdio.h> 
```

让我们假设该文件在我的桌面上（它不是，但为了争论）。如何从 bash shell 导航到桌面？我假设一旦我导航到 bash 中的正确位置，我只需执行：

```
gcc myProgram.c -o myProgram 
```

**更新**：按照下面发布的不同说明，我能够编译程序；我为此感谢你。但是当我执行生成的二进制文件时，我得到以下信息。如何编译或执行此程序，以免出现错误？再次谢谢你。

`This application has failed to start because cygwin1.dll was not found. Re-installing the application may fix this problem.`

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-06-18T16:20:49.470

当你从 cygwin 开始时，你在你的 $HOME 中，就像在一般的 unix 中一样，它默认映射到 c:/cygwin/home/$YOURNAME。所以你可以把所有东西都放在那里。

您还可以通过 /cygdrive/c/ 从 cygwin 访问 c: 驱动器（例如 /cygdrive/c/Documents anb Settings/yourname/Desktop）。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-06-18T17:14:21.177

关于您关于**丢失 cygwin1.dll**的更新问题。

从 Cygwin 终端检查，

```
ls /usr/bin/cygwin1.dll 
```

如果它不存在（我对此表示怀疑），则说明您的安装未正确完成。

然后，检查你的路径，

```
echo $PATH 
```

这将给出`:`单独的路径列表。它必须包含`/usr/bin`. 如果您发现缺少添加它，

```
export PATH=/usr/bin:$PATH 
```

最后，

*   我希望你是从 cygwin 终端（随 Cygwin 安装的绿色+黑色小图标）或 MinTTY（如果你安装了它）使用 Cygwin。
*   而且，您还没有将已编译的 EXE 移动到未安装 Cygwin 的另一台机器上（如果这样做，您需要将 cygwin1.dll 带到该机器 - 将其保存在与已编译的 EXE 相同的文件夹中） .

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-06-18T16:38:22.503

总结一下，这里有一些使用 Cygwin 和 Windows Vista 导航到目录并编译代码的命令：

1.  启动 Cygwin shell。
2.  在提示符下，使用`cd`切换到相应的目录：

    $ cd /cygdrive/c/Users/nate/桌面

3.  用于`ls`列出目录中的文件：

    $ ls

    程序.c

4.  使用`gcc`命令编译此目录中的文件：

    $ gcc prog.c -o 编

5.  如果您没有看到任何错误，您应该能够运行生成的程序：

    $ ./编

**更新：**

对于“ `Cygwin1.dll not found`”错误，我喜欢 Nik 的回答。您还可以查看[有关 cygwin1.dll not found 的相关帖子](https://stackoverflow.com/questions/338406/cygwin1-dll-not-found-when-running-a-program-written-in-c-how-can-i-make-windo)，该帖子建议添加`c:\cygwin\bin\`到您的 Windows PATH。

有[关于如何更改](http://www.computerhope.com/issues/ch000549.htm)Windows XP 的 Windows PATH 变量的说明，在 Vista 上我认为它是相似的。

1.  转到控制面板 -> 系统
2.  选择*高级系统设置*
3.  单击*高级*选项卡
4.  点击*环境变量*
5.  在*System Variables*下，找到*Path*条目并单击*Edit*
6.  添加`c:\cygwin\bin`到列表中，确保用分号将其与之前的任何项目分开

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-06-18T16:20:20.140

寻找（即`cd`到）

```
/cygdrive/c/ 
```

这通常是你的`C:\`

* * *

还可以查看[Using Cygwin](http://cygwin.com/1.7/cygwin-ug-net/using.html)、[Lifehacker 介绍（2006 年 6 月）](http://lifehacker.com/179514/geek-to-live--introduction-to-cygwin-part-i)和[PhysioNet 上的这个 biomed 页面](http://www.physionet.org/physiotools/cygwin/)。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-06-18T17:42:09.360

关于`cygwin1.dll`未找到错误，我使用了至少 8 年的解决方案是`%PATH%`在我的电脑 -> 属性 -> 高级 -> 环境变量中将 Cygwin bin 目录添加到我的末尾。我将它们添加到路径的末尾，因此在我的正常工作中，最后搜索它们，最大限度地减少冲突的可能性（事实上，我一直没有遇到冲突问题）。

当您调用 Cygwin Bash Shell 时，这些目录会被添加到前面，`%PATH%`以便在该环境中一切都按预期工作。

当不在 Cygwin shell 中运行时，我`%PATH%`的是：

```
Path=c:\opt\perl\bin; \
     ...
     C:\opt\cygwin\bin; \
     C:\opt\cygwin\usr\bin; \
     C:\opt\cygwin\usr\local\bin; 
```

这样，例如，当我不在 Cygwin Shell 中时，首先找到 ActiveState Perl 的 perl，但是当我在 Cygwin Shell 中工作时，会找到 Cygwin perl。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-06-18T16:35:23.253

如果您对 bash 不满意，您可以继续在标准的 windows 命令（即 DOS）shell 中工作。

为此，您必须将 C:\cygwin\bin（或您的本地替代方案）添加到 Windows PATH 变量中。

完成此操作后，您可以： 1) 打开命令 (DOS) shell 2) 将目录更改为代码所在的位置（c:，然后 cd path\to\file） 3) gcc myProgram.c -o myProgram

正如 nik 的回复中提到的，“使用 Cygwin”文档是了解更多信息的好地方。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-09-10T05:06:28.730

如果你只是做 gcc program.c -o program -mno-cygwin 它会编译得很好，你不需要将 cygwin1.dll 添加到你的路径中，你可以继续将你的可执行文件分发到没有的计算机'没有安装 cygwin，它仍然会运行。希望这可以帮助

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-06-18T16:22:07.660

`C:\src`cygwin下的windows路径变成`/cygdrive/c/src`

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-06-18T16:22:16.677

使用 Cygwin 编译 C 程序

我们将在 Cygwin 上使用 gcc 编译器来编译程序。

1) 启动 Cygwin

2）通过键入更改到您为此类创建的目录

cd c:/windows/桌面

3）通过键入编译程序

gcc myProgram.c -o myProgram

命令 gcc 调用 gcc 编译器来编译你的 C 程序。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-06-18T16:23:25.070

您最好在 cygwin shell 中编辑文件。通常，当您启动它时，它具有默认用户目录。您可以从 shell 编辑文件，执行“vi somefile.c”或“emacs somefile.c”之类的操作。假设在 cygwin 中安装了 vi 或 emacs。

如果要在桌面上归档，则必须转到类似于（在 XP 上）“/cygwindrive/c/Documents\ and\ Settings/Frank/Desktop”的路径（如果内存正常）。只需 cd 到该路径，然后在文件上运行您的命令。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-06-18T16:31:51.913

Cygwin 很酷！您可以从其他系统（例如 Linux）编译程序，*并且它们可以工作*。我说的是通信程序，甚至是网络服务器。

这是一个技巧。如果您在 Windows 文件资源管理器中查看您的文件，您可以在 bash 窗口中键入“cd”，然后从资源管理器的地址栏拖到 cygwin 窗口中，完整路径将被复制！顺便说一句，这也适用于 Windows 命令外壳。

另外：虽然“cd /cygdrive/c”是正式路径，但它也接受“cd c:”作为快捷方式。在拖入路径的其余部分之前，您可能需要执行此操作。

应该会自动找到 stdio.h 文件，就像在传统系统上一样。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2018-06-17T10:55:13.103

此文件（cygwin1.dll）是 cygwin 依赖项，类似于 qt 依赖项。您必须将此文件和出现在此类错误消息中的类似文件从“cygwin/bin”复制到程序的文件夹。这也是运行所必需的另一台没有cygwin的电脑！

# java - 为什么是这样的解决方案？

> ID：1013657
> 
> 赞同：1
> 
> 时间：2009-06-18T16:18:12.947
> 
> 标签：java

来自Java Malik教科书-确定一个数字是否可以被11整除..

提供的代码解决方案：

```
import java.util.*;

public class Divby11
{
    static Scanner console = new Scanner(System.in);

    public static void main (String[] args)
    {
        int num, temp, sum;
        char sign;

        System.out.print("Enter a positive integer: ");
        num = console.nextInt();
        System.out.println();

        temp = num;

        sum = 0;
        sign = '+';

        do
        {
            switch (sign)
            {
            case '+' :
                sum = sum + num % 10;
                sign = '-';
                break;

            case '-' :
                sum = sum - num % 10;
                sign = '+';
            }

            num = num / 10;       //remove the last digit
        }
        while (num > 0);

        if (sum % 11 == 0)
            System.out.println(temp + " is divisible by 11");
        else
            System.out.println(temp + " is not divisible by 11");
    } 
```

为什么要经历以上所有的努力，然后说...

```
 if (sum % 11 == 0)
            System.out.println(temp + " is divisible by 11");
        else
            System.out.println(temp + " is not divisible by 11"); 
```

你们中的任何一位专家都能明白为什么作者会这样做（很长的路要走）吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-06-18T16:23:19.377

对于[11 的除法规则](http://en.wikipedia.org/wiki/Divisibility_rule)：

*   形成数字的交替总和
*   如果这个总和可以被 11 整除，那么这个数字可以被 11 整除

## 例子

*   68090 = 0 - 9 + 0 - 8 + 6 = -11 => 真
*   493827 = 7 - 2 + 8 - 3 + 9 - 4 = 15 = 4 => 错误

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-18T16:21:25.523

这个代码示例实际上并不是除以 11。如果您看到，它在每个数字的加减之间交替，然后在最后检查结果是否可以被 11 整除。

例如，查看以下数字以及该算法如何使用它：

```
Start with sum=0, sign='+', num=517
First iteration: sum=7, sign='-', num=51
Second iteration: sum=6, sign='+', num=5
Final iteration: sum=11, sign='-', num=0 
```

最终结果可以被十一整除。

**编辑：正如dfa**在他的回答中提到的那样，该算法确实看起来正在实施 11 的除法规则。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-18T16:55:23.697

这是一个展示如何实施特定检查的示例。使用您的示例不会演示相同的代码方法。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-18T16:25:05.927

我怀疑它正在模拟奇数位置的数字和偶数位置的数字相差 11 倍的手动测试。在实践中使用 %11 将是可行的方法。

编辑：如果该示例确实试图避免执行 % 11，它应该再次发送总和，直到它为 0。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-18T16:25:51.183

您必须从书中提供更多关于作者试图展示的内容的背景信息。此代码示例不检查输入的数字是否能被 11 整除。它所做的是每隔一个数字相加，每隔一个数字相减，然后检查该数字是否能被 10 整除。

EX 输入的数字是 4938 将 8 加到 sum 除以 1 得到 493 将 3 从 sum 中减去：sum = 5 除以 10 得到 49 将 9 加到 sum：sum = 14 除以 1 得到 4取 4 从 sum 中减去：sum = 10

然后它检查它是否能被 11 整除。

好的，我现在知道为什么了。除了计算数字之外，他/她还试图教你一些东西

# c++ - visual studio - 发布模式下无效的 std::string 调试器输出

> ID：1013658
> 
> 赞同：3
> 
> 时间：2009-06-18T16:18:15.910
> 
> 标签：c++, visual-studio-2008, debugging

[![替代文字](../Images/95a897cc2166cc9c6275653a608e7b88.png)](https://i.stack.imgur.com/ot4W3.jpg)

这个程序没有什么特别的，但是我得到了垃圾输出。以下是我包含的头文件，以防相关。

```
#include <cstdlib>
#include <iostream>
#include <windows.h>
#include <vector>
#include <string>
#include <sstream> 
```

我在 Windows XP 上使用 Visual Studio 2008。

请注意，如果我将字符串打印到标准输出，它会完美地打印“测试”。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-18T16:26:02.620

如果您在发布模式下编译，有时调试器将无法获取正确的值。编译器可能会交换操作或将值移动到寄存器等。

# sql - 查询查找表的最佳实践

> ID：1013662
> 
> 赞同：2
> 
> 时间：2009-06-18T16:19:42.823
> 
> 标签：sql, lookup-tables

我正在尝试找出一种查询属性功能查找表的方法。

我有一个包含出租物业信息（地址、租金、押金、卧室数量等）的属性表，以及另一个代表该属性（游泳池、空调、现场洗衣等）的表（Property_Feature） .)。特征本身在另一个标有特征的表中定义。

```
Property
    pid - primary key
    other property details

Feature
    fid - primary key
    name
    value

Property_Feature
    id - primary key
    pid - foreign key (Property)
    fid - foreign key (Feature) 
```

假设有人想搜索有空调、游泳池和洗衣房的房产。如果每一行只代表一个特征，如何查询 Property_Feature 表以获取同一属性的多个特征？SQL 查询会是什么样子？这可能吗？有更好的解决方案吗？

感谢您的帮助和洞察力。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-18T16:25:24.053

在数据库设计方面，你的方法是正确的。它已正确标准化。

对于查询，我会简单地使用存在，如下所示：

```
select * from Property
where 
exists (select * from Property_Feature where pid = property.pid and fid = 'key_air_conditioning')
and
exists (select * from Property_Feature where pid = property.pid and fid = 'key_pool') 
```

其中 key_air_conditioning 和 key_pool 显然是这些功能的关键。

即使对于大型数据库，性能也可以。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-18T16:26:48.483

下面的查询将找到所有带有池的属性：

```
select
    p.*
from
    property p
    inner join property_feature pf on
        p.pid = pf.pid
    inner join feature f on
        pf.fid = f.fid
where
    f.name = 'Pool' 
```

我使用内部连接而不是`EXISTS`因为它往往会更快一些。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-18T17:13:22.427

你也可以这样做：

```
 SELECT * 
    FROM Property p
   WHERE 3 =
         ( SELECT COUNT(*)
             FROM Property_Feature pf
                , Feature f
            WHERE pf.pid = p.pid
              AND pf.fid = f.fid
              AND f.name in ('air conditioning', 'pool', 'laundry on-site')
         ); 
```

显然，如果你的前端在用户选择特征项时捕获它们的fid，你可以省去对Feature的join，直接在fid上进行约束。您的前端会知道所选功能的数量是多少，因此确定上面“3”的值是微不足道的。

在性能方面，将其与上面的 tekBlues 结构进行比较；根据您的数据分布，其中之一可能是更快的查询。

# c# - 不包括配置文件提供程序，是否有一种简单的方法可以将自定义字段添加到 ASP.NET 成员资格？

> ID：1013663
> 
> 赞同：0
> 
> 时间：2009-06-18T16:19:49.890
> 
> 标签：c#, asp.net, membership

我知道您可以将 Profile 提供程序用于自定义字段，但考虑到数据在数据库中的存储方式，它不能满足我的需求。

有没有办法将自定义字段添加到数据库以用于成员资格，同时利用所有内置的成员资格存储过程和 c# 类？（不添加字段到表，修改所有程序和方法）

谢谢！凯文

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-18T16:23:28.440

您是否查看过 Table Profile Provider，这是一个链接：[http](http://www.asp.net/downloads/sandbox/table-profile-provider-samples/) ://www.asp.net/downloads/sandbox/table-profile-provider-samples/ 。这可能会解决您的问题，因为它将每个值存储在单个列中，而不是像默认提供程序一样的单个列。

# python - 从 QScrollArea 中窃取 wheelEvents

> ID：1013670
> 
> 赞同：1
> 
> 时间：2009-06-18T16:20:34.477
> 
> 标签：python, pyqt

我想将我的自定义小部件放在 QScrollArea 中，但在我的自定义小部件中，我重新实现了 wheelEvent(e)，它永远不会被调用。

我对没有鼠标滚轮滚动功能的滚动区域很好。我只需要那些 wheelEvents 来调用我的处理程序。我尝试在主窗口级别处理事件，但我只有在滚动小部件处于其极端之一并且无论如何都无法进一步移动时才得到它们，我需要所有这些。

这是我的代码的简化版本：

```
class custom(QWidget):
    def __init__(self, parent=None):
        super(custom, self).__init__(parent)
        self.parent = parent

    def wheelEvent(self,event):
        print "Custom Widget's wheelEvent Handler"

class mainw(QMainWindow):
    def __init__(self, parent=None):
        super(mainw, self).__init__(parent)
        scroll = QScrollArea()
        self.tw = thread_widget(scroll)
        scroll.setWidget(self.tw)
        self.setCentralWidget(scroll)

    def wheelEvent(self,event):
        print "Main Window's wheelEvent Handler" 
```

有人可以向我解释如何确定在这种情况下哪个事件处理程序获取事件吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-18T20:06:22.147

我发现它与 QObject 的 installEventFilter 方法有关，但我无法让示例工作，所以我对这个说地狱并完全改变了我的计划。

问题解决了

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-11-11T23:09:18.000

您可以在自定义类中安装 eventFilter

```
class custom(QWidget):
    def __init__(self, parent=None):
        super(custom, self).__init__(parent)
        self.parent = parent
        self.installEventFilter(self)

    def eventFilter(self, qobject, qevent):
        qtype = qevent.type()
        if qtype == QEvent.Wheel:
            ... wheel event logic
            return True
        # parents event handler for all other events
        return super(custom,self).eventFilter(qobject, qevent) 
```

# php - 在 MySQL 表中插入 XML 解析数据时出现问题

> ID：1013671
> 
> 赞同：0
> 
> 时间：2009-06-18T16:20:49.407
> 
> 标签：php, mysql, xml

我正在尝试使用 PHP DOM 解析 XML，然后将此数据插入 MySQL 表中，为此我使用以下代码：

```
<?php
$xmlDoc = new DOMDocument();
$xmlDoc->load("testrtap11.xml");
mysql_select_db("zeeshan_database1", $con);

$x=$xmlDoc->getElementsByTagName('RECORD');
$z=$xmlDoc->getElementsByTagName('TITLE');
$w=$xmlDoc->getElementsByTagName('PRIMARY_AUTHOR');
$y=$xmlDoc->getElementsByTagName('JOURNAL_CONFERENCE');

for($i=0; $i<=$x->length-1; $i++)
{
    $sql="INSERT INTO Persons (FirstName, LastName, Age) VALUES('$z->item($i)->nodeValue','$w->item($i)->nodeValue','$y->item($i)->nodeValue')";

    if (!mysql_query($sql,$con))
    {
        die('Error: ' . mysql_error());
    }
    echo "1 record added";
}

mysql_close($con)
?> 
```

输入的数据不正确。我什至尝试将我的 xml 解析值存储在一个变量中，然后使用该变量插入数据，即使这样也不起作用。我使用了这样的变量：

```
for($i=0; $i<=$x->length-1; $i++)
{
    $zz=$z->item($i)->nodeValue);
    $ww=$w->item($i)->nodeValue);
    $yy=$y->item($i)->nodeValue);
    $sql="INSERT INTO Persons (FirstName, LastName, Age) VALUES('$zz','$ww','$yy')";

    if (!mysql_query($sql,$con))
    {
        die('Error: ' . mysql_error());
    }
    echo "1 record added";
} 
```

我的 xml 看起来像这样：

```
<RTAP>
  <RECORD>
     <TITLE>               </TITLE>
     <PRIMARY_AUTHOR>      </PRIMARY_AUTHOR>
     <JOURNAL_CONFERENCE>  </JOURNAL_CONFERENCE>
  </RECORD>
</RTAP> 
```

请帮助我，我该怎么办

最好的泽山

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-18T16:32:04.160

尝试这样的事情：

```
foreach ($xmlDoc->RECORD as $record)
{
    $sql = 'INSERT INTO Persons (FirstName, LastName, Age) VALUES('
        . '"' . mysql_escape_string($record->TITLE->nodeValue) . '", '
        . '"' . mysql_escape_string($record->PRIMARY_AUTHOR->nodeValue) . '", '
        . '"' . mysql_escape_string($record->JOURNAL_CONFERENCE->nodeValue) . '")'

    if (!mysql_query($sql,$con))
        die('Error: ' . mysql_error());

    echo "1 record added";
} 
```

你实际上并没有说插入的数据有什么问题......

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-18T17:28:34.843

I tried using the select command on my original code that i mentioned above: $result = mysql_query("SELECT * FROM Persons"); while($row = mysql_fetch_array($result)) { echo $row['FirstName'] . " " . $row['LastName']; echo "
"; }

And this is the output i got: (0)->nodeValue (0)->nodeValue (1)->nodeValue (1)->nodeValue (2)->nodeValue (2)->nodeValue (3)->nodeValue (3)->nodeValue

# 3d - 远距离 3D 对象渲染 [游戏]

> ID：1013675
> 
> 赞同：9
> 
> 时间：2009-06-18T16:21:28.597
> 
> 标签：3d, level-of-detail

技术背后的基本前提是什么，例如在 Oblivion 中发现的（以及其他游戏，我敢肯定；还没有玩到足够知道），当您从远处观看时，远处的物体会模糊地显示出来？例如，一座大塔在一英里外，你会看到它的模糊矩形从地平线上伸出来……显然，一个巨大的 3D 场景无法全部渲染，我知道在高度图的情况下，只有近似算法用于降低远离相机的高度图质量，但对于特定对象，显示它们的最佳方式是什么？

我在想可能是一种预渲染技术，您可以选择景观周围的特定位置，然后制作一个程序，在该位置周围绘制所有高度图和 3D 模型并拍照。它将拍摄几张照片，然后当玩家靠近该地点时，这些照片将用作天空盒。

另一种更明显的技术是存储非常粗糙的 3D 模型，但是 3D 渲染系统如何专门选择渲染建筑物的粗糙模型而不是其他不太重要的粗糙模型（并且可能无法从中查看-距离）物体？你将如何将这样的东西与你的高度图一起存储？也许按照设计，只有几个如此重要的地标，然后将它们的列表存储在一个小文件中，并在每一帧上渲染小于 x 的那些真正远距离的地标？

我知道 Halo 系列选择将游戏分成关卡，然后每个关卡都有不同的手工制作的天空盒。这就是我在第一个建议中想要的，但我不确定。我想我真的只是想在我的想法中收集其他想法或改进或问题，以便我可以用我有限的时间和知识选择哪些原型。

另一个相关主题是如何在远处显示山脉，因为它们将是高度图的一部分，而不是顶部的 3D 模型，因此它们实际上无法提供粗略的版本，并且高度图近似算法可能会出错从那样很远的距离上山（假设您甚至会尝试近似和渲染如此遥远的几何图形，而您可能不会这样做）。如果您在答案中也涵盖了这一点，则可以加分。:)

谢谢！

PS我正在使用OpenGL。我只是在寻找基本概念，但如果您选择发布示例代码，请使用 OpenGL 函数和术语！:)

编辑：感谢您的回答！出于文档目的，我发现了另一个资源：Game Programming Gems 2 中的第 4.9 章涵盖了将远处风景渲染到天空盒的概念：http: [//books.google.com/books ?id=1-NfBElV97IC&lpg=PA416&ots=SOpnfijZly&dq= render%20distant%20to%20skybox&pg=PA416](http://books.google.com/books?id=1-NfBElV97IC&lpg=PA416&ots=SOpnfijZly&dq=render%20distant%20to%20skybox&pg=PA416) （不幸的是，预览只是本章的第一页......我必须在八月份回来后尽快从我大学的图书馆里拿那本书）

同样在阅读了这些内容之后，我仍然认为 LOD 适用于距离仍然相当近的物体。如果对象甚至没有一个像素大，但您仍在将它们提供给显卡，那么无论是否使用 LOD，您都只是在浪费能量。除了绝对最大的遥远物体之外，其他一切都是如此。在大多数情况下，一些高楼和一些山脉，但从这么远的距离看不到小细节模型（灌木，甚至树木，岩石，任何其他风景......）。所以我很喜欢渲染到天空盒的技术，当我到达这座桥时，我就是这样过桥的；我会确保对所有模型都使用 LOD，我只是不会渲染这样的距离。

顺便说一句，我更多地是按照 Oblivion 游戏的思路思考，所以答案可能取决于游戏类型。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-06-18T16:25:52.230

我认为这就是您正在寻找[的细节级别 (LOD)](http://en.wikipedia.org/wiki/Level_of_detail_(programming))

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-06-18T17:43:34.070

一些技术，包括你提到的那些：

*   详细程度。上面概述。
*   贴图。对于纹理。
*   视野。通过选择适当的缩放级别来限制您的相机可以“看到”多少东西。另请参见视锥体剔除。
*   远裁剪平面。遥远地方的遮挡：大多数游戏都使用雾、山脉或其他一些借口来严格限制你能看到多远。这可以使用八叉树或其他一些此类技术来实现。这可能基于整个对象、多边形或其他任何东西，并且通常设置在上述山脉的后面。
*   Arenas/levels/areas/whatever - 大多数游戏再次人为地限制你一次只能在一个竞技场上玩；好处是显而易见的（你可以忽略所有其他领域的对象）
*   预渲染——这就是你上面的建议。对于远处的静态场景，在“典型”视图中渲染场景并使其成为背景上的纹理，或者将其用于天空盒/反射贴图/等。

这个想法是在用户开始注意到之前丢弃尽可能多的细节。

有许多预先存在的工具包可以自动完成这些事情，但它们往往要花钱。如果您正在寻找一个严肃的应用程序，我建议至少研究它们包含的解决方案。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-06-18T16:28:04.677

对于 3d 模型，该技术称为[细节层次](http://en.wikipedia.org/wiki/Level_of_detail_(programming))。从本质上讲，多个版本的模型可以根据上下文保持正确的使用。它不仅仅用于距离，它还可以用于在其他情况下保持帧率。

不过要小心，您应该启用 mipmapping，否则您会在较低分辨率模型上的较大纹理上闪闪发光，并且要小心动画。在动画骨架下切换模型很棘手，因此一种技术是即使在对模型进行 LOD 处理时也保持相同的骨架。

地形和对象模型都有动态 LOD 系统，但这些系统可能会占用大量 CPU。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-18T16:25:16.097

一种技术是 LOD（细节层次）。物体离相机越远，绘制的三角形就越少。这是一个链接： http: [//www.stefan-krause.com/](https://web.archive.org/web/20100721235559/https://www.stefan-krause.com/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-18T16:45:47.040

您可以为远处的物体渲染纹理，但是每次透视变化超过某个阈值时，您都必须重新渲染纹理。它适用于远景不会改变的远距离物体，就像您在远处的山脉示例一样，但是如果视图源移动得太快或您离得太近，那么您将获得类似于鱼眼的效果地震中天空渲染的早期。这种系统将它自己借给了像eve online这样的包含遥远距离的世界。

当然，这只是你武器库中的另一个技巧，在某种程度上你仍然需要 LOD。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-18T16:54:41.513

模型的低细节版本特别适用于车辆和物体 地形真的很棘手。我从事过战区类游戏和 PC 飞行模拟器的工作。一点雾有助于掩盖细节之间的“流行”。

在较低的细节处，纹理映射通常被一些单色多边形所取代。

* * *

“另一种更明显的技术是存储非常粗糙的 3D 模型，但是 3D 渲染系统如何专门选择渲染建筑物的粗糙模型而不是其他不太重要（并且可能无法从中查看）的粗糙模型-距离）对象？你会如何将这样的东西与你的高度图一起存储？

您可以对地形进行网格化并保留每个网格单元中可见对象的列表。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-06-18T17:54:13.117

处理地形的一种方法是使用多分辨率图块。就像 Virtual Earth 和 Google Maps 的做法一样，它们以递归方式将世界划分为瓦片。因此，0 级有 4 个图块，1 级有 16 个图块，等等……然后，使用一些 LoD 算法来确定缩放/比例，您将为给定区域加载适当的地形图块。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-07-16T21:41:55.837

动态缓存远处对象的预渲染视图的技术通常称为“冒名顶替者”。[这是](http://home.comcast.net/~tom_forsyth/papers/gem_imp_filt.html)一本关于该主题的旧 Game Programming Gems 书中的文章。

有许多技术可以处理高度图地形的细节层次。查看 vterrain.org 以了解一些常用技术的概述。在大多数变体中，一般原则是相同的——将地形分成多个部分，并在远处使用较低分辨率的几何体和纹理——但细节会有所不同。

为了减少提交给显卡的对象数量，通常会实施某种可见性剔除。在最简单的情况下，这可能只是完全丢弃边界球覆盖的屏幕像素小于某个阈值的模型（如果您有 LOD 系统，则在选择要使用的 LOD 时无论如何都会计算这一点）。为了提高效率，可以使用某种分层空间数据结构进行剔除 - 四叉树或八叉树、球体树、门户系统（通常不常用于室外环境）、简单的基于网格的方案等。基本思想是节省工作量通过剔除层次结构中的更高级别节点，从而避免查看许多叶节点。

对于像遗忘这样的游戏，他们可能还在进行某种遮挡剔除——根据确定对象隐藏在其他对象后面，在将对象提交给图形硬件之前对其进行剔除。有多种技术可以做到这一点，其中一些可能非常复杂。

# winapi - 带有 MOVEFILE_DELAY_UNTIL_REBOOT 的 MoveFileEx 删除而不是移动

> ID：1013689
> 
> 赞同：4
> 
> 时间：2009-06-18T16:23:21.357
> 
> 标签：winapi, movefileex

我有一个自动更新系统，可以在重新启动时替换我现有的程序文件。（可以说，这是一个非常复杂的程序，包含许多驱动程序、服务和用户级模块。真的没有其他办法。相信我。）

函数 MoveFileEx 与 MOVEFILE_DELAY_UNTIL_REBOOT 一起使用来设置此文件替换。我发现它正常工作。但是，如果源文件和目标文件位于不同的驱动器上，则会删除目标文件但不会移动源文件。结果是当用户在不同于系统分区的驱动器上安装软件时，更新会删除产品文件而不是更新它们。

现在，我在 MoveFileEx 的文档中看到 MOVEFILE_COPY_ALLOWED 应该在将文件从一个卷移动到另一个卷时使用。但它也表示该标志不能与 MOVEFILE_DELAY_UNTIL_REBOOT 一起使用。

问：当源和目标不在同一个卷上时，如何在重新启动时移动文件，覆盖现有文件？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-18T16:30:33.240

为什么不直接将文件复制到用户安装程序的驱动器？

据我所知，仅依靠此功能没有直接的方法可以做您想做的事情。

在同一个驱动器上查找可写位置在 Vista 上可能是个问题，但您提到您有服务 - 如果它们以 LocalSystem 特权运行，则让它们写入新文件。

我使用的另一种简单的更新机制（虽然不适用于驱动程序）是拥有专用的更新程序 - 杀死/结束所有内容，让更新程序完成它的工作并重新启动所有内容。

# windows-mobile - 如何将 3G USB 加密狗与 Windows Mobile 6 模拟器连接？

> ID：1013692
> 
> 赞同：1
> 
> 时间：2009-06-18T16:23:43.523
> 
> 标签：windows-mobile, serial-port, emulation, gprs

我有一个真正的 3G USB 加密狗，它显示了几个串行端口。我想将 Windows Mobile 模拟器串行端口的串行端口之一映射到真实设备，以测试自定义 RIL 实现。

首先，这种情况可能吗？

我试图`HKEY_LOCAL_MACHINE\Software\Microsoft\RIL\ComPort`在 WM 模拟器上进行修改，以设置 COM1。我还尝试将模拟器串行端口映射到真实设备。

使用串口监视器，我看到的只是串口是如何打开的，没有数据传输。显示器上的 RTS 和 DTR 灯“亮”。会不会是串口的配置问题？有谁知道 Windows Mobile 模拟器串口的配置？

谢谢大家！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-21T06:37:41.887

您可以将两个仿真器端口映射到两个真实的串行端口。[有关详细信息](http://www.devx.com/wireless/Article/38500)，请参阅本文。这些端口将显示为标准串行端口。如果您的加密狗提供了一些额外的功能，它将不可用。

# drupal - 登录后，重定向到入口网址？

> ID：1013697
> 
> 赞同：3
> 
> 时间：2009-06-18T16:24:31.840
> 
> 标签：drupal

我正在处理的网站正在使用 Frontpage 模块将匿名用户重定向到登录页面。而且我知道使用触发器来设置登录后重定向的操作（设置为一个特定的 url）。但这里有一个问题：

我的用户每个都到达不同的入口网址，例如：www.mysite/PersonsName

登录后有没有办法重定向回入口网址？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-19T07:38:27.303

无需编码：这是由现有的[login_destination](http://drupal.org/project/login_destination)模块执行的，具有各种可用的设置。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-19T21:40:58.297

您可以将此代码放在实现 hook_user() 的自定义模块中。

```
function yourmodule_user($op, &$edit, &$account, $category = null)
{
  switch ($op) {
    case 'login':
      $_REQUEST['destination'] = $_REQUEST['q'];
    break;
  }
} 
```

通常将 $_REQUEST['destination'] 设置为您想要的目标页面就足够了（我猜这就是模块 login_destination 所做的）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-18T16:31:56.797

您可以使用 URL 并按“/”展开，如下所示：

```
$url =  explode("/",$_SERVER['REQUEST_URI']); 
```

然后，设置一个会话来保留他访问的用户名，如下所示：

```
$_SESSION['used_name'] = $url[0]; 
```

您可以设置他在成功登录后被重定向到的页面，如下所示：

```
$success_page = "yourpage/".$_SESSION['used_name']; 
```

我希望这就是你要找的。

# xml - 使用 xslt 提取文本

> ID：1013698
> 
> 赞同：0
> 
> 时间：2009-06-18T16:25:05.583
> 
> 标签：xml, xslt

我的 xml 元素之一是图像和

当我这样做时，`<xsl:value-of select="MyImage" />`它会将其作为数据输出

```
<img alt="" border=0 src="/PublishingImage/myPic.jpg" style="border:0px solid"> 
```

使用 xslt 我可以只提取 src 位，以便我有 /PublishingImage/myPic.jpg 没有引号。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-18T16:26:26.427

```
<xsl:value-of select="img/@src" /> 
```

对于 xml 节点内的字符串，试试这个

```
<xsl:value-of select="substring-before(substring-after(MyImage, 'src=&quot;'), '&quot;')" /> 
```

乔什

# sql - 数据库 VIEW 不反映底层 TABLE 中的数据

> ID：1013711
> 
> 赞同：13
> 
> 时间：2009-06-18T16:26:21.947
> 
> 标签：sql, sql-server, schema

## 输入：

客户声称，应用程序 (.NET) 在查询某些数据时返回的数据与客户直接查看数据表时不同。

我知道可能有各种原因，并且在完全不同的地方。我的目的不是在这里解决它，而是询问有经验的 DBA 和 DB 开发人员是否：

## 视图是否可以显示与基础表不匹配的数据？

*   **这可能是什么原因/原因？**
*   视图上的 UPDATE 语句是否会导致未来的 SELECT 返回“更新”数据，而表确实没有？

## 可能的原因（带问号的请评论）：

1.  原因是有两个独立的交易，这可以解释客户的困惑。
2.  基础表已更改，但视图未刷新（使用 sp_refreshview）
3.  不同的用户正在连接，并且由于权限而可以看到不同的数据？
4.  程序员错误：错误的表/列，错误的过滤器（这里是一体式的）
5.  发生损坏：DBCC CHECKDB 应该有帮助
6.  会`SELECT ... FOR UPDATE`导致这个**？？？**
7.  ? __

## 真正发生了什么（答案）：

某些表中的列位置已更改：显然，客户将完全数据库访问权限授予顾问以进行数据库使用分析。那位大佬在使用子句时更改了列的顺序，以查看表开头的几个*审计字段。*`SELECT * ...`

使用[dbGhost](http://www.innovartis.co.uk/products/products.aspx)将数据库模式与问题出现前几天的备份模式进行比较，发现列位置差异。

接下来发生的与编程无关，更多的是政治问题。

因此，这`sp_refreshview`是解决方案。我只是多走了一步才能找到问题的根源。谢谢你们。

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2009-06-18T16:34:12.117

是的，有点。

可能的原因：

1.  视图需要刷新或重新编译。当源列定义更改并且视图（或它所依赖的东西）使用“*”时会发生这种情况，这可能很讨厌。调用 sp_RefreshView。也可能由于它调用的视图或函数（数据源）而发生。

2.  视图正在寻找与他们/您的想法不同的东西。他们正在查看错误的表格或视图。

3.  视图正在以一种意想不到的方式转换数据。它工作正常，只是不像他们预期的那样。

4.  视图返回的数据子集与预期不同。再一次，它工作正常，只是不像他们想象的那样。

5.  他们正在查看错误的数据库/服务器或使用登录/用户身份导致视图更改其显示的内容。特别邪恶，因为与 Management Studio 不同，大多数客户端程序不会告诉您它们指向的数据库/服务器。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-06-18T16:30:26.797

如果基础表已更改并且 sp_refreshview 尚未针对视图运行，则有可能，因此如果将这些列添加到表中，视图将缺少列。

要了解我的意思，请阅读[如何使用 sp_refreshview 确保视图将具有基础表更改](http://blogs.lessthandot.com/index.php/DataMgmt/DataDesign/how-to-make-sure-that-the-view-will-have)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-06-18T17:36:59.633

您可以创建带有锁定提示的视图，这意味着您可能会收到脏读。或者，当他们直接访问表时，他们可能正在使用锁定提示，这可能会给他们带来脏读。

用户似乎不理解的另一种可能性是数据是流动的。您在 3:00 在视图中读取的数据可能与您在 3:30 直接查看表格时看到的数据不同，因为在此期间发生了变化。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-06-18T16:35:50.290

几种可能性：

*   您的 .NET 应用程序可能没有指向您或他们认为它指向的位置。例如，它被错误地指向了一个测试服务器

*   如果视图在浮点数或数值上具有索引，则由于舍入，该值可能与基础查询不同

*   ANSI_NULLS 设置特定于创建时的视图。如果它与基础表上的选择期间的设置不同，则可能会导致某些类型的查询出现差异

*   底层表结构已更改，视图未刷新（尤其是使用“SELECT *”时会出现问题）

如果我想到其他任何人，我会编辑这篇文章。

编辑：这是 ANSI_NULLS 设置如何摆脱结果的示例：

```
SET ANSI_NULLS ON

DECLARE
     @i     INT,
     @j     INT

SET @i = NULL
SET @j = 1

SELECT
     CASE WHEN @i <> @j THEN 'Not Equal' ELSE 'Equal' END

SET ANSI_NULLS OFF

SELECT
     CASE WHEN @i <> @j THEN 'Not Equal' ELSE 'Equal' END 
```

您应该收到的结果是：

```
Equal

Not Equal 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-18T16:43:49.413

假设视图实际上并没有*转换*数据，从技术上讲，如果发生损坏是可能的。视图从一个索引检索数据，“表”从另一个索引（即从集群）检索数据，两者不同步。DBCC CHECKDB 应该可以揭示问题。

但是人为错误的可能性更大，即。他们正在查看与视图不同的表或不同的记录。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-18T16:31:47.810

当然还有其他事情：

```
1) Derived attributes are pulling from wrong tables in the view
2) The view is using incorrect tables
3) incorrect or missing joins in the view 
```

仅举几例

# java - 没有 Netscape 或 IE 的 Java 和 Javascript 之间的通信？

> ID：1013720
> 
> 赞同：0
> 
> 时间：2009-06-18T16:28:20.747
> 
> 标签：java, javascript

在我工作的实验室中，我们使用 Mozilla 1.7 for Sun Java™ Desktop System 和 Firefox 2.0.0.4。我的目标是修改现有的 Java 应用程序（通过可执行 jar 运行）以与我们基于 Web 的登录系统进行通信。

我对同时使用 Java Applet 和 JavaScript 来完成这项任务的想法持开放态度，但除了 Netscape Navigator 和 Internet Explorer 之外，我还没有找到将这两种技术集成到任何浏览器中的方法。

有没有办法使用上述两种浏览器中的任何一种来做到这一点？

更具体的示例：
1\. 启动应用程序
2\. 单击“登录”按钮
3\. 提示输入密码
4\. 在后台，让应用程序连接到基于 Web 的登录服务器，输入用户名（应用程序知道) 和密码，导航到时钟部分并“单击”Punch In 按钮
5\. 拉取登录的时间戳（通常显示在浏览器上）并显示在应用程序中

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-18T17:29:35.870

Look at HTTPURLConnection and [perform POST](http://www.devx.com/tips/Tip/18188) of the same values login form contains to the same URL.

# perl - 如何将 NTLM 身份验证与 Perl 的 SOAP::Lite 模块集成？

> ID：1013721
> 
> 赞同：4
> 
> 时间：2009-06-18T16:28:33.990
> 
> 标签：perl, soap, ntlm

此 Perl 代码适用于对 ASP.NET Web 服务的匿名访问，但是当集成安全性打开时，该服务会返回 401 错误。我认为我需要将 NTLM 模块与 SOAP::Lite 结合使用，但不清楚如何这样做。这些组件如何集成？

```
use SOAP::Lite;
use strict;

my $proxy = "http://localhost:28606/WebService.asmx";

my $method_name = "HelloWorld";
my $uri = "http://tempuri.org/";
my $methodAction = $uri . $method_name;

my $soap = SOAP::Lite
    ->uri( $uri )
    ->proxy( $proxy )
    ->on_action(sub{ $methodAction; });

my $method = SOAP::Data->name($method_name)->attr({xmlns=>$uri});
my $result = $soap->call($method);

print $result->result(); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-18T18:58:25.507

如果你这样做，你可以获得 SOAP::Lite 来打印一些调试输出：

```
use SOAP::Lite +trace; 
```

代替

```
use SOAP::Lite; 
```

编辑：

好的，我想我现在明白了。打开集成安全功能使 IIS 需要 NTLM 身份验证。[perlmonks.org](http://www.perlmonks.org/?node_id=719995)上有一个主题似乎揭示了答案。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-12-27T11:05:05.133

我有点晚了，但我刚刚遇到了同样的问题。尝试这个：

```
use LWP::UserAgent;
use LWP::Debug;
use SOAP::Lite on_action => sub { "$_[0]$_[1]"; };
import SOAP::Data 'name', 'value';
our $sp_endpoint = 'http://sp.example.com/sites/mysite/_vti_bin/lists.asmx';
our $sp_domain = 'sp.example.com:80';
our $sp_username = 'DOMAIN\username';
our $sp_password = 'xyz';

if ($debug) {
    LWP::Debug::level('+');
    SOAP::Lite->import(+trace => 'all');
}

my @ua_args = (keep_alive => 1);
my @credentials = ($sp_domain, "", $sp_usernam, $sp_password);
my $schema_ua = LWP::UserAgent->new(@ua_args);
$schema_ua->credentials(@credentials);
$soap = SOAP::Lite->proxy($sp_endpoint, @ua_args, credentials => \@credentials);
$soap->schema->useragent($schema_ua);
$soap->uri("http://schemas.microsoft.com/sharepoint/soap/"); 
```

# image - 我应该为动态创建的条形码使用什么图像格式

> ID：1013729
> 
> 赞同：4
> 
> 时间：2009-06-18T16:30:43.723
> 
> 标签：image, barcode, image-formats

我正在动态创建条形码，并将它们嵌入网页中。我应该使用什么格式？我在JPG和PNG之间摇摆不定，我不太了解两者的优点。尺寸在这方面很重要，可读性也很重要（清晰的条码比模糊的条码更好）。还有其他更好的格式吗？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-06-18T16:33:30.120

PNG，甚至是 GIF。Jpeg 是正确的，因为它是为照片的平滑渐变设计的，而不是条形码的锐利边缘。在 MS Paint 中手动绘制一个简单的条码，保存，然后重新加载，您会看到各种压缩伪影。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-06-18T16:33:48.090

绝对是PNG。它在存储矢量图形方面要好得多，例如条形码（而不是照片）。

[Wikipedia对 JPG 与 PNG 进行](http://en.wikipedia.org/wiki/Portable_Network_Graphics#Comparison_with_JPEG)了很好的比较。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-06-18T16:33:33.427

PNG*应该*比 JPG 更好（JPG 是有损的）。GIF 可能会更好，因为图像将是单色的（但在您的情况下检查它）。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-06-18T16:42:42.097

PNG 是 PNG 和 JPG 之间的更好选择。这里的主要问题是压缩——图像中有两种形式的压缩技术，有损和无损。有损压缩算法（例如 JPG 文件使用的算法）在压缩->解压缩循环期间“丢失”信息。因此，您的图像中会出现伪影。另一方面，PNG 使用无损压缩，因此显示的图像将与初始保存之前的原始未压缩图像完全相同。

在条形码的情况下，黑色/白色的逐个像素的精确位置非常重要（这就是重点），因此使用像 JPG 这样的有损压缩程序可能会非常糟糕。如果您使用的是二维条码，情况会更糟，您的扫描仪可能很难准确读取条码。PNG 将彻底消除这个问题。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-18T16:47:10.737

我已成功使用 .gif 和 .png。我对[这个问题的](https://stackoverflow.com/questions/240948/web-pages-and-barcode-fonts)[回答](https://stackoverflow.com/questions/240948/web-pages-and-barcode-fonts/241468#241468)（以及其他答案，公平地说）有更多细节。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-06-18T16:53:29.407

一路PNG。它不仅可以避免您使用 JPG 获得的压缩伪影，而且几乎可以肯定会产生更好的压缩效果。JPG 非常不适合边缘锐利的图像。

# asp.net - 在 .net 中模拟 Excel Web 查询

> ID：1013730
> 
> 赞同：1
> 
> 时间：2009-06-18T16:30:44.800
> 
> 标签：asp.net, vb.net, excel

我需要在 .net 中模拟 Excel Web 查询 下面是示例代码。当我尝试在 .net 中执行此操作时出现 Error500，但在 Excel 中它可以正常工作。关于我做错了什么的任何想法？当我将 URI 更改为普通网站时，它可以正常工作，并从页面返回 html，这正是我所追求的。我想知道问题是否出在我试图返回数据表的事实

```
 Dim oHttpWebRequest As System.Net.HttpWebRequest
    Dim oStream As System.IO.Stream
    Dim sChunk As String
    oHttpWebRequest = (System.Net.HttpWebRequest.Create("http://somesite/foo.jsp"))
    Dim oHttpWebResponse As System.Net.WebResponse = oHttpWebRequest.GetResponse()
    oStream = oHttpWebResponse.GetResponseStream
    sChunk = New System.IO.StreamReader(oStream).ReadToEnd()
    oStream.Close()
    oHttpWebResponse.Close() 
```

这是来自 Excel 的查询

```
WEB
1
http:/somesite/foo.jsp

Selection=DataTable
Formatting=None
PreFormattedTextToColumns=True
ConsecutiveDelimitersAsOne=True
SingleBlockTextImport=False
DisableDateRecognition=False
DisableRedirections=False 
```

**编辑** 当我从服务器获取响应时出现错误

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-18T17:45:26.453

我发现了我遇到的问题。

我使用 fiddler 找出通过 excel 发送的标头，并将这些标头与 .net 发送的标头进行比较 [http://www.fiddler2.com/Fiddler2/version.asp](http://www.fiddler2.com/Fiddler2/version.asp)

我必须添加以下代码行来添加这两个标题才能使其工作

```
oHttpWebRequest.Headers.Add(HttpRequestHeader.Pragma, "no-cache")
oHttpWebRequest.Headers.Add(HttpRequestHeader.AcceptLanguage, "en-us") 
```

# unit-testing - 如何从基于 XCode 的单元测试中跟踪“内存不足”错误

> ID：1013732
> 
> 赞同：0
> 
> 时间：2009-06-18T16:31:00.073
> 
> 标签：unit-testing, xcode, memory

我正在将 XCode 3.0 与 iPhone SDK 一起使用，并且有一个包含 sqlite 单元测试的小型 iPhone 应用程序，但是当我运行它时出现“内存不足”。如何追踪错误的根本原因？谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-18T17:56:25.983

试试模拟器，你可以在你的电脑上运行应用程序。或者，如果您的手机已越狱，请安装 GRIP（Growl for iPhone）。它有一个内置的内存观察器，当你的内存变低时它会告诉你。它可以准确地告诉您应用程序何时耗尽内存。

# javascript - 让我的 jQuery 代码远离 html 文件

> ID：1013742
> 
> 赞同：3
> 
> 时间：2009-06-18T16:32:16.283
> 
> 标签：javascript, jquery

我正在学习 jQuery 并创建了几个插件。不幸的是，由于我公司的编码实践，他们希望将所有 javascript 代码提取到 js 文件中。这对我来说提出了两个挑战：

1.  我可以提取对 js 文件的实际 $(document).ready(..) 调用吗？到目前为止，以我有限的知识，我还没有想到这是否可能。如果没有，我欢迎任何建议，以使这种更清洁、更容易接受的方式包含此代码。
2.  每个 asp.net 页面标题都有太多的 javascript 包含，因为我可能使用了多个插件。有没有办法减少每次需要这些文件时可能需要进行的昂贵的服务器访问？

任何建议，更正非常感谢

谢谢

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-06-18T16:34:17.077

`1.`绝对地。

只需将脚本引用添加到您的 html 中，如下所示：

```
<script type='text/javascript' src='js/yourfile.js'></script> 
```

然后只需启动您的 .js 文件

```
jQuery(function() {
  foo;
  ...
  bar;
}); 
```

或任何其他启动 jQuery 代码块的快捷方式。

`2.`在将脚本发送给用户之前，您应该通过[Minify之类的工具运行您的脚本。](http://code.google.com/p/minify/)这将合并文件并将它们很好地打包，以便它们占用更少的空间。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-18T16:45:35.183

在外部 javascript 文件中使用 $(document).ready () 很好 - 它的工作原理完全相同:) 事实上 - 它不仅可以工作，而且是一种很好的做法，因为它有助于将内容 (HTML) 与行为（Javascript）。

针对您的部分问题 - 您可以将所有插件组合成一个 javascript 文件并链接到 <head> 中的那个文件。您也可以尝试缩小脚本，尽管在网站上线之前这通常有点矫枉过正。

当我使用 jQuery 时，我通常使用这种结构：

```
<html>
  <head>
    <!-- html tags such as title, link, meta etc -->
    <script type="text/javascript" src="/path/to/jquery.js"></script>
    <script type="text/javascript" src="/path/to/plugin.js"></script>
    <!-- more plugins included if required -->
  </head>
  <body>
    <!-- html here -->

    <!-- script is the last thing before the ending body tag (increases performance) -->
    <script type="text/javascript" src="/path/to/your_jQuery_code.js"></script>
  </body>
</html> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-18T16:36:00.553

我认为担心 javascript 包含的服务器旅行是过早的优化。您是否有任何证据表明这些页面加载缓慢？浏览器应该缓存 javascript 文件。

如果您确实有证据表明这是一个问题，您可以

- 将 jquery 代码和任何插件合并到一个文件
中 - 编写一个 .net 内容处理程序来为您执行此操作（可能有点矫枉过正）

然后，您可以为每个页面添加一个自定义 js 文件来处理特定于页面的属性。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-18T16:37:46.857

您绝对可以将您`document.ready`和所有其他 JavaScript 代码放在外部文件中。

通常我有 2 个调用 - 一个用于 jQuery 本身，一个用于组合和缩小我所有单个文件的缩小的 global.js 文件。

就个人而言，我喜欢为此使用[前端搅拌器](http://github.com/front-end/front-end-blender/tree/master)，但也有许多其他选项可用。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-18T16:43:34.450

`document.ready`将调用放在外部文件中没有任何问题。事实上，这是我将我的 js 与我的 html 分开的方法。如果您担心某些页面上运行的某些功能，您可以使用

```
var path = window.location.pathname;
if (path == "/yourdir/yourpage.html") {
    //do something for this page only
} 
```

或者您可以仅在某些页面上包含某些文件。

# wpf - wpf密码框插入符号

> ID：1013745
> 
> 赞同：1
> 
> 时间：2009-06-18T16:32:43.567
> 
> 标签：wpf, caret, passwordbox, virtual-keyboard

如何使用 WPF 将密码框控件与虚拟键盘一起使用？使用文本框控件，只需将插入符号移动到下一个文本位置就相当简单了；密码框不是这样，它不会暴露插入符号的位置。

我应该自己推导出来吗？好像是弱酱。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-03-20T12:56:52.710

您可以尝试这样的事情来设置 PasswordBox 中的选择：

```
private void SetSelection(PasswordBox passwordBox, int start, int length) { 
    passwordBox.GetType().GetMethod("Select", BindingFlags.Instance | BindingFlags.NonPublic)
                         .Invoke(passwordBox, new object[] { start, length }); 
} 
```

之后，像这样调用它来设置光标位置：

```
// set the cursor position to 2... or length of the password 
SetSelection( passwordBox1, 2, 0); 

// focus the control to update the selection 
passwordBox1.Focus(); 
```

上述答案由[Andrew Jackson](https://stackoverflow.com/a/1046920/162671)提供，效果很好。

# regex - Powershell：如果正则表达式不匹配，请不要理会项目

> ID：1013748
> 
> 赞同：1
> 
> 时间：2009-06-18T16:33:12.240
> 
> 标签：regex, powershell

我有一个 pdf 文件列表（来自日常处理），有些带有各种格式的日期戳，有些没有。

例子：

```
$f = @("testLtr06-09-02.pdf", "otherletter.pdf","WelcomeLtr043009.pdf") 
```

我试图通过删除破折号来删除日期戳，然后用字符串“DATESTAMP”替换任何连续的数字组（4 个或更多，我可以将其更改为 6）。

到目前为止，我有这个：

```
$d =  $f | foreach {$_ -replace "-", ""} | foreach { $_ -replace ([regex]::Matches($_ , "\d{4,}")), "DATESTAMP"}
echo $d 
```

输出：

```
testLtrDATESTAMP.pdf
DATESTAMPoDATESTAMPtDATESTAMPhDATESTAMPeDATESTAMPrDATESTAMPlDATESTAMPeDATESTAMPtDATESTAMPtDATESTAMPeDATESTAMPrDATESTAMP.DATESTAMPpDATESTAMPdDATESTAMPfDATESTAMP
WelcomeLtrDATESTAMP.pdf 
```

如果文件有日期戳，它工作正常，但它似乎吓坏了 -replace 并在每个字符后插入 DATESTAMP。有没有办法解决这个问题？我试图将其更改为 foreach 循环，但我无法弄清楚如何从正则表达式中获取真/假。

提前致谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-19T08:35:00.123

你可以简单地做：

```
PS > $f -replace "(\d{2}-){2}\d{2}|\d{4,}","DATESTAMP"
testLtrDATESTAMP.pdf
otherletter.pdf
WelcomeLtrDATESTAMP.pdf 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-18T16:50:17.333

```
$_ -replace ([regex]::Matches($_ , "\d{4,}")), "DATESTAMP" 
```

`([regex]::Matches($_ , "\d{4,}"))`$_ 中的意思是用替换每一个发现`"DATESTAMP"`。

与没有时间戳（或至少 4 个连续数字）的文件名一样，没有匹配项，它返回`""`（一个空字符串）。

因此，每个空字符串都被替换为`DATESTAMP`. 这样一个空字符串`""`位于字符串的开头和每个其他字符之后。

这就是为什么你会得到这个长字符串，每个字符都被 DATESTAMP 包围。

* * *

要检查您的字符串中是否存在 a `\d{4,}`，您应该能够使用

```
[regex]::IsMatch($_, "\d{4,}") 
```

* * *

我不是 Powershell 用户，但仅此一行就可以完成这项工作。但是我不确定是否能够在管道中使用 if 以及是否需要分配和 echo $d

```
$f | foreach-object {$_ -replace "-", ""} | foreach-object {if ($_ -match "\d{4,}") { $_ -replace "\d{4,}", "DATESTAMP"} else { $_ }} 
```

# asp.net - ASP.Net SessionID 不断丢失

> ID：1013749
> 
> 赞同：0
> 
> 时间：2009-06-18T16:33:14.097
> 
> 标签：asp.net, sessionid

我的 asp.net 应用程序在从自己的浏览器启动时工作正常，但是当它使用 window.open 从另一个 Web 应用程序（sharepoint webpart）启动时，它一直工作，直到用户单击并回发，然后会话丢失。

我认为它与 cookie 有关，因为当我将会话状态设置为无 cookie 时，一切正常。

使用 window.open 启动应用程序时，为什么 sesssionid 在 NEW 应用程序中丢失？我希望每个应用程序都有自己的会话 cookie，我尝试设置 cookie 的名称，但同样的事情发生了，在第一次回发时 sessionid 丢失了？

请帮忙？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-19T15:53:14.630

删除 window.open()。使用 tarket="blank" 的链接。如果您需要从 JS 调用它们，只需执行 link.click() 即可。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-18T16:39:24.750

Sharepoint 管理它自己的会话。会话与应用程序 (URI) 相关联。您需要在应用程序之间共享某种登录令牌。

查看：

[http://forums.asp.net/t/1335229.aspx](http://forums.asp.net/t/1335229.aspx)

[http://forums.asp.net/p/1356006/2781938.aspx](http://forums.asp.net/p/1356006/2781938.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-18T16:41:20.130

你使用的是什么浏览器？

IE6 有这个确切的问题，也可能是较新的版本。

[请参阅 Microsoft 支持](http://support.microsoft.com/kb/831678)

# wpf - 在基于 ListView 的多列树视图中自动调整模板列的大小

> ID：1013756
> 
> 赞同：0
> 
> 时间：2009-06-18T16:33:51.010
> 
> 标签：wpf, listview, treeview, autosize

我正在使用我在这里找到的多列树视图控件[http://www.codeproject.com/KB/WPF/wpf_treelistview_control.aspx](http://www.codeproject.com/KB/WPF/wpf_treelistview_control.aspx)

此控件中包含模拟树视图控件的第一列需要在展开/折叠节点时自动调整大小。

有什么帮助吗？

示例 XAML

```
<UserControl x:Class="ListViewAsTreeView.XmlTree"
xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
xmlns:local="clr-namespace:ListViewAsTreeView"    
xmlns:tree="clr-namespace:Aga.Controls.Tree;assembly=Aga.Controls">

<UserControl.Resources>        
    <local:RegImageConverter x:Key="RegImageConverter"/>
    <local:ComboList x:Key="MyComboSource"/>        
</UserControl.Resources>

<StackPanel>
    <tree:TreeList Name="_tree" local:DragAndDrop.DropEnabled="true"
                   MinHeight="40"
                   IsSynchronizedWithCurrentItem="True">
        <tree:TreeList.View>
            <GridView>
                <GridView.Columns>
                    <GridViewColumn Header="Name">                     
                        <GridViewColumn.CellTemplate>                  
                            <DataTemplate>
                                <StackPanel 
                                    Orientation="Horizontal">
                                    <tree:RowExpander/>
                                    <Image
                                        Source="{Binding 
                                        Converter={StaticResource RegImageConverter}}"  Margin="0, 0, 5, 0"/>
                                    <TextBlock
                                        Text="{Binding Name}">                                    
                                    </TextBlock>
                                </StackPanel>
                            </DataTemplate>
                        </GridViewColumn.CellTemplate>
                    </GridViewColumn>

                    <GridViewColumn Header="Type" Width="Auto" 
                                    DisplayMemberBinding="{Binding Kind, UpdateSourceTrigger=PropertyChanged}"/>
                    <GridViewColumn Header="Data" Width="Auto" 
                                    DisplayMemberBinding="{Binding Data, UpdateSourceTrigger=PropertyChanged}"/>
                    <GridViewColumn Header="ComboSample" Width="Auto">
                        <GridViewColumn.CellTemplate>
                            <DataTemplate>
                                <ComboBox Name="MyComboBox" ItemsSource="{StaticResource MyComboSource}" 
                                          IsEditable="True" IsEnabled="True" 
                                          Text="{Binding Name}">
                                </ComboBox>
                            </DataTemplate>
                        </GridViewColumn.CellTemplate>
                    </GridViewColumn>
                </GridView.Columns>
            </GridView>
        </tree:TreeList.View>
    </tree:TreeList>

    <ListBox local:DragAndDrop.DragEnabled="true">
        <ListBoxItem>Item 1</ListBoxItem>
        <ListBoxItem>Item 2</ListBoxItem>
        <ListBoxItem>Item 3</ListBoxItem>
    </ListBox>
</StackPanel> 
```

谢谢， 吉图

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-03-28T08:38:35.300

```
 Output : 
       Parent         Col1    Col2    Col3  
       |
       |____ Child    Data1   Data2  Data3
       |
       |____ Child2   Data1    Data2  Data3 
```

[http://www.go-mono.com/mono-downloads/download.html](http://www.go-mono.com/mono-downloads/download.html) .. 为您的操作系统下载 Gtksharp 并在 Visual Studio atk-sharp.dll 、 gdk-sharp.dll 、 glib- 中添加这些 dll 的引用sharp.dll ， gtk-sharp.dll 并使用 Gtk；...你将获得 TreeView

```
public class TreeViewExample
      {
public static void Main()
{
    Gtk.Application.Init();
    new TreeViewExample();
    Gtk.Application.Run();
}

public TreeViewExample()
{
    Gtk.Window window = new Gtk.Window("TreeView Example");
    window.SetSizeRequest(500, 200);

    Gtk.TreeView tree = new Gtk.TreeView();
    window.Add(tree);

    Gtk.TreeViewColumn Parent = new Gtk.TreeViewColumn();
    Parent.Title = "Parent";
    Gtk.CellRendererText Parent1 = new Gtk.CellRendererText();
    Parent.PackStart(Parent1, true);

    Gtk.TreeViewColumn ChildColoumn1 = new Gtk.TreeViewColumn();
    ChildColoumn1.Title = "Column 1";           
    Gtk.CellRendererText Child1 = new Gtk.CellRendererText();
    ChildColoumn1.PackStart(Child1, true);

    Gtk.TreeViewColumn ChildColumn2 = new Gtk.TreeViewColumn();
     ChildColumn2.Title = "Column 2";
    Gtk.CellRendererText Child2 = new Gtk.CellRendererText();
    ChildColumn2.PackStart(Child2, true);

    tree.AppendColumn(Parent);
    tree.AppendColumn(ChildColoumn1);
    tree.AppendColumn(ChildColumn2);

    Parent.AddAttribute(Parent1, "text", 0);
    ChildColoumn1.AddAttribute(Child1, "text", 1);
    ChildColumn2.AddAttribute(Child2, "text", 2);

    Gtk.TreeStore Tree = new Gtk.TreeStore(typeof(string), typeof(string), typeof(string));
    Gtk.TreeIter iter = Tree.AppendValues("Parent1");
    Tree.AppendValues(iter, "Child1", "Node 1");

    iter = Tree.AppendValues("Parent2");
    Tree.AppendValues(iter, "Child1", "Node 1","Node 2");          

    tree.Model = Tree;
    window.ShowAll();
}
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-08-28T00:49:51.767

尝试定义一个单独的 DataGrid 并使用包含最长列值的项目进行填充。然后将Aga.Controls Treeview 的列宽DataBind 到DataGrid 的相应列宽。这样，TreeView 控件的列宽设置为最长的列项。您始终可以通过将不透明度设置为零来隐藏 DataGrid。

例如：假设 DataGrid 名称是“TestDataGrid”并且它有一个名为“dgNameColumn”的列

```
<GridViewColumn Header="Name" **Width="{Binding ElementName=dgNameColumn, Path=ActualWidth}"**>                     
                    <GridViewColumn.CellTemplate>                  
                        <DataTemplate>
                            <StackPanel 
                                Orientation="Horizontal">
                                <tree:RowExpander/>
                                <Image
                                    Source="{Binding 
                                    Converter={StaticResource RegImageConverter}}"  Margin="0, 0, 5, 0"/>
                                <TextBlock
                                    Text="{Binding Name}">                                    
                                </TextBlock>
                            </StackPanel>
                        </DataTemplate>
                    </GridViewColumn.CellTemplate>
                </GridViewColumn> 
```

希望这可以帮助。

# c# - 如何确定字符串是否具有正则表达式元字符？（C＃）

> ID：1013760
> 
> 赞同：1
> 
> 时间：2009-06-18T16:34:52.397
> 
> 标签：c#, regex, string

System.Text.RegularExpressions 命名空间是否为我提供了任何东西来发现输入字符串是否具有 ("abc[0-9]" 或 "^aeiou$") 或没有 ("abc123") 元字符？还是我必须手动检查某个列表中的非转义字符？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-18T16:42:52.690

你至少有三个选择：

1.  使用[Regex.Escape](http://msdn.microsoft.com/en-us/library/system.text.regularexpressions.regex.escape.aspx)并比较结果：

    ```
    private static bool ContainsMetaCharacters(string s)
    {
        if (String.IsNullOrEmpty(s))
        {
            return false;
        }
        string escaped = Regex.Escape(s);
        return !escaped.Equals(s, StringComparison.Ordinal);
    } 
    ```

2.  对每个字符应用[Regex.Escape](http://msdn.microsoft.com/en-us/library/system.text.regularexpressions.regex.escape.aspx)以查看转义值是否不同：

    ```
    private static bool ContainsMetaCharacters(string s)
    {
        if (String.IsNullOrEmpty(s))
        {
            return false;
        }
        for (int i = 0; i < s.Length; i++)
        {
            if (Regex.Escape(s.Substring(i,1))[0] != s[i])
            {
                return true;
            }
        }
        return false;
    } 
    ```

3.  根据元字符不应更改的事实创建自己的：

    ```
    private static readonly char[] _MetaChars = 
        new char[] 
        { '\t', '\n', '\f', '\r', 
          ' ', '#', '$', '(', ')', 
          '*', '+', '.', '?', 
          '[', '\\', '^', '{', '|' };

    private static bool ContainsMetaCharacters(string s)
    {
        if(String.IsNullOrEmpty(s))
        {
            return false;
        }
        return s.IndexOfAny(_MetaChars) >= 0;
    } 
    ```

第三种方法根据您在 Regex 中使用的[RegexOptions](http://msdn.microsoft.com/en-us/library/system.text.regularexpressions.regexoptions.aspx)提供更多控制。例如，如果您永远不会使用 RegexOptions.IgnorePatternWhitespace，您可以将空格作为元字符删除。

# php - 以 JSON 格式缓存数据库数据

> ID：1013761
> 
> 赞同：0
> 
> 时间：2009-06-18T16:35:04.563
> 
> 标签：php, database, json, caching

我正在使用一个框架，每次打开页面时都会从数据库中加载表结构。我正在考虑使用 JSON 文件来缓存这些数据，并在需要时让 PHP 解析它们。它比从数据库加载数据更好吗？还有其他方法可以做类似的事情吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-18T16:39:45.653

`serialize`如果您仅在 PHP 中使用该数据，`unserialize`则会更快。几天前看到[这个问题。](https://stackoverflow.com/questions/1010699/php-object-caching-performance/)

# reporting-services - Reporting Services：两表一和

> ID：1013763
> 
> 赞同：1
> 
> 时间：2009-06-18T16:35:22.943
> 
> 标签：reporting-services, grouping, sum

我的报告如下：

一个表在组页脚提供了带有总和的财务信息（分组称为“StockTable_Shipped”）。该组由布尔值控制（1 = 显示发货数据，0 = 显示接收数据）

第二个表格是已发货数据的差异报告（布尔值为 1），表格底部有一个总和。

我的最终目标是从 table1 where shipping=1 中获取总和，然后从 table2 的方差总和中减去它。

这将放置在报告底部的文本框中。

我理解这听起来是否令人困惑，但我会更乐意提供更多信息。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-18T16:39:45.670

如果我是你，我会创建一个新的计算字段，它将保存所有已发货数据的总和（1），而不仅仅是所有数据的总和（1 和 0）。

之后，它应该像输入从 table2 字段的总和中减去计算字段的表达式一样简单。

# android - 在 ListView 中创建类别？

> ID：1013765
> 
> 赞同：10
> 
> 时间：2009-06-18T16:35:28.700
> 
> 标签：android, listview, categories

如何在任意 ListView 中创建类别，如 Preferences (PreferenceCategory) 中的类别？

我发现`android.R.layout.preference_category`它会呈现灰色的 TextView 但在 java 代码中没有提到它。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-06-18T19:58:25.550

> > 如何在任意 ListView 中创建类别，如 Preferences (PreferenceCategory) 中的类别？我发现 android.R.layout.preference_category 呈现灰色 TextView 但在 java 代码的任何地方都没有提到它。
> 
> [http://jsharkey.org/blog/2008/08/18/separating-lists-with-headers-in-android-09/](http://jsharkey.org/blog/2008/08/18/separating-lists-with-headers-in-android-09/)
> 
> 请注意，代码来自 Android 0.9，可能需要稍作修改才能在 Android 1.5 中运行。
> 
> 我在他的代码上有一个兼容 Android 1.5 的变体：
> 
> [http://commonsware.com/AdvAndroid/](http://commonsware.com/AdvAndroid/)
> 
> （向下滚动，点击 Source Code 链接，查看 ListView/Sections 项目）
> 
> -- Mark Murphy（Commons Guy）[http://commonsware.com](http://commonsware.com) *忙碌的程序员指南 Android 开发*2.0 版可用！

谢谢，马克！

# asp.net - ASP.NET Web 应用程序不能使用多个模拟进行身份验证

> ID：1013766
> 
> 赞同：1
> 
> 时间：2009-06-18T16:35:36.407
> 
> 标签：asp.net, sql, security, reporting-services, integrated

我有一个 asp.net 应用程序（使用 windows 身份验证进行访问），它（由安全团队规定）需要使用集成安全性连接到远程 SQL Server 2005。因为它是远程 SQL 服务器，我需要模拟一个自定义帐户（模拟原始呼叫者不起作用）通过：

```
<identity impersonate = "true" userName="domainname\user" password="password" /> 
```

这工作正常。问题是我的应用程序还使用 ReportViewer 控件连接到 SSRS 服务器以满足报告需求。报表服务器位于单独的服务器上，安全团队要求对该服务器的所有调用都必须使用原始窗口的帐户进行审核。看来我唯一的选择是尝试将我的应用程序分成文件夹并在我的 web.config 中使用“位置”标签并使用单独的身份标签。如：

```
 <location path="Reporting">
    <system.web>
      <identity impersonate = "true"/>
    </system.web>
  </location> 
```

注意：没有指定用户名和密码，这意味着它应该模拟原始调用者。

然而，更复杂的是，我的应用是 Masterpage/content page 应用。母版页调用 SQL 来填充菜单等。底线是双重模拟轨道不起作用。我准备好举手宣布这不可能。如果有一种方法可以让应用程序模拟原始调用者，这将满足我的 SSRS 审计需求，同时作为自定义域帐户连接到 SQL 服务器。我不能使用 SQL authentication: not allowed 尽管这样可以解决这个问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-18T16:41:47.977

您是否尝试过以下设置：

1.  将模拟设置为真。这是对应用程序进行身份验证和访问 SSRS 以使用当前登录用户所必需的。

2.  使用一个到 SSRS 的连接字符串，将 Integrated Security 设置为 true，以便模拟用户直接通过。

3.  使用第二个连接字符串，将自定义用户名和密码硬编码到连接字符串中。您可以加密 web.config 的连接字符串部分，使其对人眼不可见，但框架会在创建连接时自动解密。

我有类似的情况（需要特定帐户来检索特定数据，但其他服务功能的一般模拟）并且此设置有效。

编辑：从命令提示符加密 web.config 的一般语法是：

```
aspnet_regiis -pef "connectionStrings" [PhysicalPathToApplication] -prov "DataProtectionConfigurationProvider" 
```

加密是在每台机器的基础上进行的，因此必须在特定的服务器上进行加密。如果需要，您可以获取更多关于此的文档。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-18T16:39:51.723

您应该能够打开和关闭模拟，因此您可以返回使用运行该站点的默认帐户。我必须检查一下，我已经有一段时间没有这样做了。

这看起来像是如何做的开始：

```
System.Security.Principal.WindowsImpersonationContext impersonationContext;
impersonationContext = 
    ((System.Security.Principal.WindowsIdentity)User.Identity).Impersonate();

//Insert your code that runs under the security context of the authenticating user here.

impersonationContext.Undo(); 
```

本质上，您只需为您需要的呼叫模拟适当的用户，然后“撤消”上下文并将其关闭。之后它会回到默认用户。

以下是 Windows 身份类的链接：

[http://msdn.microsoft.com/en-us/library/system.security.principal.windowsidentity.aspx](http://msdn.microsoft.com/en-us/library/system.security.principal.windowsidentity.aspx)

# ruby-on-rails - 为什么将 Ruby on Rails 部署到生产环境据说“很难”？

> ID：1013771
> 
> 赞同：9
> 
> 时间：2009-06-18T16:36:33.160
> 
> 标签：ruby-on-rails, deployment

我承认我在部署测试和生产代码方面没有遵循很多“正确”的做法。我一直在使用 ASP.NET，我通常在 Visual Studio 中本地运行它，它可以工作，我上传它，我在生产服务器上再次测试它。

我读过一些人说部署 Rails 应用程序更难，并且 ruby​​ 网站上有关于部署 RoR 的特殊程序/方法。我只玩过RoR。部署有什么特别之处？您不只是复制和粘贴代码并运行它（从开发机器到生产）？是因为一个在 Apache 中，另一个在内置服务器上运行吗？

如果重要，这将在 Mac 服务器上。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-06-18T16:41:00.817

部署 RoR 不再困难，尤其是使用[Phusion Passenger](http://www.modrails.com/)。

有点困难的是，使用 capistrano、vlad 等进行自动化生产环境设置。如果您不介意简单地将代码复制到服务器，您可以做到这一点。大多数人选择不这样做，因为您失去了自动化部署工具给您带来的许多好处。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-06-19T02:05:40.813

我猜人们认为 Rails 应用程序比说一些 PHP 应用程序更难部署，或者你只是将代码放在某个地方并指向 Apache 或其他任何东西。但是，如上所述，您现在可以使用 Phusion Passenger 做到这一点。

我们使用 Nginx+Passenger，但不是为了简单的部署。Capistrano 是我们选择的部署工具，实际上，除非你有一个非常简单的应用程序，否则无论如何你都会想要像 Capistrano 这样的东西。例如，在我们的部署中，我们做了很多事情：

*   运行任何数据库迁移
*   根据上次部署和本次部署之间对 Git 的所有提交，自动生成发行说明
*   通过电子邮件通知不同的人（根据部署是针对我们的暂存环境还是生产环境，使用不同的列表）——我们通过与 Capistrano 集成的 cap_gun 执行此操作。
*   通知 New Relic RPM 部署，以便它可以在我们的 RPM 分析中标记它
*   通知 Hoptoad 部署，因此在报告任何异常时它也可以拥有该数据
*   生成我们的 sitemap.xml 文件，然后 ping Google 告诉他们有一个新文件
*   更新 crontab 文件（我将每个服务器的 crontab 文件存储在我们的 git repo 中，然后在部署时查看是否有新版本并进行相应更新等）。
*   刷新/重启 memcached

除了 Capistrano 之外还有其他方法，但它是一个经过验证的工具，具有很大的灵活性，但设置 vanilla 配置非常简单。

所以，我的看法是，一旦你进入任何超越最简单应用程序的应用程序，你将需要/想要做一些事情，而不仅仅是简单地更新代码。不过一开始，如果你只需要代码更新，也许是 Rails 迁移，那么你可以做一些更简单的事情，比如乘客和代码同步，或者查看 Heroku 或 Engine Yard 之类的工具，他们通过 Git 克隆进行部署（然后提供一些额外的能力）。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2010-06-10T01:54:36.730

另一种超级简单的部署方法是使用[http://heroku.com/](http://heroku.com/)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-07-18T18:51:07.073

将 Rails 部署到生产环境时遇到的一些问题：

*   数据库连接。您需要确保为生产环境设置了数据库连接器。

*   数据库迁移。您必须针对生产数据库运行数据库迁移，即使您可能已经在生产/测试/暂存中运行它们

*   红宝石版本。版本或子版本或 Ruby 可能会让您出错，例如[安装 debugger-linecache (1.1.1) 时发生错误，并且 Bundler 无法继续](https://stackoverflow.com/questions/11354768/an-error-occurred-while-installing-debugger-linecache-1-1-1-and-bundler-canno)

*   宝石依赖。您的生产环境可能具有与开发不同的包和 gem。Bundler 将在很大程度上解决这个问题并安装依赖项，但有时仍然存在您必须手动解决的问题。

*   依赖关系。某些机器上的某些 gem 具有特定的依赖关系。我经常看到在我的适用于 OSX 的 unix 机器上使用 gems 时经常出现问题，反之亦然。

请注意，如果在同一台机器上，最后 3 个不应该影响您，但我根据标题将它们包括在内并且是全面的。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-18T16:42:10.427

这不是特别难。如果您遵守约定，那么只需进行一些配置，就可以归结为：

```
cap deploy 
```

...但是，有时需要预先付出一些努力才能使工作流程到位。

好消息是，很多人已经为 RoR 打包了解决方案和堆栈，您可以即插即用。例如，google ec2onrails - 这是一个打包的 Ubuntu 映像和一组 capistrano 任务，用于在 Amazon 的 EC2 云中运行 rails 应用程序，其中已经设置了许多开箱即用的常用东西。

选择一个好的托管服务提供商，您应该也能找到类似的东西。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-18T16:44:48.243

部署 Rails 应用程序的一种简单方法是使用[Phusion Passenger](http://www.modrails.com/)。部署不会比任何编程语言或框架更容易。您可以在 Mac 服务器上执行此操作。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-06-19T02:09:37.483

另一个部署 Rails 的简单方法是使用 jruby 和 glassfish gem。

# mysql - 调试极端负载下建立mySQL数据库连接时出错

> ID：1013773
> 
> 赞同：1
> 
> 时间：2009-06-18T16:37:32.973
> 
> 标签：mysql, debugging, connection

在高流量下，我的 mysql 5.0.45 服务器 /Apache2/CentOS 5 出现“建立 mySQL 数据库连接时出错”。我需要找到根本原因。

我非常感谢任何指向有关我应该采取的查找原因的过程的信息的指针（内存限制、线程限制、CPU 负载、慢查询等、大型数据集、错误的键......）我认为它涉及查看相关日志文件等....

谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-18T16:44:03.733

该特定错误消息听起来像是由您的应用程序生成的，而不是由系统库生成的。MySQL 具有报告正在发生的特定错误的功能，因此最好的办法是以某种方式利用它。

例如，如果您使用的是 PHP，有一个名为 mysql_error() 的函数会返回有关遇到的最后一个错误的详细信息（连接太多等）。您将在连接调用附近进行一些错误处理，并在[mysql_error()](http://ca.php.net/manual/en/function.mysql-error.php)失败时记录结果。

您没有提及您使用的语言，但 MySQL 库将为您使用的任何语言提供相同的功能。我建议修改您的应用程序代码以利用它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-18T16:46:14.933

我敢打赌，这是因为您达到了 mysql 服务器允许的最大用户限制，但总的来说，如果不是打印到屏幕上，但至少打印到日志或电子邮件，请务必打印 mysql 错误。

# python - 写入文件后，为什么 os.path.getsize 仍然返回之前的大小？

> ID：1013778
> 
> 赞同：13
> 
> 时间：2009-06-18T16:38:24.487
> 
> 标签：python, filesize

我正在尝试将大型 xml 文件拆分为较小的块。我写入输出文件，然后检查它的大小以查看它是否超过了阈值，但我认为 getsize() 方法没有按预期工作。

什么是获取大小变化的文件的文件大小的好方法。

我做过这样的事情......

```
import string
import os

f1 = open('VSERVICE.xml', 'r')
f2 = open('split.xml', 'w')

for line in f1:
  if str(line) == '</Service>\n':
    break
  else:
    f2.write(line)
    size = os.path.getsize('split.xml')
    print('size = ' + str(size)) 
```

运行它会打印 0 作为文件大小进行大约 80 次迭代，然后打印 4176。Python 是否在实际输出之前将输出存储在缓冲区中？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2011-04-28T16:22:11.137

文件大小与文件位置不同。例如，

```
os.path.getsize('sample.txt') 
```

它以字节为单位准确返回文件大小。

但

```
f = open('sample.txt')
print f.readline()
f.tell() 
```

这里 f.tell() 返回文件处理程序的当前位置 - 即下一次写入将放置其数据的位置。由于它知道缓冲，因此只要您只是附加到输出文件，它就应该是准确的。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-06-18T16:41:16.620

是的，Python 正在缓冲您的输出。您最好自己跟踪尺寸，如下所示：

```
size = 0
for line in f1:
  if str(line) == '</Service>\n':
    break
  else:
    f2.write(line)
    size += len(line)
    print('size = ' + str(size)) 
```

（这可能不是 100% 准确，例如，在 Windows 上，由于`\r\n`行分隔符，每行都会增加一个字节，但对于简单的分块来说应该足够了。）

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-08-06T14:26:27.930

您是否尝试过将 os.path.getsize 替换为 os.tell，如下所示：

```
f2.write(line)
size = f2.tell() 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-06-18T19:16:56.100

自己跟踪尺寸将适合您的情况。另一种方法是在检查大小之前刷新文件缓冲区：

```
f2.write(line)
f2.flush()  # <-- buffers are written to disk
size = os.path.getsize('split.xml') 
```

当然，经常这样做会降低文件 I/O 的速度。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2011-11-25T11:58:43.183

要查找文件末尾的偏移量：

```
file.seek(0,2)
print file.tell() 
```

现实世界的例子 - 读取文件的更新并在它们发生时打印它们：

```
file = open('log.txt', 'r')
#find inital End Of File offset
file.seek(0,2)
eof = file.tell()
while True:
    #set the file size agian
    file.seek(0,2)
    neweof = file.tell()
    #if the file is larger...
    if neweof > eof:
        #go back to last position...
        file.seek(eof)
        # print from last postion to current one
        print file.read(neweof-eof),
        eof = neweof 
```

# wpf - WPF：如何制作“pushlike”复选框？

> ID：1013779
> 
> 赞同：9
> 
> 时间：2009-06-18T16:38:27.230
> 
> 标签：wpf, button, checkbox, controltemplate

我想做一个看起来完全像按钮的 CheckBox。我最初的微弱尝试根本不起作用。

```
<CheckBox x:Name="test">
    Testing!
    <CheckBox.Template>
        <ControlTemplate>
            <Button>
                <ContentPresenter/>
            </Button>
        </ControlTemplate>
    </CheckBox.Template>
</CheckBox> 
```

ContentPresenter 不起作用（按钮为空），单击按钮时，IsChecked 属性不会切换。另外，当 IsChecked 为真时，我不知道如何使按钮看起来被按下。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-06-18T16:45:27.010

[ToggleButton](http://msdn.microsoft.com/en-us/library/system.windows.controls.primitives.togglebutton.aspx)会满足您的需求吗？CheckBox 派生自它，因此它们非常相似。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-06-18T16:49:20.253

我刚开始写同样的评论:)

```
<ToggleButton Name="tb"  Height="45" Width="45">
        <ToggleButton.Style>
            <Style TargetType="{x:Type ToggleButton}">
                <Setter Property="Content" Value="False"/>
                <Style.Triggers>
                    <Trigger Property="IsChecked" Value="True">
                        <Setter Property="Content" Value="True"/>
                    </Trigger>
                </Style.Triggers>
            </Style>
        </ToggleButton.Style>
    </ToggleButton> 
```

现在如您所愿，复选框控件：

```
<CheckBox>
        <CheckBox.Template>
            <ControlTemplate TargetType="CheckBox">
                <ToggleButton x:Name="toggleButton">
                </ToggleButton>
                <ControlTemplate.Triggers>
                    <Trigger Property="IsChecked" Value="True" SourceName="toggleButton">
                        <Setter Property="Content" Value="True"/>
                    </Trigger>
                    <Trigger Property="Content" Value="True">
                        <Setter Property="IsChecked" Value="True"/>
                    </Trigger>
                </ControlTemplate.Triggers>
             </ControlTemplate>
        </CheckBox.Template>
    </CheckBox> 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-18T17:07:23.277

我同意 ToggleButton 是要走的路，但是如果您希望您的内容显示在您的示例中，请尝试将您的 ContentPresenter 声明更改为：

```
<ContentPresenter Content="{TemplateBinding Content}" /> 
```

# cocoa - AquaticPrime“常规”许可证？

> ID：1013784
> 
> 赞同：3
> 
> 时间：2009-06-18T16:39:23.470
> 
> 标签：cocoa, registration

我正在考虑将 AquaticPrime 用作 Cocoa 共享软件应用程序的密钥生成器。对于那些不了解它的人，您可以在这里查看：http: [//aquaticmac.com/](http://aquaticmac.com/)。但是，当我尝试实现它时遇到了问题。我不希望我的用户必须将整个字典复制并粘贴到我的应用程序中（或从文件浏览器中选择它），我只希望他们有一些代码，例如：1111-1111-1111-1111-1111为他们解锁应用程序。在 AquaticPrime 中有什么方法可以做到这一点吗？但是假设它不能，是否有其他框架可以做到这一点，或者我只需要对其进行硬编码？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-18T18:33:27.327

它使用许可证文件的原因是为了使密码难以组成许可证——您不能像使用许可证号那样只编写密钥生成器。

您可以通过在应用程序的 Info.plist 中为许可证文件创建自定义文件类型来简化此操作。（这必须是特定于应用程序的。当您开始第二个产品时，您需要创建一个新类型。）这种类型将具有自定义的、特定于应用程序的文件扩展名。

然后，当用户双击许可文件（可能在 Mail 中）时，操作系统将使用您的应用程序打开它。您可能会在您的应用程序委托中处理此问题，方法是将许可证文件提供给 AquaticPrime 进行验证。

这样，用户甚至不必召唤一个对话框、复制许可证号并粘贴它。他们所要做的就是双击许可证文件。

因此，许可证文件使注册应用程序*变得更容易，而不是更难。*

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-18T19:56:57.643

如果您有已解锁的应用程序试用版，则可以执行以下操作。

* * *

1) 创建自定义 url 方案。

[请按照此帖子](https://stackoverflow.com/questions/49510/how-do-you-set-your-cocoa-application-as-the-default-web-browser/913690#913690)上的说明进行操作，但不要让 http 和 https 让您的应用程序响应诸如 activate-com-mycompany-myproduct 之类的内容。

一旦用户运行了您的应用程序，浏览器中的任何链接（如 activate-com-mycompany-myproduct://somedata）都会自动打开您的应用程序。

* * *

2) 在您的网上商店的最终购买页面和您的电子邮件收据中提供产品激活链接。为了方便用户而不是您，请在 URL 中附加一个唯一的 id。在数据库中映射 ID，动态生成许可证 plist 并将其无缝推送给用户。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-05-25T15:27:30.207

万一其他人偶然发现了这个问题：您可能还想看看[CocoaFob](http://github.com/gbd/cocoafob/)。它生成的密钥相当长，但更接近您所追求的格式，并且仍然很容易剪切和粘贴。

# mysql - Django ORM 在 SQL Join 中创建幻影别名

> ID：1013785
> 
> 赞同：2
> 
> 时间：2009-06-18T16:39:24.237
> 
> 标签：mysql, django, join, django-orm, mysql-error-1054

我正在执行以下代码（更改名称以保护无辜者，因此模型结构可能看起来很奇怪）：

```
memberships = 
    models.Membership.objects.filter(
        degree__gt=0.0,
        group=request.user.get_profile().group
    )

exclude_count =  
    memberships.filter(
        member__officerships__profile=request.user.get_profile()
    ).count()

if exclude_officers_with_profile:
    memberships = memberships.exclude(
        member__officerships__profile=request.user.get_profile()
    )

total_count = memberships.count() 
```

此时导致：

```
OperationalError at /
(1054, "Unknown column 'U1.id' in 'on clause'") 
```

生成的 SQL 是：

```
SELECT 
    COUNT(*) 
FROM 
    `membership` 
WHERE (
    `membership`.`group_id` = 2 AND
    `membership`.`level` > 0.0 AND 
    NOT (
        `membership`.`member_id` 
        IN (
            SELECT 
                U2.`member_id` 
            FROM 
                `membership` U0 INNER JOIN `officers` U2 
                ON (U1.`id` = U2.`member_id`) 
            WHERE U2.`profile_id` = 2 
        )
    )
) 
```

似乎 SQL Join 的 ON 语句正在引用尚未定义的别名。任何想法为什么！我删除了我的 MySQL 数据库并重新同步了我的模型中的表，以尝试确保那里没有任何不一致。

我正在使用的模型的结构是：

```
class Membership(models.Model):
    member = models.ForeignKey(Member, related_name='memberships')
    group = models.ForeignKey(Group, related_name='memberships')
    level = models.FloatField(default=0.0)

class Member(models.Model):
    name = models.CharField(max_length=32)

class Officer(models.Model):
    member = models.ForeignKey(Member, related_name='officerships')
    profile = models.ForeignKey(UserProfile)

class UserProfile(models.Model)
    group = models.ForeignKey(Group)

class Group(models.Model)
    pass 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-18T18:18:56.507

我认为这可能是以下症状：

[http://code.djangoproject.com/ticket/9188](http://code.djangoproject.com/ticket/9188)

我认为这是从 django 修订版 9589 开始修复的。现在如何确定我正在使用哪个版本......

* * *

确认的。当我实施上述票证中引用的更改时：

[http://code.djangoproject.com/changeset/9589](http://code.djangoproject.com/changeset/9589)

我的错误消失了。

# java - 是否可以明确告诉 maven 下载并将工件安装到本地存储库？

> ID：1013787
> 
> 赞同：2
> 
> 时间：2009-06-18T16:39:26.403
> 
> 标签：java, maven-2, build

是的，我[在没有 mvn/poms 和其他相关问题的情况下阅读了从 maven repo 下载工件的实用程序](https://stackoverflow.com/questions/884808/)，但我不想手动安装文件。实际上，我想要一个类似于*wget*的东西，它可以获取一个工件（带有依赖项）并将其放在某个地方或将其安装在本地存储库中。也许有一个可用的插件可以做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-18T17:16:16.887

有一个`dependency:get`目标，如[依赖插件手册](http://maven.apache.org/plugins/maven-dependency-plugin/get-mojo.html)中所述。

在这张[jira 票](http://jira.codehaus.org/browse/MDEP-184)上请求了这个特色。

但我用 Maven 2.1.0 试过了，但没有用。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-18T17:11:05.597

我不确定是否有 Maven 插件来处理这个问题，但是为此目的使用[Maven Ant 任务相当简单。](http://maven.apache.org/ant-tasks/index.html "Maven Ant 任务")你不需要 Maven 或 POM 文件，只需要 Ant 和这个构建文件：

```
<?xml version="1.0" encoding="UTF-8"?>
<project name="mvn-get" default="get" basedir=".">
    <property name="maven.ant.tasks.jar" value="${ant.home}/lib/maven-ant-tasks-2.011.jar" />
    <property name="maven.ant.tasks.bootstrap.location" value="http://apache.inetbridge.net/maven/binaries/maven-ant-tasks-2.0.11.jar" />
    <available property="maven.ant.tasks.jar.exists" file="${maven.ant.tasks.jar}" />

    <!-- This will download the "latest version" of the maven-ant-tasks if needed -->
    <target name="bootstrap_maven" unless="maven.ant.tasks.jar.exists">
        <get src="${maven.ant.tasks.bootstrap.location}" dest="${maven.ant.tasks.jar}" />
    </target>

    <!-- This will initialize all the maven ant tasks and download the requested artifact and its dependencies -->
    <target name="get" depends="bootstrap_maven" xmlns:artifact="urn:maven-artifact-ant">
        <path id="maven.ant.tasks.classpath" path="${maven.ant.tasks.jar}" />
        <typedef resource="org/apache/maven/artifact/ant/antlib.xml" uri="urn:maven-artifact-ant" classpathref="maven.ant.tasks.classpath" />
        <condition property="maven.repo.local" value="${maven.repo.local}" else="${user.home}/.m2/repository">
            <isset property="maven.repo.local" />
        </condition>
        <echo>maven.repo.local=${maven.repo.local}</echo>
        <artifact:localRepository id="local.repository" path="${maven.repo.local}" />
        <artifact:dependencies pathId="build.classpath" sourcesFilesetId="sources.id">
            <dependency groupId="${mvn.get.groupId}" artifactId="${mvn.get.artifactId}" version="${mvn.get.version}"/>
            <localRepository refid="local.repository" />
        </artifact:dependencies>
    </target>

</project> 
```

使用如下命令行将执行您想要的操作：

```
ant -Dmvn.get.groupId=commons-httpclient -Dmvn.get.artifactId=commons-httpclient -Dmvn.get.version=3.1 -Dmaven.repo.local=. 
```

灵感来自这篇[出色的博客文章。](http://ptrthomas.wordpress.com/2009/03/08/why-you-should-use-the-maven-ant-tasks-instead-of-maven-or-ivy/ "为什么你应该使用 Maven Ant Tasks 而不是 Maven 或 Ivy")

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-18T16:58:12.227

我将研究将 maven 依赖插件与 maven install 插件结合使用。

*   依赖： [http ://maven.apache.org/plugins/maven-dependency-plugin/usage.html](http://maven.apache.org/plugins/maven-dependency-plugin/usage.html)
*   安装： [http ://maven.apache.org/plugins/maven-install-plugin/examples/specific-local-repo.html](http://maven.apache.org/plugins/maven-install-plugin/examples/specific-local-repo.html)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-18T17:03:59.507

您的意思是一种不向*pom.xml*添加依赖项的方法？

因为通过向*pom.xml*添加依赖项， maven 依赖项管理会自动从您指定的存储库中检索工件并将其安装到本地存储库。

```
<dependencies>
  <dependency>
    <groupId>foo</groupId>
    <artifactId>foo</artifactId>
    <version>1.0.1</version>
  </dependency>
</dependencies> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-18T17:11:12.260

我使用以下 shell 脚本来安装 Commons Logging 替代品，但在这种情况下，我已经有了 jars：

```
#！/bin/sh

mvn install:安装文件\
    -DgroupId=commons-日志记录\
    -DartifactId=commons-日志记录\
    -Dversion=99.0-不存在\
    -D包装=罐子\
    -DcreateChecksum=真\
    -DpomFile=commons-logging-99.0-does-not-exist.pom \
    -Dfile=commons-logging-99.0-does-not-exist.jar

mvn install:安装文件\
    -DgroupId=commons-日志记录\
    -DartifactId=commons-logging-api\
    -Dversion=99.0-不存在\
    -D包装=罐子\
    -DcreateChecksum=真\
    -DpomFile=commons-logging-api-99.0-does-not-exist.pom \
    -Dfile=commons-logging-api-99.0-does-not-exist.jar

```

当您说“本地存储库”时，您是指您自己的个人存储库，即 unix 上 ~/.m2 中的存储库，还是您的公司存储库？这是一个不同的问题。对于前者，我有抖动；只需将条目添加到您的 pom.xml 中即可。对于后者，请查看存储库服务器的文档以了解如何获取中央服务器的副本。

# properties - 从其他文件访问 ExtJS 网格的列模型

> ID：1013794
> 
> 赞同：1
> 
> 时间：2009-06-18T16:40:21.410
> 
> 标签：properties, model, extjs, grid

我有一个 ExtJS 网格，其中设置了一个按钮。该按钮触发一个定义在网格页面中的其他 JS 文件中的函数。该函数触发正常，但在该函数中，我想获得这样的列数：

```
grid.getColumnModel().getColumnCount() 
```

问题是我收到如下错误：grid.getColumnModel 不是函数。

在 PHP 中，我会创建一个“全局 $ext”，然后访问该函数。我怎样才能在 Ext 中做到这一点？如何从其他文件访问网格？需要定义什么？

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-18T16:52:53.620

你是如何定义网格对象的？你是这样做的吗：

```
var grid = new Ext.grid.GridPanel(...); 
```

如果是这样，则网格对象不在全局范围内。删除“var”，看看它是否有帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-18T16:55:47.503

这看起来像一个范围问题。请参阅 JavaScript 中的变量[范围](http://www.digital-web.com/articles/scope_in_javascript/)。

基本上，你可以这样做：

```
my_global_grid = ... // accessible in the current ~global~ context (document, window)
var my_local_grid = ... // accessible only in the function
window.my_window_global_grid = ... // accessible in the same window 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-18T18:12:39.793

您还可以将网格对象作为参数传递给您的函数：

```
function myFunction(arg1,arg2,grid){
   ...
    var count = grid.getColumnModel().getColumnCount();
   ...
} 
```

# eclipse - Eclipse PDE 构建无法在 customAssembly 上找到 jar 位置

> ID：1013795
> 
> 赞同：0
> 
> 时间：2009-06-18T16:40:25.873
> 
> 标签：eclipse, eclipse-plugin, eclipse-pde

我正在运行 PDE 构建 - 几乎是默认值（参见消息末尾），它设法复制我所有的插件/功能，解决它们，编译它们并生成 p2 元数据。

在这`customAssembly`一步，它神秘地失败了

```
BUILD FAILED
/home/robert/apps/eclipse/plugins/org.eclipse.pde.build_3.5.0.v20090527-1800/scripts    /build.xml:38: The following error occurred while executing this line:
/home/robert/apps/eclipse/plugins/org.eclipse.pde.build_3.5.0.v20090527-1800/scripts   /build.xml:129: The following error occurred while executing this line:
/home/robert/apps/eclipse/plugins/org.eclipse.pde.build_3.5.0.v20090527-1800/templates/headless-build/customTargets.xml:12: The following error occurred while executing this line:
/home/robert/apps/eclipse/plugins/org.eclipse.pde.build_3.5.0.v20090527-1800/templates/headless-build/allElements.xml:16: The following error occurred while executing this line:
/home/robert/apps/eclipse/plugins/org.eclipse.pde.build_3.5.0.v20090527-1800/scripts/genericTargets.xml:192: The following error occurred while executing this line:
/tmp/eclipse.build/package.com.itsolut.mantis_feature.all.xml:23: The following error occurred while executing this line:
/tmp/eclipse.build/package.com.itsolut.mantis_feature.all.xml:15: The following error occurred while executing this line:
/home/robert/apps/eclipse/plugins/org.eclipse.pde.build_3.5.0.v20090527-1800/templates/headless-build/allElements.xml:31: The following error occurred while executing this line:
/tmp/eclipse.build/package.com.itsolut.mantis_feature.xml:99: The following error occurred while executing this line:
/tmp/eclipse.build/package.com.itsolut.mantis_feature.xml:169: /tmp/eclipse.build/tmp/eclipse/plugins/javax.xml.soap_1.3.0.v200904281458 not found. 
```

奇怪的是，在 /tmp/eclipse.build/tmp/eclipse/plugins/ 目录下有一个 jar 文件：

```
/tmp/eclipse.build/tmp/eclipse/plugins/javax.xml.soap_1.3.0.v200904281458.jar 
```

我不知道，因为这应该是一个完全自动的过程，但它却神秘地失败了。

有任何想法吗？

* * *

## 构建文件

```
<?xml version="1.0" encoding="UTF-8"?>
<project name="Build Mylyn-Mantis" default="runBuild">

<property name="builder" location="."/>
<property name="topLevelElementId" value="com.itsolut.mantis_feature"/>
<property name="baseLocation" location="${eclipse.home}"/>
<property name="base" location="${baseLocation}/.."/>
<property name="buildDirectory" location="${java.io.tmpdir}/eclipse.build"/>

<import file="${eclipse.pdebuild.scripts}/build.xml"/>

<target name="copyProjects">
    <delete dir="${buildDirectory}"/>
    <mkdir dir="${buildDirectory}"/>

    <record name="${buildDirectory}/${topLevelElementId}-build.log" loglevel="verbose"/>

    <echoproperties/>

    <mkdir dir="${buildDirectory}/features/${topLevelElementId}"/>
    <copy todir="${buildDirectory}/features/${topLevelElementId}">
        <fileset dir="../com.itsolut.mantis-feature"/>
    </copy>

    <mkdir dir="${buildDirectory}/plugins"/>

    <copy todir="${buildDirectory}/plugins">
        <fileset dir="..">
            <include name="com.itsolut.mantis/**"/>
            <include name="com.itsolut.mantis.core/**"/>
            <include name="com.itsolut.mantis.ui/**"/>
            <exclude name="*/bin/**"/>
        </fileset>
    </copy>
</target>

<target name="runBuild" depends="copyProjects,main"/> 
```

## 完整的源码

勇敢的灵魂可以查看[svn 中的项目以](http://mylyn-mantis.svn.sourceforge.net/viewvc/mylyn-mantis/trunk/com.itsolut.mantis.pde/)获取更多信息。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-18T17:20:45.430

我相信你遇到了[这个错误](https://bugs.eclipse.org/bugs/show_bug.cgi?id=265471)。

作为一种解决方法，请尝试将`unpack="false"`属性添加到您的 com.itsolut.mantis_feature/feature.xml 以用于您包含的二进制 jar 插件（即可能是大多数 javax.* 包）。

# sql - SQL IN 对性能不利吗？

> ID：1013797
> 
> 赞同：83
> 
> 时间：2009-06-18T16:41:03.860
> 
> 标签：sql, sql-server-2000

我有一个查询，例如：

```
SELECT FieldX, FieldY FROM A
WHERE FieldW IN (108, 109, 113, 138, 146, 160,
307, 314, 370, 371, 441, 454 ,457, 458, 479, 480,
485, 488, 490, 492, 519, 523, 525, 534, 539, 543,
546, 547, 550, 564, 573, 629, 642, 643, 649, 650,
651, 694, 698, 699, 761, 762, 768, 772, 773, 774,
775, 778, 784, 843, 844, 848, 851, 852, 853, 854,
855, 856, 857, 858, 859, 860, 861, 862, 863, 864,
865, 868, 869, 871, 872, 873, 891) 
```

有这么多选项的 IN 子句，对查询性能不利吗？我在我的应用程序中遇到了很多超时，我相信这可能是此类问题的根源。我可以使用任何好的 SQL 提示优化查询而不删除数字吗？

编辑：

@KM 这些是不同表中的键。这是一个论坛应用程序，简单解释一下：c#从数据库中获取所有论坛，并将其存储在应用程序缓存中。在 C# 调用获取这些论坛和该用户的线程的过程之前，c# 会执行一些逻辑过滤“所有论坛”集合，考虑权限和一些业务逻辑。超时发生在数据库上，而不是应用程序本身。在查询上执行所有这些逻辑将需要大量内部连接，我不能 100% 确定我可以在过程中完成所有这些。

我正在使用**SQL Server 2000**

* * *

## 回答 #1

> 赞同：162
> 
> 时间：2009-06-18T17:10:44.957

使用 IN 运算符编写查询时，有几个注意事项可能会影响性能。

**首先，大多数数据库通常在内部重写 IN 子句以使用 OR 逻辑连接词。**于是`col IN ('a','b','c')`改写为：`(COL = 'a') OR (COL = 'b') or (COL = 'c')`. 假设*您*在`col`.

**其次，当使用带有可变数量参数的 IN 或 OR 时，您会导致数据库在每次参数更改时都必须重新解析查询并重建执行计划。**为查询构建执行计划可能是一个昂贵的步骤。大多数数据库使用 EXACT 查询文本作为键来缓存它们运行的​​查询的执行计划。如果您执行类似的查询，但在谓词中使用不同的参数值 - 您很可能会导致数据库花费大量时间来解析和构建执行计划。这就是为什么[强烈建议将绑定变量](http://decipherinfosys.wordpress.com/2007/08/29/bind-variables-usage-parameterized-queries-in-sql-server/)作为确保最佳查询性能的一种方式。

**第三，许多数据库对它们可以执行的查询的复杂性有限制——其中一个限制是谓词中可以包含的逻辑连接数。**在您的情况下，几十个值不太可能达到数据库的内置限制，但如果您希望将数百或数千个值传递给 IN 子句 - 它肯定会发生。在这种情况下，数据库将简单地取消查询请求。

**第四，在谓词中包含 IN 和 OR 的查询不能总是在并行环境中以最佳方式重写。**在许多情况下并行服务器优化没有得到应用——MSDN对优化并行查询进行[了不错的介绍。](http://msdn.microsoft.com/en-us/library/ms178065.aspx)不过，一般来说，使用 UNION ALL 运算符的查询在大多数数据库中都是可并行化的 - 并且在可能的情况下优先于逻辑连接词（如 OR 和 IN）。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-06-18T16:46:21.190

`IN`您可以尝试创建一个临时表，将您的值插入其中并在谓词中使用该表。

AFAIK，`SQL Server 2000`无法构建一组常量的哈希表，这剥夺了优化器使用`HASH SEMI JOIN`.

仅当您没有索引`FieldW`（您应该有）时，这才会有所帮助。

您还可以尝试将您的`FieldX`和`FieldY`列包含到索引中：

```
CREATE INDEX ix_a_wxy ON a (FieldW, FieldX, FieldY) 
```

以便只能通过使用索引来提供查询。

`SQL Server 2000`缺少`INCLUDE`选项`CREATE INDEX`，这可能会`DML`稍微降低性能，但会提高查询性能。

**更新：**

从您的执行计划中，我看到您需要一个复合索引`(SettingsID, SectionID)`

`SQL Server 2000`确实可以从常量列表中构建一个哈希表（并且做到了），但`Hash Semi Join`很可能会比`Nested Loop`for query 查询效率低。

附带说明：如果您需要知道满足`WHERE`条件的行数，请不要使用`COUNT(column)`，`COUNT(*)`而是使用。

A`COUNT(column)`不计算`column`值为的行`NULL`。

这意味着，首先，您可以获得意想不到的结果，其次，如果您的列未被满足条件的索引覆盖，优化器将需要执行额外的`Key Lookup`/操作。`Bookmark Lookup``WHERE`

因为`ThreadId`似乎是 a `CLUSTERED PRIMARY KEY`，所以这个查询没问题，但一般尽量避免它。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-06-18T16:43:32.423

如果您在 FieldW 上有一个好的索引，那么使用该 IN 是完全正确的。

我刚刚测试过，SQL 2000 在使用 IN 时会进行聚集索引扫描。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-06-18T16:55:35.367

根据您的数据分布，WHERE 子句中的附加谓词可能会提高性能。例如，如果 id 的集合相对于表中的总数较小，并且您知道这些 id 相对靠近（也许它们通常是最近添加的，因此聚集在范围的高端），您可以尝试包含谓词“AND FieldW BETWEEN 109 AND 891”（在 C# 代码中确定集合中的最小和最大 ID 之后）。对这些列（如果已编制索引）进行范围扫描可能比当前使用的更快。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-06-18T16:43:00.130

有更好的编码方法，但我怀疑这是你超时的原因，特别是如果它只是一个 SELECT。不过，您应该能够通过查看查询跟踪来确定这一点。但是重新编码这将是通过猜测进行优化，而且不太可能是猜测。

让我们从实际超时的查询的查询计划开始。您确定它是哪个查询吗？

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-06-18T16:50:37.957

IN 与编写大量 OR 完全相同。并且 OR 经常使查询不可搜索，因此您的索引可能会被忽略，并且计划进行全面扫描。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-06-18T17:15:48.900

这是你的答案...

[http://www.4guysfromrolla.com/webtech/031004-1.shtml](http://www.4guysfromrolla.com/webtech/031004-1.shtml)

基本上，您想创建一个函数来拆分字符串并使用拆分的内容填充临时表。然后您可以加入该临时表并操作您的数据。以上解释的很好。我经常使用这种技术。

在您的特定情况下，使用连接到临时表而不是 in 子句，速度要快得多。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-06-18T16:44:07.477

通常 IN 子句对性能有害，但什么是“坏”取决于应用程序、数据、数据库大小等。您需要测试自己的应用程序以查看什么是最好的。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-06-18T16:46:54.293

基本上，where 子句的作用是“FieldW = 108 OR FieldW = 109 OR FieldW = 113 ...”。有时，您可以通过执行多项选择并将它们与 union 结合来获得更好的性能。例如：

```
SELECT FieldX, FieldY FROM A WHERE FieldW = 108
UNION ALL
SELECT FieldX, FieldY FROM A WHERE FieldW = 109 
```

但是，当您与这么多值进行比较时，这当然是不切实际的。

另一种选择可能是将这些值插入到临时表中，然后将 A 表连接到该临时表。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-06-18T16:47:03.373

表的大小将决定使用此语句时的速度。如果它不是一个很大的表......这个声明不会影响你的表现。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-06-18T16:48:37.867

性能只能在您尝试做的事情的背景下进行判断。在这种情况下，您请求检索大约 70 行（假设它们是唯一值），因此您可以预期检索单个值的持续时间约为 70 倍。由于缓存或课程，它可能较少。

但是，查询优化器可能需要或选择执行全表扫描以检索值，在这种情况下，性能与通过相同的访问计划检索单个值几乎没有什么不同。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2015-12-09T19:18:30.790

对于这样的查询，我通常会使用用户定义的表类型。

```
CREATE TYPE [dbo].[udt_int] AS TABLE (
    [id] [int] NOT NULL
) 
```

使用表变量并为每个数字填充行，您可以执行以下操作：

```
SELECT 
    FieldX, 
    FieldY
FROM A
INNER JOIN @myIds B ON
    A.FieldW = B.id 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-06-18T17:29:31.440

You might try something like:

```
select a.FieldX, a.FieldY
from (
    select FieldW = 108 union
    select FieldW = 109 union
    select FieldW = 113 union
    ...
    select FieldW = 891
) _a
join A a on a.FieldW = _a.FieldW 
```

It may be appropriate for your situation, such as when you want to generate a single SQL statement dynamically. On my machine (SQL Server 2008 Express), testing with a small number (5) of FieldW values and a large number (100,000) of rows in A, this uses an index seek on A with a nested loops join between A and _a, which is probably what you're looking for.

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2009-06-18T16:50:26.803

如果您可以使用 IN 以外的其他东西：这样做（在某些情况下，我使用 IN 并不是一个好方法：我可以轻松地用存在替换它并且它更快）

在你的情况下：看起来还不错。

# jquery - 访问图像

> ID：1013807
> 
> 赞同：0
> 
> 时间：2009-06-18T16:42:36.213
> 
> 标签：jquery

我有 3 张图片。如何访问它们中的每一个，然后检查 src 以查看它是否与字符串匹配。如果 src 与字符串匹配，则突出显示图像。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-18T16:54:16.787

```
$(":img[src='matchString']").toggleClass('yourhighlightCSScalss') 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-18T17:05:31.923

如果你想要更多的功能，而不仅仅是添加 css 类，请使用：

```
$('img[src="matchingString"]').each(function() {
    $(this).addClass('MyCssClass');
}); 
```

# c# - 父窗口拦截加速器

> ID：1013815
> 
> 赞同：2
> 
> 时间：2009-06-18T16:43:32.533
> 
> 标签：c#, wpf, winapi, vsto

我有一个已放入另一个应用程序的窗口。在本例中，我将一个自定义应用程序注入到 Outlook 2003 窗口中。

当我在应用程序中按退格键时，我遇到了父窗口（在本例中为 Outlook）收到 WM_COMMAND 消息的问题。根据我有限的 Win API 经验，这似乎表明父级认为退格键是一个加速器，并且在我的应用程序看到它之前正在处理它。

我正在尝试使用 LoadAccelerators 函数来尝试获取 Outlooks 加速器表，但我不知道如何获取父窗口的表。

有任何想法吗？

编辑：当我按下退格键时，这是 spy++ 的输出：

WM_COMMAND wNotifyCode：1（从加速器发送） wID：1405

我确实注意到，当按下退格键时，我的文本框会得到 WM_KEYDOWN。这是该消息的 Spy++ 行：

P WM_KEYDOWN nVirtKey: VK_BACK cRepeat: 1 ScanOcde:0EfExtended:0fAltDown:0fRepeat:0fUp:0

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-18T20:45:27.777

您将代码注入 Outlook 进程？听起来有点邪恶......无论如何，加速器表实际上并不与窗口相关联。它们由应用程序的消息泵处理（请参阅 TranslateAccelerator 函数）。我会说你最好的选择是使用消息挂钩。如果您看到针对您的窗口的删除键按下消息，请将另一条私人消息发布到您的窗口并吃掉原来的消息，这样 Outlook 就看不到它了。

# xaml - WPF 淡入淡出动画

> ID：1013817
> 
> 赞同：39
> 
> 时间：2009-06-18T16:43:47.323
> 
> 标签：xaml, animation

当控件变为可见时，我将如何使控件淡入/淡出。

以下是我失败的尝试：

```
<Window x:Class="WadFileTester.Form1"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    Name="MyWindow" Title="WAD File SI Checker" Height="386" Width="563" WindowStyle="SingleBorderWindow" DragEnter="Window_DragEnter" DragLeave="Window_DragLeave" DragOver="Window_DragOver" Drop="Window_Drop" AllowDrop="True">
    <Window.Resources>
        <Style TargetType="ListView" x:Key="animatedList">
            <Style.Triggers>
                <DataTrigger Binding="{Binding Visibility}" Value="Visible">
                    <DataTrigger.EnterActions>
                        <BeginStoryboard>
                            <Storyboard>
                                <DoubleAnimation
                                    Storyboard.TargetProperty="Opacity"
                                    From="0.0" To="1.0" Duration="0:0:5"
                                    />
                            </Storyboard>
                        </BeginStoryboard>
                    </DataTrigger.EnterActions>
                    <DataTrigger.ExitActions>
                        <BeginStoryboard>
                            <Storyboard>
                                <DoubleAnimation
                                    Storyboard.TargetProperty="Opacity"
                                    From="1.0" To="0.0" Duration="0:0:5"
                                    />
                            </Storyboard>
                        </BeginStoryboard>
                    </DataTrigger.ExitActions>
                </DataTrigger>
            </Style.Triggers>
        </Style>
    </Window.Resources>
    <Grid>
        <ListView Name="listView1" Style="{StaticResource animatedList}" TabIndex="1" Margin="12,41,12,12" Visibility="Hidden">
        </ListView>
    </Grid>
</Window> 
```

* * *

## 回答 #1

> 赞同：55
> 
> 时间：2009-06-18T23:03:55.847

我不知道如何在纯 XAML 中制作两种动画（淡入和淡出）。但是简单的淡出可以实现比较简单。用触发器替换 DataTriggers，并删除 ExitActions，因为它们在淡出场景中没有意义。这就是你将拥有的：

```
 <Style TargetType="FrameworkElement" x:Key="animatedList">
  <Setter Property="Visibility" Value="Hidden"/>
  <Style.Triggers>
    <Trigger Property="Visibility" Value="Visible">
      <Trigger.EnterActions>
        <BeginStoryboard>
          <Storyboard>
            <DoubleAnimation Storyboard.TargetProperty="Opacity"
                             From="0.0" To="1.0" Duration="0:0:0.2"/>
          </Storyboard>
        </BeginStoryboard>
      </Trigger.EnterActions>
    </Trigger>
  </Style.Triggers>
</Style> 
```

但是，嘿，不要放弃。如果您想支持这两种动画，我可以建议在 XAML 后面进行小编码。在我们做了一个技巧之后，我们将通过在 XAML 中添加一行代码来得到你想要的：

```
<Button Content="Fading button"
        x:Name="btn"
        loc:VisibilityAnimation.IsActive="True"/> 
```

每次我们将 btn.Visibility 从 Visible 更改为 Hidden/Collapsed 按钮都会淡出。每次我们将 Visibility 改回来时，按钮都会淡入。这个技巧适用于任何 FrameworkElement（包括 ListView :)）。

这是 VisibilityAnimation.IsActive 附加属性的代码：

```
 public class VisibilityAnimation : DependencyObject
  {
    private const int DURATION_MS = 200;

    private static readonly Hashtable _hookedElements = new Hashtable();

    public static readonly DependencyProperty IsActiveProperty =
      DependencyProperty.RegisterAttached("IsActive", 
      typeof(bool), 
      typeof(VisibilityAnimation),
      new FrameworkPropertyMetadata(false, new PropertyChangedCallback(OnIsActivePropertyChanged)));

    public static bool GetIsActive(UIElement element)
    {
      if (element == null)
      {
        throw new ArgumentNullException("element");
      }

      return (bool)element.GetValue(IsActiveProperty);
    }

    public static void SetIsActive(UIElement element, bool value)
    {
      if (element == null)
      {
        throw new ArgumentNullException("element");
      }
      element.SetValue(IsActiveProperty, value);
    }

    static VisibilityAnimation()
    {
      UIElement.VisibilityProperty.AddOwner(typeof(FrameworkElement),
                                            new FrameworkPropertyMetadata(Visibility.Visible, new PropertyChangedCallback(VisibilityChanged), CoerceVisibility));
    }

    private static void VisibilityChanged(DependencyObject d, DependencyPropertyChangedEventArgs e)
    {
      // So what? Ignore.
    }

    private static void OnIsActivePropertyChanged(DependencyObject d, DependencyPropertyChangedEventArgs e)
    {
      var fe = d as FrameworkElement;
      if (fe == null)
      {
        return;
      }
      if (GetIsActive(fe))
      {
        HookVisibilityChanges(fe);
      }
      else
      {
        UnHookVisibilityChanges(fe);
      }
    }

    private static void UnHookVisibilityChanges(FrameworkElement fe)
    {
      if (_hookedElements.Contains(fe))
      {
        _hookedElements.Remove(fe);
      } 
    }

    private static void HookVisibilityChanges(FrameworkElement fe)
    {
      _hookedElements.Add(fe, false);
    }

    private static object CoerceVisibility(DependencyObject d, object baseValue)
    {
      var fe = d as FrameworkElement;
      if (fe == null)
      {
        return baseValue;
      }

      if (CheckAndUpdateAnimationStartedFlag(fe))
      {
        return baseValue;
      }
      // If we get here, it means we have to start fade in or fade out
      // animation. In any case return value of this method will be
      // Visibility.Visible. 

      var visibility = (Visibility)baseValue;

      var da = new DoubleAnimation
      {
        Duration = new Duration(TimeSpan.FromMilliseconds(DURATION_MS))
      };

      da.Completed += (o, e) =>
                        {
                          // This will trigger value coercion again
                          // but CheckAndUpdateAnimationStartedFlag() function will reture true
                          // this time, and animation will not be triggered.
                          fe.Visibility = visibility;
                          // NB: Small problem here. This may and probably will brake 
                          // binding to visibility property.
                        };

      if (visibility == Visibility.Collapsed || visibility == Visibility.Hidden)
      {
        da.From = 1.0;
        da.To = 0.0;
      }
      else
      {
        da.From = 0.0;
        da.To = 1.0;
      }

      fe.BeginAnimation(UIElement.OpacityProperty, da);
      return Visibility.Visible;
    }

    private static bool CheckAndUpdateAnimationStartedFlag(FrameworkElement fe)
    {
      var hookedElement = _hookedElements.Contains(fe);
      if (!hookedElement)
      {
        return true; // don't need to animate unhooked elements.
      }

      var animationStarted = (bool) _hookedElements[fe];
      _hookedElements[fe] = !animationStarted;

      return animationStarted;
    }
  } 
```

这里最重要的是 CoerceVisibility() 方法。如您所见，在淡入淡出动画完成之前，我们不允许更改此属性。

此代码既不是线程安全的，也不是没有错误的。它的唯一目的是显示方向:)。因此，请随时改进、编辑并获得声誉；）。

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2012-04-10T22:03:32.423

您不能直接使用 Visibility 属性进行淡出，因为在其上设置触发器将首先隐藏/折叠控件，然后对其进行动画处理。所以基本上你会得到一个折叠控件的动画=>什么都没有。

一种“可靠”的方法是引入一个新的依赖属性（附加或不附加），比如说`IsOpen`并在其上设置一个属性触发器`IsOpen=True`：

#### 输入动作：

*   确保可见性设置为可见
*   不透明度从 0 淡入到 1

#### 退出动作：

*   可见性在关键帧 0 处设置为可见，在最后一个关键帧处设置为折叠/隐藏
*   将不透明度从 1 淡出到 0。

这是一个例子：

```
<Style TargetType="{x:Type local:TCMenu}">
    <Style.Resources>
        <Storyboard x:Key="FadeInMenu">
            <DoubleAnimationUsingKeyFrames Storyboard.TargetProperty="(UIElement.Opacity)" Storyboard.TargetName="{x:Null}">
                <EasingDoubleKeyFrame KeyTime="0" Value="0"/>
                <EasingDoubleKeyFrame KeyTime="0:0:0.2" Value="1"/>
            </DoubleAnimationUsingKeyFrames>
            <ObjectAnimationUsingKeyFrames Storyboard.TargetProperty="(UIElement.Visibility)" Storyboard.TargetName="{x:Null}">
                <DiscreteObjectKeyFrame KeyTime="0:0:0.0" Value="{x:Static Visibility.Visible}"/>
            </ObjectAnimationUsingKeyFrames>
        </Storyboard>
        <Storyboard x:Key="FadeOutMenu">
            <DoubleAnimationUsingKeyFrames Storyboard.TargetProperty="(UIElement.Opacity)" Storyboard.TargetName="{x:Null}">
                <EasingDoubleKeyFrame KeyTime="0" Value="1"/>
                <EasingDoubleKeyFrame KeyTime="0:0:0.2" Value="0"/>
            </DoubleAnimationUsingKeyFrames>
            <ObjectAnimationUsingKeyFrames Storyboard.TargetProperty="(UIElement.Visibility)" Storyboard.TargetName="{x:Null}">
                <DiscreteObjectKeyFrame KeyTime="0:0:0.0" Value="{x:Static Visibility.Visible}"/>
                <DiscreteObjectKeyFrame KeyTime="0:0:0.2" Value="{x:Static Visibility.Collapsed}"/>
            </ObjectAnimationUsingKeyFrames>
        </Storyboard>
    </Style.Resources>
    <Style.Triggers>
        <Trigger Property="IsOpen" Value="true">
            <Trigger.EnterActions>
                <BeginStoryboard Storyboard="{StaticResource FadeInMenu}"/>
            </Trigger.EnterActions>
            <Trigger.ExitActions>
                <BeginStoryboard Storyboard="{StaticResource FadeOutMenu}"/>
            </Trigger.ExitActions>
        </Trigger>
    </Style.Triggers>
    <Setter Property="Visibility" Value="Collapsed"/>
</Style> 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2013-09-26T12:55:43.443

我一直在以一种稍微不同的方式来解决这个问题 - 我有一个 Ray 对[这个问题](https://stackoverflow.com/questions/3049669/programatically-wpf-fade-in-via-extension-methods)的回答的扩展版本，它为所有折叠或显示元素的东西添加了 FadeIn() 和 FadeOut() 扩展方法，然后改为为了使对象可见，我可以在它们上调用 FadeIn() 和 FadeOut() - 它可以在没有任何特定动画代码的任何元素上工作。

```
 public static T FadeFromTo(this UIElement uiElement, double fromOpacity,
        double toOpacity, int durationInMilliseconds, bool loopAnimation,
        bool showOnStart, bool collapseOnFinish)
    {
        var timeSpan = TimeSpan.FromMilliseconds(durationInMilliseconds);
        var doubleAnimation =
              new DoubleAnimation(fromOpacity, toOpacity,
                                  new Duration(timeSpan));
            if (loopAnimation)
                doubleAnimation.RepeatBehavior = RepeatBehavior.Forever;
            uiElement.BeginAnimation(UIElement.OpacityProperty, doubleAnimation);
            if (showOnStart)
            {
                uiElement.ApplyAnimationClock(UIElement.VisibilityProperty, null);
                uiElement.Visibility = Visibility.Visible;
            }
            if (collapseOnFinish)
            {
                var keyAnimation = new ObjectAnimationUsingKeyFrames{Duration = new Duration(timeSpan) };
                keyAnimation.KeyFrames.Add(new DiscreteObjectKeyFrame(Visibility.Collapsed, KeyTime.FromTimeSpan(timeSpan)));
                uiElement.BeginAnimation(UIElement.VisibilityProperty, keyAnimation);
            }
            return uiElement;
    }

    public static T FadeIn(this UIElement uiElement, int durationInMilliseconds)
    {
        return uiElement.FadeFromTo(0, 1, durationInMilliseconds, false, true, false);
    }

    public static T FadeOut(this UIElement uiElement, int durationInMilliseconds)
    {
        return uiElement.FadeFromTo(1, 0, durationInMilliseconds, false, false, true);
    } 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2012-02-08T14:23:31.290

我意识到这个问题有点老了，但我现在才读过它，我已经调整了 Anvaka 给出的代码。它支持绑定到 Visibility（仅当绑定模式设置为 TwoWay 时）。它还支持 FadeIn 和 FadeOut 的 2 个不同的持续时间值。

这是课程：

```
 public class VisibilityAnimation : DependencyObject
  {
    #region Private Variables

    private static HashSet<UIElement> HookedElements = new HashSet<UIElement>();
    private static DoubleAnimation FadeAnimation = new DoubleAnimation();
    private static bool SurpressEvent;
    private static bool Running;

    #endregion

    #region Attached Dependencies

    public static readonly DependencyProperty IsActiveProperty = DependencyProperty.RegisterAttached("IsActive", typeof(bool), typeof(VisibilityAnimation), new FrameworkPropertyMetadata(false, new PropertyChangedCallback(OnIsActivePropertyChanged)));
    public static bool GetIsActive(UIElement element)
    {
      if (element == null) throw new ArgumentNullException("element");
      return (bool)element.GetValue(IsActiveProperty);
    }
    public static void SetIsActive(UIElement element, bool value)
    {
      if (element == null) throw new ArgumentNullException("element");
      element.SetValue(IsActiveProperty, value);
    }

    public static readonly DependencyProperty FadeInDurationProperty = DependencyProperty.RegisterAttached("FadeInDuration", typeof(double), typeof(VisibilityAnimation), new PropertyMetadata(0.5));
    public static double GetFadeInDuration(UIElement e)
    {
      if (e == null) throw new ArgumentNullException("element");
      return (double)e.GetValue(FadeInDurationProperty);
    }
    public static void SetFadeInDuration(UIElement e, double value)
    {
      if (e == null) throw new ArgumentNullException("element");
      e.SetValue(FadeInDurationProperty, value);
    }

    public static readonly DependencyProperty FadeOutDurationProperty = DependencyProperty.RegisterAttached("FadeOutDuration", typeof(double), typeof(VisibilityAnimation), new PropertyMetadata(1.0));
    public static double GetFadeOutDuration(UIElement e)
    {
      if (e == null) throw new ArgumentNullException("element");
      return (double)e.GetValue(FadeOutDurationProperty);
    }
    public static void SetFadeOutDuration(UIElement e, double value)
    {
      if (e == null) throw new ArgumentNullException("element");
      e.SetValue(FadeOutDurationProperty, value);
    }

    #endregion

    #region Callbacks

    private static void VisibilityChanged(DependencyObject d, DependencyPropertyChangedEventArgs e)
    {
      // So what? Ignore.
      // We only specified a property changed call-back to be able to set a coercion call-back
    }

    private static void OnIsActivePropertyChanged(DependencyObject d, DependencyPropertyChangedEventArgs e)
    {
      // Get the framework element and leave if it is null
      var fe = d as FrameworkElement;
      if (fe == null) return;

      // Hook the element if IsActive is true and unhook the element if it is false
      if (GetIsActive(fe)) HookedElements.Add(fe);
      else HookedElements.Remove(fe);
    }

    private static object CoerceVisibility(DependencyObject d, object baseValue)
    {
      if (SurpressEvent) return baseValue;  // Ignore coercion if we set the SurpressEvent flag

      var FE = d as FrameworkElement;
      if (FE == null || !HookedElements.Contains(FE)) return baseValue;  // Leave if the element is null or does not belong to our list of hooked elements

      Running = true;  // Set the running flag so that an animation does not change the visibility if another animation was started (Changing Visibility before the 1st animation completed)

      // If we get here, it means we have to start fade in or fade out animation
      // In any case return value of this method will be Visibility.Visible

      Visibility NewValue = (Visibility)baseValue;  // Get the new value

      if (NewValue == Visibility.Visible) FadeAnimation.Duration = new Duration(TimeSpan.FromSeconds((double)d.GetValue(FadeInDurationProperty)));  // Get the duration that was set for fade in
      else FadeAnimation.Duration = new Duration(TimeSpan.FromSeconds((double)d.GetValue(FadeOutDurationProperty)));  // Get the duration that was set for fade out

      // Use an anonymous method to set the Visibility to the new value after the animation completed
      FadeAnimation.Completed += (obj, args) =>
      {
        if (FE.Visibility != NewValue && !Running)
        {
          SurpressEvent = true;  // SuppressEvent flag to skip coercion
          FE.Visibility = NewValue;
          SurpressEvent = false;
          Running = false;  // Animation and Visibility change is now complete
        }
      };

      FadeAnimation.To = (NewValue == Visibility.Collapsed || NewValue == Visibility.Hidden) ? 0 : 1;  // Set the to value based on Visibility

      FE.BeginAnimation(UIElement.OpacityProperty, FadeAnimation);  // Start the animation (it will only start after we leave the coercion method)

      return Visibility.Visible;  // We need to return Visible in order to see the fading take place, otherwise it just sets it to Collapsed/Hidden without showing the animation
    }

    #endregion

    static VisibilityAnimation()
    {
      // Listen for visibility changes on all elements
      UIElement.VisibilityProperty.AddOwner(typeof(FrameworkElement), new FrameworkPropertyMetadata(Visibility.Visible, new PropertyChangedCallback(VisibilityChanged), CoerceVisibility));
    }    
  } 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2014-02-27T16:45:53.857

最好使用行为来完成

```
class AnimatedVisibilityFadeBehavior : Behavior<Border>
   {
      public Duration AnimationDuration { get; set; }
      public Visibility InitialState { get; set; }

      DoubleAnimation m_animationOut;
      DoubleAnimation m_animationIn;

      protected override void OnAttached()
      {
         base.OnAttached();

         m_animationIn = new DoubleAnimation(1, AnimationDuration, FillBehavior.HoldEnd);
         m_animationOut = new DoubleAnimation(0, AnimationDuration, FillBehavior.HoldEnd);
         m_animationOut.Completed += (sender, args) =>
            {
               AssociatedObject.SetCurrentValue(Border.VisibilityProperty, Visibility.Collapsed);
            };

         AssociatedObject.SetCurrentValue(Border.VisibilityProperty,
                                          InitialState == Visibility.Collapsed
                                             ? Visibility.Collapsed
                                             : Visibility.Visible);

         Binding.AddTargetUpdatedHandler(AssociatedObject, Updated);
      }

      private void Updated(object sender, DataTransferEventArgs e)
      {
         var value = (Visibility)AssociatedObject.GetValue(Border.VisibilityProperty);
         switch (value)
         {
            case Visibility.Collapsed:
               AssociatedObject.SetCurrentValue(Border.VisibilityProperty, Visibility.Visible);
               AssociatedObject.BeginAnimation(Border.OpacityProperty, m_animationOut);
               break;
            case Visibility.Visible:
               AssociatedObject.BeginAnimation(Border.OpacityProperty, m_animationIn);
               break;
         }
      }
   } 
```

这专门应用于边框 - 我没有尝试过用户控件，但我希望同样适用。

要使用它，您需要 Blend Interactivity 命名空间：

```
xmlns:i="clr-namespace:System.Windows.Interactivity;assembly=System.Windows.Interactivity" 
```

并在您希望行为的边框上使用此标记：

```
<i:Interaction.Behaviors>
                <Interactivity:AnimatedVisibilityFadeBehavior AnimationDuration="0:0:0.3" InitialState="Collapsed" />
</i:Interaction.Behaviors> 
```

您还需要在行为类的命名空间中添加..

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2010-07-14T16:11:45.580

现在已经很老了，但你能不能把 DoubleAnimations 连起来？

```
<DataTrigger.EnterActions>
    <BeginStoryboard>
        <Storyboard>
            <DoubleAnimation
                Storyboard.TargetProperty="Opacity"
                From="0.0" To="1.0" Duration="0:0:5"
                />
            <DoubleAnimation
                Storyboard.TargetProperty="Opacity"
                From="1.0" To="0.0" Duration="0:0:5"
                />
        </Storyboard>
    </BeginStoryboard>
</DataTrigger.EnterActions> 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2011-10-06T20:14:25.207

您可能想尝试 AutoReverse 属性......虽然我不确定它是否按您想要的方式工作。这是我在 MSDN 上找到的：

当时间线的 AutoReverse 属性设置为 true 并且其 RepeatBehavior 属性导致它重复时，每次前向迭代之后都会有一个后向迭代。这样重复一次。例如，AutoReverse 值为 true 且迭代次数为 2 的时间线将向前播放一次，然后向后播放，然后再次向前播放，然后再次向后播放。

# c# - 在winforms中取消Worker线程

> ID：1013820
> 
> 赞同：4
> 
> 时间：2009-06-18T16:44:04.030
> 
> 标签：c#, winforms, multithreading, backgroundworker

我有两个列表框，一个是主人，另一个是孩子。当主节点上的索引发生变化时，子列表框会被与主节点相关的记录适当地填充。当一个主人需要很长时间才能获取所有记录并且在完成获取记录之前，用户单击另一个需要更少时间来填写的主人时，我的问题就出现了。最终会发生的情况是，即使用户不再在该主控上，花费更长时间的主控也会填充子列表框。

我一直在使用 BackgroundWorker 线程来进行填充。

```
bw_LoadAll.DoWork += new DoWorkEventHandler(bg_LoadAllWork);
bw_LoadAll.RunWorkerCompleted += new RunWorkerCompletedEventHandler(bg_LoadAllWorkCompleted);
bw_LoadAll.WorkerSupportsCancellation = true; 
```

我为 master 订阅了 SelectedIndexChanged 事件，并将 cancelled 设置为 true：

```
bw_LoadAll.CancelAsync(); 
```

这是 DoWork 方法中的代码：

```
List<object> s = Repository.Instance().LoadAll();
if (!bw_LoadAll.CancellationPending) {
    e.Result = s;
} else {
    e.Cancel = true;
} 
```

但是由于某种原因，worker完成的代码不断被调用。这是工人完成的代码：

```
if (!e.Cancelled) {
    ddl.DataSource = e.Result;
    ddl.DisplayMember = "QuickName";
    ddl.ValueMember = "ID";
} 
```

我还需要做些什么来取消这个线程的返回吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-18T16:59:50.713

您的方法 bg_LoadAllWork 应定义为：

```
void bg_LoadAllWork(object sender, DoWorkEventArgs e)
{
    // Do your work here...
} 
```

在 bg_LoadAllWork 内部，您需要检查`e.CancellationPending`，如果是，请设置`e.Cancel = true;`

最后一部分很重要 - 如果您从未设置 e.Cancel，那么您的“e.Cancelled”将永远不会等于 true。对 CancelAsync 的调用实际上并没有取消任何东西——它更像是“请求后台工作取消本身”——你必须将逻辑放在适当的位置才能导致取消。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-18T16:54:50.920

从do_work 函数中的[CodeProject](http://www.codeproject.com/KB/cpp/BackgroundWorker_Threads.aspx)中，您需要检查工作线程上的 CancellationPending，然后将 DoWorkEventArgs.Cancel 变量设置为 true。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-18T16:58:28.577

自从我使用 BackgroundWorker 以来已经有一段时间了，但是如果我没记错的话，当您调用 时，除非 LoadAllWork 检查`bw_LoadAll.CancelAsync`，否则您的方法不会实际中止。`LoadAllWork``bw_LoadAll.CancelationPending`

由[http://msdn.microsoft.com/en-us/library/system.componentmodel.backgroundworker.cancelasync.aspx](http://msdn.microsoft.com/en-us/library/system.componentmodel.backgroundworker.cancelasync.aspx)确认：*“CancelAsync 提交终止挂起后台操作的请求并将 CancellationPending 属性设置为 true。*

*当您调用 CancelAsync 时，您的工作方法有机会停止其执行并退出。工作人员代码应定期检查 CancellationPending 属性以查看它是否已设置为 true。”*

因此，在您的 SelectedIndexChanged 事件处理程序中，当您调用 时`bw_LoadAll.CancelAsync()`，它设置`bw_LoadAll.CancelationPending`为 true，但实际上并没有中止该`LoadAllWork`方法。慢加载器仍将完成。

# python - 如何编写 Perl、Python 或 Ruby 程序来更改 Windows 上另一个进程的内存？

> ID：1013828
> 
> 赞同：8
> 
> 时间：2009-06-18T16:45:46.603
> 
> 标签：python, ruby, perl, winapi, readprocessmemory

我想知道是否可以使用 Perl、Python 或 Ruby 编写程序，以便它在另一个进程的内存中查找 0x12345678（可能是堆，用于数据和代码数据），然后如果找到，请更改它到0x00000000？它类似于[Cheat Engine](http://www.cheatengine.org/)，可以在 Windows 上执行类似的操作。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-06-18T16:52:57.927

我最初认为这是不可能的，但在看到布赖恩的评论后，我搜索了 CPAN，你瞧，有[Win32::Process::Memory](http://search.cpan.org/perldoc/Win32::Process::Memory)：

```
C:\> ppm install Win32::Process::Info
C:\> ppm install Win32::Process::Memory 
```

该模块显然使用了该[`ReadProcessMemory`](http://msdn.microsoft.com/en-us/library/ms680553.aspx)功能：这是我的尝试之一：

```
#!/usr/bin/perl
use strict; use warnings;

use Win32;
use Win32::Process;
use Win32::Process::Memory;

my $process;

Win32::Process::Create(
    $process,
    'C:/opt/vim/vim72/gvim.exe',
    q{},
    0,
    NORMAL_PRIORITY_CLASS,
    q{.}
) or die ErrorReport();

my $mem = Win32::Process::Memory->new({
    pid => $process->GetProcessID(),
    access => 'read/query',
});

$mem->search_sub( 'VIM', sub {
    print $mem->hexdump($_[0], 0x20), "\n";
});

sub ErrorReport{
    Win32::FormatMessage( Win32::GetLastError() );
}

END { $process->Kill(0) if $process } 
```

输出：

```
C:\Temp> proc
0052A580 : 56 49 4D 20 2D 20 56 69 20 49 4D 70 72 6F 76 65 : VIM - Vi IMprove
0052A590 : 64 20 37 2E 32 20 28 32 30 30 38 20 41 75 67 20 : d 7.2 (2008 Aug

0052A5F0 :       56 49 4D 52 55 4E 54 49 4D 45 3A 20 22 00 :   VIMRUNTIME: ".
0052A600 : 20 20 66 61 6C 6C 2D 62 61 63 6B 20 66 6F 72 20 :   fall-back for
0052A610 : 24 56                                           : $V 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-06-18T18:42:44.583

如果您已将程序作为调试器附加到进程，则可以这样做，如果存在围绕适当 API 的包装器，或者通过诸如 ctypes（用于 python）之类的东西直接访问 Windows 函数，这在这些语言中应该是可能的。但是，使用更低级的语言可能更容易，因为在更高级别的语言中，您必须关心如何将高级数据类型转换为低级数据类型等。

首先在进程上调用[OpenProcess](http://msdn.microsoft.com/en-us/library/ms684320(VS.85).aspx)进行调试，并请求适当的访问权限（您需要成为机器上的管理员/具有相当高的权限才能获得访问权限）。然后，您应该能够调用[ReadProcessMemory](http://msdn.microsoft.com/en-us/library/ms680553(VS.85).aspx)和[WriteProcessMemory](http://msdn.microsoft.com/en-us/library/ms681674(VS.85).aspx)等函数来读取和写入该进程的内存。

**[编辑]** 这是一个快速的 Python 概念证明，该函数成功地从另一个进程的地址空间读取内存：

```
import ctypes
import ctypes.wintypes
kernel32 = ctypes.wintypes.windll.kernel32

# Various access flag definitions:
class Access:
    DELETE      = 0x00010000
    READ_CONTROL= 0x00020000
    SYNCHRONIZE = 0x00100000
    WRITE_DAC   = 0x00040000
    WRITE_OWNER = 0x00080000
    PROCESS_VM_WRITE = 0x0020
    PROCESS_VM_READ = 0x0010
    PROCESS_VM_OPERATION = 0x0008
    PROCESS_TERMINATE = 0x0001
    PROCESS_SUSPEND_RESUME = 0x0800
    PROCESS_SET_QUOTA = 0x0100
    PROCESS_SET_INFORMATION = 0x0200
    PROCESS_QUERY_LIMITED_INFORMATION = 0x1000
    PROCESS_QUERY_INFORMATION = 0x0400
    PROCESS_DUP_HANDLE = 0x0040
    PROCESS_CREATE_THREAD = 0x0002
    PROCESS_CREATE_PROCESS = 0x0080

def read_process_mem(pid, address, size):
    """Read memory of the specified process ID."""
    buf = ctypes.create_string_buffer(size)
    gotBytes = ctypes.c_ulong(0)
    h = kernel32.OpenProcess(Access.PROCESS_VM_READ, False, pid)
    try:
        if kernel32.ReadProcessMemory(h, address, buf, size, ctypes.byref(gotBytes)):
            return buf
        else:
            # TODO: report appropriate error GetLastError
            raise Exception("Failed to access process memory.")
    finally:
        kernel32.CloseHandle(h) 
```

请注意，您需要确定在内存中的哪个位置查找内容 - 大多数地址空间将被取消映射，认为有一些标准偏移量可以查找程序代码、dll 等内容。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-06-18T17:07:15.570

好吧，有趣的部分是访问其他进程的内存。CheatEngine 通过在允许内存保护失效的虚拟机下运行整个操作系统来做到这一点。还有“在调试器下运行”模型，通常意味着将目标应用程序作为修改应用程序的子进程启动，并具有提升的权限。请参阅[Win32 API](http://msdn.microsoft.com/en-us/library/ms684880(VS.85).aspx)以了解有关这方面的许多有趣内容。

在 Perl 中，一旦您获得了必要的访问权限，您可能希望使用[Win32::Security::Raw](http://search.cpan.org/~teverett/Win32-Security-0.50/lib/Win32/Security/Raw.pm)与它进行交互。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-06-18T16:59:45.550

有一些方法可以使用进程注入、延迟加载库等来做到这一点。

我没有看到您从您列出的工具中做到这一点。这是 C 和汇编语言的国家，开始让你进入病毒编写领域。一旦你让它工作，任何反病毒包都会否决它运行并尝试隔离它。所以你最好真的想要这样做。

“权力带来很多......”

祝你好运

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-08-01T11:49:49.733

可以用列出的一种语言来实现整个过程，但是编译语言对于内存扫描会更好（如果没有别的考虑，则考虑速度）。有一个名为 SigScan 的 dll（带有源代码）可用，虽然它是为特定游戏量身定制的，但可以通过最小的努力进行修改以满足您的需求。

在 Brian 的正确答案的基础上，这里有一个使用 dll 从 python 中获取地址的快速而肮脏的示例。当然，这是特定于 DLL 实现的。“模块名称”通常是作弊引擎“枚举 DLL 和符号”对话框中显示的 dll 名称。

使用 Brian 的示例作为指南和[MSDN](http://msdn.microsoft.com/en-us/library/ms681674%28VS.85%29.aspx "MSDN")，您可以使用自己的 WriteProcessMemory 方法轻松扩展它。

```
import win32defines
import win32process
import win32gui
from ctypes import *
SigScan = cdll.SigScan
kernel32 = windll.kernel32
addresses = {"Value1" : {"sigArg1" : "b0015ec390518b4c24088d4424005068", 
                          "sigArg2" : 36, 
                          "address" : None,
                          "size"    : 32
                         },
            "Value2" :{"sigArg1" : "3b05XXXXXXXX741285c0",
                          "sigArg2" : None, 
                          "address" : None,
                          "size"    : 32
                        }
        }

def read_process_mem(pid, address, size):
    """Read memory of the specified process ID."""
    buf = create_string_buffer(size)
    gotBytes = c_ulong(0)
    h = kernel32.OpenProcess(win32defines.PROCESS_VM_READ, False, pid)
    try:
        if kernel32.ReadProcessMemory(h, address, buf, size, byref(gotBytes)):
            return buf
        else:
            # TODO: report appropriate error GetLastError
            raise Exception("Failed to access process memory.")
    finally:
        kernel32.CloseHandle(h)
if __name__ == "__main__":
    pid, id = None, None
    ## HWND 
    hwnd = win32gui.FindWindowEx(0, 0, 0, "Window Name here")
    ## pid
    pid = win32process.GetWindowThreadProcessId(hwnd)[-1]
    ## Initialize the sigscan dll
    SigScan.InitializeSigScan(pid, "Module Name")
    ## Find all the addresses registered
    for key in addresses.keys():
        addresses[key]["address"] = SigScan.SigScan(addresses[key]["sigArg1"],
            addresses[key]["sigArg2"])
    ## Allow the scanner to clean up
    SigScan.FinalizeSigScan()
    for key in addresses.keys():
        if addresses[key]["address"] != None:
            print repr(read_process_mem(pid, addresses[key]["address"],
                            addresses[key]["size"]).raw)
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2017-09-16T00:14:12.653

为此，我编写了[Proc::Memory](https://metacpan.org/pod/Proc::Memory)及其底层库[libvas](https://github.com/a3f/libvas)。`{Read,Write}ProcessMemory`它只是在 Windows 上调用，但它也支持其他平台。例子：

```
my $mem = Proc::Memory->new(pid => $$); 
$mem->poke(0x12345678, 'L') = 12; 
```

# apache-flex - 使用 ActionScript 3解析标签属性的有效方法

> ID：1013831
> 
> 赞同：0
> 
> 时间：2009-06-18T16:46:14.967
> 
> 标签：apache-flex, flash, actionscript-3

我很好奇如何在 ActionScript 3 中解析 HTML 格式的内容字符串的字体属性。让我们采用以下示例内容字符串：

```
var content:String = '<font face="Archer-Bold" size="12" color="#000000">My Content</font>'; 
```

我想解析该字符串并创建一个包含字体属性的对象。因此，生成的对象将跟踪以下内容：

```
trace( fontInfo.name ); // output: "Archer-Bold"
trace( fontInfo.size ); // output: "12"
trace( fontInfo.color ); // output: "#000000" 
```

我猜正则表达式是要走的路，但我对它们一无所知。想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-18T17:02:58.697

使用 xml 对象怎么样？例如：

```
var fontnode:XML = new XML(content);
trace(fontnode.@face);
trace(fontnode.@size);
trace(fontnode.@color); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-18T21:46:32.227

这就是我想出的。这是正则表达式的理想工作：

```
<?xml version="1.0" encoding="utf-8"?>
<mx:WindowedApplication xmlns:mx="http://www.adobe.com/2006/mxml"
    creationComplete="onComplete();">

    <mx:Script>
        <![CDATA[
            import mx.controls.Alert;
            import mx.utils.ObjectUtil;
            private var targets:Array = new Array();
            private function onComplete():void {

                var face:String = null;
                var size:String = null;
                var color:String = null;

                var content:String = '<font face="Archer-Bold" size="12" color="#000000">My <br> Content</font>';

                // since the content has invalid XML <br> tag XML construction will fail:
                //var x:XML = new XML(content);

                var faces:Array = content.match(/face\s*=\s*["'](.[^"']*)["']/);
                // array is null if no matches found:
                if ( faces != null ) {
                    face = faces[1];
                }

                var sizes:Array = content.match(/size\s*=\s*["'](\d{1,})["']/);
                // array is null if no matches found:
                if ( sizes != null ) {
                    size = sizes[1];
                }

                var colors:Array = content.match(/color\s*=\s*["'](.[^"']*)["']/);
                // array is null if no matches found:
                if ( colors != null ) {
                    color = colors[1];
                }

                Alert.show("Font : " + face + ", " + size + ", " + color + "." );
            }
        ]]>
    </mx:Script>

</mx:WindowedApplication> 
```

希望有帮助。

# php - 如何在 PHP 中获取子文件的数量？

> ID：1013850
> 
> 赞同：0
> 
> 时间：2009-06-18T16:50:23.497
> 
> 标签：php, file

```
[root@file nutch-0.9]# ls resume/
crawldb  index  indexes  linkdb  segments 
```

像上面的例子，

如何在 PHP 中获取子文件的数量（可以是文件或目录）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-18T16:55:47.753

在 PHP 中使用 PHP 函数 readdir 或 scandir，将文件列表作为数组获取并获取数组的计数。您可能需要进行一些调整以避免当前目录和父目录（ . 和 .. ）

[http://us3.php.net/manual/en/function.readdir.php](http://us3.php.net/manual/en/function.readdir.php)

[http://us3.php.net/manual/en/function.scandir.php](http://us3.php.net/manual/en/function.scandir.php)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-18T16:56:45.180

```
function count_files($path) {
    return count(array_diff(scandir($path), array(".", "..")));
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-18T16:55:21.340

[readdir](http://us3.php.net/manual/en/function.readdir.php)的示例很可能是您正在寻找的。

# mysql - 我可以从完整的 mysql mysqldump 文件中恢复单个表吗？

> ID：1013852
> 
> 赞同：219
> 
> 时间：2009-06-18T16:50:32.577
> 
> 标签：mysql, backup, restore

我有我的 mysql 数据库的 mysqldump 备份，其中包含我们所有的表，大约 440 兆。我想从 mysqldump 中恢复其中一张表的内容。这可能吗？从理论上讲，我可以剪掉重建我想要的表格的部分，但我什至不知道如何有效地编辑那个大小的文本文档。

* * *

## 回答 #1

> 赞同：318
> 
> 时间：2009-06-18T17:10:27.190

您可以尝试使用 sed 来仅提取您想要的表。

假设您的表的名称是`mytable`并且文件`mysql.dump`是包含您的大转储的文件：

```
$ sed -n -e '/CREATE TABLE.*`mytable`/,/Table structure for table/p' mysql.dump > mytable.dump 
```

这将在文件中复制`mytable.dump`位于`CREATE TABLE mytable`与下`CREATE TABLE`一个表对应的下一个之间的内容。

然后，您可以调整`mytable.dump`包含表结构`mytable`和数据（列表`INSERT`）的文件。

* * *

## 回答 #2

> 赞同：143
> 
> 时间：2013-04-07T01:11:32.787

我使用了 uloBaseEI 的 sed 命令的修改版本。它包括前面的 DROP 命令，并读取直到 mysql 完成将数据转储到您的表 (UNLOCK)。为我工作（重新）将*wp_users*导入到一堆 Wordpress 网站。

```
sed -n -e '/DROP TABLE.*`mytable`/,/UNLOCK TABLES/p' mydump.sql > tabledump.sql 
```

* * *

## 回答 #3

> 赞同：55
> 
> 时间：2013-04-25T12:33:35.593

这可以更轻松地完成吗？我是这样做的：

创建一个临时数据库（例如恢复）：

> mysqladmin -u root -p 创建恢复

恢复临时数据库中的完整转储：

> mysql -u root -p 恢复 < fulldump.sql

转储您要恢复的表：

> mysqldump 恢复 mytable > mytable.sql

将表导入另一个数据库：

> mysql -u root -p 数据库 < mytable.sql

* * *

## 回答 #4

> 赞同：13
> 
> 时间：2013-08-08T09:34:24.047

一个简单的解决方案是简单地创建一个您希望单独恢复的表的转储。您可以使用 mysqldump 命令执行此操作，语法如下：

```
mysqldump -u [user] -p[password] [database] [table] > [output_file_name].sql 
```

然后正常导入，只会导入转储的表。

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2009-06-18T16:57:00.700

无论哪种方式，任何执行此操作的进程都必须遍历转储的整个文本并以某种方式对其进行解析。我只是为了

```
INSERT INTO `the_table_i_want` 
```

并将输出通过管道传输到 mysql。看一下转储中的第一个表，以确保您以正确的方式获得 INSERT。

编辑：好的，这次格式正确。

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2015-02-23T08:24:08.137

1.  备份

    ```
    $ mysqldump -A | gzip > mysqldump-A.gz 
    ```

2.  恢复单表

    ```
    $ mysql -e "truncate TABLE_NAME" DB_NAME
    $ zgrep ^"INSERT INTO \`TABLE_NAME" mysqldump-A.gz | mysql DB_NAME 
    ```

* * *

## 回答 #7

> 赞同：7
> 
> 时间：2013-09-18T12:40:00.760

您应该尝试 @bryn 命令，但使用 ` 分隔符，否则您还将提取具有前缀或后缀的表，这是我通常做的：

```
sed -n -e '/DROP TABLE.*`mytable`/,/UNLOCK TABLES/p' dump.sql > mytable.sql 
```

同样出于测试目的，您可能希望在导入之前更改表名：

```
sed -n -e 's/`mytable`/`mytable_restored`/g' mytable.sql > mytable_restored.sql 
```

要导入，您可以使用 mysql 命令：

```
mysql -u root -p'password' mydatabase < mytable_restore.sql 
```

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2009-06-18T16:57:48.610

解决此问题的一种可能方法是恢复到临时数据库，并仅从临时数据库中转储该表。然后使用新脚本。

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2016-07-12T16:59:22.197

```
sed -n -e '/-- Table structure for table `my_table_name`/,/UNLOCK TABLES/p' database_file.sql > table_file.sql 
```

这是比上述其他一些解决方案更好的解决方案，因为并非所有 SQL 转储都包含`DROP TABLE`语句。这将适用于各种转储。

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2011-12-14T12:41:20.830

这个工具可能就是你想要的：tbdba-restore-mysqldump.pl

[https://github.com/orczhou/dba-tool/blob/master/tbdba-restore-mysqldump.pl](https://github.com/orczhou/dba-tool/blob/master/tbdba-restore-mysqldump.pl)

例如从数据库转储文件中恢复一个表：

> tbdba-restore-mysqldump.pl -t yourtable -s yourdb -f backup.sql

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2018-09-21T09:46:51.403

表在转储和数据库中应具有相同的结构。

```
`zgrep -a ^"INSERT INTO \`table_name" DbDump-backup.sql.tar.gz | mysql -u<user> -p<password> database_name` 
```

或者

```
`zgrep -a ^"INSERT INTO \`table_name" DbDump-backup.sql | mysql -u<user> -p<password> database_name` 
```

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2014-01-02T14:45:26.400

这也可能有帮助。

```
# mysqldump -u root -p database0 > /tmp/database0.sql
# mysql -u root -p -e 'create database database0_bkp'
# mysql -u root -p database0_bkp < /tmp/database0.sql
# mysql -u root -p database0 -e 'insert into database0.table_you_want select * from database0_bkp.table_you_want' 
```

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2009-06-18T16:58:53.240

如果您的系统能够满足要求，大多数现代文本编辑器应该能够处理该大小的文本文件。

无论如何，我必须非常快地完成一次，我没有时间找到任何工具。我设置了一个新的 MySQL 实例，导入了整个备份，然后只输出了我想要的表。

然后我将该表导入主数据库。

这很乏味但相当容易。祝你好运。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2014-07-31T18:38:41.563

前面提到的“sed”解决方案很好，但如上所述不是 100% 安全的

*   您可能有包含数据的 INSERT 命令：... CREATE TABLE...(whatever)...mytable...

*   甚至是确切的字符串“CREATE TABLE `mytable`;” 例如，如果您要存储 DML 命令！

（如果表格很大，您不想手动检查）

我将验证所使用的转储版本的确切语法，并进行更严格的模式搜索：

避免使用“.*”并使用“^”来确保我们从行首开始。而且我更愿意抓住最初的“DROP”

总而言之，这对我来说效果更好：

```
sed -n -e '/^DROP TABLE IF EXISTS \`mytable\`;/,/^UNLOCK TABLES;/p' mysql.dump > mytable.dump 
```

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2015-02-02T07:28:34.387

您可以使用 vi 编辑器。类型：

```
vi -o mysql.dump mytable.dump 
```

打开整个转储`mysql.dump`和一个新文件`mytable.dump`。通过按找到适当的插入行`/`，然后键入一个短语，例如：“插入到`mytable`”，然后使用复制该行`yy`。切换到下一个文件`ctrl+w`，`down arrow key`粘贴复制的行`pp`。`:wq`最后通过键入和相当 vi 编辑器保存新文件`:q`。

`Nyy`请注意，如果您已使用多个插入转储数据，则可以使用其中`N`要复制的行数一次复制（拉出）所有数据。

我用一个 920 MB 大小的文件完成了它。

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2016-04-22T14:55:48.583

我尝试了一些选项，但速度非常慢。这会在几分钟内将 360GB 的转储拆分到其表中：

[如何将 mysqldump 的输出拆分为较小的文件？](https://stackoverflow.com/questions/132902/how-do-i-split-the-output-from-mysqldump-into-smaller-files#answer-9949414)

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2009-06-18T17:04:42.843

获得像 Notepad++ 或 Vim 这样的体面的文本编辑器（如果您已经精通它）。搜索表名，您应该能够仅突出显示该表的 CREATE、ALTER 和 INSERT 命令。使用键盘而不是鼠标进行导航可能更容易。而且我会确保你在一台有大量内存的机器上，这样一次加载整个文件就不会出现问题。一旦您突出显示并复制了您需要的行，最好将复制的部分备份到它自己的备份文件中，然后将其导入 MySQL。

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2009-06-18T18:24:02.443

SQL 的块被“表的表结构`my_table`”和“表的转储数据”阻止`my_table`。

您可以按如下方式使用 Windows 命令行来获取各个部分的行号。根据需要调整搜索的字符串。

查找 /n "for table `" sql.txt

将返回以下内容：

---------- SQL.TXT

[4384]-- 表的表结构`my_table`

[4500]-- 转储表的数据`my_table`

[4514]-- 表的表结构`some_other_table`

... ETC。

这会给你你需要的行号......现在，如果我只知道如何使用它们......调查。

* * *

## 回答 #19

> 赞同：-1
> 
> 时间：2021-02-22T09:20:11.470

**您可以使用终端线导入单个表，如下所示。** 这里将单个用户表导入特定的数据库。

`mysql -u root -p -D my_database_name < var/www/html/myproject/tbl_user.sql`

* * *

## 回答 #20

> 赞同：-3
> 
> 时间：2021-06-19T12:01:39.187

我很佩服这里的一些独创性，但实际上根本没有理由使用它`sed`来解决 OP 的问题。

注释“use --one-database”是正确的答案，内置于 MySQL/MariaDB。无需第三方黑客。

`mysql -u root -p databasename --one-database < localhost.sql`只会导入所需的数据库。

我还发现在某些情况下，当使用它导入一系列数据库时，它会为我在列表中创建下一个数据库（但不会在其中放入任何内容）。不知道为什么这样做，但它使恢复更容易。

使用此命令，以交互方式输入密码，它将导入请求的数据库。

# repository - 存储库模式和业务逻辑

> ID：1013855
> 
> 赞同：12
> 
> 时间：2009-06-18T16:50:51.843
> 
> 标签：repository, repository-pattern

我有一个`CustomerRepository`从数据层检索数据的存储库 ()。大多数业务逻辑位于`Customer`存储库接受或返回的实体类 ( ) 中。

但是，您将全局实体业务逻辑（适用于所有客户）放在哪里？

例如，我可能不想将所有客户返回给某些用户。我不想将该逻辑放在存储库中。

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2009-06-18T17:17:27.993

我同意罗伯特·蒙泰努的观点。

基本上，您将模型中不固有的业务逻辑汇总到中间层。中间层是业务层/业务对象/业务逻辑层/等，但简称为服务层。它不一定是 Web 服务，它是对术语服务的广泛使用，因为它聚合了特定应用程序领域的功能。

您基本上会有一个包含存储库引用的 CustomerService 类。您的表示层将引用服务层类。

可以根据您使用的 .net 的名称猜测另外一个区别，并且可能使用 LINQ to SQL 作为您的存储库，如 NerdDinner 中所述。

Repository 通常将 IQueryable 返回给服务层，允许服务层将多个查询链接在一起以构建不同的结果集。然后，服务使用 ToList 或其他类似方法评估表达式并将其返回到表示层。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-06-18T17:02:56.170

将其放入另一个存储库 (BusinessRuleRepository) 并让 CustomerRepository 使用它。

**或者**

如果业务逻辑只是限制用户可以看到的结果，您可能希望将 Facade 模式与工厂一起使用。在这种情况下，您将拥有一个处理您的 CustomerRepository 和 LimitedCustomerRepository（可能封装 CustomerRepository）的 ICustomerRepository，以及一个为用户返回适当的 ICustomerRepository 的 CustomerRepositoryFactory。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-06-18T16:52:09.767

将其包裹在服务后面。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-03-02T18:08:41.153

我认为将这些类型的功能分离到一个服务层是要走的路。

我最近建立了一个系统，使用历史数据对许多实体进行复杂的预测。将所有数据访问位放入每个实体的存储库中。我将复杂的预测逻辑保存在服务层中，并根据需要传递存储库对象。

额外的好处是，我有一种简单的方法，只需创建一个 Web api 层，就可以将所有预测逻辑暴露给外部系统。

# vba - 我如何知道一个对象是否已经被引用？

> ID：1013860
> 
> 赞同：1
> 
> 时间：2009-06-18T16:51:24.340
> 
> 标签：vba, excel, excel-2003, nothing

在附加到 Excel 2003 电子表格的一些 VBA 中，我需要使用一些需要一段时间才能实例化的对象 - 所以我只想做一次“设置”的事情......

显示代码比编写解释更容易！

```
' Declare the expensive object as global to this sheet
Dim myObj As SomeBigExpensiveObject

Private Sub CommandButtonDoIt_Click()

   ' Make sure we've got a ref to the object
   If IsEmpty(myObj) Then  ' this doesn't work!
      Set myObj = New SomeBigExpensiveObject
   End If

   ' ... etc

End Sub 
```

如何检查 myObj 是否已设置？

我已经尝试过 IsNull(myObj) 和 IsEmpty(myObj) - 无论 myObj 的状态如何，都跳过“设置”。我做不到

```
if myObj = Nil then 
```

或者

```
if myObj = Empty then 
```

或者

```
if myObj = Nothing then 
```

有任何想法吗？

萨尔瓦多

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-06-18T16:57:16.520

这应该有效：

```
 If myObj IS Nothing Then 
```

（注意“IS”）如果这不起作用，则必须由该类专门实现异步初始化，因为默认情况下 COM 初始化调用是同步的。因此，您需要查看文档或与开发人员讨论 Big 类的某些属性或同步方法，以便您等待。

# asp.net - 使用来自 Asp.net 的 Microsoft Exchange 电子邮件

> ID：1013866
> 
> 赞同：1
> 
> 时间：2009-06-18T16:52:51.203
> 
> 标签：asp.net, exchange-server

我想使用/拥有一个像邮箱一样工作的应用程序，或者更好地说是邮件服务器，我的意思是我想要一个简单的页面，在后台链接到交换服务器，接收所需的信息，如发件人、目的地、主题，文本消息，最后是附件，然后是发送按钮，通过单击将邮件发送到目的地（当然使用指定的交换服务器）。

任何帮助，将不胜感激

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-18T16:55:47.143

[使用 .net 发送邮件](http://www.developer.com/net/asp/article.php/3096831)

[![替代文字](../Images/51d42731703e6a6c358b01807e92e609.png)](https://i.stack.imgur.com/6xsV3.jpg)
[（来源：[developer.com](http://www.developer.com/img/articles/2003/10/22/ASP/EMail.jpg)）]

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-18T17:05:17.460

它需要使用 MAPI 还是只使用 SMTP？如果是前者，祝你好运。我知道没有好的组件。如果是后者，那么您可以使用普通`System.Net.Mail`库。如果您在 Exchange 2007 上，最后一个选择是使用 Web 服务 API，但我对它还不够熟悉，不知道您是否可以通过它发送邮件。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-18T17:32:12.497

```
 Imports System.Net.Mail

    Public Sub SendMail()
         Dim msg As New MailMessage("from@stackoverflow.com", "you@stackoverflow.com", "Your Subject Line", "The body of the message")
         Dim client = New SmtpClient("SERVERNAME")
         client.Send(msg)
    End Sub 
```

# ruby-on-rails - 快速的 Ubuntu + Rails 服务器的建议

> ID：1013867
> 
> 赞同：3
> 
> 时间：2009-06-18T16:52:52.200
> 
> 标签：ruby-on-rails, apache, ubuntu, passenger

我使用 Apache + Passenger（= Mod Rails）、MySQL 和 Acts_As_Ferret（在服务器模式下）运行 Ubuntu 8.04 共享主机（VMWare）。第一次请求太慢了。我对它做了很多 REST 操作，但用户很少。

现在我想做一个全新的安装......

***对于真正快速的 RoR 服务器，您推荐哪种设置（基于 Ubuntu）？***（例如 Ngnix、Thin、Mongrels 或其他花哨的东西）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-19T08:20:58.293

乘客在第一次请求时很慢，因为它处于空闲状态并且它关闭了所有 rails 进程，因此第一个请求必须加载 rails 进程。您需要定期 ping 以避免它空闲和关闭 rails 进程，或者将空闲超时设置为高值。

查看 RailsPoolIdleTime 的文档

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-18T16:54:21.997

好吧，您可以通过切换到 Ubuntu 9.04 甚至 8.10 来大幅提升速度

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-18T17:00:36.577

检查 ec2onrails 邮件列表，其中有很多关于各种瘦/nginx/passenger/apache 替代方案和排列的讨论，以及基于一些体面测试发布的一些硬数据。

您还会发现一个很好的打包 RoR/Ubuntu 堆栈，其形状为 ec2onrails 映像（google ec2onrails）——它用于在亚马逊 EC2 云上运行，但其中有很多好东西 + capistrano 任务。目前它基于 apache，但正在进行的版本正在寻找替代方案。没有理由您不能对非 EC2 服务器使用相同的构建脚本。

如果您的问题只是最初的请求，请在考虑将其上线之前尝试预热您的服务器（例如，通过运行脚本来自动执行基本操作）。

哦，我应该补充一下 - 你确定问题出在你的堆栈上吗？更有可能是您的代码。可能值得先看看瓶颈在哪里，以及从缓存、改进的查询和索引，尤其是在调整其他任何内容之前的 memcached 中可以得到什么。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-18T17:17:05.963

我个人在我的 ubuntu 堆栈上使用 nginx+passenger。并使用狮身人面像代替雪貂

# wpf - 无法使用 DataBinding 更新文本框属性

> ID：1013871
> 
> 赞同：1
> 
> 时间：2009-06-18T16:53:04.947
> 
> 标签：wpf, data-binding, binding, textblock

我有一个自定义窗口，它有两个依赖属性：布尔值？ValidationStatus 和字符串 ValidationMessage。绑定这些属性可以正常工作，但是当这些值更改时似乎不会触发触发器。我究竟做错了什么？

```
<TextBlock x:Name="validationTextBox" 
    Grid.Row="1" 
    Grid.ColumnSpan="2" 
    Text="{Binding ElementName=_this, Path=ValidationMessage}"
    TextAlignment="Center"
    Background="Green">

    <TextBlock.Style>
      <Style>
        <Style.Triggers>
          <DataTrigger Value="False" Binding="{Binding ElementName=_this, Path=ValidationStatus}">
            <Setter Property="Panel.Background" Value="Red"/>
            <Setter Property="TextBox.Text" Value="Outer checkbox is not checked"/>
          </DataTrigger>
        </Style.Triggers>
      </Style>
    </TextBlock.Style>

</TextBlock> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-18T17:27:06.327

样式设置器不会覆盖本地属性设置。因此，数据触发器的值将被忽略，因为您已在 TextBlock 上指定了 Text 和 Background 属性。要解决此问题，请在样式中设置这些属性的默认值，如以下代码所示：

```
<TextBlock x:Name="validationTextBox" 
           Grid.Row="1" 
           Grid.ColumnSpan="2" 
           TextAlignment="Center">

<TextBlock.Style>
  <Style>
    <Setter Property="TextBox.Text" Value="{Binding ElementName=_this, Path=ValidationMessage}"/>
    <Setter Property="TextBox.Background" Value="Green"/>
    <Style.Triggers>
      <DataTrigger Value="False" Binding="{Binding ElementName=_this, Path=ValidationStatus}">
        <Setter Property="TextBox.Background" Value="Red"/>
        <Setter Property="TextBox.Text" Value="Outer checkbox is not checked"/>
      </DataTrigger>
    </Style.Triggers>
  </Style>
</TextBlock.Style> 
```

# oracle - 如何多次填充可变数组

> ID：1013874
> 
> 赞同：0
> 
> 时间：2009-06-18T16:54:09.017
> 
> 标签：oracle, plsql

我有一个脚本多次使用一个 VARRAY。但是，我似乎无法弄清楚如何在循环一次之后重置 VARRAY。我编写了以下基本脚本来帮助我进行故障排除：

```
DECLARE
   TYPE multi_show_id_type IS VARRAY (60) OF VARCHAR2 (10);

   multi_show_id multi_show_id_type := multi_show_id_type ();
   counter       NUMBER := 1;
   i             NUMBER := 1;
BEGIN
   DBMS_OUTPUT.put_line ('BEGIN');

   WHILE i < 10
   LOOP
      DBMS_OUTPUT.put_line (i);
      --counter:=0;
      --multi_show_id :=multi_show_id_type();
      --multi_show_id.delete;

      WHILE counter < 25
      LOOP
         multi_show_id.EXTEND ();
         multi_show_id (counter) := counter * counter;
         DBMS_OUTPUT.put_line ('VArray: [' || counter || '] [' || multi_show_id (counter) || ']');

         counter := counter + 1;
      END LOOP;
      i := i + 1;
   END LOOP;

   DBMS_OUTPUT.put_line ('END');
END;
/ 
```

该脚本仅在数组中循环一次时有效。但是，如果您取消注释该`counter:=0`行，这会强制它在数组填充循环中循环 10 次，我会收到`ORA-06532`错误消息。您可以在其他注释行中看到我尝试过的一些内容。任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-18T18:23:07.577

实际上，@akf 是正确的；您编写的代码将不起作用，因为 VARRAY 从第 1 项开始，而不是从零开始。

因此更改您的代码并且它可以工作：

```
 ...
   LOOP
          DBMS_OUTPUT.put_line (i);
          counter:=1;
          --multi_show_id :=multi_show_id_type();
          multi_show_id.delete;

          WHILE counter < 26
          LOOP
            ... 
```

编辑：如果你想通过循环运行 25 次，你需要将 WHILE 循环上限更改为 26...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-18T17:11:53.303

这里似乎有两个问题。首先，VARRAY 索引从 1 开始。其次，根据声明中的定义，一旦 VARRAY 已满 60 个项目，您将停止。

使用以下内容：

`TYPE multi_show_id_type IS VARRAY (250) OF VARCHAR2 (10);`

和

`counter:=1;`

`multi_show_id :=multi_show_id_type();`如果您想为每个循环从 1 开始，请取消注释该行。如果你想确保不超过 4 个值，你的内部 while 循环应该做出这个限制。

# asp.net - 将arraylist绑定到网格视图（部分......）

> ID：1013881
> 
> 赞同：0
> 
> 时间：2009-06-18T16:55:07.363
> 
> 标签：asp.net, vb.net, data-binding

好吧，我对这个真的很愚蠢......

我有这堂课：

```
Public Class whatever
Public id as string
Public name as string
public date as string
end class 
```

我与此代码一起使用：

```
dim personlist as new arraylist

dim person as new whatever
person.id="1"
person.name="bozo"
person.date="6-6-6"
personlist.add(person) 
```

然后我重复，这样我就可以用我想在我的gridview中显示的所有信息填充我的arraylist。

问题是这样的：

```
gridview1.datasource = personlist
gridview1.databind() 
```

执行时，我收到一条错误消息：

```
The data source for GridView with id 'gdpersonlist' did not have any properties or attributes from which to generate columns.  Ensure that your data source has content. 
```

谁能帮助我或者指出我正确的方向来做到这一点？！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-18T17:00:32.163

尝试使用属性而不是字段。网格视图的数据绑定不适用于字段。

```
Public Class whatever
  Public _id as string
  Public name as string
  public date as string

  Public Property Id As String 
    Get 
      Return _id
    End Get
    Set (value as String )
      _id = value
    End Set
  End Property

  ' repeat for all 3 fields
end class 
```

# c++ - 初始化原始类型时哪个更有效？

> ID：1013891
> 
> 赞同：2
> 
> 时间：2009-06-18T16:56:45.147
> 
> 标签：c++, performance

在声明原语时，使用赋值运算符或复制构造函数是否重要？哪一个提供了最佳性能，或者当今大多数编译器是否将这两个语句编译为相同的机器代码？

```
int i = 1;
int j( 1 ); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-18T17:01:22.503

同样适用于：

```
 int i = 1;
  int j( 1 ); 
```

不是为了：

```
 Cat d;
  Cat c1;
  c1 = d;
  Cat c2(d);//<-- more efficient 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-18T16:59:24.363

我相当确定它们是相同的，但是如果您进行静态初始化，则在运行时没有初始化，该值内置到二进制文件中。

```
static int i = 1; 
```

但是，考虑到关键字 static 的含义，这并不总是合适的。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-18T17:02:33.750

我认为两者的编译方式相同；只需使用您认为对您和其他可能阅读您的代码的人来说最易读的那个。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-18T17:07:03.480

In general, this question can't be answered. For primitive types a good compiler will reduce them to the same Assembly instructions, but for user-defined types (which is to say, classes) you're at the mercy of whoever wrote the copy and assignment operators. I've seen code where one was faster than the other by an order of magnitude, because the person who wrote the copy constructor wasn't the same as the person who wrote the assignment operator -- and one of them did it smart and one of them didn't.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-18T17:30:48.193

In the case of a single primitive type it's not going to matter.

When it can matter is when you have an aggregate of primitive types. In other words, a [POD](http://www.parashift.com/c++-faq-lite/intrinsic-types.html#faq-26.7). In that case, there is no more efficient way to instantiate it that by using the aggregate initializer syntax:

```
struct POD
{  
  int n;
  double d;
  bool b;
}; 
```

If that's your POD, then this:

```
POD pod = {1, 3.14, true}; 
```

...can't be beat in terms of efficiency.

# c# - 是否可以创建作为 EXE 或 Windows 服务部署的独立 C# Web 服务？

> ID：1013896
> 
> 赞同：22
> 
> 时间：2009-06-18T16:57:35.833
> 
> 标签：c#, web-services, windows-services, embeddedwebserver

是否可以创建可以处理 Web 服务请求的 C# EXE 或 Windows 服务？显然，某种嵌入式（可能是有限的）Web 服务器必须是 EXE/服务的一部分。EXE/服务不必依赖安装的 IIS。优选地，嵌入式网络服务可以处理 HTTPS/SSL 类型的连接。

场景是这样的：客户想要在他们的公司机器上安装一个小型代理（Windows 服务）。该代理将有两个主要任务：1) 随着时间的推移监控系统并收集某些数据；2) 响应 Web 服务请求（SOAP -v- REST 仍在讨价还价）以用于数据收集或系统更改目的。客户喜欢 Web 服务 API 的想法，因此可以编写任意数量的客户端（使用任何语言）来接入公司机器上运行的各种代理。他们希望安装相对轻松（安装 .NET、一些程序集、服务、修改 Windows 防火墙、启动服务），而不需要安装和配置 IIS。

我知道我可以用 Delphi 做到这一点。但如果可能，客户更愿意在 C# 中完成此操作。

有什么建议么？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-06-18T17:09:43.803

是的，有可能，您可能想看看[WCF](http://msdn.microsoft.com/en-us/netframework/aa663324.aspx)和[Self Hosting](http://msdn.microsoft.com/en-us/library/bb332338.aspx)。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-06-18T17:02:15.000

是的，这是可能的（而且相当容易）。

这是一篇[CodeProject 文章](http://www.codeproject.com/KB/IP/CSHTTPServer.aspx)，展示了如何在 C# 中制作基本的 HTTP 服务器。这可以很容易地放入独立的 EXE 或服务中，并用作 Web 服务。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-06-18T17:07:11.593

您可能想要检查的一项技术是 WCF。进入 WCF 可能会有点痛苦，但是 Keith Elder 在 DNRTV 上有一个很棒的截屏视频，展示了如何以非常简单的方式开始使用 WCF。

[http://www.dnrtv.com/default.aspx?showNum=135](http://www.dnrtv.com/default.aspx?showNum=135)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-18T17:12:56.047

您可以查看.Net 框架中的[HttpListener](http://msdn.microsoft.com/en-us/library/system.net.httplistener.aspx)。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-18T17:13:16.810

我强烈推荐 WCF。它非常适合您所描述的产品。有很多可用的[书籍](http://www.amazon.com/s/qid=1245345124/ref=sr_kk_2?ie=UTF8&search-alias=stripbooks&field-keywords=wcf)。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-06-18T17:40:32.937

当然，你可以这样做。请务必将项目的输出类型更改为控制台应用程序。然后，在您的 Main 函数中，添加一个 string[] 参数。关闭您在命令行上收到的某个开关，您可以分支到 ServiceBase.Run 以作为 Windows 服务运行，或者分支到其他代码以运行控制台应用程序。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2020-08-05T10:07:38.373

这个问题有点老，但由于我前段时间需要类似的东西，所以感觉这个问题仍然相关。

我用 NancyFx 和 OWIN 编写了一个小的 Rest-API。OWIN 是 .Net 应用程序和 Web 服务器之间的标准接口。使用 OWIN 可以创建[自托管的 WEB-API](https://docs.microsoft.com/en-us/aspnet/web-api/overview/hosting-aspnet-web-api/use-owin-to-self-host-web-api)。另一方面，南希是

> 一个轻量级、低俗的框架，用于在 .NET 上构建基于 HTTP 的服务[¹](https://github.com/NancyFx/Nancy/wiki/Introduction)

这两者的结合使得创建自托管 C# Web 服务成为可能。我很确定现在有更多的可能性来创建这样的东西，但由于我这样使用它，我认为这些信息可能对某人有用。

# iphone - 管理多个视图和交互

> ID：1013902
> 
> 赞同：0
> 
> 时间：2009-06-18T16:58:48.280
> 
> 标签：iphone

我有一个表，其中包含 4 种不同类型的数据，并且根据用户选择的数据类型，会显示一个特定的编辑视图。其中一个视图有一个编辑字段，第二个视图有 2 个编辑字段，第三个视图使用选择器，依此类推。处理这些不同视图的最佳方法是什么，而不需要大量的类，也不需要“切换”来弄清楚我正在使用哪些数据？

我能想到的一种方法是让 4 个不同的视图控制器具有各自的视图，然后在表中选择特定项目时启动每个控制器，但是还有另一种优雅的方法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-18T17:47:44.907

您可以使用四个不同的视图控制器，也可以使用一个视图控制器在初始化时接受参数来创建内容。当视图非常相似（相同控件的不同数量等）时，第二种方法似乎效果更好。
对于您的情况，有些视图有选择器，有些有文本字段......似乎最好只创建每个都有不同的视图控制器。有了这个，即使需要维护的代码稍微多一些，您也可以在以后获得更多的灵活性。

# ruby-on-rails - 在 Rails 中 A/B 测试电子邮件主题行的最佳方法是什么？

> ID：1013913
> 
> 赞同：0
> 
> 时间：2009-06-18T17:01:38.043
> 
> 标签：ruby-on-rails, email

我在我最新的 Rails 应用程序中发送了很多电子邮件。我想对发出的电子邮件中的主题行进行 A/B 测试。理想情况下，我可以捕捉到两件事。

1- 打开率 2- 电子邮件中的号召性用语是否被点击

关于如何做到这一点的任何想法？我不认为（伟大的）7 分钟 abs（[http://github.com/paulmars/seven_minute_abs/tree/master](http://github.com/paulmars/seven_minute_abs/tree/master)）会这样做，因为在模型中设置了@subject，而查询字符串的 ab 测试参数是在视图中分配，并且测试版本可能会有所不同。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-11-28T00:50:11.793

[Vanity](https://github.com/assaf/vanity) gem 还包括对电子邮件的A/B 测试支持，请参阅[文档](http://vanity.labnotes.org/email.html)。它内置了对通过跟踪像素（图像）分割内容和测量结果的支持。

例如，创建实验：

```
ab_test "Invite subject" do
  description "Optimize invite subject line"
  alternatives "Join now!", "You're invited to an exclusive event."
  metrics :open
end 
```

拆分电子邮件中的用户：

```
class UserMailer < ActionMailer::Base 
  def invite_email(user)
    use_vanity_mailer user
    mail :to => user.email, :subject =>ab_test(:invite_subject)
  end
end 
```

并通过跟踪像素测量结果：

```
 <html>
    <body>
      <h1>Hey Joseph</h1>
      <p>
        <%= vanity_tracking_image(Vanity.context.vanity_identity, :open, :host => "127.0.0.1:3000") %>
      </p>
    </body>
  </html> 
```

[免责声明：我确实帮助维护虚荣宝石。]

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-19T02:11:26.420

我也一直在看这个。7 分钟绝对是一个不错的 A/B 解决方案，但我认为对于电子邮件，您可以相对轻松地自己完成。如果您有用于开放检测的专用图像（例如不可见的“错误”图像），或者只是始终包含的图像，您可以在其上放置一个参数，或者更确切地说，只是在您的 Web 服务器中为其设置别名，或者不为它取别名，只需复制图像，例如“open_a.gif”和“open_b.gif”，然后查看您的分析或网络日志以跟踪哪个打开得更多。如果您不需要将其与电子邮件收件人相关联，那么您可以简单地使用 A 图像发送一半的电子邮件，使用 B 图像发送一半的电子邮件，等等。正如您提到的情况＃2 的电子邮件中的 URL，这可能是一个简单的 URL 参数或路径，

如果可以为您工作，Campaign Monitor 解决方案和一般的 Campaign Monitor 都非常出色。我们将 Campaign Monitor 用于我们的时事通讯电子邮件，但不能用于我们发送的所有个性化电子邮件。如果您向所有用户发送相同的电子邮件，那么无论如何，我会使用 Campaign Monitor，但如果每封邮件都是个性化的，您可能需要自己滚动。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-18T17:05:44.870

您能否发送一个自定义注册链接，该链接末尾有一个查询字符串，例如 example.com/signup?one 或 example.com/signup?two，然后在注册时检查该查询字符串？

我知道这不是 Ruby on Rails，但可能值得一看，看看他们打算如何做。

> [http://www.campaignmonitor.com/blog/post/2782/ab-testing/](http://www.campaignmonitor.com/blog/post/2782/ab-testing/)

# c# - 处理派生列表中不同类的对象 班级

> ID：1013915
> 
> 赞同：1
> 
> 时间：2009-06-18T17:01:58.540
> 
> 标签：c#

我有几个类（A、B、C、...），它们都使用 a`List<AnotherClass>`来存储对“其他”对象的引用。但是“其他”对于每个 A、B、C 类都是不同的。所以 A 类包含`List<Class_X>` B`List<Class_Y>` 类包含 C 类包含`List<Class_Z>`

而不是在 A、B、C 中实现添加/删除/搜索（等）功能，对我来说创建一个类似乎是合乎逻辑`ListRef<T>`的`List<T>`

```
public class ListRef<T>: List<T>
{
    protected ListRef<T> ListOfObjects = null;
    protected string name = null;

    public ListRef<T>
    {
        ListOfObjects = new ListRef<T>();
    }
} 
```

使用上面的代码（这是我想要的正确代码吗？）我不知道如何提供正确的类（Class_X，Class_Y，Class_Z）替换/指定`<T>`每个类的构造函数（A，B，C ) 将使用 ListRef。

在类 AI 的构造函数中想写如下内容：

```
public A() : base<Class_X>
{
} 
```

如何从 WITHIN 类 A 中指定需要在 ListOfObjects 中存储什么样的对象？

我宁愿不写

```
public A()
{
    ListOfObjects = new ListRef<Class_X();
} 
```

因为我想让 ListOfObjects 声明为**私有**而不是**受保护**

* * *

在 Listref 中，我只想能够添加、删除、搜索对象。所以我实际上并没有使用这些类（Class_X、Class_Y、Class_Z）。

目前我有

```
public class A
{
     private List<Class_X> ListOfObjects = null;
     A()
     {
         ListOfObjects = new List<Class_X>();
     }

     public void Add(string Name)
     {
        Class_X Object = new Class_X(Name);
        ListOfObjects.Add(Object);
     }
     public void Delete(Class_X Object)
     {
        ListOfObjects.Remove(Object);
     }
} 
```

以及 B 类（使用 Class_Y）和 C 类（使用 class_Z）的相同类型的代码。对我来说，使用一个类 ListRef 来执行添加和删除操作并维护我使用的所有类的列表似乎是合乎逻辑的。（当然真实的代码更复杂）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-18T17:13:46.047

以下是我推荐的方法...

```
public class ABC_Base<TChild>
{
    public IEnumberable<TChild> Children { get; set; }

    public void AddChild(TChild item) 
    {
    }

    public void RemoveChild(TChild item)
    {
    }

    //etc
}

public class A : ABC_Base<X> // X is the type for your child
{

}

//Used like so...
A myA = new A();

myA.AddChild(new X());

// or if you are wanting to specify when created then this...

public class A<TChild> : ABC_Base<TChild>
{
}

//Used like so...
A myA = new A<X>();
A myOtherA = new A<Y>();

myA.Addchild(new X());
myOtherA.AddChild(new Y()); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-18T17:28:26.153

如果我正确理解你的问题，听起来你想要做的是创建一组 A、B、C 等类。每个类都管理一些其他类型（X、Y、Z）的集合——但你不不想在 A、B 和 C 之间复制一些列表管理逻辑。

有两种不同的方法可以实现这一目标。

**首先，继承方法：**您可以给 A、B 和 C 一个通用的通用基类，该基类根据每个将管理的项目的类型进行参数化。这是一个代码示例：

```
public abstract class ABCBase<T>
{
   protected IList<T> m_List = new List<T>();

   // methods that manage the collection
   // I chose to make the virtual so that derived 
   // classes could alter then behavior - may not be needed
   public virtual void Add( T item )    { ... }
   public virtual void Remove( T item ) { ... }
   public virtual int  Find( T item )   { ... } 
}

public class A : ABCBase<X> { ... }

public class B : ABCBase<Y> { ... }

public class C : ABCBase<Z> { ... } 
```

**其次，是组合方法：**为您的集合创建一个管理器类，该类实现对子列表的操作，并将其聚合到 A、B 和 C 中的每一个中：

```
public class ListManager<T>
{
   private IList<T> m_List = new List<T>();

   public void Add( T item )    { ... }
   public void Remove( T item ) { ... }
   public int  Find( T item )   { ... }
}

public class A
{
   public ListManager<X> ListOfX { get; protected set; }

   public A() { ListOfX = new ListManager<X>(); }
}

public class B
{
   public ListManager<Y> ListOfX { get; protected set; }

   public B() { ListOfY = new ListManager<Y>(); }
}

public class C
{
   public ListManager<Z> ListOfX { get; protected set; }

   public C() { ListOfX = new ListManager<Z>(); }
} 
```

**您还可以选择混合使用这两种方法——**创建一个列表管理类，但也为 A、B、C 创建基类（或接口）——以便每个都公开一个一致的属性 ChildList（或一些这样的属性），消费者可以在没有的情况下使用总是必须知道类型实际类型 A、B、C。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-18T17:10:42.947

怎么样

```
public interface ISomeOtherClass
{
}

public class Class_X : ISomeOtherClass
{
}

public class Class_Y : ISomeOtherClass
{
}

public class BaseClass<T> where T : ISomeOtherClass
{
   public ListRef<T> OtherObjects { get; set; }
}

public class A : BaseClass<Class_x>
{
}

public class B : BaseClass<Class_Y>
{
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-18T17:11:47.033

我希望我能正确理解你的问题。这是我的做法：

```
interface ILetter<T>
{
    IList<T> OtherObjects { get; }
}

class A : ILetter<Class_X> 
{
    public IList<Class_X> OtherObjects
    {
        get { /* ... */ }
    }
}

class B : ILetter<Class_Y> 
{
    public IList<Class_X> OtherObjects
    {
        get { /* ... */ }
    }
}

// etc... 
```

使用此接口，您可以确保每种类型都有一个公共`IList<T>`属性，您可以将其用于您希望的任何操作。

# weblogic - 如何在 Weblogic 10.x 上启用 JMX

> ID：1013916
> 
> 赞同：6
> 
> 时间：2009-06-18T17:02:14.953
> 
> 标签：weblogic, jmx

我有一个启用 JMX 的应用程序。它有自己的 JMX 代理和一些 MBean。当我在 WebLogic 中启动应用程序时，我能够通过 RMI url 连接到 JMX 代理并通过“ **JConsole** ”对 MBean 执行操作。

但是当我进入 Weblogic 控制台时，我看不到任何 JMX 控制台！如何在 Weblogic 中启用 JMX 控制台？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-06-05T11:44:31.103

将以下 JVM 参数添加到 Weblogic 启动脚本：

```
-Dcom.sun.management.jmxremote -Dcom.sun.management.jmxremote.port=8888 -Dcom.sun.management.jmxremote.ssl=false -Dcom.sun.management.jmxremote.authenticate=false 
```

并重新启动服务器。然后，您将能够通过主机：8888 上的 JConsole/VisualVM/etc 进行远程连接。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-07-08T16:21:23.300

希望这会有所帮助，请参阅此网址 -> [http://forums.oracle.com/forums/thread.jspa?messageID=3570887](http://forums.oracle.com/forums/thread.jspa?messageID=3570887)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2011-08-17T17:11:18.907

WebLogic 没有嵌入在管理控制台中的 JMX 控制台。

WebLogic 包括用于[访问其他 BEA MBean 和自定义 MBean的](http://download.oracle.com/docs/cd/E11035_01/wls100/config_scripting/nav_edit.html#wp1014113)[WebLogic 脚本工具](http://download.oracle.com/docs/cd/E11035_01/wls100/config_scripting/using_WLST.html)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-09-08T04:49:35.993

WebLogic 10.3.4+ 确实有一个通过 Oracle Enterprise Manager Fusion Middleware Control 页面的 MBean 浏览器。

要访问它，请登录企业管理器，从左侧索引中选择 WebLogic 域，展开它并右键单击您的域。

在上下文菜单中有一个选项“System MBean Browser”。选择它，您将可以访问 MBean。

# sql - 使用许多where子句的多表选择，有没有比自连接更好的方法？

> ID：1013923
> 
> 赞同：0
> 
> 时间：2009-06-18T17:03:08.663
> 
> 标签：sql, mysql, database

我有一堆表，我正在使用唯一的项目 ID 加入这些表。大多数 where 子句条件将从用户提交的表单（搜索框）以编程方式构建，并且通常会针对同一个表（在本例中为项目标签）测试多个条件。

我的 SQL 经验很少，但我了解基础知识。我想找到已用某种类型的标签标记的活动（状态 = 1）项目的 ID，其值为“猫”和“小猫”。标签存储为 (id, product_id, tag_type_id, value)，其中 id 是唯一需要唯一值的列。我的第一次尝试是；

```
 select 
      distinct p2c.product_id 
   from '.TABLE_PRODUCT_TO_CATEGORY.' p2c
      inner join '.TABLE_PRODUCT.' p on p2c.product_id = p.id 
      inner join '.TABLE_PRODUCT_TAG.' pt on p.id = pt.product_id
      inner join '.TABLE_TAG_TYPE.' tt on pt.tag_type_id = tt.id
   where 
      tt.id = '.PRODUCT_TAG_TYPE_FREE_TAG.'
      and p.status = 1
      and lower(pt.value) = "cats"
      and lower(pt.value) = "kittens" 
```

但这没有任何回报。我意识到最终的 AND 条件是问题所在，因此尝试使用自联接代替；

```
 select 
      distinct p2c.product_id 
   from '.TABLE_PRODUCT_TO_CATEGORY.' p2c
      inner join '.TABLE_PRODUCT.' p on p2c.product_id = p.id 
      inner join '.TABLE_PRODUCT_TAG.' pt on p.id = pt.product_id
      inner join '.TABLE_PRODUCT_TAG.' pt2 on p.id = pt2.product_id
      inner join '.TABLE_TAG_TYPE.' tt on pt.tag_type_id = tt.id
   where 
      tt.id = '.PRODUCT_TAG_TYPE_FREE_TAG.'
      and p.status = 1
      and lower(pt.value) = "cats"
      and lower(pt2.value) = "kittens" 
```

现在一切都按预期工作，结果集是正确的。那我想知道什么？重申一下，我所追求的结果是活动（状态 = 1）项目的 ID，这些项目已被标记为特定类型的标签，值为“猫”和“小猫”......

1.  自加入是实现这些结果的最佳方式吗？
2.  这个查询有可能很大（我省略了一个类别条件，其中可能有大约 300 个），那么这种自连接方法是否可以很好地扩展？如果没有，是否有替代方案？
3.  如果我允许用​​户指定复杂的标签搜索，自加入方法是否是最好的方法（假设有替代方法）？即“猫”和（“小猫”或“狗”）不是“鹦鹉”。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-18T17:08:21.233

这在您的第一个查询中不起作用吗？

代替

```
and lower(pt.value) = "cats"
and lower(pt.value) = "kittens" 
```

做这个

```
and lower(pt.value) in ("cats","kittens") 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-18T17:04:53.560

```
select 
  distinct p2c.product_id
from '.TABLE_PRODUCT_TO_CATEGORY.' p2c
  inner join '.TABLE_PRODUCT.' p on p2c.product_id = p.id
  inner join '.TABLE_PRODUCT_TAG.' pt on p.id = pt.product_id
  inner join '.TABLE_TAG_TYPE.' tt on pt.tag_type_id = tt.id   
where 
  tt.id = '.PRODUCT_TAG_TYPE_FREE_TAG.'
  and p.status = 1  
  and (lower(pt.value) = "cats" or lower(pt.value) = "kittens") 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-18T17:25:44.237

The problem with the initial query was this:

```
 and lower(pt.value) = "cats"
  and lower(pt.value) = "kittens" 
```

There exists no tag for which the value is both "cats" and "kittens", therefore no records will be returned. Using an IN clause as SQLMenace suggests would be the solution - that way you're saying, "give me back any active item that has been tagged 'cats' or 'kittens'".

But if you want any active item that has BOTH tags - then you need to do something like your second query. It's not perfectly clear from your question if that's what you're after.

For something like your Question #3:

> "cats" and ("kittens" or "dogs") not "parrots".

you would want pt1, pt2, and (in a subquery) pt3, and something like this:

```
and lower(pt1.value) = "cats"
and lower(pt2.value) in ("kittens", "dogs")
and not exists (select * from '.TABLE_PRODUCT_TAG.' pt3 where pt3.product_id = p.id and lower(pt3.value) = "parrots") 
```

The broadly general case could get quite messy...

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-18T21:52:52.527

航空代码

```
select 
  distinct p2c.product_id 
from '.TABLE_PRODUCT_TO_CATEGORY.' p2c
  inner join '.TABLE_PRODUCT.'     p  on p2c.product_id = p.id 
where 
  and p.status = 1
  and 2 = (
      SELECT  COUNT(1)
      FROM '.TABLE_PRODUCT_TAG.' pt
        INNER JOIN  '.TABLE_TAG_TYPE.' tt ON pt.tag_type_id = tt.id
      WHERE tt.id = '.PRODUCT_TAG_TYPE_FREE_TAG.'
      AND pt.product_id = p.id /* edit */
      lower(pt.value) IN( "cats", "kittens" )
) 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-18T18:18:43.997

您的回答是“是的，这是一种可扩展的技术”。至于增加复杂性，我认为在遇到高效查询问题之前，您会超出用户理解他们在做什么的能力。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-18T18:59:25.757

您正在构建另一个实体-属性-值数据模型。既然您询问了可扩展性，这里有一个警告：EAV 模型通常不能扩展，也不能在 RDBMS 之上执行。最终，这种“灵活”的数据模型最终会破坏优化器，您将扫描数百万行来获取您的几只狗和小猫。Wikipedia 有一个[主题涵盖此模型和一些缺点](http://en.wikipedia.org/wiki/Entity-Attribute-Value_model#Tree_structures_and_relational_databases)。不知道您的目标数据库是什么，例如[SQL Server CAT 发布了一份白皮书](http://sqlcat.com/whitepapers/archive/2008/09/03/best-practices-for-semantic-data-modeling-for-performance-and-scalability.aspx)，其中包含 EAV 模型中的常见问题。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-06-18T19:00:28.640

好的，让我重新陈述问题以确保我理解：

您正在尝试显示具有两个不同特定标签（“猫”和“小猫”）但标签存储在一对多表中的所有产品。

双连接确实有效，但这是另一种选择：

```
SELECT ...
FROM P
WHERE p.status = 1
  AND p.ProductID IN (SELECT Product_ID FROM tags WHERE value = "cats")
  AND p.ProductID IN (SELECT Product_ID FROM tags WHERE value = "kittens") 
```

只需根据用户选择的选项添加额外的 AND 语句。

SQL 优化器实际上应该像对待连接一样对待它，所以我认为性能不会比你的版本*更差。*不过，值得用您的数据集进行测试以确保。

# c# - WPF 复合控件

> ID：1013926
> 
> 赞同：6
> 
> 时间：2009-06-18T17:04:31.317
> 
> 标签：c#, wpf, data-binding

我正在尝试在 WPF 中创建一个具有标签和文本框的可重用用户控件。我想向我的 UserControl 添加属性，以便将两个子控件的 Text 字段向上冒泡到父控件，以便于绑定。我读到我需要通过将所有者添加到 DependencyProperties 来做一些花招。这是我现在的代码。它似乎很接近，但并不完全正确。有任何想法吗？

这是 Xaml：

```
<UserControl x:Class="MAAD.AircraftExit.Visual.LabelTextBox"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    Height="20" Width="300">
    <DockPanel>
        <TextBlock Text="{Binding Path=Label, RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type UserControl}}}" DockPanel.Dock="Left" TextAlignment="Right" Width="122" />
        <TextBlock Text=": " DockPanel.Dock="Left"/>
        <TextBox Text="{Binding Path=Text, RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type UserControl}}}" />
    </DockPanel>
</UserControl> 
```

以及背后的代码：

```
public partial class LabelTextBox : UserControl
{
    public static readonly DependencyProperty LabelProperty = DependencyProperty.Register("Label", typeof(string), typeof(LabelTextBox));
    public string Label
    {
        get { return (string)GetValue(LabelProperty); }
        set { SetValue(LabelProperty, value); }
    }

    public static readonly DependencyProperty TextProperty = DependencyProperty.Register("Text", typeof(string), typeof(LabelTextBox));
    public string Text
    {
        get { return (string)GetValue(TextProperty); }
        set { SetValue(LabelTextBox.TextProperty, value); }
    }

    public LabelTextBox()
    {
        InitializeComponent();

        ClearValue(HeightProperty);
        ClearValue(WidthProperty);
    }
} 
```

编辑：这是最终的工作代码。我切换到相对源绑定。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-06-18T17:49:44.480

绑定确实是要走的路：

XAML：

```
<UserControl x:Class="testapp.LabelTextBox "
xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
Height="300" Width="300" x:Name="This">
<DockPanel>
    <TextBlock DockPanel.Dock="Left" TextAlignment="Right" Width="70" Name="label" Text="{Binding Label, ElementName=This}"  />
    <TextBlock Text=": " DockPanel.Dock="Left" />
    <TextBox Name="textBox" Text="{Binding Text, ElementName=This}" />
</DockPanel> 
```

代码背后：

```
 public partial class LabelTextBox : UserControl
{
    public LabelTextBox()
    {
        InitializeComponent();
        Label = "Label";
        Text = "Text";
    }
    public static readonly DependencyProperty LabelProperty = DependencyProperty.Register("Label", typeof(string), typeof(LabelTextBox), new FrameworkPropertyMetadata(LabelPropertyChangedCallback));
    private static void LabelPropertyChangedCallback(DependencyObject controlInstance, DependencyPropertyChangedEventArgs args)
    {
    }
    public string Label
    {
        get { return (string) GetValue(LabelProperty); }
        set { SetValue(LabelProperty, value); }
    }

    public static readonly DependencyProperty TextProperty = DependencyProperty.Register("Text", typeof(string), typeof(LabelTextBox), new FrameworkPropertyMetadata(TextPropertyChangedCallback));
    private static void TextPropertyChangedCallback(DependencyObject controlInstance, DependencyPropertyChangedEventArgs args)
    {
    }
    public string Text
    {
        get { return (string) GetValue(TextProperty); }
        set { SetValue(LabelTextBox.TextProperty, value); }
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-18T17:29:42.377

我还没有仔细研究为什么你的实现不起作用，但我真的不明白你为什么这样做。为什么不直接在 UserControl 上定义你需要的依赖属性然后绑定它们呢？

```
public static readonly DependencyProperty LabelTextProperty = ...; 
```

然后在您的 XAML 中：

```
<Label Content="{Binding LabelText}"/> 
```

# asp.net - 两个用户控件之间的交互

> ID：1013929
> 
> 赞同：5
> 
> 时间：2009-06-18T17:05:06.947
> 
> 标签：asp.net, vb.net, user-controls, delegates, nullreferenceexception

我处于疯狂的边缘...

在我实际构建的应用程序中，我正在处理两个需要相互交互的动态添加控件，但我已将问题简化为一个尽可能简单的示例在静态加载控件的情况下，它仍然存在相同的问题：调用委托时出现 NullReferenceException。这是要点：

**控制 1**

```
Partial Class Control1
Inherits System.Web.UI.UserControl

Private _delClicked As System.Delegate
Public WriteOnly Property UpdateLabel() As System.Delegate
    Set(ByVal value As System.Delegate)
        _delClicked = value
    End Set
End Property

Protected Sub btnButton_Click(ByVal sender As Object, ByVal e As System.EventArgs) Handles btnButton.Click
    Dim aObj(0) As Object
    aObj(0) = 1
    _delClicked.DynamicInvoke(aObj)
End Sub
End Class 
```

**控制 2**

```
Partial Class Control2
Inherits System.Web.UI.UserControl

Protected WithEvents Control1 As New Control1
Delegate Sub ChangeLabel(ByVal int As Integer)

Protected Sub Page_Init(ByVal sender As Object, ByVal e As System.EventArgs) Handles Me.Init
    Dim delChangeLabel As New ChangeLabel(AddressOf UpdateLabel)
    Me.Control1.UpdateLabel = delChangeLabel
End Sub

Private Sub UpdateLabel(ByVal int As Integer)
    lblLabel.Text = "Value is now " & int
End Sub
End Class 
```

如果我在分配 Control1 委托的 Control2 行上放置一个断点，我可以单步执行并观察它在 Control1 对象中的设置。但是，当 btnButton_Click 事件触发时，_delClicked 的值又变回了 Nothing。

任何帮助将不胜感激。谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-18T17:46:50.617

我的猜测是您正在失去对回发的控制。动态添加的控件在回发时丢失。当然，您重新创建了一个执行相同操作的控件，但这并不意味着您将能够捕获单击事件。但是控件没有在回发之间传递它的视图状态。

请参阅这篇[文章](http://www.4guysfromrolla.com/articles/092904-1.aspx)，了解如何执行此操作

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-18T17:09:52.090

把它放在 Page_init()

```
Dim delChangeLabel As New ChangeLabel(AddressOf UpdateLabel) 
Me.Control1.UpdateLabel = delChangeLabel 
```

# asp.net - ASP.NET 中 CSS 的工具包/库（如 Ruby 库 'Less' ）

> ID：1013934
> 
> 赞同：1
> 
> 时间：2009-06-18T17:05:33.153
> 
> 标签：asp.net, css

所以，我刚刚看到了 Ruby 库“Less”。我想要那个功能......

是否有任何现有的 ASP.NET 库可以为我提供相同的功能？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-09-29T20:09:55.050

我尝试使用[Less for .NET](http://www.dotlesscss.com)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-18T17:38:53.920

Less 恰好是用 Ruby 编写的，它不需要您开发 Ruby [on Rails] 应用程序。没有理由不能在 ASP.NET 项目中使用它，您只需要安装 Ruby 和 ruby​​-gems。

# arduino - 当我通过串行打印时，Arduino 的模拟读取（）返回垃圾

> ID：1013936
> 
> 赞同：2
> 
> 时间：2009-06-18T17:05:58.270
> 
> 标签：arduino

我正在用 Arduino 制作时钟，我想制作一个按钮来设置时间。所以，只是为了测试，我在模拟输入引脚 0 中插入了一根电线，并编写了两行代码来读取引脚并通过串行打印它，但我得到的只是垃圾。

```
 valm = analogRead(0);
  Serial.println(valm); 
```

?j?d?±µ?Ê??jDd?±µ???ºjRd?±µ???ºj?d?±µ?Ê??j?d?±µ?É?ªjRd?±µ?? ?ÊjRd?±µ???Âj?d?±µ????j?d?±µ?É??j Rd?±µ????j?d?±µ???ºj?d? ±µ?É??jRd?±µ????j?d?±µ?Ê?ÊjDd?±µ???Âj?d?±µ????j?d?±µ?É?? jRd?±µ????j?d ?±µ?É?ÂjRd?±µ???Êj?d?±µ???ªj?d?±µ?Ê?Êj$d?±µ?? ?ÂjRd?±µ????j?d?±µ????jdd?±µ????jRd?±µ???Âj?d?± µ?É?ÊjRd?±µ??? ?j?d?±µ?Ò?Êj?d?±µ?É?ÂjRd?±µ????j?d?±µ????j?d?±µ?É??jRd?± µ???Âj?d?±µ???Êj?d?±µ? ??ªj?d?±µ???Êj?d?±µ???ÂjRd?±µ????j?d?±µ????j?d?±µ?É??jRd? ±µ???Âj?d?±µ?Ò?Êj?d?±µ?É?ªj?d?±µ?É? ?jTd?±µ???Âj?d?±µ????j?d?±µ?É??jRd?±µ????j?d?±µ?É?ÂjRd?±µ? ??Êj?d?±µ?É?ªjRd?±µ???Êj?d?±µ???ºj ?d?±µ?È??jTd?±µ????jRd?±µ? ??ªj?d?±µ?È?ÂjTd?±µ?É?ÊjRd?±µ???ªj?d?±µ???Êj?d?±µ???ºj?d?±µ? É??jRd ?±µ???Êj?d?±µ???ªj?d?±µ?É?ÂjPd?±µ???Êj?d?±µ???ªj?d?±µ ?Â?Êj?d?±µ?É?ºjRd?±µ????j?d?±µ?É??jRd?± µ???ªj?d?±µ?Ê?Âj?d?±µ???ÊjRd?±µ???ªj?d?±µ?Ò?Êj?d?±µ???ºjRd?± µ????j?d?±µ???Êj?d?±µ?Ê?ªjdd?±µ? ??ÂjRd?±µ???Âj?d?±µ?É?ªjPd?±µ???Êj?d?±µ????j?d?±µ?É??jRd?±µ? ??Êj?d?±µ?É?ªjdd?±µ???ÂjRd?±µ??? Âj?d?±µ?É?ªjDd?±µ???Êj?d?±µ?Ê??j?d?±µ?É??jRd?±µ???ÊjRd?±µ??? ªj?d?±µ?Ê?ÂjPd?±µ???Âj?d?±µ???ªj ?d?±µ?É?Êjdd?±µ?É??jRd?±µ???? j?d?±µ?É?Êj$d?±µ???ªjRd?±µ???Âj?d?±µ?Â?ÂjTd?±µ???ªj?d?±µ??? Êj?d ?±µ????jRd?±µ????j?d?±µ?É?ÊjTd?±µ???ªjRd?±µ???Âj?d?±µ??? Âj?d?±µ?É?ªjRd?±µ???ÊjRd?±µ?Ò??jTd?± µ????j?d?±µ???Êj

为什么？

* * *

编辑：

我已将数字引脚 0 设置为输出，我认为这可能是问题所在，所以我访问了 Arduino 网站并找到了*[Analog Input Pins](http://arduino.cc/en/Tutorial/AnalogInputPins)*页面。

所以我试图从他们说的引脚 14 读取模拟输入引脚 0，但我得到了相同的输出。

顺便说一句，我正在尝试从仅模拟引脚读取，而不是数字引脚。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-18T17:19:23.137

尝试运行 Arduino 网站上的示例代码。您不需要转换变量`valm`或任何东西。

```
/*
  Analog input

    Reads an analog input on analog in 0, and prints the value out.

    Created 24 March 2006
    by Tom Igoe
*/

int analogValue = 0;    // Variable to hold the analog value.

void setup() {
    // open the serial port at 9600 bit/s:
    Serial.begin(9600);
}

void loop() {
    // Read the analog input on pin 0:
    analogValue = analogRead(0);

    // Print it out in many formats:
    Serial.println(analogValue);       // print as an ASCII-encoded decimal
    Serial.println(analogValue, DEC);  // print as an ASCII-encoded decimal
    Serial.println(analogValue, HEX);  // print as an ASCII-encoded hexadecimal
    Serial.println(analogValue, OCT);  // print as an ASCII-encoded octal
    Serial.println(analogValue, BIN);  // print as an ASCII-encoded binary
    Serial.println(analogValue, BYTE); // print as a raw byte value

    // Delay 10 milliseconds before the next reading:
    delay(10);
} 
```

如果您的输出仍然是乱码，那么您的串行终端有问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-01-08T12:53:35.720

问题这里是您可能连接的模拟设备不是@相同的接地电位。示例：如果您使用 PC 为 Arduino 板供电，并且使用其他源为传感器供电，但您试图从 Arduino 端口读取值，此时它会给出上述错误。尝试从同一电源打开 arduino 和传感器的电源，并尝试通过 DOcklight 使用串行端口读取数据，您将解决问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-03-16T22:38:27.573

您需要将串行监视器窗口（右下角）中的波特率设置为与代码中设置的值相同的值（例如`Serial.begin(9600);`）。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-06-18T17:10:39.873

从您的输出看起来，您似乎需要将 valm 转换为字符串，以便您可以以数字方式打印该值。

另外，您插入模拟的电线是否处于浮动状态？因为如果是这样，它只会像天线一样抓取随机噪声（尽管可能有很强的 60Hz 分量）。

# java - 我可以使用哪种数据库技术来持久化对象？（不需要我负责将对象映射到表并返回的东西）？

> ID：1013938
> 
> 赞同：5
> 
> 时间：2009-06-18T17:06:40.360
> 
> 标签：java, database, hibernate, oop, jackrabbit

我需要为项目使用面向对象的数据存储库。
它将介于 wiki 和 CMS 之间。

我还不是持久性领域的专家。
我想 Hibernate 和 Jackrabbit 是要走的框架，对吧？

据我所知，**Jackrabbit**不支持**在** 对象实例和数据存储之间进行映射的
注释或其他**便利技术。**

**另一方面，**Hibernate****不**支持 开箱即用的**版本控制。**** 

 **你会建议我用什么？
我可以以某种方式结合这两个框架吗？

如果可能的话，您能否总结一下这两个框架的优缺点？

谢谢！

**编辑**
**我真的很想使用不需要我负责将对象映射到表并返回的东西。我为什么要？我们生活在哪个世纪？;)**

我对 JAXB 有很好的经验（将对象映射到 XML 并以面向对象的方式返回），但是 JAXB 在数据库中没有用处。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-18T21:12:58.160

[db4o](http://www.db4o.com/about/productinformation/db4o/)是一个面向对象的数据库。由于它是面向对象的，因此您可以直接存储对象，因此您不必维护任何与表的映射。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-19T00:32:55.963

试试[NeoDatis](http://www.neodatis.org/)。它具有 db4o 的所有优点（本机查询、无映射、速度快），只是它完全免费（即使用于商业用途）。

**更新**：上次我尝试 NeoDatis（2010 年中）时，它仍然有一些严重的错误。例如，断电可能导致数据库损坏。谨防！

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-18T19:58:04.393

[Oracle Berkeley DB Java 版](http://www.oracle.com/database/berkeley-db/je/index.html)

是一个直接的持久层（没有映射到关系数据库）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-25T18:58:13.100

DB4o 和 Neodatis 是要走的路……

我认为如果您的项目是为了盈利，您将需要商业许可证......如果是这样，请使用 neodatis......

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-18T17:32:46.007

我会选择休眠模式。仅仅因为它拥有如此庞大的社区。是的，我个人对 Hib 有很多（很好的）经验，所以我有偏见。

至于版本控制，好吧，自己实现它——这并不难，只需制作一个副本（反射是一个助手），然后保存对象。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-18T19:06:14.620

您还可以考虑使用[JPA 的](http://java.sun.com/developer/technicalArticles/J2EE/jpa/). 虽然它们并不是自切片面包以来最热门的东西，但它们正在被 Java 社区采用，并被 Sun 社区推为新标准。不过，Hibernate 是安全且经过验证的，因此我个人会坚持使用它。**

# asp.net - 在 asp.net 的内联代码块中包含一个类

> ID：1013944
> 
> 赞同：2
> 
> 时间：2009-06-18T17:07:36.257
> 
> 标签：asp.net

我正在玩asp.net 中的内联代码块。有人能告诉我为什么下面的代码不起作用吗？

```
<%@ Language="C#" %>
<%
    Response.Write(TestClass.ShowMessage());

    public class TestClass
    {
        public static string ShowMessage()
        {
            return "This worked!!";
        }
    }
%> 
```

我收到以下错误消息： CS1513: } 预期

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-18T17:13:16.000

你`Response.Write`有一个函数之外的浮动。

为什么不将此代码放在脚本标签中：

```
<script runat="Server">
    public class TestClass
    {
        public static string ShowMessage()
        {
            return "This worked!!";
        }
    }
</script> 
```

然后：

```
<%=TestClass.ShowMessage()%> 
```

注意`<%=expr%>`是特别处理的。

许多人认为这是一种不纯的方法。你可以这样做：

```
<script runat="Server">
    protected void Page_Load(object sender, EventArgs e)
    {
        litMessage = TestClass.ShowMessage();
    }
</script>
<asp:literal id="litMessage" runat="server" /> 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-18T17:12:51.757

我认为要能够编写整个类，您需要将其放在标签块中

```
<script runat="server" language="C#">
//Put your class here
</script> 
```

# c# - 使用 C#.net 基于 Dos 的打印

> ID：1013960
> 
> 赞同：3
> 
> 时间：2009-06-18T17:10:48.983
> 
> 标签：c#, .net, printing, console-application

我使用 Dotmatrix 打印机 EPSON 打印报告，我需要如何在不使用 CrystalReport 和打印对话框的情况下打印报告，即我想要 C#.net 中基于 DOS 的打印代码......

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-18T17:14:28.993

我知道一种非常古老和肮脏的方式。只需将 LPT1（或您正在使用的打印机端口）作为流打开并输出字符。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-18T17:20:30.623

也许这会有所帮助？[http://support.microsoft.com/kb/322091/EN-US](http://support.microsoft.com/kb/322091/EN-US)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-18T17:17:35.060

您的打印机是否出现在 Windows 中？换句话说，您可以从记事本打印到它吗？然后您仍然可以使用 System.Drawing.Printing 命名空间并以这种方式将数据发送到您的打印机。

这是如果您需要打印字符数据以外的任何内容 - 否则，请像 tekBlues 所说的那样。

# coding-style - C/PHP/Java 等中不同的支撑/缩进样式的名称是什么？

> ID：1013966
> 
> 赞同：2
> 
> 时间：2009-06-18T17:12:33.163
> 
> 标签：coding-style, indentation, curly-braces

在对代码块使用“大括号”的语言中，并且空格不是问题（C、Java、PHP）——不同的大括号/缩进样式的名称是什么？

我记得读过有关“KNF”和“Flag”的文章，但最好有最知名的名称，以及每个名称的一些简单示例。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-18T17:13:41.227

请参阅[缩进样式](http://en.wikipedia.org/wiki/Indent_style)：

> 在计算机编程中，缩进风格是一种规范代码块缩进以传达程序结构的约定。本文主要讨论 C 编程语言及其后代，但可以（并且经常）应用于大多数其他编程语言（尤其是大括号家族中的那些）。缩进风格只是编程风格的一个方面。

# .net - Winforms ComboBox Databind with DropDownStyle=Dropdown

> ID：1013973
> 
> 赞同：1
> 
> 时间：2009-06-18T17:13:30.260
> 
> 标签：.net, winforms, data-binding, .net-3.5, combobox

Winforms / .Net 3.5

我正在使用下拉样式设置为下拉的组合框（允许用户输入数据）。

我遇到的问题是如何设置组合框，以便它使用列表中的值以及用户输入数据时更新我的​​绑定源。

例如，组合框可能包含以下值：

“红”、“白”、“蓝”。但是用户应该能够输入“黑色”。

我尝试使用“文本”属性，但问题是我的组合框显示值包含比值（仅代码）更多的信息（代码和描述）。

我在向组合框添加绑定时尝试使用 SelectedValue，但它只使用列表中的值更新，而不是在用户输入数据时更新。

```
MyComboBox.DataBindings.Add("SelectedValue", MyBindingSource, "MyProperty", True, DataSourceUpdateMode.OnValidation) 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-26T09:37:57.710

我有同样的问题。我通过在 DataBindings.Add 方法中将参数“SelectedValue”替换为“Text”来解决它。MyComboBox.DataBindings.Add("Text", MyBindingSource, "MyProperty", True, DataSourceUpdateMode.OnValidation)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-10-09T11:36:10.157

在您的验证事件中，如果 text.isNullOrEmpty()==fallse && selectedItem==null 或 selectedIndex<0

1.  检查集合中是否已存在具有该名称的项目，如果存在则将 selectedItem 更改为该名称。
2.  提示用户是否要尝试创建新项目。
3.  做任何你需要获取创建该项目的信息的事情，不管它是显示一个表单对话框，还是什么都没有。
4.  将新创建的实例插入到组合框绑定到的数据源中。
5.  将组合框上的 selectedItem 属性设置为新项目。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-07-29T20:19:17.357

尝试更改组合框的 DropDownStyle 属性。不确定它是否会给你想要的东西，但这是一个新的方向。

# asp.net - 在 asp.net 内联代码块中调用 Web 服务

> ID：1013977
> 
> 赞同：1
> 
> 时间：2009-06-18T17:13:56.890
> 
> 标签：asp.net, web-services

是否可以在不添加 Web 引用的情况下从 ASP.NET 中的内联代码块调用 Web 服务？如果是这样，你能提供指导吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-18T17:18:42.873

一般来说，内联代码可以做任何代码后面的代码可以做的事情，代码后面的代码更干净并且可以分隔文件。

您首先需要包含在创建 WebService 代理时为您生成的正确名称空间。

命名空间包含代码在内联代码的情况下有点不同，这里是一个例子

```
<%@ Import Namespace="System.IO" %> 
```

如果您想了解差异编码恐怖有一篇[很棒的](http://www.codinghorror.com/blog/archives/000174.html)文章

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-18T17:32:22.373

在另一个 C# 项目（例如控制台应用程序）中添加 Web 引用。然后切换到“显示所有文件”。您将找到一个隐藏的 .cs 文件，其中包含为您创建的实际 Web 服务代理。（还有一个命令行工具可以做同样的事情，但我忘记了名字）

您可以将生成的类复制到您的 .aspx`<script runat="server">`块中。

虽然我不知道您实际上需要它来做什么；）您无法访问网络应用程序的源代码吗？

另一种解决方案是为 Web 代理创建一个 .NET dll，然后使用 .NET 动态加载此程序集`Assembly.Load()`。虽然动态调用方法并不漂亮。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-18T17:32:51.327

如果您的 App_Code 文件夹中有 Web 服务的代码文件 (*.cs)，则不需要任何参考、使用等。但是，如果 Web 服务不在您的项目中，或者您的代码中没有App_Code 文件夹中的一个单独的 .cs 文件，您将需要一个 Web 参考。

这是根据我的经验，我刚刚使用了我的 Web 服务的一种 Web 方法：

```
<%= new MyWebService().MyWebMethod(); %> 
```

希望能帮助到你。

# c++ - 模板化操作符<< 显式实例化和标头

> ID：1013979
> 
> 赞同：2
> 
> 时间：2009-06-18T17:14:24.470
> 
> 标签：c++, templates

通常，对于我的模板类，我在文件中包含声明，在`.hpp`文件中包含模板实现代码`.t.hpp`。我在文件中显式实例化类`.cpp`：

```
template class MyClass< AnotherClass >; 
```

其目标代码被放入库中。

问题是，如果我尝试使用 打印对象`operator<<`，该对象在文件中声明并在`.hpp`文件中定义`.t.hpp`为：

```
template<class T>
std::ostream& operator<<( std::ostream& os, const MyClass<T>& c)
{
    os  << "Hello, I am being output.";
    return os;
} 
```

我收到一个链接器错误，指出正确的符号未定义。

我知道这是因为这个模板化函数在类被实例化时没有显式实例化。`.t.hpp`除了在我想`operator<<`在类上使用的任何时候包含文件，或者将模板化的函数代码移动到文件中之外，有没有办法解决这个问题`.hpp`？我可以显式实例化功能代码吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-18T17:18:05.713

您可以显式实例化函数模板

```
template std::ostream& operator<<(std::ostream&, const MyClass<int>&); 
```

用 实例化一个特化`T = int`。如果所有模板参数都可以推导出来（比如在这种情况下，从 type 推导出来），则可以省略模板参数括号`MyClass<int>`。如果不能，例如因为模板参数不出现在函数参数类型中，则必须显式指定它

```
template<typename T> void f() { }
template void f<int>(); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-18T17:29:20.677

请参阅[litb 的解决方案](https://stackoverflow.com/questions/1013979/templated-operator-explicit-instantiation-and-header/1013995#1013995)。

对于您的特定情况，编译器可以从参数和返回类型中推断出所有模板参数，但如果不能，您可以显式地给出它们：

```
template std::ostream& operator<< <T>(std::ostream&, const MyClass<T>&); 
```

如果可以推导出模板参数，这仍然是允许的。

请问：您是否有理由更喜欢显式实例化所有内容？你为自己做了很多工作。通过避免在任何地方都包含模板源代码，您肯定会节省编译时间，但是在开发人员的时间里这样做值得吗？

# .net - 获取数据表列的下一个自动增量值？

> ID：1013984
> 
> 赞同：3
> 
> 时间：2009-06-18T17:16:11.410
> 
> 标签：.net

我有一个带有 AutoIncrement 列的数据表。如何在不添加新行的情况下获得该列的下一个增量（-1，-2，-3，...）？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2011-12-27T10:21:58.537

我得到了问题的解决方案（不是解决方法）：

要从 SQLServer 获取下一个自动增量值：

```
SELECT IDENT_CURRENT('table_name'); -- This will fetch the present auto-increment value. 
```

所以，

```
SELECT IDENT_CURRENT('table_name')+1; -- Next auto-increment value. 
```

如果从具有标识且键不连续的表中删除行，这不会中断。

希望有帮助。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-06-18T17:27:15.890

如果它适合您的设计，您始终可以创建新行 (datatable.newrow)，并且它已经分配了 nextId。它现在被浪费了，但直到你`AcceptChanges`.

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-18T17:23:17.843

您可以在针对 DataTables 的 Select 方法中使用 MAX 函数。

类似的东西（语法可能不完全正确）：

```
DataRow row = dt.Select("MAX(id)")[0];
int nextId = row["id"] + 1; 
```

MSDN 有一个页面，其中包含您可以使用的所有表达式。 [DataColumn..::.Expression 属性](http://msdn.microsoft.com/en-us/library/system.data.datacolumn.expression.aspx)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-18T17:26:45.280

> 我有一个带有 AutoIncrement 列的数据表。

你有一个带有 AI 列的数据表，还是一个带有 AI 列的 SQL 数据库？如果它是具有该列的 SQL 数据库，则您无法获得下一个值，因为您的 DataTable 已断开连接。否则，您必须等到进行插入并使用 @@IDENTITY 或类似功能。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-18T18:02:29.390

如果您使用的是 SQL Server，您可以执行以下操作：

```
SELECT cast(last_value as integer)+cast(increment_value as integer) 
FROM sys.identity_columns 
WHERE object_id=(SELECT id FROM sys.sysobjects WHERE name='PACLogErros')
AND name='ERRCod' 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-18T18:16:53.110

最好的方法是使用 Andrew 提到的@@IDENTITY，因为我们无法推断 SQL 计算下一个身份的算法，并且如果您考虑多个人更新数据库，那么您计算的身份值在您尝试时将不一样将行保存到数据库

* * *

## 回答 #7

> 赞同：-2
> 
> 时间：2009-06-18T17:19:03.263

由于自动增量值始终是该列中的最大值，因此您可以使用 max(column name) +1 获取它。

# iphone - 从 iPhone 播放 MP3 的 URL

> ID：1013988
> 
> 赞同：2
> 
> 时间：2009-06-18T17:16:47.120
> 
> 标签：iphone, mp3, stream

我正在尝试找到播放 mp3 网址的最佳方式。我已经尝试过 Audiostreamer，但它不适合我的需求，因为它面向无限流，而不是有限流。

任何帮助表示赞赏！

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-18T17:22:35.817

AVAudioPlayer 是你的答案：

[http://developer.apple.com/iPhone/library/documentation/AVFoundation/Reference/AVAudioPlayerClassReference/Reference/Reference.html#//apple_ref/occ/instm/AVAudioPlayer/initWithContentsOfURL:error](http://developer.apple.com/iPhone/library/documentation/AVFoundation/Reference/AVAudioPlayerClassReference/Reference/Reference.html#//apple_ref/occ/instm/AVAudioPlayer/initWithContentsOfURL:error)：

# security - Adobe Acrobat 8 并不总是在受保护的 PDF 文档中显示文本或图像

> ID：1013989
> 
> 赞同：0
> 
> 时间：2009-06-18T17:17:02.330
> 
> 标签：security, adobe, acrobat

有时，当我在 Adob​​e Acrobat (9) 中保护 PDF 文档时，其他使用 Adob​​e Acrobat 8​​ 的人看不到该新文档中的文本或图像。在某些文件上也是一致的。我目前唯一的解决方案是打印文档的 PDF，然后保护该版本的文档。这似乎绕过了这个问题。但是我有 5000 个文档正在批处理，我宁愿不必弄乱这些东西。

有替代解决方案吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-18T20:40:48.363

您使用的是什么类型的安全性？RC4，AES？启用/禁用哪些选项？您是否需要密码才能打开 PDF 或只是修改它？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-10-05T17:05:07.190

解决方案是在我们所有用户的机器上安装 Acrobat Pro 9。阅读器 9 也不错。

但是，这只修复了在我们自己的机器上查看 PDF 的问题。如果其他人在 Acrobat 8​​ 中查看该文件，那么他们将看到一个空白的 pdf。

我们的解决方案是不为保护文档而烦恼。它造成的麻烦多于其价值，显然人们很容易破坏它的安全性。

# sql - 在 Count Distinct (pl sql) 上返回 Null 值

> ID：1013993
> 
> 赞同：1
> 
> 时间：2009-06-18T17:17:47.400
> 
> 标签：sql, oracle, null, count, distinct

对这些查询中无意义的表/列名称先发制人地道歉。如果您曾经使用过 Remedy 的数据库后端，您就会明白。

当我怀疑实际值应该在 20 的某个地方（我相信是 23）时，我遇到了 Count Distinct 返回空值的问题。下面是一系列查询及其返回值。

```
SELECT count(distinct t442.c1)
      FROM t442, t658, t631
     WHERE t442.c1 = t658.c536870930
       AND t442.c200000003 = 'Network'
       AND t442.c536871139 < 2
       AND t631.c536870913 = t442.c1
       AND t658.c536870925 = 1
       AND (t442.c7 = 6 OR t442.c7 = 5)
       AND t442.c536870954 > 1141300800
       AND (t442.c240000010 = 0) 
```

结果 = 497。

添加表 t649 并确保它具有链接回表 t442 的记录：

```
 SELECT COUNT (DISTINCT t442.c1)
              FROM t442, t658, t631, t649
             WHERE t442.c1 = t658.c536870930
               AND t442.c200000003 = 'Network'
               AND t442.c536871139 < 2
               AND t631.c536870913 = t442.c1
               AND t658.c536870925 = 1
               AND (t442.c7 = 6 OR t442.c7 = 5)
               AND t442.c536870954 > 1141300800
               AND (t442.c240000010 = 0)
               AND t442.c1 = t649.c536870914 
```

结果 = 263。

过滤掉表 t649 中列 c536870939 <= 1 的记录：

```
SELECT COUNT (DISTINCT t442.c1)
          FROM t442, t658, t631, t649
         WHERE t442.c1 = t658.c536870930
           AND t442.c200000003 = 'Network'
           AND t442.c536871139 < 2
           AND t631.c536870913 = t442.c1
           AND t658.c536870925 = 1
           AND (t442.c7 = 6 OR t442.c7 = 5)
           AND t442.c536870954 > 1141300800
           AND (t442.c240000010 = 0)
           AND t442.c1 = t649.c536870914
           AND t649.c536870939 > 1 
```

结果 = 24。

过滤 HAVING 语句：

```
SELECT COUNT (DISTINCT t442.c1)
          FROM t442, t658, t631, t649
         WHERE t442.c1 = t658.c536870930
           AND t442.c200000003 = 'Network'
           AND t442.c536871139 < 2
           AND t631.c536870913 = t442.c1
           AND t658.c536870925 = 1
           AND (t442.c7 = 6 OR t442.c7 = 5)
           AND t442.c536870954 > 1141300800
           AND (t442.c240000010 = 0)
           AND t442.c1 = t649.c536870914
           AND t649.c536870939 > 1
        HAVING COUNT (DISTINCT t631.c536870922) =
                                              COUNT (DISTINCT t649.c536870931) 
```

结果 = 空。

如果我运行以下查询，我在结果列表中看不到任何可以解释为什么我没有得到任何类型的返回值的内容。即使我从 SELECT 中删除了 DISTINCT，也是如此。（我分别得到 25 和 4265 行数据）。

```
SELECT DISTINCT t442.c1, t631.c536870922, t649.c536870931
          FROM t442, t658, t631, t649
         WHERE t442.c1 = t658.c536870930
           AND t442.c200000003 = 'Network'
           AND t442.c536871139 < 2
           AND t631.c536870913 = t442.c1
           AND t658.c536870925 = 1
           AND (t442.c7 = 6 OR t442.c7 = 5)
           AND t442.c536870954 > 1141300800
           AND (t442.c240000010 = 0)
           AND t442.c1 = t649.c536870914
           AND t649.c536870939 > 1 
```

我还有其他几个地方的查询设置与返回空值的查询完全一样，并且它工作得非常好——返回正确值的可用数字。我必须假设在这种情况下任何独特之处都与数据有关，而不是与实际查询有关，但我不确定在数据中寻找什么来解释它。在聚合之前，我无法在原始数据中找到任何空值。我不知道还有什么会导致这种情况。

任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-18T18:52:41.977

我现在知道了。您在原始查询中的问题是，在没有 GROUP BY 子句的情况下使用 HAVING 子句是非常不寻常的（如果不是，实际上是错误的）。答案在于执行查询的各个部分的操作顺序。

在原始查询中，您执行以下操作：

```
SELECT COUNT(DISTINCT t442.c1)
  FROM ...
 WHERE ...
HAVING COUNT(DISTINCT t631.c536870922) = COUNT(DISTINCT t649.c536870931); 
```

数据库将执行您的连接和约束，此时它将执行任何分组和聚合操作。在这种情况下，您没有进行分组，因此 COUNT 操作跨越整个数据集。根据您在上面发布的值，COUNT(DISTINCT t631.c536870922) = 25 和 COUNT(DISTINCT t649.c536870931) = 24。现在应用了 HAVING 子句，导致没有匹配项 - 您询问总数的情况set（即使有多个 c1）是相等的，但它们不是。DISTINCT 被应用到一个空的结果集，你什么也得不到。

您真正想要做的只是您在示例中发布的内容的一个版本，该版本吐出行数：

```
SELECT count(*)
  FROM (SELECT t442.c1     
          FROM t442
             , t658
             , t631
             , t649
         WHERE t442.c1 = t658.c536870930
           AND t442.c200000003 = 'Network'
           AND t442.c536871139 < 2
           AND t631.c536870913 = t442.c1
           AND t658.c536870925 = 1
           AND (   t442.c7 = 6
                OR t442.c7 = 5)
           AND t442.c536870954 > 1141300800
           AND (t442.c240000010 = 0)
           AND t442.c1 = t649.c536870914
           AND t649.c536870939 > 1
         GROUP BY t442.c1
        HAVING COUNT(DISTINCT t631.c536870922) = COUNT(DISTINCT t649.c536870931)
       ); 
```

这将为您提供具有相同数量的 631 和 649 表条目的 c1 列的列表。注意：您应该非常小心在查询中使用 DISTINCT。例如，在您发布上述结果的情况下，完全没有必要；通常，它充当一种墙纸来覆盖查询中的错误，这些错误由于 WHERE 子句中缺少约束而无法以您想要的方式返回结果（“嗯，我的查询正在返回所有这些值的欺骗。嗯，一个DISTINCT 将解决这个问题”）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-18T17:34:28.063

结果是什么：

```
SELECT COUNT (DISTINCT t631.c536870922),
       COUNT (DISTINCT t649.c536870931)
          FROM t442, t658, t631, t649
         WHERE t442.c1 = t658.c536870930
           AND t442.c200000003 = 'Network'
           AND t442.c536871139 < 2
           AND t631.c536870913 = t442.c1
           AND t658.c536870925 = 1
           AND (t442.c7 = 6 OR t442.c7 = 5)
           AND t442.c536870954 > 1141300800
           AND (t442.c240000010 = 0)
           AND t442.c1 = t649.c536870914
           AND t649.c536870939 > 1 
```

如果那里的两列从来没有相等的值，那么添加 HAVING 子句将从结果集中删除所有行是有意义的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-18T17:23:47.157

`COUNT(DISTINCT column)` doesn't count `NULL` values:

```
SELECT  COUNT(DISTINCT val1)
FROM    (
        SELECT  NULL AS val1
        FROM    dual
        )

---
0 
```

Could it be the case?

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-18T17:33:46.957

我会尝试将 HAVING 子句条件放在 WHERE 子句中。你选择HAVING有什么理由吗？仅供参考，HAVING 是在返回结果集后完成的过滤器，这可能会导致意外结果。它也不用于优化查询。如果您不必使用 HAVING，我建议您不要使用它。

我建议将计数添加到 SELECT 子句中，然后将它们加入 WHERE 子句中。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-18T17:45:01.697

如果我这样做：

```
SELECT distinct t442.c1, count(distinct t631.c536870922), 
    count (distinct t649.c536870931)
          FROM t442, t658, t631, t649
         WHERE t442.c1 = t658.c536870930
           AND t442.c200000003 = 'Network'
           AND t442.c536871139 < 2
           AND t631.c536870913 = t442.c1
           AND t658.c536870925 = 1
           AND (t442.c7 = 6 OR t442.c7 = 5)
           AND t442.c536870954 > 1141300800
           AND (t442.c240000010 = 0)
           AND t442.c1 = t649.c536870914
           AND t649.c536870939 > 1
           group by t442.c1
           having count(distinct t631.c536870922)= 
                         count (distinct t649.c536870931) 
```

我看到应该计算的 23 行。删除 HAVING 语句将返回 24 行，即不符合 HAVING 条件的额外行。

编辑：查询的结果，根据史蒂夫布罗伯格的要求：

```
行 | t442.c1 | cnt t631 | cnt 649
------------------------------------------
1 | CHG000000230378 | 2 | 1
2 | CHG000000230846 | 1 | 1
3 | CHG000000232562 | 1 | 1
4 | CHG000000232955 | 1 | 1
5 | CHG000000232956 | 1 | 1
6 | CHG000000232958 | 1 | 1
7 | CHG000000233027 | 1 | 1
8 | CHG000000233933 | 1 | 1
9 | CHG000000233934 | 1 | 1
10 | CHG000000233997 | 1 | 1
11 | CHG000000233998 | 1 | 1
12 | CHG000000233999 | 1 | 1
13 | CHG000000234001 | 1 | 1
14 | CHG000000234005 | 1 | 1
15 | CHG000000234009 | 1 | 1
16 | CHG000000234012 | 1 | 1
17 | CHG000000234693 | 1 | 1
18 | CHG000000234696 | 1 | 1
19 | CHG000000234730 | 1 | 1
20 | CHG000000234839 | 1 | 1
21 | CHG000000235115 | 1 | 1
22 | CHG000000235224 | 1 | 1
23 | CHG000000235488 | 1 | 1
24 | CHG000000235847 | 1 | 1
```

如果我包含 HAVING 子句，第一行将被正确过滤掉。

# java - 使用 Java 的 Date 和 Calendar 类将分钟转换为一周

> ID：1013997
> 
> 赞同：2
> 
> 时间：2009-06-18T17:18:58.660
> 
> 标签：java, datetime, time, calendar

### 概述

这是场景：我得到一个值，它代表标准周中存在的总分钟数的一部分（假设每周 10,080 分钟，每天 1,440 分钟）从周六午夜开始（所以周日上午 12 点为 0 分钟） .

我需要将此分钟值转换为实际时间值（例如上午 8:35），并且我想使用 Java 的 Date 和/或 Calendar 类，而不是手动计算。

### 例子

以下是一些示例输入值：

*   720（一周 720 分钟）所以周日中午 12 点
*   3840（每周 3840 分钟）所以周二下午 4 点

使用 Java 的 Date 和 Calendar 类，我如何检索该相对日期的时间组件？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-18T17:33:07.723

此外，使用日历真的很容易：

```
SimpleDateFormat dateFormat = new SimpleDateFormat("yyyy/MM/dd HH:mm:ss");
int minutesToAdd = 720;
Calendar cal = Calendar.getInstance();

cal.setTime(dateFormat.parse("2009/06/21 00:00:00"));  // Next sunday
cal.add(Calendar.MINUTE, minutesToAdd);

Date result = cal.getTime();                           // Voila 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-18T17:24:15.580

Divide by 24 hours in a day to get number of days. Remainder is number of minutes into that day.

Divide by 60 to get hour. Remainder is minutes into that hour.

Division and Modulus will get your answer in just a few lines of code. Since this sounds like homework, I'll leave the coding out of this answer.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-18T17:27:32.237

As it sounds like homework, here how it should work:

```
1) Create yourself a calendar instance for sunday, 0:00 (on any date you wish)
2) Now add your minutes with the appropiate function
3) Now retrieve the time parts from the object 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-03-18T05:28:18.347

# apache - Apache：返回 404 错误而不是 500 错误

> ID：1013999
> 
> 赞同：3
> 
> 时间：2009-06-18T17:19:12.203
> 
> 标签：apache, http-status-code-404, error-reporting

在 apache 中，每当我收到 500 错误时，我想返回 404 错误。

我知道，这是一个非常奇怪的用例，但我想知道它是否可能。

我找到了这个

[http://www.4webhelp.net/tutorials/misc/errors.php](http://www.4webhelp.net/tutorials/misc/errors.php)

这让我相信你可以改变发生在不同错误上的事情。这样的事情会很棒

错误文档 404 /cgi-bin/error404.cgi

错误文档 500 /cgi-bin/error404.cgi

正如文章所建议的那样，但我的 Ubuntu 安装似乎没有 error404.cgi。知道我在哪里可以得到它，或替代解决方案吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-18T17:45:44.770

我知道这不能回答你的问题，但你确定你真的想这样做吗？500 错误和 404 是用于不同目的的非常不同的东西。您告诉用户他们拥有的 url 是错误的，而实际上这很可能是您的应用程序/服务器的临时问题。为什么你宁愿这样做而不是告诉用户有一个暂时的问题，他们应该稍后再试一次？或者换句话说，为什么不只是有一个自定义的 500 错误页面？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-18T17:40:42.843

你必须创建error404.cgi。转到 /usr/lib/cgi-bin 然后创建一个名为 error404.cgi 的文件，它应该是 Perl（默认），或者如果启用了 Python，您可以使用其中任何一个。如果您不了解 Python 或 Perl，这里有一个基本的 Perl 脚本，它应该适合您：（您可以从我的网站 cwarren.uuuq.com/downloads/perl/404.pl 下载该脚本

```
#!/usr/bin/perl
使用严格；
打印“<html>”；
打印“<头>”；
打印“<title>404 错误！</title>”；
打印“</head>”；
打印“<正文>”；
print "<h1>抱歉链接失效了，但是这个页面不在这里！</h1>";
打印“<br><br>”；
print "<a href=\"javascript:history.go(-1)\">点击这里返回上一页。</a>";
退出（0）；

```

另一种选择是将链接更改为 /var/www/404.html 或其他内容。