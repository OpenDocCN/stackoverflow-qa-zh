# StackOverflow 问答 000703000-000703999

# .net - 一个空的代表会吃掉内存吗？

> ID：703014
> 
> 赞同：9
> 
> 时间：2009-03-31T20:54:23.413
> 
> 标签：.net, events, memory-management, delegates

```
public sealed class FtpManager
{
    public event EventHandler LoggingIn = delegate { };
    private void OnLoggingIn(object sender, EventArgs e)
    {
        var handler = LoggingIn;
        handler(sender, e);
    }
// ...
} 
```

在上面的代码中，我`LoggingIn`使用空委托初始化了事件处理程序。

这会影响以任何方式使用的内存空间吗？尤其是当有成百上千的事件以这种方式声明时？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-03-31T21:00:55.940

划掉以前的答案（保留在下面以供后代使用）。这取决于编译器的实现，但在当前的 MS C# 3.0 编译器下，这实际上只创建了一个实例，每个实例都可以重用该实例。它能够做到这一点是因为委托是不可变的，并且该委托不需要来自实例的任何信息。

我不知道 C# 2.0 是否就是这种情况。您可以反编译您的代码并查看 IL 是否实际使用缓存字段。使用下面的答案是一种安全的方法，可以*保证*您只创建一个实例。

**原答案：**

是的，它创建了一个委托的实例。这将需要一些记忆。你可以减少它：

```
public static class EventHandlers
{
    public static readonly EventHandler Empty = delegate {};
}

public sealed class FtpManager
{
    public event EventHandler LoggingIn = EventHandlers.Empty;
} 
```

那时只有一个实例，您可以从任何地方引用它。缺点是其他类可以使用相同的处理程序取消订阅。如果您相信代码库的其余部分不会这样做，那么从记忆的角度来看，这可能是最好的选择。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2009-03-31T21:06:22.307

这样做的替代方法是在每次您想提高它时检查 LoggingIn 是否为空。这可能比调用空委托更占用内存。

# architecture - 何时使用数据传输对象和数据集

> ID：703018
> 
> 赞同：4
> 
> 时间：2009-03-31T20:55:25.377
> 
> 标签：architecture, oop

我正在尝试提出一种何时使用数据传输对象以及何时使用数据表的方法。

作为我在我们的系统中面临的问题的一个例子......

我们有 6 个不同的业务实体程序集，它们代表相同的事物但具有不同的属性。它们是由几个关注不同问题的开发人员在几年内创建的。

例如，多年来使用“自行车”类的不同应用程序关注自行车的不同属性。所以他们调用了不同的数据方法，这些方法只检索和填充他们关心的属性。

数据服务 1 填充

*   品牌
*   颜色

数据服务 2 填充

*   # 齿轮

*   轮胎尺寸

并且每个都使用不同的业务实体。显然这很荒谬，你不能为每个可能的属性组合创建一个新类。

我的直觉告诉我，如果这是一个问题，那么我们可能应该使用 ORM。

但是暂时我想说。

*   如果您要从表中填充或返回整行，则使用与数据库匹配的 DTO/业务实体。

*   如果您要返回一组随机属性，则使用数据表。

有人可以提供一些指导吗？

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-31T21:20:06.270

我会保持简单并始终返回一个 DataSet——简而言之，将 DataSet 用作通用 DTO。它灵活，类型安全，可用。除非您进入一些非常复杂的嵌套对象模型，否则 DTO 不会为您购买任何东西。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-31T21:42:58.680

这将根据我们正在谈论的系统的大小而有所不同。如果这些确实是独立的系统，那么它们以不同的方式看待同一概念是理所当然的。这称为有界上下文：[http ://dddcommunity.org/discussion/messageboardarchive/BoundedContext.html](http://dddcommunity.org/discussion/messageboardarchive/BoundedContext.html)

如果是这种情况，您可能会遇到的问题是您通过数据库在不同的有界上下文之间进行通信，而不是显式边界，通常在 API 级别。

另请注意，管理或返回信息子集并不一定意味着使用单独的类。您可以让一个共享类实现不同的接口，因此调用代码能够处理信息的子集。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-01T00:28:52.307

将实体从数据库中分离出来并没有错。您可以使用 Entity Framework 轻松完成此操作。您可以将多个实体映射到同一个表或一组表，每个表都具有不同的属性集。

另一方面，现在也没有理由不对共同的“自行车”定义进行标准化。如果数据服务 1 只想更新品牌和颜色，它可以有一个 UpdateBrandAndColor 操作。它不需要传递整个实体，只需传递它的 id、品牌和颜色。与#gears 和轮胎尺寸相同。

但是从 GetBicycle 操作返回的应该只有一个 Bicycle 实体类型。

# sql - 将整数转换为十六进制和十六进制转换为整数

> ID：703019
> 
> 赞同：78
> 
> 时间：2009-03-31T20:56:22.097
> 
> 标签：sql, sql-server, integer, hex

所以我让这个查询`signal_data`在 Sybase 中工作（列在哪里），但它在 Microsoft SQL Server 中不起作用：

```
HEXTOINT(SUBSTRING((INTTOHEX(signal_data)),5,2)) as Signal 
```

我在 Excel 中也有它（其中`A1`包含值）：

```
=HEX2DEC(LEFT(DEC2HEX(A1),LEN(DEC2HEX(A1))-2)) 
```

有谁知道我将如何在 SQL Server 中执行此操作？

* * *

## 回答 #1

> 赞同：127
> 
> 时间：2009-03-31T21:49:33.657

将 INT 转换为十六进制：

```
SELECT CONVERT(VARBINARY(8), 16777215) 
```

将十六进制转换为 INT：

```
SELECT CONVERT(INT, 0xFFFFFF) 
```

### 2015-03-16 更新

上面的例子有一个限制，它只在十六进制值作为整数文字给出时才有效。为了完整起见，如果要转换的值是十六进制字符串（例如在 varchar 列中找到），请使用：

```
-- If the '0x' marker is present:
SELECT CONVERT(INT, CONVERT(VARBINARY, '0x1FFFFF', 1))

-- If the '0x' marker is NOT present:
SELECT CONVERT(INT, CONVERT(VARBINARY, '1FFFFF', 2)) 
```

**注意：**字符串必须包含偶数个十六进制数字。奇数位数将产生错误。

更多详细信息可以在[CAST and CONVERT (Transact-SQL)](https://msdn.microsoft.com/en-us/library/ms187928.aspx)的“二进制样式”部分中找到。我相信需要 SQL Server 2008 或更高版本。

* * *

## 回答 #2

> 赞同：48
> 
> 时间：2011-03-02T19:04:53.323

实际上，内置函数名为 master.dbo.fn_varbintohexstr。

因此，例如：

```
SELECT 100, master.dbo.fn_varbintohexstr(100) 
```

给你

100 0x00000064

* * *

## 回答 #3

> 赞同：31
> 
> 时间：2013-05-02T20:06:48.197

SQL Server 等效于 Excel 的基于字符串的 DEC2HEX、HEX2DEC 函数：

```
--Convert INT to hex string:
PRINT CONVERT(VARCHAR(8),CONVERT(VARBINARY(4), 16777215),2) --DEC2HEX

--Convert hex string to INT:
PRINT CONVERT(INT,CONVERT(VARBINARY(4),'00FFFFFF',2)) --HEX2DEC 
```

* * *

## 回答 #4

> 赞同：18
> 
> 时间：2015-03-20T18:25:59.517

将 int 转换为十六进制：

`SELECT FORMAT(512+255,'X')`

* * *

## 回答 #5

> 赞同：18
> 
> 时间：2017-04-27T18:43:37.963

可以使用 SQL Server 2012 及更高版本上可用的函数 FORMAT

```
select FORMAT(10,'x2') 
```

结果是：

```
0a 
```

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2009-09-11T04:40:01.880

这是 SQL 服务器的函数，它将整数值转换为其十六进制表示形式作为 varchar。应该很容易适应其他数据库类型

例如：

```
SELECT dbo.ToHex(4095) --> FFF 
```

SQL：

```
CREATE FUNCTION ToHex(@value int)
RETURNS varchar(50)
AS
BEGIN
    DECLARE @seq char(16)
    DECLARE @result varchar(50)
    DECLARE @digit char(1)
    SET @seq = '0123456789ABCDEF'

    SET @result = SUBSTRING(@seq, (@value%16)+1, 1)

    WHILE @value > 0
    BEGIN
        SET @digit = SUBSTRING(@seq, ((@value/16)%16)+1, 1)

        SET @value = @value/16
        IF @value <> 0 SET @result = @digit + @result
    END 

    RETURN @result
END
GO 
```

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2012-02-21T12:52:27.053

传统的 4 位十六进制非常直接。十六进制字符串到整数（假设值存储在名为 FHexString 的字段中）：

```
CONVERT(BIGINT,CONVERT(varbinary(4),
                (SELECT master.dbo.fn_cdc_hexstrtobin(

                    LEFT(FMEID_ESN,8)                       
                ))
                )) 
```

整数到十六进制字符串（假设值存储在名为 FInteger 的字段中）：

```
(SELECT master.dbo.fn_varbintohexstr(CONVERT(varbinary,CONVERT(int,
                    FInteger
                )))) 
```

需要注意的重要一点是，当您开始使用导致寄存器共享的位大小时，尤其是在英特尔机器上，由于英特尔的小端特性，您在寄存器中的高、低、左和右将被交换。例如，当使用 varbinary(3) 时，我们谈论的是 6 个字符的 Hex。在这种情况下，您的位从右到左配对为以下索引“54,32,10”。在英特尔系统中，您会期望“76,54,32,10”。由于您只使用了 8 个中的 6 个，因此您需要记住自己进行交换。“76,54”将被视为您的左侧，“32,10”将被视为您的右侧。逗号分隔你的高和低。英特尔交换高点和低点，然后交换左右。所以要进行转换...叹息，例如，您必须自己交换它们，

```
(SELECT master.dbo.fn_replvarbintoint(
                CONVERT(varbinary(3),(SELECT master.dbo.fn_cdc_hexstrtobin(
                    --intel processors, registers are switched, so reverse them 

                    ----second half
                    RIGHT(FHex8,2)+ --0,1 (0 indexed)
                    LEFT(RIGHT(FHex8,4),2)+ -- 2,3 (oindex)
                    --first half
                    LEFT(RIGHT(FHex8,6),2) --4,5

                )))
                )) 
```

这有点复杂，所以我会尽量保持我的转换为 8 个字符的十六进制 (varbinary(4))。

总之，这应该回答你的问题。全面。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2009-07-02T10:38:09.130

用于`master.dbo.fnbintohexstr(16777215)`转换为`varchar`表示形式。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2013-02-06T21:53:50.003

```
Declare @Dato xml
Set @Dato = Convert(xml, '<dato>FF</dato>')
Select Cast( rw.value( 'xs:hexBinary( text()[1])' , 'varbinary(max)' ) as int ) From @Dato.nodes('dato') as T(rw) 
```

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2014-10-25T22:28:57.210

Maksym Kozlenko 的答案很好，可以稍微修改以处理将数值编码为任何代码格式。例如：

```
CREATE FUNCTION [dbo].[IntToAlpha](@Value int)
RETURNS varchar(30)
AS
BEGIN
    DECLARE @CodeChars varchar(100) 
    SET @CodeChars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ'
    DECLARE @CodeLength int = 26
    DECLARE @Result varchar(30) = ''
    DECLARE @Digit char(1)

    SET @Result = SUBSTRING(@CodeChars, (@Value % @CodeLength) + 1, 1)
    WHILE @Value > 0
    BEGIN
        SET @Digit = SUBSTRING(@CodeChars, ((@Value / @CodeLength) % @CodeLength) + 1, 1)
        SET @Value = @Value / @CodeLength
        IF @Value <> 0 SET @Result = @Digit + @Result
    END 

    RETURN @Result
END 
```

所以，像 1.5 亿这样的大数字，只有 6 个字符（150,000,000 = "MQGJMU"）

您还可以使用不同序列中的不同字符作为加密设备。或者传入编码字符和字符长度，用作加密的加盐方法。

反过来：

```
CREATE FUNCTION [dbo].[AlphaToInt](@Value varchar(7))
RETURNS int
AS
BEGIN
    DECLARE @CodeChars varchar(100) 
    SET @CodeChars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ'
    DECLARE @CodeLength int = 26
    DECLARE @Digit char(1)
    DECLARE @Result int = 0
    DECLARE @DigitValue int
    DECLARE @Index int = 0
    DECLARE @Reverse varchar(7)
    SET @Reverse = REVERSE(@Value)

    WHILE @Index < LEN(@Value)
    BEGIN
        SET @Digit = SUBSTRING(@Reverse, @Index + 1, 1)
        SET @DigitValue = (CHARINDEX(@Digit, @CodeChars) - 1) * POWER(@CodeLength, @Index)
        SET @Result = @Result + @DigitValue
        SET @Index = @Index + 1
    END 
    RETURN @Result 
```

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2019-02-15T17:37:00.583

**Maksym Kozlenko**有一个很好的解决方案，其他人接近释放**它的全部潜力**，但完全错过了意识到你可以定义任何字符序列，并将**它**的**长度用作 Base**。这就是为什么我喜欢他的解决方案的这个稍微修改过的版本，因为它适用于 base 16 或 base 17 等。

例如，如果您想要字母和数字，但不喜欢 I 看起来像 1 和 O 看起来像 0 怎么办。您可以通过这种方式定义任何序列。下面是“Base 36”的一种形式，它跳过 I 和 O 以创建“修改的 base 34”。取消注释十六进制行，而是以十六进制运行。

```
declare @value int = 1234567890

DECLARE @seq varchar(100) = '0123456789ABCDEFGHJKLMNPQRSTUVWXYZ' -- modified base 34
--DECLARE @seq varchar(100) = '0123456789ABCDEF' -- hex
DECLARE @result varchar(50)
DECLARE @digit char(1)
DECLARE @baseSize int = len(@seq)
DECLARE @workingValue int = @value

SET @result = SUBSTRING(@seq, (@workingValue%@baseSize)+1, 1)

WHILE @workingValue > 0
BEGIN
    SET @digit = SUBSTRING(@seq, ((@workingValue/@baseSize)%@baseSize)+1, 1)

    SET @workingValue = @workingValue/@baseSize
    IF @workingValue <> 0 SET @result = @digit + @result
END 

select @value as Value, @baseSize as BaseSize, @result as Result 
```

> 值、基数、结果
> 
> 1234567890, 34, T5URAA

我还将价值转移到工作价值，然后根据个人喜好从工作价值副本开始工作。

下面是对任何序列进行**反向转换**的附加内容，其中基数定义为序列的长度。

```
declare @value varchar(50) = 'T5URAA'

DECLARE @seq varchar(100) = '0123456789ABCDEFGHJKLMNPQRSTUVWXYZ' -- modified base 34
--DECLARE @seq varchar(100) = '0123456789ABCDEF' -- hex
DECLARE @result int = 0
DECLARE @digit char(1)
DECLARE @baseSize int = len(@seq)
DECLARE @workingValue varchar(50) = @value

DECLARE @PositionMultiplier int = 1
DECLARE @digitPositionInSequence int = 0

WHILE len(@workingValue) > 0
BEGIN
    SET @digit = right(@workingValue,1)
    SET @digitPositionInSequence = CHARINDEX(@digit,@seq)
    SET @result = @result + ( (@digitPositionInSequence -1) * @PositionMultiplier)

    --select @digit, @digitPositionInSequence, @PositionMultiplier, @result

    SET @workingValue = left(@workingValue,len(@workingValue)-1)
    SET @PositionMultiplier = @PositionMultiplier * @baseSize
END 

select @value as Value, @baseSize as BaseSize, @result as Result 
```

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2010-11-24T00:00:35.557

**鉴于：**

```
declare @hexStr varchar(16), @intVal int 
```

**IntToHexStr:**

```
select @hexStr = convert(varbinary, @intVal, 1) 
```

**HexStrToInt：**

```
declare
    @query varchar(100),
    @parameters varchar(50)

select
    @query = 'select @result = convert(int,' + @hb + ')',
    @parameters = '@result int output'

exec master.dbo.Sp_executesql @query, @parameters, @intVal output 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2013-11-12T14:48:08.953

```
IIF(Fields!HIGHLIGHT_COLOUR.Value="","#FFFFFF","#" & hex(Fields!HIGHLIGHT_COLOUR.Value) & StrDup(6-LEN(hex(Fields!HIGHLIGHT_COLOUR.Value)),"0")) 
```

作为字体颜色的表达为我工作

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2015-04-27T17:11:03.727

要将十六进制字符串转换为 INT，我过去曾使用过它。实际上可以修改它以将任何基数转换为 INT（八进制、二进制等）

```
Declare @Str varchar(200)
Set @str = 'F000BE1A'

Declare @ndx int
Set @ndx = Len(@str)
Declare @RunningTotal  BigInt
Set @RunningTotal = 0

While @ndx > 0
Begin
    Declare @Exponent BigInt
    Set @Exponent = Len(@Str) - @ndx

    Set @RunningTotal = @RunningTotal + 

    Power(16 * 1.0, @Exponent) *
    Case Substring(@str, @ndx, 1)
        When '0' then 0
        When '1' then 1
        When '2' then 2 
        When '3' then 3
        When '4' then 4
        When '5' then 5
        When '6' then 6
        When '7' then 7
        When '8' then 8
        When '9' then 9
        When 'A' then 10
        When 'B' then 11
        When 'C' then 12
        When 'D' then 13
        When 'E' then 14
        When 'F' then 15
    End
    Set @ndx = @ndx - 1
End

Print @RunningTotal 
```

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2015-05-21T10:02:00.577

下面是两个函数：dbo.HexToInt 和 dbo.IntToHex，我使用它们进行这样的转换：

```
if OBJECT_ID('dbo.HexToInt') is not null
    drop function dbo.HexToInt
GO
create function dbo.HexToInt (@chars varchar(max))
returns int
begin
    declare @char varchar(1), @len int, @i int, @r int, @tmp int, @pow int
    set @chars = RTRIM(LTRIM(@chars))
    set @len = LEN(@chars)
    set @i = 1
    set @r = 0
    while @i <= @len
    begin
        set @pow = @len - @i
        set @char = SUBSTRING(@chars, @i, 1)
        if @char = '0'
            set @tmp = 0
        else if @char = '1'
            set @tmp = 1
        else if @char = '2'
            set @tmp = 2
        else if @char = '3'
            set @tmp = 3
        else if @char = '4'
            set @tmp = 4
        else if @char = '5'
            set @tmp = 5
        else if @char = '6'
            set @tmp = 6
        else if @char = '7'
            set @tmp = 7
        else if @char = '8'
            set @tmp = 8
        else if @char = '9'
            set @tmp = 9
        else if @char = 'A'
            set @tmp = 10
        else if @char = 'B'
            set @tmp = 11
        else if @char = 'C'
            set @tmp = 12
        else if @char = 'D'
            set @tmp = 13
        else if @char = 'E'
            set @tmp = 14
        else if @char = 'F'
            set @tmp = 15
        set @r = @r + @tmp * POWER(16,@pow)
        set @i = @i + 1     
    end
    return @r
end 
```

第二个：

```
if OBJECT_ID('dbo.IntToHex') is not null
    drop function dbo.IntToHex
GO
create function dbo.IntToHex (@val int)
returns varchar(max)
begin
    declare @r varchar(max), @tmp int, @v1 int, @v2 int, @char varchar(1)
    set @tmp = @val
    set @r = ''
    while 1=1
    begin
        set @v1 = @tmp / 16
        set @v2 = @tmp % 16
        if @v2 = 0
            set @char = '0'
        else if @v2 = 1
            set @char = '1'
        else if @v2 = 2
            set @char = '2'
        else if @v2 = 3
            set @char = '3'
        else if @v2 = 4
            set @char = '4'
        else if @v2 = 5
            set @char = '5'
        else if @v2 = 6
            set @char = '6'
        else if @v2 = 7
            set @char = '7'
        else if @v2 = 8
            set @char = '8'
        else if @v2 = 9
            set @char = '9'
        else if @v2 = 10
            set @char = 'A'
        else if @v2 = 11
            set @char = 'B'
        else if @v2 = 12
            set @char = 'C'
        else if @v2 = 13
            set @char = 'D'
        else if @v2 = 14
            set @char = 'E'
        else if @v2 = 15
            set @char = 'F'
        set @tmp = @v1 
        set @r = @char + @r
        if @tmp = 0
            break
    end
    return @r
end 
```

# c# - 多个用户控件和程序集之间的共享资源字典

> ID：703026
> 
> 赞同：17
> 
> 时间：2009-03-31T20:59:13.043
> 
> 标签：c#, wpf, resources

我有一个包含多个用户控件的程序集。对于这个用户控件程序集，我想要一个资源字典。程序集中的所有用户控件都应该能够访问资源字典。我必须添加吗

```
<UserControl.Resources>
  <ResourceDictionary>
    <ResourceDictionary.MergedDictionaries>
      ...
    </ResourceDictionary.MergedDictionaries>
  </ResourceDictionary>
</UserControl.Resources> 
```

对于应该使用资源字典的每个用户控件，或者是否有某种方法可以将其放在一个地方并仅引用它？

然后我可以在我的主应用程序中引用它，还是也需要 MergedDictionaries 调用？

编辑：主应用程序与用户控件位于单独的项目/程序集中。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-04-01T11:21:42.207

> 有没有办法把它放在一个地方并引用它？

将您对资源字典的合并字典引用放入您的“App.xaml”文件中，它可以在您的整个应用程序中访问，您不需要进一步的引用。

> 然后我可以在我的主应用程序中引用它，还是也需要 MergedDictionaries 调用？

没有“App.xaml”的范围涵盖整个应用程序，所以这应该可以正常工作（对我有用:)）。

**更新：*如何从用户控件中引用资源字典存储的项目。***

在您的主项目中添加对您的用户控件库的引用。您的用户控件将是可访问的，您可以根据需要在您的应用程序中使用它们。

在 App.xaml 中添加资源字典引用的过程意味着所有控件都可以引用资源字典中定义的样式和数据模板等，因此只需引用它们即可：

例如

```
Style="{StaticResource MyButtonStyle}" 
```

此方法适用于复合应用程序和常规 WPF 应用程序。请注意，Visual Studio 不擅长从链接的 XAML 文件（资源字典）加载这些样式，但表达式混合会处理它，并会为编辑器提供预览。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-09-15T13:03:23.237

您可以使用*Pack URL*跨程序集引用资源字典。例如，在 Prism 项目（有多个模块，每个模块都有自己的程序集）中，我将公共资源字典存储在名为*Common的项目的**ResourceDictionaries*文件夹中。然后，通过在每个模块的 XAML 视图中使用与此类似的标记，我根据需要将这些字典合并到应用程序的模块中：

 *```
<UserControl.Resources>
    <ResourceDictionary>
        <ResourceDictionary.MergedDictionaries>
            <ResourceDictionary Source="pack://application:,,,/Common;component/ResourceDictionaries/DemoDictionary.xaml"/>
        </ResourceDictionary.MergedDictionaries>
    </ResourceDictionary>
</UserControl.Resources> 
```

您可以[在此处](http://books.google.com/books?id=XWu70Oqz6RIC&lpg=PP1&dq=Pro%20WPF%20in%20C%23%202008&pg=PA322#v=onepage&q=&f=false)找到更多信息。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-26T13:17:53.097

如果“App.xaml”方法对您不起作用，那么您可能会对这个讨论感兴趣：

[最佳实践：如何在模块化应用程序中处理共享资源？](http://compositeextensions.codeplex.com/discussions/42919)

jbe

# asp.net - Asp.Net 中的特殊错误页面

> ID：703027
> 
> 赞同：0
> 
> 时间：2009-03-31T20:59:18.737
> 
> 标签：asp.net, vb.net

我想重定向到一个特殊页面，该页面显示意外错误的详细错误消息。在 asp.net 中哪种解决方案最适合它？你能举个例子吗？谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-31T21:07:56.003

听起来您真正想做的就是关闭 web.config 文件中的自定义错误：

```
<configuration>
    <system.web>
        <customErrors mode="Off" />
    </system.web>
</configuration> 
```

对于任何未处理的异常，这应该会导致出现完整的“黄屏死机”。您还可以使用它来设置行为，以便完整的消息仅显示在您的本地计算机上，但您的用户会被重定向到某些东西......更友好：

```
<configuration>
    <system.web>
        <customErrors mode="RemoteOnly"  defaultRedirect="MyErrorPage.aspx" />
    </system.web>
</configuration> 
```

# c# - 弹出 HTML div 以选择列

> ID：703030
> 
> 赞同：0
> 
> 时间：2009-03-31T21:00:14.960
> 
> 标签：c#, asp.net, javascript, html, popup

我有一个 Web 应用程序（ASP.NET2.0 C#），在其中，我有一个从数据源获取数据的 gridview。

我想添加以下功能：用户可以单击“选择列”按钮，然后弹出一个框，其中包含所有列的列表（可能是 div 中的复选框列表），这样，用户可以选择列他们想要查看，然后单击另一个按钮“显示”，列列表消失，表格显示用户选择的列。

我已经实现了列选择部分，但它是我需要帮助的弹出部分。如何使 div 弹出然后消失？

该解决方案可能需要 javascript，我可能还没有弄清楚，因为我不太了解 javascript。

谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-10T04:24:06.190

嗨，最好让 div 的显示为无，而不是将可见性设置为隐藏。如果可见性设置为隐藏，即使 div 没有显示，但它会占用渲染空间，在某些情况下可能不是那么好。

您可以使用 createNode 动态创建一个 div，然后根据您的方便通过绝对定位和设置顶部和左侧，您可以将 div 对齐到页面中的任何部分。如果您可以在 div 弹出时禁用背景，那就更好了。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2009-03-31T21:22:32.440

创建 div 并设置 visible=false。当您想弹出它时，编写 javascript 以将其设置为可见 = true。这是一个很好的指针[http://lists.evolt.org/archive/Week-of-Mon-20020624/116151.html](http://lists.evolt.org/archive/Week-of-Mon-20020624/116151.html)

# architecture - 你什么时候真正被迫使用 UUID 作为设计的一部分？

> ID：703035
> 
> 赞同：131
> 
> 时间：2009-03-31T21:01:38.077
> 
> 标签：architecture, uuid

我真的不明白[UUID](http://en.wikipedia.org/wiki/UUID)的意义。我知道碰撞的概率*实际上是 nil*，但*实际上 nil*甚至不是不可能的。

有人可以举一个你别无选择只能使用 UUID 的例子吗？从我看到的所有用途中，我可以看到没有 UUID 的替代设计。当然，设计可能会稍微复杂一些，但至少它的失败概率不为零。

UUID 对我来说闻起来像全局变量。全局变量有很多方法可以简化设计，但它只是懒惰的设计。

* * *

## 回答 #1

> 赞同：651
> 
> 时间：2009-04-24T16:11:01.850

我为 Ruby 编写了 UUID 生成器/解析器，所以我认为自己对这个主题相当了解。有四个主要的 UUID 版本：

第 4 版 UUID 本质上只是从加密安全的随机数生成器中提取的 16 个字节的随机性，并通过一些位旋转来识别 UUID 版本和变体。这些是极不可能发生冲突的，但是如果使用 PRNG 或者如果你碰巧碰巧真的、真的、真的、真的、真的很倒霉，就会发生这种情况。

第 5 版和第 3 版 UUID 分别使用 SHA1 和 MD5 哈希函数，将命名空间与一段已经唯一的数据结合起来生成 UUID。例如，这将允许您从 URL 生成 UUID。只有当底层哈希函数也有冲突时，这里才有可能发生冲突。

版本 1 UUID 是最常见的。他们使用网卡的 MAC 地址（除非被欺骗，否则应该是唯一的），加上时间戳，再加上通常的位旋转来生成 UUID。对于没有 MAC 地址的机器，6 个节点字节是使用加密安全随机数生成器生成的。如果按顺序生成两个 UUID 的速度足够快，以至于时间戳与前一个 UUID 匹配，则时间戳会增加 1。除非发生以下情况之一，否则不应发生冲突： MAC 地址被欺骗；一台运行两个不同 UUID 生成应用程序的机器在完全相同的时刻生成 UUID；两台没有网卡或没有用户级别访问MAC地址的机器被赋予相同的随机节点序列，并在完全相同的时刻生成UUID；

实际上，这些事件都不会在单个应用程序的 ID 空间内偶然发生。除非您在互联网范围内接受 ID，或者在不受信任的环境中，恶意个人可能会在 ID 冲突的情况下做坏事，否则您不必担心。至关重要的是，如果您碰巧生成了与我相同的版本 4 UUID，在大多数情况下，这并不重要。我在与您完全不同的 ID 空间中生成了 ID。我的应用程序永远不会知道碰撞，所以碰撞无关紧要。坦率地说，在没有恶意行为者的单个应用程序空间中，地球上所有生命的灭绝将在您发生碰撞之前很久就发生，即使在版本 4 UUID 上，即使您

此外，2^64 * 16 是 256 艾字节。例如，您需要存储 256 EB 的 ID，然后才有 50% 的机会在单个应用程序空间中发生 ID 冲突。

* * *

## 回答 #2

> 赞同：73
> 
> 时间：2009-03-31T21:49:14.420

UUID 给您带来的一件很难做到的事情是在*无需咨询或与中央机构协调的情况下*获得唯一标识符。在没有某种托管基础设施的情况下能够获得这样的东西的一般问题是 UUID 解决的问题。

我读过，根据生日悖论，一旦生成了 2^64 个 UUID，发生 UUID 冲突的几率为 50%。现在 2^64 是一个相当大的数字，但 50% 的碰撞几率似乎太冒险了（例如，在有 5% 的碰撞几率之前需要存在多少个 UUID - 即使这看起来可能性太大了） .

该分析的问题是双重的：

1.  UUID 不是完全随机的——UUID 的主要组成部分是基于时间和/或位置的。因此，为了真正有机会发生碰撞，需要从不同的 UUID 生成器同时生成碰撞的 UUID。我想说的是，虽然有可能同时生成多个 UUID，但有足够多的其他垃圾（包括位置信息或随机位）使得这组非常小的 UUID 之间发生冲突的可能性几乎是不可能的.

2.  严格来说，UUID 只需要在可能与之进行比较的其他 UUID 集合中是唯一的。如果您正在生成一个 UUID 以用作数据库密钥，那么在邪恶的替代宇宙中的其他地方是否使用相同的 UUID 来识别 COM 接口并不重要。就像在半人马座 Alpha-Centauri 上有其他人（或某物）名为“Michael Burr”时不会引起混淆一样。

* * *

## 回答 #3

> 赞同：35
> 
> 时间：2009-04-03T13:35:11.740

任何事情都有非零失败的机会。我会专注于更可能发生的问题（即几乎任何你能想到的问题）而不是 UUID 的冲突

* * *

## 回答 #4

> 赞同：17
> 
> 时间：2009-03-31T21:06:18.160

强调“合理地”，或者，正如你所说的，“有效地”：现实世界的运作方式已经足够好。弥补“几乎独一无二”和“真正独一无二”之间的差距所涉及的计算工作量是巨大的。唯一性是一条收益递减的曲线。在这条曲线上的某个点，在“足够独特”仍然可以负担得起的地方之间有一条线，然后我们的曲线非常陡峭。添加更多独特性的成本变得相当大。无限的独特性具有无限的成本。

相对而言，UUID/GUID 是一种计算上快速且简单的方式来生成可以*合理*假设为普遍唯一的 ID。这在许多需要集成来自以前未连接系统的数据的系统中非常重要。例如：如果您有一个在两个不同平台上运行的内容管理系统，但有时需要将内容从一个系统导入另一个系统。您不希望 ID 更改，因此来自系统 A 的数据之间的引用保持不变，但您不希望与系统 B 中创建的数据发生任何冲突。UUID 解决了这个问题。

* * *

## 回答 #5

> 赞同：16
> 
> 时间：2009-03-31T21:09:13.707

创建 UUID 从来都不是绝对必要的。然而，有一个标准是很方便的，在这个标准中，*离线*用户每个人都可以生成一个碰撞概率非常低的东西的密钥。

这可以帮助解决数据库复制等问题......

*在线*用户很容易为某些东西生成唯一密钥，而不会产生开销或冲突的可能性，但这不是 UUID 的用途。

无论如何，关于碰撞概率的一句话，取自维基百科：

> 从这些数字来看，一个人每年被陨石击中的风险估计为 170 亿分之一，相当于在一年内创建几十万亿个 UUID 并有一个重复的几率。换句话说，仅在接下来的 100 年每秒生成 10 亿个 UUID 之后，仅创建一个副本的概率约为 50%。

* * *

## 回答 #6

> 赞同：15
> 
> 时间：2009-03-31T22:32:23.990

还有一个非零概率，你身体中的每个粒子都会同时穿过你坐的椅子，你会突然发现自己坐在地板上。

你担心吗？

* * *

## 回答 #7

> 赞同：13
> 
> 时间：2009-03-31T21:05:03.480

一个典型的例子是当您在两个数据库之间进行复制时。

DB(A) 插入一条 int ID 为 10 的记录，同时 DB(B) 创建一条 ID 为 10 的记录。这是一个冲突。

使用 UUID 不会发生这种情况，因为它们不会匹配。（几乎可以确定）

* * *

## 回答 #8

> 赞同：9
> 
> 时间：2010-04-07T09:04:23.690

我有一个避免 UUID 的方案。在某处设置一个服务器并拥有它，这样每当某个软件需要一个通用唯一标识符时，他们就会联系该服务器并分发一个。简单的！

除了这有一些真正的实际问题，即使我们忽略了彻底的恶意。特别是，该服务器可能会出现故障或无法从部分 Internet 访问。处理服务器故障需要复制，而且*很难*做到正确（请参阅有关 Paxos 算法的文献，了解为什么建立共识很尴尬），而且速度也很慢。此外，如果从网络的特定部分无法访问所有服务器，则连接到该子网的所有客户端*都*无法执行任何操作，因为它们都将等待新的 ID。

所以......使用一个简单的概率算法来生成它们在地球的生命周期内不太可能发生故障，或者（资助和）构建一个将成为部署 PITA 并经常发生故障的主要基础设施。我知道我会去哪一个。

* * *

## 回答 #9

> 赞同：6
> 
> 时间：2016-09-08T06:26:16.740

我没有得到所有关于碰撞可能性的讨论。我不在乎碰撞。不过我关心性能。

[https://dba.stackexchange.com/a/119129/33649](https://dba.stackexchange.com/a/119129/33649)

> UUID 对于非常大的表来说是一场性能灾难。（200K 行不是“非常大”。）
> 
> 当 CHARCTER SET 为 utf8 时，您的 #3 真的很糟糕——CHAR(36) 占用 108 个字节！
> 
> UUID (GUID) 非常“随机”。将它们用作大型表上的唯一键或主键是非常低效的。这是因为每次插入新的 UUID 或通过 UUID 选择时都必须在表/索引中跳转。当表/索引太大而无法放入缓存时（请参阅 innodb_buffer_pool_size，它必须小于 RAM，通常为 70%），“下一个”UUID 可能不会被缓存，因此磁盘命中速度很慢。当表/索引是缓存的 20 倍时，只有 1/20（5%）的命中被缓存——你是 I/O 绑定的。
> 
> 所以，不要使用 UUID，除非
> 
> 你有“小”表，或者你真的需要它们，因为从不同的地方生成唯一的 ID（并且还没有想出另一种方法来做到这一点）。有关 UUID 的更多信息：http: [//mysql.rjweb.org/doc.php/uuid](http://mysql.rjweb.org/doc.php/uuid)（它包括用于在标准 36 字符 UUID 和 BINARY(16) 之间转换的函数。）
> 
> 在同一个表中同时拥有 UNIQUE AUTO_INCREMENT 和 UNIQUE UUID 是一种浪费。
> 
> 发生 INSERT 时，必须检查所有唯一/主键是否重复。任一唯一键都足以满足 InnoDB 拥有主键的要求。BINARY(16)（16 字节）有点庞大（反对将其设为 PK 的论据），但还不错。当您有辅助键时，体积很重要。InnoDB 默默地将 PK 附加到每个辅助键的末尾。这里的主要教训是最小化辅助键的数量，尤其是对于非常大的表。比较：INT UNSIGNED 为 4 字节，范围为 0..4 亿。BIGINT 为 8 个字节。

* * *

## 回答 #10

> 赞同：4
> 
> 时间：2010-01-26T15:47:14.163

如果您只是查看替代方案，例如对于一个简单的数据库应用程序，每次创建新对象之前都必须查询数据库，您很快就会发现使用 UUID 可以有效地降低系统的复杂性。授予 - 如果您使用 int 键，则为 32 位，它将存储在 128 位 UUID 的四分之一中。授予 - UUID 生成算法比简单地增加一个数字占用更多的计算能力。但谁在乎？管理“授权”以分配其他唯一编号的开销很容易超过数量级，具体取决于您预期的唯一性 ID 空间。

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2009-03-31T21:52:06.737

**关于 UUID==惰性设计**

我不同意它关于挑选你的战斗。如果重复的 UUID 在统计上是不可能的并且数学证明了，那么为什么要担心呢？花时间围绕您的小型 N UUID 生成系统进行设计是不切实际的，总有十几种其他方法可以改进您的系统。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2009-03-31T21:04:22.797

在我的上一份工作中，我们从第三方获取了使用 UUID 唯一标识的对象。我放入了一个 UUID->long integer 查找表并使用 long integer 作为我的主键，因为这样更快。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2009-03-31T21:23:58.477

使用第 1 版算法，在从同一 MAC 地址生成的每毫秒少于 10 个 UUID 的约束下，似乎不可能发生冲突

> 从概念上讲，UUID 的原始（版本 1）生成方案是将 UUID 版本与生成 UUID 的计算机的 MAC 地址以及自西方采用公历以来的 100 纳秒间隔数连接起来. 在实践中，实际算法更复杂。该方案被批评为不够“不透明”；它揭示了生成 UUID 的计算机的身份以及它生成的时间。

如果我误解了它的工作原理，请有人纠正我

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2015-12-04T21:24:02.460

对于那些说 UUID 是糟糕的设计的人，因为它们*可能*（以某种可笑的小概率）发生冲突，而您的数据库生成的密钥不会……您知道人为错误的可能性会导致您的数据库生成的密钥发生冲突，因为一些 un - 预见需要远高于 UUID4 冲突的机会。我们*知道*，如果重新创建数据库，它将再次从 1 开始 ids，当我们确定永远不需要重新创建表时，我们中有多少人不得不重新创建表？当任何一天未知的未知事物开始出现问题时，我会把钱花在 UUID 安全上。

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2018-07-31T22:24:13.423

除了必须使用需要 UUID 的其他人的 API 的情况之外，当然还有另一种解决方案。但是这些替代方案能解决UUID 的*所有*问题吗？当您可以一次解决所有问题时，您最终会添加更多层的hack，每层解决一个不同的问题吗？

是的，理论上 UUID 有可能发生冲突。正如其他人所指出的那样，它不太可能达到不值得考虑的程度。迄今为止从未发生过，而且很可能永远不会发生。忘掉它。

避免冲突的最“明显”的方法是让单个服务器在每次插入时生成唯一的 ID，这显然会产生严重的性能问题，并且根本无法解决离线生成问题。哎呀。

另一个“显而易见”的解决方案是一个中央机构，它提前分发唯一编号块，这本质上是 UUID V1 通过使用生成机器的 MAC 地址（通过 IEEE OUI）所做的。但是重复的 MAC 地址确实会发生，因为每个中央机构最终都会搞砸，所以在实践中，这比 UUID V4 冲突更有可能发生。哎呀。

反对使用 UUID 的最佳论据是它们“太大”，但是（显着）较小的方案将不可避免地无法解决最有趣的问题；UUID 的大小是它们在解决这些问题时有用的固有副作用。

您的问题可能不够大，不足以需要 UUID 提供的功能，在这种情况下，请随意使用其他东西。但是，如果您的问题出乎意料地增长（而且大多数情况如此），那么您最终会在以后切换 - 并且会因为一开始没有使用它们而自责。当为成功而设计同样容易时，为什么要为失败而设计呢？

* * *

## 回答 #16

> 赞同：-11
> 
> 时间：2012-10-12T07:14:00.323

UUID 体现了与全局变量相关的所有不良编码实践，更糟糕的是，因为它们是超全局变量，可以分布在不同的工具包中。

最近遇到这样的问题，用一个确切的替换型号替换打印机，发现没有一个客户端软件可以工作。

# svn - 在 Subversion 提交之前修改文件

> ID：703036
> 
> 赞同：2
> 
> 时间：2009-03-31T21:01:44.783
> 
> 标签：svn, tortoisesvn

我正在使用适用于 Windows 的 TortoiseSVN，并想知道我是否可以设置某种宏来在提交时修改存储库中的一个文件。

在我的 subversion 存储库中，我有一个名为“Web.Config”的 XML 文件。在 XML 文档中设置了一些带有标签名称“add”的节点，这些节点代表 XML 路径 /Configuration/appSettings 下的“Build Number”、“Build Description”和“Last Build Date”。此 XML 文件使用“add”节点上的“key”属性来确定正在设置哪些设置。

上述节点在每次提交之前都是手动更改的（据说，但我并不总是这样做）。

我的问题是：提交时是否可以修改文件中的这些设置？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-31T21:12:26.007

**考虑在提交后**使用 subwcrev.exe 将构建（修订）号注入您的 web.config 。根据我的经验，这通常是这样做的（而不是在提交之前这样做）——只需将 subwcrev 添加为构建步骤、构建后步骤或“发布”步骤的一部分。

正如我在上面的评论中所说，我不太确定使用预提交钩子是否是一个好主意，因为这意味着你的本地文件在你提交的那一刻就立即过时了。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-31T21:09:43.987

您可能可以使用预提交挂钩脚本。预提交挂钩可让您在服务器提交更改之前执行脚本。一篇关于设置预提交钩子脚本的好文章在[这里](http://wordaligned.org/articles/a-subversion-pre-commit-hook)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-31T21:05:31.030

也许使用 svn 预提交钩子？

另一种选择（我更喜欢并使用的那个）是在构建期间将此数据放入您的 Web 程序集，然后您在代码中以编程方式读取它。如果您使用的是.NET，那就是:)

1.  在您的构建中添加一个步骤以生成通用的 AssemblyInfo.cs。（参见[[](http://blog.darrenstokes.com/2007/12/17/ease-versioning-multiple-assemblies-by-splitting-up-assemblyinfo/) [http://blog.darrenstokes.com/2007/12/17/ease-versioning-multiple-assemblies-by-splitting-up-assemblyinfo/]）1](http://blog.darrenstokes.com/2007/12/17/ease-versioning-multiple-assemblies-by-splitting-up-assemblyinfo/])
2.  将此文件“添加为链接”到您的每个项目
3.  当你需要这些信息时，可以从 Reflection 中获取，例如：

    System.Diagnostics.FileVersionInfo 版本 = System.Diagnostics.FileVersionInfo.GetVersionInfo
    (System.Reflection.Assembly.GetExecutingAssembly ().Location);

    Console.Out.WriteLine ("MyApplication v{0} by Me", version.FileVersion);

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-31T21:12:10.483

也许您可以找出一个不需要像那样修改文件的不同系统。

另外，我怀疑您有致力于源代码控制的非源代码、非依赖项部署。我将仅包含您的项目的源代码以及您的项目在源代码控制中引用的第三方程序集。我会忽略您的项目`\bin`和`\obj`目录。

每个人都应该能够从源代码控制中检查最新（或任何版本），为他们的环境设置外部因素（创建数据库，设置权限等），执行项目的构建脚本，并拥有一个功能齐全的应用程序.

但是，将最新的 .dll 或 .msi 直接保存在源代码控制中并不是拥有一个功能齐全的项目所必需的，而且可能不是一个好主意。

# jboss - JBoss 5 AS 中的 JMS 主题创建

> ID：703040
> 
> 赞同：2
> 
> 时间：2009-03-31T21:02:46.577
> 
> 标签：jboss, jms

在 Jboss 4 中，当我为部署描述符中未指定的主题部署带有 MDB 的耳朵时，服务器将自动创建该主题（在发布一条警告说该主题不存在之后）。

在 Jboss 5 中，它似乎不再自动创建主题（而是出错）。是否有允许自动创建主题的配置选项？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-02T16:25:07.643

来自 JBoss 社区论坛——[这个 JIRA](https://jira.jboss.org/jira/browse/JBAS-6013)是在 5AS 中添加的。

不幸的是，似乎没有办法在standardjboss.xml 描述符中全局实现createDestination——您必须将自定义jboss.xml 描述符添加到部署mdb 的ear 中。

```
<jboss xsi:schemaLocation="http://www.jboss.com/xml/ns/javaee
 http://www.jboss.org/j2ee/schema/jboss_5_0.xsd" version="3.0">
    <enterprise-beans>
       <message-driven>
          <ejb-name>MessageDriven</ejb-name>
          <create-destination>true</create-destination>
       </message-driven>
    </enterprise-beans>
</jboss> 
```

# java - Eclipse + 将现有项目转变为 JP A 项目

> ID：703043
> 
> 赞同：21
> 
> 时间：2009-03-31T21:03:21.130
> 
> 标签：java, eclipse, jpa, jakarta-ee, eclipse-plugin

有没有办法将普通的 Eclipse 项目变成 JPA 项目？

我有一个包含实体的普通项目和一个 Persistence.xml 文件，但它不是 Eclipse 识别的 JPA 项目。我能做些什么？

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2010-09-09T14:44:44.733

项目属性 --> 项目方面。在那里，您可以单击 JPA 复选框，您就有了一个 JPA 项目。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2010-09-09T14:53:52.170

您也可以右键单击 eclipse 项目并单击配置，它允许您转换为 JPA 项目。

![替代文字](https://i.stack.imgur.com/w4qFc.gif)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-31T22:45:40.680

您需要修改：

*   你的 .project
*   你的 .classpath （最终）
*   如果你不走运，你的 .settings

正如 Chris Nava 所说，最好的方法是创建一个空的 JPA 项目并将其与您的项目进行比较。

我发现有时需要删除您的原始项目（不要“删除磁盘上的项目内容”！）并重新导入它以使 Eclipse 满意。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-31T21:08:09.043

Eclipse 通过项目根目录中的 .project 文件知道项目类型。尝试创建一个新的 JPA 项目并比较 .project 文件。

编辑：您可能还需要比较 .classpath 文件。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-09T15:13:06.633

手动修改 .project 文件是将不同的“性质”添加到 Eclipse 项目的最佳方式。就像 ptyx 所说：将您当前的 .project 文件与您想要的性质的项目进行比较，然后合并差异。

# ruby - Ruby：如何为数组和哈希制作 IRB 打印结构

> ID：703049
> 
> 赞同：70
> 
> 时间：2009-03-31T21:05:00.220
> 
> 标签：ruby, irb

当我在**irb**中创建一个新数组/哈希时，它会打印出一个很好的格式来显示结构，例如。

```
["value1", "value2", "value3"]
{"key1" => "value1"} 
```

...但是当我尝试使用 打印出我的变量时`puts`，我将它们折叠起来：

```
value1
value2
value3
key1
value1 
```

我认为这`puts`不是我想要的正确命令，但是什么是？我希望能够以第一种格式而不是第二种格式查看**irb中的变量。**

* * *

## 回答 #1

> 赞同：121
> 
> 时间：2009-03-31T21:12:34.913

您可以使用以下`inspect`方法：

```
a=["value1", "value2", "value3"]
puts a.inspect 
```

或者，更好的是，使用 pp（漂亮打印）库：

```
require 'pp'
a=["value1", "value2", "value3"]
pp a 
```

* * *

## 回答 #2

> 赞同：59
> 
> 时间：2009-07-15T00:57:28.883

您可以做的另一件事是使用`y`将输入转换为 Yaml 的方法。这会产生非常好的输出......

```
>> data = { 'dog' => 'Flemeale', 'horse' => 'Gregoire', 'cow' => 'Fleante' }
=> {"cow"=>"Fleante", "horse"=>"Gregoire", "dog"=>"Flemeale"}
>> y data
--- 
cow: Fleante
horse: Gregoire
dog: Flemeale 
```

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2012-02-20T14:43:10.970

漂亮的打印效果很好，但[Awesome_Print](https://github.com/michaeldv/awesome_print) gem 更好！您将不得不这样做， `require awesome_print`但它可以很好地处理嵌套的哈希和数组，并在终端中使用“ap”而不是“p”为它们着色以放置输出。

您还可以将它包含在您的 ~/.irbrc 中，以将其作为显示对象的默认方法：

```
require "awesome_print"
AwesomePrint.irb! 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-03-31T21:12:40.140

试试 .inspect

```
>> a = ["value1", "value2", "value3"]
=> ["value1", "value2", "value3"]
>> a.inspect
=> "[\"value1\", \"value2\", \"value3\"]"
>> a = {"key1" => "value1"}
=> {"key1"=>"value1"}
>> a.inspect
=> "{\"key1\"=>\"value1\"}" 
```

您还可以使用 p() 方法打印它们：

```
>> p a
{"key1"=>"value1"} 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2012-01-06T20:14:45.900

我为此选择的个人工具是“Pretty Print”和`pp`方法

```
require 'pp' # <- 'Pretty Print' Included in ruby standard library
pp({ :hello => :world, :this => ['is', 'an', 'array'] })
=> {:hello=>:world, :this=>["is", "an", "array"]} 
```

# wcf - WCF：Net.TCP 多个绑定，相同的端口，不同的 IP 地址

> ID：703051
> 
> 赞同：9
> 
> 时间：2009-03-31T21:05:12.000
> 
> 标签：wcf, wcf-binding, net.tcp

我遇到了一个问题。我在 WCF 有点新，所以任何帮助都会非常感激。

这是我的代码：

```
public static void StartHosts()
    {
        try
        {
            // Create a new host
            ServiceHost host = new ServiceHost(typeof(ServerTasks));

            List<IPAddress> ips = new List<IPAddress>(Dns.GetHostAddresses(Dns.GetHostName()));
            if (IPAddress.Loopback != null)
                ips.Add(IPAddress.Loopback);

            ips.RemoveAll(i => i.AddressFamily != AddressFamily.InterNetwork);

            foreach (var ip in ips)
            {
                string uri = string.Empty;

                // Formulate the uri for this host
                uri = string.Format(
                    "net.tcp://{0}:{1}/ServerTasks",
                    ip.ToString(),
                    ServerSettings.Instance.TCPListeningPort
                );

                // Add the endpoint binding
                host.AddServiceEndpoint(
                    typeof(ServerTasks),
                    new NetTcpBinding(SecurityMode.Transport) { TransferMode = TransferMode.Streamed },
                    uri
                );

            }

            // Add the meta data publishing
            var smb = host.Description.Behaviors.Find<ServiceMetadataBehavior>();
            if (smb == null)
                smb = new ServiceMetadataBehavior();

            smb.MetadataExporter.PolicyVersion = PolicyVersion.Policy15;
            host.Description.Behaviors.Add(smb);

            host.AddServiceEndpoint(
                ServiceMetadataBehavior.MexContractName,
                MetadataExchangeBindings.CreateMexTcpBinding(),
                "net.tcp://localhost/ServerTasks/mex"
            );

            // Run the host
            host.Open();
        }
        catch (Exception exc)
        {
            DebugLogger.WriteException(exc);
        }
    } 
```

在线抛出异常：'host.Open();'

例外是：

***System.InvalidOperationException*** *URI 'net.tcp://192.168.1.45:4329/ServerTasks' 的注册已经存在。*

我要做的是绑定到机器上的所有网络地址，以便客户端应用程序可以从他们看到的任何网络访问服务。当我运行此代码时，它会找到并尝试为大约 5 个不同的 IP（包括 127.0.0.1）设置绑定。

192.168.1.45 是它尝试绑定的第二个 IP。在它引发异常时，我可以看到（使用 netstat）程序已绑定到端口 4329 上列表中的第一个 IP。异常中提到的地址上没有任何绑定到端口 4329 的内容。

抱歉，没有太多细节，我想写一个简洁的帖子。如果有人需要更多信息，我很乐意提供。

注意：对于在 foreach 循环中创建的 NetTcpBinding，我尝试将 PortSharingEnabled 设置为 true，但我仍然遇到相同的错误。

任何帮助或建议将不胜感激！

谢谢

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-04-01T15:43:59.830

感谢科拉扎的信息！

我已经想出了如何做到这一点。我一直在做错事。

我的最终目标是让服务监听机器上每个可用的 IP 地址。尝试单独绑定到每个地址是错误的做法。

相反，我只需要将服务绑定到机器的*主机名*（不是“localhost”），WCF 就会自动侦听所有适配器。

这是更正后的代码：

```
public static void StartHosts()
    {
        try
        {
            // Formulate the uri for this host
            string uri = string.Format(
                "net.tcp://{0}:{1}/ServerTasks",
                Dns.GetHostName(),
                ServerSettings.Instance.TCPListeningPort
            );

            // Create a new host
            ServiceHost host = new ServiceHost(typeof(ServerTasks), new Uri(uri));

            // Add the endpoint binding
            host.AddServiceEndpoint(
                typeof(ServerTasks),
                new NetTcpBinding(SecurityMode.Transport) 
                        { 
                            TransferMode = TransferMode.Streamed
                        },
                uri
            );

            // Add the meta data publishing
            var smb = host.Description.Behaviors.Find<ServiceMetadataBehavior>();
            if (smb == null)
                smb = new ServiceMetadataBehavior();

            smb.MetadataExporter.PolicyVersion = PolicyVersion.Policy15;
            host.Description.Behaviors.Add(smb);

            host.AddServiceEndpoint(
                ServiceMetadataBehavior.MexContractName,
                MetadataExchangeBindings.CreateMexTcpBinding(),
                "net.tcp://localhost/ServerTasks/mex"
            );

            // Run the host
            host.Open();
        }
        catch (Exception exc)
        {
            DebugLogger.WriteException(exc);
        }
    } 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-01T00:58:45.387

梅尔，

虽然我自己之前从未尝试过，但这里有一些我以前听过的样本可供参考。您可能希望首先创建绑定对象，然后将相同的实例添加到 AddServiceEndpoint 方法，这只是一个想法，所以您不会每次都创建新的绑定，因为我记得在某处读到 netTCPBindings 应该与地址为 1:1 关系（即使您使用不同的地址）。

我认为您在打开多个端口时不必担心端口共享。

这是您可能希望使用多个端口完成的示例。

[http://www.aspfree.com/c/a/Windows-Scripting/WCF-and-Bindings/2/](http://www.aspfree.com/c/a/Windows-Scripting/WCF-and-Bindings/2/)

这是在 NetTcpBinding 上使用端口共享的一个很好的示例。

[http://blogs.msdn.com/drnick/archive/2006/08/08/690333.aspx](http://blogs.msdn.com/drnick/archive/2006/08/08/690333.aspx)

-布莱恩

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-03-11T09:38:11.590

看来我来晚了:)。但无论如何 - 有一种非常简单的方法可以让 Wcf 监听所有可用的网络接口“net.tcp://0.0.0.0:8523/WCFTestService”。

# .net - 在已部署的 ASP.NET 网站项目上，我可以在不重新编译的情况下更新 .resx 文件吗？

> ID：703054
> 
> 赞同：5
> 
> 时间：2009-03-31T21:05:38.677
> 
> 标签：.net, asp.net, localization, resx

我正在将 ASP.NET 应用程序部署到锁定的生产环境。将程序集（包括卫星资源程序集）推送到此环境具有与之关联的过程，但将非程序集复制到环境中则没有。

在 ASP.NET 网站项目中，我可以在不重新编译的情况下更新 .resx 文件吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-31T21:16:43.237

我想这取决于您的应用程序对它们做什么。

如果您将 .resx 文件推送到您网站的 App_LocalResources 文件夹中，它们将在您执行此操作后立即自动编译。所以在这种情况下，你不必重新编译任何东西。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-09-18T15:36:10.797

不，你不能。它不仅会强制重新编译，还会卸载 appdomain 并触发应用程序重启（进程中的内存丢失）。内置提供程序无法解决此问题。此处提供更多上下文：[http](http://www.onpreinit.com/2009/06/updatable-aspnet-resx-resource-provider.html) ://www.onpreinit.com/2009/06/updatable-aspnet-resx-resource-provider.html 。

# ruby - 有效的电子邮件地址正则表达式？

> ID：703060
> 
> 赞同：43
> 
> 时间：2009-03-31T21:06:25.833
> 
> 标签：ruby, regex, validation, email

我已经做了一些测试，但我想问一下是否有人发现这个用于电子邮件验证的 ruby​​ 正则表达式有问题：

```
/\A([^@\s]+)@((?:[-a-z0-9]+\.)+[a-z]{2,})\Z/i 
```

看起来不错？

* * *

## 回答 #1

> 赞同：161
> 
> 时间：2009-03-31T21:08:37.030

你已经很接近了，只需要添加几个字符：

```
(?:(?:\r\n)?[ \t])*(?:(?:(?:[^()<>@,;:\\".\[\] \000-\031]+(?:(?:(?:\r\n)?[ \t]
)+|\Z|(?=[\["()<>@,;:\\".\[\]]))|"(?:[^\"\r\\]|\\.|(?:(?:\r\n)?[ \t]))*"(?:(?:
\r\n)?[ \t])*)(?:\.(?:(?:\r\n)?[ \t])*(?:[^()<>@,;:\\".\[\] \000-\031]+(?:(?:(
?:\r\n)?[ \t])+|\Z|(?=[\["()<>@,;:\\".\[\]]))|"(?:[^\"\r\\]|\\.|(?:(?:\r\n)?[ 
\t]))*"(?:(?:\r\n)?[ \t])*))*@(?:(?:\r\n)?[ \t])*(?:[^()<>@,;:\\".\[\] \000-\0
31]+(?:(?:(?:\r\n)?[ \t])+|\Z|(?=[\["()<>@,;:\\".\[\]]))|\[([^\[\]\r\\]|\\.)*\
](?:(?:\r\n)?[ \t])*)(?:\.(?:(?:\r\n)?[ \t])*(?:[^()<>@,;:\\".\[\] \000-\031]+
(?:(?:(?:\r\n)?[ \t])+|\Z|(?=[\["()<>@,;:\\".\[\]]))|\[([^\[\]\r\\]|\\.)*\](?:
(?:\r\n)?[ \t])*))*|(?:[^()<>@,;:\\".\[\] \000-\031]+(?:(?:(?:\r\n)?[ \t])+|\Z
|(?=[\["()<>@,;:\\".\[\]]))|"(?:[^\"\r\\]|\\.|(?:(?:\r\n)?[ \t]))*"(?:(?:\r\n)
?[ \t])*)*\<(?:(?:\r\n)?[ \t])*(?:@(?:[^()<>@,;:\\".\[\] \000-\031]+(?:(?:(?:\
r\n)?[ \t])+|\Z|(?=[\["()<>@,;:\\".\[\]]))|\[([^\[\]\r\\]|\\.)*\](?:(?:\r\n)?[
 \t])*)(?:\.(?:(?:\r\n)?[ \t])*(?:[^()<>@,;:\\".\[\] \000-\031]+(?:(?:(?:\r\n)
?[ \t])+|\Z|(?=[\["()<>@,;:\\".\[\]]))|\[([^\[\]\r\\]|\\.)*\](?:(?:\r\n)?[ \t]
)*))*(?:,@(?:(?:\r\n)?[ \t])*(?:[^()<>@,;:\\".\[\] \000-\031]+(?:(?:(?:\r\n)?[
 \t])+|\Z|(?=[\["()<>@,;:\\".\[\]]))|\[([^\[\]\r\\]|\\.)*\](?:(?:\r\n)?[ \t])*
)(?:\.(?:(?:\r\n)?[ \t])*(?:[^()<>@,;:\\".\[\] \000-\031]+(?:(?:(?:\r\n)?[ \t]
)+|\Z|(?=[\["()<>@,;:\\".\[\]]))|\[([^\[\]\r\\]|\\.)*\](?:(?:\r\n)?[ \t])*))*)
*:(?:(?:\r\n)?[ \t])*)?(?:[^()<>@,;:\\".\[\] \000-\031]+(?:(?:(?:\r\n)?[ \t])+
|\Z|(?=[\["()<>@,;:\\".\[\]]))|"(?:[^\"\r\\]|\\.|(?:(?:\r\n)?[ \t]))*"(?:(?:\r
\n)?[ \t])*)(?:\.(?:(?:\r\n)?[ \t])*(?:[^()<>@,;:\\".\[\] \000-\031]+(?:(?:(?:
\r\n)?[ \t])+|\Z|(?=[\["()<>@,;:\\".\[\]]))|"(?:[^\"\r\\]|\\.|(?:(?:\r\n)?[ \t
]))*"(?:(?:\r\n)?[ \t])*))*@(?:(?:\r\n)?[ \t])*(?:[^()<>@,;:\\".\[\] \000-\031
]+(?:(?:(?:\r\n)?[ \t])+|\Z|(?=[\["()<>@,;:\\".\[\]]))|\[([^\[\]\r\\]|\\.)*\](
?:(?:\r\n)?[ \t])*)(?:\.(?:(?:\r\n)?[ \t])*(?:[^()<>@,;:\\".\[\] \000-\031]+(?
:(?:(?:\r\n)?[ \t])+|\Z|(?=[\["()<>@,;:\\".\[\]]))|\[([^\[\]\r\\]|\\.)*\](?:(?
:\r\n)?[ \t])*))*\>(?:(?:\r\n)?[ \t])*)|(?:[^()<>@,;:\\".\[\] \000-\031]+(?:(?
:(?:\r\n)?[ \t])+|\Z|(?=[\["()<>@,;:\\".\[\]]))|"(?:[^\"\r\\]|\\.|(?:(?:\r\n)?
[ \t]))*"(?:(?:\r\n)?[ \t])*)*:(?:(?:\r\n)?[ \t])*(?:(?:(?:[^()<>@,;:\\".\[\] 
\000-\031]+(?:(?:(?:\r\n)?[ \t])+|\Z|(?=[\["()<>@,;:\\".\[\]]))|"(?:[^\"\r\\]|
\\.|(?:(?:\r\n)?[ \t]))*"(?:(?:\r\n)?[ \t])*)(?:\.(?:(?:\r\n)?[ \t])*(?:[^()<>
@,;:\\".\[\] \000-\031]+(?:(?:(?:\r\n)?[ \t])+|\Z|(?=[\["()<>@,;:\\".\[\]]))|"
(?:[^\"\r\\]|\\.|(?:(?:\r\n)?[ \t]))*"(?:(?:\r\n)?[ \t])*))*@(?:(?:\r\n)?[ \t]
)*(?:[^()<>@,;:\\".\[\] \000-\031]+(?:(?:(?:\r\n)?[ \t])+|\Z|(?=[\["()<>@,;:\\
".\[\]]))|\[([^\[\]\r\\]|\\.)*\](?:(?:\r\n)?[ \t])*)(?:\.(?:(?:\r\n)?[ \t])*(?
:[^()<>@,;:\\".\[\] \000-\031]+(?:(?:(?:\r\n)?[ \t])+|\Z|(?=[\["()<>@,;:\\".\[
\]]))|\[([^\[\]\r\\]|\\.)*\](?:(?:\r\n)?[ \t])*))*|(?:[^()<>@,;:\\".\[\] \000-
\031]+(?:(?:(?:\r\n)?[ \t])+|\Z|(?=[\["()<>@,;:\\".\[\]]))|"(?:[^\"\r\\]|\\.|(
?:(?:\r\n)?[ \t]))*"(?:(?:\r\n)?[ \t])*)*\<(?:(?:\r\n)?[ \t])*(?:@(?:[^()<>@,;
:\\".\[\] \000-\031]+(?:(?:(?:\r\n)?[ \t])+|\Z|(?=[\["()<>@,;:\\".\[\]]))|\[([
^\[\]\r\\]|\\.)*\](?:(?:\r\n)?[ \t])*)(?:\.(?:(?:\r\n)?[ \t])*(?:[^()<>@,;:\\"
.\[\] \000-\031]+(?:(?:(?:\r\n)?[ \t])+|\Z|(?=[\["()<>@,;:\\".\[\]]))|\[([^\[\
]\r\\]|\\.)*\](?:(?:\r\n)?[ \t])*))*(?:,@(?:(?:\r\n)?[ \t])*(?:[^()<>@,;:\\".\
[\] \000-\031]+(?:(?:(?:\r\n)?[ \t])+|\Z|(?=[\["()<>@,;:\\".\[\]]))|\[([^\[\]\
r\\]|\\.)*\](?:(?:\r\n)?[ \t])*)(?:\.(?:(?:\r\n)?[ \t])*(?:[^()<>@,;:\\".\[\] 
\000-\031]+(?:(?:(?:\r\n)?[ \t])+|\Z|(?=[\["()<>@,;:\\".\[\]]))|\[([^\[\]\r\\]
|\\.)*\](?:(?:\r\n)?[ \t])*))*)*:(?:(?:\r\n)?[ \t])*)?(?:[^()<>@,;:\\".\[\] \0
00-\031]+(?:(?:(?:\r\n)?[ \t])+|\Z|(?=[\["()<>@,;:\\".\[\]]))|"(?:[^\"\r\\]|\\
.|(?:(?:\r\n)?[ \t]))*"(?:(?:\r\n)?[ \t])*)(?:\.(?:(?:\r\n)?[ \t])*(?:[^()<>@,
;:\\".\[\] \000-\031]+(?:(?:(?:\r\n)?[ \t])+|\Z|(?=[\["()<>@,;:\\".\[\]]))|"(?
:[^\"\r\\]|\\.|(?:(?:\r\n)?[ \t]))*"(?:(?:\r\n)?[ \t])*))*@(?:(?:\r\n)?[ \t])*
(?:[^()<>@,;:\\".\[\] \000-\031]+(?:(?:(?:\r\n)?[ \t])+|\Z|(?=[\["()<>@,;:\\".
\[\]]))|\[([^\[\]\r\\]|\\.)*\](?:(?:\r\n)?[ \t])*)(?:\.(?:(?:\r\n)?[ \t])*(?:[
^()<>@,;:\\".\[\] \000-\031]+(?:(?:(?:\r\n)?[ \t])+|\Z|(?=[\["()<>@,;:\\".\[\]
]))|\[([^\[\]\r\\]|\\.)*\](?:(?:\r\n)?[ \t])*))*\>(?:(?:\r\n)?[ \t])*)(?:,\s*(
?:(?:[^()<>@,;:\\".\[\] \000-\031]+(?:(?:(?:\r\n)?[ \t])+|\Z|(?=[\["()<>@,;:\\
".\[\]]))|"(?:[^\"\r\\]|\\.|(?:(?:\r\n)?[ \t]))*"(?:(?:\r\n)?[ \t])*)(?:\.(?:(
?:\r\n)?[ \t])*(?:[^()<>@,;:\\".\[\] \000-\031]+(?:(?:(?:\r\n)?[ \t])+|\Z|(?=[
\["()<>@,;:\\".\[\]]))|"(?:[^\"\r\\]|\\.|(?:(?:\r\n)?[ \t]))*"(?:(?:\r\n)?[ \t
])*))*@(?:(?:\r\n)?[ \t])*(?:[^()<>@,;:\\".\[\] \000-\031]+(?:(?:(?:\r\n)?[ \t
])+|\Z|(?=[\["()<>@,;:\\".\[\]]))|\[([^\[\]\r\\]|\\.)*\](?:(?:\r\n)?[ \t])*)(?
:\.(?:(?:\r\n)?[ \t])*(?:[^()<>@,;:\\".\[\] \000-\031]+(?:(?:(?:\r\n)?[ \t])+|
\Z|(?=[\["()<>@,;:\\".\[\]]))|\[([^\[\]\r\\]|\\.)*\](?:(?:\r\n)?[ \t])*))*|(?:
[^()<>@,;:\\".\[\] \000-\031]+(?:(?:(?:\r\n)?[ \t])+|\Z|(?=[\["()<>@,;:\\".\[\
]]))|"(?:[^\"\r\\]|\\.|(?:(?:\r\n)?[ \t]))*"(?:(?:\r\n)?[ \t])*)*\<(?:(?:\r\n)
?[ \t])*(?:@(?:[^()<>@,;:\\".\[\] \000-\031]+(?:(?:(?:\r\n)?[ \t])+|\Z|(?=[\["
()<>@,;:\\".\[\]]))|\[([^\[\]\r\\]|\\.)*\](?:(?:\r\n)?[ \t])*)(?:\.(?:(?:\r\n)
?[ \t])*(?:[^()<>@,;:\\".\[\] \000-\031]+(?:(?:(?:\r\n)?[ \t])+|\Z|(?=[\["()<>
@,;:\\".\[\]]))|\[([^\[\]\r\\]|\\.)*\](?:(?:\r\n)?[ \t])*))*(?:,@(?:(?:\r\n)?[
 \t])*(?:[^()<>@,;:\\".\[\] \000-\031]+(?:(?:(?:\r\n)?[ \t])+|\Z|(?=[\["()<>@,
;:\\".\[\]]))|\[([^\[\]\r\\]|\\.)*\](?:(?:\r\n)?[ \t])*)(?:\.(?:(?:\r\n)?[ \t]
)*(?:[^()<>@,;:\\".\[\] \000-\031]+(?:(?:(?:\r\n)?[ \t])+|\Z|(?=[\["()<>@,;:\\
".\[\]]))|\[([^\[\]\r\\]|\\.)*\](?:(?:\r\n)?[ \t])*))*)*:(?:(?:\r\n)?[ \t])*)?
(?:[^()<>@,;:\\".\[\] \000-\031]+(?:(?:(?:\r\n)?[ \t])+|\Z|(?=[\["()<>@,;:\\".
\[\]]))|"(?:[^\"\r\\]|\\.|(?:(?:\r\n)?[ \t]))*"(?:(?:\r\n)?[ \t])*)(?:\.(?:(?:
\r\n)?[ \t])*(?:[^()<>@,;:\\".\[\] \000-\031]+(?:(?:(?:\r\n)?[ \t])+|\Z|(?=[\[
"()<>@,;:\\".\[\]]))|"(?:[^\"\r\\]|\\.|(?:(?:\r\n)?[ \t]))*"(?:(?:\r\n)?[ \t])
*))*@(?:(?:\r\n)?[ \t])*(?:[^()<>@,;:\\".\[\] \000-\031]+(?:(?:(?:\r\n)?[ \t])
+|\Z|(?=[\["()<>@,;:\\".\[\]]))|\[([^\[\]\r\\]|\\.)*\](?:(?:\r\n)?[ \t])*)(?:\
.(?:(?:\r\n)?[ \t])*(?:[^()<>@,;:\\".\[\] \000-\031]+(?:(?:(?:\r\n)?[ \t])+|\Z
|(?=[\["()<>@,;:\\".\[\]]))|\[([^\[\]\r\\]|\\.)*\](?:(?:\r\n)?[ \t])*))*\>(?:(
?:\r\n)?[ \t])*))*)?;\s*) 
```

不，我不是在开玩笑：[http ://www.ex-parrot.com/~pdw/Mail-RFC822-Address.html](http://www.ex-parrot.com/~pdw/Mail-RFC822-Address.html)

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-03-31T21:14:46.827

人们总是错过的一个有效字符是“%”字符。它执行内部路由方向。请参阅[第 17.3.3 节的电子邮件地址](http://www.faqs.org/docs/linux_network/x-087-2-mail.address.html)。

请注意，这被视为遗产。但是，它表明您正在寻找做一些非常复杂的事情。我可能只是检查一个 @ 字符和一个看起来合适的域后缀。

编辑：我忘了。您现在可以获取 Unicode 域名，例如 http://☃.net/（Stackoverflow 的 HTML 编辑器因此有点混乱）

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-03-31T21:22:02.223

验证电子邮件地址往往比您想象的要复杂。

*   **相关问题：[验证电子邮件地址的最佳正则表达式是什么？](https://stackoverflow.com/questions/201323/what-is-the-best-regular-expression-for-validating-email-addresses)**

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-31T21:53:50.137

没关系，只是您屏蔽了[IDN TLD](http://idn.icann.org/) :)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-11-20T11:36:18.163

RFC 5322 标准。

允许点原子本地部分、引用字符串本地部分、过时（混合点原子和引用字符串）本地部分、域名域、（IPv4、IPv6 和 IPv4 映射的 IPv6 地址）域文字域，和（嵌套的）CFWS。

```
'/^(?!(?>(?1)"?(?>\\\[ -~]|[^"])"?(?1)){255,})(?!(?>(?1)"?(?>\\\[ -~]|[^"])"?(?1)){65,}@)((?>(?>(?>((?>(?>(?>\x0D\x0A)?[\x09 ])+|(?>[\x09 ]*\x0D\x0A)?[\x09 ]+)?)(\((?>(?2)(?>[\x01-\x08\x0B\x0C\x0E-\'*-\[\]-\x7F]|\\\[\x00-\x7F]|(?3)))*(?2)\)))+(?2))|(?2))?)([!#-\'*+\/-9=?^-~-]+|"(?>(?2)(?>[\x01-\x08\x0B\x0C\x0E-!#-\[\]-\x7F]|\\\[\x00-\x7F]))*(?2)")(?>(?1)\.(?1)(?4))*(?1)@(?!(?1)[a-z0-9-]{64,})(?1)(?>([a-z0-9](?>[a-z0-9-]*[a-z0-9])?)(?>(?1)\.(?!(?1)[a-z0-9-]{64,})(?1)(?5)){0,126}|\[(?:(?>IPv6:(?>([a-f0-9]{1,4})(?>:(?6)){7}|(?!(?:.*[a-f0-9][:\]]){8,})((?6)(?>:(?6)){0,6})?::(?7)?))|(?>(?>IPv6:(?>(?6)(?>:(?6)){5}:|(?!(?:.*[a-f0-9]:){6,})(?8)?::(?>((?6)(?>:(?6)){0,4}):)?))?(25[0-5]|2[0-4][0-9]|1[0-9]{2}|[1-9]?[0-9])(?>\.(?9)){3}))\])(?1)$/isD' 
```

RFC 5321 标准。

允许点原子本地部分、引用字符串本地部分、域名域和（IPv4、IPv6 和 IPv4 映射的 IPv6 地址）域文字域。

```
'/^(?!(?>"?(?>\\\[ -~]|[^"])"?){255,})(?!"?(?>\\\[ -~]|[^"]){65,}"?@)(?>([!#-\'*+\/-9=?^-~-]+)(?>\.(?1))*|"(?>[ !#-\[\]-~]|\\\[ -~])*")@(?!.*[^.]{64,})(?>([a-z0-9](?>[a-z0-9-]*[a-z0-9])?)(?>\.(?2)){0,126}|\[(?:(?>IPv6:(?>([a-f0-9]{1,4})(?>:(?3)){7}|(?!(?:.*[a-f0-9][:\]]){8,})((?3)(?>:(?3)){0,6})?::(?4)?))|(?>(?>IPv6:(?>(?3)(?>:(?3)){5}:|(?!(?:.*[a-f0-9]:){6,})(?5)?::(?>((?3)(?>:(?3)){0,4}):)?))?(25[0-5]|2[0-4][0-9]|1[0-9]{2}|[1-9]?[0-9])(?>\.(?6)){3}))\])$/iD' 
```

基本的。

允许点原子本地部分和域名域（需要至少两个域名标签，TLD 限制为 2-6 个字母字符）。

```
"/^(?!.{255,})(?!.{65,}@)([!#-'*+\/-9=?^-~-]+)(?>\.(?1))*@(?!.*[^.]{64,})(?>[a-z0-9](?>[a-z0-9-]*[a-z0-9])?\.){1,126}[a-z]{2,6}$/iD" 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-31T21:19:13.510

看看下面的链接。

[比较电子邮件地址验证正则表达式](http://fightingforalostcause.net/misc/2006/compare-email-regex.php)

[如何查找或验证电子邮件地址](http://www.regular-expressions.info/email.html)

[堆栈溢出](https://stackoverflow.com/questions/201323/what-is-the-best-regular-expression-for-validating-email-addresses)也有类似的问题。

# asp.net - Asp.Net 在 Sql 中选择

> ID：703061
> 
> 赞同：3
> 
> 时间：2009-03-31T21:06:28.050
> 
> 标签：asp.net, sql, ado

我知道这将非常简单。我见过很多在 asp.net 中使用 sql 的不同方法，但没有真正的标准。我想知道的是如何从 asp.net 中的 sql 数据库中干净地选择并检索多条记录。例如：选择所有用户标识。

```
String sql = 
  "SELECT [UserId] FROM [UserProfiles] WHERE NOT [UserId] = 'CurrentUserId'";

string strCon = System.Web
                      .Configuration
                      .WebConfigurationManager
                      .ConnectionStrings["SocialSiteConnectionString"]
                      .ConnectionString;

SqlConnection conn = new SqlConnection(strCon);
SqlCommand comm = new SqlCommand(sql, conn);
conn.Open();

/*
 This is where I need to know how to retrieve the information from the
 above command(comm). I am looking for something similiar to php's
 mysql_result. I want to access the records kind of like an array or some
 other form of retrieving all the data.
 Also when the new SqlCommand is called...does that actual run the
 SELECT STATEMENT or is there another step. 
*/

conn.Close(); 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-31T21:18:48.737

我认为这就是你要找的。

```
String sql = "SELECT [UserId] FROM [UserProfiles] WHERE NOT [UserId] = 'CurrentUserId'";

string strCon = System.Web
                      .Configuration
                      .WebConfigurationManager
                      .ConnectionStrings["SocialSiteConnectionString"].ConnectionString;

SqlConnection conn = new SqlConnection(strCon);
SqlCommand comm = new SqlCommand(sql, conn);
conn.Open();
SqlDataReader nwReader = comm.ExecuteReader();
while (nwReader.Read())
{
    int UserID = (int)nwReader["UserID"];
    // Do something with UserID here...
}
nwReader.Close();
conn.Close(); 
```

不过，我不得不说，整体方法可以使用很多调整。首先，您至少可以从简化对 ConnectionString 的访问开始。例如，您可以将以下内容添加到 Global.asax.cs 文件中：

```
 using System;
   using System.Configuration;

   public partial class Global : HttpApplication
   {
      public static string ConnectionString; 

      void Application_Start(object sender, EventArgs e)
      { 
          ConnectionString = ConfigurationManager.ConnectionStrings["SocialSiteConnectionString"].ConnectionString;
      }
      ...
    } 
```

现在，在整个代码中，只需使用以下命令访问它：

```
SqlConnection conn = new SqlConnection(Global.ConnectionString); 
```

更好的是，创建一个隐藏“管道”的类。要在我的代码中运行相同的查询，我只需输入：

```
 using (BSDIQuery qry = new BSDIQuery())
        {
            SqlDataReader nwReader = qry.Command("SELECT...").ReturnReader();
            // If I needed to add a parameter I'd add it above as well: .ParamVal("CurrentUser")
            while (nwReader.Read())
            {
                int UserID = (int)nwReader["UserID"];
                // Do something with UserID here...
            }
            nwReader.Close();
        } 
```

这只是一个使用*我的*DAL 的例子。但是，请注意没有连接字符串，没有创建或管理的命令或连接对象，只有一个“BSDIQuery”（除了显示的内容之外，它还做了很多不同的事情）。您的方法会因您最常执行的任务而异。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-31T21:13:53.117

大多数时候，我使用这个（注意我也在使用连接池方法）：

```
 public DataTable ExecuteQueryTable(string query)
    {
        return ExecuteQueryTable(query, null);
    }

    public DataTable ExecuteQueryTable(string query, Dictionary<string, object> parameters)
    {
        using (SqlConnection conn = new SqlConnection(this.connectionString))
        {
            conn.Open();

            using (SqlCommand cmd = conn.CreateCommand())
            {
                cmd.CommandText = query;

                if (parameters != null)
                {
                    foreach (string parameter in parameters.Keys)
                    {
                        cmd.Parameters.AddWithValue(parameter, parameters[parameter]);
                    }
                }

                DataTable tbl = new DataTable();
                using (SqlDataAdapter da = new SqlDataAdapter(cmd))
                {
                    da.Fill(tbl);
                }

                return tbl;
            }
        }
    } 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-31T21:15:06.267

这是对现有代码的改编：

```
String sql = "SELECT [UserId] FROM [UserProfiles] WHERE [UserId] != @CurrentUserId";

string strCon = System.Web
                      .Configuration
                      .WebConfigurationManager
                      .ConnectionStrings["SocialSiteConnectionString"].ConnectionString;

DataTable result = new DataTable();
using (var conn = new SqlConnection(strCon))
using (var cmd = new SqlCommand(sql, conn))
{
    cmd.Parameters.Add("@CurrentUserID", SqlDbType.Int).Value = CurrentUserID;
    conn.Open();

    result.Load(cmd.ExecuteReader());
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-31T21:10:28.553

创建 a`SqlCommand`根本不会执行它。

当您调用[`ExecuteReader`](http://msdn.microsoft.com/en-us/library/system.data.sqlclient.sqlcommand.executereader.aspx)或类似的东西时，该命令将被执行。

如果您想要将所有结果提取到内存中的东西，您应该查看`DataSet`/ `DataTable`。[这里](http://www.csharp-station.com/Tutorials/AdoDotNet/Lesson05.aspx)有他们的教程- 或者网上还有很多其他的，任何像样的 ADO.NET 书籍也将涵盖它们。

如果您*不想*一次将它们全部提取到内存中，那么`ExecuteReader`它就是适合您的方法。这将返回一个[`SqlDataReader`](http://msdn.microsoft.com/en-us/library/system.data.sqlclient.sqldatareader.aspx)类似于数据库游标的 a - 它一次读取一行，并且您根据需要请求各个列，[`Read`](http://msdn.microsoft.com/en-us/library/system.data.sqlclient.sqldatareader.read.aspx)每次调用以获取下一行。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-31T21:25:05.867

而在 PHP 中你会做类似的事情，

```
while ($row = mysql_fetch_array ($result)) 
{
  //this assumes you're doing something with foo in loop
  $foo = $row["userid"];

  //using $foo somehow
} 
```

在 .NET 中，您可以做一些不同的事情。相信我，出身于 PHP 背景，从 PHP 过渡到 .NET 并不容易。有很多事情看起来很奇怪。不过过一段时间，就会明白了！坚持下去。我个人更喜欢它。

好的..假设你有一个像你说的那样的数据集，你可以做这样的事情，

```
//assuming you have a DataSet called myDataSet
for (int i = 0; i < myDataSet.Tables[0].Rows.Count; i++)
{
  //likewise assuming here you're doing something with foo in loop
  string foo = myDataSet.Tables[0].Rows[i]["userid"].ToString();

  //similarly do something with foo in loop
} 
```

这与 PHP 片段的作用相同。

# regex - 正则表达式从字符串的开头和结尾修剪连字符

> ID：703066
> 
> 赞同：2
> 
> 时间：2009-03-31T21:08:26.000
> 
> 标签：regex

从字符串的开头和结尾修剪连字符的正则表达式模式是什么？

```
-----name1-name2----- 
```

应该成为

```
name1-name2 
```

`^(-+).+(-+)$`似乎不起作用...

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-31T21:11:24.980

我会采取相反的方法，像这样把中间拉出来：

```
^-+(.+?)-+$ 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-31T21:15:56.607

您需要像这样匹配开头或结尾：

```
(^-+)|(-+$) 
```

如果我在 PowerShell 中尝试这个，我会得到以下结果：

```
PS> "-----name1-name2----" -replace "(^-+)|(-+$)", ""
name1-name2 
```

# c# - 如何确定 CD-ROM 的可用空间量？

> ID：703067
> 
> 赞同：0
> 
> 时间：2009-03-31T21:08:30.727
> 
> 标签：c#, hardware, wmi

我正在尝试使用以下代码确定 CD 的可用空间量：

```
ManagementObjectSearcher searcher = new ManagementObjectSearcher("select * from Win32_LogicalDisk WHERE DriveType =5");
foreach(ManagementObject mo in searcher.Get())
{
    Console.WriteLine( "FreeSpace: "+mo["FreeSpace"].ToString());
    Console.WriteLine("CapacitySpace: " + mo["Size"].ToString());
    UInt64 usedspace = (UInt64)mo["Size"] - (UInt64)mo["FreeSpace"];
    Console.WriteLine("UsedSpace: " + usedspace.ToString());
} 
```

运行上面的代码，我收到以下输出：

> 可用空间：0
> 容量空间：301463552
> 已用空间：301463552

理想情况下，我想报告 Windows 资源管理器统计信息 - 免费的 YYY XXX。请注意，Windows 资源管理器报告的 392 MB 空闲 702 MB。谢谢！

**更新（2009 年 4 月 1 日）：** 确定 CD 可用空间的能力似乎超出了 WMI，并且依赖于插入磁盘的文件系统。我的测试表明 Windows 不会显示 CDFS 格式的 CD 的容量信息；但是，它将显示 CD 格式化 UDF 的容量信息。

此外，我还找到了一个优秀的本地实用程序，用于浏览[此处](http://technet.microsoft.com/en-us/library/cc759703.aspx "这里")引用的 WMI 。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-31T21:25:12.527

ManagementObject mo 的对象类型是什么？因为如果 mo["Size"] 只存储 int32 那么转换为 int64 不会做太多。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-31T21:34:18.153

您是否尝试从 CD 的理论最大可用空间量来确定未使用的空间量？

我的理解是，CD-ROM 是一种只读格式，因此永远不会有任何可用空间。每个位都用于已写入的数据，不能再写入，因此永远不会有可用空间。

如果您只想知道 ROM 上的未写入空间，只需从固定的理论最大值（702MB？）中减去已用空间，就可以了。固定的最大值应该是某处规范的一部分。

* * *

您是否考虑过在设备上使用 mciSendString()，可能带有“信息”或“状态”字符串，以获取有关驱动器中磁盘的更多信息？我自己没有尝试过，所以我不确定它是否会起作用。

# .net - 内置的基于 BinaryFormatter 的 .Net 序列化有哪些不足？

> ID：703073
> 
> 赞同：18
> 
> 时间：2009-03-31T21:09:31.037
> 
> 标签：.net, serialization

内置的基于**BinaryFormatter**的 .Net 序列化有哪些不足？（性能、灵活性、限制）

如果可能，请在您的答案中附上一些代码。

例子：

*被序列化的自定义对象必须用 [Serializable] 属性修饰或实现 ISerializable 接口。*

不太明显的例子：

*匿名类型不能被序列化。*

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2009-03-31T22:38:36.313

如果你的意思是`BinaryFormatter`：

*   基于字段，非常不兼容版本；更改私有实现细节并且它会中断（即使只是[将其更改为自动实现的属性](http://marcgravell.blogspot.com/2009/03/obfuscation-serialization-and.html)）
*   与其他平台不交叉兼容
*   对新领域不是很友好
*   是特定于程序集的（元数据被烧入）
*   特定于 MS/.NET（可能特定于 .NET 版本）
*   不是混淆安全的
*   不是特别快或输出小
*   不适用于轻型框架 (CF?/Silverlight)
*   有一个令人沮丧的习惯，就是把你没想到的东西拉进来（通常是通过`event`s）

我在这方面花了很多时间，包括为 .NET 编写 Google 的“protocol buffers”序列化 API 的（免费）实现；[protobuf-net](https://github.com/mgravell/protobuf-net)

这是：

*   [输出更小，速度更快](http://code.google.com/p/protobuf-net/wiki/Performance)
*   [与其他实现](http://code.google.com/p/protobuf/wiki/ThirdPartyAddOns)交叉兼容
*   可扩展
*   基于合同
*   [混淆安全](http://marcgravell.blogspot.com/2009/03/obfuscation-serialization-and.html)
*   独立组装
*   是一个开放的文档标准
*   适用于所有版本的 .NET（警告：未在 Micro Framework 上测试）
*   有钩子可以插入`ISerializable`（用于远程处理等）和 WCF

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-31T21:12:29.500

给定任何随机对象，[很难证明它是否真的是可序列化的](http://blogs.msdn.com/jaredpar/archive/2009/03/31/is-it-serializable.aspx)。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-31T21:17:37.397

数据的版本控制是通过属性处理的。如果您不担心版本控制，那么这没问题。如果你是，这是一个巨大的问题。

属性方案的问题在于它在许多琐碎的情况下（例如添加新属性）工作得非常流畅，但是当您尝试使用不同的新枚举值（或任何长期持久数据附带的常见场景的数量）。

我可以详细描述这些麻烦。最后，如果您需要，编写自己的序列化程序非常容易......

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-31T21:12:43.540

如果你改变你正在序列化的对象，你序列化和存储的所有旧数据都会被破坏。如果您存储在数据库甚至 XML 中，则更容易将旧数据转换为新数据。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-31T21:17:59.957

不能保证您可以在不同的框架（例如 1.0、1.1、3.5）甚至不同的 CLR 实现（Mono）之间来回序列化对象，同样，XML 更适合此目的。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-31T21:24:01.267

想到的另一个问题：

XmlSerializer 类位于与通用运行时格式化程序完全不同的位置。虽然它们使用起来非常相似，但 XmlSerializer 并没有实现 IFormatter 接口。您不能拥有允许您在运行时在 Bi​​naryFormatter、XmlSerializer 或自定义格式化程序之间简单地交换序列化格式化程序的代码，而无需跳过一些额外的环节。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2010-05-14T14:04:06.973

我同意最后一个答案。性能相当差。最近，我的编码团队完成了从标准 C++ 到 C++/CLI 的模拟转换。在 C++ 下，我们有一个手写的持久性机制，它工作得相当好。我们决定使用序列化机制，而不是重写旧的持久性机制。
内存占用在 1/2 和 1 Gig 之间的旧模拟以及大多数具有指向其他对象的指针的对象以及运行时的 1000 个对象，将在一分钟内保存为大约 10 到 15 Meg 的二进制文件。从文件恢复是可比的。
Using the same data-files (running side-by-side) the running performance of the C++/CLI is about twice the C++, until we do the persistance (serialization in the new version) Writng out takes between 3 and 5 minutes, reading in takes between 10 and 20\. The file size of the serialized files is about 5 times the size as the old files, Basically we see a 19 fold increase in the read time, and a 5 fold increas in the write time. This is unacceptable and we are looking for ways to correct this.

在检查二进制文件时，我发现了一些事情： 1\. 所有类型的类型和程序集数据都以明文形式写入。这是空间方面的低效。2\. 每种类型的每个对象/实例都有写出的臃肿类型/程序集信息。我们在持久性机制中所做的一件事是写出一个已知类型表。当我们发现书面类型时，我们在这张表中查找了它的存在。如果它不存在，则使用类型信息创建一个条目，并分配一个索引。然后我们将类型 infor 作为整数传递。(type,data,type,data) 这个“技巧”会极大地减少大小。这可能需要两次遍历数据，但是可以开发一个“即时”过程，其中除了将其添加到表中，推送到流中，

我希望以这种方式重新实现一些核心序列化来优化它，但是，唉，这些类是密封的！我们可能还会找到一种方法来偷工减料。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-03-31T21:30:14.437

> 被序列化的类型必须用 [Serializable] 属性修饰。

如果你指的是类中的变量，那你就错了。公共变量/属性自动序列化

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-03-31T21:39:35.707

一个不太明显的问题是对象序列化的性能很差。

[例子](http://gist.github.com/88422)

是时候在我的机器上序列化和反序列化 100,000 个对象了：

```
Time Elapsed 3 ms
Full Serialization Cycle: BinaryFormatter Int[100000]

Time Elapsed 1246 ms
Full Serialization Cycle: BinaryFormatter NumberObject[100000]

Time Elapsed 54 ms
Full Serialization Cycle: Manual NumberObject[100000] 
```

在这个简单的示例中，使用单个 Int 字段序列化对象比手动执行要慢 20 倍。当然，序列化流中有一些类型信息。但这几乎不能解释 20 倍的减速。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2012-04-10T13:48:28.890

另一种情况导致 BinaryFormatter 引发异常。

```
[Serializable]
class SerializeMe
{
    public List<Data> _dataList;
    public string _name;
}

[Serializable]
class Data
{
    public int _t;
} 
```

想象一下 SerializeMe 今天被序列化了。明天我们决定不再需要类 Data 并将其删除。因此，我们修改 SerializeMe 类以删除 List。现在不可能反序列化旧版本的 SerializeMe 对象。

解决方案是创建自定义 BinaryFormatter 以正确忽略额外的类，或者使用空定义保留类 Data（无需保留 List 成员）。

# load - PHP 配置文件不会加载 IIS7 x64

> ID：703074
> 
> 赞同：2
> 
> 时间：2009-03-31T21:09:36.233
> 
> 标签：load, 64-bit, php

使用 Fast CGI 我无法读取 php.ini 文件。请参阅下面的我的 phpinfo。

系统 Windows NT WIN-PAFTBLXQWYW 6.0 build 6001
Build Date Mar 5 2009 19:43:24
配置命令 cscript /nologo configure.js "--enable-snapshot-build" "--enable-debug-pack" "--with-快照模板=d:\php-sdk\snap_5_2\vc6\x86\template" "--with-php-build=d:\php-sdk\snap_5_2\vc6\x86\php_build" "--disable-zts" "--disable-isapi" "--disable-nsapi" "--with-pdo-oci=D:\php-sdk\oracle\instantclient10\sdk,shared" "--with-oci8=D:\php- sdk\oracle\instantclient10\sdk,shared" "--enable-htscanner=shared"
服务器 API CGI/FastCGI
虚拟目录支持已禁用
配置文件 (php.ini) 路径 C:\Windows
**加载的配置文件 (无)**
扫描此目录以查找额外的 。 ini 文件（无）

我的 php.ini 文件位于我的 c:\php 和我的 c:\windows 中，我确保它在这两个地方都具有网络服务的读取权限。

我已经添加了各种注册表设置、环境变量，并遵循了在网络上找到的多个教程，但目前还没有骰子。每次重启后。

我最初的安装是使用 MS“Web 平台安装程序”，但是我已经重新启动。

任何关于从这里去哪里的想法都将受到欢迎。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-29T06:33:36.360

我终于弄清楚了问题所在。默认情况下，Windows Server 2008 显然默认启用了“隐藏已知文件类型的文件扩展名”。我没有注意到它，因为它正在显示它周围其他文件的扩展名

我在某个时候意外地将我的文件重命名为 php.ini.ini，并且由于设置原因，它在我看来是 php.ini。

想通的时候真的觉得很傻。但是查看具有该设置的目录实际上很难分辨。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2009-05-29T23:44:42.330

配置文件路径是否与您放置 php.ini 的位置匹配？

只需使用以下内容创建一个名为 getinfo.php 的文件：

```
<?php phpinfo(); ?> 
```

将它保存在您的根目录中，然后转到[http://www.yourwebsite.com/getinfo.php](http://www.yourwebsite.com/getinfo.php)以查看它是什么。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-05-30T04:20:33.673

您需要 64 位版本的 php 和 fast-cgi。
我没有找到 php 的 64 位安装程序，所以你需要从源代码编译 php。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-06-02T23:30:12.763

我无法告诉您安装有什么问题，但我已经在 Windows Vista 64 位上成功安装了 PHP。我不记得有任何问题。

我的 phpinfo 文件说：

> 系统 Windows NT AQUA 6.0 build 6002
> Build Date Apr 9 2009 08:22:37
> 配置命令 cscript /nologo configure.js "--enable-snapshot-build" "--enable-debug-pack" "--with-snapshot-模板=d:\php-sdk\snap_5_2\vc6\x86\template" "--with-php-build=d:\php-sdk\snap_5_2\vc6\x86\php_build" "--with-pdo-oci= D:\php-sdk\oracle\instantclient10\sdk,shared" "--with-oci8=D:\php-sdk\oracle\instantclient10\sdk,shared"
> 服务器 API ISAPI
> 虚拟目录支持启用
> 配置文件 (php.ini ) 路径 C:\Windows
> 加载的配置文件 C:\PHP\php.ini
> 扫描此目录以获取其他 .ini 文件（无）

我安装的 PHP 版本是 PHP 5.2.9-2 zip 包 - 2009 年 4 月 8 日，来自[http://www.php.net/downloads.php](http://www.php.net/downloads.php)。这是一个 32 位软件包，但在 Vista-64 下运行良好。我之前在运行 64 位版本时遇到了麻烦，所以我选择了 32 位版本。它对我有用。

你会注意到我使用了 ISAPI，它比 CGI 更推荐。无论哪种方式，我认为它不应该有所作为。

如果您确实想在 Windows 上运行 64 位 PHP，您可能想尝试通过先安装 Apache 并按照此处给出的说明进行操作：[http ://www.elxis.org/guides/developers-guides/64bit-apache -php-mysql-windows.html](http://www.elxis.org/guides/developers-guides/64bit-apache-php-mysql-windows.html) 但是，我不能保证这一点，因为我没有尝试过这组特定的指令。但它看起来确实很完整。

这些说明（如果您还没有看过它们）也可能会为您提供一些关于各种 PHP 文件必须位于何处的提示。

另一件要检查的事情是查看有关在 Windows 系统上安装的 PHP 文章，网址为：[http](http://ca2.php.net/install.windows) ://ca2.php.net/install.windows - 用户评论特别有用，可能会给您一些想法，让您在不得不去之前尝试一下卸载/重新安装路由。

希望这里有帮助。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2009-06-02T23:47:03.573

在 Windows XP 上，我在将 php.ini 放入 C:\Windows\system32 方面取得了更大的成功。由于您使用的是 x64，请尝试输入 C:\Windows\system64。然后我通常会在 C:\php 中放置一个别名以便于访问，但这不是绝对必要的。

当然，将文件放在该位置后重新启动 IIS。

# javascript - 尝试使用 JQuery 的自动完成和 ajax 调用来获取结果

> ID：703078
> 
> 赞同：1
> 
> 时间：2009-03-31T21:10:31.160
> 
> 标签：javascript, jquery, autocomplete

好吧，我有一个 50000+ 行表，所以我无法将所有行加载到每个页面中以供用户使用自动完成功能，所以我尝试通过 extraParams 参数使用 ajax 调用，但不知道：

1) 使结果显示在通过 ajax 调用的页面上的格式（在这种情况下为 get-dropdown-results.xml）

2）如何将这些结果放入下拉列表中

这是我目前的来源：

```
$("input#autocomplete-field").autocomplete(
    "/ajax/get-dropdown-results.xml",{
    delay:0,
    minChars:3,
    matchContains:true,
    matchSubset:false,
    max:100,
    extraParams: {
        q: function () { return escape($("input#autocomplete-field").val()); }
    }
}); 
```

我正在运行 firebug，所以我可以看到正确进行了 ajax 调用（/ajax/get-dropdown-results.xml?q=whatever-they-typed），但我不知道在哪里放置代码来处理返回的文本.

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-31T21:56:13.733

我假设您使用[Dylan Verheul 的 jQuery 自动完成插件](http://dyve.net/jquery/?autocomplete)。该插件将自动为您创建下拉弹出窗口。但是，它希望结果是纯文本格式，而不是 XML。尝试返回以行尾分隔的结果：

```
foo\n
bar\n
baz\n 
```

# amazon-web-services - 使用 Amazon API 查找最新产品

> ID：703118
> 
> 赞同：10
> 
> 时间：2009-03-31T21:22:58.447
> 
> 标签：amazon-web-services, amazon

是否可以使用 Amazon Associates Web Service 或任何其他工具找到特定类别中的所有新 Amazon 产品？

我还尝试了只给出 10 个结果的 RSS，它在几个月内只更新一次。你还有其他建议吗 ？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-04-02T00:09:32.907

一旦您知道您感兴趣的类别[的浏览节点，您就可以使用](http://developer.amazonwebservices.com/connect/entry.jspa?externalID=345&categoryID=12)[该](http://docs.amazonwebservices.com/AWSECommerceService/2009-02-01/DG/index.html?RG_NewReleases.html)`BrowseNodeLookup`操作来获取该类别中的*一些*新产品；看起来你得到了 10，即使在像音乐»另类这样的繁忙类别中也是如此。[`NewReleases` `ResponseGroup`](http://docs.amazonwebservices.com/AWSECommerceService/2009-02-01/DG/index.html?RG_NewReleases.html)

 *他们在这些页面中没有说任何关于获得更多的内容，并且`NewReleases`仅对操作有效`ResponseGroup`，`BrowseNodeLookup`而不是，例如`ItemSearch`，所以我认为每个类别不能获得超过 10 个新版本。

# sql-server - SQL Server 2000-2005-2008 分布式查询问题

> ID：703122
> 
> 赞同：1
> 
> 时间：2009-03-31T21:24:44.777
> 
> 标签：sql-server, sql-server-2005, sql-server-2008, distributed, linked-server

只需设置一个新服务器。试图将一些工作量从一个转移到另一个。一切看起来都很棒，除非我来运行这段代码：

```
CREATE TABLE #KEYWORD5    
(ITEM_MASTER_ID NUMERIC(25) NULL)    

INSERT INTO #KEYWORD5
exec SQL2K801.soupftidx.dbo.P_REMOTE_SQL_EXEC 'SELECT IM.ITEM_MASTER_ID FROM
 ITEM_MASTER IM WHERE IM.BUYER_ORGANIZATION_ID IN (5970,5230) 

AND IM.ACTIVE_FLAG = ''Y'' 
AND CONTAINS(IM.*, '' ("SCREW*" OR FORMSOF (INFLECTIONAL, "SCREW")) '')' 

SELECT * FROM #KEYWORD5

DROP TABLE #KEYWORD5 
```

顺便说一句，以下工作正常：

```
CREATE TABLE #KEYWORD5    
(ITEM_MASTER_ID NUMERIC(25) NULL)    

INSERT INTO #KEYWORD5
exec P2PINDEXDA.soupftidx.dbo.P_REMOTE_SQL_EXEC 'SELECT IM.ITEM_MASTER_ID FROM
 ITEM_MASTER IM WHERE IM.BUYER_ORGANIZATION_ID IN (5970,5230) 
AND IM.ACTIVE_FLAG = ''Y'' 
AND CONTAINS(IM.*, '' ("SCREW*" OR FORMSOF (INFLECTIONAL, "SCREW")) '')' 

SELECT * FROM #KEYWORD5

DROP TABLE #KEYWORD5 
```

两者之间的唯一区别是服务器名前缀（p2pindexda 与 sql2k801）。我已验证链接服务器具有相同的选项集。此外，我已经验证 exec 语句工作正常......即：它按预期返回结果。

当我尝试将结果插入本地临时表时，它会变得糟糕。

是什么赋予了？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-06T08:33:21.347

乍一看，我认为[MSDTC 没有](http://itknowledgeexchange.techtarget.com/sql-server/how-to-configure-dtc-on-windows-2008/)在新服务器上正确设置。

但是，如果没有错误的文本，我只是在猜测。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-29T03:37:52.087

引用 - 我已验证链接服务器具有相同的选项集 - 您是否验证了您链接到的 2 台服务器上的权限 - 而链接服务器连接可能在此服务器上工作 - 连接在另一台服务器上的权限/s 可能不正确希望这有某种意义，正如其他人所说，当你不知道实际错误时很难知道

# javascript - 在 javascript 中，我如何引用 this.form.checkbox[5].checked？

> ID：703126
> 
> 赞同：0
> 
> 时间：2009-03-31T21:25:41.357
> 
> 标签：javascript, arrays, onchange

我有一系列复选框和输入 type="text" 区域，其中当文本区域中的值更改时，我需要将复选框的状态设置为 true。很简单。我已经成功地做到了：

```
<input name="fixed" type="checkbox">
<input name="stuff" type="text" onchange="this.form.fixed.checked=true"> 
```

哪个工作正常。您必须编辑该字段然后单击它，但这对我的需要很好：

...但是当我切换到这个时：

```
<input name="fixed[0]" type="checkbox">
<input name="stuff" type="text" onchange="this.form.fixed[0].checked=true">
<input name="fixed[1]" type="checkbox">
<input name="stuff" type="text" onchange="this.form.fixed[1].checked=true"> 
```

编辑时，我的复选框没有任何变化：

恐怕我唯一的 javascript 知识来自谷歌搜索这类事情。有没有人比山上的谷歌甲骨文有更好的信息？

谢谢...

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-31T21:28:14.097

从点符号切换到括号符号！

```
this.form['fixed[0]'].checked 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-31T21:28:05.017

可能是您在 HTML 中混合了一些阴暗的做法，而当您在 javascript 中这样做时，它们就会崩溃。

所以javascript中的this.form.fixed[1]真的说“数组this.form.fixed中的第二项。所以我认为这就是问题所在。尝试命名你的元素fixed0和fixed1，看看是否有效。

**编辑**：您也可以使用括号表示法，如 Peter 所示，这应该可以在不编辑输入名称的情况下解决问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-31T21:33:28.827

让自己的生活更轻松。

为您尝试引用的元素创建唯一 ID，并从您绑定事件的元素中引用它们：

```
<input name="fixed[0]" type="checkbox" id="fixed_0">
<input name="stuff" type="text" onchange="document.getElementById('fixed_0').checked=true">
<input name="fixed[1]" type="checkbox" id="fixed_1">
<input name="stuff" type="text" onchange="document.getElementById('fixed_1').checked=true"> 
```

# linux - Linux 中的实时音频分析

> ID：703128
> 
> 赞同：12
> 
> 时间：2009-03-31T21:27:22.883
> 
> 标签：linux, audio, real-time, signal-processing, alsa

我想知道推荐使用的音频库是什么？

我正在尝试制作一个有助于调整乐器的小程序。（钢琴、吉他等）。我读过 ALSA 和 Marsyas 音频库。

我在想这个想法是从麦克风中采样数据，对 5-10 毫秒的块进行分析（根据我的阅读）。然后执行 FFT 以确定哪个频率包含最大峰值。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-01T17:45:59.367

本[指南](https://web.archive.org/web/20190728020940/http://0pointer.de/blog/projects/guide-to-sound-apis.html)应该有所帮助。不要将 ALSA 用于您的应用程序。使用更高级别的 API。如果您决定要使用 JACK，[http://jackaudio.org/applications](http://jackaudio.org/applications)提供了三个乐器调音器，您可以将其用作示例代码。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-07-06T17:05:03.527

Marsyas 将是执行此操作的绝佳选择，它专为此类任务而设计。

要为乐器调音，您需要做的是有一个算法来估计声音的基频 (F0)。有许多算法可以做到这一点，最新最好的算法之一是由 Alain de Cheveigne 开发的 YIN 算法。我最近在 Marsyas 中添加了 YIN 算法，使用起来非常简单。

这是您将在 Marsyas 中使用的基本代码：

```
  MarSystemManager mng;

  // 包含所有内容的系列
  MarSystem* net = mng.create("系列", "系列");

  // 使用 AubioYin 处理来自 SoundFileSource 的数据
  net->addMarSystem(mng.create("SoundFileSource", "src"));
  net->addMarSystem(mng.create("ShiftInput", "si"));
  net->addMarSystem(mng.create("AubioYin", "yin"));

  net->updctrl("SoundFileSource/src/mrs_string/filename",inAudioFileName);

  while (net->getctrl("SoundFileSource/src/mrs_bool/notEmpty")->to<mrs_bool>()) {
    净->滴答（）；
    realvec r = net->getctrl("mrs_realvec/processedData")->to<mrs_realvec>();
    cout << r(0,0) << endl;
  }

```

此代码首先创建一个 Series 对象，我们将向其添加组件。在一个系列中，每个组件都以串行方式接收前一个 MarSystem 的输出。然后我们添加一个 SoundFileSource，您可以将 .wav 或 .mp3 文件输入其中。然后我们添加输出重叠音频块的 ShiftInput 对象，然后将其馈入 AubioYin 对象，该对象估计该音频块的基频。

然后我们告诉 SoundFileSource 我们要读取音频文件名中的文件。

然后 while 语句循环，直到 SoundFileSource 用完数据。在 while 循环中，我们获取网络已处理的数据并输出 (0,0) 元素，即基频估计值。

当您使用 Marsyas 的 Python 绑定时，这会更容易。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-11-24T11:05:49.567

[http://clam-project.org/](http://clam-project.org/) CLAM 是一个成熟的软件框架，用于音频和音乐领域的研究和应用程序开发。它提供了一个概念模型以及用于分析、合成和处理音频信号的工具。

他们有一个很棒的 AP​​I、漂亮的 GUI 和一些完成的应用程序，您可以在其中看到所有内容。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-01T14:47:25.053

ALSA 现在是 linux 的默认标准，因为内核驱动程序包含在内核中并且 OSS 被贬值。然而，ALSA 用户空间还有其他选择，例如[jack](http://jackaudio.org)，它似乎针对低延迟的专业类型应用程序。它的 API 似乎有一个更好的 API，虽然我没有使用过它，但我对 ALSA API 的短暂接触会让我觉得几乎任何东西都会更好。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-06T02:32:27.533

[Audacity](http://audacity.sourceforge.net/)包括频率图功能并具有内置的 FFT 滤波器。

# c# - Linq 查询丢失顺序

> ID：703130
> 
> 赞同：1
> 
> 时间：2009-03-31T21:28:02.257
> 
> 标签：c#, linq

我的数据库中有一个生成有序结果的视图，但是当我在该视图上运行 Linq 查询时，结果不再是有序的（至少，根据我用来迭代结果的 foreach 和调试器）。这是 Linq 的已知困难，还是我错过了什么？

**更新**：我的观点，来自 SQL Server 2008（来自设计视图）：

```
SELECT     TOP (100) PERCENT UrlId, Title, Description, Url, Parent, ResourceKey, Published, dbo.udf_SiteMap_GetRoles(UrlId) AS Roles
FROM         dbo.SiteMap
ORDER BY DisplayOrder 
```

构建 SiteMap 的 Linq 查询：

```
SqlConnection connection = new SqlConnection(_connect);
DataContext dc = new DataContext(connection);
Table<NodeRoleEntity> siteMapTable = dc.GetTable<NodeRoleEntity>();

var rootQuery = from ne in siteMapTable
                where ne.ParentID == null
                select ne;
foreach (NodeRoleEntity rootNode in rootQuery)
{
   SiteMapNode root = rootNode.AsSiteMapNode(this);
   base.AddNode(root, _root);
   AddChildNodes(root, siteMapTable);
} 
```

此查询使用上面构建的 SiteMap 在我的 ASP.NET 应用程序中呈现菜单：

```
StaticSiteMapProvider _provider = SiteMap.Providers["MySiteMap"] as StaticSiteMapProvider;
string cultureToken = _GetCulture().ToLower();
SiteMapNode cultureRoot = 
    (from SiteMapNode cr in _provider.RootNode.ChildNodes
     where cr.Description == cultureToken
     select cr).First();

int menuCount = 0;            
foreach (SiteMapNode node in cultureRoot.ChildNodes)
{
   _RenderMenu(node, menuCount.ToString(), writer);
   menuCount++;
} 
```

是其中的节点`cultureRoot.ChildNodes`排序不正确（但派生这些节点的行是有序的）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-01T02:44:21.123

您的 linq 查询是：

```
var rootQuery = from ne in siteMapTable
                where ne.ParentID == null
                select ne; 
```

这将像这样生成sql

```
SELECT *
FROM SiteMapTable
WHERE ParentID == @P1 
```

您可以将此 sql 带到数据库中，运行它并观察您的结果是无序的。这是发生的事情：

在数据库中，视图的文本将作为子查询放入您的查询中。

```
SELECT *
FROM
(
   SELECT top 100 percent *
   FROM ...
   ORDER BY ...
) as SiteMapTable
WHERE ParentID == @P1 
```

查询优化器会注意到在最外层没有要求排序，并决定结果不需要排序。它将去除/忽略子查询中的排序。您可以查看估计的执行计划来确认这一点。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-31T22:22:46.167

当您从视图中选择时，它不会保持其顺序。您必须在 LINQ 中输入：

```
SiteMapNode cultureRoot = (
   from SiteMapNode cr in _provider.RootNode.ChildNodes
   where cr.Description == cultureToken
   orderby cr.DisplayOrder
   select cr
).First(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-31T22:26:34.050

ORDER BY 子句严格来说不允许在 SQL Server 的视图中使用。您必须在 linq 查询中添加 OrderBy 子句。

见这里： http: [//www.devx.com/dbzone/Article/8048](http://www.devx.com/dbzone/Article/8048)

# c# - 如何使用 .NET XmlSerializer 使值类型可以为空？

> ID：703137
> 
> 赞同：29
> 
> 时间：2009-03-31T21:30:18.273
> 
> 标签：c#, xml-serialization, null, value-type

假设我有这个对象：

```
[Serializable]
public class MyClass
{
    public int Age { get; set; }
    public int MyClassB { get; set; }
}
[Serializable]
public class MyClassB
{
    public int RandomNumber { get; set; }
} 
```

XmlSerializer 将像这样序列化对象：

```
<MyClass>
    <Age>0</age>
    <MyClassB>
        <RandomNumber>4234</RandomNumber>
    </MyClassB>
</MyClass> 
```

如何使属性 Age 可以为空？IE：当它小于0时不序列化属性Age？

我尝试使用 Nullable，但它像这样序列化我的对象：

```
<MyClass>
    <Age d5p1:nil="true" />
    <MyClassB>
        <RandomNumber>4234</RandomNumber>
    </MyClassB>
</MyClass> 
```

通过阅读 MSDN 文档，我发现了这一点：

> 您不能将 IsNullable 属性应用于类型为值类型的成员，因为值类型不能包含 nullNothingnullptra 空引用（在 Visual Basic 中为 Nothing）。此外，对于可为空的值类型，您不能将此属性设置为 false。当此类类型为 nullNothingnullptra 空引用（Visual Basic 中为 Nothing）时，它们将通过将 xsi:nil 设置为 true 来进行序列化。

来源：http: [//msdn.microsoft.com/en-us/library/system.xml.serialization.xmlelementattribute.isnullable.aspx](http://msdn.microsoft.com/en-us/library/system.xml.serialization.xmlelementattribute.isnullable.aspx)

我知道值类型不能设置为空。值类型总是设置为某事。序列化无法根据其当前值决定是否对其进行序列化。

我尝试了属性，但没有成功。我尝试创建一个 agecontainer 对象并使用属性操作它的序列化，但没有成功。

我真正想要的是：

```
<MyClass>
    <MyClassB>
        <RandomNumber>4234</RandomNumber>
    </MyClassB>
</MyClass> 
```

当属性 Age 小于 0（零）时。

* * *

> 看起来你必须实现自定义序列化。

是的，我也是这么想的，但我想没有它就离开。

在应用程序中，对象要复杂得多，我不想自己处理序列化。

* * *

## 回答 #1

> 赞同：57
> 
> 时间：2009-03-31T22:01:27.997

我刚刚发现了这一点。`XmlSerialier`查找`XXXSpecified`布尔属性以确定是否应包含它。这应该可以很好地解决问题。

```
[Serializable]
public class MyClass
{
  public int Age { get; set; }
  [XmlIgnore]
  public bool AgeSpecified { get { return Age >= 0; } }
  public int MyClassB { get; set; }
}

[Serializable]
public class MyClassB
{
  public int RandomNumber { get; set; }
} 
```

证明：

```
static string Serialize<T>(T obj)
{
  var serializer = new XmlSerializer(typeof(T));
  var builder = new StringBuilder();
  using (var writer = new StringWriter(builder))
  {
    serializer.Serialize(writer, obj);
    return builder.ToString();
  }
}

static void Main(string[] args)
{
  var withoutAge = new MyClass() { Age = -1 };
  var withAge = new MyClass() { Age = 20 };

  Serialize(withoutAge); // = <MyClass><MyClassB>0</MyClassB></MyClass>
  Serialize(withAge); // = <MyClass><Age>20</Age><MyClassB>0</MyClassB></MyClass>
} 
```

* * *

**编辑**：是的，这是一个记录的功能。请参阅[MSDN 条目`XmlSerializer`](http://msdn.microsoft.com/en-us/library/system.xml.serialization.xmlserializer.aspx)

> 另一种选择是使用特殊模式来创建 XmlSerializer 识别的布尔字段，并将 XmlIgnoreAttribute 应用于该字段。该模式以 propertyNameSpecified 的形式创建。例如，如果有一个名为“MyFirstName”的字段，您还将创建一个名为“MyFirstNameSpecified”的字段，它指示 XmlSerializer 是否生成名为“MyFirstName”的 XML 元素。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-12-11T12:13:18.213

将 Samuel 的答案和 Greg Beech 的评论扩展到布尔属性的情况：如果属性是 bool 类型，那么您不能在 propertySpecified 属性中编写简单的测试。

一种解决方案是使用 Nullable<bool> 类型，那么在 propertySpecified 属性中的测试就是 property.HasValue。例如

```
using System.Xml.Serialization;

public class Person
{
    public bool? Employed { get; set; }

    [XmlIgnore]
    public bool EmployedSpecified { get { return Employed.HasValue; } }
} 
```

对数字属性使用可为空类型的替代方法（Greg Beech 建议）是将 value 属性设置为无效的默认值，例如 -1，如下所示：

```
using System.ComponentModel;
using System.Xml.Serialization;

public class Person
{
    [DefaultValue(-1)]
    public int Age { get; set; }

    [XmlIgnore]
    public bool AgeSpecified { get { return Age >= 0; } }
} 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2013-12-18T07:51:25.183

您可以使用**[XmlElementAttribute.IsNullable](http://msdn.microsoft.com/en-us/library/system.xml.serialization.xmlelementattribute.isnullable.aspx)**：

```
[Serializable]
public class MyClass
{
    [XmlElement(IsNullable = true)]
    public int? Age { get; set; }

    public int MyClassB { get; set; }
} 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-03-31T22:03:27.570

这应该有助于使年龄`int?`和..

```
public bool ShouldSerializeAge() { return Age.HasValue; } 
```

..这确实意味着将 ShouldSerializeXXX 方法添加到您的课程中！

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-31T22:10:59.983

您需要进行自定义 XML 序列化；请参阅[IXmlSerializer](http://msdn.microsoft.com/en-us/library/system.xml.serialization.ixmlserializable.aspx)。

```
public class MyClass : IXmlSerializable
{
    public int Age { get; set; }
    public MyClassB MyClassB { get; set; }

    public System.Xml.Schema.XmlSchema GetSchema()
    {
        // http://msdn.microsoft.com/en-us/library/system.xml.serialization.ixmlserializable.aspx
        return null;
    }

    public void ReadXml(XmlReader reader)
    {
        if (reader.IsStartElement("Age"))
            Age = reader.ReadContentAsInt();

        var serializer = new XmlSerializer(typeof(MyClassB));
        MyClassB = (MyClassB)serializer.Deserialize(reader);
    }

    public void WriteXml(XmlWriter writer)
    {
        if (Age > 0)
        {
            writer.WriteStartElement("Age");
            writer.WriteValue(Age);
            writer.WriteEndElement();
        }

        var serializer = new XmlSerializer(typeof(MyClassB));
        serializer.Serialize(writer, MyClassB);
    }
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-11-12T15:02:17.910

忘记 Nullable ... ShouldSerializeXXX 是一个很好的解决方案。此处年龄将根据您的情况进行连载。

```
[Serializable]
public class MyClass
{
    public int Age { get; set; }
    public int MyClassB { get; set; }

    #region Conditional Serialization
    public bool ShouldSerializeAge() { return age > 0; }
    #endregion
}

[Serializable]
public class MyClassB
{
    public int RandomNumber { get; set; }
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2010-03-16T03:23:58.717

xsd.exe 将自动生成 XXXSpecified 属性和访问器，如果您将元素的 'minoccurs' 属性设置为 'minoccurs="0"' ...如果您使用架构来定义您的 xml/类

# iphone - iPhone 可可超链接

> ID：703142
> 
> 赞同：6
> 
> 时间：2009-03-31T21:31:20.830
> 
> 标签：iphone, cocoa-touch, hyperlink

有没有办法在 iPhone 原生应用程序中显示超链接。这是通过标签还是其他 UI 对象完成的？

谢谢！乔

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-01T11:30:04.027

看看[Three20](http://github.com/joehewitt/three20) TTStyledText 类

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-01T05:44:50.080

创建一个只有文本（无背景图像）的自定义 UIButton 并在点击时编写一个 IBAction - 你有一个超链接......

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-31T21:56:14.997

您可以通过静态 HTML 文件将文本与超链接标记一起嵌入到 uiwebview 对象中。另一种方法是在 uibutton 上显示链接文本，然后单击该按钮打开 safari 以导航到链接

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-31T23:50:53.160

我建议以下解决方案：将 htperlink 文本显示为标签，并在其后放置一个详细的禁止按钮。（详细披露按钮是一个圆圈（>）中的箭头。将按钮标题设置为url，并制作一个处理按钮点击的IBAction。在此操作中，您可以创建一个新的UIWebView，显示它并加载URL进去。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2011-04-15T20:15:27.107

UITextView 实际上对此有内置支持。查看这个 stackoverflow 问题的公认答案：[如何在 iPhone 应用程序中添加超链接？](https://stackoverflow.com/questions/4407492/how-to-add-hyperlink-in-iphone-app)

# css - 如何在项目之间共享 CSS 样式表？

> ID：703147
> 
> 赞同：3
> 
> 时间：2009-03-31T21:31:48.317
> 
> 标签：css, architecture, layout

我正在寻求一些 Web 架构建议：我想知道如何在跨越虚拟目录和许多开发人员的 Web 应用程序之间共享通用文件，例如样式表，而不是在每个项目中都有冗余文件？有哪些建议？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-31T21:39:15.943

大多数源代码控制解决方案都提供了一种在不同项目之间共享文件的方法。例如，SourceGear Vault。

这将允许您在一个位置管理您的文件（无论是 css、dll 还是图像），然后任何需要一组文件的项目都可以链接到这些公共文件。源代码管理会将它们拉入项目中，但无论何时编辑它们，它都会在公共位置更新它们。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-31T21:41:45.593

在不了解您的 Web 应用程序的情况下，这有点难说。

首先，你确定你真的想要这样做吗？您的“许多开发人员”之一可能会更改样式表，期望它只影响一个应用程序，并让它影响其他应用程序。事情最终可能会更加混乱，因为您必须创建每个应用程序样式表来覆盖共享样式表中的内容，等等。在继续之前，我会考虑这些潜在的副作用。

但是，如果您确实想要这样做，只需将样式表托管在某处，并让所有应用程序在其`<link>`或`@import`语句中引用该位置即可。没有任何限制迫使您使用来自同一个“站点”的样式表。如果您希望它看起来不错，请设置自己的子域或其他内容，例如`http://shared.whatever.com/css/styles.css`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-31T21:39:37.690

您可以创建另一个包含公共/共享文件的虚拟目录，并让其他 Web 应用程序从那里访问它们。

# java - 用Java绘制高斯曲线

> ID：703150
> 
> 赞同：5
> 
> 时间：2009-03-31T21:33:16.283
> 
> 标签：java, applet, charts, piccolo

我正在用[Piccolo](http://code.google.com/p/piccolo2d/)编写一个交互式小程序，我需要在其中包含一条高斯曲线（又名[正态分布图](http://en.wikipedia.org/wiki/Normal_distribution)）。

我想任何一种 Java 实现都足够了，但我找不到。理想情况下，我想传递一组值并将图表绘制在面板、图像对象或任何可以嵌入到小程序中的东西中。

在自己动手编写代码之前，有没有人知道有一段代码可以做到这一点？

欢迎使用其他语言的实现，只要它们易于移植到 Java。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-31T21:38:08.503

不知道它是否有效，但谷歌抛出了[这段代码来绘制高斯分布](http://vase.essex.ac.uk/software/JavaPlot/code/ac/essex/graphing/charts/continuous/Gaussian.java.html)。

这个项目的主页[在这里](http://vase.essex.ac.uk/software/JavaPlot/)。

如果 Piccolo 不为您执行绘图，我可能会使用[JFreeChart](http://www.jfree.org/jfreechart/)进行实际绘图，因为它得到广泛支持且功能强大。（我对短笛不熟悉）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-31T21:42:17.400

编辑：看起来[Apache Commons Math 库](http://commons.apache.org/math/)有一个统计部分。具体来说，是一个关于 common [Distributions](http://commons.apache.org/math/userguide/distribution.html)的完整包。希望那里有一些数学人，因为我不记得基本的统计数据……这是我尝试使用他们的库的尝试。我在这里只有一个滑动窗口并计算这些值之间的 P。从中获取 PDF 的真正方法是什么？它们只有 CDF 功能。

```
public void testNormalDist() throws MathException {
    DistributionFactory f = DistributionFactory.newInstance();
    NormalDistribution n = f.createNormalDistribution(0.0d, 1.0d);
    double lastx = Double.NEGATIVE_INFINITY;
    double nextx = Double.NEGATIVE_INFINITY;
    for (int i=-100; i < 100; i++) {
        nextx = i / 100d;
        System.out.println(n.cumulativeProbability(lastx, nextx));
        lastx = nextx;
    }
} 
```

我假设您想要图表的概率密度函数。这些[方程式在 wikipedia 上](http://en.wikipedia.org/wiki/Normal_distribution)，因为我不知道如何在此处包含数学标记。只需使用 p(x) 作为您的 Y 值和 X 作为您的 X 值，您就可以从中获得一个非常简单的二维图。

你看过[Java 下的 Mathtools](http://www.mathtools.net/Java/Statistics/)吗？

好的，这个怎么样......你给它一个X点数组（标准化，当然，你可以通过将每个像素位置除以图像的宽度来将你的X像素转换为这些），它将返回分布曲线（再次乘以您的归一化因子）。这是平均值为 0 且标准差为 1 的基本情况。

```
public double[] normalDistBasic(double[] xarray, double mu) {
    double[] yarray = new double[xarray.length];
    double rad2pi = 2.50662827d;
    for (int off = 0; off < yarray.length; off++) {
        double x = xarray[off];
        double ss = -1d * x * x / 2d;
        yarray[off] = (-1f / rad2pi) * Math.exp(ss);
    }
    return yarray;
} 
```

如果在网上找不到，那么实现一个采用任意均值和标准差的方法应该很容易。

# regex - Mathematica StringReplace 替换包含换行符的子字符串

> ID：703153
> 
> 赞同：1
> 
> 时间：2009-03-31T21:34:00.837
> 
> 标签：regex, string, wolfram-mathematica

我在字符串中有如下内容：

```
blah blah

BEGINIGNORE
   this stuff should get stripped out
ENDIGNORE

more stuff here 
```

我想这样做（perl 语法）： s/BEGINIGNORE.*ENDIGNORE//s - 即去掉BEGINIGNORE 和ENDIGNORE 之间的所有内容，包括在内。您会认为以下内容会在 Mathematica 中执行此操作：

```
StringReplace[str, re["BEGINIGNORE[.\\s]*ENDIGNORE"]->""] 
```

但事实并非如此。我如何在 Mathematica 中做到这一点？

PS：我定义了以下别名： `re = RegularExpression;`

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-31T21:36:57.307

事实证明，由于某种原因，“ `[.\\s]`”和“ `[.\\n]`”不起作用，但“ ”起作用`(.|\\n)`。所以以下工作：

```
strip[s_String] := StringReplace[s, re@"BEGINIGNORE(.|\\n)*ENDIGNORE" -> ""] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-31T21:45:45.567

尝试：

```
StringReplace[str, re["BEGINIGNORE(.|\\n)*ENDIGNORE"]->""] 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-05-25T14:43:19.620

在正则表达式中插入`(?s)`修饰符。这相当于 Perl 的`/s`修饰符，是标准[PCRE](http://pcre.org)语法的一部分。

```
StringReplace[str, re["BEGINIGNORE(?s).*ENDIGNORE"]->""] 
```

相关问题的答案中的更多详细信息： [Mathematica 中的错误：正则表达式应用于非常长的字符串](https://stackoverflow.com/questions/2257884/bug-in-mathematica-regular-expression-applied-to-very-long-string/2261807#2261807)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-01T16:14:50.817

随着您的跟进，您需要括号而不是方括号围绕您想要的表达式`*`。

方括号在这里定义了一个字符类，就像在大多数正则表达式语言中一样。这就是为什么`[.\\s]`没有按预期工作的原因，它代表一组字符而不是带括号的表达式。也许 Mathematica 将 [] 用于表达式让您朝那个方向思考？

# asp.net-mvc - ASP .NET MVC - 控制器数量

> ID：703159
> 
> 赞同：2
> 
> 时间：2009-03-31T21:35:20.523
> 
> 标签：asp.net-mvc

每个需要在系统中操作的表是否应该有一个单独的控制器？

例如，在设计内容管理系统的管理部分时，是否应该有一个单独的控制器来配置每个查找域，如下所示：

```
/DataTypeA/List --list for A
/DataTypeA/Create -- create new data
.
. 
.
/DataTypeB/List --list for B 
```

或者应该在管理控制器中有单独的操作，如下所示

```
/Admin/DataTypeA -- this lists DataTypeA
/Admin/DatatypeB -- this lists DataTypeB
/Admin/DataTypeA_Create -- Create a new DataTypeA
/Admin/DataTypeB_Create -- Create a new DataTypeB 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-31T22:08:25.903

我的方法是为系统中的主要参与者（表）创建一个新控制器。辅助表最终开始由控制器为辅助数据关联的主表更新。例如，我将有一个 User 控制器并有一个操作来更新与 User 控制器中的特定用户相关联的 UserContact 信息，而不是创建一个单独的 UserContact 控制器。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-01T16:50:32.480

我发现打赌的方法是，一旦您到达表示层（在这种情况下为 Web 层），您应该进行逻辑分组而不是技术分组。如果你有一个 Product 和 Category 表，你可能想要创建一个 Catalog 控制器，或者一个 Store 控制器。这将有助于并允许您重用大量代码并保持井井有条。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-31T22:04:49.313

基本上，这取决于您所追求的以及您希望如何组织代码。如果 DataTypeA 与 DataTypeB 明显不同（即动物与汽车），那么您可能想要使用不同的控制器。但是，如果 DataTypeA 是 DataTypeB 的子集（或类似），那么我会使用一个具有不同操作的控制器。

ASP.NET MVC 非常灵活，非常酷，尽管不可否认，刚开始时，灵活性感觉就像溺水一样。只需开始编写代码，您就会意识到自己是否走错了路。MVC 有一个学习曲线。随它去吧。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-31T22:08:15.467

我认为这在很大程度上是一种设计选择。我不认为有一个明确的答案，尽管我想如果你坚持模式的字母，那么你会选择一个控制器每个数据类型选项。

不久前，我开始组装一个小型原型博客系统来尝试 ASP.NET MVC（遗憾的是，仍然是一个 WIP），我最终做出的一个设计决定是将 Comment 控制器包含在 Post 控制器中。但是，我只是在尝试了单独的控制器后才决定这样做的。我认为这很有效，因为这两个概念是如此紧密地交织在一起：没有博客文章就无法发表评论。

# shell - 将shell输出格式化为结构化数据？

> ID：703163
> 
> 赞同：0
> 
> 时间：2009-03-31T21:36:57.103
> 
> 标签：shell, formatting, output

是否有任何方法可以将 shell 命令的输出格式化为 JSON 或 XML 等结构化数据格式，以供其他应用程序处理？

用例：网络上的一组 CentOS 服务器。我想通过 SSH 以编程方式登录到它们，运行命令以获取系统统计信息并最终运行基本维护命令。而不是自己解析所有文本输出，我想知道是否有任何东西可以帮助我以结构化格式返回数据？即使只支持一些 shell 命令，这也是一个良好的开端。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-31T22:22:59.707

听起来像是 SNMP 的任务。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-04-18T13:10:36.217

可以相当轻松地使用 puppet。您可以将其配置为仅对您要检查的内容进行检查。

您的整个 puppet 配置可能包括：

```
exec { "yum install foo":
  unless => "some-check for software",
} 
```

那会运行`yum install foo`，但前提是`some-check for software`失败。

也就是说，如果您管理多于几台服务器以获取尽可能多的配置并构建到 puppet 清单（或 cfengine、bcfg2 或类似物）中，那么会有很多好处。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-04T00:39:02.673

查看 Nagios ( [http://www.nagios.org/](http://www.nagios.org/) ) 进行远程系统监控。您正在寻找的东西可能已经存在。

# .net - 撤消使用 Sourcesafe 获取最新版本

> ID：703166
> 
> 赞同：3
> 
> 时间：2009-03-31T21:37:02.297
> 
> 标签：.net, version-control, visual-sourcesafe, recovery

有没有办法从项目中撤消获取最新版本？我已经在一个项目上工作了一周，但从未检查过我正在处理的文件。一位同事不得不从我的电脑上传一个版本，所以他在整个解决方案上使用了 get-latest-version（递归）命令。

看来我的 Visual Studio 有问题，它允许在不签出文件的情况下进行编辑，所以我的所有编辑都在没有检查文件的情况下被关闭。当 Vs 提示我的同事检查是否保留更改或用 SourceSafe 替换本地版本时，他选择用 SourceSafe 的版本替换本地版本，并且我的 VS 已配置为将该设置应用于每个文件。

所以，我刚刚失去了这周的工作。有什么办法可以恢复吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-03-31T21:39:32.353

您可以尝试在 Vista 中使用以前版本的功能，假设您正在运行该功能。除此之外，如果您没有备份，那您就完蛋了。

我还将这归结为一次学习经历——经常签到。如果我失去一天的工作，我会很生气，更不用说整整一周了。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-31T21:41:48.730

哎哟。这里的 IT 部门每晚从机房的磁带系统对每台机器进行备份。您可能会问是否在您所在的地方做过类似的事情。

几个问题：

1) Sourcesafe 不安全。做一些谷歌搜索。您的组织正在通过使用它来要求灾难。

2) 让其他人驾驶您的机器通常不是一个好主意。每个人做事的方式都不一样，在乔治的机器上对乔治来说安全的操作在你的机器上可能不安全。让人们通过这些事情告诉你——如果他们向你介绍你从未做过的事情，无论如何，你更有可能以这种方式学习新东西。

3) 在您的源代码控制工具中设置代码的一个分支，以便您可以每晚签到——即使您没有处于工作状态。这是获取备份的免费方式。

我希望你能找到解决问题的方法。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-01T03:55:37.973

此外，如果您的应用程序是 .NET 并且您构建并且仍然拥有二进制文件（检查您的回收站），您可以使用反射器或类似工具来尝试反编译二进制文件。（[http://www.red-gate.com/products/reflector/](http://www.red-gate.com/products/reflector/)）只要您没有混淆代码，您就可以检索您的一些工作......

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-31T21:42:30.303

VSS 可以在编辑和合并模式下运行，只是没有人启用该选项。您可能是这里的例外，因此请检查您的设置。它还可以在没有设置只读标志的情况下签出文件。

不幸的是，VSS 的 getlatest 只是抓取数据库中的最后一个修订版并将其复制到您的文件系统之上，仅此而已。抱歉，你的工作丢了。您可能很幸运，可以在回收站中找到所有内容。

因此，您可以选择恢复您的工作：备份？如果您有它们，请在它们被当前文件覆盖之前立即获取它们。系统还原？如果您设置了它，您可能会保存您的工作。

下一次：获得像 Mozy 这样的持续备份系统，或使用经常提交模型（定期将工作保存到分支或备用数据库，完成后，将其全部检查到正确的数据库位置）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-31T21:45:55.943

**VSS**在用 sourcesafe 的版本替换本地版本之前警告您。因此，如果您没有备份数据，则您的本地版本将被完全删除

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-31T21:48:32.567

有些人没有意识到这一点，但备份和源代码控制是两个不同的东西。这种情况就是备份的用途。

如果您的 IT 人员至少不定期备份 PC 配置文件，我会感到相当惊讶。如果没有，您可以尝试另一种备份。在停车场等到你的“同事”经过你的车，然后倒车。:-)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-01T03:36:07.893

如果这是一个 ASP.Net 项目，您可以尝试查看 Temporary ASP.Net Files 目录（埋在您的 %system% 目录中），假设您在破坏本地文件后还没有运行该项目。

# wpf - 如何检测 TextBlock 的 Text 属性的变化？

> ID：703167
> 
> 赞同：25
> 
> 时间：2009-03-31T21:37:25.883
> 
> 标签：wpf, textblock

有没有办法使用事件检测 TextBlock 元素的 Text 属性的变化？

（我正在尝试提供一个动画来突出显示其 Text 属性在 DataGrid 中发生变化的 TextBlocks）

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2015-08-26T17:37:52.913

**这比那更容易！迟到的答案，但更简单。**

```
// assume textBlock is your TextBlock
var dp = DependencyPropertyDescriptor.FromProperty(
             TextBlock.TextProperty,
             typeof(TextBlock));
dp.AddValueChanged(textBlock, (sender, args) =>
{
    MessageBox.Show("text changed");
}); 
```

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2013-10-03T15:46:14.100

这就像 bioskope 答案中链接中的代码，但简化了。您需要该`TargetUpdated`事件并添加`NotifyOnTargetUpdated=True`到绑定中。

```
<TextBlock Text="{Binding YourTextProperty, NotifyOnTargetUpdated=True}" 
           TargetUpdated="YourTextEventHandler"/> 
```

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-03-31T22:18:06.270

据我所知，TextBlock 中没有任何 textchanged 事件。看看您的要求，我觉得重新模板化文本框也不是一个可行的解决方案。根据我的初步搜索，**[这](http://michaelscherf.wordpress.com/2009/02/23/how-to-trigger-an-animation-when-textblocks-text-is-changed-during-a-databinding/)**似乎是一个可能的解决方案。

```
<TextBlock x:Name="tbMessage" Text="{Binding Path=StatusBarText, NotifyOnTargetUpdated=True}">
    <TextBlock.Triggers>
        <EventTrigger RoutedEvent="Binding.TargetUpdated">
            <BeginStoryboard>
                <Storyboard>
                    <DoubleAnimation Storyboard.TargetProperty="Opacity" Duration="0:0:0″
To="1.0″ />
                    <DoubleAnimation Storyboard.TargetProperty="Opacity" Duration="0:0:2″
From="1.0″ To="0.0″ BeginTime="0:0:5″ />
                </Storyboard>
            </BeginStoryboard>
        </EventTrigger>
    </TextBlock.Triggers>
</TextBlock> 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-02-18T14:59:16.940

将 Text 属性绑定到具有事件触发器的 DependencyProperty：

```
public static string GetTextBoxText(DependencyObject obj)
{
    return (string)obj.GetValue(TextBoxTextProperty);
}

public static void SetTextBoxText(DependencyObject obj, string value)
{
    obj.SetValue(TextBoxTextProperty, value);
}

public static readonly DependencyProperty TextBoxTextProperty =
    DependencyProperty.RegisterAttached(
    "TextBoxText",
    typeof(string),
    typeof(TextBlockToolTipBehavior),
    new FrameworkPropertyMetadata(string.Empty, TextBoxTextChangedCallback)
    );

private static void TextBoxTextChangedCallback(DependencyObject d, DependencyPropertyChangedEventArgs e)
{
    TextBlock textBlock = d as TextBlock;
    HandleTextChange(textBlock);
} 
```

在 XAML 中绑定到 TextBlock 文本属性：

```
<TextBlock  
 Text="{Binding SomeProperty, UpdateSourceTrigger=PropertyChanged}"  
     th:TextBlockBehavior.TextBoxText="{Binding Text, 
     RelativeSource={RelativeSource Self}}" /> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-10-18T15:12:05.530

这是 MSDN 上使用代码隐藏的类似示例：http: [//msdn.microsoft.com/en-us/library/system.windows.data.binding.targetupdated.aspx](http://msdn.microsoft.com/en-us/library/system.windows.data.binding.targetupdated.aspx)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-04-17T18:23:26.157

这是你可以使用的东西，我从微软虚拟学院的 Jerry Nixon 和 Daren May “[使用 C# 和 XAML 开发通用 Windows 应用程序](http://blog.jerrynixon.com/2014/10/ready-to-learn-developing-universal.html)”和包含 DependencyObject 逻辑的代码在这里“ [（W8.1-WP8.1）UNIVERSAL适用于 MVA](https://xaml.codeplex.com/releases/view/136763)的应用程序“。

```
namespace App1.Behaviors
{
// <summary>
/// Helper class that allows you to monitor a property corresponding to a dependency property 
/// on some object for changes and have an event raised from
/// the instance of this helper that you can handle.
/// Usage: Construct an instance, passing in the object and the name of the normal .NET property that
/// wraps a DependencyProperty, then subscribe to the PropertyChanged event on this helper instance. 
/// Your subscriber will be called whenever the source DependencyProperty changes.
/// </summary>
public class DependencyPropertyChangedHelper : DependencyObject
{
    /// <summary>
    /// Constructor for the helper. 
    /// </summary>
    /// <param name="source">Source object that exposes the DependencyProperty you wish to monitor.</param>
    /// <param name="propertyPath">The name of the property on that object that you want to monitor.</param>
    public DependencyPropertyChangedHelper(DependencyObject source, string propertyPath)
    {
        // Set up a binding that flows changes from the source DependencyProperty through to a DP contained by this helper 
        Binding binding = new Binding
        {
            Source = source,
            Path = new PropertyPath(propertyPath)
        };
        BindingOperations.SetBinding(this, HelperProperty, binding);
    }

    /// <summary>
    /// Dependency property that is used to hook property change events when an internal binding causes its value to change.
    /// This is only public because the DependencyProperty syntax requires it to be, do not use this property directly in your code.
    /// </summary>
    public static DependencyProperty HelperProperty =
        DependencyProperty.Register("Helper", typeof(object), typeof(DependencyPropertyChangedHelper), new PropertyMetadata(null, OnPropertyChanged));

    /// <summary>
    /// Wrapper property for a helper DependencyProperty used by this class. Only public because the DependencyProperty syntax requires it.
    /// DO NOT use this property directly.
    /// </summary>
    public object Helper
    {
        get { return (object)GetValue(HelperProperty); }
        set { SetValue(HelperProperty, value); }
    }

    // When our dependency property gets set by the binding, trigger the property changed event that the user of this helper can subscribe to
    private static void OnPropertyChanged(DependencyObject d, DependencyPropertyChangedEventArgs e)
    {
        var helper = (DependencyPropertyChangedHelper)d;
        helper.PropertyChanged(d, e);
    }

    /// <summary>
    /// This event will be raised whenever the source object property changes, and carries along the before and after values
    /// </summary>
    public event EventHandler<DependencyPropertyChangedEventArgs> PropertyChanged = delegate { };
}
} 
```

使用 XAML：

```
<TextBlock Grid.Row="0"
       x:Name="WritingMenuTitle"
       HorizontalAlignment="Left"
       FontSize="32"
       FontWeight="SemiBold"
       Text="{Binding WritingMenu.Title}"
       TextAlignment="Left"
       TextWrapping="Wrap"/> 
```

用法 xaml.cs：

```
Behaviors.DependencyPropertyChangedHelper helper = new Behaviors.DependencyPropertyChangedHelper(this.WritingMenuTitle, Models.CommonNames.TextBlockText);
helper.PropertyChanged += viewModel.OnSenarioTextBlockTextChangedEvent; 
```

使用 viewmodel.cs：

```
public async void OnSenarioTextBlockTextChangedEvent(object sender, DependencyPropertyChangedEventArgs args)
{
StringBuilder sMsg = new StringBuilder();

try
{
    Debug.WriteLine(String.Format(".....WritingMenuTitle : New ({0}), Old ({1})", args.NewValue, args.OldValue));
}
catch (Exception msg)
{
    #region Exception
    .....
    #endregion
}
} 
```

# c# - 过程监控

> ID：703176
> 
> 赞同：2
> 
> 时间：2009-03-31T21:38:45.053
> 
> 标签：c#, process

我对 System.Diagnostics.Process 类非常熟悉。但是，我想知道如何监控特定进程（即检查它是否每 XX 分钟/秒运行一次）。我需要能够检查一个进程是否正在运行，如果是，则继续初始化程序的其余部分。

谢谢，
-扎克

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-31T21:39:40.527

检查它是否仍在运行很容易：[`Process.HasExited`](http://msdn.microsoft.com/en-us/library/system.diagnostics.process.hasexited.aspx).

但是，您可以设置[`EnableRaisingEvents`](http://msdn.microsoft.com/en-us/library/system.diagnostics.process.enableraisingevents.aspx)为 true，并将处理程序附加到[`Exited`](http://msdn.microsoft.com/en-us/library/system.diagnostics.process.exited.aspx)事件，而不是定期轮询。

编辑：回答关于“获取”过程的评论中的问题 - 这取决于您已经知道的内容。如果你知道它的进程 ID，你可以使用[`Process.GetProcessById`](http://msdn.microsoft.com/en-us/library/system.diagnostics.process.getprocessbyid.aspx). 如果您只知道它的名称，那么如果您获得多个结果，您将不得不使用[`Process.GetProcessesByName`](http://msdn.microsoft.com/en-us/library/system.diagnostics.process.getprocessesbyname.aspx)并计算出该怎么做。如果您不知道*确切的*名称，您可以使用[`Process.GetProcesses`](http://msdn.microsoft.com/en-us/library/system.diagnostics.process.getprocesses.aspx)并查找您*所*知道的任何信息。这些选项实际上是按优先顺序排列的:)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-31T21:40:37.903

如果您没有自己启动该进程，您可以`Process`通过查看由返回的列表找到与进程关联的对象[`Process.GetProcessesByName(...)`](http://msdn.microsoft.com/en-us/library/system.diagnostics.process.getprocessesbyname.aspx)or[`Process.GetProcesses(...)`](http://msdn.microsoft.com/en-us/library/system.diagnostics.process.getprocesses.aspx)

一旦你有了这个过程，你可以听读它的属性（包括[`HasExited`](http://msdn.microsoft.com/en-us/library/system.diagnostics.process.hasexited.aspx)）和（正如乔恩在他的回复中提到的那样），如果你设置[`EnableRaisingEvents`](http://msdn.microsoft.com/en-us/library/system.diagnostics.process.enableraisingevents.aspx)了你可以听它的事件（包括[`Exited`](http://msdn.microsoft.com/en-us/library/system.diagnostics.process.exited.aspx)）。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-03-31T21:45:34.540

像这样的东西，也许？

```
 Process[] processlist = Process.GetProcesses();

        bool found = false;
        foreach (Process theprocess in processlist)
        {
            if(theprocess.ProcessName == "YourProcessName")
            {
                found = true;
                break;
            }
        }

        if (!found)
        {
            return;
        } 
```

# python - 在 python 中使用 email.HeaderParser 和 imaplib.fetch？

> ID：703185
> 
> 赞同：10
> 
> 时间：2009-03-31T21:40:57.280
> 
> 标签：python, email

有没有人有一个很好的例子，在 Python 中使用 HeaderParser 类来获取您使用 imaplib.fetch 下拉的消息？

我已经能够找到很多相关的东西，但没有什么能做到这一点。

我是否需要完整地获取具有 RFC822 的内容？我希望简单地拉下主题。

谢谢！

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-03-31T23:27:07.260

好消息：你是对的......你不需要拉下 RFC822。`message_parts`参数 to`fetch()`让你非常细粒度。

这是一个如何仅获取标头的简单示例：

```
import imaplib
from email.parser import HeaderParser

conn = imaplib.IMAP4('my.host.com')
conn.login('my@username.com', 'mypassword')
conn.select()
conn.search(None, 'ALL') # returns a nice list of messages...
                         # let's say I pick #1 from this

data = conn.fetch(1, '(BODY[HEADER])')

# gloss over data structure of return... I assume you know these
# gives something like:
# ('OK', [(1 (BODY[HEADER] {1662', 'Received: etc....')])
header_data = data[1][0][1]

parser = HeaderParser()
msg = parser.parsestr(header_data)
<email.message.Message instance at 0x2a>

print msg.keys()
['Received', 'Received', 'Received', 'Cc', 'Message-Id', 'From', 'To',
'In-Reply-To', 'Content-Type', 'Content-Transfer-Encoding', 'Mime-Version',
'Subject', 'Date', 'References', 'X-Mailer', 
'X-yoursite-MailScanner-Information',
'X-yoursite-MailScanner', 'X-yoursite-MailScanner-From', 'Return-Path',
'X-OriginalArrivalTime'] 
```

可以作为第二个参数传递给的消息部分的完整列表`fetch`在 IMAP4 规范中：[https ://www.rfc-editor.org/rfc/rfc1730#section-6.4.5](https://www.rfc-editor.org/rfc/rfc1730#section-6.4.5)

# c - 关于不兼容 printf 格式说明符的问题

> ID：703192
> 
> 赞同：5
> 
> 时间：2009-03-31T21:42:33.580
> 
> 标签：c, c99

我只是在浏览 printf 的手册页，我发生了一些事情。我想知道这里是否有任何“语言律师”可以回答一个相对简单的问题：-P。

所以't'修饰符定义为

> 以下整数转换对应于 ptrdiff_t 参数。

那么，如果将它与无符号整数转换结合起来会发生**什么？**显然 o,u,x 和 X 都打算被解释为无符号值，而 d 和 i 是有符号的。

同样`size_t`，`ssize_t`除了`ptrdiff_t`.

实际上，没有什么不好的事情发生，因为类型的无符号版本与有符号版本占用的空间量相同。所以右边的字节会从堆栈中弹出。

因此，实际上，在打印除“”之外的所有测试事物的预期值时，没有发生任何“坏” `INT_MIN`（假设`sizeof(int) == sizeof(ptrdiff_t)`.

```
printf("%tu %td\n", INT_MIN, INT_MIN); 
```

印刷

```
2147483648 -2147483648 
```

在 32 位系统上。

标准对此有何看法？我认为答案将是“未定义的行为”。但我想我会问;)。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-31T23:44:50.413

这没东西看。你写的代码是合法的。

关于原因的一些事实：

*   所有有符号整数类型都有无符号对应物，具有相同的大小/对齐要求
*   `ptrdiff_t`标准规定为有符号整数类型。因此，它有一个未签名的双胞胎。（事实上​​，类似的逻辑也适用于`size_t`-`ssize_t`不是 C，而是 POSIX）
*   长度说明`t`符必须与`d`, `i`, `o`, `u`, `x`,`X`类型一起使用

# ruby-on-rails - 我如何将一个小型 ruby 应用程序“插入”到 Ruby on Rails 中以制作网页？

> ID：703197
> 
> 赞同：1
> 
> 时间：2009-03-31T21:44:43.450
> 
> 标签：ruby-on-rails, ruby

我有一个在本地机器上制作的小型 ruby​​ 应用程序。它使用插入数据库的文本文件。这是一个简单的应用程序，它接收一个单词，根据文本文件对其进行处理，然后使用`puts`.

我想将它放入我个人机器上托管的 RoR 框架中。我在一些书籍和在线资料中浏览了一些课程和教程，但它们都涉及数据库。

我通读了**config/environment.rb**中的注释，并在第 19 行找到了取消注释删除 ActiveRecord 的行的说明。

我目前正在寻找适当的目录来放置文本文件本身，以及读取此文本文件的 ruby​​ 应用程序中的代码。谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-31T21:50:10.127

这听起来更适合像[Sinatra](http://www.sinatrarb.com/)这样更轻量级的东西。

如果您被束缚并决定使用 Rails，您可以使用仅运行程序代码的操作来制作控制器，但这似乎有点过头了。你不会使用框架 99.9% 的功能，那为什么还存在呢？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-31T21:52:35.987

您可能想要执行以下操作：

*   有一个将单词作为参数的控制器。
*   将您的应用程序变成一个函数，该函数将单词作为参数并返回结果（而不是执行 puts）
*   从控制器调用函数并渲染结果（例如：

    渲染 :text => my_func(word)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-31T22:34:07.153

如果你只是想给它一个小界面，你可以看看 Shoes，它是一个易于使用的多平台 gui 框架。

或者就像有人提到的那样，看看 Sinatra。

您可以简单地使用 rails 而无需担心 ActiveRecord。我建议将您的小应用程序制作成一个类，并在您要使用的控制器中（或在 environment.rb 中）要求该文件。将文件放在 lib 中，如果数据是临时的，“tmp”就可以了，或者只是将它与您编写的脚本一起放在“lib”中，甚至“db”也是一个很好的位置。要创建一个视图，只需运行您的代码并将返回值放入一个类变量并为其创建一个视图。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-01T08:46:36.793

模型不需要从 ActiveRecord::Base 继承。或者别的什么。只要它遵循模型的命名约定，Rails 就会毫无问题地使用它。

Having said that, if you're really looking at a one-model, one-controller, one-action, no-database app, then Sinatra would probably be a really good lightweight place to start...

# wpf - WPF：样式基于单独程序集中的另一个样式

> ID：703206
> 
> 赞同：20
> 
> 时间：2009-03-31T21:48:19.103
> 
> 标签：wpf, resources, styles, resourcedictionary, mergeddictionaries

程序集 A - ResourceDictionary 包含 StyleA 样式。
程序集 B - ResourceDictionary.MergedDictionaries 将程序集 A 中的资源合并到 B 中。

我想在“基于”StyleA 的程序集 B 中创建一个样式。是否可以？

我正在尝试创建这种风格：

```
<Style x:Key="StyleB" BasedOn="{StaticResource StyleA}">
   <Setter Property="Button.Foreground" Value="Khaki"/>
</Style> 
```

但是如果我使用 StyleB，我会在运行时收到 XamlParseException 异常：

***无法将属性“Style”中的值转换为“System.Windows.Style”类型的对象。只能基于目标类型为“IFrameworkInputElement”的样式。标记文件“SamSeekApp;component/mainwindow.xaml”中的对象“System.Windows.Controls.Button”出错***

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2009-04-01T00:08:08.517

尝试将 TargetType="{x:Type Button}" 添加到您的“StyleB”。

# ruby-on-rails - 如何在 ruby onrails 中最好地创建递归目录列表的 xml 映射？

> ID：703209
> 
> 赞同：3
> 
> 时间：2009-03-31T21:48:47.137
> 
> 标签：ruby-on-rails, xml, ruby

我想在我的 public/catalogs rails 目录中构建所有目录和文件的 XML 映射。（递归映射）

我希望它`<directory> <file>`用 name 属性等于 dir 或文件名的基本元素构造。

```
<catalogs>
 <file name="index.html">
 <directory name="foo">
    <file name="file1.html" />
    <directory name="bar">
       <file name="file2.html" />
    </directory>
 </directory>
</catalogs> 
```

我只是不确定将递归映射到 xml 的最佳方法是什么——我寻找了一个可以处理这个问题的插件，因为它看起来像是有人可能需要构建的东西。

关于创建这个的最佳方法的任何想法或方向？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-01T02:51:11.467

好吧，我从来没有找到一个插件或任何似乎可以做到这一点的东西......所以我不得不自己动手......这里它包含 sha 和 url 的属性，因为我需要它们。希望这对其他人有帮助。

```
xml = Builder::XmlMarkup.new(:indent => 2,:escape_attrs => true)
xml.instruct!    
xml.catalogs(:version=>2) {list_entries("#{CATALOG_PATH}", xml)}
File.open("#{RAILS_ROOT}/public/catalogs.xml", 'w') {|f| f.write(xml.target!) }

def list_entries(dir,xml)
  Dir.glob("#{dir}/*") do |entry|
    if File::directory?(entry)
      xml.directory(:name=>File.basename(entry)) {
        list_entries(entry, xml)
      }
    else
      xml.file(:name=>File.basename(entry),:sha => Digest::SHA256.hexdigest(entry),
      :url=>entry.gsub("#{CATALOG_PATH}","#{CATALOG_URL}"))
    end
  end
end 
```

# php - 将金额除以字符串中存在的字符，通过正则表达式找到

> ID：703217
> 
> 赞同：0
> 
> 时间：2009-03-31T21:50:38.693
> 
> 标签：php, algorithm, language-agnostic

欢迎提出更新标题的建议，因为我无法轻松量化我正在尝试做的事情。

这是一个基于 Web 的表单，使用 PHP 进行计算，尽管这个问题可能有一个算法或语言不可知的答案。

本质上，有一个金额字段和一个费用代码字段。输入的费用代码代表了几个“代理”的简写，金额被分配给他们。大多数情况是单个字母，但是有一些情况会有所不同，并且会带来一些麻烦。

基本上，A = AgentType1，J = AgentType2，L = AgentType3，根据文书工作和用户要求，“A2”也是“J”的有效替代品。

因此，50 的金额和“AJ”的收费代码将导致金额除以 2（两个代理）并相应地分散。对于像“AA2”这样的字符串也是如此。

我目前已经设置了这样的流程（有效）：

```
Divide = 0;
RegEx check for AgentType1 in Charge Code: 
 Divide++;
 Set This-AgentType-Gets-Return; 
RegEx check for AgentType2 in Charge Code: 
 Devide++;
 Set This-AgentType-Gets-Return;
... etc ... 
```

然后我将 Amount 除以“Divide”金额，然后将结果除以 Charge Code 中存在的每个 AgentType。

我知道必须有一种更简单/更简单的方法来实现这一点，但目前我还没有想到。

有没有办法快速得出费用代码中涉及的 AgentTypes 的数量，它们是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-31T22:17:07.177

您可以将费用代码字段更改为字段数组吗？就像是：

```
<input type="hidden" name="agent[]" value="A" /> 
```

因为您的所有代理都会让您这样做：

```
$divide = count($_POST["agent"]);
foreach($_POST["agent"] as $agent) {
    $sum = $_POST["amount"] / $divide;

    //do other stuff
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-31T22:34:00.460

我可能会做这样简单的事情：

```
$valid_codes = array('A', 'J', 'L');

// deal with the special A2 case first, to get it out of the string
// this code could be generalized if more special cases need to be handled
if (stripos($charge_code, 'A2') !== FALSE)
{
    $found['J'] = true;
    str_ireplace('A2', '', $charge_code);
}

foreach ($valid_codes as $code)
{
    if (stripos($charge_code, $code) !== FALSE) // if the code was in the string
    {
        $found[$code] = true;
    }
} 
```

现在你可以得到你需要除以金额的数字`count($found)`，以及你需要除以的代码`array_keys($found)`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-01T00:43:25.313

你不能用这个正则表达式来匹配字符串吗

```
^([A-Z]\d*)*$ 
```

然后通过生成的匹配列表工作？除数就是这个列表的长度（可能在删除重复项之后）。

为了将符号映射到代理（为什么是 AgentTypes？），您可以使用简单的关联列表或哈希图（我不知道 PHP 中最容易使用哪种构造）。

# c# - 使用 C# 在 Windows Server 上添加和删除 IPSec 策略有哪些选项？

> ID：703225
> 
> 赞同：4
> 
> 时间：2009-03-31T21:52:39.717
> 
> 标签：c#, .net, windows, ipsec

我希望能够使用 C# 以编程方式在 Windows Server 2003 上添加或删除 IP 安全策略。

通常，您会通过 gpedit.msc 管理单元手动操作这些策略（在 Windows 设置 -> 本地策略 -> 本地计算机上的 IP 安全策略下）。但我需要能够通过代码添加 IP 过滤策略。

关于如何做到这一点的任何想法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-11-12T19:41:15.770

我已经处理这个问题大约两周了，不幸的是，您有两种选择，具体取决于您需要的控制深度：

1) 使用 WMI 直接操作。与直觉相反，这实际上暴露了比选项＃2 更少的控制（这是我自己正在做的）。这都是通过 Win32_NetworkAdapterConfiguration 类完成的。这是我提出的问题的链接，稍后我在研究后回复：

[使用 C# 以编程方式更改 ipsec 规则的方法？](https://stackoverflow.com/questions/1609882/methods-of-programatically-altering-ipsec-rules-with-c)

这暴露的功能较少，因为您只能通过 IPsec 为适配器控制三件事：TCP 端口、UDP 端口、IP 协议。（您不能处理多个策略、不同的子网掩码等）

2) 包装 netsh ipsec 来完成你所有的脏活。这是要走的路，因为 powershell（可以通过 System.Management.Automation 中的 PowerShell 类调用）目前缺少 cmdlet 来进行 IPSec 更改。

[PowerShell 2 中是否有用于处理 ipsec 更改的 cmdlet？](https://stackoverflow.com/questions/1703205/is-there-a-cmdlet-in-powershell-2-to-handle-ipsec-changes)

通过 System.Management.Automation.PowerShell 调用的 powershell 管道包装 netsh ipsec 是我最终要做的。

使用 System.Diagnostics.Process 生成和控制 shell，或使用上面提到的 PowerShell 类。要么应该完成工作。

***注意*** 如果您在某个时候切换到 2008，请注意不推荐使用 netsh ipsec，并确保改用 netsh advfirewall。

祝你好运！

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2009-03-31T22:20:20.133

您可以使用 System.Diagnostics.Process 并使用 ipsec 命令作为参数运行“cmd.exe”。

您可以尝试的另一个资源是[Microsoft 的网站](http://technet.microsoft.com/en-us/library/cc738298.aspx)或[Google](http://www.google.com/search?hl=en&q=C%23+adding+ipsec+policies&btnG=Google+Search&aq=f&oq=)。

# drupal - Drupal节点？目的地不工作

> ID：703230
> 
> 赞同：1
> 
> 时间：2009-03-31T21:54:03.053
> 
> 标签：drupal

我对 Drupal 6 和（也许）mod_rewrite 有问题：

如果我去*[http://127.0.0.1/drupal/node/115/edit?destination=admin%2Fcontent%2Fnode](http://127.0.0.1/drupal/node/115/edit?destination=admin%2Fcontent%2Fnode)*然后我保存节点，我不会被重定向到*admin/content/node*，但它指示我到节点/115 :-(

为什么？？

在我的 .htaccess 中，我取消了注释：*RewriteBase /drupal*（因为我的drupal 路径是/var/www/htdocs/drupal）

我的服务器在 Slackware 12 上运行 Apache 2.2.4

任何帮助我将不胜感激：D

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-01T16:57:59.670

它确实看起来像一个配置问题，因为这通常有效。您可以通过添加一些 dsm() 转储来调试它`includes/common.inc/drupal_goto()`：这是`destination`处理参数的地方。

请注意，如果某些模块捕获了您的表单提交，例如通过声明`_validate`或`_submit`处理程序，它可以很好地更改重定向信息：检查是否可以在未启用 contrib 模块的情况下重现此信息。

# java - 为什么我在尝试读取文件时收到 NullPointerException？

> ID：703231
> 
> 赞同：7
> 
> 时间：2009-03-31T21:54:17.793
> 
> 标签：java, file-io, itext

我使用此测试将 txt 转换为 pdf ：

```
package convert.pdf;

//getResourceAsStream(String name) : Returns an input stream for reading the specified resource.
//toByteArray : Get the contents of an InputStream as a byte[].

import java.io.FileOutputStream;
import java.io.IOException;

import org.apache.commons.io.IOUtils;

import convert.pdf.txt.TextConversion;

public class TestConversion {

  private static byte[] readFilesInBytes(String file) throws IOException {
      return IOUtils.toByteArray(TestConversion.class.getResourceAsStream(file));
  }

  private static void writeFilesInBytes(byte[] file, String name) throws IOException {
      IOUtils.write(file, new FileOutputStream(name));
  }

  //just change the extensions and test conversions
  public static void main(String args[]) throws IOException {
      ConversionToPDF algorithm = new TextConversion();
      byte[] file = readFilesInBytes("/convert/pdf/text.txt");
      byte[] pdf = algorithm.convertDocument(file);
      writeFilesInBytes(pdf, "text.pdf");
  }

} 
```

问题：

```
线程“主”java.lang.NullPointerException 中的异常
    在 org.apache.commons.io.IOUtils.copyLarge(IOUtils.java:1025)
    在 org.apache.commons.io.IOUtils.copy(IOUtils.java:999)
    在 org.apache.commons.io.IOUtils.toByteArray(IOUtils.java:218)
    在 convert.pdf.TestConversion.readFilesInBytes(TestConversion.java:17)
    在 convert.pdf.TestConversion.main(TestConversion.java:28)

```

我使用调试器，问题似乎出在此处：

```
 private static byte[] readFilesInBytes(String file) throws IOException {
      return IOUtils.toByteArray(TestConversion.class.getResourceAsStream(file));
  } 
```

我的问题是什么？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-03-31T21:58:22.747

听起来该资源可能不存在该名称。

您是否知道`Class.getResourceAsStream()`找到与该类的包相关的资源，而`ClassLoader.getResourceAsStream()`没有？您可以使用前导正斜杠`Class.getResourceAsStream()`来模仿这一点，所以

```
Foo.class.getResourceAsStream("/bar.png") 
```

大致相当于

```
Foo.class.getClassLoader().getResourceAsStream("bar.png") 
```

这*实际上*是您要加载的文件（即普通文件系统上的特定文件）吗？如果是这样，使用`FileInputStream`将是一个更好的选择。`Class.getResourceAsStream()`如果它是以其他方式捆绑在 jar 文件或类路径中的资源，则使用它；`FileInputStream`如果它是可以在文件系统中的任何位置的任意文件，则使用它。

编辑：另一件要小心的事情，这在以前给我造成了问题 - 如果这在你的开发盒上工作，恰好是 Windows，现在在恰好是 Unix 的生产服务器上失败，检查的情况文件名。不同的文件系统以不同的方式处理区分大小写的事实可能会很痛苦......

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-31T21:55:55.980

您是否在将文件传递给之前检查文件是否存在`readFilesInBytes()`？请注意，如果找不到文件，则`Class.getResourceAsStream()`返回。`null`你可能想做：

```
private static byte[] readFilesInBytes(String file) throws IOException {
  File testFile = new File(file);
  if (!testFile.exists()) {
      throw new FileNotFoundException("File " + file + " does not exist");
  }
  return IOUtils.toByteArray(TestConversion.class.getResourceAsStream(file));
} 
```

或者更好：

```
private static byte[] readFilesInBytes(String file) throws IOException {
  InputStream stream = TestConversion.class.getResourceAsStream(file);
  if (stream == null) {
      throw new FileNotFoundException("readFilesInBytes: File " + file
                                      + " does not exist");
  }
  return IOUtils.toByteArray(stream);
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-31T22:20:49.710

该类读取类路径中的一个TXT文件，并使用TextConversion转换为PDF，然后将pdf保存在文件系统中。

这里的TextConversion代码：

```
package convert.pdf.txt;
//Conversion to PDF from text using iText.
import java.io.BufferedReader;
import java.io.ByteArrayInputStream;
import java.io.ByteArrayOutputStream;
import java.io.IOException;
import java.io.InputStreamReader;

import convert.pdf.ConversionToPDF;
import convert.pdf.ConvertDocumentException;

import com.lowagie.text.Document;
import com.lowagie.text.DocumentException;
import com.lowagie.text.Font;
import com.lowagie.text.Paragraph;
import com.lowagie.text.pdf.PdfWriter;

public class TextConversion implements ConversionToPDF {

    public byte[] convertDocument(byte[] documents) throws ConvertDocumentException {
        try {
            return this.convertInternal(documents);
        } catch (DocumentException e) {
            throw new ConvertDocumentException(e);
        } catch (IOException e) {
            throw new ConvertDocumentException(e);
        }
    }

    private byte[] convertInternal(byte[] documents) throws DocumentException, IOException {
        Document document = new Document();

        ByteArrayOutputStream pdfResultBytes = new ByteArrayOutputStream();
        PdfWriter.getInstance(document, pdfResultBytes);

        document.open();

        BufferedReader reader = new BufferedReader( new InputStreamReader( new ByteArrayInputStream(documents) ) );

        String line = "";
        while ((line = reader.readLine()) != null) {
            if ("".equals(line.trim())) {
                line = "\n"; //white line
            }
            Font fonteDefault = new Font(Font.COURIER, 10);
            Paragraph paragraph = new Paragraph(line, fonteDefault);
            document.add(paragraph);
        }

        reader.close();

        document.close();

        return pdfResultBytes.toByteArray();
    }
} 
```

这里是 ConversionToPDF 的代码：

```
package convert.pdf;
// Interface implemented by the conversion algorithms.
public interface ConversionToPDF {

    public byte[] convertDocument(byte[] documentToConvert) throws ConvertDocumentException;
    } 
```

我认为问题来自我的文件系统（Windows 和服务器上的 devbox 是 Unix）。我将尝试修改我的类路径。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-02T01:20:50.517

这个问题可能是调用方法 on 引起的`test.txt`，可以是文件夹快捷方式。换句话说，您正在对不存在的文件调用方法，从而导致`NullPointerException`.

# visual-studio - 从 Delphi 中自动化 Visual Studio 并启动项目项

> ID：703233
> 
> 赞同：0
> 
> 时间：2009-03-31T21:54:32.303
> 
> 标签：visual-studio, delphi, ole

Visual Studio 类型库

我正在尝试从 Delphi 打开 Visual Studio（用于编辑 SSRS 报告），并从我自动生成的解决方案文件中加载特定的项目项。

我已经导入了 Visual Studio 类型库，并且可以创建对象，并钻取解决方案，直到我拥有正确的 ProjectItem

objDTE := CreateOleObject('VisualStudio.DTE') as DTE;

但是，我现在正处于拥有 ProjectItem 的位置，并且想要执行以下操作

_ProjectItem.Open(vsViewKindDesigner);

不幸的是 vsViewKindDesigner 是某种我找不到类型库的常量，它必须与下面的特定 Guid 相关。

为了在 ProjectItem.Open 方法中使用此常量，我可以从中导入此类型库的任何想法？

```
ProjectItem = interface(IDispatch)
    ['{0B48100A-473E-433C-AB8F-66B9739AB620}']
    .... etc
    function Open(const ViewKind: WideString): Window; safecall;
    .... etc 
```

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-01T00:02:57.000

vsViewKindDesigner = {7651A702-06E5-11D1-8EBD-00A0C90F26EA}（设计器视图）。
来源： http: [//msdn.microsoft.com/en-us/library/aa301250 (VS.71).aspx](http://msdn.microsoft.com/en-us/library/aa301250(VS.71).aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-31T23:57:27.497

您是否在 Visual Studio SDK 中查找过该常量？微软？谷歌？

请参阅[http://social.msdn.microsoft.com/Search/en-US/?Query=vsViewKindDesigner](http://social.msdn.microsoft.com/Search/en-US/?Query=vsViewKindDesigner)。

# web-services - 在 .net Web 服务中保存 COM 引用

> ID：703234
> 
> 赞同：1
> 
> 时间：2009-03-31T21:54:43.127
> 
> 标签：web-services, com, asp.net-2.0

我试图为一个有状态的 COM 组件创建一个 web 服务接口。

Web 服务基本上包含操作 Start、Shutdown 和 GetCurrentState。

Start 创建一个 COM 组件，Stop 发布。GetCurrentState 从 COM 组件中检索信息。

这似乎是一件容易的事情，但一天之后它仍然拒绝工作。

我尝试将 COM 引用作为成员变量存储在 C# 对象中。对象不断被重新创建。然后我尝试将 COM 引用存储在 Session 对象中。但是，还是有些不对劲。

任何人都知道**应该**如何存储应该在 web 服务中保持活跃的 COM 引用？
/L

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-31T22:15:53.653

假设您在这里使用的是 ASMX，而不是 WCF，您可以稍微不同地控制生命周期，每次请求进入为请求提供服务的类时，都会重新创建。这是 ASMX 的标准行为。

您需要做的是将 COM 对象存储在 Cache[] 或 Application[] 集合中。当工作池被回收时，它仍然可能被破坏。像这样的一些代码是你需要的：

```
public FooClass GetFooClassInstance()
{
    FooClass instance = (FooClass)this.Context.Application["FooClassInstance"];

    if (instance == null)
    {
        instance = new FooClass(); // Creates the RCW.
        this.Context.Application["FooClassInstance"] = instance;
    }

    return instance;
} 
```

FooClass 是您的 COM 对象的运行时可调用包装器。Application 对象的内容在请求之间保留。您需要注意的一件事是 COM 组件正在使用的线程模型，因为有些可能会导致性能问题，因为它们将调用编组到单个线程上。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-31T22:09:14.217

Web 服务本质上是无状态的。尝试创建 Windows 服务并使用 Web 服务对其进行控制。Start 方法将启动 Windows 服务，该服务将实例化 COM 组件。GetCurrentState 方法将与服务通信并获取 COM 引用。

另一种方法是让您的 COM 组件 COM+ 可访问：

1.  打开管理工具 -> 组件服务。
2.  打开 COM+ 应用程序节点。
3.  创建新应用程序。在向导的第一个步骤中选择“创建一个空的应用程序”。键入应用程序名称并在下一步中选择“服务器应用程序”选项。
4.  创建新组件。在向导中选择“安装新组件”。找到并选择您的 COM dll。
5.  转到组件属性并启用对象池。将最小和最大池大小设置为 1。这将使您的组件成为单例。

# jsp - JSP 标记文件：检查嵌套

> ID：703254
> 
> 赞同：2
> 
> 时间：2009-03-31T22:00:58.200
> 
> 标签：jsp, jsp-tags

我正在使用 JSP 编写一些嵌套的自定义标签。我知道有两种方法可以做到这一点：1）编写扩展 BodyTagSupport 的标签处理程序，2）编写标签文件。

在第一种方法中，代码很丑陋。而且我找不到合并当前struts标签的方法。如果我使用JspWriter编写以下内容，我会在最终的HTML输出中得到这个字符串，而不是编译的JSP生成的有意义的输出。

```
 <bean:write name="label"> 
```

所以，我转向第二种方法，我写了标签文件。那么上面的问题就解决了。但是，我在获取标签的父标签时遇到问题，因为我不知道父标签类。如果我编写自己的标签处理程序，我可以执行以下操作，

```
 ParentTag parent = 
        (ParentTag)findAncestorWithClass(this, ParentTag.class);
      if (parent == null) {
        throw new JspTagException("this tag is outside of its parent tag");
      } 
```

但是因为我使用了标签文件，所以我不太清楚它的父类是什么类。

我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-15T16:52:55.443

好吧，标签文件本身并不是像标签处理程序那样的“类”（我的意思是，显然它是，就像所有 JSP 文件一样，但是，你明白我的意思）。

当我必须对标签文件进行“嵌套”标签时，我所做的就是将我的状态数据以“众所周知的名称”放入请求中。实际上是两个标签之间共享的“秘密”。

例如，在一个标签文件中，我可能会这样做：

```
<%
jspContext.setAttribute("_myWellKnownName", new java.util.LinkedHashMap(), PageContext.REQUEST_SCOPE);
%> 
```

然后，在稍后的标记文件中：

```
<%
    java.util.LinkedHashMap map = (java.util.LinkedHashMap) jspContext.findAttribute("_myWellKnownName");
%> 
```

然后我随心所欲地操纵那个变量。

在父标签中，执行子标签的代码，所以在我的地图（在这种情况下）被填充之后，我可以在那时做任何我需要做的事情。

我发现的基本模式是将子标签的结果收集到一个列表中，然后在孩子完成所有工作后，父母将实际数据呈现到页面上。

我的标签不需要我的父母嵌套在其他父母中（即一个标签将与另一个标签的状态冲突），但显然这在一般意义上可能是这种方法的问题。不过对我的目的仍然有效。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-15T16:37:12.703

我傻到忘记了我可以将上面的Java代码插入到JSP中，并在页面上设置一个参数以将“父”传递给JSP页面......

我不确定，如果我应该关闭这个问题。因为答案有些愚蠢。请资深 StackOverflow 用户指教。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-03-31T19:39:46.523

也许[这](http://numberformat.wordpress.com/2010/01/28/using-tag-files-with-jsp-2-1-servlet-2-5/)会有所帮助。

> Michael Breed 2010 年 11 月 9 日凌晨 1:23
> 
> 我知道这已经快一年了，但是当我碰巧自己正在研究使用标签文件时，我想我会纠正这里所说的限制。事实上，使用 JSP 术语“片段”并使用 jsp:invoke 标记注入多个部分是可能的。就是这样：

# python - 在 Python 中加载格式化二进制文件的最有效方法

> ID：703262
> 
> 赞同：6
> 
> 时间：2009-03-31T22:03:36.647
> 
> 标签：python, input, binaryfiles

我有大小不超过 20Mb 的二进制文件，其中有一个标题部分，然后是一个包含 uchars 序列的数据部分。我有 Numpy、SciPy 等，每个库都有不同的数据加载方式。对于我应该使用的最有效方法有什么建议吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-31T22:05:12.637

如果性能很关键，请使用[struct](http://docs.python.org/library/struct.html)模块，或者可能使用 C 编写的自定义模块。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-01T03:32:45.983

[struct](http://docs.python.org/library/struct.html)应该适用于 header 部分，而 numpy 的[memmap](http://docs.scipy.org/doc/numpy/reference/generated/numpy.memmap.html#numpy.memmap)对 data 部分将是有效的，如果你要在 numpy 中操作它。这里没有必要强调不一致。两种方法都兼容，只需为每项工作使用正确的工具。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-01T06:12:57.610

[bdec](http://www.hl.id.au/projects/bdec/)似乎很有希望。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-01T00:27:11.920

我发现这`array.fromfile`是同类数据最快的方法。

# ruby-on-rails - 为什么 Rake 运行一个我找不到测试的模型？

> ID：703263
> 
> 赞同：1
> 
> 时间：2009-03-31T22:03:43.560
> 
> 标签：ruby-on-rails, unit-testing, rake

当我运行“rake”时，它会加载我的 app/models 目录中所有类中的一个模型。问题是，它不是我要测试的模型，它只是我在那里的一个模型，它实际上与脚本/运行器一起使用，在后台运行并为我的主要 Rails 应用程序执行任务。在文件的末尾，我创建了上面类的一个新实例，然后为该类运行 main。

由于它无限循环，我绝对不希望它由测试代码启动。为什么单元测试或 Rake 会以任何方式涉及这个其他类？

令我感到羞耻的是，我还没有为这段代码编写任何测试，我决定开始编写一些测试，但这立即阻止了我，因为我什至无法运行 Rake 以获取现在存在的内容，除非它出现问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-01T08:40:28.087

我不确定这是 Rake 的错 - 我有一种感觉，当你添加`:environment`为依赖项时，你会启动整个 Rails 基础架构，这很可能需要每个模型文件（这是相当疯狂的猜测 - 我没有跟随引导过程深入）。

无论发生什么，似乎都需要您的模型，此时所有的地狱都崩溃了。

查看 script/runner 和更有用的 railties/lb/commands/runner.rb，执行顺序似乎类似于：

```
require 'boot' # boot the Rails app
eval(File.read(code_or_file)) # run what you asked for 
```

第二行（实际上在 runner.rb 中的第 45 行附近）看起来像关键。如果您定义了一个包含运行模型的代码的单独脚本（例如，在 /lib 中？）会怎样？我认为这可能是一种更类似于 Rails 的方式。它可能会阻止 Rake 搞砸你的测试......

# c# - 无法为 SSL/TLS 安全通道建立信任关系 -- SOAP

> ID：703272
> 
> 赞同：364
> 
> 时间：2009-03-31T22:07:28.557
> 
> 标签：c#, .net, ssl, trust

我有一个简单的 Web 服务调用，由 .NET (C#) 2.0 Windows 应用程序通过 Visual Studio 生成的 Web 服务代理生成，用于同样用 C# (2.0) 编写的 Web 服务。这已经工作了好几年，并且在它运行的十几个地方继续这样做。

新站点上的新安装遇到了问题。尝试调用 Web 服务时，它失败并显示以下消息：

> 无法为 SSL/TLS 安全通道建立信任关系

Web 服务的 URL 使用 SSL (https://)——但这在许多其他位置已经工作了很长时间（并且继续这样做）。

我在哪里看？这可能是此安装独有的 Windows 和 .NET 之间的安全问题吗？如果是这样，我在哪里建立信任关系？我迷路了！

* * *

## 回答 #1

> 赞同：392
> 
> 时间：2011-07-07T15:52:52.180

以下代码段将修复您调用的服务器上的 SSL 证书有问题的情况。例如，它可能是自签名的，或者证书和服务器之间的主机名可能不匹配。

**如果您正在调用不受您直接控制的服务器，这是很危险**的，因为您无法再确定您正在与您认为连接到的服务器通话。但是，如果您正在处理内部服务器并且获得“正确”的证书不实用，请使用以下命令告诉 Web 服务忽略证书问题并勇敢地坚持下去。

前两个使用 lambda 表达式，第三个使用常规代码。第一个接受任何证书。最后两个至少检查证书中的主机名是否是您期望的主机名。
...希望你觉得它有帮助

```
//Trust all certificates
System.Net.ServicePointManager.ServerCertificateValidationCallback =
    ((sender, certificate, chain, sslPolicyErrors) => true);

// trust sender
System.Net.ServicePointManager.ServerCertificateValidationCallback
                = ((sender, cert, chain, errors) => cert.Subject.Contains("YourServerName"));

// validate cert by calling a function
ServicePointManager.ServerCertificateValidationCallback += new RemoteCertificateValidationCallback(ValidateRemoteCertificate);

// callback used to validate the certificate in an SSL conversation
private static bool ValidateRemoteCertificate(object sender, X509Certificate cert, X509Chain chain, SslPolicyErrors policyErrors)
{
    bool result = cert.Subject.Contains("YourServerName");
    return result;
} 
```

* * *

## 回答 #2

> 赞同：200
> 
> 时间：2013-03-18T18:00:00.827

非常简单的“包罗万象”解决方案是这样的：

```
System.Net.ServicePointManager.ServerCertificateValidationCallback = delegate { return true; }; 
```

sebastian-castaldi 的解决方案更详细一些。

* * *

## 回答 #3

> 赞同：185
> 
> 时间：2009-03-31T22:11:26.880

想法（基于过去的痛苦）：

*   你有服务器的 DNS 和视线吗？
*   您是否使用证书中的正确名称？
*   证书还有效吗？
*   配置不当的负载均衡器是否搞砸了？
*   新~~服务器~~机器的时钟设置是否正确（即UTC时间正确[忽略本地时间，这在很大程度上无关紧要]）-这对WCF当然很重要，所以可能会影响常规SOAP？
*   是否存在证书信任链问题？如果你从服务器浏览到soap服务，你能得到SSL吗？
*   与上述相关 - 证书是否已安装到正确的位置？（您可能需要受信任的根证书颁发机构的副本）
*   服务器的机器级代理设置是否正确？（与用户的代理不同）；请参阅 XP / 2003 的 proxycfg（不确定 Vista 等）

* * *

## 回答 #4

> 赞同：38
> 
> 时间：2013-02-26T22:59:24.083

我个人最喜欢以下解决方案：

```
using System.Security.Cryptography.X509Certificates;
using System.Net.Security; 
```

...然后在您请求获取错误之前，请执行以下操作

```
System.Net.ServicePointManager.ServerCertificateValidationCallback = delegate(object sender, X509Certificate certificate, X509Chain chain, SslPolicyErrors sslPolicyErrors) { return true; }; 
```

在咨询[卢克的解决方案后发现了这个](http://www.terminally-incoherent.com/blog/2008/05/05/send-a-https-post-request-with-c/)

* * *

## 回答 #5

> 赞同：23
> 
> 时间：2014-10-08T07:58:09.103

如果您不想盲目地信任每个人并只对某些主机进行信任例外，则以下解决方案更合适。

```
public static class Ssl
{
    private static readonly string[] TrustedHosts = new[] {
      "host1.domain.com", 
      "host2.domain.com"
    };

    public static void EnableTrustedHosts()
    {
      ServicePointManager.ServerCertificateValidationCallback = 
      (sender, certificate, chain, errors) =>
      {
        if (errors == SslPolicyErrors.None)
        {
          return true;
        }

        var request = sender as HttpWebRequest;
        if (request != null)
        {
          return TrustedHosts.Contains(request.RequestUri.Host);
        }

        return false;
      };
    }
} 
```

然后在您的应用启动时调用 Ssl.EnableTrustedHosts。

* * *

## 回答 #6

> 赞同：18
> 
> 时间：2011-03-25T00:10:56.250

如果你使用的是 Windows 2003，你可以试试这个：

> 打开 Microsoft 管理控制台（开始 --> 运行 --> mmc.exe）；
> 
> 选择文件 --> 添加/删除管理单元；
> 
> 在独立选项卡中，选择添加；
> 
> 选择证书管理单元，然后单击添加；
> 
> 在向导中，选择计算机帐户，然后选择本地计算机。按完成结束向导；
> 
> 关闭添加/删除管理单元对话框；
> 
> 导航到证书（本地计算机）并选择要导入的存储：
> 
> 如果您拥有颁发证书的公司的 Root CA 证书，请选择 Trusted Root Certification Authorities；
> 
> 如果您有服务器本身的证书，请选择其他人
> 
> 右键单击商店并选择所有任务 --> 导入
> 
> 按照向导并提供您拥有的证书文件；
> 
> 之后，只需重新启动 IIS 并尝试再次调用 Web 服务。

参考：[http](http://www.outsystems.com/NetworkForums/ViewTopic.aspx?Topic=Web-Services:-Could-not-establish-trust-relationship-for-the-SSL/TLS-) ://www.outsystems.com/NetworkForums/ViewTopic.aspx?Topic=Web-Services:-Could-not-establish-trust-relationship-for-the-SSL/TLS- ...

* * *

## 回答 #7

> 赞同：7
> 
> 时间：2009-03-31T22:36:53.010

Microsoft 的[SSL 诊断工具](http://www.iis.net/downloads/community/2009/09/ssl-diagnostics-tool-for-iis-7)可能能够帮助识别问题。

**更新**链接现已修复。

* * *

## 回答 #8

> 赞同：7
> 
> 时间：2012-10-25T19:36:27.027

卢克写了一篇关于这个的很好的文章..非常直接..试试这个

[卢克的解决方案](http://www.terminally-incoherent.com/blog/2008/05/05/send-a-https-post-request-with-c/#comment-25000)

原因（引用他的文章（减去诅咒））“.. 上面代码的问题是，如果您的证书无效，它就不起作用。为什么我要发布到带有无效 SSL 证书的网页？因为我很便宜，我不想向 Verisign 或其他****-** *s 支付我的测试箱的证书，所以我自己签署了它。当我发送请求时，我收到了一个可爱的异常：

**System.Net.WebException** *基础连接已关闭。无法与远程服务器建立信任关系。*

我不了解你，但对我来说，这个异常看起来像是由我的代码中的一个愚蠢错误引起的，导致 POST 失败。所以我一直在寻找、调整和做各种奇怪的事情。只有在我搜索了 ***n 之后，我才发现遇到无效 SSL 证书后的默认行为是抛出这个异常。..”

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2013-02-22T16:09:16.513

我刚遇到这个问题。我的解决方案是通过手动同步到时间服务器来更新系统时间。为此，您可以：

*   右键单击任务栏中的时钟
*   选择`Adjust Date/Time`
*   选择`Internet Time`选项卡
*   点击`Change Settings`
*   选择`Update Now`

在我的情况下，这是不正确的同步，所以我必须点击它几次才能正确更新。如果它继续不正确地更新，您甚至可以尝试使用服务器下拉菜单中的不同时间服务器。

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2015-05-25T14:07:40.047

`.NET`我在 Internet Explorer的应用程序中遇到了类似的问题。

我解决了将证书（在我的情况下为 VeriSign Class 3 证书）添加到受信任的编辑器证书的问题。

```
Go to Internet Options-> Content -> Publishers and import it 
```

如果您从以下位置导出证书，您可以获得证书：

```
Internet Options-> Content -> Certificates -> Intermediate Certification Authorities -> VeriSign Class 3 Public Primary Certification Authority - G5 
```

谢谢

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2018-05-15T12:23:57.917

试试这个：

```
System.Net.ServicePointManager.SecurityProtocol = System.Net.SecurityProtocolType.Tls12; 
```

请注意，您必须至少使用 4.5 .NET 框架

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2020-06-23T12:17:17.590

添加这个：

```
 ServicePointManager.ServerCertificateValidationCallback += (sender, cert, chain, sslPolicyErrors) => true;} 
```

就在您调用服务的那一行之前

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2014-01-22T13:28:26.940

我在使用以下网址的网络服务器上运行此错误：

```
a.b.domain.com 
```

但是没有证书，所以我得到了一个名为的 DNS

```
a_b.domain.com 
```

只是在此处提示此解决方案，因为这在谷歌中名列前茅。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2017-06-12T20:28:05.013

对于那些通过 VS 客户端遇到此问题的人，一旦成功添加了服务引用并尝试执行第一个调用，就会出现以下异常：“底层连接已关闭：无法为 SSL/TLS 安全通道建立信任关系”如果您正在使用（如我的情况）带有 IP 地址的端点 URL 并遇到此异常，那么您可能需要执行以下步骤重新添加服务引用：

*   在 Internet Explorer 上打开端点 URL。
*   单击证书错误（地址栏中的红色图标）
*   单击查看证书。
*   获取发布到：“名称”并替换 IP 地址或我们使用的任何名称，并获取此“名称”的错误。

再试一次 ：）。谢谢

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2014-02-17T17:55:24.130

就我而言，我试图在我的 Visual Studio 环境中使用 IIS 7测试**SSL 。**

这就是我最终为了让它工作而做的事情：

*   在 IIS 右侧“绑定...”部分的我的站点下，我必须将“https”绑定添加到端口 443 并选择“IIS Express 开发证书”。

*   在右侧“高级设置...”部分的我的站点下，我必须将“启用的协议”从“http”更改为“https”。

*   在“SSL 设置”图标下，我为客户端证书选择了“接受”。

*   然后我不得不回收应用程序池。

*   我还必须使用 mmc.exe 将本地主机证书导入我的个人存储中。

我的`web.config`文件已经正确配置，所以在我整理完以上所有内容后，我就可以继续我的测试了。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2019-07-15T02:05:24.867

我的解决方案（VB.Net，此应用程序的“暂存”（UAT）版本需要使用“暂存”证书，但一旦它们在实时站点上就不会影响请求）：

```
 ...
        Dim url As String = ConfigurationManager.AppSettings("APIURL") & "token"
        If url.ToLower().Contains("staging") Then
           System.Net.ServicePointManager.ServerCertificateValidationCallback = AddressOf AcceptAllCertifications
        End If
    ...

    Private  Function AcceptAllCertifications(ByVal sender As Object, ByVal certification As System.Security.Cryptography.X509Certificates.X509Certificate, ByVal chain As System.Security.Cryptography.X509Certificates.X509Chain, ByVal sslPolicyErrors As System.Net.Security.SslPolicyErrors) As Boolean
        Return True
    End Function 
```

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2020-10-20T07:25:48.033

如果对任何人有帮助，我已经使用了一段时间。

调用者必须明确请求需要不受信任的认证，并在完成后将回调放回其默认状态。

```
 /// <summary>
    /// Helper method for returning the content of an external webpage
    /// </summary>
    /// <param name="url">URL to get</param>
    /// <param name="allowUntrustedCertificates">Flags whether to trust untrusted or self-signed certificates</param>
    /// <returns>HTML of the webpage</returns>
    public static string HttpGet(string url, bool allowUntrustedCertificates = false) {
        var oldCallback = ServicePointManager.ServerCertificateValidationCallback;
        string webPage = "";
        try {
            WebRequest req = WebRequest.Create(url);

            if (allowUntrustedCertificates) {
                // so we can query self-signed certificates
                ServicePointManager.ServerCertificateValidationCallback = 
                    ((sender, certification, chain, sslPolicyErrors) => true);
            }

            WebResponse resp = req.GetResponse();

            using (StreamReader sr = new StreamReader(resp.GetResponseStream())) {
                webPage = sr.ReadToEnd().Trim();
                sr.Close();
            }
            return webPage;
        }
        catch {
            // if the remote site fails to response (or we have no connection)
            return null;
        }
        finally {
            ServicePointManager.ServerCertificateValidationCallback = oldCallback;
        }
    } 
```

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2022-02-19T10:41:54.713

实际上，此问题来自 SSL/TLS 证书问题，因此您可以使用以下代码找到问题：

这是最好的解决方案 [https://indiabix.info/id/16/the-underlying-conne](https://indiabix.info/id/16/the-underlying-conne)

* * *

## 回答 #19

> 赞同：-2
> 
> 时间：2017-01-10T11:17:07.717

**如果不工作坏证书，当ServerCertificateValidationCallback 返回true；** 我的 ServerCertificateValidationCallback 代码：

```
ServicePointManager.ServerCertificateValidationCallback += delegate
{
    LogWriter.LogInfo("Проверка сертификата отключена, на уровне ServerCertificateValidationCallback");
    return true;
}; 
```

我阻止执行 ServerCertificateValidationCallback 的代码：

```
 if (!(ServicePointManager.CertificatePolicy is CertificateValidation))
    {
        CertificateValidation certValidate = new CertificateValidation();
        certValidate.ValidatingError += new CertificateValidation.ValidateCertificateEventHandler(this.OnValidateCertificateError);
        ServicePointManager.CertificatePolicy = certValidate;
    } 
```

OnValidateCertificateError 函数：

```
private void OnValidateCertificateError(object sender, CertificateValidationEventArgs e)
{
    string msg = string.Format(Strings.OnValidateCertificateError, e.Request.RequestUri, e.Certificate.GetName(), e.Problem, new Win32Exception(e.Problem).Message);
    LogWriter.LogError(msg);
    //Message.ShowError(msg);
} 
```

我禁用了 CertificateValidation 代码，并且 ServerCertificateValidationCallback 运行得很好

# internet-explorer-6 - IE6 png 错误；链接不起作用？

> ID：703277
> 
> 赞同：4
> 
> 时间：2009-03-31T22:08:58.070
> 
> 标签：internet-explorer-6

几个小时后，我弄清楚为什么我在 IE6 中的 png 中的链接不起作用。
这是因为我在我的 CSS 中使用了 filter:progid:dximagetransform.microsoft.alphaimageloader。然而，经过更多小时后，我还没有找到修复这些链接的解决方案。

这是我的代码...

HTML

```
<div id="fullwidth-header-wrapper">
  <div id="header"> <strong class="logo"> <a href="#">Google</a> </strong>
    <div id="nav">
      <ul> 
<span>
<span style="color: white;">Prefer</span>
Google? Click
<a href="http://google.com">here!</a>
</span>

       </ul>
    </div>
  </div>
</div> 
```

CSS

```
#fullwidth-header-wrapper {
    height: 120px;
    }

#header {
      background:url(../images/header-bg.png) no-repeat 50% 0;
    height: 138px;
    width: 980px;
    margin: 0 auto;
    position: relative;
    top:0;
}

.logo{
    background:url(../images/logo.png) no-repeat;
    display:block;
    width:500px;
    height:125px;
    position:absolute;
    top:40px;
    left:85px;
}
.logo a{
    display:block;
    width:323px;
    height:85px;
    text-indent:-9999px;
    overflow:hidden;
}

#nav {
background:url(none.gif);
filter:progid:dximagetransform.microsoft.alphaimageloader(src='images/nav.png',  sizingmethod='crop');
display: inline;
position: absolute; 
top: -8px;
right: 30px;
width: 350px;
    height: 75px;
z-index: 150;
} 

#nav ul {
    position: relative;
    top: 18px;
    left: 0px;
    color: rgb(87, 175, 237);
    font-size: 96.8%;
    z-index:200;
}

#nav span {
           color: #fff;
           position: absolute; 
           top: 18px; 
           left: 0px;  
           font-size: 96.8%;
}

#nav a {color: rgb(255, 255, 255);} 
```

您如何解决此问题或避免此问题和建议：上述问题的可能解决方案？

谢谢！

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-03-31T23:05:50.803

试试这个：[http ://www.hrunting.org/csstests/iealpha.html](http://www.hrunting.org/csstests/iealpha.html)

简而言之：

> 重要的是带有过滤器的元素*没有位置集*，并且被过滤元素内的链接*有一个位置集*。如果是这种情况，过滤元素中的链接将起作用。

由于您的`#nav`元素具有`position: absolute`，因此您需要在其周围添加一个包装器 div 并绝对定位它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-07-28T14:00:52.453

这通常是在包含链接的东西上使用 png 修复的问题，twinhelix png 修复的 Alpha 版本显然已经解决了这个问题。我已经使用过它，它仍然有点问题，或者至少是几个月前，但是在小型站点上使用它已经准备好生产了[http://www.twinhelix.com/css/iepngfix/](http://www.twinhelix.com/css/iepngfix/)。

我通常对我们所有的网站都使用 twinhelix 1.0 脚本，我包含一个带有针对 IE6 的条件注释的 ie6.css 样式表：

```
<!--[if lt IE 7]>
  <link rel="stylesheet" href="/css/ie6.css" type="text/css" charset="utf-8">
<![endif]-->
```

在里面你然后在CSS中你只需使用' `behavior`'规则调用它。IE 7 和 8 做透明 png 就好了。您确实需要确保在某处有一个 blank.gif 1px x 1px 透明 gif 并更新 htc 文件（实际上只是 JS）以链接到该图像的路径。

```
 #nav  {
    behavior: url(/css/iepngfix.htc);
}
```

我希望这有帮助

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-07-23T21:06:17.143

我有一个类似的问题，我使用的是透明背景，所以我必须应用 png 修复。我有一个 div 和一个围绕它的链接，如下所示：

```
<a href="#"><div id="bla"></div></a> 
```

这些链接在 IE6 中根本不起作用。当我应用 position: 相对于那个 bla div 时，它起作用了！position: relative 似乎在 IE6 上创造了奇迹，以及 float: left 有时......

# c# - 获取相对于当前工作目录的路径？

> ID：703281
> 
> 赞同：79
> 
> 时间：2009-03-31T22:09:54.683
> 
> 标签：c#, file-io

我正在编写一个控制台实用程序来对命令行上指定的文件进行一些处理，但是我遇到了一个无法通过 Google/Stack Overflow 解决的问题。如果指定了完整路径（包括驱动器号），如何重新格式化该路径以相对于当前工作目录？

一定有类似于 VirtualPathUtility.MakeRelative 函数的东西，但如果有的话，我会不知道。

* * *

## 回答 #1

> 赞同：135
> 
> 时间：2009-03-31T22:15:10.053

如果您不介意切换斜线，您可以 [ab] 使用`Uri`：

```
Uri file = new Uri(@"c:\foo\bar\blop\blap.txt");
// Must end in a slash to indicate folder
Uri folder = new Uri(@"c:\foo\bar\");
string relativePath = 
Uri.UnescapeDataString(
    folder.MakeRelativeUri(file)
        .ToString()
        .Replace('/', Path.DirectorySeparatorChar)
    ); 
```

## 作为函数/方法：

```
string GetRelativePath(string filespec, string folder)
{
    Uri pathUri = new Uri(filespec);
    // Folders must end in a slash
    if (!folder.EndsWith(Path.DirectorySeparatorChar.ToString()))
    {
        folder += Path.DirectorySeparatorChar;
    }
    Uri folderUri = new Uri(folder);
    return Uri.UnescapeDataString(folderUri.MakeRelativeUri(pathUri).ToString().Replace('/', Path.DirectorySeparatorChar));
} 
```

* * *

## 回答 #2

> 赞同：41
> 
> 时间：2009-03-31T22:14:04.843

您可以使用`Environment.CurrentDirectory`获取当前目录，以及`FileSystemInfo.FullPath`获取任何位置的完整路径。因此，完全限定当前目录和相关文件，然后检查完​​整文件名是否以目录名开头 - 如果是，则根据目录名的长度取适当的子字符串。

这是一些示例代码：

```
using System;
using System.IO;

class Program
{
    public static void Main(string[] args)
    {
        string currentDir = Environment.CurrentDirectory;
        DirectoryInfo directory = new DirectoryInfo(currentDir);
        FileInfo file = new FileInfo(args[0]);

        string fullDirectory = directory.FullName;
        string fullFile = file.FullName;

        if (!fullFile.StartsWith(fullDirectory))
        {
            Console.WriteLine("Unable to make relative path");
        }
        else
        {
            // The +1 is to avoid the directory separator
            Console.WriteLine("Relative path: {0}",
                              fullFile.Substring(fullDirectory.Length+1));
        }
    }
} 
```

我并不是说它是世界上最强大的东西（符号链接可能会混淆它），但如果这只是你偶尔使用的工具，它可能没问题。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2013-10-18T15:37:18.690

```
public string MakeRelativePath(string workingDirectory, string fullPath)
{
    string result = string.Empty;
    int offset;

    // this is the easy case.  The file is inside of the working directory.
    if( fullPath.StartsWith(workingDirectory) )
    {
        return fullPath.Substring(workingDirectory.Length + 1);
    }

    // the hard case has to back out of the working directory
    string[] baseDirs = workingDirectory.Split(new char[] { ':', '\\', '/' });
    string[] fileDirs = fullPath.Split(new char[] { ':', '\\', '/' });

    // if we failed to split (empty strings?) or the drive letter does not match
    if( baseDirs.Length <= 0 || fileDirs.Length <= 0 || baseDirs[0] != fileDirs[0] )
    {
        // can't create a relative path between separate harddrives/partitions.
        return fullPath;
    }

    // skip all leading directories that match
    for (offset = 1; offset < baseDirs.Length; offset++)
    {
        if (baseDirs[offset] != fileDirs[offset])
            break;
    }

    // back out of the working directory
    for (int i = 0; i < (baseDirs.Length - offset); i++)
    {
        result += "..\\";
    }

    // step into the file path
    for (int i = offset; i < fileDirs.Length-1; i++)
    {
        result += fileDirs[i] + "\\";
    }

    // append the file
    result += fileDirs[fileDirs.Length - 1];

    return result;
} 
```

这段代码可能不是防弹的，但这就是我想出的。它更健壮一些。它采用两条路径并返回相对于路径 A 的路径 B。

例子：

```
MakeRelativePath("c:\\dev\\foo\\bar", "c:\\dev\\junk\\readme.txt")
//returns: "..\\..\\junk\\readme.txt"

MakeRelativePath("c:\\dev\\foo\\bar", "c:\\dev\\foo\\bar\\docs\\readme.txt")
//returns: "docs\\readme.txt" 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2014-05-16T14:01:02.620

感谢这里的其他答案，经过一些实验，我创建了一些非常有用的扩展方法：

```
public static string GetRelativePathFrom(this FileSystemInfo to, FileSystemInfo from)
{
    return from.GetRelativePathTo(to);
}

public static string GetRelativePathTo(this FileSystemInfo from, FileSystemInfo to)
{
    Func<FileSystemInfo, string> getPath = fsi =>
    {
        var d = fsi as DirectoryInfo;
        return d == null ? fsi.FullName : d.FullName.TrimEnd('\\') + "\\";
    };

    var fromPath = getPath(from);
    var toPath = getPath(to);

    var fromUri = new Uri(fromPath);
    var toUri = new Uri(toPath);

    var relativeUri = fromUri.MakeRelativeUri(toUri);
    var relativePath = Uri.UnescapeDataString(relativeUri.ToString());

    return relativePath.Replace('/', Path.DirectorySeparatorChar);
} 
```

要点：

*   使用`FileInfo`and`DirectoryInfo`作为方法参数，因此对于正在处理的内容没有歧义。`Uri.MakeRelativeUri`期望目录以斜杠结尾。
*   `DirectoryInfo.FullName`不规范化尾部斜杠。它输出构造函数中使用的任何路径。这种扩展方法会为您解决这个问题。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-05-23T15:20:32.433

还有[一种方法可以做到这一点，但有一些限制](http://www.iandevlin.com/blog/2010/01/csharp/generating-a-relative-path-in-csharp/)。这是文章中的代码：

```
public string RelativePath(string absPath, string relTo)
    {
        string[] absDirs = absPath.Split('\\');
        string[] relDirs = relTo.Split('\\');
        // Get the shortest of the two paths 
        int len = absDirs.Length < relDirs.Length ? absDirs.Length : relDirs.Length;
        // Use to determine where in the loop we exited 
        int lastCommonRoot = -1; int index;
        // Find common root 
        for (index = 0; index < len; index++)
        {
            if (absDirs[index] == relDirs[index])
                lastCommonRoot = index;
            else break;
        }
        // If we didn't find a common prefix then throw 
        if (lastCommonRoot == -1)
        {
            throw new ArgumentException("Paths do not have a common base");
        }
        // Build up the relative path 
        StringBuilder relativePath = new StringBuilder();
        // Add on the .. 
        for (index = lastCommonRoot + 1; index < absDirs.Length; index++)
        {
            if (absDirs[index].Length > 0) relativePath.Append("..\\");
        }
        // Add on the folders 
        for (index = lastCommonRoot + 1; index < relDirs.Length - 1; index++)
        {
            relativePath.Append(relDirs[index] + "\\");
        }
        relativePath.Append(relDirs[relDirs.Length - 1]);
        return relativePath.ToString();
    } 
```

执行这段代码时：

```
string path1 = @"C:\Inetpub\wwwroot\Project1\Master\Dev\SubDir1"; 
string path2 = @"C:\Inetpub\wwwroot\Project1\Master\Dev\SubDir2\SubDirIWant";

System.Console.WriteLine (RelativePath(path1, path2));
System.Console.WriteLine (RelativePath(path2, path1)); 
```

它打印出来：

```
..\SubDir2\SubDirIWant
..\..\SubDir1 
```

# wcf - 我可以放心使用 WCF Starter Kit HttpClient 吗？

> ID：703282
> 
> 赞同：4
> 
> 时间：2009-03-31T22:10:57.567
> 
> 标签：wcf, httpclient, rest

我想开始使用 WCF Rest Starter Kit 的 HttpClient 为我的 Restful WCF 服务构建客户端，我想知道......

1.  如果有人目前遇到任何问题

2.  我能否确信组件的未来版本（只是 HttpClient，不担心套件的其余部分）不会包含对 API 的重大更改？

这似乎是一个非常简单的组件，所以我无法想象它有任何重大变化，但也许这里有更多“了解”的人可以给我一个提示。

提前致谢。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-02T09:06:33.800

我在 WCF 团队工作，我编写了大部分 HttpClient 代码。

1.  无重大已知问题。公共问题跟踪器位于[http://aspnet.codeplex.com/WorkItem/List.aspx](http://aspnet.codeplex.com/WorkItem/List.aspx)（搜索 HttpClient 或 WCF REST）。

2.  Microsoft 保留更改它的权利。话虽如此，我认为已发布的 API 不会有重大变化。（也许是一些小的重命名。）我们主要考虑添加特性/功能，这不应该破坏您现有的代码。

告诉我们您的使用情况的一个好方法是通过论坛： http: [//go.microsoft.com/](http://go.microsoft.com/?linkid=9632199) ?linkid=9632199 。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-31T23:55:33.523

在它发布之前，微软肯定会保留对其进行更改的权利。

另一方面，如果您确保他们知道您正在使用它，那么您就不太可能因为任何更改而感到*不便*。

# c# - 静态实例，从未调用析构函数

> ID：703286
> 
> 赞同：2
> 
> 时间：2009-03-31T22:11:29.717
> 
> 标签：c#, static, instance, destructor

请看下面的代码。析构函数永远不会被调用。任何人都知道为什么以及如何纠正这种情况？

```
public partial class Form1 : Form
{
    private Goo goo;

    public Form1()
    {
        InitializeComponent();

        goo = Goo.GetInstance();         
    }
}

public class Goo
{
    private foo f = new foo();
    private static Goo goo;
    private Goo()
    {}

    public static Goo GetInstance()
    {
        if(goo!=null)
        {
            goo = new Goo();
        }
        return goo;
    }

    ~Goo()
    {

    }
}

class foo
{
    ~foo()
    {

    }
} 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-31T22:17:50.857

静态字段引用的对象不会简单地最终确定，除非您清除（设置为`null`）该字段 - 即使这样它也是不确定的并且不能保证。静态字段算作根对象。

您希望何时（以及为什么）收集/完成此内容？它仍然可以访问...

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-31T22:17:51.433

静态字段引用的对象始终是可访问的（假设没有类卸载或任何其他 GC 时髦）并且永远不会被收集。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-31T22:28:21.363

即使您可能希望在进程关闭时运行静态对象的终结器，但也不能保证：

*   [http://blogs.msdn.com/cbrumme/archive/2004/02/20/77460.aspx](http://blogs.msdn.com/cbrumme/archive/2004/02/20/77460.aspx)（查看标题为“V1 & V1.1 最终确定保证”的部分）。我不确定 .NET 2.0 或更高版本中有多少变化。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-31T22:23:10.407

那不是析构函数。这是一个终结者。那是另一回事。正如其他两个所说，因为这是一个静态的，它永远不会被收集，因此终结器永远不会运行。

# eclipse - 我的子剪辑颜色不起作用

> ID：703288
> 
> 赞同：0
> 
> 时间：2009-03-31T22:13:33.737
> 
> 标签：eclipse, svn

对于某些 subclipse 大师来说，这可能是一个简单的问题。我的装饰颜色在 Eclipse 中不起作用。我猜我拥有的一些插件会以某种方式干扰它。我在当前公开发布的ganymede。转到字体和颜色选项区域可让我更改装饰器文本颜色，但在项目资源管理器中没有任何效果。有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-02T22:28:37.863

你在 Linux 上使用 KDE 吗？如果您使用 gtk-qt-engine 使 GTK 程序（如 Eclipse）看起来更像 KDE 应用程序，则存在一个已知错误。如果此 gtk 主题引擎处于活动状态，则视图中的文本颜色将不起作用。这是 mylyn 用户的常见问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-31T15:24:39.527

这可能不再重要，但装饰器问题归结为使用正确的视图。“项目”视图和“文件”视图看起来非常相似，但装饰器在其中一个中正常工作，而不是另一个。

# iphone - selectRow 动画完成后如何从 UIPickerView 获取回调？

> ID：703293
> 
> 赞同：2
> 
> 时间：2009-03-31T22:15:13.267
> 
> 标签：iphone, uipickerview

我有一个 UIPickerView，我希望在 selectRow 动画完成时收到通知。

我在我的视图控制器中尝试了以下方法，它引用了 UIPickerView 并且它不起作用：

```
-(void)viewDidLoad
{
    ...
    [UIPickerView setAnimationDelegate:self];
    [UIPickerView setAnimationDidStopSelector:@selector(animationFin ished:finished:context];
    ...
}

- (void)animationFinishedNSString *)animationID finishedBOOL)finished contextvoid *)context
{
    if (finished) {

    }

} 
```

然后在我的代码中的某个地方，我启动了动画：

```
[picker selectRow:random() % pickerDataCount inComponent:0 animated:YES]; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-17T09:50:53.333

您需要将方法调用嵌套到 beginAnimations/commitAnimation 块中。

```
- (void) animationFinished:(NSString *)animationID finished:(BOOL)finished context:(void *)context {
    NSLog(@"Here I am");
}

- (void)pickerView:(UIPickerView *)pickerView didSelectRow:(NSInteger)row inComponent:(NSInteger)component
{

    [UIView beginAnimations:@"1" context:nil]; // nil = dummy
    [UIPickerView setAnimationDelegate:self];
    [UIPickerView setAnimationDidStopSelector:@selector(animationFinished:finished:context:)];
    [myPickerView selectRow:0 inComponent:0 animated:YES]; // jump with any swipe in picker always to row=0 as dummy to initiate animation
    [UIView commitAnimations];

    //...whatever comes in addition...
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-09-23T23:02:35.573

当它要求查看您感兴趣的组件和行时，您可以从 viewForRow 向 self 发布通知。

您只需要将行和组件作为属性并在调用 selectRow 之前对其进行设置。而且，在 viewForRow

if ( (component == [self component] && (row == [self row] ) 向 self 发布通知

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-07-26T09:40:23.383

我混合了这里提到的不同答案来解决它。行为将是它会等到滚动完成，然后保存选定的值。

1.  创建两个变量，分别存储滚动状态和应保存状态。在 didSet 中，您将检查是否在选择器滚动时按下了保存按钮。如果是，请在选择器完成滚动后调用 save 。

    ```
    var shouldSave = false
    var pickerViewIsScrolling = false {
        didSet {
            if !pickerViewIsScrolling && shouldSave {
                save()
            }
        }
    } 
    ```

2.  要识别选择器是否正在滚动，请添加选择器`pickerViewIsScrolling = true`的`viewForRow`方法。

    ```
    func pickerView(_ pickerView: UIPickerView, viewForRow row: Int, forComponent component: Int, reusing view: UIView?) -> UIView {
        pickerViewIsScrolling = true
        ...
    } 
    ```

3.  要识别选择器是否已停止滚动，请添加`pickerViewIsScrolling = false`到`didSelectRow`选择器的。

    ```
    func pickerView(_ pickerView: UIPickerView, didSelectRow row: Int, inComponent component: Int) {
         pickerViewIsScrolling = false 
         ...
    } 
    ```

4.  在您的`save()`函数中添加以下内容以检查选择器是否正在滚动（并在停止后保存）或不滚动并直接保存。

    ```
    func save() {
         if(pickerViewIsScrolling){
              shouldSave = true
              return
         }

         // Save the Data...

    } 
    ```

5.  最后`viewDidAppear`将这一行添加到您的函数中以捕获`pickerViewIsScrolling = true`初始生成的视图。

    ```
    override func viewDidAppear(_ animated: Bool) {

         super.viewDidAppear(animated)

         pickerViewIsScrolling = false

         ...

    } 
    ```

这对我来说很好。我还在按下保存时实现了按钮的停用，它正在等待滚动完成。所以用户不会感到困惑，为什么在滚动停止之前什么都没有发生。

# ruby-on-rails - PHP 开发者学习 Ruby 和 Ruby on Rails

> ID：703303
> 
> 赞同：8
> 
> 时间：2009-03-31T22:18:13.930
> 
> 标签：ruby-on-rails, ruby

一段时间以来，我一直对学习 Rails 很感兴趣，并且觉得现在与以往一样好，可以深入学习并真正弄脏我的手。过去一周，我阅读了我能找到的所有关于 Ruby 和 Ruby on Rails 的免费电子书。我刚读完 Ruby Essentials。我也一直在玩[http://tryruby.hobix.com/](http://tryruby.hobix.com/)

我已经在 Windows XP 机器上安装了 Ruby、Rails、MySQL、PHP、phpMyAdmin，我还可以访问 Ubuntu 机器。

我有几年的 PHP 经验和大约一年的使用 CodeIgniter。

我现在真正想要的是一个相当基本的 Rails 应用程序，它比 Hello World 更深入一点，但还不如论坛或博客。

我发现当我可以使用已经编写的代码并进行一些试验和错误更改时，学习某些东西的工作原理要容易得多。

我真正想要的是“哦，我现在完全明白了！” 我第一次开始学习 PHP 的那一刻。

有没有人有一个应用程序或知道一个可能提供那个时刻的应用程序？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-31T23:09:23.323

如果您想要构建的东西已经构建了 Agile Web Development on Rails 附带的示例应用程序，请从[pragprog.com](http://www.pragprog.com)购买 pdf ，最新版本设置为与 Rails 2.2 一起使用，因此将与 2.3 一起使用作为所有基本功能的框架将是相同的。

当您准备好继续前进时，[Rails Guides](http://guides.rubyonrails.org)网站是全新的，对于所有新老开发人员来说都是一个很好的资源。

dwc 是对的，博客是您自己开始的好东西，因此，当您有信心尝试时，即使您不将其投入生产，它也会对您有所帮助。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-31T23:29:40.420

[在BuildingWebApps](http://buildingwebapps.com/site/home)上查看 Rails 上的屏幕投射。我看过几部，它们正是我在学习 Rails 时所寻找的。他们从简单开始并不断添加越来越多的功能。评论员的步伐很快，订阅课程是免费的。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-07-10T10:29:10.153

我会推荐[railsforphp.com](http://railsforphp.com/)。他们有一个[PHP 到 Ruby 的参考](http://railsforphp.com/reference)，这可能很有帮助。

您还可以购买纸质版或数字版[的“Rails for PHP Developers”一书（如果您](http://pragprog.com/titles/ndphpr/rails-for-php-developers)*真的*想购买，也可以同时购买）。这本书充满了示例，展示了 PHP 方式以及它与 Ruby/Rails 方式的比较。

至于现成的代码，我建议玩一下[Enki](http://github.com/xaviershay/enki/tree/master)。这是一个有点简单的博客系统，应该给你一个很好的测试平台。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-31T22:55:35.667

您应该重新考虑您认为博客太复杂的想法。最简单的博客是一个文本区域和一个提交按钮，然后存储和反刍结果。从那开始弄脏你的手，然后在你去的时候添加功能。事实上，为什么不练习一些敏捷并进行自己的迭代呢？

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-07-10T10:36:53.150

Rails 指南很好[http://guides.rubyonrails.org/](http://guides.rubyonrails.org/)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-31T23:12:15.173

如果你不喜欢博客的想法，你可以做一个wiki，这也不是很复杂。您只需要在每个页面上都有一个编辑按钮，其中包含链接到它的文本。这将教你如何处理 Rails 并使用 ruby​​ 处理正则表达式等。

花点时间，分解这些问题，你应该很容易用 Rails 解决它们。

然后继续使用 IRC（服务器 freenode 频道#rubyonrails），您可以使用 MIRC。在那里提问，我通常在那里，（寻找 nims）。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-01T04:05:44.437

我的建议是从一个简单的 CMS 开始。随着您的技能进步和您开始其他更复杂的项目，您可以继续使用和扩展它。在最基本的形式中，它由一个 Page 模型和一个 Topic 模型组成。然后，您可以添加一个用户模型、一些登录功能和一个简单的管理界面。毕竟，Rails 最初的设想是让 CMS 类型的网站变得容易。

当您启动并运行它时，您可以添加一些插件来扩展功能以包括标记、评论等。或者您可以自己滚动这些功能。

在 Github 上设置一个帐户并学习如何使用 Git。它很棒，而且比你以前使用的更好（如果有的话）。你还应该学习 rake 和 capistrano，因为它们可以节省大量时间，并且可以与 Rails 和 Github 一起使用。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-04-01T14:25:36.087

[http://blog.caboo.se/articles/2007/4/11/sample-rails-application](http://blog.caboo.se/articles/2007/4/11/sample-rails-application)

[http://www.railsinside.com/elsewhere/100-7-barebones-rails-apps-to-kick-start-your-development-process.html](http://www.railsinside.com/elsewhere/100-7-barebones-rails-apps-to-kick-start-your-development-process.html)

# active-directory - LD iisadmpwd - 更改过期密码

> ID：703308
> 
> 赞同：0
> 
> 时间：2009-03-31T22:20:26.997
> 
> 标签：active-directory, passwords

我需要能够允许用户使用 IIS 中的 \iisadmpwd 实用程序更改其过期密码

看起来好像您的密码已过期，您无法在 AD 中进行身份验证，因此无法更改您的密码。

我有哪些选择？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-01T01:03:24.877

有一个修复程序似乎可以解决此问题。

[http://support.microsoft.com/kb/833734](http://support.microsoft.com/kb/833734)

# c - 在 C/Linux 中显示图像的最简单方法是什么？

> ID：703316
> 
> 赞同：3
> 
> 时间：2009-03-31T22:22:49.863
> 
> 标签：c, linux, image, graphics

我很喜欢用 C 来进行数值计算，但不适合图形编程。我在 linux（gcc，ubuntu）的命令行程序中有一个 Nx x Ny x 3 RGB 矩阵，我想弹出一个窗口，将其作为图像。最简单的方法是什么？它必须相对较快，因为我会经常更新图像。

谢谢

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-31T23:01:42.593

以下是如何使用 C 使用 Gtk2 显示和图像。您可以在[Gtk2](http://www.gtk.org/documentation.html)站点上找到更多信息（包括[教程](http://library.gnome.org/devel/gtk-tutorial/stable/)） 。

```
#include <gtk/gtk.h>

void destroy(void) {
  gtk_main_quit();
}

int main (int argc, char** argv) {
  GtkWidget* window;
  GtkWidget* image;

  gtk_init (&argc, &argv);

  window = gtk_window_new(GTK_WINDOW_TOPLEVEL);
  image  = gtk_image_new_from_file(argv[1]);

  gtk_signal_connect(GTK_OBJECT (window), "destroy",
             GTK_SIGNAL_FUNC (destroy), NULL);

  gtk_container_add(GTK_CONTAINER (window), image);

  gtk_widget_show_all(window);

  gtk_main();

  return 0;
} 
```

以下是如何编译它：

```
gcc -Wall img.c -o img `pkg-config --cflags gtk+-2.0` `pkg-config --libs gtk+-2.0` 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-31T22:42:05.527

您可以尝试使用图像魔法，它似乎具有以最少的工作量将图像显示到 x 窗口的功能。我过去曾使用过图像魔术，并且对此感到满意。我还没有尝试过这个特定的功能。

[显示功能](http://www.imagemagick.org/api/display.php)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-31T22:33:18.357

C 语言本身没有任何内置的图形功能。您可以使用 Qt、gtk、wxWidgets 等图形工具包。您还可以构建一个图像文件（[BMP 非常简单](http://en.wikipedia.org/wiki/BMP_file_format)），然后启动（使用 fork 和 exec）应用程序来查看它。Ubuntu 默认使用 gnome，您可以使用命令行参数 fork “gnome-open”，该参数是您创建的文件的名称，然后 gnome-open 将启动与文件类型关联的任何应用程序。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-31T22:40:22.410

听起来您可能正在做一些科学计算，只需要一种快速的方法来显示结果。

像[gnuplot](http://www.gnuplot.info/)这样的东西可能比学习通用的窗口工具包给你更好的里程。它是一个通用的绘图实用程序，专门用于显示数据集。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-31T22:26:09.073

将图像绘制到像素图，创建 X 窗口（或分配帧缓冲区），然后将像素图写入窗口。

或者，查看 ImageMagick 的`display`命令实现。

如果您不介意学习 GTK+，那么这可能是最直接的方法。创建一个窗口和一个可绘制对象，并使可绘制对象成为窗口的子对象。创建图像的像素图并将其绘制到可绘制对象。Cairo 将简化此操作，因为您只需调整图像格式即可使其正常工作。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-01T12:03:26.630

cairo 图形库也是一个不错的选择，请参阅[http://cairographics.org/](http://cairographics.org/)。它是跨平台的，相当高效，可以让您使用 Gnome/KDE/Windows 或仅相当简单地生成图像文件。它是为矢量设计的，因此也可以很好地处理剪辑、字体和缩放。

# c# - WPF：在构造函数中创建需要参数的应用程序资源 - 如何？

> ID：703323
> 
> 赞同：3
> 
> 时间：2009-03-31T22:23:45.010
> 
> 标签：c#, wpf, resources

我在 App.xaml 文件中创建资源时遇到问题。我的问题是我想在其构造函数中实例化一个需要参数的对象（我的 Linq-to-Sql DataContext，在这种特殊情况下），但我不知道是否可以在 XAML 中传递这样的参数。有谁知道解决这个问题的方法？我想在我的 XAML 中全局访问这个数据上下文，我可以将它作为参数传递给 ObjectDataSource：

```
 <ObjectDataProvider x:Key="PriceCodeProvider" x:Name="priceCodeProvider" ObjectType="{x:Type local:PriceCodeObjectDataProvider}" >
        <ObjectDataProvider.ConstructorParameters>
            <StaticResource ResourceKey="MyDataContext" />
        </ObjectDataProvider.ConstructorParameters>
    </ObjectDataProvider> 
```

从设计的角度来看，我确信有更好的方法来完成我正在寻找的东西，但我对 WPF 很陌生......并且在一些帮助下，我认为这将完成我的特定工作项目。

谢谢！

-查尔斯

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2010-08-31T15:35:39.740

XAML 不允许传递构造函数参数。您需要创建一个包装器类，设置属性，然后您的包装器才能`ObjectDataProvider`正确调用构造函数。

# google-sheets - 电子表格函数可根据另一列的标准对一列中的所有值求和

> ID：703325
> 
> 赞同：7
> 
> 时间：2009-03-31T22:25:01.137
> 
> 标签：google-sheets

`X`我想要一个电子表格函数，该函数将在 A 列等于和等于 时生成 B 列中所有值的总和`Y`。

```
A     B

X    10
Y     3
X     7
X    22
Y     4
Y     9 
```

输出应如下所示（其中`39`和`16`是公式的结果）：

```
X    39           -> 10 + 7 + 22
Y    16           -> 3 + 4 + 9 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-03-31T22:38:02.493

像这样的东西

```
X   10
Y   3
X   7
X   22
Y   4
Y   9

X   "=SUMIF(A1:A6;A8;B1:B6)"
Y   "=SUMIF(A1:A6;A9;B1:B6)" 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-03-31T22:53:35.827

使用`SUMIF(range, criteria, sum_range)`：（B2-B8之间的总和，使用A2-A8中的值作为标准，使用指定的条件）

```
=SUMIF(A2:A8,"=X",B2:B8)
=SUMIF(A2:A8,"=Y",B2:B8) 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-31T22:45:36.627

您可以使用`SUMPRODUCT`来计算总数。对于“X”值：

```
=SUMPRODUCT((A1:A6="X")*(B1:B6)) 
```

对于“Y”值：

```
=SUMPRODUCT((A1:A6="Y")*(B1:B6)) 
```

希望有帮助，

埃里克·梅尔斯基

**编辑：** 显然您必须使用 ARRAYFORMULA 才能在 Google 的电子表格中使用 SUMPRODUCT。参见例如[http://www.google.com/support/forum/p/Google+Docs/thread?tid=13a3eb824446e891&hl=en](http://www.google.com/support/forum/p/Google+Docs/thread?tid=13a3eb824446e891&hl=en)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-31T22:34:50.207

一种快速而肮脏的解决方案是制作两个新列。对于每一行 x，Cx 应该类似于 =Ax=='X'?Bx:0。对 D 列执行相同操作，但检查 Ax=='Y'。然后将 C 和 D 相加。

（不确定这是否与 Google 电子表格语法完全匹配。）

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-09-24T14:51:14.290

关于什么

```
=query(A:B, "select A, sum(B) group by A order by sum(B) desc") 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-31T22:49:12.187

Google Docs 不支持`sumproduct`and`--`运算符，就像 Excel 一样，这一事实有点令人烦恼。您始终可以使用更多列来复制该功能，但正如您在其中一条评论中回复的那样，这似乎是不可能的。

您可以检查表单中是否呈现隐藏列。如果不是，这就是要走的路。

# search - 如何为我的 vimgrep 结果模式着色

> ID：703336
> 
> 赞同：9
> 
> 时间：2009-03-31T22:29:32.157
> 
> 标签：search, vim

使用 Vim 时，有没有一种方法可以`:grep`为`:vimgrep`返回到缓冲区的模式着色？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-01T07:56:46.193

如果你在 :vimgrep'd 之后搜索模式，Vim 会高亮显示它。只需编辑`:vimgrep pattern files`成`:g/pattern/`.

如需更丰富的解决方案，请尝试[此脚本](http://vim.wikia.com/wiki/Highlight_multiple_words)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-31T23:32:25.280

您可以使用 Unix grep：

```
:!grep --color pattern % 
```

可能还有其他使用内部 grep/vimgrep 的解决方案，但这个对我有用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-01T07:22:45.697

也许[ack](http://betterthangrep.com/ "确认")适合你的账单？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-02T13:59:59.213

两种方式：

*   对于普通搜索`/`，您可以使用`:set hls`.
*   或者你可以使用 `:match Search /pattern/`. 这将突出显示匹配的所有内容`pattern`。

# c# - C#：Blowfish 不能使用更少的字母

> ID：703351
> 
> 赞同：0
> 
> 时间：2009-03-31T22:35:52.390
> 
> 标签：c#, blowfish

我正在使用 Blowfish.NET 最新版本，但有一个问题。

```
responce = new byte[6]
{
     0x00, 0x80 ,0x01, 0x61, 0x00, 0x00
};
byte[] encrypted = new byte[responce.Length];
blowfish.Encrypt(responce, 2, encrypted, 2, input.Length - 2); 
```

我用正确的方式称呼它，我希望它从第三个字节开始读/写，长度为 6 - 2，因为我不使用两个字节。

问题：

```
 public int Encrypt(
        byte[] dataIn,
        int posIn,
        byte[] dataOut,
        int posOut,
        int count) 
    {
        uint[] sbox1 = this.sbox1;
        uint[] sbox2 = this.sbox2;
        uint[] sbox3 = this.sbox3;
        uint[] sbox4 = this.sbox4;

        uint[] pbox = this.pbox;

        uint pbox00 = pbox[ 0];
        uint pbox01 = pbox[ 1];
        uint pbox02 = pbox[ 2];
        uint pbox03 = pbox[ 3];
        uint pbox04 = pbox[ 4];
        uint pbox05 = pbox[ 5];
        uint pbox06 = pbox[ 6];
        uint pbox07 = pbox[ 7];
        uint pbox08 = pbox[ 8];
        uint pbox09 = pbox[ 9];
        uint pbox10 = pbox[10];
        uint pbox11 = pbox[11];
        uint pbox12 = pbox[12];
        uint pbox13 = pbox[13];
        uint pbox14 = pbox[14];
        uint pbox15 = pbox[15];
        uint pbox16 = pbox[16];
        uint pbox17 = pbox[17]; // till this line count is 4

        count &= ~(BLOCK_SIZE - 1); //count becomes 0 after that calc :((

        int end = posIn + count; // 2 + 0 = 2

        while (posIn < end) //no loop :[
        {
            uint hi = (((uint)dataIn[posIn + 3]) << 24) |
                      (((uint)dataIn[posIn + 2]) << 16) |
                      (((uint)dataIn[posIn + 1]) <<  8) |
                              dataIn[posIn    ];

            uint lo = (((uint)dataIn[posIn + 7]) << 24) |
                      (((uint)dataIn[posIn + 6]) << 16) |
                      (((uint)dataIn[posIn + 5]) <<  8) |
                              dataIn[posIn + 4];
            posIn += 8; 

            hi ^= pbox00;
            lo ^= (((sbox1[(int)(hi >> 24)] + sbox2[(int)((hi >> 16) & 0x0ff)]) ^ sbox3[(int)((hi >> 8) & 0x0ff)]) + sbox4[(int)(hi & 0x0ff)]) ^ pbox01;
            hi ^= (((sbox1[(int)(lo >> 24)] + sbox2[(int)((lo >> 16) & 0x0ff)]) ^ sbox3[(int)((lo >> 8) & 0x0ff)]) + sbox4[(int)(lo & 0x0ff)]) ^ pbox02;
            lo ^= (((sbox1[(int)(hi >> 24)] + sbox2[(int)((hi >> 16) & 0x0ff)]) ^ sbox3[(int)((hi >> 8) & 0x0ff)]) + sbox4[(int)(hi & 0x0ff)]) ^ pbox03;
            hi ^= (((sbox1[(int)(lo >> 24)] + sbox2[(int)((lo >> 16) & 0x0ff)]) ^ sbox3[(int)((lo >> 8) & 0x0ff)]) + sbox4[(int)(lo & 0x0ff)]) ^ pbox04;
            lo ^= (((sbox1[(int)(hi >> 24)] + sbox2[(int)((hi >> 16) & 0x0ff)]) ^ sbox3[(int)((hi >> 8) & 0x0ff)]) + sbox4[(int)(hi & 0x0ff)]) ^ pbox05;
            hi ^= (((sbox1[(int)(lo >> 24)] + sbox2[(int)((lo >> 16) & 0x0ff)]) ^ sbox3[(int)((lo >> 8) & 0x0ff)]) + sbox4[(int)(lo & 0x0ff)]) ^ pbox06;
            lo ^= (((sbox1[(int)(hi >> 24)] + sbox2[(int)((hi >> 16) & 0x0ff)]) ^ sbox3[(int)((hi >> 8) & 0x0ff)]) + sbox4[(int)(hi & 0x0ff)]) ^ pbox07;
            hi ^= (((sbox1[(int)(lo >> 24)] + sbox2[(int)((lo >> 16) & 0x0ff)]) ^ sbox3[(int)((lo >> 8) & 0x0ff)]) + sbox4[(int)(lo & 0x0ff)]) ^ pbox08;
            lo ^= (((sbox1[(int)(hi >> 24)] + sbox2[(int)((hi >> 16) & 0x0ff)]) ^ sbox3[(int)((hi >> 8) & 0x0ff)]) + sbox4[(int)(hi & 0x0ff)]) ^ pbox09;
            hi ^= (((sbox1[(int)(lo >> 24)] + sbox2[(int)((lo >> 16) & 0x0ff)]) ^ sbox3[(int)((lo >> 8) & 0x0ff)]) + sbox4[(int)(lo & 0x0ff)]) ^ pbox10;
            lo ^= (((sbox1[(int)(hi >> 24)] + sbox2[(int)((hi >> 16) & 0x0ff)]) ^ sbox3[(int)((hi >> 8) & 0x0ff)]) + sbox4[(int)(hi & 0x0ff)]) ^ pbox11;
            hi ^= (((sbox1[(int)(lo >> 24)] + sbox2[(int)((lo >> 16) & 0x0ff)]) ^ sbox3[(int)((lo >> 8) & 0x0ff)]) + sbox4[(int)(lo & 0x0ff)]) ^ pbox12;
            lo ^= (((sbox1[(int)(hi >> 24)] + sbox2[(int)((hi >> 16) & 0x0ff)]) ^ sbox3[(int)((hi >> 8) & 0x0ff)]) + sbox4[(int)(hi & 0x0ff)]) ^ pbox13;
            hi ^= (((sbox1[(int)(lo >> 24)] + sbox2[(int)((lo >> 16) & 0x0ff)]) ^ sbox3[(int)((lo >> 8) & 0x0ff)]) + sbox4[(int)(lo & 0x0ff)]) ^ pbox14;
            lo ^= (((sbox1[(int)(hi >> 24)] + sbox2[(int)((hi >> 16) & 0x0ff)]) ^ sbox3[(int)((hi >> 8) & 0x0ff)]) + sbox4[(int)(hi & 0x0ff)]) ^ pbox15;
            hi ^= (((sbox1[(int)(lo >> 24)] + sbox2[(int)((lo >> 16) & 0x0ff)]) ^ sbox3[(int)((lo >> 8) & 0x0ff)]) + sbox4[(int)(lo & 0x0ff)]) ^ pbox16;

            lo ^= pbox17;

            dataOut[posOut + 3] = (byte)(lo >> 24);
            dataOut[posOut + 2] = (byte)(lo >> 16);
            dataOut[posOut + 1] = (byte)(lo >>  8);
            dataOut[posOut    ] = (byte) lo;

            dataOut[posOut + 7] = (byte)(hi >> 24);
            dataOut[posOut + 6] = (byte)(hi >> 16);
            dataOut[posOut + 5] = (byte)(hi >>  8);
            dataOut[posOut + 4] = (byte) hi;

            posOut += 8;
        }

        return count;
    } 
```

如果我传递更长的数据，河豚工作正常，但我需要加密这个。我们找到了问题，但我的问题是：如何解决它？！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-31T22:41:18.837

我对 Blowfish 算法或者您使用的库不是很熟悉。但是，总的来说，我会说，如果你的数据不够长而无法加密，你可以填充它。换句话说...如果您的数据不够长，请在加密之前在数据的开头或结尾添加一堆零（或其他字符，如果零对您具有特殊意义）。然后，当你解密它时，修剪填充字符。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-31T23:09:42.153

您正在尝试对大小不完全是一个块的东西使用块密码。如果您的数据不完全是 8 个字节长，您应该使用现有的填充算法以及定义明确的模式。也就是说，您为什么要实现自己的河豚功能而不是使用预制库？

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-31T23:30:56.173

有一些标准方法可以填充数据，使其具有适合给定块加密算法的长度。

[此页面](http://www.di-mgt.com.au/cryptopad.html)包含可用选项的良好概述。

> 我们需要用填充字节填充块以使其达到所需的长度。至少有五个常见的约定：
> 
> 1.  使用与填充字节数相同的字节填充
> 2.  用 0x80 填充，后跟零字节
> 3.  用零填充，除了使最后一个字节等于填充字节数
> 4.  用零（空）字符填充
> 5.  用空格字符填充
> 
> 方法一是在 PKCS#5、PKCS#7 和 RFC 3852 第 6.3 节（以前的 RFC 3369 和 RFC 2630）中描述的方法。它是最常用的，也是我们在没有任何其他考虑的情况下推荐的。

但是由于您似乎总是在加密固定长度的短消息，因此填充可以有效地削弱加密。您可以用随机数填充它并在解密后将它们丢弃。

# jquery - 是否有不会自动展平的 jQuery 地图实用程序？

> ID：703355
> 
> 赞同：46
> 
> 时间：2009-03-31T22:37:42.463
> 
> 标签：jquery, functional-programming

我正在将一组二元组从一个域（日期）映射到另一个域（时间戳）。不幸的是，它看起来像`jQuery.map`自动展平了我返回的两个元组，而且我没有看到`do_not_flatten`参数。

我是否遗漏了库中不会自动展平的其他内容？

**附录：**我假设我不应该使用`Array.map`不会自动展平的 ，因为它是[JavaScript 1.6](https://developer.mozilla.org/en/Core_JavaScript_1.5_Reference/Global_Objects/Array/map)。据我了解，出于兼容性原因，jQuery 应该抽象出我正在运行的 JavaScript 版本。

* * *

## 回答 #1

> 赞同：67
> 
> 时间：2010-02-15T17:57:58.043

我遇到了同样的问题；事实证明，您可以从 $.map 回调中返回一个嵌套数组，它不会展平外部数组：

```
$.map([1, 2, 3], function(element, index) {
  return [ element + 1, element + 2 ];
});
=> [2, 3, 3, 4, 4, 5] 
```

然而：

```
$.map([1, 2, 3], function(element, index) {
  return [ [ element + 1, element + 2 ] ];
});
=> [[2, 3], [3, 4], [4, 5]] 
```

希望有帮助！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-31T22:54:04.640

我不太确定什么是“二元组”，也不确定我是否从我查看的 Google 结果中得到了正确的答案。但是你看过[jQuery.each](http://docs.jquery.com/Utilities/jQuery.each)吗？

# .net - WIX 将新文件添加到共享组件

> ID：703359
> 
> 赞同：5
> 
> 时间：2009-03-31T22:38:28.500
> 
> 标签：.net, wix, windows-installer

我有一个共享 dll，我们将其命名为 Utility.dll，它由多个产品安装。在我的 WIX 文件中，我将 Utility.dll 作为一个单独的组件安装。现在，2.0 版的 Utility.dll 引用了一个额外的 dll，即 UtilityUtility.dll，它需要与它一起安装。

在我第一次尝试集成 UtilityUtility.dll 时，我创建了一个包含新 dll 的新 WIX 组件。

这会导致以下情况出现问题

1) 用户安装产品 1 { Utility.dll 1.0 }
2) 用户安装产品 2 { Utility.dll 2.0, UtilityUtility.dll 2.0 }
3) 用户卸载产品 2 { Utility.dll 2.0 }

现在，当用户使用 Utility.dll 时，它会在找不到引用的 UtilityUtility.dll 时失败

这导致我将 UtilityUtility.dll 添加到原始组件中，这会阻止 UtilityUtility.dll 在之前的场景中被删除，但也有其自身的问题。

1) 用户安装产品 1 { Utility.dll 1.0 }
2) 用户安装产品 2 { Utility.dll 2.0, UtilityUtility.dll 2.0 }
3) 用户卸载产品 2 { Utility.dll 2.0, UtilityUtility.dll 2.0 }
4) 用户卸载产品 1 { UtilityUtility.dll 2.0 }

UtilityUtility.dll 是孤立的，因为它不会被产品 1 卸载删除（它在最初安装时不存在于组件中）。

我在这里还有其他选择吗？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-01T17:57:06.890

除非您可以更新产品 1（我认为这不是完全可能的），否则我认为您被搞砸了。恕我直言，组件规则是 Windows Installer 最糟糕的事情。这个[指向我的一篇旧博客文章的链接](http://blogs.msdn.com/robmen/archive/2003/10/18/56497.aspx)总结了大部分内容。您的情况与那里描述的情况有些不同，但结果是预期的。

我认为你可以选择两个邪恶中较小的一个。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-01T00:35:32.993

我不是 100% 确定...但我认为将第二个 .DLL 添加到原始组件可能是“违反”组件规则。看看：http: [//blogs.msdn.com/robmen/archive/2003/10/18/56497.aspx](http://blogs.msdn.com/robmen/archive/2003/10/18/56497.aspx)

从我从 Wix 人群中收集到的信息来看，领先的“最佳实践”是将每个文件作为一个单独的组件。

您的升级计划是什么（以 msi 术语：主要、次要、补丁）？如果我没记错的话，小升级是不允许弄脏组件定义的。不知道补丁。

您可能还想担心维修。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-31T22:58:08.593

你能重现第二个问题吗？~~理论上你安装Product 2组件版本后就变成了2.0。在第 3 步之后组件版本仍然是 2.0。当用户在步骤 4 中卸载产品 1 时，Windows Installer 知道如何同时删除 Utility.dll 2.0 和 UtilityUtility.dll 2.0。~~

**更新**：我错了，对不起。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-12T18:45:10.847

我自己也遇到过这个问题。我同意@rbobby 的观点，并且我进一步提出，您可以设想这种破碎的用户场景这一事实证明您违反了规则。只有在完全兼容的情况下，您才应该更新共享组件。如果 Duck 2.0 不嘎嘎叫也不游泳，就给它起一个新名字。

在您的情况下，您有 Utility.dll 1.0 和 Utility.dll 2.0，但它们只是“相同的组件”，因为它们以不同的方式做类似的事情。Utility.dll 2.0 应该真正称为 UtilityPlus.dll 1.0。

抱歉，我知道这可能不是您想听到的答案，但工程案例很清楚。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-03-31T18:01:55.467

这是很久以前的事了，但现在有同样的问题。对所有相关产品使用相同的 UpgradeGUID 是否有可能的解决方案？MSDN上的文档说

> UpgradeCode 属性是代表一组相关产品的 GUID。升级表中的 UpgradeCode 用于搜索已安装的产品的相关版本

这听起来像是不同 MSI 文件中的多个产品可能共享相同的升级代码，从而避免冲突情况。

# c# - Page_Load 上的 NullReferenceException

> ID：703363
> 
> 赞同：2
> 
> 时间：2009-03-31T22:38:53.443
> 
> 标签：c#, asp.net

我正在尝试在 ASP.NET 页面上的 Page_Load 表单中编辑文本框的文本，但是当我尝试编辑 TextBox1.Text 时，它会引发 NullReferenceException，因为尚未实例化 TextBox。具体来说，我要实现的是：[http](http://www.codeproject.com/KB/user-controls/popupcalendarcontrol.aspx) ://www.codeproject.com/KB/user-controls/popupcalendarcontrol.aspx ，但它是为旧版本的 ASP.NET 编写的，对我不起作用。有没有办法在 Page_Load 开始时实例化控件？或者我可以在负载上捕获的其他事件？对于普通的 windows 窗体，我会在构造函数中调用 InitializeComponent()。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-31T22:47:14.687

您可以附加绝对不同的事件，但听起来页面没有正确加载控件，因为此时它们应该可用。您可以查看[ASP.NET 页面生命周期](http://msdn.microsoft.com/en-us/library/ms178472.aspx)以获取更多信息。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-01T06:09:47.073

TextBox 是否位于绑定控件中，例如 FormView、GridView、DataList 等？如果是这样，那么在数据绑定发生之前控件将不存在。一旦该事件发生，您可以执行类似的操作

> `DirectCast(myDataList.SelectedRow.FindControl("myTextBox"), TextBox).Text`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-15T18:44:14.377

我知道我在回答这个问题方面有点落后，但我发现了一些我在任何地方都找不到的不寻常的东西。如果您的页面“在”母版页“下”，并且如果您在所述母版页上引用任何内容，那么您当前页面的控件似乎是空的 - 他们中的每个人。我通过在我的 InitializeCulture 方法期间引用“Master.Environment”（一个公共字符串）并在 Page_Load() 期间让我当前（Default.aspx）页面上的第一个控件为空来发现这一点 - 无论第一个控件是什么。

我知道我迟到了，但如果这可以帮助任何人，我想要这个词。

# c# - 在 DDD/TDD 应用程序中测试持久层

> ID：703364
> 
> 赞同：2
> 
> 时间：2009-03-31T22:39:09.387
> 
> 标签：c#, nhibernate, tdd, domain-driven-design

如果我有以下域对象：

```
public class Customer
{
    public virtual Guid Id { get; set; }
    public virtual string Name { get; set; }
    public virtual ISet<Order> Orders { get; set; }

    public Customer()
    {
        Orders = new HashedSet<Order>();
    }

    public virtual void AddOrder(Order order)
    {
        order.Customer = this;
        Orders.Add(order);
    }
} 
```

使用以下 NHibernate 映射：

```
<hibernate-mapping xmlns="urn:nhibernate-mapping-2.2" namespace="Examples" assembly="Examples">
  <class name="Customer">
      <id name="Id">
        <generator class="guid.comb" />
      </id>
      <property name="Name" length="50"/>
      <set name="Orders" table="CustomerOrder" cascade="all-delete-orphan" lazy="true">
        <key column="CustomerId"/>
        <many-to-many class="Order" column="OrderId"/>
      </set>
  </class>
</hibernate-mapping> 
```

这个测试有什么价值吗？

```
[Test]
public Save_NameWritten_SameNameIsReadback()
{
    var expected = new Customer { Name = "Fred Quimby" };
    _repo.Save(c);
    var actual = _repo.Find(expected.Id);
    Assert.AreEqual(expected.Name, actual.Name);
} 
```

人们通常像这样测试他们的持久层吗？确保每个字段都单独保存？老实说，我不确定这样的最佳实践是什么。我可以看到用长字符串和父/子关系测试一些东西——但是整数和日期呢？这是矫枉过正吗？

我这里只说持久层，而不是领域层的业务逻辑。为此，我将模拟存储库，而在这里我验证存储库是否确实保存了我告诉它保存的内容。如果有人忘记映射一个字段，或者他们在映射中有一个虚假的字符串长度怎么办？

是否有任何工具可以在 .NET 中自动生成这些类型的测试？还是那是“坏”？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-31T22:47:57.667

如果您确保在不同的会话中保存和获取数据，那么您可以有效地确保您的映射是正确的——这就是价值。

最好的方法是在内存数据库中使用 fluent NHibernate 中的 PersistenceSpecification （这是一篇关于它的[帖子](http://marekblotny.blogspot.com/2008/12/fluent-nhibernate-integration-tests.html)），它可以在不同的会话中为您插入和选择数据。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-09T19:32:55.470

这些测试具有很大的价值，因为它们最终是验证您是否真的可以与数据库对话的唯一方法。一旦你确认你有一个工作存储库，你可以在其他单元测试中模拟对存储库的调用，正如你所提到的。

小心使用内存数据库——因为你需要知道你的目标数据库可以正常工作。还要注意这些测试中的会话使用。如果您真的想在加载时访问数据库，请确保 Save 和 Find 发生在不同的会话中。

使用这些连接的数据库测试可以验证的事情很少：

*   字符串的边界长度
*   延迟加载。您可以使用分离的会话来验证您是否获得了您不想急切加载的连接对象的延迟加载异常，反之亦然。这对于更复杂的域层次结构很重要，因为有人无意中添加了通过对象图的导航路径，导致整个数据库被加载。
*   外键和唯一约束。
*   搜索调用具有大型数据集的存储库的效率。

# sql-server - 备份 MS SQL Server 2005？

> ID：703365
> 
> 赞同：0
> 
> 时间：2009-03-31T22:39:31.057
> 
> 标签：sql-server

我有一个 MS SQL Server 2005。备份单个数据库非常容易，只需右键单击数据库，然后单击任务->备份。我的问题是如何备份数据库之外的 SQL Server 数据库对象？

例如，Security->Logins 下，有登录用户列表；在 SQL Server Agent->Jobs 下，有作业列表，在 Server Objects->Linked Servers 下；等等。

有没有办法对 SQL Server 进行完整备份？在 TSQL 中？我试图从 SQL Server Management Studio 中查找，但找不到任何内容。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-31T23:12:00.883

这些项目存储在系统数据库中——主要是 master 和 msdb（在数据库 | 系统数据库下）。您可以单独备份它们（就像您备份其他数据库一样），或者更好的是，创建一个维护计划（管理 | 维护计划）以定期执行此操作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-01T00:07:05.633

我推荐使用这个脚本。我花了很多时间来处理之前的维护计划失败。

[http://blog.ola.hallengren.com/](http://blog.ola.hallengren.com/)

[http://msdn.microsoft.com/en-us/library/ms187048.aspx](http://msdn.microsoft.com/en-us/library/ms187048.aspx) 有更多关于标准程序的信息。

如果您负责这些数据库，我建议您练习在新服务器上恢复系统数据库，这样到时候您就有信心了。还原并不像右键还原那么简单。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-01T12:07:29.337

数据库登录名存储在用户数据库中，服务器登录名存储在主数据库中。msdb 存储 sql 作业和历史记录。您可以在 T-SQL 中执行的最简单的完整备份是：

```
BACKUP DATABASE dbname 
TO DISK='C:\backupfile.bak' WITH INIT 
```

WITH INIT 表示它将覆盖文件。

恢复master数据库需要在单用户模式下重启sql server。您可以从 sql server 目录中的命令行执行此操作：`sqlservr.exe -c - m`

然后使用 SSMS 或 sqlcmd 连接并运行还原。

# c# - 为什么 ExpectConstructor() 不会导致此测试失败？

> ID：703367
> 
> 赞同：1
> 
> 时间：2009-03-31T22:41:02.457
> 
> 标签：c#, unit-testing, mocking, nunit, typemock

我对TypeMock 3.5 中类的`ExpectConstructor()`方法的目的有点困惑。`Mock`

如果没有调用构造函数，即如果没有实例化模拟类型的实例，我会认为调用`ExpectConstructor`会导致`MockManager`失败。`Verify()`

但是，`ExpectConstructor()`在没有为该构造函数指定任何参数的情况下调用似乎不会设置该期望 - 因此我的测试无论如何都通过了。

我的问题：我是否遗漏或误解了什么？如果`ExpectConstructor()`不是为了验证构造函数调用，它是为了什么？

考虑这三个说明问题的 NUnit 测试：

```
[Test]
public void exampleTest1()
{
   MockManager.Init();
   Mock fooMock = MockManager.Mock(typeof(Foo));
   fooMock.ExpectConstructor().Args(10);

   Foo f = new Foo(10);   // Constructor called
   MockManager.Verify();  

   // This test passes, as expected...so far so good
}

[Test]
public void exampleTest2()
{
   MockManager.Init();
   Mock fooMock = MockManager.Mock(typeof(Foo));
   fooMock.ExpectConstructor();

   Foo f = new Foo();  // Constructor called
   MockManager.Verify();  

   // This test passes...also as expected
}

[Test]
public void exampleTest3()
{
   MockManager.Init();
   Mock fooMock = MockManager.Mock(typeof(Foo));
   fooMock.ExpectConstructor();

   // nb. not instantiating an instance of Foo

   MockManager.Verify();  

   // This test passes - why?!
} 
```

在此先感谢您的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-31T23:54:26.740

[这在 2006 年](http://www.typemock.com/community/viewtopic.php?t=360)被报告为一个错误。据说它将被修复（嗯，已实现 - 显然它不是一个错误，它只是一个未实现的功能......）但如果它现在仍然是一个问题，我想他们没有解决它:(

# eclipse - Ant 构建控制台被 Eclipse 中的依赖项目破坏

> ID：703369
> 
> 赞同：1
> 
> 时间：2009-03-31T22:41:19.913
> 
> 标签：eclipse, ant, build-process

我在 Eclipse 中有一组依赖项目，每个项目都有自己的 Ant 构建脚本。如果我在多个项目中进行更改，然后选择“Build All”（Ctrl+B），每个 Ant 构建都会以正确的顺序调用。但是，如果一个项目中出现错误，Eclipse 仍然会尝试构建其他项目，并且在此过程中会破坏 Ant 控制台，因此构建错误不再可见。如果我可以打开有问题的项目并选择“构建项目”，这不会*那么*烦人，但 Eclipse 比我聪明：它不会重建，直到我打开项目中的某个文件，编辑它并保存（通常我会在光标所在的位置添加和删除空格字符）。欢迎回答以下任何问题。

如何将 Eclipse 配置为（按优先顺序）：

1.  一旦任何项目的 Ant 构建失败，就终止“全部构建”？
2.  保存“全部构建”的*所有*控制台输出，而不是为每个项目重置控制台？
3.  为每个新的 Ant 实例生成一个单独的控制台？
4.  允许我强制“构建项目”，即使它认为没有任何改变？

[更新]奖金问题：

*   我如何配置 Eclipse，以便修复依赖项目中的任何构建错误都算作“构建项目”的“更改”？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-01T01:59:59.827

您是否尝试过通过运行配置将标准输出重定向到文件？如果没有，一些屏幕截图可以提供帮助......（您可以尝试“附加”这不在我的屏幕截图中:)）

[![运行蚂蚁的配置](https://i.stack.imgur.com/nd5Kh.jpg)](https://i.stack.imgur.com/nd5Kh.jpg)

[![通用标签和std io](https://i.stack.imgur.com/8lV7q.jpg)](https://i.stack.imgur.com/8lV7q.jpg)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-01T16:08:23.470

One alternative is to have each Ant build log itself, e.g., using the following in `build.xml`

```
<record name="build.log" 
        loglevel="verbose" 
        append="false" /> 
```

Oddly, Eclipse seems to disable this logging somehow when running an Ant build.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-31T22:44:36.020

我不太喜欢 ant，但你不能让构建相互依赖吗？

# java - 编写这个java代码的最简洁/最好的方法是什么？

> ID：703372
> 
> 赞同：1
> 
> 时间：2009-03-31T22:42:06.977
> 
> 标签：java

我正在编写一个简单的分布式 java rmi 应用程序，并且我有一堆方法，每个方法都需要遍历客户端接口的映射，以便在这些接口上调用各种其他方法，如下所示：

```
public void methodX (arg1, arg2) {
  Iterator<String> itr = clients.keySet().iterator;
  while (itr.hasNext()) {
    String name = itr.next();
    if (!"mod".equals(name)) {
      try {
        clients.get(name).methodXX(arg1, arg2);
      } catch(RemoteException ex) {
        // do something
      }
    }
  }
}

public void methodY (arg1, arg2, arg3) {
  Iterator<String> itr = clients.keySet().iterator;
  while (itr.hasNext()) {
    String name = itr.next();
    if (!"mod".equals(name)) {
      try {
        clients.get(name).methodYY(arg1, arg2, arg3);
      } catch(RemoteException ex) {
        // do something
      }
    }
  }
} 
```

现在我修改了这些，以便它们通过传递一个名为 MESSAGE_TYPE 的新参数来调用单个方法 doAll，如下所示：

```
public void methodX (arg1, arg2) {
  doAll(MESSAGE_TYPE.METHODX, arg1, arg2, null);
}

public void methodY (arg1, arg2, arg3) {
  doAll(MESSAGE_TYPE_METHODY, arg1, arg2, arg3);
} 
```

还有 doAll 方法：

```
public void doAll(msg_type, arg1, arg2, arg3) {
 Iterator<String> itr = clients.keySet().iterator;
  while (itr.hasNext()) {
    String name = itr.next();
    if (!"mod".equals(name)) {
      try {
        switch(msg_type) {
          case METHODX:
            clients.get(name).methodXX(arg1, arg2);
            break;
          case METHODY:
            clients.get(name).methodYY(arg1, arg2, arg3);
            break;
        }
      } catch(RemoteException ex) {
        // do something
      }
    }
  }
} 
```

现在有更多这样的方法，所以我的 doAll 方法需要接受一堆 args 并且每个调用它的 methodXX 都会向它传递一堆空值。

我可以重写它以使其更简洁吗？如果是这样，你能举个例子吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-03-31T22:51:59.433

一方面，我会使用增强的 for 循环，并迭代条目而不是键，如评论中所建议的：

```
public void doAll(arg1, arg2, arg3) {
  for (Map.Entry<String,Client> entry : clients.entrySet()) {
    if (!"mod".equals(entry.getKey())) {
      try {
        switch(MESSAGE_TYPE) {
          case METHODX:
            entry.getValue().methodXX(arg1, arg2);
            break;
          case METHODY:
            entry.getValue().methodYY(arg1, arg2, arg3);
            break;
        }
      } catch(RemoteException ex) {
        // do something
      }
    }
  }
} 
```

我想我会重构它以传递一个“动作”来调用每个客户端，并使用来自调用站点的匿名内部类：

```
public interface RemoteAction {
  public void execute(Client client) throws RemoteException;
}

public void doAll(RemoteAction action) {
  for (Map.Entry<String,Client> entry : clients.entrySet()) {
    if (!"mod".equals(entry.getKey())) {
      try {
        action.execute(entry.getValue());
      } catch(RemoteException ex) {
        // do something
      }
    }
  }
}

public void methodX (final arg1, final arg2) {
  doAll(new Action() {
    @Override public void execute(Client client) throws RemoteException {
      client.methodX(arg1, arg2);
    }
  });
}

public void methodY (final arg1, final arg2, final arg3) {
  doAll(new Action() {
    @Override public void execute(Client client) throws RemoteException {
      client.methodY(arg1, arg2, arg3);
    }
  });
} 
```

它不如支持 lambda 表达式的语言好，但它比 switch 语句好。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-31T22:53:18.073

使用泛型

```
Iterator<String> itr = clients.keySet().iterator;
while (itr.hasNext()) {
   String name = itr.next(); 
```

变成

```
for(String name: clients.keySet()){ 
```

此外，用 switch/case 替换方法也不是很好，尤其是当您需要为未使用的值传递虚拟参数时。保留单独的方法。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-03-31T23:02:46.757

我不知道如何使您的方法更简洁，但是我对 doAll 方法的参数有一个建议...

```
public void doAll(int methodType, Object... arg) 
{
    //snip
    switch(msg_type) 
    {
        case METHODX:
            clients.get(name).methodXX(arg[0], arg[1]);
            break;
        case METHODY:
            clients.get(name).methodYY(arg[0], arg[1], arg[2]);
            break;
    }
    //snip
} 
```

这将允许您将可变数量的参数传递给 doAll 方法，从而减少对空值的需求。

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2009-03-31T22:54:08.993

根据上下文（有时安全管理器或代理会妨碍），内省和可变参数是您的朋友：

你可以有类似的东西：

```
void callStuff(String methodName, Object ... args) 
{
   for(Client client: clients)
   {
     //...filter client by name, method, etc.
     //...figure out parameter types - you can guess from args or pass another parameter
     Method method = client.getClass().getMethod(methodNamename, parameterTypes);
     method.invoke(client,args);
   } 
} 
```

（免责声明：上面的代码未经测试且未编译事件 - 我不知道它是否适用于 RMI）

# asp.net-mvc - MVC 局部视图、模型等

> ID：703382
> 
> 赞同：2
> 
> 时间：2009-03-31T22:45:57.123
> 
> 标签：asp.net-mvc

我对 ASP.NET MVC 还很陌生，目前我正试图了解一些设计概念。我目前坚持的一件事是如何（最好）处理如下所述的情况。

假设我有一个需要呈现多个“部分”的页面。例如，在左侧有一个数据驱动的列表，然后列表中的选定项目在页面的另一个部分中显示另一个列表。为了更好地理解，我们建议左侧列表是电影类别列表，另一个列表显示包含在该类别中的电影列表以及各种电影详细信息。

现在，我有某种形式的 ORM，例如 Entity Framework、LINQ to SQL 或任何将 tblCategory 和 tblMovie 数据库表分别映射到 Category 和 Movie 实体的东西。这些实体位于 MyMVCApp.Data.Entities 命名空间中。然后，我使用位于 MyMVCApp.Data 命名空间中的存储库模式来封装针对这些实体的查询（通过 LINQ）以返回我们的模型实体。

这是我的第一个问题所在。存储库是否应该返回视图模型实体或域实体，然后将其扩展以生成视图模型实体？在我天真的想法中，我认为从 ORM 返回的实体只是数据的容器，其中包含业务逻辑的域实体。那么这里肯定应该有一个抽象吗？

无论如何，回到我的场景。现在假设我希望介绍本文开头描述的两个部分。我假设这里应该发生的是我的域实体模型将包含一个类别列表及其相关电影。所以像一个列表，每个列表都包含一个列表。

该模型将在某个地方填充。这是我的第二个问题。假设我上面的假设是正确的，它只是从 ORM 返回数据实体。现在我有一个名为 MyMVCApp.Core.Model （或类似名称）的命名空间/项目，其中包含一些域实体，例如上一段中提到的 Movie 和 Category 实体。这些实体是否具有从 ORM 检索数据并填充自身的方法？或者存储库是否检索这些填充的实体模型？关于这部分的另一个问题是，如果我的 ORM 中有一个 Movie 和 Customer 实体，是否可以将域实体命名为相同的名称？

最后，我假设控制器现在有这个 Category 和 Movie 对象的填充列表，并将其传递回视图。我猜最好在开始时将每个部分描述为部分视图并将填充模型传递给每个部分？因此，它可能是 IndexController 检索填充的 CategoryMovies 实体，将其传递给 Categories 部分视图和 Movies 部分视图。然后，我需要以某种方式确定所选类别（查询字符串？）并在视图中显示该类别中的适当电影列表。

好的，所以如果有人在我的漫谈中走到了这一步，我会深深鞠躬。我希望我已经足够详细地解释了我混淆的想法和问题，以便有人提供某种启示。

谢谢收听！:-)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-01T17:46:12.050

由于您没有提到它，我假设您是 DDD 概念的新手。DDD 通过将逻辑放在它所属的位置来补充 MVC 中的“M”。而且，我认为可以在这里应用很多。

在严格的 DDD 形式中，我会将您的电影示例用作聚合根（DDD 概念）。在 Movie 中，您将拥有获取与 Movie 直接相关的类别和相关实体的业务逻辑（方法）（即 Categories-this-movie-belongs-in）。这假设您要显示的“类别”列表是这部电影所在的类别列表。

```
public class Movie
{
    private IList<Category> _categories;
    public IList<Category> FetchCategories()
    {
        // you can lazy-load here, use Linq-to-Sql, etc.
        return _categories;
    }
    public void AddCategory(Category c)
    {
        _categories.Add(c);
    }
} 
```

当然，如果您在类别上没有标识，您可以在此处将类别视为值对象（VO，一个 DDD 概念）。

现在，更有趣的是，如果您确实想在您的类别上保留一个身份，将它们视为具有多个实体以及与其他 VO 等的关系的聚合根。在这种情况下，您可能希望利用 DDD 的服务概念将两个聚合组合成您想要传递给控制器​​的请求模型。这允许您围绕加载类别创建业务规则。

```
public class Movie
{...}
public class Category
{...}
public class MovieCategory : Movie
{
    private IList<Category> _categories;
    public IList<Category> Categories
    {
        get
        {
            return _categories;
        }
        internal set
        {
            _categories = value;
        }
    }
}
public class MovieCategoryService
{
    public MovieCategory FetchMovieCategoryByMovieId(int id)
    {
        MovieCategory mc = _movieRepository.FetchMovie(id);
        // do some logic here, some checks, etc
        // to obtain your Categories list.  Maybe querystring?
        IList<Category> cats = ...;
        mc.Categories = cats;

        return mc;
    }
} 
```

这个概念是，您现在在域层中拥有逻辑，在此 MovieCategoryService 中，可以处理这些关系的复杂创建，或者也使用工厂来创建复杂类型。

这为您提供了一个模型，您可以将其传递给不同的 View 和 PartialViews。

您原始帖子的最后一步是如何将其放入视图中。我一直在使用 ViewModel 方法来解决这个问题。动态创建 ViewModel 或作为类创建，并将所有实体挂在此 ViewModel 上。最近的一个 StackOverflow 问题触及了这个概念。 [ViewModel 最佳实践](https://stackoverflow.com/questions/664205/viewmodel-best-practices)

我已经将模型直接传递到视图中，我现在正在尝试这种方法。它确实清理了一切，因为您的域模型确实应该与页面上的“逻辑”断开连接。我发现自己在想，“该死。我需要根据这个 ID 填充这个局部视图。猜猜这意味着实体上的另一种方法。” 采用 ViewModel 方法会从域模型中移除逻辑/思考，并将其放在它所属的位置 - 在您正在微调视图/部分视图的应用程序/UI 层中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-01T17:14:59.037

首先，我认为您应该从一个简单的项目开始，并尝试您在长问题中描述的各种场景:)。没有什么是一成不变的，你可以使用任何带有数据层和服务的架构，或者你喜欢的任何东西！

> 或者存储库是否检索这些填充的实体模型？

我会说是的。您的控制器从服务中获取这些并获取它们，填充它们，然后将它们移动到视图中以便显示。

> 我猜最好在开始时将每个部分描述为部分视图并将填充模型传递给每个部分？

我再次认为你在正确的轨道上；）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-05T02:06:15.293

将视图模型实体而不是整个域实体本身提供给视图是一个好主意，从而只为视图提供工作所需的东西

首先从您的域返回一个类别列表，然后构造一个以类别名称作为参数的电影视图，如下所示

```
 - <Host>/Movies/Comedy
 - <Host>/Movies/Horror 
```

这将依次显示属于该特定类别的电影

# iphone - NSDictionaries 与具有属性的自定义对象，你的看法是什么？

> ID：703386
> 
> 赞同：3
> 
> 时间：2009-03-31T22:48:31.797
> 
> 标签：iphone

我正在编写一个基本上使用 5 个业务实体 A、BC、D 和 E 的应用程序

*   A 有一些属性并持有 B 的列表
*   B 有一些其他的属性和一个 C 的列表和一个 D 的列表
*   C 有一些其他属性和一个 D 的列表和一个 E 的列表
*   D只有几个属性
*   E 只有几个属性

它们之间没有继承关系。不涉及真正的业务逻辑，对象被创建、填充，然后以只读方式访问，没有进一步的操作。

我的自然编码风格是面向对象并为每个实体编写类，将 NSArrays 用于列表，并合成上述属性。

这将使代码可读。

但是另一种方法似乎也很明显：只使用 NSDictionaries 和 NSArrays，并使用键/值而不是属性。这对我来说似乎更有效，并且以某种方式“更接近” iPhone 风格的编程......但显然会导致代码的可读性降低。另一个优点是不需要额外的序列化自定义编码/解码（将状态持久化到磁盘，使用 JSON，......）所以在纸上，它代表了后一种方法，另一方面，它仍然感觉有点尴尬不使用自定义对象...

这真的只是**一个口味问题**吗？或者是否还有其他支持/反对其中一种方法的论点？仅使用字典在内存/性能方面是否更好？它是首选的“Apple 编码风格”吗？（我来自 Java/C#）。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-31T22:58:26.797

在这方面，我认为 Java/C# 和 Cocoa 之间没有太大区别。您的问题同样适用于这些平台（同样适用于键值存储和关系存储）。

在面向对象的环境中，您必须在存储数据的键值方法的灵活性与结构化和面向对象的风格之间进行权衡。只有当我需要灵活性时（例如，结构是动态的并且可能由用户更改或在编译时未知），我才会使用键值方法。否则，走这条路可能会让你完全摆脱 OOP 的约定和好处（顺便说一下，这是重点。在特定情况下坚持面向对象原则的麻烦是否值得？我认为你的问题归结为这个问题并回答它，你应该分析你的具体情况）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-31T22:54:42.533

这在很大程度上取决于您的对象是只是数据集合（键/值对）还是实现它们自己的功能。

如果它们是数据，我会说与 NSDictionary 一起使用，它的代码要少得多，而且正如您指出的那样，您不必为每个类编写序列化例程。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-01T14:00:14.057

使用混合方法。存储对象所基于的字典，但将最常用的值公开为属性，这些属性要么在从字典初始化对象时填充，要么让访问器在字典中查找值（效率较低）。

还提供一个属性来获取字典。这样，如果您需要将新值从字典中快速传播到代码的特定区域（可能是服务器添加的新值），您就有了这种灵活性。然后，如果调用者大量使用某个值，您可以将其迁移为真正的属性，并获得属性的完成和类型检查。

# php - 在 CMS 中实现可变数量的自定义字段的好方法是什么？

> ID：703391
> 
> 赞同：0
> 
> 时间：2009-03-31T22:52:34.673
> 
> 标签：php, content-management-system

我工作的地方使用的实现在表中使用了大约 10 列：CUSTOMFIELD1、CUSTOMFIELD2 等。每次看到它，我认为一定有更好的方法。

不是每个人都会使用所有 10，有些人会使用 0，所以这些空列只是盯着我，乞求使用。

因此，如果有更好的方法......理想情况下，我认为它允许：

1.  超过 10 个自定义字段。理论上是无限的。实际上，像15这样理智的东西。
2.  每个自定义字段都可以有一个名称，由用户设置。
3.  可以设置自定义字段类型。基本类型，例如：字符串和数字。

到目前为止，我正在考虑创建一个名为 CUSTOM_FIELDS 的列，它将以 XML、JSON 或 YAML 等格式存储包含自定义字段描述、名称、类型等文件的路径，我可以将其转换回目的。这只是自定义字段的定义，这就是我如何保存使用这些自定义字段的内容的全部问题......

无论如何，这正是我现在的想法。有任何想法吗？

PS ---我认为定制应用程序以适应用户会比将内容放入自定义字段更理想，但我没有那种奢侈和其他时候定义额外的 2 个自定义字段就可以了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-31T22:59:04.860

创建一个单独的表 - 包含列的 CustomerFields：

*   customer_id (int),
*   字段（varchar），
*   值（varchar），
*   数据类型（varchar）

现在，通过在 CustomerFields 表中查找所有带有 customer_id='CustomerID' 的条目，您可以分配任意数量的变量。唯一的问题是 value 不是真正的 varchar，但可以是整数并且应该被解析。但考虑到这个模式有多简单，我认为这不是什么大问题

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-31T22:55:49.190

> 不是每个人都会使用所有 10，有些人会使用 0，所以这些空列只是盯着我，乞求使用。

一个快速提示，不要规范化或非规范化数据库，因为您必须滚动到一边并认为“这太大了”因为这个视图只是数据库表的任意视图。

# java - 如何在没有不必要的十进制 0 的情况下很好地将浮点数格式化为字符串

> ID：703396
> 
> 赞同：568
> 
> 时间：2009-03-31T22:54:29.507
> 
> 标签：java, string, floating-point, format, double

一个 64 位的 double 可以精确地表示整数 +/- 2 ^(53)。

鉴于这一事实，我选择使用双精度类型作为我所有类型的单一类型，因为我的最大整数是一个无符号的 32 位数字。

但是现在我必须打印这些伪整数，但问题是它们也与实际的双精度数混合在一起。

那么如何在 Java 中很好地打印这些双打呢？

我试过`String.format("%f", value)`了，这很接近，除了我得到很多小值的尾随零。

这是一个示例输出`%f`

```
232.00000000
0.18000000000
1237875192.0
4.5800000000
0.00000000
1.23450000

```

我想要的是：

```
232
0.18
1237875192
4.58
0
1.2345

```

当然，我可以编写一个函数来修剪这些零，但由于字符串操作，这会导致很多性能损失。我可以用其他格式代码做得更好吗？

* * *

Tom E. 和 Jeremy S. 的答案是不可接受的，因为他们都任意四舍五入到小数点后两位。请在回答之前了解问题。

* * *

请注意，这`String.format(format, args...)`取决于***语言环境***（请参阅下面的答案）。

* * *

## 回答 #1

> 赞同：442
> 
> 时间：2013-01-02T17:52:01.780

如果想法是打印存储为双精度的整数，就好像它们是整数一样，否则以最小必要精度打印双精度：

```
public static String fmt(double d)
{
    if(d == (long) d)
        return String.format("%d",(long)d);
    else
        return String.format("%s",d);
} 
```

产生：

```
232
0.18
1237875192
4.58
0
1.2345 
```

并且不依赖于字符串操作。

* * *

## 回答 #2

> 赞同：241
> 
> 时间：2009-08-14T04:52:45.140

```
String.format("%.2f", value); 
```

* * *

## 回答 #3

> 赞同：119
> 
> 时间：2014-08-14T12:35:14.637

**简而言之：**

如果您想摆脱尾随零和[语言环境](https://en.wiktionary.org/wiki/locale#Noun)问题，那么您应该使用：

```
double myValue = 0.00000021d;

DecimalFormat df = new DecimalFormat("0", DecimalFormatSymbols.getInstance(Locale.ENGLISH));
df.setMaximumFractionDigits(340); //340 = DecimalFormat.DOUBLE_FRACTION_DIGITS

System.out.println(df.format(myValue)); //output: 0.00000021 
```

**解释：**

为什么其他答案不适合我：

*   `Double.toString()`或`System.out.println`or`FloatingDecimal.toJavaFormatString`如果 double 小于 10^-3 或大于或等于 10^7，则使用科学记数法

    ```
     double myValue = 0.00000021d;
     String.format("%s", myvalue); //output: 2.1E-7 
    ```

*   通过使用`%f`，默认小数精度为 6，否则您可以对其进行硬编码，但如果您的小数较少，则会导致添加额外的零。例子：

    ```
     double myValue = 0.00000021d;
     String.format("%.12f", myvalue); // Output: 0.000000210000 
    ```

*   通过使用`setMaximumFractionDigits(0);`或`%.0f`删除任何小数精度，这对整数/长整数很好，但对双精度则不行

    ```
     double myValue = 0.00000021d;
     System.out.println(String.format("%.0f", myvalue)); // Output: 0
     DecimalFormat df = new DecimalFormat("0");
     System.out.println(df.format(myValue)); // Output: 0 
    ```

*   通过使用 DecimalFormat，您是本地依赖的。在法语语言环境中，小数点分隔符是逗号，而不是点：

    ```
     double myValue = 0.00000021d;
     DecimalFormat df = new DecimalFormat("0");
     df.setMaximumFractionDigits(340);
     System.out.println(df.format(myvalue)); // Output: 0,00000021 
    ```

    使用 ENGLISH 语言环境可确保您得到一个小数点分隔符，无论您的程序将在何处运行。

为什么要使用 340`setMaximumFractionDigits`呢？

两个原因：

*   `setMaximumFractionDigits`接受整数，但其实现允许的最大位数`DecimalFormat.DOUBLE_FRACTION_DIGITS`等于 340
*   `Double.MIN_VALUE = 4.9E-324`因此，使用 340 位数字，您肯定不会舍入双精度数并丢失精度

* * *

## 回答 #4

> 赞同：39
> 
> 时间：2014-10-01T00:53:59.430

采用：

```
if (d % 1.0 != 0)
    return String.format("%s", d);
else
    return String.format("%.0f", d); 
```

这应该适用于 Double 支持的极值。它产生：

```
0.12
12
12.144252
0 
```

* * *

## 回答 #5

> 赞同：31
> 
> 时间：2014-02-09T22:11:06.720

[在我的机器上，以下函数比JasonD 的 answer](https://stackoverflow.com/a/14126736/974531)提供的函数快大约 7 倍，因为它避免了`String.format`：

```
public static String prettyPrint(double d) {
  int i = (int) d;
  return d == i ? String.valueOf(i) : String.valueOf(d);
} 
```

* * *

## 回答 #6

> 赞同：24
> 
> 时间：2016-08-05T09:36:45.280

我的两分钱：

```
if(n % 1 == 0) {
    return String.format(Locale.US, "%.0f", n));
} else {
    return String.format(Locale.US, "%.1f", n));
} 
```

* * *

## 回答 #7

> 赞同：15
> 
> 时间：2009-03-31T23:03:55.147

呐，没关系。字符串操作导致的性能损失为零。

这是在后面修剪结尾的代码`%f`：

```
private static String trimTrailingZeros(String number) {
    if(!number.contains(".")) {
        return number;
    }

    return number.replaceAll("\\.?0*$", "");
} 
```

* * *

## 回答 #8

> 赞同：14
> 
> 时间：2016-07-29T10:33:07.163

```
if (d == Math.floor(d)) {
    return String.format("%.0f", d); //Format is: 0 places after decimal point
} else {
    return Double.toString(d);
} 
```

更多信息：[https ://docs.oracle.com/javase/tutorial/java/data/numberformat.html](https://docs.oracle.com/javase/tutorial/java/data/numberformat.html)

* * *

## 回答 #9

> 赞同：12
> 
> 时间：2019-12-09T14:22:16.303

```
float price = 4.30;
DecimalFormat format = new DecimalFormat("0.##"); // Choose the number of decimal places to work with in case they are different than zero and zero value will be removed
format.setRoundingMode(RoundingMode.DOWN); // Choose your Rounding Mode
System.out.println(format.format(price)); 
```

这是一些测试的结果：

```
4.30     => 4.3
4.39     => 4.39  // Choose format.setRoundingMode(RoundingMode.UP) to get 4.4
4.000000 => 4
4        => 4 
```

* * *

## 回答 #10

> 赞同：11
> 
> 时间：2017-10-10T19:59:21.800

使用`DecimalFormat`和`setMinimumFractionDigits(0)`。

* * *

## 回答 #11

> 赞同：10
> 
> 时间：2016-09-10T07:09:56.800

这将很好地完成工作：

```
 public static String removeZero(double number) {
        DecimalFormat format = new DecimalFormat("#.###########");
        return format.format(number);
    } 
```

* * *

## 回答 #12

> 赞同：7
> 
> 时间：2017-07-14T08:29:47.187

```
new DecimalFormat("00.#").format(20.236)
//out =20.2

new DecimalFormat("00.#").format(2.236)
//out =02.2 
```

1.  0 表示最小位数
2.  渲染 # 位数

* * *

## 回答 #13

> 赞同：6
> 
> 时间：2015-03-13T10:24:52.980

请注意，这`String.format(format, args...)`取决于***语言环境，***因为它*使用用户的默认语言环境进行格式化，也就是说，可能在**123 456,789*或*123,456.789 之*类的内部使用逗号甚至空格，这可能与您期望的不完全一样。

您可能更喜欢使用`String.format((Locale)null, format, args...)`.

例如，

```
 double f = 123456.789d;
    System.out.println(String.format(Locale.FRANCE,"%f",f));
    System.out.println(String.format(Locale.GERMANY,"%f",f));
    System.out.println(String.format(Locale.US,"%f",f)); 
```

印刷

```
123456,789000
123456,789000
123456.789000 
```

这就是`String.format(format, args...)`不同国家的做法。

编辑好的，因为已经讨论过手续：

```
 res += stripFpZeroes(String.format((Locale) null, (nDigits!=0 ? "%."+nDigits+"f" : "%f"), value));
    ...

protected static String stripFpZeroes(String fpnumber) {
    int n = fpnumber.indexOf('.');
    if (n == -1) {
        return fpnumber;
    }
    if (n < 2) {
        n = 2;
    }
    String s = fpnumber;
    while (s.length() > n && s.endsWith("0")) {
        s = s.substring(0, s.length()-1);
    }
    return s;
} 
```

* * *

## 回答 #14

> 赞同：5
> 
> 时间：2012-11-26T20:55:40.380

我做了一个`DoubleFormatter`有效地将大量双精度值转换为漂亮/可呈现的字符串：

```
double horribleNumber = 3598945.141658554548844;
DoubleFormatter df = new DoubleFormatter(4, 6); // 4 = MaxInteger, 6 = MaxDecimal
String beautyDisplay = df.format(horribleNumber); 
```

*   如果 V 的整数部分大于 MaxInteger => 以科学格式 (1.2345E+30) 显示 V。否则，以正常格式 (124.45678) 显示。
*   MaxDecimal 决定小数位数（用[银行家四舍五入](https://en.wiktionary.org/wiki/bankers%27_rounding)修剪）

这里的代码：

```
import java.math.RoundingMode;
import java.text.DecimalFormat;
import java.text.DecimalFormatSymbols;
import java.text.NumberFormat;
import java.util.Locale;

import com.google.common.base.Preconditions;
import com.google.common.base.Strings;

/**
 * Convert a double to a beautiful String (US-local):
 *
 * double horribleNumber = 3598945.141658554548844;
 * DoubleFormatter df = new DoubleFormatter(4,6);
 * String beautyDisplay = df.format(horribleNumber);
 * String beautyLabel = df.formatHtml(horribleNumber);
 *
 * Manipulate 3 instances of NumberFormat to efficiently format a great number of double values.
 * (avoid to create an object NumberFormat each call of format()).
 *
 * 3 instances of NumberFormat will be reused to format a value v:
 *
 * if v < EXP_DOWN, uses nfBelow
 * if EXP_DOWN <= v <= EXP_UP, uses nfNormal
 * if EXP_UP < v, uses nfAbove
 *
 * nfBelow, nfNormal and nfAbove will be generated base on the precision_ parameter.
 *
 * @author: DUONG Phu-Hiep
 */
public class DoubleFormatter
{
    private static final double EXP_DOWN = 1.e-3;
    private double EXP_UP; // always = 10^maxInteger
    private int maxInteger_;
    private int maxFraction_;
    private NumberFormat nfBelow_;
    private NumberFormat nfNormal_;
    private NumberFormat nfAbove_;

    private enum NumberFormatKind {Below, Normal, Above}

    public DoubleFormatter(int maxInteger, int maxFraction){
        setPrecision(maxInteger, maxFraction);
    }

    public void setPrecision(int maxInteger, int maxFraction){
        Preconditions.checkArgument(maxFraction>=0);
        Preconditions.checkArgument(maxInteger>0 && maxInteger<17);

        if (maxFraction == maxFraction_ && maxInteger_ == maxInteger) {
            return;
        }

        maxFraction_ = maxFraction;
        maxInteger_ = maxInteger;
        EXP_UP =  Math.pow(10, maxInteger);
        nfBelow_ = createNumberFormat(NumberFormatKind.Below);
        nfNormal_ = createNumberFormat(NumberFormatKind.Normal);
        nfAbove_ = createNumberFormat(NumberFormatKind.Above);
    }

    private NumberFormat createNumberFormat(NumberFormatKind kind) {

        // If you do not use the Guava library, replace it with createSharp(precision);
        final String sharpByPrecision = Strings.repeat("#", maxFraction_);

        NumberFormat f = NumberFormat.getInstance(Locale.US);

        // Apply bankers' rounding:  this is the rounding mode that
        // statistically minimizes cumulative error when applied
        // repeatedly over a sequence of calculations
        f.setRoundingMode(RoundingMode.HALF_EVEN);

        if (f instanceof DecimalFormat) {
            DecimalFormat df = (DecimalFormat) f;
            DecimalFormatSymbols dfs = df.getDecimalFormatSymbols();

            // Set group separator to space instead of comma

            //dfs.setGroupingSeparator(' ');

            // Set Exponent symbol to minus 'e' instead of 'E'
            if (kind == NumberFormatKind.Above) {
                dfs.setExponentSeparator("e+"); //force to display the positive sign in the exponent part
            } else {
                dfs.setExponentSeparator("e");
            }

            df.setDecimalFormatSymbols(dfs);

            // Use exponent format if v is outside of [EXP_DOWN,EXP_UP]

            if (kind == NumberFormatKind.Normal) {
                if (maxFraction_ == 0) {
                    df.applyPattern("#,##0");
                } else {
                    df.applyPattern("#,##0."+sharpByPrecision);
                }
            } else {
                if (maxFraction_ == 0) {
                    df.applyPattern("0E0");
                } else {
                    df.applyPattern("0."+sharpByPrecision+"E0");
                }
            }
        }
        return f;
    }

    public String format(double v) {
        if (Double.isNaN(v)) {
            return "-";
        }
        if (v==0) {
            return "0";
        }
        final double absv = Math.abs(v);

        if (absv<EXP_DOWN) {
            return nfBelow_.format(v);
        }

        if (absv>EXP_UP) {
            return nfAbove_.format(v);
        }

        return nfNormal_.format(v);
    }

    /**
     * Format and higlight the important part (integer part & exponent part)
     */
    public String formatHtml(double v) {
        if (Double.isNaN(v)) {
            return "-";
        }
        return htmlize(format(v));
    }

    /**
     * This is the base alogrithm: create a instance of NumberFormat for the value, then format it. It should
     * not be used to format a great numbers of value
     *
     * We will never use this methode, it is here only to understanding the Algo principal:
     *
     * format v to string. precision_ is numbers of digits after decimal.
     * if EXP_DOWN <= abs(v) <= EXP_UP, display the normal format: 124.45678
     * otherwise display scientist format with: 1.2345e+30
     *
     * pre-condition: precision >= 1
     */
    @Deprecated
    public String formatInefficient(double v) {

        // If you do not use Guava library, replace with createSharp(precision);
        final String sharpByPrecision = Strings.repeat("#", maxFraction_);

        final double absv = Math.abs(v);

        NumberFormat f = NumberFormat.getInstance(Locale.US);

        // Apply bankers' rounding:  this is the rounding mode that
        // statistically minimizes cumulative error when applied
        // repeatedly over a sequence of calculations
        f.setRoundingMode(RoundingMode.HALF_EVEN);

        if (f instanceof DecimalFormat) {
            DecimalFormat df = (DecimalFormat) f;
            DecimalFormatSymbols dfs = df.getDecimalFormatSymbols();

            // Set group separator to space instead of comma

            dfs.setGroupingSeparator(' ');

            // Set Exponent symbol to minus 'e' instead of 'E'

            if (absv>EXP_UP) {
                dfs.setExponentSeparator("e+"); //force to display the positive sign in the exponent part
            } else {
                dfs.setExponentSeparator("e");
            }
            df.setDecimalFormatSymbols(dfs);

            //use exponent format if v is out side of [EXP_DOWN,EXP_UP]

            if (absv<EXP_DOWN || absv>EXP_UP) {
                df.applyPattern("0."+sharpByPrecision+"E0");
            } else {
                df.applyPattern("#,##0."+sharpByPrecision);
            }
        }
        return f.format(v);
    }

    /**
     * Convert "3.1416e+12" to "<b>3</b>.1416e<b>+12</b>"
     * It is a html format of a number which highlight the integer and exponent part
     */
    private static String htmlize(String s) {
        StringBuilder resu = new StringBuilder("<b>");
        int p1 = s.indexOf('.');

        if (p1>0) {
            resu.append(s.substring(0, p1));
            resu.append("</b>");
        } else {
            p1 = 0;
        }

        int p2 = s.lastIndexOf('e');
        if (p2>0) {
            resu.append(s.substring(p1, p2));
            resu.append("<b>");
            resu.append(s.substring(p2, s.length()));
            resu.append("</b>");
        } else {
            resu.append(s.substring(p1, s.length()));
            if (p1==0){
                resu.append("</b>");
            }
        }
        return resu.toString();
    }
} 
```

注意：我使用了[Guava](https://en.wikipedia.org/wiki/Google_Guava)库中的两个函数。如果您不使用 Guava，请自行编写代码：

```
/**
 * Equivalent to Strings.repeat("#", n) of the Guava library:
 */
private static String createSharp(int n) {
    StringBuilder sb = new StringBuilder();
    for (int i=0; i<n; i++) {
        sb.append('#');
    }
    return sb.toString();
} 
```

* * *

## 回答 #15

> 赞同：4
> 
> 时间：2013-01-11T06:33:14.600

```
String s = String.valueof("your int variable");
while (g.endsWith("0") && g.contains(".")) {
    g = g.substring(0, g.length() - 1);
    if (g.endsWith("."))
    {
        g = g.substring(0, g.length() - 1);
    }
} 
```

* * *

## 回答 #16

> 赞同：4
> 
> 时间：2015-04-23T06:59:50.130

您说您**选择使用***double 类型*存储您的号码。我认为这可能是问题的根源，因为它迫使您将*整数*存储为双精度数（因此丢失了有关值性质的初始信息）。将您的数字存储在[Number](http://docs.oracle.com/javase/7/docs/api/java/lang/Number.html)类（Double 和 Integer 的超类）的实例中并依靠多态性来确定每个数字的正确格式怎么样？

我知道因此重构代码的整个部分可能是不可接受的，但它可以在没有额外代码/转换/解析的情况下产生所需的输出。

例子：

```
import java.util.ArrayList;
import java.util.List;

public class UseMixedNumbers {

    public static void main(String[] args) {
        List<Number> listNumbers = new ArrayList<Number>();

        listNumbers.add(232);
        listNumbers.add(0.18);
        listNumbers.add(1237875192);
        listNumbers.add(4.58);
        listNumbers.add(0);
        listNumbers.add(1.2345);

        for (Number number : listNumbers) {
            System.out.println(number);
        }
    }

} 
```

将产生以下输出：

```
232
0.18
1237875192
4.58
0
1.2345 
```

* * *

## 回答 #17

> 赞同：2
> 
> 时间：2018-04-11T17:45:13.983

这就是我想出的：

```
 private static String format(final double dbl) {
    return dbl % 1 != 0 ? String.valueOf(dbl) : String.valueOf((int) dbl);
  } 
```

它是一个简单的单行代码，只有在确实需要时才转换为 int。

* * *

## 回答 #18

> 赞同：2
> 
> 时间：2019-09-11T11:34:06.267

**使用分组、舍入和没有不必要的零（双精度）格式化价格。**

规则：

1.  末尾没有零 ( `2.0000 = 2; 1.0100000 = 1.01`)
2.  点后最多两位数 ( `2.010 = 2.01; 0.20 = 0.2`)
3.  点后第 2 位四舍五入 ( `1.994 = 1.99; 1.995 = 2; 1.006 = 1.01; 0.0006 -> 0`)
4.  返回`0`( `null/-0 = 0`)
5.  添加`$`( `= $56/-$56`)
6.  分组 ( `101101.02 = $101,101.02`)

更多示例：

> `-99.985 = -$99.99`
> 
> `10 = $10`
> 
> `10.00 = $10`
> 
> `20.01000089 = $20.01`

它是用[Kotlin](https://en.wikipedia.org/wiki/Kotlin_(programming_language))编写的，作为 Double 的有趣扩展（因为它在 Android 中使用），但它可以很容易地转换为 Java，因为使用了 Java 类。

```
/**
 * 23.0 -> $23
 *
 * 23.1 -> $23.1
 *
 * 23.01 -> $23.01
 *
 * 23.99 -> $23.99
 *
 * 23.999 -> $24
 *
 * -0.0 -> $0
 *
 * -5.00 -> -$5
 *
 * -5.019 -> -$5.02
 */
fun Double?.formatUserAsSum(): String {
    return when {
        this == null || this == 0.0 -> "$0"
        this % 1 == 0.0 -> DecimalFormat("$#,##0;-$#,##0").format(this)
        else -> DecimalFormat("$#,##0.##;-$#,##0.##").format(this)
    }
} 
```

如何使用：

```
var yourDouble: Double? = -20.00
println(yourDouble.formatUserAsSum()) // will print -$20

yourDouble = null
println(yourDouble.formatUserAsSum()) // will print $0 
```

**关于 DecimalFormat**：[https ://docs.oracle.com/javase/6/docs/api/java/text/DecimalFormat.html](https://docs.oracle.com/javase/6/docs/api/java/text/DecimalFormat.html)

* * *

## 回答 #19

> 赞同：2
> 
> 时间：2019-12-05T10:14:27.067

对于 Kotlin，您可以使用如下扩展：

```
fun Double.toPrettyString() =
    if(this - this.toLong() == 0.0)
        String.format("%d", this.toLong())
    else
        String.format("%s", this) 
```

* * *

## 回答 #20

> 赞同：1
> 
> 时间：2020-05-14T15:07:35.187

**这是另一个答案，它可以选择仅**在十进制不为零时才附加十进制。

```
 /**
     * Example: (isDecimalRequired = true)
     * d = 12345
     * returns 12,345.00
     *
     * d = 12345.12345
     * returns 12,345.12
     *
     * ==================================================
     * Example: (isDecimalRequired = false)
     * d = 12345
     * returns 12,345 (notice that there's no decimal since it's zero)
     *
     * d = 12345.12345
     * returns 12,345.12
     *
     * @param d float to format
     * @param zeroCount number decimal places
     * @param isDecimalRequired true if it will put decimal even zero,
     * false will remove the last decimal(s) if zero.
     */
    fun formatDecimal(d: Float? = 0f, zeroCount: Int, isDecimalRequired: Boolean = true): String {
        val zeros = StringBuilder()

        for (i in 0 until zeroCount) {
            zeros.append("0")
        }

        var pattern = "#,##0"

        if (zeros.isNotEmpty()) {
            pattern += ".$zeros"
        }

        val numberFormat = DecimalFormat(pattern)

        var formattedNumber = if (d != null) numberFormat.format(d) else "0"

        if (!isDecimalRequired) {
            for (i in formattedNumber.length downTo formattedNumber.length - zeroCount) {
                val number = formattedNumber[i - 1]

                if (number == '0' || number == '.') {
                    formattedNumber = formattedNumber.substring(0, formattedNumber.length - 1)
                } else {
                    break
                }
            }
        }

        return formattedNumber
    } 
```

* * *

## 回答 #21

> 赞同：1
> 
> 时间：2021-09-06T15:45:53.067

考虑到语言环境的简单解决方案：

```
double d = 123.45;
NumberFormat numberFormat = NumberFormat.getInstance(Locale.GERMANY);
System.out.println(numberFormat.format(d)); 
```

由于在德国使用逗号作为小数分隔符，上面将打印：

> 123,45

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2013-05-18T23:03:38.007

这里有两种方法来实现它。首先，更短（可能更好）的方式：

```
public static String formatFloatToString(final float f)
{
  final int i = (int)f;
  if(f == i)
    return Integer.toString(i);
  return Float.toString(f);
} 
```

这是更长且可能更糟糕的方式：

```
public static String formatFloatToString(final float f)
{
  final String s = Float.toString(f);
  int dotPos = -1;
  for(int i=0; i<s.length(); ++i)
    if(s.charAt(i) == '.')
    {
      dotPos = i;
      break;
    }

  if(dotPos == -1)
    return s;

  int end = dotPos;
  for(int i = dotPos + 1; i<s.length(); ++i)
  {
    final char c = s.charAt(i);
    if(c != '0')
      end = i + 1;
  }
  final String result = s.substring(0, end);
  return result;
} 
```

* * *

## 回答 #23

> 赞同：0
> 
> 时间：2017-07-25T11:45:23.903

```
public static String fmt(double d) {
    String val = Double.toString(d);
    String[] valArray = val.split("\\.");
    long valLong = 0;
    if(valArray.length == 2) {
        valLong = Long.parseLong(valArray[1]);
    }
     if (valLong == 0)
        return String.format("%d", (long) d);
    else
        return String.format("%s", d);
} 
```

我不得不使用它，因为`d == (long)d`在[SonarQube](https://en.wikipedia.org/wiki/SonarQube)报告中给了我违规行为。

* * *

## 回答 #24

> 赞同：0
> 
> 时间：2020-10-26T16:35:19.137

我在我们的[JSF](https://en.wikipedia.org/wiki/JavaServer_Faces)应用程序中使用它来格式化数字而不用尾随零。原始的内置格式化程序要求您指定最大小数位数，这在您有太多小数位数的情况下也很有用。

```
/**
 * Formats the given Number as with as many fractional digits as precision
 * available.<br>
 * This is a convenient method in case all fractional digits shall be
 * rendered and no custom format / pattern needs to be provided.<br>
 * <br>
 * This serves as a workaround for {@link NumberFormat#getNumberInstance()}
 * which by default only renders up to three fractional digits.
 *
 * @param number
 * @param locale
 * @param groupingUsed <code>true</code> if grouping shall be used
 *
 * @return
 */
public static String formatNumberFraction(final Number number, final Locale locale, final boolean groupingUsed)
{
    if (number == null)
        return null;

    final BigDecimal bDNumber = MathUtils.getBigDecimal(number);

    final NumberFormat numberFormat = NumberFormat.getNumberInstance(locale);
    numberFormat.setMaximumFractionDigits(Math.max(0, bDNumber.scale()));
    numberFormat.setGroupingUsed(groupingUsed);

    // Convert back for locale percent formatter
    return numberFormat.format(bDNumber);
}

/**
 * Formats the given Number as percent with as many fractional digits as
 * precision available.<br>
 * This is a convenient method in case all fractional digits shall be
 * rendered and no custom format / pattern needs to be provided.<br>
 * <br>
 * This serves as a workaround for {@link NumberFormat#getPercentInstance()}
 * which does not renders fractional digits.
 *
 * @param number Number in range of [0-1]
 * @param locale
 *
 * @return
 */
public static String formatPercentFraction(final Number number, final Locale locale)
{
    if (number == null)
        return null;

    final BigDecimal bDNumber = MathUtils.getBigDecimal(number).multiply(new BigDecimal(100));

    final NumberFormat percentScaleFormat = NumberFormat.getPercentInstance(locale);
    percentScaleFormat.setMaximumFractionDigits(Math.max(0, bDNumber.scale() - 2));

    final BigDecimal bDNumberPercent = bDNumber.multiply(new BigDecimal(0.01));

    // Convert back for locale percent formatter
    final String strPercent = percentScaleFormat.format(bDNumberPercent);

    return strPercent;
} 
```

* * *

## 回答 #25

> 赞同：0
> 
> 时间：2022-02-15T21:57:31.673

使用给定的十进制长度...

```
public static String getLocaleFloatValueDecimalWithLength(Locale loc, float value, int length) {
        //make string from float value
        return String.format(loc, (value % 1 == 0 ? "%.0f" : "%."+length+"f"), value);
    } 
```

* * *

## 回答 #26

> 赞同：-1
> 
> 时间：2013-05-23T18:41:32.950

这是一个实际有效的答案（此处结合不同的答案）

```
public static String removeTrailingZeros(double f)
{
    if(f == (int)f) {
        return String.format("%d", (int)f);
    }
    return String.format("%f", f).replaceAll("0*$", "");
} 
```

* * *

## 回答 #27

> 赞同：-4
> 
> 时间：2012-05-09T09:04:15.873

最好的方法如下：

```
public class Test {

    public static void main(String args[]){
        System.out.println(String.format("%s something", new Double(3.456)));
        System.out.println(String.format("%s something", new Double(3.456234523452)));
        System.out.println(String.format("%s something", new Double(3.45)));
        System.out.println(String.format("%s something", new Double(3)));
    }
} 
```

输出：

```
3.456 something
3.456234523452 something
3.45 something
3.0 something 
```

唯一的问题是最后一个没有删除 .0 的问题。但是，如果您能够忍受这种情况，那么这种方法效果最好。%.2f 会将其四舍五入到最后两位小数。DecimalFormat 也是如此。如果您需要所有小数位，但不需要尾随零，那么这效果最好。

* * *

## 回答 #28

> 赞同：-10
> 
> 时间：2011-10-26T12:39:25.663

```
String s = "1.210000";
while (s.endsWith("0")){
    s = (s.substring(0, s.length() - 1));
} 
```

这将使字符串丢弃拖尾 0-s。

# mediawiki - 以某种方式从维基百科 XML 文件中删除内部链接？

> ID：703399
> 
> 赞同：0
> 
> 时间：2009-03-31T22:55:30.597
> 
> 标签：mediawiki, wikipedia, populate

如果我下载了 Wikipedia XML 转储，有没有办法从 XML 文件中删除所有内部链接？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-31T23:02:39.703

Wikipedia 数据库转储和有关使用它们的信息位于此处：[Wikipedia:Database download](http://en.wikipedia.org/wiki/Wikipedia:Database_download)。您应该这样做，而不是编写脚本来抓取 Wikipedia。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-01T03:29:18.737

如果要将它们导入本地 wiki，您可以做的一件事是导入您想要的所有文件，然后使用机器人（例如[pywikipediabot](http://pywikipediabot.sourceforge.net/)易于使用）来删除所有内部链接。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-04T00:35:36.333

我会尝试使用 XSLT 将 XML 文件转换为另一个 XML 文件。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-04-01T03:31:09.980

您可以在您最喜欢的文本编辑器中进行搜索和替换，将 [[ 和 ]] 替换为空。

# git - 如何重置 git 远程跟踪分支？

> ID：703403
> 
> 赞同：3
> 
> 时间：2009-03-31T22:55:51.313
> 
> 标签：git

在[另一个问题](https://stackoverflow.com/questions/702980/why-is-git-cvsimport-missing-one-major-patchset)中，建议我尝试将远程跟踪分支重置为较早的提交并再次执行导入。我不知道该怎么做！我可以重置 master，但不能重置 master 正在跟踪的分支 cvs/master。

如果我签出 cvs/master，我不在分支上，所以 git-reset 基本上没有效果。

如何更改 cvs/master（或任意远程跟踪分支）引用的提交？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-31T23:18:46.157

您是否尝试过：创建一个针对该远程分支的本地分支，根据您的需要重置或重新设置此本地分支，使用 -f 选项（强制）推送本地分支？

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-01T00:55:26.547

git-cvsimport 远程分支有点假，所以我认为你可以在你的 .git 目录中编辑适当的文件（在这种情况下是 .git/refs/remotes/cvs/master ）并把我要的适当的提交放在文件。我不确定这是否会解决您其他问题中的问题...

# javascript - IE8——JS的异步验证？

> ID：703404
> 
> 赞同：2
> 
> 时间：2009-03-31T22:58:07.530
> 
> 标签：javascript, jquery, debugging, internet-explorer-8, race-condition

所以我在 ie8 中使用 jquery 和各种 javascript 文件看到了一些奇怪的问题。这些错误不会发生在 Firefox、Safari 或以前版本的 IE 中。发生的主要事情是变量未定义、括号不匹配错误等……但是每次您强制刷新页面时，错误都会发生变化。检查引用的文件没有发现这样的语法错误。

我的问题是，首先，有没有其他人看到过这样的错误？它似乎类似于异步事件的问题。这是否与 IE8 中新的多进程/多线程浏览功能有关？IE 8 是否会在 js 文件下载后立即对其进行某种验证？

提前致谢。

更新：看起来它正在将接收到的 js 文件的元素改组到一个更大的 js 文件中。在调试器中，它显示了来自一个文件的方法，就在另一个文件的代码中间。找不到“导入”段所依赖的代码。不知道这里发生了什么......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-01T00:31:39.960

因此，事实证明，指定 mime 类型为“application/javascript”而不是“text/javascript”是一个问题。应用程序让 ie8 变得疯狂......并且认为我们首先使用应用程序来解决以前的 ie 版本错误。

# video - 使用 J2ME 在 n95 中更改视频分辨率

> ID：703419
> 
> 赞同：1
> 
> 时间：2009-03-31T23:02:14.387
> 
> 标签：video, java-me, camera, nokia, n95

我们已经尝试使用捕获 url 中的参数，如记录：

捕获：//video?height=480&width=360

宽度和高度的组合不起作用。创建播放器时，我们总是会收到错误 -6。

capture://video 工作正常，但视频小得离谱。

N95能拍出更高的分辨率吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-01T00:26:28.910

-6 是以下 Symbian C++ 错误代码：KErrArgument 参数超出范围。

至少，这是有道理的。

您可能可以在诺基亚 JavaME 开发人员库中找到您的答案： [http ://www.forum.nokia.com/Resources_and_Information/Documentation/Java/](http://www.forum.nokia.com/Resources_and_Information/Documentation/Java/)

类似“注意：S60 第 3 版 FP2：所有 FP2 产品都支持 QCIF (176x144) 分辨率。某些设备可能支持其他分辨率，例如 CIF (352x288)、QVGA (320x240) 和 VGA (640x480)。”

给你一些具体的值来尝试。

请注意，您可能需要在捕获 url 中指定像“video/3gp”这样的编码。

# asp.net - 如何让 IIS 独立于我的网站的其余部分来编译特定文件夹？

> ID：703422
> 
> 赞同：1
> 
> 时间：2009-03-31T23:03:09.983
> 
> 标签：asp.net, compiler-construction

有没有办法让 ASP.Net 独立编译不同的文件夹？

我有一个使用一些商业软件的 Web 应用程序。该软件的管理 UI 位于一个文件夹中——总共有大约 1,000 个文件。（我已经看过了——它不是有史以来最伟大的代码......）

这个文件夹需要很*长时间*才能构建。如果我明确构建，它...慢慢...编译..子文件夹...之后...子文件夹...如果我将站点作为网站项目（而不是 Web 应用程序项目 - 所以没有显式构建），我已经等待了*四五分钟*来刷新一个简单的代码更改页面。

有时它只是卡住了——我会一直等下去，我会按 F5 咯咯地笑，然后——砰！——就在那里。它显然是在最后 10 分钟的某个时间编译的，但忘记告诉浏览器...

如何从常规编译中获取此文件夹？我从来没有在这里改变任何东西，我希望 ASP.Net 将把该死的东西编译成一个程序集，然后*不管它。*

可能的？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-02T03:18:46.727

也许这太明显了，但是... 拉出那个文件夹并使用它自己的 web.config 为它创建一个单独的网站项目。

如果没有它，你肯定不能让 IIS 以不同的方式处理文件夹……它是处理动态编译的 ASP.NET 引擎，IIS 对此一无所知。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-31T23:05:38.417

为什么不使用[`aspnet_compiler`](http://msdn.microsoft.com/en-us/library/ms229863(VS.80).aspx)预编译应用程序？它**确实**适用于网站项目以及 Web 应用程序项目，并且可以预编译 ASP.NET 应用程序中的几乎所有内容。

# php - 如何获取 Drupal 页面的完整 URL？

> ID：703426
> 
> 赞同：49
> 
> 时间：2009-03-31T23:04:32.540
> 
> 标签：php, drupal, content-management-system

我需要在 Drupal 站点中获取当前页面的 URL。它是什么内容类型并不重要——可以是任何类型的节点。

我不是在寻找主题路径、基本 url 或 Drupal 的 get_destination。我正在寻找一个函数或变量，它将完整地为我提供以下信息：

[http://example.com/node/number](http://example.com/node/number)

有或没有（更有可能）`http://`.

* * *

## 回答 #1

> 赞同：55
> 
> 时间：2009-04-01T00:30:17.903

[drupal_get_destination()](http://api.drupal.org/api/function/drupal_get_destination/6)有一些内部代码指向正确的位置以获取当前内部路径。要将路径转换为绝对 URL，[url()](http://api.drupal.org/api/function/url/6)函数应该可以解决问题。如果传入“绝对”选项，它将生成完整的 URL，而不仅仅是内部路径。它还将交换当前路径的任何路径别名。

```
$path = isset($_GET['q']) ? $_GET['q'] : '<front>';
$link = url($path, array('absolute' => TRUE)); 
```

* * *

## 回答 #2

> 赞同：37
> 
> 时间：2009-08-03T04:32:23.130

这是我发现有用的

```
global $base_root;
$base_root . request_uri(); 
```

返回查询字符串，它是核心中使用的：[page_set_cache()](http://api.drupal.org/api/function/page_set_cache/6)

* * *

## 回答 #3

> 赞同：19
> 
> 时间：2010-01-27T14:15:25.010

你也可以这样做：

```
$current_url = 'http://' .$_SERVER['HTTP_HOST'] . $_SERVER['REQUEST_URI']; 
```

它有点快。

* * *

## 回答 #4

> 赞同：14
> 
> 时间：2009-04-03T13:56:18.350

尝试以下操作：

```
url($_GET['q'], array('absolute' => true)); 
```

* * *

## 回答 #5

> 赞同：12
> 
> 时间：2012-05-22T05:16:09.900

这个方法都是老方法，在drupal 7中我们可以很简单

```
 current_path() 
```

*   [http://example.com/node/306](http://example.com/node/306)返回“node/306”。
*   [http://example.com/drupalfolder/node/306](http://example.com/drupalfolder/node/306)返回“node/306”，而 base_path() 返回“/drupalfolder/”。
*   [http://example.com/path/alias](http://example.com/path/alias)（它是 node/306 的路径别名）返回“node/306”而不是路径别名。

和另一个差别很小的功能

```
request_path() 
```

*   [http://example.com/node/306](http://example.com/node/306)返回“node/306”。
*   [http://example.com/drupalfolder/node/306](http://example.com/drupalfolder/node/306)返回“node/306”，而 base_path() 返回“/drupalfolder/”。
*   [http://example.com/path/alias](http://example.com/path/alias)（这是 node/306 的路径别名）返回“path/alias”，而不是内部路径。
*   [http://example.com/index.php](http://example.com/index.php)返回一个空字符串（意思是：首页）。
*   [http://example.com/index.php?page=1](http://example.com/index.php?page=1)返回一个空字符串。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2012-09-20T13:03:37.503

我发现使用令牌非常干净。它被集成到 Drupal 7 的核心中。

```
<?php print token_replace('[current-page:url]'); ?> 
```

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2015-03-03T22:26:44.287

以下是更多*Drupal 风格*：

```
url(current_path(), array('absolute' => true)); 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2017-02-22T12:12:21.013

**对于 Drupal 8**，您可以这样做：

```
$url = 'YOUR_URL';
$url = \Drupal\Core\Url::fromUserInput('/' . $url,  array('absolute' => 'true'))->toString(); 
```

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2009-03-31T23:10:46.737

也许您想要的只是普通的旧预定义变量。

考虑尝试

```
$_SERVER['REQUEST_URI''] 
```

或者[在这里](http://lv.php.net/reserved.variables)阅读更多。

# iphone - 如何防止 iPhone NSNumberFormatter 舍入？

> ID：703428
> 
> 赞同：2
> 
> 时间：2009-03-31T23:05:15.813
> 
> 标签：iphone, objective-c, cocoa-touch

我正在尝试像这样格式化大货币数字：

```
NSNumber *testVal = [NSDecimalNumber decimalNumberWithString: @"999999999999999993.00"];
NSNumberFormatter *formatter = [[NSNumberFormatter alloc] init];
[formatter setNumberStyle:NSNumberFormatterCurrencyStyle];
[formatter setMaximumIntegerDigits:19];
[formatter setMaximumFractionDigits:0];
NSNumberFormatter *formatter = [Formatters numberFormatterForField:f];
NSLog([formatter stringFromNumber:testVal]); 
```

暂时忽略 Locale 的影响，我发现无论四舍五入如何，我都始终得到以下输出：

```
1,000,000,000,000,000,000 
```

我预计：

```
999,999,999,999,999,993 
```

我试过改变四舍五入但没有效果。为什么要`NSNumberFormatter`坚持四舍五入？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-31T23:15:18.037

`NSNumberFormatter`在显示之前将数字转换为双精度数，因此这不是您想要的。`NSDecimalNumber`有一种`descriptionWithLocale:`方法应该适合您的需求。

看到这个答案：[链接](https://stackoverflow.com/questions/421463/should-i-use-nsdecimalnumber-to-deal-with-money/422442)

# c++ - Visual Studio C++ 2008 win32 运行时问题中的调试与发布版本

> ID：703432
> 
> 赞同：1
> 
> 时间：2009-03-31T23:07:21.427
> 
> 标签：c++, visual-studio, debugging, winapi, winsock

当我在调试模式下编译和运行程序时，我有一个使用 win32 用 c++ 编写的简单 udp 侦听器，它运行良好，而且我清楚地能够从我收到的数据包中看到信息。当我运行与发布版本相同的代码时，它编译得很好并且似乎运行良好，但它没有像在发布版本下那样打印出任何数据包信息。我试图镜像构建配置以完全匹配，但它仍在发生。任何建议将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-31T23:12:25.627

输出有关数据包的调试信息的代码可能出于性能原因在发布版本中被删除。

这主要通过两件事来完成：

*   检查调试模式并在该模式下生成适当代码的条件预处理器指令。
*   链接到库的调试版本。

实际上，删除这些东西是您构建发布版本的主要目的。您不需要调试信息，因此您不会为此牺牲性能。如果您真的想这样做，那么您为什么不直接发布调试版本 [*更新：如评论中所述，似乎许可证不允许您分发与调试库链接的软件*]？这是最相似的配置（你不能得到更多相似而不是相同的配置，对吗？）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-01T00:06:12.203

这更有可能是没有将变量初始化为某个初始值的问题，因此在调试中它们具有某种值，但在发布中，大多数东西都被初始化为零（NULL）。因此，可能会发生一些您没想到的情况/分支……例如，如果没有您的源代码，就很难发现问题。

这让我不止一次.. :)

这是假设您不希望看到任何使用诸如[Mehrdad](https://stackoverflow.com/users/33708/mehrdad)建议的 OutputDebugString() 之类的东西...

另外，请确保您的数据包大小小于 1024 字节，否则您将无法获得它们。当 XP 出现时，我花了一段时间才弄清楚这个问题，我无法弄清楚为什么我的代码在 2000 上工作，而不是 XP ......即使 send (sendto) 会返回成功，它实际上从未发送过包..

无论如何，我在 Win32 上处理了很多 UDP，所以如果你给我一些示例代码，我应该能够提供更多帮助......

但无论如何，请检查您的所有变量是否已在发送方和接收方上初始化为某种默认值（这只是一个好习惯），然后重新构建它并重试。此外，在发送之前使用 sizeof() 检查您的数据包大小，如果它大于 1024 字节，请不要打扰......检查接收数据包的大小也是一个好主意，如果它不完全是大小你期望，然后丢弃数据包。这对于广播来说更是如此，但仍然适用。

让我知道这是否有帮助，不久前我在[另一个问题](https://stackoverflow.com/questions/390944/how-to-do-private-comms-between-private-apps-over-network/558279#558279)上发布了很多 UDP 代码，并且该代码有效，您可能想参考它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-31T23:57:47.153

你究竟是如何打印信息的？像 TRACE 这样的宏在发布版本中没有任何作用。

或者，如果您使用 fprintf 或类似的工具进行打印，则在您调用 fflush 之前它不一定会写入任何内容 - 调试版本可能会更频繁地为您执行此操作。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-07-16T19:56:53.590

迟到的答案，但可能是由 Windows 防火墙引起的。

# oracle - Oracle：程序在日期的 SELECT CASE 语句中未正确分叉

> ID：703449
> 
> 赞同：0
> 
> 时间：2009-03-31T23:12:35.173
> 
> 标签：oracle

我目前正在开展一个项目，该项目的行为取决于它是否是公共假期（显然还有其他限制）。为此，我正在尝试创建一个包含日期和星期几的表格（考虑到“假期”是“一周中的第八天”）。

我有一张表，我从中获取假期列表，名为`holiday`，它只有一个字段`holidaydate`（`DATE`数据类型）。我试图将值放入的表名为`daydates`，有两个字段，`day`（`DATE`数据类型）和`dayofweek`（`CHAR(10)`数据类型）。

这是我目前正在测试的逻辑。

```
 INSERT INTO holiday
  (holidaydate)
 SELECT sysdate FROM dual;

 SELECT sysdate,
   (
   CASE
     WHEN sysdate IN
       (SELECT h.holidaydate FROM holiday h)
     THEN 'holiday'  
     ELSE TO_CHAR(sysdate , 'day')
   END)
 FROM dual; 
```

不幸的是，它目前返回，比如“星期三”，而不是“假期”。我有一种感觉，我需要按照这些思路将其更改`WHEN sysdate IN`为 a`WHEN to_char (sysdate, 'dd-mon-yyyy') IN`或其他内容，但我尝试了一些变化，但到目前为止它们似乎没有奏效。

有什么建议么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-31T23:20:18.867

我认为你的问题是它几乎永远不会达到这种情况：

```
CASE
     WHEN sysdate IN
       (SELECT h.holidaydate FROM holiday h) 
```

因为，当您将**SYSDATE**插入到**假期**表中时，它会插入日期**和**时间信息。因此，您提到的案件几乎从未执行过。

尝试仅比较案件日期的重要部分。

```
CASE
   WHEN TRUNC(SYSDATE) IN (SELECT TRUNC(h.holidaydate) from holiday h) 
```

它应该工作。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-01T01:48:41.037

在您的假期表中，您只对日期感兴趣，而不对时间部分感兴趣。设置约束以强制执行此操作并阻止任何人犯您犯的相同错误：

```
CREATE TABLE HOLIDAY
(holidaydate  DATE NOT NULL 
              CONSTRAINT DateOnlyNoTime 
                 CHECK (holidayDate = TRUNC(holidayDate))); 
```

毫无疑问，您需要一个主键和一些其他列。

出于性能原因，删除日期的日期/时间部分的首选方法是如上所述使用 TRUNC() 而不是 TO_DATE()。您的示例查询将变为：

```
SELECT sysdate,
  (
  CASE
    WHEN TRUNC(sysdate) IN
      (SELECT h.holidaydate FROM holiday h)
    THEN 'holiday'
    ELSE TO_CHAR(sysdate , 'day')
  END)
FROM dual; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-31T23:18:22.477

你问的建议，所以...

*   您是否检查过第一条语句插入到假期表中的内容，以确保它是正确的？
*   您是否尝试过从`sysdate`图片中取出（例如使用常量）以查看是否是导致问题的原因？
*   您是否尝试过用常量列表替换内部选择？

# c# - IPrincipal 的文件和目录安全性

> ID：703450
> 
> 赞同：3
> 
> 时间：2009-03-31T23:12:44.360
> 
> 标签：c#, security, iprincipal

我需要通过 Directory.GetDirectories() 和 Directory.GetFiles() 方法访问当前 IPrincipal 可以访问的文件和目录，而不列出其他文件。该进程本身作为 NETWORK SERVICE 运行，因此在这些调用期间它必须将主体更改为当前用户（通过 IPrincipal）。

我试图在文件访问部分之前将 Thread.CurrentPrincipal 更改为新的 IPrincipal ，但它似乎没有任何区别。

还有什么我可以做的，还是我错过了什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-06T00:31:34.953

Windows 模拟通过使用登录详细信息获取用户令牌来解决此问题。然后可以使用此令牌获取 WindowsIdentity，然后使用该标识生成模拟上下文。在此上下文范围内，您可以*作为*模拟用户访问文件系统。

当然，您需要存储用户名和密码才能使这种方法起作用。

首先，定义从 Windows 获取用户令牌所需的 Windows API：

```
internal class WindowsAPI 
{
    public const int LOGON32_PROVIDER_DEFAULT = 0;
    public const int LOGON32_LOGON_INTERACTIVE = 2;

    [DllImport( "advapi32.dll", SetLastError = true, CharSet = CharSet.Unicode )]
    public static extern bool LogonUser( String lpszUsername, 
        String lpszDomain, String lpszPassword,
        int dwLogonType, int dwLogonProvider, ref IntPtr phToken 
    );

    [DllImport( "kernel32.dll", CharSet = CharSet.Auto )]
    public extern static bool CloseHandle( IntPtr handle );
} 
```

然后，使用这些 API 获取 WindowsIdentity：

```
private WindowsIdentity GetIdentity( string userName, string password )
{
    _userToken = IntPtr.Zero;

    if ( !WindowsAPI.LogonUser(
        userName,
        AbbGrainDomain,
        password,
        WindowsAPI.LOGON32_LOGON_INTERACTIVE, WindowsAPI.LOGON32_PROVIDER_DEFAULT,
        ref _userToken
    ) )
    {
        int errorCode = Marshal.GetLastWin32Error();
        throw new System.ComponentModel.Win32Exception( errorCode );
    }

    return new WindowsIdentity( _userToken );
} 
```

最后，使用此身份生成模拟上下文：

```
public List<string> GetDirectories( string searchPath )
{
    using ( WindowsImpersonationContext wic = GetIdentity().Impersonate() )
    {
        var directories = new List<string>();

        var di = new DirectoryInfo( searchPath );
        directories.AddRange( di.GetDirectories().Select( d => d.FullName ) );

        return directories;
    }
} 
```

最后，使用存储的 _userToken 使用 IDisposable 模式清理窗口句柄很重要：

```
if ( _userToken != IntPtr.Zero )
    WindowsAPI.CloseHandle( _userToken ); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-31T23:46:40.830

我不认为你这样做是正确的。您应该考虑使用模拟。例如，查看[本](http://www.netomatix.com/ImpersonateUser.aspx)教程以了解如何执行此操作。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-04-01T01:17:51.690

您可以使用 DllImport 和 LogonUser win32 API 来模拟另一个用户。

# c++ - 可选函数参数：使用默认参数（NULL）还是重载函数？

> ID：703453
> 
> 赞同：44
> 
> 时间：2009-03-31T23:15:20.360
> 
> 标签：c++, function, parameters, null, overloading

我有一个处理给定向量的函数，但如果没有给出，也可以自己创建这样的向量。

对于这种情况，我看到了两种设计选择，其中函数参数是可选的：

将其设为指针并`NULL`默认设为：

```
void foo(int i, std::vector<int>* optional = NULL) {
  if(optional == NULL){
    optional = new std::vector<int>();
    // fill vector with data
  }
  // process vector
} 
```

或者有两个具有重载名称的函数，其中一个省略了参数：

```
void foo(int i) {
   std::vector<int> vec;
   // fill vec with data
   foo(i, vec);
}

void foo(int i, const std::vector<int>& optional) {
  // process vector
} 
```

是否有理由更喜欢一种解决方案而不是另一种解决方案？

我稍微喜欢第二个，因为我可以将向量作为`const`参考，因为它在提供时只能读取，不能写入。此外，界面看起来更干净（`NULL`不仅仅是黑客？）。间接函数调用导致的性能差异可能已被优化掉。

然而，我经常在代码中看到第一个解决方案。除了程序员的懒惰之外，还有令人信服的理由喜欢它吗？

* * *

## 回答 #1

> 赞同：42
> 
> 时间：2009-04-01T02:45:34.067

我不会使用任何一种方法。

在这种情况下， foo() 的目的似乎是处理一个向量。也就是说，foo() 的工作是处理向量。

但在 foo() 的第二个版本中，它隐含地赋予了第二个工作：创建向量。foo() 版本 1 和 foo() 版本 2 之间的语义不同。

如果你需要这样的东西，我会考虑只使用一个 foo() 函数来处理向量，以及创建向量的另一个函数，而不是这样做。

例如：

```
void foo(int i, const std::vector<int>& optional) {
  // process vector
}

std::vector<int>* makeVector() {
   return new std::vector<int>;
} 
```

显然这些函数是微不足道的，如果所有 makeVector() 需要做的只是调用 new 来完成它的工作，那么使用 makeVector() 函数可能没有意义。但我敢肯定，在您的实际情况下，这些函数所做的远比这里显示的要多，我上面的代码说明了语义设计的一种基本方法：**让一个函数完成一项工作**。

我上面对 foo() 函数的设计也说明了我个人在代码中使用的另一种基本方法，当涉及到设计接口时——包括函数签名、类等。就是这样：我相信**一个好的接口是 1) 正确使用简单直观，以及 2) 难以或不可能错误使用**。在 foo() 函数的情况下，我们含蓄地说，在我的设计中，向量必须已经存在并且“准备好”。通过将 foo() 设计为获取引用而不是指针，调用者必须已经有一个向量是直观的，并且他们将很难传递一些不是现成向量的东西.

* * *

## 回答 #2

> 赞同：29
> 
> 时间：2009-03-31T23:23:07.207

我肯定会支持重载方法的第二种方法。

第一种方法（**可选参数**）模糊了方法的定义，因为它不再有一个明确定义的目的。这反过来又增加了代码的*复杂性*，使不熟悉它的人更难理解它。

使用第二种方法（**重载方法**），每个方法都有明确的目的。每种方法都*结构良好*且*具有凝聚力*。一些附加说明：

*   如果有代码需要复制到两个方法中，可以将其*提取到一个单独的方法中*，每个重载的方法都可以调用这个外部方法。
*   我会更进一步，以不同的方式*命名每种方法*，以表明这些方法之间的差异。这将使代码更具自我记录性。

* * *

## 回答 #3

> 赞同：21
> 
> 时间：2012-02-20T23:06:54.110

虽然我确实理解许多人对默认参数和重载的抱怨，但似乎对这些功能提供的好处缺乏了解。

**默认参数值：**
首先我想指出，在项目的初始设计中，如果设计得当，默认值应该很少甚至没有用处。然而，默认值的最大优势在于现有项目和完善的 API。我从事的项目包含数百万行现有代码，并且没有机会重新编写所有代码。因此，当您希望添加需要额外参数的新功能时；新参数需要一个默认值。否则，您将破坏使用您项目的每个人。这对我个人来说没问题，但我怀疑您的公司或您的产品/API 的用户是否会喜欢在每次更新时重新编码他们的项目。 **简单地说，默认值非常适合向后兼容！** 这通常是您会在大型 API 或现有项目中看到默认设置的原因。

**功能覆盖：功能覆盖** 的好处是它们允许共享功能概念，但具有不同的选项/参数。然而，很多时候我看到函数重写被懒惰地用来提供截然不同的功能，只是参数略有不同。在这种情况下，它们每个都应该具有单独命名的函数，与它们的特定功能有关（与 OP 的示例一样）。

这些 c/c++ 的特性很好，如果使用得当，效果很好。这可以说是大多数编程功能。正是当它们被滥用/误用时，它们才会引起问题。

**免责声明：**
我知道这个问题已经有几年的历史了，但是由于这些答案出现在我今天（2012 年）的搜索结果中，我觉得这需要为未来的读者进一步解决。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2012-11-28T17:27:28.403

在 C++ 中引用不能为 NULL，一个非常好的解决方案是使用 Nullable 模板。这会让你做的事情是 ref.isNull()

在这里你可以使用这个：

```
template<class T>
class Nullable {
public:
    Nullable() {
        m_set = false;
    }
    explicit
    Nullable(T value) {
        m_value = value;
        m_set = true;
    }
    Nullable(const Nullable &src) {
        m_set = src.m_set;
        if(m_set)
            m_value = src.m_value;
    }
    Nullable & operator =(const Nullable &RHS) {
        m_set = RHS.m_set;
        if(m_set)
            m_value = RHS.m_value;
        return *this;
    }
    bool operator ==(const Nullable &RHS) const {
        if(!m_set && !RHS.m_set)
            return true;
        if(m_set != RHS.m_set)
            return false;
        return m_value == RHS.m_value;
    }
    bool operator !=(const Nullable &RHS) const {
        return !operator==(RHS);
    }

    bool GetSet() const {
        return m_set;
    }

    const T &GetValue() const {
        return m_value;
    }

    T GetValueDefault(const T &defaultValue) const {
        if(m_set)
            return m_value;
        return defaultValue;
    }
    void SetValue(const T &value) {
        m_value = value;
        m_set = true;
    }
    void Clear()
    {
        m_set = false;
    }

private:
    T m_value;
    bool m_set;
}; 
```

现在你可以拥有

```
void foo(int i, Nullable<AnyClass> &optional = Nullable<AnyClass>()) {
   //you can do 
   if(optional.isNull()) {

   }
} 
```

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-03-31T23:22:43.337

我同意，我会使用两个功能。基本上，你有两个不同的用例，所以有两个不同的实现是有意义的。

我发现我编写的 C++ 代码越多，我拥有的参数默认值就越少 - 如果该功能被弃用，我不会真的流泪，尽管我将不得不重新编写大量旧代码！

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-03-31T23:23:10.873

我通常避免第一种情况。请注意，这两个功能的作用不同。其中一个用一些数据填充向量。另一个没有（只接受来自调用者的数据）。我倾向于命名实际上做不同事情的不同功能。事实上，即使在您编写它们时，它们也是两个函数：

*   `foo_default`（或只是`foo`）
*   `foo_with_values`

至少我发现这种区别在 long therm 中更清晰，对于偶尔的库/函数用户来说。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-03-31T23:22:10.813

我也更喜欢第二个。虽然两者之间没有太大区别，但您基本上是在重载中*使用*主要方法的功能，`foo(int i)`并且主要重载可以完美地工作，而无需关心是否缺少另一个，因此在重载版本。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-04-01T01:13:27.330

在 C++ 中，您应该尽可能避免允许有效的 NULL 参数。原因是它大大减少了调用站点文档。我知道这听起来很极端，但我使用的 API 需要超过 10-20 个参数，其中一半可以有效地为 NULL。生成的代码几乎不可读

```
SomeFunction(NULL, pName, NULL, pDestination); 
```

如果您将其切换为强制 const 引用，则代码只是被迫更具可读性。

```
SomeFunction(
  Location::Hidden(),
  pName,
  SomeOtherValue::Empty(),
  pDestination); 
```

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-07-02T10:25:31.697

我完全属于“超载”阵营。其他人添加了有关您的实际代码示例的细节，但我想添加我认为在一般情况下使用重载与默认值的好处。

*   任何参数都可以“默认”
*   如果覆盖函数对其默认值使用不同的值，则没有问题。
*   不必为现有类型添加“hacky”构造函数以允许它们具有默认值。
*   可以默认输出参数，而无需使用指针或 hacky 全局对象。

在每个上放置一些代码示例：

**可以默认任何参数：**

```
class A {}; class B {}; class C {};

void foo (A const &, B const &, C const &);

inline void foo (A const & a, C const & c)
{
  foo (a, B (), c);    // 'B' defaulted
} 
```

**没有覆盖具有不同默认值的函数的危险：**

```
class A {
public:
  virtual void foo (int i = 0);
};

class B : public A {
public:
  virtual void foo (int i = 100);
};

void bar (A & a)
{
  a.foo ();           // Always uses '0', no matter of dynamic type of 'a'
} 
```

**不必为现有类型添加“hacky”构造函数以允许它们被默认：**

```
struct POD {
  int i;
  int j;
};

void foo (POD p);     // Adding default (other than {0, 0})
                      // would require constructor to be added
inline void foo ()
{
  POD p = { 1, 2 };
  foo (p);
} 
```

**输出参数可以默认，而不需要使用指针或 hacky 全局对象：**

```
void foo (int i, int & j);  // Default requires global "dummy" 
                            // or 'j' should be pointer.
inline void foo (int i)
{
  int j;
  foo (i, j);
} 
```

规则重载与默认值的唯一例外是构造函数，构造函数当前无法转发给另一个构造函数。（我相信 C++ 0x 会解决这个问题）。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-03-31T23:49:33.930

我赞成第三种选择：分成两个函数，但不要重载。

从本质上讲，重载不太可用。他们要求用户了解两个选项并弄清楚它们之间的区别，如果他们愿意，还要检查文档或代码以确保哪个是哪个。

我将有一个带有参数的函数，以及一个称为“createVectorAndFoo”或类似名称的函数（显然，在遇到实际问题时命名变得更容易）。

虽然这违反了“函数的两个责任”规则（并给它一个长名称），但我相信当你的函数确实做了两件事（创建向量和 foo 它）时，这更可取。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-04-01T02:28:40.363

一般来说，我同意其他人使用双功能方法的建议。但是，如果在使用 1 参数形式时创建的向量始终相同，则可以通过将其设为静态并使用默认`const&`参数来简化事情：

```
// Either at global scope, or (better) inside a class
static vector<int> default_vector = populate_default_vector();

void foo(int i, std::vector<int> const& optional = default_vector) {
    ...
} 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-03-31T23:37:20.353

第一种方法较差，因为您无法判断您是否不小心传入了 NULL 或者是否是故意这样做的……如果这是一个意外，那么您很可能导致了一个错误。

使用第二个，您可以测试（断言，无论如何） NULL 并适当地处理它。

# .net - 从 ResponseStream Out of Memory Exception 创建内存流

> ID：703454
> 
> 赞同：1
> 
> 时间：2009-03-31T23:17:36.783
> 
> 标签：.net, memory, memory-leaks, memory-management, memorystream

我正在调用一个 httprequest，它在响应流中返回一个 pdf 文件。这适用于较小的 pdf，但文件不是大约 25-30MB，它返回内存不足异常。

```
 MemoryStream memStream = new MemoryStream();
        byte[] buffer = new byte[2048];

        int bytesRead = 0;
        do
        {
            bytesRead = _ResponseStream.Read(buffer, 0, buffer.Length);
            memStream.Write(buffer, 0, bytesRead);
        } while (bytesRead != 0);

        _ResponseStream.Close();
        _ResponseStream.Dispose();
        _ResponseStream = null;

        if (memStream.Length > 0)
            return memStream;
        else return null; 
```

机器规格为四核 3.0GZ，4GB RAM（物理盒）。PDF 有可能达到 60MB 的大小。多个用户可以同时下载。这将如何影响它？将响应流直接带到 FileStream 会更好吗？有没有这样做的最佳实践方法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-31T23:26:22.393

这应该没问题 - 60MB 对于`MemoryStream`. 每次需要时，容量都会翻倍，因此您可能有大约 120MB 的后备阵列，但这也不应该破坏一台像样的机器。

你确定输入数据不大于那个吗？你有多少内存？你能先找出响应流的大小吗？如果您可以创建`MemoryStream`具有正确能力的开始，那将有所帮助。

请注意，`using`语句更适合处理响应流 - 调用 Close 和 Dispose 然后将变量设置为 null 是多余的。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2009-04-04T03:28:21.097

似乎内存流确实在某个时候耗尽了内存。随着文件最终存储在文件系统上，我现在从 httpwebrequest 获取原始流，并将其直接保存到文件中。

# asp.net - 如何从 App_Code 中的 .vb 文件获取页面访问功能？

> ID：703457
> 
> 赞同：0
> 
> 时间：2009-03-31T23:18:41.880
> 
> 标签：asp.net

我在我们的网站上创建了一个新页面，该页面需要访问 App_Code/modFunctions.vb 中的一些功能。我尝试简单地调用这些函数，但它说在当前上下文中找不到。所以这里是文件位置，从站点的根目录开始：

```
/App_Code/ModFunctions.vb
/users/export.aspx 
```

export.aspx 是我的 C# 页面，我需要调用 ModFunctions.vb 中的函数，如何将它们链接在一起？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-31T23:21:58.770

您应该可以毫无问题地访问 App_Code 中的函数。确保使用命名空间对其进行限定或导入命名空间。

如果这对您不起作用，请发布有关您尝试的方式/内容的代码。

# linux - 如何在文本文件中逐行替换特定行？

> ID：703459
> 
> 赞同：5
> 
> 时间：2009-03-31T23:18:48.823
> 
> 标签：linux

我的 linux 机器上有一个 2GB 的文本文件，我正试图将它导入到我的数据库中。

我遇到的问题是正在处理此 rdf 文件的脚本在一行中阻塞：

```
mismatched tag at line 25462599, column 2, byte 1455502679:
<link r:resource="http://www.epuron.de/"/>
<link r:resource="http://www.oekoworld.com/"/>
</Topic>
=^ 
```

我想用`</Topic>`替换`</Line>`。我无法在所有行上进行搜索/替换，但我确实有行号，所以我希望有一些简单的方法可以用新文本替换那一行。

有什么想法/建议吗？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-03-31T23:23:35.427

```
sed -i yourfile.xml -e '25462599s!</Topic>!</Line>!' 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-03-31T23:23:08.360

```
sed -i '25462599 s|</Topic>|</Line>|' nameoffile.txt 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-03-31T23:59:53.093

在 Unix中编辑文本*文件*[`ed`](http://OpenGroup.Org/onlinepubs/009695399/utilities/ed.html)的工具被称为（而不是[`sed`](http://OpenGroup.Org/onlinepubs/009695399/utilities/sed.html)，顾名思义是*流编辑器*）。

`ed`曾经打算用作交互式编辑器，但它也可以轻松编写脚本。可行的方法`ed`是所有命令都采用地址参数。寻址特定行的方法只是行号，更改寻址行的方法是`s`命令，它采用相同的正则表达式`sed`。因此，要更改第 42 行，您可以编写类似`42s/old/new/`.

这是整个命令：

```
FILENAME=/path/to/whereever
LINENUMBER=25462599

ed -- "${FILENAME}" <<-HERE
    ${LINENUMBER}s!</Topic>!</Line>!
    w
    q
HERE 
```

这样做的优点`ed`是标准化，而`-i`标志 to`sed`是专有的 GNU 扩展，在许多系统上不可用。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-31T23:24:29.277

使用“head”获取前 25462598 行，使用“tail”获取其余行（从 25462601 开始）。虽然...对于 2GB 的文件，这可能需要一段时间。

您还确定问题出在该行而不是之前的某个地方（即错误看起来像 XML 解析错误，这可能意味着实际问题在其他地方）。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-01T10:15:15.877

我的外壳脚本：

```
#!/bin/bash
awk -v line=$1 -v new_content="$2" '{
        if (NR == line) {
                print new_content;
        } else {
                print $0;
        }
}' $3 
```

论据：

```
first: line number you want change
second: text you want instead original line contents
third: file name 
```

此脚本将输出打印到标准输出，然后您需要重定向。例子：

```
./script.sh 5 "New fifth line text!" file.txt 
```

例如，您可以通过注意所有参数都具有预期值来改进它。

# design-patterns - 工厂如何知道要创建哪种类型的对象？

> ID：703467
> 
> 赞同：16
> 
> 时间：2009-03-31T23:23:06.787
> 
> 标签：design-patterns, factory

我相信工厂方法设计模式适合我正在尝试做的事情，但我不确定赋予它多少责任（它创建的子类的知识）。在 Wikipedia上使用[工厂方法模式](http://en.wikipedia.org/wiki/Factory_method_pattern)的示例几乎完全描述了我所处的情况：

```
public class ImageReaderFactory 
{
    public static ImageReader getImageReader( InputStream is ) 
    {
        int imageType = figureOutImageType( is );

        switch( imageType ) 
        {
            case ImageReaderFactory.GIF:
                return new GifReader( is );
            case ImageReaderFactory.JPEG:
                return new JpegReader( is );
            // etc.
        }
    }
} 
```

我的问题是，这个`figureOutImageType`功能是什么样的？在这个特定示例中，我假设它检查文件头`InputStream`以确定数据的图像格式。我想知道它`ImageReaderFactory`本身是否知道如何解析文件头并确定文件类型是 GIF、JPEG等，或者如果它在每个`Reader`类中调用一个函数，让它知道它是什么类型的图像。像这样的东西，也许：

```
int figureOutImageType(InputStream is)
{
    if(GifReader.isGIF(is))
        return ImageReaderFactory.GIF;
    else if(JpegReader.isJPEG(is))
        return ImageReaderFactory.JPEG;
    // etc.
} 
```

似乎让工厂知道如何解析图像会破坏封装，让子类决定应该创建哪个是工厂方法设计模式的一部分。然而，这个函数似乎`figureOutImageType`也只是添加了一些冗余代码，因为为什么不让每个子类`InputStream`对`getImageReader`函数中的 进行检查并跳过 switch 案例呢？

我以前没有任何使用工厂的经验，我希望从过去使用过工厂的人那里获得一些关于处理这个问题的最佳方法的见解。让工厂知道其子类的内部工作是否可以，或者他们是否应该负责让工厂知道要创建哪个，以及如何组织它们？

谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-31T23:26:02.143

工厂应该对选择要创建的实际对象有所了解。例如，`WebRequest.Create`.NET 中的方法，应该能够通过检查 .NET 的协议部分来在不同的协议客户端之间进行选择`Uri`。它不需要解析整个事情。只是区分哪个类将负责它所需的部分（在您的示例中，它可能只是文件头）。

关于你关于打破封装的问题，不是真的......大多数时候，工厂是硬编码的，并且已经知道不同类型的类及其特性。它已经依赖于一组已知类提供的功能，因此您不会对其添加太多内容。您还可以将工厂的检测部分封装在另一个可以由工厂和子类使用的辅助类中（本着 DRY 原则的精神）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-01T00:11:35.157

两者都是有效的选择，具体取决于上下文。

如果您正在为可扩展性进行架构设计——比如针对不同 ImageReader 的插件模型——那么您的 Factory 类将无法了解所有可能的 ImageReader。在这种情况下，你走这`ImageReader.CanRead(ImageStream)`条路——询问每个实施者，直到你找到一个可以阅读它的人。

请注意，有时订购在这里很重要。您可能有一个可以处理 JPG 的 GenericImageReader，但 Jpeg2000ImageReader 更胜一筹。遍历 ImageReader 实现者将停在先到者处。如果这是一个问题，您可能希望查看对可能的 ImageReaders 列表进行排序。

否则，如果 ImageReaders 列表是有限的并且在您的控制之下，那么您可以采用更传统的工厂方法。在这种情况下，工厂决定创建什么。它已经通过 ctor 耦合到 ImageReader 的具体实现，因此为每个 ImageReader 添加规则不会增加耦合。如果选择 ImageReader 的逻辑主要在 ImageReader 本身中，那么为了避免重复代码，您仍然可以走这`ImageReader.CanRead(ImageStream)`条路 - 但它可能只是硬编码您走的类型。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-31T23:27:52.797

为了可扩展性，您可以将您提到的一些依赖项外部化。就像弄清楚它是什么类型的文件或将文件类型映射到处理它的类一样。外部注册表（即属性文件）将存储 GIF -> GifReader，或者更好的 GIF -> GifMetadataClass。然后您的代码可能是通用的，并且不依赖于所有类，而且您可以在将来扩展它，或者第三方可以扩展它。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-31T23:32:35.967

如果这是用于 Windows，我会尝试猜测内容类型，然后使用工厂。事实上，我前段时间就这样做了。

这是一个猜测文件内容类型的类：

```
using System;
using System.IO;
using System.Runtime.InteropServices;

namespace Nexum.Abor.Common
{
    /// <summary>
    /// This will work only on windows
    /// </summary>
    public class MimeTypeFinder
    {
        [DllImport(@"urlmon.dll", CharSet = CharSet.Auto)]
        private extern static UInt32 FindMimeFromData(
            UInt32 pBC,
            [MarshalAs(UnmanagedType.LPStr)] String pwzUrl,
            [MarshalAs(UnmanagedType.LPArray)] byte[] pBuffer,
            UInt32 cbSize,
            [MarshalAs(UnmanagedType.LPStr)]String pwzMimeProposed,
            UInt32 dwMimeFlags,
            out UInt32 ppwzMimeOut,
            UInt32 dwReserverd
        );

        public string getMimeFromFile(string filename)
        {
            if (!File.Exists(filename))
                throw new FileNotFoundException(filename + " not found");

            var buffer = new byte[256];
            using (var fs = new FileStream(filename, FileMode.Open))
            {
                if (fs.Length >= 256)
                    fs.Read(buffer, 0, 256);
                else
                    fs.Read(buffer, 0, (int)fs.Length);
            }
            try
            {
                UInt32 mimetype;
                FindMimeFromData(0, null, buffer, 256, null, 0, out mimetype, 0);
                var mimeTypePtr = new IntPtr(mimetype);
                var mime = Marshal.PtrToStringUni(mimeTypePtr);
                Marshal.FreeCoTaskMem(mimeTypePtr);
                return mime;
            }
            catch (Exception)
            {
                return "unknown/unknown";
            }
        }
    }
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-31T23:27:37.133

我会`CanReadFrom`在公共`ImageReader`接口中有一个静态方法（或其他东西）（不确定这是否可能——FIXME）。使用反射来获取所有实现者并调用函数。如果返回 true，则返回该类的一个实例。

# sharepoint - IAlertNotifyHandler 的 OnNotification() 返回值有什么作用？

> ID：703483
> 
> 赞同：1
> 
> 时间：2009-03-31T23:29:52.277
> 
> 标签：sharepoint, return-value, alerts

到目前为止，我已经使用[IAlertNotifyHandler](http://msdn.microsoft.com/en-us/library/microsoft.sharepoint.ialertnotifyhandler.aspx)接口为 SharePoint 2007 创建了许多自定义警报处理程序。使用此接口，您必须实现一个名为[OnNotification()](http://msdn.microsoft.com/en-us/library/microsoft.sharepoint.ialertnotifyhandler.onnotification.aspx)的方法，该方法具有以下签名：

```
bool OnNotification (SPAlertHandlerParams ahp); 
```

如您所见，此方法应返回一个布尔值。MSDN 官方文档列出了这个返回值的以下解释：

> **如果 Windows SharePoint Services 将通知标记为已处理，则为**true ；**否则**为假****

 **起初，我认为这意味着如果您返回*true* ，则向 SharePoint 发出信号，表明您的处理程序已完成所有警报处理，并且 SharePoint 不应执行其默认行为。但是，在实践中，处理警报的方式似乎没有任何区别。您可以返回*true*或*false*，这没有任何区别。

然后我用Reflector对源码进行了反汇编，可惜处理OnNotification返回值的代码不是托管的，而是原生的。

那么谁知道那个返回值是什么意思呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-07-15T23:19:49.460

我相信这仅在摘要警报（每日或每周摘要）的情况下被考虑，而不是在即时警报的情况下考虑。如果在处理摘要警报时返回 false，则相同的项目将在下一个摘要警报中发送给用户。

# css - 无法将 H1 标签与 CSS 左对齐？

> ID：703487
> 
> 赞同：2
> 
> 时间：2009-03-31T23:32:17.870
> 
> 标签：css

嗨，我似乎在尝试将 H1 标签与左侧对齐时遇到问题。我知道它在我的 template.css 文件中，但我不知道是什么。

[看看 >](http://www.digiflipconcepts.com/smokinhot/index.php?page=shop.product_details&product_id=19&flypage=flypage_smokin.tpl&pop=0&option=com_virtuemart&Itemid=5)

我希望任何 CSS 大师都应该很容易 ;)...

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-31T23:42:44.820

使用开发人员工具，如 Firefox 的 Firebug、Safari 的 WebInspector 或 IE 的开发人员工具来检查文档。这些可能会向您表明，它的`.previous_page`下边距会导致与`h1`.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-31T23:45:41.303

它击中了浮动的“上一页”链接并环绕它。它是左对齐的，但它看起来就像是居中的，因为它碰到了那个浮动。

尝试：

```
h1 { clear: left } 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-31T23:50:35.767

尝试将您的 h1 样式更改为：

```
#flypage h1 {
  float: left;
  margin-bottom: 20px;
  margin-top: 20px;
  text-align: left !important;
  width: 100%;
} 
```

# c# - C# (.NET) 中是否有更好的 Web 浏览器控件？

> ID：703498
> 
> 赞同：7
> 
> 时间：2009-03-31T23:42:16.630
> 
> 标签：c#, .net, asp.net, javascript

我需要 JavaScript 在我的应用程序中几乎完美地工作，它应该能够访问 Web 内容并让用户控制它。但是，webbrowser 组件会在 Internet Explorer 的单独实例/应用程序中弹出新窗口，并且 dotBrowser 无法正常使用 JavaScript。

请给我一些建议——我什至会举一些可行的例子，并用我需要的功能来增强它。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-03-31T23:46:59.613

看看[GeckoFX](http://code.google.com/p/geckofx/)，它是用于在 .NET 应用程序中嵌入 Mozilla Gecko (Firefox) 的开源组件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-01T02:17:12.483

我可能弄错了，但我相信可以使用 .NET 中的 Web 浏览器控件来控制（或至少抑制）新窗口。看看 NewWindow 事件。

我曾在 .NET winforms 应用程序中嵌入 WebKit（Apple Core，用于 Chrome）和 XULRunner（Gecko）核心。让我给你一些建议：

GeckoFX 是您最好的选择。它在 MPL 下获得许可，并且开箱即用。仔细按照说明操作并拉出指示的确切 XUL 版本。我会说它比 WebBrowser 控件工作得更好。有人说第一次加载 XUL 时会出现明显的延迟，但我发现它可以忽略不计。品牌等可通过外部文件完全定制。

WebKit 可嵌入 SwiftDotNet。如果您只需要可靠的 javascript 性能，那么这可能是一个选择。如果您需要能够下载文件，那么您需要完成一些工作。

这两条路线的缺点是令人讨厌的 ~7-8mb 开销，即使使用压缩（尽管我能够在 NSIS 中使用 lz 压缩获得 6.5mb）。如果您没有创建面向消费者的可分发软件，那么这对您来说可能不是问题。

# git - git branch -m 对其他开发人员有副作用吗？

> ID：703502
> 
> 赞同：8
> 
> 时间：2009-03-31T23:44:58.590
> 
> 标签：git, merge, branch

我们[已经学会了如何](https://stackoverflow.com/questions/21848/switch-branch-names-in-git)使用`git branch -m`. 如果我这样做，是否会让其他人从我的存储库中提取生活困难？

假设我在一个分支上做了一堆东西`topic1`然后做一个

```
git branch -m master old_master
git branch -m topic1 master
git push origin master 
```

然后其他人`master`从我的远程存储库中提取，他们必须做什么才能使所有内容都指向正确的位置？我必须告诉所有人重复我的步骤吗？

这是否类似于在推送它们并让其他开发人员留下悬空对象之后重新提交提交的问题？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-01T11:46:06.953

我不确定你的回购是什么样子，但这是最坏的情况。

假设您的`origin`存储库看起来像这样

```
起源：
o---o---A---B---C 大师

```

你的本地存储库看起来像这样，

```
吉姆普尔斯：
o---o---A---B---C 主控，起源/主控
         \
          D---E---F 话题1

```

然后，在您的分支重命名后，您的本地存储库如下所示：

```
吉姆普尔斯：
o---o---A---B---C old_master, origin/master
         \
          D---E---F主

```

现在，当你推动`master`那`origin`将是一个非快进更新。推送后，`origin`存储库将如下所示：

```
起源：
o---o---A...B...C（B & C 是孤立的提交）
         \
          D---E---F主

```

这对于可能在`C`. 例如，如果 Sally 与您合作，她的存储库可能如下所示：

```
莎莉：
o---o---A---B---C 原点/主控
                 \
                  G---H---我掌握

```

现在，如果您执行非快进推送，而 Sally 执行`fetch`她的存储库，则会如下所示：

```
莎莉：
          D---E---F 原点/主控
         /
o---o---A---B---C  
                 \
                  G---H---我掌握

```

现在 Sally 必须弄清楚如何将她的工作（G、H、I）恢复到存储库中。如果她只是进行合并，`origin/master`那么 B 和 C 中的更改将返回到存储库中（哎呀！）。相反，她将不得不`cherry-pick`或`rebase`她的 GHI 更改为`origin/master`.

Git 让你这样做很酷，但它有点自找麻烦。你真的希望莎莉注意到这种情况。这就是为什么您应该在执行此操作时警告所有其他贡献者，以便他们能够适当地处理更改。

**注意：**以上是最坏的情况。如果您的`topic1`分支从`master`C 出发，那么这种变化*是*快进的，没有问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-01T10:48:20.073

基本上你的操作是一样的：

```
# git checkout master
# git reset --hard topic1
# git push origin master 
```

他们会产生这种效果：其他人都会得到这个`topic1`分支（不过它是以他们的名字命名的）和它的祖先，`master`直到第一次分歧的地方。然后，旧分支就在他们的存储库中，将来某个时候将被垃圾收集，因为没有任何东西指向它了。`master``topic1``master`

如果`topic1`是一个起源于你们当前`HEAD`的分支，`master`在这里就可以了。否则，您将陷入“重写历史”的情况，这可能会使您的标签一团糟。您需要仔细考虑您真正想要实现的目标。也许一个简单的`git merge`会更好地为您服务？

# c++ - 哪个 STL 容器最适合 std::sort？（这还重要吗？）

> ID：703503
> 
> 赞同：15
> 
> 时间：2009-03-31T23:45:18.307
> 
> 标签：c++, stl, sorting

标题不言自明....

容器的选择是否会以某种方式影响默认 std::sort 算法的速度？例如，如果我使用列表，排序算法是只切换节点指针还是切换节点中的整个数据？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-04-01T00:00:55.650

选择确实会产生影响，但预测哪个容器最有效是非常困难的。最好的方法是使用对您的应用程序来说最容易使用的容器（可能是 std::vector），看看该容器的排序是否足够快，如果是的话，坚持使用它。如果没有，请对您的排序问题进行性能分析，并根据配置文件数据选择不同的容器。

作为一名前讲师和前培训师，我个人有时会为链表具有神秘的性能增强特性这一普遍观点负责。从一个知道的人那里知道：链表出现在这么多教科书和教程中的唯一原因是因为编写这些书和教程的人有一个可以说明指针、动态内存管理、递归的数据结构很方便，搜索和排序都在一个 - 它与效率无关。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-03-31T23:52:28.913

我认为不适`std::sort`用于列表，因为它需要一个随机访问迭代器，而`list<>`. 请注意，它`list<>`提供了一种`sort`方法，但它与`std::sort`.

容器的选择很重要。STL`std::sort`依赖迭代器来抽象出容器存储数据的方式。它只是使用您提供的迭代器来移动元素。这些迭代器在访问和分配元素方面工作得越快，`std::sort`工作的速度就越快。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-03-31T23:57:15.487

`std::list`绝对不是一个好的（有效的）选择`std::sort()`，因为`std::sort()`需要随机访问迭代器。 `std::map`和朋友也不好，因为一个元素的位置不能被强制执行；也就是说，地图中元素的位置不能由用户通过插入特定位置或交换来强制执行。在标准容器中，我们使用`std::vector`和`std::deque`.

`std::sort()``*t = *s`与其他标准算法一样，它仅通过在 ( )周围交换元素的值来起作用。因此，即使列表神奇地支持 O(1) 访问，链接也不会被重新组织，而是它们的值会被交换。

因为`std::sort()`不会改变容器的大小，所以无论您使用`std::vector`还是`std::deque`. 原始数组的排序也应该很快，甚至可能比标准容器更快——但我不认为速度上的差异足以证明使用它们是合理的。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-03-31T23:49:33.180

这取决于元素类型。

如果您只是存储指针（或 POD），那么 vector 将是最快的。如果您要存储对象，那么列表的排序会更快，因为它将交换节点而不是物理元素。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-31T23:53:09.367

排序算法对您的容器一无所知。它所知道的只是随机访问迭代器。因此，您可以对甚至不在 STL 容器中的内容进行排序。所以它的速度取决于你给它的迭代器，以及解引用和复制它们指向的东西的速度。

std::sort 不适用于 std::list，因为 sort 需要随机访问迭代器。对于这种情况，您应该使用 std::list 的成员函数排序之一。这些成员函数将有效地交换链表指针，而不是复制元素。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-02T12:56:22.487

向量。

始终使用矢量作为默认值。它具有任何其他容器最低的空间开销和最快的访问速度（以及其他优点，如 C 兼容布局和随机访问迭代器）。

现在，问问你自己——你还用你的容器做什么？您需要强大的异常保证吗？List、set 和 map 可能是更好的选择（尽管它们都有自己的排序例程）。您是否需要定期将元素添加到容器的前面？考虑双端队列。您的容器是否需要*始终*进行分类？Set 和 map 可能更合适。

最后，具体找出最适合您的“最佳”容器，然后选择最合适的容器并衡量它如何满足您的需求。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2016-11-29T13:55:11.543

我完全同意上面张贴的声明。但是学习新事物的最佳方法是什么？嘿！！！！当然不是阅读文本并用心学习，但是.... 示例：D 最近我沉浸在 STL 中指定的容器中，这是不言自明的快速测试代码，我希望：

```
#include <iostream>
#include <vector>
#include <deque>
#include <array>
#include <list>
#include <iterator>
#include <cstdlib>
#include <algorithm>
#include "Timer.h"

constexpr int SIZE = 1005000;

using namespace std;

void test();

int main(){
    cout<<"array allocates "<<static_cast<double>(SIZE)/(1024*1024)<<" MB\n";
    test();

    return 0;
}

void test(){
    int values[SIZE];
    int size = 0;

    //init values to sort:
    do{
        values[size++] = rand() % 100000;
    }while(size < SIZE);

    //feed array with values:
    array<int, SIZE> container_1;
    for(int i = 0; i < SIZE; i++)
        container_1.at(i) = values[i];

    //feed vector with values
    vector<int> container_2(begin(values), end(values));
    list<int> container_3(begin(values), end(values)); 
    deque<int> container_4(begin(values), end(values)); 

    //meassure sorting time for containers
    {
       Timer t1("sort array");
       sort(container_1.begin(), container_1.end());
    }

    {
       Timer t2("sort vector");
       sort(container_2.begin(), container_2.end());
    }

    {
       Timer t3("sort list");
       container_3.sort();
    }

    {
       Timer t4("sort deque");
       sort(container_4.begin(), container_4.end());
    }

} 
```

以及计时器的代码：

```
#include <chrono>
#include <string>
#include <iostream>

using namespace std;

class Timer{

public:
    Timer(string name = "unnamed") : mName(name){ mStart = chrono::system_clock::now();}
    ~Timer(){cout<<"action "<<mName<<" took: "<<
             chrono::duration_cast<chrono::milliseconds>(
                     chrono::system_clock::now() - mStart).count()<<"ms"<<endl;}
private:
    chrono::system_clock::time_point mStart;
    string mName;
}; 
```

这是不使用优化时的结果（*g++ --std=c++11 file.cpp -o a.out*）：

**数组分配 0.958443 MB
动作排序数组占用：183ms 动作
排序向量占用：316ms
动作排序列表占用：725ms
动作排序双端队列占用：436ms**

并进行优化（*g++ -O3 --std=c++11 file.cpp -o a.out*）：

**数组分配 0.958443 MB
动作排序数组占用：55ms
动作排序向量占用：
57ms 动作排序列表占用：264ms
动作排序双端队列占用：67ms**

请注意，尽管在这种情况下向量和数组具有相似的时间排序，但数组大小是有限的，因为它应该在堆栈上初始化（默认情况下，不使用自己的分配器等）

所以这也取决于你是否对编译器使用优化，如果没有，我们可能会看到明显的差异。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-03-31T23:59:07.650

这确实很重要，因为不同的容器具有不同的内存访问模式等，这可能会起作用。

但是，由于它们不是 RandomAccessIterators ，`std::sort`因此不起作用。`std::list<>::iterators`此外，尽管有可能实现一个专门化来`std::list<>`打乱节点的指针，但它可能会产生奇怪和令人惊讶的语义后果——例如。如果您在向量的排序范围内有一个迭代器，则它的值将在排序后发生变化，这对于这种专业化来说是不正确的。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-04-01T00:16:37.123

std::sort 需要随机访问迭代器，因此您唯一可以使用的选项是向量或双端队列。它将交换值，并且猜测向量的执行速度可能比双端队列稍快，因为它通常具有更简单的底层数据结构。不过，差异可能非常微不足道。

如果您使用 std::list，则有一个专门化 (std::list::sort) 应该交换指针而不是值。然而，由于它不是随机访问，它将使用合并排序而不是快速排序，这可能意味着算法本身要慢一些。

无论如何，我认为答案通常是矢量。如果每个元素都有大型类，因此复制开销支配了排序过程，那么 list 可能会击败它。或者，您可以将指向它们的指针存储在一个向量中，并提供一个自定义谓词来对它们进行适当的排序。

# wpf - 资源声明顺序改变时抛出异常

> ID：703510
> 
> 赞同：1
> 
> 时间：2009-03-31T23:48:20.127
> 
> 标签：wpf, resources

按此顺序声明资源时出现异常：

```
<Window.Resources>
    <sys:Object x:Key="resourceA"></sys:Object>

    <x:Array x:Key="resourceB" Type="sys:String">
        <sys:String>foo</sys:String>
    </x:Array>
</Window.Resources> 
```

当以这种方式声明时，一切正常：

```
<Window.Resources>
    <x:Array x:Key="resourceB" Type="sys:String">
        <sys:String>foo</sys:String>
    </x:Array>

    <sys:Object x:Key="resourceA"></sys:Object>
</Window.Resources> 
```

抛出的异常是：

> 无法将属性“ItemsSource”中的值转换为“System.Collections.IEnumerable”类型的对象。“System.Windows.Markup.ArrayExtension”不是属性“ItemsSource”的有效值。标记文件“WpfResourcesBug;component/window1.xaml”第 18 行位置 37 中的对象“System.Windows.Controls.ComboBox”出错。

完整代码：

```
<Window x:Class="WpfResourcesBug.Window1"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:sys="clr-namespace:System;assembly=mscorlib"
    Title="Window1" Height="300" Width="300">

    <Window.Resources>
        <sys:Object x:Key="resourceA"></sys:Object>

        <x:Array x:Key="resourceB" Type="sys:String">
            <sys:String>foo</sys:String>
        </x:Array>
    </Window.Resources>

    <StackPanel>
        <ComboBox SelectedIndex="0" ItemsSource="{StaticResource resourceB}" />
    </StackPanel>
</Window> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-01T01:42:02.847

[我想你可能会在这里](http://social.msdn.microsoft.com/Forums/en-US/wpf/thread/9db5f1f5-f3a9-402c-9869-08d3624eea59/)找到一个可能的解决方案

# winforms - 在 WinForm ListView 中取消 SelectedIndexChanged

> ID：703511
> 
> 赞同：1
> 
> 时间：2009-03-31T23:48:48.113
> 
> 标签：winforms, listview

winform ListView 似乎没有简单的方法来取消 SelectedIndexChanged 事件。我也没有看到 SelectedIndexChanging 事件。

代码是我的尝试。但是高光消失了，我想知道是否还需要为选择着色，或者是否有更好的取消方法。_prevSelectedIndex 是上次选择的索引。我希望突出显示返回到先前的选择。

```
 lvSearchResults.SelectedIndexChanged -= new EventHandler(lvSearchResults_SelectedIndexChanged);
lvSearchResults.SelectedIndices.Clear();
lvSearchResults.SelectedIndices.Add(_prevSelectedIndex);
lvSearchResults.Items[_prevSelectedIndex].Selected = true;
lvSearchResults.SelectedIndexChanged += new EventHandler(lvSearchResults_SelectedIndexChanged); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-01T00:14:38.423

只要您关闭了多选，就不必致电

```
SelectedIndices.Clear() Selectedndices.Add(..) 
```

也：

```
Items[_prevSelectedIndex].Selected = true; 
```

后者将实现相同的结果。

我相信您还会添加不断增长的事件处理程序列表。要删除事件处理程序，您必须存储委托的实例，然后删除该实例；`-= new EventHandler(...)`不会删除处理程序。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-05-14T18:15:59.947

最好和最简单的方法是设置一个布尔属性，`true`当您不希望事件触发时。在 SelectedIndexChange 事件中，您测试是否应该允许事件继续触发，否则返回。检查我的代码。下面的代码行为相同。

```
 //somewhere on top
     private bool dontFireEvent = false;        

    //somewhere else
    dontFireEvent = true;
    treeView1.SelectedNode = treeView1.Nod.... bla bla //event won't fire
    dontFireEvent = false;

    //within the event code
    private void treeView1_AfterSelect(object sender, TreeViewEventArgs e)
    {
        if (!dontFireEvent)
            ProcessLogin();
    } 
```

# c++ - 纯虚函数调用

> ID：703516
> 
> 赞同：1
> 
> 时间：2009-03-31T23:51:17.730
> 
> 标签：c++, runtime, pure-virtual

我显然不'grok' C++。

在这个编程任务中，我遇到了死胡同。这行代码出现运行时错误：

```
else if (grid[i][j]->getType() == WILDEBEEST) { ... 
```

带有消息“运行时错误 - 纯虚函数调用”。

据我了解，如果函数引用在当前未实例化子类时尝试调用（虚拟）基类，则会发生此错误。但是，我看不出我在哪里犯了这个错误。

相关代码：
教授代码：

```
const int LION = 1; 
const int WILDEBEEST = 2;

//
// .
// .
// .
//

class Animal {
    friend class Savanna;   // Allow savanna to affect animal 
public: 
    Animal(); 
    Animal(Savanna *, int, int); 
    ~Animal(); 
    virtual void breed() = 0;    // Breeding implementation 
    virtual void move() = 0;     // Move the animal, with appropriate behavior 
    virtual int getType() = 0;   // Return if wildebeest or lion 
    virtual bool starve() = 0;   // Determine if animal starves 
protected: 
    int x,y;        // Position in the savanna, using the XY coordinate plane
    bool moved;     // Bool to indicate if moved this turn 
    int breedTicks; // Number of ticks since breeding 
    Savanna *savanna; 
};

//
// .
// .
// .
//

void Savanna::Display() 
{ 
 int i,j; 

 cout << endl << endl; 
 for (j=0; j<SAVANNASIZE; j++) 
 { 
  for (i=0; i<SAVANNASIZE; i++) 
  { 
   if (grid[i][j]==NULL){ 
    setrgb(0);
    cout << " "; 
   }
   else if (grid[i][j]->getType()==WILDEBEEST) // RUNTIME ERROR HERE
   {
     setrgb(7);
     cout << "W"; 
   }
   else {
        setrgb(3);
        cout << "L";
   }
  } 

     cout << endl; 
 } 
 setrgb(0);
} 
```

我的代码：

```
class Wildebeest: public Animal {

friend class Savanna;    // Allow the Savanna to affect the animal, as per spec
public: 
    Wildebeest(); 
    Wildebeest(Savanna *, int, int);    // accepts (pointer to a Savanna instance, X Position, Y Position)
    void breed();           // Perform breeding, and check breedTick 
    void move();            // move the animal.
    int getType();              // returns WILDEBEEST
    bool starve();                  // if starving, returns 0\. (counterintuitive, I know.)
};

int Wildebeest::getType() {

    return WILDEBEEST;
} 
```

我读过[旧新事物：什么是__purecall？](http://blogs.msdn.com/oldnewthing/archive/2004/04/28/122037.aspx)和[Visual C++ 中 R6025 运行时错误的描述，](http://support.microsoft.com/kb/125749)但我不完全理解为什么会在上述代码中发生这种情况。

[编辑] main.c 的完整列表（是的，所有一个文件......作业要求的一部分。）

```
// 
//  This program simulates a 2D world with predators and prey. 
//  The predators (lions) and prey (wildebeest) inherit from the 
//  Animal class that keeps track of basic information about each 
//  animal (time ticks since last bred, position on the savanna). 
// 
//  The 2D world is implemented as a separate class, Savanna, 
//  that contains a 2D array of pointers to type Animal. 
// 

// **************************************************************** 

#include <iostream> 
#include <string> 
#include <vector> 
#include <cstdlib> 
#include <time.h> 
#include "graphics.h"

using namespace std; 

int wrapTo20 (int value) {

    if (0 > value) {

        value = 19;
    } else if (20 == value) {

        value = 0;
    }

    return value;
}

const int SAVANNASIZE = 20; 
const int INITIALBEEST = 100; 
const int INITIALLIONS = 5; 
const int LION = 1; 
const int WILDEBEEST = 2; 
const int BEESTBREED = 3;
const int LIONBREED = 8; 
const int LIONSTARVE = 3; 

// Forward declaration of Animal classes so we can reference it 
// in the Savanna class 
class Animal; 
class Lion; 
class Wildebeest; 

// ========================================== 
// The Savana class stores data about the savanna by creating a 
// SAVANNASIZE by SAVANNASIZE array of type Animal. 
// NULL indicates an empty spot, otherwise a valid object 
// indicates an wildebeest or lion.  To determine which, 
// invoke the virtual function getType of Animal that should return 
// WILDEBEEST if the class is of type Wildebeest, and Lion otherwise. 
// ========================================== 

class Savanna 
{ 
friend class Animal;   // Allow Animal to access grid 
friend class Lion;   // Allow Animal to access grid 
friend class Wildebeest;   // Allow Animal to access grid 
public: 
 Savanna(); 
 ~Savanna(); 
 Animal* getAt(int, int); 
  void setAt(int, int, Animal *); 
 void Display(); 
 void SimulateOneStep(); 
private: 
 Animal* grid[SAVANNASIZE][SAVANNASIZE]; 
}; 

// ========================================== 
// Definition for the Animal base class. 
// Each animal has a reference back to 
// the Savanna object so it can move itself 
// about in the savanna. 
// ========================================== 
class Animal 
{ 
friend class Savanna;   // Allow savanna to affect animal 
public: 
 Animal(); 
 Animal(Savanna *, int, int); 
 ~Animal(); 
 virtual void breed() = 0; // Whether or not to breed 
 virtual void move() = 0; // Rules to move the animal 
 virtual int getType() = 0; // Return if wildebeest or lion 
 virtual bool starve() = 0; // Determine if animal starves 
protected: 
 int x,y;   // Position in the savanna 
 bool moved;   // Bool to indicate if moved this turn 
 int breedTicks;   // Number of ticks since breeding 
 Savanna *savanna; 
}; 

// ====================== 
// Savanna constructor, destructor 
// These classes initialize the array and 
// releases any classes created when destroyed. 
// ====================== 
Savanna::Savanna() 
{ 
 // Initialize savanna to empty spaces 
 int i,j; 
 for (i=0; i<SAVANNASIZE; i++) 
 { 
  for (j=0; j<SAVANNASIZE; j++) 
  { 
   grid[i][j]=NULL; 
  } 
 } 
} 

Savanna::~Savanna() 
{ 
 // Release any allocated memory 
 int i,j; 
 for (i=0; i<SAVANNASIZE; i++) 
 { 
  for (j=0; j<SAVANNASIZE; j++) 
  { 
   if (grid[i][j]!=NULL) delete (grid[i][j]); 
  } 
 } 
} 

// ====================== 
// getAt 
// Returns the entry stored in the grid array at x,y 
// ====================== 
Animal* Savanna::getAt(int x, int y) 
{ 
 if ((x>=0) && (x<SAVANNASIZE) && (y>=0) && (y<SAVANNASIZE)) 
  return grid[x][y]; 
 return NULL; 
} 

// ====================== 
// setAt 
// Sets the entry at x,y to the 
// value passed in.  Assumes that 
// someone else is keeping track of 
// references in case we overwrite something 
// that is not NULL (so we don't have a memory leak) 
// ====================== 
void Savanna::setAt(int x, int y, Animal *anim) 
{ 
 if ((x>=0) && (x<SAVANNASIZE) && (y>=0) && (y<SAVANNASIZE)) 
 { 
  grid[x][y] = anim; 
 } 
} 

// ====================== 
// Display 
// Displays the savanna in ASCII.  Uses W for wildebeest, L for lion. 
// ====================== 
void Savanna::Display() 
{ 
 int i,j; 

 cout << endl << endl; 
 for (j=0; j<SAVANNASIZE; j++) 
 { 
  for (i=0; i<SAVANNASIZE; i++) 
  { 
   if (grid[i][j]==NULL){ 
    setrgb(0);
    cout << " "; 
   }
   else if (grid[i][j]->getType()==WILDEBEEST) 
   {
     setrgb(7);
     cout << "W"; 
   }
   else {
        setrgb(3);
        cout << "L";
   }
  } 

     cout << endl; 
 } 
 setrgb(0);
} 

// ====================== 
// SimulateOneStep 
// This is the main routine that simulates one turn in the savanna. 
// First, a flag for each animal is used to indicate if it has moved. 
// This is because we iterate through the grid starting from the top 
// looking for an animal to move . If one moves down, we don't want 
// to move it again when we reach it. 
// First move lions, then wildebeest, and if they are still alive then 
// we breed them. 
// ====================== 
void Savanna::SimulateOneStep() 
{ 
 int i,j; 
 // First reset all animals to not moved 
 for (i=0; i<SAVANNASIZE; i++) 
  for (j=0; j<SAVANNASIZE; j++) 
  { 
   if (grid[i][j]!=NULL) grid[i][j]->moved = false; 
  } 
 // Loop through cells in order and move if it's a Lion 
 for (i=0; i<SAVANNASIZE; i++) 
  for (j=0; j<SAVANNASIZE; j++) 
  { 
   if ((grid[i][j]!=NULL) && (grid[i][j]->getType()==LION)) 
   { 
   if (grid[i][j]->moved == false) 
   { 
    grid[i][j]->moved = true; // Mark as moved 
    grid[i][j]->move(); 
   } 
   } 
  } 
 // Loop through cells in order and move if it's an Wildebeest 
 for (i=0; i<SAVANNASIZE; i++) 
  for (j=0; j<SAVANNASIZE; j++) 
  { 
   if ((grid[i][j]!=NULL) && (grid[i][j]->getType()==WILDEBEEST)) 
   { 
    if (grid[i][j]->moved == false) 
    { 
     grid[i][j]->moved = true; // Mark as moved 
     grid[i][j]->move(); 
    } 
   } 
  } 
 // Loop through cells in order and check if we should breed 
 for (i=0; i<SAVANNASIZE; i++) 
  for (j=0; j<SAVANNASIZE; j++) 
  { 
        // Kill off any lions that haven't eaten recently 
   if ((grid[i][j]!=NULL) && 
       (grid[i][j]->getType()==LION)) 
   { 
    if (grid[i][j]->starve()) 
    { 
     delete (grid[i][j]); 
     grid[i][j] = NULL; 
    } 
   } 
  } 
 // Loop through cells in order and check if we should breed 
 for (i=0; i<SAVANNASIZE; i++) 
  for (j=0; j<SAVANNASIZE; j++) 
  { 
   // Only breed animals that have moved, since 
   // breeding places new animals on the map we 
   // don't want to try and breed those 
   if ((grid[i][j]!=NULL) && (grid[i][j]->moved==true)) 
   { 
    grid[i][j]->breed(); 
   } 
  } 
} 

// ====================== 
// Animal Constructor 
// Sets a reference back to the Savanna object. 
// ====================== 
Animal::Animal() 
{ 
 savanna = NULL; 
 moved = false; 
 breedTicks = 0; 
 x=0; 
 y=0; 
} 

Animal::Animal(Savanna *savana, int x, int y) 
{ 
 this->savanna = savana; 
 moved = false; 
 breedTicks = 0; 
 this->x=x; 
 this->y=y; 
 savanna->setAt(x,y,this); 
} 

// ====================== 
// Animal destructor 
// No need to delete the savanna reference, 
// it will be destroyed elsewhere. 
// ====================== 
Animal::~Animal() 
{ } 

// Start with the Wildebeest class and its required declarations 
class Wildebeest: public Animal {

    friend class Savanna;   // Allow savanna to affect animal 
public: 
    Wildebeest(); 
    Wildebeest(Savanna *, int, int); 
 void breed();          // Whether or not to breed 
 void move();           // Rules to move the animal 
 int getType();         // Return if wildebeest or lion 
 bool starve(); 
};

bool Wildebeest::starve() {

    return 1;
}

// ====================== 
// Wildebeest constructors 
// ====================== 

Wildebeest::Wildebeest() {

}

Wildebeest::Wildebeest(Savanna * sav, int x, int y) : Animal(sav, x, y) {

}

// ====================== 
// Wldebeest Move 
// Look for an empty cell up, right, left, or down and 
// try to move there. 
// ====================== 

void Wildebeest::move() {

    int loc1, loc2, loc3, loc4;
    int x1, x2, x3, x4;
    int y1, y2, y3, y4;

    x1 = wrapTo20(x);
    y1 = wrapTo20(y + 1);

    x2 = wrapTo20(x + 1);
    y2 = wrapTo20(y);

    x3 = wrapTo20(x);
    y3 = wrapTo20(y - 1);

    x4 = wrapTo20(x - 1);
    y4 = wrapTo20(y);

    loc1 = savanna->getAt(x1, y1)->getType();
    loc2 = (int)savanna->getAt(x2, y2)->getType();
    loc3 = savanna->getAt(x3, y3)->getType();
    loc4 = savanna->getAt(x4, y4)->getType();

    while (!moved) {
        int x = 1 + (rand() % 4);
        switch (x) {

            case 1:
                if (!loc1) savanna->setAt(x1, y1, this);
                break;

            case 2:
                if (!loc2) savanna->setAt(x2, y2, this);
                break;

            case 3:
                if (!loc3) savanna->setAt(x3, y3, this);
                break;

            case 4:
                if (!loc4) savanna->setAt(x4, y4, this);
                break;

            default:
                break;
        }
    }
}

// ====================== 
// Wildebeest getType 
// This virtual function is used so we can determine 
// what type of animal we are dealing with. 
// ====================== 
int Wildebeest::getType() {

    return WILDEBEEST;
}

// ====================== 
// Wildebeest breed 
// Increment the tick count for breeding. 
// If it equals our threshold, then clone this wildebeest either 
// above, right, left, or below the current one. 
// ====================== 

void Wildebeest::breed() {
    breedTicks++;

    if (2 == breedTicks) {
        breedTicks = 0;
    }

}

// ***************************************************** 
// Now define Lion Class and its required declarations
// ***************************************************** 

class Lion: public Animal {

    friend class Savanna;   // Allow savanna to affect animal 
public: 
    Lion(); 
    Lion(Savanna *, int, int); 
 void breed();          // Whether or not to breed 
 void move();           // Rules to move the animal 
 int getType();         // Return if wildebeest or lion 
 bool starve(); 
};

// ====================== 
// Lion constructors 
// ====================== 

Lion::Lion() {

}

Lion::Lion(Savanna * sav, int x, int y) : Animal(sav, x, y) {

}

// ====================== 
// Lion move 
// Look up, down, left or right for a lion.  If one is found, move there 
// and eat it, resetting the starveTicks counter. 
// ====================== 

void Lion::move() {

    int loc1, loc2, loc3, loc4;
    int x1, x2, x3, x4;
    int y1, y2, y3, y4;

    x1 = wrapTo20(x);
    y1 = wrapTo20(y + 1);

    x2 = wrapTo20(x + 1);
    y2 = wrapTo20(y);

    x3 = wrapTo20(x);
    y3 = wrapTo20(y - 1);

    x4 = wrapTo20(x - 1);
    y4 = wrapTo20(y);

    loc1 = savanna->getAt(x1, y1)->getType();
    loc2 = (int)savanna->getAt(x2, y2)->getType();
    loc3 = savanna->getAt(x3, y3)->getType();
    loc4 = savanna->getAt(x4, y4)->getType();

    while (!moved) {
        int x = 1 + (rand() % 4);
        switch (x) {

            case 1:
                if (!loc1) savanna->setAt(x1, y1, this);
                break;

            case 2:
                if (!loc2) savanna->setAt(x2, y2, this);
                break;

            case 3:
                if (!loc3) savanna->setAt(x3, y3, this);
                break;

            case 4:
                if (!loc4) savanna->setAt(x4, y4, this);
                break;

            default:
                break;
        }
    }
}

// ====================== 
// Lion getType 
// This virtual function is used so we can determine 
// what type of animal we are dealing with. 
// ====================== 

int Lion::getType() {

    return LION;
}

// ====================== 
// Lion breed 
// Creates a new lion adjacent to the current cell 
// if the breedTicks meets the threshold. 
// ====================== 

void Lion::breed() {

    breedTicks++;

    if (2 == breedTicks) {
        breedTicks = 0;
    }

}

// ====================== 
// Lion starve 
// Returns true or false if a lion should die off 
// because it hasn't eaten enough food. 
// ====================== 

bool Lion::starve() {

    return 1;
}

// ====================== 
//     main function 
// ====================== 
int main() 
{ 
  string s; 
  srand((int)time(NULL));  // Seed random number generator 
  Savanna w; 
  int initialWildebeest=0;
  int initialLions=0;

  // enter initial number of wildebeest
  int beestcount = 0; 
  while(initialWildebeest <= 0 || initialWildebeest > INITIALBEEST){
    cout << "Enter number of initial Wildebeest (greater than 0 and less than " << INITIALBEEST << ") : ";
    cin >> initialWildebeest;
  }
  // Randomly create wildebeests and place them in a randomly choosen empty spot in savanna 

    int i;
    bool placed = 0;

    for ( i = 0; i < initialWildebeest; i++) {
        while (!placed) {
            int x = 1 + (rand() % 20);
            int y = 1 + (rand() % 20);

            if (!(w.getAt(x, y))){
                Wildebeest fred(&w, x, y);
                placed = 1;
            }
        }
        placed = 0;
    }

  // Enter initial number of lions 
  int lioncount = 0; 
  while(initialLions <= 0 || initialLions > INITIALLIONS){
    cout << "Enter number of initial Lions (greater than 0 and less than " << INITIALLIONS << ") : ";
    cin >> initialLions;
  }
  // Randomly create lions and place them in a randomly choosen empty spot in savanna

  placed = 0;

  for ( i = 0; i < initialLions; i++) {
        while (!placed) {
            int x = 1 + (rand() % 20);
            int y = 1 + (rand() % 20);

            if (!(w.getAt(x, y))){
                Lion ronald(&w, x, y);
                placed = 1;
            }
        }
        placed = 0;
    }

  // Run simulation forever, until user cancels 
  int count=0;
  while (true) 
  { 
  gotoxy(0,0);
  w.Display(); 
  w.SimulateOneStep();
  Sleep(500); 
  count++;
  if(count == 20){
   count=0;
   cout << endl << "Press enter for next step, ctrl-c to quit" << endl; 
   getline(cin,s);
   clearline(23); 

   }
  } 
  return 0; 
} 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-04-01T00:00:30.330

它的定义是什么`grid`以及如何填充它？我敢打赌你是从 Animal 构造函数做的。此时 this 的动态类型是`Animal`，而不是最终创建的对象的类型。

```
Animal::Animal()
{
    grid[i][j] = this; // the type of this is Animal
} 
```

在对象完全构造之前，您不能`this`以动态方式使用指针，这包括调用虚函数或使用虚函数表。

更具体地说，你需要推迟使用`this`指针，也就是说，将它存储在`grid`数组中，直到对象完全构造之后。

在 Animal 构造函数中：

```
Animal::Animal(Savanna *savana, int x, int y) 
{ 
 this->savanna = savana; 
 moved = false; 
 breedTicks = 0; 
 this->x=x; 
 this->y=y; 
 savanna->setAt(x,y,this); 
} 
```

请注意，您正在`Savanna::setAt`使用`this`参数调用。在这一点上，动态类型`this`是动物，而不是牛羚或其他东西。setAt 这样做：

```
void Savanna::setAt(int x, int y, Animal *anim) 
{ 
 if ((x>=0) && (x<SAVANNASIZE) && (y>=0) && (y<SAVANNASIZE)) 
 { 
  grid[x][y] = anim; 
 } 
} 
```

的值`anim`是来自 Animal 构造函数的 this 指针。

还要注意几件事。当您构建 Wildebeest 列表时，您会导致一个悬空指针：

```
for ( i = 0; i < initialWildebeest; i++) {
    while (!placed) {
            int x = 1 + (rand() % 20);
            int y = 1 + (rand() % 20);

            if (!(w.getAt(x, y))){
****                       Wildebeest fred(&w, x, y);
                    placed = 1;
            }
    }
    placed = 0;
} 
```

被命名的 WildeBeest`fred`将在下一行超出范围并被销毁。您需要通过以下方式动态分配它`new`：

```
for ( i = 0; i < initialWildebeest; i++) {
    while (!placed) {
            int x = 1 + (rand() % 20);
            int y = 1 + (rand() % 20);

            if (!(w.getAt(x, y))){
                    Wildebeest *fred = new Wildebeest(&w, x, y);
                    placed = 1;
            }
    }
    placed = 0;
} 
```

在 Savanna 的析构函数中，有一个匹配的 delete 调用，这样我们就不会泄漏内存：

```
Savanna::~Savanna() 
{ 
 // Release any allocated memory 
 int i,j; 
 for (i=0; i<SAVANNASIZE; i++) 
 { 
  for (j=0; j<SAVANNASIZE; j++) 
  { 
****       if (grid[i][j]!=NULL) delete (grid[i][j]); 
  } 
 } 
} 
```

Lion 实例也会遇到完全相同的问题。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-01T02:05:52.120

你的问题之一是这些线......

```
 if (!(w.getAt(x, y))){
      Wildebeest fred(&w, x, y);
      placed = 1;
   } 
```

... 在堆栈上创建一个 Wildebeest，在构造函数中，该堆栈居住的 Wildebeest 的*地址*被填充到 w 的网格中，然后 Wildebeest 超出范围。

您的角马和狮子需要生活在堆中......

if (!(w.getAt(x, y))){

```
 // hey maintenance programmer, this looks like I'm leaking the Wildebeest,
  // but chillax, the Savannah is going to delete them 

  Wildebeest *fred = new Wildebeest(&w, x, y);
  placed = 1; 
```

}

...而且您需要评论，因为您所做的与惯用的 C++ 相去甚远。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-31T23:57:00.900

好吧，我没有看到初始化网格数组的代码。也许 grid 它是在堆栈或堆上创建的，因此填充了未初始化的值。未初始化的值可以是任何值，但它们可能不是 NULL，并且绝对不是有效的指针。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-01T00:14:34.353

纯虚拟错误消息意味着被调用的函数没有实现；它有效地调用了一个指向方法的指针类型的空指针。（这就是语法为. 的原因`=0;`。）因此，无论发生什么其他情况，错误消息都会告诉您那里没有任何 Wildebeasts 被指向。

我*真的*很想添加一些代码来检查那里是否有*任何*东西。你有一个空检查，所以问题是*那里*有什么？

几乎可以肯定数组没有以正确的方式初始化。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-01T01:18:26.040

我认为您的问题不是对纯虚函数的调用（编译器永远不允许这样做，因此它不会真正导致运行时错误），而是您在无效的内存区域上调用该函数，因此具有无效的虚拟表。

我也愿意打赌，这可能与你如何构建你的野兽有关，作为自动变量而不是动态分配它们。一旦你摆脱了那些 ifs，那个内存就会被回收。

* * *

## 回答 #6

> 赞同：-2
> 
> 时间：2009-03-31T23:57:21.087

不一定是您的问题的原因（我没有深入阅读您的代码），但您没有使用虚拟析构函数，您应该使用它。

# python - Python：对没有 if 子句的非空列表的迭代是空的。为什么？

> ID：703520
> 
> 赞同：5
> 
> 时间：2009-03-31T23:53:51.017
> 
> 标签：python, iterator, generator, leaky-abstraction

`sum()`没有过滤和聚合（等）的非空序列上的迭代器如何不产生任何结果？

考虑一个简单的例子：

```
sequence = ['a', 'b', 'c']
list((el, ord(el)) for el in sequence) 
```

这`[('a', 97), ('b', 98), ('c', 99)]`符合预期。

现在，只需将 out 替换为`ord(el)`从某个生成器中取出第一个值的表达式，使用`(...).next()`- 请原谅人为的示例：

```
def odd_integers_up_to_length(str):
    return (x for x in xrange(len(str)) if x%2==1)

list((el, odd_integers_up_to_length(el).next()) for el in sequence) 
```

这产生`[]`. 是的，空列表。没有`('a',`东西`)`元组。没有。

但我们没有过滤、聚合或减少。`n`没有过滤或聚合的对象生成器表达式必须产生`n`对象，对吗？这是怎么回事？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-03-31T23:59:40.083

`odd_integers_up_to_length(el).next()`将引发 StopIteration，它没有被捕获，但被捕获用于其中的生成器表达式，停止它而不产生任何东西。

查看第一次迭代，当值为“a”时：

```
>>> odd_integers_up_to_length('a').next()
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
StopIteration 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-01T00:01:30.220

发生的情况是`next()`调用引发了一个`StopIteration`异常，该异常使堆栈冒泡到外部生成器表达式并停止*该*迭代。

A`StopIteration`是迭代器发出完成信号的正常方式。通常我们看不到它，因为通常`next()`调用发生在使用迭代器的构造中，例如`for x in iterator`or `sum(iterator)`。但是当我们`next()`直接调用时，我们是负责捕捉`StopIteration`. 不这样做会在抽象中引发泄漏，这会导致外部迭代中出现意外行为。

我想，教训是：小心直接调用`next()`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-01T00:03:10.497

str 是一个保留的关键字，你应该以不同的方式命名你的变量

我也建议下一个

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-01T00:04:53.097

```
>>> seq=['a','b','c']
>>> list((el,4) for el in seq)
[('a',4), ('b',4), ('c',4)] 
```

所以这里不会`list`给你带来麻烦...

# javascript - 防止/停止自动锚链接的发生

> ID：703530
> 
> 赞同：9
> 
> 时间：2009-03-31T23:57:53.847
> 
> 标签：javascript, jquery

使用 link.html#idX 和 <div id="idX"/> 时，我需要防止浏览器中的自动滚动到行为。

我试图解决的问题是我试图通过检测 url 中的锚点来在页面加载时执行自定义滚动到功能，但到目前为止还无法阻止自动滚动功能（特别是在 Firefox 中） .

有任何想法吗？我在 $(window).load() 处理程序上尝试了 preventDefault() ，这似乎不起作用。

让我重申一下，这是针对在滚动页面中未点击的链接；它适用于在页面加载时滚动的链接。考虑单击链接中带有#anchor 的另一个网站的链接。是什么阻止了自动滚动到 id？

每个人都明白我不是在寻找解决方法；我需要知道是否（以及如何）可以防止在页面加载时自动滚动到#anchors。

* * *

## **笔记**

这并不是问题的*真正*答案，只是一个简单的比赛条件风格的 kluge。

使用 jQuery 的 scrollTo 插件滚动回页面顶部，然后使用自定义的东西重新激活滚动。如果浏览器/计算机足够快，则页面上没有“flash”。

只是建议这个我觉得很脏...

```
$(document).ready(function(){

    // fix the url#id scrollto "effect" (that can't be
    // aborted apparently in FF), by scrolling back
    // to the top of the page.
    $.scrollTo('body',0);

    otherAnimateStuffHappensNow();

}); 
```

[归功于 wombleton](https://stackoverflow.com/users/22419/wombleton)的指出。谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-01T23:45:11.640

[这](http://www.inmotiondesign.nl/playground/?p=20)似乎是我可以看到的唯一选项：

```
$(document).ready(function() {
  $.scrollTo('0px');
}); 
```

它不会自动滚动到类。

因此，如果您使用独特的类来标识您的 div，您在查找元素时会失去一点速度，但会获得您所追求的行为。

（顺便说一句，感谢您指出滚动到 ID 功能！从来不知道它存在。）

编辑：

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-01T15:30:11.627

1.  首先滚动到顶部（快速，无效果），然后调用您的滚动功能。（我知道它不那么漂亮）
2.  或者只使用前缀

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-09-04T23:18:50.470

我知道这是一个旧线程，但我发现了一些不需要滚动的东西。在任何其他脚本之前先运行它。它在页面上的第一个元素之前放置一个锚点，以防止滚动，因为它位于页面顶部。

```
function getAnchor(sUrl)
{
  if( typeof sUrl == 'string' )
  {
   var i = sUrl.indexOf( '#' );
   if( i >= 0 )
    { return sUrl.substr( i+1 ).replace(/ /g, ''); }
  }
  return '';
};

var s = getAnchor(window.location.href);
if( s.length > 0 )
 { $('<a name="'+s+'"/>').insertBefore($('body').first()); } 
```

干杯! 欧文·汉杰斯

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-12-09T20:19:53.990

这对我来说效果很好：

1-把它放在你的css文件中

```
a[name] { position: absolute; top: 0px } 
```

2-在你开始动画之前把它放在你的document.ready绑定上（如果你正在制作动画）

```
$("a[name]").css("position","relative"); 
```

可能需要根据您的样式表/代码进行调整，但您明白了。

归功于：[http ://cssbeauty.com/skillshare/discussion/1882/disable-anchor-jump/](http://cssbeauty.com/skillshare/discussion/1882/disable-anchor-jump/)

# language-agnostic - 计算图的传递闭包需要渐近运行时间？

> ID：703531
> 
> 赞同：7
> 
> 时间：2009-03-31T23:58:37.463
> 
> 标签：language-agnostic, runtime, theory, graph-theory

图的传递闭包在此处定义，例如：http: [//mathworld.wolfram.com/TransitiveClosure.html](http://mathworld.wolfram.com/TransitiveClosure.html)

在 O(n^3) 中很容易实现，其中 n 是顶点数。我想知道它是否可以在 O(n^2) 时间内完成。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-01T00:02:10.187

没有。我不认为它有一个 O(n ² ) 算法。我希望如果存在这样的算法，您也可以解决 O(n ² ) 中的所有对最短路径问题，但事实并非如此。我能想到的渐近最快的算法是 Dijkstra 的最短路径算法的一个实现，它带有一个斐波那契堆（O( *n* ² log *n* ) 在不是很密集的图中）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-01T00:08:49.530

唔。我找到了一种算法，可以在 O(n^2) 预期运行时间内计算传递闭包。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-01T00:09:22.227

鉴于此：

> 你能想出一个 O(kn^2 + m) 传递闭包/归约算法，其中 k 是传递闭包/归约中缺失/额外边的数量吗？

仍然被那些比我们想得更多的人认为是一个悬而未决的问题，我会说“我不知道”。

（但如果你解决了它并想要获得博士学位，我知道*那个*算法。）

# ruby-on-rails - ActiveRecord 在生产中运行不同的查询？

> ID：703538
> 
> 赞同：3
> 
> 时间：2009-04-01T00:00:56.960
> 
> 标签：ruby-on-rails, ruby, activerecord, environment

我有一个类层次结构如下所示：

```
class Post < ActiveRecord::Base; end
class Project < Post; end
class ProjectDesignWall < Project; end 
```

有一个控制器可以像这样获取数据：

```
@projects = Project.find(:all, :include => [:project_image_photos,:user]) 
```

在`development`中，这会直接从日志中运行以下查询：

```
SELECT * FROM `posts` WHERE ( (`posts`.`type` = 'Project' ) ) ORDER BY originally_created_at DESC 
```

但是，一旦它在`production`模式下运行，即使使用相同的数据库和数据，它也会导致以下查询：

```
SELECT * FROM `posts` WHERE ( (`posts`.`type` = 'Project' OR `posts`.`type` = 'ProjectDesignWall' ) ) ORDER BY originally_created_at DESC 
```

有谁知道为什么会这样，如果不能彻底解决问题，有没有办法让它至少表现一致？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-01T06:35:50.473

因为在生产环境中，你所有的类都是一次性加载的。当所有类都加载时，它会意识到 ProjectDesignWall 是 Project 的子类，因此会收集所有类。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-02T07:16:50.010

此处有此错误的公开票： [https ://rails.lighthouseapp.com/projects/8994/tickets/188-single-table-inheritance-bug-only-in-production-environment](https://rails.lighthouseapp.com/projects/8994/tickets/188-single-table-inheritance-bug-only-in-production-environment)

解决方案列在这张票的底部：[https ://rails.lighthouseapp.com/projects/8994-ruby-on-rails/tickets/2389-sti-changes-behavior-depending-on-environment](https://rails.lighthouseapp.com/projects/8994-ruby-on-rails/tickets/2389-sti-changes-behavior-depending-on-environment)

去引用：

> 您必须在父类中显式命名子类
> 
> 类 ProjectFeedEvent < FeedEvent
> 
> ```
> def self.subclasses
>   [ProjectAddedEvent]
> end 
> ```
> 
> 结尾

这个问题已经存在了一段时间并且没有受到太多关注的部分原因是 STI 在 Rails 中通常不是必需的。大多数 Rails 贡献者决定不在他们自己的项目中使用它，因此没有花时间确保它得到很好的支持。这里有一个简介，简要解释了为什么你不应该使用它并提出一个替代方案：http: [//www.matthewpaulmoore.com/ruby-on-rails-code-quality-checklist#sti](http://www.matthewpaulmoore.com/ruby-on-rails-code-quality-checklist#sti)

我自己在公司使用 STI 的个人经验是，起初这似乎非常有用，但随着时间的推移，我们确定我们根本不需要它来保证复杂性。从那时起，我们的项目急剧增长，我们根本没有错过它。

# delphi - Delphi：如何像 facebook 那样标记照片

> ID：703542
> 
> 赞同：0
> 
> 时间：2009-04-01T00:02:57.360
> 
> 标签：delphi, facebook, tags, tagging, photos

我需要一种在 Delphi 桌面应用程序中标记照片的方法，就像 Facebook 那样。

这包括一些方法可以轻松地将标签添加到人物上，然后将鼠标悬停在照片中的人物上以显示标签。

给出的答案中的两个建议：“[用于人脸识别和标记的德尔福组件](https://stackoverflow.com/questions/431086/delphi-components-for-face-identification-and-tagging)”并没有解决这个问题。

但我不知道从哪里开始，也无法在网上找到如何做到这一点的想法。脸书是如何做到的？或者也许有一个允许它的 Delphi 组件。

尝试实施类似 Facebook 的标签的最佳方式是什么？

* * *

ps 这是 Facebook 对此的一些 API 定义：[http ://wiki.developers.facebook.com/index.php/Photos.addTag](http://wiki.developers.facebook.com/index.php/Photos.addTag)

这是一个 Java 程序，它实现了我想在我的 Delphi 应用程序中执行的面部标记功能：[fb-photo-uploader](http://code.google.com/p/fb-photo-uploader/)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-01T03:25:54.847

您引用的 API 的关键参数是图片 ID、坐标和标签。标签可以是 Facebook 用户的用户 ID，也可以是自由格式的文本（当标记的主题不是 Facebook 用户时）。Facebook 只使用一个坐标，因为它使用固定大小的区域来表示标记区域；这个想法是你点击一个人的脸的中心，Facebook 只是存储那个点。

如果您在`TImage`控件中显示图片（毕竟这是显而易见的首选），您可以使用`OnMouseDown`and`OnMouseUp`事件检测鼠标点击。（该`OnClick`事件更简单，但不会告诉您坐标。）一旦您获得了一个点，提示您输入一个标签来伴随该点。你可以使用预先确定的标签，比如 Facebook 的用户 ID，或者只使用普通文本，或者使用你自己设计的东西。您使用什么来表示标签值的问题与您迄今为止提出的任何其他问题都是正交的。

Facebook 的照片标记的另一半是，将鼠标移到图像上会在图像上显示标记文本，将鼠标移到下面的标签上会突出显示相关区域。处理`OnMouseMove`事件并编写一些代码以根据需要显示或隐藏标签和形状。如果您使用`TLabel`and `TShape`，您甚至可能不必修改图像，但在图像顶部显示这些控件可能会干扰图像的进一步`OnMouseMove`事件。尝试一些实验并查看适合您的方法应该不会花费太长时间。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-01T17:43:35.910

lkessler，我刚刚阅读了您对 Marshall Fryman 的回复，因此您可能有几个选择：

[THotSpotImage](http://www.tmssoftware.com/site/hsimg.asp "例子") - 如果您已经有 TMS 组件...

[ImageEn](http://www.hi-components.com/nimageen_features.asp "例子") - 如果您已经拥有它们...

请参阅[w2m 的答案＃3](http://www.imageen.com/forums/viewtopic.php?t=46869&sid=2aa3b019d787b37fba96bd78b710b145 "例子")，我认为我需要进一步获取我的选择的所有内部像素，那么我如何保存我的选择/对象？

> 保存选择只是保存选择本身。它不会将图像保存在选择范围内：
> 
> 过程 SaveSelectionToFile(const FileName:string); SaveSelectionToFile 将当前选择保存到指定文件。示例 ImageEnView1.Select(10,10,100,100); ImageEnView1.SaveSelectionToFile('selection1'); .. sel1.Position:=0; ImageEnView1.LoadSelectionFromFile('selection1'); // 这就像 Select(10,10,100,100)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-01T01:34:52.367

我对你的问题有点困惑。您是在尝试与 Facebook 互动还是只是复制功能？

如果您尝试复制功能：您应该能够只显示图像，让用户选择矩形，可能将图像复制到新副本以通知其他人，并在数据库中应用标签。一些有用的链接：[这](http://www.bitwisemag.com/copy/delphi/delphi2.html)是一个选择图像示例，[这](http://www.delphitricks.com/source-code/graphic/copy_part_of_one_image_to_another.html)是复制图像部分示例。我实际上认为您可以在油漆盒中选择图像，但实际上并没有永远玩过其中一个。

如果您尝试访问 API：.NET 接口可能适合您。据我所知，没有 COM 接口，因此您必须编写自己的连接器或使用 .NET Delphi 应用程序。注意：所有这些信息都来自谷歌，所以我不会上下发誓这确实是当前的状态。我看到的唯一其他 Facebook API 请求是从 2007 年开始的。

如果您想进行自动人脸识别，参考问题中的 OpenCV 看起来是一种不错的方法（特别是如果您可以访问 C++ Builder）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-02T07:25:50.113

在[Graphic32-library](http://www.graphics32.org/wiki/)中，您可以在图像中相互叠加多个图层。开箱即用的层之一是[TRubberbandLayer](http://graphics32.org/documentation/Docs/Units/GR32_Layers/Classes/TRubberbandLayer/_Body.htm)，它允许用户在运行时重新定位/调整层大小。

TImage32 组件的 mousemove 事件有一个参数，该参数给出当前光标下的图层。

```
type TImgMouseMoveEvent = procedure(Sender: TObject; Shift: TShiftState; X, Y: Integer; Layer: TCustomLayer) of object; 
```

我认为橡皮筋层和鼠标移动事件的组合应该是很好的解决方案。

# java - 如何改变数组元素的值

> ID：703548
> 
> 赞同：2
> 
> 时间：2009-04-01T00:06:19.600
> 
> 标签：java, arrays

```
int A = 300;
int B = 400;
int C = 1000;
int D = 500;

int []abcd = {A,B,C,D};
Arrays.sort(abcd);   // the sequence of array elements will be {300, 400, 500,1000} 
```

我想在排序后根据它们在数组中的位置来更改变量 A、B、C、D 的值。

例如，变量 A 位于索引 0，因此 A 的值变为 1 而不是 300，变量 B 位于索引 1，因此 B 的值变为 2 而不是 400，变量 D 位于索引 2，所以D 的值从 500 变为 3，变量 C 位于索引 3，因此 C 的值从 1000 变为 4，

变量的最终值将是：A = 1; B = 2; C = 4; D = 3;

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-01T00:14:00.703

一种天真的方法是遍历数组的每个元素，同时检查值：

```
for (int i = 0; i < abcd.length; i++)
{
    if (abcd[i] == A)
    {
        A = i+1;
    }
}
// Rinse and repeat for B, C, D 
```

如果采用这种方法，当然，将其转换为接受数组、要搜索的值并返回其在数组中的索引的函数。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-01T00:12:55.650

我认为您对基元数组的工作方式有误解。创建数组 int[] abcd = {A,B,C,D} 时，它不包含变量 A、B、C 和 D，它应该包含它们的值的副本。

因此，当您对它们进行排序时，您实际上对 A、B、C 或 D 没有任何影响。

完成与您尝试做的事情接近的一种方法是使用排序映射，其中每个值将映射到一个值持有者，然后您可以迭代键（按排序顺序）并分配一个序列号每个价值持有者。

如果您更清楚地了解您真正想要做的事情，可能会更容易提供帮助。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-01T00:13:08.007

首先，**变量**A、B、C 和 D 没有“在数组中的位置”。您所做的是创建一个具有 4 个插槽的空白数组，并影响位置 0、1、2 和 3 中这些变量的**值。**

当您对数组进行排序时，**值**（再一次）在数组的槽之间打乱，但 sort() 对变量 A、B、C 和 D 一无所知，因此*它们的*值保持不变。如果您希望更改这些值，则需要通过使用每个插槽的位置将值重新影响到变量中：

```
A = abcd[0];
B = abcd[1];
C = abcd[2];
D = abcd[3]; 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-01T00:21:29.327

您是在寻找数组元素访问的语法还是更复杂的东西？

在 Java 中，

abcd[2] = 500; abcd[3] = 1000;

将进行您正在寻找的修改。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-01T00:14:19.843

不要对它们进行排序。将它们放在一个数组中，将第二个数组初始化为全零，并计算有多少项大于或等于每个元素。然后只需将这些计数转移回变量。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-01T00:15:11.467

您想要的是从值到数组位置的映射。除非有办法从 Arrays.sort() 中获得这样的映射，我对此表示怀疑（尽管我不是 Java 专家），否则您需要自己生成映射。您可以通过搜索数组来做到这一点。实现自己的排序可能更有效，这样您就可以在对数组进行排序时跟踪映射。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2017-01-21T14:03:55.350

只需循环它以更改值：

```
for(int i=0;i<abcd.length;i++){
      abcd[i] = i+1;
 }
System.out.println(Array.toString(abcd)); 
```

# cocoa-touch - 将 Cocoa Touch 纬度/经度转换为没有度数符号的字符串

> ID：703549
> 
> 赞同：1
> 
> 时间：2009-04-01T00:06:51.580
> 
> 标签：cocoa-touch, cocoa, nsstring, latitude-longitude, cllocation

我正在尝试将`CLLocation`纬度/经度转换为字符串。我可以使用以下代码成功地做到这一点：

```
// extract latitude from CLLocation object and cast to string
NSString *latitude = [[NSString alloc] initWithFormat:@"%g°", location.coordinate.latitude]; 
```

这给了我一个类似的值：34.10111º。我希望这个数字是一个没有 º 度符号的纯字符串。

我应该用不同的格式初始化字符串吗？

我尝试使用 @"%d" 格式进行初始化，并且字符串完全变成了一个不同的数字。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-04-01T00:21:17.037

您的格式字符串中有一个度数符号。删除它，你应该没问题。

至于你问题的另一部分，`%d`作为格式说明符需要一个整数，你给它一个浮点数。你`%g`是正确的，就像`%e`or一样`%f`。

# c++ - 加速 gcc 中的虚函数调用

> ID：703561
> 
> 赞同：5
> 
> 时间：2009-04-01T00:11:08.790
> 
> 标签：c++, virtual-functions, gprof

用 gprof 分析我的 C++ 代码，我发现我的大部分时间都花在了一遍又一遍地调用一个虚拟方法上。该方法本身很短，如果它不是虚拟的，可能会被内联。

有什么方法可以加快速度，而不是将其全部重写为非虚拟的？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-04-01T00:16:59.620

您确定时间都与通话有关吗？可能是成本所在的功能本身吗？如果是这种情况，简单地内联可能会使函数从您的分析器中消失，但您不会看到太多的加速。

假设它确实是进行如此多虚拟调用的开销，那么在不使事物非虚拟化的情况下，您可以做的事情是有限的。

如果电话有时间/标志之类的提前退出，那么我通常会使用两级方法。检查是通过非虚拟调用内联的，仅在必要时才调用特定于类的行为。

例如

```
class Foo
{
public:

inline void update( void )
{
  if (can_early_out)
    return;

  updateImpl();
}

protected:

virtual void updateImpl( void ) = 0;    
}; 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-04-01T00:18:53.110

时间是花在实际的函数调用上，还是花在函数本身上？

虚函数调用*明显*比非虚函数调用慢，因为虚函数调用需要额外的解引用。（如果您想阅读所有详细信息，请使用 Google 搜索“vtable”。） ）**更新：**事实证明，[维基百科的文章](http://en.wikipedia.org/wiki/Virtual_table)在这方面还不错。

但是，“值得注意”在这里意味着几条指令，如果它消耗了总计算的很大一部分，包括在被调用函数中花费的时间，那么这听起来像是一个考虑非虚拟化和内联的好地方。

但在接近 20 年的 C++ 中，我认为我从未见过真正发生过这种情况。我很想看看代码。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-04-01T00:33:48.550

如果虚拟调用确实是瓶颈，请尝试[CRTP 。](http://en.wikipedia.org/wiki/Curiously_recurring_template_pattern)

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-04-01T02:58:51.087

请注意，“虚拟”和“内联”并不是对立的——方法可以两者兼而有之。如果编译器可以在编译时确定对象的类型，它会很高兴地内联一个虚函数：

```
struct B {
    virtual int f() { return 42; }
};

struct D : public B {
    virtual int f() { return 43; }
};

int main(int argc, char **argv) {
    B b;
    cout << b.f() << endl;   // This call will be inlined

    D d;
    cout << d.f() << endl;   // This call will be inlined

    B& rb = rand() ? b : d;
    cout << rb.f() << endl;  // Must use virtual dispatch (i.e. NOT inlined)
    return 0;
} 
```

**[更新：`rb`在编译时无法知道某些真正的动态对象类型——感谢 MSalters]**

如果对象的类型可以在编译时确定但函数不是可内联的（例如它很大或在类定义之外定义），它将被非虚拟调用。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-01T21:00:30.350

如果您没有可用的 C++ 语法糖，考虑如何用老式的“C”编写代码有时会很有启发性。有时答案不是使用间接调用。有关示例，请参[见此答案。](https://stackoverflow.com/questions/584544/are-there-alternatives-to-polymorphism-in-c/586051#586051)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-02T00:20:20.603

通过更改调用约定，您可能可以从虚拟调用中获得更好的性能。旧的 Borland 编译器有一个 __fastcall 约定，它在 cpu 寄存器中而不是在堆栈中传递参数。

如果您坚持使用虚拟调用并且这几个操作确实很重要，那么请检查您的编译器文档以获取支持的调用约定。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-06-30T04:46:26.290

[这是使用 RTTI 的一种可能方法。](https://stackoverflow.com/questions/238452/c-rtti-viable-examples/238685#238685)

# ruby-on-rails - 计算机科学家的 Web 开发

> ID：703564
> 
> 赞同：15
> 
> 时间：2009-04-01T00:13:01.813
> 
> 标签：ruby-on-rails, process

我拥有计算机科学学士学位，因此具有开发在命令行或基本 GUI 上运行的软件的经验。但是，我没有制作真实、实用的网站的经验。对我来说，很明显我需要扩展我的技能以涵盖 Web 开发。我一直在使用 Ruby 开发应用程序，但我知道它在 Web 开发中非常流行。我想利用我作为程序员的技能来帮助我为乐队开发个人网站。

我有 HTML 方面的经验，但很少有 CSS 方面的经验。我想利用我的编程语言技能来创建一个网站，其中包含图片、音频剪辑、动态日历、调度请求工具以及乐队网站常见的其他功能。

有哪些资源可供称职的桌面程序员学习开发网站的整个过程？最好使用免费的 CSS 模板和 WordPress 作为我网站的基础还是从头开始？我应该使用 GUI 工具还是全部用 Vim/Emacs 编写？Ruby on Rails 是否足以满足我的个人网站需求，还是我应该考虑一个更成熟的开发平台？

我对这个项目的主要目标是加快当前的网页设计技术，并真正了解构建网站的整个过程。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-04-01T00:20:49.127

我认为在 Web 开发中要理解的一件非常重要的事情是 HTTP。HTML 和 CSS 很重要，但我认为了解 Web 的无状态特性、每个 HTTP 动词如何工作以及它们能/不能做什么更重要。

[http://www.freeprogrammingresources.com/http.html](http://www.freeprogrammingresources.com/http.html)

了解 HTTP 如何工作的一个好工具是[Fiddler](http://www.fiddler2.com/fiddler2/)。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-04-01T02:19:35.940

如果它和任何东西一样多是一种学习练习，那么就采取一种迭代的方法。建立修订。建立修订。我的（非常）粗略的指导方针如下：

**客户**

1.  从网站的结构开始，专注于客户。
2.  使用记事本并为您的乐队构建一堆静态页面。即最初的手代码。尝试使用 CSS 构建所有页面。没有表格标记。然后玩一些 Javascript 来让事情变得生动起来。（导航菜单\日历选择\等）。了解如何导入和链接到 Javascript 和 CSS 文件......以及如何处理这些文件 re:caching 等。
3.  尝试了解您可以在客户端上做什么（通常）。考虑 3-4 个浏览器（Firefox/IE6/IE8/Chrome）re:DOM 和客户端事件的细微差别。

**服务器**

4.  然后开始寻找您可能想要跨页面/会话更改的内容。即需要在服务器端操纵什么。并选择一种服务器端技术。
5.  从基本的回发处理开始。在这一点上忘记数据库。了解您选择的框架如何保持状态......不仅仅是技术的名称，还有它的真正细节。作为 Web 开发人员，您最大的资产之一就是了解您正在使用的技术的状态模型。
6.  然后深入了解所选的 Web 服务器技术（以及一般情况）。了解从客户端到服务器并返回的完整请求管道。这将教你表单、http 及其动词、Web 服务器、过滤器和模块、服务器到框架的切换、页面和控制生命周期，然后返回客户端。
7.  现在开始研究动态内容注入等。如何在您的网页中制作和使用可重用的组件。
8.  数据库、缓存、性能和诊断。
9.  然后进入所有有趣的东西，比如 ajax 等。用 jQuery 等替换你的 javascript。
10.  然后，您可以发现整个 Webservices\XML\JSON\etc 方面的内容。

**资源**

那么网络显然。对于客户端的东西，访问制作第三方 Web 控件的公司的网站可能会非常有趣。问他们到底是怎么做到的？Viewsource 是你的朋友。看看他们如何组织和构建他们的页面。选择几个好的网页设计师网站，你会发现大量关于浏览器战争等的咆哮，这些会给你很好的（幕后）信息。

一旦您到达服务器端，我会向您选择的技术供应商学习白皮书类型。即 webservers/frameworks/etc。再次找到一个 3rd 方 howto/evangelist 网站（例如，我曾经使用很多“来自 Rolla 的 4 个人”），它将演示如何做各种事情。语言学习正在进行中。基本上只是尽力而为，直到找到更好的方法....并且始终在寻找更好的方法。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-04-01T00:34:39.717

你真的需要了解 html、forms 和 css 才能到达任何地方。我说表单是因为这将为您提供理解 Web 开发的无状态性质所需的往返行程。

为了进一步说明这一点，我采访了很多人，他们认为页面上只能有一个表单，每个表单只能有一个提交按钮。这一切都归结于缺乏基础知识。

因此，我建议从 htmldog.com 开始。

之后，很多 Web 开发都是使用框架完成的。你自己做的日子已经一去不复返了（大部分情况下），但我的上述观点仍然存在。您确实需要能够自信地窥视引擎盖。

我从事 Web 开发已有 12 年了，最初是在 Solaris 和 Linux 上使用 Perl。从那时起，我还完成了 Java 和最近的 ASP.NET。然而，在我的私人项目中，我慢慢地爱上了 Django。

这些年来我发现，固有的问题——cookies、javascript、表示、状态、身份验证都是一样的，只是处理方式不同。因此，最终取决于您和您的语言偏好。在潜在就业方面加上一点开明的自我利益。

除了编程之外，您还应该熟悉 Web 服务器（首先想到 Apache 和 IIS）、Http 代码和标头、Mime 类型和编码以及 FTP。以及 Javascript（已经提到）、插件、浏览器平台和良好的开发实践，例如使用 Firebug、Fiddler 等。对可用的图像格式、图像优化、CSS sprite、内容压缩、缓存等有一个很好的了解也没有什么坏处。

一切都取决于你想从哪里开始！

对于新手，我会选择 Django 和（显然）Python。良好、干净的语言、廉价的启动选项、低成本的 IDE（即免费）和托管您的网站非常实惠。

但这只是主观意见。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-04-01T00:24:00.883

如果你的目标是

> 我对这个项目的主要目标是加快当前的网页设计技术，并真正了解构建网站的整个过程。

然后在 Ruby、PHP、Java、ASP.NET 等中**从头开始...**

当您遇到设计问题或只是想知道其他人是如何处理某事时，请查看框架。

一旦你加快速度，并且你的网站开始增长，然后进入一个框架，以跟上框架的速度。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-04-01T00:27:42.947

[如果您按照John MacIntyre 的建议](https://stackoverflow.com/questions/703564/web-development-for-a-computer-scientist/703585#703585)从头开始，您可能会倾向于 PHP。尽管有所有[缺点](https://stackoverflow.com/questions/309300/defend-php-convince-me-it-isnt-horrible)，但它确实有一本[非常好的用户手册](http://php.net/docs.php)。它也很容易上手，几乎可以安装在每台主机上，并且与 Apache 配合得很好。

此外，[w3 学校](http://www.w3schools.com/)是开始学习 CSS 和 XHTML 的好方法，但不要忘记查看[W3C](http://www.w3.org/)的规范。

另外，请阅读[此 Stack Overflow 问题和答案](https://stackoverflow.com/questions/72394/what-should-a-developer-know-before-building-a-public-web-site)。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-04-01T00:39:35.743

我同意约翰的观点。

正如您从自己攻读 BSc 的经验中所知道的那样，了解任何语言的基础知识会让您更有能力扩展该知识或进行专业化。

考虑到这一点，最好了解 HTML 和 CSS 的基础知识。

将来，当您想使用 Django 和 Rails 等框架进行大型项目时，了解语法和整体语言将有所帮助。基础知识还将特别有助于调整 CMS，如 Wordpress，使其更符合您的需求。

我想特别提到的一件事是，Web 编程，就像许多其他形式的编程一样，有自己的特殊结构和“正确”的做事方式。[http://www.w3.org](http://www.w3.org)是确保您的工作通过一般网页设计标准的好方法，大多数网站不遵循这一点，因为它很乏味，但从学习的角度来看，它可以确保您获得强大的基础。

www.w3schools.com 也是一个很好的资源，可以提供有关网络编程的详细帮助。最后，我喜欢五颜六色的代码，所以我喜欢使用基本的文本编辑器，例如 notepad++ 或 notepad2 或 gedit 来进行我的网络编码。像dreamweaver 这样的GUI 可能会用额外的垃圾和空格填充您的代码，所以我不推荐它们，但它们仍然是很棒的工具。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-04-01T01:58:18.737

不要为 Rails 烦恼——用 Ruby 编写[CGI](http://www.w3.org/CGI/)脚本。这将与您在课堂上所做的非常相似。

在你掌握了大约 30 个之后，你就会知道你想从 Web 框架中得到什么。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-04-01T22:30:52.940

我是一名计算机科学家和一名网络程序员，我建议你同时学习 HTTP 和 CGI​​：

*   [CGI 变得非常简单](http://jmarshall.com/easy/cgi/)
*   [HTTP 变得非常简单](http://jmarshall.com/easy/http/)

正如上述教程的标题所声称的那样，它们使这些概念对我来说“非常容易”。

一旦您掌握了 CGI 和 HTTP，我建议您查看以下网站，这些网站提供了丰富的 Web 编程文章和参考资料：

*   [网猴](http://www.webmonkey.com/)
*   [w3schools](http://w3schools.com/)
*   [Mozilla 开发者中心](https://developer.mozilla.org/En)

假设您想专注于编写 Web 应用程序，那么 Perl、PHP、Python 和 Ruby 都是不错的选择（我自己主要使用 Perl），我建议您对每种语言可用的流行 Web 框架进行一些研究。

最重要的是，选择简单的东西作为您的第一个 Web 应用程序，例如一个表单和一个显示提交该表单结果的页面。一些很好的例子（使用 Perl 的 CGI 模块）可以在这里找到：

*   [CGI.pm - Perl5 CGI 库](http://stein.cshl.org/WWW/CGI/)- 请参阅此页面上的第一组链接。

当您想开始编写使用数据库的 Web 应用程序时，请使用您选择的语言阅读 SQL 和流行的库/模块以进行数据库操作，尤其是允许您处理对象中的记录的 ORM（对象-关系-映射）接口- 以时尚为导向。

祝你好运！成为一名网络程序员很有趣，因为你的听众是 intarwebz！:)

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-04-01T00:19:28.723

对于您所描述的内容，Rails 或 Django 可能有点矫枉过正，但学习它们并没有什么坏处。尤其是 Django，可能会因为包含多个应用程序（例如日历）的项目的概念而变得更好。

但是，无论您是使用框架还是自己编写所有内容，您都需要了解 HTML 和 CSS。如果您拥有 CS 学士学位，那么 CSS 非常简单……您可以阅读教程并在五分钟内了解它。

# code-coverage - 基路径覆盖的意义何在？

> ID：703570
> 
> 赞同：2
> 
> 时间：2009-04-01T00:14:53.930
> 
> 标签：code-coverage

[onjava](http://www.onjava.com/pub/a/onjava/2007/03/02/statement-branch-and-path-coverage-testing-in-java.html?page=2)上的文章似乎暗示基本路径覆盖是完整路径覆盖的充分替代品，因为一些线性独立/圈复杂性魔术。

使用与文章类似的示例：

```
public int returnInput(int x, boolean one, boolean two)
{
    int y = x;
    if(one)
    {
        y = x-1;
    }
    if(two)
    {
        x = y;
    }
    return x;
} 
```

使用基组 {FF,TF,FT}，错误不会暴露。只有未经测试的 TT 路径会暴露它。

那么，基路径覆盖有什么用呢？它似乎并不比分支覆盖好多少。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-01T01:11:27.353

[免责声明：我以前从未听说过这种技术，它看起来很有趣，所以我做了一些搜索，这就是我认为我发现的。希望知道他们在说什么的人也会做出贡献......]

我认为它应该是生成分支覆盖测试的更好方法，而不是完全替代路径覆盖。这里有一个更长的文件，重申了目标：[http ://www.westfallteam.com/sites/default/files/papers/Basis_Path_Testing_Paper.pdf](http://www.westfallteam.com/sites/default/files/papers/Basis_Path_Testing_Paper.pdf)

onjava 文章说“基础路径测试的目标是独立地测试所有决策结果。测试四个基础路径实现了这一目标，使其他路径无关”

我认为这里的“无关”是指“对基础路径测试的目标来说是不必要的”，而不是人们可能认为的“完全浪费每个人的时间”。

我认为独立测试分支的目的是打破有效路径与您测试的路径之间的意外关联，当我自己编写代码和任意一组分支覆盖测试时，这些关联以可怕的频率发生。线性独立没有什么神奇之处，它只是一种生成分支覆盖率的系统方式，它阻止了测试人员对分支选择之间的相关性做出与程序员相同的假设。

所以你是对的，基础路径测试错过了你的错误，通常会错过 2^(N-1)-N 个错误，其中 N 是圈复杂度。它只是为了不要错过*最有可能出现错误*的 2^(N-1)-N 路径，因为让编码人员选择 N 路径进行测试通常会这样做;-)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-19T13:55:21.920

路径覆盖率并不比任何其他覆盖率指标好——只是这些指标显示了有多少“代码”已经过测试。您可以使用 (TF,FT) 组 TC 以及 (TT,FF) 实现 100% 分支覆盖率这一事实意味着，如果您的退出标准告诉您在 100% 覆盖率完成后退出，这完全取决于您的运气。
覆盖率不应该是测试人员关注的焦点 - 发现错误应该是并且 TC 只是一种显示错误的方式，就像覆盖率代理显示有多少显示错误活动已经完成。与所有其他白盒方法一样 - 以最小的成本争取最大的覆盖范围需要实际了解代码，以便您可以实际编写带有 TC 的缺陷。TC 仅适用于回归和作为缺陷的文档。作为测试人员的覆盖率只是对已完成多少工作的提示——只有经验才能真正有助于说明多少就足够了。由于这很难以数值形式呈现，我们使用其他方法，即覆盖率统计。不确定这对您是否有意义，我想从您发布问题之日起您离开的日期判断...

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-03-31T15:42:01.550

[我对McCabe 关于这个确切主题的工作的](http://mccabe.com/pdf/mccabe-nist235r.pdf)回忆是：您系统地生成基本路径，一次更改一个条件，并且只更改最后一个条件，直到您无法更改任何新条件。

假设我们从最短路径 FF 开始。按照算法，我们更改链中的最后一个 if，产生 FT。我们现在已经介绍了第二个 if，意思是：如果第二个 if 中有 bug，那么我们的两个测试肯定会注意第二个 if 语句突然开始执行时发生的情况，否则我们的测试不工作或我们的代码无法验证。这两种可能性都表明我们的代码需要修改。

覆盖 FT 后，我们返回路径中的一个节点并将第一个 T 更改为 F。在构建基本路径时，**我们一次只更改一个条件。**所以我们被迫离开第二个，如果相同的话，让步...... TT！

我们剩下这些基本路径：{FF, FT, TT}。哪个解决了您提出的问题。

但是等等，你说，如果错误发生在 TF 案例中怎么办？答案是：我们应该已经在其他三个测试中的两个之间注意到了它。想一想：

*   第二个如果已经有机会通过 FF 和 FT 测试独立地证明它对代码的影响，那么对程序执行的任何其他更改。
*   第一个如果有机会展示其从 FT 到 TT 的独立影响。

我们可以从 TT 案例（最长的路径）开始。我们会得到稍微不同的基础路径，但它们仍然会独立地执行每个 if 语句。

请注意，在您的简单示例中，if 语句的条件没有共线性。共线性削弱了基础路径的生成。

**简而言之**：系统地进行基础路径测试，避免了您认为的问题。基本路径测试不会告诉您如何编写可验证的代码。（TDD 就是这样做的。）更重要的是，路径测试不会告诉您需要做出哪些断言。那是你作为人类的工作。

**资料来源**：这是我的研究领域，但几年前我阅读了 McCabe 关于这个确切主题的论文：http: [//mccabe.com/pdf/mccabe-nist235r.pdf](http://mccabe.com/pdf/mccabe-nist235r.pdf)

# wpf - WPF 样式设置器 * 高度和宽度

> ID：703577
> 
> 赞同：6
> 
> 时间：2009-04-01T00:17:31.490
> 
> 标签：wpf, styles

我正在尝试创建一个 WPF 应用程序，它由一个 9x9 网格组成，其中行和列使用不同的样式。我希望做的是为列和行定义的高度和宽度提供一个星值。这在当前上下文中似乎不起作用。这甚至可能吗？如果可以，怎么做？

```
<Window x:Class="BaroqueChessUI.Window1"
xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
Title="Window1" Height="500" Width="500">
<Window.Resources>
    <Style x:Key="LightBackground" >
        <Setter Property="Control.Background" Value="Teal" />
    </Style>
    <Style x:Key="DarkBackground" >
        <Setter Property="Control.Background" Value="Maroon" />
    </Style>
    <Style x:Key="FileStyle">
        <Setter Property="Control.Width" Value="0.12" />
    </Style>
    <Style x:Key="RankStyle">
        <Setter Property="Control.Height" Value="0.12" />
    </Style>
    <Style x:Key="FileHeadingStyle">
        <Setter Property="Control.Width" Value="0.04" />
    </Style>
    <Style x:Key="RankHeadingStyle">
        <Setter Property="Control.Height" Value="0.04" />
    </Style>
</Window.Resources>
<Grid>
    <Grid.RowDefinitions>
        <RowDefinition Name="rdRank" Style="{StaticResource FileHeadingStyle}" />
        <RowDefinition Name="rdRank1" Style="{StaticResource FileStyle}" />
        <RowDefinition Name="rdRank2" Style="{StaticResource FileStyle}" />
        <RowDefinition Name="rdRank3" Style="{StaticResource FileStyle}" />
        <RowDefinition Name="rdRank4" Style="{StaticResource FileStyle}" />
        <RowDefinition Name="rdRank5" Style="{StaticResource FileStyle}" />
        <RowDefinition Name="rdRank6" Style="{StaticResource FileStyle}" />
        <RowDefinition Name="rdRank7" Style="{StaticResource FileStyle}" />
        <RowDefinition Name="rdRank8" Style="{StaticResource FileStyle}" />
    </Grid.RowDefinitions>
    <Grid.ColumnDefinitions>
        <ColumnDefinition Name="cdFile" Style="{StaticResource RankHeadingStyle}" />
        <ColumnDefinition Name="cdFile2" Style="{StaticResource RankStyle}" />
        <ColumnDefinition Name="cdFile3" Style="{StaticResource RankStyle}" />
        <ColumnDefinition Name="cdFile4" Style="{StaticResource RankStyle}" />
        <ColumnDefinition Name="cdFile5" Style="{StaticResource RankStyle}" />
        <ColumnDefinition Name="cdFile6" Style="{StaticResource RankStyle}" />
        <ColumnDefinition Name="cdFile7" Style="{StaticResource RankStyle}" />
        <ColumnDefinition Name="cdFile8" Style="{StaticResource RankStyle}" />
    </Grid.ColumnDefinitions>
</Grid> 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-04-01T03:07:58.727

网格列定义/行定义定义布局，在定义的区域内，您应该添加应该设置样式的控件（使用附加的属性可能会很乏味），所以尽量不要设置行定义/列定义本身的样式。

**造型项目：**

您可以像这样在行/列中输入控件（对不起，如果我光顾了）：

```
<Rectangle Grid.Row="0" Grid.Column="0" ></Rectangle> 
```

然后**在行/列内的控件上定义样式。**

```
<Rectangle Grid.Row="0" Grid.Column="0" Style="{StaticResource DarkBackground}"></Rectangle> 
```

**尺码（星值）：**

注意：Grid 将根据您的代码动态填充可用区域，如果您为 Grid 定义了固定的高度和宽度并希望按比例分配剩余空间，则只需应用星号值。

换句话说......关于实现“明星价值”：

> 我希望做的是为列和行定义的高度和宽度提供一个星值。

为什么不直接在定义中输入这样的值？：

```
 <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Name="rdRank" Height="500" />
            <RowDefinition Name="rdRank1" Height="60*" />
            <RowDefinition Name="rdRank2" Style="40*" />
        </Grid.RowDefinitions>
     </Grid> 
```

在此示例中，名为“rdRank”的行定义将具有固定高度“500”，剩余空间将分配给“rdRank1”，占 60%，“rdRank2”占 40%。

**附加属性：**

以你的风格：

```
 <Style x:Key="RankStyle">
        <Setter Property="Control.Height" Value="0.12" />
    </Style> 
```

您正在说明应用此样式的项目中具有名为 Height 的属性的任何控件都应采用 0.12 的值。可以这么说，Control.Height 最终会过滤掉。

如果您的目标是在 Row 上实现 0.12* 的高度，请使用：

```
 <Style x:Key="NewRankStyle" TargetType="{x:Type RowDefinition}">
        <Setter Property="Height" Value="0.12*" />
    </Style> 
```

..

```
 <Grid>
    <Grid.RowDefinitions>
        <RowDefinition Name="rdRank"  Style="{StaticResource FileHeadingStyle}" />
        <RowDefinition Name="rdRank1" Style="{StaticResource NewRankStyle}" /> 
```

使用“TargetType”允许您定位特定类型的属性，因此允许使用星值。

希望这可以为您澄清一些概念。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-08-21T22:52:06.690

行或列的星号大小仅在您为网格指定宽度和高度时才有效。如果网格根据其内容自动调整大小，则星号大小不起作用。

# ruby-on-rails - 以类似时间戳创建的分组结果

> ID：703578
> 
> 赞同：1
> 
> 时间：2009-04-01T00:18:38.603
> 
> 标签：ruby-on-rails, ruby, algorithm, grouping

在我的项目中，我想从我的数据库中选择记录，然后将它们按与特定时间范围内的最新记录相似的时间发生的记录组合在一起。

例如，时间范围为 1 小时。如果用户在下午 4:30 到下午 5:15 之间创建了 3 个帖子，在下午 1:15 到下午 1:30 之间创建了 2 个帖子，在上午 10:00 发布了 1 个帖子，我希望创建如下结构：

```
user.posts.find(:all).group_by do |post|
  # (posts have a created_at column containing both a date and time)
  # Algorithm here
end 
```

结果：

```
[
 [Tue March 31 5:15pm, [post6,post5,post4]]
 [Tue March 31 1:30pm, [post3,post2]]
 [Tue March 31 10:00am, [post1]]
] 
```

对执行此操作的最佳算法有任何想法吗？如果您不了解 Ruby，伪代码也可以。

编辑：谢谢乔尔。这是我最终使用的代码（提要而不是帖子）：

```
 def aggregate(feeds, timeLimit)
    return [] if feeds.blank?
    result = []
    bin = []
    feeds = feeds.sort_by { |f| -f.created_at.to_i }
    bin_time = feeds.first.created_at
    feeds.each do |feed|
      if (bin_time - feed.created_at) < timeLimit
        bin << feed
      else
        result << [bin_time, bin]
        bin_time = feed.created_at
        bin = [feed]
      end
    end
    result << [bin_time, bin]
    result
  end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-01T01:14:41.900

基本概念很简单，将帖子累积到垃圾箱中，然后当时间超出范围时，启动一个新垃圾箱。这是一个 Python 版本：

```
帖子 = [('post6', 1715), ('post5', 1645), ('post4', 1630)
    , ('post3', 1330), ('post2', 1315), ('post1', 1000)
    ]

rslt = []
斌 = []
binTime = 1 << 31
对于 postData，postTime 在帖子中：
    如果（postTime >= binTime - 100）：
        bin.append(postData)
    别的：
        如果斌：
            rslt.append([binTime, bin])
        binTime = postTime
        bin = [postData]

如果斌：
    rslt.append([binTime, bin])

打印 rslt

```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-01T00:54:22.213

```
if post.created_at - group_start > limit
    output current group if non-empty
    set group to current post
    set group_start to post.created_at
else
    add post to current group 
```

然后，在循环之外，如果非空，则输出当前组。根据您访问帖子的顺序调整 if 条件。

# java - 如何找出序列化 Java 对象的 serialVersionUID？

> ID：703591
> 
> 赞同：13
> 
> 时间：2009-04-01T00:27:35.273
> 
> 标签：java, serialization

我有几个在没有指定 serialVersionUID 的情况下编译的可序列化类。我现在需要向这些类添加一些数据成员，但希望保留一些已经序列化的对象。

有没有办法找出这些序列化对象的serialVersionUID，以便我可以在源代码中指定相同的ID？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-04-01T00:31:17.400

如果您尚未修改代码，您可能可以运行 serialver 工具（JDK 的一部分）并查看它生成的内容。我相信这会让你得到计算出来`seriVersionUID`的结果。

[这是关于serialver的简短文章。](http://betweengo.com/2005/07/30/serialver/)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-04-01T00:38:06.167

我通常做的是，我编译代码，尝试运行它，并且引发的异常提到了有问题的 SVUID，所以我可以将它剪切并粘贴到我自己的代码中。粗鲁，但它有效。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-01T00:35:50.480

如果您使用的是 Eclipse，它有一个“快速修复”来生成计算出的 serialVersionUID。这当然只有在对象被序列化时拥有类的（确切）源时才有效。

如果您至少有它们的类文件，请使用“serialver”命令行工具（JDK 附带）。

# asp.net - 调试.Net OracleClient 错误

> ID：703595
> 
> 赞同：0
> 
> 时间：2009-04-01T00:29:11.383
> 
> 标签：asp.net, oracleclient

我们目前在同一个网站上使用 iBatis 和 nHibernate。在特定页面上执行保存会引发以下错误：

System.Data.OracleClient.OracleException: ORA-01453: SET TRANSACTION 必须是事务的第一条语句

堆栈跟踪显示在此问题的末尾。这只发生在这一页上（至少我们已经看到了。）

代码非常基本，在验证当前没有活动事务后调用 BeginTransaction。我很难过并寻找想法：1.可能导致问题的原因 2.如何调试/故障排除 - （例如：有没有办法窥探通过 System.Data.OracleClient 发送到 Oracle 的命令？）

感谢您的任何帮助。

System.Data.OracleClient.OracleConnection.CheckError(OciErrorHandle errorHandle, Int32 rc) +304553 System.Data.OracleClient.OracleCommand.Execute(OciStatementHandle statementHandle, CommandBehavior behavior, Boolean needRowid, OciRowidDescriptor& rowidDescriptor, ArrayList& resultParameterOrdinals) +990 System.Data.OracleClient .OracleCommand.ExecuteNonQueryInternal(Boolean needRowid, OciRowidDescriptor& rowidDescriptor) +431 System.Data.OracleClient.OracleCommand.ExecuteNonQuery() +115 System.Data.OracleClient.OracleTransaction..ctor(OracleConnection connection, IsolationLevelisolationLevel) +377 System.Data.OracleClient .OracleInternalConnection.BeginOracleTransaction(IsolationLevel il) +101 System.Data.OracleClient.OracleInternalConnection.BeginTransaction(IsolationLevel il) +4 System.Data.OracleClient。OracleConnection.BeginDbTransaction(IsolationLevel isolationLevel) +63 System.Data.Common.DbConnection.System.Data.IDbConnection.BeginTransaction(IsolationLevel isolationLevel) +10 NHibernate.Transaction.AdoTransaction.Begin(IsolationLevel isolationLevel) +176

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-01T01:15:19.747

确保关闭自动提交。此外，有些语句不能批量发送（例如，DDL） - 对于那些您必须单独发送它们或使用 execute_sql

# c# - 帮助正则表达式模式

> ID：703600
> 
> 赞同：2
> 
> 时间：2009-04-01T00:31:52.393
> 
> 标签：c#, regex

我有一个 txt 文件，每行都有一组随机字符串，我只需要选择仅包含字符的行：1234567890qwertyuiopasdfghjklzxcvbnm-._~

我正在逐行阅读并逐个字符地验证字符，我认为这不是最好的方法，而且我认为 RegEx 会是完美的。

那么有人可以为此提供模式吗？

谢谢！

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-04-01T00:34:44.600

```
 /^[-0-9a-z._~]*$/

 ^       :: matches the start of a string/start of a line
 [       :: start of a character class, means match any one of the contained characters
 -       :: dash has a special meaning in character classes, so to avoid having it interpreted for its special meaning, list it first
 0-9     :: shorthand for 0123456789 in a character class
 a-z     :: shorthand for abcdefghijklmnopqrstuvwxyz in a character class
 ._~     :: means exactly these characters in a character class
 ]       :: end of the character class 
 *       :: match zero or more of the previous atom (in this case, the character class)
 $       :: matches the end of a string/end of a line 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-01T00:38:30.753

如果我很好理解你，你可以这样做：

```
/^([-0-9a-zA-Z._~]\n)+$/ 
```

它不区分大小写，检查行尾并且不匹配空行。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-01T00:44:46.683

意识到正则表达式应该等价于`^[1234567890qwertyuiopasdfghjklzxcvbnm\-._~]*$`. 从那里你可以缩小范围，用`0-9`,`a-z`等替换。在使用从别人那里得到的答案之前，您应该学习正则表达式的基础知识。

# php - 在 PHP 中发布变量

> ID：703601
> 
> 赞同：1
> 
> 时间：2009-04-01T00:33:25.320
> 
> 标签：php, post, variables

如何在不使用表单的情况下在 PHP 中发布变量，并从下一页访问变量。

不过，我真正想做的是发布这样的变量：

```
$username = "Sam";
$_POST[$username]; 
```

然后我试图从我元刷新到的页面访问它。

有任何想法吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-04-01T00:36:01.260

你想达到什么目的？我想你可能想要[Sessions](http://us2.php.net/manual/en/ref.session.php)：

```
// page1.php
session_start();
$_SESSION['username'] = 'Sam';
header('Location: page2.php');

// page2.php
session_start();
print 'Hello, ' . $_SESSION['username'] . '!'; 
```

但是，如果您确定这是您想要的，请查看[cURL](http://us2.php.net/curl)，它可以让您 POST 到一个页面，但我不确定它是否会让您准确导航到它，可以这么说。不过，您可以获得它的输出：

```
// page1.php
$curl = curl_init('http://www.mysite.com/page2.php');
curl_setopt($curl, CURLOPT_HEADER, 0);
curl_setopt($curl, CURLOPT_POST, 1);
curl_setopt($curl, CURLOPT_POSTFIELDS, array('username' => 'Sam'));
curl_setopt($curl, CURLOPT_RETURNTRANSFER, 1);
$result = curl_exec($curl);
curl_close($curl);
print $result; // prints "Hello, Sam!"

// page2.php
print 'Hello, ' . $_POST['username'] . '!'; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-01T00:56:23.783

看看我对[在 PHP 页面之间传递信息](https://stackoverflow.com/questions/622297/passing-information-between-php-pages/622366#622366)的问题的回答，我想你可能会感兴趣。它讨论了 PHP 页面之间现有的几种通信方法之间的差异。

更具体地说，这是与您的问题有关的摘要：

1.  使用`$_GET`（直接**在**URL 中传递的信息）您可能能够传递变量，具体取决于它们是什么以及您要实现的目标。

2.  使用`$_POST`（在 HTTP 标头中发布**到**URL 的信息）您将无法重定向到页面，因为这是由浏览器（客户端）而不是由服务器（运行 PHP 脚本的位置）完成的）。不过，您可以使用隐藏表单和一些 javascript 来发布帖子（以及同时进行重定向）。这可能会奏效，具体取决于您的目标受众，因为 javascript 并非万无一失；它可能在浏览器上被禁用。您也可以像某些人所说的那样使用 CURL，尽管这会将您的服务器模拟为浏览器；数据将代表您的用户发布，但他不会自动重定向到**页面**发布的数据。例如，如果此发布的最终结果是对用户进行身份验证，则您的用户（客户端）将不会为他打开会话。

3.  使用`$_SESSION`, 与保留在服务器端的信息。它仅（自动）将唯一标识符传递给浏览器（通常通过 cookie），以将用户链接到您为他在您的网站上的会话存储的数据。当然，这仅在您将用户重定向到您自己的应用程序而不是另一个网站时才有用。

因此，根据您的具体问题，有不同的可能解决方法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-11-02T14:38:22.663

目标页面会知道它是基于 CURL 还是基于表单的提交？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-01T00:34:51.247

我不认为这是可能的。尝试改用 $_GET 或会话变量。

编辑：实际上，显然[你可以使用 CURL](http://www.askapache.com/htaccess/sending-post-form-data-with-php-curl.html)。

或者[这个方法](http://www.sajithmr.com/php-post-without-curl/)，看起来它只是写入文件并再次读取变量。我认为你最好使用会话变量。

# php - Sql 查询不工作！

> ID：703608
> 
> 赞同：0
> 
> 时间：2009-04-01T00:35:52.600
> 
> 标签：php, sql, mysql

```
INSERT INTO `test` (`x`, `y`)  WHERE `id` = `$id`

VALUES (`$x`, `$y`) 
```

这个查询有什么问题？我`mysql_query()`在 php 文件中的函数中运行它。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-01T00:38:06.933

您不能将 Where 子句与插入一起使用。您要么插入一行，要么不插入。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-01T00:38:28.587

如果您尝试从数据库更新信息，请在您正在运行的查询中使用 UPDATE 而不是 INSERT INTO。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-01T00:39:05.433

您不能在插入时使用 where 子句。我想你可能想要一个更新声明：

```
update test set
x = $x,
y = $y
where id = $id 
```

当您在数据库中插入一个新值时，通常在插入之后才会有 ID 值（假设您使用的是自动生成的 ID）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-01T00:38:44.637

您需要删除“WHERE id=$id”——它在 INSERT 语句中没有任何意义。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-01T01:44:26.617

所以，要么

更新测试集 x='x', y='$y' WHERE id ='$id';

或者

插入测试（'x'，'y'）值（'$x'，'$y'）；

如其他帖子所述 - 您不能使用 WHERE 进行 INSERT。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-01T03:29:32.043

另请注意，您必须使用单引号 (') 而不是反引号 (`) 来表示值。引用列名/字段名时使用反引号。

这个：

```
`field` = '$value' 
```

而不是这个：

```
`field` = `$value` 
```

除非你真的想引用另一个字段。这有时是您在复制值或匹配 JOIN 等时想要的。但是因为你有一个变量，我假设你想使用单引号而不是反引号。

# javascript - 使用 Firebug Lite (1.2) 您会在生产站点中使用它吗？

> ID：703612
> 
> 赞同：1
> 
> 时间：2009-04-01T00:37:40.617
> 
> 标签：javascript, internet-explorer, firebug

我尝试使用 Firebug Lite（通过小书签并将其添加到我的一个网站）。

我似乎收到了警报：

> 无法检测到以下脚本“firebug-lite.js”...如果脚本已重命名，请设置 firebug.env.liteFilename 的值以反映此更改

很多。特别是当我尝试关闭选项卡时。这发生在 Firefox、Camino 和 Safari 中。

我想知道的是，这是可以使用了吗？还是我需要复制代码，在本地发布并破解它？我已经检查了文档，它非常有限。

我也在查看 mod 日期，该网站自 2008 年年中以来似乎一直相对空闲。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-01T01:33:31.387

javascript 文件以 77,305 字节四舍五入，因此我认为您不会希望在生产站点上使用它，除非您使用动态语言并且可以在需要进行调试时有条件地输出脚本。

（即[http://www.somefakesite.com/page?debug=true](http://www.somefakesite.com/page?debug=true)）

只要您仅在实际调试时将文件包含在页面中，除非脚本无法正常工作，否则从何处提取脚本可能无关紧要，在这种情况下，您必须修改并提供它你自己。

# asp.net - 如何使用自联接和项目表“分层结构”绑定 asp.net 控件？

> ID：703613
> 
> 赞同：3
> 
> 时间：2009-04-01T00:38:02.550
> 
> 标签：asp.net, sql-server, treeview, hierarchy

我有以下表格：
1-Categories：
-CategoryID
-CategoryName
-ParentID

2-Items：
-ItemId
-ItemName -CategoryID
类别

可以在分层视图中，彼此之间有许多子类别。
并且任何最后一个子类别都可以包含项目，因此只有最后一个子类别会在其下显示项目。
该视图就像一个树视图，当单击一个项目时，它将转到一个新页面。

我是这样写的：

```
<asp:Repeater runat="server" ID="rptCategories" OnItemDataBound="rptCategories_ItemDataBound" >
    <ItemTemplate>
        <div id="type_<%# Eval("Type") %>">
            <p >
                <a id="<%# Eval("CategoryID") %>" class="Categories">
                    <%# Eval("CategoryName") %></a>
            </p>
            <div id="ProjectsDiv_<%# Eval("CategoryID") %>" class="Projects">

                <asp:Repeater ID="rptProjects" runat="server">
                    <ItemTemplate>
                        <a id="<%# Eval("ProjectID") %>" class="ProjectLink">
                        <%# GetProject(Eval("ProjectID"))%>

                        </a>
                    </ItemTemplate>
                </asp:Repeater>
            </div>
        </div>
    </ItemTemplate>
</asp:Repeater> 
```

但这代表了一个层次结构，
我的问题是如何将其作为树视图？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-01T00:50:20.507

为此，您需要两个类 - 一个用于树状控件，另一个用于将数据提供给层次结构中的控件。

*   对于控件，您可以只使用[TreeView之类的东西，或者您可以通过从](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.treeview.aspx)[HierarchalDataBoundControl](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.hierarchicaldataboundcontrol.aspx)继承来编写自己的控件。

*   对于数据源，由于您有一个非常具体和自定义的数据格式，您需要编写一个实现[IHierarchalDataSource](http://msdn.microsoft.com/en-us/library/system.web.ui.ihierarchicaldatasource.aspx)的类。该类将成为控件的 DataSource，当您调用 DataBind 时，它将以分层方式向控件提供数据。

[这是一个](http://weblogs.asp.net/dannychen/archive/2005/12/19/433523.aspx)关于如何从头开始构建 HierarchalDataBoundControl 的教程。

另一种选择是只使用递归并对其进行快速而肮脏的处理。[我在这里](https://stackoverflow.com/questions/636943/return-unordered-list-from-hierarchical-sql-data/637007)回答了一个相关的问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-09-23T10:35:44.580

如果（！IsPostBack）{填充（TreeView1.Nodes）；

```
 }
    }

  protected  void TreeView1_SelectedNodeChanged(object sender, EventArgs e)
    {
        TreeNode node = TreeView1.SelectedNode;
        string nodeId = node.Value;
        string nodeName = node.Text;

    }
    private void Populate(TreeNodeCollection nodes)
    {
        TreeNode parentNode = null;
        foreach (Category1 category in GetProductCategories())
        {
            parentNode = new TreeNode(category.Name, category.Id.ToString());
            if (category.Subcategories != null)
            {
                SubNodes(category, parentNode);
            }
            parentNode.Collapse();
            TreeView1.Nodes.Add(parentNode);
        }
    }
    private void SubNodes(Category1 category, TreeNode childNode)
    {
        foreach (Category1 c1 in category.Subcategories)
        {
            TreeNode subchildnode = new TreeNode(c1.Name, c1.Id.ToString());
            childNode.ChildNodes.Add(subchildnode);
            if (c1.Subcategories != null)
            {
                SubNodes(c1, subchildnode);
            }
        }
    }
    protected void TreeView1_TreeNodePopulate(object sender, TreeNodeEventArgs e)
    {
    }
    #region unwanted

    // Show all checkboxes

    //TreeView1.ShowCheckBoxes = TreeNodeTypes.All;
    //protected void TreeView1_TreeNodePopulate(object sender, TreeNodeEventArgs e)
    //{
    //    PopulateSubLevel(Int32.Parse(e.Node.Value), e.Node);
    //}
    //private void PopulateSubLevel(int parentid, TreeNode parentnode)
    //{
    //    Populate1( parentid,parentnode.ChildNodes);
    //}
    //private void Populate1(int k1,TreeNodeCollection nodes)
    //{
    //    foreach (var j in GetProductCategories())
    //    {
    //        if (j.ParentId == k1)
    //        {
    //            foreach (var k in j.Subcategories)
    //            {

    //                TreeNode tn = new TreeNode();
    //                tn.Text = k.Name;
    //                tn.Value = k.ParentId.ToString();
    //                nodes.Add(tn);
    //                //tn.PopulateOnDemand = ((int)(k.Subcategories.Count) > 0);

    //            }
    //           // break;
    //        }

    //    }
    //}
    #endregion
    #region class
    //public List<Category1> GetProductCategories()
    //{
    //    return new List<Category1> { 
    //        new Category1{Id=1,Name="Power Tools",ParentId=0,Sequence=1,Description="Power Tools",DisplayInHeader=true, 
    //            Subcategories = new List<Category1>
    //                {new Category1{Id=100,Name="Drills",ParentId=1,Sequence=1,Description="Drills",DisplayInHeader=true},
    //                new Category1{Id=101,Name="Drill Accessories",ParentId=1,Sequence=1,Description="Drill Accessories",DisplayInHeader=true},
    //                new Category1{Id=102,Name="Saws",ParentId=0,Sequence=1,Description="Saws",DisplayInHeader=true}  
    //                }},
    //                new Category1{Id=2,Name="Cordless Tools",ParentId=1,Sequence=1,Description="Cordless Tools",DisplayInHeader=true, 
    //            Subcategories = new List<Category1>
    //                {new Category1{Id=200,Name="Batteries/Chargers",ParentId=2,Sequence=1,Description="Batteries/Chargers",DisplayInHeader=true} 

    //                }},new Category1{Id=3,Name="AirTools",ParentId=2,Sequence=1,Description="Air Tools",DisplayInHeader=true, 
    //            Subcategories = new List<Category1>
    //                {new Category1{Id=300,Name="Portable Compressors",ParentId=0,Sequence=1,Description="Portable Compressors",DisplayInHeader=true},

    //                }}
    //    };
    //}
    #endregion

    public List<Category1> GetProductCategories()
    {
        return new List<Category1> { 
            new Category1{Id=1,Name="Power Tools",ParentId=0,Sequence=1,Description="Power Tools",DisplayInHeader=true, 
                Subcategories = new List<Category1>
                    {new Category1{Id=100,Name="Drills",ParentId=1,Sequence=1,Description="Drills",DisplayInHeader=true},
                    new Category1{Id=101,Name="Drill Accessories",ParentId=1,Sequence=1,Description="Drill Accessories",DisplayInHeader=true,
                        Subcategories= new List<Category1>{new Category1{Id=1001,Name="Drill Accessories",ParentId=101,Sequence=1,Description="Drill Accessories",DisplayInHeader=true,
                        Subcategories= new List<Category1>{new Category1{Id=1001,Name="Drill Accessories",ParentId=101,Sequence=1,Description="Drill Accessories",DisplayInHeader=true}}}}},                              

                    new Category1{Id=102,Name="Saws",ParentId=0,Sequence=1,Description="Saws",DisplayInHeader=true}  
                    }},
                    new Category1{Id=2,Name="Cordless Tools",ParentId=1,Sequence=1,Description="Cordless Tools",DisplayInHeader=true, 
                Subcategories = new List<Category1>
                    {new Category1{Id=200,Name="Batteries/Chargers",ParentId=2,Sequence=1,Description="Batteries/Chargers",DisplayInHeader=true,
                    Subcategories = new List<Category1>
                    {new Category1{Id=200,Name="Batteries",ParentId=2,Sequence=1,Description="Batteries/Chargers",DisplayInHeader=true,
                    Subcategories = new List<Category1>
                    {new Category1{Id=200,Name="Batteries",ParentId=2,Sequence=1,Description="Batteries/Chargers",DisplayInHeader=true,
                    Subcategories = new List<Category1>
                    {new Category1{Id=200,Name="Batteries",ParentId=2,Sequence=1,Description="Batteries/Chargers",DisplayInHeader=true,
                    Subcategories = new List<Category1>
                    {new Category1{Id=200,Name="Batteries",ParentId=2,Sequence=1,Description="Batteries/Chargers",DisplayInHeader=true}}}}}}}}} 

                    }},new Category1{Id=3,Name="AirTools",ParentId=2,Sequence=1,Description="Air Tools",DisplayInHeader=true, 
                Subcategories = new List<Category1>
                    {new Category1{Id=300,Name="Portable Compressors",ParentId=0,Sequence=1,Description="Portable Compressors",DisplayInHeader=true},

                    }},

        };
    } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-01T00:46:21.857

如果您不知道层次结构有多深，那么中继器将变得复杂。为什么不直接使用 asp.net TreeView？

> [http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.treeview.aspx](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.treeview.aspx)

您可以使用 asp.net ajax 和一个 updatepanel 来实现您想要的效果，而无需自己编写任何 javascript。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-04-01T00:52:53.467

Oracle 有一个专为分层查询设计的 CONNECT BY 语句。至少从 Sql Server 2005 开始，我不相信有直接的等价物，所以你不得不用存储过程来伪造它......

# iis - 对运行 IIS 的生产系统进行负载测试的良好基准测试是什么？

> ID：703632
> 
> 赞同：1
> 
> 时间：2009-04-01T00:44:24.843
> 
> 标签：iis, load-testing, stress-testing, webapplicationstresstool

我注意到一些关于压力测试 IIS 的[帖子](https://stackoverflow.com/questions/7492/how-do-you-stress-test-a-web-application)，但我更感兴趣的是了解一种建立物理 Web 服务器可以处理的基准的好方法。

我现在正在开发一个生产系统，该系统似乎每天都在减速到几乎停止，似乎没有人能弄清楚是什么导致了这个问题。这是您的标准 N 层设置（客户端、Web 服务器、数据库服务器）。我创建了一些简单的 ASP.NET 页面，它们可以做一些简单的事情，我正在使用这些页面来建立压力测试基准，以便以后在与已经存在的生产系统进行比较时使用它。

我已经构建了一个示例 aspx 页面，它只是返回一些有关盒子利用率的 Web 服务器统计信息，没有什么繁重的，可能只有几行代码。我还创建了一个简单的 Web 服务 (asmx)，它将在给定正确 id 的情况下测试数据库连接，再次打开一个数据库连接和一个实际上并没有做任何事情的示例查询。

我想知道的是，***以下测试应该在什么压力水平下运行***？特别是，我正在使用**Microsoft 的 Web 应用程序压力工具**，我很好奇大多数人会期望**压力水平**和**压力乘数** **可以接受**范围应该是。我已经知道 Web 服务器在什么时候开始弯曲，它大约 20 的压力水平和 10 的压力乘数给予或接受，这导致大约 275 个页面请求/秒。我试图找出这个数字是否太低，这是否表明客户端和 Web 服务器之间存在问题或某种硬件问题，或者是否更多地表明存在没有错，而且系统太重了。

**更新：**自从我最初写这篇文章以来，代码已经移动到使用 IIS 7 运行 Windows 2003 的服务器上。

我现在想知道的是，如果我设置了一个相对简单的测试，例如只提供一个小页面的基本 index.html 文件，您期望我可以实现的“最佳”页面请求/秒是多少压力测试？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2011-02-27T23:54:00.727

> 我现在想知道的是，如果我设置了一个相对简单的测试，例如只提供一个小页面的基本 index.html 文件，您期望我可以实现的“最佳”页面请求/秒是多少压力测试？

我不能谈论微软的 Web 应用程序压力工具，但是应该可以在 IIS 上托管一个静态 html 页面，直到测试机器和服务器之间的网络泛滥或测试服务器耗尽 CPU 来创建和编译测试. ISS 所做的只是每次都发送相同的缓存响应。

要获得有关您网站的工作方式的良好概况，您确实需要建立一个良好的表示访问该网站的实际流量。一旦你有了模型，你就可以开始扩大使用它的人数，以探索哪些页面最慢以及哪些服务器资源最先靠墙。

您将有一个或多个页面的性能对于给定的负载是不可接受的，或者某些服务器统计数据（如磁盘使用情况或数据库性能）正在查看过度使用。

除非您在托管在与生产站点相同架构上的站点上进行测试，否则很难提出架构建议。

对于表现不佳的页面，由于代码可用于分析，因此更容易进行改进。

I recommend using Visual Studio Ultimate edition to load test if you can get it. It also gives some ASP.NET profiling tools to get to grips with sections of code and database calls.

# nhibernate - NHibernate 标准类型不匹配

> ID：703638
> 
> 赞同：1
> 
> 时间：2009-04-01T00:47:35.460
> 
> 标签：nhibernate, nhibernate-mapping

这段代码

```
ICriteria crit = service.Session.CreateCriteria(typeof (DatabaseVersion));
crit.Add(Restrictions.Eq("Id.Minor", 4));
IList<DatabaseVersion> list = crit.List<DatabaseVersion>(); 
```

导致以下错误：NHibernate.QueryException：NHibernate.Criterion.SimpleExpression 中的类型不匹配：Id.Minor 预期类型 System.Int16，实际类型 System.Int32

我该如何纠正这个错误？我没有运气在映射文件中设置类型。我宁愿不必在代码中键入强制转换。

根据要求添加了映射文件。

```
<?xml version="1.0" encoding="utf-8" ?>
<hibernate-mapping xmlns="urn:nhibernate-mapping-2.2">
  <class name="Core.NUnit.Domain.DatabaseVersion,Core.NUnit" table="`DatabaseVersion`" lazy="true" >
    <composite-id name="Id" class="Core.NUnit.Domain.DatabaseVersionId,Core.NUnit">
      <key-property name="Major" column="`Major`" />
      <key-property name="Minor" column="`Minor`" type="Int16"/>
      <key-property name="Build" column="`Build`" />
      <key-property name="Revision" column="`Revision`" />
    </composite-id>
    <property name="Description" column="`Description`"/>
    <property name="DateApplied" column="`DateApplied`"/>
  </class>
</hibernate-mapping> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-01T01:21:14.677

我认为问题可能是 C# 不能将 int 隐式转换为 short。看起来您的映射将此字段映射到 Int16（短）。默认情况下，您传入的“4”分配为 int。（我不知道为什么将 int 与 short 进行比较会遇到问题......）

我不认为有一个简短的文字后缀。您也许可以这样做：

```
crit.Add(Restrictions.Eq("Id.Minor", (short)4)); 
```

# iphone - 执行反向地理位置查找

> ID：703647
> 
> 赞同：0
> 
> 时间：2009-04-01T00:54:41.387
> 
> 标签：iphone, geolocation

我对 iPhone SDK 和 Cocoa 开发还很陌生。我想知道如何调用一个网络服务，它将从我的 iPhone 中获取纬度和经度值并将它们提供给网络服务，以便我可以检索城市、州。我已经把电话位置的东西摆平了。我只是在寻找我应该将此信息传递到哪里以及如何将这些数据解析回我的应用程序。

本质上，我只希望“城市，州”在我的一个视图的标签中可见。

我第一次尝试这个是在 geonames.org 上，它把我返回的 lat/lng 位置放在离我实际所在的地方很多很多英里的地方。我用谷歌地图 api 尝试了相同的 lat/lng 值，它在正确的位置。我遇到的唯一问题是将 JSON 数据解析回我的应用程序。返回的信息似乎有多个版本的相同信息，我似乎无法理解它是如何工作的。

所以再一次。只需寻找一个简单的 HTTP 样式字符串，我就可以将我的 lat/lng 值传递到某个地方，它会返回“City,State”。如果您提到的示例涉及解析数据。请参考我可以剖析的示例-我是菜鸟。

哦，最后一件事，我知道使用 iPhone 3.0 SDK 可能会更容易，但我目前正在 2.2.1 上构建这个项目 - 并且有足够的理由这样做，直到应用程序的其余部分完成移植到 3.0。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-01T05:48:00.853

看看[这里](https://stackoverflow.com/questions/524077/iphone-development-locate-address-from-users-position)和[这里的回复](https://stackoverflow.com/questions/158557/get-street-address-at-lat-long-pair)

# c# - C# 项目的自定义构建步骤

> ID：703651
> 
> 赞同：4
> 
> 时间：2009-04-01T00:57:50.067
> 
> 标签：c#

在 C++ 项目中，可以为文件设置自定义构建步骤。C# 项目中是否有类似的功能？我真的找不到任何东西。

一个想法是创建第二个项目（makefile 或 c++）并将文件移到那里。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-01T01:56:05.123

MsBuild 应该适合您，尽管可能需要一些时间才能弄清楚它是如何工作的。看来您可以通过将每个 .cs 文件分成其自己的构建组来设置在构建每个 .cs 文件之前运行的步骤。

在[将每个 .cs 文件编译成 EXE 的 MSBuild 脚本中](http://blogs.msdn.com/dotnetinterop/archive/2008/04/16/msbuild-script-for-compiling-each-cs-file-into-an-exe.aspx)，Dino Chiesa 评论道：

> 通过使用 %(CSFile.identity) 标量，我们为每个文件运行一次此任务。反过来是@(CSFile.identity)。这将对所有文件运行一次编译，将它们全部编译成一个程序集。

此外，这些链接可能会有所帮助：

[C# 文件的自定义构建步骤](http://social.msdn.microsoft.com/Forums/en-US/msbuild/thread/ab3bcb1b-4ced-4e28-abd3-05c1be1156be/)

[使用 MSBuild 掌握复杂的构建](http://www.devx.com/dotnet/Article/39347/1763)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-01T01:10:36.293

没有针对 C# 项目的单个文件的自定义构建步骤。你可能可以用 MSBuild 破解一些东西......

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-01T01:17:23.953

查看您的 csproj 文件中的 BeforeBuild 和 AfterBuild 目标。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-01T01:02:20.773

我认为您对多个项目的评论是正确的。将此与您可以在单个解决方案中包含多个项目的事实相结合，您可能会得到答案。我使用此功能一次构建多个组件，并且效果很好。

# asp.net - 用于 ASP.NET 的基于 Web 的图像编辑和注释控件

> ID：703652
> 
> 赞同：0
> 
> 时间：2009-04-01T00:57:52.360
> 
> 标签：asp.net, user-controls, image-manipulation

我支持我们可以购买的控件来裁剪和注释来自 ASP.NET 网站的图像。

客户希望能够裁剪、更改对比度等并添加形状（线条、正方形、圆形、文本等）。图像质量不需要那么高。

这些图像用于“证据”，并带有注释以解释正在发生的事情、指向感兴趣的区域等。

客户会更喜欢基于 Web 的控件，因为用户将使用带有 IE 7 的瘦客户端。

客户喜欢[Phixr](http://www.phixr.com)和[Snipshot](http://snipshot.com/)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-03T01:02:49.240

免责声明：我为 Atalasoft 工作

我们有可以做到这一点的网络控件。见点图

[http://www.atalasoft.com/products/dotimage](http://www.atalasoft.com/products/dotimage)

您可以查看演示、下载评估或观看视频教程，了解如何使用我们的控件构建网站。它是 100% AJAX——在 IE、FireFox、Safari 和 Chrome 中受支持。

# jms - ActiveMQ 消息分组性能

> ID：703659
> 
> 赞同：5
> 
> 时间：2009-04-01T01:03:44.127
> 
> 标签：jms, message-queue, messaging, activemq

有人使用过 ActiveMQ 中的消息分组功能吗？

[http://activemq.apache.org/message-groups.html](http://activemq.apache.org/message-groups.html)

对于我正在从事的项目来说，这将是一个非常有用的功能，但我很好奇这个功能的扩展性和性能如何。在我们的系统中，我们需要将消息分组为大约 3-5 条消息的组，因此我们将在进程运行时不断添加组。在这种情况下，似乎我们最终会在尝试存储所有组时耗尽内存。

我对任何经验/想法/优点/缺点感兴趣。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-01T14:02:50.650

我在许多项目中都使用过消息组，效果很好。尽管为了全面披露，我是推动消息组的人之一，并完成了大部分初始实施工作。

消息组的用例来自划分大型主题层次结构；比如处理金融股票代码之类的。我们希望消息组能够使用非常细粒度的相关表达式（JMSXGroupID 字符串）——因此您可以使用日期、股票代码和产品类型作为 groupID——或者客户或业务交易 ID 或其他任何内容。

为了避免必须将每个组 ID 字符串保存在内存中，默认提供程序使用哈希桶——因此我们只存储哈希桶到消费者的映射——而不是单个字符串。因此，它可以扩展到您想要使用的任意数量的组 ID！这也意味着我们不必“清理”旧的消息组 ID 等

# silverlight - 没有办法从 Silverlight 项目中的 XAML 编辑器生成事件处理程序

> ID：703666
> 
> 赞同：0
> 
> 时间：2009-04-01T01:10:51.457
> 
> 标签：silverlight, xaml

不想参与在代码或 XAML 中连接事件处理程序的辩论，我只想说，我似乎记得在 Silverlight 项目的 XAML 编辑器中有一种“创建选项卡”功能。显然，自从我编写 XAML 代码以来已经有一段时间了，但我确信这是一个简单的过程，即在代码隐藏文件中添加事件处理程序以用于 XAML 页面上的控件。

谁能告诉我是不是在做梦？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-01T01:14:05.457

我知道您可以在创建 silverlight 2 项目时使用该功能。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-01T01:34:54.533

重新应用 Visual Stduio 2008 SP1 纠正了这个问题——看图。

# c# - 将 XML 文件添加到 Visual Studio 2008 项目的优点和用途

> ID：703668
> 
> 赞同：1
> 
> 时间：2009-04-01T01:11:04.497
> 
> 标签：c#, xml, visual-studio

将 XML 文件添加到 Visual Studio 2008 项目（例如 Windows 窗体应用程序项目）有什么好处。

添加到项目后，如何引用此 XML 以在同一项目的类中使用它？在这种情况下，我会将其作为查询发送到 Web 服务。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-01T04:54:21.450

如果您想以某种形式使用 XML，您可以在属性窗口中将其标记为“嵌入式资源”，然后从您的代码中访问它，如下所示：

```
Assembly a = Assembly.GetExecutingAssembly();
if(a != null)
{
  Stream s = a.GetManifestResourceStream(typeof(yourType), "YourXmlName.xml");

  if (s != null)
  {
    String xmlContents = new StreamReader(s).ReadToEnd();
  }
} 
```

完成后，如果一切顺利，您将在“xmlContents”中获得 XML 文件的内容。

马克

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-01T01:23:44.983

我想将 XML 驻留在项目（甚至解决方案）中的优势在于，您可以在 VS 中以良好的格式甚至智能感知来维护它，但随后使用 XML Spy 之类的东西或任何可以给您的东西。

要在课程中引用它，您需要确保您可以访问它，并且它位于可靠的位置。

过去，我使用构建后事件将文件的最新副本移动到我需要的位置。正如 Arnshea 在这里写的，另一个答案是“输出目录”。您可以使用 XML 文件本身的“复制到输出目录”属性来实现此目的。然后您的类可以使用 XML 文件，因为知道它将驻留在一个可靠的地方。

您需要确保它是可访问的，尤其是在您回信时。确保它不会以“只读”结尾——就像源代码控制系统可以对你做的那样。将这些文件存储在 Program Files 下的文件夹中也可能会出现问题，尤其是在 Vista 上，用户权限（应该）受到限制。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-01T01:12:58.033

如果您的应用需要加载 XML，可以将其复制到输出目录。还简化了设置/部署项目的使用...

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-01T02:34:53.220

另一个主要优点是（假设它就位——而且应该是！）是您可以对 XML 文件应用修订控制。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-01T04:14:33.263

我猜您不会一遍又一遍地向 WebService发送**相同的 XML 文件。**
您将希望每次都修改它的内容，因为您有[XML 序列化](http://msdn.microsoft.com/en-us/library/ms950721.aspx)。
如果上述所有条件都适用，那么您**不需要**XML 文件，您只需要在运行时生成文件的类。XML 只是一种传输方式，今天它是 XML，明天它可能是某种其他格式 (JSON)。

# objective-c - 连接 NSString 和 int 的最简单方法

> ID：703669
> 
> 赞同：27
> 
> 时间：2009-04-01T01:11:07.960
> 
> 标签：objective-c, string, cocoa, cocoa-touch, nsstring

Objective-C 中是否有一个通用功能可以插入到我的项目中以简化连接`NSString`s 和`int`s？

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2009-04-01T01:15:48.060

```
[NSString stringWithFormat:@"THIS IS A STRING WITH AN INT: %d", myInt]; 
```

这就是我通常的做法。

* * *

## 回答 #2

> 赞同：30
> 
> 时间：2009-04-01T08:04:34.647

两个答案都是正确的。如果要连接多个字符串和整数，请使用 NSMutableString 的 appendFormat。

```
NSMutableString* aString = [NSMutableString stringWithFormat:@"String with one int %d", myInt];    // does not need to be released. Needs to be retained if you need to keep use it after the current function.
[aString appendFormat:@"... now has another int: %d", myInt]; 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-01T01:17:34.437

```
NSString *s = 
   [
       [NSString alloc] 
           initWithFormat:@"Concatenate an int %d with a string %@", 
            12, @"My Concatenated String"
   ]; 
```

我知道您可能正在寻找更简短的答案，但这是我会使用的。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-04-02T07:40:41.997

string1,x ，它们分别被声明为字符串对象和整数变量。如果您想组合这两个值并将 int 值附加到字符串对象并将结果分配给新字符串，请执行以下操作。

```
NSString *string1=@"Hello"; 

int x=10;

NSString *string2=[string1 stringByAppendingFormat:@"%d ",x];

NSLog(@"string2 is %@",string2);

//NSLog(@"string2 is %@",string2); is used to check the string2 value at console ; 
```

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2013-06-28T11:36:16.537

似乎真正的答案是否定的 - 没有简单快捷的方法将 NSStrings 与 Objective C 连接 - 与在 C# 和 Java 中使用“+”运算符没有任何相似之处。

# c# - 为您的控制反转容器反转控制？

> ID：703680
> 
> 赞同：0
> 
> 时间：2009-04-01T01:15:46.593
> 
> 标签：c#, asp.net, ioc-container, ninject

我最近不得不将使用 Ninject 1.0 的相对较大的控件库更新到 Ninject 2.0，以帮助解决我在 1.0 中遇到的一些问题。更新进展顺利，我认为 Ninject 2.0 更快。

然而，为了在未来尝试避免这个问题，我创建了自己的用于注入字段和属性的接口（这实际上将调用我希望在当前 Web 应用程序中使用的 IOC 容器上的方法）。所以现在我的控制库独立于任何特定的 IOC 容器，这将加速未来该领域的任何变化。

我想知道有没有其他人做过同样的事情？

我对它所取得的成就感到满意，但理想情况下我想更新它。在我的控件中，我通常将这些注入字段创建为受保护的，并将它们设置在该控件的构造函数中。

```
IBlogService _blogService = null;
IEmailService _emailService = null;

public Templates_BlogTemplate()
{
    Inject(ref _blogService);
    Inject(ref _emailService);
} 
```

我遇到的问题是我必须在所有对象上使用“ref”来实际设置属性，而我不能直接在属性上使用它。

我更愿意按照这些思路做一些事情，但我认为这是不可能的。

```
IBlogService _blogService = null;
IEmailService _emailService = null;

public Templates_BlogTemplate()
{
    Inject(_blogService, _emailService);
} 
```

有没有人对如何整理代码或使其以更清洁的方式工作有任何想法？我还想避免使用属性，因此它会迫使开发人员决定在控件中的某个点注入变量。

欢迎所有的想法和感受。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-01T04:41:26.630

支持属性注入，将依赖注入到“this”。

就我而言，我有一个调用 StructureMap.BuildUp(this) 的基类，并且用户控件将具有如下属性：

```
public IBlogService _blogService{get;set;}
public IEmailService _emailService{get;set;} 
```

我拥有的唯一特定于结构图的行是在基类中。如果 ninject 允许您这样做，那么您可以调用您的代码，将控件实例交给它，并让它根据其配置注入属性。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-01T13:49:47.360

您可能想查看[Glenn Block](http://codebetter.com/blogs/glenn.block/archive/2008/10/02/iservicelocator-a-step-toward-ioc-container-service-locator-detente.aspx)所描述的[IServiceLocator](http://www.codeplex.com/CommonServiceLocator)

它是一个共享接口，可用于利用 IoC，而不会对容器产生硬依赖。

# math - VB脚本数学函数

> ID：703687
> 
> 赞同：0
> 
> 时间：2009-04-01T01:18:33.030
> 
> 标签：math, function, asp-classic, vbscript

我有一个 ASP 页面，其中有 2 个变量，`strActualRate`并且`strProposed`. 这些值为：

`strActualRate`= 33.30
`strProposed`= 33.3

因此，当我编写以下行进行比较时：

```
if strActualRate <> strProposed  then
  Response.Writr "Both are not equal!"
end if 
```

我得到输出“两者都不相等”，即使两者相同。我确定我需要使用一些数学转换函数来进行比较。

谁能告诉我如何解决这个问题？

提前致谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-01T01:30:51.893

如果我理解正确，您认为这两个值是相等的，但是因为 VBScript 比较的是字符串而不是数字，所以这两个值不相等。

您的转换想法是正确的，这是代码：

```
if CDbl(strActualRate) <> CDbl(strProposed) then
     Response.Write "Both are not equal!"
end if 
```

这会将您的字符串值转换为数字以进行比较。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-01T01:35:00.760

你的问题并没有真正加起来，所以我不确定问题是什么。我将尝试澄清一些关于数据类型和比较的事情。

您正在为变量使用前缀“str”，这表明您打算在其中存储字符串值，但是您正在将数值存储在其中。要么您对如何使用匈牙利符号来跟踪数据类型感到困惑，要么您发布的代码看起来不像您实际使用的代码。

数值 33.30 与值 33.3 完全相同。如果您改为使用字符串值“33.30”和“33.3”，它们将是两个不相等的字符串。

If your code is corrected (Response.Write instead of Response.Writr) so that it runs, it will not produce any output at all. As the values are equal, the condifion in the if statement evaluates to false.

If you do in fact assign string values to the variables, the code would output "Both are not equal!". This is just as expected as the strings are not equal. If you have strings and want to compare them as numerical values, you have to comvert them:

```
If CDbl(strActualRate) <> CDbl(strProposed)  Then
  Response.Write "Both are not equal!"
End If 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-01T01:32:55.850

[尝试使用CDbl()](http://www.w3schools.com/VBscript/func_cdbl.asp)在比较语句中将值转换为双精度

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-01T01:41:30.603

Are you intending to perform the comparison as strings, floating point numbers or some other method? If you are comparing them as strings, then clearly they are not equal, as one of them has an extra zero on the end. If you are comparing them as floating point numbers, then you generally want to use a comparison that involves taking the difference and checking that it is smaller than some small value. This is because floating point number calculations involve some degree of inaccuracy and comparisons between them can fail because of the underlying representation.

# c++ - delete[] 怎么知道它是一个数组？

> ID：703691
> 
> 赞同：145
> 
> 时间：2009-04-01T01:22:05.440
> 
> 标签：c++, arrays, pointers, new-operator, delete-operator

好吧，我想我们都同意以下代码发生的事情是未定义的，具体取决于传递的内容，

```
void deleteForMe(int* pointer)
{
     delete[] pointer;
} 
```

指针可以是各种不同的东西，因此`delete[]`对它执行无条件是未定义的。但是，让我们假设我们确实传递了一个数组指针，

```
int main()
{
     int* arr = new int[5];
     deleteForMe(arr);
     return 0;
} 
```

我的问题是，在这种情况下，指针**是**一个数组，谁知道这一点？我的意思是，从语言/编译器的角度来看，它不知道`arr`是数组指针还是指向单个 int 的指针。哎呀，它甚至不知道是否`arr`是动态创建的。但是，如果我改为执行以下操作，

```
int main()
{
     int* num = new int(1);
     deleteForMe(num);
     return 0;
} 
```

操作系统足够聪明，只删除一个 int 而不会通过删除超出该点的其余内存来进行某种类型的“杀戮狂欢”（与`strlen`非`\0`终止字符串对比——它将一直持续到它命中 0)。

那么记住这些事情是谁的工作呢？操作系统是否在后台保留某种类型的记录？（我的意思是，我意识到我在开始这篇文章时说发生的事情是不确定的，但事实是，“杀戮狂欢”的场景并没有发生，因此在现实世界中*有人*会记住。）

* * *

## 回答 #1

> 赞同：113
> 
> 时间：2009-04-01T01:49:16.230

到目前为止给出的答案似乎没有解决一个问题：如果运行时库（实际上不是操作系统）可以跟踪数组中的事物数量，那么我们为什么需要`delete[]`语法呢？为什么不能使用单个`delete`表单来处理所有删除？

这个问题的答案可以追溯到 C++ 作为与 C 兼容的语言的根源（它不再真正努力成为）。Stroustrup 的理念是程序员不应该为他们不使用的任何功能付费。如果他们不使用数组，那么他们不应该为每个分配的内存块承担对象数组的成本。

也就是说，如果您的代码只是

```
Foo* foo = new Foo; 
```

那么分配的内存空间`foo`不应该包括支持`Foo`.

由于只设置了数组分配来携带额外的数组大小信息，因此您需要告诉运行时库在删除对象时查找该信息。这就是为什么我们需要使用

```
delete[] bar; 
```

而不仅仅是

```
delete bar; 
```

如果 bar 是指向数组的指针。

对于我们大多数人（包括我自己）来说，这些天对额外的几个字节内存的大惊小怪似乎很古怪。但是在某些情况下，节省几个字节（可能是非常多的内存块）可能很重要。

* * *

## 回答 #2

> 赞同：105
> 
> 时间：2009-04-01T01:30:15.450

编译器不知道它是一个数组，它信任程序员。删除指向单个`int`with的指针`delete []`会导致未定义的行为。您的第二个`main()`示例是不安全的，即使它不会立即崩溃。

编译器确实必须跟踪需要以某种方式删除多少对象。它可以通过过度分配足够的空间来存储数组大小来做到这一点。有关更多详细信息，请参阅[C++ 超级常见问题解答](https://isocpp.org/wiki/faq/freestore-mgmt#num-elems-in-new-array)。

* * *

## 回答 #3

> 赞同：30
> 
> 时间：2009-04-01T01:34:01.463

是的，操作系统在“背景”中保留了一些东西。例如，如果您运行

```
int* num = new int[5]; 
```

操作系统可以分配 4 个额外的字节，将分配的大小存储在分配内存的前 4 个字节中并返回一个偏移指针（即，它分配内存空间 1000 到 1024，但返回的指针指向 1004，位置为 1000- 1003 存储分配的大小）。然后，当调用 delete 时，它​​可以查看传递给它的指针之前的 4 个字节以找到分配的大小。

我确信还有其他方法可以跟踪分配的大小，但这是一种选择。

* * *

## 回答 #4

> 赞同：13
> 
> 时间：2009-04-01T01:33:45.130

[这与这个](https://stackoverflow.com/questions/197675/how-does-delete-know-the-size-of-the-operand-array)问题非常相似，它包含您正在寻找的许多细节。

但我只想说，跟踪这些都不是操作系统的工作。实际上是运行时库或底层内存管理器将跟踪数组的大小。这通常是通过预先分配额外的内存并将数组的大小存储在该位置（大多数使用头节点）来完成的。

这可以通过执行以下代码在某些实现上查看

```
int* pArray = new int[5];
int size = *(pArray-1); 
```

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2009-04-16T10:44:09.527

`delete`或者`delete[]`可能都释放分配的内存（指向内存），但最大的区别是`delete`在数组上不会调用数组每个元素的析构函数。

反正混和`new/new[]`大概`delete/delete[]`就是UB。

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2009-04-01T01:31:22.530

它不知道它是一个数组，这就是为什么你必须提供`delete[]`而不是常规的 old `delete`。

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2010-01-28T00:46:46.183

我有一个类似的问题。在 C 中，您使用 malloc()（或其他类似函数）分配内存，并使用 free() 删除它。只有一个 malloc()，它只是分配一定数量的字节。只有一个 free()，它只是将指针作为参数。

那么为什么在 C 中你可以将指针交给 free，但在 C++ 中你必须告诉它它是数组还是单个变量？

我了解到，答案与类析构函数有关。

如果你分配一个 MyClass 类的实例...

```
classes = new MyClass[3]; 
```

并用delete删除它，你可能只会得到第一个调用的MyClass实例的析构函数。如果你使用delete[]，你可以确保为数组中的所有实例调用析构函数。

这是重要的区别。如果您只是使用标准类型（例如 int），您将不会真正看到这个问题。另外，您应该记住，在 new[] 上使用 delete 和在 new[] 上使用 delete[] 的行为是未定义的——它可能不会在每个编译器/系统上以相同的方式工作。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2009-04-01T01:32:35.040

由运行时负责内存分配，就像您可以在标准 C 中使用 free 删除使用 malloc 创建的数组一样。我认为每个编译器都以不同的方式实现它。一种常见的方法是为数组大小分配一个额外的单元格。

但是，运行时还不够聪明，无法检测它是数组还是指针，你必须通知它，如果你弄错了，你要么没有正确删除（例如，ptr 而不是数组），要么您最终会获得与大小无关的值并造成重大损害。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2014-02-24T09:59:46.603

编译器的一种方法是分配更多内存并将元素计数存储在头元素中。

示例如何完成：这里

```
int* i = new int[4]; 
```

编译器将分配 sizeof(int)*5 字节。

```
int *temp = malloc(sizeof(int)*5) 
```

将存储`4`在第一个`sizeof(int)`字节中

```
*temp = 4; 
```

并设置`i`

```
i = temp + 1; 
```

所以`i`指向 4 个元素的数组，而不是 5 个。

和

```
delete[] i; 
```

将按照以下方式处理

```
int *temp = i - 1;
int numbers_of_element = *temp; // = 4
... call destructor for numbers_of_element elements if needed
... that are stored in temp + 1, temp + 2, ... temp + 4
free (temp) 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2010-01-28T00:54:35.230

从语义上讲，C++ 中两个版本的删除操作符都可以“吃掉”任何指针。但是，如果将指向单个对象的指针分配给`delete[]`，则会导致 UB，这意味着任何事情都可能发生，包括系统崩溃或什么都没有。

C++ 要求程序员根据释放的主题选择合适的删除操作符版本：数组或单个对象。

如果编译器可以自动确定传递给删除运算符的指针是否为指针数组，那么 C++ 中将只有一个删除运算符，这两种情况都足够了。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2011-05-06T09:49:48.983

同意编译器不知道它是否是一个数组。这取决于程序员。

编译器有时会通过过度分配足够存储数组大小来跟踪需要删除多少对象，但并非总是必要的。

有关分配额外存储时的完整规范，请参阅 C++ ABI（编译器是如何实现的）：[Itanium C++ ABI: Array Operator new Cookies](http://www.codesourcery.com/public/cxx-abi/abi.html#array-cookies)

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2019-03-08T13:05:26.937

“未定义的行为”仅仅意味着语言规范不保证会发生什么。这并不一定意味着会发生不好的事情。

> 那么记住这些事情是谁的工作呢？操作系统是否在后台保留某种类型的记录？（我的意思是，我意识到我在开始这篇文章时说发生的事情是不确定的，但事实是，“杀戮狂欢”的场景并没有发生，因此在现实世界中有人会记住。）

这里通常有两层。底层内存管理器和 C++ 实现。

大多数内存管理器都是为了满足 C 语言的需要而设计的。在 C 中，“免费”功能不需要用户指定块的大小。因此，内存管理器将记住（除其他外）分配的内存块的大小。这可能比 C++ 实现要求的块大。通常，内存管理器会在分配的内存块之前存储它的元数据。

C++ 有一种文化“你只需为你使用的东西付费”。因此，C++ 实现通常只会记住数组的大小，如果它出于自己的目的需要这样做，通常是因为该类型具有非平凡的析构函数。

因此，对于具有微不足道的析构函数的类型，“delete”和“delete []”的实现通常是相同的。C++ 实现只是将指针传递给底层内存管理器。就像是

```
free(p) 
```

另一方面，对于具有非平凡析构函数的类型，“delete”和“delete []”可能不同。“删除”类似于（其中 T 是指针指向的类型）

```
p->~T();
free(p); 
```

虽然“删除[]”会是这样的。

```
size_t * pcount = ((size_t *)p)-1;
size_t count = *count;
for (size_t i=0;i<count;i++) {
  p[i].~T();
}
char * pmemblock = ((char *)p) - max(sizeof(size_t),alignof(T));
free(pmemblock); 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-04-10T17:18:49.590

您不能将*delete*用于数组，也不能将*delete []*用于非数组。

* * *

## 回答 #14

> 赞同：-1
> 
> 时间：2016-01-27T16:15:08.273

遍历对象数组并为每个对象调用析构函数。我创建了这个简单的代码，它重载了 new[] 和 delete[] 表达式，并提供了一个模板函数来释放内存并在需要时为每个对象调用析构函数：

```
// overloaded new expression 
void* operator new[]( size_t size )
{
    // allocate 4 bytes more see comment below 
    int* ptr = (int*)malloc( size + 4 );

    // set value stored at address to 0 
    // and shift pointer by 4 bytes to avoid situation that
    // might arise where two memory blocks 
    // are adjacent and non-zero
    *ptr = 0;
    ++ptr; 

    return ptr;
}
//////////////////////////////////////////

// overloaded delete expression 
void static operator delete[]( void* ptr )
{
    // decrement value of pointer to get the
    // "Real Pointer Value"
    int* realPtr = (int*)ptr;
    --realPtr;

    free( realPtr );
}
//////////////////////////////////////////

// Template used to call destructor if needed 
// and call appropriate delete 
template<class T>
void Deallocate( T* ptr )
{
    int* instanceCount = (int*)ptr;
    --instanceCount;

    if(*instanceCount > 0) // if larger than 0 array is being deleted
    {
        // call destructor for each object
        for(int i = 0; i < *instanceCount; i++)
        {
            ptr[i].~T();
        }
        // call delete passing instance count witch points
        // to begin of array memory 
        ::operator delete[]( instanceCount );
    }
    else
    {
        // single instance deleted call destructor
        // and delete passing ptr
        ptr->~T();
        ::operator delete[]( ptr );
    }
}

// Replace calls to new and delete
#define MyNew ::new
#define MyDelete(ptr) Deallocate(ptr)

// structure with constructor/ destructor
struct StructureOne
{
    StructureOne():
    someInt(0)
    {}
    ~StructureOne() 
    {
        someInt = 0;
    }

    int someInt;
};
//////////////////////////////

// structure without constructor/ destructor
struct StructureTwo
{
    int someInt;
};
//////////////////////////////

void main(void)
{
    const unsigned int numElements = 30;

    StructureOne* structOne = nullptr;
    StructureTwo* structTwo = nullptr;
    int* basicType = nullptr;
    size_t ArraySize = 0;

/**********************************************************************/
    // basic type array 

    // place break point here and in new expression
    // check size and compare it with size passed 
    // in to new expression size will be the same
    ArraySize = sizeof( int ) * numElements;

    // this will be treated as size rather than object array as there is no 
    // constructor and destructor. value assigned to basicType pointer
    // will be the same as value of "++ptr" in new expression
    basicType = MyNew int[numElements];

    // Place break point in template function to see the behavior
    // destructors will not be called and it will be treated as 
    // single instance of size equal to "sizeof( int ) * numElements"
    MyDelete( basicType );

/**********************************************************************/
    // structure without constructor and destructor array 

    // behavior will be the same as with basic type 

    // place break point here and in new expression
    // check size and compare it with size passed 
    // in to new expression size will be the same
    ArraySize = sizeof( StructureTwo ) * numElements;

    // this will be treated as size rather than object array as there is no 
    // constructor and destructor value assigned to structTwo pointer
    // will be the same as value of "++ptr" in new expression
    structTwo = MyNew StructureTwo[numElements]; 

    // Place break point in template function to see the behavior
    // destructors will not be called and it will be treated as 
    // single instance of size equal to "sizeof( StructureTwo ) * numElements"
    MyDelete( structTwo );

/**********************************************************************/
    // structure with constructor and destructor array 

    // place break point check size and compare it with size passed in
    // new expression size in expression will be larger by 4 bytes
    ArraySize = sizeof( StructureOne ) * numElements;

    // value assigned to "structOne pointer" will be different 
    // of "++ptr" in new expression  "shifted by another 4 bytes"
    structOne = MyNew StructureOne[numElements];

    // Place break point in template function to see the behavior
    // destructors will be called for each array object 
    MyDelete( structOne );
}
/////////////////////////////////////////// 
```

* * *

## 回答 #15

> 赞同：-2
> 
> 时间：2016-09-08T16:56:36.337

只需在类中定义析构函数并使用两种语法执行代码

```
delete pointer

delete [] pointer 
```

根据输出你可以找到解决方案

* * *

## 回答 #16

> 赞同：-3
> 
> 时间：2015-05-27T09:41:01.920

答案：

int* pArray = new int[5];

整数大小 = *(pArray-1);

上面发布的内容不正确并产生无效值。“-1”计数元素在 64 位 Windows 操作系统上，正确的缓冲区大小位于 Ptr - 4 字节地址

# cocoa - Cocoa：测量按键之间的时间？

> ID：703696
> 
> 赞同：2
> 
> 时间：2009-04-01T01:24:58.740
> 
> 标签：cocoa

我正在尝试编写一个需要接受按键的应用程序，并在用户停止键入时（或按键之间有指定的延迟）调用一个函数。

如何测量两次击键之间的时间？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-11-12T23:46:30.120

像这样的东西：

```
NSDate *start = [NSDate date];
// do the thing you are timing
NSDate *stop = [NSDate date];

NSTimeInterval duration = [start timeIntervalSinceDate:stop]; 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-01T09:21:53.120

可能更好的方法是获取与每个按键关联的 NSEvent 并比较它们的 -timestamp 属性的差异。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-01T05:24:43.857

获取当前时间，然后减去之前的当前时间。请参阅[-[NSDate timeIntervalSinceDate:]](http://developer.apple.com/documentation/Cocoa/Reference/Foundation/Classes/NSDate_Class/Reference/Reference.html#//apple_ref/occ/instm/NSDate/timeIntervalSinceDate:)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-11-12T23:54:56.197

*   您可以设置计时器以在用户停止输入后执行 X 时间量，然后在每次用户输入内容时重新启动时间 - 这样它会延迟计时器到期。

如果很容易在计时器上重置超时，则不确定这对计算量有多大。

*   或者，您可以在最后一次击键时启动计时器 X 时间。到期时，您可以检查上次击键的时间戳，这是您在上次击键时保存的，然后您可以从（超时 - 上次击键时间）时间量开始重新启动计时器。到期后再次检查。然后，如果计时器正在运行，则在每次击键时仅更新最后一次击键的时间戳......

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-02-28T15:18:12.203

我认为你应该为此使用线程。为键创建线程，在每个线程中，您可以计算击键之间的时间。有关更多解释，请观看我的视频以获取此确切解决方案。

[https://www.youtube.com/watch?v=sDGYM8LeZh8](https://www.youtube.com/watch?v=sDGYM8LeZh8)

请看下面的代码：

```
import keyboard # keyboard library
import string   # string for capturing keyboard key codes
import time     # for capturing time

from threading import * # threads for keypresses

# get the keys
keys = list(string.ascii_lowercase)

# key listener
def listen(key):
    while True:
        global timeda   # global variable for storing time for 1st keypress
        global newda    # global variable for storing time for next keypress

        keyboard.wait(key)  # when key is presses

        # check if variables are defined
        try:
            timeda
            newda

        # this will run for the first keypress only so assign initial time to variable

        except NameError:
            timeda = time.time()
            newda  = time.time()
            print("First key is pressed at "+str(round(newda,2)))
            print('\n==========\n')

        # for all keypresses except for the first will record time here
        else:
            newda = time.time()         # assign time for next keypressed
            newtime = newda - timeda    # get difference between two keys presses

            # just to test time of first keypress
            print("Previous keypress was at "+str(round(timeda,2)))

            # just to test time of next keypress
            print("Current keypress is at "+ str(round(newda,2)))

            # convert time into seconds
            newtime = newtime % 60

            print("Difference between two keypresses is "+str(round(newtime,2)))
            print('\n==========\n')     # need some space for printing difference 
            timeda = time.time()

# creating threads for keys and assigning event and args 
threads = [Thread(target=listen, kwargs={'key':key}) for key in keys]

# calling each thread
for thread in threads:
    thread.start()

# thats it 
```

# .net - 针对不受信任的 SSL 端点生成 WCF 代理

> ID：703698
> 
> 赞同：6
> 
> 时间：2009-04-01T01:25:09.550
> 
> 标签：.net, wcf, web-services, ssl

我需要为我们的客户端公开的服务生成 WCF 代理。该服务被非常严格地锁定，所以这很困难。另外，我是 WCF 的新手，所以我可能会遗漏一些明显的东西......

客户端只向我们的生产服务器打开了防火墙 - 所以我无法在我的开发机器上从 Visual Studio 生成代理。此外，该服务仅通过 HTTPS 公开。它要求我们使用客户端证书进行身份验证......

我希望在生产机器上运行 svcutil 以生成 .cs 文件，然后将文件复制到本地。但是 svcutil 拒绝运行，因为客户端使用的是自签名证书。它给了我以下错误：

> 基础连接已关闭：无法为 SSL/TLS 安全通道建立信任关系。根据验证程序，远程证书无效。

我尝试将服务的证书添加为受信任的根证书，但这不起作用。在证书 MMC 管理单元中，我得到“Windows 没有足够的信息来验证证书”。

有什么方法可以绕过 svcutil 正在执行的安全检查吗？

当我远程访问生产服务器时，我可以从 IE 成功浏览到 WSDL。我只需点击“继续浏览本网站（不推荐）”。我还必须选择已安装的客户端证书，它工作正常。然后我可以通过 IE 手动下载 WSDL 和 XSD 文件。因此，另一种选择可能是从 WSDL 和 XSD 的本地副本生成 WCF 代理，而不是针对实时服务运行 svcutil。但我不知道如何正确地做到这一点。

我尝试将静态 WSDL 和 XSD 文件放在我们托管的另一个网站上，并更改 <xs:import schemaLocation="..."/> 属性以指向新网站。但是当我对这个站点运行 svcutil 时，我得到了一堆关于重复类型声明的错误 - 例如：

> 错误：导出期间生成的架构出现验证错误：来源：行：1 列：1415 验证错误：complexType ' [http://[domain-name]/Promotions/2009-02-17:InsertReferralPromo_Response](http://[domain-name]/Promotions/2009-02-17:InsertReferralPromo_Response) '已经被宣布。

我是否错过了一些明显的方法来做到这一点？还是我们应该要求客户放松他们的安全性？:)

感谢您能给我的任何帮助...
理查德

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-01T02:13:56.780

您的问题似乎与安全性无关。您下载的 WSDL 和模式似乎有问题。

一种建议是将所有文件放在磁盘上的目录中，而不是放在网站上。如有必要，请删除 schemaLocation 属性。

但是，这似乎没有帮助。您可以尝试使用 XMLSpy 验证这些文件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-22T16:29:48.540

当您浏览到 WSDL 时，单击证书，查看证书，然后安装证书。

然后尝试再次运行 svcutil。

# java - 有哪些工具可以让我从 Java 转储和重新创建数据库？

> ID：703699
> 
> 赞同：2
> 
> 时间：2009-04-01T01:25:29.877
> 
> 标签：java, database

我正在寻找一种工具，可以让我从 PHPMyAdmin 复制数据库导出和导入功能，以便我可以复制生产数据库以在构建脚本（Gradle 或 Ant）中进行测试。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-01T01:32:22.433

不确定这是否正是您所需要的，但我过去曾使用[Apache 的 DDLUtils](http://db.apache.org/ddlutils/)库来做类似的事情。对于我的项目，我们实际上需要将模式和数据从 MySQL 移动到 JavaDB，这个库使它非常简单。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-01T01:33:16.473

你这样做是为了单元测试吗？您可以使用具有导出到 XML 功能的 dbUnit——然后可以在运行测试之前使用 XML 加载表。不确定这是您要寻找的东西，但希望它能给您一些探索的东西。

# fonts - 如何使用 FreeType 确定字体中没有字形的所有代码点？

> ID：703700
> 
> 赞同：2
> 
> 时间：2009-04-01T01:26:40.297
> 
> 标签：fonts, freetype, freetype2

这个问题与

[有没有办法以编程方式确定字体文件是否具有特定的 Unicode 字形？](https://stackoverflow.com/questions/103725/is-there-a-way-to-programatically-determine-if-a-font-file-has-a-specific-unicode)

但是，我正在寻找不使用 Windows API 的解决方案。尤其是 Freetype 看起来很有希望，我想知道是否有熟悉它的人可以提供指针。

基本上，我想给定一种字体，计算从字符映射到一系列代码点的映射，而没有该字符映射的字形。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-01-30T06:24:24.990

特别是对于 FreeType，您可以使用[FT_Get_Char_Index](http://freetype.sourceforge.net/freetype2/docs/reference/ft2-base_interface.html#FT_Get_Char_Index)函数。此函数返回 0 的 glyphID 以指示未映射的字形。

用更一般的术语来说：首先你需要选择一个字符映射表（一些字体包括用于不同平台或单个平台下不同目的的多个映射），然后从显式映射的字形构建一个字典，并针对它进行测试。

# wpf - WPF - 如何将样式应用于 AdornedElementPlaceholder 的 AdornedElement？

> ID：703701
> 
> 赞同：5
> 
> 时间：2009-04-01T01:26:49.280
> 
> 标签：wpf, validation, styles

我正在尝试将样式应用于装饰元素，但我不知道正确的语法。这是我尝试过的：

```
 <!-- ValidationRule Based Validitaion Control Template -->
    <ControlTemplate x:Key="validationTemplate">
        <DockPanel>
            <TextBlock Foreground="Red" FontSize="20">!</TextBlock>
            <AdornedElementPlaceholder Style="textStyleTextBox"/>
        </DockPanel>
    </ControlTemplate> 
```

唯一的问题是以下行不起作用：

```
 <AdornedElementPlaceholder Style="textStyleTextBox"/> 
```

任何帮助将不胜感激。

谢谢，

-查尔斯

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-04-01T10:32:13.667

需要把资源的来源放在哪里。

```
<TextBox Style="{StaticResource textStyleTextBox}"/> 
```

然后在用户控件资源等资源中定义样式：

```
<UserControl.Resources>
  <Style TargetType="TextBox" x:Key="textStyleTextBox">
    <Setter Property="Background" Value="Blue"/>
  </Style>
</UserControl.Resources> 
```

但是我不相信你想在占位符中设置装饰元素的样式。它只是具有该模板的任何控件的占位符。您应该像我上面提供的示例一样在元素本身中设置装饰元素的样式。如果您想根据控件的验证设置控件的样式，则如下所示：

```
<Window.Resources>
   <ControlTemplate x:Key="validationTemplate">
       <DockPanel>
           <TextBlock Foreground="Yellow" Width="55" FontSize="18">!</TextBlock>
           <AdornedElementPlaceholder/>
       </DockPanel>
   </ControlTemplate>
   <Style x:Key="textBoxInError" TargetType="{x:Type TextBox}">
       <Style.Triggers>
           <Trigger Property="Validation.HasError" Value="true">
               <Setter Property="Background" Value="Red"/>
               <Setter Property="Foreground" Value="White"/>
           </Trigger>
       </Style.Triggers>
   </Style>
</Window.Resources>
<StackPanel x:Name="mainPanel">
    <TextBlock>Age:</TextBlock>
    <TextBox x:Name="txtAge"
             Validation.ErrorTemplate="{DynamicResource validationTemplate}"
             Style="{StaticResource textBoxInError}">
         <Binding Path="Age" UpdateSourceTrigger="PropertyChanged" >
             <Binding.ValidationRules>
                 <ExceptionValidationRule/>
             </Binding.ValidationRules>
         </Binding>
    </TextBox> 
</StackPanel> 
```

# ajax - 什么引发了 HTTP 503 以及如何更改超时？

> ID：703702
> 
> 赞同：13
> 
> 时间：2009-04-01T01:27:37.093
> 
> 标签：ajax, http, timeout, weblogic, http-status-code-503

我继承了一个应用程序（我公司内部的），它使用在 Internet Explorer 中运行的 javascript，它使 Ajax 调用在 WebLogic Server v10 中运行的基于 Struts 的应用程序。

系统中的某些服务器端操作耗时超过 3 分钟。用户一直注意到 Ajax 调用在 3 分钟时返回 503 错误。我的用户可以等待超过 3 分钟，但 503 错误会中断他们的工作。

此应用程序需要进行性能调整，但我们迫切需要一个临时解决方法来延长返回 503 错误之前可能发生的时间。

目前的理论是 503 错误是由 IE XMLHttpRequest 对象引发的。一组假定的 WebLogic 专家倾注了我们的代码和 WebLogic 日志，并宣布服务器端没有发生超时。但我有我的怀疑。

我的问题是，哪个软件负责引发 503 错误：浏览器、Ajax javascript 还是服务器？这个超时时间可以改变吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-01T01:35:36.093

503 错误是许多不同类型错误的统称，通常在服务器端。在您的情况下，服务器可能只是在某个超时后拒绝连接，并以 503 响应以指示服务器过载或无法处理您的请求。

很多时候使用 Web 服务，当服务器代码抛出异常或错误时，将返回 503。如果服务器代码没有正确处理错误，它将冒泡到服务器，服务器只会以通用 503 响应。

[http://www.checkupdown.com/status/E503.html](http://www.checkupdown.com/status/E503.html)

[错误代码 5xx（替代定义）](http://en.wikipedia.org/wiki/List_of_HTTP_status_codes#5xx_Server_Error)

[RFC 2616](http://www.w3.org/Protocols/rfc2616/rfc2616-sec10.html)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-01T01:37:24.607

503 是服务器错误。XMLHttpRequest 将愉快地等待超过 3 分钟。您应该做的第一件事是通过在 telnet 或 netcat 或类似中访问问题 URL 并查看带有 javascript 的 503 来满足自己的要求。

然后您可以继续在服务器端查找超时。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-01T01:34:44.440

您的 Web 服务器有一个请求回复超时，该超时被长时间运行的服务请求触发。它可以是 WebLogic 服务器或代理。肯定不是客户端。

您是否考虑过提交将立即响应的异步 HTTP 请求，然后轮询另一个位置以获取最终结果？三分钟太长了大约 170 秒。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2015-07-16T17:44:26.157

503 很可能是由于服务器超时。如果您可以调整您的 Apache 服务器，请阅读您可以在 httpd.conf 中设置的 Timeout 属性。查看 httpd/logs/error_log 以查看是否发生超时。另请参阅此答案：[Mod cluster proxy timeout in apache error logs](https://stackoverflow.com/questions/20749501/mod-cluster-proxy-timeout-in-apache-error-logs)。

# php - 在会话上实施安全性

> ID：703704
> 
> 赞同：0
> 
> 时间：2009-04-01T01:28:08.387
> 
> 标签：php, security, session

如何保护我的会话发布的数据以减少注入？

当我使用 $_SESSION[''] = $var; 时可能需要添加一些东西吗？或者当我通过 $var = $_SESSION['']; 检索数据时？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-01T01:33:29.640

你说的安全是什么意思？这取决于您最终将要对数据做什么以及数据的来源，在这种情况下，它与您对其他变量所做的没有什么不同。如果您计划在`$_SESSION`数组上显示数据，您应该使用[`htmlentities`](http://www.php.net/htmlentities)或[`htmlspecialchars`](http://www.php.net/htmlspecialchars)防止 XSS 等对其进行转义。如果您`$_SESSION`在查询中使用数组中的数据，您应该[`mysql_real_escape_string`](http://www.php.net/mysql_real_escape_string)这样做（或者，更好的是，使用绑定参数）以防止注射。如果您可以完全控制要进入 的数据，`$_SESSION`则无需担心太多。

# javascript - 如何将 javascript 注入 IE 8 上的页面？

> ID：703705
> 
> 赞同：6
> 
> 时间：2009-04-01T01:30:02.503
> 
> 标签：javascript, internet-explorer-8, mootools

假设我有以下标记：

```
<div id="placeHolder"></div> 
```

我有一个 JavaScript 变量`jsVar`，其中包含一些标记和一些 JavaScript。

通过使用 Mootools 1.1，我可以将 JavaScript 内容注入到占位符中，如下所示：

```
$('placeHolder').setHTML(jsVar); 
```

这适用于 Firefox、Opera 甚至 Safari，生成的标记如下所示：

```
<div id="placeHolder">
    <strong>I was injected</strong>
    <script type="text/javascript">
        alert("I was injected too!");
    </script>
</div> 
```

但是，在 IE 8 上，我得到以下信息：

```
<div id="placeHolder">
    <strong>I was injected</strong>
</div> 
```

有什么方法可以在 IE 8 上注入 JavaScript，还是安全模型完全禁止我这样做？

我尝试了 Luca Matteis 的使用建议

```
document.getElementById("placeHolder").innerHTML = jsVar; 
```

而不是 MooTools 代码，我得到了相同的结果。这不是 MooTools 问题。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-01T02:09:39.303

这篇[MSDN 帖子](http://msdn.microsoft.com/en-us/library/ms533897(VS.85).aspx)专门讨论了如何使用 innerHTML 将 javascript 插入页面。你是对的：IE 确实认为这是一个安全问题，所以需要你跳过某些环节才能注入脚本......大概黑客可以像我们一样阅读这个 MSDN 帖子，所以我很茫然为什么 MS 认为这个额外的间接层是“安全的”，但我离题了。

来自 MSDN 文章：

```
<HTML>
<SCRIPT>
function insertScript(){
    var sHTML="<input type=button onclick=" + "go2()" + " value='Click Me'><BR>";
    var sScript="<SCRIPT DEFER>";
    sScript = sScript + "function go2(){ alert('Hello from inserted script.') }";
    sScript = sScript + "</SCRIPT" + ">";
    ScriptDiv.innerHTML = sHTML + sScript;
}    
</SCRIPT>
<BODY onload="insertScript();">
    <DIV ID="ScriptDiv"></DIV>
</BODY>
</HTML> 
```

如果可能的话，您可能希望考虑使用`document.write`注入的脚本加载标签来提高安全性并减少跨浏览器的不兼容性。我知道这可能是不可能的，但值得考虑。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-01T07:39:00.200

大约一年前，我们就是这样在我们的网站上做的，让它在 IE 中运行。以下是步骤：

*   将 HTML 添加到孤立的 DOM 元素
*   在孤立节点中搜索脚本标签 (orphan.getElementsByTagName)
*   从那些脚本节点获取代码（保存以备后用），然后将它们从孤儿中删除
*   添加孤立的 html 剩余部分并将其添加到占位符 (placeholder.innerHTML = orphan.innerHTML)
*   创建一个脚本元素并将存储的代码添加到其中 (scriptElem.text = 'alert("my code");')
*   然后将脚本元素添加到DOM（最好是头部），然后将其删除

```
函数 set_html( id, html ) {
    // 创建孤立元素设置 HTML
    var orphNode = document.createElement('div');
    orphNode.innerHTML = html;

    // 获取脚本节点，将它们添加到一个数组中，并从孤立节点中删除它们
    var scriptNodes = orphNode.getElementsByTagName('script');
    var 脚本 = [];
    而（scriptNodes.length）{
        // 压入脚本数组
        var 节点 = scriptNodes[0];
        scripts.push(node.text);

        // 然后删除它
        node.parentNode.removeChild(node);
    }

    // 添加 html 到占位符元素（注意：我们在执行脚本之前添加 html）
    document.getElementById(id).innerHTML = orphNode.innerHTML;

    // 执行存储的脚本
    var head = document.getElementsByTagName('head')[0];
    而（脚本。长度）{
        // 创建脚本节点
        var scriptNode = document.createElement('script');
        scriptNode.type = '文本/javascript';
        scriptNode.text = scripts.shift(); // 将代码添加到脚本节点
        head.appendChild(scriptNode); // 添加到页面
        head.removeChild(scriptNode); // 然后删除它
    }   
}

set_html('ph', '这是我的 html.alert("alert");');

```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2011-04-25T19:24:14.360

我在 IE8（和 IE7）中遇到了同样的问题 我可以动态注入脚本（使用 src）的唯一方法是使用计时器：

```
source = "bla.js";

setTimeout(function () {
            // run main code
            var s = document.createElement('script');
            s.setAttribute('src', source);
            document.getElementsByTagName('body')[0].appendChild(s);
        }, 50); 
```

如果您有要注入的内联代码，您可以删除计时器并为脚本元素使用“文本”方法：

```
s.text = "alert('hello world');"; 
```

我知道我的答案来得太晚了；然而，迟到总比没有好:-)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-01T05:44:00.287

我从来没有尝试过，它只是浮​​现在我的脑海......你可以试试以下：

```
var script = document.createElement('script');
script.type = 'text/javascript';

script.innerHTML = '//javascript code here'; // not sure if it works
// OR
script.innerText = '//javascript code here'; // not sure if it works
// OR
script.src = 'my_javascript_file.js';

document.getElementById('placeholder').appendChild(script); 
```

您可以使用相同的技术 (DOM) 插入 HTML 标记。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-24T08:34:40.293

对不起，也许我在这里遗漏了一些东西——但这是一个 mootools 1.11 的问题，你为什么不使用 assets.js？

```
// you can  also add a json argument with events, etc.
new Asset.javascript("path-to-script.js", { 
    onload: function() { 
        callFuncFromScript(); 
    }, 
    id: "myscript"
}); 
```

这难道不是我们使用框架*不必*重新发明轮子的原因之一吗……

就“其他”内容而言，您是如何获得的？如果通过 Request 类，它可以通过使用选项很好地做你想做的事：

```
{
    update: $("targetId"),
    evalScripts: true,
    evalResponse: false
} 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-01T01:40:29.810

我不确定 MooTools，但是您尝试过 innerHTML 吗？

> document.getElementById("placeHolder").innerHTML = jsVar;

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-04-01T01:54:17.063

您可能需要评估 script 标签的内容。这将需要解析以在您的 jsVar 和 eval(whatsBetweenTheScriptTags) 中查找脚本。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-04-01T05:03:36.763

由于 IE 默认拒绝插入内容，您必须自己执行它，但您至少可以欺骗 IE 为您进行解析。

只需使用将所有标签`string.replace()`交换为，保留内容。然后将结果粘贴到一个 div 中。`<script>``<textarea class="myScript" style="display:none">``innerHTML`

完成后，您可以使用

```
div.getElementsByTagName("textarea") 
```

要获取所有文本区域，请遍历它们并查找您的标记类（`"myScript"`在本例中），以及您关心的任何一个`eval(textarea.value)`或那些。`(new Function(textarea.value))()`

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-04-02T04:16:36.200

当你说它在其他浏览器中“工作”时，你的意思是你得到了`alert`弹出消息，还是你只是意味着`<script>`标签使它进入 DOM 树？

如果您的目标是前者，请意识到注入嵌入的 html 的行为`<script>`非常依赖于浏览器。例如在最新的 MooTools 我可以尝试：

```
$(element).set('html', '<strong>Foo</strong><script>alert(3)</script>') 
```

而且我*没有*得到弹出窗口，没有在 IE(7) 中，也没有在 FF(3) 中（但是我*确实*成功地将`<script>`节点放入 DOM）。要`alert`在所有浏览器中使用它，您必须按照[此答案](https://stackoverflow.com/questions/703705/how-do-i-inject-javascript-to-a-page-on-ie-8/#704432)进行操作。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2011-10-14T15:21:58.380

我的评论真的很晚，但它也是这里最准确的评论 - 你没有看到`<script>`内容正在运行的原因是因为你没有将`defer`属性添加到`<script>`标签中。MSDN 文章特别指出您需要这样做才能使`<script>`标签运行。

# apache - RewriteMap 激活

> ID：703709
> 
> 赞同：2
> 
> 时间：2009-04-01T01:32:07.553
> 
> 标签：apache, mod-rewrite

如何在 apache 中激活 RewriteMap？当我重新启动 apache 时，我试图在 httpd 配置中运行 rewritemap，它说“这里不允许 RewriteMap”

我试图用谷歌搜索并转到 apache，但找不到激活它的方法。有人知道吗？谢谢。:)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-03T06:28:01.247

[*上下文*信息](http://httpd.apache.org/docs/2.2/mod/directive-dict.html#Context)告诉您可以在哪里使用指令。因为[`RewriteMap`](http://httpd.apache.org/docs/2.2/mod/mod_rewrite.html#rewritemap)它说*server config*或*virtual host*。

# networking - 仅使用以太网帧的 Windows 网络

> ID：703713
> 
> 赞同：5
> 
> 时间：2009-04-01T01:33:11.467
> 
> 标签：networking, winsock, ethernet

我正在做一个项目，我必须为连接到 Windows 机器的设备编写网络库。复杂之处在于我只能使用以太网帧与设备通信。所以根本没有 TCP/UDP/IP。我不认为可以在这里应用绑定/侦听/接受方法，但也许我错了。此外，不涉及路由或交换。

我有几个问题。如何使用套接字与此设备通信？winsock 是否只支持帧？我还没有找到很多关于这方面的资源。有人对我应该如何进行有任何想法吗？

使用套接字甚至是一个好主意，还是我可以发送带有适当标题的信息？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-01T04:06:19.507

使用[WinPCap](http://www.winpcap.org/)，它有一个 API 来发送和收听原始数据。
你可以用它建立你的通信层。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-02T14:29:25.197

看一下WinAoE[代码](http://winaoe.org/)- 它说它允许 Windows 通过以太网设备与 ATA 通信，这意味着它必须在没有网络堆栈的任何上层的情况下进行通信。

**编辑：**

据我所知，如果你想发送原始以太网帧，你需要[NdisSend](http://msdn.microsoft.com/en-us/library/ms804929.aspx)和朋友。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2011-08-29T22:07:36.337

除了 winpcap 和 NDIS，您还可以查看原始套接字，它们是 Windows API 的标准部分，不需要您编写驱动程序代码[http://msdn.microsoft.com/en-us/library/ms740548( v=vs.85).aspx](http://msdn.microsoft.com/en-us/library/ms740548(v=vs.85).aspx)。

# python - 像 Ruby 中的 SciPy 之类的东西？

> ID：703717
> 
> 赞同：14
> 
> 时间：2009-04-01T01:33:31.747
> 
> 标签：python, ruby, math, scipy

进一步研究 Python 和 Ruby 之间的差异，是否有与 SciPy 等效的 Ruby，或者还有哪些其他科学数学 gem 可用于 Ruby？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-04-01T01:39:34.197

没有什么比 SciPy 更成熟或做得更好了，但请查看[SciRuby](http://sciruby.com/)和[Numerical Ruby](http://narray.rubyforge.org/)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-01T01:42:19.307

转数

> Ruby Numerical Library 是一个使用 Blas 和 Lapack 的线性代数包。

[http://rnum.rubyforge.org/](http://rnum.rubyforge.org/)

网站有一些速度比较

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-26T18:46:07.060

其他人提到了 NArray 和 Ara T. Howard 的 /@drawohara 的 SciRuby。

但是还有一个新的[SciRuby 项目](http://sciruby.com)（在 Ara 和 Masahiro Tanaka 的祝福下进行），其中包括一个密集和稀疏的矩阵 gem，[NMatrix](http://github.com/SciRuby/nmatrix)。它还没有完成，但它做了一些基本的事情。

SciRuby [github 帐户](http://github.com/SciRuby)还有许多其他有用的 gem，包括 statsample（用于统计）和 ruby​​vis（用于可视化）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-12-03T05:55:15.647

linalg [https://github.com/wedesoft](https://github.com/wedesoft)，安装说明：[http ://www.quora.com/Installation-Instructions/How-do-I-install-Ruby-linalg-library-on-Mac](http://www.quora.com/Installation-Instructions/How-do-I-install-Ruby-linalg-library-on-Mac)

# updatepanel - 更新面板内的 jqmodal 问题

> ID：703726
> 
> 赞同：1
> 
> 时间：2009-04-01T01:35:50.647
> 
> 标签：updatepanel, jqmodal

我有一个需要显示为页面或模式对话框的控件。在 page_load 事件中，我查看是否设置了 modal 属性，如果是，我注册了一个脚本来调用 jqmodal。这是代码：

```
protected void Page_Load(object sender, EventArgs e)
{
    if (this.Modal)                                         // Show as a modal dialog
    {

        selector.Attributes.Add("class", "jqmWindow");
        selector.Attributes.Add("style", "width:1100px;height:600px;");
        string script = "<script type=\"text/javascript\">$().ready(function() { $(" + "'#" + selector.ClientID + "').jqm({ modal: true }).jqmShow();});</script>";
        //script = "<script type=\"text/javascript\">confirm('hello');</script>";
        ScriptManager.RegisterStartupScript(this,this.GetType(),"duh",script,false);
    }
} 
```

此控件用于具有更新面板的页面。这一切都适用于 Firefox 和 IE，用于初始页面加载和任何刷新。但是，当我回发时，我在 IE 和 FF 中遇到问题：在 IE 中，代表模式的 div（在本例中为选择器）向下和向右移动了大约 500 像素。

在 Firefox 中，div 周围的变暗区域随着每次回发而逐渐变暗。

**如果我从主机页面中删除更新面板（它实际上在母版页中），则此代码有效。**

我曾尝试在回发时不执行上述代码，但这只会禁用 jqmodal。我真的很难过如果有人能提供帮助，我将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-02T20:04:28.503

问题是在 PostBack 上，jQuery div 向下和向右移动。页面加载后的 div 如下所示（正确呈现）：

```
DIV class="jqmWindow jqmID1" id=selector style="DISPLAY: block; Z-INDEX: 3000; WIDTH: 1100px; HEIGHT: 600px" _jqm="1" jQuery1238701349279="3"> 
```

在 Async PostBack 之后，它看起来像这样（渲染不正确）：

```
DIV class="jqmWindow jqmID2" id=selector style="DISPLAY: block; Z-INDEX: 3000; WIDTH: 1100px; TOP: 146px; HEIGHT: 600px" _jqm="2" jQuery1238701490978="5"> 
```

删除更新面板解决了这个问题......我不知道是这个问题。

我创建了一个项目，其中包含一些带有相关代码的页面。这些页面是 site.master、List.aspx/cs 和 PartSelector.ascx/cs

```
// site.master - nothing in codebehind
<%@ Master Language="C#" AutoEventWireup="true" CodeFile="Site.master.cs" Inherits="Site" %>

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
<head runat="server">
    <script src="http://localhost/Scripts/jquery/jquery-1.3.2.min.js" type="text/javascript"></script>
    <script src="http://localhost/Scripts/jqueryUI/ui/ui.core.js" type="text/javascript"></script>
    <title></title>
    <asp:ContentPlaceHolder id="head" runat="server">
    </asp:ContentPlaceHolder>
</head>
<body>
    <form id="form1" runat="server">
    <asp:ScriptManager ID="ScriptManager1" runat="server" > </asp:ScriptManager>
    <div>
        <asp:updatepanel id="upmaincontent" runat="server" updatemode="conditional">
            <contenttemplate>
                <asp:ContentPlaceHolder id="ContentPlaceHolder1" runat="server"></asp:ContentPlaceHolder>
            </ContentTemplate>
        </asp:UpdatePanel>
    </div>
    </form>
</body>
</html>

// list.aspx
<%@ Page Language="C#" MasterPageFile="~/Site.master" CodeFile="List.aspx.cs" Inherits="List" Title="Parts Master List" %>
<%@ Register Assembly="System.Web.Entity, Version=3.5.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" Namespace="System.Web.UI.WebControls" tagprefix="asp" %>
<%@ Register Src="~/Controls/PartSelector.ascx" TagName="PartSelector" TagPrefix="sam"  %>
<asp:Content ID="Content1" ContentPlaceHolderID="ContentPlaceHolder1" Runat="Server">
    <asp:ScriptManagerProxy ID="ScriptManagerProxy1" runat="server" />
    <center>
        <div><center><h3><%= "Part Selector" %></h3></center></div>
        <div>
            <center>
                <sam:PartSelector ID="PartSelector1" runat="server" Modal="true" ActiveOnly="false" />
            </center>
        </div>
    </center>
</asp:Content>

// list.aspx.cs
using System;
using System.Data;
using System.Configuration;
using System.Collections;
using System.Linq;
using System.Web;
using System.Web.Security;
using System.Web.UI;
using System.Web.UI.WebControls;
using System.Web.UI.WebControls.WebParts;
using System.Web.UI.HtmlControls;
using System.Xml.Linq;
using System.Web.DynamicData;
using System.Linq.Expressions;

public partial class List : System.Web.UI.Page
{

    protected void Page_Load(object sender, EventArgs e)
    {

        if (!IsPostBack)
        {
            PartSelector1.ActivateSelector("");
        }
    }
}

// PartSelector.ascx
<%@ Control Language="C#" AutoEventWireup="true" CodeFile="PartSelector.ascx.cs" Inherits="PartSelector" %>

<link href="http://localhost/Scripts/jqModal/jqModal.css" rel="stylesheet" type="text/css" />
<script src="http://localhost/Scripts/jqModal/jqModal.js" type="text/javascript"></script>

<script type="text/javascript" language="javascript">
    var IsModal = false;                            // Initialize a variable to indicate if the page is to be displayed inside a jqModal dialaog
    $().ready(function() { displayPage(); });       // Execute dispalyPage when the dom is ready

    function displayPage() {
        confirm('displaypage');     
        IsModal = <%= this.Modal ? "true" : "false" %>  // Set IsModal based on a property in codebehind

        if(IsModal)
        {
            Sys.WebForms.PageRequestManager.getInstance().add_pageLoaded(displayPageAsync);     // handle async postbacks
            Sys.WebForms.PageRequestManager.getInstance().add_beginRequest(beginRequestHandler); // clean up before starting an async postback
            $("#selector").addClass("jqmWindow");                           // add some css to resize the display to fit the modal dialog
            $("#selector").css({width:"1100px", height: "600px"});
            $("#selector").jqm({ modal: true, onHide: hidejqm }).jqmShow();
        }
    }

    function displayPageAsync(sender, args)
    {
        var prm = Sys.WebForms.PageRequestManager.getInstance();

        if (prm.get_isInAsyncPostBack() ) {             // Prevent displayPage from being called twice on the initial page load
            confirm('page loaded, async postback.');
            displayPage();
        }
    }

    function beginRequestHandler(sender, args) {
        confirm('begin async postback');
        $("#selector").jqmHide();   // Hide a dialog from last postback 
    }

    function hidejqm(hash) {
        confirm('hidejqm');
        hash.w.fadeOut('2000', function() { hash.o.remove(); });
    }
</script>

<div id="selector">
    <center>
    <asp:LinkButton ID="LinkButton1" runat="server" Text="Click here to postback" OnClick="Postback_Click"></asp:LinkButton><br /><br />
    <asp:LinkButton ID="CancelButton" runat="server" Text="Cancel" OnClick="CancelButton_Click" CssClass="CommandButton"></asp:LinkButton>
    </center>
</div>

// PartSelector.ascx.cs
using System;
using System.Collections.Generic;
using System.Linq;
using System.Web;
using System.Web.UI;
using System.Web.UI.WebControls;
using System.Linq.Expressions;

public partial class PartSelector : System.Web.UI.UserControl
{
    public bool Modal { get; set; }

    public void ActivateSelector(string searchString)
    {
        this.Visible = true;
    }

    protected void CancelButton_Click(object sender, EventArgs e)
    {
        this.Visible = false;
    }

    protected void Postback_Click(object sender, EventArgs e)
    {
        int x = 1;
    }

} 
```

# freepascal - 使用 Free Pascal 从 Mac OS X 编译 Linux 程序

> ID：703727
> 
> 赞同：0
> 
> 时间：2009-04-01T01:37:03.983
> 
> 标签：freepascal

我想在 Free Pascal 中构建一个命令行工具，以便在[SUSE](http://en.wikipedia.org/wiki/SUSE_Linux_distributions) 9 中运行。

这是一个生产服务器，除了这个工具之外很难安装任何东西。

我在[Mac OS X Leopard](http://en.wikipedia.org/wiki/Mac_OS_X_Leopard)上编码，想知道是否可以从这里交叉编译到 Linux？

服务器在[Xeon](http://en.wikipedia.org/wiki/Xeon)上运行。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-01T02:04:03.840

成功！如果你安装[Fink](http://www.finkproject.org/)然后说

```
sudo fink install fpc-i386-linux 
```

它将安装 Free Pascal 以及交叉编译所需的一切。然后你就可以说

```
/sw/bin/fpc -Tlinux hw.pas 
```

并获得一个 Linux 可执行文件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-01T01:48:46.373

除非有我找不到的交叉编译选项，否则您可能不走运直接从 Mac OS X 执行此操作。但是，您可以通过安装[Parallels](http://www.parallels.com/)或 Sun 的[VirtualBox](http://www.virtualbox.org/)之类的虚拟机，在它，并在那里编译。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-11-12T09:10:29.173

现在`.dmg`有 Free Pascal 文件（二进制、源代码和[Lazarus](http://en.wikipedia.org/wiki/Lazarus_%28IDE%29)）可供安装，因此应该很容易安装、打开和编译它。但是请注意，如果它链接到特定于 Linux 的`.so`文件，它们可能需要安装在 Mac OS X 上，否则您将不得不更改代码以不使用它们。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-02T20:11:33.263

FPC 通常可以很好地交叉编译。但是有一些限制：

1.  从非 x86/x86_64 架构交叉编译到 x86/x86_64 将不起作用。它需要扩展，这在其他拱门上没有被模拟。但是，您似乎使用的是英特尔 OS X 机器（不是 PPC），所以这不适用。
2.  根据使用的库和目标平台的性质，您可能需要在主机上安装目标库。（通常：不适用于 Windows，但您必须将 *nix/OS X 作为目标）

另请参阅[http://www.stack.nl/~marcov/buildfaq.pdf](http://www.stack.nl/~marcov/buildfaq.pdf) 它包含有关使用 FPC 进行交叉编译的一些背景。

# objective-c - 如何使用 NSOutputStream 的写消息？

> ID：703729
> 
> 赞同：6
> 
> 时间：2009-04-01T01:38:57.443
> 
> 标签：objective-c, cocoa, sockets, stream

我想通过套接字将 UIImage 发送到服务器。

a）我打开输出流：

```
 - (IBAction)send:(id)sender {
    NSURL *website = [NSURL URLWithString:str_IP];
    NSHost *host = [NSHost hostWithName:[website host]];
    [NSStream getStreamsToHost:host port:1100 inputStream:nil outputStream:&oStream];
    [oStream retain];
    [oStream setDelegate:self];
    [oStream scheduleInRunLoop:[NSRunLoop currentRunLoop] forMode:NSDefaultRunLoopMode];
    [oStream open];
} 
```

b）我在打开完成后将 NSData 写入输出流，如果发生错误则处理错误。

```
 - (void) stream: (NSStream *) stream handleEvent: (NSStreamEvent) eventCode
{
    //printf("EVENT: Start.\n");

    switch(eventCode)
    {
            case NSStreamEventOpenCompleted:
            {
                //printf("EVENT: Open completed.\n");

                if(stream == oStream)
                    {
                        //printf("Sending...\n");
                        NSData *data = UIImageJPEGRepresentation(drawImage.image, 90);
                        NSInteger x = [oStream write:[data bytes] maxLength:[data length]];
                    }

                break;
            }
            case NSStreamEventEndEncountered:
            {
                //printf("EVENT: End encountered.\n");
                break;
            }
            case NSStreamEventHasSpaceAvailable:
            {
                //printf("EVENT: Has space available.\n");
                break;
            }
            case NSStreamEventHasBytesAvailable:
            {
                //printf("EVENT: Has bytes available.\n");
                break;
            }
            case NSStreamEventErrorOccurred:
            {
                UIAlertView *alert = [[UIAlertView alloc] initWithTitle:@"Error Occurred"       
                                                                message:nil 
                                                               delegate:nil             
                                                      cancelButtonTitle:@"OK"               
                                                      otherButtonTitles:nil];                   
                [alert show];
                [alert release];
                break;
            }
            case NSStreamEventNone:
            {
                //printf("EVENT: None.\n");
                break;
            }
    }

    //printf("EVENT: End.\n");
} 
```

当我运行这段代码时，调用了 NSStreamEventOpenCompleted 和 NSStreamEventErrorOccurred。成功调用了 NSOutputStream 的 write 方法，所有数据都不为零。但是数据写入oStream后，eventCode会变成NSStreamEventErrorOccurred。

所以我认为这可能不是使用[oStream write]的正确方法。那么使用此消息的正确方法是什么？我发现此消息返回 -1073748088 的 NSInteger，可能是什么问题？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-04-01T02:06:55.893

只有在输出流中有可用空间后，您才应该写入数据。当流完成打开时，它并不总是立即有可用空间，因此写入它不会起作用。如果您将`write`调用移至`NSStreamEventHasSpaceAvailable`处理程序，它应该会成功。

此外，套接字另一端的计算机无法知道您发送的数据的长度。除非您通过关闭套接字来发出数据结束的信号，否则您应该显式发送数据长度以及数据：

```
case NSStreamEventHasSpaceAvailable:
{
    if(stream == oStream)
    {
        NSData *data = UIImageJPEGRepresentation(drawImage.image, 90);
        // Convert from host to network endianness
        uint32_t length = (uint32_t)htonl([data length]);
        // Don't forget to check the return value of 'write'
        [oStream write:(uint8_t *)&length maxLength:4];
        [oStream write:[data bytes] maxLength:length];
    }
    break;
} 
```

# performance - 这种反模式的名称是什么？

> ID：703730
> 
> 赞同：5
> 
> 时间：2009-04-01T01:39:23.230
> 
> 标签：performance, terminology, anti-patterns

你们中的一些人肯定已经处理过这个问题。当程序员对 OO 过于执着而忘记了性能和拥有数据库时，往往会发生这种情况。

例如，假设我们有一个电子邮件表，它们需要由该程序发送。在启动时，它会查找需要发送的任何内容，如下所示：

```
Emails = find_every_damn_email_in_the_database();
FOR Email in Emails
  IF !Email.IsSent() THEN Email.Send() 
```

从不要重复自己的角度来看，这是一件好事，但有时这是不可避免的，应该是：

```
Emails = find_unsent_emails();
FOR Email in Emails
  Email.Send() 
```

这个有名字吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-04-01T01:44:44.307

我将试一试，并命名为“惰性过滤器（反）模式”。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-01T01:51:59.407

我见过一次。那个程序员的时间不长。

我们称之为**“消防水带法”。**

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-01T01:53:57.593

对我来说，这是 Joel Spolsky 的[泄漏抽象](http://en.wikipedia.org/wiki/Leaky_abstraction)。

这并不完全是一种反模式，但无论是谁编写了这段代码，都没有真正理解 Active Record 模式抽象在哪里泄漏。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-01T03:32:51.787

我称之为“霰弹枪方法”。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-01T01:46:16.380

我不确定这一定与数据库相关，因为您可能有一个复杂且昂贵的过程（例如，不仅仅是一个标志）来为组应用过滤器。

我不认为它有名字，因为第一个设计根本不好，它违反了一个责任原则。如果您搜索、过滤和打印过滤后的内容，您正在做多件事，因此您需要将其重构为“搜索过滤后”并打印。

与这里的简单重构唯一不同的是，它也会影响性能，就像内部循环可以以损害性能的方式设计一样。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-01T03:27:56.587

似乎源自以下反模式：

*   [站在侏儒的肩膀上](http://c2.com/cgi/wiki?StandingOnTheShouldersOfMidgets)
*   [如果它正在工作不要改变](http://c2.com/cgi/wiki?IfItIsWorkingDontChange)

最初的开发人员可能不被允许编写 find_unsent_emails() 实现，因此会重用 midget 函数。那么，为什么要在开发和测试之后改变它呢？

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-04-01T04:20:22.890

这通常是因为使用现有查询然后在代码中过滤比添加新的 SQL 查询要容易得多。可能是因为 DBA 控制所有查询并获得批准的新查询需要几天时间，或者可能是因为您使用的 ORM 工具使得定义您自己的自定义查询变得非常困难。

如果我要命名它，我会称它为“Easy Way Out”（反）模式。它是否是反模式实际上取决于个人情况。如果您需要检索的项目数量很少，那么在代码中进行过滤确实不是什么大问题。但是如果项目的数量很大并且有可能持续增长，那么显然应该在服务器上进行过滤。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-04-01T16:05:26.083

我在其他地方看到过类似的问题，而不是简单的一系列事情要做，而是有一个基于“列表集群”的“事务集群”，它基于一个基于“内存集群”的“集合集群”。不用说，最简单的事情变成了一个伟大的大交易。

我称之为**疾驰的普遍性**。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-04-01T01:44:32.733

愚蠢的业余爱好者。

说真的，我只在拥有计算机科学学位且完全没有专业经验的人身上看到过这种情况。当我在杜克大学任教时，我的导师和我开设了一个“大规模编程”课程，我们让人们准确地看到这些类型的错误。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-04-01T01:51:30.437

第一个的性能实际上可以很好，具体取决于`Emails`. 如果它只是一个迭代器（想想`std::vector::begin()`in `C++`），那么它比首先将所有未发送的电子邮件存储在某个容器中更好而且更好。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-04-01T01:53:42.633

这个反模式有几个可能的名字。

*   “不知道的 SQL”反模式
*   “法西斯-DBA”反模式
*   “‘延迟’是什么意思？” 反模式

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-04-01T05:58:04.450

[The Daily WTF](http://thedailywtf.com/Articles/Consultants-of-the-Crystal-Citadel.aspx)有一个很好的例子。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-12-11T03:47:37.790

部分受到 1800 年“惰性过滤器（反）模式”的启发，“功能失调编程”（即与函数式编程相反）怎么样？

# java - 可以通过 Java 连接到 Outlook WebMail 吗？

> ID：703734
> 
> 赞同：2
> 
> 时间：2009-04-01T01:41:36.703
> 
> 标签：java, outlook, webmail

我想创建一个 java 程序来连接到 Outlook 网络邮件服务器以检查未读电子邮件。我不是在寻找基于开源 Java 的电子邮件客户端等。等等。

我基本上是在问是否可以为 Outlook Webmail 服务器创建一个 Java 接口。我一直在努力寻找我什至会如何开始这样做，但这并不是本质上很清楚。谢谢..

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-06T11:53:20.433

您可以在 Exchange 2007 之前使用 WebDav 界面或在 Exchange 2007+ 中使用 EWS（Exchange Web 服务）

EWS 参考 - [http://msdn.microsoft.com/en-us/library/bb204119.aspx](http://msdn.microsoft.com/en-us/library/bb204119.aspx)

还有一个博客，你可以从 webdav [http://blogs.msdn.com/dotnetinterop/archive/2008/07/21/connecting-java-to-exchange-over-webdav-with-apache-httpclient.aspx开始](http://blogs.msdn.com/dotnetinterop/archive/2008/07/21/connecting-java-to-exchange-over-webdav-with-apache-httpclient.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-11-23T17:17:59.577

Apache 正在为其开发一个 API Apache POI，您可以使用它轻松连接到 Outlook....

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-06T11:56:57.023

您也可以尝试查看免费交换客户端。也许您会在那里找到有关该协议的信息。

# gwt - GWT 与 JPA

> ID：703737
> 
> 赞同：10
> 
> 时间：2009-04-01T01:44:13.577
> 
> 标签：gwt, jpa, rpc, toplink

我正在尝试使用 GWT 1.5.3 构建数据库应用程序。我对我的对象使用 JPA 注释。似乎在托管模式下 GWT 的 RPC 工作正常。但是当我尝试使用 GWT-compiler 编译我的应用程序时，我收到如下错误：“无法解析导入 javax.persistence”、“无法将实体解析为类型”。我的项目路径中已经包含了 toplink-essentials.jar。我还需要什么设置来解决这个问题？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-04-07T19:39:20.333

您可以使用 Gilead ( [http://sourceforge.net/projects/gilead/](http://sourceforge.net/projects/gilead/) ) 库通过 GWT 无缝管理 JPA 实体。

问候

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-04-01T04:13:47.960

您需要在 GWT 项目的构建路径中包含 JPA 注释的源代码。有关更多详细信息，请参见此处：

[http://code.google.com/p/google-web-toolkit/issues/detail?id=1830&can=1&q=jpa](http://code.google.com/p/google-web-toolkit/issues/detail?id=1830&can=1&q=jpa)

特别是这个 jar 文件，它将解决您的问题：

[http://google-web-toolkit.googlecode.com/issues/attachment?aid=1475633892125294312&name=jpa-annotations-source.jar](http://google-web-toolkit.googlecode.com/issues/attachment?aid=1475633892125294312&name=jpa-annotations-source.jar)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-10-23T16:14:54.397

JPA 和 GWT 的一般问题是 GWT 本身不支持花哨的 JPA 类，因此您只需执行实现 java.io.Serializable 并具有简单 JPA 资源注释的简单 POJO 持久实体 DTO。您需要在 GWT 客户端范围内创建实体类，要么将其放在 yourproject.client 包下，要么将它们添加到

源路径="客户端"

源路径="folderOfYourEntities"

在 GWT 项目的 YouProject.gwt.xml 文件中。这将包括 GWT 客户端中的实体对象，因此它们也可以在 RPC 的客户端使用它们。DAO 必须在服务器端，并且可以包含容器支持的任何内容。

您现在遇到的问题是，在编译时，GWT 编译器说它不知道实体 DTO 类中 JPA 注释的那些导入是什么。这就是您需要 javax.persistence 类和源代码的原因。Rustmyself 的 jpa-annotation-source.jar 参考有效。它只是 javax.persistence 编译的类文件和源代码文件加上一个 Persistence.gwt.xml。它是 javax.persistence 包的简单 GWT 模块。如果您知道如何制作自己的 GWT 模块，那么您应该很难完成所有这些工作。顺便说一句，可以在 glassfish 开发站点的构建部分 wiki.glassfish.java.net 上找到 Java EE 的官方源代码

还有许多其他解决方案可以使用代理自动将您的精美 PU 实体包装到简单对象或在运行时延迟加载它们。它们有效，但不是最佳解决方案。最佳实践是从一开始就通过在 GWT 客户端上下文中拥有 POJO JPA DTO 实体和在服务器上拥有完整的 DAO 来使事情变得简单和健壮。

**GWTPersistence 示例**
我添加了一个关于如何使 GWT 和 JPA 无缝工作的实际工作示例。它是一个带有源代码和部署文件的 NetBean 项目。参见[NingZhang.info 上的 GWTPersistence](http://www.ningzhang.info/gwtpersistence)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-01T07:08:48.463

好的，我找到了我所缺少的。我需要在 myapp-compile.cmd 脚本（或 ant 构建文件）的 GWT 编译器路径中包含 jpa-annotations-source.jar。顺便说一句，谁能告诉我这个 jpa-annotations-source.jar 文件的来源？

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-05T22:38:48.187

我也在使用 JPA <--> GWT 数据转换等。

为了消除 DTO 层，我也使用了 Gilead。

我的反对意见是关于翻译 javax.persistence。为了避免这种情况，我使用了 XML JPA 映射声明（orm.xml）

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2010-12-27T01:32:09.823

简单地说，保留另一个版本的实体，但没有注释！

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2013-02-06T15:50:36.157

根据 synergetic 的评论反弹，您现在（从 GWT 1.5 开始）只需要添加

```
<source path='javax.persistence'/> 
```

到您的 Module.gwt.xml

# wpf - WPF - 有没有办法以编程方式评估绑定？

> ID：703741
> 
> 赞同：5
> 
> 时间：2009-04-01T01:44:40.003
> 
> 标签：wpf, binding

有谁知道如何获取与绑定关联的当前值？我最近遇到了一个问题，我想在 WPFToolKit DataGrid 中获取与特定单元格关联的值 - 所以我创建了一个函数来获取路径字符串，在“。”上拆分。并尝试在循环中使用 PropertyDescriptor，尝试获取绑定值。当然有更好的方法:)。如果有人能指出我正确的方向，我会永远爱你。

谢谢，

查尔斯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-12-03T13:33:55.007

由于给定的答案链接现在仅在 webarchive 上可用，我复制了那里给出的答案：

```
public static class DataBinder
{
    private static readonly DependencyProperty DummyProperty = DependencyProperty.RegisterAttached(
        "Dummy",
        typeof(Object),
        typeof(DependencyObject),
        new UIPropertyMetadata(null));

    public static object Eval(object container, string expression)
    {
        var binding = new Binding(expression) { Source = container };
        return binding.Eval();
    }

    public static object Eval(this Binding binding, DependencyObject dependencyObject = null)
    {
        dependencyObject = dependencyObject ?? new DependencyObject();
        BindingOperations.SetBinding(dependencyObject, DummyProperty, binding);
        return dependencyObject.GetValue(DummyProperty);
    }
} 
```

例子：

```
public partial class PropertyPathParserDemo : Window
{
     public PropertyPathParserDemo()
     {
         InitializeComponent();
         Foo foo = new Foo() { Bar = new Bar() { Value = "Value" } };
         this.Content = DataBinder.Eval(foo, "Bar.Value");
     }

     public class Foo
     {
         public Bar Bar
         {
             get;
             set;
         }
     }

     public class Bar
     {
         public string Value
         {
             get;
             set;
         }
     }
 } 
```

# cocoa - 为什么在 App 启动前无法显示启动画面？

> ID：703744
> 
> 赞同：0
> 
> 时间：2009-04-01T01:45:21.640
> 
> 标签：cocoa

我想在 App 午餐前显示一个启动画面。首先，我将 SplashWindow 作为 NSWindow 的子类，代码是：

```
- (id)initWithContentRect(NSRect)contentRect 
styleMask(unsigned int)aStyle 
backing(NSBackingStoreType)bufferingType 
defer(BOOL)flag {

self = [super initWithContentRect:contentRect
styleMask:NSBorderlessWindowMask backing:NSBackingStoreBuffered defer:NO]; 
[self setBackgroundColor: 
[NSColor clearColor]]; 
[self setLevel: NSStatusWindowLevel]; 
[self setAlphaValue:1.0]; 
[self setOpaque:NO]; 
[self setHasShadow: YES]; 
return self;

} 
```

然后在主应用程序控制器中从 nib 唤醒：

```
loadWindow = [[NSWindow alloc] initWithContentRect:[loadWindow frame] styleMask:NSBorderlessWindowMask backing:NSBackingStoreBuffered defer:YES]; 
[loadWindow setContentView:theView]; 
[loadWindow setHasShadow:YES]; [
loadWindow setLevel:NSStatusWindowLevel]; 
[loadWindow makeKeyAndOrderFront:self]; 
```

然后我让loadWindow在3秒后关闭，我使用了方法[loadWindow orderOut：self]，但是当启动窗口关闭时，主窗口没有显示。我错过了什么？我的应用程序是一个 multi_Documents 。在 mainMenu.nib 中有一个窗口（loadwindow），在 IB 中我已经连接了主控制器中的 loadWindow 插座。我还连接了视图和图像。我改变了另一种方式：在委托方法中：applicationWillFinishLaunching：我订购了loadWindow，在方法中：applicationDidFinishLaunching：我在3秒后订购了loadWindow，但mainWindow也没有显示。有人可以给出一些建议或编码结果问题？非常感谢你！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-01T05:23:13.470

标题答案：因为您的应用程序尚未运行。未运行的应用程序无法执行任何操作。

认真回答问题：

首先，你不需要继承 NSWindow。

其次，您不是在实例化您的子类，而是在实例化 NSWindow。这就是为什么你没有得到你的子类的行为。（这是你应该做的，因为你不需要子类。）

第三，您试图为您将用来创建它的框架询问一个尚不存在的窗口。直到您创建某些东西并将`loadWindow`其存储*在*那里。`nil`

 *第四，因为你要求`nil`它的框架，所以你得到了一个垃圾矩形。然后你用这个垃圾矩形创建一个窗口。不出所料，当您将此窗口放在屏幕上时，它会以随机大小（可能太大而无法创建或负数）出现在随机位置（可能在屏幕外）。

第五，是什么让你认为告诉一个窗口订购会导致其他窗口订购？它应该如何知道要在哪个窗口订购？

撇开不可否认的现实，即[启动屏幕的存在会惩罚用户使用您的应用程序](https://stackoverflow.com/questions/685062/how-to-show-a-splash-ui-before-app-run/685340#685340)，您应该使用 NSWindowController 来加载窗口并进行设置，例如`setBackgroundColor:`和`setLevel:`。在您的计时器方法中，您在启动启动窗口中排序，您还必须在主窗口中*显式排序。*

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-01T02:16:09.397

我没有看到任何会使您发布的代码中显示另一个窗口的内容。你为什么不尝试发送你的主窗口makeKeyAndOrderFront：？

# wordpress - WordPress 企业名录 - 最佳方法

> ID：703745
> 
> 赞同：0
> 
> 时间：2009-04-01T01:45:39.407
> 
> 标签：wordpress

我想在 WordPress 中实现一个业务目录，我正在寻找有关最佳方法的反馈：

1.  我有一个类别和一个企业表
2.  我是否为每个业务及其类别关系创建一个页面
3.  我是否要创建一个页面并为其分配一个模板？
4.  每种方法的优缺点是什么？

从可能已经这样做并且可以根据经验说话的人那里寻找一些答案

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2010-12-23T03:47:54.813

我一直在寻找类似的东西，昨天发现了这个...... [http://www.directorypress.net/](http://www.directorypress.net/) 它并不便宜，但看起来它可能会起作用。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-06T20:55:31.640

WordPress 的好处是您可以尝试几种不同的方法来实现这一点。

对我来说效果很好的一种方法是将每个企业列为帖子，然后创建类别和子类别来容纳这些企业。完成此操作后，您可以为任一类别模板创建自定义模板（因此，如果您有一个名为“食品机构”的类别并且其类别 ID 为 5，您可以创建一个名为 category-5.php 的模板，然后 WordPress 将知道首先查看该模板，然后转到常规 category.php 文件等等）。

然后，在您的类别模板中，您可以列出每个带有类似功能`wp_list_categories();`的子类别，并从那里调出子类别。

另一种选择是仍然按照单独的帖子进入您的企业的路线，将它们归档在适当的类别下。但是，您可以创建页面模板，而不是创建类别模板。你需要为此做一些事情

1.  使用必要的模板语法预先准备您的模板文件，以告诉 WordPress 将其作为模板文件查找，例如：

    ```
    <?php 
        /* Template Name: Food Establishments */ 
    ?> 
    ```

2.  使用这个新模板在 WordPress 中创建一个页面

3.  在您的页面模板中创建一个新查询，指向此类别，例如：

    ```
    <?php $business_food = new WP_Query( 'cat=5' ); ?><br />
    <?php if ( $business_food->have_posts() ) : while ( $business_food->have_posts()) : $business_food->the_post();  ?><br />
        <?php the_content(); // and do other stuff here ?><br />
    <?php endwhile; endif; ?><br /> 
    ```

您还可以选择其他选项，对于这些选项，我会挂出一些 WordPress 用户组，看看您是否可以获取其他想法。

# version-control - 任何允许自定义 $Keywords$ 的源代码控制系统？

> ID：703746
> 
> 赞同：1
> 
> 时间：2009-04-01T01:45:41.747
> 
> 标签：version-control, templates

我想知道是否有任何源代码控制系统允许管理员定义自定义关键字，这些关键字在签入时被替换为不同的行为（即类似于 $Id$ 或 $Author$ 等）

我只熟悉具有一组关键字列表的 SVN 和 CVS，但会有 $LineNo$ 或 $MyLicenceText$ 之类的应用程序。我敢肯定还会有其他用例。这个想法是创建一个插件架构，可以定义或修改关键字的行为。

所以我的问题是 - 是否有一个工具（商业或开源）已经有类似的东西？

编辑：将其作为构建的一部分进行是解决问题的有效方法，但是如果开发人员在签入之前没有进行构建，则会导致问题。想象一下像 $LineNo$ 这样的东西，如果构建与源不完全同步，那么值很容易不正确。对于具有更多静态行为的关键字（如 $MyLicenceText$），在构建时替换是一个有效的解决方案。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-01T01:49:31.597

您可以查看可以在[Git](http://git-scm.com/)中使用文件`filter`设置的属性。这使您可以定义两个转换，称为*smudge*和*clean*，它们使您可以在签出文件时以任意方式转换文件，并在签入时再次将其转换回来。[`.gitattributes`](http://git-scm.com/docs/gitattributes)

 *** * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-01T02:10:54.557

就像上面 Brian 对 Git 所说的那样，Subversion 也可以让你做 pre/post 提交钩子，可以替换这种形式的 $Keywords。我认为 SVN 世界的问题是你真的**不应该**修改文件。

这是 SVN 书警告的内容：

> 虽然钩子脚本几乎可以做任何事情，但钩子脚本作者应该在一个方面表现出克制：不要使用钩子脚本修改提交事务。虽然使用钩子脚本来自动纠正正在提交的文件中存在的错误或缺陷或违反策略可能很诱人，但这样做可能会导致问题。Subversion 保留存储库数据的某些位的客户端缓存，如果您以这种方式更改提交事务，这些缓存将变得难以察觉的陈旧。这种不一致会导致令人惊讶和意外的行为。而不是修改事务，您应该简单地在预提交挂钩中验证事务，如果它不满足所需的要求，则拒绝提交。作为奖励，您的用户将了解谨慎、合规的工作习惯的价值。

在使用 Ant 或 Maven 的构建过程中，您是否有任何理由不能这样做？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-02T13:52:38.203

为什么不用触发器？不行吗？

诸如预结账（或预更新，取决于行话）和预签入之类的东西？

# iphone - 如何使用返回键关闭 UITextView 的键盘？

> ID：703754
> 
> 赞同：395
> 
> 时间：2009-04-01T01:48:53.503
> 
> 标签：iphone, objective-c, keyboard, uitextview, iphone-softkeyboard

在IB的库中，介绍告诉我们，当`return`按键被按下时，键盘for`UITextView`会消失。但实际上`return`密钥只能充当'\n'。

我可以添加一个按钮并用于`[txtView resignFirstResponder]`隐藏键盘。

但是有没有办法为`return`键盘中的键添加操作，这样我就不需要添加了`UIButton`？

* * *

## 回答 #1

> 赞同：519
> 
> 时间：2010-05-21T03:42:16.080

想我会在这里发布代码段：

确保您声明支持该`UITextViewDelegate`协议。

```
- (BOOL)textView:(UITextView *)textView shouldChangeTextInRange:(NSRange)range replacementText:(NSString *)text {

    if([text isEqualToString:@"\n"]) {
        [textView resignFirstResponder];
        return NO;
    }

    return YES;
} 
```

斯威夫特 4.0 更新：

```
func textView(_ textView: UITextView, shouldChangeTextIn range: NSRange, replacementText text: String) -> Bool {
    if text == "\n" {
        textView.resignFirstResponder()
        return false
    }
    return true
} 
```

* * *

## 回答 #2

> 赞同：364
> 
> 时间：2009-04-01T05:41:17.827

`UITextView`当用户点击返回键时，没有任何方法将被调用。如果您希望用户只能添加一行文本，请使用`UITextField`. 按回车键并隐藏键盘 a`UITextView`不符合界面指南。

即使那样，如果您想这样做，请实现 and 的`textView:shouldChangeTextInRange:replacementText:`方法`UITextViewDelegate`，检查替换文本是否为`\n`，隐藏键盘。

可能还有其他方法，但我不知道。

* * *

## 回答 #3

> 赞同：83
> 
> 时间：2011-06-30T16:30:37.520

我知道这已经得到了回答，但我真的不喜欢将字符串文字用于换行符，所以这就是我所做的。

```
- (BOOL)textView:(UITextView *)txtView shouldChangeTextInRange:(NSRange)range replacementText:(NSString *)text {
    if( [text rangeOfCharacterFromSet:[NSCharacterSet newlineCharacterSet]].location == NSNotFound ) {
        return YES;
    }

    [txtView resignFirstResponder];
    return NO;
} 
```

斯威夫特 4.0 更新：

```
func textView(_ textView: UITextView, shouldChangeTextIn range: NSRange, replacementText text: String) -> Bool {
if (text as NSString).rangeOfCharacter(from: CharacterSet.newlines).location == NSNotFound {
    return true
}
txtView.resignFirstResponder()
return false
} 
```

* * *

## 回答 #4

> 赞同：44
> 
> 时间：2014-05-21T09:29:56.037

我知道这已经被回答了很多次，但这是我对这个问题的两分钱。

我发现[samvermette](https://stackoverflow.com/a/2879433/2239948)和[ribeto](https://stackoverflow.com/a/6538023/2239948)的答案非常有用，而且maxpower在[ribeto的答案中的评论也是](https://stackoverflow.com/questions/703754/how-to-dismiss-keyboard-for-uitextview-with-return-key#comment23547888_6538023)[如此](https://stackoverflow.com/a/6538023/2239948)。但是这些方法存在问题。[马特](https://stackoverflow.com/questions/703754/how-to-dismiss-keyboard-for-uitextview-with-return-key/23779209#comment4951904_2879433)在[samvermette](https://stackoverflow.com/a/2879433/2239948)的回答中提到的问题是，如果用户想要粘贴带有换行符的内容，键盘将隐藏而不粘贴任何内容。

所以我的方法是上述三种解决方案的混合，并且仅在字符串长度为 1 时检查输入的字符串是否为新行，因此我们确保用户正在输入而不是粘贴。

这是我所做的：

```
- (BOOL)textView:(UITextView *)textView shouldChangeTextInRange:(NSRange)range replacementText:(NSString *)text {
    NSRange resultRange = [text rangeOfCharacterFromSet:[NSCharacterSet newlineCharacterSet] options:NSBackwardsSearch];
    if ([text length] == 1 && resultRange.location != NSNotFound) {
        [textView resignFirstResponder];
        return NO;
    }

    return YES;
} 
```

* * *

## 回答 #5

> 赞同：37
> 
> 时间：2012-10-07T05:36:24.397

一种更优雅的方法是当用户点击键盘框架之外的某个位置时关闭键盘。

首先，在 UIBuilder 的身份检查器中将 ViewController 的视图设置为“UIControl”类。按住 Control 将视图拖到 ViewController 的头文件中，并将其作为动作与 Touch Up Inside 事件链接，例如：

视图控制器.h

```
-(IBAction)dismissKeyboardOnTap:(id)sender; 
```

在主 ViewController 文件中，ViewController.m：

```
-(IBAction)dismissKeyboardOnTap:(id)sender
    {
         [[self view] endEditing:YES];
    } 
```

您可以使用类似的技术要求双击或长按。您可能需要将 ViewController 设置为 UITextViewDelegate 并将 TextView 连接到 ViewController。此方法适用于 UITextView 和 UITextField。

资料来源：大书呆子牧场

编辑：我还想补充一点，如果您使用的是 UIScrollView，上述技术可能无法通过 Interface Builder 轻松工作。在这种情况下，您可以使用 UIGestureRecognizer 并在其中调用 [[self view] endEditing:YES] 方法。一个例子是：

```
-(void)ViewDidLoad{
    ....
    UITapGestureRecognizer *tapRec = [[UITapGestureRecognizer alloc] 
        initWithTarget:self action:@selector(tap:)];
    [self.view addGestureRecognizer: tapRec];
    ....
}

-(void)tap:(UITapGestureRecognizer *)tapRec{
    [[self view] endEditing: YES];
} 
```

当用户在键盘外点击而不点击输入空间时，键盘将关闭。

* * *

## 回答 #6

> 赞同：35
> 
> 时间：2015-02-24T05:36:14.960

在您的视图控制器中添加此方法。

**斯威夫特**：

```
func textView(textView: UITextView, shouldChangeTextInRange range: NSRange, replacementText text: String) -> Bool {
    if text == "\n" {
        textView.resignFirstResponder()
        return false
    }
    return true
} 
```

此方法对您也有帮助：

```
/**
Dismiss keyboard when tapped outside the keyboard or textView

:param: touches the touches
:param: event   the related event
*/
override func touchesBegan(touches: NSSet, withEvent event: UIEvent) {
    if let touch = touches.anyObject() as? UITouch {
        if touch.phase == UITouchPhase.Began {
            textField?.resignFirstResponder()
        }
    }
} 
```

* * *

## 回答 #7

> 赞同：26
> 
> 时间：2012-06-05T04:25:19.883

```
-(BOOL)textView:(UITextView *)textView shouldChangeTextInRange:(NSRange)range replacementText:(NSString *)text {
    if([text isEqualToString:@"\n"])
        [textView resignFirstResponder];
    return YES;
}

yourtextView.delegate=self; 
```

还添加 `UITextViewDelegate`

**不要忘记确认协议**

如果您没有添加`if([text isEqualToString:@"\n"])`，则无法编辑

* * *

## 回答 #8

> 赞同：18
> 
> 时间：2014-09-23T09:02:18.943

与 uitextview 一起使用时还有另一种解决方案，您可以在“textViewShouldBeginEditing”中将工具栏添加为 InputAccessoryView，并从此工具栏的完成按钮关闭键盘，代码如下：

> 在 viewDidLoad

```
toolBar = [[UIToolbar alloc]initWithFrame:CGRectMake(0, 0, 320, 44)]; //toolbar is uitoolbar object
toolBar.barStyle = UIBarStyleBlackOpaque;
UIBarButtonItem *btnDone = [[UIBarButtonItem alloc] initWithBarButtonSystemItem:UIBarButtonSystemItemDone target:self action:@selector(btnClickedDone:)];
[toolBar setItems:[NSArray arrayWithObject:btnDone]]; 
```

> 在 textviewdelegate 方法中

```
- (BOOL)textViewShouldBeginEditing:(UITextView *)textView
{
     [textView setInputAccessoryView:toolBar];
     return YES;
} 
```

> 在工具栏中的按钮完成的操作中如下：

```
-(IBAction)btnClickedDone:(id)sender
{
    [self.view endEditing:YES];
} 
```

* * *

## 回答 #9

> 赞同：18
> 
> 时间：2017-08-11T10:17:07.173

我发现[josebama](https://stackoverflow.com/a/23779209/5188399 "约瑟巴马")的答案是该线程中最完整和最干净的答案。

下面是它的**Swift 4**语法：

```
func textView(_ textView: UITextView, shouldChangeTextIn _: NSRange, replacementText text: String) -> Bool {
    let resultRange = text.rangeOfCharacter(from: CharacterSet.newlines, options: .backwards)
    if text.count == 1 && resultRange != nil {
        textView.resignFirstResponder()
        // Do any additional stuff here
        return false
    }
    return true
} 
```

* * *

## 回答 #10

> 赞同：14
> 
> 时间：2020-04-30T16:55:37.833

`UITextViewDelegate`与使用但更新的 swift 界面的其他答案类似`isNewline`：

```
func textView(_ textView: UITextView, shouldChangeTextIn range: NSRange, replacementText text: String) -> Bool {
    if let character = text.first, character.isNewline {
        textView.resignFirstResponder()
        return false
    }
    return true
} 
```

* * *

## 回答 #11

> 赞同：6
> 
> 时间：2011-11-15T00:11:12.510

使用导航控制器托管一个栏以关闭键盘：

在 .h 文件中：

```
UIBarButtonItem* dismissKeyboardButton; 
```

在 .m 文件中：

```
- (void)viewDidLoad {
    dismissKeyboardButton = [[UIBarButtonItem alloc] initWithBarButtonSystemItem:UIBarButtonSystemItemDone target:self action:@selector(dismissKeyboard)];
}

-(void)textViewDidBeginEditing:(UITextView *)textView {
    self.navigationItem.rightBarButtonItem = dismissKeyboardButton;
}

-(void)textFieldDidBeginEditing:(UITextField *)textField {
    self.navigationItem.rightBarButtonItem = dismissKeyboardButton;
}

-(void)dismissKeyboard {
    [self.textField resignFirstResponder];
    [self.textView resignFirstResponder];
    //or replace this with your regular right button
    self.navigationItem.rightBarButtonItem = nil;
} 
```

* * *

## 回答 #12

> 赞同：6
> 
> 时间：2016-02-22T23:40:48.020

迅速

```
func textView(textView: UITextView, shouldChangeTextInRange range: NSRange, replacementText text: String) -> Bool {
    if text == "\n" {
        textView.resignFirstResponder()
    }
    return true
} 
```

[![并配置](https://i.stack.imgur.com/Df6O1.png)](https://i.stack.imgur.com/Df6O1.png)

* * *

## 回答 #13

> 赞同：5
> 
> 时间：2012-03-21T00:16:20.260

就像对 samvermette 的马特评论一样，我也不喜欢检测“\n”的想法。UITextView 中有“return”键是有原因的，当然是转到下一行。

我认为最好的解决方案是模仿 iPhone 消息应用程序——即在键盘上添加工具栏（和按钮）。

我从以下博客文章中获得了代码：

[http://www.iosdevnotes.com/2011/02/iphone-keyboard-toolbar/](http://www.iosdevnotes.com/2011/02/iphone-keyboard-toolbar/)

脚步：

- 将工具栏添加到您的 XIB 文件 - 将高度设置为 460

- 添加工具栏按钮项（如果尚未添加）。如果需要右对齐，还要在XIB中添加灵活的bar button item，并移动toolbar button item

- 创建将按钮项链接到 resignFirstResponder 的操作，如下所示：

```
- (IBAction)hideKeyboard:(id)sender {
    [yourUITextView resignFirstResponder];
} 
```

-然后：

```
- (void)viewWillAppear:(BOOL)animated {
    [super viewWillAppear:animated];

    [[NSNotificationCenter defaultCenter] addObserver:self selector:@selector(keyboardWillShow:) name:UIKeyboardWillShowNotification object:nil];
    [[NSNotificationCenter defaultCenter] addObserver:self selector:@selector(keyboardWillHide:) name:UIKeyboardWillHideNotification object:nil];
}

- (void)viewWillDisappear:(BOOL)animated {
    [super viewWillDisappear:animated];

    [[NSNotificationCenter defaultCenter] removeObserver:self name:UIKeyboardWillShowNotification object:nil];
    [[NSNotificationCenter defaultCenter] removeObserver:self name:UIKeyboardWillHideNotification object:nil];
}

- (void)keyboardWillShow:(NSNotification *)notification {
    [UIView beginAnimations:nil context:NULL];
    [UIView setAnimationDuration:0.3];

    CGRect frame = self.keyboardToolbar.frame;
    frame.origin.y = self.view.frame.size.height - 260.0;
    self.keyboardToolbar.frame = frame;

    [UIView commitAnimations];
}

- (void)keyboardWillHide:(NSNotification *)notification {
    [UIView beginAnimations:nil context:NULL];
    [UIView setAnimationDuration:0.3];

    CGRect frame = self.keyboardToolbar.frame;
    frame.origin.y = self.view.frame.size.height;
    self.keyboardToolbar.frame = frame;

    [UIView commitAnimations];
} 
```

* * *

## 回答 #14

> 赞同：5
> 
> 时间：2012-09-07T20:58:32.620

在 viewDidLoad 中添加观察者

```
[[NSNotificationCenter defaultCenter] addObserver: self selector: @selector(textViewKeyPressed:) name: UITextViewTextDidChangeNotification object: nil]; 
```

然后使用选择器检查“\n”

```
-(void) textViewKeyPressed: (NSNotification*) notification {

  if ([[[notification object] text] hasSuffix:@"\n"])
  {
    [[notification object] resignFirstResponder];
  }
} 
```

它确实使用“\n”并且没有专门检查返回键，但我认为这没关系。

**更新**

请参阅下面 ribto 的答案，它使用`[NSCharacterSet newlineCharacterSet]`代替`\n`

* * *

## 回答 #15

> 赞同：5
> 
> 时间：2014-02-27T10:06:43.200

只是用不同的方式解决了这个问题。

*   创建一个将放置在背景中的按钮
*   在属性检查器中，将按钮类型更改为自定义，并使按钮透明。
*   展开按钮以覆盖整个视图，并确保按钮位于所有其他对象的后面。简单的方法是将按钮拖到视图中的列表视图顶部
*   控制将按钮拖动到`viewController.h`文件并创建一个动作（Sent Event: Touch Up Inside），如：

    ```
    (IBAction)ExitKeyboard:(id)sender; 
    ```

*   在`ViewController.m`应该看起来像：

    ```
    (IBAction)ExitKeyboard:(id)sender {
        [self.view endEditing:TRUE];
    } 
    ```

*   运行应用程序，当您单击离开 TextView 时，键盘消失

* * *

## 回答 #16

> 赞同：5
> 
> 时间：2014-11-06T19:32:06.523

SWIFT代码

在您的类/视图中实现 UITextViewDelegate ，如下所示：

```
class MyClass: UITextViewDelegate  { ... 
```

将 textView 委托设置为 self

```
myTextView.delegate = self 
```

然后执行以下操作：

```
 func textViewDidChange(_ textView: UITextView) {
    if textView.text.characters.count >= 1 {

        if let lastChar = textView.text.characters.last {

            if(lastChar == "\n"){

              textView.text = textView.text.substring(to: textView.text.index(before: textView.text.endIndex))
              textView.resignFirstResponder()
            }
        }
    }
} 
```

**编辑** 我更新了代码，因为在 hack 代码完成后将文本字段中的用户输入更改为 workarround 并且不重置状态绝不是一个好主意。

* * *

## 回答 #17

> 赞同：4
> 
> 时间：2013-12-06T10:57:21.023

试试这个 ：

```
 - (BOOL)textView:(UITextView *)textView shouldChangeTextInRange:(NSRange)range replacementText:(NSString *)text{
    if ([text isEqualToString:@"\n"]) {
        [self.view endEditing:YES];
    }

    return YES;

} 
```

* * *

## 回答 #18

> 赞同：4
> 
> 时间：2015-01-19T11:40:34.180

//你可以用这个...

步骤 1\. 第一步是确保您声明支持该`UITextViewDelegate`协议。这是在您的头文件中完成的，例如这里的头文件名为

编辑器控制器.h：

```
@interface EditorController : UIViewController  {
  UITextView *messageTextView;
}

@property (nonatomic, retain) UITextView *messageTextView;

@end 
```

第 2 步。接下来，您需要将控制器注册为 UITextView 的委托。继续上面的例子，下面是我如何将`UITextView`with初始化`EditorController`为委托……</p>

```
- (id) init {
    if (self = [super init]) {
        // define the area and location for the UITextView
        CGRect tfFrame = CGRectMake(10, 10, 300, 100);
        messageTextView = [[UITextView alloc] initWithFrame:tfFrame];
        // make sure that it is editable
        messageTextView.editable = YES;

        // add the controller as the delegate
        messageTextView.delegate = self;
    } 
```

第 3 步。现在的最后一块拼图是对`shouldCahngeTextInRange`消息采取行动，如下所示：

```
- (BOOL)textView:(UITextView *)textView shouldChangeTextInRange:(NSRange)range 
  replacementText:(NSString *)text
{
    // Any new character added is passed in as the "text" parameter
    if ([text isEqualToString:@"\n"]) {
        // Be sure to test for equality using the "isEqualToString" message
        [textView resignFirstResponder];

        // Return FALSE so that the final '\n' character doesn't get added
        return FALSE;
    }
    // For any other character return TRUE so that the text gets added to the view
    return TRUE;
} 
```

* * *

## 回答 #19

> 赞同：3
> 
> 时间：2014-02-24T10:24:46.420

您还可以在视图屏幕中触摸时隐藏键盘：

```
- (void)touchesBegan:(NSSet *)touches withEvent:(UIEvent *)event {
     UITouch * touch = [touches anyObject];
     if(touch.phase == UITouchPhaseBegan) {
        [txtDetail resignFirstResponder];
      }
 } 
```

* * *

## 回答 #20

> 赞同：3
> 
> 时间：2015-06-15T02:26:08.767

快速回答：

```
override func viewDidLoad() {
    super.viewDidLoad()
    let tapGestureReconizer = UITapGestureRecognizer(target: self, action: "tap:")
    view.addGestureRecognizer(tapGestureReconizer)
}

func tap(sender: UITapGestureRecognizer) {
    view.endEditing(true)
} 
```

* * *

## 回答 #21

> 赞同：3
> 
> 时间：2015-09-23T11:23:32.110

我使用此代码更改响应者。

```
 - (BOOL)textView:(UITextView*) textView shouldChangeTextInRange: (NSRange) range replacementText: (NSString*) text
    {
        if ([text isEqualToString:@"\n"]) {
            //[textView resignFirstResponder];
            //return YES;
            NSInteger nextTag = textView.tag + 1;
            // Try to find next responder
            UIResponder* nextResponder = [self.view viewWithTag:nextTag];
            if (nextResponder) {
                // Found next responder, so set it.
                [nextResponder becomeFirstResponder];
            } else {
                // Not found, so remove keyboard.
                [textView resignFirstResponder];
            }
            return NO; 

            return NO;
        }
        return YES;

    } 
```

* * *

## 回答 #22

> 赞同：3
> 
> 时间：2016-12-16T11:04:37.887

该问题询问如何使用返回键来执行此操作，但我认为这可以帮助那些打算在使用 UITextView 时让键盘消失的人：

```
private func addToolBarForTextView() {
    let textViewToolbar: UIToolbar = UIToolbar()
    textViewToolbar.barStyle = .default
    textViewToolbar.items = [
        UIBarButtonItem(title: "Cancel", style: .done,
                  target: self, action: #selector(cancelInput)),
        UIBarButtonItem(barButtonSystemItem: .flexibleSpace,
                  target: self, action: nil),
        UIBarButtonItem(title: "Post Reply", style: .done,
                  target: self, action: #selector(doneInput))
    ]
    textViewToolbar.sizeToFit()
    yourTextView.inputAccessoryView = textViewToolbar
}

@objc func cancelInput() { print("cancel") }
@objc func doneInput() { print("done") }

override func viewDidLoad() {
    super.viewDidLoad()
    addToolBarForTextView()
} 
```

在*viewDidLoad*或其他一些生命周期方法中调用*addToolBarForTextView() 。*

 *看来这对我来说是完美的解决方案。

干杯，

穆拉特

* * *

## 回答 #23

> 赞同：2
> 
> 时间：2012-01-31T10:53:16.667

行。每个人都给出了技巧的答案，但我认为实现这一目标的正确方法是

将以下操作连接到 中的“**退出时结束**”事件`Interface Builder`。（右键单击`TextField`并 cntrl-从 ' **Did end on exit** ' 拖动到以下方法。

```
-(IBAction)hideTheKeyboard:(id)sender
{
    [self.view endEditing:TRUE];
} 
```

* * *

## 回答 #24

> 赞同：1
> 
> 时间：2014-08-27T06:37:38.270

```
- (BOOL)textView:(UITextView *)textView shouldChangeTextInRange:(NSRange)range  replacementText:(NSString *)text
{
    if (range.length==0) {
        if ([text isEqualToString:@"\n"]) {
            [txtView resignFirstResponder];
            if(textView.returnKeyType== UIReturnKeyGo){

                [self PreviewLatter];
                return NO;
            }
            return NO;
        }
    }   return YES;
} 
```

* * *

## 回答 #25

> 赞同：1
> 
> 时间：2015-03-10T08:01:46.873

```
+ (void)addDoneButtonToControl:(id)txtFieldOrTextView
{
    if([txtFieldOrTextView isKindOfClass:[UITextField class]])
    {
        txtFieldOrTextView = (UITextField *)txtFieldOrTextView;
    }
    else if([txtFieldOrTextView isKindOfClass:[UITextView class]])
    {
        txtFieldOrTextView = (UITextView *)txtFieldOrTextView;
    }

    UIToolbar* numberToolbar = [[UIToolbar alloc]initWithFrame:CGRectMake(0,
                                                                          0,
                                                                          [Global returnDeviceWidth],
                                                                          50)];
    numberToolbar.barStyle = UIBarStyleDefault;

    UIBarButtonItem *btnDone = [[UIBarButtonItem alloc] initWithImage:[UIImage imageNamed:@"btn_return"]
                                                                style:UIBarButtonItemStyleBordered
                                                               target:txtFieldOrTextView
                                                               action:@selector(resignFirstResponder)];

    numberToolbar.items = [NSArray arrayWithObjects:btnDone,nil];
    [numberToolbar sizeToFit];

    if([txtFieldOrTextView isKindOfClass:[UITextField class]])
    {
         ((UITextField *)txtFieldOrTextView).inputAccessoryView = numberToolbar;
    }
    else if([txtFieldOrTextView isKindOfClass:[UITextView class]])
    {
         ((UITextView *)txtFieldOrTextView).inputAccessoryView = numberToolbar;
    }
} 
```

* * *

## 回答 #26

> 赞同：1
> 
> 时间：2019-02-25T10:32:13.240

您应该添加`UIToolbar`到顶部 UITextView 以简化而不是使用`shouldChangeTextIn`

在斯威夫特 4

```
let toolbar = UIToolbar(frame: CGRect(x: 0, y: 0, width: UIScreen.main.bounds.width, height: 50))
        toolbar.barStyle = .default
        toolbar.items = [
            UIBarButtonItem(barButtonSystemItem: .flexibleSpace, target: nil, action: nil),
            UIBarButtonItem(title: "Done", style: .done, target: self, action: #selector(doneAction))
        ]
        textView.inputAccessoryView = toolbar 
```

```
@objc func doneAction(){
 self.textView.resignFirstResponder()
} 
```

* * *

## 回答 #27

> 赞同：0
> 
> 时间：2013-10-13T21:12:27.470

我知道这不是这个问题的确切答案，但我在上网寻找答案后找到了这个帖子。我假设其他人也有这种感觉。

这是我发现可靠且易于使用的 UITapGestureRecognizer 的变体 - 只需将 TextView 的委托设置为 ViewController。

当 TextView 变为活动状态以进行编辑时，我添加了 UITapGestureRecognizer 而不是 ViewDidLoad：

```
-(void)textViewDidBeginEditing:(UITextView *)textView{
    _tapRec = [[UITapGestureRecognizer alloc]initWithTarget:self action:@selector(tap:)];

    [self.view addGestureRecognizer: _tapRec];
    NSLog(@"TextView Did begin");
} 
```

当我在 TextView 外部点击时，视图将结束编辑模式，并且 UITapGestureRecognizer 会自行移除，因此我可以继续与视图中的其他控件进行交互。

```
-(void)tap:(UITapGestureRecognizer *)tapRec{
    [[self view] endEditing: YES];
    [self.view removeGestureRecognizer:tapRec];
    NSLog(@"Tap recognized, tapRec getting removed");
} 
```

我希望这有帮助。看起来很明显，但我从未在网络上的任何地方看到过这个解决方案——我做错了什么吗？

* * *

## 回答 #28

> 赞同：0
> 
> 时间：2014-05-20T06:53:07.330

不要忘记为 textView 设置委托 - 否则 resignfirstresponder 将不起作用。

* * *

## 回答 #29

> 赞同：0
> 
> 时间：2015-03-31T09:51:55.427

试试这个 。

```
NSInteger lengthOfText = [[textView.text stringByTrimmingCharactersInSet:[NSCharacterSet whitespaceAndNewlineCharacterSet]] length]; 
```

* * *

## 回答 #30

> 赞同：0
> 
> 时间：2015-07-09T09:12:13.157

对于 Xcode 6.4.、Swift 1.2。：

```
 override func touchesBegan(touches: Set<NSObject>, withEvent event: UIEvent)
    {
        super.touchesBegan(touches, withEvent: event)
        if let touch = touches.first as? UITouch
        {
            self.meaningTextview.resignFirstResponder()
        }
    } 
```

* * *

## 回答 #31

> 赞同：-1
> 
> 时间：2013-10-21T11:55:42.957

我对此的破解：

1-创建一个覆盖整个视图的按钮；2-将其发送到视图的背景，3-在属性检查器中将其类型从“圆形矩形”更改为“自定义”，4-创建一个动作 5-实现动作方法：

```
- (IBAction)bgTouched:(id)sender 
{
    //to dismiss keyboard on bg btn pressed
    [_userInput resignFirstResponder];
} 
```

其中 _userInput 是您的 TextField 出口

* * *

## 回答 #32

> 赞同：-1
> 
> 时间：2017-02-02T10:56:31.237

对于 Swift 3，此代码允许我在 UITextView 外部按下以关闭键盘。

```
@IBOutlet weak var comment: UITextView!

   override func viewDidLoad() {
        super.viewDidLoad()

        comment.delegate = self

        let tapGestureRecogniser = UITapGestureRecognizer(target: self, action: #selector(tap))
        view.addGestureRecognizer(tapGestureRecogniser)
    }

    func tap(sender: UITapGestureRecognizer) {
        if comment.isFirstResponder {
            comment.resignFirstResponder()
        }
    } 
```

* * *

## 回答 #33

> 赞同：-2
> 
> 时间：2010-12-30T16:53:37.253

```
-(BOOL)textFieldShouldReturn:(UITextField *)textField; // called from textfield (keyboard)

-(BOOL)textView:(UITextView *)textView shouldChangeTextInRange:(NSRange)range replacementText:(NSString *)text; // good tester function - thanks
```

* * *

## 回答 #34

> 赞同：-2
> 
> 时间：2014-11-01T21:13:58.110

隐藏Queboard的功能。

```
- (void)HideQueyboard
{
    [[UIApplication sharedApplication] sendAction:@selector(resignFirstResponder)   to:nil from:nil forEvent:nil];
} 
```

# c# - 安全漏洞清单

> ID：703757
> 
> 赞同：5
> 
> 时间：2009-04-01T01:50:27.727
> 
> 标签：c#, .net, sql-server, security

我正在开发一个基于 .Net/C# MSSQL 作为数据库的面向消费者的 Web 应用程序

我们一直在遵循一般的良好编码实践来防止错误和 SQL/JS 查询注入，但我们都不是安全专家。

找出我们正在构建的应用程序的安全性有多好，这将是一个很好的清单。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-01T02:55:28.427

我不确定清单是什么意思，因为它可能与开发（以帮助开发人员编写更少的错误）、代码审查（以在审查中发现错误）或测试（以确保漏洞的所有方面都经过测试）有关）。

OWASP 确实有支持所有这三种需求的指南 -

*   [OWASP 开发指南](http://www.owasp.org/index.php/Category:OWASP_Guide_Project)
*   [OWASP 代码审查指南](http://www.owasp.org/index.php/Category:OWASP_Code_Review_Project)
*   [OWASP 测试指南](http://www.owasp.org/index.php/Category:OWASP_Testing_Project)

然后最重要的是，您可以随时参考[OWASP 前 10 名列表](http://www.owasp.org/index.php/Category:OWASP_Top_Ten_Project)，以确定您希望集中精力解决的漏洞的优先级。

[正如 Mark 提到](https://stackoverflow.com/questions/703757/security-vulnerabilies-checklist/703822#703822)的，OWASP .NET 项目将很有用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-01T02:19:03.367

开放式 Web 应用程序安全项目 ( [OWASP](http://www.owasp.org) ) 有许多资源 - 您可以从前 10 个漏洞开始，并查看测试和代码审查指南。[我们在OWASP .NET](http://www.owasp.org/index.php/Category:OWASP_.NET_Project "OWASP .NET")有一个专门针对 .NET 的项目。此外，这里还有一个有用的资源列表，[为 .NET 推荐的网络安全资源](http://www.owasp.org/index.php/OWASP_.NET_Recommended_Resources)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-01T01:54:31.430

由于您在 MS 平台上进行开发，您是否查看过[安全开发生命周期](http://msdn.microsoft.com/en-us/security/cc448177.aspx)？

Michael Howard 的[编写安全代码](https://rads.stackoverflow.com/amzn/click/com/0735617228)也涵盖了其中的许多实践。

# mfc - 单击或选择 Clistctrl 子项（报告视图）

> ID：703758
> 
> 赞同：0
> 
> 时间：2009-04-01T01:51:17.193
> 
> 标签：mfc, clistctrl

如何确定报表视图 Clistctrl 的选定或单击的子项？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-01T03:59:21.910

[CListCtrl::SubItemHitTest](http://msdn.microsoft.com/en-us/library/fxee9zz9(VS.80).aspx)

# javascript - 检查客户端是否接受 javascript 中的 cookie？

> ID：703761
> 
> 赞同：16
> 
> 时间：2009-04-01T01:52:16.990
> 
> 标签：javascript, cookies

有什么方法可以检查客户端是否仅使用 javascript 代码接受 cookie？

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2009-04-08T21:05:48.073

这应该可以解决问题：

```
function areCookiesEnabled() {
  document.cookie = "__verify=1";
  var supportsCookies = document.cookie.length >= 1 && 
                        document.cookie.indexOf("__verify=1") !== -1;
  var thePast = new Date(1976, 8, 16);
  document.cookie = "__verify=1;expires=" + thePast.toUTCString();
  return supportsCookies;
} 
```

这会设置一个基于会话过期的 cookie，检查它是否存在，然后在过去再次设置它，将其删除。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2014-06-06T12:11:48.397

该[`cookieEnabled`](https://developer.mozilla.org/en-US/docs/Web/API/Navigator/cookieEnabled)属性返回一个布尔值，指定是否在浏览器中启用 cookie

```
<script>
if (navigator.cookieEnabled) {
    // Cookies are enabled
}
else {
    // Cookies are disabled
}
</script> 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-02-09T23:14:23.297

对于那些使用[jQuery Cookie](https://github.com/carhartl/jquery-cookie)来管理和创建 cookie 的人来说，这里有一种检查 cookie 的简单方法，在检查 cookie 后，运行基于启用或禁用 cookie 的功能。

```
//Create Session Cookie
$.cookie('test-for-cookie', '1');

//Test for Session Cookie
var yesCookie = $.cookie('test-for-cookie');
if  (yesCookie == 1) { 
    //Run function if cookies are enabled.
} else{
    //If cookies are not enabled run this function.
} 
```

[jsFiddle 的工作示例。](http://jsfiddle.net/Lynda333/82CKg/1/)

# c# - 从数组填充列表

> ID：703762
> 
> 赞同：17
> 
> 时间：2009-04-01T01:53:25.503
> 
> 标签：c#, arrays, generics

如果我有一个数组。我可以从该数组中填充一个通用列表：

```
Foo[] fooList . . . (assume populated array)

// This doesn't seem to work
List<Foo> newList = new List<Foo>(fooList); 
```

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2009-04-01T01:58:00.640

您可以将数组转换为列表：

```
string[] strings = { "hello", "world" };
IList<string> stringList = strings.ToList(); 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-04-01T01:57:15.197

您正在寻找[List(t).AddRange](http://msdn.microsoft.com/en-us/library/z883w3dc.aspx)方法

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-04-01T01:59:17.503

正如@korki 所说， AddRange 可以工作，但是您发布的代码应该可以正常工作。例如，这编译：

```
var i = new int[10];
var list = new List<int>(i); 
```

你能告诉我们更多你的代码吗？

# database - 为什么要使用 Singleton 来管理数据库连接？

> ID：703767
> 
> 赞同：10
> 
> 时间：2009-04-01T01:55:28.680
> 
> 标签：database

我知道之前在这里和任何地方都曾问过这个问题，但我无法得到明确的解释，所以我将再次提出。那么在你的网络应用程序中使用单例控制数据库连接有什么大惊小怪的呢？有人喜欢有人讨厌我不明白。根据我的阅读，“这是为了确保始终只有一个活动连接到您的数据库”。我的意思是为什么这是一件好事？每秒处理多个请求的数据驱动的 Web 应用程序上的 1 个活动数据库连接会带来麻烦，不是吗？无论出于何种原因，没有人能正确解释这一点。我一直在网上。我知道我很厚。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-01T02:09:17.260

假设这里是 Java，但也与大多数其他技术相关。

我不确定您是否将普通单例与[服务定位器](http://java.sun.com/blueprints/patterns/ServiceLocator.html)的使用混淆了。它们都是设计模式。应用程序使用服务定位器模式来确保有一个类负责获取和提供对数据库、文件、JMS 队列等的访问。

大多数服务定位器都是作为单例实现的，因为不需要多个服务定位器来完成相同的工作。此外，缓存从第一次查找中获得的信息是很有用的，以后可以由服务定位器的其他客户端使用。

顺便说一句，关于

> “这是为了确保您的数据库始终只有一个活动连接”

是虚假和误导性的。如果长时间处于非活动状态，连接很可能会被关闭/回收。因此，不赞成缓存与数据库的连接。这个论点有一个偏差。只要您使用相同的上下文，即在相同的 HTTP 请求或用户请求中（以适用者为准），就鼓励“重用”从连接池获得的连接。从性能的角度来看，这样做很明显，因为建立新的连接可能被证明是一项昂贵的操作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-01T02:03:43.497

高性能（甚至中等性能）Web 应用程序使用数据库[连接池](http://en.wikipedia.org/wiki/Connection_pool)，因此可以在多个 Web 请求之间共享一个 DB 连接。单例通常是管理这个池的对象。我认为使用单例的动机是为了防止维护程序员白痴，否则他们可能会不必要地实例化许多这些对象。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-01T02:07:41.443

“这是为了确保您的数据库始终只有一个活动连接。” 我认为最好这样说，以确保每个客户只有一个与您的数据库的活动连接。这非常重要的原因是因为您想防止死锁。如果我有两个打开的数据库连接（作为客户端），我可能会在一个连接上进行更新，那么我可能会尝试在另一个连接中更新同一行。这将导致数据库无法检测到的死锁。所以，单例的想法基本上是确保有一个对象负责向每个客户端分发数据库连接。基本上。你不必为此设置一个单例，但大多数人会告诉你，系统只有一个是有道理的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-01T02:00:44.957

你是对的——通常这不是你想要的。

但是，在很多情况下，您需要将自己限制为单个连接。通过单例序列化您对数据库的访问，您可以解决其他问题或约束，例如负载、带宽等。

我过去为批量处理应用程序做过类似的事情。不过，相反，我使用信号量来同步对数据库的访问，这样我就可以允许 n 个并发的数据库操作。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-01T02:01:28.120

由于数据库服务器的限制，人们可能想要使用单例，例如，服务器可能会限制连接数。

我的主要意识原因是您知道可以管理/关闭哪些连接等，当您没有不必要的冗余连接时，只会让事情更有条理。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-01T02:02:01.333

我不认为这是一个简单的答案。例如在 ASP.NET 上，该平台默认实现连接池，因此它会自动调整连接“池”并重新使用它们，这样您就不会不断地创建和销毁昂贵的对象。

但是，假设您正在编写一个监控 200 个独立输入源的数据收集应用程序。每次其中一个输入发生更改时，您都会触发一个将事件记录到数据库的线程。如果有可能其中的一小部分有可能同时触发，我会说这可能是一个糟糕的设计。突然拥有 20 或 40 个活动数据库连接是低效的。将更新排队可能会更好，只要队列中还有更新，单例连接就会将它们从队列中挑选出来并在服务器上执行它们。它更有效，因为您只需协商一次连接和身份验证。一旦有一段时间没有活动，您可以选择关闭连接。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-01T02:02:06.107

“只有一个活动连接”是用于说明的非常狭隘的陈述。它也可以是一个管理连接池的单例。单例数据库连接的意义在于，您不希望每个消费者都建立自己的连接或一组连接。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-04-01T02:03:01.940

我认为您可能想要更具体地了解“使用单例控制 Web 应用程序中的数据库连接”。理想情况下，java.sql.Connection 对象**不会**是线程安全的，但是您的 javax.sql.DataSource 可能想要池连接，因此您应该转到它的单个实例来共享池。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-04-01T02:05:02.840

您更多的是为每个请求寻找一个连接，而不是整个应用程序的一个连接。您仍然可以通过单例控制对它的访问（将连接存储在 HttpContext.Items 集合中）。

* * *

## 回答 #10

> 赞同：-4
> 
> 时间：2009-04-01T02:00:58.870

它保证每个使用您的站点的客户端只获得一个到数据库的连接。您真的不希望每次用户执行将创建数据库查询的操作时都建立新连接。不仅是出于性能方面的原因，涉及到连接握手，而且是为了减少数据库服务器上的负载。

数据库连接是一种宝贵的商品，这种技术有助于在任何给定时间最大限度地减少使用量。

# javascript - 如果它是一个数字或包含数字，jQuery 中的 this.id 将不会获取元素 id

> ID：703774
> 
> 赞同：2
> 
> 时间：2009-04-01T01:59:01.903
> 
> 标签：javascript, jquery, html

我有一堆自动生成的 div，它们的 id 有一个数字。每当我使用 this.id 获取 id 时，它什么都不输出。但是，当 Id 仅是文本时，它会正确输出 id。我该如何解决这个问题？什么都有帮助。谢谢

编辑：

```
$(".draggable").draggable();
$("*", document.body).click(function (e) {   
                var offset = $(this).offset();
                e.stopPropagation();
                $("#result").text(this.tagName + "  ID:" + this.id + " Coord:" + offset.left + " " + offset.top);
                $.post("http://localhost/framework/test.php", "id=" + this.id + "&x=" + offset.left + "&y=" + offset.top);
            }); 
```

这是有问题的代码。然而，它将获得 div 的 id，但未应用“可拖动”类。

```
 <div id="container">

       <div id="1" class="draggable" style="top:55px; left:55px; border: 2px solid black; display: inline-table; position: relative; background-color: grey; max-width: 500px;">
            <div>Im an Image Posted by:Teh_noob Posted on: 9/15/1991</div>

            <div><img src="http://video.google.com/img/logo_video.gif?hl=en" /></div>
       </div>

       <div id="2" class="draggable" style="top:57px; left:33px; border: 2px solid black; display: inline-table; position: relative; background-color: grey; max-width: 500px;">
            <div>Youtube test Posted by:teh nub Posted on: 9/11/01</div>
            <div><object width="640" height="385"><param name="movie" value="http://www.youtube.com/v/_AJ0SkbPxAk&hl=en&fs=1&rel=0"></param><param name="allowFullScreen" value="true"></param><embed id="flash" wmode="transparent" src="http://www.youtube.com/v/_AJ0SkbPxAk&hl=en&fs=1&rel=0" type="application/x-shockwave-flash" allowfullscreen="true" width="640" height="385"></embed></object></div>
       </div>

       <div id="3" class="draggable" style="top:33px; left:12px; border: 2px solid black; display: inline-table; position: relative; background-color: grey; max-width: 500px;">
            <div>Text box Posted by:teh noob Posted on: 8/23/09</div>

            <div>TESTTESTTESTTESTTESTTESTTESTTESTTESTTESTTESTTESTTESTTESTTESTTESTTESTTESTTESTTESTTESTTESTTESTTESTTESTTESTTESTTESTTESTTESTTESTTESTTESTTEST</div>
       </div>

    </div>
    <p id="result"></p> 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-01T02:04:25.383

请注意，纯数字 ID 无效。有关更多信息，请参阅[此帖子](https://stackoverflow.com/questions/70579/what-is-a-valid-value-for-id-attributes-in-html)。

简短而甜蜜的是：

> ID 和 NAME 标记必须以字母 ([A-Za-z]) 开头，后跟任意数量的字母、数字 ([0-9])、连字符 ("-")、下划线 ("_") , 冒号 (":") 和句点 (".")。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-06-27T20:33:02.127

在生成的 html 中添加如下前缀：

```
<div id="prefix_1" class="draggable" style="top:55px; left:55px; border: 2px solid black; display: inline-table; position: relative; background-color: grey; max-width: 500px;">
        <div>Im an Image Posted by:Teh_noob Posted on: 9/15/1991</div> 
```

并在java脚本中，添加相同的前缀

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-06-23T07:31:26.470

您正在尝试使用完全覆盖它们的其他子元素获取元素的 ID……这就是为什么您没有获得任何 ID。

而不是 this.id，请尝试 e.target.id。如果你点击 flash 电影，你会得到 id="flash"。

[http://jsfiddle.net/rzfPP/49/](http://jsfiddle.net/rzfPP/49/)

此外，您的目标是错误的元素。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-01T13:51:30.210

虽然允许使用句点和冒号，但我不推荐它。

如果您必须根据 id 进行选择，jQuery 将失败，因为它会认为这是一个新的类选择器或过滤器。

# css - 加载时隐藏 jQuery Accordion

> ID：703783
> 
> 赞同：11
> 
> 时间：2009-04-01T02:01:53.987
> 
> 标签：css, jquery-plugins, accordion

我正在测试一个连接速度较慢的站点构建，我注意到 jQuery Accordion 保持扩展很长时间，直到站点的其余部分被加载，然后最终崩溃。不是很漂亮。我想知道如何让它在加载过程中保持折叠状态，并且只有在单击时才会展开。

我正在使用手风琴插件的独立 1.6 版本。

基本结构：

```
<div class="sidebar">
    <ul id="navigation" class="ui-accordion-container">
        <li><a class="head" href="#">1</a>
            <ul class="sub">
                <li><a href="#">1a</a></li>
                <li><a href="#">2a</a></li>
            </ul> 
         </li>
    </ul>
</div> 
```

和脚本

```
jQuery().ready(function(){
    jQuery('#navigation').accordion({ 
        active: 'false', 
        header: '.head', 
        navigation: true,
        animated: 'easeslide',
        collapsible: true
    });     
}); 
```

我试图隐藏 CSS 中的元素以防止它们在加载时出现，但所取得的只是让它们始终隐藏。

也许问题出在 CSS 中，我在每个子菜单中都有一个背景图像：

```
#navigation{
    margin:0px;
    margin-left: 10px;
    padding:0px;
    text-indent:0px;
    font-size: 1.1em;
    width:200px;
    text-transform: uppercase;
    padding-bottom: 30px;
} 
#navigation ul{
    border-width:0px;
    margin:0px;
    padding:0px;
    text-indent:0px;
}
#navigation li{
    list-style:none outside none;
}
#navigation li ul{
    height:185px; overflow:auto;
}
#navigation li ul.sub{
    background:url('../images/sub.jpg') no-repeat;
    dispaly: block;
}
#navigation li li a{
    color:#000000;
    display:block;
    text-indent:20px;
    text-decoration: none;
    padding: 6px 0;
}
#navigation li li a:hover{
    background-color:#FFFF99;
    color:#FF0000;
} 
```

在此先感谢您提供有关如何让这件事运行得更顺畅以及手风琴总是崩溃的任何建议。

-edit - 我忘了提到我也希望有一个解决方案，让那些没有 Javascript 的人仍然可以访问导航。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-04-01T04:06:49.910

我对我所有的网站都做这第一件事：在 body 标签之后，用这个 javascript 放置一个脚本标签：

```
jQuery('body').addClass('js'); 
```

这为您提供了一个样式挂钩，用于在启用 Javascript 时以某种方式看起来不同的任何元素，并且它会立即发生。

在其他答案中，您的其余问题都有很好的解决方案。您只需要两种“基本”样式而不是一种：

```
#navigation ul li { /*open styles for no javascript*/ }
body.js #navigation ul li { /*closed styles for pre dom.ready*/ } 
```

...然后在 dom.ready 上应用手风琴之前重新打开。

编辑：如果您在页面末尾加载 jQuery（或不使用 jQuery），您可以使用这个直接的 javascript 版本：

```
<script type="text/javascript">
    var b = document.getElementsByTagName('body')[0];
    b.className+=b.className?' js':'js';
</script> 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-04-26T19:27:03.190

一周前我遇到了这个问题。我将容器设置为 display:none，然后使用 jQuery 使其在适当的时间显示：

```
$(".accordion").show();
$(".accordion").accordion(); 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-04-01T02:26:07.907

jQuery.ready() 中的代码在 DOM 准备好之前不会运行——因此对于最终将被隐藏的元素保持可见一段时间是正常的。以这种方式设置 Accordion 部分是为了便于使用，部分是为了优雅地降级：如果禁用 JavaScript，内容不会丢失（隐藏）。

如果您愿意冒险在没有 JavaScript 的情况下破坏页面，请继续将您的元素设置为隐藏。然后，就在 .accordion() 之前，show() 它们。

* * *

这是一个保持兼容性的想法。它已经过最低限度的测试，可以发表评论。

不理会您的 CSS，但将其添加到 JavaScript 的顶部（*外部* `jQuery.ready()`）：

```
document.styleSheets[0].addRule(".yourclass", "display:none"); 
```

这样，在构建页面时，将设置一条 CSS 规则来隐藏您的隐藏元素。然后，在内部`jQuery.ready()`，在初始化手风琴之前调用`$(".yourclass").show()`将它们带回来。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-01T02:58:33.850

直接在手风琴元素下方的 <script> 中进行 .accordion 绑定，而不是等待文档准备好。

然后它们会尽快激活，而不是等到页面“准备好”（这可能需要很长时间，尤其是在 IE 上，它不支持 DOMContentLoaded 事件，所以 jQuery 必须等待 onload，这只会在所有图像和所有内容都加载后触发）。

您*可以*将手风琴父元素设置为“可见性：隐藏”，然后在脚本初始化时手动将其恢复为“可见”。但是，关闭 JavaScript 的浏览器根本看不到内容，这并不理想。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-09-08T16:48:00.593

在可访问性方面小心使用它：

```
body {
  display: none; 
} 
```

如果出于某种原因关闭了 javascript，则不会显示任何内容；)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-01T02:08:18.433

我没有使用过 UI 手风琴，但我用 jQuery 构建了手风琴。该脚本唯一要做的就是改变手风琴面板的可见性。因此，如果在页面加载时一个面板可见，那么也许您应该尝试使用 CSS 规则，例如：

```
ul.sub{
  visiblity:hidden;
  display:none;
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-01T02:19:58.780

> 我试图隐藏 CSS 中的元素以防止它们在加载时出现，但所取得的只是让它们始终隐藏。

为什么不尝试将其隐藏在 css 中，然后执行以下操作：

jQuery('#navigation').show().accordian...

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2010-06-03T15:31:42.977

我在许多门户网站上有数百个 jQuery 元素（选项卡、滑块和手风琴）。为每个设置隐藏/显示样式不是一个现实的选择。

简单的解决方案，隐藏正文直到 jQuery 准备好并构建元素，然后显示正文。

在我的主样式表中：

```
body {
  display: none; 
} 
```

在我的主 javascript 文件中，在 jQuery.ready() 的底部：

```
$(document).ready(function() { 
   $("body").show(); 
} 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2010-06-28T09:55:16.143

我一直在使用 Tim 建议的 CSS 解决方案，但这些解决方案意味着为禁用 javascript 的人（或不支持 javascript 的设备）隐藏内容。我更喜欢 Jerph 提供的解决方案，谢谢分享。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2013-10-24T10:01:27.697

我没有使用过 UI 手风琴，但我用 jQuery 构建了手风琴。该脚本唯一要做的就是改变手风琴面板的可见性。因此，如果在页面加载时一个面板可见，那么也许您应该尝试使用 CSS 规则，例如：

```
ul.sub{
  visiblity:hidden;
  display:none;
} 
```

# asp.net - ASP.Net 错误：从客户端检测到具有潜在危险的 Request.Form 值

> ID：703786
> 
> 赞同：0
> 
> 时间：2009-04-01T02:02:16.123
> 
> 标签：asp.net

我在我的 asp.net 页面中收到此错误：

> 从客户端检测到潜在危险的 Request.Form 值 (ctl00$DefaultContent$UCSimpleSearch$txtFind="$%^&#%^&@#%@")。

当我在此页面的文本框中键入 $%^&#%^&@#%@ 并点击提交时，我收到此错误。

我该如何克服这个错误？是否建议在 Page 指令中设置 validateRequest=false 以摆脱这种情况？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-01T02:13:20.497

将 ValidateRequest 设置为 false 是解决此错误的一种方法。您必须决定的是这些字符中的任何一个是否是您的表单的有效输入字符。如果是，那么您需要将其关闭并确保正确处理所有用户输入。

我似乎找不到危险字符的列表，所以如果有人知道一个，那么链接到它会很有价值。

可以在[这里](http://www.asp.net/learn/whitepapers/request-validation/)找到一些很好的信息。

作为一般规则，您应该始终对您放置在您网站上的任何数据进行 html 编码，因此关闭它不会造成任何伤害。但是，如果您不确定是否是，最好将其保持打开状态，并且不允许在您的表单中使用此数据。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-01T02:07:18.637

仅当您确定要自己验证它并且希望将任何人能想到的任何东西都发布到您的服务器时，才应该在页面指令中放置 validateRequest=false。

如果您输入的字符串是有效输入，您将需要禁用请求验证。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-01T02:08:34.377

> 是否建议在 Page 指令中设置 validateRequest=false 以摆脱这种情况？

如果您可以显式处理文本框输入的验证，为什么不呢？

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-04-01T02:07:14.037

这意味着您不能将包含 HTML 标记的值发布到服务器，出于安全原因，它是在 .net 框架的早期版本中添加的

如果您必须允许用户发布 html 标签，您可以将 validateRequest="false" 添加到页面指令

# java - 性能最便宜的挥发物的替代品

> ID：703794
> 
> 赞同：2
> 
> 时间：2009-04-01T02:05:40.077
> 
> 标签：java, multithreading, concurrency

我想实现取消线程的常用协作机制。但是，当我处于 JDK5 之前的环境中时，Java 内存模型仅在 JDK5 中得到修复。我明白，这意味着像 SCIP 所支持的那样做这样的事情是不正确的。

```
class Worker implements Runnable
{
    private volatile boolean _canceled;

    public void cancel() { _canceled = true; }

    public void run() {
        while( ! _canceled )
        {
            // do my Stuff
        }
    }
} 
```

我正在考虑使用 AtomicBoolean 来封装 _canceled 变量。还有其他选择吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-01T02:07:59.573

`AtomicBoolean`[在 JDK5 中也添加了，因此除非您使用backport](http://backport-jsr166.sourceforge.net/)，否则这是不可用的。但是，是的，来自 backport 的 atomic 类可能是最佳选择，因为您知道它是由精通 JVM 虚拟机规范的每个版本的工作人员编写的。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-01T04:18:52.300

如果我正确理解了[常见问题解答](http://www.cs.umd.edu/users/pugh/java/memoryModel/jsr-133-faq.html#volatile)，这在允许对易失性字段重新排序的旧内存模型中不是问题。在他们的示例中，旧模型将允许“x”基于 JVM 为 0 或 42。经验法则是，重新排序应该始终是编译器/cpu 的性能提升，但对程序员来说是不可见的。旧模型打破了这一规则。

您的示例不应该遇到可见性问题并且可以工作

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-01T02:25:57.627

Doug Lea的[util.concurrent 包](http://gee.cs.oswego.edu/dl/classes/EDU/oswego/cs/dl/util/concurrent/intro.html)（java.util.concurrent 的前身）可能会有所帮助。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-01T09:32:21.033

IIRC，非常老的 Sun JRE 根本没有实现 volatile。明智地尝试，旧的 JMM 允许以这种方式使用 volatiles（大约是它们可以使用的唯一方式）。我了解 Sun 1.4 JRE 实际上实现了 1.5 JMM，任何差异都被认为是错误。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-01T02:07:42.317

我认为 AtomicBoolean 在 Java 5 之前也不可用。在私有布尔字段上同步怎么样？

# c# - 实体框架 - 将组合框绑定到规范化表字段

> ID：703805
> 
> 赞同：1
> 
> 时间：2009-04-01T02:08:50.910
> 
> 标签：c#, wpf, database, entity-framework, data-binding

我目前正在尝试将实体绑定到表单，但是我希望将 DataConfidenceLevel（见下文）绑定到以 ConfidenceDescription 作为显示成员的组合框。填充组合框的正确方法是什么？

（我目前正在使用 WPF，但可以接受 Winforms 答案）

谢谢

[实体设计器 http://img19.imageshack.us/img19/374/entity.png](http://img19.imageshack.us/img19/374/entity.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-01T03:38:38.560

您想将集合绑定到控件并具有相关实体 - 即 DataConfidenceLevel 类型的导航属性 DataConfidenceLevel - 作为显示成员？

这通常通过重写 ToString() 来实现，非常简单，

```
public partial class DataConfidenceLevel
{
   public override String ToString()
   {
      return this.ConfidenceDescription;
   }
} 
```

而不是将 DisplayMember 设置为要绑定的实体的 DataConfidenceLevel 属性。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-02T00:51:59.497

答案比我预期的要简单。

```
 comboBox.DataBindings.Add(new Binding("SelectedItem", this.dataBindingSource, "DataConfidenceLevel", true));
    comboBox.DataSource = db.DataConfidenceLevel;
    comboBox.DisplayMember = "ConfidenceDescription";
    comboBox.ValueMember = "ConfidenceLevelID"; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-01T02:44:17.503

我写了两篇关于处理这种情况的方法的博客文章——它适用于 ASP.net，但它可能会对您有所帮助。

这是帖子，[第一个](http://internationalized.spaces.live.com/blog/cns!43F3A7682D1564E4!1192.entry)更多的是对问题的介绍，[第二个条目](http://internationalized.spaces.live.com/blog/cns!43F3A7682D1564E4!1216.entry)显示了如何将它们固定在一起。

我不确定这是否符合“正确方法”的要求，但这肯定是一种方法:) 如果这对您有帮助，我很高兴收到回复！

编辑：阅读 danbruc 的答案后，您当然可以按照他的建议覆盖 Navigation 属性上的 ToString（只读），但这只是部分答案。

除非您的 LINQ 查询包含“包含”语句，否则这将不起作用，例如

```
var listOfThings = (from t in db.Thingy
                    .Include("DataConfidenceLevel")
                    select t).ToList(); 
```

省略 .Include() 意味着没有任何内容会绑定到该列。

# svn - 如何以更强大的方式使用版本控制？

> ID：703818
> 
> 赞同：4
> 
> 时间：2009-04-01T02:16:52.297
> 
> 标签：svn, git, version-control

在我的大多数项目中，个人或团体，我发现我只使用版本控制来简单地提取最新更改并发布我自己的代码。

但是，我知道版本控制还有很多其他功能，包括分支和其他我不使用的强大功能。

有人可以就如何以更强大的方式使用版本控制给我建议吗？

我主要谈论的版本控制系统是 SVN 和 Git。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-04-01T02:19:46.843

你可以从这里开始： [红皮书](http://svnbook.red-bean.com/)

你为你发布的东西创建标签；您为正在处理的事情创建分支，并且可能是错误/不稳定的。你的后备箱应该尽可能稳定（伙计，这听起来不对）。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-04-01T02:25:16.643

掌握合并和分支。我发现大多数版本控制使用令人惊奇的是，90% 的使用它的人不知道如何使用它来支持两个不同的分支，同时他们在签入更改时将其用作线性版本控制系统. 版本控制的真正威力在于它允许您同时有效地维护系统的两个独立版本，这在您必须同时支持生产版本和开发软件的新版本时派上用场. 学习如何使用像 Subclipse（和 Maven 的 Eclipse 插件）这样的工具或像 Git 这样的工具来合并分支之间的更改是我希望更多使用版本控制的人知道如何去做的事情。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-04-01T02:22:30.660

[git ready](http://www.gitready.com/)有很多使用 Git 的技巧，从初学者到高级。另请参阅[Git Wiki](http://git.or.cz/gitwiki/GitDocumentation)，了解有关如何使用 Git 的各种文档和提示。

这里有一些值得学习且不明显的东西。

重新排列一系列提交：

```
git rebase -i <base-rev> 
```

找出哪个提交破坏了你的单元测试，在这种情况下，`make check`; 您可以使用任何其他命令来检查某些特定的构建失败或错误并在失败时以非零状态退出：

```
git bisect start HEAD <known good revision>; git bisect run make check 
```

显示有关远程及其分支的有用信息：

```
git remote show <remote> 
```

在 Git 中分支比什么都容易：

```
git checkout -b branch-name master # create a new branch, starting it at master
git pull origin master # merge in changes from the master branch on origin server
git checkout master; git merge branch-name # merge changes you made on the branch
git branch -d branch-name # once you're done with the branch 
```

如果您想在处理分支时与其他人共享分支，或者将其推送到服务器进行备份：

```
git checkout branch-name # assuming it's already been created
git push origin branch-name # push the branch to the origin server 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-04-01T03:05:31.290

考虑将您的构建系统置于修订控制中。您的工具链本身可能会随着时间的推移而发生偏差，并且配置开发人员机器变得非常简单，而不是一种折磨。我还发现版本控制测试或构建工件会迫使您进入自动化学科。考虑存储软件其他工件（需求、里程碑等）的方法。如果您有外部工具，请竭尽全力打击重复。考虑在构建系统中记录构建环境，让猴子可以轻松地引导提取、构建、打包、广告、测试、打包、签名和部署。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-04-01T02:19:33.833

我发现版本控制对于隔离和修复困难的错误非常有用。具体来说，通过更新到以前的版本，可以查明问题是什么**时候**引入的，进而查明两个版本之间做了哪些改动，轻松隔离问题。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-04-15T23:51:50.100

阅读：http: [//oreilly.com/catalog/practicalperforce/chapter/ch07.pdf](http://oreilly.com/catalog/practicalperforce/chapter/ch07.pdf)

# java - 可以部署在 Tomcat、JBoss、Geronimo 等中的 Java SOAP Server 等等等等

> ID：703821
> 
> 赞同：5
> 
> 时间：2009-04-01T02:18:51.840
> 
> 标签：java, soap

我希望创建一个 Java SOAP 服务器，我可以在 Tomcat、JBoss、Geronimo 或 XYZ 等中部署它等等。

最重要的是，它应该具有尽可能少的依赖关系。由于许可/打包/可重用性问题，我试图避免标准 java 发行版中包含的库之外的库。

任何人都可以提供我应该开始寻找的链接或一些示例代码吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-01T09:31:44.127

Java 1.6 引入了使用标准 JDK 创建标准 SOAP Web 服务的可能性。

网上有很多例子，例如[http://weblogs.java.net/blog/2006/12/12/webservices-jdk-6](http://weblogs.java.net/blog/2006/12/12/webservices-jdk-6)

像 NetBeans 这样的 IDE 也会自动调用必要的工具 (apt)，这使得它很容易上手。

但是，我没有研究这在所有可用容器中的效果如何。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-01T02:31:21.293

Apache Axis2 ( [http://ws.apache.org/axis2/](http://ws.apache.org/axis2/) ) 应该提供您正在寻找的东西，或者如果您想要更轻量级的 JAX-WS ( [https://jax-ws.dev.java.net/](https://jax-ws.dev.java.net/) ) .

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-01T03:00:16.967

哇。

[http://www.w3.org/TR/soap/](http://www.w3.org/TR/soap/)

标准来了。您将在这个项目上花费*大量*时间。您还需要查看 HTTP 和 XML 规范来构建这些组件。

忽略 XFire 和 Axis2 是一个非常非常昂贵的选择......

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-01T07:56:24.917

我最近为此使用了 Metro 1.4（一个开源 glassfish 组件），它实现了 Web 服务的标准方法。

将 jar 放入 Java 5 Web 容器中，使用标准 @tags 注释您的类和方法，然后让 Metro 完成其余工作。

我对 Jetty 容器的性能非常满意。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-01T23:31:21.737

如果您使用 Spring Web 服务模块，则不需要 Axis 或 XFire。如果您已经在使用 Spring，我认为这是一个不错的选择。

# c# - 是否可以相信 Page_Unload 将始终运行并且是 Dispose() 代码的好地方？

> ID：703836
> 
> 赞同：6
> 
> 时间：2009-04-01T02:23:10.067
> 
> 标签：c#, .net, asp.net, dispose

我熟悉 try{}finally{} 模式、using(){} 模式作为确保调用 Dispose() 的方法，但对于 ASP.NET 页面，Dispose 中创建的对象是否同样安全Page_Unload 事件的页面范围？改写 Page 的 Dispose() 方法是否有意义？

我不确定是什么代码引发了 Page_Unload 事件或 Page Dispose() 方法，所以我不知道它会运行的保证是什么。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-04-01T03:01:32.860

unload 事件在处置之前的控件生命周期中引发。由于页面本身是一个控件，因此也会为它引发 unload 事件。您添加到页面的每个控件都将成为页面生命周期的一部分。因此，如果您有一个需要进行一些清理的控件，则该控件本身应该自己处理任何可能的清理。只要控件已添加到页面并正确遵循封装原则，您就不必担心这一点。

[文档](http://msdn.microsoft.com/en-us/library/ms178472.aspx)说您甚至应该使用它“对特定控件进行最终清理，例如关闭特定于控件的数据库连接”。我的建议是避免卸载事件。如果可能的话，尽早而不是稍后做任何清理代码，所以如果可以的话，请使用“使用”。在某种程度上，这就像使用“全局”变量而不是局部变量之间的选择，后者更可取。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-01T02:57:11.887

我认为这是安全的。Page_Unload 应该是在页面生命周期中执行清理的地方。请参阅[http://msdn.microsoft.com/en-us/library/ms178472.aspx](http://msdn.microsoft.com/en-us/library/ms178472.aspx)，其中说：

> 此事件发生在每个控件，然后是页面。在控件中，使用此事件对特定控件进行最终清理，例如关闭特定于控件的数据库连接。
> 
> 对于页面本身，**使用此事件来完成最后的清理工作，例如关闭打开的文件和数据库连接，或者完成日志记录或其他特定于请求的任务。**

# ruby-on-rails - 我应该将文件保存为文本还是导入数据库？

> ID：703842
> 
> 赞同：1
> 
> 时间：2009-04-01T02:26:27.420
> 
> 标签：ruby-on-rails, sqlite

我正在构建一个字谜生成器，它是一个编码练习，并使用一个长约 633,000 行的单词列表（每行一个单词）。我最初只是用 Ruby 编写的程序，我想修改它以在线部署它。

我的托管服务支持 Ruby on Rails 作为唯一基于 Ruby 的解决方案。我想在自己的机器上托管，并使用更小的框架，但我现在不想处理安全问题。

我只将 RoR 用于数据库驱动 (CRUD) 应用程序。但是，我从来没有以这种方式填充过 sqlite 数据库，所以这是一个由两部分组成的问题：

1）我应该将其导入数据库吗？如果是这样，最好的方法是什么？如果是这样的话，我想坚持使用 sqlite 来保持简单。

2）“平面文件”更好吗？我不会做任何创建或更新，只是检查单词列表。

谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-01T02:51:32.230

把它留在记忆里怎么样？存储这么多单词只需要几兆字节的 RAM，否则您会经常访问该文件，因此无论如何它可能会被缓存。将单词列表保存在内存中的优点是您可以将其组织为最适合您需要的任何数据结构（我正在考虑尝试）。如果您不能节省那么多内存，那么使用数据库可能对您有利，这样您就可以有效地仅加载任何给定查询所需的单词列表部分 - 当然，在这种情况下您想要创建一些索引列（至少一个），以便您可以利用 SQL 的索引功能。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-01T02:49:19.473

假设您正在做的是查找列表中是否存在单词，我会说带有索引列的 SQLite 可能比线性扫描单词列表更快。现在，如果您当前的方法对您的目的来说足够快，那么我认为没有理由将其移植到数据库中；就您而言，这只是一个额外的头痛，没有任何收获。如果您发现搜索时间成为一种负担，那么将其转储到索引数据库中将是一个好主意。

您可以使用以下架构创建表：

```
CREATE TABLE words (
       word text primary key
);

CREATE INDEX word_idx ON words(word); 
```

并通过以下方式导入您的数据：

```
sqlite words.db < schema.sql
while read word 
do 
   sqlite3 words.db "INSERT INTO words values('$word');"
done < words.txt 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-01T03:19:45.093

由于上面列出的原因，我会跳过数据库。内存中的简单散列将在数据库中执行大约一样快的查找。

即使数据库的查找速度更快一些，您仍然在浪费时间让数据库解析查询并创建查找计划，然后组装结果并将它们发送回您的程序。另外，您可以为自己节省依赖。

如果您打算将程序的其他部分移动到持久存储中，那就去做吧。但是哈希图应该足以供您使用。

# html - 有没有办法根据里面的内容来定位一个元素？

> ID：703843
> 
> 赞同：2
> 
> 时间：2009-04-01T02:26:29.217
> 
> 标签：html, css, css-selectors

在我的页面上，我有自定义样式的超链接，我也有很多超链接的图像。我不希望这些自定义样式出现在仅包含图像的超链接上。除了为每个超链接图像添加单独的类（即“nostyle”）之外，我可以以某种方式从我的样式表中定位超链接图像吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-01T02:39:37.797

您不能直接在 CSS 中选择匹配项的父项。js 有一些变通方法（例如搜索元素并将类属性应用到它们的父节点），但看起来有点笨拙。你宁愿重构你的文档结构来找到一个更巧妙的解决方案。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-01T02:29:52.547

当然，只需使用

```
a img {
  // your style here...
} 
```

如果您只想定位某一类链接中的图像，请使用

```
a.yourclass img {} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-01T02:50:36.287

根据听起来你要求的答案是否定的。您不能仅在 CSS 中向后退。

正如 Theo.T 提到的，您可以使用 JS 解决方法。

一个想法是做一个元素 innerHTML 检查以查看元素内部是否有 <img> 标签，如果有，则更改 element.className = "nostyle"; 但这是一个混乱的解决方法，当您在 JS（和跨浏览器）中获得正确的语法时，您可能已经重构了您的文档。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-01T03:15:31.593

不需要锚类。

```
a[rel="image"] img {}
```

# apache-flex - 将 RSL 与 Adob e AIR 一起使用

> ID：703846
> 
> 赞同：1
> 
> 时间：2009-04-01T02:27:58.057
> 
> 标签：apache-flex, memory, actionscript, memory-management, air

有谁知道 RSL 究竟是如何与 AIR 一起工作的？我有一个终端服务器，它运行一个非常大的 AIR 应用程序的多个实例，不幸的是，它在启动时有 100M RAM，在使用一段时间后有 200。这显然不是真正可行的，我认为如果 RSL 缓存在机器上，它们可能是一种解决方案。但是我在这方面找不到太多东西，我真的很想知道是否有人有。

其次，有什么好的方法可以减少 AIR 应用程序的初始内存大小？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-01T03:20:07.183

RSL 只会帮助下载大小而不是 RAM 使用。为了使用更少的内存，我推荐 AMF 而不是 XML，因为 XML 解析有一些开销。

希望有帮助。

-詹姆士

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-01T10:58:52.607

尝试使用 flexbuilder 附带的分析器。它将帮助您查看正在消耗内存的内容，然后您可以相应地更改代码。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-12T20:16:56.893

经过大量研究，我发现答案很简单：将 RSL 与 Flex 结合使用可以让您在浏览器中缓存大多数核心 flex 库，从而大大降低最初的下载速度。然而，对于 AIR，情况并非如此。它对你基本上没有好处。

就像詹姆斯说的那样，它只会帮助提高 DL 速度。

就记忆而言......查看格兰特斯金纳的文章 - 他帮助了我很多。谢谢！

# sql - SQL Server：清理@param 以防止注入攻击

> ID：703856
> 
> 赞同：7
> 
> 时间：2009-04-01T02:35:32.563
> 
> 标签：sql, sql-server, sql-injection

为了争论，假设我**必须**创建一个包含 SQL 查询的局部变量，该查询具有 INSERT：

```
 DECLARE @insert NVARCHAR(MAX)
 SELECT @insert = 'INSERT INTO [dbo].[' + @table + '] VALUES...
 EXEC (@insert) 
```

此 INSERT 还将包含一个列值：

```
 DECLARE @insert NVARCHAR(MAX)
 SELECT @insert = 
  'INSERT INTO [dbo].[' + @table + '] VALUES (N''' + @message + ''')'
 EXEC (@insert) 
```

现在，我显然担心注入攻击，并希望确保@message 的值不会使@insert 的值成为恶意或格式错误的对EXEC 的查询。

这给我们带来了我的问题：在@message 中转义 ' 字符是否足够？@message 中是否还有其他可能出现的字符可以逃脱？

例子：

```
 DECLARE @insert NVARCHAR(MAX)
 SELECT @message = REPLACE(@message,'''','''''')
 SELECT @insert = 
  'INSERT INTO [dbo].[' + @table + '] VALUES (N''' + @message + ''')'
 EXEC (@insert) 
```

（当我说“**必须**”时，这是因为我的查询在一个存储过程中，并且这个存储过程接受@table，这是要插入的目标表。我对讨论我的体系结构或为什么表不感兴趣到 INSERT into 是通过过程参数“动态”指定的。请不要对此发表评论，*除非除了 EXEC() 查询之外还有另一种方法来指定要插入的表，然后将表名作为过程参数接收*。）

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-04-01T02:40:24.347

使用`sp_executesql`和内置的`quotename()`. 这篇文章，[动态 SQL 的诅咒和祝福](http://www.sommarskog.se/dynamic_sql.html)，几乎是权威的参考。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-01T02:42:39.363

[我建议使用sp_executesql 存储过程](http://msdn.microsoft.com/en-us/library/ms188001.aspx)，而不是调用 EXEC(@somesql) 。具体来说，这允许您传递参数，系统将检查参数是否有效。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-01T03:05:40.057

您可以先使用常规 T-SQL 查询架构信息，并确保首先存在表名。这样，如果它是格式错误的 SQL，它就不会作为代码执行。它只是一个 VARCHAR 表名。

```
DECLARE @Table AS VARCHAR(MAX)
DECLARE @Exists AS BIT

SET @Table = 'Vicious malformed dynamic SQL'

SELECT  @Exists = COUNT(TABLE_NAME) 
FROM    INFORMATION_SCHEMA.TABLES 
WHERE   TABLE_NAME = @Table

IF (@Exists = 1)
    BEGIN
    PRINT 'Table exists'
    -- Execute dynamic SQL.
    END
ELSE
    PRINT 'Invalid table' 
```

（或者干脆使用 IF EXISTS (SELECT ....) ）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-01T16:07:44.237

显然，根据我的测试，即使在 2008 年，quotename() 也有 128 个长度的限制，因为它需要一个 SQL 标识符。该参考建议创建一个[quotestring()](http://www.sommarskog.se/dynamic_sql.html#quotestring%20)函数，它与以下内容相同：

```
REPLACE(@variable,'''','''''') 
```

因此，我建议答案是从上面的 REPLACE() 中创建一个函数，如下所示：

```
CREATE FUNCTION quotestring(@string nvarchar(MAX)) 
RETURNS nvarchar(MAX) AS
BEGIN
    RETURN(REPLACE(@string,'''',''''''))
END 
```

...除非我误解了什么。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-09-17T01:04:31.643

在编写动态 SQL 时，您会希望尽可能多地进行参数化，并且仅在绝对必要时才使用字符转义。你不能参数化@table，但你可以参数化@message。

```
DECLARE @insert NVARCHAR(MAX)
set @insert = 'INSERT INTO [dbo].' + quotename(@table) + ' values(@message)'
exec sys.sp_executesql @insert, N'@message nvarchar(max)', @message = @inMessage; 
```

攻击者可以通过多种方式利用动态 SQL，包括缓冲区长度攻击和使用 unicode 等效字符。我曾经遇到过一个示例，其中转义单引号字符仍然存在一个漏洞，其中可以传入引号字符的 unicode 等效项之一。软件堆栈的一部分正在进行 unicode 到 ascii 的转换，因此可以注入在他们逃脱后重新引用。哎哟。

# asp.net - DOCTYPE 解析和 ASP.Net 的问题

> ID：703858
> 
> 赞同：2
> 
> 时间：2009-04-01T02:37:16.537
> 
> 标签：asp.net, .net, xml, doctype

在[上一个问题](https://stackoverflow.com/questions/682795/working-with-xml-document-type-definitions-in-net)中，我提到了一些使用第 3 方 DLL 的工作，该 DLL 的接口使用一系列使用 DTD 定义的 XML 输入。到目前为止一切都很顺利，但是在解决生成的输入值中的文档类型声明时，我仍然遇到这个烦人的问题。

我想不通的是，决定在哪里查找引用的 DTD 文件的决定因素是什么。如果我有一个如下所示的声明：

```
<!DOCTYPE ElementName SYSTEM "ElementName.dtd"> 
```

我最初的想法是应用程序的当前执行路径是解析器查找 DTD 的地方。但是，当我尝试在 ASP.Net 中使用[XML 控件](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.xml.aspx)时，我得到的错误让我感到困惑......

> 找不到文件'c:\Program Files\Microsoft Visual Studio 9.0\Common7\IDE\ElementName.dtd'

为什么要在那里寻找 DTD？

有没有任何 XML 专家可以帮助我解决这个问题。我真的无法控制从这个 DLL 返回的 XML，所以我应该怎么做。有没有办法向操作系统“注册”一个 DTD？像 GAC 一样？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-01T11:56:37.957

不幸的是，生成 XML 的库使用 dtd 的相对 url 而不是完全限定的。因此，XmlControl 的 XmlDocument 使用[XmlResolver](http://msdn.microsoft.com/en-us/library/system.xml.xmlresolver.aspx)类将相对路径转换为完全限定的路径。默认情况下，它使用[XmlUrlResolver](http://msdn.microsoft.com/en-us/library/system.xml.xmlurlresolver.aspx)（即具体的 XmlResolver）。这将尝试将 dtd 的位置映射到它认为与 Xml 文档相关的位置。问题是，XmlDocument 在哪里？可能在与任何东西都不相关的内存中，并且 XmlUrlResolver 正在使用进程位置，而不是在您的情况下是位于“c:\Program Files\Microsoft Visual Studio 9.0\Common7\IDE\devenv.exe”的 Visual Studio。

所以，你可以做什么？好吧，我想您必须创建自己的 XmlResolver 继承自 XmlUrlResolver 并覆盖 ResolveUri 方法并执行适当的操作。完成后，您将必须：

1.  创建一个 XmlReaderSettings 类并将 XmlReolver 属性设置为您刚刚创建的类。
2.  使用传入您的文档和 XmlSettings 对象的 XmlReader.Create() 创建一个 XmlReader。
3.  创建一个 XmlDocument 并调用 Load，最后传入 XmlReader。
4.  将 XmlControl 的 XmlDocument 属性设置为 XmlDocument。

坦率地说，这有点痛苦，所以如果我在哪里，我会使用 string.Replace 从文档中删除 DTD 声明，然后再将其处理为 XML。

如果你真的很勇敢，你可以创建一个直接从 XmlResolver 继承的解析器。完成后，您可以覆盖[GetEntity](http://msdn.microsoft.com/en-us/library/system.xml.xmlurlresolver.getentity.aspx)方法，然后您可以从任何您喜欢的地方获取 dtd 文档。我曾经写过一个从作为资源文件嵌入的文件中获取 dtds，但不幸的是，我不再有代码了 :-(

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-28T13:59:16.283

如果您实际上并不关心根据其 DTD 验证每个文档，则可以在 XmlTextReader（或 XmlDocument）上将 XmlResolver 属性设置为 null 以完全忽略 DTD。

# flash - Adobe AIR 从 Flash 是一场大灾难？

> ID：703860
> 
> 赞同：-1
> 
> 时间：2009-04-01T02:39:11.290
> 
> 标签：flash, air, publish

有没有人有在 Flash CS3 中构建 AIR 应用程序的经验？我继承了一个正在从 Flash 中构建的 AIR 应用程序，并且正在努力构建。

首先，AIR 应用程序不能通过 Flash IDE 运行。没有文档类，当我在第一帧上放置跟踪语句时，它实际上从未跟踪（是的，发布设置中的省略跟踪操作未勾选）。我看到一个应用程序窗口（带有 AIR 图标），但它实际上并没有做任何事情。就好像代码永远不会执行一样。

其次，我不确定 AIR 包中应该包含什么。当前，当我创建 AIR 文件（包括我的 .svn 文件夹）时，它会尝试打包我的所有源代码。

在 Flash 显示的对话框（在“控制”菜单下）或单独的描述符文件中使用相对路径似乎是不可能的。从 Flash 的角度来看，相对路径到底是什么，Fla 放在哪里或 swf 放在哪里？（目前我的项目中有不同的文件夹）。

最后，有没有人知道任何关于 AIR 内部工作原理的好教程？不是谷歌似乎不断想出的营销或“你好，世界”曼波巨无霸……

谢谢，卢克

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2011-07-15T12:05:19.510

虽然可以使用 Flash Builder 编译在 Flash Professional 中创建的项目，反之亦然，但如果项目具有任何显着的复杂性，那么这样做就变得非常重要。

如果创建项目的人使用的是 Flash Builder，我希望在 Flash Builder 中打开项目（甚至是试用版）将允许您启动项目并运行和编译以进行测试。

如果它是在 Flash Builder 中创建的，并且您尝试在 Flash Professional 中打开它，则涉及许多注意事项。您可能必须设置文档类，并确保构建设置中包含各种包/框架。此外，在某些情况下，Flash Professional 编译器的运行方式可能与 Flash Builder 编译器不同（它们并不相同），从而导致您的应用程序出现奇怪的行为（假设它已编译）。

这不是你的错——Adobe 在他们的几个产品中混用了“Flash”这个词，所以根本不清楚什么是什么，虽然兼容性可能通过事物的名称来表示（嘿，AIR 就是 AIR，对吗？ ）， 错误的。

最好的办法是在 Flash Builder 中打开原始项目并从那里获取它。祝你好运！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-02T08:29:28.573

我还想在学习 AIR / FLEX 方面有所帮助，因为我们正在考虑为使用这些技术的应用程序开发客户端。

我发现 Adob​​e 提供的以下[视频教程](http://www.adobe.com/devnet/flex/videotraining/)非常有用。如果您曾在任何其他现代框架中工作过，它们很容易理解并且在某些地方可能会非常熟悉（尤其是 Apple 的 Cocoa 会让人想起......）。

希望您发现它们和我一样有帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-01T02:48:16.120

您使用 Flash IDE 有什么特别的原因吗？我建议使用 Flex Builder IDE（试用 30 天）或用于 Eclipse 的 Flex 插件来开发 AIR 应用程序。

[http://www.adobe.com/support/documentation/en/air/](http://www.adobe.com/support/documentation/en/air/)

是我在学习 AIR 时遇到的最好的免费资源。祝你好运！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-01T17:14:57.583

要使 AIR 应用程序正常工作，您需要大量的脚手架——比如应用程序描述符、证书、应用程序签名等。Flex builder 具有可以处理这些的内置工具。您可能可以通过大量额外的黑客攻击对 CS3 做同样的事情，但为什么要麻烦呢？

[在此处](http://www.adobe.com/cfusion/entitlement/index.cfm?e=flex3email)获取 Flex builder 的试用版（我建议先获取 eclipse 插件并安装 eclipse）。60 天后，当试用期到期时，您应该非常清楚哪些工具适合您。

# .net - 如何使用 HttpWebRequest 调用接受 byte[] 参数的 Web 服务操作？

> ID：703869
> 
> 赞同：5
> 
> 时间：2009-04-01T02:47:18.853
> 
> 标签：.net, web-services, httpwebrequest, asmx

我正在尝试从 C# 调用 [webmethod]。我可以调用接受“字符串”参数的简单网络方法。但是我有一个接受“byte []”参数的网络方法。当我尝试调用它时，我遇到了“500 内部服务器错误”。这是我正在做的一些例子。

可以说我的方法是这样的

```
[WebMethod]
public string TestMethod(string a)
{
    return a;
} 
```

我在C#中使用HttpRequest这样称呼它

```
 HttpWebRequest req = (HttpWebRequest)WebRequest.Create(url);
            req.Credentials = CredentialCache.DefaultCredentials;
            req.Method = "POST";
            // Set the content type of the data being posted.
            req.ContentType = "application/x-www-form-urlencoded";

            string inputData = "sample webservice";
            string postData = "a=" + inputData;
            ASCIIEncoding encoding = new ASCIIEncoding();
            byte[] byte1 = encoding.GetBytes(postData);

            using (HttpWebResponse res = (HttpWebResponse)req.GetResponse())
            {
                StreamReader sr = new StreamReader(res.GetResponseStream());
                string txtOutput = sr.ReadToEnd();
                Console.WriteLine(sr.ReadToEnd());
            } 
```

这工作得很好。现在我有另一个这样定义的 webmethod

```
[WebMethod]
public string UploadFile(byte[] data) 
```

我试着这样称呼它

```
 ASCIIEncoding encoding = new ASCIIEncoding();
            string postData = "data=abc";
            byte[] sendBytes = encoding.GetBytes(postData);
            req.ContentLength = sendBytes.Length;
            Stream newStream = req.GetRequestStream();
            newStream.Write(sendBytes, 0, sendBytes.Length); 
```

但这给了我一个 500 内部错误:(

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-16T19:16:27.037

有可能，我自己做过

首先是 Header 设置，如果你的 webservice 可以通过 web 执行并发送参数，就可以获得这个设置。我使用 Chrome 的开发者工具。简单的方法是查看 Web 服务的描述（即 http://myweb.com/WS/MyWS.asmx?op=Validation）

```
WebRequest request = WebRequest.Create(http://myweb.com/WS/MyWS.asmx?op=Validation);
request.Method = "POST";
((HttpWebRequest)request).UserAgent = ".NET Framework Example Client";
request.ContentType = "text/xml; charset=utf-8";
((HttpWebRequest)request).Referer = "http://myweb.com/WS/MyWS.asmx?op=Validation";
((HttpWebRequest)request).Accept = "text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8";
((HttpWebRequest)request).Host= "myweb.com";
 request.Headers.Add("SOAPAction","http://myweb.com/WS/Validation"); 
```

然后是请求部分

```
string message = "a=2";
string envelope = "<?xml version=\"1.0\" encoding=\"utf-8\"?><soap:Envelope    xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:soap=\"http://schemas.xmlsoap.org/soap/envelope/\">"+
        "<soap:Body><Validation xmlns=\"http://myweb.com/WS\"><data>@Data</data></Validation></soap:Body></soap:Envelope>";
string SOAPmessage = envelope.Replace("@Data",   System.Web.HttpUtility.HtmlEncode(message));
// The message must be converted to bytes, so it can be sent by the request
byte[] data = Encoding.UTF8.GetBytes(SOAPmessage);
request.ContentLength = data.Length;
request.Timeout = 20000;
Stream dataStream = request.GetRequestStream();
dataStream.Write(data, 0, data.Length);
dataStream.Close();
WebResponse response = request.GetResponse();
Stream inputStream = response.GetResponseStream(); 
```

现在您可以从响应中获取传入流

请记住根据来自 web 服务的页面详细信息给出的描述（即 http://myweb.com/WS/MyWS.asmx?op=Validation）调整 SOAP 信封和要发送的参数。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-01T04:16:23.757

您正在使用 ASP.NET Web 服务管道的 HTTP POST/HTTP GET 功能，而不是发送实际的 Web 服务调用。这是一种允许您测试简单 Web 服务的机制，但它并不是真正为在生产应用程序中使用而设计的。事实上，如果您导航到 Web 服务 URL，您会发现它甚至无法显示该类型参数的测试输入表单。或许可以找到一种诱骗它工作的方法，但老实说，您应该按照预期的方式使用它并生成一个 Web 服务代理。

在 Visual Studio 中，右键单击包含客户端代码的项目，然后选择添加服务或 Web 引用。然后输入 Web 服务的 URL，它将生成一个代理。如果您使用的是 WCF，它将看起来像这样：

```
// ServiceNameClient is just a sample name, the actual name of your client will vary.
string data = "abc";
byte[] dataAsBytes = Encoding.UTF8.GetBytes(data);
ServiceNameClient client = new ServiceNameClient();
client.UploadFile(dataAsBytes); 
```

希望这可以帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-01T02:59:46.780

您可能需要对二进制数据进行 base64 编码。

但是 500 错误是查看 Windows 事件日志并查看服务器端发生的情况的线索。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-02-27T08:10:36.203

字符串 postData = "数据 = abc";

猜你应该将字节数组作为数组传递，而不是 base64 字符串。例如：

字符串 postData = "data=97&data=98&data=99"; //abc的字节数组是[97,98,99]

请参考[https://www.codeproject.com/Tips/457410/Xml-WebService-Array-Parameters](https://www.codeproject.com/Tips/457410/Xml-WebService-Array-Parameters)

# string - MIPS 组装中的 Pig Latin

> ID：703870
> 
> 赞同：0
> 
> 时间：2009-04-01T02:47:19.167
> 
> 标签：string, mips

在我的 MIP 汇编编程课程中，我的任务是编写一个将字符串转换为简化的拉丁语的程序。

简化的猪拉丁语假设字符串中的所有单词至少有 2 个字符长，并且每个单词的第一个字母都移到末尾，然后是“ay”。另外，假设没有任何类型的标点符号。

因此，“stackoverflow 很棒”变成了“tackoverfloway siay reatgay”。

我已经对这个程序进行了尝试，我几乎完成了。它工作正常，除了由于某种原因我每次在最后一个单词的中间都有一个换行符。

例如：

> tackoverflowsay siay reat
> gay

代替：

> tackoverflowsay siay reatgay

我已经尝试在程序的最后一个退出部分确定是什么导致了这个换行符，但我没有看到它。我有一个过早的空终止字符串吗？如果我这样做，我看不到它。

这是我的代码：

```
####################################################
#  Text Segment
####################################################
        .text
        .globl main
main:
        la $t0, char
        la $t1, buffer
        lb $t3, space

        la $a0, prompt
        li $v0, 4
        syscall

        la $a0, buffer
        li $a1, 200
        li $v0, 8
        syscall

        lb $t2, ($t1)           # Load first char
        addi $t1, $t1, 1

loop:
        lb $t4, ($t1)           # Load next character into $t4

        addi $t1, $t1, 1
        beqz $t4, exit          # Reached end of string, exit?  
        beq $t3, $t4, loop2     # If $t4 = " " char, second loop

        move $a0, $t4           # else, lets keep printing chars
        li $v0, 11
        syscall

        j loop

loop2:
        move $a0, $t2
        li $v0, 11
        syscall

        la $a0, aystr
        li $v0, 4
        syscall

        lb $t2, ($t1)   
        addi $t1, $t1, 1    

        j loop
exit:

        move $a0, $t2
        li $v0, 11
        syscall

        la $a0, aystr
        li $v0, 4
        syscall

        li $v0, 10
        syscall         # Cya...

####################################################
#  Data Segment
####################################################

        .data
prompt: .asciiz "Enter Phrase: "
result: .asciiz "Pig Latin: "
space:  .ascii " "
aystr:  .asciiz "ay "
char:   .byte 1
buffer: .byte 200 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-01T03:19:13.427

您几乎可以肯定有以下形式的字符串：

```
stackoverflow is great\n 
```

`\n`换行符在哪里。这将转化为：

```
tackoverflowsay siahy reat\ngay 
```

如果您简单地将单词的结尾检测为空格或空终止符。

我不会给你代码（因为这是家庭作业），但在我看来，最简单的解决方案是让另一个循环处理整个字符串，用`"\n"`空格替换所有字符。

这将在您的拉丁化循环之前完成。

# c# - QuickGraph Dijkstra 示例

> ID：703871
> 
> 赞同：5
> 
> 时间：2009-04-01T02:48:02.020
> 
> 标签：c#, algorithm, shortest-path, dijkstra, quickgraph

我有一个`AdjacencyGraph<string, Edge<string>>`我想运行`AlgorithmExtensions.ShortestPathsDijkstra`的，但 QuickGraph 文档不是最好的。

有人有我可以效仿的例子吗？

我在谷歌上找到的所有东西都使用了观察者，这`AlgorithmExtension`并不需要。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-04-01T03:02:27.320

示例取自[quickgraph.codeplex.com](http://quickgraph.codeplex.com/Thread/View.aspx?ThreadId=12668)在 QuickGraph 上运行 Dijkstra 算法。

```
AdjacencyGraph<string, Edge<string>> graph = new AdjacencyGraph<string, Edge<string>>(true);

// Add some vertices to the graph
graph.AddVertex("A");
graph.AddVertex("B");
graph.AddVertex("C");
graph.AddVertex("D");
graph.AddVertex("E");
graph.AddVertex("F");
graph.AddVertex("G");
graph.AddVertex("H");
graph.AddVertex("I");
graph.AddVertex("J");

// Create the edges
Edge<string> a_b = new Edge<string>("A", "B");
Edge<string> a_d = new Edge<string>("A", "D");
Edge<string> b_a = new Edge<string>("B", "A");
Edge<string> b_c = new Edge<string>("B", "C");
Edge<string> b_e = new Edge<string>("B", "E");
Edge<string> c_b = new Edge<string>("C", "B");
Edge<string> c_f = new Edge<string>("C", "F");
Edge<string> c_j = new Edge<string>("C", "J");
Edge<string> d_e = new Edge<string>("D", "E");
Edge<string> d_g = new Edge<string>("D", "G");
Edge<string> e_d = new Edge<string>("E", "D");
Edge<string> e_f = new Edge<string>("E", "F");
Edge<string> e_h = new Edge<string>("E", "H");
Edge<string> f_i = new Edge<string>("F", "I");
Edge<string> f_j = new Edge<string>("F", "J");
Edge<string> g_d = new Edge<string>("G", "D");
Edge<string> g_h = new Edge<string>("G", "H");
Edge<string> h_g = new Edge<string>("H", "G");
Edge<string> h_i = new Edge<string>("H", "I");
Edge<string> i_f = new Edge<string>("I", "F");
Edge<string> i_j = new Edge<string>("I", "J");
Edge<string> i_h = new Edge<string>("I", "H");
Edge<string> j_f = new Edge<string>("J", "F");

// Add the edges
graph.AddEdge(a_b);
graph.AddEdge(a_d);
graph.AddEdge(b_a);
graph.AddEdge(b_c);
graph.AddEdge(b_e);
graph.AddEdge(c_b);
graph.AddEdge(c_f);
graph.AddEdge(c_j);
graph.AddEdge(d_e);
graph.AddEdge(d_g);
graph.AddEdge(e_d);
graph.AddEdge(e_f);
graph.AddEdge(e_h);
graph.AddEdge(f_i);
graph.AddEdge(f_j);
graph.AddEdge(g_d);
graph.AddEdge(g_h);
graph.AddEdge(h_g);
graph.AddEdge(h_i);
graph.AddEdge(i_f);
graph.AddEdge(i_h);
graph.AddEdge(i_j);
graph.AddEdge(j_f);

// Define some weights to the edges
Dictionary<Edge<string>, double> edgeCost = new Dictionary<Edge<string>, double>(graph.EdgeCount);
edgeCost.Add(a_b, 4);
edgeCost.Add(a_d, 1);
edgeCost.Add(b_a, 74);
edgeCost.Add(b_c, 2);
edgeCost.Add(b_e, 12);
edgeCost.Add(c_b, 12);
edgeCost.Add(c_f, 74);
edgeCost.Add(c_j, 12);
edgeCost.Add(d_e, 32);
edgeCost.Add(d_g, 22);
edgeCost.Add(e_d, 66);
edgeCost.Add(e_f, 76);
edgeCost.Add(e_h, 33);
edgeCost.Add(f_i, 11);
edgeCost.Add(f_j, 21);
edgeCost.Add(g_d, 12);
edgeCost.Add(g_h, 10);
edgeCost.Add(h_g, 2);
edgeCost.Add(h_i, 72);
edgeCost.Add(i_f, 31);
edgeCost.Add(i_h, 18);
edgeCost.Add(i_j, 7);
edgeCost.Add(j_f, 8);

// We want to use Dijkstra on this graph
DijkstraShortestPathAlgorithm<string, Edge<string>> dijkstra = new DijkstraShortestPathAlgorithm<string, Edge<string>>(graph, edgeCost);

// attach a distance observer to give us the shortest path distances
VertexDistanceRecorderObserver<string, Edge<string>> distObserver = new VertexDistanceRecorderObserver<string, Edge<string>>();
distObserver.Attach(dijkstra);

// Attach a Vertex Predecessor Recorder Observer to give us the paths
VertexPredecessorRecorderObserver<string, Edge<string>> predecessorObserver = new VertexPredecessorRecorderObserver<string, Edge<string>>();
predecessorObserver.Attach(dijkstra);

// Run the algorithm with A set to be the source
dijkstra.Compute("A");

foreach (KeyValuePair<string, int> kvp in distObserver.Distances)
Console.WriteLine("Distance from root to node {0} is {1}", kvp.Key, kvp.Value);

foreach(KeyValuePair<string, Edge<string>> kvp in predecessorObserver.VertexPredecessors)
Console.WriteLine("If you want to get to {0} you have to enter through the in edge {1}", kvp.Key, kvp.Value );

// Remember to detach the observers
distObserver.Detach(dijkstra);
predecessorObserver.Detach(dijkstra); 
```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-04-26T07:35:39.483

我已经更新了文档，但简而言之，您需要一个图表、一个边权重图（作为代表）和一个根顶点。AlgorithmExtensions 方法返回一个“TryFunc”，您可以查询它以获取最短路径。

```
using QuickGraph;
using QuickGraph.Algorithms;

IVertexAndEdgeListGraph<TVertex, TEdge> graph = ...;
Func<TEdge, double> edgeCost = e => 1; // constant cost
TVertex root = ...;

// compute shortest paths
TryFunc<TVertex, TEdge> tryGetPaths = graph.ShortestPathDijkstra(edgeCost, root);

// query path for given vertices
TVertex target = ...;
IEnumerable<TEdge> path;
if (tryGetPaths(target, out path))
    foreach(var edge in path)
        Console.WriteLine(edge); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-04-29T00:54:51.887

这是另一个示例（它在 LinqPad 中运行——确保按 F4 并添加对 QuickGraph dll 的引用）

```
void Main()
{
    const int nNodes = 10;
    var graphAsDict = RandomGraphWithSelfEdgeAsDict(nNodes).Dump("graphAsDict: Random graph as Dict");

    var velg1 = graphAsDict.ToVertexAndEdgeListGraph(
        kv => Array.ConvertAll<int, SEquatableEdge<int>>(
            kv.Value.ToArray(),
            v => new SEquatableEdge<int>(kv.Key, v))).Dump("velg1: Vertex and Edge-List Graph");

    Func<SEquatableEdge<int>, double> edgeCost = (edge => 1.0D);

    int start = new Random(Guid.NewGuid().GetHashCode()).Next(1, nNodes + 1).Dump("start point");
    int end = new Random(Guid.NewGuid().GetHashCode()).Next(1, nNodes + 1).Dump("end point");

    var algo = new DijkstraShortestPathAlgorithm<int, SEquatableEdge<int>>(velg1, edgeCost);
    var predecessors = new VertexPredecessorRecorderObserver<int, SEquatableEdge<int>>();
    using (predecessors.Attach(algo))
    {
        algo.Compute(start);
        IEnumerable<SEquatableEdge<int>> path;
        if (predecessors.TryGetPath(end, out path).Dump("TryGetPath"))
            path.Dump("path");
    }
}

public static int[] RandomPermutation(Random ran, int n)
{
    var r = Enumerable.Range(1, n).ToArray();
    for (var i = 0; i < n - 1; i++)
    {
        var k = ran.Next(i + 1, n);
        var t = r[i];
        r[i] = r[k];
        r[k] = t;
    }
    return r;
}

public static Dictionary<int, IEnumerable<int>> 
RandomGraphWithSelfEdgeAsDict(int nNodes)
{
    var ran = new Random(Guid.NewGuid().GetHashCode());
    var result = new Dictionary<int, IEnumerable<int>>();

    for (var j = 1; j <= nNodes; j++)
    {
        var k = ran.Next(0, nNodes);
        var cs = RandomPermutation(ran, nNodes);
        result[j] = cs.Take(k);
    }

    return result;
} 
```

# c# - 如何在.NET中按比例调整任何类型的图像？

> ID：703873
> 
> 赞同：14
> 
> 时间：2009-04-01T02:48:19.007
> 
> 标签：c#, .net, graphics, image-manipulation

是否可以以独立于图像类型（bmp、jpg、png 等）的方式按比例调整图像大小？

我有这段代码并且知道缺少某些东西（但不知道是什么）：

```
public bool ResizeImage(string fileName, string imgFileName,
    ImageFormat format, int width, int height)
{
    try
    {
        using (Image img = Image.FromFile(fileName))
        {
            Image thumbNail = new Bitmap(width, height, img.PixelFormat);
            Graphics g = Graphics.FromImage(thumbNail);
            g.CompositingQuality = CompositingQuality.HighQuality;
            g.SmoothingMode = SmoothingMode.HighQuality;
            g.InterpolationMode = InterpolationMode.HighQualityBicubic;
            Rectangle rect = new Rectangle(0, 0, width, height);
            g.DrawImage(img, rect);
            thumbNail.Save(imgFileName, format);
        }
        return true;
    }
    catch (Exception)
    {
        return false;
    }
} 
```

如果不可能，如何调整 jpeg 图像的比例？

我知道使用[这种方法](https://stackoverflow.com/questions/115462/proportional-image-resize)，但不知道把它放在哪里（！）。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-04-01T02:53:01.337

首先，您没有获取图像的当前高度和宽度。为了按比例调整大小，您需要获取图像的当前高度/宽度并据此调整大小。

从那里，找到最大的属性并在此基础上按比例调整大小。

例如，假设当前图像为 800 x 600，您想在 400 x 400 空间内按比例调整大小。抓住最大的比例（800）并找到它与新尺寸的比例。800 -> 400 = .5 现在取该比率并乘以第二维 (600 * .5 = 300)。

您的新尺寸是 400 x 300。这是一个 PHP 示例（抱歉....不过你会明白的）

```
$thumb_width = 400;
$thumb_height = 400;

$orig_w=imagesx($src_img); 
$orig_h=imagesy($src_img);      

if ($orig_w>$orig_h){//find the greater proportion
    $ratio=$thumb_width/$orig_w; 
    $thumb_height=$orig_h*$ratio;
}else{
    $ratio=$thumb_height/$orig_h; 
    $thumb_width=$orig_w*$ratio;
} 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-04-01T02:54:50.660

我认为您的代码很好，但是在我看来，将宽度和高度作为参数是您出错的地方。为什么这个方法的调用者必须决定他们想要多大的宽度和高度？我建议将其更改为百分比：

```
public bool ResizeImage(string fileName, string imgFileName,
    ImageFormat format, int percent)
{
    try
    {
        using (Image img = Image.FromFile(fileName))
        {
            int width = img.Width * (percent * .01);
            int height = img.Height * (percent * .01);
            Image thumbNail = new Bitmap(width, height, img.PixelFormat);
            Graphics g = Graphics.FromImage(thumbNail);
            g.CompositingQuality = CompositingQuality.HighQuality;
            g.SmoothingMode = SmoothingMode.HighQuality;
            g.InterpolationMode = InterpolationMode.HighQualityBicubic;
            Rectangle rect = new Rectangle(0, 0, width, height);
            g.DrawImage(img, rect);
            thumbNail.Save(imgFileName, format);
        }
        return true;
    }
    catch (Exception)
    {
        return false;
    }
} 
```

# delphi - Delphi在注册类型库时冻结

> ID：703874
> 
> 赞同：0
> 
> 时间：2009-04-01T02:49:04.513
> 
> 标签：delphi, com, types

我使用 Delphi 及其类型库创建了一些 AUTOObjects。它编译没有错误，但是当我尝试注册它时，Delphi 冻结了，并且没有恢复正常。我曾尝试在 Delphi 7 和 2006 中注册它，但都遇到了同样的问题。我试图在 Delphi 的演示中注册一个简单的库，我正在排除错误的注册表文件，

我的代码可能有问题，但我不知道在哪里，因为它编译得很好，而且我没有在 RegisterDLL 中放入任何代码。

以前有人遇到过同样的问题吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-01T03:07:21.053

您没有提供足够的信息让任何人帮助您。

阅读此[http://support.microsoft.com/kb/555375](http://support.microsoft.com/kb/555375)，了解如何提出技术问题，它是为 Microsoft 新闻组编写的，但在这里有相同的应用程序。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-01T09:44:13.457

注册 COM dll 时也会执行单元的初始化部分。尝试使用tregsvr 或regsvr32 在Delphi 之外注册，看看是否可以。您还可以将这些工具作为启动项目并在注册 dll 时对其进行调试。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-08T05:32:14.433

大家加油。我解决了这个问题。问题是在一个单元中有一个初始化代码创建线程，现在我已经删除它，库注册正常。:)

# ruby-on-rails - 在 Ruby on Rails 中将两个模型链接在一起

> ID：703876
> 
> 赞同：2
> 
> 时间：2009-04-01T02:49:47.677
> 
> 标签：ruby-on-rails, ruby

我整天都被困在这上面。我有一个像下面这样的设置。我正在尝试使用 group_memberships 关联来定义朋友。

```
class User < ActiveRecord::Base
  has_many :group_memberships
  has_many :groups, :through => :group_memberships
  has_many :friends # what goes here? <<
end

class GroupMembership < ActiveRecord::Base
  belongs_to :user
  belongs_to :role
  belongs_to :group
end

class Role < ActiveRecord::Base
  has_many :group_memberships
end

class Group < ActiveRecord::Base
  has_many :group_memberships
  has_many :users, :through > :group_memberships
end 
```

我想在不为朋友创建连接表的情况下执行此操作，除非不这样做是完全疯狂的。

group_membership 表包含将一个用户链接到一个组的 user_id 和 group_id。

我想得到

```
@user.friends 
```

使用 group_id 返回具有共同 group_memberships 的用户。

```
has_many :friends, :through => :group_memberships, :source => :group 
```

我尝试过的任何方法都不起作用，但我会将其归结为我对上述代码的完全误解。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-01T06:13:22.663

不幸的是，Rails 不允许你将 has_many 嵌套超过 2 层。`friends`暂时忘记命名它（让我们`users`改为调用它），理论上这就是你想要的：

```
has_many :group_memberships
has_many :groups, :through => :group_memberships
has_many :users, :through => groups 
```

除了这不起作用。如果你尝试一下，你会看到[这个](http://github.com/rails/rails/blob/v2.3.2/activerecord/lib/active_record/associations.rb#L33)不太有用的错误消息，它来自[这段](http://github.com/rails/rails/blob/v2.3.2/activerecord/lib/active_record/reflection.rb#L300-302)代码，特别是`source_reflection.options[:through].nil?`. 也就是说，`through`不允许有`through`自己。

相反，您可能想要执行以下操作：

## 解决方案 1

```
class User < ActiveRecord::Base
  has_many :group_memberships
  has_many :groups, :through => :group_memberships

  def friends
    groups.with_users.map(&:users).flatten.uniq.reject{|u| u == self}
  end
end

class Group < ActiveRecord::Base
  has_many :group_memberships
  has_many :users, :through => :group_memberships

  named_scope :with_users, :include => :users
end 
```

## 解决方案 2

使用[`nested_has_many_through`](http://github.com/ianwhite/nested_has_many_through/tree/master)雷达提到的插件。看起来至少github 上的[一个分支](http://github.com/ianwhite/nested_has_many_through/network)已经更新，可以在最新的 Rails 上运行。

## 解决方案3（只是为了踢）

或者，只是为了好玩，你可以用一个大的 SQL 查询来做到这一点：

```
class User < ActiveRecord::Base
  has_many :group_memberships
  has_many :groups, :through => :group_memberships

  def friends
    sql = <<-SQL
      SELECT users.* FROM users, (
        SELECT DISTINCT gm2.user_id AS user_id
        FROM group_memberships gm, groups g, group_memberships gm2
        WHERE gm.user_id = ? AND g.id = gm.group_id AND gm2.group_id = g.id AND gm2.user_id != ?
      ) AS user_ids
      WHERE users.id = user_ids.user_id
    SQL
    User.find_by_sql([sql, id, id])
  end
end 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-01T06:34:09.883

使用[nested_has_many_through](http://github.com/ianwhite/nested_has_many_through/tree/master)插件。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-01T22:13:16.260

委托 :users, :to => 'group'

# java - 将查询重定向到谷歌并在 JSON 对象中获取结果时出现 UnknownHostException

> ID：703879
> 
> 赞同：0
> 
> 时间：2009-04-01T02:50:59.687
> 
> 标签：java, networking

```
Loading classifier from D:\PROJECT\classifiers\NERDemo\classifiers\ner-eng-ie.crf-3-all2008.ser.gz ... done [2.0 sec].
Original Query was riot in India.
Parsing Queries and expanding tokens from the Ontologies..
{locations=[India], events=[riot]}
Search query is null
Something went wrong...

java.net.UnknownHostException: ajax.googleapis.com
 at java.net.PlainSocketImpl.connect(Unknown Source)
 at java.net.SocksSocketImpl.connect(Unknown Source)
 at java.net.Socket.connect(Unknown Source)
 at java.net.Socket.connect(Unknown Source)
 at sun.net.NetworkClient.doConnect(Unknown Source)
 at sun.net.www.http.HttpClient.openServer(Unknown Source)
 at sun.net.www.http.HttpClient.openServer(Unknown Source)
 at sun.net.www.http.HttpClient.<init>(Unknown Source)
 at sun.net.www.http.HttpClient.New(Unknown Source)
 at sun.net.www.http.HttpClient.New(Unknown Source)
 at sun.net.www.protocol.http.HttpURLConnection.getNewHttpClient(Unknown Source)
 at sun.net.www.protocol.http.HttpURLConnection.plainConnect(Unknown Source)
 at sun.net.www.protocol.http.HttpURLConnection.connect(Unknown Source)
 at sun.net.www.protocol.http.HttpURLConnection.getInputStream(Unknown Source)
 at org.girs2.SearchHandler.makeQuery(SearchHandler.java:35)
 at org.girs2.GIRS.search(GIRS.java:37)
 at org.girs2.GIRS.main(GIRS.java:62)
Exception in thread "main" java.lang.NullPointerException
 at org.girs2.GIRS.search(GIRS.java:44)
 at org.girs2.GIRS.main(GIRS.java:62) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-01T02:57:38.937

看起来您可能已经或曾经遇到过 DNS 查找失败。这告诉你发生了什么：

```
java.net.UnknownHostException: ajax.googleapis.com 
```

如果您总是遇到此异常，并且您可以通过名称访问此主机，那么我不知道这可能是什么，但很可能这是临时 DNS 故障。

遇到这个异常应该怎么办？好吧，如果地址是你完全期望你应该能够到达的地址——比如这个——那么当你捕捉到异常时，你会睡一会儿（可能是 10 或 15 秒，甚至可能是 30 或 60秒，具体取决于您的应用程序的需要），然后重试。

如果经过多次重试——不要永远重试！- 您仍然无法访问该站点，然后记录合理的投诉或以其他方式抱怨您无法访问该站点并让您的应用程序退出。

当 DNS 失败时，您无能为力，只能放弃或等待重试。

# google-app-engine - 您在 Google App Engine 上进行开发有什么经验？

> ID：703892
> 
> 赞同：7
> 
> 时间：2009-04-01T02:55:12.827
> 
> 标签：google-app-engine, gql

对于了解 SQL 的人来说，GQL 是否容易学习？Django/Python 怎么样？App Engine 真的让扩展变得容易吗？是否有针对“GQL 注入”的内置保护？等等...

我很想听听使用应用引擎的不那么明显的起伏。

干杯!

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2010-04-27T04:00:13.517

我对谷歌应用引擎的体验非常棒，**1000 个**结果的限制已被**删除**，这里是发布说明的链接：

[应用引擎发行说明](http://googleappengine.blogspot.com/2010/02/app-engine-sdk-131-including-major.html)

> 不再有 1000 个结果限制 - 没错：随着游标的添加以及过去几个月中许多较小的 Datastore 稳定性和性能改进达到顶峰，我们现在有足够的信心完全取消最大结果限制。无论您是进行获取、迭代还是使用游标，结果的数量都没有限制。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-01T09:23:11.713

最明显和令人沮丧的问题是数据存储 api，如果您习惯 SQL，它看起来很棒并且经过深思熟虑并且易于使用，但是所有查询结果集的行数限制为 1000 行，并且您无法访问计数或超出此范围的偏移量。我遇到了更奇怪的问题，一旦模型超过 1000 行，实际上就无法添加或访问模型的数据。

请参阅[有关 1000 行限制的 Stack Overflow 讨论](https://stackoverflow.com/questions/264154/google-appengine-how-to-fetch-more-than-1000)

阿拉尔巴尔干[对这个问题和其他问题写了一个非常好的总结](http://aralbalkan.com/1504)

话虽如此，应用程序引擎是一个非常棒的工具，可供使用，我真的很喜欢使用它。它非常适合部署微型 Web 服务（例如：json api's）以在其他应用程序中使用。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-04-01T10:19:05.180

GQL 非常简单——它是 SQL 'SELECT' 语句的一个子集，仅此而已。不过，它只是底层 API 之上的一个便利层，所有的解析都是在 Python 中完成的。

相反，我建议使用 Query API，它是程序性的，不需要运行时解析，并且完全不可能出现“GQL 注入”漏洞（尽管它们在正确编写的 GQL 中是不可能的）。Query API 非常简单：在 Model 类上调用 .all()，或调用 db.Query(modelname)。Query 对象具有 .filter(field_and_operator, value)、.order(field_and_direction) 和 .ancestor(entity) 方法，以及 GQL 对象具有的所有功能 (.get()、.fetch()、.count())等）为了方便起见，每个 Query 方法都返回 Query 对象本身，因此您可以将它们链接起来：

> 结果 = MyModel.all().filter("foo =", 5).order("-bar").fetch(10)

相当于：

> 结果 = MyModel.gql("WHERE foo = 5 ORDER BY bar DESC LIMIT 10").fetch()

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-04-05T13:32:20.170

使用 AppEngine 时的一个主要缺点是 1k 查询限制，这已在评论中提到。不过，我没有看到的是有一个内置的可排序顺序，您可以使用它来解决这个问题。来自 appengine 食谱：

```
def deepFetch(queryGen,key=None,batchSize = 100):
  """ 批量生成实体的迭代器。

  参数：
    queryGen：应该返回一个 Query 对象
    key: 用于 .filter() for __key__
    batchSize：在一次数据存储调用中检索多少个实体

  取自 http://tinyurl.com/d887ll（AppEngine 食谱）。
  """

  从 google.appengine.ext 导入数据库

   # AppEngine 不会获取超过 1000 个结果
  batchSize = min(batchSize,1000)

  查询 = 无
  完成 = 假
  计数 = 0

  如果键：
    键 = db.Key(键)

  虽然没有完成：
    打印计数
    查询 = queryGen()
    如果键：
      query.filter("__key__ > ",key)
    结果 = query.fetch(batchSize)
    结果的结果：
      计数 += 1
      产出结果
    如果 batchSize > len（结果）：
      完成=真
    别的：
      键=结果[-1].key()

```

上面的代码与 Remote API（参见[这篇文章](http://code.google.com/appengine/articles/remote_api.html)）一起允许您检索任意数量的实体。

您可以像这样使用上面的代码：

```
def allMyModel():
  q = MyModel.all()

myModels = deepFetch(allMyModel)

```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-04-06T21:50:33.893

起初，我和其他从 SQL 过渡到 GQL 的人有同样的经历——不能进行 JOIN、计数超过 1000 行等有点奇怪。现在我已经使用它几个月了，我绝对喜欢应用引擎。我正在将我所有的旧项目移植到它上面。

我用它来托管几个高流量的 Web 应用程序（在高峰时间，其中一个获得 5 万次点击一分钟。）

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-01T17:15:19.207

Google App Engine 不使用实际的数据库，并且显然使用某种分布式哈希映射。这将有助于一些习惯 SQL 的人一开始不会看到的不同行为。因此，例如，在常规 SQL 中获取 COUNT 个项目预计会是一个快速操作，但对于 GQL，它只是不会以相同的方式工作。

这里还有一些问题：

[http://blog.burnayev.com/2008/04/gql-limitations.html](http://blog.burnayev.com/2008/04/gql-limitations.html)

以我个人的经验，这是一种调整，但学习曲线很好。

# javascript - Jquery - 获取第 x 个元素

> ID：703895
> 
> 赞同：1
> 
> 时间：2009-04-01T02:56:09.830
> 
> 标签：javascript, jquery, class, element, children

例如，我有一个带有 id 的 div（比如说“the_div”）。这个 div 包含一个无序列表，这个列表中有 5 个项目。

我如何将一个类添加到第三个列表项，而没有任何列表项附加一个类？

编辑：更好的是，我将如何将列表项文本更改为等于它的数字元素？

谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-01T03:08:20.580

或者...

```
$('#the_div ul li:eq(2)').addClass('className'); 
```

您可以将选择器组合在一起 - 如果您愿意:)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-01T03:00:42.970

对于您的第一个问题，您可以使用[`eq`](http://docs.jquery.com/Traversing/eq#index)基于 0 的 ：

```
$('ul li', '#thediv').eq(2).addClass('whatever'); // add class to 3rd item 
```

对于第二个问题，您可以使用[`each`](http://docs.jquery.com/Core/each#callback)遍历所有列表项。回调函数传递一个包含集合中当前元素索引的参数：

```
$('ul li', '#thediv').each(function(i) {
    $(this).text(i); // update each list item with its index, 0 based.
}); 
```

# javascript - AS3/JavaScript if 语句用逗号代替 & &

> ID：703896
> 
> 赞同：4
> 
> 时间：2009-04-01T02:56:20.487
> 
> 标签：javascript, actionscript-3, if-statement, boolean-logic, comma-operator

这在 ActionScript 3 和 JavaScript 中运行。为什么？我知道如何`&&`工作`||`，但有一份清单吗？这是特定于 AS3 的吗？这是其他语言的吗？我是一个嘴巴呼吸的 PHP/AS2 程序员。还是每个人都已经知道这一点，而我是一个无法正确阅读文档的工具？

AS3

```
if (true, true, true) {
     trace("true?")
}
//result - "true?" traced 
```

JavaScript

```
if (true, true, true) {
    alert("true?");
}
//result - "true?" alert message popped up

if (false, false, false) {
    alert("true?");
}
else {
    alert("false");
}
//result - "false" alert message popped up

if(true, false, false) {
    alert("true?");
}
else {
    alert("false");
}
//result - "false" alert message popped up 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-01T03:02:31.750

我认为 JavaScript 有一个像 C 一样的逗号运算符，它接受多个参数并返回最后一个。它通常用于要初始化多个值的 for 循环：

```
for(i=0, j=0; j< 10; j++) {  
...   
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-01T03:11:25.707

逗号用于计算序列中的表达式，同样的事情可以用 && 分隔的括号组来完成

# iphone - iPhone进入睡眠状态后我应该如何恢复TCP Socket连接

> ID：703901
> 
> 赞同：0
> 
> 时间：2009-04-01T02:57:40.903
> 
> 标签：iphone, sockets, sleep

..我的应用程序仍在运行！

有一个关于当它进入睡眠+醒来时会发生什么的[问题。](https://stackoverflow.com/questions/411436/what-happens-to-an-iphone-app-when-iphone-goes-into-stand-by-mode)我知道它在打电话：

```
- (void)AppDidBecomeActive:(NSNotification *)notification {

    if(jsocket){
        [jsocket release];
    }
    jsocket = [[johnsocket alloc] init];

    if(![jsocket connectViaSocket:(NSString*)ipaddress port:@"3660"]){
        //port 3660 is the XML port!!! good thing to know... 3663 is the binary protocol port.  yay!
        NSLog(@"error connecting from rooms page");
    }
} 
```

（注意：我正在使用[Asyncsocket.m](http://code.google.com/p/cocoaasyncsocket/)，这是一个很棒的类，可以帮助管理套接字等......这就是 jsocket 的一个实例。这是一个 tcp 客户端应用程序。）

实际上，我在这个函数中有一个警报弹出窗口，以确保它被调用.. 你看，iphone/itouch 在插入 USB 时不会进入睡眠状态，这使得调试变得更加困难。

所以我的问题是，我怎样才能让它不崩溃？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-01T07:51:32.617

除非您对服务器有非常完全的控制权，否则您无法在任意时间睡眠后简单地“唤醒”套接字。远程服务器可能会在超时后关闭连接-无论如何您都应该假设。

您将不得不重新启动连接并从头开始与服务器同步您的状态。

# python - 我如何使用 Python（精确到分钟）计算过去 30 天的时间？

> ID：703907
> 
> 赞同：62
> 
> 时间：2009-04-01T02:59:46.280
> 
> 标签：python, datetime, date, time

在 Python 中，我试图检索过去正好 30 天（30*24 小时）的日期/时间。目前，我只是在做：

```
>>> import datetime
>>> start_date = datetime.date.today() + datetime.timedelta(-30) 
```

它返回一个日期时间对象，但没有时间数据：

```
>>> start_date.year
2009
>>> start_date.hour
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
AttributeError: 'datetime.date' object has no attribute 'hour' 
```

* * *

## 回答 #1

> 赞同：129
> 
> 时间：2009-04-01T03:01:48.413

你想使用一个`datetime`对象而不仅仅是一个`date`对象：

```
start_date = datetime.datetime.now() - datetime.timedelta(30) 
```

`date`只存储一个日期和`time`一个时间。`datetime`是有时间的日期。

# graph - 按照幂律分布对多个变量进行标准化/缩放/归一化以用于线性组合的正确方法

> ID：703924
> 
> 赞同：7
> 
> 时间：2009-04-01T03:09:16.413
> 
> 标签：graph, normalize, linear-equation, rescale, power-law

我想将社交网络图中的一些节点指标组合成一个值，以便对节点进行排序：

`in_degree + betweenness_centrality = informal_power_index`

问题是`in_degree`和`betweenness_centrality`是在不同的尺度上测量的，比如 0-15 vs 0-35000 并遵循幂律分布（至少绝对不是正态分布）

有没有一种很好的方法来重新调整变量，以便在确定 时一个不会支配另一个`informal_power_index`？

三种明显的方法是：

*   标准化变量（减去`mean`和除以`stddev`）。这似乎会过度压缩分布，隐藏长尾值与峰值附近值之间的巨大差异。
*   `min(variable)`通过减去和除以将变量重新缩放到范围 [0,1] `max(variable)`。这似乎更接近于解决问题，因为它不会改变分布的形状，但也许它不会真正解决问题？特别是手段会有所不同。
*   通过将每个值除以 来均衡均值`mean(variable)`。这不会解决尺度上的差异，但也许平均值对于比较更重要？

还有其他想法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-01T03:30:15.803

您似乎对底层分布有很强的了解。自然的重新调整是用其概率替换每个变量。或者，如果您的模型不完整，请选择一个大致可以实现的转换。如果做不到这一点，这里有一个相关的方法：如果您有很多单变量数据可以用来构建（每个变量的）直方图，您可以根据它是否在 0-10% 百分位或10-20% 百分位 ...90-100% 百分位。通过构造，这些转换后的变量在 1,2,...,10 上具有均匀分布，您可以根据需要组合它们。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-01T03:18:51.400

您可以将每个转换为百分比，然后将每个应用于已知数量。然后使用新值的总和。

((1 - (in_degee / 15) * 2000) + ((1 - (betweenness_centrality / 35000) * 2000) = ?

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-28T18:44:56.257

非常有趣的问题。可以这样工作：

让我们假设我们想要将两个变量都缩放到 [-1,1] 的范围以介于 0-35000 范围内的 betweeness_centrality 为例

1.  按照变量范围的顺序选择一个较大的数字。例如，让我们选择 25,000
2.  在原始范围 [0-35000] 中创建 25,000 个 bin，在新范围 [-1,1] 中创建 25,000 个 bin
3.  对于每个数字 xi，找出它位于原始 bin 中的 bin#。让这成为毕
4.  在范围 [-1,1] 中找到 Bi 的范围。
5.  使用 [-1,1] 中 Bi 范围的最大值/最小值作为 xi 的缩放版本。

这保留了幂律分布，同时也将其缩小到 [-1,1] 并且不存在 (x-mean)/sd 所遇到的问题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-01T03:35:42.013

归一化为 [0,1] 将是我将 2 个值组合起来的简短回答建议，因为它将保持您提到的分布形状，并且应该解决组合值的问题。

如果 2 个变量的分布不同，这听起来很可能不会真正给你我认为的你的想法，这是对每个变量在其给定分布内的位置的综合衡量。您必须提出一个指标来确定给定分布中的值所在的位置，这可以通过多种方式完成，其中之一是确定与给定值的平均值相差多少标准偏差，然后您可以以某种方式结合这两个值来获得你的索引。（添加可能不再足够）

您必须弄清楚什么对您查看的数据集最有意义。标准偏差对您的应用程序可能毫无意义，但您需要查看与分布相关的统计度量并将它们组合起来，而不是组合绝对值，无论是否标准化。

# python - 在 OSX 上使用 pydev 和 Eclipse

> ID：703925
> 
> 赞同：11
> 
> 时间：2009-04-01T03:11:00.777
> 
> 标签：python, eclipse

我使用 python 解释器 /System/Library/Frameworks/Python.framework/Versions/2.5/Python 的此路径设置 PyDev，因为 /usr/bin 下的那个是别名，Eclipse 不会选择它。我现在可以运行我的 python 脚本，但不能将 shell 作为外部工具运行。我得到的信息是

变量引用空选择 ${resource_loc}

如果我使用 {container_loc} 也是一样

有什么想法吗 ？

苏尼特

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2010-05-06T23:53:40.480

我也安装了 Python.org 版本，这是必须的。

通过将解释器指向以下内容，我终于让 PyDev 在 Eclipse 中工作：

```
/Library/Frameworks/Python.framework/Versions/2.6/bin/python 
```

手动。如果您不手动进行（通过使用 Autoconfig），它似乎找不到正确的版本。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-19T18:21:03.237

常见的做法似乎是从 python.org 安装最新的 Python 2.5 并使用它而不是系统安装。当我开始使用 Mac OS X 时，我在这里和那里看到了推荐的内容。

它安装在`/Library`（而不是`/System/Library`）下，因此系统 Python 是完整的。Pydev 有 /Library/Frameworks/Python.framework/Versions/2.5/Resources/Python.app/Contents/MacOS/Python 作为其配置的 Python 解释器，一切都很好。

不能确定您的问题只是由于使用了系统的 Python 安装；无论如何这种方式我没有麻烦。此外，当您在开发环境中摆弄时（在站点包中安装东西，升级 Python），任何使用系统 Python 的东西肯定不会受到影响。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-22T03:48:38.367

我知道这是一个古老的帖子......但是，如果像我这样的新手得到更好的答案。

我只是使用“帮助”菜单中的“Eclipse Marketplace”并搜索关键字“python”或“PyDev”来获取 PyDev，并成功安装它。

并且，您应该将 PyDev 添加到右上角的扩展坞。

例如，我在笔记本电脑的 OSX 上的 Eclipse 是（版本：Indigo Service Release 2 Build id：20120216-1857）。

玩得开心，伙计们！:)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-01T04:14:21.530

我相信`${resource_loc}`或`${container_loc}`（没有任何论据）基于您在启动脚本时工作台中的当前选择。

那么在通过“外部工具”运行器选择该脚本时，您是否选择了正确的资源？
至少，在运行外部程序之一之前单击项目名称。
注意：它适用于[Navigator 或 Package Explorers 视图](http://dev.eclipse.org/newslists/news.eclipse.platform/msg50264.html)中的选择（尽管最新的可能在 PyDev 环境中不可用）

# ado.net - 如何在 ADO.NET 中“设置 ROWCOUNT 1000”？

> ID：703942
> 
> 赞同：0
> 
> 时间：2009-04-01T03:23:44.397
> 
> 标签：ado.net

我需要确保我的 ado.net 命令返回的行数不超过 1000-5000 行。有没有一种 ADO.NET 方法可以做到这一点，或者它只是一个 TSQL？

我正在调用一个存储过程，我不控制该存储过程中的源代码。因此，我希望有一种 ADO.NET 方法可以做到这一点。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-01T03:32:15.703

在 LINQ 之前，这通常总是在您的内联查询或存储过程中使用 top N 子句来完成。使用 LINQ 有一些很酷的函数，称为[“Take”和“Skip”](http://weblogs.asp.net/scottgu/archive/2007/09/07/linq-to-sql-part-9-using-a-custom-linq-expression-with-the-lt-asp-linqdatasource-gt-control.aspx)，它们提供了一个用于下载和/或跳过 N 行的构造。在底层，LINQ 计算出如何构建内联查询的详细信息，该查询会产生您想要的确切行数。

**[编辑]**

由于您正在调用存储过程，因此我建议您只在 select 语句中使用 TOP N 子句。这是阻力最小的路径，恕我直言，因为您已经拥有存储过程，所以保持前进最简单。

# c# - 在表单上放置 Telerik Winforms StackLayoutPanel

> ID：703947
> 
> 赞同：0
> 
> 时间：2009-04-01T03:28:22.513
> 
> 标签：c#, winforms, telerik

将 RadElement 实例放置在表单上的推荐方法是什么？

下面是来自我的表单构造函数的代码。我的目标是，如果尺寸足够小，表单会显示一个滚动条。#else 下的代码涉及标准的 Winforms 控件并且工作正常。#if Telerik 下的代码是等效的，但不起作用，因为我无法将 StackLayoutPanel 添加到表单的 Controls 集合中。如果有人可以回复下面的#if Telerik 代码的修改版本，将 StackLayoutPanel 放在表单上，​​这样当表单的大小小于面板时，表单的滚​​动条就会出现，这将是完美的。

```
 AutoScroll = true;
#if Telerik
    StackLayoutPanel panel = new StackLayoutPanel();
    panel.Orientation = Orientation.Vertical;
    panel.AutoSize = true;
    panel.Children.Add(new RadButtonElement());
    panel.Children.Add(new RadButtonElement());
    panel.Children.Add(new RadButtonElement());
    panel.Children.Add(new RadButtonElement());
    panel.Children.Add(new RadButtonElement());
    panel.Children.Add(new RadButtonElement());
    panel.Children.Add(new RadButtonElement());
    panel.Children.Add(new RadButtonElement());
    panel.Children.Add(new RadButtonElement());
    panel.Children.Add(new RadButtonElement());
    Controls.Add(panel);
#else
    FlowLayoutPanel panel = new FlowLayoutPanel();
    panel.FlowDirection = FlowDirection.TopDown;
    panel.AutoSize = true;
    panel.Controls.Add(new Button());
    panel.Controls.Add(new Button());
    panel.Controls.Add(new Button());
    panel.Controls.Add(new Button());
    panel.Controls.Add(new Button());
    panel.Controls.Add(new Button());
    panel.Controls.Add(new Button());
    panel.Controls.Add(new Button());
    panel.Controls.Add(new Button());
    panel.Controls.Add(new Button());
    Controls.Add(panel);
#endif 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-06T11:10:22.887

您可以先在面板控件中添加 StackLayoutPanel：

```
var panelControl = new RadPanel();
panelControl.PanelElement.Children.Add(panel);
Controls.Add(panelControl); 
```

# flowchart - 数据流程图和流程图有什么区别？

> ID：703948
> 
> 赞同：14
> 
> 时间：2009-04-01T03:28:41.187
> 
> 标签：flowchart

我想知道为什么我们使用数据流程图而不是流程图。

* * *

## 回答 #1

> 赞同：44
> 
> 时间：2009-04-01T03:36:39.827

流程图详细说明了要遵循的*过程。*DFD 详细说明了通过系统的*数据流。*

在流程图中，箭头表示元素之间的控制（而非数据）传输，元素是指令或决策（或 I/O 等）。

在 DFD 中，箭头实际上是元素之间的数据传输，这些元素本身就是系统的一部分。

[维基百科在这里](http://en.wikipedia.org/wiki/Data_Flow_Diagram)有一篇关于 DFD 的好文章。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-04-01T03:33:23.737

你应该使用任何你喜欢的东西。图表只是一个工具。使用最适合您和您的问题的任何工具。我通常只使用方框、箭头、曲线、圆圈和小简笔画，以及我认为能传达给观众观点的任何其他东西。简而言之，即使您使用标准图表标准也没关系。人们通常很擅长理解图片。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-04-01T03:41:39.283

数据流程图显示系统中不同实体和数据存储之间的数据流，而流程图显示执行任务所涉及的步骤。从某种意义上说，数据流程图提供了系统的一个非常高级的视图，而流程图是一个较低级别的视图（基本上显示了算法）。

无论您使用数据流程图还是流程图，都取决于弄清楚您要显示的是什么。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2014-01-13T14:12:32.507

数据流程图（DFD）和流程图（FC）的区别在于，数据流程图通常描述系统内的数据流，而流程图通常描述业务流程的详细逻辑。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2010-12-20T12:34:22.913

数据流和流程图在流程、流程和时间上有所不同。

1.  **流程**

    a.) 在 DFD 上，进程可以并行（同时）运行。

    b.) 在流程图中，流程一次执行一个。

* * *

2.  **流动**

    a.) DFD 显示通过系统**的数据流**

    b.) 流程图显示**控制流程（控制的**顺序和转移）

* * *

3.  **定时**

    a.) DFD 上的流程可以有显着不同的时间安排（每天、每周、按需）

    b.) 流程图上的流程是具有一致时序的单个程序的一部分

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-01T03:37:41.853

DFD 显示数据如何在系统中移动，流程图更接近系统执行的操作。

在经典[的泡茶示例](http://www.bbc.co.uk/schools/gcsebitesize/design/images/dt_mpm_sc8.gif)中，DFD 将显示水、茶、牛奶、糖的去向，而流程图则显示过程。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-04-01T04:28:53.947

其他答案已经涵盖了每件事的基础知识。在更高的层次上，流程图是一种设计级别的工具，而 DFD 更多的是分析。

DFD 有一些不错的功能。由于它们显示了数据流，因此以这种方式绘制时，有些事情会变得更加明显：一些数据仅由少数例程使用，一些例程只使用一些数据位，一些例程涉及所有内容。预先看到这一点有助于组织、重组和规划。

后续值得探索的是事件响应图，它基本上是一个 DFD，仅显示处理“事件”所需的过程和数据，这意味着外部触发的某些东西（客户付款等）。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2010-04-21T06:07:12.220

*数据流图*是功能关系，包括输入值和输出值以及存储的内部数据。

*流程图*是包含输入值和输出值的过程关系。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-04-01T03:47:34.467

流程图描述了程序（请参阅旧的 fortran 流程图 - 当然，谷歌上有一些浮动）。

数据流图决定了数据的流动，例如，子程序之间，或不同程序之间。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-04-07T06:33:35.993

尽管我对 DFD 图的经验有限，但我可以告诉您，DFD 向您展示了数据如何在各个模块之间移动（流动）。此外，DFD 可以划分为多个级别，即在初始级别中，您可以将系统（例如，租用电影的系统）视为一个整体（称为上下文级别）。该级别可以分解为另一个级别，其中包含活动（例如，租电影、归还电影）以及数据如何流入这些活动（可以是名称、天数等）。现在，您可以为每个活动创建一个子级别，详细说明这些活动的许多任务或场景。依此类推，依此类推。请记住，数据总是在级别之间传递。

现在至于流程图，请记住流程图描述了一种算法！

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-10-13T04:45:49.287

看看这个网站

[http://yourdon.com/strucanalysis/wiki/index.php?title=Chapter_9#The_Flow](http://yourdon.com/strucanalysis/wiki/index.php?title=Chapter_9#The_Flow)

它真的可以帮助你理解什么是 DFD

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-10-28T14:30:49.183

在上述答案之间，它已被解释，但我会尝试稍微扩展......

关于那杯茶的观点很好。流程图与任务的物理方面有关，因此用于表示**当前**的事物。这对于加深对情况/沟通/培训等的理解很有用。*如果他们采用了 ISO9000 标准，您可能会在工作场所遇到这些。*

数据流图与活动的逻辑方面有关，因此再次用一杯茶进行类比是一个很好的类比。如果您将数据流图与流程流结合使用，您的数据流将只关注有关流程的数据/信息流，而排除物理方面。如果您想知道为什么这会很有用，那么它是因为数据流图允许我们从“现状”的情况中走出来，并看到它可能/将要发生的事情。这两种建模方法在结构化分析和设计中很常见，并且通常被系统/业务分析师用作业务流程改进/重新设计的一部分。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-11-17T06:42:07.380

数据流图：表示系统功能分解的建模符号。

流程图：程序的逐步流程。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2015-11-30T14:59:14.633

数据流图 正式的结构化分析方法使用数据流图 (DFD) 来协助功能分解过程。我从 DeMarco [7] 那里学习了结构化分析技术，这些技术代表了当前的惯例。总而言之，DFD 由四个部分组成：

# asp.net - C# 如果我使用大的 ViewState 名称，性能会降低吗？

> ID：703956
> 
> 赞同：4
> 
> 时间：2009-04-01T03:32:38.447
> 
> 标签：asp.net, performance

我个人喜欢下面的选项一以提高可维护性，但我可以看到选项二让我有更好的表现。选项三可能完全是垃圾。

```
1\. ViewState["Calendar1.SelectionMode"] = Calendar1.SelectionMode;
2\. ViewState["CSM"] = Calendar1.SelectionMode;
3\. ViewState["Calendar1_SelectionMode"] = Calendar1.SelectionMode; 
```

我是否应用了考虑维护的旧学校习惯？只有当对象的数量很大时才重要吗？除了非常有效的哈希之外，我看不到内部结构。我已经阅读了加快页面加载速度的方法，但没有任何直接建议，因为这甚至是一个很小的因素。所有文献讨论的都是视图状态而不是数据库访问读取，使用紧凑类型，仅填充那些采用非默认值的值。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-01T03:40:52.703

选项二可能会给您更好的性能，但差异非常小。如果您遇到性能问题，这将是我寻找瓶颈的最后一个地方。您是否在页面上运行过任何类型的分析？那就是我开始寻找的地方。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-01T03:45:09.463

键名成为视图状态隐藏字段的一部分。粗略的例子：

```
protected void Page_Load(object sender, EventArgs e)
{
    // ViewState["a"] = 1;
    // <input type="hidden" name="__VIEWSTATE" id="__VIEWSTATE"   
    // value="/wEPDwUJNzgzNDMwNTMzDxYCHgFhAgFkZCdtAzza2+uuoGpYdGLBUdCkUGe7" />

    // ViewState["this is a very very very very long key"] = 1;
    // <input type="hidden" name="__VIEWSTATE" id="__VIEWSTATE" 
    // value="/wEPDwUJNzgzNDMwNTMzDxYCHiZ0aGlzIGlzIGEgdmVyeSB2ZXJ5IHZlcnkgdmVyeSBsb25nIGtleQIBZGSmj9cou408+XXRLxCLKcEoLngriA==" />

} 
```

底线：除非您存储大量密钥，否则可能不是问题。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-02T00:04:00.127

使用性能指标，答案实际上是肯定的，您放入 ViewState 的键的名称确实会影响加载特性。影响并不严重，而且似乎没有线性增长。

临界点似乎正好在 120 个物体处。下一个统计差异出现在大约 270 个物体上。请注意，我只改变了键的大小，并一直在 Calendar.SelectionMode 对象中移动。我正在选择帮助我得出上述结论的答案。

**基准决赛：**

效果是 PAGELOAD TIME USING BIG KEYS - PAGELOAD TIME USING SMALL KEYS

*   0000 - 0120 0.007 秒
*   0120 - 0270 2.254 秒
*   0270 - 1050 2.956 秒
*   1050 - 2000 4.873 秒

结果精确到 0.05 秒，置信区间为 99%。

# php - 文件夹安全？

> ID：703963
> 
> 赞同：0
> 
> 时间：2009-04-01T03:35:13.653
> 
> 标签：php, security, directory

我有一个名为 upload 的文件夹，里面装满了用户上传文件的文件夹。

有什么方法可以阻止人们通过在地址栏中输入文件夹名称和文件名来直接下载我的用户文件？

示例：用户 Jim 的文件夹存储在 HOST/uploads/jim

用户 Jim 的重要文件“myimportantfile.txt”存储在 HOST/uploads/jim/myimportantfile.txt

现在，如果任何人在地址栏中键入： www.HOST.com/uploads/jim/myimportantfile.txt ，他们将能够查看 Jim 的重要文件。

我怎样才能阻止这种情况发生？

制作目录时可以写某些属性吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-01T03:37:58.513

您不想将这些文件放在可通过 Web 访问的文件夹中。将它们移出 webroot。

完成此操作后，您可以拥有像 download.php 这样的文件，您可以将文件 ID 传递给该文件，然后它可以验证它实际上是 Jim 要求他的文件，然后才获取该文件并将其作为附件输出到浏览器. 这是最安全/最好的安全方式。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-01T03:40:17.620

我相信目录 +w-r+x 的文件权限将允许目录写入但不读取。在令人讨厌的 unix 术语中，这是 %chmod 733 **dirname**。*必须使用chown*和*chgroup*正确设置目录所有权。这适用于 Unix 环境。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-01T07:59:55.327

最简单的解决方案是在文件夹中添加一个 index.htm 文件。

任何访问者都会看到这个页面而不是文件索引。

该页面可以是空白的，甚至更好的是，通过重定向重定向到域主页。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-01T03:38:07.703

当然，您可以在 Linux 中使用基本的文件/目录权限。您还可以将整个树设置为被 apache 拒绝。

您正在运行什么平台/网络服务器软件？

好的，Linux：

如果目录的所有者是“joe”，组是“apache”，那么：

```
 chmod 750 joe 
```

这将赋予目录“joe”权限，允许所有者 (joe) 完全访问、组 (apache) 写入访问权限（以及进入目录的能力），而没有其他权限。

这是一个 FTP 投递箱吗？

现在的所有权/团体是什么样的？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-01T03:40:45.340

您可以使用`.htaccess`文件要求输入用户名和密码，使每个文件夹成为受保护的文件夹。

但我认为最好的方法是将上传文件夹移到 webroot 之外，使其不能直接访问，然后创建一个脚本（PHP、ASP 等），在验证用户身份后提供请求的文件。

# sql - 选择不同的

> ID：703977
> 
> 赞同：2
> 
> 时间：2009-04-01T03:42:34.617
> 
> 标签：sql, sql-server, tsql, ssis

我正在开发一个 SSIS 包，我将数据从 CSV 文件导入到 SQL 表中。

我关心的唯一字段是用户名。此用户名必须是***唯一的***。我不在乎名字或姓氏是否相同。

在包中，我将文件中的数据导入到临时 SQL 表中。然后我使用 SELECT DISTINCT 来选择唯一的用户名。然后插入到目标表中。

问题是：当我从 tempUsers 中选择不同的用户名、名字和姓氏时。

它返回：

*   JSmith, 约翰, 史密斯
*   JSmith，乔，聪明
*   MBopp，玛丽，Boppins

但我希望它返回：

*   JSmith, 约翰, 史密斯
*   MBopp，玛丽，Boppins

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-01T03:49:35.460

`SELECT DISTINCT`将为您指定的每一列选择所有不同的行，因此这不是您要查找的内容。

如果您的 SQL 风格支持它，请尝试`GROUP BY`使用`FIRST()`，如下所示。它将返回每个用户名的第一条记录。

```
SELECT Username, FIRST(Firstname), FIRST(Lastname)
FROM tempUsers
GROUP BY Username 
```

如果没有，您必须使用行 ID 和子选择来做这件事：

```
SELECT Username, FIRST(Firstname), FIRST(Lastname)
FROM tempUsers
WHERE RowID IN (SELECT MIN(RowID)
                FROM tempUsers
                GROUP BY Username) 
```

** 您不应将 MIN 与 Firstname 和 Lastname 一起使用，因为您不能保证它们来自同一行：

 ~~~~```
SELECT Username, MIN(Firstname), MIN(Lastname)
FROM tempUsers
GROUP BY Username 
```~~  ~~* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-01T03:58:02.287

对于 Oracle，您可以使用以下查询：

```
select * from tempusers where rowid in (
select min(rowid) from tempusers group by username); 
```

# c++ - 从 Objective-C 移植到 C++ 的最佳方式是什么？

> ID：703979
> 
> 赞同：6
> 
> 时间：2009-04-01T03:44:22.553
> 
> 标签：c++, objective-c

我没有任何 Objective-C 经验，但有很强的 C++ 背景。是否有自动化工具/脚本，或者在最坏的情况下，一些手动方法使用对用 Objective-C 编写到 C++ 的端口代码的一些极好的参考？有哪些困难？

编辑：我被告知代码使用 Objective-C 相当简单。这是一个 iPhone 应用程序，可能不会以操作系统级 UI 的方式使用太多。C++ 版本适用于不能选择 GNUStep 的非 Apple 平台，因此不能选择 Objective-C++。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-12-01T10:39:13.283

我解决了同样的问题。并有一些解决方案：

*   微软现在提供了自己的 Objective C“桥”，尽管它只适用于 UWP 应用程序。

    [https://github.com/Microsoft/WinObjC](https://github.com/Microsoft/WinObjC)

*   2007 年，我尝试在 Visual Studio 中支持 Objective-C，并编写了自己的 ObjC 运行时，但我没有更多时间为它编写解析器。如果你有，你可以:)

    [http://code.google.com/p/qobjc/](http://code.google.com/p/qobjc/)

*   我用 C++ 编写了 Foundation Framework 的基本功能。在这种情况下，您需要手动移植；您的代码将在 C++ 上，但它会像在 Objective-C 上一样。这个库在 iPhone 上工作。

    [http://code.google.com/p/dcocoa/](http://code.google.com/p/dcocoa/)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-01T04:28:44.477

我知道没有自动化工具。Objective-C 的动态特性很难转换为 C++，所以除了琐碎的 Objective-C 代码之外，所有的代码都需要相当多的脑力劳动。你愿意留在 OS X 上（或者如果你是少数在 OS X 之外的 OS 上使用 Objective-C 的人之一，还是保持对 GNUStep 的依赖）？如果是这样，最简单的方法是使用[Objective-C++](http://developer.apple.com/documentation/Cocoa/Conceptual/ObjectiveC/Articles/ocCPlusPlus.html#//apple_ref/doc/uid/TP30001163-CH10-SW1)在 Objective-C 和 C++ 代码之间搭建一座桥梁。Objective-C++ 是 Apple 对 Objective-C 和 GCC 编译器的扩展，它允许您混合 Objective-C 和 C++ 代码。因此，您可以创建调用或引用（但不继承自）C++ 对象的 Objective-C 对象，并且可以从 C++ 代码中将 Objective-C 消息发送到 Objective-C 实例。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-01T04:25:37.493

Objective-C 只是一个预处理器（和一个运行时库）。在移植所有库时，您会发现比最终用户代码更多的问题。翻译时不吃东西的行为会很有趣。

在使用 Objective-C 框架一段时间后，您可能会开始在所有 c++ 代码中看到糟糕的设计。

# ms-access - 将列的默认值设置为 Access 2007 中的登录用户名

> ID：703980
> 
> 赞同：1
> 
> 时间：2009-04-01T03:44:26.860
> 
> 标签：ms-access, ms-access-2007

我有一个使用 Access 2003 开发的 Access 文件，并且正在尝试使用 Access 2007 来处理它。

一些表有一个“changedby”列，其默认值为

```
=Environ("username") 
```

这是触发错误

*验证表达式中的未知函数“Environ”或 market.changedby 上的默认值*

Access 2007 中是否有可用的替换函数，可以用作列的默认值中的公式？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-01T04:39:56.117

看看这个[线程](http://www.access-programmers.co.uk/forums/showthread.php?t=115442)。

它指出您必须将环境调用包装在一个[函数](http://www.access-programmers.co.uk/forums/showthread.php?t=76173)中才能绕过访问“沙箱”

另一张海报说，您也可以将 macor security 设置为低来修复它。

# javascript - Jquery每个循环都不起作用

> ID：703983
> 
> 赞同：1
> 
> 时间：2009-04-01T03:45:22.490
> 
> 标签：javascript, jquery, ajax, bind

我是 jquery 的新手，但我试图在我的项目中使用它。我正在尝试遍历#rate_box 内的所有链接并向它们添加点击事件。此点击事件会将一些数据发布到外部 php 脚本，然后它应该取消绑定所有链接上的点击事件（因此人们不能快速连续两次评分。）然后它应该将从 php 脚本收到的数据放入一个名为#status 的跨度标签。

但是我的代码甚至没有执行 alert("Index: "+i). 我是否正确绑定它？

```
<script type="text/javascript">
    $(document).ready(function(){
        $('#rate_box a').each(function(i) {
            $(this).click(function() {
                alert("Index: "+i);
                $.post("../includes/process/rating.php", {id: "<?php $game_id ?>", type: "game", rating: i+1},
                function(data) {
                    $('#rate_box a').each(function(i) {
                        $(this).unbind('click');
                    }
                    $('#status').html(data).fadeIn("normal");
                });
            });
        });
    });
</script> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-01T03:47:27.663

您不需要遍历每个单独绑定处理程序的链接，您可以这样做：

```
// bind click handler to all <a> tags inside #rate_box
$('#rate_box a').click(function() {

}); 
```

解除绑定也是如此：

```
$('#rate_box a').unbind('click'); 
```

就您的代码而言，它可能没有执行，因为您在解除绑定元素标签时没有关闭内部每个，所以它是无效的 javascript：

```
$('#rate_box a').each(function(i) {
    $(this).unbind('click');
} // <- missing closing ");" 
```

You should really use a tool like Firebug or Firebug Lite to debug your javascript, although something like the above should just give you a Javascript error in most browsers.

**EDIT** If you want to find the index of the current link when it is clicked upon, you do this:

```
var links = $('#rate_box a');
$(links).click(function() {
    // this is to stop successive clicks on ratings,
    // although the server should still validate to make
    // sure only one rating is sent per game
    if($(this).hasClass('inactive_for_click')) return false;
    $(links).addClass('inactive_for_click');
    // get the index of the link relative to the rest, add 1
    var index = $(links).index(this) + 1;
    $.post("../includes/process/rating.php", {
        id: "<?php $game_id ?>",
        type: "game",
        rating: index
    }, function(data) {
        $('#status').html(data).fadeIn("normal");
        // unbind links to disable further voting
        $(links).unbind('click'); 
    });
}); 
```

# javascript - javascript 字符串变量是否有类似 getElementsByTagName() 的函数？

> ID：703984
> 
> 赞同：6
> 
> 时间：2009-04-01T03:45:56.497
> 
> 标签：javascript, string

我可以使用 getElementsByTagName() 函数从网页中的元素中获取元素集合。

我希望能够对 javascript 字符串变量的内容而不是 DOM 元素的内容使用类似的函数。

我该怎么做呢？

编辑

我可以通过动态创建一个元素来做到这一点。

```
var myElement = new Element('div');
myElement.innerHTML = "<strong>hello</strong><em>there</em><strong>hot stuff</strong>";
var emCollection = myElement.getElementsByTagName('em');
alert(emCollection.length); // This gives 1 
```

但是为了方便使用 getElementsByTagName() 函数而动态创建元素似乎并不正确，并且不适用于 Internet Explorer 中的元素。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-01T04:33:08.163

正如您所展示的，将字符串注入 DOM 是最简单、最可靠的方法。如果对字符串进行操作，则必须考虑所有可能的转义场景，这些场景会使**看起来**像标签的东西实际上不是**标签**。

例如，你可以有

```
<button value="<em>"/>
<button value="</em>"/> 
```

在你的标记中——如果你把它当作一个字符串，你可能会认为你有一个`<em>`标签，但实际上，你只有两个按钮标签。

通过注入 DOM，`innerHTML`您可以利用浏览器内置的 HTML 解析器，这非常快。通过正则表达式做同样的事情会很痛苦，而且浏览器通常不提供类似 DOM 的功能来查找字符串中的元素。

您可以尝试的另一件事是将字符串解析为 XML，但我怀疑这会比 DOM 注入方法更麻烦且更慢。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-01T04:15:51.557

```
function countTags(html, tagName) {
    var matches = html.match(new RegExp("<" + tagName + "[\\s>]", "ig"));
    return matches ? matches.length : 0;
}

alert(
    countTags(
        "<strong>hello</strong><em>there</em><strong>hot stuff</strong>",
        "em"
    )
); // 1 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2017-08-15T08:06:06.970

```
var domParser = new DOMParser();
var htmlString = "<strong>hello</strong><em>there</em><strong>hot stuff</strong>";
var docElement = domParser.parseFromString(htmlString, "text/html").documentElement;
var emCollection = docElement.getElementsByTagName("em");
for (var i = 0; i < emCollection.length; i++) {
    console.log(emCollection[i]);
} 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-04-01T03:56:10.420

字符串中的 HTML 没什么特别的。它只是字符串中的文本。它需要被解析成一棵树才能有用。这就是为什么您需要创建一个元素，然后调用`getElementsByTagName`它，如您在示例中所示。

# c# - 以编程方式添加的 TemplateField 中的控件何时设置其 ID 属性？

> ID：703987
> 
> 赞同：1
> 
> 时间：2009-04-01T03:48:24.480
> 
> 标签：c#, asp.net, web-controls, templatefield

我有一个动态添加到自定义 GridView 的 TemplateField。

```
void ITemplate.InstantiateIn(System.Web.UI.Control container)
    {
        switch (_templateType)
        {
            case ListItemType.Header:
                if (this.ParentGridView.ShowDeleteHeaderImage)
                {
                    Image hImg = new Image();
                    hImg.ImageUrl = this.ParentGridView.DeleteHeaderImageUrl;
                    hImg.AlternateText = "Mark for Deletion";
                    container.Controls.Add(hImg);
                }
                else
                {
                    Label l = new Label();
                    l.Text = "Del";
                    container.Controls.Add(l);
                }
                break;
            case ListItemType.Item:
                container.Controls.Add(new CheckBox());
                break;
            case ListItemType.EditItem:
                break;
            case ListItemType.Footer:
                QLImageButton deleteButton = new QLImageButton();
                deleteButton.Settings.ImageId = "cmdQLGVDelete";
                deleteButton.Settings.ImageUrl = this.ParentGridView.DeleteImageUrl;
                deleteButton.CommandName = "Delete";
                container.Controls.Add(deleteButton);
                break;
        }
    } 
```

为了响应网格命令（插入/更新/删除），调用了一个名为 GetRowControls 的方法，该方法遍历特定网格行中的列，并将其每个控件添加到字典中。

```
Dictionary<string, WebControl> GetRowControls(GridViewRow row)
...

rowControls.Add(ctrl.ID, (WebControl)ctrl);

... 
```

因此，这对于以声明方式添加的模板字段和绑定控件以及以编程方式添加的动态非模板字段都适用。

但是，当控件是动态添加的 TemplateField 控件时，ctrl.ID 始终为 null，因此上面的语句会引发异常。

我用 Reflector 研究过这个问题，因为我发现当我在 VS 2005 的即时窗口中检查变量时，即 ?ctrl，ctrl.ID 会列出一个值。我已经确定这是因为在即时窗口中列出 ?ctrl 时，调用了属性 ClientID 并且 ClientID 调用了 EnsureId()，而后者又设置了 ID。

```
public virtual string ClientID
{
    get
    {
        this.EnsureID();
        string uniqueID = this.UniqueID;
        if ((uniqueID != null) && (uniqueID.IndexOf(this.IdSeparator) >= 0))
        {
            return uniqueID.Replace(this.IdSeparator, '_');
        }
        return uniqueID;
    }
} 
```

所以我假设 ClientID、UniqueId 和 ID 都是空的——尽管如上所述，只读取前两个将触发所有设置。另请注意 NamingContainer 不为空。它已被设置。

所以解决这个问题非常简单，即检查 ctrl.ID==null，如果是这样，只需读取 ctrl.ClientID。这就是我所做的，因为从时间上讲，我真的需要继续努力。但是，如果有人不自觉地知道答案，我仍然对答案感兴趣。

为什么动态添加的 TemplateField 的子控件的 ID 值设置在与其他控件不同的时间？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-01T17:42:34.617

并不是它们的行为不同，而是几乎总是当您以声明方式添加控件时，您会立即设置 ID。尝试将没有 ID 的标签添加到页面并浏览控件集合并检查其 ID，它将为空（确保不显示其 clientID，因为它会填充 ID）：

```
<asp:Label runat="server">something</asp:Label> 
```

另请注意，如果您像这样运行它，您将获得一个没有 ID 的跨度。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-01T20:17:57.660

弗雷迪是正确的。

您负责在 InstantiateIn 方法中设置 ID。如果没有另外指定，ClientID 会自动生成它们是有道理的。

声明性控件在页面编译期间获得由页面构建器分配的 ID。如果您要查看在“临时 ASP.NET 文件文件夹”中生成的临时 .cs 文件之一，您会发现类似这样的内容（去除了编译指示）：

```
//creating a template field, where CopiledBindableTemplateBuilder is the ITemplate
//and its InstantiateIn = @__BuildControl__control9
@__ctrl.ItemTemplate = new System.Web.UI.CompiledBindableTemplateBuilder(
    new System.Web.UI.BuildTemplateMethod(this.@__BuildControl__control9),
    new System.Web.UI.ExtractTemplateValuesMethod(this.@__ExtractValues__control9));

//and @__BuildControl__control9 calling @__BuildControlButton1
private global::System.Web.UI.WebControls.Button @__BuildControlButton1()
{
    global::System.Web.UI.WebControls.Button @__ctrl;

    @__ctrl = new global::System.Web.UI.WebControls.Button();
    this.Button1 = @__ctrl;
    @__ctrl.ApplyStyleSheetSkin(this);
    @__ctrl.ID = "Button1"; //<-- here it gets an ID
    @__ctrl.Text = "Button";
    return @__ctrl;
} 
```

# .net - 为什么是列表 不是线程安全的？

> ID：703990
> 
> 赞同：44
> 
> 时间：2009-04-01T03:49:57.127
> 
> 标签：.net, generics, thread-safety

从以下网站：

[http://crfdesign.net/programming/top-10-differences-between-java-and-c](http://crfdesign.net/programming/top-10-differences-between-java-and-c)

> 不幸的是，`List<>`它不是线程安全的（C#`ArrayList`和 Java `Vector`是线程安全的）。C# 也有一个`Hashtable`; 通用版本是：

是什么让`List<T>`线程不安全？是.NET框架工程师的实现问题吗？还是泛型不是线程安全的？

* * *

## 回答 #1

> 赞同：69
> 
> 时间：2009-04-01T03:55:54.133

您确实需要对 Java 的 Vector 的线程安全类型进行分类。Javas Vector 可以安全地从多个线程中使用，因为它在方法上使用同步。状态不会被破坏。

但是，Java 的向量的用处受限于没有额外同步的多线程。例如，考虑从向量中读取元素的简单行为

```
Vector vector = getVector();
if ( vector.size() > 0 ) { 
  object first = vector.get(0);
} 
```

这种方法不会破坏向量的状态，但也是不正确的。没有什么可以阻止另一个线程在 if 语句和 get() 调用之间改变向量。由于竞争条件，此代码可能并且最终**会失败。**

这种类型的同步只在少数情况下有用，而且肯定不便宜。即使您不使用多个线程，您也需要为同步付出可观的代价。

.Net 选择默认不支付这个价格，因为它的用处有限。相反，它选择实现一个无锁列表。作者负责添加任何同步。它更接近 C++ 的“只为你使用的东西付费”的模型

我最近写了几篇关于使用只有内部同步的集合（如 Java 的向量）的危险的文章。

*   [为什么线程安全的集合这么难？](http://blogs.msdn.com/jaredpar/archive/2009/02/11/why-are-thread-safe-collections-so-hard.aspx)
*   [用于可变线程安全集合的更有用的 API](http://blogs.msdn.com/jaredpar/archive/2009/02/16/a-more-usable-thread-safe-collection.aspx)

参考 Vector 线程安全：[http ://www.ibm.com/developerworks/java/library/j-jtp09263.html](http://www.ibm.com/developerworks/java/library/j-jtp09263.html)

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2009-04-01T03:54:55.400

为什么它*是*线程安全的？不是每个班级都是。事实上，默认情况下，类*不是*线程安全的。

线程安全意味着任何修改列表的操作都需要互锁以防止同时访问。即使对于那些只会被单个线程使用的列表，这也是必要的。那将是非常低效的。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-04-01T03:58:11.397

实现非线程安全的类型只是一个设计决定。集合提供`SyncRoot`接口的属性`ICollection`和`Synchronized()`一些集合的方法，用于显式同步数据类型。

用于`SyncRoot`在多线程环境中锁定对象。

```
lock (collection.SyncRoot)
{
   DoSomething(collection);
} 
```

用于`collection.Synchronized()`获取集合的线程安全包装器。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-01T05:58:49.783

为了真正的线程安全，`List<>`其他集合类型需要是不可变的。随着 .NET 4.0 中出现的 .NET 并行扩展，我们将看到最常用集合的线程安全版本。 [Jon Skeet 谈到](http://msmvps.com/blogs/jon_skeet/archive/2008/02/07/c-4-part-3-ideas-from-microsoft.aspx)了其中的一些内容。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-04-03T18:18:12.433

JaredPar 提到的竞争条件可能性是依赖 Vector 假定的线程安全的可怕后果。这种事情会导致“每个第九个星期二，应用程序都会做一些奇怪的事情”——这种缺陷报告会让你发疯。

[.Net 4](http://blogs.msdn.com/pfxteam/archive/2009/03/04/9457880.aspx)中有许多真正线程安全的集合，具有一个有趣的副作用，即它们允许[在枚举时对集合进行](http://www.lovethedot.net/2009/03/interesting-side-effect-of-concurrency.html)单线程修改，但是线程安全带来了[性能损失](http://www.lovethedot.net/2009/04/bit-about-performance-of-concurrent.html)，有时甚至是相当不错的大的一个。

因此，对于框架开发人员来说，合乎逻辑的事情是让 95% 的用户尽可能保持类的性能，这些用户可能不会使用线程，并依赖那些使用多线程的用户来了解他们必须做些什么来保持它安全。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-01-29T12:39:48.160

使用 SynchronizedCollection 它还提供了一个构造函数参数来使用共享同步:)

# javascript - Javascript 不兼容/不一致

> ID：703993
> 
> 赞同：6
> 
> 时间：2009-04-01T03:52:45.157
> 
> 标签：javascript

我希望在几周后做一个演示，并且想知道：在开发时你要注意的十大 Javascript 不兼容性是什么？什么绊倒你？我可以从一个开始：

```
var somevar = {
 'internet': 'explorer',
 'hates': 'trailing',
 'commas': 'in',
 'json': 'code', // oh noes!
} 
```

使用 jQuery 或 base 等框架无法或无法解决的其他常见问题有哪些？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-01T04:36:43.943

使用 HTML 标记，例如

```
<div id="foo">
    <a href="#">Link 1</a>
</div> 
```

如果您获得对外部 div 的引用，它将在某些浏览器中具有一个子节点，而在其他浏览器中将具有三个子节点，具体取决于处理空白的方式。有些会有带有换行符和空格的文本节点作为`div#foo`链接元素前后的子节点。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-04-01T10:07:09.187

嗯，隐含分号有问题。

```
return {
    a: 1,
    b: 2
} 
```

有些人喜欢在自己的行上打开括号，像这样：

```
return
{
    a: 1,
    b: 2
} 
```

但是，最后一条语句将返回`undefined`，因为解析器看到：

```
return;
{
    a: 1,
    b: 2
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-01T12:53:16.840

var x = new Boolean(false); 如果 (x) ... 否则 ...;

是“if”还是“else”分支？

var x = "hi", y = new String("hi");

typeof(x) 和 typeof(y) 是什么？

编辑：..

parseInt("017") 产生 15（八进制）而不是 17

“错误”对象是从 IE 到 Firefox 的不同签名。

当使用对象作为 hashmap 的时候，你需要使用 object.hasOwnProperty(key) 来确保属性不会通过原型链继承。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-01T13:14:40.033

另一个（不要认为这经常出现）：

```
(typeof document.getElementById) 
```

在 IE 中：“对象”

在 Firefox 中：“功能”

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-01T08:57:14.643

跨浏览器的 JavaScript 实现几乎没有不一致。如果有，那将是一场噩梦（由于 DOM 实现中的多重不一致）。因此，“十大 Javascript 不兼容/不一致”可能只能填充您发现的“底部一个”。确实可能还有一对，但我几乎不认为它们会成为主要的，甚至值得关注。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-01T10:02:31.710

除了 DOM API 的不一致（这是库解决的问题）之外，并没有很多。

但是一些 JS 引擎实现[了更多的特性](https://developer.mozilla.org/en/New_in_JavaScript_1.8)，比如 [].map()、[].filter() 等，let 语句或 E4X。当我在以 Mozilla 为目标的开发（Firefox 扩展，使用 Jaxer 的服务器端）和一般的浏览器标记开发（网站）之间切换时，我需要记住每个浏览器中哪些可用，哪些不可用。因此，关键在于实施了**什么**，而不是**如何**完成。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-01T14:20:29.190

还有一个：

从 Firefox 到 IE 的正则表达式，有很多不一致的地方：

描述：http: [//blog.stevenlevithan.com/archives/cross-browser-split](http://stevenlevithan.com/demo/split.cfm)

他发布了 RegEx 对象的固定版本和测试页面： [http ://stevenlevithan.com/demo/split.cfm](http://stevenlevithan.com/demo/split.cfm)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-04-01T14:32:39.300

对于日期对象：

```
alert( (new Date()).getYear(); 
```

Firefox 返回 109

Internet Explorer 返回 2009

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-04-01T16:31:26.580

```
alert(document instanceof Document) 
```

在 Firefox 中：是的！

在 Internet Explorer 中：异常：文档未定义

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-04-01T17:48:14.337

altCognito 观点的扩展。元素也不是定义的基本类型...

```
//uses jQuery
function getSomething(input) {
   if (typeof(input) == string)
       input = $(input)[0] || $('#'+input)[0] || null;

   if (input instanceof Element)
       input = $(input);

   if (input instanceOf jQuery) {
       ...do something...
   }
} 
```

我不得不用..替换instanceOf Element

```
if (input && input.tagName)... 
```

如果 DOM 元素在 IE 中都能正确地进行基类分类，那就太好了。

# data-structures - 图可以比其他方法更好地解决问题的好例子有哪些？

> ID：703999
> 
> 赞同：50
> 
> 时间：2009-04-01T03:54:40.360
> 
> 标签：data-structures, graph, graph-theory

在阅读了 Stevey Yegge 的[在 Google 获得那份工作](http://steve-yegge.blogspot.com/2008/03/get-that-job-at-google.html)的文章后，我发现这句话很有趣：

> 每当有人给你一个问题时，想想图表。它们是表示任何类型关系的最基本和最灵活的方式，因此任何有趣的设计问题都需要一个 50 到 50 个镜头，其中包含一个图表。在转向其他解决方案类型之前，请绝对确保您想不出使用图表来解决它的方法。这个提示很重要！

图数据结构/算法最能代表和/或解决的问题有哪些示例？

我能想到的一个例子：导航单元（ala Garmin，TomTom），提供从您当前位置到另一个位置的道路方向，利用图表和高级路径算法。

还有一些是什么？

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2009-04-05T06:20:36.573

**Computer Networks:** Graphs model intuitively model computer networks and the Internet. Often nodes will represent end-systems or routers, while edges represent connections between these systems.

**Data Structures:** Any data structure that makes use of pointers to link data together is making use of a graph of some kind. This includes tree structures and linked lists which are used all the time.

**Pathing and Maps:** Trying to find shortest or longest paths from some location to a destination makes use of graphs. This can include pathing like you see in an application like Google maps, or calculating paths for AI characters to take in a video game, and many other similar problems.

**Constraint Satisfaction:** A common problem in AI is to find some goal that satisfies a list of constraints. For example, for a University to set it's course schedules, it needs to make sure that certain courses don't conflict, that a professor isn't teaching two courses at the same time, that the lectures occur during certain timeslots, and so on. Constraint satisfaction problems like this are often modeled and solved using graphs.

**Molecules:** Graphs can be used to model atoms and molecules for studying their interaction and structure among other things.

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2009-05-20T20:39:10.287

我对图论非常感兴趣，我用它解决了很多不同类型的问题。您可以使用图解决很多与路径相关的问题、匹配问题、结构问题。

*   **路径问题**有很多应用。

    这是在职业杯的面试问题中。假设您想找到子数组的最长和。例如，`[1, 2, 3, -1]`最长的总和为 6。将其建模为有向无*环图*( *DAG* )，添加虚拟源、虚拟目标。将每个节点与一条边连接起来，边的权重与数字对应。现在使用 DAG 中的*最长路径*算法来解决这个问题。

    同样，金融世界中的套利问题，甚至寻找最长重叠结构的几何问题都是类似的路径问题。

*   一些明显的问题是**网络问题**（您的网络可能有计算机人员、组织结构图等）。
    您可以收集很多**结构信息**，例如

    *   哪一点将图形分成两部分
    *   连接它们的最佳方式是什么
    *   到达另一个地方的最佳方式是什么
    *   有没有办法从另一个地方到达一个地方，等等。
*   我已经使用图表解决了很多与**项目管理相关的问题。***一系列事件可以被描绘成一个有**向图***（如果你没有循环，那就更好了）。所以，现在你可以

    *   根据事件的优先级对事件进行排序
    *   您可以找到最关键的事件（即可以释放很多其他项目）
    *   您可以找到解决整个项目（路径问题）所需的持续时间等。
*   很多**匹配问题**都可以通过图来解决。例如，如果您需要将处理器与工作负载相匹配或将工人与其工作相匹配。在我的期末考试中，我必须将人们与餐馆的桌子相匹配。它遵循相同的原则（二分匹配 -> 网络流算法）。它简单而强大。

*   一个特殊的图，一**棵树**，在计算机科学领域有很多应用。例如，在编程语言的语法中，或在数据库索引结构中。

*   最近，我还在**编译器**优化问题中使用了图表。我正在使用摩根的书，它教会了我迷人的技巧。

这份清单真的不胜枚举。图是**关系**的美丽数学抽象。如果你能正确地建模，你真的可以创造奇迹。并且由于*图论*已经找到了如此多的应用，该领域也有许多积极的研究。由于大量的研究，我们看到更多的应用正在推动研究。

如果你想开始学习图论，买一本很好的初学者离散数学书（我想到了**Rosen ），你可以从****Fould**或**Even**等作者那里购买书籍。**CLRS**也有很好的图算法。

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2009-04-01T04:29:28.607

您的源代码是树结构的，树是一种图。每当您听到人们谈论 AST（抽象语法树）时，他们都在谈论一种图。

指针形成图结构。任何带指针的东西都在做某种图形操作。

网络是一个巨大的有向图。谷歌在搜索中占据主导地位的关键洞察力是，网络的图形结构与页面的文本内容具有可比性或更重要的重要性。

状态机是图。状态机用于网络协议、正则表达式、游戏和各种其他领域。

很难想到您所做的任何事情不涉及某种图形结构。

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2009-04-01T03:58:27.637

一个大多数人都熟悉的例子：构建系统。Make 是典型的例子，但几乎所有好的构建系统都依赖于有向无环图。基本思想是方向对源和目标之间的依赖关系进行建模，并且您应该以特定顺序“遍历”图形以正确构建事物->这是拓扑排序的示例。

另一个例子是源代码控制系统：同样基于 DAG。它用于合并，例如，找到共同的父级。

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2009-04-01T04:01:25.710

好吧，编译器使用的许多程序优化算法都是基于图的（例如，找出调用图、流控制、大量静态分析）。

许多优化问题都是基于图的。由于许多问题可以简化为图形着色和类似问题，因此许多其他问题也是基于图形的。

我不确定我是否同意图表是表示每个关系的最佳方式，我当然会尽量避免这些“有钉子，让我们找锤子”的方法。图通常具有较差的内存表示，并且许多算法在使用矩阵、位集和其他东西实现时实际上更有效（在实践中）。

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2009-04-01T14:04:32.207

光学字符识别。想象以一定角度扫描的一页文本，图像中有一些噪点，您必须在其中找到文本行之间的空间。一种方法是制作像素图，并找到从页面一侧到另一侧的最短路径，其中亮度的差异是像素之间的距离。

这个例子来自[Algorithm Design Manual](http://www.algorist.com/)，其中有很多其他真实世界的图问题例子。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2009-04-01T04:09:13.477

以下是基于图论的：

*   二叉树和其他树，如红黑树、张开树等。
*   链表
*   任何被建模为状态机的东西（GUI、网络堆栈、CPU 等）
*   决策树（用于 AI 和其他应用程序）
*   复杂的类继承

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2009-04-01T05:35:33.363

一个流行的例子是垃圾收集。

收集器从一组引用开始，然后遍历它们引用的所有对象，然后遍历那里引用的所有对象，依此类推。它找到的所有东西都被添加到可达对象的图中。所有其他对象都无法访问和收集。

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2009-04-01T10:20:20.187

图不是数据结构。它们是关系的数学表示。是的，您可以使用图来思考和理论化问题，并且有大量关于它的理论。但是当你需要实现一个算法时，你选择的是最能代表问题的数据结构，而不是图表。有许多数据结构可以表示一般图，对于特殊类型的图甚至更多。

在您的问题中，您将这两件事混合在一起。相同的理论解决方案可能在图方面，但实际解决方案可能使用不同的数据结构来表示图。

* * *

## 回答 #10

> 赞同：4
> 
> 时间：2009-04-01T09:49:57.543

找出两个分子是否可以结合在一起。在开发药物时，人们通常对药物分子是否可以融入体内更大的分子感兴趣。确定这是否可能的问题是分子不是静态的。分子的不同部分可以围绕它们的化学结合旋转，因此分子可以变成很多不同的形状。

每个形状都可以说是表示由形状组成的空间中的一个点。解决这个问题需要找到一条穿过这个空间的路径。您可以通过创建一个穿越空间的路线图来做到这一点，该路线图本质上是一个由合法形状组成的图表，并说明一个形状可以变成哪种形状。通过此路线图使用 A* 图搜索算法，您可以找到解决方案。

好吧，那是很多可能不是很容易理解或清楚的喋喋不休。但我的观点是，各种问题都会出现图表。

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2009-04-01T04:09:55.253

图表非常适合管理依赖项。

我最近开始使用 Castle Windsor Container，在检查内核后发现了一个 GraphNodes 属性。Castle Windsor 使用图表来表示对象之间的*依赖*关系，以便注入能够正常工作。看看这篇[文章](http://mikehadlow.blogspot.com/2008/03/how-to-output-windsor-container.html)。

我还使用简单的图论开发了一个插件框架，每个图节点代表一个插件，一旦定义了依赖关系，我就可以遍历图来创建插件加载顺序。

我计划更改算法以实现 Dijkstra 的算法，以便每个插件都以特定版本加权，因此简单的更改只会加载最新版本的插件。

我和我更早发现了这一点。我喜欢这句话“每当有人给你一个问题，想想图表。” 我绝对认为这是真的。

* * *

## 回答 #12

> 赞同：3
> 
> 时间：2009-05-03T14:34:25.017

恕我直言，我们在正常应用程序中使用的大多数领域模型在某些方面都是图表。如果您查看 UML 图，您会注意到，使用有向标记图，您可以轻松地将它们直接转换为持久性模型。[Neo4j](http://wiki.neo4j.org/content/Domain_Modeling_Gallery)有一些这样的例子

干杯

/彼得

* * *

## 回答 #13

> 赞同：3
> 
> 时间：2010-01-22T08:30:08.153

人与人之间的社会联系是一个有趣的图表示例。我尝试使用传统的 RDMS 在数据库级别对这些连接进行建模，但发现它太难了。我最终选择了一个图形数据库，这是一个很好的选择，因为它可以很容易地跟踪人（节点）之间的连接（边）。

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2010-07-13T20:22:48.447

任何可以在*关系数据库中建模为**外*键的东西本质上都是图中的*边*和*节点*。

 ***也许这会帮助您思考示例，因为大多数事物都可以轻松地在 RDBMS 中建模。

* * *

## 回答 #15

> 赞同：2
> 
> 时间：2009-04-01T04:04:06.343

在代码中分析和/或基准测试算法和实现。

* * *

## 回答 #16

> 赞同：2
> 
> 时间：2010-01-22T18:17:11.440

您可以查看 Neo4j wiki 中的一些示例，

> [http://wiki.neo4j.org/content/Domain_Modeling_Gallery](http://wiki.neo4j.org/content/Domain_Modeling_Gallery)

以及 Neo4j 使用的项目（已知项目）

> [http://wiki.neo4j.org/content/Neo4j_In_The_Wild](http://wiki.neo4j.org/content/Neo4j_In_The_Wild)。

否则，推荐算法对图很有用，参见例如 PageRank 和其他东西

> [https://github.com/tinkerpop/gremlin/wiki/pagerank](https://github.com/tinkerpop/gremlin/wiki/pagerank)

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2009-04-01T05:30:25.700

您可以在任何可以将问题域对象定义为节点并将解决方案定义为节点之间的控制和/或数据流的地方使用图形。

考虑到树确实是连通无环图这一事实，您可以使用图论的领域甚至更多。

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2010-07-13T20:16:50.957

分析数据库理论中的事务[可串行性。](http://en.wikipedia.org/wiki/Serializability)

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2011-04-12T15:20:38.097

基本上几乎所有常见的数据结构，如树、列表、队列等，都可以被认为是图的类型，有些具有不同类型的约束。

根据我的经验，我在*网络流问题*中大量使用了图，它被用于许多领域，如*电信网络路由*和 *优化、工作负载分配*、*匹配*、*供应链优化*和*公共交通规划*。

另一个有趣的领域是前面提到的社交网络建模。

还有更多，例如*集成电路优化*等。***~~~~********