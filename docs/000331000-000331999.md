# StackOverflow 问答 000331000-000331999

# asp.net - 在 ASP.NET 中本地化图像

> ID：331000
> 
> 赞同：7
> 
> 时间：2008-12-01T14:23:53.913
> 
> 标签：asp.net, image, localization, globalization

几年前，我们让一位平面设计师改造了我们的网站。他的结果看起来很棒，但不幸的是，他引入了 Web 浏览器不支持的新字体。

起初我想，“什么！？！”......因为我们的大部分内容都是动态的，并且没有真正的方法来预先制作所有图像。还有多种语言的问题（因为我们知道西班牙语即将出现）。

无论如何，我决定创建一些类来通过 GDI+ 自动生成图像并根据需要以编程方式缓存它们。这解决了我们最初的大部分问题。然而，现在我们的负载急剧增加，我们的 UI 服务器已经耗尽。

现在问题来了……我希望用标准的网络浏览器字体替换大多数动态 GDI+ 图像。我正在考虑保留一些渲染的 GDI+ 图像并将它们放在 resx 文件中，但计划通过 asp:Labels 用 Tahoma 或 Arial 字体替换其中的大部分。

您发现哪个是更好的本地化图像解决方案？

*   将图像嵌入到 resx
*   仅将图像 url 添加到 resx
*   其他一些解决方案

我主要关心的是限制 UI 服务器上的处理。如果是这种情况，与将图像实际嵌入到 resx 相比，将图像 url 添加到 resx 会是更好的解决方案吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-01T14:59:19.083

[在这里](https://stackoverflow.com/questions/317191/find-a-localized-file#317231)查看我的回复

这可以手动完成，也可以使用某种自动化 (CMS) 系统完成。

基本方法是将图像缓存在特定语言的目录结构中，然后编写一个 HTTP 处理程序来有效地删除额外的目录层。例如：

```
/images/
    /en/
        header1.gif
    /es/
        header1.gif 
```

在您的标记或 CSS 中，您只需引用 /images/header1.gif。然后，http 处理程序使用会话（如果语言是特定于用户的）或配置（如果特定于站点）来选择从哪个目录提供图像。

这在代码和内容之间提供了一条清晰的线路，并允许客户端缓存。Resx 非常适合小字符串，但我更喜欢这样的系统来处理图像和更大的内容。尤其是在通常很容易切换图像的网络上。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-01T15:10:01.090

您应该只需要生成每个图像一次，然后将其保存在硬盘上。您网站上的负载不应增加您必须执行的处理量。话虽如此，听起来您几乎将图像用于您不应该使用的事情。如果有这么多不同的图像，您无法跟上生成它们的速度，那么是时候放弃您的花哨的图像来寻找不应该是图像的东西，并回到纯文本。如果用户没有安装指定的字体，它应该回退到类似的字体。CSS对此有很好的支持。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-01T15:04:32.147

几年前我遇到了同样的问题，我们的界面团队将我们指向了 SIFr。[http://wiki.novemberborn.net/sifr/](http://wiki.novemberborn.net/sifr/)

您将字体嵌入到 Flash 电影中，然后使用 SIFr JavaScript 将文本动态转换为字体。因为它是客户端，所以没有服务器端的影响。

如果用户没有安装 Flash 或 JavaScript，他们将获得最接近网络友好的字体。

作为一个额外的好处：因为你的内容仍然是文本——谷歌可以搜索和索引内容——一个巨大的 SEO 优化。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-01T14:53:07.380

由于缓存，我宁愿只将图像 url 添加到 resx 中。静态内容（即普通文件）的缓存比生成的内容要好得多。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-01T15:28:31.037

我会*非常*谨慎地将文本放入图像中，具有适当字体系列后备的 CSS 可能是对可访问性和良好 MVC 基础的正确响应。

在真正需要生成的地方，我认为**Kiblee**和**JayArr**概述了很好的解决方案

# sql-server - 更改 SQL Server 中单个数据库的默认日期时间格式

> ID：331002
> 
> 赞同：23
> 
> 时间：2008-12-01T14:24:45.393
> 
> 标签：sql-server, datetime

我需要在 SQL 服务器机器上的单个数据库上将日期格式从美国 (mm/dd/YYYY) 更改为英国 (dd/mm/YYYY)。

如何才能做到这一点？

我已经看到为整个系统执行此操作的语句，以及为会话执行此操作的语句，但我现在无法更改代码，因为它必须再次通过 QA，所以我需要快速修复来更改日期时间格式。

**更新**

我意识到日期时间与 SQL Server 如何存储数据无关，但它确实与它如何解析查询有很大关系。

我正在将 XML 文件中的原始数据放入数据库中。XML 文件中的日期采用英国日期格式。

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2008-12-02T11:23:03.590

您可以使用**SET DATEFORMAT**，就像在这个例子中一样

```
declare @dates table (orig varchar(50) ,parsed datetime)

SET DATEFORMAT ydm;

insert into @dates
select '2008-09-01','2008-09-01'

SET DATEFORMAT ymd;
insert into @dates
select '2008-09-01','2008-09-01'

select * from @dates 
```

解析 XML 数据时，您需要在代码中指定日期格式

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2008-12-01T16:52:46.123

为了避免处理这些非常无聊的问题，我建议您始终使用**标准且唯一的 SQL/ISO 日期格式**（即 YYYY-MM-DD）解析数据。然后，您的查询将在国际范围内工作，无论您的主服务器或查询客户端上的日期参数是什么（本地日期设置可能与主服务器设置不同）！

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-12-01T14:39:40.027

您只能更改整个服务器上的语言，而不是单个数据库。但是，如果您需要支持英国，您可以在所有输入和输出之前运行以下命令：

```
set language 'british english' 
```

或者，如果您在从应用程序输入数据时间时遇到问题，您可能需要考虑通用输入类型，例如

> 2008 年 12 月 1 日

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2015-02-06T13:28:05.330

虽然您不能为单个数据库设置默认日期格式，但您可以更改用于访问此数据库的登录名的默认语言：

```
ALTER LOGIN your_login WITH DEFAULT_LANGUAGE=British 
```

在某些情况下，它会有所帮助。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-01T14:41:31.897

如果这确实是一个 QA 问题并且您不能更改代码。在机器上设置一个新的服务器实例并将语言设置为“英式英语”

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2008-12-01T14:32:14.067

您确实意识到格式与 SQL Server 如何存储日期时间无关，对吧？

您可以`set dateformat`为每个会话使用。仅对数据库没有设置。

如果您使用参数进行数据插入或更新或过滤，您将不会遇到任何问题。

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2009-02-03T14:51:05.710

采用：

```
select * from mytest
EXEC sp_rename 'mytest.eid', 'id', 'COLUMN'
alter table mytest add id int not null identity(1,1)
update mytset set eid=id
ALTER TABLE mytest DROP COLUMN eid

ALTER TABLE [dbo].[yourtablename] ADD DEFAULT (getdate()) FOR [yourfieldname] 
```

它正在 100% 工作。

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2009-07-08T16:43:38.933

对于 SQL Server 2008 运行：

```
EXEC sp_defaultlanguage 'username', 'british' 
```

# c# - 如何使用实体框架将字符串映射到 Uri 类型？

> ID：331004
> 
> 赞同：3
> 
> 时间：2008-12-01T14:25:37.327
> 
> 标签：c#, entity-framework, uri

我的数据库包含一个字符串类型的列，它代表一个 URL。我现在想知道如何使用实体框架将此字符串映射到 Uri 对象。

有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-01T16:55:14.590

使用带有自定义属性的部分类：

```
 public partial class MyClass
    {
        public Uri MyUri
        {
            get
                { return new Uri(StringUriPropertyFromDB); }
        }
    } 
```

如果需要，可以在 EF 设计器中将字符串属性设为私有。但请注意，您不能在 LINQ to 实体中使用这样的自定义属性。

# c# - WinForms：进入主菜单后不会触发文本框离开事件

> ID：331007
> 
> 赞同：7
> 
> 时间：2008-12-01T14:26:00.757
> 
> 标签：c#, .net, winforms

我的表单上有一个 TextBox 控件。我使用控件上的 Leave 事件来处理用户输入。如果用户单击表单上的其他控件，它可以正常工作，但是当用户直接进入主菜单时甚至不会被触发。任何想法我应该使用哪个事件来让它每次都被触发？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-12-01T14:59:08.443

我找到了一个合理的解决方法，我手动将焦点设置在主菜单上：

编辑：正如@TcKs 所建议的，我将事件从ItemClicked 更改为MenuActivate。非常感谢您的帮助！

```
 private void menuStrip1_MenuActivate( object sender, EventArgs e )
    {
        menuStrip1.Focus();
    } 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-01T14:33:24.300

您应该使用“Validating”和“Validated”事件来检查用户的输入。然后，如果用户转到另一个控件“A”，并且控件“A”的属性“CausesValidation”设置为“true”（其默认值），则将触发“Validating”和“Validated”事件。

菜单也有“CausesValidation”属性。

**编辑：** 对不起，我忘记了菜单条中的“CausesValidation”是我们的功能，而不是内置的。但是验证检查非常简单：

```
private void menuStrip1_MenuActivate( object sender, EventArgs e ) {
    bool ret = this.Validate( false );
    if ( false == ret ) {
        // user's input is wrong
    }
} 
```

如果您想在“this”表单之外的另一个控件中检查验证，请使用任何 ContainerControl 而不是“this”。例如在 MDI 子窗口中。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-01T14:40:31.210

有些情况下没有触发 Lostfocus，例如单击工具栏按钮和菜单项。我曾经使用本地“LastControl”变量来解决这个问题，并在菜单获得焦点时自己处理它。

菜单单击不会失去文本框焦点是有原因的。例如，如果您想要一个带有“粘贴”的“编辑”菜单，则“粘贴”应该针对具有焦点的控件进行操作，因此它不能从表单上的任何控件中窃取焦点。

所以菜单可以看作是一个上下文菜单，不会从控件中窃取焦点。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-01T14:36:06.417

玩菜单时，您必须以某种方式模拟丢失的焦点，并可能记住它的位置，以防您关闭菜单而不做任何事情，这样焦点就会返回到文本框

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2008-12-01T15:55:59.220

您需要每 1 个像素 1 个像素的标签

```
Private Sub TextBox1_Leave(ByVal sender As Object, ByVal e As System.EventArgs) Handles TextBox1.Leave
    MsgBox("yes")
End Sub

Private Sub MenuStrip1_MenuActivate(ByVal sender As Object, ByVal e As System.EventArgs) Handles MenuStrip1.MenuActivate
    CType(sender, MenuStrip).Tag = ActiveControl
    Label1.Focus()
End Sub

Private Sub MenuStrip1_MenuDeactivate(ByVal sender As Object, ByVal e As System.EventArgs) Handles MenuStrip1.MenuDeactivate
    If CType(sender, MenuStrip).Tag Is Control AndAlso CType(CType(sender, MenuStrip).Tag, Control).CanFocus Then
        CType(CType(sender, MenuStrip).Tag, Control).Focus()
    End If
    CType(sender, MenuStrip).Tag = Nothing
End Sub 
```

# asp.net - ASP.NET + JIT？

> ID：331008
> 
> 赞同：3
> 
> 时间：2008-12-01T14:26:12.473
> 
> 标签：asp.net

在（Pre-JIT，Econo-JIT，Normal-JIT）之外的.Net（Visual Studio）中使用的JIT编译器的默认类型是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-05T17:38:50.007

据我所知，默认 JIT 是 Pre-JIT，但[ASP.NET 不支持通过 Native Image Generator 进行 Pre-Just-In-Time (JIT) 编译](http://support.microsoft.com/default.aspx/kb/331979)。

关于各种 JIT 类型的一些背景知识：

**PRE-JIT**：在一次操作中将完整的源代码编译为本机代码。

**ECONO-JIT**：仅编译在运行时调用的方法。

**NORMAL-JIT**：仅编译在运行时调用并存储在缓存中的方法。

# c# - 过时的属性导致属性被 XmlSerialization 忽略

> ID：331013
> 
> 赞同：59
> 
> 时间：2008-12-01T14:28:06.120
> 
> 标签：c#, .net-2.0, xml-serialization, attributes

我正在重构一些序列化为 XML 的对象，但需要保留一些属性以实现向后兼容性，我有一种方法可以为我将旧对象转换为新对象并将过时的属性清空。我想使用该`Obsolete`属性告诉其他开发人员不要使用此属性，但它会导致该属性被`XmlSerializer`.

类似代码：

```
[Serializable]
public class MySerializableObject
{
    private MyObject _oldObject;
    private MyObject _anotherOldObject;

    private MyObject _newBetterObject;

    [Obsolete("Use new properties in NewBetterObject to prevent duplication")]
    public MyObject OldObject
    {
      get { return _oldObject; }
      set { _oldObject = value; }
    }

    [Obsolete("Use new properties in NewBetterObject to prevent duplication")]
    public MyObject AnotherOldObject
    {
      get { return _anotherOldObject; }
      set { _anotherOldObject = value; }
    }

    public MyObject NewBetterObject
    {
      get { return _anotherOldObject; }
      set { _anotherOldObject = value; }
    } 
} 
```

关于解决方法的任何想法？我最好的解决方案是在 XML 注释中写过时的......

**更新：我正在使用 .NET 2.0**

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2008-12-01T14:34:43.937

*编辑*：[阅读 MS Connect 文章后](https://connect.microsoft.com/VisualStudio/feedback/ViewFeedback.aspx?FeedbackID=94241&wa=wsignin1.0)，.Net 2.0 似乎有一个“功能”，它使 ObsoleteAttribute 等效于 XmlIgnoreAttribute 而文档中没有任何通知。所以我要修改我的答案，说在这种情况下，吃蛋糕的唯一方法是遵循@Will 的建议并[手动实施序列化](http://msdn.microsoft.com/en-us/library/system.xml.serialization.ixmlserializable(VS.80).aspx)。这将是您在 XML 中包含 Obsolete 属性的唯一未来证明方式。它在 .Net 2.0 中并不漂亮，但 .Net 3.0+ 可以让生活更轻松。

从[XmlSerializer](http://msdn.microsoft.com/en-us/library/system.xml.serialization.xmlserializer.aspx)：

> 标记为 Obsolete 属性的对象不再序列化 在 .NET Framework 3.5 中，XmlSerializer 类不再序列化标记为 [Obsolete] 的对象。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2011-08-02T21:47:23.640

另一种解决方法是在为数据类型创建序列化程序时订阅 XmlSerializer.UnknownElement，然后以这种方式修复旧数据。

[http://weblogs.asp.net/psteele/archive/2011/01/31/xml-serialization-and-the-obsolete-attribute.aspx](http://weblogs.asp.net/psteele/archive/2011/01/31/xml-serialization-and-the-obsolete-attribute.aspx)

也许考虑将订阅方法作为数据类型的类上的静态方法。

```
static void serializer_UnknownElement(object sender, XmlElementEventArgs e)
{
    if( e.Element.Name != "Hobbies")
    {
        return;
    }

    var target = (MyData) e.ObjectBeingDeserialized;
    foreach(XmlElement hobby in e.Element.ChildNodes)
    {
        target.Hobbies.Add(hobby.InnerText);
        target.HobbyData.Add(new Hobby{Name = hobby.InnerText});
    }
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-07-23T19:50:14.863

我一直在为此苦苦挣扎——除了手动进行序列化或使用另一个序列化程序之外，没有其他解决方案。

但是，您可以考虑`Obsolete`为属性名称添加前缀（例如，`Foo`成为`ObsoleteFoo`. 这不会像属性那样生成编译器警告，但至少它在代码中是可见的，而不是为每个过时的属性编写填充程序，这很快就会变得很痛苦。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-12-01T14:35:25.620

1) WAG：尝试将 XmlAttributeAttribute 添加到属性中；也许这将覆盖 ObsoleteAttribute
2) PITA: 实现 IXmlSerializable

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2016-03-16T14:15:56.637

是的，我同意用名称“过时”标记事物，我们使用 Enum 值执行此操作

```
/// <summary>
/// Determines the swap file location for a cluster.
/// </summary>
/// <remarks>This enum contains the original text based values for backwards compatibility with versions previous to "8.1".</remarks>
public enum VMwareClusterSwapFileLocation
{

    /// <summary>
    /// The swap file location is unknown.
    /// </summary>
    Unknown = 0,

    /// <summary>
    /// The swap file is stored in the virtual machine directory.
    /// </summary>
    VmDirectory = 1,

    /// <summary>
    /// The swap file is stored in the datastore specified by the host.
    /// </summary>
    HostLocal = 2,

    /// <summary>
    /// The swap file is stored in the virtual machine directory. This value is obsolete and used for backwards compatibility.
    /// </summary>
    [XmlElement("vmDirectory")]
    ObseleteVmDirectory = 3,

    /// <summary>
    /// The swap file is stored in the datastore specified by the host. This value is obsolete and used for backwards compatibility.
    /// </summary>
    [XmlElement("hostLocal")]
    ObseleteHostLocal = 4,

} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-01T14:45:49.140

您可以尝试以下解决方法：

添加一个名为的方法

```
ShouldSerializeOldObject ()
{
   return true;
}

ShouldSerializeAnotherOldObject ()
{
   return true
} 
```

这可能会覆盖过时的属性

# asp.net-mvc - 如何使用户控件的表单可移植到其他页面

> ID：331041
> 
> 赞同：2
> 
> 时间：2008-12-01T14:36:00.113
> 
> 标签：asp.net-mvc, reusability, user-controls

我有一个用户控件，它将在包含表单的多个页面中使用（与用户控件的自定义一样）。我在想如何保证它的功能。

首先，我想让一个带有单一方法的控制器接受这个表单的值。唯一阻碍我的是，在此方法完成计算等之后，它必须根据用户控件起源的视图转发到其他控制器和方法。

然后我希望所有具有此用户控件的控制器都具有相同的固定方法，然后将转发到该控制器的默认页面。这只有在固定方法只有一个选项可以转发（现在是这种情况，但明天可能不会）并且我可以在构建表单标签时以某种方式获取调用控制器时才有效。

有没有什么干净的方法可以让我的建议发挥作用，或者是否有其他选择可以让这件事顺利进行？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-01T14:44:58.113

您知道，您可以将公共属性添加到您的用户控件，然后在标记中引用这些属性以在当前上下文中执行适当的操作...

例如：

MyControl.ascx.cs：

```
/*snip*/
public string FormAction {get;set;}
/*snip*/ 
```

MyControl.ascx：

```
<% using(BeginForm(FormAction)){ %>
<!-- yadda -->
<% } %> 
```

在任何 aspx 中：

```
<!-- boring html goes here -->
<%=Html.RenderUserControl(“~/Views/Shared/MyControl.ascx”,null /*orwhatever*/, new {FormAction="ActionThatHandlesMyFormPostLol"})%> 
```

BeginForm 采用许多不同的参数，允许您控制表单的发布位置和方式。我不是 100% 清楚你的问题，但我希望这能让你知道如何继续前进......

# c++ - 使用具有不同编译器版本的 C++ DLL

> ID：331045
> 
> 赞同：8
> 
> 时间：2008-12-01T14:38:32.603
> 
> 标签：c++, windows, visual-c++-6, visual-c++-2008, name-decoration

这个问题与[“如何在 VS 版本之间制作一致的 dll 二进制文件？”有关。](https://stackoverflow.com/questions/232926/how-to-make-consistent-dll-binaries-across-vs-versions)

*   我们有使用 VC6 构建的应用程序和 DLL 以及使用 VC9 构建的新应用程序。VC9 应用程序必须使用用 VC6 编译的 DLL，其中大部分是用 C 编写的，一个是用 C++ 编写的。
*   由于名称修饰/修改问题，C++ 库存在问题。
*   使用 VC9 编译所有内容目前不是一种选择，因为似乎有一些副作用。解决这些问题将非常耗时。
*   我可以修改 C++ 库，但它必须使用 VC6 编译。
*   C++ 库本质上是另一个 C 库的 OO 包装器。VC9-app 使用一些静态函数以及一些非静态函数。

虽然静态函数可以用类似的东西来处理

```
// Header file
class DLL_API Foo
{
    int init();
}

extern "C"
{
    int DLL_API Foo_init();
}

// Implementation file
int Foo_init()
{
    return Foo::init();
} 
```

使用非静态方法并不容易。

据我了解，[Chris Becke](https://stackoverflow.com/questions/232926/how-to-make-consistent-dll-binaries-across-vs-versions#232959)关于使用类 COM 接口的建议对我没有帮助，因为接口成员名称仍将被修饰，因此无法从使用不同编译器创建的二进制文件中访问。*我在吗？*

唯一的解决方案是使用对象的处理程序编写 C 风格的 DLL 接口，还是我遗漏了什么？在那种情况下，我想，直接使用封装的 C 库可能会更省力。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-12-01T14:54:31.793

使用与调用 EXE 不同的 C++ 编译器编译的 DLL 时要考虑的最大问题是内存分配和对象生存期。

我假设您可以超越名称修饰（和调用约定），如果您使用具有兼容修饰的编译器（我认为 VC6 与 VS2008 广泛兼容），或者如果您使用 extern "C"，这并不难.

你会遇到问题的地方是当你从 DLL 中使用`new`(或`malloc`) 分配一些东西，然后你把它返回给调用者。调用者的`delete`（或`free`）将尝试从不同的堆中释放对象。这将大错特错。

您可以做 COM 风格`IFoo::Release`的事情，也可以做一`MyDllFree()`件事。这两个，因为它们回调到 DLL 中，将使用`delete`(or `free()`) 的正确实现，因此它们将删除正确的对象。

或者，您可以确保使用`LocalAlloc`（例如），以便 EXE 和 DLL 使用相同的堆。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-01T14:46:52.697

接口成员名称*不会*被修饰——它们只是 vtable 中的偏移量。您可以在头文件中定义一个接口（使用 C 结构，而不是 COM“接口”），因此：

```
struct IFoo {
    int Init() = 0;
}; 
```

然后，您可以从 DLL 中导出一个函数，而无需修改：

```
class CFoo : public IFoo { /* ... */ };
extern "C" IFoo * __stdcall GetFoo() { return new CFoo(); } 
```

如果您使用的是生成兼容 vtable 的编译器，这将正常工作。Microsoft C++ 自（至少，我认为）用于 DOS 的 MSVC6.1 以来生成了相同格式的 vtable，其中 vtable 是指向函数的简单指针列表（在多重继承情况下具有 thunking）。GNU C++（如果我没记错的话）生成带有函数指针和相对偏移量的 vtables。这些彼此不兼容。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-12-02T02:49:18.573

嗯，我认为[Chris Becke 的建议](https://stackoverflow.com/questions/232926/how-to-make-consistent-dll-binaries-across-vs-versions#232959)很好。我不会使用[Roger 的第一个解决方案](https://stackoverflow.com/questions/331045/using-c-dlls-with-different-compiler-versions#331064)，它仅在名称上使用接口，并且正如他所提到的，可能会遇到抽象类和虚拟方法的编译器处理不兼容的问题。[Roger 在他的后续文章](https://stackoverflow.com/questions/331045/using-c-dlls-with-different-compiler-versions#331088)中指出了有吸引力的 COM 一致案例。

1.  痛点：你需要学会发出COM接口请求并正确处理IUnknown，至少依赖IUnknown:AddRef和IUnknown:Release。如果接口的实现可以支持多个接口，或者如果方法也可以返回接口，您可能还需要熟悉 IUnknown:QueryInterface。

2.  这是关键的想法。所有使用接口实现（但不实现）的程序都使用一个通用的#include "*.h" 文件，该文件将接口定义为结构 (C) 或 C/C++ 类 (VC++) 或结构（非 VC++，但 C++）。*.h 文件会根据您是在编译 C 语言程序还是 C++ 语言程序而自动进行适当调整。您不必仅仅为了使用 *.h 文件而了解该部分。*.h 文件所做的是定义接口结构或类型，比方说，IFoo，及其虚拟成员函数（并且只有函数，在这种方法中对数据成员没有直接可见性）。

3.  头文件被构造为以一种适用于 C 和适用于 C++ 的方式遵守 COM 二进制标准，而与使用的 C++ 编译器无关。（Java JNI 人想出了这一点。）这意味着它可以在任何来源的单独编译的模块之间工作，只要一个完全由函数入口指针（一个 vtable）组成的结构被所有它们都映射到相同的内存（例如，它们必须全部为 x86 32 位，或全部为 x64）。

4.  在通过某种包装类实现 COM 接口的 DLL 中，您只需要一个工厂入口点。像一个

    extern "C" HRESULT MkIFooImplementation(void **ppv);

它返回一个 HRESULT（你也需要了解这些），并且还会在你提供的用于接收 IFoo 接口指针的位置返回一个 *pv。（我正在略读，这里需要您需要更仔细的细节。不要相信我的语法）您为此使用的实际函数原型也在 *.h 文件中声明。

4.  关键是工厂入口，它始终是一个未修饰的 extern "C"，它完成了所有必要的包装类创建，然后将 Ifoo 接口指针传递到您指定的位置。这意味着用于创建类的所有内存管理以及用于完成它的所有内存管理等都将在您构建包装器的 DLL 中进行。这是您必须处理这些细节的唯一地方。

5.  当您从工厂函数中获得 OK 结果时，您已经获得了一个接口指针，并且它已经为您保留（已经为您提供的接口指针执行了一个隐式 IFoo:Addref 操作）。

6.  完成接口后，通过调用接口的 IFoo:Release 方法释放它。它是最终版本实现（如果您制作了更多 AddRef'd 副本），它将拆除工厂 DLL 中的类及其接口支持。无论包含工厂函数的 DLL 是否使用与调用代码相同的库，这都是让您正确依赖接口后一致的动态存储分配和释放的原因。

7.  您可能也应该实现 IUnknown:QueryInterface（作为方法 IFoo:QueryInterface），即使它总是失败。如果您想在使用 COM 二进制接口模型时更加复杂，因为您有更多经验，您可以学习提供完整的 QueryInterface 实现。

这可能是太多的信息，但我想指出，你面临的关于 DLL 的异构实现的很多问题都在 COM 二进制接口的定义中得到解决，即使你不需要所有这些，它提供可行的解决方案这一事实很有价值。根据我的经验，一旦你掌握了这一点，你将永远不会忘记它在 C++ 和 C++ 互操作情况下的强大功能。

I haven't sketched the resources you might need to consult for examples and what you have to learn in order to make *.h files and to actually implement factory-function wrappers of the libraries you want to share. If you want to dig deeper, holler.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-01T14:44:40.393

您还需要考虑其他一些事情，例如各种库正在使用哪些运行时。如果没有对象被共享，那很好，但乍一看似乎不太可能。
Chris Becker 的建议非常准确——使用*实际*的COM 接口可以帮助您获得所需的二进制兼容性。你的旅费可能会改变 ：）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-01T15:07:56.430

不好玩，伙计。你很沮丧，你应该给这个：

> 唯一的解决方案是使用对象的处理程序编写 C 风格的 DLL 接口，还是我遗漏了什么？在那种情况下，我想，直接使用封装的 C 库可能会更省力。

仔细一看。祝你好运。

# c# - 如何配置 SWFUpload 以使用 ASP.NET C# WebService？

> ID：331049
> 
> 赞同：1
> 
> 时间：2008-12-01T14:40:12.163
> 
> 标签：c#, asp.net

我正在尝试将 SWFUpload 与 ASP.NET Web 窗体项目一起使用。我需要到达 Request.Files[0] 但我不能在我的 WebService 中这样做！

有人知道解决这个问题的方法吗？

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-12-01T15:01:44.773

据我所知，SWFUpload 是一个 JS/Flash 前端控件，旨在用于表单，而不是 Web 服务。我的猜测是，如果您最终需要将文件发送到 Web 服务，您将需要一个中间页面来进行上传并提交给该服务。

# javascript - 如何调整html画布元素的大小？

> ID：331052
> 
> 赞同：55
> 
> 时间：2008-12-01T14:40:34.270
> 
> 标签：javascript, html, canvas, dhtml

我在 html 中静态定义了一个具有宽度和高度的画布元素。如果我尝试使用 JavaScript 动态调整它的大小（设置新的宽度和高度 - 在画布的属性上或通过样式属性）我在 Firefox 中收到以下错误：

> 未捕获的异常：[异常...“对 WrappedNative 原型对象的非法操作”nsresult：“0x8057000c (NS_ERROR_XPC_BAD_OP_ON_WN_PROTO)”位置：“JS 框架 :: file:///home/russh/Desktop/test.html :: onclick ::第 1 行”数据：无]

是否可以调整这个元素的大小，或者我必须销毁它并动态创建一个新元素？

* * *

## 回答 #1

> 赞同：74
> 
> 时间：2008-12-01T17:02:01.847

你没有发布你的代码，我怀疑你做错了什么。可以通过使用数字分配宽度和高度属性来更改大小：

```
canvasNode.width  = 200; // in pixels
canvasNode.height = 100; // in pixels 
```

至少它对我有用。确保您没有指定字符串（例如，“2cm”、“3in”或“2.5px”），并且不要弄乱样式。

实际上这是一个公开的知识——你可以在[HTML canvas 规范](http://www.whatwg.org/specs/web-apps/current-work/#the-canvas-element)中阅读所有关于它的信息——它非常小而且信息量非常大。这是整个 DOM 接口：

```
interface HTMLCanvasElement : HTMLElement {
           attribute unsigned long width;
           attribute unsigned long height;

  DOMString toDataURL();
  DOMString toDataURL(in DOMString type, [Variadic] in any args);

  DOMObject getContext(in DOMString contextId);
}; 
```

如您所见，它定义了 2 个属性`width`和`height`，它们都是`unsigned long`.

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2011-12-01T22:46:59.673

请注意，如果您的画布是静态声明的，则应使用`width`and`height`属性，而不是样式，*例如。*这将起作用：

```
<canvas id="c" height="100" width="100" style="border:1px"></canvas>
<script>
    document.getElementById('c').width = 200;
</script> 
```

但这**不起作用**：

```
<canvas id="c" style="width: 100px; height: 100px; border:1px"></canvas>
<script>
    document.getElementById('c').width = 200;
</script> 
```

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2011-04-02T15:12:12.507

我刚刚遇到了和你一样的问题，但是发现了 toDataURL 方法，它被证明是有用的。

它的要点是将你当前的画布变成一个 dataURL，改变你的画布大小，然后从你保存的 dataURL 中将你的内容重新绘制到画布中。

所以这是我的代码：

```
var oldCanvas = canvas.toDataURL("image/png");
var img = new Image();
img.src = oldCanvas;
img.onload = function (){
    canvas.height += 100;
    ctx.drawImage(img, 0, 0);
} 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2013-02-04T08:24:42.193

```
<div id="canvasdiv" style="margin: 5px; height: 100%; width: 100%;">
    <canvas id="mycanvas" style="border: 1px solid red;"></canvas>
</div>
<script>
$(function(){
    InitContext();
});
function InitContext()
{
var $canvasDiv = $('#canvasdiv');

var canvas = document.getElementById("mycanvas");
canvas.height = $canvasDiv.innerHeight();
canvas.width = $canvasDiv.innerWidth();
}
</script> 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2008-12-01T17:04:09.610

这刚刚对我有用：

```
<canvas id="c" height="100" width="100" style="border:1px solid red"></canvas>
<script>
var c = document.getElementById('c');
alert(c.height + ' ' + c.width);
c.height = 200;
c.width = 200;
alert(c.height + ' ' + c.width);
</script> 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2011-11-15T21:18:03.803

这是我提供更完整答案的努力（基于@john 的答案）。

我遇到的最初问题是更改画布节点的宽度和高度（使用样式），导致内容只是“缩放”或“缩小”。这不是预期的效果。

因此，假设您想在 100 x 100 像素的画布中绘制两个任意大小的矩形。

```
<canvas width="100" height="100"></canvas> 
```

为确保矩形不会超过画布的大小并因此不可见，您需要确保画布足够大。

```
var $canvas = $('canvas'),
    oldCanvas,
    context = $canvas[0].getContext('2d');

function drawRects(x, y, width, height)
{
  if (($canvas.width() < x+width) || $canvas.height() < y+height)
  {
    oldCanvas = $canvas[0].toDataURL("image/png")
    $canvas[0].width = x+width;
    $canvas[0].height = y+height;

    var img = new Image();
    img.src = oldCanvas;
    img.onload = function (){
      context.drawImage(img, 0, 0);
    };
  }
  context.strokeRect(x, y, width, height);
}

drawRects(5,5, 10, 10);
drawRects(15,15, 20, 20);
drawRects(35,35, 40, 40);
drawRects(75, 75, 80, 80); 
```

最后，这是 jsfiddle：http: [//jsfiddle.net/Rka6D/4/](http://jsfiddle.net/Rka6D/4/)。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-01-15T01:42:17.167

Prototypes can be a hassle to work with, and from the `_PROTO` part of the error it appears your error is caused by, say, `HTMLCanvasElement.prototype.width`, possibly as an attempt to resize all the canvases at once.

As a suggestion, if you are trying to resize a number of canvases at once, you could try:

```
<canvas></canvas>
<canvas></canvas>
<canvas></canvas>
<script type="text/javascript">
    ...
</script> 
```

In the JavaScript, instead of invoking a prototype, try this:

```
$$ = function(){
    return document.querySelectorAll.apply(document,arguments);
}
for(var i in $$('canvas')){
    canvas = $$('canvas')[i];
    canvas.width = canvas.width+100;
    canvas.height = canvas.height+100;
} 
```

This would resize all the canvases by adding 100 px to their size, as is demonstrated in [this example](http://jsfiddle.net/aP8Jm/)

* * *

Hope this helped.

# solaris - 如何让 nano/pico 在 OpenSolaris 上运行？

> ID：331053
> 
> 赞同：1
> 
> 时间：2008-12-01T14:40:44.423
> 
> 标签：solaris, opensolaris

我们正在 Amazon 的 EC2 服务上设置 OpenSolaris 服务器。但是，vi/vim 不能正常工作，并且 pkg 没有 nano/pico。

可能还有其他文本编辑器吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-01T18:18:40.383

听起来您可能只需要设置适当的术语类型即可使 vi 正常工作。查看“TERM”环境变量选项，也许其中之一会对您有所帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-01T14:43:50.097

您可以尝试将 nano 二进制文件（或编译源代码）复制到您的用户帐户并从那里运行它。它在类似的情况下对我有用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-01T15:04:34.407

你看过[http://www.sunfreeware.com/](http://www.sunfreeware.com/)吗？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-24T05:02:22.550

SUN 正在开发 SUNWgnu-nano 包，以便将其包含在下一个版本中。同时，您可以自己编译 nano 源代码。它对我有用。要编译，请按照下列步骤操作：

1.  确保安装 SUNWgcc 软件包以便安装 gcc。
2.  从 debian 发行版下载源代码包。 [http://packages.debian.org/source/stable/nano](http://packages.debian.org/source/stable/nano)

3.  使用“gunzip xxxx.tar.gz”解压缩包，其中 xxxx.tar.gz 是您下载的源包。

4.  使用 'tar -xf xxxx' 解压包，其中 xxxx 是解压缩的源包。

5.  转到源文件夹。执行 './configure' 为您的系统创建 make 文件。

6.  键入“make”以创建二进制文件
7.  'nano' 二进制文件应位于 src 子文件夹中。将此复制到“/usr/bin”。并为“pico”创建一个软链接，即“ln -s /usr/bin/nano pico”

测试一下！

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-17T23:03:24.653

1) 打开包管理器 (System > Administration > Package Manager) 2) 打开存储库设置 (Settings > Manage Repositories) 3) 添加 Blastwave 存储库（名称：blastwave，URL：[http](http://blastwave.network.com:10000) ://blastwave.network.com:10000 ) 4) 选择右上角的存储库 5) 搜索包“IPSnano” 6) 选择包 7) 按“安装/更新”

8) 修改您的路径以包含 /opt/csw/bin (例如 $ vi ~/.profile 然后将上面的行添加到您的路径中) 9) 注销并再次反映更改

检查是否使用了正确版本的 nano：$ which nano

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-12T17:13:55.197

看起来 Nano 和 Pico 都可以在此处的“待处理”存储库中作为自动生成的包使用：http: [//pkg.opensolaris.org/pending/en/index.shtml](http://pkg.opensolaris.org/pending/en/index.shtml)。我认为他们正在等待有人遵循验证步骤并保证他们工作。然后可以将它们移动到 contrib 存储库。您可以在此处阅读更多信息：http: [//opensolaris.org/os/community/sw-porters/](http://opensolaris.org/os/community/sw-porters/)。

# c++ - 匿名命名空间数据何时初始化？

> ID：331068
> 
> 赞同：4
> 
> 时间：2008-12-01T14:48:07.607
> 
> 标签：c++, namespaces

我一直在使用匿名命名空间来存储本地数据和函数，想知道数据何时初始化？是应用程序以与静态数据相同的方式启动还是依赖于编译器？例如：

```
// foo.cpp
#include "foo.h"

namespace {

const int SOME_VALUE = 42;

}

void foo::SomeFunc(int n)
{
    if (n == SOME_VALUE)
    {
        ...
    }
} 
```

问题出在使一些代码线程安全。在上面的示例中，我需要确定`SOME_VALUE`在第一次调用 SomeFunc 之前已初始化。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-12-01T15:19:53.613

C++ 标准，**3.6.2/1**：

> 零初始化和用常量表达式初始化统称为静态初始化；所有其他初始化都是动态初始化。使用常量表达式 (5.19) 初始化的具有静态存储持续时间的 POD 类型 (3.9) 的对象应在任何动态初始化发生之前进行初始化。在同一翻译单元的命名空间范围内定义的静态存储持续时间并动态初始化的对象应按照其定义在翻译单元中出现的顺序进行初始化。

这实际上意味着，即使另一个翻译单元从外部调用您的 SomeFunc 函数，您的 SOME_VALUE 常量也将始终正确初始化，因为它是使用*常量表达式*初始化的。

尽早（在 main 之前）调用函数的唯一方法是在使用动态初始化初始化对象时。但是到那时，根据标准报价，您的 POD 变量的初始化已经完成。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-01T14:51:55.823

在这种特殊情况下（全局变量为 const），该变量在编译时被“初始化”。

SOME_VALUE 始终等于 42。

事实上，大多数（全部？）编译器实际上会像硬编码一样编译它：

```
void foo::SomeFunc(int n)
{
    if (n == 42)
    {
        ...
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-01T14:52:14.277

命名空间与初始化时间无关。命名空间所做的只是更改属于它的名称。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-01T14:52:05.167

有关您的实际问题的正确答案，请参阅 Mathieu 的答案。

但是请注意，匿名命名空间不会影响全局和/或静态对象生命周期的开始和结束。换句话说，你和使用普通的旧全局变量一样容易受到[静态初始化顺序问题的影响。](http://www.parashift.com/c++-faq-lite/ctors.html#faq-10.12)

该链接还提供了一些关于避免该问题的提示，在下一个主题中使用“首次使用时构建”。

# java - 如何在无状态会话 bean 中获取用户信息

> ID：331069
> 
> 赞同：1
> 
> 时间：2008-12-01T14:48:19.480
> 
> 标签：java, jakarta-ee, ejb

我正在开发一个现有的 j2ee 应用程序，并且需要从代码中删除一些供应商特定的方法调用。

会话外观背后的 daos 调用 ejb 容器以获取用户的 id 和密码 - 以便连接到数据库。用于连接服务器的 initialContext 的用户 ID 和密码部分。

我能够使用`sessionContext.getCallerPrincipal()`

有没有办法`SECURITY_CREDENTIALS`在服务器连接上使用，或者，有没有办法将信息从服务器连接传递到 ejbs（它们都是无状态会话 bean）。

这是一个具有富客户端和 Web 前端的大型应用程序，在完美的世界中，我很乐意返回并重新构建整个解决方案以使用 J2EE 安全性等 - 但不幸的是，这并不现实。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-01T18:01:48.810

我不能给你一个通用的解决方案，但这对我们有用。我们让应用服务器以特定用户身份连接到 LDAP，该用户能够为其他用户请求凭据。然后我们有一些通用的安全代码，我们可以使用它们从会话 bean 内部请求用户凭据，基于用户初始登录时的身份（就像您通过 执行它一样`getCallerPrincipal()`）。

我们还将用户身份放置在线程局部变量中，这样从 EJB 沿调用链向下的类不必是“容器感知的”。他们只需从线程本地访问身份并使用安全类来查找用户配置文件信息。这也使得更改测试的实现变得容易，甚至是 LDAP 查找以外的东西。

我们创建的其他便利`JDBCServiceLocator`是检索与当前用户的用户/密码的连接。因此，开发人员根本不必显式地编写安全查找代码。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-01T19:48:14.210

罗宾，

听起来像我的计划。我想我会在成功连接服务器后立即拨打电话，将凭据加载到我的连接类上的 threadLocal 变量中。我希望有一种更简单的方法——但我想没有。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-01T17:07:46.860

通常，出于安全原因，Java EE 安全模型不允许检索用户密码。但这取决于实施。一些供应商提供检索此类信息的方法，但如果您依赖此类实现，请注意应用程序的可移植性将受到影响。

一种常见的方法是编写一个 servlet 过滤器来拦截登录请求并保存凭据的副本，以供以后使用。如果您的应用程序不使用 Java EE 安全基础架构，那么这很容易实现。这是因为某些供应商阻止您过滤身份验证 servlet。

# asp.net - IIS7 和 Vista 上 ASP .NET 2 的 URL 重写问题

> ID：331070
> 
> 赞同：3
> 
> 时间：2008-12-01T14:48:37.310
> 
> 标签：asp.net, iis-7, windows-vista, url-rewriting

我有一个在 ASP .NET 2/IIS7/Vista 下运行的网站。我有一个 URL 重写模块，它允许我拥有无扩展名的 URL。为了让它工作，我配置了配置文件的 system.webServer 部分，以便所有请求都转发到 aspnet_isapi.dll。我还将 URL 重写模块添加到模块部分并将 runAllManagedModulesForAllRequests 设置为 true。

当我启动网站并访问使用 URL 重写的页面之一时，该页面会正确呈现。但是，如果我然后访问另一个页面，该站点将停止工作并且我得到一个 404 未找到。我还发现我在 URL 重写模块中的断点没有被命中。这几乎就像 IIS 将第一个请求转发给重写器，但随后的请求转到其他地方 - 错误页面将 Notification 提到为 MapRequestHandler，将 Handler 称为 StaticFile。

如果我随后对 web.config 文件进行小改动并保存它，触发网站重新启动，然后我可以在浏览器中重新加载页面并且一切正常。然后我点击另一个链接，它又坏了。

作为记录，这里有几个来自配置文件的片段。首先，在system.web下：

```
<httpModules>
  <add name="UrlRewriteModule" type="Arcs.CoopFurniture.TelesalesWeb.UrlRewriteModule, Arcs.CoopFurniture.TelesalesWeb" />
</httpModules> 
```

然后，在 system.webServer 下：

```
<system.webServer>
  <modules runAllManagedModulesForAllRequests="true">
    <add name="UrlRewriteModule" type="Arcs.CoopFurniture.TelesalesWeb.UrlRewriteModule, Arcs.CoopFurniture.TelesalesWeb" preCondition="managedHandler" />
  </modules>
  <handlers>
    <add name="AspNet" path="*" verb="*" modules="IsapiModule" scriptProcessor="%windir%\Microsoft.NET\Framework\v2.0.50727\aspnet_isapi.dll" resourceType="Unspecified" requireAccess="None" preCondition="classicMode,runtimeVersionv2.0,bitness32" />
  </handlers>
  <validation validateIntegratedModeConfiguration="false" />
</system.web> 
```

该站点在经典而不是集成管道模式下运行。

有没有人有任何想法？我怀疑我的配置在某处有问题，但我似乎找不到在哪里。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-12-01T14:57:28.977

这有点远，但是您是否尝试过在 IIS 中实际进行配置更改？

我知道 web.config 方式应该是 100% 万无一失的，但我已经看到一些事情，它有助于在 IIS 中对其进行配置以使其正常工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-01T17:39:09.493

您可能还想查看新的 IIS7 重写模块。你可以在这里阅读更多关于它的信息[http://learn.iis.net/page.aspx/460/using-url-rewrite-module/](http://learn.iis.net/page.aspx/460/using-url-rewrite-module/)，但它可能会比你自己开发的 ISAPI 过滤器更可靠

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-01T17:41:02.237

试试[http://www.codeplex.com/urlrewriter](http://www.codeplex.com/urlrewriter)它支持所有 Apache mod_rewrite 语法，还支持反向代理。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-01T18:04:11.923

1.  如果您在经典管道模式下运行，则不需要`<system.webServer>`部分，它是集成模式所必需的
2.  启用通配符脚本映射

    1.  打开 IIS7 管理器并导航到您的站点

    2.  单击处理程序映射

    3.  在操作面板中单击“添加通配符脚本映射”

    4.  在对话框中指向 aspnet_isapi.dll

    5.  在要求您确认映射的消息框中单击是

    6.  在操作面板中单击“查看有序列表”并将您的 WildcardScriptMap 移动到 StaticFile Handler 之前

这应该足够了。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-15T17:23:00.363

我很惭愧地承认这一点，但这是我的一个简单错误:-(

在我的 URL 重写模块中，重写请求路径的代码位于 Init 方法中，而它本应位于 Application.BeginRequest 处理程序中。这就解释了为什么重写只在网站第一次被击中时起作用。

很抱歉浪费了大家的时间！

# oracle - 加快对 Oracle 的 NHibernate 调用？

> ID：331073
> 
> 赞同：0
> 
> 时间：2008-12-01T14:50:13.453
> 
> 标签：oracle, nhibernate

使用 NHibernate 连接到 Oracle 时是否需要考虑任何优化？我打电话给 Oracle 需要很长时间。如果我直接对 Oracle 运行 NHibernate 查询（从 Visual Studio 中的输出窗口复制），它会在一秒钟内返回。这是我的 NHibernate 配置文件。如果需要，我可以发布映射文件。

```
<?xml version="1.0" encoding="utf-8" ?>
<hibernate-configuration xmlns="urn:nhibernate-configuration-2.2">
    <session-factory name="DefaultSessionFactory">
        <property name="connection.provider">NHibernate.Connection.DriverConnectionProvider</property>
        <property name="dialect">NHibernate.Dialect.OracleDialect</property>
        <property name="connection.driver_class">NHibernate.Driver.OracleClientDriver</property>
        <property name="connection.connection_string">Data Source=****;Persist Security Info=True;User ID=******;Password=*******;Unicode=True</property>
        <property name="show_sql">true</property>
        <mapping assembly="AQTool.BL"/>
    </session-factory>
</hibernate-configuration> 
```

更新：在这里总结所有讨论：

如果我删除所有多对一关系并仅针对没有连接的单个实体运行单元测试，则查询仍会运行 2 分钟以上。如果我复制 nhibernate 生成的 sql 并直接针对 oracle 运行它，查询会在一秒钟内返回。我也在这里发布我的映射文件。我有什么遗漏可能导致这种差异的吗？我唯一要做的就是按帐户 ID 选择。虽然表很大（超过 5M 行），但客户帐户 id 字段已编入索引，原始查询很快就会返回。

```
<?xml version="1.0" encoding="utf-8" ?>
<hibernate-mapping xmlns="urn:nhibernate-mapping-2.2" namespace="AQTool.BL" assembly="AQTool.BL" default-lazy="true">
    <class name="AQTool.BL.EmailAddress,AQTool.BL" table="EMAIL_CUSTOMER_ADDRESSES">
        <id name="EmailAddressId" column="EMAIL_ADDRESS_ID" type="int">
            <generator class="native" />
        </id>
        <property name="CustomerAccountId" column="CUSTOMER_ACCOUNT_ID" type="string" />
        <property name="EmailAddressText" column="EMAIL_ADDRESS_TX" type="string" />
        <property name="EmailAddressTypeId" column="EMAIL_ADDRESS_TYPE_ID" type="int" />
        <property name="EmailAddressTypeIdInternal" column="EMAIL_ADDRESS_TYPE_ID_INTERNAL" type="int" />

    </class>
</hibernate-mapping> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-01T15:27:29.853

您可以考虑使用此工具来“调试 NHibernate” [NHibernate 查询分析器](http://ayende.com/projects/nhibernate-query-analyzer.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-01T15:30:31.343

确保您的连接池足够大。此外，如果您尝试调试代码，您应该能够看到 Hibernate 大部分时间都花在了哪里。正如之前有人评论的那样，可能与处理结果有关，尤其是在您有级联关系的情况下。如果这样做，请尝试使用 subselect 而不是lazy=false 或 fetch=join 运行这些查询，因为这可能会明显更快。

> ID：331082
> 
> 赞同：
> 
> 时间：
> 
> 标签：

None

# asp.net - gridview 控件上的行索引 - VS 2008

> ID：331084
> 
> 赞同：1
> 
> 时间：2008-12-01T14:53:16.583
> 
> 标签：asp.net

使用绑定到 sql 数据源的 gridview 控件，我想显示一个名为 ID 的列。ID 应显示每行的行号。我将如何将其绑定到 rowindex 而不是数据库中的 ID 列？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-01T15:08:24.353

为此，我将使用 SQL Server 2005 中新增的 ROW_NUMBER() 函数。此函数返回正在返回的记录集中的行号。ScottGu有一篇[很棒的帖子](http://weblogs.asp.net/scottgu/archive/2006/01/01/434314.aspx)。HTH，阀门。

# apache-flex - List 组件上的 itemRollOver 和 itemRollOut 事件的问题

> ID：331105
> 
> 赞同：2
> 
> 时间：2008-12-01T15:03:11.430
> 
> 标签：apache-flex, events, flex3, adobe

我已经在 List 组件上设置了`itemRollOver`和`itemRollOut`事件侦听器，但是每当我将鼠标滚动到列表项上时，同一个列表项的 over 和 out 事件都会依次触发。我的列表使用自定义 itemRenderer。

任何想法为什么会这样？Adobe 文档没有提供对此的深入了解（不足为奇......）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-13T18:55:46.597

在我看来，这是一个错误。ListBase.mouseOverHandler 现在在调度 ITEM_ROLL_OVER 事件时设置一个名为 lastHighlightItemRendererAtIndices 的变量，然后在 ListBase.clearHighlight（由 mouseOutHandler 调用）中调度 ITEM_ROLL_OUT 事件时使用该变量（与 lastHighlightItemIndices 一起）。

问题是，当您逐行使用鼠标时，首先调用 mouseOverHandler，设置 lastHightlight... 变量，然后当随后调用 mouseOutHandler 时，它使用刚刚设置的 lastHighlight... 值结果是您会为同一渲染器获得连续的“翻转”和“推出”事件。

坦率地说，我不知道为什么 ListBase.clearHighlight 在调度 ITEM_ROLL_OUT 事件时不使用传入的渲染器（这是它在 SDK 2 中的工作方式），因为这是正在“推出”的实际渲染器.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-01T15:35:01.787

它们来自同一个物体吗？如果不是，您很可能会从刚刚离开的“项目”中获得 itemRollOut，从您输入的新项目中获得 itemRollOver，这取决于它们的间距，因此它们可能彼此非常接近。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-13T07:42:08.390

如果要覆盖 set data()，请确保在项目渲染器中设置**super.data 。**

ListBase 监听 MOUSE_OVER，然后根据鼠标的坐标和项目渲染器的位置找出它下面的项目。您可以检查 ListEvent.itemRenderer 以查看哪个渲染器的翻转和滚动正在触发以及以什么顺序触发。

最坏的情况是，您可以在项目渲染器中监听 rollOver 和 rollOut。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-04T22:20:19.117

有同样的问题。super.data 已经被设置，并且该项目对于 rollOut 和 rollOver 事件是相同的。我最终选择了 anirudhsasikumar 的最坏情况，并在项目渲染器中监听了 rollOver 和 rollOut。似乎工作正常。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-07-24T18:56:58.770

我遇到了同样的问题。我最终继承了 mx.controls.List 类并覆盖了 clearHighlight 函数。据我所知，lastHighlightItemIndices 变量只能在该函数中读取。因此，执行以下操作可以解决此问题：

```
import mx.core.mx_internal;

use namespace mx_internal;

public class List extends mx.controls.List
{
    public function List()
    {
        super();
    }

    override mx_internal function clearHighlight( item:IListItemRenderer ):void
    {
        var uid:String = itemToUID( item.data );

        drawItem( UIDToItemRenderer( uid ), isItemSelected( item.data ), false, uid == caretUID );

        var pt:Point = itemRendererToIndices( item );

        if( pt )
        {
            var listEvent:ListEvent = new ListEvent( ListEvent.ITEM_ROLL_OUT );

            listEvent.columnIndex = item.x;
            listEvent.rowIndex = item.y;
            listEvent.itemRenderer = item;

            dispatchEvent( listEvent );
        }
    }
} 
```

然后只需使用这个 List 类而不是 Adob​​e 类，你就会得到你所期望的行为。我针对 Flex SDK 3.2 进行了测试，它可以工作。

```
<mx:Canvas xmlns:mx="http://www.adobe.com/2006/mxml" xmlns:controls="com.example.controls.*">

    [ other code ... ]

    <controls:List itemRollOver="onItemRollOver( event )" itemRollOut="onItemRollOut( event )" />

</mx:Canvas> 
```

感谢 Gino Basso 在上面的帖子中提出的想法。希望有帮助。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-03-03T18:09:21.723

感谢您的解决方案。这真的解决了问题！不过，小修正：

```
listEvent.columnIndex = item.x;
listEvent.rowIndex = item.y; 
```

应该

```
listEvent.columnIndex = pt.x;
listEvent.rowIndex = pt.y; 
```

item.x and y hold the coordinate of the renderer in pixels.

# ruby-on-rails - 如何选择一个模型并坚持这个选择？

> ID：331109
> 
> 赞同：2
> 
> 时间：2008-12-01T15:04:03.643
> 
> 标签：ruby-on-rails, ruby

我有一个简单的模型`Party`，它带有一个名为`parties`. 还有一个控制器，包含所有常见的 CRUD 操作等。此模型用于网站，只有一个管理员用户可以编辑各方 - 其他所有人都可以调用 GET 操作（索引、显示）。到目前为止没有什么特别的。

现在我需要执行以下操作：管理员想一次选择一个派对进行特殊演示（所选派对显示在应用程序的起始页上）。最重要的是，选择的时间只有一个派对。

你将如何解决这个问题？派对模型中的布尔标志？将选择（聚会的 ID）保存在数据库之外的某个地方？实现一个与 Party 有 has_one 关系的新模型（对我来说似乎有点矫枉过正）？

我希望我的解释足以理解这个问题。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-01T15:16:02.870

一个简单的“front_page”属性就足够了，或者像你提到的另一个模型，使用 has_one 关系也可以。

使用另一种模型可以让您保留更多信息，例如它应该在首页上保留多长时间（到期日期？）或它被推荐的次数（假设一个派对可以被推荐两次）。这实际上取决于您系统的其他要求。

您也可以使用单例模式的简单实现来摆脱困境。Rails Wiki 上有一个关于使 ActiveRecord 对象成为 Singleton 的快速描述（见下文）：[http ://wiki.rubyonrails.org/rails/pages/TipsAndTricks](http://wiki.rubyonrails.org/rails/pages/TipsAndTricks)

**制作单例 ActiveRecord 对象**

> 如果您有一个只有一个条目的表，对于跟踪没有序列的数据库的数字序列很有用，您可以使用 ruby​​ 包含的单例模块，如下所示：

```
require 'singleton'

class Master < ActiveRecord::Base
  include Singleton
  def initialize(args=nil) super(args) if record = Master.find(:first)    
    self.attributes = record.attributes end end def next_tracking_number increment!
    (:current_tracking_number) current_tracking_number end def 
    self.next_tracking_number instance.next_tracking_number 
  end
end 
```

**更新：**

这是一个非常糟糕的代码示例（从没有格式的 Rails Wiki 复制和粘贴）。我强烈推荐 [Ruby Design Patterns] 这本书，它更详细地处理了许多 GoF 设计模式（同时使它们适用于 Ruby 应用程序）。但是[Google](http://www.google.com/search?q=Ruby+singleton&ie=utf-8&oe=utf-8&aq=t&rls=org.mozilla:en-US:official&client=firefox-a)应该为您返回一些在 Ruby 中使用 Singleton 模式的好资源。[2](http://www.google.com/search?q=Ruby+singleton&ie=utf-8&oe=utf-8&aq=t&rls=org.mozilla:en-US:official&client=firefox-a)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-01T15:12:00.820

我会选择布尔标志并创建嵌套的单例资源（已升级），我将在 PartyController 本身（`set_promoted_party and get_promoted_party actions`）中实现它。为此，我将创建两条新路线：

```
PUT /parties/promoted/:party_id # to set the promoted party
GET /parties/promoted/:party_id # to get the promoted_party 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-01T15:32:34.570

我将添加第二个具有 has_one 关系的模型，以保持应用程序 RESTful 和简单。此外，通过这种方式，您可以保留特殊方的历史记录，并跟踪与特殊方相关的其他有意义的信息。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-01T15:16:01.513

就我个人而言，我非常重视我的数据库强制执行的数据完整性，因此可能会添加那个额外的表并将其作为外键约束强制执行。这看起来有点矫枉过正，但它是唯一能防止数据完整性问题的*解决方案。

您能否将其作为字段添加到管理表/模型中 - 这将是派对表的强制外键？

*另一个解决方案是一个数据库触发器，它检查没有其他行是选定的一方，但我倾向于回避这样的解决方案。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-01T15:43:45.843

把事情简单化。将`promoted_party.yml`文件放入控制器写入和读取的配置目录中。内容可以很简单：

```
--- 
party_id: 123 
```

完毕。如果您以后需要更多的诚信或更好的关系，请稍后实施，而不是现在。

对于部署，只需确保文件符号链接到共享目录以在应用程序升级后继续存在。

# oracle - 网络中断导致跨数据库链接的存储过程查询永远挂起

> ID：331114
> 
> 赞同：0
> 
> 时间：2008-12-01T15:06:03.140
> 
> 标签：oracle, plsql, timeout, locking, database-link

我支持通过 WAN 查询远程数据库的一些存储过程。网络偶尔会出现故障，但最糟糕的是程序失败并且必须重新启动。

在过去的几周里，情况发生了险恶的转折。而不是失败的程序挂在一个奇怪的锁定状态。它们不能在 Oracle 内部被杀死，只要它们存在，任何运行该过程的其他副本的尝试也会挂起。我们找到的唯一解决方案是使用操作系统中的“kill -9”来终止有问题的程序。其中一些程序几个月甚至几年都没有改变，所以我怀疑数据库或数据库配置中的根本原因。

任何人都知道我们可以做些什么来解决这个问题？或者 PL/SQL 是否具有可以添加到代码中的超时机制，以便我可以创建一个可以以编程方式处理的异常？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-01T19:47:52.557

什么数据库版本？他们是卡在运行 SQL 还是在 PL/SQL 中？最近有没有人在例程中添加异常处理？我记得在 9iR2 中，我们被告知，或者向调用例程引发异常，我们将捕获所有异常并继续运行（基本上尝试运行处理作业中的所有项目，即使有些项目失败）。我们不可避免地让作业陷入无限循环，SQL 失败，被异常处理程序捕获并重试。他们不能被杀死，因为 WHEN OTHERS 也捕获了“你的会话已被杀死”异常。我认为后者在 10g 中发生了变化，因此没有捕获到异常。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-02T14:25:54.420

我们永远无法确定是什么导致了这种情况发生。我们认为这是 2008 年 10 月累积补丁中的一个缺陷。也许以后的补丁会修复它。这已经有几个月没有发生了（而且我们遇到了一些网络中断），所以希望问题已经消失了。

# mysql - MySql 索引填充因子？

> ID：331115
> 
> 赞同：5
> 
> 时间：2008-12-01T15:06:05.403
> 
> 标签：mysql, indexing, fillfactor

在 MySql 中创建索引时如何指定填充因子？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-12-01T15:12:30.773

你没有。

[http://dev.mysql.com/doc/refman/5.0/en/create-index.html](http://dev.mysql.com/doc/refman/5.0/en/create-index.html)

但是，它是 6.x 版的“已接受”功能请求： [http ://bugs.mysql.com/bug.php?id=18178](http://bugs.mysql.com/bug.php?id=18178)

所以，不要很快看到它就屏住呼吸。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-05-17T10:30:34.063

假设您使用的是 InnoDB，似乎这仅在数据库级别受支持，而不是索引级别。

调用该设置`innodb_fill_factor`并默认`100`查看 [https://dev.mysql.com/doc/refman/5.7/en/innodb-parameters.html#sysvar_innodb_fill_factor](https://dev.mysql.com/doc/refman/5.7/en/innodb-parameters.html#sysvar_innodb_fill_factor)了解更多详细信息。

# java-me - J2ME 口齿不清？

> ID：331118
> 
> 赞同：7
> 
> 时间：2008-12-01T15:06:52.110
> 
> 标签：java-me, lisp, smalltalk

如果存在运行在 J2ME 上的 lisp，那么在移动设备（而不是为移动设备）上编程似乎会更容易。

你知道任何（最好是开源的）lisp/smalltalk 应用程序吗？我在网上搜索，但找不到有效的 J2ME lisp。移植到J2ME有那么难吗？

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-09T05:01:01.937

也许这个小小的 lisp 将在 J2ME 上运行：[https ://www.iam.unibe.ch/scg/svn_repos/Sources/Cells/src/lisp/](https://www.iam.unibe.ch/scg/svn_repos/Sources/Cells/src/lisp/)

如果你试一试，让我知道它是如何工作的......

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-26T19:06:54.433

我设法让[http://norvig.com/jscheme.html](http://norvig.com/jscheme.html)在 j2me 中工作，方法是删除所有与 UI 相关的类......它工作，但我的手机太小而且我没有时间......我已经只用一些（fac n）测试它......但lisp不适合我，我没那么聪明。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-01T16:58:23.163

你可以试试[Kawa](http://www.gnu.org/software/kawa/)，但我不确定它会运行。

# visual-studio - 有没有办法有条件地运行 Visual Studio Post Build Steps

> ID：331131
> 
> 赞同：6
> 
> 时间：2008-12-01T15:10:53.443
> 
> 标签：visual-studio

我们正在寻找的是：在编译相同的配置时，比如 Release|Win32，有没有办法有时只做 postbuild 步骤。就像，如果我在开发机器上执行所有构建后步骤，或者如果我在构建服务器上，则不要执行它们。还是实现这一点的唯一方法是实施新配置？

评论者：感谢您的想法，我们不想使用脚本，因为它们需要维护，而且在这一点上访问 MSBuild proj 文件也会很头疼。谢谢你的尝试。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2008-12-01T15:30:19.893

您可以在后期构建脚本中使用环境变量。像这样的东西：

```
if NOT %ComputerName% == DEVMACHINENAME GOTO end
c:\WINDOWS\Microsoft.NET\Framework\v2.0.50727\ngen "$(TargetPath)"
:end 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-01T15:28:52.207

如果您想破解 MSBuild 本身（.*proj 文件本质上只是 MSBuild 脚本），您可以在构建后运行特定于机器的步骤：http: [//flimflan.com/blog/MachineSpecificTasksWithMSBuild.aspx](http://flimflan.com/blog/MachineSpecificTasksWithMSBuild.aspx)

> “这利用了这样一个事实，即所有环境变量都可以立即作为 MSBuild 脚本中的属性使用；并且所有 Windows 机器（我最近使用的）都设置了 COMPUTERNAME 环境变量。”

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-01T15:29:41.877

如果您不喜欢单独的构建配置（我认为这是最有意义的），您可以例如在构建服务器上定义一个环境变量，然后您可以在构建后的脚本中对其进行测试。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-01T15:30:33.887

是否可以将您的后期构建步骤实现为始终执行的外部脚本，但具有有条件地执行您需要的步骤的逻辑？

# .net - 报告查看器（SSRS 2005）更新到 .Net 3.5 时无法正确呈现

> ID：331137
> 
> 赞同：0
> 
> 时间：2008-12-01T15:13:45.543
> 
> 标签：.net, reporting-services

我遇到了 SSRS 2005 报表查看器无法在浏览器中正确呈现的问题。我们更新了调用报表的应用程序以使用 .Net 3.5 框架，并通过 URL 将报表从应用程序调用到报表服务器。

报告正确生成并且布局很好，唯一的问题是报告查看器控件（下一页/上一页、打印等）不再像以前那样显示在报告顶部的工具栏中。它们仍然出现，但没有样式并堆叠在一起。

有什么建议么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-12-08T21:48:02.530

有很多信息你没有在这里指定澄清，所以我将根据你写的内容做出以下假设：

*   您没有在 Web 应用程序中使用 Visual Studio 中的 ReportViewer 控件。
*   您正在使用 URL 访问在新窗口/弹出窗口、框架或 iframe 中访问报告（例如[http://localhost/ReportServer?MyReport&p1=a&p2=b ）。](http://localhost/ReportServer?MyReport&p1=a&p2=b)

如果是这种情况，请将以下内容附加到您的 URL 并查看是否恢复工具栏：&rs:Toolbar=true

高温高压

# asp.net - 如何将数组从 Asp.net 服务器端传递到客户端的 Javascript 函数

> ID：331146
> 
> 赞同：6
> 
> 时间：2008-12-01T15:21:10.660
> 
> 标签：asp.net, javascript

如何将我在服务器端创建的数组传递到客户端以供 Javascript 操作？

任何伪代码都会有所帮助

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-01T15:23:37.583

您需要将其作为 javascript 数组声明嵌入到页面中。有很多方法可以做到这一点，但通常意味着将数组转换为您写入页面的文本，可能使用 ClientScriptManager。

我希望在即将推出的 ASP.Net 版本中实现更好的 javascript 集成。应该通过简单的单行函数调用来支持将服务器变量（任何服务器变量）的*值*移动到客户端。不是我们现在需要的后空翻。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-01T15:26:04.753

将其转换为 javascript 数组的字符串表示形式（“['val1','val2','val3']”）并将其推入隐藏输入的值字段中。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-12-01T15:42:24.660

另一种方法是使用 Page 对象（已弃用）或 ClientScriptManager 类的 RegisterArrayDeclaration 方法。有关详细信息，请参阅[MSDN](http://msdn.microsoft.com/en-us/library/system.web.ui.clientscriptmanager.registerarraydeclaration.aspx)。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2013-09-04T08:57:45.763

我这样做的方式是这样的：

**aspx：**

```
 private string buttonarray =  "'but1','but2','but3','but4'";

    public string Buttonarray
    {
        get { return buttonarray; }
    } 
```

**javascript**

```
var buttonarray = new Array(<%=Buttonarray%>); 
```

我希望这有帮助。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-01T15:57:55.517

最简单的方法是将其转换为 json。然后只需将它放在页面顶部的变量中。我发现这是 .net 的最佳 json 实现：http: [//litjson.sourceforge.net/](http://litjson.sourceforge.net/)

# c++ - C++ 是否允许函数的默认返回类型？

> ID：331148
> 
> 赞同：6
> 
> 时间：2008-12-01T15:21:38.383
> 
> 标签：c++, c

在 C 中，以下恐怖是有效的：

```
myFunc()
{
  return 42;  // return type defaults to int.
} 
```

但是，在 C++ 中呢？无论哪种方式，我都找不到它的参考...

我的编译器（Codegear C++Builder 2007）目前在没有警告的情况下接受它，但我有评论说这***是***C++ 中的错误。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2008-12-01T15:25:36.660

它在 C++ 中格式*不正确。*这意味着它不能使用符合标准的编译器进行编译。标准附件 C 中的第**7.1.5/4**段解释了“禁止隐式 int”的变化。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2008-12-01T15:26:53.677

隐式返回类型在 C89 中有效，但许多编译器对此发出警告。

它们在 C++ 中无效，在 C99 中也无效。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-12-01T19:47:39.657

因此，它绝对是“格式错误”的 C++，但似乎许多编译器充其量只接受它并发出警告。

*   Codegear C++Builder 2007：完全没有错误或警告
*   G++：需要 -W -Wall 来生成警告，或 -pedantic 来生成错误 (Piotr)
*   MSVC 8：产生错误 ( [tfinniga](https://stackoverflow.com/questions/331148/does-c-allow-default-return-types-for-functions#332312) )
*   其他...？

请添加/更正此列表！

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-12-01T15:27:09.933

这不是合法的 C++，但一些编译器会默默地接受它，或者通过诊断接受它。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-12-01T21:29:17.173

如发布的那样，它的格式不正确。MSVC 8 给出以下错误：

```
error C4430: missing type specifier - int assumed. Note: C++ does not support default-int 
```

# visual-studio-2008 - 是否可以阻止 Visual Studio 2008 无法构建 CSS 错误？

> ID：331152
> 
> 赞同：4
> 
> 时间：2008-12-01T15:24:57.410
> 
> 标签：visual-studio-2008, css

我有一个具有特定 IE 黑客的外部样式表。由于这些黑客攻击，我的网站每隔一段时间就会无法构建（它是哈希黑客；例如**`#margin-top:-2px;`**）。这是错误：

> 意外的字符序列。需要“:”声明的属性名称

我还没有找到停止错误的具体方法，VS2008 似乎只是在一段时间后停止关心。我找到[了这篇文章](http://www.carlj.ca/2008/01/05/adding-css-colors-to-visual-studio-2005/)，但我不确定如何正确编辑文件，所以这个“错误”（因为它是合法的语法）不会再次弹出。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-12-01T15:35:52.270

我不确定 2008 年，但在 2005 年（IIRC），你可以去：

```
 Tools | Options | Text Editor | CSS | CSS Specific 
```

然后取消勾选**检测错误**

我记得在 MS 无法识别的 100% 有效 CSS 上遇到完全相同的问题（大吃一惊），轻弹这个开关并永远忘记了这个问题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-01T15:41:49.013

工具 | 选项 | 文本编辑器 | HTML | 验证

确保选中“显示错误”“作为警告”。早期有个bug，就算勾选了，也没有被确认，这种情况下，取消勾选保存设置，然后再回去重新勾选。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-01T15:27:28.357

最简单的方法是在编辑器中关闭文件，它应该停止抱怨。

# sql - SQL Server CheckSum 是否计算 CRC？如果不是，我怎样才能让 MS SQL 在任意 varchar 列上计算 CRC？

> ID：331157
> 
> 赞同：10
> 
> 时间：2008-12-01T15:26:04.740
> 
> 标签：sql, sql-server

SQL Server CheckSum 是否计算 CRC？如果不是，我怎样才能让 SQL Server 在任意 varchar 列上计算 CRC？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-01T16:50:30.590

我为模型的粗鲁道歉，但这似乎做了正确的 CRC32 计算。我不是 TSQL 专家，我相信真正的 SQL Server 专业人士可以极大地改进这一点……

@input 是计算 CRC32 的变量。将其打包为 sproc 或 udf 应该很简单，并且可以将查找表分解为永久表（甚至可以即时计算）。

无论如何，它似乎工作。我很想看到任何改进，因为学习新技巧总是好的:)

编辑：我已经对照[http://crc32-checksum.waraxe.us/](http://crc32-checksum.waraxe.us/)检查了我的结果，到目前为止看起来还不错。

安德鲁

```
DECLARE @input VARCHAR(50)
SET @input = 'test'

SET NOCOUNT ON
DECLARE @tblLookup TABLE (ID INT IDENTITY(0,1) NOT NULL, Value BIGINT)
INSERT INTO @tblLookup VALUES (0)
INSERT INTO @tblLookup VALUES (1996959894)
INSERT INTO @tblLookup VALUES (3993919788)
INSERT INTO @tblLookup VALUES (2567524794)
INSERT INTO @tblLookup VALUES (124634137)
INSERT INTO @tblLookup VALUES (1886057615)
INSERT INTO @tblLookup VALUES (3915621685)
INSERT INTO @tblLookup VALUES (2657392035)
INSERT INTO @tblLookup VALUES (249268274)
INSERT INTO @tblLookup VALUES (2044508324)
INSERT INTO @tblLookup VALUES (3772115230)
INSERT INTO @tblLookup VALUES (2547177864)
INSERT INTO @tblLookup VALUES (162941995)
INSERT INTO @tblLookup VALUES (2125561021)
INSERT INTO @tblLookup VALUES (3887607047)
INSERT INTO @tblLookup VALUES (2428444049)
INSERT INTO @tblLookup VALUES (498536548)
INSERT INTO @tblLookup VALUES (1789927666)
INSERT INTO @tblLookup VALUES (4089016648)
INSERT INTO @tblLookup VALUES (2227061214)
INSERT INTO @tblLookup VALUES (450548861)
INSERT INTO @tblLookup VALUES (1843258603)
INSERT INTO @tblLookup VALUES (4107580753)
INSERT INTO @tblLookup VALUES (2211677639)
INSERT INTO @tblLookup VALUES (325883990)
INSERT INTO @tblLookup VALUES (1684777152)
INSERT INTO @tblLookup VALUES (4251122042)
INSERT INTO @tblLookup VALUES (2321926636)
INSERT INTO @tblLookup VALUES (335633487)
INSERT INTO @tblLookup VALUES (1661365465)
INSERT INTO @tblLookup VALUES (4195302755)
INSERT INTO @tblLookup VALUES (2366115317)
INSERT INTO @tblLookup VALUES (997073096)
INSERT INTO @tblLookup VALUES (1281953886)
INSERT INTO @tblLookup VALUES (3579855332)
INSERT INTO @tblLookup VALUES (2724688242)
INSERT INTO @tblLookup VALUES (1006888145)
INSERT INTO @tblLookup VALUES (1258607687)
INSERT INTO @tblLookup VALUES (3524101629)
INSERT INTO @tblLookup VALUES (2768942443)
INSERT INTO @tblLookup VALUES (901097722)
INSERT INTO @tblLookup VALUES (1119000684)
INSERT INTO @tblLookup VALUES (3686517206)
INSERT INTO @tblLookup VALUES (2898065728)
INSERT INTO @tblLookup VALUES (853044451)
INSERT INTO @tblLookup VALUES (1172266101)
INSERT INTO @tblLookup VALUES (3705015759)
INSERT INTO @tblLookup VALUES (2882616665)
INSERT INTO @tblLookup VALUES (651767980)
INSERT INTO @tblLookup VALUES (1373503546)
INSERT INTO @tblLookup VALUES (3369554304)
INSERT INTO @tblLookup VALUES (3218104598)
INSERT INTO @tblLookup VALUES (565507253)
INSERT INTO @tblLookup VALUES (1454621731)
INSERT INTO @tblLookup VALUES (3485111705)
INSERT INTO @tblLookup VALUES (3099436303)
INSERT INTO @tblLookup VALUES (671266974)
INSERT INTO @tblLookup VALUES (1594198024)
INSERT INTO @tblLookup VALUES (3322730930)
INSERT INTO @tblLookup VALUES (2970347812)
INSERT INTO @tblLookup VALUES (795835527)
INSERT INTO @tblLookup VALUES (1483230225)
INSERT INTO @tblLookup VALUES (3244367275)
INSERT INTO @tblLookup VALUES (3060149565)
INSERT INTO @tblLookup VALUES (1994146192)
INSERT INTO @tblLookup VALUES (31158534)
INSERT INTO @tblLookup VALUES (2563907772)
INSERT INTO @tblLookup VALUES (4023717930)
INSERT INTO @tblLookup VALUES (1907459465)
INSERT INTO @tblLookup VALUES (112637215)
INSERT INTO @tblLookup VALUES (2680153253)
INSERT INTO @tblLookup VALUES (3904427059)
INSERT INTO @tblLookup VALUES (2013776290)
INSERT INTO @tblLookup VALUES (251722036)
INSERT INTO @tblLookup VALUES (2517215374)
INSERT INTO @tblLookup VALUES (3775830040)
INSERT INTO @tblLookup VALUES (2137656763)
INSERT INTO @tblLookup VALUES (141376813)
INSERT INTO @tblLookup VALUES (2439277719)
INSERT INTO @tblLookup VALUES (3865271297)
INSERT INTO @tblLookup VALUES (1802195444)
INSERT INTO @tblLookup VALUES (476864866)
INSERT INTO @tblLookup VALUES (2238001368)
INSERT INTO @tblLookup VALUES (4066508878)
INSERT INTO @tblLookup VALUES (1812370925)
INSERT INTO @tblLookup VALUES (453092731)
INSERT INTO @tblLookup VALUES (2181625025)
INSERT INTO @tblLookup VALUES (4111451223)
INSERT INTO @tblLookup VALUES (1706088902)
INSERT INTO @tblLookup VALUES (314042704)
INSERT INTO @tblLookup VALUES (2344532202)
INSERT INTO @tblLookup VALUES (4240017532)
INSERT INTO @tblLookup VALUES (1658658271)
INSERT INTO @tblLookup VALUES (366619977)
INSERT INTO @tblLookup VALUES (2362670323)
INSERT INTO @tblLookup VALUES (4224994405)
INSERT INTO @tblLookup VALUES (1303535960)
INSERT INTO @tblLookup VALUES (984961486)
INSERT INTO @tblLookup VALUES (2747007092)
INSERT INTO @tblLookup VALUES (3569037538)
INSERT INTO @tblLookup VALUES (1256170817)
INSERT INTO @tblLookup VALUES (1037604311)
INSERT INTO @tblLookup VALUES (2765210733)
INSERT INTO @tblLookup VALUES (3554079995)
INSERT INTO @tblLookup VALUES (1131014506)
INSERT INTO @tblLookup VALUES (879679996)
INSERT INTO @tblLookup VALUES (2909243462)
INSERT INTO @tblLookup VALUES (3663771856)
INSERT INTO @tblLookup VALUES (1141124467)
INSERT INTO @tblLookup VALUES (855842277)
INSERT INTO @tblLookup VALUES (2852801631)
INSERT INTO @tblLookup VALUES (3708648649)
INSERT INTO @tblLookup VALUES (1342533948)
INSERT INTO @tblLookup VALUES (654459306)
INSERT INTO @tblLookup VALUES (3188396048)
INSERT INTO @tblLookup VALUES (3373015174)
INSERT INTO @tblLookup VALUES (1466479909)
INSERT INTO @tblLookup VALUES (544179635)
INSERT INTO @tblLookup VALUES (3110523913)
INSERT INTO @tblLookup VALUES (3462522015)
INSERT INTO @tblLookup VALUES (1591671054)
INSERT INTO @tblLookup VALUES (702138776)
INSERT INTO @tblLookup VALUES (2966460450)
INSERT INTO @tblLookup VALUES (3352799412)
INSERT INTO @tblLookup VALUES (1504918807)
INSERT INTO @tblLookup VALUES (783551873)
INSERT INTO @tblLookup VALUES (3082640443)
INSERT INTO @tblLookup VALUES (3233442989)
INSERT INTO @tblLookup VALUES (3988292384)
INSERT INTO @tblLookup VALUES (2596254646)
INSERT INTO @tblLookup VALUES (62317068)
INSERT INTO @tblLookup VALUES (1957810842)
INSERT INTO @tblLookup VALUES (3939845945)
INSERT INTO @tblLookup VALUES (2647816111)
INSERT INTO @tblLookup VALUES (81470997)
INSERT INTO @tblLookup VALUES (1943803523)
INSERT INTO @tblLookup VALUES (3814918930)
INSERT INTO @tblLookup VALUES (2489596804)
INSERT INTO @tblLookup VALUES (225274430)
INSERT INTO @tblLookup VALUES (2053790376)
INSERT INTO @tblLookup VALUES (3826175755)
INSERT INTO @tblLookup VALUES (2466906013)
INSERT INTO @tblLookup VALUES (167816743)
INSERT INTO @tblLookup VALUES (2097651377)
INSERT INTO @tblLookup VALUES (4027552580)
INSERT INTO @tblLookup VALUES (2265490386)
INSERT INTO @tblLookup VALUES (503444072)
INSERT INTO @tblLookup VALUES (1762050814)
INSERT INTO @tblLookup VALUES (4150417245)
INSERT INTO @tblLookup VALUES (2154129355)
INSERT INTO @tblLookup VALUES (426522225)
INSERT INTO @tblLookup VALUES (1852507879)
INSERT INTO @tblLookup VALUES (4275313526)
INSERT INTO @tblLookup VALUES (2312317920)
INSERT INTO @tblLookup VALUES (282753626)
INSERT INTO @tblLookup VALUES (1742555852)
INSERT INTO @tblLookup VALUES (4189708143)
INSERT INTO @tblLookup VALUES (2394877945)
INSERT INTO @tblLookup VALUES (397917763)
INSERT INTO @tblLookup VALUES (1622183637)
INSERT INTO @tblLookup VALUES (3604390888)
INSERT INTO @tblLookup VALUES (2714866558)
INSERT INTO @tblLookup VALUES (953729732)
INSERT INTO @tblLookup VALUES (1340076626)
INSERT INTO @tblLookup VALUES (3518719985)
INSERT INTO @tblLookup VALUES (2797360999)
INSERT INTO @tblLookup VALUES (1068828381)
INSERT INTO @tblLookup VALUES (1219638859)
INSERT INTO @tblLookup VALUES (3624741850)
INSERT INTO @tblLookup VALUES (2936675148)
INSERT INTO @tblLookup VALUES (906185462)
INSERT INTO @tblLookup VALUES (1090812512)
INSERT INTO @tblLookup VALUES (3747672003)
INSERT INTO @tblLookup VALUES (2825379669)
INSERT INTO @tblLookup VALUES (829329135)
INSERT INTO @tblLookup VALUES (1181335161)
INSERT INTO @tblLookup VALUES (3412177804)
INSERT INTO @tblLookup VALUES (3160834842)
INSERT INTO @tblLookup VALUES (628085408)
INSERT INTO @tblLookup VALUES (1382605366)
INSERT INTO @tblLookup VALUES (3423369109)
INSERT INTO @tblLookup VALUES (3138078467)
INSERT INTO @tblLookup VALUES (570562233)
INSERT INTO @tblLookup VALUES (1426400815)
INSERT INTO @tblLookup VALUES (3317316542)
INSERT INTO @tblLookup VALUES (2998733608)
INSERT INTO @tblLookup VALUES (733239954)
INSERT INTO @tblLookup VALUES (1555261956)
INSERT INTO @tblLookup VALUES (3268935591)
INSERT INTO @tblLookup VALUES (3050360625)
INSERT INTO @tblLookup VALUES (752459403)
INSERT INTO @tblLookup VALUES (1541320221)
INSERT INTO @tblLookup VALUES (2607071920)
INSERT INTO @tblLookup VALUES (3965973030)
INSERT INTO @tblLookup VALUES (1969922972)
INSERT INTO @tblLookup VALUES (40735498)
INSERT INTO @tblLookup VALUES (2617837225)
INSERT INTO @tblLookup VALUES (3943577151)
INSERT INTO @tblLookup VALUES (1913087877)
INSERT INTO @tblLookup VALUES (83908371)
INSERT INTO @tblLookup VALUES (2512341634)
INSERT INTO @tblLookup VALUES (3803740692)
INSERT INTO @tblLookup VALUES (2075208622)
INSERT INTO @tblLookup VALUES (213261112)
INSERT INTO @tblLookup VALUES (2463272603)
INSERT INTO @tblLookup VALUES (3855990285)
INSERT INTO @tblLookup VALUES (2094854071)
INSERT INTO @tblLookup VALUES (198958881)
INSERT INTO @tblLookup VALUES (2262029012)
INSERT INTO @tblLookup VALUES (4057260610)
INSERT INTO @tblLookup VALUES (1759359992)
INSERT INTO @tblLookup VALUES (534414190)
INSERT INTO @tblLookup VALUES (2176718541)
INSERT INTO @tblLookup VALUES (4139329115)
INSERT INTO @tblLookup VALUES (1873836001)
INSERT INTO @tblLookup VALUES (414664567)
INSERT INTO @tblLookup VALUES (2282248934)
INSERT INTO @tblLookup VALUES (4279200368)
INSERT INTO @tblLookup VALUES (1711684554)
INSERT INTO @tblLookup VALUES (285281116)
INSERT INTO @tblLookup VALUES (2405801727)
INSERT INTO @tblLookup VALUES (4167216745)
INSERT INTO @tblLookup VALUES (1634467795)
INSERT INTO @tblLookup VALUES (376229701)
INSERT INTO @tblLookup VALUES (2685067896)
INSERT INTO @tblLookup VALUES (3608007406)
INSERT INTO @tblLookup VALUES (1308918612)
INSERT INTO @tblLookup VALUES (956543938)
INSERT INTO @tblLookup VALUES (2808555105)
INSERT INTO @tblLookup VALUES (3495958263)
INSERT INTO @tblLookup VALUES (1231636301)
INSERT INTO @tblLookup VALUES (1047427035)
INSERT INTO @tblLookup VALUES (2932959818)
INSERT INTO @tblLookup VALUES (3654703836)
INSERT INTO @tblLookup VALUES (1088359270)
INSERT INTO @tblLookup VALUES (936918000)
INSERT INTO @tblLookup VALUES (2847714899)
INSERT INTO @tblLookup VALUES (3736837829)
INSERT INTO @tblLookup VALUES (1202900863)
INSERT INTO @tblLookup VALUES (817233897)
INSERT INTO @tblLookup VALUES (3183342108)
INSERT INTO @tblLookup VALUES (3401237130)
INSERT INTO @tblLookup VALUES (1404277552)
INSERT INTO @tblLookup VALUES (615818150)
INSERT INTO @tblLookup VALUES (3134207493)
INSERT INTO @tblLookup VALUES (3453421203)
INSERT INTO @tblLookup VALUES (1423857449)
INSERT INTO @tblLookup VALUES (601450431)
INSERT INTO @tblLookup VALUES (3009837614)
INSERT INTO @tblLookup VALUES (3294710456)
INSERT INTO @tblLookup VALUES (1567103746)
INSERT INTO @tblLookup VALUES (711928724)
INSERT INTO @tblLookup VALUES (3020668471)
INSERT INTO @tblLookup VALUES (3272380065)
INSERT INTO @tblLookup VALUES (1510334235)
INSERT INTO @tblLookup VALUES (755167117)

DECLARE @crc BIGINT, @len INT, @i INT, @index INT
DECLARE @tblval BIGINT
SET @crc = 0xFFFFFFFF
SET @len = LEN(@input)
SET @i = 1

WHILE @i <= @len
BEGIN
    SET @index = ((@crc & 0xff) ^ ASCII(SUBSTRING(@input, @i, 1)))  
    SET @tblval = (SELECT Value FROM @tblLookup WHERE ID = @Index)
    SET @crc = (@crc / 256) ^ @tblval   
    SET @i = @i + 1 
END
SET @crc = ~@crc

SELECT @crc as CRC32, CONVERT(VARBINARY(4), @crc) as CRC32Hex 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-06-15T01:22:41.153

我将 Andrew Rollings 的剧本缩短到 11 行，所以他真的得到了赞誉。这将在 SQL 2008 或更高版本中运行。如果在 DECLARE 之后设置变量值，它将在 SQL 2005 中运行。在 2005 年及以后，字符限制为 2048，在 SQL 2000 中，它类似于 512（我不记得在 SQL 中有多少 P 类型的 spt_value 2000）。但这可以在必要时进行修改。

```
DECLARE @input VARCHAR(50)
SET @input = 'test'

SET NOCOUNT ON
DECLARE
    @crc bigint = 0xFFFFFFFF,
    @Lookup varbinary(2048) = 0x0000000077073096EE0E612C990951BA076DC419706AF48FE963A5359E6495A30EDB883279DCB8A4E0D5E91E97D2D98809B64C2B7EB17CBDE7B82D0790BF1D911DB710646AB020F2F3B9714884BE41DE1ADAD47D6DDDE4EBF4D4B55183D385C7136C9856646BA8C0FD62F97A8A65C9EC14015C4F63066CD9FA0F3D638D080DF53B6E20C84C69105ED56041E4A26771723C03E4D14B04D447D20D85FDA50AB56B35B5A8FA42B2986CDBBBC9D6ACBCF94032D86CE345DF5C75DCD60DCFABD13D5926D930AC51DE003AC8D75180BFD0611621B4F4B556B3C423CFBA9599B8BDA50F2802B89E5F058808C60CD9B2B10BE9242F6F7C8758684C11C1611DABB6662D3D76DC419001DB710698D220BCEFD5102A71B1858906B6B51F9FBFE4A5E8B8D4337807C9A20F00F9349609A88EE10E98187F6A0DBB086D3D2D91646C97E6635C016B6B51F41C6C6162856530D8F262004E6C0695ED1B01A57B8208F4C1F50FC45765B0D9C612B7E9508BBEB8EAFCB9887C62DD1DDF15DA2D498CD37CF3FBD44C654DB261583AB551CEA3BC0074D4BB30E24ADFA5413DD895D7A4D1C46DD3D6F4FB4369E96A346ED9FCAD678846DA60B8D044042D7333031DE5AA0A4C5FDD0D7CC95005713C270241AABE0B1010C90C20865768B525206F85B3B966D409CE61E49F5EDEF90E29D9C998B0D09822C7D7A8B459B33D172EB40D81B7BD5C3BC0BA6CADEDB883209ABFB3B603B6E20C74B1D29AEAD547399DD277AF04DB261573DC1683E3630B1294643B840D6D6A3E7A6A5AA8E40ECF0B9309FF9D0A00AE277D079EB1F00F93448708A3D21E01F2686906C2FEF762575D806567CB196C36716E6B06E7FED41B7689D32BE010DA7A5A67DD4ACCF9B9DF6F8EBEEFF917B7BE4360B08ED5D6D6A3E8A1D1937E38D8C2C44FDFF252D1BB67F1A6BC57673FB506DD48B2364BD80D2BDAAF0A1B4C36034AF641047A60DF60EFC3A867DF55316E8EEF4669BE79CB61B38CBC66831A256FD2A05268E236CC0C7795BB0B4703220216B95505262FC5BA3BBEB2BD0B282BB45A925CB36A04C2D7FFA7B5D0CF312CD99E8B5BDEAE1D9B64C2B0EC63F226756AA39C026D930A9C0906A9EB0E363F720767850500571395BF4A82E2B87A147BB12BAE0CB61B3892D28E9BE5D5BE0D7CDCEFB70BDBDF2186D3D2D4F1D4E24268DDB3F81FDA836E81BE16CDF6B9265B6FB077E118B7477788085AE6FF0F6A7066063BCA11010B5C8F659EFFF862AE69616BFFD3166CCF45A00AE278D70DD2EE4E0483543903B3C2A7672661D06016F74969474D3E6E77DBAED16A4AD9D65ADC40DF0B6637D83BF0A9BCAE53DEBB9EC547B2CF7F30B5FFE9BDBDF21CCABAC28A53B3933024B4A3A6BAD03605CDD7069354DE572923D967BFB3667A2EC4614AB85D681B022A6F2B94B40BBE37C30C8EA15A05DF1B2D02EF8D;

SELECT @crc = (@crc / 256) ^ Substring(@Lookup, ((@crc & 0xFF) ^ Ascii(Substring(@input, V.Number, 1))) * 4 + 1, 4)
FROM master.dbo.spt_values V
WHERE V.type = 'P' AND V.number BETWEEN 1 AND Len(@input)

SET @crc = ~@crc;
SELECT @crc CRC32, Convert(VARBINARY(4), @crc) CRC32Hex; 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-06-30T03:24:07.743

对于任何需要函数形式的人，我从 Andrew Rollings 和 ErikE 那里得到了解决方案，并将其放入一组可用的函数中。我还在下面的函数 NCRC32 中提供了 Unicode 字符的解决方案：

```
CREATE FUNCTION dbo.IndexTable
(
      @FirstIndex           bigint
    , @LastIndex            bigint
)
RETURNS @Result table
(
    Id BIGINT PRIMARY KEY
)
WITH SCHEMABINDING
AS
/***************************************************************************************************
    DESCRIPTION:
         Create an one column table of indexes starting with first specified index and 
         ending with last specified index.

    INPUT PARAMETERS:
         @FirstIndex:    First index to start the list of indexes with.
         @LastIndex:     Last index to end the list of indexes with.

    RETURN VALUE:
         Table with list of specified indexes.

    EXAMPLES:
        SELECT * FROM dbo.IndexTable(1, 20)
        SELECT * FROM dbo.IndexTable(1, 16)
        SELECT * FROM dbo.IndexTable(1, 17)
        SELECT * FROM dbo.IndexTable(1, 18)
        SELECT * FROM dbo.IndexTable(1, 1)
        SELECT * FROM dbo.IndexTable(1, 0)
***************************************************************************************************/
BEGIN
    DECLARE @max        bigint
    ,       @offset     bigint
    ;
    IF @LastIndex IS NULL RETURN ;
    IF @FirstIndex IS NULL RETURN ;
    INSERT INTO @Result 
    VALUES  (@FirstIndex+0), (@FirstIndex+1), (@FirstIndex+2), (@FirstIndex+3), (@FirstIndex+4)
    ,       (@FirstIndex+5), (@FirstIndex+6), (@FirstIndex+7), (@FirstIndex+8), (@FirstIndex+9)
    ;
    SELECT @max= MAX(Id) FROM @Result
    ;
    WHILE @max < @LastIndex
    BEGIN
        SET @offset = (1 + @max - @FirstIndex)
        ;
        INSERT
        INTO    @Result
        SELECT  Id = Id + @offset
        FROM    @Result
        WHERE   Id <= (@LastIndex - @offset)
        ;
        SELECT @max= MAX(Id) FROM @Result
        ;
    END
    DELETE FROM @Result WHERE Id > @LastIndex
    ;
    RETURN
END
GO

CREATE FUNCTION dbo.CRC32calc
/***************************************************************************************************
    DESCRIPTION
        Add a byte value to a CRC calculation.

    INPUT PARAMETERS:
        @crc            Current CRC value.
        @byteval        Byte value to add to CRC value.

    RETURN VALUE:
        Resulting CRC with bytevalue added.

    USAGE:
        Used by functions dbo.CRC32 and dbo.NCRC32
***************************************************************************************************/
(
    @crc        bigint,
    @byteval    int
)
RETURNS bigint
WITH SCHEMABINDING
AS
BEGIN
    DECLARE @Lookup     varbinary(2048) = 0x0000000077073096EE0E612C990951BA076DC419706AF48FE963A5359E6495A30EDB883279DCB8A4E0D5E91E97D2D98809B64C2B7EB17CBDE7B82D0790BF1D911DB710646AB020F2F3B9714884BE41DE1ADAD47D6DDDE4EBF4D4B55183D385C7136C9856646BA8C0FD62F97A8A65C9EC14015C4F63066CD9FA0F3D638D080DF53B6E20C84C69105ED56041E4A26771723C03E4D14B04D447D20D85FDA50AB56B35B5A8FA42B2986CDBBBC9D6ACBCF94032D86CE345DF5C75DCD60DCFABD13D5926D930AC51DE003AC8D75180BFD0611621B4F4B556B3C423CFBA9599B8BDA50F2802B89E5F058808C60CD9B2B10BE9242F6F7C8758684C11C1611DABB6662D3D76DC419001DB710698D220BCEFD5102A71B1858906B6B51F9FBFE4A5E8B8D4337807C9A20F00F9349609A88EE10E98187F6A0DBB086D3D2D91646C97E6635C016B6B51F41C6C6162856530D8F262004E6C0695ED1B01A57B8208F4C1F50FC45765B0D9C612B7E9508BBEB8EAFCB9887C62DD1DDF15DA2D498CD37CF3FBD44C654DB261583AB551CEA3BC0074D4BB30E24ADFA5413DD895D7A4D1C46DD3D6F4FB4369E96A346ED9FCAD678846DA60B8D044042D7333031DE5AA0A4C5FDD0D7CC95005713C270241AABE0B1010C90C20865768B525206F85B3B966D409CE61E49F5EDEF90E29D9C998B0D09822C7D7A8B459B33D172EB40D81B7BD5C3BC0BA6CADEDB883209ABFB3B603B6E20C74B1D29AEAD547399DD277AF04DB261573DC1683E3630B1294643B840D6D6A3E7A6A5AA8E40ECF0B9309FF9D0A00AE277D079EB1F00F93448708A3D21E01F2686906C2FEF762575D806567CB196C36716E6B06E7FED41B7689D32BE010DA7A5A67DD4ACCF9B9DF6F8EBEEFF917B7BE4360B08ED5D6D6A3E8A1D1937E38D8C2C44FDFF252D1BB67F1A6BC57673FB506DD48B2364BD80D2BDAAF0A1B4C36034AF641047A60DF60EFC3A867DF55316E8EEF4669BE79CB61B38CBC66831A256FD2A05268E236CC0C7795BB0B4703220216B95505262FC5BA3BBEB2BD0B282BB45A925CB36A04C2D7FFA7B5D0CF312CD99E8B5BDEAE1D9B64C2B0EC63F226756AA39C026D930A9C0906A9EB0E363F720767850500571395BF4A82E2B87A147BB12BAE0CB61B3892D28E9BE5D5BE0D7CDCEFB70BDBDF2186D3D2D4F1D4E24268DDB3F81FDA836E81BE16CDF6B9265B6FB077E118B7477788085AE6FF0F6A7066063BCA11010B5C8F659EFFF862AE69616BFFD3166CCF45A00AE278D70DD2EE4E0483543903B3C2A7672661D06016F74969474D3E6E77DBAED16A4AD9D65ADC40DF0B6637D83BF0A9BCAE53DEBB9EC547B2CF7F30B5FFE9BDBDF21CCABAC28A53B3933024B4A3A6BAD03605CDD7069354DE572923D967BFB3667A2EC4614AB85D681B022A6F2B94B40BBE37C30C8EA15A05DF1B2D02EF8D
    ;
    RETURN (@crc / 256) ^ Substring(@Lookup, ((@crc & 0xFF) ^ @byteval) * 4 + 1, 4)
    ;
END
GO

CREATE FUNCTION dbo.CRC32
/***************************************************************************************************
    DESCRIPTION
        Compute 32-bit CRC from an ASCII character array.

    INPUT PARAMETERS:
        @input          ASCII text to compute CRC for.

    RETURN VALUE:
        Resulting 32-bit CRC value.

    EXAMPLES:
        SELECT  t.input, csum = CHECKSUM(t.input), t.crc, crchex = CONVERT(VARBINARY(8), t.crc)
        FROM    (   SELECT  t.input, crc = dbo.CRC32(t.input)
                    FROM    (         SELECT  input = 'test'
                                UNION SELECT  input = 'x'
                                UNION SELECT  input = ''
                                UNION SELECT  input = NULL
                                UNION SELECT  input = 'stop'
                                UNION SELECT  input = 'pots'
                                UNION SELECT  input = 'System.IO.Stream'
                                UNION SELECT  input = 'SYSTEM.IO.Stream'
                                UNION SELECT  input = 'Test.fqn.data'
                                UNION SELECT  input = 'Test.fqn.datax'
                            ) AS t
                ) AS t
***************************************************************************************************/
(
    @input varchar(max)
)
RETURNS int
WITH SCHEMABINDING
AS
BEGIN
    DECLARE @crc        bigint = 0xFFFFFFFF
    ,       @result     int
    ;
    SELECT @crc = dbo.CRC32calc(@crc, Ascii(Substring(@input, v.id, 1)))
    FROM    dbo.IndexTable(1, LEN(@input)) AS v
    ORDER
    BY      v.Id
    ;
    SET @result = CONVERT(int, CONVERT(VARBINARY(4), ~@crc)) ;
    RETURN @result ;
END
GO

CREATE FUNCTION dbo.NCRC32
/***************************************************************************************************
    DESCRIPTION
        Compute 32-bit CRC from a UNICODE character array.

    INPUT PARAMETERS:
        @input          ASCII text to compute CRC for.

    RETURN VALUE:
        Resulting 32-bit CRC value.

    EXAMPLES:
        SELECT  t.input, csum = CHECKSUM(t.input), t.crc, crchex = CONVERT(VARBINARY(8), t.crc)
        FROM    (   SELECT  t.input, crc = dbo.NCRC32(t.input)
                    FROM    (         SELECT  input = N'test'
                                UNION SELECT  input = N'x'
                                UNION SELECT  input = N''
                                UNION SELECT  input = NULL
                                UNION SELECT  input = 'stop'
                                UNION SELECT  input = 'pots'
                                UNION SELECT  input = N'System.IO.Stream'
                                UNION SELECT  input = N'SYSTEM.IO.Stream'
                                UNION SELECT  input = N'Test.fqn.data'
                                UNION SELECT  input = N'Test.fqn.datax'
                            ) AS t
                ) AS t
***************************************************************************************************/
(
    @input nvarchar(max)
)
RETURNS int
WITH SCHEMABINDING
AS
BEGIN
    DECLARE @crc        bigint = 0xFFFFFFFF
    ,       @result     int
    ;
    SELECT  @crc = dbo.CRC32calc( dbo.CRC32calc(@crc, (cval / 256)), cval & 0xFF)
    FROM    (   SELECT  v.id, cval = UNICODE(SUBSTRING(@input, v.id, 1))
                FROM    dbo.IndexTable(1, LEN(@input)) AS v
            ) AS t
    ORDER
    BY      t.Id
    ;
    SET @result = CONVERT(int, CONVERT(VARBINARY(4), ~@crc)) ;
    RETURN @result ;
END
GO 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-01T15:57:21.760

我不认为 T-SQL 让您可以选择使用正确的 CRC 作为校验和函数。仅供参考，SQL Server Integration Services (SSIS) 确实有一个“校验和”转换，让您可以选择要使用的校验和算法，其中一个选择是：

> CRC32 - 使用标准的 32 位循环冗余校验 (CRC)，这提供了更开放的实现。

要在 SQL 中实现 CRC，您可以编写 CRC 的纯 T-SQL 实现（有趣！），或者（如果您使用 SQL Server 2005 或更高版本）用另一种 .NET 语言编写/查找它，然后使用它类作为编译的 SQL 存储过程。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-12-01T17:12:05.460

这是一个教育练习，还是您需要在应用程序中实际使用它。如果是第二种，我建议您在应用程序而不是 SQL Server 中执行此操作。任何可用的方法，即使是使用 CLR，如果有替代方法，可能会更有效且风险更大。大多数选项都会影响 SS 性能。

如果您需要它进行输入验证，那么加载它的模块应该在加载时检查（并且可能设置一个状态列。）如果您需要它进行输出并且不容易动态计算它，那么让输入模块计算并将其存储在列中。

如果您想使用它来验证列没有损坏，那么有更好的方法来处理不太可能出现的问题，或者您有一个不稳定的服务器需要处理。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2010-06-15T19:16:44.807

这是从上面的原始代码帖子派生的非基于表格的解决方案。专家们将不得不权衡这是否比基于表格的解决方案更有效。我的想法是，如果您计算 1,000 条记录的校验和，其中 1 行字符数为 1,000 个字符，那么您对 ​​CRC 查找表执行了 1,000,000 次选择命中，这不会比内存计算更有效. 也许是的。

```
Declare @input as varchar(1000) 
Set @input='This is the CRC test' 
Declare @CRCtable as varchar(3080)   --Location of Edit
Declare @Index as int  
Declare @crc as BIGINT 
Declare @length as INT 
Declare @i as INT 
Declare @tblval as BIGINT  
Declare @CTindex as int 
Declare @ans as varchar(25) 

Set @CRCtable='0000000000, 1996959894, 3993919788, 2567524794, 0124634137, 1886057615, 3915621685, 2657392035, 0249268274, 2044508324, 3772115230, 2547177864, 0162941995, 2125561021, 3887607047, 2428444049, 0498536548, 1789927666, 4089016648, 2227061214, 0450548861, 1843258603, 4107580753, 2211677639, 0325883990, 1684777152, 4251122042, 2321926636, 0335633487, 1661365465, 4195302755, 2366115317, 0997073096, 1281953886, 3579855332, 2724688242, 1006888145, 1258607687, 3524101629, 2768942443, 0901097722, 1119000684, 3686517206, 2898065728, 0853044451, 1172266101, 3705015759, 2882616665, 0651767980, 1373503546, 3369554304, 3218104598, 0565507253, 1454621731, 3485111705, 3099436303, 0671266974, 1594198024, 3322730930, 2970347812, 0795835527, 1483230225, 3244367275, 3060149565, 1994146192, 0031158534, 2563907772, 4023717930, 1907459465, 0112637215, 2680153253, 3904427059, 2013776290, 0251722036, 2517215374, 3775830040, 2137656763, 0141376813, 2439277719, 3865271297, 1802195444, 0476864866, 2238001368, 4066508878, 1812370925, 0453092731, 2181625025, 4111451223, 1706088902, 0314042704, 2344532202, 4240017532, 1658658271, 0366619977, 2362670323, 4224994405, 1303535960, 0984961486, 2747007092, 3569037538, 1256170817, 1037604311, 2765210733, 3554079995, 1131014506, 0879679996, 2909243462, 3663771856, 1141124467, 0855842277, 2852801631, 3708648649, 1342533948, 0654459306, 3188396048, 3373015174, 1466479909, 0544179635, 3110523913, 3462522015, 1591671054, 0702138776, 2966460450, 3352799412, 1504918807, 0783551873, 3082640443, 3233442989, 3988292384, 2596254646, 0062317068, 1957810842, 3939845945, 2647816111, 0081470997, 1943803523, 3814918930, 2489596804, 0225274430, 2053790376, 3826175755, 2466906013, 0167816743, 2097651377, 4027552580, 2265490386, 0503444072, 1762050814, 4150417245, 2154129355, 0426522225, 1852507879, 4275313526, 2312317920, 0282753626, 1742555852, 4189708143, 2394877945, 0397917763, 1622183637, 3604390888, 2714866558, 0953729732, 1340076626, 3518719985, 2797360999, 1068828381, 1219638859, 3624741850, 2936675148, 0906185462, 1090812512, 3747672003, 2825379669, 0829329135, 1181335161, 3412177804, 3160834842, 0628085408, 1382605366, 3423369109, 3138078467, 0570562233, 1426400815, 3317316542, 2998733608, 0733239954, 1555261956, 3268935591, 3050360625, 0752459403, 1541320221, 2607071920, 3965973030, 1969922972, 0040735498, 2617837225, 3943577151, 1913087877, 0083908371, 2512341634, 3803740692, 2075208622, 0213261112, 2463272603, 3855990285, 2094854071, 0198958881, 2262029012, 4057260610, 1759359992, 0534414190, 2176718541, 4139329115, 1873836001, 0414664567, 2282248934, 4279200368, 1711684554, 0285281116, 2405801727, 4167216745, 1634467795, 0376229701, 2685067896, 3608007406, 1308918612, 0956543938, 2808555105, 3495958263, 1231636301, 1047427035, 2932959818, 3654703836, 1088359270, 0936918000, 2847714899, 3736837829, 1202900863, 0817233897, 3183342108, 3401237130, 1404277552, 0615818150, 3134207493, 3453421203, 1423857449, 0601450431, 3009837614, 3294710456, 1567103746, 0711928724, 3020668471, 3272380065, 1510334235, 0755167117, '
Set @crc = 0xFFFFFFFF  
Set @length = LEN(@input)  
Set @i = 1  

While @i <= @length  
  Begin  
  Set @index = ((@crc & 0xff) ^ ASCII(SUBSTRING(@input, @i, 1)))        
  Set @CTindex = (@index * 12) + 1
  Set @ans=substring(@CRCtable,@CTindex,10  )  
  Set @tblval = convert(bigint,@ans) 
  Set @crc = (@crc / 256) ^ @tblval     
  Set @i = @i + 1       
  End  
Set @crc = ~@crc  

SELECT @crc as CRC32, CONVERT(VARBINARY(4), @crc) as CRC32Hex 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2011-12-01T02:55:52.677

SQL 2005 及更高版本具有功能`CHECKSUM`和`CHECKSUM_AGG`. 这类似于 CRC，可能适用于哈希表或快速检查更改的数据。`CHECKSUM(*)`将返回一个包含单行所有列的值。

我对其进行了简要测试，它对字符串上的大小写和尾随空格不敏感。如果带有前导或嵌入的空白，它确实会改变。值的顺序很重要。

# javascript - 与 Wiki 资源一起使用的 JavaScript 编辑就地持有者

> ID：331173
> 
> 赞同：1
> 
> 时间：2008-12-01T15:29:59.193
> 
> 标签：javascript, wiki-engine

我想动态解析文本维基内容。我找到[了 JsWiki](http://sourceforge.net/projects/jswiki)，但它是 beta 形式，看起来没有社区，甚至没有开发人员）。任何其他？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-01T15:48:37.673

如果你在 ASP.NET 上，你可以使用[Ra-Ajax InPlaceEdit来处理这些事情。](http://ra-ajax.org/samples/Ajax-InPlaceEdit.aspx)它没有自动内置的 wiki 解析，但它允许添加您希望的任何控件，包括 LinkBut​​tons 和 Literals，然后您可以使用您自己想要的 HTML 构建它们......

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-01T18:49:59.913

这取决于您所说的 wiki 内容是什么意思。就像 wiki 文本有多种格式一样，有许多 wiki 框架。如果您正在寻找可以解析 mediawiki 内容的东西，例如 wikipedia，这里有一个[很好的解析器列表](http://www.mediawiki.org/wiki/Alternative_parsers)。有些是基于 Javascript 的，我对其中之一[InstaView](https://github.com/cscott/instaview)有很好的体验。

您可能只是在寻找一种简单的标记形式，在这种情况下，您可以尝试使用[ShowDown](http://attacklab.net/showdown/)之类的库。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-05-30T18:00:50.490

还有另一个漂亮的基于 Javascript（仅）的 wiki 编辑器。我只是喜欢这个想法本身。看看[TiddlyWiki](http://tiddlywiki.com)

# ruby-on-rails - 如何使用 Rails 中生成的图像更新占位符的内容？

> ID：331185
> 
> 赞同：0
> 
> 时间：2008-12-01T15:33:37.250
> 
> 标签：ruby-on-rails, graph

我在视图中有一个 div 标签，我想用我通过 Gruff 生成的图表来更新它。

我有以下控制器操作，最后执行此操作

```
send_data g.to_blob, :disposition=>'inline', :type=>'image/png', :filename=>'top_n.pdf' 
```

现在，如果我直接调用此操作，我可以看到图表。[（如果需要，请在此处](http://madcoderspeak.blogspot.com/2008/12/graphs-in-ruby-on-rails.html)获取更多详细信息。）

如果我添加一个`link_to_remote_tag`通过 AJAX 传入特定输入调用上述操作的方法，生成此图并尝试更新占位符 div 标记...我看到胡言乱语。

我想我可以将图形写入 png 文件，`g.write(filename.png)`如何在运行时将图形嵌入到视图中的 div 标记中？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-01T17:29:55.113

在您的 link_to_remote 标记中，只需将 :complete 设置为如下所示：

```
:complete => "updateImg(id_of_div, request.responseText)" 
```

并编写一个JS函数：

```
function updateImg(id, img)
{
  $(id).innerHTML = '<img src="' + img + '" />';
} 
```

其中 id_of_div 是要显示图像时 div 的 id。

request.responseText var 来自 AJAX 调用的请求，我的意思是，当您的代码用图形写入 png 文件时，完成返回这​​个新 png 的路径的方法（render :text => path_to_new_image ）；然后，在 :complete 中使用这个请求变量。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-01T17:44:53.977

您可以使用常规`img`标签来调用控制器操作，该操作将返回生成的 png。如果您将控制器设置为使用[respond_to](http://api.rubyonrails.org/classes/ActionController/MimeResponds/InstanceMethods.html#M000245)如下所示：

```
def graph
    # get the relevant data for 'g' here
    respond_to do |format|
        format.html #uses the default view if relevant (good for debugging)
        format.png do 
            send_data g.to_blob, 
                :disposition=>'inline', 
                :type=>'image/png', 
                :filename=>'top_n.pdf' 
        end
    end
end 
```

你甚至会有一个正常的生成器 url，如下所示：

```
<img src="controller/graph.png" alt="Something"/> 
```

如果图像生成有可能失败：您可以在服务器上存储备用图像并读取该文件并返回该文件。

如果生成量很大并且不太可能一直更改，那么您也可以缓存结果文件，如果您确定数据没有更改，则改为获取该文件。您可以使用 ARemesal 建议的方法延迟添加图像链接，直到生成图像，然后直接链接到缓存文件。（这取决于您的具体情况，什么是最好的）

# javascript - 为什么我的自定义拖放脚本失败？

> ID：331186
> 
> 赞同：-1
> 
> 时间：2008-12-01T15:34:21.400
> 
> 标签：javascript, firefox, drag-and-drop, dom-events, no-framework

我目前正在尝试编写自己的 JS 拖放脚本（出于好奇和无聊，我知道使用框架会容易得多）。我的目标是一个完全运行的 Firefox3 版本，IE 现在可以等待。

我刚刚陷入了一个奇怪的错误。当我第一次拖动 div 时，它工作正常。当我第二次拖动它时，松开按钮后它不会粘住，我必须再次单击才能将其放下。第三次和随之而来的阻力再次完美无瑕地工作（！？！）。

请参阅[原始页面][1]（正如我所说，目前仅 FireFox）以了解会发生什么。整个事情是作为一个带有两个事件（onmousedown 和 onmouseup）的 div 完成的，使用 document.captureEvents(Event.MOUSEMOVE) 进行中间移动。该脚本可以在 [here][2] 中找到（忽略底部的 ajax 部分，它为一些额外的技巧做好了准备，如果我把它拿出来，这个错误仍然存​​在）。

如果您过去遇到过类似的事情，或者您在某处发现错误，请告诉我。我知道可能有更好的方法来解决整个问题，但我正在特别寻找一种方法来使我的方法发挥作用。

**编辑：Chrome 和 Safari 工作。**

**编辑：使链接脱机，处理新版本。**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-01T16:10:58.347

如果这就是你要问的，那么首先这对我在 FF3 中有效。

这不是您想听到的，但我强烈建议您从 mootools 或 jquery 或类似工具中选择 DnD 方法。仅从效率的角度来看，DnD 编码是一件可怕的事情（我自己做了几次），如果你没有能力（这里没有冒犯的意思）解决出现的众多错误，那将是一个巨大的与仅使用现成的强大成熟实施相比，会浪费您的时间。这*是*一件很难的事情。

如果您继续使用自己的代码（作为练习或出于自豪 - 我可以理解 :) ）这种问题通常是由于某个事件没有在您认为是因为其他事件而被捕获的结果首先，一个标志没有被设置在你认为的位置，或者（或因为）一个错误在你的代码中出现了意外的点。通过注销事件触发器，尝试从逻辑上跟踪正在发生的事情。

如果您可以更详细地定义 它是*如何*不工作的，我也许可以进一步追踪它（因为我似乎无法复制），但我确实建议您探索可靠库的好处。

# windows - 将 ASP 经典页面从 Windows 传输到 Linux

> ID：331192
> 
> 赞同：1
> 
> 时间：2008-12-01T15:38:00.020
> 
> 标签：windows, linux, asp-classic, move

有没有人尝试过在 IIS/Windows 以外的其他东西上托管 ASP 经典页面的解决方案？我想知道尝试解决该问题的方法之一是否是个好主意。我知道 Sun Java System Active Server Pages（或 Chilisoft），但没有尝试过。这些解决方案有什么大问题吗？托管代码是否需要更改？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-01T17:16:25.763

您可以在您的 Linux 中尝试使用[Apache::ASP](http://apache-asp.org./)，但我会暂时使用它，直到可以将应用程序迁移到具有更好支持的其他语言（PHP、Perl、Python、Java、Ruby ......甚至 .Net 与单核细胞增多症）。

请注意，Apache:ASP 无法管理类，因此您需要将类重新编码为变量和函数。好吧，经典 ASP 中的类并不复杂，而不仅仅是变量和函数......

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-03T18:23:45.130

存在一个名为[ASP 2 PHP](http://asp2php.naken.cc/)的程序。有了它，您可以将您的应用程序迁移到 PHP。项目负责人不建议连续使用它，因为它不是，也永远不会是 100% 完美的。

还有一个[常见问题解答](http://asp2php.naken.cc/faq.php)和一个[注释](http://asp2php.naken.cc/notes.php)页面，可以让您了解使用它时可能遇到的问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-01T15:43:34.767

我想你会遇到麻烦尝试... :(

如果是 ASP.NET，我会鼓励你使用 Mono，但对于经典 ASP，我认为没有那么多解决方案，但我*可能*是错的 :)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-01T18:30:08.783

多年前，我有一个客户在不知不觉中选择了一个在 Linux 下具有 ASP 仿真形式的 ISP。我安装的程序不能正常工作，因为 Windows 中的文件名不区分大小写，在 Unix 中它们是。如果失败，那就是一大堆。包括文件、URL、表单帖子、图像文件名，随你命名。

# email - 编写电子邮件轮询器的最佳方法

> ID：331198
> 
> 赞同：2
> 
> 时间：2008-12-01T15:39:54.477
> 
> 标签：email, poller

我正在为多用户系统开发电子邮件轮询解决方案。所以用户可以在他们各自的 id 上发送电子邮件，它会被轮询并插入到数据库中。

我正在考虑两种选择：

1.  基于 Perl/Unix 的电子邮件轮询器..
2.  基于 java 的轮询器。

你会推荐什么..（也欢迎其他建议）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-01T15:46:35.960

为什么不将邮件转发到进程而不是轮询？根据您使用的邮件服务器，您可以将其作为别名，甚至可以在 .forward 文件中执行。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-01T15:48:28.250

我没有什么要补充的，但目前谷歌代码中有一个项目可以将 iwantsandy.com 重建为开源。

它位于：
[http ://code.google.com/p/sandysback/](http://code.google.com/p/sandysback/)

我肯定会看这个，看看他们如何解析电子邮件，并将这些电子邮件“插入数据库”

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-01T15:52:12.643

无论您使用哪种语言最有经验！

我个人非常了解 java 和 perl，对于这项任务，我会选择 perl，但差异是微不足道的。

Perl 会更短更甜，java 会花费更长的时间，但一旦数据库访问被整理出来，它可能是一个更健壮的解决方案。

我发现 Perl DBI 是一个比 JDBC 更好、更便携的数据库接口，它不会从你的代码中隐藏数据库实现，并且对版本更改等很敏感。IE 你必须为你的目标数据库拥有正确的数据库驱动程序的正确版本。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-01T16:18:10.530

回复：投票

如果您可以选择将电子邮件转发到某个流程，我强烈建议您这样做。（转发给服务器带来的负载通常比轮询要少。）如果不是，那么轮询是下一个最好的事情。使用您最熟悉的语言查看 POP3 客户端库。

回复：语言选择

如果我打算对电子邮件进行大量解析，那么 Perl 将是我的选择。如果不涉及太多解析，那么 Java 将是我的选择；-)。

-- 在以前的生活中，我编写了一个 Perl 脚本来将传入的电子邮件（结构良好）解析为 HTML 页面并将它们发布到 Web 服务器。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-01-09T19:45:51.210

你有几个选择。正如原始海报所说 - 可能最简单的方法是在别名文件中设置一个脚本条目。

然后电子邮件的正文作为标准输入传递给脚本。然后，您可以使用 perl 脚本 + Mime 模块来解析消息的各个部分，并使用它做任何您想做的事情。

还可以查看 apache james - 这是一个自定义邮件服务器。它们具有 servlet 的等价物，称为“maillets”，您可以将业务逻辑放入其中。它们通常难以在企业场景中部署，因为大多数公司不喜欢部署自定义邮件服务器。

...别名路线可能是您最好的选择。另一个注意事项 - 不保证电子邮件。如果您将其用作某种应用程序到应用程序的消息传递系统，并且您控制两端，您可能应该查看其他内容，例如 JMS 类型的消息传递。

-高手

# objective-c - Cocoa Threadsafe 可变集合访问

> ID：331205
> 
> 赞同：2
> 
> 时间：2008-12-01T15:42:15.283
> 
> 标签：objective-c, cocoa, cocoa-touch, multithreading

我正在以推荐的方式在我的一个对象上创建一个符合 KVC/KVO 的可变数组：

```
@interface Factory {
    NSMutableArray *widgets;
}
- (NSArray *)widgets;
- (void)insertObject:(id)obj inWidgetsAtIndex:(NSUInteger)idx;
- (void)removeObjectFromWidgetsAtIndex:(NSUInteger)idx;
@end 
```

显然，这是一个棘手的线程安全问题。在`insert`and`remove`方法中，我按照[建议](http://developer.apple.com/documentation/Cocoa/Conceptual/Multithreading/ThreadSafetySummary/chapter_950_section_2.html#//apple_ref/doc/uid/20000736-126010)锁定了数组访问以防止并发修改。

我的问题是，实现`widgets`访问器的正确方法是什么？这是我的实现：

```
- (NSArray *)widgets {
    [widgetLock lock];
    NSArray *a = [[widgets copy] autorelease];
    [widgetLock unlock];
    return a;
} 
```

它是线程安全的吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-01T21:25:38.803

`widgets`尽管您应该知道该数组中的所有对象都没有被锁定，但您的访问器应该没问题。因此，您可能会在尝试同时运行代码时遇到问题，例如

```
[[[myFactory widgets] objectAtIndex:7] setName:@"mildred"]; 
```

和

```
[myTextField setStringValue:[[[myFactory widgets] objectAtIndex:7] name]]; // mildred? or something else? 
```

由于数组中的对象未锁定，您可能会遇到竞争条件或读取器/写入器类型的问题。多线程不是一种乐趣吗？

另一方面，对于 KVC 合规性，我建议实施`objectInWidgetsAtIndex:`而`countOfWidgets`不是`widgets`访问器。请记住，KVC 模型的是关系，而不是数组属性。所以你会调用类似的方法来获取一个表示属性`[myFactory mutableArrayValueForKey:@"widgets"]`的数组。`widgets`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-01T22:51:51.843

除了创建自己的锁之外，您还可以使用语言内置的锁定：

IE

```
- (NSArray *)widgets {
    @synchronized(widgets)
    {
        NSArray *a = [[widgets copy] autorelease];
        return a;
    }
} 
```

并在所有其他访问`widgets`. （`widgets`传入的参数`@synchronized`是指实例变量，而不是方法。）

亚历克斯关于访问包含对象的评论仍然适用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-01T17:06:09.013

您将需要锁定所有读写方法。如果您的插入和删除也被锁定（如您所说），那么访问器方法应该可以这样。

# wpf - 单元测试 WPF 绑定

> ID：331215
> 
> 赞同：11
> 
> 时间：2008-12-01T15:44:53.717
> 
> 标签：wpf, unit-testing, data-binding, binding

我正在尝试使用 Microsoft Team System 提供的测试套件对我的 WPF 数据绑定进行单元测试。我希望能够在不显示窗口的情况下测试绑定，因为我的大多数测试都是针对用户控件的，而不是实际在窗口上的。这是可能的还是有更好的方法来做到这一点？如果我显示窗口，则下面的代码有效，但如果我不显示，则绑定不会更新。

```
 Window1_Accessor target = new Window1_Accessor();
            UnitTestingWPF.Window1_Accessor.Person p = new UnitTestingWPF.Window1_Accessor.Person() { FirstName = "Shane" };
            Window1 window = (target.Target as Window1);
            window.DataContext = p;         
            //window.Show(); //Only Works when I actually show the window
            //Is it possible to manually update the binding here, maybe?  Is there a better way?
            Assert.AreEqual("Shane", target.textBoxFirstName.Text);  //Fails if I don't Show() the window because the bindings aren't updated 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-10-26T18:45:10.113

在寻找将 WPF 绑定错误转换为异常的解决方案时，我发现它也可以用于单元测试项目。

该技术非常简单：

1.  派生一个`TraceListener`抛出而不是记录的
2.  将该侦听器添加到`PresentationTraceSources.DataBindingSource`

请[在 GitHub 上查看完整的解决方案](https://github.com/bblanchon/WpfBindingErrors)，它包括一个单元测试项目。

![Visual Studio 中的测试失败](https://i.stack.imgur.com/uq8cc.png)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-01T17:58:31.577

**目测吧。**
这种声明性标记很少会中断..除非有人手动输入并将其搞砸。即使这样，您也可以在几分钟内修复它。恕我直言，编写此类测试的成本远远超过收益。

**更新**[2008 年 12 月 3 日]：好吧。
该测试只是测试文本框的值“FirstName”作为绑定的 Path 属性。如果我在实际数据源对象中将 FirstName 更改/重构为 JustName，则测试仍然会通过，因为它正在针对匿名类型进行测试。（代码损坏时的绿色测试 - TDD 反模式：骗子）如果您的目标是验证 XAML 中是否指定了 FirstName，

```
Assert.AreEqual("FirstName", txtBoxToProbe.GetBindingExpression(TextBox.TextProperty).ParentBinding.Path.Path); 
```

如果您真的必须通过单元测试捕获损坏的绑定（并且不想显示 UI），请使用真实的数据源......挣扎了一段时间并想出了这个。

```
[Test]
public void TestTextBoxBinding()
{
   MyWindow w = new MyWindow();
   TextBox txtBoxToProbe = w.TextBox1;
   Object obDataSource = w;               // use 'real' data source 

   BindingExpression bindingExpr = BindingOperations.GetBindingExpression(txtBoxToProbe, TextBox.TextProperty);
   Binding newBind = new Binding(bindingExpr.ParentBinding.Path.Path);
   newBind.Source = obDataSource;
   txtBoxToProbe.SetBinding(TextBox.TextProperty, newBind);

   Assert.AreEqual("Go ahead. Change my value.", txtBoxToProbe.Text);
} 
```

结语：在[调用](http://social.expression.microsoft.com/Forums/en-US/wpf/thread/9b5b76e1-9a9f-4c24-bfd7-ebb5659a097e/)`Window.Show()`. 它以某种方式神奇地设置了 DataItem 属性，之后数据绑定开始工作。

```
// before show
bindingExpr.DataItem => null
bindingExpr.Status => BindingStatus.Unattached

// after show
bindingExpr.DataItem => {Actual Data Source}
bindingExpr.Status => BindingStatus.Active 
```

一旦绑定处于活动状态，我想你可以通过这样的代码强制文本框更新..

```
txtBoxToProbe.GetBindingExpression(TextBox.TextProperty).UpdateTarget(); 
```

我再一次表达了我对这种做法的不情愿。让 NUnit 在 STA 中运行很痛苦。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-03T15:17:45.940

Shane，如果您真正担心的是绑定无声地中断，您应该考虑将绑定跟踪重定向到您可以检查的地方。我将从这里开始：

[http://blogs.msdn.com/mikehillberg/archive/2006/09/14/WpfTraceSources.aspx](http://blogs.msdn.com/mikehillberg/archive/2006/09/14/WpfTraceSources.aspx)

除此之外，我同意 Gishu 的观点，即绑定不是单元测试的好候选者，主要是因为 Gishu 在“结语”中提到的自动魔法。而是专注于确保底层类行为正确。

另请注意，您可以使用 PresentationTraceSources 类获得更强大的跟踪：

[http://msdn.microsoft.com/en-us/library/system.diagnostics.presentationtracesources.aspx](http://msdn.microsoft.com/en-us/library/system.diagnostics.presentationtracesources.aspx)

希望有帮助！

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-13T09:16:50.560

结合我在许多 SO 帖子中遇到的建议，我编写了以下类，它非常适合测试 WPF 绑定。

```
public static class WpfBindingTester
{
    /// <summary>load a view in a hidden window and monitor it for binding errors</summary>
    /// <param name="view">a data-bound view to load and monitor for binding errors</param>
    public static void AssertBindings(object view)
    {
        using (InternalTraceListener listener = new InternalTraceListener())
        {
            ManualResetEventSlim mre = new ManualResetEventSlim(false);

            Window window = new Window
            {
                Width = 0,
                Height = 0,
                WindowStyle = WindowStyle.None,
                ShowInTaskbar = false,
                ShowActivated = false,
                Content = view
            };

            window.Loaded += (_, __) => mre.Set();
            window.Show();

            mre.Wait();

            window.Close();

            Assert.That(listener.ErrorMessages, Is.Empty, listener.ErrorMessages);
        }
    }

    /// <summary>Is the test running in an interactive session. Use with Assume.That(WpfBindingTester.IsAvailable) to make sure tests only run where they're able to</summary>
    public static bool IsAvailable { get { return Environment.UserInteractive && Process.GetCurrentProcess().SessionId != 0; } }

    private class InternalTraceListener : TraceListener
    {
        private readonly StringBuilder _errors = new StringBuilder();
        private readonly SourceLevels _originalLevel;
        public string ErrorMessages { get { return _errors.ToString(); } }

        static InternalTraceListener() { PresentationTraceSources.Refresh(); }

        public InternalTraceListener()
        {
            _originalLevel = PresentationTraceSources.DataBindingSource.Switch.Level;
            PresentationTraceSources.DataBindingSource.Switch.Level = SourceLevels.Error;
            PresentationTraceSources.DataBindingSource.Listeners.Add(this);
        }

        public override void Write(string message) {}

        public override void WriteLine(string message) { _errors.AppendLine(message); }

        protected override void Dispose(bool disposing)
        {
            PresentationTraceSources.DataBindingSource.Listeners.Remove(this);
            PresentationTraceSources.DataBindingSource.Switch.Level = _originalLevel;
            base.Dispose(disposing);
        }
    }
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-11-04T19:13:35.560

你可以试试[东望洋](http://guia.codeplex.com)。有了它，您可以对您的 UserControl 进行单元测试并检查数据绑定是否正确。你必须显示窗口。

这是一个例子。它启动 UserControl 的新实例并设置其 DataContext，然后检查文本框是否设置为正确的值。

```
 [TestMethod]
    public void SimpleTest()
    {
        var viewModel = new SimpleControlViewModel() {TextBoxText = "Some Text"};

        customControl = CustomControl.Start<SimpleUserControl>((control) => control.DataContext = viewModel);

        Assert.AreEqual("Some Text", customControl.Get<TextBox>("textbox1").Value);

        customControl.Stop();
    } 
```

# java - 如何使 Java Web 应用程序脱机？

> ID：331217
> 
> 赞同：3
> 
> 时间：2008-12-01T15:45:43.623
> 
> 标签：java, web-applications, offline

我们开发了显示图形和数据库信息的 Java Web-aps (Websphere, DB2)。我们还希望通过在线数据更新提供相同的离线应用程序（通过 CD/DVD 分发）。过去我们尝试了许多替代方案，但没有一个是真正稳定的。使 Web 应用程序和数据（在小型数据库中）脱机的新最佳实践是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-01T15:49:58.607

我不知道它在 CD/DVD 发行版上的表现如何，但首先想到的是[Gears](http://code.google.com/p/gears/)。在栅栏的 .NET 一侧有[Silverlight 2](http://www.microsoft.com/silverlight/)。然后是[Mozilla Prism](http://labs.mozilla.com/projects/prism/)项目，虽然我不知道它有多先进。

这些都设计用于不仅离线访问，而且混合离线/在线，在服务器可用时与服务器通信，并在必要时在本地工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-01T21:52:26.393

我建议使用 Apache Derby 作为数据库（也可以作为 Sun 的 Java DB 提供，并且可能仍然是 IBM Cloudscape（它仍然具有 DB2 兼容性吗？））。

我确信有很多 Web 服务器/Servlet 容器。Apache Tomcat 是显而易见的。另一种方法是在单个 Java 进程中使用嵌入式本地浏览器。这种方法对用户和技术支持来说应该相对轻松，您只需使用 WebStart 安装和更新即可。

如果您正在使用 EJB 和其他废话，那么还有类似的免费赠品。我了解 Sun Glassfish 的启动速度非常快。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-01T15:50:56.670

您可以将您的服务器的映像创建为 VMware 实例，并将其与 VMware 播放器的副本一起分发（当然许可允许）。就我个人而言，我会将它构建在像 CentOS5 这样的 Linux 发行版之上。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-10-07T20:36:58.160

您可以将 JRE 与 JETTY 服务器捆绑在一起，并使用不同的数据库，例如 HSQLDB（您可以将其捆绑在 webapp 本身内）。

如果您使用 ORM 工具连接到数据库，您可能不需要为此做很多代码更改。

许多应用程序服务器像这样分发他们的管理控制台。例如，Weblogic 管理控制台脱机运行（它使用内部 ldap 服务器作为其数据库）

同样就谷歌齿轮而言，他们也几乎在做同样的事情。他们有一个与 SQLDB 捆绑在一起的服务器，它们允许在在线离线应用程序之间同步数据。如果您需要同步功能，您也可以同步数据（使用在线应用程序中的网络服务）并通过离线应用程序的 https 来同步数据。

您也可以查看此链接 [http://developers.sun.com/learning/javaoneonline/2007/pdf/TS-69700.pdf](http://developers.sun.com/learning/javaoneonline/2007/pdf/TS-69700.pdf)

# perl - 如何将 DBD::Proxy 与 DBIx::Class 一起使用？

> ID：331218
> 
> 赞同：1
> 
> 时间：2008-12-01T15:45:51.360
> 
> 标签：perl, dbi, catalyst, dbix-class, dbd-proxy

我需要通过防火墙获得数据库连接，并限制可以运行的查询。DBD::Proxy 似乎是解决这个问题的完美解决方案。但是，我目前正在使用 DBIx::Class，并且不知道如何将它们连接在一起。

特别是 DBD::Proxy 不使用 SQL；它需要特定的命名查询。但是 DBIx::Class 似乎没有办法调用这些命名查询。

这是在基于 Catalyst 的 web 应用程序中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-01T18:42:03.143

DBD::Proxy 确实采用 SQL。为了方便起见，它允许命名查询。

没有方便的方法将 DBIx::Class 与 DBD::Proxy 命名查询一起使用，因为 DBIx::Class 对象关系映射器 (ORM) 的目的是呈现 SQL 的数据操作语言 (DML) 的面向对象视图) 陈述。DBD::Proxy 的命名查询特性不是 DML 语句，因此 DBIx::Class 没有满足您需求的特性：将文字字符串直接传递给 DBD::Proxy 驱动程序的 prepare() 函数。

一些不方便的方法：

1.  不要使用 DBIx::Class。只需在 DBI 中进行即可。你可以使用 Catalyst::Model::DBI，或者普通的 DBI + catalyst::Model::Adaptor + 你自己的模型类。

2.  不要使用命名查询。这意味着如果您打算使用命名查询作为控制对数据库的访问的一种方式，那么您需要将查询授权逻辑移动到在控制器或模型中调用数据库的代码中，具体取决于你是如何构建你的应用程序的。

# sharepoint - 在 SharePoint 3 文档库中的新项目事件上显示自定义表单？

> ID：331222
> 
> 赞同：1
> 
> 时间：2008-12-01T15:46:41.467
> 
> 标签：sharepoint, workflow, event-handling

为每个添加到特定文档库的新文档显示自定义表单的最佳方式是什么？

我希望用户能够对添加文档将导致的某些操作进行一些控制 - 特别是为任务列表中的用户创建的任务，贡献用户在提交之前必须确定。

最好的方法是通过工作流还是事件处理程序？

问候哞

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-12-01T21:09:46.573

**对于 SharePoint 服务器 2007：**

专门的内容类型和事件处理程序的组合将使您能够最大程度地控制流程（也更易于调试）。工作流最适合“简单”的操作，更难实现复杂的操作。

工作流允许站点管理员更灵活地将工作流分配给不同的库。

将您的内容类型和事件处理程序滚动到可以部署的功能中。将内容类型分配给列表将允许您获取由标准表单创建的任何数据（请记住，您可以为真正复杂/自定义数据输入创建自定义字段）并执行所需的任何操作，包括基于项目创建任务。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-02T14:42:25.483

感谢您的回答，这就是我正在调查的路线，但不幸的是我还没有找到一种方法让它适用于文档库 - 仅限列表。

我遇到的问题是在文档库上的 ItemAdded、ItemAdding、ItemCheckingIn 或 ItemCheckedIn 事件中添加 SPUtility.Redirect 根本没有做任何事情，因为没有与事件相关的页面 - 它的所有后端代码都是触发了未链接到 Web 上下文的事件，因为它不是在那个时候进行繁重工作的网页，而是 Office 集成。

我遇到的所有示例似乎都依赖于在触发事件时正在显示 EditForm.aspx 或 NewForm.aspx 页面这一事实，当然这里不是这种情况。

这也导致了我无法扩展 EditForm.aspx 或 CheckIn.aspx 页面来做我想做的事情，因为 Office 2007 绕过了这两个问题。

因此，目前对我开放的唯一选择是通过工作流程进行：/

任何进一步的提示都会很棒。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-29T05:26:03.790

我可能不明白你的问题，但这接近你想要做的吗？

[http://msdn.microsoft.com/en-us/library/ms550037.aspx](http://msdn.microsoft.com/en-us/library/ms550037.aspx)

如果没有，这会以什么方式不足？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-29T05:44:23.397

将其新表单 url 设置为适当值的新“内容类型”应该可以解决问题。不幸的是，您可能无法使用事件处理程序或工作流来实现您想要实现的目标。理想情况下，您希望表单在用户向库中添加新项目时立即显示，并且自定义内容类型可以解决问题。

1.  创建一个新的内容类型。（从现有的内容类型派生它）
2.  从文档库中删除默认内容类型。
3.  使用对象模型将新表单 url 设置为您创建的 aspx 页面或 Infopath 表单。

亲切的问候，

# bash - 如何附加到管道上？

> ID：331224
> 
> 赞同：8
> 
> 时间：2008-12-01T15:48:04.257
> 
> 标签：bash, pipe

所以我的问题是我是否可以以某种方式将数据发送到我的程序，然后将相同的数据及其结果发送到另一个程序，而无需创建临时文件（在我的情况下为 ouputdata.txt）。最好使用 linux 管道/bash。

我目前执行以下操作：

猫输入数据.txt | ./MyProg > 输出数据.txt

cat inputdata.txt outputdata.txt | ./MyProg2

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2008-12-01T16:15:36.840

这是另一种方式，可以扩展为将两个程序的输出放在一起：

```
( Prog1; Prog2; Prog3; ...  ) | ProgN 
```

这至少在 Bash 中有效。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2008-12-01T15:55:19.750

选择 1 - 修复`MyProg`从输入写入合并输出和它自己的输出。然后你可以这样做。

```
./MyProg <inputdata.txt | ./MyProg2 
```

选择 2 - 如果您无法修复`MyProg`同时写入输入和输出，则需要合并。

```
./MyProg <inputdata.txt | cat inputdata.txt - | ./MyProg2 
```

# c# - c# gridview 行点击

> ID：331231
> 
> 赞同：19
> 
> 时间：2008-12-01T15:50:29.417
> 
> 标签：c#, gridview, click

当我单击 GridView 中的一行时，我想使用从数据库中获取的 ID 转到另一个页面。

在我的 RowCreated 事件中，我有以下行：

```
e.Row.Attributes.Add(
     "onClick",
     ClientScript.GetPostBackClientHyperlink(
          this.grdSearchResults, "Select$" + e.Row.RowIndex)); 
```

为了防止出现错误消息，我有以下代码：

```
protected override void Render(HtmlTextWriter writer)
{
    // .NET will refuse to accept "unknown" postbacks for security reasons. 
    // Because of this we have to register all possible callbacks
    // This must be done in Render, hence the override
    for (int i = 0; i < grdSearchResults.Rows.Count; i++)
    {
        Page.ClientScript.RegisterForEventValidation(
                new System.Web.UI.PostBackOptions(
                    grdSearchResults, "Select$" + i.ToString()));
    }
    // Do the standard rendering stuff
    base.Render(writer);
} 
```

如何给一行一个唯一的 ID（来自数据库），当我单击该行时，会打开另一个页面（如单击一个 href）并且该页面可以读取 ID。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2010-04-06T02:33:23.460

马汀，

这是另一个带有一些漂亮的行突出显示和 href 样式光标的示例：

```
protected void gvSearch_RowDataBound(object sender, GridViewRowEventArgs e)
{
  if (e.Row.RowType == DataControlRowType.DataRow)
  {
    e.Row.Attributes.Add("onmouseover", "this.style.backgroundColor='#ceedfc'");
    e.Row.Attributes.Add("onmouseout", "this.style.backgroundColor=''");
    e.Row.Attributes.Add("style", "cursor:pointer;");
    e.Row.Attributes.Add("onclick", "location='patron_detail.aspx?id=" + e.Row.Cells[0].Text + "'");
  }
}
```

上面的代码适用于 .NET 3.5。但是，您不能将 id 列设置为 Visible="false"，因为您将获得 id 键的空白查询字符串值：

```
<asp:GridView ID="gvSearch" runat="server" OnRowDataBound="gvSearch_RowDataBound" AutoGenerateColumns="false">
  <Columns>
    <asp:BoundField DataField="id" Visible="false" />
    <asp:BoundField DataField="first_name" HeaderText="First" />
    <asp:BoundField DataField="last_name" HeaderText="Last" />
    <asp:BoundField DataField="email" HeaderText="Email" />
    <asp:BoundField DataField="state_name" HeaderText="State" />
  </Columns>
</asp:GridView>
```

因此，将第一列改为：

```
<asp:BoundField DataField="id" ItemStyle-CssClass="hide" />
```

将此 css 添加到页面顶部：

```
<head>
  <style type="text/css">
    .hide{
      display:none;
    }
  </style>
<head>
```

但是要隐藏标题行的第一个单元格，请将其添加到代码隐藏中的 gvSearch_RowDataBound() 中：

```
if (e.Row.RowType == DataControlRowType.Header)
{
  e.Row.Cells[0].CssClass = "hide";
}
```

显然，您也可以在代码隐藏中隐藏 id 列，但这会导致标记中的文本比 css 类更多：

```
e.Row.Cells[0].Attributes.Add("style", "display:none;");
e.Row.Attributes.Add("style", "cursor:pointer;");
```

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2008-12-01T18:01:32.147

我有解决办法。

这就是我所做的：

```
if(e.Row.RowType == DataControlRowType.DataRow)
{
    e.Row.Attributes["onClick"] = "location.href='view.aspx?id=" + DataBinder.Eval(e.Row.DataItem, "id") + "'";
} 
```

我已将前面的代码放在 RowDataBound 事件中。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-13T17:12:18.270

```
protected void gvSearch_RowDataBound(object sender, GridViewRowEventArgs e)
{
    if (e.Row.RowType == DataControlRowType.DataRow)
    {
        string abc = ((GridView)sender).DataKeys[e.Row.RowIndex].Value.ToString();
        e.Row.Attributes["onClick"] = "location.href='Default.aspx?id=" + abc + "'";    
    }
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-07-07T14:01:28.313

```
protected void gvSearch_RowDataBound(object sender, GridViewRowEventArgs e) 
{ 
    if (e.Row.RowType == DataControlRowType.DataRow) 
    { 
        string abc = ((GridView)sender).DataKeys[e.Row.RowIndex].Value.ToString(); 
        e.Row.Attributes["onClick"] = "location.href='Default.aspx?id=" + abc + "'";     
    } 
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2011-06-15T09:46:31.653

```
protected void gvSearch_RowDataBound(object sender, GridViewRowEventArgs e)  
{     
 if (e.Row.RowType == DataControlRowType.DataRow)
        {
            GridViewRow gvr = e.Row;
            string abc = ((GridView)sender).DataKeys[e.Row.RowIndex].Value.ToString();         
            gvr.Attributes.Add("OnClick", "javascript:location.href='Default.aspx?id=" + abc + "'");
        }         

   }  
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-01T15:52:45.467

您的 ID 可以与 gridview 中显示的数据项相关吗？

如果是这样，您可以使用 e.Row.DataItem，并将其转换为任何类型。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-13T17:10:50.647

在网格视图中单击行重定向到其他页面

```
 protected void gvSearch_RowDataBound(object sender, GridViewRowEventArgs e)
    {
        if (e.Row.RowType == DataControlRowType.DataRow)
        {
             string abc = ((GridView)sender).DataKeys[e.Row.RowIndex].Value.ToString();
             e.Row.Attributes["onClick"] = "location.href='Default.aspx?id=" + abc + "'";
        }
    } 
```

工作得很好

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-06-22T14:14:48.373

您可以为它使用网格视图的 RowCommand 事件。在您要设置单击的按钮/链接中，设置 CommandName 和 CommandArgument，您可以在事件方法的 EventArgs 参数中访问它们。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2011-03-03T08:37:42.940

JohnB，您的代码工作得很好，我只添加了一点技巧，以避免在鼠标悬停后破坏 alterRowStyle。

```
e.Row.Attributes.Add("onmouseout", "this.style.backgroundColor=''"); 
```

变成：

```
e.Row.Attributes.Add("onmouseout", "if(" + e.Row.RowIndex + "% 2 == 0) { this.style.backgroundColor=''; } else { this.style.backgroundColor = '#E8F7EA'; }"); 
```

如果有更好的方法，请告诉我，但它对我来说是完美的。

问候。

# encoding - 编码问题经典ASP

> ID：331240
> 
> 赞同：2
> 
> 时间：2008-12-01T15:53:32.890
> 
> 标签：encoding, character-encoding, asp-classic

我对经典 ASP 有疑问。当我使用`XMLHttp.send`. 响应是一个 PDF 文件，但是“ÆØÅ”出错了，例如“Ø”被读作“Ã¸y”。这就像从 UTF-8 到 ISO-8859-1 的转换错误，但现在应该是 ISO-8859-1。我`<%@CODEPAGE="28591"%>`在页面顶部和`ISO-8859-1`XML 文件中的编码，我检查了文件，所以它是有效的 ISO-8859-1。我无权访问要发送此数据的服务器，但我将其修复在一个 VB6 程序中，该程序使用相同的逻辑：

```
aPostBody = StrConv(strBody, vbFromUnicode)
WinHttpReq.SetTimeouts 100000, 100000, 100000, 1000000
WinHttpReq.Send aPostBody 
```

在一个也使用相同逻辑的 C# 程序中

```
// ISO-8859-1
byte[] bytes = Encoding.GetEncoding(28591).GetBytes(data); 
```

但是在 ASP 经典中，我需要一些帮助来找到将字符串的编码更改为 ISO-8859-1 的方法。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-01T16:45:23.737

您是否尝试过使用[Response.Charset](http://www.w3schools.com/ASP/prop_charset.asp) 并将其设置为：

```
<% Response.Charset="ISO-8859-1"%> 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-01T16:06:23.020

尝试：

```
Session.CodePage = 28591 
```

这里有一些很好的信息，我在[这里](http://support.microsoft.com/kb/287946)[得到](http://devlibrary.businessobjects.com/BusinessObjectsXIR2/en/en/RAS_SDK/rassdk_com_doc/doc/rassdk_com_doc/BestPractices11.html)了 CodePage 号。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-02T11:28:29.943

检查 .ASP 文件的编码以及 .ASP 文件中包含的所有 .ASP 文件`#include`。

当我在 VS 中创建一个新的 .ASP 文件并以 UTF-8 编码时遇到问题。该文件被其他人包含，并且文件编码“覆盖”了所有其他编码命令。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-01T16:49:29.923

AFAIK 这是 WinHttpReq / XMLHTTPRequest 的一个已知问题，希望有人证明我错了。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-02T15:53:33.793

也请参考：[How do I set the character set using XMLHttp Object for a POST in classic ASP?](https://stackoverflow.com/questions/190988/how-do-i-set-the-character-set-using-xmlhttp-object-for-a-post-in-classic-asp)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-27T11:38:51.287

我在 ASP 和 Javascript 上都使用过这个组件，但是在 javascript 上我在这里找到了解决这个问题的方法：http: [//squio.nl/blog/2006/06/27/xmlhttprequest-and-character-encoding/](http://squio.nl/blog/2006/06/27/xmlhttprequest-and-character-encoding/)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-12-01T22:00:05.520

您是否尝试过使用与`meta`您正在做的事情等效的标签？

例子：

```
Response.Write("<meta http-equiv='Content-Type' content='text/html; charset=ISO-8859-1' />") 
```

注意：我使用 a`Response.Write`粘贴吐出字符集，因为例如，如果字符集是 UTF-8，Visual Studio 将尝试使用不同的编码保存文件。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2015-09-08T15:27:36.607

解决方案：

```
Response.AddHeader "Content-Type", "text/html;charset=UTF-8"
Response.CodePage = 65001
Response.CharSet = "UTF-8 
```

完成： [https ://pt.stackoverflow.com/questions/80886/encoding-asp-cl%C3%A1ssico/81418#81418](https://pt.stackoverflow.com/questions/80886/encoding-asp-cl%C3%A1ssico/81418#81418)

# windows-vista - 有没有办法让 Server 2008 *出现*为安装人员的 Vista？

> ID：331243
> 
> 赞同：2
> 
> 时间：2008-12-01T15:54:28.770
> 
> 标签：windows-vista, windows-server-2008, installation, compatibility

我有一个要安装在我的主开发框（Windows Server 2008）上的工具。安装程序告诉我它需要 Vista。当然，我并不是说 Server 2008 就是 Vista，但我认为安装在 Vista 上的东西应该能够安装在 Server 2008 上。

是否有某种方法（可能通过临时注册表更改）让服务器 2008 系统显示为 Vista 以安装软​​件？

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-01T16:20:40.667

Win2008Workstation 有一个如何使用 Orca 修补 MSI 文件[的示例指南。](http://www.win2008workstation.com/wordpress/2008/03/29/installing-unreal-tournament-3/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-01T15:55:57.050

右键单击并进入安装程序的属性时，您是否尝试过模拟器来运行安装？

右键单击>属性>兼容性>并将兼容模式更改为Windows XP或Windows Server 2003

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-01T16:10:46.677

一些想法：

*   如果是 MSI 安装程序，请[下载 orca](http://www.google.se/search?hl=sv&client=firefox-a&rls=org.mozilla%3Aen-US%3Aofficial&hs=Dqq&q=orca+download+msi&btnG=S%C3%B6k&meta=)并删除执行检查的自定义操作
*   使用诸如[进程监视器](http://technet.microsoft.com/en-us/sysinternals/bb896645.aspx)之类的工具来观察安装程序读取的注册表项并调整它们以匹配 vista。

# imagemagick - 如何使用 ImageMagick 像素化/模糊图像？

> ID：331254
> 
> 赞同：13
> 
> 时间：2008-12-01T15:56:21.683
> 
> 标签：imagemagick

我想像素化和/或模糊图像。我找到了模糊的命令：

```
$convert image.jpg -blur 18,5 newimage.jpg 
```

工作，但我不能再模糊图像了。以及如何像素化图像？我在网上找不到合适的例子。

谢谢

* * *

## 回答 #1

> 赞同：47
> 
> 时间：2009-02-03T10:35:41.637

要获得正确的方形像素化，请尝试：

```
convert -scale 10% -scale 1000% original.jpg pixelated.jpg 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-12-01T16:13:45.907

这对我来说效果很好，在像素化和模糊之间提供了一种交叉：

```
convert -resize 10% image.jpg newimage.jpg
convert -resize 1000% newimage.jpg newimage.jpg 
```

如果这对您很重要，您可以确定无法检索数据。

更改 %ages 将更改像素化/模糊量

* * *

## 回答 #3

> 赞同：-5
> 
> 时间：2008-12-01T16:09:52.623

我对 ImageMagick 一无所知，但您可以尝试使用双三次将图像调整为更小的尺寸，然后将图像调整回更大的尺寸。

该技巧使用 .net 的 System.Drawing 对象起作用。

# apache-flex - 允许在 MXML 中自定义数据的文本表示

> ID：331255
> 
> 赞同：0
> 
> 时间：2008-12-01T15:57:01.213
> 
> 标签：apache-flex, actionscript-3, air, mxml

我有一个名为 Dimension 的 actionscript 类，它允许客户使用一个值和一个单位（例如“CM”或“Inches”）来指定一个维度。我想使用这个类的一个实例作为 MXML 中的一个属性，所以用户可以编写

```
<DimensionView value="2cm"/> 
```

如何使“2cm”成为 Dimension 可接受的字符串值？我假设我需要在我的 Dimension 类上编写一个解析器方法，但我无法确定应该实现哪个接口来提供此功能。

任何人都可以帮忙吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-01T17:14:51.353

一种选择是将`value`属性键入为 a `String`，为其编写一个 getter 和一个 setter 并在那里进行解析：

```
/**
* docs here
*/
[Bindable(event="valueChanged")]
public function get value():String
{
    return _valueInt.toString();
}
/**
* @private
*/
public function set value(aVal:String):void
{
    // parse the aVal String to an int (or whatever) here
    _valueInt = parsed_aVal;
    dispatchEvent(new Event("valueChanged"));
} 
```

在相关的说明中，框架组件实现了允许在某些大小调整属性中使用百分号的功能，当在 MXML 中分配时，通过使用名为[`PercentProxy`](http://nondocs.blogspot.com/2007/04/metadatapercentproxy.html). 下面的示例是来自的`width`属性 getter 和 setter `mx.core.UIComponent`：

```
[Bindable("widthChanged")]
[Inspectable(category="General")]
[PercentProxy("percentWidth")]
override public function get width():Number
{
    // --snip snip--
}
override public function set width(value:Number):void
{
    // --snip snip--
} 
```

# c# - 有没有更好的方法在 C# 中自定义 SOAP 标头

> ID：331262
> 
> 赞同：1
> 
> 时间：2008-12-01T16:01:30.753
> 
> 标签：c#, .net, web-services, soap, asmx

过去，我需要在使用导入的 WSDL Web 引用的 C# 项目中创建自定义 SOAP 标头。我找到了一种方法来做到这一点，但我对此并不满意，我想知道是否有更好的方法。我所做的是创建一个从 SoapHeader 派生的标头：

```
[System.Xml.Serialization.XmlTypeAttribute(Namespace = "http://model.test.net")]
[System.Xml.Serialization.XmlRootAttribute("securitytoken", Namespace = "http://model.test.net", IsNullable = false)]
public class SpecialHeader : SoapHeader
{ 
  [System.Xml.Serialization.XmlTextAttribute()]
  public string aheadervalue;
} 
```

然后，我必须修改从 WSDL 生成的代码，并在我想要包含自定义标头的每个 Web 调用之前添加对新标头实例和以下内容的引用：

```
[System.Web.Services.Protocols.SoapHeaderAttribute("instancename", Direction=System.Web.Services.Protocols.SoapHeaderDirection.InOut)] 
```

其中“instancename”是生成的类中自定义标头的实例变量名称。

这工作得很好，除了 WSDL 中的任何更改都需要重新完成，因为它会重新生成类。在其他语言中，可以在生成的代码之外添加标头，所以也许我错过了在 C# 中完成的方式。有没有更好的方法来做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-17T15:27:47.270

看来您正在使用 .Net 2.0 和 asmx webservices。你知道.Net 3.0中有一个叫WCF（Windows Communication Framework）的框架吗？我知道迁移到一个新的框架并不容易，但是有了 WCF，你会得到很多。此外，WCf 的用途远不止 WebServices（远程处理、msmq 等）。这是微软为未来押注的框架。IE。使用 MessageContracts 操作肥皂头。

所以答案是在 WCF 中你可以使用 MessageContracts 来做到这一点。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2011-06-30T07:54:05.070

因为生成的类是部分类。您可以在另一个具有相同命名空间和类名的文件上定义它（同样是部分类）。然后你可以覆盖它的虚拟方法并定义一次。

这可以防止对重新生成的类的进一步更改不会影响您编写的类。

在新的类文件上，您可以使用“GetWriterForMessage”来覆盖并向其添加新的 SOAP 标头。

```
public partial class SampleService
{
    public string MessageID { get; set; }

    protected override System.Xml.XmlWriter GetWriterForMessage(System.Web.Services.Protocols.SoapClientMessage message, int bufferSize)
    {
        message.Headers.Add(new UsernameSoapHeader("Username"));
        message.Headers.Add(new PasswordSoapHeader("Password"));
        message.Headers.Add(new MessageIDSoapHeader(MessageID));
        return base.GetWriterForMessage(message, bufferSize);
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-02T04:44:44.940

有一种方法可以做到这一点；它不一定很漂亮，在一个非常简单的 Web 服务上，它可能不值得付出努力，但它至少可以让您在重新生成代码时不必重新添加属性。

由于生成器生成部分类，您可以：

1.  将一个文件添加到您的项目中，该文件使用另一个“部分”部分（即，使用与生成的类相同的名称空间和名称，并将其标记为“部分”）扩展 Web 服务类（从 SoapHttpClientProtocol 派生的）。

2.  从生成的代码中复制您想要添加标题的方法（即，您已经添加属性的相同方法）并将它们粘贴到您的扩展部分。

3.  稍微重命名这些方法，以便它们不会与生成的代码中的方法冲突，并更改传递给 Invoke 的名称以匹配。（您可能还必须调整方法上的其他属性，以确保它们仍然映射到 WSDL 中的正确调用。）

4.  将自定义标头属性添加到重命名的方法中，并将标头实例字段添加到您的扩展部分。

5.  从您的代码中调用重命名的版本而不是原始版本。

只要方法签名在 WSDL 中没有更改，即使重新生成，您也不必更改代码中的任何内容。（由于您只复制相对较短的方法实现，WSDL 中的任何其他结构仍然会从生成的代码中出来，因此如果它们发生更改，您将在重新生成时自动获得更新的版本。当然，如果 WSDL 没有有任何其他结构，它的效用可能有些有限。）

它仍然不理想，但没有尝试拦截原始 XML 消息并将标头直接放入（您可能会这样做，但它会很讨厌），实际上没有任何其他我知道的选项（无需移动无论如何都要转到WCF）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-04-13T16:40:25.323

我今天遇到了这个问题。我结束了创建从自动生成的类派生的类并覆盖[GetWriterForMessage](http://msdn.microsoft.com/en-us/library/system.web.services.protocols.soaphttpclientprotocol.getwriterformessage.aspx)方法以确保我的标头始终存在。我会在每次调用该方法时更新标头值。

# asp.net - 如何选择可数据绑定的网格控件

> ID：331264
> 
> 赞同：0
> 
> 时间：2008-12-01T16:02:23.747
> 
> 标签：asp.net, gridview, listview, datagrid, datalist

我最近开始使用 ASP.NET 3.5，之前使用 C# 和 WinForms（主要是 .NET 1.1）大约 6 年。

每次我需要允许用户查看、添加/删除或编辑项目列表时，我都会头晕目眩。这是由于以下控件的相似之处和不同之处

*   数据网格
*   网格视图
*   列表显示
*   数据列表

谁能指出我正确的方向，该列表对这些控件进行并排比较？

哪个是您的“最喜欢”，或者您最喜欢任何特定场景？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-01T17:33:31.300

简短的回答，除了列表视图，它们都很糟糕；-) 根据您的具体情况，您可能希望查看第三方功能更全的网格，例如 Telerik 或 devexpress。

长答案，这取决于你想做什么。

DataGrid 和 DataList 主要用于向后兼容。GridView 和 DataList 比旧版本更好。

GridView 适用于您想要显示数据网格的情况。它主要免费为您提供 CRUD（创建读取更新删除）操作，并且主要免费提供分页和排序（取决于您使用的数据源类型）

DataList 适用于您想要更自由形式的值列表时。

ListView（和 datapager）是我们全新的 asp 3.5 控件，比 DataList 更自由。它允许您使用任何您喜欢的内容设置布局模板，以及将为列表中的每个项目重复的项目模板。您将容器元素（div/panel/placeholder）粘贴到布局模板中，然后告诉控件它是哪个，它会为列表中的每个项目重复项目模板。

您还可以将 DataPager 控件指向它，并且主要免费获得分页。

根据您正在做的网站类型，使用内置数据控件（除了中继器和列表视图）可能最终会将您画到一个角落，因为它们需要更多的开销。如果这是一个小型的一次性项目，那不是什么大问题。如果它是一个性能将成为问题的大项目，我建议再次检查第三方控件。

# ado.net - 如何：使用 DataRelation 对 DataSet 中的两个 DataTable 执行连接？

> ID：331265
> 
> 赞同：3
> 
> 时间：2008-12-01T16:02:40.827
> 
> 标签：ado.net, datarelation

如何在数据集中的两个数据表之间执行连接？

我在两个表之间创建了一个 DataRelation……然后呢？

我正在查看有关如何将行从表复制到结果表的一种解释（ [http://www.emmet-gray.com/Articles/DataTableJoins.htm ）？](http://www.emmet-gray.com/Articles/DataTableJoins.htm)

有一个更好的方法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-01T19:31:49.657

看看这是否有帮助

```
DataTable person = new DataTable();
person.Columns.Add("Id");
person.Columns.Add("Name");

DataTable pet = new DataTable();
pet.Columns.Add("Id");
pet.Columns.Add("Name");
pet.Columns.Add("OwnerId");

DataSet ds = new DataSet();
ds.Tables.AddRange(new[] { person, pet });

ds.Relations.Add("PersonPet",person.Columns["Id"], pet.Columns["OwnerId"]);

DataRow p = person.NewRow();
p["Id"] = 1;
p["Name"] = "Peter";
person.Rows.Add(p);

p = person.NewRow();
p["Id"] = 2;
p["Name"] = "Alex";
person.Rows.Add(p);

p = pet.NewRow();
p["Id"] = 1;
p["Name"] = "Dog";
p["OwnerId"] = 1;
pet.Rows.Add(p);

p = pet.NewRow();
p["Id"] = 2;
p["Name"] = "Cat";
p["OwnerId"] = 2;
pet.Rows.Add(p);

foreach (DataRow personRow in person.Rows)
{
    Console.WriteLine("{0} - {1}",personRow["Id"], personRow["Name"]);
    foreach (DataRow petRow in personRow.GetChildRows("PersonPet"))
    {
        Console.WriteLine("{0} - {1}", petRow["Id"], petRow["Name"]);
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-01T19:17:41.760

DataTables 仅支持在其拥有的列上进行选择，不支持连接多个表。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-02T02:58:06.443

我正在寻找相同问题的解决方案。好吧，我已经放弃了，用 SQL 来做一个 join。

有人写了一些自定义代码来实现加入DataTable。也许它们对您有帮助： [http ://www.emmet-gray.com/Articles/DataTableJoins.htm](http://www.emmet-gray.com/Articles/DataTableJoins.htm)

# c - time.h 替换：time_t 用于 ANSI-C 或 C99 中的值（年 < 1970）和（年 > 2038）

> ID：331271
> 
> 赞同：3
> 
> 时间：2008-12-01T16:05:23.990
> 
> 标签：c, datetime

我在 ANSI C 中有一段代码，它使用 time.h 库和 time_h 结构来（在其他与日期相关的计算中）计算出两个给定日期之间的间隔。这很好用，但这将我的代码限制在 1970 到 2038 之间。我现在想让我的代码更通用。

是否有一个通用的 C 库（ANSI 或 C99 标准）以 1 天的粒度在大于 time.h 的范围内实现日期计算（即我需要当天的分辨率，但小时分辨率不是必需的）？

（我正在修改代码以处理历史事件，因此如果它也可以处理 BC 的日期会很好......）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-07T00:51:55.950

是的，[y2038 项目](http://code.google.com/p/y2038/)正在重新实现 time.h 以确保 2038 安全。到目前为止`gmtime()`,`localtime()`和已经完成`mktime()`并且`gmtime()`经过了很好的测试。这些是难点。它向任一方向跨越约 3000 亿年。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-01T16:50:14.633

SQLite 中使用了一个公共领域的实现：[文档](http://www.sqlite.org/lang_datefunc.html)，[源](http://www.sqlite.org/cvstrac/fileview?f=sqlite/src/date.c&v=1.94)

我还发现[日历常见问题解答](http://www.tondering.dk/claus/calendar.html)很有用；[这个](http://www.smart.net/~mmontes/ec-cal.html)页面很早就在谷歌上弹出。

# .net - 可以在不编译 xaml 的情况下部署 wpf 应用程序吗？

> ID：331273
> 
> 赞同：7
> 
> 时间：2008-12-01T16:05:52.037
> 
> 标签：.net, wpf, xaml, deployment

是否可以以可以在运行时操作 xaml 文件的方式部署 WPF Windows 应用程序？如果可能的话，我想这将类似于一个 asp.net 应用程序，它可以将 .aspx 页面部署为内容，然后在运行时即时编译。

我想通过编辑 XAML 来允许在运行时编辑屏幕的简单布局。有谁知道这是否可能？

**编辑：**当我提到 xaml 文件时，我的意思是我的 UIElement 类对应的 xaml。换句话说，我已经使用 Xaml 和代码隐藏、继承、事件处理程序、程序集引用等定义了 UserControl 类。当部署时间到来时，我希望能够保留代码隐藏功能但仍然允许 xaml待编辑。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-12-04T02:07:41.637

感谢 unthinkableMayhem 的参考。

松散 XAML 的问题在于，在运行时调用 XamlReader 时，无法将事件连接到程序集中的函数，也没有动态加载程序集的机制。在 XAML 中指定路由事件的处理程序的方式是 WPF/XAML 的最大设计缺陷之一，这使得松散的 XAML 几乎毫无用处。

我在 XAML 中嵌入动态语言运行时 (DLR) 脚本所做的工作对于松散和编译的 XAML 都很有用。我的意图是通过允许松散 XAML 中可用的路由事件、命令、值转换器和其他 XAML/WPF 概念，使松散 XAML 成为 WPF 中的一等公民。我觉得这已经实现了（虽然我的博客没有提到动态加载程序集，但这是直截了当的）。

如果您坚持，则可以部署 WPF Windows 应用程序，使 xaml 文件可以在运行时进行操作。哎呀，您可以使用嵌入式脚本动态生成 XAML - 无需组装。伙计，这是我长期以来所说的最有趣的事情之一。

但请注意 - XAML 中的“X”只是一个营销术语。从工程的角度来看，它是不可扩展的，所以当你离开微软设定的道路时，期待一个痛苦的世界。如果您这样做，我将很乐意为您提供帮助 - 我的网站 (www.thinkbottomup.com.au) 上的联系方式。

干杯，

担

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-12-04T02:37:41.387

我有另一个建议给你——真正的问题是：

“我想通过编辑 XAML 来允许在运行时编辑屏幕的简单布局。有人知道这是否可能吗？”

答案是肯定的，“是”！有很多方法可以实现这一点，当然需要做一些假设。

如果您不需要在 XAML 的“动态”部分处理事件或编写自定义值转换器（或通常在后面的代码中使用的任何其他内容），那么您可以简单地使用 XamlReader 类来解析 XAML 文件或包含 XAML 的字符串。由于您只是在编辑布局，我希望这些假设成立。

所以，这就是我要做的：

1) 编写所有自定义控件、数据模型、值转换器等，并将它们粘贴到程序集中。

2）通过让您的应用程序引用它或动态加载它来加载该程序集 - 两者都可以工作。

3) 创建一个字符串/文件/资源​​（任您选择），其中包含您的 XAML 进行布局，并完成您的 .NET 命名空间到 XML 命名空间的映射。确保根元素上没有“x:Class”属性，因为您没有代码隐藏文件！该字符串将使用标准 WPF 控件（如 StackPanel）来布局您的自定义控件。（当然你也可以编写自定义布局控件）。

4) 允许用户编辑这个字符串。编辑完成后，使用 XamlReader 解析文件，然后在窗口中显示生成的 UIElement。

答对了！

一个问题 - 每次更改 XAML 时，都会抛出 GUI 并创建一个新的。如果你的 GUI 是令人满意的（即使当前插入符号的位置很重要），用户很快就会生气。这取决于您打算使用什么 - 这可能不是问题。

我希望通过更多的工作，您可以编写一个 MarkupExtension 用于引用您尝试布局的部分。这样，当布局更改时，它们可以被重用。

我希望这很清楚。如果没有，请告诉我，我可以扩展这个概念——它会成为一个不错的博客条目。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-12-01T16:52:12.757

不容易。WPF 应用程序将其 XAML 由编译器翻译成 .g.cs 和 .baml，然后编译成二进制文件。

当然可以创建运行时 XAML 编译器。这不是一件容易的事，而且真的需要思考一下为什么不把它作为一个网站来做！

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-12-01T23:45:42.657

这篇博文：[http](http://www.thinkbottomup.com.au/site/blog/Embedding_DLR_Scripts_in_XAML_Part_6) ://www.thinkbottomup.com.au/site/blog/Embedding_DLR_Scripts_in_XAML_Part_6有一些关于在运行时加载 XAML 以及其他有趣的东西的信息。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2011-07-26T23:47:04.043

看看[http://xtrememvvm.codeplex.com/](http://xtrememvvm.codeplex.com/)

它允许您使用松散的 XAML 文件，但仍然挂钩到事件、数据绑定和路由命令。

*   黏土

2012 年 10 月 7 日编辑：应 Robert Harvey 的要求，我是上述框架的作者。考虑到它是开源的，我并没有试图隐藏任何东西，只是认为它不相关。无论如何，我一定会在以后的任何帖子中披露我的从属关系（如果有的话）。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-01T17:03:07.773

XAMLPad 和[XAML Cruncher](http://www.charlespetzold.com/blog/2007/07/100411.html)都这样做，所以它一定是可能的。

XAML Cruncher 源代码仅在 Charles Petzold 关于 WPF 的书中提供：

[http://www.charlespetzold.com/wpf/](http://www.charlespetzold.com/wpf/)

看起来它使用[XamlReader](http://msdn.microsoft.com/en-us/library/system.windows.markup.xamlreader.aspx)来解析 XAML。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-12-01T17:03:53.327

您可以在运行时将 XAML 加载到应用程序，如下所示。

```
UIElement documentRoot = (UIElement)System.Windows.Markup.XamlReader.Load(xmlReader); 
```

有一个“松散 XAML”的概念。松散 XAML 基本上是允许您打开硬盘上的任何 XAML 文件（或网页上的超链接）并在浏览器中“运行”它而无需编译的功能。

查看此示例松散 XAML 页面，其中包含我已实现的一组按钮和自定义控件模板，[http://wpf.ria-labs.com/ux.xaml](http://www.ria-labs.com/Resources/download.php?file=JellyButton_Theme.xaml)在此[博客](http://jobijoy.blogspot.com/)中 它只是在 IE 中打开。您可以将 XAML 加载到 WPF 应用程序并可以使用。

# c# - “/”应用程序中的服务器错误。没有为此对象定义无参数构造函数

> ID：331276
> 
> 赞同：13
> 
> 时间：2008-12-01T16:06:47.497
> 
> 标签：c#, asp.net-mvc

调用堆栈显示以下内容：

```
[MissingMethodException: No parameterless constructor defined for this object.]
System.RuntimeTypeHandle.CreateInstance(RuntimeType type, Boolean publicOnly, Boolean noCheck, Boolean& canBeCached, RuntimeMethodHandle& ctor, Boolean& bNeedSecurityCheck) +0
System.RuntimeType.CreateInstanceSlow(Boolean publicOnly, Boolean fillCache) +86
System.RuntimeType.CreateInstanceImpl(Boolean publicOnly, Boolean skipVisibilityChecks, Boolean fillCache) +230
System.Activator.CreateInstance(Type type, Boolean nonPublic) +67
System.Activator.CreateInstance(Type type) +6
System.Web.Mvc.DefaultModelBinder.CreateModel(ModelBindingContext bindingContext, Type modelType) +277
System.Web.Mvc.<>c__DisplayClass1.<BindModel>b__0() +98
System.Web.Mvc.ModelBindingContext.get_Model() +51
System.Web.Mvc.DefaultModelBinder.BindModelCore(ModelBindingContext bindingContext) +2600
System.Web.Mvc.DefaultModelBinder.BindModel(ModelBindingContext bindingContext) +1067
System.Web.Mvc.DefaultModelBinder.BindProperty(ModelBindingContext parentContext, Type propertyType, Func`1 propertyValueProvider, String propertyName) +208
System.Web.Mvc.DefaultModelBinder.BindModelCore(ModelBindingContext bindingContext) +1787
System.Web.Mvc.DefaultModelBinder.BindModel(ModelBindingContext bindingContext) +1067
System.Web.Mvc.ControllerActionInvoker.GetParameterValue(ParameterInfo parameterInfo) +355
System.Web.Mvc.ControllerActionInvoker.GetParameterValues(MethodInfo methodInfo) +439
System.Web.Mvc.ControllerActionInvoker.InvokeAction(ControllerContext controllerContext, String actionName) +288
System.Web.Mvc.Controller.ExecuteCore() +180
System.Web.Mvc.ControllerBase.Execute(RequestContext requestContext) +96
System.Web.Mvc.ControllerBase.System.Web.Mvc.IController.Execute(RequestContext requestContext) +36
System.Web.Mvc.MvcHandler.ProcessRequest(HttpContextBase httpContext) +377
System.Web.Mvc.MvcHandler.ProcessRequest(HttpContext httpContext) +71
System.Web.Mvc.MvcHandler.System.Web.IHttpHandler.ProcessRequest(HttpContext httpContext) +36
System.Web.CallHandlerExecutionStep.System.Web.HttpApplication.IExecutionStep.Execute() +181
System.Web.HttpApplication.ExecuteStep(IExecutionStep step, Boolean& completedSynchronously) +75 
```

我有一个带有一堆隐藏字段和一个提交按钮的小表单。当我按下它时，我什至从未点击过请求的方法。

我该如何继续调试呢？如果我知道 WHAT 对象没有无参数构造函数，那将是一个很好的开始。这个物体在哪里？我该如何解决这个问题？我知道这个问题相当模糊，但目前这就是我所拥有的一切......

**--EDIT--**
在我的表单中，我添加了 Html.Hidden() 输入。根据先前的操作，这些可以具有“”值。该操作使用 ModelBinding。每当值是“”并且数据类型是 SelectList 时，modelbinder 就会对我发脾气。

我对 SelectList 的做法感到越来越不舒服……这个想法很好，但也存在一些问题。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-05T18:16:37.067

我解决了由 SelectList 对象引起的问题，因为它不提供默认构造函数，因此我们无法使用 ViewModel。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-03-08T14:38:20.983

对于那些在谷歌上搜索此异常的人，这是一种更通用的诊断方法：

我发现诊断此问题的唯一简单方法是使用您自己的代码尽可能接近异常覆盖 MVC。然后，当发生此异常时，您的代码将在 Visual Studio 中中断，您可以从堆栈跟踪中读取导致问题的类型。

这似乎是解决这个问题的一种可怕的方法，但它非常快，而且非常一致。

例如，如果此错误发生在 MVC DefaultModelBinder 内部（您将通过检查堆栈跟踪知道），则将 DefaultModelBinder 替换为以下代码：

```
public class MyDefaultModelBinder : System.Web.Mvc.DefaultModelBinder
{
    protected override object CreateModel(System.Web.Mvc.ControllerContext controllerContext, System.Web.Mvc.ModelBindingContext bindingContext, Type modelType)
    {
        return base.CreateModel(controllerContext, bindingContext, modelType);
    }
} 
```

并更新您的 Global.asax.cs：

```
public class MvcApplication : System.Web.HttpApplication
{
...
    protected void Application_Start(object sender, EventArgs e)
    {
        ModelBinders.Binders.DefaultBinder = new MyDefaultModelBinder();
    }
} 
```

现在，当您下次遇到该异常时，Visual Studio 将在您的 MyDefaultModelBinder 类中停止，您可以检查“modelType”属性以查看导致问题的类型。

上面的示例仅适用于在模型绑定期间获得“没有为此对象定义无参数构造函数”异常的情况。但是可以为 MVC 中的其他扩展点（例如控制器构造）编写类似的代码。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-12-01T20:02:04.683

操作 args 中的自定义类必须具有无参数构造函数才能使用默认模型绑定器。否则，要么 (1) 创建自定义模型绑定器，要么 (2) 将原始类型而不是自定义类传递给 Action。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-08-25T18:10:03.117

我的视图模型类上也有返回 SelectList 实例的属性。我用 Bind 属性装饰了我的类，以排除这些属性，如下所示：

`[Bind(Exclude = "Countries")] public class MyViewModel { ...`

 ````
public SelectList Countries { get; set; } 
```` 

`}`

希望有帮助，罗杰

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-12-01T18:14:10.063

您是否删除了 Default.aspx？这需要到位才能正确渲染根。如果您尝试使用 Dependency Injection 并且您的容器没有正确设置，这也可能发生 - 这意味着没有 ControllerFactory 向 DI 容器询问实例。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2011-11-10T21:07:49.027

我的问题的根源也是 SelectList。

我有这个：

```
<%: Html.DropDownListFor(m => Model.Destinations, Model.Destinations)%> 
```

当我应该有这个时：

```
<%: Html.DropDownListFor(m => Model.Destination, Model.Destinations)%> 
```

Destination 是用户的选择，Destinations 是可能值的列表。使用复数 SelectList 两次导致了问题。

# asp.net - 如何在 asp.net 中使用“发布/重定向/获取”又名“发布后重定向”

> ID：331277
> 
> 赞同：4
> 
> 时间：2008-12-01T16:07:09.133
> 
> 标签：asp.net, post, post-redirect-get, redirect-after-post

在 asp.net 中的某些操作后进行刷新似乎会使它们再次发生，即使该操作没有意义（想想双重删除）。处理这种情况的 Web 方法是在发布后重定向以获得干净版本的页面，无需将操作重新发布到 Web 服务器即可刷新。如何使用 ASP.NET 做到这一点

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-01T16:26:29.017

我有一种感觉，有一个更深层次的问题我没有得到，但这里有。在您的回发事件中：

```
// the post handling logic, e.g. the click event code
Response.Redirect(Request.RawUrl); 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2008-12-01T17:27:56.413

使用 Server.Transfer 方法。

Server.Transfer 方法有第二个参数——“preserveForm”。如果将此设置为 True，使用诸如 Server.Transfer("WebForm2.aspx", True) 之类的语句，现有的查询字符串和任何表单变量仍可用于您要转移到的页面。

[http://www.developer.com/net/asp/article.php/3299641](http://www.developer.com/net/asp/article.php/3299641)

# windows - 如何让 TortoiseSVN 忽略已从 repo 中删除的空目录？

> ID：331278
> 
> 赞同：0
> 
> 时间：2008-12-01T16:07:29.850
> 
> 标签：windows, svn, tortoisesvn

我有一些已移动或重命名的目录。Linux 命令行 SVN 客户端会忽略这些目录。Explorer 的 TortoiseSVN 插件展示了它们。如果我删除它们并更新它们，它们就会回来。

所有文件移动和删除都是使用 Linux SVN CLI 工具完成的。在 Linux 系统上执行 'svn update' 甚至是新的 'svn co' 时，这些空目录不会显示。

当使用 TortoiseSVN 进行新的检出时，会创建空目录，即使它们不再存在于 HEAD 修订版中。

我怎样才能让他们消失？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-12-01T16:37:15.157

听起来像是客户的问题。除非我误读了您，否则您的 SVN 操作已正确完成。

几个选项：

*   您的客户将获得错误的修订版
*   您的客户端以某种方式运行到某种缓存中（您是否在端口 80 上运行 SVN？）
*   有人在服务器上设置了一些花哨的东西，比如 2 个相互镜像但很糟糕的 repos。

在我看来，只有第一个可能。我要做的是找出 linux 端正在使用的 URL，并在 Windows 端重新签出到一个新位置，并专门检查以确保修订设置为 head。如果这不起作用，我不知道问题可能是什么。如果是这样，它会限制很多问题。

ps，刚刚想了想，上面的失败尝试恢复到头部修改。我不认为它会起作用，但是......

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-06T03:13:33.560

我最终删除了 Windows 工作副本中的目录，现在这些目录已经消失了。不知道为什么这是必要的。

结束问题...

# .net - 如何将变音符号更改为非变音符号

> ID：331279
> 
> 赞同：13
> 
> 时间：2008-12-01T16:07:43.877
> 
> 标签：.net, replace, character, diacritics

我找到了如何在 stackoverflow 上删除变音符号的答案，但是您能否告诉我是否可以将变音符号更改为非变音符号？

哦..我考虑.NET（或其他如果不可能的话）

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2010-07-22T23:25:27.277

由于没有人费心发布代码来执行此操作，因此这里是：

```
 // \p{Mn} or \p{Non_Spacing_Mark}: 
    //   a character intended to be combined with another 
    //   character without taking up extra space 
    //   (e.g. accents, umlauts, etc.). 
    private readonly static Regex nonSpacingMarkRegex = 
        new Regex(@"\p{Mn}", RegexOptions.Compiled);

    public static string RemoveDiacritics(string text)
    {
        if (text == null)
            return string.Empty;

        var normalizedText = 
            text.Normalize(NormalizationForm.FormD);

        return nonSpacingMarkRegex.Replace(normalizedText, string.Empty);
    } 
```

注意：需要这样做的一个重要原因是当您集成到仅执行 ascii 的 3rd 方系统时，但您的数据是 unicode。这很常见。您的选择基本上是：删除重音字符，或尝试从重音字符中删除重音以尝试尽可能多地保留原始输入。显然，这不是一个完美的解决方案，但它比简单地删除 ascii 127 以上的任何字符要好 80%。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2008-12-01T16:21:49.510

[从我自己的答案](https://stackoverflow.com/questions/285228/how-to-convert-utf-8-to-us-ascii-in-java#285791)复制到另一个问题：

> 您可以将文本转换为规范化形式 D，而不是创建自己的表格，其中字符表示为基本字符加上变音符号（例如，“á”将替换为“a”，后跟一个组合的重音符号）。然后，您可以剥离所有不是 ASCII 字母的内容。
> 
> 这些表仍然存在，但现在是来自 Unicode 标准的表。
> 
> 您也可以尝试使用 NFKD 而不是 NFD，以捕获更多病例。
> 
> 参考：
> 
> *   [http://unicode.org/reports/tr15/](http://unicode.org/reports/tr15/)
> *   [http://www.siao2.com/2005/02/19/376617.aspx](http://www.siao2.com/2005/02/19/376617.aspx)
> *   [http://www.siao2.com/2007/05/14/2629747.aspx](http://www.siao2.com/2007/05/14/2629747.aspx)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-12-01T16:22:02.973

退后一步考虑一下*为什么*要这样做也可能是值得的。如果您尝试删除您认为无关紧要的字符差异，您应该查看 Unicode 排序算法。这是在比较字符串以进行搜索或排序时忽略大小写或变音符号等差异的标准方法。

如果您计划显示修改后的文本，请考虑您的受众。您可以安全过滤掉的内容是区域敏感的。在美国英语中，“Igloo”=“igloo”，“resume”=“resume”，但在土耳其语中，小写 I 是 ı（无点），在法语中，cote 表示引用，côté 表示侧面，côte 表示海岸。因此，排序语言决定了哪些差异是显着的。

如果删除变音符号是您的应用程序的正确解决方案，那么生成您自己的表是最安全的，您可以在其中明确添加要转换的字符。

可以使用 Unicode 分解来设计一种通用的自动化方法。有了这个，您可以将带有变音符号的字符分解为“组合”字符（变音符号）和它们组合的基本字符。过滤掉任何是组合字符的东西，你应该有“非变音符号”的东西。

然而，自动化方法缺乏辨别力可能会产生一些意想不到的影响。我建议对有代表性的文本进行大量测试。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-07T15:00:29.403

举个简单的例子：

要从字符串中删除变音符号：

```
string newString = myDiacriticsString.Normalize(NormalizationForm.FormD); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-01-16T19:20:50.187

我的网站从具有许多奇怪字符的外部来源输入数据。我编写了以下 C# 函数来替换重音字符并使用正则表达式去除非美国键盘字符：

```
 using System.Text;
    using System.Text.RegularExpressions;

    internal static string SanitizeString(string source)
    {
        return Regex.Replace(source.Normalize(NormalizationForm.FormD), @"[^A-Za-z 0-9 \.,\?'""!@#\$%\^&\*\(\)-_=\+;:<>\/\\\|\}\{\[\]`~]*", string.Empty).Trim();    
    } 
```

希望能帮助到你。

# serialization - 为异步消息序列化对象

> ID：331280
> 
> 赞同：4
> 
> 时间：2008-12-01T16:08:16.260
> 
> 标签：serialization, asynchronous, messaging, amqp

我正在考虑使用 AMQP（使用 qpid）来启用 Python 和 Java 服务的混合相互通信。基本的短信似乎很简单，但与我研究过的所有其他短信技术一样，它似乎停止了。除了构建即时消息应用程序之外，我认为发送字符串并不是一件特别有用的事情，但一个又一个示例演示了如何发送未格式化的文本。

我的直觉是使用 XML（反）序列化或类似的东西（JSON、YAML、协议缓冲区等），它们在两种语言中都有很好的库支持。这是最佳实践吗？如果是，人们会推荐哪种（反）序列化协议？还是我在某处遗漏了要点，并且应该很满足发送少量文本？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-12-03T19:05:37.667

Owen，我可以谈谈 RabbitMQ。

AMQP 是一种二进制协议，您当然可以做的不仅仅是发送字符串！您打算使用哪个 Python 客户端？我们推荐 Barry Pederson 的客户端用于大多数用途：[http](http://barryp.org/software/py-amqplib/) ://barryp.org/software/py-amqplib/ 非常欢迎您来到 RabbitMQ 列表，就您的帖子和评论提出任何您喜欢的问题： -)

正如 James 所指出的，JSON 是好的。RabbitMQ 支持通过 HTTP 连接到 AMQP 后端的 JSON-RPC。人们还将 RabbitMQ 与 Orbited 一起用于彗星类型的应用程序。

此外，我们是 James 发明的 XMPP 和 STOMP 的粉丝并支持。STOMP 对于特定类别的消息传递应用程序很方便，并且 RabbitMQ 支持直接路由和基于主题的路由。我们发现它是一种与 ActiveMQ 互操作的好方法，在这种情况下更喜欢它而不是 JMS。

我希望您为您的用例找到合适的服务器，并建议您尝试不同的组合以获得最佳效果。

干杯，

亚历克西斯

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-02T00:27:31.773

值得一提的是，我在使用 AMQP + Protocol Buffers 方面一直有很好的体验。

如果发件人正在序列化消息，您可能需要在标头中包含一个 id，以便您知道如何在接收端进行反序列化。但是，这并不太难完成。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-02T09:22:24.613

XML 或 JSON 可能是最简单的。协议缓冲区很酷，但如果您真的需要，我会将其视为稍后考虑的优化（因为它本质上是二进制线路格式有点难以使用）。

顺便说一句，您可能想看看 Stomp 而不是 AMQP；它有更多的客户端库和支持的消息代理。例如[Apache ActiveMQ](http://activemq.apache.org/)，它比 qpid 或 rabbitmq 更受欢迎——或者实际上任何[JMS 提供程序](http://stomp.codehaus.org/StompConnect)都可以正常工作。

# .net - CreateEnhMetaFile 和 PlayEnhMetaFile 的 .NET 等价物是什么？

> ID：331281
> 
> 赞同：1
> 
> 时间：2008-12-01T16:08:30.863
> 
> 标签：.net, c++, printing, metafile

我正在将一些 C++ 代码移植到 VB.NET，它创建了一个由多个页面组成的打印作业。每个页面都有一个图形对象（文本、线条、曲线等）模板，在每个页面上保持相同，并且覆盖在每个页面上的是不同的数据。

模板在打印作业开始时使用 来创建为内存中的元文件`CreateEnhMetaFile`，并且在每个页面的开始处，该元文件使用 被绘制到打印设备上下文中`PlayEnhMetaFile`。

我怎样才能在.NET 中做到这一点？到目前为止，从我对 API 的阅读来看，我似乎只能`Metafile`从文件或流中导入一个，而不能从头开始创建一个。这个对吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-12-01T16:17:36.070

请查看以下页面...

1) [http://msdn.microsoft.com/en-us/library/zbk7dbtb.aspx](http://msdn.microsoft.com/en-us/library/zbk7dbtb.aspx)
2) [http://msdn.microsoft.com/en-us/library/ms536391.aspx](http://msdn.microsoft.com/en-us/library/ms536391.aspx)
3) [http://msdn. microsoft.com/en-us/library/1h5aa6y9.aspx](http://msdn.microsoft.com/en-us/library/1h5aa6y9.aspx)

您可以使用以下构造函数创建 MetaFile 对象

```
public Metafile(Stream stream) 
```

将 MemoryStream 作为元文件命令的最终目的地。

例如

```
var mf = new MetaFile(new MemoryStream()); 
```

希望这可以帮助。

# iphone - iPhone Xcode project.pbxproj + Subversion = 代码签名问题？

> ID：331287
> 
> 赞同：8
> 
> 时间：2008-12-01T16:10:38.860
> 
> 标签：iphone, xcode, svn, provisioning

尝试将我的第一个 iPhone 应用程序提交到 Subversion，发现我的 xcode project.pbxproj 文件中有“代码签名身份”部分。

```
CODE_SIGN_IDENTITY = "iPhone Developer: my username here...;
"CODE_SIGN_IDENTITY[sdk=iphoneos*]" = "iPhone Developer: above..."; 
```

问题是，在我们的团队中，我们使用绑定到我们设备的不同配置。所以当其他人想在设备上运行代码时，他们必须改变这一行。我们可以在其中共享一个配置，但这种方式有几个缺点。有没有其他方法可以解决它？即包括代码签名部分到另一个不提交给SVN的文件？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-12-13T00:56:01.810

只要您只有一个签名身份，您就可以使用“iPhone Developer”作为您的代码签名身份。Codesign 将搜索包含“iPhone Developer”的身份并使用它。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2008-12-02T06:02:48.870

您可以将项目或目标配置基于`xcconfig`未签入到 Subversion 或以其他方式为每个开发人员定制的文件的内容。将适当的`xcconfig`文件添加到您的项目中，然后从“项目信息”或“目标信息”窗口的“构建”选项卡底部的“基于”弹出窗口中选择文件。

例如，您可以`DeveloperSettings.xcconfig`在项目中有一个文件，其内容在您的系统上是：

```
CODE_SIGN_IDENTITY = "iPhone Developer: favoyang" 
```

而我系统上的内容是：

```
CODE_SIGN_IDENTITY = "iPhone Developer: cmh" 
```

这些设置将被设置为基于此文件的项目或目标配置继承。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-02T05:57:58.317

您可以`$(USER)`在构建设置定义中使用您的短用户名。

例如：

```
CODE_SIGN_IDENTITY = "iPhone Developer: $(USER)"; 
```

这将在构建设置`USER`的定义中使用环境变量的内容。`CODE_SIGN_IDENTITY`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-01T16:54:59.897

显而易见的选择是创建其他构建配置。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-01T16:57:25.460

你为什么直接“改变这条线”？您几乎不应该直接编辑 .xcodeproj 文件包中的任何内容。

相反，您应该在构建设置中更改它。为了更具体地了解您的情况，您需要添加更多构建配置，每个团队成员一个。然后，该成员可以使用他们自己的配置文件进行构建，而不会弄乱任何其他构建设置。

# hadoop - 您如何使用 MapReduce/Hadoop？

> ID：331291
> 
> 赞同：13
> 
> 时间：2008-12-01T16:11:28.657
> 
> 标签：hadoop, mapreduce

我正在寻找一些关于其他人如何使用[Hadoop](http://hadoop.apache.org/core/)或其他类似 MapReduce 的技术的一般信息。一般来说，我很好奇您是在编写 MR 应用程序来处理现有数据集（如 Web 服务器日志文件），还是在编写生成和处理新数据集的应用程序？

**编辑：** 后续问题

(1) 您是否曾经针对其他 MR 程序生成的数据执行 MR 程序？

(2) 您是否需要使用 MR 修改现有数据集？

(3) 您是否曾与其他开发人员共享您的数据集？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-12-02T13:31:46.030

查看[PowerdBy Hadoop](http://wiki.apache.org/hadoop/PoweredBy) wiki，了解从 Facebook 到 FOX News 的所有示例以及他们如何使用它。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-01T16:19:52.680

我正在分析现有的数据集，在我的例子中是程序员活动的痕迹。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-08T09:15:06.573

我使用 hadoop 作为[nutch](http://lucene.apache.org/nutch/)的一部分，并用于构建/分析网络图和文本

(1) 很多任务不能一次性完成，所以需要对 MR 生成的数据运行 MR 是必不可少的。

（2）nutch爬取时，有需要对crawlerdb或其他数据进行过滤或规范化的情况。（所以，是的）

(3) 到目前为止，主要是转储或某种结果。到目前为止，还不是“原生”的 MR 数据。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-07-29T16:50:12.150

> 一般来说，我很好奇您是在编写 MR 应用程序来处理现有数据集（如 Web 服务器日志文件），还是在编写生成和处理新数据集的应用程序？

我对 MR 应用程序所做的工作涉及处理现有数据集，这些数据集可用于生成新数据集，这...

> (1) 您是否曾经针对其他 MR 程序生成的数据执行 MR 程序？

...是的，我愿意。这称为链接 Map/Reduce 操作，您可以在其中按顺序链接多个 map 和 reduce 作业。

> (2) 您是否需要使用 MR 修改现有数据集？

MR 的想法是将现有数据集放入其中，而不必真正修改它来处理和分析其中的信息。我必须这样做的唯一情况是将数据集拆分为包裹。

> (3) 您是否曾与其他开发人员共享您的数据集？

活跃的 MR 应用程序中涉及的许多代码和我的一样被认为是专有的，因此与其他开发人员共享它是一个问题。如果您希望示例数据集与我推荐的书籍一起使用，我推荐的是 Pro Hadoop (Venner)、Hadoop in Action (Lam) 和 Hadoop the Definitive Guide (White)。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-11-20T19:37:26.490

到目前为止，我的两个用途是分析大型行为数据集（从网络、手机等收集）和并行处理大型问题的方法（例如，使用遗传算法在 NP 完全问题空间中找到局部最优值）。

在一般情况下，MR 流程是多阶段的，因此我经常针对早期 MR 阶段生成的数据运行。

# algorithm - 算法的最坏情况时间复杂度

> ID：331295
> 
> 赞同：3
> 
> 时间：2008-12-01T16:13:50.167
> 
> 标签：algorithm, language-agnostic, complexity-theory, big-o

什么是最坏情况时间复杂度 t(n) ：- 我正在阅读这本关于算法的书，并举例说明如何为 .... 获取 T(n)，例如选择排序算法

* * *

就像我正在处理 selectionSort(A[0..n-1])

```
//sorts a given array by selection sort
//input: An array A[0..n - 1] of orderable elements.
//output: Array A[0..n-1] sorted in ascending order 
```

让我写一个伪代码

```
for i <----0 to n-2 do
  min<--i
for j<--i+1 to n-1 do
   ifA[j]<A[min] min <--j
swap A[i] and A[min] 
```

--------我也会用C#写的----------------

```
private int[] a = new int[100];

// number of elements in array
private int x;

// Selection Sort Algorithm
public void sortArray()
{
  int i, j;
  int min, temp;

  for( i = 0; i < x-1; i++ )
  {
    min = i;

    for( j = i+1; j < x; j++ )
    {
      if( a[j] < a[min] )
      {
        min = j;
      }
    }

    temp = a[i];
    a[i] = a[min];
    a[min] = temp;
  }
} 
```

===================

现在如何获得 t(n) 或众所周知的最坏情况时间复杂度

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-12-01T16:22:10.320

那将是O（n ^ 2）。

原因是您有一个 for 循环嵌套在另一个 for 循环中。内部 for 循环的运行时间 O(n) 发生在外部 for 循环的每次迭代中，这也是 O(n)。每一个都是 O(n) 的原因是因为在给定输入的大小的情况下它们花费的时间是线性的。输入越大，线性比例 n 所需的时间就越长。

要计算出数学，在这种情况下是微不足道的，只需将内循环的复杂性乘以外循环的复杂性。n * n = n^2。因为请记住，对于外部循环中的每个 n，您必须再次为内部循环执行 n。澄清：每个 n 次。

O(n * n)。

O(n^2)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-01T17:11:43.170

顺便说一句，您不应该混淆复杂性（用 big-O 表示）和 T 函数。T 函数是算法对于给定输入必须经过的步数。

因此，T(n) 的值是实际的步数，而 O(something) 表示复杂度。通过传统的符号滥用，T(n) = O( f(n) ) 意味着函数 T(n) 至多与另一个函数 f(n) 具有相同的复杂性，这通常是最简单的函数其复杂度等级。

这很有用，因为它使我们能够专注于全局：我们现在可以通过查看它们“从长远来看”的表现如何轻松比较两种可能具有非常不同的 T(n) 函数的算法。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-01T17:02:02.800

@sara [jons](https://stackoverflow.com/questions/331295/worst-case-time-complexity-for-an-algorithm/331380#331380) [您引用的幻灯片集 - 以及其中的算法](http://www.sy-stu.com/stu/PublicFiles/StdLibrary/L_15_Design_and_analysis_of_Algorithms_DA_Algorithms_04.ppt)

正在测量 for 循环中每个原始/原子操作的复杂性

```
for(j=0 ; j<n ; j++)
{
    //...    
} 
```

幻灯片将此循环评为 2n+2，原因如下：

*   初始集合 j=0 (+1 op)*   j < n (n ops) 的比较*   j++ 的增量（n 个操作）*   检查 j < n (+1 op) 的最终条件

其次，for循环内的比较

```
if(STudID == A[j])      
    return true; 
```

这被评为 n ops。因此，如果您将 +1 op、n ops、n ops、+1 op、n ops = 3n+2 复杂度相加，则结果。所以 T(n) = 3n+2

认识到 T(n) 与 O(n) 不同。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-01T18:31:15.723

另一个博士复习在这里。

首先，T 函数只是算法执行一项任务所需的时间量（通常在一些*步骤中，下面会详细介绍）。*什么是“步骤”，在某种程度上是由用途定义的；例如，通常计算排序算法中的比较次数，但计算搜索算法中搜索的元素数量。

当我们谈论算法的最坏情况时间时，我们通常用“大 O 表示法”来表达。因此，例如，您听说冒泡排序需要 O(n²) 时间。当我们使用大 O 表示法时，我们真正想说的是某个函数的增长——在这种情况下是 T——并不比其他一些函数乘以常数的增长快。那是

*T(n) = O(n²)*

意味着对于任何*n*，无论多大，都有一个常数*k*，其中*T(n) ≤ kn²*。这里有一点令人困惑的是，我们以重载方式使用“=”符号：这并不意味着两者在数字意义上*相等*，只是我们说*T(n)**以 kn²*为界.

在您扩展问题的示例中，看起来他们正在计算 for 循环和测试中的比较次数；能够看到上下文和他们正在回答的问题会有所帮助。不过，无论如何，它说明了为什么我们喜欢大 O 表示法：这里的*W(n)*是*O(n)*。（证明：存在一个常数 k，即 5，其中*W(n)* ≤ k(3n)+2。由*O(n)*的定义得出。）

如果您想了解更多相关信息，请查阅任何好的算法文本，例如Cormen*等人的*[Introduction to Algorithms 。](http://mitpress.mit.edu/catalog/item/default.asp?ttype=2&tid=8570)

 ** * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-10-02T08:36:50.240

编写伪代码从哈希表中搜索、插入和删除学生信息。计算最佳和最坏情况的时间复杂度

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-09-12T18:21:31.930

就循环而言，3n + 2 是正确的答案。在循环的每一步，都会完成 3 个原子操作。j++ 实际上是两个操作，而不是一个。和 j

# silverlight - Silverlight 异步超时错误

> ID：331297
> 
> 赞同：13
> 
> 时间：2008-12-01T16:15:34.950
> 
> 标签：silverlight, asynchronous, wcf

在我的 silverlight 应用程序中调用我的 Silverlight Enabled WCF-Service，有时用户会超时。增加服务客户端响应时间的最简单方法是什么？

抛出的确切异常是： System.TimeoutException: [HttpRequestTimedOutWithoutDetail]

谢谢

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-12-01T16:23:50.100

*   可以打开的时间连接量：[BasicHttpBinding.OpenTimeout](http://msdn.microsoft.com/en-us/library/system.servicemodel.channels.binding.opentimeout.aspx)属性
*   连接可以保持非活动状态的时间，在此期间没有接收到应用程序消息，在它被删除之前：[BasicHttpBinding.ReceiveTimout](http://msdn.microsoft.com/en-us/library/system.servicemodel.channels.binding.receivetimeout.aspx)属性

这可以在 silverlight 应用程序的 ServiceReference.ClientConfig 文件的节点中设置。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2010-03-20T04:05:47.127

这里接受的答案对我不起作用。相反，我必须将基本通道转换为 IContextChannel，并在其上设置 OperationTimeout。

为此，我必须创建一个包含部分类的新文件，该文件与 ServiceReference 的名称相匹配。就我而言，我有一个 PrintReportsService。代码如下。

```
using System;
using System.Net;
using System.Windows;
using System.Windows.Controls;
using System.Windows.Documents;
using System.Windows.Ink;
using System.Windows.Input;
using System.Windows.Media;
using System.Windows.Media.Animation;
using System.Windows.Shapes;

namespace RecipeManager.PrintReportsService 
{
    public partial class PrintReportsClient : System.ServiceModel.ClientBase<RecipeManager.PrintReportsService.PrintReports>, RecipeManager.PrintReportsService.PrintReports 
    {
        public void SetOperationTimeout(TimeSpan timeout)
        {
            ((System.ServiceModel.IContextChannel)base.Channel).OperationTimeout = timeout;
        }

    }
} 
```

然后，当我创建客户端时，我执行以下操作：

```
 PrintReportsService.PrintReportsClient client = new RecipeManager.PrintReportsService.PrintReportsClient();
        client.SetOperationTimeout(new TimeSpan(0, 4, 0)); 
```

那是为我做的！更多信息可[在此处](http://final-proj.blogspot.com/2009/09/wcf-timeouts.html)获得，但本文中的代码片段无法编译。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-01T21:16:30.710

这可以设置，但有一个由底层 HTTP 库定义的上限（我认为是五分钟）。请注意，使用更高的值将回退到上限。另外，请注意，您可能还需要在服务器上配置超时。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-04-06T12:39:24.433

我通过在 IE 中启用兼容模式来解决此问题

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-15T10:45:39.120

我认为您应该从 Silverlight 应用程序对服务器实施基于计时器的回调，而不是更改超时，以便会话不会过期。这将消除所有应用程序较长超时的开销。

# css - 表格显示的表格标签很糟糕……但是像 rt 类型这样的调查问题呢？

> ID：331299
> 
> 赞同：3
> 
> 时间：2008-12-01T16:15:38.477
> 
> 标签：css, layout, html-table, survey

[在 html 中显示表单时使用表格标签是不好的设计吗？](https://stackoverflow.com/questions/109488/is-it-bad-design-to-use-table-tags-when-displaying-forms-in-html)

简而言之，这个问题的公认答案是：是的......

...但是这样的事情呢：

![](https://content.screencast.com/users/MarkusHausammann/folders/Jing/media/a3db75c8-49ce-452c-a3ba-9eb6ce8150e9/2012-05-21_1829.png)

我真的想不出不同的更好的解决方案。该示例来自 SurveyMonkey，也使用了表格。

**将表格标签用于此类 likert 类型的问题仍然是糟糕的设计吗？**

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-12-01T16:22:49.930

这种类型的问题更多地导致意见而不是硬性事实，但我会说在这种情况下使用表格绝对可以 - 你想要表格显示信息。

只需使用表格标签，不要让人们为此感到内疚:-)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-01T16:33:46.787

使用表格本身也不错。使用它们来使用无限嵌套的表格和不可见的空间图像来布局整个站点是很糟糕的。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-01T16:21:39.090

在一些帮助下，这并不难。
您可能会查看我们那里的一些基于网格的 css 库。
[Yahoo Grids](http://developer.yahoo.com/yui/grids/)
[Blueprint](http://www.blueprintcss.org/)
[960 网格系统](http://960.gs/)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-01T21:01:58.337

每个人都说“您应该只将表格用于表格数据”。所以……这是什么意思？

以下是我判断某事实际上是表格数据时的标准：当您只能通过参考其*坐标*、其相对于列和行标题的位置来了解某事是/做什么时。

那么，在上面的案例中，第九个单选按钮的作用是什么？

没有办法知道它是什么，除非你看到它所指的那种技能并仰望你声称的那种水平。因此，这是表格数据。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-12-01T23:52:03.250

从可访问性的角度来看，恕我直言，将其布置为表格会更有意义，并带有适当的 th 标签等。正如 Ambrose 所说，单选按钮的坐标赋予它们上下文意义。

你可以在没有表格的情况下进行布局，也许可以使用标签、标题和其他设备来理解它，但你真正实现的唯一事情就是展示你的 css-fu。

# sharepoint - 控制 Windows SharePoint Services 3.0 表单中的下拉列表

> ID：331312
> 
> 赞同：0
> 
> 时间：2008-12-01T16:19:10.780
> 
> 标签：sharepoint

我在 WSS 3.0 站点中创建了一个表单。表单上有许多下拉列表。有没有办法根据上一个下拉列表中的选定值来控制一个下拉列表中的值？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-25T07:20:05.887

看来这种级联查找确实是个大问题。该线程更深入地挖掘了这个问题：

[共享点级联下降](http://www.eggheadcafe.com/community/aspnet/66/10062444/sharepoint-cascading-drop.aspx)

干杯

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-01T16:56:34.837

级联下拉问题是一个大问题。人们使用自定义字段控件和/或站点列构建了一些解决方案。这是一个解决方案的[链接](http://www.sharepointsnippets.com/post/2008/11/SharePoint-Cascading-Dropdown---Unlimited-siblings.aspx)，可让您设置多个级别的父子关系。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-01T16:25:40.237

在回发时，您应该能够访问先前选择的控件值。

如果没有，那么您可能想尝试 Control.FindControl 方法。

[http://msdn.microsoft.com/en-us/library/486wc64h.aspx](http://msdn.microsoft.com/en-us/library/486wc64h.aspx)

# scripting - XP 批处理脚本 - 使用 rinrar 循环通过目录 *.csv 进行压缩

> ID：331322
> 
> 赞同：1
> 
> 时间：2008-12-01T16:21:59.383
> 
> 标签：scripting, windows-xp

我现在已经阅读了很多文章，但不清楚，有很多版本，这个那个和另一个，我一直在拼凑东西，到目前为止，我的问题是“rar”命令似乎不接受我的替代变量，而是将其作为字符串读取。

但这就是我所拥有的

```
@echo off

SETLOCAL

set path=%path%;"C:\TEMP\Output" 
set _sourcedir=C:\TEMP\Output
set _logfile=c:\temp\Output\zip_log.txt
set _rarpath=C:\Program Files (x86)\WinRAR

echo Starting rar batch > %_logfile% 

:: Set default directory
pushd %_sourcedir% 
echo Scan Directory is %_sourcedir%
FOR %%f IN (*.txt) DO (
    echo %%f
    %_rarpath\rar.exe a test
)

popd

ENDLOCAL

@echo on 
```

我已经剪掉了一些并把它切碎了，所以你只得到了精华，不过我没有省略任何命令。

我正在尝试遍历目录并找到所有`.txt`文件并将它们压缩到一个`.rar`文件中。

回声写出正确的文件名。

有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-01T16:25:44.370

我认为这是你的问题：

```
set _rarpath=C:\Program Files (x86)\WinRAR 
```

在批处理文件中，环境变量分隔符是一个空格，所以它认为`_rarpath`是`C:\Program`

Enclose the path in double quotes and see if that helps:

```
set _rarpath="C:\Program Files (x86)\WinRAR" 
```

Also, in your FOR loop change

```
%_rarpath\rar.exe a test 
```

to

```
%_rarpath%\rar.exe a test 
```

(or,perhaps this was a typo?)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-01T16:28:05.113

I don't see where you're asking winrar to do anything with your files? %%f needs to be on the winrar command line somewhere.

Also, you shouldn't need a loop at all for this: rar.exe a test.rar %yourpath%*.csv or similar.

# sql-server - SQL Server 2005 表有多少列太多？

> ID：331323
> 
> 赞同：11
> 
> 时间：2008-12-01T16:22:02.007
> 
> 标签：sql-server, sql-server-2005

我有一个请求允许动态表有 1000 列（由我的最终用户随机选择）。这对我来说似乎是个坏主意。这是一个可自定义的表，因此它将混合`varchar(200)`列`float`（float 最匹配应用程序 c++ 双精度类型）。该数据库主要是遗留应用程序的索引，并用作报告存储库。这不是记录系统。该应用程序有数千个数据点，其中很少能被标准化。

关于这对性能的影响有什么想法吗？还是一个理想的表大小也可以将其分区？

由于我不知道最终用户会选择 20k 价值选择中的哪些字段来规范化表是不可行的。我可以将这些数据分成几个我必须动态管理的表（可以添加或删除字段。然后删除行并重新解析记录系统以填充表。）我的偏好是推回和标准化所有 20k 位数据。但我不认为会发生这种情况。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2008-12-01T16:59:23.770

这对我来说是个糟糕的设计。

需要考虑的事项：

这些列中的大多数是否都包含 NULL 值？

许多人会被命名为 Property001、Property002、Property003 等...吗？

如果是这样，我建议您重新考虑数据规范化。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2008-12-01T16:42:40.810

来自 SQL2005 文档：

SQL Server 2005 每个数据库最多可以有 20 亿个表，每个表可以有 1,024 列。(...) 每行的最大字节数为 8,060。对于具有导致定义的总表宽度超过 8,060 字节的 varchar、nvarchar、varbinary 或 sql_variant 列的表，放宽了此限制。这些列中每一列的长度仍必须在 8,000 字节的限制范围内，但它们的组合宽度可能会超过表中 8,060 字节的限制。

这些列的功能是什么？为什么不更好地将它们分成主表、属性（查找表）和值？

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2008-12-01T17:36:15.710

每当您觉得需要询问系统有什么限制时，您就遇到了设计问题。

如果您问“我可以在 varchar 中容纳多少个字符？” 那么你根本不应该使用varchars。

如果您真的想知道 1000 列是否可以，那么您迫切需要重新组织数据。（正常化）

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2008-12-01T16:45:11.913

MS SQL Server 的每个表限制为 1024 列，因此您将在此边缘运行。使用 varchar(200) 列，您将能够超过每行 8k 字节的限制，因为 SQL 将在数据页上存储 8k，然后将数据溢出到页外。

SQL 2008 为这样的场景添加了稀疏列 - 在这些场景中，您会有很多包含空值的列。

使用稀疏列 [http://msdn.microsoft.com/en-us/library/cc280604.aspx](http://msdn.microsoft.com/en-us/library/cc280604.aspx)

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2008-12-01T16:28:17.813

通常：表越宽，性能越慢。许多薄桌子比一张大桌子更可取。

如果您的桌子那么宽，那几乎可以肯定是设计问题。有多少更可取并没有真正的规则，我从来没有真正遇到过在现实世界中超过 20 列的表格。只是按关系分组。毕竟这是一个 RDBMS。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2008-12-01T17:15:02.927

这将产生巨大的性能和数据问题。它可能需要标准化。

虽然 SQl 服务器将允许您创建一个包含超过 8060 字节的行内的表，但它不会让您存储比其中更多的数据。您可能会意外截断数据（更糟糕的是，直到几个月后才会发生这种情况，到那时修复这个怪物既紧迫又极其困难）。

查询这也将是一个真正的问题。您如何知道要查找数据的 1000 列中的哪一列？每个查询都应该要求 where 子句中的所有 1000 列吗？

这将是用户可定制的想法确实很可怕。为什么用户需要 1000 个字段来自定义？我见过的大多数让用户有机会自定义某些字段的应用程序都设置了一个小的限制（通常小于 10）。如果他们需要定制那么多，那么应用程序在定义客户实际需要什么方面做得不够好。

有时，作为开发人员，您只需要站起来说不，这是个坏主意。这是其中之一。

至于你应该做什么（除了规范化），我认为我们需要更多信息来为你指明正确的方向。

顺便说一句，float 是一种不精确的数据类型，除非您喜欢不正确的结果，否则不应将其用于进行计算的字段。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2013-05-02T13:21:04.873

我必须不同意这里的每个人......我知道这听起来很疯狂，但使用具有数百列的表格是我做过的最好的事情。

是的，很多列经常有空值；是的，我可以将其规范化为几个表并转置；是的，它效率低下

**然而，以无数种不同的方式分析列数据是非常快速和容易的**

浪费和不雅 - 你永远不会建造任何有用的东西！

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-12-01T16:39:33.873

那太多了。任何超过 50 列宽，当出现问题时，您要求在性能、代码维护和故障排除方面遇到问题。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-12-01T16:29:44.813

看起来很可怕。我首先要确保数据是标准化的。这可能是你问题的一部分。这些数据将用于什么类型的目的？是为了报道吗？数据会变吗？

我认为这么宽的桌子在性能和维护方面都是噩梦。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-12-02T03:10:05.240

您是否考虑过将最终（1000 列）表作为交叉表查询的结果来查看？然后，您的原始表将只有几列，但有数千条记录。

你能详细说明你的问题吗？我想没有人真正理解你为什么需要这 1000 列！

# javascript - JavaScript 源代码分析器

> ID：331326
> 
> 赞同：46
> 
> 时间：2008-12-01T16:22:14.937
> 
> 标签：javascript, code-analysis

有谁知道检查 JavaScript 文件的良好、可扩展的源代码分析器？

* * *

## 回答 #1

> 赞同：61
> 
> 时间：2011-06-15T14:08:28.227

为了使这个问题保持最新，有一个名为 JSHint 的 JSLint[分支](http://jshint.com/)。可以在[此处](http://anton.kovalyov.net/2011/02/20/why-i-forked-jslint-to-jshint/)找到创建 JSHint 的原因的解释，但总结一下：

> JSHint 是 JSLint 的一个分支，JSLint 是由 Douglas Crockford 编写和维护的工具。JSLint 为我服务了很长一段时间，但在过去的几个月里，它变得令人不安，对你的代码充满敌意。它正在迅速从帮助开发人员防止错误的工具转变为确保您编写代码的工具，如 Douglas Crockford。

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2008-12-01T16:33:39.517

[JSLint](http://www.jslint.com/)历来是这方面的主要工具，但现在还有几个：

*   [JSHint](http://jshint.com/) - JSLint 的一个分支，据说不太固执己见
*   [Closure Linter](https://developers.google.com/closure/utilities/) - 一个检查[Google Javascript 样式指南的 linter](http://google-styleguide.googlecode.com/svn/trunk/javascriptguide.xml)
*   [ESLint](https://github.com/eslint/eslint) - 一个更灵活的工具，但更新，还不够稳定。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2011-06-17T22:30:41.953

如果你还没有找到它，你应该看看 Google Closure Compiler。编译您的 JavaScript 并发现代码中的错误。[http://code.google.com/closure/compiler/docs/gettingstarted_api.html](http://code.google.com/closure/compiler/docs/gettingstarted_api.html)

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2013-09-08T15:58:09.087

我试用了 ESlint，发现它很好。你也可以在那里添加自定义规则。这里是 github repo：[https ://github.com/nzakas/eslint](https://github.com/nzakas/eslint)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-04-13T07:11:28.523

[JSAnalyse](http://jsanalyse.codeplex.com/) has just been published on codeplex. It is a tool which analyses the dependencies between javascript files. You can even define the allowed dependencies and `JSAnalysis` checks whether the defined rules are fulfilled or not. That allows to keep track about the `javascript` dependencies even in big projects and to have a clean architecture.

`JSAnalyse` can be executed as a command line tool or configured via the `Visual Studio Layer Diagramm`. It is also easy to integrate into the build. With gated check-ins you can keep the dependencies under control.

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2013-03-28T01:33:03.253

There exist a parser called ECMAScript parsing infrastructure for multipurpose analysis (esprima) located at [http://esprima.org/](http://esprima.org/) with several example tools that can be used in some analysis

[ECMAScript parsing infrastructure for multipurpose analysis](http://esprima.org/)

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2013-09-08T16:42:46.007

除了 JSLint、JSHint、ESLint、Plato、Google Closure-Linter 之外，还有另一个名为 Esprima 的工具。这是它的链接：[http ://esprima.org/](http://esprima.org/)

此外，这是工具 Esprima 的 github 链接：[https ://github.com/ariya/esprima](https://github.com/ariya/esprima)

我在试用适用于 Windows 的 Google Closure-Linter 时遇到了安装问题。但是，它确实在网页上提到它对 Windows 的支持是实验性的。所有其他工具都易于使用。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-12-01T16:33:56.787

我发现 JSLint 有助于纠正许多常见错误等；但是，我希望找到一些可以添加自己的规则的东西，以帮助自动化一些我的公司希望在 JavaScript 中实现的编码标准。

[http://www.jslint.com/](http://www.jslint.com/)

我需要更多地研究它的可扩展性模型。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-12-01T18:57:29.040

[维基百科的静态代码分析工具列表中](http://en.wikipedia.org/wiki/List_of_tools_for_static_code_analysis)有一些工具支持 JavaScript，如果提到的任何工具有帮助，您也可以查看[JavaScript 调试。](http://en.wikipedia.org/wiki/JavaScript#Debugging)[YUI](http://developer.yahoo.com/yui/) （Yahoo！开发者网络）也有一些很好的工具，还有很多有用的组件。

我自己一直用JSLint，这是我试过的唯一的JS分析工具。我越来越喜欢 JavaScript，但是好的工具仍然是个问题。:(

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2011-01-25T20:07:27.313

我使用 Aptana 进行 JavaScript 文件分析。它捕获了很多错误（如果条件只有一个 =）。它还描述了类布局。我相信它嵌入了一个 jslint 实现。

# .net - 基于服务器的重用——DLL、GAC 还是 REST？

> ID：331330
> 
> 赞同：3
> 
> 时间：2008-12-01T16:23:42.190
> 
> 标签：.net, architecture, service, reusability

我们有一个功能供同一服务器上的多个不同应用程序（客户端）使用。它最好被建模为服务，有一个后端数据库，并且在任何时候都只会有一个版本的功能和数据库在使用。

到目前为止，我们采用了简单的 DLL 重用，其功能、配置文件和依赖项部署在任何使用它的地方。因为现在必须在多个地方进行任何更改，所以在创建新版本的功能或新客户想要使用它时，这种方法很痛苦。

我们想知道是否有更好的方法来做到这一点，并提出了两种可能的替代方案。

1.  将 DLL（和依赖项）放入 GAC。那么问题是如何配置组件。由于客户端对配置不感兴趣，我们倾向于将配置文件存储在服务器上的硬编码路径中。

2.  将功能发布为内部（基于 REST）服务。使用防火墙的内部客户端可以访问它。

正如我们所看到的，#1 的优点似乎是性能和可能的安全性，而#2 可以被视为设置更简单。

我们在这里遗漏了什么重要的东西吗？以前有没有人遇到过类似的情况并想分享一些见解？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-01T16:36:54.253

这是我已经多次努力解决的问题，除此之外真的没有任何最佳答案。我个人的看法是，出于以下几个原因，您需要远离选项 1：

1.  通过让您的所有客户端共享一个二进制文件，现在每次您对其进行更改时都需要对所有客户端进行测试。现在我知道在您的确切情况下，您可能无论如何都必须这样做，因为我们可以假设您将修改位于组件后面的数据库。
2.  不要硬编码任何东西。您可以将配置路径存储在 machine.config 文件的 AppSettings 部分中。

至于选项 2，一种替代方法是使用 WCF（假设您的环境可以支持它）。使用 WCF，您可以使用二进制序列化的 TCP 传输（并且可能有共享内存传输）。这两者都将有助于缩小性能差距（尽管选项 1 将始终优于基于服务的方法）。

通过使用选项 2，您还可以减少重新测试所有客户端的需要，因为您可以开发自动化测试来验证您的合同没有被破坏。这将允许您发布到一个地方，运行快速的自动化测试，并且知道您不会破坏客户端。

话虽如此，您可以使用选项 1 和一组好的单元测试来完成同样的事情，但根据我的经验，从长远来看，选项 2 会更容易。

如果您需要更多 CPU 能力，选项 2 还可以让您在未来扩展服务。

我个人认为选项 1 更容易设置，因为您不必处理配置防火墙、处理身份验证、设置服务等......它也更容易调试（分发应用程序会引入新类型的故障例如托管您的服务的站点崩溃并且您的客户端开始出现故障）。

最后一个建议是您使用代理/外观模式将您的客户与服务的实际位置隔离开来。这将让您随着时间的推移进行扩展，而无需修改客户端代码。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-01T16:49:32.653

As Josh already said, unfortunately the answer for these kinds of questions is often "it depends".

I'm a big fan of the GAC, but you should only put code there of which you're sure it works (almost) perfectly, and doesn't need to be updated very often. As long as a piece of code is "in development", just publish it together with every application that uses it.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-01T16:38:41.613

我会说使用选项 1 会更简单、更容易，尤其是因为您只需要花费额外的时间来限制 REST 的可用性。（双关语！）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-01T16:48:03.200

Josh 指出 WCF 是一种选择，这肯定是我会采用的方式。

这个问题正是 SOA 应该解决的问题！

# asp.net - 使用 EndRequest 事件关闭带有 IIS 7 的 NHibernate 会话

> ID：331334
> 
> 赞同：2
> 
> 时间：2008-12-01T16:24:25.917
> 
> 标签：asp.net, nhibernate

我在一个新的 ASP.NET 项目上使用 NHibernate，并且遇到了我认为奇怪的行为。我试图通过使用 HttpModule 来捕获 EndRequest 事件并关闭会话来管理我的会话。这工作正常，但是，在 EndRequest 事件触发后，我的一个自定义控件的 OnLoad 事件出现异常，该控件试图从延迟加载的对象中读取属性。我收到一个异常，指出“未能延迟初始化集合，没有会话或会话已关闭”。关闭这些属性的延迟加载确实可以解决问题，并且是一个可以接受的解决方案。但这似乎与我一直认为的事实背道而驰。

我假设 OnLoad 事件和所有服务器端处理将在 EndRequest 被触发时完成。这也是我第一次在项目中使用 IIS 7。这是行为的原因吗？预期的行为是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-11T15:13:51.183

我只是有一个'手掌拍前额'的时刻。尽管我实际上正在部署到 IIS 7 服务器，但我一直在使用 VS 2008 内置 Web 服务器 (Casini) 进行调试。Casini 通过 ASP.NET 管道传递所有请求，而 IIS 没有。这导致对图像文件或 javascript 文件（或任何其他静态资源）的请求在我真正认为应该关闭之前关闭我的 NHibernate 会话。

感谢您提供资源清单，我一定会研究它们。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-01T16:47:18.820

1.  如果您的对象是惰性初始化并且没有打开会话，则解析属性将失败。
2.  请记住，当您与另一个尚未初始化的实体有某种关系时，很可能会出现惰性异常。

[http://forum.springframework.org/showthread.php?t=13474](http://forum.springframework.org/showthread.php?t=13474)

我还建议使用[Rhino Commons](http://ayende.com/wiki/Rhino%20Commons.ashx)中的 HTTP 模块之类的东西来管理您的 NHibernate 会话。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-04T22:18:46.463

您应该使用收缩包装来处理这个问题。

我喜欢将 Autofac 与 ASP.NET/MVC 集成一起使用。`RequestContainer`您只需在需要时询问a `ISession`，因为`ISession`is `IDisposable`，所以在当前请求结束时`RequestContainer`自动知道要处理。`ISession`一切都为您处理好。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-04T22:13:21.093

如果您需要延迟加载，请使用 HttpModule。从它继承你的类，然后你有两个可以覆盖的方法（不记得它们的名字）。每次请求任何页面时都会调用第一个。在那里打开会话并将会话置于视图状态。回发页面时调用另一种方法，在那里关闭您的会话。

# c# - IEnumerable.Except 不起作用，那我该怎么办？

> ID：331345
> 
> 赞同：4
> 
> 时间：2008-12-01T16:29:38.090
> 
> 标签：c#, linq

我有一个 linq to sql 数据库。非常简化，我们有 3 个表，项目和用户。有一个名为 User_Projects 的连接表将它们连接在一起。

我已经有了获取`IEnumberable<Project>`给定用户的工作方法。

```
from up in User_Projects
select up.Project; 
```

现在我想获取用户*不*参与的项目。我认为 IEnumerable 的 except 方法在这里会很好：

```
return db.Projects.Except(GetProjects()); 
```

编译，但是我得到一个运行时错误：“本地序列不能在查询运算符的 LINQ to SQL 实现中使用，但 Contains() 运算符除外。”

有没有办法解决这个问题？

* * *

## 更新：

一些观点，但没有答案：p

我试过这个：

```
 IEnumerable<Project> allProjects = db.Projects;
        IEnumerable<Project> userProjects = GetProjects();
        return allProjects.Except(GetProjects()); 
```

我知道它与原始语句基本相同 - 但现在我没有收到运行时错误。不幸的是，由于某种原因，它并没有真正做除了部分，只是返回所有项目

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-12-01T17:02:21.317

Linq to Sql 不了解如何处理任意内存中的对象序列。您需要用关系术语来表达这一点，这适用于 ID：

```
var userProjectIds =
    from project in GetProjects()
    select project.ProjectId;

var nonUserProjects =
    from project in db.Projects
    where !userProjectIds.Contains(project.ProjectId)
    select project; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-01T17:06:02.493

你可以尝试一些简单的事情，比如

```
User u = SomeUser;

from up in User_Projects
where up.User != u
select up.Project; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-01T17:00:02.833

试试这个：

```
var userProjects = GetProjects();
return db.Projects.Except(userProjects.ToArray()); 
```

ToArray 应该强制评估序列（如果我正确理解问题）并允许操作成功。

# c++ - 需要客户端交互式 2D 世界地图：最佳地图包？或者最好的 C++ 图形/画布库来制作一个？

> ID：331355
> 
> 赞同：3
> 
> 时间：2008-12-01T16:34:02.887
> 
> 标签：c++, graphics, google-maps, canvas, sdl

我需要一张世界的 2d 政治地图，我将在其上绘制图标、文本和四处移动的线条。用户将与地图交互，放置和移动图标，他们将放大和缩小地图。

谷歌地图界面离我需要的不是很远，但这与网络无关；它是一个 Windows MFC 应用程序，我想与 C++ API 对话，以获取应用程序中的地图，而不是 Web 界面。理想情况下，我也不想要单独的服务器，并且任何服务器都必须在本地运行（而不是在 Internet 上）。我应该使用什么罐装地图包或图形库来执行此操作？我没有图形编程经验。

这是严格的 2D，所以我不认为像 Google Earth 或 WorldWind 这样的东西是合适的。良好的矢量图形支持会很酷，并且易于绘制位图很重要。

所有的罐头选项似乎都是面向网络的。SDL 是我所知道的关于灵活画布编程的所有知识，但对于可能是常见问题的问题，制作我自己的地图似乎需要做很多工作。有没有更高层次的？也许有一种方法可以与 adobe Flash 对象交互？我相当无知。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-02T04:00:23.483

也许： http: [//www.codeplex.com/SharpMap](http://www.codeplex.com/SharpMap)

ESRI MapObjects [http://www.esri.com/software/mapobjects/index.html](http://www.esri.com/software/mapobjects/index.html) ESRI MapObjects LT [http://www.esri.com/software/mapobjectslt/index.html](http://www.esri.com/software/mapobjectslt/index.html)

有关两个 MapObjects 功能集的比较，请参见 [http://www.esri.com/software/mapobjectslt/about/mo_vs_lt.html](http://www.esri.com/software/mapobjectslt/about/mo_vs_lt.html) 。

ESRI 可能会替代 MapObjects 库

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-01T19:01:50.170

您可以使用术语 GIS（地理信息系统）来扩展搜索。我相信它会更容易。关于这个主题有很多东西。

这是我找到的一个页面：[http ://www.ucancode.net/Gis-Source-Code.htm](http://www.ucancode.net/Gis-Source-Code.htm)

或： http: [//opensourcegis.org/](http://opensourcegis.org/)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-06T13:44:47.337

您可能想尝试[Mapnik C++/Python GIS Toolkit](http://www.mapnik.org/)。

您可以查看[Marble Widget](http://edu.kde.org/marble/#developers)，它是 KDE 的 Marble 项目的一部分。也有用于此的 Windows 二进制文件，但它们可能依赖于 Qt。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-07T13:16:45.710

是的，Marble 还有一个优势，它在单个控件中提供了一种现成的解决方案（在 Qt 的技术术语中称为“小部件”）。

对 Qt 的依赖（顺便说一句，这是唯一的依赖）也可能被视为一个优势：Qt 即将推出的版本是在 LGPL 下获得许可的，所以即使你打算在专有应用程序中使用它，也不应该有任何真正的担心。当然，Qt 和 Marble 是跨平台的，并且提供了一个非常直观且易于理解的 API。与常见的 GIS 解决方案不同，Marble API 和小部件的使用更侧重于对 GIS 不太了解的人。因此，即使您对 GIS 中使用的技术术语感到害怕，它的用法也很容易理解。

Marble 提供了几个编程接口：

您可以创建自己的 Marble 插件并在其中绘制，也可以子类化 MarbleWidget 控件。对于一个简单的 HelloWorld 应用程序，请参见：

[http://techbase.kde.org/Projects/Marble/MarbleCPlusPlus](http://techbase.kde.org/Projects/Marble/MarbleCPlusPlus)

# c# - .NET 中的强类型控件

> ID：331357
> 
> 赞同：8
> 
> 时间：2008-12-01T16:34:12.793
> 
> 标签：c#, .net, winforms, generics

我已经在 Windows 窗体应用程序上工作了很长一段时间，我真的发现自己在 GUI 代码中做的类型转换比我在底层业务代码中做的更多。

如果您看到 ComboBox 控件接受一些模糊的“对象”作为它的项目，我的意思就会变得明显。然后你走开，可能会显示一些 DisplayMember 和 ValueMember 等等。

如果我想稍后检索该值，我需要将我的对象类型转换回原来的样子。就像字符串获取值一样

```
string value = (string)combobox1.SelectedItem; 
```

由于框架中存在泛型已经有一段时间了，我仍然想知道为什么在地狱中没有一个标准工具箱中的控件是通用的。

我还发现自己一直在使用 ListViewItems 上的 .Tag 属性来保留显示的域对象。但是每次我需要访问该对象时，我都需要另一个类型转换。

为什么我不能只创建一个包含 ListViewItem 类型项目的 ComboBox 或 ListView

我是否在这里遗漏了什么，或者这只是通过控件没有经过深思熟虑的另一个例子？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-01T16:48:40.080

虽然对“没有使用泛型”的批评不能公平地应用于在它们存在之前开发的控件......但人们一定想知道 WPF 控件（.NET 3.0 中的新控件，在 .NET 2.0 中的泛型之后）。

我检查了[ComboBox中的](http://msdn.microsoft.com/en-us/library/system.windows.controls.combobox_members.aspx)[AddChild](http://msdn.microsoft.com/en-us/library/system.windows.controls.itemscontrol.addchild.aspx)方法。它需要一个对象参数（呃）。

此控件旨在主要通过 XAML 使用。这样做是因为无法在 XAML 中指定类型参数吗？（另外，有没有办法在 XAML 中指定类型参数？）

很抱歉没有明确的“为什么”答案，只是分享在使用 UI 时需要投射的常见痛苦。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-01T16:39:44.700

我不认为你缺少任何东西。只是这些类是在泛型之前创建的，而 WinForms 根本不足以让 MS 花费大量时间更改或扩展 API。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-01T16:42:32.400

我经常为控件创建包装类。这允许我使用泛型。这通常与反射结合使用，反射在编译时不是类型安全的，但可以在运行时使用。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-01T16:53:44.203

我认为，这个问题的一个常见来源是没有将您的视图/表示逻辑与您的内存数据模型逻辑分开。不幸的是，这是 WinForms 和 Visual Studio GUI 设计器同谋的架构错误。

WinForms 和 VS 设计器不鼓励程序员将其数据对象的管理与表单类本身分开。如果 ComboBox ListViewItem 对象不通过泛型或对象集合不提供对任意对象的任何支持，那可能会更好。

除非您将使用和生命周期有限的东西拼凑在一起，否则您应该尽量避免将对单个数据对象的引用存储在您的控件或表单中。它们应该单独管理，如果需要引用它们，应该通过为您正在使用的特定类型的视图类设计的模型管理类来完成。

但是，解决该问题的简单方法可能是使用 Form 类上的 Dictionary 字段成员将放置到 ComboBox 或 ListView 中的文本表示“映射”到原始对象。这不是一个理想的解决方案，但在数据和 UI 控件之间提供了至少半步的间接性，这可以使您的代码更易于维护。

**编辑：**诚然，这与公开 Object 实例的 ListViewItemCollection 类是分开的......官方的辩护很可能是他们想要支持标准的 IEnumerable 和 ICollection 接口。但是他们没有理由不提供这些方法的特定类型覆盖，因为它被明确设计为存储 ListViewItem 实例。所以我对这个特定问题没有答案。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-12-01T17:11:25.667

好吧，如果您将控件数据绑定到 DataBindingSource，则可以通过这种方式获取数据，但 AFAIK 仍然不是强类型。如果您要显示单个业务对象的多个参数/方面，您可以绑定到它，然后访问（强类型）成员 - 当然，这一切都可以追溯到 Turbulent Intellect 的答案，这是模型和模型之间更好的分离看法。不过，我同意基于泛型的类型会有所帮助。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-12-01T17:24:03.660

这是可能的（如果您愿意，您可以制作自己的通用控件），但如果您这样做，Visual Studio 附带的表单设计器会发疯。没有它，你将不得不做一些事情。

你不是第一个想到这一点的人，微软已经为此受到了公众的相当多的批评。让我们希望他们在未来增加对此的支持。

# sql - SQL 语句帮助 - 为每个客户选择最新订单

> ID：331367
> 
> 赞同：12
> 
> 时间：2008-12-01T16:38:30.177
> 
> 标签：sql, sql-server-2005

假设我有 2 个表：客户和订单。一个客户可以有多个订单。

现在，我需要向任何客户展示他的最新订单。这意味着如果客户有多个订单，则仅显示最晚进入时间的订单。

这是我自己管理的程度：

```
SELECT a.*, b.Id
FROM Customer a INNER JOIN Order b ON b.CustomerID = a.Id
ORDER BY b.EntryTime DESC 
```

这当然会返回具有一个或多个订单的所有客户，首先显示每个客户的最新订单，这不是我想要的。在这一点上，我的思想陷入了困境，所以我希望有人能指出我正确的方向。

出于某种原因，我*认为*我需要在某处使用 MAX 语法，但它现在只是逃避了我。

**更新：**在这里查看了几个答案（有很多！）后，我意识到我犯了一个错误：我的意思是**任何**拥有最新记录的客户。这意味着如果他没有订单，那么我不需要列出他。

**UPDATE2：**修正了我自己的 SQL 语句，这可能会引起其他人的困惑。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-12-01T17:13:44.287

我认为您不想使用 MAX() 因为您不想对 OrderID 进行分组。您需要的是带有 SELECT TOP 1 的有序子查询。

```
select * 
from Customers 
    inner join Orders 
        on Customers.CustomerID = Orders.CustomerID
        and OrderID = (
            SELECT TOP 1 subOrders.OrderID 
            FROM Orders subOrders 
            WHERE subOrders.CustomerID = Orders.CustomerID 
            ORDER BY subOrders.OrderDate DESC
        ) 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-12-01T18:07:00.560

虽然我看到您已经接受了答案，但我认为这个答案更直观：

```
select      a.*
           ,b.Id

from       customer a

inner join Order b
on         b.CustomerID = a.Id

where      b.EntryTime = ( select max(EntryTime)
                           from   Order
                           where  a.Id = b.CustomerId
                         ); 
```

`a.Id = b.CustomerId`因为您想要客户 ( )`EntryTime`的所有订单 (in ) 的最大值。`b``a.Id`

我必须通过执行计划运行这样的东西才能看到执行的差异，但是 TOP 函数是事后完成的，并且使用`order by`可能很昂贵，我相信使用`max(EntryTime)`将是运行它的最佳方式.

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-12-01T16:47:18.913

这样的事情应该这样做：

```
SELECT X.*, Y.LatestOrderId
FROM Customer X
LEFT JOIN (
  SELECT A.Customer, MAX(A.OrderID) LatestOrderId
  FROM Order A
  JOIN (
    SELECT Customer, MAX(EntryTime) MaxEntryTime FROM Order GROUP BY Customer
  ) B ON A.Customer = B.Customer AND A.EntryTime = B.MaxEntryTime
  GROUP BY Customer
) Y ON X.Customer = Y.Customer 
```

这假设同一客户的两个订单可能具有相同的 EntryTime，这就是为什么`MAX(OrderID)`在子查询中使用`Y`它来确保每个客户只发生一次。使用`LEFT JOIN`是因为您声明要显示所有客户 - 如果他们没有任何订单，那么 LatestOrderId 将为`NULL`。

希望这可以帮助！

--

更新 :-) 这仅显示有订单的客户：

```
SELECT A.Customer, MAX(A.OrderID) LatestOrderId
FROM Order A
JOIN (
  SELECT Customer, MAX(EntryTime) MaxEntryTime FROM Order GROUP BY Customer
) B ON A.Customer = B.Customer AND A.EntryTime = B.MaxEntryTime
GROUP BY Customer 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-12-01T18:11:16.310

您可以使用窗口函数。

```
SELECT *
  FROM (SELECT a.*, b.*,
               ROW_NUMBER () OVER (PARTITION BY a.ID ORDER BY b.orderdate DESC,
                b.ID DESC) rn
          FROM customer a, ORDER b
         WHERE a.ID = b.custid)
 WHERE rn = 1 
```

对于每个客户 (a.id)，它对所有订单进行排序并丢弃除最新订单之外的所有订单。ORDER BY 子句包括订单日期和条目 ID，以防同一日期有多个订单。

通常，窗口函数比在大量记录上使用 MAX() 的任何查找要快得多。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2018-03-05T14:30:15.213

此查询比接受的答案快得多：

```
SELECT c.id as customer_id, 
    (SELECT co.id FROM customer_order co WHERE 
    co.customer_id=c.id 
    ORDER BY some_date_column DESC limit 1) as last_order_id
    FROM customer c 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-12-01T16:46:00.460

```
SELECT Cust.*, Ord.*
FROM Customers cust INNER JOIN Orders ord ON cust.ID = ord.CustID
WHERE ord.OrderID = 
    (SELECT MAX(OrderID) FROM Orders WHERE Orders.CustID = cust.ID) 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-12-01T16:51:03.663

就像是：

```
SELECT
  a.*
FROM
  Customer a
    INNER JOIN Order b
      ON a.OrderID = b.Id
        INNER JOIN (SELECT Id, max(EntryTime) as EntryTime FROM Order b GROUP BY Id) met
          ON
            b.EntryTime = met.EntryTime and b.Id = met.Id 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-12-01T18:13:13.637

我还没有在上面看到的一种方法：

```
SELECT
     C.*,
     O1.ID
FROM
     dbo.Customers C
INNER JOIN dbo.Orders O1 ON
     O1.CustomerID = C.ID
LEFT OUTER JOIN dbo.Orders O2 ON
     O2.CustomerID = C.ID AND
     O2.EntryTime > O1.EntryTime
WHERE
     O2.ID IS NULL 
```

这（以及我相信的其他解决方案）假设同一客户的两个订单不能具有完全相同的进入时间。如果这是一个问题，那么您将不得不选择决定哪个是“最新”的。如果这是一个问题，请发表评论，如果需要，我可以扩展查询以解决这个问题。

查询的一般方法是查找一个客户的订单，其中没有同一客户的另一个订单在较晚的日期。根据定义，它是最新的订单。这种方法通常比使用派生表或子查询提供更好的性能。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2021-12-20T22:55:55.747

A simple max and "group by" is sufficient.

```
select c.customer_id, max(o.order_date)
from customers c
inner join orders o on o.customer_id = c.customer_id
group by c.customer_id; 
```

No subselect needed, which slows things down.

# php - 使用 IteratorAggregate 迭代成员数组

> ID：331376
> 
> 赞同：2
> 
> 时间：2008-12-01T16:40:04.980
> 
> 标签：php, spl

我有一个类，我希望能够迭代某个数组成员。我快速搜索了一下，发现`IteratorAggregate`：

```
class foo implements IteratorAggregate
{
    protected $_array = array('foo'=>'bar', 'baz'=>'quux');

    public function getIterator()
    {
        return new ArrayIterator($this->_array);
    }
} 
```

效果很好，但是不是`ArrayIterator`每次`foreach`都使用它创建一个新实例吗？

所以我想我应该将迭代器实例存储在一个成员中：

```
 protected $_iterator;

    public function getIterator()
    {
        if (!$this->_iterator instanceof ArrayIterator) {
            $this->_iterator = new ArrayIterator($this->_array);
        }
        return $this->_iterator;
    } 
```

问题是迭代器`$this->_array`在第一次调用 时使用 的副本`getIterator()`，因此对成员的更改不会反映在后续`foreach`构造中。

我在想我应该子类化`ArrayIterator`，添加一个`setArray($array)`方法并在返回之前调用它`getIterator()`，但我不知道它在内部使用的数组的成员名称以及它是否可以被子类覆盖。

问题是：这是过早和/或不必要的优化吗？如果没有，实现这一目标的最佳方法是什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-01T17:02:22.453

您的第二个代码将在对象的多个循环上失败，您在另一个循环完成之前开始一个新循环。

看起来并不像一个值得花时间在上面的优化。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-12-01T17:13:31.340

> 但这不是每次使用 foreach 时都会创建一个新的 ArrayIterator 实例吗？

是的，还有？

# python - 如何打包我正在使用的 python 库，以便我可以将它们与我的应用程序一起分发并尽可能少地依赖

> ID：331377
> 
> 赞同：4
> 
> 时间：2008-12-01T16:40:10.970
> 
> 标签：python, linux, deployment

如何打包我正在使用的 python 库，以便我可以将它们与我的应用程序一起分发，并且具有尽可能少的依赖项，并且不与我系统上已经存在的不同库/版本冲突。

LE：对不起，我忘了说明。我将在 linux 上执行此操作。而且我并不是指让我的应用程序成为像 deb/rpm 等可安装文件，而是如何组织我的文件，例如我将使用cherrypy 和 sqlalchemy 我将把它们与我的应用程序一起发布，而不是让用户通过自己安装所有依赖项的痛苦。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-01T17:09:38.557

您可以尝试`freeze.py`，有关更多详细信息，请参阅[http://wiki.python.org/moin/Freeze](http://wiki.python.org/moin/Freeze)。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-01T16:49:49.907

尝试[py2exe](http://www.py2exe.org/)。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-01T18:17:26.203

但是，如果您使用列出的正确依赖项创建 deb，安装程序将为用户下载它们。这是最好的方法，因为它不是多余的。

也许你可以用你的 deb 和所有第三方 deb 和一个安装脚本来制作一个 tar 或 zip，它只是以正确的顺序安装所有 deb。这样，如果用户已经有一些软件包，它将不会再次安装。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-12-01T19:08:29.627

您可以让您的用户从启动脚本运行系统，并且该脚本可以提前修复 pythonpath 以将您的版本放在首位。例如，如果您将 CherryPy、SQLAlchemy 等放在“外部”子目录中，您可以尝试：

```
# startproj.sh
script_path=`dirname $0`
export PYTHONPATH=${script_path}/external;${PYTHONPATH}
exec ${script_path}/projstartup.py 
```

# actionscript - actionscript tdd 框架

> ID：331385
> 
> 赞同：2
> 
> 时间：2008-12-01T16:43:08.953
> 
> 标签：actionscript, tdd

那里有 ActionScript 2.0/3.0 的测试框架列表吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-05T13:27:43.957

**更新 2010-05-18**

由于这篇文章有点旧而且我刚刚收到了一个赞成票，因此可能值得提供一些更新的信息，这样人们就不会追逐旧框架。

最初的 Fluint 团队现在制作了官方（和开源）**单元测试**框架[FlexUnit](http://www.flexunit.org)。您可能还想查看[asunit](http://asunit.org/)，特别是如果您需要 AS2 支持。

[flexcover](http://code.google.com/p/flexcover/)是首选**代码覆盖**框架，需要您使用备用编译器。

**您对模拟/隔离框架**有更多选择，因为现在大多数都使用动态代理生成：

*   [asmock](http://asmock.sourceforge.net)支持强类型的记录-重播-验证模拟模型和（我希望）一个非常全面的 wiki 入门。（虽然我在这里有点偏见:)
*   [mockito](http://bitbucket.org/loomis/mockito-flex/wiki/Home)支持强类型的排列行为断言语法
*   [mockolate与](http://github.com/drewbourne/mockolate)[mock-as3](http://code.google.com/p/mock-as3/)出自同一作者（现已停产），并提供了另一种模拟模型（尽管需要您将方法名称指定为字符串）
*   [mock4as](http://code.google.com/p/mock4as/)是一个静态模拟框架

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-01T17:23:31.693

试试[AsUnit](http://www.asunit.org/)。它目前支持 ActionScript 2.0 和 3.0 开发。而且，它是开源的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-01T17:07:39.183

FlexUnit 是“官方”的单元测试框架。我相信它归 Adob​​e 的研究人员所有。

[http://labs.adobe.com/wiki/index.php/ActionScript_3:resources:apis:libraries](http://labs.adobe.com/wiki/index.php/ActionScript_3:resources:apis:libraries)

这是一个关于如何使用它的教程：

[http://langexplr.blogspot.com/2008/10/creating-flex-unit-tests-with-flexunit.html](http://langexplr.blogspot.com/2008/10/creating-flex-unit-tests-with-flexunit.html)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-12T15:40:38.220

还要检查[流利](http://code.google.com/p/fluint/)

> Fluint 松散地基于 FlexUnit 及其祖先 JUnit 的概念，提供增强的异步支持、图形测试运行器、与持续构建系统的集成以及用于目录监视的可选 Adob​​e AIR 客户端。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-04T03:41:08.757

从 libspark尝试[AS3Unit 。](http://www.libspark.org/wiki/yossy/AS3Unit/en/index)他们还有一个异步 beta 测试套件。

# svn - svn：用分支替换主干

> ID：331388
> 
> 赞同：157
> 
> 时间：2008-12-01T16:43:55.317
> 
> 标签：svn, version-control

**使 subversion 存储库的分支之一成为新主干的最佳方法是什么？**

整个系统已经进行了一次重大的重写：事情已经被移动、重写、替换、删除、重命名等。重写的代码已经过测试，可以替换旧的主干。

基本上，旧的主线（Trunk 5）被标记并将在此结束。重写后的分支（Branch 6）将成为新的主线（Trunk 7）：

```
主干(1) --> 主干(2) --> 主干(5) --> × +--> 新主干(7)
  \ \ |
  分叉合并？？？
    \ \ |
     +--> 分支(3) --> 分支(4) --> 分支(6) --+

```

旧“主干”的所有正在进行的更改都已合并到“重写分支”中

**我怎样才能做到这一点？**

* * *

## 回答 #1

> 赞同：120
> 
> 时间：2008-12-01T16:47:10.207

使用[svn move](http://svnbook.red-bean.com/en/1.1/re18.html)将旧主干的内容移动到其他地方，然后将分支重命名为主干。

请注意，svn 中的复制和移动类似于文件操作。您可以使用它们在您的存储库中移动/复制内容，并且这些更改也是版本化的。将“移动”视为“复制+删除”。

[编辑] Nilbus 刚刚通知我，当您使用`svn move`.

我仍然认为这是正确的做法。它会导致冲突，但如果你仔细合并，你可能不会丢失任何数据。如果这让您感到困扰，请使用更好的 VCS，例如[Mercurial](https://www.mercurial-scm.org/)或[Git](http://git-scm.com/)。

* * *

## 回答 #2

> 赞同：67
> 
> 时间：2008-12-04T00:44:38.963

我同意使用 svn move 命令来实现这个目标。

我知道这里的其他人认为这很不寻常，但我喜欢这样做。当我有一个功能分支并准备将它与一个也进行了重大修改的主干合并时，我会将它合并到一个新分支，通常命名为`<FeatureBranchName>-Merged`. 然后我解决冲突并测试合并​​的代码。完成后，我将主干移动到标签文件夹，这样我就不会丢失任何东西。最后我把我的移动`<FeatureBranchName>-Merged`到后备箱。

此外，我更喜欢在移动时避免使用工作副本，以下是命令示例：

```
svn move https://SVNUrl/svn/Repo/trunk https://SVNUrl/svn/Repo/tags/AnyName

svn move https://SVNUrl/svn/Repo/branches/BranchName-Merged https://SVNUrl/svn/Repo/trunk 
```

注意：我使用 1.5

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2011-07-21T22:41:37.910

我最近只是在看这个问题，我非常满意的解决方案是执行

svn merge --ignore-ancestry 树干-url 分支-url

在我的行李箱的工作副本上。

这不会尝试以历史方式应用更改（保持主干中的更改）。它只是在主干和分支之间“应用差异”。这不会为您的用户在未修改的文件中产生任何冲突。但是，您将丢失分支中的历史信息，但无论如何执行合并时都会发生这种情况。

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2008-12-01T17:19:58.660

建议您通过存储库浏览器工具进行这些更改。

通过工作副本尝试大型删除+移动操作是杀死工作副本的好方法。如果您被迫使用工作副本，请在每次删除或移动操作后执行增量提交，并在每次提交后更新您的工作副本。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2011-08-04T13:06:55.150

如果您想让分支成为新的主干（即）摆脱自创建分支以来在主干中所做的所有更改，您可以 1\. 创建主干的分支（用于备份目的） 2.“恢复更改" 在主干上（选择创建分支后的所有修订 3\. 将分支合并回主干。

历史应该保持这种状态。

问候，罗杰

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-12-01T17:32:12.097

@Aaron Digulla 和 @kementeus 解决方案是可行的。对于 Subversion 1.4 存储库，复制/移动操作会使将来迁移到不同的存储库结构或拆分存储库变得困难。

我相信 1.5 的改进包括更好地解决移动/复制历史记录，因此对于 1.5 存储库来说这可能不是问题。

对于 1.4 存储库，我建议使用`svnadmin dump`and`svndumpfilter`将现有主干移动到其他地方，然后使用相同的机制将分支移动到主干。将两个转储文件加载到测试存储库中，进行验证，然后将其移至生产环境。

当然，在开始之前备份您现有的存储库。

这可以在不明确记录移动/复制的情况下保留历史，并使未来的重组、保留历史更加容易。

* * *

编辑：根据要求，1.4 行为的文档，来自 1.4 Red-Bean 书，[Filtering Repository History](http://svnbook.red-bean.com/en/1.4/svn-book.html#svn.reposadmin.maint.filtering)

> 此外，复制的路径会给您带来一些麻烦。Subversion 支持存储库中的复制操作，其中通过复制一些已经存在的路径来创建新路径。在存储库生命周期的某个时刻，您可能已将文件或目录从某个`svndumpfilter`排除的位置复制到它包含的位置。为了使转储数据自给自足，`svndumpfilter`仍需要显示添加的新路径（包括由副本创建的任何文件的内容），并且不将该添加表示为来自过滤后的转储数据流中不存在的源的副本。但是由于 Subversion 存储库转储格式仅显示每个修订版中的更改内容，因此复制源的内容可能不容易获得。如果您怀疑您的存储库中有任何此类副本，您可能需要重新考虑您的包含/排除路径集，可能还包括作为麻烦复制操作的来源的路径。

这适用于使用`svndumpfilter`. 有时，现在做一些额外的工作可以在以后节省大量额外的工作，并且通过保持`svndumpfilter`对未来迁移/重组的易用性，可以以相对较低的成本降低风险。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-12-18T02:01:55.323

虽然上面的答案会起作用，但它们并不是最佳实践。最新的 svn 服务器和客户端跟踪为您合并。所以 svn 知道你将哪些修订合并到一个分支中以及从哪里合并。这在保持分支最新然后将其合并回主干时有很大帮助。

但是，无论您使用哪个版本的 Subversion，都有一个最佳实践方法可以将分支中的更改返回到主干。它在 Subversion 手册中进行了概述：[使用 Subversion 进行版本控制，第 4 章。分支和合并，保持分支同步](http://svnbook.red-bean.com/nightly/en/svn.branchmerge.basicmerging.html#svn.branchemerge.basicmerging.stayinsync)。

* * *

## 回答 #8

> 赞同：-3
> 
> 时间：2008-12-01T16:49:48.720

这在 SVN 中是一个非常奇怪/不寻常的配置，即使我认为这根本不是一个“好习惯”，无论如何，我想你可以这样做：

*   签出所有源树（svn co therootsourcetree）
*   移除主干（svn rm trunk）
*   将分支复制到主干（svn cp 分支/thebranch /trunk）
*   删除分支（svn rm 分支/thebranch）
*   提交更改

祝你好运

# ruby-on-rails - 我可以在 Rails 中设置级联删除吗？

> ID：331394
> 
> 赞同：97
> 
> 时间：2008-12-01T16:46:47.807
> 
> 标签：ruby-on-rails, ruby, database

我知道这可能在互联网上的某个地方，但我在 Stackoverflow 上找不到答案，所以我想我可能会在这里增加一点知识库。

我是 Ruby 和 Rails 的新手，但我的公司在这方面投入了很多，所以我试图更详细地了解它。

我很难改变我的思维方式，从“模型”而不是从数据库设计应用程序，所以我试图弄清楚如何完成我在数据库中经典完成的所有设计工作Rails 模型。

所以我给自己的最新任务是弄清楚如何配置 Rails 数据库模型来执行级联删除？有没有一种简单的方法可以做到这一点？还是我必须进入 MySql 并进行设置？

* * *

## 回答 #1

> 赞同：113
> 
> 时间：2008-12-01T17:48:41.160

您还可以将 :dependent 选项设置为 :delete_all。:delete_all 将发出一条 SQL 语句来删除所有子记录。因此，使用 :delete_all 可能会给您带来更好的性能。

```
has_many :memberships, dependent: :delete_all 
```

* * *

## 回答 #2

> 赞同：69
> 
> 时间：2008-12-01T16:49:47.160

是的，你可以，如果你使用像 has_many 这样的关系，你就这样做

```
has_many :memberships, dependent: :destroy 
```

* * *

## 回答 #3

> 赞同：31
> 
> 时间：2016-07-29T09:19:19.330

与提供的答案相反，我强烈建议在数据库级别也这样做。如果您有不同的进程或多线程环境，则可能会发生记录未正确删除的情况。此外，在删除大量数据时，数据库外键使事情变得更快。

就像在建议的答案中一样：

```
has_many :memberships, dependent: :delete_all 
```

但是，还要确保`foreign_key`在迁移中设置 a。这样，数据库会自动为您删除记录。

假设您有一个用户模型，则在删除成员资格时使值无效：

```
add_foreign_key :users, :memberships, on_delete: :nullify 
```

您还可以在删除成员资格时删除所有模型

```
add_foreign_key :users, :memberships, on_delete: :cascade 
```

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2008-12-02T09:08:13.097

请记住，delete_all 不会对子记录执行任何回调（如 before_destroy 和 after_destroy）。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2008-12-01T16:56:35.197

如果您希望级联删除反映在实际的数据库结构中，看起来这个插件可能会为您提供所需的内容：

[http://www.redhillonrails.org/foreign_key_migrations.html](http://www.redhillonrails.org/foreign_key_migrations.html)

在迁移中使用它的格式是这样的：

```
create_table :orders do |t|
  t.column :customer_id, :integer, :on_delete => :set_null, :on_update => :cascade
  ...
end 
```

# asp.net - 如何仅针对特定页面类型使 http 模块发生火灾事件

> ID：331398
> 
> 赞同：4
> 
> 时间：2008-12-01T16:47:40.050
> 
> 标签：asp.net, sharepoint, sharepoint-2007, httpmodule

我在共享点站点上有一个 http 模块，该模块实例化一个自定义类并将其添加到会话中，并为我的站点执行其他初始操作。但是，我注意到所有请求类型（.aspx、.js、.png、.jpg）都调用了 http 模块。

有没有办法只为.net 特定页面类型调用 http 模块？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-12-01T17:18:40.847

在 IIS 中，您将设置处理程序以与您的特定扩展关联，因此处理程序将仅应用于该扩展。不应处理 JavaScript 文件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-01T17:20:24.447

如果您正在考虑以任何方式将您的模块/处理程序与 SharePoint 集成，我也会看看[这篇文章。](http://msdn.microsoft.com/en-us/library/bb457204.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-01T17:22:59.980

虽然我确实喜欢这种类型的 http 处理程序的易于部署（以及您不必为处理程序部署 web.config 条目的事实），但在您可能不想使用 _layouts 目录或您想要的情况下要拥有自定义文件扩展名，这是另一种也可以使用的替代方法（尽管它确实需要在 IIS 中进行一个手动配置步骤，因此它可能不适合“无接触部署”）

1) 像通常为 asp.net 应用程序一样创建您的 http 处理程序。由于您位于应用程序池中，因此您可以添加对 SharePoint DLL 的引用并与对象模型进行交互。

2) 添加并进入您的 web.config 以注册您的处理程序并定义您要使用的扩展。IE：

3) 通过 IIS > Web 站点属性 > 主目录 > 配置 > 映射在 IIS 中定义您的自定义扩展

在这种情况下，我们定义了处理程序将拾取的 .proxy 扩展名。我们的处理程序是一个 .NET 程序集，因此我们需要添加映射以将 .proxy 请求路由到 .net isapi dll (C:\WINDOWS\Microsoft.NET\Framework\v2.0.50727\aspnet_isapi.dll).. 另外，制作确定你取消选中“

**来自对[http://msdn.microsoft.com/en-us/library/bb457204.aspx的评论](http://msdn.microsoft.com/en-us/library/bb457204.aspx)**

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-01T19:13:30.490

我做了更多的研究，似乎没有办法做我想做的事。我将不得不检查请求类型并从那里取消。

感谢大家的回答。

D

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-08-23T20:26:06.307

这是一些如何按扩展名过滤请求的简单示例...下面的示例从具有特定扩展名的处理文件中排除。

```
public class AuthenticationModule : IHttpModule
{
    private static readonly List<string> extensionsToSkip = AuthenticationConfig.ExtensionsToSkip.Split('|').ToList();

    // In the Init function, register for HttpApplication 
    // events by adding your handlers.
    public void Init(HttpApplication application)
    {
        application.BeginRequest += new EventHandler(this.Application_BeginRequest);
        application.EndRequest += new EventHandler(this.Application_EndRequest);
    }

    private void Application_BeginRequest(Object source, EventArgs e)
    {
        //  we don't have to process all requests...
        if (extensionsToSkip.Contains(Path.GetExtension(HttpContext.Current.Request.Url.LocalPath)))
            return;

        Trace.WriteLine("Application_BeginRequest: " + HttpContext.Current.Request.Url.AbsoluteUri);
    }

    private void Application_EndRequest(Object source, EventArgs e)
    {
        //  we don't have to process all requests...
        if (extensionsToSkip.Contains(Path.GetExtension(HttpContext.Current.Request.Url.LocalPath)))
            return;

        Trace.WriteLine("Application_BeginRequest: " + HttpContext.Current.Request.Url.AbsoluteUri);
    }
} 
```

在配置文件中指定应该排除哪些扩展并启动模块中的扩展列表。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-29T10:19:33.423

您可以通过检查最后一个 Uri.Segments 内容中的扩展名，使用 HttpModule（在对昂贵的 SharePoint 对象模型进行任何调用之前）以非常轻量级的方式执行此操作

```
void context_BeginRequest(object sender, EventArgs e)
{
    HttpApplication app = (HttpApplication)sender;
    Uri uri = app.Request.Url;
    string lastSegment = uri.Segments[uri.Segments.Length-1];
    .. check your extension here an do nothing if it doesn't match.
    ..
} 
```

我们在 SharePoint 的“TinyURL”实现中使用它来确保常规 URL 的性能影响几乎为 0。

# perl - 这个 Perl 条件是做什么的？

> ID：331400
> 
> 赞同：2
> 
> 时间：2008-12-01T16:48:01.827
> 
> 标签：perl, conditional

我试图从[vcake](http://sourceforge.net/projects/vcake)了解特定的 Perl 代码。通常我会在 Perl 中找到自己的方法，但下面的陈述让我感到困惑。我怀疑这只是一个错误，但我不完全确定。声明是：

```
foreach my $seq (keys %$set) {
    if( (defined $set->{$seq}) and (my $numReads >= ($coverage)) ) {
        do something;
    }
    ...
} 
```

`$coverage`已在文件开头定义为标量整数（例如 10），并且永远不会再次写入。`$numReads`仅在上面的行中使用，*其他地方都没有*！

`$set`另一方面，在循环内部进行了修改，因此条件的第一部分非常有意义。我不明白的是第二部分，因为在我看来，这将始终评估为相同的值，**我不明白`$numReads`or`>=`的**重要性。有人可以启发我吗？是否可能涉及不可见的自动变量？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2008-12-01T16:54:01.333

`my $numReads``foreach`意思是：在循环的上下文中创建一个新的局部变量。它的初始值为`undef`，在数值上下文中被视为`0`。所以代码如下：

```
if ((...) and (0 >= ($coverage)) ) {
} 
```

这意味着除非 $coverage 设置为 0 或更少，否则永远不会执行“做某事”。

如果这是调试代码，我会假设 $coverage 用于启用/禁用此语句。

我的猜测是：你发现了一个错误。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-12-02T10:51:55.650

人们可能还注意到，除非 $set 是对 %set 的引用，或者其他一些模仿 %set 结构的哈希，否则该行

```
foreach my $seq (keys %set) 
```

不符合条件

```
defined $set->{$seq} 
```

由于 $set->{$seq} 取消引用哈希引用，并且 %set 是哈希。这更有可能是第二个错误，而不是有人用 hashref 实例化了散列 %set 和标量 $set。

# java - java TrayIcon使用具有透明背景的图像

> ID：331407
> 
> 赞同：23
> 
> 时间：2008-12-01T16:49:34.430
> 
> 标签：java, linux, panel, gnome, tray

我正在使用以下代码在 Windows 和 Linux 中设置托盘图标。它在 Windows 中运行良好，在 Linux 中运行良好。在 Linux（Ubuntu）中，我将面板设置为（有点）透明，当我添加 GIF（具有透明背景）时，图标的背景显示为灰色和丑陋的（见图，绿色菱形“！”）。 ...关于如何使我添加的 GIF 图像“保持”其透明背景的任何想法？

[替代文字 http://unarm.org/stackoverflow/panel_task.jpg](http://unarm.org/stackoverflow/panel_task.jpg)

以及我正在使用的图像，如果您想测试：

[替代文字 http://unarm.org/stackoverflow/green_info.gif](http://unarm.org/stackoverflow/green_info.gif)

```
import java.awt.*;
import java.awt.event.*;

public class TrayFun {

  static class ShowMessageListener implements ActionListener {
    TrayIcon trayIcon;
    String title;
    String message;
    TrayIcon.MessageType messageType;
    ShowMessageListener(
        TrayIcon trayIcon,
        String title,
        String message,
        TrayIcon.MessageType messageType) {
      this.trayIcon = trayIcon;
      this.title = title;
      this.message = message;
      this.messageType = messageType;
    }
    public void actionPerformed(ActionEvent e) {
      trayIcon.displayMessage(title, message, messageType);
    }
  }

  public static void main(String args[]) {
    Runnable runner = new Runnable() {
      public void run() {
        if (SystemTray.isSupported()) {
          final SystemTray tray = SystemTray.getSystemTray();
          Image image = Toolkit.getDefaultToolkit().getImage("green_info.png");
          PopupMenu popup = new PopupMenu();
          final TrayIcon trayIcon = new TrayIcon(image, "The Tip Text", popup);
          trayIcon.setImageAutoSize(true);

          MenuItem item = new MenuItem("Close");
      item.addActionListener(new ActionListener() {
            public void actionPerformed(ActionEvent e) {
          tray.remove(trayIcon);
            }
      });
          popup.add(item);
          try {
            tray.add(trayIcon);
          } catch (AWTException e) {
            System.err.println("Can't add to tray");
          }
        } else {
          System.err.println("Tray unavailable");
        }
      }
    };
    EventQueue.invokeLater(runner);
  }
} 
```

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2010-10-07T13:18:47.383

问题出在 sun.awt.X11.XTrayIconPeer.IconCanvas.paint() 方法上！

在绘画之前，通过简单地绘制一个 IconCanvas 背景颜色的矩形来业余地清除图标背景，以允许图像动画。

```
public void paint(Graphics g) {
    if (g != null && curW > 0 && curH > 0) {
        BufferedImage bufImage = new BufferedImage(curW, curH, BufferedImage.TYPE_INT_ARGB);
        Graphics2D gr = bufImage.createGraphics();
        if (gr != null) {
            try {
                gr.setColor(getBackground());
                gr.fillRect(0, 0, curW, curH);
                gr.drawImage(image, 0, 0, curW, curH, observer);
                gr.dispose();

                g.drawImage(bufImage, 0, 0, curW, curH, null);
            } finally {
                gr.dispose();
            }
        }
    }
} 
```

见：[http ://bugs.java.com/bugdatabase/view_bug.do?bug_id=6453521](http://bugs.java.com/bugdatabase/view_bug.do?bug_id=6453521)

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2011-05-24T13:13:59.813

对于那些寻找“真正”解决方案的人，我开发了一个小型库，它能够显示托盘图标以尊重透明度，并且还接受 SVG 图标（适用于所有平台）：

[http://skype2gmail.blogspot.com/2011/05/java-tray-icon-transparency.html](http://skype2gmail.blogspot.com/2011/05/java-tray-icon-transparency.html)

它是一个开源库，源代码可以在这里找到：

[https://github.com/taksan/native-tray-adapter](https://github.com/taksan/native-tray-adapter)

该库通过在 linux 下运行时提供 JNI 替代方案（使用 GTK）来解决该问题。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-01T18:26:03.643

这个问题很有可能无法解决。这取决于 Java 在 Linux 中创建托盘子窗口方面是否做得很好。如果 Jave 做错了，则在绘制图像时透明度已经丢失。

1.  您正在使用的图标的真实背景值是多少？是上面显示的灰色调吗？将其设置为紫色以查看是否使用图像的透明度（Java 默认为灰色背景）。

2.  确保您尝试了 PNG 的两种透明度选项：透明颜色索引和 alpha 通道。Alpha 通道在 Linux 中很常见，而在 Windows 世界中则不然。

3.  您的图标分辨率太小。在 64x64 或更好的 128x128 中进行。AFAIK 托盘图标没有标准分辨率，即使是这样，它也肯定不是 16x16。

4.  您可以尝试的另一种格式是 SVG。只有在确保图像的透明度是问题后才能尝试（参见 1）。

有关此问题的背景信息，请参见此处： [http](http://www.rasterman.com/index.php?page=News) ://www.rasterman.com/index.php?page=News （向下滚动至 2006 年 2 月 2 日）

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-02T15:57:04.067

JDIC 有一个托盘图标，它们可能支持 linux 中的透明度... [https://jdic.dev.java.net/](https://jdic.dev.java.net/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-01T17:02:04.577

您是否尝试过将其转换为 .PNG（具有透明度）？我发现 Java 往往会更好地支持它们（根据我的经验）

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-04-21T00:12:25.727

这并不是说 。. . 这很高兴，因为它使用默认的 GNOME 主题来呈现透明度 - 它与它自身的图像无关 - 这是 adobe air / gnome 冲突 - 如果您切换到 gnome 主题，那么默认背景是灰色的它将是灰色而不是白色。它使用系统默认图像，因此即使它已设置，但面板的主题具有 BG 图像，使其看起来像 vista 一样有光泽，例如，它会这样做。Adobe Air / Java 不知道您使用透明主题默认设置，因此它使用系统默认设置

# wcf - WCF 服务代理生命周期的最佳实践？

> ID：331419
> 
> 赞同：14
> 
> 时间：2008-12-01T16:52:37.497
> 
> 标签：wcf, proxy, service

使用 WCF 服务时，每次使用它时创建一个新的服务实例会更好吗？还是创建一个并重新使用它更好？为什么两种方法都更好？异步代理也一样吗？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-11-29T16:07:20.300

> > 还是创建一个并重新使用它更好？

不要开始实现自己的池化实现。这已经在框架中完成了。WCF 代理在下面使用缓存的通道工厂。因此，创建新代理并不太昂贵（但请参阅 Guy Starbuck 关于会话和安全性的回复！）。

另请注意，代理会在一定的空闲时间（默认为 10 分钟）后超时。

如果您想要更明确的控制，您可以考虑直接使用 ChannelFactories 和通道，而不是“易于使用、开箱即用”的 ClientBase 代理。

[http://msdn.microsoft.com/en-us/library/ms734681.aspx](http://msdn.microsoft.com/en-us/library/ms734681.aspx)

关于这个主题的“必读”是：http: [//blogs.msdn.com/wenlong/archive/2007/10/27/performance-improvement-of-wcf-client-proxy-creation-and-best-practices .aspx](http://blogs.msdn.com/wenlong/archive/2007/10/27/performance-improvement-of-wcf-client-proxy-creation-and-best-practices.aspx)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-27T10:28:57.897

除了 Guy Starbuck 提到的事情之外，一个关键因素是您正在使用的安全模型（结合会话要求） - 如果您不重用代理，则不能重用安全会话.

这意味着客户端必须对每个调用进行身份验证，这是浪费的。

但是，如果您决定这是您希望做的事情，请确保将客户端配置为不建立安全上下文（因为您永远不会使用它），这将为您节省几次到服务器的往返:-)

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-11-28T16:37:22.813

要考虑的另一点是通道故障。按照设计，WCF 不允许在发生未处理的异常后使用客户端代理。

```
IMyContract proxy = new MyContractClient( );
try
{
   proxy.MyMethod( );
}
catch
{}

//Throws CommunicationObjectFaultedException
proxy.MyMethod( ); 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-12-01T17:18:47.833

.NET Remoting（WCF 取代的技术之一）中的服务器激活对象有一个推论，它有两种模式，“Single Call”（无状态）和“Singleton”（有状态）。

您在 WCF 中采用的方法应基于您的性能和扩展需求以及您的消费者的需求，以及服务器端设计约束。

如果您必须在对服务的调用之间维护状态，那么您显然希望拥有一个有状态的实例，但如果您不这样做，您可能应该实现它以便它是静态的，它应该可以更好地扩展（您可以更轻松地加载余额等）。

# .net - 常用正则表达式

> ID：331426
> 
> 赞同：8
> 
> 时间：2008-12-01T16:54:02.253
> 
> 标签：.net, regex

是否有一个在线网站列出了常见的正则表达式或有一个实用程序来帮助您根据示例文本创建一个？

谢谢！

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-12-01T16:58:36.080

最著名的正则表达式站点是：

[http://www.regular-expressions.info/](http://www.regular-expressions.info/)

[http://www.regexbuddy.com/](http://www.regexbuddy.com/)

[http://regexlib.com/RETester.aspx](http://regexlib.com/RETester.aspx)

这里有一个正则表达式备忘单：

[http://www.addedbytes.com/cheat-sheets/regular-expressions-cheat-sheet/](http://www.addedbytes.com/cheat-sheets/regular-expressions-cheat-sheet/)

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2008-12-01T16:58:13.103

*   [Expresso](http://www.ultrapico.com/expresso.htm)是一个很好的正则表达式工具。
*   [Regular-Expressions.info](http://www.regular-expressions.info/reference.html)是一个很好的教程
*   [Regexlib](http://regexlib.com/)有很多常用的正则表达式。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-03T08:29:19.057

由于有几个人提到了我开发的[RegexBuddy](http://www.regexbuddy.com)，我将补充说 RegexBuddy 包含一个用于许多常见目的的正则表达式库。

我不知道当今市场上有任何工具可以根据示例文本自动生成正则表达式。RegexBuddy 之类的工具则相反。您创建正则表达式，该工具会指示它是否与您的示例文本匹配。RegexBuddy 确实在 Create 选项卡上提供了一个 Insert Token 菜单，这使得创建正则表达式变得更加容易。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-01T16:57:31.263

有一些很棒的工具可以帮助创建基于示例文本的正则表达式，我认为一个叫做 regexbuddy（当我不在我的手机上时我会查找它），但是网站 regexlib.com 有很多用于常见目的的正则表达式。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-12-01T16:57:53.523

[正则表达式信息](http://www.regular-expressions.info/tutorial.html)是一个可以为您提供所需内容的站点

示例页面有一个很好的示例选择，以及实用程序的工具页面

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-12-03T08:55:56.147

Roy Osherove 有一套不错的免费正则表达式工具。事实上，我认为 Regulazy 可能正是您正在寻找的。他的工具页面已关闭，但您可以找到下载链接@http [://weblogs.asp.net/rosherove/pages/tools-and-frameworks-by-roy-osherove.aspx](http://weblogs.asp.net/rosherove/pages/tools-and-frameworks-by-roy-osherove.aspx)。尝试搜索他的博客以获取有关 Regulazy 的更多信息。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-12-03T09:02:36.430

[RegexPal](http://regexpal.com/)是一个很棒的在线正则表达式检查器，内置在 JavaScript 中。它还包含网站上的快速参考权利，以及来自 developer.mozilla.org 的近乎完整参考的链接。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-07-10T21:05:36.203

CPAN 上的[Regexp::Common](http://search.cpan.org/dist/Regexp-Common/)模块列出了许多常用的正则表达式。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-12-01T17:09:11.910

对于 Windows RegX 工具

试试 M Squared Technologies - Regx - 它是免费的。适合单行，反复试验。

[http://mSquaredTechnologies.com](http://mSquaredTechnologies.com)

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2012-11-28T00:43:48.130

我非常非常惊讶没有提到这个：

*   [http://txt2re.com/](http://txt2re.com/)

它通过提取字段从已知字符串创建正则表达式。一开始有点别扭，但是一旦掌握了，它就非常强大和好用。

如果允许我发布一个无耻的插件，我还创建了自己的[常用正则表达式表](http://fabiodan.alwaysdata.net/common-regex/index.html)。

# c - 每个 C 指令有多少个 asm 指令？

> ID：331428
> 
> 赞同：12
> 
> 时间：2008-12-01T16:54:29.973
> 
> 标签：c, assembly, instructions

我意识到这个问题不可能绝对回答，但我只是在了解大致数字：

给定一个合理大小的 C 程序（数千行代码），平均会生成多少条 ASM 指令。换句话说，现实的 C 与 ASM 指令比率是多少？随意做出假设，例如“使用当前的 x86 架构”。

我试图谷歌这件事，但我找不到任何东西。

**附录**：注意到这个问题带来了多少混乱，我觉得需要解释一下：我想通过这个答案知道，实际上是知道“3GHz”是什么意思。我完全清楚每赫兹的吞吐量因架构、硬件、缓存、总线速度和月球位置而有很大差异。

我不是在追求一个精确和科学的答案，而是一个可以放入可理解的尺度的经验答案。

这不是一个简单的地方答案（正如我注意到的那样），这是我最大的努力。我知道每行 C 的 ASM 结果行的数量取决于您在做什么。与- 我知道这`i++`一点不在同一个街区。`sqrt(23.1)`此外，无论我从 C 中得到什么 ASM，ASM 都会被解释为处理器内的各种微码集，这又取决于您运行的是 AMD、Intel 还是其他东西，以及它们各自的世代。我也知道这一点。

到目前为止，我得到的大致答案是我一直在追求的：一个足够大的项目平均每 1 行 ANSI-C 大约 2 行 x86 ASM。一旦流水线被填满并且给定足够大的样本，今天的处理器可能平均每个时钟周期大约有一个 ASM 命令。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2008-12-01T17:04:48.423

没有答案是可能的。像这样的语句`int a;`可能需要零个 asm 行。while 之类的语句`a = call_is_inlined();`可能需要 20 多行 asm 行。

您可以通过编译 ac 程序，然后启动`objdump -Sd ./a.out`. 它将混合显示 asm 和 C 代码，因此您可以看到为一条 C 行生成了多少 asm 行。例子：

*测试.c*

```
int get_int(int c);
int main(void) {
    int a = 1, b = 2;
    return getCode(a) + b;
} 
```

$`gcc -c -g test.c`

$`objdump -Sd ./test.o`

```
00000000 <main>:
int get_int(int c);
int main(void) { /* here, the prologue creates the frame for main */
   0:   8d 4c 24 04             lea    0x4(%esp),%ecx
   4:   83 e4 f0                and    $0xfffffff0,%esp
   7:   ff 71 fc                pushl  -0x4(%ecx)
   a:   55                      push   %ebp
   b:   89 e5                   mov    %esp,%ebp
   d:   51                      push   %ecx
   e:   83 ec 14                sub    $0x14,%esp
    int a = 1, b = 2; /* setting up space for locals */
  11:   c7 45 f4 01 00 00 00    movl   $0x1,-0xc(%ebp)
  18:   c7 45 f8 02 00 00 00    movl   $0x2,-0x8(%ebp)
    return getCode(a) + b;
  1f:   8b 45 f4                mov    -0xc(%ebp),%eax
  22:   89 04 24                mov    %eax,(%esp)
  25:   e8 fc ff ff ff          call   26 <main+0x26>
  2a:   03 45 f8                add    -0x8(%ebp),%eax
} /* the epilogue runs, returning to the previous frame */
  2d:   83 c4 14                add    $0x14,%esp
  30:   59                      pop    %ecx
  31:   5d                      pop    %ebp
  32:   8d 61 fc                lea    -0x4(%ecx),%esp
  35:   c3                      ret 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2008-12-01T17:05:46.037

我不确定您所说的“C指令”是什么意思，也许是语句或行？当然，这会因多种因素而有很大差异，但是在查看了我自己的几个示例程序后，其中许多都接近 2-1 标记（每个 LOC 2 个汇编指令），我不知道这是什么意味着或如何可能有用。

`gcc -S`您可以通过要求编译器仅生成程序集（例如）或在已编译的可执行文件上使用反汇编程序（但无论如何您都需要源代码来比较它）来为任何特定的程序和实现组合自己弄清楚这一点） .

**编辑**

只是根据您对要完成的工作的澄清（了解现代处理器在一秒钟内可以执行多少行代码）对此进行扩展：

虽然现代处理器每秒可以运行 30 亿个周期，但这并不意味着它每秒可以执行 30 亿条指令。这里有一些要考虑的事情：

*   许多指令需要多个周期才能执行（除法或浮点运算可能需要数十个周期才能执行）。
*   大多数程序大部分时间都在等待内存访问、磁盘访问等。
*   许多其他因素，包括操作系统开销（调度、系统调用等）也是限制因素。

但总的来说是的，处理器速度非常快，可以在短时间内完成惊人的事情。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-12-01T17:00:17.170

那变化很大！如果他们试图提供粗略的转换，我不会相信任何人。

像这样的语句`i++;`可以翻译成一个`INC AX`.

包含许多参数的函数调用语句可以是数十条指令，因为堆栈是为调用设置的。

然后在那里添加编译器优化，它将以不同于您编写代码的方式组装您的代码，从而消除指令。

此外，一些指令在机器字边界上运行得更好，因此`NOP`s 将贯穿您的代码。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-12-01T18:37:05.540

我认为您无法从您在这里尝试做的事情*中得出任何**关于*实际应用程序性能的有用结论。除非“不精确”是指“在几个数量级之内”。

 *您只是过于笼统，并且您正在忽略缓存等，就好像它是次要的，而它很可能完全占主导地位。

如果您的应用程序足够大，以至于每个 loc 有一些平均指令，那么它也将足够大，可以考虑 I/O 或至少重要的 RAM 访问问题。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-12-01T18:08:29.247

根据您的环境，您可以使用 Visual Studio 选项：/FAs

更多[在这里](http://codegem.org/2008/10/generate-assembly-from-c-code-in-visual-studio)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-12-01T17:02:44.217

我不确定这是否真的有一个有用的答案。当然，您将不得不选择架构（如您所建议的那样）。

我会做什么：采用大小合理的 C 程序。给 gcc “-S” 选项并检查自己。它将生成汇编源代码，您可以自己计算该程序的比率。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-12-01T19:04:38.120

RISC还是CISC？无论如何，C 中的*指令*是什么？

也就是说，在您非常具体地了解您正在使用的代码类型之前，您真的不知道以上几点。

您可以尝试查看有关装配优化和过去 30-40 年发生的硬件/软件干扰串扰的学术文献。在那里你可以找到一些关于你感兴趣的真实数据。（尽管我警告你，你最终可能会看到 C->PDP 数据而不是 C->IA-32 数据）。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2011-08-09T06:21:51.940

您在其中一条评论中写道，您想知道 3GHz 是什么意思。

甚至 CPU 的频率也无所谓。现代 PC-CPU 大量交错和调度指令，它们获取和预取、缓存内存和指令，并且通常该缓存无效并被扔进垃圾箱。通过运行真实世界的性能基准，可以获得对处理能力的最佳解释。

# iphone - 如何处理 iPhone 上的低内存警告？

> ID：331432
> 
> 赞同：4
> 
> 时间：2008-12-01T16:55:49.410
> 
> 标签：iphone, cocoa-touch, memory-management

当用户深入导航控制器视图堆栈时，我的应用程序收到内存不足警告时遇到问题。用户在后续的 UITableView 中浏览了一堆分层选项后，就可以在一个 UIWebView 中（在不同的视图控制器中）打开一个 PDF 文档。

一切正常，PDF 加载，用户可以翻阅页面。然而，当文档有点大，或者有几页，并且用户点击导航控制器中的“返回”按钮时，他的应用程序崩溃，因为导航控制器堆栈中的前一个视图控制器已被释放。

在寻找处理低内存警告的方法并处理此类问题之后，我发现了一些帖子，它们只是建议人们释放可以释放的对象，然后在用户尝试时延迟加载它们加载已被释放的视图。其中一篇文章是 Craig Hockenberry 的[处理记忆丧失：清理](http://furbo.org/2008/08/27/dealing-with-memory-loss-the-cleanup/)帖子。

虽然这有点帮助，但它并没有给我太多的信息来工作。

有人可以提供有关如何处理低内存警告以及如何实现对象“延迟加载”的简单指南吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-01T17:49:24.670

当内存不足时，系统会发出一系列与内存相关的消息。任何实例化的视图控制器都会收到 -didReceiveMemoryWarning 消息。如果你不实现这个，默认操作（假设视图控制器不是最前面的）是释放控制器的视图成员。如果你有钩子进入它，或者可能进入它的子视图，当你的控制器返回到堆栈顶部时，这可能会导致问题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-01T17:36:04.180

您的首要任务是找出导致问题的*确切原因。*哪个对象正在被释放？通常，解决这个问题只是确保对象被正确保留。

我建议您使用 NSZombiesEnabled 来尝试追踪您遇到问题的对象。一旦你有了它，你可以确保你正确地保留它。

# c# - 使用指针跨进程传递纹理

> ID：331449
> 
> 赞同：0
> 
> 时间：2008-12-01T16:58:24.037
> 
> 标签：c#, .net, directx, directshow, direct3d

很难把它放在标题中，所以让我解释一下。

我有一个应用程序，它使用 Direct3D 显示一些网格并使用 directshow(vmr9 + allocator) 播放一些视频，然后将视频帧作为纹理发送到 Direct3D 部分以应用于网格。该应用程序需要 24/7 全天候运行。至少允许每 24 小时重新启动一次，但不会比这更频繁。

现在的问题是，由于编解码器、视频驱动程序或视频文件本身，directshow 在播放几个小时后似乎出现了问题。此时应用程序只是拒绝播放视频。但是 Direct3D 部分仍然运行良好，网格仍然显示。重新启动应用程序后，一切恢复正常。

所以，我正在考虑将 2 个部分分成 2 个不同的过程。因此，当视频进程无法播放视频时，至少我可以立即重新启动它，而不会丢失 Direct3D 部分。

所以这里出现了实际的问题，是否可以通过传递指针将纹理从视频播放器传递到 direct3d 进程，也就是从指针中检索另一个进程的纹理？由于受保护的内存寻址，我最初的猜测是不可能的。

我在两个进程上都设置了 TCP 通信，此时我们不必担心指针的通信。

这可能是一个疯狂的想法，但它会创造奇迹

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-08-29T03:36:21.470

是的，您可以使用 Direct3D 9Ex 做到这一点。这仅适用于 Vista，您必须使用 Direct3DDevice9Ex。您可以在此处阅读有关共享[资源的信息。](http://msdn.microsoft.com/en-us/library/bb219800(VS.85).aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-01T17:27:26.680

> 现在的问题是，由于编解码器、视频驱动程序或视频文件本身，directshow 在播放几个小时后似乎出现了问题。此时应用程序只是拒绝播放视频。

为什么不直接修复这个错误呢？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-01T17:04:51.310

如果你把它作为一个单独的**进程**分开，那么我怀疑这是不可能的，但如果它是一个子**线程**，那么我相信他们会有共享内存寻址。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-01T17:31:51.007

传递纹理不起作用。

我会使用以下方法来做到这一点：

*   将 VMR 替换为将图片放入内存的自定义渲染器+分配器
*   您从共享内存池中为图片分配内存
*   一旦你收到另一张照片，你就发出了一个事件的信号
*   Direct3D 进程等待此事件并使用新纹理更新网格

请注意，您需要将图片数据传输到显卡。最大的不同是，这种传输现在发生在 Direct3D 应用程序中，而不是在 DirectShow 应用程序中。

您也可以尝试为此使用 VMR。我不确定自定义分配器/渲染器部分是否允许您渲染到共享内存中。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-11T17:15:25.573

也许您可以在 DirectShow 主机进程中使用 Sample Grabber 来获取图像作为系统内存缓冲区。然后，您可以使用 WriteProcessMemory 将数据写入 Direct3D 应用程序中预先约定的地址（通过 TCP 或其他方式设置）。

# asp.net - 覆盖 ASP.NET WebMethod 参数的 DateTime 序列化

> ID：331455
> 
> 赞同：8
> 
> 时间：2008-12-01T17:00:12.943
> 
> 标签：asp.net, web-services

我正在清理一个大型代码库中的一个错误，其中没有人关注本地时间与 UTC 时间。

我们想要的是一种全局忽略发送到我们的 ASP.NET Web 服务和从我们的 ASP.NET Web 服务发送的 DateTime 对象的时区信息的方法。我有一个检索操作的解决方案。数据仅在数据集中返回，我可以查找 DateTime 列并将 DateTimeMode 设置为 Unspecified。这解决了我在数据集中来回传递的所有数据的问题。

然而，DateTime 对象也经常作为参数直接传递给 Web 方法。我想剥离任何传入的时区信息。与其搜索我们的客户端代码并使用 DateTime.SpecifyKind(..) 将所有 DateTime 变量设置为未定义，我想做某种全局 ASP.NET 覆盖来监视传入参数并去除时区信息。

这样的事情可能吗？还是有另一种更简单的方法来做我想做的事？

重申一下——我不关心时区，每个人都在同一个时区。但是有几个用户的机器配置错误，时区错误等。所以当他们在 2008 年 7 月 1 日发送时，我在服务器端得到 2008 年 6 月 30 日 22:00:00，它会自动将其从他们的本地时间到服务器的本地时间。

**更新：**另一种可能性是，如果可以在客户端 .NET 代码上进行更改，以改变类型为“未定义”的 DateTime 对象的序列化方式。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-01T19:21:34.763

我经常在许多应用程序、服务和不同平台（.NET、Java 等）上处理这个问题。请相信我，您不希望假装您不关心时区的长期后果。在追逐了许多非常困难且修复成本高昂的错误之后，您会希望自己在意。

因此，您应该捕获正确的时区或强制使用特定的时区，而不是剥离时区。如果可以，请修复各种数据源以提供正确的时区。如果它们超出您的控制范围，则强制它们使用服务器的本地时区或 UTC。

一般的行业惯例是强制一切使用 UTC，并将所有生产硬件时钟设置为 UTC（这意味着服务器、路由器等网络设备等）。然后，您应该在 UI 中转换为/从用户的本地时区转换。

如果你现在正确地修复它，它可以很容易和便宜。如果你故意进一步打破它，因为你认为这会更便宜，那么当你必须解开这个可怕的烂摊子时，你将没有任何借口。

请注意，这类似于字符串的常见问题：不存在纯文本（没有字符编码的字符串），也不存在纯（无时区）时间/日期之类的东西。假装是许多痛苦和心痛以及令人尴尬的错误的根源。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-02T16:57:59.607

好的，我确实有一个解决方法，这取决于我实际上只需要 DateTime 的 Date 部分这一事实。我将此属性附加到系统中的每个 Date 或 DateTime 参数

```
<XmlElement(DataType:="date")> 
```

这会将生成的 wsdl 更改为具有类型 s:date 而不是 s:dateTime。（请注意，简单地将 .NET 方法参数的类型设为 Date 而不是 DateTime 并不能做到这一点）。所以客户端现在只发送 DateTime 的日期部分，没有时间信息，没有时区信息。

如果我需要向服务器发送日期和时间值，我将不得不使用其他一些解决方法，比如将其设为字符串参数。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-07-14T20:34:24.287

我也遇到了时区信息的问题。问题是我已经在 UTC 中提供了日期时间字段。然后发生序列化，本地偏移量成为日期/时间的一部分。我们供应商在不同时区的日期/时间非常混乱。我通过在我用来填充数据集的选择语句中的日期时间字段上使用 tsql 转换函数解决了这个问题。这将字段转换为字符串变量，该变量在客户端自动转换为日期时间值。如果您只想传递日期，则可以使用 101 代码仅提供日期。我使用 126 准确地提供日期和时间在我的数据库列中的显示方式，并去除了时区信息。

# oracle - Oracle 应用程序并发管理器作业所有者

> ID：331456
> 
> 赞同：0
> 
> 时间：2008-12-01T17:00:16.327
> 
> 标签：oracle, concurrency, owner, oracleapplications

默认情况下，并发管理器作业在 APPS 用户下运行。是否可以将其配置为以其他用户身份运行？我希望能够隔离我的一些存储过程。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-17T00:17:40.417

不知道任何标准方式，但您可以编写并发请求来处理它。例如复制 fnd_concurrent_requests，然后在“真正的”并发程序中插入您的 custom_fnd_concurrent_requests “select * from fnd_concurrent_requests”。创建 dbms_job 或其他东西来轮询您的自定义表，并让它调用您的“真实”程序 - 确保您使用 fnd_concurrent_requests 中的用户、resp 和 appl 进行 fnd_global.initialize，并使用 utl_file 而不是 fnd_file 将输出直接输出到您自己的文件.

# asp.net-2.0 - 威胁已经被清除了

> ID：331460
> 
> 赞同：1
> 
> 时间：2008-12-01T17:01:10.617
> 
> 标签：asp.net-2.0

我在 ASP.NET 页面中收到“线程被中止”异常。我根本没有使用任何 Response.Redirect/Server.Transfer 方法。有人可以帮我解决这个问题吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-01T17:12:28.283

**不好**的解决方案是使用

```
Response.Redirect(URL, False) 
```

这将导致**不**响应 Response.End() 当前页面，但是要小心，这可能会导致问题，因为页面的其余部分将被**执行**，并可能导致**登录绕过**以及类似的安全和性能问题。

编辑：显然你没有使用 Response.Redirect 并且你不能用 Try Catch 捕获 AbortThreadExecution，这意味着这个答案现在完全没用了:)

尽管要获得答案，您需要学习如何提出问题。您需要提供以下信息：

*   异常详情
*   什么时候出现，有什么症状
*   你有什么尝试但没有奏效
*   您是否管理隔离问题？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-01T17:14:25.957

如果在您的代码执行时 Web 应用程序被关闭或强制重新启动，则可能会发生这种情况。我已经看到当您的 Web 应用程序将文件写入托管它的 Web 目录时会发生这种情况，从而导致重新编译 Web 应用程序。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-02-22T12:59:06.690

**错误**：线程被中止。在 System.Threading.Thread.AbortInternal() 在 System.Threading.Thread.Abort(Object stateInfo) 在 System.Web.HttpResponse.End()

此错误主要发生在使用 Response.End、Response.Redirect 或 Server.Transfer 时

**原因**：Response.End 方法结束页面执行并将执行转移到应用程序事件管道中的 Application_EndRequest 事件。Response.End 后面的代码行没有被执行。

此问题出现在 Response.Redirect 和 Server.Transfer 方法中，因为这两种方法都在内部调用 Response.End。

**分辨率/解决方案**：

您可以使用 try-catch 语句来捕获此异常

或者

对于 Response.End，调用 HttpContext.Current.ApplicationInstance.CompleteRequest 方法而不是 Response.End 以绕过对 Application_EndRequest 事件的代码执行。对于 Response.Redirect，使用重载 Response.Redirect(String url, bool endResponse) 为 endResponse 参数传递 false 以抑制对 Response.End 的内部调用。例如：例如：Response.Redirect(“nextpage.aspx”, false); 如果您使用此解决方法，将执行 Response.Redirect 之后的代码。对于 Server.Transfer，请改用 Server.Execute 方法。

# logging - Server2008 / iis7 上的日志记录功能？

> ID：331461
> 
> 赞同：1
> 
> 时间：2008-12-01T17:01:16.950
> 
> 标签：logging, iis-7, windows-server-2008, logparser

我突然负责调试/找出几天前崩溃其 ApplicationPool 的 asp.net 应用程序出了什么问题。我们设置的 5 分钟故障保护中的 5 个错误将其删除。问题是它仍然提供页面，因此只为一些访问者返回了 503。遗憾的是，我们在应用程序中的日志记录不足，而且这种情况很少发生，而且只发生在场中的一台服务器上，因此很难找出问题所在。

现在回答问题。我不是管理员，也不是 IIS7 和 Server2008 的新手，所以我只是在寻找我拥有的可能性。我所知道和拥有的：

*   httperr 日志文件。
*   一些保存在另一个磁盘中的 wc3 格式的站点特定日志，看起来像访问日志？
*   事件查看器

还有可能设置跟踪失败的请求，我知道这可能会获得一些性能吗？

我是否遗漏了任何已记录或可以记录的内容？关于如何检查我的服务器以确保应用程序正常运行的任何一般提示？

我将学习 LogParser，因为这似乎是我应该做的，有什么提示吗？

编辑：我也对机器状态的日志感兴趣。像cpu-load，内存等。有什么可能性吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-01T22:27:06.760

您应该查看 Tess Ferrandez “[如果它坏了，你应该修复它](http://blogs.msdn.com/tess/)”博客。这是我所知道的用于调试生产 asp.net 应用程序的最佳资源。可能所有的日志都无法为您提供足够的帮助。在大多数情况下，它的应用程序代码负责崩溃。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-01T17:14:46.360

在我们的 Web 应用程序中，我通过 HttpApplication 错误事件捕获所有未处理的异常，并将这些异常与我需要的所有辅助数据一起记录到数据库中。如果该日志记录失败，那么我求助于 Windows EventLog。然后我在另一台机器上运行服务，定期检查日志和站点，并按计划通过电子邮件向我发送更新。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-01T17:15:15.113

如果您特别喜欢冒险，可以使用多种方法来创建和分析 IIS 的故障转储。

[http://support.microsoft.com/kb/892277](http://support.microsoft.com/kb/892277)

使用它，可以找出崩溃点的调用堆栈。

# c++ - .NET 2.0 + C++ 的加密算法/库

> ID：331468
> 
> 赞同：2
> 
> 时间：2008-12-01T17:02:35.917
> 
> 标签：c++, encryption, .net-2.0, aes, rijndael

我需要一个适用于 .NET 2.0 和 C++ 的标准、Microsoft 提供的加密库。你有什么建议？

我们发现 AES 仅在 .NET 3.5 中提供（并且在 C++ 中可用）

我们发现 Rijndael 在 .NET 2.0 中使用，但在标准 C++ 库中不可用。

如果我错了（很好的机会），你能指出我正确的方向吗？

最坏的情况，我想我可以使用 PInvoke 从 .NET 调用 Rijndael 算法，但我宁愿有一个本机解决方案。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-01T17:25:02.563

AES 和 Rijndael 本质上是相同的算法，但对块大小和密码模式有限制。因此，只要您可以忍受这些[限制](http://blogs.msdn.com/shawnfa/archive/2006/10/09/The-Differences-Between-Rijndael-and-AES.aspx)（不繁重），您就可以互换使用它们。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-01T19:36:52.597

我们成功地做了类似的事情，希望对您有所帮助：

### C++ 加密API

*   [CryptoAPI](http://msdn.microsoft.com/en-us/library/aa380239(VS.85).aspx)是纯 Win32 (c/c++)，适用于所有 Microsoft 操作系统。
*   使用[增强型加密提供程序](http://msdn.microsoft.com/en-us/library/aa386986(VS.85).aspx)( `MS_ENHANCED_PROV`)
*   使用[三重 DES](http://msdn.microsoft.com/en-us/library/aa382020(VS.85).aspx) ( `CALG_3DES`) 算法

### .NET TripleDes 提供程序

*   在 .NET 端使用[TripleDESCryptoServiceProvider](http://msdn.microsoft.com/en-us/library/system.security.cryptography.tripledescryptoserviceprovider(VS.80).aspx)。

### 旁注

*   我们**避免**像瘟疫一样的 CAPICOM，因为它带来的部署噩梦不值得麻烦。
*   .NET 端的字节顺序有时会发挥作用。例如，要使用在 C++ (CryptoAPI) 端生成的密钥，您需要先反转字节数组，然后再在 TripleDESCryptoServiceProvider 中使用它。

如果您想了解更多详细信息，请发表评论，我可以提供更多。快乐的加密货币！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-01T17:16:36.340

3DES 可通过 Capicom 获得。有关信息，请参见[此处](http://msdn.microsoft.com/en-us/library/aa382010(VS.85).aspx)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-13T15:37:06.217

Windows 包含一个 C/C++ AES 加密库，作为[AES Cryptographic Services Provider](http://msdn.microsoft.com/en-us/library/aa386979(VS.85).aspx)的一部分。它适合在本机 C/C++ 应用程序中使用。

# java - Swing 可以告诉我是否有活动的工具提示吗？

> ID：331488
> 
> 赞同：5
> 
> 时间：2008-12-01T17:09:37.977
> 
> 标签：java, swing, tooltip

Swing 中是否有一种优雅的方式来找出我的框架中当前是否显示任何工具提示？

我正在使用自定义工具提示，因此在我的`createToolTip()`方法中设置标志非常容易，但我看不到工具提示何时消失的方法。

`ToolTipManager`对此有一个很好的标志，tipShowing，但当然是这样，`private`而且他们似乎没有提供实现它的方法。 `hideWindow()`没有调用工具提示组件（我可以告诉），所以我看不到那里的方法。

有人有什么好主意吗？

更新：我带着反思去了。你可以在这里看到代码：

```
private boolean isToolTipVisible() {
    // Going to do some nasty reflection to get at this private field.  Don't try this at home!
    ToolTipManager ttManager = ToolTipManager.sharedInstance();
    try {
        Field f = ttManager.getClass().getDeclaredField("tipShowing");
        f.setAccessible(true);

        boolean tipShowing = f.getBoolean(ttManager);

        return tipShowing;

    } catch (Exception e) {
        // We'll keep silent about this for now, but obviously we don't want to hit this
        // e.printStackTrace();
        return false;
    }
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-01T17:19:55.133

hideTipAction 的 isEnabled() 属性似乎直接与 tipShowing 布尔值相关联。你可以试试这个：

```
public boolean isTooltipShowing(JComponent component) {
    AbstractAction hideTipAction = (AbstractAction) component.getActionMap().get("hideTip");
    return hideTipAction.isEnabled();
 } 
```

您可能想要对空值等进行一些健全性检查。但这应该让您非常接近。

编辑，您的回复：

缺少一些丑陋的反射代码，我认为您别无选择。`ToolTipManager`由于包私有构造函数，您不能子类化，并且`showTipWindow()`and`hideTipWindow()`也是包私有的，因此适配器模式也被淘汰了。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-01T17:35:42.933

看起来这将需要遍历所有组件以查看它们是否有工具提示。我正在寻找一个全球价值。循环可能是可行的，但似乎效率低下。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-01T20:27:18.187

这太糟糕了。经过内部讨论，我们也提出了“丑陋的反射”，但我希望那里有人有更好的主意。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-01T21:19:58.457

既然你已经有了自己的 createToolTip()，也许你可以尝试这样的事情:)

```
public JToolTip createToolTip() {
  JToolTip tip = super.createToolTip();
  tip.addAncestorListener( new AncestorListener() {
    public void ancestorAdded( AncestorEvent event ) {
      System.out.println( "I'm Visible!..." );
    }

    public void ancestorRemoved( AncestorEvent event ) {
      System.out.println( "...now I'm not." );
    }

    public void ancestorMoved( AncestorEvent event ) { 
      // ignore
    }
  } );
  return tip;
} 
```

# objective-c - 为什么 NSSet objectEnumerator 会增加保留计数？

> ID：331490
> 
> 赞同：1
> 
> 时间：2008-12-01T17:11:08.147
> 
> 标签：objective-c, cocoa

在以下代码中获取 objectEnumerator 后，set1 保留计数变为 3。我很惊讶地看到它，因为我没想到它会改变。我搜索了[文档](http://developer.apple.com/documentation/Cocoa/Reference/Foundation/Classes/NSSet_Class/Reference/Reference.html#//apple_ref/occ/instm/NSSet/objectEnumerator)，找不到解释这种效果的地方。

我假设额外的保留可能由 Cocoa 枚举逻辑设置为自动释放，并且在当前事件循环中不会真正产生任何影响。objectEnumerator 逻辑需要对 set1 的引用是有道理的，但我想知道为什么要制作它们。原因如下：如果我假设 set1 在代码发布后保留计数为零，那么我可以尝试在另一个新集合中重用它。由于 set1 现在指向一个完全不同的对象/地址，这不会引起问题吗？

对于“奖励”点，有没有办法枚举自动释放池，看看它实际包含什么？TIA

```
#import <Foundation/NSObject.h>
#import <Foundation/NSSet.h>
#import <Foundation/NSValue.h>
#import <Foundation/NSEnumerator.h>
#import <Foundation/NSAutoreleasePool.h>
#import <Foundation/NSString.h>

#import <stdio.h>;

// macro to create an integer number:
#define INTOBJ(v) [NSNumber numberWithInt: v]

int main (int argc, char *argv[])
{
    NSAutoreleasePool *pool = [NSAutoreleasePool new];

    //Make set
    NSMutableSet *set1 = [[NSMutableSet alloc] initWithObjects:
        INTOBJ(1), INTOBJ(2), INTOBJ(5), INTOBJ(10), nil];

    printf("set1 #%lu\n", [set1 retainCount]);

    //Get enumerator of the set. This is where the retain count goes to 3:
    NSEnumerator *setEnum = [set1 objectEnumerator];
    printf("setEnum #%lu\n", [setEnum retainCount]);
    printf("set1 #%lu\n", [set1 retainCount]);

    //Iterate through the collection:
    printf("[");

    NSNumber *element;
    while ((element = [setEnum nextObject]) != nil)
        //do some this with item. printf is just for debugging:
        printf(" %i ", [element intValue]);

    printf("]\n");
    printf("set1 #%lu\n", [set1 retainCount]);

    [set1 release];
    printf("set1 after release #%lu\n", [set1 retainCount]);

    //More logic could go here reusing variable set1 since I assumed retain count = 0

    [pool release];

    return 0;
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-01T17:57:27.053

依赖对象的保留计数通常不是一个好主意，因为它是框架的内部细节。相反，请确保您的代码遵守内存管理原则，特别是确保保留/新建/复制和释放/自动释放是平衡的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-01T21:13:23.993

据推测，枚举器保留了集合，以便在枚举期间不会释放它。没有要枚举的有效集合的枚举器不会很好地工作。事实上，枚举器确保它能够工作的唯一方法是保留它枚举的集合。

*也就是说，除了*调试内存泄漏/双重释放问题之外，真的没有理由查看任何对象的保留计数。只要您遵循内存管理约定，您就不必担心对象的保留计数。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-01T17:19:17.537

释放后重用 set1 不会导致问题，因为保留计数在变量 set1 引用的 Object 上，而不是在变量本身上。

# c# - Linq to XML - 更新/更改 XML 文档的节点

> ID：331502
> 
> 赞同：21
> 
> 时间：2008-12-01T17:13:41.603
> 
> 标签：c#, xml, linq, linq-to-xml

我有 2 个问题：

1\. 我已经开始使用 Linq to XML，我想知道是否可以通过 Linq 更改 XML 文档。我的意思是，有没有类似的东西

```
XDocument xmlDoc = XDocument.Load("sample.xml");

update item in xmlDoc.Descendants("item")
where (int)item .Attribute("id") == id
... 
```

2\. 我已经知道如何通过简单地使用来创建和添加新的 XMLElement

```
xmlDoc.Element("items").Add(new XElement(......); 
```

但是如何删除单个条目？

XML 样本数据：

```
<items>
  <item id="1" name="sample1" info="sample1 info" web="" />
  <item id="2" name="sample2" info="sample2 info" web="" />
</itmes> 
```

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2008-12-04T15:51:40.863

谢谢您的回答。一切正常。

就像我的问题的完成一样，下面的代码显示了如何修改单个条目：

```
string xml = @"<data><record id='1' info='sample Info'/><record id='2' info='sample Info'/><record id='3' info='sample Info'/></data>";
StringReader sr = new StringReader(xml);
XDocument d = XDocument.Load(sr);

d.Descendants("record").Where(x => x.Attribute("id").Value == "2").Single().SetAttributeValue("info", "new sample info"); 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-12-02T20:52:16.703

这是你的想法吗？

```
using System;
using System.Linq;
using System.Xml.Linq;

static void Main(string[] args)
{
    string xml = @"<data><record id='1'/><record id='2'/><record id='3'/></data>";
    StringReader sr = new StringReader(xml);
    XDocument d = XDocument.Load(sr);

    // the verbose way, if you will be removing many elements (though in
    // this case, we're only removing one)
    var list = from XElement e in d.Descendants("record")
               where e.Attribute("id").Value == "2" 
               select e;

    // convert the list to an array so that we're not modifying the
    // collection that we're iterating over
    foreach (XElement e in list.ToArray())
    {
       e.Remove();
    }

    // the concise way, which only works if you're removing a single element
    // (and will blow up if the element isn't found)
    d.Descendants("record").Where(x => x.Attribute("id").Value == "3").Single().Remove();

    XmlWriter xw = XmlWriter.Create(Console.Out);
    d.WriteTo(xw);
    xw.Flush();
    Console.ReadLine();
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-11-06T16:47:17.743

答案在这个线程中......你只需要做很多排序才能找到它们，所以我已经为你完成了编译它们的工作：

1.  是的，您可以编辑元素
2.  删除元素很简单：element.Remove(); （记得在那之后保存xDocument）

现在，如果您正在阅读此线程，您可能想知道如何编辑元素。在 xml 中存储数据有两种不同的方式，例如：

```
<tagName attributeName="some value">another value</tagName> 
```

1.  作为标签上的属性
2.  作为标签的内容（读取值）

要编辑**属性**的值，诺克斯回答了他自己的问题：

```
d.Descendants("record").Where(x => x.Attribute("id").Value == "2").Single().SetAttributeValue("info", "new sample info"); 
```

换句话说，获取要更改的 XElement，然后调用 element.SetAttributeValue("AttributeName", "new value for the attribute")

如果您想编辑标签的**值或内容**，那么 Ajay 会回答它（如果您仔细研究他的所有代码）：

```
persondata.Element("City").Value = txtCity.Text; 
```

或者，换句话说，一旦你拥有你所追求的 XElement，只需使用 .Value 并分配。

请记住，在对内存中的元素执行任何这些修改后，如果要将这些更改保存到磁盘，则必须在 XDocument 上调用 .Save()。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-02-02T17:48:40.877

使用系统；使用 System.Collections.Generic；使用 System.Linq；使用 System.Text；使用 System.Xml.Linq；//使用 System.Xml;

命名空间 XMLtoLinqApp { 类程序 { 静态无效 Main(string[] args) {

```
 //XmlDocument doc = new XmlDocument();
        //XmlElement newBook=doc.CreateElement("BookParticipant");
        //newBook.SetAttribute("Author");

        //Using Functional Construction to Create an XML Schema
        XElement xBookParticipant = new XElement("BookParticipant",
                                        new XElement("FirstName", "Joe"),
                                        new XElement("LastName", "Rattz"));
        Console.WriteLine(xBookParticipant.ToString());

        //Creates the Same XML Tree as Listing 6-1 but with Far Less Code
        XElement xBookParticipants = new XElement("BookParticipants",
                                        new XElement("BookParticipant",
                                        new XAttribute("type", "Author"),
                                        new XElement("FirstName", "Joe"),
                                        new XElement("LastName", "Rattz")),
                                        new XElement("BookParticipant",
                                        new XAttribute("type", "Editor"),
                                        new XElement("FirstName", "Ewan"),
                                        new XElement("LastName", "Buckingham")));
        Console.WriteLine(xBookParticipants.ToString());

        //-- Disadvatages of XML document
        //System.Xml.XmlElement xmlBookParticipant = new System.Xml.XmlElement("BookParticipant");
        XElement xeBookParticipant = new XElement("BookParticipant");

        XDocument xDocument = new XDocument(new XElement("BookParticipants",
                                            new XElement("BookParticipant",
                                            new XAttribute("type", "Author"),
                                            new XElement("FirstName", "Joe"),
                                            new XElement("LastName", "Rattz"))));
        Console.WriteLine(xDocument.ToString());

        //--Calling the ToString Method on an Element Produces the XML Tree
        XElement name = new XElement("Name", "Joe");
        Console.WriteLine(name.ToString());

        //--Console.WriteLine Implicitly Calling the ToString Method on an Element to Produce an XML Tree

        XElement name1 = new XElement("Person",
                                      new XElement("FirstName", "Joe"),
                                      new XElement("LastName", "Rattz"));
        Console.WriteLine(name1);

        //-- Casting an Element to Its Value’s Data Type Outputs the Value
        Console.WriteLine(name);
        Console.WriteLine((string)name);

        //--Different Node Value Types Retrieved via Casting to the Node Value’s Type
        XElement count = new XElement("Count", 12);
        Console.WriteLine(count);
        Console.WriteLine((int)count);

        XElement smoker = new XElement("Smoker", false);
        Console.WriteLine(smoker);
        Console.WriteLine((bool)smoker);

        XElement pi = new XElement("Pi", 3.1415926535);
        Console.WriteLine(pi);
        Console.WriteLine((double)pi);

        DeferredQryProblem();

        GenerateXMlFromLinqQry();

        WithoutReaching();

        Ancestors();

        AncestorsAndSelf();

        SortSample();

        FindElementwithSpecificChild();

    }

    private static void DeferredQryProblem()
    {
        XDocument xDocument = new XDocument(
                    new XElement("BookParticipants",
                    new XElement("BookParticipant",
                    new XAttribute("type", "Author"),
                    new XElement("FirstName", "Joe"),
                    new XElement("LastName", "Rattz")),
                    new XElement("BookParticipant",
                    new XAttribute("type", "Editor"),
                    new XElement("FirstName", "Ewan"),
                    new XElement("LastName", "Buckingham"))));
        IEnumerable<XElement> elements =
        xDocument.Element("BookParticipants").Elements("BookParticipant");
        foreach (XElement element in elements)
        {
            Console.WriteLine("Source element: {0} : value = {1}",
            element.Name, element.Value);
        }
        foreach (XElement element in elements)
        {
            Console.WriteLine("Removing {0} = {1} ...", element.Name, element.Value);
            element.Remove();
        }
        Console.WriteLine(xDocument);

        foreach (XElement element in elements)
        {
            Console.WriteLine("Source element: {0} : value = {1}",
            element.Name, element.Value);
        }
        foreach (XElement element in elements.ToArray())
        {
            Console.WriteLine("Removing {0} = {1} ...", element.Name, element.Value);
            element.Remove();
        }
        Console.WriteLine(xDocument);
    }

    //-- Creating an Attribute and Adding It to Its Element
    private static void CreatingAttribute()
    {
        XElement xBookParticipant = new XElement("BookParticipant", new XAttribute("type", "Author"));
        Console.WriteLine(xBookParticipant);
    }

    //--Creating a Comment with Functional Construction
    private static void CreatingComment()
    {
        XElement xBookParticipant = new XElement("BookParticipant",
                                                  new XComment("This person is retired."));
        Console.WriteLine(xBookParticipant);
    }

    //--Creating a Declaration with Functional Construction
    private static void CreateXmlDeclaration()
    {
        XDocument xDocument = new XDocument(new XDeclaration("1.0", "UTF-8", "yes"), 
```

新 XElement("BookParticipant")); Console.WriteLine(xDocument); }

```
 private static void GenerateXMlFromLinqQry()
    {
        BookParticipant[] bookParticipants = new[] {new BookParticipant {FirstName = "Joe", LastName = "Rattz",
                                                    ParticipantType = ParticipantTypes.Author},
                                                    new BookParticipant {FirstName = "Ewan", LastName = "Buckingham",
                                                    ParticipantType = ParticipantTypes.Editor}
                                                    };
        XElement xBookParticipants =
        new XElement("BookParticipants",
                     bookParticipants.Select(p =>
                new XElement("BookParticipant",
                new XAttribute("type", p.ParticipantType),
                new XElement("FirstName", p.FirstName),
                new XElement("LastName", p.LastName))));

        Console.WriteLine(xBookParticipants);
    }

    //-- Obtaining Elements Without Reaching
    private static void WithoutReaching()
    {
        XDocument xDocument = new XDocument(new XElement("BookParticipants",
                                            new XElement("BookParticipant",
                                            new XAttribute("type", "Author"),
                                            new XElement("FirstName", "Joe"),
                                            new XElement("LastName", "Rattz")),
                                            new XElement("BookParticipant",
                                            new XAttribute("type", "Editor"),
                                            new XElement("FirstName", "Ewan"),
                                            new XElement("LastName", "Buckingham"))));

        //-- Simple Descendants
        IEnumerable<XElement> elements = xDocument.Descendants("BookParticipant");

        foreach (XElement element in elements)
        {
            Console.WriteLine("Element: {0} : value = {1}",
            element.Name, element.Value);
        }

        //-- Descendants with Where Clause
        IEnumerable<XElement> elements1 = xDocument.Descendants("BookParticipant")
                                                   .Where(e => ((string)e.Element("FirstName")) == "Ewan");
        foreach (XElement element1 in elements1)
        {
            Console.WriteLine("Element: {0} : value = {1}",
            element1.Name, element1.Value);
        }

    }

    //-- Ancestors Prototype
    private static void Ancestors()
    {
        XDocument xDocument = new XDocument(new XElement("BookParticipants",
                                            new XElement("BookParticipant",
                                            new XAttribute("type", "Author"),
                                            new XElement("FirstName", "Joe"),
                                            new XElement("LastName", "Rattz")),
                                            new XElement("BookParticipant",
                                            new XAttribute("type", "Editor"),
                                            new XElement("FirstName", "Ewan"),
                                            new XElement("LastName", "Buckingham"))));

        IEnumerable<XElement> elements = xDocument.Element("BookParticipants").Descendants("FirstName");
        // First, I will display the source elements.
        foreach (XElement element in elements)
        {
            Console.WriteLine("Source element: {0} : value = {1}",
            element.Name, element.Value);
        }
        // Now, I will display the ancestor elements for each source element.
        foreach (XElement element in elements.Ancestors())
        {
            Console.WriteLine("Ancestor element: {0}", element.Name);
        }

        // Now, I will display the ancestor elements for each source element.
        foreach (XElement element in elements.Ancestors("BookParticipant"))
        {
            Console.WriteLine("Ancestor element: {0}", element.Name);
        }

    }

    //-- AncestorsAndSelf
    private static void AncestorsAndSelf()
    {
        XDocument xDocument = new XDocument(
            new XElement("BookParticipants",
            new XElement("BookParticipant",
            new XAttribute("type", "Author"),
            new XElement("FirstName", "Joe"),
            new XElement("LastName", "Rattz")),
            new XElement("BookParticipant",
            new XAttribute("type", "Editor"),
            new XElement("FirstName", "Ewan"),
            new XElement("LastName", "Buckingham"))));
        IEnumerable<XElement> elements =
        xDocument.Element("BookParticipants").Descendants("FirstName");
        // First, I will display the source elements.
        foreach (XElement element in elements)
        {
            Console.WriteLine("Source element: {0} : value = {1}",
            element.Name, element.Value);
        }
        // Now, I will display the ancestor elements for each source element.
        foreach (XElement element in elements.AncestorsAndSelf())
        {
            Console.WriteLine("Ancestor element: {0}", element.Name);
        }

        // Now, I will display the ancestor elements for each source element.
        foreach (XElement element in elements.AncestorsAndSelf("BookParticipant"))
        {
            Console.WriteLine("Ancestor element: {0}", element.Name);
        }

    }

    //-- Sort Smaple

    private static void SortSample()
    {
        XElement root = XElement.Load("Data.xml");
        IEnumerable<decimal> prices =
            from el in root.Elements("Data")
            let price = (decimal)el.Element("Price")
            orderby price
            select price;
        foreach (decimal el in prices)
            Console.WriteLine(el);
    }

    //-- Find an Element with a Specific Child 
    private static void FindElementwithSpecificChild()
    {
        XElement root = XElement.Load("data.xml");
        IEnumerable<XElement> tests =
            from el in root.Elements("Data")
            where (int)el.Element("Quantity") > 3
            select el;
        foreach (XElement el in tests)
            Console.WriteLine((string)el.Attribute("TestId");
    }
} 
```

}

[http://msdn.microsoft.com/en-us/library/bb387053.aspx](http://msdn.microsoft.com/en-us/library/bb387053.aspx)

7.25--> A 3 24.50 B 1 89.99 A 5 4.95 A 3 66.00 B 10 .99 A 15 29.00 B 8 6.99

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2011-02-01T17:47:30.857

```
static void Main(string[] args)
    {

        //XmlDocument doc = new XmlDocument();
        //XmlElement newBook=doc.CreateElement("BookParticipant");
        //newBook.SetAttribute("Author");

        //Using Functional Construction to Create an XML Schema
        XElement xBookParticipant = new XElement("BookParticipant",
                                        new XElement("FirstName", "Joe"),
                                        new XElement("LastName", "Rattz"));
        Console.WriteLine(xBookParticipant.ToString());

        //Creates the Same XML Tree as Listing 6-1 but with Far Less Code
        XElement xBookParticipants = new XElement("BookParticipants",
                                        new XElement("BookParticipant",
                                        new XAttribute("type", "Author"),
                                        new XElement("FirstName", "Joe"),
                                        new XElement("LastName", "Rattz")),
                                        new XElement("BookParticipant",
                                        new XAttribute("type", "Editor"),
                                        new XElement("FirstName", "Ewan"),
                                        new XElement("LastName", "Buckingham")));
        Console.WriteLine(xBookParticipants.ToString());

        //-- Disadvatages of XML document
        //System.Xml.XmlElement xmlBookParticipant = new System.Xml.XmlElement("BookParticipant");
        XElement xeBookParticipant = new XElement("BookParticipant");

        XDocument xDocument = new XDocument(new XElement("BookParticipants",
                                            new XElement("BookParticipant",
                                            new XAttribute("type", "Author"),
                                            new XElement("FirstName", "Joe"),
                                            new XElement("LastName", "Rattz"))));
        Console.WriteLine(xDocument.ToString());

        //--Calling the ToString Method on an Element Produces the XML Tree
        XElement name = new XElement("Name", "Joe");
        Console.WriteLine(name.ToString());

        //--Console.WriteLine Implicitly Calling the ToString Method on an Element to Produce an XML Tree

        XElement name1 = new XElement("Person",
                                      new XElement("FirstName", "Joe"),
                                      new XElement("LastName", "Rattz"));
        Console.WriteLine(name1);

        //-- Casting an Element to Its Value’s Data Type Outputs the Value
        Console.WriteLine(name);
        Console.WriteLine((string)name);

        //--Different Node Value Types Retrieved via Casting to the Node Value’s Type
        XElement count = new XElement("Count", 12);
        Console.WriteLine(count);
        Console.WriteLine((int)count);

        XElement smoker = new XElement("Smoker", false);
        Console.WriteLine(smoker);
        Console.WriteLine((bool)smoker);

        XElement pi = new XElement("Pi", 3.1415926535);
        Console.WriteLine(pi);
        Console.WriteLine((double)pi);

        DeferredQryProblem();

        GenerateXMlFromLinqQry();

    }

    private static void DeferredQryProblem()
    {
        XDocument xDocument = new XDocument(
                    new XElement("BookParticipants",
                    new XElement("BookParticipant",
                    new XAttribute("type", "Author"),
                    new XElement("FirstName", "Joe"),
                    new XElement("LastName", "Rattz")),
                    new XElement("BookParticipant",
                    new XAttribute("type", "Editor"),
                    new XElement("FirstName", "Ewan"),
                    new XElement("LastName", "Buckingham"))));
        IEnumerable<XElement> elements =
        xDocument.Element("BookParticipants").Elements("BookParticipant");
        foreach (XElement element in elements)
        {
            Console.WriteLine("Source element: {0} : value = {1}",
            element.Name, element.Value);
        }
        foreach (XElement element in elements)
        {
            Console.WriteLine("Removing {0} = {1} ...", element.Name, element.Value);
            element.Remove();
        }
        Console.WriteLine(xDocument);

        foreach (XElement element in elements)
        {
            Console.WriteLine("Source element: {0} : value = {1}",
            element.Name, element.Value);
        }
        foreach (XElement element in elements.ToArray())
        {
            Console.WriteLine("Removing {0} = {1} ...", element.Name, element.Value);
            element.Remove();
        }
        Console.WriteLine(xDocument);
    }

    //-- Creating an Attribute and Adding It to Its Element
    private static void CreatingAttribute()
    {
        XElement xBookParticipant = new XElement("BookParticipant", new XAttribute("type", "Author"));
        Console.WriteLine(xBookParticipant);
    }

    //--Creating a Comment with Functional Construction
    private static void CreatingComment()
    {
        XElement xBookParticipant = new XElement("BookParticipant",
                                                  new XComment("This person is retired."));
        Console.WriteLine(xBookParticipant);
    }

    //--Creating a Declaration with Functional Construction
    private static void CreateXmlDeclaration()
    {
        XDocument xDocument = new XDocument(new XDeclaration("1.0", "UTF-8", "yes"),
new XElement("BookParticipant"));
        Console.WriteLine(xDocument);
    }

    private static void GenerateXMlFromLinqQry()
    {
        BookParticipant[] bookParticipants = new[] {new BookParticipant {FirstName = "Joe", LastName = "Rattz",
                                                    ParticipantType = ParticipantTypes.Author},
                                                    new BookParticipant {FirstName = "Ewan", LastName = "Buckingham",
                                                    ParticipantType = ParticipantTypes.Editor}
                                                    };
        XElement xBookParticipants =
        new XElement("BookParticipants",
                     bookParticipants.Select(p =>
                new XElement("BookParticipant",
                new XAttribute("type", p.ParticipantType),
                new XElement("FirstName", p.FirstName),
                new XElement("LastName", p.LastName))));

        Console.WriteLine(xBookParticipants);
    }

    //-- Obtaining Elements Without Reaching
    private static void WithoutReaching()
    {
        XDocument xDocument = new XDocument(new XElement("BookParticipants",
                                            new XElement("BookParticipant",
                                            new XAttribute("type", "Author"),
                                            new XElement("FirstName", "Joe"),
                                            new XElement("LastName", "Rattz")),
                                            new XElement("BookParticipant",
                                            new XAttribute("type", "Editor"),
                                            new XElement("FirstName", "Ewan"),
                                            new XElement("LastName", "Buckingham"))));
        IEnumerable<XElement> elements = xDocument.Descendants("BookParticipant");
        foreach (XElement element in elements)
        {
            Console.WriteLine("Element: {0} : value = {1}",
            element.Name, element.Value);
        }

        IEnumerable<XElement> elements1 = xDocument.Descendants("BookParticipant")
                                                   .Where(e => ((string)e.Element("FirstName")) == "Ewan");
        foreach (XElement element1 in elements1)
        {
            Console.WriteLine("Element: {0} : value = {1}",
            element1.Name, element1.Value);
        }

    } 
```

* * *

## 回答 #6

> 赞同：-2
> 
> 时间：2010-05-17T07:02:49.483

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Web;
using System.Web.UI;
using System.Web.UI.WebControls;
using System.Xml.Linq;

namespace LinqToXmlTest
{
public partial class _Default : System.Web.UI.Page
{
    protected void Page_Load(object sender, EventArgs e)
    {

    }
    protected void ReadXml()
    {
        XDocument xdocument = XDocument.Load(Server.MapPath("People.xml"));
        var persons = from person in xdocument.Descendants("Person")
                      select new
                      {
                          Name = person.Element("Name").Value,
                          City = person.Element("City").Value,
                          Age = person.Element("Age").Value
                      };
        litResults.Text = "";
        foreach (var person in persons)
        {
            litResults.Text = litResults.Text + "Name: " + person.Name + "<br/>";
            litResults.Text = litResults.Text + "City: " + person.City + "<br/>";
            litResults.Text = litResults.Text + "Age: " + person.Age + "<br/><br/>";
        }
        if (litResults.Text == "")
            litResults.Text = "No Results...";
    }

    protected void butAdd_Click(object sender, EventArgs e)
    {
        try
        {
            if (txtName.Text == "" || txtCity.Text == "" || txtAge.Text == "")
            {
                lblStatus.ForeColor = System.Drawing.Color.Red;
                lblStatus.Text = "Please Complete the form";
            }
            else
            {
                XDocument xdocumnet = XDocument.Load(Server.MapPath("People.xml"));
                xdocumnet.Element("Persons").Add(new XElement("Person",
                    new XElement("Name", txtName.Text),
                    new XElement("City", txtCity.Text),
                    new XElement("Age", txtAge.Text)));
                xdocumnet.Save(Server.MapPath("People.xml"));
                lblStatus.ForeColor = System.Drawing.Color.Green;
                lblStatus.Text = "Data Successfully loaded to xml file";
                txtName.Text = "";
                txtCity.Text = "";
                txtAge.Text = "";
                ReadXml();
            }
        }
        catch
        {
            lblStatus.ForeColor = System.Drawing.Color.Red;
            lblStatus.Text = "Sorry unable to precess request.Please try again";
        }

    }

    protected void butRead_Click(object sender, EventArgs e)
    {
        ReadXml();
        lblStatus.Text = "";
    }

    protected void btnUpdate_Click(object sender, EventArgs e)
    {
        try
        {
            if (txtName.Text == "" || txtCity.Text == "" || txtAge.Text == "")
            {
                lblStatus.ForeColor = System.Drawing.Color.Red;
                lblStatus.Text = "Please enter all details in the form";
            }
            else
            {
                XDocument xdocument = XDocument.Load(Server.MapPath("People.xml"));
                var persondata = (from person in xdocument.Descendants("Person")
                                  where person.Element("Name").Value.Equals(txtName.Text)
                                  select person).Single();

                persondata.Element("City").Value = txtCity.Text;
                persondata.Element("Age").Value = txtAge.Text;

                xdocument.Save(Server.MapPath("People.xml"));
                lblStatus.ForeColor = System.Drawing.Color.Green;
                lblStatus.Text = "The data updated successfully";
                ReadXml();
            }
        }
        catch(Exception ex)
        {
            lblStatus.ForeColor = System.Drawing.Color.Red;
            lblStatus.Text = ex.Message;
        }
    }

    protected void btnDelete_Click(object sender, EventArgs e)
    {
        try
        {
            if (txtName.Text == "")
            {
                lblStatus.ForeColor = System.Drawing.Color.Red;
                lblStatus.Text = "Please enter the name of the person to delete...";                    
            }
            else
            {
                XDocument xdocument = XDocument.Load(Server.MapPath("People.xml"));
                var persondata = (from person in xdocument.Descendants("Person")
                                  where person.Element("Name").Value.Equals(txtName.Text)
                                  select person).Single();

                persondata.Remove();
                xdocument.Save(Server.MapPath("People.xml"));
                lblStatus.ForeColor = System.Drawing.Color.Green;
                lblStatus.Text = "The data deleted successfully...";
                txtName.Text = "";
                txtCity.Text = "";
                txtAge.Text = "";
                ReadXml();
            }
        }
        catch (Exception ex)
        {
            lblStatus.ForeColor = System.Drawing.Color.Red;
            lblStatus.Text = ex.Message;
        }
    }
}
} 
```

# excel - Excel 中的 SQL-WHERE TYPE 公式

> ID：331505
> 
> 赞同：1
> 
> 时间：2008-12-01T17:14:05.193
> 
> 标签：excel, vba

假设我有一张包含 Customer 和 CreatedDate 列的表格，其中包含大量数据行。任何知道如何设置（通过 VBA 或公式）第二张表的人，该表根据某些 where 语句显示第一张表中的行，即客户“本月创建”的所有行。（类似于针对 SQL 数据库的 select ... where 查询）。

谢谢！/尼尔斯

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-01T17:28:57.517

您可以创建主数据表的副本（通过复制表，或使用`=Sheet1!A1`横向和向下填充的类型公式），然后使用自动过滤器将其缩小到您需要的行。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-01T17:47:47.870

这是一个使用 ADO 的示例。

```
Dim cn As Object
Dim rs As Object

strFile = Workbooks(1).FullName
strCon = "Provider=Microsoft.Jet.OLEDB.4.0;Data Source=" & strFile _
    & ";Extended Properties=""Excel 8.0;HDR=Yes;IMEX=1"";"

Set cn = CreateObject("ADODB.Connection")
Set rs = CreateObject("ADODB.Recordset")

cn.Open strCon

strSQL = "SELECT * FROM [Sheet1$] WHERE CourseKey=484"

rs.Open strSQL, cn

Worksheets(2).Cells(2, 1).CopyFromRecordset rs 
```

更多信息： http: [//support.microsoft.com/kb/246335](http://support.microsoft.com/kb/246335)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-01T17:21:54.897

您可以从数据中创建数据透视表，然后以多种方式对其进行切片。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-01T17:24:08.447

Excel中没有与 SQL 功能完全等效的`select ... where`功能，但请查看该`VLOOKUP`功能。这可能是您正在寻找的东西。如果这没有足够的功能，您可能必须使用 VBA：

```
 Dim DataRange as Range
Dim RowNum as Integer
Dim NewRow as Integer
Dim TestMonth as Integer
Dim ThisMonth as Integer

Set DataRange = Range(Sheet1.Cells(1,1), Sheet1.Cells(100,2))

ThisMonth = Application.WorksheetFunction.Month(Application.WorksheetFunction.Today())

NewRow = 1
For RowNum from 1 to DataRange.Rows.Count
    TestMonth = Application.WorksheetFunction.Month(DataRange.Cells(RowNum, 1).Value)
    if TestMonth = ThisMonth Then
        Sheet2.Cells(NewRow, 1).Value = DataRange.Cells(RowNum, 2).Value
        NewRow = NewRow + 1
    End If
Next RowNum
```

# architecture - 命名空间组织 - AOP 验证器

> ID：331510
> 
> 赞同：1
> 
> 时间：2008-12-01T17:14:47.250
> 
> 标签：architecture, aop, cross-cutting-concerns

我已经开始在我们的开发框架中使用方面进行参数验证。它工作得很好，而且我喜欢不用验证代码乱扔公共方法的前半部分。

我想知道是否有人对您将在命名空间结构中放置参数验证的位置有任何建议？我的一部分认为，既然它是顶级功能，它应该在顶级产品命名空间中——很像 System 在 .NET Framework 中的使用方式。我只是担心核心程序集会随着更多这样的功能而膨胀，因为它会进一步发展。

就目前而言，我将它们放在以下位置：

[公司].[产品].ParameterValidators

在此示例中，ParameterValidators 是包含该功能的类（方面）的名称。

除此之外，如果有人对将方面合并到现有代码库中与结构布局相关的进一步建议，我将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-01T19:20:57.543

现在您正在考虑使用技术标准进行分区，即“将所有验证器放在一个命名空间中，因为它们是验证器”。这没有考虑验证器*存在*的原因。

我的建议是按功能分区：

1.  通用验证器（例如 nullity 和范围检查）进入通用命名空间。

2.  更具体的验证器（例如 CustomerValidators）进入更具体的命名空间。

一般的想法是，您没有 1 个包含所有可能的验证器的类，您有几个类（在不同的命名空间中），每个类都声明*出于特定原因的*验证。

# c# - 如何修复“引用的程序集没有强名称”错误

> ID：331520
> 
> 赞同：262
> 
> 时间：2008-12-01T17:16:54.703
> 
> 标签：c#, visual-studio, visual-studio-2005, assemblies, strongname

我在我的[Visual Studio 2005](http://en.wikipedia.org/wiki/Microsoft_Visual_Studio#Visual_Studio_2005)项目（它是强命名的）中添加了一个弱命名的程序集。我现在收到错误：

> “引用的程序集 'xxxxxxxx' 没有强名称”

我需要签署这个第三方程序集吗？

* * *

## 回答 #1

> 赞同：226
> 
> 时间：2008-12-01T17:26:23.623

为避免此错误，您可以：

*   动态加载程序集，或
*   签署第三方程序集。

您将在 .NET-fu 中找到有关签署第三方程序集的说明*[：签署未签名的程序集（无延迟签名）](https://dzone.com/articles/net-fu-zero-delay-signing-of-a)*。

### 签署第三方程序集

签署 thirp-party 的基本原则是

1.  `ildasm.exe`使用并保存中间语言 (IL)反汇编程序集：

    ```
    ildasm /all /out=thirdPartyLib.il thirdPartyLib.dll 
    ```

2.  重建并签署程序集：

    ```
    ilasm /dll /key=myKey.snk thirdPartyLib.il 
    ```

### 修复其他参考

除非您的第三方程序集 ( *A.dll* ) 引用另一个也必须签名的库 ( *B.dll )，否则上述步骤工作正常。*您可以使用上述命令对*A.dll*和*B.dll*进行反汇编、重建和签名，但在运行时，加载*B.dll*将失败，因为*A.dll*最初是使用对*未签名*版本的*B.dll*的引用构建的。

解决此问题的方法是修补上述步骤 1 中生成的 IL 文件。您需要将 B.dll 的公钥标记添加到引用中。您通过调用获得此令牌

```
sn -Tp B.dll 
```

这将为您提供以下输出：

```
Microsoft (R) .NET Framework Strong Name Utility  Version 4.0.30319.33440
Copyright (c) Microsoft Corporation.  All rights reserved.

Public key (hash algorithm: sha1):
002400000480000094000000060200000024000052534131000400000100010093d86f6656eed3
b62780466e6ba30fd15d69a3918e4bbd75d3e9ca8baa5641955c86251ce1e5a83857c7f49288eb
4a0093b20aa9c7faae5184770108d9515905ddd82222514921fa81fff2ea565ae0e98cf66d3758
cb8b22c8efd729821518a76427b7ca1c979caa2d78404da3d44592badc194d05bfdd29b9b8120c
78effe92

Public key token is a8a7ed7203d87bc9 
```

最后一行包含公钥令牌。*然后，您必须在A.dll*的 IL 中搜索对*B.dll*的引用并添加令牌，如下所示：

```
.assembly extern /*23000003*/ MyAssemblyName
{
  .publickeytoken = (A8 A7 ED 72 03 D8 7B C9 )                         
  .ver 10:0:0:0
} 
```

* * *

## 回答 #2

> 赞同：104
> 
> 时间：2012-07-10T07:27:54.573

展开使用没有“强名称密钥”的项目的项目文件*并*查找`.snk`文件 (.StrongNameKey)。

[在Windows 资源管理器](http://en.wikipedia.org/wiki/Windows_Explorer)中浏览到该文件（以便您知道它在哪里）。

回到没有“具有强名称键”的项目中的 Visual Studio，执行

*   右键单击项目文件
*   选择属性
*   选择“签名选项卡”（在左侧）
*   单击复选框“签署程序集”
*   然后`<Browse>`到`.snk`你之前找到的文件

这应该够了吧。这解决了我在一个项目中使用同一解决方案中另一个项目中的表单的问题。

我希望它有所帮助。

* * *

## 回答 #3

> 赞同：66
> 
> 时间：2014-01-08T18:13:00.610

我正在寻找解决同样问题的方法，取消勾选“签署程序集”选项对我有用：

![在此处输入图像描述](https://i.stack.imgur.com/EJWvm.jpg)

*（您可能会注意到，屏幕截图来自 Visual Studio 2010，但希望它对某人有所帮助。）*

* * *

## 回答 #4

> 赞同：56
> 
> 时间：2013-10-18T21:52:11.473

我编写了一个工具来自动对程序集进行强名称签名，包括您没有源代码的程序集或已放弃的项目。它以简单的方式使用答案中描述的许多技术，没有现有工具或过时说明的任何缺陷或缺点。

*[.NET 程序集强名称签名者](http://brutaldev.com/post/2013/10/18/NET-Assembly-Strong-Name-Signer)*

我希望这可以帮助任何需要签署第三方程序集的人，而不必跳过铁环到达那里。

* * *

## 回答 #5

> 赞同：43
> 
> 时间：2012-06-02T16:04:34.943

如果您的程序集也未签名，则可以使用未签名的程序集。

* * *

## 回答 #6

> 赞同：30
> 
> 时间：2014-06-09T21:58:15.393

签署第三方程序集对我有用：

*[引用的程序集没有强名称](http://www.codeproject.com/Tips/341645/Referenced-assembly-does-not-have-a-strong-name)*

我了解到，如果链接的文章不再有效，发布步骤会很有帮助。所有功劳归功于[Hiren Khirsaria](http://www.codeproject.com/script/Membership/View.aspx?mid=5525949)：

1.  运行 Visual Studio 命令提示符并转到 DLL 所在的目录。

    `For example, my DLL is located in` **`D:/hiren/Test.dll`**

2.  现在使用以下命令创建[CIL文件。](https://en.wikipedia.org/wiki/Common_Intermediate_Language)

    `D:/hiren> ildasm /all /out=Test.il Test.dll` *（此命令生成代码库）*

3.  生成一个新密钥来签署您的项目。

    `D:/hiren> sn -k mykey.snk`

4.  `ilasm`现在使用该命令对您的库进行签名。

    `D:/hiren> ilasm /dll /key=mykey.snk Test.il`

* * *

## 回答 #7

> 赞同：15
> 
> 时间：2015-05-10T11:35:20.457

# [如何签署未签名的第三方程序集](http://devillers.nl/strong-naming-third-party-assemblies/)

1.  打开 Visual Studio 的开发人员命令提示符。此工具在您的 Window 程序中可用，并且可以使用默认的 Windows 搜索找到。
2.  通过执行一次确保您的提示可以访问以下工具：`sn` `ildasm`和`ilasm`
3.  导航到 Cool.Library.dll 所在的文件夹
4.  `sn –k Cool.Library.snk`创建一个新的密钥对
5.  `ildasm Cool.Library.dll /out:Cool.Library.il`拆卸库
6.  `move Cool.Library.dll Cool.Library.unsigned.dll`保留原始库作为备份
7.  `ilasm Cool.Library.il /dll /resource=Cool.Library.res /key=Cool.Library.snk`用强名称重新组装库
8.  `powershell -command "& {[System.Reflection.AssemblyName]::GetAssemblyName($args).FullName} Cool.Library.dll"`获取程序集的完全限定名称。如果您必须在 web.config 或 app.config 等外部配置文件中引用 DLL，您将需要此位。

* * *

## 回答 #8

> 赞同：8
> 
> 时间：2020-11-22T22:46:06.400

对我来说，问题在于没有强名称的 NuGet 包。解决方案是从 NuGet 安装[StrongNamer](https://www.nuget.org/packages/strongnamer)，它会自动将强名称添加到所有引用的程序集。只是简单地在项目中引用它就解决了我的问题。

* * *

## 回答 #9

> 赞同：7
> 
> 时间：2017-03-03T15:55:32.133

我使用 NuGet 安装的 ServiceStack DLL 文件遇到了这个问题。原来还有另一组标记为已签名的 DLL 文件可用。不会是每个人的答案，但您可能只需要检查您的程序集的现有签名版本。

[![ServiceStack.Signed](https://i.stack.imgur.com/4J4lg.png)](https://i.stack.imgur.com/4J4lg.png)

* * *

## 回答 #10

> 赞同：6
> 
> 时间：2013-10-16T23:47:12.367

对于一个强命名的应用程序，我遇到了这个问题，然后必须更改它以引用非强命名程序集，所以我在项目属性签名部分取消选中“签署程序集”，但它**仍然**抱怨。我认为它必须是导致问题的某个地方的人工制品，因为我正确地完成了其他所有操作，仅此而已。我从它的 assemblyInfo.cs 文件中找到并删除了这一行： [assembly: AssemblyKeyFile("yourkeyfilename.snk")] 。然后没有构建投诉之后。

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2017-10-08T12:23:07.890

使用 ilmerge。ilmerge 来自 Microsoft，但它没有随 Visual Studio 或 SDK 一起提供。你可以从[这里](https://www.microsoft.com/en-us/download/details.aspx?id=17630)下载它。还有一个[GitHub](https://github.com/Microsoft/ILMerge)存储库。您也可以从 NuGet 安装：

```
PM> Install-Package ilmerge 
```

要使用：

```
ilmerge assembly.dll /keyfile:key.snk /out:assembly.dll /targetplatform:v4,C:\Windows\Microsoft.NET\Framework\v4.0.30319 /ndebug 
```

`sn`如果需要，您可以使用（来自 Visual Studio）生成自己的密钥文件：

```
sn -k key.snk 
```

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2015-09-02T16:03:50.430

对我来说，我的问题是我安装了两个不同版本的相同 NuGet 包。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2015-03-11T15:43:25.963

正如@Michal Stefanow 所说，删除“签名”选项卡下*的“签署**程序集”*复选标记。

 *在此处添加是对您自己的文件和/或其他人的文件进行签名的最简单方法。您只需在“构建后事件命令行”下添加此行：

```
"C:\Program Files (x86)\Microsoft SDKs\Windows\v7.0A\bin\signtool.exe" sign /f "$(ProjectDir)\YourPfxFileNameHere.pfx" /p YourPfxFilePasswordHere /d "Your software title here" /du http://www.yourWebsiteHere.com /t http://timestamp.verisign.com/scripts/timstamp.dll /v "$(BaseOutputPath)$(TargetFileName)" 
```

您可以签署其他人的文件或您自己的文件，并且可以根据需要签署任意数量的文件。

![在此处输入图像描述](https://i.stack.imgur.com/NrOpv.jpg)

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2018-12-13T08:07:40.133

情况：您在解决方案 X、Y 中有项目 A、B、C、D

X 中的项目 A、B、C Y 中的项目 A、C、D

我需要在项目A中使用项目C，但后来我不使用了。在 bin Debug 项目 A 中有 C.dll。

如果我编译解决方案 X，一切都很好（在这个解决方案中，我删除了参考 A -> C.），但在解决方案中，我遇到了这个问题。

解决方案是删除项目A bin Debug中的C.dll

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2019-11-15T13:19:34.223

首先确保解决方案中所有项目的所有 NuGet 包的版本相同。例如，您不希望一个项目引用 NLog 4.0.0.0 而另一个项目引用 NLog 4.1.0.0。然后尝试重新安装 NuGet 包

```
Update-Package -reinstall 
```

我的程序集 A 引用了三个第三方程序集，而我的程序集 B 也引用了 A 的引用中只包含了两个。

缺少对第三方程序集的引用是由 update package 命令添加的，并且错误消失了。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2021-04-26T03:29:47.307

我添加了 NuGet 包“StrongNamer”，我的问题解决了。

# sharepoint - 如何打开从一个 Web 应用程序到另一个已经过身份验证的链接？

> ID：331535
> 
> 赞同：1
> 
> 时间：2008-12-01T17:20:48.877
> 
> 标签：sharepoint, authentication, single-sign-on

我们有一个从不同来源收集信息的 Web 应用程序（sharepoint）。我们希望能够将用户链接到这些不同来源的主要网站并对其进行预认证。IE 他们输入其他来源的凭据（这些来源有许多不同类型的 LDAP、AD 和自制！），我们为他们检索一些信息，并记住那里的详细信息（可能单点登录以保持他们的良好和安全） . 然后，用户可以单击一个链接，该链接将在另一个已经过身份验证的窗口中打开完整的应用程序。

这甚至可能吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-26T17:23:02.833

Office Server 具有单点登录 api 作为内置功能。你可能想调查一下。它使您能够安全地注册用户凭据，并在运行时访问它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-01T18:41:12.600

您需要充当 Web 浏览器，以在本地存储凭据（通常在 cookie 中）对不同的站点进行操作。因此，请使用具有 cookie 支持的适当客户端库。这可能适用于大多数网站。有些网站使用 HTTP 身份验证，也更容易从适当的客户端库访问。最苛刻的可能是访问 SSL 网站，但同样，现在大多数客户端 HTTP 库也涵盖了这一点。

您现在所需要的只是准备您的 Web 应用程序以充当所有这些单独 Web 资源的代理。这在 Sharepoint 中究竟是如何完成的，嗯，我希望其他人会回答这个问题......

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-01T19:43:50.927

真正[的单点登录](http://en.wikipedia.org/wiki/Single_sign-on)是一项艰巨的任务。Wikipedia 描述了一些 SSO 项目的常用方法和链接。

如果您想要更轻的东西，我过去使用过这种方法：

*   创建一个表以将临时安全令牌存储在所有应用程序都可以访问的位置。
*   从源应用程序（在您的情况下为 Sharepoint），应外部应用程序的请求，在令牌表中保存一个安全令牌（可能是一个 guid、紧过期和用户 ID）。
*   重定向到目标应用程序中的请求代理页面/处理程序。在请求中包含请求的最终页面和 guid。
*   在代理中，查找安全令牌。如果它存在并且尚未过期，则进行身份验证、授权并在一切正常的情况下重定向到最终页面。如果没有，请发送权限错误。

安全方面，指南应该几乎不可能被猜到。你可以通过让代币很快过期来降低风险——打电话给经纪人应该不会超过几秒钟。

如果目标应用程序使用 Windows 身份验证并且没有基于角色的逻辑，则您不必做太多事情。只需重定向并让您的 File/UrlAuthorization 处理它。如果需要，您可以使用安全令牌 db 处理基于角色的权限。

# c++ - Windows 线程：_beginthread vs _beginthreadex vs CreateThread C++

> ID：331536
> 
> 赞同：135
> 
> 时间：2008-12-01T17:20:57.130
> 
> 标签：c++, c, multithreading, winapi

什么是启动线程的更好方法`_beginthread`，`_beginthreadx`或`CreateThread`？

我试图确定 和 的优点/缺点是`_beginthread`什么。所有这些函数都返回一个新创建线程的线程句柄，我已经知道 CreateThread 在发生错误时提供了一些额外的信息（可以通过调用来检查）......但是当我' m 使用这些功能？`_beginthreadex``CreateThread``GetLastError`

我正在使用 Windows 应用程序，因此跨平台兼容性已经不可能了。

我浏览了 msdn 文档，但我无法理解，例如，为什么有人会决定使用 _beginthread 而不是 CreateThread，反之亦然。

干杯!

更新：好的，感谢您提供的所有信息，我还阅读了一些`WaitForSingleObject()`如果我使用过就无法调用的地方`_beginthread()`，但是如果我`_endthread()`在线程中调用，那不应该吗？那里有什么交易？

* * *

## 回答 #1

> 赞同：99
> 
> 时间：2008-12-01T17:29:57.843

`CreateThread()`是用于在内核级别创建另一个控制线程的原始 Win32 API 调用。

`_beginthread()`&是在幕后`_beginthreadex()`调用的 C 运行时库调用。`CreateThread()`一旦`CreateThread()`返回，`_beginthread/ex()`负责额外的簿记以使 C 运行时库在新线程中可用且一致。

在 C++ 中，您几乎肯定应该使用`_beginthreadex()`，除非您根本不会链接到 C 运行时库（又名 MSVCRT*.dll/.lib）。

* * *

## 回答 #2

> 赞同：39
> 
> 时间：2008-12-01T18:35:57.290

`_beginthread()`和之间有几个区别`_beginthreadex()`。 `_beginthreadex()`被做得更像`CreateThread()`（在参数和行为方式上）。

正如[Drew Hall](https://stackoverflow.com/questions/331536/windows-threading-beginthread-vs-beginthreadex-vs-createthread-c#331567)所提到的，如果您使用的是 C/C++ 运行时，则必须使用`_beginthread()`/`_beginthreadex()`而不是，`CreateThread()`以便运行时有机会执行它自己的线程初始化（设置线程本地存储等）。

实际上，这意味着`CreateThread()`您的代码几乎不应该直接使用它。

`_beginthread()`/的 MSDN 文档`_beginthreadex()`有很多关于差异的详细信息 - 其中一个更重要的是，由于`_beginthread()`线程退出时 CRT 会自动关闭由创建的线程的线程句柄，“如果由 _beginthread 生成的线程退出很快，返回给 _beginthread 调用者的句柄可能是无效的，或者更糟糕的是，指向另一个线程”。

以下是`_beginthreadex()`CRT 源代码中的评论必须说的：

```
Differences between _beginthread/_endthread and the "ex" versions:

1)  _beginthreadex takes the 3 extra parameters to CreateThread
  which are lacking in _beginthread():
    A) security descriptor for the new thread
    B) initial thread state (running/asleep)
    C) pointer to return ID of newly created thread

2)  The routine passed to _beginthread() must be __cdecl and has
  no return code, but the routine passed to _beginthreadex()
  must be __stdcall and returns a thread exit code.  _endthread
  likewise takes no parameter and calls ExitThread() with a
  parameter of zero, but _endthreadex() takes a parameter as
  thread exit code.

3)  _endthread implicitly closes the handle to the thread, but
  _endthreadex does not!

4)  _beginthread returns -1 for failure, _beginthreadex returns
  0 for failure (just like CreateThread). 
```

**2013 年 1 月**更新：****

 **VS 2012 的 CRT 在以下位置执行了额外的初始化`_beginthreadex()`：如果进程是“打包的应用程序”（如果从中返回有用的东西`GetCurrentPackageId()`），运行时将在新创建的线程上初始化 MTA。

* * *

## 回答 #3

> 赞同：25
> 
> 时间：2012-10-19T00:01:15.393

一般来说，正确的做法是调用`_beginthread()/_endthread()`（或`ex()`变体）。但是，如果您将 CRT 用作 .dll，则 CRT 状态将被正确初始化和销毁​​，因为 CRT`DllMain`将分别在调用`DLL_THREAD_ATTACH`和/或返回时被调用。`DLL_THREAD_DETACH``CreateThread()``ExitThread()`

CRT的`DllMain`代码可以在 VC\crt\src\crtlib.c 下的 VS 安装目录中找到。

* * *

## 回答 #4

> 赞同：17
> 
> 时间：2008-12-01T18:33:16.017

这是`_beginthreadex`（参见 参考资料`crt\src\threadex.c`）的核心代码：

```
 /*
     * Create the new thread using the parameters supplied by the caller.
     */
    if ( (thdl = (uintptr_t)
          CreateThread( (LPSECURITY_ATTRIBUTES)security,
                        stacksize,
                        _threadstartex,
                        (LPVOID)ptd,
                        createflag,
                        (LPDWORD)thrdaddr))
         == (uintptr_t)0 )
    {
            err = GetLastError();
            goto error_return;
    } 
```

其余部分`_beginthreadex`为 CRT 初始化每个线程的数据结构。

使用的优点`_beginthread*`是您从线程调用的 CRT 将正常工作。

* * *

## 回答 #5

> 赞同：14
> 
> 时间：2011-04-12T11:44:32.263

您应该使用`_beginthread`或`_beginthreadex`允许 C 运行时库自己初始化线程。只有 C/C++ 程序员需要知道这一点，因为他们现在应该知道使用自己的开发环境的规则。

如果您使用`_beginthread`，则不需要调用`CloseHandle`，因为 RTL 会为您做。这就是为什么如果您使用过`_beginthread`. 如果`_beginthread`线程函数立即（快速）退出，也会导致混乱，因为启动线程可能会持有对它刚刚启动的线程的无效线程句柄。

`_beginthreadex`句柄可用于等待，但也需要显式调用`CloseHandle`. 这是使它们可以安全使用等待的部分原因。使其完全万无一失的另一个问题是始终启动暂停的线程。检查成功，记录句柄等。恢复线程。这是为了防止线程在启动线程可以记录其句柄之前终止。

最好的做法是使用`_beginthreadex`，记录句柄后开始暂停然后恢复，等待句柄是可以的，`CloseHandle`必须调用。

* * *

## 回答 #6

> 赞同：9
> 
> 时间：2008-12-01T18:21:10.440

[`CreateThread()`](http://www.microsoft.com/msj/0799/win32/win320799.aspx)当您在代码中使用任何 CRT 函数时[，曾经有内存泄漏。](http://www.microsoft.com/msj/0799/win32/win320799.aspx)`_beginthreadex()`具有与 相同`CreateThread()`的参数，并且比`_beginthread()`. 所以我推荐你使用`_beginthreadex()`.

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2008-12-01T19:35:30.600

关于您更新的问题：“我还阅读了几个`WaitForSingleObject()`如果我使用过就无法调用的地方`_beginthread()`，但是如果我`_endthread()`在线程中调用，那不应该工作吗？”

通常，您可以将线程句柄`WaitForSingleObject()`（或等待对象句柄的其他 API）传递给阻塞，直到线程完成。但是由创建的线程句柄在被调用`_beginthread()`时关闭`_endthread()`（这可以显式完成，也可以在线程过程返回时由运行时隐式完成）。

该问题在以下文档中被指出`WaitForSingleObject()`：

> 如果在等待仍处于挂起状态时关闭此句柄，则函数的行为未定义。

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2011-06-02T20:44:48.103

查看函数签名，`CreateThread`几乎与`_beginthreadex`.

[`_beginthread`,`_beginthreadx`](http://msdn.microsoft.com/en-us/library/kdzttdcb(VS.80).aspx)与[`CreateThread`](http://msdn.microsoft.com/en-us/library/ms682453(VS.85).aspx)

```
HANDLE WINAPI CreateThread(
  __in_opt   LPSECURITY_ATTRIBUTES lpThreadAttributes,
  __in       SIZE_T dwStackSize,
  __in       LPTHREAD_START_ROUTINE lpStartAddress,
  __in_opt   LPVOID lpParameter,
  __in       DWORD dwCreationFlags,
  __out_opt  LPDWORD lpThreadId
);

uintptr_t _beginthread( 
   void( *start_address )( void * ),
   unsigned stack_size,
   void *arglist 
);

uintptr_t _beginthreadex( 
   void *security,
   unsigned stack_size,
   unsigned ( *start_address )( void * ),
   void *arglist,
   unsigned initflag,
   unsigned *thrdaddr 
); 
```

[这里](http://msdn.microsoft.com/en-us/library/kdzttdcb(VS.80).aspx)的注释说`_beginthread`可以使用`__cdecl`或者`__clrcall`调用约定作为起点，并且`_beginthreadex`可以使用或者`__stdcall`或者`__clrcall`作为起点。

我认为人们对内存泄漏的任何评论`CreateThread`都已有十多年的历史，可能应该被忽略。

有趣的是，这两个`_beginthread*`函数实际上都`CreateThread`在`C:\Program Files (x86)\Microsoft Visual Studio 10.0\VC\crt\src`我的机器上调用。

```
// From ~line 180 of beginthreadex.c
/*
 * Create the new thread using the parameters supplied by the caller.
 */
if ( (thdl = (uintptr_t)
      CreateThread( (LPSECURITY_ATTRIBUTES)security,
                    stacksize,
                    _threadstartex,
                    (LPVOID)ptd,
                    createflag,
                    (LPDWORD)thrdaddr))
         == (uintptr_t)0 )
{
        err = GetLastError();
        goto error_return;
} 
```

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2008-12-01T18:32:58.450

`beginthreadex`给你一个线程`HANDLE`供`WaitForSingleObject`朋友们使用。`beginthread`没有。完成后不要忘记`CloseHandle()`。真正的答案是使用`boost::thread`或很快使用 C++09 的线程类。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2011-09-23T10:17:39.093

与 相比`_beginthread`，`_beginthreadex`您可以：

1.  指定安全属性。
2.  启动处于挂起状态的线程。
3.  您可以获得可以与`OpenThread`.
4.  如果调用成功，则保证返回的线程句柄有效。在那里你需要用 关闭手柄`CloseHandle`。
5.  返回的线程句柄可以与同步 API 一起使用。

与`_beginthreadex`非常相似`CreateThread`，但前者是 CRT 实现，后者是 Windows API 调用。[CreateThread](https://msdn.microsoft.com/en-us/library/windows/desktop/ms682453.aspx)的文档包含以下建议：

> 调用 C 运行时库 (CRT) 的可执行文件中的线程应该使用[**`_beginthreadex`**](http://go.microsoft.com/fwlink/p/?linkid=125829)and[**`_endthreadex`**](http://go.microsoft.com/fwlink/p/?linkid=125830)函数进行线程管理，而不是**`CreateThread`**and [**`ExitThread`**](https://msdn.microsoft.com/en-us/library/windows/desktop/ms682659.aspx)；这需要使用 CRT 的多线程版本。如果使用创建的线程**`CreateThread`**调用 CRT，CRT 可能会在内存不足的情况下终止进程。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2012-05-15T17:50:34.903

`CreateThread()`是语言中立的 Windows API 调用。它只是创建 OS 对象 - 线程并将 HANDLE 返回给该线程。所有 Windows 应用程序都使用此调用来创建线程。所有语言都避免直接调用 API，原因很明显： 1\. 你不希望你的代码是特定于操作系统的 2\. 在调用类似 API 之前你需要做一些内务：转换参数和结果，分配临时存储等。

`_beginthreadex()``CreateThread()`是围绕特定于 C的 C 包装器。它通过分配线程特定的存储，使原始的单线程 C f-ns 在多线程环境中工作。

如果您不使用 CRT，则无法避免直接调用`CreateThread()`. 如果你使用 CRT，你必须使用`_beginthreadex()`VC2005 之前的一些 CRT 字符串 f-ns 可能无法正常工作。

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2012-10-12T12:14:24.183

`CreateThread()`曾经是一个禁忌，因为 CRT 会被错误地初始化/清理。但这现在已成为历史：现在（使用 VS2010 和可能的几个版本）可以`CreateThread()`在不破坏 CRT 的情况下调用。

[这是官方的 MS 确认](http://support.microsoft.com/kb/104641/en-us)。它声明了一个例外：

> 实际上，唯一不应该在创建的线程中使用的函数`CreateThread()`是`signal()`函数。

但是，从一致性的角度来看，我个人更喜欢继续使用`_beginthreadex()`.

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2012-10-18T12:51:02.180

`CreateThread()`是直接的系统调用。它的实现`Kernel32.dll`很可能由于其他原因您的应用程序已经被链接。它在现代 Windows 系统中始终可用。

`_beginthread()`并且`_beginthreadex()`是 Microsoft C 运行时 ( `msvcrt.dll`) 中的包装函数。文档中说明了这两个调用之间的差异。因此，当 Microsoft C 运行时可用时，或者如果您的应用程序与其静态链接时，它就可用。您也可能会链接到该库，除非您使用纯 Windows API 进行编码（就像我个人经常做的那样）。

您的问题是连贯的，实际上是一个反复出现的问题。与许多 API 一样，我们必须处理 Windows API 中的重复和模棱两可的功能。最糟糕的是，文档没有澄清这个问题。我认为`_beginthread()`创建函数系列是为了更好地与其他标准 C 功能集成，例如对`errno`. `_beginthread()`从而更好地与 C 运行时集成。

尽管如此，除非您有充分的理由使用`_beginthread()`or `_beginthreadex()`，否则您应该使用`CreateThread()`，主要是因为您可能会在最终的可执行文件中减少一个库依赖项（对于 MS CRT，这确实很重要）。您也没有围绕调用的包装代码，尽管这种影响可以忽略不计。换句话说，我认为坚持的主要原因`CreateThread()`是没有充分的理由`_beginthreadex()`开始使用。功能完全相同或几乎相同。

使用的一个很好的理由`_beginthread()` *是*（因为它似乎是错误的）如果`_endthread()`被调用，C++ 对象将被正确地展开/销毁。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2014-02-15T20:41:23.367

如果您阅读 Jeffrey Richter 的《调试 Windows 应用程序》一书，他解释说几乎在所有情况下您都必须调用`_beginthreadex`而不是调用`CreateThread`. `_beginthread`只是一个简化的包装器`_beginthreadex`。

`_beginthreadex``CreateThread`初始化API 不会执行的某些 CRT (C RunTime) 内部。

如果您使用`CreateThread`API 而不是使用`_begingthreadex`对 CRT 函数的调用，结果可能会导致意外的问题。

[查看 Richter 的这本旧 Microsoft Journal。](http://www.microsoft.com/msj/0799/Win32/Win320799.aspx)

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2016-09-16T07:15:47.447

其他答案未能讨论调用包装 Win32 API 函数的 C 运行时函数的含义。这在考虑 DLL 加载程序锁定行为时很重要。

正如其他答案所讨论的那样，无论是否`_beginthread{ex}`有任何特殊的 C 运行时线程/光纤内存管理，它都是在进程可能尚未加载的 DLL 中实现的（假设动态链接到 C 运行时）。

`_beginthread*`从调用是不安全的`DllMain`。我已经通过编写使用 Windows“AppInit_DLLs”功能加载的 DLL 对此进行了测试。调用`_beginthreadex (...)`而不是`CreateThread (...)`导致 Windows 的许多重要部分在启动期间停止运行，因为`DllMain`入口点死锁等待加载程序锁被释放以执行某些初始化任务。

顺便说一句，这也是为什么**kernel32.dll**有很多重叠的字符串函数，C 运行时也有——使用这些函数`DllMain`来避免相同的情况。

* * *

## 回答 #16

> 赞同：-1
> 
> 时间：2020-08-08T09:50:47.230

## 你应该试试这段代码

```
#include<stdio.h>
#include<stdlib.h>
#include<windows.h>
#include<process.h>

UINT __stdcall Staff(PVOID lp){
 printf("The Number is %d\n", GetCurrentThreadId());
 return 0;
}

INT main(INT argc, PCHAR argv[])
{

    const INT Staff_Number = 5;
    HANDLE hd[Staff_Number];
    for(INT i=0; i < Staff_Number; i++){
       hd[i] = (HANDLE)_beginthreadex(NULL, 0, Staff, NULL, 0, NULL);
    }

 WaitForMultipleObjects(Staff_Number, Staff, TRUE, NULL);
 for(INT i=0; i < Staff_Number; i++)
 {
     CloseHandle(hd[i]);
 }
 system("pause");
 return 0;
} 
```

如果您使用 _beginthread 而不是 _beginthreadex 它会给 _beginthread 错误太多参数，这是因为 _beginthread 无法创建具有安全属性的线程，而且我认为 _beginthread 是不必要的，您绝对可以使用 *(_beginthreadex) 和 CreateThread

* * *

## 回答 #17

> 赞同：-2
> 
> 时间：2015-05-04T04:42:31.500

两者之间已经没有区别了。

所有关于内存泄漏等的评论都是基于非常旧的 < VS2005 版本。几年前我做过一些压力测试，可以揭穿这个神话。甚至 Microsoft 在他们的示例中也混合了这些样式，几乎从不使用 _beginthread。

# java - 在 URLConnection 中设置标头的正确方法是什么？

> ID：331538
> 
> 赞同：19
> 
> 时间：2008-12-01T17:21:51.103
> 
> 标签：java, header, urlconnection

我的代码如下：

```
URLConnection cnx = address.openConnection();
cnx.setAllowUserInteraction(false);         
cnx.setDoOutput(true);
cnx.addRequestProperty("User-Agent", 
    "Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.0)");
InputStream is = cnx.getInputStream(); 
```

如果我在得到之前设置标题可以`InputStream`吗？我的标头会被发送，还是服务器会看到默认`URLConnection`的用户代理（如果有）？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2008-12-01T17:51:21.810

**必须**`InputStream`在获得任何影响之前设置标头-`IllegalStateException`如果连接已经打开，则会抛出一个。

至于`User-Agent`具体的报头，如果已设置，则应发送。

请参阅[URLConnection](http://docs.oracle.com/javase/6/docs/api/java/net/URLConnection.html) JavaDoc。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2011-08-05T12:55:16.143

要回答这个问题，代码是正确的。在 getInputStream() 的那一刻，一个 HTTP get 被发送到目标服务器。

关于用户代理的旁注，如果您不设置它， URLConnection 无论如何都会发送默认的，即：

```
User-Agent: Java/1.6.0_24 (varies depending on your java version) 
```

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2012-09-13T09:01:37.193

我建议不要使用 URLConnection 等低级结构。有很多用于发送 HTTP 请求的库，其中最突出的是 Apache HTTP Client。

# apache - Htaccess 两种不同的重定向

> ID：331549
> 
> 赞同：0
> 
> 时间：2008-12-01T17:25:03.313
> 
> 标签：apache, .htaccess, mod-rewrite

我有一个可以正常工作的现有 htaccess：

```
RewriteEngine On
RewriteCond %{SCRIPT_FILENAME} !-f
RewriteCond %{SCRIPT_FILENAME} !-d
RewriteRule (.*) /default.php 
DirectoryIndex index.php /default.php 
```

我希望对此进行修改，以便所有以 /test/ 开头的 URL 都转到 /test/default.php，**同时将所有其他 URL 保留为现有的 /default.php**。

示例：[http](http://www.x.com/hello.php) ://www.x.com/hello.php --> [http://www.x.com/default.php](http://www.x.com/default.php)示例：[http](http://www.x.com/test/hello.php) ://www.x.com/test/hello.php -- > [http://www.x.com/test/default.php](http://www.x.com/test/default.php)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-01T17:37:36.003

将 /test/ 的规则放在其他所有规则之前，但`[L]`如果匹配，则给它一个标志以停止那里的重写规则处理。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-24T17:44:06.007

Try this.

```
RewriteEngine On
RewriteCond %{SCRIPT_FILENAME} !-f
RewriteCond %{SCRIPT_FILENAME} !-d

RewriteRule /test/.* /test/default.php 
RewriteRule .* /default.php 

DirectoryIndex index.php /default.php 
```

You also don't need the ()'s because your not setting the value as a variable.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-24T17:49:43.097

In your main folder, use the following .htaccess

```
RewriteEngine On
RewriteCond %{SCRIPT_FILENAME} !-f
RewriteCond %{SCRIPT_FILENAME} !-d
RewriteRule .* default.php [L]
DirectoryIndex index.php default.php 
```

In your `./test/` folder *(I assume it is a physical folder)*, copy and paste the same `.htaccess` file.

First, you didn't need the `/` at the beginning of default. Apache will always assume it is looking in the same directory as the `.htaccess` file is located.

Second, Apache looks backwards when looking for an `.htaccess` file. So anything in `./test/.htaccess` will overwrite what's written in `./.htaccess`.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-01T17:57:20.550

尝试这个

```
RewriteEngine On
RewriteCond %{SCRIPT_FILENAME} !-f
RewriteCond %{SCRIPT_FILENAME} !-d
RewriteRule (/test/)?(.*) $1/default.php 
DirectoryIndex index.php /default.php 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-01T18:04:23.017

这应该有效：

```
RewriteEngine On
RewriteCond %{SCRIPT_FILENAME} !-f
RewriteCond %{SCRIPT_FILENAME} !-d
RewriteRule (test/)?(.*) $1default.php [L]
DirectoryIndex index.php /default.php 
```

# c# - 当我改变控件的左侧位置和宽度时，如何阻止控件抽动？

> ID：331553
> 
> 赞同：3
> 
> 时间：2008-12-01T17:25:48.680
> 
> 标签：c#, winforms

我有一个用户可以用鼠标调整大小的控件。当它们向右移动时，我只需更改宽度，一切正常。

但是，当他们移动左侧尺寸时，我必须更改 Left 和 Width 属性。控件的右侧明显抽搐，在新位置显示旧宽度。

如果我使用 Bounds 同时设置 left 和 width ，它仍然会抽搐；我是否将 SetStyle 与 UserPaint、Opaque、OptimizedDoubleBuffer、AllPaintingInWmPaint 或 ResizeRedraw 中的任何一个一起使用；以及它是否是双缓冲的。如果我在控件或其父级上调用 SuspendLayout()/ResumeLayout()，它仍然会抽搐。

当我改变控件的左侧位置和宽度时，如何阻止控件抽动？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-01T17:45:57.390

您可能想`Control.SuspendLayout()`在移动/调整大小之前尝试调用包含表单，然后`Control.ResumeLayout()`.

听起来无论您将控件设置为哪种模式，当您更改边界时触发的某些事件都会在设置两个值之前重新绘制它。它可能与表格有关。

**编辑：**我在 SO 上看到了这个[类似的问题](https://stackoverflow.com/questions/64272/how-to-eliminate-flicker-in-windowsforms-custom-control-when-scrolling)，您提到您已经使用过 SetStyle()，但也许您可以选择一些选项组合来获得所需的效果。

希望有帮助！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-02T09:29:33.413

这有帮助吗？ [http://richardsbraindump.blogspot.com/2007/09/how-to-create-flicker-free.html](http://richardsbraindump.blogspot.com/2007/09/how-to-create-flicker-free.html)

我不知道您是否将 SetStyle 与这些参数一起使用。

如果这没有帮助，我会删除答案，否则我会从 url 添加代码片段。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-02T19:55:52.760

与其进行实时调整大小，不如显示一个 sizer/ghost 矩形会更好。然后当用户鼠标向上时，调整一次控件的大小。

这是一篇解释 Win32/C++ 方法的文章。
[http://www.dotnetheaven.com/Uploadfile/amitnabarro/resize_rt04082005085351AM/resize_rt.aspx](http://www.dotnetheaven.com/Uploadfile/amitnabarro/resize_rt04082005085351AM/resize_rt.aspx)

您也许可以使用控件容器的 Graphics 对象来绘制一个没有闪烁的边界矩形。

# asp.net - 如何使用反射在 app_code 中创建一个类？

> ID：331564
> 
> 赞同：4
> 
> 时间：2008-12-01T17:29:46.220
> 
> 标签：asp.net, reflection

我在 asp.net 网站的 app_code 文件夹中有一个类 Customer，如何使用反射创建实例，例如使用 Activator.CreateInstance(assemblyName, typeName)？因为app_code是动态编译的，不知道设计时的程序集？

谢谢弗雷德

问题应该是如何在设计时获得类型的全名，我想把它放在web.config中。我有 ConfigSection 类型，它在 app_code 文件夹中，我需要在 configSection 中声明它。谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-01T17:51:44.773

您应该能够在 web.config 中使用“App_Code”或“__Code”作为程序集名称

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-01T17:34:06.040

我认为您可以使用[Assembly.GetExecutingAssembly()](http://msdn.microsoft.com/en-us/library/system.reflection.assembly.getexecutingassembly.aspx)来获取对当前程序集的引用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-04-22T07:14:58.527

我以这种方式解决了类似的问题：

```
Type[] appCodeTypes = System.Reflection.Assembly.Load("App_Code").GetTypes(); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-01T17:36:03.197

如果您知道 GetType().Assembly 将与您当前执行的代码相同，您也可以使用它。

# java - Java 位运算（在基数排序中）

> ID：331566
> 
> 赞同：1
> 
> 时间：2008-12-01T17:29:57.377
> 
> 标签：java, sorting, radix-sort, number-manipulation

前几天我决定用 Java编写一个[基数排序的实现。](http://en.wikipedia.org/wiki/Radix_sort)基数排序应该是 O(k*N) 但我的最终是 O(k^2*N) 因为将每个数字分解为一个数字的过程。我通过修改（％）前面的数字并除以十来消除后面的数字来分解每个数字。我问我的教授是否有更有效的方法来做到这一点，他说使用位运算符。现在我的问题是：哪种方法在分解 Java 中的每个数字时最快，1) 上述方法。2）将数字转换为字符串并使用子字符串。3) 使用位操作。

如果 3) 那么这将如何工作？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-01T17:46:59.057

作为提示，请尝试使用 10 以外的基数，因为计算机处理二进制算术比十进制更好。

*   x >>> n 等价于 x / 2 ^n
*   x & (2 ^n - 1) 等价于 x % 2 ^n

顺便说一句，Java 的 >> 执行符号扩展，在这种情况下这可能不是您想要的。使用 >>> 代替。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-01T17:35:20.377

[Radix_sort_(Java)](http://en.literateprograms.org/Radix_sort_(Java))

执行此操作的代码行；

```
int key = (a[p] & mask) >> rshift; 
```

是位操作部分。

`&`是执行按位与的运算符并且`>>`是右移。

# c# - 如何使用 XmlDocument 向根元素添加多个命名空间？

> ID：331568
> 
> 赞同：19
> 
> 时间：2008-12-01T17:30:10.183
> 
> 标签：c#, .net, xml, namespaces, xmldocument

我需要创建一个`XmlDocument`包含多个命名空间的根元素。我正在使用 C# 2.0 或 3.0

这是我的代码：

```
XmlDocument doc = new XmlDocument();
XmlElement root = doc.CreateElement("JOBS", "http://www.example.com");
doc.AppendChild(root);

XmlElement job = doc.CreateElement("JOB", "http://www.example.com");
root.AppendChild(job);  

XmlElement docInputs = doc.CreateElement("JOB", "DOCINPUTS", "http://www.example.com");
job.AppendChild(docInputs);  

XmlElement docInput = doc.CreateElement("JOB", "DOCINPUT", "http://www.example.com");
docInputs.AppendChild(docInput);  

XmlElement docOutput = doc.CreateElement("JOB", "DOCOUTPUT", "http://www.example.com");
docOutputs.AppendChild(docOutput); 
```

当前输出：

```
<JOBS xmlns="http://www.example.com">
  <JOB>
    <JOB:DOCINPUTS xmlns:JOB="http://www.example.com">
      <JOB:DOCINPUT />
    </JOB:DOCINPUTS>
    <JOB:DOCOUTPUTS xmlns:JOB="http://www.example.com">
      <JOB:DOCOUTPUT />
    </JOB:DOCOUTPUTS>
  </JOB>
</JOBS> 
```

但是，我想要的输出是：

```
<JOBS xmlns:JOBS="http://www.example.com" xmlns:JOB="http://www.example.com">
  <JOB>
    <JOB:DOCINPUTS>
      <JOB:DOCINPUT />
    </JOB:DOCINPUTS>
  <JOB:DOCOUTPUTS>
    <JOB:DOCOUTPUT />
  </JOB:DOCOUTPUTS>
  </JOB>
</JOBS> 
```

我的问题：如何创建一个`XmlDocument`包含具有多个名称空间的根元素？

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2008-12-01T22:20:54.807

以下将生成您在上面请求的所需输出：

```
XmlDocument doc = new XmlDocument();

XmlElement root = doc.CreateElement("JOBS");
root.SetAttribute("xmlns:JOBS", "http://www.example.com");
root.SetAttribute("xmlns:JOB", "http://www.example.com");
doc.AppendChild(root);

XmlElement job = doc.CreateElement("JOB");

XmlElement docInputs    = doc.CreateElement("JOB", "DOCINPUTS", "http://www.example.com");
XmlElement docInput     = doc.CreateElement("JOB", "DOCINPUT", "http://www.example.com");
docInputs.AppendChild(docInput);
job.AppendChild(docInputs);

XmlElement docOutputs   = doc.CreateElement("JOB", "DOCOUTPUTS", "http://www.example.com");
XmlElement docOutput    = doc.CreateElement("JOB", "DOCOUTPUT", "http://www.example.com");
docOutputs.AppendChild(docOutput);
job.AppendChild(docOutputs);

doc.DocumentElement.AppendChild(job); 
```

但是，在您的示例/所需输出中，对两个不同的前缀使用相同的 XML 命名空间似乎很奇怪。希望这可以帮助。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-12-01T21:01:45.560

您可以在元素上显式创建名称空间前缀属性。然后，当您添加使用相同命名空间和相同前缀创建的后代元素时，XmlDocument 会发现它不需要向元素添加命名空间声明。

运行此示例以查看其工作原理：

```
 using System;
    using System.Xml;

    static void Main(string[] args)
    {
        XmlDocument d = new XmlDocument();
        XmlElement e = d.CreateElement("elm");

        d.AppendChild(e);

        d.DocumentElement.SetAttribute("xmlns:a", "my_namespace");

        e = d.CreateElement("a", "bar", "my_namespace");
        d.DocumentElement.AppendChild(e);
        e = d.CreateElement("a", "baz", "other_namespace");
        d.DocumentElement.AppendChild(e);
        e = d.CreateElement("b", "bar", "my_namespace");
        d.DocumentElement.AppendChild(e);

        d.Save(Console.Out);

        Console.ReadLine();
    } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-01T17:55:49.210

尝试将命名空间属性添加到根元素：

```
 XmlDocument doc = new XmlDocument();

        XmlElement root = doc.CreateElement("JOBS", "http://www.example.com");
        root.SetAttribute("xmlns:JOB", "http://www.example.com"); 

        doc.AppendChild(root);

        XmlElement job = doc.CreateElement("JOB", "http://www.example.com");
        root.AppendChild(job);

        XmlElement docInputs = doc.CreateElement("JOB", "DOCINPUTS", "http://www.example.com");
        job.AppendChild(docInputs);

        XmlElement docInput = doc.CreateElement("JOB", "DOCINPUT", "http://www.example.com");
        docInputs.AppendChild(docInput);

        XmlElement docOutput = doc.CreateElement("JOB", "DOCOUTPUT", "http://www.example.com");
        root.AppendChild(docOutput); 
```

# emacs - 在 Emacs 中杀死缓冲区时“区分、保存或杀死”

> ID：331569
> 
> 赞同：20
> 
> 时间：2008-12-01T17:30:12.570
> 
> 标签：emacs

当试图杀死包含 Emacs 中更改的缓冲区时，会显示消息：“缓冲区 [缓冲区] 已修改；仍然要杀死？（是或否）”。

而不是这个，我想让 Emacs 询问我是否想要：1.查看更改的差异，2.保存缓冲区，3.终止缓冲区。

如何？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2008-12-02T16:32:44.527

答案在于使用[建议](http://www.delorie.com/gnu/docs/elisp-manual-21/elisp_212.html "建议")，因为在您想要更改的“缓冲区已修改”提示**之后**运行终止缓冲区时，挂钩通常会运行。

以下建议可以满足您的要求（我认为）。几点注意事项：

1.  运行差异时，原始缓冲区被标记为未修改 - 但您确实需要保存它。
2.  差异中的另一个缓冲区不会被删除

```
`(defadvice kill-buffer (around my-kill-buffer-check activate)
  "Prompt when a buffer is about to be killed."
  (let* ((buffer-file-name (buffer-file-name))
         backup-file)
    ;; see 'backup-buffer
    (if (and (buffer-modified-p)
             buffer-file-name
             (file-exists-p buffer-file-name)
             (setq backup-file (car (find-backup-file-name buffer-file-name))))
        (let ((answer (completing-read (format "Buffer modified %s, (d)iff, (s)ave, (k)ill? " (buffer-name))
                                       '("d" "s" "k") nil t)))
          (cond ((equal answer "d")
                 (set-buffer-modified-p nil)
                 (let ((orig-buffer (current-buffer))
                       (file-to-diff (if (file-newer-than-file-p buffer-file-name backup-file)
                                         buffer-file-name
                                       backup-file)))
                   (set-buffer (get-buffer-create (format "%s last-revision" (file-name-nondirectory file-to-diff))))
                   (buffer-disable-undo)
                   (insert-file-contents file-to-diff nil nil nil t)
                   (set-buffer-modified-p nil)
                   (setq buffer-read-only t)
                   (ediff-buffers (current-buffer) orig-buffer)))
                ((equal answer "k")
                 (set-buffer-modified-p nil)
                 ad-do-it)
                (t
                 (save-buffer)
                 ad-do-it)))
      ad-do-it)))` 
```

* * *

 `## 回答 #2

> 赞同：5
> 
> 时间：2008-12-01T17:51:02.467

您需要编写一些代码来放入[kill-buffer-hooks](http://www.gnu.org/software/emacs/manual/html_node/emacs/Kill-Buffer.html)和 [write-file-functions](http://www.gnu.org/software/emacs/elisp/html_node/Saving-Buffers.html)列表中。从概念上讲，你想做的是

1.  测试缓冲区是否已被修改
2.  显示您的消息并获得响应，然后执行要求的操作
3.  然后清除修改后的标志，这样正常的kill-buffer就不会回来再次询问。

# internet-explorer - shdocvw Web 浏览器控件缩放

> ID：331583
> 
> 赞同：0
> 
> 时间：2008-12-01T17:35:07.677
> 
> 标签：internet-explorer, internet-explorer-6, activex

我正在使用来自 shdocvw.dll 的 Web 浏览器控件来构建我自动控制的 html 和图像查看器。我正在加载的一些图像的分辨率非常大，所以我希望能够自动将控件缩小到内容的范围，并希望支持回 IE6。这可能吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-30T06:26:34.560

你不能写一些javascript代码来改变图像的`width`和`height`以适应窗口吗？就像是：

```
var img = document.getElementById('the-image-id');
img.width = window.innerWidth * 0.9;
img.height = window.innerHeight * 0.9; 
```

您甚至可以在图像上添加一个点击处理程序来放大：

```
function zoomin() {
  this.width = '';
  this.height= '';
}
img.click = zoomin; 
```

那是你要找的那种东西吗？

# eclipse - 在设备上调试 j2me

> ID：331594
> 
> 赞同：7
> 
> 时间：2008-12-01T17:37:45.673
> 
> 标签：eclipse, debugging, java-me

有没有人成功地将调试器连接到系留设备？我可以在模拟器中调试我的 j2me 应用程序，但是在解决电话特定问题时遇到了很多麻烦。我使用的手机是诺基亚 N95，但理想情况下，调试过程适用于任何手机。

这可能吗？如果是这样，是否有人有他们用来设置它的步骤？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-13T11:32:18.330

索尼爱立信至少从K700开始就支持在ebery手机上进行调试，这是通过使用KDWP来完成的。UIQ 3 通信器也可以以相同的方式进行调试。

顺便说一句，SE 的最新款手机甚至可以监控内存消耗和 CPU 分析。所以如果你想在真机上调试你的应用程序，我建议你也使用 SE 手机，他们真的很擅长。我使用 Netbeans，它在任何 SE 手机上都没有任何问题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-02T02:21:55.507

摩托罗拉手机支持名为[KDWP](https://developer.motorola.com/docstools/technicalarticles/KDWP_20060501.pdf/)（需要注册 Motodev）的调试接口。他们的 MIDway 工具还可用于从设备上运行的 midlet 获取调试跟踪信息。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-03T10:04:27.333

如前所述，设备调试完全取决于制造商的意愿，而且通常几乎是不可能的。不过，我可以向您介绍[Gear Java Mobile Framework](http://sourceforge.net/projects/gearjmf/)，它让您有机会使用设备上的调试控制台打印您的消息，从而阅读手机特定的问题。如果您需要有关如何使用它的一些说明，请查看[本教程](http://digitalapes.blogspot.com/2009/02/developing-mobile-applications-using.html)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-01T18:47:18.407

不幸的是，这通常是不可能的。一些制造商（如索尼爱立信）在他们的一些手机上支持这一点，但不是全部。我不确定 N95 是否有设备上调试工具，但您可以使用诺基亚的模拟器，它应该非常接近设备。新的[Java ME SDK](http://java.sun.com/javame/sdk/index.jsp)有望在不久的将来实现真正的 ODD。但这仍然很大程度上取决于OEM合作。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-07-31T20:41:43.230

我发现一个很好的调试方法是控制一个字符串值，当它不为空时，它会被绘制在其他所有内容之上。这在任何地方都可以工作，虽然显然不是很理想，但可以用来捕获异常、打印值等。当然你仅限于小屏幕，但理论上你甚至可以编写一些滚动功能。

有些人使用 RMS 日志记录，但我个人永远不会被打扰。

正如其他人在这里所说，摩托罗拉有 Midway，我认为这很棒。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-18T15:39:47.573

我有时使用 Blackberry 工具来调试 J2ME 应用程序（不使用 RIM API），但它非常慢并且仍然只是仿真，而不是实际设备（但它有时确实有助于摆脱奇怪的事情）。我同意当您在模拟器上运行某些东西却发现它不能在硬件上运行时，这是令人沮丧的。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-15T16:17:11.117

其他人在这里是正确的，因为设备上的调试非常特定于设备。我没有对 60 系列做任何事情，但至少在 40 系列手机上，我必须打开一个 CommConnection 并写出来才能看到发生的大部分事情。设备模拟器又是一个混合包，但您通常可以获得 90% 的应用程序在它们上工作的方式，并且通常可以让您的调试器连接到它们。如果您不使用手机上的任何硬件，那应该可以帮助您完成大部分工作。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2011-11-07T04:42:34.740

您不能像 android 或其他 SDK 那样逐步调试。

在 J2ME 中，您可以通过在代码中添加日志语句来跟踪错误并添加另一个 midlet 并在该 midlet 中显示该日志屏幕。

示例：添加`Log.p("Log statement.....");`

```
LogMidlet.java 
// Add the following line in the startup method of this midlet.
    Log.getInstance().showLog(); 
```

通过这种方式，您可以以某种方式跟踪 j2me 中的错误。

* * *

## 回答 #9

> 赞同：-2
> 
> 时间：2009-07-21T09:01:41.700

我认为可以在预处理步骤中添加额外的调试信息。像这样：

```
公共无效我的方法（）{
    Debug.traceMethod("myMethod");
    整数变量 = 1;
    Debug.ne​​wLine();
    变量++；
    Debug.ne​​wLine();
    ...
}

```

# c# - 使用 javascript 设置隐藏字段的值，然后从服务器端 c# 代码访问值

> ID：331599
> 
> 赞同：4
> 
> 时间：2008-12-01T17:39:46.373
> 
> 标签：c#, javascript

我正在使用样式为下拉列表的嵌套 html 无序列表。当单击内部列表列表项中的 a 标记时，它会触发一些 javascript，该 javascript 应该将隐藏字段的值设置为单击的链接的文本。

javascript似乎可以工作-我使用警报从隐藏字段中读取值，但是当我尝试将该值放在我的asp.net c#代码后面的查询字符串中时-它提取了初始值-而不是javascript设置值.

我想这是因为 javascript 是客户端而不是服务器端，但有任何人知道我怎样才能让它工作

**HTML**

```
 <div class="dropDown accomodation">
    <label for="accomodationList">Type of accomodation</label>
    <ul class="quicklinks" id="accomodationList">
        <li><a href="#" title="Quicklinks" id="accomodationSelectList">All types
     <!--[if IE 7]><!--></a><!--<![endif]-->

    <!--[if lte IE 6]><table><tr><td><![endif]-->
    <ul id="sub" onclick="dropDownSelected(event,'accomodation');">
            <li><a href="#" id="val=-1$#$All types" >All types</a></li>
            <li><a href="#" id="val=1$#$Villa" >Villa</a></li>
            <li><a href="#" id="val=2$#$Studio" >Studio</a></li>
            <li><a href="#" id="val=3$#$Apartment" >Apartment</a></li>
            <li><a class="last" href="#" id="val=4$#$Rustic Properties" >Rustic Properties</a></li>

    </ul>
    <!--[if lte IE 6]></td></tr></table></a><![endif]-->
        </li></ul>
    </div>

<input type="hidden" ID="accomodationAnswer" runat="server" /> 
```

**javascript**

```
 if(isChildOf(document.getElementById(parentList),document.getElementById(targ.id)) == true)
{           

            document.getElementById(parentLi).innerHTML = tname;            
            document.getElementById(hiddenFormFieldName).Value = targ.id;
            alert('selected id is ' + targ.id + ' value in hidden field is ' +           document.getElementById(hiddenFormFieldName).Value);
} 
```

**C# 代码**

```
String qstr = "accom=" + getValFromLiId(accomodationAnswer.Value) + "&sleeps=" + getValFromLiId(sleepsAnswer.Value) + "&nights=" + getValFromLiId(nightsAnswer.Value) + "&region=" +
getValFromLiId(regionAnswer.Value) + "&price=" + Utilities.removeCurrencyFormatting(priceAnswer.Value); 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-12-01T18:36:32.310

我会这样做：首先，`runat='server'`从隐藏字段（体内）中删除属性：

```
<input type="hidden" id="accomodationAnswer" /> 
```

现在，在您要读取该值的服务器上，执行以下操作：

```
string accomodationAnswer = Request.Form["accomodationAnswer"];

// now use accomodationAnswer instead of accomodationAnswer.Value 
// in the C# code that you indicated you are using 
```

那应该这样做。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-11-09T09:17:04.480

尝试这个

如果您使用的是 .net 4.0，则在页眉中。

Language="C#" AutoEventWireup="true" CodeFile="Page.cs" Inherits="Page"

连同这篇文章：

```
ClientIDMode="Static" 
```

它有助于在运行时不更改服务器端控件 ID

现在

将javascript中的值设置为

document.getElementById("hiddenField").value = "Value";

并在代码隐藏中访问，如下所示。

字符串 hiddenValue=hiddenField.Value.ToString();

# python - 如何为 Google App Engine 编写 Web 服务？

> ID：331600
> 
> 赞同：32
> 
> 时间：2008-12-01T17:39:47.917
> 
> 标签：python, xml, web-services, google-app-engine, soap

我对 Python 真的很陌生，我一直在寻找一个关于如何使用 Google App Engine 在 Python 中编写 Web 服务（XML - SOAP）的示例，但没有运气。

谁能指点我一篇文章或给我一个如何做到这一点的例子？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2008-12-02T05:22:18.420

我自己对此很好奇，但没有找到任何东西，我决定尝试让一些东西发挥作用。简短的回答是事实证明 SOAP 服务实际上可以使用最新的 alpha [ZSI 库](http://pywebsvcs.sourceforge.net/zsi.html)来完成。然而它并不简单，我所做的只是一个简单的请求，所以它可能会因复杂的类型而崩溃。我会试着找时间写一篇关于如何做的教程，并更详细地编辑这个答案。

除非这是一项硬性要求，否则我会按照 jamtoday 所说的那样使用 REST 或 RPC 服务。SOAP 方式可能会充满麻烦。

更新：对于任何感兴趣的人，我已经写了一篇[关于如何将 SOAP 服务部署到 Google App Engine 的教程](http://www.ioncannon.net/web-services/180/soap-on-the-google-app-engine-platform/)。这是一个漫长的过程，所以我只是链接到它而不是把它全部粘贴在这里。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-12-02T03:40:09.140

如果您想专门使用 App Engine 做某事，有一些库可以让您更快地完成它。我建议查看 XML-RPC 和 REST 示例。

[http://appengine-cookbook.appspot.com/recipe/xml-rpc-server-using-google-app-engine/](http://appengine-cookbook.appspot.com/recipe/xml-rpc-server-using-google-app-engine/)

[http://github.com/fczuardi/gae-rest/tree/master](http://github.com/fczuardi/gae-rest/tree/master)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-09-20T08:35:34.183

我知道这是一个旧线程，但以防万一有人碰巧读到这个。我刚刚开始了一个在 GAE 上创建 Web 服务的开源项目。

项目网站：[http ://code.google.com/p/webserviceservlet/](http://code.google.com/p/webserviceservlet/)

希望这会有所帮助。

编辑：刚刚注意到这是一个python问题，链接项目是java项目....

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-01T19:30:06.430

这是一个可能有用的[Python Web 服务项目。](http://pywebsvcs.sourceforge.net/)

**编辑**

这是一个使用[SOAP 的演示](http://diveintopython.net/soap_web_services/)......

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2011-10-29T09:52:25.697

你可以看看[Bottle](http://bottlepy.org/docs/dev/)框架。这是一个 Python 框架，您可以轻松地创建一个 REST api。在我看来，REST 绝对比 SOAP 好。任何能够说 http 的软件都可以轻松使用它，并且实现起来更快。

# sql-server - 是否可以查看在未提交的事务中运行了哪些查询？

> ID：331603
> 
> 赞同：1
> 
> 时间：2008-12-01T17:40:26.183
> 
> 标签：sql-server, sql-server-2000

我的应用程序（使用带有 SQL Server 2000 的 SQL Native Client 的 C++）一直处于挂起状态。我相信这是因为事务在表上的某个地方未提交，并且由于打开的事务，该表上的 SELECT 查询被阻塞。

不幸的是，我真的很难确定挂起交易在我的代码中的位置。有什么方法可以让 SQL Server 指示在未提交的事务上运行了哪些查询？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-01T17:43:21.950

如果您有管理员 (sa) 权限，则可以运行 sp_Who 或 sp_Who2 以显示所有服务器活动，通过 Spid，运行

```
Exec sp_Who2 [SpidNumber] 
```

只看你感兴趣的一个会话...

要直接查看未结交易，请运行

DBCC OPENTRAN (T-SQL) 显示有关指定数据库中最旧的活动事务以及最旧的分布式和非分布式复制事务（如果有）的信息。仅当存在活动事务或数据库包含复制信息时才会显示结果。如果没有活动事务，则会显示一条信息性消息。

```
Syntax
DBCC OPENTRAN 
    (    {'database_name' | database_id}
    )    [    WITH TABLERESULTS [, NO_INFOMSGS]
        ] 
```

但是，当用户会话终止时，Sql Server 应该自动回滚任何打开的事务。

# c# - C# foreach 在 foreach 循环中

> ID：331607
> 
> 赞同：12
> 
> 时间：2008-12-01T17:42:44.947
> 
> 标签：c#

我对 C# 没有太多经验，所以如果有人能指出我正确的方向，我将不胜感激。我有一个引用对象变量的 foreach 循环。我希望在主循环中创建另一个 foreach 循环，将当前变量与对象数组中的其余变量进行比较（或执行操作）。我有以下代码：

```
// Integrate forces for each body.
    foreach (RigidBodyBase body in doc.Bodies)
    {
        // Don't move background-anchored bodies.
        if (body.anchored) continue;

        // This is where we will add Each Body's gravitational force 
        //  to the total force exerted on the object.

        // For each other body, get it's point and it's mass.

            // Find the gravitational force exterted between target body and looped body.
                // Find distance between bodies.
                    // vector addition
                // Force = G*mass1*mass2/distance^2
            // Find vector of that force.
            // Add Force to TotalGravityForce
        // loop until there are no more bodies.
        // Add TotalGravityForce to body.totalForce

    } 
```

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2008-12-01T17:53:06.517

每次执行 foreach 时（即使在嵌套它们时），内部 Enumerator 都应该为您“新建”一个新的迭代器，这不应该有任何问题。当您仍在迭代时从集合中添加或删除项目时会出现问题......

请记住，在内部 foreach 中，检查以确保您不在与外部 foreach 相同的项目上

```
 foreach( RigidBodyBase body in doc.Bodies)
     foreach ( RigidBodyBase otherBody in doc.Bodies)
         if (!otherBody.Anchored && otherBody != body)  // or otherBody.Id != body.Id -- whatever is required... 
              // then do the work here 
```

顺便说一句，放置此代码的最佳位置是 RigidBodyBase 类的 GravityForce 属性，然后您可以编写：

```
 foreach (RigidBodyBase body in doc.Bodies)
       body.TotalForce += body.GravityForce; 
```

虽然取决于你在这里做什么（移动所有对象？）他们可能有更多的重构机会......我也会考虑为“其他”力量设置一个单独的属性，并让 TotalForce Property 做重力和“其他”力量的总和？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-01T17:51:13.743

恕我直言，这应该是可能的，尽管您应该真正考虑 Kibbee 的建议。也许你也可以这样优化它（例如，像这样：）

```
int l = doc.Bodies.Count;
for ( int i = 0; i < l; i++ )
    for ( int j = i + 1; j < l; j++ )
        // Do stuff 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-01T17:54:44.300

只要您不更改内部循环内的 doc.Bodies ，我认为这没有问题，因为这会导致事情爆炸。但理论上这会奏效。至于优化，我不确定它是否是最好的，但它是可能的。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-01T17:58:16.133

好吧，这是一个 O(n^2) 算法，但我想你在这里别无选择。如何将更多逻辑封装到另一种方法中。这使得简单的旧东西更具可读性。

```
foreach (RigidBodyBase body in doc.Bodies)        
{                
   Integrateforces(ref body, Bodies);
}

...

public void Integrateforces(RigidBodyBase out body, RigidBodyBase[] Bodies)
{
  //Put your integration logic here
} 
```

* * *

## 回答 #5

> 赞同：-3
> 
> 时间：2008-12-01T17:46:03.193

在这种情况下，最好使用带有索引的常规 for 循环来指示您所在的元素。尝试使用它自己的 foreach 循环迭代同一个集合会导致问题。

# java - 如何让 JMX 绑定到特定接口？

> ID：331615
> 
> 赞同：23
> 
> 时间：2008-12-01T17:45:07.733
> 
> 标签：java, rmi, jmx, jconsole

我目前正在使用**`com.sun.management.jmxremote.*`**属性启动我的 Java VM，以便我可以通过 JConsole 连接到它以进行管理和监视。不幸的是，它侦听机器上的所有接口（IP 地址）。

在我们的环境中，经常会出现在一台机器上同时运行多个 Java VM 的情况。虽然可以告诉 JMX 监听不同的 TCP 端口（使用`com.sun.management.jmxremote.port`），但最好让 JMX 使用标准 JMX 端口并绑定到特定的 IP 地址（而不是全部）。

这将使我们更容易确定我们通过 JConsole 连接到哪个 VM（因为每个 VM 有效地“拥有”自己的 IP 地址）。有没有人想出如何让 JMX 监听单个 IP 地址或主机名？

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2016-09-06T09:11:20.793

如果其他人会因此而失去神经... 10年后，他们终于修好了！

由于 Java 8u102`-Dcom.sun.management.jmxremote.host`绑定到选定的 IP

见：[https ://bugs.openjdk.java.net/browse/JDK-6425769](https://bugs.openjdk.java.net/browse/JDK-6425769)

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-12-02T01:51:39.640

Fernando 已经提供了[我的博客文章](http://vafer.org/blog/20061010091658)的链接:) .. 这不是微不足道的。您必须提供您自己的 RMIServerSocketFactoryImpl 以在所需地址上创建套接字。

如果内部/外部接口是问题，并且您具有本地访问权限，则设置本地防火墙可能会更容易。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-08-09T19:45:02.410

我没有尝试过，但这可能会有所帮助。

这里的主要麻烦是没有简单的方法来指定 JMX 绑定到的主机 IP 地址，它总是绑定到所有接口。'java.rmi.server.hostname' 属性不起作用，我不想为同一主机上的所有不同实例选择不同的端口。

此外，我不想创建自己的 RMIServerSocketFactory 并具有与之相关的所有复杂性，我是在对现有代码进行简单修补之后。

我已通过修补负责创建此服务器套接字的默认 JVM RMI 套接字工厂来解决此问题。它现在支持新的“com.sun.management.jmxremote.host”属性。

要使其工作，请将下面的 Java 代码保存到名为 sun/rmi/transport/proxy/RMIDirectSocketFactory.java 的文件中。

编译并从中创建 jmx_patch.jar 并将其放入 tomcat lib/ 文件夹中。

然后，您需要将以下行添加到 bin/setenv.sh：

CLASSPATH=$CLASSPATH:$CATALINA_HOME/lib/mx_patch.jar

在 tomcat 实例启动中添加此选项

-Dcom.sun.management.jmxremote.host=192.168.100.100"

这会将 JMX 服务仅绑定到地址 192.168.100.100。其他 2 个随机 RMI 侦听端口仍将绑定到所有接口，但这很好，因为它们总是选择一个空闲端口。

您现在可以在单个主机上运行多个 tomcat 实例，并且所有默认端口都完好无损（例如，所有这些端口的 JMX 为 8080）。

```
package sun.rmi.transport.proxy;

import java.io.IOException;
import java.net.InetAddress;
import java.net.ServerSocket;
import java.net.Socket;
import java.rmi.server.RMISocketFactory;

public class RMIDirectSocketFactory extends RMISocketFactory {

    public Socket createSocket(String host, int port) throws IOException
    {
     return new Socket(host, port);
    }

   public ServerSocket createServerSocket(int port) throws IOException
   {
   String jmx_host = System.getProperty("com.sun.management.jmxremote.host");
   String jmx_port = System.getProperty("com.sun.management.jmxremote.port");

  // Allow JMX to bind to specific address
  if (jmx_host != null && jmx_port != null && port != 0 && integer.toString(port).equals(jmx_port)) {
    InetAddress[] inetAddresses = InetAddress.getAllByName(jmx_host);
    if (inetAddresses.length > 0) {
    return new ServerSocket(port, 50, inetAddresses[0]);
   }
}

 return new ServerSocket(port);
  } 
```

}

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-07-24T05:59:46.777

当仅使用`com.sun.management.jmxremote.host`而不更改`com.sun.management.jmxremote.ssl`（默认为`true`）或`com.sun.management.jmxremote.registry.ssl`（默认为`false`）时，它仍将绑定到所有接口`com.sun.management.jmxremote.port`，并且`com.sun.management.jmxremote.host`仅用于`com.sun.management.jmxremote.rmi.port`（默认为随机端口）。不知道为什么会这样，它看起来像一个错误。对于这些`jmxremote.ssl`和`jmxremote.registry.ssl`值的任何其他组合，它将正确使用给定`jmxremote.host`的两个端口。

例如，与

```
 -Dcom.sun.management.jmxremote.authenticate=false
  -Dcom.sun.management.jmxremote.port=1234
  -Dcom.sun.management.jmxremote.host=interface1 
```

它仍然会绑定到端口的所有接口`1234`，并且只绑定到`interface1`随机的`jmxremote.rmi.port`。

请注意，JMX 客户端首先连接到`jmxremote.port`RMI 注册表，通过它接收实际的 JMX 服务器端口`jmxremote.rmi.port`，因此客户端仍然只能通过`jmxremote.host`接口与实际的 JMX 服务器通信。但是，RMI 注册表仍然不希望监听所有接口，因为当不同的 VM 以相同的`jmxremote.port`值启动时会导致端口冲突，就像这个问题中的场景一样。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2022-02-28T16:43:07.660

您将需要至少设置`com.sun.management.jmxremote.{host,port,ssl}`，尽管`com.sun.management.jmxremote.host`没有记录它至少在 OpenJDK 1.8.0_312 中确实有效。

您（很可能）还需要设置`java.rmi.server.hostname`. 请记住，JMX 客户端首先连接到 jmxremot 主机和端口，然后从那里获取 RMI 主机和端口，最后将通过 RMI 连接到该主机和端口，如果您不设置`java.rmi.server.hostname`主机（IP） jmx 客户端将不会有该端口的任何侦听器（因为您只在 127.0.0.1 侦听）

这是一个有效的示例，并不是说我也禁用了身份验证并强制使用 IPv4：

```
/usr/lib/jvm/java-8-openjdk-amd64//bin/java \
-Dcom.sun.management.jmxremote.host=127.0.0.1  \
-Djava.rmi.server.hostname=127.0.0.1 \
-Dcom.sun.management.jmxremote.port=2222 \
-Dcom.sun.management.jmxremote.ssl=false \
-Dcom.sun.management.jmxremote.registry.ssl=false  \
-Dcom.sun.management.jmxremote.authenticate=false \
-Djava.net.preferIPv4Stack=true \
-jar your-uber.jar 
```

netstat 的输出确认端口 222 仅绑定到 127.0.0.1 而不是 0.0.0.0：

```
netstat -plnt|grep 2222
Active Internet connections (only servers)
Proto Recv-Q Send-Q Local Address           Foreign Address         State       PID/Program name
tcp        0      0 127.0.0.1:2222          0.0.0.0:*               LISTEN      15390/java 
```

* * *

## 回答 #6

> 赞同：-2
> 
> 时间：2017-03-19T21:38:09.383

我刚试过

-Dcom.sun.management.jmxremote.host=

使用openjdk 1.8，效果很好。它绑定到那个地址（根据 netstat）并且看起来一切正常（并且有效）。

* * *

## 回答 #7

> 赞同：-3
> 
> 时间：2014-09-15T19:11:38.947

接受的答案很老了。有一些迹象表明 Java 现在提供了一些选项来启用此功能。例如我见过：

```
-Djava.rmi.server.hostname=<YOUR_IP> 
```

...也...

```
-Dcom.sun.management.jmxremote.host=<YOUR_IP> 
```

但是，至少在我的 jdk 1.7 下的系统上，这些似乎没有任何作用——JMX 连接器仍然绑定到 *. 更新的答案（带有特定的适用版本）将不胜感激。这*应该*很简单。

# php - 在 mysql/php 中执行 insert...select... 查询时是否可以执行 count(*)？

> ID：331619
> 
> 赞同：0
> 
> 时间：2008-12-01T17:46:26.640
> 
> 标签：php, mysql, insert

是否可以在 PHP 脚本中执行简单的 count(*) 查询，而另一个 PHP 脚本正在执行 insert...select... 查询？

情况是我需要从另一个表创建一个大约 1M 或更多行的表，并且在插入时，我不希望用户觉得页面冻结，所以我试图继续更新计数，但是通过使用`select count(\*) from table`在插入背景时，我只有 0 直到插入完成。

那么有没有办法让 MySQL 先返回部分结果呢？或者是否有一种快速的方法可以使用从先前的选择查询中获取的数据进行一系列插入，同时具有与插入...选择...查询相同的性能？

环境为php4.3和MySQL4.1。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-01T17:58:33.060

不降低性能？不见得。有一点性能损失，也许......

但是你为什么要定期创建表格并插入数百万行呢？如果您很少这样做，您就不能警告管理员（大概是唯一允许这样做的人）这需要很长时间。如果你一直这样做*，*你真的确定你没有*做错*吗？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-01T18:06:29.190

我同意 Stein 的评论，即如果您在 PHP 请求期间一次复制 100 万行，这是一个危险信号。

我相信，在大多数情况下，人们试图对 SQL 进行微优化，通过以不同的方式解决问题，他们可以获得更高的性能和吞吐量。SQL 不应该是你的瓶颈。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-01T17:55:58.290

在提交之前，其他用户看不到插入。这通常是一件好事，因为它确保他们看不到半完成的数据。但是，如果您希望他们看到中间数据，您可以在插入时偶尔调用“提交”。

顺便说一句 - 不要让任何人告诉你打开自动提交。这是一个巨大的时间浪费。我的数据库上有一个“删除并重新插入”作业，当我关闭自动提交时，它需要 1/3 的时间。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-01T18:01:05.627

需要明确的是，默认情况下 MySQL 4 未配置为使用事务。如果我没记错的话，它使用 MyISAM 表类型来锁定每个插入的整个表。

您最好的选择是使用 MySQL 批量插入函数之一，例如[LOAD DATA INFILE](http://www.modwest.com/help/kb6-253.html)，因为这些函数在插入大量数据时速度要快得多。至于计数，您可以将插入分成 N 组，每组 1000 个（或 Y），然后将进度表分成 N 个部分，并根据每个组的请求对其进行更新。

*编辑：*要考虑的另一件事是，如果这是模板的静态数据，那么您可以使用“选择进入”来创建一个具有相同数据的新表。不确定您的应用程序是什么或预期的功能，但这也可以。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-01T18:01:26.097

如果您正在执行单个 INSERT...SELECT，那么不，您将无法获得中间结果。事实上，这将是一件坏事，因为用户永远不会看到处于中间状态的数据库仅显示语句或事务的部分结果。有关更多信息，请阅读[ACID](http://en.wikipedia.org/wiki/ACID "酸")合规性。

也就是说，MyISAM 引擎可能会在这方面玩得又快又松。我很确定我已经看到 MyISAM 提交了一些但不是所有来自 INSERT...SELECT 的行，当我在中途中止它时。不过，您还没有说您的表使用的是哪个引擎。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-01T18:07:59.700

如果您可以访问控制台，您可以询问各种状态问题，这些问题将为您提供您正在寻找的信息。有一个类似于“SHOW processlist”的命令。

# apache - 重写规则重定向

> ID：331620
> 
> 赞同：1
> 
> 时间：2008-12-01T17:46:36.593
> 
> 标签：apache, mod-rewrite

好的，我有这个 RewriteRule，它应该将对文件 base.css 的任何请求重定向到 {.htacces 文件的文件夹}/include/style/base.css，但只是在无限循环中不断重定向，我认为 L 参数会确保不会发生这种情况。

```
RewriteRule (.*)/base.css$ include/style/base.css [L,NC,R=301] 
```

它还重定向到[http://localhost/C:/somemaps/include/style/base.css](http://localhost/C:/somemaps/include/style/base.css)它也不应该这样做。

谁能告诉我如何解决这个问题？
另外我想拥有 RewriteRule 以便它将任何 file.css 重定向到 {folder of .htacces file}/include/style/file.css
BTW .htacces 文件位于网站的根目录中（这不是根目录服务器！）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-01T17:48:36.527

您对重定向和重写感到困惑。重定向是告诉浏览器转到另一个 URL 的 HTTP 状态代码。您实际上只是想将该位置重写到另一个文件位置。尝试

```
RewriteRule (.*)/(.*).css$ /include/style/$2.css [L,NC] 
```

如果这不起作用，请尝试在 RewriteEngine On 之后立即添加以下内容

```
RewriteBase /my-virtual-folder-path-where-htaccess-is-stored 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-01T17:56:40.083

> 我也想要 RewriteRule 所以它将任何 file.css 重定向到 {folder of .htacces 文件}/include/style/file.css

试试这个：

```
RewriteRule ([^/]+).css$ /include/style/$1.css [L,NC] 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-01T17:49:23.747

这个 R=301 发出一个新请求。因此它再次评估 RewriteRule。

尝试使用重写条件 (RewriteCond) 排除此路径/目录。

# linux - GCC/ELF - 我的符号从何而来？

> ID：331635
> 
> 赞同：4
> 
> 时间：2008-12-01T17:51:34.290
> 
> 标签：linux, gcc, solaris, elf, ld

有一个可执行文件动态链接到共享对象的数量。我如何确定某个符号（导入可执行文件）属于其中的哪一个？

如果有不止一种可能性，我可以模拟 ld 并查看它是从哪里拍摄的吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-01T17:59:14.680

看看[nm(1)](http://unixhelp.ed.ac.uk/CGI/man-cgi?nm)、[objdump(1)](http://www.digipedia.pl/man/objdump.1.html)和[elfdump(1)](http://www.digipedia.pl/man/elfdump.1.html)。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-12-01T18:03:38.273

除了查理提到的那些，“ [ldd](http://unixhelp.ed.ac.uk/CGI/man-cgi?ldd) ”可能会做一些你正在寻找的事情。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-12-04T07:38:19.423

如果您可以重新链接可执行文件，找出引用和定义来自何处的最简单方法是使用`ld` `-y`标志。例如：

```
$ cat t.c
int main() { printf("Hello\n"); return 0; } 

$ gcc t.c -Wl,-yprintf 
/lib/libc.so.6: definition of printf 
```

如果您无法重新链接可执行文件，请`ldd`在其上运行，然后`'nm -D'`在按顺序列出的所有库上运行，并`grep`针对您感兴趣的符号运行。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-17T06:13:56.547

```
$LD_DEBUG=bindings my_program 
```

这将在控制台上打印所有符号绑定。

# php - 自定义 Zend_Form

> ID：331641
> 
> 赞同：2
> 
> 时间：2008-12-01T17:53:53.740
> 
> 标签：php, zend-framework, forms, zend-form

我现在正在处理，[`Zend_Form`](http://framework.zend.com/manual/en/zend.form.html)我很难弄清楚如何：

1.  为表单按钮使用自定义图像，
2.  在特定位置插入文本和链接（在我的情况下，我想在提交按钮之前放置一个“忘记密码？”链接）。

我已经阅读了手册，但没有看到任何关于此的内容。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-01T20:18:25.880

我认为 Zend_Form_Decorators 可以帮助你： http: [//framework.zend.com/manual/en/zend.form.decorators.html](http://framework.zend.com/manual/en/zend.form.decorators.html)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-12T12:36:12.710

尝试阅读这篇文章，我认为这是关于 Zend_Form 中装饰器的最好的一篇

[http://devzone.zend.com/article/3450-Decorators-with-Zend_Form](http://devzone.zend.com/article/3450-Decorators-with-Zend_Form)

对于您的使用将是关于“使用 ViewScript 装饰器的完全自定义”最有帮助的部分，请尝试在文章中找到它

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-01T20:43:28.250

您可以在视图中直接编写 HTML，只需确保元素名称、选择选项、隐藏值等与您的 Zend_Form 元素相对应（或将元素装饰器设置为 ViewHelper 并使用`echo $this->form->element`元素应该在的位置）。无论如何，当您提交表单时，它只是相同的 POST 数据。如果您在多个地方使用表单，请查看 ViewScript 装饰器。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-01T21:35:16.210

1.  CSS？
2.  您可以使用元素的 setDescription() 方法为其添加描述。如果我没记错的话，这会呈现为一个 'p class="hint"' 元素，但您当然可以使用表单装饰器来更改它。

# bash - 当我中断 ssh 本身时，如何使 ssh 杀死远程进程？

> ID：331642
> 
> 赞同：26
> 
> 时间：2008-12-01T17:54:05.690
> 
> 标签：bash, ssh

在 bash 脚本中，我通过 ssh 在远程机器上执行命令。如果用户通过按 Ctrl+C 中断脚本，它只会停止脚本 - 甚至不会停止 ssh 客户端。此外，即使我杀死 ssh 客户端，远程命令仍在运行......

如何让 bash 杀死本地 ssh 客户端和 Crtl+c 上的远程命令调用？

一个简单的脚本：

```
#/bin/bash
ssh -n -x root@db-host 'mysqldump db' -r file.sql 
```

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2008-12-03T13:17:34.170

最终我找到了这样的解决方案：

```
#/bin/bash
ssh -t -x root@db-host 'mysqldump db' -r file.sql 
```

所以-我使用'-t'而不是'-n'。删除“-n”或使用与 root 不同的用户无济于事。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-12-09T20:32:28.647

当您的 ssh 会话结束时，您的 shell 将收到一个 SIGHUP。（挂机信号）。您需要确保它将其发送到从它启动的所有进程。对于 bash，请尝试`shopt -s huponexit; your_command`. 这可能行不通，因为手册页说 huponexit 仅适用于交互式 shell。

我记得用户在我的集群上运行作业时遇到了这个问题，以及他们是否必须使用 nohup （以获得与您想要的相反的行为）但我在 bash 手册页中找不到任何关于子进程是否忽略的内容SIGHUP 默认情况下。希望 huponexit 能解决问题。（我认为，您可以将该 shopt 放在您的 .bashrc 中，而不是放在命令行中。）

但是，您`ssh -t`应该可以工作，因为当连接关闭时，从终端读取的内容会出现 EOF 或错误，这会使大多数程序退出。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-02T15:53:07.040

你知道你传递给 ssh 的选项是做什么的吗？我猜不是。-n 选项重定向来自 /dev/null 的输入，因此您在远程主机上运行的进程可能没有从 Ctrl-C 看到 SIGINT。

现在，让我们谈谈允许远程 root 登录是多么糟糕的想法：

这是一个非常非常糟糕的主意。查看[HOWTO：设置 ssh 密钥](http://pkeck.myweb.uga.edu/ssh/)，了解如何通过 ssh 安全地管理远程进程执行的一些建议。如果您需要远程运行具有特权的东西，您可能需要一个解决方案，该解决方案涉及一个带有嵌入式命令的 ssh 公钥和一个由 sudo 提供的以 root 身份运行的脚本。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-01T18:05:52.123

```
trap "some_command" SIGINT 
```

`some_command`当您按 Ctrl+C 时将在本地执行。`help trap`会告诉你它的其他选择。

关于这个`ssh`问题，我对 ssh 不太了解。也许你可以让它调用`ssh -n -x root@db-host 'killall mysqldump'`而不是`some_command`杀死远程命令？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-08-07T03:07:48.253

如果您不想要求使用“ssh -t”（对于像我这样健忘的人）怎么办？

我偶然发现了父 PID，因为启动会话中的 CTRL/C 会导致远程进程上的 ssh 启动进程退出，尽管它的子进程仍在继续。例如，这是我在远程服务器上的脚本。

```
#!/bin/bash
Answer=(Alive Dead)
Index=0
while [ ${Index} -eq 0 ]; do
  if ! kill -0 ${PPID} 2> /dev/null ; then Index=1; fi
  echo "Parent PID ${PPID} is ${Answer[$Index]} at $(date +%Y%m%d%H%M%S%Z)" > ~/NowTime.txt
  sleep 1
done 
```

然后我在远程服务器上使用“ssh remote_server ./test_script.sh”“watch cat ~/NowTime.txt”调用它，显示文件中的时间戳增加并声明父进程处于活动状态；一旦我在启动过程中按下 CTRL/C，远程服务器上的脚本就会注意到它的父进程已经死亡，并且脚本退出。

# cobol - 有 COBOL 编译的程序 -- 缺少源

> ID：331658
> 
> 赞同：4
> 
> 时间：2008-12-01T18:00:08.610
> 
> 标签：cobol

我们有一个非常重要的应用程序，但到目前为止还没有源代码。该应用程序是用 COBOL 编写的，编译版本在我们的生产系统中并且正在运行。

但是，我们需要迁移到新的服务器，以及新的 cobol 编译器。我们的印象是，我们需要重新编译代码才能使其在新服务器上工作。运行现有的已编译程序会导致运行时内存错误。

我们有一些程序的源代码，但它是旧的。不确定它与编译程序之间的差异是什么。

好的，那么问题是——我们应该怎么做？

时间不在我们这边，因为我们必须将旧服务器发回以获得信用。想法，建议，疯狂还是其他？（源代码控制很明显，这不是我能做的，所以保存讲座）

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-12-01T18:08:33.927

创建旧服务器的映像。然后将旧服务器作为新服务器上的虚拟机运行。

但是，我同意更好的选择可能是保留您的生产服务器。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-12-01T18:07:41.013

从短期来看，安排保留旧服务器可能会更便宜。从半长期来看，您需要花时间和预算来重新设计程序，要么重新编写它，要么看看将旧代码改造成程序当前所做的工作需要付出多少努力。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-12-01T18:23:57.203

可悲的是。您应该咨询[源恢复公司](http://www.source-recovery.com)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-04-06T22:24:15.047

如果你的源代码和编译后的版本*比较*接近，试试这个：

*   将新版本反编译成汇编程序
*   将旧的源代码编译成汇编器
*   比较
*   尽可能将新版本与旧版本的差异调和到旧的源代码中
*   重复

为了增强这一点，并且可能作为第二步，因为它将使源代码远离新的编译版本，使用输入数据进行测试，然后根据输出尝试逆向工程创建该输出所需的内容。您拥有的测试输入数据越多，它的效果就越好。

祝你好运！

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-12-01T18:13:41.703

（我不是 COBOL 程序员，但是..）如果您知道编译原始程序的编译器是什么版本，您至少可以编译旧的 cobol 源；如果编译的版本相同，则您知道源实际上是当前版本。

如果它们不同，您可以尝试（以某种方式）[反编译](http://en.wikipedia.org/wiki/Decompiler)，或至少[反汇编](http://en.wikipedia.org/wiki/Disassembler)，工作编译版本和新编译版本，并使用[差异工具](http://en.wikipedia.org/wiki/Diff)来了解有多大差异。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-01T18:12:24.933

疯狂的建议：COBOL DECOMPILER --> SOURCE --> NEW COBOL COMPILER...？

（编辑： http: [//juggersoft.com](http://juggersoft.com/order.htm) - PAID cobol 反编译器）

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-12-10T11:37:21.030

如果你有 .int （中间）二进制文件，你可以在新服务器上运行，如果没有，你必须重新编译它们。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2010-11-22T15:24:50.563

该程序可能由外部资源生成，并且该人或软件公司或组织可能在其存储库中拥有最新的源。如果您最近合并，它可能由您的上级组织持有，或者可能在您组织中的不同或备份计算机安装中。开发人员的用户帐户上可能有一份副本，但可能尚未发送到生产或现场站点，或者总部的某个人有一份副本来评估并尝试解决问题。如果给这些人打电话，您可能会成功，或者您可以随时与安装计算机操作员或支持人员交谈，看看他们是否在磁带、CDROM 或其他备份存储上保存了一个。

# asp.net - 直接将控件添加到 ASPX 页面、以编程方式加载控件和添加到占位符之间的行为有什么区别？

> ID：331663
> 
> 赞同：1
> 
> 时间：2008-12-01T18:01:41.133
> 
> 标签：asp.net, controls

直接将控件添加到 ASPX 页面和以编程方式加载控件并添加到占位符之间在行为上是否存在差异？

控件继承自`System.Web.UI.WebControls.DataBoundControl`.

我问的原因是当我将它添加到 ASPX 页面时，我有一个可以工作的控件，如下所示：

```
...
<blah:GoogleMap ID="GoogleMap1" runat="server" Width="640px" Height="600px" ... DataSourceID="_odsMarkers" DataAddressField="Address" DataTextField="Description">
</blah:GoogleMap>
... 
```

但不是当我在代码隐藏页面中使用以下内容时：

```
GoogleMap map = (GoogleMap)this.LoadControl(typeof(GoogleMap), new object[] { });
//... set properties
this.placeholder1.Controls.Add(map); //add to placeholder 
```

任何人都知道为什么会这样？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-01T18:28:54.247

如果您在标记中定义或以编程方式添加，则控制树最终会相同。然而，控制实施者有足够的空间来搞砸。

你可以去看看 ASP.NET 是如何编译 aspx 的：

```
C:\Windows\Microsoft.NET\Framework\v2.0.50727\Temporary ASP.NET Files 
```

将控件添加到页面的时间可能是一个问题。通常的模式是在 CreateChildControls 方法的重载中添加控件。如果控件需要解析视图状态，您需要确保在初始化期间调用它，例如通过调用 EnsureChildControls。

添加到忍者的调试提示。如果您以相同的方式添加标签，是否有任何区别。它出现了吗？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-01T19:09:11.387

这是用户控件还是服务器控件？

如果它是一个用户控件，它们应该通过它们的路径而不是它们的类型来加载：

```
GoogleMap map = (GoogleMap)this.LoadControl("~/Controls/GoogleMap.ascx"); 
```

如果它是服务器控制，那么您可以新建一个实例：

```
GoogleMap map = new GoogleMap(); 
```

在您拥有实例并将其添加到控制树（通过将其插入 PlaceHolder）之后，它应该执行与在标记中声明时相同的操作。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-01T18:14:03.340

如果您在 LoadControl 调用之外设置属性，为什么要创建新的空对象数组而不是仅使用具有一个参数的重载？

此外，如果您将调试器附加到它并单步执行，在调用 Controls.Add() 之前，您是否注意到控件有什么奇怪的地方？是否抛出异常？如果有，是哪一个？如果不是，浏览器中的标记在占位符所在的位置看起来像什么？

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-01T18:28:49.283

“Works”有点模棱两可，但如果你的意思是，事件处理程序永远不会执行，你需要在页面 onload 事件中加载它。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-12-01T19:27:01.930

如果控件需要使用 viewstate，您必须确保在 Page_Load 事件之前将其添加到页面，否则 viewstate 将不会被填充，并且最有可能的事件和其他项目将无法正常运行。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-05-09T09:33:48.347

一个重要的区别是，如果您动态创建控件，默认情况下，您不会从皮肤集中获得任何值。您必须手动调用 control.ApplyStyleSheetSkin(page)：http: [//msdn.microsoft.com/en-us/library/system.web.ui.control.applystylesheetskin.aspx](http://msdn.microsoft.com/en-us/library/system.web.ui.control.applystylesheetskin.aspx)

# javascript - 如何编写正则表达式以便模式可以按任何顺序出现？

> ID：331666
> 
> 赞同：2
> 
> 时间：2008-12-01T18:02:13.147
> 
> 标签：javascript, regex

我有以下非常简单的兼容 Javascript 的正则表达式：

```
<script type="text/javascript" id="(.+)" src="([^"]+)"> 
```

我正在尝试匹配脚本标签并收集 ID 和 src 属性。我想让属性的顺序无关紧要，以便以下内容仍然匹配：

```
<script id="..." type="text/javascript" src="...">
<script src="..." id="..." type="text/javascript">
<script id="..." src="..." type="text/javascript"> 
```

是否可以允许属性以任何顺序出现而不影响其收集匹配 ID 和 src 的能力？

*编辑*要匹配的字符串来自innerHTML，使得DOM 遍历成为不可能。此外，我不能为这个特定的应用程序使用任何第三方库。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-01T19:37:41.517

免责声明：注意正则表达式和 HTML 源代码。它很脆弱，因此很容易被破坏或规避，您甚至不应该考虑使用它来验证用户输入。

如果你对源数据有诚意并且知道它符合格式良好的 HTML 规则，你可以使用这个：

```
var html = "variable/property holding your html source";
var re_script = /<script\s.+?>/ig;
var re_id     = /id="(.*?)"/i;
var re_src    = /src="(.*?)"/i;

var scriptTag = null;
while (scriptTag = re_script.exec(html))
{
  var matchId  = re_id.exec(scriptTag);
  var matchSrc = re_src.exec(scriptTag);

  if (matchId && matchSrc)
  {
    var scriptId  = matchId[1];
    var scriptSrc = matchSrc[1];
    alert('Found script ID="' + scriptId + '", SRC="' + scriptSrc + '"');
  }
} 
```

基本上，这就是 jQuery`$("script").each()`会做的事情，只是没有 jQuery 并且不需要 DOM。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-01T18:17:05.020

这听起来像一个讨厌的正则表达式。IMO，您最好使用 xpath 来查询 DOM。或者，您也可以使用 jquery javascript 库来选择您需要的元素。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-01T18:20:00.660

您还可以使用 jQuery 尝试以下操作：

```
$("script").each(function() {
    var src = $(this).attr("src");
    var id = $(this).attr("id");

    alert(id + ": " + src);
}); 
```

这将比我的脚本解析正则表达式好得多。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-01T18:20:40.860

如果您需要获取文件的脚本标签，您是否可以不只使用[document.getElementsByTagName()](http://www.w3schools.com/htmldom/met_doc_getelementsbytagname.asp)然后检查（可能使用正则表达式）您需要的属性是否存在。

正则表达式*不是*制作解析器的好工具（至少不适用于 HTML 等宽泛的语法）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-01T18:16:50.917

尝试以下操作：

```
<script\s*\S*\s*(id="([^"]+)")?\s*\S*\s*(src="([^"]+)")\s*\S*\s*(id="([^"]+)")?[^>]*> 
```

由于您不关心类型，只需将其删除，因为它会使事情变得更加复杂。然后通过在 src 的任一部分添加两个可选 ID 来强制其余部分。

或者你可以做

```
<script\s*(([^=]*)="([^"]*)")+\s*> 
```

获取所有属性，然后在代码中选择您想要的属性。

# java - Java webapp的报表服务设计

> ID：331667
> 
> 赞同：0
> 
> 时间：2008-12-01T18:02:21.973
> 
> 标签：java, web-applications, reporting-services, reporting

一个设计问题。

今年早些时候，我开发了一个在线测试引擎网络应用程序。我使用了 Java servlet 和 Freemarker 模板，并且完全按照 MVC 范式完成了它。

该应用程序中的一大缺失功能是它不提供报告。由于各种限制，不一定是技术限制，应用程序的初始设计并未将报告视为核心的一部分。现在需要的报告服务应该使用户能够随时在线获取他们的报告并以预定义的格式下载它们。

应用程序已经发展到一个阶段，我不想往里面放更多的代码，想把核心模块隔离出来，围绕这个核心开发未来的需求。

**我想听听一些关于如何围绕核心应用程序继续开发此报告服务的想法。**

我还可以使用哪些报告工具？我过去使用过 Jasper，但听说 BIRT 也不错。提出你的建议。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-01T18:23:25.787

如果您有相当高级的要求，那么 Jasper 是一个不错的选择，例如：

*   支持深奥的格式
*   亲子报告
*   图表和图形

但是，如果您真的只需要以 HTML/PDF/XLS 等流行格式显示表格报告，那么只需使用[diplaytag](http://displaytag.sf.net/)就可以走很长的路，比 Jasper 所需的工作量要少得多。

一个简单的表格报表使用 displaytag 需要大约 20 行 JSP 代码，但使用 Jasper 的同一个报表需要大约 500 行 XML。在承诺使用 BIRT/Jasper 等“重量级报告解决方案”之前，我会调查 displaytag 是否可以满足您的要求。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-01T18:08:31.823

我会推荐 Jasper，因为我过去使用过它，并且发现它很容易配置和使用。可以将其集成到您的应用程序中而不会带来太多麻烦。

我只听说过关于[BIRT](http://www.eclipse.org/birt/phoenix/)的好消息，但我自己从未实施过。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-22T08:30:12.310

我会推荐艺术：[http](http://art.sourceforge.net/) ://art.sourceforge.net/ 。我们使用这个工具没有任何问题。它仍然是活动项目，因此如果您添加新功能，您可以添加对它的请求。

# asp.net - Asp.net Entity Framework 和生成的 SQL 问题

> ID：331671
> 
> 赞同：1
> 
> 时间：2008-12-01T18:02:47.777
> 
> 标签：asp.net, entity-framework

我对使用实体框架的以下 Linq 查询有疑问：

```
from o in ctx.Entity
where o.EntityID = entityid
select o; 
```

够简单吧？好吧，“实体”集是许多其他类的父类。为这个简单查询生成的 SQL 大约有 20K 个字符，其中包含大量“case”和“union”。除了框架编译查询需要一段时间外，执行也需要一段时间。

那么，在使用继承类进行查询的情况下，如何改进框架生成的 SQL 呢？或者我可以使用什么其他技术来避免这个问题？

广告

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-01T18:31:45.877

这样做的原因是实体与数据库中其他表的关系。为了减少这种情况，您需要阅读有关如何更好地控制 EF 为您执行的引用的显式/延迟加载

[http://blogs.msdn.com/jkowalski/archive/2008/05/12/transparent-lazy-loading-for-entity-framework-part-1.aspx](http://blogs.msdn.com/jkowalski/archive/2008/05/12/transparent-lazy-loading-for-entity-framework-part-1.aspx)

如果没有 nhibernate 插件，这样的帖子是不完整的，它更强大/更强大/性能更好/更易于使用 ;-) 但希望该链接能帮助你

# c++ - 在 C++ 源代码中使用 Unicode

> ID：331690
> 
> 赞同：61
> 
> 时间：2008-12-01T18:09:45.347
> 
> 标签：c++, unicode, character-encoding, standards

C++源代码的标准编码是什么？C++ 标准是否对此有所说明？我可以用 Unicode 编写 C++ 源代码吗？

例如，我可以在评论中使用汉字等非ASCII字符吗？如果是这样，是否允许完整的 Unicode 或只是 Unicode 的子集？（例如，那个 16 位的首页或其他任何名称。）

此外，我可以将 Unicode 用于字符串吗？例如：

```
Wstring str=L"Strange chars: âÂ Čšđ ě €€"; 
```

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2008-12-01T19:38:42.700

C++ 中的编码相当复杂。这是我对它的理解。

每个实现都必须支持来自*基本源字符集*的字符。其中包括第 2.2/1 节（C++11 中的第 2.3/1 节）中列出的常见字符。这些字符都应该合而为一`char`。此外，实现必须支持一种命名其他字符的方法，该方法使用名为`universal-character-names`and look like `\uffff`or `\Uffffffff`and 的方式来指代 Unicode 字符。它们中的一个子集可用于标识符（在附件 E 中列出）。

这一切都很好，但是从文件中的字符到源字符（在编译时使用）的映射是实现定义的。这构成了所使用的编码。这是它的字面意思（C++ 98 版本）：

> 如有必要，物理源文件字符以实现定义的方式映射到基本源字符集（为行尾指示符引入换行符）。三元字符序列（2.3）被相应的单字符内部表示代替。任何不在基本源字符集 (2.2) 中的源文件字符都将替换为指定该字符的通用字符名。（实现可以使用任何内部编码，只要处理源文件中遇到的实际扩展字符，以及源文件中表示为通用字符名称的相同扩展字符（即使用 \uXXXX 表示法）等价的。）

对于 gcc，您可以使用选项更改它`-finput-charset=charset`。此外，您可以更改用于在运行时表示值的执行字符。正确的选项是`-fexec-charset=charset`char （默认为`utf-8`）和`-fwide-exec-charset=charset`（默认为`utf-16`或`utf-32`取决于 的大小`wchar_t`）。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2008-12-01T18:26:21.443

据我所知，C++ 标准没有说明源代码文件编码。

通常的编码是（或曾经是）7 位 ASCII ——一些编译器（例如 Borland 的）会拒绝使用高位的 ASCII 字符。没有技术原因不能使用 Unicode 字符，如果你的编译器和编辑器接受它们——大多数现代的基于 Linux 的工具，以及许多更好的基于 Windows 的编辑器，都可以毫无问题地处理 UTF-8 编码，尽管我'不确定微软的编译器会。

编辑：看起来微软的编译器会接受 Unicode 编码的文件，但有时也会在 8 位 ASCII 上产生错误：

```
warning C4819: The file contains a character that cannot be represented
in the current code page (932). Save the file in Unicode format to prevent
data loss. 
```

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2008-12-03T15:03:03.270

除了 litb 的帖子，MSVC++ 也支持 Unicode。我知道它从 BOM 中获取 Unicode 编码。它绝对支持代码，`int (*♫)();`或者`const std::set<int> ∅;` 如果你真的很喜欢代码混淆：

```
typedef void ‼; // Also known as \u203C
class ooɟ {
    operator ‼() {}
}; 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2008-12-02T00:14:49.227

这里有两个问题。首先是 C++ 代码（和注释）中允许使用的字符，例如变量名。第二个是字符串和字符串文字中允许使用的字符。

如前所述，对于代码和注释中允许的字符，C++ 编译器**必须**支持非常受限的基于 ASCII 的字符集。在实践中，这个字符集不能很好地与一些欧洲字符集（尤其是一些没有几个字符的欧洲键盘——比如方括号——可用）配合使用，所以二合字母和三合字母的概念是介绍了。许多编译器此时接受的字符集不止这个字符集，但没有任何保证。

至于字符串和字符串字面量，C++有宽字符和宽字符串的概念。但是，该字符集的编码是未定义的。实际上，它几乎总是 Unicode，但我认为这里没有任何保证。宽字符串文字看起来像 L“字符串文字”，它们可以分配给 std::wstring。

* * *

C++11 添加了对 Unicode 字符串和字符串文字的显式支持，编码为 UTF-8、UTF-16 大端、UTF-16 小端、UTF-32 大端和 UTF-32 小端。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2008-12-01T18:26:42.130

对于字符串中的编码，我认为您应该使用**\u**表示法，例如：

```
std::wstring str = L"\u20AC"; // Euro character 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-12-01T19:51:50.647

还值得注意的是，C++ 中的宽字符并不是真正的 Unicode 字符串。它们只是较大字符的字符串，通常为 16 位，但有时为 32 位。这是实现定义的，但是，IIRC 你可以有一个 8 位`wchar_t`你不能真正保证它们中的编码，所以如果你试图做一些像文本处理这样的事情，你可能需要一个最合适的 typedef Unicode 实体的整数类型。

C++1x 以 UTF-8 编码字符串文字 ( `u8"text"`)、UTF-16 和 UTF-32 数据类型 (`char16_t`和`char32_t`IIRC ) 以及相应的字符串常量 (`u"text"`和`U"text"`) 的形式提供额外的 unicode 支持。`\uxxxx`但是，没有或常量指定的字符的编码`\Uxxxxxxxx`仍然是实现定义的（并且没有对文字之外的复杂字符串类型的编码支持）

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2012-08-23T03:10:58.187

在这种情况下，如果您收到 MSVC++ 警告 C4819，只需将源文件编码更改为“UTF-8 with Bom”即可。

GCC 4.1 不支持这个，但是 GCC 4.4 支持，并且最新的 Qt 版本使用的是 GCC 4.4，所以使用“UTF-8 with Bom”作为源文件编码。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-12-01T18:27:16.683

AFAIK 它不是标准化的，因为您可以将任何类型的字符放在宽字符串中。您只需检查您的编译器是否设置为 Unicode 源代码以使其正常工作。

# algorithm - 从名称和地址数据创建一个 id。哈希/摘要

> ID：331695
> 
> 赞同：4
> 
> 时间：2008-12-01T18:13:19.987
> 
> 标签：algorithm, hash, digest

我的问题：

我正在寻找一种将人的姓名和地址表示为编码 id 的方法。id 应仅包含字母数字字符，防冲突，并以尽可能少的字符数表示。我的第一个想法是简单地使用像 MD5 或 SHA1 这样的加密哈希函数，但这似乎有点矫枉过正（安全性并不重要 - 不需要是单向的），我更愿意找到能产生较短的身份证。有谁知道适合这个问题的现有算法？

换句话说，实现以下函数的最佳方法是什么，以使相同输入的返回值始终相同，不太可能发生冲突，并且 id 小于 20 个字符？

```
>>> make_fake_id(fname = 'Oscar', lname = 'Grouch', stnum = '1', stname = 'Sesame', zip = '12345')
N1743123734 
```

应用程序上下文（对于那些感兴趣的人）：

这将用于[记录链接应用程序](http://en.wikipedia.org/wiki/Record_linkage_problem)。给定一个输入名称和地址，我们在一个非常大的数据库中搜索最佳匹配并返回数据库 id 和其他数据（我们如何做到这一点在这里并不重要）。如果没有匹配项，我需要从搜索输入（实体的名称和地址数据）生成这个伪/生成/派生的 id。每条搜索记录都应该产生一个输出记录，其中要么是真实的（匹配/链接产生的实际数据库 id），要么是这个生成的伪/生成/派生 id。伪 id 将以一个字符（例如 N）作为前缀，以将其与真实 id 区分开来。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-01T18:23:58.313

我知道你对 MD5 和 SHA1 说不，但我认为你还是应该考虑它们。除了经过充分研究的散列算法外，长度还可以为您提供更多防止可能发生的冲突的保护。没有哈希是防冲突的，但加密的通常比你自己想出的更不容易发生冲突。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-03T07:03:00.930

*   使用加密散列是因为它的[抗碰撞性](http://en.wikipedia.org/wiki/Hash_collision#Collision_resistance)，而不是它的其他特性。
*   使用尽可能多的哈希字节（截断）
*   转换为字母数字字符
*   您还可以截断字母数字字符串而不是哈希

一种简单的方法：散列数据，以 base64 编码，删除所有非字母数字字符，截断。

```
N_HASH_CHARS = 11
import hashlib, re
def digest(name, address):
  hash = hashlib.md5(name + "|" + address).digest().encode("base64")
  alnum_hash = re.sub(r'[^a-zA-Z0-9]', "", hash)
  return alnum_hash[:N_HASH_CHARS] 
```

您应该保留多少个字母数字字符？每个字符为您提供大约 5.95 位的熵 (log(62,2))。11 个字符为您提供 65.5 位的熵，这足以避免前 2**32.7 个用户（约 70 亿）的冲突。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-02T14:40:02.927

我同意另一张建议序列号的海报。OTOH，如果您真的，真的真的想做其他事情：

从数据中创建一个 SHA1 哈希，并将其存储在带有序列号字段的表中。

然后，当你得到数据，计算哈希，查表，得到序列号，这就是你的id。如果它不在桌子上，请将其插入。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-01T18:52:35.463

我想知道您是否打算将这些 ID“分配”给用户？如果是这样，我希望您的用户讨厌您提出的任何建议；谁会想要“AAAAA01”的用户 ID？

因此，如果这些 id 对用户可见，那么您应该让他们选择他们喜欢的并检查它们的唯一性（简单）。如果它们对用户不可见（例如，内部主键），那么只需使用适当的技术（如 Oracle 序列或 SQL Server 自动编号）按顺序生成它们（也很容易）。

如果这些 id 试图检测注册多次的用户，那么我同意您应该考虑加密哈希，然后对注册数据（姓名、地址等）进行完整比较。但是，为了可用，您需要在计算散列或进行比较之前将数据转换为规范形式（标准化字母大小写、空格、规范街道地址等）。否则，您将基于微不足道的差异而失配。

编辑：现在我根据您的编辑更好地理解了问题空间，我认为您的算法（到目前为止）不太可能捕获大多数匹配项。除了我对输入进行规范化的建议之外，我建议您考虑一种方法，该方法会产生少数可能匹配的排名列表（如果可能，由人工解决），而不是在单个匹配上尝试全有或全无. 换句话说，我推荐一种搜索方法而不是查找方法。

在你的情况下这可行吗？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-01T18:57:48.430

一个好的解决方案在某种程度上取决于您的应用程序。你知道有多少用户以及所有用户的集合是什么吗？如果您提供更多详细信息，您将获得更好的帮助。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2008-12-01T18:24:27.860

好吧，如果在同一个地址有多个同名的人，你就完蛋了，（不添加代码来检测这一点并添加某种鉴别器）。

但假设不是这个问题，那么完整地址的街道地址和邮政编码部分足以保证那里的唯一性，因此从名称中添加足够的数据应该可以解决这个问题......

您是否有权访问数据库或其他持久性机制，您可以在其中为每个地址生成和维护键值？然后将地址和各个实体保存在两个键控字典结构中，其中键是为每个新的不同地址、遇到的人自动生成的……然后使用自动生成的字母数字键……

```
You could use AAAAA01  for first person at first address,
              AAAAA02 for second person at first address,
              AAAAB07 for the seventh resident at the second adresss, etc. 
```

如果您没有任何方法来生成和维护这些实体键映射，那么您需要使用完整的街道地址/Zip 和 fullNAme，或者相同的哈希值，尽管哈希值方法生成重复的可能性很小。 ..

# asp.net - 引起 VSTS 问题的 ASP.NET 架构表

> ID：331702
> 
> 赞同：15
> 
> 时间：2008-12-01T18:17:19.450
> 
> 标签：asp.net, gdr

安装 VSTS 数据库 GDR 并导入包含 ASP.NET 提供程序架构表的 SQL Server 2005 数据库后，我收到以下警告：

TSD04151：过程：[dbo].[aspnet_Users_DeleteUser] 对对象 [dbo].[sysobjects].[name] 有一个未解析的引用。

TSD04151：过程：[dbo].[aspnet_Users_DeleteUser] 对对象 [dbo].[sysobjects] 有一个未解析的引用。

TSD04151：过程：[dbo].[aspnet_AnyDataInTables] 具有对对象 [dbo].[sysobjects].[type] 的未解析引用。

TSD04151：过程：[dbo].[aspnet_Users_DeleteUser] 对对象 [dbo].[sysobjects].[type] 的引用未解析。

TSD04151：过程：[dbo].[aspnet_AnyDataInTables] 对对象 [dbo].[sysobjects] 的引用未解析。

TSD04151：过程：[dbo].[aspnet_AnyDataInTables] 对对象 [dbo].[sysobjects].[name] 具有未解析的引用。

有谁知道如何摆脱这些警告？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2008-12-18T14:37:52.800

我不确定，但快速浏览似乎揭示了以下内容。脚本中的违规行似乎是：

过程 [dbo].[aspnet_Users_DeleteUser] 中的第 42 行 ~~（您如何在此处使用下划线？）~~ *（如：\_）*

(EXISTS (SELECT name FROM **sysobjects** WHERE (name = N'vw_aspnet_MembershipUsers') AND (type = 'V'))))

系统视图 sysobjects 属于内置系统模式“sys”，它不包含在数据库项目中。结果，数据库项目解析器（错误地）认为引用未解析。

我认为您无能为力，只能选择忽略项目设置中的警告。（请注意，这也会对您隐藏真正的错误。）我可能会忽略这些警告。

**更新：** 尝试添加对以下内容的引用：

C:\Program Files\Microsoft Visual Studio 9.0\VSTSDB\Extensions\SqlServer\2008\DBSchemas\master.dbschema

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-27T18:30:14.873

金在上面的回答非常适合我要求的情况。但是，我还发现您可以过滤每个文件的构建警告。看看[http://blogs.msdn.com/gertd/archive/2009/01/11/file-level-build-warning-suppression-in-the-gdr.aspx](http://blogs.msdn.com/gertd/archive/2009/01/11/file-level-build-warning-suppression-in-the-gdr.aspx)

# .net - 如何在 WPF RichTextBox 中忽略拼写

> ID：331707
> 
> 赞同：0
> 
> 时间：2008-12-01T18:19:13.750
> 
> 标签：.net, wpf

我正在使用 WPF RichTextBox 的内置拼写检查，并希望忽略某些文本运行的拼写错误（经过验证的路径）。这样做的最佳方法是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-12-01T18:21:15.197

由于字典目前不可扩展，因此我通过将语言设置为“无”来实现此行为。

# javascript - ASP.NET 中的 ExtJS 和 jQuery

> ID：331714
> 
> 赞同：4
> 
> 时间：2008-12-01T18:22:35.070
> 
> 标签：javascript, jquery, asp.net, user-interface, extjs

我看过一些帖子，其中 jQuery 与 ExtJS 相比更受青睐。我没有详细研究过 jQuery，但从我目前所读到的内容来看，jQuery 并没有提供 ExtJS 附带的那种 ​​UI。我对么？为什么你们中的一些人更喜欢 ASP.NET 中的 jQuery？

谢谢

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-12-10T16:35:19.710

为什么不两者都用？ExtJS 也允许你使用 jQuery。事实上，您可以轻松地配置 ExtJS 以使用 jQuery 来实现其核心功能。我以前做过，而且效果很好。

这样你就可以愉快地使用两全其美的东西。

[http://extjs.com/forum/showthread.php?t=29702&highlight=jquery](http://extjs.com/forum/showthread.php?t=29702&highlight=jquery)

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-12-01T18:28:17.087

javascript 框架有两种流派，一种专注于小部件（Yui、ext 等），一种专注于行为（jquery、prototype、moo 等）

JQuery 只是让构建动态、性感的网站变得更容易。如果你只是在做 system.draggy.droppy asp 开发，你可以忽略两者，因为你可能根本没有真正接触过 javascript。但是，如果您确实使用 javascript，那么值得您花时间学习其中一个框架，而 jquery 目前是最流行的。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-12-10T16:13:31.173

事实上，Ext 提供了一站式服务。

它具有提供行为的坚实基础。事件发布/订阅、效果、DOM 操作等。它可以通过自己的独立基础提供这些，或者通过包装您选择的基础库（如 jQuery）

然后在那个跨库基础层的 TOP 上，它提供了一组统一的组件，这些组件都源自一个 Component 基类。它提供响应浏览器几何变化的托管屏幕布局和组件的托管生命周期管理。

没有什么比得上它。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-10T16:28:18.647

jQuery 确实有一个小部件库——它相当新，但很酷。它只能变得更好！ [jQuery 用户界面](http://ui.jquery.com/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-03T13:25:31.747

iam 对 extjs 有经验，对 jquery 更新鲜。jquery 比 extjs 重量轻。

## 关于 JQUERY：

易于使用，快速，出色的 DOM 操作，良好的效果。很棒的 window.onLoad 处理程序。

## 关于 EXTJS：

Ivery 非常广泛，出色的 DOM 操作，可靠的效果。在命令行上费解时最快完成任务。

# internet-explorer - IE7 打开 mp3 时出现 Quicktime 错误，带有问号的图标

> ID：331716
> 
> 赞同：0
> 
> 时间：2008-12-01T18:23:39.483
> 
> 标签：internet-explorer, browser, mp3, quicktime

我遇到了一些 Internet Explorer 7（和 8 beta）浏览器特有的问题，其中包含指向 MP3 的链接。

当我在 IE7 中单击链接时，会打开一个新的浏览器窗口，并且 quicktime 插件会尝试播放该文件。我看到的不是播放器，而是一个褪色的 Quicktime 图标，中间有一个问号。 [替代文字 http://img87.imageshack.us/img87/6871/quicktimeeh4.jpg](http://img87.imageshack.us/img87/6871/quicktimeeh4.jpg)

该文件没有任何问题。

quicktime 播放器在 FireFox3、Safari 和 Chrome 中打开并正确播放文件。

我已经在几台不同的计算机上使用 IE7 进行了尝试，但总是失败。

我徒劳地搜索了其他论坛以找到解决方案。我已经看到了从更改注册表设置到重新安装 IE 的建议（没有帮助）。

这是链接文件的确切 HTML：

```
<a onmouseover="window.status=''; return true;" target="_blank"name="Filename_Lnk" href="polka.mp3">
  Lawrence Welk
</a> 
```

带有链接和文件的网页都位于您必须登录的网站内。

我唯一的想法是 IE 通过在新浏览器中打开文件以某种方式丢失了会话。FF 处理得很好。

我希望能够告诉我的用户如何配置 IE，以便此文件在 Windows Media Player 而不是 Quicktime 中打开。

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-30T06:19:57.057

您需要在控制面板中重新配置 QuickTime 的文件关联，使其*无法*在浏览器中播放 MP3。

当然，您也可以发布一个链接，让他们下载文件然后播放——这样更有可能奏效。

最后，您可以使用基于[Flash 的 MP3 播放器](http://www.flashmp3player.org/demo.html)，或者重新编码文件并将其嵌入到可以自动播放的 Flash 中。

# php - joomla中密码提醒的好组件

> ID：331717
> 
> 赞同：1
> 
> 时间：2008-12-01T18:23:46.223
> 
> 标签：php, joomla

我想更改 Joomla 密码提醒机制的默认行为。我希望能够检查密码的**强度**和（可选）验证码功能。我想知道是否有一个免费的 Joomla 组件，我可以安装和使用开箱即用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-02T05:22:09.327

如果您不介意修改核心代码，那么您可以查看该`components\com_user\controller.php`文件。在`save()`函数中，大约在第 82 行，它检索用户的密码。此时，您可以插入任何您喜欢的代码来检查密码强度：

```
$passOK = true;
if($post['password'] != $post['password2']) {
    $msg = JText::_('PASSWORDS_DO_NOT_MATCH');
    $passOK = false;
} else if (strlen($post['password']) < 6 || !preg_match("/[0-9]/", $post['password'])) {
    $msg = "The password is too short, or it doesn't contain any numbers.";
    $passOK = false;
}
if (!$passOK) {
    $return = @$_SERVER['HTTP_REFERER'];
    if (empty($return) || !JURI::isInternal($return)) {
        $return = JURI::base();
    }
    $this->setRedirect($return, $msg, 'error');
    return false;
} 
```

# .net - 视图状态 MAC 验证失败

> ID：331720
> 
> 赞同：1
> 
> 时间：2008-12-01T18:24:17.203
> 
> 标签：.net, asp.net, iis, .net-3.5, viewstate

我目前收到此错误：

> 视图状态 MAC 验证失败。如果此应用程序由 Web Farm 或集群托管，请确保`<machineKey>`配置指定相同的 validationKey 和验证算法。AutoGenerate 不能在集群中使用。

我找到了多种解决此错误的方法。我们目前使用的解决方案是在机器级别添加静态 MachineKey 字段，并使用静态验证密钥和解密密钥。

```
<MachineKey validationKey="" decryptionKey="" validation="SHA1" decruption="AES" /> 
```

此解决方案是否适用于 .NET 3.5？有没有更优雅的解决方案？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-01T18:27:42.937

您的网络应用程序是否托管在网络农场中？

如果是这样，原因是页面由服务器1渲染，并发布到服务器2。因此，机器密钥不同，验证失败。

它也适用于 ASP.NET 3.5。

# html - 无法使 HTML 链接中的切片重复以扩展

> ID：331723
> 
> 赞同：1
> 
> 时间：2008-12-01T18:26:19.633
> 
> 标签：html, outlook, templates

我试图插入带有电子邮件（Outlook）的html图像以另存为模板。我发现有一个应该重复的切片无法正常工作（使颜色扩展到文本结束的位置）。有没有人可以在这件事上帮助我？下面是我正在使用的编码。

```
<HTML>
  <HEAD>
    <TITLE>Ticket Closure Notice</TITLE>
    <META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=iso-8859-1">
  </HEAD>

 <BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" TOPMARGIN="0" MARGINWIDTH="0" MARGINHEIGHT="0">
   <TABLE WIDTH="100%" BORDER="0" CELLPADDING="0" CELLSPACING="0">
     <TR>
       <TD width="114" valign="top"><IMG SRC="http://intranet.ca.state.gov/email_templates/images/left_bar_outages_advisory.gif"></TD>
       <TD valign="top" width="100%">

         <TABLE WIDTH=100% height="100%" BORDER=0 CELLSPACING=0 CELLPADDING=0>
           <TR>
             <TD height="128" bordercolor="#FFFFFF" background="images on server 2/top_bar_advisory_tile.gif">
               <img src="images on server 2/top_bar_advisory.gif" width="157" height="128"></TD>
           </TR>
           <TR>
             <TD height="100%" bordercolor="#FFFFFF"><br>
               <br></TD>
           </TR>
           <TR>
             <TD align="right" height="74"><br>
               <hr style="BORDER-RIGHT: gray 1px solid; BORDER-TOP: gray 1px solid; BORDER-LEFT: gray 1px solid; WIDTH: 100%; BORDER-BOTTOM: gray 1px solid; HEIGHT: 1px; TEXT-ALIGN: right">
               <a href="http://caweb/doweb"><img src="http://intranet.ca.state.gov/email_templates/images/CA-CST-lg.gif" width="144" height="52" border="0"></a></TD>
           </TR>
         </TABLE>

         </TD>
      </TR></TABLE>
  </BODY>
</HTML> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-01T18:35:21.970

有各种样式属性在 Outlook（和其他邮件客户端）中不起作用。

这是一个很好的指南： http: [//www.campaignmonitor.com/css/](http://www.campaignmonitor.com/css/)

# .net - 如何在其事件中引用控件？（不使用它的名字）

> ID：331731
> 
> 赞同：0
> 
> 时间：2008-12-01T18:28:41.297
> 
> 标签：.net, vb.net

.net 中是否有一种方法可以通用地引用控件（这样如果控件名称发生更改等），您就不会遇到问题。

即，“me”关键字的对象级版本。

所以，我想在下面的示例中使用通用的东西而不是 RadioButton1。

```
Private Sub RadioButton1_CheckedChanged(ByVal sender As System.Object, _
       ByVal e As System.EventArgs) Handles RadioButton1.CheckedChanged

        If RadioButton1.Checked Then 
           Beep()

End Sub 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-12-01T18:30:02.793

是的，“sender”参数是触发事件的控件。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-01T18:31:15.147

让我们看看我是否记得 VB.NET：

```
Dim rb as RadioButton = sender
If rb.Checked Then... 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-01T18:30:11.373

您可以选择事件的名称。您可以使用事件窗口（在属性窗口旁边）或在代码中执行此操作。你总是选择这个名字。您可以简单地使用“checkedEvent”。

```
this.checkbox.EventXYZ += new EventXZY(checkedEvent); 
```

在此方法中，您可以使用发件人对象并将其投射到 (CheckBox) 并使用它的属性...和行为...

```
public ... checkedEvent(object sender,...)
    ((RadioButton)sender)..... 
```

您可以找到一篇很棒的**[文章](http://visualbasic.about.com/library/bldyk-netc1-a.htm)**，它将在 VB.NET 中通过 TextBox 事件向您解释所有内容（他有几个文本框，并且只有一种方法来处理它们：

[![替代文字](https://i.stack.imgur.com/rGAgz.png)](https://i.stack.imgur.com/rGAgz.png)
[（来源：[clip2net.com](http://clip2net.com/clip/m12122/1228156822-clip-4kb.png)）]

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-12-01T18:51:24.840

如果您只有一个触发事件处理程序的控件，则没有理由概括代码，因此您不必引用按钮的实际名称。如果控件不存在，编译将中断。

但是，如果您有多个控件连接到同一个事件处理程序，那么您应该使用传递给处理程序的第一个参数（发送方）。现在，您可以对触发事件的任何控件执行通用操作：

```
Private Sub rbtn_CheckedChanged(ByVal sender As Object, ByVal e As System.EventArgs)
    Dim rbtn As RadioButton = TryCast(sender, RadioButton)
    If rbtn IsNot Nothing Then
        If rbtn.Checked Then
            rbtn.Text = rbtn.Text & "(checked)"
        End If
    End If
End Sub 
```

# java - JPA 多个嵌入式字段

> ID：331744
> 
> 赞同：84
> 
> 时间：2008-12-01T18:31:39.280
> 
> 标签：java, hibernate, jpa, jakarta-ee

JPA 实体类是否可以包含两个嵌入的 ( `@Embedded`) 字段？一个例子是：

```
@Entity
public class Person {
    @Embedded
    public Address home;

    @Embedded
    public Address work;
}

public class Address {
    public String street;
    ...
} 
```

在这种情况下， a`Person`可以包含两个`Address`实例 - home 和 work。我将 JPA 与 Hibernate 的实现一起使用。当我使用 Hibernate Tools 生成模式时，它只嵌入了一个`Address`. 我想要的是两个嵌入式`Address`实例，每个实例的列名都有区别或前缀有一些前缀（例如 home 和 work）。我知道`@AttributeOverrides`，但这需要单独覆盖每个属性。如果嵌入对象 ( `Address`) 变得很大，因为需要单独覆盖每一列，这会变得很麻烦。

* * *

## 回答 #1

> 赞同：89
> 
> 时间：2012-02-12T05:18:25.463

通用的 JPA 方法是使用 @AttributeOverride。这应该适用于 EclipseLink 和 Hibernate。

```
@Entity 
public class Person {
  @AttributeOverrides({
    @AttributeOverride(name="street",column=@Column(name="homeStreet")),
    ...
  })
  @Embedded public Address home;

  @AttributeOverrides({
    @AttributeOverride(name="street",column=@Column(name="workStreet")),
    ...
  })
  @Embedded public Address work;
  }

  @Embeddable public class Address {
    @Basic public String street;
    ...
  }
} 
```

* * *

## 回答 #2

> 赞同：29
> 
> 时间：2008-12-01T19:09:07.520

如果您想在同一个实体中拥有相同的可嵌入对象类型两次，默认的列名将不起作用：至少其中一个列必须是显式的。Hibernate 超越了 EJB3 规范，允许您通过 NamingStrategy 增强默认机制。DefaultComponentSafeNamingStrategy 是对默认 EJB3NamingStrategy 的一个小改进，即使在同一实体中使用两次，它也允许默认嵌入对象。

来自休眠注释文档：[http ://docs.jboss.org/hibernate/stable/annotations/reference/en/html_single/#d0e714](http://docs.jboss.org/hibernate/stable/annotations/reference/en/html_single/#d0e714)

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2016-03-16T18:14:39.630

使用 Eclipse Link 时，使用 AttributeOverrides 的替代方法是使用 SessionCustomizer。这一次性解决了所有实体的问题：

```
public class EmbeddedFieldNamesSessionCustomizer implements SessionCustomizer {

@SuppressWarnings("rawtypes")
@Override
public void customize(Session session) throws Exception {
    Map<Class, ClassDescriptor> descriptors = session.getDescriptors();
    for (ClassDescriptor classDescriptor : descriptors.values()) {
        for (DatabaseMapping databaseMapping : classDescriptor.getMappings()) {
            if (databaseMapping.isAggregateObjectMapping()) {
                AggregateObjectMapping m = (AggregateObjectMapping) databaseMapping;
                Map<String, DatabaseField> mapping = m.getAggregateToSourceFields();

                ClassDescriptor refDesc = descriptors.get(m.getReferenceClass());
                for (DatabaseMapping refMapping : refDesc.getMappings()) {
                    if (refMapping.isDirectToFieldMapping()) {
                        DirectToFieldMapping refDirectMapping = (DirectToFieldMapping) refMapping;
                        String refFieldName = refDirectMapping.getField().getName();
                        if (!mapping.containsKey(refFieldName)) {
                            DatabaseField mappedField = refDirectMapping.getField().clone();
                            mappedField.setName(m.getAttributeName() + "_" + mappedField.getName());
                            mapping.put(refFieldName, mappedField);
                        }
                    }

                }
            }

        }
    }
}

} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2017-03-25T15:38:09.073

如果您使用的是 hibernate，您还可以使用不同的命名方案，为相同的嵌入字段的列添加唯一的前缀。请参阅[自动为 @Embeddable 类的列名添加前缀](https://stackoverflow.com/questions/3046677/automatically-add-a-prefix-to-column-names-for-embeddable-classes/43018343#43018343)

# java - 如何禁用 Eclipse (3.3.2) 警告：对封闭构造函数的访问...由合成访问器方法模拟

> ID：331751
> 
> 赞同：5
> 
> 时间：2008-12-01T18:34:16.153
> 
> 标签：java, eclipse, ide

我在一个大型项目上工作，并希望禁用 Eclipse 编译器警告说明：

> 对封闭构造函数的访问...由合成访问器方法模拟。提高其知名度将提高您的绩效

Eclipse 版本 3.3.2

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-12-01T18:51:16.230

从 Window–Preferences 菜单中，浏览到 Java–Errors/Warnings 面板。展开“代码样式”设置，并将“访问封闭类型的不可访问成员：”选项设置为“忽略”。

# tomcat - 如何设置 TeamCity 以通过 https 进行公共访问？

> ID：331755
> 
> 赞同：16
> 
> 时间：2008-12-01T18:36:12.843
> 
> 标签：tomcat, teamcity, reverse-proxy

如何设置 TeamCity 4.0 以便我可以通过 Internet 上的端口 443 访问它？例如[https://teamcity.mydomain.com](https://teamcity.mydomain.com)

我在安装 TeamCity 的同一台服务器上运行 IIS 7。我看到两个选项：

1.  设置 TeamCity 以使用端口 8443 并在 IIS 中创建一个反向代理，该代理将发送到 TeamCity 公共 IP 地址的请求路由到内部 IP 地址上的 Tomcat 端口。

2.  将 Tomcat 设置为在与 IIS 7 不同的 IP 地址上运行，并将 TeamCity 配置为在端口 443 上运行。

我不确定这两个步骤的细节。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-12-11T19:36:27.923

它需要为 https 配置捆绑的 Tomcat 服务器。看这里：

[http://confluence.jetbrains.net/display/TCD65/Using+HTTPS+to+access+TeamCity+server](http://confluence.jetbrains.net/display/TCD65/Using+HTTPS+to+access+TeamCity+server)

和这里：

[http://tomcat.apache.org/tomcat-6.0-doc/ssl-howto.html](http://tomcat.apache.org/tomcat-6.0-doc/ssl-howto.html)

我还将 Tomcat 设置为仅侦听一个 IP 地址。所有这一切都变成了真正的痛苦，我仍然无法将 TeamCity 作为服务运行。我只能在命令行运行它。如果我要重新执行此操作，我将安装 TeamCity 以在默认端口上运行，并使用[IIS7 应用程序请求路由](http://learn.iis.net/page.aspx/489/using-the-application-request-routing-module/)或 Apache 虚拟目录对其进行反向代理。

[编辑] 我已经完成了，我使用 IIS 应用程序请求路由来设置反向代理。它运行良好，Team City 升级也很轻松。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-16T00:25:51.710

如果您不期望高服务器负载，您可以避免使用 IIS 或 Apache，并在 Tomcat 中启用 SSL。这更易于配置。唯一的缺点是当客户端连接到服务器时（在协商阶段）CPU 使用率很高，之后 CPU 使用率可以忽略不计。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-29T22:04:09.150

确保您还使用加载这两个模块

```
LoadModule proxy_module bin/mod_proxy.so 
LoadModule proxy_http_module bin/mod_proxy_http.so

ProxyPass /TeamCity http://localhost/TeamCity
ProxyPassReverse /TeamCity http://localhost/TeamCity 
```

# eclipse - 如何关闭 Eclipse 中的哔声？

> ID：331757
> 
> 赞同：14
> 
> 时间：2008-12-01T18:36:50.407
> 
> 标签：eclipse, flexbuilder

在 Mac OS X 上，我正在运行 Flex Builder（它基本上是一个定制的 Eclipse）。当我执行查找时，如果找不到选定的文本并且将搜索包装到顶部，它会发出哔哔声。

是否可以关闭该哔声？我搜索了互联网和首选项窗格无济于事。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2011-07-05T12:45:20.497

通过将“哔”声设置为静音 .wav 文件，我设法绕过了 Windows 上的 Eclipse 默认“运行哔”

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-01-14T00:16:59.223

您可以通过在 Mac OS 声音首选项（声音 -> 声音效果 -> 警报音量）中调低系统范围内的警报音量来摆脱它。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2011-10-30T22:35:38.433

在 Linux 上，您可以通过将 pcspkr 模块列入黑名单来禁用同样的（烦人的）哔声。

然而，这些都不是问题的解决方案。当人们询问如何在一个特定应用程序中为一项特定功能禁用警报哔声时，在系统范围内禁用警报哔声可能不是他们想要做的。

如果我做饭时烟雾报警器一直让我烦恼，那么我可以断开它，但这可能不是最好的解决方案......

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2013-04-20T06:12:28.947

假设您正在运行某种 X Windows 衍生产品，请从终端运行这两个命令：

*   `xset b off`
*   `xset b 0 0 0`

您可以将这些添加到您的`.xinitrc`或`.bashrc`保证在每次系统重新启动时禁用。

[原始来源](http://ubuntuforums.org/showthread.php?t=126746)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2020-11-21T01:28:13.290

与将“哔”声更改为无声 .wav 文件的解决方案相比，我找到了更好的解决方案。

**设置 -> 系统 -> 声音 -> 应用音量和设备偏好设置（一直向下滚动） -> 系统声音 -> 将其滑到 0**

我在 Windows 10 上，它对我有用。每当我输入 = 给变量赋值时，我都会听到哔声。

# version-control - 有没有一种简单的方法可以恢复整个 P4 更改列表？

> ID：331758
> 
> 赞同：13
> 
> 时间：2008-12-01T18:37:04.417
> 
> 标签：version-control, perforce

假设我签入了包含大量文件的更改列表（在 Perforce 中），并且我想恢复整个更改列表。有没有一种简单的方法可以一举“恢复”整个变更列表？

目前我对更改列表中的每个文件都执行以下操作：

*   p4 sync //path/to/file#n（其中“n”是文件的先前版本）
*   cp 文件文件#n
*   p4同步//路径/到/文件
*   p4 编辑//路径/到/文件
*   cp 文件#n 文件
*   rm文件#n

正如您可以想象的那样，这对于大型变更列表来说非常麻烦。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-12-01T22:22:54.600

发布的答案提供了正确的答案，但还要注意 P4V 中有一个实际的菜单选项现在可以为您执行此操作。它在最新的 2008.2 Beta 中，因此应该会在接下来的一周或三周内正式发布。

此[链接](http://www.perforce.com/perforce/downloads/beta/index.html)提供详细信息。

它应该比之前的答案简单得多，但我还没有机会亲自尝试。

**更新**这现已完全发布。请参阅[Perforce 下载](http://www.perforce.com/perforce/downloads/index.html)。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-01T19:01:40.577

[这](http://www.tilander.org/aurora/2007/06/reverting-a-perforce-changelis.html)看起来很有趣。我没有亲自尝试过。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-01T21:26:16.993

Perforce 的官方答案位于[http://kb.perforce.com/UserTasks/ManagingFile..Changelists/RevertingSub..Changelists](http://kb.perforce.com/UserTasks/ManagingFile..Changelists/RevertingSub..Changelists)但该过程并不比您建议的要容易得多。@ya23 建议的脚本看起来更好。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-11-19T18:50:14.470

出于某种原因，awk 步骤对我不起作用。我正在使用模拟的 Unix 命令行工具从 Windows 环境中运行。但是，以下方法确实有效：

```
p4 describe -s [changelist_number] | grep // | sed "s/\.\.\. //" | sed "s/#.*//"  | p4 -ztag -x - where | grep "... path " | sed "s/\.\.\. path //" 
```

以下是在 Windows 环境中获取 Unix 命令行工具的可能位置：

[http://sourceforge.net/projects/getgnuwin32/?source=typ_redirect](http://sourceforge.net/projects/getgnuwin32/?source=typ_redirect) [http://unxutils.sourceforge.net/](http://unxutils.sourceforge.net/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-03-03T11:02:57.780

当我想删除整个更改列表时，我遇到了同样的问题。所以我使用以下脚本（请注意，它还会删除更改列表的搁置和更改列表本身。如果您只想还原，请复制相关行）。此外，请确保 sed 适用于您的 p4 版本。

```
#!/bin/bash

set -e

if [[ $# -ne 1 ]]; then
echo "usage: $(basename $0) changelist"
    exit 1
fi

CHANGELIST=$1

#make sure changelist exist.
p4 describe -s $CHANGELIST > /dev/null # set -e will exit automatically if fails

p4 shelve -d -c $CHANGELIST 2> /dev/null || true # changelist can be shelveless
files_to_revert=$(p4 opened 2> /dev/null | grep "change $CHANGELIST" | sed "s/#.*//g")
if [[ -n "$files_to_revert" ]]; then
    p4 revert $files_to_revert
fi
p4 change -d $CHANGELIST 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-04-10T11:55:43.297

当您想要恢复刚刚提交的整个更改列表（作为批量）时，问题就开始了，并且您需要开始快速恢复 #n-1 的文件（因为它是生产）...

想要支持 ya23 的回答——Python 脚本的链接——它真的很容易使用（而且很容易错过他的评论）

你给它你想要回滚的修订，它会自动准备一切（每个文件的#n-1 & merging 和一切）......你只需提交。

# asp.net - 如何将 Perl 与 ASP.NET Webforms 集成？

> ID：331765
> 
> 赞同：0
> 
> 时间：2008-12-01T18:39:12.323
> 
> 标签：asp.net, perl, webforms

我想将一些现有的 Perl 代码与 ASP.NET 集成。我看到很多从 .NET 访问 Perl 的示例，但反之则没有。有没有人尝试过这样做，或者每个人都只是一举重建了他们现有的 Perl 功能？

更详细地说，我已经在 Perl 中实现了一些功能，我们希望将这些功能与我们在 ASP.NET webforms 中实现的更大门户集成。我们不想重新实现 .NET 中的现有功能，而是希望门户网站的某些页面通过 Perl 呈现（允许它访问 WebForm 会话信息而无需将其放入 cookie）。展望未来，所有新代码和对 Perl 代码的更新都将根据具体情况在 .NET 中实现。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-01T18:45:54.133

最简单的方法是让你的 perl 代码调用你的 asp 页面，然后在 asp 端使用 Request.QueryString 来提取这些变量。

# python - 什么是好的 Python 格式样式

> ID：331767
> 
> 赞同：2
> 
> 时间：2008-12-01T18:40:32.913
> 
> 标签：python, coding-style

我创建了一个小的 python 脚本来在我用于测试的两个文件之间切换。

我的问题是，以下代码的好的 Python 格式样式是什么：

```
import filecmp
import shutil

local = "local.txt"
remote = "remote.txt"
config_file = "C:\some\path\file.txt"

shutil.copyfile( remote if( filecmp.cmp(local, config_file ) ) else local, config_file  ) 
```

或者

```
shutil.copyfile( remote 
                     if( filecmp.cmp(local, config_file ) ) 
                     else local,
                 config_file  ) 
```

或者

```
tocopy = remote if( filecmp.cmp( local, config_file ) ) else local 
shutil.copyfile( tocopy, config_file ) 
```

要不然是啥？

另外，在python中为多词名称命名var的首选方法是“to_copy”、“tocopy”、“toCopy”、“ToCopy”

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2008-12-01T18:44:39.847

对于条件语句，我可能会选择：

```
if filecmp.cmp(local, config_file):
    shutil.copyfile(remote, config_file)
else:
    shutil.copyfile(local, config_file) 
```

在这种情况下几乎不需要使用内联`y if x else z`，因为周围的代码很简单。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-12-01T18:44:06.353

我见过的最常见的命名是下划线分隔的单词，to_copy。

至于格式风格，我没见过这样的约定。我发现

```
source = remote if filecmp.cmp(local, config_file) else local

shutil.copyfile(source, config_file) 
```

成为您的选择中最清晰的。

并且看到每个人都喜欢拆分 if 我至少要封装 copyfile 调用，以防有一天您希望更改它：

```
def copy_to(source, destination):
    shutil.copyfile(source,destination)

if filecmp.cmp(local, config_file):
    copy_to(remote, config_file)
else:
    copy_to(local, config_file) 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-12-01T18:47:23.803

来自[Python 风格指南](http://www.python.org/dev/peps/pep-0008/)：

**关于列出复合表达式：**

通常不鼓励复合语句（同一行上的多个语句）。

是的：

```
if foo == 'blah':
    do_blah_thing()
do_one()
do_two()
do_three() 
```

或者对于您提供的代码，Greg 的示例是一个很好的示例：

```
if filecmp.cmp(local, config_file):
    shutil.copyfile(remote, config_file)
else:
    shutil.copyfile(local, config_file) 
```

而不是：

```
if foo == 'blah': do_blah_thing()
do_one(); do_two(); do_three() 
```

**方法名称和实例变量**

使用函数命名规则：小写单词，必要时用下划线分隔以提高可读性。

**更新：**根据 Oscar 的要求，还列出了他的代码在这种方式下的外观。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2008-12-01T19:27:54.813

第三个选项对我来说看起来最自然，尽管您在侧括号中使用空格和多余的括号与[Python 样式指南](http://www.python.org/dev/peps/pep-0008/)相矛盾。

该指南还回答了 to_copy 问题，但我可能会完全使用更清晰的名称。

我会把它写成：

```
import filecmp
import shutil

local = "local.txt"
remote = "remote.txt"

destination = r"C:\some\path\file.txt"
source = remote if filecmp.cmp(local, destination) else local

shutil.copyfile(source, destination) 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-01T19:33:13.633

关于什么：

```
import filecmp
import shutil

local = "local.txt"
remote = "remote.txt"
config_file = "C:\some\path\file.txt"

if filecmp.cmp( local, config_file):
    to_copy = remote
else:
    to_copy = local

shutil.copyfile( to_copy, config_file  ) 
```

哎呀，这个开放的 id 屏幕名称看起来很糟糕。

# mysql - 如何修复这个 MySQL 查询？

> ID：331770
> 
> 赞同：2
> 
> 时间：2008-12-01T18:41:34.157
> 
> 标签：mysql

```
SELECT 
  avg(con_hits) as avg_hits 
FROM 
  content 
WHERE 
  con_type = 1 
  AND con_posttime < $twelve_hrs_ago 
  AND con_refresh = 0 
ORDER BY 
  con_posttime DESC 
LIMIT 100 
```

我希望它转到至少 12 小时前发布的第一条记录（由`$twelve_hrs_ago`具有合适时间戳的变量表示），并`con_hits`为接下来的 100 条记录取列的平均值。在我的示例中，它忽略`LIMIT`, 并取表中每条记录的平均值。

有没有办法绕过它？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-12-01T18:46:14.773

`LIMIT`应用于结果集，`AVG`计算之后。您可以使用子选择做您想做的事：

```
SELECT avg(con_hits) as avg_hits
FROM (
  SELECT con_hits
  FROM content
  WHERE
    con_type = 1
    AND con_posttime < $twelve_hrs_ago
    AND con_refresh = 0
  ORDER BY con_posttime DESC
  LIMIT 100
) x; 
```

您也可以使用数据库来计算时间偏移量。将`$twelve_hrs_ago`上面替换为：

```
date_add(now(), interval -12 hour) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-01T18:49:20.430

关于什么：

```
 SELECT avg(con_hits) as avg_hits FROM (
    SELECT con_hits FROM content 
    WHERE con_type = 1 AND con_posttime < $twelve_hrs_ago AND con_refresh = 0
    ORDER BY con_posttime DESC
    LIMIT 100
    ) 
```

Mysql 支持子查询，所以这可能会为你做。

[http://dev.mysql.com/doc/refman/5.0/en/subqueries.html](http://dev.mysql.com/doc/refman/5.0/en/subqueries.html)

# java - 在 OS X 上运行 Java 6 有哪些选择？

> ID：331777
> 
> 赞同：7
> 
> 时间：2008-12-01T18:44:58.800
> 
> 标签：java, macos

在 OS X 上运行 Java 6 有哪些选择？

我有一台运行 Mac OS X 10.4 的 MacBook Pro Intel Core Duo。我有在这个硬件和操作系统上运行 Java 6 的任何选项吗？

相关问题：哪些 Mac（当前或即将推出）支持 64 位计算？是否有任何具有 64 位架构的 Apple 笔记本电脑（当前的或即将推出的）？

任何相关链接将不胜感激。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-12-01T19:11:57.513

人们正在努力让[OpenJDK](http://openjdk.java.net/) 6 在 10.4 上运行。我自己从未尝试过，但[soy latte是](http://landonf.bikemonkey.org/static/soylatte/)[BSD openjdk 端口](http://openjdk.java.net/projects/bsd-port/)的 Mac Os 端口，看起来很有希望。10.4 版本似乎只有 32 位。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-12-03T13:23:55.607

自 Core **2** Duo 以来，所有可用的 Intel mac 都支持 64 位。如果您是早期采用者并且像我一样拥有基于 Core Duo 的 Intel mac（请注意缺少的 2），那么您的计算机不支持 64 位（请参阅[http://en.wikipedia.org/wiki/Core_duo](http://en.wikipedia.org/wiki/Core_duo)）。

第一台 Macbook (Pro) 和 Mac mini 就是这样的例子。

然而，正如前面提到的 SoyLatte ( [http://landonf.bikemonkey.org/static/soylatte/](http://landonf.bikemonkey.org/static/soylatte/) )，在 Mac 上运行 Java 6 相当简单。我已经完成了安装步骤，并且可以成功运行 Java 6 应用程序（例如 Osmosis [http://wiki.openstreetmap.org/index.php/Osmosis](http://wiki.openstreetmap.org/index.php/Osmosis)）。

Apple Java 1.6 仅部署在支持 64 位的 Mac 上，即即使您有 Leopard，您的 Core Duo Mac 上也不会有 Java 6。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-12-01T18:46:53.883

我认为所有当前的 Mac 都是 64 位的？

[http://support.apple.com/downloads/Java_for_Mac_OS_X_10_5_Update_1](http://support.apple.com/downloads/Java_for_Mac_OS_X_10_5_Update_1)获取 Java 6 支持。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-09-04T13:17:46.667

Leopard (OS X 10.5) 是第一个通过更新使 Java 6 (1.6) JRE 可用的 OS X 版本。不幸的是，只有 64 位版本的 Java 6 JRE 可用于 Leopard，因此只有具有 64 位 Intel 处理器的才能运行 Java 1.6。

自 Core 2 Duo 以来，所有可用的 Intel Mac 都支持 64 位。如果您有基于 Core Duo 的 Intel mac（请注意缺少的 2），则您的计算机不支持 64 位。第一台 Macbook (Pro) 和第一台 Mac mini 就是这样的例子。您的特定计算机是 32 位的，因此您不会使用 Leopard 获得 Java 6，当然也不会使用 Tiger (10.4)。

Snow Leopard (OS X 10.6) 带有开箱即用的 Java 6。因此，如果您购买了带有 Snow Leopard 的新 Mac，或者您升级到 Snow Leopard，它包括 32 位和 64 位版本的 Java 6。如果您将 32 位 Intel Mac 升级到 Snow Leopard，您将获取 Java 6（32 位）。

对于不想升级到 Snow Leopard 或无法升级（Snow Leopard 需要 1 GB 内存才能安装）的 Intel Mac 用户，您可以选择安装 SoyLatte for Java 6。

SoyLatte ( [http://landonf.bikemonkey.org/static/soylatte/](http://landonf.bikemonkey.org/static/soylatte/) ) 源自 Java 6 JRE 的 FreeBSD 端口并在 Mac 上运行。SoyLatte 仅适用于基于 Intel 的 Mac，并且仅包含 32 位 JRE。

只需下载并解压 SoyLatte，设置您的 JAVA_HOME 和 PATH，然后运行您的程序。这是一个示例：

```
$ export JAVA_HOME=/Users/madams/Desktop/soylatte16-i386-1.0.3
$ export PATH=/Users/madams/Desktop/soylatte16-i386-1.0.3/bin:$PATH
$ java -jar /Users/madams/Desktop/test.jar 
```

另请注意，Snow Leopard 仅包含 Java 6，并自动删除较旧的 JRE。这意味着不再有 Java 1.5，尽管以前版本的路径链接到当前版本。

此外，Snow Leopard 中的 Java 6 在 64 位 Mac 上默认为 64 位 JRE，因此如果您调用 32 位本机库 (JNI)，它将失败。您必须使用 -d32 命令行选项调用 java 才能在装有 Snow Leopard 的 64 位 Mac 上运行 32 位版本的 Java JRE。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-12-01T18:47:54.957

Apple 目前对 Java 6 的支持非常有限。根本不支持 10.4，除此之外，对 10.5 的支持仅限于 64 位。虽然这看起来并不可怕，因为所有新的 Mac 都有 Core 2 Duo 并支持 64 位，但 Safari 仍然是 32 位应用程序，因此无法运行 64 位插件，例如 Java 小程序容器。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-12-01T18:48:39.183

不幸的是，对于 java 6，您唯一的选择是等到苹果发布它。

**编辑**

顺便说一句，10.5 已经发生了：http: [//support.apple.com/kb/HT2733](http://support.apple.com/kb/HT2733) :)

> 此版本将 Java SE 6 更新到版本 1.6.0_07，将 J2SE 5.0 更新到版本 1.5.0_16，并将 J2SE 1.4.2 更新到 1.4.2_18。

所以我想唯一的办法就是升级你的操作系统:(

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-12-02T18:22:58.517

你的第一个问题已经得到了相当彻底的回答。回答您的第二个问题：所有英特尔 Mac 都隐含 64 位功能，并且随着 OS X 的每个版本，操作系统变得越来越以 64 位为中心。（与 Windows 不同，OS X 不区分 32 位和 64 位版本。）

据我了解，下一个版本 10.6 将几乎完全是 64 位的。[你可以在这里](http://developer.apple.com/documentation/Darwin/Conceptual/64bitPorting/intro/chapter_1_section_1.html)学到很多关于 64 位和 OS X的知识。

特别是关于[64 位转换](http://developer.apple.com/documentation/Cocoa/Conceptual/Cocoa64BitGuide/MovingTo64Bit/chapter_2_section_2.html#//apple_ref/doc/uid/TP40004247-CH3-DontLinkElementID_19)的页面可能是您正在寻找的。

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2009-03-21T01:55:58.973

你可以。老实说，它也没有那么难（截至目前，它很容易）。Java 应用程序通常会脱颖而出（以一种糟糕的方式），我会高度考虑使用更原生的语言进行部署。

# c# - 既然 .NET 有一个垃圾收集器，为什么我们需要终结器/析构器/dispose-pattern？

> ID：331786
> 
> 赞同：68
> 
> 时间：2008-12-01T18:47:16.033
> 
> 标签：c#, .net, memory, memory-management, garbage-collection

如果我理解正确，.net 运行时总是会在我之后清理。因此，如果我创建新对象并停止在代码中引用它们，运行时将清理这些对象并释放它们占用的内存。

既然是这种情况，为什么某些对象需要具有析构函数或处置方法？当它们不再被引用时，运行时不会在它们之后清理吗？

* * *

## 回答 #1

> 赞同：94
> 
> 时间：2008-12-01T18:49:52.970

需要终结器来保证将稀缺资源释放回系统，例如文件句柄、套接字、内核对象等。由于终结器总是在对象生命周期结束时运行，因此它是释放这些句柄的指定位置。

该`Dispose`模式用于提供资源的确定性销毁。由于 .net 运行时垃圾收集器是非确定性的（这意味着您永远无法确定运行时何时会收集旧对象并调用它们的终结器），因此需要一种方法来确保系统资源的确定性释放。因此，当您`Dispose`正确实现该模式时，您会提供资源的确定性释放，并且在消费者粗心且不处置对象的情况下，终结器将清理对象。

为什么`Dispose`需要一个简单的例子可能是一个快速而肮脏的日志方法：

```
public void Log(string line)
{
    var sw = new StreamWriter(File.Open(
        "LogFile.log", FileMode.OpenOrCreate, FileAccess.Write, FileShare.None));

    sw.WriteLine(line);

    // Since we don't close the stream the FileStream finalizer will do that for 
    // us but we don't know when that will be and until then the file is locked.
} 
```

在上面的示例中，文件将保持锁定状态，直到垃圾收集器调用`StreamWriter`对象的终结器。这带来了一个问题，因为在此期间，可能会再次调用该方法来写入日志，但这一次它将失败，因为文件仍然被锁定。

正确的方法是在使用完对象后处理它：

```
public void Log(string line)
{
    using (var sw = new StreamWriter(File.Open(
        "LogFile.log", FileMode.OpenOrCreate, FileAccess.Write, FileShare.None))) {

        sw.WriteLine(line);
    }

    // Since we use the using block (which conveniently calls Dispose() for us)
    // the file well be closed at this point.
} 
```

顺便说一句，技术上的终结器和析构器意味着同样的事情；我更喜欢将 c# 析构函数称为“终结器”，否则它们往往会将人们与 C++ 析构函数混淆，这与 C# 不同，是确定性的。

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2008-12-01T19:08:00.267

以前的答案很好，但让我再次强调这里的重点。特别是，你说

> 如果我理解正确，.net 运行时总是会在我之后清理。

这只是部分正确。事实上，**.NET*只*为一种特定资源提供自动管理**：主内存。所有其他资源都需要手动清理。^(1))

奇怪的是，在几乎所有关于程序资源的讨论中，主存都获得了特殊的地位。这当然有一个很好的理由——主存储器通常是最稀缺的资源。但值得记住的是，还有其他类型的资源也需要管理。

* * *

^(1))通常尝试的解决方案是将其他资源的生命周期与代码中的内存位置或标识符的生命周期耦合——因此存在终结器。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2008-12-01T18:51:04.577

垃圾收集器只有在系统没有内存压力时才会运行，除非它真的需要释放一些内存。这意味着，您永远无法确定 GC 何时运行。

现在，假设您是一个数据库连接。如果您让 GC 清理之后，您可能会连接到数据库的时间比需要的时间长得多，从而导致奇怪的负载情况。在这种情况下，您希望实现 IDisposable，以便用户可以调用 Dispose() 或使用 using() 来真正确保尽快关闭连接，而不必依赖可能稍后运行的 GC。

通常，IDisposable 在任何使用非托管资源的类上实现。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-12-01T18:55:17.920

1.  有些东西垃圾收集器在你之后无法清理
2.  即使有它*可以*清理的东西，你也可以帮助它尽快清理

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-12-01T19:01:15.490

真正的原因是因为 .net 垃圾收集并非旨在收集*非托管资源*，因此这些资源的清理工作仍然掌握在开发者手中。此外，当对象超出范围时，不会自动调用对象终结器。GC 在某个未确定的时间调用它们。而且当它们被调用时，GC 不会立即运行它，它会等待下一轮调用它，从而增加清理更多的时间，当您的对象持有稀缺的非托管资源（例如文件）时，这不是一件好事或网络连接）。进入一次性模式，开发人员可以在确定的时间手动释放稀缺资源（调用 yourobject.Dispose() 或 using(...) 语句时）。请记住，您应该调用 GC.SuppressFinalize(this); 在您的 dispose 方法中告诉 GC 该对象是手动处置的，不应最终确定。我建议你看看 K. Cwalina 和 B. Abrams 的框架设计指南一书。它很好地解释了 Disposable 模式。

祝你好运！

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-12-01T19:24:58.157

简单的解释：

*   Dispose 专为非内存资源，尤其是**稀缺资源的****确定性**处理而设计。例如，窗口句柄或数据库连接。
***   Finalize 专**为非内存资源的非确定性**处置而设计，如果未调用 Dispose，通常作为后备。**

 **实现 Finalize 方法的一些准则：

*   仅在需要终结的对象上实现终结，因为终结方法会带来性能成本。
*   如果您需要 Finalize 方法，请考虑实现 IDisposable 以允许您的类型的用户避免调用 Finalize 方法的成本。
*   您的 Finalize 方法应该受到保护而不是公开。
*   您的 Finalize 方法应该释放该类型拥有的任何外部资源，但**只能**释放它拥有的那些。它不应引用任何其他资源。
*   CLR 不保证调用 Finalize 方法的顺序。正如 Daniel 在他的评论中指出的那样，这意味着 Finalize 方法不应该访问任何成员引用类型，因为它们可能有（或者有一天可能有）它们自己的终结器。
*   切勿直接在类型的基类型以外的任何类型上调用 Finalize 方法。
*   尽量避免在您的 Finalize 方法中出现任何未处理的异常，因为这将终止您的进程（在 2.0 或更高版本中）。
*   避免在 Finalizer 方法中执行任何长时间运行的任务，因为这会阻塞 Finalizer 线程并阻止其他 Finalizer 方法被执行。

实现 Dispose 方法的一些准则：

*   在封装了明确需要释放的资源的类型上实现 dispose 设计模式。
*   在具有一个或多个保留资源的派生类型的基类型上实现 dispose 设计模式，即使基类型没有。
*   在实例上调用 Dispose 后，通过调用 GC.SuppressFinalize 方法阻止 Finalize 方法运行。此规则的唯一例外是必须在 Finalize 中完成 Dispose 未涵盖的工作的罕见情况。
*   不要假设 Dispose 会被调用。如果未调用 Dispose，则还应在 Finalize 方法中释放类型拥有的非托管资源。
*   当资源已被释放时，从该类型（Dispose 除外）的实例方法中引发 ObjectDisposedException。此规则不适用于 Dispose 方法，因为它应该可以多次调用而不会引发异常。
*   通过基类型的层次结构传播对 Dispose 的调用。Dispose 方法应释放此对象拥有的所有资源以及此对象拥有的任何对象。
*   您应该考虑在调用 Dispose 方法后不允许对象可用。重新创建一个已经被释放的对象是一个难以实现的模式。
*   允许多次调用 Dispose 方法而不引发异常。该方法在第一次调用后应该什么都不做。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-12-01T18:50:31.473

需要析构函数和处置方法的对象正在使用非托管资源。所以垃圾收集器不能清理那些资源，你必须自己做。

查看 IDisposable 的 MSDN 文档；[http://msdn.microsoft.com/en-us/library/system.idisposable.aspx](http://msdn.microsoft.com/en-us/library/system.idisposable.aspx)

该示例使用非托管处理程序 - IntPr。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-12-01T18:49:44.703

一些对象可能需要清理低级项目。比如需要关闭的硬件等。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-12-01T18:50:38.837

主要针对非托管代码，以及与非托管代码的交互。“纯”托管代码永远不需要终结器。另一方面，Disposable 只是一种方便的模式，可以在您完成后强制释放某些东西。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-12-01T18:51:36.057

.NET 垃圾收集器知道如何在 .NET 运行时处理托管对象。但是 Dispose 模式 (IDisposable) 主要用于应用程序正在使用的非托管对象。

换句话说，.NET 运行时不一定知道如何处理每种类型的设备或在那里处理（关闭网络连接、文件句柄、图形设备等），因此使用 IDisposable 提供了一种说“让我在一个类型中实现一些我自己的清理。看到该实现，垃圾收集器可以调用 Dispose() 并确保清理托管堆之外的东西。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-12-01T18:53:32.993

在少数（非常少）情况下，当不再使用纯托管对象时，可能需要执行特定操作，我想不出一个例子，但我见过几个多年来的合法用途。但主要原因是清理对象可能正在使用的任何非托管资源。

因此，一般来说，除非您使用非托管资源，否则您不需要使用 Dispose/Finalize 模式。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-12-01T18:56:06.407

因为垃圾收集器无法收集托管环境未分配的内容。因此，任何导致内存分配的非托管 API 调用都需要以老式方式收集。

# vb.net - 访问内部文件 VB.NET

> ID：331794
> 
> 赞同：1
> 
> 时间：2008-12-01T18:49:49.307
> 
> 标签：vb.net

我在 testapp 的解决方案中添加了一个文本文件，我想阅读该文件。我不记得如何做到这一点，我知道这与反射有关，但我需要朝着正确的方向前进。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-01T18:56:38.120

如果您将文本文件添加到 .ResX 文件，您可以获得所有好处（例如动态更新），而无需担心与实际文件交互。VB 会自动创建一个类来访问该文件——假设你有 Resources.resx。您可以使用 My.Resources.MyFile 访问它 - 它会返回一个字符串。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-01T18:57:37.683

您是否将文件添加为资源？在这种情况下，您只需使用即可访问其 ( `String`) 内容`My.Resources.name_of_file`。否则，在 VB 中读取文本文件的最简单方法是使用以下内容。

```
Dim content = My.Computer.FileSystem.ReadAllText("filename") 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2008-12-01T18:54:05.943

我打算写一些代码，但[在这里找到了更好的解释](http://www.homeandlearn.co.uk/NET/nets8p2.html)

在您的情况下，您需要使用您的应用程序路径而不是“C:\”。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2008-12-01T18:58:50.630

您是在谈论将文本文件作为资源嵌入到解决方案中 - 即编译？

为此，您需要一个程序集类的实例（参考您的，Assembly 有一个名为 GetExecutingAssembly 的静态成员）从那里您调用 GetManifestResourceStream

# .net - 报告服务 403 错误

> ID：331797
> 
> 赞同：1
> 
> 时间：2008-12-01T18:50:02.377
> 
> 标签：.net, reporting-services

我最近将一个应用程序更新为 3.5 框架（从 2.0 开始）。该应用程序通过 URL 远程链接到 Reporting Services (2005)。这一切在本地都可以正常工作，但是当部署到开发服务器（win 2003）时，我在尝试调用报表服务器时遇到 403 错误。

“您无权查看此页面...

HTTP 错误 403 - 禁止“

这只是在安装 3.5 框架后才开始发生，我尝试了各种安全设置，但无法让它再次工作。

有谁知道需要设置什么安全性或我需要更改什么？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-01T19:17:47.173

不知道我是应该回答自己还是只是发表评论，但无论如何。

从另一篇文章中找到（或至少一个）解决方案。显然，报告服务根目录可能会损坏——具体情况尚不清楚——但我删除了 ReportServer 虚拟目录并使用 Reporting Services 配置工具重新创建了它。

又恢复了，谢谢回复。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-01T18:59:03.967

当您说调用报表服务器时，具体是什么意思？使用以下 URL 访问报告管理器：www.myserver.com/reports ?

主要原因是，您在本地被隐式验证为您登录到服务器的用户。在浏览器中远程访问服务器，不一定对您进行身份验证。您是否在服务器上的 IIS 中启用了匿名身份验证？如果是这样，您将作为公共匿名/来宾用户进行身份验证，并且无权访问报表服务器。通过禁用匿名身份验证，系统将提示您输入用户名/密码进行身份验证。

# windows-server-2003 - 为什么 CreateProcess 在 Windows Server 2003 64 位中失败？

> ID：331829
> 
> 赞同：3
> 
> 时间：2008-12-01T19:00:35.587
> 
> 标签：windows-server-2003, 64-bit, createprocess

我们有一个 32 位应用程序，它在其过程中启动其他 32 位应用程序。该应用程序在其他 64 位平台上运行良好，但在 Windows Server 2003 64 位上，尝试启动应用程序时出现错误：

```
error 193 (not a valid 32 bit application) 
```

我们可以毫无问题地在该系统上手动启动这些应用程序。

我以为我们已经找到了[这篇文章](http://support.microsoft.com/kb/822961)的问题，但是我们的客户已经在他的系统上安装了这个补丁，并且错误仍然存​​在。

如果其他人遇到过类似的事情，或者如果有人对如何解决这个问题有任何想法，将不胜感激！

谢谢！弗朗索瓦·科特

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-12T23:53:40.147

IIRC，即使应用程序确实是有效的 32 位 .exe，您也可以获得该错误代码，原因有很多，例如 dll 依赖问题。或者，如果 Windows 加载程序被路径中的 64 位 dll 与它需要的 32 位 dll 同名混淆。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-16T20:21:57.443

您可能希望使用“自动打开和配置子进程”选项使用依赖项walker 执行运行时配置文件。这将使您更好地了解它的进展情况以及它在运行时解决了哪些依赖项。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-01T21:31:33.817

您确定要启动的应用程序是为 32 位编译的吗？当您直接运行每个应用程序时，请确保它们在 WOW64 中运行。如果不是，则 Windows 将它们作为 64 位应用程序运行，这可能会导致您看到的问题。

# filesystems - 在文件系统中存储上传文件的最佳实践

> ID：331852
> 
> 赞同：5
> 
> 时间：2008-12-01T19:10:00.497
> 
> 标签：filesystems, uploading

关于存储从用户上传的文件的最佳做法是什么？

目前，我正在使用以下存储文件的方法：

```
<web_app_root>/course_material/<term_id>/<course_id>/<file_id> 
```

如您所见，文件是根据数据库中的键存储的。我认为这更安全，因为我不必过滤文件名并将不安全字符转换为安全字符。

但是，我正在开始一个新项目，并想知道将 Web 应用程序的文件系统与数据库如此紧密地联系起来是否是一个坏主意。我应该以更易于阅读的格式存储文件吗？

```
<web_app_root>/course_material/<term_name_underscored>/<course_name_underscored>/<file_name_underscored> 
```

如果是这样，为了安全起见，过滤掉文件名的最佳方法是什么？还是我目前的做法是最佳做法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-01T19:15:20.517

我一直只是将文件存储在具有唯一基于 GUID 的文件名的目录中，并将 guid 映射到数据库中的文件。只要您不手动浏览文件等，这可能是最简单的解决方案（也可以绕过无效字符）。

另一种选择是将它们作为 BLOBS 存储在数据库中。我也这样做了——但它是为了填充现代 NAS 设备应该处理的复制 DR 场景。

如果您发现出于某种原因需要在应用程序外部手动浏览文件，那么使用长名称或短名称（无论您想浏览它们）会更简洁。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-01T19:27:35.580

我建议你把它从 web_app_root 中取出。

我喜欢你在第一个例子中的做法。

# python - 如何确定页面是否被重定向

> ID：331855
> 
> 赞同：5
> 
> 时间：2008-12-01T19:10:57.593
> 
> 标签：python, http, http-headers

我需要在不实际下载内容的情况下检查页面是否被重定向。我只需要最终的 URL。最好的方法是 Python 吗？谢谢！

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-12-01T19:23:33.620

如果您特别想避免下载内容，则需要使用 HEAD 请求方法。我相信`urllib`and`urllib2`库不支持 HEAD 请求，因此您必须使用较低级别的`httplib`库：

```
import httplib

h = httplib.HTTPConnection('www.example.com')
h.request('HEAD', '/')
response = h.getresponse()

// Check for 30x status code
if 300 <= response.status < 400:
    // It's a redirect
    location = response.getheader('Location') 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-01T19:15:49.550

当您使用 打开 URL`urllib2`并被重定向时，您会获得 30x 的重定向状态。检查信息以查看您被重定向到的位置。您无需阅读页面即可阅读`info()`响应的一部分。

# mysql - 通过 SSL 将 phpMyAdmin 连接到 MySQL 服务器

> ID：331856
> 
> 赞同：4
> 
> 时间：2008-12-01T19:11:41.320
> 
> 标签：mysql, ruby-on-rails, ssl, phpmyadmin, ssl-certificate

我可能会叫错树...但是，我拥有的是一个 MySQL 服务器，它只接受来自具有有效 SSL 证书的客户端的连接（请参阅[此链接](http://dev.mysql.com/doc/refman/5.0/en/secure-create-certs.html)）。例如，这对 Rails 非常有效。我在一台服务器上有我的数据库，还有一个使用客户端证书连接的 Rails 应用程序。也许不是最快的，但它确实有效。

**database.yml**中的配置如下所示：

```
sslkey: /path/to/client-key.pem
sslcert: /path/to/client-cert.pem
sslca: /path/to/ca-cert.pem 
```

问题是我想将 phpMyAdmin 托管在与 Rails 应用程序相同的服务器上。我认为 phpMyAdmin 的连接选项更受限制，因为我似乎找不到使用客户端证书进行连接的方法。但我发现奇怪的是，在这个主题上搜索答案并没有太多出现（这让我怀疑我是否采取了错误的方法）。

显然，我可以轻松地将 phpMyAdmin 本身设置为托管在 SSL 证书后面（它将加密客户端浏览器和我的 phpMyAdmin 服务器之间的请求），但我希望 phpMyAdmin <-> db 连接也被加密。

这可能吗？这是一个糟糕的设计选择吗？有没有更好的方法来做到这一点？

谢谢，

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-12-01T19:25:23.727

在`config.inc.php`适用的服务器内容之后添加此行：

```
$cfg['Servers'][$i]['ssl']=true; 
```

假设您的 php 及其 mysql 客户端配置了 SSL，这应该可以工作。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2020-03-12T12:53:45.553

我同意，答案是不够的。每个人都告诉您将 SSL 证书和指针放在`conf.d`虚拟主机块中的地方。但这是针对入站流量的。仅当您`phpmyadmin`从 mysql 服务器的 IP 地址访问时，但此示例并非如此。在这里，我们使用`phpmyadmin`外出并从本地机器向远程服务器发出远程请求。

为了做到这一点，`phpmyadmin`必须有一个配置设置以允许指定`cert`文件的位置。否则，我看不出这将如何工作。尽管虚拟主机块也可能适用于传出流量。我想我们可以试试……我的想法是虚拟主机只适用于入站流量。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2021-03-05T12:39:06.277

我相信完整的答案在 PHPmyadmin 文档中得到了很好的解释： [https ://docs.phpmyadmin.net/en/latest/config.html#example-google-ssl](https://docs.phpmyadmin.net/en/latest/config.html#example-google-ssl)

您应该按照它并在 config.inc.php 中配置您的服务器连接记录，如下所示：

```
// IP address of your instance
$cfg['Servers'][$i]['host'] = '8.8.8.8';
// Use SSL for connection
$cfg['Servers'][$i]['ssl'] = true;
// Client secret key
$cfg['Servers'][$i]['ssl_key'] = '../client-key.pem';
// Client certificate
$cfg['Servers'][$i]['ssl_cert'] = '../client-cert.pem';
// Server certification authority
$cfg['Servers'][$i]['ssl_ca'] = '../server-ca.pem';
// Disable SSL verification (see above note)
$cfg['Servers'][$i]['ssl_verify'] = false; 
```

# silverlight - Silverlight 客户端能否访问存储在隔离存储中的本地 sql 紧凑型数据库

> ID：331857
> 
> 赞同：2
> 
> 时间：2008-12-01T19:11:47.247
> 
> 标签：silverlight, caching, sql-server-ce

silverlight clr 是否支持访问放置在 silverlight 应用程序的隔离存储中的 sql compact 数据库？

如果是这样，任何指向代码示例的指针。

我想缓存以前会话中从服务器检索到的信息。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-12-01T21:15:04.503

即使它存储在独立存储中，SQL Server Compact Edition 中也没有可供读取的 Silverlight 库。也许在未来的版本中。我听说有几个开源项目正在尝试这样做，但还没有任何发布。我试图将 Google Gears DB 包装在 Beta 2 中，但没有成功。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-03T10:48:25.407

silverlight 没有 SQL 客户端。用户还可以从隔离存储中删除您的数据 - 右键单击​​正在运行的 silverlight 应用程序并转到“应用程序存储”选项卡。因此，只需将其用于用户设置和应用程序可以在没有的情况下运行的缓存数据，即使速度较慢。

如果您需要在本地缓存数据，最好的办法是将其作为 XML 存储在隔离存储中，使用 LINQ to XML 对其进行读写。

如果有太多数据，或者数据太复杂而无法轻松完成，则将数据保存在您的服务器上，然后 silverlight 客户端应该通过网络访问它。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-02-01T12:24:04.377

可能值得一提的是，现在可以使用 Silverlight 4 的 COM 功能，但仅在运行 Out Of Browser 时才能实现。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-02-01T13:28:55.183

我在这里有一个示例，使用 SQL Server Compact 和 Silverlight（OOB 和提升并且仅在 Windows 上） - [http://erikej.blogspot.com/2010/02/access-local-sql-compact-database-from.html](http://erikej.blogspot.com/2010/02/access-local-sql-compact-database-from.html)

# windows - 如何在不使用“我的电脑”对话框的情况下在 Windows XP 中设置系统环境变量

> ID：331862
> 
> 赞同：7
> 
> 时间：2008-12-01T19:12:32.677
> 
> 标签：windows

我正在为各种项目在不同的 Java SDK（1.4.2、1.5.0 和 1.6.0）之间切换。我想在我的 Windows XP 机器上设置 JAVA_HOME 环境变量，而不需要经过繁琐的我的电脑 -> 高级 -> [选择系统变量] -> 编辑 -> 确定 -> 确定

是否可以从命令行执行此操作，或者是否有可以执行此操作的实用程序？

（请注意，我指的不是标准批处理文件“SET”命令——我想“全局”设置环境变量，而不仅仅是在控制台窗口的生命周期内）。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-12-01T19:17:10.577

来自[http://vlaurie.com/computers2/Articles/environment.htm](http://vlaurie.com/computers2/Articles/environment.htm)：

> 使用附加工具 Setx.exe
> 
> 它不是标准 Windows XP 安装程序的一部分，但名为 setx.exe 的命令行工具包含在 [Windows XP Service Pack 2 支持工具](http://www.microsoft.com/downloads/details.aspx?FamilyId=49AE8576-9BB9-4126-9761-BA8011FABF38&displaylang=en)中。此工具扩展了 set 命令，以便可以对环境变量进行永久更改。例如，要将文件夹 C:\New Folder 添加到路径，命令将是 setx path "%PATH%;C:\New Folder"

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-01T19:17:18.890

[Service Pack 2 支持工具](http://www.microsoft.com/downloads/details.aspx?FamilyId=49AE8576-9BB9-4126-9761-BA8011FABF38&displaylang=en)有一个名为“setx.exe”的工具，可以满足您的需求。setx 路径 "%PATH%;C:\新建文件夹"

[来源](http://vlaurie.com/computers2/Articles/environment.htm)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-01T19:25:47.143

这是我用于此的一些 VBScript：

```
set args = WScript.Arguments
Set objShell = WScript.CreateObject("WScript.Shell")
Set colSystemEnvVars = objShell.Environment("System")
Set colUserEnvVars = objShell.Environment("User")

' Parse args
select case args.Count
case 0, 1, 2
    help
case 3
    sVariable = args(0)
    sValue = args(1)
    sScope = UCase(args(2))
    sMode = ""
case 4
    sVariable = args(0)
    sValue = args(1)
    sScope = UCase(args(2))
    sMode = UCase(args(3))
end select

select case sScope
    case "S"
        if sMode = "A" then
            sValue = colSystemEnvVars(sVariable) & sValue
        end if
        colSystemEnvVars(sVariable) = sValue
    case "U"
        if sMode = "A" then
            sValue = colUserEnvVars(sVariable) & sValue
        end if
        colUserEnvVars(sVariable) = sValue
    case else
        help
end select

WScript.Quit

'******************************************************************************
Sub help()
    WScript.Echo ""
    WScript.Echo "Create or update an environment variable."
    WScript.Echo ""
    WScript.Echo "usage:"
    WScript.Echo "======"  
    WScript.Echo "cscript SetVar.vbs variable value {S|U} [A]"
    WScript.Echo ""
    WScript.Echo "eg:"
    WScript.Echo "==="     
    WScript.Echo "cscript SetVar.vbs MYVAR 'Hello world' U"
    WScript.Echo "cscript SetVar.vbs PATH 'C:\MyPath' S A"

    WScript.Quit
End Sub 
```

范围可以是“系统”或“用户”。最后一个参数“A”（如果存在）将值附加到变量的现有值（对于将目录添加到 PATH 系统变量很有用）。

变量将保留，但您必须关闭然后重新打开控制台才能使用它们。我通常从“运行...”对话框运行它，然后打开一个控制台。

# c++ - cpp/opengl 中的事件

> ID：331866
> 
> 赞同：1
> 
> 时间：2008-12-01T19:13:49.227
> 
> 标签：c++, events, opengl

我想创建基础设施来处理我的 opengl 项目的事件。它应该类似于 wpf 所具有的 - 3 种类型的事件 - 直接、隧道、冒泡。然后我想处理鼠标向上、向下、移动等事件。我应该如何解决这个问题？有没有图书馆可以处理这个。谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-01T19:15:55.883

[OpenGL 实用工具包](http://www.opengl.org/resources/libraries/glut/)(GLUT) 恰好提供了这一点 - 您为键盘输入、鼠标输入、重绘显示和调整窗口大小等事件设置了一堆事件处理程序，调用该`glutMainLoop()`函数，一切顺利。

# visual-studio - ASP.NET 中的项目类型

> ID：331879
> 
> 赞同：1
> 
> 时间：2008-12-01T19:18:06.393
> 
> 标签：visual-studio, visual-studio-2008, web-applications, project-types

如何在 VS 2008 中创建 Web 应用程序项目？它与“网站”项目有何不同？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-01T19:22:11.940

文件--新建--项目

而不是文件--新建--网站

它一起充当不同的容器，并且编译模型不同。

ScottGu 在首次发布时提供了一些详细信息：[http ://weblogs.asp.net/scottgu/archive/2006/05/08/445742.aspx](http://weblogs.asp.net/scottgu/archive/2006/05/08/445742.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-01T19:48:28.953

主要区别在于 Web 应用程序使用 .csproj 文件，该文件包含有关项目中所有文件的信息。它有什么区别？使用网站模型，您可以在**没有**Visual Studio 的情况下添加新文件，因为添加新文件不需要修改 csproj 文件，但使用 Web 应用程序模型则不能。我个人更喜欢 Web 应用程序类型。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-01T20:03:15.677

人们已经充分确定了许多差异，但让我补充一下更广泛的内容：

Web 应用程序项目在架构上与 .Net 中的其他项目类型一致，而 WebSites 则有所不同，并且看起来确实像是对 VS 2003 时代的倒退。

出于这个原因，我认为 WAP 更优雅（尤其是当您在解决方案中有多个项目时）。

# c++ - C++ 对向量或链表进行排序

> ID：331889
> 
> 赞同：4
> 
> 时间：2008-12-01T19:22:53.777
> 
> 标签：c++, algorithm

我有一个输入文件，我想根据时间戳进行排序，时间戳是每条记录的子字符串。我想存储多个属性

该列表目前大约有 1000 条记录。但是，我希望它能够扩大一点以防万一。

当我通过搜索整个列表以插入链接列表时，大约需要 20 秒。现在，仅仅填充一个向量并输出到文件需要 4 秒（这听起来太长了）？

我想使用合并排序或快速排序（合并排序对我来说似乎更容易一些）。我遇到的麻烦是我没有看到很多使用对象而不是原始数据类型来实现这些排序的示例。

我可以使用向量或链表。到目前为止，我从这个网站得到的反馈是最有帮助的。我希望有人可以洒在神奇的精灵尘上，让我更轻松:)

任何关于以相当不错的性能进行此操作的最简单方法的链接或示例将不胜感激。我被困在如何用对象实现这些类型，因为我是 C++ 的新手 :)

这是我的新代码的样子（还没有排序）：

```
class CFileInfo  
{  
    public:  
    std::string m_PackLine;  
    std::string m_FileDateTime;  
    int m_NumDownloads;  
};  
void main()  
{  
    CFileInfo packInfo;  
    vector<CFileInfo> unsortedFiles;  
    vector<CFileInfo>::iterator Iter;  
    packInfo.m_PackLine = "Sample Line 1";  
    packInfo.m_FileDateTime = "06/22/2008 04:34";  
    packInfo.m_NumDownloads = 0;  
    unsortedFiles.push_back(packInfo);  
    packInfo.m_PackLine = "Sample Line 2";  
    packInfo.m_FileDateTime = "12/05/2007 14:54";  
    packInfo.m_NumDownloads = 1;  
    unsortedFiles.push_back(packInfo);  
    for (Iter = unsortedFiles.begin(); Iter != unsortedFiles.end(); ++Iter )   
    {  
        cout << " " << (*Iter).m_PackLine;  
    }  
} 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-12-01T19:30:00.300

我不确定我是否正确理解了您的问题，您的问题是定义排序函子吗？STL 排序通常被实现为内省排序，这对于大多数情况都非常有用。

```
struct sort_functor
{
    bool operator()(const CFileInfo & a, const CFileInfo & b) const
    {

        // may be a little bit more subtle depending on what your strings look like
        return a.m_FileDateTime < b.m_FileDateTime;
    }
}

std::sort(unsortedFiles.begin(), unsortedFile.end(), sort_functor()); 
```

或使用 boost::lambda

```
std::sort(unsortedFiles.begin(), 
    unsortedFile.end(),
    bind(&CFileInfo::m_FileDateTime, _1) < bind(&CFileInfo::m_FileDateTime, _2)); 
```

是需要的信息吗？

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-12-02T05:09:48.990

对链表进行排序本质上是 O(N^2) 或涉及外部随机访问存储。

向量具有随机访问存储。数组也是如此。排序可以是 O(NlogN)。

在 1000 个元素时，您将开始看到 O(N^2) 和 O(NlogN) 之间的差异。在 1,000,000 个元素中，您肯定会注意到其中的差异！

在非常特殊的情况下有可能得到 O(N) 排序。（例如：对一副扑克牌进行排序。我们可以创建一个函数（卡片），将每张卡片映射到其排序位置。）

但总的来说，O(NlogN) 是最好的。所以你不妨使用 STL 的 sort()！
只需添加*#include <算法>*

* * *

您只需要添加一个运算符<()。或排序函子。

但是有一个建议：看在上帝的份上，如果你要对日期进行排序，要么将其编码为一个 long int 表示自纪元以来的秒数（mktime？），或者至少使用***“年/月/日” -hour:minute:second.fraction"***格式。（并确保所有内容都是带前导零的 2（或 4）位数字！）比较“6/22/2008-4:34”和“12/5/2007-14:54”需要解析！比较“2008/06/22-04:34”和“2007/12/05-14:54”要容易得多。（虽然仍然比比较两个整数效率低得多！）

* * *

Rich 写道: ***其他答案似乎更多地涉及语法，这是我真正缺乏的。***

行。使用基本的“int”类型，我们有：

```
#define PRINT(DATA,N) for(int i=0; i<N; i++) { cout << (i>0?", ":"") << DATA[i]; } cout << endl;

int
main()  
{
    // Creating and Sorting a stack-based array.
  int d [10] = { 1, 4, 0, 2, 8, 6, 3, 5, 9, 7 };
  PRINT(d,10);
  sort( d, d+10 );
  PRINT(d,10);

  cout << endl;

    // Creating a vector.
  int eData [10] = { 1, 4, 0, 2, 8, 6, 3, 5, 9, 7 };
  vector<int> e;
  for(int i=0; i<10; i++ )
    e.push_back( eData[i] );

    // Sorting a vector.
  PRINT(e,10);
  sort(e.begin(), e.end());
  PRINT(e,10);
} 
```

使用您自己的类型，我们有：

```
class Data
{  
public:  
  string m_PackLine;  
  string m_FileDateTime;  
  int    m_NumberDownloads;

    /* Lets simplify creating Data elements down below. */
  Data( const string & thePackLine  = "",
        const string & theDateTime  = "",
        int            theDownloads = 0 )
      : m_PackLine        ( thePackLine  ),
        m_FileDateTime    ( theDateTime  ),
        m_NumberDownloads ( theDownloads )
    { }

    /* Can't use constructor with arrays */
  void set( const string & thePackLine,
            const string & theDateTime,
            int            theDownloads = 0 )
    {
      m_PackLine        = thePackLine;
      m_FileDateTime    = theDateTime;
      m_NumberDownloads = theDownloads;
    }

    /* Lets simplify printing out down below. */ 
  ostream & operator<<( ostream & theOstream ) const
    {
      theOstream << "PackLine=\"" << m_PackLine
                 << "\"   fileDateTime=\"" << m_FileDateTime
                 << "\"   downloads=" << m_NumberDownloads;
      return theOstream;
    }

    /*
     * This is IT!  All you need to add to use sort()!
     *  Note:  Sort is just on m_FileDateTime.  Everything else is superfluous.
     *  Note:  Assumes "YEAR/MONTH/DAY HOUR:MINUTE" format.
     */
  bool operator< ( const Data & theOtherData ) const
    { return m_FileDateTime < theOtherData.m_FileDateTime; }

};

    /* Rest of simplifying printing out down below. */ 
ostream & operator<<( ostream & theOstream, const Data & theData )
  { return theData.operator<<( theOstream ); }

    /* Printing out data set. */
#define PRINT(DATA,N) for(int i=0; i<N; i++) { cout << "[" << i << "]  " << DATA[i] << endl; }  cout << endl;

int
main()
{  
    // Creating a stack-based array.
  Data d [10];
  d[0].set( "Line 1", "2008/01/01 04:34", 1 );
  d[1].set( "Line 4", "2008/01/04 04:34", 4 );
  d[2].set( "Line 0", "2008/01/00 04:34", 0 );
  d[3].set( "Line 2", "2008/01/02 04:34", 2 );
  d[4].set( "Line 8", "2008/01/08 04:34", 8 );
  d[5].set( "Line 6", "2008/01/06 04:34", 6 );
  d[6].set( "Line 3", "2008/01/03 04:34", 3 );
  d[7].set( "Line 5", "2008/01/05 04:34", 5 );
  d[8].set( "Line 9", "2008/01/09 04:34", 9 );
  d[9].set( "Line 7", "2008/01/07 04:34", 7 );

    // Sorting a stack-based array.
  PRINT(d,10);
  sort( d, d+10 );
  PRINT(d,10);

  cout << endl;

    // Creating a vector.
  vector<Data> e;
  e.push_back( Data( "Line 1", "2008/01/01 04:34", 1 ) );
  e.push_back( Data( "Line 4", "2008/01/04 04:34", 4 ) );
  e.push_back( Data( "Line 0", "2008/01/00 04:34", 0 ) );
  e.push_back( Data( "Line 2", "2008/01/02 04:34", 2 ) );
  e.push_back( Data( "Line 8", "2008/01/08 04:34", 8 ) );
  e.push_back( Data( "Line 6", "2008/01/06 04:34", 6 ) );
  e.push_back( Data( "Line 3", "2008/01/03 04:34", 3 ) );
  e.push_back( Data( "Line 5", "2008/01/05 04:34", 5 ) );
  e.push_back( Data( "Line 9", "2008/01/09 04:34", 9 ) );
  e.push_back( Data( "Line 7", "2008/01/07 04:34", 7 ) );

    // Sorting a vector.
  PRINT(e,10);
  sort(e.begin(), e.end());
  PRINT(e,10);
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-01T19:25:46.423

stl 在标头中有一个排序算法

```
 <algorithm> 
```

[这是](http://www.sgi.com/tech/stl/sort.html)SGI 手册的链接。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-12-01T19:30:23.733

在算法头中使用 std::sort ：

如果您为 CFileInfo 定义运算符 <，它应该可以正常工作。

或者，定义一个执行比较的函子，并将其作为单独的参数传递给排序函数。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-04T00:44:16.920

丰富——要回答你最近的问题（而不是你原来的问题），最好/最简单的方法是用 sscanf() 解析出日期。理想情况下，您希望一开始就以数字方式存储它。

使用*“YYYY/MM/DD-HH:MM”*字符串，您可以只比较字符串。所有的字符串都是相同的长度，当你从左到右阅读时，你从最大的时间增量到最小的时间增量。

**但是比较字符串是非常低效的！**

通常，日期存储为 time_t（整数）值，以自纪元（UTC 时间 00:00:00，1970 年 1 月 1 日）以来的秒数为单位测量。

mktime() 或 timegm()（如果您有 timegm）将从您提供的*“struct tm”*构造一个 time_t 值。

示例代码：

```
#define SHOW(X)  cout << # X " = " << (X)

int
main()
{
  const string s = "2008/12/03 12:48";
  struct tm    datetime;
  time_t       t;

  memset( & datetime, 0, sizeof(datetime) );

  if ( 5 != sscanf( s.c_str(), "%d/%d/%d %d:%d",
                    & datetime.tm_year,
                    & datetime.tm_mon,
                    & datetime.tm_mday,
                    & datetime.tm_hour,
                    & datetime.tm_min  ) )
  {
    cout << "FAILED to parse:  \"" << s << "\"" << endl;
    exit(-1);
  }

    /* tm_year - The number of years since 1900\. */
  datetime.tm_year -= 1900;

    /* tm_mon - The number of months since January, in the range 0 to 11\. */
  datetime.tm_mon --;

    /* tm_mday - The day of the month, in the range 1 to 31\. */
    /* tm_hour - The number of hours past midnight, in the range 0 to 23\. */
    /* tm_min - The number of minutes after the hour, in the range 0 to 59\. */
  // No change.

  /* If using mktime, you may need these to force UTC time:
   *   setenv("TZ","",1);
   *   tzset();
   */

  t = mktime( & datetime );

  SHOW( t ) << endl;
  SHOW( asctime( & datetime ) );
  SHOW( ctime( & t ) );
} 
```

现在给定两个时间（日期）值，例如*time_t t1, t2*，您可以将它们与*t1<t2*进行比较。

# vb6 - VB6：Capicom 在 WinXP 上崩溃

> ID：331901
> 
> 赞同：0
> 
> 时间：2008-12-01T19:26:31.383
> 
> 标签：vb6, encryption, crash, capicom

有关解决此崩溃的任何建议？

下面的代码在 logging`<part>14`和 logging之间间歇性地崩溃`<part>15`。 `Plaintext`是一个路径字符串（在这种情况下它是`"C:\Documents and Settings\Brian\Desktop\Joy\"`，尽管明显缺乏这种快乐。我有一种下沉的感觉，这是某种邪恶记忆问题的症状。我尝试了 Capicom 2.1.0.1 和 2.1.0.2，两者其中崩溃。后者给出一个标准的错误报告消息，前者无声无息地死掉（即程序自行关闭）。我在别人的 XP 机器上测试了同样的问题，尽管它在 Vista 上运行良好。

```
Const curMthd = "EncryptStringWrap"
Dim Message As CAPICOM.EncryptedData
Set Message = New CAPICOM.EncryptedData
Dim oUtil As CAPICOM.Utilities
Set oUtil = New CAPICOM.Utilities
E.ErrorLog "<PART>14"
Message.Content = plaintext
E.ErrorLog "<PART>15" 
```

编辑：这不是导致问题的数据。我一直在手动传递数据来测试这个；它工作正常。令人讨厌的是，当我将测试代码放入初始化时，该错误就消失了。邪恶的 heisenbug :( 。可能是内存问题 :(

编辑2：重写和[这里](https://stackoverflow.com/questions/337835/vb6-program-crashing-part-2-advice-on-fixing-access-violation-0xc00000005)的东西，然后关闭。与这个问题本身并不完全相同，但这个问题是基于对问题的严重误解。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-12-01T19:52:17.090

斜杠可能会导致 CAPICOM 无法正确处理字符串。通过将代码放入循环中，您可以在其中输入不同的字符串，您可以找出问题顺序。

鉴于 CAPICOM 是 cryptoAPI 的包装器，这可以为您提供另一条路径，您可以在其中运行测试项目，使用相同的序列和相同类型的调用直接访问 Crypto API。从互联网上阅读是一个薄包装。

MSDN 有一些示例代码[这里](http://support.microsoft.com/default.aspx?scid=kb;en-us;821762)还有更多可用的。

我以这种方式处理了各种“包装器” Com DLL 的许多问题。找出导致问题的数据。使用相同的数据直接使用 Win API 编写测试项目。然后评价。

结果通常是我实现自己的包装器。或者发现我少了一个步骤或者配置错误。

请注意，这适用于 .NET 中的包装程序集，并具有能够使用反射器查看包装器在做什么的额外好处。

# python - 使用 Python 将 PDF 转换为一系列图像

> ID：331918
> 
> 赞同：50
> 
> 时间：2008-12-01T19:31:07.957
> 
> 标签：python, pdf, imagemagick, jpeg, python-imaging-library

我正在尝试使用 Python 将多页 PDF 转换为一系列 JPEG。我可以使用可用工具轻松地将 PDF 拆分为单独的页面，但我无法找到任何可以将 PDF 转换为图像的内容。

PIL 不起作用，因为它无法读取 PDF。我发现的两个选项是通过 shell 使用 GhostScript 或 ImageMagick。这对我来说不是一个可行的选择，因为这个程序需要是跨平台的，而且我不能确定这些程序中的任何一个在将要安装和使用它的机器上是否可用。

是否有任何 Python 库可以做到这一点？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2008-12-01T19:33:44.490

[ImageMagick](https://www.imagemagick.org/script/index.php)有[Python 绑定](http://www.imagemagick.org/download/python/)。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2016-03-20T11:13:40.377

这是使用 python ghostscript 模块（由'$ pip install ghostscript'安装）对我有用的东西：

```
import ghostscript

def pdf2jpeg(pdf_input_path, jpeg_output_path):
    args = ["pdf2jpeg", # actual value doesn't matter
            "-dNOPAUSE",
            "-sDEVICE=jpeg",
            "-r144",
            "-sOutputFile=" + jpeg_output_path,
            pdf_input_path]
    ghostscript.Ghostscript(*args) 
```

我还在我的电脑上安装了 Ghostscript 9.18，否则它可能无法正常工作。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-03-18T10:27:39.307

你无法避免 Ghostscript 依赖。甚至 Imagemagick 也依赖 Ghostscript 的 PDF 阅读功能。其原因在于 PDF 格式的复杂性：PDF 不仅包含位图信息，而且主要包含矢量形状、透明度等。此外，确定这些对象中的哪些出现在哪个页面上非常复杂。

因此，PDF 页面的正确呈现显然超出了纯 Python 库的范围。

好消息是 Ghostscript 已预装在许多 Windows 和 Linux 系统上，因为所有那些 PDF 打印机（Adobe Acrobat 除外）也需要它。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-01-04T20:58:05.290

如果您使用的是 linux，则某些版本会附带一个名为“pdftopbm”的命令行实用程序。查看[netpbm](http://en.wikipedia.org/wiki/Netpbm_format)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2011-12-13T23:09:55.197

也许相关：[http ://www.swftools.org/gfx_tutorial.html](http://www.swftools.org/gfx_tutorial.html)

# c++ - 这个指针转换我做错了什么？

> ID：331937
> 
> 赞同：3
> 
> 时间：2008-12-01T19:40:18.890
> 
> 标签：c++, pointers

我正在为 C++ 构建一个 GUI 类并处理很多指针。一个示例调用：

```
mainGui.activeWindow->activeWidget->init(); 
```

我的问题是我想将**activeWidget**指针转换为另一种类型。 **activeWidget**属于 GUI_BASE 类型。派生自 BASE 我还有其他类，例如 GUI_BUTTON 和 GUI_TEXTBOX。我想将**activeWidget**指针从 GUI_BASE 转换为 GUI_TEXTBOX。我认为它看起来像这样：

```
(GUI_TEXTBOX*)(mainGui.activeWindow->activeWidget)->function(); 
```

这不起作用，因为编译器仍然认为指针是 GUI_BASE 类型。但是，以下代码确实有效：

```
GUI_TEXTBOX *textbox_pointer;
textbox_pointer = (GUI_TEXTBOX*)mainGui.activeWindow->activeWidget;
textbox_pointer->function(); 
```

我希望我的问题只是语法问题。谢谢您的帮助 ：）

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2008-12-01T19:43:19.370

问题是强制转换的优先级低于 . -> () [] 运算符。您必须使用 C++ 样式转换或添加额外的括号：

```
((GUI_TEXTBOX*)mainGui.activeWindow->activeWidget)->function();  // Extra parentheses
dynamic_cast<GUI_TEXTBOX*>(mainGui.activeWindow->activeWidget)->function();  // C++ style cast 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2008-12-01T19:57:56.470

您不应该使用 C 风格的演员表。

您需要使用 C++ 动态转换。然后，这将允许您在调用该方法之前测试该对象实际上是一个 GUI_TEXTBOX。

```
GUI_TEXTBOX* textboxPointer  = dynamic_cast<GUI_TEXTBOX*>(mainGui.activeWindow->activeWidget);
if (textboxPointer)
{
     // If activeWidget is not a text box then dynamic_cast
     // will return a NULL.
     textboxPointer->textBoxMethod();
}

// or 

dynamic_cast<GUI_TEXTBOX&>(*mainGui.activeWindow->activeWidget).textBoxMethod();

// This will throw bad_cast if the activeWidget is not a GUI_TEXTBOX 
```

请注意，C 风格的强制转换和 reinterpret_cast<>() 不能保证在这种情况下工作（尽管在大多数编译器上它们会[但这只是实现的一个方面，你很幸运]）。如果分配给 activeWidget 的对象实际上使用多重继承，那么所有的赌注都将被取消，在这种情况下，如果您不使用 dynamic_cast<>()，大多数编译器都会开始出现奇怪的错误。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-12-01T19:42:06.673

你只需要更多的括号：

```
((GUI_TEXTBOX*)(mainGui.activeWindow->activeWidget))->function(); 
```

实际上，这也可以：

```
((GUI_TEXTBOX*)mainGui.activeWindow->activeWidget)->function(); 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-12-01T19:44:18.697

正如其他人指出的那样：

```
((GUI_TEXTBOX*)(mainGui.activeWindow->activeWidget))->function(); 
```

原因是`->`运算符的优先级高于类型转换。

* * *

我将在此处为“实用 C”中的 Steve Oualline 规则添加另一个插件：

> C 中有 15 条优先规则（&& 在 || 之前 ?:)。实用的程序员将这些减少到两个：
> 
> 1）乘法和除法在加法和减法之前。
> 
> 2）在其他所有内容周围加上括号。

* * *

最后一点：向下投射可能很危险，请参阅[Martin York 的答案](https://stackoverflow.com/questions/331937/what-am-i-doing-wrong-with-this-pointer-cast#332004)以获取有关使用`dynamic_cast<>`安全执行投射的信息。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-12-01T19:45:32.907

这是运算符的顺序问题（运算符优先级）。考虑您尝试的无效代码：

> (GUI_TEXTBOX*)(mainGui.activeWindow->activeWidget)->function();

在这里，`->`运算符的优先级高于您的演员表。这就是您的其他代码示例有效的原因。在另一个示例中，您首先显式转换，然后调用该函数。为了使其更加精简，请尝试添加另一组括号，以便代码如下所示：

> ((GUI_TEXTBOX*)(mainGui.activeWindow->activeWidget))->function();

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-12-01T21:43:03.620

有两种策略。一种是“快速失败”：如果您转换为错误的类型，那么您将抛出异常，因此您会立即注意到您转换为错误的类型。另一个是“快速运行”：没有检查演员的目标类型。仅当您知道自己不会错或没有基类或派生类的多态类型时，才应使用此强制转换。我根据您的需要推荐以下内容（请记住在投射时保留 const ）：

```
dynamic_cast<GUI_TEXTBOX&>(*mainGui.activeWindow->activeWidget).function(); 
```

[*快速失败*](http://en.wikipedia.org/wiki/Fail_Fast)：`std::bad_cast`如果您转换为错误的类型，则抛出。

```
static_cast<GUI_TEXTBOX*>(mainGui.activeWindow->activeWidget)->function(); 
```

[*快速运行*](http://en.wikipedia.org/wiki/Computer_performance)：不进行运行时检查。所以它不会很快失败。相反，如果您转换为错误的类型，它将产生未定义的行为。谨防！

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-12-01T19:42:19.403

```
((GUI_TEXTBOX*)(mainGui.activeWindow->activeWidget))->function(); 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-12-01T19:44:40.863

-> 具有比 (cast) 更高的优先级，因此成员访问是在强制转换之前完成的。请参阅此处了解运算符优先级：[http ://www.cppreference.com/wiki/operator_precedence](http://www.cppreference.com/wiki/operator_precedence)

如上所述，您需要更多的括号。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-12-01T20:02:50.610

```
if( GUI_TEXTBOX* ptr = 
      dynamic_cast<GUI_TEXTBOX *>(mainGui.activeWindow->activeWidget) )
{
   ptr->function();
} 
```

您想要这样做的原因是因为您尝试强制转换的指针可能实际上并不指向 GUI_TEXTBOX 对象，并且您希望在调用文本框方法之前确保它确实指向它。C++ 的动态转换正是您所需要的。

# testing - 在不访问短信计划的情况下测试 SMS 代码

> ID：331941
> 
> 赞同：6
> 
> 时间：2008-12-01T19:41:18.390
> 
> 标签：testing, sms

有没有办法在没有短信计划的情况下测试短信？

没有任何方法可以设置等效的模拟电子邮件服务器来测试 SMS 服务吗？还有其他方法可以完成任务吗？也许设置一个可以接收短信的 GrandCentral 帐户？

我希望测试发送到多个帐户的 SMS 消息，而无需找到多个有发短信计划和协调工作的人。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-19T20:41:44.790

谷歌现在有了我想要的答案。随着他们新的 Google Voice（以前是 GrandCentral）的推出，他们增加了接收短信到电话号码的功能（目前是免费的）。虽然在技术上有点像文本计划，但理论上可以注册几个帐户并能够测试多个电话号码。

[http://www.google.com/voice/](http://www.google.com/voice/)

更新（2010 年 11 月）：也许现在更好的方法是使用 Tropo (tropo.com) 或 Twilio (twilio.com)。它们都提供低成本的 SMS 消息传递，并且 Tropo 是免费开发的。我一直在使用 Tropo，它的设置、编写和编码非常快速和容易。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-03T14:48:25.140

这取决于您发送 SMS 消息的方式。如果您使用的是电子邮件方法（<十位数字>@<cell provider's doman>），您可以使用可以自动清除的常规电子邮件帐户来伪造它。如果您使用的是实际的 SMS 发布者，最好的办法是重构设计，以便您可以测试您的函数是否被调用了预期的次数，但实际上并没有发送消息。然后，当您想测试生产就绪的代码时，您实际上会召集一群人并尝试一下。

拥有一个不对传入短信收费的提供商（如 US Cellular）在这种情况下会派上用场。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-19T21:02:00.327

SMS 文本可以在几种不同的协议下完成。我使用[Easy SMPP .NET 库](http://easysmpp.sf.net/)和这个基于 java 的[SMPP 服务器模拟器在](http://adywicaksono.wordpress.com/2007/07/11/smpp-server-simulator/)[SMPP](http://en.wikipedia.org/wiki/SMPP)上取得了成功。它为我节省了一大笔高价的服务费。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-28T15:09:45.407

您可以向他们的手机发送电子邮件：

18005551212@txt.att.net (IIRC)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-04-13T00:15:05.823

如果您真的想向真实的电话号码发送一些测试消息并查看发送的内容，您可以尝试我们的 TelQ 的[SMS 质量测试](https://telqtele.com)平台。

# .net - 基于 ORM 的项目中的类使用

> ID：331951
> 
> 赞同：0
> 
> 时间：2008-12-01T19:43:32.503
> 
> 标签：.net, nhibernate, orm, subsonic

这个问题是关于 NHibernate、Subsonic、Linq2SQL 等 ORM 项目中的“最佳使用”场景......

所有这些工具都生成基本的实体类，有些带有属性，有些没有。人们是否将这些课程用作他们的业务课程？或者是否将数据从 ORM 生成的类批量复制到手动创建的业务类？

谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-01T19:49:06.893

我倾向于以相反的方式工作。我按照我需要的方式创建业务对象，并创建从我的对象到数据的 NHibernate 映射。您可以让 NHibernate 根据您的映射为您生成一个模式，或者您可以创建自己的模式，并创建在两者之间的映射。Linq2Sql 和实体框架不支持这个。在这一点上，我无法与 Subsonic 交谈。

我通常创建我的业务类，并让应用程序至少部分运行，而无需任何数据库。通过这种方式，我可以更好地理解应用程序应该做什么，以及在决定如何持久化对象之前它应该如何表现。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-01T19:52:46.917

提到的所有工具都有几个解决方案，答案是它取决于您的项目范围。

这是我不久前回答的[关于 LINQ to SQL 的类似问题。](https://stackoverflow.com/questions/222895/can-linq-to-sql-generated-objects-be-decoupled#229905)

希望有帮助！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-01T20:11:42.713

我通常直接在业务层和表示层中使用实体。数据层定义实体，业务层操作实体或查询实体列表，表示层显示实体。

我认为创建单独的业务对象并在两者之间复制数据将是很多不必要的开销。但是如果你发现你必须这样做，我建议只包装实体而不是来回复制数据。您可以隐藏实体并使用属性来公开成员和更改行为。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-04T22:07:19.450

SubSonic and Linq2Sql are one-to-one orm mapper. Consider the situation where the datbase is normalized. For example an employee info is broken down in 3 different tables but in your domain model you'd want only one object Employee represent the info. This is where SubSonic and Linq2Sql fail. NHibernate allows you to map your domain object to multiple tables. Also you'd want to stay away from auto generated code. NHibernate allows you to define your own POCO (Plain old C# object) domain and has different ways that allows us to map that to table(s) in database

# java - Java：有足够的空闲堆来创建对象？

> ID：331953
> 
> 赞同：7
> 
> 时间：2008-12-01T19:44:04.063
> 
> 标签：java

我最近在一些代码中遇到了这个问题——基本上有人试图创建一个大对象，在没有足够的堆来创建它时应对：

```
try {
    // try to perform an operation using a huge in-memory array
    byte[] massiveArray = new byte[BIG_NUMBER];
} catch (OutOfMemoryError oome) {
    // perform the operation in some slower but less
    // memory intensive way...
} 
```

这似乎不对，因为 Sun 自己建议您不要尝试 catch`Error`或其子类。我们讨论了它，另一个想法是明确检查空闲堆：

```
if (Runtime.getRuntime().freeMemory() > SOME_MEMORY) {
    // quick memory-intensive approach
} else {
    // slower, less demanding approach
} 
```

再一次，这似乎不能令人满意——特别是因为选择一个值`SOME_MEMORY`很难与所讨论的工作相关联：对于一些任意的大对象，我如何估计它的实例化可能需要多少内存？

有没有更好的方法来做到这一点？在 Java 中是否有可能，或者是否有任何在语言本身的抽象级别以下管理内存的想法？

**编辑 1：**在第一个示例中，估计`byte[]`给定长度的 a 可能占用的内存量实际上可能是可行的，但是是否有更通用的方法可以扩展到任意大对象？

**编辑2：**正如@erickson 指出的那样，有一些方法可以在创建对象后估计它的大小，但是（忽略基于先前对象大小的统计方法）对于尚未创建的对象有没有办法这样做？

关于捕捉是否合理似乎也有一些争论`OutOfMemoryError`——有人知道任何结论吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-01T20:07:36.527

freeMemory 不太正确。您还必须添加 maxMemory()-totalMemory()。例如，假设您以 max-memory=100M 启动 VM，JVM 可能在您的方法调用时仅使用（来自操作系统）50M。其中，假设 JVM 实际使用了 30M。这意味着您将显示 20M 空闲（大致，因为我们在这里只讨论堆），但是如果您尝试制作更大的对象，它将尝试获取其合同允许它从放弃和出错之前的操作系统。所以你实际上（理论上）有 70M 可用。

为了使这更复杂，它在上面的示例中报告的 30M 包含可能有资格进行垃圾收集的东西。因此，您实际上可能有更多可用内存，如果达到上限，它将尝试运行 GC 以释放更多内存。

您可以尝试通过手动触发 System.GC 来绕过这一点，但这并不是一件非常好的事情，因为

- 不保证立即运行

- 它会在运行时停止所有在其轨道上的东西

你最好的选择（假设你不能轻易地重写你的算法来处理更小的内存块，或者写入内存映射文件，或者更少的内存密集型）可能是对所需的内存进行安全的粗略估计并确保它在您运行函数之前可用。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-01T20:06:30.773

我不相信有一种合理的通用方法可以安全地假设为 100% 可靠。即使是 Runtime.freeMemory 方法也很容易受到这样一个事实的影响，即在垃圾回收之后您实际上可能有足够的内存，但除非您强制执行 gc，否则您不会知道这一点。但是也没有万无一失的方法来强制 GC。:)

话虽如此，我怀疑如果你真的知道你需要多少，并且`System.gc()`事先运行了一个，并且你在一个简单的单线程应用程序中运行，那么你将有一个相当不错的机会来正确使用 .freeMemory称呼。

但是，如果这些约束中的任何一个失败，并且您得到 OOM 错误，那么您就会退缩，因此可能不会比仅仅捕获 Error 子类更好。虽然存在一些与此相关的风险（Sun 的 VM 并没有对 OOM 之后发生的情况做出很多保证......存在内部状态损坏的一些风险），但有许多应用程序只是抓住它并继续生活不会对您造成严重伤害。

然而，在我看来，一个更有趣的问题是，为什么在某些情况下您确实有足够的内存来执行此操作，而在其他情况下您却没有？也许对所涉及的性能权衡进行更多分析才是真正的答案？

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-01T20:06:58.667

绝对捕捉错误是最糟糕的方法。当您对此无能为力时，就会发生错误。甚至没有创建日志，喘气，比如“......休斯顿，我们失去了虚拟机”。

第二个原因我不太明白。这很糟糕，因为很难将 SOME_MEMORY 与操作联系起来？你能给我改一下吗？

我看到的唯一选择是使用硬盘作为内存（过去的 RAM/ROM）我想这就是你在“其他更慢、要求更低的方法”中所指的

每个平台都有其限制，Java 支持与您的硬件愿意提供的 RAM 一样多（实际上是您通过配置 VM）在 Sun JVM impl 中可以使用

```
-Xmx 
```

选项

像

```
java -Xmx8g some.name.YourMemConsumingApp 
```

例如

当然，您最终可能会尝试执行需要 10 GB RAM 的操作

如果这是您的情况，那么您绝对应该交换到磁盘。

此外，使用策略模式可以编写更好的代码。虽然在这里看起来有点矫枉过正：

```
if (isEnoughMemory(SOME_MEMORY)) {
    strategy = new InMemoryStrategy();
} else {
    strategy = new DiskStrategy();
}

strategy.performTheAction(); 
```

但如果“else”涉及大量代码并且看起来很糟糕，它可能会有所帮助。此外，如果您可以使用第三种方法（例如使用云进行处理），您可以添加第三种策略

```
...
strategy = new ImaginaryCloudComputingStrategy();
... 
```

:P

**编辑**

在使用第二种方法遇到问题后：如果有时您不知道要消耗多少 RAM，但您确实知道还剩多少，则可以使用混合方法（当您有足够的 RAM 时） , ROM[disk] 当你不这样做时）

假设这个理论问题。

假设您从流中接收一个文件并且不知道它有多大。

然后你对该流执行一些操作（例如加密它）。

如果你只使用 RAM 会非常快，但是如果文件足够大，可以消耗你所有的 APP 内存，那么你必须在内存中执行一些操作，然后交换到文件并在那里保存临时数据。

VM 将在内存不足时进行 GC，您获得更多内存，然后执行其他块。并重复此操作，直到您处理完大流。

```
while( !isDone() ) {
    if (isMemoryLow()) {
        //Runtime.getRuntime().freeMemory() < SOME_MEMORY + some other validations 
        swapToDisk(); // and make sure resources are GC'able
    }

    byte [] array new byte[PREDEFINED_BUFFER_SIZE];
    process( array );

    process( array );
}

cleanUp(); 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-12-01T20:11:27.923

您可以使用一些[工具来估计现有对象的大小](https://stackoverflow.com/questions/52353/in-java-what-is-the-best-way-to-determine-the-size-of-an-object)；您可以调整其中的一些来预测尚未创建的对象的大小。

但是，在这种情况下，我认为最好捕获错误。首先，请求空闲内存并不能说明垃圾收集后可用的内存，这将在引发 OOME 之前执行。而且，请求垃圾收集`System.gc()`是不可靠的。它通常被明确禁用，因为它会破坏性能，如果它没有被禁用……好吧，它会在不必要的使用时破坏性能。

从大多数错误中恢复是不可能的。但是，可恢复性取决于调用者，而不是被调用者。在这种情况下，如果你有一个从 中恢复的策略`OutOfMemoryError`，那么抓住它并回退是有效的。

我想，在实践中，它真的归结为“慢”和“快”方式之间的区别。如果“慢”方法足够快，我会坚持下去，因为它更安全、更简单。而且，在我看来，允许它用作后备意味着它“足够快”。不要让小的优化破坏应用程序的可靠性。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-12-01T20:23:13.860

“尝试分配和处理错误”的方法是非常危险的。

*   如果你几乎没有记忆怎么办？稍后可能会发生 OOM 异常，因为您使事情过于接近极限。几乎任何库调用都会至少短暂地分配内存。
*   在您分配期间，不同的线程可能会在尝试分配相对较小的对象时收到 OOM 异常。即使你的分配注定要失败。

唯一可行的方法是您的第二种方法，并在其他答案中注明了更正。但是当您决定使用内存密集型方法时，您必须确定并在堆中留下额外的“溢出空间”。

# hyperlink - 从超链接打开新窗口/选项卡是否合理？

> ID：331955
> 
> 赞同：5
> 
> 时间：2008-12-01T19:44:04.610
> 
> 标签：hyperlink, xhtml-1.0-strict

一个简单的问题，由于在 HTML 4.0 Strict 和 XHTML 1.0 Strict 中删除了 target 属性。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-12-01T19:49:00.793

我个人不这么认为，随着网络用户变得更加精明，他们会要求浏览器提供一个新窗口。当一个网站经常这样做时，这让我很恼火。

我认为这个问题有点主观。如果您正在启动一个 javascript 游戏或其他东西，那可能会很好。

这是[尼尔·特纳不这样做的理由](http://www.sitepoint.com/article/beware-opening-links-new-window/)。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-01T19:49:21.383

在 Digg 或 reddit 等社交内容网站上，我更喜欢在新窗口/选项卡中打开链接，因为我会不断返回原始页面以获取更多链接来查看。

话虽如此，我认为只要有可能，您就应该允许登录用户自己做出决定。我知道 Digg 允许用户选择他们希望链接的行为方式。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-01T19:53:43.293

我认为这是非常主观的，所以我只是作为用户发表我的意见。我更喜欢这只是默认行为。如果我想在新选项卡中使用它，我将单击鼠标中键。

如果您要在新窗口中打开它，请[像这样 [新窗口]](http://www.google.com/)或其他内容警告我。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-12-01T20:07:06.293

作为法律，每条法律都有例外。尽管在大多数情况下简单的链接是最好的，但有时新窗口中的链接正是需要的。

例如，我非常喜欢在新窗口中打开任何外部链接的博客和论坛，因此我不会忘记我正在阅读的原始帖子。

放置它们的另一个好地方是当您单击图片以在互联网商店或其他地方获得更大的版本时。

您确实必须根据具体情况进行评估，但我的意见是最终两者都是良好 UI 所必需的。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-12-01T19:54:31.297

如果它是外部链接，我会这样做，除此之外，这可能是一个坏主意。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-12-01T20:51:32.897

我强制创建新窗口的唯一一次是当我正在设计的页面被用作 Sharepoint 站点的 Web 部件时。

我是这样看的，如果你强制一个新窗口，你已经从用户那里获得了选择。那很糟。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-12-01T20:55:45.183

除了两个例外，答案必须是响亮的“不”。

理由：是的，正如其他人已经指出的那样，在很多情况下，我更喜欢在另一个选项卡中打开链接。*但是谢谢，我会*自己决定*何时*何地。网络的基本原则是用户坐在*用户代理*，也就是网络浏览器旁。换句话说，浏览器是代表用户的代理。如果我想在另一个选项卡中打开某个特定链接，我会按命令单击（或在另一个操作系统上按 ctrl-clik），如果不这样做，我会定期单击。当网页上的链接在没有我询问的情况下在新选项卡中打开链接时，它会让我烦恼不已，并破坏了网络的可预测性和熟悉度。

 **Exception 1: When clicking to see a large version of a picture or some other plain pop-up window. I see this as a separate topic.

Exception 2: Fully Ajaxy web applications, which seem to set aside most of the rules of the web anyway.

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-12-01T20:39:21.953

是的，在网络应用程序中，有时在拉出需要查看的辅助内容时使用弹出窗口而不丢失页面上的内容是有意义的。

例如，我使用弹出窗口来显示报告。在这些情况下*（视情况而定）*，用户需要同时查看报表和屏幕，而不是导航到报表界面。

# asp.net - 如何将文本框切换为, ，还是使用 jQuery？

> ID：331963
> 
> 赞同：3
> 
> 时间：2008-12-01T19:46:09.473
> 
> 标签：asp.net, javascript, jquery, html

我正在尝试“单一来源”可以处于编辑模式或查看模式的表单页面。由于各种原因，这没有使用 ASP.Net FormView 或 DetailsView 控件。

由于没有办法在不将其内容变为灰色的情况下禁用文本框（好吧，我们可以“吃掉”所有的击键，但这也不是很优雅）并且禁用下拉列表或列表框不是我们想要的想要，我们的第一个尝试是复制所有带有标签的表单输入控件，并使用 CSS 来根据表单的模式选择哪些是可见的。这行得通，但是编辑起来很难看，并且每次都必须在隐藏代码中填充这两个控件。

我们可以控制代码隐藏中的可见性以避免填充两个控件，但我们仍然必须将它们都添加到表单中。

所以我有了使用 jQuery 将输入控件替换为`<label>`、`<div>`或`<span>`元素的想法。在某种程度上，这是通过创建适当的选择器并使用`replace()`jQuery 方法动态交换元素来实现的。

问题是我不仅需要复制内容，还需要复制原始输入控件的样式、属性和大小（此时我们只讨论文本框——我们对下拉列表和列表框有不同的解决方案） .

蛮力应该起作用 - “备份”输入控件的所有属性，创建新的“只读”元素，然后用新元素替换输入控件。我正在寻找的是更简单的东西。

简而言之，使用jQuery，用标签替换文本框并使标签具有相同的内容并出现在与文本框相同的位置和样式的最佳方法是什么？

这是我到目前为止所拥有的：

```
$(":text").each( function() {
    var oldClass = $(this).attr("class");
    var oldId = $(this).attr("id");
    var oldHeight = $(this).outerHeight();
    var oldWidth = $(this).outerWidth();
    var oldStyle = $(this).attr("style");
    $(this).replaceWith("<div id='" + oldId + "'>" + $(this).val() + "</div>");
    $("div#" + oldId).attr("class", oldClass);
    $("div#" + oldId).attr("style", oldStyle);
    $("div#" + oldId).width(oldWidth);
    $("div#" + oldId).height(oldHeight);
    $("div#" + oldId).css("display", "inline-block");
}); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-01T21:15:07.733

这可能不适合您的需求，但有可能。

`<input>`和`<textarea>`标签支持只读属性。只读字段的行为与禁用的行为略有不同。以下是[HTML 4.01 Recommendation](http://www.w3.org/TR/html401/)所说的：

> 设置后，readonly 属性对元素有以下影响：
> 
> 只读元素获得焦点，但用户不能修改。
> 只读元素包含在标签导航中。
> 只读元素可能会成功。（“成功”表示将作为参数提交。）

另一个关键区别是具有此属性的元素可以按您喜欢的方式设置样式。（例如，您可以删除或更改边框和背景。）因此，您不必创建新元素和复制属性，只需添加或删除只读属性即可。

然后，您可以为这些字段创建样式`"input[readonly] {}"`。当然，请注意流行版本的 IE 忽略 CSS 中的属性选择器。（所以也许只是定义一个你添加和删除的类。）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-01T20:15:18.073

[为什么不使用Jeditable](http://www.appelsiini.net/projects/jeditable)之类的就地编辑插件。通过这种方式，您可以生成视图模式，并通过单击按钮来编辑每个字段。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-01T19:55:46.550

完成此操作后，我必须按照您的描述“吃掉”每个击键，并将其镜像到镜像`<input`or`<select`元素的“隐藏”跨度标签中。span 标签都有一个 css 类，它使用媒体选择器设置为仅显示打印，输入有一个 css 类，该类设置为仅显示在屏幕上。

如果您不介意不缩放到文本大小的静态宽度，您也可以将`<input`标签设置为不显示打印边框，但这很丑陋。

# session - 如何检测会话是活动的还是过期的？

> ID：331964
> 
> 赞同：4
> 
> 时间：2008-12-01T19:46:10.720
> 
> 标签：session, soap, gsoap

我可以打电话来确定我的会话在 gsoap 客户端中是否仍然存在吗？

我看到检查会话是否仍然存在的唯一方法是在每次肥皂调用后检查所有 cookie 值是否匹配。自从设置了 tcp_keep_alive 标志以来，gsoap 似乎会意识到会话处于活动状态。gsoap 中是否有允许我在调用肥皂之前检查此内容的功能？是否有回调会通知我会话丢失？或者我应该为此目的制作一个虚拟肥皂方法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2018-07-16T08:25:06.787

您可以使用 Genivia 插件来 Ckeck 并创建或更新`localhost:8080`在任何路径上都有效的会话：

```
soap->cookie_domain = "localhost:8080";
struct soap_session *session = soap_start_session(soap, NULL, NULL); 
```

要创建新的会话变量或修改该会话中的现有会话变量：

```
soap_set_session_var(soap, "session_var_name", "session_var_value", NULL, NULL); 
```

要访问该会话变量的值：

```
const char *value = soap_get_session_var(soap, "session_var_name", NULL, NULL); 
```

要删除该会话变量：

```
soap_clr_session_var(soap, "session_var_name", NULL, NULL); 
```

# c# - 从部分类中检测 DataRow 更改

> ID：331968
> 
> 赞同：1
> 
> 时间：2008-12-01T19:47:25.070
> 
> 标签：c#, ado.net, dataset, partial-classes

假设我有一个表示域对象的接口：

```
public interface IFoo
{
    Bar Bar { get; }
} 
```

该`Bar`类型是一系列对象，每个对象都有一个稍微不同的模式。在数据库中，这表示为 XML（这是一个移动应用程序，所以它只是`nvarchar`，**而不是**真正的 XML 列）。

我有一个生成`DataSet`的包含一个`FooDataTable`和相应的`FooRow`对象：

```
// AcmeDataSet.designer.cs

public partial class FooRow : DataRow
{
    public string BarXml
    {
        // Generated get and set
    }
} 
```

我想实现`IFoo`和缓存的反序列化实例`Bar`：

```
// FooRow.cs

public partial class FooRow : IFoo
{
    private Bar _bar;

    Bar IFoo.Bar
    {
        get { return _bar; }
    }
} 
```

我如何才能从部分类中确定 的值`BarXml`已更改？

我意识到`FooDataTable`包含`ColumnChanging`和`ColumnChanged`事件，但我不知道如何订阅它们。Linq to Sql 的部分方法没有类似物`OnCreated`，我不知道另一种方法可以挂接到生成的构造函数中。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-01T19:54:40.453

如果我理解正确，那么您的 FooRow 对象（实例）是从 Type DataRow 派生的某种类型的实例......如果是这样，那么由于 DataRow 具有引用 DataTable 的属性，只需将您的 IFoo 变量转换为 DataRow ,

FooRow 内部

```
 public partial class FooRow
  {    
       private void myColumnChanging Handler(object sender, EventArgs e)
       {
            // Implementation
       }
       private void myColumnChanged Handler(object sender, EventArgs e)
       {
            // Implementation
       }
       public void RegisterEvents()
       {
          ((DataRow)this).Table.ColumnChanging += myColumnChanging; 
          ((DataRow)this).Table.ColumnChanged += myColumnChanged; 
       }
   } 
```

然后，在 FooDataTable 类中，添加一个新的工厂方法 MyNewFooRow()

```
public class FooDataTable 
{
    //  -- Other implementation
    public FooRow MyNewFooRow()
    {
        FooRow fr = this.NewFooRow(); // call the original factory
        fr.RegisterEvents();
        return fr;
    }
 } 
```

并在您使用旧工厂的任何地方使用这个新工厂...

# asp.net-mvc - 在 HtmlHelper 扩展方法期间正在执行哪个操作

> ID：331972
> 
> 赞同：4
> 
> 时间：2008-12-01T19:48:04.600
> 
> 标签：asp.net-mvc

我正在研究生成菜单的 HtmlHelper 扩展方法。此方法需要知道正在执行的操作。因此，如果 Home/Index 正在执行，则扩展方法将显示指向“已协调”的其他操作的所有链接。从某种意义上说，在 Home 控制器的 Index 动作执行过程中，我只需要知道 Controller 的名称和正在执行的 Action 的名称，以便执行其他逻辑。这可能吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-01T19:56:01.357

试试这个

```
var action = HtmlHelper.ViewContext.RouteData.Values["action"];
var controller = HtmlHelper.ViewContext.RouteData.Values["controller"]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-01T20:24:11.423

我对过滤器属性做了类似的事情。您可以像这样获取操作名称：

```
filterContext.RouteData.Values["action"].ToString(); 
```

我用它来禁用代表当前上下文的菜单项。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-19T13:05:07.553

我需要这样的东西，但不完全是。我希望能够获得一些强类型的方式来了解正在执行的操作。

因此，在执行 AOP 时澄清，如果用户有权执行该操作，我只允许访问给定的操作。

使用字符串来确定要检查的规则的问题在于，如果某些开发人员重命名操作，我不会收到一个编译错误，告诉我我的规则已损坏。

# c# - 如何将 C# 匿名类型序列化为 JSON 字符串？

> ID：331976
> 
> 赞同：172
> 
> 时间：2008-12-01T19:48:33.447
> 
> 标签：c#, json, anonymous-types, datacontractjsonserializer, json-serialization

我正在尝试使用以下代码将匿名类型序列化为 JSON：

```
var serializer = new DataContractJsonSerializer(thing.GetType());
var ms = new MemoryStream();
serializer.WriteObject(ms, thing);
var json = Encoding.Default.GetString(ms.ToArray()); 
```

但是，执行此操作时出现以下异常：

> 类型 '<>f__AnonymousType1`3[System.Int32,System.Int32,System.Object[]]' 无法序列化。考虑使用 DataContractAttribute 属性对其进行标记，并使用 DataMemberAttribute 属性标记您想要序列化的所有成员。有关其他支持的类型，请参阅 Microsoft .NET Framework 文档。

我不能将属性应用于匿名类型（据我所知）。还有其他方法可以进行此序列化还是我遗漏了什么？

* * *

## 回答 #1

> 赞同：161
> 
> 时间：2008-12-01T19:52:06.760

尝试 JavaScriptSerializer 而不是 DataContractJsonSerializer

```
JavaScriptSerializer serializer = new JavaScriptSerializer();
var output = serializer.Serialize(your_anon_object); 
```

* * *

## 回答 #2

> 赞同：85
> 
> 时间：2012-05-09T21:56:26.510

正如其他人所提到的，[Newtonsoft JSON.NET](http://james.newtonking.com/projects/json-net.aspx)是一个不错的选择。以下是简单 JSON 序列化的具体示例：

```
return JsonConvert.SerializeObject(
    new
    {
       DataElement1,
       SomethingElse
    }); 
```

我发现它是一个非常灵活、多功能的库。

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2010-08-18T02:20:18.330

你可以试试我的 ServiceStack [JsonSerializer](http://www.servicestack.net/mythz_blog/?p=344)，它是目前[最快的 .NET JSON 序列化](http://www.servicestack.net/benchmarks/NorthwindDatabaseRowsSerialization.100000-times.2010-08-17.html)器。它支持序列化 DataContract、任何 POCO 类型、接口、包括匿名类型在内的后期绑定对象等。

基本示例

```
var customer = new Customer { Name="Joe Bloggs", Age=31 };
var json = customer.ToJson();
var fromJson = json.FromJson<Customer>(); 
```

注意：仅当性能对您不重要时才使用 Microsoft 的 JavaScriptSerializer，因为我不得不将它排除在我的基准测试之外，因为它比其他 JSON 序列化程序慢**40 到 100 倍。**

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2008-12-01T19:53:57.007

*请注意这是从 2008 年开始的。今天我认为应该内置序列化程序，并且您可能可以使用 swagger + 属性来告知消费者您的端点并返回数据。*

* * *

我会争辩说你**不应该序列化匿名类型**。我知道这里的诱惑；您想快速生成一些一次性类型，这些类型将在浏览器中的松散类型环境（即 Javascript）中使用。尽管如此，我还是会创建一个实际类型并将其装饰为可序列化的。然后，您可以强烈键入您的网络方法。虽然这对 Javascript 来说并不重要，但它确实为该方法添加了一些自文档。任何经验丰富的程序员都能够查看函数签名并说：“哦，这是 Foo 类型！我知道它在 JSON 中应该是什么样子。”

话虽如此，您可以尝试**[JSON.Net](http://james.newtonking.com/pages/json-net.aspx)**进行序列化。我不知道它是否会起作用

* * *

## 回答 #5

> 赞同：11
> 
> 时间：2014-05-23T10:12:49.383

我发现最快的方法是：

```
var obj = new {Id = thing.Id, Name = thing.Name, Age = 30};
JavaScriptSerializer serializer = new JavaScriptSerializer();
string json = serializer.Serialize(obj); 
```

命名空间：System.Web.Script.Serialization.JavaScriptSerializer

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2020-11-09T21:22:55.153

对于那些在 2020 年左右检查的人：

Microsoft 的 System.Text.Json 命名空间是镇上的新王。在性能方面，据我所知，它是最好的：

```
var model = new Model
{
    Name = "Test Name",
    Age = 5
};

string json = JsonSerializer.Serialize(model); 
```

正如其他人所提到的，NewtonSoft.Json 也是一个非常好的库。

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2019-09-04T11:51:19.730

您可以使用 Newtonsoft.Json。

```
var warningJSON = JsonConvert.SerializeObject(new {
               warningMessage = "You have been warned..."
            }); 
```

微软在 System.Text.Json 上的新库的更快替代方案

```
var warningJSON = JsonSerializer.Serialize(new {
               warningMessage = "You have been warned..."
            }); 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-12-01T21:33:42.797

假设您将其用于 Web 服务，您只需将以下属性应用于该类：

```
[System.Web.Script.Services.ScriptService] 
```

然后为每个应该返回 Json 的方法添加以下属性：

```
[ScriptMethod(ResponseFormat = ResponseFormat.Json)] 
```

并将方法的返回类型设置为“对象”

* * *

## 回答 #9

> 赞同：-2
> 
> 时间：2011-03-28T15:20:56.170

```
public static class JsonSerializer
{
    public static string Serialize<T>(this T data)
    {
        try
        {
            DataContractJsonSerializer serializer = new DataContractJsonSerializer(typeof(T));
            var stream = new MemoryStream();
            serializer.WriteObject(stream, data);
            string jsonData = Encoding.UTF8.GetString(stream.ToArray(), 0, (int)stream.Length);
            stream.Close();
            return jsonData;
        }
        catch
        {
            return "";
        }
    }
    public static T Deserialize<T>(this string jsonData)
    {
        try
        {
            DataContractJsonSerializer slzr = new DataContractJsonSerializer(typeof(T));
            var stream = new MemoryStream(Encoding.UTF8.GetBytes(jsonData));
            T data = (T)slzr.ReadObject(stream);
            stream.Close();
            return data;
        }
        catch
        {
            return default(T);
        }
    }
} 
```

# perl - 如何用“OTHER”替换数组中的空元素？

> ID：331992
> 
> 赞同：1
> 
> 时间：2008-12-01T19:54:25.010
> 
> 标签：perl, arrays, list

我的列表 (@degree) 是根据 SQL 命令构建的。SQL 中的 NVL 命令不起作用，测试也不起作用，例如：

```
if (@degree[$i] == "")
if (@degree[$i] == " ")
if (@degree[$i] == '')
if (@degree[$i] == -1)
if (@degree[$i] == 0)
if (@degree[$i] == ())
if (@degree[$i] == undef) 
```

$i 是 for 循环中的计数器变量。基本上，它会通过并从表中获取独特的度数并最终创建`("AFA", "AS", "AAS", "", "BS")`. 列表并不总是这么长，空元素并不总是在那个位置 3。

任何人都可以帮忙吗？

我想在 for 循环期间进行测试，或者在循环完成后测试这个空元素的位置，然后用单词“OTHER”替换它。

谢谢你 - 肯

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-12-01T20:01:39.393

首先，数组中的第 i 个元素是 $degree[$i]，而不是 @degree[$i]。其次，“==”用于数值比较——使用“eq”进行词法比较。第三，试试`if (defined($degree[$i]))`

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-12-02T16:59:49.760

保罗所说的一切。而且，如果你需要一个例子：

```
my @degree = ('AFA', 'AS', 'AAS', '', 'BS');

$_ ||= 'OTHER' for @degree;

print join ' ' => @degree;  # prints 'AFA AS AAS OTHER BS' 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-02T16:52:27.950

如果它实际上在数据库中为空，请尝试`COALESCE`

```
SELECT COALESCE(column, 'no value') AS column FROM whatever ... 
```

这是执行此操作的 SQL 标准方法。

# iphone - 同时插入和删除 UITableViewCell 不起作用

> ID：331996
> 
> 赞同：7
> 
> 时间：2008-12-01T19:55:06.273
> 
> 标签：iphone, cocoa-touch, insert

从同一个 UITableView 插入和删除 UITableViewCells 时，我感到非常痛苦！

我通常不发布代码，但我认为这是显示问题所在的最佳方式：

* * *

```
- (NSInteger)numberOfSectionsInTableView:(UITableView *)tableView {
    return 5;
}

- (NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section {

    if (iSelectedSection == section) return 5;
    return 1;
}

- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath {

    //NSLog(@"drawing row:%d section:%d", [indexPath row], [indexPath section]);

    static NSString *CellIdentifier = @"Cell";

    UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier];
    if (cell == nil) {
        cell = [[[UITableViewCell alloc] initWithFrame:CGRectZero reuseIdentifier:CellIdentifier] autorelease];
    }

    if (iSelectedSection == [indexPath section]) {
        cell.textColor = [UIColor redColor];
    } else {
        cell.textColor = [UIColor blackColor];
    }   

    cell.text = [NSString stringWithFormat:@"Section: %d Row: %d", [indexPath section], [indexPath row]];

    // Set up the cell
    return cell;
}

- (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath {
    // Navigation logic -- create and push a new view controller

    if ([indexPath row] == 0) {

        NSMutableArray *rowsToRemove = [NSMutableArray array];
        NSMutableArray *rowsToAdd = [NSMutableArray array];

        for(int i=0; i<5; i++) {

            //NSLog(@"Adding row:%d section:%d ", i, [indexPath section]);
            //NSLog(@"Removing row:%d section:%d ", i, iSelectedSection);

            [rowsToAdd addObject:[NSIndexPath indexPathForRow:i inSection:[indexPath section]]];
            [rowsToRemove addObject:[NSIndexPath indexPathForRow:i inSection:iSelectedSection]];

        }

        iSelectedSection = [indexPath section];

        [tableView beginUpdates];
        [tableView deleteRowsAtIndexPaths:rowsToRemove withRowAnimation:YES];
        [tableView insertRowsAtIndexPaths:rowsToAdd withRowAnimation:YES];
        [tableView endUpdates];

    }
} 
```

* * *

此代码创建 5 个部分，第一个（从 0 开始索引）有 5 行。当您选择一个部分时 - 它会从您之前选择的部分中删除行，并将行添加到您刚刚选择的部分。

如图所示，当我加载应用程序时，我有这样的东西：

[http://www.freeimagehosting.net/uploads/1b9f2d57e7.png http://www.freeimagehosting.net/uploads/1b9f2d57e7.png](http://www.freeimagehosting.net/uploads/1b9f2d57e7.png)

图片在这里：[http ://www.freeimagehosting.net/uploads/1b9f2d57e7.png](http://www.freeimagehosting.net/uploads/1b9f2d57e7.png)

选择第 2 节的表第 0 行后，我删除第 1 节的行（默认选中）并添加第 2 节的行。但我得到了：

[http://www.freeimagehosting.net/uploads/6d5d904e84.png http://www.freeimagehosting.net/uploads/6d5d904e84.png](http://www.freeimagehosting.net/uploads/6d5d904e84.png)

图片在这里：[http ://www.freeimagehosting.net/uploads/6d5d904e84.png](http://www.freeimagehosting.net/uploads/6d5d904e84.png)

...这不是我期望发生的！似乎第 2 节的第一行以某种方式保留了 - 即使它肯定被删除了。

如果我只是做一个 [tableView reloadData]，一切都会正常显示......但我显然会放弃漂亮的动画。

如果有人可以在这里发光，我将非常感激！这让我有点发疯！

再次感谢尼克。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-27T02:14:48.140

努力让这个工作。这是我在 tableView 中添加一行的代码：

```
NSIndexPath *indexPath = [NSIndexPath indexPathForRow:0 inSection:0];
[tableView beginUpdates];
[dataSource insertObject:[artistField text] atIndex:0];
[tableView insertRowsAtIndexPaths:[NSArray arrayWithObject:indexPath] withRowAnimation:UITableViewRowAnimationTop];
[tableView endUpdates]; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-02T04:25:00.737

我似乎记得 numberOfRowsInSection: 会在您调用 deleteRows 或 insertRow 时被调用，您需要非常小心实际的 numberOfRowsInSection cliams 是否与您的更改相匹配。在这种情况下，您可能想尝试移动 iSelectedSection = [indexPath section]; 行到 endUpdates 之后。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-08T22:18:15.400

我不记得我在哪里读到的，但我相信您不应该从表视图委托函数之一执行表行更新（插入和删除）。我认为更好的选择是执行 performSelectorOnMainThread 传递作为对象执行更新所需的必要信息。就像是：

```
- (void)tableView:(UITableView *)tableView 
  didSelectRowAtIndexPath:(NSIndexPath *)indexPath {
    // ....
    [self performSelectorOnMainThread: @selector(insertRows:)
                           withObject: someObjectOrNil]; // double check args
}

- (void) insertRows: (NSObject*)someObjectOrNil {
    [tableView beginUpdates];
    // update logic
    [tableView endUpdates];

    // don't call reloadData here, but ensure that data returned from the 
    // table view delegate functions are in sync
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-01T20:31:27.977

在您发布的代码中，您的循环索引从 0 运行到 4，这表明它将删除第 1 节中的*所有*行，然后向第 2 节添加五个新行。由于每个节已经有第 0 行，这将将第 2 节第 0 行的*第二个*实例添加到表中。

我建议让你的循环从 1 运行到 4：

```
for (int i=1; i<5; i++)
{
    // ...
}
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-30T10:42:45.103

仅供参考：此错误似乎已在 2.2 iPhone 更新中完全修复。感谢苹果！缺口。****`*****