# StackOverflow 问答 000437000-000437999

# javascript - 使用 JQuery Ajax 和 ASP.Net Mvc 的正确模式是什么？

> ID：437002
> 
> 赞同：36
> 
> 时间：2009-01-12T21:04:55.587
> 
> 标签：javascript, jquery, asp.net-mvc, ajax, design-patterns

我对 Mvc 框架以及 JavaScript 和 JQuery 都很陌生。我试图了解构建 Ajax 调用的正确方法。

假设我有一个`Vote Up`类似于您在 StackOverflow 上看到的按钮。当用户单击它时，我需要更新数据库中的投票计数并将新值返回给 UI。目前，我通过调用一个以 a 作为参数的操作`VoteUp`来实现这一点。`PostsController``int postID`

```
public PostsController : Controller
{
    public ActionResult VoteUp(int postId)
    {
        //Increment Post Vote Count
        return Json(voteCount); //Return just the new vote count as a JSon result.
    }
} 
```

然后我通过 ajax 调用 URL“ [http://example.com/posts/voteUp?postId=5](http://example.com/posts/voteUp?postId=5) ”来调用这个方法。然后我返回一个带有新值的 JSon ActionResult 来更新 UI。

这是实现这一点的正确方法吗？同样，我对 javascript 和 jquery 都是全新的。我习惯于在 asp.net webforms 中作为单击事件处理程序来执行所有操作。任何指导将不胜感激。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-01-12T21:36:56.613

是的，听起来你说得对。

但是请注意，如果您将 postId 更改为 Id，那么您可以使用如下 URL 调用：

[http://example.com/posts/voteUp/5](http://example.com/posts/voteUp/5)

（使用默认路由。）这是个人喜好的问题。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-12T21:38:50.167

我会使用 jQuery 和 JsonResult Controller 来解决这个问题。您的 jQuery 代码将调用 JsonResult，它将相关信息传递给模型代码以处理添加新投票。我写了一个关于类似概念的简短教程，可在[http://www.dev102.com/2008/08/19/jquery-and-the-aspnet-mvc-framework/](http://www.dev102.com/2008/08/19/jquery-and-the-aspnet-mvc-framework/)

# c# - 可以在 AssemblyCleanup 方法中访问 TestContext 吗？

> ID：437010
> 
> 赞同：6
> 
> 时间：2009-01-12T21:07:37.953
> 
> 标签：c#, visual-studio, unit-testing, microsoft-test-manager

在 Microsoft 的 UnitTesting 命名空间 ( `Microsoft.VisualStudio.TestTools.UnitTesting`) 中`AssemblyInitialize`，`AssemblyCleanup`您可以将属性应用于静态方法，它们将分别在所有测试之前和之后调用。

```
[AssemblyInitialize]
static public void AssemblyInitialize(TestContext testCtx)
{
    // allocate resources
}

[AssemblyCleanup]
static public void AssemblyCleanup()
{
    // free resources
} 
```

我的问题：访问inside是否可能且*安全*？如果不是，将资源引用存储为静态成员是一种合理的选择，还是会导致问题？`TestContext``AssemblyCleanup()`

另外/可选：*不*传递`TestContext`对清理方法的引用的原因是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-12T22:40:47.920

我正在访问同一个类的静态属性，它似乎工作正常。如果我遇到任何问题，我会更新这个答案。但是，我*没有*访问，`TestContext`所以我很好奇这是否也可以。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-05-25T12:30:52.863

您不能将任何参数传递给 AssemblyCleanup 方法。如果您尝试这样做，则会出现以下错误：

> 结果消息：方法 SomeNamespace.TestDatabaseInitializer.AssemblyCleanup 的签名错误。该方法必须是静态的、公共的、不返回值且不应带任何参数。

# asp.net-mvc - 您如何处理 ASP.NET MVC 中的报告过滤器？

> ID：437011
> 
> 赞同：1
> 
> 时间：2009-01-12T21:07:45.737
> 
> 标签：asp.net-mvc, reporting

对于给定的报告，用户将希望有多个过滤选项。This isn't bad when the options are enumerations, and other 'static' data types, however things can get silly fast when you need a select list that is populated by fields stored in a table in the backend.

您如何处理这种情况？我发现自己不断地重塑视图数据以适应额外的过滤器字段，但它确实开始有点跟踪不仅选择的选项，而且还有选项本身......

没有更好的方法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-05T06:06:58.327

I’m currently building out a new reporting section for one of our products at work and am dealing with this same issue. The solution I’ve come up with so far, though it hasn’t been implemented yet so this is still a work in progress, is along the lines of this.

There will be a class that will represent a report filter which will contain some basic info such as the label text and a list of option values.

```
public enum DisplayStyle
{
    DropDown,
    ListBox,
    RadioList,
    CheckList,
    TextBox
}

public class FilterOption
{
    public string Name { get; set; }
    public string Value { get; set; }
    public bool Selected { get; set; }
}

public class ReportFilter
{
    public string Title { get; set; }
    public DisplayStyle Style { get; set; }
    public List<FilterOption> Options { get; set; }
} 
```

And then my model will contain a list of these option classes that will be generated based on each report’s needs. I also have a base report class that each report will inherit from so that way I can handle building out the option lists on a per report basis and use one view to handle them all.

```
public class ReportModel
{
    public string Name { get; set; }
    public List<ReportFilter> Filters { get; set; }
    public DateTime StartDate { get; set; }
    public DateTime EndDate { get; set; }
} 
```

Then inside my view(s) I’ll have some helper methods that will take in those option classes and build out the actual controls for me.

```
public static string ReportFilter(this HtmlHelper htmlHelper, DisplayStyle displayStyle, FilterOption filterOption)
{
    switch (displayStyle)
    {
        case DisplayStyle.TextBox:
            return string.Format("<input type=\"text\"{0}>", filterOption.Selected ? (" value=\"" + filterOption.Value + "\"") : string.Empty);
            break;
        ...
    }
} 
```

My route would look like this

```
Reports/{reportID}/start/{startDate}/end/{endDate}/{*pathInfo} 
```

All reports have a start and end date and then optional filters. The catchall parameter will have lists of filter values in the form of “Customer/1,4,7/Program/45,783”. So it’ll be like a key/value pair in list form. Then when the controller loads it’ll parse out those values into something more meaningful.

```
public static Dictionary<string, string> RouteParams(string pathInfo)
{
    if (string.IsNullOrEmpty(pathInfo))
    {
        return new Dictionary<string, string>();
    }

    var values = new Dictionary<string, string>();

    // split out params and add to the dictionary object

    return values;
} 
```

Then it will pass them off to the report class and validate them to make sure they’re correct for that report. Then when the options are loaded for that report anything that’s been set in the URL will be set to Selected in the ReportOption class so their state can be maintained. Then the filter list and other report data will be added to the model.

For my setup some filters will change when another filters selection changes so there will be some AJAX in here to post the data and get the updated filter options. The drilldown will work sort of like the search options at amazon or newegg when you narrow your search criteria.

I hope that all makes sense to someone beside me. And if anyone has some input on improving it I’d be happy to hear it.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-12T22:46:06.553

您可以使用 MVC 应用程序中的 jQuery 和 JsonResults 在屏幕上异步检索数据，这就是我们在应用程序中填充所有列表和搜索的方式。 [我有一个如何在这里完成的例子。](http://oddiandeveloper.blogspot.com/2008/11/asynchronous-data-loading-in-aspnet-mvc.html)

这样视图数据是按需加载的，如果他们不使用额外的过滤器，那么他们就不必获取视图数据，如果一个选择与另一个相关，那么很清楚您需要检索哪组数据。

另一种选择，虽然我不太喜欢这个，但 jQuery 解决方案可能不适合你，是让你的视图模型对象包含所有视图数据，这样你需要做的就是设置单个模型对象和所有列表是直接加载的并且是强类型的。这将简化视图和后端代码，因为更清楚的是，对于此视图，您唯一需要的是此模型对象的完整版本。

例如，如果您有两个组合框列表，那么您的模型可能如下所示：

```
public class MyViewMode
{
    public int MyProperty { get; set; }
    public string SomeString { get; set; }
    List<string> ComboListA { get; set; }
    List<string> ComboListB { get; set; }
} 
```

希望这是有道理的，如果没有，请发表评论，我将对此进行扩展。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-16T20:01:09.627

Ad-hoc filtering on reports is indeed a tricky issue especially when you want to show a custom user interface control based on the data type, do validation, make some filters to be dependent on one another and others not, etc.

One thing I think that is worth considering is the old "build vs buy" issue here. There are specialized tools out there for ad-hoc reporting that do provide a UI for ad-hoc filters help with this such as the usual suspects [Crystal Reports](http://www.crystalreports.com/), [Microsoft's Reporting Services](https://www.microsoft.com/sqlserver/en/us/solutions-technologies/business-intelligence/SQL-Server-2012-reporting-services.aspx), or our product [ActiveReports Server](http://www.activereportsserver.com). In ActiveReports Server we support cascading prompts (where available values in prompts depend on one another) and make it easy for anyone, even non-technical business users to modify the prompts (assuming they have permissions obviously). More information about [using prompts in ActiveReports Server is here](http://www.activereportsserver.com/docs/UserGuide/index.html?areParametersforReport.html). ActiveReports Server 也是所有托管的 .NET 代码，并提供 ASP.NET 控件和 Web 服务，允许您将其集成到您的 Web 应用程序中。

```
Scott Willeke
Product Manager - ActiveReports Server
GrapeCity inc. 
```

# asp.net-mvc - MVC DataContext 是否可以共享一个连接

> ID：437022
> 
> 赞同：0
> 
> 时间：2009-01-12T21:11:20.580
> 
> 标签：asp.net-mvc, linq, datacontext

“工作单位”何时不再是“单位”？哪个场景在资源上更好？第一个创建一个连接，而第二个创建 4 个。

```
using (DataContext dc=new DataContext) 
{
  var orders= from o in dc.orders 
              select ( new Product {  property a= from a in ..join... select x, 
                                      property b= from b in ..join... select y,
                                      property c= from c in ..join... select z.}
                      )
} 
```

或者

```
using (DataContext dc=new DataContext) 
{
  var orders= from o in dc.orders 
              select ( new Product {  property a = GetPropertyA(), 
                                      property b = GetPropertyB(),
                                      property c = GetPropertyC()}
                      )
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-12T22:36:29.177

使用 LINQ 时，如果您将一个实体添加到另一个实体并且它们使用不同的数据上下文，您将收到错误。我建议为您使用的每个工作单元保留相同的数据上下文。通过使用存储库模式编写数据访问类，您可以轻松识别正在处理的工作单元。如果您不清楚存储库模式，[请查看此条目](http://www.asp.net/learn/mvc/tutorial-10-vb.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-12T22:20:40.067

一般来说，数据库的往返次数越少越好。然而，在大规模应用程序中，我们经常使我们的数据库变得越来越“笨拙”，因此我们最终没有进行任何连接，因此我们不会占用 SQL 数据库服务器上的 CPU 和内存。这实际上取决于您发现哪些资源更稀缺。如果您的 SQL 服务器有大量资源，请在那里进行联接，否则单独将其拉回会更好。您是否在 SQL 分析器中查看过此结果？您确定是 4 个连接，还是只是 4 个单独的呼叫？

# python - 如何实现一个很好地处理异步输出的python REPL？

> ID：437025
> 
> 赞同：13
> 
> 时间：2009-01-12T21:11:44.310
> 
> 标签：python, readline, read-eval-print-loop

我有一个基于 Python 的应用程序，它可以在一个简单的 read-eval-print-loop 中接受一些命令。我`raw_input('> ')`用来获取输入。在基于 Unix 的系统上，我也`import readline`让事情表现得更好一点。所有这一切都很好。

问题是有异步事件进来，我想在它们发生时立即打印输出。不幸的是，这让事情看起来很难看。"> " 字符串在输出后不会再次出现，如果用户正在输入一半内容，它会将文本切成两半。它可能应该在打印某些内容后重绘用户正在处理的文本。

这似乎必须是一个已解决的问题。这样做的正确方法是什么？

另请注意，我的一些用户是基于 Windows 的。

TIA

编辑：接受的答案在 Unixy 平台下工作（当 readline 模块可用时），但如果有人知道如何在 Windows 下工作，将不胜感激！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-12T21:33:20.210

也许这样的事情可以解决问题：

```
#!/usr/bin/env python2.6

from __future__ import print_function

import readline
import threading

PROMPT = '> '

def interrupt():
    print() # Don't want to end up on the same line the user is typing on.
    print('Interrupting cow -- moo!')
    print(PROMPT, readline.get_line_buffer(), sep='', end='')

def cli():
    while True:
        cli = str(raw_input(PROMPT))

if __name__ == '__main__':
    threading.Thread(target=cli).start()
    threading.Timer(2, interrupt).start() 
```

我不认为 stdin 是线程安全的，因此您最终可能会将字符丢失到中断线程（用户将不得不在结尾重新键入`interrupt`）。我夸大了通话`interrupt`时间。调用不会显示丢失的字符，所以一切正常`time.sleep`。`readline.get_line_buffer`

请注意，stdout 本身不是线程安全的，因此如果您有多个中断的执行线程，这仍然会看起来很糟糕。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-13T21:44:41.030

为什么要使用 编写自己的 REPL `raw_input()`？你看过`cmd.Cmd`课吗？ **编辑：**我刚刚找到了[sclapp](http://www.alittletooquiet.net/software/sclapp/)库，它也可能有用。

注意：`cmd.Cmd`类（和 sclapp）可能会也可能不会直接支持您的原始目标；您可能必须对其进行子类化并根据需要对其进行修改以提供该功能。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2010-12-22T10:57:43.050

运行这个：

```
python -m twisted.conch.stdio 
```

您将获得一个漂亮的、彩色的、异步的 REPL，**而无需使用线程**。当您输入提示时，事件循环正在运行。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-12-09T02:15:57.767

查看代码模块，它还允许您创建用于解释 python 代码的对象（无耻插件）[https://github.com/iridium172/PyTerm](https://github.com/iridium172/PyTerm)允许您创建处理原始键盘输入的交互式命令行程序（如 ^C 将引发键盘中断）。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2009-01-12T23:04:43.893

这是一个无法回答的问题，但我会查看[IPython](http://ipython.scipy.org/moin/)的代码，看看他们是如何做到的。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2009-01-13T15:36:14.830

我认为您有两个基本选择：

1.  同步你的输出（即阻塞直到它回来）
2.  将您的输入和您的（异步）输出分开，可能在两个单独的列中。

# c# - 在 C# 中，myInt++ 和 ++myInt 有什么区别？

> ID：437026
> 
> 赞同：7
> 
> 时间：2009-01-12T21:11:55.540
> 
> 标签：c#, syntax

我很难理解以这种方式在 C# 中递增变量之间的区别是什么：

```
myInt++; 
```

和

```
++myInt; 
```

什么时候会在乎你使用哪一个？

我会给 voteCount++ 以获得最佳答案。或者我应该给它 ++voteCount ...

* * *

## 回答 #1

> 赞同：53
> 
> 时间：2009-01-12T21:14:39.700

单独编写时没有区别（如图所示） - 在这两种情况下 myInt 都将递增 1。

但是在表达式中使用它时会有所不同，例如：

```
MyFunction(++myInt);
MyFunction(myInt++); 
```

在第一种情况下，myInt 递增，新的/递增的值被传递给 MyFunction()。在第二种情况下，myInt 的旧值被传递给 MyFunction()（但 myInt 在调用函数之前仍会递增）。

另一个例子是这样的：

```
int myInt = 1;
int a = ++myInt;
// myInt is incremented by one and then assigned to a.
// Both myInt and a are now 2.
int b = myInt++;
// myInt is assigned to b and then incremented by one.
// b is now 2, myInt is now 3 
```

顺便说一句：正如[Don](https://stackoverflow.com/users/52682/don-music)在评论中指出的那样，相同的规则也适用于减量操作，这些操作的正确术语是：

```
++i; // pre-increment
i++; // post-increment
--i; // pre-decrement
i--; // post-decrement 
```

正如[Jon Skeet](https://stackoverflow.com/users/22656/jon-skeet)指出的那样：

> 其他人已经表明它在哪里有所作为，并评论说作为一个单一的陈述它没有任何区别。
> 
> 我想补充一点，在有影响的地方使用它几乎总是一个坏主意。我怀疑在某些时候可能会有以下代码更具可读性：
> 
> ```
> Console.WriteLine("Foo: {0}", foo++); 
> ```
> 
> 比：
> 
> ```
> Console.WriteLine("Foo: {0}", foo);
> foo++; 
> ```
> 
> ...但它们非常罕见！这两个样本中的后者立即使订购变得一清二楚——前者需要一些思考（无论如何，对我可怜的大脑而言）。首先考虑可读性。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-01-12T21:18:44.013

其他人已经表明它在哪里有所作为，并评论说作为一个单一的陈述它没有任何区别。

我想补充一点，在有影响的地方使用它几乎总是一个坏主意。我怀疑在某些时候*可能*会有以下代码更具可读性：

```
Console.WriteLine("Foo: {0}", foo++); 
```

比：

```
Console.WriteLine("Foo: {0}", foo);
foo++; 
```

...但它们非常罕见！这两个样本中的后者立即使订购变得一清二楚——前者需要一些思考（无论如何，对我可怜的大脑而言）。首先考虑可读性。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-01-12T21:16:08.420

除非它在表达式中，否则它不会，即

```
myInt=1;
x=myInt++; 
```

不同于：

```
myInt=1;
x=++myInt; 
```

第一个将 1 分配给 x，因为分配发生在增量之前。

第二个将 2 分配给 x，因为分配发生在增量之后。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-01-12T21:14:27.267

例如，在赋值或表达式中

```
x = ++myInt; // x = myInt + 1
x = myInt++; // x = myInt 
```

这也可以用在 for 循环或 if 语句等表达式中。例如，在 seek 为 0 且 count 为 3 的情况下执行以下操作。

```
while(seek++ < count) {
   Console.WriteLine(seek);
} 
```

结果为 1、2 和 3 的输出，用于搜索，以及以下

```
while(++seek < count) {
   Console.WriteLine(seek);
} 
```

搜索结果为 1 和 2。所以 ++myInt 在计算其值之前递增 myInt，而 myInt++ 在计算后递增。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-01-12T21:43:09.300

myInt++（4 个 CPU 指令）

```
LOAD AX, #myInt // From myInt memory to a CPU register
COPY AX, BX
INCREMENT BX
STORE BX, #myInt
// Use AX register for the value 
```

++myInt（3 个 CPU 指令）

```
LOAD AX, #myInt // From myInt memory to a CPU register
INCREMENT AX
STORE AX, #myInt
// Use AX register for the value 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-01-12T21:15:07.813

如果你正在做，那就不同了

```
int x = 7;
int x2 = x++;

=> x2 is 7 and x is 8 
```

但是做的时候

```
int x = 7;
int x2 = ++x;

=> x2 is 8 and x is 8 
```

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-01-12T21:16:08.217

它确定何时返回该操作的结果。

[这是MSDN 网站](http://msdn.microsoft.com/en-us/library/36x43w8w(VS.80).aspx)上的一个示例：

```
static void Main() 
{
    double x;
    x = 1.5;
    Console.WriteLine(++x);
    x = 1.5;
    Console.WriteLine(x++);
    Console.WriteLine(x);
} 
```

和输出：

```
2.5
1.5
2.5 
```

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2009-01-12T21:17:22.567

前缀运算符 ++myInt 是一种减少行数的方法：在将变量传递到其他地方之前递增变量。这也是降低可读性的好方法，因为它不常见。

```
MyMethod(++myInt); 
```

对比

```
myInt++; 
MyMethod(myInt); 
```

对我来说，第二个更容易阅读。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2009-01-12T21:46:14.660

**我认为按照评估**和**修改**的顺序来理解是最简单的。

*   后缀运算符 (x++) 首先*计算*并最后*修改*。
*   前缀运算符 (++x)首先*修改* 并最后*评估*。

（操作顺序在运算符和变量的键入顺序中很明显）

I.e. when used in an expression, the postfix operator evaluates and uses the variable's current value in the expression (a return statement or method call) before applying the operator. With the prefix operator it is the other way around.

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2009-01-12T21:21:52.603

++myInt 将在执行相关行之前向 myInt 添加一个，myInt++ 将在之后执行此操作。

例子：

```
int myInt;

myInt = 1;
someFunction(++myInt); // Sends 2 as the parameter

myInt = 1;
someFunction(myInt++); // Sends 1 as the parameter 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-01-12T21:15:55.097

例如，如果您执行以下操作：

```
int myInt = 5;

Foo(++myInt);

void Foo(int x)
{
   Console.WriteLine(x);
} 
```

这将打印出 6。

```
Foo(myInt++); 
```

将打印出 5；

基本上，++myInt 递增 FIRST 使用变量 SECOND。myInt++ 正好相反。

# php - open_basedir 和 move_uploaded_file 的文件上传问题

> ID：437033
> 
> 赞同：0
> 
> 时间：2009-01-12T21:13:48.860
> 
> 标签：php, configuration, file

我正在使用旧的 php 脚本。其中已经有一个文件上传表单，但我已经为同一个脚本中的不同部分添加了另一个表单。

$_file['file'] 在那里。但是我不断收到 open_basedir 限制错误，如果不是这样，我会收到权限错误。

我不介意解决这些问题，但问题是，另一种形式可以正常工作。脚本的位置没有差异（相同的目录），文件的去向也没有任何问题（我尝试了不同的目录和相同的目录）。

我要疯狂地试图弄清楚这一点。为什么我的文件表格不起作用？为什么它适用于其他代码？到底是怎么回事？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-12T21:18:33.033

我遇到过类似的问题，这与托管服务提供商对 /tmp 目录的错误设置有关（即 PHP 存储临时上传文件的位置）。可能值得致电技术支持。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-12T21:21:25.850

不是必须`$_FILE['file']`代替`$_file['file']`吗？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-12T21:24:52.800

[安全模式](http://php.net/manual/en/features.safe-mode.functions.php)强制 move_uploaded_file() 检查正在操作的文件或目录是否与正在执行的脚本具有相同的 UID（所有者）。

我还建议在工作代码中查找 ini_set() 语句。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-12T21:22:05.803

我不知道你是否遇到同样的问题，但前段时间我们遇到了 open_basedir 和 smarty 的问题。我们从 smarty 代码收到问题，但问题是 include_path 错误（我们通过 ini_set 设置它，但没有将它与旧的 include_path 连接）。结果 smarty 试图检查目录是否可读，从根目录 / 创建可能的路径违反了 open_basedir。总结一下，检查你在哪里得到 open_basedir 错误，导致问题的路径是什么。

# c# - 处理大型下载网站的最佳方式？

> ID：437043
> 
> 赞同：2
> 
> 时间：2009-01-12T21:15:47.203
> 
> 标签：c#, filestream

我目前有一个基于 .net 的学校下载站点。我们提供防病毒、autocad、spss、office 和大量大型应用程序供学生下载。当前设置为以 2 种方式中的 1 种方式处理它们；任何超过 800 megs 的内容都可以通过单独的网站直接访问，而低于 800 megs 的内容则通过使用文件流以 10,000 字节块的形式提供给用户的 .net 代码进行保护。我在以这种方式提供下载时遇到各种问题......我希望能够保护大型下载，但是 .net 站点无法处理它，并且较小的文件经常会失败。有更好的方法吗？

编辑 - 我只是想更新我最终如何解决这个问题：我最终将我的下载目录添加为 iis 中的虚拟目录并指定了自定义 http 处理程序。处理程序从请求中获取文件名并基于此检查权限，然后将用户重定向到错误/登录页面，或者让下载继续。我对这个解决方案没有任何问题，而且我已经使用它大概 7 个月了，提供了几个演出大小的文件。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-12T21:35:13.263

如果您遇到性能问题并且您正在交付文件系统上存在的文件（相对于 DB），请使用[HttpResponse.TransmitFile](http://msdn.microsoft.com/en-us/library/12s31dhy(VS.80).aspx)函数。

至于失败，你可能有一个错误。如果您发布代码，您可能会得到更好的响应。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-12T21:17:36.590

查看比特洪流。它是专门为这类事情设计的，而且非常灵活。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-12T22:02:00.433

我有两个建议：

*   增加缓冲区大小以减少迭代次数

和/或

*   不要在每次迭代时调用 IsClientConnected。

原因是根据[微软指南](http://technet.microsoft.com/en-us/library/bb727078.aspx#EMAA)：

*Response.IsClientConnected 有一些成本，因此仅在至少需要 500 毫秒的操作之前使用它（如果您试图维持每秒几十页的吞吐量，那将是很长的时间）。作为一般经验法则，不要在紧密循环的每次迭代中调用它*

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-12T21:43:20.173

使用强大的 Web 服务器（如 Apache）并让它处理文件有什么问题。就像您现在将较大的文件分离到网络服务器一样，为什么不以同样的方式提供较小的文件呢？

是否有一些隐藏的要求可以防止这种情况发生？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-12T21:43:29.270

好吧，这就是它目前的样子......

```
 Stream iStream = null;

// Buffer to read 10K bytes in chunk:
byte[] buffer = new Byte[10000];

// Length of the file:
int length;

// Total bytes to read:
long dataToRead;

if (File.Exists(localfilename))
{
    try
    {
        // Open the file.
        iStream = new System.IO.FileStream(localfilename, System.IO.FileMode.Open, System.IO.FileAccess.Read, System.IO.FileShare.Read);

        // Total bytes to read:
        dataToRead = iStream.Length;

        context.Response.Clear();
        context.Response.Buffer = false;
        context.Response.ContentType = "application/octet-stream";
        Int64 fileLength = iStream.Length;
        context.Response.AddHeader("Content-Length", fileLength.ToString());
        context.Response.AddHeader("Content-Disposition", "attachment; filename=" + originalFilename);

        // Read the bytes.
        while (dataToRead > 0)
        {
            // Verify that the client is connected.
            if (context.Response.IsClientConnected)
            {
                // Read the data in buffer.
                length = iStream.Read(buffer, 0, 10000);

                // Write the data to the current output stream.
                context.Response.OutputStream.Write(buffer, 0, length);

                // Flush the data to the HTML output.
                context.Response.Flush();

                buffer = new Byte[10000];
                dataToRead = dataToRead - length;
            }
            else
            {
                //prevent infinite loop if user disconnects
                dataToRead = -1;
            }
        }
        iStream.Close();
        iStream.Dispose();
    }
    catch (Exception ex)
    {
        if (iStream != null)
        {
            iStream.Close();
            iStream.Dispose();
        }
        if (ex.Message.Contains("The remote host closed the connection"))
        {
            context.Server.ClearError();
            context.Trace.Warn("GetFile", "The remote host closed the connection");
        }
        else
        {
            context.Trace.Warn("IHttpHandler", "DownloadFile: - Error occurred");
            context.Trace.Warn("IHttpHandler", "DownloadFile: - Exception", ex);
        }
        context.Response.Redirect("default.aspx");
    }
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-12T21:45:29.623

有很多许可限制...例如，我们有一份 Office 2007 许可协议，其中规定校园内的任何技术人员都可以下载和安装 Office，但学生不能。所以我们不让学生下载它。所以我们的解决方案是将这些下载隐藏在 .net 后面。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-12T22:36:26.353

Amazon S3 听起来非常适合您的需求，但它是商业服务，并且文件是从他们的服务器提供的。

您应该尝试联系亚马逊并询问学术定价。即使他们没有。

# c# - 您理想的 C# 项目是基于什么构建的？

> ID：437050
> 
> 赞同：1
> 
> 时间：2009-01-12T21:17:07.263
> 
> 标签：c#

我正在开始一个新的个人项目，因此这是自 ASP.NET 2.0 首次发布以来我第一次能够从头开始一个更大的项目。我希望这对我来说也是一次很好的学习体验，所以现在我计划在 ASP.NET MVC、Castle ActiveRecord 和 Ninject 上构建它。我对用于单元测试的 MbUnit 和用于 CI 的 CruiseControl 最满意，所以现在它们是领先者。

但是，一旦您单击“新解决方案”，您会首先添加什么？开源，商业，等等。如果他们看起来可以做到这一点，我会持开放态度。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-12T21:50:24.387

[**网络框架：MVC**](http://www.asp.net/mvc/)

只是制作 Web 应用程序的更好方法

[**OR/M：NHibernate**](http://www.hibernate.org/343.html)

没有什么能在性能或功能上真正击败它

[**Javascript: jQuery**](http://jquery.com/)

在它变得很酷之前一直在使用它。JQuery 对我来说似乎不太像一个框架，而更像是对 javascript 语言的自然扩展

[**国际奥委会：温莎城堡**](http://www.castleproject.org/container/index.html)

最成熟的 .net IoC 容器

[**CI：团队城市**](http://www.jetbrains.com/teamcity/)

一旦你尝试过，你就再也不想回去了

[**测试：NUnit**](http://www.nunit.org/index.php)

它们在功能上都非常正面，我更喜欢工具（resharper）和语法（现在一直在使用它）

[**模拟：犀牛模拟**](http://ayende.com/projects/rhino-mocks.aspx)

同样，我喜欢成熟，尤其是在开源项目中

在 Hanselman [ALT.net Geek Code](http://www.hanselman.com/altnetgeekcode/)中，转换为

IOC(CW):MOC(RM):TDD(NU):SCC(Svn):ORM(NH):XPP(++):DDD(T+):JSL(Jq):CIS(TC):GoF(++ )

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-12T21:54:10.120

建立在任何东西上。就个人而言，我不太喜欢在项目的每个方面使用框架和预构建组件。我喜欢控制所有代码，并自己编写所有代码。你可以称其为非此处发明综合症的极端案例。或者你可以说，如果它是一个核心业务功能，那就自己做吧。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-12T22:28:10.100

对于 IoC，我更喜欢 Microsoft Unity，对于 NHibernate，请确保您查看 Fluent NHibernate 并与 xml 垃圾说再见！

我编写了自己的 Web 客户端软件工厂版本，它利用 Unity 而不是 ObjectBuilder(1)，因为我遇到了很多问题，它包含在其中，在某些时候它将在一系列帖子中发布，但源代码已经在我的网站上，您可以在我的个人资料中查看。

如果您的项目是诚实的企业，我建议您不要使用 MVC 框架。它是从 Web 表单中大量衍生出来的，以至于您会发现许多不生活和呼吸编码的开发人员将无法正确使用它，并且您将不断努力保持 MVC 的正确使用，因为大多数开发人员会以同样的方式对待它方式作为 Web 表单。

# iphone - 你如何监控 iPhone 上的网络流量？

> ID：437061
> 
> 赞同：64
> 
> 时间：2009-01-12T21:20:44.540
> 
> 标签：iphone, security, networking, wireshark

我们正在寻找一种类似 Wireshark 的工具，用于在与第 3 方合作之前在 iPhone 上测试第 3 方应用程序。有什么建议么？

* * *

## 回答 #1

> 赞同：50
> 
> 时间：2012-12-28T07:30:18.127

如果您只想查看 HTTP/HTTPS 流量，中间人代理（如其他答案所建议的）是一个很好的解决方案。

我发现数据包嗅探的最佳解决方案（尽管它仅适用于*实际*的 iOS 设备，而不适用于模拟器）是使用`rvictl`. [这篇博](http://useyourloaf.com/blog/2012/02/07/remote-packet-capture-for-ios-devices.html)文有一篇不错的文章。基本上你这样做：

```
rvictl -s <iphone-uid-from-xcode-organizer> 
```

然后，您使用 Wireshark（或您最喜欢的工具）嗅探它创建的界面，完成后使用以下命令关闭界面：

```
rvictl -x <iphone-uid-from-xcode-organizer> 
```

这很好，因为如果你想对模拟器进行数据包嗅探，你也必须涉足到本地 Mac 的流量，但`rvictl`会创建一个虚拟界面，只显示你插入 USB 的 iOS 设备的流量港口。

注意：这仅适用于 Mac。

* * *

## 回答 #2

> 赞同：36
> 
> 时间：2009-01-12T22:48:28.047

您没有指定您使用的平台，所以我假设它是 Mac ;-)

我所做的是使用代理。我使用[SquidMan](http://squidman.net/squidman/)，一个独立的[Squid实现](http://www.squid-cache.org/)

我在 Mac 上启动 SquidMan，然后在 iPhone 上的 General/Wifi Settings 中输入代理参数。

然后我可以在 Console App 中查看 HTTP 流量，查看 squid-access.log

如果我需要更多信息，我会切换到 tcpdump，但我想 WireShark 也应该可以工作。

* * *

## 回答 #3

> 赞同：24
> 
> 时间：2012-07-26T01:34:11.533

我使用[Charles Web Debugging Proxy](http://www.charlesproxy.com/)，但他们有试用版。

如果您的 iPhone/iPad 与您的 Mac 共享相同的 Wifi 网络，则设置非常简单。

1.  在 Mac 上安装 Charles
2.  获取 Mac 的 IP 地址 - 使用 Mac“网络实用程序”
3.  在您的 iPhone/iPad 上打开 Wifi 设置并在“HTTP 代理”下更改为手动并输入步骤 (2) 中的 IP，然后输入端口为 8888（Charles 默认端口）
4.  打开 Charles 并在代理设置对话框下确保勾选“启用 Mac OS X 代理”和“使用 HTTP 代理”
5.  您现在应该看到出现在 Charles 中的流量
6.  如果您想查看 HTTPS 流量，您需要执行额外的 2 个步骤，下载 [Charles 证书包](http://www.charlesproxy.com/documentation/using-charles/ssl-certificates/)，然后将 .crt 文件通过电子邮件发送到您的 iPhone/iPad 并安装。
7.  在 Proxy Settings Dialog SSL 选项卡中，添加您要使用端口 443 嗅探的特定 https 顶级域。

如果您的 Mac 和 iOS 设备不在同一个 Wifi 网络上，您可以使用系统偏好设置中共享下的“Internet 共享”选项将您的 Mac 设置为 Wifi 路由器。然后，您将设备连接到该“Wifi”网络并按照上述步骤操作。

* * *

## 回答 #4

> 赞同：17
> 
> 时间：2009-01-12T21:31:11.510

通过代理运行它并使用[Wireshark](http://www.wireshark.org/download.html)监控流量。

* * *

## 回答 #5

> 赞同：15
> 
> 时间：2013-12-23T08:15:35.087

## 对于 Mac OS X

1.  安装[查尔斯代理](http://www.charlesproxy.com/)
2.  在 Charles 中，转到代理 > 代理设置。它应该显示 HTTP 代理端口（默认为 8888）。

* * *

## 对于 Windows

1.  安装[提琴手2](http://www.telerik.com/fiddler)
2.  工具 -> Fiddler 选项 -> 连接并选中“允许远程计算机连接”

* * *

## 常规设置

1.  转到设置 > Wifi >`i`符号 > 在底部的代理 > 设置为手动，然后为服务器放置您正在使用的计算机 IP 地址，端口放置 8888，因为这是每个应用程序的默认值

* * *

### ARP 欺骗

最后一部分的一般说明，如果您想嗅探所有网络流量，则可以使用[ARP 欺骗](http://en.wikipedia.org/wiki/ARP_spoofing)将所有流量从您的 iOS 转发到笔记本电脑/台式机。ARP 欺骗有多种工具，需要对所有细节进行研究。这使您可以查看每一盎司的流量，因为您的路由器会将用于 iOS 设备的所有数据路由到笔记本电脑/台式机，然后您将这些数据（自动）转发到 iOS 设备。

*请注意，我只推荐这作为最后的手段。*

* * *

## 回答 #6

> 赞同：9
> 
> 时间：2009-02-08T08:47:53.473

在不确切知道您的要求是什么的情况下，这就是我从 iPhone 上看到 packts 时所做的：在以太网上连接一个 mac，通过机场共享它的网络，然后将 iPhone 连接到那个无线网络。在 Mac 上运行 Wireshark 或 Packet Peeper。

* * *

## 回答 #7

> 赞同：9
> 
> 时间：2009-06-28T08:05:53.867

在越狱的 iPhone/iPod 上，“tcpdump”和“pirni”都可以很好地捕获流量 - 在 cydia 存储库中可用。这些数据的分析是通过将捕获转移到另一台机器并使用类似wireshark的东西来完成的。然而，鉴于这些工具似乎正在积极开发，iPhone 可能很快就会处理这一切。

* * *

## 回答 #8

> 赞同：9
> 
> 时间：2013-01-11T23:34:51.137

我发现的最佳解决方案有效：

通过 USB 连接您的设备

并输入以下命令：

1.  rvictl -s UDID - （设备 20 个字符的 id，您可以在 iTunes 中找到 4t 或在 Xcode 中找到管理器）

2.  sudo launchctl list com.apple.rpmuxd

3.  sudo tcpdump -n -t -i rvi0 -q tcp
    或者只是 sudo tcpdump -i rvi0 -n

如果 rvictl 不起作用，请安装 Xcode

更多信息： [远程虚拟接口](http://developer.apple.com/library/mac/#qa/qa1176/_index.html#//apple_ref/doc/uid/DTS10001707-CH1-SECRVI)

[http://useyourloaf.com/blog/2012/02/07/remote-packet-capture-for-ios-devices.html](http://useyourloaf.com/blog/2012/02/07/remote-packet-capture-for-ios-devices.html)

* * *

## 回答 #9

> 赞同：6
> 
> 时间：2011-04-14T12:43:57.263

这是另一种方式[http://www.tuaw.com/2011/02/21/how-to-inspect-ioss-http-traffic-without-spending-a-dime/](http://www.tuaw.com/2011/02/21/how-to-inspect-ioss-http-traffic-without-spending-a-dime/)

我没有看到 Roger Nolan 的回复，上面的链接是使用不同工具的相同工作流程。

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2011-04-11T16:57:49.260

取决于你想要做什么，通过代理运行它并不理想。只要数据包不被篡改，透明代理就可以正常工作。

我即将在 iOS 4.3.x 上反转从 iPhone 传输到 iPad 的 GPS 数据以获取原始数据 获得干净网络转储的最佳方法是使用“tcpdump”和/或“pirni”正如已经建议的那样。

在这种特殊情况下，我们希望 Tethered 数据需要尽可能透明。显然，您需要将手机越狱才能使其正常工作。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2013-05-15T19:48:40.397

在 Mac OS X 上尝试[Debookee](http://www.iwaxx.com/debookee)，它会透明地拦截 iPhone 的流量，而无需代理，这要感谢 MITM，如前所述。然后，您将实时看到您的设备使用的不同协议。

免责声明：我是付费应用程序 Debookee 开发团队的一员。试用版将在有限的时间内向您展示所有功能。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2009-01-12T21:36:21.997

一个通用的解决方案是使用配置为透明代理的 linux 机器（可能在虚拟机中）来拦截流量，然后使用 wireshark 或 tcpdump 或任何你喜欢的东西对其进行分析。也许MacOS也可以做到这一点，我还没有尝试过。

或者，如果您可以在模拟器中运行应用程序，您可能可以监控自己机器上的流量。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2013-10-18T12:22:37.193

Com'on，没有提到[提琴手](http://fiddler2.com/)？爱在哪里 ：）

Fiddler 是一个非常流行的 HTTP 调试器，面向开发人员而不是网络管理员（即 Wireshark）。

[为 iOS 设置它是相当简单的过程](http://fiddler2.com/documentation/Configure-Fiddler/Tasks/ConfigureForiOS)。它也可以解密 HTTPS 流量！

在 QA 部门开始使用 Fiddler 解决问题后，我们的移动团队终于松了一口气。在 fiddler 出现之前，人们会到处摆弄以知道该怪谁，移动团队或 API 团队，但现在不是了。

# domain-driven-design - 领域对象和服务

> ID：437067
> 
> 赞同：24
> 
> 时间：2009-01-12T21:23:41.523
> 
> 标签：domain-driven-design

在[这个](https://stackoverflow.com/questions/428859/what-goes-in-your-domain-model-objects-and-what-goes-in-your-services)问题中，有人[回答](https://stackoverflow.com/questions/428859/what-goes-in-your-domain-model-objects-and-what-goes-in-your-services#428902)“你永远不要让域对象实现自己调用服务！”。这个声明是 DDD 的硬性规则还是取决于您自己的应用程序和架构？

**人为的例子：**

例如，假设我们`UserImage`的模型中有一个对象，该对象由用户从上传的图像中填充。然后假设我们可以将此图像提交给第 3 方服务，该服务可以识别指纹并`Guid`在找到匹配项时返回 a。

```
public IThumbPrintService {
    Guid FindMatch(Bitmap image);
}

public class UserImage {
    public Bitmap Image {get; set;} 
    public Guid ThumbPrintId {get; set;}
    public bool FindThumbPrintMatch() {
       // Would you call the service from here?
       ThumbPrintId = _thumbPrintService.FindMatch(this.Image);
       return ! ThumbPrintId.CompareTo(Guid.Empty);
    }
}

public class RoboCopUserImageService : IUserImageService {
     // Or move the call to a service method 
     // since it depends on calling a separate service interface
     public bool FindThumbPrintMatch(UserImage userImage) {
        userImage.ThumbPrintId = _thumbPrintService.FindMatch(userImage.Image);
        return !userImage.ThumbPrintId.CompareTo(Guid.Empty);            
     }
} 
```

不让域对象自己调用服务可以避免或获得什么？

**编辑：**有没有讨论这个特定主题的好的在线文章？

* * *

## 回答 #1

> 赞同：47
> 
> 时间：2009-01-12T23:20:03.800

这是[电子表格难题](http://moffdub.wordpress.com/2008/09/10/the-spreadsheet-conundrum/)：[电话是拨打电话号码，还是电话号码在电话上自行拨打](https://stackoverflow.com/questions/68617/design-question-does-the-phone-dial-the-phonenumber-or-does-the-phonenumber-dia)？

您可能会发现[Double Dispatch 读起来](http://c2.com/cgi/wiki?DoubleDispatch)很有趣，尽管[我认为在您的情况下有点矫枉过正](http://moffdub.wordpress.com/2008/12/10/getters-and-setters-a-people-problem/)。

[单一职责原则](http://c2.com/cgi/wiki?SingleResponsibilityPrinciple)经常与 OO 原则“[告诉，不问](http://c2.com/cgi/wiki?TellDontAsk)”[不一致](https://stackoverflow.com/questions/169450/arent-information-expert-tell-dont-ask-at-odds-with-single-responsibility-pri)。我对这个主题的感觉摇摆不定，当逻辑应该进入域对象时，我已经确定了以下条件：

*   逻辑应该是域逻辑，即不像 image.load() 或 image.save()
*   逻辑不应该给对象超过“一个理由”来改变域。这是对 SRP 的重新声明。
*   不应将逻辑强加到对象中。换句话说，如果你最终做了一些事情，[比如在不使用 getter 的情况下尝试计算域对象列表中某些属性的总和](http://moffdub.wordpress.com/2008/12/10/getters-and-setters-a-people-problem/)，请三思而后行。

在您的情况下，我选择不将对服务的调用放在实体对象中，主要是因为该服务似乎与您的域无关，而与持久性更相关。域对象应该与域概念耦合，我认为您提供的服务不合格。

我认为在实体中调用服务可能是可以接受的一个例子是，如果您的应用程序使用第三方工作流服务器来管理其部分状态。本质上，这是在运行时定义状态的[状态模式](http://c2.com/cgi/wiki?StatePattern)。

我认为让 domainObject.moveToNextState() （假设此代码在您的通用语言中“有意义”）调用与您的服务器对话的服务是可以接受的，因为工作流服务器管理域模型的一部分。

我要补充一点，DDD 对遵循该领域的语言非常感兴趣。您是否听到领域​​专家说“用户图像会发现其指纹是否与 XYZ 供应商服务中的指纹匹配”？还是他们说“给定指纹的 XYZ 供应商服务表明该指纹是否存在”？选择在您的领域中最有意义的那个。

还有一些想法（我已经考虑了很多这个问题，因为它是设计的核心）：

*   在 Evans DDD 书中，Account 实体具有 credit(Amount)、debit(Amount)、transferTo(Account, Amount) 和 accrue() 等方法，但 FundsTransferService 具有 transfer(Account, Account, Amount) 方法。transferTo 方法不调用任何服务，而只是处理涉及 Accounts 的逻辑，例如贷记和借记正确的金额。

    除了协调之外，FundsTransferService 有自己的规则要检查，这些规则不适合 Accounts。贷记或借记的确切金额可能涉及外部各方。这使得 transferTo 调用服务很尴尬。

*   对于像 UserImage 这样的简单对象，可以适合对象本身的重要域逻辑可能是稀缺的，因为据我所知，它不是聚合。我认为聚合提供了更多容纳领域逻辑的机会。Account 示例很可能是一个聚合。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-12T21:38:41.243

我看到的一个缺点是，允许您的域对象调用服务可能会使序列化变得更加困难，或者至少在另一方的某人调用其服务方法时序列化后会导致一些问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-12T21:45:19.733

如果您允许实体对象调用服务，它将执行数据对象和服务对象两个角色。一般来说，每个对象都应该有责任，不仅在实现上，而且在使用上。

在您的情况下，低级 UserImage 似乎既是图像又是指纹识别器。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-08-03T22:06:45.220

我认为最好不要从实体或值对象调用存储库或服务，但有时这是必要的，例如，如果一个实体必须返回应该从数据库加载但它不能使用对象图导航到它的其他实体。然后依赖倒置原则就派上用场了，这意味着实体和值对象依赖于服务和存储库的接口，而不是实现。

# visual-studio-2008 - 调试到睡眠

> ID：437071
> 
> 赞同：0
> 
> 时间：2009-01-12T21:25:51.863
> 
> 标签：visual-studio-2008, debugging, sleep

我在使用 VS2008-SP1 和 Vista-SP1 进行调试（f11 等）时遇到问题。它随机但经常性地将我的计算机置于睡眠模式。我在网上寻找过类似的问题，但一无所获。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-12T21:32:49.960

你在用笔记本电脑吗？如果是这样，如果功能锁关闭（或打开，取决于您的型号），那可能是您的“睡眠”按钮。

如需更多帮助，我们需要您的笔记本电脑/台式机型号，或者如果它是台式机，请提供指向键盘在线图片的链接。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-12T22:23:22.653

这是一台索尼台式机 RB30；[http://www.docs.sony.com/reflib/docget.asp?manualid=39973&template_id=1®ion_id=1&DL=](http://www.docs.sony.com/reflib/docget.asp?manualid=39973&template_id=1&region_id=1&DL=) ',600,560,10,10,'手册')

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-12T22:53:29.860

我的第一个想法是有故障的键盘。我会尝试将键盘与另一台计算机交换一段时间，看看它是否会消失。

# wpf - WPF LinkLabel 实现策略

> ID：437075
> 
> 赞同：0
> 
> 时间：2009-01-12T21:28:08.207
> 
> 标签：wpf, animation, default, linklabel

我正在尝试为 WPF 创建一个 LinkLabel 控件。本质上，我将从 TextBlock 创建 LinkLabel 并处理 MouseEnter、MouseLeave 和 MouseLeftButtonUp 事件。在后端，我有一个基类，它具有您希望通过 LinkLabel 看到的属性。对于 WPF 中的大多数其他可单击控件，有一个默认的 MouseEnter 动画，其中控件变为冰蓝色。当鼠标光标进入 TextBlock 时，我想复制此行为。我不确定我是否需要从 ButtonBase 或类似的东西派生。我有一个我能够将光标更改为一只手，并处理单击“LinkLabel”时的事件。如果访问这个看似默认的变色动画，那么我可能不得不求助于简单的前景色交换而没有平滑过渡。如果有人之前创建了自定义 WPF LinkLabel 或对此事有任何建议，您的意见将不胜感激。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-12T21:38:08.640

您现在可以使用 TextBlock 和 HyperLink 的组合创建相当于 WinForms 的 LinkLabel：

```
<TextBlock>Here is a <Hyperlink NavigateUri="http://example.com">link</Hyperlink></TextBlock> 
```

您不会获得“冰蓝色”鼠标悬停效果，但您会获得手形光标。我相信您可以使用简单的样式触发器来引入鼠标悬停效果。

“NavigateUri”属性适用于超链接位于 Frame 控件内的导航样式应用程序。在标准 WPF 应用程序中，您需要处理超链接的 Click 事件，并使用 Process.Start 以正确的 URL 启动 Web 浏览器。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-05-16T15:48:01.470

我刚刚为按钮创建了一个样式，并在您想要 LinkLabel 外观时将样式应用于按钮。按钮的单击事件用于在单击文本时执行功能。

```
<Style x:Key="LinkLabelButtonStyle" TargetType="Button">
        <Style.Triggers>
            <Trigger Property="IsMouseOver" Value="True">
                <Setter Property="Foreground" Value="CornflowerBlue"></Setter>
            </Trigger>
        </Style.Triggers>
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="Button">
                    <Border Background="Transparent">
                        <ContentPresenter/>
                    </Border>                            
                </ControlTemplate>
            </Setter.Value>
        </Setter>
        <Setter Property="ContentTemplate">
            <Setter.Value>
                <DataTemplate>
                    <TextBlock TextDecorations="Underline" Text="{TemplateBinding Content}"></TextBlock>
                </DataTemplate>
            </Setter.Value>
        </Setter>     
        <Setter Property="Foreground" Value="DarkBlue"></Setter>
        <Setter Property="MinWidth" Value="90"></Setter>
        <Setter Property="HorizontalAlignment" Value="Left"></Setter>
        <Setter Property="Padding" Value="5"></Setter>
        <Setter Property="Margin" Value="5"></Setter>
        <Setter Property="Cursor" Value="Hand"></Setter>
    </Style> 
```

您可以将上述样式放在 Window.Resources 中，以便在整个窗口中使用它。

然后在您想要 LinkLabel 外观时将样式应用于按钮。

```
<Button Name="LinkLabelLookALikeButton" Content="Text goes here" Style="{StaticResource LinkLabelButtonStyle}" Click="Event_Goes_Here">                        
                </Button> 
```

希望这可以帮助！

# c# - 如何从 xhtml 到 excel 到 xhtml

> ID：437082
> 
> 赞同：1
> 
> 时间：2009-01-12T21:30:30.463
> 
> 标签：c#, excel, xhtml, ms-office, export-to-excel

我有一个关于如何最好地将 xhtml 转换为 excel 的问题。让用户在 excel 中编辑它，然后在最后返回 xhtml。

背景是我有一个 Web 应用程序，其中的文本存储在 xhtml 中。这些我可以使用 excel 单元格中的 html 导出到 excel 文件。

我也可以将此单元格重新导入 xhtml，但我遇到的问题是，对于普通用户来说，编辑它非常困难，因为 html 只是 excel 单元格中的文本。

这是错误的方法吗？我是否应该只使用具有多个 html 编辑器的自定义应用程序，但用户更喜欢可以轻松交换和离线工作的 excel 文档。

这是一个示例 xml，但它可以是用户在带有 xhtml 严格的 html 编辑器 (tinymce) 中输入的任何 xhtml。我假设没有用于 excel 的 html 编辑器插件。我从来没有听说过，也找不到一个，因为这将是最简单的解决方案..

审查

```
* A Bullet: The impact of
* A bullet 2: Test text 
```

标题

```
* Bullet: text
* Bullet: Text 
```

有人有什么想法吗？谢谢，撞坏了

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-24T20:29:07.713

如果您已经熟悉 XSLT，那么听起来这将是最好的选择。尽管 Excel 2003 不使用 .xlsx 格式，但它确实读取（并保存）了他们所谓的“SpreadsheetML”，它也是 XML。我发现学习如何对 SpreadsheetML 进行转换的最简单方法就是在 Excel 中打开一个电子表格，按照您喜欢的方式对其进行格式化，然后另存为 -> XML 电子表格 (*.xml)。打开该 XML 文件，您将看到 Excel 为您的工作簿定义的所有样式，然后您可以使用这些样式作为“模板”来编写 XSLT，将您的 XHTML 转换为该格式。

如需进一步阅读和体面的演练，请查看 MSDN 上的[Dive into SpreadsheetML（第 1 部分，共 2 部分）](http://msdn.microsoft.com/en-us/library/bb226687(office.11).aspx "深入了解 SpreadsheetML")。

大概您可以然后使用另一个 XSL 转换来提取您需要从 SpreadsheetML 到 XHTML 的数据。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-15T13:37:12.370

我的建议是实际执行以下操作：

xml到excel到xml

我的理由是

1.  用户将能够打开 xml 并实际获得对文档的基本了解（xhtml 具有他们不关心的无用标签，例如“html”或“head”），因为它清晰而简单。
2.  Excel可以打开xml文件
3.  轻松编写将 Excel 数据导出为 XML 的宏（许多不错的 xml 读取器/写入器）
4.  您可以为该 xml 文件定义一个 xslt 模板，它将很好地显示为 html 文档。
5.  我注意到您关于仅限于 office 2003 的评论。您可以定义一个 xslt 模式，然后如果它足够简单，firefox 或 iexplorer 将实际为您呈现它。您可以在此处查看浏览器支持：http: [//www.w3schools.com/xsl/xsl_browsers.asp](http://www.w3schools.com/xsl/xsl_browsers.asp)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-12T21:43:13.403

我曾经为自己的个人使用实施的一个解决方案是，我在 excel 中编写了一个宏来解析 html 文件并仅用数据填充 excel 工作表。完成后，宏将读取工作表中的数据并生成 html 文件。

然而，我的案例有一个非常简单的 html 文件，我基本上只需要解析很少的标签。

但是，您可能能够找到一个解决方案/实用程序，使您更容易做到这一点。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-12T21:58:31.237

在没有看到您的具体文件的情况下，我只能选择一种通用的解决方案。

如果您可以按标签分解文档，则可以向最终用户显示数据并将标签信息存储在隐藏的工作表中。所以，如果你有：

1-233

您可以在可见工作表的前三个单元格中显示 1、-2 和 33，并将 td、td style="color:red"、td 存储在不可见工作表上的匹配单元格中。然后，您将标签数据存储在视线之外，最大限度地减少用户混淆，并在需要生成 xhtml 文件时检索它。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-12T22:40:26.923

这是一个示例 xml，但它可以是用户在带有 xhtml 严格的 html 编辑器 (tinymce) 中输入的任何 xhtml。我假设没有用于 excel 的 html 编辑器插件。我一个都没听说过。。

**审查**

*   子弹：影响
*   项目符号 2：测试文本

**标题**

*   项目符号：文本
*   项目符号：文本

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-12T22:41:55.330

没有看到文档的复杂性可能很难，但是 XSLT 呢？如果它是 .xlsx，则 excel 本身就是 xml。无论哪种方式，它都会导出到 XML。您可以制作一个 XSLT 模板，将其转换为最终的 xhtml 文档。

# maven-2 - mvn release：在没有源代码的情况下执行，最终出现在工件中

> ID：437085
> 
> 赞同：1
> 
> 时间：2009-01-12T21:31:25.033
> 
> 标签：maven-2, release

做 mvn release:perform 的正确方法是什么，这样源代码就不会出现在我的工件中？

所有帮助表示赞赏。我知道我在某处看到过这个文件

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-10T15:22:43.590

尝试将 maven-source-plugin 的附加属性设置为 false，例如：

```
 <pluginManagement>
         <plugins>
             <plugin>
                  <artifactId>maven-source-plugin</artifactId>
                  <configuration>
                      <attach>false</attach>
                  </configuration>
             </plugin>
         </plugins>
     </pluginManagement> 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-05T17:12:21.003

在 Maven 发布插件配置中将属性[useReleaseProfile设置为 false：](http://maven.apache.org/plugins/maven-release-plugin/perform-mojo.html#useReleaseProfile)

```
 <build>
    <plugins>
      <plugin>
        <groupId>org.apache.maven.plugins</groupId>
        <artifactId>maven-release-plugin</artifactId>
        <configuration>
          <useReleaseProfile>false</useReleaseProfile>
          ..
        </configuration>
      </plugin>
    </plugins>
  </build> 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-10T23:45:16.570

禁用内置的发布配置文件，然后定义您自己的。以 maven 父 pom 为例： http: [//svn.apache.org/viewvc/maven/pom/trunk/maven/pom.xml ?annotate=759540](http://svn.apache.org/viewvc/maven/pom/trunk/maven/pom.xml?annotate=759540)

查看第 630 行的发布插件配置，然后查看第 910 行的我们使用的发布配置文件。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-01-28T14:50:08.093

在进行真正的发布之前，您可以（应该）进行试运行以验证一切是否正常。这是通过将 dryRun 参数设置为 true 来完成的。

```
mvn release:prepare -DdryRun=true 
```

完成此操作后，您应该进行释放清理：

```
mvn release:clean 
```

问候

# javascript - innerHTML 和 ?

> ID：437086
> 
> 赞同：1
> 
> 时间：2009-01-12T21:31:31.727
> 
> 标签：javascript, html, embed, innerhtml

我正在尝试修复我正在使用的富文本编辑器中的一个错误，该错误会导致`<embed>`插入的标签没有结束标签（这完全搞砸了输出）。我已将问题隔离到此操作：

```
// body is a <body> tag
body.innerHTML = '<embed src="http://example.com/whatever"></embed>'; 
```

没有花哨的代码，只是 Firefox 的`innerHTML`任务。您应该能够像这样在 Firebug 中复制错误：

```
>>> document.body.innerHTML = "<embed></embed>"
"<embed></embed>"
>>> document.body.innerHTML
"<embed>" 
```

有解决方法吗？我需要标签，但由于一个糟糕的边缘情况，我无法证明重建/替换整个富文本编辑器是合理的。

我无法将其转换为类似 的`document.createElement('embed')`内容，因为此编辑器的实际输入很容易包含围绕`<embed>`;的几段文本。在纸面上，innerHTML 非常适合这个用例，但我无法让它与`<embed>`.

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-12T21:48:21.350

根据[W3C](http://validator.w3.org/docs/help.html)的说法，这可能无法解决您的问题，但*<embed>*在 HTML5 之前并不是任何标准化 HTML 版本的一部分。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-12T22:04:40.193

尽管 <embed> 不是标准 html 的一部分，但它已被广泛实施，因此是事实上的标准。

也就是说，我正在运行 Firefox 3（MineField v3.0.0.5）并且有点出乎意料，但功能完全正确。我期望将*确切的*HTML 放入我选择的元素中，但我得到了*干净*的html。

由于 <embed 是一个空标签（即它不能有内容，只有属性），Firefox 把这个

```
<embed attribute="value"></embed> 
```

进入

```
<embed  attribute="value"/> 
```

，这是一个完全有效的封闭标签。它对其他空标签执行相同的操作，例如 <input /> 和 <image>

在[此页面上](http://yaauie.com/stackoverflow/437086/)，您可以看到这一点。该页面的无脚本版本在亮粉色 div 内嵌入了一个视频 (youtube)。该脚本窃取其内容并将其作为 innerHTML 放入正文中。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-13T08:05:04.273

这让我想起了 document.write 与 <script /> 标记有关的问题。

谎言。不要在睡前回答这些问题。

~~我在 Firebug 中尝试了以下操作~~

 ~~```
//break up initial embed into single chunks
document.body.innerHTML = "<e"+"mbe"+"d></embed>" 
```~~ 

~~当我检查 innerHTML 的值时，得到了预期的显示。这里的想法是将初始字符串分解为多个连接的字符串。愚蠢，但可能的解决方法。~~

# jquery-ui - 提高jQuery中表格导航的性能

> ID：437091
> 
> 赞同：0
> 
> 时间：2009-01-12T21:34:27.930
> 
> 标签：jquery-ui

我正在尝试使用 asp.net gridview 的键编写表格导航。这就是我到目前为止所拥有的。它工作正常，但速度很慢。请看一下，如果可能的话，让我知道如何提高性能。

基本上它是带有输入元素的 html 表。table的结构是这样的

```
<table>
<tr>
<td>
<div style="height:22px;">
     <input type = "text">
</div>
</td>
</tr>
<tr>
<td>
<div style="height:22px;">
     <input type = "text">
</div>
</td>
</tr>
...
</table>
jQuery(function($) {
             $('table#<%= myTable.ClientID %>')
                .bind('keydown', funcKeyDown)
        });

function funcKeyDown(event)
        {   
            //get cell element.
            var cell = event.target;

            //get current cellIndex
            var $cell = $(cell);         
            var currCell = $cell.parents("td"); 
            var cellIndex = currCell[0].cellIndex;
            //get current rowIndex
            var currRow = $cell.parents("tr");
            var rowIndex = currRow[0].rowIndex;   

            var nextRowIndex, targetElem = null; 
            var nextCell;           
            switch(event.keyCode) {                
                case 13: //enter key
                    if(shiftKeyPressed == 1){
                        //move left                        
                        if(!(cellIndex == 0)){                        
                        targetElem = currRow.children("td").eq(cellIndex-1).find("input[type=text]");
                        if(targetElem){targetElem.select();}}}
                    else {
                        //move right
                       if(!(cellIndex == (numElements -1))){
                            targetElem = currRow.children("td").eq(cellIndex+1).find("input[type=text]");                        
                            if(targetElem){
                                targetElem.select();
                            }
                        }
                    }                         
                    return false;                          
                case 16: //shift key
                    shiftKeyPressed = 1;
                    return false;
                case 33:                    
                case 34: //page-up, page-down
                    if(event.keyCode == 33){
                        nextRowIndex = rowIndex - pageSize;
                        if(nextRowIndex < 0) nextRowIndex = 0;                
                    }
                    if(event.keyCode == 34){
                        nextRowIndex = rowIndex + pageSize;
                        if(nextRowIndex > numRows) nextRowIndex = numRows;
                    }                      
                    targetElem = currRow.parent().children("tr").eq(nextRowIndex).children("td").eq(cellIndex)
                                    .find("input[type=text]");                                                                
                    if(targetElem != null){targetElem.select();}
                    return false;                   
                case 37: //left       
                    if(!(cellIndex == 0)){                        
                        targetElem = currRow.children("td").eq(cellIndex-1).find("input[type=text]");
                        if(targetElem != null){targetElem.select();}}
                    return false;                                                
                case 38: //up                    
                    if(rowIndex != 0){
                        targetElem = currRow.parent().children("tr").eq(rowIndex-1).children("td").eq(cellIndex)
                                        .find("input[type=text]");                                                                
                        if(targetElem != null){
                        targetElem.select();}}
                    return false;                                                
                case 39: //right arrow
                    if(!(cellIndex == (numElements -1))){
                        targetElem = currRow.children("td").eq(cellIndex+1).find("input[type=text]");                        
                        if(targetElem != null){targetElem.select();}}
                    return false;                                                
                case 40: //down                                               
                    if(rowIndex >= 0){
                        targetElem = currRow.parent().children("tr").eq(rowIndex+1).children("td").eq(cellIndex)
                                        .find("input[type=text]");                                                                
                        if(targetElem != null){targetElem.select();}}
                    return false;                                                                                                        
            }            
        } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-12T22:56:08.327

首先，在您进入 switch 语句并确定您是否真的需要做任何事情之前，您已经为每次按键运行了代码。

您需要将该代码分解为仅获取 TD 的函数（作为简单的元素变量而不是 Jquery 包装器）。

最重要的是，您必须了解 JQuery 抽象浏览器之间的差异会带来价格和性能。例如，当绑定事件触发时，在调用实际事件函数之前，该事件需要运行适量的 Javascript。

您对 currRow.children("td").eq(cellIndex+1).find("input[type=text]"); 的使用 不会特别好。您可以通过在 td 上指定高度来消除额外的 div。然后假设 td 只包含这样的输入。

```
var tdNext = td.nextSibling;
var textBox =  tdNext ? tdNext.firstChild : null;
if (textBox) $(textBox).select(); 
```

教训是有时您需要为了性能而规避 JQueries 的优势。上面的代码在多个浏览器之间仍然非常兼容。

您可以将类似的技术应用于其他主键左、上、下和输入。

您是否有理由不使用 event.shiftKey 来检测 shift 键？使用看起来像的全局变量似乎并不合理。

# java - JavaBeans 比较

> ID：437093
> 
> 赞同：10
> 
> 时间：2009-01-12T21:35:02.763
> 
> 标签：java, compare, javabeans

有谁知道一个免费的开源库（实用程序类），它允许您比较一个 Java bean 的两个实例并返回这两个实例中值不同的属性列表/数组？请张贴一个小样本。

干杯
托马斯

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-12T22:10:32.460

[Apache commons 的BeanComparator](http://commons.apache.org/proper/commons-beanutils/javadocs/v1.8.3/apidocs/org/apache/commons/beanutils/BeanComparator.html)是您正在寻找的。

**更新**。一个将 JavaBeans 与一个属性进行比较的简单示例（仅针对一个属性进行比较，您应该创建与要匹配的属性一样多的 BeanComparators）。

```
import org.apache.commons.beanutils.BeanComparator;

public class TestBeanComparator
{
    public TestBeanComparator()
    {
    }

    public class TestBean
    {
        int value;

        public TestBean()
        {
        }

        public int getValue()
        {
            return value;
        }

        public void setValue(int value)
        {
            this.value = value;
        }
    }

    public static void main(String[] args)
    {
        TestBeanComparator tbc = new TestBeanComparator();

        tbc.go();
    }

    public void go()
    {
        TestBean tbs [] = new TestBean[10];

        for (int i = 0; i < tbs.length; i++)
        {
            tbs[i] = new TestBeanComparator.TestBean();
            tbs[i].setValue((int) (Math.random() * 10));

            System.out.println("TestBean["+i+"] = " + tbs[i].getValue());
        }

        BeanComparator bc = new BeanComparator("value");

        System.out.println("");
        System.out.println("Value to match: " + tbs[0].getValue());
        for (int i = 1; i < tbs.length; i++)
        {
            if(bc.compare(tbs[i], tbs[0]) == 0)
            {
               System.out.println("Match found in bean "+ i); 
            }
        }
    }
} 
```

经过一些测试，一个结果是成功的。这是输出：

```
TestBean[0] = 0
TestBean[1] = 4
TestBean[2] = 0
TestBean[3] = 2
TestBean[4] = 7
TestBean[5] = 3
TestBean[6] = 0
TestBean[7] = 3
TestBean[8] = 7
TestBean[9] = 3

Value to match: 0
Match found in bean 2
Match found in bean 6 
```

显然增加 TestBean 数组大小会增加获得匹配的机会。

您需要将以下 jar 导入到您的项目中：commons -logging-version.jar 、commons-beanutils-version.jar、commons-beanutils-core- *version.jar* *、 commons-* *beanutils* -bean-collections-version.jar *、* commons -collections-*版本*.jar。

这些文件包含在[commons-logging](http://commons.apache.org/logging/)、[commons-beanutils](http://commons.apache.org/beanutils/)和[commons-collections](http://commons.apache.org/collections/) API 中。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-01-12T22:21:41.813

[**`BeanComparator`**](http://commons.apache.org/beanutils/apidocs/org/apache/commons/beanutils/package-summary.html#bean-comparator)可用于[**集合排序**](https://stackoverflow.com/questions/420223#420240)。
它是一种`Comparator`基于共享属性值比较 bean 的实现。

> `BeanComparators`是可以作用于任何 Java Bean 的通用比较器。通过良好的底层 bean 反射系统，它们可以处理具有 bean 属性、数组、集合和映射的 bean。
> 
> 如果我们有一个`java.util.List`Java Bean 类型`Person`——其中`Person`的年龄是`Integer`，名称是字符串，国家是 Country bean（它本身有一个字符串名称）——**我们可以用 a`BeanComparator`** .
> 
> [一些例子](http://www.builderau.com.au/program/java/soa/Java-tips-for-list-iteration-and-bean-comparisons/0,339024620,320273675,00.htm)：

```
List people = ...; // list of Person objects

//sort by age
BeanComparator comp = new BeanComparator("age");
Collections.sort(list, comp);

//sort by name
BeanComparator comp = new BeanComparator("name");
Collections.sort(list, comp);

//sort by country name
BeanComparator comp = new BeanComparator("country.name");
Collections.sort(list, comp); 
```

无需编写`PersonComparator`具有大量属性选项的 a 来排序。取而代之的是，一个单一的`BeanComparator`班级负责这一切。

* * *

您将在此处找到[完整示例](http://www.zdnetasia.com/techguide/java/0,39044898,39233374,00.htm)，其中包含以下场景：

> 如果您正在实现一个比较器来动态比较属性（例如，考虑根据客户选择的列对网页上的表中的行进行排序），那么您可以推迟构建比较器，直到您知道选择了哪个属性排序。
> 
> 这是`BeanComparator`真正闪耀的地方。当您使用`BeanComparator`.

# java - 我在哪里可以下载 NetBeans 附带的“appframework.jar”的源代码？

> ID：437097
> 
> 赞同：5
> 
> 时间：2009-01-12T21:36:04.090
> 
> 标签：java, swing, netbeans, jdesktop

我刚刚开始尝试 NetBeans。我创建了一个新的 Java 桌面应用程序项目，它自动添加了 JDesktop“appframework-1.0.3.jar”库。但是，每当我尝试查看其源代码时，该命令都会失败。我尝试在网上搜索它，但我找不到它。那么我在哪里可以下载“Swing 应用程序框架”的源代码（appframework.jar 和 swing-worker.jar）？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-10-21T09:15:04.400

[http://java.net/projects/appframework/sources/svn/show/trunk/AppFramework](http://java.net/projects/appframework/sources/svn/show/trunk/AppFramework)

链接和来源太旧了，很难找到，幸运的是我用了 30 分钟找到它： [https ://java.net/projects/appframework/sources/svn/show/trunk/www/downloads?rev=151](https://java.net/projects/appframework/sources/svn/show/trunk/www/downloads?rev=151)

你可以在结尾看到 appframework-1.0.3.jar 的 "source","jar","doc"。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-01-02T16:55:12.590

`Tools -> Plugins -> Available Plugins`如果您遇到这个问题，因为使用My Answer找不到“Swing Application Framework”（appframework.jar）可能会对您有所帮助。

首先，如果您只需要 appframework.jar，请从以下链接获取。如果您已经单击其他答案中的链接，则**Swing 应用程序框架**已从 java.net 迁移，并且很难找到它的迁移位置

[https://mvnrepository.com/artifact/net.java.dev.appframework/appframework/1.03](https://mvnrepository.com/artifact/net.java.dev.appframework/appframework/1.03)

如果您只是需要 Netbeans 进行 Swing 应用程序开发，我建议您使用 Netbeans 8.0.2 版本。正如我所经历的，最新版本没有视频教程中使用的确切 IDE，其他版本可能无法与 Swing 一起正常工作。根据我的经验，以下版本将在 Java Swing 应用程序开发方面为您服务

[https://netbeans.org/downloads/old/8.0.2/](https://netbeans.org/downloads/old/8.0.2/)

# ios - 如何从 UIColor 获取 RGB 值？

> ID：437113
> 
> 赞同：103
> 
> 时间：2009-01-12T21:39:26.423
> 
> 标签：ios, rgb, uicolor

我正在使用以下代码创建一个颜色对象。

```
curView.backgroundColor = [[UIColor alloc] initWithHue:229 saturation:40 brightness:75 alpha:1]; 
```

如何从创建的颜色对象中检索 RGB 值？

* * *

## 回答 #1

> 赞同：121
> 
> 时间：2011-10-21T16:15:09.737

在 iOS 5 中，您可以使用：

```
CGFloat red = 0.0, green = 0.0, blue = 0.0, alpha =0.0;
[multipliedColor getRed:&red green:&green blue:&blue alpha:&alpha]; 
```

* * *

## 回答 #2

> 赞同：85
> 
> 时间：2009-01-12T22:08:21.887

```
const CGFloat *colors = CGColorGetComponents( curView.backgroundColor.CGColor ); 
```

这些链接提供了更多详细信息：

*   [UIColor 参考](https://developer.apple.com/documentation/uikit/uicolor?language=objc)
*   [CGColorGetComponents 参考](https://developer.apple.com/documentation/coregraphics/1455930-cgcolorgetcomponents)

* * *

## 回答 #3

> 赞同：43
> 
> 时间：2016-01-20T01:45:42.180

**斯威夫特 3 和 4**

我发现 cgColor.components 并不总是返回 4 个颜色值，所以我改变了这个，所以它从 CIColor 包装器中获取它们

```
extension UIColor {
    var redValue: CGFloat{ return CIColor(color: self).red }
    var greenValue: CGFloat{ return CIColor(color: self).green }
    var blueValue: CGFloat{ return CIColor(color: self).blue }
    var alphaValue: CGFloat{ return CIColor(color: self).alpha }
} 
```

**斯威夫特 2**

```
extension UIColor {
    var red: CGFloat{ return CGColorGetComponents(self.CGColor)[0] }
    var green: CGFloat{ return CGColorGetComponents(self.CGColor)[1] }
    var blue: CGFloat{ return CGColorGetComponents(self.CGColor)[2] }
    var alpha: CGFloat{ return CGColorGetComponents(self.CGColor)[3] }
} 
```

这不是最有效的方法，所以我不会使用它来不断重新绘制视图。

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2014-07-11T11:02:50.130

希望这会有所帮助

```
CGFloat red, green, blue, alpha;

//Create a sample color

UIColor *redColor = [UIColor redColor];

//Call 

[redColor getRed: &red 
  green: &green
  blue: &blue 
  alpha: &alpha];
NSLog(@"red = %f. Green = %f. Blue = %f. Alpha = %f",
  red,
  green,
  blue,
  alpha); 
```

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2014-01-23T00:12:10.777

刚刚为此做了一个类别。

```
NSLog(@"%f", [UIColor blueColor].blue); // 1.000000 
```

类似于：

```
typedef enum { R, G, B, A } UIColorComponentIndices;

@implementation UIColor (EPPZKit)

-(CGFloat)red
{ return CGColorGetComponents(self.CGColor)[R]; }

-(CGFloat)green
{ return CGColorGetComponents(self.CGColor)[G]; }

-(CGFloat)blue
{ return CGColorGetComponents(self.CGColor)[B]; }

-(CGFloat)alpha
{ return CGColorGetComponents(self.CGColor)[A]; }

@end 
```

[**`eppz!kit`**](https://github.com/eppz/eppz-kit)更多[UIColor 好东西](https://github.com/eppz/eppz-kit/blob/master/eppz!kit/UIColor%2BEPPZKit.h)的一部分。

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2019-11-18T16:34:10.147

您可以使用 CIColor 组件（swift 5）

```
let ciColor = CIColor(color: backgroundColor)
let alpha = ciColor.alpha
let red = ciColor.red
let blue = ciColor.blue
let green = ciColor.green 
```

这也适用于非 RGB 颜色空间

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2009-01-12T22:35:32.800

```
const float* colors = CGColorGetComponents( curView.backgroundColor.CGColor ); 
```

谢谢。我不得不`const`在行的开头添加，因为它正在生成警告。

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2013-06-15T02:40:06.263

```
 UIColor *color = [[UIColor greenColor] retain]; //line 1

//OR(You will have color variable either like line 1 or line 2)

color = curView.backgroundColor;//line 2
CGColorRef colorRef = [color CGColor];

int _countComponents = CGColorGetNumberOfComponents(colorRef);

if (_countComponents == 4) {
    const CGFloat *_components = CGColorGetComponents(colorRef);
    CGFloat red     = _components[0];
    CGFloat green = _components[1];
    CGFloat blue   = _components[2];
    CGFloat alpha = _components[3];

    NSLog(@"%f,%f,%f,%f",red,green,blue,alpha);
}

[color release]; 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2016-05-02T13:26:13.513

`UIColor`从 iOS 2.0 开始，调用了一个私有实例方法，`styleString`它返回颜色的 RGB 或 RGBA 字符串表示形式，即使对于 RGB 空间之外的 whiteColor 等颜色也是如此。

目标-C：

```
@interface UIColor (Private)

- (NSString *)styleString;

@end

// ...

[[UIColor whiteColor] styleString]; // rgb(255,255,255)
[[UIColor redColor] styleString]; // rgb(255,0,0)
[[UIColor lightTextColor] styleString]; // rgba(255,255,255,0.600000) 
```

在 Swift 中，您可以使用桥接头来公开接口。使用纯 Swift，您将需要`@objc`使用私有方法和协议创建一个`unsafeBitCast` `UIColor`协议：

```
@objc protocol  UIColorPrivate {
    func styleString() -> String
}

let white = UIColor.whiteColor()
let red = UIColor.redColor()
let lightTextColor = UIColor.lightTextColor()

let whitePrivate = unsafeBitCast(white, UIColorPrivate.self)
let redPrivate = unsafeBitCast(red, UIColorPrivate.self)
let lightTextColorPrivate = unsafeBitCast(lightTextColor, UIColorPrivate.self)

whitePrivate.styleString() // rgb(255,255,255)
redPrivate.styleString() // rgb(255,0,0)
lightTextColorPrivate.styleString() // rgba(255,255,255,0.600000) 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2016-11-08T14:32:45.127

Swift 3 版本的 David Rees 回答：

```
extension UIColor {

    var redValue: CGFloat{
        return cgColor.components! [0]
    }

    var greenValue: CGFloat{
        return cgColor.components! [1]
    }

    var blueValue: CGFloat{
        return cgColor.components! [2]
    }

    var alphaValue: CGFloat{
        return cgColor.components! [3]
    }
} 
```

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2018-12-07T01:45:48.840

投票最多的答案已过时：

> 错误：：3:1：错误：“CGColorGetComponents”已被属性“CGColor.components”替换

相反，使用

`myUIColor.cgColor.components`

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2015-08-05T02:24:34.167

我想获得`UITableViewStyle`“UITableViewStyleGrouped”的背景颜色，所以在`viewDidAppear:`方法中我添加了代码：

`NSLog(@"%@", self.tableView.backgroundView.backgroundColor);`

它完成了我的预期并返回了日志：

`UIDeviceRGBColorSpace 0.937255 0.937255 0.956863 1`

所以简而言之，只需输入`NSLog(@"%@", [UIColor whateverColor]);`

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2018-07-27T06:44:01.090

我为此和其他颜色控件制作的一些有用的宏：

在您的情况下，您只需使用

```
getRGBA(myColor, red, green, blue, alpha);

NSLog(@"Red Value: %f", red);
NSLog(@"Blue Value: %f", green);
NSLog(@"Green Value: %f", blue); 
```

* * *

# 宏：

```
#define rgba(r,g,b,a) [UIColor colorWithRed:((float)(r))/255.0f green:((float)(g))/255.0f blue:((float)(b))/255.0f alpha:a]
#define rgb(r,g,b) rgba(r, g, b, 1.0f)

#define rgbaf(r,g,b,a) [UIColor colorWithRed:(r) green:(g) blue:(b) alpha:a]
#define rgbf(r,g,b) rgbaf(r, g, b, 1.0f)

#define rgba_fromColor(__color, __r, __g, __b, __a) \
CGFloat __r, __g, __b, __a;\
UIColor *__unpackedColor = [NSKeyedUnarchiver unarchiveObjectWithData:[NSKeyedArchiver archivedDataWithRootObject:__color]];/*Bring system colors into compatible color-space (e.g. DarkGrayColor)*/\
[__unpackedColor getRed:&__r green:&__g blue:&__b alpha:&__a];
#define getRGBA(__color, __r, __g, __b, __a) hsba_fromColor(__color, __r, __g, __b, __a)

#define getRed(__color)  (\
(^float (void){\
rgba_fromColor(__color, r, g, b, a);\
return r;\
})()\
)

#define getGreen(__color)  (\
(^float (void){\
rgba_fromColor(__color, r, g, b, a);\
return g;\
})()\
)

#define getBlue(__color)  (\
(^float (void){\
rgba_fromColor(__color, r, g, b, a);\
return b;\
})()\
)

#define getAlpha(__color)  (\
(^float (void){\
rgba_fromColor(__color, r, g, b, a);\
return a;\
})()\
)

#define hsba(h,s,b,a) [UIColor colorWithHue:((float)(h))/360.0f saturation:((float)(s))/100.0f brightness:((float)(b))/100.0f alpha:a]
#define hsb(h,s,b) hsba(h, s, b, 1.0f)

#define hsbaf(h,s,b,a) [UIColor colorWithHue:(h) saturation:(s) brightness:(b) alpha:a]
#define hsbf(h,s,b) rgbaf(h, s, b, 1.0f)

#define hsba_fromColor(__color, __h, __s, __b, __a) \
CGFloat __h, __s, __b, __a;\
UIColor *__unpackedColor = [NSKeyedUnarchiver unarchiveObjectWithData:[NSKeyedArchiver archivedDataWithRootObject:__color]];/*Bring system colors into compatible color-space (e.g. DarkGrayColor)*/\
[__unpackedColor getHue:&__h saturation:&__s brightness:&__b alpha:&__a];
#define getHSBA(__color, __h, __s, __b, __a) rgba_fromColor(__color, __h, __s, __b, __a)

#define getHue(__color)  (\
(^float (void){\
hsba_fromColor(__color, h, s, b, a);\
return h;\
})()\
)

#define getSaturation(__color)  (\
(^float (void){\
hsba_fromColor(__color, h, s, b, a);\
return s;\
})()\
)

#define getBrightness(__color)  (\
(^float (void){\
hsba_fromColor(__color, h, s, b, a);\
return b;\
})()\
)

/*
///already defined in RGBA macros
#define getAlpha(__color)  (\
(^float (void){\
hsba_fromColor(__color, h, s, b, a);\
return a;\
})()\
)
*/ 
```

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2021-07-15T13:47:31.237

CGColor 的属性[组件](https://developer.apple.com/documentation/coregraphics/cgcolor/2427146-components)就是你所需要的。

下面的代码

`UIColor.separator.cgColor.components`

打印以下内容

`Optional([0.23529411764705882, 0.23529411764705882, 0.2627450980392157, 0.29])`

数组**的第一个元素**是**红色值**，**第二个**是**绿色值**，**第三个**是**蓝色值**，**最后一个**是**alpha 值**。很简单！

* * *

## 回答 #15

> 赞同：-1
> 
> 时间：2016-06-30T18:50:11.403

使用**[HandyUIKit](https://github.com/Flinesoft/HandyUIKit)**让这变得**非常简单**：

```
import HandyUIKit    

let color = UIColor(red: 0.1, green: 0.2, blue: 0.3, alpha: 0.4)

// get any of the rgba values
color.rgba.red    // => 0.1
color.rgba.green  // => 0.2
color.rgba.blue   // => 0.3
color.rgba.alpha  // => 0.4 
```

还有一个类似的选项来**获取`hsba`值**：

```
let color = UIColor(hue: 0.1, saturation: 0.2, brightness: 0.3, alpha: 0.4)

// you can get any of the hsba values, too
color.hsba.hue         // => 0.1
color.hsba.saturation  // => 0.2
color.hsba.brightness  // => 0.3
color.hsba.alpha       // => 0.4 
```

只需**使用 Carthage 安装它就**可以了。

我希望它有帮助！

* * *

## 回答 #16

> 赞同：-6
> 
> 时间：2017-08-03T11:52:59.793

像这样设置你的 UIColor

```
UIColor.FromRGB(128, 179, 255) 
```

这是针对 Xamarin ios 的...但肯定有这样的方法在 swift 中。

# sql-server - 如果我无权访问所有数据库，SSMS 2008 中的对象浏览器将不起作用

> ID：437114
> 
> 赞同：3
> 
> 时间：2009-01-12T21:40:27.590
> 
> 标签：sql-server, hosting, sql-server-2008

在 SQL Server Management Studio 2008 中，如果我登录到在一台服务器上具有多个数据库的共享主机提供商，我将无法使用对象资源管理器。这在 2005 年运行良好。无论如何要改变这种行为？

它抛出这个异常：

*   服务器主体“myusername”无法在当前安全上下文下访问数据库“first-database-alphabetically-on-shared-server”。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-12T23:25:06.757

单击查看、对象资源管理器详细信息。然后，打开数据库。最后，单击标题列并取消选中排序规则。

来源：[https ://sqlblog.org/2008/07/07/a-little-management-studio-oops](https://sqlblog.org/2008/07/07/a-little-management-studio-oops)

不久前我为自己的机器解决了这个问题，不得不重新查找问题。希望这个链接和那里的链接能帮助你找到答案，如果没有的话。我必须做的事情似乎很熟悉。

# sql - 帮助 TSQL - 一种获取行的第 N 列中的值的方法？

> ID：437117
> 
> 赞同：3
> 
> 时间：2009-01-12T21:41:18.587
> 
> 标签：sql, sql-server, tsql

我希望找到一种方法来获取数据集第 N 列中的值。

因此，对于 N = 6 我想要

```
SELECT (Column6Value) from MyTable where MyTable.RowID = 14 
```

有没有办法在 SQL Server 2005 中实现的 TSQL 中执行此操作？谢谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-12T21:50:15.387

您应该能够加入系统目录 (Information_Schema.Columns) 以获取列号。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-12T21:58:51.280

不确定您是否可以自由地重新设计表格，但如果列的序数位置很重要，则您的数据未标准化，并且您将不得不为许多常见任务跳过很多圈。

而不是拥有带有 Column1... ColumnN 的表 MyTable 您将拥有以前存储在 Column1...ColumnN 中的那些值的子表，每个表都在自己的行中。

对于那些你真的需要这些值的时候，你可以做一个 PIVOT：[http://geekswithblogs.net/lorint/archive/2006/08/04/87166.aspx](http://geekswithblogs.net/lorint/archive/2006/08/04/87166.aspx)

编辑：我的建议有点没有实际意义。Ash 澄清说，这是“设计上的反规范化，它是一个枢轴模型，其中每一行都可以包含任何四种数据类型中的一种。” 是的，当你标准化时，这种设计可能会很麻烦。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-12T22:17:32.960

这有效：

```
create table test (a int, b int, c int)
insert test values(1,2,3)

declare @column_number int
set @column_number = 2

declare @query varchar(8000)

select @query = COLUMN_NAME from information_Schema.Columns
where TABLE_NAME = 'test' and ORDINAL_POSITION = @column_number

set @query = 'select ' + @query + ' from test'

exec(@query) 
```

但是为什么你会做这样的事情超出了我的理解，你想解决什么问题？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-12T21:52:05.913

如果你知道 n 的范围，你可以使用 case 语句

```
Select Case when @n = 1 then Column1Value when @n = 2 then  Column2Value end 
from MyTable 
```

据我所知，没有动态方法可以在不诉诸动态 sql 的情况下替换 select 语句中的列（或表）（无论如何，您可能应该在其中进行重构）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-12T22:22:15.417

@Mike Sharek 答案的实施。

```
Declare @columnName varchar(255),
@tablename varchar(255), @columnNumber int, @SQL nvarchar(4000)
Set @tablename = 'MyTable'
Set @columnNumber = 6

Select @columnName = Column_Name from Information_SChema.columns
where Ordinal_position = @columnNumber and Table_Name = @tablename

Set @SQL  = 'select ' + @columnName + ' from ' + @tableName + ' where RowID=14'
Exec sp_Executesql @SQL 
```

我同意三宝 - 你为什么要这样做？如果您从 C# 或 VB 调用代码，则从结果集中获取第 6 列要容易得多。

# javascript - 知道为什么 js 错误没有出现在我的 firebug 控制台中吗？

> ID：437121
> 
> 赞同：-2
> 
> 时间：2009-01-12T21:42:58.833
> 
> 标签：javascript, firefox, firebug

我不得不打开 Firefox 错误控制台，这有点烦人。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-12T22:10:23.847

重新启动似乎可以解决它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-12T21:48:23.830

打开 Firebug，在 Console 选项卡下，选中“Console”和“Script”，然后点击“Apply for *domain.com* ”。

# objective-c - 哪个更好：全局字符串还是单例？

> ID：437122
> 
> 赞同：0
> 
> 时间：2009-01-12T21:43:06.460
> 
> 标签：objective-c, iphone

对于我全新的 ORM ( [chibi-ORM](http://code.google.com/p/chibiorm/) )，我面临着一个设计决策。

我正在为关系构建 API，例如：

```
@interface SamplePerson : DbObject {
    NSString *name;
        DbObjectRelation *cities;
} 
```

现在，因为`DbObjectRelation`我有这个模型：

```
@interface DbObjectRelation : NSObject {
    NSMutableArray *childRows;
    DbObject *parent;
    BOOL isLoaded;
}

-(void) load;

-(void) addObject:(DbObject *) childRow;
-(void) removeObject:(DbObject *) childRow;

- (id)initWitParent:(DbObject *)parentObject; 
```

所以，我需要一种方法来知道哪个数据库用于加载记录。

我认为在我的数据库连接中有类似的东西：

```
static NSString *currentDbNameSingleton = nil;

+(NSString *)currentDbName {
    @synchronize( self ) {
        if ( currentDbNameSingleton == nil ) {
            currentDbNameSingleton = [[NSString alloc]
        }
    }
    return sharedInst;  
}

+(void) setCurrentDbName(NSString *)name {
    @synchronize( self ) {
      currentDbNameSingleton = [name copy];
    }
} 
```

但想知道是否更好地将 DB 类构建为单例。这是针对 iPhone 项目的...

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-12T22:16:03.337

像您目前正在做的那样在静态变量周围使用一组类访问器/突变器是非常合理的。如果您不打算更改数据库名称，另一个非常常见的解决方案是将它放在一个单独的文件中，比如 Constants.h，以及其他常量字符串，如字典和用户默认键。

如果您有与数据库相关的其他代码可以重构到一个地方，那么为您的数据库内容构建一个单例类是一个很好的点。我不会创建一个类只是为了保存一个字符串。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-13T04:49:43.993

对于不改变的字符串，您应该将它们创建为常量。

即在您的数据库连接文件中：

```
const NSString *CurrentDbName = @"name of database"; 
```

注意表达编译时生成和常量的大写。

对于字符串来说，它比单例稍微高效一些。当然，您不能对其他类型的 Objective-C 对象执行此操作，因为它们不能由编译器创建。对于这些，请使用单例。

如果程序的其他部分需要访问该字符串，则应在数据库的头文件中使用外部引用：

```
extern const NSString *CurrentDbName; 
```

# c# - 无法从 GridView 中的行/单元格获取值

> ID：437137
> 
> 赞同：2
> 
> 时间：2009-01-12T21:47:50.820
> 
> 标签：c#, asp.net, gridview

我正在尝试使用以下代码从 GridView 获取值：

```
foreach (GridViewRow row in this.dgvEstudios.Rows)
{
    var xy = row.Cells[1].Text;
} 
```

总是得到一个空字符串 ( `""`) 作为从 的返回值`.Text`，为什么会发生这种情况？我已经设置`EnableViewState`为`true`

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2011-05-20T21:37:05.993

如果每个单元格中都有控件，则需要获取如下值：

```
Label lblEmailAddress = GridView.Rows[e.CommandArgument].FindControl("lblEmailAddress");
string Email = lblEmailAddress.Text; 
```

在这种情况下，它是单元格中的控件，其值不是单元格iteslf。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-12T22:02:12.413

单元格内部可能有控件（例如 LiteralControl 或 HyperLink）。这是您应该寻找的。

`row.Cells[1].Controls` 收藏，你应该寻找。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-12T21:56:11.660

它可能取决于很多事情。与填充 GridView 时（调用 Databind()）相关的代码在哪里触发？

没有任何上下文，很难说它还能是什么。

# apache - 如何在使用 mod_proxy 的同时将用户发送到 Apache 中的不同“站点”？

> ID：437140
> 
> 赞同：1
> 
> 时间：2009-01-12T21:48:28.993
> 
> 标签：apache, tomcat, mod-proxy

我有一个我管理的网站，它在前端使用 Apache 2.0，在后端使用 Tomcat 6（使用 mod_proxy 代理两者之间的连接）。

我希望能够使用相同的 VirtualHost 来访问在盒子上运行的 phpMyAdmin 应用程序。因此，例如，www.mywebsite.com 会将所有流量传递给 Tomcat，但 www.mywebsite.com/myadmin（具有明显的安全性）会将流量传递给 phpMyAdmin。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-12T22:05:56.133

使用[`mod_rewrite`](http://httpd.apache.org/docs/2.0/mod/mod_rewrite.html)而不是 mod_proxy 怎么样？

您可以使用`P`修饰符通过代理发送某些请求（即所有不发送到/phpmyadmin* 的请求）。这实际上在内部使用了 mod_proxy。

像这样的东西（未经测试）：

```
 RewriteCond %{REQUEST_URI} !^/phpmyadmin
 RewriteRule ^.*$ http://tomcat/$0 [P,L] 
```

# security - IP 地址过滤的安全性如何？

> ID：437146
> 
> 赞同：29
> 
> 时间：2009-01-12T21:52:03.153
> 
> 标签：security, networking, firewall

我计划部署一个包含敏感数据的内部应用程序。我建议我们把它放在一台不暴露在一般互联网上的机器上，只暴露在我们的内部网络上。IT 部门拒绝了这一建议，称为一个应用程序留出一整台机器是不值得的。（该应用程序有自己的域以防万一，但我被告知他们不能阻止基于 URL 的请求。）

在应用程序中，我对其进行了编程，使其仅在请求来自内部 IP 地址时才尊重请求，否则它只会显示一个页面，上面写着“你不能看这个”。我们的内部地址都有不同的模式，所以我正在根据正则表达式检查请求 IP。

但我对这种策略感到紧张。这对我来说有点笨拙。这是相当安全的吗？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-01-12T22:02:54.097

IP过滤总比没有好，但它有两个问题：

1.  IP 地址可以被欺骗。

2.  如果内部机器被攻破（包括客户端工作站，例如通过安装木马），那么攻击者可以将其用作跳转主机或代理来攻击您的系统。

如果这确实是敏感数据，它不一定需要专用机器（尽管这是最佳实践），但您至少应该以某种方式验证您的用户，并且不要在同一台机器。

如果它真的很敏感，请让安全专家来审查你在做什么。

编辑：顺便说一句，如果可以的话，放弃正则表达式并使用 tcpwrappers 或操作系统中的防火墙功能（如果有的话）。或者，如果您的应用可以使用不同的 IP 地址，请使用防火墙阻止外部访问。（如果您没有防火墙，那么您也可以放弃并将您的数据通过电子邮件发送给攻击者:-)

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-01-12T21:58:47.273

我宁愿使用 SSL 和一些证书，或者简单的用户名/密码保护而不是 IP 过滤。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-01-12T22:20:37.277

这完全取决于您真正需要它的安全性。

我假设您的服务器是外部托管的，并且没有通过 VPN 连接。因此，您正在检查您的 HTTPS（您使用的是 HTTPS，不是吗？？）站点的请求地址是否在您自己组织的网络中。

使用正则表达式匹配 IP 地址听起来很可疑，您不能像其他人一样使用网络/网络掩码吗？

它真的需要有多安全？IP地址欺骗并不容易，被欺骗的数据包不能用于建立HTTPS连接，除非它们还操纵上游路由器，使返回的数据包能够重定向到攻击者。

如果您需要它真正安全，只需让您的 IT 部门安装 VPN 并通过私有 IP 地址空间进行路由。为这些私有地址设置 IP 地址限制。即使有人破坏了上游默认网关，通过基于主机的 VPN 进行路由的 IP 地址限制仍然是安全的。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-01-13T02:49:13.410

如果您的应用程序正在检查 IP 地址，那么它非常容易受到攻击。那时，您在路由器上没有任何保护，而这正是 IP 过滤真正需要的地方。您的应用程序可能正在检查发送 IP 地址的 HTTP 标头信息，这非常容易被欺骗。如果您将 IP 地址锁定在路由器上，那就另当别论了，它将为您提供一些真正的安全性，即谁可以从哪里访问该站点。

如果您正在做的是在内部访问应用程序，那么 SSL 不会给您带来太多好处，除非您试图保护来自组织内部各方的信息，或者您需要客户端证书。这是假设您永远不会从外部连接访问该站点（VPN 不计算在内，因为您正在通过隧道进入内部网络并且在那时技术上是其中的一部分）。它也不会受到伤害，设置起来也不难，只是不要认为它会解决你所有的问题。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2016-02-06T12:04:51.493

正如其他人所提到的，IP 白名单容易受到 IP 欺骗和中间人攻击。在 MITM 上，请考虑某些交换机或路由器已被入侵，并且会看到“回复”。它可以监视甚至更改它们。

还要考虑 SSL 加密的漏洞。根据努力，这也可以在 MITM 中被挫败，以及众所周知的重用素数等错误。

根据您数据的敏感性，我不会满足于 SSL，而是会使用 StrongSWAN 或 OpenVPN 以获得更高的安全性。如果处理得当，这些将不太容易受到 MITM 的攻击。

仅依赖白名单（即使使用 SSL）我会考虑“低等级”，但可能足以满足您的需求。只要敏锐地意识到其中的含义，不要落入“虚假安全感”的陷阱。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-01-12T22:00:04.167

如果是受IP地址限制，那么虽然他们可以欺骗IP地址，但他们将无法得到回复。当然，如果它暴露在互联网上，除了针对应用程序之外，它仍然可能受到攻击。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-01-12T22:03:14.690

仅仅因为您的所有内部 IP 都与给定的正则表达式匹配，这并不意味着与给定正则表达式匹配的所有 IP 都是内部 IP。因此，您的正则表达式是可能的安全故障点。

我不知道您使用什么技术来构建您的站点，但如果它是 Windows/ASP.net，您可以在发出请求时根据其 Windows 凭据检查请求计算机的权限。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-01-12T22:15:08.783

像所有安全性一样，它本身是无用的。如果您必须将其放在面向公众的网络服务器上，请使用 IP 白名单、*基本的*用户名/密码身份验证、*SSL*、适当*的*监控设置*以及*最新的服务器应用程序。

也就是说，让服务器可公开访问，然后将其限制为仅内部 IP 地址有什么意义？看起来它基本上是在重新发明 NAT 免费为您提供的东西，并且使用仅限内部的服务器，而且您必须担心网络服务器漏洞等。

让它在外部可访问，您似乎并没有获得任何好处，而且让它只在内部访问有很多好处。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-01-12T22:01:31.260

我对资源问题的第一个想法是询问是否无法使用虚拟机发挥一些作用？

除此之外 - 如果您检查的 IP 地址是您知道的 IP 属于应该访问应用程序的计算机或在本地 IP 范围内，那么我看不出它是如何不够安全的（我实际上正在使用项目上的类似方法 atm，尽管将站点保持“隐藏”并不是非常重要）。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2015-09-16T21:32:14.707

一个合适的防火墙可以防止 IP 欺骗，而且它不像说欺骗你的来电显示那么容易，所以 /not/ 因为欺骗危险而使用 IP 过滤的论点有点过时了。安全性最好分层应用，因此您不仅仅依赖于一种机制。这就是为什么我们有 WAF 系统、用户名+密码、第 3 层防火墙、第 7 层防火墙、加密、MFA、SIEM 和许多其他安全措施，每一个都增加了保护（成本增加）。

如果这是您正在谈论的 Web 应用程序（从您的问题中不清楚），那么解决方案相当简单，无需高级安全系统的成本。无论使用 IIS、Apache 等，您都可以将与您的应用程序的连接限制为特定的目标 URL 以及源 IP 地址 - 无需更改您的应用程序 - 在每个应用程序的基础上。防止您的应用程序基于 IP 的 Web 浏览，再加上 IP 源限制，应该可以为您提供重要的保护，防止随意浏览/攻击。如果这不是一个网络应用程序，您必须更具体，以便人们知道基于操作系统的安全性（正如其他人所提议的那样）是否是您唯一的选择。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-01-13T02:53:06.850

您的安全性取决于您最薄弱的环节。从总体上看，欺骗 IP 是小孩子的游戏。使用 SSL 并要求客户端证书。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-03-06T17:08:01.200

首先根据管理关系而不是技术来区分不同类型的 IP [vpn](http://world-secure-channel.com/why/)是有用 的，它连接节点。一旦定义了关系，就可以使用不同的技术，具体取决于安全性和服务质量等要求。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2013-07-19T12:21:33.627

也许这会有所帮助？我一直在寻找相同的答案，并从 Red Hat Linux Ent 中找到了这个 stackoverflow 以及这个想法。我会尽快尝试的。我希望它有所帮助。

```
iptables -A FORWARD -s 192.168.1.0/24 -i eth0 -j DROP 
```

其中 0/24 是您要保护的 LAN 范围。这个想法是阻止面向“互联网”（转发）的设备能够欺骗本地 IP 网络。

参考：[http ://www.centos.org/docs/4/html/rhel-sg-en-4/s1-firewall-ipt-rule.html](http://www.centos.org/docs/4/html/rhel-sg-en-4/s1-firewall-ipt-rule.html)

# c++ - 有人可以解释这个给我数组大小的模板代码吗？

> ID：437150
> 
> 赞同：65
> 
> 时间：2009-01-12T21:54:20.463
> 
> 标签：c++, arrays, templates, size

```
template<typename T, size_t n>
size_t array_size(const T (&)[n])
{
    return n;
} 
```

我没有得到的部分是这个模板函数的参数。当我将数组传递给数组时，数组会发生什么情况`n`？

* * *

## 回答 #1

> 赞同：97
> 
> 时间：2009-01-12T22:02:45.173

好吧，首先你必须明白，试图从数组中获取一个值可以给你一个指向它的第一个元素的指针：

```
int a[] = {1, 2, 3};
int *ap = a; // a pointer, size is lost
int (&ar)[3] = a; // a reference to the array, size is not lost 
```

引用使用它们的确切类型或它们的基类类型来引用对象。关键是模板通过引用获取数组。C++ 中不存在作为参数的数组（不是对它们的引用）。如果你给一个参数一个数组类型，它将是一个指针。所以当我们想知道传递数组的大小时，使用引用是必要的。大小和元素类型是自动推导出来的，通常是函数模板的情况。以下模板

```
template<typename T, size_t n>
size_t array_size(const T (&)[n]) {
    return n;
} 
```

使用我们之前定义的数组调用`a`将隐式实例化以下函数：

```
size_t array_size(const int (&)[3]) {
    return 3;
} 
```

可以这样使用：

```
size_t size_of_a = array_size(a); 
```

* * *

我前段时间做了一个变体*[编辑：原来有人在[这里](http://blogs.msdn.com/the1/archive/2004/05/07/128242.aspx)已经有了同样的想法]*，它可以在编译时确定一个值。它不是直接返回值，而是根据以下条件为模板提供返回类型`n`：

```
template<typename T, size_t n>
char (& array_size(const T (&)[n]) )[n]; 
```

您说如果数组有`n`元素，则返回类型是对具有 size`n`和 element type的数组的引用`char`。现在，您可以获得传递数组的编译时确定的大小：

```
size_t size_of_a = sizeof(array_size(a)); 
```

`char`因为具有元素的数组具有`n`sizeof `n`，所以它也会为您提供给定数组中元素的数量。在编译时，所以你可以做

```
int havingSameSize[sizeof(array_size(a))]; 
```

因为该函数实际上从未被调用过，所以不需要定义它，所以它没有主体。希望我能把这件事弄清楚一点。

* * *

## 回答 #2

> 赞同：25
> 
> 时间：2009-01-12T22:05:12.267

这样想，假设你有一堆函数：

```
// Note that you don't need to name the array, since you don't
// actually reference the parameter at all.
size_t array_size(const int (&)[1])
{
    return 1;
}

size_t array_size(const int (&)[2])
{
    return 2;
}

size_t array_size(const int (&)[3])
{
    return 3;
}
// etc... 
```

现在，当您调用它时，会调用哪个函数？

```
int a[2];
array_size(a); 
```

现在，如果您将数组大小模板化，您将得到：

```
template <int n>
size_t array_size(const int (&)[n])
{
    return n;
} 
```

编译器将尝试实例化与您调用它的任何参数相匹配的 array_size 版本。所以如果你用一个 10 个整数的数组来调用它，它会用 n=10 实例化 array_size。

接下来，只需将类型模板化，这样您就可以使用不仅仅是 int 数组来调用它：

```
template <typename T, int n>
size_t array_size(const T (&)[n])
{
    return n;
} 
```

你完成了。

**编辑**：关于`(&)`

需要括号`&`来区分 int 引用数组（非法）和对 int 数组的引用（你想要的）。由于 的优先级`[]`高于`&`，如果您有声明：

```
const int &a[1]; 
```

由于运算符优先级，您最终会得到一个对 int 的 const 引用的单元素数组。如果你想`&`先应用，你需要用括号强制它：

```
const int (&a)[1]; 
```

现在，您有一个对 int 的单元素数组的 const 引用。在函数参数列表中，不使用参数的名称不需要指定，所以可以去掉名称，但保留括号：

```
size_t array_size(const int (&)[1]) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-12T21:56:00.163

数组没有任何反应。它是一个未使用的参数，用于解析模板函数的签名。

它也不能用作模板参数，但这是一个单独的 nit。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-09-04T06:27:11.700

对于我们这些没有“constexpr”的人来说，一种将结果作为编译时 const 的奇怪方法：

```
#include <iostream>

namespace
{

    template <size_t V>
    struct helper
    {
        enum
        {
            value = V
        };
    };

    template<typename T, size_t Size>
    auto get_size(T(&)[Size]) -> helper < Size >
    {
        return helper < Size >() ;
    }

    template<typename T>
    struct get_value
    {
        enum
        {
            value = T::value
        };
    };

}

int main()
{
    std::cout << get_value<decltype(get_size("Foo bar baz"))>::value;
} 
```

# windows - 自定义 Windows 2003 服务

> ID：437151
> 
> 赞同：0
> 
> 时间：2009-01-12T21:54:22.117
> 
> 标签：windows, service

我有一个 .exe 我想在 Win2k3 服务器启动时启动。.exe 是否需要设置为自定义服务。如果是这样，设置自定义服务的过程是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-12T22:44:41.610

我假设您并不是真的在启动时（您必须为此编写驱动程序服务），而是在用户模式系统启动时。

如果您的流程不复杂，您可以将其设置为计划任务 - 将触发器设置为系统启动。如果它需要更多地与系统交互，即需要暂停、需要关闭、警告系统事件（如电源事件或关机等），那么您可能应该考虑将其转换为 Win32 服务。

如果您确实需要转换为服务，请从[此处](http://msdn.microsoft.com/en-us/library/ms685141(VS.85).aspx)开始阅读，然后继续阅读[Richter](https://rads.stackoverflow.com/amzn/click/com/0735607532)或[Miller 的](https://rads.stackoverflow.com/amzn/click/com/1861001304)书籍，直到您真正了解自己在做什么。然后编写您的服务应用程序。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-12T21:56:56.107

如果您想手动创建该服务，您可以使用[sc.exe](http://support.microsoft.com/?scid=kb%3Ben-us%3B251192&x=15&y=20)来完成这项工作。但是，该 exe 当然必须能够作为服务运行。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-16T12:06:35.260

XYNTservice 一个简单的服务，几乎可以将任何程序作为服务启动。

[http://www.codeproject.com/KB/system/xyntservice.aspx](http://www.codeproject.com/KB/system/xyntservice.aspx)

# python - IronPython 网络框架

> ID：437160
> 
> 赞同：17
> 
> 时间：2009-01-12T21:57:38.587
> 
> 标签：python, ironpython

似乎有许多优秀的 Python 网络框架。有没有人在 IronPython 中使用过这些（Pylons、Web2Py、Django）？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-12T23:01:16.443

Django之前[曾在 IronPython 上运行](http://unbracketed.org/2008/mar/16/pycon-2008-django-now-plays-dark-side/)过，但只是作为概念验证。我知道 IronPython 团队对将 Django 支持作为 Python 兼容性的衡量标准很感兴趣。

[与 ASP.NET 和 ASP.NET MVC](http://haacked.com/archive/2008/09/23/refreshing-asp.net-dynamic-language-support.aspx)一起使用 IronPython 的可能性有些相关，这可能更成熟。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-01-26T06:42:02.150

你可能想读[这个](http://groups.google.com/group/web2py/browse_thread/thread/857f9d7bc5c25822/278c5a8e209c83e5?lnk=gst&q=ironpython#278c5a8e209c83e5)

基本上 web2py 代码未经修改且开箱即用，但使用 IronPython，但

*   没有 CSV 模块（所以没有数据库 IO）
*   没有第三方数据库驱动程序（甚至没有 SQLite，所以根本没有数据库）
*   没有内置的网络服务器（除非你通过删除信号和记录来削弱它）

这是因为 IronPython 中不存在 csv、信号、日志记录和 sqlite。您可以从上面的线程中看到，正在寻找解决方法。

web2py 也在 Jython 2.5 beta 上未经修改地运行，没有任何已知的限制，除了 Jython 中的正则表达式的一个错误导致它在某些模板上阻塞（re.compile(...).finditer 进入循环）。我们也在努力寻找解决此问题的方法。

* * *

## 回答 #3

> 赞同：-3
> 
> 时间：2009-12-17T17:19:52.650

we2py 于 2009 年 2 月 5 日发布

[http://www.web2py.com](http://www.web2py.com)

*   包括与 SQLite、MySQL、
    PostgreSQL、FireBird、MSSQL、Oracle 和 Google App Engine 一起使用的数据库抽象层。

# hosting - 我可以在 www.Seasidehosting.st 上托管 SandstoneDB 应用程序吗？

> ID：437161
> 
> 赞同：1
> 
> 时间：2009-01-12T21:58:29.207
> 
> 标签：hosting, seaside, object-oriented-database

有人曾经设法让海边托管的 Web 应用程序与 SandstoneDb 合作吗？似乎他们不允许创建子目录，这对 SandstoneDb 很重要。我错了吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-24T23:53:49.013

我没有亲自在 seasidehosting.st 上尝试过 sandstoneDB，但我知道可以创建子目录。就呆在下面`FileDirectory default`。[Pier CMS](http://www.piercms.com)还使用文件结构来存储数据，并且可以在 seasidehosting.st 上完美运行。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-13T11:12:48.450

好的，我与 sandstoneDB 的发明者和 seasidehosting.st 支持人员进行了交谈。他们都非常友好和乐于助人。（他们没有相互交流，但我想我现在已经弄清楚了。

因此，事实证明您可以在 seasidehosting.st 上创建文件和目录。但不是 sandstoneDB 的做法。这是一般的解决方法：http: [//lists.squeakfoundation.org/pipermail/seaside/2006-August/008746.html](http://lists.squeakfoundation.org/pipermail/seaside/2006-August/008746.html)。

所以，我想我会修改 SandstoneDB 以这种方式创建它的文件，我希望 Ramon 将把这个改变放到他的版本中。

干杯，

尼可

*编辑*：这正在成为一项重大行动。我现在已经阅读了这个帖子，它不是我问题的解决方案。我什至不完全确定我的问题是什么。

我认为这将是一个更大的问题，我需要在服务器上访问 Smalltalk-shell 之类的东西。这基本上意味着我将不得不在服务器上将我的应用程序切换到开发模式。有点可怕。但我真的没有其他办法。我已经上传了足够的每个 20 MB 的文件。大炮的时间到了。但不是今天。在周末。

# python - 在 Django 中复制模型实例及其相关对象/用于递归复制对象的算法

> ID：437166
> 
> 赞同：44
> 
> 时间：2009-01-12T21:58:55.667
> 
> 标签：python, django, django-models, duplicates

我有`Books`,`Chapters`和的模型`Pages`。它们都是由 a 编写的`User`：

```
from django.db import models

class Book(models.Model)
    author = models.ForeignKey('auth.User')

class Chapter(models.Model)
    author = models.ForeignKey('auth.User')
    book = models.ForeignKey(Book)

class Page(models.Model)
    author = models.ForeignKey('auth.User')
    book = models.ForeignKey(Book)
    chapter = models.ForeignKey(Chapter) 
```

我想做的是复制现有的`Book`并将其更新`User`给其他人。皱纹是我还想将所有相关的模型实例复制到-`Book`一切都是如此！`Chapters``Pages`

看 a 时事情变得非常棘手`Page`-新对象不仅需要更新`Pages`其`author`字段，而且还需要指向新`Chapter`对象！

Django 支持开箱即用的方式吗？复制模型的通用算法是什么样的？

干杯，

约翰

* * *

更新：

上面给出的类只是说明我遇到的问题的一个例子！

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-01-14T00:28:16.800

这在 Django 1.3 中不再有效，因为 CollectedObjects 已被删除。请参阅[变更集 14507](http://code.djangoproject.com/changeset/14507)

[我在 Django Snippets 上发布了我的解决方案。](http://www.djangosnippets.org/snippets/1282/)它很大程度上基于[`django.db.models.query.CollectedObject`](http://code.djangoproject.com/browser/django/trunk/django/db/models/query.py#L33)用于删除对象的代码：

```
from django.db.models.query import CollectedObjects
from django.db.models.fields.related import ForeignKey

def duplicate(obj, value, field):
    """
    Duplicate all related objects of `obj` setting
    `field` to `value`. If one of the duplicate
    objects has an FK to another duplicate object
    update that as well. Return the duplicate copy
    of `obj`.  
    """
    collected_objs = CollectedObjects()
    obj._collect_sub_objects(collected_objs)
    related_models = collected_objs.keys()
    root_obj = None
    # Traverse the related models in reverse deletion order.    
    for model in reversed(related_models):
        # Find all FKs on `model` that point to a `related_model`.
        fks = []
        for f in model._meta.fields:
            if isinstance(f, ForeignKey) and f.rel.to in related_models:
                fks.append(f)
        # Replace each `sub_obj` with a duplicate.
        sub_obj = collected_objs[model]
        for pk_val, obj in sub_obj.iteritems():
            for fk in fks:
                fk_value = getattr(obj, "%s_id" % fk.name)
                # If this FK has been duplicated then point to the duplicate.
                if fk_value in collected_objs[fk.rel.to]:
                    dupe_obj = collected_objs[fk.rel.to][fk_value]
                    setattr(obj, fk.name, dupe_obj)
            # Duplicate the object and save it.
            obj.id = None
            setattr(obj, field, value)
            obj.save()
            if root_obj is None:
                root_obj = obj
    return root_obj 
```

**对于 django >= 2**应该有一些最小的变化。所以输出将是这样的：

```
def duplicate(obj, value=None, field=None, duplicate_order=None):
    """
    Duplicate all related objects of obj setting
    field to value. If one of the duplicate
    objects has an FK to another duplicate object
    update that as well. Return the duplicate copy
    of obj.
    duplicate_order is a list of models which specify how
    the duplicate objects are saved. For complex objects
    this can matter. Check to save if objects are being
    saved correctly and if not just pass in related objects
    in the order that they should be saved.
    """
    from django.db.models.deletion import Collector
    from django.db.models.fields.related import ForeignKey

    collector = Collector(using='default')
    collector.collect([obj])
    collector.sort()
    related_models = collector.data.keys()
    data_snapshot = {}
    for key in collector.data.keys():
        data_snapshot.update(
            {key: dict(zip([item.pk for item in collector.data[key]], [item for item in collector.data[key]]))})
    root_obj = None

    # Sometimes it's good enough just to save in reverse deletion order.
    if duplicate_order is None:
        duplicate_order = reversed(related_models)

    for model in duplicate_order:
        # Find all FKs on model that point to a related_model.
        fks = []
        for f in model._meta.fields:
            if isinstance(f, ForeignKey) and f.remote_field.related_model in related_models:
                fks.append(f)
        # Replace each `sub_obj` with a duplicate.
        if model not in collector.data:
            continue
        sub_objects = collector.data[model]
        for obj in sub_objects:
            for fk in fks:
                fk_value = getattr(obj, "%s_id" % fk.name)
                # If this FK has been duplicated then point to the duplicate.
                fk_rel_to = data_snapshot[fk.remote_field.related_model]
                if fk_value in fk_rel_to:
                    dupe_obj = fk_rel_to[fk_value]
                    setattr(obj, fk.name, dupe_obj)
            # Duplicate the object and save it.
            obj.id = None
            if field is not None:
                setattr(obj, field, value)
            obj.save()
            if root_obj is None:
                root_obj = obj
    return root_obj 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2010-06-25T18:20:17.107

这是复制对象的简单方法。

基本上：

(1) 将原始对象的 id 设置为 None：

book_to_copy.id = 无

(2) 更改'author'属性并保存对象：

book_to_copy.author = new_author

book_to_copy.save()

(3) 执行 INSERT 而不是 UPDATE

（它没有解决在页面中更改作者的问题——我同意关于重构模型的评论）

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-01-12T22:24:51.260

我没有在 django 中尝试过，但 python 的[deepcopy](http://docs.python.org/library/copy.html)可能只适合你

**编辑：**

如果您实现功能，您可以为模型定义自定义复制行为：

```
__copy__() and __deepcopy__() 
```

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2011-05-19T19:51:02.983

这是[http://www.djangosnippets.org/snippets/1282/的编辑](http://www.djangosnippets.org/snippets/1282/)

它现在与在 1.3 中取代 CollectedObjects 的 Collector 兼容。

我并没有真正对此进行过多的测试，但确实使用具有大约 20,000 个子对象的对象对其进行了测试，但外键深度只有大约三层。当然，使用风险自负。

对于阅读这篇文章的雄心勃勃的人，您应该考虑将 Collector 子类化（或复制整个类以消除对 django API 的此未发布部分的依赖）到一个名为“DuplicateCollector”之类的类，并编写一个有效的 .duplicate 方法类似于 .delete 方法。这将真正解决这个问题。

```
from django.db.models.deletion import Collector
from django.db.models.fields.related import ForeignKey

def duplicate(obj, value=None, field=None, duplicate_order=None):
    """
    Duplicate all related objects of obj setting
    field to value. If one of the duplicate
    objects has an FK to another duplicate object
    update that as well. Return the duplicate copy
    of obj.
    duplicate_order is a list of models which specify how
    the duplicate objects are saved. For complex objects
    this can matter. Check to save if objects are being
    saved correctly and if not just pass in related objects
    in the order that they should be saved.
    """
    collector = Collector({})
    collector.collect([obj])
    collector.sort()
    related_models = collector.data.keys()
    data_snapshot =  {}
    for key in collector.data.keys():
        data_snapshot.update({ key: dict(zip([item.pk for item in collector.data[key]], [item for item in collector.data[key]])) })
    root_obj = None

    # Sometimes it's good enough just to save in reverse deletion order.
    if duplicate_order is None:
        duplicate_order = reversed(related_models)

    for model in duplicate_order:
        # Find all FKs on model that point to a related_model.
        fks = []
        for f in model._meta.fields:
            if isinstance(f, ForeignKey) and f.rel.to in related_models:
                fks.append(f)
        # Replace each `sub_obj` with a duplicate.
        if model not in collector.data:
            continue
        sub_objects = collector.data[model]
        for obj in sub_objects:
            for fk in fks:
                fk_value = getattr(obj, "%s_id" % fk.name)
                # If this FK has been duplicated then point to the duplicate.
                fk_rel_to = data_snapshot[fk.rel.to]
                if fk_value in fk_rel_to:
                    dupe_obj = fk_rel_to[fk_value]
                    setattr(obj, fk.name, dupe_obj)
            # Duplicate the object and save it.
            obj.id = None
            if field is not None:
                setattr(obj, field, value)
            obj.save()
            if root_obj is None:
                root_obj = obj
    return root_obj 
```

编辑：删除了调试“打印”语句。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2013-05-22T19:28:37.707

在 Django 1.5 中，这对我有用：

```
thing.id = None
thing.pk = None
thing.save() 
```

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2016-01-23T03:46:12.983

使用上面的 CollectedObjects 片段不再有效，但可以通过以下修改来完成：

```
from django.contrib.admin.util import NestedObjects
from django.db import DEFAULT_DB_ALIAS 
```

和

```
collector = NestedObjects(using=DEFAULT_DB_ALIAS) 
```

而不是 CollectorObjects

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2018-10-11T13:25:09.433

我在 Django 2.2/Python 3.6 中尝试了一些答案，它们似乎没有复制一对多和多对多相关对象。此外，许多包括对数据结构的硬编码/合并预知。

我写了一种方法来以更通用的方式执行此操作，处理一对多和多对多相关对象。包括评论，如果您有建议，我希望对其进行改进：

```
def duplicate_object(self):
    """
    Duplicate a model instance, making copies of all foreign keys pointing to it.
    There are 3 steps that need to occur in order:

        1\.  Enumerate the related child objects and m2m relations, saving in lists/dicts
        2\.  Copy the parent object per django docs (doesn't copy relations)
        3a. Copy the child objects, relating to the copied parent object
        3b. Re-create the m2m relations on the copied parent object

    """
    related_objects_to_copy = []
    relations_to_set = {}
    # Iterate through all the fields in the parent object looking for related fields
    for field in self._meta.get_fields():
        if field.one_to_many:
            # One to many fields are backward relationships where many child 
            # objects are related to the parent. Enumerate them and save a list 
            # so we can copy them after duplicating our parent object.
            print(f'Found a one-to-many field: {field.name}')

            # 'field' is a ManyToOneRel which is not iterable, we need to get
            # the object attribute itself.
            related_object_manager = getattr(self, field.name)
            related_objects = list(related_object_manager.all())
            if related_objects:
                print(f' - {len(related_objects)} related objects to copy')
                related_objects_to_copy += related_objects

        elif field.many_to_one:
            # In testing, these relationships are preserved when the parent
            # object is copied, so they don't need to be copied separately.
            print(f'Found a many-to-one field: {field.name}')

        elif field.many_to_many:
            # Many to many fields are relationships where many parent objects
            # can be related to many child objects. Because of this the child
            # objects don't need to be copied when we copy the parent, we just
            # need to re-create the relationship to them on the copied parent.
            print(f'Found a many-to-many field: {field.name}')
            related_object_manager = getattr(self, field.name)
            relations = list(related_object_manager.all())
            if relations:
                print(f' - {len(relations)} relations to set')
                relations_to_set[field.name] = relations

    # Duplicate the parent object
    self.pk = None
    self.save()
    print(f'Copied parent object ({str(self)})')

    # Copy the one-to-many child objects and relate them to the copied parent
    for related_object in related_objects_to_copy:
        # Iterate through the fields in the related object to find the one that 
        # relates to the parent model.
        for related_object_field in related_object._meta.fields:
            if related_object_field.related_model == self.__class__:
                # If the related_model on this field matches the parent
                # object's class, perform the copy of the child object and set
                # this field to the parent object, creating the new
                # child -> parent relationship.
                related_object.pk = None
                setattr(related_object, related_object_field.name, self)
                related_object.save()

                text = str(related_object)
                text = (text[:40] + '..') if len(text) > 40 else text
                print(f'|- Copied child object ({text})')

    # Set the many-to-many relations on the copied parent
    for field_name, relations in relations_to_set.items():
        # Get the field by name and set the relations, creating the new
        # relationships.
        field = getattr(self, field_name)
        field.set(relations)
        text_relations = []
        for relation in relations:
            text_relations.append(str(relation))
        print(f'|- Set {len(relations)} many-to-many relations on {field_name} {text_relations}')

    return self 
```

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2010-06-22T13:28:48.780

如果您正在构建的数据库中只有几个副本，我发现您可以使用管理界面中的后退按钮，更改必要的字段并再次保存实例。这对我有用，例如，我需要制作“gimlet”和“vodka gimlet”鸡尾酒，唯一的区别是替换名称和成分。显然，这需要对数据有一点预见性，并且不如覆盖 django 的复制/深度复制强大——但它可能对某些人有用。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2012-04-24T23:06:54.700

Django 确实有一种通过管理员复制对象的内置方法 - 如此处回答： [在 Django 管理界面中，是否有方法复制项目？](https://stackoverflow.com/questions/180809/in-the-django-admin-interface-is-there-a-way-to-duplicate-an-item)

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2017-02-24T17:50:53.180

## 简单的非通用方式

提出的解决方案对我不起作用，所以我采用了简单而不聪明的方法。这仅对简单的情况有用。

对于具有以下结构的模型

```
Book
 |__ CroppedFace
 |__ Photo
      |__ AwsReco
            |__ AwsLabel
            |__ AwsFace
                  |__ AwsEmotion 
```

这行得通

```
def duplicate_book(book: Book, new_user: MyUser):
    # AwsEmotion, AwsFace, AwsLabel, AwsReco, Photo, CroppedFace, Book

    old_cropped_faces = book.croppedface_set.all()
    old_photos = book.photo_set.all()

    book.pk = None
    book.user = new_user
    book.save()

    for cf in old_cropped_faces:
        cf.pk = None
        cf.book = book
        cf.save()

    for photo in old_photos:
        photo.pk = None
        photo.book = book
        photo.save()

        if hasattr(photo, 'awsreco'):
            reco = photo.awsreco
            old_aws_labels = reco.awslabel_set.all()
            old_aws_faces = reco.awsface_set.all()
            reco.pk = None
            reco.photo = photo
            reco.save()

            for label in old_aws_labels:
                label.pk = None
                label.reco = reco
                label.save()

            for face in old_aws_faces:
                old_aws_emotions = face.awsemotion_set.all()
                face.pk = None
                face.reco = reco
                face.save()

                for emotion in old_aws_emotions:
                    emotion.pk = None
                    emotion.aws_face = face
                    emotion.save()
    return book 
```

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2019-04-11T18:39:02.657

这是一个有点简单的解决方案。这不依赖于任何未记录的 Django API。它假定您要复制单个父记录，以及它的子记录、孙记录等。您传入一个实际上应该被复制的类的白名单，其形式是`list`指向其子对象的每个父对象上的一对多关系的名称。此代码假定，给定上述白名单，整个树是自包含的，无需担心外部引用。

`author`该解决方案对上述领域没有任何特殊作用。我不确定它是否适用。就像其他人所说的那样，该`author`字段可能不应该在不同的模型类中重复。

关于这段代码的另一件事：它是真正的递归，因为它为每个新级别的后代调用自己。

```
from collections import OrderedDict

def duplicate_model_with_descendants(obj, whitelist, _new_parent_pk=None):
    kwargs = {}
    children_to_clone = OrderedDict()
    for field in obj._meta.get_fields():
        if field.name == "id":
            pass
        elif field.one_to_many:
            if field.name in whitelist:
                these_children = list(getattr(obj, field.name).all())
                if children_to_clone.has_key(field.name):
                    children_to_clone[field.name] |= these_children
                else:
                    children_to_clone[field.name] = these_children
            else:
                pass
        elif field.many_to_one:
            if _new_parent_pk:
                kwargs[field.name + '_id'] = _new_parent_pk
        elif field.concrete:
            kwargs[field.name] = getattr(obj, field.name)
        else:
            pass
    new_instance = obj.__class__(**kwargs)
    new_instance.save()
    new_instance_pk = new_instance.pk
    for ky in children_to_clone.keys():
        child_collection = getattr(new_instance, ky)
        for child in children_to_clone[ky]:
            child_collection.add(duplicate_model_with_descendants(child, whitelist=whitelist, _new_parent_pk=new_instance_pk))
    return new_instance 
```

示例用法：

```
from django.db import models

class Book(models.Model)
    author = models.ForeignKey('auth.User')

class Chapter(models.Model)
    # author = models.ForeignKey('auth.User')
    book = models.ForeignKey(Book, related_name='chapters')

class Page(models.Model)
    # author = models.ForeignKey('auth.User')
    # book = models.ForeignKey(Book)
    chapter = models.ForeignKey(Chapter, related_name='pages')

WHITELIST = ['books', 'chapters', 'pages']
original_record = models.Book.objects.get(pk=1)
duplicate_record = duplicate_model_with_descendants(original_record, WHITELIST) 
```

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2009-01-12T23:19:07.437

我认为你也会更喜欢更简单的数据模型。

一个页面在某个章节中，但在另一本书中，这真的是真的吗？

```
userMe = User( username="me" )
userYou= User( username="you" )
bookMyA = Book( userMe )
bookYourB = Book( userYou )

chapterA1 = Chapter( book= bookMyA, author=userYou ) # "me" owns the Book, "you" owns the chapter?

chapterB2 = Chapter( book= bookYourB, author=userMe ) # "you" owns the book, "me" owns the chapter?

page1 = Page( book= bookMyA, chapter= chapterB2, author=userMe ) # Book and Author aggree, chapter doesn't? 
```

看起来你的模型太复杂了。

我想你会更喜欢更简单的东西。我只是在猜测，因为我不知道你的整个问题。

```
class Book(models.Model)
    name = models.CharField(...)

class Chapter(models.Model)
    name = models.CharField(...)
    book = models.ForeignKey(Book)

class Page(models.Model)
    author = models.ForeignKey('auth.User')
    chapter = models.ForeignKey(Chapter) 
```

每个页面都有不同的作者。然后，每一章都有作者的集合，这本书也是如此。现在您可以复制书籍、章节和页面，将克隆的页面分配给新作者。

实际上，您可能希望在 Page 和 Chapter 之间建立多对多关系，允许您仅拥有 Page 的多个副本，而无需克隆书籍和 Chapter。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2018-11-15T17:38:15.163

**我对Django 2.1.2**的任何答案都没有运气，因此我创建了一种通用方法来执行数据库模型的深层副本，该模型很大程度上基于上面发布的答案。

与上述答案的主要区别在于`ForeignKey`不再具有名为 的属性`rel`，因此必须将其更改为`f.remote_field.model`etc。

此外，由于很难知道应该复制数据库模型的顺序，我创建了一个简单的排队系统，如果当前模型复制不成功，则将其推到列表的末尾。代码如下：

```
import queue
from django.contrib.admin.utils import NestedObjects
from django.db.models.fields.related import ForeignKey

def duplicate(obj, field=None, value=None, max_retries=5):
    # Use the Nested Objects collector to retrieve the related models
    collector = NestedObjects(using='default')
    collector.collect([obj])
    related_models = list(collector.data.keys())

    # Create an object to map old primary keys to new ones
    data_snapshot = {}
    model_queue = queue.Queue()
    for key in related_models:
        data_snapshot.update(
            {key: {item.pk: None for item in collector.data[key]}}
        )
        model_queue.put(key)

    # For each of the models in related models copy their instances
    root_obj = None
    attempt_count = 0
    while not model_queue.empty():
        model = model_queue.get()
        root_obj, success = copy_instances(model, related_models, collector, data_snapshot, root_obj)

        # If the copy is not a success, it probably means that not
        # all the related fields for the model has been copied yet.
        # The current model is therefore pushed to the end of the list to be copied last
        if not success:

            # If the last model is unsuccessful or the number of max retries is reached, raise an error
            if model_queue.empty() or attempt_count > max_retries:
                raise DuplicationError(model)
            model_queue.put(model)
            attempt_count += 1
    return root_obj

def copy_instances(model, related_models, collector, data_snapshot, root_obj):

# Store all foreign keys for the model in a list
fks = []
for f in model._meta.fields:
    if isinstance(f, ForeignKey) and f.remote_field.model in related_models:
        fks.append(f)

# Iterate over the instances of the model
for obj in collector.data[model]:

    # For each of the models foreign keys check if the related object has been copied
    # and if so, assign its personal key to the current objects related field
    for fk in fks:
        pk_field = f"{fk.name}_id"
        fk_value = getattr(obj, pk_field)

        # Fetch the dictionary containing the old ids
        fk_rel_to = data_snapshot[fk.remote_field.model]

        # If the value exists and is in the dictionary assign it to the object
        if fk_value is not None and fk_value in fk_rel_to:
            dupe_pk = fk_rel_to[fk_value]

            # If the desired pk is none it means that the related object has not been copied yet
            # so the function returns unsuccessful
            if dupe_pk is None:
                return root_obj, False

            setattr(obj, pk_field, dupe_pk)

    # Store the old pk and save the object without an id to create a shallow copy of the object
    old_pk = obj.id
    obj.id = None

    if field is not None:
        setattr(obj, field, value)

    obj.save()

    # Store the new id in the data snapshot object for potential use on later objects
    data_snapshot[model][old_pk] = obj.id

    if root_obj is None:
        root_obj = obj

return root_obj, True 
```

我希望它有任何帮助:)

重复错误只是一个简单的异常扩展：

```
class DuplicationError(Exception):
    """
    Is raised when a duplication operation did not succeed

    Attributes:
        model -- The database model that failed
    """

    def __init__(self, model):
        self.error_model = model

    def __str__(self):
        return f'Was not able to duplicate database objects for model {self.error_model}' 
```

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2019-12-06T08:03:30.717

有一个选项可以在 django admin 中创建一个副本/克隆/另存为新。

1.  在 admin.py 中创建要克隆的模型的 ModelAdmin 类
2.  在类中添加一个管理操作，例如：

> ```
>  @admin.register(Book)
>  class BookAdmin(models.ModelAdmin):
>      save_as = True 
> ```

这将在您的管理面板中创建一个“另存为新”按钮，以完全克隆模型对象及其所有相关字段。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2019-05-03T21:46:13.080

我尝试了 Stephen G Tuggy 的解决方案，发现它非常聪明，但不幸的是，它在某些特殊情况下不起作用。

让我们假设以下场景：

```
class FattAqp(models.Model):    
    descr = models.CharField('descrizione', max_length=200)
    ef = models.ForeignKey(Esercizio, ...)
    forn = models.ForeignKey(Fornitore, ...)

class Periodo(models.Model):
    #  id usato per identificare i documenti
    # periodo rilevato in fattura
    data_i_p = models.DateField('data inizio', blank=True)
    idfatt = models.ForeignKey(FattAqp, related_name='periodo')

class Lettura(models.Model):
    mc_i = models.DecimalField(max_digits=7, ...)
    faqp = models.ForeignKey(FattAqp, related_name='lettura')
    an_im = models.ForeignKey('cnd.AnagImm', ..)

class DettFAqp(models.Model):
    imponibile = models.DecimalField(...)
    voce = models.ForeignKey(VoceAqp, ...)
    periodo = models.ForeignKey(Periodo, related_name='dettfaqp') 
```

在这种情况下，如果我们尝试对 FattAqp 实例进行深度复制，则 ef、forn、an_im 和 voce 字段将无法正确设置；另一方面，idfatt、faqp、periodo 将。

我通过向函数添加一个参数并对代码稍作修改来解决了这个问题。我用 Python 3.6 和 Django 2.2 对其进行了测试：

```
def duplicate_model_with_descendants(obj, whitelist, _new_parent_pk=None, static_fk=None):
    kwargs = {}
    children_to_clone = OrderedDict()
    for field in obj._meta.get_fields():
        if field.name == "id":
            pass
        elif field.one_to_many:
            if field.name in whitelist:
                these_children = list(getattr(obj, field.name).all())

                if field.name in children_to_clone:
                    children_to_clone[field.name] |= these_children
                else:
                    children_to_clone[field.name] = these_children
            else:
                pass
        elif field.many_to_one:
            name_with_id = field.name + '_id'
            if _new_parent_pk:
                kwargs[name_with_id] = _new_parent_pk

            if name_with_id in static_fk:
                kwargs[name_with_id] = getattr(obj, name_with_id)

        elif field.concrete:
            kwargs[field.name] = getattr(obj, field.name)
        else:
            pass
    new_instance = obj.__class__(**kwargs)
    new_instance.save()
    new_instance_pk = new_instance.pk
    for ky in children_to_clone.keys():
        child_collection = getattr(new_instance, ky)
        for child in children_to_clone[ky]:
            child_collection.add(
                duplicate_model_with_descendants(child, whitelist=whitelist, _new_parent_pk=new_instance_pk,static_fk=static_fk)) 
```

示例用法：

```
original_record = FattAqp.objects.get(pk=4)
WHITELIST = ['lettura', 'periodo', 'dettfaqp']
STATIC_FK = ['fornitore_id','ef_id','an_im_id', 'voce_id']
duplicate_record = duplicate_model_with_descendants(original_record, WHITELIST, static_fk=STATIC_FK) 
```

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2019-08-15T19:48:01.357

根据以前的答案详细说明：

```
def derive(obj):
    import copy
    from django.contrib.admin.utils import NestedObjects
    from django.db import DEFAULT_DB_ALIAS
    from django.db.models.fields.related import ForeignKey
    """
        Derive a new model instance from previous one,
        and duplicate all related fields to point to the new instance
    """
    obj2 = copy.copy(obj)
    obj2.pk = None
    obj2.save()
    collector = NestedObjects(using=DEFAULT_DB_ALIAS)
    collector.collect([obj])
    collector.sort()
    related_models = collector.data.keys()
    data_snapshot = {}

    for key in collector.data.keys():
        data_snapshot.update({
            key: dict(
                zip(
                    [item.pk for item in collector.data[key]],
                    [item for item in collector.data[key]]
                )
            )
        })

    duplicate_order = reversed(related_models)

    for model in duplicate_order:
        # Find all FKs on model that point to a related_model.
        fks = []
        for f in model._meta.fields:
            if isinstance(f, ForeignKey) and f.rel.to in related_models:
                fks.append(f)
        # Replace each `sub_obj` with a duplicate.
        if model not in collector.data:
            continue
        sub_objects = collector.data[model]
        for obj in sub_objects:
            for fk in fks:
                dupe_obj = copy.copy(obj)
                setattr(dupe_obj, fk.name, obj2)
                dupe_obj.pk = None
                dupe_obj.save()
    return obj2 
```

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2020-01-17T08:14:27.823

Julio Marins 的建议工作！谢谢！

对于 Django >= 2.* 这一行：

`if isinstance(f, ForeignKey) and f.rel.to in related_models:`

应替换为：

`if isinstance(f, ForeignKey) and f.remote_field.model in related_models:`

# algorithm - FIFO队列同步

> ID：437168
> 
> 赞同：1
> 
> 时间：2009-01-12T21:59:15.803
> 
> 标签：algorithm, multithreading, synchronization

如果只有一个读取器和一个写入器，是否应该同步 FIFO 队列？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-12T23:40:20.127

“同步”是什么意思？如果您的阅读器和编写器位于不同的线程中，您希望 FIFO“正确”处理并发，包括以下详细信息：

*   正确使用 FIFO API 绝不会导致数据结构损坏
*   正确使用 FIFO API 不应导致死锁（尽管应该有一种机制让读者等到有东西要读）
*   从 FIFO 读取的对象应该是相同的对象，以相同的顺序写入 FIFO（不应丢失对象或重新排列顺序）
*   在作者将某些内容放入 FIFO 与读者可以使用之间应该有一个有限的时间（希望如此！）。

在 Java 世界中，有一本很好的书，[Java Concurrency In Practice](https://rads.stackoverflow.com/amzn/click/com/0321349601)。有多种方法可以实现正确处理并发的 FIFO。最简单的实现是阻塞，更复杂的实现使用基于当今大多数处理器上的比较和交换指令的非阻塞算法。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-12T22:02:15.987

是的，如果读写器与来自不同线程的 FIFO 队列交互。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-12T22:05:25.027

取决于实施，但最有可能。您不希望阅读器读取部分写入的数据。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-12T22:09:07.453

是的，除非其文档明确说明。

（如果只有一个读取器和一个写入器线程，则可以实现不需要同步的专用 FIFO，例如在 Windows 上使用 InterlockedXXX 函数。）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-12-05T20:24:46.870

尝试使用此代码来同时使用 fifo：

```
public class MyObjectQueue {

private static final ReentrantReadWriteLock lock = new ReentrantReadWriteLock();

private static final ReadLock readLock;

private static final WriteLock writeLock;

private static final LinkedList<MyObject> objects;

static {
    readLock = lock.readLock();
    writeLock = lock.writeLock();
    objects = new LinkedList<MyObject>();
}

public static boolean put(MyObject p) {
    writeLock.lock();
    try {
        objects.push(p);            
        return objects.contains(p);
    } finally {
        writeLock.unlock();
    }
}

public static boolean remove(MyObject p) {
    writeLock.lock();
    try {
        return objects.remove(p);           
    } finally {
        writeLock.unlock();
    }
}

public static boolean contains(MyObject p) {
    readLock.lock();
    try {
        return objects.contains(p);         
    } finally {
        readLock.unlock();
    }
}   

public MyObject get() {
    MyObject o = null;
    writeLock.lock();
    try {
        o = objects.getLast();
    } catch (NoSuchElementException nse) {
        //list is empty
    } finally {
        writeLock.unlock();
    }
    return o;
} 
```

}

# dns - DomainKeys Sendmail DNS

> ID：437170
> 
> 赞同：2
> 
> 时间：2009-01-12T21:59:55.007
> 
> 标签：dns, sendmail, domainkeys

我必须采取哪些步骤来配置我的 sendmail 服务器以正确实施域密钥？

另外我必须在 DNS 端做什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-13T02:47:36.067

网上有详细的说明。例如：

*   [http://www.elandsys.com/resources/sendmail/domainkeys.html](http://www.elandsys.com/resources/sendmail/domainkeys.html)
*   [http://www.erikberg.com/notes/milters.html](http://www.erikberg.com/notes/milters.html)
*   [http://www.technoids.org/dk-milter.html/](http://www.technoids.org/dk-milter.html/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-20T02:39:24.960

我在 dkfilter 上取得了成功。在 dns 端，您需要设置 3 个 TXT 条目：

```
(blank).domain.com                   value="YOUR-SPF-CODE-HERE" 
                                     (get your spf code at openspf.org)
_sldomain.domain.com                 value="o=~"
yourselector._sldomain.domain.com    value="YOUR-PUBLIC-DOMAIN-KEY" 
```

生成您的公共域密钥，如本教程所示：http: [//www.howtoforge.com/postfix_dkfilter_domain_keys_implementation](http://www.howtoforge.com/postfix_dkfilter_domain_keys_implementation)

在此处下载 dkfilter：http: [//jason.long.name/dkfilter/](http://jason.long.name/dkfilter/)

# c# - 从查询结果中读取单个值

> ID：437180
> 
> 赞同：0
> 
> 时间：2009-01-12T22:02:54.270
> 
> 标签：c#, asp.net

我正在尝试将在查询中找到的结果返回到 ASP.net 表。我怎么做？我已经有了查询，只是无法取回计数结果。

```
string configMan.ConnString["connect"].ToString();
iDB2Conn temp = new iDB2Conn
string query = "select Count(*) as total from test";
... 
```

这是我遇到麻烦的地方。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-01-12T22:13:06.073

这是 SqlCommand 对象派上用场的地方。

```
int result = 0;
using(SqlConnection conn = new SqlConnection(connectionString))
{
    conn.Open();
    SqlCommand sql = new SqlCommand("SELECT COUNT(*) FROM test", conn);
    result = (int)sql.ExecuteScalar();
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-12T22:11:43.580

在 ADO.Net 中，最简单的方法是在返回单个结果的命令上使用 ExecuteScalar() 方法。您没有明确列出您正在使用的数据库或连接方法，但我希望大多数数据库访问方法都具有与 ExecuteScalar() 等效的东西。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-12T22:11:55.250

尝试在您的命令上使用 ExecuteScalar 方法。您应该能够使用通用的或将结果转换为 int/long。

# agile - 结对编程时如何应对缓慢的反馈？

> ID：437190
> 
> 赞同：2
> 
> 时间：2009-01-12T22:06:01.283
> 
> 标签：agile, extreme-programming, pair-programming

我在一个极限编程团队工作，每天结对编程。最近，我越来越经常做一些反馈缓慢的事情，大约 3 分钟。例如：改变一些东西，重新编译，运行，看看性能是否有所提高。我认为它削弱了结对编程的质量，而且我认为它对结对编程的影响比对单独程序员的影响更大。如果我一个人，我可以做其他事情，但是如果我是结对编程呢？你会怎么处理？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-12T22:40:30.683

如果你可以一个人做其他事情，为什么不结对呢？也许更简单的行动项目可以在等待时从问题列表中删除？3 分钟的等待对我来说太长了，无法让大脑保持“流动模式”。所以无论如何都会被打乱（和你的伴侣一样），你不能和你的伴侣做点别的吗？

但是，在您的情况下，我不会在任何更改后暂停 3 分钟的环境中工作。所以问题是：您不能在较小的环境中开发和调试该代码，将其烤到完美，然后将这些部分重新集成到主流中吗？

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-12T22:10:16.063

您的里程可能会有所不同，但我认为对任何不是主要功能的东西进行结对编程是浪费至少一个程序员的时间

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-21T14:13:04.193

结对编程应仅应用于开发的**研究/POC/创新**部分。简单的任务应该委托给单个程序员。

当您必须等待您的伴侣完成琐碎但耗时的任务时，这不仅是浪费时间的问题。还有一个人为因素 -**你**在等待时会感到无聊。请记住，高效的开发人员需要**不断地被激励**——等待你的合作伙伴完成会降低你的士气。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-17T23:24:41.647

性能工作，你必须运行几分钟来收集统计数据，是不适合 XP 的东西。有充分的理由让两人开始勾勒出一些想法，然后单独进行以避免每三分钟的表演浪费两个人的时间，然后在签到之前再次联合起来审查工作。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-12T22:13:16.057

您可能应该考虑重构该过程。三分钟获得反馈对于配对和单独编码来说都太多了。不得不不断地换档会扼杀你的生产力。您可能只是在配对时感觉更多。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-17T23:04:23.143

**达到峰值的时间**必须内置，而不是添加。团队应该有一套可以在类似生产环境中频繁（每天）运行的自动化测试。此外，团队应该持续运行分析器。如果你都没有，那么现在就停止生产线并完成它吧！！！

如果团队发现自己处于性能问题的境地，则需要识别技术债务并创建一组故事卡来解决债务问题。它将包括一组自动化性能测试、一组分析器测试。每天对测试结果进行分析是必须的。如果出现性能问题，则可以调用架构或设计尖峰。

如果一个团队从一开始就没有持续进行性能测试，那么您可能需要解决大量的技术债务。应用程序运行后，您需要每天继续运行自动化测试，以便了解是否以及何时出现问题。然后，您最好识别对应用程序的违规更改。

通过运行自动化性能测试，您可以让测试运行一段时间，通常是几个小时。结果可以稍后进行分析，它使开发人员可以在其他故事卡上进行工作，而无需等待大量个人性能测试的结果。

等待是一个障碍。通过自动化测试消除等待。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-17T23:22:22.540

结对编程与否无关紧要。即使您一个人编码，3 分钟也无法获得有关代码更改的反馈。我会分析和分解项目，以便我可以专注于较小的部分。从这个意义上说，XP 实际上是在帮助（迫使）您在为时已晚之前改进设计。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-17T23:29:35.143

我会分头完成这些任务。你们俩分别处理代码，并在进行改进后每隔一段时间（30 分钟左右？）重新组合。

# asp.net - ASP.NET 是否内置了对皮肤徽标的支持？

> ID：437193
> 
> 赞同：1
> 
> 时间：2009-01-12T22:06:53.513
> 
> 标签：asp.net, themes, logos

我仅使用徽标作为示例。

我第一次尝试在 ASP.NET 中使用主题/皮肤 - 只是想弄清楚它们将允许我做什么。

据我所知，主题主要用于更改按钮等控件，可以使用图像进行修改。但是有没有办法可以使用主题为“徽标”或其他图形皮肤？阅读文档我无法立即看到这样做的方法。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-12T22:34:13.923

您可以使用主题/皮肤轻松设置图像/徽标。例如，如果您有这样的图像控件：

```
<asp:Image id="imgLogo" runat="server" SkinId="logo" ... /> 
```

在您的皮肤文件中，您可以指定要显示的图像，例如在 App_Themes/theme1/logo.skin 中：

```
<asp:Image runat="server" SkinId="logo" ImageUrl="~/images/logo1.png" /> 
```

在 App_Themes/theme2/logo.skin 中：

```
<asp:Image runat="server" SkinId="logo" ImageUrl="~/images/logo2.png" /> 
```

这不限于 ImageUrl 属性。您可以从皮肤文件中设置控件的大部分属性。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-12T23:14:29.367

我最近使用 ASP.net 主题创建了一个具有不同徽标和其他图像的动态品牌站点，具体取决于将用户发送到该站点的附属公司。这听起来像你想要的。为此，我做了以下工作：

1.  创建了几个主题，包括 css 和图像（没有使用皮肤文件）。您可以在 css 中使用相对引用来显示存储在主题文件夹中的背景图像。
2.  创建了我自己的页面类，它覆盖了 OnPreInit 事件并将 Page.Theme 设置为我确定应该使用的任何主题。这对我来说是基于 cookie 的，但可以基于您想要识别用户的任何方式。
3.  确保所有页面都继承自新页面类。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-12T22:29:16.993

使用主题，您可以轻松地将 Image ASP.NET 控件的源设置为每个主题不同。（如果它们不同，还有尺寸）。

主题概述：http: [//msdn.microsoft.com/en-us/library/ykzx33wh.aspx](http://msdn.microsoft.com/en-us/library/ykzx33wh.aspx)

# sql - 如何在 CASE WHEN 语句中获取 HSQLDB 中超过 1000 个项目？

> ID：437207
> 
> 赞同：1
> 
> 时间：2009-01-12T22:11:14.377
> 
> 标签：sql, hsqldb, stack-overflow

我在 Hypersonic DB (HSQLDB) 中运行以下查询：

```
SELECT (CASE foo WHEN 'a' THEN 'bar' WHEN 'b' THEN 'biz' ....
        ELSE 'fin' END ) FROM MyTable LIMIT 1 
```

当“WHEN”子句的数量超过大约 1000 条时，我会`StackOverflowError`在`org.hsqldb.jdbc.Util.sqlException()`.

这是真正奇怪的部分：我尝试`CASE`用例如 100 个 WHEN 子句后跟`ELSE ( CASE foo WHEN ... ) END`. 但是即使进行了这种重写，我也会得到*完全相同*的行为！

我在 HSQLDB 手册中没有看到任何对 1000 限制或任何其他内容的引用。帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-12T22:27:23.267

`CASE`你永远不应该在声明中接近 1000 个术语。在此之前很久，您应该将其他值放入单独的表中并通过加入来选择它们。

```
INSERT INTO MappingTable (foo, string) VALUES
  ('a', 'bar'), ('b', 'biz'), ...

SELECT COALESCE(m.string, 'fin')
FROM MyTable t LEFT OUTER JOIN MappingTable m USING (foo)
LIMIT 1; 
```

* * *

Java API 说 StackOverflowError：

> 当由于应用程序递归太深而发生堆栈溢出时引发。

所以我猜想，当 HSQLDB 解析一个`CASE`表达式时，每个`WHEN`术语都会向运行时堆栈添加另一层（实际上每个可能有几层`WHEN`）。

如果您有一个包含 1,000 级嵌套括号的算术表达式，您可能会得到类似的 StackOverflowError。

1,000 的限制可能是可变的，具体取决于 Java VM 的实现、Java 版本、您运行的平台、可用内存量等。他们可能不会在 HSQLDB 文档中记录它，因为它是特定于平台的限制，而不是内置在 HSQLDB 中的东西。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-12T22:28:01.287

完全消除 CASE 语句。

使用这 1000 个值创建一个表，然后对该表进行内部连接。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-12T23:26:19.653

正如比尔所说，鉴于明显的 HSQL 解析器设计，不可能*消除限制。*

在减轻限制方面（即让自己达到 1000 个开关，只需将限制推到……超过 1000 个），您有两个选择。

1.  运行应用程序时增加 VM 中的堆栈大小。如果您使用的是 Sun 的 Hotspot VM，您应该能够传递例如 -XX:ThreadStackSize=1024 以使用每个线程 1MB 的堆栈，而不是默认的 512K。这可能会让您获得更大的递归深度。
2.  您可以在构造函数 Thread(ThreadGroup, Runnable, String, long) 创建的 Thread 中运行您的工作，其中最后一个参数是请求的堆栈大小。这可能有效，也可能无效；如果您阅读 Javadoc，这是一个建议——非常欢迎 VM 忽略此请求。不确定 Hotspot 的具体用途，但它可能会有所帮助。

# sql - 对于所有外键，如何在 SQL 中将数据类型从 32 位整数升级到 64 位整数？

> ID：437211
> 
> 赞同：1
> 
> 时间：2009-01-12T22:12:10.460
> 
> 标签：sql

对于基本上每个 SQL 数据库，您将如何升级您的数据类型并升级链接到该数据类型的所有外键？

例如，假设我的 ScientificResult 是一个 32 位整数。现在我希望 ScientifcResult 是一个 64 位整数。ScientificResult 也是一些其他表的外键，但它们被声明为 32 位整数。

有没有通用的方法来做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-12T22:17:21.977

`INFORMATION_SCHEMA.COLUMNS`使用各种约束表生成脚本。

1.  删除所有外键
2.  升级所有表 ( `ALTER TABLE ALTER COLUMN`)
3.  重新创建所有外键

如果表很大，第 2 步和第 3 步可能需要很长时间。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-12T22:13:51.687

我会说通用方法是删除所有键，更改列数据类型，然后重新创建所有键。

# windows - 您如何在 Windows 中注册最近使用列表以准备 Windows 7？

> ID：437212
> 
> 赞同：17
> 
> 时间：2009-01-12T22:12:53.547
> 
> 标签：windows, windows-7, registry, jump-list, mru

随着即将发布的 Windows 7，新推出的功能之一是跳转列表，它们会自动填充最近使用的项目。据推测，如果您一直在“正确”地使用 Windows 注册表记录这些最近使用的项目，它们会自动出现。

那么，他们实际上需要在注册表中的哪个位置进行注册？有没有标准的地方？

我已经做了一些更多的研究，但我仍然找不到任何关于这个的东西。似乎是一个漂亮的功能，如果它真的可用的话......

**更新：**下面发布的[代码项目](http://www.codeproject.com/KB/cs/mru.aspx)有一些有趣的地方；查看代码，它计划将条目写入

```
HKEY_CURRENT_USER\Software\MyCompany\MyProgram\MRU Registry entry 
```

在注册表中。但是，这实际上并没有使用 windows 进行注册。路径恰好*存储*在注册表中，而不是存储在 MRU 列表的任何特定位置。

**更新 2：**看起来可能有一些关于如何在 Windows 7中使用[akaDruid 帖子中提供的链接的](http://channel9.msdn.com/posts/yochay/Jump-into-the-Windows-7-Taskbar-Jump-Lists/)好信息。在演讲中，他们讨论了通过 COM 接口配置跳转列表。我现在要看一下视频，看看它是否也适用于 Windows 7 之前的应用程序。（当然，如果有人知道更好，我很想听听......）

**更新 3：找到了！！！**

下面的视频将我引向一个命令 - SHAddToRecentDocs。跳转列表会自动填充您的应用添加到该列表的文档。该视频还介绍了其他一些内容，但 AddToRecentDocuments 是关键。因此，只要您调用了该函数，您的“最近使用”列表就可以以任何您想要的方式存储/填充。

更新 4：进一步观看视频，看起来只要您的应用程序已将自己注册为文件类型的正确处理程序，shell 就会通过为您调用 SHAddToRecentDocs 来为您填充自动跳转列表。太棒了……我的微软做了一件*优雅*而*相对简单的事情！*:)

更新 5：

最近在 Windows 7 for Developers 博客上发现了一篇详细介绍该过程的文章。

[http://blogs.msdn.com/yochay/archive/2009/01/06/windows-7-taskbar-part-1-the-basics.aspx](http://blogs.msdn.com/yochay/archive/2009/01/06/windows-7-taskbar-part-1-the-basics.aspx)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-06-10T11:34:58.073

您正在寻找的 API 是[SHAddToRecentDocs](http://msdn.microsoft.com/en-us/library/windows/desktop/bb762105%28v=vs.85%29.aspx)方法。

# php - 有没有办法在运行 IIS 的同一台服务器上同时运行 PHP 和 ASP？

> ID：437217
> 
> 赞同：0
> 
> 时间：2009-01-12T22:14:17.007
> 
> 标签：php, iis

非常直接的问题，我需要知道它是否可能，也许从哪里开始阅读。我是一名在 Windows 服务器方面经验为零的程序员，一个客户询问我们是否可以在他们的 Windows 盒子中交付（不，他们不会让我们在其中使用任何类型的虚拟化）。

谢谢大家，我知道它不是 100% 与编程相关的，但是......希望你能提供帮助 =)

编辑：哇，快速回复！多谢你们！！！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-12T22:15:17.473

是的，这很容易。只需从 PHP 网站运行 ISAPI 安装程序。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-12T22:16:17.080

是的你可以。我不认为设置有什么不同。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-12T22:27:38.243

在过去的几年里，我在运行 Windows 2003/IIS 的生产服务器上进行了这种设置 - ISAPI PHP。网站上的大部分代码都是 PHP，还有一点 ASP。从来没有一个问题。

Windows 上的 PHP 非常稳定。我个人喜欢它，因为我可以轻松使用我最喜欢的数据库 - SQLServer - 所谓的 WISP 堆栈。

免责声明是，这不是一个使用频率特别高的服务器——从在同一个盒子上安装 SQLServer 可以看出——但它面向一个公开可用的服务部门网站和一个用于同一组织的重要 Web 应用程序，因此确实看到了重要的现实——世界使用。

# diff - 使用 diff 的输出创建补丁

> ID：437219
> 
> 赞同：44
> 
> 时间：2009-01-12T22:14:36.477
> 
> 标签：diff, patch

我有这样的东西

```
src/sim/simulate.cc
41d40
< #include "mem/mem-interface.h"
90,91d88
<             dram_print_stats_common(curTick/500);
<
src/mem/physical.hh
52d51
<   public:
55,56d53
<       public:
<
58a56,57
>       public:
>
61,62c60,61
<         virtual bool recvTiming(PacketPtr pkt); //baoyg
<
--- 
```

我相信这是使用源树中的 diff 命令创建的。我想要的是使用该输出创建补丁，并将相同的更改应用于我的源代码树。

* * *

## 回答 #1

> 赞同：77
> 
> 时间：2009-01-12T22:21:14.327

我相信这`diff -u oldfile newfile > a.patch`是用来创建补丁文件的，尽管也可能会加入其他一些开关（-N？）。

编辑：好的，4年后，终于要解释开关的含义了：

`-u`创建[统一](http://www.gnu.org/software/diffutils/manual/html_node/Unified-Format.html)差异。统一差异是补丁程序期望作为输入获得的差异类型。您还可以在`u`(min 3, default 3) 之后指定一个数字以增加输出的行数。这是为了以防 3 行不够独特，无法仅确定程序中的一个位置。

`-N`将缺少的文件视为空文件，这意味着如果其中一个文件为空（或参见下一点），它将产生大量附加内容。

此外，`newfile`and`oldfile`都可以是目录而不是单个文件。您可能希望此`-r`参数递归任何子目录。

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2009-01-12T22:41:54.190

如果你想获得与 SVN 或 git diff 相同的补丁输出，给定两个不同的文件或文件夹：

```
diff -Naur file1.cpp file2.cpp 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-12T22:22:18.910

你所拥有的是一个非统一的差异。patch 可以读取它，但无法进行上下文匹配并且更容易出错。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-12T22:37:23.310

那*是*一个（部分）补丁文件，尽管如果他们为您提供统一的差异输出会更好。

该补丁的主要问题是它没有提及正在修改哪些文件，并且由于没有提供上下文，因此文件必须是*准确的*，补丁将无法允许对文件进行细微更改。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-10-03T20:53:12.190

`test.patch`将原始帖子中的差异复制到名为然后运行的补丁文件中

```
patch <original file> test.patch 
```

@Sparr 和 @Arafangion 指出，如果您拥有用于创建原始差异的确切原始文件，则此方法效果最佳。

# sql-server - SQL Server 索引依赖

> ID：437225
> 
> 赞同：4
> 
> 时间：2009-01-12T22:16:27.550
> 
> 标签：sql-server, indexing

我正在考虑从 SQL Server 2005 实例中的表中删除索引。有没有办法可以查看哪些存储过程可能具有依赖于该索引的语句？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-14T17:26:43.420

首先检查是否正在使用索引，您可以使用 sys.dm_db_index_usage_stats DMV，检查 user_scans 和 user_seeks 列

阅读此内容[使用 sys.dm db index usage stats dmv 检查是否正在使用索引](http://wiki.lessthandot.com/index.php/Use_the_sys.dm_db_index_usage_stats_dmv_to_check_if_indexes_are_being_used)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-12T22:25:22.103

没有。一方面，索引选择是动态的——在查询执行之前不会选择索引。

除非“提示”，但我们不要去那里。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-01-12T22:37:03.717

正如 le dorfier 所说，这取决于 SQL 在运行时确定的执行计划。我建议设置 perfmon 来跟踪表扫描，或者在删除要索引的列名称的索引过滤后保持 sql profiler 运行。寻找长时间运行的查询。

# c# - 为什么.exe 拒绝停止？

> ID：437232
> 
> 赞同：5
> 
> 时间：2009-01-12T22:18:02.570
> 
> 标签：c#, multithreading, process, terminate

我已经“继承”了一个我必须调试的遗留 C#/C++ 程序。当前的问题是我关闭程序后.exe 不会停止，即它仍然显示在任务管理器中。

这是一个问题，因为它不会让我重新启动程序，因为只能运行一个实例。通常杀死进程是行不通的；我被迫重新启动。

我的印象是当主程序停止时，所有子线程也应该停止，但我可能错了。

问：什么会导致 .exe 无法停止？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-01-12T22:20:22.237

子线程不会自动停止，除非它们被专门设置为后台线程（即，使用`thread.IsBackground = true`）。

编辑：当表单关闭时主线程也可能没有终止（即，还有其他代码设置为在关闭后运行但未完成）。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-01-13T00:18:20.173

我发现使用调试器附加到正在运行的进程并按下暂停按钮很有用。之后，我将检查“线程”窗口并查看堆栈跟踪为每个正在执行的线程所做的事情。默认情况下隐藏线程窗口。以下是有关如何显示和使用它的更多信息：

[http://msdn.microsoft.com/en-us/library/w15yf86f.aspx](http://msdn.microsoft.com/en-us/library/w15yf86f.aspx)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-12T22:21:26.947

我的猜测是所有线程都没有停止。通常你可以结束程序的任务，但它会停止。也许一个线程挂在了更难释放的系统资源上。

如果您可以获得调试版本，请运行程序并在程序“退出”后，点击调试窗口中的暂停按钮。此时，您可以查看线程并找出挂起的线程。为了提供帮助，您应该在创建线程时为其命名（这是 .Start 函数中的一个额外参数）

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-12T23:10:04.290

您可能想查看[process explorer](http://technet.microsoft.com/en-us/sysinternals/bb896653.aspx)。它使关闭程序变得更容易，它可以查看程序的线程，并可能为您指明程序运行的正确方向。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-13T00:48:20.190

启动形式是关闭以退出应用程序的形式吗？如果不是，您需要将 Application.Exit() 或 Environment.Exit() 放在最后关闭的表单的 form.closed 事件中。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-12T22:46:35.960

在最基本的层面上，某处存在无限循环。

# c - C 的测试框架

> ID：437233
> 
> 赞同：4
> 
> 时间：2009-01-12T22:18:17.327
> 
> 标签：c, unit-testing, tdd, rspec

去年夏天用 Ruby、Rails 和 RSpec 做了一些工作后，我学会了[TATFT](http://smartic.us/2008/8/15/tatft-i-feel-a-revolution-coming-on)。现在，如果不先编写测试，我就无法编写代码。

我明年要上C的编程课程，我想学习编写C测试驱动。用 C 做 TDD 是个好主意（甚至可能）吗？如果是这样，是否有任何与 C 兼容的良好测试框架？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-14T14:36:48.880

> 用 C 做 TDD 是个好主意（甚至可能）吗？

是的，与其他语言一样，这显然是一个好主意。然而，由于语言的程序性质，它带来了更多的困难。

*   静态函数很快就会成为障碍。这可以通过包含被测源文件或定义一个静态宏来解决，该宏仅在编译生产代码时表示静态 - 而不是单元测试

    ```
    #if defined(UNIT_TEST)
    #define STATIC
    #else
    #define STATIC static
    #endif 
    ```

*   没有孤立：只有一个全局上下文。使用 OO 语言，您可以只实例化一个对象（或一组协作对象）来测试它（它们），您也可以使用模拟对象。但是，使用 C，您可以通过在单元测试中重新定义函数来覆盖函数。这在链接器调用他找到的第一个函数的类 Unix 系统上运行良好 - 我不确定在 Windows 上。

* * *

> 如果是这样，是否有任何与 C 兼容的良好测试框架？

你可以从[minunit](http://www.jera.com/techinfo/jtns/jtn002.html)开始。学习曲线是平坦的，因为它只有四个宏长。

编辑：有两个**C 语言的 UT 框架列表，**在其他答案中提到，我没有重复：[一个在 Wikepedia 上](http://en.wikipedia.org/wiki/List_of_unit_testing_frameworks#C)，[另一个在 xprogramming.com 上](http://www.xprogramming.com/software.htm)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-12T22:29:10.113

[我们使用来自http://check.sourceforge.net/](http://check.sourceforge.net/)的“检查” ，它为测试套件和测试提供基本功能（类似于 junit），但相当轻量级。我喜欢的功能是，如果您的测试转储代码并认为它​​失败，它会处理。

另请注意，“检查”是基于“C”的框架，而不是“C++”框架。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-13T16:04:02.403

我刚刚发现了[CSpec](http://wiki.github.com/arnaudbrejeon/cspec)，它在 C 中做[BDD](http://behaviour-driven.org/)。看起来不是很成熟，但它让我想起了 RSpec。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-12T22:25:24.380

有许多用于 C 的单元测试工具。 Wikipedia 的列表比我[在此处](http://en.wikipedia.org/wiki/List_of_unit_testing_frameworks#C)组装的要好得多。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-12T22:50:47.497

如果您实际上使用的是 C++ 编译器，但通过编译 .c 文件在“C”模式下使用它，那么任何 C++ 单元测试框架都可以正常工作。

[在http://www.xprogramming.com/software.htm 查看](http://www.xprogramming.com/software.htm)xUnit 框架的原始列表

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-16T05:45:24.613

这个类似的问题也有很多答案[“单元测试C代码”](https://stackoverflow.com/questions/65820/unit-testing-c-code)

我用过[RCUNIT](http://rcunit.sourceforge.net/)，它很成熟，有我需要的一切。我还使用了 ipl canata，它很棒，但非常昂贵，所以这可能不是你想要的。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-12T21:58:40.743

你当然可以用 C 语言进行单元测试（我愿意）。我使用的框架（用于 Windows 平台）是[CunitWin32](http://code.google.com/p/cunitwin32/)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2011-08-09T03:03:02.473

以下是 c 的单元测试框架列表： [http ://en.wikipedia.org/wiki/List_of_unit_testing_frameworks#C](http://en.wikipedia.org/wiki/List_of_unit_testing_frameworks#C)

好好享受！

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2009-01-13T00:37:20.463

所以一个合适的 C 程序员会告诉你，因为 C 是静态类型的，所以它会捕获你可能遇到的所有错误，因此你不需要单元测试框架。

它们充满了狗屎，但这就是像 C 这样的静态类型语言的论点。

我认为您可能应该采用 Adob​​e 对 Photoshop 所做的方法。用 C 编写一系列核心库，然后应用程序的所有粘合和真实逻辑都应该使用更高级别的语言。Photoshop 主要是用 Lua 编写的，但许多语言都适用于此。

# django - 从现有标签列表中选择标签的最佳 UI 是什么？

> ID：437239
> 
> 赞同：0
> 
> 时间：2009-01-12T22:20:45.217
> 
> 标签：django, django-tagging

我正在使用 django 标记。我的模型只包含一个带有逗号分隔标签列表的字段。我希望用户能够从现有标签列表中选择标签，并允许用户添加标签。仍然产生逗号分隔的标签列表。我该怎么做？

下拉列表不起作用。我正在考虑简单地列出标签字段下的所有标签，当用户单击现有标签时，它会通过一些 javascript 添加到标签字段中。

非常欢迎其他想法。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-13T00:53:57.683

如果您可以使用 jquery，则有几个插件可以处理此问题并为您节省 JS 编码：

[Tag Suggest](http://plugins.jquery.com/project/tag-suggest)可以处理逗号分隔的标签列表和[Autocomplete](http://plugins.jquery.com/project/autocompletex)，它还具有被 Jannis Leidel[用于 ForeignKey 模型字段的优秀自动完成表单小部件的优势](http://jannisleidel.com/2008/11/autocomplete-form-widget-foreignkey-model-fields/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-12T23:54:38.770

拥有一个单独的完整列表是一个好的开始。我还建议在用户在框中键入标签名称时自动完成实现。这有助于消除将蝙蝠侠、蝙蝠侠和蝙蝠侠作为三个独立标签的问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-12T23:57:01.417

如何像 Stack Overflow 对首页上被忽略和有趣的标签一样实现它？等待用户开始输入，然后向服务器发出 AJAX 请求并开始返回五个最可能的结果，然后您可以将其显示在文本框下方的悬停白色框中。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-12T22:29:15.743

我认为您显示所有标签并允许用户单独选择它们的建议是一种合理的方法。 [Delicious.com](http://www.delicious.com)使用这个精确的界面，而且效果非常好。

# version-control - 版本控制的版本控制？

> ID：437247
> 
> 赞同：13
> 
> 时间：2009-01-12T22:23:05.040
> 
> 标签：version-control

我在公司的最后一个版本中监督分支和合并，并且多次不得不修改我们的 Subversion 预提交挂钩以对签入注释等执行不同的要求。每次编辑这些文件时我都有些紧张，因为（a）它们是现场制作系统的一部分，尽管只在内部使用（而且我们不是一个庞大的组织），并且（b）它们不是在版本控制下。

我很好奇人们在他们的版本控制基础设施上采用了什么样的故障保护措施。每日备份？“元”版本控制？我想前者作为整个存储库备份的一部分在这里就位。随着签入要求的复杂性增加，后者将很有用......

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-12T23:39:29.473

Natch - 版本控制和任何其他基础设施代码也在版本控制之下，但我会使用与任何开发项目不同的项目。

我更喜欢可搜索的 wiki 或类似*的知识库*存储库，而不是用诸如 VCS 配置之类的东西堵塞你的错误跟踪系统。

最重要的是，确保文档保持最新——根据我的经验，人们在保持代码文档最新方面比管理员文档要好得多。这可能是个人所关心的。经常被忽视的一件事是，如果系统是根据*标准 Unix 实践*或类似理念配置的，这意味着 OS/X 或 Windows 程序员可能不熟悉的位置知识体系，面临突然修复损坏的脚本. 不要居高临下，确保记录有关位置和相互依赖性的基本假设。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-12T22:30:08.347

您应该记录所有工具的所有“设置”配置，并且这些文档应该检查到版本控制中。对于具有允许注释的文本文件配置的工具，您只需签入配置文件即可。但是对于需要使用该界面的工具，您应该有一个完整的文档，其中包含显示选择的对话框的图像。

最重要的是，这些文档应该说明为什么您设置了选择的值（当不采用默认值时）。

其次，作为备份，相同的文档应该包含在您的错误跟踪软件中的“如何设置版本控制软件？”下。漏洞。（错误跟踪数据库位于不同的物理服务器上，对吗？）

第三，所有这些都应该在异地备份。我敢肯定关于备份策略的问题。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-01-12T22:31:25.053

对提交挂钩和其他配置文件使用相同的版本控制存储库有什么问题？这就是我过去负责项目配置管理时的处理方式。

您还应该备份您的 svn 存储库。这样，如果存储库本身损坏或服务器起火或其他原因，您可以恢复您的项目和 svn 控制文件。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-12T22:26:15.830

如果您有执行此操作的构建脚本（例如 Nant），那么您可以检查这些脚本。

# c++ - C++ 中的友元作用域

> ID：437250
> 
> 赞同：19
> 
> 时间：2009-01-12T22:24:11.323
> 
> 标签：c++, friend

如果我有三个班级，A、B、C。A 和 B 是朋友（双向）。此外，B 和 C 是朋友（双向）。A有一个指向B的指针，B有一个指向C的指针。为什么A不能通过指针访问C的私有数据？

澄清一下：这是一个纯理论 C++ 语言问题，而不是设计建议问题。

* * *

## 回答 #1

> 赞同：134
> 
> 时间：2009-01-12T23:45:21.270

### C++ 中的友谊不是传递的：

约翰是我的一个朋友，他可以随时使用我的无线连接（我相信他）。
约翰的朋友蒂姆虽然是个废物，虽然约翰是我的朋友，但我不把蒂姆列为朋友，因此我不让他使用我的无线连接。

### 友谊不是遗传的

约翰的孩子也是一群流氓，所以我不相信他们，他们绝对不是我的朋友，也不是我自己的孩子，我尽可能地信任他们。

虽然我们的孩子不能直接访问无线网络，但如果他们通过我们，他们可以访问无线网络。因此，如果约翰的孩子通过约翰访问我的无线设备（即他们受到约翰的监督和**保护**），他们就可以访问我的无线设备。

### 此外，友谊不是对称的。

约翰有一份政府工作，所以不幸的是，他不能信任任何人，尤其是在无线方面。

### 你永远是你自己最好的朋友。

这允许诸如复制构造函数之类的东西，即使没有真正的访问，您也可以访问另一个对象的私有成员。

所以我也自动成为我所有克隆的朋友 :-) 因为它们只是我自己的其他实例。

* * *

## 回答 #2

> 赞同：25
> 
> 时间：2009-01-12T22:28:45.527

C++ 中的友谊不是传递的：

```
(A is friend of B) and (B is friend of C) does not mean (A is friend of C) 
```

此外，友谊不是对称的。

```
(A is friend of B) does not mean (B is friend of A) 
```

您必须明确声明 A 是 C 的朋友，才能从 A 中访问 C 的私有内容。如果向类添加 setter 和 getter 会暴露不应该暴露的信息，如果不能，您应该考虑朋友发现你的设计有问题（使用朋友是有效的。这不是糟糕设计的标志）。如果您可以添加 setter 和 getter 而不会破坏接口，那么您应该避免与其他类成为朋友。请注意，嵌套类始终是嵌套类的朋友。所以嵌套类可以看到嵌套类的私有信息。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-01-12T22:29:31.173

我在等待回复时发现了这篇文章。它很好地回答了我的问题： [Friend scope in C++](http://publib.boulder.ibm.com/infocenter/comphelp/v8v101/index.jsp?topic=/com.ibm.xlcpp8a.doc/language/ref/cplr043.htm)

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-01-12T22:30:57.613

因为在 C++ 中友谊不是传递属性。实际上应该尽可能避免它，因为它会在系统中引入复杂性。

想象一下 B 是一个中介类，A 和 C 是需要管理的组件，你真的认为按钮需要访问复选框的实现是否有意义？

顺便说一句，在你问的情况下，我看不出你的标题的“层次结构”在哪里。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2014-02-06T10:21:45.843

这一切都在这里得到了很好的总结：

```
What does it mean that "friendship isn't inherited, transitive, or reciprocal"? 
```

-->

> 这意味着从朋友类派生的类不会自动成为朋友（你相信朋友的孩子吗？），朋友的朋友不会自动成为朋友（你相信朋友的朋友吗？） ，并且将另一个类声明为“朋友”的类不会自动成为该类的朋友（您相信任何称您为朋友的人吗？）。

从

[http://yosefk.com/c++fqa/friend.html#fqa-14.4](http://yosefk.com/c++fqa/friend.html#fqa-14.4)

# php - 为什么我的 PHP 应用程序不会发送 404 错误？

> ID：437256
> 
> 赞同：140
> 
> 时间：2009-01-12T22:26:20.180
> 
> 标签：php, header, http-status-code-404

```
if (strstr($_SERVER['REQUEST_URI'],'index.php')) {
    header('HTTP/1.0 404 Not Found');
} 
```

为什么这行不通？我得到一个空白页。

* * *

## 回答 #1

> 赞同：307
> 
> 时间：2009-01-13T01:39:44.080

您的代码在技术上是正确的。如果您查看该空白页的标题，您会看到 404 标题，其他计算机/程序将能够正确地将响应识别为未找到文件。

当然，您的用户仍然是 SOL。通常，404 由 Web 服务器处理。

*   用户：嘿，在这个 URI 网络服务器上有什么要给我的吗？
*   网络服务器：不，我不知道，404！这是显示 404 的页面。

问题是，一旦 Web 服务器开始处理 PHP 页面，它就已经过了处理 404 的点

*   用户：嘿，在这个 URI 网络服务器上有什么要给我的吗？
*   网络服务器：是的，我愿意，这是一个 PHP 页面。它会告诉你响应代码是什么
*   PHP：嘿，天哪 404！！！！！！！
*   网络服务器：废话，404 页面的人已经回家了，所以我将发送任何 PHP 给我的东西

除了提供 404 标头之外，PHP 现在还负责输出实际的 404 页面。

* * *

## 回答 #2

> 赞同：78
> 
> 时间：2009-01-12T22:37:48.643

```
if (strstr($_SERVER['REQUEST_URI'],'index.php')){
    header('HTTP/1.0 404 Not Found');
    echo "<h1>404 Not Found</h1>";
    echo "The page that you have requested could not be found.";
    exit();
} 
```

如果您查看最后两条回声线，您将看到内容。您可以根据需要自定义它。

* * *

## 回答 #3

> 赞同：74
> 
> 时间：2009-01-12T22:32:59.823

**这是正确**的行为，由您来创建 404 页面的内容。
蜘蛛和下载管理器使用 404 标头来确定文件是否存在。
（带有 404 标题的页面不会被谷歌或其他搜索引擎索引）

但是，普通用户不会查看 http-headers 并将页面用作普通页面。

* * *

## 回答 #4

> 赞同：16
> 
> 时间：2012-10-07T07:20:35.133

作为记录，这是所有情况的处理程序：

```
<?php
header($_SERVER["SERVER_PROTOCOL"]." 404 Not Found");
header("Status: 404 Not Found");

$_SERVER['REDIRECT_STATUS'] = 404;
?> <!-- 404 contents below this line --> 
```

* * *

## 回答 #5

> 赞同：14
> 
> 时间：2011-06-08T12:01:18.450

加载默认服务器 404 页面，如果您有，例如为 apache 定义：

```
if(strstr($_SERVER['REQUEST_URI'],'index.php')){
  header('HTTP/1.0 404 Not Found');
  readfile('404missing.html');
  exit();
} 
```

* * *

## 回答 #6

> 赞同：12
> 
> 时间：2013-12-17T21:50:11.963

从 php 5.4 开始你现在可以做[`http_response_code(404);`](http://www.php.net/manual/en/function.http-response-code.php)

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2013-10-15T04:47:24.823

尝试：

```
header("Status: 404 Not Found");
header('HTTP/1.0 404 Not Found'); 
```

再见！

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2013-07-02T03:45:26.803

另一个基于@Kitet 的解决方案。

```
header($_SERVER["SERVER_PROTOCOL"]." 404 Not Found");
header("Status: 404 Not Found");

$_SERVER['REDIRECT_STATUS'] = 404;
//If you don't know which web page is in use, use any page that doesn't exists
$handle = curl_init('http://'. $_SERVER["HTTP_HOST"] .'/404missing.html');
curl_exec($handle); 
```

如果您正在对托管在您无法控制的服务器中的网站进行编程，您将不知道哪个文件是“404missing.html”。但是，您仍然可以这样做。

通过这种方式，您在同一台服务器上提供了与正常 404 页面完全相同的结果。观察者将无法区分现有的 PHP 页面返回 404 和不存在的页面。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2011-06-19T05:20:06.350

```
if($_SERVER['PHP_SELF'] == '/index.php'){ 
   header('HTTP/1.0 404 Not Found');
   echo "<h1>404 Not Found</h1>";
   echo "The page that you have requested could not be found.";
   die;
} 
```

永远不要简化 echo 语句，永远不要忘记上面的分号，还有为什么要在页面上运行 substr，我们可以轻松地运行 php_self

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2010-10-10T05:55:12.070

稍微短一点的版本。抑制奇数回声。

```
if (strstr($_SERVER['REQUEST_URI'],'index.php')){
  header('HTTP/1.0 404 Not Found');
  exit("<h1>404 Not Found</h1>\nThe page that you have requested could not be found.");
} 
```

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-01-12T23:37:58.447

如果您希望显示服务器的默认错误页面，您必须在服务器中进行处理。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2013-07-16T21:51:41.600

你做对了，虽然它可以使用一些精炼。看起来这个问题已经解决了，所以让我们谈谈实际应用的好处：

我们的一个拥有大量多语言技术文档的旧网站在 if else 条件下执行此操作：

```
 if (<no file found>){
        die("NO FILE HERE");
    } 
```

问题（除了无用的消息和糟糕的用户体验）是我们通常使用链接爬虫（在我们的案例中是完整性）来检查错误的链接和丢失的文档。这意味着我们得到了一个完全正确的 200 no error 响应，告诉我们那里有一个文件。Integrity 不知道我们期待的是 PDF，所以我们不得不手动添加 404 标头和 php.ini 文件。通过在模具上方添加您的代码（因为之后什么都不会执行，并且标题应该始终在任何呈现的 html 之前），完整性（其行为或多或少像浏览器）将返回 404，我们将确切知道在哪里寻找丢失文件。有更优雅的方式告诉用户有错误，

```
 header('HTTP/1.0 404 Not Found');
    die("NO FILE HERE"); 
```

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2015-07-22T05:35:03.803

尝试这个：

```
if (strstr($_SERVER['REQUEST_URI'],'index.php')) {
    header('HTTP/1.0 404 Not Found');
    echo "<head><title>404 Not Found</title></head>";
    echo "<h1>Not Found</h1>";
    $uri   = rtrim(dirname($_SERVER['PHP_SELF']), '/\\');
    echo "<p>The requested URL ".$uri." was not found on this server.</p>";
    exit();
} 
```

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2013-08-10T23:20:19.770

你知道，在我的网站上，我创建了这样的东西：

```
 $uri=$_SERVER['REQUEST_URI'];
        $strpos=strpos($uri, '.php');
        if ($strpos!==false){
        $e404="The page requested by you: &quot".$_SERVER['REQUEST_URI']."&quot, doesn't exists on this server.";
        $maybe=str_replace('.php','',$uri);
        $maybe=str_replace('/','',$maybe);
        die("<center><h1>404</h1><hr><h3>$e404</h3><h3>Maybe try <a href=$maybe>www.leaveyortexthere.p.ht/$maybe</a>?</center>");

} 
```

我希望它可以帮助你。

* * *

## 回答 #15

> 赞同：-4
> 
> 时间：2010-11-11T07:43:48.293

我遇到了这个问题。我认为重定向到服务器上不存在的链接可能会成功！因为服务器会返回他的 404:
`header('Redirect abbb.404.nonexist');`< 那肯定不存在

* * *

## 回答 #16

> 赞同：-17
> 
> 时间：2012-07-10T23:07:25.377

如果要显示服务器的默认 404 页面，可以将其加载到这样的框架中：

```
echo '<iframe src="/something-bogus" width="100%" height="100%" frameBorder="0" border="0" scrolling="no"></iframe>'; 
```

# vim - 如何在 Vim 的文件列表中打开文件？

> ID：437262
> 
> 赞同：40
> 
> 时间：2009-01-12T22:28:01.317
> 
> 标签：vim

我在 vim 中打开了一长串文件，如下所示：

```
/dir1/file1
/dir2/file2
/dir2/file3
..... 
```

如何在同一会话中通过拆分或编辑以最简单的方式一一打开它们？

* * *

## 回答 #1

> 赞同：65
> 
> 时间：2009-01-12T22:33:13.490

我会说 -p 用于标签

```
vim -p `cat yourlistoffiles` 
```

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2009-01-13T10:15:24.587

您可以使用快速修复模式，如下

```
:set errorformat=%f
:cf myfilelist 
```

此时，您可以使用普通的快速修复快捷方式来浏览您的文件、`:cn`下一个文件、`:cp`上一个文件并`:cr`再次转到第一个文件。

**编辑：**

哦，如果您想从当前缓冲区中读取列表，请在上面的说明中使用`:cb`而不是`:cf`in

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2009-01-12T22:31:05.227

您可以执行以下操作

```
cat file | xargs vim 
```

其中 "file" 包含您的文件列表，这将在同一个 vim 会话中打开文件。像往常一样打开多个缓冲区时，您可以使用 :bn 向前导航和向后导航 :bp。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2009-01-12T23:56:34.507

我假设你在 Vim 中打开了文件列表，并且想要在整个列表中模拟“gf”命令......

编辑您的 .vimrc 以包含此功能：

```
function Openall()
    edit <cfile>
    bfirst
endfunction 
```

然后，您可以使用可视模式（1G、Shift-V、G）突出显示整个文件（或要打开的路径集）并键入“:call Openall()”。之后命令行将显示：

```
:'<,'>call Openall() 
```

这将在所有突出显示的行上运行新的 Openall() 函数。

按 Enter 键，所有文件都将在后台缓冲区中打开。然后，您可以使用通常的缓冲区命令访问它们。:ls 会将它们显示为列表。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2017-07-25T04:30:23.790

我想你想在**vim**中选择和列出。某个扩展名的所有文件。从您的主目录或特定来源。

```
find . -name "*.sh" | vim - 
```

然后在 vim 中，您可以搜索和查看这个潜在的巨大列表。（另一个话题）

您找到了文件，现在要拆分打开它吗？

```
CTRL-W F                        *CTRL-W_F*
    Split current window in two.  Edit file name under cursor and
    jump to the line number following the file name. See |gF| for
    details on how the line number is obtained.
    {not available when the |+file_in_path| feature was disabled
    at compile time}

CTRL-W gf                       *CTRL-W_gf*
    Open a new tab page and edit the file name under the cursor.
    Like "tab split" and "gf", but the new tab page isn't created
    if the file does not exist.
    {not available when the |+file_in_path| feature was disabled
    at compile time} 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-13T12:33:45.557

用 bash 试试这个：

```
$ vim -S <(sed "s/^/badd /" <your file name>) 
```

但我不知道为什么文件的第一行被忽略... :-O

此脚本按预期工作：

```
rm -f myfile
for i in `seq 10000`
do
  touch $i
  echo $i >> myfile
done
vi -c "badd `head -1 myfile`" -S <(sed "s/^/badd /" myfile) 
```

* * *

[http://vimdoc.sourceforge.net/htmldoc/starting.html#-S](http://vimdoc.sourceforge.net/htmldoc/starting.html#-S)
[http://vimdoc.sourceforge.net/htmldoc/windows.html#:bad](http://vimdoc.sourceforge.net/htmldoc/windows.html#:bad)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2014-08-25T14:57:08.863

我经常需要打开在我的 SVN 结帐中已修改的文件的更改列表。这一行用于在 vim 选项卡中打开所有修改过的文件。

```
svn st | grep ^M | awk "{print($2)}" | xargs vim -p 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-12T22:34:24.300

也许这会有所帮助：

[http://vimdoc.sourceforge.net/htmldoc/windows.html](http://vimdoc.sourceforge.net/htmldoc/windows.html)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-01-12T22:40:54.833

就像打字一样简单

```
vim /dir1/file1 /dir2/file1 /dir2/file2 ... 
```

一旦你在 vim 中，你可以用 ":n" 切换到下一个文件，":prev" 到前一个文件。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-01-13T09:20:04.543

我的[searchInRuntime](http://code.google.com/p/lh-vim/wiki/searchInRuntime)插件有一个 :Sp 和一个 :Vsp 命令，它们在被调用时可以解决问题。但是，这些文件必须存在。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2021-10-27T18:01:11.797

对于我的用例，您已经打开了一个包含文件列表的缓冲区，我找到了执行此操作的最佳方法。您可以在 vim cmd 模式下键入：

```
:% normal gf<C-v><C-o> 
```

（你在哪里`<C-v>`按字面输入 Ctrl 和 v，对于 相同`<C-o>`）

它变成：

```
:% normal gf^O 
```

### 这是如何工作的：

*   `%`为文件中的每一行运行命令
*   `normal`在正常模式下运行一切
*   `gf`在新缓冲区中打开光标下的文件
*   `<C-v>`让您输入控制代码（`<C-o>`在这种情况下）
*   `<C-o>`回到最后一个位置，该位置始终是带有文件列表的缓冲区

### 潜在用途：

```
# open buffer with list of files from grep
$ grep -rl "new User()" mycode/ libraries/ | vim -

# then runs this in vim:
:% normal gf^O 
```

### 奖励：制作键盘快捷键

将以下内容添加到您的`~/.vimrc`:

```
" Open all files in current buffer (e.g. after piping to `vim -`)
nnoremap <leader>oa :% normal gf^O<cr> 
```

这映射`\oa`到运行命令（因为`<leader>`对`\`我来说）。

## 使用宏的另一种方法：

```
qogf<C-o>j 
```

它运行`gf`(go file) 然后用于`<C-o>`返回初始未命名的缓冲区，然后只需向下一行`j`，准备重复。

然后查看缓冲区中有多少行（12）并像这样运行宏：

```
12@o 
```

# iphone - 单元和功能测试 iPhone 代码？

> ID：437264
> 
> 赞同：6
> 
> 时间：2009-01-12T22:28:19.007
> 
> 标签：iphone, unit-testing, tdd

我刚刚参加了一个关于为 iPhone 开发应用程序的研讨会。演讲者告诉我，没有任何东西可用于为您的 iPhone 软件编写单元测试或功能测试。

这是真的？到目前为止，真的没有 iPhone 的测试故事吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-12T22:47:06.207

是的，您可以进行单元测试，我希望研讨会不会花费太多。 [OCUnit 和 OCMock 可以在 iPhone SDK 上工作吗？](https://stackoverflow.com/questions/159280/do-ocunit-and-ocmock-work-on-the-iphone-sdk)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-12T22:48:25.300

不对。在 SDK 2.2 之前，没有 Apple 官方认可的单元测试支持，但他们后来添加了 OCUnit 支持，这在 Apple 网站上有记录。 [OCUnit 和 OCMock 可以在 iPhone SDK 上工作吗？](https://stackoverflow.com/questions/159280/do-ocunit-and-ocmock-work-on-the-iphone-sdk)

Google 提供了一个很棒的工具包（Google Toolbox for Mac） [http://code.google.com/p/google-toolbox-for-mac/wiki/iPhoneUnitTesting](http://code.google.com/p/google-toolbox-for-mac/wiki/iPhoneUnitTesting)

我认为谷歌的更完整一些，因为你也可以做一些功能性的用户界面测试。

希望有帮助。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-01-13T12:46:36.997

其他人指出了可用的选项，但我要指出，即使没有任何可用的单元测试框架，也没有什么能阻止你自己开发。单元测试框架并没有那么复杂，所以没有一个不是借口。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-12T22:50:14.843

不，这不是真的。从 iPhone SDK 2.2 开始，OCUnit 工作正常。此外，您还可以在 iPhone 上使用其他开源单元测试库。

[http://developer.apple.com/tools/unittest.html](http://developer.apple.com/tools/unittest.html)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-01-18T15:33:33.853

Sen:te（Xcode 中包含的测试框架的创建者）解释了如何在 iPhone 项目中使用 OCUnit：[http](http://www.sente.ch/s/?p=535&lang=en) ://www.sente.ch/s/?p=535&lang=en 。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2010-03-18T01:24:33.727

Gorilla Logic 刚刚开源了 FoneMonkey，这是一个真正的 iPhone 录制/播放功能测试工具，可与 OCUnit 配合使用。

[您可以在http://www.gorillalogic.com/fonemonkey](http://www.gorillalogic.com/fonemonkey)了解更多信息。

# c# - 在 64 位机器上以 32 位运行 C# 应用程序

> ID：437271
> 
> 赞同：10
> 
> 时间：2009-01-12T22:29:49.970
> 
> 标签：c#, .net, process, x86, 32bit-64bit

如何强制我的应用程序在 64 位机器上以 32 位运行？

代码是用 C# 编写的。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-01-12T22:32:58.793

右键单击您的项目，然后选择属性。

在属性中，选择构建选项卡。在平台目标下，选择 x86。

点击`Ctrl`++`Shift`保存`S`所有文件，右键单击解决方案并选择“清理”以摆脱旧的二进制文件。之后的任何构建都应该是 32 位

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2010-01-15T02:33:25.950

命令行形式：

```
corflags application.exe /32BIT+ 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2010-01-15T02:15:10.963

由于[ClickOnce](http://en.wikipedia.org/wiki/ClickOnce)限制，我们无法将现有代码从*Any CPU*更改为*x86时，我是这样做的：*

创建一个 32 位（必须在项目属性下检查 x86）“启动器”应用程序（Windows 应用程序但不是窗体）：

```
static void Main(string[] args)
{
    // Load the assembly    
    string directory = Path.GetDirectoryName(Assembly.GetExecutingAssembly().Location);
    string assemblyName = Path.Combine(directory, "YourAnyCPUApplication.exe");
    Assembly assembly = Assembly.LoadFile(assemblyName);
    assembly.EntryPoint.Invoke(null, null);
} 
```

*在Any CPU*项目的 Main 方法中添加以下代码：

```
if (IntPtr.Size == 4)
{
    Application.EnableVisualStyles();
    Application.SetCompatibleTextRenderingDefault(false);
    // etc...
}
else
{
    // Launch application in 32-bit mode
    System.Diagnostics.Process.Start(Path.GetDirectoryName(Application.ExecutablePath)
                                     + @"\Your32BitApplicationLauncher.exe");
} 
```

我希望这有帮助 ：-）

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-01-12T22:32:39.637

如果您转到 Visual Studio 中的配置管理器，您可以将平台设置为 x86 或 x64。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-12T22:31:39.313

假设这是一个 Winforms、控制台应用程序或 Windows 服务，您必须为 x86 而不是任何 CPU 构建 exe。它在配置管理器中。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-05-10T02:34:16.093

将项目设置为 x86 将阻止文件在 ARM 等非 x86 平台上执行。从 Visual Studio 11 和 .NET 框架 4.5 开始，有一个名为的新选项[`Any CPU 32-bit preferred`](https://stackoverflow.com/q/13149905/995714)，从那时起这是默认选项。生成的代码将在*任何*平台上运行，但在 64 位平台上它们作为 32 位进程运行

# 进一步阅读

*   [Visual Studio 中“首选 32 位”设置的目的是什么？它实际上是如何工作的？](https://stackoverflow.com/q/12066638/995714)
*   [“首选 32 位”编译器标志对 Visual Studio（C#、VB）意味着什么？](https://stackoverflow.com/q/7508965/995714)
*   [AnyCPU 对 .NET 4.5 和 Visual Studio 11 的真正含义](http://blogs.microsoft.co.il/sasha/2012/04/04/what-anycpu-really-means-as-of-net-45-and-visual-studio-11/)

# .net - 是否有在 .NET 中工作的 SyncML 服务器组件？

> ID：437278
> 
> 赞同：2
> 
> 时间：2009-01-12T22:32:00.450
> 
> 标签：.net, mobile, sync, syncml

基本上，我们想要创建一个 SyncML 服务器，我们可以连接到我们自己的自定义数据源，所有组件要做的就是监听客户端连接并通知和请求我们的代码中的数据，然后将数据返回给客户端。主要希望将我们应用程序中的联系人数据与各种移动设备同步。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-24T12:26:20.707

您可以从[Compelson 实验室试用](http://compelson.com)**[Compelson SyncML 服务器](http://syncml.mobiledit.com)**。它有一个用于自定义存储的 SDK。默认情况下，它附带用于同步客户端的 SqlServer 数据存储。SDK 也有一个示例项目，它使用文件系统作为同步客户端的数据存储。

查看此链接：**[http ://www.mobiledit.com/downloads.asp?show=syncml_developers](http://www.mobiledit.com/downloads.asp?show=syncml_developers)**

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-04T00:33:31.903

[SyncML.NET 在 SourceForge](http://sourceforge.net/projects/syncmldotnet/)，但我个人从未尝试过。

# c++ - 在静态初始化程序中使用 getenv() 是否安全，即在 main() 之前？

> ID：437279
> 
> 赞同：13
> 
> 时间：2009-01-12T22:32:35.177
> 
> 标签：c++, c, unix, posix, environment

我查看了[Stevens](http://www.google.com/search?q=advanced+programming+in+the+unix+environment&ie=utf-8&oe=utf-8&aq=t&rls=org.mozilla:en-US:official&client=firefox-a)和[Posix Programmer's Guide](https://rads.stackoverflow.com/amzn/click/com/0937175730)，我能找到的最好的是

> 当进程开始时，一个称为*环境*的字符串数组可用。该数组由外部变量 指向，`environ`定义为：
> 
> `extern char **environ;`

正是那个*环境*变量让我犹豫不决。我想说

- 调用进程/shell 已经分配了空终止字符串块

- 'external' 变量被*getenv()*`environ`用作入口点。

 *- *ipso facto*可以随意在静态初始化程序中调用*getenv() 。*

但是我找不到任何保证*environ*的“静态初始化”在所有其他静态初始化代码之前。这是我想太多了吗？

# 更新

在*我的*平台（AMD Opteron、Redhat 4、GCC 3.2.3）上，设置**LD_DEBUG**表明在调用我的静态初始化程序*之前*设置了*environ 。*这是一件好事。谢谢，@codelogic。但这不一定是我在所有平台上都能得到的结果。

 *此外，虽然我直观地同意@ChrisW 关于 C/C++ 运行时库的行为，但这只是我基于经验的直觉。因此，任何可以从某个权威的地方引用来保证*环境*在调用静态初始化程序之前就在那里的人，加分！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-12T22:38:29.627

我认为您可以在设置 LD_DEBUG 的情况下运行程序以查看确切的顺序：

```
LD_DEBUG=all <myprogram> 
```

**编辑：** 如果您查看运行时链接器（glibc 2.7）的源代码，特别是在文件中：

*   sysdeps/unix/sysv/linux/init-first.c
*   sysdeps/i386/init-first.c
*   csu/libc-start.c
*   sysdeps/i386/elf/start.S

您将看到 `__`在调用任何全局构造函数（init 函数）之前设置了 argc、argv 和 environ（environ 的别名）。您可以从 _start（实际入口点 (start.S)）开始跟踪执行。正如您引用史蒂文斯*所说的“当进程开始时，一个称为环境的字符串数组可用”*，这表明环境分配发生在进程初始化的最开始。这由链接器代码支持，它做同样的事情，应该给你足够的安心:-)

**编辑2：**另外值得一提的是environ设置得足够早，即使运行时链接器也可以查询它以确定是否详细输出（LD_DEBUG）。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-13T01:13:40.967

鉴于环境设置和静态初始化程序的调用都是语言运行时在调用 main()*之前*必须执行的函数，我不确定你会在这里找到保证。也就是说，我不知道这里有一个具体要求，即这*必须*起作用，并且在 main() 之前保证顺序，例如 ANSI 语言和库规范或任何东西......但我没有检查以确保要么。

同时，我不知道限制可以从静态初始化程序调用哪些运行时库函数的特定要求。而且，更重要的是，如果您无法从一个环境访问环境，那么（对我来说）它会感觉像是一个运行时错误。

在此基础上，我投票认为我希望这会奏效，这是一个安全的假设，并且当前的数据点似乎支持这种推理。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-12T22:37:07.100

根据我的经验，C 运行时库是在运行时调用静态变量的初始化程序之前初始化的（因此您的初始化程序可能会调用 C 运行时库函数）。

# jquery - 使用 jQuery tablesorter 从排序中排除列

> ID：437290
> 
> 赞同：20
> 
> 时间：2009-01-12T22:37:00.143
> 
> 标签：jquery, tablesorter

我正在寻找一种方法来排除使用 jQuery 的 tablesorter 插件对单个列进行排序。具体来说，我有一个相当大的表，并希望保持“行号”列固定，以便在排序后很容易看到特定行在表中的位置。

例如：

```
#    name
-----------
1    papaya
2    apple
3    strawberry
4    banana 
```

在名称列上排序时，应导致：

```
#    name
-----------
1    apple
2    banana
3    papaya
4    strawberry 
```

谢谢。

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2012-10-16T23:41:33.680

对于那些在寻找一种方法来排除列可排序（即列上的可点击标题）时发现这一点的人，下面的示例将列 4（零索引）排除在排序之外）：

```
$("table").tablesorter({
    headers: {4: {sorter: false}}
}); 
```

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2009-01-12T23:12:50.773

这是一个您可以使用的小部件，它将完成您正在寻找的内容：

```
$(function() {
    // add new widget called indexFirstColumn
    $.tablesorter.addWidget({
        // give the widget a id
        id: "indexFirstColumn",
        // format is called when the on init and when a sorting has finished
        format: function(table) {               
            // loop all tr elements and set the value for the first column  
            for(var i=0; i < table.tBodies[0].rows.length; i++) {
                $("tbody tr:eq(" + i + ") td:first",table).html(i+1);
            }                                   
        }
    });

    $("table").tablesorter({
        widgets: ['zebra','indexFirstColumn']
    });

}); 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-01-13T00:18:32.107

编辑：我在[http://jsbin.com/igupu4/3](http://jsbin.com/igupu4/3)制作了这种技术的样本。单击任何列标题进行排序...

虽然我没有回答您关于 jquery 的问题，但这是获得您在此处描述的特定行为的另一种方法，在排序后固定行号。（使用 CSS，特别是[content 属性](http://www.w3.org/TR/CSS2/generate.html#content)和与[计数器相关的属性/功能](http://www.w3.org/TR/CSS2/syndata.html#counter)。）

```
<html>
<head>
  <title>test</title>
  <style type="text/css">
    tbody tr 
    {
      counter-increment : rownum ; 
    }
    tbody 
    { 
      counter-reset: rownum; 
    }
    table#sample1 td:first-child:before 
    { 
      content: counter(rownum) " " ; 
    }
    table#sample2 td.rownums:before 
    { 
      content: counter(rownum) ; 
    }
  </style>
  <script src="jquery-1.2.6.min.js" ></script>
  <script src="jquery.tablesorter.min.js" ></script>
  <script>
    $(document).ready(function() 
      { 
        $("table").tablesorter(); 
      } 
    ); 
  </script>
</head>

<body>
  <table id="sample1">
    <thead>
      <tr>
        <th>Col 1</th>
        <th>Col 2</th>
    </thead>
    <tbody>
      <tr>
        <td>
          <p>foo</p>
        </td>
        <td>
          <p>quuz</p>
        </td>
      </tr>

      <tr>
        <td>bar</td>
        <td>quux</td>
      </tr>

      <tr>
        <td>baz</td>
        <td>baz</td>
      </tr>
    </tbody>
  </table>

  <table id="sample2">
    <thead>
      <tr>
        <th>Rownums</th>
        <th>Col 1</th>
        <th>Col 2</th>
        <th>More Rownums</th>
    </thead>
    <tbody>
      <tr>
        <td class="rownums"></td>
        <td>
          <p>foo</p>
        </td>
        <td>
          <p>bar</p>
        </td>
        <td class="rownums"></td>
      </tr>

      <tr>
        <td class="rownums"></td>
        <td>quuz</td>
        <td>baz</td>
        <td class="rownums"></td>
      </tr>

      <tr>
        <td class="rownums"></td>
        <td>fred</td>
        <td>quux</td>
        <td class="rownums"></td>
      </tr>
    </tbody>
  </table>
</body>
</html> 
```

如果您的浏览器足够兼容 CSS2.1，您可以在示例 1 中使用 tr:before 而不是 td:first-child:before。（[Mozilla 目前仅在主干中支持此功能...](https://developer.mozilla.org/web-tech/2008/08/20/css-21-generated-content/)）

在示例 2 中，您可以看到如何将行号列放置在任何位置，而不仅仅是在第一列中。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2016-11-15T12:16:56.897

```
$("table").tablesorter({
    headers: {4: {sorter: false},8: {sorter: false}}
}); 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2014-03-06T16:14:55.053

这将跳过对第一列的排序，并允许对第二列进行排序。只需将所有列设置为真/假，从第一列开始为零。

```
<script>
$(document).ready(function() { 
    $("table").tablesorter({
        headers: {
            0: {sorter: false},
            1: {sorter: true},
            3: {sorter: false}
        }//headers
    }); 
});            
</script> 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2016-10-25T09:48:04.523

Brian Fisher 的答案是正确的，但是在大型表中（在我的示例中为 +1600 行）太慢了。我改进了遍历每一行的方式。其他一切都是一样的。

```
$(function() {
    // add new widget called indexFirstColumn
    $.tablesorter.addWidget({
        // give the widget a id
        id: "indexFirstColumn",
        // format is called when the on init and when a sorting has finished
        format: function(table) {               
            // loop all tr elements and set the value for the first column  
            $(table).find("tr td:first-child").each(function(index){
                $(this).text(index+1);
            })                                  
        }
    });

    $("table").tablesorter({
        widgets: ['zebra','indexFirstColumn']
    });
}); 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-12T22:50:05.233

人力资源管理系统。从 tablesorter 重组表格的方法来看，我很确定这不是完全可能的。Tablesorter 将每个 tr 从 DOM 中一一拉出，并根据索引字段对其进行排序，重新插入整个 tr 而不以任何方式更改 tr 的内容。然后，您请求的解决方案需要在每次排序后遍历表并重新枚举第一列。Tablesorter 确实有一个插件方法，供 zebrastripe 和其他扩展使用。也许这可以用来挂钩排序方法？

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2016-11-17T19:49:26.310

斯托博尔的答案是完美的。唯一的问题是需要等到表格完全呈现才能放入数字。

一些观察：

*   您需要为此方法提供一个空列放置数字。
*   如果表中有标题，则必须使用标签 THEAD 和 TBODY 让 tablesorter 仅对 TBODY 部分中的数据进行排序。
*   如果您的表格中有页脚，则必须将其排除在 TBODY 部分之外，以避免表格排序器对其内容进行排序，您还必须使用标签 TH 而不是 TD 以避免计算页脚。

Note: The method shown by Abdul only restricts to the user to sort by the indicated columns, but his content is always ordered with the rest of the row when an order by other unrestricted column is selected.

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2021-07-24T13:12:56.313

只是这个问题的更新。虽然票数最高的答案是一个很好的解决方案，但 jstablesorter 团队添加了此功能，因此在您的 html 单元格中添加以下属性：

```
data-sorter="false" 
```

这是一种禁用任何标题排序的无缝方式。

# .net - .NET：可以根据 URL 参数更改 XPath() 表达式吗？

> ID：437298
> 
> 赞同：2
> 
> 时间：2009-01-12T22:39:03.103
> 
> 标签：.net, xpath, filter

我正在设置一个简单的页面，它只显示 XML 文件的内容并允许用户按关键字过滤。

我是一个认真的 .NET 新手，但我已经设置了 XmlDataSource：

```
<asp:XmlDataSource ID="RSSFeedDataSource" runat="server"  DataFile="test.xml"
        XPath="/rss/channel/item[contains(title,"theKeyword")]"></asp:XmlDataSource> 
```

所以我想让用户输入一个关键字并根据它更改数据源。

我想我会用来自文本输入的关键字进行回发，抓住那个关键字并以某种方式插入到 XPath 表达式中......

在这一点上我要简单，但这会是最简单的方法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-12T22:58:12.253

您可能可以从页面本身内部执行此操作，如下所示：

```
<asp:XmlDataSource ID="RSSFeedDataSource" runat="server" 
  DataFile="test.xml"
  XPath="/rss/channel/item[contains(title,"<%=Request.QueryString["filter"] %>")]"></asp:XmlDataSource> 
```

如果这不起作用，为什么不使用查询字符串或发布值在代码隐藏中设置 XPath 属性？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-12T22:59:13.563

通过后面的代码和按钮回发来获取它的方法

ASP页面：

```
<asp:TextBox id="txtKeyword" runat="server" />
<asp:Button id="btnKeyword" OnClick="btnKeyword_Click" runat="server" /> 
```

后面的代码：

```
public void btnKeyword_Click(Object sender, EventArgs e)
{
  // Assuming C#
  // Retrieve the keyword from the text box
  string keyword = txtKeyword.Text

  // Next step would be to modify the XPath of your XmlDataSource
  RSSFeedDataSource.XPath = "/rss/channel/item[contains(title," + keyword + ")]"
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-12T22:59:20.893

在回发上，你应该能够做到

```
RSSFeedDataSource.XPath = "/rss/channel/item[contains(title,'" + txtKeyword.Text + "')]"; 
```

假设关键字来自 id 为 txtKeyword 的服务器控件

# model-view-controller - 将非 GUI 对象“连接”到 GUI 对象

> ID：437309
> 
> 赞同：1
> 
> 时间：2009-01-12T22:43:54.467
> 
> 标签：model-view-controller, user-interface, data-binding

我有一组与 GUI 对象具有一对一关系的非 GUI 对象。所有事件都通过顶层窗口进行路由。

GUI 对象上发生的许多（不是全部）事件导致调用关联对象的方法。

NonGui 对象中的某些方法在调用时会更改 GUI 对象。

一个例子是某种游戏，比如带有现代 GUI 的 Rogue。你有一个玩家在一个回合中占据的区域（称之为一个区域），你有一个在 GUI 上与之关联的对象（一个按钮）。请记住，这只是一个类比（甚至不是真正的问题），没有一个类比是完美的。

问题是，如何设计这种东西？

由于按钮类来自第三方库，我无法在其中嵌入对非 GUI 对象的引用，尽管我可以在非 GUI 对象中嵌入对 GUI 对象的引用。所以看起来我必须在某个地方创建一个从按钮到“区域”的地图，但我应该把它放在哪里？在顶层窗口中？在顶级模型中？IU 会衍生出某种接口类吗？

建议？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-12T23:09:06.240

如果您提到您的平台和语言会有所帮助，但通常听起来您正在描述[Model-View-Controller](http://en.wikipedia.org/wiki/Model-view-controller)。

您的“GUI”对象是视图。这是您保留用户界面的所有渲染逻辑的地方。用户与视图的交互由控制器处理。

控制器是事件句柄的薄层。用户交互调用控制器上的方法，然后将它们路由到模型。

您的“非 GUI”对象是模型。这是包含业务逻辑的对象，其状态最终通过单击 GUI 上的按钮来更新。

您提到对象之间的“嵌入”引用。只要您的 GUI 中的事件可以通过某种机制路由到您的控制器，这不是必需的。这种设计模式很有用，因为它将 UI 逻辑与业务逻辑分开。您可以非常轻松地“捕捉”新视图，因为视图和控制器之间的事件连接非常少。

维基百科[文章](http://en.wikipedia.org/wiki/Model-view-controller)有更多信息和实现示例的链接。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-12T23:12:47.967

浪费一点时间看[Falcon's Eye](http://users.tkk.fi/jtpelto2/nhfeatures.html#SCREENSHOTS)（虽然它是 Nethack 而不是 Rogue）。像游戏（或一般的命令行应用程序）这样的皮肤流氓有很长的历史，这不是很经典的 mvc - 它已经有一个完整的 UI，相反，您可以通过直接翻译向该 UI 添加一个装饰器，或者另一个比喻（例如 gparted，gnome 分区编辑器，它允许通过直接操作构建一系列分区编辑命令）

# lisp - 尝试学习：LISP 中的对象重定向和泛型函数！

> ID：437312
> 
> 赞同：6
> 
> 时间：2009-01-12T22:45:12.763
> 
> 标签：lisp, common-lisp, clos, generic-function

由于[另一个问题](https://stackoverflow.com/questions/398579/whats-the-best-way-to-learn-lisp)，我正在阅读 Practical common Lisp 。

我刚刚阅读了第 16 章和第 17 章，您可以在其中了解 LISP 如何管理对象。但是经过几年思考 Java 如何管理对象后，我似乎无法真正理解如何使用 CLOS 在 LISP 中实现更大的体系结构。

因此，我要求你们阅读 20 到 50 页的关于 CLOS 应用于更大架构而不是简单示例的内容。也许是几篇博文，甚至是经验！

泰

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-13T00:38:02.223

如果您想了解这本书，Sonja E. Keene 的“COMMON LISP 中的面向对象编程”，第 11 章（开发高级 CLOS 程序：流）包含一个非平凡的示例，其中包含大约 40 页的多重继承.

详细讨论了八类（流、输入流、输出流、双向流、字符流、字节流、磁盘流和磁带流）。然后使用多重继承派生用户期望创建实例的具体类。

它比 Practical Common Lisp 中的银行账户示例更重要。您可能还会发现 Keene 书中的其余部分有助于更深入地了解 CLOS：整本书都是关于 CLOS 的。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-13T03:38:28.460

如果你真的想了解 CLOS，可以回去阅读[The Art of the Meta Object Protocol](https://rads.stackoverflow.com/amzn/click/com/0262610744)，它为 CLOS 的子版本 Closette 提供了基础和底层代码。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-01-13T00:30:34.610

或许可以看看后面章节中介绍的示例应用程序。你会看到类和对象只是你盒子里的另一个工具。抵制使用 Lisp 语法编写 Java 的冲动。

另一个值得关注的地方是[Success Lisp](http://www.psg.com/~dlamkins/sl/contents.html)，第 7 章和第 14 章是基础知识，第 31 章和 3.10 的一部分是关于包和处理大型项目的。

一些 Lisp 大师（可能是 Paul Graham，但我不确定）曾经说过他根本不需要 CLOS。

*编辑*：我认为您的困惑可能来自这样一个事实，即在 Lisp 中，您不使用类系统来组织名称空间。这是单独进行的；两者实际上并没有任何关系。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-03T10:24:14.927

我们[Weblocks](http://weblocks.viridian-project.de/)也大量使用 CLOS，因此您可能需要稍微浏览一下源代码。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-17T19:20:10.143

更大的 CLOS 应用程序是 1) 来自 Lispworks 的 CAPI 2) cl-http webserver 3) 一个非常大的 CLOS 包是 CLIM 4) 如果你喜欢 OpenGenera（这是一个使用 Common Lisp 和一些前身 ZetaLisp 5 的 Lisp 操作系统），一个较小的包是[http： //www.cliki.net/mel-base](http://www.cliki.net/mel-base)

问候弗里德里希

# perl - 为什么Win2003下Win32::OLE不能与Excel2003对话？

> ID：437313
> 
> 赞同：6
> 
> 时间：2009-01-12T22:45:15.680
> 
> 标签：perl, excel, ole

我有一个基于 Web 的 Perl Win32::OLE 脚本，它在服务器端使用 Excel。多年来，它一直在运行 Excel2000 的 Win2000 服务器上愉快地工作。我们最近升级到 Win2003/Excel2003，我现在从脚本中得到以下错误：

```
 Win32::OLE(0.1709) error 0x80070005: "Access is denied" at create_worksheet_lib.plx line 639
eval {...} called at create_worksheet_lib.plx line 639 
```

第 639 行是：

```
$Excel = Win32::OLE->new('Excel.Application', sub {$_[0]->Quit;}) or die "Oops, cannot start Excel"; 
```

Perl 似乎不再能够访问 Excel。那里有任何 Windows 专家可以帮助解决这个问题吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-16T23:41:05.587

似乎与[另一篇文章](https://stackoverflow.com/questions/425092/permission-denied-opening-an-excel-file-using-excel-12-0-library-vb6)中描述的相同的邪恶问题，但是，没有找到解决方案......

也许使用 Procmon 进行故障排除将揭示问题所在（请参阅[http://support.microsoft.com/kb/286198](http://support.microsoft.com/kb/286198)）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-16T21:16:36.243

您可以从服务器上的命令行运行脚本（将 Web 服务器排除在外）吗？这是我要尝试的第一件事。如果它从命令行运行，则可能是权限问题或 Web 服务器配置问题。

# html - 编写stackoverflow样式“问题”/“标签”翻转按钮的最佳方法

> ID：437315
> 
> 赞同：3
> 
> 时间：2009-01-12T22:45:33.370
> 
> 标签：html, css, text, button, rollover

什么是实现翻转“按钮”的最佳方式，如 Stackoverflow 顶部的“问题”、“标签”、“用户”。

它实际上是这样实现的：

```
<div class="nav">            
<ul class="primarynav">
      <li class="">
           <a href="/questions">Questions</a>
      </li>
      <li class="">
           <a href="/tags">Tags</a>
      </li>
      <li class="">
           <a href="/users">Users</a>
      </li>
      <li class="">
          <a href="/badges">Badges</a>
      </li>
      <li class="">
          <a href="/unanswered">Unanswered</a>
      </li>
 </ul> 
```

我有点放弃尝试为此找到 javascript，因为所有 javsascript 似乎都在一条线上。

我只是想知道人们认为实现这样的简单按钮的最简单/最可靠的方法是什么。

我发现 stackoverflow 正在使用`<li>`而不是像`<span>`. 很好奇为什么...

PS。我正在使用 ASP.NET——目前没有其他库，如 JQuery，但如果有帮助，我愿意尝试类似的东西。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-01-12T22:50:54.140

链接上的悬停效果不需要 javascript。只需使用 :hover[伪类](http://www.w3.org/TR/CSS2/selector.html#dynamic-pseudo-classes)：

```
a:hover {
    background-color:#FF9900; 
} 
```

[关于菜单，使用无序列表](http://mirificampress.com/permalink/the_amazing_li)实现导航是很常见的。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-12T22:56:00.137

使用*li*元素是有意义的，因为这些是（链接的）列表，赋予链接语义。当事物被语义标记时，文档可以被非视觉浏览器理解，例如搜索引擎和使用屏幕阅读器的视觉障碍者。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-12T23:10:46.083

分解它，它的 css 驱动：

```
.primarynav li {
    margin-right:7px;
}
.primarynav li:hover {
   background-color:#FF9900;
} 
```

萤火虫是我的朋友。

但是，没有理由*不能*用 javascript 完成

```
jQuery(function($){ 
      $("ul#nav li").each(function(i,v){ 
           $(v).hover(function(){ 
              $(v).addClass("hovered"); 
           },function(){ 
              $(v).removeClass("hovered");
           }); 
      });
}); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-12T22:52:15.200

仅 CSS：

```
a.tagLink {
    background-color: red;
}

a.tagLink:hover {
    background-color: blue;
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-12T22:53:19.457

你不需要为此使用 JavaScript；一些简单的 CSS 就足够了：

```
a:hover {
    background-color: /* something magical */;
} 
```

注意`:hover`选择器的“”部分；这就是神奇之处，它也适用于非`<a>`元素，尽管一些旧版本的 IE 会忽略它而不是链接。

显然，您可以在选择器中组合其他位以将此效果限制为导航链接或您想要实现的任何内容。

# database - 如何在服务器之间移动 Pervasive PSLQ 数据库

> ID：437319
> 
> 赞同：0
> 
> 时间：2009-01-12T22:46:30.530
> 
> 标签：database, postgresql, pervasive

在两台服务器之间移动 Pervasive PSQL 数据库的最简单方法是什么。

如有必要，我可以停止数据库引擎。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-27T08:28:54.620

我会在两个站点都停止数据库引擎。将所有数据（数据库文件）从第一个站点复制到第二个站点，然后启动第二个站点引擎。如果两个站点上的文件夹相同，您就完成了。如果不是，您必须在第二个站点上“创建”一个新数据库（在 PCC 中），该数据库指向您刚刚复制的数据文件。

# sql-server - 在数据库导入应用程序中实现最佳性能的清单

> ID：437324
> 
> 赞同：0
> 
> 时间：2009-01-12T22:48:11.807
> 
> 标签：sql-server, database, database-design

我正面临一个旨在将大量数据导入 Microsoft SQL Server 2000 数据库的应用程序。该应用程序似乎需要很长时间才能完成，我怀疑应用程序设计存在缺陷。有人让我深入研究应用程序以查找并修复严重的瓶颈（如果有的话）。我想要一种结构化的方法来完成这项工作，并决定准备一份潜在问题清单以寻找。我有一些使用 SQL 数据库的经验，并且到目前为止已经写下了一些要寻找的东西。

但这对一些外部灵感也很有帮助。你们中的任何人都可以向我指出一些关于良好数据库模式设计和良好数据库应用程序设计清单的良好资源吗？

我计划为以下主要主题制定清单：

1.  数据库硬件——首先要证明服务器硬件是合适的？
2.  数据库配置 - 下一步是确保配置数据库以获得最佳性能？
3.  数据库模式 - 数据库模式是否有合理的设计？
4.  数据库应用程序 - 应用程序是否包含健全的算法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-12T23:06:00.100

我将添加到列表中的三个项目：

1.  批量插入 - 您是使用批量提供程序（即 BCP 或 SqlBulkCopy）还是通过单独的 INSERT/UPDATE 语句导入数据？
2.  索引 - 您的目标表上有索引吗？可以在导入之前删除它们然后在之后重建吗？
3.  锁定 - 尝试导入数据时是否发生争用？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-12T23:06:27.057

好的开始。以下是推荐的优先事项。

第一原则。除了源文件读取和 SQL 插入之外，导入应该很少或不做任何处理。其他处理必须在加载之前完成。

1.  应用程序设计是#1。在尝试加载**之前**，应用程序是否尽可能多地处理平面文件？这是大型数据仓库负载的秘诀：离线准备，然后批量加载行。

2.  数据库模式是#2。你有正确的表和正确的索引吗？负载不需要任何索引。大多数情况下，您希望删除并重建索引。

    负载最好不需要任何触发器。所有触发的处理都可以离线完成，以准备加载文件。

    加载最好不要作为存储过程来完成。您想使用 Microsoft 的简单实用程序来批量加载行。

3.  配置。很重要，但比模式设计和应用程序设计要少得多。

4.  硬件。除非你有钱烧钱，否则你不会走多远。如果——在其他一切之后——你可以证明硬件是瓶颈，然后花钱。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-12T23:08:31.797

您遗漏了我开始寻找的第一个地方：用于导入数据的技术。

如果应用程序正在插入单行，那有什么原因吗？是使用 DTS 还是 BULK INSERT 还是 BCP？它是加载到临时表还是带有触发器的表？它是分批加载还是尝试加载并提交整个批次？行中是否有大量的转换或数据类型转换？是否将数据广泛转换为不同的模式或模型？

我不会担心 1 和 2，直到我看到使用的 ETL 技术是否合理，并且如果他们将数据导入现有模式，那么您将没有太多空间来更改与 3 相关的任何内容。关于 import 和 4，我不喜欢在加载部分对数据做太多算法。

为了在最一般情况下获得最佳性能，请加载到具有良好可靠的基本类型转换和当时完成的异常的平面暂存表（使用 SSIS 或 DTS）。对于非常大的数据（比如每天加载数百万行），我会加载 100,000 或 1,000,000 个记录批次（这在 BCP 或 SSIS 中很容易设置）。任何派生列要么在加载时创建（SSIS 或 DTS），要么在 UPDATE 之后立即创建。运行异常、验证数据并创建约束。然后将数据作为一个或多个事务的一部分处理到最终模式中 - 维度或实体的更新、插入、删除、分组或其他。

显然，这也有例外，这在很大程度上取决于输入数据和模型。例如，在输入中使用 EBCDIC 打包数据时，在加载阶段没有可靠的基本类型转换之类的东西，这会导致您的加载更加复杂和缓慢，因为必须更大量地处理数据。

使用这种整体方法，我们让 SQL 做它擅长的事情，并让客户端应用程序（或 SSIS）做它们擅长的事情。

# asp.net - 您如何跟踪 ASP.NET 网站的依赖关系？

> ID：437325
> 
> 赞同：1
> 
> 时间：2009-01-12T22:48:23.427
> 
> 标签：asp.net, dependencies, web-site-project

动态编译方法似乎超出了提取此类信息的典型工具的能力。我知道转换为 Web 应用程序可能会更好，但我想问一下在网站项目的情况下如何完成。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-12T22:50:34.000

您始终可以使用[aspnet_compiler](http://msdn.microsoft.com/en-us/library/ms229863(VS.80).aspx)，然后扫描已编译程序集的依赖项。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-13T04:48:06.243

aspnet_compiler 仍然可以给您留下一大堆要扫描的程序集。您可以使用 aspnet_merge 来跟踪它，或者使用[Web 部署项目](http://www.microsoft.com/downloads/details.aspx?familyId=0AA30AE8-C73B-4BDD-BB1B-FE697256C459&displaylang=en)为您运行编译器和合并实用程序。WDP 可以为您提供整个网站的单个程序集。

# html - 如何在 CSS 中垂直对齐表格

> ID：437333
> 
> 赞同：5
> 
> 时间：2009-01-12T22:50:16.670
> 
> 标签：html, css, html-table

如何将屏幕中间的表格与css垂直对齐？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-12T23:00:49.160

一般来说，类似的东西在任何具有定义高度的块元素中都可以很好地工作。

```
table { 
 position: absolute;
 top: 50%;
 margin-top: -50%;
} 
```

由于您没有定义的高度，因此以页面为中心更难，但我认为这是可行的。

```
html {
 height: 100%;
} 
```

您可能会遇到一些浏览器差异，请采取相应措施。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-11T19:25:48.910

简而言之，只要让你的身体成为一个表格，因为垂直对齐确实适用于表格单元格：

```
body, html { 
  height: 100%; 
}

body { 
  display: table; 
}

#wrapper { 
  display: table-cell; 
  vertical-align: middle;
  height: 80%;
} 
```

这会将您的页面包装器垂直对齐到中间，并让它流动 80%

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-13T01:35:08.083

如果你可以给表格一个固定的高度，那么可以随意调整我刚刚完成的[这个网站的 CSS。](http://cleanteq.com/)

解释起来有点复杂，但基本上你在内容周围 50% 的屏幕高度处设置了一个 1 像素高的“地平线”，然后将要居中的元素的顶部（即你的表格）偏移其高度的 50%。

编辑：[这是](http://www.wpdfd.com/editorial/thebox/deadcentre4.html)我最初提出解决方案的文章，并附有解释和所有内容。

# fluent-nhibernate - Rhino.Commons + Fluent NHibernate

> ID：437337
> 
> 赞同：3
> 
> 时间：2009-01-12T22:51:04.843
> 
> 标签：fluent-nhibernate, rhino, rhino-commons

有没有办法将 Rhino.Commons 与 Fluent Nhibernate 一起使用（特别是 AutoMapping）？

非常感谢

从诺

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-03T04:52:27.573

# ##########

更新：
该答案写于 2009 年 2 月。随着 FluentNHibernate 项目的变化速度，很可能该方法已被重命名，或者更改约定的机制已被移动。

# ##########

我想将来自 Rhino.Commons.ForTesting 的 DatabaseTextFixtureBase 与 FluentNHibernate 一起使用。我一直遇到的问题是，FluentNHibernate 在 PersistenceModel 类中的 NHibernate 配置中添加了它的魔力，并且一旦你调用 DatabaseTestFixtureBase.InitializeNHibernateAndIoC() Rhino.Commons 就可以私下做很多事情并且您不再有权访问 NHibernate 配置。

事实证明，我的最后一个假设是错误的。如果你在容器中注册了一个 INHibernateInitializationAware 服务，它会在调用 CreatConfigs() 时被 NHibernateUnitOfWorkTestContext 拾取。

我正在使用的 INHibernateInitializationAware 实现如下所示：

```
public class FluentNHibernateInitializationAwareConfigurator : INHibernateInitializationAware
{
    public void BeforeInitialization(){}

    public void Configured(Configuration cfg)
    {
        var persistenceModel = new PersistenceModel
                                   {
                                       Conventions =
                                           {
                                               GetForeignKeyName = (prop => prop.Name + "Id"),
                                               GetForeignKeyNameOfParent = (prop => prop.Name + "Id")
                                           }
                                   };
        persistenceModel.addMappingsFromAssembly(typeof(OneOfMyMappingClasses).Assembly);
        persistenceModel.Configure(cfg);

    }

    public void Initialized(Configuration cfg, ISessionFactory sessionFactory){}
} 
```

当然，约定可以替换为您碰巧使用的任何约定。

享受！

* * *

如果您使用的是最新版本的 FluentNHibernate，您可能正在使用 Fluently 类来配置您的映射。这是 FluentNHibernateInitializationAwareConfigurator 的另一个版本：

```
public class FluentNHibernateInitializationAwareConfigurator : INHibernateInitializationAware  
{  
    public void BeforeInitialization(){}  

    public void Configured(Configuration cfg)  
    {
        Fluently.Configure().Mappings(m =>
        {
            m.FluentMappings.AddFromAssemblyOf<User>()
                .AlterConventions(convention =>
                    {
                        convention.GetForeignKeyName = (prop => prop.Name + "Id");
                        convention.GetForeignKeyNameOfParent = (prop => prop.Name + "Id");
                    }
                );
            m.Apply(cfg);
        });
    }  

    public void Initialized(Configuration cfg, ISessionFactory sessionFactory){}
} 
```

# windows - 如何实现全屏模式？

> ID：437352
> 
> 赞同：2
> 
> 时间：2009-01-12T22:56:02.680
> 
> 标签：windows, user-interface

对于在 Windows 操作系统下运行的应用程序，如何实现全屏模式（如在 Web 浏览器中）？是否比最大化窗口和隐藏窗口装饰更复杂？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-12T22:58:06.543

表单样式 = NONE，最大化。

如果您指定语言，您可能会得到一些示例代码。

* * *

**编辑**：响应[Greg 发布](https://stackoverflow.com/questions/437352/how-to-implement-full-screen-mode#437437)的内容，这肯定会在 .Net 中工作，但不确定其他语言。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-12T23:22:13.640

不，它并不比你建议的更复杂。我知道[VNC](http://www.realvnc.com/)查看器源代码中有一个此类代码的示例，因为我在多年前贡献了该功能的第一个实现。

# .net - F# 作为脚本语言

> ID：437355
> 
> 赞同：5
> 
> 时间：2009-01-12T22:56:38.373
> 
> 标签：.net, scripting, f#

有没有一种编写无需编译即可独立执行的 F# 脚本的好方法？
...作为可以通过服务器上的任务调度程序执行的脚本？我假设服务器将安装核心 F# 库，但未安装 Visual Studio。

是否有等效于[CS-Script](http://www.codeproject.com/KB/cs/cs-script_for_cp.aspx)或[NScript](http://www.codeproject.com/KB/dotnet/nscript.aspx)的 F# ，但不是 hack（解决方法）。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-12T23:07:38.240

```
fsi --exec 
```

将通过交互式控制台运行命令行上的所有文件，然后退出。

# .net - “最大的自由区域”的性能计数器？

> ID：437367
> 
> 赞同：3
> 
> 时间：2009-01-12T23:00:59.923
> 
> 标签：.net, windows, performance, memory, memory-management

我正在调试内存不足异常。当我得到异常时，“虚拟字节”性能计数器表明有足够的可寻址空间。然而，问题在于可寻址空间严重碎片化，并且“最大的空闲区域”（从 WinDbg 中的 !address 返回）太小。

为了测量内存碎片，我想监控 perfmon 中的“最大空闲区域”。有没有给我这个值的性能计数器？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-14T20:43:58.763

我不相信这条信息有一个单一的性能计数器，但可以通过使用`VirtualQueryEx`Win32 函数推断出来。

您可以在最小有效虚拟地址（可以从 获取`GetSystemInfo`）上调用它，然后可以使用返回的页面范围的大小来确定要调用的下一个页面范围的基地址`VirtualQueryEx`。

通过重复调用`VirtualQueryEx`这样的地址空间，您可以确定 MEM_FREE 类型的最大页面范围及其基地址是什么。

这是我用于“地址空间监视器”程序的技术。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-12T23:07:17.227

来自[http://dotnetdebug.ne​​t](http://dotnetdebug.net/2005/06/30/perfmon-your-debugging-buddy/) /2005/06/30/perfmon-your-debugging-buddy / ：

虚拟地址空间碎片指标：

*   总保留字节数明显大于 # 总提交字节数
*   固定对象的数量增加
*   GC 句柄数量增加
*   所有堆中的字节数总是在增加。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-10-01T19:23:11.440

使用我在[这里找到的代码，这里是](http://www.codeproject.com/Articles/716227/Csharp-How-to-Scan-a-Process-Memory)[Charles Bailey](https://stackoverflow.com/users/19563/charles-bailey)[解决方案](https://stackoverflow.com/a/444589/322740)的代码示例：

```
public class MemoryAnalyzer {
    public long GetLargestFreeRegionSize() {
        // getting minimum & maximum address
        SYSTEM_INFO sysInfo;
        GetSystemInfo(out sysInfo);

        var procMinAddress = sysInfo.minimumApplicationAddress;
        var procMaxAddress = sysInfo.maximumApplicationAddress;

        // saving the values as long ints so I won't have to do a lot of casts later
        var procMinAddressL = (long)procMinAddress;
        var procMaxAddressL = (long)procMaxAddress;

        // current process
        var process = Process.GetCurrentProcess();

        // opening the process with desired access level
        var processHandle = OpenProcess(PROCESS_QUERY_INFORMATION | PROCESS_WM_READ, false, process.Id);

        long maxFreeRegionSize = 0;

        while (procMinAddressL < procMaxAddressL) {
            const int memBasicInfoSize = 28; //sizeof(MEMORY_BASIC_INFORMATION)
            MEMORY_BASIC_INFORMATION memBasicInfo;
            VirtualQueryEx(processHandle, procMinAddress, out memBasicInfo, memBasicInfoSize);

            if (memBasicInfo.State == MEM_FREE) {
                maxFreeRegionSize = Math.Max(maxFreeRegionSize, memBasicInfo.RegionSize);
            }

            // move to the next memory chunk
            procMinAddressL += memBasicInfo.RegionSize;
            procMinAddress = new IntPtr(procMinAddressL);
        }

        return maxFreeRegionSize;
    }

    #region Win32
    // REQUIRED CONSTS
    const int PROCESS_QUERY_INFORMATION = 0x0400;
    const int PROCESS_WM_READ = 0x0010;
    const int MEM_FREE = 0x10000;

    // REQUIRED METHODS
    [DllImport("kernel32.dll")]
    public static extern IntPtr OpenProcess(int dwDesiredAccess, bool bInheritHandle, int dwProcessId);

    [DllImport("kernel32.dll")]
    public static extern bool ReadProcessMemory(int hProcess, int lpBaseAddress, byte[] lpBuffer, int dwSize, ref int lpNumberOfBytesRead);

    [DllImport("kernel32.dll")]
    static extern void GetSystemInfo(out SYSTEM_INFO lpSystemInfo);

    [DllImport("kernel32.dll", SetLastError = true)]
    static extern int VirtualQueryEx(IntPtr hProcess, IntPtr lpAddress, out MEMORY_BASIC_INFORMATION lpBuffer, uint dwLength);

    // REQUIRED STRUCTS
    public struct MEMORY_BASIC_INFORMATION {
        public int BaseAddress;
        public int AllocationBase;
        public int AllocationProtect;
        public int RegionSize;
        public int State;
        public int Protect;
        public int lType;
    }

    public struct SYSTEM_INFO {
        public ushort processorArchitecture;
        ushort reserved;
        public uint pageSize;
        public IntPtr minimumApplicationAddress;
        public IntPtr maximumApplicationAddress;
        public IntPtr activeProcessorMask;
        public uint numberOfProcessors;
        public uint processorType;
        public uint allocationGranularity;
        public ushort processorLevel;
        public ushort processorRevision;
    }
    #endregion
} 
```

# flash - 如何在 Flash 中保存变量状态

> ID：437369
> 
> 赞同：0
> 
> 时间：2009-01-12T23:01:39.640
> 
> 标签：flash, actionscript, persistence

我对 Actionscript 完全陌生，我想弄清楚是否可以在 Flash 中保存变量状态。我想我可以使用 XML，但有没有办法将它存储在 Flash 文件本身中？谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-12T23:18:07.423

是的，查找[Shared Objects](http://livedocs.adobe.com/flex/3/html/help.html?content=05B_Security_15.html)。这就是它们的用途，无论是本地还是远程。

# php - PHP：区域设置感知数字格式

> ID：437371
> 
> 赞同：24
> 
> 时间：2009-01-12T23:02:40.700
> 
> 标签：php, internationalization

我想为我的网站访问者格式化数字 3253454。

如果我使用内置的 number_format 函数，我会得到：3,253,454，这对英国和美国来说非常有用，但是大多数其他国家/地区使用 3.253.454

我有很多国际访客。

谁能给我指点这里的最佳实践？

理想情况下，我希望获得浏览器的语言环境并相应地格式化数字。这在PHP中甚至可能吗？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2009-01-13T01:00:06.720

如果您正在部署一个本地化网站，您将需要确保您设置了[setlocale()](http://php.net/setlocale "设置语言环境（）")。为了重复 yaauie 的上述帖子，我将在您的初始化代码中添加类似以下代码片段的内容：

```
$locale = ( isset($_COOKIE['locale']) ) ? 
            $_COOKIE['locale'] : 
            $_SERVER['HTTP_ACCEPT_LANGUAGE'];
setlocale(LC_ALL, $locale); 
```

然后我们修改上面的函数`number_format_locale()`，看起来像这样：

```
function number_format_locale($number,$decimals=2) {
    $locale = localeconv();
    return number_format($number,$decimals,
               $locale['decimal_point'],
               $locale['thousands_sep']);
 } 
```

当然，这是在理想情况下，取决于您部署到的平台，以及您安装的语言环境文件的版本，您可能必须围绕一些违规行为编写代码。但是设置语言环境将有助于处理金钱、数字和日期。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2015-02-28T17:42:47.153

也许尝试独立于为所有脚本设置全局语言环境的方法？

**获取用户的语言环境：**

```
$locale = ( isset($_COOKIE['locale']) ) ? 
            $_COOKIE['locale'] : 
            $_SERVER['HTTP_ACCEPT_LANGUAGE']; 
```

**格式化数字：**

我推荐使用[PHP NumberFormatter](http://php.net/manual/en/class.numberformatter.php)。这是一种使用[ICU 库](http://php.net/manual/en/intro.intl.php)的 OOP 方法。

```
$formatStyle=NumberFormatter::DECIMAL;
$formatter= new NumberFormatter($locale, $formatStyle);
echo $formatter->format(3253454);//proper output depending on locale 
```

您可以在那里使用许多不同的样式格式，例如：DECIMAL、CURRENCY 或 PERCENT。[在这里](http://php.net/manual/en/class.numberformatter.php#intl.numberformatter-constants.unumberformatstyle)阅读更多。

这是数字格式化的最佳方式，因为它依赖于全局[Unicode Common Locale Data Repository](http://codel10n.com/what-is-cldr/)。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-01-12T23:06:15.483

```
string number_format (float $number, int $decimals, string $dec_point, string $thousands_sep) 
```

有关 number_format，请参见[php doku](http://de2.php.net/number_format)

另一个有用的链接可能是Zend Framework 中的[Zend_Locale](http://framework.zend.com/manual/en/zend.locale.html) - 它可以检测用户的语言并帮助数字/货币格式化

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2017-03-17T08:29:28.940

PHP 同时提供了一个非常适合此目的的 NumberFormatter 类：

[http://php.net/manual/de/class.numberformatter.php](http://php.net/manual/de/class.numberformatter.php)

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-01-12T23:08:04.060

从[http://us3.php.net/manual/en/function.number-format.php#76448](http://us3.php.net/manual/en/function.number-format.php#76448)：

```
<?php

    function strtonumber( $str, $dec_point=null, $thousands_sep=null )
    {
        if( is_null($dec_point) || is_null($thousands_sep) ) {
            $locale = localeconv();
            if( is_null($dec_point) ) {
                $dec_point = $locale['decimal_point'];
            }
            if( is_null($thousands_sep) ) {
                $thousands_sep = $locale['thousands_sep'];
            }
        }
        $number = (float) str_replace($dec_point, '.', str_replace($thousands_sep, '', $str));
        if( $number == (int) $number ) {
            return (int) $number;
        } else {
            return $number;
        }
    }

?> 
```

这似乎正是您正在寻找的。:)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-03-15T10:17:52.647

在我的项目中，我使用 Zend Framework。在这种情况下，我使用这样的东西：

```
$locale = new Zend_Locale('fr_FR');
$number = Zend_Locale_Format::toNumber(2.5, array('locale' => $locale));

// will return 2,5
print $number; 
```

* * *

## 回答 #7

> 赞同：-2
> 
> 时间：2009-01-12T23:27:23.787

您可以使用 HTTP_ACCEPT_LANGUAGE 服务器变量来猜测它们的语言环境和预期的数字格式。

如果我要实现这个，我会允许用户设置一个偏好来覆盖猜测，我的函数看起来像这样：

```
function number_format_locale($number,$decimals=2) {
    $locale = ( isset($_COOKIE['locale']) ? 
                    $_COOKIE['locale'] : 
                    $_SERVER['HTTP_ACCEPT_LANGUAGE']
               )
    switch($locale) {
        case 'en-us':
        case 'en-ca':
            $decimal = '.';
            $thousands = ',';
            break;
        case 'fr':
        case 'ca':
        case 'de':
        case 'en-gb':
            $decimal = ',';
            $thousands = ' ';
            break;
        case 'es':
        case 'es-mx':
        default:
            $decimal = ',';
            $thousands = ' ';
    }
    return $number_format($number,$decimals,$decimal,$thousands);
} 
```

# spring - Spring依赖注入或方面编程

> ID：437373
> 
> 赞同：2
> 
> 时间：2009-01-12T23:03:21.230
> 
> 标签：spring, aop

我需要几个类中的方法，这些方法必须始终遵循特定的前后模式。

公共无效方法（X x，Y y）{

// ************重复部分开始******************/

AFrameworkClass aFrameworkClass = new AFrameworkClass (this.memberVariable,"SomeString");

尝试 {

```
 aFrameworkClass.aFrameworkMethod( x,y); 
  aFrameworkClass.anotherFrameworkMethod(x,y); 
  aFrameworkClass.yetAnotherFrameworkMethod(x);   
  aFrameworkClass.doPreProcessing(); 

  Throwable t = null ; 
```

// ************重复部分结束 ******************/

```
 try { 
     // code will vary according to the business logic 
  } 
  catch (Throwable t) { 
     // code will vary according to the business logic   
  } 
```

// ************重复部分开始******************/

```
 aFrameworkClass.doPostProcessing(); 
```

} 最后 { aFrameworkClass.doCleanup();

}

// ************重复部分结束 ******************/

}

是否可以使用 Spring 框架来完成此方法中重复部分的逻辑，而不必在我的各种类中一遍又一遍地编写这些代码？如果有怎么办？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-12T23:13:41.177

绝对可以通过 Spring 的 AOP 支持来完成。您可以将第一部分应用为“之前”建议，将第二部分应用为“最终”建议，或者您可以将两者都应用为“围绕”建议并以编程方式调用目标方法，如下所示：

```
methodInvocation.invoke(); // returns Object 
```

如果你想在 XML 中声明你的切面，你可以在这里阅读如何做：

[http://static.springframework.org/spring/docs/2.5.x/reference/aop.html#aop-schema](http://static.springframework.org/spring/docs/2.5.x/reference/aop.html#aop-schema) [http://static.springframework.org/spring/docs/2.5.x/reference/aop.html #aop-schema-advice-before](http://static.springframework.org/spring/docs/2.5.x/reference/aop.html#aop-schema-advice-before) [http://static.springframework.org/spring/docs/2.5.x/reference/aop.html#aop-schema-advice-after-finally](http://static.springframework.org/spring/docs/2.5.x/reference/aop.html#aop-schema-advice-after-finally) [http://static.springframework.org /spring/docs/2.5.x/reference/aop.html#aop-ataspectj-around-advice](http://static.springframework.org/spring/docs/2.5.x/reference/aop.html#aop-ataspectj-around-advice)

或者如果你想用注释来做，这里有信息：

[http://static.springframework.org/spring/docs/2.5.x/reference/aop.html#aop-ataspectj](http://static.springframework.org/spring/docs/2.5.x/reference/aop.html#aop-ataspectj)

就我个人而言，我更喜欢使用 XML 来完成，因为可以在不重新编译应用程序的情况下更改方面的行为。假设您有一个多模块项目，其中 B 依赖于 A。A 包含可重用的建议，并且正在使用注释来处理订单、切入点等。如果您需要更改该行为，则必须重新构建 A。如果您在项目 B 中使用 XML要从项目 A 配置方面，不需要重建 A。

我的感觉是，当您在类中定义行为以及如何在 XML 中应用该行为时，建议更可重用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-12T23:25:20.513

作为成熟 IoC 容器的替代方案，您可以使用委托来实现相同的目的。设计一个具有前置和后置功能的基类以及一个委托来注入您不同的业务逻辑功能。“RunProcess”基类函数将调用前操作、委托，然后是后操作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-12T23:24:12.060

brd6644 是对的，但我发现的一件事是 Spring AOP 的一个问题是，在您创建对象时，建议/顾问无法应用于属性。

也就是说，说你有类似的东西

```
<bean class="...ProxyBeanFactory">
    <property name="target">
        <bean class="myBean">
            <property name="username" value="helloKitty"/>
            <property name="password" value="lkajdahdkahjdkhja"/>
        </bean>
     </property>
 </bean> 
```

不可能编写顾问程序来解密 myBean 的密码，因为在创建代理之前提供了属性值。当然，您不能将密码属性应用于 ProxyBeanFactory 类。您真正想要做的是使用“lkaj ...”参数对从 ProxyBeanFactory 返回的对象调用 setPassword()，但这似乎是不可能的。

# java - 通过 CLI 针对 Java 证书存储验证证书

> ID：437375
> 
> 赞同：10
> 
> 时间：2009-01-12T23:03:59.683
> 
> 标签：java, certificate, verification, keystore, keytool

如何通过命令行针对 Java 证书存储验证 X509（或 DER 格式）证书？

我已经研究过使用该`keytool`实用程序，但它看起来只处理导入/导出/显示功能（无验证）。

编辑：看起来好像`keytool`可以用于验证，但前提是尝试导入。我想问这个问题的更好方法是是否可以使用更被动的方法（例如：不修改密钥库）。谢谢！

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-01-23T18:00:07.067

您可以使用从 Java 密钥库`keytool`到`export`X.509 文件的所需证书（那些在您需要验证的链中的证书）。然后，将它们连接到一个文件中。最后，`openssl`用来做验证。

```
openssl verify -CAfile concatenated-certs.crt cert-to-verify.crt 
```

这不是一个完美的解决方案，因为它涉及将证书从信任库中弹出，但考虑到您的开始，它应该可以工作。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-14T17:12:52.247

此页面可能过于简单：

[http://java.sun.com/docs/books/tutorial/security/toolfilex/rstep1.html](http://java.sun.com/docs/books/tutorial/security/toolfilex/rstep1.html)

但看起来即使使用 keytool 导入也不会真正验证证书。我没有看到任何关于验证传入证书的签名与另一个受信任证书的签名的描述。

jarsigner 将验证签名 jar 上的签名，但不做任何事情来验证用于签署 jar 的证书上的签名。

恐怕您要么必须编写一个工具来进行验证，要么寻找一个商业工具来进行验证。我认为一些 PKI 工具包会有一个证书验证工具可以做到这一点。

# java - 相对文件路径在 Eclipse 中如何工作？

> ID：437382
> 
> 赞同：55
> 
> 时间：2009-01-12T23:06:58.507
> 
> 标签：java, eclipse, file-io, relative-path

所以我 2009 年的新年决心是学习 Java。我最近获得了“Java for Dummies”，并通过使用 Eclipse 重写了本书中的演示代码。无论如何，书中使用相对路径的每个示例似乎都没有读取它应该读取的 .txt 文件。

这是示例代码：

```
import java.util.Scanner;
import java.io.File;
import java.io.IOException;
import javax.swing.JFrame;
import javax.swing.JLabel;
import java.awt.GridLayout;

class TeamFrame extends JFrame {

    public TeamFrame() throws IOException {
        PlayerPlus player;
        Scanner myScanner = new Scanner(new File("Hankees.txt"));

        for (int num = 1; num <= 9; num++) {
            player = new PlayerPlus(myScanner.nextLine(), myScanner.nextDouble());
            myScanner.nextLine();
            addPlayerInfo(player);
        }      

        add(new JLabel());
        add(new JLabel("   ------"));
        add(new JLabel("Team Batting Aberage:"));
        add(new JLabel(PlayerPlus.findTeamAverageString()));
        setTitle("The Hankees");
        setLayout(new GridLayout(11,2));
        setDefaultCloseOperation(EXIT_ON_CLOSE);
        pack();
        setVisible(true);
    }

    void addPlayerInfo(PlayerPlus player) {
        add(new JLabel(player.getName()));
        add(new JLabel(player.getAverageString()));
    }
} 
```

你可以在下面的屏幕截图中看到我已经包含了这个文件。

*图像不再可用*

此外，我已经验证，当我构建应用程序时，Hankees.txt 的副本与已编译的 .class 文件一起放置在 bin 文件夹中。

最后，如果我将第 12 行更改为以下内容并将 Hankees.txt 放在我的 C:\ 驱动器的根目录中，则程序编译并运行良好。

```
Scanner myScanner = new Scanner(new File("C:\\Hankees.txt")); 
```

所以基本上，我的问题是我做错了什么？或者 Eclipse 是否以某种方式对此负责？

感谢您的任何帮助！

* * *

## 回答 #1

> 赞同：79
> 
> 时间：2009-01-12T23:10:25.130

你需要`"src/Hankees.txt"`

您的文件位于不计为工作目录的源文件夹中。\

或者您可以将文件移动到项目的根目录并使用`"Hankees.txt"`

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-01-12T23:37:43.563

项目的构建路径定义将源文件夹中的哪些资源复制到输出文件夹。通常这被设置为包括所有文件。

新的运行配置默认使用项目目录作为工作目录，尽管这也可以更改。

此代码显示了工作目录与加载类的位置之间的区别：

```
public class TellMeMyWorkingDirectory {
    public static void main(String[] args) {
        System.out.println(new java.io.File("").getAbsolutePath());
        System.out.println(TellMeMyWorkingDirectory.class.getClassLoader().getResource("").getPath());
    }
} 
```

输出可能类似于：

```
C:\your\project\directory
/C:/your/project/directory/bin/ 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-01-13T21:09:04.923

这与另一个问题非常相似。 [我应该如何将文件加载到我的 Java 应用程序中？](https://stackoverflow.com/questions/6639/how-should-i-load-files-into-my-java-application)

我应该如何将我的文件加载到我的 Java 应用程序中？

您**不想**通过以下方式加载文件：

```
C:\your\project\file.txt 
```

这很**糟糕！**

您应该使用 getResourceAsStream。

```
InputStream inputStream = YourClass.class.getResourceAsStream(“file.txt”); 
```

而且你应该使用**File.separator**；这是系统相关的名称分隔符，为方便起见表示为字符串。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-01-12T23:23:33.437

是的，出于路径的目的，eclipse 将顶级目录视为工作/根目录。

...只是想我会添加一些额外的信息。我是新来的！我愿意帮忙。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2017-07-25T06:13:05.527

您始终可以使用以下方法获取运行时路径：

```
 String path = new File(".").getCanonicalPath(); 
```

这提供了有关将文件和资源放在何处的宝贵信息。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-01-12T23:33:41.247

从[http://java.sun.com/javase/6/docs/api/java/io/File.html 解释](http://java.sun.com/javase/6/docs/api/java/io/File.html)：

下的类根据`java.io`当前用户目录解析相对路径名，该目录通常是启动虚拟机的目录。

Eclipse 将工作目录设置为顶级项目文件夹。

# c#-4.0 - Spec# 是否足够稳定可以使用？

> ID：437383
> 
> 赞同：6
> 
> 时间：2009-01-12T23:07:07.807
> 
> 标签：c#-4.0, design-by-contract, spec#

这里有人经常使用 Spec# 吗？在我开始到处使用它之前，我想知道它是否足够稳定和强大。看起来语法正在影响 c# 4.0，希望在 4.0 发布后更容易升级。想法？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-01-12T23:40:14.883

我想这取决于您所说的“稳定”是什么意思。有两种可能的解释：

1.  “不崩溃”
2.  “不变”

我不知道#1，但如果你的意思是#2，那么，[Spec#](http://Research.Microsoft.Com/SpecSharp/)已经被放弃并且不再被开发，所以这可能和你将得到的一样稳定。

[Spec#](http://Research.Microsoft.Com/SpecSharp/)中使用的技术和工具（名为[Boogie](http://Research.Microsoft.Com/Boogie/)的静态分析工具和定理证明器/约束求解器[Z3](http://Research.Microsoft.Com/projects/z3/)）现在是名为[Code Contracts for .NET](http://Research.Microsoft.Com/Contracts/)的新库的一部分。作为一个库的结果是代码契约适用于*任何*.NET 语言：C#、VB.NET、F#、Ruby、Python、JavaScript、Lisp、Smalltalk、Boo，应有尽有。缺点是你没有语言集成，所以合约没有好的语法。

.NET 的代码合同将成为 .NET 4.0 / Visual Studio 2010 的一部分，但不幸的是，微软的任何语言都不会支持 DbC。

# mysql - 选择字符串中除第一个字符之外的所有字符

> ID：437389
> 
> 赞同：4
> 
> 时间：2009-01-12T23:08:45.727
> 
> 标签：mysql, substring

如何返回一个字符串减去 MySQL 中字符串中的第一个字符？

换句话说，从“hello”中得到“hello”。

我能想到的唯一方法是使用 mid() ，第二个偏移量大于字符串可能是：

```
select mid('hello', 2, 99) 
```

但我相信一定有一种更优雅的方式来做到这一点。有没有？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-01-12T23:12:46.203

使用[`SUBSTR`](http://dev.mysql.com/doc/refman/5.0/en/string-functions.html#function_substr)（或`SUBSTRING`）：

```
SELECT SUBSTR( 'hello', 2 );
--> 'ello' 
```

*另请参阅：[MySQL 字符串函数](http://dev.mysql.com/doc/refman/5.0/en/string-functions.html)*

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-06T16:11:39.713

这实际上是不正确的。如果你这样做，你只会得到 llo。为了得到第一个字符之后的所有内容......请执行以下操作：

```
<?php
echo substr('hello', 1); // Output ello
echo '<br />';
echo substr('hello', 2); // Output llo
?> 
```

我只是想纠正这一点。

编辑：呸，别理我。我以为你在谈论PHP。不管怎样，你可以在 Mysql 中做到这一点。或者你可以像我上面发布的那样在 PHP 中得到它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-12T23:13:13.237

select substr('hello', 2) 怎么样？

# vb.net - 如何延迟 vb.net 程序直到文件操作完成？

> ID：437396
> 
> 赞同：3
> 
> 时间：2009-01-12T23:10:37.953
> 
> 标签：vb.net, timing, doevents

我有这个：

```
 Dim myTemp As String
    myTemp = System.DateTime.Now().ToString("MMMddyyyy_HHmmss") & ".pdf"

    System.IO.File.Copy(myFile, "c:\" & myTemp)
    Application.DoEvents()
    OpenFile(myTemp) 
```

问题是当我调用 OpenFile 时，它​​只是调用打开文件的子程序，它找不到文件。这是因为它调用它的速度非常快，以至于程序在打开之前没有时间实际创建文件。

我认为 DoEvents() 会纠正这个问题，但事实并非如此。在打开文件之前，我需要等到文件创建完成。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-12T23:32:15.867

我真的不太了解 VB.NET，但 Copy 不是阻塞调用吗？你确定你不只是试图从错误的位置打开文件（或者未转义的反斜杠使路径无效）？

那这个呢？我已将驱动器号添加到 OpenFile，并在两个地方都转义了反斜杠。

```
Dim myTemp As String
myTemp = System.DateTime.Now().ToString("MMMddyyyy_HHmmss") & ".pdf"

System.IO.File.Copy(myFile, "c:\\" & myTemp)
OpenFile("c:\\" & myTemp) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-12T23:24:48.643

理想情况下，您应该在一个单独的线程上执行复制，该线程在完成时通知主 GUI 线程，以便它可以通过 Invoke 调用执行打开。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-01-01T21:24:47.127

使用 FileSystemWatcher 在创建文件时提醒您。没有循环。

[https://web.archive.org/web/1/http://articles.techrepublic%2ecom%2ecom/5100-10878_11-6165137.html](https://web.archive.org/web/1/http://articles.techrepublic%2ecom%2ecom/5100-10878_11-6165137.html)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-07-22T15:46:00.463

这很难看，但对我有用

```
 Function WaitForFile(fullPath, wdelay)
    Dim vd_start As Date
    vd_start = Now()
    Dim vd_end As Date
    Dim wsec, wmin, whour, wt5string As Integer
    Dim wtstring As String
    Dim count As Integer
    Dim wscale As Integer
    Dim vd_1 As Date
    Dim Vo_fileinfo As FileInfo

    Dim fs As FileStream

    wsec = Format(wdelay Mod 60, "00")
    wmin = Format(Int(wdelay / 60), "00")
    whour = Format(Int(wdelay / (60 * 60)), "00")
    wtstring = CStr(whour) + ":" + CStr(wmin) + ":" + CStr(wsec)
    Dim duration = New System.TimeSpan(0, whour, wmin, wsec)
    vd_end = vd_start.Add(duration)

    On Error GoTo error1
    Dim vsize1, vsize2 As Long
    While vd_start < vd_end
        fs = New FileStream(fullPath, FileMode.Open)
        fs.ReadByte()
        fs.Seek(0, SeekOrigin.Begin)
        fs.Close()
        Vo_fileinfo = New FileInfo(fullPath)
        vsize1 = Vo_fileinfo.Length
        Threading.Thread.Sleep(500)
        Vo_fileinfo = New FileInfo(fullPath)
        vsize2 = Vo_fileinfo.Length
        If vsize1 <> vsize2 Then GoTo error1
        GoTo finalgoto
error1:
        Err.Clear()
        vd_start = Now()
    End While

    WaitForFile = False
    GoTo Endgoto
finalgoto: WaitForFile = True
Endgoto:
End Function 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-12T23:21:40.880

这有点hacky，但它应该可以工作。

```
Do Until (System.IO.File.Exists("C:\" & myTemp))
    Threading.Thread.Sleep(1)
Loop 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-12T23:24:44.977

这并不是 Doevents 的真正用途。它最常用于让 UI 消息队列清空（让 UI 有一些 CPU 时间来刷新）。它比我描述的要复杂一些，但这不是你问题的重点，所以我将继续。

试试这个来制作代码块的关键部分：

```
SyncLock Me
  System.IO.File.Copy(myFile, "c:\" & myTemp)
  Application.DoEvents()
End SyncLock

OpenFile(myTemp) 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-12T23:35:01.807

除了汤姆的回答之外，放置一个 Application.DoEvents() 而不是让线程休眠不是更好吗？

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-13T01:29:31.683

首先，您不应该在任何地方调用 DoEvents。在大多数情况下，当它被使用时，它是一种绕过真正应该是异步操作的技巧。

话虽如此，该`Copy`方法是*同步*操作。在调用完成`OpenFile`之前不会发生调用`Copy`。

话虽如此，当调用`OpenFile`发生时，如果文件不存在，那是因为您将其复制到了错误的位置，或者因为其他进程正在处理相关文件。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-01-13T09:07:32.447

我觉得 Synclock 不适合这种情况

为了解释，MSDN可以帮助我

> SyncLock 语句确保多个线程不会同时执行相同的语句。当线程到达 SyncLock 块时，它会计算表达式并保持这种排他性，直到它锁定表达式返回的对象。这可以防止表达式在多个线程运行期间更改值，这可能会从您的代码中产生意外的结果。

在我看来，复制是阻塞方法，所以线程一直等到复制完成

在其他地方不会有问题吗？

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2010-03-09T17:51:08.683

```
dim SourceFile as string
dim DestinationFile as string

SourceFile = "c:/archivo.txt"
DestinationFile = "c:/destino/archivo.txt"

If System.IO.File.Exists(SourceFile) = True Then

    System.IO.File.Copy(SourceFile, DestinationFile, True)
    'or
    'My.Computer.FileSystem.CopyFile(SourceFile, DestinationFile, FileIO.UIOption.AllDialogs, FileIO.UICancelOption.DoNothing)

    SourceFile = ""
    DestinationFile = ""

else

    MessageBox.Show("the file don't copy!") 

end if 
```

* * *

## 回答 #11

> 赞同：-1
> 
> 时间：2009-01-12T23:17:19.297

`System.Threading.Thread.Sleep(1000);`

# cygwin - 如何制作 cygwin 自动完成 Windows 路径？

> ID：437400
> 
> 赞同：9
> 
> 时间：2009-01-12T23:11:19.543
> 
> 标签：cygwin

我不想输入/cygdrive/c/path/to/stuff，尤其是在使用对cygwin一无所知的工具时。有没有办法将 cygwin 配置为自动完成“c:\path\to\stuff”甚至“c:/path/to/stuff”？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-01-12T23:22:12.457

对于无法理解 cygwin 路径的工具，您需要将它们转换为 windows 路径。该`cygpath`实用程序可以为您执行此操作：

```
notepad $(cygpath -w /cygdrive/c/path/to/stuff) 
```

您可能可以为常用的 Windows 可执行文件创建别名或包装脚本。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-12T23:19:12.320

自动完成应该在 /cygdrive/c 位之后工作。为“/cygdrive/c/”创建一个符号链接到其他东西，比如“ln -s /cygdrive/c /c”。另外，请确保您的 inputrc 设置正确。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-12T23:23:56.367

Windows 本身可以通过一些小的[注册表调整](http://www.gabrielserafini.com/archives/2004/10/26/windows-shell-auto-complete/)来自动完成路径。还是我在这个问题中遗漏了什么？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-05-17T08:28:26.063

使用别名：

打开已经复制到主目录中的 .bashrc 文件并输入（我为此使用“vi”编辑器，但您可以使用更简单的“pico”）：

```
alias C="C:\Documents\ and\ Settings\Administrator" 
```

你可以在这里使用任何路径。保存 .bashrc（我认为 pico 中为“Ctrl+X”，“vi”中为 :wq）并关闭终端。重新启动此控制台后，键入“C”并按 Enter 将自动将您发送到“C:\Documents and Settings\Administrator”

要知道您拥有哪个别名，只需在终端中输入“别名”，您的所有别名都会显示出来。

# c# - 在 C#/ASP.NET 中存储 SqlDataReader 对象？

> ID：437403
> 
> 赞同：0
> 
> 时间：2009-01-12T23:12:02.630
> 
> 标签：c#, asp.net, database, class, sqldatareader

我目前正在我的 ASP.NET (3.5) 应用程序中编写一个 C# 类来处理所有数据库查询。有一些方法可以对数据库进行选择查询。在方法内部，我只需要一个`SqlDataReader r = command.ExecuteReader();`来获取数据。

我现在想`r`被该方法返回，但是当我关闭数据库连接时，数据读取器关闭并且对象不再包含任何内容。考虑将所有内容放入字符串数组中，但如果我的数据库中混合了整数和文本字段，这是不切实际的。是否有一种简单的（“预制”）方法可以将数据存储在某个对象中以返回？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-12T23:15:50.767

您可以使用数据表和 SqlDataAdapter：

```
using(SqlDataAdapter adap = new SqlDataAdapter(cmd))
{
  adap.fill(myDataTable);
}

return myDataTable; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-12T23:18:24.773

通常，结果要么填充到集合中，要么填充到数据表中。从不必实例化对象和存储它们的角度来看，数据表更容易一些。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-12T23:30:10.147

你有没有想过为此使用 Linq 或类似[subsonic的 ORM](http://www.codeplex.com/subsonic)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-12T23:16:02.560

您可以将命令行为设置为关闭连接。然后当您调用 r.close 时，底层连接将关闭。

# java - 如何在 JavaFX 中使用 jFrames？

> ID：437413
> 
> 赞同：6
> 
> 时间：2009-01-12T23:14:52.750
> 
> 标签：java, swing, web-applications, javafx

我刚刚看到一篇关于在 JavaFX 中使用[Swing的文章。](http://javafx.com/samples/ExercisingSwing/index.html)如何将使用 jFrame 显示图形的应用程序移植到 JavaFX 中？另外，jButtons 和 jSliders 会以正常方式工作吗？

我知道这是一个通用问题，但我对 JavaFX 知之甚少，并且对通过 JavaFX 包将一些桌面应用程序移植到 Web 感到好奇。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-15T22:11:33.827

**javafx 文件：**

```
import javax.swing.JComponent;
import javafx.ext.swing.SwingComponent;

class NewFxComponent extends SwingComponent
{ 

    var comp: JComponent;

    public override function createJComponent():JComponent
    {
        return new OldJComponent();
    }

} 
```

# c++ - 用于原生 C++ 开发的 C++ Builder 或 Visual Studio？

> ID：437416
> 
> 赞同：15
> 
> 时间：2009-01-12T23:15:44.450
> 
> 标签：c++, visual-studio, c++builder

我已经决定要更多地使用 C++ 进行本机代码开发。我正在尝试决定使用 CodeGear C++ Builder 2009 还是 Visual Studio 2008 是否会更好。我目前使用 Delphi 2007，所以我对 C++ Builder 的 IDE（它与 Delphi 相同）以及VCL 和 RTL。

我从来都不是 MFC 的忠实粉丝（从我在 VS 6.0 时代第一次使用它开始），但从那时起就没有仔细研究过它。

我很想听听一些对这两种 IDE 都有经验的专家的意见，无论它们是否是最新版本。

现在，我倾向于 C++ Builder，因为我相信 VCL 比 MFC 更健壮且更易于使用 --- 但正如我所说，我已经有一段时间没有使用 MFC 了。我对构建依赖于 .NET Framework 的程序不感兴趣，因为我部分地自学了本地开发。MFC 仍然是 Windows C++ 的王者吗？还是 WTL 或 ATL 是大事？

有任何 C++ 大师想分享他们的意见吗？

**编辑**：我了解 MFC 不是 Visual Studio 的唯一 gui 工具包。但是，我正在寻找一些基于 GUI 工具包 + IDE 的建议。对于 C++ Builder，只有 1 个真正的选择，即 C++ Builder + VCL。对于 VS 2008，它是 VS + MFC/ATL/WTL/QT....让我很困惑，因为我对它们了解不多。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-01-12T23:25:24.057

来自 Delphi，您会发现 VCL 可以直接与 C++ Builder 一起使用。有一些奇怪的地方，比如 C++ 并没有隐藏 TObjects 都是真正的指针这一事实（Delphi 对你隐藏了），并且像数组属性这样的一些东西的访问方式不同。

两三年前，我一直在寻找摆脱 C++Builder 的任何方法，但现在，随着最近的发布（以及 Embarcadero 对 Codegear 的收购），我对产品和方向感到满意。

您会发现使用 C++Builder 时字符串类型的数量和各种潜在的不兼容性非常痛苦，但您会习惯的！（std::string、char[]、wchar_t[]、TCHAR、AnsiString、WideString、UnicodeString 和 String 等等）

就我个人而言，我会投票支持 C++ Builder - 因为双向 RAD 和 VCL，尽管它可能不是学习现代 C++ 习语的最佳方式。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-01-12T23:18:45.147

Visual Studio 和 MFC 不一样。我一直都在使用 Studio，并且像瘟疫一样避免使用 MFC。您可以使用 WTL、ATL、Win32 或任意数量的库来创建没有 MFC 的应用程序。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2009-01-13T00:20:06.643

简单的答案是，对于纯 C++ 开发，它必须是 VC++。

扩展：作为一个纯 C++ 开发环境，你根本无法击败 VC++，调试器更好，IDE 更优越（当然都是恕我直言）。由于这些原因，我用它来开发库，然后从 C++Builder 中使用这些库。

但是，一旦您开始进行 UI 开发，或者任何您可以使用 VCL 或组件 C++B 解决的问题，都是更好的选择。与 VCL 相比，MFC 或 ATL 相形见绌，因此您只能使用 .NET，这可能是一个更好的选择，但不是

我不确定我是否会根据供应商最近几年的“指导”来推荐使用 C++B 或 Delphi 构建新产品。然而，情况似乎正在好转，但直到再过一点时间，很难说这些承诺是如何变成现实的。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-01-13T13:02:35.310

如果您在 Windows 上进行纯 C++ 开发，那么很难击败 VS。编译器速度很快，非常符合标准，并且可以生成经过优化的代码。调试器是任何平台上最好的。IDE 没问题。

它显然也是 Windows 上支持最广泛的编译器工具链。下载任何开源项目/库，如果支持 Windows，它很可能是使用 VS 构建和测试的。它的受欢迎程度还确保它是简历中最有用的。

Builder给你什么？一个合理的 GUI 库。嗯，这很好，但还有许多其他不错的 GUI 工具包（wxWidgets、GTK、Qt 等）。许多是开源和跨平台的。

然而，这些天来，我发现重组我的应用程序以提供 API 并在其之上以不同的语言构建 GUI 会更好。C++ 的强项*不*在于 GUI 开发。至少今天不会……

我会选择 - 并推荐 - VS 而不是 Builder。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-01-13T01:05:07.410

我已经多年没有使用 C++ Builder，但在 C++ 调试方面，Visual Studio 2008 远远领先于其他 IDE 和以前的 VS，特别是如果您使用 STL 容器，因为它可以很容易地检查它们的内容。

然而，在 GUI 方面，C++ 现在对于微软来说是一种二流语言。未来的方式是 WPF，并且[不支持 C++ 作为 XAML 友好的语言](http://connect.microsoft.com/VisualStudio/feedback/ViewFeedback.aspx?FeedbackID=382151)：*我们将继续投资于 C++/CLI，以使开发人员能够将本机 C++ 资产暴露给托管世界，反之亦然。我们相信纯 .NET 开发最好使用以 .NET 为中心的语言，例如 C# 或 VB。对 C++/CLI 的投资将主要集中在本机管理的互操作领域。*

因此，要创建具有*现代外观的*C++ GUI，您的最佳选择可能确实是 VCL - 如果 VCL 继续使这成为可能 ;-)

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2010-02-25T10:51:27.163

在基于 UI 的开发和面向数据库的应用程序方面，C++ Builder 远远优于 MS-VS。MFC 太烂了！！但是 VS 有更好的调试能力。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-01-13T00:02:37.117

鉴于您已经了解 Delphi，我第二次选择 C++ Builder。自 VS6 时代以来，MFC 并没有太大变化，因此使用 MFC 编写的代码仍然看起来很糟糕。但是，VS 发生了变化，现在是一个相当不错的 IDE。

另外，请记住，C++ Builder 作为产品线并不稳定。过去有时它没有得到维护/它的未来尚不清楚等。所以如果你想建立一些持久的东西，你就会抓住机会。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-01-13T02:21:20.860

只是为了它，我们可以把 Eclipse 也加入其中吗？
我刚刚发现在 Eclipse 中工作比在 Visual Studio 中工作要好。

除非您将 VS2008 与 winforms 一起使用，否则 gui 支持是通过 windows 模板（通常来自资源），这是旧帽子，您可能不想使用。所以 VS2008 中的 gui 支持并没有那么特别。

至于 gui 工具包，或许可以看看[What is a good GUI/widgets toolkit](https://stackoverflow.com/questions/84057/what-is-a-good-gui-widget-toolkit-for-windows)

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-01-13T13:30:28.703

好吧，你可以使用 Eclipse + MinGW + Qt4 + QT Eclipse Integration 并获得所有东西：调试器、可视化 GUI 设计器等。

请注意，Qt4 是双重许可的：开源和商业许可。

您还可以将 Qt4 与 Visual Studio（甚至与 Express）结合使用，并使用 VS 为您提供的所有优点。

对我来说，Qt4 是要走的路，VS over Builder。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2009-05-04T11:39:19.220

几年前我喜欢 C++ Builder。太棒了。它的 VCL 比 VS 的糟糕 MFC 要好得多。然后事情每年都在变化。

Builder一直在下降；1\. Builder 没有更新任何真正的功能。2\. Borland 放弃了用 C++ 重写 VCL 以与 Kylix 和 Builder 3 一起使用的想法。CodeGear 的混乱和 Builder 的不确定未来使许多人放弃了该产品。

VS一直在变好；1\. IDE 改进了很多 2\. 从 windows 平台上最不符合标准的编译器变成了最符合标准的编译器（当然不包括 MinGW 上的 GCC） 3\. .NET 出现了，有 Managed C++，然后是 C++/ CLI 使在 C++ 中使用这个框架成为可能

我们有新的、强大的玩家 1\. Eclipse 2\. Qt Creator

和新的 GUI 工具包

1.  wxWidgets
2.  Qt4 现在也有开源许可证

总结；Builder 死了，因为 Borland

1.  以为德尔福太棒了，他们真的不需要任何其他东西来赚钱
2.  陷入Java炒作，投入过多资源
3.  不了解 C++ 的强大功能，而是堆栈到帕斯卡，帕斯卡一直是学术语言，没有用它创建过真正的产品

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-01-13T00:23:31.520

在 Windows 开发方面，没有什么比 Visual Studio 更胜一筹。它功能非常丰富，并且具有出色的调试器，更不用说庞大的用户社区来帮助您解决可能遇到的任何问题。如果一家公司为他们自己的操作系统开发的工具不是最好的，我会担心他们在软件世界中的地位。但是，如果您不需要额外的功能并且绝对需要具有拖放功能的 RAD 工具（除了 MFC），那么 C++ builder 也不会落后太多。事先使用 delphi 环境对您来说只是一个优势。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2009-01-13T08:20:41.823

关于 CodeGear 的最后一个 C++ Builder（我的意思是 2009 版本）的一件事是，它的更新真的会让你讨厌这个 IDE。
安装第二次更新后，我发现 if/else 块不能正常工作。它可以输入 IF 语句，但不能输入 else 语句——而且它不依赖于情况——这个语言指令根本就停止了工作。我花了大约两三个小时才弄明白——我开始在 VS 中开发所需的 win32 应用程序，我认为它比 CodeGear 产品更可靠。我不喜欢的第二个功能是你不能关闭 Unicode 支持并且必须明确使用 ANSI 版本的 win32 函数（例如 SendMessageA(...)），这很无聊。我几乎没有按时完成使用 VS2008 完成的工作。
这只是我的经验，做出的选择是你的

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2012-11-18T23:34:09.773

试试拉撒路。一次编写，多次编译。在多个平台上运行。任何来自 Delphi 和 Kylix 背景的人都会对这个 RAD 工具感到非常自在。至于未来，它是开源的，拥有强大的社区，发展将不受商业约束。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2018-06-29T05:55:19.127

对于本机 C++ 开发，我既不想使用 C++ Builder 也不想使用 VS。这些 IDE 都针对其框架的使用进行了优化。

我宁愿选择 Eclipse、Code::Blocks 或 Codelite。这些 IDE 没有针对任何框架进行优化，您可以在严重平台上的多个编译器之间切换。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2012-11-18T04:27:27.537

2012年即将结束。我是 Borland C++ 用户，然后转而使用 VC++ 6.0。最近有一个客户要求他们的产品有一个 GUI 端并且不希望依赖于 .NET 框架。所以我探索了 Embarcadero RAD Studio XE2。

当谈到 C++ RAD 开发时，我认为甚至 MSVC++ 都无法与之相提并论。就像一阵微风。虽然我在编译模板时发现了问题。例如，如果您定义了一个仿函数，并且想要将构造函数与仿函数调用结合起来，那么您不能在 C++B 中做到这一点，您必须创建一个对象，然后单独调用仿函数。还有其他问题，因为我无法完全编译 Poco 库。

我通过在 VC++ 中创建 DLL 并从 C++B 前端调用它们找到了解决方案。两者兼得。

我希望 Embarcadero 尽快赶上标准。

# c# - 使用 .NET 使用同一进程执行多个命令行

> ID：437419
> 
> 赞同：64
> 
> 时间：2009-01-12T23:16:47.613
> 
> 标签：c#, .net, command-line

我正在尝试执行多个命令而不每次都创建一个新进程。基本上，我想启动 DOS 命令 shell，切换到 MySQL 命令 shell，然后执行一个命令。这是我调用该过程的方式（也在下面）。另外，如何处理命令中的“\”？

```
ExecuteCommand("mysql --user=root --password=sa casemanager", 100, false);

ExecuteCommand(@"\. " + Environment.CurrentDirectory + @"\MySQL\CaseManager.sql", 100, true);

private void ExecuteCommand(string Command, int Timeout, Boolean closeProcess)
{
    ProcessStartInfo ProcessInfo;
    Process Process;

    ProcessInfo = new ProcessStartInfo("cmd.exe", "/C " + Command);
    ProcessInfo.CreateNoWindow = false;
    ProcessInfo.UseShellExecute = false;
    Process = Process.Start(ProcessInfo);
    Process.WaitForExit(Timeout);

    if (closeProcess == true) { Process.Close(); }
} 
```

* * *

## 回答 #1

> 赞同：82
> 
> 时间：2009-01-12T23:23:46.867

您可以重定向标准输入并使用 StreamWriter 对其进行写入：

```
 Process p = new Process();
        ProcessStartInfo info = new ProcessStartInfo();
        info.FileName = "cmd.exe";
        info.RedirectStandardInput = true;
        info.UseShellExecute = false;

        p.StartInfo = info;
        p.Start();

        using (StreamWriter sw = p.StandardInput)
        {
            if (sw.BaseStream.CanWrite)
            {
                sw.WriteLine("mysql -u root -p");
                sw.WriteLine("mypassword");
                sw.WriteLine("use mydb;");
            }
        } 
```

* * *

## 回答 #2

> 赞同：54
> 
> 时间：2013-04-12T14:13:38.950

```
const string strCmdText = "/C command1&command2";
Process.Start("CMD.exe", strCmdText); 
```

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2009-01-12T23:21:39.930

您不能将所有命令写入临时文件夹中的 .cmd 文件，然后执行该文件吗？

* * *

## 回答 #4

> 赞同：14
> 
> 时间：2019-01-03T05:53:12.990

正如另一个答案暗示在较新版本的 Windows 下，似乎有必要读取标准输出和/或标准错误流，否则它将在命令之间停止。代替使用延迟的一种更简洁的方法是使用异步回调来使用流的输出：

```
static void RunCommands(List<string> cmds, string workingDirectory = "")
{
    var process = new Process();
    var psi = new ProcessStartInfo();
    psi.FileName = "cmd.exe";
    psi.RedirectStandardInput = true;
    psi.RedirectStandardOutput = true;
    psi.RedirectStandardError = true;
    psi.UseShellExecute = false;
    psi.WorkingDirectory = workingDirectory;
    process.StartInfo = psi;
    process.Start();
    process.OutputDataReceived += (sender, e) => { Console.WriteLine(e.Data); };
    process.ErrorDataReceived += (sender, e) => { Console.WriteLine(e.Data); };
    process.BeginOutputReadLine();
    process.BeginErrorReadLine();
    using (StreamWriter sw = process.StandardInput)
    {
        foreach (var cmd in cmds)
        {
            sw.WriteLine (cmd);
        }
    }
    process.WaitForExit();
} 
```

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2020-01-17T16:00:57.487

我更喜欢使用 BAT 文件来完成。

使用 BAT 文件，您拥有更多控制权，可以为所欲为。

```
string batFileName = path + @"\" + Guid.NewGuid() + ".bat";

using (StreamWriter batFile = new StreamWriter(batFileName))
{
    batFile.WriteLine($"YOUR COMMAND");
    batFile.WriteLine($"YOUR COMMAND");
    batFile.WriteLine($"YOUR COMMAND");
}

ProcessStartInfo processStartInfo = new ProcessStartInfo("cmd.exe", "/c " + batFileName);
processStartInfo.UseShellExecute = true;
processStartInfo.CreateNoWindow = true;
processStartInfo.WindowStyle = ProcessWindowStyle.Normal;

Process p = new Process();
p.StartInfo = processStartInfo;
p.Start();
p.WaitForExit();

File.Delete(batFileName); 
```

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2012-08-22T00:20:34.977

```
ProcessStartInfo pStartInfo = new ProcessStartInfo();
pStartInfo.FileName = "CMD";
pStartInfo.Arguments = @"/C mysql --user=root --password=sa casemanager && \. " + Environment.CurrentDirectory + @"\MySQL\CaseManager.sql"
pStartInfo.WindowStyle = ProcessWindowStyle.Hidden;
Process.Start(pStartInfo); 
```

这`&&`是告诉命令 shell 有另一个命令要执行的方法。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-01-12T23:25:50.153

`cmd.exe`这样的命令行进程`mysql.exe`通常会读取（并执行）您（用户）（在键盘上）输入的任何内容。

为了模仿这一点，我认为您想使用该`RedirectStandardInput`属性：http: [//msdn.microsoft.com/en-us/library/system.diagnostics.processstartinfo.redirectstandardinput.aspx](http://msdn.microsoft.com/en-us/library/system.diagnostics.processstartinfo.redirectstandardinput.aspx)

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-01-12T23:26:19.903

您还可以告诉 MySQL 执行给定文件中的命令，如下所示：

```
mysql --user=root --password=sa casemanager < CaseManager.sql 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2014-07-06T07:55:55.833

You need to READ ALL data from input, before send another command!

And you can't ask to READ if no data is avaliable... little bit suck isn't?

My solutions... when ask to read... ask to read a big buffer... like 1 MEGA...

And you will need wait a min 100 milliseconds... sample code...

```
Public Class Form1

    Private Sub Button1_Click(sender As Object, e As EventArgs) Handles Button1.Click
        Dim oProcess As New Process()
        Dim oStartInfo As New ProcessStartInfo("cmd.exe", "")
        oStartInfo.UseShellExecute = False
        oStartInfo.RedirectStandardOutput = True
        oStartInfo.RedirectStandardInput = True
        oStartInfo.CreateNoWindow = True
        oProcess.StartInfo = oStartInfo
        oProcess.Start()

        Dim Response As String = String.Empty
        Dim BuffSize As Integer = 1024 * 1024
        Dim x As Char() = New Char(BuffSize - 1) {}
        Dim bytesRead As Integer = 0

        oProcess.StandardInput.WriteLine("dir")
        Threading.Thread.Sleep(100)
        bytesRead = oProcess.StandardOutput.Read(x, 0, BuffSize)
        Response = String.Concat(Response, String.Join("", x).Substring(0, bytesRead))

        MsgBox(Response)
        Response = String.Empty

        oProcess.StandardInput.WriteLine("dir c:\")
        Threading.Thread.Sleep(100)
        bytesRead = 0
        bytesRead = oProcess.StandardOutput.Read(x, 0, BuffSize)
        Response = String.Concat(Response, String.Join("", x).Substring(0, bytesRead))

        MsgBox(Response)

    End Sub
End Class 
```

# asp.net - ASP.NET 2.0 - 验证同一页面上的不可见控件？

> ID：437422
> 
> 赞同：1
> 
> 时间：2009-01-12T23:17:25.193
> 
> 标签：asp.net, validation

我有一个使用RequiredFieldValidator 控件和ValidationSummary 的应用程序，一旦单击“完成”按钮，所有字段都会被验证。这个页面有几个不同的部分，它们是可见的或不可见的，我注意到验证器只激活可见控件而忽略不可见的控件。这是我的程序使用的有用功能。

然而....

我需要验证不可见的控件，因为我将一个长页面的部分拆分为多个段。所以我想知道是否有一种方法可以手动强制在 Page.IsValid 上验证可见 = false 验证控件（或不可见表的一部分等），而不必让它们再次可见？

提前致谢！

PS 我尝试使用 ValidationGroup 属性来查看是否会捕获它们，但没有。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-13T07:57:12.213

如果控件不是 .Visible 则 html 不存在进行验证。不要设置 Control.Visible = false，而是尝试设置一个 css 类来隐藏它。

在您的样式表中：

```
.invisible { visibility:hidden; } 
```

然后代替 .Visible = false 使用：

```
Control.CssClass = "invisible"; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-12T23:54:42.983

如果页面被分成多个段并且只显示页面的一部分，你不能验证显示新段的方法吗？控件的有效状态一旦变为不可见就不应受到影响。（除非我猜有依赖关系。）。

不要让他们使用无效输入切换页面的各个部分。

另一种方法是使用 css 使控件不可见，而不是服务器端。控件可以在带有 display: none 的 div 中；所有控件都将与验证摘要一起呈现。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-13T06:40:22.460

如果您使这些控件在服务器端不可见，那么它们甚至不会在客户端上呈现以进行验证。

您是否使用 AJAX 在您的部分之间切换/使控件不可见？如果是这样，那么您可能应该在将控件切换为不可见之前验证那些部分页面回发上的控件（如 Jeff Martin 建议的那样）。

我认为我们需要更多关于您如何执行此操作的信息，以便为您提供一个好的答案。

* * *

好吧，所以没有 AJAX（根据您的评论）...如果您使用的是 ASP.NET 验证控件，它们有一个客户端部分和一个服务器端部分。您可以在代码隐藏的事件处理程序中查看验证器是否有效。您可能必须做一些特定的事情来让他们在服务器端触发他们的验证代码，并且您的不可见控件可能不会在多个回发之间保留它们的值。但这应该是可行的。

这里的要点是可以设置 ASP.NET 验证控件，因此它们不会在客户端执行任何操作，但它们仍然提供验证服务器端。你基本上就在那条船上。

我认为[这篇 MSDN 文章](http://msdn.microsoft.com/en-us/library/dh9ad08f.aspx)有你所需要的一切。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-14T16:05:03.693

作为对 Mike Comstock 帖子的第二条评论的回应（我还没有足够的声誉来发表评论：（）...

删除间距尝试：

```
.invisible { visibility:hidden; display:none; } 
```

# c++ - 有没有办法找到一个dll暴露的所有功能

> ID：437432
> 
> 赞同：68
> 
> 时间：2009-01-12T23:20:39.650
> 
> 标签：c++, c, winapi, dll

我一直在寻找一种方法来获取映射到 dll 中函数名称的所有字符串。

我的意思是所有可以调用GetProcAddress 的字符串。如果您对 dll 进行十六进制转储，则符号（字符串）就在那里，但我认为必须有一个系统调用来获取这些名称。

* * *

## 回答 #1

> 赞同：78
> 
> 时间：2009-01-12T23:22:35.997

如果您有 MS Visual Studio，则有一个名为 DUMPBIN 的命令行工具。

```
dumpbin /exports <nameofdll>
```

* * *

## 回答 #2

> 赞同：35
> 
> 时间：2009-01-13T11:01:42.027

Windows 下存在三种不同类型的 DLL：

1.  在 DLL 的导出表中公开每个可用函数的经典 DLL。您可以使用 Visual Studio 中的 dumpbin.exe 或 depends.exe，或免费的[依赖](http://www.dependencywalker.com/)项遍历器来检查这些类型。Matt Pietrek 写了许多文章和实用程序来挖掘 Win32 PE 文件。看看他的经典[MSDN 杂志文章](http://msdn.microsoft.com/en-us/magazine/cc301805.aspx)。包含导出类的 C++ DLL 将导出类中的每个方法。不幸的是，它导出了损坏的名称，因此 dumpbin 的输出实际上是不可读的。您将需要使用像 vc++_filt.exe 这样的程序来对输出进行解码。

2.  公开 COM 对象的 COM DLL。这些 DLL 公开了一些常规导出函数（DllRegisterServer 等），使 COM 系统能够实例化对象。有许多实用程序可以查看这些 DLL，但除非它们具有嵌入式类型库，否则它们可能很难检查。~~[4](http://www.4developers.com/)开发人员有许多优秀的 COM/ActiveX 工具~~

3.  包含 .NET 程序集的 .NET DLL。通常，您会使用[.NET Reflector](http://www.red-gate.com/products/reflector/)之类的工具来深入研究这些内容。

*编辑：4Developers 链接不起作用。*

* * *

## 回答 #3

> 赞同：26
> 
> 时间：2009-01-12T23:24:21.140

[在http://www.dependencywalker.com/](http://www.dependencywalker.com/)还有 DEPENDs 计划

* * *

## 回答 #4

> 赞同：17
> 
> 时间：2012-06-04T13:01:03.980

试试这个（Linux）C代码：

```
#include <fcntl.h>
#include <stdio.h>
#include <sys/mman.h>
#include <sys/stat.h>
#include <sys/types.h>
#include <unistd.h>

unsigned int vpe2offset(void * base, unsigned int vpe) {
    unsigned int * ptr = base;
    unsigned int pe_offset;
    unsigned short num_sections;

    pe_offset = ptr[0x3c/4];                             //PE header offset
    ptr = base + pe_offset;                              //PE header address
    num_sections = ((unsigned short*)ptr)[6/2];          //Section count
    ptr = ((void*)base) + 0x18 + 0x60 + 16*8 + pe_offset;//Address of first section

    while (num_sections--) {
        if (vpe >= ptr[0x0c/4] && vpe < ptr[0x0c/4] + ptr[0x10/4]) {
            return vpe - ptr[0x0c/4] + ptr[0x14/4];
        }
        ptr += 0x28/4;
    }

    return 0;
}

void iterate_exports(void * base, int(*iterator)(char*)) {
    unsigned int * ptr = base;
    unsigned int pe_offset,
                 exports_offset,
                 number_of_names,
                 address_of_names;

    pe_offset = ptr[0x3c/4];
    ptr = base + pe_offset;
    exports_offset = ptr[0x78/4];
    ptr = base + vpe2offset(base, exports_offset);
    number_of_names = ptr[0x18/4];
    address_of_names = ptr[0x20/4];
    ptr = base + vpe2offset(base, address_of_names);
    while (number_of_names-- && iterator((char*)(base + vpe2offset(base, ptr++[0])))) {
        /* Do nothing */
    }
}

int print_symbol_name(char * name) {
    printf("%s\n", name);
    return 1;
}

int main(int argc, char const *argv[]) {
    int fd;
    struct stat st;
    void * base;

    if (argc == 1) {
        printf("Usage: %s <dll>\n", argv[0]);
    } else if (stat(argv[1], &st) == 0 && (fd = open(argv[1], O_RDONLY)) >= 0) {
        base = mmap(NULL, st.st_size, PROT_READ, MAP_PRIVATE, fd, 0);
        if (base != MAP_FAILED) {
            iterate_exports(base, print_symbol_name);
            munmap(base, st.st_size);
        } else {
            fprintf(stderr, "Could not map \"%s\".\n", argv[1]);
        }
        close(fd);
    } else {
        fprintf(stderr, "Could not open \"%s\" for reading.\n", argv[1]);
    }
    return 0;
} 
```

它遵循 PE 文件中的引用，最后为每个导出的符号调用回调函数。有关 PE 文件格式的概述，请参见：[http ://www.openrce.org/reference_library/files/reference/PE%20Format.pdf](http://www.openrce.org/reference_library/files/reference/PE%20Format.pdf)

* * *

## 回答 #5

> 赞同：10
> 
> 时间：2009-01-12T23:33:55.600

我不知道 WIn32 API 可以做到这一点：相反，您（或其他帖子中提到的工具之一）通过了解 PE 文件的二进制格式并读取文件来做到这一点：请参阅[http://msdn .microsoft.com/en-us/magazine/cc301808.aspx](http://msdn.microsoft.com/en-us/magazine/cc301808.aspx)（那篇文章提到了“PEDUMP”实用程序）。

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2009-01-14T16:42:24.553

这需要一些工作，但您可以使用 Microsoft 的[DbgHelp](http://msdn.microsoft.com/en-us/library/ms679291(VS.85).aspx "MSDN：DbgHelp 调试库")库以编程方式完成此操作。

[John Robbins 所著的 Debugging Applications for Microsoft .Net 和 Microsoft Windows](https://rads.stackoverflow.com/amzn/click/com/0735615365 "亚马逊：为 Microsoft .Net 和 Microsoft Windows 调试应用程序")是一本极好的（如果有点旧的话）书籍，其中包含使用细节和完整的源代码。而且，您可以在亚马逊上以便宜的价格购买它！

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2009-01-12T23:25:24.570

我使用[dumpbinGUI](https://sourceforge.net/projects/c-sharp/files/dumpbinGUI/)，它通过在 Windows 资源管理器中右键单击为您提供导出列表（以及更多）。`dumpbin`并且`depends`都会给你列表。

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2009-01-13T00:42:44.400

您需要检查 .dll 的 PE 标头，因为这最终是 Windows 所做的。

假设你有一个指向 .dll 的指针`IMAGE_OPTIONAL_HEADER`（你可以使用 dbghelp 的`ImageNtHeader`函数和一个加载的 .dll 的句柄，`LoadLibrary`或者如果你自己知道 .dll 的布局，你可以尝试自己找到它），你会想看看`optional_header->DataDirectory[IMAGE_DIRECTORY_ENTRY_EXPORT]`，找到相对于带有偏移量的可选标题的导出表，然后遍历导出表（它是 a `IMAGE_EXPORT_DIRECTORY`）。

有趣的是，向后兼容的 PE 映像以`IMAGE_DOS_HEADER`;开头。is的偏移量`IMAGE_NT_HEADER`，`IMAGE_DOS_HEADER::e_lfanew`并且`IMAGE_OPTIONAL_HEADER`嵌入在 NT 标头中。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2009-01-13T02:28:49.600

您可以使用一个名为 dll 导出查看器的程序：http: [//www.nirsoft.net/utils/dll_export_viewer.html](http://www.nirsoft.net/utils/dll_export_viewer.html)

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2010-08-06T10:42:24.337

我总是必须这样做。我只是去这些网站之一。他们托管我们通常需要的信息。

[Windows 7 DLL 文件信息](http://www.win7dll.info/)

[Windows XP DLL 文件信息](http://xpdll.nirsoft.net/)

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2017-04-07T18:08:14.660

也可以使用windows下的“objdump”linux工具，不过可能要先安装cygwin。

我使用以下命令：

```
# feed the output to less
objdump -x nameOfThe.Dll| less
# or use egrep to filter
objdump -x /cygdrive/c/Windows/system32/user32.dll | \ 
    egrep "^\s*\[[ [:digit:]]{4}\] \w{1,}" | less 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-01-12T23:59:16.903

如果您想在运行时或极其无用的系统（“dumpbin”）中找到未知 dll 的函数名，我猜您最终会解析 PE 文件并自己进行解构；魔法。

你应该更清楚你想要什么。

[BFD](http://sourceware.org/binutils/docs/bfd/index.html)库可以满足您的需求（以及厨房水槽），它是几个 GNU binutils 工具的主要组件。我不能确定它是否适合你的问题。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-01-13T06:17:21.773

您不需要任何工具，也不需要解析 PE。只需使用标准 Win32 api (D)

该代码（C 语言）已在 Adv.Win32 api ng ( news://comp.os.ms-windows.programmer.win32) 上多次发布（自 1992 年以来...）

# linux - 在 Linux 中限制用户可用的内存和 CPU

> ID：437433
> 
> 赞同：24
> 
> 时间：2009-01-12T23:21:33.750
> 
> 标签：linux, memory-management, cpu-usage, pam

我有点担心我可以在共享机器中使用的资源量。有什么方法可以测试管理员对我可以使用的资源数量是否有限制？如果是这样，为了提出一个更完整的问题，我该如何设置这样的限制？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-01-12T23:29:47.323

对于流程相关的限制，您可以查看`/etc/security/limits.conf`（阅读文件中的评论，使用谷歌或使用`man limits.conf`获取更多信息）。正如 jpalecek 指出的那样，您可以使用`ulimit -a`来查看（并可能修改）当前有效的所有此类限制。

您可以使用该命令`quota`查看磁盘配额是否生效。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-01-13T00:19:21.530

你可以试试跑步

```
ulimit -a 
```

查看有效的资源限制。此外，如果允许您更改此类限制，您可以通过`ulimit`命令更改它们，例如。

```
ulimit -c unlimited 
```

取消了进程可以创建的核心文件大小的任何限制。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2021-03-31T16:31:15.610

在 C 级别，相关函数（实际上是[syscalls(2)](https://man7.org/linux/man-pages/man2/syscalls.2.html) ...）可以是[setrlimit(2)](https://man7.org/linux/man-pages/man2/setrlimit.2.html)和[setpriority(2)](https://man7.org/linux/man-pages/man2/setpriority.2.html)和[sched_setattr(2)](https://man7.org/linux/man-pages/man2/sched_setattr.2.html)。您可能希望从您的 shell 中调用它们。

另请参见[proc(5)](https://man7.org/linux/man-pages/man5/proc.5.html) - 和 try`cat /proc/self/limits`和[sched(7)](https://man7.org/linux/man-pages/man7/sched.7.html)。

您可能需要使用[renice(1)](https://man7.org/linux/man-pages/man1/renice.1.html)命令。

如果您运行不需要用户交互的长时间程序（几个小时），您可以考虑使用一些[批处理](https://en.wikipedia.org/wiki/Batch_processing)。一些 Linux 系统有一个[`batch`or`at`命令](https://en.wikipedia.org/wiki/At_(command)#batch)。

# iphone - iPhone 上的原生 Google 地图应用程序支持哪些 KML 字段？

> ID：437441
> 
> 赞同：3
> 
> 时间：2009-01-12T23:23:13.110
> 
> 标签：iphone, google-maps, kml

我一直在对在 iPhone 应用程序中使用地图进行一些研究，看起来我的大部分需求都可以通过将 KML 数据传递到内置的谷歌地图应用程序中来满足，但我似乎无法设置相同的值（电话、主页、地址）在地图应用程序中执行内置搜索时可用。有谁知道是否有任何方法可以设置这些值，或者哪些字段可用？

更新：随着 3.0 操作系统和 Map API 的出现，应用程序不再需要将控制权传递给内置地图应用程序，因此这个问题不再相关。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-13T00:28:17.737

目前，Apple 尚未正式支持 KML。它在 URL 方案文档中指定。?q= 参数中的任何 URL 都将被忽略。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-13T00:46:11.600

计划在其软件中使用 Google 地图的 iPhone 开发人员几乎没有可用的选项。我已经看到了 WebKit 的示例代码和实现，它们将手势转换为加载在其中的 Google 地图，但性能充其量是令人沮丧的。在没有大量缩放或滚动的情况下制作静态地图几乎是在原生 API 可用之前唯一能保持性能的选项。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-13T03:14:36.043

看看[使用 Objective-C 开发虚拟地球 iPhone 应用程序](http://blogs.msdn.com/virtualearth/archive/2008/11/13/developing-virtual-earth-iphone-applications-with-objective-c.aspx)

# installation - windows安装挂起

> ID：437469
> 
> 赞同：0
> 
> 时间：2009-01-12T23:31:50.767
> 
> 标签：installation, windows-installer

我怎样才能找到在 Windows 盒子上挂着所有新安装的东西？

在 Windows（XP Pro，如果重要的话）上测试安装脚本时，我遇到了这样一种情况，即任何和所有在系统上安装任何东西的尝试都挂起等待谁知道什么。当系统重新启动时，所有排队的安装尝试都将通过其退出路径，并弹出报告安装由于已请求关闭系统而中止的弹出窗口。当然，重启并不能解决问题。否则系统运行良好。

那么...我如何确定我嵌入了操作系统的哪一部分？（我想，注册表中的某些内容，但在涉及 Windows 时，我是一个真正的新手。）最有可能的是，之前的安装尝试中的某些内容出错了，即使我没有看到任何错误报告，现在也被阻止了。一旦我弄清楚这一点，我想检查这种事情，可能在我的安装脚本的两端，如果这看起来合理的话。

感谢您的输入。

更新：对我来说不幸的是，从头开始重建到现在的系统大约需要 9 个小时。我想将它从现在的位置松开，而不是重新加载（再次）。Procmon 看起来不错，但我没有安装 SP2，只有 SP1！-皱眉-所以，欢迎其他想法。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-13T00:12:03.010

我假设您已经尝试[记录安装](http://www.pctools.com/guides/registry/detail/1127/)以查看哪里出了问题？

尝试使用“系统还原”回滚到出现问题之前，如果这不能解决问题并且 MSI 日志文件显示没有任何用处，那么我会冒险并重新加载，然后再浪费时间。

也就是说，如果您正在开发安装程序，那么在这台糟糕的状态下拍摄这台 PC 的图像可能是值得的练习。将来某个时候，当您有更多时间进行调试时，您可以尝试找出问题所在。

*PS我假设您是从开发安装程序的人的角度提出这个问题，而不是作为技术支持问题......否则这个问题可能应该作为与编程无关的问题被关闭；）*

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-12T23:35:20.493

尝试使用[Procmon](http://technet.microsoft.com/en-us/sysinternals/bb896645.aspx)找出安装程序出现问题的位置，如果您设置过滤器，它将报告该进程的所有文件和注册表活动。

# c - 用于表示 ANSI (C89/90) C 中的字节的类型？

> ID：437470
> 
> 赞同：35
> 
> 时间：2009-01-12T23:31:52.187
> 
> 标签：c, types, c89

是否有标准投诉方法来表示 ANSI (C89/90) C 中的字节？我知道，大多数情况下，一个字符恰好是一个字节，但我的理解是，不能保证是这种情况。另外，C99 标准中有 stdint.h，但 C99 之前使用的是什么？

我对 8 位和一个“字节”（sizeof(x) == 1）都很好奇。

* * *

## 回答 #1

> 赞同：68
> 
> 时间：2009-01-13T00:59:40.543

`char`始终是**byte**，但并不总是**octet**。一个字节是最小的可寻址内存单元（在大多数定义中），一个八位字节是 8 位内存单元。

也就是说，对于所有实现，`sizeof(char)`始终为**1**`CHAR_BIT` ，但宏`limits.h`定义了平台的字节大小，并不总是 8 位。有 16 位和 32 位字节的平台，因此`char`会占用更多位，但它仍然是一个字节。由于所需的范围`char`至少为 -127 到 127（或 0 到 255），因此在所有平台*上至少为*8 位。

> # ISO/IEC 9899:TC3
> 
> ## 6.5.3.4 sizeof 运算符
> 
> 1.  ...
> 2.  sizeof 运算符产生其操作数的大小（**以字节**为单位），它可以是表达式或带括号的类型名称。[...]
> 3.  当应用于具有 , 或 , 类型（或其限定版本）的操作数时`char`，`unsigned char`结果`signed char`为**1**。[...]

强调我的。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-01-13T00:38:19.603

您始终可以在无符号字符中表示一个字节（如果您的意思是 8 位）。它的大小始终至少为 8 位，所有位都构成了该值，因此 8 位值将始终适合它。

如果你想要 8 位，我也认为你必须使用平台相关的方式。POSIX 系统似乎[需要](http://www.opengroup.org/onlinepubs/000095399/basedefs/stdint.h.html)支持 int8_t。这意味着在 POSIX 系统上，char（因此是一个字节）总是 8 位。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-13T01:24:29.823

在 ANSI C89/ISO C90 中 sizeof(char) == 1。但是，1 字节并不总是 8 位。如果您想计算 1 个字节中的位数（并且您无权访问 limits.h），我建议如下：

```
unsigned int bitnum(void) {
    unsigned char c = ~0u; /* Thank you Jonathan. */
    unsigned int v;

    for(v = 0u; c; ++v)
        c &= c - 1u;
    return(v);
} 
```

*这里我们使用 Kernighan 的方法来计算c*中设置的位数。为了更好地理解上面的代码（或查看其他类似的代码），我建议您参考“ [Bit Twiddling Hacks](http://graphics.stanford.edu/~seander/bithacks.html "Bit Twiddling Hacks") ”。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-12T23:34:38.687

在C99之前？平台相关代码。

但你为什么在乎？只需使用 stdint.h。

在使用的每个 CI 实现中（从旧的 UNIX 到硬件工程师编写的嵌入式编译器再到大供应商的编译器）`char`一直是 8 位的。

* * *

## 回答 #5

> 赞同：-3
> 
> 时间：2009-01-12T23:35:11.617

你可以在 boost 中找到相当可靠的宏和 typedef。

* * *

## 回答 #6

> 赞同：-5
> 
> 时间：2011-06-12T02:24:09.363

我注意到有些回答已将单词字节重新定义为 8 位以外的含义。一个字节是 8 位，但是在某些 c 实现中 char 是 16 位（2 字节）或 8 位（1 字节）。将字节称为“最小可寻址内存单元”或某些此类垃圾的人已经失去了对字节（8位）含义的理解。C 的一些实现有 16 位字符（2 个字节）和一些有 8 位字符（1 个字节），并且没有称为“字节”的标准类型的原因是由于懒惰。

所以，我们应该使用 int_8

# python - 终端输出安全逃生功能

> ID：437476
> 
> 赞同：2
> 
> 时间：2009-01-12T23:33:46.503
> 
> 标签：python, terminal, escaping

我正在寻找相当于终端输出的[urlencode](http://docs.python.org/library/urllib.html#urllib.quote_plus) - 我需要确保我（可能）从外部源打印的垃圾字符不会最终对我的终端做一些时髦的事情，所以一个预先打包的函数来逃避特殊字符序列将是理想的。

我在 Python 中工作，但我可以轻松翻译的任何东西也可以。蒂亚！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-12T23:49:53.880

不幸的是，“终端输出”是一个非常不明确的过滤标准（参见[问题 418176](https://stackoverflow.com/questions/418176/why-does-pythons-string-printable-contains-unprintable-characters)）。我建议简单地将您想要允许的字符列入白名单（这将是大多数 string.printable），并用您喜欢的任何转义格式（\FF、%FF 等）替换所有其他字符，或者甚至简单地将它们剥离。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-13T00:09:29.443

```
$ ./命令 | 猫-v

$ 猫--帮助 | grep 非打印
-v、--show-nonprinting 使用 ^ 和 M- 表示法，LFD 和 TAB 除外

```

在基于[android/cat.c](http://www.google.com/codesearch/p?hl=en#2wSbThBwwIw/toolbox/cat.c&q=file:%5Cbcat.c&l=-1)的 py3k 中也是如此：

```
#!/usr/bin/env python3
"""Emulate `cat -v` behaviour.

use ^ and M- notation, except for LFD and TAB

NOTE: python exits on ^Z in stdin on Windows
NOTE: newlines handling skewed towards interactive terminal. 
      Particularly, applying the conversion twice might *not* be a no-op
"""
import fileinput, sys

def escape(bytes):
    for b in bytes:
        assert 0 <= b < 0x100

        if  b in (0x09, 0x0a): # '\t\n' 
            yield b
            continue

        if  b > 0x7f: # not ascii
            yield 0x4d # 'M'
            yield 0x2d # '-'
            b &= 0x7f

        if  b < 0x20: # control char
            yield 0x5e # '^'
            b |= 0x40
        elif  b == 0x7f:
            yield 0x5e # '^'
            yield 0x3f # '?'
            continue

        yield b

if __name__ == '__main__':
    write_bytes = sys.stdout.buffer.write 
    for bytes in fileinput.input(mode="rb"):
        write_bytes(escape(bytes)) 
```

例子：

```
$ perl -e"打印地图字符，0..0xff" > bytes.bin
$ cat -v bytes.bin > cat-v.out
$ python30 cat-v.py bytes.bin > python.out
$ diff -s cat-v.out python.out

```

它打印：

```
文件 cat-v.out 和 python.out 是相同的

```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-13T21:38:22.523

如果记录或打印调试输出，我通常`repr()`用来获取对象的无害可打印版本，包括字符串。这可能是也可能不是您想要的；其他人在其他答案中使用的`cat --show-nonprinting`方法对于大量多行输出更好。

```
x = get_weird_data()
print repr(x) 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-01-12T23:40:17.207

你可以通过字符串管道它

```
./command | strings 
```

这将去除非字符串字符

# asp.net - 您可以使用 ASP.NET Web 控件 (ASCX) 来呈现 XML 吗？

> ID：437486
> 
> 赞同：0
> 
> 时间：2009-01-12T23:37:20.240
> 
> 标签：asp.net, xml, render, web-controls

在我的脑海中，我看不出有什么理由不能构造一个 ASP.NET 自定义 Web 控件（ASCX 文件）来仅输出 XML。

如果您避免在 System.Web.UI 命名空间中使用控件，而只使用 XML 标记和子控件，它们也只呈现 XML，那么最终应该会呈现一个完全有效的 XML 文档。

我是对的，还是我遗漏了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-12T23:45:12.877

如果要生成 XML 文档并将其返回给客户端，那么创建 http 处理程序 (IHttpHandler) 而不是使用页面和用户控件可能会更容易。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-12T23:41:33.773

您错过了控件必须位于一个页面内，该页面将具有一些 HTML 输出，用于标记控件的开始和结束的标记，尽管可能有一种方法可以覆盖它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-13T00:06:00.667

如果您的 ASCX 生成纯 XML，并且您覆盖 Page 的 Render 方法以替换构成 HTML、BODY 和 FORM 等元素的 HTML 标记，您的想法可能会奏效。

问题是，与简单地生成 XML 文档和构建类库相比，使用这种方法您会获得什么，该类库会生成您想要使用 ASCX 生成的那些 XML 片段。

# ant - 如何从 Ant 中获取当前 PID？

> ID：437491
> 
> 赞同：5
> 
> 时间：2009-01-12T23:39:04.997
> 
> 标签：ant

我有一个 ant 任务，在其中我想获取当前的进程 ID（`echo $PPID`来自命令行的 la la）。

我`ksh`在 Solaris 上运行，所以我想我可以这样做：

```
<property environment="env" />
<target name="targ">
    <echo message="PID is ${env.PPID}" />
    <echo message="PID is ${env.$$}" />
</target> 
```

但这没有用；变量没有被替换。结果`PPID`,`SECONDS`和某些其他环境变量并没有进入 Ant 的表示。

接下来我试试这个：

```
<target name="targ">
    <exec executable="${env.pathtomyfiles}/getpid.sh" />
</target> 
```

`getpid.sh`看起来像这样：

```
echo $$ 
```

这让我得到了生成的 shell 脚本的 PID。更接近，但不是我真正需要的。

我只想要我当前的进程 ID，所以我可以创建一个名称中包含该值的临时文件。有什么想法吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-03-28T10:08:37.457

您可以使用java进程监控工具JPS找到PID，然后可以过滤输出流，如果需要可以杀死进程。看看这个 tomcat pid kill 脚本：

```
<target name="tomcat.kill" depends="tomcat.shutdown">
  <exec executable="jps">
    <arg value="-l"/>
    <redirector outputproperty="process.pid">
        <outputfilterchain>
            <linecontains>
              <contains value="C:\tomcat\tomcat_node5\bin\bootstrap.jar"/>
            </linecontains>
            <replacestring from=" C:\tomcat\tomcat_node5\bin\bootstrap.jar"/>
        </outputfilterchain>
    </redirector>
  </exec>
  <exec executable="taskkill" osfamily="winnt">
    <arg value="/F"/>
    <arg value="/PID"/>
    <arg value="${process.pid}"/>
  </exec>
  <exec executable="kill" osfamily="unix">
    <arg value="-9"/>
    <arg value="${process.pid}"/>
  </exec>
</target> 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-13T02:34:48.103

为什么不直接使用`tempfile`Ant 任务呢？它可以完成您真正想做的事情，同时隐藏所有血腥细节。

请参阅[http://ant.apache.org/manual/Tasks/tempfile.html](http://ant.apache.org/manual/Tasks/tempfile.html)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-13T03:00:50.813

你的第二种方法没有得到 ANT 的 pid。把shell脚本改成（我用的是bash，不知道ksh是不是一样）：

```
echo "$PPID" 
```

# linux - 管道输出用作 Linux 上 grep 的搜索规范

> ID：437504
> 
> 赞同：30
> 
> 时间：2009-01-12T23:45:09.007
> 
> 标签：linux, grep

如何将 grep 的输出作为另一个 grep 的搜索模式进行管道传输？

举个例子：

```
grep <Search_term> <file1> | xargs grep <file2> 
```

我希望第一个 grep 的输出作为第二个 grep 的搜索词。上述命令将第一个 grep 的输出视为第二个 grep 的文件名。我尝试使用`-e`第二个 grep 的选项，但它也不起作用。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-10-21T11:27:41.640

您需要使用`xargs`'s`-i`开关：

```
grep ... | xargs -ifoo grep foo file_in_which_to_search 
```

这采用 after `-i`(`foo`在这种情况下) 的选项，并将命令中每次出现的它替换为 first 的输出`grep`。

这与以下内容相同：

```
grep `grep ...` file_in_which_to_search 
```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-01-12T23:52:23.300

尝试

```
grep ... | fgrep -f - file1 file2 ... 
```

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2009-01-12T23:47:17.583

如果使用 Bash，那么您可以使用反引号：

```
> grep -e "`grep ... ...`" files 
```

标志和双引号的`-e`存在是为了确保`grep`以连字符开头的任何输出都不会被解释为第二个的选项`grep`。

请注意，双引号技巧（也确保 grep 的输出被视为单个参数）仅适用于 Bash。它似乎不适用于（t）csh。

另请注意，反引号是将一个程序的输出获取到另一个程序的参数列表的标准方法。并非所有程序都可以像 (f)grep 那样方便地从标准输入读取参数。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2012-06-21T21:10:25.117

我想在当前目录中的文件名（使用 find 找到）中具有特定模式的文件（使用 grep）中搜索文本。我使用了以下命令：

```
 grep -i "pattern1" $(find . -name "pattern2") 
```

这里*pattern2*是文件名中的模式，而*pattern1*是在匹配 pattern2 的文件中搜索的*模式*。

**编辑：**不是严格意义上的管道，但仍然相关且非常有用......

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2013-10-08T14:35:30.753

这是我用来从列表中搜索文件的方法：

```
ls -la | grep 'file-in-which-to-search' 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2015-07-02T21:51:10.413

好的，违反规则，因为这不是答案，只是说明我无法使这些解决方案中的任何一个起作用。

```
% fgrep -f test file 
```

工作正常。

```
% cat test | fgrep -f - file
fgrep: -: No such file or directory 
```

失败。

```
% cat test | xargs -ifoo grep foo file 
xargs: illegal option -- i
usage: xargs [-0opt] [-E eofstr] [-I replstr [-R replacements]] [-J replstr]
             [-L number] [-n number [-x]] [-P maxprocs] [-s size]
             [utility [argument ...]] 
```

失败。请注意，大写 I 是必需的。如果我使用它，一切都很好。

```
% grep "`cat test`" file 
```

有点工作，它为匹配的术语返回一行，但它也`grep: line 3 in test: No such file or directory`为每个找不到匹配项的文件返回一行。

我是否遗漏了什么，或者这只是我的 Darwin 发行版或 bash shell 的差异？

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2017-06-01T10:19:16.510

我试过这种方式，效果很好。

```
[opuser@vjmachine abc]$ cat a
not problem
all
problem
first
not to get
read problem
read not problem

[opuser@vjmachine abc]$ cat b
not problem xxy
problem abcd
read problem werwer
read not problem  98989
123 not problem 345
345 problem tyu

[opuser@vjmachine abc]$ grep -e "`grep problem a`" b --col
not problem xxy
problem abcd
read problem werwer
read not problem  98989
123 not problem 345
345 problem tyu

[opuser@vjmachine abc]$ 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2019-05-21T13:32:40.230

您应该以这种方式 grep，仅提取文件名，请参见参数 -l（小写 L）：

```
grep -l someSearch * | xargs grep otherSearch 
```

因为在简单的 grep 上，输出的信息远不止文件名。例如，当你这样做时

```
grep someSearch * 
```

您将像这样通过管道传输到 xargs 信息

```
filename1: blablabla someSearch blablabla something else
filename2: bla someSearch bla otherSearch
... 
```

将上述任何一条管道传递给 xargs 都是无意义的。但是当您执行 grep -l someSearch * 时，您的输出将如下所示：

```
filename1
filename2 
```

现在可以将这样的输出传递给 xargs

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2012-06-07T13:07:47.313

我发现以下命令可以使用 $() 和括号内的第一个命令来让 shell 首先执行它。

```
grep $(dig +short) file 
```

当我获得主机名时，我使用它来查看文件中的 IP 地址。

# xml - Oracle：如何将文本节点添加到现有元素中

> ID：437506
> 
> 赞同：1
> 
> 时间：2009-01-12T23:45:19.507
> 
> 标签：xml, oracle, updatexml

在 Oracle 中，您可以编写：

```
update t
set xml = updateXML(xml, '/a/b/text()', 'gaga') 
```

这仅在`<b>`元素中已经有一些文本时才有效。如果数据库中的文档如下所示，如何更新文档并“添加一些文本” `<b>`：

```
<a>
    <b/>
</a> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-13T01:28:24.837

这是一种方法：

```
update t
set xml = updateXML(xml, '/a/b', XMLType('<b>gaga</b>')) 
```

我不觉得这很优雅，但我不确定你能做得更好。

# amazon-ec2 - Amazon EC2 API 的有效 instanceState 是什么？

> ID：437511
> 
> 赞同：13
> 
> 时间：2009-01-12T23:48:24.273
> 
> 标签：amazon-ec2, amazon-web-services

Amazon EC2 API 的有效 instanceState 是什么？[当前的API 文档](http://docs.amazonwebservices.com/AWSEC2/latest/DeveloperGuide/ApiReference-SOAP-DescribeInstances.html)中似乎没有定义它。谷歌并没有出现太多。到目前为止，我知道：

*   0：待定
*   16：跑步
*   32：关机
*   48：终止

但我很确定我以前见过一个`error`状态。

谢谢！

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2011-10-28T14:08:42.717

截至发稿时，目前的状态是：

```
+--------+---------------+
| 代码 | 状态 |
+--------+---------------+
| 0 | 待定 |
| 16 | 运行 |
| 32 | 关闭|
| 48 | 终止|
| 64 | 停止|
| 80 | 停了|
+--------+---------------+

```

并且可以在[InstanceStateType下的 Amazon Elastic Compute Cloud API 参考中找到该文档](http://docs.amazonwebservices.com/AWSEC2/latest/APIReference/index.html?ApiReference-ItemType-InstanceStateType.html)

文档还提到了`272`“*通常表明运行实例的主机出现问题*”的状态代码。他们建议首先尝试重新启动，如果这不能解决问题，请在[EC2 论坛上发帖。](http://developer.amazonwebservices.com/connect/forum.jspa?forumID=30)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-09-12T06:29:07.623

文档似乎已被移动，我仍然找不到它们。这是另外两个状态代码

1.  64：停止
2.  80：停止

# winforms - Windows 窗体设计时错误

> ID：437512
> 
> 赞同：0
> 
> 时间：2009-01-12T23:48:24.883
> 
> 标签：winforms, visual-studio-2008, designer

我正在使用 Visual Studio 2008，在尝试打开我的一个表单时收到以下错误消息：

> 在 ServiceModel 客户端配置部分中找不到名为“WSHttpBinding_ICommon”和合同“CommonWCF.ICommon”的端点元素。这可能是因为没有为您的应用程序找到配置文件，或者因为在客户端元素中找不到与此名称匹配的端点元素。

以及以下堆栈跟踪

> 在 System.ComponentModel.ReflectPropertyDescriptor.SetValue（对象组件，对象值）在 System.ComponentModel.Design.Serialization.CodeDomSerializerBase.DeserializePropertyAssignStatement（IDesignerSerializationManager 管理器，CodeAssignStatement 语句，CodePropertyReferenceExpression propertyReferenceEx，Boolean reportError）在 System.ComponentModel.Design.Serialization.CodeDomSerializerBase .DeserializeAssignStatement(IDesignerSerializationManager manager, CodeAssignStatement statement) at System.ComponentModel.Design.Serialization.CodeDomSerializerBase.DeserializeStatement(IDesignerSerializationManager manager, CodeStatement statement)

然而，我的 App.Config 中确实有建议的元素，并且一切都在运行时运行。但是，每当我尝试打开表单时，我都会收到此消息，这还不错，因为我可以忽略它，但是当我执行许多控件（右侧和/或底部带有锚点的控件）时，它们会移动并且我的网格会自动从我之前删除的数据源中重新获得所有列（列）。

有什么建议/解决方法吗？这是 Visual Studio 2008 的错误吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2010-01-25T14:41:23.847

[还有另一种方法可以在设计时调试 devenv 进程（visual studio），就像这里](http://www.codeproject.com/KB/cs/wsod.aspx)所说 的

这有助于在设计模式下打开表单引发异常（即向用户显示错误）。

以下是那篇文章的摘要：

1.  打开一个新的 Visual Studio 实例。
2.  打开任何源文件。这是必需的，以便 Visual Studio 允许您附加到进程。
3.  将新的 Visual Studio 实例附加到第一个实例。Visual Studio 进程称为 devenv.exe。您只需要附加到托管代码。
4.  将 Visual Studio 设置为中断公共语言运行时异常 - 引发和用户处理。关闭有问题的表单，然后重新打开它。

这应该会导致在 Visual Studio 的第二个实例中的代码中捕获异常！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-13T00:05:53.757

您在哪里使用端点？你真的需要它还是只能在运行时调用它？您可以使用 Component.DesignMode 属性来确定您是否处于设计模式，这样您就可以阻止对端点的调用。要全面调试您的设计时体验，请按照本文中的说明进行[操作](http://msdn.microsoft.com/en-us/library/5ytx0z24(VS.80).aspx)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-07-14T01:23:59.377

我用

```
 if (LicenseManager.UsageMode == LicenseUsageMode.Designtime)
        {
            return;
        } 
```

检查构造函数中的设计模式是否除了 InitializeComponent() 和加载方法（如果有的话）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-13T00:09:41.487

我曾经在构造函数初始化期间尝试进行数据库调用的表单中遇到类似的错误。

不幸的是，Component.DesignMode 直到构造函数完成后才被设置！

# java - android内部和内存/处理器限制？

> ID：437517
> 
> 赞同：10
> 
> 时间：2009-01-12T23:52:25.310
> 
> 标签：java, android, accessibility

我正在考虑为 Android 创建一个屏幕阅读器。我的问题如下。一、Android 的内部有多少是通过 Java API 暴露出来的？我正在寻找诸如显示文本时的系统范围通知、启动新应用程序的通知等内容。我宁愿不必修改内核源代码，只允许我的应用程序在开发人员手机上运行。第二，假设没有应用程序运行，G1 上还剩下多少处理器和内存？三假设手机上平均使用应用程序还剩下多少处理器和内存？
更多信息
我知道应用程序不应设计为在特定手机上运行。我之所以选择 G1，是因为它是我所知道的目前运行 Android 的最受欢迎的手机。我正在寻找我的程序必须适应的低端系统规格，它可能在安装了 Android 的上网本上运行良好，但在大多数 Android 手机上使用大量内存和处理器。
更新：
现在有两个使用 Android 1.6 的屏幕阅读器项目，它们可以在 [http://google-opensource.blogspot.com/2009/10/talkback-open-source-screenreader-for.html](http://google-opensource.blogspot.com/2009/10/talkback-open-source-screenreader-for.html) [http://找到spiel.thewordnerd.info/](http://spiel.thewordnerd.info/)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-16T13:55:54.073

AFAIK，出于安全原因，其他应用程序的屏幕内容（文本、图形）不会在 Android 中公开。否则，人们可能会获取联系信息或显示的任何个人信息，并将其用于恶意目的。因此，开发人员目前无法创建一个能够说出另一个应用程序显示的文本的 Android 应用程序，也无法捕获屏幕。这种情况与 PC 上的 Microsoft Windows 不同，后者的应用程序几乎可以做任何他们喜欢的事情，因此用户必须自己决定任何给定应用程序的来源是否可信。

遗憾的是，市场上仍然没有适用于 Android 的屏幕阅读器，因此如果您或其他人可以创建它会很棒，但鉴于上述情况，看起来只有与 Google 直接安排才能提供所需的信任级别安全限制。由于 Google 正在积极改进 TTS 并将其集成到 Donut 中，因此创建一个类似讲述人的基本屏幕阅读器（如在 Windows 中）或提供类似的基于触摸的可访问性解决方案似乎是一个相当简单的额外步骤在 iPhone 3G S 上使用 VoiceOver。

最好的祝福，

彼得·梅杰

Android 版语音 [http://www.seeingwithsound.com/android.htm](http://www.seeingwithsound.com/android.htm)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-13T07:21:32.987

(1) 取决于你在寻找什么。你最好自己检查一下。我不知道有任何辅助技术，但我也没有在寻找它们。

关于您要求的两个特定功能：(a) 通知是 API 的一部分。(b) 我不知道您会收到关于正在启动的应用程序的通知。

(2/3) 我不知道可用于应用程序的一般 RAM 量，但我可以给你一个实用的答案。如果您的应用程序尝试获取超过 16MB 的数据，它将被终止。我不知道确切的时钟速度，但在 android-dev 列表中提到 G1 不能全速运行。其背后的基本原理是，除其他外，更快的速度会更快地耗尽电池。

关于这个问题的另一个实际问题。如果您想讨论约束，请转到 android-dev 列表。

# visual-studio-2008 - 当前选择没有可用的链接

> ID：437522
> 
> 赞同：0
> 
> 时间：2009-01-12T23:55:38.177
> 
> 标签：visual-studio-2008

我刚收到一台预装了VS2008的新开发机。我最喜欢的帮助功能之一是动态帮助窗格。但是，它目前对所有内容都显示“当前选择没有可用的链接”。

我在想有一个配置选项或方法可以启用它。到目前为止，谷歌还没有发现任何东西，我认为我已经用尽了所有工具 > 选项，所以我现在转向更大的知识库......

想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-30T21:14:40.070

你只需要重新启动你的电脑......听起来很有趣，但它确实有效。然后，当您再次启动 Visual Studio 时，您会收到一条消息，表明它正在重新组织帮助文件。

当我安装一些为 Visual Studio 安装新帮助主题的新库时，我总是会遇到这种情况。（例如，SQL Server 2008 联机丛书）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-13T00:43:32.137

如果没有安装 MSDN 库，则必须将 VS 设置为使用 web 寻求帮助。我遇到了混合设置的问题，除非另一种方法可用，否则它将尝试一种方法。

设置帮助源：工具>选项：环境>帮助>在线。

您可能还想检查：帮助>常规并检查“显示帮助使用：”我的当前设置为“外部帮助查看器”

我没有在本地加载 MSDN 库。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-13T18:05:51.720

解决方案：看起来预装的 VS2008 没有正确设置。我找到了 VS2008 的安装位置并重新运行了帮助/文档安装，现在它可以工作了。

# css - CSS 水平菜单问题：在 IE7 中不起作用

> ID：437523
> 
> 赞同：1
> 
> 时间：2009-01-12T23:56:06.723
> 
> 标签：css, internet-explorer-7, menu, html-lists

你能帮我修复[这个页面](http://www.efficientcode.com/p/menu.html)上的菜单吗？菜单列表项没有定义宽度，因此它们在 IE7 中以 100% 的宽度显示。如果我让 span.right 有一个 float: left，它可以解决问题，但是圆角不起作用。一个可能的解决方案可能是摆脱正确的跨度并为锚设置填充和背景图像，但这会：a）阻止我能够使用锚上的背景图像（对于这种情况，我想纯色会做）和b）要求我将menu.png分成单独的图像文件。

如果大家有什么好的建议，请告诉我。谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-13T00:19:17.770

如果将实际文本移动到中间，介于`<span class="left"></span>`和之间`<span class="right"></span>`，并将其包含在`<span>`标签中：

```
<li><a href="#">
    <span class="left"></span>
    <span>Home</span>
    <span class="right"></span>
</a></li> 
```

然后，您可以添加 CSS 规则：

```
#menu ul li a span
{
    float: left;
} 
```

然后`float: left;`从`span.left`和中删除`span.right`。这应该在 Firefox 和 IE 7 上都可以正常工作，我假设大多数其他浏览器也是如此。当然，这只有在您可以稍微重构 HTML 时才有效。

# c# - 使用 subselect 和 groupby 的 LINQ 仅获取列表中每个项目的最新版本

> ID：437539
> 
> 赞同：9
> 
> 时间：2009-01-13T00:06:29.213
> 
> 标签：c#, linq, lambda

我是 LINQ 的新手...

我有一个 IEnumerable 通用列表，其中包含不同版本的答案（每个版本都有问题的 FK）。从此列表中，我只需要获取最新版本答案的字典。

一个非常简化的类图：

Question
-ID
-question
- ...其他属性

Answer
-ID
-Version
-QuestionID -Value
-
...其他属性

目前我有以下内容：

```
IEnumerable<Answer> answers = GetAnswers();

IDictionary<long, AnswerDTO> latestVersionAnswers = new Dictionary<long, AnswerDTO>();
if (answers != null)
{
latestVersionAnswers = answers
      .OrderBy(e => e.ID)
      .GroupBy(e => e.Question.ID)
      .Select(g => new AnswerDTO
                        {
                             Version = g.Last().Version, // g.Select(e => e.Version).Max(), 
                             QuestionID = g.Key,
                             ID = g.Last().ID,
                             Value = g.Last().Value
                                 }).ToDictionary(c => c.QuestionID);
        } 
```

虽然这在大多数情况下都有效，但您可以很快看到它需要一些认真的优化（并且有点脆弱，因为它取决于答案记录行顺序而不是“Max”逻辑）。使用 LINQ 执行此操作的最佳方法是什么，或者最好为每个循环执行多个？

1.  如果我只需要版本（而不是 ID、值等），我就不需要 OrderBy，因为我可以去 g.Select(e => e.Version).Max() （或者我现在已经在[C# List<> GroupBy 2 Values](https://stackoverflow.com/questions/363655/c-list-groupby-2-values)上看到了帖子，但这又只会返回 key/s 和一个属性：Version）。
2.  最终，在这种特殊情况下，我更愿意只“过滤”原始列表并返回原始答案项，而不是涉及 AnswerDTO。

任何指示或帮助将不胜感激！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-13T00:35:28.563

诸如此类的东西怎么样......

```
 private void button1_Click(object sender, EventArgs e)
    {
      List<Answer> list = GetAnswers();

      var dict = (from a in list
                 group a by a.QuestionID into grp
                 from g in grp
                 where g.Version == grp.Max(m => m.Version)
                 select new { id = g.QuestionID, q = g }).ToDictionary( o => o.id, o => o.q);

      StringBuilder sb = new StringBuilder();
      foreach (var elem in dict)
      {
        sb.AppendLine(elem.Key.ToString() + "-" + elem.Value.Version.ToString());
      }
      MessageBox.Show(sb.ToString());
    }

    private List<Answer> GetAnswers()
    {
      List<Answer> result = new List<Answer>();
      result.Add(new Answer() { ID = 1, QuestionID = 1, Version = 1 });
      result.Add(new Answer() { ID = 2, QuestionID = 1, Version = 2 });
      result.Add(new Answer() { ID = 3, QuestionID = 1, Version = 3 });
      result.Add(new Answer() { ID = 4, QuestionID = 2, Version = 1 });
      result.Add(new Answer() { ID = 5, QuestionID = 2, Version = 2 });
      result.Add(new Answer() { ID = 6, QuestionID = 2, Version = 3 });
      result.Add(new Answer() { ID = 7, QuestionID = 3, Version = 1 });
      result.Add(new Answer() { ID = 8, QuestionID = 3, Version = 2 });
      result.Add(new Answer() { ID = 9, QuestionID = 3, Version = 3 });
      result.Add(new Answer() { ID = 10, QuestionID = 3, Version = 4 });
      return result;
    } 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-01-13T04:36:28.827

```
latestVersionAnswers = answers
  .GroupBy(e => e.Question.ID)
  .Select(g => g.OrderByDescending(e => e.Version).First())
  .ToDictionary(e => e.Question.ID); 
```

或者，如果您更喜欢 ToDictionary 的选择重载：

```
latestVersionAnswers = answers
  .GroupBy(e => e.Question.ID)
  .ToDictionary(
    g => g.Key,
    g => g.OrderByDescending(e => e.Version).First()
  ); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-13T00:10:11.407

我只是重写数据模型以包含当前答案版本 ID。

# apache-flex - Flex 3 本地化：删除语言环境

> ID：437541
> 
> 赞同：1
> 
> 时间：2009-01-13T00:08:57.930
> 
> 标签：apache-flex, localization

尽管我仍在查看文档和在线，但我想我会在这里问这个，以供将来遇到它的人使用。

使用 copylocale 进行本地化时，我打错了字（例如，“en_FR”而不是“fr_FR”）并错误地创建了我不想要的语言环境。删除它的正确方法是什么？只需从我的框架目录中删除它就足够了，或者是否有一个帮助应用程序可以处理清理，如果还有更多内容？

提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-13T15:03:01.510

您应该能够简单地从语言环境目录中删除它。copylocale 只是创建一个副本，仅此而已。只需核弹它，你应该很高兴。更多信息在这里：

[http://labs.adobe.com/wiki/index.php/Flex_3:Feature_Introductions:_Runtime_Localization](http://labs.adobe.com/wiki/index.php/Flex_3:Feature_Introductions:_Runtime_Localization)

# standards - 特殊 IP 地址

> ID：437546
> 
> 赞同：0
> 
> 时间：2009-01-13T00:09:47.040
> 
> 标签：standards, ip-address, magic-numbers

特别是，我正在寻找一个可以放入`hosts`文件中的 IP 地址，它将黑洞给定的 DNS 名称。现在我正在使用`127.0.0.1`，但如果我安装了任何服务，那会开始表现得很奇怪。

如何防止 3rd 方程序联系给定的服务器？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-13T00:13:38.420

[RFC-3330](https://www.rfc-editor.org/rfc/rfc3330)似乎是金矿

最好的选择似乎是：

> 192.0.2.0/24 - 此块被分配为“TEST-NET”，用于文档和示例代码。在供应商和协议文档中，它通常与域名 example.com 或 example.net 结合使用。此块内的地址不应出现在公共互联网上。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-13T04:54:36.420

实际上，环回 IP 127.0.0.1 是广告拦截的理想选择。如果您仍然运行 Apache，您将设置一个虚拟服务器，该服务器为 127.0.0.1 上的请求返回 404。这样，您的浏览器就不会一直等待连接到未知主机超时。所有这些广告请求都会立即返回，从而释放浏览器中的资源以获取实际的页面内容。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-13T00:45:11.040

我在 hosts 文件中使用了 0.0.0.0 来阻止广告网站。不知道有没有副作用？！？！

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-01-13T00:55:26.353

我看到您已经正确地发现 192.0.2.0/24 是为测试而保留的，不会出现在 Internet 上。

但是，如果您的局域网依赖*默认路由*到达 Internet 的其余部分，那么您仍然会将此流量从您的网络发送到您的 ISP。

最好的情况是您的 ISP 会发回`ICMP_NET_UNREACHABLE`错误，而您的应用程序会注意到这些错误并采取相应措施。最坏的情况是流量完全被黑洞，此时您的应用程序将一直闲置，直到连接超时。

避免这种情况的正确策略取决于您的操作系统和本地网络配置。在 Linux 系统上，我只需为 /24 添加一条以“拒绝”为目标的路由。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-13T00:11:56.753

地址 127.0.0.0 到 127.255.255.255 可用于环回连接。

因此，让您的 httpd 监听 127.0.0.1 并将其他任何一个用于黑名单。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-13T00:17:21.377

如果您使用任何未连接到的私有 IP 地址范围（10.whatever、192.168.whatever），则应该可以。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-01-13T00:57:45.397

使用 127.0.0.1 的一个优点是尝试联系服务器将立即返回失败（当然，只要您没有运行本地服务器）。如果您使用不指向特定机器的任何其他地址，例如 192.0.2.x，则尝试连接到该地址的服务器将需要一些时间才能超时（至少一分钟或更长时间）。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-13T00:14:23.020

我将拒绝主机用于 ssh。 [http://denyhosts.sourceforge.net/](http://denyhosts.sourceforge.net/) 它试图阻止已知的恶意来源。这就是你在说的吗？

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-01-13T04:49:23.340

不应该使用 0.0.0.0 （正如另一张海报所说的那样）——它有一个独特的含义，不是“什么都没有”，也不是为大多数情况下的死胡同而保留的。至于 BCS 对 dulaneyb 关于 DCHP 和私有范围的评论 - 私有范围就是私有范围。如果您要踢到您的私人范围，那么您将路由到一个空插槽。如果您要进入其他私有范围之一，则上游设备应将其丢弃。

# windows - 解决 Windows 冻结和减速问题

> ID：437559
> 
> 赞同：0
> 
> 时间：2009-01-13T00:13:12.070
> 
> 标签：windows

我是 Windows 的（快乐？）用户，但最近遇到了我不知道如何跟踪的问题。

我有一个 WinXP plus 家庭和工作 Win2k3 系统。其中一些会在短时间内（从不到一秒到几秒）间歇性地冻结。没有 CPU 使用率峰值，也没有太多的 HDD 活动。进程资源管理器和 Windows 任务管理器均未显示任何可疑进程。服务看起来也不错。

在其中一台计算机上，拖放（在资源管理器窗口或窗口和应用程序中）会使机器冻结 10-20 秒。在这段时间之后，我可以继续使用拖放（很长）一段时间，没有延迟。不要认为它是病毒——它可能很容易感染所有机器。

我怎么知道我的系统发生了什么？

**更新：**感谢您的建议。我在其中一台机器上解决了这个问题——它是一个讨厌的[rootkit](http://www.troublefixers.com/remove-virus-which-redirects-to-gogooglecom-gogooglecom-redirect-virus-removal-tool-for-windows/)。我需要使用 3rd 方工具来检测和删除它。如果没有这个工具，我如何诊断它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2010-11-15T17:44:23.613

我会推荐一个可以显示应用程序中访问的文件、COM 对象和网络地址的工具： [http ://www.moduleanalyzer.com/](http://www.moduleanalyzer.com/)

您可以看到使用每个资源的 dll 以及访问时间。Windows 减速的问题通常与在进程中运行的 dll 相关，该进程在进程中执行一些人员。在这些情况下，您不会在从流程角度监控的工具中看到任何内容。您需要查看进程内部发生的情况以查看任何可疑的 dll 或模块。此工具使用调用堆栈信息来查看正在访问资源的模块。

尝试具有全功能试用版的应用程序。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-13T02:23:54.413

这很可能不是硬件故障。

在 Windows 上，偶尔会有消息在系统范围内广播到所有顶级窗口。如果一个窗口没有响应（或响应缓慢），那么整个系统就会出现冻结。有一个内置超时，如果超过，系统将假定窗口不会响应并跳过窗口（这可能是您看到的 10-20 秒延迟，尽管我认为超时是略高于此）。

我还没有看到跟踪这类问题的解决方案。您可以通过创建一个程序来进行试验，该程序将单独的消息发送到每个顶级窗口并记录每个消息响应所花费的时间。这不是故障保险，但它是一个起点，这是（如果我没记错的话）我用来识别 Adob​​e 的 iFilter（用于 Microsoft 索引服务）的此类问题的技术。

但在你走这条路之前，你说这些是最近的问题。看看你是否能弄清楚你最近可能安装了什么，然后卸载它。这包括 Windows 补丁以及任何新的驱动程序或应用程序。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-13T02:44:27.633

您能否将其与症状开始的大致时间范围挂钩？如果是这样，您可以将添加/删除程序中的关键更新/安装与该估计相匹配，然后开始查找。

更一般地说，我发现使用 MSCONFIG 暂时关闭所有启动程序和所有非 Microsoft 服务可以帮助快速分而治之 - 如果症状消失，你有一个较短的工作清单。

安全模式（有或没有网络 - 见下一个想法）是缩小嫌疑人名单的另一种方式。

由于它是多台机器，如果它是硬件，它必须是通用的......特别是如果它是两个不同的位置。也就是说，网络连接（或缺乏连接）是另一个常见的罪魁祸首。在独立配置中启动系统（网线拔出/无线无线电禁用）一开始看起来很慢，然后一旦超时和各种重试被超过，就应该快速运行，特别是如果您仍在有限的启动环境中运行. 我遇到过顽固的交换机/路由器是一个问题，以及缓慢的外部服务（如 ISP 的 DNS）会导致这样的症状。

那时没有软盘、光盘或其他可移动驱动器访问权限？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-13T00:15:51.660

根据我的经验，您的硬件可能有问题，可能是您的 HD。如果您连接到网络共享 (SMB) 并且遇到连接问题也可能导致挂起。拖放缓慢通常指向“资源管理器”进程挂起，该进程用于与网络资源（例如文件共享）进行通信。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-09T15:39:07.110

要诊断 rootkit 或其他恶意软件使用的活动或渗透，您可以查看[Bleeping Computer](http://www.bleepingcomputer.com)上的论坛，那里的一些帮助人们删除此类的志愿者可能愿意帮助您找出在哪里寻找此类感染。

我最近在该网站的专家的帮助下清理了一些恶意软件，我还需要使用第三方工具（在我的情况下为 Malwarebytes）来删除，但恶意软件相对较新，因此该工具无法完全清理直到最近对其定义的更新发布为止。

我仍然不知道如何或在哪里确切地在给定系统上查找此类感染，但该站点可能会将您与具有该专业知识的人联系起来。只要您强调您正在寻找能够追踪此类而不是为了编写您自己的恶意软件的目的，我希望他们会接受您的请求。

# file - 在 .NET 中读取滚动日志文件的最佳方式？

> ID：437562
> 
> 赞同：3
> 
> 时间：2009-01-13T00:14:54.703
> 
> 标签：file, logging, .net-3.5

我需要读取 .NET 3.5sp1 中的滚动日志文件。我想知道最好的方法是什么？该文件可以变得非常大。我的一个想法是

*   打开文件
*   将文件读取到最后读取的行（在第一种情况下，它是 0）
*   读取所有剩余的行
*   关闭流并记住最后读取的行号。
*   稍等一会。
*   冲洗/重复。

考虑到文件可能非常大，我不确定这是否是内存的最佳方式和效率。而且我也不能锁定日志文件:(

想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-13T00:23:09.227

下面是一个使用 FileSystem Watcher 打开文件并在写入时读取新数据的示例：

[http://www.codeproject.com/KB/cs/wintail.aspx](http://www.codeproject.com/KB/cs/wintail.aspx)

这个例子看起来不错，但不要因为 Pete 的爱和所有事物的模糊使用 lock(this)。这是坏的。改用一个新对象，您可以在类中的所有对象之间共享它。

如果您打开文件 ReadOnly 您不应该有共享冲突，具体取决于附加到日志文件的程序如何打开您的文件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-13T00:24:38.897

获取文件长度并读取文件的最后一段。找到第一个换行符并从那里显示所有内容并不难。FileStream 有一个`Length`属性，该`read`方法允许您从一个地方读取到另一个地方。

史蒂文是对的。如果其他程序不需要独占访问，则可以只读打开就可以了。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-13T01:13:29.033

您可以只附加到文件，而不是跟踪您的位置吗？

```
 Object mLogLock = new Object(); //to make logging thread safe
    string mLogFile = ""; //set your log location
    string mLogDirectory = "";
    public void HandleMessage(string inMessage)
    {

        lock (mLogLock)
        {
            if (!System.IO.Directory.Exists(mLogDirectory ))
            {
                System.IO.Directory.CreateDirectory(mLogDirectory );
            }

            String theMessage = DateTime.Now.ToString("s");
            if (inMessage != null)
                theMessage += " : " + inMessage;

            StreamWriter sw = new StreamWriter(mLogFile, true);

            sw.WriteLine(theMessage );

            sw.Dispose();
            sw.Close();
        }
    } 
```

否则，如果您有一个作家在某个时间点写东西而其他东西正在消耗，并且您没有锁定，那么您的程序**将**破坏您的日志。这甚至不是一个问题。您可以尝试通过打开文件以供任何想要读取或写入文件的独占读取/写入来锁定您的文件，但是当其他代码无法读取它时会抛出异常。

如果日志文件在同一个程序中，您可以将所有信息保存在一个大流中，如 MemoryStream，并使用上面的 StreamWriter 代替（或同时）到 MemoryStream。然后，您的读者和作者可以锁定 MemoryStream，而不是文件本身。那会有帮助吗？

# tfs - TFS - 尝试将“Windows 用户或组”添加到许可用户时出错 - 添加组

> ID：437581
> 
> 赞同：0
> 
> 时间：2009-01-13T00:27:51.560
> 
> 标签：tfs

我有：Microsoft Visual Studio 2008 Team Explorer 版本 9.0.21022.8

当我去 Team->Team Foundation Server Settings->Group Memberships 时；

双击“Team Foundation Server 许可用户”；

在“添加成员”中选择“Windows 用户或组”；在“选择用户、计算机或组”中输入组名，然后“检查名称”，解决后，按“确定”。

现在我可以看到添加到“用户或组”列表中的组。

不幸的是，当我按“确定”时，我收到以下无用的消息

* * *

## 微软视觉工作室

团队基础错误

## 我的组

## 确定 帮助

（其中“MyGroup”是我尝试添加的 Windows 组的名称）。

但是，与此同时，从该组中添加单个用户也可以正常工作。

关于从哪里开始出现此错误的任何想法（按“帮助”会显示“未找到信息”页面）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-13T15:39:27.817

工作组版有五个用户的限制，所以它不允许您在安全管理器中添加组。如果您可以添加组，您可能会添加五个以上的用户，然后它就不会知道要授予哪五个访问权限。我怀疑这是您的问题，尽管我希望得到更有用的错误消息 - 可能类似于“无法在此 TFS 版本中添加组”或类似的内容。

编辑：[这篇 MSDN 文章](http://msdn.microsoft.com/en-us/library/ms404880.aspx)解释了该过程，并指出您不能将组添加到工作组版本 - 只有个人用户。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-13T15:43:05.550

正如 rwmnau 所说，WGE 仅限于五个。如果您购买了新许可证，您可以“修复”该应用程序，它会为您提供添加新许可证代码的位置 - 因此您无需卸载/重新安装。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-13T00:44:44.800

好的，看来我们有一个我没有被告知的“限量版”，并且看不到任何迹象......无论如何，这似乎是原因。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-13T23:55:05.180

只是添加一些我自己的发现：

*   正如建议的那样，问题是“工作组版”

*   “修复”选项有点棘手，如此处所述 [ [http://social.msdn.microsoft.com/Forums/en-US/tfssetup/thread/2a13ec88-e199-48e6-8312-de9602cf7577/][1]](http://social.msdn.microsoft.com/Forums/en-US/tfssetup/thread/2a13ec88-e199-48e6-8312-de9602cf7577/][1]) （涉及手动编辑 setup.sdb 文件）

*   即使在升级后，该特定“许可用户”组也有 5 个用户的限制。正如我从这里了解到的 [ [http://social.msdn.microsoft.com/Forums/en-US/tfssetup/thread/21eb519c-7871-4e4b-ade8-3614b3a1d2a3/][2]](http://social.msdn.microsoft.com/Forums/en-US/tfssetup/thread/21eb519c-7871-4e4b-ade8-3614b3a1d2a3/][2]) 我不应该使用'完全版中的许可用户组，但更喜欢使用项目组。似乎对我来说工作得很好。

    [1]：[http](http://social.msdn.microsoft.com/Forums/en-US/tfssetup/thread/2a13ec88-e199-48e6-8312-de9602cf7577/) ://social.msdn.microsoft.com/Forums/en-US/tfssetup/thread/2a13ec88-e199-48e6-8312-de9602cf7577/ “将 TFS 2008 工作组升级到标准版”[2]：[http://social.msdn.microsoft.com/Forums/en-US/tfssetup/thread/21eb519c-7871-4e4b-ade8-3614b3a1d2a3/](http://social.msdn.microsoft.com/Forums/en-US/tfssetup/thread/21eb519c-7871-4e4b-ade8-3614b3a1d2a3/) “从限量版升级”

# jquery - JQuery Slider - 滑动后调用函数

> ID：437588
> 
> 赞同：11
> 
> 时间：2009-01-13T00:31:44.763
> 
> 标签：jquery, ajax, slider

我有一个用于在 Web 应用程序上设置分数的 JQuery silder。我最初拥有它，以便用户单击提交按钮，但客户端现在希望它更新 AJAX 样式。

这可以找到，但是每次移动都会调用滑动函数，所以我的 AJAX 脚本将在滑块完成移动之前发送一个分数。

JQuery 滑块上是否有在释放滑块时调用的函数？有没有一种直接的方法可以让我检查滑块何时被释放？

谢谢，。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-01-13T00:39:27.510

在快速阅读[源代码](https://github.com/jquery/jquery-ui/blob/master/ui/widgets/slider.js#L363)后，我会说尝试使用“停止”或“更改”而不是“滑动”。似乎 'stop' 事件发生在 mouseup 上，而 'change' 事件发生在 mouseup 上，但前提是值发生了变化。我没有看到任何关于这方面的文档，当然，我看起来不是很努力。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-01-13T01:00:38.293

初始化滑块时，请使用以下命令：

```
var slider = $('.slider').slider({ 
    steps: 10,
    handle: $('.knob'),
    animate:'true',
    min:1,
    max:10,
    startValue: 1,
    change: function(e,ui){
        //Do something with ui.value
    } 
}); 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-01-13T00:56:11.517

该文档证实了 FryGuy 刚才所说的...... [从滑块选项页面：](http://docs.jquery.com/UI/Slider/slider#toptions)

> change Function(Event, ui)：在滑动停止时调用的函数，但前提是滑块位置发生了变化。
> 
> stop Function(Event, ui)：当用户停止滑动时调用的函数。

# python - 如何卸载（重新加载）Python 模块？

> ID：437589
> 
> 赞同：974
> 
> 时间：2009-01-13T00:33:36.040
> 
> 标签：python, module, reload, python-import

我有一个长期运行的 Python 服务器，并且希望能够在不重新启动服务器的情况下升级服务。这样做的最佳方法是什么？

```
if foo.py has changed:
    unimport foo  <-- How do I do this?
    import foo
    myfoo = foo.Foo() 
```

* * *

## 回答 #1

> 赞同：990
> 
> 时间：2009-01-13T00:34:40.110

您可以使用以下命令重新加载已经导入的模块[`importlib.reload()`](https://docs.python.org/3/library/importlib.html#importlib.reload)：

```
from importlib import reload  # Python 3.4+
import foo

while True:
    # Do some things.
    if is_changed(foo):
        foo = reload(foo) 
```

在 Python 2 中，[`reload`](https://docs.python.org/2.7/library/functions.html#reload)是内置的。在 Python 3 中，它被[移到](https://docs.python.org/3/whatsnew/3.0.html#builtins)了[`imp`](https://docs.python.org/3/library/imp.html)模块中。在 3.4 中，`imp`已[弃用](https://docs.python.org/3/whatsnew/3.4.html#importlib)，取而代之的是[`importlib`](https://docs.python.org/3/library/importlib.html). 以 3 或更高版本为目标时，在调用`reload`或导入时引用适当的模块。

我认为这就是你想要的。像 Django 的开发服务器这样的 Web 服务器使用它，这样您就可以看到代码更改的效果，而无需重新启动服务器进程本身。

引用文档：

> *   重新编译 Python 模块的代码并重新执行模块级代码，通过重用最初加载模块的[加载器，定义一组新的对象，这些对象绑定到模块字典中的名称。](https://docs.python.org/3/glossary.html#term-loader)`init`扩展模块的功能不会被第二次调用。
> *   与 Python 中的所有其他对象一样，旧对象仅在其引用计数降至零后才会被回收。
> *   模块命名空间中的名称被更新以指向任何新的或更改的对象。
> *   对旧对象的其他引用（例如模块外部的名称）不会重新绑定以引用新对象，并且如果需要，必须在它们出现的每个命名空间中进行更新。

正如您在问题中指出的那样，如果该类驻留在模块中，则必须重建`Foo`对象。`Foo``foo`

* * *

## 回答 #2

> 赞同：265
> 
> 时间：2009-10-10T13:36:30.443

在 Python 3.0–3.3 中，您将使用：[`imp.reload(module)`](http://docs.python.org/3.3/library/imp.html?highlight=imp#imp.reload)

BDFL已经[回答](http://mail.python.org/pipermail/edu-sig/2008-February/008421.html)[了](http://docs.python.org/3.3/glossary.html#term-bdfl)这个问题。

但是，[`imp`在 3.4 中已弃用，取而代之的是`importlib`](https://docs.python.org/dev/library/imp.html)（感谢[@Stefan！](https://stackoverflow.com/users/2068635/stefan)）。

因此，我*认为*您现在会使用[`importlib.reload(module)`](https://docs.python.org/dev/library/importlib.html#importlib.reload)，尽管我不确定。

* * *

## 回答 #3

> 赞同：118
> 
> 时间：2009-01-28T14:03:47.030

如果模块不是纯 Python，则删除模块可能特别困难。

以下是一些信息：[如何真正删除导入的模块？](http://web.archive.org/web/20080926094551/http://mail.python.org/pipermail/python-list/2003-December/241654.html)

> 您可以使用 sys.getrefcount() 找出实际的引用数。

```
>>> import sys, empty, os
>>> sys.getrefcount(sys)
9
>>> sys.getrefcount(os)
6
>>> sys.getrefcount(empty)
3 
```

> 大于 3 的数字表示很难摆脱该模块。自制的“空”（不包含任何内容）模块应该在之后被垃圾收集

```
>>> del sys.modules["empty"]
>>> del empty 
```

> 因为第三个引用是 getrefcount() 函数的工件。

* * *

## 回答 #4

> 赞同：88
> 
> 时间：2009-01-13T12:53:25.780

`reload(module)`，但前提是它完全独立。如果其他任何东西都引用了该模块（或属于该模块的任何对象），那么您将得到由旧代码比您预期的更长的时间引起的微妙和奇怪的错误，以及诸如`isinstance`无法跨不同版本工作的事情相同的代码。

如果你有单向依赖，你还必须重新加载依赖于重新加载模块的所有模块，以摆脱对旧代码的所有引用。然后递归地重新加载依赖于重新加载的模块的模块。

如果您有循环依赖，这很常见，例如在处理重新加载包时，您必须一次性卸载组中的所有模块。您不能这样做，`reload()`因为它会在其依赖项被刷新之前重新导入每个模块，从而允许旧引用潜入新模块。

在这种情况下，唯一的方法是 hack `sys.modules`，这是不受支持的。您必须检查并删除`sys.modules`您希望在下次导入时重新加载的每个条目，并删除其值`None`用于处理与缓存失败的相对导入有关的实现问题的条目。这不是非常好，但只要你有一组完全独立的依赖项，不会在其代码库之外留下引用，它是可行的。

最好重新启动服务器。:-)

* * *

## 回答 #5

> 赞同：76
> 
> 时间：2015-08-09T17:28:31.073

对于 Python **2**，使用内置函数[`reload`](https://docs.python.org/2/library/functions.html#reload)：

```
reload(module) 
```

对于 Python **2** *和*Python **3.2** —<strong>3.3 使用[`reload`模块 imp](https://docs.python.org/3/library/imp.html#imp.reload)：

```
import imp
imp.reload(module) 
```

对于 Python ≥<strong>3.4，`imp` [不推荐使用](https://docs.python.org/3/library/imp.html)，[`importlib`](https://docs.python.org/3/library/importlib.html#importlib.reload)所以使用这个：

```
import importlib
importlib.reload(module) 
```

或者：

```
from importlib import reload
reload(module) 
```

* * *

TL;博士：

Python ≥ 3.4：`importlib.reload(module)`
Python 3.2 — 3.3： `imp.reload(module)`
Python 2：`reload(module)`

* * *

## 回答 #6

> 赞同：68
> 
> 时间：2010-07-07T11:44:10.433

```
if 'myModule' in sys.modules:  
    del sys.modules["myModule"] 
```

* * *

## 回答 #7

> 赞同：26
> 
> 时间：2012-11-20T16:01:08.647

以下代码允许您兼容 Python 2/3：

```
try:
    reload
except NameError:
    # Python 3
    from imp import reload 
```

您可以`reload()`在两个版本中使用它，这使事情变得更简单。

* * *

## 回答 #8

> 赞同：23
> 
> 时间：2014-09-27T23:30:59.510

接受的答案不处理 from X import Y 的情况。此代码处理它以及标准导入案例：

```
def importOrReload(module_name, *names):
    import sys

    if module_name in sys.modules:
        reload(sys.modules[module_name])
    else:
        __import__(module_name, fromlist=names)

    for name in names:
        globals()[name] = getattr(sys.modules[module_name], name)

# use instead of: from dfly_parser import parseMessages
importOrReload("dfly_parser", "parseMessages") 
```

在重新加载的情况下，我们将顶级名称重新分配给存储在新重新加载的模块中的值，从而更新它们。

* * *

## 回答 #9

> 赞同：23
> 
> 时间：2018-03-18T13:46:54.897

如果您*不在*服务器中，但*正在开发*并需要经常重新加载模块，这里有一个很好的提示。

首先，确保您使用的是 Jupyter Notebook 项目中出色的[IPython shell](https://ipython.org/)。安装 Jupyter 后，您可以使用`ipython`、`jupyter console`或 甚至更好的方式启动它`jupyter qtconsole`，这将为您提供一个漂亮的彩色控制台，并在任何操作系统中完成代码完成。

现在在你的 shell 中，输入：

```
%load_ext autoreload
%autoreload 2 
```

现在，**每次**运行脚本时，都会重新加载模块。

除了 之外`2`，还有[autoreload 魔法的其他选项](https://ipython.org/ipython-doc/3/config/extensions/autoreload.html)：

```
%autoreload
Reload all modules (except those excluded by %aimport) automatically now.

%autoreload 0
Disable automatic reloading.

%autoreload 1
Reload all modules imported with %aimport every time before executing the Python code typed.

%autoreload 2
Reload all modules (except those excluded by %aimport) every time before
executing the Python code typed. 
```

当然，它也适用于 Jupyter Notebook。

* * *

## 回答 #10

> 赞同：20
> 
> 时间：2017-11-21T18:04:00.663

这是重新加载模块的现代方式：

```
from importlib import reload 
```

如果要支持 3.5 之前的 Python 版本，请使用：

```
from sys import version_info
if version_info[0] < 3:
    pass # Python 2 has built in reload
elif version_info[0] == 3 and version_info[1] <= 4:
    from imp import reload # Python 3.0 - 3.4 
else:
    from importlib import reload # Python 3.5+ 
```

这定义了一个`reload`可以被模块调用以重新加载它的方法。例如，`reload(math)`将重新加载`math`模块。

* * *

## 回答 #11

> 赞同：7
> 
> 时间：2010-05-08T16:50:12.877

对于像我这样想要卸载所有模块的人（在[Emacs](http://en.wikipedia.org/wiki/Emacs)下的 Python 解释器中运行时）：

```
 for mod in sys.modules.values():
      reload(mod) 
```

更多信息在*[重新加载 Python 模块](http://pyunit.sourceforge.net/notes/reloading.html)*中。

* * *

## 回答 #12

> 赞同：5
> 
> 时间：2016-01-09T01:06:14.893

Enthought Traits 有一个模块可以很好地解决这个问题。[https://traits.readthedocs.org/en/4.3.0/_modules/traits/util/refresh.html](https://traits.readthedocs.org/en/4.3.0/_modules/traits/util/refresh.html)

它将重新加载任何已更改的模块，并更新正在使用它的其他模块和实例化对象。它在大多数情况下不适用于`__very_private__`方法，并且可能会阻塞类继承，但它为我节省了在编写 PyQt guis 或在诸如 Maya 或 Nuke 等程序中运行的东西时必须重新启动主机应用程序的大量时间。它可能在 20-30% 的情况下不起作用，但它仍然非常有用。

Enthought 的包不会在文件更改的那一刻重新加载文件——你必须明确地调用它——但如果你真的需要它，这应该不难实现

* * *

## 回答 #13

> 赞同：5
> 
> 时间：2018-05-08T18:07:40.667

其他选项。看到 Python 默认`importlib.reload`只会重新导入作为参数传递的库。它**不会**重新加载您的 lib 导入的库。如果您更改了很多文件并且要导入一个有些复杂的包，则必须进行**深度重新加载**。

如果您安装了[IPython](https://ipython.org/)或[Jupyter](https://jupyter.org/)，则可以使用函数来深度重新加载所有库：

```
from IPython.lib.deepreload import reload as dreload
dreload(foo) 
```

如果您没有 Jupyter，请在 shell 中使用以下命令安装它：

```
pip3 install jupyter 
```

* * *

## 回答 #14

> 赞同：5
> 
> 时间：2018-05-17T11:00:43.527

那些使用 python 3 并从 importlib 重新加载的人。

如果您遇到模块似乎没有重新加载的问题......那是因为它需要一些时间来重新编译 pyc（最多 60 秒）。我写这个提示只是为了让您知道您是否遇到过这种问题。

* * *

## 回答 #15

> 赞同：4
> 
> 时间：2018-02-01T03:44:57.640

2018-02-01

1.  模块`foo`必须提前成功导入。
2.  `from importlib import reload`,`reload(foo)`

[31.5。importlib — 导入的实现 — Python 3.6.4 文档](https://docs.python.org/3/library/importlib.html#importlib.reload)

* * *

## 回答 #16

> 赞同：4
> 
> 时间：2020-05-05T15:44:30.233

## 编辑（答案 V2）

之前的解决方案仅用于获取重置信息，但它不会更改所有引用（多于`reload`但少于所需）。要实际设置所有引用，我必须进入垃圾收集器，并在那里重写引用。现在它就像一个魅力！

请注意，如果 GC 关闭，或者重新加载不受 GC 监控的数据，这**将不起作用。**如果您不想弄乱 GC，那么原始答案对您来说可能就足够了。

新代码：

```
import importlib
import inspect
import gc
from enum import EnumMeta
from weakref import ref

_readonly_attrs = {'__annotations__', '__call__', '__class__', '__closure__', '__code__', '__defaults__', '__delattr__',
               '__dict__', '__dir__', '__doc__', '__eq__', '__format__', '__func__', '__ge__', '__get__',
               '__getattribute__', '__globals__', '__gt__', '__hash__', '__init__', '__init_subclass__',
               '__kwdefaults__', '__le__', '__lt__', '__module__', '__name__', '__ne__', '__new__', '__qualname__',
               '__reduce__', '__reduce_ex__', '__repr__', '__self__', '__setattr__', '__sizeof__', '__str__',
               '__subclasshook__', '__weakref__', '__members__', '__mro__', '__itemsize__', '__isabstractmethod__',
               '__basicsize__', '__base__'}

def reset_module(module, inner_modules_also=True):
    """
    This function is a stronger form of importlib's `reload` function. What it does, is that aside from reloading a
    module, it goes to the old instance of the module, and sets all the (not read-only) attributes, functions and classes
    to be the reloaded-module's
    :param module: The module to reload (module reference, not the name)
    :param inner_modules_also: Whether to treat ths module as a package as well, and reload all the modules within it.
    """

    # For the case when the module is actually a package
    if inner_modules_also:
        submods = {submod for _, submod in inspect.getmembers(module)
                   if (type(submod).__name__ == 'module') and (submod.__package__.startswith(module.__name__))}
        for submod in submods:
            reset_module(submod, True)

    # First, log all the references before reloading (because some references may be changed by the reload operation).
    module_tree = _get_tree_references_to_reset_recursively(module, module.__name__)

    new_module = importlib.reload(module)
    _reset_item_recursively(module, module_tree, new_module)

def _update_referrers(item, new_item):
    refs = gc.get_referrers(item)

    weak_ref_item = ref(item)
    for coll in refs:
        if type(coll) == dict:
            enumerator = coll.keys()
        elif type(coll) == list:
            enumerator = range(len(coll))
        else:
            continue

        for key in enumerator:

            if weak_ref_item() is None:
                # No refs are left in the GC
                return

            if coll[key] is weak_ref_item():
                coll[key] = new_item

def _get_tree_references_to_reset_recursively(item, module_name, grayed_out_item_ids = None):
    if grayed_out_item_ids is None:
        grayed_out_item_ids = set()

    item_tree = dict()
    attr_names = set(dir(item)) - _readonly_attrs
    for sub_item_name in attr_names:

        sub_item = getattr(item, sub_item_name)
        item_tree[sub_item_name] = [sub_item, None]

        try:
            # Will work for classes and functions defined in that module.
            mod_name = sub_item.__module__
        except AttributeError:
            mod_name = None

        # If this item was defined within this module, deep-reset
        if (mod_name is None) or (mod_name != module_name) or (id(sub_item) in grayed_out_item_ids) \
                or isinstance(sub_item, EnumMeta):
            continue

        grayed_out_item_ids.add(id(sub_item))
        item_tree[sub_item_name][1] = \
            _get_tree_references_to_reset_recursively(sub_item, module_name, grayed_out_item_ids)

    return item_tree

def _reset_item_recursively(item, item_subtree, new_item):

    # Set children first so we don't lose the current references.
    if item_subtree is not None:
        for sub_item_name, (sub_item, sub_item_tree) in item_subtree.items():

            try:
                new_sub_item = getattr(new_item, sub_item_name)
            except AttributeError:
                # The item doesn't exist in the reloaded module. Ignore.
                continue

            try:
                # Set the item
                _reset_item_recursively(sub_item, sub_item_tree, new_sub_item)
            except Exception as ex:
                pass

    _update_referrers(item, new_item) 
```

## 原始答案

正如@bobince 的回答中所写，如果另一个模块中已经有对该模块的引用（特别是如果它是使用`as`关键字 like导入的`import numpy as np`），则该实例不会被覆盖。

在应用需要配置模块的“干净”状态的测试时，这对我来说是一个很大的问题，所以我编写了一个名为的函数`reset_module`，它使用`importlib`'s`reload`函数并递归地覆盖所有声明的模块的属性。它已经用 Python 3.6 版进行了测试。

```
import importlib
import inspect
from enum import EnumMeta

_readonly_attrs = {'__annotations__', '__call__', '__class__', '__closure__', '__code__', '__defaults__', '__delattr__',
               '__dict__', '__dir__', '__doc__', '__eq__', '__format__', '__func__', '__ge__', '__get__',
               '__getattribute__', '__globals__', '__gt__', '__hash__', '__init__', '__init_subclass__',
               '__kwdefaults__', '__le__', '__lt__', '__module__', '__name__', '__ne__', '__new__', '__qualname__',
               '__reduce__', '__reduce_ex__', '__repr__', '__self__', '__setattr__', '__sizeof__', '__str__',
               '__subclasshook__', '__weakref__', '__members__', '__mro__', '__itemsize__', '__isabstractmethod__',
               '__basicsize__', '__base__'}

def reset_module(module, inner_modules_also=True):
    """
    This function is a stronger form of importlib's `reload` function. What it does, is that aside from reloading a
    module, it goes to the old instance of the module, and sets all the (not read-only) attributes, functions and classes
    to be the reloaded-module's
    :param module: The module to reload (module reference, not the name)
    :param inner_modules_also: Whether to treat ths module as a package as well, and reload all the modules within it.
    """

    new_module = importlib.reload(module)

    reset_items = set()

    # For the case when the module is actually a package
    if inner_modules_also:
        submods = {submod for _, submod in inspect.getmembers(module)
                   if (type(submod).__name__ == 'module') and (submod.__package__.startswith(module.__name__))}
        for submod in submods:
            reset_module(submod, True)

    _reset_item_recursively(module, new_module, module.__name__, reset_items)

def _reset_item_recursively(item, new_item, module_name, reset_items=None):
    if reset_items is None:
        reset_items = set()

    attr_names = set(dir(item)) - _readonly_attrs

    for sitem_name in attr_names:

        sitem = getattr(item, sitem_name)
        new_sitem = getattr(new_item, sitem_name)

        try:
            # Set the item
            setattr(item, sitem_name, new_sitem)

            try:
                # Will work for classes and functions defined in that module.
                mod_name = sitem.__module__
            except AttributeError:
                mod_name = None

            # If this item was defined within this module, deep-reset
            if (mod_name is None) or (mod_name != module_name) or (id(sitem) in reset_items) \
                    or isinstance(sitem, EnumMeta):  # Deal with enums
                continue

            reset_items.add(id(sitem))
            _reset_item_recursively(sitem, new_sitem, module_name, reset_items)
        except Exception as ex:
            raise Exception(sitem_name) from ex 
```

**注意：**小心使用！在非外围模块（例如，定义外部使用的类的模块）上使用这些可能会导致 Python 中的内部问题（例如酸洗/非酸洗问题）。

* * *

## 回答 #17

> 赞同：2
> 
> 时间：2016-02-05T14:27:12.423

对我来说，就 Abaqus 而言，这就是它的工作方式。想象一下你的文件是 Class_VerticesEdges.py

```
sys.path.append('D:\...\My Pythons')
if 'Class_VerticesEdges' in sys.modules:  
    del sys.modules['Class_VerticesEdges']
    print 'old module Class_VerticesEdges deleted'
from Class_VerticesEdges import *
reload(sys.modules['Class_VerticesEdges']) 
```

* * *

## 回答 #18

> 赞同：2
> 
> 时间：2020-07-24T12:03:30.473

如果您遇到以下错误，此答案可能会帮助您获得解决方案：

> ```
> 回溯（最近一次通话最后）：
>  文件“FFFF”，第 1 行，在  
> NameError: 名称 'YYYY' 未定义
> ```

或者

> ```
> 回溯（最近一次通话最后）：
>  文件“FFFF”，第 1 行，在
>  文件“/usr/local/lib/python3.7/importlib/__init__.py”，第 140 行，重新加载
>    raise TypeError("reload() 参数必须是一个模块")
> TypeError: reload() 参数必须是一个模块
> ```

如果您有如下所示的导入，您可能需要使用`sys.modules`来获取要重新加载的模块：

```
 import importlib
  import sys

  from YYYY.XXX.ZZZ import CCCC
  import AAA.BBB.CC

  def reload(full_name)
    if full_name in sys.modules:
      importlib.reload(sys.modules[full_name])

  reload('YYYY.XXX.ZZZ') # this is fine in both cases
  reload('AAA.BBB.CC')  

  importlib.reload(YYYY.XXX.ZZZ) # in my case: this fails
  importlib.reload(AAA.BBB.CC)   #             and this is ok 
```

主要问题是`importlib.reload`接受模块不是字符串。

* * *

## 回答 #19

> 赞同：1
> 
> 时间：2020-10-15T07:31:21.707

从 sys.modules 中删除模块也需要删除*“无”*类型。

**方法一：**

```
import sys
import json  ##  your module

for mod in [ m for m in sys.modules if m.lstrip('_').startswith('json') or sys.modules[m] == None ]: del sys.modules[mod]

print( json.dumps( [1] ) )  ##  test if functionality has been removed 
```

**方法 2，使用簿记条目，删除*所有*依赖项：**

```
import sys

before_import = [mod for mod in sys.modules]
import json  ##  your module
after_import = [mod for mod in sys.modules if mod not in before_import]

for mod in [m for m in sys.modules if m in after_import or sys.modules[m] == None]: del sys.modules[mod]

print( json.dumps( [2] ) )  ##  test if functionality has been removed 
```

**可选，只是为了确定所有条目都已输出，如果您选择：**

```
import gc
gc.collect() 
```

* * *

## 回答 #20

> 赞同：1
> 
> 时间：2022-02-19T11:14:15.817

Python不会**重新计算子模块**地址`reload`，如果在，则事件在`sys.modules`

这是一种解决方法，虽然不完美但有效。

```
# Created by BaiJiFeiLong@gmail.com at 2022/2/19 18:50
import importlib
import types

import urllib.parse
import urllib.request

def reloadModuleWithChildren(mod):
    mod = importlib.reload(mod)
    for k, v in mod.__dict__.items():
        if isinstance(v, types.ModuleType):
            setattr(mod, k, importlib.import_module(v.__name__))

fakeParse = types.ModuleType("urllib.parse")
realParse = urllib.parse

urllib.parse = fakeParse
assert urllib.parse is fakeParse

importlib.reload(urllib)
assert urllib.parse is fakeParse
assert getattr(urllib, "parse") is fakeParse

reloadModuleWithChildren(urllib)
assert urllib.parse is not fakeParse
assert urllib.parse is realParse 
```

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2015-02-11T21:13:42.687

另一种方法是在函数中导入模块。这样，当函数完成时，模块就会被垃圾收集。

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2017-11-09T18:36:53.067

尝试在 Sublime Text 中重新加载某些内容时遇到了很多麻烦，但最后我可以编写这个实用程序来根据用于重新加载模块的代码在 Sublime Text 上`sublime_plugin.py`重新加载模块。

下面接受您从名称上带有空格的路径重新加载模块，然后在重新加载后您可以像往常一样导入。

```
def reload_module(full_module_name):
    """
        Assuming the folder `full_module_name` is a folder inside some
        folder on the python sys.path, for example, sys.path as `C:/`, and
        you are inside the folder `C:/Path With Spaces` on the file 
        `C:/Path With Spaces/main.py` and want to re-import some files on
        the folder `C:/Path With Spaces/tests`

        @param full_module_name   the relative full path to the module file
                                  you want to reload from a folder on the
                                  python `sys.path`
    """
    import imp
    import sys
    import importlib

    if full_module_name in sys.modules:
        module_object = sys.modules[full_module_name]
        module_object = imp.reload( module_object )

    else:
        importlib.import_module( full_module_name )

def run_tests():
    print( "\n\n" )
    reload_module( "Path With Spaces.tests.semantic_linefeed_unit_tests" )
    reload_module( "Path With Spaces.tests.semantic_linefeed_manual_tests" )

    from .tests import semantic_linefeed_unit_tests
    from .tests import semantic_linefeed_manual_tests

    semantic_linefeed_unit_tests.run_unit_tests()
    semantic_linefeed_manual_tests.run_manual_tests()

if __name__ == "__main__":
    run_tests() 
```

如果您是第一次运行，这应该会加载模块，但如果稍后您可以再次运行该方法/函数`run_tests()`，它将重新加载测试文件。使用 Sublime Text ( `Python 3.3.6`) 经常发生这种情况，因为它的解释器永远不会关闭（除非您重新启动 Sublime Text，即`Python3.3`解释器）。

# datetime - 在不更改 Windows 系统时钟的情况下伪造时间

> ID：437599
> 
> 赞同：18
> 
> 时间：2009-01-13T00:39:04.937
> 
> 标签：datetime, testing, timezone, virtualization, clock

有人知道向进程报告虚假日期/时间的 Windows 工具吗？

显然，有一些 Linux 程序可用于测试软件在未来/在不同时区的反应，或在不实际修改系统时钟的情况下触发计划任务。Windows 有这样的程序吗？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-01-13T00:52:21.667

[RunAsDate](http://www.nirsoft.net/utils/run_as_date.html)可以做到这一点。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-13T03:07:55.400

从大约 2 年前开始，我总是通过 Utility 类抽象对 DateTime.Now (C#) 的调用。这样，如果我愿意，我总是可以伪造日期/时间，或者直接将其传递给 DateTime.Now。

听起来与 BillH 的建议相似。

```
public class MyUtil
{
  public static DateTime GetDateTime()
  {
     return DateTime.Now.AddHours(5);
     //return DateTime.Now;   
  }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-13T01:01:54.063

包装您对“getCurrentDateTime()”系统调用的调用，以便在测试期间将偏移量或乘数引入代码读取的时间？

# sql - 我如何表示我在关系代数中的联接？

> ID：437603
> 
> 赞同：0
> 
> 时间：2009-01-13T00:40:53.263
> 
> 标签：sql, database, relational-algebra

我是关系代数的新手，对于我的任务，我必须创建两个。我已经写出了我在 SQL 中遇到的问题，但我不确定如何在关系代数中表示这种连接。任何帮助/指针将不胜感激。

```
SELECT ps.FirstName AS StudentFirstName, ps.LastName AS StudentLastName, pst.FirstName AS StaffFirstName , pst.LastName AS StaffLastName, pg.FirstName AS GuardianFirstName, pg.LastName AS GuadianLastName, i.DateTimeReported, i.NatureOfIllness
FROM Incident i
JOIN Student s USING (StudentID)
JOIN Person ps ON (s.StudentID = ps.PersonID)
JOIN Staff st USING (StaffID)
JOIN Person pst ON (st.StaffID = pst.PersonID)
JOIN Guardian g USING (GuardianID)
JOIN Person pg ON (g.GuardianID = pg.PersonID)
WHERE i.DecisionMade IS NULL; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-25T00:03:26.490

你正在做的那些左连接在关系代数中被称为 theta-joins，有时更具体地称为等连接。您将要使用看起来像领结的符号并在其下方写下“StudentID = PersonID”（用于示例中的第二个连接）。我不能做花哨的符号，但[http://en.wikipedia.org/wiki/Relational_algebra#.CE.B8-join_and_equijoin](http://en.wikipedia.org/wiki/Relational_algebra#.CE.B8-join_and_equijoin)有一些例子。

此外，6 路连接没有任何问题，它们确实会在现实世界中发生。

* * *

## 回答 #2

> 赞同：-4
> 
> 时间：2009-01-13T01:19:17.803

我认为您以错误的方式解决问题。在现实世界中，您永远不会想要创建一个有 6 路连接的情况。

你在这里所拥有的似乎是事件和人。人是有角色的。应该有三张表、事件、角色和人员。你加入对 Person 两次的方式，将是一团糟。

我认为您应该坐下来阅读有关数据库规范化的内容。

[http://en.wikipedia.org/wiki/Database_normalization](http://en.wikipedia.org/wiki/Database_normalization)

# c# - 用户输入数据的 C# 存储

> ID：437604
> 
> 赞同：1
> 
> 时间：2009-01-13T00:42:28.753
> 
> 标签：c#, data-storage

我正在尝试编写一个 C# 程序，当用户在文本框中输入一些数据并单击“保存”按钮时，信息会存储在某种文件中，当下次打开程序时，信息会自动加载进去。

我正在使用 Visual C# express。在不需要 MySQL、MSSQL 或 Access 等某种数据库的情况下，最好的方法是什么？

如果唯一的方法或最简单的方法是数据库，我宁愿使用 Access。如果是这样，该程序的用户是否需要安装 Access 才能让我的程序在他们的计算机上运行？如果我使用另一个数据库怎么办？

ps

我忘了提，我宁愿用户不能访问这个文件并轻松地阅读内容。没有加密的文本文件很容易打开。有什么方法可以加密吗？此外，如果我使用像“：”这样的分隔符，那么这意味着用户不能使用该字符。那么还有什么办法吗？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-13T00:47:35.963

通过添加关键字使您的用户数据可序列化：

```
[Serializable] 
```

在您的数据结构之上。加载对话框时，从磁盘加载序列化结构，离开对话框时，保存数据结构。

从样式的角度来看，您可能不应该让对话框更改数据，直到对话框关闭（如果它是模态的）。

保存：

```
 private bool Save(String inFileName, MyObject inObject){
        try {
            FileStream theStream = File.Open(inFileName, FileMode.Create);

            BinaryFormatter theFormatter = new BinaryFormatter();
            theFormatter.Serialize(theStream, inObject);//add it to the end there
            theStream.Dispose();
            theStream.Close();
        } catch{
            return false;
        }
        return true;

    } 
```

装载：

```
 private MyObject Read(String inFileName){
        MyObject theReturn = null;
        try {

            FileStream theStream = File.Open(inFileName, FileMode.Open, FileAccess.Read);                

            BinaryFormatter theFormatter = new BinaryFormatter();
            theReturn = (CImageData)theFormatter.Deserialize(theStream);//add it to the end there
            theStream.Dispose();
            theStream.Close();
        }
        catch {
            return null;
        }
        return theReturn;
    } 
```

您也可以在流上使用“使用”，但我认为这段代码非常简单。这也意味着您可以在 MyObject 中添加更多项目。

编辑：对于加密，您可以添加 AES 或类似的东西。这对您来说可能有点过头了，将文件保存为二进制文件可能使它可以被记事本之类的东西读取，但不容易编辑。这是关于真正加密的冗长解释：

[http://msdn.microsoft.com/en-us/magazine/cc164055.aspx](http://msdn.microsoft.com/en-us/magazine/cc164055.aspx)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-13T00:56:08.007

[Sql Compact Edition](http://www.microsoft.com/Sqlserver/2005/en/us/compact.aspx)将隐藏数据，使其易于访问（并且是免费的）。您还可以使用密码保护 CE 数据库。SQL CE 数据库完全包含在 .SDF 文件中，例如 Access，因此您可以复制 .sdf 文件而不必担心网络连接等问题。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-13T00:50:11.607

如果您的应用程序仅供一个人使用，那么只需将您的数据存储在一个文件中（XML 会给您一些结构）

如果您的应用程序将被多人使用并且在他们之间共享数据，那么数据库是您的最佳选择。如果您使用数据库，那么是的，您将需要在您的用户计算机上安装一个数据库，尽管可以对您的用户透明地执行此操作，因为您最好使用嵌入式数据库，像 MySQL 这样的数据库将是您的最佳选择赌注。

（编辑：数据库实际上不必在用户计算机上，但他需要能够从他的计算机上看到它）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-13T00:47:04.513

如果它非常简单，那么您可以将其放在纯文本文件中。对于更多结构化数据，您可以考虑将其存储为 CSV 并对其进行解析或创建 XmlDocument 并将其保存到磁盘。

# mysql - 将表 1 中的 2 列连接到表 2

> ID：437617
> 
> 赞同：2
> 
> 时间：2009-01-13T00:47:59.613
> 
> 标签：mysql, join, left-join

您如何将 table1 列引用到表 2 中的 2 列

我创建了一个包含 50 行的表“ **State ”**

**试图在“婚礼**”表中关联 (weddingState,contactState)

这是我创建的语句，但它只正确加入了顶部的**WeddingState** - 似乎并不关心它下面的 INNER Join ......

选择 *

从婚礼

INNER JOIN 状态为 s1 ON 婚礼。**WeddingState** = s1.StateId //婚姻状态

INNER JOIN 状态为 s2 ON weddings.ContactState = s2.StateId //新娘的联系状态

WHERE 婚礼.weddingid="094829292"

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-13T01:01:38.543

我猜你正在用 PHP 或其他方式检索这些，并且你正在获取哈希数组中的行，以字段名称为键。当然，散列中只能有一个具有给定键的元素。因此，您需要使用列别名来确保为具有相同名称的列赋予不同的别名。

```
SELECT w.*, s1.StateID AS wstate, s2.StateId AS cstate
FROM weddings AS w
INNER JOIN states AS s1 ON w.WeddingState = s1.StateId //state of marriage
INNER JOIN states AS s2 ON w.ContactState = s2.StateId //contact state of bride
WHERE w.weddingid="094829292"; 
```

现在您的哈希数组将具有键“wstate”和“cstate”。如果不对这些列进行别名处理，则总是会覆盖另一列。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-13T01:01:55.327

你从结果中得到了什么来得出你的结论？

初学者会感到困惑，因为两个连接中的字段名称以及主表中的一些字段名称是相同的。显式选择输出列并为它们提供有意义的别名是一个非常好的主意。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-13T01:03:43.327

怎么样：

选择 s1.StateName，s2.StateName

从婚礼

INNER JOIN 状态为 s1 ON weddings.WeddingState = s1.StateId //婚姻状态

INNER JOIN 状态为 s2 ON weddings.ContactState = s2.StateId //新娘的联系状态

WHERE 婚礼.weddingid="094829292"

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-13T02:27:28.650

谢谢比尔，我也添加了州名

选择 w.*,

```
s1.StateId AS WeddingStateId,

s1.StateName AS WeddingStateName,

s2.StateId AS ContactStateId,

s2.StateName AS ContactStateName 
```

从婚礼作为 w

INNER JOIN 状态为 s1 ON w.WeddingState = s1.StateId

INNER JOIN 状态为 s2 ON w.ContactState = s2.StateId

# c# - 如何追踪我从哪里泄漏 IDisposable 对象？

> ID：437618
> 
> 赞同：3
> 
> 时间：2009-01-13T00:48:16.790
> 
> 标签：c#

我最近一直在调试一些内存泄漏的代码。这是一个长期运行的程序，作为 Windows 服务运行。

如果你发现一个类带有一个`IDisposable`接口，它就告诉你它使用的一些资源超出了垃圾收集器为你清理的能力。

它告诉你这个的原因是你，这个对象的用户，现在负责清理这些资源。恭喜！

作为一个尽职尽责的开发人员，`.Dispose()`当您完成对象以释放那些非托管资源时，您会被提示调用该方法。

`using()`一旦完成这些资源，有一个很好的模式可以帮助清理这些资源。哪个只是找出导致泄漏的确切对象？

为了帮助追踪这些流氓非托管资源，是否有任何方法可以查询在任何给定时间点等待处置的对象是什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-13T00:53:15.440

不应该有任何情况下您不想调用 Dispose，但编译器无法告诉您应该**在哪里**调用 dispose。

假设您编写了一个创建和返回一次性对象的工厂类。当清理应该是你的调用者的责任时，编译器是否应该因为你没有调用 Dispose 而出错？

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-13T00:50:47.627

IDisposable 更多地用于使用 using 关键字。它不是强迫你调用 Dispose() - 它是为了让你能够以一种巧妙、不突兀的方式调用它：

```
class A : IDisposable {}

/// stuff

using(var a = new A()) {
  a.method1();
} 
```

离开 using 块后，会为您调用 Dispose()。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-15T18:31:33.930

“有什么方法可以在程序结束时检测到哪些物体在等待处置？”

好吧，如果一切顺利，在程序结束时，CLR 将调用所有对象的终结器，如果 IDisposable 模式被正确实现，它将调用 Dispose() 方法。所以最后，一切都会被妥善清理。

问题是，如果您有一个长时间运行的程序，那么您的一些 IDiposable 实例可能会锁定一些不应该锁定的资源。对于这样的情况，用户代码应该使用 using 块或在处理完对象后立即调用 Dispose()，但除了代码作者之外的任何人都无法知道这一点。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-07-06T21:02:05.590

请问您如何确定它是实现 IDisposable 的特定对象？以我的经验，最有可能的僵尸对象是没有正确删除所有事件处理程序的对象（因此从另一个“活动”对象中留下对它们的引用，并且在垃圾收集期间不将它们限定为不可访问）。

有一些工具可以通过拍摄托管堆和堆栈的快照来帮助跟踪这些问题，并允许您查看在给定时间点哪些对象被认为正在使用中。免费赠品是使用 sos.dll 的 windbg；它需要一些谷歌搜索教程来向您展示您需要的命令 - 但它有效并且它是免费的。一个更加用户友好（不要与“简单”混淆）的选项是 Red Gate 的 ANTS Profiler，它在内存分析模式下运行——它是一个巧妙的工具。

编辑：关于调用 Dispose 的用处——它提供了一种确定性的方法来清理对象。垃圾收集仅在您的应用程序用完其分配的内存时运行 - 这是一项昂贵的任务，它基本上会阻止您的应用程序执行并查看所有存在的对象并构建一个“可达”（使用中）对象树，然后清理无法访问的对象。手动清理对象可以在 GC 运行之前释放它。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-13T00:50:44.257

您不需要调用 Dispose 方法。实现 IDisposable 接口提醒您，您的类可能正在使用需要关闭的资源，例如数据库连接、文件句柄，因此 GC 是不够的。AFAIK 的最佳实践是调用 Dispose ，甚至更好的是，将对象放在`using`语句中。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-13T01:03:03.203

一个很好的例子是异步运行的 .NET 2.0 Ping 类。除非它引发异常，否则在回调方法之前您不会真正调用 Dispose。请注意，由于 Ping 实现 IDisposable 接口的方式，此示例有一些稍微奇怪的转换，但也继承了 Dispose() （并且只有前者按预期工作）。

```
private void Refresh( Object sender, EventArgs args )
{
    Ping ping = null;

    try
    {
        ping = new Ping();
        ping.PingCompleted += PingComplete;
        ping.SendAsync( defaultHost, null );
    }
    catch ( Exception )
    {
        ( (IDisposable)ping ).Dispose();
        this.isAlive = false;
    }
}

private void PingComplete( Object sender, PingCompletedEventArgs args )
{
    this.isAlive = ( args.Error == null && args.Reply.Status == IPStatus.Success );
    ( (IDisposable)sender ).Dispose();
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-13T00:52:06.657

因为创建一次性对象的方法可能合法地将其作为值返回，也就是说，编译器无法判断程序打算如何使用它。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-13T01:20:28.347

如果一次性对象是在一个类/模块（例如工厂）中创建的，并在被处理之前被移交给不同的类/模块使用一段时间怎么办？那个用例应该没问题，编译器不应该纠缠你。我怀疑这就是为什么没有编译时警告的原因——编译器假定`Dispose`调用在另一个文件中。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-07-06T20:47:19.893

确定何时何地调用 Dispose() 是一件非常主观的事情，取决于程序的性质以及它如何使用一次性对象。主观问题不是编译器非常擅长的。相反，这更像是静态分析的工作，这是 FxCop 和 StyleCop 等工具的舞台，或者可能是 Spec#/Sing# 等更高级的编译器。静态分析使用规则来确定是否满足主观要求，例如“始终确保在某些时候调用 .Dispose()。”。

老实说，我不确定是否存在任何能够检查是否调用 .Dispose() 的静态分析器。即使对于今天存在的静态分析，这也可能有点过于主观了。但是，如果您需要一个地方开始寻找，“C# 的静态分析”可能是最好的地方。

# java - Java同步静态方法：锁定对象或类

> ID：437620
> 
> 赞同：150
> 
> 时间：2009-01-13T00:48:39.333
> 
> 标签：java, class, static, methods, synchronized

Java 文档说：

> 同一对象上的同步方法的两次调用不可能交错。

这对静态方法意味着什么？由于静态方法没有关联对象，同步关键字会锁定类而不是对象吗？

* * *

## 回答 #1

> 赞同：202
> 
> 时间：2009-01-13T02:58:41.817

只是为了给 Oscar 的答案（非常简洁！）添加一点细节，Java 语言规范的相关部分是[8.4.3.6, 'synchronized Methods'](http://docs.oracle.com/javase/specs/jls/se7/html/jls-8.html#jls-8.4.3.6)：

> 同步方法在执行之前获取监视器（[第 17.1 节）。](https://docs.oracle.com/javase/specs/jls/se7/html/jls-17.html#jls-17.1)对于类（静态）方法，使用与方法类的 Class 对象关联的监视器。对于实例方法，使用与 this（调用该方法的对象）关联的监视器。

* * *

## 回答 #2

> 赞同：132
> 
> 时间：2009-01-13T00:53:30.803

> 由于静态方法没有关联对象， *同步关键字会锁定类而不是对象吗？*

是的。:)

* * *

## 回答 #3

> 赞同：81
> 
> 时间：2009-01-13T11:02:43.507

您必须注意的一点（一些程序员通常落入那个陷阱）是同步的静态方法和同步的非静态方法之间没有联系，即：

```
class A {
    static synchronized f() {...}
    synchronized g() {...}
} 
```

主要的：

```
A a = new A(); 
```

线程 1：

```
A.f(); 
```

线程 2：

```
a.g(); 
```

f() 和 g() 彼此不同步，因此可以完全同时执行。

* * *

## 回答 #4

> 赞同：15
> 
> 时间：2010-02-05T21:19:12.617

除非您按如下方式实现 g()：

```
g() {
    synchronized(getClass()) {
        ...
    }
} 
```

当我想在对象的不同实例之间实现互斥（例如，在访问外部资源时需要）时，我发现这种模式也很有用。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2016-11-01T08:06:38.407

查看有关 [内在锁和同步的 oracle 文档页面](https://docs.oracle.com/javase/tutorial/essential/concurrency/locksync.html)

> 您可能想知道调用静态同步方法时会发生什么，因为静态方法与类相关联，而不是与对象相关联。**在这种情况下，线程获取与类关联的类对象的内在锁**。**因此，对类的静态字段的访问由不同于任何类实例的锁的锁控制**。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2016-11-09T04:55:00.217

静态方法也有关联的对象。它属于 JDK 工具包中的 Class.class 文件。当 .class 文件加载到 ram 中时，Class.class 会创建它的一个实例，称为模板对象。

例如：-当您尝试从现有客户类创建对象时，例如

```
Customer c = new Customer(); 
```

Customer.class 加载到 RAM 中。在那一刻，JDK 工具包中的 Class.class 创建了一个名为 Template 对象的对象，并将该 Customer.class 加载到该模板对象中。该 Customer.class 的静态成员成为该模板对象中的属性和方法。

所以静态方法或属性也有对象

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2017-08-13T04:45:57.457

下面的例子更清楚地说明了类和对象锁，希望下面的例子也能帮助其他人:)

例如，我们有以下方法，一个是获取类，另一个是获取对象锁：

```
public class MultiThread {

    public static synchronized void staticLock() throws InterruptedException {
        for (int i = 0; i < 10; i++) {
            Thread.sleep(100);
            System.out.println(Thread.currentThread().getName() + " " + i);
        }
    }

    public synchronized void objLock() throws InterruptedException {
        for (int i = 0; i < 10; i++) {
            Thread.sleep(100);
            System.out.println(Thread.currentThread().getName() + " " + i);
        }
    }
} 
```

所以，现在我们可以有以下场景：

1.  当使用**相同对象**的线程尝试同时访问`objLock` **OR** `staticLock`方法时（即两个线程都尝试访问相同的方法）

    ```
    Thread-0 0
    Thread-0 1
    Thread-0 2
    Thread-0 3
    Thread-0 4
    Thread-1 0
    Thread-1 1
    Thread-1 2
    Thread-1 3
    Thread-1 4 
    ```

2.  **当使用相同对象**的线程尝试同时访问`staticLock`和`objLock`方法时（尝试访问不同的方法）

    ```
    Thread-0 0
    Thread-1 0
    Thread-0 1
    Thread-1 1
    Thread-0 2
    Thread-1 2
    Thread-1 3
    Thread-0 3
    Thread-0 4
    Thread-1 4 
    ```

3.  **当使用不同对象**的线程尝试访问`staticLock`方法时

    ```
    Thread-0 0
    Thread-0 1
    Thread-0 2
    Thread-0 3
    Thread-0 4
    Thread-1 0
    Thread-1 1
    Thread-1 2
    Thread-1 3
    Thread-1 4 
    ```

4.  **当使用不同对象**的线程尝试访问`objLock`方法时

    ```
    Thread-0 0
    Thread-1 0
    Thread-0 1
    Thread-1 1
    Thread-0 2
    Thread-1 2
    Thread-1 3
    Thread-0 3
    Thread-0 4
    Thread-1 4 
    ```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2017-05-24T02:50:44.523

对于那些不熟悉锁定在类对象上的静态同步方法的人，例如对于字符串类它的 String.class，而实例同步方法锁定在 Java 中的“this”关键字表示的 Object 的当前实例上。由于这两个对象不同，它们具有不同的锁，因此当一个线程正在执行静态同步方法时，java中的其他线程不需要等待该线程返回，而是将获取表示为字节.class文字的单独锁并进入静态同步方法。

# javascript - 摆脱列表项中的光盘

> ID：437631
> 
> 赞同：0
> 
> 时间：2009-01-13T00:54:49.430
> 
> 标签：javascript, jquery, html, css, html-lists

我正在使用 jQuery 和 jQuery UI 选项卡开发一个站点。出于某种原因，我的标签（无序列表）在除 OS X 上的 Firefox 3 之外的所有浏览器（迄今为止已测试）中显示它们的项目符号。它在 Safari OS X、FF 3 Windows 和 Google Chrome Windows 中显示它们（IE 显示所有div 在角落里的一大堆里……但那是另一回事了）。

好的，到它的实际内容。看来我已经应用了 list-style-type: none 任何我可以并且似乎无法摆脱它们的地方。以下是 firebug 报告的带有恶意子弹的 li 元素：

```
font-family "Trebuchet MS",Trebuchet,Verdana,Helvetica,Arial,sans-serif
font-size   12px
font-weight bold 
font-style  normal
color   #000000
text-transform  none
text-decoration none
letter-spacing  normal
word-spacing    normal
line-height 14.4px
text-align  center
vertical-align  baseline
direction   ltr
Background
background-color    transparent
background-image    url(http://agrifuels-dev/media/css/tab.png)
background-repeat   no-repeat  
background-position 0 -50px
background-attachment   scroll
opacity 1
Box Model
width   64px
height  18px
top auto
right   auto
bottom  auto
left    auto
margin-top  0
margin-right    0
margin-bottom   0
margin-left 0
padding-top 6px
padding-right   0
padding-bottom  1px
padding-left    10px
border-top-width    0
border-right-width  0
border-bottom-width 0
border-left-width   0
border-top-color    #000000
border-right-color  #000000
border-bottom-color #000000
border-left-color   #000000
border-top-style    none
border-right-style  none
border-bottom-style none
border-left-style   none
Layout
position    static
display block
visibility  visible
z-index auto
overflow-x  visible
overflow-y  visible
white-space nowrap
clip    auto
float   none
clear   none
-moz-box-sizing content-box
Other
cursor  text
list-style-image    none
list-style-position outside
list-style-type disc
marker-offset   auto
0
86
offset
margin
0
0
0
1
border
0
0
0
0
padding
0
0
0
0
84 x 25 
clientLeft  0
clientTop   0
contentEditable   "inherit"
type   ""
value   -1
getBoundingClientRect  getBoundingClientRect()
getClientRects  getClientRects()
getElementsByClassName  getElementsByClassName()
scrollIntoView  scrollIntoView()
attributes  NamedNodeMap
baseURI   "http://agrifuels-dev/qcs/management_responsibility#"
childNodes  [a management...fragment-2]
className   ""
clientHeight  25
clientWidth   84
dir   ""
firstChild   a management...fragment-2
id    ""
innerHTML    "<a href="#fragment-2"><span>Closed</span></a>"
lang    ""
lastChild    a management...fragment-2
localName   "LI"
namespaceURI    null
nextSibling    "\n "
nodeName    "LI"
nodeType  1
nodeValue   null
offsetHeight   25
offsetLeft   86
offsetParent   div.tab_container
offsetTop    0
offsetWidth   84
ownerDocument   Document management_responsibility#
parentNode   ul.policy_page_tabs
prefix    null
previousSibling    "\n "
scrollHeight    25
scrollLeft    0
scrollTop    0
scrollWidth    84
spellcheck    false
style    CSSStyleDeclaration
tabIndex    -1
tagName    "LI"
textContent     "Closed"
title    "" 
```

`list-style-type: disc`似乎来自“html.css”，这不是我项目的一部分。那可能是来自浏览器的css页面还是什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-13T00:56:49.910

您是否将 list-style:none 添加到包含 li 标签的 ol/ul 标签中？有时，浏览器需要将 list-style 属性放置在列表中，而不是单独的列表元素中。

# .net - 有什么技巧可以让我的项目每次都在新的结账时编译？

> ID：437633
> 
> 赞同：5
> 
> 时间：2009-01-13T00:55:40.427
> 
> 标签：.net, version-control, build-process, vcs-checkout

比我承认的次数还要多，我让刚接触项目的人进行结帐，却发现他们缺少各种资源、dll 和设置。我想养成让我的项目编译顺利的正确习惯，就像从新结帐时一样​​。

关于如何构建我的项目以使它们在从版本控制中重新签出时不会出现编译问题，有哪些提示或建议？

我已经开始在我的项目中保留一个“资源”文件夹，其中包含源代码管理中所有需要的 dll 引用。其他人可以提出一些建议吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-13T03:26:59.420

找到一台未使用的旧计算机并将其设置为自动“滚动构建”：

1.  等到有人签入更改
2.  更新到所有文件的最新版本。
3.  清除所有非源代码控制文件（`make clean`还不够 - 扫描碎片并将其删除）
4.  建造。
5.  运行单元测试。
6.  每天一次，保存成功运行的二进制文件。将其称为当天的“官方构建”。

如果构建或测试失败，请发送包含错误的电子邮件。包括在 #2 中选择的更改列表。

如果你真的，真的找不到机器，就在虚拟机里找。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-13T03:38:17.243

假设您在 Visual Studio 环境中，这里有一些您可能会发现有用的东西，当然是 YMMV，请注意我们使用 Subversion，但任何 VCS 工具都应该这样做......

*   将所有（或尽可能多的）依赖项置于版本控制之下，并在您的项目中引用它们。我们使用 Subversion externals 来管理它。
*   不要版本控制标准输出目录（bin、obj），即使用 svn:ignore
*   同样，忽略版本控制用户项（*.user、*.suo）
*   也不要版本控制配置文件 (App|Web.config)，而是创建一个 App.default.config 并在您的项目 BeforeBuild 任务中将此文件复制到 App.config。这允许您通过使用 RegEx 和令牌来设置每个开发人员或构建服务器的编译，它还允许您删除 CI 构建上的任何现有 App.config 文件以确保每次都进行原始构建。这也允许开发人员在他们准备好之前不必打扰其他人的配置，即更新 App.default.config。
*   版本控制一切:)
*   如果由于编译需要对二进制文件（MSI、DLL 输出等）进行版本控制，请在 AfterBuild 目标项目（wixproj 等）中将输出复制到另一个受版本控制的目录。使用 Subversion 的一个技巧是您可以添加/提交到 svn:externals 目录，这允许您将库等推送到引用它们的项目中。

最后提示 - 在您完成干净的检查并成功编译后，检查您的工作副本中是否有任何修改，例如 TortoiseSVN -> 检查修改。如果检测到更改，则可能需要忽略这些文件。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-13T01:06:38.610

像[nmaven](http://incubator.apache.org/nmaven/)这样的工具可以帮助解决依赖性问题，（尽管您可能需要查看[java maven](http://www.google.com/search?q=maven)文档以获取信息......）

[像Cruisecontrol](http://ccnet.thoughtworks.com/)这样的持续集成工具会在每次签入后重复签出并构建您的应用程序，这可以提醒您签入会破坏构建...此外，它们可以运行您的单元测试，从而提醒您任何由以下原因引起的回归你的签到也...

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-13T03:10:24.367

> 其他人可以提出一些建议吗？

1.  将您需要构建的文件保存在一个地方（一个目录及其子目录）......大多数版本控制系统将其称为“工作目录”
2.  您的版本控制软件有一个命令可以列出您的工作目录中的内容和版本控制下的内容之间的差异......这个“差异”包括工作目录中存在的文件和不受版本控制的文件
3.  调整您的版本控制软件以排除（从步骤 2 显示的列表中）您不想存储类型的文件......例如，您可能只想存储源代码，并排除`*.obj`等等......排除这些文件类型意味着当您运行第 2 步时，差异列表不会挤满您不打算存储的文件
4.  考虑拥有一台构建机器，它会自动进行签出和构建（如果“构建被破坏”，它会向您发送电子邮件）

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-13T06:06:22.623

Debian Linux 有一个非常棒的工具叫做[`pbuilder`](http://www.netfort.gr.jp/~dancer/software/pbuilder-doc/pbuilder-doc.html)，它创建一个新安装的系统的镜像，然后尝试构建你的代码。它仅适用于 Debian 软件包系统，但您可以窃取这些想法，这非常好。

*从 chrooted 环境或看起来像全新安装的虚拟机*自动构建。*然后，您的构建脚本将安装 DLL 等。或者您的配置脚本将枚举缺少的依赖项（所有依赖项，而不仅仅是第一个）。*

 *现在是凌晨 1 点，我听起来语无伦次，但有两个想法很重要：

*   拥有可以模拟空白系统的虚拟机或 chroot 目录。如今，虚拟机可能是最简单的。

*   调整您的构建系统，直到它自动检查并在您的虚拟机上构建——或者抱怨缺少什么。

到那时，您可以将该过程作为自动化夜间构建的一部分，您将成为一个快乐的露营者 :-)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-13T01:07:38.140

任何资源/DLL/设置都应与源代码一起检查到版本控制中。

它们应该被标记并与源代码同等对待，这将允许您将这些资源与源相关联并将源代码/资源/设置视为一个实体。

在我的公司，我们使用 Rational ClearCase。 除了生成的源代码文件（例如，从 MIDL 编译器生成的 .cpp 和 .h 文件）之外，所有内容**都被检查到源代码控制中。**因此，大多数构建都相当顺利。

您还需要确保正确设置了依赖项，以便在更改源文件时，将重新构建所有依赖库。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-13T03:17:21.030

您可以建立一个全面的清单，在每次签入之前查阅该清单 - 但这会很耗时且容易出错（尤其是在多个开发人员中，并不是每个人都具有每次都密切关注清单的性格特征）。

相反，设置一个简单的持续集成服务器[——CruiseControl.Net](http://ccnet.thoughtworks.com/)是开源的；[JetBrains 的TeamCity](http://TeamCity)是免费的 - 每次签入时都会检查构建工作。

通过这种方式，您可以肯定地知道——而不是因为遵循了清单就推断事情有效。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-13T03:22:40.863

SCons 是另一个跨平台工作的工具，可以帮助管理您的依赖项。与 gnu make 类似，您有一个“scons 文件/脚本”——它使用 python 的事实为您提供了很大的灵活性。

[http://www.scons.org/](http://www.scons.org/)

（我与 SCons 没有任何关系；我们只是使用它）

# c# - 鼠标捕捉失败？

> ID：437639
> 
> 赞同：19
> 
> 时间：2009-01-13T00:58:00.327
> 
> 标签：c#, wpf

无论光标是否在我的应用程序窗口上，我都希望能够访问鼠标的坐标。

当我使用 Mouse.Capture(IInputElement) 或 UIElement.CaptureMouse() 时，两者都无法捕获鼠标并返回 false。

我的问题可能是什么？

我的窗口的cs文件如下：

```
using System.Windows;
using System.Windows.Input;

namespace ScreenLooker
{
    /// <summary>
    /// Interaction logic for Window1.xaml
    /// </summary>
    public partial class Window1 : Window
    {
        public Window1()
        {
            InitializeComponent();

            bool bSuccess = Mouse.Capture(this);
            bSuccess = this.CaptureMouse();
        }

        protected override void OnMouseMove(MouseEventArgs e)
        {
            tbCoordX.Text = e.GetPosition(this).X.ToString();
            tbCoordY.Text = e.GetPosition(this).Y.ToString();
            //System.Drawing.Point oPoint = System.Windows.Forms.Cursor.Position;
            //tbCoordX.Text = oPoint.X.ToString();
            //tbCoordY.Text = oPoint.Y.ToString();

            base.OnMouseMove(e);
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-01-13T10:57:22.817

传递给的控件`Mouse.Capture()`需要是**Visible**和**Enabled**。

尝试将 Mouse.Capture 放在`Loaded`事件处理程序中，例如

在 XAML 中：

```
<Window ... .. .. Title="My Window" loaded="Window_Loaded">
...
</Window> 
```

在代码中：

```
private void Window_Loaded(object sender, RoutedEventArgs e)
{
  var b = Mouse.Capture(this);
} 
```

我之前没有捕捉到整个窗口，所以不确定它是如何工作的。它的典型用法是。

1.  MouseDown:- 调用`Mouse.Capture()`子控件
2.  MouseMove:- 处理鼠标的 X 和 Y 坐标
3.  MouseUp：- 调用`Mouse.Capture(null)`以清除鼠标事件捕获。

# c# - 为什么在 C# 接口名称前加上“I”

> ID：437649
> 
> 赞同：32
> 
> 时间：2009-01-13T01:03:03.483
> 
> 标签：c#, naming-conventions, interface

这种命名约定背后的基本原理是什么？

我没有看到任何好处。额外的前缀只会污染 API。

我的想法与康拉德对这个相关问题的[回答](https://stackoverflow.com/a/222502/9898)是[一致](https://stackoverflow.com/questions/222457)的；选择的[答案](https://stackoverflow.com/a/222500/9898T)主要是我在这里要求的。

* * *

## 回答 #1

> 赞同：54
> 
> 时间：2009-01-13T01:13:22.230

完全相反，命名约定清楚地标识了一个接口。

例如，如果您有：

```
public class Dog : IPet, IMammal
{
    .... 
```

仅仅通过阅读它，我可以有把握地假设 IPet 和 IMammal 可能是接口。

.NET CLR 允许单类继承。所以，如果我有一个基类..我只能从它继承一个类。让我们将 IPet 接口更改为基类..我们的示例现在变为

```
public class Dog : Pet, IMammal
{
    .... 
```

我从 Pet 类继承并实现 IMammal 接口。

如果我们按照您的建议执行并删除了字母“I”，我们将得到：

```
public class Dog : Pet, Mammal
{
    .... 
```

我从哪个类继承？我正在实现哪个接口？它会变得混乱吗？（仅供参考..您应该始终将基类放在首位，因此您可以争论这一点...但是如果您主张从接口名称前缀中删除字母 I，我怀疑您是否也遵循了这种做法）

正如您所看到的，命名约定很容易告诉我很多关于我的对象的信息，而无需我进一步调查。我可以很容易地看到我正在继承什么与我正在实施什么。

* * *

## 回答 #2

> 赞同：31
> 
> 时间：2009-01-13T01:11:28.333

我也喜欢它，因为我可以将它读作“IcanSave”或“IDoDoubleEntry”等中的“I verb-behavior”……

* * *

## 回答 #3

> 赞同：26
> 
> 时间：2009-01-16T17:39:04.560

我认为 IInterface 命名约定很愚蠢。这是匈牙利符号的一个例子，我赞同鄙视匈牙利符号的思想流派。如果您的接口只有一个具有相同名称的实现，请考虑这是代码异味的可能性。

但是，我仍然使用它，因为在这种情况下，IInterface 是微软推荐的，“标准胜过更好”。

* * *

## 回答 #4

> 赞同：17
> 
> 时间：2010-10-12T18:11:59.437

为什么这不是句法突出显示而不是匈牙利符号的功能？如果区分类和接口非常重要，为什么 IDE 不将引用接口的标识符用斜体表示。我讨厌在字段之前放置“ *”或“m* ”，在类之前放置“C”等等。更糟糕的是，它鼓励程序员编写非常糟糕的 API，例如：

```
public class List : IList 
```

而不是更合理的：

```
public class LinkedList : List
public class ArrayList : List
public class HashList : List 
```

甚至 .NET 通用类的作者也落入了这个陷阱。类名永远不应该是只删除“I”的接口名称。类名应始终告诉用户该类与接口的其他可能实现有何不同。仅出于这个原因，我投票赞成放弃愚蠢的“我”。

另外，当我使用智能感知时，我想按功能区域对事物进行分组，而不是按类还是接口。我从来没有想过，“我需要一个接口，而不是一个类。” 我总是在想，“我需要做 X 的东西”。

* * *

## 回答 #5

> 赞同：11
> 
> 时间：2009-01-13T01:29:23.150

实际上，我发现避免命名冲突很有用，例如，我可能会创建一个名为 Fred 的具体类来实现 IFred

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2009-10-30T16:43:41.020

我一直认为将动词用于行为界面很有趣。这与使用名词的类命名约定背道而驰，但它允许类“说出”它的行为。

```
class Dog: IBark 
```

这对于 WCF 接口之类的结构化接口效果不佳，但我们不需要一直玩得开心。

要回答您的问题，请将其`I`视为“实现”所以...

```
class DogDataService : Dog, IDataService 
```

该服务类继承自`Dog`并实现`IDataService`

我仍然没有真正回答你的问题，但`I`它很有用，因为你会在命名空间、类和接口之间遇到命名冲突。

```
namespace DataService
interface DataService
class DataService: DataService 
```

所以我们最终得到

```
namespace DataServices
interface IDataService
class DataService : IDataService 
```

我认为实际上，这是一个理智的约定。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2011-12-23T12:02:09.163

如果您考虑两个“最佳实践格言”

*清晰为王*

和

*噪音不好*

这些之间存在冲突。问题是：什么时候清晰变成噪音？

对我来说，写起来`Person person = new PersonImpl()`比`IPerson person = new Person()`.

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2010-09-03T23:03:28.763

“I”约定似乎是一个与今天无关的旧约定。当前的代码编辑器提供了有关您正在使用的类型的大量见解，因此认为更容易识别接口就像要求命名空间以“N”为前缀，因为您想确保不会混淆它一个具体的类（带有“C”的前缀？）。

约定并不意味着它是一个好的约定。有时候，这只是因为人们开始使用它......

以 C# 文档生成器为例：它不关心它...如果您的界面没有以“I”为前缀，您仍然会在文档的界面部分看到您的界面。您真的认为在文档的接口部分中为所有接口添加前缀“I”是相关信息并帮助您更好地识别接口吗？

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2009-01-13T01:05:07.053

要么就是这样，要么在接口的实现中添加“Impl”（啊）。我对“我”没有意见，它是对接口的最简单直接的命名。

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2016-08-05T12:13:08.733

区分接口和类的需要实际上表明存在设计缺陷。在设计良好的应用程序中，它总是很清楚。一个子类应该始终是一个专业化，并且类只能专注于一个学科，永远不会更多。

一个类应该有一个存在的理由。永远不应要求将次要角色放在基类中。例如：

```
public class XmlConfigurationFile : ConfigurationFile, IDisposable
{
}

public class YamlConfigurationFile : ConfigurationFile, IDisposable
{
} 
```

第一个是专门针对 Xml 的配置文件，第二个是专门针对 Yaml 的配置文件。这些也是一次性的，但这并不重要。由于处理过程不同，您没有创建这两个类。

将此与以下内容进行对比：

```
public class XmlConfigurationFile : IDisposable, ConfigurationFile
{
} 
```

这将告诉您 XmlConfigurationFile 的主要目的是它是一次性的。您可以将其用作表示配置文件的一种方式，这很好，但只是次要的。

当您创建具有多种存在原因的类时，问题就开始了：

```
public class MyConfigurationFile : XmlConfigurationFile, YamlConfigurationFile
{
} 
```

即使 XmlConfigurationFile 和 YamlConfigurationFile 本来是接口，它仍然表明设计不好。你的配置文件怎么能同时是xml和yaml呢？

如果您通读给出的示例（此处和其他地方），人们总是很难找到 I 前缀何时重要的好示例。这里的答案之一是：

```
public class Dog : Pet, Mammal
{
} 
```

这就是这个类在一个关于宠物的应用程序中的样子。狗的主要目的是成为专门的宠物，可以做与宠物相关的事情，而不是哺乳动物。

```
public class Dog : Mammal, Pet
{
} 
```

这就是同一类在有关动物分类的应用程序中的外观。很高兴知道狗是宠物，但它的主要目的是成为一种专门的哺乳动物，可以做与哺乳动物相关的事情。

我认为您的课程应该告诉您有关应用程序架构和领域的正确故事。要求接口以“I”为前缀是一项技术要求，并不能帮助您更好地讲述应用程序的故事。

一旦你开始编写小型的、专用的、单一用途的类，了解它是实现还是扩展的需求将自动消失。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2009-01-13T01:05:02.810

它使其易于识别为接口。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2009-01-13T01:12:15.947

命名约定的好处是在您使用对象之前告诉您一些有关该对象的信息。命名约定已被广泛使用多年，一直追溯到 fortran 坚持整数值被限制（如果我没记错的话）为变量名称，如“i”和“j”。

匈牙利符号将命名约定提升到了一个全新的丑陋水平，它描述了变量类型，无论它是否是指针等。我们中的许多人接触到大量使用匈牙利符号的代码时都会出现紧张的抽搐和口吃。

使用 I 为接口名称添加前缀是一种识别该对象的相对低影响、无害的方式。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2015-11-14T08:21:36.533

**TL;DR - 提取`interface IFoo`自在`class Foo`SOLID 解耦中很常见，尤其是用于单元测试目的**

对我来说，类`Foo`实现接口的双重约定`IFoo`（特别是如果两者都在同一个程序集中）传达了一个特定的意图：

*   将依赖项耦合到 a`Foo`应该始终是间接的，通过相应的`IFoo`接口（并且可能通过 IoC 容器注入）
*   的初始设计`IFoo`是一个专有的、不可重用的接口，专门允许依赖的类`Foo`在单元测试期间模拟这种依赖关系。
*   除此之外，读者不需要在`IFoo`界面设计中推断出任何额外的智能
*   相反，如果稍后需要多个具体的实现类，`IFoo`则需要将适当的接口隔离设计改进到层次结构中。

**基本原理**

为了能够模拟或存根一个类，单元测试中广泛接受的最佳实践是仅通过接口解耦类之间的依赖关系。这种接口解耦也将用于类，否则这些类将[永远不会对多态性有设计要求](https://softwareengineering.stackexchange.com/questions/159813/do-i-need-to-use-an-interface-when-only-one-class-will-ever-implement-it)（即，如果没有单元测试的需要，只会存在一个这样的实现）。

因此，这些接口的重构和重用（例如 的[接口隔离原则`SOLID`](https://en.wikipedia.org/wiki/SOLID)）并不经常应用于此类“可模拟”接口 - ' 的公共方法、属性和事件之间通常存在 1:1 的相关性mockable' 类 ( `Foo`) 及其解耦接口`IFoo`（类似于[VB 中 COM 时代的自动接口](https://msdn.microsoft.com/en-us/library/ms973861.aspx#interinher_topic6)）。

诸如[VS](https://msdn.microsoft.com/en-us/library/fb3dyx26.aspx)和 Resharper 之类的工具可以使从类中提取此类公共符号到单独的接口中变得微不足道，作为事后的想法。

此外，如果我们考虑像 Moq 这样的 Mocking 框架允许动态[定义接口的实现](https://github.com/Moq/moq4/wiki/Quickstart#methods)，我们就不必浪费精力来命名具体的测试双重实现类。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2010-04-30T00:20:15.253

这只是一个命名约定，所以每个人都会知道它是接口还是其他东西，它不是强制性的，也不是编译器或 IDE 的，但我一生中看到的所有接口都以字母 I 开头

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2010-04-30T00:42:19.820

首先，我认为前缀 I then description 是错误的，因为这意味着实现可以有一个更短的名称。IList (intf) -> 列表。这是一种反模式，因为我们都知道我们应该在创建时使用 intf 并且可能只使用具体类型。不要激怒我，这是一个概括，但前提是 intf 很少 impl 。实现名称应该描述它如何实现 intf 或它在做什么。想想intf List，LinkedList，它使用链表实现List。谁在乎它是否更长，因为我们大部分时间都应该使用 List 。如果我们有一个实现许多 intf 的类，我们可能不应该包含所有 intf 作为类的真正目的的影子。在没有 intf 的情况下删除的东西是有意义的。例如，人们叫我的名字而不是人，兄弟，使用我的名字的开发人员等是最好的最具描述性的名字。我想如果一个类是一个简单的 intf 然后调用它 Default Intf 这使得它在 ious 这是 Intf 的默认实现。类的名称最终应该是人类可读的，并且几乎是描述其目的的简短短语。前缀代码等并不是很好，因为我们用文字而不是代码进行交流。计算机并不关心类的名称，所以剩下的就是我们为事物命名，以便这些名称对我们和我们的同事有所帮助。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2013-11-29T03:31:16.093

我似乎是匈牙利符号的传统约定。 [接口命名指南](http://msdn.microsoft.com/en-us/library/8bc1fexb%28v=vs.71%29.aspx)说“在接口名称前加上字母 I，表示该类型是一个接口。” [框架设计指南](http://msdn.microsoft.com/en-us/library/ms229040.aspx)还说“DO 在接口名称前加上字母 I，表示该类型是一个接口。”

这只是一个编码约定，因此很难确定好坏。重要的是一致性。

* * *

## 回答 #17

> 赞同：-1
> 
> 时间：2009-01-13T01:10:11.067

最有可能让它在智能感知中易于识别，因为所有接口都会聚集在一起。类似于我如何在我的所有 UI 控件前加上 btn、tb、lb。当智能感知启动时，所有东西都聚集在一个简单的组中。

* * *

## 回答 #18

> 赞同：-1
> 
> 时间：2014-10-27T16:48:12.110

有了关于命名约定的所有争论，并为变量和方法赋予正确的名称，这些变量和方法实际上描述了它们的作用......为什么不只是命名你的接口（例如 PetInterface、PlayerInterface 等）并取消前缀“I”所有一起。所以你必须输入额外的 9 个字母，至少“I”被删除，我们知道它不是一个类，因为它说“接口”。

# java - selectOne 和 selectMany 选项是否受 SelectItems 限制？

> ID：437663
> 
> 赞同：2
> 
> 时间：2009-01-13T01:12:52.887
> 
> 标签：java, validation, jsf, parameter-spoofing

JSF selectOne 和 selectMany 控件是否只允许提交给定 selectItems 中定义的值？我担心参数欺骗，如果这是内置的，我不需要验证器来确保所选值是有效选择之一。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-13T02:10:27.140

是的，确切地说。不，您不需要验证来确保没有参数欺骗。我记得，当需求相反时，我需要在一年前自定义行为。

# xml - Oracle：如何使用 XMLElement() 在特定命名空间中创建元素

> ID：437670
> 
> 赞同：1
> 
> 时间：2009-01-13T01:17:56.310
> 
> 标签：xml, oracle

在 Oracle 中，您可以使用[XMLElement()](http://download.oracle.com/docs/cd/B28359_01/server.111/b28286/functions230.htm#i1129193)函数来创建元素，如下所示：

```
XMLElement('name', 'John') 
```

但是如何在特定的命名空间中创建元素呢？例如，如何创建以下元素：

```
<my:name xmlns:my="http://www.example.com/my">John</my:name> 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-02-20T22:52:58.510

您还可以使用 XMLAttribute：

```
select xmlelement("my:name",
        xmlattributes('http://www.example.com/my' as "xmlns:my"),
        'John'
       )
from dual 
```

将返回：

```
<my:name xmlns:my="http://www.example.com/my">John</my:name> 
```

您还可以检查 Oracle 是否将其识别为命名空间（除了您没有得到*命名空间前缀“my”未声明*错误）：

```
select xmlelement("my:name",
        xmlattributes('http://www.example.com/my' as "xmlns:my"),
        'John'
       ).getnamespace()
from dual 
```

将返回：

```
http://www.example.com/my 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-13T01:25:14.390

而不是`XMLElement()`使用：

```
XMLType('<my:name xmlns:my="http://www.example.com/my">John</my:name>') 
```

是的，就是这么简单。

# c# - 如何在没有代码隐藏文件的情况下创建 ASMX Web 服务页面

> ID：437674
> 
> 赞同：8
> 
> 时间：2009-01-13T01:19:22.453
> 
> 标签：c#, asp.net

我已经能够在没有代码的情况下创建 ASPX 页面，但我一生都无法找出神奇的组合来让 ASMX 页面在没有代码的情况下工作。这甚至可能吗？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-01-13T01:34:33.640

快速示例：

```
<%@ WebService Language="C#" Class="SampleWebService" %>
using System;
using System.Data;
using System.Web;
using System.Collections;
using System.Web.Services;
using System.Web.Services.Protocols;

[WebService(Namespace = "http://tempuri.org/")]
[WebServiceBinding(ConformsTo = WsiProfiles.BasicProfile1_1)]
public class SampleWebService : System.Web.Services.WebService
{

    [WebMethod]
    public string Hello()
    {
        return "Hello World!";
    }

    [WebMethod]
    public string DoStuff(out string stuff)
    {
        stuff = "Woohoo!";
        return "OK";
    }
} 
```

# collision-detection - 游戏物体和地板之间在重力方面的碰撞？

> ID：437676
> 
> 赞同：15
> 
> 时间：2009-01-13T01:20:35.337
> 
> 标签：collision-detection, gravity

重力游戏如何处理玩家、怪物或物体等移动物体与地板之间的关系？球员是否经常“落入”地板并被弹起来？

我发现对碰撞做出反应的两种方法是将玩家移回碰撞前的先前位置，并在移动之前测试新位置以查看是否会导致碰撞，但我不知道其中任何一个如何可以处理一个向上上升的平台，需要能够抬起玩家。我从 2D 游戏设计的角度来看这个问题，但我想同样的问题也会出现在 3D 游戏设计中。有什么提示吗？我应该查看任何参考资料吗？谢谢。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-01-13T02:26:01.773

您可能想查看[GameDev.net 的 Gravity 常见问题](http://www.gamedev.net/reference/articles/article694.asp)以了解一些基本信息。

由于您正在制作游戏而不是高度精确的物理建模器，因此我们可以进行[欧拉积分](http://en.wikipedia.org/wiki/Euler%27s_method)。如果您对准确性的需求增加，我看到使用的最流行的集成方法是[Runge-Kutta (RK4) 集成](http://en.wikipedia.org/wiki/Runge-Kutta_methods)。对于简单的游戏，您很可能不需要这些，但它们肯定用于更高级的物理模拟和 3D 游戏。使用 RK4 的缺点是稍微增加了复杂性并且稍微慢了一点。虽然它非常准确，但现在，让我们坚持使用好的 ole Euler。

我问了一个类似的问题，“[我如何在弹跳球比赛中应用重力](https://stackoverflow.com/questions/342189/how-do-i-apply-gravity-to-my-bouncing-ball-application)”，并得到了几个很好的答案。你要做的第一件事是为你的游戏选择一个任意的重力常数。在我的弹跳球应用程序中，我使用 2000px/s 的默认重力常数。您需要使用此重力常数来获得特定游戏所需的效果。

接下来，您要确保您正在渲染您的游戏并独立更新您的游戏对象。这是为了防止您的游戏内对象在快速计算机上移动得非常快，而在慢速计算机上移动得慢。您希望对象移动的物理特性和速度独立于计算机速度。一篇关于这方面的好文章是[游戏物理：修正你的时间步长！](http://gafferongames.wordpress.com/game-physics/fix-your-timestep/).

那么我们该怎么做呢？您可以跟踪自上次调用 Update 方法以来已经过去了多少时间。我创建了 2 个线程，尽管它不是直接必需的。我有一个游戏更新线程和一个渲染线程。更新线程控制更新游戏对象的位置。更新线程知道它之前被调用的时间、当前时间，并从中计算自调用更新方法以来经过的时间。

为了应用重力，我们只需将我们的重力常数乘以经过的时间加到物体的 Y 速度上。

```
private long previousTime = System.currentTimeMillis();
private long currentTime = previousTime;

public void updateGame()
{
    currentTime = System.currentTimeMillis();
    float elapsedSeconds = (currentTime - previousTime) / 1000f; 

    foreach(GameObject gameObject in gameObjects)
    {
        // Apply gravity to velocity vector
        gameObject.velocity.y += (gravityConstant * elapsedSeconds); 

        // Move objects x/y position based off it's velocity vector
        gameObject.position.x += (gameObject.velocity.x * elapsedSeconds); 
        gameObject.position.y += (gameObject.velocity.y * elapsedSeconds);

    }

    checkCollisions();

    previousTime = currentTime;
} 
```

这将根据您的速度矢量移动所有对象，并根据您的重力常数对它们应用重力。最重要的是，它独立于计算机速度！

要回答您的另一个问题，是的，物体的 y 向量上会不断地具有重力“力”。所以它会不断地与地板发生碰撞。但是，您想要做的一件事是使用[Epsilon 值](https://stackoverflow.com/questions/354680/using-an-epsilon-value-to-determine-if-a-ball-in-a-game-is-not-moving)最终使您的游戏对象的速度为零。然后，在作为修剪过程的一部分的碰撞检测期间，您通常可以跳过检查非移动物体是否与任何物体发生碰撞（反之亦然！）。

我喜欢对碰撞做的事情是，一旦我发现物体发生碰撞（相互穿透），我会将它们分开的最小平移距离（MTD）将它们分开。这一步很关键，否则你会得到游戏中常见的错误，即物体“卡”在一起抖动移动。一旦它们分开，我就会计算我的碰撞响应。

使用这种方法，它将在您描述的上升平台场景中正常工作。平台会继续上升，游戏对象会使用自身与平台之间的MTD将自己分开，它自然会随之上升。

如果您在碰撞响应方面需要帮助，我建议您查看：

*   [球对球碰撞检测和处理（包括源）](https://stackoverflow.com/questions/345838/ball-to-ball-collision-detection-and-handling)
*   [没有三角学的二维碰撞.pdf](http://www.geocities.com/vobarian/2dcollisions/2dcollisions.pdf)
*   [添加碰撞检测](http://geekswithblogs.net/robp/archive/2008/05/15/adding-collision-detection.aspx)
*   [GameDev.net 论坛！](http://www.gamedev.net/community/forums/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-13T03:43:13.677

在某些游戏中使用的一种方法是作弊：为行走和在空中设置单独的状态。在行走时，游戏引擎可以确定所走过的表面的坡度，如果不是太陡，则沿表面方向移动角色，并为角色提供相对于表面的适当垂直位置。

至于物理学，我正在成为[Gamasutra: Advanced Character Physics](http://www.gamasutra.com/resource_guide/20030121/jacobson_01.shtml)中描述的 verlet 集成的粉丝。它简化了物理更新方程（不必跟踪速度！），它简化了碰撞（不必调整速度！）。也就是说，如果您需要准确性，它确实有[一些细微差别。](http://www.gamedev.net/reference/articles/article2200.asp)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-13T01:30:47.937

关于这个主题的最完整的教科书之一是[Christer Ericson的](http://www.amazon.com/exec/obidos/tg/detail/-/1558607323?tag=realtimecolli-20)[*Realtime Collision Detection*](http://www.amazon.com/exec/obidos/tg/detail/-/1558607323?tag=realtimecolli-20)。他也有[一个同伴博客](http://realtimecollisiondetection.net/)。Eric Lengyel 的[*3D 游戏编程和计算机图形学数学*](https://rads.stackoverflow.com/amzn/click/com/1584502770)也很有用。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-13T01:37:31.793

我不是专门的游戏程序员，但这是我的理解：

*   在具有“无限帧速率”的理想世界中，您会在碰撞发生的那一刻准确地检测到碰撞，并使用一些标准物理学来模拟碰撞后物体的新速度和加速度（参见标准高学校力学教科书，或各种题为“游戏程序员物理学”之类的书籍）
*   实际上，因为你有一个固定的帧速率，因此物体只能以一定的粒度移动，你通常需要添加一个额外的技巧，比如提前计算物体在下一帧中移动的相对路径，看看是否有任何路径相交
*   如果它们确实相交，那么相交点实际上将是对物体真正碰撞的点的*估计*，但稍微不准确；然后，您可以选择不关心并将该估计值作为交点并进行线性插值以获得碰撞点的速度，或者现在您已经发现它们将相交进行更精确的计算以获得实际碰撞点/时间/速度

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-13T02:22:21.437

除了模拟碰撞之外，一个好的方法是模拟能量的持续传递（或动量，或只是速度，取决于模拟的复杂性）。当您的玩家站在平台上时，将该信息存储在代表平台的对象中，并且任何时候调整对象的速度，您都可以直接将该更改应用到如此链接的玩家或其他对象。

# eclipse - Eclipse：嵌套编辑器选项卡？

> ID：437677
> 
> 赞同：6
> 
> 时间：2009-01-13T01:21:05.507
> 
> 标签：eclipse, eclipse-plugin

有人知道允许嵌套编辑器选项卡的任何方法（或外部插件）吗？能够将相关的打开文件分组到他们自己的“主”选项卡中会很好，但我不确定这是否可能。有任何想法吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-13T04:24:27.167

这完全不明显，我是偶然发现的，但是...

如果您单击一个选项卡并开始向下拖动它，一旦您在编辑器窗格中向下拖动超过一半，就会出现一条水平线。放手，现在您将拥有两个不同的编辑器窗格，每个窗格都有文档选项卡。现在，您可以在两个窗格之间上下拖动选项卡以同时查看不同的文档。

我认为这是尽可能接近的。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-13T03:55:26.287

我认为您目前可以做的最好的事情是“窗口->新窗口”，然后将每个新窗口用作相关编辑器的单独“选项卡”。我承认，并不完全理想。

不过，这是一个很酷的主意，特别是如果您可以使用快捷方式或使用单个命令打开编辑器组的东西。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-13T04:09:00.817

这在当前的 RCP 中绝对是不可能的。您可能能够构建一个编辑器组件，该组件创建一个`CTabFolder`并委托给其他编辑器组件，但我不确定它的效果如何。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-06-03T10:41:49.323

Eclipse 中有一些*Perspectives*可以用来实现接近的目标，尽管它们是更全球化的东西......

但我同意你的看法，我也想要这个功能！这在编辑许多具有相同名称但来自不同包的文件时也非常有用，因为现在它是一团糟>_<

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-10-30T16:51:44.663

对我来说，这种功能的用途是减少上下文切换时间。我正在处理项目 A，打开了很多编辑器，现在我需要删除它并处理项目 B。我想让所有与项目 A 关联的编辑器保持打开状态，但在处理 B 时隐藏它们。当我完成 B 后，我可以从 A 中中断的地方继续，而无需再次查找并打开所有 A 文件；我什至可以无限期地让它们不被保存，因为朱诺从不崩溃！！:)

我已经使用了新窗口功能，它很棒，但是新窗口需要一堆配置（关闭我不需要的视图，将东西移动到我想要的位置，打开我在旧窗口中打开的视图，以及等等）在我开始工作之前。它还比简单的选项卡组使用更多的内存，因为它似乎是 Eclipse 的全新副本。

拆分窗口功能很棒，我一直都在使用它。它确实是选项卡组，如果有办法隐藏选项卡组，并且每个选项卡组都有自己的选项卡列表（当你点击“>>5”时你会得到这样你可以看到你打开的编辑器不适合选项卡标题），它将完全满足要求。

# delphi - 如何获取 Delphi 程序使用的内存

> ID：437683
> 
> 赞同：53
> 
> 时间：2009-01-13T01:26:32.563
> 
> 标签：delphi, memory-management, fastmm

我知道如何使用 GlobalMemoryStatusEx 获取系统内存使用情况，但这告诉我整个操作系统正在使用什么。

我真的希望我的程序报告它单独分配和使用了多少内存。

我的 Delphi 2009 程序中是否有任何方法可以调用 Windows 函数或某些 FastMM 函数来找出仅由我的程序分配的内存？

* * *

重新审视我的问题，我现在已将我接受的答案更改为 @apenwarr 的 GetMemoryManagerState 答案。它产生的结果与我过去使用的 GetHeapStatus 函数（现已弃用）相同，而 GetProcessMemoryInfo.WorkingSetSize 给出了非常不同的结果。

* * *

## 回答 #1

> 赞同：82
> 
> 时间：2009-02-17T19:08:04.003

您可以从 Delphi 运行时中获取有用的内存使用信息，而无需使用任何直接 Win32 调用：

```
unit X;

uses  FastMM4; //include this or method will return 0.
....

function GetMemoryUsed: UInt64;
var
  st: TMemoryManagerState;
  sb: TSmallBlockTypeState;
begin
  GetMemoryManagerState(st);
  result :=  st.TotalAllocatedMediumBlockSize
           + st.TotalAllocatedLargeBlockSize;
  for sb in st.SmallBlockTypeStates do begin
    result := result + sb.UseableBlockSize * sb.AllocatedBlockCount;
  end;
end; 
```

这种方法最好的地方是它被严格跟踪：当你分配内存时，它会上升，而当你释放内存时，它会立即下降相同的数量。我在运行每个单元测试之前和之后都使用它，所以我可以判断哪个测试正在泄漏内存（例如）。

* * *

## 回答 #2

> 赞同：26
> 
> 时间：2009-01-14T08:26:14.867

[来自我的一篇旧博文](https://web.archive.org/web/20160626214112/http://www.davinciunltd.com/2007/12/current-process-memory)。

想知道您的程序使用了多少内存？这个 Delphi 函数可以解决问题。

```
uses psAPI;

{...}

function CurrentProcessMemory: Cardinal;
var
  MemCounters: TProcessMemoryCounters;
begin
  MemCounters.cb := SizeOf(MemCounters);
  if GetProcessMemoryInfo(GetCurrentProcess,
      @MemCounters,
      SizeOf(MemCounters)) then
    Result := MemCounters.WorkingSetSize
  else
    RaiseLastOSError;
end; 
```

不知道我从哪里得到了这个基础知识，但我添加了一些更好的错误处理并使它成为一个函数。WorkingSetSize 是当前使用的内存量。您可以使用类似的代码来获取当前进程（或任何进程）的其他值。您需要在您的使用声明中包含 psAPI。

*PROCESS_MEMORY_COUNTERS*记录包括：

*   PageFaultCount
*   峰值工作集大小
*   工作集大小
*   QuotaPeakPagedPoolUsage
*   QuotaPagedPoolUsage
*   QuotaPeakNonPagedPoolUsage
*   QuotaNonPagedPoolUsage
*   页面文件使用
*   PeakPagefileUsage

您可以在任务管理器或进程资源管理器中找到所有这些值。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-01-13T02:08:34.180

当您从 SourceForge 下载完整的 FastMM4 包时，您可以查看一个示例，了解如何将 FastMM 与演示附带的 UsageTrackerDemo 项目一起使用。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-01-13T02:56:29.713

我写了这个小函数来返回当前进程（app）的内存使用情况：

```
function ProcessMemory: longint;
var
  pmc: PPROCESS_MEMORY_COUNTERS;
  cb: Integer;
begin
  // Get the used memory for the current process
  cb := SizeOf(TProcessMemoryCounters);
  GetMem(pmc, cb);
  pmc^.cb := cb;
  if GetProcessMemoryInfo(GetCurrentProcess(), pmc, cb) then
     Result:= Longint(pmc^.WorkingSetSize);

  FreeMem(pmc);
end; 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2018-01-03T23:26:36.183

[将Gant](https://stackoverflow.com/users/12460/gant) C++ 代码转换为Delphi 中的控制台应用程序：

```
 program MemoryProcessCMD;

    {* Based in Gant(https://stackoverflow.com/users/12460/gant) code*}

    {$APPTYPE CONSOLE}
    {$R *.res}

    uses
      System.SysUtils,
      psapi,
      Windows;

    procedure PrintMemoryInfo(processID: DWORD);
    var
      hProcess: THandle;
      pmc: PROCESS_MEMORY_COUNTERS;
      total: DWORD;

    begin

      // Print the process identifier.
      Writeln(format('Process ID: %d', [processID]));

      // Print information about the memory usage of the process.
      hProcess := OpenProcess(PROCESS_QUERY_INFORMATION or PROCESS_VM_READ, FALSE,
        processID);

      if (hProcess = 0) then
      begin
        exit;
      end;

      if (GetProcessMemoryInfo(hProcess, @pmc, SizeOf(pmc))) then
      begin
        Writeln(format(#09'PageFaultCount: 0x%.8X', [pmc.PageFaultCount]));
        Writeln(format(#09'PeakWorkingSetSize: 0x%.8X', [pmc.PeakWorkingSetSize]));
        Writeln(format(#09'WorkingSetSize: 0x%.8X', [pmc.WorkingSetSize]));
        Writeln(format(#09'QuotaPeakPagedPoolUsage: 0x%.8X',
          [pmc.QuotaPeakPagedPoolUsage]));
        Writeln(format(#09'QuotaPagedPoolUsage: 0x%.8X',
          [pmc.QuotaPagedPoolUsage]));
        Writeln(format(#09'QuotaPeakNonPagedPoolUsage: 0x%.8X',
          [pmc.QuotaPeakNonPagedPoolUsage]));
        Writeln(format(#09'QuotaNonPagedPoolUsage: 0x%.8X',
          [pmc.QuotaNonPagedPoolUsage]));
        Writeln(format(#09'PagefileUsage: 0x%.8X', [pmc.PagefileUsage]));
        Writeln(format(#09'PeakPagefileUsage: 0x%.8X', [pmc.PeakPagefileUsage]));
        Writeln(format(#09'PagefileUsage: 0x%.8X', [pmc.PagefileUsage]));
      end;

      CloseHandle(hProcess);
    end;

    var
      aProcesses: array [0 .. 1024] of DWORD;
      cbNeeded, cProcesses: DWORD;
      i: Integer;

    begin
      try
        // Get the list of process identifiers.
        if (not EnumProcesses(@aProcesses, SizeOf(aProcesses), &cbNeeded)) then
          halt(1);

        // Calculate how many process identifiers were returned.
        cProcesses := cbNeeded div SizeOf(DWORD);

        // Print the memory usage for each process
        for i := 0 to cProcesses - 1 do
        begin
          PrintMemoryInfo(aProcesses[i]);
        end;
      except
        on E: Exception do
          Writeln(E.ClassName, ': ', E.Message);
      end;

    end. 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-13T01:34:22.313

对于 Win32 API 方式，您需要**GetProcessMemoryInfo**函数。[这是来自MSDN 页面](http://msdn.microsoft.com/en-us/library/ms682050(VS.85).aspx)的示例，但代码使用 C++。我认为您也可以将其转换为 Delphi。您正在查找的内容可能称为“工作集大小”。

```
#include <windows.h>
#include <stdio.h>
#include <psapi.h>

void PrintMemoryInfo( DWORD processID )
{
    HANDLE hProcess;
    PROCESS_MEMORY_COUNTERS pmc;

    // Print the process identifier.

    printf( "\nProcess ID: %u\n", processID );

    // Print information about the memory usage of the process.

    hProcess = OpenProcess(  PROCESS_QUERY_INFORMATION |
                                    PROCESS_VM_READ,
                                    FALSE, processID );
    if (NULL == hProcess)
        return;

    if ( GetProcessMemoryInfo( hProcess, &pmc, sizeof(pmc)) )
    {
        printf( "\tPageFaultCount: 0x%08X\n", pmc.PageFaultCount );
        printf( "\tPeakWorkingSetSize: 0x%08X\n", 
                  pmc.PeakWorkingSetSize );
        printf( "\tWorkingSetSize: 0x%08X\n", pmc.WorkingSetSize );
        printf( "\tQuotaPeakPagedPoolUsage: 0x%08X\n", 
                  pmc.QuotaPeakPagedPoolUsage );
        printf( "\tQuotaPagedPoolUsage: 0x%08X\n", 
                  pmc.QuotaPagedPoolUsage );
        printf( "\tQuotaPeakNonPagedPoolUsage: 0x%08X\n", 
                  pmc.QuotaPeakNonPagedPoolUsage );
        printf( "\tQuotaNonPagedPoolUsage: 0x%08X\n", 
                  pmc.QuotaNonPagedPoolUsage );
        printf( "\tPagefileUsage: 0x%08X\n", pmc.PagefileUsage ); 
        printf( "\tPeakPagefileUsage: 0x%08X\n", 
                  pmc.PeakPagefileUsage );
    }

    CloseHandle( hProcess );
}

int main( )
{
    // Get the list of process identifiers.

    DWORD aProcesses[1024], cbNeeded, cProcesses;
    unsigned int i;

    if ( !EnumProcesses( aProcesses, sizeof(aProcesses), &cbNeeded ) )
        return 1;

    // Calculate how many process identifiers were returned.

    cProcesses = cbNeeded / sizeof(DWORD);

    // Print the memory usage for each process

    for ( i = 0; i < cProcesses; i++ )
        PrintMemoryInfo( aProcesses[i] );

    return 0;
} 
```

# c++ - 减小 Windows 可执行文件大小

> ID：437685
> 
> 赞同：6
> 
> 时间：2009-01-13T01:28:30.437
> 
> 标签：c++, windows, dll, mfc, linker

我在 Windows 上有一个 C++/MFC 应用程序 - 动态链接它只有 60kb 静态它 > 3Mb。
它是通过电子邮件分发给客户的，因此需要尽可能小。

它静态链接 MFC 和 MSCVRT 库——因为它是对一些问题的修复，我不希望更多关于缺少库的支持调用——尤其是非常有用的“应用程序配置不正确”！

无论如何，有没有去除所有额外的 MFC 东西的 Windows exe，这些东西是 dll 但我没有使用？
或者告诉它动态链接MSVCRT（必须存在）但静态链接可能不存在的MFC dll？

编辑 - 谢谢你把它降到了 1.6Mb，这是必须的！

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-01-13T01:44:18.707

您不能混合 CRT/MFC dll。从记忆中走...

正如其他答案所建议的那样，您可以#define WIN32_LEAN_AND_MEAN 和 VC_EXTRALEAN。不过，这些可能无济于事。它们往往是关于最小化构建时间 - 而不是最终的 exe 大小。

没有重建 MFC（这是一个选项 - 你可以重建它 /Os，或者如果你觉得很厚脸皮， /GL - 但这可能会带来更多下游乐趣 - 希望它已经构建 /Gy）。

好的。简单的事情可以尝试。使用 /GL /Os /GF /Gy /GA 构建您的应用程序。在链接器中，您或多或少需要 /OPT:REF 和 /OPT:ICF 和 /LTCG。

我不得不说 - 从 30k 到 MB 的发布版本有点多。您还可以将 /map: 传递给链接器，看看是什么占用了所有空间 - 但这非常乏味。

几乎听起来 MFC 不是用 /Gy 构建的——但这会令人惊讶。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2016-09-28T03:50:53.347

对于使用 CRT 的程序，您可以使用[Per Vognsen](https://www.youtube.com/watch?v=5tg_TbURMy0)的视频中的技术来实现 3.5KB 的可执行文件。`Windows\System32\msvcrt.dll`自 95 年以来，每个 Windows 都附带，因此通过链接到它，您无需将 Visual C++ Redistributable 与您的应用程序打包在一起。

The basic process is:

1.  Run Visual Studio's `dumpbin` on `System32\msvcrt.dll` and pipe it to a file
2.  Run a simple filter (`awk '{print $4}'`) to create a `msvcrt.def` file
3.  Run VS's `lib` on `msvcrt.def` to generate `msvcrt.lib`
4.  Disable default libraries in your project (`/NODEFAULTLIB` on the `link` command line)
5.  Disable some Visual C++ checks (`/GS-` and remove any `/RTC<x>` flags)

Link against `kernel32.lib` and `msvcrt.lib` and voilà, your tiny executable has zero dependencies besides the OS.

(n.b.: To optimize for size (`/O1`), specify `memset` as an intrinsic as detailed [here](https://stackoverflow.com/a/2945619/3185819).)

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-01-13T01:46:47.420

我不知道如何剥离可执行文件，但另一个想法是压缩它，例如使用[upx](http://upx.sourceforge.net/)，它将解压缩并在适当的位置运行它......这是否会为您减少足够的大小？

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-13T05:16:15.407

您可以尝试[Dependency Walker](http://www.dependencywalker.com/)来检查您的静态 EXE 文件所依赖的 DLL，然后如果它依赖于您确定它存在于客户端计算机上的库，则可以在没有它的情况下进行编译并减小大小。

# javascript - 是否有不需要服务器的客户端（javascript）图形库？

> ID：437686
> 
> 赞同：2
> 
> 时间：2009-01-13T01:28:52.417
> 
> 标签：javascript, graph, client-side

我需要从数据流中生成许多内部客户端（仅限公司内部）图表，并且由于数据本身是“秘密的”，我不能使用像 Google-Graphs 这样的服务来生成图表。所以我想知道是否有人对不需要服务器的 javascript 图形库有一些建议。

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-13T01:49:42.890

看看[flot](http://code.google.com/p/flot/)一个 javascript 绘图库。

**编辑** 官方flot repo[位于github](https://github.com/flot/flot)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-13T01:44:12.277

看看[拉斐尔](http://raphaeljs.com/)（[github](https://github.com/DmitryBaranovskiy/raphael/tree)）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-13T01:36:28.627

如果您使用 javascript 库在客户端呈现数据，则数据可能会以纯文本形式呈现……即便如此，[jQuery Sparklines](http://omnipotent.net/jquery.sparkline/)也可以在客户端生成简单的图形。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-13T01:45:58.577

在查看 Nickf 的 canvasgraphjs 链接时，为 Mochi找到了一个名为[PlotKit的库。](http://www.liquidx.net/plotkit/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-13T03:39:17.193

如果您使用客户端库，则您的数据几乎是公开的。如果数据是秘密的，我认为您需要的是一个在服务器端生成绘图并输出图像的库。JFreechart 是一个在 Java 中执行此操作的库。我确信还有其他人。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-04-07T08:55:40.597

检查[D3.js](http://d3js.org/)：基于数据操作文档的 JavaScript 库。我自己还没有尝试过，但它看起来很有希望并且很有趣。

# regex - DFA -> 正则表达式

> ID：437698
> 
> 赞同：5
> 
> 时间：2009-01-13T01:35:05.197
> 
> 标签：regex, state-machine

我在纸上写了一个 DFA，想把它翻译成一组正则表达式。有人知道这样做的好工具吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-13T01:41:34.453

从我的小谷歌搜索中，我找到[了 JFLAP](http://www.jflap.org/getjflap.html)。他们还有一个关于[如何将 FA 转换为正则表达式](http://www.jflap.org/tutorial/fa/fa2re/index.html#convert)的教程。

> **JFLAP**
> 
> JFLAP 是用于试验形式语言主题的软件，包括非确定性有限自动机、非确定性下推自动机、多磁带图灵机、几种类型的语法、解析和 L 系统。除了为这些构建和测试示例之外，JFLAP 还允许人们尝试从一种形式到另一种形式的构造证明，例如将 NFA 转换为 DFA 到最小状态 DFA 到正则表达式或正则语法。单击此处了解有关 JFLAP 可以做什么的更多信息。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-13T02:12:59.320

如果您想要的是解析器，则无需将正则表达式转换为中间形式。`flex`您可以使用或相当直接地编写 DFA 代码[`re2c`](http://re2c.org/)。多个状态的编码并不常见，所以一开始感觉有点不自然（教程中没有很好地介绍），但是一旦你开始使用它，它真的很容易。

# php - 在 PHP 中搜索大数据，所有数字，10 亿字节

> ID：437704
> 
> 赞同：0
> 
> 时间：2009-01-13T01:37:59.670
> 
> 标签：php, indexing

我想知道如何快速搜索多达 10 亿字节数据的数据字符串。数据都是数字。目前，我们将数据拆分为 250k 个文件，并在每个文件上使用 strpos（最快的内置函数）进行搜索，直到找到某些内容。有没有办法可以索引让它更快？有什么建议么？

最终我想找到多次出现，到目前为止，这将通过 strpos 上的 offset 参数来完成。

任何帮助肯定会在需要的地方得到认可。

谢谢！- 詹姆斯哈蒂格

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-13T01:49:42.830

好吧，您的标签表明您应该做什么（我指的标签是“索引”）。

基本上，您应该有单独的文件，其中包含数据的索引。它将包含您正在查找的数据字符串，以及它所在的文件和字节位置。

然后，您将访问索引，查找您的值，然后在原始文件中找到数据字符串的位置，并从那里进行处理。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-13T15:19:22.197

哈希函数/表会起作用吗？还是后缀数组/树？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-13T04:40:20.863

彼得罗威尔的所有问题都与此相关。如果你绝对必须有一个开箱即用的答案，那么试试 grep。如果你愿意，你甚至可以从 PHP 中执行它。它比 strpos 快几个数量级。实际上，我们已经很好地将它用作无法处理索引的解决方案。

但同样，彼得的问题仍然适用。在深入研究解决方案之前，我会回答他们。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-13T01:57:28.303

一个好的答案可能需要你更具体一点。

1.  搜索查询需要多长时间？1位数？10位数？任意长度？

2.  “快”到什么程度才够快？1秒？10秒？1分钟？

3.  您预计每秒/分钟/小时的总查询数是多少？

4.  数据多久更改一次？每天？小时？连续？

5.  当您说“多次出现”时，听起来您的意思是重叠匹配。

6.  答案的“价值”是什么？对多少人？

10 亿已经不是以前的了，所以你可以只索引整个事物中的废话，并拥有一个是原始数据 10 甚至 100 倍的索引。但是，如果数据每分钟都在变化，那意味着您创建索引的周期比搜索它的周期要多。

您在解决方案中投入的时间和金钱是该解决方案价值的函数。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-13T01:58:35.230

你绝对应该找个女朋友。除了帮助你更好地度过你的时间，它还可以在不爆裂的情况下增加脂肪。哦，数据库也是如此。

# mysql - 如何在 Windows 和 Linux 中设置 MySQL 以使用 GMT

> ID：437712
> 
> 赞同：24
> 
> 时间：2009-01-13T01:42:01.627
> 
> 标签：mysql, date, time

我只是想让 MySQL 将时间存储在 GMT 中......

我在这里阅读了文档：http: [//dev.mysql.com/doc/refman/5.1/en/time-zone-support.html](http://dev.mysql.com/doc/refman/5.1/en/time-zone-support.html)

它说要在选项文件中设置：default-time-zone='timezone'。

但是，我用谷歌搜索了几个不同的术语，找不到“时区”应该是的可能值。我也不知道在 my.ini（以及 Linux 中的 my.cnf）中放置该指令的位置。低于 [msyqld] ？

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2009-01-13T20:26:36.037

转到 my.ini 文件的 [mysqld] 部分，然后在该部分下输入此行

> 默认时区 = '+00:00'

“+00:00”表示与 GMT 的偏移量，在您的情况下为 0。请注意字符串中的“+”号。

您不需要为您的问题安装任何时区表。重新启动服务器后，您的服务器将在 UTC 时区运行，因此 NOW() 将为您提供 GMT 时间。

默认情况下，MySQL 设置为您的系统时区，即。您的服务器时区与您的系统时区相同。所以你也可以改变你的系统时区来解决你的问题，尽管这是不推荐的。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2010-11-04T12:31:23.883

只需单击几下，区域名称列表如下所示：

```
select name from mysql.time_zone_name; 
```

请注意设置固定偏移区域，例如“GMT”或“+00:00”，因为它不会更改以匹配本地时间/DST 等。如果您希望它遵循本地时间，请将区域设置为“欧洲/伦敦” ' 反而。如果您不希望这样，无论如何我都会选择 UTC 而不是 GMT。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-13T01:57:30.037

默认情况下未加载 MySQL Timezone 表，这可能是您遇到困难的原因。您需要[加载时区表](http://dev.mysql.com/doc/refman/5.0/en/mysql-tzinfo-to-sql.html)，然后使用上述说明设置您的时区。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-04-18T20:15:03.487

我将它用于 GMT+2： SET GLOBAL time_zone = '+02:00';

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-13T02:04:49.677

去他妈的... DATETIME，虽然在查看表格时更容易让人眼前一亮，但不值得做这个噩梦。

我只是要使用TIMESTAMP。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-13T01:52:56.847

是的，这是 mysqld 的服务器选项，因此应该放在 [mysqld] 部分。

此外，关于值，请参阅[MySQL 5 权威指南](http://books.google.com/books?id=s_87mv-Eo4AC&pg=PA349&vq=default-time-zone#PPA349,M1)

# emacs - 如何使用 Cx k 杀死在服务器模式下打开的 Emacs 缓冲区？

> ID：437714
> 
> 赞同：5
> 
> 时间：2009-01-13T01:42:32.577
> 
> 标签：emacs

我使用 Windows 批处理文件使用 emacsclientw.exe 在已运行的 Emacs 实例中打开文件。但是，以这种方式打开的任何文件都是在服务器模式下打开的，这意味着我必须使用 Cx # 来杀死它，而不是通常的 Cx k。我该如何改变这种行为？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-13T03:27:26.640

我的解决方案是将它（实际上是 Mw）重新绑定到：

```
(lambda ()
  (interactive)
  (if server-buffer-clients
      (server-edit)
    (kill-this-buffer))) 
```

[编辑：现在已经阅读了服务器编辑的代码，最好使用服务器完成（取决于你想要什么）。server-edit 会将您切换到服务器编辑的缓冲区（如果仍然存在），但 server-done 只会将您切换到下一个缓冲区。您还可以使用 server-done 的输出来查看缓冲区是否实际被杀死（如果文件在调用 emacsclient 之前打开，则不是这种情况），如果没有，则将其杀死。或者按照其他地方的建议使用 server-kill-buffer。]

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-01-14T14:32:52.787

这是我在 .emacs 中执行此操作的内容：

```
(add-hook 'server-switch-hook 
  (lambda ()
    (local-set-key (kbd "C-x k") '(lambda ()
                                    (interactive)
                                    (if server-buffer-clients
                                        (server-edit)
                                      (ido-kill-buffer)))))) 
```

当我没有从 emacsclient 找到文件（对我来说是 ido-kill-buffer）时，像这样 Cx k 以通常的方式工作，如果我正在使用 emacsclient，如果客户端正在等待，Cx k 会执行服务器编辑，或以其他方式运行 ido-kill-buffer（如果我使用 emacsclient -n）。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-01-13T21:37:57.110

采用：

```
D:\> emacsclientw -n foo.txt 
```

-n 表示“不等”。这是 2008 年 3 月 26 日发布的 GNU Emacs 22.2.1 (i386-mingw-nt5.1.2600)（以及许多以前的版本，IIRC）。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-01-13T02:59:11.487

您知道，我讨厌建议解决方法而不是真正的解决方案……但是在阅读了服务器代码之后，我对 emacs 甚至如何确定缓冲区是服务器缓冲区感到困惑。

考虑到这一点，为什么不打开如下文件：

```
emacsclient --eval '(find-file "/path/to/file")' 
```

这样，emacs 不知道您的缓冲区是通过 emacsclient 打开的，这听起来像是您真正想要的。

编辑：

我对此并不满意，但它似乎有效：

```
(global-set-key (kbd "C-x k") (lambda () (interactive) (server-kill-buffer (current-buffer)))) 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-01-13T17:06:04.493

好的，这对我有用：

```
(global-set-key (kbd "C-x k") '(lambda ()
  (interactive)
  (if server-buffer-clients
      (server-done)
    (kill-this-buffer)))) 
```

（这是来自 IvanAndrus 的答案的代码，其中包含编辑和评论的显式更改，并使用了 jrockway 的键绑定。）

而且，是的——我正在重新绑定一个标准的键绑定。但它是一种功能替代品，而不是完全不同的东西（例如，用 kill-buffer 的东西代替 kill-ring-save）。

顺便说一句，EmacsWiki 有几个关于这个主题的页面 [——KillKey](http://www.emacswiki.org/cgi-bin/wiki/KillKey)和[KillingBuffer——](http://www.emacswiki.org/emacs/KillingBuffers)对我来说，这两个页面都没有比上面更好的说明（尽管 KillKey 上的第一个功能也使用了“服务器编辑”......）。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-15T21:19:08.847

我不确定这是否适用于 Windows，但在 linux 上，emacs -daemon 非常棒。有了它，您不必运行不同的程序，并且您的绑定是相同的。我想还有其他优点，但是由于我永远无法学习那些 emacsclient 绑定，因此我从未真正使用过它，也不能说。

我认为 -daemon 尚未发布，我正在使用 CVS 的 23.0.60.1。

# php - PHP 中的高质量 PDF 到 Word 转换？

> ID：437716
> 
> 赞同：10
> 
> 时间：2009-01-13T01:44:00.983
> 
> 标签：php, pdf, ms-word

在 PHP 中将 PDF 文档转换为 Microsoft Word 格式的最佳方法是什么？这可以作为 PHP 脚本或调用 (Linux) 可执行文件（使用 proc_open()）。它只需要相对较快并生成高质量的 Word 文档（97/2000/2003 格式）。

商业软件还行。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-08-12T09:57:34.583

要阅读**PDF**文件，您需要安装**[XPDF](http://www.foolabs.com/xpdf/about.html)**包，其中包括“pdftotext”。安装 XPDF/pdftotext 后，运行以下 PHP 语句来获取 PDF 文本：

```
content = shell_exec('/usr/local/bin/pdftotext '.$filename.' -'); 
```

拿到内容后，下载**[PHPDOCX](http://www.phpdocx.com/)**社区版，这样试试。

```
<?php
require_once '../../classes/CreateDocx.inc';

$docx = new CreateDocx();
$textInfo = $content;

$paramsTextInfo = array(
    'val' => 1,
    'i' => 'single',
    'sz' => 8
);

$docx->addText($textInfo, $paramsTextInfo);

$docx->createDocx('report.docx');
?> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-13T03:23:19.223

Openoffice 有一个[PDF 导入扩展](http://wiki.services.openoffice.org/wiki/Pdf_Import_Extension)。大多数 OpenOffice 都是可编写脚本的，因此您应该能够编写命令行界面来执行转换。官方的 UNO wiki 上有很多[例子。](http://udk.openoffice.org/python/python-bridge.html#examples)

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2020-12-08T09:27:16.117

转换的另一个选项是[Aspose.Words Cloud SDK for PHP](https://products.aspose.cloud/words/php)。它是一套高效的 Word 文档处理解决方案，没有任何 Microsoft Word 依赖项。它是付费产品，但免费定价计划每月提供 150 次免费 API 调用。

```
<?php

require_once('D:\xampp\htdocs\aspose-words-cloud-php-master\vendor\autoload.php');

try {

    //TODO: Get your ClientID and ClientSecret at https://dashboard.aspose.cloud (free registration is required).       
    $ClientSecret="xxxxxxxxxxxxxxxxxxxxxx";
    $ClientID="xxxx-xxxx-xxxx-xxxx-xxxxxxxxxx";

    $wordsApi = new Aspose\Words\WordsApi($ClientID,$ClientSecret);

    $format = "docx";
    $file = ("C:/Temp/02_pages.pdf");

    $request = new Aspose\Words\Model\Requests\ConvertDocumentRequest($file, $format,null);
    $result = $wordsApi->ConvertDocument($request); 
    copy($result->getPathName(),"C:/Temp/02_pages.docx");

} catch (Exception $e) {
    echo  "Something went wrong: ",  $e->getMessage(), "\n";
    PHP_EOL;
}

?> 
```

PS：我是 Aspose 的开发布道者。

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2009-02-05T13:45:32.843

到目前为止，最简单的方法是使用 phpLiveDocx。它可以加载 DOC、DOCX 和 RTF 并保存为 PDF。它可以从[http://www.phplivedocx.org/articles/brief-introduction-to-phplivedocx/](http://www.phplivedocx.org/articles/brief-introduction-to-phplivedocx/)下载。下载文件包含大量示例应用程序，这些示例应用程序说明了 PHP5 库的各个方面。狮子座

# winforms - Visual Studio 设计器在打开表单时移动控件并添加网格列

> ID：437720
> 
> 赞同：1
> 
> 时间：2009-01-13T01:44:53.180
> 
> 标签：winforms, visual-studio-2008, designer

我第一次尝试打开特定表单时，许多控件（右侧和/或底部带有锚点的控件）被移动，我的网格自动从其数据源中重新获得所有列（这些列）我之前已删除.

我在其他地方读过，建议在 InitializeComponent 方法之后将“好的”设计器代码复制到构造函数中。这似乎不是一个好的长期解决方案，例如，如果用户做出未来的设计更改怎么办？

有什么建议/解决方法吗？这是 Visual Studio 2008 的错误吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-20T03:29:04.440

我发现删除控件并将它们重新添加到作品中。不仅仅是剪切和粘贴，而是从头开始添加控件。这似乎与在 InitialiseComponent 方法中编写设计器代码的位置有关。

此链接描述了锚定和派生形式的一些问题： [http ://weblogs.asp.net/rweigelt/archive/2003/09/24/28984.aspx](http://weblogs.asp.net/rweigelt/archive/2003/09/24/28984.aspx)

# theory - 是否有用于数据库查询的规范形式？

> ID：437723
> 
> 赞同：2
> 
> 时间：2009-01-13T01:46:52.163
> 
> 标签：theory, relational-database, relational-algebra, canonical-form

假设我想做一个“优化的查询生成器”。基本上是一个 SQL 查询优化器，它比基于时间/空间限制的 SQL 服务器中的优化器要好得多。它将查询和数据库统计信息作为输入，并生成为目标系统量身定制的 SQL 查询，该查询将快速优化为几乎理想的计划。

**需要支持多少 SQL？**是否有一个 SQL 子集足够灵活，可以轻松描述最有用的查询，但又比完整的 SQL 小，值得将其缩减为？**如果您不需要坚持“靠近机器”，还有更好的方法来描述查询吗**？

 **我不是在考虑一个程序来处理现有的 SQL，而是一个用于创建新 SQL 的工具。只要输入语言能够描述查询的要求，*实际上不需要将SQL 作为输入。*

我想问题的另一种形式是：它们的 SQL 的任何部分是否仅用于性能并且从不提高可读性/可理解性？

* * *

正如有人指出的那样，这样做需要“大量特定于产品的知识”，并且（例如嵌套子查询与其他任何东西，应该使用什么样的索引，诸如此类）正是该工具旨在封装的内容这样用户就不需要学习这些知识。

* * *

注意：**我对生成实际的查询计划不感兴趣，因为那是 DBMS 的工作**，无论如何都不能从 SQL 中完成。我对一个系统感兴趣，该系统可以从不需要为该 DBMS 调整的输入中自动为给定 DBMS 生成良好的 SQL 的工作。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-13T01:57:54.280

听到您将 SQL 描述为“接近机器”，我感到很惊讶。SQL 本身是声明式的，而不是过程式的，关系数据库的有趣方面之一是实现者必须创新的自由，因为 SQL 本身很少规定应该如何执行查询。

我认为纯粹的实用性，很难改进 SQL。我并不是说它是完美的语言，但它是关系（甚至一些非关系）数据库的通用语言。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-13T01:56:33.533

Bramha，我不确定你是否知道你在问什么。SQL 优化不仅仅是确保查询组件的顺序正确的问题。您似乎意识到您需要对索引、数据页面布局等有深入的了解，但您仍然只需要重新排序查询子句，除非您在 SQL Server 查询中获得了适当的“挂钩”处理器。因为这就是 MS 所做的——它本质上将查询“编译”成更深、更基础的级别，以优化数据访问。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-13T03:02:41.607

嗯...有（我想，懒得去 google 了）九个关系运算符（扫描、跳转、哈希合并等）用于构建 SQL 查询的执行计划。运算符的选择基于目标数据库表的使用统计信息、可用索引等。

听起来您正在尝试重新创建查询计划器已经执行的操作...？

编辑：

1.  我认为大多数查询在执行方式上没有那么多选择，并且
2.  我不认为你可以对 SQL 做任何事情来强制数据库引擎以“你的方式”创建一个执行计划，即使你做了一个更优化的解决方案。
3.  除非您打算创建自己的数据库引擎！

我对这个问题很困惑；看起来像是在重新发明轮子，但没有马车可以安装它！？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-13T04:41:37.553

您是否打算为单个特定的数据库引擎编写此代码？如果没有，我怀疑你会度过一段相当艰难的时期。数据库查询的优化在很大程度上依赖于引擎实现和内部的具体细节，以及表、索引、主/外键关系、数据的类型和分布等。创建优化查询的实际逻辑将不同的数据库引擎之间可能几乎没有重叠。（就此而言，至少对于 MySQL 而言，表类型会对优化产生巨大影响。）每个受支持的数据库引擎的每个版本也可能具有显着不同的特征——请记住，如果您正在生成 SQL，那么您需要能够预测引擎自己的优化器/查询计划器将如何处理您的 SQL

问题是，查询优化仅微弱地依赖于关系理论，并且非常依赖于对 DB 的内脏和所持有的数据的详细了解。即使您能够提取数据库的元数据，我怀疑您将很难制定比数据库本身更好的查询计划 - 如果您没有获得数据库的元数据，那么您的原因是没有希望的.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-13T01:50:55.993

您可能会发现“普通人的 SQL 查询”中的模式很有用，因为它们通过以英语描述开头的结构化规范格式工作。

如果您想快速浏览一下，请访问[Safari](http://my.safaribooksonline.com/9780321444431)在线。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-01T02:52:26.587

祝你好运 - 您选择与 Microsoft 和 Oracle 等公司竞争，这些公司的生死存亡取决于他们的查询优化器是否完全按照您的建议执行。将一个数据库产品与另一个进行比较的第一种也是主要的方法是基准测试，其中对每个数据库产品应用相同的查询工作负载，进行时间测量，并且在大多数情况下，获胜者取决于执行速度。

如果您可以使用他们的产品在任何这些基准测试中做得比发布商好得多，那么世界将会给世界留下深刻的印象。至少你将有一个坚实的职业机会，无论你使用哪个（S）。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2017-06-14T12:41:49.553

到目前为止，这是一个非常古老的问题，我同意其他大多数答案，即它可能有点误导。但它有一些东西。您是否阅读过 Gulutzan 和 Pelzer 的“SQL 性能调优”（Addison-Wesley，2003 年）？它比较了许多 DBMS，以及等效但不同形式的查询如何影响执行时间。换句话说，查询优化器中存在哪些特质和错误。

例如，他们发现在大多数系统中，WHERE 子句（例如）`WHERE column1 = 'A' AND column2 = 'B'`将从左到右进行评估，但在 Oracle 中从右到左进行评估（在某些条件下，并且在他们撰写本书时当前的特定 Oracle 版本中） . 因此，在 Oracle 中，最不可能的条件应该放在最后，但在大多数其他系统中应该放在首位。

# file - .net 中的递归文件搜索

> ID：437728
> 
> 赞同：19
> 
> 时间：2009-01-13T01:52:23.183
> 
> 标签：file, io, .net, file-search

我需要在驱动器（C:、D: 等）中搜索特定文件类型（扩展名如 .xml、.csv、.xls）。如何执行递归搜索以循环所有目录和内部目录并返回文件所在位置的完整路径？或者我在哪里可以获得这方面的信息？

VB.NET 或 C#

谢谢

编辑〜我遇到了一些错误，比如无法访问系统卷访问被拒绝等。有谁知道我在哪里可以看到一些关于实现文件搜索的代码？我只需要搜索选定的驱动器并返回找到的所有文件的文件类型的完整路径。

* * *

## 回答 #1

> 赞同：54
> 
> 时间：2009-01-13T01:54:28.200

```
System.IO.Directory.GetFiles(@"c:\", "*.xml", SearchOption.AllDirectories); 
```

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2009-01-13T08:25:00.317

这个怎么样？它避免了内置递归搜索经常抛出的异常（即，您对单个文件夹的访问被拒绝，并且您的整个搜索都死了），并且被延迟评估（即，它一找到结果就返回结果，而不是缓冲 2000 个结果）。惰性行为使您可以构建响应式 UI 等，并且还可以与 LINQ（尤其是`First()`,`Take()`等）很好地配合使用。

```
using System;
using System.Collections;
using System.Collections.Generic;
using System.IO;
static class Program { // formatted for vertical space
    static void Main() {
        foreach (string match in Search("c:\\", "*.xml")) {
            Console.WriteLine(match);
        }
    }
    static IEnumerable<string> Search(string root, string searchPattern) {
        Queue<string> dirs = new Queue<string>();
        dirs.Enqueue(root);
        while (dirs.Count > 0) {
            string dir = dirs.Dequeue();

            // files
            string[] paths = null;
            try {
                paths = Directory.GetFiles(dir, searchPattern);
            } catch { } // swallow

            if (paths != null && paths.Length > 0) {
                foreach (string file in paths) {
                    yield return file;
                }
            }

            // sub-directories
            paths = null;
            try {
                paths = Directory.GetDirectories(dir);
            } catch { } // swallow

            if (paths != null && paths.Length > 0) {
                foreach (string subDir in paths) {
                    dirs.Enqueue(subDir);
                }
            }
        }
    }
} 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-11-19T23:40:33.820

看起来[recls](http://www.recls.org/)库（代表*递归**ls*）现在有一个[纯 .NET 实现](http://www.recls.net/)。我刚刚[在 Dobb 博士的文章中读到过](http://www.ddj.com/cpp/221900083)。

将用作：

```
using Recls;
using System;
static class Program { // formatted for vertical space
    static void Main() {
        foreach(IEntry e in FileSearcher.Search(@"c:\", "*.xml|*.csv|*.xls")) {
            Console.WriteLine(e.Path);
        }
    } 
```

# asp.net - 使用 .Net Streamreader 读取 HTM 文件的可能编码问题

> ID：437738
> 
> 赞同：1
> 
> 时间：2009-01-13T01:56:40.070
> 
> 标签：asp.net, vb.net, character-encoding

我有一个 HTML 文件，其文本中带有 ®（版权）和 ™（商标）符号。这些只是许多其他符号中的两个。当我将 html 文件读入文字控件时，它会将符号转换为其他内容。

版权符号转换为�（在ff中打开框）商标符号转换为™（如预期的那样）

```
If (System.IO.File.Exists(FullName)) Then
   Dim StreamReader1 As New System.IO.StreamReader(FullName)
   Contents.Text = StreamReader1.ReadToEnd()
   StreamReader1.Close()
End If 
```

Contents 是一个`<asp:Literal runat="server" ID="Contents"></asp:Literal>`，它是 aspx 页面中唯一的控件。

根据一些研究，我认为这与编码有关，但我不知道为什么它会改变如何修复它。

html 文件的 head 部分不包含任何 Content-Type 设置。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-13T06:31:00.703

如果完全有可能将此处理转移到 Render 方法，则可以使用 HttpResponse.WriteFile 来查看它是否比 Literal 控件更好地处理这些字符。如果除了将其分配给控件然后让它呈现之外，您对该文件的内容没有做任何事情，那么您应该能够做到这一点。

# c# - 用户退出时的 C# 运行函数

> ID：437751
> 
> 赞同：0
> 
> 时间：2009-01-13T02:09:55.627
> 
> 标签：c#, winforms

当用户存在应用程序时，有什么方法可以在 C# 中调用函数？

我正在使用 Visual C# 2008 Express 版本。

谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-13T02:12:15.093

它是一个 Windows 窗体应用程序，不是吗？您可以使用此事件：

```
System.Windows.Forms.Application.ApplicationExit += ... 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-13T03:08:46.367

我从来没有尝试过，所以这可能是在黑暗中拍摄，但不能覆盖默认退出方法并执行类似 protected override exit {myMethod(); base(e);} 虽然我假设委托在这种情况下基本上做同样的事情

# ruby-on-rails - 从 Rails 控制台修改数据库 ID？

> ID：437753
> 
> 赞同：16
> 
> 时间：2009-01-13T02:10:56.310
> 
> 标签：ruby-on-rails, ruby

我有一个小型数据库，并且一直在通过 Rails 页面添加条目。我“销毁”了其中一个条目，现在我的 ID 序列正在跳过一个。例如，我现在有 42 和 44，而不是显而易见的：42、43、44。

我想知道是否有办法通过控制台编辑新对象的 ID 号。我试过了：

```
record.id = 43
record.save 
```

和

```
record = record.new
record.attributes = { :id => 43 } 
```

但两者都没有工作。我相当肯定必须有一个控制台方法来解决这个问题，但我似乎无法在 Google 上找到更多具体信息，而且我可能错误地阅读了 Rails API……我可能必须通过 sqlite 中的直接 SQL 来做到这一点?

谢谢

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2009-07-22T06:34:15.627

最好的方法是直接执行 SQL，并在序列中解决这个时间故障。

尝试访问控制台（ruby 脚本/控制台）并输入：

```
>> sql = "update records set id=43 where id=44"
>> ActiveRecord::Base.connection.execute(sql) 
```

其中 44 是新创建的对象的 ID，而 43 是您在表中缺少的 ID

祝你好运！

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2009-01-14T02:59:19.943

实际上，您可以为新对象手动设置 id：

```
record = Record.new
record.id = 1234
record.save 
```

但是，您要做的是更新现有对象的 id。当您设置`record.id = 43`然后调用`save`时，ActiveRecord 将尝试生成如下 SQL：

`update records set id = 43 where id = 43`

请注意，它要更新的 id*与您尝试更改的 id 相同*。这就是为什么它不起作用。

所以是的，你必须使用 SQL 来改变它。这是否是一个好主意是另一个问题，但有时需要这样做。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-01-13T02:34:31.240

> 我可能必须通过sqlite中的直接SQL来做到这一点吗？

是的。

ActiveRecord 的全部意义在于抽象 DB 函数并仅返回数据集合。您不必担心记录的 ID，这是数据库特有的。在我的脑海中，我想不出任何理由来引用模型的 ID。

如果您的应用程序依赖于具有序列号，那么您应该向具有此序列号的模型添加另一个字段。例如，如果我有一个产品商店（产品模型）并且我将数据库提供给其他供应商的 ID 号。两周后，我的老板要求我为两种产品提供一个唯一但相似的 ID：“45a”和“45b”。坚果。ID 字段只能由**数据库和 ActiveRecord**使用，而不是您或您的用户来识别记录。

*如果数据库允许的话，可能*会有一个模糊的方法强制设置 ID，但它是模糊的是有原因的。不要试图找到它:)

话虽如此，键入`ruby script/dbconsole`以快速调出 sqlite 界面，而无需输入密码。

此外，如果您删除将重置计数器并从 0 开始的 sqlite 数据库。能力越大，责任越大。

**编辑**

如果我没记错的话，戴夫托马斯在某处写过这个。也许[在这里](http://www.pragprog.com/titles/rails2/agile-web-development-with-rails)？

# java - 如何停止在日志中截断堆栈跟踪

> ID：437756
> 
> 赞同：80
> 
> 时间：2009-01-13T02:12:53.517
> 
> 标签：java, exception, stack-trace

在 Java 日志中很多时候我会得到类似的东西：

```
Caused by: java.sql.BatchUpdateException: failed batch
    at org.hsqldb.jdbc.jdbcStatement.executeBatch(jdbcStatement.java:1102)
    at org.hsqldb.jdbc.jdbcPreparedStatement.executeBatch(jdbcPreparedStatement.java:514)
    at org.hibernate.jdbc.BatchingBatcher.doExecuteBatch(BatchingBatcher.java:48)
    at org.hibernate.jdbc.AbstractBatcher.executeBatch(AbstractBatcher.java:242)
    ... 113 more 
```

有谁知道如何获得完整的堆栈跟踪显示（即显示其他 113 行）？

* * *

Throwable的[JavaDocs (for Java 7)](http://docs.oracle.com/javase/7/docs/api/java/lang/Throwable.html#printStackTrace%28%29)对正在发生的事情进行了非常详细的解释。

* * *

## 回答 #1

> 赞同：75
> 
> 时间：2009-01-13T02:20:22.470

当您看到“...113 更多”时，这意味着“由”异常的剩余行与父异常从该点开始的剩余行相同。

例如，您将拥有

```
com.something.XyzException
  at ...
  at ...
  at org.hibernate.jdbc.AbstractBatcher.executeBatch(AbstractBatcher.java:242)
  at ... <the other 113 lines are here>...
Caused by: <the above>. 
```

两个堆栈跟踪在 AbstractBatcher.executeBatch 第 242 行“相遇”，然后从那时起向上的调用跟踪与包装异常相同。

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2009-01-13T09:41:00.147

Apache 的[Commons Lang](http://commons.apache.org/lang/)提供了一个很好的 util 方法[ExceptionUtils.printRootCauseStackTrace()](http://commons.apache.org/proper/commons-lang/javadocs/api-3.3/org/apache/commons/lang3/exception/ExceptionUtils.html#printRootCauseStackTrace(java.lang.Throwable))，它可以“颠倒”打印嵌套的堆栈跟踪。结果更加直观。

如果您在 printStackTrace() 方法的原始结果旁边看到结果，就会清楚“113 more”行的去向。

* * *

## 回答 #3

> 赞同：20
> 
> 时间：2018-05-02T06:11:16.910

增加`-XX:MaxJavaStackTraceDepth`JVM 选项。

* * *

## 回答 #4

> 赞同：14
> 
> 时间：2014-12-20T14:09:13.170

我喜欢[这里](http://docs.oracle.com/javase/7/docs/api/java/lang/Throwable.html#printStackTrace%28%29)的例子：

```
HighLevelException: MidLevelException: LowLevelException
         at Junk.a(Junk.java:13)
         at Junk.main(Junk.java:4)
 Caused by: MidLevelException: LowLevelException
         at Junk.c(Junk.java:23)
         at Junk.b(Junk.java:17)
         at Junk.a(Junk.java:11)
         ... 1 more
 Caused by: LowLevelException
         at Junk.e(Junk.java:30)
         at Junk.d(Junk.java:27)
         at Junk.c(Junk.java:21)
         ... 3 more 
```

基本上在源代码中，`main`调用`function a`哪个调用`function b`哪个调用...哪个调用`function e`。 `Function e`throws a`LowLevelException`导致函数 c 捕获`LowLevelException`并抛出 a `MidLevelException`（将实例包装在`LowLevelException`实例内部`MidLevelException`。`Exception`该类具有能够接收不同异常的构造函数，将其包装起来）。这导致函数 a 捕获`MidLevelException`并抛出 a`HighLevelException`现在包装了前两个`Exception`实例。

如其他答案所述，堆栈跟踪并没有真正被截断，您看到的是完整的堆栈跟踪。在`.. .3 more`我的示例中存在，因为否则它将是多余的。如果你想冗余和浪费输出线，`.. 3 more`可以用

```
at Junk.b(Junk.java:17)
at Junk.a(Junk.java:11)
at Junk.main(Junk.java:4) 
```

但是没有必要输出这三行，因为它们已经被暗示了。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-01-01T13:09:56.843

我发现这对了解整个情况很有用。获取异常**和**原因的完整堆栈跟踪（通常显示主异常中的重复行，但可能会有所帮助）。

```
 ... catch( Exception e) ...

        ... catch( NoClassDefFoundError e)
        {

                for(StackTraceElement ste: e.getStackTrace())
                {
                    System.out.println(ste);
                }

                if( e.getCause()!=null )
                {
                    for(StackTraceElement ste: e.getCause().getStackTrace())
                    {
                        System.out.println(ste);
                    }
                }
        } 
```

* * *

## 回答 #6

> 赞同：-2
> 
> 时间：2012-11-18T23:26:47.167

在一篇博客文章中，我刚刚描述[了如何获得不仅仅是“BatchUpdateException：失败的批处理”](http://inoio.de/blog/2012/11/16/how-to-get-rid-of-hibernate-genericjdbcexception/)：设置`hibernate.jdbc.factory_class=org.hibernate.jdbc.NonBatchingBatcherFactory`为禁用休眠中的批处理。通常可以使用`BatchUpdateException.getNextException`来获取失败的原因，但在某些情况下可能会返回`null`。然后完全禁用批处理很有用。

# ruby-on-rails - Rails 在哪里存储测试期间通过保存 activerecord 对象创建的数据？

> ID：437760
> 
> 赞同：7
> 
> 时间：2009-01-13T02:13:35.387
> 
> 标签：ruby-on-rails, ruby, database, rspec, testing

Rails 在哪里存储测试期间通过保存 activerecord 对象创建的数据？

我以为我知道这个问题的答案：显然在**_test 数据库**中。但看起来这**不是真的**！

我使用这个系统来测试在 rspec 测试期间保存的 ActiveRecord 数据发生了什么：

$ rails -d mysql 测试

$ cd 测试

$ 纳米配置/database.yml ...

... 创建 mysql 数据库 test_test、test_development、test_production

$ 脚本/生成 rspec

$ 脚本/生成 rspec_model foo

编辑 Foo 迁移：

```
类 CreateFoos

$ 耙分贝：迁移

编辑规范/模型/foo_spec.rb：

```
需要 File.expand_path(File.dirname(__FILE__) + '/../spec_helper')

描述 Foo do
  之前（：每个）做
    @valid_attributes = {
      :酒吧 => 12345
    }
  结尾

  它“应该在给定有效属性的情况下创建一个新实例”
    foo = Foo.new(@valid_attributes)
    foo.save
    放“睡觉……”
    睡觉(20)
  结尾
结尾

```

$ 耙子规格

当您看到“sleeping...”时，切换到另一个打开的终端，其中 mysql 会话连接到 test_test 数据库并执行以下操作：

mysql> 从 foos 中选择 *；
空集（0.00 秒）

```

为什么 mysql 会话在测试运行时不显示 test_test 数据库中的任何记录？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-01-13T02:19:44.577

默认情况下，测试数据库中的项目在每次测试运行后都会被删除，这是设计的。这样做是为了确保您的每个测试都有自己的沙箱可以玩，不会导致与之前的测试发生任何交互。

同样，这是设计使然。您不希望测试操作同一组数据（或依赖于同步执行），因为无法保证执行顺序。

但是，我相信如果你修改你的 test/test_helper.rb 文件这样说：

```
self.use_transactional_fixtures = false 
```

代替

```
self.use_transactional_fixtures = true 
```

它将导致您的测试数据库中的数据持续存在。

另外：我的建议是专门为使用 Test::Unit 而设计的，而不是 RSpec。但是，我想您应该寻找类似的设置您的 spec_helper.rb。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-13T02:32:48.793

您可以通过以下方式观察添加到测试数据库的记录：

```
tail -f log/test.log 
```

当测试运行时，您应该会看到交易飞逝。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-01-13T05:51:23.560

“但是为什么mysql查询在测试运行时没有显示数据库中的数据？”

因为它在交易中。如果您关闭事务性固定装置，您的测试将比以前运行得慢得多。

# build - Wise Installation Studio 的 MSBuild 或 NAnt 或 Rake 任务

> ID：437762
> 
> 赞同：1
> 
> 时间：2009-01-13T02:16:02.463
> 
> 标签：build, installation, wise

有谁知道用于控制 Wise Installation Studio 的任何 MSBuild 或 NAnt 任务？

我知道，我可能应该只使用 WiX，但我当前的项目已经在 Wise 中，我需要自动化的只是更新产品代码、升级部分和一些文本。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-12-18T18:57:10.870

我正在使用 CruiseControl.NET - 如果需要，这可以适用于 Nant-only 解决方案。我调用 wfwi.exe，它包含在 Wise 安装中，用于命令行访问（[这是 Wise 安装程序手册，其中包含 wfwi.exe 的说明](http://www.altiris.com/upload/windowsinstallereditor_007.pdf)）。这是我的 ccnet.config 中的一个片段：

```
<!-- build installers -->

<exec>
<executable>C:\Path\To\WiseWrapper.bat</executable>
<buildArgs>"C:\Path\To\wfwi.exe" "C:\Path\To\Output.wsi" /c /p /s</buildArgs>
</exec>

<!-- build installer exes -->

<exec>
<executable>C:\Path\To\Wise32.exe</executable>
<buildArgs>/c /s C:\Path\To\Your.wse</buildArgs>
</exec> 
```

WiseWrapper.bat 允许使用 CC.NET 构建标签更新安装程序 ProductVersion。WiseWrapper.bat 的全部内容是：

```
%1 %2 %3 %4 ProductVersion=%CCNetLabel% %5 
```

# c# - 将子属性绑定到 DataGridView

> ID：437766
> 
> 赞同：2
> 
> 时间：2009-01-13T02:20:21.910
> 
> 标签：c#, data-binding, datagridview

有没有办法将对象的子属性绑定到 datagridview？这是我的代码：

```
public class Person
{
    private string id;
    private string name;
    private Address homeAddr;
    public string ID
    {
        get { return id; }
        set { id = value; }
    }
    public string Name
    {
        get { return name; }
        set { name = value; }
    }
    public Address HomeAddr
    {
        get { return homeAddr; }
        set { homeAddr = value; }
    }
}

public class Address
{
    private string cityname;
    private string postcode;
    public string CityName
    {
        get { return cityname; }
        set { cityname = value; }
    }
    public string PostCode
    {
        get { return postcode; }
        set { postcode = value; }
    }
} 
```

当 Person 类型的对象绑定到 datagridview 时，我想显示 ID、Name、CityName。请注意，CityName 是 HomeAddr 的属性。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-13T03:25:09.080

如果您将 DataGridView 设置为 AutoGenerateColumns = true，那么确实没有简单的方法可以做到这一点。最好的办法是提前设置 DataGridView，然后手动填充 DataGridView。

或者，您可以实现[ITypedList](http://msdn.microsoft.com/en-us/library/system.componentmodel.itypedlist.aspx)，但如果您问我，那会有点痛苦。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-13T15:51:10.977

嗯，[我在 FarPoint 中找到了一种方法](http://itscommonsensestupid.blogspot.com/2009/01/how-to-use-customtypedescriptor-to-show.html)。

但是，如果您的对象没有列表类型属性，您*可以在 DataGridView 中执行此操作。*

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-07-08T23:05:19.240

你也可以看这里

[http://www.mail-archive.com/advanced-dotnet@discuss.develop.com/msg06383.html](http://www.mail-archive.com/advanced-dotnet@discuss.develop.com/msg06383.html)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-10-15T14:05:38.093

BLToolkit 有 BLToolkit.ComponentModel.ObjectBinder

这些特点是：

```
Support for field binding along with property binding.

Support for inner class field and property binding such as Order.Address.Line1.

Support for the ObjectView feature which is available by assigning an object view type to the ObjectBinder.ObjectViewType property. An object view is an object that implements the IObjectView interface. This interface includes only one property - object Object { get; set; }. An object view can implement additional properties based on the assosiated object. The ObjectBinder will combine all of these properties with main object properties and create a single PropertyDescriptor collection. This feature can be used to separate UI presentation logic from business model objects and to keep them clean. ObjectView should be a stateless, lightweight object as its single instance can be assigned to many assosiated objects.

The ObjectBinder is optimized for high performance applications such real-time multithreaded message processing and distribution banking systems. So it does not use reflection to access objects. The standard way (which is used by the BindingSource) is to call the TypeDescriptor.GetProperties method to get a PropertyDescriptor collection. This method creates property descriptors that access object properties by reflection. The ObjectBinder has its own mechanism to avoid unnessasy reflection and boxing/unboxing operations. 
```

# php - 在剩下的时间里缓存一个 PHP 脚本

> ID：437769
> 
> 赞同：1
> 
> 时间：2009-01-13T02:21:58.893
> 
> 标签：php, http, caching, reverse-proxy

如何使 PHP 脚本缓存对我们的私有反向代理 (Squid) 友好？

我希望它在一天的剩余时间内保持缓存。换句话说，页面的最后一次修改是今天00:00，它将在明天00:00过期。

可靠地执行此操作所需的最低 HTTP 标头是多少？

编辑：我不希望客户端的浏览器缓存有任何不同。也就是说，我希望在任何给定时间保留对清除 Squid 服务器上过时页面的控制权。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-13T04:30:28.353

@OP：下面是一些注释代码来实现您的要求。

@cletus：您说 memcached 是 OP 想要的，而这不是 Squid 的设计目的。

我不知道 Squid 的设计目的是什么，但我知道它*的*用途，而且肯定有人使用它作为反向代理来减轻动态页面生成的负担。除了标准的 HTTP 标头外，不需要“绑定”。

我不确定您为什么在不了解应用程序和环境的性质的情况下如此迅速地推荐 memcached。

```
<?php

// the time we got hit and generated content
$now = time();
$generatedAt = gmdate('D, d M Y H:i:s T', $now);

// the last modified date (midnight on the same day of generation, as
// per your business-rule)
$lastModified = gmdate('D, d M Y 00:00:00 T', $now);

// date of expiry (24 hours after the last modified date, as per your
// business-rule)
$expiresAt = gmdate('D, d M Y H:i:s T', strtotime($lastModified) + 86400);

// the minimum required http headers to make Squid do what you asked is
// Last-modified and Cache-control.  We need to give Cache-control the
// expiry time in terms of "age" (in seconds) so we calculate that below.
// Optionally you could also provide the "Expires: $expiresAt" header to
// tell the browser/client the same information, just in a different way.
// This is not required for Squid though.
$maxAge = strtotime($expiresAt) - strtotime($generatedAt);
header('Last-modified: ' . $lastModified);
header('Cache-control: max-age=' . $maxAge);

// The rest is simply informational
header('Content-type: text/plain');
echo "The content of this page was last modified at $lastModified\n";
echo "This page was generated at $generatedAt and will be cached by Squid for $maxAge seconds until $expiresAt\n";

// Sample output:
//
// The content of this page was last modified at Tue, 13 Jan 2009 00:00:00 GMT
// This page was generated at Tue, 13 Jan 2009 04:29:33 GMT and will be cached by Squid for 70227 seconds until Wed, 14 Jan 2009 00:00:00 GMT 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-13T02:27:22.957

我假设您的意思是要缓存脚本的**输出**，而不是脚本本身。而且您显然想要服务器端脚本，因此 HTTP 标头不是您想要的（除非有一些与 Squid 相关的东西，这很可能是）。但这不是 Squid 的设计目的。

对于这种事情，你真的想要[memcached](http://www.danga.com/memcached/)（或类似的）。

检查结果是否在缓存中。如果是，请将其退回。如果不是，则生成结果（例如使用 ob_start() 等），将其放入缓存中并返回。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-13T03:19:36.017

您可以运行脚本并生成要提供的静态 HTML 文件。这样，何时替换内容由您决定。

您不必在 Web 服务器中运行脚本。一个 cron 工作完美地工作。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-23T15:17:09.687

你试过使用 APC 吗？

[http://us.php.net/apc](http://us.php.net/apc)

> Alternative PHP Cache (APC) 是一个免费且开放的 PHP 操作码缓存。它旨在为缓存和优化 PHP 中间代码提供一个免费、开放和健壮的框架。

# memcached - Memcached 最佳实践 - 小对象和大量键还是大对象和少量键？

> ID：437773
> 
> 赞同：23
> 
> 时间：2009-01-13T02:25:44.580
> 
> 标签：memcached

我[`memcached`](http://www.danga.com/memcached/)用来存储复杂计算的整数结果。我有数百个可以缓存的整数对象！我应该将它们缓存在更复杂对象中的单个键下，还是应该为对象使用数百个不同的键？（我正在缓存的对象每天不需要多次失效）

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-01-13T02:35:10.070

我会说很多小钥匙。这样，您可以通过最少的序列化工作在 1 次调用中获得所需的确切结果。

如果将它存储在另一个对象（例如数组）中，您将不得不从缓存中获取数组，然后再次从该数组中获取您真正想要的项目，而且您还有再次序列化/反序列化整个复杂对象的开销。根据您选择的语言，这可能意味着从头开始手动编写序列化/反序列化函数。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-04-11T09:22:42.517

我在[http://dammit.lt/2008/12/25/memcached-for-small-objects/](http://dammit.lt/2008/12/25/memcached-for-small-objects/)上写了一些大的分析——它概述了如何针对小对象存储优化 memcached——它可能会为这个问题提供一些启示。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-13T02:58:31.240

这取决于您的应用程序。虽然 memcached 非常快，但它确实需要一些请求传输和每个请求的内存查找时间。这些数字的增加取决于服务器是在本地计算机 (localhost)、本地网络上还是在大范围内。缓存的大小通常不会影响查找速度。

因此，如果您的应用程序在每个处理单元（每个请求、方法或您所拥有的）使用许多对象，那么通常最好以一种同时降低缓存命中总数的方式定义您的缓存尝试不复制缓存数据的时间。像其他一切一样，这是一种平衡。

即，如果您有一个拉取博客文章列表的 Web 请求，将整个对象列表缓存为一个 memcached 键会更有益，而不是（显然这是一个有点糟糕的例子）缓存一组缓存键对于该列表，它与单独的 memcached 对象有关。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-13T02:30:28.893

您对缓存值的处理越少越好。那么为什么不将它们单独转储到缓存中呢？

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-12-21T10:05:41.313

我会说你应该单独存储值并使用某种帮助类来使用 multiget 检索值并为你生成一个复杂的数据对象。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2011-11-02T13:33:23.237

这取决于这些数字是多少。例如，如果您可以将它们按范围分组，那么您可以优化存储。如果您可以将它们散列到映射或哈希表中并将该映射序列化存储在 memcached 中会很好。

无论如何，你可以保存很多小键，只要确保你将slab配置为具有小尺寸的块，这样你就不会浪费内存空间。

# perl - 有没有办法“使用”单个文件，然后在 Perl 中使用多个其他文件？

> ID：437785
> 
> 赞同：9
> 
> 时间：2009-01-13T02:31:34.740
> 
> 标签：perl, module

我想创建几个模块，这些模块将用于我项目中的几乎所有脚本和模块。这些可以在我的每个脚本中**使用，如下所示：**

```
#!/usr/bin/perl

use Foo::Bar;
use Foo::Baz;
use Foo::Qux;
use Foo::Quux;

# Potentially many more. 
```

是否可以将所有这些**使用**语句移动到一个新模块`Foo::Corge`，然后只需要`use Foo::Corge`在我的每个脚本和模块中？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-13T03:06:44.000

像这样的东西应该工作：

[http://mail.pm.org/pipermail/chicago-talk/2008-March/004829.html](http://mail.pm.org/pipermail/chicago-talk/2008-March/004829.html)

基本上，创建包含大量模块的包：

```
package Lots::Of::Modules;
use strict; # strictly optional, really

# These are the modules we want everywhere we say "use Lots::Of::Modules".
# Any exports are re-imported to the module that says "use Lots::Of::Modules"
use Carp qw/confess cluck/;
use Path::Class qw/file dir/;
...

sub import {
    my $caller = caller;
    my $class  = shift;

    no strict;
    *{ $caller. '::'. $_ } = \*{ $class. '::'. $_ }
       for grep { !/(?:BEGIN|import)/ } keys %{ $class. '::' };
} 
```

然后在别处使用Lots::Of::Modules；

```
use Lots::Of::Modules;
confess 'OH NOES'; 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-01-13T08:49:25.867

是的，这是可能的，但不，你不应该这样做。

我只花了两个星期来摆脱一个除了使用其他模块什么都不做的模块。我猜这个模块一开始是简单而无辜的。但多年来，它成长为一个巨大的野兽，拥有大量的使用语句，其中大部分对于我们的 web 应用程序的任何给定运行都不需要。最后，仅仅“使用”那个模块就花了大约 20 秒。它支持惰性复制和粘贴模块创建。

再说一遍：你可能会在几个月或几年后后悔那一步。你有什么好处？您节省了在几个模块中输入几行代码。大不了。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-13T04:21:14.847

是的。

### 在 Foo/Corge.pm

```
use Foo::Bar;
use Foo::Baz;
use Foo::Qux;
use Foo::Quux;

1;   # Be successful 
```

剩下的就是将包含子目录的目录`Foo`添加到您的库路径 ( `@INC`) 中。或者，创建`Foo.pm`并让它使用其他模块。它们将`Foo`位于 旁边的子目录中`Foo.pm`。

如果你仔细想想，所有使用其他模块的复杂 Perl 模块都会一直这样做。它们不一定在同一个顶级包中（`Foo`在这个例子中），但它们的使用是一样的。

虽然您可以使用 Carp 和 Path::Class 并承认，等等（正如 jrockway 所建议的那样），但从我坐的地方来看，这似乎有点矫枉过正。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-14T05:00:58.013

**[编辑：我之前涉及的解决方案`use Lots::Of::Modules;`有一个微妙的错误——见底部。该修复使事情变得有点丑陋，但仍然可行。]**

**[编辑#2：`BEGIN { ... }`在代码周围添加以确保定义的任何函数在编译时可用。感谢 jrockway 指出这一点。]**

以下代码将完全按照 jrockway 的代码所做的，只是更简单和更清晰：

## 在很多/Of/Modules.inc 中：

```
use Carp qw/confess cluck/;
use Path::Class qw/file dir/;

0;   # Flag an error if called with "use" or "require" instead of "do" 
```

要导入这 4 个函数：

```
BEGIN { defined( do 'Lots/Of/Modules.inc' ) or die; } 
```

`package Lots::Of::Modules;`因为我们在这个文件的开头没有语句，所以这些`use`语句将导出到调用者的包中。

我们必须使用`do`代替`use`or `require`，因为后者只会加载文件一次（如果`use Lots::Of::Modules;`多次调用会导致失败，例如在`use`主程序的单独模块中）。`do`如果在 中找不到由其参数命名的文件，则更原始的不会引发异常`@INC`，因此需要使用`defined`.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-03T12:12:14.173

另一种选择是让 Foo::Corge 正常重新导出任何感兴趣的项目：

```
package Foo::Corge;

use base 'Exporter';
BEGIN {
  our @EXPORT_OK = qw( bar baz qux quux );

  use Foo::Bar qw( bar );
  use Foo::Baz qw( baz );
  use Foo::Qux qw( qux );
  use Foo::Quux qw( quux );
}
1; 
```

（ ' use' 语句可能会出现`BEGIN`在其中可能不适用于您的情况。）`eval``use``BEGIN`

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-11-14T21:44:31.737

使用 @EXPORT 而不是 @EXPORT_OK ，更简单

图书馆是：

```
package mycommon;

use strict;
use warnings;

use base 'Exporter';

our @EXPORT = qw(test);

sub test {
    print "this is a test";
}

1; 
```

用它：

```
#!/usr/bin/perl
use strict;
use warnings;
use mycommon;

common::test() 
```

# python - Google App Engine - 导入我自己的源模块（多个文件）

> ID：437791
> 
> 赞同：3
> 
> 时间：2009-01-13T02:33:57.077
> 
> 标签：python, google-app-engine

我正在编写一个 GAE 应用程序，并且在解决以下问题时遇到了一些困难。

我创建了多个 python 文件（比如 a.py 和 b.py），它们都存储在同一个文件夹中。我可以通过将 URL 映射到它们（使用 app.yaml）来调用 a.py 或 b.py 中的代码。我还没有弄清楚如何将代码从一个导入另一个。

谁能帮助我这里需要的语法和/或任何配置？例如，我的印象是我可以通过在 a.py 中发出以下语句来将 b.py 中的代码包含在文件 a.py 中

```
import b 
```

我对这种方法没有任何成功。具体来说，我收到此错误：

```
ImportError: No module named b 
```

有什么建议么？

谢谢，

马特

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-13T03:10:46.317

您是否尝试过像从顶层开始一样导入？像

```
导入模块.b

```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-13T03:17:15.990

如果找不到文件 a.py 和 b.py，请确保在`sys.path`.

```
import sys
sys.path.append(r"/parent/of/module/b") 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-13T10:33:11.493

请注意，GAE 的常用模式不是将每个单独映射到 app.yaml 中，而是有一个“处理程序”脚本，该脚本将所有（或除静态和特殊的）UR​​L 映射到它，并拥有该脚本导入 a 和 b 并使用它们定义的处理程序。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-12-28T05:29:56.093

正如@toby所说，它必须像从顶级目录导入一样导入，并且必须在文件夹中放置一个名为**init .py 的文件。**

# .net - CouchDB - .NET 或 Mono 等效技术

> ID：437797
> 
> 赞同：7
> 
> 时间：2009-01-13T02:37:43.170
> 
> 标签：.net, database, mono, mapreduce, document-based-database

是否有任何使用 .NET 或 Mono 的活动“基于文档”的数据库项目？类似于 CouchDB、SimpleDB、LotusNotes 等的东西……更喜欢开源。

我认为 JScript.NET 技术可用于存储 JSON 文档的 Map 和 Reduce 函数。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-13T12:44:30.010

看看[nsimpledb](http://code.google.com/p/nsimpledb/)。还有[RDDB](http://rddb.rubyforge.org/)、[Apache Jackrabbit](http://en.wikipedia.org/wiki/Apache_Jackrabbit)、[FeatherDB](http://fourspaces.com/blog/2008/4/11/FeatherDB_Java_JSON_Document_database)（CouchDB 的 Java 克隆）、[StrokeDB](http://strokedb.com/)、[ThruDB](http://code.google.com/p/thrudb/)、[DataWasp](http://www.datawasp.com/pages/index.html)和[M/DB](http://gradvs1.mgateway.com/main/index.html?path=mdb)。维基百科将以上所有内容列为面向文档的数据库技术。有些是 .NET，有些不是，但我希望这些链接能带您到有用的地方。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2010-12-22T20:26:51.953

我也想将[RavenDB](http://ravendb.net/)添加到列表中。用 C# 编写，虽然它不是 CouchDB 的直接克隆，但它深受项目的影响。

该项目的一大特色是服务和嵌入式解决方案。这意味着您可以在服务器上将其作为服务运行，也可以在应用程序进程中运行嵌入式版本。

[目前，Windows 是唯一受支持的平台，但Rob Ashton](http://codeofrob.com/)和[Jérémie Laval](http://neteril.org/)在过去几周内取得了长足的进步，使其能够在 Mono 和 Linux 下工作。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-02-19T17:32:17.210

在这方面肯定也看一下 [NCouch](http://code.google.com/p/ncouch)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-05-12T20:26:09.770

您可能还想查看[Divan](https://github.com/foretagsplatsen/Divan)，这是一个用于访问 CouchDB 的 C# 库。

# c - 如何将字符串可移植地转换为不常见的整数类型？

> ID：437802
> 
> 赞同：11
> 
> 时间：2009-01-13T02:41:19.557
> 
> 标签：c, string, integer, c99, scanf

一些背景知识：例如，如果我想使用 for`scanf()`将字符串转换为标准整数类型，例如`uint16_t`，我会使用`SCNu16`from `<inttypes.h>`，如下所示：

```
#include <stdio.h>
#include <inttypes.h>
uint16_t x;
char *xs = "17";
sscanf(xs, "%" SCNu16, &x); 
```

但是更不常见的整数类型`pid_t`没有这样的东西。仅支持普通整数类型`<inttypes.h>`。要以另一种方式转换为可移植`printf()`的 a `pid_t`，我可以将其转换为`intmax_t`并使用`PRIdMAX`，如下所示：

```
#include <stdio.h>
#include <inttypes.h>
#include <sys/types.h>
pid_t x = 17;
printf("%" PRIdMAX, (intmax_t)x); 
```

但是，似乎没有办法可移植`scanf()`到`pid_t`. 所以这是我的问题：如何便携？

```
#include <stdio.h>
#include <sys/types.h>
pid_t x;
char *xs = 17;
sscanf(xs, "%u", &x);  /* Not portable! pid_t might not be int! /* 
```

我想到了`scanf()`ing `intmax_t`，然后在强制转换为 之前检查该值是否在`pid_t`'s 范围内`pid_t`，但似乎没有办法获得 的最大值或最小值`pid_t`。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-12T19:18:10.550

有一种强大且可移植的解决方案，即使用`strtoimax()`和检查溢出。

也就是说，我解析 a `intmax_t`，检查来自 的错误`strtoimax()`，然后`pid_t`通过强制转换并将其与原始`intmax_t`值进行比较来查看它是否“适合”a。

```
#include <inttypes.h>
#include <stdio.h>
#include <iso646.h>
#include <sys/types.h>
char *xs = "17";            /* The string to convert */
intmax_t xmax;
char *tmp;
pid_t x;                    /* Target variable */

errno = 0;
xmax = strtoimax(xs, &tmp, 10);
if(errno != 0 or tmp == xs or *tmp != '\0'
   or xmax != (pid_t)xmax){
  fprintf(stderr, "Bad PID!\n");
} else {
  x = (pid_t)xmax;
  ...
} 
```

无法使用`scanf()`，因为（正如我在评论中所说）**`scanf()`不会检测到溢出**。但是我说与 -`strtoll()`相关的函数都没有`intmax_t`; 是错误的。`strtoimax()`做！

`strtoimax()`除非您知道整数类型的大小（`pid_t`在本例中为 ），否则它也不会使用其他任何东西。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-13T02:54:33.073

这取决于您想要的便携程度。POSIX 说这`pid_t`是一个有符号整数类型，用于存储进程 ID 和进程组 ID。在实践中，您可以假设安全性`long`足够大。否则，您`intmax_t`必须足够大（因此它将接受任何有效的`pid_t`）；问题是，该类型可以接受在`pid_t`. 你被困在岩石和坚硬的地方之间。

我会使用`long`它并且不太担心它，除了一个模糊的评论，一个 100 年的软件考古学家会发现并观察到为什么 256 位 CPU 在传递一个 512 位值时会嘎吱作响地停止一个`pid_t`。

[POSIX 1003.1-2008](http://www.opengroup.org/onlinepubs/9699919799/toc.htm)现已在网络上提供（它的所有 3872 页，PDF 和 HTML）。您必须注册（免费）。我是从[Open Group Bookstore](http://www.opengroup.org/bookstore/catalog/c082.htm)得到的。

我看到的只是它必须是有符号整数类型。显然，所有有效的有符号整数值都适合`intmax_t`. 我找不到任何信息`<inttypes.h>`或`<unistd.h>`表明 PID_T_MAX 或 PID_T_MIN 或其他此类值（但我今天晚上才可以访问它，所以它可能隐藏在我没有寻找它的地方）。OTOH，我坚持我最初的评论 - 我相信 32 位值在实用上就足够了，`long`无论如何我都会使用，这将是 8 位机器上的 64 位。我认为可能发生的最糟糕的事情是“具有适当特权”的进程读取了一个太大的值，并由于类型不匹配而向错误的进程发送了信号。我不相信我会为此担心。

...哦哦！...p400下`<sys/types.h>`

> 实现应支持一种或多种编程环境，其中 blksize_t、pid_t、size_t、ssize_t 和 suseconds_t 的宽度不大于 long 类型的宽度。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-13T03:10:08.813

如果您真的担心，您可以`_assert(sizeof(pid_t) <= long)`或为您的 '%' 东西选择任何类型。

正如[这个答案](https://stackoverflow.com/questions/437802/how-to-portably-convert-a-string-into-an-uncommon-integer-type/437814#437814)中所解释的，规范说`signed int`。如果 'int' 改变了，你的 '%u' 根据定义也会随之改变。

# sql-server - sp_helptext 权限

> ID：437804
> 
> 赞同：1
> 
> 时间：2009-01-13T02:42:48.057
> 
> 标签：sql-server, permissions, grant

我需要向`sp_helptext`开发人员授予权限，以便他们可以检查存储过程。有人可以请，让我知道我该怎么做。

谢谢，克里斯汀

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2015-02-13T11:51:08.543

我认为这`grant execute on sp_helptext`是完全错误的做法。正如Jesus Lopez 所说[，](https://social.msdn.microsoft.com/Forums/sqlserver/en-US/507e80e0-718e-4e31-ad1a-db82f684685d/special-permission-on-dbdatareader-user-for-execute-sphelptext?forum=transactsql&prof=required)如果您想授予用户查看所有对象定义的权限，您必须使用

`GRANT VIEW DEFINITION TO your_database_user`

或者如果您想让用户查看特定对象的对象定义，您必须使用

`GRANT VIEW DEFINITION ON dbo.YourProcedure TO your_database_user`.

请注意，首先您必须在数据库中添加现有服务器[登录](https://msdn.microsoft.com/en-us/library/ms189751.aspx)作为新[用户](https://msdn.microsoft.com/en-us/library/ms173463.aspx)。然后，您将能够选择创建新用户的目标数据库，然后通过`GRANT VIEW DEFINITION`语句授予他/她的权限。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-13T02:46:28.987

语法是

```
Grant Execute on sp_helptext to user 
```

并且必须以master作为当前数据库执行。

您也可以通过 GUI 执行此操作，方法是右键单击用户或 proc 并转到属性。具体步骤取决于您使用的是企业管理器还是 sql management studio。

或者将它们添加到已经拥有权限的角色中，public 是最低要求。

```
exec sp_addrolemember 'public', 'user' 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-13T10:54:39.983

命令的格式需要是

```
grant execute on sp_helptext to [DomainName\UserName] ; 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-01-13T02:58:47.277

我不是 sql 专家，但我想开发人员还需要读取/执行他们正在获取文本的存储过程的权限。

# scripting - 应用程序的脚本引擎主机

> ID：437808
> 
> 赞同：2
> 
> 时间：2009-01-13T02:47:59.637
> 
> 标签：scripting

我们有一个应用程序，它在某些时候需要执行“任务”才能完成一些工作。这些任务目前只是命令（阅读：狡猾的 VB 脚本）被触发，然后监视进程的完成或如果它“超时”则中止，但是我们对执行没有足够的控制权。

我想集成一个脚本引擎或脚本主机，使我们能够在我们的应用程序中执行脚本（如果可能的话，在另一个 appdomain 中）并保持对它们的一些控制。我设想我们有遵循类似于以下界面的脚本：

```
void Initialize();
void Destroy();
void Execute();
void Abort();
int GetProgress(); 
```

当然，上面的代码可能不是代码中的内容，但是您明白了……基本上从我们的应用程序中，我们可以调用`Initialize`, then `Execute`，轮询`GetProgress`直到返回值为 100 或其他值，然后在最后调用`Destroy`或`Abort`那么`Destroy`如果我们需要取消或者它超过了超时期限。

脚本需要能够做的主要事情是 AD 查询，并与 Shell 交互（例如映射网络驱动器，或断开连接）。

我已经研究了一些选项来做到这一点——我已经实现了一个使用 Boo 作为语言的原型，并且本质上是动态加载脚本以在内存中作为“程序集”进行编译和执行。我喜欢这种工作方式，但我不确定如果不是“众所周知”的语言等，它会被接受的程度如何。

我正在研究的其他选项是 Python (IronPython)、Ruby (IronRuby)、PowerShell，也许还有 VB，但我不确定用 VB 实现的难易程度。

有什么意见、评论、建议甚至资源可以为我指明正确的方向吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-13T03:16:05.680

[Lua](http://www.lua.org)的设计正是为了嵌入到应用程序中。它是一种非常简洁高效的语言，这并没有什么坏处。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-13T02:58:12.877

这不是很令人兴奋，但我会考虑使用内置的脚本托管支持。我曾经在本机 C++ 中毫无问题地执行此操作，而 .Net 似乎在[http://msdn.microsoft.com/en-us/library/ms974577.aspx包装了相同的东西（承认文章是旧的）](http://msdn.microsoft.com/en-us/library/ms974577.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-12-06T13:44:41.367

如果您希望其他人为您的系统编写脚本，那么 PowerShell 可能是一个不错的选择。根据我的观察，人们对学习 PowerShell 的抵抗力不如对学习 Python 的抵抗力。这可能是因为 PowerShell 带有 Microsoft 的批准印章。在 Microsoft 商店中，Python 可能被视为过于异国情调，而 Ruby 更是如此。

很容易证明，Microsoft 世界中的每个人——无论是程序员、QA 人员、支持人员、高级用户——都将从学习 PowerShell 中受益。很容易证明学习 PowerShell 符合他们自己的利益。cmd.exe 将过时。每个人迟早都会学习 PowerShell。

这就是为什么我认为 PowerShell 将是一个不错的默认选择。

当然，这很大程度上取决于特定要求。

一个好的测试可能是用每种候选语言编写一个典型的脚本，看看哪一种是最自然的。听起来 PowerShell 很适合您的描述。但如果脚本非常“算法”，那么 Python 或 Ruby 会更好。如果速度是一个要求，我相信 IronPython 比 PowerShell 快得多。（我不知道 IronRuby。）等等。

**更新：**我刚刚有了一个深刻的想法 :) 嵌入式脚本语言是用户界面的一部分。也就是说，这是一个 UI 问题。您应该从用户的角度选择使用哪一个。

# c - 在不提供变量名的情况下打印 %d 时 printf 的行为

> ID：437816
> 
> 赞同：14
> 
> 时间：2009-01-13T02:56:02.990
> 
> 标签：c, printf

我刚刚遇到一个奇怪的问题，我正在尝试 printf 一个整数变量，但是我忘记指定变量名，即

```
printf("%d"); 
```

代替

```
printf("%d", integerName); 
```

令人惊讶的是，程序可以编译，有输出，而且不是随机的。事实上，它恰好是我最初想要打印的整数，恰好是 m-1。

只要程序继续运行，错误`printf`语句将始终输出 m-1 ......换句话说，它的行为就像语句读取一样

```
printf("%d", m-1); 
```

有人知道这种行为背后的原因吗？我正在使用没有任何命令行选项的 g++。

```
#include <iostream>
#define maxN 100
#define ON 1
#define OFF 0

using namespace std;

void clearArray(int* array, int n);
int fillArray(int* array, int m, int n);

int main()
{
    int n = -1, i, m;
    int array[maxN];
    int found;

    scanf("%d", &n);

    while(n!=0)
    {
        found=0;
        m = 1;
        while(found!=1)
        {
            if(m != 2 && m != 3 && m != 4 && m != 6 && m != 12)
            {
                clearArray(array, n);
                if(fillArray(array, m, n) == 0)
                {
                    found = 1;
                }
            }
            m++;
        }

        printf("%d\n");

        scanf("%d", &n);
    }

    return 0;
}

void clearArray(int* array, int n)
{
    for(int i = 1; i <= n; i++)
        array[i] = ON;
}

int fillArray(int* array, int m, int n)
{
    int i = 1, j, offCounter = 0, incrementCounter;

    while(offCounter != n)
    {
        if(*(array+i)==ON) 
        {
            *(array+i) = OFF;
            offCounter++;       
        }
        else 
        {
            j = 0;
            while((*array+i+j)==OFF)
            {
                j++;
            }
            *(array+i+j) = OFF;
            offCounter++;           
        }
        if(*(array+13) == OFF && offCounter != n) return 1;
        if(offCounter ==n) break;

        incrementCounter = 0;       
        while(incrementCounter != m)
        {
            i++;
            if(i > n) i = 1;
            if(*(array+i) == ON) incrementCounter++; 
        }       
    }

    return 0;
} 
```

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2009-01-13T03:13:24.297

你说“令人惊讶的是程序编译”。事实上，这并不奇怪。C 和 C++ 允许函数具有可变参数列表。printf 的定义是这样的：

```
int printf(char*, ...); 
```

“...”表示该函数有零个或多个可选参数。事实上，C 具有可选参数的主要原因之一是支持 printf 和 scanf 系列函数。

C 没有 printf 函数的特殊知识。在您的示例中：

```
printf("%d"); 
```

编译器不会分析格式字符串并确定缺少整数参数。这是完全合法的 C 代码。您缺少参数的事实是仅在运行时出现的语义问题。printf 函数将假定您已提供参数并在堆栈中查找它。它会拾取那里发生的任何事情。碰巧在您的特殊情况下，它正在打印正确的内容，但这是一个例外。一般来说，你会得到垃圾数据。这种行为会因编译器而异，并且还会根据您使用的编译选项而改变；如果您打开编译器优化，您可能会得到不同的结果。

正如对我的回答的其中一条评论所指出的那样，一些编译器具有类似“lint”的功能，可以实际检测到错误的 printf/scanf 调用。这涉及编译器解析格式字符串并确定预期的额外参数的数量。这是非常特殊的编译器行为，在一般情况下不会检测到错误。即，如果您编写自己的“printf_better”函数，它与 printf 具有相同的签名，编译器将不会检测是否缺少任何参数。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-01-13T03:05:31.770

发生的事情看起来像这样。

```
printf("%d", m); 
```

在大多数系统上，字符串的地址将被压入堆栈，然后`'m'`作为整数（假设它是 int/short/char）。没有警告，因为`printf`基本上被声明为`'int printf(const char *, ...);'`- the ... 意思是“任何事情都会发生”。

因此，由于“一切顺利”，当您将变量放在那里时，会发生一些奇怪的事情。任何小于 int 的整数类型都以 int 形式出现 - 类似的事情。什么都不发送也可以。

在 printf 实现（或至少一个“简单”实现）中，您会发现`va_list`and的用法`va_arg`（名称有时会因一致性而略有不同）。这些是实现用来绕过参数列表的“...”部分的内容。这里的问题是没有类型检查。由于没有类型检查，`printf`当它查看格式字符串`("%d")`并认为应该有`'int'`下一个时，将从执行堆栈中拉出随机数据。

在黑暗中随机拍摄会说您在 printf 之前所做的函数调用可能`'m-1'`作为第二个参数传递？这是许多可能性之一——但如果发生这种情况会很有趣。:)

祝你好运。

顺便说一句 - 大多数现代编译器（我相信是 GCC？）都有警告，可以启用以检测这个问题。我相信 Lint 也一样。不幸的是，我认为对于 VC，您需要使用 /analyze 标志而不是免费获得。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-01-13T03:06:14.017

它从堆栈中取出一个整数。

[http://en.wikipedia.org/wiki/X86_calling_conventions](http://en.wikipedia.org/wiki/X86_calling_conventions)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-13T03:07:21.970

您正在查看堆栈。更改优化器值，这可能会改变。更改变量声明的顺序（特别是）`m`。做`m`一个寄存器变量。做`m`一个全局变量。

你会看到发生的一些变化。

这类似于您在执行简单 I/O 时遇到的著名的缓冲区溢出攻击。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-13T03:26:03.507

虽然我非常怀疑这会导致内存违规，但您得到的整数是未定义的垃圾。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-13T02:58:51.410

您发现*了一种*行为。它可能是*任何*其他行为，包括无效的内存访问。

# jquery - jQuery，属性过滤器选择器并找出确切的_which_元素被点击

> ID：437827
> 
> 赞同：0
> 
> 时间：2009-01-13T03:01:53.353
> 
> 标签：jquery

我有这个工作正常的 jQuery

```
$("li[id^='shop_id']").click( function () {

  alert("I clicked on id ??");

 }); 
```

如果单击任何 ID 以“shop_id”开头的列表元素（即“shop_id_1”、“shop_id_2”等），上述操作将起作用。问题是我不知道如何准确找出点击了哪个 id。我需要知道，因为我需要根据单击的 id 设置其他元素的可见性。

有任何想法吗 ？

谢谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-13T03:05:57.980

“this”变量将在这里为您提供帮助：

```
$("li[id^='shop_id']").click( function () {
    var current_id = $(this).attr("id");
    alert(current_id);
}); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-13T03:06:24.030

```
<script type="text/javascript">
  $("li[id^='shop)id']").click(function(){
    alert($(this).attr('id'));
  });
</script> 
```

# .net - C# VS2008 中的 COM 对象：加载类型库/DLL 时出错

> ID：437833
> 
> 赞同：0
> 
> 时间：2009-01-13T03:06:17.590
> 
> 标签：.net, com, interop

我正在尝试从 Vista Ultimate 上的 Visual Studio 2008 项目 (.NET 3.5 SP1) 中引用第三方 COM DLL。

我运行了 COM 组件的设置，然后发现它不是正确的设置。所以我卸载并运行了正确的安装。在添加对新 C# 项目的引用后，并非所有应有的对象方法都可用。

编译器错误之一是：

> 无法确定 COM 引用“APIV2_COMLib”的依赖关系。加载类型库/DLL 时出错。（来自 HRESULT 的异常：0x80029C4A (TYPE_E_CANTLOADLIBRARY)）

考虑到注册表可能保留了不正确的值，我卸载了组件并在注册表中搜索任何碎屑迹象，但没有找到。尽管如此，重新安装还是会出现同样的错误。

在线搜索显示其他人[在 MSDN 论坛中遇到了相同的问题“升级到 3.5 时出现奇怪的 COM 错误”，](http://social.msdn.microsoft.com/Forums/en-US/netfxbcl/thread/9e4be401-c56b-417c-8393-f7dbb64b1abe/)但我没有找到答案。

我的同事使用来自 .NET 代码的相同 COM 对象（尽管不高于 .NET 2.0 或在 Vista 上）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-13T06:27:34.827

在我看来，注册表中仍有一些您无法清除的东西挥之不去。尝试在虚拟机上进行“全新安装”，看看是否真的如此。（除非你已经确定这正是问题所在......）

# reporting-services - 如何在 SQL Server Reporting Services 中更改订阅的所有者

> ID：437836
> 
> 赞同：18
> 
> 时间：2009-01-13T03:06:59.193
> 
> 标签：reporting-services

之前的 DBA 在这里设置了一些 SQL Server Reporting Services 报告来自动运行并将报告通过电子邮件发送给用户。当他离开时，他的帐户被禁用，现在他们不工作了。订阅状态为：

> 发送邮件失败：授予用户'OURDOMAIN\old_DBA_Username'的权限不足以执行此操作。

有没有一种简单的方法来更改所有者，我在订阅表中的 RS 数据库中找到了 Owner 字段，虽然只是更改了它，但不想破坏我们的生产报告服务？

当然，另一种选择是创建新订阅并删除旧订阅，但肯定有更好的方法。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-08-24T10:26:54.747

[此处](http://blogs.msdn.com/b/miah/archive/2008/07/10/tip-change-the-owner-of-report-server-subscription.aspx)发布的解决方案对我有用。基本上，您可以通过运行下面的脚本直接在 SSRS 数据库上对订阅所有者进行 midify。

```
DECLARE @OldUserID uniqueidentifier
DECLARE @NewUserID uniqueidentifier
SELECT @OldUserID = UserID FROM dbo.Users WHERE UserName = 'DOMAINA\OldUser'
SELECT @NewUserID = UserID FROM dbo.Users WHERE UserName = 'DOMAINA\NewUser'
UPDATE dbo.Subscriptions SET OwnerID = @NewUserID WHERE OwnerID = @OldUserID 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-09-17T17:34:17.140

您也可以在 C# 中的 Visual Studio 中执行此操作。在您的报表服务器上创建对 ReportService2010.asmx 的 Web 引用，与此类似。

```
public class ChangeOwner
{
public string OldOwner { get; set; }
public string NewOwner { get; set; }

public ChangeOwner()
{
}

public void ChangeReportOwner()
{
    ReportingService2010 rs = new ReportingService2010();
    //set the URL to your report server
    rs.Url = "http://youserver/ReportServer/ReportService2010.asmx";
    rs.Credentials = System.Net.CredentialCache.DefaultCredentials;

    Subscription[] items = rs.ListSubscriptions("/");

    foreach(Subscription item in items)
    {
        if(item.Owner.ToUpper() == this.OldOwner.ToUpper())
        {
            Console.WriteLine("Updating report " + item.Path + " " + item.Owner);
            rs.ChangeSubscriptionOwner(item.SubscriptionID, this.NewOwner);
        }
    }
}

} 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-07-28T22:21:55.227

我之前遇到过这个问题，并在 Jeremiah Clark 博客上的这篇[文章中找到了答案。](http://blogs.msdn.com/miah/archive/2008/07/10/tip-change-the-owner-of-report-server-subscription.aspx)

要点是，您正确地使用新用户更新*ReportServer*数据库的*Subscriptions*表中的*Owner*字段。

 **无论如何，为我工作。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-21T03:40:12.190

从 SRSS 2008 R2 开始，您可以通过[ReportingService2010](http://msdn.microsoft.com/en-us/library/ee640743) Web 服务的[ChangeSubscriptionOwner](http://msdn.microsoft.com/en-us/library/reportservice2010.reportingservice2010.changesubscriptionowner.aspx)方法以[编程方式更改所有者。](http://msdn.microsoft.com/en-us/library/ms156307.aspx)

您可以通过 .rss 脚本调用此 Web 服务。例如。

```
' OldOwner - username of owner to replace
' NewOwner - username of new owner

Public Sub Main()
    Dim items() As Subscription

    items = rs.ListSubscriptions("/")

    Dim item as Subscription
    For Each item in Items
        If (item.Owner.ToUpper() = OldOwner.ToUpper()) Then
            Console.WriteLine("Updating report " & item.Path & " " & item.Owner)
            rs.ChangeSubscriptionOwner(item.SubscriptionID, newOwner)
        End If
    Next item
End Sub 
```

并使用[rs.exe](http://msdn.microsoft.com/en-us/library/ms162839.aspx)工具运行它，如下所示：

```
rs.exe -i ChangeSubscriptionOwner.rss -s http://localhost/reportserver -e Mgmt2010 -v NewOwner="domain\newuser" -v OldOwner="domain\olduser" 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2020-03-25T22:16:08.087

从 SQL 2016 开始，用户界面中有一项功能可以替换订阅所有者。唯一的缺点是您必须单独编辑每个订阅。如果你只有 1 个，这不是问题，但如果你有几十个，你会想要使用其他建议之一。

[![此图像显示您可以编辑的所有者字段](https://i.stack.imgur.com/uvS2Y.png)](https://i.stack.imgur.com/uvS2Y.png)

资料来源：[https ://www.sqlshack.com/report-subscription-changes-sql-server-reporting-services-2016/](https://www.sqlshack.com/report-subscription-changes-sql-server-reporting-services-2016/)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-16T17:36:05.953

不能修改订阅吗？

[http://technet.microsoft.com/en-us/library/ms157343.aspx](http://technet.microsoft.com/en-us/library/ms157343.aspx)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2011-02-08T07:01:46.843

我不得不面对同样的问题并使用反射器来找出问题所在。我已经在 ReportingServicesServer.dll 中展示了 .Net 代码，它在下面的帖子中引发了这个异常。

[http://easybi.wordpress.com/2011/01/22/microsoft-reportingservices-diagnostics-utilities-unknownusernameexception-the-user-or-group-name-is-not-recognized/](http://easybi.wordpress.com/2011/01/22/microsoft-reportingservices-diagnostics-utilities-unknownusernameexception-the-user-or-group-name-is-not-recognized/)

正如 briang 建议的那样，Jerimiah Clark 提供的解决方案是有效的。我的帖子详细说明了幕后发生的事情。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2015-03-09T13:36:28.187

您可以使用附加的存储过程：您需要提供要为其分配订阅的新用户和订阅的报告名称

```
CREATE  PROCEDURE [dbo].[SP_ChangeSubscriptionOwner] 
(
@userName nvarchar(260),
@ReportName nvarchar(425)
)

/*
  Example: 
  EXEC SP_ChangeSubscriptionOwner '<New user Name>' , '<Report Name>'

   The procedure changes the Owner of a subscription to the user enterd as  parameter to the procedure

*/

AS 
BEGIN
SET NOCOUNT ON

DECLARE @MSG VARCHAR(1000)
IF NOT EXISTS 
 (
   SELECT 1 
       FROM Users where UserName = @userName
 )

   SET @MSG = 'User: '+'"'+  @userName + '"'+' doesn''t exist in Users table.'
   ELSE 
   SET @MSG = 'No subscriptions were found to report: '+'"' + @ReportName + '"'+' ,Or the User: '+'"'+  @userName + '"'+' is already the owner of the report subscription.'

 update S 
 set S.OwnerID = U.UserID
 FROM Subscriptions S
 JOIN Catalog c
 on s.Report_OID = c.ItemID
 JOIN Users U 
 ON U.UserName = @userName
 where C.Name = @ReportName
 AND U.UserID != S.OwnerID

  if @@ROWCOUNT = 0 
   raiserror (@MSG,16,1)

  END 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2020-05-30T14:41:06.330

ntombela 的解决方案在 SSRS 2016 上为我们工作，除了我们还必须更新 ModifiedByID。如果我们不这样做，我们将无法禁用/启用订阅。我们得到一个弹出窗口，指示未找到现已禁用的 ID。所有者显示了正确的用户名，但修改者条目仍显示旧 ID。

我不会认为这很重要，但对我们来说似乎很重要。从好的方面来说，我们不再看到 SSRS 日志文件错误，例如：

> 错误：引发 Microsoft.ReportingServices.Diagnostics.Utilities.UnknownUserNameException：、Microsoft.ReportingServices.Diagnostics.Utilities.UnknownUserNameException：无法识别用户或组名“ *AD Domain\olddisabledusername ”。*

# c# - WPF 中树视图的级别？

> ID：437840
> 
> 赞同：13
> 
> 时间：2009-01-13T03:09:05.243
> 
> 标签：c#, wpf, winforms, treeview

在**WinForms**应用程序中，a 的级别由**WPF** 中的相应命令是什么`treeview`给出？`node.level`

 *** * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-01-21T11:33:26.270

鉴于问题：-

> 那么当我点击一个节点时，我怎么知道它是哪一层呢？有解决方法吗？

这是一个可能的解决方法：-

*如果您在Visual Tree*中有一个对 Control 的引用，可能来自一个`Click`事件，那么您可以使用该控件通过调用我过去使用过的这样的函数来计算它在树视图中的哪个级别。

```
private int FindTreeLevel(DependencyObject control)
{
  var level = -1;
  if (control != null)
  {
    var parent = VisualTreeHelper.GetParent(control);
    while (!(parent is TreeView) && (parent != null))
    {
      if (parent is TreeViewItem)
        level++;
      parent = VisualTreeHelper.GetParent(parent);
    }
  }
  return level;
} 
```

`TreeViewItem`此方法将遍历 VisualTree 并在找到控件时停止之前计算它找到了多少控件`TreeView`。

如果您需要在 XAML 中使用它，例如，a `DataTrigger`of a`HierarchicalDataTemplate`那么您可以将它打包到一个`IValueConverter`类中

```
<Window.Resources>
  <local:TreeLevelConverter x:Key="treeLevelConverter"/>

  <HierarchicalDataTemplate DataType="{x:Type local:MyType}" >
  ...
     <Grid ... >
         <TextBlock x:Name="MyControl" ... />
     ...
     </Grid>
     <HierarchicalDataTemplate.Triggers>
        <DataTrigger Binding="{Binding RelativeSource={RelativeSource Self}, Converter={StaticResource treeLevelConverter}}" Value="0" >
              <Setter TargetName="MyControl" Property="Background" Value="Red"/>
        </DataTrigger>
    </HierarchicalDataTemplate.Triggers>
  </HierarchicalDataTemplate>
</Window.Resources> 
```

然后使用下面的转换器

```
 public class TreeLevelConverter : IValueConverter
  {
    public object Convert(object value, Type targetType, object parameter, CultureInfo culture)
    {
      var level = -1;
      if (value is DependencyObject )
      {
        var parent = VisualTreeHelper.GetParent(value as DependencyObject );
        while (!(parent is TreeView) && (parent != null))
        {
          if (parent is TreeViewItem) 
            level++;
          parent = VisualTreeHelper.GetParent(parent);
        }
      }
      return level;
    }

    public object ConvertBack(object value, Type targetType, object parameter, CultureInfo culture)
    {
      throw new System.NotImplementedException();
    }
  } 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-01-13T06:11:35.500

您的问题的直接答案是 WPF 中没有级别属性。

winforms控件和wpf控件之间没有一对一的关系。因为两者的底层架构和用法完全不同。在 WPF 中，您会将层次结构数据（LinkedList 类型的数据结构）绑定到 TreeView 并将 HeirarchicalDataTemplate 定义到 Treeview.ItemTemplate 属性

# asp.net - 用于确定样式来自何处的 HTML 工具

> ID：437853
> 
> 赞同：2
> 
> 时间：2009-01-13T03:18:40.340
> 
> 标签：asp.net, html

我有一个 ASP.NET 页面，我需要在其中找出文本框的样式来自何处。为页面定义了几个样式表，我希望能够使用某种工具/编辑器来告诉我使用了哪些样式以及从哪些文件中呈现文本框。

谢谢你。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-01-13T03:20:21.413

使用 Firefox 和[Firebug](https://addons.mozilla.org/en/firefox/addon/1843)并检查文本框。Firebug 是做到这一点的最有用的工具。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-13T03:21:33.843

在 IE 中，您可以使用[IE Developer Toolbar](http://www.microsoft.com/en-us/download/details.aspx?id=18359)。但我是 FireFox 的 FireBug 的粉丝。

来自评论：[Bernard Chhun](https://stackoverflow.com/users/48500/bernard-chhun)推荐[FireBug Lite](http://getfirebug.com/lite.html)作为 IE Dev Toolbar 的替代品。它也适用于 Opera 和 Safari。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-13T09:37:45.333

大多数浏览器都有开发工具（内置或作为扩展），可以显示应用规则的[级联顺序](http://www.w3.org/TR/CSS21/cascade.html#cascading-order)。

对于 Firefox，有[Firebug 扩展](https://addons.mozilla.org/de/firefox/addon/1843)，Safari (WebKit) 有[Web Inspector](http://trac.webkit.org/wiki/ProposedWebInspectorUIRefresh)，Opera 有[Dragonfly](http://www.opera.com/dragonfly/)，对于 Internet Explorer，有[Internet Explorer Developer Toolbar](http://www.microsoft.com/downloadS/details.aspx?familyid=E59C3964-672D-4511-BB3E-2D5E1DB91038)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-13T10:05:25.870

Firefox的[Web 开发人员工具栏](https://addons.mozilla.org/en-US/firefox/addon/60)有 CSS 和元素检查器，我觉得它们非常有用。

您还可以在浏览器中修改 CSS，以便无需返回 IDE 即可调整布局

# java - 您可以一次需要多种类型吗？

> ID：437854
> 
> 赞同：3
> 
> 时间：2009-01-13T03:18:51.120
> 
> 标签：java, inheritance, types, interface

基本上我想这样做：

```
public interface A {
    void a();
}
public interface B {
    void b();
}
public class SomeClass {
    public SomeClass(<A&B> e) { // Note the type here
        e.a();
        e.b();
    }
} 
```

我在评论行所做的显然是非法的。我知道我可以只要求传递的对象来实现接口 A 或接口 B，但是有没有办法做到这两者？

我想有一些解决方法（比如要求参数是 A 类型，然后检查它是否也是 instanceof B），但这样我就无法从编译器那里获得帮助。你知道有什么方法可以做到这一点吗？或者也许是一个更聪明的解决方法......

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-01-13T03:24:18.613

您可以在启用泛型的情况下做到这一点。例如，要接受同时实现 CharSequence 和 Appendable 的某个类的实例：

```
 public <T extends CharSequence & Appendable> void someMethod(T param) {
    ...
  } 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-13T03:24:23.247

根据设计，您可以执行以下操作之一：

1.  制作 A : B 或 B : A。
2.  制作一个接口C：A，B。

无论哪种方式，您都希望拥有同时包含 a() 和 b() 的合同。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-13T04:55:12.877

嗯，有[`<T extends A & B> f(T ab)`](http://java.sun.com/docs/books/jls/third_edition/html/typesValues.html#108850)符号，但你应该更喜欢组合而不是继承。你真的不需要扩展任何东西。只需创建一个类型为 和 的联合*联合*（乘积），如下所示：`A``B`

```
public abstract class P2<A, B> {
  public A _1();
  public B _2();
} 
```

有时称为 product-2 或“pair”类型。您可以为这些创建一个方便的构造函数：

```
public final class P {
  private P() {}
  public static <A, B> P2 p(final A a, final B b) {
    return new P2<A, B>() {
      public A _1() {
        return a;
      }
      public B _2() {
        return b;
      }
    }
  }
} 
```

请注意，您可以对两个参数使用相同的对象，如果`A`和`B`是接口并且您的对象实现了它们：

```
P2<A, B> both = P.p(o, o); 
```

或者您可以自由使用两个不同的对象，使设计美观且解耦。

您会发现该类型以及多达 8 种类型的产品，都包含在[Functional Java](http://functionaljava.org)库中。还有一种称为两种类型`Either<A, B>`的*不相交并集*（总和）的类型，因此它包含一个类型`A`或`B`（或两者兼有）的值。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-13T03:28:49.463

只是在黑暗中拍摄，我不知道这是否是正确的语法，即如果您必须重新声明 C 中的方法，但是这又如何：

```
public interface A {
    void a();
}
public interface B {
    void b();
}

public interface C extends A, B{}

public class SomeClass{
    public SomeClass(C e) { // Note the type here
      e.a();
      e.b();
    }

} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-13T09:51:59.313

如果你有一个方法需要两个不同的接口作为参数，只需让它接受两个参数。

```
public void foo(A a, B b) {
    ....
} 
```

这并不难，相信我。

# php - 在 smarty 中处理递归的最佳方法是什么？

> ID：437862
> 
> 赞同：9
> 
> 时间：2009-01-13T03:22:55.403
> 
> 标签：php, templates, recursion, smarty

我在 Smarty 中找到了几种处理递归的方法，主要是基于将模板包含在自身中，这似乎是一种荒谬的资源浪费。我找到了一个解决方案，由 Messju 在 Smarty 提供，似乎恰到好处 - 但它不受支持并且在最新版本的 smarty 中失败:(

有人问：我希望 smarty 打印出一个由条目数组定义的讨论线程。如果一个条目有一个或多个答案，则将这些答案列为数组中所述条目的子项，依此类推。

```
array(
    array(
        'id'=>0,
        'headline'=>"My parent headline",
        'body'    =>"My parent body",
        'children'=>array(
            array(
                'id'=>1,
                'headline'=>"My firstChild headline",
                'body'    =>"My firstChild body",
                'children'=>array()
            ),
            array(
                'id'=>2,
                'headline'=>"My secondChild headline",
                'body'    =>"My secondChild body",
                'children'=>array()
            )
        )
    ),
); 
```

嵌套数组具有任意深度，并且每个条目将具有任意数量的子项。对我来说，这是我想在模板范围内做的事情，因为我认为它纯粹是显示逻辑。我不想在模板之外处理 HTML 或某种类型的 HTML 占位符。

我希望 smarty 将其打印为嵌套列表：

```
<ul>
    <li>
        <h1>My parent headline</h1>
        <p>My parent body</p>
        <ul>
            <li>
                <h1>My firstChild headline</h1>
                <p>My firstChild body</p>
            </li>
            <li>
                <h1>My secondChild headline</h1>
                <p>My secondChild body</p>
            </li>
        </ul>
    </li>
</ul> 
```

我开始意识到这可能是一个非常具体的问题，所以我想我会写一个聪明的插件来专门处理这个问题，尽管我宁愿有一个全面的解决方案。

有办法吗？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-10-21T10:05:49.787

在 Smarty 3 中，这可以使用 {function} 来完成。以下代码将产生所需的输出。

```
{function name=printList}
<ul>
    {foreach $items as $item}
    <li>
        <h1>{$item['headline']}</h1>
        <p>{$item['body']}</p>
        {if $item['children']}
            {call name=printList items=$item['children']}
        {/if}
    </li>
    {/foreach}
</ul>
{/function}

{call name=printList items=$comments} 
```

更多信息可以在[文档](http://www.smarty.net/docs/en/language.function.function.tpl)中找到。

旁注：仅仅因为某些东西是复杂的或递归的，并不意味着它不能在模板中。看在上帝的份上，HTML ul-li 结构自然是递归的，通过将其隐藏或将其移动到其他地方（只是因为它对于模板来说太复杂了），您将在应用程序中引入额外的复杂性。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-03-16T20:09:16.233

“要理解递归，就必须先理解递归……”

只是在开玩笑。这应该做你想要的：

```
<?php
/*
* Smarty plugin
* ————————————————————-
* File:     function.recurse_array.php
* Type:     function
* Name:     recurse_array
* Purpose:  prints out elements of an array recursively
* ————————————————————-
*/

function smarty_function_recurse_array($params, &$smarty)
{

if (is_array($params['array']) && count($params['array']) > 0) {
   $markup = '';

   $markup .= '<ul>';

   foreach ($params['array'] as $element) {
      $markup .= '<li>';

      $markup .= '<h1>' . $element['headline'] . '</h1>';
      $markup .= '<p>' . $element['body'] . '</p>';

      if (isset($element['children'])) {
         $markup .= smarty_function_recurse_array(array('array' => $element['children']), $smarty);
      }

       $markup .= '</li>';
   }

   $markup.= '</ul>';

   return $markup;

} else {
   return 'not array';
}
} 
```

将文件放入您的 smarty/plugins 文件夹中。将您的数组分配给 Smarty，然后在您的模板中调用它，如下所示：

```
{recurse_array array=$data} 
```

这是制作自定义 Smarty 函数的好教程：

[创建自定义 Smarty 函数](http://www.velvetblues.com/web-development-blog/smarty-templates-create-custom-functions/)

请注意此示例对您的基础数据结构的依赖性。另外，请记住，一组异常长或嵌套非常深的数据可能非常慢。管理你的复杂性，把事情记录在案，你应该没问题。祝你好运！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-16T12:37:16.710

您可能需要考虑为 smarty 创建自定义函数/修饰符/插件。将数组传递给自定义函数，同时定义函数应使用的模板。如果就这么简单，只需将文本插入某个位置，在函数中加载模板，然后在 PHP 中使用 regexes/str_replace/...

或者直接在 PHP 中进行而不使用 smarty 模板，因为您只需要 h1、ul、li 和 p 标签，并使用 CSS 更改布局。

或者，如果您担心在 Smarty 中打开和关闭文件的开销，请估计 90% 的情况下的级别数量是多少，并创建涵盖这 90% 的模板。对于其余部分，通过包含模板本身来使用递归......

* * *

## 回答 #4

> 赞同：-5
> 
> 时间：2009-01-13T04:00:57.337

最好的方法是不这样做。

Smarty 应该很简单。这听起来不像。

# c# - 从密码派生加密密钥

> ID：437864
> 
> 赞同：2
> 
> 时间：2009-01-13T03:23:32.220
> 
> 标签：c#, asp.net

我正在尝试使用 .net 2.0 PasswordDeriveBytes 类生成密钥。

```
 PasswordDeriveBytes pdb = new PasswordDeriveBytes("blahblahblah",null);
  byte[] iv = new byte[] { 0, 0, 0, 0, 0, 0, 0, 0 };
  byte[] key = pdb.CryptDeriveKey("TripleDES", "SHA1", 128, iv); 
```

代码抛出“CryptographicException：指定的标志无效”。尝试执行上面的 CryptDeriveKey 方法时。我正在尝试加密 asp.net 中的数据库条目，这是我第一次尝试加密。我会很感激任何帮助。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-13T03:34:13.757

根据 MSDN：

*“如果 keySize 参数设置为 0 位，则使用指定算法的默认密钥大小。”*

[MSDN PasswordDeriveBytes.CryptDeriveKey 方法](http://msdn.microsoft.com/en-us/library/system.security.cryptography.passwordderivebytes.cryptderivekey.aspx)

```
PasswordDeriveBytes pdb = new PasswordDeriveBytes("blahblahblah",null);
byte[] iv = new byte[] { 0, 0, 0, 0, 0, 0, 0, 0 };
byte[] key = pdb.CryptDeriveKey("TripleDES", "SHA1", 0, iv); 
```

除非您有充分的理由指定尺寸，否则我建议将其保留为 0。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-13T03:31:38.207

TripleDES 的密钥长度为 192 位尝试：

```
byte[] key = pdb.CryptDeriveKey("TripleDES", "SHA1", 192, iv); 
```

尝试[此链接](http://msdn.microsoft.com/en-us/library/system.security.cryptography.passwordderivebytes.aspx)以获取示例代码

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-13T03:51:03.147

您应该考虑使用[Rfc2898DeriveBytes](http://msdn.microsoft.com/en-us/library/system.security.cryptography.rfc2898derivebytes.aspx)而不是 PasswordDeriveBytes。

# exception - 动态语言中参数类型检查的正确位置在哪里？

> ID：437868
> 
> 赞同：0
> 
> 时间：2009-01-13T03:23:57.693
> 
> 标签：exception, typechecking

考虑以下。（在伪代码中）。

```
Class
{
    hello
    world

    public
    constructor(hello, world)
    {
        if (hello is not String)
        {
            throw Exception()
        }

        if (world is not Array)
        {
            throw Exception()
        }

        this.setHello(hello)
        this.setWorld(world)
    }

    protected
    setHello(hello)
    {
        if (hello is not String)
        {
            throw Exception()
        }

        this.hello = hello
    }

    private
    setWorld(world)
    {
        if (world is not Array)
        {
            throw Exception()
        }

        if (not this:isASafe(world))
        {
           throw Exception()
        }

        this.world = world
    }

    public
    static
    isASafe(world)
    {
        if (world is not Array)
        {
            return false
        }

        if (world.length < 1)
        {
            return false
        }

        if (world['sky'] is not 'blue')
        {
            return false
        }

        return true
    }
} 
```

1.  最佳实践是在构造函数中执行参数类型/有效性检查，然后在函数中再次执行，还是仅在两种方法之一中执行。（即构造函数 xor 方法）。

2.  此外，所述方法的范围（公共/受保护/私有/等）是否改变了上述答案（1）。例如 isASafe(world) 是一个公共的静态方法，并且只在类中封装逻辑。

3.  构造函数是否应该进行任何检查？

我对此事有自己的个人看法，但想看看其他人的想法，以及他们认为最有效/最有效的方法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-13T04:31:05.810

检查参数有效性对于所有公共功能显然比受保护或私有更重要。由于您的构造函数是公开的，因此清楚地检查是有意义的。

并非总是可以在所有情况下检查有效性 - 什么是有效的问题，例如天空 == 蓝色，在您无法访问的上下文中可能会有所不同。

我更喜欢防御性代码。在检测到数据不一致之前运行的语句越少，意味着断言发生在更接近引入问题的语句处——从而更容易/更快地找到它。

这意味着我的偏好是对大多数方法的参数进行一些完整性检查。我通常会省略检查某些私有方法，尽管您冒着有一天某人（也许是您）将其设为受保护或公开的风险，并且您也跳过了在离源更近一步时发现数据不一致的机会。

# cocoa - 如何在按钮单击时在 Cocoa 中打开启动 NSWindow

> ID：437873
> 
> 赞同：4
> 
> 时间：2009-01-13T03:25:26.833
> 
> 标签：cocoa

我有一个在界面生成器中定义的 NSWindow。我想这样当用户点击一个按钮时，它会打开一个 NSWindow 的新实例。我必须继承 NSWindow 还是什么？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-01-13T03:53:51.207

如果您在 IB 中创建了窗口并且它位于您的主 nib 文件中，则每次按下按钮时都无法创建“新实例”。当您在 nib 文件中创建对象时，实际上是由 IB 创建一个实例，然后将其归档到 nib 文件中，因此您获得了该实例。假设您的窗口连接到一个`auxWindow`在响应您的按钮单击的同一对象上命名的变量，并且操作消息命名为`buttonClick`，您可以执行以下操作来显示它：

```
-(IBAction)buttonClick:(id)sender {
    if(! [auxWindow isVisible] )
        [auxWindow makeKeyAndOrderFront:sender];
} 
```

这将导致您在 IB 中定义的辅助窗口出现在屏幕上并成为关键窗口（也是应用程序中最重要的窗口）。但是请注意，如果您打算重复使用此窗口，则***必须***取消选中 IB Inspector 中的*Release on Close*框，否则您将在下次单击该按钮时遇到访问冲突。

这是对您的基本问题的简单回答，但是窗口编程可能非常复杂并且通常非常具体（例如，您真的想要一个面板来说明您正在做什么？）...所以我强烈建议您阅读[Window Programming Guide](https://developer.apple.com/library/mac/documentation/Cocoa/Conceptual/WinPanel/Introduction.html)以获取有关此主题的更多信息，然后在遇到困难时在此处提出非常具体的问题。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-13T04:24:46.743

将窗口放在自己的nib文件中，然后每次加载nib文件。你应该使用它`NSWindowController`来加载笔尖，就像这样`NSDocument`做一样。

# url-rewriting - nginx重写问题

> ID：437874
> 
> 赞同：0
> 
> 时间：2009-01-13T03:25:35.787
> 
> 标签：url-rewriting, nginx

如果第二个文件存在，我需要使用 nginx 从 /blah/.../3275 到 /id/3275 进行重写，否则我想将它交给 apache。这是我的（微弱的）尝试

(...) 代表不相关的东西

```
if ($request_filename ~^/.../([0-9]+)/$) {
               if (-d /id/$1) {
                        rewrite ^/.../[0-9]+/([0-9]+)/$ /id/$1;
                }
        } 
```

有没有人有任何想法

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-13T03:47:58.377

最好通过内部重写来做到这一点：

```
set $original_uri $uri;

location /blah/irrelevant_stuff {
   error_page 404 = @apache;
   rewrite ^/blah/irrelevant_stuff/([0-9]+)$ /id/$1;
}

location @apache {
   proxy_pass http://upstream$original_uri;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-14T21:08:55.140

以上来自 wulong 的回答我由于某种原因无法工作，但我确实通过使用它来工作

```
 if (!-e $request_filename) {
    proxy_pass http://apache$original_uri;
    break;
  } 
```

而不是 error_page 指令。基本相同的想法

# java - 多处理器编程课程反馈

> ID：437878
> 
> 赞同：0
> 
> 时间：2009-01-13T03:28:48.417
> 
> 标签：java, multicore

我计划参加为期一周的关于这个主题的课程。我主要参与 Java 项目，并且对 C 和 C++ 也有相当的了解。而且，我有兴趣了解有关并发编程的更多信息，并希望获得有关本课程的反馈。有人读过这本书或发现这些概念与当代编程相关吗？

有关课程的更多信息：http: [//www.amazon.com/Art-Multiprocessor-Programming-Maurice-Herlihy/dp/0123705916/](https://rads.stackoverflow.com/amzn/click/com/0123705916)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-13T04:45:50.353

我肯定会建议你这样做。但是我想添加另一个非常重要的资源，特定于 java - 正如您将问题标记为“java” - 这是[Java Concurrency in Practice](https://rads.stackoverflow.com/amzn/click/com/0321349601)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-13T04:41:12.437

这些概念非常相关。

我似乎记得在某个时候我对这本书有一个非常快速的“轻弹”。它涵盖了一些非常有趣的材料。但我记得有一点让我担心的是，它提出了各种算法实现，这些实现依赖于对易失性数组的访问，并假设在这样做时各个元素具有易失性访问语义。据我所知，Java 内存模型不提供这种保证，因此给出的实现可能需要一些修改。

# c# - NaN 或 IsNumeric 的 C# 等价物是什么？

> ID：437882
> 
> 赞同：104
> 
> 时间：2009-01-13T03:32:07.333
> 
> 标签：c#, parsing

测试输入字符串是否包含数值（或相反地不是数字）的最有效方法是什么？我想我可以使用`Double.Parse`或正则表达式（见下文），但我想知道是否有一些内置的方法可以做到这一点，例如 javascript`NaN()`或`IsNumeric()`（那是 VB，我不记得了吗？）。

```
public static bool IsNumeric(this string value)
{
    return Regex.IsMatch(value, "^\\d+$");
} 
```

* * *

## 回答 #1

> 赞同：180
> 
> 时间：2009-01-13T03:35:30.727

这没有正则表达式开销

```
double myNum = 0;
String testVar = "Not A Number";

if (Double.TryParse(testVar, out myNum)) {
  // it is a number
} else {
  // it is not a number
} 
```

顺便说一句，所有标准数据类型，除了 GUID 的明显例外，都支持 TryParse。

**更新**
secretwep 发现值“2345”将作为数字通过上述测试。但是，如果您需要确保字符串中的所有字符都是数字，则应采用另一种方法。

**示例 1**：

```
public Boolean IsNumber(String s) {
  Boolean value = true;
  foreach(Char c in s.ToCharArray()) {
    value = value && Char.IsDigit(c);
  }

  return value;
} 
```

或者如果你想更花哨一点

```
public Boolean IsNumber(String value) {
  return value.All(Char.IsDigit);
} 
```

**更新 2**（来自 @stackonfire 以处理 null 或空字符串）

```
public Boolean IsNumber(String s) { 
    Boolean value = true; 
    if (s == String.Empty || s == null) { 
        value=false; 
    } else { 
        foreach(Char c in s.ToCharArray()) { 
            value = value && Char.IsDigit(c); 
        } 
    } return value; 
} 
```

* * *

## 回答 #2

> 赞同：40
> 
> 时间：2009-01-13T03:38:31.987

我更喜欢这样的东西，它可以让你决定[`NumberStyle`](http://msdn.microsoft.com/en-us/library/system.globalization.numberstyles.aspx)要测试什么。

```
public static Boolean IsNumeric(String input, NumberStyles numberStyle) {
    Double temp;
    Boolean result = Double.TryParse(input, numberStyle, CultureInfo.CurrentCulture, out temp);
    return result;
} 
```

* * *

## 回答 #3

> 赞同：20
> 
> 时间：2009-01-13T12:47:46.090

除了前面的正确答案之外，可能值得指出的是，“非数字”（NaN）在其一般用法中**并不**等同于不能作为数值计算的字符串。NaN 通常被理解为一个数值，用于表示“不可能”计算的结果——结果未定义。在这方面，我会说 Javascript 的使用有点误导。在 C# 中，NaN 被定义为单数字类型和双精度数字类型的属性，用于显式引用零除以零的结果。其他语言使用它来表示不同的“不可能”值。

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2015-06-12T06:32:07.840

我知道这已经以许多不同的方式得到了回答，包括扩展和 lambda 示例，但将两者结合起来是最简单的解决方案。

```
public static bool IsNumeric(this String s)
{
    return s.All(Char.IsDigit);
} 
```

或者，如果您使用的是 Visual Studio 2015（C# 6.0 或更高版本），那么

```
public static bool IsNumeric(this String s) => s.All(Char.IsDigit); 
```

令人敬畏的 C#6 在一行上。当然这是有限的，因为它只测试数字字符。

要使用，只需有一个字符串并在其上调用方法，例如：

```
bool IsaNumber = "123456".IsNumeric(); 
```

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-01-13T03:37:15.483

是的，IsNumeric 是 VB。通常人们使用 TryParse() 方法，尽管它有点笨拙。正如您所建议的，您始终可以自己编写。

```
int i;
if (int.TryParse(string, out i))
{

} 
```

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2013-05-30T20:26:52.973

我喜欢扩展方法，但如果可能的话不喜欢抛出异常。我选择了一种扩展方法，在这里取 2 个答案中最好的。

```
 /// <summary>
    /// Extension method that works out if a string is numeric or not
    /// </summary>
    /// <param name="str">string that may be a number</param>
    /// <returns>true if numeric, false if not</returns>
    public static bool IsNumeric(this String str)
    {
        double myNum = 0;
        if (Double.TryParse(str, out myNum))
        {
            return true;
        }
        return false;
    } 
```

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2009-01-13T03:35:34.283

VB有这个`IsNumeric`功能。您可以参考`Microsoft.VisualBasic.dll`和使用它。

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2012-12-01T21:53:48.043

简单扩展：

```
public static bool IsNumeric(this String str)
{
    try
    {
        Double.Parse(str.ToString());
        return true;
    }
    catch {
    }
    return false;
} 
```

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2014-07-11T16:20:26.813

**您仍然可以在 C# 中使用 Visual Basic 函数。** 您唯一需要做的就是按照下面显示的说明进行操作：

1.  **通过右键单击您的项目并选择“添加引用”来添加**对 Visual Basic 库的引用：****

 **![在此处输入图像描述](https://i.stack.imgur.com/a17pe.png)

2.  然后将其**导入**您的类中，如下所示：

    使用 Microsoft.VisualBasic；

3.  接下来**在任何你想要的地方使用它**，如下所示：

    ```
     if (!Information.IsNumeric(softwareVersion))
            {
                throw new DataException(string.Format("[{0}] is an invalid App Version!  Only numeric values are supported at this time.", softwareVersion));
            } 
    ```

希望，这会有所帮助，祝你好运！

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2009-11-09T14:22:07.907

```
public static bool IsNumeric(string anyString)
{
    if (anyString == null)
    {
        anyString = "";
    }

    if (anyString.Length > 0)
    {
        double dummyOut = new double();
        System.Globalization.CultureInfo cultureInfo = new System.Globalization.CultureInfo("en-US", true);
        return Double.TryParse(anyString, System.Globalization.NumberStyles.Any, cultureInfo.NumberFormat, out dummyOut);
    }
    else
    {
        return false;
    }
} 
```

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2010-05-16T23:18:15.653

也许这是 C# 3 的功能，但您可以使用`double.NaN`.

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2010-11-24T16:23:15.020

实际上，`Double.NaN`所有 .NET 2.0 及更高版本都支持。

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2013-04-03T21:39:50.667

我使用 Chris Lively 的片段（选择的答案）封装在一个 bool 函数中，就像 Gishu 的建议一两年。在继续进行进一步处理之前，我使用它来确保某些查询字符串只是数字。我开始收到一些错误的查询字符串，标记的答案没有处理，特别是，每当在“3645”之类的数字之后传递逗号时（返回真）。这是生成的mod：

```
 static public bool IsNumeric(string s)
   {
      double myNum = 0;
      if (Double.TryParse(s, out myNum))
      {
         if (s.Contains(",")) return false;
         return true;
      }
      else
      {
         return false;
      }
   } 
```

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2018-03-07T22:10:50.670

我有一个稍微不同的版本，它返回数字。我猜想在大多数情况下，在测试字符串之后你会想要使用这个数字。

```
public bool IsNumeric(string numericString, out Double numericValue)
{
    if (Double.TryParse(numericString, out numericValue))
        return true;
    else
        return false;
} 
```

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2020-06-02T05:58:51.233

这是 Siir 先生提出的解决方案的修改版本。我发现添加扩展方法是调用方法中复用和简单的最佳解决方案。

```
public static bool IsNumeric(this String s)
{
    try { double.Parse(s); return true; }
    catch (Exception) { return false; }
} 
```

我修改了方法主体以适应 2 行并删除了不必要的 .ToString() 实现。对于那些不熟悉扩展方法的人，这里是如何实现的：

创建一个名为*ExtensionMethods*的类文件。粘贴此代码：

```
using System;
using System.Collections.Generic;
using System.Text;

namespace YourNameSpaceHere
{
    public static class ExtensionMethods
    {
        public static bool IsNumeric(this String s)
        {
            try { double.Parse(s); return true; }
            catch (Exception) { return false; }
        }
    }
} 
```

将*YourNameSpaceHere*替换为您的实际名称空间。保存更改。现在您可以在应用程序的任何位置使用扩展方法：

```
bool validInput = stringVariable.IsNumeric(); 
```

注意：对于整数和小数，此方法将返回 true，但如果字符串包含逗号，则返回 false。如果您想接受带有逗号或“$”之类的符号的输入，我建议您先实现一种方法来删除这些字符，然后测试是否为 IsNumeric。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2021-11-17T21:01:49.870

如果您不希望仅为 isNumeric 添加 Microsoft.VisualBasic 库的开销，这里是逆向工程的代码：

```
public bool IsNumeric(string s)
{
    if (s == null) return false;

    int state = 0; // state 0 = before number, state 1 = during number, state 2 = after number
    bool hasdigits = false;
    bool hasdollar = false;
    bool hasperiod = false;
    bool hasplusminus = false;
    bool hasparens = false;
    bool inparens = false;

    for (var i = 0; i <= s.Length - 1; i++)
    {
        switch (s[i])
        {
            case char n when (n >= '0' && n <= '9'):
                    if (state == 2) return false; // no more numbers at the end (i.e. "1 2" is not valid)

                    if (state == 0) state = 1; // begin number state
                    hasdigits = true;
                    break;

            case '-':
            case '+':
                    // a plus/minus is allowed almost anywhere, but only one, and you cannot combine it with parenthesis
                    if (hasplusminus || hasparens) return false;

                    if (state == 1) state = 2; // exit number state (i.e. "1-" is valid but 1-1 is not)
                    hasplusminus = true;
                    break;

            case ' ':
            case '\t':
            case '\r':
            case '\n':
                    // don't allow any spaces after parenthesis/plus/minus, unless there's a $
                    if (state == 0 && (hasparens || (hasplusminus && !hasdollar))) return false;
                    if (state == 1) state = 2; // exit number state
                    break;

            case ',':
                    // do not allow commas unless in the middle of the number, and not after a decimal
                    if (state != 1 || hasperiod) return false;
                    break;

            case '.':
                    // only allow one period in the number
                    if (hasperiod || state == 2) return false;

                    if (state == 0) state = 1; // begin number state
                    hasperiod = true;
                    break;

            case '$':
                    // dollar symbol allowed anywhere, but only one
                    if (hasdollar) return false;

                    if (state == 1) state = 2; // exit number state (i.e. "1$" is valid but "1$1" is not)
                    hasdollar = true;
                    break;

            case '(':
                    // only allow one parens at the beginning, and cannot combine with plus/minus
                    if (state != 0 || hasparens || hasplusminus) return false;
                    hasparens = true;
                    inparens = true;
                    break;

            case ')':
                    if (state == 1 && inparens) state = 2; // exit number state
                    if (state != 2 || !inparens) return false; // invalid end parens
                    inparens = false; // end parens mode
                    break;

            default:
                    // oh oh, we hit a bad character
                    return false;
        }
    }

    // must have at leats one digit, and cannot have imbalanced parenthesis
    if (!hasdigits || inparens) return false;

    // if we got all the way to here...
    return true;
} 
```

# jquery - jQuery 中的 Ajaxform

> ID：437895
> 
> 赞同：2
> 
> 时间：2009-01-13T03:40:14.883
> 
> 标签：jquery, ajax

我正在使用 ajaxForm。现在我遇到了一个问题。我的想法是当用户输入用户名时，如果有任何错误的用户名，它应该向用户报告一条消息。

我的代码工作正常，但问题是在向用户显示报告消息后，提交按钮变为非活动状态。因此，用户无法再次单击提交按钮。

我该如何解决这个问题？

```
$(document).ready(function(){
    $('#myForm').ajaxForm(function(data) {
        if (data==1){
            $('#bad').fadeIn("slow");
        }
    });
}); 
```

...

```
<body>
    <p id='bad' style="display:none;">Please enter a valid username</p>
</body> 
```

...

```
<form id="myForm" action=" " method="post">
    <center> <input type="submit" id="submitinput" value="Submit"/> </center>
</form> 
```

...

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-13T04:07:04.487

您可能想尝试在表单上捕获提交事件，然后使用 ajaxSubmit。像这样：

```
$('#myForm').submit(function() {
    $(this).ajaxSubmit(function (data) {
         if (data==1){
             $('#bad').fadeIn("slow");
         }
    });

    return false;
}); 
```

它可能会回避你遇到的任何有趣的事情。

# unit-testing - 什么是单元测试和集成测试，我应该了解哪些其他类型的测试？

> ID：437897
> 
> 赞同：43
> 
> 时间：2009-01-13T03:43:31.087
> 
> 标签：unit-testing, testing, integration-testing

我见过其他人在 Stack Overflow 上提到了几种类型的测试。

我能回忆起的是单元测试和集成测试。特别是单元测试被提到了很多。究竟什么是单​​元测试？什么是集成测试？我还应该注意哪些其他重要的测试技术？

编程不是我的职业，但我希望有一天能成为；关于生产等的东西也很受欢迎。

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2009-01-13T03:48:45.273

在我的头顶上：

*   **“测试应用程序的最小可隔离单元”意义上的单元测试**；这通常是一个方法或一个类，具体取决于规模。
*   **集成测试**
*   **功能测试**：这可能跨越单元，是 TDD 的重点。
*   **黑盒测试**：只测试公共接口，不知道它是如何工作的。
*   **玻璃盒测试**：在完全了解其工作原理的情况下测试事物的所有部分。
*   **回归测试**：为重现错误而构建的测试用例，以确保它们以后不会再次出现。
*   **毫无意义的测试**：以不止一种方式测试相同的基本案例，或者测试非常琐碎的事情以至于它们真的不需要测试（如自动生成的 getter 和 setter）

* * *

## 回答 #2

> 赞同：26
> 
> 时间：2009-01-13T04:10:39.143

> 我应该知道我的代码的任何其他重要测试吗？

根据软件生命周期的不同阶段，这些是一些不同类型的测试：

*   **单元测试**：这点代码有用吗？
*   **单元测试套件**：许多单元测试的序列（用于许多小代码）
*   **集成测试**：测试两个组件在组合（或“集成”）时是否一起工作
*   **系统测试**：测试**所有**组件在组合（或“集成”）时是否协同工作
*   **验收测试**：客户如何决定是否要向您付款（系统测试发现软件是否按设计工作......验收测试发现“按设计”是否是客户想要的）

还有更多：

*   可用性测试
*   性能测试
*   负载测试
*   压力测试

而且，更多……测试软件几乎与编写软件一样广泛。

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2009-01-13T03:49:28.843

[MSDN：单元测试](http://msdn.microsoft.com/en-us/library/aa292197(VS.71).aspx)

> 单元测试的主要目标是获取应用程序中最小的可测试软件，将其与代码的其余部分隔离，并确定它的行为是否完全符合您的预期。每个单元在集成到模块之前单独测试，以测试模块之间的接口。单元测试已经证明了它的价值，因为在它的使用过程中发现了很大比例的缺陷。

[MSDN：集成测试](http://msdn.microsoft.com/en-us/library/aa292128(VS.71).aspx)

> 集成测试是单元测试的逻辑扩展。最简单的形式是将两个已经测试过的单元组合成一个组件，并测试它们之间的接口。从这个意义上说，组件是指多个单元的集成集合。在现实场景中，许多单元被组合成组件，这些组件又被聚合成程序的更大部分。这个想法是测试各个部分的组合，并最终扩展该过程以与其他组的模块一起测试您的模块。最终，组成一个过程的所有模块都一起测试。除此之外，如果程序由多个进程组成，则应成对测试它们而不是同时测试所有进程。

检查网站以获取更多信息。除了 Microsoft 之外，还有大量信息来自其他来源。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2009-01-13T06:12:52.267

另一个重要的技术是**回归测试**。在这种技术中，您维护一套测试（称为回归套件），它们通常在每晚以及每次签入之前运行。每次修复错误时，您都会向套件添加一个或多个测试。目的是阻止您重新引入已经修复的旧错误。（这个问题出奇的普遍！）

在你的项目变大之前尽早开始积累你的回归套件，否则你会后悔的。我肯定有！

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2014-02-26T04:10:28.107

根据您在软件开发生命周期中所处的阶段，有不同级别的测试。最高层是需求分析，最低层是解决方案的实施。

**什么是单元测试？**

*   单元测试评估软件的实现。
*   我们专注于测试程序的单元（即单个方法），而忽略谁调用/使用这些单元。因此，我们基本上将每个单元视为一个独立单元。
*   有很多单元测试工具，其中最流行的一种是 JUnit。

*   在执行单元测试时，我们希望构建一个满足特定覆盖标准的测试集（一组测试用例）。这可能是一些结构覆盖标准（NC、EC、PPC 等）或数据流标准（ADC、AUC、ADUPC 等）

*   请注意，单元测试是最低级别的测试，因为它评估实现后生成的实际代码单元。这种类型的测试在集成测试之前完成。
*   高效的单元测试有助于确保集成测试不会很痛苦，因为在进行单元测试时发现和修复错误更便宜、更容易

**什么是集成测试？**

*   需要进行集成测试以确保我们的软件在两个或多个组件组合时仍然可以工作。
*   您可以在系统完成之前执行集成测试。
*   类集成测试顺序 (CITO) 问题与集成测试相关。CITO 与集成组件的策略有关。CITO 有许多建议的解决方案，例如自顶向下集成、自底向上集成等。主要目标是以一种能够实现高效测试和最少存根的方式集成组件，因为编写代码存根并不总是那么容易并且需要时间. 请注意，这仍然是一个活跃的研究领域！
*   集成测试在单元测试之后进行。
*   通常情况下，各个组件都可以正常工作，但是当所有组件放在一起时，我们会突然看到由于接口不兼容/问题而出现的错误。

**其他级别的测试包括：**

1.  回归测试

    *   这种类型的测试非常重要，因为开发人员通常会经常对软件进行更改，因此我们希望确保这些更改不会引入错误。
    *   有效回归测试的关键是限制回归测试的大小，以便完成测试不会花费太长时间，否则测试集将不会在下一次提交之前完成运行。我们还必须选择不会遗漏错误的有效测试用例。
    *   这种类型的测试应该是自动化的。
    *   重要的是要注意，我们总是可以继续添加更多机器以抵消越来越多的回归测试，但在某些时候这种权衡是不值得的。
2.  验收测试

    *   通过这个测试，我们根据所提供的要求评估软件，基本上我们看看我们生产的软件是否满足我们给出的要求。
    *   这通常是软件开发活动序列中完成的最后一种测试。因此，这种类型的测试是在单元测试和集成测试之后完成的。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-01-13T03:49:47.983

单元测试只是编写（希望）小代码块来测试应用程序的独立部分的想法。

例如，您可能有一个计算器应用程序，您需要确保加法功能有效。为此，您编写一个单独的应用程序，直接调用加法函数。然后您的测试函数将评估结果以查看它是否符合您的预期。

它基本上是使用已知输入调用您的函数并验证输出是否完全符合您的预期。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-01-13T06:13:31.563

谷歌上“测试类型”的前两个搜索结果看起来很全面

*   [www.aptest.com/testtypes.html](http://www.aptest.com/testtypes.html)
*   [www.softwaretestinghelp.com/types-of-software-testing/](http://www.softwaretestinghelp.com/types-of-software-testing/)

我认为最相关的那些。[见这里](https://stackoverflow.com/questions/362157/who-should-do-the-testing-of-software-its-the-developerwho-wrote-it-or-the-tes#362283)。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-01-13T06:33:37.827

这是我写的一个条目：[不同类型的自动化测试](http://itscommonsensestupid.blogspot.com/2008/11/different-types-of-automated-tests.html)。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2013-12-13T10:50:06.630

**单元测试**：对一个单元或一个最小的软件进行的测试。完成以验证它是否满足其功能规范或预期的设计结构。

**集成测试：**一起测试相关模块的组合功能。

**回归测试：**测试应用程序以验证修改没有造成意外影响。

**冒烟测试**：冒烟测试验证构建是否可测试。

# sql - 使用 SQL 转置表

> ID：437899
> 
> 赞同：1
> 
> 时间：2009-01-13T03:47:47.910
> 
> 标签：sql, sql-server, tsql

我有一个这样的 SQL 表

```
光伏区伙伴党

851 M010 名称1

561 M011 名字2

第869章
...

```

而且我需要使用 T-SQL（不是报告服务或其他任何东西）来转贴它，使它看起来像这样：

```
对方 M010 M011 M012 ....

姓名1 851

姓名2 561

姓名2 869

```

问题是我不知道我将拥有多少个区号，所以实际上可能有任意数量的列。

任何想法我怎么能做到这一点？谢谢一百万

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-13T03:55:08.800

你将不得不做一个动态交叉表，检查这些文章：

*   [SQLServer：动态交叉表](http://www.databasejournal.com/features/mssql/article.php/3657506/SQLServer-Dynamic-Cross-Tab.htm)
*   [动态交叉表/数据透视表](http://www.sqlteam.com/article/dynamic-cross-tabs-pivot-tables)
*   [交叉表数据透视表工作台](http://www.simple-talk.com/sql/t-sql-programming/crosstab-pivot-table-workbench/)
*   [SQL 动态交叉表存储过程](http://weblogs.sqlteam.com/jeffs/articles/5120.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-09-16T07:28:37.377

如果您使用 SQL Server 2005 或最新版本，请使用数据透视函数

```
SELECT 
    CouterParty ,
    [M010] ,
    [M011],
    [M012]
FROM    ( SELECT    
            PV ,Area    ,CouterParty
          FROM      TablesName AS T
        ) AS T1Temp PIVOT ( Sum(PV) FOR T1Temp.CouterParty IN ( [M010],
                                                          [M011],
                                                          [M012] ) )  As PivotTable 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-13T03:54:26.057

您可以通过游标循环和临时表来执行此操作。

选择所有区号，为每个提取的行运行游标，根据需要将行插入临时表中关闭游标从临时表中选择

# asp.net - 如何在另一个 dll 中将 asp.net 动态数据与实体框架一起使用

> ID：437908
> 
> 赞同：3
> 
> 时间：2009-01-13T03:53:42.953
> 
> 标签：asp.net, entity-framework, .net-3.5

我如何在另一个 dll 中使用 EF 使用 asp.net 动态数据，我不想将连接字符串放在 web.config 或任何配置文件中。我在 Global.asax 中有这段代码

model.RegisterContext(() => new MyObjectContext("entityconnectionString"), new ContextConfiguration() { ScaffoldAllTables = true });

默认页面没问题，但是当我单击任何表查看详细信息时，我收到此错误：在配置中找不到指定的命名连接，不打算与 EntityClient 提供程序一起使用，或者无效。我怎么解决这个问题？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2011-02-10T00:42:08.630

我能够通过强制加载 MetadataWorkspace 并使用 RegisterContext() 的重载来解决此问题。

```
var context = new MyEntities();   // DataContext
context.MetadataWorkspace.LoadFromAssembly(typeof(MyEntity).Assembly); //  An EF Entity 
var config = new ContextConfiguration() {ScaffoldAllTables = true};
DefaultModel.RegisterContext(() => context, config); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-06-07T17:32:27.527

我有同样的问题。我在一个名为 NW.DataModel 的项目中有我的 EDMX 数据模型文件。我为 POCO 对象添加了代码生成项，然后我将其转移到一个名为 NW.Entities 的单独项目中，以便它们可以不了解持久性。我必须调整 Context 对象中命名空间生成的一些属性设置，以便 Context 在构建解决方案时识别实体。这一切都很好，我可以在控制台应用程序和 WCFdata 服务中使用这些项目。现在我想为一些基本管理员添加一个动态数据站点，这就是单独的程序集不再一起玩的时候。我只是在用 Northwind 数据库测试项目设置。

我收到此错误：找不到“NWEntities.Shipper”的 CLR 类型。

这篇博文似乎有一些想法，并链接到该问题最近有一些活动的论坛，但微软还没有消息。

[http://thedatafarm.com/blog/data-access/wcf-data-services-and-ef-pocos-that-are-in-their-own-assembly/](http://thedatafarm.com/blog/data-access/wcf-data-services-and-ef-pocos-that-are-in-their-own-assembly/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-04T14:47:02.790

杰夫的回答对我来说几乎是可行的，但我时不时地收到`ObjectDisposed`异常。

我已经更改了上下文工厂以创建一个新的上下文，这似乎有效：

```
var config = new ContextConfiguration() { ScaffoldAllTables = true };
DefaultModel.RegisterContext(() => 
    {   
        var context = new MyEntities();   // ObjectContext 
        context.MetadataWorkspace.LoadFromAssembly(typeof(AnyPOCOInOtherAssembly).Assembly);
        return context;
    }, 
config); 
```

# cakephp - 如何为 CakePHP 的 AuthComponent 使用“用户”以外的表？

> ID：437911
> 
> 赞同：8
> 
> 时间：2009-01-13T03:54:31.297
> 
> 标签：cakephp, authentication, login, cakephp-1.3

CakePHP 的*[AuthComponent](http://api.cakephp.org/class/auth-component)*假设您有一个包含用户名和密码的 Users 表。我想找到一种方法来覆盖从用户到帐户的默认表名。

***背景资料：***

我设计数据库的方式是有一个用户表和一个帐户表。

**账户**：

*   ID

*   用户身份

*   用户名

*   密码

*   身份验证服务（例如，我的站点、Facebook、Google、[OpenID](http://en.wikipedia.org/wiki/OpenID)等）

**用户**：

*   简单地拥有用户的所有个人信息（年龄、性别等）

这样做的原因是

1.  每个用户可以有多个可以登录的帐户，因此他们不会被锁定在一个帐户中
2.  我可以将第三方服务连接到一个帐户以获得更棒的体验

现在回到问题....

CakePHP 有关于更改默认字段名称的文档，但我找不到有关更改默认表名称的任何内容，但假设它本质上是相似的......

更改默认字段名称的示例：

```
function beforeFilter() {
    $this->Auth->fields = array(
            'username' => 'username',
            'password' => 'secretword'
        );
 } 
```

**有没有办法做到这一点，或者我应该按照 CakePHP 约定重新构建表格并仍然完成同样的事情？**

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-01-13T04:43:55.833

在 app_controller.php 中：

```
function beforeFilter() {
    $this->Auth->userModel = 'Account';
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-04-27T03:38:58.860

下面的代码在我的情况下很有帮助，因为在电子邮件字段中接受用户名，您还可以在选项中定义密码哈希。

```
$this->Auth->authenticate = array(
    'Basic' => array('userModel' => 'Account'),
    'Form' => array(
       'fields' => array('username' => 'email'),
       'userModel' => 'Account'
       )
 ); 
```

# c# - 过滤文件名：得到*.abc 不带*.abcd，或*.abcde，等等

> ID：437914
> 
> 赞同：8
> 
> 时间：2009-01-13T03:55:43.947
> 
> 标签：c#, wildcard

Directory.GetFiles(LocalFilePath, searchPattern);

MSDN 注释：

> 在 searchPattern 中使用星号通配符时，例如“*.txt”，当扩展名正好是三个字符时的匹配行为与扩展名长度大于或小于三个字符时不同。文件扩展名正好是三个字符的 searchPattern 返回具有三个或更多字符扩展名的文件, 其中前三个字符与 searchPattern 中指定的文件扩展名匹配。文件扩展名为一个、两个或三个以上字符的 searchPattern 仅返回扩展名与 searchPattern 中指定的文件扩展名完全匹配的文件。当使用问号通配符时，该方法只返回与指定文件扩展名匹配的文件。例如，给定目录中的两个文件，“file1.txt”和“file1.txtother”，搜索模式为“file? 。文本”只返回第一个文件，而搜索模式“文件*.txt" 返回两个文件。

以下列表显示了 searchPattern 参数的不同长度的行为：

*   `*.abc`返回具有`.abc`, `.abcd`, `.abcde`, `.abcdef`, 等扩展名的文件。

*   `*.abcd`仅返回扩展名为`.abcd`.

*   `*.abcde`仅返回扩展名为`.abcde`.

*   `*.abcdef`仅返回扩展名为`.abcdef`.

将`searchPattern`参数设置为`*.abc`，如何返回扩展名为`.abc`、 not`.abcd`等的文件`.abcde`？

也许这个功能会起作用：

```
 private bool StriktMatch(string fileExtension, string searchPattern)
    {
        bool isStriktMatch = false;

        string extension = searchPattern.Substring(searchPattern.LastIndexOf('.'));

        if (String.IsNullOrEmpty(extension))
        {
            isStriktMatch = true;
        }
        else if (extension.IndexOfAny(new char[] { '*', '?' }) != -1)
        {
            isStriktMatch = true;
        }
        else if (String.Compare(fileExtension, extension, true) == 0)
        {
            isStriktMatch = true;
        }
        else
        {
            isStriktMatch = false;
        }

        return isStriktMatch;
    } 
```

测试程序：

```
class Program
{
    static void Main(string[] args)
    {
        string[] fileNames = Directory.GetFiles("C:\\document", "*.abc");

        ArrayList al = new ArrayList();

        for (int i = 0; i < fileNames.Length; i++)
        {
            FileInfo file = new FileInfo(fileNames[i]);
            if (StriktMatch(file.Extension, "*.abc"))
            {
                al.Add(fileNames[i]);
            }
        }

        fileNames = (String[])al.ToArray(typeof(String));

        foreach (string s in fileNames)
        {
            Console.WriteLine(s);
        }

        Console.Read();
    } 
```

还有其他更好的解决方案吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-01-13T04:08:08.010

答案是您*必须*进行后过滤。单独的 GetFiles*无法*做到这一点。这是一个将发布处理您的结果的示例。有了这个，您可以将搜索模式与 GetFiles 一起使用，也可以不使用 - 无论哪种方式都可以。

```
List<string> fileNames = new List<string>();
// populate all filenames here with a Directory.GetFiles or whatever

string srcDir = "from"; // set this
string destDir = "to"; // set this too

// this filters the names in the list to just those that end with ".doc"
foreach (var f in fileNames.All(f => f.ToLower().EndsWith(".doc")))
{
    try
    {
        File.Copy(Path.Combine(srcDir, f), Path.Combine(destDir, f));
    }
    catch { ... }
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-13T04:05:00.327

不是错误，反常但有据可查的行为。*.doc 基于 8.3 后备查找匹配 *.docx。

您将不得不手动对结果进行后过滤，以便以 doc 结尾。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-13T11:12:02.383

因为对于“*.abc”，GetFiles 将返回 3 个或更多的扩展名，任何在“.”之后长度为 3 的内容都会返回。是完全匹配的，任何更长的都不是。

```
string[] fileList = Directory.GetFiles(path, "*.abc");

foreach (string file in fileList)
{
   FileInfo fInfo = new FileInfo(file);

   if (fInfo.Extension.Length == 4) // "." is counted in the length
   {
      // exact extension match - process the file...
   }
} 
```

不确定上述性能 - 虽然它使用简单的长度比较而不是字符串操作，但每次循环都会调用 new FileInfo() 。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-13T10:08:11.590

这在短期内无济于事，但在 MS Connect 帖子上对此问题进行投票可能会在未来改变事情。

[http://connect.microsoft.com/VisualStudio/feedback/ViewFeedback.aspx?FeedbackID=95415](http://connect.microsoft.com/VisualStudio/feedback/ViewFeedback.aspx?FeedbackID=95415)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-13T07:06:07.340

使用 linq....

```
 string strSomePath = "c:\\SomeFolder";
string strSomePattern = "*.abc";
string[] filez = Directory.GetFiles(strSomePath, strSomePattern);

var filtrd = from f in filez
         where f.EndsWith( strSomePattern )
         select f;

foreach (string strSomeFileName in filtrd)
{
    Console.WriteLine( strSomeFileName );
} 
```

# mysql - 索引总和列

> ID：437915
> 
> 赞同：23
> 
> 时间：2009-01-13T03:56:14.227
> 
> 标签：mysql, sql, sql-server, indexing, sum

为正在求和的列创建索引是否比没有索引快？

* * *

## 回答 #1

> 赞同：45
> 
> 时间：2009-01-13T04:03:35.833

对不起，不清楚你在问什么。

你在问，它会加快查询，如

```
SELECT product, sum(quantity) FROM receipts 
GROUP BY product 
```

如果您添加了数量索引？

如果这是问题，那么答案是否定的。一般来说，当您需要在众多行中查找几行时，索引会很有帮助；在这里您需要所有行，因此索引无济于事。

有一个晦涩的异常（很少适用，大多数数据库优化器可能不会费心实现这个技巧）。如果您的查询恰好是

```
SELECT sum(foo) FROM bar 
```

，其中 foo 上有一个索引，而 bar 是一个包含许多列的表，则可以读取完整索引，与读取基础表相比，会产生较小的命中，并直接从索引中获得答案——根本不必碰“真实”的桌子！然而，这是一种相当罕见的情况，您需要测试您的优化器是否知道这样做，然后再过分依赖它。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-01-13T03:59:34.127

不会。索引通过限制需要的检查次数来改进搜索。无论如何，聚合函数（count、max、min、sum、avg）必须遍历列中的所有条目。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-01-13T04:15:57.260

如果你想让求和更快，你可以预先实现结果。在 Oracle 上，使用[Materialized Views](http://en.wikipedia.org/wiki/Materialized_view)，在 MS SQL 上使用[Indexed Views](http://www.microsoft.com/technet/prodtechnol/sql/2005/impprfiv.mspx)。

关于您的具体问题“是否为正在求和的列创建索引比没有索引快？”，答案是否定的。

您的问题的答案在于斯宾塞的回答：

“无论如何，聚合函数（count、max、min、sum、avg）必须遍历列中的所有条目。”

刚刚澄清了斯宾塞回答中列的上下文。尽管如此，他的回答是正确的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-13T07:42:04.473

如果索引覆盖，通常会更快。快多少取决于表中列数与索引中列数之间的差异。此外，如果有任何过滤条件，它可能会更快。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-19T22:14:02.097

我发现在使用此查询时在 where(productid here) 中对列进行索引会有所帮助：

从收据中选择 productid, sum(quantity) WHERE productid = 1 GROUP BY productid

添加索引后，我的一个查询从 45 秒变为几乎即时。

# c# - 强制从派生类外部调用基方法

> ID：437926
> 
> 赞同：5
> 
> 时间：2009-01-13T04:05:24.303
> 
> 标签：c#, inheritance, overriding

我有两节课：

```
public class MyBase
{
    public virtual void DoMe()
    {

    }
}

public class MyDerived:MyBase
{
    public override void DoMe()
    {
        throw  new NotImplementedException();
    }
} 
```

我有以下代码来实例化 MyDerived：

```
 MyDerived myDerived=new MyDerived(); 
```

问题是如何调用基类的 DoMe？如果我使用 myDerived.DoMe()，那么将调用派生方法，从而导致异常。我尝试将 myDerived 强制转换为 MyBase，但它仍然是被调用的方法的派生版本。

***编辑：如以下评论中所述，我无法更改 eitehr MyDerived 或 MyBase 因为它们不是我的代码。***

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-11-17T00:22:54.657

有一个解决方案，但很丑：使用反射来获取基类方法，然后发出调用它所需的 IL。查看[这篇博文](http://kennethxu.blogspot.com/2009/05/strong-typed-high-performance.html)，它说明了如何做到这一点。当我所拥有的只是对覆盖该方法的派生类的引用时，我已经成功地使用这种方法来调用基类的方法实现。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-13T05:03:18.633

您不能调用基类版本。

如果该方法在派生类上不起作用，那么该方法的基本版本在派生类的实例上调用时就不太可能起作用。那只是自找麻烦。该课程并非旨在以这种方式工作，您尝试做的事情可能只会导致该课程的其他部分行为不可预测。

当对象直接告诉您它不起作用时，为什么您需要在对象上调用此方法？

在我看来，这些类有一些设计缺陷，如果不允许您更改类，也许您可​​以改为更改为设计更好的库。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-13T04:08:09.693

```
public class MyDerived:MyBase{    
    public override void DoMe()    
    {        
        base.DoMe();
    }
} 
```

**编辑：**

如果不通过子类方法，则无法从“外部”访问基类方法。您唯一的选择是直接实例化您的基类并调用它的方法。

```
MyBase mb = new MyBase();
mb.DoMe(); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-13T04:08:10.553

要从外部类调用 MyBase.DoMe()，您需要 MyBase 的实例或不覆盖 DoMe() 的派生实例。声明为虚拟的方法将在对象的实际运行时类型上调用，而不是对象的类型，这就是为什么转换为 MyBase 不会改变调用的方法的原因。但是，如果该方法未在 MyBase 中声明为 virtual 并且 MyDerived 仍然实现 DoMe() ，它将“隐藏” MyBase 的实现。因此，如果引用是 MyDerived，它将调用 MyDerived.DoMe()，但在这种情况下，转换为 MyBase myBase = (MyBase)myDerived，然后调用 myBase.DoMe() 将调用 MyBase.DoMe()。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-13T05:54:23.023

派生类不需要提供方法的实现。删除它，默认情况下会调用基类中的实现。

如果与您的示例不同，基类中的方法是抽象的，并且您必须提供一个实现，但派生类提供一个实现是没有意义的，那么类的设计可能有问题。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-16T15:36:33.013

鉴于您的限制，存在另一种可能性：

下载 .Net 反射器。反编译现有代码，然后进行您需要的任何更改以支持您的情况。

当然，在继续之前，请检查其合法性。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2015-11-13T22:32:25.417

这个问题太老了，但我没有看到以下选项：

您可以使用“新”关键字来指定重叠方法。然后，您只需将其转换为您希望调用其方法的类。

```
 public class MyBase
    {
        public virtual void DoMe()
        {

        }
    }

    public class MyDerived:MyBase
    {
//note the use of 'new' and not 'override'
        public new void DoMe()
        {
            throw  new NotImplementedException();
        }
    } 
```

**执行**

```
var myDerived = new MyDerived();
var derivedDoMe = myDerived.DoMe();
var baseDoMe = ((MyBase)myDerived).DoMe(); 
```

# php - 如何在 PHP 中执行此 ASP WebDAV FBA 身份验证示例？

> ID：437927
> 
> 赞同：1
> 
> 时间：2009-01-13T04:05:38.747
> 
> 标签：php, exchange-server, webdav

我需要让 PHP 对 Exchange 服务器进行身份验证。一旦能够成功连接到它，我需要在 PHP 中编写 webdav 请求，这样我就可以从交换服务器中提取数据并在 Web 应用程序中使用它。

除了 2003 Exchange 服务器启用了基于表单的身份验证 (FBA) 之外，这会有些简单。启用 FBA 后，我相信我应该按照以下（请参阅链接）博客文章所说的去做。我的问题是我需要帮助将他的 ASP 指令转换为 PHP。

[http://blogs.msdn.com/webdav_101/archive/2008/12/12/webdav-fba-authentication-sample-explained.aspx](http://blogs.msdn.com/webdav_101/archive/2008/12/12/webdav-fba-authentication-sample-explained.aspx)

有人了解他在这篇文章中描述的细节吗？任何见解都会有所帮助。

如果需要，更具体的信息：我对如何配置 POST 请求感到困惑（我的意思是，当您通常将数据发布到表单时，您通常不加载您发布到的页面吗？在他的指示中，他对 POST 说它到 /exchweb/bin/auth/owaauth.dll 。这是如何工作的？）

我也对如何执行列出的第三步感到困惑：3) WebReq.KeepAlive 和 AllowAutoRedirect 应在请求上设置为 True。

最重要的是，我真的可以使用一些帮助来详细说明如何获取发布数据并将其放入 PHP 中的 cookie 中。

提前感谢您提供的任何帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-13T20:22:37.637

我相信最好的方法是通过 curl。( [http://ca.php.net/curl](http://ca.php.net/curl) )

在链接的页面上，第一个示例是一个很好的类（我用它来自动登录到其他网站）

默认情况下，它应该有 KeepAlive (header) 和 Redirect ( `curl_setopt($process, CURLOPT_FOLLOWLOCATION, 1);`)

您需要确保网络服务可以创建/修改 cookie.txt 然后尝试：

```
$cc = new cURL();
$cc->post('http://www.yourexchange.com','destination=https%3A%2F%2F' . $strServerName . '%2Fexchange%2F' . $strUserName . '%2F&username=' . $strDomain . '%5C' . $strUserName . '&password=' . $strPassword . '&SubmitCreds=Log+On&forcedownlevel=0&trusted=0'); 
```

以上是您链接到的页面上信息的快速翻译，如果有特殊字符，您可能需要在变量上使用 urlencode()。一旦上述成功工作，您就可以使用

```
$page=$cc->get('http://www.yourexchange.com/?whatever=youneed'); 
```

$page 将包含来自 get 的字符串结果（它在此请求上发送存储在文本文件中的 cookie）然后您可以使用正则表达式来获取您需要的内容。

这应该让你非常接近你需要的东西。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-14T02:00:23.290

看起来文本文件实际上名为“cookies.txt”。您可以使用此名称创建一个空白文本文件并将其上传到同一目录。在您的 ftp 客户端中，您应该能够设置权限，我相信 777 是您需要的权限代码。如果您不能只输入权限代码，请尝试选中所有框以授予所有权限。

回复：最后一个帖子，

没错，脚本运行的地方基本上是一个客户端，而 cookie 文件是一种存储 cookie 以便于重用的简单方法。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-05T22:58:08.780

链，

是的，这是指与`cookies.txt`您的代码文件位于同一文件夹中的名为（注意：带有“s”的“cookies”）的文件`curlclass.php`。

cURL 使用它来存储和发送后续请求的 cookie。您假设运行 PHP 脚本的 Web 服务器充当客户端是正确的；基本上，它通过模拟 POST 到登录表单来登录到 Exchange 服务器，然后保存 cookie 并将其与每个请求一起发送，就像浏览器一样。

创建文件`cookies.txt`并设置权限，以便运行 Apache 实例的用户可以写入文件。

# directx - Windows XP SP3 上的 DirectX 版本

> ID：437928
> 
> 赞同：1
> 
> 时间：2009-01-13T04:06:09.230
> 
> 标签：directx, windows-xp-sp3

Windows XP SP3 默认安装的 DirectX 版本是什么？谷歌在这方面没有产生令人信服的结果。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-26T15:18:04.340

我在 MSDN 中找到了一个[有用的页面](http://msdn.microsoft.com/en-gb/library/bb173024(VS.85).aspx)，它确认了每个 Windows 操作系统和 Service Pack 版本中包含的 DirectX 版本。似乎 XP 的最后一次更改是在 SP2 中 - 正如 Raghu 所说，这确实是 DirectX 9.0c。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-13T04:09:36.087

我猜是9.0c。

您可以通过运行命令 dxdiag 进行检查

# php - 如何测量项目中的代码行数？

> ID：437931
> 
> 赞同：8
> 
> 时间：2009-01-13T04:07:51.473
> 
> 标签：php, metrics, line-count

如何测量我的 PHP Web 开发项目中的代码行数？

编辑：我只对 Windows 工具感兴趣

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2009-01-13T04:09:51.783

检查[CLOC](http://cloc.sourceforge.net/)，它是一个支持多种语言的源代码行计数器，我总是推荐它。

它将区分实际的代码行、空白行或注释，非常好。

此外，您还可以检查更多代码计数器：

*   [SLOCCount](http://www.dwheeler.com/sloccount/)
*   [slc](http://www.dwheeler.com/sloccount/)
*   南加州大学的[CODECOUNT](http://sunset.usc.edu/research/CODECOUNT/)
*   [位置](http://freshmeat.net/projects/loc/)
*   [奥伯爵](http://labs.ohloh.net/ohcount)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-09T07:42:19.233

[phploc](https://github.com/sebastianbergmann/phploc)

如果它在 Windows 上运行没有经验，但是在网络上搜索显示人们让它在 Windows 上运行的一些结果。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-13T04:10:01.580

如果您在 linux 机器上，最简单的方法可能是由这个 SO 问题指导：

[计算 bash 中的（非空白）代码行数](https://stackoverflow.com/questions/114814/count-non-blank-lines-of-code-in-bash)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-08-24T22:02:42.950

我们的[SD 源代码搜索引擎](http://www.semanticdesigns.com/Products/SearchEngine)是一个 GUI，用于搜索大量源代码，例如 PHP 网站。它很快，因为它预先索引了源代码。

作为索引过程的副作用，它还计算源代码库上的指标，包括 SLOC、注释、空行、循环和 Halsted 复杂度数。

它在 Windows 上运行。

* * *

## 回答 #5

> 赞同：-3
> 
> 时间：2009-01-13T04:09:51.283

如果您使用的是完整的 IDE，快速而肮脏的方法是使用搜索功能计算“\n”模式的数量（假设它支持正则表达式）

# php - 从 zip 档案中创建和提取文件

> ID：437952
> 
> 赞同：2
> 
> 时间：2009-01-13T04:24:27.760
> 
> 标签：php, zip, archive

是否有用于在 php 中创建/提取 zip 文件的库？

ZipArchive 类工作不规律，这在 php.net 上有所提及：（对于我检查的每个函数）

ZipArchive::addEmptyDir（没有可用的版本信息，可能仅在 CVS 中）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-13T06:27:08.463

检查 PEAR Archive_Zip 它可能会帮助你[http://pear.php.net/package/Archive_Zip/docs/latest/Archive_Zip/Archive_Zip.html](http://pear.php.net/package/Archive_Zip/docs/latest/Archive_Zip/Archive_Zip.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-13T20:20:08.283

PHP 通过 GZip 提供本机 Zip 支持（默认情况下可能未启用）： http:
[//php.net/zlib](http://php.net/zlib)

你也可以使用这个类（Drupal 不是这个实现的一部分）：
[http ://drupal.org/node/83253](http://drupal.org/node/83253)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-13T20:31:14.860

[包含 ZipArchive](http://us2.php.net/manual/en/book.zip.php)的同一模块还包含许多允许程序访问 zip 文件的功能。此功能在 PHP 4（自 4.0.7 起）和 PHP 5（自 5.2.0 起）中可用。

```
$zip = zip_open("foo.zip");
$files = [];

while ($entry = zip_read($zip)) {
    zip_entry_open($zip, $entry);
    $files[zip_entry_name($entry)] = zip_entry_read($entry, zip_entry_filesize($entry));
    zip_entry_close($entry);
}

zip_close($zip); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-16T11:55:35.033

好的，我检查了 Irmantas 发布的[http://pear.php.net/package/Archive_Zip](http://pear.php.net/package/Archive_Zip)
， 但它说：
“这个包不再维护，已被取代。包已移至频道 pecl.php.net，包邮编。” 然后我搜索 pear.php.net 并偶然发现：http: [//pear.php.net/package/File_Archive](http://pear.php.net/package/File_Archive)

File_Archive 虽然没有一套非常直观的方法。但我想要制作 tar 文件和从 tar 文件中提取文件的简单功能。

以下片段实现了这一点：从 tar 文件中提取文件->

```
<?php
require_once "File/Archive.php";
$tmp = 'output';
$t1 = 'check.tar';
File_Archive::setOption('tmpDirectory','tmp');
$r = File_Archive::extract(
    File_Archive::read($t1.'/'),
    File_Archive::toFiles($tmp)
);
?> 
```

将文件添加到 tar 文件 ->

```
<?php
require_once "Archive.php";
$dir = "../../mysql/data/blackStone/";
$files[0] = "";
$i = 0;
          if ($dh = opendir($dir)) {
              while (($file = readdir($dh)) !== false ) {
              if( $file != "." && $file != ".." )
                $files[$i++] = $dir.$file;
          }
      }

File_Archive::extract(
    $files,
    File_Archive::toArchive(
        'check.tar',
        File_Archive::toOutput()
    )
);

?> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-10T06:31:29.267

您可以从 PHP 调出到 .NET 程序集中。如果您不介意，那么您可以使用 DotNetZip - 它可靠且完全稳定。

[CodePlex 上的 DotNetZip](http://www.codeplex.com/DotNetZip)

示例代码：

```
<?php
try
{
  $fname = "zip-generated-from-php-" . date('Y-m-d-His') . ".zip";
  $zipOutput = "c:\\temp\\" . $fname;
  # Use COM interop to get to Ionic Zip. (Windows only)
  $zip = new COM("Ionic.Zip.ZipFile");
  $zip->Name = $zipOutput;
  $dirToZip= "c:\\temp\\psh";
  # Encryption:  3=AES256, 2=AES128, 1=PKZIP, 0=None.
  $zip->Encryption = 3;
  $zip->Password = "AES-Encryption-Is-Secure";
  $zip->AddDirectory($dirToZip);
  $zip->Save();
  $zip->Dispose();

  if (file_exists($zipOutput))
  {
    header('Cache-Control: no-cache, must-revalidate');
    header('Content-Type: application/x-zip'); 
    header('Content-Disposition: attachment; filename=' . $fname);
    header('Content-Length: ' . filesize($zipOutput));
    readfile($zipOutput);
    unlink($zipOutput);
  }
  else 
  {
    echo '<html>';
    echo '  <head>';
    echo '  <title>Calling DotNetZip from PHP through COM</title>';
    echo '  <link rel="stylesheet" href="basic.css"/>';
    echo '  </head>';
    echo '<body>';
    echo '<h2>Whoops!</h2>' . "<br/>\n";
    echo '<p>The file was not successfully generated.</p>';
    echo '</body>';
    echo '</html>';
  } 
}
catch (Exception $e) 
{
    echo '<html>';
    echo '  <head>';
    echo '  <title>Calling DotNetZip from PHP through COM</title>';
    echo '  <link rel="stylesheet" href="basic.css"/>';
    echo '  </head>';
    echo '<body>';
    echo '<h2>Whoops!</h2>' . "<br/>\n";
    echo '<p>The file was not successfully generated.</p>';
    echo '<p>Caught exception: ',  $e->getMessage(), '</p>', "\n";
    echo '<pre>';
    echo $e->getTraceAsString(), "\n";
    echo '</pre>';
    echo '</body>';
    echo '</html>';
}

?> 
```

# asp.net-mvc - 提交同名的表单元素

> ID：437955
> 
> 赞同：10
> 
> 时间：2009-01-13T04:29:30.493
> 
> 标签：asp.net-mvc

我有一个表单，它允许用户使用 JQuery（使用 .clone）创建额外的“行”，以便他们可以决定需要提交多少相同的信息。我的问题是我无法弄清楚如何在我的控制器中访问这些表单项。

正在提交的表单可能如下所示

```
<input type="text" name="Amount" id="Amount">
   <select name="Item">
       <option value="1">Item 1"</option>
       <option value="2">Item 2"</option>
       <option value="3">Item 3"</option>
   </select>
<input type="text" name="Amount" id="Amount">
   <select name="Item">
       <option value="1">Item 1"</option>
       <option value="2">Item 2"</option>
       <option value="3">Item 3"</option>
   </select>
<input type="text" name="Amount" id="Amount">
   <select name="Item">
       <option value="1">Item 1"</option>
       <option value="2">Item 2"</option>
       <option value="3">Item 3"</option>
   </select> 
```

基本上，`input`选择和选择之间的块可以重复无数次。当我提交给控制器时，我将使用`FormCollection form`它来访问表单元素。从那里我不确定如何访问已提交的项目。我曾想过使用 for 循环，然后通过类似 form["Amount"][i] 的方式访问它们，但显然这行不通。

我是否以正确的方式进行此操作，如果是这样，是否有人对这可能如何工作有任何建议？

提前致谢。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-06-28T10:51:18.517

老问题，但仍然......您可以通过调用`Request.Form.GetValues`, 或`Request.QueryString.GetValues`. 例如：

```
string[] amounts = Request.Form.GetValues("Amount"); 
```

并且该`amounts`数组将包含正确的值，因此您可以发布包含逗号、点等的值，而不必担心拆分/解析它。

当然，如果您正在运行 MVC，请使用 modelbinder 来执行此操作。但是，如果您使用网络表单、通用处理程序等，则可以使用它...

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-01-13T11:15:37.413

查看[模型绑定到列表](http://haacked.com/archive/2008/10/23/model-binding-to-a-list.aspx)。你的 Action 方法应该是：

```
public ActionResult MyAction(string[] Amount, int[] Item){
   // ...
} 
```

但是，这将使您需要“链接”这些项目。或者创建一个“项目”类：

```
public class Item {
    public string Amount { get; set; }
    public int Item { get; set; }
} 
```

和

```
public ActionResult MyAction(IList<Item> items){
   // ...
} 
```

你的标记应该是：

```
<input type="hidden" name="items.Index" value="0" />
<input type="text" name="items[0].Amount" id="items[0].Amount">
   <select name="items[0].Item">
        <option value="1">Item 1"</option>
        <option value="2">Item 2"</option>
        <option value="3">Item 3"</option>
   </select>
<input type="hidden" name="items.Index" value="1" />
<input type="text" name="items[1].Amount" id="items[1].Amount">
   <select name="items[1].Item">
        <option value="1">Item 1"</option>
        <option value="2">Item 2"</option>
        <option value="3">Item 3"</option>
   </select> 
```

ETC...

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-01-13T04:34:45.040

我相信如果您有多个名为 Amount 的字段，则值将以逗号分隔。

要访问每一个，只需尝试：

```
string[] amounts = Request.Form["Amount"].Split(new char[] { ',' }); 
```

但请记住，提交时不会清理输入，因此如果有人在文本框中输入逗号，则会导致问题。

因此，我建议对它们进行编号。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-16T00:39:05.123

我最终意识到（*脸红*）JQuery 用来在克隆行中查找字符串（替换）的机制基本上是正则表达式。因此，我只需要转义方括号和句点。一旦我这样做了，我就可以使用 JQuery 来创建 Phil Haack 的博客所建议的表单。

到我的下一个问题...！

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-13T04:36:51.947

我会给它们编号 Amount1、Amount2、Amount3 等。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-13T04:37:45.877

您可以将输入的 id 和 name 属性更改为“Amount[1]”、“Amount[2]”、“Amount[3]”（是的，id 和 name 属性可以包含特殊字符“[ “ 或者 ”]”）。然后在控制器中，编写一个 http 请求参数解析器以将 Amounts 作为集合取回。

# jquery - 如何从 jQuery 选择器中排除 $(this)？

> ID：437958
> 
> 赞同：219
> 
> 时间：2009-01-13T04:30:16.263
> 
> 标签：jquery, jquery-selectors, this

我有这样的事情：

```
<div class="content">
    <a href="#">A</a>
</div>
<div class="content">
    <a href="#">B</a>
</div>
<div class="content">
    <a href="#">C</a>
</div> 
```

单击其中一个链接时，我想对未单击的链接执行 .hide() 函数。我知道 jQuery 有 :not 选择器，但我不知道在这种情况下如何使用它，因为**我必须使用`$(".content a")`**

我想做类似的事情

```
$(".content a").click(function()
{
    $(".content a:not(this)").hide("slow");
}); 
```

但我不知道在这种情况下如何正确使用 :not 选择器。

* * *

## 回答 #1

> 赞同：420
> 
> 时间：2009-01-13T04:39:46.153

尝试使用[`not()` **方法**](http://docs.jquery.com/Traversing/not)而不是[`:not()`选择器](http://docs.jquery.com/Selectors/not)。

```
$(".content a").click(function() {
    $(".content a").not(this).hide("slow");
}); 
```

* * *

## 回答 #2

> 赞同：43
> 
> 时间：2009-01-13T04:39:55.137

您可以使用[`not`](http://api.jquery.com/not)函数而不是[`:not`](http://api.jquery.com/not-selector/)选择器：

```
$(".content a").not(this).hide("slow") 
```

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2014-02-15T22:09:35.730

您还可以使用 jQuery`.siblings()`方法：

**HTML**

```
<div class="content">
  <a href="#">A</a>
  <a href="#">B</a>
  <a href="#">C</a>
</div> 
```

**Javascript**

```
$(".content").on('click', 'a', function(e) {
  e.preventDefault();
  $(this).siblings().hide('slow');
}); 
```

工作演示：http: [//jsfiddle.net/wTm5f/](http://jsfiddle.net/wTm5f/)

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2014-02-16T13:27:34.130

您应该使用“siblings()”方法，并防止为了应用该效果而一遍又一遍地运行“.content a”选择器：

**HTML**

```
<div class="content">
    <a href="#">A</a>
</div>
<div class="content">
    <a href="#">B</a>
</div>
<div class="content">
    <a href="#">C</a>
</div> 
```

**CSS**

```
.content {
    background-color:red;
    margin:10px;
}
.content.other {
    background-color:yellow;
} 
```

**Javascript**

```
$(".content a").click(function() {
  var current = $(this).parent();
  current.removeClass('other')
    .siblings()
    .addClass('other');
}); 
```

见这里：http: [//jsfiddle.net/3bzLV/1/](http://jsfiddle.net/3bzLV/1/)

# php - is_numeric 还是数字 preg_match？

> ID：437962
> 
> 赞同：5
> 
> 时间：2009-01-13T04:33:06.540
> 
> 标签：php, security

我在一个论坛上读到你不能完全信任*is_numeric()。*例如，它允许通过“0xFF”，这是允许的十六进制...

所以我的问题是你能欺骗*is_numeric*吗？我需要使用正则表达式才能正确执行吗？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-01-13T04:42:52.527

这是[is_numeric()](http://php.net/is_numeric)认为是数字字符串的内容：

> 数字字符串由可选的符号、任意位数、可选的小数部分和可选的指数部分组成。因此 +0123.45e6 是一个有效的数值。也允许使用十六进制表示法 (0xFF)，但只能没有符号、十进制和指数部分。

如果您只想检查字符串是否由十进制数字 0-9 组成，您可以使用[ctype_digit()](http://php.net/ctype_digit)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-13T07:10:56.813

还可以检查使用[`ctype_digit()`](http://us2.php.net/manual/en/function.ctype-digit.php)以检查其是否为真实数字。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-13T04:40:16.353

正则表达式显然是您更好的选择，但它确实带来了开销。所以这真的取决于你的情况和你想做什么。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-13T06:21:16.977

是否用于验证用户输入？那么使用正则表达式或断言它不包含“x”和 is_numeric() 的开销不会太大。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-13T06:57:20.320

如果您只想检查某物是否为整数，请尝试以下操作：

```
function isInteger($value){
    return (is_numeric($value) ? intval($value) == $value : false);
} 
```

如果您也想检查浮点数，那么这显然不会起作用:)

# c# - 使用 .NET 的 Windows Shell 集成

> ID：437972
> 
> 赞同：6
> 
> 时间：2009-01-13T04:37:41.570
> 
> 标签：c#, .net, windows

使用 .NET 和 C# 在资源管理器右键菜单中注册程序的最简单/最佳方法是什么？
即我希望能够右键单击 Windows 资源管理器中的项目并获得“使用 MyProgram 编辑”

[这是我能找到的最接近教程的东西，](http://www.theserverside.net/tt/articles/showarticle.tss?id=ShellExtensions)但它大多只是从 .NET 进入 Win32 并且也已经过时了。现在应该怎么做？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-13T05:10:10.817

如果您只想添加菜单项，那么 shell 扩展是多余的。您可以在注册表中注册一个命令行，它将以所选文件作为参数运行您的 exe。只有当您想要更改资源管理器的行为、添加自定义图标或挂钩基于 shell 的文件操作时，才真正需要 shell 扩展。

[http://www.codeproject.com/KB/shell/SimpleContextMenu.aspx](http://www.codeproject.com/KB/shell/SimpleContextMenu.aspx)

如果您需要 shell 扩展，您最好在非托管代码中编写一个瘦包装器，通过某种跨进程通信通道调用另一个进程，即您的 .NET 应用程序。由于所有潜在的版本控制问题，不建议将 .NET 运行时加载到资源管理器进程中。

# keyboard - 键盘加速器和快捷键有什么区别？

> ID：437975
> 
> 赞同：1
> 
> 时间：2009-01-13T04:38:08.340
> 
> 标签：keyboard, accelerator, keyboard-shortcuts

键盘加速器和快捷键有什么区别？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2010-06-11T09:35:47.857

约翰 - 我不认为这是正确的。

MSDN 将菜单定义为：
'菜单访问键' - 菜单项名称中带下划线的字母。
'菜单快捷键' - 菜单项右侧的组合键。

菜单快捷键（菜单右侧的文本）被标识为与键盘加速键同义，而不是菜单访问键 - 请参阅“关于菜单”MSDN 页面中[菜单快捷键](http://msdn.microsoft.com/en-us/library/ms647553(v=VS.85).aspx#_win32_Menu_Shortcut_Keys)的段落 - 本节指向信息在键盘加速器上，而不是在[Menu Access Keys](http://msdn.microsoft.com/en-us/library/ms647553(v=VS.85).aspx#_win32_Menu_Access_Keys)上的部分。

就我而言，键盘加速器是一个“快捷键”。无论菜单的可见性如何，都可以使用它们，并且仅将它们包含在菜单中作为用户的参考以及用户获取他们可能经常使用的菜单项的快捷方式的一种方式。因此，它们可以在根本不显示在菜单中的情况下被定义。

请参阅有关键盘加速器的 MSDN 页面：

> 通常，用户依赖于应用程序的菜单来学习命令集，然后随着他们对应用程序的熟练掌握而切换到使用加速器。 [http://msdn.microsoft.com/en-us/library/ms646335(v=VS.85).aspx](http://msdn.microsoft.com/en-us/library/ms646335(v=VS.85).aspx)

> 尽管加速器通常生成作为菜单项存在的命令，但它们也可以生成没有等效菜单项的命令。
> [http://msdn.microsoft.com/en-us/library/ms646335(v=VS.85).aspx](http://msdn.microsoft.com/en-us/library/ms646335(v=VS.85).aspx)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-01-13T05:07:09.780

对于 Windows，键盘快捷键由按钮、菜单或其他标签上带下划线的字母表示：

[键盘加速器 http://content.screencast.com/users/TreefortJohn/folders/Jing/media/70d5002f-5832-448a-9379-256b7a8c4fd7/2009-01-12_2304.png](http://content.screencast.com/users/TreefortJohn/folders/Jing/media/70d5002f-5832-448a-9379-256b7a8c4fd7/2009-01-12_2304.png)

在最新版本的 Windows 上，它们是隐藏的，直到您按下 Alt 键。然后你可以点击那个字母来选择菜单、按钮或其他输入控件。

快捷键通常没有视觉表示，除非它们在菜单中列出。`Ctrl`- `C`、`Ctrl`- `X`、`Ctrl`-`V`是常用快捷键的示例，您可以在它们各自的菜单项旁边看到这些快捷键。

[关于键盘加速器](http://msdn.microsoft.com/en-us/library/ms646335(VS.85).aspx)

# c# - C# Dates - 数据库、显示和本地化

> ID：437981
> 
> 赞同：2
> 
> 时间：2009-01-13T04:39:55.683
> 
> 标签：c#, datetime, localization, date

当想要在新应用程序中坚持本地化时，有哪些日期（和时间）格式的最佳实践。

例如，您使用什么格式将日期写入数据库。

从数据库中获取日期后，如何使用他们自己的区域设置向用户显示以下内容。

短日期长日期日期时间

对投注者的任何提示表示赞赏。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-13T05:29:45.677

DateTime2（又名 MS SQL 中的长日期）仅在您需要该级别的粒度或 10,000 年范围时才有用。DateTime 似乎是常态。如果您只需要日期部分并且可以忽略时间，请使用 SQL 2008 中新的 Date 数据类型。询问您的客户项目所需的粒度。

UTC 是存储日期的最佳方式，因为您的服务器或客户端可以位于世界任何地方（假设基于 Web 的部署）。此外，如果您移动您的服务器或拥有一个新的托管服务器，您将不需要调整时区，因为每个人都已经在 UTC 上运行。

您只应在稍后的演示文稿中将 UTC 转换为本地时间。如果您的客户使用网络浏览器，您可以从 javascript 获取时区偏移量。然后，如果您在服务器端需要该值，请将值存储在 cookie 或隐藏的 HTML 字段中以便于访问。

我使用了来自 CodeProject 的这个[javascript](http://www.codeproject.com/KB/aspnet/Remote_Time_Zone.aspx)示例的调整版本来做同样的事情。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-13T04:59:45.270

始终以 UTC 存储日期，并在显示它们时根据用户的时区计算本地时间（您必须在某个时间点询问并存储）。

# c# - c#中的动态控制

> ID：437994
> 
> 赞同：2
> 
> 时间：2009-01-13T04:45:39.930
> 
> 标签：c#, winforms

我想创建一种带有文本框和复选框的 4 x 3 矩阵。元素是复选框还是文本框取决于数据库中的值。我希望它是动态的。最好的开始方式是什么？

```
// something like this but I need to fill in each elements of the matrix...
  private void CreateSpecificControl(string requestedType)
        {
                if (requestedType == "CheckBox")
                {

                    CheckBox control1 = new CheckBox();

                    control1.Click += new EventHandler(chk_CheckedChanged);

                   //TableLayout panel
                    layout.ColumnStyles.Add(new ColumnStyle(SizeType.Percent, 25));
                    layout.Controls.Add(control1);

                }
                else
                {
                    Label control1 = new Label();

                    control1.Text = "Not a checkbox";
                    layout.ColumnStyles.Add(new ColumnStyle(SizeType.Percent, 25));
                    layout.Controls.Add(control1);

                }

        } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-13T04:48:15.403

使用用户控件。请参阅本[教程](http://msdn.microsoft.com/en-us/library/aa302342.aspx)。

在运行时，您可以更改用户控件的内容。每个用户控件中都有一个 Controls 集合，您可以从中添加或删除元素。例如，如果您想添加复选框，只需执行以下操作：

```
myUserControl.Controls.Add(new CheckBox()); 
```

类似地，可以从该集合中删除元素，从而实现动态行为。***********