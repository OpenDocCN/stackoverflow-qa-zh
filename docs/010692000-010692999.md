# StackOverflow 问答 10692000-10692999

# php - jquery 和 php ajax 会话

> ID：10692000
> 
> 赞同：4
> 
> 时间：2012-05-21T20:16:59.710
> 
> 标签：php, jquery, session

**这是我所做的：**

我的登录表单在 www.mysite.com/login.html 上：（子域 www！）

```
 function authenticate(userName, password) {
    $.ajax
    ({
        type: "POST",
        //the url where you want to sent the userName and password to
        url: 'http://server.mysite.com/ajax/auth.php',
        dataType: 'json',
        async: false,
        cache: false,
        data: 'vardas='+userName+'&psw='+password,
        success: function (data) {
                {
                    window.location.replace('/main.html');
                }
        }
    })
    } 
```

这是我的 ajax/auth.php：

```
header('Content-type: application/json');
header ("Access-Control-Allow-Origin: http://www.mysite.com");
header('Expires: ' . gmdate('r', 0));

session_start();
$_SESSION["ok"] = 1111; <- test value 
```

这是main.php：

```
<script>
  $(function() {
    $('#home').load('http://server.mysite.com/ajax/loader.php', function() {
    })
  });
</script>
<div id=home></div> 
```

这是我的 ajax/loader.php :)

```
<?
    header ("Access-Control-Allow-Origin: http://www.mysite.com");
    header('Expires: ' . gmdate('r', 0));

    session_start();

    var_dump ($_SESSION); <---- OUTPUT IS (0) EMPTY!! Why ?
?> 
```

**为什么这不起作用？我总是让 $_SESSION 为空。**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-18T12:43:00.793

如果所有域都在同一服务器上，请在调用 session_start 之前在任何地方使用这三行

```
$session_name = session_name("somename");
ini_set('session.cookie_domain', '.mysite.com');
ini_set('session.save_path', 'C:\tmp');
session_start(); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-21T20:19:39.330

`session_start();` *必须*是产生任何输出的第一件事。你的`header()`东西下面有它。它需要先走。

请参阅此处的第一个注释：[http ://www.php.net/manual/en/function.session-start.php](http://www.php.net/manual/en/function.session-start.php)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-01T16:08:08.813

我不明白为什么你有一个 login.html 并且在 ajax 执行之后，你有这个 main.php 重定向页面？我对吗？如果是这种情况，为什么不直接在表单提交后重定向用户并让服务器在呈现页面之前验证身份验证？

现在，如果不是这种情况，请始终提醒您通过ajax设置会话数据时不会生效，并且在当前页面中，您将调用它。它肯定行不通。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-21T20:20:26.693

您永远不会调用运行 ajax 请求的身份验证来调用 auth.php 并设置会话变量。你 .load [http://server.mysite.com/ajax/loader.php](http://server.mysite.com/ajax/loader.php)调用 session_start，但你从来没有调用 authenticate() 所以你的会话永远不会被填满。

此外，尚未完全支持 Access-Control-Allow-Origin，因此根据浏览器的不同，它可能会阻止您的跨域请求。

# c# - 检测到 AZERTY 键盘上的某些键？

> ID：10692009
> 
> 赞同：0
> 
> 时间：2012-05-21T20:17:35.560
> 
> 标签：c#, keyboard, keyboard-events, regional-settings, azerty-keyboard

我在检测按键的程序中遇到问题。所有字符都在 QUERTY 键盘上工作，但我知道 AZERTY 键盘上的某些字符存在问题。

例如，当在 AZERTY 键盘上按下 \ 时，会得到 226 (â) 的键码。

如何确保键盘布局的行为一致？我希望内置的事件处理是一致的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-22T08:35:23.673

是的，不同的键盘布局给出不同的键码。该[文档](http://msdn.microsoft.com/en-us/library/ms927178.aspx)将`VK_OEM_102`(keycode 226) 描述为`"<>" or "\|" on RT 102-key keyboard`，因此键码甚至不应该对应于单个特定字符。

要查看键对应的字符，请使用[MapVirtualKey](http://msdn.microsoft.com/en-us/library/windows/desktop/ms646306%28v=vs.85%29.aspx)函数。然后，您可以检查它是否是反斜杠。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-22T08:28:35.500

我根本无法重现。反斜杠是在 AZERTY 键盘上通过按住`AltGr`然后按下`8`字母上方数字行上的键来组成的。当您这样做时，会触发以下`KeyDown`事件：

*   KeyCode: Menu, KeyValue: 18 表示`AltGr`向下
*   KeyCode: D8, KeyValue: 56`8`向下

另一方面，如果您按下紧靠左侧的键，`W`则会`KeyDown`触发带有 KeyCode OemBackslash 和 KeyValue 226 的键，并且`<`文本框中会出现一个字符。

我想知道您的键盘布局是否设置不正确以匹配您的特定键盘。我假设你的键盘看起来像这个维基百科页面上的图像：[http ://en.wikipedia.org/wiki/AZERTY](http://en.wikipedia.org/wiki/AZERTY)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-21T20:27:27.647

您可能希望首先[检测键盘布局](https://stackoverflow.com/questions/869609/keyboard-type-qwerty-or-dvorak-detection)，然后使用不同的键码到字符映射。

# c# - 如何在 C# 中处理中断的 HTTP 连接

> ID：10692010
> 
> 赞同：2
> 
> 时间：2012-05-21T20:17:36.777
> 
> 标签：c#, httpwebrequest, connection, request

假设我创建了一个`HTTPWebRequest`，调用它`GetResponse()`并开始从响应流中读取。如果在从流中读取时连接中断，我是否必须等待它超时，或者我可以立即知道出了什么问题？当我中断连接时不会抛出异常（例如，我将计算机与网络断开连接）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T20:35:54.280

这取决于实际情况。

一般来说，您需要为这两种情况（立即中断和后期中断）做好准备。例如，如果服务器断开您的连接，您会相对较快地知道。

有关可能发生的错误类型，请参见[http://msdn.microsoft.com/en-us/library/system.net.webexceptionstatus](http://msdn.microsoft.com/en-us/library/system.net.webexceptionstatus)`WebRequest` （类在错误时抛出`WebException`s）

您有多种选择：

*   使用异步方法 (`BeginGet...`和`EndGet...`) 并围绕此为您的应用程序建模。基本上，如果成功或错误，您将在“某个时候”收到通知。期间做点别的
*   如果您想要绝对控制，您可以`ReadTimeout`在获取的流上指定 a （参见其他答案的评论，也可以`Timeout`在请求中设置）。重试什么的。
*   等一下

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-21T20:34:36.127

您不必担心请求是否被中断。

您可以按如下方式指定显式超时。如果它被打断，你会得到异常。

```
 try
     {
        var request = HttpWebRequest.Create(url);
        request.Timeout = 3000;
        var response = request.GetResponse() as HttpWebResponse;
        if (response.StatusCode.Equals(HttpStatusCode.OK))
        {
           //do stuff
        }
     }
     catch (Exception exception)
     {
        exception.ToLog();
     } 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-05-21T20:24:49.530

很可能您必须等待超时

# java - Java - Flex 4 AIR 2.0 本机进程

> ID：10692013
> 
> 赞同：1
> 
> 时间：2012-05-21T20:17:50.123
> 
> 标签：java, air, process, flex4

我正在使用 Flex 4 Native Process 与 Java 交互以使用 PHP 连接到远程服务器。

我尝试了在 Internet 上找到的将 Flex 与 Java 连接的示例：

柔性：

```
 protected function windowedApplication1_creationCompleteHandler(event: FlexEvent): void
        {
            var info:NativeProcessStartupInfo = new NativeProcessStartupInfo();
            info.executable = new File("C:/Program Files/Java/jre6/bin/java.exe");
            info.workingDirectory = File.applicationDirectory;

            var args: Vector.<String> = new Vector.<String>();
            args.push("-cp", "../bin", "scanner.Main");
            info.arguments = args;
            process = new NativeProcess();
            process.addEventListener(ProgressEvent.STANDARD_OUTPUT_DATA, onDataOutput);
            process.start(info);
        }

        private function onDataOutput(event: ProgressEvent): void 
        {
            var message:String = process.standardOutput.readUTFBytes(process.standardOutput.bytesAvailable);
            Alert.show(message);
        } 
```

爪哇：

```
public static void main(String[] args)
{
    String input;
    Scanner scanner = new Scanner(System.in);
    while (scanner.hasNext("hello|stop"))
    {
        input = scanner.next();
        if (input.equals("hello"))
        {
            System.out.println("hello flex! ... from java");
        }
        else if (input.equals("stop"))
        {
            return;
        }
    }
} 
```

它工作完美。

但是当我尝试调用连接到远程服务器的 Java 方法，切换`System.out.println("hello flex! ... from java");`方法名称的行时，它会死掉（什么都不做）。

我是 Native Process 概念的新手，但在网络上研究我发现您需要将库作为项目使用的参数发送。

我需要一些关于如何做到这一点的帮助。

Java 项目使用 Http 和 JSON 库。我如何将这些添加到论点中？我还需要添加 JRE 系统库吗？

PS：如果我从 Eclipse 执行 java 方法，它可以正常工作。

谢谢你。

编辑：尝试使用 Jar 文件

```
 var file:File = new File("C:/Program Files/Java/jre6/");
            file = file.resolvePath("bin/javaw.exe");

            var arg:Vector.<String> = new Vector.<String>;
            arg.push("-jar");
            arg.push(File.applicationDirectory.resolvePath("prueba3.jar").nativePath);
            arg.push("-Djava.library.path=C:\\Users\\Administrador\\Desktop\\libhttp");

            var npInfo:NativeProcessStartupInfo = new NativeProcessStartupInfo();
            npInfo.executable = file;
            npInfo.arguments = arg;

            process = new NativeProcess();          
            process.addEventListener(ProgressEvent.STANDARD_OUTPUT_DATA, onStandardOutputData);
            process.start(npInfo); 
```

并添加库路径，但仍然无效。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-24T01:02:34.087

您可以制作 AMFPHP 服务，并使用 AS3 直接连接到 PHP

# c++ - libclang 获取原始值

> ID：10692015
> 
> 赞同：8
> 
> 时间：2012-05-21T20:18:03.853
> 
> 标签：c++, libclang

如何使用 libclang 获取原始文字的值？

例如，如果我有一个光标类型为 CXCursor_IntegerLiteral 的 CXCursor，我该如何提取文字值。

* * *

更新：

我在使用 libclang 时遇到了很多问题。我强烈建议完全避免它，而是使用 clang 提供的 C++ 接口。C++ 接口非常有用并且有很好的文档记录：[http ://clang.llvm.org/doxygen/annotated.html](http://clang.llvm.org/doxygen/annotated.html)

我现在看到的 libclang 的唯一目的是使用以下代码为您生成 ASTUnit 对象（否则并不容易）：

```
ASTUnit * astUnit;
{
    index = clang_createIndex(0, 0);
    tu = clang_parseTranslationUnit(
        index, 0,
        clangArgs, nClangArgs,
        0, 0, CXTranslationUnit_None
        );
    astUnit = static_cast<ASTUnit *>(tu->TUData);
} 
```

现在你可能会说 libclang 是稳定的，而 C++ 接口不是。这几乎无关紧要，因为你花时间用 libclang 找出 AST 并用它创建 kludges 无论如何都会浪费你很多时间。我会尽快花几个小时来修复版本升级后无法编译的代码（如果需要的话）。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-06-19T19:58:06.363

您无需重新解析原件，而是已经在翻译单元中获得了所需的所有信息：

```
if (kind == CXCursor_IntegerLiteral)
{
    CXSourceRange range = clang_getCursorExtent(cursor);
    CXToken *tokens = 0;
    unsigned int nTokens = 0;
    clang_tokenize(tu, range, &tokens, &nTokens);
    for (unsigned int i = 0; i < nTokens; i++)
    {
        CXString spelling = clang_getTokenSpelling(tu, tokens[i]);
        printf("token = %s\n", clang_getCString(spelling));
        clang_disposeString(spelling);
    }
    clang_disposeTokens(tu, tokens, nTokens);
} 
```

您会看到第一个标记是整数本身，下一个是不相关的（例如，它`;`用于`int i = 42;`.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2020-09-12T11:47:54.410

如果您有权访问 a `CXCursor`，则可以使用该`clang_Cursor_Evaluate`功能，例如：

```
CXChildVisitResult var_decl_visitor(
    CXCursor cursor, CXCursor parent, CXClientData data) {
  auto kind = clang_getCursorKind(cursor);

  switch (kind) {
  case CXCursor_IntegerLiteral: {
    auto res = clang_Cursor_Evaluate(cursor);
    auto value = clang_EvalResult_getAsInt(res);
    clang_EvalResult_dispose(res);

    std::cout << "IntegerLiteral " << value << std::endl;

    break;
  }
  default:
    break;
  }

  return CXChildVisit_Recurse;
} 
```

输出：

```
IntegerLiteral 42 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-21T21:09:30.203

我通过参考原始文件找到了一种方法：

```
std::string getCursorText (CXCursor cur) {
    CXSourceRange range = clang_getCursorExtent(cur);
    CXSourceLocation begin = clang_getRangeStart(range);
    CXSourceLocation end = clang_getRangeEnd(range);
    CXFile cxFile;
    unsigned int beginOff;
    unsigned int endOff;
    clang_getExpansionLocation(begin, &cxFile, 0, 0, &beginOff);
    clang_getExpansionLocation(end, 0, 0, 0, &endOff);
    ClangString filename = clang_getFileName(cxFile);
    unsigned int textSize = endOff - beginOff;

    FILE * file = fopen(filename.c_str(), "r");
    if (file == 0) {
        exit(ExitCode::CANT_OPEN_FILE);
    }
    fseek(file, beginOff, SEEK_SET);
    char buff[4096];
    char * pBuff = buff;
    if (textSize + 1 > sizeof(buff)) {
        pBuff = new char[textSize + 1];
    }
    pBuff[textSize] = '\0';
    fread(pBuff, 1, textSize, file);
    std::string res(pBuff);
    if (pBuff != buff) {
        delete [] pBuff;
    }
    fclose(file);
    return res;
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2017-12-31T13:02:36.013

您实际上可以结合使用 libclang 和 C++ 接口。

libclang`CXCursor`类型包含一个`data`字段，该字段包含对底层 AST 节点的引用。我能够通过转换为类型成功地访问该`IntegerLiteral`值。`data[1]``IntegerLiteral`

我在[Nim](https://nim-lang.org)中实现了这一点，因此我将提供 Nim 代码，但您也可以在 C++ 中执行相同的操作。

```
let literal = cast[clang.IntegerLiteral](cursor.data[1])
echo literal.getValue().getLimitedValue() 
```

`IntegerLiteral`类型是这样包装的：

```
type
  APIntObj* {.importcpp: "llvm::APInt", header: "llvm/ADT/APInt.h".} = object
    # https://github.com/llvm-mirror/llvm/blob/master/include/llvm/ADT/APInt.h
  APInt* = ptr APIntObj

  IntegerLiteralObj* {.importcpp: "clang::IntegerLiteral", header: "clang/AST/Expr.h".} = object
  IntegerLiteral* = ptr IntegerLiteralObj

proc getValue*(i: IntegerLiteral): APIntObj {.importcpp: "#.getValue()".}
  # This is implemented by the superclass: https://clang.llvm.org/doxygen/classclang_1_1APIntStorage.html
proc getLimitedValue*(a: APInt | APIntObj): culonglong {.importcpp: "#.getLimitedValue()".} 
```

希望这可以帮助某人:)

# powershell - 修复 Powershell 非活动用户脚本

> ID：10692017
> 
> 赞同：0
> 
> 时间：2012-05-21T20:18:33.187
> 
> 标签：powershell

我正在寻找一个 powershell 脚本，该脚本将返回根目录中的所有用户，并在帐户处于非活动状态超过 15 天和/或 30 天时对其进行标记。我想我已经很接近了，但我的 If/Elseif 语句似乎不起作用。有谁知道改善这一点的方法？

```
$objSearcher.Filter = "(&(objectCategory=person)(objectClass=user))"

$objSearcher.PropertiesToLoad.Add("displayName")
$objSearcher.PropertiesToLoad.Add("sAMAccountName")
$objSearcher.PropertiesToLoad.Add("lastLogonTimeStamp")

$userObjects = $objSearcher.FindAll() 

foreach ($user in $userObjects)
{
 $dn = $user.Properties.Item("displayName")
 $sam = $user.Properties.Item("sAMAccountName")
 $logon = $user.Properties.Item("lastLogonTimeStamp")

 if($logon.Count -eq 0)
 {
    $lastLogon = "Never"
 }
    #Inactive for 15 days
    elseif($logon.Value -ge (get-date).AddDays(-15))
  {
    $lastLogon = "Pending"
 }
    #Inactive for 30 days
      elseif($logon.Value -ge (get-date).AddDays(-30))
     {
        $lastLogon = "Retired"
     }

 else
 {
 $lastLogon = [DateTime]$logon[0]
 $lastLogon = $lastLogon.AddYears(1600)
 }

"""$dn"",$sam,$lastLogon"
} 
```

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-04T08:58:31.023

非常感谢你做的这些 ：

```
"$LLTSlimit = **(Get-Date).AddDays(-15).ToFileTimeUTC().ToString()** $objSearcher.Filter = "(&(objectCategory=person)(objectClass=user)(!(userAccountControl:1.2.840.113556‌​.1.4.803:=2))(lastlogontimestamp<=$LLTSlimit))"" 
```

终于，我找到了我一直在寻找的东西！你帮了我很多。谢谢！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-21T20:23:47.927

您似乎将 -15 天到现在登录的任何人识别为“待定”，将 -30 天到 -15 天登录为“退休”。

尝试翻转 elseif 的顺序，并将大于或等于检查更改为小于或等于。

您还需要将 $logon[0] 转换为 DateTime，就像您在“else”块中所做的那样。

因此，您的代码将变为：

```
elseif([DateTime]$logon[0] -le (get-date).AddDays(-30))
{
    #Inactive for 30 days
    $lastLogon = "Retired"
}
elseif([DateTime]$logon[0] -le (get-date).AddDays(-15))
{
    #Inactive for 15 days
    $lastLogon = "Pending"
} 
```

# ios - gamekit UIRequiredDeviceCapabilities

> ID：10692021
> 
> 赞同：0
> 
> 时间：2012-05-21T20:18:55.587
> 
> 标签：ios, game-center, gamekit

UIRequiredDeviceCapabilities 中的“gamekit”条目是否必须出现在游戏中心才能工作？我一直在排行榜上发布分数，来自三个不同的帐户，在三种不同的设备上，但分数从未出现过。他们都说“未排名”

这令人沮丧。我当前提交的应用程序（仍在等待审核）在 plist 的 UIRequiredDeviceCapabilities 中没有“gamekit”条目。

这是为什么？还是那没关系？

提前感谢任何帮助！

在纽约感到沮丧。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-22T15:51:05.780

哦，好吧，你知道什么。它在我发布这个问题后立即开始工作。哈哈！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-22T15:50:15.310

我的应用尚未提交，但在沙盒模式下成功提交分数。还有成就。而且它在所需的设备功能中不包括任何关于 gamekit 或游戏中心的内容。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-01-17T09:34:18.187

**不，在UIRequiredDeviceCapabilities**键中包含**gamekit**条目不是强制性的。

 **无论 UIRequiredDeviceCapabilities 键如何指定，您的 Game Center SNS 功能仍可在开发和 AppStore 分发中使用。

我已经成功提交了一个支持 GameCenter 的新应用程序，它缺少 info.plist 中的“gamekit”值，并且 AppStore 零售版运行良好。**

# qt - 固定布局的大小

> ID：10692023
> 
> 赞同：8
> 
> 时间：2012-05-21T20:19:06.137
> 
> 标签：qt, qt4

有没有办法让 layoutStretch 属性始终被遵守？例如，我将其设置为“1,3,2”，但随后第一部分中的小部件（标签）（“1,3,2”中的“1”）扩展（添加更多文本时），并且那么 1:3:2 的配给就不再受到尊重。也就是说，“1:3:2”的比例变成了更​​像“3:1:3”的比例。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-05-22T00:58:34.067

你应该看看财产[`QWidget::sizePolicy`](http://qt-project.org/doc/qt-4.8/qwidget.html#sizePolicy-prop)。它控制布局`sizeHint()`在更新几何图形时如何尊重其子级。

所以你需要做的是：通过将三个子小部件的水平 sizePolicy 设置为：使布局忽略子小部件的水平 sizeHints `QSizePolicy::Ignored`：

```
QLabel *label = ...;
...
label->setSizePolicy(QSizePolicy::Ignored, label->sizePolicy().verticalPolicy()); 
```

（第二个参数将确保垂直策略不会被此语句更改。当然，您应该设置每个子窗口小部件的大小策略，此示例代码仅用于标签。）

请注意，布局的内容必须是小部件；我认为嵌套布局不能分配大小策略（但我可能错了）。至少使用 QtDesigner，没有办法将大小策略应用于布局本身（如果它不是小部件的布局）。详情见评论。

* * *

在 QtDesigner 中，您可以像这样设置子小部件的 sizePolicy：

*之前：*
![在此处输入图像描述](../Images/1a0f8da251a262270b8f2609dcf43245.png)
*缩小：*
![在此处输入图像描述](../Images/3e2ee908b03004326d81aa0881d3765d.png)
*选择布局中的项目：*
![在此处输入图像描述](../Images/8c8f853e433a01e19415a00cafc79b15.png)
*将水平尺寸策略设置为“忽略”：*
![在此处输入图像描述](../Images/052216fc34b0cf44f39ea62a2ebdb7c3.png)
*结果：*
![在此处输入图像描述](../Images/4aba8354f2d3e1c3e448f4556ccf7065.png)

# jquery - jQueryMobile 在 Phonegap 应用程序的一页上

> ID：10692025
> 
> 赞同：1
> 
> 时间：2012-05-21T20:19:26.210
> 
> 标签：jquery, android, jquery-mobile, cordova

我有一个正在使用 phonegap 开发的应用程序，并且只想将 jQueryMobile 用于该应用程序的一页。我也在使用 Iscroll。问题是，当我加载一个页面时，jQueryMobile 用于一切都继续正常工作。但是当导航到另一个页面时。iscroll 不再起作用。

当用户离开该页面时，有没有办法阻止 jQueyMobile 中的脚本继续执行？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-21T20:23:31.903

如果不知道您的代码/应用程序的细节，很难确定，但请尝试将以下属性添加到您的 jQuery Mobile 页面上的链接中。

```
data-ajax="false" 
```

您可能会将新页面引入现有 DOM，这将保留现有行为。

# mysql - 根据另一列获取一列的计数

> ID：10692026
> 
> 赞同：0
> 
> 时间：2012-05-21T20:19:27.740
> 
> 标签：mysql, sql

假设我有以下数据。我正在尝试通过 acct_id 计算每个buyer_id 的计数，其中buyer_id 包含5。因此，对于具有五个实​​例且包含一个5 实例的acct 51，我要找到每个buyer_id 的计数（当然不包括5）。这个计数应该通过所有包含 5 个buyer_id 的acct_id，并提供所有其他buyer_id 的计数。

```
acct_id        buyer_id         message
51              5            success   
51              13           fail   
51              4            success
51              6            success
51              9            fail
53              6            fail   
53              12           fail   
53              4            success
57              6            fail   
57              12           fail   
57              4            success
57              5            success 
```

所以在这个例子中，我最终会得到类似下面的东西

```
buyer_id    count(*)
4           2     
5           2  
6           2
9           1 
12          1
13          1 
```

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-21T20:27:39.653

这应该可以解决问题：

```
select buyer_id, count(distinct acct_id)
from Table1 a
where exists (
  select * from Table1
  where acct_id = a.acct_id 
    and buyer_id =5)
group by buyer_id 
```

在此处查看 sqlfiddle：[http ://sqlfiddle.com/#!2/0d3d2/3](http://sqlfiddle.com/#!2/0d3d2/3)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-21T20:29:40.823

我想这就是你想要的。

```
Select buyer_id, count(*)
From table
Where acct_id in (Select acct_id From table Where buyer_id = 5) --insert buyer_id param here
Group By buyer_id 
```

# javascript - Phonegap (Cordova) 图片上传到服务器太大

> ID：10692033
> 
> 赞同：1
> 
> 时间：2012-05-21T20:20:22.293
> 
> 标签：javascript, ios, ajax, cordova

我有一个 Phonegap 应用程序，它使用相机 Cordova API 拍照并在成功捕获后将其上传到我的服务器。唯一的问题是图像质量太好了。当我达到更高的用户数量时，这确实是一个问题。

这是我的javascript：

```
function capture() {
    navigator.camera.getPicture(cameraSuccess, cameraError, { 
        quality: 5, 
        destinationType: destinationType.FILE_URI,
        sourceType : sourceType.CAMERA,
        encodingType: encodingType.JPEG,
        targetWidth: 300
    });
} 
```

上传的文件大小约为 240KB，宽度超过 1200 像素。

我尝试在选项中添加“质量”和“目标宽度”来更改图像的质量，但无济于事。

任何帮助将不胜感激，谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-05T19:33:40.930

所以我接受了@Gerben 的建议，并在使用 javascript (jQuery) 将其发布到服务器之前使用了 html5 画布来修改我的图像。

[链接在这里。](https://stackoverflow.com/questions/2303690/resizing-an-image-in-an-html5-canvas)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-10-18T19:05:31.677

利用 Amazon Web Services (AWS)S3 之类的服务和相应的 API，您可以在图像到达您的服务器后将其存储在其他地方，并简单地将生成的链接存储到上传的图片。您最终仍会遇到空间问题，但扩展应该是微不足道的。但是，首先，您可以获得免费试用帐户。

通过这种方式，您可以获得清晰的高清图片以供显示，并且您网站的托管服务器不会陷入困境。

# c# - SQLBulkCopy 不复制主键

> ID：10692034
> 
> 赞同：4
> 
> 时间：2012-05-21T20:20:23.997
> 
> 标签：c#, sql-server, sqlbulkcopy

使用 SQLBulkCopy 时处理主键冲突错误的最佳方法是什么

```
Violation of PRIMARY KEY constraint 'email_k__'. Cannot insert duplicate key in object  'lntmuser.email'. 
```

（即，如果该行已经存在于目标表中）？

有没有办法跳过插入重复的行，或者必须事先检查和处理？

这是我目前正在使用的代码：

```
 var conPro = tx_ProConStr.Text;
  var conArc = tx_ArcConStr.Text;

  var con = new SqlConnection {ConnectionString = conPro};
  var cmd = new SqlCommand("SELECT * FROM dbo.email", con);
  con.Open();

  var rdr = cmd.ExecuteReader(); 
  var sbc = new SqlBulkCopy(conArc) {DestinationTableName = "dbo.email"};

  sbc.WriteToServer(rdr);

  sbc.Close();
  rdr.Close();
  con.Close(); 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-21T20:24:57.070

我通常最终对临时表执行批量复制操作，然后使用常规 SQL 将数据从临时表复制到目标表。这使我能够执行“批量更新”，以及处理像这样的特殊情况（尽管我还没有遇到这种特殊需要）。

与直接批量复制相比，性能会受到影响，但它仍然比执行 INSERT 快得多。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-21T20:41:13.833

您可以调整源查询以排除重复项。例如：

```
select distinct * from dbo.email 
```

或过滤第一个`col1`per `pkcol`：

```
select  *
from    (
        select  row_number() over (parition by pkcol order by col1) as rn
        from    dbo.email
        ) as SubQueryAlias
where   rn = 1 
```

# excel - Excel 2007 VBA 代码拆分单元格

> ID：10692043
> 
> 赞同：0
> 
> 时间：2012-05-21T20:21:20.567
> 
> 标签：excel, vba, cell, split

Excel 2007 - 我有无数旧的 Word 表格，我想将它们放入 Excel。我想将单元格的内容分成两个单元格。大多数单元格具有非常相似的格式（我不需要拆分没有这种格式的单元格） - 文本（日期）。我尝试过使用“LEFT”或“RIGHT”，但由于文本字符串和日期字符串是可变长度的，因此没有好的直接方法。例如-

单元格 A1-“市场价值 (6/16/09)”[或“添加 (12/15/09)”等]

我想把细胞分成-

单元格 A1-“市场价值”和单元格 B1-“6/16/09”

显然，如果它获取 A1 数据并将其放入 B1/C1 中，我就不在乎了。

我见过其他一些拆分 VBA 模块，但它们似乎并没有为我做这个伎俩。我一直在寻找使用 CSV 拆分它的方法，但这似乎也没有用。那么有没有办法使用“（”或“）”作为标记来复制“（”之前或之后的文本？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-21T20:33:58.540

> 那么有没有办法使用“（”或“）”作为标记来复制“（”之前或之后的文本？

是的

例子

单元格 A1-“市场价值 (6/16/09)”

```
Sub Sample()
    Dim Ar() As String

    Ar = Split(Range("A1").Value, "(")

    Debug.Print Ar(0) '<~~ This will give      Market Value
    Debug.Print Ar(1) '<~~ This will give      6/16/09)

    '<~~ And the below will give you           6/16/09
    Debug.Print Replace(Ar(1), ")", "")
End Sub 
```

# javascript - 用javascript制作贝叶斯板图

> ID：10692044
> 
> 赞同：0
> 
> 时间：2012-05-21T20:21:22.357
> 
> 标签：javascript, plot, bayesian

我想为贝叶斯网络制作板图，例如[Latent Dirichlet Allocation](http://en.wikipedia.org/wiki/Latent_Dirichlet_allocation)的这张图：

![LDA板图](../Images/bd282a1455ce5d9407ac3a3e638c7396.png)

这些图表非常简单，实际上只需要箭头、圆形、矩形和希腊字母。什么是最简单的 javascript 图形库来制作这些，以便我可以在博客中显示它们，例如[Octopress 网站](http://octopress.org/)？ [D3.js](http://d3js.org/)看起来可以做到，但我不熟悉 api，而且看起来每个图表都需要相当多的工作。

提前致谢！

# visual-studio - 在 ci 服务器中使用 Visual Studio 解决方案或维护单独的构建文件

> ID：10692047
> 
> 赞同：0
> 
> 时间：2012-05-21T20:21:36.677
> 
> 标签：visual-studio, msbuild, continuous-integration, nant

这样做的常见方法是什么？

维护一个单独的构建文件（例如 nant）会花费时间，但不会将您锁定在 Visual Studio 中。

大多数开发人员是使用 Visual Studio 解决方案构建还是必须使用 nant 构建文件。

最佳实践是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T20:30:29.697

我所做的是使用 proj 文件而不是 sln 文件。MSbuild 处理它们就好了。

这样，您就可以两全其美。您没有被锁定在 VS 中，但您也不必维护 2 个构建文件的副本

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-21T20:34:33.567

这取决于你的项目...

我有多个解决方案要构建为一个产品，因此我使用 msbuild / nant 将它们全部包含在内。

使用构建文件的另一个原因是当 CI 服务器构建项目时您想要执行更多操作并且您不希望在开发人员构建解决方案时执行这些操作（复制文件以进行部署或设置程序集版本例如）

一般来说，我认为除非你有理由使用构建文件，否则你可以只使用 sln 文件

# ruby-on-rails - rails n:m 如何在 db 表名不同时进行 rails 关联

> ID：10692049
> 
> 赞同：0
> 
> 时间：2012-05-21T20:21:50.440
> 
> 标签：ruby-on-rails, naming-conventions, associations, has-many, tablename

我有一个不遵循 Rails 命名约定的项目，因为在特殊情况下不可能。

场景：我有一个名为 Foo 的模型，该模型的数据库表名为 example_foos。我有一个名为 Bar 的模型，该模型的数据库表名为 example_bars。

我想在这两个模型与模型 FooBar 之间创建一个：m 关联。此模型的数据库表名称为 ExampleFooExampleBars。

现在我的问题..如何在模型中指定 has_many throught 关联？如果我像往常一样做，我会收到错误，因为模型和表名不同..

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T20:25:31.403

关联是指**类名**，所以：

```
class Foo < ActiveRecord::Base
  set_table_name 'example_foos'
  has_many :bars
end

class Bar < ActiveRecord::Base
  set_table_name 'example_bars'
  belongs_to :foo
end 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-21T20:25:03.307

如果您的模型和表具有不同的名称，您可以

```
class Foo <ActiveRecord::Base
  set_table_name "example_foos"
end 
```

其余协会按照 Rails 公约方式

# c++ - C++/Qt 中的精确宽度整数：typedef int qint32 真的正确吗？

> ID：10692051
> 
> 赞同：2
> 
> 时间：2012-05-21T20:21:51.920
> 
> 标签：c++, qt, cross-platform

Qt 文档说：

> **typedef qint8**
> 
> 有符号字符的 Typedef。这种类型保证在 Qt 支持的所有平台上都是 8 位的。
> 
> **typedef qint16**
> 
> Typedef 为有符号的缩写。这种类型保证在 Qt 支持的所有平台上都是 16 位的。
> 
> **typedef qint32**
> 
> 有符号整数的 Typedef。这种类型保证在 Qt 支持的所有平台上都是 32 位的。
> 
> **typedef qint64**
> 
> 用于 long long int 的 Typedef（Windows 上的 __int64）。这种类型保证在 Qt 支持的所有平台上都是 64 位的。

类型定义 `qglobal.h`如下：

```
/*
   Size-dependent types (architechture-dependent byte order)
   Make sure to update QMetaType when changing these typedefs
*/
typedef signed char qint8;         /* 8 bit signed */
typedef unsigned char quint8;      /* 8 bit unsigned */
typedef short qint16;              /* 16 bit signed */
typedef unsigned short quint16;    /* 16 bit unsigned */
typedef int qint32;                /* 32 bit signed */
typedef unsigned int quint32;      /* 32 bit unsigned */
//.... 
```

但是我想知道（例如）`qint32`在不能保证 32 位长的情况下如何总是`int`32 位长。~~据我所知，在 64 位架构上`int`s 是（或至少可以是）64 位长。~~[编辑：我错了。请参阅下面的评论。]

他们如何保证尺寸？他们为什么不使用`stdint`（和 __intN 在 Windows 平台上）？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-21T20:36:47.120

> 他们如何保证尺寸？

他们针对他们知道上述定义有效的特定平台。Qt 不关心其他平台，[其他平台](https://stackoverflow.com/questions/6971886/exotic-architectures-the-standard-committee-cares-about)也不关心 Qt。所以，它并不总是有效。但是在它不起作用的地方，Qt 也不会。

> 他们为什么不使用 stdint（以及 Windows 平台上的 __intN）？

有时，为您自己的项目维护 typedef`<stdint.h>`比有条件地在拥有它的平台上包含标准头文件*并*仍然为没有它的平台（例如 VS2005）维护一个备用文件更简单。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-21T20:42:55.617

Qt 支持许多平台，但重要的是平台的 64 位数据模型（或者更准确地说，编译器加平台的数据模型）。

大多数常见的 64 位平台使用 32 位整数，因为它们实现了某种形式的 LP64 数据模型。基于 ILP64 的数据模型（ILP64、SILP64 等）将整数定义为 64 位。但我不相信 Qt 支持任何这些[平台](http://doc.qt.nokia.com/4.7-snapshot/supported-platforms.html)。

查看[ILP64 wiki 页面](https://en.wikipedia.org/wiki/ILP64#Specific_C-language_data_models)和[PVS-Studio 支持页面，](http://www.viva64.com/en/a/0004/)其中包含一些很好的技术信息。

# java - javaCV UnsatisfiedLinkError

> ID：10692053
> 
> 赞同：2
> 
> 时间：2012-05-21T20:21:54.853
> 
> 标签：java, eclipse, ubuntu, javacv, unsatisfiedlinkerror

我对 JavaCV 有疑问。

我下载[了 javaCV-bin](http://code.google.com/p/javacv/downloads/detail?name=javacv-src-20120512.zip&can=2&q=)

我在 ubuntu 上的引用库中的项目中添加了 .jar 文件

我可以使用位于下载文件中的示例代码

但错误是

```
Exception in thread "main" java.lang.UnsatisfiedLinkError: /tmp/libjniopencv_core3835922554849797701.so: libopencv_core.so.2.4: cannot open shared object file: No such file or directory
at java.lang.ClassLoader$NativeLibrary.load(Native Method)
at java.lang.ClassLoader.loadLibrary0(ClassLoader.java:1750)
at java.lang.ClassLoader.loadLibrary(ClassLoader.java:1646)
at java.lang.Runtime.load0(Runtime.java:787)
at java.lang.System.load(System.java:1022)
at com.googlecode.javacpp.Loader.loadLibrary(Loader.java:403)
at com.googlecode.javacpp.Loader.load(Loader.java:342)
at com.googlecode.javacpp.Loader.load(Loader.java:316)
at com.googlecode.javacv.cpp.opencv_core.<clinit>(opencv_core.java:131)
at java.lang.Class.forName0(Native Method)
at java.lang.Class.forName(Class.java:264)
at com.googlecode.javacpp.Loader.load(Loader.java:335)
at com.googlecode.javacv.cpp.opencv_imgproc.<clinit>(opencv_imgproc.java:96)
at java.lang.Class.forName0(Native Method)
at java.lang.Class.forName(Class.java:264)
at com.googlecode.javacpp.Loader.load(Loader.java:335)
at com.googlecode.javacv.cpp.opencv_highgui.<clinit>(opencv_highgui.java:91)
at com.googlecode.javacv.OpenCVFrameGrabber.start(OpenCVFrameGrabber.java:171)
at MotionDetector.main(MotionDetector.java:23) 
```

我该如何解决这个问题？如何在 ubuntu 11.10 上配置 javaCV 以解决问题。

感谢您的帮助

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-08-13T04:52:52.543

老兄从链接下载库：

> [https://code.google.com/p/javacv/downloads/detail?name=javacv-0.5-cppjars.zip&can=2&q=](https://code.google.com/p/javacv/downloads/detail?name=javacv-0.5-cppjars.zip&can=2&q=)

并将库**opencv-linux-x86.jar**添加到您的项目中

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-21T20:33:44.817

自述文件在所需软件下说明：

> *** OpenCV 2.4.0 [http://sourceforge.net/projects/opencvlibrary/files/](http://sourceforge.net/projects/opencvlibrary/files/)** #

我猜这就是问题所在。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-12-01T17:42:58.120

当无法加载本机库或尝试创建程序的 jar 文件时，这将发挥作用。由于 .dll 文件大多是用 c/c++ 编写的，因此当您尝试运行程序时，jvm 无法将它们包含在 jar 文件中或给出链接错误。但是对于 openCV，您可以使用这块成功加载 dll 文件。

只需创建一个java类并复制粘贴此代码并使用该方法成功加载dll文件

```
 /**
     * The minimum length a prefix for a file has to have according to {@link File#createTempFile(String, String)}}.
     */
    private static final int MIN_PREFIX_LENGTH = 3;
    public static final String NATIVE_FOLDER_PATH_PREFIX = "nativeutils";

    /**
     * Temporary directory which will contain the DLLs.
     */
    private static File temporaryDir;

    /**
     * Private constructor - this class will never be instanced
     */
    private NativeUtils() {
    }

    /**
     * Loads library from current JAR archive
     * 
     * The file from JAR is copied into system temporary directory and then loaded. The temporary file is deleted after
     * exiting.
     * Method uses String as filename because the pathname is "abstract", not system-dependent.
     * 
     * @param path The path of file inside JAR as absolute path (beginning with '/'), e.g. /package/File.ext
     * @throws IOException If temporary file creation or read/write operation fails
     * @throws IllegalArgumentException If source file (param path) does not exist
     * @throws IllegalArgumentException If the path is not absolute or if the filename is shorter than three characters
     * (restriction of {@link File#createTempFile(java.lang.String, java.lang.String)}).
     * @throws FileNotFoundException If the file could not be found inside the JAR.
     */
    public static void loadLibraryFromJar(String path) throws IOException {

        if (null == path || !path.startsWith("/")) {
            throw new IllegalArgumentException("The path has to be absolute (start with '/').");
        }

        // Obtain filename from path
        String[] parts = path.split("/");
        String filename = (parts.length > 1) ? parts[parts.length - 1] : null;

        // Check if the filename is okay
        if (filename == null || filename.length() < MIN_PREFIX_LENGTH) {
            throw new IllegalArgumentException("The filename has to be at least 3 characters long.");
        }

        // Prepare temporary file
        if (temporaryDir == null) {
            temporaryDir = createTempDirectory(NATIVE_FOLDER_PATH_PREFIX);
            temporaryDir.deleteOnExit();
        }

        File temp = new File(temporaryDir, filename);

        try (InputStream is = NativeUtils.class.getResourceAsStream(path)) {
            Files.copy(is, temp.toPath(), StandardCopyOption.REPLACE_EXISTING);
        } catch (IOException e) {
            temp.delete();
            throw e;
        } catch (NullPointerException e) {
            temp.delete();
            throw new FileNotFoundException("File " + path + " was not found inside JAR.");
        }

        try {
            System.load(temp.getAbsolutePath());
        } finally {
            if (isPosixCompliant()) {
                // Assume POSIX compliant file system, can be deleted after loading
                temp.delete();
            } else {
                // Assume non-POSIX, and don't delete until last file descriptor closed
                temp.deleteOnExit();
            }
        }
    }

    private static boolean isPosixCompliant() {
        try {
            return FileSystems.getDefault()
                    .supportedFileAttributeViews()
                    .contains("posix");
        } catch (FileSystemNotFoundException
                | ProviderNotFoundException
                | SecurityException e) {
            return false;
        }
    }

    private static File createTempDirectory(String prefix) throws IOException {
        String tempDir = System.getProperty("java.io.tmpdir");
        File generatedDir = new File(tempDir, prefix + System.nanoTime());

        if (!generatedDir.mkdir())
            throw new IOException("Failed to create temp directory " + generatedDir.getName());

        return generatedDir;
    } 
```

# android - SwitchPreference（前 ICS）的兼容性？

> ID：10692054
> 
> 赞同：8
> 
> 时间：2012-05-21T20:22:03.777
> 
> 标签：android, android-preferences, preferenceactivity

ICS中`SwitchPreference`引入的 android-support-v4 库是否兼容？我正在尝试更新一些旧项目，并希望尽可能使用 SwitchPreferences。

我知道我可以制作一个单独的资源文件来区分 API 版本，但我想尽可能避免这种情况。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-21T23:32:19.397

> ICS 中引入的 SwitchPreference 是否兼容 android-support-v4 库？

不，对不起。

> 但是，如果有人还没有向后移植它，那么向后移植它应该不会太棘手。

实际上，这可能有点痛苦，因为它还需要 Switch 的反向移植，并且反向移植小部件有时很麻烦，因为它们经常使用反向移植无法访问的包私有方法。

> 我知道我可以制作一个单独的资源文件来区分 API 版本，但我想尽可能避免这种情况。

好吧，这肯定比替代方案简单得多：

*   上述反向移植

*   创建某种别名`Preference`机制，允许您`SwitchPreference`在较新的设备和`CheckBoxPreference`只有一个资源文件的较旧设备上使用

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-10-24T16:01:27.553

android-switch-backport 有一个适用于 Android 2.1+ 的 SwitchPreference。

[https://github.com/BoD/android-switch-backport](https://github.com/BoD/android-switch-backport)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-22T02:51:06.417

我已经尝试了我找到的所有解决方案，但没有一个适合我的需求，所以我创建了自己的小部件，它使用了来自 NineOld 兼容性库的 ObjectAnimator，并且在任何 android API 上都可以正常工作。

```
import android.widget.RelativeLayout;
import com.myapp.utilities.AppUtils;
import com.nineoldandroids.animation.Animator;
import com.nineoldandroids.animation.AnimatorListenerAdapter;
import com.nineoldandroids.animation.ObjectAnimator;

public class SwitchButton extends RelativeLayout {

public static final int TEXT_SIZE = 11;

public float HANDLE_SHIFT = -40f;
public float TEXT_RIGHT_SHIFT = 40f;
public static int BUTTON_ID = 0x00009999;
public static int TEXT_ID = 0x00008888;

private Button handleButton;
private RoboTextView textView;
private boolean switchEnabled;
private String yesStr;
private String noStr;
private int TEXT_LEFT_PADDING = 13;

private ObjectAnimator animateHandleLeftShift;
private ObjectAnimator animateHandleRightShift;
private int HANDLE_BUTTON_HEIGHT = 22;
private int HANDLE_BUTTON_WIDTH = 42;
private ObjectAnimator animateTextLeftShift;
private ObjectAnimator animateTextRightShift;

public SwitchButton(Context context) {
    super(context);
    onCreate(context);
}

private void onCreate(Context context) {

    float density = context.getResources().getDisplayMetrics().density;

    TEXT_LEFT_PADDING *= density;

    HANDLE_BUTTON_HEIGHT *= density;
    HANDLE_BUTTON_WIDTH *= density;

    HANDLE_SHIFT *= density;
    TEXT_RIGHT_SHIFT *= density;

    yesStr = getContext().getString(R.string.yes).toUpperCase();
    noStr = getContext().getString(R.string.no).toUpperCase();

    {// Button
        handleButton = new Button(getContext());
        RelativeLayout.LayoutParams buttonParams = new LayoutParams(HANDLE_BUTTON_WIDTH, HANDLE_BUTTON_HEIGHT);
        buttonParams.addRule(RelativeLayout.CENTER_VERTICAL);
        buttonParams.addRule(RelativeLayout.ALIGN_PARENT_RIGHT);

        handleButton.setBackgroundResource(R.drawable.button_switch_handle_selector);
        handleButton.setId(BUTTON_ID);

        addView(handleButton, buttonParams);
    }

    {// Text
        textView = new RoboTextView(getContext());
        LayoutParams textParams = new LayoutParams(ViewGroup.LayoutParams.WRAP_CONTENT, ViewGroup.LayoutParams.WRAP_CONTENT);
        textParams.addRule(RelativeLayout.CENTER_VERTICAL);

        textView.setText(yesStr);
        textView.setTextColor(getContext().getResources().getColor(R.color.new_normal_gray));
        textView.setTextSize(TypedValue.COMPLEX_UNIT_DIP, TEXT_SIZE);
        textView.setPadding(TEXT_LEFT_PADDING, 0, 0, 0);
        textView.setFont(RoboTextView.ROBOTO_BOLD_FONT);
        textView.setId(TEXT_ID);
        float shadowRadius = 0.5f ;
        float shadowDx = 0;
        float shadowDy = 1;
        textView.setShadowLayer(shadowRadius, shadowDx, shadowDy, Color.BLACK);

        addView(textView, textParams);
    }
    initFlipAnimation();

}

@Override
public void setOnClickListener(OnClickListener l) {
    handleButton.setOnClickListener(l);
    textView.setOnClickListener(l);
}

public void toggle(View view){
    if (AppUtils.HONEYCOMB_PLUS_API && view.getId() == TEXT_ID) { // ignore text clicks
        return;
    }

    switchEnabled = !switchEnabled;

    if (switchEnabled) {
        // animate handle to the left
        animateHandleLeftShift.start();
        animateTextLeftShift.start();

        textView.setText(noStr);
    } else {
        animateHandleRightShift.start();
        animateTextRightShift.start();

        textView.setText(yesStr);
    }
}

private android.view.animation.Interpolator accelerator = new LinearInterpolator();
private static final int DURATION = 70;

private void initFlipAnimation() {

    animateHandleLeftShift = ObjectAnimator.ofFloat(handleButton, "translationX", 0f, HANDLE_SHIFT);
    animateHandleLeftShift.setDuration(DURATION);
    animateHandleLeftShift.setInterpolator(accelerator);

    animateHandleRightShift = ObjectAnimator.ofFloat(handleButton, "translationX", HANDLE_SHIFT, 0f);
    animateHandleRightShift.setDuration(DURATION);
    animateHandleRightShift.setInterpolator(accelerator);

    animateHandleLeftShift.addListener(new AnimatorListenerAdapter() {
        @Override
        public void onAnimationEnd(Animator anim) {
            // TODO
        }
    });

    animateTextLeftShift = ObjectAnimator.ofFloat(textView, "translationX", 0f, TEXT_RIGHT_SHIFT);
    animateTextLeftShift.setDuration(DURATION);
    animateTextLeftShift.setInterpolator(accelerator);

    animateTextRightShift = ObjectAnimator.ofFloat(textView, "translationX", TEXT_RIGHT_SHIFT, 0f);
    animateTextRightShift.setDuration(DURATION);
    animateTextRightShift.setInterpolator(accelerator);
} 
```

}

在 XML 中

```
<com.chess.SwitchButton
    android:id="@+id/ratedGameSwitch"
    android:layout_width="@dimen/button_switch_width"
    android:layout_height="@dimen/button_switch_height"
    android:background="@drawable/button_switch_back"
    /> 
```

在 Activity/Fragment 中，您只需要 findViewById 并将 clickListener 设置为它，然后在 onClick 回调中处理它：

```
switchButton = (SwitchButton) optionsView.findViewById(R.id.ratedGameSwitch);
switchButton.setOnClickListener(this);

@Override
public void onClick(View view) {
    if (view.getId() == SwitchButton.BUTTON_ID  || view.getId() == SwitchButton.TEXT_ID){
        switchButton.toggle(view);
    }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-03-15T19:36:24.387

如果您想以编程方式创建设置活动，请尝试此解决方案。

```
public class SettingsActivity extends PreferenceActivity {

    @TargetApi(Build.VERSION_CODES.ICE_CREAM_SANDWICH)
    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        PreferenceScreen rootScreen = getPreferenceManager()
                .createPreferenceScreen(this);
        setPreferenceScreen(rootScreen);
        Preference NotifCheck=null;
        if (Build.VERSION.SDK_INT >= Build.VERSION_CODES.ICE_CREAM_SANDWICH) {
            NotifCheck = new SwitchPreference(this);

        } else {
            NotifCheck = new CheckBoxPreference(this);

        }
        NotifCheck.setKey("yourKey");
        NotifCheck.setTitle(R.string.ShowNotification);
        NotifCheck.setEnabled(true);
        rootScreen.addPreference(NotifCheck);
    }
} 
```

# sencha-touch-2 - List 之间的变量

> ID：10692056
> 
> 赞同：2
> 
> 时间：2012-05-21T20:22:15.273
> 
> 标签：sencha-touch-2

我的问题是......我有一个由商店完成的列表，这个商店来自代理（json）。当我点击列表中的一个项目时，我需要一个详细信息，而这个详细信息来自另一个 json。

例如：

ArtistList 和 ArtistDetail

当我单击艺术家列表的一个项目时，我需要调用

```
http://localhost/json-detail/45 
```

如果我点击另一个项目...

```
http://localhost/json-detail/50 etc... 
```

我的问题是我无法将参数发送到另一个视图......或者错误可能在我的列表概念中......：S

这是我的列表视图：

```
var listaArtistas = {
        xtype: 'list',
        title: 'Artistas',
        height: 240,
        store: {
            autoLoad: true,
            fields: ['node'],
            proxy: {
                type: 'ajax',
                url: 'http://localhost/json-artistas',

                reader: {
                    type: 'json',
                    rootProperty: 'nodes'
                }
            }
        },
        listeners: {
            itemtap: function(lista,index,target,record,e,eOpts)
            {

                var artistDetail = new Ext.create('app.view.ArtistDetail');
                artistDetail.setArtistID('45');
                panelHomeNav.push(artistDetail);

            }
        },

        itemTpl: tpl

        }; 
```

这是我的详细信息：

```
Ext.define('app.view.ArtistDetail',{
extend: 'Ext.Panel',
xtype: 'artistdetail',
style: "background-image:url('/resources/images/fondoartista.png');",

config:{
    title: 'Artistas',
    iconCls: 'star',
    ArtistID: '',
    items:
    {
        title: 'Artistas',
        items: [artistDetailPanelContenedor]
    }
}}); 
```

需要这样的东西

```
var listaEspectaculo = {
        xtype: 'list',
        title: 'Artistas',
        store:
        {
            autoLoad: true,
            fields: ['node'],
            proxy: {
                type: 'ajax',
                url: 'http://localhost/json-artistasdetail/'+getArtistID, <<<<<<<<<<------ PROBLEM

                reader: {
                    type: 'json',
                    rootProperty: 'nodes'
                }
            }
        },
        listeners: {
            itemtap: function(lista,index,target,record,e,eOpts)
            {
                var eventDetail = new Ext.create('app.view.EventDetail');
                panelHomeNav.push(eventDetail);                 
            }
        },          
        itemTpl: tplEspectaculo

}; 
```

求救！！！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-10T22:14:03.640

也许这会有所帮助： [如何在 sencha touch 中将值从控制器传递到数据存储](https://stackoverflow.com/questions/8014499/how-to-pass-value-from-controller-to-data-store-in-sencha-touch)

```
handler: function () {
    Ext.dispatch({
        controller: MyApp.controllers.controller,
        action: 'myActionOnController',
        id: e.get{'id'}
    });
} 
```

你可以从你的“itemtap”调用 ext.dispatch，然后在控制器中你可以用你的参数调用一个新的视图，记住使用这样的东西：

```
myActionOnController: function (options) {
    var city = options.id; //if you want to use your parameters
    var newView = Ext.create('MyApp.view.viewOfSomething');
    this.getMain().push(newView);
}, 
```

# php - 在 GWT 和 PHP 之间传递数据

> ID：10692061
> 
> 赞同：2
> 
> 时间：2012-05-21T20:22:30.813
> 
> 标签：php, json, gwt

我是 GWT 和 PHP 的新手，在阅读了一些教程之后，我不清楚如何在 GWT 前端和 PHP 后端之间有效地交换数据。我成功地遵循了建议使用 RequestBuilder 类从 PHP 获取数据的 Google 教程。但是当我需要保存在 GWT 中完成的工作时，如何高效地将数据传递给 PHP？我不清楚如何使用 RequestBuilder 来完成这项任务。我现在找到的解决方案是

```
RequestBuilder builder = new RequestBuilder(RequestBuilder.POST, URL.encode(url));
    builder.setHeader("Content-Type", "application/json");
        try {
              Request request = builder.sendRequest("{\"done\":false,\"description\":\"Some text\",\"priority\":0}", new RequestCallback() {... 
```

在 PHP 方面

```
$arr = json_decode(file_get_contents("php://input"),true);
$done = (int)$arr['done'];
$description = $arr['description'];
$priority = $arr['priority'];
mysql_query("INSERT INTO Tasks (done, description, priority)
    VALUES ($done, '$description', $priority)"); 
```

这是最好的方法吗？有人在网上找到了一个可行的例子吗？欢迎任何意见...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-22T06:41:39.253

我认为，在与非 Java 服务器交互时使用 JSON 很好。您可以使用 JSON 模块以更安全的方式在客户端构建 JSON 字符串：

在您的 .gwt.xml 文件中添加

```
<inherits name='com.google.gwt.json.JSON'/> 
```

然后你可以构造你的示例字符串，如

```
final JSONObject jsonObject = new JSONObject();

jsonObject.put("done", JSONBoolean.getInstance(false));
jsonObject.put("description", new JSONString("Some text"));
jsonObject.put("priority", new JSONNumber(0));

final String jsonString = jsonObject.toString(); 
```

# xml - 如何在 R（https 链接）中抓取安全页面（使用 XML 包中的 readHTMLTable）？

> ID：10692066
> 
> 赞同：19
> 
> 时间：2012-05-21T20:22:56.650
> 
> 标签：xml, r, web-scraping

关于如何使用 XML 包中的 readHTMLTable 有很好的答案，我用常规的 http 页面做到了，但是我无法解决 https 页面的问题。

我正在尝试阅读此网站上的表格（网址字符串）：

```
library(RTidyHTML)
library(XML)
url <- "https://ned.nih.gov/search/ViewDetails.aspx?NIHID=0010121048"
h = htmlParse(url)
tables <- readHTMLTable(url) 
```

但我收到此错误：文件[https](https://ned.nih.gov/search/Vi...does) ://ned.nih.gov/search/Vi...不存在。

我试图通过这个（下面的前 2 行）解决 https 问题（从使用谷歌找到解决方案（比如这里：[http ://tonybreyal.wordpress.com/2012/01/13/ra-quick-scrape-of -来自 boxofficemojo-com/ 的票房最高的电影](http://tonybreyal.wordpress.com/2012/01/13/r-a-quick-scrape-of-top-grossing-films-from-boxofficemojo-com/)）。

这个技巧有助于查看更多页面，但任何提取表格的尝试都不起作用。任何建议表示赞赏。我需要像组织、组织标题、经理这样的表字段。

```
 #attempt to get past the https problem 
 raw <- getURL(url, followlocation = TRUE, cainfo = system.file("CurlSSL", "cacert.pem", package = "RCurl"))
 head(raw)
[1] "\r\n<!DOCTYPE html PUBLIC \"-//W3C//DTD XHTML 1.0 Transitional//EN\" \"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd\">\n<html xmlns=\"http://www.w3.org/1999/xhtml\" xml:lang=\"en\" lang=\"en\">\n<head>\n<meta http-equiv=\"Content-Type\" content=\"text/html; 
...
 h = htmlParse(raw)
Error in htmlParse(raw) : File ...
tables <- readHTMLTable(raw)
Error in htmlParse(doc) : File ... 
```

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2012-05-22T04:58:06.570

新包`httr`提供了一个包装器`RCurl`，可以更轻松地抓取各种页面。

尽管如此，这个页面还是给我带来了很多麻烦。以下工作，但毫无疑问，有更简单的方法来做到这一点。

```
library("httr")
library("XML")

# Define certicificate file
cafile <- system.file("CurlSSL", "cacert.pem", package = "RCurl")

# Read page
page <- GET(
  "https://ned.nih.gov/", 
  path="search/ViewDetails.aspx", 
  query="NIHID=0010121048",
  config(cainfo = cafile)
)

# Use regex to extract the desired table
x <- text_content(page)
tab <- sub('.*(<table class="grid".*?>.*</table>).*', '\\1', x)

# Parse the table
readHTMLTable(tab) 
```

结果：

```
$ctl00_ContentPlaceHolder_dvPerson
                V1                                      V2
1      Legal Name:                    Dr Francis S Collins
2  Preferred Name:                      Dr Francis Collins
3          E-mail:                 francis.collins@nih.gov
4        Location: BG 1 RM 1261 CENTER DRBETHESDA MD 20814
5       Mail Stop:                                       Â
6           Phone:                            301-496-2433
7             Fax:                                       Â
8              IC:             OD (Office of the Director)
9    Organization:            Office of the Director (HNA)
10 Classification:                                Employee
11            TTY:                                       Â 
```

* * *

`httr`到这里：[http](http://cran.r-project.org/web/packages/httr/index.html) : //cran.r-project.org/web/packages/httr/index.html

* * *

**编辑：**`RCurl`关于包的常见问题的有用页面： [http ://www.omegahat.org/RCurl/FAQ.html](http://www.omegahat.org/RCurl/FAQ.html)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-22T17:57:06.730

使用 Andrie 克服 https 的好方法

下面还提供了一种无需 readHTMLTable 即可获取数据的方法。

A table in HTML may have an ID. In this case the table has one nice one and the XPath in getNodeSet function does it nicely.

```
# Define certicificate file
cafile <- system.file("CurlSSL", "cacert.pem", package = "RCurl")
# Read page
page <- GET(
  "https://ned.nih.gov/", 
  path="search/ViewDetails.aspx", 
  query="NIHID=0010121048",
  config(cainfo = cafile, ssl.verifypeer = FALSE)
)

h = htmlParse(page)
ns <- getNodeSet(h, "//table[@id = 'ctl00_ContentPlaceHolder_dvPerson']")
ns 
```

I still need to extract the IDs behind the hyperlinks.

for example instead of collen baros as manager, I need to get to the ID 0010080638

Manager:Colleen Barros

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-01-21T06:09:11.853

This is the function I have to deal with this problem. Detects if https in url and uses httr if it is.

```
readHTMLTable2=function(url, which=NULL, ...){
 require(httr)
 require(XML)
 if(str_detect(url,"https")){
    page <- GET(url, user_agent("httr-soccer-ranking"))
    doc = htmlParse(text_content(page))
    if(is.null(which)){
      tmp=readHTMLTable(doc, ...)
      }else{
        tableNodes = getNodeSet(doc, "//table")
        tab=tableNodes[[which]]
        tmp=readHTMLTable(tab, ...) 
      }
  }else{
    tmp=readHTMLTable(url, which=which, ...) 
  }
  return(tmp)
} 
```

# c++ - 用于在移动设备上存储来自数千个文件的数据的结构

> ID：10692068
> 
> 赞同：1
> 
> 时间：2012-05-21T20:23:09.723
> 
> 标签：c++, sqlite

我有超过 32000 个存储某种空间数据的二进制文件。我通过文件名访问数据。这些文件的大小范围为 0-400kb。我需要能够在不同的时间点随机访问这些文件的内容。我不喜欢在移动设备上安装 32000 多个单独的数据文件的想法（即使总文件大小小于 100mb）。我想将文件合并到一个结构中，这样我仍然可以快速访问所需的数据。我想建议最好的方法是什么。任何建议都应具有用于访问数据的 C/C++ 库，并且应具有自由许可证，允许包含在商业、闭源应用程序中而不会出现任何问题。

到目前为止，我唯一想到的是将所有内容存储在 sqlite 数据库中，尽管我不确定这是否是最好的方法，或者我需要考虑哪些注意事项来存储具有快速查找时间的 blob 数据（即，我将使用什么模式）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-21T21:23:09.913

为什么不自己滚动？

您的要求听起来非常简单直接。只需将所有内容捆绑到一个二进制文件中，并在开头添加一个索引，说明哪个文件从哪里开始以及它是多少位。

最多 30 行 C++ 代码。花 10 分钟时间为它设计一个好的接口，这样你就可以在需要时替换实现。

当然，如果数据是只读的。如果您需要随时更改它，它会很快变得毛茸茸。

# windows - 伪变量

> ID：10692070
> 
> 赞同：-1
> 
> 时间：2012-05-21T20:23:29.033
> 
> 标签：windows, executable, exe, portable-executable

有人可以解释一下什么是伪变量，下面的函数 WinMain 的第一个参数到底是什么？

```
GetStartupInfo(&StartupInfo);
int nMainRetVal = WinMain((HINSTANCE)&__ImageBase, NULL, pszCommandLineAnsi,
   (StartupInfo.dwFlags & STARTF_USESHOWWINDOW)
      ? StartupInfo.wShowWindow : SW_SHOWDEFAULT); 
```

还有下面的语句是做什么的？？

```
extern "C" const IMAGE_DOS_HEADER __ImageBase; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-22T05:25:55.357

__ImageBase 是[“来自静态库的当前模块的 HINSTANCE”](http://blogs.msdn.com/b/oldnewthing/archive/2004/10/25/247180.aspx)。这是链接器提供的所谓的伪变量。这个伪变量是模块在内存中加载的地址。使用此伪变量，您可以直接从内存访问映射的图像并寻址其内容。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-21T20:32:35.637

的第一个参数`WinMain`是所谓的“应用程序实例句柄”。这个东西起源于古老的 Windows 3.x 时代，它表示应用程序正在运行的实例的句柄。但是从Win32开始（Windows 9x/NT）这个参数是进程虚拟地址空间中的可执行模块映射的基地址。

因此，您看到的是图像基地址`__ImageBase`，它被转换为`HINSTANCE`以满足`WinMain`签名。

现在，`__ImageBase`- 我猜它是一个构建时生成的结构，它恰好位于图像起始地址。

而且，我不确定什么是“伪变量”。但也许这正是`__ImageBase`。

# c++ - 如何在 boost::spirit 规则中使用 boost::tuple 作为属性？

> ID：10692071
> 
> 赞同：6
> 
> 时间：2012-05-21T20:23:29.550
> 
> 标签：c++, boost, boost-spirit, boost-spirit-qi

我有以下规则`boost::spirit`：

```
typedef boost::tuple<int, int> Entry;
qi::rule<Iterator, Entry(), Skipper> entry;
entry = qi::int_ >> qi::int_; 
```

但是第二个`int`没有写入元组。有没有办法让它工作*而*不必使用`boost::fusion::tuple`？

如果我使用它可以工作`std::pair`，那为什么我不能使用`boost::tuple`？

这是一个完整的编译示例：

```
#include <iostream>
#include <boost/spirit/include/qi.hpp>
#include <boost/fusion/include/tuple.hpp>
#include <boost/tuple/tuple.hpp>
namespace qi = boost::spirit::qi;

// works:
// #include <boost/fusion/include/std_pair.hpp>
// typedef std::pair<int, int> Entry;

// doesn't work:
typedef boost::tuple<int, int> Entry;

template <typename Iterator, typename Skipper>
struct MyGrammar : qi::grammar<Iterator, Entry(), Skipper> {
  MyGrammar() : MyGrammar::base_type(entry) {
    entry = qi::int_ >> qi::int_;
  }
  qi::rule<Iterator, Entry(), Skipper> entry;
};

int main() {
  const std::string in = "1 3";
  typedef std::string::const_iterator It;
  It it = in.begin();

  Entry entry;
  MyGrammar<It, qi::space_type> gr;
  if (qi::phrase_parse(it, in.end(), gr, qi::space, entry)
      && it == in.end()) {
    std::cout << boost::get<0>(entry) << "," << boost::get<1>(entry) << std::endl;
  }
  return 0;
} 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-05-21T21:01:20.653

为了让 Spirit 识别`boost::tuple<>`为有效的 Fusion 序列，您需要包含一个额外的标题：

```
#include <boost/fusion/include/boost_tuple.hpp> 
```

[这在此处](http://www.boost.org/libs/fusion/doc/html/fusion/adapted/boost__tuple.html)的文档中有所暗示。

# javascript - 我应该使用哪个库在 Node.JS 上进行服务器端图像处理？

> ID：10692075
> 
> 赞同：120
> 
> 时间：2012-05-21T20:23:37.507
> 
> 标签：javascript, image, node.js, image-processing, image-manipulation

我在 Node.JS wiki 上找到了相当[多的可用库列表，](https://github.com/joyent/node/wiki/modules#wiki-graphics)但我不确定其中哪些更成熟并提供更好的性能。基本上我想做以下事情：

1.  从外部资源加载一些图像到服务器
2.  把它们放在一张大画布上
3.  裁剪并掩盖它们
4.  应用一两个过滤器
5.  调整最终图像的大小并提供指向它的链接

如果 node 包在 Linux*和 Windows*上都可以工作，那就大加分了。

* * *

## 回答 #1

> 赞同：193
> 
> 时间：2012-05-23T09:58:35.603

*回答我自己的问题*

我花了两天时间研究 Node.js 图形库。

[**节点画布**](https://github.com/learnboost/node-canvas)

*   由于我对`<canvas>`API 非常熟悉，所以我先尝试了它。对于图书馆来说，这是一个巨大的优势。
*   它需要 Cairo，它没有简单的 Windows 下载。我在 GTK+ 发行版中找到了它。
*   此外，它需要在模块安装时编译本机库绑定代码。它使用尚未移植到 Windows 的 Node-Waf。

[**通用汽车**](https://github.com/aheckmann/gm)

*   成熟
*   在 Windows 上流畅运行
*   文档还可以，*但*不彻底：我不得不查看源代码以找出可用的 API
*   不幸的是，没有简单的方法将图像与 gm 结合起来。也许有一些方法可以实现这一点，但在花了两个小时后我还没有找到一个。

[**节点图像魔术**](https://github.com/yourdeveloper/node-imagemagick)

*   官方 repo 几乎没有涵盖基本的 ImageMagick 命令，但我使用[了这个 fork](https://github.com/msealand/node-imagemagick)（好在 NPM 可以直接从 git 存储库中提取库）。`montage`它具有完全符合我需要的绑定。
*   [ImageMagick 很慢](http://www.graphicsmagick.org/benchmarks.html#the-benchmark)，虽然它可以在 Windows 上运行。

[**节点贵宾**](https://github.com/dosx/node-vips)

*   巨大的优势：它使用了我熟悉的令人难以置信的[VIPS 库。](http://www.vips.ecs.soton.ac.uk/)VIPS 速度非常快，并且针对大图像进行了优化。利用硬件资源非常聪明：如果您的机器有大量 RAM，它将在内存中完成所有处理，但如果内存稀缺或其他应用程序需要，则会切换到硬盘缓存。
*   与 node-canvas 相同，它需要 Node-Waf，因此它尚不适用于 Windows。

我还查看了列表中的其他库，但其中大多数要么非常不成熟，要么不适合我的用例。当 Node-Waf 被移植到 Windows 时，我真的很想尝试迁移到 Node-Canvas 或 Node-Vips，但在那之前我会坚持使用 node-imagemagick。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-05-22T19:12:58.940

我强烈建议您使用 GraphicsMagick检查[gm 。](http://aheckmann.github.com/gm/)稳定、功能丰富、API 干净、文档很棒、速度很快。

它适用于 Windows 和 Linux / MacOS / BSD / ...

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-09-29T08:55:14.280

她是基于 GDI+ 的画布实现的[链接](https://bitbucket.org/pastorgluk/node-canvas-win)

# python - 根据模型字段限制查询集结果，有更好的方法吗？

> ID：10692076
> 
> 赞同：1
> 
> 时间：2012-05-21T20:23:40.047
> 
> 标签：python, django, django-queryset, django-piston

基本上我想为每个主机获取最新的 30 个日志条目。目前我正在 django-piston 中执行此操作。

```
def read(self,request):
    val={}
    for x in Host.objects.all():
        val[x.uuid_id]=DataLog.objects.filter(host=x).order_by('-time')[:30]           
    return val 
```

不幸的是，这个请求需要很长时间（目前大约 10k 数据库条目需要 1 秒）。有没有更有效的方法来做到这一点？

哈珀

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-22T08:52:53.183

如果您使用 PostgreSQL 作为数据库后端并且不需要跨数据库兼容性，您可以使用[强大的窗口函数](http://www.postgresql.org/docs/9.1/static/functions-window.html)来实现类似的功能：

想象一下你的桌子是这样的：

```
CREATE TABLE x (
    i serial primary key,
    value integer not null,
    date timestamp,
    category text); 
```

您需要每个类别的最新值。你会去做的 ：

```
SELECT
    first_value(i) over w,
    first_value(value) over w,
    first_value(date) over w
    category,
FROM x
WINDOW w AS (PARTITION BY category ORDER BY date DESC); 
```

`raw`您可以通过查询集管理器上的方法在 django 中使用这样的查询：

```
ModelX.objects.raw("""SELECT DISTINCT ....... FROM x WINDOW w .....""") 
```

要按类别获取最后 N 个条目，查询稍微复杂一些，并涉及一个子查询：

```
SELECT i, value, date, category
FROM (SELECT
        i, value, date, category,
        row_number() over w
    FROM x
    WINDOW w AS (PARTITION BY category ORDER BY date DESC)) AS subquery
WHERE subquery.row_number <= 30; 
```

看到这一点，你甚至可以做一个视图：

```
CREATE VIEW x_with_reverse_date_index AS
    (SELECT
        i, value, date, category,
        row_number() over w
    FROM x
    WINDOW w AS (PARTITION BY category ORDER BY date DESC)); 
```

并创建一个查询此视图的 django 模型：

```
class ModelX(models.Model):
    ...
    ...
    row_number = models.IntegerField("Row number when ordering by date desc")

    class Meta:
        db_table = 'x_with_reverse_date_index' 
```

并“正常”查询它：

```
ModelX.objects.filter(category__in = ('catA','catB'), row_number__lte = 30)
ModelX.objects.filter(row_number = 29)
... 
```

**警告**：同样，如果您需要在另一个数据库引擎上工作的代码，请不要这样做。

# ios - 从对象中检索数据

> ID：10692083
> 
> 赞同：0
> 
> 时间：2012-05-21T20:24:05.443
> 
> 标签：ios, ios5

我对 iOS 开发非常陌生。我正在尝试通过表格视图中的 segue 传递一些数据。这是我调用传递数据的方法：

```
- (void)prepareForSegue:(UIStoryboardSegue *)segue sender:(id)sender {
if([segue.identifier isEqualToString:@"ShowContactDetails"]) {
    ContactDetailsViewController *dvc = [segue destinationViewController];
    NSIndexPath *path = [self.tableView indexPathForSelectedRow];
    Contact *c = [jsonResults objectAtIndex:path.row];
    [dvc setSelectedContact:c];
    }
} 
```

它通过了，当我做 a `NSLog`on 时`selectedContact`，这就是我得到的：

```
2012-05-21 15:15:42.410 Test[8352:f803] {
category = Prospect;
id = 19895;
label = "John  Doe";
} 
```

问题是，我不知道如何单独访问这些项目。我试图打电话给类似的东西，`objectForKey`但我得到了一个错误。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-21T20:32:06.750

从 NSLog 的输出来看， selectedContact 似乎是一个 NSDictionary 对象。尝试使用 [selectedContact valueForKey] 而不是 [selectedContact objectForKey]。

例如：

```
NSLog(@"Name: %@", [selectedContact valueForKey:@"label"]); 
```

# java - 简单的正则表达式匹配

> ID：10692087
> 
> 赞同：1
> 
> 时间：2012-05-21T20:24:12.013
> 
> 标签：java, regex

如果最后一个字符以大写字母加数字结尾，我想创建一个生成匹配项并去掉 $ 和最后两个字符的正则表达式。

```
I'll strip off the $ and then an ending capital letter + number:

$mytestA1 --> expected output: mytest
$againD4 --> expected output: again
$something --> expected output: something
$name3 --> expected output: name3 // because there was no capital letter before the number digit
$name2P4 --> expected output: name2 
```

我将在我的代码中进行“if”检查，以检查 $ 的存在，然后我什至会费心运行正则表达式。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T20:41:38.230

这可能不是最有效的，但它会工作......

```
\$([^\s]*)(?:[A-Z]\d)|\$([^\s]*) 
```

它之所以有效，是因为第一组找到所有那些有 Capitol 后跟数字的人……而第二组找到所有没有后缀的人……

如果您从捕获组中获得匹配项，那就是您想要的。

我认为这样的事情会奏效......

```
import java.io.Console;
import java.util.regex.Pattern;
import java.util.regex.Matcher;

public class HereYouGo {
    public static void main (String args[]) {

        String input = "$mytestA1 --> expected output: mytest\r\n$againD4 --> expected output: again\r\n$something --> expected output: something\r\n$name3 --> expected output: name3 // because there was no capital letter before the number digit\r\n$name2P4 --> expected output: name2\r\n";      

        Pattern myPattern = Pattern.compile("\\$([^ ]*)(?:[A-Z]\\d)|\\$([^ ]*)", Pattern.DOTALL | Pattern.MULTILINE);

        Matcher myMatcher = myPattern.matcher(input);

        while(myMatcher.find())
        {
            String group1 = myMatcher.group(1);
            String group2 = myMatcher.group(2);

            //note: this should probably be changed in the case neither match is found
            System.out.println( group1!=null? group1 : group2 );
        }
    }
} 
```

这将输出以下内容

```
mytest
again
something
name3
name2 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-21T20:49:01.767

在 Java 中只需使用 String#replaceAll：

```
String replaced = str.replaceAll("^\\$|[A-Z]\\d$", ""); 
```

# asp.net-mvc - ASP.Net MVC：在子操作中更改 ViewData

> ID：10692091
> 
> 赞同：1
> 
> 时间：2012-05-21T20:24:28.860
> 
> 标签：asp.net-mvc, controller, children

我的 _Layout.cshtml 中有以下内容：

```
<title>@ViewData["PageTitle"]</title> 
```

然后我有一个被调用的子操作，我希望能够在该控制器操作中设置更改此值。

这可能吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-22T06:45:02.277

You could try using the parent context. In your `_Layout.cshtml`:

```
<title>@ViewContext.ViewData["PageTitle"]</title> 
```

and in your child action:

```
[ChildActionOnly]
public ActionResult Foo()
{
    ControllerContext.ParentActionViewContext.ViewData["PageTitle"] = "foo";
    return View();
} 
```

# c# - 如何在不触发 PageSizeChanged 事件的情况下以编程方式设置 RadGrid 的页面大小

> ID：10692092
> 
> 赞同：2
> 
> 时间：2012-05-21T20:24:31.093
> 
> 标签：c#, asp.net, webforms, telerik

我正在使用带有自定义分页的 Telerik RadGrid。我的问题是，当我手动设置页面大小时，PageSizeChanged 事件被触发并将我的代码抛出一个无限循环。作为 hack，我创建了一个在 PageSizeChanged 事件被触发时设置的布尔值。如何在 RadGrid 控件上设置页面大小而不触发 PageSizeChanged 事件？

```
private bool PageSizeChanged
{
    get { return Convert.ToBoolean(ViewState["PageSizeChanged"]); }
    set { ViewState["PageSizeChanged"] = value; }
}

protected void RadGrid1_PageSizeChanged(object sender, GridPageSizeChangedEventArgs e)
{
    if (!PageSizeChanged)
    {
        PageSizeChanged = true;
        RadGrid1.PageSize = e.NewPageSize;
    }

    PageSizeChanged = false;                        
    RadGrid1.Rebind();
} 
```

更新：我现在有一个我喜欢的解决方案。我最终从调用列表中删除了事件处理程序，设置了页面大小，然后将事件添加回调用列表。

```
protected void RadGrid1_PageSizeChanged(object sender, GridPageSizeChangedEventArgs e)
{
    RadGrid1.PageSizeChanged -= RadGrid1_PageSizeChanged;
    RadGrid1.PageIndex = 0;
    RadGrid1.PageSize = e.NewPageSize;
    RadGrid1.Rebind();
    RadGrid1.PageSizeChanged += RadGrid1_PageSizeChanged;
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-23T07:09:55.433

尝试这个-

```
protected void RadGrid1_PageSizeChanged(object source, GridPageSizeChangedEventArgs e) 
    {                
       RadGrid1.PageSizeChanged-=new GridPageSizeChangedEventHandler(RadGrid1_PageSizeChanged);
       RadGrid1.PageSize =  e.NewPageSize;

      RadGrid1.PageSizeChanged += new GridPageSizeChangedEventHandler(RadGrid1_PageSizeChanged);

      RebindGrid();
    } 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-21T21:03:20.700

删除 RadGrid1_PageSizeChanged，并将页面大小设置为 -

```
RadGrid1.MasterTableView.PageSize = CustomerPageSize; 
```

# c# - 获取导致程序崩溃而不处于调试模式的异常

> ID：10692094
> 
> 赞同：3
> 
> 时间：2012-05-21T20:24:44.743
> 
> 标签：c#

我有一个 C# 应用程序，我想通过从桌面运行 .exe 来运行它。但是，我很确定会有某种类型的错误会导致程序崩溃。有没有办法将导致程序崩溃的问题写入文本文件，以便在用户使用程序时查看导致问题的原因？我知道我可以使用调试模式来执行此操作，但我想将应用程序作为独立而不是在 VS 内部运行。

谢谢，

我知道 try catch 块，并且我已经在使用那些可能出现问题的块。但我说的是一般情况。例如，如果我不确定问题会出现在哪里。无法将此特定错误打印到文件中。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-21T20:40:40.090

您可以尝试全局 try/catch 方法，但如果后台线程出现异常，则不会被捕获。`AppDomain.UnhandledException`如果您想在 appdomain ( [msdn](http://msdn.microsoft.com/en-us/library/system.appdomain.unhandledexception.aspx) )中收到任何未处理异常的通知，则可以使用。在程序的其余部分执行之前，您将在 main 中注册，如下所示：

```
static void Main(string[] args)
{
  AppDomain.UnhandledException += WriteUnhandledExceptionToFile;

  // rest of program
}

static void WriteUnhandledExceptionToFile(object sender, UnhandledExceptionEventArgs args)
{
   // write to where ever you can get it.
   string path = Path.Combine(Environment.CurrentDirectory, "UnhandledException.txt");
   File.WriteAllText(path, args.ExceptionObject.ToString()); // will print message and full stack trace.
} 
```

编辑

请注意，默认情况下，Windows 窗体和 WPF 会捕获 UI 线程上引发的任何异常。您必须订阅 Application.ThreadException 事件（表单）或 Application.DispatcherUnhandledException 事件（wpf）才能收到有关这些线程异常的通知。该代码与上面的 AppDomain 事件代码非常相似。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-21T20:26:47.473

有一个将异常详细信息写入文件的全局异常处理程序。

如果将`Main`方法中的代码包装在一个`try{}catch{}`块中，则可以在该块中写出异常详细信息`catch`。

```
try
{
  // Calls to application code
}
catch(Exception ex)
{
   // log `ex.ToString()`
   throw; // rethrow to ensure termination optionally: `Application.Exit`
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-21T20:27:06.300

你可以用 try catch 块包围你的启动方法之一

```
try
{
   ///Your code
}
catch(Exception exception)
{
   System.IO.File.WriteAllLines("ErrLog.txt", exception.Message);
} 
```

作为永久解决方案，您可以创建扩展方法 ToLog 并随时使用它。

```
public static void ToLog(this Exception Exception)
{
        using (var file = File.AppendText("ErrorLog.txt"))
        {
           file.WriteLine(DateTime.Now + " : " + exception.Message);
        }
} 
```

您可以像这样在 catch 块中使用它

```
 catch(Exception exception)
 {
    exception.ToLog();
 } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-21T20:27:10.123

即使您没有记录问题，您通常也可以从 Windows 中的事件查看器中获取相关错误。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-21T20:28:51.243

您首先要查看的是[C#中](http://msdn.microsoft.com/en-us/library/0yd65esw.aspx)[的`try/catch`](http://msdn.microsoft.com/en-us/library/0yd65esw.aspx)构造。这可能是您处理错误的第一个构建块。

至于如何*处理*错误，这完全取决于您。目前，您唯一声明的目标是将它们记录到文件中。您可以从捕获的对象中获取很多详细信息，`Exception`并且可以[将这些详细信息写入文件](http://msdn.microsoft.com/en-us/library/8bh11f1k.aspx)。此外，您可以使用[日志](http://logging.apache.org/log4net/) [库](http://nlog-project.org/)来帮助处理这类事情。

正确的错误处理确实是一个大课题。要记住的一件事是逻辑*上*你想要捕获异常的位置。理想情况下，您想在可以*处理*的地方抓住它。也就是说，您的代码可以从错误中充分恢复。如果这是一个致命错误并且应用程序应该完全停止，那么您可以`throw`将异常进一步向上堆栈并让它不处理（尽管仍然记录在您捕获它的位置）。

但是，如果您处于可以只记录错误并继续前进的逻辑条件下，那么该`catch`块允许您这样做。记录详细信息，更新任何需要更新的对象/数据的状态，并继续应用程序的流程。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-05-21T20:34:11.410

在此处查看初始信息[http://www.csharp-examples.net/ catch-unhandled-exceptions/](http://www.csharp-examples.net/catching-unhandled-exceptions/)

```
static void Application_ThreadException(object sender, ThreadExceptionEventArgs e)
{
  MessageBox.Show(e.Exception.Message, "Unhandled Thread Exception");
}

static void CurrentDomain_UnhandledException(object sender, UnhandledExceptionEventArgs e)
{
  MessageBox.Show((e.ExceptionObject as Exception).Message, "Unhandled UI Exception");
} 
```

UnhandledException 事件处理从主 UI 线程抛出的未捕获异常。ThreadException 事件处理从非 UI 线程抛出的未捕获异常。

我会用一些实际的日志记录（log4net 或其他）替换 MessageBox。这将使您能够将错误注销到另一台服务器以用于分布式应用程序、本地用户的文件系统、事件日志，如果您愿意花时间的话，选项是相当无限的。

# bash - UNIX：如何以文件为输入运行程序

> ID：10692099
> 
> 赞同：3
> 
> 时间：2012-05-21T20:25:06.443
> 
> 标签：bash, unix, parameters, file-io

我正在编写一个名为“run”的 bash 脚本，它使用预定义的输入测试程序。

它将文件作为第一个参数，然后将程序作为第二个参数。

电话看起来像

```
./run text.txt ./check 
```

例如，程序“run”会以 text.txt 作为输入运行“check”。这将为我节省大量的程序测试时间。

现在我有

```
$2 < text.txt > text.created 
```

所以它接受 text.txt 并将其作为输入重定向到指定的程序，这是第二个参数。然后将结果转储到 text.created 中。

我在 text.txt 中有输入，我知道输出应该是什么样子，但是当我 cat text.created 时，它是空的。

有人知道以文件为输入运行程序的正确方法吗？这对我来说似乎很直观，但是“检查”程序是否有问题，而不是我在“运行”脚本中所做的事情？

谢谢！任何帮助都将受到赞赏！

编辑：文件 text.txt 包含多行文件，每个文件都有一个程序“检查”的输入。

也就是说， text.txt 可以包含

asdf1.txt asdf2.txt asdf3.txt

我想对每个文件 asdf1.txt、asdf2.txt、asdf3.txt 进行测试检查。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-21T20:40:10.710

操作员将文件的`<`内容重定向到程序的*标准输入*。这与使用文件的内容作为文件的参数不同——这似乎是你想要的。为此

```
./program $(cat file.txt) 
```

在 bash 中（或在普通的旧版本`/bin/sh`中，使用

```
./program `cat file.txt` 
```

）。

这不会将多行作为单独的调用进行管理，您的编辑表明这是需要的。为此，您可能会使用某种脚本语言（perl、awk、python ......），这使得逐行解析文件变得容易。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-21T20:35:54.707

一个简单的测试

```
#!/bin/sh

# the whole loop reads $1 line by line
while read
do
    # run $2 with the contents of the file that is in the line just read
    xargs < $REPLY $2
done < $1 
```

工作正常。调用该文件“运行”并运行它

```
./run text.txt ./check 
```

我将程序作为参数`./check`执行。`text.txt`不要忘记`chmod +x run`使其可执行。

这是我使用的示例检查程序：

```
#!/bin/sh

echo "This is check with parameters $1 and $2" 
```

打印给定的参数。

我的文件`text.txt`是：

```
textfile1.txt
textfile2.txt
textfile3.txt
textfile4.txt 
```

并且文件`textfile1.txt`, ... 每个“检查”实例都包含一行，例如：

```
lets go 
```

或者

```
one two 
```

输出：

```
$ ./run text.txt ./check
This is check with parameters lets and go
This is check with parameters one and two
This is check with parameters uno and dos
This is check with parameters eins and zwei 
```

# javascript - 在转换结束时调用回调

> ID：10692100
> 
> 赞同：101
> 
> 时间：2012-05-21T20:25:11.640
> 
> 标签：javascript, d3.js, transition

[我需要使用D3.js](http://d3js.org/)制作一个 FadeOut 方法（类似于 jQuery）。我需要做的是使用将不透明度设置为 0 `transition()`。

```
d3.select("#myid").transition().style("opacity", "0"); 
```

问题是我需要一个回调来实现转换何时完成。如何实现回调？

* * *

## 回答 #1

> 赞同：149
> 
> 时间：2012-05-21T20:33:37.153

您想监听过渡的“结束”事件。

```
// d3 v5
d3.select("#myid").transition().style("opacity","0").on("end", myCallback);

// old way
d3.select("#myid").transition().style("opacity","0").each("end", myCallback); 
```

*   [此演示](http://mbostock.github.com/d3/ex/stack.html)使用“结束”事件按顺序链接许多转换。
*   D3 附带的[甜甜圈示例](https://github.com/mbostock/d3/blob/master/examples/donut/donut.html)也使用它来将多个转换链接在一起。
*   这是[我自己的演示](http://phrogz.net/js/d3-playground/#TransitionCallback)，它改变了过渡开始和结束时元素的样式。

从文档中[`transition.each([type],listener)`](https://github.com/d3/d3-transition/blob/master/README.md#transition_each)：

> 如果指定了*类型*，则为转换事件添加一个监听器，同时支持“开始”和“结束”事件。将为过渡中的每个单独元素调用侦听器，即使过渡具有恒定的延迟和持续时间。start 事件可用于在每个元素开始转换时触发瞬时变化。结束事件可用于通过选择当前元素 来启动多阶段转换`this`，并派生新的转换。在结束事件期间创建的任何过渡都将继承当前的过渡 ID，因此不会覆盖先前计划的较新过渡。

*有关更多详细信息，请参阅[有关该主题的此论坛主题](https://groups.google.com/forum/?fromgroups#!topic/d3-js/VnPSh5wkIL4)。*

最后，请注意，如果您只想在元素淡出后（过渡完成后）删除元素，您可以使用[`transition.remove()`](https://github.com/mbostock/d3/wiki/Transitions#wiki-remove).

* * *

## 回答 #2

> 赞同：66
> 
> 时间：2013-12-25T14:35:13.883

Mike Bostock 的**v3**[解决方案](https://groups.google.com/forum/#!msg/d3-js/WC_7Xi6VV50/j1HK0vIWI-EJ)有一个小的更新：

 **```
 function endall(transition, callback) { 
    if (typeof callback !== "function") throw new Error("Wrong callback in endall");
    if (transition.size() === 0) { callback() }
    var n = 0; 
    transition 
        .each(function() { ++n; }) 
        .each("end", function() { if (!--n) callback.apply(this, arguments); }); 
  } 

  d3.selectAll("g").transition().call(endall, function() { console.log("all done") }); 
```

* * *

## 回答 #3

> 赞同：44
> 
> 时间：2016-07-23T03:54:47.040

现在，在 d3 v4.0 中，有一个工具可以将事件处理程序显式附加到转换：

[https://github.com/d3/d3-transition#transition_on](https://github.com/d3/d3-transition#transition_on)

要在转换完成后执行代码，您只需要：

```
d3.select("#myid").transition().style("opacity", "0").on("end", myCallback); 
```

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2014-07-24T19:23:34.373

一种稍微不同的方法也适用于有许多元素同时运行的许多转换：

```
var transitions = 0;

d3.select("#myid").transition().style("opacity","0").each( "start", function() {
        transitions++;
    }).each( "end", function() {
        if( --transitions === 0 ) {
            callbackWhenAllIsDone();
        }
    }); 
```

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2015-05-28T13:03:11.060

以下是 Mike Bostock[解决方案](https://groups.google.com/forum/#!msg/d3-js/WC_7Xi6VV50/j1HK0vIWI-EJ)的另一个版本，灵感来自 @hughes 对 @kashesandr 的回答的评论。`transition`它在' 结束时进行单个回调。

给定一个`drop`函数...

```
function drop(n, args, callback) {
    for (var i = 0; i < args.length - n; ++i) args[i] = args[i + n];
    args.length = args.length - n;
    callback.apply(this, args);
} 
```

...我们可以`d3`像这样扩展：

```
d3.transition.prototype.end = function(callback, delayIfEmpty) {
    var f = callback, 
        delay = delayIfEmpty,
        transition = this;

    drop(2, arguments, function() {
        var args = arguments;
        if (!transition.size() && (delay || delay === 0)) { // if empty
            d3.timer(function() {
                f.apply(transition, args);
                return true;
            }, typeof(delay) === "number" ? delay : 0);
        } else {                                            // else Mike Bostock's routine
            var n = 0; 
            transition.each(function() { ++n; }) 
                .each("end", function() { 
                    if (!--n) f.apply(transition, args); 
                });
        }
    });

    return transition;
} 
```

[作为一个 JSFiddle](http://jsfiddle.net/q3Ls93dy/5/)。

使用`transition.end(callback[, delayIfEmpty[, arguments...]])`：

```
transition.end(function() {
    console.log("all done");
}); 
```

...或者如果`transition`为空，则可选延迟：

```
transition.end(function() {
    console.log("all done");
}, 1000); 
```

...或带有可选`callback`参数：

```
transition.end(function(x) {
    console.log("all done " + x);
}, 1000, "with callback arguments"); 
```

`d3.transition.end`**如果**指定了毫秒数**或**第二个参数为真，则`callback`即使为空也会应用传递的参数。这也会将任何额外的参数转发给（并且只有那些参数）。重要的是，**默认情况下这不会**应用if为空，在这种情况下这可能是一个更安全的假设。`transition` ****`callback`**`callback``transition`******

 ******* * *

## 回答 #6

> 赞同：5
> 
> 时间：2019-09-04T22:12:58.927

从 D3 v5.8.0+ 开始，现在有一种官方方法可以使用`transition.end`. 文档在这里：

[https://github.com/d3/d3-transition#transition_end](https://github.com/d3/d3-transition#transition_end)

Bostock 的一个工作示例如下：

[https://observablehq.com/@d3/transition-end](https://observablehq.com/@d3/transition-end)

基本思想是，仅通过附加`.end()`，转换将返回一个在所有元素都完成转换之前不会解析的承诺：

```
 await d3.selectAll("circle").transition()
      .duration(1000)
      .ease(d3.easeBounce)
      .attr("fill", "yellow")
      .attr("cx", r)
    .end(); 
```

有关更多信息，请参阅版本发行说明：

[https://github.com/d3/d3/releases/tag/v5.8.0](https://github.com/d3/d3/releases/tag/v5.8.0)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2017-01-24T18:08:52.817

Mike Bostock 的[解决方案](https://groups.google.com/forum/#!msg/d3-js/WC_7Xi6VV50/j1HK0vIWI-EJ)通过[**kashesandr**](https://stackoverflow.com/a/20773846/854477) + 将参数传递给回调函数进行了改进：

```
function d3_transition_endall(transition, callback, arguments) {
    if (!callback) callback = function(){};
    if (transition.size() === 0) {
        callback(arguments);
    }

    var n = 0;
    transition
        .each(function() {
            ++n;
        })
        .each("end", function() {
            if (!--n) callback.apply(this, arguments);
    });
}

function callback_function(arguments) {
        console.log("all done");
        console.log(arguments);
}

d3.selectAll("g").transition()
    .call(d3_transition_endall, callback_function, "some arguments"); 
```

* * *

## 回答 #8

> 赞同：-2
> 
> 时间：2015-02-02T18:22:22.883

我通过使用变量设置转换的持续时间解决了类似的问题。然后我用来`setTimeout()`调用下一个函数。就我而言，我希望转换和下一次调用之间有轻微的重叠，正如您将在我的示例中看到的那样：

```
var transitionDuration = 400;

selectedItems.transition().duration(transitionDuration).style("opacity", .5);

setTimeout(function () {
  sortControl.forceSort();
}, (transitionDuration * 0.75)); 
```

* * *

## 回答 #9

> 赞同：-2
> 
> 时间：2014-05-21T13:10:49.807

实际上，还有另一种方法可以使用计时器来做到这一点。

```
var timer = null,
    timerFunc = function () {
      doSomethingAfterTransitionEnds();
    };

transition
  .each("end", function() {
    clearTimeout(timer);
    timer = setTimeout(timerFunc, 100);
  }); 
```********

# actionscript-3 - 外部 SWF 问题

> ID：10692106
> 
> 赞同：0
> 
> 时间：2012-05-21T20:25:31.280
> 
> 标签：actionscript-3, flash, external

我正在使用外部 swfs。一个主类会立即加载到许多外部 swf 中。它们稍后会在用户输入后显示。

只有一个外部 swfs 是一个问题。我写了这个，与其他 swfs 不同，它是一种与其他交互不同的交互，并且播放的音频与主类是分开的。

所以我的问题是，在外部 swf 代码中，是否有一个事件侦听器可以用来知道这个外部 swf 何时显示在主类中？我不想更改主类代码，因为它是为这个 swf 不能也不会匹配的模板设置的。任何建议都会很棒谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-21T21:40:37.623

我想这取决于你对这个孩子 swf 做了什么，很遗憾你不能改变你的主要班级，我的意思是这是负责孩子的权利。

我认为您可以在您的孩子 swf 中执行以下操作：

```
this.addEventListener(Event.ADDED_TO_STAGE, addedToStageHandler, false, 0, true);

function addedToStageHandler(event:Event):void
{
   var child:Movieclip = MovieClip(event.currentTarget);
   // do something with child
} 
```

# asp.net - 从 ASP.NET 中的项目中删除链接

> ID：10692113
> 
> 赞同：0
> 
> 时间：2012-05-21T20:25:50.830
> 
> 标签：asp.net, anchor

对 ASP.NET 来说相当新，并试图弄清楚如何让代码回显它获取的信息。

```
<ul class="accordion">
    <% foreach (var cat in Model.Categories.Where(x=>x.ParentId==null).OrderBy(x=>x.DisplayOrder).ThenBy(x=>x.CategoryName)) { %>
        <li style="height: auto; min-height:30px;">
            <%= Html.ActionLink(cat.CategoryName, "Index", "Products", new { id=cat.UniqueName, area="" }, null)%>

            <%if(cat.SubCategories.Count>0) {%>
                <ul class="sub-menu" style="font-size:.8em; padding-left:20px;">
                    <% foreach (var c in cat.SubCategories) { %>
                        <li><%= Html.ActionLink(c.CategoryName, "Index", "Products", new { id=c.UniqueName, area="" }, null)%></li>
                    <% } %>
                </ul>
            <%}%>
        </li>
    <%} %>
</ul> 
```

目前我知道它与`<%= Html.ActionLink(cat.CategoryName, "Index", "Products", new { id=cat.UniqueName, area="" }, null)%>`那条线有关，但不知道如何让它传递信息。可能是一个愚蠢的问题，但谷歌在搜索这个答案时绝对没有帮助。

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-22T14:53:05.300

以下是一些命令的简要概述：

```
 <%= Html.ActionLink(cat.CategoryName, "Index", "Products", new { id=cat.UniqueName, area="" }, null)%> 
```

将创建：

```
 <a href="products/index/{UniqueName}">{CategoryName}</a> 
```

也可以构造为：

```
 <a href="<%= Url.Action("Index", "Products", new { id=cat.UniqueName, area="" })%>"><%: cat.CategoryName%></a> 
```

这还将创建：

```
 <a href="products/index/{UniqueName}">{CategoryName}</a> 
```

因此，您可以使用以下命令仅输出名称或 ID：

```
 <%: cat.CategoryName %> 
```

或者

```
 <%= cat.CategoryName %> 
```

<%= 是 "Response.Write" 和 "<%:" 是 Response.Write 与 HTML 编码

# javascript - Silverlight 调用 JavaScript 方法的问题

> ID：10692115
> 
> 赞同：0
> 
> 时间：2012-05-21T20:26:05.320
> 
> 标签：javascript, silverlight, webforms, activex, silverlight-3.0

所以我有一个 Silverlight 控件，我使用 ActiveX 对象表示法将它添加到 ASP.NET Web 窗体页面，如下所示：

```
<object data="data:application/x-silverlight-2," type="application/x-silverlight-2" width="500" height="48">
    <param name="source" value="/ClientBin/FileUpload.xap?t=<%=DateTime.Now.ToUniversalTime() %>"/>
    <param name="onError" value="onSilverlightError" />
    <param name="background" value="white" />
    <param name="minRuntimeVersion" value="3.0.40818.0" />
    <param name="autoUpgrade" value="true" />
    <asp:Literal ID="SilverlightInitParams" runat="server" />
    <a href="http://go.microsoft.com/fwlink/?LinkID=149156&v=3.0.40818.0" style="text-decoration:none">
        <img src="https://go.microsoft.com/fwlink/?LinkId=161376" alt="Get Microsoft Silverlight" style="border-style:none"/>
    </a>
</object> 
```

在控件中，有一个按钮。单击按钮时，我希望调用 JavaScript 脚本。要查看我是否可以让它工作，它应该调用一个确实存在的 JavaScript 函数。然而，什么也没有发生。

Silverlight 代码如下所示：

```
public partial class FileUploadControl : UserControl
{
    ...

    public FileUploadControl(IDictionary<string,string> parameters)
    {
        ...
        HtmlPage.RegisterScriptableObject("Page", this);

        InitializeComponent();
    }

    private void chooseFileButton_Click(object sender, RoutedEventArgs e)
    {
        HtmlPage.Window.Invoke("showStatus");

        ...
    }

    ...
} 
```

这是 JavaScript 方法：

```
function showStatus() {
    alert('Test from Silverlight.');
} 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-21T21:03:47.780

.xap 文件未复制到部署目录。我现在有另一个问题，但我不太确定它是什么。我现在正在调查那个。

# c++ - C++ char * const vs char *，为什么有时一个有时另一个

> ID：10692120
> 
> 赞同：0
> 
> 时间：2012-05-21T20:26:24.227
> 
> 标签：c++, pointers, char, constants

在使用结构项目时：

```
struct item
{
    item();
    ~item();
    char * name;
    char * effect1;
    char * effect2;
    char * effect3;
    char * effect4;
    int count;
}; 
```

使用构造函数：

```
item::item()
{
    name = NULL;
    effect1 = NULL;
    effect2 = NULL;
    effect3 = NULL;
    effect4 = NULL;
    count = 0;
} 
```

将鼠标悬停在名称上显示：

```
char* name() const 
```

将鼠标悬停在任何效果上时显示：

```
char* effectx 
```

我想知道为什么会发生这种情况，因为我认为这种差异导致我在程序的其他领域出现问题。谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T20:37:40.527

我不认为您提供的声明与 IDE 看到的代码完全相同。解决问题的一种好方法是将代码复制到单独的工作文件中（在单独的项目中），并将所有代码（声明和显示问题的示例代码）移动到同一个文件中。然后删除代码中不相关的部分，以便您慢慢转向仍然显示您的问题的最小、最精简的示例。

然后将该代码发布为您的问题的更新。

同时，您没有完全正确地定义您的构造函数。嗯，这是正确的，但不是最好的风格。不要在构造函数的主体中初始化成员，像这样初始化它们：

```
item::item()  : 
 name(NULL), effect1(NULL), effect2(NULL), effect3(NULL), effect4(NULL), count(0)
{
  /* nothing in the body. */
} 
```

# c++ - 用作其他函数的参数的 C++ 绑定函数

> ID：10692121
> 
> 赞同：7
> 
> 时间：2012-05-21T20:26:27.970
> 
> 标签：c++, bind

我有一个需要函数指针作为参数的函数：

```
int func(int a, int (*b)(int, int))
{
    return b(a,1);
} 
```

现在我想使用一个在这个函数中有三个参数的函数：

```
int c(int, int, int)
{
    // ...
} 
```

如何绑定的第一个参数，`c`以便我能够做到：

```
int i = func(10, c_bound); 
```

我一直在看，`std::bind1st`但我似乎无法弄清楚。它不返回函数指针对吗？我有充分的自由去适应`func`，所以任何方法的改变都是可能的。尽管如此，我希望我的代码的用户能够定义他们自己的`c`......

请注意，以上是对我正在使用的实际功能的猛烈简化。

该项目遗憾地需要`C++98`.

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-05-21T20:30:15.633

你不能那样做。您必须先修改`func`以获取函数对象。就像是：

```
int func( int a, std::function< int(int, int) > b )
{
    return b( a, rand() );
} 
```

事实上，没有必要`b`成为一个`std::function`，它可以被模板化：

```
template< typename T >
int func( int a, T b )
{
    return b( a, rand() );
} 
```

但为了清晰起见，我会坚持使用该`std::function`版本，并且编译器输出的错误不会那么复杂。

然后，您将能够执行以下操作：

```
int i = func( 10, std::bind( &c, _1, _2, some-value ) ); 
```

请注意，所有这些都是**C++11**，但您可以使用 Boost在**C++03中完成。**

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-21T20:37:25.060

好吧，如果您在编译时知道必须绑定 c 的内容，则可以定义一个新函数

```
int c_bound(int a, int b) {
   return c(a,b,some_value);
} 
```

这显然不是通用解决方案，但可能会解决您当前的问题。否则，K-ballo 的解决方案似乎是唯一简单的通用解决方案。但是，这要求您能够更改`func`. 如果您确实有一个无法触摸签名的 API，并且您仍然需要绑定一个参数并且如果上述解决方案不能解决您的特定情况：（注意，过度杀伤力）我一直想使用基于[LLVM](http://en.wikipedia.org/wiki/LLVM)的解决方案，用于在运行时编译函数并在这种情况下传递其地址。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-21T20:40:08.370

您将无法将 3 参数函数用作 2 参数函数；主要是因为没有真正的方法来确定第三个参数会做什么。

虽然上述答案可行，但这是另一种选择：

如果`c()`在其中使用的 的参数之一`func`是常量，则可以为 编写包装函数`c(int, int, int)`：

```
int d(int a, int b)
{
   return c(a, b, 0); //use a constant parameter
} 
```

或者，如果您可以从两个给定参数中确定第三个参数，您也可以尝试：

```
int e(int a, int b)
{
    int extra = 0;
    ///Determine extra from a, and b
    return c(a, b, c);
} 
```

# asp.net-mvc-3 - 是否可以将 automapper 与 nhibernate 一起使用？

> ID：10692125
> 
> 赞同：1
> 
> 时间：2012-05-21T20:26:43.570
> 
> 标签：asp.net-mvc-3, nhibernate, automapper

我正在使用 NHibernate (v3.3) 将我的域模型类加载/保存到数据库。我创建了一堆 View Model 类以在 MVC3 网站的前端使用。所以我打算使用 AutoMapper (v2.1) 将视图模型类映射到域类。

我已经在两个类 Restaurant 和 RestaurantViewModel 之间定义了 Map 配置。这是方法：

```
 public void Create(IConfiguration configuration)
    {
        if (configuration == null)
            throw new ArgumentNullException("configuration");

        IMappingExpression<RestaurantViewModel, Restaurant> map =
            configuration.CreateMap<RestaurantViewModel, Restaurant>();

        map.ForMember(x => x.Address, o => o.ResolveUsing(x => new Address
                                                                {
                                                                       BuildingNumber = x.BuildingNumber,
                                                                    City = x.City,
                                                                    PostalCode = x.PostalCode,
                                                                    Street = x.Street
                                                                }));

        map.ForMember(x => x.Categories, o => o.Ignore());
        map.ForMember(x => x.Photo, o => o.Ignore());
    } 
```

但是在调用**Mapper.Map<RestaurantViewModel>(restaurant)**时出现异常；

这是异常的文本：

```
Missing type map configuration or unsupported mapping.

Mapping types:
RestaurantProxy -> RestaurantViewModel
RestaurantProxy -> FoodDelivery.Website.Models.RestaurantViewModel

Destination path:
RestaurantViewModel

Source value:
FoodDelivery.DataDomain.Restaurant 
```

看起来 NHibernate 在我的 Restaurant 周围创建名为 RestaurantProxy 的代理，所以当我要求 AutoMapper 将 Restaurant 映射到 RestaurantViewModel 时，它实际上映射了 Proxy，并且因为该映射器没有 Map 会引发异常。

有什么方法可以修复代码吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-21T20:48:32.453

看起来您的错误是在映射`Restaurant`到`RestaurantViewModel`. 您的映射似乎只覆盖了另一个方向的映射，即视图模型到实体。

试试加这个？

```
configuration.CreateMap<Restaurant, RestaurantViewModel>(); 
```

这应该允许您将餐厅实体映射到您的视图模型。

# .net - 将 DataGridView 与 BindingSource.DataSource=List 一起使用 , 需要绑定到继承的 T 类型

> ID：10692132
> 
> 赞同：0
> 
> 时间：2012-05-21T20:27:22.060
> 
> 标签：.net, winforms, data-binding, datagridview, bindingsource

我正在寻找使用 C# 和 .Net3.5 解决与 Winforms datagridview 的数据绑定问题。它有点复杂，包含一些我将提供代码的类。

我有一个这样定义的接口：

```
public interface MyElement : IEditableObject {
    string Name { get; set; }
    string Description { get; set; }
} 
```

接下来我有一个从 MyElement 继承的抽象类，定义如下：

```
abstract public class MyElementAdapter : MyElement {
    private string myName;
    private string myDescription;
    private ModelElement myParent;
    public MyElementAdapter(MyElement parent) {
        myName = "New_Element";
        myDescription = string.Empty;
    }
    virtual public string Name {
        get { return myName; }
        set { myName = value; }
    }
    virtual public string Description {
        get { return myDescription; }
        set { myDescription = value; }
    }
    public MyElement Parent {
        get { return myParent; }
        set { myParent = value; }
    }
    public void BeginEdit() {
        // code to begin edit
    }
    public void CancelEdit() {
        // code to cancel edit
    }
    public void EndEdit() {
        // code to end edit
    }
} 
```

有一个这样定义的接口类型的通用列表 - 它非常基本，只保留了 MyElements 的通用列表：

```
public class MyElementList : List<MyElement> {
    public MyElementList() {
    }
} 
```

有一个名为 MyField 的继承类，它派生自 MyElementAdapter，定义如下：

```
public class MyField : MyElementAdapter {
    private int size;
    public MyField(MyElement parent) : base(parent) {
        size = 1;
    }
    public string MyFieldName {
        get { return this.Name; }
        set { this.Name = value;}
    }
    public string MyFieldDescription {
        get { return this.Description; }
        set { this.Description = value;}
    }
    public int Size {
        get { return size; }
        set { size = value; }
    }
} 
```

有一个使用 MyElementList 的类，其中 MyField 是 List 类型：

```
public class MyRecordOfFields : MyElementAdapter {
    private MyElementList myMembers;
    public MyRecordOfFields(MyElement parent) : base(parent) {
        myMembers = new MyElementList();
    }
    public MyElementList MyMembers {
        get { return myMembers; }
        set { myMembers = value; }
    }
} 
```

最后，我使用了一个表单来编辑 MyRecordOfFields 类型的对象。

```
public class Form1 : Form {
    private BindingSource bindingSource1;
    private MyRecordOfFields myLocalFields;
    private DataGridView dgv;

    private Form1_Load() {
        myLocalFields = new MyRecordOfFields(null);
        MyField field1 = new MyField(null);
        field1.MyFieldName = "Field_1";
        field1.MyFieldDescription = "Description1";
        field1.Size = 3;
        myLocalFields.MyMembers.Add(field1);
        MyField field2 = new MyField(null);
        field2.MyFieldName = "Field_2";
        field2.MyFieldDescription = "Description2";
        field2.Size = 3;
        myLocalFields.MyMembers.Add(field2);
        MyField field3 = new MyField(null);
        field3.MyFieldName = "Field_3";
        field3.MyFieldDescription = "Description3";
        field3.Size = 3;
        myLocalFields.MyMembers.Add(field3);

        bindingSource1 = new BindingSource();
        bindingSource1.AllowNew = true;

        dgv.AutoGenerateColumns = false;
        int colIndex = dgv.Columns.Add("MyFieldName", "MyFieldName");
        dgv.Columns[colIndex].DataPropertyName = "MyFieldName";
        colIndex = dgv.Columns.Add("MyFieldDescription", "MyFieldDescription");
        dgv.Columns[colIndex].DataPropertyName = "MyFieldDescription";
        colIndex = dgv.Columns.Add("Size", "Size");
        dgv.Columns[colIndex].DataPropertyName = "Size";
        dgv.AutoSizeColumnsMode = DataGridViewAutoSizeColumnsMode.Fill;
        dgv.AutoResizeColumns();

        bindingSource1.DataSource = myLocalFields.MyMembers;
        dgv.DataSource = bindingSource1;
        dgv.Invalidate();
    }
} 
```

加载此表单时，所有内容都会编译并运行，但是当显示表单时，datagridview 有 3 行但全为空白。我正在尝试将 datagridview 的数据源直接设置为 MyRecordOfFields 类中的 MyElementList，但是对于添加到列表中的行数，没有显示任何内容。

当我没有将 datagridview 的数据源设置为列表，而是在循环中添加该列表中的每个元素时，数据将按应有的方式显示。

以下行：

```
 bindingSource1.DataSource = myLocalFields.MyMembers; 
```

改为循环：

```
 foreach (MyElement me in myLocalFields.MyMembers) {
            // No casting needed due to inheritance
            bindingSource1.Add(me);
        } 
```

在我更改为循环后，我必须添加事件处理程序以添加、删除和更新底层数据源，即 myLocalFields (MyRecordOfFields.MyMembers)。

在我的场景中是否有我遗漏或没有正确执行的内容？我知道这有点涉及接口和抽象类，但我正在使用预定义的实现，因此更改这些底层/基本类不是一种选择。先感谢您。

*   洛伦兹

**更新：** 我尝试了一些建议，但无济于事。所以我的问题是：我是否可以通过将 bindingSource1.DataSource 设置为 MyRecordOfFields.MyMembers 属性中的 MyElementLIst 来公开 MyField 的继承属性（就像我设计的 datagridview [列]）？

这是我需要一些指导的地方： MyElement 是一个接口；MyElementAdapter 是从 MyElement 派生的抽象；MyElementList 是 MyElement 的通用列表；MyField 是从 MyElementAdapter 派生的。将 MyElement 或任何派生类（即 MyField）添加到 MyElementList 是可行的。然而，我想在 UI 中公开这些派生类的属性（datagridview、控件等）。

**更新#2：** 现在我的 datagridview 绑定到 MyElementList 一切正常。我现在正在添加/删除/更新 myLocalFields.MyMembers 列表。我添加了一个带有以下代码的按钮：

```
private void AddItem_Click(object sender, EventArgs e) {
    MyField field1 = new MyField(null);
    field1.MyFieldName = "Field_" + myLocalFields.MyMembers.Count + 1;
    field1.MyFieldDescription = "Description" + myLocalFields.MyMembers.Count + 1;
    field1.Size = myLocalFields.MyMembers.Count + 1;
    myLocalFields.MyMembers.Add(field1);
    ((BindingSource)dataGridView1.DataSource).ResetBindings(false);
} 
```

完成此方法后，我看到我的基础数据 (myLocalField.MyMembers) 发生了变化，但 bindingSource1 和 dataGridView1 没有。过去，对底层数据的任何更新都是对底层数据和绑定源进行的——我想对底层数据进行更改并将其传播到绑定源/datagridview。

我认为以下内容会处理对 datagridview 的任何更改，但它不会：

```
 ((BindingSource)dataGridView1.DataSource).ResetBindings(false); 
```

是否需要使用另一种方法来更新 datagridview 而无需添加额外的 datagridview 事件？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-21T21:31:26.323

首先：

*   请考虑接受您的问题的答案。
*   请发布编译的代码。

* * *

你**真的**应该在你的接口前加上**I**。它使您的代码更易于解释。

您正在将数据源设置为`List<MyElement>`. 这意味着它可以绑定的可用属性是`Name`和`Description`。

```
public interface MyElement : IEditableObject { 
    public string Name { get; set; } 
    public string Description { get; set; } 
} 
```

但是您正在手动创建绑定到名为`MyFieldName`and`MyFieldDescription`和的属性的 DataGridView 列`Size`。数据绑定器无法将您告诉它的期望与您给它的相匹配。

执行此操作时，无需先设置数据源：

```
foreach (MyElement me in myLocalFields.MyMembers) {         
            bindingSource1.Add(me);         
        } 
```

我相信您添加的第一个对象是建立绑定的对象，在这种情况下它是 a `MyField`，它具有您的 DataGridView 期望的属性。

你有几个选择。以下是其中一些，没有特别的顺序。

**选项 1.**使用`AutoGenerateColumns = true`并删除所有手动创建列的代码。

**选项 2。**创建列时，使用 MyElement 属性名称：

```
int colIndex = dgv.Columns.Add("MyFieldName", "MyFieldName");  
dgv.Columns[colIndex].DataPropertyName = "Name";  
colIndex = dgv.Columns.Add("MyFieldDescription", "MyFieldDescription");  
dgv.Columns[colIndex].DataPropertyName = "Description"; 
```

**选项 3.**将对象转换为`MyField`，以便 BindingSource 为您告诉网格期望的属性生成绑定：

而不是这个：

```
bindingSource1.DataSource = myLocalFields.MyMembers; 
```

做这个：

```
bindingSource1.DataSource = myLocalFields.MyMembers.Cast<MyField>(); 
```

希望你能在这里看到主题。关键是您当前正在将显式绑定的列与自动创建的绑定相结合，而自动绑定不是您的列设置的目的。我给你们的选项都以不同的方式解决了这个问题。

# javascript - Javascript 在 IE 中不起作用，但所有其他浏览器都可以正常工作

> ID：10692134
> 
> 赞同：0
> 
> 时间：2012-05-21T20:27:26.243
> 
> 标签：javascript, internet-explorer-9

我有一些推荐在我的主页上循环，代码似乎在 Firefox、Chrome 和 Safari 中运行良好，但在 IExplorer 中却不行。我正在运行 IE 9。我将不胜感激任何帮助或见解。

这是我正在使用的代码：

```
<div class="quotes">
    <div id="tst">
        <div id="quote"></div>
    </div>
    <br><span></span>
</div>
<div class="comment"><strong>
    <div id="tstperson"></div></strong>
</div>
<script type="text/javascript">
    var quote=new Array();
      quote[0]="An essential tool in preparation for any show. Valuable time is saved, refining vocals much earlier in the process.";
      quote[1]="Invaluable for learning vocal lines! A brilliantly simple and easy to use interface that saved me hours of time.";
      quote[2]="MixMyPart saved us almost a week of rehersal time. A brilliant invention. Singers come in less nervous and more focused.";
    <!--   quote[3]="An invaluble tool for learning vocal lines! Brilliantly simple and easy to use interface that saved me hours of time.";  
    -->

    var quoteperson=new Array();
      quoteperson[0]="Bob Foster, <font color=\"ffffff\">Music Director</font>";
      quoteperson[1]="Liam Tobin, <font color=\"ffffff\">Actor</font>";
      quoteperson[2]="Shawn Wright, <font color=\"ffffff\">Actor</font>";
    <!--   quoteperson[3]="Liam Tobin, <a href=\"website.html\" target=\"_blank\">website.org</a>";    
    -->

    var speed=7000;
    var q=Math.floor(Math.random()*quote.length)

    function showQuote() {
         document.getElementById("tst").innerHTML="&ldquo;"+quote[q]+"&rdquo;";
         document.getElementById("tstperson").innerHTML=quoteperson[q]; 
         q++;
    if(q==quote.length) {
         q=0;
      }
    }
    showQuote();
    setInterval('showQuote()',speed);
</script> 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-21T20:30:13.247

```
<!-- --> 
```

不是有效的 JavaScript 注释。请改用 /* */。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-21T20:36:25.700

您的评论标记对 javascript 无效。修改你的脚本如下，它可以在 IE 中正常工作：

```
var quote=new Array();
  quote[0]="An essential tool in preparation for any show. Valuable time is saved, refining vocals much earlier in the process.";
  quote[1]="Invaluable for learning vocal lines! A brilliantly simple and easy to use interface that saved me hours of time.";
  quote[2]="MixMyPart saved us almost a week of rehersal time. A brilliant invention. Singers come in less nervous and more focused.";
// quote[3]="An invaluble tool for learning vocal lines! Brilliantly simple and easy to use interface that saved me hours of time.";  

var quoteperson=new Array();
  quoteperson[0]="Bob Foster, <font color=\"ffffff\">Music Director</font>";
  quoteperson[1]="Liam Tobin, <font color=\"ffffff\">Actor</font>";
  quoteperson[2]="Shawn Wright, <font color=\"ffffff\">Actor</font>";
// quoteperson[3]="Liam Tobin, <a href=\"website.html\" target=\"_blank\">website.org</a>"; 
```

# android - 为什么安装 .apk 文件后 Android 2.2 会重启？

> ID：10692136
> 
> 赞同：0
> 
> 时间：2012-05-21T20:27:32.417
> 
> 标签：android, installation, apk

我收到来自 Beta 测试人员的报告，称安装我的 .apk 文件后，他们的设备正在重新启动。重新启动后，应用程序正常运行。安装后重新启动不是所需/预期行为的一部分，它本身听起来像是安全漏洞。

任何人都可以推测为什么 Android 可能会在安装 .apk 后重新启动？

更新：

其中一台是 LG Ally，另一台是三星 Galaxy Note

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-21T21:41:07.627

您的 Beta 用户是否使用有根设备？他们的设备上是否安装了某种安全应用程序，例如“Lookout”？

我建议你让你的应用程序在 sdcard 上[创建一个跟踪日志](http://developer.android.com/guide/developing/debugging/debugging-tracing.html#creatingtracefiles)，让你的 beta 测试人员通过电子邮件发送给你。

当然，如果有人借给您与您的 Beta 用户正在使用的相同型号的设备，则此调试过程会更容易。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-05-21T20:42:07.760

无论您的应用程序是什么，都不应该使操作系统崩溃。其中很多可能取决于设备和制造商。例如，我注意到在 Droid X 上使用某个应用程序在 2.3.x 上流式传输音乐时，设备有时会重新启动。我自己无法解决这个问题，而是不得不等到摩托罗拉提供了一个修复程序（它最终是）。我会看看您是否可以在某些设备或制造商上找到常见的情况，然后在他们报告的错误页面上进行一些研究。另外，这是什么类型的应用程序（游戏/媒体/实用程序？）

# r - 是否可以使用 sparkTable 绘制直方图？

> ID：10692138
> 
> 赞同：1
> 
> 时间：2012-05-21T20:27:42.417
> 
> 标签：r, sparklines, tufte, sparktable

我可以做一个 sparkBar，但没有 sparkHist。这可能吗？

这是如何创建 sparkBar 的示例（来自`example(newSparkBar)`：

```
library(sparkTable)
data(pop)
x <- pop[pop[,2]=="Insgesamt",3]
b <- newSparkBar(values=x-min(x))
getParameter(b, type="values")
b <- setParameter(b, c("darkred", "darkgreen","black"), type="barCol")
plotSparks(b, outputType="pdf", filename="testBar1") 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-06T06:28:04.733

阅读此处的评论后，我在 sparkTable 包的 0.9.4 版本中包含了直方图。基本上与上一个答案建议的风格相同。

这里有两个例子：

1）仅用于绘制 sparkHist（不是很令人兴奋）

2) 用于为正态和对数正态分布数据创建带有箱线图和直方图的 sparkTable

```
#Example newSparkHist
hh <- newSparkHist(values=rnorm(100))
plotSparks(hh, outputType='pdf', filename='testHist1')

#Example sparkTable with Hist+Box with 2 variables in 10 different groups
datEx <- data.frame(variable=sample(paste("Cat",1:10,sep="_"),1000,replace=TRUE),
  value=rnorm(1000),value2=rlnorm(1000))
b <- newSparkBox()
h <- newSparkHist()
content <- list(function(x) { round(mean(x),2) },
  function(x) { round(median(x),2) },
  function(x) { round(quantile(x,.25),2) },
  function(x) { round(quantile(x,.75),2) },
  b,
  h,
  function(x) { round(mean(x),2) },
  function(x) { round(median(x),2) },
  function(x) { round(quantile(x,.25),2) },
  function(x) { round(quantile(x,.75),2) },
  b,
  h
  )
names(content) <- c(paste(c("Mean","Median","Q25","Q75","Boxplot","Histogram"),
  "_v1",sep=""),
  paste(c("Mean","Median","Q25","Q75","Boxplot","Histogram"),"_v2",sep="")
)
varType <- c(rep("value",length(content)/2),rep("value2",length(content)/2))
datEx <- reshapeExt(datEx,idvar="variable", varying=list(2,3))
x2 <- newSparkTable(datEx, content, varType)
plotSparkTable(x2, outputType="html", graphNames="o2",filename="t1") 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-24T23:15:20.527

这样的事情是你的想法吗？（它可以很容易地被包装成一个`newSparkHist`函数，但我没有打扰......）

```
library(sparkTable)
data(alcohol)
hvals <- hist(alcohol$value,plot=FALSE)$counts
b <- newSparkBar(values=hvals,barCol=c("gray","gray","black"))
plotSparks(b, outputType="png", filename="testBar1") 
```

![在此处输入图像描述](../Images/72640b4a588c86ec157e7b707372cfb5.png)

# wpf - ItemsSource 属性上的绑定何时生成项目？

> ID：10692139
> 
> 赞同：1
> 
> 时间：2012-05-21T20:27:45.943
> 
> 标签：wpf, data-binding

我在我的 WPF 应用程序中添加了一个对话框。这是 Xaml：

```
<cs:CarSystemDialog x:Class="CarSystem.CustomControls.EditHotListDialog"
                    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
                    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
                    xmlns:cs="clr-namespace:CarSystem.CustomControls"
                    DataContext="{Binding Path=HotList, RelativeSource={RelativeSource Self}}"
                    Height="265"
                    Loaded="EditHotListDialog_Loaded"
                    MaxHeight="665"
                    MaxWidth="1200"
                    SizeToContent="WidthAndHeight"
                    cs:ThemeSelector.CurrentThemeDictionary="{Binding Path=TimeOfDayTheme, RelativeSource={RelativeSource Self}}"
                    Width="850"
                    WindowStartupLocation="CenterOwner" >

    <cs:CarSystemDialog.Resources>
        <cs:BooleanToVisibilityConverter x:Key="BoolToVisibility" True="Visible" False="Collapsed" />
        <cs:CaseToVisibilityConverter x:Key="CaseToVisibilityConverter" />
    </cs:CarSystemDialog.Resources>

    <Grid Background="{DynamicResource ContentBackground}" FocusManager.IsFocusScope="True" Name="LayoutRoot">
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="Auto" />
            <ColumnDefinition Width="*" />
            <ColumnDefinition Width="Auto" />
            <ColumnDefinition Width="*" />
        </Grid.ColumnDefinitions>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="Auto" />
            <RowDefinition Height="Auto" />
            <RowDefinition Height="Auto" />
        </Grid.RowDefinitions>

        <TextBlock FontSize="16"
                   FontWeight="Bold"
                   Foreground="{DynamicResource TextForeground}"
                   Grid.Column="0"
                   Grid.Row="0"
                   HorizontalAlignment="Right"
                   Margin="5"
                   Text="Source:"
                   VerticalAlignment="Center" />
        <TextBox AcceptsTab="False"
                 AcceptsReturn="False"
                 BorderBrush="{DynamicResource ControlBorder}"
                 BorderThickness="2"
                 FontSize="16"
                 FontWeight="Bold"
                 Foreground="{DynamicResource UnfocusedForeground}"
                 Grid.Column="1"
                 Grid.Row="0"
                 Margin="5"
                 MaxLength="80"
                 MaxLines="1"
                 Name="HotListNameBox"
                 TabIndex="0"
                 Text="{Binding Path=Name, Mode=TwoWay}"
                 VerticalAlignment="Center" />

        <TextBlock FontSize="16"
                   FontWeight="Bold"
                   Foreground="{DynamicResource TextForeground}"
                   Grid.Column="2"
                   HorizontalAlignment="Right"
                   Margin="5"
                   Text="List Type:"
                   VerticalAlignment="Center" />
        <ComboBox BorderBrush="{DynamicResource PlateInfoBorder}"
                  DisplayMemberPath="Value"
                  FontSize="16"
                  FontWeight="Bold"
                  Grid.Column="3"
                  ItemsSource="{Binding Path=ListTypes, RelativeSource={RelativeSource AncestorType={x:Type cs:EditHotListDialog}}}"
                  Margin="5"
                  Name="ListTypePicker"
                  SelectedValue="{Binding Path=ListTypeId, Mode=TwoWay}"
                  SelectedValuePath="Key"
                  TabIndex="1" />

        <TextBlock FontSize="16"
                   FontWeight="Bold"
                   Foreground="{DynamicResource TextForeground}"
                   Grid.Column="0"
                   Grid.Row="1"
                   HorizontalAlignment="Right"
                   Margin="5"
                   Text="Domain:"
                   VerticalAlignment="Center" />
        <ComboBox BorderBrush="{DynamicResource PlateInfoBorder}"
                  DisplayMemberPath="Value"
                  FontSize="16"
                  FontWeight="Bold"
                  Grid.Column="1"
                  Grid.Row="1"
                  ItemsSource="{Binding Path=Domains, RelativeSource={RelativeSource AncestorType={x:Type cs:EditHotListDialog}}}"
                  Margin="5"
                  Name="DomainPicker"
                  SelectedValue="{Binding Path=DomainId, Mode=TwoWay}"
                  SelectedValuePath="Key"
                  TabIndex="1" />

        <StackPanel Grid.Column="0"
                    Grid.ColumnSpan="4"
                    Grid.Row="2"
                    HorizontalAlignment="Center"
                    Orientation="Horizontal">
            <Button Background="{DynamicResource ButtonBackground}"
                    Click="OkButton_Click"
                    Content="OK"
                    FontSize="18"
                    FontWeight="Bold"
                    Foreground="{DynamicResource ButtonForeground}"
                    Height="50"
                    IsDefault="True"
                    IsEnabled="{Binding Path=CanSave, RelativeSource={RelativeSource AncestorType={x:Type cs:EditHotListDialog}}}"
                    Margin="5"
                    Name="OkButton"
                    Width="100"/>
            <Button Background="{DynamicResource ButtonBackground}"
                    Content="Cancel"
                    FontSize="18"
                    FontWeight="Bold"
                    Foreground="{DynamicResource ButtonForeground}"
                    Height="50"
                    IsCancel="True"
                    Margin="5"
                    Name="CancelButton"
                    Width="100" />
        </StackPanel>

    </Grid>
</cs:CarSystemDialog> 
```

这是背后的代码：

```
public partial class EditHotListDialog : CarSystemDialog, INotifyPropertyChanged {

    public static readonly DependencyProperty CanSaveProperty =
        DependencyProperty.Register( "CanSave", typeof( bool ), typeof( EditHotListDialog ), new PropertyMetadata( false ) );

    public static readonly DependencyProperty HotListProperty =
        DependencyProperty.Register( "HotList", typeof( HotListViewModel ), typeof( EditHotListDialog ), 
                                     new PropertyMetadata( null, new PropertyChangedCallback( OnHotListChanged ) ) );

    public bool CanSave {
        get { return (bool) GetValue( CanSaveProperty ); }
        set { SetValue( CanSaveProperty, value ); }
    }

    public ObservableCollection<ItemChoice<int?>> Domains { get; set; }

    public HotListViewModel HotList {
        get { return (HotListViewModel) GetValue( HotListProperty ); }
        set { SetValue( HotListProperty, value ); }
        }

    public ObservableCollection<ItemChoice<int?>> ListTypes { get; set; }

    public EditHotListDialog() {
        InitializeComponent();

        Domains = new ObservableCollection<ItemChoice<int?>>(); 
        ListTypes = new ObservableCollection<ItemChoice<int?>>();

        Domains  .Add( new ItemChoice<int?> { Key = null, Value = "-- Pick a Domain --"} );
        ListTypes.Add( new ItemChoice<int?> { Key = null, Value = "-- Pick a List Type --" } );
        KeywordCache.KeywordCacheUpdated += KeywordCacheUpdated;
    }

    private void EditHotListDialog_Loaded( object sender, RoutedEventArgs e ) {
        UpdateChoices();

          DomainPicker.SelectedIndex = 0;
        ListTypePicker.SelectedIndex = 0;
    }

    void HotList_PropertyChanged( object sender, PropertyChangedEventArgs e ) {
        HotListViewModel hotList = sender as HotListViewModel;
        CanSave = !( string.IsNullOrEmpty( hotList.Name ) || string.IsNullOrWhiteSpace( hotList.Name ) ) && hotList.ListTypeId > 0 && hotList.DomainId   > 0;
    }

    private void OkButton_Click( object sender, RoutedEventArgs e ) {
        if ( ValidateHotList() ) {
            DialogResult = true;
            Close();
        }
        e.Handled = true;
    }

    private void OnHotListChanged( HotListViewModel oldHotList, HotListViewModel newHotList ) {
        if ( oldHotList != null ) {
            oldHotList.PropertyChanged -= HotList_PropertyChanged;
        }
        if ( newHotList != null ) {
            newHotList.PropertyChanged += HotList_PropertyChanged;
        }
    }
    private static void OnHotListChanged( DependencyObject d, DependencyPropertyChangedEventArgs e ) {
        EditHotListDialog dialog = d as EditHotListDialog;
        dialog.OnHotListChanged( e.OldValue as HotListViewModel, e.NewValue as HotListViewModel );
    }

    private void UpdateChoices() {
               . . .
    }

    private bool ValidateHotList() {
        if ( string.IsNullOrEmpty( HotListNameBox.Text.Trim() ) ) {
            CarSystemMessageBox.Show( "Please enter a name for the Hot List.", "Please Name the Hot List", MessageBoxButton.OK, MessageBoxImage.None );
            return false;
        }

        if ( ListTypePicker.SelectedIndex <= 0 ) {
            CarSystemMessageBox.Show( "Please select the List Type from the drop down that specifies what type of Hot List this is.", "Please Specify a List Type", MessageBoxButton.OK, MessageBoxImage.None );
            return false;
        }
        if ( DomainPicker.SelectedIndex <= 0 ) {
            CarSystemMessageBox.Show( "Please select the Domain from the drop down that this Hot List Entry belongs to.", "Please Specify a Domain", MessageBoxButton.OK, MessageBoxImage.None );
            return false;
        }
        return true;
    }

    #region INotifyPropertyChanged Members

    public event PropertyChangedEventHandler PropertyChanged;

    protected void RaisePropertyChangedEvent( string propertyName ) {
        if ( PropertyChanged != null ) {
            PropertyChanged( this, new PropertyChangedEventArgs( propertyName ) );
        }
    }

    #endregion
} 
```

}

当我调试这段代码时，我看到两者`ObservableCollections`都填充了数据。这发生在`UpdateChoices`方法中。我已经将调用`UpdateChoices`放在构造函数中以及上面代码中的位置。

问题是这两个`ObservableCollections`都填完后，`Items`在`ComboBoxes`. 当我将`SelectedIndex`属性设置为 0 时，没有选择任何内容。当对话框最终打开时，任何一个组合框中都没有选择任何内容。

我已经成功地在我的应用程序中使用了这种模式`UserControls`，`MainWindow`但这是我第一次在对话框中使用它。调用`UpdateChoices`方法和设置`SelectedIndex`属性的正确位置在哪里`ComboBoxes`？

PS 我没有包含 UpdateChoices 方法的详细信息，因为它与问题无关。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-21T21:04:52.197

您的 DataContext 设置为 HotList，它与您尝试访问的属性处于同一级别。要么将 DataContext 更改为整个对话框，要么将 observable 集合移动到 HotList 对象中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-07T17:19:01.157

我不知道绑定的问题是什么，但我摆脱了它，只是在对话框的事件处理程序中设置控件的`ItemsSource`属性。现在一切正常。`ComboBox``Loaded`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-07T17:44:33.823

查看 MVVM 模式。几乎不需要任何代码，并且您可以获得可测试的代码。

# javascript - 奇怪的错误：代码每次点击执行不止一次

> ID：10692140
> 
> 赞同：0
> 
> 时间：2012-05-21T20:27:49.030
> 
> 标签：javascript, jquery, ajax

我有一个赞评论系统

当我点击类似链接时，有时它可以正常工作，但有时每次点击最多发送 8-9 个请求！我在另一个适用于 keydown 事件的 jquery 代码上有同样的问题

```
 <a href="javascript:void(0);" class="like_comment" ><?php echo $likeLable; ?></a>

 $('.like_comment').live('click', function () {
     var parent = $(this).parent();
     var comment_id = parent.parent().find('.comment_id').val();
     parent.fadeOut(200);

     $.post("<?php echo base_url(); ?>album/like", {
         comment_id: comment_id
     },
     function (data) {
         if ($.trim(data) == 'ok') {
             var like_span = parent.parent().find('.like_counter');
             var like = parseInt(like_span.text()) + 1;
             like_span.text(like);

             parent.html('<a href="javascript:void(0);" class="unlike_comment" ><?php echo $unlikeLable; ?></a>');
             parent.fadeIn(200);
             return false;
         } else {
             parent.fadeIn(200);
             alert(data);
         }
     })
 }) 
```

这段代码有什么问题吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-21T20:29:18.873

尝试`true`从事件处理程序返回以表示您处理了该事件。这样别人就不会捡了...

如果这不起作用，那么您可能正在为同一事件注册多个事件侦听器。使用您最喜欢的调试器暂停 javascript 执行，然后使用控制台检查相关 dom 元素上的所有事件侦听器。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-21T20:38:29.317

如果不查看其余代码并知道单击应用于哪个元素，很难知道，因此以下 3 种解决方案之一可以工作：

```
$('.like_comment').on('click',function(e) {
     //do something
     e.preventDefault();     // stops default button action, e.g. submitting a form
     e.stopPropagation();    // stops event bubbling back to parent element
   }  
   return false;         /// stops default link action
}); 
```

顺便说一句，live 现在已被弃用，取而代之的是“on”。

# java - 如何从 Java 表单应用程序保护 SQL Server 登录密码

> ID：10692143
> 
> 赞同：0
> 
> 时间：2012-05-21T20:28:01.043
> 
> 标签：java, .net, sql-server, security

我正在制作一个基于 Java 的表单桌面应用程序，一个迷你登录表单，它将能够登录到在 asp.net 中在线的大型系统。这个应用程序的目的是安装在电脑上，只要安装了这个exe，网站就可以登录，否则不能。问题是，我已经把 sql server 的连接字符串放在里面了，员工会在他们的机器上安装这个应用程序，有一个工具可以反编译 JAR 和类。当我在其中检查我的课程时，它显示了我的 sql server 密码。它可以让他们有机会破解这个应用程序，这对我们提供给他们或让他们有机会获得 sql server 密码真的很危险。你能帮忙吗，有没有这样的解决方案，我可以在连接字符串中给出MD5加密密码或一些加密密码，sql server可以理解它。
谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T22:57:05.787

有几种方法可以处理这个问题。

1.  连接字符串中的用户信息应仅限于执行一个过程：测试 MAC 地址是否有效的过程。这限制了曝光。不是以理想的方式，但它是某种东西。

2.  根本不发送连接字符串。而是让 java 应用程序将 mac 地址发布到 Web 服务。该服务应连接到数据库服务器以确定授权。优于选项 1。

3.  更好的是：不要依赖 MAC 地址。如果您担心有人会查看连接字符串，那么他们可能会更改其 MAC 地址以模仿另一台机器。理所当然地，任何熟悉到可以直接连接到数据库服务器的人也将熟悉到可以下载许多免费提供的工具之一来欺骗他们的 MAC。

这导致了一个评论：我认为你做错了。如果 Java 应用程序的全部目的是简单地读取 MAC 以验证该特定机器是否应该具有访问权限，那么您在理解安全性方面存在一些严重问题，我认为您确实需要评估您正在尝试的确切内容停止。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-21T20:49:45.063

您可以使用集成身份验证，前提是数据库服务器与您的用户位于同一活动目录域中。只需`Integrated Security=SSPI`在您的连接字符串中指定并授予与您希望他们能够在数据库中执行的操作相对应的常规用户权限（例如，只读访问权限），但仅此而已。

# installation - 安装 caldecott 时出错

> ID：10692147
> 
> 赞同：1
> 
> 时间：2012-05-21T20:28:31.187
> 
> 标签：installation, cloud-foundry

在 windows 上运行此命令时出现此错误`prompt> gem insatll caldecott`。我已经下载了开发包，但错误仍然是一样的。

请更新您的 PATH 以包含构建工具或从“http://rubyinstaller.org/downloads”下载 DevKit，并按照“http://github.com/oneclick/rubyinstaller/wiki/Development-Kit”中的说明进行操作

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-12T04:21:34.470

我遇到同样的错误并修复它。

请务必仔细遵循[安装说明](https://github.com/oneclick/rubyinstaller/wiki/development-kit)的每个步骤。
如果您在第 5 步成功测试安装。还剩下一件事要做。运行 devkitvars.bat(lives in ) 帮助脚本来更新 shell 的 %PATH% 环境变量。它将添加 2 条路径。

这是我运行后的 PATH 变量值： `PATH=c:\Ruby192\DevKit\bin;c:\Ruby192\DevKit\mingw\bin;C:\Ruby192\bin`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-21T22:18:39.597

听起来在您的路径中找不到 DevKit。根据说明（[https://github.com/oneclick/rubyinstaller/wiki/development-kit](https://github.com/oneclick/rubyinstaller/wiki/development-kit)），您是否按照步骤 5 测试安装？

如果这没有帮助，您可以尝试他们的故障排除页面：[https ://github.com/oneclick/rubyinstaller/wiki/Troubleshooting](https://github.com/oneclick/rubyinstaller/wiki/Troubleshooting)

# python - 生成 POT 文件

> ID：10692148
> 
> 赞同：0
> 
> 时间：2012-05-21T20:28:33.370
> 
> 标签：python, gettext, poedit, po, xgettext

PoEdit 会导致问题，因为它还会扫描不需要扫描的子目录中的 Python 源。所以我希望 PoEdit 从 POT 文件中获取有关字符串的新信息。据说[这里](http://www.poedit.net/trac/ticket/359)`xgettext`可以让我从源代码创建一个 POT 文件。但我不知道怎么做。它总是生成一个 PO 文件。

如何创建 POT 文件`xgettext`？还是旧的`pygettext`可以接受？还是有其他工具？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-21T22:42:04.877

Get [Babel](http://babel.edgewall.org/). It does just about everything you need pertaining to i18n and l10n you would need in a python project.

See also [instructions for setting it up in a Setuptools/Distribute project](http://babel.edgewall.org/wiki/Documentation/0.9/setup.html); if you are not yet using them, I suggest you do

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-21T21:16:02.140

只需运行`xgettext`并将生成的`domainname.po`文件重命名为`domainname.pot`.

见[http://www.gnu.org/software/gettext/manual/html_node/Template.html#Template](http://www.gnu.org/software/gettext/manual/html_node/Template.html#Template)

# java - 服务器中的空指针异常

> ID：10692151
> 
> 赞同：1
> 
> 时间：2012-05-21T20:28:38.390
> 
> 标签：java, multithreading, nullpointerexception

这是一个客户端-服务器程序。对于每个客户端，服务器都有一个方法，该方法检查是否有一些消息发送到该客户端。

代码：

```
 while (bool) {
            for(int j = 0;j<Start.bases.size();j++){
                if(Start.bases.get(j).getId() == id){
                    if(!Start.bases.get(j).ifEmpty()){
                        String output = Start.bases.get(j).getMessage();
                        os.println(output);
                        System.out.println(output +" *FOT* "+ addr.getHostName());
                    }
                }

            } 
```

每个线程都有一个 id。所以一切似乎都很好，但我在这一行得到了奇怪的空指针异常

```
if(Start.bases.get(j).getId() == id){ 
```

id - 整数。这真的很奇怪，因为我已经在调试这部分运行并检查了“bases”和“id”不为空，并且 bases 有适当的字段。基地不为空。

顺便说一句，bases 是静态的（因为每个线程都可以使用它），并且在使用此方法之前声明了 bases。

这条线不会引起问题

```
 for(int j = 0;j<Start.bases.size();j++){ 
```

可能是因为方法 getId() 吗？

```
public int getId(){
    return id;

} 
```

问题是什么？

已编辑。

```
 static ArrayList<Base> bases;
  bases = new ArrayList<Base>(); 
```

类基：

```
 public class Base {
private ServerThread st;
private int id;
private String name;
private ArrayList<String> messages;

public Base(String n, ServerThread s_t, int i_d){
    messages = new ArrayList<String>();
    st = s_t;
    name = n;
    id = i_d;
}

public String getName(){
    return name;
}
public int getId(){
    return id;
}
public ServerThread getThr(){
    return st;
}
public String getMessage(){
    String ret = "";

    if(!messages.isEmpty()){
        ret = messages.get(0);
        messages.remove(messages.get(0));
    }

    return ret;
}

public void addMessage(String m){
    messages.add(m);
}

public boolean ifEmpty(){
    return messages.isEmpty();
}
  } 
```

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-21T20:42:36.427

在这行代码中： (Start.bases.get(j).getId() == id

在这种情况下，您可能会有这样的例外：

```
1) bases is null - you said its wrong
2) bases.get(j) - it may occur only if you collection size was reduced during iteration(as mentioned Gray)
3) Start.bases.get(j).getId() is null. But as you mentioned getId() method return primitive int, so its not the case as in this situation you receive null ponter while casting - in line "    return id;". 
```

所以你应该检查第二种情况。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-22T00:32:35.857

鉴于这种：

*“我已经在调试这部分运行并检查了“bases”和“id”是否不为空，并且 bases 有适当的字段”*

还有这个：

*bases 是静态的（因为每个线程都可以使用它）*

我认为你很可能有比赛条件。在竞争条件下，有两个线程同时访问同一个数据结构（在本例中为 Start.bases）。大多数情况下，一个线程的代码完成得更快，一切都按照您期望的方式进行，但有时另一个线程会抢占先机或比平时快一点，事情就会“繁荣”。

当您引入带有断点的调试器时，您几乎*可以保证*带有断点的代码将最后执行，因为您已经在所有其他线程仍在运行时停止了它。

我建议您的列表的大小可能会在您执行时发生变化。当用户离开时，他们的条目是否从“基本”列表中删除？是否有其他情况可以在执行期间从另一个线程更改列表？

我建议的第一件事是您将代码切换为使用迭代器而不是直接的“for”循环。它不会让问题消失（它实际上可能使它更明显），但它会使正在发生的事情更加清晰。您将*在修改发生时*获得 ConcurrentModificationException ，而不是仅在发生某些更改组合时才有帮助的 NullPointerException 。）：

```
 for(Base currentBase : Start.bases)
        {
            if(currentBase.getId() == id && !currentBase.ifEmpty())
            {
                String output = currentBase.getMessage();
                os.println(output);
                System.out.println(output +" *FOT* "+ addr.getHostName());
            }
        } 
```

如果您*确实*在上面的代码中遇到了并发修改异常，那么您肯定是在处理竞争条件。这意味着您必须同步您的代码。

有几种方法可以做到这一点，具体取决于您的应用程序的结构。

*假设竞争只发生*在这段代码和另一段代码之间（执行从列表中删除的部分），您可以通过将两个代码块都包装在

```
synchronized(Start.bases)
{
   [your for-loop/item removal code goes here]
} 
```

这将在列表本身上获得一个锁，这样这两段代码就不会尝试在不同的线程中同时更新同一个列表。（请注意，它不会停止对 Base 对象本身的并发修改，但我怀疑这就是这种情况下的问题）。

综上所述，任何时候你有一个变量可以被多个线程读/写访问，它真的*应该*被同步。这是一项相当复杂的工作。如果可以的话，最好将同步保持在您管理的对象*内。*这样您就可以在一个地方查看所有同步代码，从而减少意外造成死锁的可能性。（在上面的代码中，您需要在 Start 类中创建“for”循环以及使用该列表的任何其他方法，然后将“bases”设为私有，以便应用程序的其余部分必须使用这些方法）。

如果没有看到代码中访问此列表的所有其他位置，我无法确切说明您应该进行哪些更改，但希望这足以让您入门。请记住，Java 中的多线程需要非常精巧的手！

# jquery - jQuery：追加异步加载的内容，维护顺序

> ID：10692152
> 
> 赞同：2
> 
> 时间：2012-05-21T20:28:40.187
> 
> 标签：jquery, asynchronous, append

我有一组要异步加载的内容 URL，例如

```
var toLoad = ['snippet1.html', 'snippet2.html', ... ]; 
```

我正在尝试使用 AJAX 加载每个片段并将其附加到 parent `<div>`，保持数组中内容的顺序。由于我的其余代码的设置方式（以及出于性能原因），我*不想*以同步方式加载，无论是通过调用`async:false`还是通过链接`.ajax()`调用，正如对[类似问题](https://stackoverflow.com/questions/5532428/how-to-use-jquery-to-load-from-array-of-pages-in-order)的回答中所建议的那样。相反，我想将逻辑放入 AJAX 回调函数中，以根据索引正确放置加载的片段。

以下代码有效：

```
var $parent = $('#mydiv');
toLoad.forEach(function(url, i) {
    // load snippet
    $.get(url, function(snippet) {
        // attach order to DOM element
        snippet = $(snippet).data('order', i);
        // find the sibling with the next lowest order number
        var $prev = $parent
            .children()
            .filter(function() {
                return $(this).data('order') < i
            })
            .last();
        if ($prev[0]) snippet.insertAfter($prev); 
        else $parent.prepend(snippet);
    });
}); 
```

……但我不喜欢它。特别是，我不喜欢用 ; 将订单附加到 DOM 元素上`.data()`。这看起来很难看，如果我能帮上忙，我宁愿不要把它放到 DOM 中。

**有没有更好的方法来实现将内容异步加载到具有预定义顺序的 div 的目标？**

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-21T21:28:54.633

有一个简单的递归，等到一个完成后再开始下一个：

```
var toLoad = ['snippet1.html', 'snippet2.html', ....];
var $parent = $('#mydiv');
var i = 0;

getSnippet(toLoad[i]);

function getSnippet(url) {
    $.get(url, function(snippet) {
        $parent.append(snippet);
        if (i<toLoad.length) getSnippet(toLoad[i++]);
    });
}​ 
```

然后一次完成它们，只需将它们粘贴在一个数组中，`done()`一个接一个地运行函数以确保按顺序插入元素：

```
var toLoad = ['snippet1.html', 'snippet2.html', 'snippet3.html'];
var $parent = $('#mydiv');
var gets = [];

toLoad.forEach(function(url, i) {
    var XHR = $.get(url);
    gets.push(XHR);
});

gets[0].done(function(snippet) {
     $parent.append(snippet);
     gets[1].done(function(snippet) {
         $parent.append(snippet);
         gets[2].done(function(snippet) {
             $parent.append(snippet);
         });
     });
});
​ 
```

如果进行许多 ajax 调用，这可能会在某种循环中完成。

然后是[延迟对象](http://api.jquery.com/category/deferred-object/)和[承诺](http://api.jquery.com/deferred.promise/)：

```
$.when($.get(toLoad[0]), 
       $.get(toLoad[1])
       $.get(toLoad[2])
      ).done(function(value1, value2, value3) {
      // value1 etc. are arguments resolved for the ajax requests, respectively
      // arguments are [ "success", statusText, jqXHR ]
        $parent.append(value1[2]+value2[2]+value3[2]);
      }
}); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-21T20:46:49.770

如果您的主要抱怨是使用 .data()，您可以维护自己的数组，将 dom 节点元素与值相关联。

```
var map = [
    {order: 5, nodeReference: ...},
    {order: 9, nodeReference: ...},
    {order: 1, nodeReference: ...}
];
function data(node) {
    // loop through map, comparing to nodeReference to get the order 
} 
```

//进而 ...

```
 .filter(function() {
        return data(this) < i
    }) 
```

您的代码大部分保持不变，除了当您将某些内容附加到 dom 时需要添加到地图中。

我会努力在加载后立即将内容逐步添加到 dom 中，就像您现在所做的那样。我不会等到所有内容都加载完毕，甚至按顺序添加它们。让订单最终像您现在一样自行解决。这就是网络浏览器在网页中加载图像的方式，其中有很深的原因。

# php - 如果字段小于 0 且大于 0，MySQL 选择需要计数

> ID：10692153
> 
> 赞同：4
> 
> 时间：2012-05-21T20:28:48.547
> 
> 标签：php, mysql

如果大于零且等于零，是否有办法编写 mysql select 语句以仅对特定的 1 字段运行计数。

我可以编写 2 条语句来实现这一点，但是否可以在一条语句中完成。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-05-21T20:30:05.193

可能是这样的：

```
SELECT SUM(CASE WHEN x > 0 THEN 1 ELSE 0 END) as GreatherThanZero
    , SUM(CASE WHEN x = 0 THEN 1 ELSE 0 END) as EqualZero
FROM table
WHERE x >= 0 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-05-21T20:45:06.073

是的。

```
SELECT COUNT(*) FROM Table WHERE Field > 0
UNION SELECT COUNT(*) FROM Table WHERE Field = 0 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-21T20:32:54.327

是的。

```
SELECT SUM(CASE WHEN column > 0 THEN column ELSE 0 END CASE), SUM(CASE WHEN column < 0 THEN column ELSE 0 END CASE) FROM mytable 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-21T20:30:50.750

好吧，如果我正确理解了您的问题，那么这样的事情应该可以工作：

```
SELECT
   COUNT(Field)
FROM
   Table
WHERE 
   Field >= 0 
```

# matlab - 将 .mat 文件加载到另一个文件中，而不使用 .mat 文件中的变量名

> ID：10692156
> 
> 赞同：1
> 
> 时间：2012-05-21T20:28:57.470
> 
> 标签：matlab, matlab-load

这个问题很烦人。情况是这样的，我的 .mat 文件中只有一个变量。我很感兴趣将它加载到另一个变量中，而无需从我尝试加载的文件中访问该变量。对，现在我尝试了这样的方法，但没有效果：

```
 A=[];
  details=whos(FileName);
  aux=load(FileName,upper(details.name);  
  A=aux.(details.name); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-21T20:35:12.477

由于您的 MAT 文件中只有一个变量，您可以加载整个文件并从中提取所需的名称：

```
aux=load(FileName);
names=fieldnames(aux);
A=aux.(names{1}); 
```

# ssas - 维度中的自定义间隔

> ID：10692158
> 
> 赞同：0
> 
> 时间：2012-05-21T20:29:06.050
> 
> 标签：ssas, olap, cube, olap-cube

我在这里寻找关于最佳实践的建议。

我有一个要求，在给定的一天，我必须有任意数量的间隔（想想由事务组成的时间桶），我每天最多可以有 N 个间隔。这些间隔类似于时间，但可以是任意长度，即有些是秒，有些是分钟。

间隔应该如何形成取决于我的源数据。在任何一天，我们总是从间隔 1 开始，并且不知道 EOD 将拥有的间隔总数，每个间隔由固定数量的事务定义。对于每个间隔，我还需要知道结束时间。

这里最好的方法是什么？我应该存储我的事实表并连接到标准的小时/分钟/秒维度，还是应该使用我的事务数据来创建一个适应它的维度？

感谢您的反馈。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-23T11:15:33.797

如果桶准时，您可能必须在您的一个维度上进行操作。属性上有一个名为 bucket 的属性可以为您执行此操作

# ruby-on-rails - Capybara 请求规范与 JS 的问题 - 找不到模型

> ID：10692161
> 
> 赞同：3
> 
> 时间：2012-05-21T20:29:21.013
> 
> 标签：ruby-on-rails, capybara, capybara-webkit

我遇到了 JS 请求规范的问题 - 模型编辑页面的基本访问：

```
it "can edit a doc", :js => true do
  doc = FactoryGirl.create(:doc) # tried with Doc.create as well
  puts Doc.find(doc.id) # 1 <- so it's definitely in the DB!
  visit edit_doc_path(doc) 
end 
```

结果：***“ActiveRecord::RecordNotFound - 找不到 id=1 的文档”***

奇怪的是它适用于标准请求规范。我尝试了 webkit 和 selenium 驱动程序。我的 spec_helper 看起来像这样（应该很标准）：

```
RSpec.configure do |config|
  config.use_transactional_fixtures = false

  Capybara.javascript_driver = :webkit

  config.before(:suite) do
    DatabaseCleaner.strategy = :transaction
  end

  config.before(:each) do
    DatabaseCleaner.start
  end

  config.after(:each) do
    DatabaseCleaner.clean
  end

  config.before(:each, :type => :request) do
    Capybara.reset_sessions!
  end
end 
```

Rails 3.1.4，没有对 capybara、rspec 等测试库的版本控制。

非常感谢任何输入！谢谢！

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-05-22T00:01:23.480

似乎您遇到了与此相同的问题： [Capybara with :js => true 导致测试失败](https://stackoverflow.com/questions/8178120/capybara-with-js-true-causes-test-to-fail)

尝试将 DatabaseCleaner 策略设置为 :truncation 并查看它是否有效

```
config.before(:suite) do
  DatabaseCleaner.strategy = :truncation
end 
```

# ruby - Ruby gui Scribble - 如何获得它

> ID：10692164
> 
> 赞同：0
> 
> 时间：2012-05-21T20:29:35.727
> 
> 标签：ruby, scribble

我阅读了下面的文章并想尝试在 Ruby 中涂鸦，但我能找到的唯一来源是我没有或使用的 svn。

链接在这里

```
http://nex-3.com/posts/3-scribble 
```

这是一个 gem，我该如何安装它？它可以在 Ruby193/Windows7 上运行吗？请分享你的经验。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-21T21:08:25.593

您链接的页面说：

> 你现在可以从它的 Subversiony 主页下载并运行 Scribble。这个家目前在 Hampton Catlin 的服务器上，因为我的不支持 Subversion。
> 
> ```
> svn co svn://hamptoncatlin.com/scribble/trunk scribble 
> ```
> 
> 要运行它，只需运行`bin/scribble`文件。当然，它需要 Ruby，以及最新的 Ruby GTK+ 绑定和 Ruby Cairo 绑定（当然还有 GTK 和 Cairo 本身）。请注意，这不适用于最新的 RubyGems——您实际上需要自己编译最新的开发版本。如果您拥有所有这些，它应该能够在 OSX、Linux 和 Windows 上运行。

不幸的是，SVN 服务器似乎在 2010 年左右的某个时候消失了。在[https://code.launchpad.net/~vcs-imports/scribble/trunk](https://code.launchpad.net/%7Evcs-imports/scribble/trunk)上似乎有一个代码分支，但我什至没有看了看代码，更不用说尝试使用它了。您可能需要一个 Bazaar 客户端 ( `bzr`) 来获取它...此时将适用其余说明。

# php - Firebug 用于调试 jQuery 元素

> ID：10692166
> 
> 赞同：0
> 
> 时间：2012-05-21T20:30:03.963
> 
> 标签：php, jquery, debugging, firebug

我正在使用 Firebug 调试我的 jQuery DataTable。因此，在 Firebub 面板中，我看到：

```
<div id="newspaper-b_length" class="dataTables_length">
<label>
Show
<select name="newspaper-b_length" size="1" aria-controls="newspaper-b">
entries
</label>
</div> 
```

但我的 php 文件中没有这段代码。实际上，我如何在我的 php 文件中找到这些代码行？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-21T20:32:25.033

这些是`datatables`插件创建的附加包装器，用于显示下拉条目。

大多数小部件创建包装器/附加 div 以显示其小部件控件。这些 div 是由 datatables 插件动态创建的，因此您不会在 php 代码中找到它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-21T20:36:08.810

“Firebug 的 HTML 选项卡向您展示了 HTML 现在的样子。” 正如你[在这里](http://getfirebug.com/html)看到的。
可能它是由其他代码 php、js 或 html 生成的。

# jquery - jQuery 选择器（来自插件）在 jsFiddle 中工作，但不是真实页面？

> ID：10692169
> 
> 赞同：0
> 
> 时间：2012-05-21T20:30:15.660
> 
> 标签：jquery, html, plugins

对于我的生活，我无法弄清楚为什么尝试通过 jQuery 全局对象选择一个元素在 jsFiddle 中有效，但在普通页面上无效。

[HTML](https://gist.github.com/2764435)

[JSFiddle](http://jsfiddle.net/U3x69/1/)

一段时间以来，我一直在努力解决这个问题，构建一个更大的插件，并最终将其缩小到这个奇怪的差异。

我在这里缺少什么吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-21T20:33:21.440

发生这种情况是因为在您的页面上您没有等待 DOM 在运行之前准备好`$.salsaform();`。

jsFiddle 将您的代码放在一个`onLoad`处理程序中，因此它会在 DOM 准备好后运行。

将您的脚本更改为：

```
(function ($) {
  $.salsaform = function () {
    console.log($('#foo'));
  };
})(jQuery);

$(function(){
    $.salsaform();
}); 
```

在`$(function(){...})`DOM 准备好后运行您的代码。

# eclipse - Maven和依赖

> ID：10692180
> 
> 赞同：-2
> 
> 时间：2012-05-21T20:30:51.790
> 
> 标签：eclipse, maven

我不太明白我们需要 maven 来做什么以及依赖是什么。

谁能用简单的话解释一下是什么意思？它在哪里寻找它们？写作时：

```
<dependency>
  <groupId>org.eclipse.persistence</groupId>
  <artifactId>eclipselink</artifactId>
  <version>2.0.0</version>
</dependency> 
```

它说：

```
Missing artifact org.eclipse.persistence:eclipselink:jar:2.0.0 
```

这是什么意思？

我的系统上安装了 2 个版本的 maven - 一个用于 cmd，第二个作为 eclipse 插件。有什么不同？使用 Maven 的哪种方式更常见——来自 cmd 还是来自 eclipse？我在某处读到 maven 需要连接到互联网 - 那是为了什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-22T04:14:14.890

我猜你是 Maven 的新手，我建议你通过以下链接

[什么是马文？](http://maven.apache.org/what-is-maven.html)

[DeveloperWorks 文章](http://www.ibm.com/developerworks/java/tutorials/j-mavenv2/)

[Java 世界中的文章](http://onjava.com/pub/a/onjava/2006/03/29/maven-2-0.html)

[更多 Maven 文章](http://maven.apache.org/articles.html)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-21T20:48:21.613

Maven 是一个构建工具（如 ant），它可以从在线服务器中提取特定版本的库和其他依赖项。如果您想使用库中的方法（甚至是旧版本），则无需在计算机上安装库，maven 将获取指定的版本并为您存储。您甚至可以拥有两个项目，它们使用同一库的两个不同版本并且没有任何冲突，因为 maven 将为您处理所有库。

您拥有的代码指定您将使用 eclipselink 库的 2.0.0 版本。Maven 将搜索该库的那个版本，首先在它的库缓存中，然后在在线数据库中，并与库一起编译您的代码，因此您的类可以访问库方法。

我不认为命令行或 eclipse 插件更受欢迎 - 我主要使用命令行，但都安装了。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-14T15:20:15.670

至于为什么maven提示你的依赖缺失，可以通过[http://mvnrepository.com](http://mvnrepository.com)在maven中央仓库中查找依赖。搜索“org.eclipse.persistence”表明实际上可能需要：

```
<dependency>
<groupId>org.eclipse.persistence</groupId>
<artifactId>javax.persistence</artifactId>
<version>2.0.0</version>
</dependency> 
```

# iphone - 在 SubView 上设置委托

> ID：10692181
> 
> 赞同：0
> 
> 时间：2012-05-21T20:31:21.090
> 
> 标签：iphone, ios, ipad, uiviewcontroller, uisplitviewcontroller

我有一个 splitViewController，它有一个主视图控制器和一个详细视图控制器。下面的代码来自主人，它在细节中创建了新的视图：

```
UIViewController *controller = [self.storyboard instantiateViewControllerWithIdentifier:[NSString stringWithFormat:@"%@",[self.defaultSettingsMenuItems objectAtIndex:indexPath.row]]];

[self.detailViewController.view addSubview:controller.view]; 
```

detailViewController 是 DetailViewController 的全局实例。在 detailViewController 中，我有很多 textField，需要使用 UITextFieldDelegate。但是，我认为此时 detailViewController 不是 self，这就是为什么在 detailViewController 中使用 TextFieldDelegate 方法时出现 EXC_BAD_ACCESS 错误的原因。

编辑：我现在发现 subView 委托方法仅适用于我在 Storyboard 中设置为 rootViewCONtroller 关系的 viewController。前任。如果我在上面的默认菜单设置中有 6 个视图，那么无论我在情节提要中设置为第一个视图还是根视图，都将正常工作。显示的任何和所有其他子视图（通过在主视图中进行新选择）将无法正常工作。我认为这将有助于诊断问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T20:57:58.597

我不熟悉情节提要，但我看不到您在`detailViewController`任何地方设置 ' 代表。`self.detailViewController.delegate = self;`在将控制权交给子视图之前，您可能需要在某个地方拥有类似的东西。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-22T14:19:47.290

这就是我所需要的，第二行：

```
UIViewController *viewController= [self.detailViewController.storyboard instantiateViewControllerWithIdentifier:[NSString stringWithFormat:@"%@",[self.defaultSettingsMenuItems objectAtIndex:indexPath.row]]];

if (self.detailViewController.childViewControllers.count >= 1) {
    NSLog(@"childViewControllers: %@",self.detailViewController.childViewControllers);
    [[self.detailViewController.childViewControllers objectAtIndex:0] removeFromParentViewController]; 

}

[self.detailViewController addChildViewController:viewController];

[self.detailViewController.view addSubview:viewController.view]; 
```

编辑：我已经用 if 从堆栈中删除 viewControllers 更新了我的答案。有点hacky，但功能齐全。

# agile - 技术债务的敏捷估算

> ID：10692182
> 
> 赞同：0
> 
> 时间：2012-05-21T20:31:25.257
> 
> 标签：agile, estimation, technical-debt

在估算（故事点）一个包含使用已知技术债务扩展当前功能的故事时，我们应该考虑重构当前代码所花费的努力还是应该独立于该技术债务进行估算？

**问题移至[链接](https://softwareengineering.stackexchange.com/questions/149539/agile-estimation-with-tech-debt)**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-21T20:38:30.400

我会在不考虑技术债务的情况下进行估算。当然，这笔债务仍然存在，您可能已经知道它有多少，因此您应该降低该 sprint 的速度。

这也向产品负责人展示了技术债务的真正成本：'嘿，通常我们会做 30 个故事点，但由于所有这些债务，我们只能做 20 个。要不要多花点时间来清理这个烂摊子，这样我们才能稍后获得更高的速度？”

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-21T20:32:59.107

我会投票支持用技术债务进行估算。重构不会是免费的，因此忽略该成本会误导您和您的客户。

# iphone - 如何使用情节提要更改 iOS5 中的初始视图？

> ID：10692186
> 
> 赞同：0
> 
> 时间：2012-05-21T20:31:44.300
> 
> 标签：iphone, objective-c, ios, ios5, uistoryboard

我正在尝试为我的应用程序（介绍页面）设置一个初始视图，并且在用户确认此页面之后，默认情况下会显示一个选项卡式视图。我是 iOS 新手，但我的第一个猜测是创建一个标准视图控制器并将其设置为初始视图。然后当用户按下确定时，将值存储到文件并在每次打开应用程序时加载值。如果他们已经按下 ok 导航到选项卡式屏幕。

我的第二个选择可能是显示某种类型的对话框，完全覆盖选项卡式视图，这可能会更简单。我不知道。

不过，这里建议的大多数方法的问题是它们不使用情节提要（关于编辑应用程序委托的建议）。我上面概述的方法是解决这个问题的正确方法吗？如果没有，有人可以就如何实现这一点提供一些指导。

就像我之前说的，这一切都是新的（来自 WP7），如果我没有说明正确的条款，很抱歉。我很感激你的时间。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-21T20:44:07.090

假设您的第一个选项卡的视图控制器名为 FirstViewController。编辑 FirstViewController 的 viewDidLoad：

```
- (void)viewDidLoad {
   [super viewDidLoad];

    NSUserDefaults *defaults = [NSUserDefaults standardUserDefaults];
    BOOL alreadyShownWelcomeScreen = [defaults boolForKey:@"alreadyShownWelcomeScreen"];
    if (alreadyShownWelcomeScreen) {
        // Already shown welcome screen. Do nothing.
    } else {
        // Show welcome screen

        WelcomeViewController *controller = [[WelcomeViewController alloc] initWithNibName:@"WelcomeViewController" bundle:nil];
       [self presentModalViewController:controller animated:YES];

       // Update NSUserDefaults.
       [defaults setBool:YES forKey:@"alreadyShownWelcomeScreen"];
       [defaults synchronize];
    } 
```

注意：这仅在您始终使用 FirstViewController 启动时才有效。如果您想保持状态并在不同的选项卡中启动应用程序，您必须将此代码移动到其他地方（例如 AppDelegate.m）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-22T19:13:28.737

You could also do this all from within a storyboard. Your initial view controller can have a segue to the tabbed controller and it will only follow that segue given your conditions are met.

# javascript - 如何使用来自 javascript 的 post 请求发送文件内容

> ID：10692188
> 
> 赞同：1
> 
> 时间：2012-05-21T20:31:53.977
> 
> 标签：javascript, jquery, google-chrome-extension

我有一个图片网址，fe [http://img.ffffound.com/static-data/assets/6/13faae6d1de505622e81c366af990bad3968896c_m.jpg](http://img.ffffound.com/static-data/assets/6/13faae6d1de505622e81c366af990bad3968896c_m.jpg)

我需要将它作为带有 JS 的 multipard/form-data 文件（来自 chrome 扩展名）发布到服务器我该怎么做？

# c - 声明一个由固定长度字符串组成的可变长度数组

> ID：10692189
> 
> 赞同：6
> 
> 时间：2012-05-21T20:31:58.170
> 
> 标签：c, arrays, pointers, syntax

我需要一个字符串数组。字符串的长度在编译时是已知的，每个字符串占用这么多空间是至关重要的。另一方面，字符串的数量只有在运行时才知道。这个的语法是什么？

`char* data[STRLENGTH]`是不正确的语法。`char** data`大多数情况下有效，但随后`sizeof(data[0])`是错误的——它应该等于`STRLENGTH`.

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-05-21T20:37:48.203

@Daniel 是正确的，但这段代码可能会让阅读它的人感到困惑——这不是你通常会做的事情。为了使其更易于理解，我建议您分两步进行：

```
typedef char fixed_string[STRLENGTH];
fixed_string *data; 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-05-21T20:58:04.713

```
char (*data)[LEN];                   // where LEN is known at compile time
...
data = malloc(sizeof *data * rows);  // where rows is determined at run time
...
strcpy(data[i], some_name);
...
printf("name = %s\n", data[i]);
...
free(data); 
```

请注意，它`data`是指针类型，而不是数组类型（`data`是指向 的`LEN`-element 数组的指针`char`）。该`malloc`调用将动态分配足够的内存来保存`rows`长度数组`LEN`。每个`data[i]`都是 type `char [LEN]`。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-05-21T20:36:14.427

```
char* data[STRLENGTH] 
```

`STRLENTGH`声明一个指向 的指针数组`char`。要声明指向`STRLENGTH` `char`s 数组的指针，请使用

```
char (*data)[STRLENGTH] 
```

# python - ArgumentError：解析（本地或远程）datastore_v3.Put（）的参数时发生错误

> ID：10692191
> 
> 赞同：0
> 
> 时间：2012-05-21T20:32:05.117
> 
> 标签：python, google-app-engine

我的应用程序昨晚开始抛出这个错误。用户抱怨该网站也很慢。仍然在 Python 2.5 上。据我所知，请求本身并不罕见。

有任何想法吗？

```
 Traceback (most recent call last):
  File "/base/python_runtime/python_lib/versions/1/google/appengine/ext/webapp/_webapp25.py", line 703, in __call__
    handler.post(*groups)
  File "/base/data/home/apps/s~jupitersfolly/4.357517623694016771/controller/frequest.py", line 57, in post
    request_types[request_type]()
  File "/base/data/home/apps/s~jupitersfolly/4.357517623694016771/controller/frequest.py", line 78, in order
    event, report, messages = Game.update(game_number, user_id, order)
  File "/base/data/home/apps/s~jupitersfolly/4.357517623694016771/model/game.py", line 355, in update
    event, report, game, universe, messages, updated, ended = db.run_in_transaction(Game.transactional_update, key_id, user_id, order)
  File "/base/python_runtime/python_lib/versions/1/google/appengine/api/datastore.py", line 2433, in RunInTransaction
    return RunInTransactionOptions(None, function, *args, **kwargs)
  File "/base/python_runtime/python_lib/versions/1/google/appengine/api/datastore.py", line 2571, in RunInTransactionOptions
    ok, result = _DoOneTry(new_connection, function, args, kwargs)
  File "/base/python_runtime/python_lib/versions/1/google/appengine/api/datastore.py", line 2593, in _DoOneTry
    result = function(*args, **kwargs)
  File "/base/data/home/apps/s~jupitersfolly/4.357517623694016771/model/game.py", line 348, in transactional_update
    game.put()
  File "/base/python_runtime/python_lib/versions/1/google/appengine/ext/db/__init__.py", line 1074, in put
    return datastore.Put(self._entity, **kwargs)
  File "/base/python_runtime/python_lib/versions/1/google/appengine/api/datastore.py", line 579, in Put
    return PutAsync(entities, **kwargs).get_result()
  File "/base/python_runtime/python_lib/versions/1/google/appengine/api/apiproxy_stub_map.py", line 604, in get_result
    return self.__get_result_hook(self)
  File "/base/python_runtime/python_lib/versions/1/google/appengine/datastore/datastore_rpc.py", line 1577, in __put_hook
    self.check_rpc_success(rpc)
  File "/base/python_runtime/python_lib/versions/1/google/appengine/datastore/datastore_rpc.py", line 1212, in check_rpc_success
    rpc.check_success()
  File "/base/python_runtime/python_lib/versions/1/google/appengine/api/apiproxy_stub_map.py", line 570, in check_success
    self.__rpc.CheckSuccess()
  File "/base/python_runtime/python_lib/versions/1/google/appengine/api/apiproxy_rpc.py", line 133, in CheckSuccess
    raise self.exception
    ArgumentError: An error occurred parsing (locally or remotely) the arguments to datastore_v3.Put() 
```

# php - MongoCursorException 被抛出，但没有被 Lithium 中的 try/catch 捕获

> ID：10692193
> 
> 赞同：2
> 
> 时间：2012-05-21T20:32:09.527
> 
> 标签：php, mongodb, lithium

我正在使用 \lithium\data\source\MongoDB::update() 在安全模式下执行 upsert。在某些更新中，由于传递了重复的键，因此会出现预期的 MongoCursorException。下面的 try/catch 不会捕获错误，它会返回到我附加到 Dispatcher::run() 的 ErrorHandler。

```
try {
    $result = Items::update($record, $conditions, array('upsert' => true, 'safe'   => true));
} catch (MongoCursorException $e) {
    $result = false;
} catch (Exception $e) {
    $result = false;
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-21T20:57:16.397

您需要在文件顶部添加 use 语句，或在异常类名称前放置反斜杠以指示它们来自全局范围而不是您的命名空间。我更喜欢类顶部的 use 语句。

```
use MongoCursorException;
use Exception; 
```

# web-services - 在肥皂 ESB 请求中使用或不使用 Keep-alive

> ID：10692197
> 
> 赞同：0
> 
> 时间：2012-05-21T20:32:29.620
> 
> 标签：web-services, soap, esb, keep-alive

从 ESB 系统到 WebService 的 HTTP SOAP 请求的最佳方法是使用还是不保持活动？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-23T04:27:34.693

使用 HTTP keep alive 的理由是使用同一个 TCP 连接来发送和接收多个 HTTP 请求/响应（否则我们必须为每个请求/响应对打开一个新连接。因此使用持久连接对于改进 HTTP 非常重要表现。

我们应该记住，SOAP 和 HTTP-Keep alive 是两个正交的东西。但是，当我们谈到 Web 服务性能时，是的，使用 keep alive 会好得多。

# php - 在php社交网络中一直找不到错误

> ID：10692201
> 
> 赞同：1
> 
> 时间：2012-05-21T20:32:38.590
> 
> 标签：php, controller, http-status-code-404, social-networking

我正在阅读 Michael Peacock 的《PHP 5 Social Networking》一书。它是关于创建社交网络的框架。它将源代码上传到服务器，创建了数据库，并且在我再次重新上传源代码之前一切正常，现在我一直收到错误消息“找不到错误 404”。据我了解，整个事情通过一个主控制器工作 - “index.php”，然后根据它应该做什么将控制传递给其他控制器。这是 index.php 代码：

```
<?php

session_start();

DEFINE("FRAMEWORK_PATH", dirname( __FILE__ ) ."/" );

require('registry/registry.class.php');
$registry = new Registry();
// setup our core registry objects
$registry->createAndStoreObject( 'template', 'template' );
$registry->createAndStoreObject( 'mysqldb', 'db' );
$registry->createAndStoreObject( 'authenticate', 'authenticate' );
$registry->createAndStoreObject( 'urlprocessor', 'url' );
$registry->getObject('url')->getURLData();
// database settings
include(FRAMEWORK_PATH . 'config.php');
// create a database connection
$registry->getObject('db')->newConnection( $configs['db_host_sn'], $configs['db_user_sn'], $configs['db_pass_sn'], $configs['db_name_sn']);

$registry->getObject('authenticate')->checkForAuthentication();

// store settings in our registry
$settingsSQL = "SELECT `key`, `value` FROM settings";
$registry->getObject('db')->executeQuery( $settingsSQL );
while( $setting = $registry->getObject('db')->getRows() )
{
    $registry->storeSetting( $setting['value'], $setting['key'] );
}
$registry->getObject('template')->getPage()->addTag( 'siteurl', $registry->getSetting('siteurl') );
$registry->getObject('template')->buildFromTemplates('header.tpl.php', 'main.tpl.php', 'footer.tpl.php');

$controllers = array();
$controllersSQL = "SELECT * FROM controllers WHERE active=1";
$registry->getObject('db')->executeQuery( $controllersSQL );
while( $controller = $registry->getObject('db')->getRows() )
{
    $controllers[] = $controller['controller'];
}
$controller = $registry->getObject('url')->getURLBit(0);

if( $registry->getObject('authenticate')->isLoggedIn() )
{
    $registry->getObject('template')->addTemplateBit('userbar', 'userbar_loggedin.tpl.php');
    $registry->getObject('template')->getPage()->addTag( 'username', $registry->getObject('authenticate')->getUser()->getUsername() );

}
else
{
    $registry->getObject('template')->addTemplateBit('userbar', 'userbar.tpl.php');
}

if( in_array( $controller, $controllers ) )
{

    require_once( FRAMEWORK_PATH . 'controllers/' . $controller . '/controller.php');
    $controllerInc = $controller.'controller';
    $controller = new $controllerInc( $registry, true );

}
else
{
    // default controller, or pass control to CMS type system?
}

$registry->getObject('template')->parseOutput();
print $registry->getObject('template')->getPage()->getContentToPrint();

?> 
```

我真的不明白这是怎么回事！

# php - 如何接收这个 curl 帖子？

> ID：10692203
> 
> 赞同：0
> 
> 时间：2012-05-21T20:32:44.657
> 
> 标签：php, xml, post

我必须在服务器页面上做什么以及如何接收这个 xml 文件？我被困住了。xml 很好，使用 simplexml_load_string 检查。

```
 $var='caca';
 $login_xml ='<xml>'.
         '<action>log_in</action>'.
     '<parameters>'.
         '<username>'.$var.'</username>'.
     '<pass>abdef01</pass>'.
     '</parameters>'.
     '</xml>';

 $URL = "http://myurl.com/login.php/";

 $ch = curl_init($URL);
 curl_setopt($ch, CURLOPT_MUTE, 1);
 curl_setopt($ch, CURLOPT_POST, 1);
 curl_setopt($ch, CURLOPT_HTTPHEADER, array('Content-Type: text/xml'));
 curl_setopt($ch, CURLOPT_POSTFIELDS, "$login_xml");
 curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);
 $output = curl_exec($ch);
 curl_close($ch); 
```

感谢您的时间。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-21T21:37:37.673

由于数据是作为文本/xml 发送的，而不是作为 url 编码的表单数据发送的，所以不能使用 $_POST。您必须从 php://input 流中读取原始请求

```
$xml = file_get_contents('php://input'); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-21T20:43:28.413

您的 CURLOPT_POST_FIELDS 中有错误：此选项必须是数组：

```
...
$data = array('xml' => $login_xml);
... 
```

接着：

```
...
curl_setopt($ch, CURLOPT_POSTFIELDS, $data);
... 
```

这会将值“xml”作为 post 字段发送；

希望这可以帮助。

# ruby - 我的 rake 任务似乎没有其他对象在范围内？

> ID：10692206
> 
> 赞同：2
> 
> 时间：2012-05-21T20:32:55.920
> 
> 标签：ruby, scope, rake

（我没有使用 Rails）

我有一个 rake 任务，它设置传入的环境，如：

```
rake some:task ENV=test 
```

我的任务是：

```
 desc "environment"
  task :environment do
    env = ENV['ENV'] || 'development'
  end 
```

现在，如果我有这样的任务：

```
 desc "t1"
  task :t1 [:environment] do
    puts env
  end 
```

它没有说 env 不知道，这是为什么呢？

我认为 ruby​​ 的动态特性会这样做：

在运行环境任务时，它会创建环境变量，并且由于它是一个依赖项，因此该变量将在我的其他任务的范围内。

我怎样才能拥有它，使其在范围内？

注意：以防万一，我的一些任务位于不同的 .rake 文件中，只是提及是否有任何改变。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-21T20:50:08.177

Rakefile 就像任何其他 Ruby 代码一样。块变量（在内部创建的变量`do-end`）是块的本地变量。

要使您的`env`变量在其他块中可见，只需将其分配给实例变量：

```
@env = ENV['ENV'] ...
...
puts @env 
```

或者你也可以使用一个常量：

```
MYENV = ENV['ENV'] ....
...
puts MYENV 
```

或者在使用之前在块范围之外创建变量：

```
env = nil

task :environment do
  env = ENV['ENV'] ....
end

task :othertask ... do
  puts env
end 
```

# url - Magento - 使侧边导航链接对 SEO 友好

> ID：10692208
> 
> 赞同：0
> 
> 时间：2012-05-21T20:33:05.300
> 
> 标签：url, magento

我的顶级类别链接正确链接，

餐厅：www.yoursite.com/dining-room-furniture.html

但我的子类别是这样链接的 餐厅椅：www.yoursite.com/dining-room-furniture.html?cat=87

而不是这个餐厅椅子：www.yoursite.com/dining-room-furniture/chairs.html

有没有办法让他们链接我在管理/目录/管理类别中设置的方式？这样我就有可能获得餐厅家具椅子的排名，而不是 cat 87。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-22T06:46:32.897

有一个不错的插件： http: [//www.magentocommerce.com/magento-connect/seo-layered-navigation-6466.html](http://www.magentocommerce.com/magento-connect/seo-layered-navigation-6466.html)

# linux - 不使用 printk 写入 linux 控制台

> ID：10692211
> 
> 赞同：2
> 
> 时间：2012-05-21T20:33:12.527
> 
> 标签：linux, linux-kernel

这可能是一个愚蠢的问题，但是有没有一种方法可以在不使用 printk（即 syslog）的情况下从驱动程序中写入 linux 控制台？

例如，在 linux 驱动程序中工作，我需要在事件发生时输出单个字符。我想在写事件开始时输出“w”，在结束时输出“W”。这种情况经常发生，因此通过 syslog 发送它并不理想。

理想情况下，如果我可以做相当于 printf("W") 或 putc('W') 的操作，然后简单地退出默认控制台，那就太好了。

TIA 迈克

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-22T06:38:29.053

写入控制台不是您想要经常做的事情。如果`printk`对你来说太贵了，你不应该以任何方式尝试控制台。

但如果你坚持：

在 内`printk`，打印到控制台由`call_console_drivers`. 此函数找到控制台（通过 注册`register_console`）并调用它来打印数据。实际的驱动程序取决于您使用的控制台。VGA 屏幕是一个选项，串行端口是另一个选项（取决于启动参数）。

您可以尝试使用中的功能`console.h`直接与控制台交互。我不知道让它工作有多难。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-21T23:43:17.033

不幸的是，没有，因为内核中没有“控制台”的概念（即用户空间进程）。您可以尝试其他[内核调试选项](http://elinux.org/Kernel_Debugging_Tips)

# sql-server-2008 - 来自 Sharepoint 的大型 SQL 查询导致性能问题

> ID：10692212
> 
> 赞同：0
> 
> 时间：2012-05-21T20:33:13.057
> 
> 标签：sql-server-2008, sharepoint-2007

这是我的问题。我们的 Sharepoint 2007 站点上的所有页面都由 Web 部件呈现。Web 部件从列表中提取数据并将它们显示在页面上。在过去的几周里，性能受到了影响，以至于加载一个页面可能需要一分半钟。在检查日志时，对 SQL 数据库的查询似乎每次大约需要 3 到 5 秒，并且实际查询非常庞大。包含数据的列表有 100 到 2000 个列表项。我知道 2000 年很多，但我们过去从未有过如此糟糕的表现。我将发布一个 SQL 查询的示例，并振作起来，这很糟糕。注意 JOIN 语句的数量过多；我在这个中数了34：

```
 EXEC Sp_executesql
N' SELECT t16.*, t18.[MetaInfo] AS c30, t17.[ntext7], t17.[ntext9], t17.[ntext3], t17.[ntext1], t17.[ntext4], t17.[ntext6], t17.[ntext8], t17.[ntext2], t17.[ntext5], t17.[ntext10] FROM (SELECT DISTINCT t14.*, t15.[tp_Ordinal] , t2.[tp_ID] AS c4, t3.[tp_ID] AS c6, t4.[tp_ID] AS c7, t6.[tp_ID] AS c11, t7.[tp_ID] AS c12, t8.[tp_ID] AS c13, t9.[tp_ID] AS c14, t10.[tp_ID] AS c15, t24.[nvarchar1] AS c13c10, t22.[nvarchar1] AS c11c10, t19.[nvarchar1] AS c4c5, t26.[nvarchar1] AS c15c5, t23.[nvarchar1] AS c12c8, t21.[nvarchar1] AS c7c8, t25.[nvarchar1] AS c14c5, t20.[nvarchar1] AS c6c5 FROM (    SELECT TOP 2147483648 t1.[Type] AS c0,UserDataVersioned.[tp_ModerationStatus],UserDataVersioned.[nvarchar1],UserDataVersioned.[nvarchar21],UserDataVersioned.[tp_Version],UserDataVersioned.[int2],t13.[nvarchar1] AS c24c19,t1.[TimeLastModified] AS c28,UserDataVersioned.[tp_HasCopyDestinations],UserDataVersioned.[nvarchar12],UserDataVersioned.[int7],UserDataVersioned.[nvarchar17],t12.[nvarchar4] AS c18c21,t13.[nvarchar5] AS c24c22,UserDataVersioned.[tp_WorkflowInstanceID],UserDataVersioned.[tp_Level],UserDataVersioned.[tp_DirName],t1.[ScopeId] AS c3,UserDataVersioned.[nvarchar5],UserDataVersioned.[nvarchar20],UserDataVersioned.[tp_CalculatedVersion],UserDataVersioned.[int1],UserDataVersioned.[tp_Author],UserDataVersioned.[tp_Editor],UserDataVersioned.[tp_UIVersion],UserDataVersioned.[tp_GUID],UserDataVersioned.[tp_ContentTypeId],UserDataVersioned.[nvarchar11],UserDataVersioned.[nvarchar16],UserDataVersioned.[int6],t1.[TimeCreated] AS c26,CASE WHEN DATALENGTH(t1.DirName) = 0 THEN t1.LeafName WHEN DATALENGTH(t1.LeafName) = 0 THEN t1.DirName ELSE t1.DirName + N''/'' + t1.LeafName END  AS c1,t13.[tp_ID] AS c24c20,UserDataVersioned.[tp_WorkflowVersion],UserDataVersioned.[tp_IsCurrentVersion],UserDataVersioned.[nvarchar4],UserDataVersioned.[nvarchar9],t1.[ProgId] AS c29,UserDataVersioned.[tp_SiteId],UserDataVersioned.[int5],UserDataVersioned.[nvarchar10],UserDataVersioned.[nvarchar15],t12.[nvarchar1] AS c18c19,t12.[nvarchar5] AS c18c22,t13.[tp_Created] AS c24c23,UserDataVersioned.[tp_CopySource],UserDataVersioned.[tp_ContentType],t13.[nvarchar3] AS c24c31,UserDataVersioned.[tp_HasAttachment],UserDataVersioned.[tp_InstanceID],UserDataVersioned.[tp_ItemOrder],UserDataVersioned.[tp_Created],UserDataVersioned.[tp_ID],UserDataVersioned.[nvarchar3],UserDataVersioned.[nvarchar8],UserDataVersioned.[nvarchar23],UserDataVersioned.[tp_LeafName],UserDataVersioned.[int4],t5.[nvarchar1] AS c9c10,UserDataVersioned.[nvarchar14],UserDataVersioned.[tp_UIVersionString],t1.[DirName] AS c27,t1.[Id] AS c2,UserDataVersioned.[tp_DeleteTransactionId],UserDataVersioned.[nvarchar19],UserDataVersioned.[int9],t11.[nvarchar4] AS c16c17,t12.[tp_ID] AS c18c20,t13.[nvarchar4] AS c24c21,UserDataVersioned.[nvarchar2],UserDataVersioned.[nvarchar7],UserDataVersioned.[float1],UserDataVersioned.[nvarchar22],UserDataVersioned.[tp_Modified],UserDataVersioned.[int3],UserDataVersioned.[nvarchar13],UserDataVersioned.[int10],t1.[LeafName] AS c25,UserDataVersioned.[nvarchar18],UserDataVersioned.[int8],t12.[tp_Created] AS c18c23,t12.[nvarchar3] AS c18c31,UserDataVersioned.[nvarchar6] FROM UserDataVersioned INNER JOIN Docs AS t1 WITH(NOLOCK) ON ( 1 = 1  AND UserDataVersioned.[tp_RowOrdinal] = 0 AND t1.SiteId = UserDataVersioned.tp_SiteId AND t1.SiteId = @L2 AND t1.DirName = UserDataVersioned.tp_DirName  AND t1.LeafName = UserDataVersioned.tp_LeafName  AND t1.IsCurrentVersion = 1 AND  (UserDataVersioned.tp_Level = 255 AND t1.LTCheckoutUserId =@IU OR (UserDataVersioned.tp_Level = 1  OR UserDataVersioned.tp_Level = 2 AND (UserDataVersioned.tp_DraftOwnerId = @IU OR t1.ScopeId IN (''028D254C-1C71-481D-A62D-5F1C2B1F3233''))) ) AND (t1.ScopeId=@L3) AND UserDataVersioned.tp_ListId = @L4) LEFT OUTER JOIN (SELECT * FROM UserData AS t5_u WITH(NOLOCK)  INNER JOIN Docs AS t5_d WITH(NOLOCK) ON (t5_d.DoclibRowId = t5_u.tp_ID  AND t5_d.SiteId = t5_u.tp_SiteId AND t5_d.SiteId = @L2 AND t5_d.DirName = t5_u.tp_DirName  AND t5_d.LeafName = t5_u.tp_LeafName  AND t5_d.Level = t5_u.tp_Level  AND  (t5_u.tp_Level = 255 AND t5_d.LTCheckoutUserId =@IU OR (t5_u.tp_Level = 1 AND (t5_u.tp_DraftOwnerId IS NULL OR  (t5_u.tp_DraftOwnerId <>@IU AND t5_d.ScopeId NOT IN (''028D254C-1C71-481D-A62D-5F1C2B1F3233'')))  OR t5_u.tp_Level = 2 AND (t5_u.tp_DraftOwnerId = @IU OR t5_d.ScopeId IN (''028D254C-1C71-481D-A62D-5F1C2B1F3233''))) AND (t5_d.LTCheckoutUserId IS NULL OR t5_d.LTCheckoutUserId <> @IU )) AND (t5_d.ScopeId=@L3))) AS t5 ON (UserDataVersioned.[int4]=t5.[tp_ID] AND UserDataVersioned.[tp_RowOrdinal] = 0 AND t5.[tp_RowOrdinal] = 0 AND t5.tp_ListId = @L4 AND UserDataVersioned.tp_ListId = @L4) LEFT OUTER JOIN (SELECT * FROM UserData AS t11_u WITH(NOLOCK)  INNER JOIN Docs AS t11_d WITH(NOLOCK) ON (t11_d.DoclibRowId = t11_u.tp_ID  AND t11_d.SiteId = t11_u.tp_SiteId AND t11_d.SiteId = @L2 AND t11_d.DirName = t11_u.tp_DirName  AND t11_d.LeafName = t11_u.tp_LeafName  AND t11_d.Level = t11_u.tp_Level  AND  (t11_u.tp_Level = 255 AND t11_d.LTCheckoutUserId =@IU OR (t11_u.tp_Level = 1 AND (t11_u.tp_DraftOwnerId IS NULL OR  (t11_u.tp_DraftOwnerId <>@IU AND t11_d.ScopeId NOT IN (''028D254C-1C71-481D-A62D-5F1C2B1F3233'')))  OR t11_u.tp_Level = 2 AND (t11_u.tp_DraftOwnerId = @IU OR t11_d.ScopeId IN (''028D254C-1C71-481D-A62D-5F1C2B1F3233''))) AND (t11_d.LTCheckoutUserId IS NULL OR t11_d.LTCheckoutUserId <> @IU )) AND (t11_d.ScopeId=@L3))) AS t11 ON (UserDataVersioned.[int10]=t11.[tp_ID] AND UserDataVersioned.[tp_RowOrdinal] = 0 AND t11.[tp_RowOrdinal] = 0 AND t11.tp_ListId = @L4 AND UserDataVersioned.tp_ListId = @L4) LEFT OUTER JOIN AllUserData AS t12 WITH(NOLOCK, INDEX=AllUserData_PK) ON (UserDataVersioned.[tp_Author]=t12.[tp_ID] AND UserDataVersioned.[tp_RowOrdinal] = 0 AND t12.[tp_RowOrdinal] = 0 AND ( (t12.tp_IsCurrent = 1) )  AND t12.[tp_CalculatedVersion] = 0  AND t12.[tp_DeleteTransactionId] = 0x  AND t12.tp_ListId = @L5 AND UserDataVersioned.tp_ListId = @L4) LEFT OUTER JOIN AllUserData AS t13 WITH(NOLOCK, INDEX=AllUserData_PK) ON (UserDataVersioned.[tp_Editor]=t13.[tp_ID] AND UserDataVersioned.[tp_RowOrdinal] = 0 AND t13.[tp_RowOrdinal] = 0 AND ( (t13.tp_IsCurrent = 1) )  AND t13.[tp_CalculatedVersion] = 0  AND t13.[tp_DeleteTransactionId] = 0x  AND t13.tp_ListId = @L5 AND UserDataVersioned.tp_ListId = @L4) WHERE (UserDataVersioned.[tp_ID] = @I6P) AND t1.SiteId=@L2 AND (t1.DirName=@DN OR t1.DirName LIKE @DNEL+N''/%'') ORDER BY UserDataVersioned.[tp_UIVersion] Desc,UserDataVersioned.[tp_ID] Asc ) AS t14 LEFT OUTER JOIN UserDataJunctionsVersioned AS t15 ON t14.[tp_SiteId] = t15.[tp_SiteId] AND t14.[tp_DeleteTransactionId] = t15.[tp_DeleteTransactionId] AND t14.[tp_IsCurrentVersion] = t15.[tp_IsCurrentVersion] AND t14.[tp_DirName] = t15.[tp_DirName] AND t14.[tp_LeafName] = t15.[tp_LeafName] AND t14.[tp_CalculatedVersion] = t15.[tp_CalculatedVersion] AND t14.[tp_Level] = t15.[tp_Level] LEFT OUTER JOIN UserDataJunctionsVersioned AS t2 ON t14.[tp_SiteId] = t2.[tp_SiteId] AND t14.[tp_DeleteTransactionId] = t2.[tp_DeleteTransactionId] AND t14.[tp_IsCurrentVersion] = t2.[tp_IsCurrentVersion] AND t14.[tp_DirName] = t2.[tp_DirName] AND t14.[tp_LeafName] = t2.[tp_LeafName] AND t14.[tp_CalculatedVersion] = t2.[tp_CalculatedVersion] AND t14.[tp_Level] = t2.[tp_Level] AND t15.[tp_Ordinal] = t2.[tp_Ordinal] AND t2.[tp_FieldId] = ''{2e286cc1-f309-4b61-9a9e-efd7bfa5fd61}''  LEFT OUTER JOIN UserDataJunctionsVersioned AS t3 ON t14.[tp_SiteId] = t3.[tp_SiteId] AND t14.[tp_DeleteTransactionId] = t3.[tp_DeleteTransactionId] AND t14.[tp_IsCurrentVersion] = t3.[tp_IsCurrentVersion] AND t14.[tp_DirName] = t3.[tp_DirName] AND t14.[tp_LeafName] = t3.[tp_LeafName] AND t14.[tp_CalculatedVersion] = t3.[tp_CalculatedVersion] AND t14.[tp_Level] = t3.[tp_Level] AND t15.[tp_Ordinal] = t3.[tp_Ordinal] AND t3.[tp_FieldId] = ''{48ce2774-348c-46fc-8863-b050f78d9fe6}''  LEFT OUTER JOIN UserDataJunctionsVersioned AS t4 ON t14.[tp_SiteId] = t4.[tp_SiteId] AND t14.[tp_DeleteTransactionId] = t4.[tp_DeleteTransactionId] AND t14.[tp_IsCurrentVersion] = t4.[tp_IsCurrentVersion] AND t14.[tp_DirName] = t4.[tp_DirName] AND t14.[tp_LeafName] = t4.[tp_LeafName] AND t14.[tp_CalculatedVersion] = t4.[tp_CalculatedVersion] AND t14.[tp_Level] = t4.[tp_Level] AND t15.[tp_Ordinal] = t4.[tp_Ordinal] AND t4.[tp_FieldId] = ''{e2f67328-beae-443a-91e6-34278ef58179}''  LEFT OUTER JOIN UserDataJunctionsVersioned AS t6 ON t14.[tp_SiteId] = t6.[tp_SiteId] AND t14.[tp_DeleteTransactionId] = t6.[tp_DeleteTransactionId] AND t14.[tp_IsCurrentVersion] = t6.[tp_IsCurrentVersion] AND t14.[tp_DirName] = t6.[tp_DirName] AND t14.[tp_LeafName] = t6.[tp_LeafName] AND t14.[tp_CalculatedVersion] = t6.[tp_CalculatedVersion] AND t14.[tp_Level] = t6.[tp_Level] AND t15.[tp_Ordinal] = t6.[tp_Ordinal] AND t6.[tp_FieldId] = ''{0e241992-fcea-4385-9dde-1bfd15602f5b}''  LEFT OUTER JOIN UserDataJunctionsVersioned AS t7 ON t14.[tp_SiteId] = t7.[tp_SiteId] AND t14.[tp_DeleteTransactionId] = t7.[tp_DeleteTransactionId] AND t14.[tp_IsCurrentVersion] = t7.[tp_IsCurrentVersion] AND t14.[tp_DirName] = t7.[tp_DirName] AND t14.[tp_LeafName] = t7.[tp_LeafName] AND t14.[tp_CalculatedVersion] = t7.[tp_CalculatedVersion] AND t14.[tp_Level] = t7.[tp_Level] AND t15.[tp_Ordinal] = t7.[tp_Ordinal] AND t7.[tp_FieldId] = ''{67e5ed65-a2e4-4522-918f-cce886fdda5c}''  LEFT OUTER JOIN UserDataJunctionsVersioned AS t8 ON t14.[tp_SiteId] = t8.[tp_SiteId] AND t14.[tp_DeleteTransactionId] = t8.[tp_DeleteTransactionId] AND t14.[tp_IsCurrentVersion] = t8.[tp_IsCurrentVersion] AND t14.[tp_DirName] = t8.[tp_DirName] AND t14.[tp_LeafName] = t8.[tp_LeafName] AND t14.[tp_CalculatedVersion] = t8.[tp_CalculatedVersion] AND t14.[tp_Level] = t8.[tp_Level] AND t15.[tp_Ordinal] = t8.[tp_Ordinal] AND t8.[tp_FieldId] = ''{cec57d0f-6e5b-4e08-bafe-c8759ba0c8b2}''  LEFT OUTER JOIN UserDataJunctionsVersioned AS t9 ON t14.[tp_SiteId] = t9.[tp_SiteId] AND t14.[tp_DeleteTransactionId] = t9.[tp_DeleteTransactionId] AND t14.[tp_IsCurrentVersion] = t9.[tp_IsCurrentVersion] AND t14.[tp_DirName] = t9.[tp_DirName] AND t14.[tp_LeafName] = t9.[tp_LeafName] AND t14.[tp_CalculatedVersion] = t9.[tp_CalculatedVersion] AND t14.[tp_Level] = t9.[tp_Level] AND t15.[tp_Ordinal] = t9.[tp_Ordinal] AND t9.[tp_FieldId] = ''{6cd2e861-f434-4b25-ad8f-b0930311759d}''  LEFT OUTER JOIN UserDataJunctionsVersioned AS t10 ON t14.[tp_SiteId] = t10.[tp_SiteId] AND t14.[tp_DeleteTransactionId] = t10.[tp_DeleteTransactionId] AND t14.[tp_IsCurrentVersion] = t10.[tp_IsCurrentVersion] AND t14.[tp_DirName] = t10.[tp_DirName] AND t14.[tp_LeafName] = t10.[tp_LeafName] AND t14.[tp_CalculatedVersion] = t10.[tp_CalculatedVersion] AND t14.[tp_Level] = t10.[tp_Level] AND t15.[tp_Ordinal] = t10.[tp_Ordinal] AND t10.[tp_FieldId] = ''{b743b55b-d144-4940-b25a-601ff3615587}''  LEFT OUTER JOIN (SELECT * FROM UserData AS t19_u WITH(NOLOCK)  INNER JOIN Docs AS t19_d WITH(NOLOCK) ON (t19_d.DoclibRowId = t19_u.tp_ID  AND t19_d.SiteId = t19_u.tp_SiteId AND t19_d.SiteId = @L2 AND t19_d.DirName = t19_u.tp_DirName  AND t19_d.LeafName = t19_u.tp_LeafName  AND t19_d.Level = t19_u.tp_Level  AND  (t19_u.tp_Level = 255 AND t19_d.LTCheckoutUserId =@IU OR (t19_u.tp_Level = 1 AND (t19_u.tp_DraftOwnerId IS NULL OR  (t19_u.tp_DraftOwnerId <>@IU AND t19_d.ScopeId NOT IN (''028D254C-1C71-481D-A62D-5F1C2B1F3233'')))  OR t19_u.tp_Level = 2 AND (t19_u.tp_DraftOwnerId = @IU OR t19_d.ScopeId IN (''028D254C-1C71-481D-A62D-5F1C2B1F3233''))) AND (t19_d.LTCheckoutUserId IS NULL OR t19_d.LTCheckoutUserId <> @IU )) AND (t19_d.ScopeId IN (''028D254C-1C71-481D-A62D-5F1C2B1F3233'')))) AS t19 ON (t19.[tp_ListId] = @L7 AND t19.[tp_Id] = t2.[tp_ID] AND t19.[tp_RowOrdinal] = 0) LEFT OUTER JOIN (SELECT * FROM UserData AS t20_u WITH(NOLOCK)  INNER JOIN Docs AS t20_d WITH(NOLOCK) ON (t20_d.DoclibRowId = t20_u.tp_ID  AND t20_d.SiteId = t20_u.tp_SiteId AND t20_d.SiteId = @L2 AND t20_d.DirName = t20_u.tp_DirName  AND t20_d.LeafName = t20_u.tp_LeafName  AND t20_d.Level = t20_u.tp_Level  AND  (t20_u.tp_Level = 255 AND t20_d.LTCheckoutUserId =@IU OR (t20_u.tp_Level = 1 AND (t20_u.tp_DraftOwnerId IS NULL OR  (t20_u.tp_DraftOwnerId <>@IU AND t20_d.ScopeId NOT IN (''028D254C-1C71-481D-A62D-5F1C2B1F3233'')))  OR t20_u.tp_Level = 2 AND (t20_u.tp_DraftOwnerId = @IU OR t20_d.ScopeId IN (''028D254C-1C71-481D-A62D-5F1C2B1F3233''))) AND (t20_d.LTCheckoutUserId IS NULL OR t20_d.LTCheckoutUserId <> @IU )) AND (t20_d.ScopeId IN (''028D254C-1C71-481D-A62D-5F1C2B1F3233'')))) AS t20 ON (t20.[tp_ListId] = @L7 AND t20.[tp_Id] = t3.[tp_ID] AND t20.[tp_RowOrdinal] = 0) LEFT OUTER JOIN (SELECT * FROM UserData AS t21_u WITH(NOLOCK)  INNER JOIN Docs AS t21_d WITH(NOLOCK) ON (t21_d.DoclibRowId = t21_u.tp_ID  AND t21_d.SiteId = t21_u.tp_SiteId AND t21_d.SiteId = @L2 AND t21_d.DirName = t21_u.tp_DirName  AND t21_d.LeafName = t21_u.tp_LeafName  AND t21_d.Level = t21_u.tp_Level  AND  (t21_u.tp_Level = 255 AND t21_d.LTCheckoutUserId =@IU OR (t21_u.tp_Level = 1 AND (t21_u.tp_DraftOwnerId IS NULL OR  (t21_u.tp_DraftOwnerId <>@IU AND t21_d.ScopeId NOT IN (''028D254C-1C71-481D-A62D-5F1C2B1F3233'')))  OR t21_u.tp_Level = 2 AND (t21_u.tp_DraftOwnerId = @IU OR t21_d.ScopeId IN (''028D254C-1C71-481D-A62D-5F1C2B1F3233''))) AND (t21_d.LTCheckoutUserId IS NULL OR t21_d.LTCheckoutUserId <> @IU )) AND (t21_d.ScopeId IN (''028D254C-1C71-481D-A62D-5F1C2B1F3233'')))) AS t21 ON (t21.[tp_ListId] = @L8 AND t21.[tp_Id] = t4.[tp_ID] AND t21.[tp_RowOrdinal] = 0) LEFT OUTER JOIN (SELECT * FROM UserData AS  t22_u WITH(NOLOCK)  INNER JOIN Docs AS t22_d WITH(NOLOCK) ON (t22_d.DoclibRowId = t22_u.tp_ID  AND t22_d.SiteId = t22_u.tp_SiteId AND t22_d.SiteId = @L2 AND t22_d.DirName = t22_u.tp_DirName  AND t22_d.LeafName = t22_u.tp_LeafName  AND t22_d.Level = t22_u.tp_Level  AND   (t22_u.tp_Level = 255 AND t22_d.LTCheckoutUserId =@IU OR (t22_u.tp_Level = 1 AND (t22_u.tp_DraftOwnerId IS NULL OR  (t22_u.tp_DraftOwnerId <>@IU AND t22_d.ScopeId NOT IN (''028D254C-1C71-481D-A62D-5F1C2B1F3233'')))  OR t22_u.tp_Level = 2 AND (t22_u.tp_DraftOwnerId = @IU  OR t22_d.ScopeId IN (''028D254C-1C71-481D-A62D-5F1C2B1F3233''))) AND (t22_d.LTCheckoutUserId IS NULL OR t22_d.LTCheckoutUserId <> @IU )) AND (t22_d.ScopeId=@L3))) AS t22 ON (t22.[tp_ListId] = @L4 AND t22.[tp_Id] = t6.[tp_ID] AND t22.[tp_RowOrdinal] = 0) LEFT OUTER JOIN  (SELECT * FROM UserData AS t23_u WITH(NOLOCK)  INNER JOIN Docs AS t23_d WITH(NOLOCK) ON (t23_d.DoclibRowId = t23_u.tp_ID  AND t23_d.SiteId = t23_u.tp_SiteId AND t23_d.SiteId = @L2 AND t23_d.DirName = t23_u.tp_DirName  AND t23_d.LeafName = t23_u.tp_LeafName  AND  t23_d.Level = t23_u.tp_Level  AND  (t23_u.tp_Level = 255 AND t23_d.LTCheckoutUserId =@IU OR (t23_u.tp_Level = 1 AND (t23_u.tp_DraftOwnerId IS NULL OR  (t23_u.tp_DraftOwnerId <>@IU AND t23_d.ScopeId NOT IN (''028D254C-1C71-481D-A62D-5F1C2B1F3233'')))  OR t23_u.tp_Level =  2 AND (t23_u.tp_DraftOwnerId = @IU OR t23_d.ScopeId IN (''028D254C-1C71-481D-A62D-5F1C2B1F3233''))) AND (t23_d.LTCheckoutUserId IS NULL OR t23_d.LTCheckoutUserId <> @IU )) AND (t23_d.ScopeId IN (''028D254C-1C71-481D-A62D-5F1C2B1F3233'')))) AS t23 ON (t23.[tp_ListId] =  @L8 AND t23.[tp_Id] = t7.[tp_ID] AND t23.[tp_RowOrdinal] = 0) LEFT OUTER JOIN (SELECT * FROM UserData AS t24_u WITH(NOLOCK)  INNER JOIN Docs AS t24_d WITH(NOLOCK) ON (t24_d.DoclibRowId = t24_u.tp_ID  AND t24_d.SiteId = t24_u.tp_SiteId AND t24_d.SiteId = @L2 AND  t24_d.DirName = t24_u.tp_DirName  AND t24_d.LeafName = t24_u.tp_LeafName  AND t24_d.Level = t24_u.tp_Level  AND  (t24_u.tp_Level = 255 AND t24_d.LTCheckoutUserId =@IU OR (t24_u.tp_Level = 1 AND (t24_u.tp_DraftOwnerId IS NULL OR  (t24_u.tp_DraftOwnerId <>@IU AND  t24_d.ScopeId NOT IN (''028D254C-1C71-481D-A62D-5F1C2B1F3233'')))  OR t24_u.tp_Level = 2 AND (t24_u.tp_DraftOwnerId = @IU OR t24_d.ScopeId IN (''028D254C-1C71-481D-A62D-5F1C2B1F3233''))) AND (t24_d.LTCheckoutUserId IS NULL OR t24_d.LTCheckoutUserId <> @IU )) AND  (t24_d.ScopeId=@L3))) AS t24 ON (t24.[tp_ListId] = @L4 AND t24.[tp_Id] = t8.[tp_ID] AND t24.[tp_RowOrdinal] = 0) LEFT OUTER JOIN (SELECT * FROM UserData AS t25_u WITH(NOLOCK)  INNER JOIN Docs AS t25_d WITH(NOLOCK) ON (t25_d.DoclibRowId = t25_u.tp_ID  AND t25_d.SiteId =  t25_u.tp_SiteId AND t25_d.SiteId = @L2 AND t25_d.DirName = t25_u.tp_DirName  AND t25_d.LeafName = t25_u.tp_LeafName  AND t25_d.Level = t25_u.tp_Level  AND  (t25_u.tp_Level = 255 AND t25_d.LTCheckoutUserId =@IU OR (t25_u.tp_Level = 1 AND (t25_u.tp_DraftOwnerId IS NULL  OR  (t25_u.tp_DraftOwnerId <>@IU AND t25_d.ScopeId NOT IN (''028D254C-1C71-481D-A62D-5F1C2B1F3233'')))  OR t25_u.tp_Level = 2 AND (t25_u.tp_DraftOwnerId = @IU OR t25_d.ScopeId IN (''028D254C-1C71-481D-A62D-5F1C2B1F3233''))) AND (t25_d.LTCheckoutUserId IS NULL OR  t25_d.LTCheckoutUserId <> @IU )) AND (t25_d.ScopeId IN (''028D254C-1C71-481D-A62D-5F1C2B1F3233'')))) AS t25 ON (t25.[tp_ListId] = @L7 AND t25.[tp_Id] = t9.[tp_ID] AND t25.[tp_RowOrdinal] = 0) LEFT OUTER JOIN (SELECT * FROM UserData AS t26_u WITH(NOLOCK)  INNER JOIN Docs  AS t26_d WITH(NOLOCK) ON (t26_d.DoclibRowId = t26_u.tp_ID  AND t26_d.SiteId = t26_u.tp_SiteId AND t26_d.SiteId = @L2 AND t26_d.DirName = t26_u.tp_DirName  AND t26_d.LeafName = t26_u.tp_LeafName  AND t26_d.Level = t26_u.tp_Level  AND  (t26_u.tp_Level = 255 AND  t26_d.LTCheckoutUserId =@IU OR (t26_u.tp_Level = 1 AND (t26_u.tp_DraftOwnerId IS NULL OR  (t26_u.tp_DraftOwnerId <>@IU AND t26_d.ScopeId NOT IN (''028D254C-1C71-481D-A62D-5F1C2B1F3233'')))  OR t26_u.tp_Level = 2 AND (t26_u.tp_DraftOwnerId = @IU OR t26_d.ScopeId IN (''028D254C-1C71-481D-A62D-5F1C2B1F3233''))) AND (t26_d.LTCheckoutUserId IS NULL OR t26_d.LTCheckoutUserId <> @IU )) AND (t26_d.ScopeId IN (''028D254C-1C71-481D-A62D-5F1C2B1F3233'')))) AS t26 ON (t26.[tp_ListId] = @L7 AND t26.[tp_Id] = t10.[tp_ID] AND t26.[tp_RowOrdinal] = 0) ) AS t16 LEFT OUTER JOIN Docs AS t18 WITH(NOLOCK) ON t18.[SiteId] = t16.[tp_SiteId] AND t18.[DeleteTransactionId] = t16.[tp_DeleteTransactionId] AND t18.[DirName] = t16.[tp_DirName] AND t18.[LeafName] = t16.[tp_LeafName] AND t18.[Level] = t16.[tp_Level]  LEFT OUTER JOIN UserDataVersioned AS t17 WITH(NOLOCK) ON t16.[tp_SiteId] = t17.[tp_SiteId] AND t16.[tp_DeleteTransactionId] = t17.[tp_DeleteTransactionId] AND t16.[tp_IsCurrentVersion] = t17.[tp_IsCurrentVersion] AND t16.[tp_DirName] = t17.[tp_DirName] AND t16.[tp_LeafName] = t17.[tp_LeafName] AND t16.[tp_CalculatedVersion] = t17.[tp_CalculatedVersion] AND t16.[tp_Level] = t17.[tp_Level] AND t17.[tp_RowOrdinal] =  0 ORDER BY t16.tp_UIVersion Desc,t16.tp_ID Asc,t16.[tp_Ordinal]'
,
N'@L0 uniqueidentifier,@L2 uniqueidentifier,@IU int,@L3 uniqueidentifier,@L4 uniqueidentifier,@L5 uniqueidentifier,@I6P int,@DN nvarchar(260),@DNEL nvarchar(1024),@L7 uniqueidentifier,@L8 uniqueidentifier'
,
@L0='00000000-0000-0000-0000-000000000000',
@L2='BC921A53-1407-4D3F-A3F4-FFCA8E38191D',
@IU=1073741823,
@L3='028D254C-1C71-481D-A62D-5F1C2B1F3233',
@L4='6B95520B-F7FD-4378-A28D-35153C24329D',
@L5='3F05AD46-3239-4F59-B9FC-577C4916869D',
@I6P=6371,
@DN=N'Lists/Product Information',
@DNEL=N'Lists/Product Information',
@L7='C2C4D95F-5156-48D5-82BE-D171F015D499',
@L8='A5C3BB1F-7849-4AAB-B1F0-489F6BBC984B' 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T20:39:34.207

由于性能突然变差，我能提供的最好的方法是您可能想要更新统计信息。对于像 Sharepoint 这样的糟糕数据模型，我们无能为力。

# excel - Excel VBA：如何在给定当前选择的情况下扩展范围

> ID：10692213
> 
> 赞同：9
> 
> 时间：2012-05-21T20:33:16.080
> 
> 标签：excel, vba, selection

我想做类似的事情：

```
E18-(1,1) &":" &E18+(1,1) 
```

我的意图是保留范围`E18`（值 = B）的选择并将选择范围扩展到`D16:F20`.

![Cell_Image_Excel_Highlighted_B](../Images/a4d5807899557a2d484510c278d9fede.png)

如果我有一个单元格的范围，`E18`并且我想将范围扩展到`D16:F20`，我该怎么做？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-05-21T21:00:18.440

你的意思是这样吗？

**句法**

ExpandRange [ *Range* ], [ *Number of Col on left* ], [ *Number of Rows on top* ], [ *Number of Col on right* ], [ *Number of Rows down* ]

```
Sub Sample()
    Debug.Print ExpandRange(Range("B5"), 1, 1, 1, 1)            '<~~ $A$4:$C$6
    Debug.Print ExpandRange(Range("A1"), 1, 1, 1, 1)            '<~~ Error
    Debug.Print ExpandRange(Range("XFD4"), 1, 1, 1, 1)          '<~~ Error
    Debug.Print ExpandRange(Range("XFD1048576"), 1, 1, 1, 1)    '<~~ Error
    Debug.Print ExpandRange(Range("E5"), 1, 1, 1, 1)            '<~~ $D$4:$F$6
End Sub

Function ExpandRange(rng As Range, lft As Long, tp As Long, _
rt As Long, dwn As Long) As String
    If rng.Column - lft < 1 Or _
       rng.Row - tp < 1 Or _
       rng.Column + rt > ActiveSheet.Columns.Count Or _
       rng.Row + dwn > ActiveSheet.Rows.Count Then
        ExpandRange = "Error"
        Exit Function
    End If

    ExpandRange = Range(rng.Offset(-1 * tp, -1 * lft).Address & ":" & _
                        rng.Offset(dwn, rt).Address).Address
End Function 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2012-11-06T10:35:52.200

这是我用来调整现有选择大小的简单代码。

```
Selection.Resize(Selection.Rows.Count + 5, Selection.Columns.Count + 50).Select 
```

这将使行数增加 5，列数增加 50。适应您的需求。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-05-21T21:38:37.907

您可以使用`Application.WorksheetFunction.Offset()`比 VBA 的 Offset 更丰富的内容，并完成问题所需的一切。
我认为它可以完成 Siddharth Rout ExpandRange 所做的工作，而不需要 UDF。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-05-21T21:26:26.913

```
Range(Cells(WorksheetFunction.Max(1, Selection.Row - 1), _
      WorksheetFunction.Max(1, Selection.Column - 1)), _
      Cells(WorksheetFunction.Min(Selection.Worksheet.Rows.Count, _
      Selection.Row + 1), _
      WorksheetFunction.Min(Selection.Worksheet.Columns.Count, _
      Selection.Column + 1))).Select 
```

upd：感谢 Siddharth Rout 格式化我的消息

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2020-08-02T03:21:29.803

## **如何从工作表的任何位置选择和扩展范围到工作表的任何位置。**

*这是我的第一篇文章。我知道我参加聚会有点晚了，对我来说很明显，这里的大多数人都比我更有经验和技能。所以我怀疑我的解决方案是否包括他们的“大局”细微差别考虑，但我已经证实它们对我有用，我希望它们也对你们所有人有用。*

好的，那么回到问题上来。这是我的做法。

*   **示例一**
    要针对您的问题提出的确切情况执行此操作，如果您从 E18 开始并且想要将范围扩展到 D16:F20，请使用下面的代码。只要您有完整范围的空间，您的活动单元格实际上可以*在任何地方*，并且该范围将跟随它。

    `Range(ActiveCell.Offset(-2, -1), ActiveCell.Offset(2, 1)).Select`

*   **示例二**
    如果您已经选择了一个范围，然后您想进一步扩展它（假设向下增加 2 行，向右增加 1 列），请执行以下操作：

    `Range(Selection, Selection.Offset(2, 1)).Select`

*   **示例三**
    如果要选择包含数据的所有连续单元格的范围，从活动单元格开始并继续向下直到到达空白单元格，*然后还将单元格从 1 列添加到左侧*，然后执行以下操作：

    `Range(ActiveCell, Selection.End(xlDown).Offset(0, -1)).Select`

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-03-20T09:26:44.303

我没有返回绝对地址，而是修改了上面的语法以返回一个范围。归功于 Siddharth Rout = )

```
Function ExpandRG(rng As Variant, lft As Long, tp As Long, rt As Long, dwn As Long) _
 As Range
 Set ws = rng.Parent
If rng.Column - lft < 1 Or _
   rng.Row - tp < 1 Or _
   rng.Column + rt > ActiveSheet.Columns.Count Or _
   rng.Row + dwn > ActiveSheet.Rows.Count Then
        MsgBox "Out of range"
        Exit Function
End If

 Set rng = ws.Range(rng.Offset(-1 * tp, -1 * lft).Address & ":" & _
                    rng.Offset(dwn, rt).Address)                        
End Function

Sub aa()
Dim ori_add, O_add, New_add As Range
Set ori_add = Range("B2")
Set O_add = ori_add

Call ExpandRG(ori_add, 1, 1, 1, 1)
Set New_add = ori_add

MsgBox "Original address " & O_add.Address & ", new address is" & New_add.Address
End Sub 
```

# sql - 如何使用关联两个表的连接和非唯一键获取此 sql 数据

> ID：10692215
> 
> 赞同：1
> 
> 时间：2012-05-21T20:33:20.073
> 
> 标签：sql, oracle, join

我有两张桌子：

```
images
imageid   imageKeySTring
-------   --------------
98        AAA
97        BBB
96        CCC
95        CCC
94        BBB

objects
imageKeyString     id2
--------------     -----
AAA                2
BBB                3
AAA                4
CCC                5
CCC                6
BBB                7 
```

`id2`通过`imageid`匹配链接的所有组合`imageKeyString`我将如何在 Oracle SQL 查询中得到它？

例如，因为`CCC`我会回来：

```
5/95
5/96
6/95
6/96 
```

返回（但我希望查询中的所有键返回值）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-21T20:37:25.473

看起来 a`join`会按照你的要求做。它返回连接表中的所有匹配行：

```
select  i.imageid
,       o.id2
from    images i
join    objects o
on      o.imageKeyString = s.ImageKeyString 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-21T21:06:57.263

您需要将表连接在一起并连接结果：

```
select i.imageKeyString,
       cast(o.id2 as varchar(10)||'/'||cast(i.imageid as varchar(10)) as newkey
from images i join
     objects o
     on i.imageKeyString = o.ImageKeyString 
```

如果缺少某些对象：

```
select i.imageKeyString,
       coalesce(cast(o.id2 as varchar(10), '')||'/'||cast(i.imageid as varchar(10)) as newkey
from images i left outer join
     objects o
     on i.imageKeyString = o.ImageKeyString 
```

# javascript - Socket.io 不能连续发送两条消息？

> ID：10692217
> 
> 赞同：0
> 
> 时间：2012-05-21T20:33:30.540
> 
> 标签：javascript, node.js, socket.io

我正在将 socket.io 用于我的一个项目，并且在将两个连续的消息发送到同一个套接字时似乎遇到了麻烦。这个想法是，当用户登录 inn 时，我将在他未连接时发送给他的所有消息都发送给他，这可能会导致在同一方法中进行多次 .emit 调用。但是，客户似乎没有收到这些消息，或者至少不明白他已经收到了它们......但是独立发送消息可以正常工作......

这是服务器控制台的输出：

```
debug: xhr-polling writing �104�5:::
{"name":"friend_request","args":
[{"_id":"4fb040147185a2e21f000002","email":"made_up@gmail.com"}]}�201�6:::6+
[{"_id":"4fb91f732f869a6f16000004","socketId":"12602175611929481375","email":"casablanca@gmail.com",
"friends":[],"recentOpponents":[],"games":[]}] 
```

这是socket.io中的错误还是我做错了什么？只需连续两次调用 .emit 即可轻松重现该行为......

哦，顺便说一句。Socket.io 版本 0.9.6 和 NodeJS 0.6.17

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-22T06:02:41.577

实际上，问题似乎是我没有添加到我的 html 文件中。Socket.io 使用 unicode 字符来指示有效负载，因此如果您使用 ASCII 编码（默认），这将导致您无法接收多条消息（使用 ajax 长轮询时可能会发生这种情况）。

# node.js - Node.js Mongoosejs Crud 脚手架

> ID：10692218
> 
> 赞同：10
> 
> 时间：2012-05-21T20:33:31.863
> 
> 标签：node.js, mongodb, express, mongoose

有没有办法通过使用使用的模式模型来创建一个 crud 脚手架？

一定不能是一个框架，更多的是一个实用程序。

目前使用：ExpressJS MongooseJS MongoDB

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-17T12:53:37.463

我想您可以尝试使用[RailwayJS](http://railwayjs.com/)吗？它还有一个用于设置 CRUD 脚手架的示例：

```
railway init blog && cd blog
npm install -l
railway generate crud post title content
railway server 8888
open http://127.0.0.1:8888/posts 
```

**编辑**

有几个选择，但我认为铁路是你最好的选择，除非我误解了你的问题。正如已经建议的那样，您可以自己实现一些东西。有关这些替代方案的更多信息，请参阅这些 StackOverflow 问题（您不是第一个提出这个问题的人）：

[是否有用于 Mongoose 和 Node.js 和 Underscore 的 CRUD 生成器？还是类似堆栈的 CRUD 生成器？](https://stackoverflow.com/questions/4291130/is-there-a-crud-generator-for-mongoose-and-node-js-and-underscore-or-a-crud-gen)

[node.js 的 CRUD 模块或教程](https://stackoverflow.com/questions/8338660/crud-module-or-tutorial-for-node-js-0-6-x-mongodb)

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-11-30T12:31:54.183

我创建了[bumm](https://github.com/saintedlama/bumm)，这是一个命令行工具，用于生成可以满足您需求的快速项目骨架和脚手架模型/路线/视图。视图生成并不完全是您可能想要的，因为 bumm 不解析现有模型，但希望模型字段作为命令行参数传递。但它是开源的...

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-07-21T07:21:03.513

我正在使用 MEANJS (www.meanjs.org)，它有一个 yeoman 生成器，它不仅可以生成种子应用程序，还可以为您生成一个模块，其中包括 mongoose 模型、expressjs 路由和控制器，对于 angular for杂乱无章，但您不能指定字段（必须在生成器为您完成管道后对这些字段进行编码）。

我希望看到他们将其扩展为一些生成器，我可以在其中指定字段及其类型。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-09-01T13:47:22.487

假设你已经安装了 node 和 npm

```
npm install -g express
npm install -g express-generator 
```

然后使用 express 搭建一个 webapp

```
express "app name" 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-02-21T19:16:34.523

我最近为此目的创建了一个简短的工具，[CRUD 脚手架](https://www.npmjs.com/package/mongoose-scaffold-crud)。不是很多，它有一些问题，但它帮助我在当时的一些项目上更快地开始。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2018-07-02T07:27:37.890

我喜欢这样的话：一定不能是一个框架，更多的是一个实用程序。

你试过[阿穆尔](https://github.com/zhangkaiyulw/amur)吗？

它是一个用于生成 koa+mongoose+graphql API 资源的实用程序。

# ios - 当前不在屏幕上的 UIWebView 的屏幕截图

> ID：10692221
> 
> 赞同：3
> 
> 时间：2012-05-21T20:33:39.233
> 
> 标签：ios, uikit, uiimage, screenshot

我正在尝试生成将通过 UIWebView 显示的几个页面的缩略图。问题是所有图像都是灰色或我为 UIWebView 设置的背景颜色。难道是我没有让网络视图有足够的时间来加载页面？

我相信我想做以下事情：

1.  创建一个在屏幕上不可见的 UIWebView
2.  设置图形上下文
3.  对于每一页：
    *   在 web 视图上调用 loadRequest
    *   在图形上下文中渲染 Web 视图
    *   截屏
4.  结束图形上下文

这是我对单个图像的代码：

```
UIWebView *screenWebView = _screenshotWebView;
UIView *screenView = _screenshotView;

if ([UIScreen instancesRespondToSelector:@selector(scale)] && [[UIScreen mainScreen] scale] == 2.0f) {
    UIGraphicsBeginImageContextWithOptions(screenView.bounds.size, NO, 2.0f);
} else {
    UIGraphicsBeginImageContext(screenView.bounds.size);
}

[screenWebView loadRequest:[NSURLRequest requestWithURL:[NSURL fileURLWithPath:[[NSBundle mainBundle] pathForResource:path ofType:@"html"]isDirectory:NO]]];

[screenView.layer renderInContext:UIGraphicsGetCurrentContext()];
UIImage *image = UIGraphicsGetImageFromCurrentImageContext();
UIGraphicsEndImageContext(); 
```

我在 XIB 文件中定义`_screenshotWebView`和定义，`_screenshotView`因为我认为我可能没有正确初始化它们。

有什么想法吗？谢谢！

***编辑***：这是一些实现此功能的代码，以防其他人需要它： [https ://github.com/rmcl/webview_screenshot](https://github.com/rmcl/webview_screenshot)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-21T21:39:24.877

正如您推测的那样， UIWebView 没有时间加载页面。该方法将异步启动页面加载；在`UIWebView`您返回运行循环之前，可能不会有机会做任何工作。

尝试[实施`webViewDidFinishLoad:`](https://stackoverflow.com/questions/1662565/uiwebview-finished-loading-event)并在完成后进行渲染。

# django - 新手：在 Django 中，如何更改对象的显示名称？

> ID：10692225
> 
> 赞同：2
> 
> 时间：2012-05-21T20:33:56.830
> 
> 标签：django

为这个简单的问题道歉。我已经尝试在 django 文档中搜索答案，但我无法弄清楚。

我已经设置了几个类，但在管理区域它们都作为“类名对象”出现。我在这里尝试使用代码： [Django 模型字段如何工作？](https://stackoverflow.com/questions/500650/django-model-question-newbie) ..但我得到了大量的错误页面。

我有一个抽象类的人，然后是专门的人的子类。我试图让它们被列为 self.name 但我无法为我的生活弄清楚这一点。

谢谢你。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-21T20:52:45.603

您应该实现一个`__unicode__`方法，例如：

```
class Person(model.Model):
    name = models.CharField(max_length=200)
    email = models.CharField(max_length=200)

    def __unicode__(self):
        return u'%s <%s>' % (self.name, self.email) 
```

在那一点上，如果您尝试`print`使用 Person 对象，它将使用您的`__unicode__`函数。

# python - 在一个 python 文件上运行 Sphinx 的最简单方法

> ID：10692228
> 
> 赞同：16
> 
> 时间：2012-05-21T20:34:11.557
> 
> 标签：python, python-sphinx

我们有一个 Sphinx 配置，它将为我们的整个代码库生成大量 HTML 文档。有时，我正在处理一个文件，我只想查看该文件的 HTML 输出，以确保在不运行整个套件的情况下获得正确的语法。

我寻找可以在终端中运行的最简单的命令来在这个文件上运行 sphinx，我确定信息就在那里，但我没有看到它。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-28T17:52:30.837

Sphinx 处理 reST 文件（不是直接的 Python 文件）。这些文件可能包含对 Python 模块的引用（当您使用 autodoc 时）。我的经验是，如果自上次完整输出构建以来只修改了一个 Python 模块，Sphinx 不会重新生成所有内容；仅处理“拉入”该特定 Python 模块的 reST 文件。有消息说`updating environment: 0 added, 1 changed, 0 removed`。

要显式处理单个 reST 文件，请将其指定为以下参数`sphinx-build`：

```
sphinx-build -b html -d _build/doctrees . _build/html your_filename.rst 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2015-05-01T05:10:35.060

这分两步完成：

1.  使用 sphinx-apidoc 从 python 模块生成 rst 文件。
2.  使用 sphinx-build 从 rst 文件生成 html。

这个脚本完成了这项工作。在与模块相同的目录中调用它，并提供模块的文件名：

```
#!/bin/bash
# Generate html documentation for a single python module

PACKAGE=${PWD##*/}
MODULE="$1"
MODULE_NAME=${MODULE%.py}

mkdir -p .tmpdocs
rm -rf .tmpdocs/*
sphinx-apidoc \
    -f -e --module-first --no-toc -o .tmpdocs "$PWD" \
    # Exclude all directories
    $(find "$PWD" -maxdepth 1 -mindepth 1 -type d) \
    # Exclude all other modules (apidoc crashes if __init__.py is excluded)
    $(find "$PWD" -maxdepth 1 -regextype posix-egrep \
        ! -regex ".*/$MODULE|.*/__init__.py" -type f)
rm .tmpdocs/$PACKAGE.rst
# build crashes if index.rst does not exist
touch .tmpdocs/index.rst
sphinx-build -b html -c /path/to/your/conf.py/ \
    -d .tmpdocs .tmpdocs .tmpdocs .tmpdocs/*.rst

echo "**** HTML-documentation for $MODULE is available in .tmpdocs/$PACKAGE.$MODULE_NAME.html" 
```

# android - RSS 提要未在 Android 中显示，在网络上工作

> ID：10692231
> 
> 赞同：0
> 
> 时间：2012-05-21T20:34:19.950
> 
> 标签：android, rss, web, joomla1.7

我的 Android 应用程序在周五停止工作。由于某种原因，它没有被 RSS 提要更新 - [http://www.androidmobile.co.nz/?format=feed](http://www.androidmobile.co.nz/?format=feed)。当我将提要插入网页时，提要似乎足够活跃。我没有在网站上添加任何可能对该功能产生不利影响的内容。该应用程序可在此处免费获得 - [https://play.google.com/store/apps/details?id=com.amnz](https://play.google.com/store/apps/details?id=com.amnz)

任何帮助将非常感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-21T20:49:24.997

我的猜测是您的提要中存在某种字符，您的应用程序没有正确转义或解码。然后，因此您的应用程序没有更新。检查提要更新的最后一天，然后检查接下来几天提要中的内容（最有可能崩溃的地方）。看看它们是否有任何奇怪的字符或引号，看起来它们可能会导致问题。

# python - Django Tastypie 用户注册

> ID：10692235
> 
> 赞同：0
> 
> 时间：2012-05-21T20:34:46.297
> 
> 标签：python, django, api, rest, tastypie

我正在使用 Django 和 TastyPie 创建一个 API。我正在尝试通过资源注册用户。我从这个具有类似目标的问题中获取了大部分代码：

[如何以编程方式使用 django-tastypie API 创建或注册用户？](https://stackoverflow.com/questions/8889153/how-to-create-or-register-user-using-django-tastypie-api-programmatically)

我的问题是，注册用户时遇到问题。

代码是：

```
class RegisterUserResource(ModelResource):
    class Meta:
        allowed_methods = ['post']
        object_class = VouchersUser

        authentication = Authentication()
        authorization = Authorization()

        include_resource_uri = False
        fields = ['username']

        resource_name = 'register'

    def obj_create(self, bundle, request=None, **kwargs):
        try:
            bundle = super(RegisterUserResource).obj_create(bundle, request, **kwargs)
            bundle.obj.set_password(bundle.data.get('password'))
            bundle.obj.save()
        except IntegrityError:
            raise BadRequest('User with this username already exists')
        return bundle 
```

但是，当我发送带有用户名和密码参数的 POST（我以编程方式执行）时，我收到以下错误：

```
{"error_message": "The format indicated 'multipart/form-data' had no available deserialization method. Please check your formats and content_types on your Serializer.", "traceback": "Traceback (most recent call last):

 File "/Library/Python/2.7/site-packages/django_tastypie-0.9.11-py2.7.egg/tastypie/resources.py", line 195, in wrapper
 response = callback(request, *args, **kwargs)

 File "/Library/Python/2.7/site-packages/django_tastypie-0.9.11-py2.7.egg/tastypie/resources.py", line 402, in dispatch_list
 return self.dispatch('list', request, **kwargs)

 File "/Library/Python/2.7/site-packages/django_tastypie-0.9.11-py2.7.egg/tastypie/resources.py", line 431, in dispatch
 response = method(request, **kwargs)

 File "/Library/Python/2.7/site-packages/django_tastypie-0.9.11-py2.7.egg/tastypie/resources.py", line 1176, in post_list
 deserialized = self.deserialize(request, request.raw_post_data, format=request.META.get('CONTENT_TYPE', 'application/json'))

 File "/Library/Python/2.7/site-packages/django_tastypie-0.9.11-py2.7.egg/tastypie/resources.py", line 351, in deserialize
 deserialized = self._meta.serializer.deserialize(data, format=request.META.get('CONTENT_TYPE', 'application/json'))

 File "/Library/Python/2.7/site-packages/django_tastypie-0.9.11-py2.7.egg/tastypie/serializers.py", line 192, in deserialize
 raise UnsupportedFormat("The format indicated '%s' had no available deserialization method. Please check your formats and content_types on your Serializer." % format)

UnsupportedFormat: The format indicated 'multipart/form-data' had no available deserialization method. Please check your formats and content_types on your Serializer.
"} 
```

我可以推断出序列化程序存在一些问题，但是我该如何解决？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-24T15:32:59.067

我猜你正在尝试`django.test.client.post`与 Tastypie 一起使用。如果是这样，您需要传入一个额外的参数 - content_type。这是您的通话的外观：

```
client.post('/resource/to/create/', 'json_string_here', content_type='application/json') 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-06-25T19:14:35.140

有同样的问题。在标题中传递“Content-Type：application/json”为我解决了这个问题。

# html - 可见的隐藏元素 :after - CSS

> ID：10692239
> 
> 赞同：8
> 
> 时间：2012-05-21T20:34:54.973
> 
> 标签：html, css, checkbox, styling

我最近创建了一种设置 HTML 复选框和单选按钮样式的方法，但它需要向其中添加其他元素，例如 a`<p>`或 a `<span>`。这不是很不方便，但是当您设计 (CSS) 一个完整的 Web 软件时，不得不返回并重写每个复选框可能会很烦人。

我最近刚刚获得了关于如何在不使用任何其他元素的情况下为其设置样式的“启示”，它在 Chrome 中运行得非常好，但在 Firefox 中，好吧，只能说它不起作用。

我的 HTML：

```
<input type="checkbox" /> 
```

我的 CSS：

```
input[type="checkbox"]
{
    visibility:hidden;
}

input[type="checkbox"]:after
{
    visibility:visible;
    content:"W";
    display:block;
    background:#0ab9bf;
    width:20px;
    line-height:20px;
    text-align:center;
    height:20px;
    overflow:hidden;
    text-indent:-100px;
}

input[type="checkbox"]:checked:after
{
    text-indent:0;
} 
```

我希望这里有人可以提供帮助？请记住，我正在寻找一个严格的 CSS 解决方案。我将寻求 javascript 解决方案仅作为最后的手段。在那之前，我的希望很高。

我想我的问题是，是什么阻止了 Firefox 显示“复选框”？我该如何解决这个问题。有没有不同的方法可以做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-18T13:10:20.387

我猜这是因为大卫托马斯建议伪元素不可见，因为它是“父”元素。它在其他浏览器中工作的原因可以通过不同的实现来解释，其中伪元素可能不被视为元素的子元素？

## 另一种方法

无论如何，我在设计复选框和单选按钮方面有一些经验。我学到的一个很酷的技巧是隐藏`<input>`屏幕外并`<label>`与一些花哨的选择器技巧相关联的样式。`<label>`此方法利用了单击也将单击关联的 的事实`<input>`。

[jsFiddle](http://jsfiddle.net/Tyriar/PJsSA/1/)

### HTML

```
<input type="checkbox" id="check" />
<label for="check"></label> 
```

### CSS

```
input[type="checkbox"] {
    position:absolute;
    left:-9999px;
    top:-9999px;
}

input[type="checkbox"] + label {
    visibility:visible;
    content:"W";
    display:block;
    background:#0ab9bf;
    width:20px;
    line-height:20px;
    text-align:center;
    height:20px;
    overflow:hidden;
}

input[type="checkbox"]:checked + label {
    background:#F00;
} 
```

## 改进方法

此方法使用`a + b`选择器，这意味着选择`b`紧随其后`a`。所以`<label>`必须在`<input>`. 一种“更安全”的方法是使用通用兄弟选择器将它们包装在容器和样式中`a ~ b`。`<label>`如果它们仍然是兄弟姐妹，那么这些样式将允许处于不同的位置。

```
<div>
    <input type="checkbox" id="check" />
    <div>It will still work!</div>
    <label for="check"></label>
</div> 
```

## 兼容性

独立此方法不兼容 IE8 及以下版本，因为它不支持`:checked`. 解决这个问题的常用方法是添加一个类`.checked`，但不幸的是，IE8 在更改类时也有一个[渲染错误](https://stackoverflow.com/q/13783840/1156119)，您需要更多 hacky JavaScript。

```
var labels = document.querySelectorAll('label');
for (var i = 0; i < labels.length; i++) {
    labels[i].onclick = handleClick;
}

function handleClick () {
    var checkbox = document.getElementById(this.getAttribute('for'));
    // do something with checkbox.checked
    alert(checkbox.checked);
} 
```

[幸运的是，由于其现在的市场份额很小](http://gs.statcounter.com/#browser_version-ww-monthly-201303-201303-bar)（< 0.77%），您不需要支持低于 8 的任何东西。

# c# - HTTPWebRequest 正文格式

> ID：10692240
> 
> 赞同：1
> 
> 时间：2012-05-21T20:34:59.733
> 
> 标签：c#, http, httpwebrequest

这是一个愚蠢的微不足道的问题，但我似乎无法在任何设置多个属性的地方找到合适的示例。基本上，我正在尝试使用 C# 的 HTTPWebRequest 库发送 POST 请求，同时在请求正文中指定两个不同的字段。

到目前为止，我有这个：

```
HttpWebRequest request = WebRequest.Create(url) as HttpWebRequest;
request.Method = "POST";
ASCIIEncoding encoding = new ASCIIEncoding();
byte[] byt = encoding.GetBytes("recipient=12345ABC");
request.ContentType = "application/x-www-form-urlencoded";
request.ContentLength = byt.Length;
Stream newStream = request.GetRequestStream();
newStream.Write(byt, 0, byt.Length); 
```

其次是通常的 GetResponse() 东西。这很好用，一切都很花哨，但我不知道如何指定多个正文元素，例如这两个：

```
recipient=12345ABC
body="testmessage" 
```

我尝试用分号、& 和逗号分隔它们，但服务器不断返回错误 400：错误请求。也许我只是误解了这个过程是如何工作的？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T15:10:23.097

API 文档草率地完成。实际的参数名称是“recipients”和“text”——更改后代码运行良好。

正文中的 URL 编码工作正常，“recipients=12345ABC&text=This+is+URL+escaped+text”在 URL 本身或 POST 正文中都像一个魅力。

# c++ - 比较块积分

> ID：10692244
> 
> 赞同：-2
> 
> 时间：2012-05-21T20:35:14.530
> 
> 标签：c++, image-processing, opencv, pattern-matching, augmented-reality

**我想将两个图像分成相等数量的块，然后将每个块的像素值求和以与相应的块总和进行比较。我使用了这段代码，我想知道如何比较每个块的积分：**

```
//Divide the image
Mat divide (Mat input)
 {
   Mat block;
int numberblocks=10; 
int bh;
int bw;
bh=input.cols/numberblocks;
bw=input.rows/numberblocks; 
double blockarea=bh*bw;
double num=0;
Mat sum = cvCreateMat(input.cols + 1, input.rows + 1, CV_32SC1);
Mat sqsum = cvCreateMat(input.cols + 1, input.rows + 1, CV_64FC1);

for (int r = 0; r < input.rows; r += bw)
{
for (int c = 0; c < input.cols; c += bh)
block = input(cv::Range(r, min(r + bw, input.rows)),cv::Range(c, min(c + bh, input.cols)));

integral(input, sum, sqsum);

//double mean=(cv::sum(block).val[0])/255;
//double whiteratio=mean/blockarea;
num++;
}
return sqsum;
}

int main(int argc, char ** argv)
{

Mat I = imread("01.png", CV_LOAD_IMAGE_GRAYSCALE);

Mat Idivided= divide (I);

imshow("name1", Idivided);

waitKey(0);
return 0;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T05:44:41.213

假设您的图像被分成`mXn`块，因此您有`mXn`整数值（即块的总和作为整数） `Img1, Img2`，然后具有`mXn`大小。

```
IplImage *Img1 , IplImage *Img2
    for(i = 0; i<=m; i++)
      for(j = 0; j<=n; j++)
       { 
          if((int)cvGetReal2D(Img1, i, j) == (int)cvGetReal2D(Img2, i, j));// get the block value and compare it.
          //write u r logic here.
       } 
```

# macos - 如果我的 Mac 应用程序正常工作，我是否必须修复沙盒“违规”？

> ID：10692245
> 
> 赞同：2
> 
> 时间：2012-05-21T20:35:19.257
> 
> 标签：macos, sandbox

我正在为我的 Mac 应用程序准备沙盒。虽然我的应用程序运行正常（做它应该做的一切），但在使用控制台时我仍然看到一些沙盒违规行为。例如，当绑定使用 OpenFile:WithApplication: 使用 Adob​​e Reader 打开一个 pdf 文件（位于我的包中）时，它实际上可以正常工作，但我确实看到了以下内容......

```
sandboxd:  deny file-write-data /Applications/Adobe Reader.app
sandboxd:  deny file-write-data /Applications/MyApp.app/Contents/Resources/MyPDFfile.pdf 
```

我并没有真正尝试写任何东西，只是尝试使用此代码打开 pdf 以供阅读...

```
NSString *MyPDFFilePath = [[[NSBundle mainBundle] resourcePath] stringByAppendingPathComponent: @"MyPDFfile.pdf"];  

NSString* adobeReaderPath = [[NSWorkspace sharedWorkspace] absolutePathForAppBundleWithIdentifier:@"com.adobe.Reader"];

[[NSWorkspace sharedWorkspace] openFile:MyPDFFilePath withApplication:[adobeReaderPath stringByAppendingString:@"/Contents/MacOS/AdobeReader"]]; 
```

还有，我用过...

```
[[NSWorkspace sharedWorkspace] openFile:MyPDFFilePath withApplication:@"Adobe Reader"]; 
```

无论如何，我的问题是：如果打开 pdf 文件确实有效，我应该担心这些“违规行为”吗？还是我应该忽略它们，因为程序运行正常？

如果确实需要解决“违规行为”，我应该怎么做？感谢您对此的任何帮助。

# html - 固定位置页脚中的流体宽度块元素链接

> ID：10692257
> 
> 赞同：1
> 
> 时间：2012-05-21T20:36:40.160
> 
> 标签：html, css, footer, sticky-footer, fluid-layout

我正在尝试创建一个底部对齐、流体宽度的粘性页脚，其中包含三个与容器高度相同的链接，它们也具有流体宽度。

我创建了此页脚的顶部对齐版本，其中链接不是其容器的完整高度。如果我将容器的底部设置为零，它会中断。我把代码放在这里：http: [//jsfiddle.net/bHJR3/1/](http://jsfiddle.net/bHJR3/1/)

如何修改我拥有的内容，使容器的底部边缘与窗口的底部齐平，并且链接与容器的高度相同？

我知道如何通过 jquery 做到这一点，但如果可能的话，我会尽量避免使用 js。

谢谢你的帮助。

编辑：这是我想出的一个 jquery 解决方案，以防万一有人想看到它。[http://jsfiddle.net/bHJR3/2/](http://jsfiddle.net/bHJR3/2/)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-21T21:15:11.380

上手时它坏了的原因`bottom: 0`是`#footer`因为里面的东西`#footer`都有`position: absolute`。绝对定位元素不会占用文档流中的任何空间，并且不会导致其父元素扩展以包含它们。设置一个高度`#footer`解决了这个问题。`height: 100%`标签上的设置`a`将导致它们相对于其父元素调整大小。你可以保留`div.content`，但你也必须设置`height: 100%`它。

将以下 CSS 添加到`#footer`：

```
bottom: 0;
height: 90px; 
```

将以下 CSS 添加到`A`：

```
height: 100%;
line-height: 90px; /* matches the height from #footer to vertically center the link text */ 
```

删除`div.content`. 这里似乎没有必要。

**编辑**

您可以通过在以下位置添加/更改以下 CSS 来使页脚居中`#footer`：

```
width: 640px;
left: 50%; /* positions left edge of #footer to center of page */
margin-left: -320px; /* pulls footer to the left (width / 2) * -1 */ 
```

**编辑**

如果窗口宽度小于 640 像素，您可以使用 max-width 和媒体查询来更改页脚的样式：

```
#footer {
    position: fixed;
    width: 100%;
    max-width: 640px;
    height: 114px;
    bottom:0;
    left: 50%;
    margin-left: -320px;
}

@media only screen and (max-width: 640px) {
    #footer {
        margin-left: auto;
        left: 0;
    }
} 
```

# php - 从 PHP 打印到网络打印机

> ID：10692262
> 
> 赞同：10
> 
> 时间：2012-05-21T20:36:58.903
> 
> 标签：php, printing

直接从 php 打印到 LAN 打印机的最佳方法是什么（在我的情况下是现有的 pdf）？到目前为止，我一直没有成功地得到任何工作，但我不确定进一步追求的方向。我在 Windows SBS 2008 PHP 5.3.9 上运行 Apache。

到目前为止我所知道的方法：

*   shell_exec()
*   phpprintipp - 如果我能让它工作，这对我来说似乎是最好的方法
*   php_printer.dll -**当前**不存在 dll

看起来这应该是一个具有广泛接受方法的简单任务，但到目前为止我还没有找到它。谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-21T22:33:53.893

这是一个难以破解的难题。我在 Ruby 的 Windows 打印方面有过自己的冒险经历，并提出了一些潜在的解决方案，这些解决方案通过调用外部命令来工作，在 PHP 领域是`system()`或者`exec()`（不要忘记`escapeshellcmd()`/ `escapeshellarg()`——它们往往使这些事情变得更容易，特别是在 Windows 上）。他们都假设 Windows 知道打印机并且可以通过名称引用它。

1.  您实际上可以将文件重定向到网络打印机，例如：

    ```
    copy /b \path\to\filename.pdf > \\Printer_Machine\Printer_Queue 
    ```

    该`/b`开关指定了一个二进制文件，但我有 80% 的把握现在不是严格意义上的，在 2012 年。

2.  你可以试试这个`print`命令：

    ```
    print /d:\\Printer_Machine\Printer_Queue \path\to\filename.pdf 
    ```

    `\d`代表“设备”。我实际上并没有尝试过这个，我不确定它是否适用于 PDF 或仅适用于 PDF，由于它的 DOS 起源，文本文件。

3.  安装 Adob​​e Reader 并使用它的命令行工具：

    ```
    AcroRd32.exe /t \path\to\filename.pdf "Printer Name" "Driver Name" "Port Name" 
    ```

    我不确定您的服务器环境是否可以容纳 Reader，但这是我最成功的解决方案。您可以在此处找到 [文档](http://www.adobe.com/content/dam/Adobe/en/devnet/acrobat/pdfs/Acrobat_SDK_developer_faq.pdf#page=24) （PDF，第 24 页）。`Printer Name`并且`Driver Name`应该与您在控制面板中的打印机属性中看到的完全匹配。`Port_Name`我认为通常可以省略。

4.  [使用Ghostscript](http://pages.cs.wisc.edu/~ghost/)打印。我从来没有在 Windows 上尝试过，但是 [文档在这里](http://ghostscript.com/doc/current/Install.htm#General_Windows) ，这里有 [更多信息](http://pages.cs.wisc.edu/~ghost/doc/AFPL/8.00/Devices.htm#Win)。命令是这样的：

    ```
    gswin32.exe -sDEVICE=mswinpr2 -sOutputFile="%printer%Printer Name" \path\to\filename.pdf 
    ```

    `mswinpr2`指的是 Windows 自己的打印驱动程序（请参阅上面的第二个链接），“ `%printer%`”是字面的并且是必需的，“ `Printer Name`”应该再​​次与控制面板中的打印机名称完全匹配。Ghostscript 有很多很多选项，您可能需要花一些时间来配置它们。

最后，一般提示：您可以使用以下命令注册具有设备名称的网络打印机，[`net use`](http://www.microsoft.com/resources/documentation/windows/xp/all/proddocs/en-us/net_use.mspx?mfr=true)例如：

```
C:\> net use LPT2 \\Printer_Machine\Printer_Queue /persistent:yes 
```

这*应该*让您使用`LPT2`或`LPT2:`代替`\\Printer_...`大多数命令。

我希望这会有所帮助！

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2015-12-15T15:47:47.597

不确定这是否适用于所有打印机，但这可以完成将 ZPL 文件发送到 Zebra 标签打印机的工作：

```
<?php 
if(($conn = fsockopen('192.168.10.112',9100,$errno,$errstr))===false){
    echo 'Connection Failed' . $errno . $errstr;
}

$data = <<<HERE
    ^XA
    ^FT50,200
    ^A0N,200,200^FDTEST^FS
    ^FT50,500
    ^A0N,200,200^FDZebra Printer^FS
    ^XZ
HERE;

#send request
$fput = fputs($conn, $data, strlen($data));

#close the connection
fclose($conn);
?> 
```

# selenium - 从 Teamcity 生成的 Junit HTML 报告不显示 System.out 语句

> ID：10692267
> 
> 赞同：1
> 
> 时间：2012-05-21T20:37:15.287
> 
> 标签：selenium, junit, webdriver, teamcity-7.0

我正在使用带有 ANT 1.8.3 和 Teamcity 7.0.2 的 Junit 4.10。我在 build.xml 中设置了 printsummary=withOutAndErr

但是，当我从 ANT 手动运行构建时，生成的 JUnit HTML 报告会显示 System.out 语句；当我从 Teamcity 运行相同的构建时，系统输出语句不显示。我究竟做错了什么？

Build.xml 重现场景：

示例 JUnit 测试

```
<property name="project_name" value="junitSamples"/>
<property name="src" location="src"/>
<property name="build" location="bin"/>
<property name="dist"  location="dist"/>
<property name="lib"  location="lib"/>
<property name="res"  location="res"/>
<property name="reports" location="reports"/>

<!-- the names of various distributable files -->
<property name="jar_name" value="${project_name}.jar"/>
<property name="war_name" value="${project_name}.war"/>

<!-- top level targets -->

<target name="compile" depends="init" description="compile the source code " >
    <javac srcdir="${src}" destdir="${build}">
        <classpath>
            <fileset dir="lib">
                <include name="**/*.jar"/>
            </fileset>
        </classpath>
    </javac>
</target>

<target name="dist" depends="compile" description="generate the distributable files " >
    <!-- Put everything in ${build} into the MyProject-${DSTAMP}.jar file -->
    <jar jarfile="${dist}/${jar_name}" basedir="${build}"/>
</target>

<target name="clean" description="clean up" >
    <!-- Delete the ${build} and ${dist} directory trees -->
    <delete dir="${build}"/>
    <delete dir="${dist}"/>
    <delete dir="${reports}"/>
</target>

<target name="run-tests" depends="compile" description="run your test suite" >
    <junit printsummary="true" haltonfailure="no" showoutput="yes" >
        <classpath>
            <pathelement path="${build}"/>
            <fileset dir="lib">
                <include name="**/*.jar"/>
            </fileset>
        </classpath>
      <batchtest fork="yes" todir="${reports}/raw/">
        <formatter type="xml"/>
        <fileset dir="${src}">
          <include name="**/*Test*.java"/>
        </fileset>
      </batchtest>
    </junit>
</target>

<target name ="test" depends="run-tests">
    <junitreport todir="${reports}">
      <fileset dir="${reports}/raw/">
        <include name="TEST-*.xml"/>
      </fileset>
      <report format="frames" todir="${reports}\html\"/>
    </junitreport>
</target>

<target name ="run" depends="" description="if this project can be run, run it" >
</target>

<!-- supporting targets -->

<target name="init" description="initialize the build environment" >
    <!-- Create the time stamp -->
    <tstamp/>
    <!-- Create directory structures -->
        <delete dir="${build}"/>        
        <delete dir="${dist}"/> 
        <delete dir="${reports}"/>  
        <mkdir dir="${build}"/>
    <mkdir dir="${dist}/lib"/>
    <mkdir dir="${reports}"/>
    <mkdir dir="${reports}/raw/"/>
    <mkdir dir="${reports}/html/"/>
</target>

<target name="all" depends="clean, test">
</target> 
```

# wpf - 如何在另一个单例中绑定一个类中的属性？

> ID：10692268
> 
> 赞同：0
> 
> 时间：2012-05-21T20:37:19.680
> 
> 标签：wpf, xaml, bind

我有以下课程，例如：

```
public FatherClass
{
    // This is a singleton, with instance property named Instance

    public static ChildClass PropertyName { get; set; }
}

public ChildClass
{
    public string Name { get; set; }
} 
```

在 XAML 中使用 WPF，如何将标签绑定到此变量名称？我可以使用两个级别（即，Father.Name）来完成它，但是每次我尝试使用 3 个级别时都会出错，如示例所示。

我所做的是：

```
Label="{Binding Source=namespace:FatherClass.Instance.PropertyName, Path=Name}" 
```

但这不起作用。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-02T13:23:36.020

Not till the point of class in a singleton(as in Question) but Property of child type in a singleton i am using. namespace:Common.DeviceModel Singleton class: ConnectionStatusManager //FatherClass of Question ChildClass : ConnectionStatus //ChildClass of Question property in that singleton: Status in VM:

```
namespace Common.DeviceModel
{
 public class ConnectionStatusManager : INotifyPropertyChanged
    {
      public static ConnectionStatusManager Instance...;
      public static ConnectionStatus Status...;
    }
} 
```

XAML:

```
xmlns:DeviceModel="clr-namespace:Common.DeviceModel;assembly=Common" 
```

Uses:

```
<DataTrigger Binding="{Binding Source={x:Static Member=DeviceModel:ConnectionStatusManager.Instance}, Path=Status}"  
                                             Value="{x:Static Member=DeviceModel:ConnectionStatus.DisConnected}">
                                                <Setter Property="IsEnabled" Value="False" />
                                            </DataTrigger> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-21T20:40:51.163

只需直接绑定到静态属性：

```
{x:Static namespace:FatherClass.PropertyName.Name} 
```

# json - d3.js 来自 Json/array 的标记云大小？

> ID：10692276
> 
> 赞同：5
> 
> 时间：2012-05-21T20:38:15.200
> 
> 标签：json, d3.js, word-cloud

我正在修改此代码：[https ://github.com/jasondavies/d3-cloud](https://github.com/jasondavies/d3-cloud)

```
<script>
  d3.layout.cloud().size([300, 300])
      .words([
        "Hello", "world", "normally", "you", "want", "more", "words",
        "than", "this"].map(function(d) {
        return {text: d, size: 10 + Math.random() * 90};
      }))
      .rotate(function() { return ~~(Math.random() * 2) * 90; })
      .fontSize(function(d) { return d.size; })
      .on("end", draw)
      .start();

  function draw(words) {
    d3.select("body").append("svg")
        .attr("width", 300)
        .attr("height", 300)
      .append("g")
        .attr("transform", "translate(150,150)")
      .selectAll("text")
        .data(words)
      .enter().append("text")
        .style("font-size", function(d) { return d.size + "px"; })
        .attr("text-anchor", "middle")
        .attr("transform", function(d) {
          return "translate(" + [d.x, d.y] + ")rotate(" + d.rotate + ")";
        })
        .text(function(d) { return d.text; });
  }
</script> 
```

我想从单独的 JSON 数据中获取单词和大小数据。我有两个变量

```
jWord = ["abc","def","ghi,"jkl"];
jCount = ["2", "5", "3", "8"]; 
```

jWord 有我想在标签云中显示的单词。jCount 是对应单词的大小（顺序相同）。

我将单词切换到 jWord，但不确定如何切换大小部分

```
 .words(jWord.map(function(d) {
        return {text: d, size: 10 + Math.random() * 90};
      })) 
```

我还有另一个 Json 格式变量。

```
jWord_Count = ["abc":2, "def":5, "ghi":3, "jkl":8 ]; 
```

如果这种格式有帮助。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-05-21T21:15:16.380

试试[d3.zip](https://github.com/mbostock/d3/wiki/Arrays#wiki-d3_zip)：`d3.zip(jWord, jCount)`返回一个合并数组，其中第一个元素是第一个单词的文本和大小`[jWord[0], jCount[0]]`，第二个元素是第二个单词，依此类推。例如：

```
.words(d3.zip(jWord, jCount).map(function(d) {
  return {text: d[0], size: d[1]};
})) 
```

实际上，d3.zip 将面向列的数据转换为面向行的数据。您也可以只以面向行的形式表示您的数据：

```
var words = [
  {text: "abc", size: 2},
  {text: "def", size: 5},
  {text: "ghi", size: 3},
  {text: "jkl", size: 8}
]; 
```

最后，注意类型。您的计数表示为字符串 ( `"2"`) 而不是数字 ( `2`)。所以你可能想用`+`来强制他们使用数字。

# c++ - 我的按位交换不起作用

> ID：10692277
> 
> 赞同：2
> 
> 时间：2012-05-21T20:38:18.340
> 
> 标签：c++

我正在尝试一个简单的插入排序。但是当我使用按位操作时，我尝试的交换不起作用。

但是当我使用另一个临时变量时，交换工作。当我编译这段代码时，我总是得到一些额外的 0。

如何找出我的代码有什么问题？

```
#include<cstdio>
#include<cstdlib>
#include<algorithm>
#include<algorithm>

using namespace std;

void swap(int* a, int* b)
{
*a=*a^*b;
*b=*a^*b;
*a=*a^*b;
}

int main(void)

{
int arr[size];
int i,j,min;

for(i=0; i<size; i++)
    arr[i]=rand()%100;

for(i=0; i<size; i++)
    printf("%d ",arr[i]);
putchar('\n');

for(i=0; i<size;i++)
{
    min=i;
    for(j=i+1;j<size;j++)
        if(arr[j]<arr[min])
            min=j;
    swap(&arr[i],&arr[min]);
}

for(i=0; i<size; i++)
    printf("%d ",arr[i]);
putchar('\n');

return 0;
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-21T20:41:48.277

在

```
for(i=0; i<size;i++)
{
    min=i;
    for(j=i+1;j<size;j++)
        if(arr[j]<arr[min])
            min=j;
    swap(&arr[i],&arr[min]);
} 
```

如果`arr[i]`是最小的数组元素，则尝试将其与自身交换，因此传递给交换的两个指针指向相同的内存位置，因此异或将该位置清零。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-21T20:44:37.450

由于您使用的是插入排序，我可以假设这是一个练习吗？

你认为`swap`当`a`和 `b`引用同一个地址时会做什么？在一张纸上试一试，你会看到多余的零是从哪里来的。

# wpf - 使用焦点和图像设置 WPF 文本背景色

> ID：10692278
> 
> 赞同：0
> 
> 时间：2012-05-21T20:38:22.663
> 
> 标签：wpf, validation, focus, backcolor

WPF /MVVM 模式

使用验证属性具有多个文本框的用户控件。在以下样式中，一切都按预期工作-除了那些有验证错误的人，由于控制模板中用于设置错误图像的方法，没有设置聚焦背景色。

如果我删除控制模板，如果设置了验证错误，则在聚焦时背景色设置正确。使用模板，背景色始终为白色/默认。

关于 XAML 的任何建议都需要 - 聚焦时不同的背景色和验证失败时的错误图像？

```
<Style TargetType="{x:Type TextBox}">
    <Setter Property="Margin" Value="1" />
    <Setter Property="ToolTip" Value="{Binding Description}"/>

    <Style.Triggers>
        <Trigger Property="IsFocused" Value="True">
            <Setter Property="Background" Value="LightYellow"/>
        </Trigger>

        <Trigger Property="Validation.HasError" Value="true">
            <Setter Property="ToolTip"
                    Value="{Binding RelativeSource={RelativeSource Self}, Path=(Validation.Errors).CurrentItem.ErrorContent}"/>

            <!--adds the error image and border, but also prevents background color change OnFocus-->
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="{x:Type TextBox}">
                        <Grid>
                            <Border  
                                    BorderBrush="#d99" x:Name="textBorder" CornerRadius="4" 
                                    BorderThickness="2" >
                                <ScrollViewer Margin="0" x:Name="PART_ContentHost"/>
                            </Border>
                            <Image Name="ErrorImage" Width="24" Height="24" Margin="0,0,4,0"
                                    Source="/Images/error.png" HorizontalAlignment="Right">
                            </Image>
                        </Grid>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Trigger>
    </Style.Triggers>
</Style> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-21T20:49:59.707

您应该检查[DependencyProperty 优先规则](http://msdn.microsoft.com/en-us/library/ms743230.aspx)

这里发生的是`ControlTemplate`您定义的内容覆盖了`Style.Triggers`之前定义的内容。

您可以做的是直接在内部设置`Style`适当的实际值， 否则，如您所见，WPF 将只使用.`Triggers``ControlTemplate``Grid`

代码应如下所示：

```
<Style.Triggers>

    <Trigger Property="Validation.HasError" Value="true">
        <Setter Property="ToolTip"
                Value="{Binding RelativeSource={RelativeSource Self}, Path=(Validation.Errors).CurrentItem.ErrorContent}"/>

        <!--adds the error image and border, but also prevents background color change OnFocus-->
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type TextBox}">
                    <Grid>
                    <Grid.Style>
                      <Style TargetType="{x:Type Grid}">
                        <Style.Triggers>
    <!-- The trigger about IsFocused should be here!
    <Trigger Property="IsFocused" Value="True">
        <Setter Property="Background" Value="LightYellow"/>
    </Trigger>
                        </Style.Triggers>
                      </Style>
                    </Grid.Style>
                        <Border  
                                BorderBrush="#d99" x:Name="textBorder" CornerRadius="4" 
                                BorderThickness="2" >
                            <ScrollViewer Margin="0" x:Name="PART_ContentHost"/>
                        </Border>
                        <Image Name="ErrorImage" Width="24" Height="24" Margin="0,0,4,0"
                                Source="/Images/error.png" HorizontalAlignment="Right">
                        </Image>
                    </Grid>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Trigger>
</Style.Triggers> 
```

# android - 向 AlertDialog.Builder 滚动列表添加快速滚动

> ID：10692284
> 
> 赞同：4
> 
> 时间：2012-05-21T20:38:37.657
> 
> 标签：android, dialog, fastscroll

我在 AlertDialog 中显示了大量用户作为选择列表。这是我用来生成它的代码：

```
 AlertDialog.Builder builder = new AlertDialog.Builder(thisContext);
                    builder.setTitle("User");
                    builder.setItems(userNames, new  DialogInterface.OnClickListener() {
                    public void onClick(DialogInterface dialog, int pos) {
                        //selection processing code

                }});
                builder.setNeutralButton("Clear", new DialogInterface.OnClickListener() {
                    public void onClick(DialogInterface dialog, int whichButton) {
                        //clear processing code
                    }});
                builder.setNegativeButton("Cancel", new DialogInterface.OnClickListener() {
                    public void onClick(DialogInterface dialog, int whichButton) {

                    }
                });
                dialog=builder.create();
                //next line added as solution
                dialog.getListView().setFastScrollEnabled(true); 
                dialog.show(); 
```

userNames 是数据库中名称的按字母顺序排列的列表。

这在大多数情况下都非常有效，但是，因为我有超过 100 个或更多的用户，所以滚动列表有点慢。我怎样才能开始添加快速滚动，以便用户可以在需要时跳转到列表中更下方的部分？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-05-21T21:42:57.637

您是否尝试过调用AlertDialog？[`getListView()`](http://developer.android.com/reference/android/app/AlertDialog.html#getListView%28%29)`.`[`setFastScrollEnabled(true)`](http://developer.android.com/reference/android/widget/AbsListView.html#setFastScrollEnabled%28boolean%29)

# java - 我在骆驼下使用 apache shiro，我无法使用 ldap/active 目录将组映射到角色

> ID：10692285
> 
> 赞同：2
> 
> 时间：2012-05-21T20:38:52.817
> 
> 标签：java, authentication, active-directory, shiro

我正在使用 shiro 和骆驼。我可以使用 activedirectory (ldap) 对用户进行身份验证，但我无法将角色中的用户组映射到用户权限。骆驼需要绝对的权限才能工作。

这是我的 config.ini：

```
[main]
authcStrategy = org.apache.shiro.authc.pam.FirstSuccessfulStrategy
securityManager.authenticator.authenticationStrategy = $authcStrategy

activeDirectoryRealm = org.apache.shiro.realm.activedirectory.ActiveDirectoryRealm
activeDirectoryRealm.systemUsername=cn=padl,cn=Users,dc=comune,dc=prato,dc=local
activeDirectoryRealm.systemPassword=xxxxxxxxxxxxxxxxxxxxxxx
activeDirectoryRealm.url = ldap://172.16.1.98:389
activeDirectoryRealm.groupRolesMap = "CN=menu_ufficiomobile_ania,OU=Menu,OU=Gruppi,OU=ComuneDiPrato,DC=comune,DC=prato,DC=local":"menu_ufficiomobile_ania"

securityManager.realms = $activeDirectoryRealm
[users]

test = test,menu_ufficiomobile_passicarrabili, menu_ufficiomobile_rubati,menu_ufficiomobile_ordinanze, menu_ufficiomobile_ztl, menu_ufficiomobile_cciaa,  menu_ufficiomobile_ania, menu_ufficiomobile_anagrafe, menu_ufficiomobile_mctc, menu_ufficiomobile_pra

[roles]

menu_ufficiomobile_anagrafe = prato:anagrafe
menu_ufficiomobile_mctc = prato:mctc
menu_ufficiomobile_pra = prato:pra
menu_ufficiomobile_ania = prato:ania
menu_ufficiomobile_cciaa = prato:cacomm
menu_ufficiomobile_ztl = prato:ztl
menu_ufficiomobile_ordinanze = prato:ordinanze
menu_ufficiomobile_rubati = prato:rubati
menu_ufficiomobile_passicarrabili = prato:permessi 
```

我的安全注入代码：

```
ShiroSecurityToken shiroSecurityToken = new ShiroSecurityToken(qr.getUserName(),qr.getPassword());
ShiroSecurityTokenInjector shiroSecurityTokenInjector = new ShiroSecurityTokenInjector(shiroSecurityToken, passPhrase);
arg0.getIn().setHeader("SHIRO_SECURITY_TOKEN", shiroSecurityTokenInjector.encrypt()); 
```

以及使用权限的路由代码：

```
from("seda:interrogaANIA").threads(1)
 .setHeader("db", constant(Database.ANIA)).policy(aniaS)
 .to("bean:interrogaANIA?method=interrogaBancaDati")
 .to("seda:prefilter"); 
```

谢谢，马里奥

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-21T23:44:59.033

因此，shiro 中的领域提供了 3 件事：

1.  验证用户
2.  将用户映射到角色
3.  将用户映射到权限

它不提供任意角色->权限映射。为此，您需要在活动目录领域设置 RolePermissionResolver。查看 IniRealm（由 ini 文件中的 [users] 和 [roles] 部分创建的内容），似乎没有一种简单的方法可以将其用作 RolePermissionResolver。我能够将一个应该可以很好地工作的适配器类组合在一起。

```
package org.apache.shiro.samples.web;

import java.util.Collection;
import java.util.Collections;

import org.apache.shiro.authz.Permission;
import org.apache.shiro.authz.SimpleRole;
import org.apache.shiro.authz.permission.RolePermissionResolver;
import org.apache.shiro.config.Ini;
import org.apache.shiro.realm.text.IniRealm;

public class IniRealmRolePermissionResolver implements RolePermissionResolver {
        private LocalIniRealm realm;

        public Collection<Permission> resolvePermissionsInRole(final String roleString) {
                final SimpleRole role = this.realm.getRole(roleString);
                return role == null ? Collections.<Permission>emptySet() : role.getPermissions();
        }

        public void setIni(final IniRealm ini) {
                this.realm = new LocalIniRealm();
                this.realm.setIni(ini.getIni());
                this.realm.init();
        }

        private static class LocalIniRealm extends IniRealm {
                @Override
                protected SimpleRole getRole(final String rolename) {
                        return super
                                        .getRole(rolename);
                }
        }
} 
```

这应该可以与您的 ini 文件的此添加一起使用：

```
rolePermissionResolver = org.apache.shiro.samples.web.IniRealmRolePermissionResolver
rolePermissionResolver.ini = $iniRealm
activeDirectoryRealm.rolePermissionResolver = $rolePermissionResolver 
```

如果您真的不需要 ini 映射，您可以使用相同的概念，但会大大简化事情。

```
package org.apache.shiro.samples.web;

import org.apache.shiro.authz.Permission;
import org.apache.shiro.authz.permission.*;

import java.util.Collection;
import java.util.Collections;

public class SimpleRolePermissionResolver implements RolePermissionResolver, PermissionResolverAware {

    private PermissionResolver permissionResolver = new WildcardPermissionResolver();

    public void setPermissionResolver(PermissionResolver permissionResolver) {
        this.permissionResolver = permissionResolver;
    }

    public Collection<Permission> resolvePermissionsInRole(String roleString) {
        return Collections.<Permission>singleton(permissionResolver.resolvePermission(roleString));
    }
} 
```

然后您的 ini 配置也发生了一些变化：

```
rolePermissionResolver = org.apache.shiro.samples.web.SimpleRolePermissionResolver
activeDirectoryRealm.rolePermissionResolver = $rolePermissionResolver 
```

# java - 通过其 API 设置 BIRT 数据源

> ID：10692288
> 
> 赞同：2
> 
> 时间：2012-05-21T20:39:03.207
> 
> 标签：java, jdbc, birt

我正在寻找使用数据源对 BIRT API 进行编码的方向。我不确定如何配置我的应用程序以访问创建的数据源。如果我能得到一些帮助，那就太好了。这就是我所在的地方。我已经通过 BIRT RCP 创建了一个报告。现在我正在寻找使用常规 java 应用程序和 Web 应用程序生成报告。两者都将通过我将创建的 GUI 传递日期参数。两者都需要有数据源。我在这里看到了一些使用报表设计器的示例，但我没有使用它。我也没有使用 BIRT Report Creator (RCP) GUI 来生成它。

谢谢

```
import java.util.logging.Level;
import org.eclipse.birt.core.framework.Platform;
import org.eclipse.birt.report.engine.api.EngineConfig;
import org.eclipse.birt.report.engine.api.EngineException;
import org.eclipse.birt.report.engine.api.HTMLRenderOption;
import org.eclipse.birt.report.engine.api.IReportEngine;
import org.eclipse.birt.report.engine.api.IReportEngineFactory;
import org.eclipse.birt.report.engine.api.IReportRunnable;
import org.eclipse.birt.report.engine.api.IRunAndRenderTask;

public class ReportGenerator {
    public static void main(String args[]) throws EngineException {
        ReportGenerator reportGenerator = new ReportGenerator();
        reportGenerator.executeReport();
    }

    public void executeReport() throws EngineException {

        IReportEngine engine=null;
        EngineConfig config = null;

        try{
            config = new EngineConfig( );           
            config.setBIRTHome("C:\\birt-rcp-report-designer-3_7_2\\ReportEngine");
            config.setLogConfig("c:/temp/test", Level.FINEST);
            Platform.startup( config );
            IReportEngineFactory factory = (IReportEngineFactory) Platform.createFactoryObject( IReportEngineFactory.EXTENSION_REPORT_ENGINE_FACTORY );
            engine = factory.createReportEngine( config );      

            IReportRunnable design = null;
            //Open the report design
            design = engine.openReportDesign("ReportTemplates/testNoData.rptdesign"); 
            IRunAndRenderTask task = engine.createRunAndRenderTask(design);
            task.setParameterValue("AuthorName", "Dale DeMott");
            HTMLRenderOption options = new HTMLRenderOption();      
            options.setOutputFileName("output/resample/Parmdisp.html");
            options.setOutputFormat("html");

            task.setRenderOption(options);

            //Looking to create and insert a datasource here.
            //task.setDataSource(some parameters here that represent the ds);

            task.run();
            task.close();
            engine.destroy();
        } catch (Exception ex) {
            ex.printStackTrace();
        } finally {
            Platform.shutdown();
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-24T14:28:08.920

对此进行更深入的研究，我找到了自己问题的解决方案，并认为我会分享答案。

为了澄清我正在寻找一种将我的代码连接到 a 的方法`datasource`，这样我的`BIRT`报告查询就会运行。我发现，我可以通过`IGetParameterDefinitionTask`对象传递连接，方法是获取应用程序上下文，然后通过键值对设置在该对象中设置连接。

请参阅下面代码中的这一行... `task.getAppContext().put("OdaJDBCDriverPassInConnection", conn);`

```
public class ReportGenerator {
public static void main(String args[]) throws EngineException {
    ReportGenerator reportGenerator = new ReportGenerator();
    reportGenerator.executeReport();
}

public void executeReport() throws EngineException {

    IReportEngine engine=null;
    EngineConfig config = null;

    try{
        config = new EngineConfig( );           
        config.setBIRTHome("C:\\birt-rcp-report-designer-3_7_2\\ReportEngine");
        config.setLogConfig("c:/temp/test", Level.FINEST);
        Platform.startup( config );
        IReportEngineFactory factory = (IReportEngineFactory) Platform.createFactoryObject( IReportEngineFactory.EXTENSION_REPORT_ENGINE_FACTORY );
        engine = factory.createReportEngine( config );      

        IReportRunnable design = null;
        //Open the report design
        design = engine.openReportDesign("ReportTemplates/testNoData.rptdesign"); 
        IRunAndRenderTask task = engine.createRunAndRenderTask(design);
        task.setParameterValue("AuthorName", "Dale DeMott");
        HTMLRenderOption options = new HTMLRenderOption();      
        options.setOutputFileName("output/resample/Parmdisp.html");
        options.setOutputFormat("html");

        task.setRenderOption(options);

        //Connection helper is a utility class used to create a connection to your
        //database and return it.  
        ConnectionHelper connectionHelper = new ConnectionHelper();
        Connection conn = connectionHelper.getConnection();
        task.getAppContext().put("OdaJDBCDriverPassInConnection", conn);

        task.run();
        task.close();
        engine.destroy();
    } catch (Exception ex) {
        ex.printStackTrace();
    } finally {
        Platform.shutdown();
    }
}
} 
```

# html - 在 Vim 中正确突出显示 html 属性？

> ID：10692289
> 
> 赞同：1
> 
> 时间：2012-05-21T20:39:08.710
> 
> 标签：html, vim, syntax-highlighting

当我在 Vim 中寻找合适的 html 标签突出显示时，我发现了这篇[文章](https://stackoverflow.com/questions/5132877/proper-tag-highlighting-in-vim)。但是在查看了 romainl 的答案（和他的截图）和 html 语法文件之后，我想知道如何在不改变 html 标记颜色的情况下更改属性后 = （等号）的颜色以匹配属性的颜色？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-21T22:03:46.817

1.  **勘探**

    这是我在某处（很久以前，可能在 Vim Wiki 上）找到的一个非常有用的函数，它为您提供光标下单词/符号的语法组：

    ```
    function! SynStack()
        if !exists("*synstack")
            return
        endif
        echo map(synstack(line('.'), col('.')), 'synIDattr(v:val, "name")')
    endfunc 
    ```

    只需将光标放在要检查的项目上并键入`:call SynStack()`以在命令行中回显语法组。

    如果我将光标放在`=`in上`<div id="example"></div>`，则输出`SynStack()`是`['htmlTag']`。

    随着光标的出现，`<>`我也得到`['htmlTag']`了。

    将光标放在`div`我得到`['htmlTag', 'htmlTagN', 'htmlTagName']`这意味着`div`( `h1`, `p`...) 的颜色是通过一个称为`htmlTagName`继承自的特殊语法组定义的`htmlTag`。

    一些替代/自定义语法文件可能会定义名称略有不同的其他语法组，因此我的示例仅对我有效。您必须尝试`SynStack()`获得正确的语法组。

2.  **反射**

    根据我们迄今为止收集到的信息，很明显标签名称 ( `['htmlTagName']`) 可以独立于标签的其余部分设置样式，但似乎无法突出显示`=`不同之处。因为它是与 相同的语法组的一部分，`<>`所以`=`必须以相同的方式突出显示。

    我们有两种可能：

    一个。`<`，颜色相同，颜色`=`不同。`>``div`

    湾。`<`, `div`,`=`和`>`都是相同的颜色。

    原始主题遵循`a`我不喜欢的路径，所以我不得不`b`在我对上一个问题的回答中使用几行对其进行一点自定义（路径）：

    ```
    hi htmlTag            guifg=#90b0d1 gui=NONE 
    hi htmlSpecialTagName guifg=#90b0d1 gui=NONE 
    hi htmlTagName        guifg=#90b0d1 gui=NONE  
    hi htmlEndTag         guifg=#90b0d1 gui=NONE 
    ```

    事实上，不可能有`=`不同的颜色。`<>`如果我们想着色，`=`我们将编辑 HTML 语法文件*和*你的颜色方案，牛仔风格。

3.  **行动**

    **第一步**是制作默认 HTMl 语法文件的本地副本：

    ```
    $ cp /usr/share/vim/vim73/syntax/html.vim ~/.vim/syntax/html.vim 
    ```

    **下一步**是编辑此文件。我们将执行两个更改：

    1.  添加`htmlEqualSign`语法组的定义

        第 44 行应该是（注意！未经彻底测试。）：

        ```
        syn match htmlEqualSign contained "=" 
        ```

    2.  添加`htmlEqualSign`到`htmlTag`组

        第 40 行`~/.vim/syntax/html.vim`应更改为：

        ```
        syn region htmlTag start=+<[^/]+ end=+>+ contains=htmlTagN,htmlString,htmlArg,htmlValue,htmlTagError,htmlEvent,htmlCssDefinition,@htmlPreproc,@htmlArgCluster 
        ```

        至：

        ```
        syn region htmlTag start=+<[^/]+ end=+>+ contains=htmlTagN,htmlString,htmlArg,htmlValue,htmlTagError,htmlEvent,htmlCssDefinition,@htmlPreproc,@htmlArgCluster,htmlEqualSign 
        ```

    **最后一步**是编辑您的配色方案，使其`=`按照您想要的方式着色。你可以通过在你的配色方案中的某处添加这一行来做到这一点：

    ```
    hi htmlEqualSign guifg=#00ff00 
    ```

    当然，您可以选择颜色。

    但我认为您希望与（从您的问题中不是很清楚）`=`相同的颜色。`id`为此，我们将组“链接”`htmlEqualSign`到用于属性的组。再次，`:call SynStack()`有很大帮助：属性的语法组是`htmlArg`这样添加到您的颜色方案的行将是：

    ```
    hi link htmlEqualSign htmlArg 
    ```

# xml - 如何创建 vbscript 或 bat 文件以覆盖现有的 xml 文件

> ID：10692292
> 
> 赞同：0
> 
> 时间：2012-05-21T20:39:27.870
> 
> 标签：xml, vbscript, batch-file

我们应用程序的一位用户`zean.xml`在 location 中有一个名为 xml 的文件 `C:\ProgramData\Secon\levrer\8.6.7\team\lead\Captain folder`。但现在我觉得我需要用以下内容替换 xml 文件内容作为临时解决方法。我想编写 vbscript 或 bat 文件，以便我可以提供给正在使用这个 xml 文件的用户。任何机构都可以为我提供 vbscript 代码或 bat 文件，以便用以下内容重写 xml 文件

```
 <?xml version="1.0" standalone="yes" ?> 
 <TestSchema xmlns="http://tempuri.org/TestSchema.xsd">
  <UserZone>
  <Label>All</Label> 
  <ID>8c19c791-32d6-4ad1-8504-c3387b5a0096</ID> 
  </UserZone>
 <ZoneMgGrpCollection>
  <Owner>8c19c791-32d6-4ad1-8504-c3387b5a0096</Owner> 
  <MgGrpID>5f498b70-ee75-4ff0-8808-b9ba492b7f8a</MgGrpID> 
  </ZoneMgGrpCollection>
  </TestSchema> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T11:27:58.010

只需添加文本 oa new XML 文件，然后将其复制到另一个文件上。您可以手动或通过脚本进行操作，但我不明白您为什么要通过脚本进行操作，因为这显然是一次性操作。

```
Const ForReading = 1, ForWriting = 2, ForAppending = 8, CreateIfNeeded = true
Set fso = CreateObject("Scripting.FileSystemObject")
set tf=fso.OpenTextFile ("new.xml",ForWriting,CreateIfNeeded)
tf.write "<?xml version=""1.0"" standalone=""yes"" ?>  "
'repeat this for the other lines
tf.close
fso.CopyFile("new.xml", "C:\ProgramData\Secon\levrer\8.6.7\team\lead\Captain folder\",True) 
```

# django - Django 1.4 修改自定义帐户模型以实现电子邮件地址的唯一性

> ID：10692293
> 
> 赞同：2
> 
> 时间：2012-05-21T20:39:30.550
> 
> 标签：django, django-models, django-forms, django-views

我已经定义了一个自定义用户帐户，它利用了 auth User 模型中的几个内置项，并使用用户链接将这些与我在数据库上注册用户所需的一些附加字段链接起来。

～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～

与我的models.py相关

```
# additional model to incorporate our custom fields to the auth user model                                                                                   
class Account(models.Model):
    user = models.OneToOneField(User)      #link (pointer) to the users other information in User model                                                      
    birthdate = models.DateField(blank = True, ) # True makes this field optional                                                                            
    gender = models.CharField(max_length = 1, choices = GENDER_CHOICE, null = True, blank = True)                                                                                    

    def __unicode__(self):            # define a unicode for the user to access                                                                              
        return u'%s %s' % (self.user.first_name, self.user.last_name)   # return first and last name in shell  

# custom form to gather information from the user for a new account                                                                                          
class UserRegistration(UserCreationForm):
#class RegistrationForm(forms.ModelForm):                                                                                                                    
    class Meta:
        model = User
        fields = ("first_name", "last_name", "email", "username", "password1", "password2",)

    # ensures uniqueness of user email addresses when registering                                                                                         
    def clean_email(self):
        print "In custom creation"
        email = self.cleaned_data.get(email = 'email')
        username = self.cleaned_data.get(username = 'username')
        # checks if email address already exists                                                                                                          
        if User.objects.filter(email__iexact = self.cleaned_data['email']):
            print "Email exists"
#           if email and User.objects.filter(email__iexact = email).exclude(username=username).exists():                                                     
                raise forms.ValidationError(u'Email Address is currently used by another user.')
        return email 
```

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

与views.py相关

```
def Main(request):
    if request.user.is_authenticated():
        latest_events = Event.objects.all().order_by('-created')[:10] # Returns latest 10 events                                                              
        my_events = Event.objects.filter(creator=request.user)[:10]   # Returns up to 10 events created by current User                                       
        my_calendars = Calendar.objects.filter(creator=request.user)  # Returns all calendars created by the user                                             
        authForm = None
        loginForm = None
        headerType = "header.html"
    else:
        latest_events = None
        my_events = None
        my_calendars = None
        headerType = "header_main.html"

        authForm = UserRegistration(request.POST or None)
        print "Creating account UserRegistration" # TESTING PRINT                                                                                             
        print "User email = %s " %(User._meta.get_field('email'))
        if request.method == 'POST':
            if authForm.is_valid():
                newUser = authForm.save(commit=False)
                newUser.save()
                newUser = authenticate(username=request.POST['username'], password=request.POST['password1'])
                login(request, newUser)

                return HttpResponseRedirect('/signup/')
....
....
more code on success redirection
....
.... 
```

～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～

（我希望我没有发布太多代码，只是想彻底）

如您所见，我最近进行了一些已注释掉的尝试。我尝试通过下载“registration”来使用RegistrationFormUniqueForm() 内置的你，但我实际上并不想制作新的注册表单，因为我已经有了一个工作表。

我继续尝试另一个建议，评论下的代码

```
# custom form to display additional sign up information 
```

当我尝试使用已注册的电子邮件注册新用户时，它没有抛出任何错误并允许注册。我还尝试更改用户的电子邮件，它允许更改为已接收的电子邮件而没有异议。

任何人都可以建议一种方法来使用户注册保持对每个尝试使用可能已经被占用的电子邮件地址注册的人的唯一锁定吗？以及阻止他们将电子邮件更改为当前用户使用的电子邮件？

提前致谢。

编辑：我对模型注册表单 def clean_email() 和视图中的 def 进行了更改，以反映我目前拥有的仍然不起作用的内容。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-21T21:01:13.320

两种形式的方法的缩进`clean_email`都是错误的。目前，它们是`Meta`类的方法，所以永远不会被调用。例如，注册表应该是：

```
class RegistrationForm(UserCreationForm):
#class RegistrationForm(forms.ModelForm):                                                                                                                    
    class Meta:
        model = User
        fields = ("first_name", "last_name", "email", "username", "password1", "password2",)

    def clean_email(self):
        """ensures uniqueness of user email addresses when registering"""
        email = self.cleaned_data.get('email') 
```

这可能不是真正的问题——将代码粘贴到堆栈溢出时很容易出现缩进错误。如果是这种情况，我将删除答案。

# php - 是否可以在同一个 if 块中运行多个 elseif 块？

> ID：10692296
> 
> 赞同：4
> 
> 时间：2012-05-21T20:39:42.630
> 
> 标签：php, if-statement

```
$foo=1;

function someFunction(){
  if($foo==0){ //-------Will test, won't execute
    bar();
  }elseif($foo==1){ //--Will test, and execute
    baz();
  }elseif($foo==2){ //--Doesn't test
    qux();
  }elseif($foo==3){ //--Doesn't test
    quux();
  }else{ //-------------Doesn't test
    death();
  } //------------------The program will skip down to here.
} 
```

假设 baz() 改变了 $foo 的值，并且每次都不同。我希望我的代码在第一个语句之后继续测试 elseif/else 语句，并在它们为真时运行它们。

我不想再次运行整个函数（即我不在乎 $foo = 0 还是 1）。我正在寻找类似“继续；”的东西。无论如何，请让我知道这是否可能。谢谢。:)

编辑** 我的代码实际上比这更复杂。我只是为了理论而写下一些代码。我想要的只是脚本在通常不会的地方继续测试。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-21T20:52:55.913

如果我的理解正确，你想要做每个连续`elseif`的，不管之前的`if`/ s 是否匹配，但如果/ s*都不*`elseif`匹配，你还希望运行一些代码。在这种情况下，如果其中一个匹配，您可以设置一个要设置的标志，并使用s 代替。*`if``elseif``$matched``true``if`*

 *```
<?php
$foo=1;
function someFunction(){
  $matched = false;
  if($foo==0){
    bar();
    $matched = true;
  }
  if($foo==1){ //--This elseif will get executed, and after it's executed,
    baz();
    $matched = true;
  }
  if($foo==2){
    qux();
    $matched = true;
  }
  if($foo==3){
    quux();
    $matched = true;
  }
  if(!$matched){ /* Only run if nothing matched */
    death();
  }
} 
```

如果您还希望能够跳到最后，请使用[`goto`](http://php.net/manual/en/control-structures.goto.php)（但[请先查看此](http://xkcd.com/292/)内容）：

```
<?php
$foo=1;
function someFunction(){
  $matched = false;
  if($foo==0){
    bar();
    $matched = true;
    goto end: // Skip to end
  }
  if($foo==1){ //--This elseif will get executed, and after it's executed,
    baz();
    $matched = true;
  }
  if($foo==2){
    qux();
    $matched = true;
  }
  if($foo==3){
    quux();
    $matched = true;
  }
  if(!$matched){ /* Only run if nothing matched */
    death();
  }
  end:
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-21T20:44:53.847

我不知道这是否是您的意思，但您可以使用**switch**语句：

```
$foo=1;
function someFunction(){
  switch($foo==0){
    case 0:
        bar();
    case 1:
        baz();
    case 2:
        qux();
    case 3:
        quux();
    default:
        death();
} 
```

请注意，在每种情况下都不会中断。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-21T20:42:34.813

你不能只使用 else if 而只是一堆 ifs ......

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-05-21T20:44:51.427

// 此响应不正确。请参阅下面的评论。谢谢！

我不是专家，但按照我的理解，他们将继续运行。如果将来您正在编写一组`elseif()`语句，并且想要在其中一个为真时离开该系列，则使用该`break`命令。另请参阅`switch()`。

如果我错了，我绝对愿意纠正。*

# wpf - WPF 窗口大小问题

> ID：10692298
> 
> 赞同：1
> 
> 时间：2012-05-21T20:40:04.360
> 
> 标签：wpf, window, size, width

我希望我的应用程序适合所有屏幕尺寸，因此从窗口标签到所有容器/面板我都设置了 Width="Auto"。在窗口标签中指定了 MinWidth 和 MinHeight。尽管如此，我的窗口显示的尺寸比要求的还要大。我用我的孩子窗口设置了

```
Height="Auto" Width="Auto" MinHeight="300" MinWidth="650"
     WindowStartupLocation="CenterOwner" Loaded="Window_Loaded"  >

<StackPanel Orientation="Vertical" Width="650"> 
```

StackPanel 是所有面板的父/根。如您所见，stackPanel 的大小声明为 650，但加载时窗口的宽度为 1440。

我从父窗口通过 ShowDialog() 调用这个子窗口。同样的问题也与父窗口有关。

谁能帮我知道这里出了什么问题！为什么它不尊重提到的大小？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-21T20:46:35.987

将 Window 的属性 .SizeToContent 设置为“WidthAndHeight”。

# c# - ASP.NET - DetailsView HeaderTemplate 中的按钮可见性更改在 OnModeChanging 处理程序中不起作用

> ID：10692300
> 
> 赞同：1
> 
> 时间：2012-05-21T20:40:08.873
> 
> 标签：c#, asp.net, event-handling, detailsview, aspbutton

我有这个标记：

```
<asp:DetailsView ID="dvDatabase" OnModeChanging="dvDatabase_ModeChanging">
    <HeaderTemplate>
        <asp:Button ID="btnView" runat="server" CausesValidation="False" CommandName="Cancel"
            Text="View" CssClass="btn btn-primary" Visible="false" />
        <asp:Button runat="server" CausesValidation="False" CommandName="Edit"
            Text="Edit" CssClass="btn btn-success" ID="btnEdit" />
        <asp:Button runat="server" CausesValidation="False" CommandName="Delete"
            Text="Delete" CssClass="btn btn-danger" />
    </HeaderTemplate>
    ... 
```

然后我有这个 C#：

```
protected void dvDatabase_ModeChanging(object sender, DetailsViewModeEventArgs e)
{
    bool isEdit = DetailsViewMode.Edit == e.NewMode;
    DetailsView view = (DetailsView)sender;
    Button viewButton = (Button)view.FindControl("btnView");
    Button editButton = (Button)view.FindControl("btnEdit");
    viewButton.Visible = isEdit;
    editButton.Visible = !isEdit;
} 
```

我已经进行了一些调试，并且`Visible`属性设置正确，但我从未看到按钮发生变化。我点击了编辑按钮，我处于编辑模式，但编辑按钮仍然显示，查看按钮仍然隐藏。我尝试通过`dvDatabase.FindControl`直接找到按钮，而不是使用`object sender`变量，但这也不起作用。我试图根据`ID`标记中的属性来引用带有变量的按钮，但是`btnView`变量`btnEdit`/属性不存在。这是怎么回事？

**编辑：**我按照蒂姆的建议切换到`OnModeChanged`，但按钮仍然没有改变。这是我现在的 C#：

```
protected void dvDatabase_ModeChanged(object sender, EventArgs e)
{
    DetailsView view = /*(DetailsView)sender*/dvDatabase;
    bool isEdit = DetailsViewMode.Edit == view.CurrentMode;
    LinkButton viewButton = (LinkButton)view.FindControl("btnView");
    LinkButton editButton = (LinkButton)view.FindControl("btnEdit");
    viewButton.Visible = isEdit;
    editButton.Visible = !isEdit;
} 
```

我尝试使用`object sender`以及`dvDatabase`类变量，但似乎都没有效果。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-21T21:35:18.923

请改用`DetailsView`'[`DataBound`](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.basedataboundcontrol.databound)事件，并且仅对 DetailsView 进行数据绑定`if(!Page.IsPostback)`。您还需要处理[`ItemCommand`](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.detailsview.itemcommand)事件以调用适当的[`ChangeMode`方法](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.detailsview.changemode.aspx)并将`DetailsView`.

```
protected void dvDatabase_DataBound(Object sender, EventArgs e)
{ 
    var view = (DetailsView)sender;
    var btnView = (Button)view.FindControl("btnView");
    var btnEdit = (Button)view.FindControl("btnEdit");
    switch (view.CurrentMode)
    { 
        case DetailsViewMode.ReadOnly:
            btnView.Visible = false;
            btnEdit.Visible = true;
            break;
        case DetailsViewMode.Edit:
            btnView.Visible = true;
            btnEdit.Visible = false;
            break;
        case DetailsViewMode.Insert:
            btnView.Visible = false;
            btnEdit.Visible = false;
            break;
        default:
            break;
    }
} 
```

# java - 创建指定参数类型或其子类型的 Arraylist

> ID：10692302
> 
> 赞同：1
> 
> 时间：2012-05-21T20:40:14.263
> 
> 标签：java, generics, inheritance

我打算创建一个具有以下签名的函数 -

```
public static List<? extends Model> getList(Model T, int numberOfItems, StringReader reader) 
```

现在，在这个函数中，我想创建一个 ArrayList，它将包含与 T**或其任何子类**相同类型的对象，即 T 可以是 Model 对象或其任何子类型。

到目前为止，我试过 -

```
 List < ? extends T> list = new ArrayList(); 
```

但它没有用。如何让它工作？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-21T20:50:13.013

你可能想要的是这样的：

```
public static <T extends Model> List<T> getList(T model, int numberOfItems, StringReader reader) 
```

这指定该方法具有`T`扩展的类型参数`Model`，因此该方法可以与任何此类类型一起使用，并且该调用将返回`List`作为第一个参数传递的类型的 a。方法内部：

```
List <T> list = new ArrayList(); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-21T21:05:59.890

您必须将`Class`实例作为类型标记传递。像这样的东西：

```
public static <T extends Model> List<T> getList(
    Class<T> c, int numberOfItems, StringReader reader)
{
  final List<T> l = new ArrayList<T>();
  try { for (int i = 0; i < numberOfItems; i++) l.add(c.newInstance());
  } catch (Exception e) { throw new RuntimeException(e); }
  return l;
} 
```

我不知道你想怎么用，`StringReader`所以我把它放在一边。使用类文字调用该方法。假设你有一个`SubModel extends Model`，那么

```
final List<SubModel> l = getList(SubModel.class, 10, reader); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-21T20:49:47.443

我*想*你要的是

```
public static <M extends Model> List<M> getList(M t, int numberOfItems, ...) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-21T20:50:06.437

```
public static <T extends Model> List<T> getList(final Model t, final int numberOfItems, final StringReader reader)
{
    final List<T> aaa=new ArrayList<T>();
    return null;
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-21T20:51:30.563

这将返回类型 T 的列表（并且 T 是 Model 类型或其子类之一）。

```
public static <T extends Model> List<T> getList(T object, int numberOfItems, StringReader reader) {
    return Arrays.asList(object);
} 
```

# windows - 将所有文件内容复制到新文件中 - 批处理

> ID：10692303
> 
> 赞同：0
> 
> 时间：2012-05-21T20:40:18.777
> 
> 标签：windows, batch-file

我需要做的是（我有一些想法，只是无法固化）：

*   读取目录中的所有文件（for循环）
*   在循环中，我需要将循环内容中的当前文件复制到同一目录中的新文件（x.txt 到 x2.txt）中。这可以通过 type >> 命令来完成。

我对它的循环部分更加困惑。我怎么做？

**编辑：**

这是我当前的脚本：

```
FOR %%i IN (*)
Do type %%i >> %%i2 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-21T20:46:08.647

这会将每个`.txt`文件复制到带有扩展名的备份文件中`.txt2`：

```
for %i in (*.txt) do type "%i" > "%i2" 
```

请注意，在批处理文件中，您需要将以下内容加倍`%`：

```
for %%i in (*.txt) do type "%%i" > "%%i2" 
```

从您的问题中不清楚您是否希望将所有找到的文件转储到相同的结果文本文件中，或者您是否想要每个文件的一对一副本。

如果您只想要一个结果文件，您还可以使用复制命令的变体，即：

```
copy *.txt output.dat 
```

# ruby-on-rails - 导轨。对集合的特定属性求和

> ID：10692310
> 
> 赞同：10
> 
> 时间：2012-05-21T20:41:04.827
> 
> 标签：ruby-on-rails, ruby

我有发票清单...

```
@invoices_1_week = Invoice.order("due_date DESC").where("status != 'paid' AND due_date >= ? AND due_date < ?", Date.today, 1.week.from_now) 
```

invoices 模型有一个 total 属性。如何获得 @invoice_1_week 集合中的总数？

我知道我可以在这样的视图中做到这一点......

```
<% week_1_total = 0 %>
<% @invoices_1_week.each do |invoice| %>
  <% week_1_total = week_1_total + invoice.total %>
<% end %>
<%= week_1_total %> 
```

但我想知道是否有更 Railsy 的方式来做到这一点。

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2012-05-21T20:54:51.830

这是一个 Rails 方式，使用 ActiveRecord 的`sum`方法：

```
@invoices_1_week.sum("total") 
```

[这](http://api.rubyonrails.org/classes/ActiveRecord/Calculations.html#method-i-sum)是文档。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-10-14T09:56:55.173

您可能需要考虑使用符号表示法

```
@invoices_1_week.sum(:total) 
```

或使用单引号

```
@invoices_1_week.sum('total') 
```

在这两种情况下，属性名称都是不可变的。

# python - 在 mongo (python) 中添加列表字段

> ID：10692312
> 
> 赞同：2
> 
> 时间：2012-05-21T20:41:08.337
> 
> 标签：python, pymongo

我有一个与一些标签相关联的 id，我想用这些标签填充一个集合。我该怎么做呢？

假设我有以下内容：

```
key: 12345, tags = ["foo","bar","foobar"] 
```

所以我希望在一个名为“Tags”的集合中得到一个文档，如下所示：

```
{ 
  "_id" : ObjectId("4fbaa6076a56b2700d000000"), 
  "key" : 12345, 
  "tags" : ["foo","bar","foobar"] 
} 
```

我如何在python中做到这一点？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-21T22:24:47.573

```
mongo_conn.Tags.insert({
    "key": 12345,
    "tags": ["foo","bar","foobar"]
}) 
```

# html - 网页上元素的对齐方式

> ID：10692314
> 
> 赞同：0
> 
> 时间：2012-05-21T20:41:27.743
> 
> 标签：html, css, alignment

我在网页上制作了一个菜单，但似乎无法让元素正确排列。我有两个按钮和两个下拉菜单，图片附在下面。

![在此处输入图像描述](../Images/a15ad010cb98f1522538b2a00a7ad1cd.png)

我可以做什么样的 CSS 样式来使下拉菜单与“Go”按钮水平对齐？我尝试调整两个元素的底部和顶部边距，但这似乎不是我想要的。

这是两个元素的当前 CSS：

```
select.small {   //<- drop downs
    width: 120px; 
    margin-bottom: 0px; 
}

button.small{  //<- buttons
    margin-bottom: 0px;
} 
```

任何输入都将不胜感激，因为我对此很陌生。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T20:44:22.027

将`position`按钮设置为`relative`并添加：

```
top: 5px; 
```

或任何需要的东西。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-21T20:50:52.207

您应该`vertical-align: middle;`先尝试，但这取决于您的 HTML。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-22T05:22:40.290

您可以使用没有边框的表格并将这些元素存储在表格数据中。还可以在其中使用填充样式以使其看起来舒适。

# javascript - jQuery setTimeOut 延迟

> ID：10692318
> 
> 赞同：0
> 
> 时间：2012-05-21T20:41:43.610
> 
> 标签：javascript, jquery, jquery-animate

这将如何用 Jquery 编写？我尝试使用 delay() 但似乎在画布中不起作用。

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-21T20:46:47.527

```
$('div.jgauge .needle').rotateAnimation(-200 + 220);
setTimeout (function(){$('div.jgauge .needle').rotateAnimation(220 + -200);},1000); 
```

# php - 没有 jquery 的 AJAX 回调

> ID：10692321
> 
> 赞同：-1
> 
> 时间：2012-05-21T20:41:57.417
> 
> 标签：php, html, ajax, json

> **可能重复：**
> [我该怎么做？（阿贾克斯）](https://stackoverflow.com/questions/10658735/how-would-i-go-about-doing-this-ajax)

自从我上次问这个问题以来，我在具体化方面非常失败，所以我将再次尝试并尽可能具体化。

首先，我在 json_encode 函数中编码了我的数据。

例如，看起来像这样：

```
{"test":"test value"} 
```

我想要做的是将测试变成一个javascript变量，它可以保存“测试值”的数据。json_encode 数据位于名为 index.php 的页面上，我希望在其中定义变量的页面名为 example.html。所以我想要的是在 html 的 javascript 部分有一个名为 test 的 javascript 变量，并让它等于字符串“test value”。

此外，我不希望 jquery 用于此解决方案，因为我被限制不能这样做。我不能使用隐形表格并提交它们。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-21T20:55:43.510

对象是关联数组。它们存储键/值对。所以你所要做的就是：

```
var test = function(){}
test["hello"] = "world"; 
```

这将设置`hello`为变量`world`及其值。你可以通过这样做来测试这个

```
alert(test.hello); 
```

用json 键和值替换`hello`and`world`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-21T21:03:29.793

```
var json = JSON.parse( {"test":"test value"} )

var testValue = json.test 
```

# html - IE7中的锯齿状图像

> ID：10692324
> 
> 赞同：0
> 
> 时间：2012-05-21T20:42:17.980
> 
> 标签：html, image, internet-explorer-7

我正在与 IE7 战斗，试图“实现这一目标”。问题是我不想使用 JavaScript。我想找到一个解决方案，以防 JavaScript 没有打开。如您所见，图像呈锯齿状，像素化。但是，如果我将图像格式更改为 JPG，它看起来会好很多。我需要让它们具有透明背景。知道为什么会这样吗？

![例子](../Images/34e56ada069a38af859dcf3583be9806.png).

```
<div id="container">

<!-- <div id="main" role="main">-->

    <h2>Example</h2>

    <div id="group_1" class="level_1">
        <img src="img/woodMain.jpg"alt=""> 

        <ul id="ul_1" class="level_2">

            <li class="level_2">
              <label class="level_3"><img src="img/newLabel.png"  alt=""></label>
              <img src="img/book_3.png">                 
            </li>

            <li class="level_2">
              <label class="level_3"><img src="img/newLabel.png" alt=""></label>
              <img src="img/book_4.png">                 
            </li>

        </ul>
    </div><!-- ends 1_group -->  

    <div id="2_group" class="ground_cero">

       <img src="img/2_group.png"alt="">

       <!--
        <ul>
            <li>
              <label><img src="" alt=""></label>

            </li>

        -->
    </div><!-- ends 2_group -->  

<!-- </div> --><!-- ends main -->

 </div> <!--! end of #container --> 
```

和CSS：

```
body{ max-width: 100%; }

img{ 
/*max-width: 100%;*/
max-width: 100%;
height: auto; 
}

label{
max-width: 30%;
height: auto;
position: absolute;

}

label img{

}

div#container{

margin: auto;
border: 2px solid red;

}
/*
div#container div#main{
*/
/*border: 1px solid black;*/
/*max-width: 70%;
/*z-index: 1;
}*/

div#container div{

margin: auto;
max-width: 82%;
position: relative;
/*border: 1px solid red;*/

}

div#container div img{
width: 100%;
height: auto;
}
div#container  div#group_1 #ul_1{

padding: 0px;   
overflow: hidden;
margin: 0px;
/*border: 1px solid green;*/
bottom: 3%;
left: 0px;
max-width: 100%; 
position: absolute;
margin-left: 2%;

}

div#container div #ul_1 li {
list-style: none;
margin-left: 5%;
display: inline-block; /* others than IE 7 */
position: relative;
zoom: 1; /* calling the haslayut method inside IE7 */
*display: inline; /*targeting IE6-7 */
bottom: 0px;
width: 25%;
vertical-align: bottom;

} 
```

# forms - 带有目标的 Internet Explorer 表单提交到 iframe 不起作用

> ID：10692325
> 
> 赞同：2
> 
> 时间：2012-05-21T20:42:19.787
> 
> 标签：forms, internet-explorer, iframe, submit

我正在使用隐藏的 iframe 方法来提交文件而不加载新页面，它适用于除 Internet Explorer 之外的所有浏览器，这对于其他顶级浏览器来说很奇怪。

表单和 iframe 如下所示：

```
<iframe id="hidden_upload" style="display:none" src="" name="hidden_upload" ></iframe>
<form class="" action="upload.php" method="post" target="hidden_upload" enctype="multipart/form-data" id="uploadForm">
    <table>
        <tbody>
            <tr>
                <td><label for = "title">Title: </label></td>
                <td><input type="text" name="title" id="title" maxlength="40" style="width:300px;"/></td>
            </tr>

            <tr>
                <td><label for="description">Description: </label></td>
                <td><textarea id="description" name="description" style="width:460px;height:135px;"></textarea></td>
            </tr>

            <tr>
                <td><label for="file">File: </label></td>
                <td><input type="hidden"  name="MAX_FILE_SIZE" value="3145728" /><input id="file" type="file" name="file"/></td>
            </tr>

        </tbody>    
    </table>
    <center><input type="submit" value="Upload" id="filesubmit" onclick="return submitting()"/></center>
</form> 
```

我有另一个在 IE 中工作的页面，在文档类型或表单和 iframe 结构方面没有明显差异。

它也不是上传页面的标题，因为我尝试将工作表单的操作设置为非工作表单的上传页面，它仍然在 IE 中工作。

该函数`submitting`正在运行，返回 true。

编辑：

为简洁起见，这也不起作用：

```
<form class="" action="upload.php" method="post" target="hidden_upload" enctype="multipart/form-data" id="importForm">
    <input type="submit" />
</form>
<iframe id="hidden_upload" style="display:none" src="" name="hidden_upload" ></iframe> 
```

编辑：这完全是荒谬的。我将工作页面逐字复制到非工作页面中，但仍然无法正常工作。唯一的区别是目录，.htaccess 文件是相同的。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2014-07-24T19:30:46.907

我遇到了这个问题，经过多次尝试，它仅按照此处的说明解决：

“ [http://terminalapp.net/submitting-a-form-with-target-set-to-a-script-generated-iframe-on-ie/](http://terminalapp.net/submitting-a-form-with-target-set-to-a-script-generated-iframe-on-ie/) ”

基本上，iframe 需要以这种方式创建：

```
iframe = document.createElement('<iframe name="fileUploaderEmptyHole">'); 
```

我还发现当前窗口的框架名称存储在 window.frames 中。在 IE11 中，属性 .name 对于 windows.frames 中的所有 iframe 为空：O

我手动修复如下：

```
for(i=0;i<window.frames.length;i++)
 window.frames[i].name = window.frames[i].frameElement.name; 
```

然后，您可以使用目标名称访问帧。

# json - 将 json 对象与数组合并

> ID：10692326
> 
> 赞同：0
> 
> 时间：2012-05-21T20:42:22.357
> 
> 标签：json, merge, knockout.js, unobtrusive

假设我有两个 json 对象，我需要合并它们。

```
css: [{
        drag: "mode() == 'layout'",
        ui_draggable: "mode() == 'layout'"
}]

css: [{
        someclass : true
}] 
```

我想结束：

```
css: [{
        drag: "mode() == 'layout'",
        ui_draggable: "mode() == 'layout'",
        someclass : true
}] 
```

经过进一步的试验，我想出了这个，但我认为我在其中放置了一些错误或无用的代码行。

玩了一会儿后，我想出了这段代码。我的需求不需要递归超过两个级别，所以这很好。我敢肯定，它可能会更加精致，但它非常适合绑定淘汰赛。这是我如何使用它来扩展 jquery unobtrusive [knockoutjs的示例](https://gist.github.com/2773185)

```
 var settings = {
        text: 'SelectedCard().CardData.Title',
        visible: "mode() != 'edit' || !isMyCard()",
        css: [{ drag: "mode() == 'layout'" , selectedElement: "selectedCardElement() == '_titlePreview'"}]
    };
    var settings2 = 
        {
            css: [{ drag: "mode() == 'layout'"}]
    };
   var settings3 =  merge(settings, settings2);

function merge(first, second) {

    for (var a1 in first) {
        // if second object is null we are finished.
        used.push(a1);
        if (second[a1] == null) {
            continue;
        } else {

            var ob2 = second[a1];
            if (typeof (first[a1]) != typeof (ob2)) {
            throw new Error("conflicting properties named:" + a1);
            }

            if ($.isArray(first[a1])) {

                for (var i = 0; i < ob2.length; i++) {
                    first[a1].push(ob2[i]);
                }

            } else {
                // matching property. 
                return merge(first[a1], second[a1]);
            }
        }
    }
    for (var a2 in second) {
        if (used.indexOf(a2) < 0) {
            first[a2] = second[a2];
        }
    }
    return first;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-21T22:29:37.180

1) 要将两个对象合并为单向覆盖，可以这样做：

```
for (var attrname in obj2) { 
    obj1[attrname] = obj2[attrname]; 
} 
```

2）有选择地合并，两种方式：

```
obj1.someclass = obj2.someclass; 
```

-或者-

```
obj2["someclass"] = obj1["someclass"]; 
```

在这种情况下，如果对象中尚不存在该属性，则无需在分配之前对其进行定义。

3) 考虑使用像[Underscore.js](http://underscorejs.org/#union)这样的库来执行类似于以下的“数组函数”：

```
_.union([1, 2, 3], [101, 2, 1, 10], [2, 1]);

returns [1, 2, 3, 101, 10] 
```

4) 最后，这里是格式化 JSON 对象、数组及其组合的强大资源：[jsonexample.com](http://jsonexample.com)。当您进入复杂的“数组函数”时，这将很有帮助。

干杯!

# objective-c - 编码 HTTP 的响应，它是 MIME，但不显示其最后部分

> ID：10692327
> 
> 赞同：0
> 
> 时间：2012-05-21T20:42:22.723
> 
> 标签：objective-c, ios, parsing, nsdata, mime

```
- (void)connectionDidFinishLoading:(NSURLConnection *)connection
{
  if (_receivedData)
{
    NSString* _str = [[NSString alloc]initWithData:_receivedData encoding:NSASCIIStringEncoding]; 
    NSLog(@"urlData........%@",_str);

    [_receivedData release], _receivedData = nil;
}

[_connection release], _connection = nil;

CFRunLoopStop(CFRunLoopGetCurrent());
} 
```

当 NSLOG _str 不解码 MIME 消息的最后部分（打印？？？）时，我认为是 encode:NSASCIIStringEncoding 的问题。

我如何设置编码？？？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-29T22:42:15.970

尝试使用 NSUTF8StringEncoding 而不是 NSASCIIStringEncoding。

# javascript - MVC3 JSON Telerik MVC TreeView Javascript

> ID：10692329
> 
> 赞同：1
> 
> 时间：2012-05-21T20:42:35.343
> 
> 标签：javascript, json, asp.net-mvc-3, telerik

我正在尝试从 json 绑定数据。在控制器中，我正在发送

```
......
public JsonResult LoadTree()
........
return Json(jn, JsonRequestBehavior.AllowGet); 
```

在调试中，我得到 jn 中的值（47 个项目，每个项目有两个条目（文本和值）。

在视图中，我正在使用以下脚本：

```
function onDataBinding(e) {
    var url = 'CourseCases/LoadTree';
    var result;
    $.ajax({
        url: url,
        data: {},
        contentType: "application/json",
        success: function (data) {
            alert(data);
            var treeview = $("#TreeView").data("tTreeView");
            treeview.bindTo(data);
        }
    });
} 
```

它不起作用，警报显示对象，对象；树视图是空白的！知道为什么吗？提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T15:36:16.000

实际上，您发送的属性应该被称为`Value`and`Text`而不是`value`and `text`。这是一个对我来说很好的例子。

控制器：

```
public class HomeController : Controller
{
    public ActionResult Index()
    {
        return View();
    }

    public ActionResult LoadTree()
    {
        var jn = new[] 
        {
            new { Value = "1", Text = "Item 1" },
            new { Value = "2", Text = "Item 2" },
            new { Value = "3", Text = "Item 3" },
        };
        return Json(jn, JsonRequestBehavior.AllowGet);
    }
} 
```

查看 ( `~/Views/Home/Index.cshtml`):

```
<script type="text/javascript">
    function onDataBinding(e) {
        var url = '@Url.Action("LoadTree")';
        var result;
        $.ajax({
            url: url,
            data: { },
            success: function (data) {
                var treeview = $("#TreeView").data("tTreeView");
                treeview.bindTo(data);
            }
        });
    }    
</script>

@(Html
    .Telerik()
    .TreeView()
    .Name("TreeView")
    .ClientEvents(events =>
    {
        events.OnDataBinding("onDataBinding");
    })
) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-21T22:10:35.177

可能你应该直接在 $.post 的回调方法中调用 treeview.bindTo 。我想使用当前代码，您可能会在回调中确保 jn == 内容之前将树视图绑定到 jsonObject == jn。如果你提醒你添加一个很大的延迟，它会给 AJAX 发布足够的时间来完成和运行回调。

# objective-c - iPhone 插座可以通过 WIFI 工作，但不能通过 3G

> ID：10692332
> 
> 赞同：0
> 
> 时间：2012-05-21T20:42:37.730
> 
> 标签：objective-c, ios, sockets

我有一个通过套接字连接到客户端机器的本机 iPhone 应用程序。连接可以通过 WIFI 工作，但不能通过 3G 工作。

有谁知道问题可能是什么？

谢谢你。

更新：客户端机器与 iPhone 不在同一个网络上。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-21T20:48:53.577

此客户端计算机是否与 iPhone 在同一网络内？然后您可以通过 Wifi 访问它，但需要通过 3G 的代理。只是一个猜测。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-13T15:38:48.103

问题是某些蜂窝网络会阻塞某些端口。这就是为什么它可以在 WIFI 上工作而不是 3g 的原因。最好使用 Web 服务的原因之一。

# qt - 如何在 Qt 中通过以太网播放流式音频？

> ID：10692333
> 
> 赞同：9
> 
> 时间：2012-05-21T20:42:41.410
> 
> 标签：qt, audio, streaming, networkstream

我的目标是通过 LAN 网络传输 *.wav 文件，没有延迟或最少。

我们还分部分读取服务器机器上的文件，均为 320 字节。在此之后，我们通过 UDP 发送数据包并在 jitter-buffer 中写入接收。jitter-buffer 的大小是 10。我应该在定时器上设置什么延迟才能获得清晰的声音？

这是发件人：

```
void MainWindow::on_start_tx_triggered()
{
    timer1 = new QTimer (this);
    udpSocketout = new QUdpSocket(this);
    qDebug()<<"Start";
    for (int i = 0; i < playlist.size(); ++i)
    {
        inputFile.setFileName(playlist.at(i));
        qDebug()<<inputFile.fileName();
        if (!inputFile.open(QIODevice::ReadOnly))
        {
            qDebug()<< "file not found;";
        }
    }
    connect(timer1, SIGNAL(timeout()), this, SLOT(writeDatagrams()));
    timer1->start(5);
}

void MainWindow::writeDatagrams()
{
    if(!inputFile.atEnd()){
        payloadout = inputFile.read(320);
    }
    qDebug()<<payloadout;
    QDataStream out(&datagramout, QIODevice::WriteOnly);
    out.setVersion(QDataStream::Qt_4_7);
    out << qint64(0);
    out << payloadout;
    out.device()->seek(qint64(0));
    out << qint64(datagramout.size() - sizeof(qint64));
    qint64 writtenBytes = udpSocketout->writeDatagram(datagramout, remoteHOST, remotePORT);
    qDebug() << "Sent " << writtenBytes << " bytes.";
} 
```

这是接收器和播放器：

```
void MainWindow::on_start_rx_triggered()
{
    udpSocketin = new QUdpSocket(this);
    udpSocketin->bind(localHOST, localPORT);
    connect(udpSocketin, SIGNAL(readyRead()),
            this, SLOT(readDatagrams()));
    QDataStream out(&datagramout, QIODevice::WriteOnly);
    out.setVersion(QDataStream::Qt_4_7);
    timer2 =  new QTimer (this);
    connect(timer2, SIGNAL(timeout()), this, SLOT(playbuff()));
    timer2->start(50);
    audioout = new QAudioOutput(format, this);
}

void MainWindow::readDatagrams()
{
    datagramin.resize(udpSocketin->pendingDatagramSize());
    qint64 receiveBytes = udpSocketin->readDatagram(datagramin.data(), datagramin.size());
    qDebug() << "Receive " << receiveBytes << " bytes.";
    QDataStream in(&datagramin, QIODevice::ReadOnly);
    in.setVersion(QDataStream::Qt_4_7);
    quint64 size = 0;
    if(in.device()->size() > sizeof(quint64))
    {
        in >> size;
    }
    else
        return;
    if(in.device()->size() < size)
        return;
    in >> payloadin;
    qDebug() << payloadin.size();
    emit jitterbuff();
}

void MainWindow::jitterbuff()
{
    if (buff_pos < SIZE_OF_BUF)
    {
        QDataStream out(&buffered, QIODevice::WriteOnly);
        out.setVersion(QDataStream::Qt_4_7);
        out << payloadin;
        buff_pos++;
    }
    else
        buff_pos = 0;
}

void MainWindow::playbuff()
{
    qDebug() << "YES!!!";
    buffer = new QBuffer(&buffered);
    buffer->open(QIODevice::ReadOnly);
    audioout->start(buffer);
    QEventLoop loop;
    QTimer::singleShot(50, &loop, SLOT(quit()));
    loop.exec();
    buffer->close();
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-29T23:39:06.450

这个问题就解决了。QAdioOutput 有两种模式；有“推”和“拉”之分。我给了一个 QIODevice 的指针，然后直接向它写入数据。解决方案：

读取 UDP 套接字：

```
void MainWindow::on_start_rx_triggered()
{
    udpSocketin = new QUdpSocket(this);
    udpSocketin->bind(localPORT);
    connect(udpSocketin, SIGNAL(readyRead()), this, SLOT(readDatagrams()));
    QDataStream out(&datagramout, QIODevice::WriteOnly);
    out.setVersion(QDataStream::Qt_4_7);
    timer2 = new QTimer (this);
    connect(timer2, SIGNAL(timeout()), this, SLOT(playbuff()));
    timer2->setInterval(15*9);
    audioout = new QAudioOutput(format, this);
    input = audioout->start();
}

void MainWindow::readDatagrams()
{
    if (udpSocketin->hasPendingDatagrams()){
    datagramin.resize(udpSocketin->pendingDatagramSize());
    qint64 receiveBytes = udpSocketin->readDatagram(datagramin.data(), datagramin.size());
    if (receiveBytes <= 0)
    {
        msg.warning(this, "File ERROR", "The end!", QMessageBox::Ok);
        emit on_stop_rx_triggered();
    }
    QDataStream in(&datagramin, QIODevice::ReadOnly);
    in.setVersion(QDataStream::Qt_4_7);
    quint64 size = 0;
    if(in.device()->size() > sizeof(quint64))
    {
        in >> size;
    }
    else return;
    in >> rxfilename;
    in >> name;
    in >> payloadin;
    emit jitterbuff();
}

void MainWindow::jitterbuff()
{
    if (buff_pos < SIZE_OF_BUF)
    {
        buffered.append(payloadin);
        buff_pos++;
    }
    else
    {
        timer2->start();
        buffered.clear();
        buff_pos = 0;
    }
}

void MainWindow::playbuff()
{
    if (!buffered.isEmpty())
    {
        buffer = new QBuffer(&buffered);
        buffer->open(QIODevice::ReadOnly);
        input->write(buffered);
        buffer->close();
    }
} 
```

写入 UDP 套接字：

```
void MainWindow::on_start_tx_triggered()
{
    timer1 = new QTimer (this);
    udpSocketout = new QUdpSocket(this);
    inputFile.setFileName(playlist.at(playIDfile));
    if (!inputFile.open(QIODevice::ReadOnly))
    {
        msg.warning(this, "File ERROR", "File not found!", QMessageBox::Ok);
        return;
    }
    fileinfo = new QFileInfo (inputFile);
    txfilename = fileinfo->fileName();
    ui->playedFile->setText("Now played: " + txfilename);
    connect(timer1, SIGNAL(timeout()), this, SLOT(writeDatagrams()));
    timer1->start(15);
}
void  MainWindow::writeDatagrams()
{

    if(!inputFile.atEnd()){
        payloadout = inputFile.read(SIZE_OF_SOUND);
        QDataStream out(&datagramout, QIODevice::WriteOnly);
        out.setVersion(QDataStream::Qt_4_7);
        out << qint64(0);
        out << txfilename;
        out << name;
        out << payloadout;
        out.device()->seek(qint64(0));
        out << qint64(datagramout.size() - sizeof(qint64));
        qint64 writtenBytes = udpSocketout->writeDatagram(datagramout, remoteHOST, remotePORT);
    }
} 
```

如果有人看起来有问题，我会尽力帮助他/她。

# c# - 这些方法中的任何一种对于使用 Mongo Db Driver for C# 进行查询是否比另一种更优化？

> ID：10692334
> 
> 赞同：0
> 
> 时间：2012-05-21T20:42:42.847
> 
> 标签：c#, mongodb, querying

对于使用 Mongo Db Driver for C# 进行查询，这些方法中的任何一种是否比另一种更优化？：

> var partsLogs = MvcApplication.MongoLoggingDatabase.GetCollection("PartDetailLog") .FindAll()
> 
> > ```
> >  .Where(x => x.UserId == UserId)
> >            .Select(x => new RecentActivityPartsLogDto { OemCode = x.Request.OemCode, OemPartCode = x.Request.OemPartCode, OemPartDescription = x.Request.OemPartDescription, TimeStamp = x.TimeStamp, UserId = x.UserId.ToString() })
> >            .OrderByDescending(x => x.TimeStamp)
> >            .Skip(pageSize * (page - 1))
> >            .Take(pageSize); 
> > ```

或者

> var doc = new QueryDocument(); doc["UserId"] = UserId;
> 
> var partsLogs = MvcApplication.MongoLoggingDatabase.GetCollection("PartDetailLog")
> 
> > ```
> >  .Find(doc)              
> >            .Select(x => new RecentActivityPartsLogDto { OemCode = x.Request.OemCode, OemPartCode = x.Request.OemPartCode, OemPartDescription = x.Request.OemPartDescription, TimeStamp = x.TimeStamp, UserId = x.UserId.ToString()})
> >            .OrderByDescending(x => x.TimeStamp)
> >            .Skip(pageSize*(page - 1))
> >            .Take(pageSize); 
> > ```

还有其他建议可以使此查询更好吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-22T06:07:49.113

第一个将拉回每个文档并在客户端过滤它，第二个将过滤文档服务器端并仅拉回匹配的文档。使用第二个。

# ruby-on-rails-3 - Rails 文件上传和 Heroku

> ID：10692335
> 
> 赞同：0
> 
> 时间：2012-05-21T20:42:53.923
> 
> 标签：ruby-on-rails-3, file-upload, heroku

我在 Heroku 服务器上上传文件时遇到问题。（也非常感谢使用rails做此类事情的正确方法的提示 - 我在RoR中非常新）。

所有这些代码都是关于上传一些 CSV 文件，然后允许用户调整几个设置，然后解析文件。这通常在本地主机上工作（有几次我在会话中存储的值遇到问题），但在 Heroku 上它总是在上传时死掉。

在其中一个社区问题中写道，Heroku 仅在单个实例运行期间存储文件，但我在 Heroku 的文档中仍然找不到任何关于此的内容。我应该在上传后立即将文件数据存储在数据库中，所以在这种情况下它总是可用的吗？缺点 - 文件可能非常大，大约 10-20Mb，看起来不太好。

Heroku 日志说：

```
 2012-05-21T19:27:20+00:00 app[web.1]: Started POST "/products/upload" for 46.119
.175.140 at 2012-05-21 19:27:20 +0000
2012-05-21T19:27:20+00:00 app[web.1]:   Processing by ProductsController#upload
as HTML
2012-05-21T19:27:20+00:00 app[web.1]:   Parameters: {"utf8"=>"тЬУ", "authenticit
y_token"=>"aqJFg3aqENfxS2lKCE4o4txxkZTJgPx36SZ7r3nyZBw=", "upload"=>{"my_file"=>
#<ActionDispatch::Http::UploadedFile:0x000000053af020 @original_filename="marina
-AutoPalmaPriceList_2011-07-30.txt", @content_type="text/plain", @headers="Conte
nt-Disposition: form-data; name=\"upload[my_file]\"; filename=\"marina-AutoPalma
PriceList_2011-07-30.txt\"\r\nContent-Type: text/plain\r\n", @tempfile=#<File:/t
mp/RackMultipart20120521-1-10g8xmx>>}, "commit"=>"Upload"}
2012-05-21T19:27:20+00:00 app[web.1]:
2012-05-21T19:27:20+00:00 app[web.1]: LoadError (no such file to load -- CSV):
2012-05-21T19:27:20+00:00 app[web.1]:   app/controllers/products_controller.rb:8
2:in `upload'
2012-05-21T19:27:20+00:00 app[web.1]:
2012-05-21T19:27:20+00:00 app[web.1]:
2012-05-21T19:27:20+00:00 app[web.1]: cache: [POST /products/upload] invalidate,
 pass 
```

**代码本身：**

产品控制器：

```
def import
  respond_to do |format|
    format.html
  end
end

def import_adjust
  case params[:commit]
    when "Adjust"
      @col_default = params[:col_data]
      #abort @col_default.to_yaml
      #update csv reader with form data, restore filters  from params
    when "Complete"
      #all ok, read the whole file
      #abort params.to_yaml
      redirect_to import_complete
    else
      @col_default = nil
  end
  #read first part of the file
  @tmp = session[:import_file]
  @csv = []
  source = CSV.open @tmp, {col_sep: ";"}

  5.times do
    line = source.readline
    if line.size>0
      @line_size = line.size
      @csv.push line
    end
  end

  #generate a selection array
  #selection = select_tag 'col_data[]', options_for_select([['name','name'], ['brand','brand'], ['delivery_time','delivery_time'], ['price','price']])
  #@csv = [selection * line_size] + @csv
end

def import_complete
  #remove all items
  #todo check products with line items will not be destroyed.
  Product.destroy_all
  #abort params.to_yaml
  map = {}
  cnt = 0
  #todo check for params count.
  params[:col_data].each do |val|
    map[cnt] = val if val != 'ignore'
    cnt += 1
  end

  source = CSV.open session[:import_file], {col_sep: ';'}
  source.each do |row|
    cnt += 1
    if row.size > 0
      item = Product.new
      map.each do |col, attr|
        item[attr] = row[col]
      end
      item[:provider_id] = params[:adjust][:provider]
      item.save
      #abort item.to_yaml
    end
  end

  #abort map.to_yaml
  #todo response needed.
end

def upload
  require 'CSV' #looks like I dont need this in fact.
  @tmp = params[:upload][:my_file].path #tempfile

  @csv = []
  #source = CSV.open @tmp, {col_sep: ";"}

  session[:import_file] = params[:upload][:my_file].path

  respond_to do |format|
    format.html { redirect_to action: 'import_adjust' }
  end
end 
```

上传.html.erb：

```
<h1>Uploaded</h1>
<%= @tmp %>

<% @csv.each do |val| %>
    <%= val %>
<% end %> 
```

_form_import.html.erb：

```
<%= form_for :upload, :html => {:multipart => true}, :url => {action: "upload"} do |f| %>
<%= f.file_field :my_file %>
<%= f.submit "Upload" %>
<% end %> 
```

import_adjust.html.erb：

```
<h1>New product</h1>

<%= form_for :adjust, :url => {action: "import_adjust"} do |f| %>
<% if @csv %>
<table>
  <tr>
    <% @line_size.times do |cnt| %>
        <td>
        <%= select_tag 'col_data[]',
               options_for_select([
                  ['--ignore--', 'ignore'],
                  ['name','name'],
                  ['brand','brand'],
                  ['delivery_time','delivery_time'],
                  ['price','price']
        ], @col_default!=nil ? @col_default[cnt] : nil) %>
        </td>
    <% end %>
  </tr>

  <% @csv.each do |val| %>
     <tr>
     <% val.each do |cell| %>
       <td>
         <%= cell %>
       </td>
     <% end %>
     </tr>
  <% end %>
</table>
<% end %>

  <%= f.label :delimiter, 'Разделитель' %>
  <%= f.text_field :delimiter %>
  <br>
  <%= f.label :provider, 'Поставщик' %>
  <%#todo default empty option needed! Human mistakes warning! %>
  <%= f.select :provider, Provider.all.collect { |item| [item.name, item.id] } %>
  <br>
  <%= f.label :delimiter, 'Разделитель' %>
  <%= f.text_field :delimiter %>
  <br>
  <%# Adjust for proceed adjusting or Complete  for parsing %>
  <%= f.submit "Adjust" %>
  <%= f.submit "Complete" %>
<% end %>

<%= link_to 'Back', products_path %> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-21T23:42:31.917

你能粘贴整个控制器代码吗？问题出在第 82 行，但如果你去掉了 def 和 before_filters 类，我不能 100% 确定那是哪一行。

也就是说，看起来问题出在 CSV.open 行之一上。您尝试设置`session[:import_file]`的方式不能保证有效。如果您曾经在多个测功机上运行该应用程序，您的第一个请求可能由您的 web.1 测功机服务，第二个请求由 web.2 服务，并且它们具有不同的文件系统并且将无法看到相同的临时文件.

我建议以下之一：

*   在上传时立即进行所有处理并避免重定向。
*   对此的改进是让上传将数据存储在共享和可访问的位置（数据库或 S3），并启动后台作业/进程来进行处理。
*   最好的办法是直接上传到 S3（我相信 S3 Uploader 库可以做到这一点，可能还有其他库）并发出回调以创建要处理的后台作业。

最后一个选项意味着您的网络测功机永远不会被处理大量上传，并且您不必等待*上传到服务器->在 S3 中存储->调度后台作业*所涉及的延迟给用户带来负担，它只需*存储在*从他们的角度来看*S3 。*

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-09T15:42:32.370

我有一个与 Lifecoder 相同的场景，用户上传文件，使用 map_fields 插件（由 Andrew Timberlake 编写）命名列，然后解析和处理文件。这是我的处理方式：

```
 file_field = params[options[:file_field]]
  map_fields_file_name = "map_fields_#{Time.now.to_i}_#{$$}"

  bucket = S3.buckets[CSV_COUPON_BUCKET_NAME]    # gets an existing bucket
  obj = bucket.objects[map_fields_file_name]
  obj.write( file_field.read )

  # Save the name and bucket to retrieve on second pass
  session[:map_fields][:bucket_name] = map_fields_file_name 
```

然后在第二次处理文件时，我打开文件并将其读回 temp 以供测功机处理：

```
 # Get CSV data out of bucket and stick it back into temp, so we pick up where
    # we left off as far as map_fields is concerned.
    bucket = S3.buckets[CSV_COUPON_BUCKET_NAME]
    obj = bucket.objects[session[:map_fields][:bucket_name]]
    temp_path = File.join(Dir::tmpdir, "map_fields_#{Time.now.to_i}_#{$$}")
    File.open(temp_path, 'wb') do |f|
      f.write obj.read
    end 
```

我不得不使用插件，所以我可以修改代码，因为很明显 gem 是由 Heroku 处理的并且不允许修改。

# php - SQL 不工作，除非多个 db_connect(); 陈述

> ID：10692337
> 
> 赞同：0
> 
> 时间：2012-05-21T20:42:55.670
> 
> 标签：php

在过去，我使用一个简单的方法没有任何问题：

$link = db_connect();

在具有多个 SQL 命令的单个文件中，如下所示：

```
$sql = "UPDATE table SET...";

$sql_result = mysql_query($sql, $link)
or die("Couldn't execute query.");

$sql2 = "UPDATE table2 SET...";

$sql_result2 = mysql_query($sql2, $link)
or die("Couldn't execute query."); 
```

现在，如果没有多个/单独的 db_connect，我创建的任何新文件都将无法工作。例如：

```
$link = db_connect();

$link2 = db_connect();

$sql = "UPDATE table SET...";

$sql_result = mysql_query($sql, $link)
or die("Couldn't execute query.");

$sql2 = "UPDATE table2 SET...";

$sql_result2 = mysql_query($sql2, $link2)
or die("Couldn't execute query."); 
```

具有多个 mysql_queries 引用单个 db_connect() 的旧文件；仍然工作正常。有什么可以改变的？

谢谢。

更新为包含 db_connect(); 功能：

```
function db_connect($db="database", $host="localhost", $user="user", $p="password") {

    $dbcnx = @mysql_connect($host, $user, $p);

    if (!$dbcnx)
    {
    echo( "<p>Unable to connect to the database server at this time.</p>" );
    exit();
    }

    $database = @mysql_select_db($db, $dbcnx);
    if (!$db)
    {
    echo "<p>Unable to locate the database at this time.</p>";
    exit();
    }

return $dbcnx;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-23T20:55:09.790

您发布的内容看起来不错，除非您有一些**unset()** ing $link、为其分配值或其他使 $link 不再指向数据库的东西。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-23T20:33:15.190

如果要分隔 $links，请添加`true`为第四个`mysql_connect()`参数：

```
$dbcnx = @mysql_connect($host, $user, $p, true); 
```

此外，如果您想使用不同的连接（不同的数据库、用户、密码），则需要将参数显式传递给`db_connect()`第二次：

```
$link2 = db_connect('database2', 'whateverthehost', 'user2', 'andhispassword'); 
```

# iphone - CMDeviceMotion yaw 值在 iPhone 垂直时不稳定

> ID：10692344
> 
> 赞同：13
> 
> 时间：2012-05-21T20:43:42.113
> 
> 标签：iphone, ios, cocoa-touch, sensors, cmmotionmanager

在 iOS 原型中，我使用 CMDeviceMotion.deviceMotion.yaw 和 CLHeading.trueHeading 的组合来制作响应准确的稳定罗盘航向。这在 iPhone 平放时效果很好，我有一个图形箭头指向一个稳定的指南针方向。

当 iPhone 在纵向模式下垂直放置时会出现此问题。UIDeviceOrientation 不断从 UIDeviceOrientationFaceDown 更改为 UIDeviceOrientationFaceUp 并返回。这使得偏航值根据俯仰的微小变化来回跳跃 +/-180 度。是否可以将设备锁定到一个提供稳定偏航值的方向，预测没有故障的变化或以其他方式计算陀螺偏航（或在该方向滚动）？

这个可怜的家伙有同样的问题，没有答案。双倍积分可能的人！:) [https://stackoverflow.com/questions/10470938/euler-angle-yaw-not-working-when-iphone-orientation-changes](https://stackoverflow.com/questions/10470938/euler-angle-yaw-not-working-when-iphone-orientation-changes)

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-07-29T18:27:46.127

我只是在寻找这个问题的答案。看到你在一年多前发布了这篇文章，我有点心碎，但我想也许你或其他人可以从这个解决方案中受益。

问题是万向节锁定。当俯仰大约为 90 度时，偏航和滚动匹配，陀螺仪失去了一个自由度。四元数是避免万向节锁定的一种方法，但老实说，我并不想为此纠结。相反，我注意到偏航和滚动实际上匹配并且可以简单地相加以解决问题（假设您只关心偏航）。

**解决方案：**

```
 float yawDegrees = currentAttitude.yaw * (180.0 / M_PI);
    float pitchDegrees = currentAttitude.pitch  * (180.0 / M_PI);
    float rollDegrees = currentAttitude.roll * (180.0 / M_PI);

    double rotationDegrees;
    if(rollDegrees < 0 && yawDegrees < 0) // This is the condition where simply
                                          // summing yawDegrees with rollDegrees
                                          // wouldn't work.
                                          // Suppose yaw = -177 and pitch = -165\. 
                                          // rotationDegrees would then be -342, 
                                          // making your rotation angle jump all
                                          // the way around the circle.
    {
        rotationDegrees = 360 - (-1 * (yawDegrees + rollDegrees));
    }
    else
    {
        rotationDegrees = yawDegrees + rollDegrees;
    }

    // Use rotationDegrees with range 0 - 360 to do whatever you want. 
```

我希望这对其他人有帮助！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-05-22T08:39:26.357

如果有人对 iOS Swift 中的实现感兴趣，代码如下：

```
 let queue = NSOperationQueue()
    motionManager.startDeviceMotionUpdatesToQueue(queue) {
        [weak self] (data: CMDeviceMotion!, error: NSError!) in
    var yawDegrees: Double = self!.motionManager.deviceMotion.attitude.yaw * (180.0 / M_PI)
        var pitchDegrees: Double = self!.motionManager.deviceMotion.attitude.pitch * (180.0 / M_PI)
        var rollDegrees: Double = self!.motionManager.deviceMotion.attitude.roll * (180.0 / M_PI)

        if(rollDegrees < 0 && yawDegrees < 0){
            self!.rotationDegrees = 360 - (-1 * (yawDegrees + rollDegrees))
        }
        else {
            self!.rotationDegrees = yawDegrees + rollDegrees
        }
   } 
```

但是我遇到了一些问题，我希望@blkhp19 可以帮助我解决这个问题，因为在某些时候角度会变成负值，这会打乱整个计算，我无法弄清楚问题是什么。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2020-12-09T17:59:16.373

这个问题有点令人困惑，因为至少有两种不同的方式来考虑 Yaw。一种是从手机的角度，一种是从世界的角度。

我将使用[Apple 的这张图片](https://developer.apple.com/documentation/coremotion/getting_processed_device-motion_data/understanding_reference_frames_and_device_attitude)来进一步解释：

> [![在此处输入图像描述](../Images/ce25f45ed49e1b5a0abfe183ff5b6872.png)](https://i.stack.imgur.com/eW87j.png)

如果手机**平放在桌子上**：

*   沿手机偏航（或 Z 轴）旋转：更改指南针航向。
*   沿手机的滚动（或 Y 轴）旋转：**不要更改指南针航向。**
*   沿手机的俯仰（或 X 轴）旋转：不要更改罗盘航向。

如果手机**平贴在墙上**：

*   沿手机偏航（或 Z 轴）旋转：更改指南针航向。
*   沿手机滚动（或 Y 轴）旋转：**更改指南针航向。**
*   沿手机的俯仰（或 X 轴）旋转：不要更改罗盘航向。

* * *

对于这个答案的其余部分，我将假设手机是直立的，并且偏航、俯仰和滚动指的是上面照片中的内容。

## 偏航

![](../Images/ec81853eba6f55ef88e0c2c3439d6833.png)

您需要像[本例](https://nshipster.com/cmdevicemotion/)`atan2`中那样使用和检查重力。

```
let yaw = -Angle(radians: .pi - atan2(motion.gravity.x, motion.gravity.y)) 
```

## 沥青

与上面类似，我主要只是交换了 x 和 z ，它似乎返回了正确的值：

```
let pitch = Angle(radians: .pi - atan2(motion.gravity.z, motion.gravity.y)) 
```

## 滚动（又名指南针航向）

使用[上面 blkhp19 的代码](https://stackoverflow.com/a/17931490/35690)总结了偏航和滚动的姿态。如果您 import `SwiftUI`，您可以利用该`Angle`结构使弧度 + 度数转换更容易：

```
 func roll(motion: CMDeviceMotion) -> Angle {
    let attitudeYaw = Angle(radians: motion.attitude.yaw)
    let attitudeRoll = Angle(radians: motion.attitude.roll)

    var compassHeading: Angle = attitudeYaw + attitudeRoll
    if attitudeRoll.degrees < 0 && attitudeYaw.degrees < 0 {
      compassHeading = Angle(degrees: 360 - (-1 * compassHeading.degrees))
    }
    return compassHeading
  } 
```

* * *

另请注意，如果您不需要实际角度，而您只需要关系（例如 isPhoneUpright），您可以简单地读取这些的重力值。

```
extension CMDeviceMotion {
  var yaw: Angle {
    -Angle(radians: .pi - atan2(gravity.x, gravity.y))
  }

  var pitch: Angle {
    Angle(radians: .pi - atan2(gravity.z, gravity.y))
  }

  var roll: Angle {
    let attitudeYaw = Angle(radians: attitude.yaw)
    let attitudeRoll = Angle(radians: attitude.roll)

    var compassHeading: Angle = attitudeYaw + attitudeRoll
    if attitudeRoll.degrees < 0 && attitudeYaw.degrees < 0 {
      compassHeading = Angle(degrees: 360 - (-1 * compassHeading.degrees))
    }
    return compassHeading
  }
} 
```

# c++ - 是否值得添加启用移动的设置器？

> ID：10692345
> 
> 赞同：11
> 
> 时间：2012-05-21T20:43:55.013
> 
> 标签：c++, visual-studio-2010, c++11, move-semantics

这篇文章有点啰嗦，所以在我开始之前，我想弄清楚我在问什么：你是否在你的代码中添加了启用移动的设置器并且你发现它值得付出努力？我发现有多少行为可能是特定于编译器的？

我在这里看到的是在我设置复杂类型的属性的情况下是否值得添加启用移动的 setter 函数。在这里，我启用了移动`Bar`，并且`Foo`有一个`Bar`可以设置的属性。

```
class Bar {
public:
    Bar() : _array(1000) {}
    Bar(Bar const & other) : _array(other._array) {}
    Bar(Bar && other) : _array(std::move(other._array)) {}
    Bar & operator=(Bar const & other) {
        _array = other._array;
        return *this;
    }
    Bar & operator=(Bar && other) {
        _array = std::move(other._array);
        return *this;
    }
private:
    vector<string> _array;
};

class Foo {
public:
    void SetBarByCopy(Bar value) {
        _bar = value;
    }
    void SetBarByMovedCopy(Bar value) {
        _bar = std::move(value);
    }
    void SetBarByConstRef(Bar const & value) {
        _bar = value;
    }
    void SetBarByMove(Bar && value) {
        _bar = std::move(value);
    }
private:
    Bar _bar;
}; 
```

一般来说，过去我为非内置类型的 setter 函数使用了 const-ref。我看到的选项是按值传递然后移动（`SetByMovedCopy`），通过 const-ref 然后复制（`SetByConstRef`），最后通过 r-value-ref 接受然后移动（`SetByMove`）。作为基线，我还包括按值传递然后复制（`SetByCopy`）。FWIW，如果同时包含按值传递和 r-value-ref 重载，编译器会抱怨模棱两可。

在使用 VS2010 编译器进行实验时，我发现：

```
Foo foo;
Bar bar_one;

foo.SetByCopy(bar_one);
// Bar::copy ctor called (to construct "value" from bar_one)
// Foo::SetByCopy entered
// Bar::copy operator= called (to copy "value" to _bar)
// Foo::SetByCopy exiting
// Bar::dtor called (on "value") 
```

`value`从 复制构造`bar_one`，然后`value`复制到`bar`。`value`被破坏并产生破坏完整对象的任何成本。执行 2 次复制操作。

```
foo.SetByMovedCopy(bar_one);
// Bar::copy ctor called (to construct "value" from bar_one)
// Foo::SetByCopy entered
// Bar::move operator= called (to move "value" into _bar)
// Foo::SetByCopy exiting
// Bar::dtor called (to destruct the moved "value") 
```

`value`从 复制构造`bar_one`，然后`value`移入`_bar`，然后在函数退出后破坏内脏`value`，大概成本较低。1 复制和 1 移动操作。

```
foo.SetByConstRef(bar_one);
// Foo::SetByConstRef entered
// Bar::copy operator= called (to copy bar_one into _bar)
// Foo::SetByConstRef exiting 
```

`bar_one`直接复制到`_bar`. 1复制操作。

```
foo.SetByMove(std::move(bar_one))
// Foo::SetByMove entered
// Bar::move operator= called (to move "value" into _bar)
// Foo::SetByMove exited 
```

`bar_one`直接移入`_bar`. 1 移动操作。

* * *

所以 const-ref 和 move 版本在这种情况下是最有效的。现在，更重要的是，我想要做的是这样的事情：

```
void SetBar(Bar const & value) { _bar = value; }
void SetBar(Bar && value) { _bar = std::move(value); } 
```

我在这里发现的是，如果您调用`Foo::SetBar`，编译器会根据您传递的是左值还是右值来选择函数。您可以通过这样调用来强制解决问题`std::move`：

```
foo.SetBar(bar_one); // Const-ref version called
foo.SetBar(Bar()); // Move version called
foo.SetBar(std::move(bar_one)); // Move version called 
```

想到添加所有这些移动设置器，我不寒而栗，但我认为在将临时传递给函数的情况下，它可能会带来相当显着的性能提升，并且我可以通过在适当`SetBar`的地方应用来获得更多收益。`std::move`

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-21T20:54:00.330

另一种选择是模板：

```
template <typename T>
typename std::enable_if<std::is_assignable<Foo, T>::value>::type set(T && t)
{
    foo_ = std::forward<T>(t);
} 
```

这样你就可以匹配*任何*可兑换的东西和任何价值类别。不要忘记`#include <type_traits>`获取`is_assignable`。（你不应该省略，`enable_if`这样你的函数就不会错误地出现在其他特征检查中。）

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-05-22T17:01:19.563

tl;博士：使用 PassByValue。在您的 PassByValue 中，通过`std::move`. 如果您知道 setter 也在使用它，则在`std::move`调用 setter 时使用它（即）。`foo.PassByValue(std::move(my_local_var))`

setter 的单一版本，按值获取对象，以有效的方式处理最常见的用途，允许编译器进行优化，更干净，更易读。

* * *

我喜欢给出的答案，但我认为对我的问题的最佳答案来自原始问题中的评论，这使我从不同的角度探讨了我如何测试这些方法，所以我会成为那种人家伙提供我自己的问题的答案。

```
class Foo {
public:
    void PassByValue(vector<string> value) {
        _bar = std::move(value);
    }
    void PassByConstRefOrMove(vector<string> const & value) {
        _bar = value;
    }
    void PassByConstRefOrMove(vector<string> && value) {
        _bar = std::move(value);
    }
    void Reset() {
        std::swap(_bar, vector<string>());
    }
private:
    vector<string> _bar;
}; 
```

为了进行测试，我比较了 3 种情况：传递左值、传递右值以及传递显式移动的左值作为右值引用。

此测试的目的不是测量函数调用的开销。那是在微优化领域。我正在尝试做的是剖析编译器行为并制定实现和使用 setter 函数的最佳实践。

```
vector<string> lots_of_strings(1000000, "test string");
Foo foo;
// Passing an l-value
foo.PassByValue(lots_of_strings);
// Passing an r-value
foo.PassByValue(vector<string>(1000000, "test string"));
// Passing an r-value reference
foo.PassByValue(std::move(lots_of_strings));

// Reset vector because of move
lots_of_strings = vector<string>(1000000, "test string");
// l-value, calls const-ref overload
foo.PassByConstRefOrMove(lots_of_strings);
// r-value, calls r-value-ref overload
foo.PassByConstRefOrMove(vector<string>(1000000, "test string"));
// explicit move on l-value, calls r-value-ref overload
foo.PassByConstRefOrMove(std::move(lots_of_strings)); 
```

为简洁起见，我还在`Foo::Reset()`每次通话后都打电话来清理`_bar`。结果（1000次通过后）：

```
PassByValue:
  On l-value    : 34.0975±0.0371 ms
  On r-value    : 30.8749±0.0298 ms
  On r-value ref:  4.2927e-3±4.2796e-5 ms

PassByConstRefOrMove:
  On l-value    : 33.864±0.0289 ms
  On r-value    : 30.8741±0.0298 ms
  On r-value ref:  4.1233e-3±4.5498e-5 ms 
```

每次通话后重置`foo`可能不是对现实生活的完美模拟。当我不这样做而是设置`_bar`已经有一些数据时，`PassByConstRef`在 l 值测试中表现得更好，在 r 值测试中表现得更好一些。我相信它在 l-value 测试中的表现要好得多，因为`vector`它意识到它不需要重新分配并直接复制内容。但是，在移动的情况下，无论如何它都会取消分配，并产生该成本。但这是`vector`特定的行为，我不确定在这种情况下它是否应该很重要。

否则结果是相似的。列出的误差范围只是基于结果的标准误差，并没有考虑我使用的 CPU 定时器的准确性。

我得出的结论是，最好只传递价值。对于这个人为的场景，这两种方法在性能方面几乎相同，并且对于政府工作来说当然足够好，但是使用传递值的易于实施和界面的清晰性使其在我的书中具有优势。我只需要记住`std::move`在调用 setter 时使用它是有意义的，因为它可以产生重大影响。

向@Luc_Danton 致敬，因为他为我指明了这个方向。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-21T21:00:56.460

我使用的一种技术是使用宏来自动生成类属性的 getter/setter。除了较少的样板代码之外，这还有其他优点，例如使用宏自动提供 typedef 并强制执行一致的接口语义。我也不觉得它比其他代码更难阅读。

例如，

```
#define ATTRIBUTE(type, name) \
public: \
typedef type name##_type; \
\
void set_##name( type const &p_##name ) { \
  m_##name = p_#name; \
} \
\
void set_##name( type &&p_##name ) { \
  m_##name = std::move( p_##name ); \
\
type const &get_##name( ) const { \
  return m_##name; \
} \
\
type *mutable_##name( ) { \
  return &m_##name; \
} \
\
private: \
\
type m_##name; 
```

现在您的代码如下所示：

```
struct blah {
  ATTRIBUTE( std::string, foo );
}; 
```

我实际上认为这比一堆 setter 和 getter 更容易阅读。（包含可变访问器有一个很好的理由：这意味着您不必创建完整的副本，而是可以就地修改成员，而且它比非常量 getter 更明确。）这有点麻烦是当您使用模板作为宏参数时，因为预处理器将以逗号分隔，但您可以通过定义 COMMA 宏来克服这个问题：

```
#define COMMA ,

struct blah {
  ATTRIBUTE( std::map< foo COMMA bar >, baz );
}; 
```

# javascript - 将变量更新为函数中的参数

> ID：10692346
> 
> 赞同：3
> 
> 时间：2012-05-21T20:44:06.823
> 
> 标签：javascript, jquery, function, variables

我有一个滚动图像脚本，我想使用悬停功能即时更新滚动速度。我已经研究过，只是无法弄清楚如何在不再次调用函数的情况下让变量在函数内部更新。我不希望它重新开始，我只想在运行时提高速度。

```
(function ($) {
    $(function () { //on DOM ready
        var defspeed = 1;
        $(".simply-scroll-list").simplyScroll({
            speed: defspeed,
        });
    });
})(jQuery);
$('.fast-forward').hover(function () {
    var defspeed = 5;
}); 
```

正如您在上面看到的，我不知道如何正确集成这两个代码块。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-21T20:47:06.110

您不能以一种体面的方式即时提高速度，因为在初始化 simpleyScroll 插件时速度仅设置一次。

您可以重新初始化插件，但这可能会产生不必要的副作用。jQuery 插件有时会向您的 DOM 添加额外的 html 并重新初始化它会多次这样做。多个事件处理程序可能会附加到同一个节点，并且各种事情都可能出错。我不知道这个插件是否是这种情况。试试看 ：）

我自己只是将它添加到插件中。我认为这并不难，因为插件很小。

# ruby-on-rails - 在不同主机上预编译具有相同摘要的资产

> ID：10692348
> 
> 赞同：2
> 
> 时间：2012-05-21T20:44:11.677
> 
> 标签：ruby-on-rails, ruby-on-rails-3, asset-pipeline

是否可以使用相同的摘要在不同主机（流量路由）上编译资产？

例如，如果我的 Rails 3.2 应用程序部署到 2 个不同的主机 host1 和 host2，我希望`application.css`在 host1 和 host2 上都有相同的摘要`application-34a9sadas1238023a8.css`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T21:07:08.780

每个主机的摘要都是相同的，因为它基于文件的内容。

如果您要部署到多个主机，则资产将在部署期间在这两个主机上进行预编译。

如果你想避免这种情况，因为它需要时间，有一种方法可以在本地编译并提交，并且仍然可以按预期工作。它就在[这里](http://richardhulse.blogspot.co.nz/2012/03/rails-how-to-compile-and-commit-assets.html)。

# xpath - 如何遍历 XML 以在soapUI 中创建 Xpath？

> ID：10692351
> 
> 赞同：0
> 
> 时间：2012-05-21T20:44:36.513
> 
> 标签：xpath, groovy, soapui, loops

我正在尝试使用一系列 AMF 请求为我的 API 在soapUI 中设置负载测试，但我无法弄清楚如何使用这样的 XML 响应进行属性传输：

```
<flex.messaging.io.amf.ASObject serialization="custom">
  <unserializable-parents/>
  <map>
    <default>
      <loadFactor>0.75</loadFactor>
      <threshold>48</threshold>
    </default>
    <int>64</int>
    <int>28</int>
    <string>key</string>
    <boolean>value</boolean>
    <string>key</string>
    <boolean>value</boolean>
    <string>key</string>
    <string>value</string>
    <string>key</string>
    <boolean>value</boolean>
    <string>key</string>
    <null/>
    <string>key</string>
    <null/>
    <string>key</string>
    <null/>
    <string>key</string>
    <null/>
    <string>key</string>
    <null/>
    <string>key</string>
    <null/>
    <string>key</string>
    <boolean>value</boolean>
    <string>key</string>
    <boolean>value</boolean>
    <string>key</string>
    <null/>
    <string>key</string>
    <string>value</string>
    <string>key</string>
    <string>value</string>
    <string>key</string>
    <object-array/>
    <string>key</string>
    <flex.messaging.io.amf.ASObject serialization="custom">
      <unserializable-parents/>
      <map>
        <default>
          <loadFactor>0.75</loadFactor>
          <threshold>12</threshold>
        </default>
        <int>16</int>
        <int>3</int>
        <string>key</string>
        <boolean>value</boolean>
        <string>key</string>
        <boolean>value</boolean>
        <string>key</string>
        <boolean>value</boolean>
      </map>
      <flex.messaging.io.amf.ASObject>
        <default>
          <inHashCode>false</inHashCode>
          <inToString>false</inToString>
          <namedType>package/class</namedType>
        </default>
      </flex.messaging.io.amf.ASObject>
    </flex.messaging.io.amf.ASObject>
    <string>key</string>
    <string>value</string>
    <string>key</string>
    <boolean>value</boolean>
    <string>key</string>
    <string>value</string>
    <string>key</string>
    <flex.messaging.io.amf.ASObject serialization="custom">
      <unserializable-parents/>
      <map>
        <default>
          <loadFactor>0.75</loadFactor>
          <threshold>12</threshold>
        </default>
        <int>16</int>
        <int>5</int>
        <string>key</string>
        <boolean>value</boolean>
        <string>key</string>
        <boolean>value</boolean>
        <string>key</string>
        <boolean>value</boolean>
        <string>key</string>
        <boolean>value</boolean>
        <string>key</string>
        <boolean>value</boolean>
      </map>
      <flex.messaging.io.amf.ASObject>
        <default>
          <inHashCode>false</inHashCode>
          <inToString>false</inToString>
          <namedType>package/class</namedType>
        </default>
      </flex.messaging.io.amf.ASObject>
    </flex.messaging.io.amf.ASObject>
    <string>guid</string>
    <string>818f40db-c217-46ed-a6a2-7c830d894a95</string>
    <string>key</string>
    <string>value</string>
    <string>key</string>
    <null/>
    <string>key</string>
    <string>value</string>
    <string>key</string>
    <string>value</string>
    <string>key</string>
    <null/>
    <string>key</string>
    <null/>
  </map>
  <flex.messaging.io.amf.ASObject>
    <default>
      <inHashCode>false</inHashCode>
      <inToString>false</inToString>
      <namedType>package/class</namedType>
    </default>
  </flex.messaging.io.amf.ASObject>
</flex.messaging.io.amf.ASObject> 
```

因为我没有使用soapUI Pro，所以我无法访问xpath 向导。有没有办法通过属性传输或 Groovy 脚本来访问这个节点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-22T07:42:53.410

您可以使用 XmlSlurper 访问这两个：

```
def src = '''<flex.messaging.io.amf.ASObject serialization="custom">
            |  <unserializable-parents/>
            |  <map>
            |    <default>
            |      <loadFactor>1.00</loadFactor>
            |      <threshold>50</threshold>
            |    </default>
            |    <string>Not what I need</string>
            |    <string>Not what I need</string>
            |    <string>Not what I need</string>
            |    <string>Not what I need</string>
            |    <string>Not what I need</string>
            |    <object-array/>
            |    <string>Not what I need</string>
            |    <string>This is the KEY I'm looking for</string>
            |    <string>This is the VALUE I need to pass to the next test step</string>
            |    <string>Not what I need</string>
            |    <string>Not what I need</string>
            |    <string>Not what I need</string>
            |    <null/>
            |    <string>Not what I need</string>
            |    <string>Not what I need</string>
            |    <string>Not what I need</string>
            |    <string>Not what I need</string>
            |    <string>Not what I need</string>
            |    <null/>
            |    <string>Not what I need</string>
            |    <null/>
            |  </map>
            |</flex.messaging.io.amf.ASObject>'''.stripMargin()

def aso = new XmlSlurper().parseText( src )

def (key,value) = aso.map.string[6..7]*.text()

println "  key = $key"
println "value = $value" 
```

这感觉有点“硬编码”，但我看不出如何以编程方式定位这些值:-(

* * *

### 编辑

鉴于您发布的新 XML，这似乎适用于这种情况：

```
println aso.map.children()[ 3..-1 ]    // Strip out the initial default and ints
       .collate( 2 )                   // Group the key/value pairs
       .findAll { 
         it[ 0 ].text() == 'guid'      // find all that have 'guid' as element 0
       }
       .collectEntries { it*.text() }  // convert this into a map 
```

并打印：

```
[guid:818f40db-c217-46ed-a6a2-7c830d894a95] 
```

但是，更彻底的 depthFirst 算法可能是扫描所有可能输入的更可靠的方法（我不知道 ASObject 序列化，所以我不知道这是否适用于这个实例）

* * *

### 编辑 2

当你被一个没有方法的 Groovy 版本（1.8.6）困住时，你可以使用传统的循环`collate`来做这样的事情：`for`

```
def aso = new XmlSlurper().parseText( src ).map.children()
String guid = null
for( i = 3 ; i < aso.size() ; i += 2 ) {
  if( aso[ i ] == 'guid' ) {
    guid = aso[ i + 1 ]
    break
  }
}
println guid 
```

# java - 如果窗口不在顶部，则听击键

> ID：10692356
> 
> 赞同：2
> 
> 时间：2012-05-21T20:44:43.767
> 
> 标签：java, swing, keylistener, keyevent

好的，所以我有一个添加了 KeyListener 的 JFrame，并且我将可聚焦设置为 true。KeyListener 没有问题，但它只在窗口位于顶部时才监听键。如果窗口不在顶部，我想做的是听击键。基本上，我正在尝试制作一个程序，该程序在用户按下 F10 时执行代码，并在用户再次按下 F10 时停止执行代码。窗口不必在顶部才能使该程序工作，这意味着如果我按 F10 并且 JFrame 不在顶部，它仍然会执行。任何帮助将不胜感激！谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T21:06:06.173

不，Key Bindings/KeyListeners/任何纯 Java 应用程序都不能工作，因为应用程序必须在上面才能工作。

您正在寻找一个键盘挂钩，而 Java 本身无法做到这一点。您必须使用链接到本机应用程序（例如 C/C++ 应用程序）的 JNI、JNA，或者更简单地将 Java 链接到脚本实用程序（例如 AutoIt）（如果是 Windows，或者类似的实用程序，如果不是）。请注意，所有这些解决方案都*必须*是特定于平台的。

# java - 如何在 Java 中获取 Instrumentation 的实例

> ID：10692357
> 
> 赞同：6
> 
> 时间：2012-05-21T20:44:44.763
> 
> 标签：java, memory, instrumentation

我正在尝试编写一个简单的`ObjectUtils`类，其中包含所有对象的各种实用方法。我想让其中一个被调用`getObjectSize(Object)`，你将它传递给一个实例化的对象，它会返回对象在内存中的大小：

```
public class ObjectUtils {
    private static volatile Instrumentation instrumentation;

    public static final long getObjectSize(final Object p_oToGauge)
    {
        return instrumentation.getObjectSize(p_oToGauge);
    }
} 
```

但是，似乎为了获得一个已实现的`Instrumentation`实例，您需要使用 JRE 代理和所谓的`premain`方法来做各种花哨的事情。

有没有一种简单的方法可以访问本地 JRE 的`Instrumentation`实例？我通过`Runtime`API 寻找了一些东西，但什么也没找到。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2016-08-28T09:16:13.923

我找到了一个名为[`InstrumentationFactory`](http://grepcode.com/file/repo1.maven.org/maven2/org.apache.openjpa/openjpa-all/2.3.0/org/apache/openjpa/enhance/InstrumentationFactory.java).

当有人第一次请求 的实例时`Instrumentation`，它会创建一个代理 JAR 文件，然后找到它自己进程的 PID 并将其附加到其中的 JVM... 调用它的 JVM `agentmain(..)`，给它`Instrumentation`感兴趣的实例。

我不确定这种方法有多可靠。我接下来要尝试的是搜索 OpenJDK 的代码，以查看`Instrumentation`实例的创建位置和方式。也许，在没有安全要求的情况下，有可能（通过反射）让该机制提供`Instrumentation`实例而无需附加或预加载代理？

# sql - 比较值列表

> ID：10692362
> 
> 赞同：1
> 
> 时间：2012-05-21T20:45:14.990
> 
> 标签：sql

例如，我有一个带有一个列 id 的头表和一个带有 id、头 id（对头表 => 1 到 N 的引用）和一个值的位置表。现在我在 head-table 中选择一行，比如 id 1。我查看 position-table 并找到引用 head-table 并具有值 1337 和 1338 的 2 行。现在我想选择所有 head 也2 个位置，这些值分别为 1337 和 1338。位置 ID 不同，只有值不同，因为它不是 M 到 N 关系。谁能告诉我一个 SQL 语句？我不知道完成它：/

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-21T21:15:17.273

假设你有：

```
Create table head
(
    id int
)

Create table pos
(
    id int,
    head_id int,
    value int
) 
```

并且您需要按值查找重复项，然后我会使用：

```
 Select distinct p.head_id, p1.head_id
from pos p
join pos p1 on p.value = p1.value and p.head_id<>p1.head_id
where p.head_id = 1 
```

对于特定的 head_id，或者对于每个 head_id 没有最后一个 where

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-21T20:58:52.467

假设位置表中给定 headid 的值不重复，并且它永远不会为 NULL，那么您可以使用以下逻辑执行此操作。在位置表上对您关心的特定头部位置进行完全外部连接。然后检查是否有完全匹配。

以下查询执行此操作：

```
select *
from (select p.headid,
             sum(case when p.value is not null then 1 else 0 end) as pmatches,
             sum(case when ref.value is not null then 1 else 0 end) as refmatches
      from (select p.value
            from position p
            where p.headid = <whatever>
           ) ref full outer join
           position p
           on p.value = ref.value and
              p.headid <> ref.headid
      ) t
where t.pmatches = t.refmatches 
```

如果值中确实有 NULL，则可以使用合并来适应这些值。如果您有重复，您需要更清楚地指定在这种情况下要做什么。

# javascript - 将 javascript 事件绑定到 MVC 控件

> ID：10692366
> 
> 赞同：0
> 
> 时间：2012-05-21T20:45:33.627
> 
> 标签：javascript, jquery, asp.net-mvc, asp.net-mvc-3, jquery-events

将 Javascript 事件绑定到我的自定义 MVC 控件的最佳方法是什么？我最初的想法是使用 Html Helpers 创建控件，它为它们提供一个 CSS 类，表示它们是什么类型的控件。然后，在 上`document.ready`，我将使用 jQuery 按类名选择所有此类控件并绑定它们的事件。

但是，我担心按类名从整个 dom 中进行选择的速度。我已经阅读（并经历过）这可能有多慢，尤其是在我们需要针对该项目的 IE8 中。

我可以通过为每个页面创建一个 js 文件来按 ID 进行选择，但我不想这样做，因为它是一个包含很多页面的复杂 Web 应用程序。如果视图包含至少一种类型的控件，我宁愿为包含在视图中的每种类型的控件创建一个 js 文件。

CSS 类是我最好的选择吗？还有其他想法吗？我正在使用 MVC3。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-21T20:49:51.797

我的建议是通过课程进行尝试并测试性能。如果您不满意，请切换到 ID。我一直使用类选择器，并且在任何浏览器中都没有发现它们非常慢。当你给 jquery 一个上下文来搜索时，事情会很快。例如：

```
$('#controls .control').whatever(); 
```

或者

```
$('.control', '#controls').whatever(); 
```

Sizzle 非常擅长优化这些东西以提高速度。

**编辑：**这里是 jQuery 性能提示的一个很好的参考（注意 #5）： http: [//net.tutsplus.com/tutorials/javascript-ajax/10-ways-to-instantly-increase-your-jquery-performance /](http://net.tutsplus.com/tutorials/javascript-ajax/10-ways-to-instantly-increase-your-jquery-performance/)

# php - 如何将图像 ID 与 $_FILE 一起发布到 php

> ID：10692372
> 
> 赞同：0
> 
> 时间：2012-05-21T20:45:51.787
> 
> 标签：php, forms, post, image-uploading

index.html 带有表单标签

```
<input type='file' name='picture' id='".$row['sfname']."'onchange='javascript:ajaxFileUpload(this);'/>` 
```

ajax代码

```
function ajaxFileUpload(upload_field)
{
    // Checking file type
    var re_text = /\.jpg|\.gif|\.jpeg/i;
    var filename = upload_field.value;

    if (filename.search(re_text) == -1) {
        alert("File should be either jpg or gif or jpeg");
        upload_field.form.reset();
        return false;
    }
    document.getElementById('picture_preview').innerHTML = '<div><img src="ajax-loader.gif" border="0" /></div>';`
    upload_field.form.action = 'upload-picture.php';
    upload_field.form.target = 'upload_iframe';
    upload_field.form.submit();
    upload_field.form.action = '';
    upload_field.form.target = '';
    return true;
} 
```

上传.php

```
<?php

?> 
```

我希望 index.html 中的 $row['sfname'] 与此处的 $_FILE 变量一起被访问，但是我怎样才能让脚本将图像存储在给定的文件夹中，以便我可以将路径存储在相应的用户记录中。

我已经通过将文件成功上传到文件系统来测试upload.php，现在我希望将文件路径存储在sql表中。为此，我需要相同的用户名，我从相同的

我的问题是；如何使用上面的 ajax 代码访问输入标签 ID 来上传.php？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T21:45:21.537

为什么不简单地将 $row['sfname'] 作为隐藏字段的值，因为您的 JavaScript 正在提交整个表单？

```
<input type='hidden' name='sfname' value='" . $row['sfname'] . "'> 
```

# c# - 在 RichTextBox 中突出显示花费的时间太长

> ID：10692373
> 
> 赞同：6
> 
> 时间：2012-05-21T20:46:01.097
> 
> 标签：c#, winforms, richtextbox, highlighting

我有大量偏移量，需要在我的 RichTextBox 中突出显示。然而这个过程耗时太长。我正在使用以下代码：

```
foreach (int offset in offsets)
{
    richTextBox.Select(offset, searchString.Length);
    richTextBox.SelectionBackColor = Color.Yellow;
} 
```

有没有更有效的方法来做到这一点？

**更新：**

尝试使用此方法，但它没有突出显示任何内容：

```
richTextBox.SelectionBackColor = Color.Yellow;
foreach (int offset in offsets)
{
    richTextBox.Select(offset, searchString.Length);
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-30T21:47:30.513

I've googled your issue and I found that RichTextBox is getting very slow when having many lines.
In my opinion, you have either buy a third part control which you can be satisfied by its performance or you may need threads to devide the whole selection task. I think they can accelerate things up.
Hope it helps !

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-31T17:38:02.750

我以前也遇到过同样的问题。我最终无视了他们给你的所有方法并操纵了底层的 RTF 数据。此外，您的第二个代码块不起作用的原因是 RTF 会应用格式，因此如果您调用函数（或本例中的属性）来更改选择颜色，它只会将其应用于当前选定的块. 在该调用之后对选择所做的任何更改都变得无关紧要。

您可以使用 RGB 值，或者[这里是](http://www.biblioscape.com/rtf15_spec.htm#Heading16)关于如何在 RTF 控件中执行不同操作的一个很好的来源。在你的代码中弹出这个函数，看看它的效果如何。我用它为 SQL 代码提供实时语法高亮。

```
 public void HighlightText(int offset, int length)
    {
        String sText = richTextBox.Text.Trim();
        sText = sText.Insert(offset + length - 1, @" \highlight0");
        sText = sText.Insert(offset, @" \highlight1");
        String s = @"{\rtf1\ansi\deff0{\fonttbl{\f0\fnil\fcharset0 Courier New;}}
            {\colortbl ;\red255\green255\blue0;}\viewkind4\uc1\pard";
        s += sText;
        s += @"\par}";
        richTextBox.Rtf = s;
    } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-29T20:34:50.540

Does it make any difference if you set the SelectionBackColor outside of the loop?

Looking into the RichTextBox with Reflector shows, that a WindowMessage is sent to the control every time when the color is set. In the case of large number of offsets this might lead to highlighting the already highlighted words again and again, leading to O(n^2) behavior.

# php - 确定请求是否来自 Facebook 页面选项卡

> ID：10692381
> 
> 赞同：3
> 
> 时间：2012-05-21T20:46:37.557
> 
> 标签：php, facebook, facebook-php-sdk

如果用户通过 Facebook 页面选项卡访问 foobar.com，我想向他们展示特定数据。

但是，如果用户直接访问 foobar.com，我想展示一些不同的东西。

我一直无法想出一种好的方法来做到这一点。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-21T21:28:41.203

查看发送到 Facebook 选项卡中加载的每个页面的[signed_request 。](http://developers.facebook.com/docs/authentication/signed_request/)

```
if (isset($signed_request['page'])) {
   // I'm in a tab  
} 
```

# jquery - 如何使用 Jquery 对每个匹配元素重复 IF 语句

> ID：10692385
> 
> 赞同：1
> 
> 时间：2012-05-21T20:46:48.880
> 
> 标签：jquery, if-statement, each

我在页面上有许多具有相同 ID 的元素。这里有两个：

```
<span id="worldwide">United Kingdom Australia United States Lithuania Russia Spain France Portugal Italy United Kingdom Australia United States Lithuania Russia Spain France Portugal Italy United Kingdom Australia United States Lithuania Russia Spain France Portugal Italy United Kingdom Australia United States Lithuania Russia Spain France Portugal Italy United Kingdom Australia United States Lithuania Russia Spain France Portugal Italy United Kingdom Australia United States Lithuania Russia Spain France Portugal Italy United Kingdom Australia United States Lithuania Russia Spain France Portugal Italy United Kingdom Australia United States Lithuania Russia Spain France Portugal Italy United Kingdom Australia United States Lithuania Russia Spain France Portugal Italy</span>

<span id="worldwide">United Kingdom Australia United States Lithuania Russia Spain France Portugal Italy United Kingdom Australia United States Lithuania Russia Spain France Portugal Italy United Kingdom Australia United States Lithuania Russia Spain France Portugal Italy United Kingdom Australia United States Lithuania Russia Spain France Portugal Italy United Kingdom Australia United States Lithuania Russia Spain France Portugal Italy United Kingdom Australia United States Lithuania Russia Spain France Portugal Italy United Kingdom Australia United States Lithuania Russia Spain France Portugal Italy United Kingdom Australia United States Lithuania Russia Spain France Portugal Italy United Kingdom Australia United States Lithuania Russia Spain France Portugal Italy</span> 
```

每个元素要么包含所有国家/地区，要么仅包含一个国家/地区。示例中的这两个都与许多国家/地区有关。我希望 jquery 检查每个长度是否超过 100，如果它真的用一个词替换所有国家 - WORLDWIDE。

这就是我使用的：

```
<script>
    $("#worldwide").each(function () {
        if ($("#worldwide").text().length > 100) {
            $("#worldwide").text('WORLDWIDE')
        }
    })
</script> 
```

这仅适用于更改第一个 div，但不会触及第二个。我相信我没有很好地使用 .each 功能请让我知道可能出了什么问题

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-21T20:49:28.227

问题是您拥有具有相同`id`属性的元素，而元素**应该具有唯一`id`的 s**。放置类而不是相等的`id`属性，例如

```
<span class="worldwide">...</span> 
```

并使用此代码：

```
$(".worldwide").each(function() {
    if ($(this).text().length > 100) {
        $(this).text('WORLDWIDE');
    }
}); 
```

**演示：http:** [//jsfiddle.net/aD7HQ/](http://jsfiddle.net/aD7HQ/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-21T20:49:44.297

ID 是唯一的标识符。如果您有一堆想要表现相似的元素，请使用`class`而不是`id`.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-21T20:50:32.670

任何 ID 的实例都不能超过一个，这就是它被称为 ID 的原因。

你最好改用类。

另外，请注意 JQuery 要求在每条语句的末尾使用分号。

```
<span class="worldwide">United Kingdom Australia United States Lithuania Russia Spain France Portugal Italy United Kingdom Australia United States Lithuania Russia Spain France Portugal Italy United Kingdom Australia United States Lithuania Russia Spain France Portugal Italy United Kingdom Australia United States Lithuania Russia Spain France Portugal Italy United Kingdom Australia United States Lithuania Russia Spain France Portugal Italy United Kingdom Australia United States Lithuania Russia Spain France Portugal Italy United Kingdom Australia United States Lithuania Russia Spain France Portugal Italy United Kingdom Australia United States Lithuania Russia Spain France Portugal Italy United Kingdom Australia United States Lithuania Russia Spain France Portugal Italy</span>

<span class="worldwide">United Kingdom Australia United States Lithuania Russia Spain France Portugal Italy United Kingdom Australia United States Lithuania Russia Spain France Portugal Italy United Kingdom Australia United States Lithuania Russia Spain France Portugal Italy United Kingdom Australia United States Lithuania Russia Spain France Portugal Italy United Kingdom Australia United States Lithuania Russia Spain France Portugal Italy United Kingdom Australia United States Lithuania Russia Spain France Portugal Italy United Kingdom Australia United States Lithuania Russia Spain France Portugal Italy United Kingdom Australia United States Lithuania Russia Spain France Portugal Italy United Kingdom Australia United States Lithuania Russia Spain France Portugal Italy</span>

<script>

$(".worldwide").each(function() {

if ($(this).text().length > 100) { $(this).text('WORLDWIDE'); }

});
</script> 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-21T20:56:05.557

我会使用这种`.text()`方法。

```
$(".worldwide").text(function(i,text){
    return text.length > 100 ? 'WORLDWIDE' : text;
}); 
```

此外，明显的 ID 必须是唯一的。如果您不能使您的 id 唯一或使用类来代替，这是一种低效的解决方法。

```
$("[id=worldwide]").text(... 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-05-21T20:54:32.590

您不应使用具有相同 ID 的多个元素。如果在你的情况下是绝对必要的，你可以使用这个：

```
$('span').each(function(index,element){
    if(element.id == 'worldwide'){
        //Do Something
    }
}); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-05-21T20:50:44.513

首先，您不能重复 ID，这违反了 Web 标准，并且浏览器无法分辨出您所引用的全球范围内的内容，只需将它们更改为 class 即可：

```
<span class="worldwide">...</span>
<span class="worldwide">...</span> 
```

每个元素要么包含所有国家/地区，要么仅包含一个国家/地区。示例中的这两个都与许多国家/地区有关。我希望 jquery 检查每个长度是否超过 100，如果它真的用一个词替换所有国家 - 全球。

这就是我使用的：

```
<script>
    $(".worldwide").each(function() {
        if ($(this).text().length > 100) { $(this).text('WORLDWIDE')}
    })
</script> 
```

注意函数内部的**$(this) 。**

# c++ - rand() 真的可以这么糟糕吗？

> ID：10692388
> 
> 赞同：6
> 
> 时间：2012-05-21T20:46:58.147
> 
> 标签：c++, macos, random

![哈哈](../Images/9a3d392ddc1f330514166c97cdfd04dc.png)

上面是通过使用 rand() 获取随机坐标并在这些坐标处的像素值上添加一个常数生成的示例图像。这是几千次迭代后的样子。我在 Mac OS X Lion 中使用 stdlib.h 中的 rand()，将 time(NULL) 作为种子。

您可以清楚地看到垂直线，就好像具有奇数 x 坐标的那些具有比具有偶数 x 坐标的更高的值。

我将如何实现一种更好的算法，或者我在哪里可以找到一个没有很多依赖项的算法？（我更喜欢只有标题的文件）。

这是代码（对不起，我花了这么长时间）：

```
void generate(int iterations = 1) {
 for (unsigned int x = 0;x < (area * 4);++x) {
  map[rand() % area] += 1;
 }
 number a = min();
 number b = max();
 for (int i = 0;i < area;++i) {
  map[i] -= a;
  map[i] /= b;
 }
} 
```

Map 包含双浮点数，后来转换为 RGB 值。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-21T20:51:28.677

C++11 在 random 中提供了非常有用的随机数[功能](http://en.wikipedia.org/wiki/Move_semantics#Extensible_random_number_facility)。有关更多详细信息，请参见[此处](http://en.cppreference.com/w/cpp/numeric/random)和[此处](http://www2.research.att.com/~bs/C++0xFAQ.html#std-random)。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-21T20:49:44.340

你试过[`arc4random()`](https://developer.apple.com/library/mac/#documentation/Darwin/Reference/Manpages/man3/arc4random.3.html)吗？它提供了比 更强大和更统一的随机值`rand()`。

你也可以试试[`SecRandomCopyBytes()`](http://developer.apple.com/library/ios/#DOCUMENTATION/Security/Reference/RandomizationReference/Reference/reference.html)，它是 Security.framework 的一部分。这基本上只是从 /dev/random 读取。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-05-21T20:59:13.527

我认为最重要的是看看你如何使用`rand()`来提取坐标。真正令人惊讶的是，您只能在 x 坐标中看到模式，而在 y 坐标中看不到。如果真的有缺陷，`rand()`它应该出现在两者中。

也就是说，我可以尝试猜测这些模式的来源：`rand()`众所周知，高位比低位产生更多的随机性。因此，永远不应该使用模来提取更小的范围，因为这样只会得到随机性较小的低位部分。

根据这些知识，我猜您正在提取低位以产生 x 值，而高位则用于提取 y 值。这将为您提供沿 y 轴比沿 x 轴更随机的模式。

如果这是您现在正在做的事情，那么您的代码中仍然必须存在一些伪影，这会导致 y 轴上的随机性大于 x 轴上的随机性。所以如果没有看到你的代码，很难判断这个实现是否有缺陷。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-21T20:59:13.057

在 mac 上，您可以只使用随机而不是 rand。手册页`random`注释以下内容：

> **错误**
> 
> 大约是 rand(3) 速度的 2/3。
> 
> 历史上的实现曾经有一个非常弱的种子；随机序列随种子变化不大。当前实现采用更好的伪随机数生成器进行初始状态计算。
> 
> 需要加密质量随机性的应用程序应使用 arc4random(3)。

# c# - Zedgraph - 永久设置轴上的最小值/最大值

> ID：10692389
> 
> 赞同：5
> 
> 时间：2012-05-21T20:47:00.427
> 
> 标签：c#, .net-3.5, zedgraph

我正在研究 Y 轴是百分比值的 zedgraph。我希望最小值和最大值分别为 0/100。我可以通过 GraphPane.YAxis.Scale.Min 和 Max 属性进行设置，并且效果很好。

但是，如果用户通过拖动矩形来改变图形的“视口”，或者放大/缩小，Y 轴最小/最大值会发生变化。有没有办法可以强制 Min/Max 值保持不变，但仍然允许用户缩放/绘制选择框（本质上，允许他们只平移/缩放 x 轴）。

我试过设置 MinAuto / MaxAuto，但这似乎没有效果。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-31T12:25:09.083

我遇到了同样的问题并像这样解决了它：

`zedGraphControl1.IsEnableVZoom = false;`
`zedGraphControl1.IsEnableVPan = false;`

这应该只允许水平缩放。

# objective-c - iOS – 子类化以避免代码重复和协议

> ID：10692391
> 
> 赞同：0
> 
> 时间：2012-05-21T20:47:02.630
> 
> 标签：objective-c, protocols, subclass

我需要我的所有视图控制器能够显示消息撰写视图控制器 ( `MFMessageComposeViewController`) 并处理`MFMessageComposeViewControllerDelegate`方法来查看消息是否已发送/取消/失败。所以我的想法是`UIViewController`在这个视图控制器中对这些方法进行子类化。然后让我所有需要能够发送消息的视图控制器子类化上述视图控制器。

所以喜欢`BaseMessageViewController : UIViewController`

然后`ViewController1 : BaseMessageViewController`，`ViewController2 : BaseMessageViewController`以此类推……

所以当我在做的时候，我想我会创建一个这样的协议：

```
@protocol MessageProcessing

@required

- (void)presentMessageCompose;
- (void)processMessageCancelled;
- (void)processMessageSent;
- (void)processMessageFailed;

@end 
```

但我不确定是否`BaseMessageViewController`应该遵守这个协议，或者我的“具体”视图控制器是否应该遵守它？

一种想法是，如果我`BaseMessageViewController`符合它，那么我的具体视图控制器会因为类继承而自动符合它？但是我在具体的视图控制器中没有看到任何警告，表明它们没有实现所需的方法。

有人可以在这里帮我一把吗:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T20:54:46.010

如果这些是`BaseMessageViewController`发送给自己的消息，则没有理由定义协议。只需在 中声明方法`BaseMessageViewController`，并注释声明以描述它们何时发送。

您还需要提供方法的实现`BaseMessageViewController`以抑制编译器警告。如果您希望每个子类都实现方法，则可以`BaseMessageViewController`使用此模式定义方法：

```
- (void)processMessageCancelled {
    [self doesNotRecognizeSelector:_cmd];
    abort();
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-08-02T03:41:07.203

这是**抽象基类**与**协议**问题的经典示例。

*   当您想定义一个框架时，使用抽象基类（在 Cocoa 中这些称为**类集群），框架封装了一些常见的关注点，而子类处理了一些特定的关注点。**一个例子可以是消息解析框架。

*   使用协议为需要自己的对象层次结构的类定义通用协定。一个示例可能是媒体播放器，其中“播放”和“停止”完全不同，具体取决于媒体类型。

或者，对于介于两者之间的东西，Justin Spahr-summers 在 libextobjc 中定义了“具体协议”。. . [https://github.com/jspahrsummers/libextobjc](https://github.com/jspahrsummers/libextobjc)（类似于 Java 8 中的具体接口）。

# javascript - 如何在不加载调用页面的情况下调用 URL？

> ID：10692396
> 
> 赞同：1
> 
> 时间：2012-05-21T20:47:33.130
> 
> 标签：javascript, url, firefox-addon, xul

> **可能重复：**
> [如何在 Firefox 扩展（javascript 或 XUL）中提取/检索给定 URL 的源代码](https://stackoverflow.com/questions/4965944/how-to-extract-retrieve-source-code-given-url-in-firefox-extention-javascript-o)

在 Firefox 扩展的 JavaScript 代码中，我想使用 URL 将数据作为参数发送，但我不希望替换当前加载的页面。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T12:59:41.353

如果你使用 jQuery，你可以简单地调用：

```
$.post("test.php", { name: "John", time: "2pm" } ); 
```

当然，您需要将 test.php 替换为您调用的 URL，并将 { name: "John", time: "2pm" } 替换为您要发送的数据。

来源：[http ://api.jquery.com/jQuery.post/](http://api.jquery.com/jQuery.post/)

T。

# mysql - 如何让 MySQL 数据库完全在内存中运行？

> ID：10692398
> 
> 赞同：59
> 
> 时间：2012-05-21T20:47:37.570
> 
> 标签：mysql, database

我注意到我的数据库服务器支持内存数据库引擎。我想让一个我已经运行 InnoDB 的数据库完全在内存中运行以提高性能。

我怎么做？我探索了 PHPMyAdmin，但找不到“更改引擎”功能。

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2012-05-21T21:08:18.840

假设您了解评论中提到的使用 MEMORY 引擎的后果，以及[此处](http://dev.mysql.com/doc/refman/5.1/en/memory-storage-engine.html)以及您可以通过搜索找到的其他一些引擎（无事务安全、锁定问题等） - 您可以按照以下步骤进行操作：

MEMORY 表的存储方式与 InnoDB 不同，因此您需要使用导出/导入策略。首先使用`SELECT * FROM tablename INTO OUTFILE 'table_filename'`. 创建 MEMORY 数据库并使用以下语法重新创建您将使用的表：`CREATE TABLE tablename (...) ENGINE = MEMORY;`. 然后，您可以使用`LOAD DATA INFILE 'table_filename' INTO TABLE tablename`每个表导入数据。

* * *

## 回答 #2

> 赞同：26
> 
> 时间：2014-07-30T12:14:55.207

也可以将 MySQL 数据目录放在*tmpfs*中，从而加快数据库写入和读取调用。这可能不是最有效的方法，但有时您不能只更改存储引擎。

这是我的 MySQL 数据目录的 fstab 条目

```
none            /opt/mysql/server-5.6/data  tmpfs   defaults,size=1000M,uid=999,gid=1000,mode=0700          0       0 
```

您可能还想查看*innodb_flush_log_at_trx_commit=2*设置。也许这会充分加速你的 MySQL。

innodb_flush_log_at_trx_commit 更改 mysql 磁盘刷新行为。当设置为 2 时，它只会每秒刷新一次缓冲区。默认情况下，每次插入都会导致刷新，从而导致更多的 IO 负载。

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2012-05-21T21:16:04.767

内存引擎不是您正在寻找的解决方案。您首先丢失了进入数据库的所有内容（即 ACID）。

这里有一些更好的选择：

1.  ~~不要使用连接 - 很少有大型应用程序会这样做（例如 Google、Flickr、NetFlix），因为它很适合大量连接。~~

> LEFT [OUTER] JOIN 可以比等效的子查询更快，因为服务器可能能够更好地优化它——这一事实并非仅适用于 MySQL 服务器。
> 
> - [MySQL 手册](https://dev.mysql.com/doc/refman/5.7/en/rewriting-subqueries.html)

2.  确保您要查询的列具有索引。使用 EXPLAIN 确认它们正在被使用。
3.  使用并增加索引的 Query_Cache 和内存空间，以将它们放入内存并存储频繁的查找。
4.  非规范化您的模式，特别是对于简单的连接（即从 barMap 获取 fooId）。

最后一点是关键。我曾经喜欢联接，但后来不得不在几张 100M+ 行的表上运行联接。不好。最好将您要加入的数据插入该目标表（如果不是太多）并查询索引列，您将在几毫秒内获得查询。

我希望那些帮助。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2012-05-21T21:12:46.047

如果您的数据库足够小（或者如果您添加了足够的内存），您的数据库将有效地在内存中运行，因为您的数据将在第一次请求后被缓存。

更改数据库表定义以使用内存引擎可能比您需要的更复杂。

如果您有足够的内存来使用引擎将表加载到内存中，那么您就有足够的内存`MEMORY`来调整 innodb 设置以缓存所有内容。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2014-03-11T23:13:11.513

> “我该怎么做？我探索了 PHPMyAdmin，但找不到“更改引擎”功能。”

作为对这部分问题的直接回应，您可以发出 an `ALTER TABLE tbl engine=InnoDB;`，它将在适当的引擎中重新创建表。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2013-09-24T23:04:13.820

代替内存存储引擎，可以考虑 MySQL Cluster。据说它提供了类似的性能，但支持磁盘支持的操作以提高耐用性。我没有尝试过，但它看起来很有希望（并且已经开发了很多年）。

[你可以在这里找到官方的 MySQL Cluster 文档。](http://www.mysql.com/products/cluster/ "MySQL 集群 CGE")

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2018-06-16T01:53:10.247

其他想法：

Ramdisk - 设置 MySQL 用作 RAM 磁盘的临时驱动器，非常容易设置。

memcache - memcache 服务器易于设置，使用它来存储 X 时间量的查询结果。

# postgresql - postgis 中的空间要点索引 - 性能

> ID：10692399
> 
> 赞同：1
> 
> 时间：2012-05-21T20:47:47.750
> 
> 标签：postgresql, indexing, gis, postgis, spatial

我对要点索引有疑问。我有表格'国家'和'geog'（地理，多面体）柱状。我也有这个专栏的要点索引。这个使用 ST_CoveredBy() 对 2 行表（每个“geog”大约 5MB）的简单查询需要 13 秒（查询结果是正确的）：

```
select c."ID" from gis.country c where ST_CoveredBy(ST_GeogFromText('SRID=4326;POINT(8.4375 58.5791015625)'), c."geog") =true 
```

当我删除索引时，查询也需要 13 秒。

我已经做过的：

*   真空分析 gis.country ("geog")
*   也许这就是问题所在：“不要以 GEOMETRYCOLLECTION 作为参数调用”我读过（[http://www.mail-archive.com/postgis-users@postgis.refractions.net/msg17780.html](http://www.mail-archive.com/postgis-users@postgis.refractions.net/msg17780.html)），这是因为重叠的多边形，但在国家地图中不存在重叠的多边形

**编辑**

查询计划——

```
Index Scan using sindx_country_geography_col1 on country c  (cost=0.00..8.52 rows=1 width=4)
  Index Cond: ('0101000020E61000000000000000E0204000000000204A4D40'::geography && "geog")
  Filter: _st_covers("geog", '0101000020E61000000000000000E0204000000000204A4D40'::geography) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-21T23:11:49.983

您不会看到索引查询对只有两行的表的任何好处。只有当您有数百或更多行要查询时，索引的好处才会发挥作用。

我猜你有两个非常详细的国家多面体。有一些策略可以将它们划分为网格以提高性能。如何将您的国家划分为网格应基于 (1) 您感兴趣的区域的密度（您最有可能查询的区域），以及 (2) 多面体复杂性或顶点密度。

# java - Log4JLogger'找不到或不可用的根本原因是什么？

> ID：10692402
> 
> 赞同：11
> 
> 时间：2012-05-21T20:48:07.917
> 
> 标签：java, log4j, apache-commons-logging

我在类路径中有 commons-logging.jar (v1.0.4) 和 log4j-1.2.8.jar 并得到以下运行时错误：

```
Caused by: org.apache.commons.logging.LogConfigurationException: User-specified log class 'org.apache.commons.logging.impl.Log4JLogger' cannot be found or is not useable.
    at org.apache.commons.logging.impl.LogFactoryImpl.discoverLogImplementation(LogFactoryImpl.java:874)
    at org.apache.commons.logging.impl.LogFactoryImpl.newInstance(LogFactoryImpl.java:604)
    at org.apache.commons.logging.impl.LogFactoryImpl.getInstance(LogFactoryImpl.java:336)
    at org.apache.commons.logging.impl.LogFactoryImpl.getInstance(LogFactoryImpl.java:310)
    at org.apache.commons.logging.LogFactory.getLog(LogFactory.java:685) 
```

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2014-06-07T08:56:40.090

如果你使用 Maven，你必须确保在 pom.xml 中声明 commons-logging 和 log4j

```
<dependencies>
    <dependency>
        <groupId>commons-logging</groupId>
        <artifactId>commons-logging</artifactId>
        <version>1.1.3</version>
    </dependency>
    <dependency>
        <groupId>log4j</groupId>
        <artifactId>log4j</artifactId>
        <version>1.2.17</version>
    </dependency>
</dependencies> 
```

如果您仅声明 commons-logging 你得到错误`Log4JLogger cannot be found or is not useable`

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-12-11T20:53:47.943

这是一个类路径问题，我们在类路径中确实有另一个版本的 log4j。谢谢内森瑞恩！

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2014-12-11T00:25:08.807

将 log4j-2.x 与 commons-logging-1.2 一起使用时遇到了这个问题。恢复到 log4j 1.2.x，一切都很好。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-04-03T07:00:51.877

当我尝试在 eclipse 3.6 中的 tomcat 7 上运行 Web 应用程序时，有时会看到此错误。只需重新启动 Eclipse，它就会突然出现。

在服务器上多次（！）“清理所有项目”和 Web 应用程序的新部署之后，应用程序再次运行。也许其他人知道确切的“咒语”来解开这个谜团而无需反复试验？

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2018-07-12T15:55:07.267

这里有一个答案 [Commons-logging with log4j2](https://stackoverflow.com/questions/41462181/commons-logging-with-log4j2)

包括库：
`log4j-jcl`
另见：
[https ://logging.apache.org/log4j/2.x/faq.html#which_jars](https://logging.apache.org/log4j/2.x/faq.html#which_jars)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-05-22T07:56:52.553

如果您要为记录器提供实现，则该实现必须定义一个以 java.lang.String 作为参数的构造函数。否则你会得到一个“org.apache.commons.logging.LogConfigurationException：用户指定的日志类'...'找不到或不可用。” apache wiki的[常见问题页面说明了这一点。](http://wiki.apache.org/commons/Logging/FrequentlyAskedQuestions)

您是否正在创建任何特定项目，例如 Web 服务或 Spring 等？如果是，那么请分析项目特定的属性文件，该文件将具有参考记录器的属性，例如

`<property name="logger">javax.servlet,org.apache.commons.logging</property>`

如果您有一个带有 servlet 的 java 项目。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2013-03-08T18:27:38.640

我收到了同样的例外。

我确实有记录器的实现。

它没有将 String 作为参数的构造函数。

我实现了这样一个构造函数，它为我解决了这个问题。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2013-10-18T08:41:12.970

当我的类路径中有 apache commons logging jar 但 log4j jar 不知何故丢失时，我收到了这个错误。一旦我将 log4j jar 添加到我的类路径中，这个错误就消失了。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2018-12-04T17:29:43.647

这个错误似乎很笼统。要获取更多详细信息，请使用以下选项启动 JVM：

```
-Dorg.apache.commons.logging.diagnostics.dest=STDOUT 
```

就我而言，发现了一些缺少的依赖项。

```
[LogFactoryImpl@929338653 from sun.misc.Launcher$AppClassLoader@1442407170] Attempting to instantiate 'org.apache.commons.logging.impl.Log4JLogger'
[LogFactoryImpl@929338653 from sun.misc.Launcher$AppClassLoader@1442407170] Trying to load 'org.apache.commons.logging.impl.Log4JLogger' from classloader sun.misc.Launcher$AppClassLoader@1442407170
[LogFactoryImpl@929338653 from sun.misc.Launcher$AppClassLoader@1442407170] Class 'org.apache.commons.logging.impl.Log4JLogger' was found at 'jar:file:/home/mcadiz/NetBeansProjects/LogFilter/dist/lib/commons-logging-1.2.jar!/org/apache/commons/logging/impl/Log4JLogger.class'
[LogFactoryImpl@929338653 from sun.misc.Launcher$AppClassLoader@1442407170] The log adapter 'org.apache.commons.logging.impl.Log4JLogger' is missing dependencies when loaded via classloader sun.misc.Launcher$AppClassLoader@1442407170: org/apache/log4j/Priority
Exception in thread "main" java.lang.ExceptionInInitializerError
Caused by: org.apache.commons.logging.LogConfigurationException: User-specified log class 'org.apache.commons.logging.impl.Log4JLogger' cannot be found or is not useable.
    at org.apache.commons.logging.impl.LogFactoryImpl.discoverLogImplementation(LogFactoryImpl.java:804)
    at org.apache.commons.logging.impl.LogFactoryImpl.newInstance(LogFactoryImpl.java:541)
    at org.apache.commons.logging.impl.LogFactoryImpl.getInstance(LogFactoryImpl.java:292)
    at org.apache.commons.logging.impl.LogFactoryImpl.getInstance(LogFactoryImpl.java:269)
    at org.apache.commons.logging.LogFactory.getLog(LogFactory.java:655)
    at com.oracle.logfilter.LogEntry.<clinit>(LogEntry.java:19) 
```

将 log4j.jar 添加到类路径解决了这个问题。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2019-04-18T11:27:00.543

我遇到了这个问题，发现这是由于与 log4j jar 相关的类路径冲突。当我在我的项目中使用 maven 时，解决方法是为 log4j 添加一个依赖管理，如下所示。

```
<dependencyManagement>
    <dependencies>
        <dependency>
            <groupId>log4j</groupId>
            <artifactId>log4j</artifactId>
            <version>1.2.17</version>
            <type>jar</type>
            <scope>compile</scope>
        </dependency>
    </dependencies>
</dependencyManagement> 
```

# asp.net - ajax调用后Jquery不执行

> ID：10692403
> 
> 赞同：-1
> 
> 时间：2012-05-21T20:48:12.097
> 
> 标签：asp.net, jquery

我有一个 asp 下拉列表，它是由 ajax 生成的，现在我的问题是，我有一个 jquery，现在基本上这个 jquery 用于将下拉效果应用于任何选择元素，现在这样做是，一旦选择元素有一些选项，它隐藏那些选项并复制那些里面`ul`和`li`格式，现在发生了什么，在我的ajax调用之前，这个jquery被执行，并且因为它在select元素中没有找到任何东西，它不会创建`ul`和`li`，因此我总是变得空白列表，我尝试在 DropDownList 中放置静态项目，它可以工作，但是使用 jquery 它不起作用，我还尝试将整个 jquery 代码（为下拉列表添加幻灯片效果的 Jquery）放置在 ajax 调用函数下方的 document.ready 中，但是这也不起作用，下面是我的 ajax 函数：

```
 function GetRegion() {
                $("select[id$=ddlRegion] > option").remove();
                $.ajax({
                    type: "POST",
                    url: "InteractiveMap.asmx/GetRegions",
                    data: "{}",
                    contentType: "application/json; charset=utf-8",
                    dataType: "json",
                    async: true,
                    success: function (data) {
                        var Items = data.d;
                        ddlRegion.attr("disabled", false);
                        ddlCountry.append('<option value="-1">--Select Region--</option>');
                        $.each(Items, function (index, Item) {
                            ddlRegion.append('<option value="' + Item.RID + '">' + Item.Text + '</option>');
                        });
                        ddlRegion.val(RegionQueryString);
                    },
                    failure: function (msg) {
                        ShowErrorMessage(msg);
                    }
                });
            } 
```

下面是我的jquery，它正在添加幻灯片效果，对不起，但它很大：

```
 (function ($) {
        $.fn.jNice = function (options) {
            var self = this;
            var safari = $.browser.safari; /* We need to check for safari to fix the input:text problem */
            /* Apply document listener */
            $(document).mousedown(checkExternalClick);
            /* each form */
            return this.each(function () {
                $('input:submit, input:reset, input:button', this).each(ButtonAdd);
                $('button').focus(function () { $(this).addClass('jNiceFocus') }).blur(function () { $(this).removeClass('jNiceFocus') });
                $('input:text:visible, input:password', this).each(TextAdd);
                /* If this is safari we need to add an extra class */
                if (safari) { $('.jNiceInputWrapper').each(function () { $(this).addClass('jNiceSafari').find('input').css('width', $(this).width() + 11); }); }
                $('input:checkbox', this).each(CheckAdd);
                $('input:radio', this).each(RadioAdd);
                $('select', this).each(function (index) {
                    //$(this).attr('size')
                    if ($(this).attr('multiple')) {
                        MultipleSelectAdd(this, index);
                    }
                    else
                        SelectAdd(this, index);
                });
                /* Add a new handler for the reset action */
                $(this).bind('reset', function () { var action = function () { Reset(this); }; window.setTimeout(action, 10); });
                $('.jNiceHidden').css({ opacity: 0 });
            });
        }; /* End the Plugin */

        var Reset = function (form) {

            var sel;
            $('.jNiceWrapper select', form).each(function () { sel = (this.selectedIndex < 0) ? 0 : this.selectedIndex; $('.jNiceSelectWrapper ul', $(this).parent()).each(function () { $('a:eq(0)', this).click(); }); });
            $('.jNiceWrapper select', form).each(function () {
                sel = (this.selectedIndex < 0) ? 0 : this.selectedIndex; $('.jNiceMultipleSelectWrapper ul li', $(this).parent()).each(function () {
                    if ($('a:first', this).hasClass('selected'))
                        $('a:first', this).click();

                });
            });
            $('a.jNiceCheckbox, a.jNiceRadio', form).removeClass('jNiceChecked');
            $('input:checkbox, input:radio', form).each(function () { if (this.checked) { $('a', $(this).parent()).addClass('jNiceChecked'); } });
        };

        var RadioAdd = function () {
            var $input = $(this).addClass('jNiceHidden').wrap('<span class="jRadioWrapper jNiceWrapper"></span>');
            var $wrapper = $input.parent();
            var $a = $('<span class="jNiceRadio"></span>');
            $wrapper.prepend($a);
            /* Click Handler */
            $a.click(function () {
                var $input = $(this).addClass('jNiceChecked').siblings('input').attr('checked', true);
                /* uncheck all others of same name */
                $('input:radio[name="' + $input.attr('name') + '"]').not($input).each(function () {
                    $(this).attr('checked', false).siblings('.jNiceRadio').removeClass('jNiceChecked');
                });
                return false;
            });
            $input.click(function () {
                if (this.checked) {
                    var $input = $(this).siblings('.jNiceRadio').addClass('jNiceChecked').end();
                    /* uncheck all others of same name */
                    $('input:radio[name="' + $input.attr('name') + '"]').not($input).each(function () {
                        $(this).attr('checked', false).siblings('.jNiceRadio').removeClass('jNiceChecked');
                    });
                }
            }).focus(function () { $a.addClass('jNiceFocus'); }).blur(function () { $a.removeClass('jNiceFocus'); });

            /* set the default state */
            if (this.checked) { $a.addClass('jNiceChecked'); }
        };

        var CheckAdd = function () {
            var $input = $(this).addClass('jNiceHidden').wrap('<span class="jNiceWrapper"></span>');
            var $wrapper = $input.parent().append('<span class="jNiceCheckbox"></span>');
            /* Click Handler */
            var $a = $wrapper.find('.jNiceCheckbox').click(function () {
                var $a = $(this);
                var input = $a.siblings('input')[0];
                if (input.checked === true) {
                    input.checked = false;
                    $a.removeClass('jNiceChecked');
                }
                else {
                    input.checked = true;
                    $a.addClass('jNiceChecked');
                }
                return false;
            });
            $input.click(function () {
                if (this.checked) { $a.addClass('jNiceChecked'); }
                else { $a.removeClass('jNiceChecked'); }
            }).focus(function () { $a.addClass('jNiceFocus'); }).blur(function () { $a.removeClass('jNiceFocus'); });

            /* set the default state */
            if (this.checked) { $('.jNiceCheckbox', $wrapper).addClass('jNiceChecked'); }
        };

        var TextAdd = function () {
            var $input = $(this).addClass('jNiceInput').wrap('<div class="jNiceInputWrapper"><div class="jNiceInputInner"></div></div>');
            var $wrapper = $input.parents('.jNiceInputWrapper');
            $input.focus(function () {
                $wrapper.addClass('jNiceInputWrapper_hover');
            }).blur(function () {
                $wrapper.removeClass('jNiceInputWrapper_hover');
            });
        };

        var ButtonAdd = function () {
            var value = $(this).attr('value');
            $(this).replaceWith('<button id="' + this.id + '" name="' + this.name + '" type="' + this.type + '" class="' + this.className + '" value="' + value + '"><span><span>' + value + '</span></span>');
        };

        /* Hide all open selects */
        var SelectHide = function () {
            $('.jNiceSelectWrapper ul:visible').hide();
        };

        /* Check for an external click */
        var checkExternalClick = function (event) {
            if ($(event.target).parents('.jNiceSelectWrapper').length === 0) { SelectHide(); }
        };

        var SelectAdd = function (element, index) {
            var $select = $(element);
            index = index || $select.css('zIndex') * 1;
            index = (index) ? index : 0;
            /* First thing we do is Wrap it */
            $select.wrap($('<div class="jNiceWrapper"></div>').css({ zIndex: 100 - index }));
            var width = $select.width();
            $select.addClass('jNiceHidden').after('<div class="jNiceSelectWrapper"><div><span class="jNiceSelectText"></span><span class="jNiceSelectOpen"></span></div><ul></ul></div>');
            var $wrapper = $(element).siblings('.jNiceSelectWrapper').css({ width: width + 'px' });
            $('.jNiceSelectText, .jNiceSelectWrapper ul', $wrapper).width(width - $('.jNiceSelectOpen', $wrapper).width());
            /* IF IE 6 */
            if ($.browser.msie && jQuery.browser.version < 7) {
                $select.after($('<iframe src="javascript:\'\';" marginwidth="0" marginheight="0" align="bottom" scrolling="no" tabIndex="-1" frameborder="0"></iframe>').css({ height: $select.height() + 4 + 'px' }));
            }
            /* Now we add the options */
            SelectUpdate(element);
            /* Apply the click handler to the Open */
            $('div', $wrapper).click(function () {
                var $ul = $(this).siblings('ul');
                if ($ul.css('display') == 'none') { SelectHide(); } /* Check if box is already open to still allow toggle, but close all other selects */
                $ul.slideToggle('fast');
                var offSet = ($('a.selected', $ul).offset().top - $ul.offset().top);
                $ul.animate({ scrollTop: offSet });
                return false;
            });
            /* Add the key listener */
            $select.keydown(function (e) {
                var selectedIndex = this.selectedIndex;
                switch (e.keyCode) {
                    case 40: /* Down */
                        if (selectedIndex < this.options.length - 1) { selectedIndex += 1; }
                        break;
                    case 38: /* Up */
                        if (selectedIndex > 0) { selectedIndex -= 1; }
                        break;
                    default:
                        return;
                        break;
                }
                $('ul a', $wrapper).removeClass('selected').eq(selectedIndex).addClass('selected');
                $('span:eq(0)', $wrapper).html($('option:eq(' + selectedIndex + ')', $select).attr('selected', 'selected').text());
                return false;
            }).focus(function () { $wrapper.addClass('jNiceFocus'); }).blur(function () { $wrapper.removeClass('jNiceFocus'); });
        };

        var MultipleSelectAdd = function (element, index) {
            var $select = $(element);
            var size = parseInt($select.attr('size'));
            index = index || $select.css('zIndex') * 1;
            index = (index) ? index : 0;
            /* First thing we do is Wrap it */
            $select.wrap($('<div class="jNiceWrapper"></div>').css({ zIndex: 100 - index }));
            var width = $select.width();
            $select.addClass('jNiceHidden').after('<div class="jNiceMultipleSelectWrapper"><div><span class="jNiceSelectText"></span><span class="jNiceSelectOpen"></span></div><ul></ul></div>');
            var $wrapper = $(element).siblings('.jNiceMultipleSelectWrapper').css({ width: width + 'px' });
            $('.jNiceSelectText, .jNiceMultipleSelectWrapper ul', $wrapper).width(width - $('.jNiceSelectOpen', $wrapper).width());

            //$('.jNiceMultipleSelectWrapper ul').height(($select.height()+4) +'px');
            //$('.jNiceMultipleSelectWrapper ul').css({'overflow-x':'hidden','overflow-y':'auto'});

            /* IF IE 6 */
            if ($.browser.msie && jQuery.browser.version < 7) {
                $select.after($('<iframe src="javascript:\'\';" marginwidth="0" marginheight="0" align="bottom" scrolling="no" tabIndex="-1" frameborder="0"></iframe>').css({ height: $select.height() + 4 + 'px' }));
            }
            /* Now we add the options */

            MultipleSelectUpdate(element);
            /* Add the key listener */
            $select.keydown(function (e) {
                var selectedIndex = this.selectedIndex;
                switch (e.keyCode) {
                    case 40: /* Down */
                        if (selectedIndex < this.options.length - 1) { selectedIndex += 1; }
                        break;
                    case 38: /* Up */
                        if (selectedIndex > 0) { selectedIndex -= 1; }
                        break;
                    default:
                        return;
                        break;
                }
                $('ul a', $wrapper).removeClass('selected').eq(selectedIndex).addClass('selected');
                $('span:eq(0)', $wrapper).html($('option:eq(' + selectedIndex + ')', $select).attr('selected', 'selected').text());
                return false;
            }).focus(function () { $wrapper.addClass('jNiceFocus'); }).blur(function () { $wrapper.removeClass('jNiceFocus'); });
        };

        var MultipleSelectUpdate = function (element) {
            var $select = $(element);
            var $wrapper = $select.siblings('.jNiceMultipleSelectWrapper');
            var $ul = $wrapper.find('ul').find('li').remove().end().show();

            $('option', $select).each(function (i) {

                if ($('option:eq(' + i + ')', $select).attr('selected'))
                    $ul.append('<li><a href="#" index="' + i + '" class="selected">' + this.text + '</a></li>');
                else
                    $ul.append('<li><a href="#" index="' + i + '">' + this.text + '</a></li>');
            });
            /* Add click handler to the a */

            $ul.find('a').click(function () {

                //$('a.selected', $wrapper).removeClass('selected');
                if ($(this).hasClass('selected')) {
                    $(this).removeClass('selected');
                }
                else
                    $(this).addClass('selected');
                /* Fire the onchange event */
                //if ($select[0].selectedIndex != $(this).attr('index') && $select[0].onchange) { $select[0].selectedIndex = $(this).attr('index'); $select[0].onchange(); }
                //$select[0].selectedIndex = $(this).attr('index');

                /// we make the select in the input also true
                $('option:eq(' + $(this).attr('index') + ')', $select).attr('selected', true);

                if ($(this).attr('index') == 0)
                    $('span:eq(0)', $wrapper).html($(this).html());
                return false;
            });
            /* Set the defalut */
            $('a:eq(0)', $ul).click();
        };

        var SelectUpdate = function (element) {
            var $select = $(element);
            var $wrapper = $select.siblings('.jNiceSelectWrapper');
            var $ul = $wrapper.find('ul').find('li').remove().end().hide();
            $('option', $select).each(function (i) {
                $ul.append('<li><a href="#" index="' + i + '">' + this.text + '</a></li>');
            });
            /* Add click handler to the a */
            $ul.find('a').click(function () {
                $('a.selected', $wrapper).removeClass('selected');
                $(this).addClass('selected');
                /* Fire the onchange event */
                //if ($select[0].selectedIndex != $(this).attr('index') && $select[0].onchange) { $select[0].selectedIndex = $(this).attr('index'); $select[0].onchange(); }
                if ($select[0].selectedIndex != $(this).attr('index')) {
                    $select.trigger('change');
                }
                $select[0].selectedIndex = $(this).attr('index');
                $('span:eq(0)', $wrapper).html($(this).html());
                $ul.hide();
                return false;
            });
            /* Set the defalut */
            $('a:eq(' + $select[0].selectedIndex + ')', $ul).click();
        };

        var SelectRemove = function (element) {
            var zIndex = $(element).siblings('.jNiceSelectWrapper').css('zIndex');
            $(element).css({ zIndex: zIndex }).removeClass('jNiceHidden');
            $(element).siblings('.jNiceSelectWrapper').remove();
        };

        /* Utilities */
        $.jNice = {
            SelectAdd: function (element, index) { SelectAdd(element, index); },
            MultipleSelectAdd: function (element, index) { MultipleSelectAdd(element, index); },
            MultipleSelectUpdate: function (element) { MultipleSelectUpdate(element); },
            SelectRemove: function (element) { SelectRemove(element); },
            SelectUpdate: function (element) { SelectUpdate(element); },
            Reset: function (element) { Reset(element); }
        }; /* End Utilities */

        /* Automatically apply to any forms with class jNice */
        $(function () { $('.content').jNice(); });
    })(jQuery); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T20:50:03.293

你不需要`$.parseJSON(response);`成功。jQuery 提前解析它并将*对象*（不是 JSON 字符串）传递给成功函数。所以`response`包含对象。

在此处查看“json”的“dataType”部分：http: [//api.jquery.com/jQuery.ajax/](http://api.jquery.com/jQuery.ajax/)

# jsf-2 - javax.faces.INTERPRET_EMPTY_STRING_SUBMITTED_VALUES_AS_NULL 设置为 TRUE 时的必填字段问题

> ID：10692404
> 
> 赞同：6
> 
> 时间：2012-05-21T20:48:15.153
> 
> 标签：jsf-2

在 MyFaces 和 Mojarra 2.1 中，都存在一个缺陷，即 when`javax.faces.INTERPRET_EMPTY_STRING_SUBMITTED_VALUES_AS_NULL`设置为`true`时，在模型中标记为必填和预填充的任何字段，在空白和提交时都会重新显示其原始未空白值而不是留空。

场景是：

1.  用户加载带有单个必填字段的页面，该字段填充了模型中的现有数据
2.  用户清除页面上的字段并提交表单
3.  验证按预期失败，并且向用户显示一条错误消息，提示他们必须填写必填字段。

问题是该字段应该显示用户提交的内容（即他们为该字段提交了一个空白值），而是使用模型中的原始值填充。唯一的解决方法是设置`javax.faces.INTERPRET_EMPTY_STRING_SUBMITTED_VALUES_AS_NULL`为`false`. 设置为`false`提供所需的行为，即当重新显示页面并显示必填字段错误消息时，该字段保持空白。

使用 Mojarra (http://java.net/jira/browse/JAVASERVERFACES-2375) 和 MyFaces (https://issues.apache.org/jira/browse/MYFACES-3525) 记录了一个缺陷，但没有取得任何进展在 6 周内。

> 请注意，Mojarra 似乎在 6 个月前报告了类似的问题，但尚未取得任何进展。

有谁知道一个解决方法，我们可以保持`javax.faces.INTERPRET_EMPTY_STRING_SUBMITTED_VALUES_AS_NULL`设置为 true 而不是 false，但不会遇到这个必填字段可用性问题？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-21T21:29:29.907

这个问题在[JSF 2 - Bean Validation 中有详细解释：验证失败 -> 空值被替换为托管 bean 的最后一个有效值](https://stackoverflow.com/questions/3933786/jsf-2-bean-validation-validation-failed-empty-values-are-replaced-with-las)。到目前为止，在 Mojarra 中，它是由错误或至少是疏忽引起的，`HtmlBasicRenderer#getCurrentValue()`并且已报告为[issue 2266](https://github.com/javaserverfaces/mojarra/issues/2266)。

同时，解决此问题的最简单方法，同时考虑到具有自己的渲染器（如 PrimeFaces）的 3rd 方组件库，是将源文件`UIInput`直接复制到项目的源文件夹中，然后进行`getSubmittedValue()`相应的编辑：

```
public Object getSubmittedValue() {
    if (submittedValue == null && !isValid() && considerEmptyStringNull(FacesContext.getCurrentInstance())) {
        return "";
    }
    else {
        return submittedValue;
    }
} 
```

它将最终进入`/WEB-INF/classes`，这将在类加载中优先于 JSF JAR 文件中的类加载。诚然，这有点笨拙，但它比重建 JSF JAR 文件或覆盖每个输入渲染器要少痛苦。

# javascript - 骨干.js IE8 appendChild() 错误

> ID：10692405
> 
> 赞同：0
> 
> 时间：2012-05-21T20:48:15.513
> 
> 标签：javascript, jquery, internet-explorer, backbone.js, cross-browser

典型的“适用于 Chrome/FF 但不适用于 IE”的故事。IE9 似乎处理得很好。

IE 控制台中出现的唯一内容是：
*SCRIPT65535: Unexpected call to method or property access。*
*jquery.min.js，第 3 行字符 32461*

这是 IE Profiler 跟踪错误的[屏幕截图](http://draconianbuilder.com/images/IE_dies_on_render_call.png)。

这是我的 Nav.js 文件中的代码：

```
 // Build nav menu array
    var navLinks =  [ {"style" : "home"         ,"page" : ""                    ,"name" : "Home"                ,"tier" : 1     ,"icon" : "home"}, 
              {"style" : "job-trans"    ,"page" : "view/jobTransaction" ,"name" : "Job Transactions"    ,"tier" : 1     ,"icon" : "barcode"},
              {"style" : "job"          ,"page" : "view/job"            ,"name" : "Jobs"                ,"tier" : 1     ,"icon" : "inbox"},
              {"style" : "user"         ,"page" : "view/user"           ,"name" : "Users"               ,"tier" : 1     ,"icon" : "user"},
              {"style" : "report"       ,"page" : "page/report"         ,"name" : "Reports"             ,"tier" : 2},// ,"icon" : "signal"},
              {"style" : "customer"     ,"page" : "view/customer"       ,"name" : "Customers"           ,"tier" : 2}
            ];

    var jobSearchAttr = $.browser.msie ? "value=\"Enter Job #\" data-browser=\"IE\" style=\"font-size: 16px\"" : "placeholder=\"Enter Job #\"";
    var userSearchAttr = $.browser.msie ? "value=\"Enter User ID\" data-browser=\"IE\" style=\"font-size: 16px; padding-left:0;\"" : "placeholder=\"Enter User ID\"";

    // Sort array elements into buttons and dropdowns with appropriate elements
    var i, t1LinkArray = [], t2LinkArray = [], t2ClassArray = [];
    for (var i = 0; i < navLinks.length; i++) {
        switch(navLinks[i]["tier"]) {
            case 1:
                t1LinkArray.push( "<li class=\"" + navLinks[i]['style'] + "\"><a href=\"#/" + navLinks[i]['page'] + "\"><i class=\"icon-" + navLinks[i]['icon'] + " icon-white\"></i> " + navLinks[i]['name'] + "</a></li>" );
                break;
            case 3:
                t2LinkArray.push( "<li class=\"" + navLinks[i]['style'] + "\"><a href=\"#/" + navLinks[i]['page'] + "\">" + navLinks[i]['name'] + "</a></li>" );
                t2ClassArray.push( navLinks[i]['style'] );
                break;
        }
    }

    // Create Navbar View
    NavView = Backbone.View.extend({
        // Define View template
        template: _.template( $('#navbarTemplate').html() ),

        initialize: function () {
            this.render();
        },

        render: function () {
            // Call the template and pass data object
            this.$el.html( this.template({ t1LinkArray : t1LinkArray, t2LinkArray : t2LinkArray, t2ClassArray : t2ClassArray }) );
        },

    });
    var nav = new NavView({ el:$('nav') }); 
```

不知道为什么这只在 IE 7/8 中崩溃。

**编辑**:: 这是模板，目前嵌入在正文下方。

```
 <div class="navbar navbar-fixed-top" style="clear: both;">
          <div class="navbar-inner">
            <div id="navbar" class="container-fluid">

              <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </a>

              <p class="navbar-text pull-right"><a class="brand" href="/workflow3"><em>Brand</em></a></p>

              <div class="nav-collapse pull-left">
                <ul class="nav">
                  <!-- List Tier 1 pages -->
                  {{ t1LinkArray.join("\n") }}

                  <!-- Style dropdown with each child's page class -->
                  <li class="dropdown {{ t2ClassArray.join(" ") }}"> 

                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">More<b class="caret"></b>
                    </a>
                    <ul class="dropdown-menu">
                      <!--  List Tier 2 pages -->
                      {{ t2LinkArray.join("\n") }}
                    </ul>
                  </li>
                </ul>

              </div> <!-- /.nav-collapse -->
            </div> <!-- /.container-fluid -->
          </div> <!-- /.navbar-inner -->
        </div> <!-- /.navbar --> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-21T16:30:04.620

老问题，但我今天遇到了这个错误，这是最好的结果，所以我猜仍然相关。

您在标记中使用了 html5 数据属性 - 大概您的文档是 html5？如果你使用了 IE8 不支持的任何新标签（没有添加一些描述的填充），jQuery 会产生这个错误。在页面顶部尝试此操作。

```
<!--[if IE]><script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]--> 
```

除此之外，它显然倾向于出现格式错误的 html - 例如。如果您忘记关闭标签或错过属性中的右引号。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-22T23:15:36.623

我今天刚刚帮助同事解决了 IE8 中的这个问题。我们发现他试图附加到一个不能有子元素的元素（在他的例子中是一个 IMG 标签）。

我注意到 jQuery 选择器`new NavView({ el:$('nav') });`应该是**.nav**没有`nav`标签（至少在您的代码示例中），因此它试图将节点添加到不存在的元素。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-05T16:14:12.393

最终，我仍然没有找到解决手头实际问题的方法。从技术上讲，这甚至不算是一种解决方法，但它确实创造了一个工作环境！

[http://www.chromium.org/developers/how-tos/chrome-frame-getting-started](http://www.chromium.org/developers/how-tos/chrome-frame-getting-started)

优势明显，再也不用迎合IE的特质了。

我讨厌不知道是什么原因造成的，所以请其他人随时回答。

# java - 如何获得空白的 jtextfield？

> ID：10692406
> 
> 赞同：0
> 
> 时间：2012-05-21T20:48:21.377
> 
> 标签：java, algorithm, swing

我正在构建一个计算器（气体定律计算器），它有四个文本字段，我需要三个字段用数字填充来计算第四个值。方程是 v1/p1 = v2/p2。但问题是我不知道用户将填写哪三个值。所以我需要找到一种算法来检查每个文本字段并确定哪个是空的。我正在使用摇摆班。只是给我方向。

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-21T20:52:06.850

*   [文档监听器](http://docs.oracle.com/javase/tutorial/uiswing/events/documentlistener.html)

*   尽量避免[KeyListener](http://docs.oracle.com/javase/tutorial/uiswing/events/keylistener.html)

*   可能的方式也可能是[FocusListener](http://docs.oracle.com/javase/tutorial/uiswing/events/focuslistener.html)，注意[Focus](http://docs.oracle.com/javase/tutorial/uiswing/misc/focus.html)是异步的

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-21T20:53:34.353

那么，您期望“空”字段的值是多少？

当然，它将是空字符串，`""`.

因此，只需测试哪些字段`equal`包含空字符串（或长度为 0）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-22T11:11:40.383

这个怎么样？

```
private boolean validateField(JComponent component)
{
if (component.getText().trim().length() == 0){
   return false;
}
else{
   return true;
}
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-06-10T09:55:10.743

如果要检查 JTextField 是否为**空**，只需按如下方式进行：

**示例（须藤代码）：**

-> JTextField 字段 = 新 JTextField("v1:");

-> if(field.getText().isEmpty == true){...} else{...}

# magento - 检索没有产品的默认产品图像 - Magento

> ID：10692408
> 
> 赞同：0
> 
> 时间：2012-05-21T20:48:24.950
> 
> 标签：magento

我想检索 Magento 中的默认产品缩略图，以将其应用于产品以外的其他东西，因此我无权访问 $product。这有没有可能？

谢谢， Krt_Malta

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-21T22:02:54.883

未经测试，但这应该有效：

```
/**
 * Get the resource model
 */
$resource = Mage::getSingleton('core/resource');

/**
 * Retrieve the read connection
 */
$readConnection = $resource->getConnection('core_read');

$query = 'SELECT thumbnail FROM ' . $resource->getTableName('catalog/product_flat') . ' WHERE sku = "(insert your product SKU here)"'; // Insert SKU here

/**
 * Execute the query and store the results in $results
 */
$results = $readConnection->fetchAll($query);

/**
 * Print out the results
 */
echo sprintf('<pre>%s</pre>' print_r($results, true)); 
```

# spring - Primefaces fileUpload 不起作用，FileUploadFilter 调用了两次

> ID：10692409
> 
> 赞同：2
> 
> 时间：2012-05-21T20:48:30.023
> 
> 标签：spring, file-upload, jsf-2, primefaces, prettyfaces

我正在使用 Spring 3.1.0.RELEASE、JSF 2.x、JPA 2 和 Hibernate Provider 做一个 Web 应用程序。该应用程序在 Tomcat 6.35 上运行。

我将 PrettyFaces 3.3.2 用于友好的 URL 和 Spring security 3.1.0.RELEASE。

我使用 Primefaces 3.1，并尝试使用 Primefaces 的文件上传组件。可悲的是它不起作用。

我的 pom.xml 中有很好的依赖关系

```
<dependency>
            <groupId>commons-fileupload</groupId>
            <artifactId>commons-fileupload</artifactId>
            <version>1.2.1</version>
        </dependency><dependency>
            <groupId>commons-io</groupId>
            <artifactId>commons-io</artifactId>
            <version>1.4</version>
        </dependency> 
```

我的 web.xml ：

```
<?xml version="1.0" encoding="UTF-8"?>
<!-- Use this definition if using a Java EE 6 container This also stops Eclipse
    from complaining that 3.0 is not a valid version <web-app version="3.0" xmlns="http://java.sun.com/xml/ns/javaee"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="
    http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-app_3_0.xsd"> -->
<web-app xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xmlns="http://java.sun.com/xml/ns/javaee" xmlns:web="http://java.sun.com/xml/ns/javaee/web-app_2_5.xsd"
    xsi:schemaLocation="http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-app_2_5.xsd"
    version="2.5">

    <!-- Theme pour prime -->
    <context-param>
        <param-name>primefaces.THEME</param-name>
        <param-value>glass-x</param-value>
    </context-param>

    <!-- The definition of the Root Spring Container shared by all Servlets
        and Filters -->
    <context-param>
        <param-name>contextConfigLocation</param-name>
        <param-value>
            /WEB-INF/spring/applicationContext.xml
            /WEB-INF/spring/security-app-context.xml
        </param-value>
    </context-param>

    <context-param>
        <param-name>javax.faces.DEVELOPMENT</param-name>
        <param-value>false</param-value>
    </context-param>

    <context-param>
        <param-name>javax.faces.FACELETS_SKIP_COMMENTS</param-name>
        <param-value>true</param-value>
    </context-param>

    <!-- jboss-el -->
    <context-param>
        <param-name>com.sun.faces.expressionFactory</param-name>
        <param-value>org.jboss.el.ExpressionFactoryImpl</param-value>
    </context-param>

    <filter>
        <filter-name>PrimeFaces FileUpload Filter</filter-name>
        <filter-class>org.primefaces.webapp.filter.FileUploadFilter</filter-class>
        <init-param>
            <param-name>thresholdSize</param-name>
            <param-value>51200</param-value>
        </init-param>

        <init-param>
            <param-name>uploadDirectory</param-name>
            <param-value>/tmp/primefacesFileupload</param-value>
        </init-param>
    </filter>

    <filter-mapping>
        <filter-name>PrimeFaces FileUpload Filter</filter-name>
        <url-pattern>/*</url-pattern>
        <servlet-name>Faces Servlet</servlet-name>
        <dispatcher>FORWARD</dispatcher>
        <dispatcher>REQUEST</dispatcher>
        <dispatcher>ASYNC</dispatcher>
    </filter-mapping>

<!--    Filter for setting all the requests and responses to UTF-8 encoding-->
    <filter>
        <filter-name>spring-encoding-filter</filter-name>
        <filter-class>org.springframework.web.filter.CharacterEncodingFilter</filter-class>
        <init-param>
            <param-name>encoding</param-name>
            <param-value>UTF-8</param-value>
        </init-param>
    </filter>

    <filter-mapping>
        <filter-name>spring-encoding-filter</filter-name>
        <url-pattern>/*</url-pattern>
    </filter-mapping>

    <!-- Localisation -->
    <filter>
        <filter-name>localizationFilter</filter-name>
        <filter-class>org.springframework.web.filter.RequestContextFilter</filter-class>
    </filter>
    <filter-mapping>
        <filter-name>localizationFilter</filter-name>
        <url-pattern>/*</url-pattern>
    </filter-mapping>

    <!-- Spring security -->
    <filter>
        <filter-name>springSecurityFilterChain</filter-name>
        <filter-class>org.springframework.web.filter.DelegatingFilterProxy</filter-class>
    </filter>
    <filter-mapping>
        <filter-name>springSecurityFilterChain</filter-name>
        <url-pattern>/*</url-pattern>
    </filter-mapping>

    <!-- Pretty faces -->
    <filter>
        <filter-name>Pretty Filter</filter-name>
        <filter-class>com.ocpsoft.pretty.PrettyFilter</filter-class>
    </filter>
    <filter-mapping>
        <filter-name>Pretty Filter</filter-name>
        <url-pattern>/*</url-pattern>
        <dispatcher>FORWARD</dispatcher>
        <dispatcher>REQUEST</dispatcher>
        <dispatcher>ERROR</dispatcher>
    </filter-mapping>

    <!-- Creates the Spring Container shared by all Servlets and Filters -->
    <listener>
        <listener-class>org.springframework.web.context.ContextLoaderListener</listener-class>
    </listener>

    <!-- place constraints on a single user's ability to log in to your application -->
    <listener>
        <listener-class>org.springframework.security.web.session.HttpSessionEventPublisher</listener-class>
    </listener>

    <!-- Processes application requests -->
    <servlet>
        <servlet-name>appServlet</servlet-name>
        <servlet-class>org.springframework.web.servlet.DispatcherServlet</servlet-class>
        <init-param>
            <param-name>contextConfigLocation</param-name>
            <param-value>/WEB-INF/spring/app/servlet-context.xml</param-value>
        </init-param>
        <load-on-startup>1</load-on-startup>
    </servlet>

    <servlet-mapping>
        <servlet-name>appServlet</servlet-name>
        <url-pattern>/spring/</url-pattern>
    </servlet-mapping>

    <servlet>
        <servlet-name>Faces Servlet</servlet-name>
        <servlet-class>javax.faces.webapp.FacesServlet</servlet-class>
        <load-on-startup>1</load-on-startup>
    </servlet>
    <servlet-mapping>
        <servlet-name>Faces Servlet</servlet-name>
        <url-pattern>*.jsf</url-pattern>
    </servlet-mapping>

    <servlet>
        <servlet-name>Resource Servlet</servlet-name>
        <servlet-class>org.primefaces.resource.ResourceServlet</servlet-class>
    </servlet>

    <servlet-mapping>
        <servlet-name>Resource Servlet</servlet-name>
        <url-pattern>/primefaces_resource/*</url-pattern>
    </servlet-mapping>

    <resource-ref>
        <res-ref-name>jsf/ProjectStage</res-ref-name>
        <res-type>java.lang.String</res-type>
        <jndi-name>javax.faces.PROJECT_STAGE</jndi-name>
    </resource-ref>

    <welcome-file-list>
        <welcome-file>index.html</welcome-file>
    </welcome-file-list>
</web-app> 
```

在视图中，我尝试以下操作：

```
<h:form enctype="multipart/form-data" id="testFileupload">
            <pou:fieldset legend="Upload de fichiers">
                <pou:messages showDetail="true"/>

                <pou:fileUpload id="fileUploadInputTest" fileUploadListener="#{siteFormManager.handleFileUpload}" auto="true" dragDropSupport="false"/>
            </pou:fieldset>
        </h:form> 
```

或者

```
<h:form enctype="multipart/form-data">
    <pou:messages showDetail="true"/>

    <pou:fileUpload value="#{siteFormManager.file}" mode="simple"/>

    <pou:commandButton value="Submit" ajax="false" actionListener="#{siteFormManager.upload}" action="#{siteFormManager.uploadAction}"/>
</h:form> 
```

在我的豆子里

```
@Component
@Scope(value = "request")
public class SiteFormManager {

    private static final Logger logger = LoggerFactory.getLogger(SiteFormManager.class);

    /**
     * Le file to upload
     */
    private UploadedFile file;

    public void handleFileUpload(FileUploadEvent event) {
        final UploadedFile lfile = event.getFile();
        logger.debug("SiteFormManager::handleFileUpload {} --> File equals {}", event, lfile);
    }

    public void handleFileUpload() {
        logger.debug("SiteFormManager::handleFileUpload without params");
    }

    public String uploadAction() {
        logger.debug("SiteFormManager::uploadAction --> File equals {}", file);
        return null;
    }

    public UploadedFile getFile() {
        return file;
    }

    public void setFile(UploadedFile file) {
        this.file = file;
    }
} 
```

问题是我的bean中的文件总是空的！我在 Tomcat 7 中尝试过，但没有任何改变。我已经尝试过 Richfaces 的 fileUpload 组件并且它可以工作，但我不会包含这两个组件库以避免冲突。

我在 Netbeans 7 上调试了我的应用程序，并在 FileUploadFilter::doFilter 上插入了一个断点。我注意到 doFilter 被调用了两次。MultipartRequest 第一次创建良好，解析表单的输入并检测文件。但是第二次请求似乎被消耗了，MultipartRequest 中没有填写任何内容。Primefaces FileUploadRenderer 使用第二个 MultipartRequest，因此该文件中不存在任何文件。

FileUploadFilter 被调用两次是否正常？如何使 fileUpload 组件工作？

**解决方案**

**我只更改了 web.xml，在 prettyfaces 过滤器中添加了 ASYNC，并在 fileupload 过滤器中删除了所有调度程序。**

最终的 web.xml

```
<?xml version="1.0" encoding="UTF-8"?>
<!-- Use this definition if using a Java EE 6 container This also stops Eclipse
    from complaining that 3.0 is not a valid version <web-app version="3.0" xmlns="http://java.sun.com/xml/ns/javaee"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="
    http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-app_3_0.xsd"> -->
<web-app xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xmlns="http://java.sun.com/xml/ns/javaee" xmlns:web="http://java.sun.com/xml/ns/javaee/web-app_2_5.xsd"
    xsi:schemaLocation="http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-app_2_5.xsd"
    version="2.5">

    <!-- Theme pour prime -->
    <context-param>
        <param-name>primefaces.THEME</param-name>
        <param-value>glass-x</param-value>
    </context-param>

    <!-- The definition of the Root Spring Container shared by all Servlets
        and Filters -->
    <context-param>
        <param-name>contextConfigLocation</param-name>
        <param-value>
            /WEB-INF/spring/applicationContext.xml
            /WEB-INF/spring/security-app-context.xml
        </param-value>
    </context-param>

    <context-param>
        <param-name>javax.faces.DEVELOPMENT</param-name>
        <param-value>false</param-value>
    </context-param>

    <context-param>
        <param-name>javax.faces.FACELETS_SKIP_COMMENTS</param-name>
        <param-value>true</param-value>
    </context-param>

    <!-- jboss-el -->
    <context-param>
        <param-name>com.sun.faces.expressionFactory</param-name>
        <param-value>org.jboss.el.ExpressionFactoryImpl</param-value>
    </context-param>

    <filter>
        <filter-name>PrimeFaces FileUpload Filter</filter-name>
        <filter-class>org.primefaces.webapp.filter.FileUploadFilter</filter-class>
        <init-param>
            <param-name>thresholdSize</param-name>
            <param-value>51200</param-value>
        </init-param>

        <init-param>
            <param-name>uploadDirectory</param-name>
            <param-value>/tmp/primefacesFileupload</param-value>
        </init-param>
    </filter>

    <filter-mapping>
        <filter-name>PrimeFaces FileUpload Filter</filter-name>
        <url-pattern>/*</url-pattern>
        <servlet-name>Faces Servlet</servlet-name>
    </filter-mapping>

<!--    Filter for setting all the requests and responses to UTF-8 encoding-->
    <filter>
        <filter-name>spring-encoding-filter</filter-name>
        <filter-class>org.springframework.web.filter.CharacterEncodingFilter</filter-class>
        <init-param>
            <param-name>encoding</param-name>
            <param-value>UTF-8</param-value>
        </init-param>
    </filter>

    <filter-mapping>
        <filter-name>spring-encoding-filter</filter-name>
        <url-pattern>/*</url-pattern>
    </filter-mapping>

    <filter>
        <filter-name>Spring OpenEntityManagerInViewFilter</filter-name>
        <filter-class>org.springframework.orm.jpa.support.OpenEntityManagerInViewFilter</filter-class>
    </filter>

    <filter-mapping>
        <filter-name>Spring OpenEntityManagerInViewFilter</filter-name>
        <url-pattern>/*</url-pattern>
    </filter-mapping>

    <!-- Localisation -->
    <filter>
        <filter-name>localizationFilter</filter-name>
        <filter-class>org.springframework.web.filter.RequestContextFilter</filter-class>
    </filter>
    <filter-mapping>
        <filter-name>localizationFilter</filter-name>
        <url-pattern>/*</url-pattern>
    </filter-mapping>

    <!-- Spring security -->
    <filter>
        <filter-name>springSecurityFilterChain</filter-name>
        <filter-class>org.springframework.web.filter.DelegatingFilterProxy</filter-class>
    </filter>
    <filter-mapping>
        <filter-name>springSecurityFilterChain</filter-name>
        <url-pattern>/*</url-pattern>
    </filter-mapping>

    <!-- Pretty faces -->
    <filter>
        <filter-name>Pretty Filter</filter-name>
        <filter-class>com.ocpsoft.pretty.PrettyFilter</filter-class>
    </filter>
    <filter-mapping>
        <filter-name>Pretty Filter</filter-name>
        <url-pattern>/*</url-pattern>
        <dispatcher>FORWARD</dispatcher>
        <dispatcher>REQUEST</dispatcher>
        <dispatcher>ERROR</dispatcher>
        <dispatcher>ASYNC</dispatcher>
    </filter-mapping>

    <!-- Creates the Spring Container shared by all Servlets and Filters -->
    <listener>
        <listener-class>org.springframework.web.context.ContextLoaderListener</listener-class>
    </listener>

    <!-- place constraints on a single user's ability to log in to your application -->
    <listener>
        <listener-class>org.springframework.security.web.session.HttpSessionEventPublisher</listener-class>
    </listener>

    <!-- Processes application requests -->
    <servlet>
        <servlet-name>appServlet</servlet-name>
        <servlet-class>org.springframework.web.servlet.DispatcherServlet</servlet-class>
        <init-param>
            <param-name>contextConfigLocation</param-name>
            <param-value>/WEB-INF/spring/app/servlet-context.xml</param-value>
        </init-param>
        <load-on-startup>1</load-on-startup>
    </servlet>

    <servlet-mapping>
        <servlet-name>appServlet</servlet-name>
        <url-pattern>/spring/</url-pattern>
    </servlet-mapping>

    <servlet>
        <servlet-name>Faces Servlet</servlet-name>
        <servlet-class>javax.faces.webapp.FacesServlet</servlet-class>
        <load-on-startup>1</load-on-startup>
    </servlet>
    <servlet-mapping>
        <servlet-name>Faces Servlet</servlet-name>
        <url-pattern>*.jsf</url-pattern>
    </servlet-mapping>

    <servlet>
        <servlet-name>Resource Servlet</servlet-name>
        <servlet-class>org.primefaces.resource.ResourceServlet</servlet-class>
    </servlet>

    <servlet-mapping>
        <servlet-name>Resource Servlet</servlet-name>
        <url-pattern>/primefaces_resource/*</url-pattern>
    </servlet-mapping>

    <resource-ref>
        <res-ref-name>jsf/ProjectStage</res-ref-name>
        <res-type>java.lang.String</res-type>
        <jndi-name>javax.faces.PROJECT_STAGE</jndi-name>
    </resource-ref>

    <welcome-file-list>
        <welcome-file>index.html</welcome-file>
    </welcome-file-list>
</web-app> 
```

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-22T05:30:37.863

我相信您需要将 ASYNC 调度程序添加到您的 PrettyFaces 过滤器映射中：

```
<!-- Pretty faces -->
<filter>
    <filter-name>Pretty Filter</filter-name>
    <filter-class>com.ocpsoft.pretty.PrettyFilter</filter-class>
</filter>
<filter-mapping>
    <filter-name>Pretty Filter</filter-name>
    <url-pattern>/*</url-pattern>
    <dispatcher>FORWARD</dispatcher>
    <dispatcher>REQUEST</dispatcher>
    <dispatcher>ERROR</dispatcher>
    <dispatcher>ASYNC</dispatcher>
</filter-mapping> 
```

如果我没记错的话，PrimeFaces 上传组件使用 ASYNC 上传。

# eclipse - Eclipse 导入 > Git 选项不可用

> ID：10692417
> 
> 赞同：7
> 
> 时间：2012-05-21T20:49:19.817
> 
> 标签：eclipse, git, import, repository

我正在尝试导入一个 git 项目，但“导入”下的 git 选项不可用。我有 Eclipse 3.7.2，并且已经安装了 EGit。我之前在这个版本的 Eclipse 上完成了 Git 导入，但我之前没有遇到过这个问题。我在另一台计算机上，重新安装所有内容，并试图让我的旧项目运行

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-04-29T13:35:18.930

我在使用 Juno (3.8) 时遇到了这个问题 - 我不知道我安装 eGit 的方式是什么，但我认为我做错了。

我试图从我的 Ubuntu 14.04 中完全删除 Eclipse 并重新安装它，但 eGit 仍然存在......

最后，从我的主文件夹中删除 .eclipse 隐藏目录修复了这个问题。然后我再次安装了 eGit，通过选择所有可用站点并在列表中找到它。

希望它会帮助任何人:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-21T05:23:30.633

克隆 git 存储库后，在 Git 透视图中，右键单击 git 存储库视图中的“工作目录”节点并执行“导入项目...”操作。这将打开一个向导，让您在子文件夹中搜索 .project 文件并导入任何现有的 Eclipse 项目。

# asp.net - Asp.Net MVC3（Razor 视口），ValidationMessageFor?

> ID：10692420
> 
> 赞同：0
> 
> 时间：2012-05-21T20:49:33.780
> 
> 标签：asp.net, asp.net-mvc, razor

我需要知道是否有 ValidationMessage。因为我想
在错误消息中添加 " 标记。

像

```
@if (Html.ValidationMessageFor(m => m.UserId)){
 Html.ValidationMessageFor(m => m.UserId) + "<br />
} 
```

上面的代码不起作用，有人知道它是如何工作的吗？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-21T20:56:54.277

您需要检查 ModelState 是否存在该特定错误。例如：

```
@if (ModelState["UserId"].Errors.Count > 0) {
    Html.ValidationMessageFor(m => m.UserId) @:<br/>
} 
```

如果你到处都有它，这可能会变得非常丑陋。如果你需要做很多，那么创建一个自定义的 Html Helper 扩展。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-21T20:52:40.830

如果您需要在验证消息中添加一些标记，我建议您创建一个自定义标记。您需要做的就是创建一个新的助手并将该逻辑封装在助手本身中

像下面这样的东西

```
 public MvcHtmlString MyValidationMessageFor<TModel, TProperty>(this HtmlHelper<TModel> helper, Expression<Func<TModel, TProperty>> expression)
    {
         //your logic here

     } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-21T22:18:05.657

你的问题很不清楚。请澄清您想要实现的目标。

如果您想在有错误时显示错误，如果没有则不显示错误，您不需要像 Mystere Man 建议的那样编写单独的“if()”逻辑。

只需使用`Html.ValidationMessageFor(m => m.UserId)`由 css html 正确格式化并正确引用验证所需的脚本即可。

通过正确格式化的 html 我的意思是在 div 标签中的输入旁边有验证块，这样你就不必`<br>`为新行添加 s 。

# css - 焦点上的框阴影

> ID：10692421
> 
> 赞同：0
> 
> 时间：2012-05-21T20:49:40.393
> 
> 标签：css

为什么 :focus 上的 box-shadow 没有在我这里的这个 jsfiddle 中应用？

[http://jsfiddle.net/septerr/ZgZEY/](http://jsfiddle.net/septerr/ZgZEY/)

> :-|

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-21T20:52:47.287

添加 `-webkit-appearance: none;`

**[jsFiddle 示例](http://jsfiddle.net/j08691/ZgZEY/1/)**。

至于 webkit 浏览器下的复选框，它似乎是 box-shadow 的一个[已知错误](http://code.google.com/p/chromium/issues/detail?id=92547)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-21T20:51:59.270

如果您在 Firefox 3.5 或 3.6 中进行测试，但没有看到任何框阴影，那是因为您没有`-moz-box-shadow`前缀，这是[这些版本](http://caniuse.com/css-boxshadow)所必需的。

这应该（并且确实）在支持该属性或其 WebKit 前缀的其他浏览器中按预期工作。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-26T16:27:56.540

原来 box-shadows 不适用于 chrome 中的选择框和复选框。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-12T07:59:03.513

此外，如果您只需要文本字段或区域，则可以指定边框。不知何故，如果你给一个像`1px solid black`阴影这样的边框就可以了。

（我在文本字段上有一个工作阴影，所以我将应用到它的不同样式添加到您的 jsfiddle：http: [//jsfiddle.net/ZgZEY/30/](http://jsfiddle.net/ZgZEY/30/)）

# sentiment-analysis - 现有的情感分析算法有哪些？

> ID：10692428
> 
> 赞同：7
> 
> 时间：2012-05-21T20:49:55.433
> 
> 标签：sentiment-analysis

我和一群人正在开发一种情绪分析算法。我想知道现有的有哪些，因为我想比较它们。有没有文章介绍这方面的主要算法？

提前致谢

蒂亚戈

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-05-23T13:58:48.367

一些关于情绪分析的论文可能会对您有所帮助-

1.  Bo Pang，Lillian Lee 的早期作品之一[http://acl.ldc.upenn.edu/acl2002/EMNLP/pdfs/EMNLP219.pdf](http://acl.ldc.upenn.edu/acl2002/EMNLP/pdfs/EMNLP219.pdf)
2.  情绪分析技术综合调查[http://www.cse.iitb.ac.in/~pb/cs626-449-2009/prev-years-other-things-nlp/sentiment-analysis-opinion-mining-pang- lee-omsa-published.pdf](http://www.cse.iitb.ac.in/~pb/cs626-449-2009/prev-years-other-things-nlp/sentiment-analysis-opinion-mining-pang-lee-omsa-published.pdf)
3.  Hang Cui, V Mittal, M Datar 使用 6-gram 研究[http://citeseerx.ist.psu.edu/viewdoc/download?doi=10.1.1.83.5942&rep=rep1&type=pdf](http://citeseerx.ist.psu.edu/viewdoc/download?doi=10.1.1.83.5942&rep=rep1&type=pdf)

为了快速实现，建议使用朴素贝叶斯。你可以在这里找到一个例子[http://nlp.stanford.edu/IR-book/](http://nlp.stanford.edu/IR-book/)

我们对各种分类器进行了统计比较，发现 SVM 最准确，但对于包含大量内容的数据集 ( [http://ai.stanford.edu/~amaas/data/sentiment/](http://ai.stanford.edu/~amaas/data/sentiment/) )，没有一种方法效果很好。我们的研究可能并不准确。此外，您可以查看从文本中提取含义，而不是将情感分析视为文本分类问题，尽管我不知道它可能有多成功。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-25T00:18:29.797

显然 NLTK，一个 python 自然语言处理库，有一个：

[http://text-processing.com/demo/sentiment/](http://text-processing.com/demo/sentiment/)

可能值得一看。

# iphone - 将 UITabBarController 分配为 RootNavigationController

> ID：10692429
> 
> 赞同：-1
> 
> 时间：2012-05-21T20:49:55.673
> 
> 标签：iphone, uinavigationcontroller, uitabbarcontroller, storyboard

我目前正在使用 XCode 4.3 和故事板。我`ViewControllers`的`RootTabBarController`. 我希望我`SecondViewController`成为一个`RootNavigationController`，这样我就可以从中获得其他屏幕。任何想法如何通过界面构建​​器或以编程方式实现它。

***注意：*** 我试图拉入一个导航控制器（它带有它的根控制器，我试图将它分配`SecondViewController`为`RootNavigationController`，我怀疑它失败了，因为`TabBarController`它与它有根关系。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-21T20:54:23.853

如果我理解正确，您希望应用程序的根视图控制器成为选项卡栏控制器，并让应用程序在第二个选项卡上启动。

```
self.window.rootViewController = myTabBarController;
myTabBarController.selectedIndex = 1; 
```

# java - Java - 完全像 windows7 一样启动一个进程

> ID：10692438
> 
> 赞同：0
> 
> 时间：2012-05-21T20:50:21.690
> 
> 标签：java, process, exec

我正在尝试在用 Java 编写的测试框架中启动一个进程，但该进程的行为有所不同。“登录”按钮冻结。可以通过关闭启动该过程的测试框架来解决该问题

当进程由用户启动时，没有问题。（通过 explorer、visual studio、cmdline && DURING runtime of testing framework）

```
ProcessBuilder pb = new ProcessBuilder(commands);
pb.directory(workingDirectory); 
```

和

```
process = runtime.exec(commands, null, workingDirectory); 
```

未能提供适当的结果。该进程的行为仍然不同于通过双击应用程序图标创建的进程。该应用程序是用本机 C++ 编写的

我如何启动一个进程 - 完全 - 就像 Windows7 会做的那样？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-22T02:21:56.490

我认为您的问题可能是您的 .exec 命令中的空值。那就是您要传递的环境变量。

查看 java.lang.Runtime 类的 javadocs：

envp - 字符串数组，其中每个元素的环境变量设置格式为 name=value，如果子进程应继承当前进程的环境，则为 null。

也许您在运行 java 程序时缺少环境变量或其他东西。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-01T14:44:54.890

确保阅读流程流以解决阻塞问题。

# c# - 在项目控件中公开“添加新项目”标记的最佳 MVVM 方法是什么？

> ID：10692445
> 
> 赞同：2
> 
> 时间：2012-05-21T20:50:54.940
> 
> 标签：c#, wpf, mvvm

假设我有一个`TabControl`呈现`Foo`对象集合的 a （每个都通过 a `FooViewModel`）。在选项卡项列表的末尾，我想要一个不模拟任何内容的人造选项卡项，但它会创建一个新模型项并在单击时将其添加到集合中。

如果概念不清楚，一个真实的例子是 Internet Explorer 中的选项卡。它有`n+1`选项卡项：`n`具有页面内容，最后一个添加了新的“真实”选项卡。

在 MVVM 中对这种类型的交互进行建模的正确方法（如果有）是什么？我想到的选项是：

*   使其成为视图模型的一部分。在控件绑定到的集合的末尾`IEnumerable<FooViewModel> Foos`，添加一个“新项目”哨兵并将“我是真正的 foo 还是新的 foo 哨兵”逻辑构建到视图模型中。

*   使其完全成为视图的一部分。重新模板（和/或子类）`TabControl`以呈现所有真实项目，然后还有一个按钮，该按钮调用命令以创建和插入新项目。

第一个选项一开始感觉不对，就像它会将视图细节泄漏到视图模型中（'add a new' 似乎很可能`Foo`是一个通用命令，并且某些视图可能根本不希望从选项卡列表中调用它）。但这确实有一定的意义，因为对于初始化过程，我已经需要为“半构造`Foo`”建模，因此“尚不存在`Foo`”的模型似乎并不遥远。

第二部分似乎需要做很多工作，也很容易搞砸（假设希望它看起来和感觉像其他选项卡）。

但我是 MVVM 的新手；这肯定经常出现。也许我完全错过了一些东西。传统的处理方式是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T21:18:26.663

MVVM 模式的几个关键租户是：

*   **可测试**性——通过使您的视图尽可能简单，通过将逻辑移动到您的视图模型中，您可以通过单元测试增加可以测试的逻辑量。
*   **Designer-Support** - 模拟视图模型可用于为您的视图提供设计时数据。

您的哪个建议最能满足上述要求？我会说选项（1）。您可以编写单元测试以确保列表中的最后一项始终是“哨兵”项。

为了“在视图模型中构建‘我是一个真正的 foo 还是一个新的 foo 哨兵’逻辑。”，您可以简单地使用类型化的 DataTemplates。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-23T11:31:05.293

仅重新模板 TabControl 并在选项卡右侧添加一个人造选项卡或按钮可能会更简单。

基本示例：

```
<Window x:Class="ContextMenuSample.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="MainWindow" Height="350" Width="525">
    <Window.Resources>
        <SolidColorBrush x:Key="WindowBackgroundBrush"
                         Color="#FFF" />

        <SolidColorBrush x:Key="SolidBorderBrush"
                         Color="#888" />

        <SolidColorBrush x:Key="DisabledForegroundBrush"
                         Color="#888" />

        <SolidColorBrush x:Key="DisabledBorderBrush"
                         Color="#AAA" />

        <Style  TargetType="{x:Type TabControl}">
            <Setter Property="OverridesDefaultStyle"
                    Value="True" />
            <Setter Property="SnapsToDevicePixels"
                    Value="True" />
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="{x:Type TabControl}">
                        <Grid KeyboardNavigation.TabNavigation="Local">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="*" />
                            </Grid.RowDefinitions>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto" />
                                <ColumnDefinition Width="*" />
                            </Grid.ColumnDefinitions>
                            <TabPanel Name="HeaderPanel"
                                      Grid.Row="0"
                                      Panel.ZIndex="1"
                                      Margin="0,0,4,-1"
                                      IsItemsHost="True"
                                      KeyboardNavigation.TabIndex="1"
                                      Background="Transparent" />
                            <Button Grid.Row="0"
                                    Grid.Column="1"
                                    Content="Add new" />
                            <Border Name="Border"
                                    Grid.Row="1"
                                    Grid.ColumnSpan="2"
                                    Background="{StaticResource WindowBackgroundBrush}"
                                    BorderBrush="{StaticResource SolidBorderBrush}"
                                    BorderThickness="1"
                                    CornerRadius="2"
                                    KeyboardNavigation.TabNavigation="Local"
                                    KeyboardNavigation.DirectionalNavigation="Contained"
                                    KeyboardNavigation.TabIndex="2">
                                <ContentPresenter Name="PART_SelectedContentHost"
                                                  Margin="4"
                                                  ContentSource="SelectedContent" />
                            </Border>
                        </Grid>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsEnabled"
                                     Value="False">
                                <Setter Property="Foreground"
                                        Value="{StaticResource DisabledForegroundBrush}" />
                                <Setter TargetName="Border"
                                        Property="BorderBrush"
                                        Value="{StaticResource DisabledBorderBrush}" />
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

    </Window.Resources>

    <Grid>
        <TabControl>
            <TabItem Header="Item 1" />
            <TabItem Header="Item 2" />
        </TabControl>
    </Grid>

</Window>

enter code here 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-21T20:57:46.023

我会选择第一个：

所以你有一个集合`TabViews`，如果它是最后一个，当它被激活时会创建一个新的并在它自己之前注入它。

样式怎么样：如果你想让它成为 UI 的一部分，你也可以在之后做。那是强项`WPF`。

所以总的来说，解决方案变成了你所说的两种解决方案的合并。没有什么可以阻止您为`TabView` 集合中的最后一个制作样式模板并将其*仅*应用于它。

希望这可以帮助。

# visual-studio-2010 - 可以在 SQL Server 中重构数据库吗？

> ID：10692447
> 
> 赞同：3
> 
> 时间：2012-05-21T20:51:12.457
> 
> 标签：visual-studio-2010, sql-server-2008, refactoring

我们有一个相对较新的数据库项目，在过去 6 个月左右的时间里，我们一直在编写视图和存储过程。

*   数据库工作
*   意见有效
*   存储过程工作

但是，自从该项目开始以来，该项目的总体范围已大大增加，现在一些表名和字段名有点偏离基础。

例如，数据库中的主表名为`SheetMetalRequest`，但项目已经发展到现在实际的钣金请求只是可枚举类型的请求之一。因此，此表上的名称会误导进入该项目的人。

除了这个主表之外，其他表中的各种列也需要更改（`SheetMetalRequestID`例如，想想）。

进行此更改的问题是 10 个不同的视图和 30 个存储过程现在是该数据库的一部分。自然地，如果某些东西发生了变化，而不是一切都随之改变，我们工作的*预生产*数据库可能需要几个工时才能恢复到运行状态。

如果有某种类似于 Visual Studio 中存在的*重构*能力，那就**太好了。**

 *```
SELECT SERVERPROPERTY('productversion'), SERVERPROPERTY('productlevel'), SERVERPROPERTY('edition')

productversion | productlevel | edition
10.0.1600.22   | RTM          | Standard Edition (64-bit) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-21T21:34:42.673

如果像 SSDT 这样的工具由于某种原因对您不起作用，您可以按照自己的步调手动执行此操作。有时“单击一个按钮然后回家”的方法实际上*并不是*您想要的。

您可以从介绍同义词开始，例如

```
CREATE SYNONYM dbo.Requests FOR dbo.SheetMetalRequest; 
```

现在您可以分段重构代码，将每个引用指向新名称。当您确信已捕获所有引用时（即使使用像 SSDT 这样的工具也不容易，因为它看不到数据库之外的代码 - 甚至看不到当前数据库中动态 SQL 中的代码），您可以删除同义词并重命名表：

```
BEGIN TRANSACTION;
    DROP SYNONYM dbo.Requests;
    EXEC sp_rename 'dbo.SheetMetalRequest', 'Requests', 'OBJECT';
COMMIT TRANSACTION 
```

（您还需要`sp_refreshsqlmodule`在一个循环中更新所有模块，两次，以确保您已经完全纠正了依赖关系。）

这将允许您更新代码的不同部分（不仅是视图/存储过程，还包括中间层类甚至前端的东西）以引用正确的名称，而不必一次完成所有操作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-28T07:53:54.513

Red Gate 的 SQL Prompt 具有“智能重命名”功能，这听起来就像您正在寻找的一样。这不仅会重命名对象，还会重命名其他对象中对它的任何引用。这是我工作的公司的商业工具，但有 14 天的全功能评估期。

请参阅[http://www.red-gate.com/products/sql-development/sql-prompt/features](http://www.red-gate.com/products/sql-development/sql-prompt/features)*

# java - 使用 php 打开进程并在请求之间保持打开状态

> ID：10692448
> 
> 赞同：0
> 
> 时间：2012-05-21T20:51:16.523
> 
> 标签：java, php, terminal, xmlhttprequest

我有一个计算终端程序，我需要使用 php 网页与之交互。我可以在 JAVA 中使用 getRuntime().exec(...) 执行此操作，然后创建读取和写入进程的管道，并且该进程将存在于请求之间。但我不确定它是否可以用 PHP 完成，因为我不认为 proc_open 在请求期间保持进程处于活动状态？

这是我正在创建的网页的流程。首先，用户将在网页上输入命令，该命令将被馈送到执行计算的终端程序，然后将答案返回给用户。我将对请求使用 AJAX，以便在不刷新页面的情况下返回答案。

现在我的问题是我需要在下一个请求上与相同的进程进行交互，而不是开始一个新的。这是因为终端程序有状态。那就是我可以像这样在其中设置变量-`X = 5;`

所以在我第一次通过 AJAX 调用程序时

`X = 5;`

并且返回给用户浏览器的程序的输出是 -

`X = 5`

然后在我的下一个 AJAX 请求中我通过

`Y = X + 5;`

然后程序应该输出

`Y = 10`

它被传递回用户浏览器。

但据我了解，proc_open 函数不维护请求之间的状态。我了解当服务器响应用户的请求时，该进程已关闭。它是否正确？如果是这样，有什么方法可以使用 PHP 做我需要做的事情吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-21T20:56:06.177

使用 PHP 会话。见这里： http: [//php.net/manual/en/book.session.php](http://php.net/manual/en/book.session.php)

基本上，服务器会向浏览器发出一个 cookie 标识符，并创建一个对象变量`$_SESSION`来保存你想要的任何东西。每次浏览器向服务器显示 cookie 时，服务器都会检索该`$_SESSION`会话的变量，以便您的 PHP 脚本可以访问它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-21T20:52:40.547

你会想要调查[`$_SESSION`](http://us2.php.net/manual/en/book.session.php)s. 由于 PHP 没有维护状态会话的概念，因此您可以通过这种方式在请求之间传递信息。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-21T21:11:17.327

如果仅仅使用会话的概念存储值是不够的，并且这个终端程序确实需要继续运行：

编写一个守护程序（用 php 或 java 或任何你喜欢的）。该程序应在本地套接字上侦听连接，并将为每个客户端维护一个终端程序实例。您的 php 脚本只需在本地套接字上连接到此守护程序，发送一个 id 以识别正在继续的终端实例，然后您可以发送命令并获取响应，守护程序只是充当终端的代理/管理器实例。

# recursion - The Little Schemer 仅偶数*&co

> ID：10692449
> 
> 赞同：14
> 
> 时间：2012-05-21T20:51:21.157
> 
> 标签：recursion, lambda, scheme, continuation-passing, the-little-schemer

我很难理解`evens-only*&co`第 145 页上 The Little Schemer 的示例发生了什么。

这是代码：

```
(define evens-only*&co
 (lambda (l col)
   (cond
    ((null? l)
     (col '() 1 0))
    ((atom? (car l))
     (cond
      ((even? (car l))
       (evens-only*&co (cdr l)
                    (lambda (newl product sum)
                      (col (cons (car l) newl)
                           (opx (car l) product)
                           sum))))
      (else
       (evens-only*&co (cdr l)
                    (lambda (newl product sum)
                      (col newl product (op+ (car l) sum)))))))
    (else
     (evens-only*&co (car l)
                  (lambda (newl product sum)
                    (evens-only*&co (cdr l)
                                    (lambda (dnewl dproduct dsum)
                                      (col (cons newl dnewl)
                                           (opx product dproduct)
                                           (op+ sum dsum)))))))))) 
```

初始`col`可以是：

```
(define evens-results
 (lambda (newl product sum)
   (cons sum (cons product newl)))) 
```

我没有得到的是，使用`l`as时，它会立即使用as和as`'((1) 2 3)`进入决赛。很好，但是我的大脑一片空白，试图从, ,中找出, , 。如果有人可以指导我如何设置 DrRacket 或 Chez Scheme 或 MIT-Scheme 来运行步进器，那也会很有帮助。`else``(car l)``(1)``(cdr l)``(2 3)``dnewl``dproduct``dsum``newl``product``sum`

但也许我太早了。第一次阅读这篇文章的初学者真的应该理解这种疯狂的延续吗？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2012-05-22T11:52:22.490

我在第一次阅读时也发现这部分令人困惑，并且只是在我在其他地方阅读了有关延续和延续传递风格（这就是它）之后才开始理解它。

冒着解释你已经得到的东西的风险，一种对我有帮助的看待它的方法是将“收集器”或“延续”视为替换函数返回值的正常方式。在正常的编程风格中，您调用一个函数，接收一个值，然后在调用者中对其进行处理。例如，标准递归函数包括非空情况`length`的表达式。`(+ 1 (length (cdr list)))`这意味着一旦`(length (cdr list))`返回一个值，就会有一个计算等待它产生的任何值发生，我们可以将其视为`(+ 1 [returned value])`. 在正常的编程中，解释器会跟踪这些待处理的计算，这些计算往往会“堆积”起来，正如您在本书的前几章中看到的那样。例如，在递归计算列表的长度时，我们有一个“等待计算”嵌套，其深度与列表的长度一样多。

在延续传递风格中，我们不是调用一个函数并在调用函数中使用*返回*的结果，而是通过为函数提供一个“延续”来调用它来告诉函数当它产生其值时要做什么。（这类似于你在异步 Javascript 编程中对回调所做的事情，例如：而不是写`result = someFunction();`你写`someFunction(function (result) { ... })`，所有使用的代码`result`都在回调函数中）。

这里是`length`连续传递风格，只是为了比较。我已经调用了 continuation 参数`return`，它应该暗示它在这里的作用，但请记住，它只是一个普通的 Scheme 变量，就像其他任何变量一样。（通常`k`以这种方式调用延续参数）。

```
(define (length/k lis return)
  (cond ((null? lis) (return 0))
        (else
         (length/k (cdr lis)
                   (lambda (cdr-len)
                     (return (+ cdr-len 1))))))) 
```

[*在Little Schemer*](http://www.cs.indiana.edu/~dfried/appcont.pdf)[的合著者 Dan Friedman](http://www.cs.indiana.edu/~dfried/appcont.pdf)[的一篇关于 continuations 的文章](http://www.cs.indiana.edu/~dfried/appcont.pdf)*中，有一个阅读此类代码的有用提示。（见第 8 页开始的第 II-5 节）。解释一下，这就是`else`上面的条款所说的：*

 *> 假设你有调用`length/k`on的结果，然后`(cdr lis)`调用它`cdr-len`，然后加一个并将这个加法的结果传递给你的延续 ( `return`)。

请注意，这几乎正是解释器`(+ 1 (length (cdr lis)))`在函数的正常版本中评估时所要做的（除了它不必为中间结果命名`(length (cdr lis))`。通过传递延续或回调，我们已经做了控制流（和中间值的名称）是显式的，而不是让解释器跟踪它。

让我们将此方法应用于`evens-only*&co`. 由于这个函数产生*三个*值而不是一个，所以这里有点复杂：删除了奇数的嵌套列表；偶数的乘积；和奇数的总和。这是第一个子句，其中`(car l)`已知是偶数：

```
(evens-only*&co (cdr l)
                (lambda (newl product sum)
                  (col (cons (car l) newl)
                       (opx (car l) product)
                       sum))) 
```

> 想象一下，您有从列表中删除奇数、乘偶数和添加奇数的结果`cdr`，并将它们`newl`分别称为`product`、 和`sum`。`cons`列表的头部到`newl`（因为它是偶数，它应该在结果中）；乘以`product`列表的头部（因为我们正在计算偶数的乘积）；不理会`sum`；并将这三个值传递给您的等待继续`col`。

以下是列表头部为奇数的情况：

```
(evens-only*&co (cdr l)
                (lambda (newl product sum)
                  (col newl product (op+ (car l) sum)))) 
```

和以前一样，但是将相同的`newl`和值传递`product`给延续（即“返回”它们），以及`sum`列表的总和和头部，因为我们正在对奇数求和。

这是最后一个，其中`(car l)`是一个嵌套列表，并且由于双重递归而稍微复杂：

```
(evens-only*&co (car l)
                (lambda (newl product sum)
                  (evens-only*&co (cdr l)
                                  (lambda (dnewl dproduct dsum)
                                    (col (cons newl dnewl)
                                         (opx product dproduct)
                                         (op+ sum dsum)))))) 
```

> 想象一下，您有删除、求和和添加数字的结果，`(car l)`并调用这些`newl`,`product`和`sum`; 然后想象你有做同样事情的结果`(cdr l)`，并调用它们`dnewl`，`dproduct`和`dsum`。对于您的等待继续，给出由`cons`ing `newl`and生成的值`dnewl` （因为我们正在生成列表列表）；`product`和相乘 `dproduct`；并添加`sum`和`dsum`。

注意：每次我们进行递归调用时，我们都会为递归调用构造一个新的延续，它“关闭”参数的当前值`l`，以及返回延续 - `col`，换句话说，你可以想到我们在递归期间建立的延续作为对更传统编写函数的“调用堆栈”的建模！

希望这可以部分回答您的问题。如果我有点过火了，那只是因为我认为，在递归本身之后，延续是*The Little Schemer*和一般编程中第二个非常简洁、扩展思维的想法。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2017-11-08T08:41:37.080

The [answer](https://stackoverflow.com/a/10701507/8554766) by [Jon O.](https://stackoverflow.com/users/725091/jon-o) is a really great in-depth explanation of underlying concepts. Though for me (and hopefully, for some other people too), understanding of concepts like this is a lot more easier when they have a visual representation.

So, I have prepared two flow-charts (similar to [ones I did for `multirember&co`](https://stackoverflow.com/a/46336269/8554766), untangling what is happening during the call of `evens-only*&co`

given `l` is:

```
'((9 1 2 8) 3 10 ((9 9) 7 6) 2) 
```

and `col` is:

```
(define the-last-friend
    (lambda (newl product sum)
        (cons sum (cons product newl))
    )
) 
```

One flow-chart, reflecting **how variables relate in different steps of recursion**: [![Visual walkthrough showing relations between variables](../Images/0a2f63433e7222161d60f19108e6036b.png)](https://i.stack.imgur.com/foVLY.jpg) Second flow-chart, showing the **actual values, being passed**: [![Visual walkthrough with values](../Images/50f76f2b8fddc90979c3144994a16900.png)](https://i.stack.imgur.com/XaN9l.jpg)

My hope is, that this answer will be a decent addition to the [Jon's explanation above](https://stackoverflow.com/a/10701507/8554766).

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-24T19:18:38.140

我一直在阅读如何设计程序（felleisen et.al.）。我正在浏览他们定义**本地**定义的部分。我已经编写了一个代码，它使用本地定义实现了上述 evens-only&co。这是我写的：

```
(define (evens-only&co l)
  (local ((define (processing-func sum prod evlst lst)
            (cond ((null? lst) (cons sum (cons prod evlst)))
                  ((atom? (car lst))
                   (cond ((even? (car lst)) (processing-func sum (* prod (car lst)) (append evlst (list (car lst))) (cdr lst)))
                         (else
                          (processing-func (+ sum (car lst)) prod evlst (cdr lst)))))
                  (else
                   (local ((define inner-lst (processing-func sum prod  '() (car lst))))
                   (processing-func (car inner-lst) (cadr inner-lst) (append evlst (list (cddr inner-lst))) (cdr lst)))))))
    (processing-func 0 1 '() l))) 
```

为了测试，当我输入 (evens-only&co '((9 1 2 8) 3 10 ((9 9) 7 6) 2)) 时，它返回 '(38 1920 (2 8) 10 (() 6) 2)正如小计划者所期望的那样。但是，我的代码在一种情况下失败：当根本没有偶数时，偶数的乘积仍然显示为 1。例如 (evens-only&co '((9 1) 3 ((9 9) 7 )))返回'(38 1 () (()))。我想我需要一个额外的功能来纠正这个问题。@melwasul：如果您不熟悉**本地**定义，很抱歉在这里发布。我建议你也阅读 HTDP。这是一本适合初学者的好书。但是方案专家也可以在我的代码上发表他们的评论。我对本地定义的理解是否正确？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-01-22T18:20:45.150

在等式伪代码（类似[KRC](https://en.wikipedia.org/wiki/Kent_Recursive_Calculator)`f x y`的表示法，为 call编写`(f x y)`，它是明确的）中，这是

```
evens-only*&co l col 
   = col [] 1 0                                     , IF null? l
   = evens-only*&co (cdr l) 
                    ( newl product sum =>
                        col (cons (car l) newl)
                            (opx (car l) product)
                            sum )                   , IF atom? (car l) && even? (car l)
   = evens-only*&co (cdr l) 
                    ( newl product sum =>
                        col  newl  product  (op+ (car l) sum) )      , IF atom? (car l)
   = evens-only*&co (car l) 
                    ( anewl aproduct asum =>
                         evens-only*&co (cdr l)
                                        ( dnewl dproduct dsum =>
                                             col (cons anewl    dnewl)
                                                 (opx  aproduct dproduct)
                                                 (op+  asum     dsum) ) )   , OTHERWISE 
```

这是一个[CPS](https://en.wikipedia.org/wiki/Continuation-passing_style)代码，它从输入嵌套列表（即树）中收集所有偶数，同时保留树结构，并找到所有偶数的乘积；至于非偶数，它*总结*了它们：

*   如果`l`是一个空列表，则三个基本（身份）值作为参数传递给 col；

*   如果`(car l)`是偶数，则处理的结果是 和 ，`(cdr l)`然后将`newl`它们*作为*参数传递给 ，而前两个通过 consing ⁄ 乘以（偶数）来增加；`product``sum`*`col``(car l)`*

**   如果`(car l)`是一个不是偶数的原子，则处理的结果是 和 ，`(cdr l)`然后将`newl`它们*作为*参数传递给第三个，通过与（非偶数原子）求和而增加；`product``sum`*`col``(car l)`*

    **   如果`(car l)`是一个列表，处理的结果`(car l)`是`anewl`，`aproduct`和`asum`，*然后*处理的结果`(cdr l)`是`dnewl`，`dproduct`和`dsum`，*然后*三个组合的结果作为参数传递给`col`。** 

 **`[]`和基本情况分别是列表[幺半群](https://en.wikipedia.org/wiki/Monoid)、乘法下的数字和加法下的数字`1`的`0`单位元素。这只是意味着组合到结果中时不会改变结果的特殊值。

作为说明，对于`'((5) 2 3 4)`（接近问题中的示例），它创建了计算

```
evens-only*&co [[5], 2, 3, 4] col
=
col  (cons []                   ; original structure w only the evens kept in,
           (cons 2              ;   for the car and the cdr parts
              (cons 4 [])))
     (opx 1                     ; multiply the products of evens in the car and 
          (opx 2 (opx 4 1)))    ;   in the cdr parts
     (op+ (op+ 5 0)             ; sum, for the non-evens
          (op+ 3 0)) 
```

* * *

与[我的其他答案](https://stackoverflow.com/a/48371028/849891)（对姐妹问题）类似，这是另一种编写方式，使用模式匹配伪代码（带警卫）：

```
evens-only*&co  =  g   where
  g [a, ...xs...] col 
         | pair? a    = g a  ( la pa sa =>
                         g xs ( ld pd sd =>
                                        col [la, ...ld...] (* pa pd) (+ sa sd) ) )
         | even? a    = g xs ( l p s => col [ a, ...l... ] (* a  p )       s     )
         | otherwise  = g xs ( l p s => col         l            p   (+ a  s )   )
  g []            col =                 col []              1         0 
```

这种表示法的经济性（和多样性）确实使它更清晰，更容易*看到*，而不是迷失在函数和变量等长名称的单词沙拉中，括号作为列表数据的语法分隔符重载，子句分组（像在`cond`表达式中），名称绑定（在表达式中）和`lambda`函数调用指示符*看起来**都非常相似*。S 表达式符号的相同一致性有利于机器（即 lisp*`read`*和宏）的操作，这对*人类*的可读性是有害的。***

# c# - 最大可命名字符数配额

> ID：10692455
> 
> 赞同：1
> 
> 时间：2012-05-21T20:51:39.627
> 
> 标签：c#, wcf, xml-serialization

我有一个 WCF 服务（基于 SOAP）在调用某些 Web 方法时开始遇到以下异常：

System.Xml.XmlException：读取 XML 数据时已超出最大可命名字符计数配额 (16384)。nametable 是一种数据结构，用于存储在 XML 处理过程中遇到的字符串 - 具有不重复元素名称、属性名称和属性值的长 XML 文档可能会触发此配额。可以通过更改创建 XML 阅读器时使用的 XmlDictionaryReaderQuotas 对象的 MaxNameTableCharCount 属性来增加此配额。第 1 行，位置 4221。在 System.Xml.XmlExceptionHelper.ThrowXmlException

虽然我们已经通过增加服务和客户端配置中的配额来解决此问题，但在我们开始遇到问题之前和应用配额增加之后，我发现消息响应没有任何差异。

我的问题是：

1.  名称表是如何工作的？拥有最大值的名称表意味着什么？

2.  有没有什么东西可以解释为什么我们在不改变服务和测试用例的情况下开始遇到这个异常？虽然我们添加了一些方法，但我不确定这是否是一个很好的解释，因为这些 Web 方法没有被调用。

3.  关于调试名称表的任何建议并查看导致溢出的原因？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T11:58:20.240

1.  解析 xml 时，消息中的每个元素/属性名称都放在某个表中，因此可以有效地重用它们。这个配额的原因是为了避免dos（拒绝服务攻击），例如有人发送非常大的消息来消耗你所有的服务器处理代码。如果您不希望发生这种情况，您可以使用最大值。

2.  也许您更改了 wcf 版本，因此默认值已更改。也可能某些原因导致客户端以不同的方式进行序列化（例如更多属性），因此它发送了更详细的内容。

3.  只是增加配额并忘记它..你不想调试这个

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-12-29T22:38:43.950

> 虽然我们添加了一些方法，但我不确定这是否是一个很好的解释，因为这些 Web 方法没有被调用。

我在我们的 WCF 应用程序中看到了类似的行为，我们只是在协议中的一个 XML 消息中添加了一些属性。事实证明，这些新属性有点长（每个约 25 个字符），通过减少它们的长度，问题就消失了。

鉴于问题出现在我们的打开会话消息很小并且错误堆栈显示自动生成的 XML 序列化程序我得出结论，作为优化步骤，自动生成的 XML 序列化程序会尝试预先填充 XML 解析器的名称表第一次使用而不更改其默认最大大小 16Kb 以根据“已编译”XML 模式匹配实际大小。这就解释了为什么当 WCF 堆栈尝试反序列化一个微小的 XML 请求时会失败。

添加此行解决了上述问题：

```
webHttpBinding.ReaderQuotas.MaxNameTableCharCount = 32768; 
```

# javascript - html2canvas 教程？

> ID：10692468
> 
> 赞同：17
> 
> 时间：2012-05-21T20:53:14.187
> 
> 标签：javascript, html, canvas, screenshot, html2canvas

我想使用 html2canvas 但我不知道如何。

没有冒犯 Hertzen，他编写了一个很棒的脚本，但文档不完整，所以它相当没用。

我查看了 JSFeedback，但整个脚本（我不得不从 HTML 源代码中“窃取”）仅适用于他的 html2canvas 版本，在评论中，他说尚未准备好开源。

任何帮助将不胜感激 - Apparatix。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-11-27T19:44:28.630

试一试——

在您的 index.html 中，添加以下 javascript 文件：

```
<script type="text/javascript" language="javascript" src="js/jquery.js">
</script>
 <script type="text/javascript" language="javascript" src="js/html2canvas.min.js">
</script>
<script type="text/javascript" language="javascript" src="js/jquery.plugin.html2canvas.js">
</script> 
```

您可以从以下位置下载最后两个： [https ://github.com/downloads/niklasvh/html2canvas/v0.34.zip](https://github.com/downloads/niklasvh/html2canvas/v0.34.zip)

然后，您可以在 Javascript 中编写代码（将 #myObjectId 替换为有效的 JQuery 选择器）：

```
$('#myObjectID').html2canvas({
    onrendered : function(canvas) {
    var img = canvas.toDataURL();
    // img now contains an IMG URL, you can do various things with it, but most simply:
        $('<img>',{src:img}).appendTo($('body'));
            }
        }); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-28T13:28:29.973

html2canvas 基本上采用您指定的 DOM 对象中的所有内容 - 所有子对象及其子对象等 - 并根据它们的各种特征（包括边框）将它们复制到 Canvas 对象（在传递给函数的 canvas 变量中）中，内容、样式等。 canvas.toDataURL() 将该 Canvas 的内容转换为代表图像的字符流，该图像可用作标签中的 src，即

```
<img src=imgdataurl> 
```

或通过 javascript/jquery 设置背景图像，如下所示——

```
$('#someDiv').css('background-image','url('+imgdataurl+')') 
```

如果它对您不起作用，则可能是您指定了不正确的父 DOM 元素——您可以尝试使用 $('body') 而不是 $('#myObj') 并查看是否出现任何问题。

# android - 使用 AndroidHttpClient 将不起作用

> ID：10692469
> 
> 赞同：0
> 
> 时间：2012-05-21T20:53:20.517
> 
> 标签：android

我正在尝试使用`AndroidHttpClient`下载 CSV 文件。出于某种原因，它在线路中失败`"HttpResponse response httpClient.execute(httpGet, localContext);`并简单地转到`"finally"`.

我检查了浏览器中的 URL - 它工作正常。

我没有从 HttpResponse 响应中获得任何信息 - 它就像跳过它一样。

我不明白为什么。有任何想法吗？

感谢：D

```
private ArrayList<String> retrieveStockFinParamsFromYahooApiUri(String yahooApiCall)
    {
        ArrayList<String> stockFinParamsFromYahooApiUriRows = new ArrayList<String>();
        String resultLine = "";

        BufferedReader reader = null;
        AndroidHttpClient httpClient = AndroidHttpClient.newInstance("yahooGetStockParams");
        HttpContext localContext = new BasicHttpContext();
        HttpGet httpGet = new HttpGet(yahooApiCall);

        try 
        {
            HttpResponse response = httpClient.execute(httpGet, localContext);              

            reader = new BufferedReader(new InputStreamReader(
                    response.getEntity().getContent()));

            while ((resultLine = reader.readLine()) != null) 
            {
                stockFinParamsFromYahooApiUriRows.add(resultLine);
            }
        }
        catch (IOException e) 
        {
            e.printStackTrace();
        } 
        finally 
        {
            if (reader != null) 
            {
                try 
                {
                    reader.close();
                } 
                catch (IOException e) 
                {
                    e.printStackTrace();
                }
            }
        }

        return stockFinParamsFromYahooApiUriRows;
    } 
```

* * *

进一步调查（05.22.2012）：

@Snicolas - 感谢您的评论。在阅读了您的评论后，我认为问题可能源于我使用模拟器而不是我的实际设备来调试它。我认为模拟器可能会遇到一些连接问题。当我在我的设备上测试它时 - 我注意到问题仍然存在 - 所以这不是问题。

因此，我`catch (Throwable e)`按照您的建议将代码更改为并获得以下堆栈快照：

```
05-22 18:17:41.457: W/System.err(24552): android.os.NetworkOnMainThreadException
05-22 18:17:41.461: W/System.err(24552):    at android.os.StrictMode$AndroidBlockGuardPolicy.onNetwork(StrictMode.java:1099)
05-22 18:17:41.461: W/System.err(24552):    at java.net.InetAddress.lookupHostByName(InetAddress.java:391)
05-22 18:17:41.461: W/System.err(24552):    at java.net.InetAddress.getAllByNameImpl(InetAddress.java:242)
05-22 18:17:41.465: W/System.err(24552):    at java.net.InetAddress.getAllByName(InetAddress.java:220)
05-22 18:17:41.465: W/System.err(24552):    at org.apache.http.impl.conn.DefaultClientConnectionOperator.openConnection(DefaultClientConnectionOperator.java:137)
05-22 18:17:41.465: W/System.err(24552):    at org.apache.http.impl.conn.AbstractPoolEntry.open(AbstractPoolEntry.java:164)
05-22 18:17:41.468: W/System.err(24552):    at org.apache.http.impl.conn.AbstractPooledConnAdapter.open(AbstractPooledConnAdapter.java:119)
05-22 18:17:41.468: W/System.err(24552):    at org.apache.http.impl.client.DefaultRequestDirector.execute(DefaultRequestDirector.java:360)
05-22 18:17:41.468: W/System.err(24552):    at org.apache.http.impl.client.AbstractHttpClient.execute(AbstractHttpClient.java:555)
05-22 18:17:41.472: W/System.err(24552):    at org.apache.http.impl.client.AbstractHttpClient.execute(AbstractHttpClient.java:487)
05-22 18:17:41.472: W/System.err(24552):    at android.net.http.AndroidHttpClient.execute(AndroidHttpClient.java:257)
05-22 18:17:41.472: W/System.err(24552):    at com.bewildering.app.StournamentDbAdapter$YahooStocksParams.retrieveStockFinParamsFromYahooApiUri(StournamentDbAdapter.java:1536)
05-22 18:17:41.476: W/System.err(24552):    at com.bewildering.app.StournamentDbAdapter$YahooStocksParams.run(StournamentDbAdapter.java:1709)
05-22 18:17:41.476: W/System.err(24552):    at com.bewildering.app.StournamentActivity.onCreate(StournamentActivity.java:65)
05-22 18:17:41.476: W/System.err(24552):    at android.app.Activity.performCreate(Activity.java:4465)
05-22 18:17:41.476: W/System.err(24552):    at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1049)
05-22 18:17:41.480: W/System.err(24552):    at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1920)
05-22 18:17:41.480: W/System.err(24552):    at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:1981)
05-22 18:17:41.480: W/System.err(24552):    at android.app.ActivityThread.access$600(ActivityThread.java:123)
05-22 18:17:41.484: W/System.err(24552):    at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1147)
05-22 18:17:41.484: W/System.err(24552):    at android.os.Handler.dispatchMessage(Handler.java:99)
05-22 18:17:41.484: W/System.err(24552):    at android.os.Looper.loop(Looper.java:137)
05-22 18:17:41.484: W/System.err(24552):    at android.app.ActivityThread.main(ActivityThread.java:4424)
05-22 18:17:41.488: W/System.err(24552):    at java.lang.reflect.Method.invokeNative(Native Method)
05-22 18:17:41.488: W/System.err(24552):    at java.lang.reflect.Method.invoke(Method.java:511)
05-22 18:17:41.488: W/System.err(24552):    at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:784)
05-22 18:17:41.492: W/System.err(24552):    at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:551)
05-22 18:17:41.492: W/System.err(24552):    at dalvik.system.NativeStart.main(Native Method) 
```

在查找时，`android.os.NetworkOnMainThreadException`我发现[文档](http://developer.android.com/reference/android/os/NetworkOnMainThreadException.html)指出这是：*当应用程序尝试在其主线程上执行网络操作时引发的异常。*

由此我得出结论，我应该将我的电话放入`AsyncTask`.

谁能确认我正确理解了这一点-或者我在这里遗漏了什么？奇怪的是，我不得不这样`catch (Throwable e)`做才能查明真相。

* * *

进一步调查（05.22.2012）：

我现在可以确认这个问题是由于*应用程序尝试在其主线程上执行网络操作时引发的异常...。*当我[读到](https://stackoverflow.com/questions/5150637/networkonmainthreadexception)这篇文章时，它是从蜂窝开始的。

现在的问题：我收到来自雅虎的 301 响应（永久移动）。这很奇怪，因为当我将 URL 剪切粘贴到浏览器中时，它可以工作。

知道为什么这应该在浏览器中工作而不是在应用程序中工作吗？我必须提到这个 HTTP 请求接收一个 CSV 文件作为响应。这可能是一个问题吗？

* * *

进一步调查（05.23.2012）：

由于某种原因（在我的代码中）使用 Yahoo URI [http://finance.yahoo.com/d/quotes.csv?s=](http://finance.yahoo.com/d/quotes.csv?s=)时，响应是 301（永久移动）。当使用[http://download.finance.yahoo.com/d/quotes.csv?s=](http://download.finance.yahoo.com/d/quotes.csv?s=)时，响应为 200（OK）。即使两者在浏览器中都可以正常工作。我很幸运地找到[了这个网页](http://help.infinitekind.com/discussions/moneydance-development/14-stock-quote-synchronizer-for-stock-options)，它给了我一些关于雅虎对哪些 URI 做出反应的线索。现在我可以看到“阅读器”获取数据，一切都很好。我仍然遇到一些奇怪的异常（仍在试图弄清楚）：在阅读了响应中的所有行之后，我捕获了一个 Throwable（我从之前的实验中留下了它），然后在堆栈中我因此得到`05-23 08:52:41.258: W/dalvikvm(933): threadid=11: thread exiting with uncaught exception (group=0x40a721f8)`了一些关于未捕获的东西中的异常`doInBackground(Void... params)`。还在调查...

刚刚解决了这个问题——这只是调用 Yahoo API 的一个错误。必须将**&e=.csv**添加到 URI 的末尾才能正常工作。就像这样： http: [//download.finance.yahoo.com/d/quotes.csv ?s=KDHIX&f=sl1d1t1c1ohgv&e=.csv](http://download.finance.yahoo.com/d/quotes.csv?s=KDHIX&f=sl1d1t1c1ohgv&e=.csv)

* * *

最终代码

```
private ArrayList<String> retrieveStockFinParamsFromYahooApiUri(String yahooApiCall)
    {
        ArrayList<String> stockFinParamsFromYahooApiUriRows = new ArrayList<String>();
        String resultLine = "";

        BufferedReader reader = null;
        AndroidHttpClient httpClient = AndroidHttpClient.newInstance("yahooGetStockParams");
        HttpContext localContext = new BasicHttpContext();
        HttpGet httpGet = new HttpGet(yahooApiCall);

        try 
        {
            HttpResponse response = httpClient.execute(httpGet, localContext);                  

            reader = new BufferedReader(new InputStreamReader(
                    response.getEntity().getContent()));

            while ((resultLine = reader.readLine()) != null) 
            {
                stockFinParamsFromYahooApiUriRows.add(resultLine);
            }

            if(response != null)
            {
                try
                {
                    response.getEntity().consumeContent();
                }
                catch (IOException e) 
                {
                    e.printStackTrace();
                }

            }
        }
        catch (IOException e) 
        {
            e.printStackTrace();                
        } 
        finally 
        {               
            if(httpClient != null)
            {
                httpClient.close();
            }

            if (reader != null) 
            {
                try 
                {
                    reader.close();
                } 
                catch (IOException e) 
                {
                    e.printStackTrace();
                }
            }
        }

        return stockFinParamsFromYahooApiUriRows;
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T21:21:03.810

您可能会得到一个`Exception`不是`IOException`. 然后，您的`catch`块永远不会被执行，并且您的`finally`块在该方法向`retrieveStockFinParamsFromYahooApiUri`.

您至少有 2 个选项：

*   不要赶上一`IOException`堂课。尝试`Throwable`，打印堆栈跟踪，看看会发生什么。然后您可以稍后添加其他 catch 块来处理该案例。（[*捕捉`Throwables`是一种不好的编程习惯*](https://stackoverflow.com/questions/6083248/is-it-a-bad-practice-to-catch-the-throwable)，但您可以暂时使用）。
*   使用与上述相同的机制将调用`retrieveStockFinParamsFromYahooApiUri`置于 try catch 块中，以确定预期哪些异常类并相应地采取行动。

但是你需要完善你对问题的理解，抓住一切可能的东西，编写堆栈跟踪并检查 logcat。

**以下是一些其他建议：**

*   您需要在阅读其内容之前[检查请求的结果代码。](https://stackoverflow.com/questions/2592843/android-how-get-the-status-code-of-an-httpclient-request)
*   您可以使用[Apache IOUtils](http://commons.apache.org/io/api-1.4/org/apache/commons/io/IOUtils.html#copy%28java.io.Reader,%20java.io.Writer%29)复制响应输入流的内容并将其缓存到文件中。
*   You could [enable gzipping of the request and the response](https://stackoverflow.com/questions/1573391/android-http-communication-should-use-accept-encoding-gzip).
*   You also need to close properly the `HttpConnection` in the finally block, [you can consume the entity of the response](https://stackoverflow.com/questions/4775618/httpclient-4-0-1-how-to-release-connection) to achieve this.

# c++ - 遍历列表时无法获取我的结构的属性

> ID：10692473
> 
> 赞同：0
> 
> 时间：2012-05-21T20:53:54.713
> 
> 标签：c++, list, struct, iterator

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-21T20:55:11.000

你有一个`list<Cell*>`，所以你需要取消引用迭代器*和*指针。

```
for (it = liste.begin(); it != liste.end(); it++)
{
   if ( (*it)->x_ == cell->x_ && (*it)->y_ == cell->y_)
      return true;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-21T21:00:54.290

迭代器类型已`operator ->`重载以返回 Collection 的元素类型。

在你的情况下，这是`Cell*`. `Cell*`是一个指针，而不是 a `Cell`，因此不会被`x`定义。您将需要再次取消引用以获取实际类型。

例如：

```
 if ( (*it)->x_ == cell->x_ && (*it)->y_ == cell->y_) 
```

# ruby-on-rails-3 - Rails 3 - 渲染 JSON 后渲染 JS

> ID：10692476
> 
> 赞同：1
> 
> 时间：2012-05-21T20:54:08.957
> 
> 标签：ruby-on-rails-3, json, rendering

渲染json页面后如何执行jquery js？

```
respond_to do |format|
    format.html
    format.json { render :partial => "tables" }
    format.js
end 
```

tables.json.erb 被渲染，但 js.erb 文件没有。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T03:11:54.513

js.erb 中的代码不会被执行，它是用于 js 响应的。

您应该在 ajax 成功回调函数中编写代码。

例如：

```
$.getJSON('your_request_uri', function(data){
  // write your code here.
}); 
```

# python - Python map() 字典值

> ID：10692482
> 
> 赞同：8
> 
> 时间：2012-05-21T20:54:36.290
> 
> 标签：python, dictionary, lambda

我正在尝试在字典上的函数返回`map()`的对象上使用。但是，我似乎无法完成：`dict_values``values()``map()``dict_values`

```
map(print, h.values())
Out[31]: <builtins.map at 0x1ce1290> 
```

我确信有一个简单的方法可以做到这一点。我实际上想要做的是在字典中创建一个`set()`所有键，做这样的事情：`Counter``Counters`

```
# counters is a dict with Counters as values
whole_set = set()
map(lambda x: whole_set.update(set(x)), counters.values()) 
```

有没有更好的方法在 Python 中做到这一点？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-05-21T21:03:43.367

在 Python 3 中，`map`返回一个迭代器，而不是一个列表。`list`您仍然必须通过显式调用它或将其置于循环中来对其进行迭代`for`。`map`但是无论如何你都不应该使用这种方式。`map`真正用于将返回值收集到可迭代或序列中。由于既不`print`也不`set.update`返回值，`map`因此在这种情况下使用不是惯用的。

您的目标是将所有计数器中的所有键`counters`放入一个集合中。一种方法是使用嵌套生成器表达式：

```
s = set(key for counter in counters.values() for key in counter) 
```

还有可爱的 dict 理解语法，它在 Python 2.7 及更高版本中可用（感谢 Lattyware！）并且可以生成集合和字典：

```
s = {key for counter in counters.values() for key in counter} 
```

这些都大致相当于以下内容：

```
s = set()
for counter in counters.values():
    for key in counter:
        s.add(key) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-03-24T20:32:16.037

你想要所有值的集合并集`counters`？IE，

```
counters[1].union(counters[2]).union(...).union(counters[n]) 
```

? 那只是[functools.reduce](http://docs.python.org/2/library/functools.html)：

```
import functools

s = functools.reduce(set.union, counters.values()) 
```

如果`counters.values()`还没有集合（例如，如果它们是列表），那么您应该首先将它们变成集合。您可以使用[dict 理解](http://legacy.python.org/dev/peps/pep-0274/)来做到这`iteritems`一点，这有点笨拙：

```
>>> counters = {1:[1,2,3], 2:[4], 3:[5,6]}
>>> counters = {k:set(v) for (k,v) in counters.iteritems()}
>>> print counters
{1: set([1, 2, 3]), 2: set([4]), 3: set([5, 6])} 
```

或者当然你可以内联，因为你不关心`counters.keys()`：

```
>>> counters = {1:[1,2,3], 2:[4], 3:[5,6]}
>>> functools.reduce(set.union, [set(v) for v in counters.values()])
set([1, 2, 3, 4, 5, 6]) 
```

# java - 使用 Ajax 刷新 HtmlUnit 表单不起作用

> ID：10692483
> 
> 赞同：2
> 
> 时间：2012-05-21T20:54:43.287
> 
> 标签：java, ajax, htmlunit

我尝试使用 HtmlUnit 填写和提交 HTML 表单。使用 加载一个`select`元素及其选项`<body onLoad="...">`。

**我的问题：**我无法通过 getSelectByName、getChildElements 等检索此元素（引发 ElementNotFoundException），尽管在查看*org.apache.http.wire*日志`select`时可以看到数据已加载。

 *打印时`page.asXml()`，我只看到未更改的 HTML 文档。

我的代码：

```
public static void main(final String[] args) throws Exception {

    final URL url = new URL("http://www.rce-event.de/modules/meldung/annahme.php?oid=471&pid=1&ac=d98482bbf174f62eaaa4664c&tkey=468&portal=www.dachau.de&ortsbox=1&callpopup=1");

    final WebClient webClient = new WebClient(BrowserVersion.FIREFOX_3_6); // tried also FIREFOX_3
    webClient.setAjaxController(new NicelyResynchronizingAjaxController());

    final HtmlPage page = webClient.getPage(url);
    webClient.waitForBackgroundJavaScript(10000); // tried also Thread.sleep()

    // tried also to use webClient.getCurrentWindow().getEnclosedPage() instead of 'page'
    final HtmlForm form = page.getFormByName("formular");

    // ElementNotFoundException thrown here:
    final HtmlSelect select = form.getSelectByName("event.theme");
    final HtmlOption option = select.getOptionByText("Sport/Freizeit");
    final Page newPage = select.setSelectedAttribute(option, false);

    // submit etc.
} 
```

堆栈跟踪：

```
Exception in thread "main" com.gargoylesoftware.htmlunit.ElementNotFoundException: elementName=[select] attributeName=[name] attributeValue=[event.theme]
at com.gargoylesoftware.htmlunit.html.HtmlForm.getSelectByName(HtmlForm.java:449)
at Xyzzy.main(Xyzzy.java:58) 
```

我尝试[了这里](http://htmlunit.sourceforge.net/faq.html#AJAXDoesNotWork)、[这里](https://stackoverflow.com/questions/5555178/htmlunit-doesnt-wait-for-javascript)和[这里](https://stackoverflow.com/questions/7203673/htmlunit-filling-a-form-that-refreshes-automatically)（甚至更多）写的所有内容，但没有任何成功。

**更新：**

我简化了我的代码并开始了赏金。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-30T20:36:58.940

您的问题是，名为“event.theme”的选择仅在名为“event.datapool”的选择的值为“1”时才被加载。

因此，您需要将“event.datapool”选择值更改为“1”：

```
[........]
final HtmlSelect selectBase = form.getSelectByName("event.datapool");
final HtmlOption optionBase = selectBase.getOptionByText("Freizeit / Tourismus");
final Page newPage = selectBase.setSelectedAttribute(optionBase, true);
[........] 
```

但是您可能会遇到问题，因为选择“event.theme”的“HTML”数据是通过 ajax 加载的。所以我不认为你的java“HtmlSelect”类会像Javascript在实际用户交互中那样加载表单中的select“event.theme”。

解决方案是：

```
1\. Load your page "http://www.rce-event.de/modules/meldung/annahme.php?oid=471&pid=1&ac=d98482bbf174f62eaaa4664c&tkey=468&portal=www.dachau.de&ortsbox=1&callpopup=1" 
2\. Load the page "http://www.rce-event.de/modules/meldung/js/xmlhttp_querys.php?get_kat=1&time=1338409551228&id=1&block=kat" > which will return the "event.theme" select data/values
3\. Then use the data loaded in step 2 to update the page loaded in step 1 by inserting a "select list with id and name set to <event.theme>" in the HTML element "kat_content" 
```

然后您的表单/加载的网页应该有名为“event.theme”的新选择，因此以下代码不应再产生错误。

```
final HtmlSelect select = form.getSelectByName("event.theme");
final HtmlOption option = select.getOptionByText("Sport/Freizeit");
final Page newPage = select.setSelectedAttribute(option, false); 
```*

# ipad - 关于可以在 ipad 上导出到 excel 的内容的说明

> ID：10692484
> 
> 赞同：0
> 
> 时间：2012-05-21T20:54:43.497
> 
> 标签：ipad, asp-classic, download

试图修复一个旧的 .asp 站点以在 ipad 上工作。其中一项功能是用户能够将搜索结果下载到 Excel 工作表中。该代码使用：

```
Response.ContentType = "application/vnd.ms-excel"
Response.AddHeader "Content-Disposition", "attachment;filename=results.xls" 
Response.CharSet = "iso-8859-1" 
```

在 ipad 上查看该站点时，当单击带有上面代码的页面的链接时，它什么也不做，只是旋转。是不是我试图将数据导出为ex​​cel，我在一些帖子中读过它是如何编码的！我是否应该转换代码以将结果页面导出为 csv 文件，然后允许用户以他们想要/可用的任何内容打开它？什么是击中最多设备的最佳方法...

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-28T19:08:48.533

在过去，我会遇到同样的情况，所以我做了什么：

文件：下载.ASP

```
<%  
' get the file to download
myFile = request.querystring("File")
myFullPath = "c:\name_folder\" & myFile ' example of full path and filename

' set headers
Response.ContentType = "application/octet-stream"
Response.AddHeader "Content-Disposition", "attachment; filename=" & myFile

' send the file using the stream as

Set adoStream = CreateObject("ADODB.Stream") 
adoStream.Open() 
adoStream.Type = 1 
adoStream.LoadFromFile(myFullPath) 
Response.BinaryWrite adoStream.Read() 
adoStream.Close 
Set adoStream = Nothing
%> 
```

文件：HTML

```
<a href="DOWNLOAD.ASP?File=result.xls">Download Excel file</a> 
```

**此示例完全**使用本机浏览器 Safari 与 Ipad 一起工作。该文件`Result.xls`被下载并加载到查看器中，但无法进行编辑。

我的 iPad 用户使用 App QuickOffice 让文件保存在虚拟文件夹中，重命名文件，删除，......但他们无法编辑文件，该应用程序仅用于管理文件**，不需要下载文件**。

如果您的用户还需要在 iPad 上编辑 XLS 文件，我建议使用（例如）`Google App Document`，它允许用户直接在浏览器中编辑和管理文件。

希望有帮助

# java - ClassNotFoundException 封送 EJB 参数

> ID：10692495
> 
> 赞同：4
> 
> 时间：2012-05-21T20:55:40.853
> 
> 标签：java, jsf, jpa, jboss7.x, ejb-3.0

我正在制作一个具有分布式架构的项目，但在返回`java.util.Collection`客户端应用程序时遇到问题。

我在托管 Bean 中调用 EJB 以带来持久实体的集合。

我正在使用 Java7 和 JBoss7.1.1。

ManagedBean 方法：

```
public Collection<Cliente> getClientes() {

   clientes=new ArrayList<Cliente>();

   try {

   Context ctx = new InitialContext();

   facade = (ClienteFacadeRemote) ctx.lookup(ClienteFacadeBean.NOME_EJB);

   } catch (NamingException e) {

     e.printStackTrace();
   }

   clientes = facade.getCarteira();

   return clientes;

} 
```

EJB 方法：

```
public Collection<Cliente> getCarteira() {
    carteira = clienteDao.read(Cliente.QUERY_ALL);
    return carteira;
} 
```

该`clienteDao.read(Cliente.QUERY_ALL)`方法查找实体并填充集合。然而，回到托管 Bean，我们有堆栈跟踪：

```
javax.faces.el.EvaluationException: java.lang.RuntimeException: ClassNotFoundException marshaling EJB parameters
    javax.faces.component.MethodBindingMethodExpressionAdapter.invoke(MethodBindingMethodExpressionAdapter.java:102)
    com.sun.faces.application.ActionListenerImpl.processAction(ActionListenerImpl.java:102)
    javax.faces.component.UICommand.broadcast(UICommand.java:315)
    javax.faces.component.UIViewRoot.broadcastEvents(UIViewRoot.java:794)
    javax.faces.component.UIViewRoot.processApplication(UIViewRoot.java:1259)
    com.sun.faces.lifecycle.InvokeApplicationPhase.execute(InvokeApplicationPhase.java:81)
    com.sun.faces.lifecycle.Phase.doPhase(Phase.java:101)
    com.sun.faces.lifecycle.LifecycleImpl.execute(LifecycleImpl.java:118)
    javax.faces.webapp.FacesServlet.service(FacesServlet.java:593)
root cause

java.lang.RuntimeException: ClassNotFoundException marshaling EJB parameters
    org.jboss.as.ejb3.remote.LocalEjbReceiver.clone(LocalEjbReceiver.java:229)
    org.jboss.as.ejb3.remote.LocalEjbReceiver.clone(LocalEjbReceiver.java:216)
    org.jboss.as.ejb3.remote.LocalEjbReceiver.processInvocation(LocalEjbReceiver.java:188)
    org.jboss.ejb.client.EJBClientInvocationContext.sendRequest(EJBClientInvocationContext.java:179)
    org.jboss.ejb.client.TransactionInterceptor.handleInvocation(TransactionInterceptor.java:43)
    org.jboss.ejb.client.EJBClientInvocationContext.sendRequest(EJBClientInvocationContext.java:181)
    org.jboss.ejb.client.ReceiverInterceptor.handleInvocation(ReceiverInterceptor.java:128)
    org.jboss.ejb.client.EJBClientInvocationContext.sendRequest(EJBClientInvocationContext.java:181)
    org.jboss.ejb.client.EJBInvocationHandler.doInvoke(EJBInvocationHandler.java:136)
    org.jboss.ejb.client.EJBInvocationHandler.doInvoke(EJBInvocationHandler.java:121)
    org.jboss.ejb.client.EJBInvocationHandler.invoke(EJBInvocationHandler.java:104)
    $Proxy31.getCarteira(Unknown Source)
    br.tcc.faetec.managedbean.ClienteMB.getTeste(ClienteMB.java:316)
    br.tcc.faetec.managedbean.ClienteMB.teste(ClienteMB.java:410)
    sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
    sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
    java.lang.reflect.Method.invoke(Method.java:601)
    org.apache.el.parser.AstValue.invoke(AstValue.java:262)
    org.apache.el.MethodExpressionImpl.invoke(MethodExpressionImpl.java:278)
    com.sun.faces.facelets.el.TagMethodExpression.invoke(TagMethodExpression.java:105)
    javax.faces.component.MethodBindingMethodExpressionAdapter.invoke(MethodBindingMethodExpressionAdapter.java:88)
    com.sun.faces.application.ActionListenerImpl.processAction(ActionListenerImpl.java:102)
    javax.faces.component.UICommand.broadcast(UICommand.java:315)
    javax.faces.component.UIViewRoot.broadcastEvents(UIViewRoot.java:794)
    javax.faces.component.UIViewRoot.processApplication(UIViewRoot.java:1259)
    com.sun.faces.lifecycle.InvokeApplicationPhase.execute(InvokeApplicationPhase.java:81)
    com.sun.faces.lifecycle.Phase.doPhase(Phase.java:101)
    com.sun.faces.lifecycle.LifecycleImpl.execute(LifecycleImpl.java:118)
    javax.faces.webapp.FacesServlet.service(FacesServlet.java:593)
root cause

java.lang.ClassNotFoundException: org.hibernate.collection.internal.PersistentBag from [Module "deployment.external./home/marcos/tccmodel.jar:main" from Service Module Loader]
    org.jboss.modules.ModuleClassLoader.findClass(ModuleClassLoader.java:190)
    org.jboss.modules.ConcurrentClassLoader.performLoadClassUnchecked(ConcurrentClassLoader.java:468)
    org.jboss.modules.ConcurrentClassLoader.performLoadClassChecked(ConcurrentClassLoader.java:456)
    org.jboss.modules.ConcurrentClassLoader.performLoadClass(ConcurrentClassLoader.java:398)
    org.jboss.modules.ConcurrentClassLoader.loadClass(ConcurrentClassLoader.java:120)
    java.lang.Class.forName0(Native Method)
    java.lang.Class.forName(Class.java:264)
    org.jboss.marshalling.cloner.ClassLoaderClassCloner.clone(ClassLoaderClassCloner.java:46)
    org.jboss.marshalling.cloner.SerializingCloner.clone(SerializingCloner.java:158)
    org.jboss.marshalling.cloner.SerializingCloner.clone(SerializingCloner.java:135)
    org.jboss.marshalling.cloner.SerializingCloner.clone(SerializingCloner.java:187)
    org.jboss.marshalling.cloner.SerializingCloner.clone(SerializingCloner.java:135)
    org.jboss.marshalling.cloner.SerializingCloner.cloneFields(SerializingCloner.java:348)
    org.jboss.marshalling.cloner.SerializingCloner.initSerializableClone(SerializingCloner.java:309)
    org.jboss.marshalling.cloner.SerializingCloner.initSerializableClone(SerializingCloner.java:286)
    org.jboss.marshalling.cloner.SerializingCloner.clone(SerializingCloner.java:254)
    org.jboss.marshalling.cloner.SerializingCloner.clone(SerializingCloner.java:135)
    org.jboss.marshalling.cloner.SerializingCloner$StepObjectInput.doReadObject(SerializingCloner.java:738)
    org.jboss.marshalling.AbstractObjectInput.readObject(AbstractObjectInput.java:37)
    org.jboss.marshalling.MarshallerObjectInputStream.readObjectOverride(MarshallerObjectInputStream.java:57)
    java.io.ObjectInputStream.readObject(ObjectInputStream.java:363)
    java.util.ArrayList.readObject(ArrayList.java:733)
    sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
    sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
    java.lang.reflect.Method.invoke(Method.java:601)
    org.jboss.marshalling.reflect.SerializableClass.callReadObject(SerializableClass.java:213)
    org.jboss.marshalling.cloner.SerializingCloner.initSerializableClone(SerializingCloner.java:302)
    org.jboss.marshalling.cloner.SerializingCloner.clone(SerializingCloner.java:254)
    org.jboss.marshalling.cloner.SerializingCloner.clone(SerializingCloner.java:135)
    org.jboss.as.ejb3.remote.LocalEjbReceiver.clone(LocalEjbReceiver.java:225)
    org.jboss.as.ejb3.remote.LocalEjbReceiver.clone(LocalEjbReceiver.java:216)
    org.jboss.as.ejb3.remote.LocalEjbReceiver.processInvocation(LocalEjbReceiver.java:188)
    org.jboss.ejb.client.EJBClientInvocationContext.sendRequest(EJBClientInvocationContext.java:179)
    org.jboss.ejb.client.TransactionInterceptor.handleInvocation(TransactionInterceptor.java:43)
    org.jboss.ejb.client.EJBClientInvocationContext.sendRequest(EJBClientInvocationContext.java:181)
    org.jboss.ejb.client.ReceiverInterceptor.handleInvocation(ReceiverInterceptor.java:128)
    org.jboss.ejb.client.EJBClientInvocationContext.sendRequest(EJBClientInvocationContext.java:181)
    org.jboss.ejb.client.EJBInvocationHandler.doInvoke(EJBInvocationHandler.java:136)
    org.jboss.ejb.client.EJBInvocationHandler.doInvoke(EJBInvocationHandler.java:121)
    org.jboss.ejb.client.EJBInvocationHandler.invoke(EJBInvocationHandler.java:104)
    $Proxy31.getCarteira(Unknown Source)
    br.tcc.faetec.managedbean.ClienteMB.getTeste(ClienteMB.java:316)
    br.tcc.faetec.managedbean.ClienteMB.teste(ClienteMB.java:410)
    sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
    sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
    java.lang.reflect.Method.invoke(Method.java:601)
    org.apache.el.parser.AstValue.invoke(AstValue.java:262)
    org.apache.el.MethodExpressionImpl.invoke(MethodExpressionImpl.java:278)
    com.sun.faces.facelets.el.TagMethodExpression.invoke(TagMethodExpression.java:105)
    javax.faces.component.MethodBindingMethodExpressionAdapter.invoke(MethodBindingMethodExpressionAdapter.java:88)
    com.sun.faces.application.ActionListenerImpl.processAction(ActionListenerImpl.java:102)
    javax.faces.component.UICommand.broadcast(UICommand.java:315)
    javax.faces.component.UIViewRoot.broadcastEvents(UIViewRoot.java:794)
    javax.faces.component.UIViewRoot.processApplication(UIViewRoot.java:1259)
    com.sun.faces.lifecycle.InvokeApplicationPhase.execute(InvokeApplicationPhase.java:81)
    com.sun.faces.lifecycle.Phase.doPhase(Phase.java:101)
    com.sun.faces.lifecycle.LifecycleImpl.execute(LifecycleImpl.java:118)
    javax.faces.webapp.FacesServlet.service(FacesServlet.java:593) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-24T22:13:25.563

`jboss-deployment-structure.xml`在您的 WEB-INF 文件夹中放置一个文件：

```
<?xml version="1.0" encoding="UTF-8"?>
<jboss-deployment-structure>
    <deployment>
        <dependencies>
        <module name="javaee.api" />
        <module name="org.hibernate" />
        </dependencies>
    </deployment>
</jboss-deployment-structure> 
```

# iphone - 将值附加到 NSMutableArray 并保存到 NSUserDefaults

> ID：10692504
> 
> 赞同：1
> 
> 时间：2012-05-21T20:56:02.980
> 
> 标签：iphone, objective-c, ios, xcode, cocoa-touch

我正在为 iPhone 创建一个名称生成器应用程序，这就是我想要做的。

*   允许用户通过单击保存按钮来保存当前生成的名称。

为了做到这一点，下面是正在发生的事情：

*   当前的婴儿名字显示在`UILabel`.
*   用户按下“保存”，然后将 label.text 值附加到 a `NSMutableArray`（我认为这在我的代码中不正确）。
*   然后`NSMutableArray`保存在`NSUserDefaults`.
*   然后将内容加载到另一个视图中以填充`UITableView`单元格。

我的具体问题是，我是否正确处理了这个保存/持久存储过程？这是有问题的片段：

```
- (IBAction)saveName:(id)sender {
// save current baby name to array
NSMutableArray *babyNameArray = [[NSMutableArray alloc] init];

[babyNameArray addObject:babyname.text];

// save list of babynames to nsuserdefaults

[[NSUserDefaults standardUserDefaults] setObject:babyNameArray forKey:@"My Key"];

// for testing log names listed in nsuserdefaults
NSLog(@"%@", [[NSUserDefaults standardUserDefaults] dictionaryRepresentation]);

} 
```

这是整个文件内容的 pastebin 链接（带注释）： http: [//pastebin.com/hQRM9Azh](http://pastebin.com/hQRM9Azh)

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-21T21:06:14.597

每次添加时，您都从一个空数组 ( `[[NSMutableArray alloc] init]`) 重新开始——而不是从现有项目开始。

这是一些添加到现有条目的代码：

```
NSUserDefaults *defaults = [NSUserDefaults standardUserDefaults];
NSMutableArray *babyNameArray = [[defaults stringArrayForKey:@"My Key"] mutableCopy];
if (!babyNameArray) babyNameArray = [[NSMutableArray alloc] init];
[babyNameArray addObject:babyname.text];
[defaults setObject:babyNameArray forKey:@"My Key"];
[defaults synchronize]; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-21T21:06:39.407

在我们开始解决这个大问题之前有几件事。首先，您需要将这些名称数组存储在文件中的某个位置，您将在应用程序启动时或`ViewWillAppear`/中读取这些名称`ViewWillLoad`。

其次，按照您现在的工作方式，您一次只能保存一个名称。每次用户单击“保存名称”按钮时，您分配并初始化一个新的（空）数组。然后将当前名称添加到此（空）数组并将其设置为键“My Key”的对象。请注意，您的“我的钥匙”对象将始终只有一个元素 - 最近保存的名称。

最后，您永远不会真正将更改保存到`NSUserDefaults`. 如果我没记错的话，在您完成更改后，您需要致电`synchronize`- 否则您的更改将在应用程序关闭后立即丢失。哪种方式扼杀了使用数据持久性的全部目的。:)

# ruby-on-rails - Gmail 连接错误 10061 rails 3.2.1

> ID：10692509
> 
> 赞同：0
> 
> 时间：2012-05-21T20:56:44.337
> 
> 标签：ruby-on-rails, devise, gmail

我正在尝试从我的 Rails 3.2 应用程序发送设计确认电子邮件。但是，当它被发送时，我收到以下错误：

> 421 无法连接到 SMTP 服务器，连接错误 10061

我目前在我的环境/development.rb 中使用这些配置设置：

```
config.action_mailer.raise_delivery_errors = true
config.action_mailer.perform_deliveries = true
ActionMailer::Base.smtp_settings = {
    :address        => 'smtp.gmail.com',
    :domain         => 'gmail.com',
    :port           => 587,
    :user_name      => 'emailAdress@gmail.com',
    :password       => 'password',
    :authentication => :plain,
    :enable_starttls_auto => true
} 
```

配置中是否缺少某些内容？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-21T20:58:36.410

我相信如果您是从 localhost 执行此操作，那么您的域是错误的。它应该是这样的：

```
:domain => "localhost.localdomain" 
```

一般来说，你会想要这样的东西：

```
:domain =>'your.host.name' 
```

# jquery - 使用jQuery根据子属性将样式应用于父级？

> ID：10692510
> 
> 赞同：2
> 
> 时间：2012-05-21T20:56:44.957
> 
> 标签：jquery, css

如果元素具有特定属性，如何将样式应用于元素的父级？这是我正在使用的示例...

```
<div>
    <div class="inner"></div>
    <div class="inner"></div>
    <div class="inner"></div>
</div>
<div>
    <div class="inner active"></div>
    <div class="inner"></div>
    <div class="inner"></div>
</div>
<div>
    <div class="inner"></div>
    <div class="inner"></div>
    <div class="inner"></div>
</div> 
```

...当具有“内部”类的子元素也包含“活动”类时，我想将背景颜色应用于 out div。这是我一起破解的 jQuery 解决方案，它似乎不起作用......

```
if ($("div.inner").hasClass("active")) {
    $(this).parent().css("background", "yellow");
}; 
```

有没有人想到一个修复或更好的方法？谢谢。

另外，可选地，我如何让它根据“内部”div中的特定文本应用样式，而不是应用特定的类？再次感谢。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-05-21T20:58:51.187

```
$("div.inner.active").parent().css("background", "yellow"); 
```

jsfiddle：http: [//jsfiddle.net/g4gBx/1/](http://jsfiddle.net/g4gBx/1/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-21T20:59:54.553

还需要注意的是，目前还没有办法根据纯 CSS 中的子元素属性、属性或文本来影响父元素的样式。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-08-08T13:12:38.627

$(".active").parents('div').css("text-align", "center");

# objective-c - Wavefront OBJ 导入到 OpenGL ES 2.0 的问题

> ID：10692516
> 
> 赞同：1
> 
> 时间：2012-05-21T20:57:19.263
> 
> 标签：objective-c, opengl-es, opengl-es-2.0

我终于完成了 Wavefront OBJ 解析器的构建，但在渲染我的测试对象（立方体）时仍然存在一些问题。

所以这就是我将顶点和索引（面）解析为数据数组的方式。我暂时忽略了纹理和法线。

顶点：

```
v -0.307796 0.00433517 0
v 0.299126 0.00433517 0
v 0.299126 0.00433517 0.48337
v -0.307796 0.00433517 0.48337
v -0.307796 0.364153 0.48337
v 0.299126 0.364153 0.48337
v 0.299126 0.364153 0
v -0.307796 0.364153 0 
```

作为：

```
const Vertex Vertices[] = {
    {-0.307796,0.00433517,0},
    {0.299126,0.00433517,0},
    {0.299126,0.00433517,0.48337},
    {-0.307796,0.00433517,0.48337},
    {-0.307796,0.364153,0.48337},
    {0.299126,0.364153,0.48337},
    {0.299126,0.364153,0},
    {-0.307796,0.364153,0}
}; 
```

面孔：

```
f 7/1/1 3/2/2 2/3/3
f 3/4/4 7/5/5 6/6/6
f 5/7/7 1/8/8 4/9/9
f 1/10/10 5/11/11 8/12/12
f 7/13/13 1/14/14 8/15/15
f 1/16/16 7/17/17 2/18/18
f 3/19/19 5/20/20 4/21/21
f 5/22/22 3/23/23 6/24/24
f 5/25/25 7/26/26 8/27/27
f 7/28/28 5/29/29 6/30/30
f 3/31/31 1/32/32 2/33/33
f 1/34/34 3/35/35 4/36/36 
```

作为：

```
const GLubyte Indices[] = {
7,1,1, 3,2,2, 2,3,3,
3,4,4, 7,5,5, 6,6,6,
5,7,7, 1,8,8, 4,9,9,
1,10,10, 5,11,11, 8,12,12,
7,13,13, 1,14,14, 8,15,15,
1,16,16, 7,17,17, 2,18,18,
3,19,19, 5,20,20, 4,21,21,
5,22,22, 3,23,23, 6,24,24,
5,25,25, 7,26,26, 8,27,27,
7,28,28, 5,29,29, 6,30,30,
3,31,31, 1,32,32, 2,33,33,
1,34,34, 3,35,35, 4,36,36
}; 
```

仅作为顶点位置的索引：

```
const GLubyte Indices[] = {
    7, 3, 2, 
    3, 7, 6, 
    5, 1, 4, 
    1, 5, 8, 
    7, 1, 8, 
    1, 7, 2, 
    3, 5, 4, 
    5, 3, 6, 
    5, 7, 8, 
    7, 5, 6, 
    3, 1, 2, 
    1, 3, 4 
}; 
```

设置VBO：

```
GLuint vertexBuffer;
glGenBuffers(1, &vertexBuffer);
glBindBuffer(GL_ARRAY_BUFFER, vertexBuffer);
glBufferData(GL_ARRAY_BUFFER, sizeof(Vertices), Vertices, GL_STATIC_DRAW);

GLuint indexBuffer;
glGenBuffers(1, &indexBuffer);
glBindBuffer(GL_ELEMENT_ARRAY_BUFFER, indexBuffer);
glBufferData(GL_ELEMENT_ARRAY_BUFFER, sizeof(Indices), Indices, GL_STATIC_DRAW); 
```

渲染代码：

```
glClearColor(0, 104.0/255.0, 55.0/255.0, 1.0);
glClear(GL_COLOR_BUFFER_BIT | GL_DEPTH_BUFFER_BIT);
glEnable(GL_DEPTH_TEST);

CC3GLMatrix *projection = [CC3GLMatrix matrix];
float h = 4.0f * self.frame.size.height / self.frame.size.width;
[projection populateFromFrustumLeft:-2 andRight:2 andBottom:-h/2 andTop:h/2 andNear:4 andFar:10];
glUniformMatrix4fv(_projectionUniform, 1, 0, projection.glMatrix);

CC3GLMatrix *modelView = [CC3GLMatrix matrix];
[modelView populateFromTranslation:CC3VectorMake(sin(CACurrentMediaTime()), 0, -7)];
_currentRotation += displayLink.duration * 90;
[modelView rotateBy:CC3VectorMake(_currentRotation, _currentRotation, 0)];
glUniformMatrix4fv(_modelViewUniform, 1, 0, modelView.glMatrix);

// 1
glViewport(0, 0, self.frame.size.width, self.frame.size.height);

// 2
glVertexAttribPointer(_positionSlot, 3, GL_FLOAT, GL_FALSE, sizeof(Vertex), 0);
glVertexAttribPointer(_colorSlot, 4, GL_FLOAT, GL_FALSE, sizeof(Vertex), (GLvoid*) (sizeof(float) * 3));

// 3
glDrawElements(GL_TRIANGLES, sizeof(Indices)/sizeof(Indices[0]), GL_UNSIGNED_BYTE, 0); 
```

结果几乎什么都没有，所以一定有什么我做错了。

此外，由于我没有初始化法线或纹理坐标，索引会导致任何问题吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T21:03:20.500

[Wavefront obj 格式](http://en.wikipedia.org/wiki/Wavefront_OBJ)表示，如果您在面部定义中有 3 的序列，那么它们的含义是：

```
vertex-index/vertex-texture-index/vector-normal-index 
```

您正在将所有索引读入单个数组`GLubyte Indices[]`并使用它，就好像它只是顶点的索引一样。
如果你想取消纹理和法线，你只需要取每个三元组的第一个数字。
在

```
f 6/1/1 3/2/2 2/3/3 7/4/4 
```

面是索引 [6,3,2,7] 的四边形顶点。像你一样使用索引数组需要你告诉 OpenGl 索引以三元组的形式多路复用。你看起来不像那样做。它还需要用于法线和纹理坐标的额外缓冲区。

# json - Google 是否可以读取照片库幻灯片 JSON

> ID：10692519
> 
> 赞同：0
> 
> 时间：2012-05-21T20:57:33.497
> 
> 标签：json, gallery, slideshow, hybrid

我们有一个混合幻灯片，这意味着每张幻灯片都有自己唯一的 URL，但您可以单击整个幻灯片而无需刷新页面。为了实现这一点，我们在每个唯一的 URL 上都有一个 JSON，其中包含所有其他幻灯片的信息，例如标题、子标题、标题和图像 URL。

这会对SEO产生负面影响吗？谷歌会读取 JSON 吗？如果是这样，他们会将其视为冗余数据吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-21T23:17:46.110

目前，这种“单页”架构将对您在 Google 上的排名产生负面影响。

以下是 Google 如何处理 javascript 的两种公众看法：

1) Google 可以抓取一些使用 javascript 提供的内容，但是在 SERP（搜索引擎结果页面）中它的优先级不如在纯 html 页面上提供的内容。

屏幕阅读器（盲人使用）等一些技术不能有效地处理 javascript，并且限制这种性质的应用程序无法渗透到超过 95% 的互联网连接人口。

2）谷歌可以抓取javascript，但他们还没有将它纳入他们的算法，因为他们的技术还没有完全成熟。

我个人属于第一个阵营，并且相信在支持小众群体的辅助网络浏览技术对 javascript 有很好的支持之前，javascript 网站在 SERPS 中不会被视为高度。

只有时间会给出答案 ：）

# c# - WP7 的 C# 节拍器

> ID：10692527
> 
> 赞同：0
> 
> 时间：2012-05-21T20:58:05.973
> 
> 标签：c#, windows-phone-7, windows-phone-7.1

我是一个应用程序开发的新手，对 c# 有*一点*了解。我手头有一些空闲时间，正在考虑学习 WP7 应用程序开发以及 c#。所以，我想我会用 c# 为 WP7 构建一个节拍器应用程序。我认为通过做一个项目来学习对我来说是最有效的。

但是，我还没有找到很多关于如何实现这一点的资源。在网上有很多关于如何在 JS 中构建节拍器的教程，但在 c# 中却没有。所以，如果有人能指出一些资源让我开始，那就太好了。随着我的进步，我会一点一点地努力学习。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-21T20:59:42.030

[http://create.msdn.com/en-US/](http://create.msdn.com/en-US/)您会在这里找到教程、视频和各种其他美好时光。

# windows - 如何在 Windows 上创建符号链接作为原始 Documents and Settings 目录？

> ID：10692530
> 
> 赞同：1
> 
> 时间：2012-05-21T20:58:17.803
> 
> 标签：windows, symlink

我已经阅读了很多关于符号链接（符号链接、连接点、硬链接等）的内容并下载了一些软件来创建符号链接（符号链接创建器、链接外壳扩展），但我无法创建充当原始*文档的符号链接和设置*文件夹！

因此，总的来说，当我打开“D&S”目录时，路径更改为 c:\Users\ 但是当我使用自己创建的符号链接执行此操作时，它就不能以这种方式工作：“c:\test\mylink”< ==> c:\test2\destination\ 路径是：c:\test\mylink\ 但其中包含目标文件夹的文件和文件夹！我希望我已经可以理解地描述了我的问题:)！

提前致谢！

ps：
我尝试了以下 cmd 命令：
- mklink c:\test c:\test2 (works)
- mklink /dc:\test1 c:\test2 (works)
- mklink /jc:\test1 c:\test2 (工作）
- mklink /hc:\test1 c:\test2 （这不起作用并返回“拒绝访问”，因为它只适用于文件）

一个例子：
- 我有这个现有文件夹：c:\test2\
- 里面有一个 readme.txt 文件
- 在 cmd 中写这个： mklink /dc:\test1 c:\test2
- 它创建名为 test1 的链接，当我打开它，我看到了 readme.txt，但路径是“c:\test1”而不是“c:\test2”，这是我想要的！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-22T00:31:47.000

请关注这个帖子： http: [//www.ohmancorp.com/RefWin-Win2008R2-AltProfilesFixJuctions.asp](http://www.ohmancorp.com/RefWin-Win2008R2-AltProfilesFixJuctions.asp)

“我的文档\音乐”连接的示例代码：

```
mklink /J "My Music" "C:\Users\jozjan\Music"
icacls "My Music" /deny everyone:(RD) /L
icacls "My Music" /setowner SYSTEM /L
attrib +S +H +I "My Music" /L 
```

您可以使用“dir /al /s C:\Users\Default”检查默认情况下必须重新创建哪些连接。上面的链接上有一个脚本可以很好地帮助我们。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-21T21:45:54.050

好的，您想要复制与文档和设置相同的条件。从使用连接点开始：

```
 mklink /J c:\test3 c:\test2 
```

使其成为系统并隐藏：

```
 attrib +H +S c:\test3 
```

然后更改权限：

```
 icacls c:\test3 /deny *S-1-1-0:(S,RD) 
```

如果这不起作用，则 Total Commander 可能会将 Documents and Settings 视为特殊情况。如果供应商有支持论坛，您可以在那里询问。可能有一些方法可以将其配置为对其他文件夹执行相同的操作。

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2012-05-21T21:01:27.223

Windows 没有符号链接或硬链接。它有快捷方式，*有点*像符号链接。恐怕你运气不好。

**编辑：**

正如已经向我指出的那样，Windows*确实*支持符号链接。有关详细信息，请参阅评论。但是，对于您正在做的事情，您错过了符号链接的意义。

将目录视为存储桶。你有很多这样的。他们每个人在桶的侧面都有一个名字，其他桶有带有这些名字的纸条。纸条*不是*水桶。他们只是有一个桶的名字。

既然如此，你可以在纸的正面写任何名字，*在*背面写真名。Total Commander 在其当前使用的纸条正面报告名称，该名称可能是也可能不是实际名称。*但是*，它会将您指向具有真实名称的存储桶。

对于您想要的，只需创建一个与您想要的位置同名的符号链接，只要它们没有相同的父文件夹，就可以了。

```
Good:
mklink /D c:\stuff\test2 c:\test2

Bad:
mklink /D c:\test2 c:\test2 
```

# magento - 我们在哪里可以修改 Magento 中页脚的默认链接？

> ID：10692535
> 
> 赞同：0
> 
> 时间：2012-05-21T20:58:36.987
> 
> 标签：magento, footer, magento-1.6

我想摆脱我网站页脚中的链接，有人启动了该网站的开发并离开了，现在我无法修改它，因为当我在 footer.phtml 中时，我可以看到该代码：

```
<!-- Footer -->
<div id="footer">
    <ul>
        <li><?php echo $this->getCopyright(); ?></li>
    </ul>
    <?php echo Mage::getModel('core/variable')->loadByCode('footer_navigation')->getValue('html'); ?>
    <div class="cl">&nbsp;</div>
</div>
<!-- /Footer --> 
```

我找不到那个班级正在寻找链接的地方`Mage::getModel('core/variable')->loadByCode('footer_navigation')->getValue('html')`

我一直在寻找我找到的catalog.xml，`<reference name="footer_links">`但如果我删除里面的代码，什么也没有发生，它似乎没有以任何方式与之链接。

我在我的菜单中遇到了同样的问题，我看到我不明白的那个类：`$categories = $this->renderCategoriesMenuHtmlCustom2(0, 'level-top');`那也指的是哪里？

谢谢 ：）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-22T03:25:32.387

登录到您的管理面板并转到系统-> 自定义变量。您应该在那里找到页脚链接。您可以通过此处删除链接（通过删除 HTML 和纯文本字段），或者通过取出加载页脚链接变量的代码段（调用 的行`loadByCode('footer_navigation')`）。

您也可以通过管理面板删除该变量，但如果这样做，您还应该删除调用它的代码；它不会崩溃，但可能会导致混乱。

# xml - IE 7/8 XML 渲染/XML-查看器

> ID：10692537
> 
> 赞同：1
> 
> 时间：2012-05-21T20:58:49.110
> 
> 标签：xml, internet-explorer, internet-explorer-8, internet-explorer-7, rendering

我已经浏览了 IE7/IE8 中的几乎所有设置，但我似乎找不到它。我已经用谷歌搜索并搜索了所有的东西，唉，我在 StackOverflow 上问，什么应该是一个简单的问题：

如何在 IE 中禁止将 XML 文档呈现为 HTML 树结构？这甚至可能吗？我宁愿 IE 只显示所有 XML，而不是每个父节点旁边的树视图 +/- 按钮。

一定有办法！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-07-10T15:22:53.553

这里有几种方法：

*   将文件扩展名更改为`.txt`

*   通过处理指令添加样式表

*   完全删除文件扩展名

*   将文件编码为 base64 字符串，然后[通过 CSS将其包含为](http://en.wikibooks.org/wiki/Cascading_Style_Sheets/MHTML_URIs)[MHTML URL](http://msdn.microsoft.com/en-us/library/aa579605)

*   删除 msxml.dll

**参考**

*   [Microsoft XML Parser (MSXML) 版本列表](http://support.microsoft.com/kb/269238)

*   [将样式表与 XML 文档相关联](http://www.w3.org/TR/xml-stylesheet/)

# c# - 如何在 C# 中创建 lua 样式的函数表？

> ID：10692540
> 
> 赞同：1
> 
> 时间：2012-05-21T20:58:52.747
> 
> 标签：c#, delegates, anonymous-function

在 lua 中，可以很容易地创建一个表并向其添加函数。

我如何在 C# 中做到这一点？我的第一个想法是使用委托列表并用匿名函数填充列表，但我无法正确使用语法。

```
public class PlanItem
{
    public string Name { get; set; }   
    public List<BusinessRule> Rules;
}

public delegate bool BusinessRule(PlanItem item);

[Test]
public void TestIt()
{
    PlanItem item = new PlanItem();
    item.Rules.Add(
        BusinessRule(PlanItem item)
        {
            return !string.IsNullOrEmpty(item.Name);
        }
    );

   foreach(BusinessRule rule in item.Rules)
   {
     if(!rule(item))
         // write uh-oh
   }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-21T21:02:57.267

这应该可以解决问题：

```
 item.Rules.Add((planItem) => 
 { 
     return !string.IsNullOrEmpty(planItem.Name); 
 }); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-21T21:11:02.113

```
public void TestIt()
{
    PlanItem item = new PlanItem();
    item.Rules.Add( (item) => {  !string.IsNullOrEmpty(item.Name); });
    item.Rules.ForEach( (rule) => { if(!rule(item) uhOh(item, outputStream);} );
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-21T21:21:44.307

在没有匿名委托的 C# 2.0 中：

```
BusinessRule rule = delegate(PlanItem planitem) {
    return !string.IsNullOrEmpty(planitem.Name);
};
item.Rules.Add(rule); 
```

# c# - 如何在二维（C#）中找到直线与椭圆相交的点

> ID：10692541
> 
> 赞同：2
> 
> 时间：2012-05-21T20:59:04.180
> 
> 标签：c#, math, geometry, trigonometry, ellipse

我需要找到一条线（其原点是椭圆的中心）与二维椭圆相交的点...我可以很容易地在圆上找到一个点，因为我知道角度 F 和圆的半径（R）：

```
x = x0 + R * cosF
y = y0 + R * sinF 
```

但是我只是不知道我应该如何处理椭圆......我知道它的尺寸（A＆B），但是找到参数T的方法是什么？！

```
x = x0 + A * cosT
y = y0 + B * sinT 
```

据我了解，参数 T（T 角）与 F 角相差不远（在某些情况下约为 +-15 度），但我就是不知道如何计算它！！！

如果有好心人，请帮我解决这个问题...

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-21T21:18:54.590

椭圆的标准方程，位于 0,0，为：

```
1 = (x)^2 / (a)    +  (y)^2 / (b) 
```

其中 a 为横轴直径的 1/2，b 为纵轴直径的 1/2。

你有一条线，假设一个方程：

```
y = (m)(x - x0) + y0 
```

所以，让我们即插即用！

```
1 = (x)^2 / (a)   +   (m(x - x0) + y0)^2 / (b)

1 = x^2 / a  +  (mx + (y0 - mx0))^2 / b

1 = x^2 / a  +  (m^2 * x^2 + 2mx*(y0 - mx0) + (y0 - mx0)^2) / b

1 = x^2 / a  + (m^2 x^2) / b + (2mx*(y0 - mx0) + (y0^2 - 2y0mx0 + m^2*x0^2)) / b

1 = ((x^2 * b) / (a * b)) + ((m^2 * x^2 * a) / (a * b)) + (2mxy0 - 2m^2xx0)/b + (y0^2 - 2y0mx0 + m^2*x0^2)/b

1 = ((bx^2 + am^2x^2)/(ab)) + (x*(2my0 - 2m^2x0))/b + (y0^2 - 2y0mx0 + m^2*x0^2)/b

0 = x^2*((b + a*m^2)/(ab)) + x*((2my0 - 2m^2x0)/b) + (((y0^2 - 2y0mx0 + m^2*x0^2)/b) - 1) 
```

最后一个方程遵循标准二次方程的形式。

因此，只需使用二次公式：

```
((b + a*m^2)/(ab))
((2my0 - 2m^2x0)/b)
and 
(((y0^2 - 2y0mx0 + m^2*x0^2)/b) - 1) 
```

获取交叉点的 X 值；然后，将这些值代入原始直线方程以获得 Y 值。

祝你好运！

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-21T21:05:10.000

不要这样做。而是检查形成椭圆和形成直线的方程并求解集合：

椭圆： `(x/a)^2 + (y/b)^2 = 1` 你的线： `y = cx`

您知道 a、b 和 c，因此找到解决方案将很容易。您会找到两种解决方案，因为该线两次穿过椭圆。

编辑：注意我把你的椭圆中心移到了（0,0）。它使一切变得更容易。只需将 (x0,y0) 添加到解决方案中。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-09-06T19:36:55.900

我为您的问题编写了 C# 代码，希望对您有所帮助。此代码中的距离函数计算空间中两点之间的欧几里得距离。

`wX`表示椭圆的水平无线电并`wY`表示垂直无线电。

```
private PointF LineIntersectEllipse(PointF A, PointF B, float wX, float wY)
{
      double dx = B.X - A.X;
      double dy = B.Y - A.Y;
      double theta = Math.Atan2(dy, dx);
      double r = distance(A, B) - ((wX * wY) / Math.Sqrt(Math.Pow(wY * Math.Cos(theta), 2) + Math.Pow(wX * Math.Sin(theta), 2)));
      return PointF((float)(A.X + r * Math.Cos(theta)), (float)(A.Y + r * Math.Sin(theta)));
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2020-05-13T20:51:43.540

[![预览](../Images/f97192a32d2205d2a8d38eaed7dccd0b.png)](https://i.stack.imgur.com/Tp7uJ.gif)

```
public Hits<float2> EllipseLineIntersection ( float rx , float ry , float2 p1 , float2 p2 )
{
    Hits<float2> hits = default(Hits<float2>);
    float2 p3, p4;
    Rect rect = default(Rect);
    {
        rect.xMin = math.min(p1.x,p2.x);
        rect.xMax = math.max(p1.x,p2.x);
        rect.yMin = math.min(p1.y,p2.y);
        rect.yMax = math.max(p1.y,p2.y);
    }

    float s = ( p2.y - p1.y )/( p2.x - p1.x );
    float si = p2.y - ( s * p2.x );
    float a = ( ry*ry )+( rx*rx * s*s );
    float b = 2f * rx*rx * si * s;
    float c = rx*rx * si*si - rx*rx * ry*ry;

    float radicand_sqrt = math.sqrt( ( b*b )-( 4f * a * c) );
    p3.x = ( -b - radicand_sqrt )/( 2f*a );
    p4.x = ( -b + radicand_sqrt )/( 2f*a );
    p3.y = s*p3.x + si;
    p4.y = s*p4.x + si;

    if( rect.Contains(p3) ) hits.Push( p3 );
    if( rect.Contains(p4) ) hits.Push( p4 );
    return hits;
}
public struct Hits<T>
{
    public byte count;
    public T point0, point1;
    public void Push ( T val )
    {
        if( count==0 ) { point0 = val; count ++; }
        else if( count==1 ) { point1 = val; count ++; }
        else print("This structure can only fit 2 values");
    }
} 
```

# rspec - 使用 Rspec 测试给定的选择器不包含任何内容（即为空）

> ID：10692542
> 
> 赞同：0
> 
> 时间：2012-05-21T20:59:12.167
> 
> 标签：rspec, integration-testing, webrat

我试图让 RSpec 集成测试失败。

给定以下 HTML 片段：

```
<article id="content">  
  <section>    
    <p>There aren't any travel promotions... yet!</p>
  </section>
</article> 
```

当我运行以下 Rspec 测试时：

```
describe SomeController do
  render_views

  describe "GET 'promotion_index'" do
    it "should display an empty page given a blank page fragment and no promotions " do
      get :promotion_index
      response.should have_selector("#content section:first-of-type", :content => "")
    end
  end
end 
```

那么测试应该失败

但事实并非如此。无论选择器中是否有内容，它都会很好地传递。

为了清楚起见，我不想测试`<p>`内容不存在。我想测试`<article id="content"><section /></article>`根本不包含任何内容。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-07T23:59:12.177

Are you talking about making sure there are no child tags or there is no text in the middle? I don't use RSpec's have_selector method. I also couldnt' get it to work. I just use Nokogiri. You just pass in the rendered object into Nokogiri::HTML(rendered) like this and just parse the HTML to test. It's quite simple.

Give it a try.

```
html = Nokogiri::HTML(rendered)
html.xpath("//[@id='content']/section").each do |node|
 node.children_should be_empty?
end 
```

Something like that. I'm not exactly sure.

# ios - 我可以防止 RestKit+CoreData 覆盖本地实体更改吗？

> ID：10692550
> 
> 赞同：2
> 
> 时间：2012-05-21T20:59:48.670
> 
> 标签：ios, core-data, restkit

我已经配置了一个`RKObjectMappingProvider`带有一系列对象映射的子类，这些对象映射将各种服务端点映射到我的本地核心数据实体和持久存储。假设我有一个服务端点`/api/workorders`，我用它`loadObjectsAtResourcePath:usingBlock:`来获取 X 工作订单列表并持久保存到核心数据。接下来，用户使用应用程序修改其中 2 个实体，但不将更改推送回服务。

如果用户再次调用`/api/workorders`以获取最新的工单，是否有办法不让 RestKit 自动覆盖对已更改实体的本地修改？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T14:08:28.920

简短的回答是否定的，你必须自己做，它很快就会变得讨厌。

您需要覆盖自定义托管对象类的设置器。

[这种事。](https://stackoverflow.com/questions/7914151/core-data-implementing-a-custom-to-one-relationship)

您需要一个属性才能知道它已被更新。您需要在实体更新时创建并设置它。我会在行级别执行此操作，然后检查属性并仅在未设置标志时更新。当然，如果用户想再次更新值，您需要处理这种情况:) Restkit 很棒，但不会为您处理完全同步。

# c++ - “typedef void VOID”中内置的“void”和“VOID”有什么区别？

> ID：10692559
> 
> 赞同：-1
> 
> 时间：2012-05-21T21:00:32.073
> 
> 标签：c++, typedef, void

偶然我有以下问题：

```
typedef void VOID;

class Cls1
｛
public:
  VOID Clear(VOID);
}; 
```

并且编译器（g++ 4.6.1）报告了

> 错误：'匿名'的类型不完整错误：'无效使用'VOID {aka void}'

“无效”与“无效”有什么不同吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-21T21:02:12.293

好的，clang 编译器给出了一个更易读的错误：

> test.cpp:14:20：错误：在 C++ 中不允许使用 typedef 为“void”定义的空参数列表 void Clear(VOID)；

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-21T21:02:51.510

没有什么不同。

在 C++ 中，空参数列表是空的，而不是“void”。

# java - 排序的 ArrayList 不显示？

> ID：10692561
> 
> 赞同：0
> 
> 时间：2012-05-21T21:00:47.093
> 
> 标签：java, arrays, list, sorting

```
ArrayList <String> cdcollection = new ArrayList();

private void initButtonActionPerformed(java.awt.event.ActionEvent evt) {
    Collections.addAll(cdcollection, "renier\n",  "mert\n", "rain\n", "mylen", "dreb\n"    );
    initButton.setEnabled(false);
}

private void displayButtonActionPerformed(java.awt.event.ActionEvent evt) {

    String title1 = "Original Order\n\n";
    String title2 = "Sorted Order\n\n";

    String collection = "";
    for (int i = 0; i < cdcollection.size(); i++)  {
        collection = collection + cdcollection.get(i);
    }
    mainTextArea.setText(title1 + collection);

    Collections.sort(cdcollection);

    for (int j = 0; j < cdcollection.size(); j++)  {
        mainTextArea.setText(title2 + collection.get(j));
    }
}

private void addButtonActionPerformed(java.awt.event.ActionEvent evt) {
    cdcollection.add(cdtitleInput.getText());
}

private void removeButtonActionPerformed(java.awt.event.ActionEvent evt) {
    cdcollection.remove(cdcollection.size()-1);
} 
```

对于这一行 mainTextArea.setText(title2 + collection.get(j)); 我收到一个错误“找不到符号”，并且在我运行程序时它不显示。我所看到的只有这样：

原始订单

雷尼尔·梅特 ·雷恩·
迈伦 ·德雷布

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-21T21:07:11.773

您已定义`collection`为一个字符串，如`String collection = "";`. `get(j)`String 类中没有调用方法。尝试使用您的 arraylist 对象`cdcollection`。还承担了arraylist的创建。您已经完成了 like `ArrayList <String> cdcollection = new ArrayList();`，尝试在 like 两边都使用泛型`ArrayList <String> cdcollection = new ArrayList<String>();`，否则您可能会收到不必要的警告。

编辑：

```
public static void main(String[] args){
    ArrayList<String> cdcollection = new ArrayList();
    Collections.addAll(cdcollection, "renier\n", "mert\n", "rain\n",
            "mylen", "dreb\n");

    String title1 = "Original Order\n\n";
    String title2 = "Sorted Order\n\n";

    String collection = "";
    for (int i = 0; i < cdcollection.size(); i++) {
        collection = collection + cdcollection.get(i);
    }
    System.out.println(title1 + collection);

    Collections.sort(cdcollection);
    System.out.println(cdcollection);
} 
```

# yahoo-pipes - 如何在 Yahoo 地图描述框中嵌入 Youtube 视频 - Yahoo!Pipes

> ID：10692567
> 
> 赞同：0
> 
> 时间：2012-05-21T21:01:16.317
> 
> 标签：yahoo-pipes

如何在 Yahoo 地图描述框中嵌入 Youtube 视频（位置提取器输出） - Yahoo!Pipes thanxs

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-21T23:46:31.277

**[在Yahoo Maps API](http://developer.yahoo.com/maps/flash/jsGettingStarted.html)**的 javascript 中，有一个名为**onMapInit(eventObj)**的函数，名为“ *marker* ”的变量包含一个包含弹出窗口的文本或 HTML 代码的数组。盒子本身的大小由 Yahoo 保存的外部 CSS 文件控制，但是通过在页面中为名为“ *hover* ”或“*.hov​​er_content*”的类创建一个本地 CSS 条目（我忘记了他们现在叫什么）您应该能够控制并使其足够大以容纳视频。

# php - 向 URL 添加额外页面

> ID：10692574
> 
> 赞同：0
> 
> 时间：2012-05-21T21:01:37.767
> 
> 标签：php, arrays

抱歉标题含糊不清，我不知道如何更好地解释它。

我有一个带有这样链接的数组：

```
Array
(
    [0] => http://www.example.com/page.php?page=2
    [1] => http://www.example.com/page.php?page=3
    [2] => http://www.example.com/page.php?page=4
) 
```

很好，但我也需要第一页`?page=1`。解决这个问题的最佳方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-21T21:03:16.597

[`array_unshift()`](http://php.net/manual/en/function.array-unshift.php)将一个或多个值添加到数组的开头。

```
array_unshift( $urls, "http://www.example.com/page.php?page=1" ); 
```

### 示例和输出：

```
// Start with our array (simplified version of yours)
$urls = array( "page=2", "page=3", "page=4" );

// Output: page=2, page=3, page=4
echo join( ", ", $urls );

// Prepend our new value
array_unshift( $urls, "page=1" );

// Output: page=1, page=2, page=3, page=4
echo join( ", ", $urls ); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-21T21:07:16.363

不知道我们的意思是否相同，但将数组中的条目向下推并在顶部添加新页面

```
array_splice 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-21T21:10:06.393

```
<?php
     $queue = array("http://www.example.com/page.php?page=1");
     array_unshift($queue, "http://www.example.com/page.php?page=2", "http://www.example.com/page.php?page=3", "http://www.example.com/page.php?page=4");
     print_r($queue);
 ?> 
```

# linq-to-sql - Linq to SQL，插入带有外键的行

> ID：10692576
> 
> 赞同：1
> 
> 时间：2012-05-21T21:01:51.557
> 
> 标签：linq-to-sql, foreign-keys

我找到了这个关于如何在我的表中添加项目的 URL。 [http://msdn.microsoft.com/en-us/library/bb386941.aspx](http://msdn.microsoft.com/en-us/library/bb386941.aspx)

```
// Create a new Order object.
Order ord = new Order
{
    OrderID = 12000,
    ShipCity = "Seattle",
    OrderDate = DateTime.Now
    // …
}; 
```

这应该没有任何问题

但如果我有这样的事情：

```
// Create a new Order object.
Order ord = new Order
{
    OrderID = 12000,
    CustomerID = 22, // where CustomerID is a foreign key to table Customer
    ShipCity = "Seattle",
    OrderDate = DateTime.Now
    // …
}; 
```

然后它会给出如下错误：异常详细信息：System.Data.SqlClient.SqlException：INSERT 语句与 FOREIGN KEY 约束“FK7_REVIEW”冲突。冲突发生在数据库“Dbname”、表“dbo.Customer”、列“CustomerID”中。该语句已终止。

如何使用外键在表中插入一行？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T21:07:12.210

`Order.CustomerID`指另一个表中的主键（比如`Customer`）。要插入新订单，`CustomerID`必须等于`Customer`表中主键的现有值。

# cocoa - UAZoomEnabled 通知

> ID：10692582
> 
> 赞同：0
> 
> 时间：2012-05-21T21:02:48.173
> 
> 标签：cocoa, accessibility

目前我的应用程序正在轮询和检查 UAZoomEnabled() 以确定缩放状态是否已更改。是否有任何我可以订阅的通知会通知我？

谢谢！！

# c# - 如何在 C# 程序和 Node.js 程序之间使用 Msgpack？

> ID：10692586
> 
> 赞同：1
> 
> 时间：2012-05-21T21:03:10.497
> 
> 标签：c#, node.js, serialization, zeromq, msgpack

我已经成功地通过 ZMQ 使用同一类从 C# 和 C++ 程序传输数据，其中 C++ 类是数据定义，幸运的是编译器将字节数组屏蔽到类。

我将如何在 C# 和 Node.js 程序之间做同样的事情？我认为他们需要某种类型的中间数据定义。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-26T17:48:40.147

首先查看[github上的node-msgpack存储库](https://github.com/pgriess/node-msgpack)......然后安装它......`npm install msgpack`

还有[msgpack-js](https://github.com/creationix/msgpack-js)一个全 js 实现，它可能会更好，特别是如果你在 Windows 上运行。`npm install msgpack-js`

我建议小心使用的类型，因为 JS 与 msgpack 或 CLI 没有 1:1 的关系。它*应该*很好地映射，尽管 C# MsgPack API 不如 JSON.Net 灵活。 至于传输，您可以使用管道/套接字或 MQ 系统，正如您提到的 ZeroMQ。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-04T18:07:37.930

答案是您需要一个[IDL](http://en.wikipedia.org/wiki/Interface_description_language)，然后将其编译为您的给定语言，除非您的语言默认打包类似，例如在 C 到 C++ 中。

[如果您需要 msgpack IDL，请查看此处](https://github.com/msgpack/msgpack-idl)或[此处](https://github.com/msgpack/msgpack-haskell/tree/master/msgpack-idl)是否可用

# ios - MKAnnotations 未正确重新加载

> ID：10692592
> 
> 赞同：0
> 
> 时间：2012-05-21T21:03:24.303
> 
> 标签：ios, ipad, mkmapview, mkannotation

MKAnnotation 遇到问题。有一个自定义的 pinview 并且在第一次加载时工作正常。去移除别针，然后重新加载它们改变颜色的相同别针。我添加了来自两个不同数据库的引脚并且工作得很好。一旦删除然后分别添加每个阵列，第二个阵列将采用第一个阵列自定义引脚而不是分配的引脚。

```
- (MKAnnotationView *)mapView:(MKMapView *)mapview viewForAnnotation:(id   <MKAnnotation>)annotation
{

MKAnnotationView *pinView = nil; 
if(annotation != mapView.userLocation) 
{
    static NSString *defaultPinID = @"pin";
    pinView = (MKAnnotationView *)[mapView dequeueReusableAnnotationViewWithIdentifier:defaultPinID];
    if ( pinView == nil ) 
        pinView = [[MKAnnotationView alloc]
                   initWithAnnotation:annotation reuseIdentifier:defaultPinID];

    UIButton* rightButton = [UIButton buttonWithType:UIButtonTypeDetailDisclosure];
    [rightButton setTitle:annotation.title forState:UIControlStateNormal];
    [rightButton addTarget:self
                    action:@selector(showDetails:)
          forControlEvents:UIControlEventTouchUpInside];
    pinView.rightCalloutAccessoryView = rightButton;

    UIImageView *profileIconView = [[UIImageView alloc] initWithImage:[UIImage imageNamed:@"stores.png"]];
    pinView.leftCalloutAccessoryView = profileIconView;

    NSString *badgestringss = @"8 reviews";
    customBadge1 = [CustomBadge customBadgeWithString:badgestringss 
                                      withStringColor:[UIColor whiteColor]
                                       withInsetColor:RGB(255, 51, 0)
                                       withBadgeFrame:YES 
                                  withBadgeFrameColor:[UIColor whiteColor] 
                                            withScale:1.0
                                          withShining:YES];
    [customBadge1 setFrame:CGRectMake(100, 1, 85, 15)];
    [pinView.leftCalloutAccessoryView addSubview:customBadge1];

    if(setStoreOrShops==NO){
    pinView.image = [UIImage imageNamed:@"stores.png"];    //as suggested by Squatch  
    }
    else if (setStoreOrShops==YES){
         pinView.image = [UIImage imageNamed:@"shops.png"];   
    }

   else {
    [mapView.userLocation setTitle:@"Current Location"];
}
     }
return pinView;
} 
```

已经到处搜索，但似乎无法找到一个可以工作的例子或一个问题所在的想法。谢谢你的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T21:28:28.677

我不确定您所说的更改颜色是什么意思，因为我不知道您的 CustomBadge 代码是做什么的或您的图像是什么样的。但是，问题可能是您在视图的初始设置中应用了条件逻辑。后来，当 dequeReusableAnnotationViewWithIdentifier: 实际返回某些内容时，它已被配置为其他内容。

```
- (MKAnnotationView *)mapView:(MKMapView *)mapView viewForAnnotation:(id<MKAnnotation>)annotation {

    MKAnnotationView *pinView = (MKAnnotationView *)[mapView dequeueReusableAnnotationViewWithIdentifier:@"default"];
    if (pinView == nil) {
        // CONFIGURE ONCE
        // things that are set up once and never change
    }

    // CONFIGURE EVERY VIEW
    // view configurations that change every pin
} 
```

您需要将设置图像的代码从“配置一次”部分中取出，并将其放入“为每个视图配置”部分。否则，每次您调用出列可重用视图时，您都会得到配置不正确的内容。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-22T21:17:50.763

用这种方式修好了

```
MyAnnotation *myAnnot = (MyAnnotation *)annotation;

if (myAnnot.mappin == @"42")
    customPinView.image = [UIImage imageNamed:@"shops.png"];
else
    customPinView.image = [UIImage imageNamed:@"stores.png"]; 
```

# appcelerator-mobile - 是否可以使用 Appcelerator 和 Rhomobile 构建离线应用程序？

> ID：10692595
> 
> 赞同：0
> 
> 时间：2012-05-21T21:03:40.170
> 
> 标签：appcelerator-mobile, rhomobile, offlineapps

我最近发现了这两个用于跨移动开发的相似解决方案/IDE：Appcelerator 和 Rhomobile（我知道还有更多），我对这两个平台有疑问：

1) 我相信构建视图的唯一方法是使用 HTML，我非常喜欢这些想法。但是，这是否意味着如果手机离线，应用程序本身不可用？

2) 你们知道是否可以将应用程序发布到 App Store 和 Google Store 吗？

3) 是否有适用于不同移动设备的模拟器，它们是否支持所有这些幻灯片/标签事件？

4）最后，有没有一种方法可以在您的手机上传输应用程序而无需在任何地方发布它。

请注意，我对移动应用程序开发一无所知，这两个解决方案（Appcelerator、Rhomobile）对我来说是完美的，因为我熟悉 Javascript 和 HTML。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-23T09:49:00.687

好的，我只使用了 appcelerator 但是：

1) webview 就像一个没有地址栏的浏览器，它只是解析 HTML，从哪里获取它取决于你。如果您编写好 HTML 并传入一个文件，那么是的，它可以离线，如果它用于解析来自网页的响应，那么不是，因为它需要向网页发送 http 请求。

正如许多人似乎错误的那样（出于我不知道的原因，因为所有文档都说明了其他方式），appcelerator 与 phonegap 不同，appcelerator 使用自己的基于 javascript 的 API 来允许开发人员制作原生应用程序，它不是 webview包装。默认情况下它是离线的，如果你需要在线的东西，它允许你发送 http 请求。

2) 是的，您可以从 appcelerator 发布到应用商店和谷歌商店，文档将引导您完成整个过程。

3) Appcelerator 要求您下载模拟器附带的 IOS sdk 或 Android SDK，appcelerator / 模拟器支持这些设备上的标准事件。

4) 使用 Android 可以构建一个 .apk 文件并随心所欲地分发，使用 IOS 的唯一方法是发布到应用商店。唯一的另一种方法是制作移动网站而不是应用程序

# jquery - 如何在没有滚动条的jquery中获取元素的innerWidth

> ID：10692598
> 
> 赞同：8
> 
> 时间：2012-05-21T21:04:13.100
> 
> 标签：jquery, width

给定一个包含滚动条的 div（例如溢出的 b/c：auto），我如何获得元素的准确内部宽度？在我的示例中：http: [//jsfiddle.net/forgetcolor/2J7NJ/](http://jsfiddle.net/forgetcolor/2J7NJ/) width 和 innerWidth 报告相同的宽度。我想要的数字应该小于 100。

HTML：

```
<div id='box1'>
<div id='box2'>
</div>
</div>
<p id="w"></p>
<p id="iw"></p>​ 
```

CSS：

```
#box1 { 
    width:100px;
    height:100px;
    overflow:auto;
}

#box2 {
    width:200px;
    height:200px;
    background-color:#aaa;
} 
```

Javascript：

```
$('#w').text("width is: "+$('#box1').width());
$('#iw').text("inner width is: "+$('#box1').innerWidth());​ 
```

更新：

当 box2 div 包含大图像时，我需要它来工作（因此，加载需要一秒钟）。这是一个示例，集成了以下解决方案之一（Lukx'），但不起作用：http: [//jsfiddle.net/forgetcolor/rZSCg/1/](http://jsfiddle.net/forgetcolor/rZSCg/1/)。任何想法如何让它在计算宽度之前等待图像加载？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-05-21T21:29:24.327

通过将一个新的 DIV 插入到`#box1`-Container 中，这个 DIV 将获得可用的宽度 - 并且读取它的宽度会返回一个看起来是正确的值。

HTML 和 CSS 都保持不变

JS变成

```
var helperDiv = $('<div />');
$('#box1').append(helperDiv);

$('#iw').text("inner width is: " + helperDiv.width());
helperDiv.remove();​​​​​​​​​​​​​​​​​​​​​​​​​​​ // because we dont need it anymore, do we? 
```

我还分叉了你的小提琴，看看我做了什么：http: [//jsfiddle.net/xc9xQ/2/](http://jsfiddle.net/xc9xQ/2/)

因此，要使用函数获取此值：

```
function widthWithoutScrollbar(selector) {
  var tempDiv = $("<div/>");
  $(selector).append(tempDiv);
  var elemwidth = tempDiv.width();
  tempDiv.remove();
  return elemwidth;
};

//Example
console.log($('#page').width());  // 1280
console.log(widthWithoutScrollbar('#page'));  // 1265 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2012-05-21T23:06:09.190

我不确定您到底在寻找什么，但我相信它是id 为 box1 的 div`scrollWidth`或`clientWidth`div。

两者都是 JavaScript 属性，不需要 jQuery 来检索，但可以在 jQuery 中使用以下`$('#box1')[0]`. 所有这些都是从 jQuery 选择器返回第一个（如果您使用的是 ID，则只有）DOM 元素。

如果您要查找 box1 内容的宽度，而不管您可能要查找的滚动条如何`$('#box1')[0].scrollWidth`。如果您正在寻找可用的宽度并显示*在*box1 中，那么您正在寻找`$('#box1')[0].clientWidth`.

我叉了你的小提琴，这样你就可以看到两者的作用。[http://jsfiddle.net/arosen/xp9hD/](http://jsfiddle.net/arosen/xp9hD/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-21T21:10:00.093

您可以通过复制原始 div 来制作另一个 div，然后获取宽度等。例如：

```
var saveDiv = $('<div />').html($('#box2').html()); 
```

saveDiv.innerWidth 会给你 0

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-21T21:46:33.080

如果纯 javascript 中的解决方案可以，您可以在此处使用 david walsh 描述的技术：http: [//davidwalsh.name/detect-scrollbar-width](http://davidwalsh.name/detect-scrollbar-width)

我分叉了你的小提琴并实现了它：http: [//jsfiddle.net/jnaO/z9btp/](http://jsfiddle.net/jnaO/z9btp/)

但同样，这不是使用 jQuery，只使用 javascript。

# c++ - #include 位于不同目录结构中的头文件

> ID：10692600
> 
> 赞同：9
> 
> 时间：2012-05-21T21:04:26.610
> 
> 标签：c++, directory, header-files

我已经进行了一些搜索，并在 C++ 中包含头文件的正确方法上找到了类似的线程，但没有一个能完全回答这个问题。

我知道为了在另一个文件夹中包含头文件，您可以简单地使用以下语法：

```
#include "../myFolder/myFile.h" 
```

但是，当文件位于稍微远离的不同目录结构中时呢？例如，如果保证以下内容为真：

当前目录=/f1/f2/f3/f4/f5/myFile.cpp

所需的头目录=/f1/d2/d3/d4/d5/d6/myHeader.h

我知道您可以设置“附加包含目录”属性或使用生成文件，但我想知道是否有办法从`#include`语句中做到这一点。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-05-21T21:12:35.283

投入通常被认为是丑陋且不可维护的 `".."`。`#include`

您使用的每个连贯库（例如 boost）都有一个头文件层次结构的根，您应该将其放入“附加包含目录”属性中。对于提升，它类似于

```
`C:/lib/boost_1_49` 
```

在此目录下，您通常会找到一个名为`boost`所有标题所在的目录。这带来了所有 boost headers 开头的约定：

```
#include <boost/bla/bla.hpp> 
```

这也适用于您正在编写的项目。您应该决定什么是其标头的最佳根，并从那里开始所有包含。
此规则的唯一例外应该是位于同一目录中的标头。这些可以仅作为文件名包含在内`#include "same-dir-header.h"`

您还应该区分包含 with`""`和`<>`。引号应该是你项目中的东西，尖括号应该是外部库（或者有些人会这样 - OS 和 C 运行时库）

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-22T06:46:33.213

要完成@shoosh 的答案，您应该告诉编译器那些“其他”头文件在哪里。在 windows 上使用 gcc，如果它们在 c:\path\to\library 中，则添加 -I 选项

```
-Ic:\path\to\library 
```

注意路径中的空格，如果位置是`c:\my path\to\library`，则：

```
-I"c:\my path\to\library" 
```

其他编译器将在命令行或通过 IDE 提供类似的选项。

# matlab - 当每列必须有 1 的 10% 和 3 的 90% 时，如何创建一个随机分布数字 1 和 3 的 Matlab 矩阵 (100 x 100)？

> ID：10692601
> 
> 赞同：2
> 
> 时间：2012-05-21T21:04:35.830
> 
> 标签：matlab

如何在 Matlab 中创建一个随机分布数字 1 和 3 的矩阵 (100 x 100)，而在每列中我必须有 10% 的数字 1 和 90% 的数字 3？这必须是随机分布。

任何人都可以帮助我吗？

万分感谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T21:08:54.350

```
v = [1*ones(10,1) ; 3*ones(90,1)];
A = zeros(100,100);
for i = 1:100,
   A(:,i) = v(randperm(100));
end 
```

或没有`for`循环

```
A = zeros(100,100);
v = [1*ones(10*100,1) ; 3*ones(90*100,1)];
A(:) = v(randperm(100*100)); 
```

虽然如果您以后想以不同的方式显式控制列，第一个可能会更好。

编辑：实际上，一个微妙的观点。第一段代码保证每列正好有 10 个 1 和 90 个 3。第二段代码不做这个保证，只是整个矩阵有 1000 个 1 和 9000 个 3。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-21T21:23:53.840

自从我成为 Matlab TA 以来已经有几年了，但你也应该能够这样做：

```
v = [1*ones(10*100,1) ; 3*ones(90*100,1)];
v = reshape( v(randperm(length(v))) ,100,100) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-22T08:40:59.227

@ChrisA 和 @JosephLust 的答案将为您提供一个数组，其中每列*恰好*有10 个 1 和 90 个 3，以随机顺序排列。这可能是您需要的，但是由于您提到它必须是随机分布，也许您想要的是每列应该包含有 10% 的机会为 1 和 90% 的机会为 3 的条目（这是不一样的）。

如果你想要后者，试试这个：

```
vals = [1,3,3,3,3,3,3,3,3,3];
idx = randi(10,100,100);
data = vals(idx); 
```

中间行创建一个 100x100 矩阵，其中每个条目是 1 到 10 之间的随机整数。然后将其用于索引值数组，其中一个是 1，其中九个是 3。

# python - Python - 带参数的存储函数

> ID：10692602
> 
> 赞同：4
> 
> 时间：2012-05-21T21:04:36.783
> 
> 标签：python, tkinter

我正在使用 Tkinter 进行简单的琐事游戏。有几个按钮，每个答案一个，我想在单击一个时运行带有某些参数的 checkAnswer 函数。

如果我使用以下内容：

```
self.option1 = Button(frame, text="1842", command=self.checkAnswer(question=3, answer=2)) 
```

然后它将运行 checkAnswer 并使用它返回的内容（无）。

有没有一种简单的方法可以将参数存储在按钮构造函数中？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-05-21T21:34:05.713

这正是[`functools.partial()`](http://docs.python.org/py3k/library/functools.html#functools.partial)设计的目的：

```
>>> import functools
>>> print_with_hello = functools.partial(print, "Hello")
>>> print_with_hello("World")
Hello World
>>> print_with_hello()
Hello 
```

`partial()`返回一个新函数，其行为与旧函数一样，但您传入的任何参数都已填充，因此在您的情况下：

```
import functools

...

self.option1 = Button(frame, text="1842", command=functools.partial(self.checkAnswer, question=3, answer=2)) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-21T21:17:21.157

您可以创建一个高阶函数来包装您的`checkAnswer`函数。这将允许您返回一个不需要任何参数的函数，因此可以用作回调。

例如：

```
def makeCheckAnswer(self, **kwargs)
    return lambda: self.checkAnswer(**kwargs) 
```

这将使您的按钮初始化：

```
self.option1 = Button(frame, text="1842", command=self.makeCheckAnswer(question=3, answer=2)) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-21T22:28:50.647

到目前为止最简单的就是在适当的位置使用 lambda

```
self.option1 = Button(frame, text="1842", 
    command=lambda: self.checkAnswer(question=3, answer=2)) 
```

虽然，在类似但更复杂的情况下，您确实应该使用函数工厂，例如

```
def answerCheckerFactory(self, question, answer):
    def checker():
        return self.checkAnswer(question, answer)

    return checker

    ...
    self.option1 = Button(frame, text="1842", 
        command=self.answerCheckerFactory(question=3, answer=2)) 
```

因为它将确保您传递正确的参数（`quetsion`例如，不是（原文如此））；请注意`functools.partial`允许您错误输入函数参数并仅在单击按钮时获得异常的区别；）

此外，硬编码按钮代码中的问题/答案似乎不正确......

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-21T21:08:59.760

如果您有具有特定参数的函数（不依赖于类似的东西`text.get()`），您可以使用包装器，这将是执行此操作的最简单方法，而不是 lambda 函数。例如：

```
def option1wrapper():
    ClassName.checkAnswer(question=3,answer=2)
self.option1 = Button(frame, text="1842", command=option1wrapper) 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-08-06T23:09:52.787

只有你需要使用这样的 lambda 函数

```
self.option1 = lambda: Button(frame, text="1842", command=self.checkAnswer(question=3, answer=2)) 
```

# wpf - xamlreader 的不同行为

> ID：10692603
> 
> 赞同：0
> 
> 时间：2012-05-21T21:04:36.597
> 
> 标签：wpf, windows-phone-7, xamlreader

WPF 和 WP7 中的 XamlReader 有什么区别？我有 XAML 文件，我想在我的 wp7 应用程序中动态加载它。我正在使用 XamlReader.Load() 函数。出于测试目的，我在 WPF 中创建了简单的应用程序并完美加载了文件。在 wp7 中，当我尝试加载相同的文件时，我遇到了 XamlParseException：

> 未能创建“System.Windows.Media.PathFigureCollection”

为什么有可能？

这是这个 XAML：

```
<Canvas Width="110" Height="113" ClipToBounds="True" xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation">
    <Path Fill="#FF000000">
        <Path.Data>
           <PathGeometry FillRule="Nonzero" Figures="M27.966,79.165C23.747,89.502,20.437,100.215,18.032,111.309L7.278,111.309C2.427,99.541 0,84.985 0,67.646 0,50.181 2.383,30.859 7.151,9.68L19.932,13.225C14.405,29.131 11.643,47.312 11.643,67.773 11.643,75.62 12.043,82.519 12.844,88.466L13.098,88.466C14.827,82.939,16.428,78.593,17.905,75.429L27.966,79.165z M101.738,87.075L94.082,98.594C88.936,94.922 82.27,91.211 74.087,87.451 73.75,95.683 71.621,101.943 67.7,106.25 63.774,110.552 58.31,112.705 51.311,112.705 43.931,112.705 37.961,110.791 33.406,106.973 28.853,103.16 26.575,98.34 26.575,92.52 26.575,86.358 29.273,81.25 34.673,77.203 40.071,73.155 46.651,71.129 54.414,71.129 57.91,71.129 60.718,71.339 62.827,71.759L62.827,44.297C47.556,44.297,35.556,43.958,26.826,43.284L27.207,30.943C34.841,32.169 44.119,32.779 55.044,32.779 57.07,32.779 59.663,32.696 62.827,32.525L62.827,8.542 74.658,8.542 74.658,31.704C79.38,31.45,86.235,30.459,95.221,28.728L95.221,41.321C89.694,42.166,82.842,42.862,74.658,43.411L74.658,74.229C83.643,77.305,92.666,81.592,101.738,87.075z M62.192,84.102C59.873,83.301 57.324,82.901 54.536,82.901 50.151,82.901 46.313,83.848 43.022,85.743 39.733,87.647 38.088,89.986 38.088,92.769 38.088,95.342 39.353,97.369 41.884,98.848 44.416,100.323 47.514,101.06 51.183,101.06 54.896,101.06 57.572,99.786 59.218,97.232 60.864,94.678 61.855,90.303 62.192,84.102z M95.348,22.654L86.426,26.387C84.824,19.258,82.754,13.479,80.225,9.048L89.654,5.188C92.057,9.915,93.955,15.735,95.348,22.654z M109.771,17.466L100.787,21.262C99.229,14.089,97.158,8.289,94.59,3.86L104.077,0C106.439,4.724,108.34,10.547,109.771,17.466z" />
        </Path.Data>
    </Path>
</Canvas> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T21:11:26.903

WPF 和 WP7 中的 XAML 之间存在许多差异。WP7 使用的 Silverlight 框架是 WPF 框架的子集，例如`ClipToBounds`Silverlight 中不存在该属性。

您可以尝试将 XAML 粘贴到用户控件中，然后删除导致编译失败的属性/元素。

最重要的是，除了非常琐碎的 WPF XAML 之外，您不能指望在 Silverlight 中工作！

# regex - 电子邮件正则表达式接受 www

> ID：10692606
> 
> 赞同：-1
> 
> 时间：2012-05-21T21:05:02.510
> 
> 标签：regex

我有一个电子邮件字段并确认电子邮件，他们正在接受 www。不能

这是我的正则表达式

```
/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/; 
```

;

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-21T22:23:18.057

试试这个

```
 ^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+(?<!@www)\.)+[a-zA-Z]{2,}))$ 
```

这匹配

```
test@test.com 
```

但不匹配

```
test@www.test.com 
```

不同之处在于最后引入的负面回顾

```
(?<!@www) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-04-27T18:39:14.487

```
/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/ 
```

最大长度 128

# javascript - 断开并手动重新连接 Socket.IO

> ID：10692607
> 
> 赞同：3
> 
> 时间：2012-05-21T21:05:02.977
> 
> 标签：javascript, socket.io

我正在使用 Socket.IO 启动到 Node.js 服务器的套接字连接，它很简单，如下所示：

```
var socket = io.connect(url, options); 
```

在某些时候，我需要在不再需要此套接字时断开它并重新连接它。我在启动一个全新的套接字时遇到了一些问题，我认为简单地重新连接同一个套接字而不是重建另一个套接字并向它添加侦听器会更好。

根据 socket.io 文档，我应该能够通过调用手动重新连接套接字：

```
socket.connect(); 
```

但是当我调用该方法时，我在控制台中收到一个错误：Uncaught TypeError: Object # has no method 'connect'

我错过了什么吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-22T07:36:08.053

您应该在`socket`对象中调用套接字：

```
var socket = io.connect(url, options);
socket.socket.connect(); 
```

看到这个问题是相关的：[Socket IO reconnect?](https://stackoverflow.com/questions/10437584/socket-io-reconnect/10443120#10443120)

# backbone.js - Backbone.js 应用程序中的移动 Safari“吞咽”事件

> ID：10692609
> 
> 赞同：1
> 
> 时间：2012-05-21T21:05:20.653
> 
> 标签：backbone.js, coffeescript, mobile-safari, backbone-events

我在使用 Backbone.js 应用程序时遇到了一个奇怪的问题。在我的主视图中，我想捕获视图上发生的所有输入事件并将它们路由到输入处理程序方法。我在视图中还有一些链接可以导航到应用程序的其他部分。相关（CoffeeScript）代码：

```
events:
    'click a.quit': 'quit'
    'mousedown': 'onActionStart'
    'mouseup': 'onActionEnd'
    'touchstart': 'onActionStart'
    'touchmove': 'onActionMove'
    'touchend': 'onActionEnd' 
```

事件处理在桌面 Safari 中按预期工作。当我单击“退出”链接时，“onAction_ *_* ”方法会触发，然后会调用“退出”方法。但是，在 Mobile Safari 上，不会调用“退出”方法。如果我修改触摸事件选择器以仅响应视图中的较小区域（即不与链接重叠的元素），那么它会按预期工作。（通过用户输入触发的所有方法都有 preventDefault() 调用，但这不应该阻止事件冒泡。）这是一个已知的 Mobile Safari 问题吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-23T09:22:15.853

好吧，我最终将“事件”对象变成了一个函数，并进行了基本的浏览器嗅探以检测带有触摸屏的平台。变成`'click a.quit': 'quit'`被`'mouseup a.quit': 'quit'`正确调用，即使 Safari 文档说

> 如果用户点击一个可点击元素，事件按以下顺序到达：mouseover、mousemove、mousedown、mouseup 和 click

这是我的结果：

```
 events: ->
        # Determine whether touchscreen or desktop
        agent = navigator.userAgent.toLowerCase()
        if agent.match(/ip(hone|od|ad)/i) or agent.match(/android/i)
            events = 
                'touchend a.quit': 'quit'
                'touchend a.reset': 'reset'
                'touchstart': 'onActionStart'
                'touchmove': 'onActionMove'
                'touchend': 'onActionEnd'
                'onscroll': 'preventDefault'
                'gesturestart': 'preventDefault'
                'gesturechange': 'preventDefault'
                'gestureend': 'preventDefault'
        else 
            events = 
                'click a.quit': 'quit'
                'click a.reset': 'reset'
                'mousedown': 'onActionStart'
                'mouseup': 'onActionEnd' 
```

# ruby-on-rails - Rails：在环境文件中获取root_url

> ID：10692611
> 
> 赞同：1
> 
> 时间：2012-05-21T21:05:32.257
> 
> 标签：ruby-on-rails, configuration, helper, host

rails 中的辅助方法会自动检测应用程序的根 url。例如，`user_signup_url`自动使用`mydoimain.com/user_signup`

但是，在我的环境/production.rb 中，我必须手动设置我的主机。

```
config.action_mailer.default_url_options = { :host => 'mydomain.com' } 
```

有没有办法自动设置这个？可能类似于以下内容：

```
config.action_mailer.default_url_options = { :host => ROOT_URL } 
```

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-21T21:11:58.650

如果我没记错的话，主机是从传入的请求中“猜测”出来的。这就是为什么它可以在您的控制器和您的视图中访问。但是，在邮件程序级别没有请求对象，因此在这种情况下您必须详细说明。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-21T21:20:43.180

就像您描述的那样，在全局某处设置一个常量。将它放在 顶部的某个位置`application.rb`，或者可能是每个开发环境文件中的不同值？

或者，也许您可​​以创建一个`Constants`内部声明特定常量的类？（你的电话是`Constants::ROOT_URL`。）

或者，在 Rails 启动之前在你的 shell 中设置一个环境变量并使用`ENV['ROOT_URL']`

另一个答案提到taht `_path`helpers不需要域名。这是真的——但我不确定`_url`助手是如何工作的，因为我认为他们应该给你一个完整的 URI？您可能想调查`_url`帮助程序的工作方式。

# javascript - 如果访问者试图通过单击“x”按钮关闭浏览器窗口，则触发函数

> ID：10692613
> 
> 赞同：3
> 
> 时间：2012-05-21T21:05:55.707
> 
> 标签：javascript, jquery, events, browser

我想要做的是，仅当用户尝试通过单击 x 按钮关闭浏览器窗口时才能触发某些功能。但不是在刷新时，“返回”按钮单击事件，如以下功能。

```
$(window).unload( function () { alert("Bye now!"); } ); 
```

那么有什么方法可以实现这一点吗？提前谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T21:12:07.510

不，这是不可能的。该`onbeforeunload`事件会执行类似的操作，但是当窗口关闭时总是会触发。它不区分窗口卸载的方式。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-21T21:15:53.003

您可以尝试在用户加载页面后立即强制用户使用#default 的默认位置哈希。然后，如果该人使用后退按钮导航回来，您可以使用计时器或窗口的“popstate”事件检测到这一点。然后，您可以在此时执行一些操作，例如将它们发送到另一个 url。

通过这种方式，您可以使用上一段中提到的方法检测带有“onbeforeunload”事件和后退按钮按下的窗口关闭。凌乱，但它的工作原理。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-21T21:17:56.570

几个答案指出您将无法做到这一点： [如何区分由刷新或窗口关闭触发的卸载事件？](https://stackoverflow.com/questions/3115773/how-to-distinguish-unload-event-triggered-by-refresh-or-window-close) 以及 [如何区分刷新或窗口关闭触发的卸载事件？](https://stackoverflow.com/questions/3115773/how-to-distinguish-unload-event-triggered-by-refresh-or-window-close) 建议的两种“解决方法”都是检查鼠标位置并询问 kinator。

# objective-c - 隐藏/删除表格视图部分

> ID：10692614
> 
> 赞同：1
> 
> 时间：2012-05-21T21:05:55.737
> 
> 标签：objective-c, uitableview, row

我正在开发一个类似于联系人应用程序的应用程序。它有一个项目列表，每个项目都有一个详细视图。详细视图是一个表格视图，显示名称、地点、值等值。但是，如果地点没有值，我不希望它的部分出现，这样详细视图中就没有空白单元格. 我有6个部分。第 2 部分应始终显示，即使未分配值且第 5 部分有两行。所有其他部分都有 1 行。我看过其他问题；但是，我并没有取得太大的成功。我当前的代码如下所示：

```
- (NSArray *)sectionIndexTitlesForTableView:(UITableView *)tableView {
    return sectionTitles;
}

- (NSString *)tableView:(UITableView *)tableView titleForHeaderInSection:(NSInteger)section {
    if (section == 1) {
        if ([[[detailGift givingTo] name] length] == 0) {
            return nil;
        }
        else {
            return @"";
        }
    }
    else if (section == 2) {
        return @"";
    }
    else if (section == 3) {
        if ([[[detailGift reasonFor] name] length] == 0) {
            return nil;
        }
        else {
            return @"";
        }
    }
    else if (section == 4) {
        if ([[[detailGift boughtFrom] name] length] == 0) {
            return nil;
        }
        else {
            return @"";
        }
    }
    else if (section == 5) {
        if ([[formatter stringFromDate:[detailGift dateGiving]] length] == 0 && [[formatter stringFromDate:[detailGift datePurchased]] length] == 0) {
            return nil;
        }
        else {
            return @"";
        }
    }
    else {
        if ([[detailGift notes] length] == 0) {
            return nil;
        }
        else {
            return @"";
        }
    }
}

- (NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section {
    if (section == 1) {
        if ([[[detailGift givingTo] name] length] == 0) {
            return 0;
        }
        else {
            return 1;
        }
    }
    else if (section == 2) {
        return 1;
    }
    else if (section == 3) {
        if ([[[detailGift reasonFor] name] length] == 0) {
            return 0;
        }
        else {
            return 1;
        }
    }
    else if (section == 4) {
        if ([[[detailGift boughtFrom] name] length] == 0) {
            return 0;
        }
        else {
            return 1;
        }
    }
    else if (section == 5) {
        if ([[formatter stringFromDate:[detailGift dateGiving]] length] == 0 && [[formatter stringFromDate:[detailGift datePurchased]] length] == 0) {
            return 0;
        }
        else if ([[formatter stringFromDate:[detailGift dateGiving]] length] != 0 && [[formatter stringFromDate:[detailGift datePurchased]] length] == 0) {
            return 1;
        }
        else if ([[formatter stringFromDate:[detailGift dateGiving]] length] == 0 && [[formatter stringFromDate:[detailGift datePurchased]] length] != 0) {
            return 1;
        }
        else {
// Crashes after returning value of two
            return 2;
        }
    }
    else {
        if ([[detailGift notes] length] == 0) {
            return 0;
        }
        else {
            return 1;
        }
    }
} 
```

这对我来说似乎很混乱，并且还导致以下异常：由于未捕获的异常“NSRangeException”而终止应用程序，原因：“ *** -[__NSArrayI objectAtIndex:]: index 1 beyond bounds [0 .. 0]”

如果有人能给我一些建议或让我朝着正确的方向前进，我将不胜感激！非常感谢！斯科特

# ios - 在 iOS 应用程序中处理过期的访问令牌

> ID：10692615
> 
> 赞同：4
> 
> 时间：2012-05-21T21:05:57.593
> 
> 标签：ios, access-token, facebook-oauth

在 iOS 应用程序中处理过期的访问令牌时，最佳实践是什么？例如，用户可以更改他们的 Facebook 密码，或者他们可以简单地从他们的个人资料中删除 FB 应用程序。或者他们可能会在 60 天内忘记该应用程序，然后开始重复使用它。在所有情况下，访问令牌都是无效的，因此应用程序必须通过调用获得一个新的`authorize`（这将打开 Facebook 应用程序一秒钟，然后使用访问令牌返回应用程序）。

有什么方法可以在 iOS 应用程序中获取新的访问令牌而无需重新授权？我在这里找到了一些关于此的[其他](https://stackoverflow.com/questions/8373383/facebook-ios-sdk-refreshing-an-expired-access-token-without-presenting-a-dialog) [问题](https://stackoverflow.com/questions/3610682/how-to-refresh-an-oauth-token-when-using-the-facebook-iphone-sdk)，但仍然没有找到方法。

在这种情况下，应用程序究竟应该做什么？如果他们希望应用程序继续与 Facebook 交互，它可能会显示一个对话框，要求用户再次授权？我认为这会很烦人，但我看不到任何其他解决方案。有任何想法吗？其他应用在做什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-21T21:08:42.743

要求用户再次授权应用程序是有意义的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-27T18:40:30.237

直接来自 Facebook 文档、错误响应以及如何对 PHP 示例做出反应： [https ://developers.facebook.com/blog/post/2011/05/13/how-to--handle-expired-access-tokens/](https://developers.facebook.com/blog/post/2011/05/13/how-to--handle-expired-access-tokens/)

# ios - 接口生成器不再为 IBOutlets 生成符合 ARC 的代码

> ID：10692627
> 
> 赞同：1
> 
> 时间：2012-05-21T21:07:01.990
> 
> 标签：ios, xcode, interface-builder, iboutlet

我正在使用 XCode 4.3.2 实现我的第一个 iOS 5.1 应用程序，并且我正在尝试一种奇怪的 XCode 界面构建器行为。

我在界面构建器中创建了一个带有 NIB 文件的 ViewController，当将任何 UI 对象连接到 ViewController .h 以创建 IBOutlet 属性时，设置插座属性的对话框窗口不显示 Storage 字段。

为了清楚起见，界面生成器显示了这个对话框：

![截图 1](../Images/2dafa8ae8e84cdc044fc0cedc1a796d4.png)

而不是这个：

[![截图 2](../Images/3aadc2258ff64568b9a4de9336d4ddf4.png)](https://i.stack.imgur.com/XvEiC.png)

因此，界面生成器生成的代码如下所示：

```
@property (unsafe_unretained, nonatomic) IBOutlet UILabel *labelName; 
```

而我期待的代码是：

```
@property (weak, nonatomic) IBOutlet UILabel *labelName; 
```

这种行为从几天开始发生并且仅针对一个项目，所以我怀疑我不小心更改了某些项目设置。

对恢复 XCode Interface Builder 行为以生成 ARC 代码有任何帮助吗？

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-22T07:25:36.327

我敢打赌你的目标是 4.x 对吗？在这种情况下，你不能使用弱，所以它使用 unsafe_unretained。它们是一样的，除了 unsafe_unretained 不会自动为您取消指针，但这对您的用例并不特别重要。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-22T08:56:33.790

您可能关闭了`ARC`项目/目标设置。切换到`Yes`，你会回到`Storage`现场。

![在此处输入图像描述](../Images/b64108f6aca8e2a1c459691bad437451.png)

# copy - 将 uint16_t 放入 uint32_t

> ID：10692638
> 
> 赞同：0
> 
> 时间：2012-05-21T21:08:11.977
> 
> 标签：copy, uint32, uint16

```
char* createMSG(uint8_t i,uint16_t port) {
char *buff; 
buff = (char*) calloc(1,6);
uint8_t id, tmp;
tmp = 0;
id = 2;
memcpy(buff, &id, sizeof(uint8_t));
memcpy(buff+1, &i, sizeof(uint8_t));
memcpy(buff+2, &port, sizeof(uint16_t));
memcpy(buff+2+2, &tmp, sizeof(uint16_t));
memcpy(buff+2+2+1, &tmp, sizeof(uint16_t));
printf("created SV_CON_REP: id: %d accept: %d port %d\n",*buff,*(buff+1),*    (buff+2));    return buff;
} 
```

我需要将端口复制到 uint32_t 中。它打印端口为空。

**编辑** 函数调用：char* tmp; uint8_t 我；我 = 9; uint16_t 端口；端口 = 1234；tmp = createMSG(i,port);

输出：创建的味精：id：2 接受：0 端口 0

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-21T21:15:54.450

*((uint_16*)(buff+2))`printf`怎么样？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-21T22:17:24.333

我是复制这个功能，但是在windows下。

```
uint8_t = BYTE
uint16_t = WORD

char* createMSG(BYTE i,WORD port) 
{
    char *buff; 
    BYTE id, tmp;
    buff = (char*) calloc(1,6);
    tmp = 0;
    id = 2;
    memcpy(buff, &id, sizeof(BYTE));
    memcpy(buff+1, &i, sizeof(BYTE));
    memcpy(buff+2, &port, sizeof(WORD));
    memcpy(buff+2+2, &tmp, sizeof(WORD));
    memcpy(buff+2+2+1, &tmp, sizeof(WORD));
    printf("created SV_CON_REP: id: %d accept: %d port %d\n",*buff,*(buff+1),*        (buff+2));    return buff;
} 
```

称呼：

```
createMSG(9,1234); 
```

打印结果：

```
created SV_CON_REP: id: 2 accept: 9 port 210 
```

（1234 = 0x04d2，其中 0xd2=210）

您仍然没有复制 call & printf 结果，而是您自己的评论

# html - 如何渲染 Meteor Session 变量的 HTML？

> ID：10692643
> 
> 赞同：9
> 
> 时间：2012-05-21T21:08:32.973
> 
> 标签：html, meteor

继[我之前关于使用 Meteor.call 从服务器上的对象获取数据的帖子之后，](https://stackoverflow.com/questions/10677491/how-to-get-meteor-call-to-return-value-for-template)我想知道一旦从服务器接收到类似的对象数据，这些相同的数据如何呈现 HTML。这是一个简单的例子：

```
/server/svr.js
Meteor.methods({
  test: function(text) {
    var result = {};
    result.foo = "<em>" + text + "</em>";
    result.bar = text;
    return result;
  }
});

/client/del.js
Meteor.call('test', "Hello World - May 2012", function(err, data) {
if (err)
  console.log(err);

  Session.set('q', data);
});

Template.hello.greeting = function() {
  return Session.get('q').foo;
}; 
```

当我在标准流星应用程序中运行此代码时，我在浏览器窗口中看到：

```
Hello World!
<em>Hello World - May 2012</em> 
```

理想情况下，我希望包含 html 代码的会话变量能够呈现传递给它的内容（在上面的简单示例中 - 在输出到浏览器时使第二行变为斜体）。我该怎么做呢？

提前感谢您的帮助！

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2012-05-22T06:17:42.430

使用`{{{greeting}}}`而不是`{{greeting}}`确保它没有被转义。

# excel - Excel vba 创建范围的所有可能组合

> ID：10692653
> 
> 赞同：11
> 
> 时间：2012-05-21T21:09:14.803
> 
> 标签：excel, permutation, combinations, static-methods, vba

我有一个问题，我无法在网络上的任何地方找到（它可能在那里，但我找不到，呵呵）。

我有一个包含 13 列数据的电子表格。每一列都包含需要进入整个测试用例的参数的变体。

它们都不同，比如

E：
101%
105%
110%
120%

J:
Upper S
Upside L
Downside B
Premium V

我已经看到了几种使用嵌套循环的组合问题的解决方案。我想避开 13 个嵌套循环（但这是我目前最好的选择）。我对如何在每列中生成每个唯一组合感到不知所措。

我不确定这对你们是否足够有意义。我希望有人至少可以用递归算法为我指明正确的方向。我想让它足够动态以获取不同数量的列和行。

感谢你们能给我的任何帮助。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-05-22T00:53:47.500

由于我提供了一种 ODBC 方法，因此我认为我应该详细说明它，因为如何做到这一点并不是很明显。而且，老实说，我需要重新学习这个过程并为自己记录下来。

这是一种使用 Excel 和 Microsoft Query 生成两个或多个一维数据数组的[笛卡尔积的方法。](https://www.google.com/search?q=define%3A%20cartesian%20product&oq=define%3A%20cartesian%20product "笛卡尔积")

这些说明是用 XL2007 编写的，但应该在任何版本中进行微小的（如果有的话）修改。

## 第1步

按列组织数组。

*重要提示：*每一列都应该有两个“标题”名称，如下面的粗体所示。最上面的名称稍后将被解释为“表名”。第二个名称将被解释为“列名”。这将在几步之后变得明显。

依次选择每个数据范围，包括两个“标题”，然后点击`Ctrl+Shift+F3`。仅`Top row`在“创建名称”对话框中打勾并单击`OK`。

建立所有命名范围后，保存文件。

![在此处输入图像描述](../Images/eff7e8a6ed3b758181654fbcc2f8c47d.png)

## 第2步

数据 | 获取外部数据 | 从其他来源 | 来自微软查询

选择`<New Data Source>`。在`Choose New Data Source`对话框中：

1.  连接的友好名称

2.  选择适当的 Microsoft Excel 驱动程序

... 然后`Connect`

![在此处输入图像描述](../Images/c63442f3411e97e6ac94b977a97d5fa0.png)

## 第 3 步

`Select Workbook...`然后浏览您的文件。

![在此处输入图像描述](../Images/6d6ef08181ff07972d82eec093ae2876.png)

## 第4步

从“表格”中添加“列”。您现在可以看到为什么第 1 步中的“双标头”布局很重要——它诱使驱动程序正确理解数据。

下一步单击`Cancel`（真的！）。此时可能会提示您“继续在 Microsoft Query 中编辑？” （答案`Yes`），或加入的投诉无法在图形编辑器中表示。忽略这一点，继续前进……

![在此处输入图像描述](../Images/a0ff10393eba846b95d801efab93e706.png)

## 第 5 步

Microsoft Query 将打开，默认情况下，您添加的表将被交叉连接。这将生成一个笛卡尔积，这正是我们想要的。

现在完全关闭 MSQuery。

![在此处输入图像描述](../Images/2cb31ea2a58c6cba351c2cfc0c80111e.png)

## 第 6 步

您将返回到工作表。快完成了，我保证！勾选`New worksheet`和`OK`。

![在此处输入图像描述](../Images/5e8fea66001eb789e0521f7233e5a066.png)

## 第 7 步

返回交叉连接的结果。

![在此处输入图像描述](../Images/c2ecc72f264366e60b873b2ff4b1c893.png)

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-05-21T23:10:34.163

不知道你为什么反对循环。请参阅此示例。花了不到一秒钟的时间。

```
Option Explicit

Sub Sample()
    Dim i As Long, j As Long, k As Long, l As Long
    Dim CountComb As Long, lastrow As Long

    Range("G2").Value = Now

    Application.ScreenUpdating = False

    CountComb = 0: lastrow = 6

    For i = 1 To 4: For j = 1 To 4
    For k = 1 To 8: For l = 1 To 12
        Range("G" & lastrow).Value = Range("A" & i).Value & "/" & _
                                     Range("B" & j).Value & "/" & _
                                     Range("C" & k).Value & "/" & _
                                     Range("D" & l).Value
        lastrow = lastrow + 1
        CountComb = CountComb + 1
    Next: Next
    Next: Next

    Range("G1").Value = CountComb
    Range("G3").Value = Now

    Application.ScreenUpdating = True
End Sub 
```

**快照**

![在此处输入图像描述](../Images/6807fcd0d65fe4c05fb49b3a89f893a4.png)

**注意**：以上是一个小例子。我对 4 列进行了测试，每列有 200 行。在这种情况下可能的总组合是`1600000000`16 秒。

在这种情况下，它会超过 Excel 行数限制。我能想到的另一种选择是在这种情况下将输出写入文本文件。如果您的数据很小，那么您可以在不使用数组并直接写入单元格的情况下摆脱困境。:) 但是在大数据的情况下，我建议使用数组。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-11-14T18:39:41.097

我自己多次需要这个并最终构建了它。

我相信代码适用于任何列总数和列内任何数量的不同值（例如，每列可以包含任意数量的值）

它假设每列中的所有值都是唯一的（如果这不是真的，你会得到重复的行）

它假定您要根据当前选择的任何单元格交叉连接输出（确保全部选择）

它假定您希望输出在当前选择之后开始一列。

它是如何工作的（简要）：首先对于每一列和每一行：它计算支持 N 列中所有组合所需的总行数（第 1 列中的项目 * 第 2 列中的项目 ... * 第 N 列中的项目）

每列第二个：根据总组合数和前一列的总组合数，它计算两个循环。

ValueCycles（必须循环遍历当前列中的所有值的次数） ValueRepeats（连续重复列中的每个值的次数）

```
Sub sub_CrossJoin()

Dim rg_Selection As Range
Dim rg_Col As Range
Dim rg_Row As Range
Dim rg_Cell As Range
Dim rg_DestinationCol As Range
Dim rg_DestinationCell As Range
Dim int_PriorCombos As Long
Dim int_TotalCombos As Long
Dim int_ValueRowCount As Long
Dim int_ValueRepeats As Long
Dim int_ValueRepeater As Long
Dim int_ValueCycles As Long
Dim int_ValueCycler As Long

int_TotalCombos = 1
int_PriorCombos = 1
int_ValueRowCount = 0
int_ValueCycler = 0
int_ValueRepeater = 0

Set rg_Selection = Selection
Set rg_DestinationCol = rg_Selection.Cells(1, 1)
Set rg_DestinationCol = rg_DestinationCol.Offset(0, rg_Selection.Columns.Count)

'get total combos
For Each rg_Col In rg_Selection.Columns
    int_ValueRowCount = 0
    For Each rg_Row In rg_Col.Cells
        If rg_Row.Value = "" Then
            Exit For
        End If
        int_ValueRowCount = int_ValueRowCount + 1
    Next rg_Row
    int_TotalCombos = int_TotalCombos * int_ValueRowCount
Next rg_Col

int_ValueRowCount = 0

'for each column, calculate the repeats needed for each row value and then populate the destination
For Each rg_Col In rg_Selection.Columns
    int_ValueRowCount = 0
    For Each rg_Row In rg_Col.Cells
        If rg_Row.Value = "" Then
            Exit For
        End If
        int_ValueRowCount = int_ValueRowCount + 1
    Next rg_Row
    int_PriorCombos = int_PriorCombos * int_ValueRowCount
    int_ValueRepeats = int_TotalCombos / int_PriorCombos

    int_ValueCycles = (int_TotalCombos / int_ValueRepeats) / int_ValueRowCount
    int_ValueCycler = 0

    int_ValueRepeater = 0

    Set rg_DestinationCell = rg_DestinationCol

    For int_ValueCycler = 1 To int_ValueCycles
        For Each rg_Row In rg_Col.Cells
            If rg_Row.Value = "" Then
                Exit For
            End If

                For int_ValueRepeater = 1 To int_ValueRepeats
                    rg_DestinationCell.Value = rg_Row.Value
                    Set rg_DestinationCell = rg_DestinationCell.Offset(1, 0)
                Next int_ValueRepeater

        Next rg_Row
    Next int_ValueCycler

    Set rg_DestinationCol = rg_DestinationCol.Offset(0, 1)
Next rg_Col
End Sub 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-05-21T22:20:07.027

基于我的第二条评论的解决方案。此示例假设您有三列数据，但可以调整以处理更多数据。

我从你的样本数据开始。为了方便起见，我在第一行添加了计数。我还添加了组合的总数（计数的乘积）。这是`Sheet1`：

![在此处输入图像描述](../Images/657be928bc6379f1aadc5858b16e563a.png)

开`Sheet2`：

![在此处输入图像描述](../Images/a744ee6ca8e2c0b40dc58036cce71a9e.png)

公式：

`A2:C2`（橙色单元格）是硬编码的`=0`

```
A3=IF(SUM(B3:C3)=0,MOD(A2+1,Sheet1!$E$1),A2)

B3=IF(C3=0,MOD(B2+1,Sheet1!$G$1),B2)

C3=MOD(C2+1,Sheet1!$J$1)

D2=INDEX(Sheet1!$E$2:$E$5,Sheet2!A2+1)

E2=INDEX(Sheet1!$G$2:$G$6,Sheet2!B2+1)

F2=INDEX(Sheet1!$J$2:$J$5,Sheet2!C2+1) 
```

`Total`从第 3 行向下填充与显示的一样多的行`Sheet1`

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-21T21:42:14.503

调用方法并放入当前级别，将在方法中递减（抱歉eng）

样本：

```
 sub MyAdd(i as integer)
      if i > 1 then
        MyAdd = i + MyAdd(i-1)
      else
        MyAdd = 1
      end if
    end sub 
```

# binding - 绑定 JavaFX 2 TableView 元素

> ID：10692654
> 
> 赞同：4
> 
> 时间：2012-05-21T21:09:19.743
> 
> 标签：binding, tableview, javafx, javafx-2

我正在使用 JavaFx 2.1 中的简单绑定在 MacOSX 上使用 java 1.7.0_04-b21 开发一个小型应用程序。实际上，我目前将 Mac OSX 上 Cocoa 的绑定机制与 JavaFx 进行比较，并面临几个问题：

该应用程序使用一个模型来保存一个 observableArrayList（称为 messageList），它被设置为 TableView 的项目。向列表中添加新条目有效。该条目出现在 TableView 中。

**问题 1：**删除所选项目不起作用。当我从可观察列表中删除一个项目时，它不会消失。

**问题 2：**我想用存储在 TableView 中选择的对象的一个​​字段中的值填充 textField。实际上，在 Cocoa 中，即使在绑定定义的时间点 this 为空（因此没有选择任何内容），也可以定义对选择的绑定。这实际上是一个非常有用的概念，我没有发现这在 JavaFX 中是如何实现的。

**问题 3：**只有当已经选择了一个对象时，才能建立绑定，以便我最终编写了一个 EventHandler 对不断变化的选择做出反应，并始终重新建立我的文本字段与模型字段的正确绑定。但是对于这种方法，我的应用程序出于某种我现在不明白的原因破坏了模型。

只需单击添加按钮三四次，然后选择条目并查看 textField 的更新。模型中的数据被破坏和覆盖 - 条目通常会变短......欢迎解释效果。

到目前为止，我在 TableView 上找不到绑定示例，因此欢迎任何输入。

我的演示项目的代码包含在以下文件中。所有这些都在同一个包 com.es.javaFxTest 中。

MainWindowController.java：

```
/*
 * Created on 19.05.2012
 */
package com.es.javaFxTest;

import java.net.URL;
import java.util.ArrayList;
import java.util.Collections;
import java.util.ResourceBundle;

import javafx.beans.property.SimpleObjectProperty;
import javafx.beans.value.ChangeListener;
import javafx.beans.value.ObservableValue;
import javafx.collections.ObservableList;
import javafx.event.ActionEvent;
import javafx.event.EventHandler;
import javafx.fxml.Initializable;
import javafx.scene.control.Button;
import javafx.scene.control.TableColumn;
import javafx.scene.control.TableView;
import javafx.scene.control.TextField;
import javafx.scene.control.cell.PropertyValueFactory;

public class MainWindowController implements Initializable
{

  public Model                         model;

  public TableView<Message>            messageListTableView;

  public TableColumn<Message, String>  messageTableMessageNameColumn;

  public Button                        addMessageButton;

  public Button                        deleteMessageButton;

  public TextField                     messageNameTextField;

  public SimpleObjectProperty<Message> selectedMessage;

  /* (non-Javadoc)
   * @see javafx.fxml.Initializable#initialize(java.net.URL, java.util.ResourceBundle)
   */
  @Override
  public void initialize(URL arg0, ResourceBundle arg1)
  {
    model = new Model();

    messageTableMessageNameColumn.setCellValueFactory(new PropertyValueFactory<Message, String>("messageName"));
    messageListTableView.setItems(model.getMessageList());

    addMessageButton.setOnAction(new EventHandler<ActionEvent>() {
      StringBuffer str = new StringBuffer("a"); // to fill some dummy data

      @Override
      public void handle(ActionEvent e)
      {
        // adding an object to the observed list works and the result is shown in the tableView
        model.getMessageList().add(new Message(str.toString()));
        str.append("x");
      }
    });
    deleteMessageButton.setOnAction(new EventHandler<ActionEvent>() {
      @Override
      public void handle(ActionEvent event)
      { // observation does not work here; also the following code does not work. 
        ObservableList<Integer> selectedIndices = messageListTableView.getSelectionModel().getSelectedIndices();
        ArrayList<Integer> selectedIndices2 = new ArrayList<Integer>(selectedIndices);
        Collections.sort(selectedIndices2);
        for (int i = selectedIndices2.size() - 1; i >= 0; i--)
        {
          model.getMessageList().remove(selectedIndices2.get(i));
        }
      }
    });

    selectedMessage = new SimpleObjectProperty<Message>();
    selectedMessage.bind(messageListTableView.getSelectionModel().selectedItemProperty());

    selectedMessage.addListener(new ChangeListener<Message>() {

      @Override
      public void changed(ObservableValue< ? extends Message> observable, Message oldValue, Message newValue)
      {
        System.out.format("ObservableValue %s, \n  oldValue %s\n  newValue %s\n\n", observable, oldValue, newValue);
        if (oldValue != null)
        {
          messageNameTextField.textProperty().unbind();
          oldValue.messageName.unbind();
        }
        if (newValue != null)
        {
          messageNameTextField.textProperty().set(newValue.getMessageName());
          newValue.messageName.bindBidirectional(messageNameTextField.textProperty());
        }
      }
    });
  }
} 
```

MainWindowLayout.java

```
package com.es.javaFxTest;

/*
 * Created on 18.05.2012
 */
import java.io.IOException;

import javafx.application.Application;
import javafx.fxml.FXMLLoader;
import javafx.scene.Scene;
import javafx.scene.layout.Pane;
import javafx.stage.Stage;

public class MainWindowLayout extends Application
{

  @Override
  public void start(Stage stage)
  {

    try
    {
      FXMLLoader fxmlLoader = new FXMLLoader(getClass().getResource("MainWindowLayout.fxml"));
      Pane root = (Pane) fxmlLoader.load();
      MainWindowController controller = (MainWindowController) fxmlLoader.getController();

      Scene scene = new Scene(root);
      stage.setTitle("Config");
      stage.setScene(scene);
      stage.show();

    }
    catch (IOException e)
    {
      e.printStackTrace();
    }
  }

  public static void main(String[] args)
  {
    launch(args);
  }

} 
```

消息.java

```
/*
 * Created on 19.05.2012
 *
 */
package com.es.javaFxTest;

import javafx.beans.property.SimpleStringProperty;

public class Message 
{

  /**
   * @param canId
   * @param messageName
   */
  public Message(String messageName)
  {
    this.messageName = new SimpleStringProperty(messageName);
  }

  SimpleStringProperty messageName;
  /**
   * @return the messageName
   */
  public String getMessageName()
  {
    return messageName.getValue();
  }
  /**
   * @param messageName the messageName to set
   */
  public void setMessageName(String messageName)
  {
    this.messageName.set(messageName);
  }

  public String toString ()
  {
    return String.format("Name:%s",messageName); 
  }

} 
```

模型.java

```
/*
 * Created on 20.05.2012
 */
package com.es.javaFxTest;

import javafx.beans.property.SimpleListProperty;
import javafx.collections.FXCollections;
import javafx.collections.ObservableList;

public class Model
{
  ObservableList<Message>     messageList;

  SimpleListProperty<Message> messageListProperty;

  public Model()
  {
    messageList = FXCollections.observableArrayList();
    messageListProperty = new SimpleListProperty<Message>(this,"messageList",messageList);
  }

  public final SimpleListProperty<Message> messageListProperty()
  {
    return messageListProperty;
  }

  public ObservableList<Message> getMessageList()
  {
    return messageListProperty.get();
  }

  public void setMessageList(ObservableList<Message> l)
  {
    messageListProperty.set(l);
  }
} 
```

MainWindowLayout.xml

```
<?xml version="1.0" encoding="UTF-8"?>

<?import java.lang.*?>
<?import java.util.*?>
<?import javafx.collections.*?>
<?import javafx.geometry.*?>
<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>
<?import javafx.scene.paint.*?>

<AnchorPane id="AnchorPane" maxHeight="-Infinity" maxWidth="-Infinity" minHeight="-Infinity" minWidth="-Infinity" prefHeight="400.0" prefWidth="500.0" xmlns:fx="http://javafx.com/fxml" fx:controller="com.es.javaFxTest.MainWindowController">
  <children>
    <SplitPane id="splitPaneHorizontal1" dividerPositions="0.3614457831325301" focusTraversable="true" prefHeight="600.0" prefWidth="900.0" AnchorPane.bottomAnchor="0.0" AnchorPane.leftAnchor="0.0" AnchorPane.rightAnchor="0.0" AnchorPane.topAnchor="0.0">
      <items>
        <AnchorPane id="anchorPane1" minHeight="0.0" minWidth="0.0" prefHeight="598.0" prefWidth="390.0">
          <children>
            <VBox id="VBox" alignment="CENTER" prefHeight="598.0" prefWidth="177.0" spacing="5.0" AnchorPane.bottomAnchor="0.0" AnchorPane.leftAnchor="0.0" AnchorPane.rightAnchor="0.0" AnchorPane.topAnchor="0.0">
              <children>
                <TableView id="tableView1" fx:id="messageListTableView" editable="true" prefHeight="598.0" prefWidth="406.0">
                  <columns>
                    <TableColumn prefWidth="75.0" text="Name" fx:id="messageTableMessageNameColumn" />
                  </columns>
                </TableView>
                <HBox id="HBox" alignment="CENTER" spacing="5.0">
                  <children>
                    <Button id="button2" fx:id="addMessageButton" text="Add">
                      <HBox.margin>
                        <Insets bottom="5.0" left="5.0" right="5.0" top="5.0" />
                      </HBox.margin>
                    </Button>
                    <Button id="button1" fx:id="deleteMessageButton" text="Delete">
                      <HBox.margin>
                        <Insets bottom="5.0" right="5.0" top="5.0" />
                      </HBox.margin>
                    </Button>
                  </children>
                </HBox>
              </children>
            </VBox>
          </children>
        </AnchorPane>
        <AnchorPane id="anchorPane2" minHeight="0.0" minWidth="0.0" prefHeight="160.0" prefWidth="100.0">
          <children>
            <HBox id="HBox" alignment="CENTER" layoutX="44.0" layoutY="177.0" spacing="5.0">
              <children>
                <Label id="label2" text="Name:" />
                <TextField id="textField2" fx:id="messageNameTextField" prefWidth="200.0" text="TextField" />
              </children>
            </HBox>
          </children>
        </AnchorPane>
      </items>
    </SplitPane>
  </children>
</AnchorPane> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-13T14:47:34.420

**第 1 期**——您踏入了著名的 Java 自动装箱陷阱之一。

```
model.getMessageList().remove(selectedIndices2.get(i)); // get(i) returns Integer 
```

呼叫`List.remove(Object o)`而不是`List.remove(int idx)`您预期的呼叫。

采用

```
model.getMessageList().remove(selectedIndices2.get(i).intValue()); 
```

反而。

**问题2-3**

只需将侦听器附加到`selectedItem`更改并重新绑定：

```
 messageListTableView.getSelectionModel().selectedItemProperty().addListener(new ChangeListener<Message>() {

        @Override
        public void changed(ObservableValue<? extends Message> ov, Message old, Message newM) {
            messageNameTextField.textProperty().unbindBidirectional(old.messageName);
            messageNameTextField.textProperty().bindBidirectional(newM.messageName);
        }
    }); 
```

并更新您的 Message 类。要正确使用 TableView，它需要完整的 FX“bean”并通过方法公开属性：

```
public StringProperty messageNameProperty() {
    return messageName;
} 
```

# jquery - 将 jQuery UI 对话框按钮更改为简单链接？

> ID：10692657
> 
> 赞同：4
> 
> 时间：2012-05-21T21:09:37.203
> 
> 标签：jquery, jquery-ui, jquery-ui-dialog

我在 jquery ui 对话框中定义了一个自定义按钮：

```
$("#myDlg").dialog({
        modal: true,
        buttons: {
            'My Custom Link': function () {
                alert('my custom message');
            },
            'Close': function () {
                $(this).dialog('close');
            }
        }
    }); 
```

我想将按钮“我的自定义链接”显示为 html 链接，而不是使用默认按钮样式。我怎样才能做到这一点？谢谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-21T21:24:14.387

默认的 jQuery 选项不支持添加链接。但是您可以将任何您想要的内容添加到包装器中。请参见下文，

```
$(function() {
    $("#myDlg").dialog({
        modal: true,
        buttons: {
            'Close': function() {
                $(this).dialog('close');
            }
        }
    })
    .parent()
    .find('.ui-dialog-buttonset')
    .prepend('<a href="javascript:void(0);" id="myCustomLink">My Custom Link</a>');

    $('#myCustomLink').click(function () {
        alert('my custom message');
    });
}); 
```

[**演示**](http://jsfiddle.net/fGHLZ/1/)

# mysql - 将数据从一行移动到另一行

> ID：10692659
> 
> 赞同：2
> 
> 时间：2012-05-21T21:09:55.817
> 
> 标签：mysql

我不太确定我是否以错误的方式思考这个问题，所以如果是这样的话，也许有人会指出我正确的方向。但是，如果我只是错过了这个概念，那么也许我可以得到帮助。

所以无论如何我都会赢……什么的。

我想做的是这样的，给定数据库中的一个表，在单个查询中将特定值移动到另一行。

为了澄清，以这张表为例：

```
id I value
0 I 5
1 I 2 
```

我想移动*id=0的**值*，以便表格变为：

 *```
id I value
0 I 0
1 I 5 
```

（注意！*id=1*的值无关紧要，它被覆盖并且*id=0* _value_ 只是设置为零）

到目前为止，我的尝试是一个类似于以下内容的查询：

```
UPDATE atable 
SET item = CASE id 
WHEN '1' THEN (SELECT value FROM atable WHERE id='1') 
WHEN '0' THEN '0' 
END; 
```

但是，这是无效的，我不能以这种方式使用*SELECT*。所以我的看法#2是：

```
UPDATE atable 
SET item=(SELECT value FROM atable WHERE id='1') 
WHERE id='0'; 
```

哪种有效，但是我找不到为*id=0设置**value=0的方法*

 *我希望这一切都有意义，而不是现在只是漫无边际。

只是为了弄清楚： *我想**将**值从一行移动到另一行，所以复制行不通，我可以弄清楚那个。而且我想在一个查询中完成，当然我可以将它分成两个查询，这很简单*

感谢您花时间阅读本文。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-21T21:43:17.577

我认为这会有所帮助-

```
UPDATE atable a,
(SELECT value, id FROM atable) c
SET a.value = c.value 
WHERE a.id < @MAX(id)
AND a.id = c.id + 1; 
```

唯一的条件是 id 应该按顺序排列，并且您不应该激活安全更新模式。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-21T21:35:39.437

您可以通过一个查询来执行此操作，但只有当 ID 预计是连续的时才有可能

```
update a set a.value=isnull(b.value,0) from atable a left outer join atable b on a.id=b.id+1 
```

**编辑**

```
update a set a.value=ifnull(b.value,0) from atable a left outer join atable b on a.id=b.id+1 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-21T21:28:47.543

这种类型的事情通常在事务中执行，以使其表现为原子操作。例如：

```
start transaction;    
set @myval = (select value from atable where id = 0);
update atable set value = @myval where id = 1;
update atable set value = 0 where id = 0;
commit; 
```

可以使用单个语句将值从第一行“移动”到另一行，但是它看起来非常难看并且可能效率较低。我认为以下可能会这样做，但我认为这不是一个好主意。

```
update atable set value = 
      (select x.value from 
            (select value from atable where id = 0) x) 
   where id = 1; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-22T08:02:00.630

我相信我会采用“简单”的解决方案，因为我确实有更多关于我不认为*需要*动态阅读的问题的信息。

因此，对于我的特定问题，我决定像这样解决它：

我有这些参数（在 php 中）：

```
$fromSlot, $toSlot, $itemID 
```

我想`$itemID`从一个插槽移动到另一个插槽。

但由于我知道项目的 id，我不妨将其插入到`$toSlot`并将项目设置`$fromSlot`为零。

基本上，该表有一个`slotID, itemID`where`slotID`是唯一键，并且`itemID`是一个用于引用该插槽中项目的 id。

我的查询变成了：

```
UPDATE `slots` SET item = CASE slotID
WHEN '$fromSlot' THEN '0'
WHEN '$toSlot' THEN '$itemID'
END; 
```

这样我就不必担心它可能首先将 设置`$fromSlot`为零，然后将该零“复制”到`$toSlot`.

我想避免将`$itemID`所有内容一起发送，但意识到这确实不是一个大问题，因为我宁愿避免进行两个查询然后发送额外的参数。

我想的另一种选择是跳过发送`$itemID`，然后首先更新`$toSlot`with`UPDATE slots SET item = (SELECT item FROM slots WHERE slotID='$fromSlot')`然后第二个查询来设置`$fromSlot.item`

这就是我将如何解决它。

当然欢迎任何切肉刀的想法或诸如此类的东西，但我会将其标记为我接受的答案。

如果没有别的，也许它可以帮助人们遵循我的思路并理解我为什么问（并回答-_-）这个问题。**

# python - how to accept file or path as arguments to method in python

> ID：10692663
> 
> 赞同：3
> 
> 时间：2012-05-21T21:10:13.940
> 
> 标签：python, file, python-3.x, typechecking

I am trying to write a method that will accept either an opened file

```
myFile = open("myFile.txt")
obj.writeTo(myFile)
myFile.close() 
```

or a string with a path

```
obj.writeTo("myFile.txt") 
```

The method is implemented as follows:

```
def writeTo(self, hessianFile):
    if isinstance(hessianFile,file):
        print("File type")
    elif isinstance(hessianFile,str):
        print("String type")
    else:
        pass 
```

But this raises an error

```
NameError: global name 'file' is not defined 
```

why is file type not defined? Shouldn't file be defined all the time? How should the implementation be corrected to properly handel both path an file as valid argument types

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-21T21:44:09.743

Don't type check! It's not Pythonic. The core of duck typing is the idea that if it quacks like a duck, it is a duck. The behaviour you want is if it is *file-like*, it works, and if it is *string-like*, it works. This isn't just ideological - because this is the standard in Python, people will expect to be able to give you a file-like object and have it work. If you restrict it to only a specific file type, your code will be fragile and inflexible.

The simplest option is to simply pick the more common outcome, try to work as you would with that, and fail to the other method if you get an exception:

```
def writeTo(self, hessianFile):
    try:
        with open(hessianFile, "w") as f:
            do_stuff(f)
    except TypeError:
        do_stuff(hessianFile) 
```

This might seem bad if you are used to other languages where "using exceptions for flow control" is considered bad, but that isn't the case in Python, where they are a core part of the language regularly used that way (every for loop ends with an exception!).

Or, if you think you are more likely to get a file object most of the time, do it the other way around:

```
def writeTo(self, hessianFile):
    try:
        do_stuff(f)
    except AttributeError:
        with open(hessianFile, "w") as f:
            do_stuff(f) 
```

Note my use of [the `with` statement](http://docs.python.org/reference/compound_stmts.html#the-with-statement) which is the best way of dealing with opening files - it's more readable, and also *always* closes the file for you, even on exceptions.

If you *really* find you have to type check (e.g: the operation is extremely expensive even if it fails, with no way to short-circuit), you should check the string side, as it is easier to work out if something is string-like as opposed to file-like. If you *have* to check for something file-like, you should implement an [abstract base class](https://docs.python.org/3/library/abc.html) and look for the functionality you need, rather than actually type-checking.

The reason your original code failed is that `file` isn't the base class of objects returned by `open()` in 3.x.

> The type of file object returned by the open() function depends on the mode. When open() is used to open a file in a text mode ('w', 'r', 'wt', 'rt', etc.), it returns a subclass of io.TextIOBase (specifically io.TextIOWrapper). When used to open a file in a binary mode with buffering, the returned class is a subclass of io.BufferedIOBase. The exact class varies: in read binary mode, it returns a io.BufferedReader; in write binary and append binary modes, it returns a io.BufferedWriter, and in read/write mode, it returns a io.BufferedRandom. When buffering is disabled, the raw stream, a subclass of io.RawIOBase, io.FileIO, is returned. [Source](http://docs.python.org/py3k/library/functions.html#open)

So for that you want [`io.FileIO`](http://docs.python.org/py3k/library/io.html#io.FileIO).

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-21T21:12:39.493

Don't use the name 'file' (which is a builtin object in python) as the name for your file-like object.

```
f = open("myFile.txt")
obj.writeTo(f)
f.close() 
```

Example:

```
>>> filetype = lambda x: isinstance(x, file)
>>> file = open('t','w')
>>> filetype(file)

Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
  File "<stdin>", line 1, in <lambda>
TypeError: isinstance() arg 2 must be a class, type, or tuple of classes and types

>>> f = open('t','w')
>>> del file
>>> filetype(f)
True 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-22T07:11:55.540

There is not `file` type in Python 3\. It was *built-in* in Python 2, but it disappeared in Python 3\. Compare the following:

```
Python 2.7.1 [...]
>>> f = open('zz.bak', 'w')
>>> type(f)
<type 'file'>
>>> print f.__doc__
file(name[, mode[, buffering]]) -> file object

Open a file.  The mode can be 'r', 'w' or 'a' for reading (default),
writing or appending.  The file will be created if it doesn't exist
when opened for writing or appending; it will be truncated when
opened for writing.  Add a 'b' to the mode for binary files.
Add a '+' to the mode to allow simultaneous reading and writing.
If the buffering argument is given, 0 means unbuffered, 1 means line
buffered, and larger numbers specify the buffer size.  The preferred way
to open a file is with the builtin open() function.
Add a 'U' to mode to open the file for input with universal newline
support.  Any line ending in the input file will be seen as a '\n'
in Python.  Also, a file so opened gains the attribute 'newlines';
the value for this attribute is one of None (no newline read yet),
'\r', '\n', '\r\n' or a tuple containing all the newline types seen.

'U' cannot be combined with 'w' or '+' mode. 
```

While in Python 3...

```
Python 3.2.1 [...]
>>> f = open('xx', 'w')
>>> type(f)
<class '_io.TextIOWrapper'>
>>> print(f.__doc__)
Character and line based layer over a BufferedIOBase object, buffer.

encoding gives the name of the encoding that the stream will be
decoded or encoded with. It defaults to locale.getpreferredencoding.

errors determines the strictness of encoding and decoding (see the
codecs.register) and defaults to "strict".

newline can be None, '', '\n', '\r', or '\r\n'.  It controls the
handling of line endings. If it is None, universal newlines is
enabled.  With this enabled, on input, the lines endings '\n', '\r',
or '\r\n' are translated to '\n' before being returned to the
caller. Conversely, on output, '\n' is translated to the system
default line seperator, os.linesep. If newline is any other of its
legal values, that newline becomes the newline when the file is read
and it is returned untranslated. On output, '\n' is converted to the
newline.

If line_buffering is True, a call to flush is implied when a call to
write contains a newline character. 
```

# ms-access - 一个宏会是什么样子，它将为数据库中的每条记录保存一份 PDF 报告（在访问中）？

> ID：10692664
> 
> 赞同：0
> 
> 时间：2012-05-21T21:10:15.453
> 
> 标签：ms-access, macros

我将尽可能具体，但如果我的问题一开始就令人困惑，我深表歉意......

在我的访问数据库中，我有 5 个通过自动编号“RefNum”相关的表，“RefNum”的范围是 1-2694（或 2694 条记录）。我创建了一个两页的报告。当我创建一个表单来打印报告时，它会创建一个 5388 页（每条记录 2 页）的大型 PDF。我想做的是为每条记录创建报告的 PDF，因此每个文件将是每条记录的两页报告。

在创建每个文件时，我希望它将文件重命名为一个其受人尊敬的属性。

示例：每个 PDF 文件将被重命名为 --> StudentID.Term

所以我假设我可以通过在按钮上附加一个宏来做到这一点，但由于我缺乏经验，我迷路了。

有人可以帮我解决这个宏吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-23T09:19:05.390

使用 MS Access 2007 或更高版本，您可以利用[OpenReport](http://msdn.microsoft.com/en-us/library/bb238032%28v=office.12%29.aspx)的 Where 参数。在此之前，您可以更改报表所基于的查询的 SQL，或使用参数查询。循环访问相关记录集以获取 Where 语句或参数的 ID。

# jquery - 简单的 JQuery 在 Chrome 中不起作用，FF 在 IE6 上起作用

> ID：10692667
> 
> 赞同：0
> 
> 时间：2012-05-21T21:10:31.193
> 
> 标签：jquery, html

我是 JQuery 的新手，我不知道为什么这个简单的 JQuery 在 Chrome、FF 中不起作用，令我惊讶的是它在 IE6 上起作用。简单的想法是，当我单击 Div 时，我应该得到一个警报

```
<!DOCTYPE html>
<html>
<head>
   <title>Page Chrome Test</title>
   <script type="text/javascript" src="http://code.jquery.com/jquery-latest.js"></script>
   <style  type="text/css">
      .divcls { width:100px; height:100px; background-color: black; }
   </style>
</head>
<body>
   <script type="text/javascript">
        jQuery(document).ready(function(){
            $(".divcls").click(function(e){
                 alert('Hi');
            });  
        })​
   </script>

   <div class="divcls">
   </div>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T21:14:45.577

对我来说很好，尽管在就绪块的末尾你缺少一个分号：

[jsFiddle](http://jsfiddle.net/zv3UJ/)

```
$(document).ready(function(){
   $(".divcls").click(function(e){
     alert('Hi');
   });  
})​; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-23T08:17:55.270

我正准备做 unintall/reintall FF 之类的侵入性操作，Chrome @@scrappedcola 的建议救了我。所以这是代码

```
 $(document).ready(function(){
                   $(".divcls").click(function(e){
                     window.alert('Hi');
                   });  
                })​; 
```

# list - 满足haskell中大多数元素的函数

> ID：10692668
> 
> 赞同：2
> 
> 时间：2012-05-21T21:10:32.507
> 
> 标签：list, function, haskell

我需要编写一个代码，如果函数满足列表的大多数元素并且它不满足，则返回 True。例如：`moreThan odd [1,2,3]`是`True`，但是`moreThan odd [1,2,3,4]`是`False`。这是我的代码：

```
moreThan funkt xs
   = let
      control funkt n (x : xs)
         = control (if .?. then n + 1 else n) xs
      contol funkt _
         = False
   in
   control funtk 0 xs 
```

有人可以说我如何控制它，我应该写什么`.?.` 谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-21T21:43:42.567

您编写的函数将为`False`所有参数返回，因为您总是`False`在列表结束时返回。

您编写的函数需要跟踪两个变量：处理的元素数和谓词为真的元素数。由于这段代码可能是家庭作业，我给你一个可以用来编写函数的构造。`-- ???`在这些地方填写您自己的代码。

```
moreThan :: (a -> Bool) -> [a] -> Bool
moreThan pred = go 0 0 where
  -- procd: number of elements processed
  -- holds: number of elements for which pred holds
  go procd holds (x:xs) = go procd' holds' xs where
     procd' = -- ???
     holds' = -- ???
  go procd holds []     = -- ??? 
```

如果您需要更多提示，请随时发表评论。

* * *

编写此函数的一种更惯用的方法是使用折叠：

```
moreThan pred = finalize . foldr go (0,0) where
  -- process one element of the input, produce another tuple
  go (procd,holds) x = -- ???
  -- produce a boolean value from the result-tuple
  finalize (procd,holds) = -- ??? 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-22T06:27:14.230

了解您的图书馆！

```
import Data.List(partition)
import Data.Function(on)

moreThan f = (uncurry $ on (>) length) . partition f 
```

如果不允许使用分区，自己写：

```
part f xs = (filter f xs, filter (not.f) xs) 
```

或采用数字方式：

```
moreThan f xs = 2*s > length xs where s = sum $ map (fromEnum.f) xs 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-21T23:22:15.187

也许不是最有效的解决方案，但肯定是一个非常明确的解决方案，如下所示：

```
moreThan :: (a -> Bool) -> [a] -> Bool
moreThan f xs = length ts > length fs where
    ts = filter id bools
    fs = filter not bools
    bools = map f xs 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-22T19:04:39.040

```
majority :: (a -> Bool) -> [a] -> Bool
majority p = (0 <) . sum . map (\x -> if pred x then 1 else -1) 
```

即在列表元素上映射（如果 pred x 则为 1，否则为 -1），然后对列表元素求和并查看结果是否 > 0。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-22T08:51:58.550

我希望这是有效的（只遍历列表一次）但仍然相当清晰。

```
majority :: (a -> Bool) -> [a] -> Bool
majority pred = g . sum . map f
  where f x | pred x    = 1
            | otherwise = -1
        g y = 0 < y 
```

# google-apps-script - 如何从 google-apps-script 中的单页模板生成多页文本文档？

> ID：10692669
> 
> 赞同：8
> 
> 时间：2012-05-21T21:10:36.810
> 
> 标签：google-apps-script, google-docs

我必须从存储在电子表格中的用户数据列表生成标签。现在，除了输出超过 16 个项目（每页标签的数量）时，我的一切工作都很好，我有多个文档，每个文档都是一页。每个文档都有一个唯一的名称，所以它不是很难使用，但是打开这么多文档来打印它们有点无聊。因为我不想创建一个包含 500 个项目（或任何数量）的模板，所以我想知道是否可以在多页文档中重复这个单页模板到任何扩展，这样我就可以在一个文档中获得所有标签。这样打印起来会舒服得多；-) 到目前为止，我找不到任何线索……有什么绝妙的主意吗？这是我用来生成文档的代码（有点长，对此感到抱歉）：

和......非常感谢您的帮助。

```
function print(e){
  var app = UiApp.getActiveApplication();
  var selrangerow = sh.getActiveSelection().getRowIndex();
  var selrangeheight = sh.getActiveSelection().getNumRows();
  var selrangeend = selrangerow+selrangeheight-1
  var selrange = sh.getRange(selrangerow,1,selrangeheight,7).getValues();
  var feuilles = Math.ceil(selrangeheight/16);
  for (ff=1;ff<=feuilles*16;++ff){
  if(ff>selrange.length){selrange.push([" "," "," "," "," "," "," "])} ;// remplit selrange jusqu'à multiple de 16 (nbre de feuille)
  }
//Logger.log(selrange)
//Logger.log(e.parameter.mode) ;// gauche=true, centre = false
  if(e.parameter.mode=='false'){
  var doctemplate = DocsList.getFileById(labeltemplatedoc);// false >> centre
  }else{
  var doctemplate = DocsList.getFileById(labeltemplatedocleft);// true >> gauche
  }
//Logger.log("File name: " + doctemplate.getName()); 
  var FUS1=new Date().toString().substr(25,8);// FUS1 gets the GMT+0200 or GMT+0100 string
  if (FUS1!="GMT+0200"){FUS1="GMT+0100"};// and takes care of summer time !
    for(page=0;page<feuilles;++page){
      var today=Utilities.formatDate(new Date(),FUS1,"dd-MM-yyyy")+"__"+Utilities.formatDate(new Date(),FUS1,"HH:mm")
      if (Number(page+1)<10){var docnb="0"+Number(page+1)}else{var docnb=Number(page+1)}
      var docname="IMPRESSION_page_"+docnb+"_"+today;
      var docId=DocsList.copy(doctemplate,docname).getId();
//Logger.log(selrange)  
      var doc = DocumentApp.openById(docId);;
      var lib=["titre","nom","prénom","rue","code","ville","pays"]
        for(nn=1;nn<=16;++nn){
          for(ll=0;ll<lib.length;++ll){
            var olditem = ("#"+lib[ll]+nn+"#");
            var newitem = selrange[nn-1+page*16][ll];
             if (newitem!=""){newitem=newitem+" "}
//Logger.log(olditem + "   *"+newitem+"*")
              doc.replaceText(olditem,newitem);
         }
       }
      Utilities.sleep(300); // pause entre les feuilles
    } 
   app.getElementById("end").setText(feuilles+" feuille(s) se trouve(nt) dans vos documents Google prête(s) à être imprimée(s).");
    var doclist=DocsList.getRootFolder().getFilesByType("document",0,2000);
    var names = new Array();
      for (nn=0;nn<doclist.length;++nn){
        if(doclist[nn].getName().match("IMPRESSION_page_")=="IMPRESSION_page_"){
      names.push([doclist[nn].getName(),doclist[nn].getId()]);
      }
      }
    names.sort();
 for(nn=0;nn<names.length;++nn){
 app.getElementById("Dlb").addItem(names[nn][0])
 }
   app.getElementById("clock").setVisible(false);
   app.getElementById("Dlb").setVisible(true);
   return app
}
// 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-05-31T12:14:33.667

那么 Serge，你没有尝试过[DocumentBodySection](https://developers.google.com/apps-script/class_documentbodysection)`appendParagraph`的和 其他附加吗？

我会这样做：

```
function mergeDocs() {
  var docIDs = ['list-of','documents','ids','you should have somehow'];
  var baseDoc = DocumentApp.openById(docIDs[0]);
  var body = baseDoc.getActiveSection();

  for( var i = 1; i < docIDs.length; ++i ) {
    var otherBody = DocumentApp.openById(docIDs[i]).getActiveSection();
    var totalElements = otherBody.getNumChildren();
    for( var j = 0; j < totalElements; ++j ) {
      var element = otherBody.getChild(j).copy();
      var type = element.getType();
      if( type == DocumentApp.ElementType.PARAGRAPH )
        body.appendParagraph(element);
      else if( type == DocumentApp.ElementType.TABLE )
        body.appendTable(element);
      else if( type == DocumentApp.ElementType.LIST_ITEM )
        body.appendListItem(element);
      else
        throw new Error("According to the doc this type couldn't appear in the body: "+type);
    }
  }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-22T16:22:23.547

您的问题听起来类似于我几周前提出的问题（[使用 Google Apps 脚本创建“老式”邮件合并的问题）。](https://stackoverflow.com/questions/10537384/issue-with-creating-an-old-fashioned-mail-merge-with-google-apps-script/10576188#comment13798171_10576188)我被告知创建文档的*最佳方式是通过脚本创建整个内容，而不是使用文档模板。*

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-05-04T14:09:56.107

处理类似的事情，也有内嵌图像和其他格式细节的问题。

我正在考虑一种解决方法，尽管不是最干净的解决方案可能：

*   为每行数据创建模板文档的副本
*   用每个复制文档的行数据替换标记
*   将文档合并在一起以便于打印
*   删除制作的副本

我想对于少量文件它可能会起作用，但不确定它如何处理上面提到的 500 个案例。

# svn - 使用一个（或几个）命令为长路径设置 SVN 更新深度

> ID：10692670
> 
> 赞同：0
> 
> 时间：2012-05-21T21:10:54.797
> 
> 标签：svn

在我工作的地方，我们有一些非常大的存储库。我使用 Subversion 的稀疏目录功能非常有优势。但是，我不知道为什么我似乎无法对存储库进行空（或稀疏）签出，然后一举递归地“添加”长路径的目录。比如说，我有一个名为“project1”的存储库，其布局如下：

```
foo/
bar/
  baz/
  brak/
  schwing/yadda/etc/i386/package/ 
```

（请记住，这只是一个示例。真正的 repo 要复杂得多。）我希望（出于各种原因）让工作目录布局镜像 repo，除了我想省略一些路径，如“foo”和“bar/巴兹”完全。所以现在，我做这样的事情：

```
svn checkout --depth=empty svn+ssh://svn/project1 project1
cd project1
svn update --depth=empty bar
svn update --depth=empty bar/baz
svn update --depth=empty bar/baz/schwing
svn update --depth=empty bar/baz/schwing/yadda
svn update --depth=empty bar/baz/schwing/yadda/etc
svn update --depth=empty bar/baz/schwing/yadda/etc/i386
svn update --depth=infinity bar/baz/schwing/yadda/etc/i386/package 
```

我是密集还是没有更短的方法可以做到这一点？我检查了 SVN 文档并在 Google 上搜索得很好。我想做*的*是这样的：

```
svn checkout --depth=empty svn+ssh://svn/project1 project1
svn update --depth=infinity bar/baz/schwing/yadda/etc/i386/package 
```

这样“包”的所有父项都会自动添加到文件系统中（类似于“mkdir -p”），但除了路径中指定的子项之外，不会填充任何内容。当我尝试上面的命令时，SVN 甚至没有给出错误，它只是说路径被“跳过”并且检查工作目录显示没有发生任何事情。

我知道我可以编写一个 shell 函数来处理这个问题（并且可能会），但感觉应该有更好的方法。谢谢你的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T22:52:30.153

Subversion 旨在与 CVS 的工作流程兼容，并尽可能简单易用。稀疏结帐并不是真正需要的项目，因此该功能确实没有使用。在 95% 的项目中，开发人员想要签出特定目录，仅此而已。

但是，看到你在做什么，为什么不简单地这样做呢？

```
$ svn co svn+ssh://svn/project1/bar/baz/schwing/yadda/etc/i386/package project1-package 
```

`.profile`您还可以在您的or`.bashrc`文件中设置 URL 环境变量，如下所示：

```
PACKAGE_URL=bar/baz/schwing/yadda/etc/i386/package 
```

然后像这样使用它们：

```
$ svn co $svn+ssh://svn/project1/$PACKAGE_URL project1-package 
```

这样，您只需检查您正在使用的目录。

顺便说一句，有一些版本控制系统比 Subversion 更好地处理*稀疏签出。*例如，Perforce 很擅长。

当然，有了权力，你就失去了简单。为了从 Perforce 签出，您需要创建一个*视图*，将您正在签出的内容映射到哪个目录。你可以用 Perforce 的映射做各种花哨的事情，但大多数开发人员发现，复杂性带来的痛苦不值得你放弃轻松。

* * *

# 回复

> 如问题中所述，我需要工作目录布局或多或少地反映存储库的布局。（主要是为了一些自动化工具的好处。）我知道可以在 repo 中的任意路径启动他/她的工作目录。切换 VCS 不是一种选择，我工作的公司永远都在后端与 Subversion（很可能是特定版本）结婚。不过，感谢这些建议。– 伊尔

为了比较，我提到了 Perforce。我知道你不能随意切换 VCS，但 Subversion 确实没有做你想做的事，这主要是由于 Subversion 的初始设计。

Subversion 被设计为易于使用并遵循 CVS 工作流程。CVS 是最流行的版本控制系统，设计也很简单。我折腾了一些关于 Perforce 的内容，主要是强调这一点。Perforce 可以沉着地做你所要求的事情，但代价是额外的复杂性，这使得 Perforce 成为许多开发人员讨厌的东西。

您提到这与模仿您的构建工具有关，我不确定这意味着什么。

您的构建工具是否将内容放在结帐目录的超级目录中？对于构建工具来说，这通常是一件坏事。它限制了它们的有效性，并且可能导致副作用，因为构建可能会对用户的文件和目录产生不必要的影响。你可以修改构建不这样做吗？

也许您这样做了，因此可以将二进制文件检入构建树中的其他位置以供其他构建使用。[像Jenkins](http://jenkins-ci.org)这样的构建工具能够[将工件从一个构建作业复制到另一个构建作业](https://wiki.jenkins-ci.org/display/JENKINS/Copy+Artifact+Plugin)。这允许您共享构建工件，而无需先将它们检入和检出构建工具。这会解决你的问题吗？

也可以创建一个*工件存储库*。在 Java 世界中，Maven 和带有 Ivy 扩展的 Ant 都做得很好。甚至还有一个全球通用的第三方 Java 工件的存储库网络，并且很容易添加严格本地的构建环境。

在非 Java 世界中使用相同的 Java 工具在非 Java 世界中执行此操作并不难。我见过一些使用[Artifactory](http://www.jfrog.com/)之类的工具来存储 C++ 共享对象库的地方。`curl`一个标准的 Make 文件可以使用或在构建时获取所需的工件`wget`，并且大多数构建工具将构建的工件发送到 Artifactory 没有问题。

也许你`package2`迟早需要那个同级目录到`package`. 在您的原始方案中，您可以上一个目录，然后执行`svn update --set-depth=infinity package2`.

您可以通过单独的结帐执行类似的操作：

```
 $ svn co svn+ssh://svn/project1/bar/baz/schwing/yadda/etc/i386/package project1/bar/baz/schwing/yadda/etc/i386/package 
 $ cd ..
 $ svn co svn+ssh://svn/project1/bar/baz/schwing/yadda/etc/i386/package2 package2 
```

现在，您可以模仿存储库结构，但不必使用深度稀疏签出来完成所有工作。

如果以上都不能帮助你，除了可能编写一个脚本来为你进行稀疏结帐之外，你无能为力。您可以编写一个带有 URL 的脚本，然后为您将其解析为一系列稀疏检查，但标准 Subversion 命令行客户端中没有内置这样的功能。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-05-12T19:57:36.980

我真的不知道是否有使用命令行客户端执行此操作的正确方法（从其他响应看来没有），但如果您在 Windows 上使用[TortoiseSVN](http://tortoisesvn.net/)，这相当容易。

1.  在您感兴趣的顶级文件夹上进行稀疏结帐。
2.  右键单击文件夹并从 TortoiseSVN 集成资源管理器 shell 选项中选择“打开 repo 浏览器”
3.  浏览到您关心的嵌套子文件夹，右键单击并选择“将项目更新到修订版”
4.  在对话框中配置您需要的任何内容（默认值通常很好），然后按确定

# xcode - 在 XCode 中设置一个 var 用于构建

> ID：10692672
> 
> 赞同：1
> 
> 时间：2012-05-21T21:11:03.190
> 
> 标签：xcode

我不想设置全局 env-var，但是在 XCode 项目中设置单个 var 会很方便，然后可以在各种构建步骤中使用。例如，我想设置`MY_PATH = /usr/local/MyLib`然后`$(MY_PATH)`在搜索路径和`${MY_PATH}`脚本构建步骤中使用。

我正在使用 XCode 3.2.6。有没有办法设置项目本地环境变量或类似的？

更好的是，如果它没有存储在主项目文件中，因此无法将其签入源代码管理 - 也许我期望它与 Visual Studio 太相似了！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T21:17:09.970

添加用户定义的构建设置。通过选择 Project > Edit Project Settings，在 Xcode 3.2.6 中打开构建设置检查器（Xcode 4 改变了很多东西）。检查器的左下角是一个带有下拉菜单的按钮。单击按钮并选择添加用户定义的设置。

# ios - 从另一个 UIViewController 呈现 UIViewController 的视图

> ID：10692677
> 
> 赞同：0
> 
> 时间：2012-05-21T21:11:35.497
> 
> 标签：ios

我有一个棘手的问题。众所周知，Apple 明确表示 ONE UIViewController 应该在给定时间出现在屏幕上。

但是，如果你想实现一个注册工作流，视图很小，比如说...... 200px 高度？

您是否会遇到任何**真正的问题**.. 如果您附加一个 UINavigationController (320x200px) 作为子视图，并推送几个 UIViewControllers？

如果我采用 UIView 方法，我需要复制 UINavigationController 的行为。这没什么大不了的，但需要额外的时间。

此外，UIView 不应该有业务逻辑代码。因此，rootViewController 将处理整个注册流程。这没关系，但我真的宁愿把它分成几个类。

任何建议都将受到欢迎。提前致谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-21T21:22:41.090

您应该查看新的容器 ViewControllers。来自 Apple 的文档：

实现一个容器视图控制器

在 iOS 5.0 及更高版本中，自定义 UIViewController 子类也可以充当容器视图控制器。容器视图控制器管理它拥有的其他视图控制器的内容呈现，也称为它的子视图控制器。子视图可以按原样呈现，也可以与容器视图控制器拥有的视图一起呈现。

另请参阅[https://developer.apple.com/videos/wwdc/2011/?id=102](https://developer.apple.com/videos/wwdc/2011/?id=102)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-21T21:13:50.240

我建议保留 1 个视图控制器并仅推送视图。您还可以使用 TableViewController 和自定义单元格来执行类似的操作，您可以在工作流程的每个部分滚动浏览这些单元格，滚动视图可能会起作用。

# redirect - 如果 nginx 上存在查询参数，则重定向

> ID：10692681
> 
> 赞同：7
> 
> 时间：2012-05-21T21:11:58.543
> 
> 标签：redirect, nginx, rewrite, forum, ipb

我正在使用 IPB 论坛。我设法使用友好的 url 和 nginx 服务器配置修改。但是，我需要将旧论坛的 URL 重定向到重定向器 php 文件，以获取主题（或论坛、成员等）的当前 URL。例如：如果 url 是 like `/forum/index.php?board=23`，我将重定向到 redirector.php 。

这是我当前的配置，能够在 IPB 上使用友好的 URL

```
 location /forum {
        try_files $uri $uri/ /forum/index.php;
        rewrite ^ /forum/index.php? last;
    } 
```

当我在此位置块中插入 if 语句时，如下所示，我无法检索查询参数“board”。

```
location /forum {
        if ($arg_board != "") {
            rewrite ^ /redirector.php?q=$arg_board break;
        }
        try_files $uri $uri/ /forum/index.php;
        rewrite ^ /forum/index.php? last;
    } 
```

这里缺少什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-26T10:02:59.910

您的问题与使用 break 而不是 last 有关。从文档中：

[http://wiki.nginx.org/HttpRewriteModule#rewrite](http://wiki.nginx.org/HttpRewriteModule#rewrite)

> last - 完成当前重写指令的处理并重新启动该过程（包括重写），并从*所有可用位置*搜索 URI 上的匹配项。
> 
> break - 完成当前重写指令的处理，非重写处理仅在*当前位置块*内继续。

由于您没有在 /forum 位置块中为 /redirector 定义处理程序，因此您的 if(..) { rewrite } 不会执行您想要的操作。使该中断成为最后一个，以便重写可以触发适当的位置块。

# javascript - 如何创建“检查所有”JavaScript 方法

> ID：10692682
> 
> 赞同：0
> 
> 时间：2012-05-21T21:12:04.813
> 
> 标签：javascript

我很感兴趣如何创建一个调用 JavaScript 方法的按钮，该方法使 h:table(simple html table) 中的所有复选框都被选中？以及如何使用 JavaScript 方法再次取消选中表格中的所有复选框？你能给我看一些代码片段或工作示例吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-21T21:19:13.267

1.  创建一个按钮
2.  向按钮[添加事件侦听器。](https://developer.mozilla.org/en/DOM/element.addEventListener)在侦听器中，执行：
    1.  选择要选中所有框的表格元素，例如[按 Id](https://developer.mozilla.org/en/DOM/document.getElementById)
    2.  用于[`getElementsByTagName`](https://developer.mozilla.org/en/DOM/element.getElementsByTagName)输入元素
    3.  循环输入列表：
        *   如果[输入](https://developer.mozilla.org/en/DOM/HTMLInputElement)的类型是“复选框”，则将其`checked`属性设置为`true`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-21T21:19:06.977

```
<h:table>
    <input type="checkbox" />
    <input type="checkbox" />
</h:table>

<script>
    function checkBoxesForMe( checkBoxesOn )
    {
        var table = document.getElementsByTagName( 'h:table' )[ 0 ]
        var inputs = table.getElementsByTagName( 'input' )

        for( var i = 0; i < inputs.length; i ++ )
        {
            if( inputs[ i ].type == 'checkbox' ) 
            {
                if( checkBoxesOn )
                    inputs[ i ].setAttribute( 'checked', true )
                else
                    inputs[ i ].removeAttribute( 'checked' )
            }
        }
    }
</script> 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-21T23:58:04.330

以下功能应该是不言自明的：

```
function checkboxesCheckAll() {
  var boxes = document.getElementsByTagName('input');
  var i = boxes.length;
  while (i--) {
    if (boxes[i].type == 'checkbox') boxes[i].checked = true;
  }
}

function checkboxesCheckNone() {
  var boxes = document.getElementsByTagName('input');
  var i = boxes.length;
  while (i--) {
    if (boxes[i].type == 'checkbox') boxes[i].checked = false;
  }
}

function checkboxesCheckToggle() {
  var boxes = document.getElementsByTagName('input');
  var i = boxes.length;
  while (i--) {
    if (boxes[i].type == 'checkbox') boxes[i].checked = !boxes[i].checked;
  }
} 
```

或者你可以把它写成一个函数并传递一个参数来检查、取消检查或切换它们。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-21T21:17:01.967

你可以很容易地使用 jQuery 做到这一点：

选择所有

```
$("[type=checkbox]").prop("checked", true); 
```

取消所有：

```
$("[type=checkbox]").prop("checked", false); 
```

所以使用按钮：

```
<input type="checkbox" name="a">a<br/>
<input type="checkbox" name="b">b<br/>
<input type="checkbox" name="c">c<br/>
<input type="checkbox" name="d">d<br/>
<input type="checkbox" name="e">e<br/>
<button data-action="check">Check All</button>
<button data-action="uncheck">Uncheck All</button>​

$('button').click(function() {
    $("[type=checkbox]").prop("checked", $(this).data('action') === 'check');
})​ 
```

小提琴：http: [//jsfiddle.net/Bn386/](http://jsfiddle.net/Bn386/)

# java - 将 XML 文件解析为 DOM 时出错

> ID：10692693
> 
> 赞同：1
> 
> 时间：2012-05-21T21:13:01.077
> 
> 标签：java, android, xml, parsing, dom

我正在尝试使用 DocumentBuilderFactory 解析 XML 文件，如下所示：

```
DocumentBuilderFactory ndsParserFactory = DocumentBuilderFactory.newInstance( );
ndsParserFactory.setNamespaceAware( true );
DocumentBuilder ndsParser = ndsParserFactory.newDocumentBuilder( );
Document ndsDocument = ndsParser.parse( ndsFileInputStream ); 
```

其中 ndsFileInputStream 是包装包含 XML 的文件的 InputStream。

当文件包含 Unicode 字符（例如 Δ）时出现异常。当我删除包含违规字符的行时，解析工作得很好。

该文件包含特征`<?xml version="1.0" encoding="utf-8"?>`标头。

我想知道我是否忽略了正确配置 DocumentBuilderFactory（或 DocumentBuilder）实例以处理 Δ 字符。

**编辑**（来自评论）：

全面披露：这是 Android，我将 XML 文件（带有 NDS 文件扩展名）作为资产包含在我的 Android 应用程序中。我通过 AssetManager 访问它们，它有一个方便的方法可以将资产文件打开到 InputStream 中，然后我将其传递给 DocumentBuilder 的 parse 方法。– d 焊接 16 小时前

我注意到 assets 文件夹默认使用 CP1252 的编码作为其内容。所以我把它改成了UTF8。没运气。然后我从其中一个 NDS 文件（每个链接）中删除了 BOM 并再次尝试。没运气。我在想 APK 文件（像 ZIP 文件一样被压缩）以某种方式破坏了非 ASCII XML。我想我将不得不求助于通过其他方式将 NDS 文件放到 Android 设备上......

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-05-21T21:27:37.270

你确定文件真的写成 UTF-8 吗？显然，您可以在某个编辑器中打开它，它会正确显示文本，但它可能只是作为编码做出了很好的猜测。

要记住的另一件事是*所有*字符都是 UTF-8 中的 Unicode - 当解析器遇到在声明的编码中无效的字节序列时，它就会窒息。UTF-8 是一种非常宽容的编码，因为 7 位 ASCII 集中的任何字符都被编码为纯 ASCII，并且许多 XML 仅由纯 ASCII 字符组成。然后，当出现非 ASCII 的东西并且突然在通过系统的文本编码路径中的缺陷变得明显时，这会抓住人们。

您可以尝试编辑 XML 声明，看看它是否可以在另一种字符编码下解析；[8859-7](http://en.wikipedia.org/wiki/ISO/IEC_8859-7)包含 Δ 符号 - 可以用它编码吗？

另外，有什么例外？

# c# - 如何让我的客户端应用程序将我的 web 服务中的对象识别为它已经知道的类型？

> ID：10692694
> 
> 赞同：3
> 
> 时间：2012-05-21T21:13:06.613
> 
> 标签：c#, web-services, typing

所以我有一个返回自定义类型的网络服务

```
public List<MyNS.Product> GetProducts(string filter)
{
    ...
} 
```

`MyNS.Product`在另一个程序集中定义。我的客户端应用程序引用了相同的程序集。当我向我的客户端应用程序添加服务引用时，返回类型为`MyServiceReference.Product`.

```
var client = new MyServiceReference.dataSoapClient();
var products = client.GetProducts("derp");
// products type is MyServiceReference.Product[] 
```

如何让我的客户端应用程序识别返回的类型对象`MyServiceReference.Product`实际上是`MyNS.Product`它已经知道的类型？（数组部分的列表没什么大不了的，只是 T 类型）

Web 服务是作为网站一部分的常规 asmx。我正在执行“添加服务参考”以将服务添加到我在 Visual Studio 中的客户端项目中。

编辑：这是添加服务参考对话框中“高级”按钮的选项。我将集合类型从 Array 更改为 List。我还尝试使用 Product 类型专门选择我的库，但这也无济于事。

![添加服务参考选项](../Images/e655974452f9067681ae397363a714c1.png)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-21T21:20:28.877

添加服务引用时，告诉 VS 重用业务库中的对象。只要您的服务和客户端使用相同版本的业务库，Visual Studio 就会选择正确的类型而不是服务代理。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-21T21:18:56.243

如果不修改自动生成的 Web 服务参考代码（我不建议这样做），或者使用一个包装类来包装您的 Web 引用调用，该类接收并返回具有预期类型的​​对象，就无法做到这一点。

添加 Web 引用时，IDE 会根据通过 SOAP 返回的定义自动生成与 Web 服务接口匹配的类。因此，如果您使用像 Product 这样的复杂类型，它将自动生成它自己的具有相同公共属性的 Product 类。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-21T21:28:34.560

共享类型是 WCF 中引入的一项功能，但在旧的 asmx Web 服务中没有。对于旧的 ASMX，请尝试 SchemaImporterExtension：[链接](http://msdn.microsoft.com/en-us/library/w46ccb0h.aspx)

编辑：好的。所以我进行了测试，这可以通过手动创建服务合同、请求和响应类以及手动创建通道来完成。你需要`[XmlSerializerFormat]`在你的合同上设定并确保你的对象有`[SerializableAttribute]`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-21T21:31:01.130

由于您使用的是soap（.asmx 创建一个SOAP Web 服务），因此客户端应该能够从您的asmx 正在创建的soap 的wsdl 页面中提取类型，您只需要确保您传递的对象是xml 可序列化的。

作为一般规则，我将创建一个 dto（数据传输对象）来存储传递给客户端的数据，以确保它是可序列化的，并将其与我的应用程序的其余部分分离，以防止更新现有对象引起的问题。

这也适用于非 .NET 客户端，例如，您可以以相同的方式在 java 中使用来自 .NET 的 SOAP 调用

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-08-06T10:08:59.157

好吧，我知道这是一篇旧帖子，但（不幸的是）我有同样的问题，所以我想我可以分享我的解决方案。

**序幕**

我正在使用 asmx Web 服务（.net 2.0 版），并且我有一个 Web 方法，它返回一个自定义类型（具有 [serializable] 属性），该类型在两个项目（实际上是 Web 服务和客户端）的程序集中被引用分享。

我找到的解决方案是让 Visual Studio 为您创建客户端（在客户端项目中），然后修改创建的 Reference.cs 文件（要查看它，您必须打开“显示所有文件”）。

**注意**客户端项目的 .NET 版本也必须是 2.0

**但请注意！！**

作为自动生成的文件，如果您更新 Web 服务引用，所有更改都将丢失！所以要**多加**注意。

正如您在此文件（reference.cs）中看到的那样，使用所有属性重新创建自定义类型，并且如果类从另一个（如我的情况）inerith，也重新创建基类。明显的问题是重新创建的类型与共享程序集不同。

我找到的解决方案是重命名生成的类（例如：在名称 [YOUR_BASECLASS_NAME => _YOUR_BASECLASS_NAME] 之前放置一个“_”），然后在 Reference.cs 的“使用”部分中放置如下内容：

```
using YOUR_BASECLASS_NAME = SHAREDLIBRARY.BASECLASS
using YOUR_CLASS_NAME = SHAREDLIBRARY.CLASS 
```

对您使用的所有类执行此操作。

编译..等等瞧！我知道这不是一个很好的解决方案，但它是我发现的最聪明的。

# android - Android 相机的行为很奇怪

> ID：10692698
> 
> 赞同：0
> 
> 时间：2012-05-21T21:13:39.400
> 
> 标签：android, camera

我第一次在 Android SDK 中使用相机，就像大多数第一次出现问题一样......

我有我的肖像活动，但我的相机的方向非常奇怪。它从字面上翻转图像。因此，如果我从顶部伸出手指，它会从预览的左侧进入......我已经调整我的代码很长时间了，没有任何东西可以改变它。这是我的预览课：

```
@Override
public void surfaceChanged(SurfaceHolder holder, int f, int w, int h) {
    Camera.Parameters params = camera.getParameters();
    params.setPreviewSize(w,h);
    params.set("orientation", "portrait");
    camera.setParameters(params);
    camera.startPreview();
}

@Override
public void surfaceCreated(SurfaceHolder h) {
    try {
        camera = Camera.open();
        camera.setPreviewDisplay(h);
        camera.setPreviewCallback(new PreviewCallback(){
            @Override
            public void onPreviewFrame(byte[] data, Camera c) {
                FileOutputStream fos = null;
                try {
                    //if(!(new File(Environment.getExternalStorageDirectory()+"/MemeMe/Temp/").exists())){
                    //  
                    //}
                    File memeTempPath = new File(Environment.getExternalStorageDirectory()+"/MemeMe/Temp/");
                    File[] tempFiles = memeTempPath.listFiles();
                    for(int i = 0; i < tempFiles.length; i++){
                        tempFiles[i].delete();
                    }
                    fos = new FileOutputStream(String.format(Environment.getExternalStorageDirectory()+"/MemeMe/Temp/"+System.currentTimeMillis()));
                    fos.write(data);
                    fos.close();
                } catch (FileNotFoundException e) {
                    e.printStackTrace();
                } catch (IOException e) {
                    e.printStackTrace();
                }
                Preview.this.invalidate();
            }
        });
    } catch (IOException e) {
        e.printStackTrace();
    }
} 
```

现在这是我的活动：

```
setRequestedOrientation(ActivityInfo.SCREEN_ORIENTATION_PORTRAIT);

    preview = new Preview(this);
    previewL = (FrameLayout)findViewById(R.id.cameraLayout);
    previewL.addView(preview); 
```

我对这个问题感到很困惑。我认为预览应该根据方向改变......我也尝试做 params.setRotation() 并且做了我能想到的每个旋转 90,180,270,360 并且它根本没有改变它。

显现：

```
<uses-permission android:name="android.permission.WRITE_EXTERNAL_STORAGE" />
<uses-permission android:name="android.permission.CAMERA" />
<uses-feature android:name="android.hardware.camera" />
<uses-feature android:name="android.hardware.camera.autofocus" /> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T22:38:09.797

对于预览，有一种不同的方法来调整相机图像旋转......它在[setDisplayOrientation()](http://developer.android.com/reference/android/hardware/Camera.html#setDisplayOrientation%28int%29)的 android 文档中有详细描述。它从 API 级别 8 开始可用。

2.1 更新（7 级）：

在 2.2 之前，此代码通常有效

```
Camera.Parameters parameters = camera.getParameters();
parameters.set("orientation", "portrait"); // for some
parameters.set("rotation", 90);  // for others
// or parameters.setRotation(90);
camera.setParameters(parameters); 
```

问题是，它似乎停止在某些 2.2+ 的设备上工作，所以如果你真的需要支持 2.1+，你可以尝试反射`setDisplayOrientation`，如果它失败设置`"orientation"`参数

```
void setDisplayOrientation(Camera camera, int angle){
  try {
    Method method = camera.getClass().getMethod("setDisplayOrientation", new Class[] { int.class });
    if (method != null) {
      method.invoke(camera, new Object[] { angle });
      return;
    }
  } catch (Exception e) {}
  Camera.Parameters parameters = camera.getParameters();
  parameters.set("orientation", "portrait");
  parameters.set("rotation", 90);
  camera.setParameters(parameters);
} 
```

# php - Apache重写规则，重写参数以获取脚本的变量，拒绝访问脚本

> ID：10692700
> 
> 赞同：1
> 
> 时间：2012-05-21T21:13:41.200
> 
> 标签：php, apache

我正在尝试获取重写规则以获取一些参数并将它们转换为获取变量，然后将它们传递给脚本。

所以我的.htaccess中有以下内容，它有效：

```
RewriteEngine on

RewriteBase /cms/

RewriteRule ^services$  list.php?type=services  [L] 
```

然后我想添加另一个规则来**停止直接访问脚本** `list.php`。所以我添加了以下内容：

```
RewriteRule ^list.php   -    [F,NS] 
```

出于某种原因，每当我尝试访问以下网址时，都会出现“**禁止”错误：**

```
/cms/services 
```

我假设如果请求不是内部子请求，标志会阻止它被访问，但它似乎完全阻止了我访问脚本。

谁能告诉我这里哪里出错了。几天来，我一直在努力解决这个问题。.htaccess 文件位于通过虚拟主机中的别名访问的目录中，但我知道我的 htaccess 正在被读取，因为当我删除第二条规则时，第一个规则按预期工作。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-22T08:17:10.577

您对子请求问题是正确的。该`[NS]`标志应防止将此规则应用于内部子请求。我不知道为什么它没有按预期工作（因为您在 .htaccess 中而不是在 Directory 部分中？因为 mod_alias？）。无论如何，您可以尝试使用替代方法来测试**REDIRECT_STATUS**环境变量，这被证明比标记更可靠。

让我们尝试一下（未测试），我更喜欢使用长名称版本的标志，我认为 mod_rewrite 已经足够模糊了。另请注意，规则顺序**并不**重要。即使使用`[last]`标志，规则的结果也会重新应用于规则集。：

```
RewriteEngine on
RewriteBase /cms/

# RULE 1
# This rule will apply only from  a direct user access.
# If any other rewrite made an internal redirect we'll skeeze that rule
# so if access is provided after an internal redirect it's ok
# we catch it via the env variable REDIRECT_STATUS which must be empty
RewriteCond %{ENV:REDIRECT_STATUS} ^$  
# 403 FORBIDDEN if the user request direclty list.php!
RewriteRule ^list.php - [forbidden,last]

# RULE 2
# any request to service is in fact internally
# redirected to list.php?type=services
RewriteRule ^services$  list.php?type=services  [nocase, last] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-22T07:55:02.553

您应该尝试这样来防止访问特定文件：

```
<files list.php>
order allow,deny
deny from all
</files> 
```

现在任何访问 list.php 文件的尝试都将导致 403 错误消息。同样，您可以阻止访问您的 htaccess 文件。

# mysql - 在 LINQ to EF 查询中防止“NOW()”

> ID：10692707
> 
> 赞同：6
> 
> 时间：2012-05-21T21:13:56.757
> 
> 标签：mysql, linq, linq-to-entities

**更新**：我原来的问题是无效的，因为我误读了 MySql 日志。对不起。请看下文，已更新。

我正在使用 LINQ 查询：

```
var homework = ctx.Threads.Where(t => t.ClassName == "10L"
                                   && t.EndDate != null
                                   && t.StartDate <= DateTime.Now
                                   && t.EndDate > DateTime.Now)
                          .OrderByDescending(o => o.EndDate)
                          .FirstOrDefault(); 
```

这将创建 SQL (MySQL 5.5.14)：

```
SELECT
`Project1`.`id`,
`Project1`.`title`,
`Project1`.`startdate`,
`Project1`.`enddate`,
`Project1`.`class`,
`Project1`.`body`,
`Project1`.`threadtype`
FROM (SELECT
     `Extent1`.`id`,
     `Extent1`.`title`,
     `Extent1`.`startdate`,
     `Extent1`.`enddate`,
     `Extent1`.`class`,
     `Extent1`.`body`,
     `Extent1`.`threadtype`
     FROM
     `threads` AS `Extent1`
     WHERE (((`Extent1`.`class` = '10L')
         AND (`Extent1`.`enddate` IS NOT NULL))
         AND (`Extent1`.`startdate` <= (NOW())))
         AND (`Extent1`.`enddate` > (NOW())))
AS `Project1`
ORDER BY `Project1`.`enddate` DESC
LIMIT 1 
```

LINQ to EF 如何知道使用该`NOW()`函数？当然，我只是`DateTime`按值传递一个常规结构吗？

如果我在 LINQ 查询中使用`var now = DateTime.Now;`然后使用该`now`变量，则日期将作为文字传递。这是怎么回事？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-21T21:38:41.900

LINQ-to-whatever 通过解析表达式树来将 .NET 代码转换为适当的 SQL 语言来运行。这允许查询尽可能多地在数据库端而不是客户端处理。结果，当你说：

```
... myField <= DateTime.Now 
```

解析器使用表达式引用`DateTime.Now`，而不对其进行评估，以便将尽可能多的代码转换为适当的 SQL 语言。这就是 LINQ 高效工作的原因，但作为副作用，查询中的*所有内容都*被解释为表达式并尝试转换为适当的 SQL 代码。当您将其存储在变量中时，如下所示：

```
var now = DateTime.Now; 
```

该值被立即评估并存储到`now`中，并且该值在您的查询中按字面意思使用，而不是表达式。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-21T21:38:57.870

`DateTime.Now`是一个函数（Now 属性的 getter），因此 linq2EF 在尝试创建表达式树时会将其视为函数。这就像说，`.ToString()`link2EF 中的工作原理。此外，当您从临时变量中使用它时，它将被视为临时变量，就像您将结果保存`.ToString()`在临时变量中一样，最终更改不会影响您的输出。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-20T22:27:33.930

很好的问答。我只是想在使用 Microsoft SQL Server 2008 R2 的环境中添加它，`DateTime.Now`在 LINQ to Entities 查询中引用会生成以下 SQL 表达式：

`CAST( SysDateTime() AS datetime2)`

我相信这将类似于`NOW()`在 MySQL 中生成，因此无论底层数据库如何，都会看到相同的行为。

当然，如果您想要运行 LINQ 代码的本地时间而不是数据库服务器，那么这种行为可能会成为问题。正如预期的那样，分配`DateTime.Now`给局部变量并在 LINQ 表达式中使用它的解决方法在 MS SQL 中运行良好。

# css - 改变背景图像的宽度？

> ID：10692709
> 
> 赞同：0
> 
> 时间：2012-05-21T21:14:03.390
> 
> 标签：css

我试图改变宽度，但它只改变了 div 的宽度。
如何使用 css 更改图像的宽度？

```
#photoTable {
    background-image: url("Assets/Images/FrontImages/partyPhoto.jpg");
    height: 628px;
    vertical-align: top;
    width: 704px;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-21T21:17:52.357

使用该`background-size`物业。您可以将其设置为宽度和高度，`cover`或`contain`. `100% 100%`不过，可能最接近你想要的。

```
#photoTable {
    background-image: url("Assets/Images/FrontImages/partyPhoto.jpg");
    background-size: 100% 100%;
    height: 628px;
    vertical-align: top;
    width: 704px;
} 
```

不适用于 IE 8 或更低版本。

# wcf - 无法让 WCFExtras 与 WCF 服务一起使用

> ID：10692710
> 
> 赞同：2
> 
> 时间：2012-05-21T21:14:18.620
> 
> 标签：wcf, wsdl

我收到一个错误，我无法下拉服务的元数据。当我查看 WCFExtras 示例时，一切看起来都很好，并且示例运行良好。唯一的区别是我的 WCF 服务是 .NET 4.0。

这就是我的 web.config 的样子：

```
<?xml version="1.0"?>
<configuration>
  <system.web>
    <compilation debug="true" targetFramework="4.0"/>

    <customErrors mode="Off" />

  </system.web>

  <system.webServer>
    <modules runAllManagedModulesForAllRequests="true" />
    <validation validateIntegratedModeConfiguration="false" />
    <directoryBrowse enabled="true" />
  </system.webServer>

  <system.serviceModel>
    <services>
      <service behaviorConfiguration="CDITecServices.TECServiceHelperBehavior"
               name="CDITecServices.ITECServiceHelper">
        <endpoint address=""
          behaviorConfiguration="CDITecServices.TECServiceHelperEndpointBehavior"
          binding="basicHttpBinding" contract="CDITecServices.ITECServiceHelper"/>
      </service>
    </services>

    <behaviors>
      <endpointBehaviors>
        <behavior name="CDITecServices.TECServiceHelperEndpointBehavior">
          <wsdlExtensions singleFile="True"/>
        </behavior>
      </endpointBehaviors>
      <serviceBehaviors>
        <behavior name="CDITecServices.TECServiceHelperBehavior">
          <serviceMetadata httpGetEnabled="true" />
          <serviceDebug includeExceptionDetailInFaults="true"
                        httpHelpPageEnabled="false" />
        </behavior>
      </serviceBehaviors>
    </behaviors>
    <extensions>
      <behaviorExtensions>
        <!-- Declare that we have an extension called WSDL Extras-->
        <add name="wsdlExtensions"
             type="WCFExtras.Wsdl.WsdlExtensionsConfig, WCFExtras, Version=1.0.0.0,
                   Culture=neutral, PublicKeyToken=null"/>
      </behaviorExtensions>
    </extensions>

    <serviceHostingEnvironment aspNetCompatibilityEnabled="true"
                               multipleSiteBindingsEnabled="true"/> 
  </system.serviceModel>

</configuration> 
```

这是我的界面的样子：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Runtime.Serialization;
using System.ServiceModel;
using System.Text;
using WCFExtras.Wsdl.Documentation;

namespace CDITecServices
{
    [XmlComments]
    [ServiceContract]
    public interface ITECServiceHelper
    {

        [OperationContract]
        void DownloadDataFile(string OrderTicketId, string Username,
                              string Password, string UserDatabase);

        [OperationContract]
        List<string> GetRecordsFromFile(string OrderTicketId, ref long StartIndex);

        // TODO: Add your service operations here
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-22T07:11:39.393

将您的服务名称从更新`CDITecServices.ITECServiceHelper`为类名`CDITecServices.TECServiceHelper`

```
<service behaviorConfiguration="CDITecServices.TECServiceHelperBehavior" name="CDITecServices.TECServiceHelper"> 
```

<service> 标记上的 name 属性必须与您的服务类的名称匹配，完全限定包括命名空间。

# unix - Unix重定向csv文件

> ID：10692711
> 
> 赞同：1
> 
> 时间：2012-05-21T21:14:21.883
> 
> 标签：unix, redirect, csv, cut

刚从 Unix 开始，需要锻炼这个：-

我有一个包含 3 列的 csv 文件。在 Unix 中使用终端我需要剪切列并获取每一列以创建列中信息的文本文件。

第 1 栏 第 2 栏 第 3 栏

col1.txt col2.txt col3.txt

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T21:24:00.267

这个“oneliner”脚本应该会有所帮助 :) 只需将 CSV 数据插入 q.csv 文件或更改脚本中的文件名。

```
 for i in `cat q.csv`; do  echo $i|awk  -F, ' { print $1 } ' >> 1.txt  ; echo $i|awk  -F, ' { print $2 } ' >> 2.txt; echo $i|awk  -F, ' { print $3 } ' >> 3.txt; done 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-21T21:24:52.263

你熟悉[awk](http://en.wikipedia.org/wiki/Awk)吗？

假设您有一个 csv 文件，列使用逗号分隔，以下将仅输出第二列：

```
awk -F "," '{print $2}' yourFilename.txt 
```

# google-app-engine - 如何在应用引擎中使用 cron 计划请求启动动态后端

> ID：10692716
> 
> 赞同：1
> 
> 时间：2012-05-21T21:15:06.947
> 
> 标签：google-app-engine, cron, backend

我正在尝试使用 cron 任务启动动态后端，但是在部署后，我在 cron 选项卡下看不到新的 cron 任务，而且在我的后端选项卡下也看不到任何后端实例。我究竟做错了什么？

编辑：现在 cron 作业运行正常（在我将计划更改为“每 1 分钟”之后。但是后端拒绝运行。cron 选项卡说`on time Failed`。也许我需要在我的 app.yaml 或类似的东西中定义一些处理程序？

EDIT2：使用 appcfg 更新后端列表后，我可以看到我在后端选项卡下定义的后端。现在我只需要等待，看看它是否有效（有人知道用浏览器向后端发出 get 请求的方法吗？我不想等待一个小时来看看它是否正在运行（cron 任务运行现在每小时）。

## 我的代码

我的 cron.yaml 文件：

```
cron:
- description: crawler backend activation
  url: /crawl
  target: crawler
  schedule: every minute 
```

我的 backends.yaml 文件：

```
backends:
- name: crawler
  class: B1
  instances: 1
  start: crawler.application
  options: dynamic 
```

我的后端处理程序 crawl.py：

```
import logging
import webapp2 as webapp

class Handler(webapp.RequestHandler):
    logging.debug('crawler started')

application = webapp.WSGIApplication([('/crawl', Handler)]) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-21T22:32:46.973

尝试使用这种 cron 格式：

```
schedule: every 1 minutes 
```

注意：如果你每分钟调用一次动态后端，它永远不会关闭，因为 AFAIK 关闭延迟是 15 分钟。在这种情况下，您可能想要使用常驻后端。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-22T07:00:12.580

我发现您的代码存在一些问题。首先，您的启动处理程序被称为`crawl.py`，但您的`backends.yaml`指的是`crawler.py`. 其次，中指定的启动处理程序`backends.yaml`仅指定启动请求的处理程序文件 - 所有其他请求，例如由 cron 创建的请求，都会`app.yaml`像常规请求一样通过并路由到处理程序。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-22T07:47:42.193

我缺少的另一件事-显然常规部署命令不会更新后端，因此我需要一个新的批处理文件来执行此操作：

```
echo <password> | python "C:\Program Files (x86)\Google\google_appengine\appcfg.py" --email=<myemail> backends <app src folder path> update 
```

# .net - .net 桌面离线应用程序的 SCORM？

> ID：10692718
> 
> 赞同：0
> 
> 时间：2012-05-21T21:15:14.733
> 
> 标签：.net, standards, desktop-application, scorm

我公司开发电子学习内容以及创作和播放内容的平台。课程创作工具和学生客户端都是基于 .net 的离线桌面应用程序。

我们正在考虑是否可以使用来自其他创作工具（例如 Adob​​e Articulate）的内容。

如果我们的产品符合SCORM，这个问题会得到解决吗？或者是否有任何其他基于离线桌面的应用程序要遵循的标准？

谢谢阿文德

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-22T05:28:16.650

据我所知，SCORM是基于网络的应用程序和基于网络的学习内容的标准。如果要支持 Articulate 或其他产品，则必须支持 SCORM 或 AICC 等标准。

如果您有任何其他问题，可以查看[http://support.scorm.com/home](http://support.scorm.com/home)

# android - 如何在 Android 上的 ListView 中对 RadioGroup 进行编程

> ID：10692721
> 
> 赞同：0
> 
> 时间：2012-05-21T21:15:30.593
> 
> 标签：android, listview, radio-button, radio-group, custom-adapter

我的句柄 RadioGrup 有问题。应用程序从 OCR 中获取字符串，该字符串被剪切并扔到带有 4 个 RadioButtons 的列表视图列表上的适配器中，并且它已经在运行。 [http://dl.dropbox.com/u/158361/screenshot-1336249818620.png](http://dl.dropbox.com/u/158361/screenshot-1336249818620.png)

如屏幕截图所示，我根据按下的单选按钮将列表中的项目返回到 4 EditText。选择raiobutton后如何发送字符串？

我的代码：

```
public class ocrResults extends Activity implements OnClickListener {
public static final int CAPTURE_ACTIVITY_REQUEST_CODE = 1;
public ListaAdapterResults listaAdapterRes;
public ListView id_list_tokens;     
public String[] splittedArray;
String tag = "Events";

public EditText etNazwa;
public EditText etAdres;
public EditText etGodziny;
public EditText etTelefon;
public RadioGroup radioGroup;

private View.OnClickListener onSave=new View.OnClickListener() {
   public void onClick(View v) {
      RadioSelect rs = new RadioSelect();
      rs.setItem(etNazwa.getText().toString());
      rs.setItem(etAdres.getText().toString());
      rs.setItem(etGodziny.getText().toString());
      rs.setItem(etTelefon.getText().toString());

      radioGroup=(RadioGroup)findViewById(R.id.group);

      switch (radioGroup.getCheckedRadioButtonId()) {
       case R.id.rbName:
           rs.setType("rbName");
           //etNazwa.setText(splittedArray[pos]);
           break;
       case R.id.rbAdres:
           rs.setType("rbAdres");
           break;
       case R.id.rbGodziny:
           rs.setType("rbGodziny");
           break;
       case R.id.rbTelefon:
           rs.setType("rbTelefon");
           break;
      }
      etNazwa.setText("");
      etAdres.setText("");
      etGodziny.setText("");
      etTelefon.setText("");
      radioGroup.clearCheck();
      Log.d(tag," potwierdz");
  }
};

@Override
protected void onCreate(Bundle savedInstanceState) {
   super.onCreate(savedInstanceState);
   setContentView(R.layout.ocrresultsactivity);
   setRequestedOrientation(ActivityInfo.SCREEN_ORIENTATION_LANDSCAPE);

   id_list_tokens = (ListView)findViewById(R.id.id_list_tokens);
   etNazwa  =(EditText)findViewById(R.id.EtResNazwa);
   etAdres  =(EditText)findViewById(R.id.EtResAdres);
   etGodziny=(EditText)findViewById(R.id.EtResGodziny);
   etTelefon=(EditText)findViewById(R.id.EtResTelefon);

   View btn_Zatw1 = findViewById(R.id.btnZatw1);
    btn_Zatw1.setOnClickListener(onSave);//this
   View btn_OCRmake1 = findViewById(R.id.btnOCRmake1);
    btn_OCRmake1.setOnClickListener(this);
   View btn_backtomain1 = findViewById(R.id.btnbacktomain1);
    btn_backtomain1.setOnClickListener(this);
   }
   @Override
   public void onClick(View v) {
  switch (v.getId()){
     case R.id.btnOCRmake1:
        Intent myIntent = new Intent(ocrResults.this, CaptureActivity.class);
        startActivityForResult(myIntent, CAPTURE_ACTIVITY_REQUEST_CODE);
        break;
     case R.id.btnbacktomain1:
        startActivity(new Intent(ocrResults.this, and4ph.class));
        finish();
        break;
  }
    }
    @Override
    protected void onActivityResult(int requestCode, int resultCode, Intent data) {
   if (resultCode == RESULT_OK) {
        if (CAPTURE_ACTIVITY_REQUEST_CODE == requestCode) {
            String response = data.getStringExtra(edu.sfsu.cs.orange.ocr.CaptureActivity.RESPONSE);
            insertResponse(response);
        }
   }
    }
    private void insertResponse(String response) {
    String strResult = response;
    splittedArray = strResult.split(" ");   //(strResult, ' ');
    Context context = getApplicationContext();

    initListViewResp();
    }
    void initListViewResp() {           //Inicjalizacja ListView
    listaAdapterRes = new ListaAdapterResults(this, splittedArray);
    id_list_tokens.setAdapter(listaAdapterRes);

    //      if (mbutton[0] == true) { 
    //      mbutton[0]=holder.rb_Name;
    //       } else {
    //             // Get the ViewHolder back to get fast access to the ImageView.
    //             holder = (ViewHolder) convertView.getTag();
    //             holder.dealImage.setBackgroundColor(Color.WHITE);
    //             dealImage = holder.dealImage;
    //         }

    id_list_tokens.setOnItemClickListener(new OnItemClickListener() {
        public void onItemClick(AdapterView<?> parent, View v, int pos, long id) {
          Toast.makeText(getApplicationContext(), splittedArray[pos], Toast.LENGTH_SHORT).show();
        }
    });
    //getCheckedRadioButtonId();
    updateListView();
}
private void updateListView() {
    listaAdapterRes.notifyDataSetChanged();
}    
    } 
```

还有我的适配器：

```
public class ListaAdapterResults extends ArrayAdapter<String> {
    String tag = "Events";
    private Activity context;
    private String[] splittedArray;

    public ListaAdapterResults(Activity context, String[] splittedArray){
        super(context, R.layout.wiersz_tokenu, splittedArray);
        this.context        = context;
        this.splittedArray  = splittedArray;
    }
    public long getItemId(int position) {
        return position;
    }
    static class ViewHolder {
        private TextView     tv_Token;
        private RadioButton rb_Name;
        private RadioButton rb_Adres;
        private RadioButton rb_Godziny;
        private RadioButton rb_Telefon;
        private RadioGroup rgroup;
    }
    @Override
    public View getView(int position, View convertView, ViewGroup parent) {
        Log.d(tag," 3");
        View rowView = convertView;
        ViewHolder holder= null;
        RadioButton[] mbutton = null;

        if(rowView == null) {
          LayoutInflater inflator = (LayoutInflater)context.getSystemService(Context.LAYOUT_INFLATER_SERVICE);
          rowView = inflator.inflate(R.layout.wiersz_tokenu, parent, false);
          holder = new ViewHolder();
          holder.rgroup     = (RadioGroup) rowView.findViewById(R.id.group);
          holder.tv_Token   = (TextView) rowView.findViewById(R.id.tvToken);

          holder.rb_Name    = (RadioButton)rowView.findViewById(R.id.rbName);
          holder.rb_Adres   = (RadioButton)rowView.findViewById(R.id.rbAdres);
          holder.rb_Godziny = (RadioButton)rowView.findViewById(R.id.rbGodziny);
          holder.rb_Telefon = (RadioButton)rowView.findViewById(R.id.rbTelefon);

          mbutton=new RadioButton[4];
            mbutton[0]=holder.rb_Name;
            mbutton[1]=holder.rb_Adres;
            mbutton[2]=holder.rb_Godziny;
            mbutton[3]=holder.rb_Telefon;

          for(int i=0;  i<4; i++) {
              mbutton[i]=new RadioButton(context);
              //mbutton[l].setText("test"+l);
              //holder.rgroup.addView(mbutton[i]);
          }

          holder.rgroup.setOnCheckedChangeListener(new RadioGroup.OnCheckedChangeListener() {
               public void onCheckedChanged(RadioGroup mRadioGroup, int checkedId) {

                   for(int i=0; i<mRadioGroup.getChildCount(); i++) {

                       RadioButton rbtn = (RadioButton) mRadioGroup.getChildAt(i);
                       //int t=table.indexOfChild(table_row);   //System.out.println(t);

                       int t = mRadioGroup.getId();
                       System.out.println(t);

                       if(rbtn.getId() == checkedId) {
                           String text = rbtn.getText().toString();
                           // do something with text
                           //etNazwa.setText(text);

                           RadioSelect rs = new RadioSelect();
//                        rs.setItem(etNazwa.getText().toString());
//                        rs.setItem(etAdres.getText().toString());
//                        rs.setItem(etGodziny.getText().toString());
//                        rs.setItem(etTelefon.getText().toString());
//                        mRadioGroup=(RadioGroup)findViewById(R.id.radioGroupTypET);

                          switch (mRadioGroup.getCheckedRadioButtonId()) {
                           case R.id.rbName:
                               rs.setType("rbName");
                                     //String text = rbtn.getText().toString();
                                     //etNazwa.setText(text);
                               break;
                           case R.id.rbAdres:
                               rs.setType("rbAdres");
                               break;
                           case R.id.rbGodziny:
                               rs.setType("rbGodziny");
                               break;
                           case R.id.rbTelefon:
                               rs.setType("rbTelefon");
                               break;
                          }
                          Log.d(text," radioButtonSelect");
                          return;
                        }
                    }
                }
          });
          rowView.setTag(holder);
          Log.d(tag,"me");
       } else {
          holder = (ViewHolder) convertView.getTag();
//        mbutton = holder.rgroup;
          Log.d(tag,"meeee");
       }
       ViewHolder holder1 = (ViewHolder) rowView.getTag();
       holder1.tv_Token.setText(splittedArray[position]);
       Log.d(tag," event7");

       holder.tv_Token.setText(splittedArray[position]);
       holder.rb_Name.setTag(new Integer(position));
       holder.rb_Adres.setTag(new Integer(position));
       holder.rb_Godziny.setTag(new Integer(position));
       holder.rb_Telefon.setTag(new Integer(position));
//      public void onCheckedChanged(RadioGroup rgroup,int checkedId){  }
      return rowView;
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-23T09:46:55.930

在您的getView 方法中`holder.rgroup.setOnCheckedChangeListener`为editText 设置值。例如

```
 String text = rbtn.getText().toString();
     etNazwa.setText(text); 
```

看起来您已对此代码进行了注释，但参数错误。你有`etNazwa.setText(response);`而且应该是 `etNazwa.setText(text);`

# objective-c - UITableViewCell setSelectedBackground 未正确显示框架

> ID：10692725
> 
> 赞同：2
> 
> 时间：2012-05-21T21:15:55.797
> 
> 标签：objective-c, ios, cocoa-touch

我在 cellForRowAtIndexPath 方法中为 UITableViewCell 正确设置 selectedBackgroundView 时遇到了一些困难。我尝试了一些代码变体......

```
CGRect customFrame = CGRectMake(cell.frame.origin.x + 1.0f, cell.frame.origin.y,
cell.frame.size.width - 22.0f, cell.frame.size.height);

UIView *cellBackground = [[[UIView alloc] initWithFrame:customFrame] autorelease];
cellBackground.backgroundColor = [UIColor colorWith8BitRed:0 green:0 blue:0 alpha:0.1f];
cell.selectedBackgroundView = cellBackground; 
```

使用此代码段，单元格显示出正确的颜色变化，但框架尺寸不是我指定的（它们似乎是 cell.frame 的尺寸，即使我指定了要使用我的 customFrame 初始化的视图）

我尝试了另一种方法：创建带有子子视图的父视图。父视图的框架与单元格的尺寸相同，子视图的框架包含我的 customFrame 尺寸。当我将父视图设置为背景视图时，将应用我的框架 customFrame 尺寸。但是，当我尝试将父视图设置为 selectedBackgroundView 时，选择单元格时看不到任何视图。

```
CGRect customFrame = CGRectMake(cell.frame.origin.x + 1.0f, cell.frame.origin.y, 
cell.frame.size.width - 22.0f, cell.frame.size.height);

UIView *parentView = [[[UIView alloc] initWithFrame:cell.frame] autorelease]; 
UIView *childView = [[[UIView alloc] initWithFrame: customFrame] autorelease];

[parentView addSubview:childView];
childView.backgroundColor = [UIColor colorWith8BitRed:0 green:0 blue:0 alpha:0.1f];
cell.selectedBackgroundView = parentView; 
```

自定义 selectedBackgroundView 的框架尺寸似乎相当困难。任何帮助，将不胜感激。谢谢！

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-04-26T21:07:39.457

您在自定义 TableViewCell 中需要这个

```
- (void)layoutSubviews
{
    [super layoutSubviews];
    self.selectedBackgroundView.frame = CGRectMake(cell.frame.origin.x + 1.0f, cell.frame.origin.y, cell.frame.size.width - 22.0f, cell.frame.size.height);
} 
```

我不得不挠头。这有点愚蠢，因为一种或另一种方式你需要两倍的帧。当然，您可以使用`define`甚至是`UIView`自身的属性，但仍然......

**多亏了Ortwin Gentz**，我才能找到这一点——对他的支持！

# javascript - 隐藏 div，显示另一个...然后隐藏，在鼠标单击时显示另一个

> ID：10692730
> 
> 赞同：3
> 
> 时间：2012-05-21T21:16:06.683
> 
> 标签：javascript, jquery

我试图隐藏一个 div，然后在单击 div 中的图像时显示下一个 div。再次单击时，隐藏该 div 并加载下一个，等等。

下面的作品，但意识到它并不漂亮。什么是更好的方法来做到这一点，而不使用内联 javascript？

我还尝试添加一个“下一步”按钮，该按钮将隐藏 div 并显示下一次潜水......因此用户无需单击`a href`div 即可加载下一项。

谢谢！

```
function replace( hide, show ) {
  document.getElementById(hide).style.display="none";
  document.getElementById(show).style.display="block";
} 
```

身体...

```
<div id = "div1" style="display:block" onclick = "replace('div1','div2')"><a href="link1.html" target="_blank"><img src="images/a.jpg"></a></div>
<div id = "div2" style="display:none" onclick = "replace('div2','div3')"><a href="link2.html" target="_blank"><img src="images/b.jpg"></a></div>
<div id = "div3" style="display:none" onclick = "replace('div3','div4')"><a href="link3.html" target="_blank"><img src="images/c.jpg"></a></div>
<div id = "div3" style="display:none" onclick = "replace('div4','div5')"><a href="link4.html" target="_blank"><img src="images/.jpg"></a></div>
... 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-21T21:55:19.740

## *[演示 jsBin](http://jsbin.com/uyaren/3/edit)*

但是，如果您希望图像在单击后执行“前进”，那么为什么要将它们包装在可使用 ?`a`链接到其他页面的元素中`target="_blank"`？

同时这里是简化的 HTML：

```
<div id="gallery">  
  <a href="link1.html" target="_blank"><img src="img1.jpg"></a>
  <a href="link2.html" target="_blank"><img src="img2.jpg"></a>
  <a href="link3.html" target="_blank"><img src="img3.jpg"></a>
  <a href="link4.html" target="_blank"><img src="img4.jpg"></a>  
</div> 
```

...以及这对 jQ/javascript 行：

```
var i = 0;                       // set desired starting one // zero based                         
var N = $('#gallery >*').length; // get number of childrens

function advance(){
    $('#gallery >*').hide().eq(i++%N).show();
}
advance();

$('#next').click( advance ); 
```

* * *

使用此脚本，您也可以轻松触发`advance`单击图像的功能，但您必须防止在`anchor`功能内部使用单击行为`return false`：

## *[带有可点击图像的 jsBin 演示](http://jsbin.com/uyaren/4/edit)*

```
var i = 0;                            
var N = $('#gallery >*').length;

function advance(){
  $('#gallery >*').hide().eq(i++%N).show();
  return false;   // remove that line to make the gallery advance but the same time go to the desired link-page
}
advance();

$('#next, #gallery >*').click( advance ); // comma separate the elements that will trigger the function 
```

* * *

如果你想要一个更“花哨”的效果，你可以：

## *[带有淡入淡出效果的 jsBin 演示](http://jsbin.com/uyaren/5/edit)*

编码：

```
var i = 0;                            
var N = $('#gallery >*').length;

$('#gallery >*').hide().eq(i++%N).show(); // the initial adjustment (on DOM ready)

function advance(){
  $('#gallery >*').stop().fadeTo(900,0).eq(i++%N).stop().fadeTo(900,1);
}

$('#next, #gallery >*').click( advance );    // trigger the fade advance/effect function 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-21T21:45:41.647

我建议，鉴于 jQuery 似乎是一个选项：

```
$('div').not(':first').hide();
$('div a').click(
    function(e){
        e.preventDefault();
        var that = $(this).closest('div'),
            duration = 1200;
        if (that.next('div').length){
            that.fadeOut(duration,
                         function(){
                             that.next('div').fadeIn(duration);
                         });
        }
    });​​​​​​​​​​​ 
```

[JS 小提琴演示](http://jsfiddle.net/davidThomas/BYqrk/)。

* * *

**针对 OP 的评论进行了**编辑，如下：****

 **> 无论如何要这样做，所以当您单击图像时，a href target=_blank 有效吗？

有点，是的。但是假设您想要的只是打开一个新窗口以响应单击（并从`a`该窗口打开该窗口），然后只需使用：`href``a``window.open()`

```
$('div').not(':first').hide();
$('div a').click(
    function(e){
        e.preventDefault();
        var newWin = window.open(this.href,'newWindow'),
            that = $(this).closest('div'),
            duration = 1200;
        if (that.next('div').length){
            that.fadeOut(duration,
                         function(){
                             that.next('div').fadeIn(duration);
                         });
        }
    });​ 
```

[JS 小提琴演示](http://jsfiddle.net/davidThomas/BYqrk/1/)。

* * *

**编辑**以稍微改进脚本，根据 Roko 的评论，“循环会很好”（我最初误解了，但现在假设他的意思是从最后一张图像移动到第一张图像，而不是简单地失败/停止）：

```
$('div').not(':first').hide();
$('div a').click(
    function(e){
        e.preventDefault();        
        var newWin = window.open(this.href,'newWin'),
            that = $(this).closest('div'),
            duration = 1200;
        if (that.next('div').length){
            that.fadeOut(duration,
                         function(){
                             that.next('div').fadeIn(duration);
                         });
        }
        else {
            that.fadeOut(duration,
                         function(){
                             that.prevAll('div:last').fadeIn(duration);
                         });
        }
    });​ 
```

[JS 小提琴演示](http://jsfiddle.net/davidThomas/BYqrk/2/)。

参考：

*   [`fadeIn()`](http://api.jquery.com/fadeIn/).
*   [`fadeOut`](http://api.jquery.com/fadeOut/).
*   [`:first`选择器](http://api.jquery.com/first-selector/)。
*   [`hide()`](http://api.jquery.com/hide/).
*   [`:last`选择器](http://api.jquery.com/last-selector/)。
*   [`next()`](http://api.jquery.com/next/).
*   [`not()`](http://api.jquery.com/not/).
*   [`prevAll()`](http://api.jquery.com/prevAll/).
*   [`window.open()`](https://developer.mozilla.org/en/DOM/window.open).

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-21T21:22:38.147

给你所有的 div 一个`onclick="hideMeShowNext(this)"`

并定义函数

```
<script>

function hideMeShowNext( element )
{

element.style.display = 'none'
element.nextSibling.style.display = 'block'

}

</script> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-21T21:38:45.393

您是否希望链接能够正常工作，然后在新页面上显示所选图像？

如果不 ：

```
var elems = $('div[id^="div"]');
elems.not(':first').hide();

elems.on('click', function(e) {
    e.preventDefault();
    elems.hide();
    $(this).next().show();
}); 
```

HTML

```
<div id="div1"><a href="link1.html" target="_blank"><img src="images/a.jpg"></a></div>
<div id="div2"><a href="link2.html" target="_blank"><img src="images/b.jpg"></a></div>
<div id="div3"><a href="link3.html" target="_blank"><img src="images/c.jpg"></a></div>
<div id="div4"><a href="link4.html" target="_blank"><img src="images/.jpg"></a></div>​​​​​​​​​​​​​​​​​​​​ 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-26T12:01:07.103

此外，您可以同时使用两个功能

```
<script>
function hideMeShowNext( element )
{
element.style.display = 'none'
element.nextSibling.style.display = 'block'
}
</script>

then render this anywhere in your page//you can change <A> to <Div>
<a href="" onclick="hideMeShowNext('first');hideMeShowNext('second');">Click Me</a> 
```

如果它不起作用，则使用

```
<script type="text/javascript">
function myfnction() {
hideMeShowNext('first');
hideMeShowNext('second');
}
</script>

<a href="" onclick="myfunction();"> blabla </a> 
```**

# oop - 基类是否应该包含引用派生类的方法？

> ID：10692734
> 
> 赞同：1
> 
> 时间：2012-05-21T21:16:33.860
> 
> 标签：oop, inheritance, derived-class, base-class

在知道派生类的基类中创建一个方法是一种好的 OO 编程实践吗？

例如，考虑 A、B、C、D 类，其中 B 类从 A 继承，C 和 D 类从 B 继承。现在考虑一个方法，该方法对从 A 继承的所有类（包括 A 本身）通用，并且需要了解 B 类以便工作（例如：A/B/C/ 或 D 类对象与对象 B 的相对距离）。由于此方法对所有类（A、B、C、D）都是通用的，因此应该将它放在类 A 中听起来是合乎逻辑的。但是在这种情况下，我们将在基类中有一个方法“知道”派生类班级。

例子：

```
Class A {
# simple coordinate system
    distance_to_complex_coordinate_system (B complexCoord) {
         return complexCoord.distance_to_simple_coord_system(self)
    }

}

Class B extends A {
# complex coordinate system
    distance_to_simple_coordinate_system (simpleCoord) {
         # do calculations
    }

}

Class C extends A {}
Class D extends A {}
... 
```

上面的例子`distance_to_complex_coordinate_system`是所有简单坐标系（即 A、B、C 和 D）都应该具有的方法，并且它们的实现完全相同。它不是抽象类，因此不应被覆盖。

从 OO 的角度来看，这是否有意义？如果确实如此，这真的是一种很好的编程实践吗？如果没有，任何有关如何避免这种情况的建议将不胜感激。

在我看来，这不是一个好习惯，但我找不到一种避免它的好方法，而无需不必要地重复代码。顺便说一句，虽然可能并不重要——我正在使用 Perl。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T21:40:49.260

你是对的，在 A 中有一个需要了解子类中的实现的方法，它的味道很糟糕。也许您需要将此功能分解到另一个类中（而不是在继承层次结构中），并且在这种情况下更倾向于组合而不是继承。

在不了解您的代码的情况下确定要做什么有点困难。@Styxxy 提出了一个很好的观点，即使用抽象方法来解决这个问题，但这完全取决于你说“A 需要了解 B”时的意思。

如果一个对象被实例化为 a `A`，那么如何将其转换为 a`B`以获得您正在谈论的实现？它不能。

但是，如果一个对象被创建为`B`可以调用一个公共方法`A`，该方法又调用将被其子类覆盖的抽象方法（例如`B`）。这大致就是`Template`设计模式所做的。父类`A`定义了一些要采取的步骤和这些步骤的*顺序**，*但它将实现推迟到子类。

```
abstract class A {
    public void doStuff() {
        doThis();
        doThat();
    }

    abstract void doThis();

    abstract void doThat();
}

class B extends A {
    @Override
    void doThis() {
        // implementation
    }

    @Override
    void doThat() {
        // implementation
    }
}

// from somewhere in code...your subclass B knows doThis() will be called before doThat()
B b = new B();
b.doStuff(); 
```

*请原谅任何语法错误我在这里不验证正确性只是想表达一个观点*

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-21T23:50:34.773

基于您最近对问题的澄清的替代解决方案。

我认为类中的功能`B`应该分解为一个辅助类（组合）。您已经说过，`B`了解如何计算 distance_to_simple_coord_system() 是不可或缺的。你可以`B`从类层次结构中删除吗？

像这样，A 拥有 B 的实例，但它不再是子类。如何实际创建和设置 B 的实例取决于您。

```
class A {
    B b = new B();

    distance_to_complex_coordinate_system() {
         // i'm guessing that passing "this" maybe of use to you
         b.distance_to_simple_coord_system(this);
    }
}

class B {  // does not extend A
    Public distance_to_simple_coord_system(A a) {}
}
class C extends A {}
class D extends A {} 
```

**[编辑]**

关注您的评论...

我同意你的看法。这里*感觉不对的是***所有**`B`层次结构对类的依赖，而不是父类。这对于 OO 设计来说是根本错误的，您需要通过将共享功能移入或移入另一个独立的辅助类来从此类中删除*共享功能。****`A`***

 ****注意：有时 OO 设计不能很好地适应现实世界中的具体继承层次结构，这与 10 年前的教科书会让我们相信的相反。*

*此解决方案允许您为必要的位保留 A、B、C、D 层次结构，并且我使用*接口从`B`.

```
class A {
    Calc calc = new SimpleCalc();

    distance_to_complex_coordinate_system() {
         getCalc().distance_to_simple_coord_system(this);
    }

    Calc getCalc() {
        return this.calc;
    }
}

class B extends A {}
class C extends A {}
class D extends A {}

interface Calc {
    distance_to_simple_coord_system(A a);
}

class SimpleCalc implements Calc {
    distance_to_simple_coord_system(A a) {
        // implementation assuming you don't need an "instanceof B" passed in
    }
} 
```

问：为什么要使用接口？

A：以便您可以在运行时确定如何根据 A、B、C 或 D 类进行计算的实现

考虑到`C`可能需要一种不同的方式来计算它的 distance_to_complex_coordinate_system，你可以这样做......

```
 /*
    * Calculator specific to C
    */
    class CalcForC implements Calc {
        distance_to_simple_coord_system(C c) {
            // implementation specific to "C"
        }
    }

    class C extends A {
        Calc calcForC = new Calc();

        /* override */
        Calc getCalc() {
            return this.calcForC;
        }
    }

    C c = new C();
    c.distance_to_complex_coordinate_system();      // defined on A but calls getCalc() on C 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-21T21:27:02.637

如果它也是 A 的正确上下文中的方法，但不能在 A 中实现，则可以将其声明为`abstract`方法，该方法需要由任何派生类实现。（或者你可以有一个只知道 A 的实现，但你可以`override`在派生类中。）如果你觉得你有很多跨类知识，你可能没有足够抽象。***

# c++ - c++ cgi文件流

> ID：10692735
> 
> 赞同：1
> 
> 时间：2012-05-21T21:16:39.987
> 
> 标签：c++, file-io, cgi

我一直在尝试通过 cgi 提供二进制文件（例如 mp3 文件）。关键是我想让文件只能通过特殊脚本访问，而不是通过网络服务器本身。直到现在我得到：

```
int main() {
    cgiWriteEnvironment("/CHANGE/THIS/PATH/capcgi.dat");
    cgiHeaderContentType("audio/mpeg");

    FILE *fp;
    fp=fopen("D:/something.mp3", "r");
    char buffer[4];

    while (!feof(fp)) {
        fread(buffer, 4, 1, fp);
        printf("%x",buffer);
    }

    return 0;
} 
```

它正在向标准输出输出一些东西，浏览器正在尝试打开 vlc（所以标题应该是正确的......）但玩家无法处理数据:-(

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T14:58:47.167

您正在`.mp3`以十六进制、ASCII 0 和 4 以及 C 等序列对文件进行编码。您想要`fwrite()`，这将保留您正在编写的字节的原始格式。另外：4 字节的缓冲区大小将起作用，但我建议改为 4k (4048) 或 8k (8192) 字节。在现代机器上没关系，但调用`fread()`（相对）慢，所以你想尽可能少。

另外：这是一件很奇怪的事情。您要解决什么问题，为什么普通的 Web 服务器无法解决？

# android - 如何覆盖 Android 库项目中定义的可绘制对象？

> ID：10692736
> 
> 赞同：19
> 
> 时间：2012-05-21T21:16:40.287
> 
> 标签：android, drawable, android-imageview, android-library

我有两个具有相似功能但不同的可绘制对象和布局的 Android 应用程序。

我想将所有代码和资源放在一个库项目中，并覆盖引用该库的两个应用程序中的一些可绘制对象和布局。

我创建了一个引用该库的应用程序。我将所有资源从库复制到应用程序并更改了一些可绘制对象。我还更改了一些字符串资源。当我在 Eclipse 的布局编辑器中查看更改的布局之一时，我看到了正确的覆盖图像。

当我启动应用程序时，我看到我在应用程序中更改的字符串资源显示正确（库字符串被应用程序的资源覆盖），但我`ImageView`的 s 的可绘制对象都是从库的资源中获取的。

我还对一些布局资源进行了更改（移动并调整了一些图像的大小）。当我启动一个使用更改后的布局的活动（其源代码在库中的活动）时，我会看到新的（应用程序）布局和旧的（库）可绘制对象。

`ImageView`我尝试以两种方式定义 s 的可绘制对象：

1.  在布局 xml 中：`android:src="@drawable/image_id"`

2.  在活动代码中：

    ```
    ImageView view = (ImageView)findViewById(R.id.viewId);
    view.setImageResource(R.drawable.image_id); 
    ```

在这两种情况下，我看到的图像都是从库项目的资源中获取的，而不是从应用程序中获取的。

如果我不能解决这个问题，我将不得不复制两个应用程序中的所有代码，这将是一种耻辱。

难道我做错了什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2015-05-07T22:27:17.733

根据我的经验，您可以使用 style 和 refs.xml 替换库模块中的可绘制资源。

首先，您需要以样式声明可绘制资源，例如

```
<style name="drawable_base_style">
    <item name="android:src">@drawable/base</item>
</style> 
```

然后在应用程序（模块或项目，取决于您的 IDE）中，重新定义样式

```
<style name="drawable_base_style_app">
    <item name="android:src">@drawable/app</item>
</style> 
```

并使用 refs.xml 指向新样式。

```
<item name="drawable_base_style" type="style">@style/drawable_base_style_app</item> 
```

然后最后一步：交叉手指。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-21T21:32:13.633

不要复制粘贴东西，检查您的设计，以便将 Drawable 的 resourceId 作为参数提供给您的对象。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-20T22:50:03.163

正如我在上面的评论中所写，我设法通过清理项目并重新构建它们来解决我的问题。

# url-rewriting - nginx路径重写

> ID：10692738
> 
> 赞同：0
> 
> 时间：2012-05-21T21:16:49.443
> 
> 标签：url-rewriting, nginx, rewrite

我得到的是：

```
/index.php/rest/item/1 
```

但是，它应该是：

```
/rest/item/1 
```

如何将每个请求从 /index.php/rest/ 重写为 /rest/ ？

谢谢！

**编辑：** 它似乎只有在我将其设为重定向时才有效：

```
rewrite ^/index.php/rest/(.*)$ /rest/$1 permanent; 
```

如果我使用“中断”或“最后”它 404 在我身上，知道吗？我正在使用 Gallery3，它是在 php 的 Konoha 框架上编写的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-29T09:50:19.320

过去几周我与 Dmitry 一起解决了这个问题，我们终于发现了问题所在。我只需要它确保它在处理规则时不会完成。从规则中删除“last”或“break”可以修复它：

```
if (!-e $request_filename) {
        rewrite ^/index.php/rest/(.*)$ /rest/$1;
        rewrite ^/(.+)$ /index.php?kohana_uri=$1 last;
} 
```

# c++ - 在 C++ 中从文本文件读取到数组？

> ID：10692748
> 
> 赞同：-1
> 
> 时间：2012-05-21T21:17:29.477
> 
> 标签：c++

我正在尝试从文本文件中读取每一行并放入数组列中，我真的试过这个：

```
 string buffer[256];
string a;
ifstream myfile ("1.txt");

for(i=0;i<10000;i++)
    {

        //readArrivalTimes(i);
        myfile.getline (buffer,100);
        a[i]=buffer;
    } 
```

但它不工作

所以我确实尝试了你给我的解决方案之一，我这样做了：

```
std::vector<std::string> v;
std::string buffer;

string a[1024];
ifstream myfile;
myfile.open("1.txt");

for(i=0;i<n;i++)
{
    getline (myfile, buffer);

    a[i]= buffer;
    cout << buffer << "\n";
} 
```

但我们可以看到它是字符串！

我们可以让它作为整数工作吗？

[解决了 ：）]

首先感谢大家帮助我，非常感谢您的帮助，我是 C++ 的新手。

当然这不是家庭作业。

我对代码做了一些修改，所以它可以处理整数

```
int a[1024];
ifstream myfile;
myfile.open("1.txt");

for(i=0;i<n;i++)
{
    getline (myfile, buffer);

    a[i]= atoi(buffer.c_str());
    cout << buffer << "\n";
} 
```

非常感谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T21:35:17.317

您的代码中有很多错误。
已经提到了一些，将 char* 分配给 int 数组。

但是你的方法比 C++ 更多。在 C++ 中，它看起来更像这样：

```
std::vector<std::string> lines;
std::ifstream myfile("1.txt");
if(myfile.isopen())
{
    std::string line;
    while(getline(myfile, line))
    {
        lines.push_back(line);
    }
} 
```

我还没有测试过它，但它应该向您展示如何做到这一点的方法。

编辑：根据评论更改了代码。

再次编辑以使其适用于整数：

```
std::vector<int> numbers;
std::ifstream myfile("1.txt");
if(myfile.isopen())
{
    std::string line;
    while(getline(myfile, line))
    {
        int number;
        std::istringstream(line) >> number;
        numbers.push_back(number);
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-21T21:22:38.120

`a`是一个字符串，它是字符集合的抽象。

`a[i]`将返回对单个字符的引用。

`buffer`是一个字符数组。C/C++ 约定，数组的名称命名一个指向其第一个元素的指针。

因此，您在循环中所做的是将`ith`a 的元素分配给缓冲区开头的地址，这几乎肯定不是您想要做的。

您可能想要做的是制作一个字符串数组；即替换

```
string a; 
```

和

```
string a[10000]; 
```

您的代码中还有其他需要解决的问题；例如，如果您的文件有 < 10k 行怎么办？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-26T08:02:02.287

```
 int a[1024];
ifstream myfile;
myfile.open("1.txt");
for(i=0;i<n;i++)
{
    getline (myfile, buffer);

    a[i]= atoi(buffer.c_str());
    cout << buffer << "\n";
} 
```

这是正确的答案

# c - 指向结构中函数的指针

> ID：10692749
> 
> 赞同：2
> 
> 时间：2012-05-21T21:17:32.190
> 
> 标签：c, struct

我有以下结构：

```
struct A {
   struct list * (* get_items) (void);
   char * (*build) (void);
} 
```

现在`build`分配的方式（这是一个指向函数的指针）如下：

```
struct A someVar = {
  .build = someBuildingFunction
}; 
```

我不确定如何`build`分配的语法。为什么它以点开头？此外，我将如何指出`get_items`适当的功能`struct A someVar`？我已经尝试了几种方法，但我不断收到错误。

我还注意到结尾缺少分号`somebuildingFunction`。这是为什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-21T21:19:46.213

> 为什么它以点开头？

它被称为指定初始化程序。

> 我如何将 get_items 指向 struct A someVar 中的适当函数？

```
struct A someVar = {
  .build = someBuildingFunction,
  .get_items = someGettingFunction
}; 
```

您可以省略成员的名称，只需确保按正确的顺序放置函数名称。

> 我还注意到 somebuildingFunction 末尾缺少分号。这是为什么？

这对于 C 中的初始化程序很常见。例如：

```
int x[] = {
    1 /* No semicolon after 1\. */
}; 
```

# ruby-on-rails - Rails 3.1 before_create 仅在创建方法上

> ID：10692750
> 
> 赞同：0
> 
> 时间：2012-05-21T21:17:33.143
> 
> 标签：ruby-on-rails, ruby-on-rails-3

我的 ProductTrackListing 模型中有以下内容：

```
acts_as_list :scope => :product_id
before_create :set_initial_position, :only => :create

private

def set_initial_position
   self.position = self.track.position
end 
```

在我的控制器中，我有标准的 Create 方法，它处理从父“发布”复制的初始轨道列表，它复制父发布轨道位置。

我设置了另一个名为“add_catalogue_track”的自定义方法来处理需要始终通过acts_as_list 添加到最后的添加，而不管父发布轨道位置如何。

我最初虽然 before_create 调用引用了控制器创建方法，但它也在我的自定义方法上被调用。所以简而言之，我的问题是如何让 before_create 仅适用于 create 方法，我尝试了 `add_catalogue_track' 但这不起作用。

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-21T21:50:26.000

`after_create`由调用 的任何东西触发`Base.save`，并且是一条新记录。该`create`方法实际上只是一种方便的方法，用于一次调用`new`和`save`。

你是在使用`create()`还是`new()`然后`save()`在`add_catalogue_track()`？如果是这样，那将是触发回调的原因。

您可以做的一件事是`skip_callback`在您的自定义方法中使用：

`ProductTrackListing.skip_callback(:create, :before, :set_initial_position)`

# pagerank - Page Rank 优于 TF-IDF 的优势

> ID：10692752
> 
> 赞同：1
> 
> 时间：2012-05-21T21:17:48.073
> 
> 标签：pagerank, tf-idf

任何人都可以指导我阅读有关 PageRank 和词频 - 逆文档频率比较的任何学术论文。我一直在搜索，我只是找到了将两者结合起来的论文。

我需要找到 Page Rank 相对于 TF-IDF 的优势

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-15T21:35:45.880

虽然 PageRank 和 TF-IDF 都用于排名，但它们用于非常不同类型的排名。

PageRank 根据链接到的文档以及链接到它的文档为文档分配分数。分数不会因所使用的查询而异（即它是一个全局排名方案）。

TF-IDF 用于根据某些查询给文档打分。分数根据查询而变化，没有查询就没有分数。

您发现很多论文讨论将两者结合起来而不讨论它们的不同优势的原因是因为它们在这种方式上并没有真正的可比性。这很像苹果和橘子。

# android - 如何在操作栏中隐藏菜单项？

> ID：10692755
> 
> 赞同：367
> 
> 时间：2012-05-21T21:18:08.150
> 
> 标签：android, android-actionbar, menuitem, android-menu

我有一个带有菜单项的操作栏。如何隐藏/显示该菜单项？

这就是我想要做的：

```
MenuItem item = (MenuItem) findViewById(R.id.addAction);
item.setVisible(false);
this.invalidateOptionsMenu(); 
```

* * *

## 回答 #1

> 赞同：518
> 
> 时间：2012-05-21T21:24:14.250

获取`MenuItem`指向此类项目的指针，调用`setVisible`它以调整其可见性，然后调用`invalidateOptionsMenu()`您的活动，以便相应地调整 ActionBar 菜单。

**更新：** A`MenuItem`不是您布局中的常规视图。它有些特别，完全不同。您的代码返回`null`并`item`导致崩溃。你需要做的是：

```
MenuItem item = menu.findItem(R.id.addAction); 
```

这是您应该调用的顺序：首先调用`invalidateOptionsMenu()`，然后在内部`onCreateOptionsMenu(Menu)`获取对 MenuItem 的引用（通过调用`menu.findItem()`）并调用`setVisible()`它

* * *

## 回答 #2

> 赞同：177
> 
> 时间：2012-11-27T12:40:54.260

找到这个问题的附录：

如果您想随时更改菜单项的可见性，您只需在活动中设置一个成员变量，以记住您要隐藏菜单并调用`invalidateOptionsMenu()`和隐藏您覆盖的`onCreateOptionsMenu(...)`方法中的项目。

```
//anywhere in your code
...
mState = HIDE_MENU; // setting state
invalidateOptionsMenu(); // now onCreateOptionsMenu(...) is called again
...

@Override
public boolean onCreateOptionsMenu(Menu menu)
{
    // inflate menu from xml
    MenuInflater inflater = getSupportMenuInflater();
    inflater.inflate(R.menu.settings, menu);

    if (mState == HIDE_MENU)
    {
        for (int i = 0; i < menu.size(); i++)
            menu.getItem(i).setVisible(false);
    }
} 
```

在我的示例中，我隐藏了所有项目。

* * *

## 回答 #3

> 赞同：94
> 
> 时间：2012-10-27T10:12:41.963

是的。

1.  您可以设置标志/条件。
2.  `invalidateOptionsMenu()`当您想隐藏选项时调用。这将调用`onCreateOptionsMenu()`.
3.  在`onCreateOptionsMenu()`中，检查标志/条件并按以下方式显示或隐藏它：

> ```
> MenuItem item = menu.findItem(R.id.menu_Done);
> 
> if (flag/condition)) {
>   item.setVisible(false); 
> } else { } 
> ```

* * *

## 回答 #4

> 赞同：39
> 
> 时间：2012-05-21T21:24:38.193

你可以这样称呼：

```
MenuItem item = menu.findItem(R.id.my_item);
item.setVisible(false); 
```

**更新：**

确保您的代码不会返回`null`，`item`否则可能会使应用程序崩溃。

* * *

## 回答 #5

> 赞同：37
> 
> 时间：2016-09-05T06:27:43.250

我正在寻找更多上下文的答案。现在我已经弄清楚了，我将添加该答案。

# 默认情况下在菜单 xml 中隐藏按钮

默认情况下，共享按钮将被隐藏，由 设置`android:visible="false"`。

[![在此处输入图像描述](../Images/3792df72c15e148f57c6d7ddb81c9d83.png)](https://i.stack.imgur.com/cQWRl.png)

*main_menu.xml*

```
<?xml version="1.0" encoding="utf-8"?>
<menu xmlns:android="http://schemas.android.com/apk/res/android"
      xmlns:app="http://schemas.android.com/apk/res-auto">

    <!-- hide share button by default -->
    <item
        android:id="@+id/menu_action_share"
        android:icon="@drawable/ic_share_white_24dp"
        android:visible="false"     
        android:title="Share"
        app:showAsAction="always"/>

    <item
        android:id="@+id/menu_action_settings"
        android:icon="@drawable/ic_settings_white_24dp"
        android:title="Setting"
        app:showAsAction="ifRoom"/>

</menu> 
```

# 在代码中显示按钮

但是可以根据某些条件选择显示共享按钮。

[![在此处输入图像描述](../Images/85ba136f10308bef184154f398fbfd9b.png)](https://i.stack.imgur.com/6nfyr.png)

*MainActivity.java*

```
public boolean onCreateOptionsMenu(Menu menu) {
    MenuInflater inflater = getMenuInflater();
    inflater.inflate(R.menu.main_menu, menu);
    MenuItem shareItem = menu.findItem(R.id.menu_action_share);

    // show the button when some condition is true
    if (someCondition) {        
        shareItem.setVisible(true);
    }

    return true;
} 
```

# 也可以看看

*   [设置应用栏](https://developer.android.com/training/appbar/setting-up.html)（Android 文档获取帮助设置应用/操作栏）

* * *

## 回答 #6

> 赞同：24
> 
> 时间：2014-09-08T22:08:10.587

对我不起作用。我必须明确地使用`onPrepareOptionsMenu`来设置一个不可见的项目。

所以用于`onCreateOptionsMenu`创建菜单和`onPrepareOptionsMenu`更改可见性等。

* * *

## 回答 #7

> 赞同：10
> 
> 时间：2013-11-14T10:27:05.053

最初在菜单布局文件中将菜单项可见性设置为 false，如下所示：

```
<?xml version="1.0" encoding="utf-8"?>
<menu xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:app="http://schemas.android.com/apk/res-auto">
    <item
        android:visible="false"
        android:id="@+id/action_do_something"
        android:title="@string/txt_do_something"
        app:showAsAction="always|withText"
        android:icon="@drawable/ic_done"/>
</menu> 
```

然后，您可以在扩展菜单后在 onCreateOptionsMenu() 中简单地将菜单项的可见性设置为 false。

```
@Override
public void onCreateOptionsMenu(Menu menu, MenuInflater inflater) {
    super.onCreateOptionsMenu(menu, inflater);
    inflater.inflate(menu,R.menu.menu);
    MenuItem item = menu.findItem(R.id.menuItemId);
    if (item != null){
        item.setVisible(false);
    }
} 
```

* * *

## 回答 #8

> 赞同：10
> 
> 时间：2019-02-16T10:48:44.687

尝试这个：

```
MenuItem myitem = menu.findItem(R.id.my_item);
myitem.setVisible(false); 
```

* * *

## 回答 #9

> 赞同：8
> 
> 时间：2015-07-15T11:15:20.193

这对 Activity 和 Fragment 都有效

```
@Override
public void onPrepareOptionsMenu(Menu menu) {
    super.onPrepareOptionsMenu(menu);
    if (menu.findItem(R.id.action_messages) != null)
        menu.findItem(R.id.action_messages).setVisible(false);
} 
```

* * *

## 回答 #10

> 赞同：7
> 
> 时间：2013-04-13T19:11:04.257

P1r4nh4 答案工作正常，我只是使用布尔标志简化了它：

```
public int mState = 0; //at the top of the code
//where you want to trigger the hide action
mState = 1; // to hide or mState = 0; to show
invalidateOptionsMenu(); // now onCreateOptionsMenu(...) is called again
...

@Override
public boolean onCreateOptionsMenu(Menu menu)
{
    // inflate menu from xml
    MenuInflater inflater = getSupportMenuInflater();
    inflater.inflate(R.menu.settings, menu);

    if (mState == 1) //1 is true, 0 is false
    {
        //hide only option 2
            menu.getItem(2).setVisible(false);
    }
} 
```

* * *

## 回答 #11

> 赞同：6
> 
> 时间：2017-09-30T15:55:32.933

*根据 Android 开发者官方网站，不建议在运行时更改菜单项或图标、可见性..等时使用 OnCreateOptionMenu(Menu menu)。*

> 在系统调用 onCreateOptionsMenu() 后，它会保留您填充的 ​​Menu 的一个实例，并且不会再次调用 onCreateOptionsMenu()，除非菜单由于某种原因而无效。但是，您应该只使用 onCreateOptionsMenu() 来创建初始菜单状态，而不是在活动生命周期中进行更改。
> 
> 如果要根据活动生命周期中发生的事件修改选项菜单，可以在 onPrepareOptionsMenu() 方法中进行。此方法向您传递当前存在的 Menu 对象，以便您可以对其进行修改，例如添加、删除或禁用项目。（Fragments 还提供了一个 onPrepareOptionsMenu() 回调。） [--AndroidDeveloper 官网 --](https://developer.android.com/guide/topics/ui/menus.html)

作为推荐您可以使用此**onOptionsItemSelected(MenuItem item)**方法跟踪用户输入。

```
@Override
public boolean onOptionsItemSelected(MenuItem item) {

    int id = item.getItemId();

    if (id == R.id.edit) {
        Intent intent = new Intent(this, ExampleActivity.class);
        intent.putExtra(BUNDLE_KEY, mConnection);
        startActivityForResult(intent, PICK_CHANGE_REQUEST);
        return true;
    } else if (id == R.id.delete) {
        showDialog(this);
        return true;
    }

    return super.onOptionsItemSelected(item);
} 
```

如果您需要在运行时更改菜单项，您可以使用**onPrepareOptionsMenu(Menu menu)**来更改它们

```
@Override
public boolean onPrepareOptionsMenu(Menu menu){

    if (Utils.checkNetworkStatus(ExampleActivity.this)) {
        menu.findItem(R.id.edit).setVisible(true);
        menu.findItem(R.id.delete).setVisible(true);
    }else {
        menu.findItem(R.id.edit).setVisible(false);
        menu.findItem(R.id.delete).setVisible(false);
    }
    return true;
} 
```

* * *

## 回答 #12

> 赞同：5
> 
> 时间：2016-11-24T05:47:57.877

您可以使用`toolbar.getMenu().clear();`一次隐藏所有菜单项

* * *

## 回答 #13

> 赞同：4
> 
> 时间：2017-06-11T23:01:03.380

仅用一个命令隐藏菜单中所有项目的最佳方法是在菜单 xml 上使用“组”。只需在同一组内添加将在溢出菜单中的所有菜单项。

在此示例中，我们有两个将始终显示的菜单项（常规项和搜索）和三个溢出项：

```
<menu xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:app="http://schemas.android.com/apk/res-auto">

    <item
        android:id="@+id/someItemNotToHide1"
        android:title="ITEM"
        app:showAsAction="always" />

    <item
        android:id="@+id/someItemNotToHide2"
        android:icon="@android:drawable/ic_menu_search"
        app:showAsAction="collapseActionView|ifRoom"
        app:actionViewClass="android.support.v7.widget.SearchView"
        android:title="Search"/>

    <group android:id="@+id/overFlowItemsToHide">
    <item android:id="@+id/someID" 
    android:orderInCategory="1" app:showAsAction="never" />
    <item android:id="@+id/someID2" 
    android:orderInCategory="1" app:showAsAction="never" />
    <item android:id="@+id/someID3" 
    android:orderInCategory="1" app:showAsAction="never" />
    </group>
</menu> 
```

然后，在您的活动上（最好在 onCreateOptionsMenu 上），使用命令 setGroupVisible 将所有菜单项的可见性设置为 false 或 true。

```
public boolean onCreateOptionsMenu(Menu menu) {
   menu.setGroupVisible(R.id.overFlowItems, false); // Or true to be visible
} 
```

如果您想在活动的其他任何地方使用此命令，请确保将菜单类保存到本地，并始终检查菜单是否为空，因为您可以在 createOptionsMenu 之前执行：

```
Menu menu;

public boolean onCreateOptionsMenu(Menu menu) {
       this.menu = menu;

}

public void hideMenus() {
       if (menu != null) menu.setGroupVisible(R.id.overFlowItems, false); // Or true to be visible       
} 
```

* * *

## 回答 #14

> 赞同：4
> 
> 时间：2018-03-26T08:10:32.470

通过设置菜单中所有项目的可见性，应用栏菜单或溢出菜单将自动隐藏

例子

```
private Menu menu_change_language; 
```

...

...

```
@Override
public boolean onCreateOptionsMenu(Menu menu) {
    ...
    ...
    menu_change_language = menu;
    menu_change_language.findItem(R.id.menu_change_language)
           .setVisible(true);

    return super.onCreateOptionsMenu(menu);
} 
```

在转到其他片段之前，请使用以下代码：

```
if(menu_change_language != null){                 
    menu_change_language.findItem(R.id.menu_change_language)
       .setVisible(false);
} 
```

* * *

## 回答 #15

> 赞同：3
> 
> 时间：2015-01-25T12:35:45.737

[https://stackoverflow.com/a/21215280/466363](https://stackoverflow.com/a/21215280/466363) - Look Alterno 和 Sufian 回答

*   ActivityCompat.invalidateOptionsMenu() 不回调 onPrepareOptionsMenu(); 它只是直接更新菜单。
*   我的 someMethod() 从几个地方被调用，甚至在 onCreateOptionsMenu() 之前，所以我必须检查 mMenu ！= null。
*   应该使用 API 8

.

```
private Menu mMenu;
   @Override
   public void onCreateOptionsMenu(Menu menu, MenuInflater inflater) {
       inflater.inflate(R.menu.track_fragment, menu);
       mMenu = menu;
       }
   ...
   private void someMethod() {
   ...
       if (mMenu != null) {
          MenuItem item = mMenu.findItem(R.id.new_track);
          if (item != null) {
               item.setVisible(false);
               ActivityCompat.invalidateOptionsMenu(this.getActivity());
           }
       }
   ...
   } 
```

*   ActivityCompat.invalidateOptionsMenu() 不回调 onPrepareOptionsMenu(); 它只是直接更新菜单。

*   我的 someMethod() 从几个地方被调用，甚至在 onCreateOptionsMenu() 之前，所以我必须检查 mMenu ！= null。

*   应该使用 API 8

* * *

## 回答 #16

> 赞同：3
> 
> 时间：2014-11-20T11:52:32.387

为变量设置一个值并调用 invalidateOptionsMenu();

例如

```
 selectedid=arg2;
            invalidateOptionsMenu();

 public boolean onPrepareOptionsMenu(Menu menu) {

    if(selectedid==1){
        menu.findItem(R.id.action_setting).setVisible(false);
        menu.findItem(R.id.action_s2).setVisible(false);
        menu.findItem(R.id.action_s3).setVisible(false);
    }
    else{
        if(selectedid==2){
            menu.findItem(R.id.action_search).setVisible(false);
            menu.findItem(R.id.action_s4).setVisible(false);
            menu.findItem(R.id.action_s5).setVisible(false);
        }
    }
    return super.onPrepareOptionsMenu(menu);
} 
```

* * *

## 回答 #17

> 赞同：3
> 
> 时间：2020-06-12T21:49:14.543

> Android kotlin，以编程方式隐藏或设置操作栏中菜单项的可见性。

```
override fun onCreateOptionsMenu(menu: Menu): Boolean {
    val inflater = menuInflater
    inflater.inflate(R.menu.main_menu, menu)
    val method = menu.findItem(R.id.menu_method)
    method.isVisible = false //if want to show set true
    return super.onCreateOptionsMenu(menu)
} 
```

* * *

## 回答 #18

> 赞同：3
> 
> 时间：2017-03-03T18:22:14.180

如果您按照上述答案进行了所有操作，但菜单项仍然可见，请检查您是否引用了*唯一*资源。例如，在 onCreateOptionsMenu 或 onPrepareOptionsMenu

```
@Override
public void onPrepareOptionsMenu(Menu menu) {
    super.onPrepareOptionsMenu(menu);
    MenuItem menuOpen = menu.findItem(R.id.menu_open);
    menuOpen.setVisible(false);
} 
```

Ctrl+单击 R.id.menu_open 并检查它是否仅存在于一个菜单文件中。如果此资源已在任何地方使用并加载到活动中，它将尝试隐藏在那里。

* * *

## 回答 #19

> 赞同：1
> 
> 时间：2015-04-03T05:29:32.307

对于那些使用 Appcompat 库的人：如果您的 Activity 是 ActionBarActivity 的子类，您可以调用 supportInvalidateOptionsMenu()

在这里看到： [https ://stackoverflow.com/a/19649877/1562524](https://stackoverflow.com/a/19649877/1562524)

* * *

## 回答 #20

> 赞同：1
> 
> 时间：2017-04-11T10:39:27.110

我认为更好的方法是为菜单使用成员变量，在 onCreateOptionsMenu() 中对其进行初始化，然后只使用 setVisible() ，而不会使选项菜单无效。

* * *

## 回答 #21

> 赞同：1
> 
> 时间：2019-03-23T07:05:07.727

您正在尝试从无法访问范围的活动中访问菜单项。查找菜单项的调用将返回**null**，因为视图**既未与活动**绑定，也未与您调用的布局绑定。

菜单项与诸如“**导航栏**”之类的项绑定，这些项又与相应的活动绑定。

因此在activity() 中初始化这些视图，然后使用该视图访问菜单项。

```
Navigation navView;
navView = findViewById(R.id.navigationView);

MenuItem item = navView.getMenu().findItem(R.id.item_hosting);
item.setVisible(false); 
```

* * *

## 回答 #22

> 赞同：1
> 
> 时间：2021-05-07T17:45:05.230

这对我有用；我希望它可以帮助你：

```
@Override
public boolean onCreateOptionsMenu(final Menu menu) {
    getMenuInflater().inflate(R.menu.my_menu_setting, menu);

    for (int i = 0; i < menu.size(); i++){
        if(menu.getItem(i).getItemId() == R.id.this_item_i_want_to_hide){
            menu.getItem(i).setVisible(false);
        }
    }

    return true;
} 
```

* * *

## 回答 #23

> 赞同：1
> 
> 时间：2019-06-30T08:38:29.813

利用`invalidateOptionsMenu()`

为了打电话`onPrepareOptionsMenu(menu: Menu?)`

> 您应该仅使用 onCreateOptionsMenu() 来创建初始菜单状态，而不是在活动生命周期中进行更改...
> 
> 当事件发生并且您想要执行菜单更新时，您必须调用 invalidateOptionsMenu() 来请求系统调用 onPrepareOptionsMenu()。

[https://developer.android.com/guide/topics/ui/menus](https://developer.android.com/guide/topics/ui/menus)

* * *

## 回答 #24

> 赞同：1
> 
> 时间：2017-11-30T16:37:01.183

这段代码对我有用

```
@Override
public boolean onCreateOptionsMenu(Menu menu) {
    getMenuInflater().inflate(R.menu.main_menu,menu);
    if (Application.sharedPreferences.getInt("type",1) == 2)
    {
        menuItem = menu.findItem(R.id.menu_travel_orders);
        menuItem.setVisible(false);
    }
    return super.onCreateOptionsMenu(menu);
} 
```

* * *

## 回答 #25

> 赞同：1
> 
> 时间：2018-07-22T00:55:11.630

这种方法对我有用：

```
private  Menu thismenu;

if (condition)
{
   if(thismenu != null)
   {
       thismenu.findItem(R.id.menu_save).setVisible(true);
       Toast.makeText(ProfileActivity.this, 
    ""+thismenu.findItem(R.id.menu_save).getTitle(),
                Toast.LENGTH_SHORT).show();
   }else
   {
       thismenu.findItem(R.id.menu_save).setVisible(false);
   }
}

@Override
public boolean onCreateOptionsMenu(Menu menu) {
   getMenuInflater().inflate(R.menu.profile_menu, menu);
   thismenu = menu;

   return true;
} 
```

* * *

## 回答 #26

> 赞同：0
> 
> 时间：2020-12-26T20:20:00.150

以正常方式创建菜单选项，请参见下面的代码，并在类中添加全局引用到菜单

```
Menu mMenu;  // global reference within the class
@Override
public boolean onCreateOptionsMenu(Menu menu) {
    getMenuInflater().inflate(R.menu.menu_tcktdetails, menu);
    mMenu=menu;  // assign the menu to the new menu item you just created 
    return true;
}

@Override
public boolean onOptionsItemSelected(MenuItem item) {
    int id = item.getItemId();
    if (id == R.id.action_cancelticket) {
        cancelTicket();

        return true;
    }

    return super.onOptionsItemSelected(item);
} 
```

现在，您可以通过使用按钮或在函数内运行此代码来切换菜单

```
if(mMenu != null) {
                mMenu.findItem(R.id.action_cancelticket).setVisible(false);
            } 
```

# jquery - WebApi - 当我以 JSONP 形式请求数据时，数据以 XML 形式返回

> ID：10692757
> 
> 赞同：1
> 
> 时间：2012-05-21T21:18:12.063
> 
> 标签：jquery, json, asp.net-mvc-3, jsonp, asp.net-web-api

在我的 Web Api 项目中，我有一个 Get 方法，它从我的数据源返回数据：

```
 [WebGet(UriTemplate = "")]
    public IQueryable<Product> Get()
    {
        var products = _db.Products;
        return products.AsQueryable();
    } 
```

当我使用测试客户端在浏览器中查看它时，当我指定以 JSON 格式返回时，它工作正常并返回 JSON。

在我的另一个客户端上，由于我的 API 托管在同一个域上（仅用于开发），我必须制作一个 JSONP，但是我从我的 JSON 请求中收到的数据是 XML，我怎样才能让它作为 JSON 返回？以下是我提出请求的代码：

```
 $.ajax({
        crossDomain: true,
        dataType: "jsonp",
        url: "http://localhost:9000/api/products",
        contentType: 'application/json; charset=utf-8',
        type: "get",
        success: function (data) {

            console.log(data);
        }
    }); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-21T21:23:38.193

[从这个副本](https://stackoverflow.com/questions/9421312/jsonp-with-mvc-4-webapi)中大量窃取......

您的主要问题是 webapi 默认情况下没有注册 JSONP 媒体格式化程序。要完成您想要的，您需要三件事：

1.  添加一个`media formatter`输出 JSONP的
2.  注册媒体格式化程序
3.  确保客户端请求 jsonP。

你可以窃取这个 JSONP 媒体[格式化程序](https://github.com/thinktecture/Thinktecture.Web.Http/blob/master/Thinktecture.Web.Http/Formatters/JsonpFormatter.cs)。

然后，您需要注册媒体格式化程序。您可以使用以下代码片段以编程方式执行此操作：

```
var config = GlobalConfiguration.Configuration;
config.Formatters.Insert(0, new JsonpMediaTypeFormatter()); 
```

通常你`Application_Start()`在`global.asax`.

您的查询看起来像是在请求 JSONP 就好了。完成上述操作后，它应该可以工作。重要的部分是`accept`发送的标头与您闪亮的新 jsonp 格式化程序正在侦听的接受标头匹配。在我看来，前两个选择是：（`application/javascript`就像你要求的那样）或`text/javascript`.

# iphone - 使用 RestKit 映射登录响应

> ID：10692758
> 
> 赞同：0
> 
> 时间：2012-05-21T21:18:24.217
> 
> 标签：iphone, objective-c, api, rest, restkit

使用 RestKit 已经有一段时间了，但我遇到了 ObjectMapping 的难题。我有一个登录 API，需要我发布 2 个键值，如下所示：

```
 {"fb_access_token":"123456789.....",
 "fb_user_id":"1234..."} 
```

它返回：

```
 {"message":"logged in"} 
```

我创建了以下类来映射 POST 提交和以下要点中的响应：

[https://gist.github.com/2764803](https://gist.github.com/2764803)

我可以在不映射响应的情况下发布和登录，如以下要点：

[https://gist.github.com/2764823](https://gist.github.com/2764823)

映射这样的帖子和响应的最佳方式是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-25T20:52:59.237

你可以试试这样的

[使用 RKParams 向 API 发布帖子，并使用 RestKit 使用 RKObjectMapping 映射响应](https://stackoverflow.com/questions/10760333/making-a-post-to-api-with-rkparams-and-mapping-the-response-with-rkobjectmapping/)

我尝试了此处发布的解决方案，但对我来说效果不佳。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-22T19:19:25.847

您需要使用 RKObjectManager 而不是 RKClient 才能正确使用优雅的对象映射机制。[这个RestKit wiki 页面](https://github.com/RestKit/RestKit/wiki/Object-mapping)中解释了您需要的所有内容。如果您在阅读后还有其他问题，请随时提出。

# java - 获取另一个时区的 SimpleDateFormat 日期对象

> ID：10692763
> 
> 赞同：1
> 
> 时间：2012-05-21T21:18:36.120
> 
> 标签：java, ms-access, date, timezone, simpledateformat

我有一个 Access 数据库，其中有一列日期和时间以及一个时区，如下所示：

![数据示例](../Images/677f1cd224fe14cef4e6d7e2732a3bf9.png)

所以，首先我要像这样创建一个 TimeZone 对象和一个 SimpleDateFormat 对象

```
TimeZone timeZone = TimeZone.getTimeZone(parseNull(rs.getString("TimeZone")));      
DateFormat dateFormatter = new SimpleDateFormat("yyyy-MM-dd HH:mm:ss");
dateFormatter.setTimeZone(timeZone); 
```

然后，我正在阅读这样的日期：

```
String startDateString = rs.getDate("Start_Date") + " " + rs.getString("Start_Time").substring(11);
startDate = dateFormatter.parse(startDateString); 
```

但是，如果我像这样打印出日期：

```
System.out.println("Start Actual: " + rs.getDate("Start_Date") + " " + rs.getString("Start_Time").substring(11));
System.out.println("Start Formatted: " + startDate); 
```

我得到以下输出：

```
Start Actual: 2011-11-10 18:00:00
Start Formatted: Thu Nov 10 02:00:00 EST 2011 
```

好吧……为什么？我觉得这很令人困惑。为什么我的 Date 对象不能在澳大利亚/悉尼时区正确显示，更好的是，我怎样才能让它正确工作，以便我可以在我的应用程序中正确设置日期？

提前感谢您的帮助！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-21T21:24:37.407

A`java.util.Date`没有时区。这是一个普遍的瞬间。当您以人类可读的格式*显示*日期时，您可以选择要在哪个时区显示该日期，并通过在用于将日期转换为字符串的 SimpleDateFormat 上设置时区来实现。

如果只是这样做`System.out.println("Start Formatted: " + startDate)`，`toString()`则使用日期的方法，并且该`toString()`方法使用默认时区。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-21T21:34:35.180

JB 是正确的，`java.util.Date`即无时区。要获得您正在寻找的输出，请尝试：

`System.out.println("Start Formatted: " + dateFormatter.format(startDate).toString());`

# objective-c - 什么是与 Objective-C 相关的子程序？

> ID：10692764
> 
> 赞同：1
> 
> 时间：2012-05-21T21:18:38.830
> 
> 标签：objective-c, function, methods, subroutine

我大约 8 个月前开始学习编程，从 C、OOP 开始，现在到 iOS，这是我的目标。在大多数情况下，一切都很顺利，我已经开始通过在 xcode 上编写小型应用程序来练习。只是像子程序这样的小术语有时会让我失望。任何人都可以为我定义这个术语，并给我一个简单的例子来说明它的用法吗？我知道它是某种类型的方法，并且我完全理解实例和类方法，但是我不知道子例程和实例/类方法之间的确切区别是什么。我在网上看过，但运气不太好。

任何帮助表示赞赏，谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-22T02:10:04.090

“子程序”是一种老式术语，表示其他代码调用的一段代码。方法、函数和过程是一些特定类型的子例程。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-21T21:20:47.447

方法是一种为上下文状态和查找目的而绑定到特定对象的子例程。Objective-C 还具有通用函数（与标准 C 的语法相同），这更像是子例程的经典定义。

# titanium - 在 ScrollView 中布局视图，不能独立控制布局和滚动方向

> ID：10692768
> 
> 赞同：1
> 
> 时间：2012-05-21T21:18:51.817
> 
> 标签：titanium

我有一个使用的窗口，`layout: 'horizontal'`当我添加子视图时，每个都使用`width: '50%'`，这很棒，它们都像一个 2 列表一样填充。

但是，我意识到我需要滚动内容，所以我在窗口中添加了一个滚动视图，并将我的子视图添加到滚动视图中 - 但它不起作用。当我`layout: 'horizontal'`在滚动视图上使用时，它会尝试使内容水平滚动 - 所有子视图都在一行上（在 UI 上只看到前 2 个）。如果我将其更改为`layout: 'vertical'`，它会正确滚动，但视图以 1 列格式布局（一个在另一个之上）

```
var deals_window = Titanium.UI.createWindow({
    title: 'Deals',
    layout: 'horizontal'
  });

  var scrollView = Ti.UI.createScrollView({
    showVerticalScrollIndicator: true,
    layout: 'horizontal',
    scrollType: 'vertical',
    contentWidth: '100%',
    contentHeight: 'auto',
    width: '100%',
    height: 'auto'

  });
  deals_window.add(scrollView); 
```

如何让 scrollView 在垂直滚动时使用“水平”布局行为......？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-10T09:13:57.697

不要使用水平布局。尝试这个：

```
var scrollView = Ti.UI.createScrollView({
   layout: 'vertical',
   height: Ti.UI.FILL
});

var row = Ti.UI.createView({
   height: Ti.UI.SIZE
});

var view1 = Ti.UI.createView({
    width: "50%",
    left: 0
});

var view2 = Ti.UI.createView({
    width: "50%",
    right: 0
});

row.add(view1);
row.add(view2);

scrollView.add(row); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-08-07T02:13:17.097

尝试使用 scrollView 的属性 Horizo​​ntalWrap:true。它可以帮助你！

这是代码：

```
//window
var win = Ti.UI.createWindow({
    width: '100%',
    height: '100%',
    backgroundColor: 'white'
});
//scrollView
var scrollView = Ti.UI.createScrollView({}i
    top: 0,
    width: '100%',
    height: '100%',
    contentWidth: '100%',
    layout: 'horizontal',
    horizontalWrap: true,
    scrollType: 'vertical'
);
win.add(scrollView);
//item in scrollView
for(var i = 0; i < 8; i++){
    var itemLabel = Ti.UI.createLabel({
        font:{
            fontSize: '18'
        },
        left: '2.5%',
        width: '30%',
        color: 'black',
        height: '90'
        borderRadius: 5,
        textAlign: 'center',
        text: 'item '+(i+1),
        backgroundColor: 'red',
        verticalAlign: Ti.UI.TEXT_VERTICAL_ALIGNMENT_CENTER
    });
    scrollView.add(itemLabel);
} 
```

好吧，这种方式确实有效，但是，**scrollView**有一个问题，当它可以滚动时，最后一行的部分将被覆盖。所以，我不建议你用这种方式来解决你的问题。您可以尝试更多更好的***UI 组件***，例如**TableView**或**ListView**，对于**TableView只需在****TableViewRow**中放入您想要的任意数量的项目，对于**ListView**只需定义一个**ItemTemplate**，其中包含您想要的几个项目。如果您需要更多详细信息，请给我写电子邮件：*frankjorsn@gmail.com*

# java - com.ibm.websphere.ce.cm.DuplicateKeyException 是否会因尝试在 Hibernate 中的一个事务中插入太多新记录而导致？

> ID：10692771
> 
> 赞同：0
> 
> 时间：2012-05-21T21:18:57.853
> 
> 标签：java, sql, hibernate, websphere, dao

我正在尝试使用 DAO 更新方法更新 DB2 表。当我添加单个记录时，如果它只是更新记录，或者更新和添加单个记录，则代码可以完美地工作。但是，如果代码构建了多个新记录，则会引发 com.ibm.websphere.ce.cm.DuplicateKeyException 并且不会将更改提交到数据库。对象的主键不重复，除了对于被视为主键的数据成员都具有“0”的新记录。我是否走在正确的轨道上，这个错误是如何无意中引起的，或者没有？有没有解决的办法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-21T23:53:13.630

如果新记录对于被视为主键的数据成员的值为 0，那么您将只能插入第一个。

你说对象的PK不是重复的，除了......对我来说听起来像是一个矛盾的陈述。

你能澄清一下吗？

# java - 异步处理 Java 小程序

> ID：10692773
> 
> 赞同：1
> 
> 时间：2012-05-21T21:19:03.410
> 
> 标签：java, javascript, browser, applet

我的 HTML 页面中嵌入了小程序。没什么特别的：

```
<applet archive='static/app/applet.jar' code='appletclass/AppletClass'>
    <param name='name' value='Applet name'>
    <param name='mayscript' value='true'>
</applet> 
```

Applet 本身具有`list`执行一些持久计算的方法。使用 JavaScript 从页面调用此方法：

```
try {
    appletElement.list();
} catch (ex) {} 
```

当然，长期计算会冻结浏览器窗口，直到所有计算完成。

是否有任何解决方法可以以（有点）*“异步”*方式使用小程序而不会冻结浏览器？在小程序源代码中使用线程是否有意义？

感谢帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-04T20:19:14.820

在关于[mayscript 属性](http://help.dottoro.com/lhbkaqko.php)的页面上，我们现在可以找到信息：

> LiveConnect 是一种支持 Java Applet 和客户端脚本（如 JavaScript、VBScript）之间交互的技术。较旧的 Java 浏览器插件（Java 版本 1.6.0.10 之前）默认情况下不允许小程序使用 LiveConnect，但可以使用 MAYSCRIPT 属性修改该设置。由于兼容性原因（因为 Internet Explorer 中的 Java 插件始终允许小程序访问客户端脚本），较新的 Java 插件（**从 Java 版本 1.6.0.10**开始）不检查 MAYSCRIPT 属性，**所有浏览器中始终允许脚本访问**。

我已经在 FF 18.0.1、Opera 11 或 12、Chrome 和 IE9 上进行了检查，并且无需任何额外工作即可正常工作（[oracle 页面上](http://docs.oracle.com/javase/6/docs/technotes/guides/plugin/developer_guide/java_js.html)的教程 - 不需要 MAYSCRIPT，仅使用**JSObject**和 import **plugin.jar**）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-06-16T19:05:06.003

在小程序中使用线程，然后使用 JSObject 回调到页面将是执行此操作的方法。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-05-21T21:24:17.973

我不确定您可以从小程序中做什么，但从简单的 javascript/html 的角度来看，您一直在以同步方式等待计算完成。如果您从服务器获取数据，情况会有所不同。

# php - 避免在动态内容上使用 htmlspecialchars() ，同时避免 XSS 攻击

> ID：10692775
> 
> 赞同：0
> 
> 时间：2012-05-21T21:19:08.147
> 
> 标签：php, image, xss, htmlspecialchars

我需要你的帮助来解决一个非常简单的问题。我网站的某些页面的内容存储在MySQL数据库中，我在输出到浏览器时对其应用 了**htmlspecialchars（）**，但实际上有合法`<img src="images/me.jpg">`的，它们呈现为纯文本，同时它们应该是有效的图片部分文章内容。

如何成功显示图像，同时避免可能的 XSS 攻击等。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-21T21:22:05.653

常见的方法是不使用 HTML，而是使用您自己的格式化语言，如 bbcode 或 Markdown。这样，您可以轻松地将格式转换为 HTML，同时避免让用户输入他们想要的任何 HTML。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-21T21:25:38.240

根据[HTML 标准](http://www.whatwg.org/specs/web-apps/current-work/multipage/)[解析 HTML](http://www.whatwg.org/specs/web-apps/current-work/multipage/parsing.html#parsing)并丢弃您不想保留的任何元素/属性/属性值。检查`src`每个`img`元素的值，看看它是否是一个有效的 URL，如果是，检查它是否真的存在并且是一个有效的图像。如果不是，则丢弃该元素。

如果您使用专有格式语言（例如 BBCode 或 Markdown），您仍应针对为每个`img`元素提供的值执行检查（许多解析 BBCode、Markdown 等的库将为您执行这些检查）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-21T21:35:19.140

使用[HTMLPurifier](http://htmlpurifier.org/) - 它将删除任何脚本，包括放置在标签属性中的 javascript，同时保留（并且还形成良好的）HTML 代码

# file - 在 UNIX 中用连续数字重命名文件名

> ID：10692781
> 
> 赞同：2
> 
> 时间：2012-05-21T21:19:35.997
> 
> 标签：file, unix, rename

我有带前缀的文件名 - “文件”和随机数后缀。例如：

```
file2344, file1244, file123, file12345, file0012 
```

我想创建用序列号重命名的文件，以便它们可以在数组中正常工作。例如：

```
file1, file2, file3, file4, file5 
```

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-21T21:35:34.870

像这样的东西：

```
i=1
for f in file*; do
    mv "$f" file$i
    i=$((i+1))
done 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-09-23T20:18:35.543

尝试以下脚本：

[计算.sh](http://sourceforge.net/projects/numerate/files/numerate.sh/download)

这应该适合你：

```
./numerate.sh -d <your image folder> -b <start number> -p image_ -s .jpg -o numerically -r 
```

# c# - 文本框的图像路径

> ID：10692782
> 
> 赞同：1
> 
> 时间：2012-05-21T21:19:44.803
> 
> 标签：c#, .net, asp.net-mvc, asp.net-mvc-3, razor

我正在一个项目中工作，我想保存保存在数据库中 Content/assets 文件夹中的图像的路径。我通过在文本框中传递它来保存路径，然后传输到我的创建方法。我怎样才能制作一个照片选择器并将路径保存到我的文本框？这是我的看法：

```
 @using (Html.BeginForm("Create", "Rooms", FormMethod.Get, new { @encType = "multipart/form-data" }))
 {
  <div class="editor-label">    
  @Html.Label("RoomNumber")
  @Html.TextBox("RoomNumber")
  </div>
  <div class="editor-label">
   @Html.Label("RoomType")
   @Html.DropDownList("RoomType_id", new SelectList(Model.tip.AsEnumerable(), "RoomType_ID", "Room_Type"))
   </div>
   @Html.Label("Floor")
   @Html.DropDownList("Floor_id", new SelectList(Model.etaj.AsEnumerable(), "Floor_ID", "Denumire"))
   <div class="editor-label">
   @Html.Label("NumberOfSpots")
   @Html.TextBox("NumberOfSpots")
   </div>
   <div class="editor-label">
   @Html.Label("Status")
   @Html.TextBox("Status")                   
   </div>
   <div class="editor-label">
   @Html.Label("Status")
   @Html.TextBox("Status")                   
   </div>
   <div class="editor-label">
   @Html.Label("AlbumArtUrl")
   @Html.TextBox("AlbumArtUrl")                  
   </div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T21:24:56.873

怎么样`input type="file"`？

```
<input id="photo" type="file" /> 
```

然后，如果需要，您可以挂钩到 jQuery 中的更改事件，如下所示：

```
$("#photo").change(function () {
    //do your stuff
}); 
```

# c++ - C++: __try...__except; 在发布模式下隐藏崩溃？

> ID：10692784
> 
> 赞同：2
> 
> 时间：2012-05-21T21:20:02.200
> 
> 标签：c++, crash, try-catch, buildconfiguration

我有一个在嵌入式 Windows XP 机器上运行的 DX9 应用程序。当让它在一夜之间自动进行浸泡测试时，它会在大约六到八小时后崩溃。在我们的开发中。机器（Win 7）我们似乎无法重现此问题。我也相当肯定这不是内存泄漏。

*   如果我们在嵌入式机器上的 Debug 中运行相同的应用程序，它不会崩溃。
*   如果我们`__try/__except`在嵌入式机器上围绕主循环进行更新，它不会崩溃。

我知道在 Debug 中，本地堆栈周围有一些额外的字节填充，这可能会“隐藏”超出范围的本地数组访问，或者某种未初始化的变量正在潜行。

所以我有两个问题：

1.  即使在发行版中运行，其行为是否`__try/__except`类似于调试？
2.  如果我们在 Release 模式下发生崩溃，但在 Debug 模式下没有崩溃，我应该扫描哪些代码？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-21T21:37:09.280

如果你正在使用`__try{ } __except()`你不应该。
那些和 C++ 代码不能很好地混合。（例如，您不能在用这些对象包装的函数的堆栈上包含 C++ 对象。`try {} catch() {}`如果您使用`catch(...)`（带有省略号），则应该使用 C++，它的作用与`__except()`

两者在调试和发布中的行为相同`try.. catch`。`__try .. __except`

如果您怀疑您的问题是意外异常，您应该阅读以下所有内容：

```
SetUnhandledExceptionFilter()
_set_se_translator()

_CrtSetReportMode()
_RTC_SetErrorFunc()
_set_abort_behavior()
_set_error_mode()
_set_new_handler()
_set_new_mode()
_set_purecall_handler()
set_terminate()
set_unexpected()
_set_invalid_parameter_handler()
_controlfp() 
```

使用前两个之一可能会让您很快查明您的问题。如果您希望对过程中可能出现的所有错误情况进行绝对控制，剩下的就在那里。

具体来说，`SetUnhandledExceptionFilter()`您可以设置一个函数过滤器来记录导致异常的代码的地址。然后，您可以使用调试器来确定该代码。使用 DbgHelp 库和提供给过滤器函数的信息，您可以编写一些代码，打印出崩溃的完整堆栈跟踪，包括符号和行号。

确保你设置你的构建配置来为发布构建发出调试符号。他们只能帮助并且不会做任何事情来减慢您的应用程序（但可能会使其更大）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-21T21:44:47.187

> 如果我们在嵌入式机器上的主循环更新周围放置`__try`/ `__except`，它不会崩溃。

然后这样做。

推荐使用围绕整个程序的单个`__try`块（以及每个工作线程的入口点），它可以让您在退出之前写出故障转储并进行错误报告。使用 SEH 无法进行太多恢复，因为异常只是没有携带足够的信息来有效地区分不同的故障。不过，存储整个程序状态并将其拉入调试器非常有用。

注意：一些视频驱动程序会导致它们也捕获的 SEH 异常，也许某些逻辑期望安装多个 SEH 范围，这是您的`__try`块提供的。

# iphone - ABPerson 中发短信的默认电话号码

> ID：10692785
> 
> 赞同：0
> 
> 时间：2012-05-21T21:20:12.890
> 
> 标签：iphone, ios, cocoa, abmultivalue, abperson

我正在尝试获取默认电话号码，以便使用 ABPerson 为 iPhone 通讯录联系人发送短信。我知道要使用 ABMultiValue。但我不知道是否有办法确定默认短信电话号码（或以这种方式，默认电话号码、电子邮件或地址）。我将要为每个对象抓取第一个对象，但我担心，对于短信，手机可能是固定电话或无法接收短信。任何有关如何处理此问题的建议将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T22:32:45.617

您可以从 ABMultiValue 中提取家庭、工作和手机号码的特定值。您可能希望使用与**kABPersonPhoneMobileLabel**和/或**kABPersonPhoneIPhoneLabel**对应的值来发送文本消息。如果这些值都不存在，请选择第一个可用的电话号码。

# java - 在运行时，如何指定一个类，以便函数可以创建该特定类的对象？

> ID：10692786
> 
> 赞同：0
> 
> 时间：2012-05-21T21:20:20.657
> 
> 标签：java

我有一个名为 Model 的接口。它有一个名为 deserialize() 的方法

```
public interface Model 
{
   public void deserialize(String s);
} 
```

Model 接口有很多实现。

我有一个名为 Utilities 的特殊类，它适用于模型对象（即模型接口的实现）。

在实用程序中，我有一个接受指定类的函数，并创建该类的对象列表。

```
 public static <T extends Model> List<T> getList(StringReader reader, Class <T> theClass)
{
   ...
} 
```

我有两个类 A 和 B 都实现了模型。在 A 类中，我有以下代码 -

```
A
{
  int x;
  int y;
  int z;
  ArrayList<B> listOfBObjects;

public void deserialize(String dataString)
 {
    ...
    ...
    listOfBObjects = Utilities.getList();  <-- here I want to specify "B". How to do that?
 }
} 
```

如何将“B”指定为上述 getList() 函数的参数？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-21T21:23:35.137

```
listOfBObjects = Utilities.getList(new StringReader(dataString), B.class); 
```

但是我在你之前的问题中回答了这个......

# c++ - cv::Mat 中的错误地址

> ID：10692794
> 
> 赞同：5
> 
> 时间：2012-05-21T21:21:08.850
> 
> 标签：c++, linux, opencv, zeromq

我正在制作一个使用 opencv 和 zeromq 的 C++ 应用程序。我在尝试通过 zmq tcp 套接字发送 cv::Mat 对象（CV_8UC3）时遇到了一些问题。

这是更新的代码示例：

```
#include <iostream>
#include <zmq.hpp>
#include <pthread.h>
#include <opencv/cv.h>
#include <opencv/highgui.h>

using namespace std;

int main()
{
    zmq::context_t ctx( 1 );
    zmq::socket_t mysocket( ctx, ZMQ_PUSH );
    mysocket.bind( "tcp://lo:4050" );

    cv::VideoCapture capture( CV_CAP_ANY );
    capture.set( CV_CAP_PROP_FRAME_WIDTH, 640 );
    capture.set( CV_CAP_PROP_FRAME_HEIGHT, 480 );

    cv::Mat3b frame;

    capture >> frame; //First one is usually blank
    capture >> frame;
    capture >> frame;

    cv::Mat3b clonedFrame( 480, 640, CV_8UC3 );
    frame.copyTo( clonedFrame );

    cout << "Original:" << endl
         << "Address of data:\t" << &frame.data << endl
         << "Size:\t\t\t" << frame.total() * frame.channels() << endl << endl;

    cout << "Cloned:" << endl
         << "Address of data:\t" << &clonedFrame.data << endl
         << "Size:\t\t\t" << clonedFrame.total() * clonedFrame.channels() << endl << endl;

    cout << "Gap between data:\t" << &clonedFrame.data - &frame.data << endl;

    unsigned int frameSize = frame.total() * frame.channels();

    zmq::message_t frameMsg( frame.data, frameSize, NULL, NULL );
    zmq::message_t clonedFrameMsg( clonedFrame.data, frameSize, NULL, NULL );

    cv::imshow( "original", frame );
    cv::imshow( "cloned", clonedFrame );

    cvWaitKey( 0 );

    if( frame.isContinuous() )
    {
        cout << "Sending original frame" << endl;
        mysocket.send( frameMsg, 0 ); //This works
        cout << "done..." << endl;
    }

    cvWaitKey( 0 );

    if( clonedFrame.isContinuous() )
    {
        cout << "Sending cloned frame" << endl;
        mysocket.send( clonedFrameMsg, 0 ); //This fails
        cout << "done..." << endl;
    }

    return EXIT_SUCCESS;
} 
```

后一个 send() 使 zmq 某些断言失败。输出：

```
Original:
Address of data:    0xbfdca480
Size:           921600

Cloned:
Address of data:    0xbfdca4b8
Size:           921600

Gap between data:   14
Sending original frame
done...
Sending cloned frame
Bad address
done...
nbytes != -1 (tcp_socket.cpp:203) 
```

为什么 clone() 会弄乱指针，我该如何解决？

任何帮助表示赞赏。

编辑 2012-05-25：更新了代码示例。我可以通过向消息构造函数提供以下指针之一来发送原始帧：frame.ptr()、frame.data、frame.datastart、frame.at()。它们都适用于原始版本，但不适用于构造函数。如您所见，两个数据指针之间的地址空间很小。它不应该至少是 frameSize 吗？

//约翰

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-27T21:57:18.107

好的...所以我最终制作了自己的复制功能

它看起来像这样：

```
struct frameData_t
{
    unsigned char *data;
    size_t size;
};

struct frameData_t *copyMatData( cv::Mat3b &indata )
{
    struct frameData_t *ret = new struct frameData_t;

    ret->size = indata.total() * indata.channels();
    ret->data = new unsigned char[ret->size];

    int datapos = 0;
    for( int channel = 0; channel < indata.channels(); channel++ )
    {
        for( int row = 0; row < indata.rows; row++ )
        {
            const cv::Vec3b *srcrow = indata[row];
            for( int col = 0; col < indata.cols; col++, datapos++ )
            {
                ret->data[datapos] = srcrow[col][channel];
            }
        }
    }

    return ret;
} 
```

我像这样使用它：

```
struct frameData_t *clonedFrame = copyMatData( frame );
zmq::message_t frameMsg( frame.data, frameSize, NULL, NULL );
mysocket.send( clonedFrameMsg, 0 ); 
```

如果有人知道更好的方法，请告诉我。

//约翰

# java - 显示带有和不带排序的 ArrayList？

> ID：10692795
> 
> 赞同：-1
> 
> 时间：2012-05-21T21:21:16.680
> 
> 标签：java, arrays, list, sorting

> **可能重复：**
> [排序的 ArrayList 不显示？](https://stackoverflow.com/questions/10692561/sorted-arraylist-not-displaying)

代码：

```
 String title1 = "Original Order\n\n";
  String title2 = "Sorted Order\n\n";

  String collection = "";
  for (int i = 0; i < cdcollection.size(); i++)  {
  collection = collection + cdcollection.get(i);
  }
  mainTextArea.setText(title1 + collection);

  Collections.sort(cdcollection);

  String temp = "";
  for (int j = 0; j < cdcollection.size(); j++)  {
  temp += cdcollection.get(j);
  }
  mainTextArea.setText(title2 + temp); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T21:33:24.973

将您的方法的代码替换为`displayButtonActionPerformed`以下内容：

```
 mainTextArea.append("Original Order\n\n");

  for (String s:cdcollection)  {
        mainTextArea.append(s);
        mainTextArea.append("\n");
  }
  List<String> copy = new ArrayList<String>(cdcollection);
  Collections.sort(copy);

  mainTextArea.append("Sorted Order\n\n");
  for (String s:copy)  {
        mainTextArea.append(s);
        mainTextArea.append("\n");
  } 
```

在您的第二次迭代中，您迭代“collection”而不是“cdcollection”。

调用 setText()，替换 textarea 的整个文本。改为使用`append()`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-21T21:36:30.293

我拿了你的代码，没有使用 swing 代码，并且列表排序正确。请参阅下面的代码

```
public static void main(String[] args){
    ArrayList<String> cdcollection = new ArrayList();
    Collections.addAll(cdcollection, "renier\n", "mert\n", "rain\n",
            "mylen", "dreb\n");

    String title1 = "Original Order\n\n";
    String title2 = "Sorted Order\n\n";

    String collection = "";
    for (int i = 0; i < cdcollection.size(); i++) {
        collection = collection + cdcollection.get(i);
    }
    System.out.println(title1 + collection);

    Collections.sort(cdcollection);
    System.out.println(cdcollection);
} 
```

你在这里使用的 for 循环

```
 for (int j = 0; j < cdcollection.size(); j++)  {
      mainTextArea.setText(title2 + collection.get(j));
 } 
```

不要在循环中添加，`title2`在循环中调用 setText 将覆盖旧文本。将列表中的所有字符串附加到一个临时字符串和`mainTextArea`. 就像是

```
 String temp = "";
 for (int j = 0; j < cdcollection.size(); j++)  {
      temp += cdcollection.get(j));
 }
 mainTextArea.setText(title2 + temp); 
```

但这绝对是亚历山大提到的重复。你可以编辑同样的问题。

# javascript - 格式化 jqPlot 点标签，如：数字（百分比）

> ID：10692796
> 
> 赞同：3
> 
> 时间：2012-05-21T21:21:33.577
> 
> 标签：javascript, jquery, jquery-plugins, jqplot

这是我的第一个问题。

我需要像这样格式化 jqPlot 图表点标签：50 (100%) 格式化数字并显示百分比。

```
var s1 = [32, 28, 18, 6];

var ticks = ['0-20 kph', '21-40 kph', '41-60 kph', '61+ kph'];

plot1 = $.jqplot('bar-graph', [s1], {
    animate: !$.jqplot.use_excanvas,
    title: 'Gráficos de velocidade',
    captureRightClick: true,
    seriesColors: ['green', 'yellow', 'orange', 'red'],
    seriesDefaults: {
        renderer: $.jqplot.BarRenderer,
        pointLabels: {
            show: true,
            formatString: '%s (?%%)' 
        },
        rendererOptions: {
            varyBarColor: true
        }
    },
    axes: {
        xaxis: {
            renderer: $.jqplot.CategoryAxisRenderer,
            ticks: ticks
        }
    },
    highlighter: {
        show: false
    }
}); 
```

在 jsFindle 上：http: [//jsfiddle.net/evandroprogram/r3PUE/10/](http://jsfiddle.net/evandroprogram/r3PUE/10/)

谢谢。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-21T21:44:34.677

您可能可以实现一个返回正确格式字符串的函数，而不是显式设置格式。像这样的东西：

```
formatString: function(){return '%s (100%)';}() 
```

您可以在该函数内进行计算以得出适当的字符串。

# php - Zend：无法填充（）从数据库中选择元素进行更新

> ID：10692801
> 
> 赞同：0
> 
> 时间：2012-05-21T21:22:08.660
> 
> 标签：php, zend-framework, zend-form, zend-db

我有一些问题要自己找到解决方案，这就是我向社区询问的原因。我正在使用 Zend Framework 开发一个应用程序。

我有一个表格，里面有一些 SELECT 元素。其中一些填充了来自数据库的数据，而另一些则填充了表单内的数据 (->addMultiOption(0, 'Option 1')...)。

插入效果很好，但是我在更新功能上遇到了一些麻烦。用表单内的选项填充的 SELECT 元素填充成功，但填充了 DB 数据的 SELECT 元素设置不正确。始终选择 DB 表的第一个选项。

所以我猜我的代码有问题。我删除了一些元素以获得更好的可见性。

我的表格：

```
<?php

class Application_Form_Pda extends Zend_Form
{

public function init()
{
    $this->setName('ajouter');

    $addFabForm = new Zend_Form;
    $addFabForm->setAction('#');            // A compléter
    $addFabForm->setMethod('post');
    $addFabForm->setAttrib('id', '');       // A compléter

    //Id
    $id = new Zend_Form_Element_Hidden('PDA_ID');
    $id->addFilter('Int');

    //Select du Fabriquant
    $nomFabriquant = new Zend_Form_Element_Select('FAB_NOM');
    $nomFabriquant  ->setLabel('Fabriquant')
                    ->setRequired(true)
                    ->addErrorMessage('Vous devez sélectionner un fabriquant');

    $TableFab = new Application_Model_DbTable_Fabriquant();
    //$nomFabriquant->addMultiOption(0, "");
    foreach ($TableFab->fetchAll() as $ind) {
        $nomFabriquant->addMultiOption($ind['FAB_ID'], $ind['FAB_NOM']);
    }

    // Select du Modèle
    $nomModele = new Zend_Form_Element_Select('MOD_NOM');
    $nomModele      ->setLabel('Modèle')
                    ->setRequired(true)
                    ->addErrorMessage('Vous devez sélectionner un modèle');

    $TableMod = new Application_Model_DbTable_Modele();
    //$nomModele->addMultiOption(0, "");
    foreach ($TableMod->fetchAll() as $ind) {
        $nomModele  ->addMultiOption($ind->MOD_ID, $ind->MOD_NOM);
    }

    // Champs texte, numéro IMEI
    $imei = new Zend_Form_Element_Text('PDA_IMEI');
    $imei           ->setRequired(true)
                    ->setLabel('IMEI')
                    ->addFilter('StripTags')
                    /*->addValidator('Default_Validator_Imei')*/
                    ->addValidator('NotEmpty');

    // Select du Site
    $nomSite = new Zend_Form_Element_Select('PDA_SITE');
    $nomSite        ->setLabel('Site')
                    ->setRequired(true)
                    ->addMultiOption(0, "Nantes")
                    ->addMultiOption(1, "Paris")
                    ->addErrorMessage('Vous devez sélectionner un site');

    // Achat DSIV
    $dsiv = new Zend_Form_Element_Checkbox('PDA_ACHATDSIV');
    $dsiv           ->setChecked(true)
                    ->setLabel('Achat SVSI');

    // Checkbox boite
    $boite = new Zend_Form_Element_Checkbox('PDA_OPT_BOITE');
    $boite          ->setChecked(true)
                    ->setLabel('Boite');

    // Checkbox USB
    $usb = new Zend_Form_Element_Checkbox('PDA_OPT_USB');
    $usb            ->setChecked(true)
                    ->setLabel('Cable USB');

    // Checkbox chargeur
    $chargeur = new Zend_Form_Element_Checkbox('PDA_OPT_CHARGEUR');
    $chargeur       ->setChecked(true)
                    ->setLabel('Chargeur');

    // Checkbox casque
    $casque = new Zend_Form_Element_Checkbox('PDA_OPT_CASQUE');
    $casque         ->setChecked(true)
                    ->setLabel('Casque');

    // Checkbox batterie
    $bat = new Zend_Form_Element_Checkbox('PDA_OPT_BATTERIE');
    $bat            ->setChecked(true)
                    ->setLabel('Batterie');

    // Checkbox filaire
    $fil = new Zend_Form_Element_Checkbox('PDA_OPT_FILAIRE');
    $fil            ->setChecked(true)
                    ->setLabel('Filaire');

    // Select de l'état
    $etat = new Zend_Form_Element_Select('PDA_ETAT');
    $etat       ->setLabel('Etat')
                    ->setRequired(true)
                    ->addMultiOption(0, "Stock")
                    ->addMultiOption(1, "En prêt")
                    ->addMultiOption(2, "SAV")
                    ->addMultiOption(3, "Sorti du parc")
                    ->setValue('Stock')
                    ->setLabel('Etat')
                    ->addErrorMessage('Vous devez sélectionner un état');

    $validPda = new Zend_Form_Element_Submit('envoyer');
    $validPda       ->setAttrib('id', 'boutonenvoyer');

    $this->addElements(array($id, $nomFabriquant, $nomModele, $imei, $nomSite, $dsiv, $boite, $usb, $chargeur, $casque, $bat, $fil, $etat, $validPda));
}

} 
```

我的控制器：

```
<?php

    $form = new Application_Form_Pda();                  //Création du formulaire
    $form->envoyer->setLabel('Modifier');                       // Ajout d'un libellé au bouton d'envoi
    $this->view->form = $form;                                  // Envoi du formulaire à la vue
    if ($this->getRequest()->isPost()) {                        // si la méthode isPost de l'objet Request renvoi True, le formulaire à été envoyé
        $formData = $this->getRequest()->getPost();             // Récupération des données avec la méthode getPost()
        if ($form->isValid($formData)) {                        // Vérification de ces données avec la méthode isValid()
            $id = (int)$form->getValue('PDA_ID');               // Récupération de l'ID du fabriquant
            $idModele       = $form->getValue('MOD_NOM');
            $imei           = $form->getValue('PDA_IMEI');
            $nomSite        = $form->getValue('PDA_SITE');
            $dsiv           = $form->getValue('PDA_ACHATDSIV');
            $boite          = $form->getValue('PDA_OPT_BOITE');
            $usb            = $form->getValue('PDA_OPT_USB');
            $chargeur       = $form->getValue('PDA_OPT_CHARGEUR');
            $casque         = $form->getValue('PDA_OPT_CASQUE');
            $bat            = $form->getValue('PDA_OPT_BATTERIE');
            $fil            = $form->getValue('PDA_OPT_FILAIRE');
            $etat           = $form->getValue('PDA_ETAT');
            $pda = new Application_Model_DbTable_Pda();     // On créé un nouvel enregistrement
            $pda->modifierPda($id, $idModele, $imei, $dsiv, $boite, $usb, $chargeur, $casque, $bat, $fil, $nomSite, $etat);     // On affecte à cet enregistrement le nom du fabriquant, et on persiste en BDD
            $this->_helper->redirector('index');                // pour finir, on redirige vers index de Fabriquant
        } else {
            $form->populate($formData);                         // Si la validation n'est pas passée, on réaffiche les données dans le formulaire
        }
    }
    else {
            $id = $this->_getParam('id', 0);
            //var_dump($id);
            if ($id > 0) {
                $pda = new Application_Model_DbTable_Pda();
                $formData2 = $pda->getPda($id);
                //echo "L'ID est : " . $id;     // Vérification
                $form->populate($formData2);
            } else {
                echo "Information : nous sommes dans le else de modifierAction de PdaController.php";
                echo "L'ID est : " . $id;
            }
        } 
```

该模型：

```
<?php

class Application_Model_DbTable_Pda extends Zend_Db_Table_Abstract
{

protected $_name = 'pda';
protected $_primary = 'PDA_ID';     // La primary key

public function getPda($id){
    $id = (int)$id;
    $row = $this->fetchRow('PDA_ID = ' . $id);
    if (!$row) {
        throw new Exception("Impossible de trouver la ligne $id");
    }
    return $row->toArray();
}

public function ajouterPda($idModele, $imei, $dsiv, $boite, $usb, $chargeur, $casque, $bat, $fil, $nomSite, $etat) {
    $idModele = (int)$idModele;
    $data = array(
            'MOD_ID'            => $idModele,
            'PDA_IMEI'          => $imei,
            'PDA_ACHATDSIV'     => $dsiv,
            'PDA_OPT_BOITE'     => $boite,
            'PDA_OPT_USB'       => $usb,
            'PDA_OPT_CHARGEUR'  => $chargeur,
            'PDA_OPT_CASQUE'    => $casque,
            'PDA_OPT_BATTERIE'  => $bat,
            'PDA_OPT_FILAIRE'   => $fil,
            'PDA_SITE'          => $nomSite,
            'PDA_ETAT'          => $etat
    );
    $this->insert($data);
}

public function modifierPda($id, $idModele, $imei, $dsiv, $boite, $usb, $chargeur, $casque, $bat, $fil, $nomSite, $etat) {
    $id = (int)$id;
    $idModele = (int)$idModele;
    $data = array(
            'MOD_ID'            => $idModele,
            'PDA_IMEI'          => $imei,
            'PDA_ACHATDSIV'     => $dsiv,
            'PDA_OPT_BOITE'     => $boite,
            'PDA_OPT_USB'       => $usb,
            'PDA_OPT_CHARGEUR'  => $chargeur,
            'PDA_OPT_CASQUE'    => $casque,
            'PDA_OPT_BATTERIE'  => $bat,
            'PDA_OPT_FILAIRE'   => $fil,
            'PDA_SITE'          => $nomSite,
            'PDA_ETAT'          => $etat
    );
    $this->update($data, 'PDA_ID = ' . $id);
}

public function supprimerFabriquant($id) {
    $this->delete('PDA_ID = ' . (int)$id);
}

} 
```

'Modèle' 的 id 在 DB 中很好，但该元素没有填充 DB 值……知道吗？

非常感谢你的帮助！:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T06:53:57.203

在我看来，它`FAB_NOM`不会正确填充，因为您似乎没有从数据库表中传递值。

还有“MOD_NOM `likes like it will work if you rename it to`MOD_ID”。

```
//no data present to reference to FAB_NOM and MOD_ID is present but MOD_NOM is not    
$data = array(
                'MOD_ID'            => $idModele,
                'PDA_IMEI'          => $imei,
                'PDA_ACHATDSIV'     => $dsiv,
                'PDA_OPT_BOITE'     => $boite,
                'PDA_OPT_USB'       => $usb,
                'PDA_OPT_CHARGEUR'  => $chargeur,
                'PDA_OPT_CASQUE'    => $casque,
                'PDA_OPT_BATTERIE'  => $bat,
                'PDA_OPT_FILAIRE'   => $fil,
                'PDA_SITE'          => $nomSite,
                'PDA_ETAT'          => $etat
        ); 
```

为了`populate()`正常工作，您需要有一些表单识别为属于元素的数据。通常我们通过将表单元素命名为与我们要在数据库中填充的列相同的名称来实现这一点。

目前，您遇到问题的选择元素似乎没有关联的**同**名列。

# c# - 存储和访问列表中的列表

> ID：10692803
> 
> 赞同：1
> 
> 时间：2012-05-21T21:22:26.933
> 
> 标签：c#, linq, list

我需要根据两个列表中的一个字段将 2 个列表合并为一个列表，然后访问合并列表中的信息。

示例伪代码

```
List1.merge;
List2.merge2;
MergedList = List1.merge join List2.merge2;
MergedList.Merge2 or MergedList.Any Field in List 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-21T21:26:42.613

怎么样`Concat`？

```
var myList = list1
    .Where(l => list2
        .Any(l2 => l2.Field == l.Field)
    .Concat(list2
        .Where(l2 => list
            .Any(l => l.Field == l2.Field))
    .ToList(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-21T21:42:42.053

这是一个基本示例，您应该能够根据需要进行调整：

```
using System.Linq; // Add these two lines to the using statements 
                   // at the top of your file
using System.Collections.Generic;

var l1 = new List<Uri>() { new Uri("http://www.facebook.com"), new Uri("http://www.yahoo.com"), new Uri("http://www.google.com") };
var l2 = new List<Uri>() { new Uri("http://www.google.com"), new Uri("http://www.nytimes.com"), new Uri("http://www.facebook.com") };

var q = from Uri uri1 in l1 
        join Uri uri2 in l2 on uri1.Host equals uri2.Host select uri2;

var commonUris = q.ToList();  // Result 
```

临界线是周围的`equals`

请注意，如果任何项目在任何一个列表中多次出现，这可能不会产生预期的结果。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-21T21:57:58.437

一个简单的 lambda 连接怎么样？

```
list1.Join(list2, l1 => l1.Field, l2 => l2.field, (l1,l2) => new SomeORAnonymousObjectType { ListItem1 = l1, ListItemType2 = l2 }).ToArray().ToList().ToEnumerable(); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-23T13:54:13.440

现在这个问题已经解决了。我创建了一个引用一个类的列表，它存储了我的信息，一旦我这样做了，我就能够管理和访问我需要的一切。

# html - Web 开发 - 学习 Web 开发语言、平台 - Grails 或 Ruby 或任何其他语言？

> ID：10692809
> 
> 赞同：1
> 
> 时间：2012-05-21T21:22:49.287
> 
> 标签：html, ruby-on-rails, css, grails

我想在整个夏天都投入到 Web 开发中。我有一些基本的 C++ 和 Java 背景。有人告诉我先掌握 HTML 和 CSS，然后再掌握 Javascript。然后另一个人告诉我应该使用 Grails，而另一个人告诉我 Ruby on Rails。我一直对 Web 开发很感兴趣，但从来没有时间完全学习它，现在我有一些空闲时间，我希望能磨练我的技能。问题是有太多的平台和语言，这很令人困惑。我想最终创建一个网站，然后开始一家科技创业公司。我很困惑。请帮忙。我知道我需要掌握 HTML、CSS 但你有什么建议？

谢谢。

* * *

## 回答 #1

> 赞同：-3
> 
> 时间：2012-05-21T21:31:46.910

我个人使用 Grails 和 JavaScript 来开发 Web 应用程序。我非常喜欢 Grails，因为我曾经使用过 Java，而 Grails 为旧的 Java 添加了许多很酷的特性，使其更易于使用。但我现在不会学习 Grails，因为它的未来是不确定的。Ruby 是一个更好的候选者，但我根本不懂这种语言。

恕我直言 Javascript 是必须的。如果您很了解它，我想您可以将它用于客户端和服务器端（Node.js）。而且我认为 JS 将来会用得更多，所以学习它是一个好的开始。

总之，我推荐Javascript。

干杯，洛伊扎

# iphone - 如何分发 App 的 beta 版本而不覆盖购买副本

> ID：10692810
> 
> 赞同：0
> 
> 时间：2012-05-21T21:22:53.920
> 
> 标签：iphone, ios, ipad

我相信我知道生成一个 .ipa 文件用于临时分发给我的 beta 测试人员，但我的问题是我需要哪些设置才能让 beta 副本与我的应用程序的购买副本在同一设备上共存？这样他们就可以为我测试应用程序，然后回退到生产应用程序进行日常使用。

谢谢，

抢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-21T21:25:34.683

更改捆绑标识符。对于您的应用程序是 com.domainname.appname，对于您的测试版可能是 com.domainname.appname-beta

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-21T21:24:36.103

我会创建一个新的应用程序名称和捆绑标识符，然后将应用程序（图标下的文本）命名为不同的名称，然后将其发送出去。这是一些额外的工作，但它使您不会弄乱生产应用程序上任何现有的保存数据。

# python - 如何在 Python 中检查参数的类型？

> ID：10692812
> 
> 赞同：0
> 
> 时间：2012-05-21T21:23:13.607
> 
> 标签：python, python-2.7

我正在编写一个程序，其中用户输入以 10 为基数的数字，以转换为不同（或相同）基数的数字。

```
def convert(a,b) 
```

其中 a 是输入，b 是新基数。如果 b 不是整数，如果 b 没有假定值（即空白），或者如果 b 是小于 1 的整数，我被指示让程序返回值“-1”。

我知道如何转换数字，并且我知道如果 b 小于 1 时如何让程序返回 -1，但是如果 b 为空或不是整数，我如何让程序返回 -1？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-05-21T21:26:33.520

简短的回答：不要。

类型检查不是 Pythonic。尝试做你想做的事情，如果它有效，它有效，如果它没有，它会抛出一个异常。

同样，`-1`失败时返回也不是 Pythonic，通常，您希望在失败时抛出异常。在某些（罕见的）情况下这是有意义的，但总的来说，这意味着您必须检查该值（而不是只在需要的地方捕获异常）并导致更难发现错误（该值是`-1`而不是获取例外）。

长答案：如果你真的需要，那么你可以用它[`isinstance(value, int)`](http://docs.python.org/library/functions.html#isinstance)来检查一个值是否是一个整数，但是，这破坏了 Python 的鸭子类型，因此在 99.9% 的情况下都是一个坏主意。它也不一定按您期望的方式工作 - 例如，`bool`它是 的子类`int`，因此`isinstance(True, int)`会返回`True`- 这可能是您想要的，也可能不是。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-21T21:30:41.450

这是您可以检查 b 值的一种方法。

```
def convert(a, b=None):
    if isinstance(b, int) and b > 1:
        return do_convert(a, b)
    return -1 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-21T22:06:09.720

我的建议是拿走你所有的东西，试着把它变成一个`int`. 这更像是 Pythonic：它接受任何可以像整数一样工作的东西，即使严格来说它不是 type `int`。同时，它确保您只需要在`int`编写代码时担心。

```
def convert(n):
    try:
       n = int(n)
    except ValueError, TypeError:
       return -1
    # here, do the conversion and return the result 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-22T03:08:22.440

看起来像家庭作业。你的老师没有教你好的编程实践。

Python 程序员通常按原样取值。如果可能，内置的 python 函数会将变量转换为必要的类型。如果不可能，则由调用函数来采取某种行动。这称为鸭式打字。如果您知道输入将来可能会导致问题，您可以添加一些断言语句以防止错误输入。

您可以使用 isinstance() 函数检查您的变量是否为整数。您可以通过检查变量是否为真来检查它是否为空。

如果这不是家庭作业，那么转换碱基的最佳方法是使用内置`int(a, b)`函数。

# c# - 我应该在类名中包含命名空间提示吗？

> ID：10692814
> 
> 赞同：4
> 
> 时间：2012-05-21T21:23:32.157
> 
> 标签：c#, naming-conventions

如果我有一组可能有多个实现的接口（即内存中、NHibernate、基于 xml 等），那么在类名本身中提供命名空间提示是否明智？例如：

```
MyDomain.Infrastructure.ISomeProvider
MyDomain.Infrastructure.ISomeOtherProvider
MyDomain.Infrastructure.IYetAnotherProvider 
```

然后我可能有：

```
MyDomain.Infrastructure.Impl.MemoryBased.SomeProvider
MyDomain.Infrastructure.Impl.MemoryBased.SomeOtherProvider
MyDomain.Infrastructure.Impl.MemoryBased.YetAnotherProvider
MyDomain.Infrastructure.Impl.XmlFileBased.SomeProvider // etc...
MyDomain.Infrastructure.Impl.NHibernate.SomeProvider // etc... 
```

对比

```
MyDomain.Infrastructure.Impl.MemoryBased.MemoryBasedSomeProvider
MyDomain.Infrastructure.Impl.MemoryBased.MemoryBasedSomeOtherProvider
MyDomain.Infrastructure.Impl.MemoryBased.MemoryBasedYetAnotherProvider
MyDomain.Infrastructure.Impl.XmlFileBased.XmlSomeProvider // etc...
MyDomain.Infrastructure.Impl.NHibernate.NHibernateSomeProvider // etc... 
```

在第二种情况下，通过类名本身很清楚我在代码中的任何地方使用了哪个实现，但是按命名空间对它们进行分组然后将其包含在类名中似乎有点多余，不是吗？

第三种选择可能是：

```
MyDomain.Infrastructure.ISomeProvider
MyDomain.Infrastructure.Impl.MemoryBasedSomeProvider
MyDomain.Infrastructure.Impl.MemoryBasedSomeOtherProvider
MyDomain.Infrastructure.Impl.MemoryBasedYetAnotherProvider
MyDomain.Infrastructure.Impl.XmlSomeProvider // etc...
MyDomain.Infrastructure.Impl.NHibernateSomeProvider // etc... 
```

我已经消除了多余的命名空间，但现在对类进行分组/组织的唯一方法是通过类名前缀。我想我可以将它们分成文件夹并手动调整任何新创建的文件中的命名空间。其中一种风格比其他风格有什么明显的优势吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-21T21:26:39.633

好问题。我会用另一个来回答，有人需要同时使用多个实现的可能性有多大`ISomeProvider`？如果是这样，简单地通过命名空间来消除歧义将导致需要一些讨厌的完全限定的命名空间。

如果不是，我将使用命名空间来指示实现的性质，但始终使用相同的名称。无论哪种方式，您的 API 是由接口而不是具体实现定义的这一事实，这意味着无论您选择哪种选项，人们都可以非常轻松地互换实现。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-21T21:26:37.380

选项1

```
MyDomain.Infrastructure.Impl.MemoryBased.SomeProvider
MyDomain.Infrastructure.Impl.MemoryBased.SomeOtherProvider
MyDomain.Infrastructure.Impl.MemoryBased.YetAnotherProvider
MyDomain.Infrastructure.Impl.XmlFileBased.SomeProvider // etc...
MyDomain.Infrastructure.Impl.NHibernate.SomeProvider // etc... 
```

将是我的首选。您可能会争辩说，您应该将它们放在每个实现的不同项目中（在内存中、ORM、XML 中），然后可以在运行时根据您的 IoC 容器和当时的要求加载所需的实现。

弄乱命名空间并在类的名称中添加实现类型是矫枉过正的，并且会使您的命名空间看起来对外部/其他开发人员毫无意义。

# php - 闭包参数和'use'关键字有什么区别？

> ID：10692817
> 
> 赞同：19
> 
> 时间：2012-05-21T21:23:45.877
> 
> 标签：php, closures, anonymous-function

这让我很困惑，我似乎无法找到这个问题的答案。一个清晰而简单的澄清会很好。

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2012-05-21T21:51:59.613

在**创建闭包函数**时`use statement`捕获**变量**。

 **常规函数参数在**调用**函数时捕获**值**。

 **请注意，我区分了`variable`和`value`那里。

```
function makeAnAdder($leftNum) {
    // Notice that *each time* this makeAnAdder function gets called, we 
    // create and then return a brand new closure function.
    $closureFunc = function($rightNum) use ($leftNum) {
        return $leftNum + $rightNum;
    };

    return $closureFunc;
}

$add5to = makeAnAdder(5);
$add7to = makeAnAdder(7);

echo $add5to(10); // 15
echo $add7to(1); // 8 
```

如果有一种方法可以检查`$add5to`函数的“源代码”，它看起来像这样：

```
function($rightNum) {
    return 5 + $rightNum;
} 
```

我想你可以说`$leftNum`闭包函数记住了 的值。

我想进一步强调，`use statement`允许您维护一个`reference`变量**，**而不仅仅是该变量在某个时刻所具有的**值的副本。**澄清我的想法：将变量想象成一个小盒子，它可以在任何时刻包含单个值，并且可以更改该值。并且，您可以使另一个变量指向该框，以便您可以更新框中的值，或读取其中的当前值。

通常，在函数内创建的局部变量会在函数返回后不复存在。但是，闭包函数可以维护对该变量的引用，并使该局部变量即使在函数返回后仍然存在——这就是闭包函数的真正威力。它可以让你模仿一个类的某些行为（实例变量），只需要一点点代码。

这是一个更高级的示例，可能需要深入思考才能理解行为的细节。

```
function makeBankAccount() {
    // Each time this makeBankAccount func is called, a new, totally
    // independent local variable named $balance is created.
    $balance = 0;

    // Also, on each call we create 2 new closure functions, $modifyBalance, and $getBalance
    // which will hold a reference to the $balance variable even after makeBankAccount returns.
    $modifyBalance = function($amount) use (&$balance) {
        $balance += $amount;
    };

    $getBalance = function() use (&$balance) {
        return $balance;
    };

    // return both closure functions.
    return ['modifyBalance' => $modifyBalance, 'getBalance' => $getBalance];
}

// Let's prove that bank1 works by adding 5 to the balance by using the first
// function, then using the other function to get the balance
// from the same internal variable.
$bank1 = makeBankAccount();
$bank1['modifyBalance'](5);
echo $bank1['getBalance'](); // 5 - it works.

// Now let's make another bank to prove that it has it's own independent internal $balance variable.
$bank2 = makeBankAccount();
$bank2['modifyBalance'](10);
echo $bank2['getBalance'](); // 10 - as expected. It would have printed 15 if bank2 shared a variable with bank1.

// Let's test bank1 one more time to be sure that bank2 didn't mess with it.
echo $bank1['getBalance'](); // 5 - still 5, as expected. 
```

您可能已经注意到我在此示例中使用了[引用运算符。](http://php.net/manual/en/language.references.php) `&`如果您还不熟悉它们，只需知道引用很难理解。虽然，我希望这篇文章本身是有意义的。

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2012-05-21T21:33:05.883

闭包是在自己的环境中评估的函数，它具有一个或多个绑定变量，在调用函数时可以访问这些变量。它们来自函数式编程世界，其中有许多概念在起作用。闭包类似于 lambda 函数，但更智能的是它们能够与定义闭包的外部环境中的变量进行交互。

use() 关键字让您可以从函数环境外部、函数内部导入变量。要从外部环境导入的变量在闭包函数定义的 use 子句中指定。默认情况下，它们是按值传递的。因此，假设该函数没有参数，但您不希望它使用您已经拥有的变量。

```
$string = "Hello World!";
$closure = function() use ($string) { echo $string; }; 
```

当您需要创建一个必须在其他地方用作回调的函数并且只能具有定义的参数时，这很有用。use() 关键字让您可以使用除了作为函数参数传递的变量之外的其他变量。例如在 php.net 上的例子： http: [//php.net/manual/en/functions.anonymous.php](http://php.net/manual/en/functions.anonymous.php)

```
public function getTotal($tax)
    {
        $total = 0.00;

        $callback =
            function ($quantity, $product) use ($tax, &$total)
            {
                $pricePerItem = constant(__CLASS__ . "::PRICE_" .
                    strtoupper($product));
                $total += ($pricePerItem * $quantity) * ($tax + 1.0);
            };

        array_walk($this->products, $callback);
        return round($total, 2);
    } 
```

$callback 必须只有两个参数，因为 array_walk 只允许这么多：

> 通常，funcname 有两个参数。数组参数的值是第一个，键/索引是第二个。

所以，我们能做些什么？我们调用`use()`添加其他变量，这些变量不是 $callback 的范围，而是在它被调用的环境范围内。****

# profiler - 采样性能分析器用户界面以使用我的自定义域特定语言 (DSL)

> ID：10692823
> 
> 赞同：0
> 
> 时间：2012-05-21T21:23:58.897
> 
> 标签：profiler, dsl

我有一个自定义域特定语言 (DSL) 和一个采样性能分析器，它生成类似于其他分析器的数据馈送（当前堆栈跟踪、包含样本、独家样本等）。我希望利用现有的 GUI 来更好地可视化分析器结果，但无法找到以这种方式可插入/可扩展的 GUI。

此外，DSL 在计算集群中运行，因此任何可以同时为单个节点或多个节点分割和切块数据的 GUI 都是理想的。最终我想将它集成到视觉工作室中，但此时我会为任何事情感到高兴。感谢您的建议！

抢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T12:37:16.633

我怀疑你是否会找到这样一个你可以为自己的目的利用的 UI。

不过写一个应该不难，不像[Zoom](http://www.rotateright.com/)中的那个，或者像我几年前做的这个，通常称为*蝴蝶视图*，但对于代码行，而不是函数：

![在此处输入图像描述](../Images/9dc9cd5dcfbc7a7aabe0a56c187539f1.png)

它很容易编程。您有一些堆栈跟踪，每个堆栈跟踪都由一系列代码行组成，其中每一行代码代表对函数的调用，“底部”行除外。假设您有 100 个堆栈跟踪。

在任何时间点，您都有一个特定的代码行，即“焦点”，在这种情况下`foo.cpp: 326`。这`33%`是包含该行的堆栈跟踪的一部分（即使该行在某些跟踪上出现多次）。该百分比大致是如果可以删除该行可以节省多少总时间，这就是它的责任。

在这 33 个堆栈跟踪中，它说线条出现在其中 25 个和其中8 个`gzorn.cpp: 99`的焦点线上方。`foo.cpp:105`（这是递归的情况。请注意是否存在递归，祖先或后代不必加起来与焦点线相同的百分比。）

它还说明了通过该行的 33 个堆栈跟踪，其中 16 个`bar.cpp:45`是下一行，其中 10 个有`bar.cpp:10`，其中 7 个有`bar.cpp:17`。

或者，您可以在每条线上显示穿过*该*线的迹线部分。

然后用户可以通过单击这些“邻居”中的任何一个来改变焦点来寻找昂贵的代码行。

请注意这是多么容易编程。除了堆栈跟踪本身之外，您不需要任何数据结构，也不需要计算任何统计信息。更重要的是，您不必拥有大量的堆栈跟踪，因为这样做只会使百分比更加精确，这并不是特别重要。

PS我差点忘了提。您的堆栈跟踪不仅应在 CPU 时间期间进行，而且应在 I/O 或其他阻塞时间期间进行。这很关键，因为程序通常会由于 I/O、睡眠、资源等待等原因而变慢，您需要知道这一点。如果您仅仅因为与其他进程的竞争而担心速度缓慢，那么这并不是真正的问题，因为它不会过多地甩掉百分比。

# iphone - NSZombieEnabled 防止我的 应用程序崩溃

> ID：10692831
> 
> 赞同：4
> 
> 时间：2012-05-21T21:24:35.527
> 
> 标签：iphone, objective-c, ios, ipad

所以我一直在像疯子一样在 Instruments 中使用 NSZombiesEnabled 和 NSZombies 进行调试。但是，当使用僵尸运行应用程序时，它似乎解决了我的问题。当我在仪器中运行没有 NSZombiesEnabled 或 NSZombies 的应用程序时，它会崩溃。关于如何处理这个问题的任何想法？

所以问题是我发布了两次，但似乎找不到我在哪里做这件事。打开 NSZombieEnabled 将无济于事，因为程序运行良好而没有告诉我我在哪里过度释放。

所以我想我知道它在哪里崩溃了，我正在创建这个 globalArray Singleton 类：

```
extern NSString * const kClearDataSource;

@interface AHImageDataSource : NSObject
+ (AHImageDataSource *)sharedDataSource;
- (void) clearDataSource;
- (void) addObject:(id) object;
- (void) addObject:(id)object atIndex:(int) index;
- (int) count;
- (id) objectAtIndex:(int) index;
@end

NSString * const kClearDataSource = @"clearDataSource";

@interface AHImageDataSource()
{
    NSMutableArray * imageDataSource_;
}

@property (nonatomic, retain) NSMutableArray * imageDataSource_;

@end

@implementation AHImageDataSource
@synthesize imageDataSource_;

+ (AHImageDataSource *)sharedDataSource {
    static AHImageDataSource *_sharedClient = nil;
    static dispatch_once_t oncePredicate;
    dispatch_once(&oncePredicate, ^{
        _sharedClient = [[self alloc] init];
    });

    return _sharedClient;
}

- (id)init {
    self = [super init];
    if (!self) {
        return nil;
    }

    NSMutableArray * temp = [[NSMutableArray alloc] initWithCapacity:200];
    self.imageDataSource_  = temp;
    [temp release];

    return self;
}

-(void) clearDataSource
{
    if ([self.imageDataSource_ count] > 0){
        [self.imageDataSource_ removeAllObjects];
    }
}

- (void) addObject:(id) object
{
    [self.imageDataSource_ addObject:object];
}

- (void) addObject:(id)object atIndex:(int) index
{
    [self.imageDataSource_ insertObject:object atIndex:index];
}

- (int) count
{
    return [self.imageDataSource_ count];
}

- (id) objectAtIndex:(int) index
{
    if (index >= 0 && index < [self.imageDataSource_ count]){
        return [self.imageDataSource_ objectAtIndex:index];
    } 

    return nil;
}

- (void) dealloc
{
    [super dealloc];
    [imageDataSource_ release];
}

@end 
```

在代码的某一时刻，我试图删除数组中的所有对象，然后添加一些东西。当这种情况发生时，崩溃就发生了。

这部分代码在第二次执行时崩溃：

```
 NSArray *arr = [response valueForKey:@"data"];
                 if ([arr count] > 0){
                     [[AHImageDataSource sharedDataSource] clearDataSource];
                 }

                for (NSDictionary * data in arr){
                     AHInstagramImageData * imgData = [[AHInstagramImageData alloc] initWithData:data];
                     [[AHImageDataSource sharedDataSource] addObject:imgData];
                     [imgData release];
                 } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-22T00:16:48.973

你绝对不应该在你的方法中`[super dealloc]` *先做。*`-dealloc`它必须排在*最后*。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-21T21:27:57.023

去产品 - >分析。显示的消息将为您提供解决方案或想法。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-21T21:36:21.700

当向已释放的对象发送消息时，您的应用程序会崩溃。NSZombiesEnabled 可以防止您的应用程序崩溃，因为它会保留所有已释放的对象（因此会泄漏所有内容）。当释放的对象被发送消息（这通常会使您的应用程序崩溃）时，它将在控制台中打印一条消息。影响“发送到已释放对象'foo'的消息'bar'”（或类似的东西）的影响。它实际上并没有暂停您的应用程序的执行。

当您知道您的应用程序通常会崩溃时，请检查控制台日志以获取与上述类似的消息。

# iphone - 在多个类中重用自定义 UITableViewCell

> ID：10692837
> 
> 赞同：1
> 
> 时间：2012-05-21T21:24:50.137
> 
> 标签：iphone, uitableview

我创建了 UITableViewCell 的自定义子类。在一个视图控制器中，它工作正常。在另一种情况下，标签显示为默认值（例如@“Label”），但其中没有我想要的文本。就好像插座没有连接一样。但是，在一类中，它运行良好，我看到标签相应地发生了变化。

在两个 ViewControllers 中，在 viewdidLoad 中，我这样做：

```
[self.baseTableView registerNib:[UINib nibWithNibName:@"TargetDetailTableViewCell" bundle:nil] forCellReuseIdentifier:TargetCellIdentifier]; 
```

在 ViewController 的两个 .m 文件中，在方法之上，我有：

```
static NSString *TargetCellIdentifier = @"TargetDetailTableViewCellIdentifier"; 
```

请注意，我尝试在两个类之间更改此字符串标识符，以查看是否是导致问题的原因，而事实并非如此。

然后在 cellForRowAtIndexPath 中，我为两者做同样的事情来获取我的单元格：

```
TargetDetailTableViewCell *cell = (TargetDetailTableViewCell *)[tableView dequeueReusableCellWithIdentifier:TargetCellIdentifier]; 
```

然后我在两者中都做同样的事情并做类似的事情：

```
cell.descriptionLabel = @"test"; 
```

在一个 viewController 中，descriptionLabel 发生了变化，而在另一个 viewController 中则没有。所以我然后尝试将 TargetDetailTableViewCell 更改为标准 UITableViewCell 并且我的值被正确传递给该 UITableViewCell 对象。我看到它的 cell.textLabel.text 确实被分配了，而在我尝试重用这个 UITableViewCell 的第二个 viewController 中，它不起作用。

在不同的 UIViewControllers 中的不同 UITableViews 之间重用 UITableViewCell 有什么遗漏吗？谢谢。

# qt - 带有 QtCreator 的 Ubuntu 12.04 上的 OpenCV 2.4

> ID：10692848
> 
> 赞同：1
> 
> 时间：2012-05-21T21:26:08.637
> 
> 标签：qt, ubuntu, opencv, qt-creator

我最近搬到了 Ubuntu，我无法让 openCV 与 QtCreator 一起工作。如 OpenCv 安装指南中所述，我在其中构建并安装了 openCV 库`/usr/local/lib`，我`opencv.conf`在其中更新`/etc/ld.so.conf.d/`并运行`sudo ldconfig -v`。

但是，当我尝试运行一个在 namedWindow 中显示图像的简单“hello world”程序时，我收到以下错误：

> OpenCv 错误：cvGetMat，文件 /home/wedontplay/documenti/Library Installer/OpenCV-2.4.0/modules/core/array.cpp 中的错误标志（参数或结构字段）（无法识别或不支持的数组类型），第 2482 行终止调用在抛出'cv ::Exception'的实例后what（）：/home/wedontplay/Library Installer/OpenCV-2.4.0/modules/core/src/array.cpp:2482：错误：（-206）无法识别或不受支持函数 cvGetMat 中的数组类型

为什么 Qt 搜索`/home/wedontplay/Documenti/...`而不是`/usr/local/lib`（它在我有 OpenCv 库源代码的文件夹中搜索）？

任何建议将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-22T04:11:40.680

添加

```
INCLUDEPATH +=  /usr/local/include/Opencvlibname
LIBS+ = -L/usr/local/lib -[module_name1] -[module_name2] .. 
```

在您的`.pro`文件中，然后尝试。

包括模块名称，例如，如果它的 libopencvmodule1.a ，则将其添加为`LIBS+ = -L/usr/local/lib -lopencvmodule1`

# c# - 根据条件从列表中删除重复项

> ID：10692850
> 
> 赞同：6
> 
> 时间：2012-05-21T21:26:23.550
> 
> 标签：c#, linq, c#-4.0

我有一个具有属性（名称，价格）的类项目。

```
 Item1       $100
   Item2       $200
   Item3       $150
   Item1       $500
   Item3       $150 
```

我只想在名称存在多次且价格为 500 美元（使用 LINQ 且不创建自定义比较器）时删除项目？对于上述 500 美元的项目 1，将从列表中删除。

谢谢，

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-21T21:57:23.140

试试这个：

```
var result = items
    .GroupBy(item => item.Name)
    .SelectMany(g => g.Count() > 1 ? g.Where(x => x.Price != 500) : g); 
```

第一组按名称。如果该组的商品超过 1 件，则仅选择该组中价格不为 500 的商品。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-21T22:09:29.253

```
var result =
    from item in items
    where item.Price != 500 || items.Count(i => i.Name == item.Name) == 1
    select item; 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-05-21T22:39:03.427

我将首先创建一个包含重复项的*预评估子集列表：*

```
var dupes = list.Where(a => list.Count(b => b.Name.Equals(a.Name)) > 1).ToList(); 
```

`.ToList()`确保此查询仅评估一次。如果列表很大，这将在速度上产生**巨大差异。**

现在，如果您的列表是 a `List<>`，您可以使用以下`RemoveAll()`方法：

```
list.RemoveAll(item => item.Price == 500 && dupes.Contains(item)); 
```

你完成了。

但是如果您的列表只知道是`IEnumerable<>`，或者您不想修改源列表，或者您想要延迟执行，那么只需使用 LINQ：

```
var result = list.Where(item => !(item.Price == 500 && dupes.Contains(item))); 
```

这将在您枚举时进行评估`result`。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-05-21T21:32:06.090

查找重复项可以通过以下方式完成：

```
var dups = lst.Where(x=>lst.Any(y => y != x && y.Name == x.Name)) 
```

`500`可以通过以下方式查找具有价格的重复项目：

```
var dups500 = dups.Where(x=>x.Price == 500); 
```

最后删除 dups500 可以使用 except 方法：

```
var result = lst.Except(dup); 
```

或多合一：

```
var result = 
     lst.Except(
               lst
               .Where(x=>x.Price == 500 && 
                         lst.Any(y => y != x && y.Name == x.Name))).ToList(); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-05-21T21:33:07.057

```
var result = from np in NamePriceCollection
where NamePriceCollection.Count(x => x.Name == np.Name) > 1 && np.Price == 500
select np; 
```

// 这里有指定条件的项目列表。从基础集合中删除它们

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-05-22T00:22:19.040

> 仅当名称存在多次且价格为 500 美元时，我才想删除项目

```
Apple 300 <-- winner
Apple 500 <-- dupe
Banana 500  <-- winner
Banana 500  <-- dupe
Banana 500  <-- dupe
Cantelope 100 <-- winner
Cantelope 200 <-- winner 
```

显然，第二个苹果是骗子。Banana 有三件商品，价格 == 500。一件是赢家。其余的都是骗子。没有价格 == 500 Cantelopes，所以没有骗子，只有赢家。

```
from item in source
group item by item.Name into g
let okItems = g.Where(x => x.Price != 500)
let secondChoiceItem = g.FirstOrDefault(x => x.Price == 500)
let theItems = okItems.DefaultIfEmpty(secondChoiceItem)
from nonDupeItem in theItems
select nonDupeItem 
```

* * *

## 回答 #7

> 赞同：-2
> 
> 时间：2012-09-17T16:58:06.017

```
var Test = (from row in DataTable.AsEnumerable()
            select row.Field<string>("ColumnName")).Distinct(); 
```

# django-admin - Django 管理员更改列表模板

> ID：10692852
> 
> 赞同：2
> 
> 时间：2012-05-21T21:26:26.010
> 
> 标签：django-admin

我有这个模型：

```
class IllnessMedication(models.Model):
  FREQUENCY_CHOICES = (
    ('D', 'Day'),
    ('W', 'Week'),
    ('M', 'Month'),
  )

  NUMERIC_CHOICES = (
    (1, 1),
    (2, 2),
    (3, 3),
    (4, 4),
  )

  illness = models.ForeignKey(Illness)
  medication = models.ForeignKey(Medication)
  strength = models.CharField("strength", max_length=25)
  dosage = models.IntegerField("dosage", choices=NUMERIC_CHOICES)

  class Meta:
    db_table = "medication_illness"

class Medication(models.Model):
  value = models.CharField("medication", max_length=50)

  class Meta:
    db_table = "medication"

class Illness(models.Model):
  value = models.CharField("code", max_length=10)
  description = models.CharField("description", max_length=100)

  class Meta:
    db_table = "illness" 
```

我想按时尚分组显示列表视图，即

```
Illness1
   Medication11
      Strenght1    Dosage1
      Strenght2    Dosage2
      Strenght3    Dosage3

  Medication12
     Strenght1    Dosage1
     Strenght2    Dosage2
     Strenght3    Dosage3

Illness2
   Medication21
      Strenght1    Dosage1
      .................. 
```

这是否可以通过使用可用的 Django 安装选项/功能/等调整 django admin Model 和 ModelAdmin 来实现，或者我应该付出认真的努力来覆盖 change_list.html 模板？

如果后者属实，请给我一些指点。非常感谢。

义

# internet-explorer - 监视 IE 内 ActiveX 控件中的用户操作

> ID：10692857
> 
> 赞同：0
> 
> 时间：2012-05-21T21:26:37.800
> 
> 标签：internet-explorer, activex, bho

我的任务是在 IE 内的第三方 ActiveX 控件中记录所有用户操作。这些操作是在文本框中输入符号、单击按钮等。所以我创建了一个 BHO 并找到了一个具有给定 classid 的 IHTMLElement。解决此任务的下一步是什么？我使用 C#。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T08:52:54.273

正如 jeffamaphone 所说，Spy++ 能够捕获文本框的内容。为此，Spy++ 实际上是将自己的 DLL (spyxxhk.dll) 注入到 IE 中，以便能够检索控件的内容（这就是启动时请求管理权限的原因）。一旦注入 IE 进程，它就能够挂钩 IE 进程中存在的任何 DLL（也称为 ActiveX 控件）。

要执行相同类型的操作（捕获、记录等），您“只需”开发自己的注入引擎并注册它，以便在 IE 启动时自动启动。网络上有许多与这些注入机制相关的信息。这是一个开始的[网址。](http://www.codeproject.com/Articles/2082/API-hooking-revealed)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-22T16:45:59.947

ActiveX 控件驻留在对象元素中。您可以使用 IE DOM api 来访问 Object 元素，但在该层之外它对您来说变得不透明。除非 ActiveX 控件本身公开了某种自动化，否则它就是本机代码黑盒。

在原生控件中有一些拦截点击和按键的方法，主要是使用子类化或钩子。您可以使用 spy++ 来检查窗口层次结构，并使用[FindWindow](http://msdn.microsoft.com/en-us/library/windows/desktop/ms633499%28v=vs.85%29.aspx)的托管等效项来查找这些窗口。

# ruby - Ruby 忽略救援 ArgumentError

> ID：10692860
> 
> 赞同：8
> 
> 时间：2012-05-21T21:26:45.730
> 
> 标签：ruby, rescue

当我运行以下命令时，ArgumentError 似乎忽略了救援。来自 Ruby 的 ArgumentError 错误消息出现在控制台上，但我的 puts 消息没有出现。我尝试使用 TypeError 和 ZeroDivisionError 进行救援，并且成功了。

```
def divide(a, b)
    begin
        a.to_s + ' divided by ' + b.to_s + ' is ' + (a/b).to_s
    rescue ArgumentError
        puts 'there must be two arguments'
    end 
end

divide(4) 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-21T21:31:26.290

异常不会在函数内部抛出，而是在调用它的地方抛出，所以你需要在其他地方捕获它：

```
def divide(a, b)
  a.to_s + ' divided by ' + b.to_s + ' is ' + (a/b).to_s
end

begin
  divide(4)
rescue ArgumentError
  puts 'there must be two arguments'
end 
```

虽然这可行，但捕获`ArgumentError`是一个非常糟糕的主意，因为它表明您的代码中有一个错误，您不应该从中恢复。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-21T21:31:34.327

将对这部分代码进行救援：`a.to_s + ' divided by ' + b.to_s + ' is ' + (a/b).to_s`。如果您明白我的意思，您的异常不是在方法中触发，而是在调用时触发。

# ios - 使用大中央调度从文件加载 UIImage

> ID：10692864
> 
> 赞同：1
> 
> 时间：2012-05-21T21:27:01.310
> 
> 标签：ios, grand-central-dispatch

我正在尝试使用 gcd 在后台加载图像。我的第一次尝试没有奏效：

```
dispatch_async(dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_LOW,0), ^{
  dispatch_async(dispatch_get_main_queue(), ^{
    // create UI Image, add to subview
  });
}); 
```

注释掉后台队列代码并只留下主队列调度块不起作用：

```
dispatch_async(dispatch_get_main_queue(), ^{
  // create UI Image, add to subview
}); 
```

在 gcd 块内做 ui 的东西有什么技巧吗？

为了回应 mattjgalloway 的评论，我只是想在后台线程中加载一个大图像。这是我最初尝试的完整代码：

```
dispatch_async(dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_LOW,0), ^{

    UIImage* img = [[UIImage alloc] initWithContentsOfFile: path];

    dispatch_async(dispatch_get_main_queue(), ^{

       imageView = [[[UIImageView alloc] initWithImage:  img] autorelease];
       imageView.contentMode = UIViewContentModeScaleAspectFill;
       CGRect photoFrame = self.frame;
       imageView.frame = photoFrame;
       [self addSubview:imageView];

  });

}); 
```

我对其进行了简化，以便在主队列中运行所有内容，但即便如此它也不起作用。我想如果我不能让整个事情在主队列中工作，那么后台队列的东西就不会工作。

* * *

================ 更新 ==============

我在一个全新的项目中尝试了上述技术（gcd 和所有），它确实按预期工作。只是不在我目前的项目中。所以我必须做一些缓慢而痛苦的消除工作来找出问题所在。我正在使用此背景加载在 uiscrollview 中显示图像。事实证明，有时会出现一些图像，但并非总是如此。我会深入了解这个......

================ 更新 ==============

看起来问题与 UIScrollView 有关，所有这些都在里面。我认为应该绘制/刷新的东西没有

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T02:10:22.843

我运行了你的代码。它有一个例外。你的意思是self.view而不是self吗？

情况1：

路径在属性中声明。
imageView 在 ivar 中声明

```
- (IBAction)buttonImagePressed:(id)sender 
{
    self.path = [[[NSBundle mainBundle] resourcePath] stringByAppendingPathComponent:@"picture1.jpg"];
    dispatch_async(dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_LOW,0), ^{
        UIImage* img = [[UIImage alloc] initWithContentsOfFile: self.path];  
        dispatch_async(dispatch_get_main_queue(), ^{
            imageView = [[[UIImageView alloc] initWithImage:  img] autorelease];
            imageView.contentMode = UIViewContentModeScaleAspectFill;
            CGRect photoFrame = self.view.frame;
            imageView.frame = photoFrame;
            [self.view addSubview:imageView];
        });
    });
} 
```

案例二：

path 和 imageView 都是 ivars。- 不使用任何属性。

```
- (IBAction)buttonImagePressed:(id)sender 
{
// will crash if path is defined here
//    path = [[[NSBundle mainBundle] resourcePath] stringByAppendingPathComponent:@"picture1.jpg"];
    dispatch_async(dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_LOW,0), ^{
        //if path is defined here then it will work
        path = [[[NSBundle mainBundle] resourcePath] stringByAppendingPathComponent:@"picture1.jpg"];
        UIImage* img = [[UIImage alloc] initWithContentsOfFile:path];
        dispatch_async(dispatch_get_main_queue(), ^{
            imageView = [[[UIImageView alloc] initWithImage:  img] autorelease];
            imageView.contentMode = UIViewContentModeScaleAspectFill;
            CGRect photoFrame = self.view.frame;
            imageView.frame = photoFrame;
            [self.view addSubview:imageView];
        });
    });
} 
```

在案例 2 中，它崩溃了，控制台中的消息说要在 apple.com 上提交错误...

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-22T05:22:05.203

尝试在`setNeedDisplay`之后立即调用`[self addSubview:imageView]`，顺便说一下，大多数 UIKit 都不是线程安全的，我不知道具体的 UIImage 方法（可能在 iOS4 及更高版本上还可以），但我不会那样做。如果您想更好地从后台加载图像，请使用线程安全的 ImageIO 或 Core Graphics 函数。
另一种方法是在后台线程上加载带有图像数据的 NSData 对象，然后`[UIImage alloc]inithWithData: data]`在主线程上调用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-01T20:59:42.930

将我的图像显示为背景图像，而不是将 UIImageView 添加为子视图。不知道为什么

```
@interface PhotoView(){
  UIImageView* imageView;
}

@end

@implementation PhotoView

-(id)initWithFrame:(CGRect)frame andPathToPhoto:(NSString*)path andSequenceView:(SequencerView*) sequencerView{
  if(self = [super initWithFrame:frame]){

    dispatch_async(dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_LOW,0), ^{
      UIImage* img = [[UIImage alloc] initWithContentsOfFile: path];
      dispatch_async(dispatch_get_main_queue(), ^{
        self.backgroundColor = [UIColor colorWithPatternImage:img];
      });
      [img release];
    });

  }
  return self;
}

@end 
```

# jquery - jquery ajax 帖子说 xxx 不允许 Access-Control-Allow-Origin

> ID：10692866
> 
> 赞同：3
> 
> 时间：2012-05-21T21:27:09.833
> 
> 标签：jquery, ajax

我试图使用 AJAX（`post`请求）调用 eBay FindProducts API，但遇到以下错误：

> XMLHttpRequest 无法加载[http://open.api.ebay.com/shopping?callname=FindProducts](http://open.api.ebay.com/shopping?callname=FindProducts)。Access-Control-Allow-Origin 不允许来源[http://localhost.com/test.php 。](http://localhost.com/test.php)

我的代码：

```
$.ajax
({
    type: "POST",
    url: 'http://open.api.ebay.com/shopping?callname=FindProducts',
    dataType: ($.browser.msie) ? "text" : "xml",
    contentType: 'application/x-javascript',
    crossDomain : true,
    data: {
        'X-EBAY-API-APP-ID' : 'ebayAppId', 
        'X-EBAY-API-VERSION': '771', 
        'X-EBAY-API-SITEID': '0', 
        'X-EBAY-API-REQUEST-ENCODING': 'NV', 
        'X-EBAY-API-RESPONSE-ENCODING': 'json',
        'QueryKeywords' : '753759971632',
        'MaxEntries' : '3'
    },
    success: function (result) {
        alert('success');
        alert(result);
    },
    error: function (data) {
        alert((data));
    }
}) 
```

我怎样才能克服这个错误。

我尝试设置`dataType : jsonp`（我知道正在检索 XML，但为了解决我将其设置为 jsonP 的错误）。它可以工作，但 jQuery 无法解析 XML，因为预期的 json 响应。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-21T21:34:05.160

如果您添加`&responseencoding=JSON`到您的 URL，您将根据[文档获得 JSON 格式的响应](http://developer.ebay.com/devzone/shopping/docs/concepts/ShoppingAPI_FormatOverview.html#URLExamples)

**更新** [工作示例](http://jsfiddle.net/sbPbL/3/)。我所做的是我更改为`dataType:'jsonp'`added `jsonp:'callbackname'`。因为 jQuery 默认调用回调参数`callback`，但 eBay 期望它被调用`callbackname`。您所要做的就是将您的参数添加到数据映射中。确保使用正确的参数名称，检查文档并使用 URL 方法而不是标头方法。希望这可以帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-21T21:36:59.387

如果您阅读了[jQuery.ajax()](http://api.jquery.com/jQuery.ajax/#dataType)文档，您可以使用 jsonp 并且仍然需要解析不同的返回类型。

> 多个空格分隔的值：从 jQuery 1.5 开始，jQuery 可以将 dataType 从它在 Content-Type 标头中接收到的内容转换为您需要的内容。例如，如果您希望将文本响应视为 XML，请使用“text xml”作为 dataType。您还可以发出 JSONP 请求，将其作为文本接收，并由 jQuery 解释为 XML：“jsonp text xml”。类似地，诸如“jsonp xml”之类的速记字符串将首先尝试从 jsonp 转换为 xml，如果失败，则从 jsonp 转换为文本，然后从文本转换为 xml。

所以基本上你所要做的就是将你`dataType`的代码行更改为：

```
dataType: ($.browser.msie) ? "jsonp text xml" : "xml", 
```

或者您可以`&responseencoding=JSON`向您的 URL 添加一个参数，如[另一个答案](https://stackoverflow.com/a/10692959/578843)中所述。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-22T05:31:06.510

感谢 Albin，我终于通过做 2 件事让 thi 开始工作。

我改成dataType:'jsonp'加了jsonp:'callbackname'。因为jQuery默认调用回调参数callback，但eBay期望它被称为'callbackname'。由于 eBay 的 CRO 问题，XML 无法正常工作（但需要确认。）

使用 chrome 控制台调试检索到的对象，使用 JSON.Stringify() 转换为字符串。

希望这对某人有帮助！

干杯，拉杰什

# c++ - TinyXml：错误代码 9

> ID：10692869
> 
> 赞同：0
> 
> 时间：2012-05-21T21:27:26.150
> 
> 标签：c++, tinyxml

我正在使用 LibCurl（使用 SSL）从 API 中检索 XML。但它给出了一个错误代码（9），我不知道它代表什么。谁能指出我的解决方案？

代码片段：

```
 if(success)
    {

        tinyxml2::XMLDocument doc;

        //Parse doc and check returncode
        int returnCode = doc.Parse((const char*)answer.c_str());
        if(returnCode == 0)
        {
          ... 
```

字符串答案的内容：

```
answer  "<?xml version="1.0" encoding="utf-8"?><response><retrieval_state>PE</retrieval_state><extension>.wav</extension><created>2012-05-21 16:22:58.080142</created><retrieval_log> </retrieval_log><download_url>https://com-samplesumo-api-production-files.s3.amazonaws.com/22/ff/db/22/22ffdb22-a38b-11e1-8079-fefdb24fa184.wav?Signature=jKjxnXt29atJsE0r%2BMLGvnsm1Cg%3D&amp;Expires=1337636278&amp;AWSAccessKeyId=AKIAJFTECP76EXJQW7EQ</download_url><file_uuid>22ffdb22-a38b-11e1-8079-fefdb24fa184</file_uuid><original_filename>911.wav</original_filename></response>0"    std::basic_string<char,std::char_traits<char>,std::allocator<char> > 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T21:29:24.917

内容末尾的尾随`0`使 XML 无效。根据定义，TinyXml 错误 9 是`TIXML_ERROR_PARSING_UNKNOWN`.

# java - Java的内置字体和第三方字体有什么区别？

> ID：10692870
> 
> 赞同：3
> 
> 时间：2012-05-21T21:27:29.057
> 
> 标签：java, macos, swing, fonts, jlabel

试图找出此处发现的 MultiLineLabel 代码中可能存在的错误：http: [//samuelsjoberg.com/archive/2009/10/multiline-labels-in-swing](http://samuelsjoberg.com/archive/2009/10/multiline-labels-in-swing)

从本质上讲，该示例将运行得很好，比如 Arial。但是如果我在我的 Mac 上安装了一个自定义字体，比如 ITCKorinna-Bold，它仍然会呈现 MultiLineLabel，但它不会添加任何换行符，所以“这是一条长线”。变成“这是……”

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-27T10:47:16.140

在具有 OpenJDK 7 更新 19 的 Linux 上，它工作得很好。你还没有提供你的代码，所以我们很难看出这是否有问题。

当我修改示例以使用 Roboto 时，换行符按预期工作。

我不知道您使用的是哪个 Java 运行时，但如果您使用的是 Apple 提供的那个，则 FontMetrics 对象返回的值可能会有所不同（因为 Apple Java 运行时的字体渲染不同，例如 Linux 上的 OpenJDK ）。我建议尝试 OpenJDK 看看是否会有所不同，或者在不同的平台上运行您的应用程序，看看是否会有所不同。

```
 Font robotoFont = null;
    try {
        robotoFont = Font.createFont(Font.TRUETYPE_FONT, new File("/usr/share/fonts/roboto/Roboto-Black.ttf"));
        robotoFont = robotoFont.deriveFont(14f);
    } catch (Exception e) {
        e.printStackTrace();
    }

    // Using the MultiLineLabel class.
    final MultiLineLabel mLabel = new MultiLineLabel(
            "Lorem ipsum dolor sit amet, consectetur adipiscing elit. "
                    + "Phasellus non sapien quam. Fusce posuere, nisl "
                    + "vitae tristique volutpat, augue erat faucibus nisl, "
                    + "nec venenatis metus sem vel enim. Cras in libero "
                    + "sapien, vitae euismod neque. Proin hendrerit, odio "
                    + "et faucibus suscipit, eros tellus blandit justo, "
                    + "ac cursus risus elit ut risus.");
    mLabel.setForeground(Color.WHITE);
    mLabel.setFont(robotoFont); 
```

![在此处输入图像描述](../Images/349db34407fae087272c76ddf9afa8eb.png)

# php - 根据服务器数据设置微调器选择？

> ID：10692877
> 
> 赞同：2
> 
> 时间：2012-05-21T21:28:13.903
> 
> 标签：php, android, sql, spinner

我有一个带有 5 个微调器的选项页面。当用户登录并修改他们的帐户选项时，我希望微调器加载用户对微调器的选择。目前，每个微调器都会在其适配器“请选择”中加载第一个值。如果检查了服务器并且用户尚未做出选择，那很好 - 但我希望根据明显的条件来决定。

有没有好的方法来做到这一点？我刚刚完成了将微调器选项发送到服务器并将它们存储在适当用户旁边的代码。所以我知道我需要不同的 PHP 查询，这没问题。*但是如何为 onCreate 中的微调器设置可见值？*

```
 ageSpinner = (Spinner) findViewById(R.id.ageSpinner);
    ageAdapter = ArrayAdapter.createFromResource
    (this, R.array.ageArray, android.R.layout.simple_spinner_item);
    ageAdapter.setDropDownViewResource(android.R.layout.simple_spinner_dropdown_item);
    ageSpinner.setAdapter(ageAdapter);
    ageSpinner.setTag("age");
    ageSpinner.setOnItemSelectedListener(new MyOnItemSelectedListener());

    eduSpinner = (Spinner) findViewById(R.id.eduSpinner);
    eduAdapter = ArrayAdapter.createFromResource
    (this, R.array.eduArray, android.R.layout.simple_spinner_item);
    eduAdapter.setDropDownViewResource(android.R.layout.simple_spinner_dropdown_item);
    eduSpinner.setTag("edu");
    eduSpinner.setAdapter(eduAdapter);
    eduSpinner.setOnItemSelectedListener(new MyOnItemSelectedListener());

    maritalSpinner = (Spinner) findViewById(R.id.maritalSpinner);
    maritalAdapter = ArrayAdapter.createFromResource
    (this, R.array.maritalArray, android.R.layout.simple_spinner_item);
    maritalAdapter.setDropDownViewResource(android.R.layout.simple_spinner_dropdown_item);
    maritalSpinner.setTag("marital");
    maritalSpinner.setAdapter(maritalAdapter);
    maritalSpinner.setOnItemSelectedListener(new MyOnItemSelectedListener());

    nationalitySpinner = (Spinner) findViewById(R.id.nationalitySpinner);
    nationalityAdapter = ArrayAdapter.createFromResource
    (this, R.array.nationalityArray, android.R.layout.simple_spinner_item);
    nationalityAdapter.setDropDownViewResource(android.R.layout.simple_spinner_dropdown_item);
    nationalitySpinner.setTag("nationality");
    nationalitySpinner.setAdapter(nationalityAdapter);
    nationalitySpinner.setOnItemSelectedListener(new MyOnItemSelectedListener());

public class MyOnItemSelectedListener implements OnItemSelectedListener {

    public void onItemSelected(AdapterView<?> parent,
            View view, int pos, long id) {

        if (pos != 0) {

            param.add(new BasicNameValuePair(parent.getTag().toString(), 
                    parent.getItemAtPosition(pos).toString()));
        }
    }

    public void onNothingSelected(AdapterView parent) {
        // Do nothing.
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T21:52:49.897

您应该创建一个扩展类`BaseAdapter`，使用带有列表（字符串列表）的构造函数并使其实现`SpinnerAdapter`：

```
public class MySpinnerAdapter extends BaseAdapter<String> implements SpinnerAdapter {
    public MySpinnerAdapter(Context context, List<String> listStrings ) {
       super( context, android.R.layout.android.R.layout.simple_list_item_1, listStrings );
    }

    public View getDropDownView(int position, View convertView, ViewGroup parent) {
       if( convertView == null ) {
          convertView = new TextView( getContext() );
       }
       ((TextView) convertView).setText( getItem( position) );
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-31T18:46:04.670

我使用了链接到 CustomDialog 的 EditTexts 来显示数据。它工作得更好。我有将数据加载到不可编辑的 EditTexts onCreate 和 onSubmit 的 AsyncTasks。下面是一些相关代码：

```
 ageEditText = (EditText) findViewById(R.id.ageEditText);
    ageEditText.setOnClickListener(fieldListener);
    ageEditText.setId(0);
    educationEditText = (EditText) findViewById(R.id.educationEditText);
    educationEditText.setOnClickListener(fieldListener);
    educationEditText.setId(1);
    maritalEditText = (EditText) findViewById(R.id.maritalEditText);
    maritalEditText.setOnClickListener(fieldListener);
    maritalEditText.setId(2);
    backgroundEditText = (EditText) findViewById(R.id.backgroundEditText);
    backgroundEditText.setOnClickListener(fieldListener);
    backgroundEditText.setId(3);
    incomeEditText = (EditText) findViewById(R.id.incomeEditText);
    incomeEditText.setOnClickListener(fieldListener);
    incomeEditText.setId(4);
    partyEditText = (EditText) findViewById(R.id.partyEditText);
    partyEditText.setOnClickListener(fieldListener);
    partyEditText.setId(5); 
```

public OnClickListener fieldListener = new OnClickListener() { public void onClick(View v) { FragmentManager fm = getSupportFragmentManager(); 开关（v.getId（））{案例（0）：

```
 ChooseDialog ageDialog = new ChooseDialog("Age", ageEditText, act);
        ageDialog.show(fm, "fragment_edit_name");
            break;
        case (1) :
        ChooseDialog educationDialog = new ChooseDialog("Education", educationEditText, act);

        educationDialog.show(fm, "fragment_edit_name");
            break;
        case (2) :
        ChooseDialog maritalDialog = new ChooseDialog("Marital", maritalEditText, act);

        maritalDialog.show(fm, "fragment_edit_name");
            break;
        case (3) :
        ChooseDialog backgroundDialog = new ChooseDialog("Background", backgroundEditText, act);

        backgroundDialog.show(fm, "fragment_edit_name");
            break;
        case (4):
            ChooseDialog incomeDialog = new ChooseDialog("Income", incomeEditText, act);

            incomeDialog.show(fm, "fragment_edit_name");
                break;
        case (5):
            ChooseDialog partyDialog = new ChooseDialog("Income", partyEditText, act);

            partyDialog.show(fm, "fragment_edit_name");
                break;

        }

    }
};

private void submit() {
    params = new ArrayList<NameValuePair>();
    getButtons();
    params.add(new BasicNameValuePair("age", ageEditText.getText().toString()));
    params.add(new BasicNameValuePair("marital", maritalEditText.getText().toString()));
    params.add(new BasicNameValuePair("background", backgroundEditText.getText().toString()));
    params.add(new BasicNameValuePair("education", educationEditText.getText().toString()));
    params.add(new BasicNameValuePair("income", incomeEditText.getText().toString()));
    params.add(new BasicNameValuePair("sex", sexString));
    params.add(new BasicNameValuePair("employment", empString));
    params.add(new BasicNameValuePair("party", partyEditText.getText().toString()));

    params.add(new BasicNameValuePair("user", dbHandler.getUserDetails().get("email").toString()));
    DemoTask demoTask = new DemoTask(act, params);
    demoTask.execute();
} 
```

# mysql - MySQL更新更改多列是非原子的？

> ID：10692884
> 
> 赞同：8
> 
> 时间：2012-05-21T21:28:40.657
> 
> 标签：mysql, sql, django, sqlite

我在使用 Django 和 MySQL 5.5.22 时遇到以下问题。

给定一个包含列 id、level 和存储为 a11、a12、a21、a22 的 2x2 矩阵的表，我有这一行：

```
id   a11   a12   a21   a22   level
324  3     2     5     3     2 
```

给定一个查询集 qs，我进行以下更新：

```
qs.update(
    a11=(b12 * a21 - b11 * a22) * F('a11') + (b11 * a12 - b12 * a11) * F('a21'),
    a12=(b12 * a21 - b11 * a22) * F('a12') + (b11 * a12 - b12 * a11) * F('a22'),
    a21=(b22 * a21 - b21 * a22) * F('a11') + (b21 * a12 - b22 * a11) * F('a21'),
    a22=(b22 * a21 - b21 * a22) * F('a12') + (b21 * a12 - b22 * a11) * F('a22'),
    level=(F('level') - 1)
    ) 
```

django 为其生成以下查询（从 db.connection.queries 中获取，为简洁起见，删除 where 子句）：

```
UPDATE `storage` 
SET 
`a21` = (3 * `storage`.`a11`) + (-1 * `storage`.`a21`), 
`a22` = (3 * `storage`.`a12`) + (-1 * `storage`.`a22`), 
`level` = `storage`.`level` - -1, 
`a11` = (2 * `storage`.`a11`) + (-1 * `storage`.`a21`), 
`a12` = (2 * `storage`.`a12`) + (-1 * `storage`.`a22`) 
```

之后我的行看起来像这样：

```
id   a11   a12   a21   a22   level
324  2     1     4     3     1 
```

对于任何行，`a12*a21 - a11*a22 = 1`都应该是 True，据此，该行应该是：

```
id   a11   a12   a21   a22   level
324  1     1     4     3     1 
```

这就是我在 SQLite 上得到的结果，Django 生成相同的查询，我花了很多时间才发现 MySQL 做了一些不同的事情。从查询来看，似乎在更新相互依赖的多行时，MySQL 不会将其视为单个原子操作，并且随着列的更新，它们会影响依赖于它们的值。我确认这似乎是 Python 提示符下的以下代码所发生的情况：

```
>>> a11, a12, a21, a22 = (3, 2, 5, 3)
>>> (2 * a11) + (-1 * a21),\
... (2 * a12) + (-1 * a22),\
... (3 * a11) + (-1 * a21),\
... (3 * a12) + (-1 * a22)
(1, 1, 4, 3) 
```

如果列一次更新一个，则按照查询给出的相同顺序：

```
>>> a11, a12, a21, a22 = (3, 2, 5, 3)
>>> a21 = (3*a11) + (-1*a21)
>>> a22 = (3*a12) + (-1*a22)
>>> a11 = (2*a11) + (-1*a21)
>>> a12 = (2*a12) + (-1*a22)
>>> (a11, a12, a21, a22)
(2, 1, 4, 3) 
```

这是一个非常可怕的行为，因为这是一个旨在跨平台使用的库。我的问题是：

1.  哪个做错了，MySQL 还是 SQLite？这可以被认为是一个错误吗？
2.  我对其他主要数据库（Oracle、PostgreSQL 和 SQLServer）有什么期望？
3.  我可以用 Django ORM（无原始查询）做什么来规范这种行为？

**编辑**

问题很清楚，但我仍在寻找解决方案。对于这个特定的应用程序来说，拉取所有值并将它们推回不是一个可接受的解决方案。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-05-21T21:43:32.317

PostgreSQL、Oracle 和 SQL Server 都将其视为原子操作。 [请参阅以下 SQL Fiddle，并切换服务器以查看以下 SQL 的行为](http://sqlfiddle.com/#!1/64abc/1)：

```
CREATE TABLE Swap (
  a CHAR(1),
  b CHAR(1)
);

INSERT INTO Swap (a, b) VALUES ('a', 'b');

UPDATE Swap SET a = b, b = a;

SELECT * FROM Swap; 
```

MySQL 是唯一实现此功能的 RBDMS，更新后两列都包含相同的值。

至于如何解决这个问题，我会改为从数据库中提取值，在应用程序内部进行计算（而不是更新语句），然后使用计算值更新数据库。这样，您可以保证以一致的方式执行计算。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-05-21T21:42:44.923

如[MySQL 手册](http://dev.mysql.com/doc/en/update.html)中所述：

> 以下语句中的第二个赋值设置`col2`为当前（更新）`col1`值，而不是原始`col1`值。结果是`col1`和`col2`具有相同的值。此行为不同于标准 SQL。
> 
> ```
> 更新 t1 集 col1 = col1 + 1, col2 = col1;
> ```

因此，在您的情况下，`a21`评估表达式时使用的值``a11` = (2 * `storage`.`a11`) + (-1 * `storage`.`a21`)`是新的、更新的值 4 而不是原始值 5。正如手册所述，*此行为与标准 SQL 不同*。

您可以改为使用具有多表`UPDATE`语法的自联接，但是我不知道是否可以使用 Django ORM 实现这样的事情：

```
UPDATE storage AS old
  JOIN storage AS new USING (id)
SET
  new.a21   = (3 * old.a11) + (-1 * old.a21),
  new.a22   = (3 * old.a12) + (-1 * old.a22),
  new.level = old.level - -1,
  new.a11   = (2 * old.a11) + (-1 * old.a21),
  new.a12   = (2 * old.a12) + (-1 * old.a22); 
```

在[sqlfiddle](http://sqlfiddle.com/#!2/92aa8/1)上查看。

我唯一的另一个想法（这绝对应该可以在 Django 中实现）是将更新拆分为单独的部分，定义在后面部分更新的字段与之前已更新的那些字段的新（而不是旧）值相关部分：

```
UPDATE storage
SET    a21   = (3 * a11) + (-1 * a21),
       a22   = (3 * a12) + (-1 * a22),
       level = level - -1;

UPDATE storage
SET    a11   = (2 * a11) + (-1 * (3*a11 - a21)),
       a12   = (2 * a12) + (-1 * (3*a12 - a22)); 
```

为了防止并发问题，您应该在事务中执行这两个更新（如果 RDBMS 支持）。

# html - HTML 横幅传输数据

> ID：10692889
> 
> 赞同：1
> 
> 时间：2012-05-21T21:29:01.190
> 
> 标签：html

我正在寻找将用户输入的数据从横幅广告传输到登录页面的方法，就好像它是从登录页面输入的一样。

横幅是针对域名注册公司的，并且有一个用于输入域的字段。提交后，横幅链接到登录页面并检查横幅中输入的域名的可用性。

目前有 Flash 横幅可以做到这一点，但需要一个非 Flash 选项。

有任何想法吗？——</p>

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T21:33:34.990

托管横幅的网站必须允许您的内容使用 html 或嵌入式 iframe。如果您可以使用这些选项中的任何一个，那么您可以使用以下代码

```
<form method="get" action="URL_TO_POST_DATA_TO">

<input type="text" value="enter a domain" name="domain" />
<input type="submit" value="go" />

</form> 
```

当用户点击提交时，您将最终到达 URL_TO_POST_DATA_TO?domain=VALUE_ENTERED

# ruby-on-rails-3 - 如何访问黄瓜中的子域

> ID：10692893
> 
> 赞同：0
> 
> 时间：2012-05-21T21:29:19.647
> 
> 标签：ruby-on-rails-3, cucumber

在我的黄瓜步骤中，我需要找到子域，以便我可以针对数据库查询它并查找是否创建了记录。我还想知道为特定用户切换到正确子域的最佳方法。我正在使用以下内容：

*   黄瓜导轨 1.3.0
*   rspec-rails 2.10.1
*   蒙古族

这是当前步骤定义的样子。但是 request 在这里不是正确的方法。

```
Then /^I should be on the ([^"]*) page$/ do |arg1|
  request.uri.should == "/#{arg1}"
end

Then /^I should be on the ([^"]*) subdomain$/ do |arg1|
  request.subdomain.should == arg1
end 
```

这些步骤都不起作用，因为 request 是一种在 selenium 驱动程序中发出实际 http 请求的方法。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-22T19:51:14.133

假设您有某种`browser`变量，这样的事情应该可以工作：

`browser.getLocation.should == "/#{arg1}"`

# c# - 使用 byte[] 键和驱逐策略构建 C# 缓存

> ID：10692897
> 
> 赞同：4
> 
> 时间：2012-05-21T21:29:26.823
> 
> 标签：c#, .net

我想在 C# 中使用驱逐策略构建缓存。我的键是一个字节数组（固定为 32 个字节），值是一个特定类的实例。

我正在讨论最好的方法来做到这一点。我认为这`MemoryCache`是要走的路，但它`string`用于钥匙。我可以把它变成一个十六进制字符串，但这会产生一些开销。为什么键不是字典中的任意对象？

编写一个字节数组比较器很简单，并且有一个合适的`Dictionary`构造函数来提供`IEqualityComparer`，但是这种方法并没有免费给我一个驱逐策略。

还有其他我忽略的选择吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-22T04:25:13.297

`MemoryCache`实际上在引擎盖下相当复杂（如果你还没有的话，拿一份 Reflector 看看）。它所做的有几件事是不可复制的；其中最主要的是缓存对象使用的近似内存大小。

在性能方面，您将面临**比**按键按摩更重要的影响。性能是可以接受的，但密钥管理是该过程的一个微不足道的部分。

您可以通过对 a`Dictionary`与`MemoryCache`.

这是一个可以在字节键上使用的小十六进制算法，我已经将其调整为尽可能快。BCL 还包含 base 16 功能（我在编写此代码时不知道这些功能，我一直保留它，因为它更简单/更快）。

*正如评论中所指出的，`byte[]`除非密钥将在其他地方使用，否则甚至可能不需要将其转换为十六进制来满足规定的要求。*

```
public unsafe sealed class Hex
{
    private static readonly char[] _hexRange = { '0', '1', '2', '3', '4', '5', '6', '7', '8', '9', 'a', 'b', 'c', 'd', 'e', 'f' };

    /// <summary>
    /// Converts a byte array into a string of base-16 values.
    /// </summary>
    /// <param name="value">Value to convert.</param>
    /// <returns>Base-16 encoded string.</returns>
    public static string ToHexString( byte[] value )
    {
        char* buffer = stackalloc char[( value.Length * 2 ) + 1]; // +1 for null terminator
        char* start = buffer;

        for( int i = 0; i < value.Length; i++ )
        {
            *buffer++ = _hexRange[value[i] / 16];
            *buffer++ = _hexRange[value[i] % 16];
        }

        return new string( start );
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-21T22:07:33.227

那么，一种解决方案是在网络上寻找图书馆。就像一个 LRU 列表。

另一方面，MemoryCache 是经过良好测试和精心设计的。它可能非常快。如果计算字符串键的性能开销是可以接受的，我会选择那个解决方案。我的猜测是计算密钥的开销远低于执行缓存操作，但这是一个猜测（需要测量）。

# delphi - Delphi 似乎在它应该之前破坏了对象

> ID：10692899
> 
> 赞同：8
> 
> 时间：2012-05-21T21:29:29.063
> 
> 标签：delphi

我正在使用 Delphi XE2 为 Googledocs api 开发一个 Delphi 包装器。我使用 XML 数据绑定向导生成了所有类。这使用代码更容易解​​释，所以这是我的测试调用的函数。

```
function TGoogleDocsApi.GetEntries : IXMLEntryTypeList;
var
  httpHelper : IHttpHelper;
  xml, url : string;
  xmlDoc : TXmlDocument;
  ss : TStringStream;
  feed : IXmlFeedType;
begin
  ss := TStringStream.Create;
  httpHelper := THttpHelper.Create;
  if(fToken.IsExpired) then
    fToken.Refresh(fClientId,fClientSecret);
  url := BaseUrl + 'feeds/default/private/full?showfolders=true&access_token='+fToken.AccessToken+'&v=3';
  xml := httpHelper.GetResponse(url);
  ss.WriteString(xml);
  ss.Position := 0;
  xmlDoc := TXmlDocument.Create(nil);
  xmlDoc.LoadFromStream(ss);
  feed := GoogleData2.Getfeed(xmlDoc);
  Result := feed.Entry;
end; 
```

现在，在点击“end”时，Result.ChildNodes 在内存中有一个地址，其计数为 20。IXMLEntryTypeList 是 IXMLNodeCollection 的子接口。

现在这是我的测试：

```
procedure TestIGoogleDocsApi.TestGetEntries;
var
  ReturnValue: IXMLEntryTypeList;
begin
  ReturnValue := FIGoogleDocsApi.GetEntries;
  if(ReturnValue = nil) then
    fail('Return value cannot be nil');
  if(ReturnValue.ChildNodes.Count = 0) then
    fail('ChildNodes count cannot be 0');
end; 
```

在第二个 if 语句中，我得到一个访问冲突，说“模块 'GoogleDocsApiTests.exe' 中地址 0061A55C 的访问冲突。读取地址 00000049”，当我查看 ReturnValue 和 ReturnValue.ChildNodes 的手表时，我看到 ReturnValue 有与 TGoogleDocsApi.GetEntries 方法中的 Result 相同的地址，但它给了我对 ReturnValue.ChildNodes 和 TGoogleDocsApi.GetEntires 方法的手表的访问冲突，Result.ChildNodes 具有有效的地址并且其属性已填写。

对我来说，Delphi 似乎正在沿线某处释放 ChildNodes 属性，但这对我来说没有意义，因为 ReturnValue 仍然应该引用它（我认为）应该保留它。

任何想法可能会发生什么？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-05-21T21:54:29.473

You're calling `TXMLDocument.Create` with an `Owner` of `nil`. That means its lifetime is controlled via interface reference counting. In order for that to work, you *need* to actually use interfaces. Change `xmlDoc`'s type to `IXMLDocument` to maintain a reference, or else something internal to the VCL will free it when you're not expecting it.

# php - 和有什么区别 可能重复： 这个符号在 PHP

> ID：10692901
> 
> 赞同：0
> 
> 时间：2012-05-21T21:29:32.097
> 
> 标签：php, syntax

> **可能重复：**
> [这个符号在 PHP <?=](https://stackoverflow.com/questions/1963901/what-does-this-symbol-mean-in-php)
> [中是什么意思 PHP 开放标签“<?=”和“<?php”/“<?”有什么区别？](https://stackoverflow.com/questions/3019696/what-is-the-difference-between-the-php-open-tags-and-php)

`<?=`和 和有什么不一样`<?php`？

顺便说一句，我搜索`<?=`但没有出现。您将如何`<?=`在 Stack Overflow 上进行搜索？

# java - C++ 和 Java 中的溢出

> ID：10692902
> 
> 赞同：1
> 
> 时间：2012-05-21T21:29:40.677
> 
> 标签：java, c++, overflow

C++ 对溢出有什么作用？Java 对溢出有什么作用？

当 C++ 出现溢出错误时，我认为它会转到尽可能小的数字并从那里添加，但我不确定。不知道java是怎么处理这个问题的？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-21T21:37:28.907

在 C++ 标准的 n3242 中

## 5 表达式 [expr]

### 第 5.4 段：

> 如果在计算表达式期间，结果未在数学上定义或不在其类型的可表示值范围内，**则行为未定义**。[注意：大多数现有的 C++ 实现忽略整数溢出。除以零的处理，使用零除数形成余数，所有浮点异常因机器而异，通常可以通过库函数进行调整。——尾注]"

来自 OP

> 当 C++ 出现溢出错误时，我认为它会转到尽可能小的数字并从那里添加

不，有时只是这样。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-21T21:42:35.267

就 java 中的整数加法而言，溢出行为由[JLS #15.18.2](http://docs.oracle.com/javase/specs/jls/se7/html/jls-15.html#jls-15.18.2)定义：

> 如果整数加法溢出，则结果是数学和的低位，以一些足够大的二进制补码格式表示。如果发生溢出，则结果的符号与两个操作数值的数学和的符号不同。

# restlet - Restlet Java Framework - 客户端是否需要以某种方式关闭？

> ID：10692912
> 
> 赞同：0
> 
> 时间：2012-05-21T21:30:30.350
> 
> 标签：restlet

我刚刚继承了一些使用 Restlet 框架的代码——必须承认，直到现在我才听说过它。

该模式似乎是这样做的：

```
Request request = new Request(method, uri);
Client client = new Client(protocols);
Response response = client.handle(request); 
```

但是当我调试代码时，我注意到有很多守护线程正在运行。这正常吗？代码是否应该关闭客户端或类似的东西？

谢谢，

保罗

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-22T11:23:41.747

完成后你应该打电话`client.stop()`。

# javascript - 如何在 jquery（移动）中刷新 DIV？

> ID：10692916
> 
> 赞同：11
> 
> 时间：2012-05-21T21:30:49.350
> 
> 标签：javascript, jquery, mobile

更新：对不起，我不小心将该`data-dom-cache="true"`行复制到我的 content-div 中。应用程序从 dom 加载而不是新内容似乎非常合乎逻辑！我已将其更改为`false`，现在它可以完美运行。

## 谢谢。

我有一个动态生成的列表。如果有人单击列表中的条目，用户将被重定向到加载数据的新页面（动态）。加载的数据取决于用户单击的列表条目。

当应用程序第一次加载时，一切正常。但是，当用户单击另一个列表条目时，会显示与第一次运行时相同的数据。

我玩过`.empty()`jQuery 中的函数（清除 div 并附加新数据），但它不起作用。

编辑：

我的 headers.html 文件如下所示：

```
<div id="content>
  <div id="headlineslist">
    <ul data-role="listview" data-theme="c" id="headlineslist">
    </ul>
  </div>
</div>
<script>
  $(document).ready(function() {
    HeadlinesLoad();
  });
</script> 
```

这是Javascript文件：

```
function HeadlinesLoad() {
  $.ajax({
    type: "POST",
    url: "headlines_getter.php",
    dataType: 'json',
    cache: false,
    success: function(data1) {
      $.each(data1, function(i, currentObj) {
        $('ul#headlineslist').append('<li data-role="list-divider" 
class=​"ui-li ui-li-divider ui-bar-b">​' + currentObj.main + '</li>​').listview('refresh');
        $.each(currentObj.sub, function (j, currentSub) {
          $('ul#headlineslist').append('<li>
<a href="headlinesclicked_temp.html" onclick="headlineID(' + currentSub.sid + ')">' + currentSub.name + '</a></li>').listview('refresh');
        });
      });
    }
  });
}

function headlineID(hID) {
  window.localStorage.setItem("headlineID", hID);
}

function onHeadlinesLoad() {
  var hID = window.localStorage.getItem("headlineID");
  window.localStorage.removeItem("headlineID");
  window.localStorage.clear();
  $.ajax({
    url: "headlinesclicked_getter.php?hID=" + hID,
    success: function(html) {
      if(html){
        $("#headlineshome").empty();
        $("#headlineshome").html(html);
      }
    }
  });
} 
```

这是 HTML 文件中应显示数据的片段（并在用户每次新点击时刷新）：

```
<div data-role="content" id="headlineshome"></div>
<script>
  $(document).ready(function() {
    onHeadlinesLoad();
  });
</script> 
```

我不知道为什么它不起作用，所以我请你帮忙。

提前致谢。

最好的问候，约翰。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-21T21:39:07.113

使用 jQuery mobile 更新列表后，请考虑触发“ **create** ”事件，但该事件已过时，因此请使用

```
.page() 
```

在你的名单上是这样的：

```
$('ul#headlineslist').page(); 
```

# ruby - 无法覆盖 ITunesTrack 或 ITunes.h ScriptBridge 中的任何其他类

> ID：10692921
> 
> 赞同：0
> 
> 时间：2012-05-21T21:31:03.607
> 
> 标签：ruby, itunes, macruby

我正在尝试使用 MacRuby 更新我的 iTunes 的“添加日期”设置器。

我创建了 ScriptingBridge 文件，并且可以从库中读取曲目。而且由于 dateAdded 设置器是 R/O，我需要覆盖 ITunesTrack 中的设置器，但是，只需重新打开 ITunesTrack 类，我就会收到此错误

```
11:15:09.964 macruby[4888:903] -[ITunesTrack initWithContext:specifier:]: unrecognized selector sent to instance 0x2006b8ca0
uncaught Objective-C/C++ exception...
2012-05-21 11:15:09.965 macruby[4888:903] *** Terminating app due to uncaught exception 'NSInvalidArgumentException', reason: '-[ITunesTrack initWithContext:specifier:]: unrecognized selector sent to instance 0x2006b8ca0'
*** Call stack at first throw:
(
    0   CoreFoundation                      0x00007fff8280b784 __exceptionPreprocess + 180
    1   libobjc.A.dylib                     0x00007fff87d20f03 objc_exception_throw + 45
    2   CoreFoundation                      0x00007fff82865110 +[NSObject(NSObject) doesNotRecognizeSelector:] + 0
    3   CoreFoundation                      0x00007fff827dd8ef ___forwarding___ + 751
    4   CoreFoundation                      0x00007fff827d9a38 _CF_forwarding_prep_0 + 232
    5   ScriptingBridge                     0x00007fff89afcb3d -[SBObject childWithClass:code:keyForm:keyDesc:] + 143
    6   CoreFoundation                      0x00007fff827b6534 -[NSArray getObjects:range:] + 132
    7   CoreFoundation                      0x00007fff828158fe -[NSArray countByEnumeratingWithState:objects:count:] + 206
    8   libmacruby.dylib                    0x000000010016a128 rb_ary_freeze + 10680
    9   libmacruby.dylib                    0x000000010013e018 rb_vm_dispatch + 8504
    10  libmacruby.dylib                    0x00000001000f3a0f rb_objc_block_call + 191
    11  libmacruby.dylib                    0x0000000100028601 rb_Complex + 5473
    12  libmacruby.dylib                    0x000000010013e161 rb_vm_dispatch + 8833
    13  ???                                 0x0000000103200c84 0x0 + 4347399300
    14  ???                                 0x0000000103200531 0x0 + 4347397425
    15  libmacruby.dylib                    0x0000000100154233 rb_vm_run + 531
    16  libmacruby.dylib                    0x0000000100030ca0 ruby_run_node + 80
    17  macruby                             0x0000000100000cf8 main + 152
    18  macruby                             0x0000000100000c54 start + 52
)
terminate called after throwing an instance of 'NSException'
Abort trap 
```

这是我的代码：

```
#!/usr/local/bin/macruby

    framework 'cocoa'
    framework 'Foundation'
    framework "ScriptingBridge"

    iTunes = SBApplication.applicationWithBundleIdentifier("com.apple.iTunes")
    load_bridge_support_file 'iTunes.bridgesupport'

    old_date = Time.mktime(2001, 01, 01)
    sources = iTunes
      .sources
      .find {|s| 
        s.name == "Library"
      }.playlists
      .find{|p|
        p.name == "Library"
      }.tracks
      .find{|t|
          # dateAdded is of Time class

          if (t.artist.eql?("Bon Iver"))
            t.dateAdded = old_date
            puts "Update #{t.artist} - #{t.album} - #{t.name} "
          end
      } 

    class ITunesTrack
      #def method_missing(m, *args, &block)
      #  puts "Ahoy there!s"
      #  segments = m.to_s.split('_')
      #  missing_meth = segments.map{|part| part.capitalize}.join
      #end

    end 
```

我是否注释掉 method_missing 并不重要，无论我在那个类块中放什么，我都会得到同样的错误。有任何想法吗？

# asp.net - ASP.NET 发布获取重定向浏览器历史记录问题

> ID：10692923
> 
> 赞同：1
> 
> 时间：2012-05-21T21:31:06.913
> 
> 标签：asp.net, redirect, webforms, response.redirect

我正在使用 Post Get Redirect 方法使用 asp.net webforms 提交表单。这是一个非常简单的设置：

```
Step 1) Post form on Page1.aspx
Step 2) Process form and redirect using Response.Redirect to Page2.aspx
Step 3) Page2.aspx redirects using Response.Redirect to Page3.aspx 
```

如果您在 Page3.aspx 上并点击后退按钮，我认为它应该将您带回 Page2.aspx 并将您重定向回 Page3.aspx。这将减少您返回 Page1.aspx 并再次提交数据的机会。

相反，当我点击后退按钮时，我被直接带回 Page1.aspx。我也尝试过使用 303 重定向，但这也不起作用。

这里会发生什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T22:18:58.817

您所看到的行为是正确的做法。

各种浏览器，为了更好地支持某些网站（如谷歌）的操作方式，不会在后台历史记录中保留立即重定向的页面。

考虑一下：

1.  你搜索 google.com
2.  你点击一个链接
3.  该链接实际上将您带回 google.coms 服务器，然后立即将您转发到实际页面。

4.  您认为这不是正确的链接，然后单击后退按钮。

此时，大多数浏览器会将您带回到第 2 步中标识的页面。这是数百万网民通常希望和预期的行为。

回到第 3 步只是被转发到第 4 步，这会惹恼一些人。正如某些版本的 IE 最近所做的那样，直到该行为被修补。

关键是，您所看到的行为正是网络其余部分的工作方式。如果您真的想要，您应该研究一些其他机制来改变这一点。

**更新**

* * *

@NinjaBomb：不知何故，我错过了您的后续问题，因此以下内容可能没有多大用处。

答案是，不是在 c# 代码中进行重定向，而是在 Page2 中嵌入一些 javascript，当页面加载完成时进行重定向。然后浏览器“存储”对第 2 页的引用。当他们从 3 单击返回按钮时，它将返回到 2，然后重定向到 3。

当然，用户可以简单地按两次后退按钮...中断 2 的重定向并让他们转到 1。我能想到的唯一其他方法是让页面 1 在加载时测试一些会话或 cookie 值以查看如果他们已经被发送。如果是这样，那么第 1 页应该进行重定向而不是显示自己。

# c# - 移植到 windows7 后调试模式 (VS2010) 出现 BadImageFormat 错误

> ID：10692924
> 
> 赞同：2
> 
> 时间：2012-05-21T21:31:20.840
> 
> 标签：c#

我有一个在 Windows XP 中运行良好的应用程序。我可以调试、发布等。它在 Windows 7 中也可以正常工作，但只有发布模式。如果我尝试调试，我会收到 BadImageformat 错误。该程序调用一个DLL，这就是它爆炸的地方。它抱怨调用非托管程序集，但我不确定如何（或为什么）需要更改此 DLL。

我有 DLL 的源代码，所以我可以在必要时更改它。

谢谢你的帮助！——格雷格

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T21:38:14.283

您是运行相同的平台还是 XP 中的 x86 和 Windows 7 中的 x64，反之亦然？检查它是否为 32 位和 64 位正确构建，它尝试加载的运行时库也是适当的 32 位或 64 位 dll

# javascript - 如果您无法控制第二原产地，是否可以规避同一原产地政策？

> ID：10692934
> 
> 赞同：1
> 
> 时间：2012-05-21T21:31:51.963
> 
> 标签：javascript

这篇[SO 帖子](https://stackoverflow.com/questions/3076414/ways-to-circumvent-the-same-origin-policy)列出了许多规避这种策略的方法。

但是，我不知道这些是否适用于您无法访问第二个来源的情况。

特别是这个，第三个答案，您插入一个脚本，该脚本从第二个来源调用脚本。

```
<script src="http://..../someData.js?callback=some_func"/> 
```

但一般来说，当您在原点一时，这些方法中的任何一种都允许规避……并且需要访问原点二吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-21T21:35:49.560

是的，你*可以*在不控制第二台服务器的情况下绕过同源策略，但如果没有第二台服务器所有者的合作，你就无法做到。通常，就像在您的示例中一样，这是通过与 JSONP 约定合作来完成的。如果不通过第一个服务器将请求代理到第二个服务器，则没有其他方法可以做到这一点。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-21T21:33:21.343

显然这是不可能的，否则该政策将毫无用处。这完全是为了防止您从第三台主机中提取数据，这正是您想要做的。

请注意，浏览器不知道什么是“私有”本地网络的一部分，什么是“公共”全球互联网的一部分。因此，此策略的存在是为了防止任意 Javascript 代码访问本地网络上的资源。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-21T21:34:00.750

不，这就是重点。只有当服务器明确允许通过 CORS 或 JSONP 之类的东西时，才能关闭 SOP。

插入小脚本是一种攻击（无论您的意图是否良好）。如果我拥有一个域并且有人这样做，他们将被禁止并向当局报告。

您最接近的方法是使用服务器端代理（即让您的 js 向您的服务器发出请求，而服务器又向第三方发出请求）。

# php - 去除前缀 /en/

> ID：10692936
> 
> 赞同：0
> 
> 时间：2012-05-21T21:32:10.747
> 
> 标签：php, javascript, jquery, wordpress, .htaccess

有没有一种方法可以`/en/`从我插入到翻译页面的页面中的链接中删除？

这就是我为图像所做的：

```
RewriteRule ^en/wp-content/uploads/(.*)\.jpg wp-content/uploads/$1.jpg 
```

这就是我为`jpg`s 加载到一种语言并查看另一个语言页面所做的事情。

使用相同类型的链接怎么样，可能使用 jquery 或 php 替换 html 中使用 /en/ 输出的任何链接？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-21T21:35:07.080

这是你想要的吗？

```
RewriteRule ^(..)/wp-content/uploads/(.*)\.jpg wp-content/uploads/$2.jpg
RewriteRule ^(..)/wp-content/uploads/(.*)\.jpeg wp-content/uploads/$2.jpeg 
```

`(..)`匹配两个字符序列，但`(.*)`没有长度限制

# c# - c# 条件正则表达式字符串匹配

> ID：10692939
> 
> 赞同：0
> 
> 时间：2012-05-21T21:32:23.573
> 
> 标签：c#, regex

我正在尝试使用 c# 正则表达式来匹配特定的字符串，但我不知道该怎么做。任何帮助表示赞赏。

我要匹配的字符串如下，其中 A 是大写字母字符，X 是大写字母数字字符，# 是 0、1 或 2。

`AA-#-XX-X-XXX-XXXXXXX-XXXXXXXX`

因此，以下任何一项都将与上面的字符串匹配。

`XY-1`

`MM-0-AB`

`MM-0-AB-1-ABC-1234567`

`VV-2-XX-7-CCC-ABCDEFG-12345678`

以下任何一项都不匹配。

`QQ-7-AA`（第二级只允许 0、1、2。）

`QQ-2-XX-7-CC`（该级别的部分字符。）

`QQ-2-XX-7-CCC-ABCDEFG-`（不能以破折号结束。）

`QQ-2-XX-7-CCC-ABCDEFG-123456`（该级别的部分字符。）

到目前为止（实际上还没有那么远）我有匹配的模式`@"^[A-Z]{2}"`，但我不确定如何有条件地匹配（我什至不确定是否有条件地是正确使用的术语）字符串的其余部分，但前提是它有没有。我需要为此写 7 个不同的语句吗？似乎不合理，但我可能是错的。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-21T21:47:51.633

看看[正则表达式语言](http://msdn.microsoft.com/en-us/library/az24scfc.aspx)。您需要以下元素：

*   大写字母字符：`[A-Z]`
*   大写字母数字字符：`[A-Z0-9]`
*   0、1 或 2：`[0-2]`
*   短跑：`-`

*   匹配*x*精确*n*次：`x{n}`

*   匹配*x*零次或一次：`x?`
*   定义一个子表达式：`(`...`)`

*例子：*

*   两个大写字母字符：`[A-Z]{2}`
*   两个大写字母字符，后跟一个破折号：`[A-Z]{2}-`
*   两个大写字母字符，后跟一个破折号，然后是 0、1 或 2：`[A-Z]{2}-[0-2]`
*   两个大写字母字符，后跟一个破折号，然后是 0、1 或 2，但子表达式由破折号和 0、1 或 2 组成，出现 0 次或 1 次：
    `[A-Z]{2}(-[0-2])?`
*   等等...

*结果表达式：*

```
^[A-Z]{2}(-[0-2](-[A-Z0-9]{2}(-[A-Z0-9](-[A-Z0-9]{3}(-[A-Z0-9]{7}(-[A-Z0-9]{8})?)?)?)?)?)?$ 
```

# .net - 如何使用反射在 VB.NET 模块中设置字段值？

> ID：10692944
> 
> 赞同：5
> 
> 时间：2012-05-21T21:33:11.277
> 
> 标签：.net, vb.net

如何使用反射在 VB.NET 模块中设置字段值？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-21T22:00:29.153

我认为它应该与 C# 代码非常相似

```
objectwithfield.GetType().GetField("field").SetValue(objectwithfield, newValue) 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-25T19:05:31.807

@user287107 很接近，但这是有效的：

```
 Dim ass As Assembly = Assembly.Load("AssemblyNameWhereModuleResides")
    Dim moduleType as Type = ass.GetType("MyNameSpaceIfApplicable.MyModuleName")
    moduleType.GetField("field").SetValue(Nothing, newValue) 
```

# iphone - OHAttributedLabel 和 UITableView

> ID：10692945
> 
> 赞同：2
> 
> 时间：2012-05-21T21:33:11.947
> 
> 标签：iphone, uitableview, hyperlink, nsattributedstring

我正在使用 OHAttributedLabel 在我的 UITableViewCell 中创建一个文本链接。但是，当我点击此链接时，我很难通过点击，似乎我必须握住手指更长的时间才能让 OHAttributedLabel 意识到我想点击链接。

我在 UITableViews 之外没有这个问题，一切正常。奇怪的是，同样的错误也发生在 tableViewFooter 和 header 中。我为标签设置了 userInteractionEnabled = YES，为单元格设置了 NO。我在这里做错了什么？

# asp.net-mvc - 当 MVC 的模型与数据库模型不匹配时，我应该如何构造我的代码？

> ID：10692946
> 
> 赞同：1
> 
> 时间：2012-05-21T21:33:16.227
> 
> 标签：asp.net-mvc, model-view-controller, design-patterns

我是 ASP.Net MVC 的新手，我有一个问题，我似乎无法在 Google 上找到答案。

我有一个页面需要一个模型，该模型与数据在数据库中的存储方式有很大不同。`MyModel ConvertToMvcModel(DataFromDatabase d`编写一个从数据库模型转换为所需 MVC 模型 ( )的函数对我来说是微不足道的。

我的问题，我应该把这段代码放在哪里？它应该在控制器中。是否应该在数据访问层（使用存储库模式）。

另一个相关的问题是我应该把存储库类放在哪里？到目前为止，我已经将存储库类与模型类放在同一个 .cs 文件中，因为每个模型都有相应的存储库。这次模型将与我从存储库中获得的不同，因此将它放在同一个文件中没有多大意义。也许我应该将我所有的 DAL（存储库）与模型代码分开。

有什么建议么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T21:39:24.383

> 我的问题，我应该把这段代码放在哪里？

理想情况下，域模型和视图模型之间的映射应放置在单独的专用映射层内。例如，如果您使用我推荐的[AutoMapper](http://automapper.org/)，您可以将映射定义放在称为配置文件的单独文件中，并在控制器操作中简单地调用该`Mapper.Map<TSource, TDest>`方法。

> 另一个相关的问题是我应该把存储库类放在哪里？到目前为止，我已经将存储库类与模型类放在同一个 .cs 文件中，因为每个模型都有相应的存储库。

DAL 代表数据访问层，是存储库应该去的地方。您可以定义存储库必须遵守（实施）的通用合同（接口），然后针对您正在使用的不同数据源进行多个实施。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-21T21:39:40.367

无论如何，您不应该返回实体，为此目的使用 ViewModels。

关于映射：您正在寻找的东西已经存在，它被称为[AutoMapper](https://github.com/AutoMapper/AutoMapper)。您可以让服务层将实体返回给您的控制器，控制器会将它们映射到 ViewModel 对象。

请记住只初始化一次映射，因此从您的应用程序开始启动它们。

# java - JRuby 类和 Java 脚本引擎的意外结果

> ID：10692951
> 
> 赞同：1
> 
> 时间：2012-05-21T21:33:35.230
> 
> 标签：java, ruby, jruby, jsr223

我正在试验 Java 脚本引擎和 Ruby，但在 ruby​​ 脚本中设置一些实例变量时遇到了麻烦。这可能是我对 Ruby 缺乏了解，或者我对如何在脚本引擎中使用 ruby​​ 类缺乏了解。使用以下代码：

```
public class App {

    public static void main( String[] args ) throws Exception{
        ScriptEngineManager sm = new ScriptEngineManager();
        ScriptEngine se = sm.getEngineByName("jruby");

        StringBuilder sb = new StringBuilder();
        sb.append("class Test\n");
        sb.append("   attr_accessor :a, :b\n");
        sb.append("   def str\n");
        sb.append("      \"#{a}, #{b} is a test.\"\n");
        sb.append("   end\n");
        sb.append("end\n");
        sb.append("o = Test.new\n");

        Object o = se.eval(sb.toString());  

        se.put("@a", "A");
        se.put("@b", "B");

        System.out.println( ((Invocable) se).invokeMethod(o, "str"));
    }
} 
```

我希望输出是'A，B是一个测试'

相反，输出是“，是一个测试”。

我应该如何在这段代码中设置变量 a、b？

编辑：为了清楚起见，理想情况下，我不想通过将变量附加到这个 StringBuilder 来设置它们——这只是为了说明。在实践中，我将从某个源加载脚本，然后想在该 Ruby 对象上设置属性和调用方法。我确定我只是错过了其他人都知道的一些关键步骤:)。感谢 Gareth Davis 的回答，我发现我可以成功使用绑定和全局变量，但这不适用于所有脚本。非常感谢任何超越“hello world”类型用法的好文章的链接，因为我没有找到任何像样的文章。

第二次编辑：这是工作的最终代码，我知道必须缺少关键行:)-

```
public class App {

    public static void main( String[] args ) throws Exception{

        //Must set this property if you want to call eval multiple times!
        System.setProperty("org.jruby.embed.localvariable.behavior", "persistent");
        ScriptEngineManager sm = new ScriptEngineManager();
        ScriptEngine se = sm.getEngineByName("jruby");

        StringBuilder sb = new StringBuilder();
        sb.append("class Test\n");
        sb.append("   attr_accessor :a, :b\n");
        sb.append("   def str\n");
        sb.append("      \"#{a}, #{b} is a test.\"\n");
        sb.append("   end\n");
        sb.append("end\n");
        sb.append("o = Test.new\n");

        Object o = se.eval(sb.toString());

        se.eval("o.a = \"A\"");
        se.eval("o.b = \"B\"");

        System.out.println( ((Invocable) se).invokeMethod(o, "str"));
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T21:50:32.363

那不会那样工作的。设置 a 和 b 值的唯一方法是计算`o.a = 'A'`和`o.b = 'B'`。

第一个解决方案是修改脚本以填充这些值：

```
 sb.append("o.a = 'A'\n");
    sb.append("o.b = 'B'\n");
    sb.append("o");
    Object o = se.eval(sb.toString()); 
```

[我在 github.com 上创建了一个工作示例](https://gist.github.com/2767504)

与问题保持一致，可以使用以下内容（归功于@Mick Sear）：

```
System.setProperty("org.jruby.embed.localvariable.behavior", "persistent"); 

// .. snip

Object o = se.eval(sb.toString());

se.eval("o.a = 'A'");
se.eval("o.b = 'B'");

System.out.println( ((Invocable) se).invokeMethod(o, "str")); 
```

# ruby - 更好的红宝石 - 可能不重复功能的一部分？

> ID：10692955
> 
> 赞同：2
> 
> 时间：2012-05-21T21:33:49.577
> 
> 标签：ruby, functional-programming, refactoring, sinatra

我有一个小sinatra api，我正在尝试美化。我的大部分路由都是简单的数据库操作，但有一些涉及在执行数据库操作之前调用外部服务。在所有情况下，除了我如何响应服务响应之外，大部分代码都是相同的。是否有任何巧妙的函数式编程方法？

以下是这些路线之一的示例：

```
 get '/update_x' do
    validateParams(params,:x)
    xid = params[:x]
    xName = getNameFromId(xid)

    if xName
      # Make request to proxy service
      rid = generateRandomHexNumber(16) # generate requestId
      params['m'] = 'set'
      params['rid'] = rid

      json = "{}"      
      begin
        response = @resource["/"+"?rid=#{rid}&id=#{xid}&json=#{json}"].get
        status = response.code
        body = response.body

        parsed_json = JSON(body)
        if parsed_json['response'] and parsed_json['response']['success'] and parsed_json['response']['success']=='false'
          msg = {:success => "false", :response => "unknown error"}
          if parsed_json['response']['response']
            msg = {:success => "false", :response => parsed_json['response']['response']}
          end
          content_type :json
          msg.to_json
        else

         #### Here is stuff specific to this api call

          updateDBHelper(xid,buildUpdateOptions(params))

          params['ss_status'] = status
          content_type :json
          params.to_json

          #### End specific to api call
        end 
      rescue Exception=>e
        params['ss_status'] = status
        params['exception'] = e
        content_type :json
        params.to_json
      end
    else
      msg = {:success => "false", :response => "Not found"}
      content_type :json
      msg.to_json
    end
  end 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-21T23:25:07.933

一般来说，如果您有一个带有一些每次更改的任意代码的通用模式，那么最简单的事情就是接受具有这些自定义的块。

```
def make_api_request(some, params)
  # do what you need to do
  yield(variables, that, your_custom_code, needs)
  # do some more, maybe cleanup
end

get '/some_route' do
  make_api_request do |variables, that, your_custom_code, needs|
    # do custom stuff here
  end
end 
```

# sockets - 绑定多播 (UDP) 套接字是什么意思？

> ID：10692956
> 
> 赞同：79
> 
> 时间：2012-05-21T21:33:52.407
> 
> 标签：sockets, udp, bind, boost-asio, multicast

我在具有多个网络接口的主机之间使用多播 UDP。我正在使用 boost::asio，并且对接收器必须进行的 2 个操作感到困惑：绑定，然后加入组。

为什么在绑定过程中需要指定接口的本地地址，当您对加入的每个多播组执行此操作时？

姐妹问题关于多播端口：由于在发送期间，您发送到多播地址和端口，为什么在订阅多播组期间，您只指定地址，而不是端口 - 在混淆调用中指定的端口绑定。

注意：“join-group”是一个 wrapper `setsockopt(IP_ADD_MEMBERSHIP)`，如文档所述，可以在同一个套接字上多次调用以订阅不同的组（通过不同的网络？）。因此，每次订阅组时放弃绑定调用并指定端口是非常有意义的。

在我看来，总是绑定到“0.0.0.0”并在加入组时指定接口地址，效果很好。使困惑。

* * *

## 回答 #1

> 赞同：67
> 
> 时间：2012-05-24T14:25:24.560

在接收多播时绑定 UDP 套接字意味着指定从其接收数据的地址和端口（不是本地接口，如 TCP 接受器绑定的情况）。在这种情况下指定的地址具有**过滤**作用，即套接字将只接收发送到该多播地址和端口的数据报，无论该套接字随后加入了哪些组。这解释了为什么当绑定到 INADDR_ANY (0.0.0.0) 时我收到发送到我的多播组的数据报，而当绑定到任何本地接口时我没有收到任何内容，即使数据报是在该接口的网络上发送的对应。

引用自 UNIX® 网络编程第 1 卷，第三版：WR Stevens 的套接字网络 API。21.10。发送和接收

> [...] 我们希望接收套接字绑定多播组和端口，例如 239.255.1.2 端口 8888。（回想一下，我们可以只绑定通配符 IP 地址和端口 8888，但绑定多播地址会阻止套接字接收任何其他可能到达端口 8888 的数据报。）然后我们希望接收套接字加入多播组。发送套接字会将数据报发送到相同的多播地址和端口，例如 239.255.1.2 端口 8888。

* * *

## 回答 #2

> 赞同：57
> 
> 时间：2012-05-22T04:00:10.563

“绑定”操作基本上是说，“使用此本地 UDP 端口发送和接收数据。换句话说，它分配该 UDP 端口供您的应用程序独占使用。（对于 TCP 套接字也是如此）。

当您绑定到“0.0.0.0” ( [`INADDR_ANY`](https://stackoverflow.com/q/16508685/3924118)) 时，您基本上是在告诉 TCP/IP 层使用所有可用的适配器进行侦听并选择最佳适配器进行发送。这是大多数套接字代码的标准做法。唯一不会为 IP 地址指定 0 的情况是当您想在特定网络适配器上发送/接收时。

同样，如果您在绑定期间指定端口值为 0，则操作系统将为该套接字分配一个随机可用的端口号。所以我希望对于 UDP 多播，您绑定到特定端口号上的 INADDR_ANY，预计多播流量将发送到该端口号。

“加入多播组”操作 ( `IP_ADD_MEMBERSHIP`) 是必需的，因为它基本上告诉您的网络适配器不仅要侦听目标 MAC 地址是您自己的以太网帧，它还告诉以太网适配器 ( [NIC](https://en.wikipedia.org/wiki/Network_interface_controller) ) 侦听 IP 多播流量以及相应的多播以太网地址。每个多播 IP 映射到一个多播以太网地址。当您使用套接字发送到特定的多播 IP 时，以太网帧上的目标 MAC 地址设置为多播 IP 的相应多播 MAC 地址。当您加入多播组时，您将 NIC 配置为侦听发送到同一 MAC 地址的流量（除了它自己的）。

如果没有硬件支持，多播不会比普通广播 IP 消息更有效。加入操作还告诉您的路由器/网关转发来自其他网络的多播流量。（有人记得MBONE吗？）

如果加入多播组，该 IP 地址上所有端口的所有多播流量都将被 NIC 接收。只有发往您的绑定侦听端口的流量才会通过 TCP/IP 堆栈传递到您的应用程序。关于为什么在多播订阅期间指定端口 - 这是因为多播 IP 就是这样 - 仅限 IP。“端口”是上层协议（UDP 和 TCP）的属性。

您可以阅读有关多播 IP 地址如何映射到各个站点的多播以太网地址的更多信息。 [维基百科的文章差不多](http://en.wikipedia.org/wiki/IP_multicast#Layer_2_delivery)是这样：

> IANA 拥有 OUI MAC 地址 01:00:5e，因此组播数据包使用以太网 MAC 地址范围 01:00:5e:00:00:00 - 01:00:5e:7f:ff:ff 传送。这是 23 位的可用地址空间。第一个八位字节 (01) 包括广播/多播位。28 位多播 IP 地址的低 23 位映射到可用以太网地址空间的 23 位。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2013-01-30T20:57:10.630

更正[绑定多播 (udp) 套接字是什么意思？](https://stackoverflow.com/a/10695561/1964969)只要它在以下引用中部分正确：

> *“绑定”操作基本上是说，“使用这个本地 UDP 端口发送和接收数据。换句话说，它分配那个 UDP 端口供您的应用程序**独占**使用*

有一个例外。如果应用该选项，多个应用程序**可以**共享同一个端口进行侦听（通常它对多播数据报具有实用价值） 。`SO_REUSEADDR`例如

```
int sock = socket(AF_INET, SOCK_DGRAM, IPPROTO_UDP); // create UDP socket somehow
...
int set_option_on = 1;
// it is important to do "reuse address" before bind, not after
int res = setsockopt(sock, SOL_SOCKET, SO_REUSEADDR, (char*) &set_option_on, 
    sizeof(set_option_on));
res = bind(sock, src_addr, len); 
```

如果多个进程进行了这种“重用绑定”，那么在该共享端口上接收到的每个 UDP 数据报都将被传递给每个进程（提供与多播流量的自然连接）。

以下是有关在某些情况下发生的情况的更多详细信息：

1.  任何绑定（“独占”或“重用”）到释放端口的尝试都将成功

2.  如果端口已经“重用绑定”，则尝试“独占绑定”将失败

3.  如果某些进程保持“独占绑定”，则尝试“重用绑定”将失败

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2015-04-08T23:08:40.807

区分 SENDING 多播套接字和 RECEIVING 多播套接字也很重要。

我同意上面关于接收多播套接字的所有答案。OP 指出将 RECEIVING 套接字绑定到接口没有帮助。但是，必须将多播 SENDING 套接字绑定到接口。

对于多宿主服务器上的 SENDING 多播套接字，为要发送到的每个接口创建一个单独的套接字*非常重要。*应该为每个接口创建一个绑定的 SENDING 套接字。

```
 // This is a fix for that bug that causes Servers to pop offline/online.
  // Servers will intermittently pop offline/online for 10 seconds or so.
  // The bug only happens if the machine had a DHCP gateway, and the gateway is no longer accessible.
  // After several minutes, the route to the DHCP gateway may timeout, at which
  // point the pingponging stops.
  // You need 3 machines, Client machine, server A, and server B
  // Client has both ethernets connected, and both ethernets receiving CITP pings (machine A pinging to en0, machine B pinging to en1)
  // Now turn off the ping from machine B (en1), but leave the network connected.
  // You will notice that the machine transmitting on the interface with
  // the DHCP gateway will fail sendto() with errno 'No route to host'
  if ( theErr == 0 )
  {
     // inspired by 'ping -b' option in man page:      
     //      -b boundif
     //             Bind the socket to interface boundif for sending.
     struct sockaddr_in bindInterfaceAddr;
     bzero(&bindInterfaceAddr, sizeof(bindInterfaceAddr));
     bindInterfaceAddr.sin_len = sizeof(bindInterfaceAddr);
     bindInterfaceAddr.sin_family = AF_INET;
     bindInterfaceAddr.sin_addr.s_addr = htonl(interfaceipaddr);
     bindInterfaceAddr.sin_port = 0; // Allow the kernel to choose a random port number by passing in 0 for the port.
     theErr = bind(mSendSocketID, (struct sockaddr *)&bindInterfaceAddr, sizeof(bindInterfaceAddr));
     struct sockaddr_in serverAddress;
     int namelen = sizeof(serverAddress);  
     if (getsockname(mSendSocketID, (struct sockaddr *)&serverAddress, (socklen_t *)&namelen) < 0) {
        DLogErr(@"ERROR Publishing service... getsockname err");
     }
     else
     {
        DLog( @"socket %d bind, %@ port %d", mSendSocketID, [NSString stringFromIPAddress:htonl(serverAddress.sin_addr.s_addr)], htons(serverAddress.sin_port) );
     } 
```

如果没有此修复，多播发送将间歇性地得到 sendto() errno 'No route to host'。如果有人能解释为什么拔掉 DHCP 网关会导致 Mac OS X 多播发送套接字混淆，我很想听听。

# ruby - 从 Ruby 中的模块/mixins 继承类方法

> ID：10692961
> 
> 赞同：104
> 
> 时间：2012-05-21T21:34:11.450
> 
> 标签：ruby, mixins

众所周知，在 Ruby 中，类方法会被继承：

```
class P
  def self.mm; puts 'abc' end
end
class Q < P; end
Q.mm # works 
```

然而，令我惊讶的是它不适用于 mixins：

```
module M
  def self.mm; puts 'mixin' end
end
class N; include M end
M.mm # works
N.mm # does not work! 
```

我知道#extend 方法可以做到这一点：

```
module X; def mm; puts 'extender' end end
Y = Class.new.extend X
X.mm # works 
```

但是我正在编写一个包含实例方法和类方法的mixin（或者更确切地说，想要编写）：

```
module Common
  def self.class_method; puts "class method here" end
  def instance_method; puts "instance method here" end
end 
```

现在我想做的是：

```
class A; include Common
  # custom part for A
end
class B; include Common
  # custom part for B
end 
```

我希望 A，B 从`Common`模块继承实例和类方法。但是，当然，这是行不通的。那么，难道没有一种秘密的方法可以让这种继承从单个模块中工作吗？

将它分成两个不同的模块，一个用于包含，另一个用于扩展，对我来说似乎是不雅的。另一种可能的解决方案是使用类`Common`而不是模块。但这只是一种解决方法。（如果有两组通用功能`Common1`，`Common2`而我们真的需要 mixins 怎么办？）类方法继承不能从 mixins 工作有什么深层次的原因吗？

* * *

## 回答 #1

> 赞同：177
> 
> 时间：2012-05-21T21:38:26.283

一个常见的习惯用法是使用`included`钩子并从那里注入类方法。

```
module Foo
  def self.included base
    base.send :include, InstanceMethods
    base.extend ClassMethods
  end

  module InstanceMethods
    def bar1
      'bar1'
    end
  end

  module ClassMethods
    def bar2
      'bar2'
    end
  end
end

class Test
  include Foo
end

Test.new.bar1 # => "bar1"
Test.bar2 # => "bar2" 
```

* * *

## 回答 #2

> 赞同：62
> 
> 时间：2017-07-16T10:10:37.860

这是完整的故事，解释了理解为什么模块包含在 Ruby 中的工作方式所需的元编程概念。

## 包含模块时会发生什么？

将模块包含到类中会将模块添加到类的*祖先*中。`ancestors`您可以通过调用其方法查看任何类或模块的祖先：

```
module M
  def foo; "foo"; end
end

class C
  include M

  def bar; "bar"; end
end

C.ancestors
#=> [C, M, Object, Kernel, BasicObject]
#       ^ look, it's right here! 
```

当您在 的实例上调用方法时`C`，Ruby 将查看此祖先列表的每个项目，以便找到具有提供名称的**实例方法。**由于我们包含`M`在`C`中，`M`现在是 的祖先`C`，所以当我们调用`foo`的实例时`C`，Ruby 会在 中找到该方法`M`：

```
C.new.foo
#=> "foo" 
```

请注意，**包含不会将任何实例或类方法复制到类**- 它只是向类添加一个“注释”，它还应该在包含的模块中查找实例方法。

## 我们模块中的“类”方法呢？

因为包含只改变了实例方法的分派方式，所以将一个模块包含到一个类**中只会使其实例方法**在该类上可用。模块中的“类”方法和其他声明不会自动复制到类中：

```
module M
  def instance_method
    "foo"
  end

  def self.class_method
    "bar"
  end
end

class C
  include M
end

M.class_method
#=> "bar"

C.new.instance_method
#=> "foo"

C.class_method
#=> NoMethodError: undefined method `class_method' for C:Class 
```

## Ruby 如何实现类方法？

在 Ruby 中，类和模块是普通对象——它们是类`Class`和`Module`. 这意味着您可以动态创建新类，将它们分配给变量等：

```
klass = Class.new do
  def foo
    "foo"
  end
end
#=> #<Class:0x2b613d0>

klass.new.foo
#=> "foo" 
```

同样在 Ruby 中，您可以在对象上定义所谓的**单例方法**。这些方法作为新的实例方法添加到对象的特殊隐藏**单例类**中：

```
obj = Object.new

# define singleton method
def obj.foo
  "foo"
end

# here is our singleton method, on the singleton class of `obj`:
obj.singleton_class.instance_methods(false)
#=> [:foo] 
```

但是类和模块不也只是普通的对象吗？事实上他们是！这是否意味着他们也可以有单例方法？是的，它确实！这就是类方法的诞生方式：

```
class Abc
end

# define singleton method
def Abc.foo
  "foo"
end

Abc.singleton_class.instance_methods(false)
#=> [:foo] 
```

或者，更常见的定义类方法的方法是`self`在类定义块中使用，它指的是正在创建的类对象：

```
class Abc
  def self.foo
    "foo"
  end
end

Abc.singleton_class.instance_methods(false)
#=> [:foo] 
```

## 如何在模块中包含类方法？

正如我们刚刚建立的，类方法实际上只是类对象的单例类上的实例方法。这是否意味着我们可以只**在单例类中包含一个模块**来添加一堆类方法？是的，它确实！

```
module M
  def new_instance_method; "hi"; end

  module ClassMethods
    def new_class_method; "hello"; end
  end
end

class HostKlass
  include M
  self.singleton_class.include M::ClassMethods
end

HostKlass.new_class_method
#=> "hello" 
```

这一`self.singleton_class.include M::ClassMethods`行看起来不太好，所以 Ruby 添加了[**`Object#extend`**](https://ruby-doc.org/core-2.4.1/Object.html#method-i-extend)，它的作用相同——即在对象的单例类中包含一个模块：

```
class HostKlass
  include M
  extend M::ClassMethods
end

HostKlass.singleton_class.included_modules
#=> [M::ClassMethods, Kernel]
#    ^ there it is! 
```

## 将`extend`呼叫移动到模块中

前面的示例不是结构良好的代码，原因有两个：

1.  我们现在必须在定义中调用和调用*以* 正确包含我们的模块。如果您必须包含许多类似的模块，这可能会变得非常麻烦。`include``extend``HostClass`
2.  `HostClass`直接引用`M::ClassMethods`，这是模块的一个*实现细节*`M`，`HostClass`不需要知道或关心。

那么这个怎么样：当我们`include`在第一行调用时，我们以某种方式通知模块它已被包含，并且还给它我们的类对象，以便它可以调用`extend`自己。这样，如果需要，添加类方法是模块的工作。

这正是**特殊`self.included`方法**的用途。每当模块包含在另一个类（或模块）中时，Ruby 会自动调用此方法，并将宿主类对象作为第一个参数传入：

```
module M
  def new_instance_method; "hi"; end

  def self.included(base)  # `base` is `HostClass` in our case
    base.extend ClassMethods
  end

  module ClassMethods
    def new_class_method; "hello"; end
  end
end

class HostKlass
  include M

  def self.existing_class_method; "cool"; end
end

HostKlass.singleton_class.included_modules
#=> [M::ClassMethods, Kernel]
#    ^ still there! 
```

当然，添加类方法并不是我们在`self.included`. 我们有类对象，所以我们可以在它上面调用任何其他（类）方法：

```
def self.included(base)  # `base` is `HostClass` in our case
  base.existing_class_method
  #=> "cool"
end 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2017-06-23T03:36:12.937

正如 Sergio 在评论中提到的那样，对于已经在 Rails 中的人（或者不介意依赖[Active Support](https://rubygems.org/gems/activesupport/)），[`Concern`](http://api.rubyonrails.org/v5.1/classes/ActiveSupport/Concern.html)在这里很有帮助：

```
require 'active_support/concern'

module Common
  extend ActiveSupport::Concern

  def instance_method
    puts "instance method here"
  end

  class_methods do
    def class_method
      puts "class method here"
    end
  end
end

class A
  include Common
end 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2017-12-12T19:06:16.533

您可以通过以下操作获得蛋糕并吃掉它：

```
module M
  def self.included(base)
    base.class_eval do # do anything you would do at class level
      def self.doit #class method
        @@fred = "Flintstone"
        "class method doit called"
      end # class method define
      def doit(str) #instance method
        @@common_var = "all instances"
        @instance_var = str
        "instance method doit called"
      end
      def get_them
        [@@common_var,@instance_var,@@fred]
      end
    end # class_eval
  end # included
end # module

class F; end
F.include M

F.doit  # >> "class method doit called"
a = F.new
b = F.new
a.doit("Yo") # "instance method doit called"
b.doit("Ho") # "instance method doit called"
a.get_them # >> ["all instances", "Yo", "Flintstone"]
b.get_them # >> ["all instances", "Ho", "Flintstone"] 
```

如果你打算添加实例和类变量，你最终会拔掉你的头发，因为你会遇到一堆损坏的代码，除非你这样做。

# java - Actionlistener 不允许我访问数组

> ID：10692962
> 
> 赞同：1
> 
> 时间：2012-05-21T21:34:23.197
> 
> 标签：java, swing, actionlistener

我有一个填充数据的 2d dbl 数组，我可以在代码中的任何位置调用它：

```
System.out.println(twodarray[0][0]); 
```

它工作得很好。当我将它作为 Actionlistener 的一部分调用时，它不起作用，并且我得到一个空指针异常。

我的事件监听器代码：

```
public void actionPerformed(ActionEvent e)      
 {
     if (e.getSource() == firstbutton)
     {

         System.out.println(twodarray[0][0]);

     }

 } 
```

我不知道从哪里开始解决这个问题。该数组存在有效数据，如我的代码中 println 的其他任何地方所示。我在哪里错了？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-21T21:36:51.187

您可以访问数组；那不是问题。问题是调用动作侦听器时数组变量为空。确保您没有在构造函数或方法中隐藏数组变量。有关更详细的答案，请提供有关您的问题和代码的更多详细信息。

换句话说，您是在初始化*类数组变量*，还是仅初始化方法或构造函数本地的数组变量？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-21T21:39:59.747

您还需要记住，侦听器正在 UI 线程上运行。确保您没有在其他地方填充二维数组。

# r - 循环遍历日期向量似乎会改变它们的类型 - 如何修复？

> ID：10692966
> 
> 赞同：2
> 
> 时间：2012-05-21T21:34:47.393
> 
> 标签：r, datetime, for-loop

> **可能重复：**
> [R - 为什么循环一个 Date 对象会导致一个数字迭代器？](https://stackoverflow.com/questions/6434663/r-why-does-looping-over-a-date-object-result-in-a-numeric-iterator)

我有以下 R 代码，它产生一定范围内的日期向量：

```
library(lubridate)
start_date = ymd("2009-07-25")
end_date = ymd("2010-11-30")
dates <- seq(from=start_date, to=end_date, by="1 day") 
```

如果我查看日期向量的结构，我会得到以下信息：

```
> str(dates)
POSIXct[1:494], format: "2009-07-25" "2009-07-26" "2009-07-27" "2009-07-28" "2009-07-29"... 
```

如果我查看向量元素的结构，我会得到：

```
> str(dates[5])
 POSIXct[1:1], format: "2009-07-29" 
```

到目前为止我所期望的一切。但是，如果我对这些日期进行 for 循环并查看我得到的结构：

```
> for (d in dates) {str(d)}
 num 1.25e+09
 num 1.25e+09
 num 1.25e+09
 num 1.25e+09 
```

他们都变成了数字！我有两个问题：

1.  为什么会这样？是我做错了什么，还是 R 功能？

2.  我怎样才能阻止这种情况发生，所以我在我的 for 循环中得到了一个 POSIXct 实例

# css - 如何将样式异常添加到无序列表中的第 3 项

> ID：10692967
> 
> 赞同：1
> 
> 时间：2012-05-21T21:34:52.760
> 
> 标签：css, styles, html-lists

我有一个导航区域，其中包含使用无序列表创建的按钮。我试图使单击的按钮在出现在链接页面上时具有与列表其余部分不同的样式属性。但是，添加不同的“样式”或“id”在应用于列表项时似乎不起作用。我怎样才能挑出一个项目并将其样式与列表的其余部分不同？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-21T21:42:05.280

如果您想定位`li`无序列表 ( `ul`) 中第三个以外的元素，您可以使用类似：

```
ul li:not(:nth-child(3)​) {
    /*Your CSS*/
} 
```

当然，您可以使用以下方式定位该特定元素：

```
ul li:nth-child(3) {
     /*Your CSS*/
} 
```

正如你[在这里看到的](http://jsfiddle.net/darkajax/cCeHV/)

# iphone - 以编程方式将 UILabel 添加到工具栏

> ID：10692969
> 
> 赞同：1
> 
> 时间：2012-05-21T21:35:01.093
> 
> 标签：iphone, ios, uitableview, uilabel, uitoolbar

我正在尝试以`UILabel`编程方式添加一个`UIToolBar`，但它似乎没有出现。这就是我对我的代码所做的。

```
- (void) viewWillAppear:(BOOL)animated 
{
    // Create custom toolbar at top of screen under navigation controller
    [matchingSeriesInfoToolBar setFrame:CGRectMake(0, 60, 320, 30)];  
    matchingSeriesInfoToolBar = [UIToolbar new];
    [matchingSeriesInfoToolBar sizeToFit];
    CGFloat toolbarHeight = 30;
    CGRect mainViewBounds = [[UIScreen mainScreen] applicationFrame];
    [matchingSeriesInfoToolBar setFrame:CGRectMake(CGRectGetMinX(mainViewBounds), 0, CGRectGetWidth(mainViewBounds), toolbarHeight)];
    matchingSeriesInfoToolBar.tintColor = [UIColor darkGrayColor];
    [self.view addSubview:matchingSeriesInfoToolBar];

    // Create size of uitableview (to fit toolbar.
    [matchingSeriesTableView setFrame:CGRectMake(0, 30, self.view.frame.size.width, self.view.frame.size.height - 30)];
    [self.view addSubview:matchingSeriesTableView];

    // Ad UILabel to the toolbar
    UIBarButtonItem *textFieldItem = [[UIBarButtonItem alloc] initWithCustomView:manufSelectionLabel];
    matchingSeriesInfoToolBar.items = [NSArray arrayWithObject:textFieldItem];
    manufSelectionLabel.text = @"Hello World!";

    [super viewWillAppear:animated];
} 
```

所以几乎我已经创建了一个自定义工具栏，我已经从屏幕底部更改了通常的位置，显示在 下`UINavigationController`，这也像这样添加到视图中，因此它在视图转换中正确动画..

之后，我创建了 tableview 的大小，以便它出现在自定义工具栏之后..

然后从那里我试图添加一个`UILabel`到工具栏..但由于某种原因它没有工作。

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-21T21:50:30.773

您必须在某处实际创建标签。这段代码工作得很好。

```
UIToolbar *toolbar = [[UIToolbar alloc] initWithFrame:CGRectMake(0, 0, 320, 44)];
[self.view addSubview:toolbar];

UILabel *label = [[UILabel alloc] initWithFrame:CGRectMake(0, 0, 100, 44)];
label.backgroundColor = [UIColor clearColor];

UIBarButtonItem *item = [[UIBarButtonItem alloc] initWithCustomView:label];
toolbar.items = [NSArray arrayWithObject:item];

label.text = @"Hello World"; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-21T21:43:11.257

在您发布的代码中，您永远不会制作`UILabel`. 您的评论*在工具栏上说 Ad UILabel ，*但您随后继续`UIBarButtonItem`使用自定义视图制作一个`manufSectionLabel`。

创建的代码在哪里`manufSectionLabel`？

* * *

PS这条线什么都不做：

```
[matchingSeriesInfoToolBar setFrame:CGRectMake(0, 60, 320, 30)]; 
```

因为那时matchingSeriesInfoToolbar是`nil`-你还没有成功！

# c++ - 在 doxygen 注释中展开宏以打印出软件版本

> ID：10692970
> 
> 赞同：7
> 
> 时间：2012-05-21T21:35:04.370
> 
> 标签：c++, makefile, doxygen

我有一些 C++ 代码库，用 doxygen 记录，并用 GNU make 构建。版本信息集中在makefile中，我有类似的东西：

> 版本=1.2.3.4

在我的 makefile 中，CFLAGS 添加了以下定义：

> CFLAGS += -DAPP_VERSION=$(VERSION)

这使我能够在代码中获取版本，如下所示：

```
#define STR_EXPAND(tok) #tok
#define STR(tok) STR_EXPAND(tok)
int main()
{
    cout << "software version is << STR(APP_VERSION) << endl;
} 
```

现在，我想要在 doxygen 生成的 html 文件中有这个：

> 当前软件版本为 1.2.3.4

我设法将makefile变量导出到doxygen配置文件中：（**编辑**：doxygen是从makefile调用的，通过'make-doc'目标）

> 预定义 = APP_VERSION=$(VERSION)

但是，如果我在 doxygen \mainpage 命令中尝试这样的事情，它会失败，因为（当然）宏名称不会在评论中扩展......

```
/**
\mainpage this is the doc
Current version is $(APP_VERSION) -- or -- ... is APP_VERSION
*/ 
```

**问题**

*   您知道在 doxygen 注释中“扩展”该宏的方法吗？这可以通过对包含 makefile 中注释的文件进行一些 sed 处理来完成，但也许这可以直接用 doxygen 解决？

*   其他项目如何处理版本控制（除了 VCS 提供的自动版本控制工具，我的意思是），版本 ID 在文件中是唯一定义的，因此它可以被软件构建系统和文档构建系统获取。

相关：[如何显示定义的值](https://stackoverflow.com/questions/10137566/)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-22T08:52:43.620

注释中的宏通常不会被扩展（例如，参见[这个答案](https://stackoverflow.com/a/9299914/623518)）。这不是 doxygen 独有的，我想不出使用`PREDEFINED`配置选项的方法。

正如您在问题中所述，您可以使用, 请参阅[此答案](https://stackoverflow.com/a/8726335/623518)`sed`中的第三个要点。例如，使用以下

```
INPUT_FILTER  = "sed -e 's/VERSION/1.0/'" 
```

将替换所有源文件中的所有实例`VERSION`（`1.0`您可以指定要处理的文件[`INPUT_FILTER`](http://www.doxygen.nl/manual/config.html#cfg_input_filter)，而不是处理所有源文件）。你可能不想`VERSION`到处扩展，所以也许最好使用类似`$(VERSION)`和`sed`这个令牌的东西。此外，您将需要一种从 makefile 中获取版本号并进入 doxygen 配置文件的方法。这可以用另一个`sed`.

为了解决您的最后一个要点，doxygen 具有[`FILE_VERSION_FILTER`](http://www.doxygen.nl/manual/config.html#cfg_file_version_filter)用于确定每个文件的版本号的配置选项。`FILE_VERSION_FILTER`使用它会在每个文件页面的顶部打印一些版本信息（从 中指定的命令打印到标准输出的任何内容）。在文档中，有使用多种不同版本控制系统获取版本号的示例。另外，[这里](http://alip.github.com//en/blog/2010/12/14/doxygen-git/)有一个页面描述了如何使用 git 和 doxygen 来提取版本信息。

此配置选项的唯一缺点是我不知道如何指定文件版本信息应出现在最终文档中的哪个位置。我假设您可以使用布局文件：我假设您可以[更改 pages 的布局](http://www.doxygen.nl/manual/customize.html#layout)，但我从未这样做过，也不知道使用它在主页上包含版本信息有多容易。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-21T21:56:43.267

命令[手册](http://www.doxygen.nl/manual/commands.html)建议`$(VARIABLE)`扩展环境变量。所以也许你可以把你的版本放在环境变量中？

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-29T11:51:32.230

您需要使用 make 的“导出”功能，即一个非常简单的 make 文件

```
project_name=FooBar
export project_name
all:
    doxygen Doxyfile 
```

将允许您在 C++ 中使用以下注释

```
/*! \mainpage Project $(project_name) Lorem ipsum dolor 
```

我可以看到这将成为具有大量导出的 PITA，但这是一种相当简单的方法。或者，您可以从一个单独的 BASH 脚本中运行 doxygen，其中包含所有导出内容，以避免过多地污染您的 Makefile。

# regex - 从 CamelCase 字符串拆分单词

> ID：10692971
> 
> 赞同：2
> 
> 时间：2012-05-21T21:35:05.653
> 
> 标签：regex, string, matlab, strtok

我有一个字符串

```
string =  'one Two9three four_Five 67SixSevenEightNine'; 
```

我需要将其拆分为：

```
'one' 'two' 'three' 'four' 'five' 'six' 'seven' 'eight' 'nine' 
```

当小写字母后跟大写字母时，我设法将除了 CamelCase 之外的所有字母分开：

```
while ~isempty(string)
        [str,string] = ...
           strtok(string, ...
                  [' ~@$/#.-:&*+=[]?!(){},''">_<;%' char(9) char(10) char(13) '0-9']);
       str = regexprep(str, '[0-9]','');
end 
```

我也可以获得模式的索引，但只有当我知道如何在其间插入空格或某些字符时，我才能再次使用上面的代码拆分成单词：

```
pattern = '[a-z][A-Z]+';
[pat,idx]=regexp(str, pattern,'match'); 
```

有任何想法吗？谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-21T21:41:43.147

为什么不在进行其他处理之前更换 camelCase？

```
newstring = regexprep(string, '([a-z])([A-Z])', '$1 $2');

while ~isempty(newstring)
... 
```

# java - 生成 0 到 1000 之间的唯一随机数

> ID：10692978
> 
> 赞同：0
> 
> 时间：2012-05-21T21:35:19.180
> 
> 标签：java, random

> **可能的重复：**
> [在 Java 中生成唯一的随机数](https://stackoverflow.com/questions/8115722/generating-unique-random-numbers-in-java)

如何生成 0 到 1000 之间的随机数并继续将在 0 到 1000 之间生成的唯一随机数传递给特定方法。因此，为此我生成了 0 到 1000 之间的数字，并在 List 中插入了 0 到 1000 之间的唯一随机数，以便我们可以比较我们生成的随机数是否已经存在于列表中。如果它存在，则再次生成它。但不知何故，我相信下面的代码有时会失败。

```
public class Testing4 {
    private static List<Integer> randomNumber;
    private static Random r = new Random();
    private static int rand;
    private static int endRange = 1000;

    public static void main(String args[]) throws IOException {

        randomNumber = new ArrayList<Integer>();

        for (int i = 1; i<= endRange; i++) {
            rand = r.nextInt(endRange);

            if(randomNumber.contains(rand)) {
                rand = r.nextInt(endRange);
            } else {
                randomNumber.add(rand);
            }

        // Pass the unique random number between 0 and 1000 to this method      
                randomNumberMethod(rand);

        }
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-21T21:45:50.367

您实际上是在以随机顺序生成 0-1000 的数字列表。您可以通过以下方式更有效地实现这一目标：

```
public class Testing4 {
    private static List<Integer> randomNumber;
    private static int endRange = 1000;

    public static void main(String args[]) throws IOException {

        randomNumber = new ArrayList<Integer>(endRange);

        for (int i = 0; i<= endRange; i++) {                
            randomNumber.add(i);
        }

        Collections.shuffle(randomNumber);

        for (int i = 0; i<= endRange; i++) {                
            // Pass the unique random number between 0 and 1000 to this method      
            randomNumberMethod(randomNumber.get(i));
        }
    }
} 
```

想想当你到达 999 时会发生什么——你将有 999 分之一的机会在每次循环中“猜测”剩余的可用数字。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-21T21:40:12.210

要生成 0 到 1000 之间的唯一数字列表，请执行以下操作：

*   创建一个包含从 0 到 1000 的所有数字的列表
*   使用 Collections.shuffle() 打乱列表
*   从列表中取出您需要的第一个数字。

在某些情况下需要更复杂的算法，但如果可能的数字范围和您需要选择的项目数量都在 1000 左右，那么您真的不妨从随机打乱的列表中取出前*n 个*数字所有的可能性。

如果您确实想做您建议的事情，那么：

*   正如另一位海报所建议的那样使用while循环
*   使用 Set 而不是列表来存储已经选择的值。

但是，这变得低效，因为要选择的项目数量趋向于可能项目的数量（例如，如果您从可能的 1000 个数字中选择 10 个，那么就可以了；如果您选择 900在可能的 1000 个中，它将变得低效，因为每次都需要拒绝越来越多的数字，然后才能找到以前未选择的数字）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-21T21:55:48.663

从代码检查中，我看不到任何会阻止它工作的方法，它只是非常低效。

一方面，检查数字是否是您看到的数字`randomNumber.contains(rand)`将花费越来越多的时间，因为您每次生成的数字越多，您必须将其与列表中的每个数字进行比较，直到您找到一个匹配的，或者您已经尝试了列表中的每个数字。更好的方法是使用 a[`HashSet`](http://docs.oracle.com/javase/6/docs/api/java/util/HashSet.html)而不是列表，它应该使每个成员资格测试花费相同的时间，而不管您在其中放入了多少东西。

通过注意您可能提出了错误的问题，可以进行第二个更重要的优化。您是要生成唯一的随机数，还是要以随机顺序生成 1 和 endRange 之间的每个数字？如果您想要每个数字（甚至是其中的重要部分），将 1 到 1000 之间的每个数字放入一个列表中，然后使用[`Collections.shuffle`](http://docs.oracle.com/javase/6/docs/api/java/util/Collections.html#shuffle%28java.util.List%29). 所以你的生成代码将是：

```
java.util.List<Integer> nums = new java.util.ArrayList<Integer>(1001);
for (int i = 0; i <= 1000; i++)
{
   nums.add(new Integer(i));
}
java.util.Collections.shuffle(nums); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-21T21:37:51.790

如果连续生成 ArrayList 中已存在的 2 个数字，您的代码将失败。它将使用第二个数字，无论它是否重复。if 语句应该是一个 while 循环（不断尝试，直到它生成一个唯一的循环）。

```
public class Testing4 {
    private static HashSet<Integer> randomNumber;
    private static Random r = new Random();
    private static int rand;
    private static int endRange = 1000;

    public static void main(String args[]) throws IOException {

        randomNumber = new HashSet<Integer>();

        for (int i = 1; i<= endRange; i++) {    
            do
            {
               rand = r.nextInt(endRange);
            }
            while(randomNumber.contains(rand));

            randomNumber.add(rand);

            // Pass the unique random number between 0 and 1000 to this method      
            randomNumberMethod(rand);

        }
    }
} 
```

编辑：根据评论，您应该使用 do/while 和散列数据结构而不是 arraylist 来加速重复查找。最后的编辑在上面的代码中。

# android - Android：本机线程与主线程的同步

> ID：10692980
> 
> 赞同：2
> 
> 时间：2012-05-21T21:35:31.637
> 
> 标签：android, android-ndk

在我的 android 应用程序中，我有一个从本地线程到 Java 代码的回调，它需要与主 UI 线程同步。目的是 UI 线程根据从本机线程返回的信息显示选项列表。在用户选择一个选项之前，本机线程需要阻塞。在用户选择一个选项后，本机线程读取该值并继续运行。

我尝试使用 ConditionVariable 来实现此解决方案，但是我收到一个 VM 错误，其中包含指示“致命的自旋挂起，转储线程”的注释。

看起来好像不可能使用基于 Java 的同步对象来同步这些线程。该代码在我有两个 Java 线程的情况下完美运行。

一般来说，有没有办法使用基于 Java 的同步对象来同步 Java 和本机线程，或者这是否需要使用 NDK 来实现，并从 Java 线程调用实现同步的 NDK 函数？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-24T16:41:37.647

这样做的方法不是使用基于 Java 的同步对象，而是使用基于 NDK 的同步对象，如下所示：

```
static pthread_cond_t  uiConditionVariable  = PTHREAD_COND_INITIALIZER;
static pthread_mutex_t uiConditionMutex     = PTHREAD_MUTEX_INITIALIZER;

/**
 * This function opens the condition variable which releases waiting threads.
 */
JNIEXPORT void JNICALL
Java_com_Xxxx_openConditionVariable(JNIEnv *env,jobject o)
{
    pthread_mutex_lock(&uiConditionMutex);
    pthread_cond_signal(&uiConditionVariable);
    pthread_mutex_unlock(&uiConditionMutex);
}

/**
 * This function blocks on the condition variable associated with the 
 */
JNIEXPORT void JNICALL
Java_com_Xxxx_blockConditionVariable(JNIEnv *env,jobject o)
{
    pthread_mutex_lock(&uiConditionMutex);
    pthread_cond_wait(&uiConditionVariable,&uiConditionMutex);
    pthread_mutex_unlock(&uiConditionMutex);
} 
```

# stress-testing - 负载测试 ec2 Node.js 机器 - 现在...如何远程负载测试 6500 QPS？

> ID：10692985
> 
> 赞同：0
> 
> 时间：2012-05-21T21:36:18.500
> 
> 标签：stress-testing, load-testing

好的，我的服务器建立在 ec2 上。我的堆栈是 Nginx 作为负载均衡器，supervisord 用于管理 node.js 的进程，即每个 cpu 一个进程，以及 redis、master 和 slave 在不同的盒子上。我通过测试故障转移和使服务脱机进行了压力测试。使用 apache AB，在服务器上我可以获得高达 6500 QPS。

现在，我需要远程加载测试。什么是实现这一目标的最佳开源工具，甚至是实现这一目标的最具成本效益的 SaaS 方法。我确实希望生产中的每台服务器有 6500 QPS，并且需要将 apache AB 的隔离扩展到远程测试。例如，我将在新加坡拥有服务器，我需要测试来自日本的 6500 QPS 和延迟的影响。我知道 apache Jmeter 但正在寻找最佳实践解决方案。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-21T21:40:50.963

我已经成功地使用[jMeter](http://jmeter.apache.org/)进行了大规模的负载测试。

如果单个负载生成客户端无法输出足够的负载，您可以为 jMeter 配置多个负载生成客户端，负载由主实例协调。

使用“开源工具”意味着您有能力在您感兴趣的区域（例如日本）启动服务器。如果您在该地区找到云提供商，您可以根据需要启动尽可能多的负载生成实例。但是，您可能需要相当多的实例，具体取决于为各个实例提供的网络连接。jMeter 的好处是它可以协调许多负载生成实例。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-08-28T05:55:10.143

您可以使用[blazemeter](http://blazemeter.com)作为 SaaS 解决方案。它与 Jmeter 100% 兼容。有您需要的日本（东京）装载源位置。

# .net - .NET 远程处理服务器和客户端在同一个进程/应用程序域中？

> ID：10692986
> 
> 赞同：0
> 
> 时间：2012-05-21T21:36:20.963
> 
> 标签：.net, remoting

我有一个进程 (B)，我希望同时充当 .NET 远程客户端和服务器。换句话说，这个过程将通过 .NET 远程处理连接到服务器 (C)，并通过 .NET 远程处理将自身暴露给客户端 (A)。例如：

```
A --> B --> C 
```

这可能吗？这是我的 B 配置文件的片段：

```
 <channel ref="tcp" port="0" secure="true" tokenImpersonationLevel="impersonation"/>
    <channel ref="ipc" portName=..../> 
```

已配置 tcp 通道，因为 B 必须使用模拟连接到 C。还配置了一个 ipc 通道，以便本地客户端 (A) 可以连接到 B。但是 .NET 远程处理不会看到 B 的两个端口并在两个端口上公开服务器对象吗？如果是这样，我如何限制它只使用服务器的 ipc 通道？

并且只是为了抢占所有 WCF 爱好者——我会对追求 WCF 感兴趣，但前提是它提供了唯一的解决方案。我对它不感兴趣只是为了使用更新的技术。

# qt - 在 Ubuntu 12.04 上构建的静态 Qt 4.8.1

> ID：10692988
> 
> 赞同：1
> 
> 时间：2012-05-21T21:36:25.533
> 
> 标签：qt, qt4, static-libraries, static-linking, dynamic-linking

由于可移植性问题，我正在尝试构建一个几乎静态的应用程序。我希望能够在几个 64 位 linux 发行版上运行可执行文件。我已经成功地静态链接 Qt 并使用静态链接的 libstdc++ 和 libgcc 进行构建。

但是，我有一些第 3 方库的担忧。我用 -qt-zlib 构建了 Qt，但我的最终应用程序仍然与系统 zlib 动态链接。具体来说，我配置了：

```
./configure -static -nomake demos -nomake examples -nomake tools -release -no-webkit -qt-zlib -no-gif -qt-libtiff -qt-libpng -qt-libmng -qt-libjpe 
```

我删除了应用程序中链接到 zlib 的所有引用，假设应用程序能够链接到 Qt 的静态构建 zlib。在我看来，Qt 几乎忽略了 -qt-zlib 标志，并使用了系统库，然后我的应用程序也使用了它。

此外，我必须安装 libfontconfig-dev 包，这样从源代码构建后的字体不会很糟糕，但现在 Qt 也动态链接到它。如您所见，我尝试链接到 libfontconfig 的静态库，但由于 Qt 已链接到 libfontconfig，链接器将忽略它。在 Qt 构建期间有没有办法指定不动态链接到 3rd 方库？

如果可能的话，我不希望任何 Qt 的依赖项被静态链接。现在我相信该应用程序至少可以在 Ubuntu 12.04 上运行，但其他发行版可能会将一些库放在不同的地方。

我的 .pro 文件中的片段：

```
QT += core \
      gui \
      opengl
QMAKE_CXXFLAGS += -fpermissive
QMAKE_LFLAGS += -static-libgcc -static-libstdc++
CONFIG += static
TEMPLATE = app
LIBS += /usr/local/lib/libboost_thread.a \
        /usr/local/lib/libboost_program_options.a \
        /usr/lib/x86_64-linux-gnu/libfontconfig.a \
        /usr/lib/x86_64-linux-gnu/libGLU.a 
```

ldd 的输出：

```
linux-vdso.so.1 =>  (0x00007fff992b4000)
libSM.so.6 => /usr/lib/x86_64-linux-gnu/libSM.so.6 (0x00007f195ccbc000)
libICE.so.6 => /usr/lib/x86_64-linux-gnu/libICE.so.6 (0x00007f195caa2000)
**libfontconfig.so.1 => /usr/lib/x86_64-linux-gnu/libfontconfig.so.1 (0x00007f195c86b000)**
libfreetype.so.6 => /usr/lib/x86_64-linux-gnu/libfreetype.so.6 (0x00007f195c5cf000)
libXext.so.6 => /usr/lib/x86_64-linux-gnu/libXext.so.6 (0x00007f195c3be000)
libX11.so.6 => /usr/lib/x86_64-linux-gnu/libX11.so.6 (0x00007f195c089000)
libdl.so.2 => /lib/x86_64-linux-gnu/libdl.so.2 (0x00007f195be85000)
librt.so.1 => /lib/x86_64-linux-gnu/librt.so.1 (0x00007f195bc7d000)
**libGL.so.1 => /usr/lib/x86_64-linux-gnu/mesa/libGL.so.1 (0x00007f195ba1c000)**
libpthread.so.0 => /lib/x86_64-linux-gnu/libpthread.so.0 (0x00007f195b7ff000)
libm.so.6 => /lib/x86_64-linux-gnu/libm.so.6 (0x00007f195b505000)
libc.so.6 => /lib/x86_64-linux-gnu/libc.so.6 (0x00007f195b147000)
/lib64/ld-linux-x86-64.so.2 (0x00007f195ced9000)
libuuid.so.1 => /lib/x86_64-linux-gnu/libuuid.so.1 (0x00007f195af42000)
libexpat.so.1 => /lib/x86_64-linux-gnu/libexpat.so.1 (0x00007f195ad18000)
**libz.so.1 => /lib/x86_64-linux-gnu/libz.so.1 (0x00007f195ab00000)**
libxcb.so.1 => /usr/lib/x86_64-linux-gnu/libxcb.so.1 (0x00007f195a8e2000)
libglapi.so.0 => /usr/lib/x86_64-linux-gnu/libglapi.so.0 (0x00007f195a6bd000)
libXdamage.so.1 => /usr/lib/x86_64-linux-gnu/libXdamage.so.1 (0x00007f195a4b9000)
libXfixes.so.3 => /usr/lib/x86_64-linux-gnu/libXfixes.so.3 (0x00007f195a2b3000)
libX11-xcb.so.1 => /usr/lib/x86_64-linux-gnu/libX11-xcb.so.1 (0x00007f195a0b1000)
libxcb-glx.so.0 => /usr/lib/x86_64-linux-gnu/libxcb-glx.so.0 (0x00007f1959e99000)
libXxf86vm.so.1 => /usr/lib/x86_64-linux-gnu/libXxf86vm.so.1 (0x00007f1959c94000)
libdrm.so.2 => /usr/lib/x86_64-linux-gnu/libdrm.so.2 (0x00007f1959a89000)
libXau.so.6 => /usr/lib/x86_64-linux-gnu/libXau.so.6 (0x00007f1959885000)
libXdmcp.so.6 => /usr/lib/x86_64-linux-gnu/libXdmcp.so.6 (0x00007f195967f000) 
```

**更新：**

我已经放弃了这项任务，因为它似乎不可行。由于开发人员已经决定可以发布源代码，因此我将使用标准的 ./configure、make 和 make install 移植它。

即使我能够静态链接这些库，libc 的版本甚至与 Ubuntu 11 也不同。据我所知，libc 无法静态链接。似乎最好的选择是使用 GNU 的自动工具构建一个包，但即使这样也是一项痛苦的任务。

关于如何使用 GNU 工具为 Qt 项目创建 ./configure 脚本的任何提示或技巧？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-13T19:54:19.773

构建一个可移植的完全静态的可执行文件并不容易。据我所知，为什么这样做实际上并不可行，存在很多技术问题。libc 不能静态链接，因此出于兼容性考虑，您必须使用旧版本的 libc 进行编译。

在 linux 平台上实现可移植性的最佳解决方案是发布源代码并使用 GNU 的 Autotools 构建`./configure`脚本。但是，使用 Qt 项目并不容易完成这项任务。

最终，我求助于使用基本安装脚本发布源代码，该脚本将检查 Qt 是否安装在机器上并使用 qmake 构建项目。这不是一个很好的解决方案，但它有效。

如果您不愿意发布源代码，请构建一个半静态（使用 Qt 和可能的一些其他库）链接的可执行文件和一个安装程序，以验证库位于正确的位置并在必要时安装它们。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-23T10:13:46.003

如果我能猜到..

不久前，我在一些基于 Linux 的操作系统中制作了一个静态链接的应用程序，我必须包含所有静态库，我也想使用和 3party。但是对于 Qt 模块，这是一种不清楚的行为 .. 例如对我来说：我想要的 qico 模块将只包含在这样的结构中：

在 .pro 文件中：

```
QTPLUGIN += qico
DEFINES += STATIC 
```

在 main.cpp 中：

```
#ifdef STATIC
#include <QtPlugin>
Q_IMPORT_PLUGIN(qico)
#endif 
```

可能会有所帮助。

# algorithm - 大整数的 GCD 算法

> ID：10692994
> 
> 赞同：2
> 
> 时间：2012-05-21T21:36:55.723
> 
> 标签：algorithm, complexity-theory, double-precision, greatest-common-divisor, computation

我正在寻找有关快速 GCD 计算算法的信息。特别是，我想看看它的实现。

对我来说最有趣的是： - Lehmer GCD 算法， - 加速 GCD 算法， - k-ary 算法， - 带有 FFT 的 Knuth-Schonhage。我完全没有关于加速 GCD 算法的信息，我只看过几篇文章，其中提到它是在中等输入（~1000 位）上最有效和最快速的 gcd 计算方法

从理论的角度来看，它们看起来对我来说很难理解。任何人都可以分享代码（最好在 c++ 上）实现列表中的任何算法\部分或分享任何这样做的经验。我也将不胜感激任何信息、评论、建议和地方调查。我有一个处理大整数的类，但我没有处理它的方法。当然，除了 Euclid 和 Binary gcd 算法，我现在看起来很清楚；没有问题。最后我想得到的主要内容：实现 lehmer gcd 的代码。（从列表中更容易）

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-21T23:12:45.177

*Knuth 在《计算机编程艺术》*第 2 卷第 4.5.2 节中详细探讨了 GCD 。Knuth 给出了算法 E 为欧几里得的原始方法，算法 A 为欧几里得算法的现代版本，算法 B 为二进制方法，算法 L 为 Lehmer 方法，以及算法 X 中的扩展欧几里得算法。我描述（附代码)[原始欧几里得算法](http://programmingpraxis.com/2009/07/07/modular-arithmetic/)、[现代欧几里得算法](http://programmingpraxis.com/contents/howto-posting-source-code/)、[二进制算法](http://programmingpraxis.com/2010/01/15/three-binary-algorithms/)和[扩展欧几里得算法](http://programmingpraxis.com/2009/07/07/modular-arithmetic/)在我的博客上。

[这篇论文](http://www.lysator.liu.se/~nisse/archive/sgcd.ps)很好地描述了 Schönhage 算法的几个版本，包括代码。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-08-18T11:04:54.010

非常感谢您的回答 user448810。那个二进制算法对我来说是完美的，而且速度很快。我将其转换为非递归形式以节省内存和递归调用。这是我的 longnum 库的实现，为与标准运算符/函数不同的行添加了一些 rems

```
longnum gcd(longnum x,longnum y)
    {
    x.sig=+1; x.integer(); // x=abs(int(x))
    y.sig=+1; y.integer(); // y=abs(int(y))
    longnum z; int x0,y0,sh=0;
    for (;;)
        {
        if (x.iszero()) { z=y; break; } // if (!x) ...
        if (y.iszero()) { z=x; break; } // if (!y) ...
        x0=x.a[_longnum_a1]&1; // x0=x&1
        y0=y.a[_longnum_a1]&1; // y0=y&1
        if ((!x0)&&(!y0)) { x>>=1; y>>=1; sh++; continue; }
        if (!x0) { x>>=1; continue; }
        if (!y0) { y>>=1; continue; }
        if (x<y) y-=x;
        else     x-=y;
        }
    return (z<<sh);
    } 
```