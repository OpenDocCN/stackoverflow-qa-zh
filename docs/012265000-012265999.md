# StackOverflow 问答 12265000-12265999

# java - java.nio.charset.UnsupportedCharsetException：Jsoup 中的 X-MAC-ROMAN 获取网页

> ID：12265001
> 
> 赞同：1
> 
> 时间：2012-09-04T13:53:02.427
> 
> 标签：java, character-encoding, jsoup

我有

```
Document document = Jsoup.connect(link).get(); 
```

有时对于某些网址，我会遇到异常：

```
Exception in thread "main" java.nio.charset.UnsupportedCharsetException: X-MAC-ROMAN
    at java.nio.charset.Charset.forName(Unknown Source)
    at org.jsoup.helper.DataUtil.parseByteData(DataUtil.java:86)
    at org.jsoup.helper.HttpConnection$Response.parse(HttpConnection.java:469)
    at org.jsoup.helper.HttpConnection.get(HttpConnection.java:147) 
```

我有一个 catch 块：

```
catch (IOException  e1) 
```

我理解例外是因为 java 是 unicode 并且该网页/网站没有遵循 unicode。如何处理这个问题 连接也被用于包括 unicode 和 bytecode 的许多网站

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-04T14:15:30.177

> *我理解例外是因为 java 是 unicode 并且该网页/网站没有遵循 unicode。*

这并不完全正确。您可能会将“Java 是 unicode”这句话与 Java 使用 Unicode 将字符串/字符存储在内存中这一事实混淆（您知道，计算机内存只能存储字节（零和一），而不是字符，因此字符需要使用特定的字符编码转换为字节并返回；Java 正在为此使用 unicode）。

发生此异常是因为您的 Java 代码运行的底层操作系统平台不支持此字符集，因此 Java 无法将从 Web 服务器获取的字节转换为此编码中的字符。此字符集特定于 Mac OS 平台，您可能正在运行 Windows 左右。

* * *

> *如何处理这个问题*

联系网站管理员并将其报告为错误。他们使用特定于平台的（Mac OS）编码而不是通用（ISO/UTF）编码是**他们的错。**

至于 Jsoup，最好的办法是先获取网站`InputStream`，`URL#openStream()`然后将其提供给`Jsoup#parse()`您明确指定平台支持的字符编码，例如 ISO-8859-1。例如：

```
Document doc = Jsoup.parse(new URL(link).openStream(), "ISO-8859-1", link); 
```

请注意，当存在非 ASCII 字符时，您仍然冒着使用[Mojibake的风险。](http://en.wikipedia.org/wiki/Mojibake)另请注意，您不应该对所有链接都这样做，而只对那些抛出的链接执行此操作（因此，在其块`UnsupportedCharsetException`中执行该作业）。`catch`

* * *

> *但我可以在我的 chrome 中访问它，为什么不能从 Jsoup*

那是因为 Chrome 试图对你如此友善，以至于它忽略了未知编码并选择了默认编码——这可能仍然存在网站在 Mojibake 中显示的风险；超出 ASCII 范围的任何内容都可能看起来格式不正确。

* * *

> *connect 用于包括 unicode 和 bytecode 的许多网站*

请刷新您的词汇表，了解“字节码”这个词的含义。这与字符编码完全无关。

# database - Phonegap：INVALID_STATE_ERR：DOM 异常 11

> ID：12265003
> 
> 赞同：2
> 
> 时间：2012-09-04T13:53:06.920
> 
> 标签：database, cordova

当我尝试处理一个时，它失败了：

> 未捕获的错误：INVALID_STATE_ERR：文件中的 DOM 异常 11：///android_asset/www/library/custom.js:39

但是当我尝试第二个过程时，它就好了。

```
var db = window.openDatabase("Pemberton", "1.0", "Pemberton Stay App", 200000);
document.addEventListener("deviceready", onDeviceReady, false);
function onDeviceReady() {
    db.transaction(populateDB, errorCB, successCB);
} 
```

过程1：

```
function populateDB(tx) {
    tx.executeSql('DROP TABLE IF EXISTS eat');
    tx.executeSql('CREATE TABLE IF NOT EXISTS eat (id, image, title)');
    var queries = new Array();
    $.getJSON( serviceURL + 'category-list.php?cid=1&p=?', function(data) {
        var results = data.items;
        $.each(results,function(index,record){
            if( record.id != undefined )
                tx.executeSql('INSERT INTO eat (id, image, title) VALUES ("'+record.id+'","'+record.image+'","'+record.title+'")');
        });

    });    
} 
```

过程2：

```
function populateDB(tx) 
{
    tx.executeSql('INSERT INTO eat (id, image, title) VALUES (2,"one.jkd","OneFirst")');
    tx.executeSql('INSERT INTO eat (id, image, title) VALUES (2, "two.png","Second")');
    tx.executeSql('INSERT INTO eat (id, image, title) VALUES (3, "thr.png","Third")');
    tx.executeSql('INSERT INTO eat (id, image, title) VALUES (4, "fou.png","Fourth")');
    tx.executeSql('INSERT INTO eat (id, image, title) VALUES (5, "fiv.png","Fifth")');
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-21T19:02:55.963

我使用 .ajax() 并通过添加***async:false***解决了这个问题；

> $.ajax({ type: "POST", url: myurl, dataType: "xml", **async : false,** success: function (xml) {
> 
> ```
>  $(xml).find('articles').each(
>                         function ()
>                         {
> 
>                             tx.executeSql('INSERT INTO ORDERS (id, client_ID, status) VALUES ('+ idord2 +', 4, "done" )');
>                         });         
>                     }
>                 }); 
> ```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-11-27T10:28:24.277

尽管[其他答案之一有效](https://stackoverflow.com/questions/12265003/phonegap-invalid-state-err-dom-exception-11/12536659#12536659)，但我想对其进行扩展，因为我遇到了同样的问题，并且该答案没有说明*为什么*它不像 OP 那样工作。

[当您在 Web SQL 中创建事务时，事务处理只有在事务中有任何语句排队时](http://www.w3.org/TR/webdatabase/#processing-model)才会保持活动状态。一旦事务中的语句管道干涸，引擎就会关闭（提交）事务。这个想法是当`function(tx) { ... }`回调运行时，

1.  它执行它需要的所有语句。`executeSql`是异步的，因此即使语句尚未执行，它也会立即返回。
2.  它将控制权返回给 Web SQL 引擎。

此时引擎注意到有语句排队并在关闭事务之前运行它们直到完成。在您的情况下，会发生以下情况：

1.  您调用`executeSql`两次来排队两个语句。
2.  你通过ajax请求一些东西。
3.  你回来

引擎运行它已排队的两个语句。ajax 请求也在异步运行，但它必须访问速度较慢的网络，因此它可能尚未完成。此时，语句队列为空，Web SQL 引擎决定是时候提交和关闭事务了！它无法知道稍后会有另一个声明！当 ajax 调用返回并尝试执行时`INSERT INTO locations`，为时已晚，事务已经关闭。

主要有两种解决方案：

*   在回调中的一个事务中执行所有操作（the `DROP`、the`CREATE`和所有s）。`INSERT``getJSON`

    这是我推荐的。我认为很有可能等到 ajax 请求完成后再创建表与您的应用程序要求兼容。

*   如另一个答案中所述，同步执行 ajax 请求。

    我不建议这样做。JavaScript 中的异步编程是一件*好事*。

顺便说一句，在搜索这个问题时，我发现[这个问题](https://stackoverflow.com/questions/9953324/websql-transaction-wont-run-in-js-callback-functions/27167735)的答案基本相同，所以我写[了相同的答案](https://stackoverflow.com/questions/9953324/websql-transaction-wont-run-in-js-callback-functions/27167735#27167735)，但那里有更多的细节。我知道在 SO 上不鼓励复制和粘贴答案，但我想确保将来咨询任一问题的用户都能阅读答案。我制作了这个社区维基。我希望没关系。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-04T23:02:20.990

db 操作必须在 deviceready 事件后完成，请参阅完整示例[http://docs.phonegap.com/en/1.2.0/phonegap_storage_storage.md.html#SQLTransaction](http://docs.phonegap.com/en/1.2.0/phonegap_storage_storage.md.html#SQLTransaction)

```
....
// Wait for PhoneGap to load
    //
    document.addEventListener("deviceready", onDeviceReady, false);

    // PhoneGap is ready
    //
    function onDeviceReady() {
        var db = window.openDatabase("Database", "1.0", "PhoneGap Demo", 200000);
        db.transaction(populateDB, errorCB, successCB);
    }
.... 
```

# c# - 用于解析特定 URL 段的正则表达式

> ID：12265009
> 
> 赞同：-1
> 
> 时间：2012-09-04T13:53:23.737
> 
> 标签：c#, regex

我正在尝试从 C# 中的 URL 获取字符串。URL 将如下所示：

[http://www.somesite.com/something/I-WANT-THIS-SEGMENT/cms/somethingelse](http://www.somesite.com/something/I-WANT-THIS-SEGMENT/cms/somethingelse)

或者

[http://www.somesite.com/something/someotherthing/I-WANT-THIS-SEGMENT/cms](http://www.somesite.com/something/someotherthing/I-WANT-THIS-SEGMENT/cms)

或者

[http://www.somesite.com/I-WANT-THIS-SEGMENT/cms/something](http://www.somesite.com/I-WANT-THIS-SEGMENT/cms/something)

基本上，我想要“cms”之前的段

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-04T14:00:28.730

不是很漂亮，但我认为你在这里不需要正则表达式：

```
string Url1 = @"http://www.somesite.com/something/I-WANT-THIS-SEGMENT/cms/somethingelse";
string Url2 = @"http://www.somesite.com/something/someotherthing/I-WANT-THIS-SEGMENT/cms";
string Url3 = @"http://www.somesite.com/I-WANT-THIS-SEGMENT/cms/something";

Url1 = Url1.Substring(0, Url1.IndexOf("/cms"));
string PartOfUrl1 = Url1.Substring(Url1.LastIndexOf("/")+1);
Console.WriteLine(PartOfUrl1);

Url2 = Url2.Substring(0, Url2.IndexOf("/cms"));
string PartOfUrl2 = Url2.Substring(Url2.LastIndexOf("/")+1);
Console.WriteLine(PartOfUrl2);

Url3 = Url3.Substring(0, Url3.IndexOf("/cms"));
string PartOfUrl3 = Url3.Substring(Url3.LastIndexOf("/")+1);
Console.WriteLine(PartOfUrl3); 
```

`Uri`正如 George 指出的那样，使用这个类也很好。

# php - if 语句输出了错误的回声

> ID：12265012
> 
> 赞同：0
> 
> 时间：2012-09-04T13:53:29.760
> 
> 标签：php, mysqli

> **可能重复：**
> [在数据库中找不到正确的电子邮件地址](https://stackoverflow.com/questions/12182225/it-cannot-find-the-correct-email-address-in-the-database)

我的 if else 语句有问题。当我在文本框中输入正确的用户名和电子邮件时，它会继续执行 else 语句并回显“您输入了错误的电子邮件地址”，而不是执行 if 语句并回显“您的详细信息正确”。即使我从数据库中输入了正确的用户名和与该用户相关联的正确电子邮件，有谁知道为什么它会回显错误的语句？

```
if (isset($_POST['resetbtn'])) {
    //get form data
    $user  = $_POST['user'];
    $email = $_POST['email'];

    //make sure info is provided
    if ($user) {
        if ($email) {
            if ((strlen($email) >= 7) && (strstr($email, "@")) && (strstr($email, "."))) {

                $query   = "SELECT TeacherUsername, TeacherEmail FROM Teacher WHERE TeacherUsername = ?";
                // prepare query
                $stmt    = $mysqli->prepare($query);
                // You only need to call bind_param once
                $stmt->bind_param("s", $user);
                // execute query
                $stmt->execute();
                // get result and assign variables (prefix with db)
                $stmt->bind_result($dbTeacherUsername, $dbTeacherEmail);
                //get number of rows
                $stmt->store_result();
                $numrows = $stmt->num_rows();

                if ($numrows == 1) {

                    $row            = $stmt->fetch();
                    $dbTeacherEmail = $row['TeacherEmail'];

                    //make sure email is correct

                    if ($email == $dbTeacherEmail) {

                        echo "Your details are correct";
                    } else {
                        echo "You entered in the Wrong Email Address";
                    }
                } else {
                    echo "Please Enter in your Email";
                }
            } else {
                echo "Please Enter in your Username";
            }
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-04T13:57:56.013

在 php 中比较字符串时不要使用 ==。

利用

```
strcmp($string1,$string2)==0 
```

来测试平等。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-04T20:50:47.697

我认为你使用`$stmt->fetch()`不正确。您似乎将返回值视为一个数组，但返回是一个布尔值，并且 的值`$dbTeacherEmail`已经绑定到结果 by `$stmt->bind_result($dbTeacherUsername, $dbTeacherEmail)`。

尝试删除读取的行

```
$dbTeacherEmail = $row['TeacherEmail']; 
```

看看你是否得到你想要的。另请参阅[mysqli-stmt::fetch()上的文档](http://www.php.net/manual/en/mysqli-stmt.fetch.php)

# php - PIE.htc 位置 - 我怎么知道 html 的相对路径在哪里 - zencart

> ID：12265013
> 
> 赞同：1
> 
> 时间：2012-09-04T13:53:34.310
> 
> 标签：php, html, css, zen-cart, css3pie

我正在尝试使用 css3 PIE.htc 文件在 IE 上制作漂亮的圆角。

我已经阅读了这个网站上所有与它相关的帖子，并尝试了所有不同的路径组合，我现在也在大量文件夹中获得了 PIE 文件，但无论如何我似乎都无法得到它在 IE8 上工作。

我正在使用虚拟机查看我的本地主机上的站点（或我的虚拟机调用它的 169.254.107.215），这是我正在尝试的代码： - 我认为这与对 htc 的需求有关文件相对于 html（而不是 css 文件），就像我说的那样，我尝试了许多不同的组合

```
.rounded {
border: 1px solid #ccc;
-moz-border-radius: 10px;
-webkit-border-radius: 10px;
border-radius: 10px;
-moz-box-shadow: 2px 2px 3px #666;
-webkit-box-shadow: 2px 2px 3px #666;
box-shadow: 2px 2px 3px #666;
font-size: 20px;
padding: 4px 7px;
outline: 0;
-webkit-appearance: none;
width:250px;
position: relative;
behavior: url(PIE.htc);
}

<div class="rounded">stuff stuff stuff</div> 
```

我究竟做错了什么？请帮我 ：（

编辑：我尝试创建一个单页网站进行测试，我可以让它正常工作，所以它必须是放置 htc 文件的位置的问题。我几乎在任何我能想到的地方都有它。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-10T02:58:09.767

htc 文件应该与您的 HTML 文件相关。不是你的 CSS 文件。

我通常把它放在根目录下。您可能需要在 CSS 文件中的路径前添加 /。所以它会是 /PIE.htc

如果您需要帮助查找或确保您的文件位于正确的目录中。看看这个有用的教程。

[http://www.htaccesstools.com/articles/full-path-to-file-using-php/](http://www.htaccesstools.com/articles/full-path-to-file-using-php/)

# objective-c - CBPeripheral 名称有时为空

> ID：12265028
> 
> 赞同：10
> 
> 时间：2012-09-04T13:54:17.277
> 
> 标签：objective-c, ios, core-bluetooth

我正在开发一个与蓝牙 LE 外围设备通信的应用程序。我目前正在测试的外围设备就是其中[之一](http://www.ti.com/tool/cc2540dk-mini)。有趣的是，有时当我发现它时，我会得到它的正确名称“SimpleBLEPeripheral”，有时我只是得到`(null)`. 似乎没有任何命令可以发送到 CBPeripheral 以强制读取更新名称，那么如何确保我真正获得了外设的广告名称？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-09-04T14:12:26.903

如果您从advertisingData NSDictionary 中获取名称，它将始终是外围设备发送的广告数据包中的名称。

但是，如果您阅读 CBPeripheral 对象的 name 属性，则该名称可能会有所不同。我们尝试提供当时已知的最佳名称。如果我们还没有连接到外围设备，我们将从广告包中提供名称。如果过去已经建立了与外围设备的连接，我们将读取 GAP 名称。我们认为 GAP 名称比广告包中的名称“更好”（由于广告包的大小限制）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-06-17T21:46:27.190

我发现解决此问题的唯一方法是开始扫描和停止扫描，最终我希望在物理空间中找到的所有设备都显示为非零名称和非零 UUID。

# iphone - iPhone Starter Kit 中的 Linkedin API 错误签名无效

> ID：12265035
> 
> 赞同：0
> 
> 时间：2012-09-04T13:54:23.050
> 
> 标签：iphone, api, oauth, linkedin, hmac

我尝试开箱即用地运行 OAuthStarterKit xcode 项目，输入正确的 api 密钥/秘密和 oauth 用户令牌/秘密。当我开始使用此代码进行授权时：

```
 OAMutableURLRequest *request = 
        [[[OAMutableURLRequest alloc] initWithURL:requestTokenURL
                                         consumer: self.consumer
                                            token: self.requestToken   
                                         callback:linkedInCallbackURL
                                signatureProvider:sha] autorelease]; 
```

它返回错误“signature_invalid”，这似乎表明签名不正确。明文和秘密混合了大小写字符，我不确定这会有所不同。

如果我使用

```
requestTokenURLString = @"https://api.linkedin.com/uas/oauth/requestToken?scope=r_basicprofile+r_emailaddress"; 
```

它返回无效的信号...但是如果我使用基本权限调用

```
requestTokenURLString = @"https://api.linkedin.com/uas/oauth/requestToken; 
```

它工作正常，但这意味着我只有基本的个人资料权限，我需要电子邮件地址之类的东西。

在测试控制台中输入所有相同的数据似乎在这里工作正常：

```
https://developer.linkedin.com/oauth-test-console 
```

任何人都知道我应该做什么，想什么，或者我应该去哪里看？更多日志信息：

```
oauth_problem=signature_invalid
oauth_problem_advice=com.linkedin.security.auth.pub.LoginDeniedInvalidAuthTokenException while obtaining request token for: POST https://api.linkedin.com/uas/oauth/requestToken/oauth_callback:hdlinked://linkedin/oauth 
oauth_consumer_key: XXX
oauth_nonce
oauth_signature_method: 3DHMACSHA1

2012-09-04 23:36:07.054 OAuthStarterKit[31952:c07] secret: TIDi9XXXXXXX
2012-09-04 23:36:07.054 OAuthStarterKit[31952:c07] base64EncodedResult: JXW6ZWUpXv7ba98o2hcUXodDhmg= 
```

我正在使用这里的代码示例[https://github.com/synedra/LinkedIn-OAuth-Sample-Client](https://github.com/synedra/LinkedIn-OAuth-Sample-Client)

编辑：如果没有人击败我，明天将试图深入了解并回答我自己的问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-05T11:31:55.920

在与 Linkedin API Beast 争论不休之后，我发现问题出在编码方式上，说来话长，在 OAuthLoginView.m 中的方法“requestTokenFromProvider”中，我需要将具有相关权限的参数“范围”包含在OARequestParameter 对象。

（基于 github repo -> [https://github.com/synedra/LinkedIn-OAuth-Sample-Client](https://github.com/synedra/LinkedIn-OAuth-Sample-Client)）

之后，无论您在哪里进行 api 调用（例如在 OAuthStarterKit 中），例如在 ProfileTabView::profileApiCall 中，您都可以像这样触发 URL 帖子： http://api.linkedin.com/v1/people/~ [:( id,first-name,last-name,industry](http://api.linkedin.com/v1/people/~:(id,first-name,last-name,industry) )"]; 或者如果您需要他们的电子邮件地址，它会出现（只要您有访问电子邮件的权限，您也可以像这样简单地获取它：

```
NSURL *url = [NSURL URLWithString:@"http://api.linkedin.com/v1/people/~:(id,first-name,last-name,industry,email-address)"]; 
```

请参阅下面的 URL 请求中使用 OARequestParameter 的代码...

```
- (void)requestTokenFromProvider
{
    OAMutableURLRequest *request = 
            [[[OAMutableURLRequest alloc] initWithURL:requestTokenURL
                                             consumer:self.consumer
                                                token:nil   
                                             callback:linkedInCallbackURL
                                    signatureProvider:nil] autorelease];

    [request setHTTPMethod:@"POST"];

    OARequestParameter * scopeParameter=[OARequestParameter requestParameter:@"scope" value:@"r_fullprofile r_contactinfo r_emailaddress"];

    [request setParameters:[NSArray arrayWithObject:scopeParameter]];

    OADataFetcher *fetcher = [[[OADataFetcher alloc] init] autorelease];
    [fetcher fetchDataWithRequest:request
                         delegate:self
                didFinishSelector:@selector(requestTokenResult:didFinish:)
                  didFailSelector:@selector(requestTokenResult:didFail:)];    
} 
```

为了更深入地使用linkedin的API，我将在我的博客上保留一些快速提示->http://techrantnz.blogspot.com.au/2012/09/the-linkedin-api-with-oauthstarterkit。 html

如果您想检查事情是否正常，请检查成功时调用的方法

```
- (void)profileApiCallResult:(OAServiceTicket *)ticket didFinish:(NSData *)data 
```

如果您输出响应正文，您可能会看到如下内容：

```
2012-09-05 21:40:55.109 OAuthStarterKit[12244:c07] profile: {
    emailAddress = "[my email]@gmail.com";
    firstName = Dave;
    id = XXXXXX;
    industry = "Information Technology and Services";
    lastName = "XXXXXXXX";
} 
```

# ios - 苹果加速框架——约束幅度而不损失绝对值

> ID：12265039
> 
> 赞同：2
> 
> 时间：2012-09-04T13:54:38.860
> 
> 标签：ios, accelerate-framework, vdsp

我想使用苹果的加速来有效地剪辑音频信号。如果信号大于1或小于-1，我想让它等于1或-1。`vDSP_vmaxmg`看起来这几乎就是我要找的东西，但不完全是。文档说它这样做：

*输出向量 C 的每个元素是来自输入向量 A 和 B 的对应值的幅值中较大的一个。*

所以看起来输出`vDSP_vmaxmg`总是输入的绝对值，总是正的。如果我想保留信号输出的绝对值但限制幅度，加速框架可以帮助我吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-04T13:58:58.037

你想要`vDSP_vclip( )`：

```
#include <Accelerate/Accelerate.h>

...

float min = -1.0f;
float max =  1.0f;
vDSP_vclip(inputBuffer, inputStride, &min, &max,
           outputBuffer, outputStride, length); 
```

# c# - 使用sql身份验证的sql连接字符串

> ID：12265047
> 
> 赞同：7
> 
> 时间：2012-09-04T13:54:58.527
> 
> 标签：c#, sql-server, sqlconnection

我正在使用这个 sql 连接字符串：

```
string connection = "data source=OSBORNECHARLES2;initial catalog=TWO;
integrated security=False;User ID=userid;Password=PWD"; 
```

我收到此错误：

> 与服务器成功建立连接，但在登录过程中出现错误。（提供者：共享内存提供者，错误：0 - 管道的另一端没有进程。）

如果我设置`integrated security=True;`它正在工作。
如果我使用另一个窗口用户登录，我会收到错误消息。

你能告诉我为什么我会收到这个错误。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2016-07-20T09:26:02.867

我想你能用这个吗

```
Data Source=myServerAddress;Initial Catalog=myDataBase;Integrated Security=SSPI;User ID=myDomain\myUsername;Password=myPassword; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-04T14:00:26.127

我将在这里冒险猜测。我假设您的 SQL 实例设置为仅允许 Windows\Integrated 登录。您在连接字符串中设置的 userid\password 仅用于 SQL 登录，您不能以这种方式传递另一个 Windows 用户。您似乎正在尝试使用连接字符串进行模拟。我希望它是那么简单。

因此，您可能需要在您的 sql 实例上启用混合模式安全性并为此用户创建 sql 登录名，或者您需要在应用程序中模拟该 windows 用户，然后使用集成安全性。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2017-03-23T18:17:29.827

我知道这是一个老问题，但是您使用的是哪个提供商。根据[这篇](https://stackoverflow.com/questions/1229691/difference-between-integrated-security-true-and-integrated-security-sspi) 文章，“SSPI”适用于 SQLClient 和 Oledb，而“true”/“false”仅适用于 SQLClient。

[这是](https://vathsalas.wordpress.com/2013/09/20/connect-sql-server-using-sql-server-authentication-in-c/)关于此主题的另一篇有用的帖子，其中解释了使用“SSPI”或“true”将导致它尝试使用当前用户的 Windows 凭据。

我同意其他一些评论。可能的原因是：1) 服务器上没有启用 SQL 身份验证。可以通过以下方式进行故障排除：尝试使用通过 SSMS 连接的 SQL auth 进行访问。如果它成功了，那么您就知道 SQL 身份验证已启用。2）您尝试登录失败的用户没有权限。一个。确保用户具有服务器主体。作为一项额外措施（尽管我认为这并不重要），请确保服务器主体与其默认数据库上的数据库主体相关联。

如果它是远程服务器，则需要启用所有必要的服务，这可以在 SQL Server 配置管理器中完成。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-10-07T09:42:16.533

### 我遇到了同样的问题以及我如何使用最后一个查询解决它。

我知道这是一个老问题，但如果新初学者被此错误触发，我会为他们发布答案。

不是每个人都使用 Windows 身份验证来访问他们的数据库或服务器，或者您想要访问的目标服务器可能只允许 SQL Server 身份验证。在这种情况下，我们只需要删除字符串的可信连接部分并将其替换为用户 ID 和密码：

```
select a.* from openrowset('SQLNCLI', 'Server=MYINSTANCE;UID=mySQLUser; PWD=*******;', 'select * from sys.databases') as a 
```

如果发生错误。将 SQLCLI 替换为 MSDASQL 并写入驱动程序名称 SQL Server。

```
select a.* from openrowset('MSDASQL', 'Driver={SQL SERVER}; Server=MYINSTANCE;UID=mySQLUser; PWD=*******;', 'select * from sys.databases') as a 
```

# multithreading - 在 gridview 集合中添加项目会使 gridview 消失

> ID：12265049
> 
> 赞同：1
> 
> 时间：2012-09-04T13:55:00.923
> 
> 标签：multithreading, xaml, gridview, mvvm, observablecollection

这是我的数据的样子：

*   一个名为**“视图”的视图**
*   一个名为**“ViewModel”**的视图模型被“View”用作数据源
*   名为**“listGroups”的“组”的 ObservableCollection**
*   名为**“listSms”的“Sms”的 ObservableCollection**
*   每个“组”都有自己的“listSms”

我的网格视图使用的 CollectionViewSource 来自“listGroups”，itemPath 是“listSms”

一切都显示得很好，当我尝试将新短信添加到组时，我的问题就开始了。如果我在“ViewModel”中添加短信，它工作正常，短信被添加，我在“View”上有动画和东西。

尽管我使用调度在 UI 线程中进行添加，但当位于“ViewModel”中的添加方法被另一个线程调用时，它不起作用。网格视图就消失了。

我认为这是一个线程问题，但我不知道为什么，也许用于添加的 CoreDispatcherPriority 不应该设置为 Normal ？

想到什么就开枪

谢谢

# asp.net-mvc - MVC Razor 中的重复布局

> ID：12265060
> 
> 赞同：0
> 
> 时间：2012-09-04T13:55:33.970
> 
> 标签：asp.net-mvc, razor

是否可以使用 MVC 机制来创建可重复的布局？例如：我们在整个节目中都有 HTML 片段，它们必须具有相同的元素和属性，但可以有单独的内容（内容也可以是一堆 HTML）。

我倾向于 HTML 助手，但这似乎不允许这样的事情：

```
@Html.Business(Name, Attr2)
{
    <em>Do Not Contact</em>
    <p>Arbitrary text</p>
}
@Html.Business(Name, Attr2)
{
    <table>...</table>
} 
```

这里的关键点是嵌入的 HTML 是任意的，并且没有可用于 Helper 方法的参数。

谢谢， 雅克

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-04T14:22:18.850

您正在混淆布局和模板。布局是一个基本框架，用作所有视图的公共容器。模板（您应该寻找的）是一种显示特定（通常是特定）类型数据的方式。

有两种实现模板的基本方法。

* * *

第一个是将其定义为默认模板。这是通过一个简单的命名约定来完成的。只需确保您的 .cshtml 文件与您的实体类名称具有相同的名称并将其放在：

> /Views/Shared/DisplayTemplates/.cshtml

之后，每当您想使用模板显示实体时，请使用`@Html.DisplayFor()`帮助程序，相应地提供您的对象。

或者，如果您希望以不同的方式调用模板或不希望在每种情况下都使用模板，您可以使用`[UIHint("TemplateName")]`实体上的属性或在 DisplayFor() 中传递模板名称来指定模板名称。

* * *

第二种方法是使用局部视图。您可以创建您希望如何显示数据和使用的部分视图`@Html.RenderPartial("TemplateName", object)`

* * *

在这两种情况下，都可以使用 VS 界面轻松创建 Template / Partial 视图：

*   右键单击要在其中创建模板的 DisplayTemplate（或其他位置）文件夹，然后单击`Add>View...`
*   输入名称，检查`Create a strongly-typed view`
*   选择合适的物件（如果找不到，以后可以手动做，但我建议至少选点东西来简化工作）
*   选择`Details`作为脚手架模板
*   选中该`Create as partial view`框
*   取消选中`Use a layout or master page`

确保`@model <Entity Name>`与您将传递的对象匹配，然后对它的显示方式进行任何修改。

享受！

-**编辑**-

注意：再次阅读您的帖子后，我意识到这可能不是您所要求的，但还不清楚。您能否更详细地解释您要达到的目标，而不是您要**如何**做到这一点？

您编写的代码片段实际上没有意义。

# php - 缓慢删除参考

> ID：12265061
> 
> 赞同：0
> 
> 时间：2012-09-04T13:55:37.263
> 
> 标签：php, arrays, reference

我有大量的数组。出于我的脚本的目的，我正在创建另一个数组，其中包含对这个巨大数组中特定数组的引用。

```
$table1 = array();
$table1[] = array(1,2,3,4,5); // imagine here 10 000 elements
$table1[] = array(1,2,3,4,5);
$table1[] = array(1,2,3,4,5);

for($i=1;$i< 100;$i++)
{
$table2 = array();  // this line takes 0.04 second
$table2[] = &$table1[0];
$table2[] = &$table1[1];
} 
```

当我如上所述清除 table2 时，需要 0.04 秒。
我在这里迭代 100 次或更多，每次都创建 table2（使用一些算法来选择子数组 - 未显示），这需要太多时间。有没有办法更快地做到这一点？为什么 PHP 需要 0.04 秒来清理小数组的引用？

# actionscript-3 - 将 AS3 代码从鼠标转换为 ios Touch 事件

> ID：12265064
> 
> 赞同：0
> 
> 时间：2012-09-04T13:55:43.553
> 
> 标签：actionscript-3, flash, box2d

我已经编写了一些代码来开始我的游戏，我现在想将控件从鼠标更改为触摸事件，以便我可以在我的 ipad 上使用它。

下面的代码是我已经走了多远，但我不知道如何改变它以使用触摸和拖动

```
package {
    import flash.display.Sprite;
    import flash.events.Event;
    import flash.events.MouseEvent;
    import flash.events.TouchEvent;
    import flash.ui.Multitouch;
    import flash.ui.MultitouchInputMode
    import Box2D.Dynamics.*;
    import Box2D.Collision.*;
    import Box2D.Collision.Shapes.*;
    import Box2D.Common.Math.*;
    import Box2D.Dynamics.Joints.*;

    public class Main extends Sprite {

        private var world:b2World;
        private var worldScale:Number = 30;
        private var mouseJoint:b2MouseJoint;
        Multitouch.inputMode=MultitouchInputMode.TOUCH_POINT;       

        var myBlock:Array = new Array(
            new Block(),
            new Block(),
            new Block()
        );

        public function Main() {

            addChild(myBlock[0]);
            addChild(myBlock[1]);
            addChild(myBlock[2]);

            world = new b2World(new b2Vec2(0,9.81),true);
            debugDraw();
            var bodyDef:b2BodyDef=new b2BodyDef();
            bodyDef.position.Set(320/worldScale,470/worldScale);

            var polygonShape:b2PolygonShape=new b2PolygonShape();
            polygonShape.SetAsBox(320/worldScale,10/worldScale);

            var fixtureDef:b2FixtureDef=new b2FixtureDef();
            fixtureDef.friction = 1;
            fixtureDef.restitution = 0.5;
            fixtureDef.shape = polygonShape;
            var groundBody:b2Body = world.CreateBody(bodyDef);
            groundBody.CreateFixture(fixtureDef);

            for (var i:int=0; i<3; i++) {
                createBox(Math.random()*500+70,400,b2Body.b2_dynamicBody);
                var targetBox:TargetBox=new TargetBox();
                addChild(targetBox);
                targetBox.x = 220 + i * 100;
                targetBox.y = 180;
            }

            addEventListener(Event.ENTER_FRAME,updateWorld);

            stage.addEventListener(TouchEvent.TOUCH_BEGIN, createJoint); 
        }
        private function createBox(pX:Number,pY:Number,type:int):void {
            var bodyDef:b2BodyDef=new b2BodyDef();
            bodyDef.position.Set(pX/worldScale,pY/worldScale);
            bodyDef.type = type;
            var polygonShape:b2PolygonShape=new b2PolygonShape();
            polygonShape.SetAsBox(30/worldScale,30/worldScale);
            var fixtureDef:b2FixtureDef=new b2FixtureDef();
            fixtureDef.shape = polygonShape;
            fixtureDef.density = 1;
            fixtureDef.friction = 0.5;
            fixtureDef.restitution = 0.2;
            var box:b2Body = world.CreateBody(bodyDef);
            box.CreateFixture(fixtureDef);
        }
        private function createJoint(e:TouchEvent):void {
            world.QueryPoint(queryCallback,mouseToWorld());
        }
        private function queryCallback(fixture:b2Fixture):Boolean {
            var touchedBody:b2Body = fixture.GetBody();
            if (touchedBody.GetType() == b2Body.b2_dynamicBody) {
                var jointDef:b2MouseJointDef=new b2MouseJointDef();
                jointDef.bodyA = world.GetGroundBody();
                jointDef.bodyB = touchedBody;
                jointDef.target = mouseToWorld();
                jointDef.maxForce = 1000 * touchedBody.GetMass();
                mouseJoint = world.CreateJoint(jointDef) as b2MouseJoint;
                stage.addEventListener(TouchEvent.TOUCH_MOVE, moveJoint);

                stage.addEventListener(TouchEvent.TOUCH_END, finish); 
                stage.addEventListener(TouchEvent.TOUCH_END,killJoint);
            }
            return false;
        }
        private function moveJoint(e:TouchEvent):void {
            mouseJoint.SetTarget(mouseToWorld());
        }
        private function killJoint(e:TouchEvent):void {
            world.DestroyJoint(mouseJoint);
            mouseJoint = null;
            stage.removeEventListener(TouchEvent.TOUCH_MOVE,moveJoint);
            stage.removeEventListener(TouchEvent.TOUCH_END,killJoint);
            stage.removeEventListener(TouchEvent.TOUCH_END,finish);

        }
        private function mouseToWorld():b2Vec2 {
            return new b2Vec2(mouseX/worldScale,mouseY/worldScale);
        }
        private function debugDraw():void {
            var debugDraw:b2DebugDraw=new b2DebugDraw();
            var debugSprite:Sprite=new Sprite();
            addChild(debugSprite);
            debugDraw.SetSprite(debugSprite);
            debugDraw.SetDrawScale(worldScale);
            debugDraw.SetFlags(b2DebugDraw.e_shapeBit|b2DebugDraw.e_jointBit);
            debugDraw.SetFillAlpha(0.5);
            world.SetDebugDraw(debugDraw);
        }
        private function finish(e:TouchEvent):void {
            for (var b:b2Body=world.GetBodyList(); b; b=b.GetNext()) {
                for (var i:int=0; i<3; i++) {
                    var distX:Number = b.GetPosition().x * worldScale - (220 + i * 100);
                    var distY:Number = b.GetPosition().y * worldScale - 180;

                    if (distX*distX+distY*distY<900 && b.GetType()==b2Body.b2_dynamicBody) {

                    world.DestroyBody(b);
                    createBox(220 + i * 100,180,b2Body.b2_staticBody);
                    }   

                }
            }

        }

        private function updateWorld(e:Event):void {
            world.Step(1/30,10,10);
            world.ClearForces();

                var m=0;
                for (var b:b2Body=world.GetBodyList(); b; b=b.GetNext()) {
                    if (m==3) {m=0;}
                    var distX:Number = b.GetPosition().x * worldScale - (220 + m * 100);
                    var distY:Number = b.GetPosition().y * worldScale - 180;

                    if (b.GetType()==b2Body.b2_dynamicBody) {
                        myBlock[m].x = distX + (220 + m * 100);
                        myBlock[m].y = distY + 180;
                        myBlock[m].rotation = b.GetAngle() * 180 / Math.PI;

                    }

                    m++
                }

            world.DrawDebugData();
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-04T22:10:02.797

所有标准光标和鼠标事件都应转换为触摸屏。障碍是当您开始使用多点触控时，但浏览您的代码时，您似乎还没有任何实际需要多点触控数据的东西。我不确定 box2d 库是否需要多点触控支持而不是常规鼠标事件，但您的错误可能来自那些调用“触摸”相关变量的库，该变量可能尚未创建，也可能尚未创建，具体取决于您所在的位置游戏。您实际上是否关心多重支持以及您遇到的错误究竟是什么？

# python - 返回值超出 sys.exit 默认间隔 [0-127]

> ID：12265067
> 
> 赞同：1
> 
> 时间：2012-09-04T13:55:48.813
> 
> 标签：python, return-value, exit

有没有办法从一个简单的python脚本中退出任意值？实际上，我想返回一个端口号。我也在这里和文档中阅读过，但只找到了解决方法......

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-04T13:58:32.907

unix`exit`代码是一个**字节**。大于 >127 的值被保留。不，您不能通过此 hack 可靠地传递端口号。你为什么不把它**打印到标准输出**并解析那个输出呢？

[https://www.gnu.org/software/libc/manual/html_node/Exit-Status.html](https://www.gnu.org/software/libc/manual/html_node/Exit-Status.html)

> 一般约定为特殊目的保留状态值 128 及以上。特别地，值 128 用于指示在子进程中执行另一个程序失败。这个约定并不是普遍遵守的，但是在你的程序中遵循它是一个好主意。
> 
> [...]状态值被截断为八位

# shopify - 我的应用程序如何修改商店的模板文件

> ID：12265070
> 
> 赞同：3
> 
> 时间：2012-09-04T13:55:51.533
> 
> 标签：shopify

安装我的应用程序时，我需要将液体标记注入商店的主题模板。我知道有 ScriptTags，但它们会加载脚本。而且我知道脚本可以更改页面的 DOM。但我需要将我的液体安装到产品详细信息页面。是否可以？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-04T14:13:38.967

我会将您的 Liquid 添加为新的片段资产。然后可以指示商家将您提供给他们的 Liquid 包含语句粘贴到他们的产品 Liquid 脚本中。

那是相当干净的。否则，您的应用程序可以下载他们的产品 Liquid 脚本，对其进行编辑，然后将其添加到商店作为替代模板。然后，您可以指示商家使用替代模板呈现他们的产品。

我相信还有其他可能性。

# regex - 正则表达式将整个单词与其中的 html 元素匹配

> ID：12265075
> 
> 赞同：1
> 
> 时间：2012-09-04T13:56:14.107
> 
> 标签：regex

我正在尝试匹配其中也包含 html 元素的字符串中的主题标签。

所以我想匹配 # 然后回到第一个非单词字符，除非该非单词字符在 html 元素中，在这种情况下继续。

我从`#[\w]*`基本案例开始，然后尝试排除标签，`#[\w]*(?!([^<]+)?|>)`但我没有得到任何乐趣。

**例子**

`First #Match1 tag then another #Mat<span class="tag"></span>ch2, #<span class="tag"></span>Match3.`

**火柴**

`#Match1`

`#Mat<span id="selectionBoundary"></span>ch2`

`#<span id="selectionBoundary"></span>Match3`

不幸的是，我无法剥离 html 元素，并且匹配项应该包含该元素。

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-04T14:05:52.330

看起来`#([\w]|(<[^>]+>))*`会做这项工作

# android - 画廊 OnActivityResult 在 TabActivity 中不起作用

> ID：12265080
> 
> 赞同：3
> 
> 时间：2012-09-04T13:56:39.460
> 
> 标签：android, android-intent, android-camera, android-gallery, android-tabactivity

我的代码有问题，我正在尝试从图库中获取图像并将其显示在我的 xml 布局上**（问题是当我单击按钮时它会进入图库，但是当我选择一张图片时它只是转到另一个选项卡)**

1）我创建标签的主类

```
public class MainUser extends TabActivit 
  .....

TabSpec tabSpec10 = mTabHost.newTabSpec("tab_test1");
        tabSpec10.setIndicator("Report incident ");
        Context ctx10 = this.getApplicationContext();
        Intent i10 = new Intent(ctx10, ucrimereport.class);
        tabSpec10.setContent(i10);
        mTabHost.addTab(tabSpec10); 
```

2）这是我正在制作和调用画廊的课程

```
public class ucrimereport extends Activity implements OnClickListener,OnItemSelectedListener {
    private static final int IMAGE = 1;

@Override   

    public void onCreate(Bundle savedInstanceState) 
    {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.ureport);
.........
         gallary = (ImageButton)findViewById(R.id.sdpic_button);

gallary.setOnClickListener(new OnClickListener() {
        public void onClick(View v) {
            // gallary
            Intent gallery = new Intent(Intent.ACTION_PICK,android.provider.MediaStore.Images.Media.INTERNAL_CONTENT_URI);
            startActivityForResult(gallery, IMAGE);

        }
    });

@Override
    protected void onActivityResult(int requestCode, int resultCode, Intent data) {
      super.onActivityResult(requestCode, resultCode, data);

      if(resultCode==RESULT_OK && requestCode==IMAGE){
       Uri selectedImage=data.getData();
       String path=getPath(selectedImage);

       Bitmap bitmapImage=BitmapFactory.decodeFile(path);
       //ImageView image=(ImageView)findViewById(R.id.image);
       image.setImageBitmap(bitmapImage);

      }
    }

    public String getPath(Uri uri){
      String[] filePathColumn={MediaStore.Images.Media.DATA};

      Cursor cursor=getContentResolver().query(uri, filePathColumn, null, null, null);
      cursor.moveToFirst();
      int columnIndex=cursor.getColumnIndex(filePathColumn[0]);

      return cursor.getString(columnIndex);
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-06T10:52:28.213

请尝试该代码。

```
public class ImageGalleryDemoActivity extends Activity {    
    private static int RESULT_LOAD_IMAGE = 1;

    /** Called when the activity is first created. */
    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);

        Button buttonLoadImage = (Button) findViewById(R.id.buttonLoadPicture);
        buttonLoadImage.setOnClickListener(new View.OnClickListener() {

            @Override
            public void onClick(View arg0) {

                Intent i = new Intent(
                        Intent.ACTION_PICK,
                        android.provider.MediaStore.Images.Media.EXTERNAL_CONTENT_URI);

                startActivityForResult(i, RESULT_LOAD_IMAGE);
            }
        });
    } 
    @Override
    protected void onActivityResult(int requestCode, int resultCode, Intent data) {
        super.onActivityResult(requestCode, resultCode, data);

        if (requestCode == RESULT_LOAD_IMAGE && resultCode == RESULT_OK && null != data) {
            Uri selectedImage = data.getData();
            String[] filePathColumn = { MediaStore.Images.Media.DATA };

            Cursor cursor = getContentResolver().query(selectedImage,
                    filePathColumn, null, null, null);
            cursor.moveToFirst();

            int columnIndex = cursor.getColumnIndex(filePathColumn[0]);
            String picturePath = cursor.getString(columnIndex);
            cursor.close();

            ImageView imageView = (ImageView) findViewById(R.id.imgView);
            imageView.setImageBitmap(BitmapFactory.decodeFile(picturePath));
        }
    }
} 
```

# ios - object_setInstanceVariable 与 CGPoint

> ID：12265083
> 
> 赞同：3
> 
> 时间：2012-09-04T13:56:57.947
> 
> 标签：ios, iphone, iphone-privateapi

有谁知道如何使用 object_setInstanceVariable 设置结构变量？它适用于引用类型：

```
object_setInstanceVariable(obj, "_variable", ref); 
```

但不适用于 CGPoint 等结构。尝试了以下方法：

```
1\. object_setInstanceVariable(obj, "_variable", point);
2\. object_setInstanceVariable(obj, "_variable", &point);
3\. object_setInstanceVariable(obj, "_variable", (void **)&point); 
```

我不确定我是否理解我在做什么（尤其是最后一步）......

提前谢谢你！！！

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-09-04T14:29:19.927

`object_setInstanceVariable`并且`object_getInstanceVariable`实际上应该仅用于对象（尽管接口声明似乎另有说明）。您不应该将它们用于内置函数。

更合适的方法是使用`class_getInstanceVariable`and `ivar_getOffset`。

例如...

```
static void* getIvarPointer(id object, char const *name) {
    Ivar ivar = class_getInstanceVariable(object_getClass(object), name);
    if (!ivar) return 0;
    return (uint8_t*)(__bridge void*)object + ivar_getOffset(ivar);
} 
```

那里的转换基本上将对象指针转换为指向字节的指针，因此可以将其添加到偏移量（这为我们提供了指向 iVar 的指针）。我们必须通过`void*`第一个，因为 ARC 不允许直接转换为`uint8_t*`.

它的用途可以这样证明......

```
@implementation Foo {
    CGRect _rect;
}

- (CGRect*)rectPointer {
    CGRect *ptr = getIvarPointer(self, "_rect");
    NSAssert(ptr == &_rect, @"runtime discovered pointer should be same as iVar pointer");
    return ptr;
} 
```

现在，您有办法获取任何 iVar 的指针......只需`void*`适当地转换返回的值。

顺便说一句，我一般不建议这样做，但像任何工具一样，运行时函数也有用途。

哎呀。忘记显示设置值...

```
CGRect *rectPtr = getIvarPointer(someObject, "_rect");
if (rectPtr) {
    *rectPtr = CGRectMake(1, 2, 3, 4);
} else {
    // Handle error that the ivar does not exist...
} 
```

**编辑**

> 对不起，还不是很清楚。我应该得到这个类型（CGRect*）然后将它传递给object_setInstanceVariable吗？另外，我有一个错误“未定义的符号“_getIvarPointer”” - 请让我知道我应该包含什么 H 文件 – Dmitry

不，您根本不应该使用`object_setInstanceVariable`。它应该仅用于作为对象的实例变量。你的是一个 CGRect，所以你根本不应该使用那个函数。

像最后一个例子一样使用它。也许这个更清楚一点（取自您的示例）。

而不是像您提出的问题那样做：

```
object_setInstanceVariable(obj, "_variable", point); 
```

做这个...

```
// Get a pointer to the instance variable.  Returns NULL if not found.
CGPoint *pointPtr = getIvarPointer(obj, "_variable");
if (pointPtr) {
    // Now, assign to the point, by de-referencing the pointer.
    *pointPtr = point;
} 
```

请注意，我将`getIvarPointer`函数定义为`static`具有文件本地范围。它不是苹果提供的函数——你必须编写它。如果您要在多个地方使用它，您需要删除它`static`以便链接器可以找到它。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-09-04T15:15:02.157

好的，我找到了答案。我看看SELF地址和变量地址之间的区别：

```
NSLog(@"%d",self);
NSLog(@"%d",&variable); 
```

例如差异是 24 - 然后我编写以下代码：

```
CGPoint *variable = (int)self + 24;
*variable = myCGPoint; 
```

我什至无法解释它有多脏！！！但它有效:)

感谢乔迪的帮助，我对你的回答竖起了大拇指

# mysql - MYSQL 双重嵌套 SELECT

> ID：12265090
> 
> 赞同：0
> 
> 时间：2012-09-04T13:57:17.930
> 
> 标签：mysql, database, select

我有一个“双重”嵌套的 SELECT 语句。更深层次的语句提取了我尝试插入现有行的每月总计所需的值。但是，每个“段”都有不同的百分比，因此它会导致多行。为了解决这个问题，我有一个外部选择，然后对结果进行 SUM。

更多问题是我无法将结果与月份匹配，因为当我尝试链接到列名称“Enrol_month_short”时，我收到以下消息。

“‘where 子句’中的未知列‘Enrol_month_short’”

```
SELECT Date_format(tbl_client_details.cd_enrol_date, '%b %y')AS 
       Enrol_month_short, Sum(tbl_revenue.rev_value) AS 
       Enrol_Cum_Rev, (SELECT Sum(tbl_revenue.rev_value) 
       FROM tbl_client_details 
       LEFT OUTER JOIN gridlock.tbl_revenue 
       ON tbl_client_details.cd_zbi_no = tbl_revenue.rev_zbi_no 
       AND tbl_client_details.cd_ucn = tbl_revenue.rev_ucn 
       WHERE ( Date_format(tbl_client_details.cd_enrol_date, '%b %y') = 
       enrol_month_short ) 
       AND ( Date_format(rev_month, '%b %y') = enrol_month_short ) 
       GROUP  BY Date_format(tbl_client_details.cd_enrol_date, '%b %y')) AS 
       New_client_rev, 
       (SELECT Count(tbl_client_details.cd_id) 
       FROM   tbl_client_details 
       WHERE  ( tbl_client_details.cd_enrol_date >= '2012-04-01' 
                AND tbl_client_details.cd_enrol_date <= '2012-07-31' ) 
                AND Date_format(tbl_client_details.cd_enrol_date, '%b %y') = 
                enrol_month_short 
       GROUP  BY Date_format(tbl_client_details.cd_enrol_date, '%b %y')) AS 
       Actual_Enrols, 
       (SELECT ( ( Sum(tbl_revenue.rev_value) * 
               ( tbl_segment.seg_growth_2012 / 100 ) ) / 12 ) AS YEAR_NEW_BUS_BUDGET 
       FROM tbl_client_details 
       LEFT OUTER JOIN tbl_revenue 
       ON tbl_client_details.cd_zbi_no = tbl_revenue.rev_zbi_no 
       AND tbl_client_details.cd_ucn = tbl_revenue.rev_ucn 
       LEFT OUTER JOIN tbl_segment 
       ON tbl_client_details.cd_segment = tbl_segment.seg_name 
       WHERE ( rev_month >= '2012-04-01' AND rev_month <= '2012-07-31' ) 
       GROUP  BY enrol_month_short)                                      AS 
       YEAR_NEW_BUS_BUDGET 
       FROM tbl_client_details 
       LEFT OUTER JOIN gridlock.tbl_revenue 
       ON tbl_client_details.cd_zbi_no = tbl_revenue.rev_zbi_no 
       AND tbl_client_details.cd_ucn = tbl_revenue.rev_ucn 
       WHERE ( tbl_client_details.cd_enrol_date >= '2012-04-01' 
       AND tbl_client_details.cd_enrol_date <= '2012-07-31' ) 
       AND ( rev_month >= '2012-04-01' 
       AND rev_month <= '2012-07-31' 
       OR rev_month = NULL ) 
       GROUP BY enrol_month_short 
       ORDER BY tbl_client_details.cd_enrol_date; 
```

# mysql - 数据库设计 - 一个表或多个表/连接

> ID：12265091
> 
> 赞同：1
> 
> 时间：2012-09-04T13:57:21.550
> 
> 标签：mysql, database, database-design

我有一个现有的数据库，其结构如下：

```
user
user_profile
user_permissions
user_statistics 
```

每个表都有一个唯一的列，用于将每个表连接在一起，如下所示：

```
SELECT *
FROM user
INNER JOIN user_profile ON user.user_id = user_profile.user_profile_id
INNER JOIN user_permissions ON user.user_id = user_permissions.user_permissions_id
INNER JOIN user_statistics ON user.user_id = user_statistics.user_statistics_id
WHERE user_id = 1 
```

以这种方式做事有什么问题，还是更好的做法是创建一个包含很多列的表，这样就不需要连接？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-04T14:03:03.313

这是一个经典的数据库设计；它被称为“[规范化](http://en.wikipedia.org/wiki/Database_normalization)”，通常被认为是最佳实践。

对数据库进行非规范化是有原因的——性能是经典。然而，这通常是以牺牲可维护性和一致性为代价的。它通常只在数据大小的极端情况下才有意义 - 您描述的模式应该扩展到大量记录，而连接不会成为问题。

我还猜测链接到“用户”的几个表对于给定用户有不止一条记录——“统计”通常对给定用户有很多行；权限也可以有一行代表每个用户的权限。在一个大表中建模将是可怕的。

一些设计者喜欢为逻辑上分离的数据创建单独的表。因此，您的设计可能包括一个“user_profile”表，每个用户只有一行，因为设计者认为这在逻辑上与“用户”数据是分开的——例如，它在不同的业务环境下会发生变化。在我看来，这主要是风格问题。

在这种情况下，连接不会使您的数据库变慢 - 关系数据库的重点是在管理这种情况时非常有效（“关系”是指数据可以关联的事实）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-04T14:04:22.847

最好使数据库具有关系，因为它是。这种结构将消除数据异常的风险，并为规模和领域细节的变化做好准备（即当您添加一种新的权限时会发生什么？）

JOIN 是数据库工作的自然组成部分，而且非常高效。

为什么这是良好实践的具体细节被汇总到我们所说的[数据库规范化中](http://en.wikipedia.org/wiki/Database_normalization)

# iphone - UISearchBar + UITableView

> ID：12265093
> 
> 赞同：1
> 
> 时间：2012-09-04T13:57:26.663
> 
> 标签：iphone, ios

我是 ios 新手，但我无法在任何地方找到答案。我有一个 UITableView 显示产品。在 HeaderView 中，我得到了一个 UISearchBar。这个想法是，您可以使用 SearchBar 过滤 TableView 中的行。我不想/不能使用 SearchBar 位于顶部的“TableView”，所以我用`searchDisplayController.searchResultsTableView.hidden = YES;`. 这有效，行被过滤，用户可以单击所需的元素。

问题是我的 TableView 不再可滚动了！我怎样才能避免这种情况？我`self.tableView.scrollEnabled = YES;`在 searchBarTextDidBeginEditing 中设置。

视觉演示：[http ://d.pr/i/vqiK](http://d.pr/i/vqiK)

谢谢你的帮助。

我如何将 SearchBar 添加到 TableView：

```
searchBar = [[UISearchBar alloc] initWithFrame:CGRectMake(0, 0, SEARCHBAR_WIDTH_EXPAND, SEARCHBAR_HEIGHT)];

searchDisplayController = [[UISearchDisplayController alloc] initWithSearchBar:searchBar contentsController:self];

self.tableView.tableHeaderView = searchBar;

searchBar.delegate = self; 
```

# json - 在 SalesForce 文本字段中存储 JSON 数组

> ID：12265095
> 
> 赞同：1
> 
> 时间：2012-09-04T13:57:26.863
> 
> 标签：json, salesforce, apex-code

我需要在 SFDC 中存储关于我每个帐户的一些日常数据（过去一个月）。数据相对较小（每个帐户每天一个整数），我想知道是否可以将本月的数组转换为 JSON 并将其存储在帐户对象的文本字段中，或者我需要创建一个自定义反对存放这些数据？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-04T20:32:12.120

您当然可以在帐户上创建一个自定义文本区域（长）字段，假设您计划保持在该字段的 32k 限制内。要考虑的事情是通过首先删除所有空格来使您的 JSON 变得不漂亮：

```
str = str.replace(' ', ''); 
```

此方法还假定每次写入都会完全覆盖您上次保存的 JSON。如果您想保留这些的历史记录，那么可能需要一个相关的（查找）自定义对象。

仅供参考 - [salesforce.stackexchange.com](https://salesforce.stackexchange.com/)现在处于实时测试阶段，它是回答此类问题的好地方。

# html - css3动画在chrome中不起作用

> ID：12265096
> 
> 赞同：25
> 
> 时间：2012-09-04T13:57:27.193
> 
> 标签：html, css, css-animations

我有一个在 Firefox 中工作的小动画，但在 webkit 浏览器中没有。也许有人看到了错误，因为我已经找了一个小时......它是 impress.js 演示文稿的一部分，类似于 prezi。谢谢！

CSS：

```
#its.step.present h5{

display: inline-block;
position:absolute;

 animation: aia2 5s linear infinite alternate;
 -moz-animation: aia2 5s linear infinite alternate;
 -webkit-animation: aia2 5s linear infinite alternate;
 -ms-animation: aia2 5s linear infinite alternate;
 -o-animation: aia2 5s linear infinite alternate;

-moz-animation-delay: 4s;
-webkit-animation-delay: 4s;
-ms-animation-delay: 4s;
-o-animation-delay: 4s;
animation-delay: 4s;

}
@-moz-keyframes aia2{
    0%{

        left:120px;
        -moz-transform:scale(1) rotate(0deg);
        -webkit-transform:scale(1) rotate(0deg);
        -ms-transform:scale(1) rotate(0deg);
        -o-transform:scale(1) rotate(0deg);
        transform:scale(1) rotate(0deg);

        color: red;
    }
    90%{
        left: 580px;

        -moz-transform:scale(1) rotate(2000deg);
        -webkit-transform:scale(1) rotate(2000deg);
        -ms-transform:scale(1) rotate(2000deg);
        -o-transform:scale(1) rotate(2000deg);
        transform:scale(1) rotate(2000deg);

    }
    100%{
        left: 580px;

    }
} 
```

html:

```
<div id="its" class="step" data-x="850" data-y="3000" data-rotate="90" data-scale="5">
        <p>
            <ul>
                <li>Web Development,</li>
                <li>Web Design,</li>
                <li>Log<h5>o</h5>&nbsp;&nbsp; Design,</li> 
                <li>Web Marketing,</li>
            </ul>

            <ul class="doua">
                <li><h6>e</h6>&nbsp;&nbsp;Commerce,</li>
                <li>CMS (WP, J, D),</li> 
                <li>Cust&nbsp; m Apps</li> 
                <li>and others.</li>
            </ul>
        </p>
    </div> 
```

* * *

## 回答 #1

> 赞同：56
> 
> 时间：2012-09-04T14:07:59.130

您必须将一般动画规则放在浏览器特定规则**之后：**

```
-webkit-animation: aia2 5s linear infinite alternate;
   -moz-animation: aia2 5s linear infinite alternate;
    -ms-animation: aia2 5s linear infinite alternate;
     -o-animation: aia2 5s linear infinite alternate;
        animation: aia2 5s linear infinite alternate; /* this comes last */ 
```

既然你有`-webkit-animation: aia2`，`-moz-animation: aia2`等等，你必须为每个浏览器设置动画，比如：

```
@-moz-keyframes aia2{
    ...
}

@-webkit-keyframes aia2{
    ...
}
@-o-keyframes aia2{
    ...
} 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2015-06-26T18:20:22.177

Chrome v43 删除了动画的 -webkit- 前缀，所以如果这在以前有效但现在无效，这可能就是原因。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2020-09-10T17:04:31.160

检查您是否在 Firefox 中开发的一件事是 Firefox 将使用引号中的动画名称，但 Chrome/Edge/Safari/Webkit 不会。

**仅在 Firefox 中可接受：**

```
animation-name: 'theAni'; 
```

**适用于所有浏览器（Chrome、Edge、Safari 和 Firefox）：**

```
animation-name: theAni; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-02-09T19:00:33.897

对于您要添加动画的每个属性，您首先需要确定其值，然后您可以在关键帧中更改它。

这是一个简单的代码，您可以尝试一下：

```
 <!DOCTYPE html>
 <head>
      <style>
           #forTest {
                display: inline-block;
                background-color: darkcyan;
                width: 500px; /* here we determine the value of property that we want add animation */
                height: 30px;

                animation: a1;
                animation-fill-mode: forwards;
                animation-duration: 5s;
           }

           @keyframes a1{
                to {
                     width: 100px;
                }
           }
      </style>
 </head>
 <body>
      <div id="forTest"></div>
 </body>
 </html> 
```

# database - 使用 DB2 Remote Load 的优缺点

> ID：12265098
> 
> 赞同：0
> 
> 时间：2012-09-04T13:57:34.187
> 
> 标签：database, db2, remote-access

[使用DB2 Remote Load](http://publib.boulder.ibm.com/infocenter/db2luw/v8/index.jsp?topic=/com.ibm.db2.udb.doc/core/r0008305.htm "查看客户端选项")（使用远程客户端加载）而不是 DB2 Direct 加载（不使用此 CLIENT 选项）有哪些优点和缺点？
通过使用 DB2 直接加载，我们还可以加载位于远程的 DB2 服务器。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-04T19:40:27.810

`LOAD CLIENT`通过网络将您的数据从客户端计算机传输到数据库服务器。如果没有该`CLIENT`选项，该`LOAD`实用程序必须使该文件在数据库服务器上可用。

通过网络加载可能会牺牲一些原始性能，但您的优势是不需要先将文件传输到数据库服务器。

# netbeans - netbeans 同步服务器 -> 自动本地

> ID：12265101
> 
> 赞同：1
> 
> 时间：2012-09-04T13:57:44.140
> 
> 标签：netbeans, webserver, sync

我一直在通过 Netbeans 7.1 版在远程服务器上编写和管理网站脚本。我使用 2 台不同的客户端计算机来执行此操作（一台 Windows 7 和一台 Ubuntu）。我遇到的问题是从一台客户端机器切换到另一台机器时，客户端上的文件系统不一样。

例如，假设我们有客户端 #1 和客户端 #2。

客户端 #1 文件同步到服务器：

```
file#1
file#2
file#3 
```

我去客户端＃2并从服务器下载所有文件：

客户端 #2 和服务器：

```
file#1
file#2
file#3 
```

现在我从自动同步到服务器的客户端 2 中删除文件#2。

客户端 #2 和服务器：

```
file#1
file#3 
```

当我回到客户端#1 并从服务器下载更新的文件时，我下载了文件#1 和文件#3，因为这些是服务器上剩下的唯一文件。我从未从客户端#1 中删除文件#2，所以客户端#1 仍然看起来像这样：

客户#1

```
file#1
file#2
file#3 
```

**这是问题所在，**因为现在客户端#1 和服务器上的文件系统不同。

显然只有一个文件，这没什么大不了的。但是由于有数百个文件，并且可能在返回客户端#1 之前在客户端#2 上工作了几个月，手动比较来自客户端的每个文件与服务器上的文件可能会变得单调乏味。

有没有办法可以将服务器文件同步到本地，它会从客户端删除服务器上不存在的所有文件？

谢谢

# java - 序列化 FacesContext 或如何在服务器重启后获取属性值

> ID：12265102
> 
> 赞同：0
> 
> 时间：2012-09-04T13:57:44.343
> 
> 标签：java, jsf, serialization, tomcat7, facescontext

**问题如下：**我需要序列化用户会话，因此，在服务器重新启动后它仍然存在。

使用 JavaEE 和 Tomcat 7 可以正常工作`implements Serializable`，但问题是`FacesContext`. 确实，在重新启动服务器后，`FacesContext.getCurrentInstance()`返回`null`，因此我无法访问消息包（因此我`message.properties`再也找不到了）。

`FacesContext`那么，重启Tomcat时如何保留？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-01T11:29:54.113

Your problem description is unclear, but the symptoms suggest that you're trying to get hold of the current instance of the `FacesContext` anywhere as an instance variable. You shouldn't do that at all, you should always get the current instance in the local method scope.

So, you should **never** do e.g.

```
private FacesContext context;

public Bean() {
    context = FacesContext.getCurrentInstance();
}

public void someMethod() {
    context...doSomething();
} 
```

but you should instead do:

```
public void someMethod() {
    FacesContext.getCurrentInstance()...doSomething();
} 
```

Otherwise you're in case of a session scoped bean only holding the instance of the very first HTTP request which created the bean. Exactly this HTTP request is garbaged by end of the associated response and not valid anymore in any subsequent requests. The `FacesContext` is thus definitely not supposed to be serializable.

# android - 使用 Android 处理 1920x1280 图像 - RenderScript

> ID：12265108
> 
> 赞同：0
> 
> 时间：2012-09-04T13:58:29.383
> 
> 标签：android, renderscript

我是 RenderScript 的新手并尝试处理大小为 1920x1280px 的图像，这似乎每次都会崩溃，并在 logcat 上出现以下错误

```
09-04 19:26:04.670: D/dalvikvm(30308): GC_FOR_ALLOC freed 73K, 3% free 6615K/6787K, paused 26ms
09-04 19:26:04.680: I/dalvikvm-heap(30308): Grow heap (frag case) to 14.404MB for 8294416-byte allocation
09-04 19:26:04.690: D/dalvikvm(30308): GC_CONCURRENT freed 2K, 2% free 14713K/14919K, paused 1ms+1ms
09-04 19:26:04.820: D/dalvikvm(30308): GC_FOR_ALLOC freed 0K, 2% free 14713K/14919K, paused 12ms
09-04 19:26:04.820: I/dalvikvm-heap(30308): Grow heap (frag case) to 17.917MB for 3686416-byte allocation
09-04 19:26:04.840: D/dalvikvm(30308): GC_FOR_ALLOC freed 0K, 2% free 18313K/18567K, paused 13ms
09-04 19:26:04.860: D/dalvikvm(30308): GC_CONCURRENT freed 0K, 2% free 18313K/18567K, paused 1ms+2ms
09-04 19:26:05.010: A/libc(30308): Fatal signal 11 (SIGSEGV) at 0x5c41f809 (code=1)
09-04 19:26:05.010: A/libc(30308): Fatal signal 11 (SIGSEGV) at 0x5c41e001 (code=1) 
```

如果我将图像大小调整为 100x56px，则相同的代码可以工作:-(。

请查看下面的代码并建议我需要做的任何更改，代码基于我在互联网上其他地方和示例中找到的示例。

注意：下面的代码并不是真正的生产质量。

**VDRender.rs 的内容**

```
#pragma version(1)
#pragma rs java_package_name(com.iangclifton.tutorials.renderscript);

#include "rs_graphics.rsh"

const static float3 gMonoMult = {0.299f, 0.587f, 0.114f};

void root(const uchar4 *v_in, uchar4 *v_out) {

    //rsDebug("Called ROOT - ONE", rsUptimeMillis());

    float4 f4 = rsUnpackColor8888(*v_in);

    float3 mono = dot(f4.rgb, gMonoMult);
    *v_out = rsPackColorTo8888(mono);
} 
```

**RenderScript101.rs 的内容**

```
#pragma version(1)
#pragma rs java_package_name(com.iangclifton.tutorials.renderscript);

#include "rs_graphics.rsh"

float4 gBgColor; // Background color as xyzw 4-part float
rs_allocation gBgImage; // Background image
rs_allocation gVDBgImage; // Background image

rs_sampler gLinearClamp; // Sampler used by the program fragment
rs_program_fragment gSingleTextureFragmentProgram; // fragment shader
rs_program_store gProgramStoreBlendNone; // blend none, depth none program store
rs_program_vertex gProgramVertex; // Default vertex shader

rs_script gVDScript;

static const float3 gBgVertices[4] = {
    { -1.0, -1.0, -1.0 },
    { 1.0, -1.0, -1.0 },
    { 1.0, 1.0, -1.0 },
    {-1.0, 1.0, -1.0 }
};

void drawInteger(int value, int x, int y) {

    char text[50] = "0";
    int index = 0;

    if(value != 0) {

    index = 49;
    text[index] = 0;

    while(value > 0) {

        index--;

        int digitValue = value % 10;

        text[index] = '0' + digitValue;

        value /= 10;
    }

    if(value < 0) {
        text[index--] = '-';
    }    
    }

    rsgDrawText(&text[index], x, y);
}

int64_t gTimeMS = 0;
int64_t updateFPS = 0;

int gFPS = 0;

static void drawBackground() {

    if (gBgImage.p != 0) {

        //rsgClearColor(gBgColor.x, gBgColor.y, gBgColor.z, gBgColor.w);

        rs_matrix4x4 projection, model;
        rsMatrixLoadOrtho(&projection, -1.0f, 1.0f, -1.0f, 1.0f, 0.0f, 1.0f);
        rsgProgramVertexLoadProjectionMatrix(&projection);

        rsMatrixLoadIdentity(&model);
        rsgProgramVertexLoadModelMatrix(&model);

        // ----
        if(1) 
        {
            rsForEach(gVDScript, gBgImage, gBgImage, NULL);
            rsgBindTexture(gSingleTextureFragmentProgram, 0, gBgImage);
        }
        else
        {
            rsgBindTexture(gSingleTextureFragmentProgram, 0, gBgImage);
        }
        //----

        rsgDrawQuad(
            gBgVertices[0].x, gBgVertices[0].y, gBgVertices[0].z,
            gBgVertices[1].x, gBgVertices[1].y, gBgVertices[0].z,
            gBgVertices[2].x, gBgVertices[2].y, gBgVertices[0].z,
            gBgVertices[3].x, gBgVertices[3].y, gBgVertices[0].z
        );

        int x = 250;
        int y = 150;
        int fps = 0;

        int64_t t = rsUptimeMillis();
        int diff = t - gTimeMS;
        fps = 1000 / diff; 
        gTimeMS = t;

        if((t - updateFPS) > 500)
        {   
            gFPS = fps;
            updateFPS = t;
        }

        rsgDrawText("FPS:", x, y);
        drawInteger(gFPS, 250+40, 150);
    }
}

void init() {
    gBgColor = (float4) { 0.0f, 1.0f, 0.0f, 1.0f };
    rsDebug("Called init", rsUptimeMillis());
}

int root() {
    rsgBindProgramVertex(gProgramVertex);
    rsgBindProgramFragment(gSingleTextureFragmentProgram);
    rsgBindProgramStore(gProgramStoreBlendNone);

    drawBackground();
    return 1;
} 
```

**RenderScript101RS.java 的内容**

```
package com.iangclifton.tutorials.renderscript;

import android.content.res.Resources;
import android.graphics.Bitmap;
import android.renderscript.Allocation;
import android.renderscript.Float4;
import android.renderscript.Matrix4f;
import android.renderscript.ProgramFragment;
import android.renderscript.ProgramFragmentFixedFunction;
import android.renderscript.ProgramStore;
import android.renderscript.ProgramVertex;
import android.renderscript.ProgramVertexFixedFunction;
import android.renderscript.RenderScriptGL;
import android.renderscript.Sampler;

/**
 * Custom RenderScript helper that simplifies interaction with the RenderScript.
 * 
 * @author Ian G. Clifton
 */
public class RenderScript101RS {

    private Sampler mLinearClamp;
    private ProgramStore mProgramStoreBlendNone;
    private ProgramVertex mProgramVertex;
    private RenderScriptGL mRS;
    private ScriptC_RenderScript101 mScript;
    private ScriptC_VDRender mVDScript;
    private ProgramFragment mSingleTextureFragmentProgram;

    /**
     * Constructs a new helper with RenderScriptGL and Resources references.
     * 
     * @param rs RenderScriptGL reference
     * @param res Resources reference
     * @param resId int ID of the RenderScript (e.g., R.raw.xyz)
     */
    public RenderScript101RS(RenderScriptGL rs, Resources res, int resId, int resId2) {
        mRS = rs;

        mScript = new ScriptC_RenderScript101(rs, res, resId);
        mVDScript = new ScriptC_VDRender(rs, res, resId2);

        mScript.set_gVDScript(mVDScript);

        initProgramStore();
        initSampler();
        initProgramFragment();
        initProgramVertex();
        mRS.bindRootScript(mScript);

    }

    /**
     * Sets a custom background Bitmap on the RenderScript view
     * 
     * @param bitmap Bitmap to use as the background
     */
    public void setBackgroundBitmap(Bitmap bitmap) {
        if (bitmap == null) {
            return;
        }
        final Allocation bitmapAllocation = Allocation.createFromBitmap(mRS, bitmap, Allocation.MipmapControl.MIPMAP_NONE, Allocation.USAGE_GRAPHICS_TEXTURE);
        mScript.set_gBgImage(bitmapAllocation);

        //final Allocation bitmapVDAllocation = Allocation.createFromBitmap(mRS, bitmap, Allocation.MipmapControl.MIPMAP_NONE, Allocation.USAGE_GRAPHICS_TEXTURE);
        //mScript.set_gVDBgImage(bitmapVDAllocation);
    }

    /**
     * Sets a custom background color on the RenderScript view
     * 
     * @param color Float4 color
     */
    public void setBackgroundColor(Float4 color) {
        mScript.set_gBgColor(color);
    }

    /**
     * Prepares the ProgramFragment (fragment shader)
     */
    private void initProgramFragment() {
        final ProgramFragmentFixedFunction.Builder pfBuilder = new ProgramFragmentFixedFunction.Builder(mRS);
        pfBuilder.setTexture(ProgramFragmentFixedFunction.Builder.EnvMode.REPLACE, ProgramFragmentFixedFunction.Builder.Format.RGBA, 0);
        mSingleTextureFragmentProgram = pfBuilder.create();
        mScript.set_gSingleTextureFragmentProgram(mSingleTextureFragmentProgram);
    }

    /**
     * Prepares the ProgramStore (controls use of framebuffer such as blending)
     */
    private void initProgramStore() {
        mProgramStoreBlendNone = ProgramStore.BLEND_NONE_DEPTH_NONE(mRS);
        mScript.set_gProgramStoreBlendNone(mProgramStoreBlendNone);
    }

    /**
     * Prepares the ProgramVertex (vertex shader)
     */
    private void initProgramVertex() {
        ProgramVertexFixedFunction.Builder pvb = new ProgramVertexFixedFunction.Builder(mRS);
        mProgramVertex = pvb.create();
        ProgramVertexFixedFunction.Constants pva = new ProgramVertexFixedFunction.Constants(mRS);
        ((ProgramVertexFixedFunction) mProgramVertex).bindConstants(pva);
        Matrix4f proj = new Matrix4f();
        proj.loadProjectionNormalized(1, 1);
        pva.setProjection(proj);
        mScript.set_gProgramVertex(mProgramVertex);
    }

    /**
     * Prepares the Sampler (controls how pixels are pulled from a texture)
     */
    private void initSampler() {
        mLinearClamp = Sampler.CLAMP_LINEAR(mRS);
        mScript.set_gLinearClamp(mLinearClamp);
    }
} 
```

**RenderScript101View的内容**

```
package com.iangclifton.tutorials.renderscript;

import android.content.Context;
import android.graphics.BitmapFactory;
import android.renderscript.RSSurfaceView;
import android.renderscript.RenderScriptGL;
import android.view.MotionEvent;

/**
 * Custom RSSurfaceView that sets up the RenderScript and captures touch events.
 * 
 * @author Ian G. Clifton
 */
public class RenderScript101View extends RSSurfaceView {
    private Context mContext;
    private RenderScript101RS mRenderScript;
    private RenderScriptGL mRS;

    /**
     * {@inheritDoc}}
     */
    public RenderScript101View(Context context) {
        super(context);
        mContext = context;
        ensureRenderScript();
    }

    @Override
    public boolean onTouchEvent(MotionEvent event) {
        super.onTouchEvent(event);

        if (mRenderScript == null) {
            return true;
        }

        if (event.getAction() == MotionEvent.ACTION_DOWN) {
            mRenderScript.setBackgroundBitmap(BitmapFactory.decodeResource(getResources(), R.drawable.icon00072half));
        }

        return true;
    }

    /**
     * Ensures the RenderScriptGL reference has been established and our custom
     * RS helper has been created.
     */
    private void ensureRenderScript() {
        if (mRS == null) {
            final RenderScriptGL.SurfaceConfig sc = new RenderScriptGL.SurfaceConfig();
            mRS = createRenderScriptGL(sc);
        }
        if (mRenderScript == null) {
            mRenderScript = new RenderScript101RS(mRS, mContext.getResources(), R.raw.renderscript101, R.raw.vdrender);
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-04T14:15:58.733

您的 LogCat 中没有异常或警告，但我可能知道这个问题。

首先，我什至没有看您的 RenderScript，因为您说它适用于小位图。

在 android 中，每个 VM 或进程都有自己的内存部分，这对于 1920x1080 位图来说大多是不够的。因此，您的 logcat 应该会提示您可能忽略的类似内容：

```
bitmap size exceeds VM budget 
```

我不知道您的实现细节（获取位图表单服务器、本地文件等）。因此，我将指导您进行[Android 位图培训](http://developer.android.com/training/displaying-bitmaps/index.html)。

一般的想法是加载尽可能小的图像。这样：

```
BitmapFactory.Options options = new BitmapFactory.Options();
options.inJustDecodeBounds = true;
BitmapFactory.decodeResource(getResources(), R.id.myimage, options);
int imageHeight = options.outHeight;
int imageWidth = options.outWidth;
String imageType = options.outMimeType; 
```

关键部分：

```
options.inJustDecodeBounds = true; 
```

说嘿！不要解码和加载位图。我将对我的位图进行一些设置。

# android - 将mysql数据放入arraylist Android

> ID：12265111
> 
> 赞同：0
> 
> 时间：2012-09-04T13:58:33.580
> 
> 标签：android, mysql, arraylist

我想获取保存在 mysql Db 中的图像的标题，我发现您必须通过 Json 执行此操作，现在我有一个 .php 文件：

```
<?php
mysql_connect("localhost","xx","xx");
mysql_select_db("xx");

$q=mysql_query("SELECT title FROM field_title");
while($e=mysql_fetch_assoc($q))
        $output[]=$e;

print(json_encode($output));

mysql_close();
?> 
```

它输出如下：

```
[{"title":"titleone"},{"title":"titletwo"},{"title":"titlethree"}] 
```

但是现在我被卡住了，我想把这些标题放在一个简单的数组列表中，但我不知道如何在输出数据和数组列表本身之间建立联系。

```
ArrayList<String> list = new ArrayList<String>();  
for (??) {  
    list.add(string);  
} 
```

是否有可能以一种简单的方式做到这一点？我看过这个例子，但我似乎无法弄清楚：

[http://www.helloandroid.com/tutorials/connecting-mysql-database](http://www.helloandroid.com/tutorials/connecting-mysql-database)

谢谢。

***编辑***

好的，我能够通过 httppost 建立连接：但是当我运行我的应用程序时，它从一开始就崩溃了......

```
// http post
        InputStream inputStream = null;
        String result = null;
        try {
            DefaultHttpClient   httpclient = new DefaultHttpClient(new BasicHttpParams());
        HttpPost httppost = new HttpPost("http://www.webmention.com/bosshunting.php");
        // Depends on your web service
        httppost.setHeader("Content-type", "application/json");

        HttpResponse response = httpclient.execute(httppost);           
        HttpEntity entity = response.getEntity();
        } catch (Exception e) {
            Log.e("log_tag", "Error in http connection " + e.toString());
        }
        // convert response 
        try {
            BufferedReader reader = new BufferedReader(new InputStreamReader(inputStream, "UTF-8"), 8);
            StringBuilder sb = new StringBuilder();

            String line = null;
            while ((line = reader.readLine()) != null)
            {
                sb.append(line + "\n");
            }
            result = sb.toString();

        } catch (Exception e) {
            Log.e("log_tag", "Error converting result " + e.toString());
        }

        // parse json data
        try {
            JSONArray jArray = new JSONArray(result);
            ArrayList imageUrls = new ArrayList();
            for (int i = 0; i < jArray.length(); i++) {
                JSONObject json_data = jArray.getJSONObject(i);

                imageUrls.add(json_data.getString("url"));
            }

        } catch (JSONException e) {
            Log.e("log_tag", "Error parsing data " + e.toString());
        } 
```

不知道我是否以正确的方式将项目添加到数组中。我猜不是？我尝试获取 titleone、titletwo、titlethree 的 arraylist imageUrls

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-04T16:36:37.923

你好，我在这里检查了你的 json 响应[Json](http://jsonlint.com/) 是真的。我想你在这里弄错了

```
try {
            JSONArray jArray = new JSONArray(result);
         ArrayList imageUrls = new ArrayList(); 
         for (int i = 0; i < jArray.length(); i++)
         { JSONObject json_data = jArray.getJSONObject(i); 
            imageUrls.add(json_data.getString("title")); }
         } catch (JSONException e) 
         { Log.e("log_tag", "Error parsing data " + e.toString()); }

    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-05T07:57:39.947

看来我的输出是错误的。

由于这有效：

```
 List<String> list = new ArrayList<String>();
        String string1 = "https://www.link.com/file1.jpg";
        String string2 = "https://www.link.com/file2.jpg";
        list.add(string1);
        list.add(string2);
        imageUrls = (String[]) list.toArray(new String[0]); 
```

我尝试了以下方法：

```
InputStream inputStream = null;
        String result = null;
        try {
            DefaultHttpClient   httpclient = new DefaultHttpClient(new BasicHttpParams());
        HttpPost httppost = new HttpPost("http://www.file.com/connect.php");
        httppost.setHeader("Content-type", "application/json");

        HttpResponse response = httpclient.execute(httppost);           
        HttpEntity entity = response.getEntity();
        } catch (Exception e) {
            Log.e("log_tag", "Error in http connection " + e.toString());
        }
        // convert response 
        try {
            BufferedReader reader = new BufferedReader(new InputStreamReader(inputStream, "UTF-8"), 8);
            StringBuilder sb = new StringBuilder();

            String line = null;
            while ((line = reader.readLine()) != null)
            {
                sb.append(line + "\n");
            }
            result = sb.toString();

        } catch (Exception e) {
            Log.e("log_tag", "Error converting result " + e.toString());
        }

        try {
            JSONArray jArray = new JSONArray(result);
         List<String> list = new ArrayList<String>();
         for (int i = 0; i < jArray.length(); i++)
         { JSONObject json_data = jArray.getJSONObject(i); 

            list.add(json_data.getString("url"));

         } imageUrls = (String[]) list.toArray(new String[0]);
        }catch (JSONException e) 
         { Log.e("log_tag", "Error parsing data " + e.toString()); }

    } 
```

但不幸的是，这也给出了一个错误......似乎与我上面的日志文件中的错误相同......

# java - java - 如何部署远程机器上的 jar 文件 - 带有一些用户定义的参数

> ID：12265112
> 
> 赞同：0
> 
> 时间：2012-09-04T13:58:35.710
> 
> 标签：java, maven, deployment, jar, virtual-machine

我对 maven/ant 很陌生，因此，如果我的问题对您来说很愚蠢，请原谅...

在我正在处理的应用程序中，我必须初始化一个虚拟机（例如 Amazon EC2 实例），然后将 JAR 文件上传到该机器，最后运行它——每次我想运行它时，运行时参数可能不同。

这样做的最佳方法是什么？除了 JRE 之外，我还需要在该虚拟机上安装哪些框架/库（如 maven 或 ant）才能使其正常工作？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-04T18:52:18.647

如果你坚持`Maven`，你可以攻击jar上传过程`install phase`如下：

pom.xml：

```
...
<plugins>
...
  <plugin>
    <artifactId>maven-antrun-plugin</artifactId>
    <configuration>
      <tasks>
        <scp todir="${targetNode}:~/" trust="true" failonerror="true"
          file="${project.build.directory}/${project.build.finalName}.jar" />
      </tasks>
    </configuration>
    <executions>
      <execution>
        <id>upload</id>
        <phase>install</phase>
        <goals>
          <goal>run</goal>
        </goals>
      </execution>
    </executions>
    <dependencies>
      <dependency>
        <groupId>org.apache.ant</groupId>
        <artifactId>ant-jsch</artifactId>
        <version>1.8.3</version>
      </dependency>
    </dependencies>
  </plugin>
...
</plugins>
... 
```

然后发出：

```
mvn clean install "-DtargetNode=user:pass@machine" 
```

（可选）编写一个脚本，在目标机器上运行上传的 jar。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-04T14:07:05.577

You likely won't need Ant/Maven deployed remotely.

Can you instead `ssh`/`scp` onto that machine ? Ant has [sshexec](http://ant.apache.org/manual/Tasks/sshexec.html) and [scp](http://ant.apache.org/manual/Tasks/scp.html) tasks to allow you to copy and run stuff remotely.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-04T14:39:02.223

最好的方法是创建满足您所有需要的 shell 脚本。如果机器是unix之类的，你可以用ssh、scp（使用ssh）来实现这一切。

使用 ssh，您可以执行远程 shell 命令。

示例（all_in_one.sh）：

```
args=$1
arg2=$2
etc.
ssh admin@amazon_instance << end
/home/admin/bin/startAmazonVM.sh $arg1
end

scp mylocal.jar admin@amazon_instance:/home/admin/server/libraries/

ssh admin@amazon_instance << end
$JAVA_HOME/bin/java -jar /home/admin/server/libraries/mylocal.jar $arg2
end 
```

然后您可以运行例如 all_in_one.sh（添加 >> output.txt 以创建执行输出文件，然后您可以对其进行解析以验证该过程）

如果您在 Windows 上工作，请安装 Cygwin 或 MinGW，或者使用 ant 并花更多时间在其中配置任务以完成其他工具最擅长的事情。

# iis-7 - IIS URL 重写规则

> ID：12265114
> 
> 赞同：0
> 
> 时间：2012-09-04T13:58:41.677
> 
> 标签：iis-7, url-rewriting

我是 Url 重写规则的新手，因此我们将不胜感激任何帮助。

希望创建一个 IIS Url 重写来处理以下任何内容

```
http://localhost/homepage/contact-us.aspx -> http://localhost/contact-us.aspx
http://localhost/homepage/about-us.aspx -> http://localhost/about-us.aspx 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-12T13:48:10.320

我尚未对此进行测试，但我认为您的 web.config 文件中会有类似的内容。

您可以编辑 web.config 文件，然后进入 IIS，如果您想测试它，该规则应该会显示出来。

```
<?xml version="1.0" encoding="UTF-8"?>
<configuration>
    <system.webServer>
        <rewrite>
            <rules>
                <rule name="rewriterule1" enabled="true" stopProcessing="false">
                    <match url="homepage/(.*)" />
                    <action type="Rewrite" url="http://localhost/{R:1}" />
                </rule>
            </rules>
        </rewrite>
    </system.webServer>
</configuration> 
```

# asp.net - 仅允许直接在包含内容控件的内容页面中使用内容控件

> ID：12265119
> 
> 赞同：4
> 
> 时间：2012-09-04T13:59:24.783
> 
> 标签：asp.net, webforms, master-pages

我正在尝试将内容占位符添加到母版页中，但出现上述错误。母版页从另一个母版页继承自身，并且子母版的许多 ContentPlaceHolder 都包含在 Content 标签中，这些标签将继承页面中的内容注入到父母版的占位符中。但是，我希望子 master 与基本 master 有一点偏差，但有自己的 ContentPlaceHolder 与父 master 无关。然而，它似乎不喜欢有以下行：

```
<asp:ContentPlaceHolder ID="chpBanner" runat="server" /> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-04T14:13:49.763

这是不可能的。它甚至没有逻辑意义。
如果您放置了一个独立的 ContentPlaceHolder，父母版页如何知道将其内容放在哪里？

如果没有将控件附加到的父级，它将如何构建控件树？

您必须在父级中选择一个 ContentPlaceHolder 才能将其添加到。
如果您这样做是出于定位目的，您可以使用 CSS 将此 div 的内容定位在渲染页面上您想要的任何位置。

# highcharts - Highcharts 将图像添加到该图表，并附加一个 onClick 事件

> ID：12265128
> 
> 赞同：1
> 
> 时间：2012-09-04T14:00:06.200
> 
> 标签：highcharts

我创建了一个图表，其中添加了图像。现在，当我单击此图像时，我想将 yAxis 最大值设置为特定点，然后再次单击它以将 yAxis 重置为原始值。这是它的 jsfiddle：http: [//jsfiddle.net/inadcod/TynwP/](http://jsfiddle.net/inadcod/TynwP/) 我已经设法添加图像，向图像添加点击事件，但就我所知。谁能帮我解决这个问题？谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-04T21:14:23.920

有两种方法可以做你想做的事。

**第一种方式**：

问题是不可能更新图表选项然后`redraw`更新它，您必须`destroy`然后再次创建它，如下所示。

因此，为此，您可以将图表存储`options`到 var 中，然后作为参数传递。

```
// inside options
    load: function() {
        this.renderer.image('http://inadcod.com/img/zoom.png', 70, 10, 28, 28)
        .on('click', function() {
            if(options.yAxis.max) {
                delete options.yAxis.max; // return to default
            } else {
                options.yAxis.max = 25;
            }
            chart = new Highcharts.Chart(options);                        
        })
        .css({
            cursor: 'pointer',
            position: 'relative',
            "margin-left": "-90px",
            opacity: 0.75
        }).attr({
            id: 'myImage',
            zIndex: -100
        }).add();
    } 
```

[**演示**](http://jsfiddle.net/TynwP/9/)

**第二种方式**：

`redraw`如果您只是更新`axis`如下数据，则不会调用。
`chart.yAxis[0].max = 25;`，这就是为什么我建议上面的方式。
但是，如果您设置`chart.yAxis[0].isDisty = true;`并调用`chart.redraw();`，它将起作用。你可以在下面看到我的演示。

```
// inside chart options
    load: function() {
        this.renderer.image('http://inadcod.com/img/zoom.png', 70, 10, 28, 28)
        .on('click', function() {
            var axis = chart.yAxis[0];
            axis.max = 25;
            axis.isDirty = true;
            chart.redraw();
        })
        .css({
            cursor: 'pointer',
            position: 'relative',
            "margin-left": "-90px",
            opacity: 0.75
        }).attr({
            id: 'myImage', // your image id
            zIndex: -100
        }).add();
    } 
```

[**演示**](http://jsfiddle.net/TynwP/8/)

# php - Laravel (Eloquent) 不更新数据库

> ID：12265140
> 
> 赞同：3
> 
> 时间：2012-09-04T14:00:48.877
> 
> 标签：php, postgresql, laravel, laravel-3

有一个大问题，令人困惑。我正在使用 Laravel（3.2.5 和现在的 3.2.7）并且我正在使用 Eloquent ORM 来更新数据库（PostgreSQL）。

这就是我正在做的事情：

*   我有一个充满数据的数据库
*   我正在从外部 API 中提取信息以更新我的数据库中的数据
*   我运行一个脚本，将充满数据的数据库放入数组中，并且与 API 相同。这得到了比较
*   我用一个充满变化的数组填充一个数据对象
*   我“保存”它
*   什么都没发生 -。-

```
    $updateLinks = array_diff($dbLinkArray, $dbLinkArrayOriginal);

    $dbLink->fill($updateLinks);

    Log::info('1st LOG Original: '.$dbLinkArrayOriginal['link_text'].' New: '.$dbLinkArray['link_text']);

    Log::info('2nd Log Dirty: '.implode(', ', $dbLink->get_dirty()));

    $dbLink->保存（）；

    Log::info('第 3 条日志应该被修改：'.implode(', ',array_keys($updateLinks)));

```

我使用了一些日志记录和调试工具栏来确定发生了 wtf。这是信息：

*   所有 SQL 查询都会运行以更新正确的信息。当通过 phpPgAdmin 运行查询时，它会按应有的方式更新。这里的问题是查询更新了行中的每一列，而不仅仅是更改。使用“更新”而不是“填充/保存”会产生同样的问题。
*   永远不会更新任何表信息。
*   第一个日志显示 link_text 不相等。这没关系，因为它表明 link_text 需要更新。但是，它清楚地表明下次我运行脚本时没有更新任何内容。日志每次都显示相同的信息，并且发生的日志事件也一样多。
*   第二个日志显示整个对象是脏的，而不仅仅是应该更新的。这就是 SQL 更新的原因
*   第三个日志准确地吐出应该更新的内容。最多 3-5 列，仅此而已。一切都是正确的格式。

知道为什么，首先，即使 Laravel 将 SQL 标记为正在运行并显示正确的查询，数据库也没有得到更新？

另外，知道为什么 ENTIRE 对象是脏的并且查询尝试更新整个对象（23 列以上）而不是只更新更改（3-5 列）吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-05T00:01:59.687

对于您的第二个问题（为什么所有列都更新，而不仅仅是脏的）。Laravel 文档指出：

> 默认情况下，所有属性键/值对都将在批量分配期间存储。但是，可以创建将要设置的属性的白名单。如果设置了可访问属性白名单，则在批量分配期间不会设置除指定属性之外的任何属性。

这对你有帮助吗？

亲切的问候，亨德里克

# css - 为什么水平滚动条远远超出内容？

> ID：12265141
> 
> 赞同：0
> 
> 时间：2012-09-04T14:00:51.190
> 
> 标签：css, image, header, scroll, width

我正在构建一个博客并有一个大标题图像，其目标是填充屏幕顶部（除非在大于 1500 像素的监视器上） - 但是滚动条远远超出标题内容并显示空白。

在 Ipad 上查看时，它会缩小并显示内容一侧的额外空间。为什么宽度明显大于图像？

这是网站：[http ://beautyintheweeds.com/](http://beautyintheweeds.com/)

这是HTML和CSS：

```
<?php wp_head(); ?>
</head>

<div id="container" class="group">
<div class="outer"><div class="inner"><img src="http://theshalomimaginative.com/weeds/wp-    content/themes/journalist/images/longtop.jpg"/></div></div>

div.inner img { position: relative; left:-50%; }
div.outer {width: 900px; margin: 0 auto; overflow: visible;}
div.inner {display: inline-block; position:relative; right: -50%;} 
```

此代码用于将标题置于容器之外，我希望它始终填满屏幕顶部，除非监视器太大。任何想法为什么它会在图像之外创建额外的滚动空间？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-04T14:09:01.507

`class="inner"`它是占据空间的元素。它从其中的图像获取其大小，但随后您使用相对定位将图像显示在元素的左侧。

如果您想使用该方法使元素居中，请在所有元素周围放置一个 div，该 div`overflow: hidden;`没有设置宽度，以便它使用默认值`width: auto`，这将使其占据所有可用宽度。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-04T14:05:25.903

试试这个

```
#container {
width: 911px;
margin: 0 auto;
position: relative;
padding: 0 0 0 140px;
overflow: hidden;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-04T14:10:55.917

[http://jsfiddle.net/pWDrD/](http://jsfiddle.net/pWDrD/)

您将看到是否增加小提琴框的宽度，然后图像会自动增加宽度而没有任何滚动条。你明白我是怎么做到的吗？让我知道。如果不是，我会解释。简而言之，当您希望图像进入显示器的 100% 时，您需要将其放入宽度为 100% 且边距自动的容器中，而不是固定宽度且根本没有位置。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-04T14:16:18.167

我会把它们从容器中拉出来。在标记中将 div.outer 移到 div.container 上方，删除 div.outer、div.inner 的所有 css，然后添加 text-align: center; 到 div.outer 并完全删除 div.inner。

# android - 对帐户进行排序

> ID：12265143
> 
> 赞同：0
> 
> 时间：2012-09-04T14:01:12.743
> 
> 标签：android, android-contentprovider, android-account

我在 android 设备上有一些帐户存储在 contacts2.db 的帐户表中；我如何按 asc 对它们进行排序？

我没有找到从 ContactsContract 访问帐户表的权限。

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-04T14:07:29.807

To get list of accounts you have to use `AccountManager`, not Contacts' content provider. Do this.

```
Account[] accounts = AccountManager.get(context).getAccounts();
for (Account account : accounts) {
   ...
} 
```

And sort it as you want. Also note app have to request GET_ACCOUNTS permission to do that:

```
<uses-permission android:name="android.permission.GET_ACCOUNTS" /> 
```

# c# - 按特定属性过滤类实例的属性并调用属性的方法

> ID：12265147
> 
> 赞同：4
> 
> 时间：2012-09-04T14:01:20.347
> 
> 标签：c#, reflection

我有一个包含一些属性的类。一些特定的属性用属性修饰。例如：

```
public class CoreAddress
{
    private ContactStringProperty _LastName;

    [ChangeRequestField]
    public ContactStringProperty LastName
    {
        //ContactStringProperty has a method SameValueAs(ContactStringProperty other)
        get { return this._LastName; }
    }
    .....
} 
```

我想在我的类中有一个方法，它遍历这个类的所有属性，过滤具有这个自定义属性的属性并调用找到的属性的成员。这是我到目前为止所拥有的：

```
foreach (var p in this.GetType().GetProperties())
        {
            //checking if it's a change request field
            if (p.GetCustomAttributes(typeof(ChangeRequestFieldAttribute), false).Count() > 0)
            {

                MethodInfo method = p.PropertyType.GetMethod("SameValueAs");
                //problem here        
                var res = method.Invoke(null, new object[] { other.LastName }); 

            }

        } 
```

如果此方法是属性的实例方法，我必须提供一个目标（而不是代码中的 null）。如何在运行时获取此类实例的特定属性？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-04T14:11:42.767

由于您已经拥有 PropertyInfo，您可以调用[`GetValue method`](http://msdn.microsoft.com/en-us/library/hh194385.aspx). 所以...

```
MethodInfo method = p.PropertyType.GetMethod("SameValueAs");
//problem solved
var propValue = p.GetValue(this);

var res = method.Invoke(propValue, new object[] { other.LastName }); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-04T14:06:44.477

使用[PropertyInfo](http://msdn.microsoft.com/ru-ru/library/system.reflection.propertyinfo.aspx)获取您需要的任何属性的值。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-04T14:16:47.227

只需从属性中获取价值并像往常一样使用它。

```
foreach (var p in type.GetProperties())
{
         if (p.GetCustomAttributes(typeof(ChangeRequestFieldAttribute), false).Count() > 0)
         {

               //just get the value of the property & cast it.
               var propertyValue = p.GetValue(<the instance>, null);
               if (propertyValue !=null && propertyValue is ContactStringProperty)
               {
                   var contactString = (ContactStringProperty)property;
                   contactString.SameValueAs(...);
               }
         }
  } 
```

# android - Android 设备上未调用第二个（类似）AJAX 请求

> ID：12265150
> 
> 赞同：1
> 
> 时间：2012-09-04T14:01:24.673
> 
> 标签：android, ajax, cordova, jquery-mobile

我正在制作一个 jQuery Mobile 和 PhonGap 应用程序。它通过使用 JSONP 的 AJAX 调用连接到服务器端 Web 服务（我知道跨域问题，尽管我的 android 开发人员没有遇到它）。我正在使用 PhoneGap Build 为许多操作系统准备应用程序。

这是我的问题：我制作了一个 index.html，它对服务器进行 AJAX 调用。我收到了回复，我被重定向到 main.html。它在 chrome、safari 和我的 Android 设备上运行良好。

在第二个站点：main.html，**我有类似的请求（我也尝试过相同的请求），但在 Android 设备上没有被调用**。但是它在 Chrome 和 Safari 上都可以正常工作。

我尝试关闭缓存，授予适当的权限，将其添加到 config.xml。请注意，我还尝试通过 eclipse 编译我的应用程序，但没有结果我添加到 /res/xml/cordova.xml。

我检查了服务器日志，没有来自第二个站点的请求。这是代码：

注意：我还根据 PhoneGap 阅读了 jQuery 移动文档。更改 $(document).ready 并不能解决问题。此构造适用于 index.html 网站。

```
$( document ).bind( "mobileinit", function(){
        $.support.cors = true;
        $.mobile.allowCrossDomainPages = true;
        $.mobile.loadingMessageTextVisible = true; 
        $.mobile.showPageLoadingMsg();
        console.log('Start Strony');
})

$( document ).ready(function (){ //
        $.ajaxSetup ({
        cache: false
    });
        console.log('Start');
        $.support.cors = true;
        $.mobile.allowCrossDomainPages = true;
        $.ajax({                                                                   
        crossDomain: true,
        type: 'GET',
        url: 'http://ip/services/rest/contact/list', 
        callback: 'jsonpCallback',
        jsonpCallback: 'jsonpCallback',
        jsonp: '_jsonp',
        scriptCharset: "utf-8",
        contentType:  'application/json',
        dataType: 'jsonp',
        timeout : 5000,

        success: function(data){

            var html ='';
            console.log('Success');
            $.each(data.response, function(key, value) {
            html += '<li><a class=contact href="#" id="' + data.response[key].id + '" ><h1>' + data.response[key].label + '</h1><p>'+ data.response[key].customerName + '</p><p>' + data.response[key].phone + ', ' + data.response[key].email + '</p></a></li>';
            $('#ul_id').append($(html));
            html='';
            console.log('conatct');
            });
            $('#ul_id').trigger('create');    
            $('#ul_id').listview('refresh');
            //localStorage.setItem('idCustomerValue', data.re);

        },
        error: function (xhr, ajaxOptions, thrownError){
            alert("Status: " + xhr.status + ", Ajax option: " + ajaxOptions + ", Thrown error: " + thrownError);
            //location.reload();
            console.log('Blad');
        },
    }); 
}); 
```

不幸的是，我无法为您提供服务器端代码。服务器设置正确。正如我提到的 Chrome 和 Safari 工作。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-11T13:52:42.667

问题是在 JQM 中链接时的 pageinit 事件和特定行为。

# php - PHP Sentence Search - 在一个句子中搜索关键字（MySQL）

> ID：12265154
> 
> 赞同：0
> 
> 时间：2012-09-04T14:01:51.083
> 
> 标签：php, mysql, search, keyword, sentence

一般来说，关键字是在 MySQL 字段中搜索的，例如；

[tbl_hp] 标识，标题

```
1, Harry Potter and the Philosopher's Stone
2, Harry Potter and the Chamber of Secrets
3, Harry Potter and the Prisoner of Azkaban
4, Harry Potter and the Goblet of Fire
5, Harry Potter and the Order of the Phoenix
6, Harry Potter and the Half-Blood Prince
7, Harry Potter and the Deathly Hallows 
```

PHP

```
$keyword = "Philosopher";
$keyword = "Harry Potter"; 
```

SQL

```
SELECT `id` FROM `tbl_hp` WHERE `title` LIKE '%" . $keyword . "%'; 
```

然后结果是；

```
"Philosopher" => 1
"Harry Potter" => 1,2,3,4,5,6,7 
```

但是如何做到这一点？

[tbl_hp_keywords] id，关键字

```
1, philosopher
2, chamber
3, azkaban
4, goblet
5, phoenix
6, prince
7, hallows
8, prisoner
9, Prisoner of Azkaban
10, Half-Blood Prince 
```

PHP

```
$keyword = "Harry Potter and the Chamber of Secrets";
$keyword = "Harry Potter and the Prisoner of Azkaban";
$keyword = "Harry Potter and the Half-Blood Prince"; 
```

然后结果是；

```
"Harry Potter and the Chamber of Secrets" => 2
"Harry Potter and the Prisoner of Azkaban" => 3,8,9 => or even better result is 9
"Harry Potter and the Half-Blood Prince" => 6,10 => or even better resurt is 10 
```

关于如何做到这一点的任何帮助或想法......在此先感谢:)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-04T14:17:38.683

```
<?php
$keywords = explode(' ', $keyword);
foreach($keywords AS $key){
    $sql = "SELECT id FROM tbl_hp_keywords WHERE keyword = '$key'";
    $query = mysql_query($sql);
    while($result = mysql_fetch_array($query)){
        $ids[] =$result['id'];
    }
}
$answer[$keyword] = implode(',', $ids); 
```

或者试试这个

```
$keyword = 'Harry Potter and the Chamber of Secrets';
$keywords = explode(' ', $keyword);
$modifiedKeyword = implode("', '", $keywords);
$sql = "SELECT id FROM tbl_hp_keywords WHERE keyword IN ('$modifiedKeyword')";
try {
    $hostname = 'servername';
    $dbname = 'dbname';
    $username = 'username';
    $pw = "password";
    $pdo = new PDO("mssql:host=$hostname;dbname=$dbname", $username, $pw);
} catch (PDOException $e) {
    echo "Failed to get DB handle: " . $e->getMessage() . "\n";
    exit;
}
$query = $pdo->prepare($sql);
$query->execute();

for ($i = 0; $row = $query->fetch(); $i++) {
    $ids[] = $row['id'];
}

unset($pdo);
unset($query); 
```

# ruby - Capybara：按值而不是文本选择选项

> ID：12265174
> 
> 赞同：68
> 
> 时间：2012-09-04T14:03:05.740
> 
> 标签：ruby, capybara

对于 HTML

```
<select id="date">
  <option value="20120904">Tue 4 Sep 2012</option>
  <option value="20120905">Wed 5 Sep 2012</option>
  <option value="20120906">Thu 6 Sep 2012</option>
</select> 
```

我有以下 Capybara Ruby 代码：

```
select "20120905", :from => "date" 
```

但这与以下错误有关：

```
cannot select option, no option with text '20120905' in select box 'date' (Capybara::ElementNotFound) 
```

但是，如果我这样做

```
select "Wed 5 Sep 2012", :from => "date" 
```

没关系。

是否可以通过*Value*而不是*Text*在 Capybara 中选择一个选项？

谢谢

* * *

## 回答 #1

> 赞同：76
> 
> 时间：2012-09-10T19:58:51.717

这将用于按值选择选项：

```
find("option[value='20120905']").click 
```

为了保持选择器的范围，您可以将其包装在一个内块中，如下所示：

```
within '#date' do
  find("option[value='20120905']").click
end 
```

* * *

## 回答 #2

> 赞同：40
> 
> 时间：2013-03-12T07:40:49.603

使用 Poltergeist 作为驱动程序时，我无法单击上面某些其他选项中建议的选项，而是可以执行以下操作：

`page.find_by_id('date').find("option[value='20120905']").select_option`

* * *

## 回答 #3

> 赞同：21
> 
> 时间：2013-04-04T20:39:17.010

我写了一个辅助方法：

```
def select_by_value(id, value)
  option_xpath = "//*[@id='#{id}']/option[@value='#{value}']"
  option = find(:xpath, option_xpath).text
  select(option, :from => id)
end 
```

保存在*spec/support/中的 .rb 文件中*

示例使用：

```
before do
  select_by_value 'some_field_id', 'value'
  click_button 'Submit'
end 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2013-02-27T14:27:46.063

您还可以通过执行以下操作来实现它：

```
find_by_id('date').find("option[value='20120905']").click 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2014-09-24T21:35:56.017

该辅助方法非常聪明。我会稍微改变一下：

```
def select_by_value(id, value)

  option_xpath = "//*[@id='#{id}']/option[@value='#{value}']"

  find(:xpath, option_xpath).click

end 
```

要不就：

```
find(:xpath, "//select[@id='date']/option[@value='20120904']").click 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2016-02-05T16:37:01.440

就我而言，我有几个选项具有相同的文本，这就是我需要按值选择的原因。结合几个答案，我找到了最适合我的解决方案：

```
def select_by_value(id, value)
  option_xpath = "//*[@id='#{id}']/option[@value='#{value}']"
  find(:xpath, option_xpath).select_option
结尾

```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2014-09-10T10:56:15.007

单击使用 find_field 可以正常工作：

```
find_field("date").find("option[value='20120905']").click 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2016-01-22T16:22:53.703

您也可以使用[capybara-ui](https://github.com/mojotech/capybara-ui)，它会首先匹配文本，然后匹配值。

```
# define your form widget, in this case in a role
class UserRole < Capybara::UI::Role
  form :my_form do
    select :my_select, 'my_select'
  end
end

# then just submit your form params via #submit
role = UserRole.new

role.submit :my_form, my_select: '20120905' 
```

[在此处](https://github.com/mojotech/capybara-ui/blob/master/docs/widgets.md#forms)查看有关 capybara-ui 表单的更多信息。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2021-07-02T05:30:20.093

如果字段不可见，试试这个

```
find("#date", visible: false).find("option[value='20120905']").click 
```

或范围为：

```
within '#date', visible: false do
    find("option[value='20120905']").click
end 
```

# jquery - jQuery fadeIn 不使用位置属性（在 Internet Explorer 中）

> ID：12265177
> 
> 赞同：1
> 
> 时间：2012-09-04T14:03:34.797
> 
> 标签：jquery, css, internet-explorer

为什么 jQuery fadeIn() 不能在 IE 中使用位置 css 属性。所有其他浏览器都很好。

请在 IE 中查看 [http://jsfiddle.net/Ayy6W/56/](http://jsfiddle.net/Ayy6W/56/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-04T14:18:06.870

由于 IE 渲染引擎中的一个奇怪的继承问题，绝对元素不能从父级继承不透明度，除非该父级是相对定位的。不要问我为什么，我不知道，但事实就是如此。

```
#rollover {
    position:relative;
} 
```

是否需要将所有内容添加到 CSS 中，并且它在 IE 中可以完美运行。

示例：http: [//jsfiddle.net/Ayy6W/59/](http://jsfiddle.net/Ayy6W/59/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-04T14:10:32.100

我已经根据类似[问题的答案修改了你的](https://stackoverflow.com/q/6430540/944681)[小提琴](http://jsfiddle.net/Ayy6W/58/)。这可以作为一种解决方法..

# flash - 使用 as2 计算直到特定日期的天数

> ID：12265178
> 
> 赞同：1
> 
> 时间：2012-09-04T14:03:36.520
> 
> 标签：flash, actionscript-2

如何使用 as2 计算给定日期和今天之间的天数？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-04T14:07:15.263

浏览这段代码

```
// set up a date variable for Christmas 2006
// (n.b. Months are in the range 0-11)
var_Christmas = new Date(2006,11,25)
// set up a variable for todays date
var_Today = new Date();
// calculate the difference in milliseconds between the dates
difference_milliseconds = var_Christmas - var_Today;
trace (difference_milliseconds);
// convert millisecond difference into days
// (n.b. 1000 ms per second, 60000 ms per minute, 3600000 ms per hour, 86400000 ms per day)
difference_days = Math.floor(difference_milliseconds/86400000);
trace("There are " + difference_days + " days before Christmas"); 
```

# android - 通过国家代码检查手机号码是否有效

> ID：12265181
> 
> 赞同：3
> 
> 时间：2012-09-04T14:03:44.187
> 
> 标签：android, contacts

我有像“+919672525253”这样的联系人。现在我从那个号码中提取像“91”这样的国家代码。现在如果号码像“9672525253”并且如果我提取国家代码那么它会给我“967”。所以在提取后国家代码我如何检查剩余号码是否是该国家代码的有效手机号码？ **编辑**

如果有人知道国家/地区的手机号码长度，那么我也可以解决这个问题。就像印度的 10 位数字一样。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-04T14:07:44.367

你几乎不能。例如，在美国，手机号码和固定电话号码是无法区分的，它们有正常的区号，就像固定电话号码一样。即使每个国家/地区的做法都可能不同，并且随着数字用完而不断变化，新前缀被添加并且事情发生变化，并且它们不是您可以匹配的模式或您可以查找的数据库。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-04T14:10:39.857

看看[libPhoneNumber](http://code.google.com/p/libphonenumber/)（捆绑在 ICS 中），它可以帮助验证电话号码（请参阅 PhoneNumberUtils）。您可以在验证后获得一个 MobileType，但正如来源和 Ben 所述，在某些地区这将不起作用。

* * *

**编辑：**

一些验证码（这里我们需要检查手机是否有效，假设它是法国手机）：

```
boolean isValid = false;
PhoneNumber number = null;
try {
    number = this.phoneUtil.parse(phone, "FR"); // phone is number in internationnal format "+xxxxxx"
    isValid = this.phoneUtil.isValidNumber(number);
} catch (final NumberParseException e) {
    // ...
}

isValid // is the phone number valid according to the library?
this.phoneUtil.getRegionCodeForNumber(number); // this gets the country code of the phone as found by the library (for example "US", "CH", "GB", ...) 
```

这对我们有用，但您需要尝试一下，看看它是否适合您的需要。

# dynamics-crm-2011 - 尽管在设置中配置，但无法发送到未解析的电子邮件地址

> ID：12265183
> 
> 赞同：0
> 
> 时间：2012-09-04T14:03:58.853
> 
> 标签：dynamics-crm-2011

我想从一个硬编码的电子邮件地址在工作流程中发送一封电子邮件，并且我已确保该选项设置为在系统设置中允许这样做，但我仍然无法让它工作。

我错过了另一个设置吗？或者此选项是否只允许“收件人”字段中未解决的电子邮件？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-04T14:50:08.720

我不应该认为这可以通过硬编码的电子邮件地址工作。

Crm 本身不发送电子邮件，它要么使用用户 Outlook，要么使用电子邮件路由器 - 这两者都需要系统用户记录。

在 Outlook 的情况下，它实际上是由用户发送的，在电子邮件路由器的情况下，它通常是从交换机发送的。

Crm 不能只是假装是一个电子邮件地址。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-01-23T13:05:18.433

启用设置后，CRM 通常需要 10-12 小时才能将电子邮件发送到未解析的电子邮件地址。也许等待有帮助

# javascript - 记录 javascript 模块名称

> ID：12265184
> 
> 赞同：0
> 
> 时间：2012-09-04T14:04:08.453
> 
> 标签：javascript, jquery

我希望能够记录我的模块初始化以查看发生了什么。有没有办法获取模块命名空间并将其记录到控制台。

```
(function($, bis, window, document, undefined) {
    "use strict";
    //other app code
    bis.library = bis.library || function(module) {
        $(function() {
            if (module.init) {
                module.init();
                //how can I make it log the module namespace
                console.log('module' + module.toString() + 'initialized');
            }
        });
        return module;
    };

    //other app code
})(jQuery, window._bis = window._bis || {}, window, document); 
```

我的模块定义示例

```
(function($, bis, window, document, undefined) {
    "use strict";
    var common = bis.common,
        urls = bis.urls,
        defaults = bis.defaults,
        createWorklist = bis.createWorklist,
        editWorklist = bis.editWorklist,
        editMoveBoxesWorklist = bis.editMoveBoxesWorklist;

    bis.worklist = bis.worklist || bis.library((function() {
        // module variables
        var init = function() {
            //module init code
        };

        //other module code

        return {
            init: init
        };
    })());
})(jQuery, window._bis = window._bis || {}, window, document);​ 
```

因此，我希望行 console.log 记录以下文本“模块 bis.worklist 已初始化”。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-02T10:54:31.280

我按照Pointy的建议做了。我在我的模块中添加了一个 name 属性，只需使用

```
console.log(module.name); 
```

# azure - 提供的文件不是有效的服务包。详细错误代码：Azure 中的 InvalidOperationException

> ID：12265189
> 
> 赞同：0
> 
> 时间：2012-09-04T14:04:12.813
> 
> 标签：azure

我们必须更新部署到生产环境中的 Azure 包文件的 web.config 条目。我们下载 cspkg 文件并解压缩内容并修改我们的 web.config 并压缩回 zip 并将扩展名更改为 cspkg 。当我们上传包时，我们收到以下错误“提供的文件不是有效的服务包。详细错误代码：Azure 中的 InvalidOperationException”

有人对此事有想法吗？

-马亨德

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-04T14:42:02.367

不支持对 cspkg 文件进行“篡改”。[尝试使用CSPack](http://msdn.microsoft.com/en-us/library/gg432988.aspx)重新创建一个新的 cspkg 文件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-07T09:12:46.610

我自己解决了我的问题，按照 msdn 中的说明进行操作。我解压并使用 cspack 工具打包

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-09-09T05:27:44.330

使用 cspack.exe 重新生成包。使用以下命令。

```
cspack.exe "path_to_csdef_File\ServiceDefinition.csdef" /role:<RoleName>;<path_to_Binaries\approot> /out:D:\NewPackage.cspkg /rolePropertiesFile:<rolename>;<path_to_entry_point_file\entrypoint.txt> 
```

这篇文章中提到了重新生成包的详细步骤。

[https://amoghnatu.net/2016/09/08/recreate-azure-cloud-service-package/](https://amoghnatu.net/2016/09/08/recreate-azure-cloud-service-package/)

# html - 将图像图标添加到输入标签

> ID：12265190
> 
> 赞同：4
> 
> 时间：2012-09-04T14:04:15.717
> 
> 标签：html, asp.net-mvc, tags

我想将图标图像添加到输入标签，并且想知道是否有人对此主题有一些输入。

我当前的输入标签：

```
 <input class="glossyBtn"  type="submit" name="button" style="vertical-align: middle" value="Select"/> 
```

我要添加到输入中的图像，因此它将位于文本的左侧（值）：

```
<img alt="" style="vertical-align: middle" src="<%:Url.Content("~/Content/images/user.png")%>" /> 
```

提前谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-04T14:07:00.277

将该图像设置为`background`css`glossyBtn`类的图像。

*使用本地图像更改图像路径。*

```
.glossyBtn
{
    background-image:url('http://i50.tinypic.com/20keohf.jpg');
    background-repeat:no-repeat;
   background-position:left top;  padding-left:15px;
} 
```

工作样本：http: [//jsfiddle.net/6Nfvz/13/](http://jsfiddle.net/6Nfvz/13/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-04T14:18:26.963

如果图像需要可点击，您可以构建一个更复杂的控件：

[http://jsfiddle.net/NXAuT/1/](http://jsfiddle.net/NXAuT/1/)

```
<div class="con">
    <input type="text" />
    <img src="MY_IMAGE.PNG" />
</div>​

.con { width:180px; position:relative; border:1px solid #ccc; }
.con input { margin:0 0 0 4px; border:0; }
.con img { display:block; position:absolute; top:4px; left:164px; cursor:pointer; }​

$(".con img").click(function() {
  alert("Handler for .click() called.");
});​ 
```

如果图像没有与之关联的点击事件，则遵循其他人的建议并将其作为背景图像包含在内。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-04T14:07:23.967

试试这个。请相应地设置图像路径和填充

```
.glossyBtn {
background:url(../Content/images/user.png) left top no-repeat;
padding-left:15px;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-04T14:09:31.957

在glossyBtn中设置图像`background`并尝试`background-size`添加高度和宽度......

# javascript - 片段 uri 未在浏览器上执行

> ID：12265195
> 
> 赞同：1
> 
> 时间：2012-09-04T14:04:38.877
> 
> 标签：javascript, http, redirect, backbone.js, restlet

这是一个复杂的问题：

我在两部分中实现了一个 REST 应用程序：

*   服务器：使用 Restlet 2.0.14 实现
*   客户端：带有 Backbone.js 的 WebApp

在客户端，我的主干应用程序使用主干路由器 api，例如我有这个 uri：

“http://localhost:8000/myApp/#/resource1/attribute”

这是一个主干路由，就像我一样，当我把这个 url 放在网络浏览器中时，浏览器会发送到服务器：“http://localhost:8000/myApp/”，但第二部分（片段）用于执行当他从服务器下载应用程序时，我想它是正确的......

好吧，因为我正在使用 Restlet 实现自己的 Web 服务器，所以我想要下一个场景：

*   当用户在他的浏览器中输入这个 url：“http://localhost:8000/myApp/resource1/attribute”时，我的服务器必须返回主干 webapp，并且浏览器需要使用片段加载正确的视图（使用路由） .

为了实现这一点，我在我的restlet服务器上实现了一个重定向，当一个传入请求到url：“http://localhost:8000/myApp/resource1/attribute”时，我将它重定向到这个url：“http://localhost :8000/myApp/#/resource1/attribute/" 带有 307（临时重定向）并在“Location”标头中设置 url。

此时一切正常，浏览器收到重定向响应，浏览器再次使用此 url 调用服务器。我在网址栏中看到重定向网址。但是，路由不起作用，我收到了 webApp，但看起来浏览器没有执行 uri 的片段。

也许，任何人都可以给我看灯？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-04T14:16:18.180

问题在于重定向中的响应 url。最后的'/'必须省略，因为backbone.router中的路由是："resource1/:variable": "variableFunction"

在浏览器上执行的片段现在可以正常工作。

# php - Preg_replace 和 iso-8859-1 字符匹配

> ID：12265200
> 
> 赞同：1
> 
> 时间：2012-09-04T14:05:01.643
> 
> 标签：php, regex, iso-8859-1

我对 preg_replace 函数有疑问。

在我的代码中，我将使用它来删除字符串开头的所有不是字母或数字的字符。

这很好用，但是当 $string 包含 iso-8859-1 字符时，例如“è, ò, à, ù, é, ì”，则认为不是单词，并且全部被删除。

```
preg_replace('/^[^a-zA-Z0-9]+/', '', $string); 
```

IE。如果`$string`包含`èxample`输出将是`xample`.

我需要包括这些 iso-8859-1 元音。

有人对此有解决方案吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-04T14:13:45.847

PCRE 不支持 Unicode 块（在这种情况下事情会容易得多），所以除了手动指定允许的字符集（或其否定）之外，您真的别无选择。正则表达式看起来像

```
[^a-zA-Z0-9\xC0-\xFF]+ 
```

问题是该范围`\xC0-\xFF`还包括不受欢迎的字符（例如除号`\xF7`），因此您必须根据您的要求将其分解为可接受的子范围。查看[代码页布局](http://en.wikipedia.org/wiki/ISO/IEC_8859-1#Codepage_layout)以帮助确定哪些字符可以，哪些不可以。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-04T14:10:24.397

尝试

```
$string = "1èxample";
$r = preg_replace('/^[^\p{L}\p{Nd}]+/', '', $string);

echo $r; 
```

[在http://writecodeonline.com/php/](http://writecodeonline.com/php/)上测试

输出

> 1示例

`\p{L}`是任何语言的任何字母。所以这匹配任何字母。

`\p{Nd}`是任何语言的任何数字。

有关更多详细信息，请参阅[regular-expressions.info 上的 Unicode 字符属性。](http://www.regular-expressions.info/unicode.html#prop)

# java - Android相机存储图像（原始）：更新后奇怪的图片

> ID：12265207
> 
> 赞同：1
> 
> 时间：2012-09-04T14:05:25.967
> 
> 标签：java, android, image, camera

目前我正在尝试使用android相机，我的测试项目已经很远了。在我的 HTC Desire S 和 Gingerbread Android 上进行测试时，它工作得非常好。然而，在我更新到使用测试应用程序拍摄的 ICS 图片后，只显示奇怪的垂直线（这是完全相同的代码）。这是现在突然创建的图像：http: [//imageshack.us/photo/my-images/191/rebuilder1.jpg/](http://imageshack.us/photo/my-images/191/rebuilder1.jpg/)

这是我的代码（全班）：

```
 package inter.rebuilder;

import inter.rebuilder.R;

import java.io.BufferedOutputStream;
import java.io.ByteArrayOutputStream;
import java.io.File;
import java.io.FileNotFoundException;
import java.io.FileOutputStream;
import java.io.IOException;
import java.util.List;

import android.app.Activity;
import android.content.Context;
import android.content.Intent;
import android.content.pm.PackageManager;
import android.content.res.Configuration;
import android.graphics.Bitmap;
import android.graphics.BitmapFactory;
import android.graphics.Color;
import android.graphics.ImageFormat;
import android.graphics.Matrix;
import android.graphics.PixelFormat;
import android.graphics.Bitmap.CompressFormat;
import android.graphics.Rect;
import android.graphics.YuvImage;
import android.hardware.Camera;
import android.hardware.Camera.AutoFocusCallback;
import android.hardware.Camera.ErrorCallback;
import android.hardware.Camera.PreviewCallback;
import android.hardware.Camera.Size;
import android.os.Bundle;
import android.os.Environment;
import android.util.Log;
import android.view.KeyEvent;
import android.view.Menu;
import android.view.MotionEvent;
import android.view.Surface;
import android.view.SurfaceHolder;
import android.view.SurfaceView;
import android.view.View;
import android.view.Window;
import android.view.WindowManager;
import android.view.View.OnClickListener;
import android.view.View.OnTouchListener;

public class CameraView extends Activity implements SurfaceHolder.Callback,
        OnClickListener {
    static final int FOTO_MODE = 0;
    private static final String TAG = "CameraTest";
    Camera mCamera;
    boolean mPreviewRunning = false;
    private Context mContext = this;

    public void onCreate(Bundle icicle) {
        super.onCreate(icicle);
        //boolean hasCam = checkCameraHardware(mContext);
        Log.e(TAG, "onCreate");

        Bundle extras = getIntent().getExtras();

        getWindow().setFormat(PixelFormat.TRANSLUCENT);
        requestWindowFeature(Window.FEATURE_NO_TITLE);
        getWindow().setFlags(WindowManager.LayoutParams.FLAG_FULLSCREEN,
                WindowManager.LayoutParams.FLAG_FULLSCREEN);
        setContentView(R.layout.main);
        mSurfaceView = (SurfaceView) findViewById(R.id.surface_camera);
        mSurfaceView.setOnClickListener(this);
        mSurfaceHolder = mSurfaceView.getHolder();
        mSurfaceHolder.addCallback(this);
        mSurfaceHolder.setType(SurfaceHolder.SURFACE_TYPE_PUSH_BUFFERS);
    }

    @Override
    protected void onRestoreInstanceState(Bundle savedInstanceState) {
        super.onRestoreInstanceState(savedInstanceState);
    }

    Camera.PreviewCallback mPreviewCallback = new PreviewCallback() {

        public void onPreviewFrame(byte[] data, Camera camera) {

            Camera.Parameters parameters = camera.getParameters();

            int width = parameters.getPreviewSize().width;
            int height = parameters.getPreviewSize().height;

            ByteArrayOutputStream outstr = new ByteArrayOutputStream();
            Rect rect = new Rect(0, 0, width, height); 
            YuvImage yuvimage=new YuvImage(data,ImageFormat.NV21,width,height,null);
            yuvimage.compressToJpeg(rect, 100, outstr);
            Bitmap bmp = BitmapFactory.decodeByteArray(outstr.toByteArray(), 0, outstr.size());
        }
    };

    Camera.PictureCallback mPictureCallback = new Camera.PictureCallback() {
        public void onPictureTaken(byte[] imageData, Camera c) {

            if (imageData != null) {
                Intent mIntent = new Intent();
                storeByteImage(mContext, imageData, 100);
                try {
                    mCamera.unlock();
                    mCamera.reconnect();
                } catch (IOException e) {
                    // TODO Auto-generated catch block
                    e.printStackTrace();
                }
                setResult(FOTO_MODE, mIntent);
                startCameraPreview();

                //mCamera.startPreview();
                //finish();
                //Intent intent = new Intent(CameraView.this, AndroidBoxExample.class);
                //CameraView.this.startActivity(intent);
            }
        }
    };

    private boolean checkCameraHardware(Context context) {
        if (context.getPackageManager().hasSystemFeature(PackageManager.FEATURE_CAMERA)){
            // this device has a camera
            return true;
        } else {
            // no camera on this device
            return false;
        }
    }

    protected void onResume() {
        Log.e(TAG, "onResume");
        super.onResume();
    }

    protected void onSaveInstanceState(Bundle outState) {
        super.onSaveInstanceState(outState);
    }

    protected void onPause() {
        Log.e(TAG, "onPause");
        super.onPause();
    }

    protected void onStop() {
        Log.e(TAG, "onStop");
        super.onStop();
    }

    public void surfaceCreated(SurfaceHolder holder) {
        Log.e(TAG, "surfaceCreated");
        mCamera = Camera.open();
        //mCamera.unlock();
        //mCamera.setDisplayOrientation(180);

    }

    private void startCameraPreview() {
        Camera.Parameters p = mCamera.getParameters();
        p.setPictureFormat(PixelFormat.JPEG);
        //p.setPreviewSize(w, h);

        List<Size> list = p.getSupportedPreviewSizes();
        Camera.Size size = list.get(0);
        p.setPreviewSize(size.width, size.height);
        mCamera.setParameters(p);
        mCamera.startPreview();
        mPreviewRunning = true;
    }

    private void startCameraPreview(SurfaceHolder holder) {
        Camera.Parameters p = mCamera.getParameters();
        //p.setPreviewSize(w, h);

        List<Size> list = p.getSupportedPreviewSizes();
        Camera.Size size = list.get(0);
        p.setPreviewSize(size.width, size.height);
        mCamera.setParameters(p);
        try {
            mCamera.setPreviewDisplay(holder);
        } catch (IOException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        }
        mCamera.startPreview();
        mPreviewRunning = true;
        //setCameraDisplayOrientation(this, 0, mCamera);
    }

    public void surfaceChanged(SurfaceHolder holder, int format, int w, int h) {
        Log.e(TAG, "surfaceChanged");

        // XXX stopPreview() will crash if preview is not running
        if (mPreviewRunning) {
            mCamera.stopPreview();
            mPreviewRunning = false;
        }

        startCameraPreview(holder);
    }

    public void surfaceDestroyed(SurfaceHolder holder) {
        Log.e(TAG, "surfaceDestroyed");
        mCamera.setPreviewCallback(null);
        mCamera.stopPreview();
        mPreviewRunning = false;
        mCamera.release();
    }

    @Override
    public void onConfigurationChanged(Configuration newConfig) {
        // TODO Auto-generated method stub
        mCamera.setPreviewCallback(null);
        mCamera.stopPreview();
        mPreviewRunning = false;
        mCamera.release();
        super.onConfigurationChanged(newConfig);
    }

    @Override
    public void onContentChanged() {
        // TODO Auto-generated method stub
        super.onContentChanged();
    }

    @Override
    public void onContextMenuClosed(Menu menu) {
        // TODO Auto-generated method stub
        mCamera.setPreviewCallback(null);
        mCamera.stopPreview();
        mPreviewRunning = false;
        mCamera.release();
        super.onContextMenuClosed(menu);
    }

    private SurfaceView mSurfaceView;
    private SurfaceHolder mSurfaceHolder;

    public void onClick(View arg0) {

        mCamera.takePicture(null, mPictureCallback, mPictureCallback);

    }

    private static File createDir() throws IOException {
        String nameDir = "rebuilder";
        File extStorageDir = Environment.getExternalStorageDirectory();
        File sdImageMainDirectory = extStorageDir; //new File("/sdcard");
        File dirFile = new File(sdImageMainDirectory.getPath()+"/"+nameDir);

        boolean fileExisted = dirFile.exists();
        if(!fileExisted) {
            dirFile.mkdirs();
        }
        return dirFile;
    }

    private static File createFile(String name, File dirFile) throws IOException {
        int counter = 1;
        String fileName = name + counter+".jpg";
        File imageFile = new File(dirFile.getPath()+"/"+fileName);
        while(imageFile.exists()) {
            counter = counter + 1;
            fileName = name + counter+".jpg";
            imageFile = new File(dirFile.getPath()+"/"+fileName);
        }
        imageFile.createNewFile();
        return imageFile;
    }

    static Bitmap image1 = null;
    static Bitmap image2 = null;
    public static void blendTest(Bitmap myImage) throws IOException {
        if(image1 == null && image2 == null) {
            image1 = myImage;
            return;
        }

        if(image1 != null && image2 != null) {
            image2 = null;
            image1 = myImage;
            return;
        }

        if(image1 != null && image2 == null) {
            image2 = myImage;
        }

        int width = Math.min(image1.getWidth(), image2.getWidth());
        int height = Math.min(image1.getHeight(), image2.getHeight());
        int[][] pixels1 = new int[width][height];
        int[][] pixels2 = new int[width][height];

        for(int i = 0; i < width; i++) {
            for(int j = 0; j < height; j++) {
                pixels1[i][j] = image1.getPixel(i, j);
            }
        }

        for(int i = 0; i < width; i++) {
            for(int j = 0; j < height; j++) {
                pixels2[i][j] = image2.getPixel(i, j);
            }
        }

        Bitmap image3 = Bitmap.createBitmap(width, height, image1.getConfig());
        for(int i = 0; i < width; i++) {
            for(int j = 0; j < height; j++) {
                int color1 = pixels1[i][j];
                int color2 = pixels2[i][j];

                int red1 = Color.red(color1);
                int red2 = Color.red(color2);
                int green1 = Color.green(color1);
                int green2 = Color.green(color2);
                int blue1 = Color.blue(color1);
                int blue2 = Color.blue(color2);

                int newColor = Color.rgb((red1 + red2)/2, (green1 + green2)/2, (blue1 + blue2)/2);
                image3.setPixel(i, j, newColor);
            }
        }

        File dirFile = createDir();
        File newBlend = createFile("blend", dirFile);

        FileOutputStream fileOutputStream = new FileOutputStream(newBlend);         

        BufferedOutputStream bos = new BufferedOutputStream(
                fileOutputStream);

        image3.compress(CompressFormat.JPEG, 100, bos);

        bos.flush();
        bos.close();

    }

//   public static void setCameraDisplayOrientation(Activity activity,
//           int cameraId, android.hardware.Camera camera) {
//       android.hardware.Camera.CameraInfo info =
//               new android.hardware.Camera.CameraInfo();
//       android.hardware.Camera.getCameraInfo(cameraId, info);
//       int rotation = activity.getWindowManager().getDefaultDisplay()
//               .getRotation();
//       int degrees = 0;
//       switch (rotation) {
//           case Surface.ROTATION_0: degrees = 0; break;
//           case Surface.ROTATION_90: degrees = 90; break;
//           case Surface.ROTATION_180: degrees = 180; break;
//           case Surface.ROTATION_270: degrees = 270; break;
//       }
//
//       int result;
//       if (info.facing == Camera.CameraInfo.CAMERA_FACING_FRONT) {
//           result = (info.orientation + degrees) % 360;
//           result = (360 - result) % 360;  // compensate the mirror
//       } else {  // back-facing
//           result = (info.orientation - degrees + 360) % 360;
//       }
//       camera.setDisplayOrientation(result);
//   }

    public static boolean storeByteImage(Context mContext, byte[] imageData, int quality) {
        FileOutputStream fileOutputStream = null;       
        try {
            File dirFile = createDir();
            File imageFile = createFile("rebuilder", dirFile);

            BitmapFactory.Options options=new BitmapFactory.Options();
            options.inSampleSize = 5;  //5

            options.inDither = false; // Disable Dithering mode
            options.inPurgeable = true; // Tell to gc that whether it needs free
                                        // memory, the Bitmap can be cleared
            options.inInputShareable = true; // Which kind of reference will be
                                                // used to recover the Bitmap
                                                // data after being clear, when
                                                // it will be used in the future
            options.inTempStorage = new byte[32 * 1024];
            options.inPreferredConfig = Bitmap.Config.RGB_565;

            Bitmap myImage = BitmapFactory.decodeByteArray(imageData, 0,
                    imageData.length,options);

            int orientation;
             // others devices
            if(myImage.getHeight() < myImage.getWidth()){
                orientation = 90;
            } else {
                orientation = 0;
            }

            Bitmap bMapRotate;
            if (orientation != 0) {
                Matrix matrix = new Matrix();
                matrix.postRotate(orientation);
                bMapRotate = Bitmap.createBitmap(myImage, 0, 0, myImage.getWidth(),
                        myImage.getHeight(), matrix, true);
            } else
                bMapRotate = Bitmap.createScaledBitmap(myImage, myImage.getWidth(),
                        myImage.getHeight(), true);

            //blendTest(myImage);

            fileOutputStream = new FileOutputStream(imageFile);         

            BufferedOutputStream bos = new BufferedOutputStream(
                    fileOutputStream);

            bMapRotate.compress(CompressFormat.JPEG, quality, bos);
            if (bMapRotate != null) {
                bMapRotate.recycle();
                bMapRotate = null;
            }

            bos.flush();
            bos.close();

        } catch (FileNotFoundException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        } catch (IOException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
            System.out.println("SD Card not ready");
        }

        return true;
    }

} 
```

相机硬件权限和方向横向在 android 清单中设置。请在这里帮助我。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-28T09:27:18.470

您是否在设备上安装了自定义 ROM？如果是，那么这可能是一个问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-08-07T06:33:01.260

取消注释该方法及其所有出现（截至 OP 的代码）

```
 //   public static void setCameraDisplayOrientation(Activity activity,
    //           int cameraId, android.hardware.Camera camera) {
    //       android.hardware.Camera.CameraInfo info =
    //               new android.hardware.Camera.CameraInfo();
    //       android.hardware.Camera.getCameraInfo(cameraId, info);
    //       int rotation = activity.getWindowManager().getDefaultDisplay()
    //               .getRotation();
    //       int degrees = 0;
    //       switch (rotation) {
    //           case Surface.ROTATION_0: degrees = 0; break;
    //           case Surface.ROTATION_90: degrees = 90; break;
    //           case Surface.ROTATION_180: degrees = 180; break;
    //           case Surface.ROTATION_270: degrees = 270; break;
    //       }
    //
    //       int result;
    //       if (info.facing == Camera.CameraInfo.CAMERA_FACING_FRONT) {
    //           result = (info.orientation + degrees) % 360;
    //           result = (360 - result) % 360;  // compensate the mirror
    //       } else {  // back-facing
    //           result = (info.orientation - degrees + 360) % 360;
    //       }
    //       camera.setDisplayOrientation(result);
    //   } 
```

# highcharts - 获取系列可见性的价值

> ID：12265208
> 
> 赞同：4
> 
> 时间：2012-09-04T14:05:36.403
> 
> 标签：highcharts, highstock

是否有可能获得一个系列的可见性的价值？我知道如何改变它。但是有没有类似 series.getVisibility() 的东西？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-09-04T14:18:31.880

[`series`](http://api.highcharts.com/highstock#object-Series)命名的对象上有一个只读属性`visible`，您可以使用它。

```
series.visible 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-04T16:50:02.970

假设这`chart`是您的图表变量。
`chart.series[0].visible`，获得第一个系列可见性。

# .net - .net 或 api 以编程方式设置 spn

> ID：12265209
> 
> 赞同：1
> 
> 时间：2012-09-04T14:05:37.593
> 
> 标签：.net, winapi, active-directory, kerberos

> **可能重复：**
> [在没有 SetSPN 的 Windows 域上查询/更改 SPN](https://stackoverflow.com/questions/416241/query-change-spns-on-windows-domain-without-setspn)

我有一个需要注册服务主体名称 (SPN) 的服务。我知道我可以使用 setspn.exe 实用程序来做到这一点。我想知道如何在不使用 setspn.exe 实用程序的情况下以编程方式向 AD 注册 SPN (ServicePrincipalName)。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-05T05:33:47.627

我不知道 .net 中的特定于 SPN 注册的 API（很想知道我是否错了并且有一个）。但是您可以使用您最喜欢的 LDAP API 在 LDAP 上编写它们。

# java - “知道”当前打开的文档的插件？

> ID：12265215
> 
> 赞同：2
> 
> 时间：2012-09-04T14:05:53.017
> 
> 标签：java, eclipse, eclipse-plugin, lotus-notes

我想构建一个插件，它在 Notes 客户端（8.5.2++）加载时加载，每当打开文档时都会调用它并获取该文档的（Notes）URL。我需要哪些扩展点和 API？

**澄清**：
我确实知道如何访问当前文档（NotesUIWorkspace.currentDocument）。我不知道如何（以及何时）注册一个监听器以获得通知。
**特殊挑战**：文档可以在 Framesets（多个）中打开，文档可以作为复合页面的一部分打开。框架集不是一个大问题，而是复合。如果这需要听任何页面打开并检查它 - 我很好

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-06T05:54:57.363

我们通过获取任何类型的“帖子选择”的所有请求来解决这个问题。以下代码片段来自侧边栏插件，并在 createViewPart() 中调用：

```
m_Observer = new NotesSelectionObserverImpl();
NotesSelectionObservable cObservable = new NotesSelectionObservable();
PlatformUI.getWorkbench().getActiveWorkbenchWindow().getSelectionService().addPostSelectionListener(cObservable);
cObservable.addObserver(this.m_Observer); 
```

魔术的第一部分是“PlattformUI ......addPostSelecitonListener();” 在这一点上，我们注册了我们的监听器，witch 也是基于观察者模式的。

```
class NotesSelectionObserverImpl implements NotesSelectionObserver {

            @Override
            public void onSelectionChange(NotesSelectionContext cContext)
                throws NotesException {
            Database ndbCurrent = cContext.getDatabase();
            Document docCurrent = cContext.getDocument();

            if (ndbCurrent != null && docCurrent != null) {
                String strEMail = "";
                if (docCurrent.getItemValueString("Form").equals("Memo")
                        || docCurrent.getItemValueString("Form")
                                .equals("Reply")) {
                    strEMail = docCurrent.getItemValueString("From");
                    strEMail = parseEMail(strEMail);

                    System.out.println("EMAIL: " + strEMail);
                    ContextCommand ccCurrent = new ContextCommand(strEMail,
                            docCurrent.getItemValueString("Subject"));
                    m_State.doFeedAction(false, m_Feeds.get(Activator.FEED_CONTEXT_ID), ccCurrent);
                }

            }
        }

        @Override
        public void onUpdateAfterSelectionChange() {
            // TODO Auto-generated method stub

        }

    } 
```

NotesSelectionObserver 是一个具有以下定义的接口：

```
import lotus.domino.NotesException;

public interface NotesSelectionObserver
{
    void onSelectionChange(NotesSelectionContext cContext) throws NotesException;

    void onUpdateAfterSelectionChange();
} 
```

NotesSelecitonContext 是另一个提供有关选择的所有信息的接口。这里的定义：

```
import lotus.domino.Database;
import lotus.domino.Document;

public interface NotesSelectionContext
{
    public Database getDatabase();

    public Document getDocument();

    public String getField();
} 
```

所以现在最后一部分，女巫是线索.... NotesSelectionObservable：

```
import java.net.MalformedURLException;
import java.net.URL;
import java.util.StringTokenizer;
import java.util.Vector;

import lotus.domino.Database;
import lotus.domino.Document;
import lotus.domino.NotesException;
import lotus.domino.Session;

import org.eclipse.core.runtime.IProgressMonitor;
import org.eclipse.core.runtime.IStatus;
import org.eclipse.core.runtime.Status;
import org.eclipse.core.runtime.jobs.Job;
import org.eclipse.jface.viewers.ISelection;
import org.eclipse.jface.viewers.StructuredSelection;
import org.eclipse.ui.INullSelectionListener;
import org.eclipse.ui.IWorkbenchPart;
import org.eclipse.ui.progress.UIJob;

import com.ibm.csi.types.DocumentSummary;
import com.ibm.notes.java.api.util.NotesSessionJob;
import com.ibm.notes.java.ui.documents.NotesUIField;
import com.ibm.workplace.noteswc.selection.NotesApplicationInfo;
import com.ibm.workplace.noteswc.selection.NotesFieldSelection;
import com.ibm.workplace.noteswc.selection.NotesTextSelection;

public class NotesSelectionObservable implements INullSelectionListener {
    public void addObserver(NotesSelectionObserver cObserver) {
        if (!this.m_cObserverList.contains(cObserver))
            this.m_cObserverList.add(cObserver);
    }

    public void removeObserver(NotesSelectionObserver cObserver) {
        this.m_cObserverList.remove(cObserver);
    }

    public void selectionChanged(IWorkbenchPart cPart, ISelection cSelection) {
        if (cSelection == null || cSelection.isEmpty())
            this.clearSelection();
        else if (cSelection instanceof StructuredSelection) {
            Object cObj = ((StructuredSelection) cSelection).getFirstElement();
            if (cObj instanceof DocumentSummary) {
                DocumentSummary cSummary = (DocumentSummary) cObj;
                this.setURL(cSummary.getUrl());
                if (cSummary.getDocumentKey() != null)
                     this.setURL(cSummary.getDocumentKey().getUniqueId());
            } else if (cObj instanceof NotesApplicationInfo) {
                NotesApplicationInfo cInfo = (NotesApplicationInfo) cObj;
                this.setURL(cInfo.getUrl());
            }
            if (cObj instanceof NotesFieldSelection) {
                NotesUIField f = ((NotesFieldSelection)cObj).getCurrentField();
                this.setField(f.getName());
            }
            if (cObj instanceof NotesTextSelection) {
                // String strOut = ((NotesTextSelection) cObj).getText();
                // System.out.println("Selektierter Text: " + strOut);
            }
            if (false) {
                Class<? extends Object> c;
                String cl = null;
                for (c = cObj.getClass(); c != null; c = c.getSuperclass()) {
                    if (c.equals(Object.class))
                        break;
                    cl = cl != null ? cl + " : " + c.getName() : c.getName();
                }
                System.out.println("Type of selected object: " + cl);
            }
        }
        if (this.m_bModified) {
            this.startJob();
            this.m_bModified = false;
        }
    }

    private void clearSelection() {
        this.m_strDatabaseRepID = null;
        this.m_strDatabaseServer = null;
        this.m_strDocumentUNID = null;
        this.m_strDesginElement = null;
        this.m_strField = null;
        this.m_bModified = true;
    }

    private void setDatabase(String strRepID, String strServer) {
        if (strRepID.equals(this.m_strDatabaseRepID) == false
                || (strServer != null && this.m_strDatabaseServer == null)
                || (this.m_strDatabaseServer != null && this.m_strDatabaseServer.equals(strServer) == false)) {
            this.m_strDatabaseRepID = strRepID;
            this.m_strDatabaseServer = strServer;
            this.m_strDesginElement = null;
            this.m_strDocumentUNID = null;
            this.m_strField = null;
            this.m_bModified = true;
        }
    }

    private void setDesignElement(String strUNID) {
        if (!strUNID.equals(this.m_strDesginElement)) {
            this.m_strDesginElement = strUNID;
            this.m_strDocumentUNID = null;
            this.m_strField = null;
            this.m_bModified = true;
        }
    }

    private void setDocument(String strDocumentUNID) {
        if (!strDocumentUNID.equals(this.m_strDocumentUNID)) {
            this.m_strDocumentUNID = strDocumentUNID;
            this.m_strField = null;
            this.m_bModified = true;
        }
    }

    private void setField(String strField) {
        if (!strField.equals(this.m_strField)) {
            this.m_strField = strField;
            this.m_bModified = true;
        }
    }

    private void setURL(String strURL) {
        if (strURL == null || strURL.isEmpty())
            return;
        URL cURL;
        try {
            cURL = new URL(strURL);
        } catch (MalformedURLException e) {
            return;
        }
        if (!cURL.getProtocol().equalsIgnoreCase("notes"))
            return;
        StringTokenizer cToken = new StringTokenizer(cURL.getPath()
                .substring(1), "/");
        if (cToken.hasMoreElements())
            this.setDatabase(cToken.nextToken(),
                    cURL.getHost().isEmpty() ? null : cURL.getHost());
        else
            return;
        if (cToken.hasMoreElements())
            this.setDesignElement(cToken.nextToken());
        else
            return;
        if (cToken.hasMoreElements())
            this.setDocument(cToken.nextToken());
    }

    private void startJob() {
        if (this.m_strDatabaseRepID != null && this.m_cObserverList.size() > 0) {
            Job cJob = new TheJob(this);
            cJob.schedule();
            try {
                cJob.join();
                for (NotesSelectionObserver o : this.m_cObserverList)
                    o.onUpdateAfterSelectionChange();
                this.m_bModified = false;
            } catch (InterruptedException e) {
                return;
            }
            cJob = new TheUIJob(this);
            cJob.schedule();
        }
    }

    private class NotesSelectionContextImp implements NotesSelectionContext {
        public Database getDatabase() {
            return cDatabase;
        }

        public Document getDocument() {
            return cDocument;
        }

        public String getField() {
            return strField;
        }

        public Database cDatabase;
        public Document cDocument;
        public String strField;
    }

    private class TheJob extends NotesSessionJob {
        public TheJob(NotesSelectionObservable cObservable) {
            super(cObservable.getClass().getName() + ".selectionChanged()");
            this.m_strRepID = cObservable.m_strDatabaseRepID;
            this.m_strServer = cObservable.m_strDatabaseServer != null ? cObservable.m_strDatabaseServer
                    : "";
            if (this.m_strServer.contains("%2F"))
                this.m_strServer = this.m_strServer.replace("%2F", "/");
            this.m_strDocumentUNID = cObservable.m_strDocumentUNID;
            this.m_cContext.strField = cObservable.m_strField;
            this.m_cObservable = cObservable;
        }

        protected IStatus runInNotesThread(Session cSession,
                IProgressMonitor cProgress) throws NotesException {
            this.m_cContext.cDatabase = cSession.getDbDirectory(this.m_strServer).openDatabaseByReplicaID(this.m_strRepID);
            if (!this.m_cContext.cDatabase.isOpen()) {
                this.m_cContext.cDatabase.open();

            }
            this.m_cContext.cDocument = this.m_strDocumentUNID != null ? this.m_cContext.cDatabase.getDocumentByUNID(this.m_strDocumentUNID)
                    : null;
            for (NotesSelectionObserver o : this.m_cObservable.m_cObserverList)
                o.onSelectionChange(this.m_cContext);
            return Status.OK_STATUS;
        }

        private NotesSelectionContextImp m_cContext = new NotesSelectionContextImp();
        private NotesSelectionObservable m_cObservable;
        private String m_strRepID;
        private String m_strServer;
        private String m_strDocumentUNID;
    }

    private class TheUIJob extends UIJob {
        public TheUIJob(NotesSelectionObservable cObservable) {
            super(cObservable.getClass().getName() + ".selectionChanged()");
            this.m_cObservable = cObservable;
        }

        public IStatus runInUIThread(IProgressMonitor arg0) {
            for (NotesSelectionObserver o : this.m_cObservable.m_cObserverList)
                o.onUpdateAfterSelectionChange();
            this.m_cObservable.m_bModified = false;
            return Status.OK_STATUS;
        }

        private NotesSelectionObservable m_cObservable;
    }

    private String m_strDatabaseRepID = null;
    private String m_strDatabaseServer = null;
    private String m_strDesginElement = null;
    private String m_strDocumentUNID = null;
    private String m_strField = null;
    private boolean m_bModified = false;
    private Vector<NotesSelectionObserver> m_cObserverList = new Vector<NotesSelectionObserver>();
} 
```

您还询问了插件列表：

```
 org.eclipse.ui,
 org.eclipse.core.runtime,
 com.ibm.notes.java.api;bundle-version="1.5.1",
 com.ibm.notes.java.ui;bundle-version="8.5.1",
 com.ibm.csi;bundle-version="1.5.1",
 com.ibm.notes.client;bundle-version="8.5.1" 
```

我们还将将此代码作为插件带到 openNTF 社区。我认为任何想要通过侧边栏扩展notesclient 的人都需要了解用户所在的女巫上下文并希望对此上下文做出响应。

# java - Why can't I enter a string in Scanner(System.in), when calling nextLine()-method?

> ID：12265216
> 
> 赞同：10
> 
> 时间：2012-09-04T14:05:54.247
> 
> 标签：java, user-input, java.util.scanner

How does this program actually work...?

```
import java.util.Scanner;

class string
{
    public static void main(String a[]){
        int a;
        String s;
        Scanner scan = new Scanner(System.in);

        System.out.println("enter a no");
        a = scan.nextInt();
        System.out.println("no is ="+a);

        System.out.println("enter a string");
        s = scan.nextLine();
        System.out.println("string is="+s);
    }
} 
```

The output is:

```
enter the no
1234
no is 1234
enter a string
string is=         //why is it not allowing me to enter a string here? 
```

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-09-04T14:09:32.670

`.nextInt()`获取下一个`int`，但不读取换行符。这意味着当您要求它读取“下一行”时，您会从第一次读取到换行符的末尾。

您可以在获得解决此问题`.nextLine()`后插入另一个。或者（我更喜欢这种方式），将in 作为 a`int`读取，然后将其解析为.`int``string``int`

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-09-04T14:14:35.013

这是一个常见的误解，如果您在使用 nextInt() 之后立即对 nextLine() 使用相同的 Scanner，则会导致混淆。

您可以自己修复光标跳到下一行，也可以为整数使用不同的扫描仪。

**选项 A：使用 2 种不同的扫描仪**

```
import java.util.Scanner;

class string
{

    public static void main(String a[]){
    int a;
    String s;
    Scanner intscan =new Scanner(System.in);

    System.out.println("enter a no");
    a=intscan.nextInt();
    System.out.println("no is ="+a);

     Scanner textscan=new Scanner(System.in);
    System.out.println("enter a string");
    s=textscan.nextLine();
    System.out.println("string is="+s);
        }
} 
```

**选项 B：直接跳到下一行**

```
class string
{
    public static void main(String a[]){
        int a;
        String s;
        Scanner scan =new Scanner(System.in);

        System.out.println("enter a no");
        a = scan.nextInt();
        System.out.println("no is ="+a);
        scan.nextLine();

        System.out.println("enter a string");
        s = scan.nextLine();
        System.out.println("string is="+s);
    }
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-04T14:09:59.277

您只需要使用`scan.next()`读取一个`String`.

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2016-07-09T15:46:32.110

这是因为在 nextInt() 执行完成后，当调用 nextLine() 方法时，它会扫描 nextInt() 之后出现的换行符。您可以通过以下任一方式执行此操作：

1.  您可以在 nextInt() 之后使用另一个 nextLine() 方法将扫描仪移过换行符。
2.  您可以使用不同的 Scanner 对象来扫描整数和字符串（您可以将它们命名为 scan1 和 scan2）。
3.  您可以在扫描仪对象上使用下一个方法作为

    扫描.next();

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-09-17T09:58:35.890

不要尝试使用 nextLine() 扫描文本；在使用 nextInt() 和相同的扫描仪之后！它不适用于 Java Scanner，许多 Java 开发人员选择只使用另一个 Scanner 来处理整数。如果需要，您可以将这些扫描仪称为 scan1 和 scan2。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-09-13T14:24:32.637

当我们通过 scan.nextLine() 获取输入字符串时，扫描仪的缓冲区已满；所以它下次跳过输入。所以解决方法是我们可以创建一个新的 Scanner 对象，对象的名字可以和之前的对象一样......

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2017-04-25T07:14:40.657

使用**临时** `scan.nextLine();`的，这将消耗 \n 字符

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2013-09-17T10:11:16.707

如果您不想使用解析器：

```
int a;
String s;
Scanner scan = new Scanner(System.in);

System.out.println("enter a no");
a = scan.nextInt();
System.out.println("no is =" + a);
scan.nextLine(); // This line you have to add (It consumes the \n character)
System.out.println("enter a string");
s = scan.nextLine();
System.out.println("string is=" + s); 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2017-07-18T22:20:56.937

```
import java.util.*;

public class ScannerExample {

    public static void main(String args[]) {
        int a;
        String s;
        Scanner scan = new Scanner(System.in);

        System.out.println("enter a no");
        a = scan.nextInt();
        System.out.println("no is =" + a);

        System.out.println("enter a string");
        s = scan.next();
        System.out.println("string is=" + s);
    }
} 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2021-06-09T17:41:28.563

`.nextInt()`如果您在它之后声明，将不会阅读“下一行”直到最后`.nextLine()`。我建议尝试在“int”之前扫描“String”

```
s = scan.nextLine();
a = scan.nextInt(); 
```

以该顺序。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2016-05-30T11:21:48.547

如果您不想使用 nextint，您也可以使用缓冲阅读器，其中使用`inputstream`和`readline`函数读取字符串。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2017-06-06T02:39:05.600

使用 \n 字符的简单解决方案：

```
import java.util.Scanner;
class string
{
    public static void main(String a[]){
        int a;
        String s;
        Scanner scan = new Scanner(System.in);

        System.out.println("enter a no");
        a = scan.nextInt();
        System.out.println("no is ="+a);

        scan.nextLine();
        System.out.println("enter a string");
        s = scan.nextLine();
        System.out.println("string is="+s);
    }
} 
```

* * *

## 回答 #13

> 赞同：-1
> 
> 时间：2012-09-04T14:17:37.337

```
 s=scan.nextLine(); 
```

它返回输入被跳过。

所以你可以使用

```
 s=scan.next(); 
```

# javascript - 如何使用原型继承编写一个整洁灵活的复杂 javascript 应用程序

> ID：12265219
> 
> 赞同：2
> 
> 时间：2012-09-04T14:06:06.120
> 
> 标签：javascript, oop, architecture, prototypal-inheritance

一段时间以来，我一直在开发 javascript 应用程序，通常是较小的脚本来完成简单的任务，但也是一个相当大且复杂的应用程序，它使用[Dean Edwards 的 base2 库](http://code.google.com/p/base2/)来创建具有继承的伪经典 OO 类，......在 javascript 中。

base2 库为我提供了很好的服务，主要是因为它使我能够遵循我非常熟悉的经典 OO 范式。我还知道其他几个可用于构建更强大和成熟的 javascript 应用程序的框架（例如， [backbone.js ）。](http://documentcloud.github.com/backbone/)但我总觉得这种类型的库是一种“作弊”的方式，即构建一种使用该语言实际上不适合的原则编写代码的方式。

我一直在阅读定义对象/函数、实例化它们以及使用原型继承实现多态性的不同方法。这实际上是该语言在基本层面上的工作方式，我觉得我应该利用这一点，而不是认为它很烦人或很奇怪，并试图找到一种方法来按照我习惯的方式做事（经典的 OO 方式）。

因此，查看不使用此类库的应用程序，似乎有很多方法可以编写您的应用程序，而对于 Java、C++ 等传统通用语言......构建应用程序的正确方法似乎更明确（区分好代码和坏代码要容易得多）。如果明天有人问我：“开始为我开发 projectX”，我将不知道如何开始定义和构建我的对象，我可以确定当重组为时已晚时不会回来咬我整个东西。

**一个专业的复杂 js 应用程序骨架会是什么样子，使用原型继承**，所以*不使用任何类型的库来模仿经典的 OO*，假设一个简单的 MVC 类型的应用程序，但很容易扩展到更复杂的比例。如何定义我的对象？如何将对象/“类”组合在一起（命名空间）？换句话说：如何做到这一点，而不至于陷入无人理解的混乱局面？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-05T06:17:54.987

在创建面向对象的 Javascript“类”时，我遵循了两种模式（认为 JS 中没有真正的类，我们可以模仿它们）。首先是更熟悉的 OO 方式并且易于理解。

```
// in JS, functions can be used as OO classes
var Person = function(name) {
    var self = this;

    //private methods and attributes
    this.getNickname = function(){
        return "Yaka";
    };

    //public methods and attributes (return obj)
    return {
        getName : function() {
            return name + ' ' + self.getNickname();
        }
    }
};

//static functions attached to 'Person' class 
Person.hasBrain = function() {
    return true;
} 
```

该模型允许您为您的类提供私有、公共和静态部分，从而实现良好的封装。但这不是最佳方式，因为每个对象都会携带它自己的所有实例方法的副本。您可以避免使用基于原型的编程的实例方法的多个副本：

```
// in JS, functions can be used as OO classes
var Person = function(name) {
    this.name = null;
};

// use of prototypes improves performance and memory use
Person.prototype.getName = function() {
    return this.name;
}

Person.prototype.setName = function(name) {
    this.name = name;
} 
```

这对于传统的 OO 程序员来说看起来不是很熟悉，但却是使用 javascript 资源的最佳方式。它也适用于继承。

```
var Manager = function() {}
Manager.prototype = new Person(); 
```

在实践中，我对应用程序中大量使用的基础/框架类使用原型方法。对于偶尔或少数情况下使用的类，我使用之前讨论过的方法。

我还建议您使用 AMD 库，例如 requirejs，并为每个物理文件定义一个类。然后使用构建优化器将您的文件优化为单个脚本。

[我从BoilerplateJS](http://boilerplatejs.org)参考架构中的单元测试中复制了上述两种方法。看看 BoilerplateJS 中的代码，它将为您提供更多关于如何使用 JS 进行复杂应用程序开发的想法。

免责声明：我是 BoilerplateJS 的主要作者

# php - 想法如何在没有 php 循环的情况下实现服务器推送内容

> ID：12265220
> 
> 赞同：1
> 
> 时间：2012-09-04T14:06:09.273
> 
> 标签：php, mysql, comet

我正在使用 Comet 将服务器推送内容实现到客户端浏览器。当 mysql 插入时应该有更新，然后客户端会发生一些事情，所以我目前正在通过 PHP 做这样的事情：

```
PHP
  while (check database if update is there)
  {
    usleep(10000); 
   // do write json
  } 
```

它确实有效，但发生在我身上的是我的托管（共享）资源耗尽，即使我只是用 5 个同时客户端进行测试。此时 CPU 负载为 40%，导致帐户禁用。

所以请有人建议任何想法如何触发 php 仅在不循环检查的情况下发送新更新。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-04T14:13:01.677

我不知道您的 Javascript 是什么样子，但我认为您的处理方式不正确。您真正想做的可能是以 10 秒的间隔从浏览器发送请求。请参阅[此示例](https://stackoverflow.com/questions/1320542/simple-comet-example-using-php-and-jquery)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-04T14:38:03.993

我认为您的问题是您对[`usleep`](http://php.net/manual/function.usleep.php). 参数应该是：

> **微秒**
> 暂停时间以微秒为单位。一微秒是百万分之一秒。

您的脚本当前暂停 0.01 秒而不是 10 秒，我认为这不是您想要的。

* * *

采用：

```
usleep(10 * 1000000); 
```

或者：

```
sleep(10); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-04T14:14:26.950

此方法在睡眠期间不会使用任何 CPU：

```
set_time_limit(0);
while (check database if update is there) {
   sleep(10); 
   // do write json
} 
```

# android - 如何在 xml 动画文件中指定 fromXType 属性

> ID：12265224
> 
> 赞同：3
> 
> 时间：2012-09-04T14:06:25.497
> 
> 标签：android, xml, animation

我想在 xml 中制作与代码中相同的动画。我编码我有这个

```
 Animation a = new TranslateAnimation(Animation.RELATIVE_TO_PARENT , 1.1f, Animation.RELATIVE_TO_PARENT, -0.2f,
            Animation.RELATIVE_TO_PARENT, 0.0f, Animation.RELATIVE_TO_PARENT, 0.0f); 
```

我从我的 xml 动画文件开始，但我不知道如何让他知道翻译应该是相对于父级的

```
<translate
    android:duration="2500"
    android:fromXDelta="-0.1"
    android:fromYDelta="0"
    android:toXDelta="200"
    android:toYDelta="0" /> 
```

即我不知道如何指定 fromXType 属性

fromXType 指定应该如何解释 fromXValue。Animation.ABSOLUTE、Animation.RELATIVE_TO_SELF 或 Animation.RELATIVE_TO_PARENT 之一。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-09-04T14:24:46.820

你需要像这样使用**P**参数

```
android:fromXDelta="-0.1%p" 
```

[在这里阅读](https://developer.android.com/guide/topics/resources/animation-resource.html)

# php - 如何从 check_required_fields 函数正确显示错误消息？

> ID：12265225
> 
> 赞同：0
> 
> 时间：2012-09-04T14:06:27.273
> 
> 标签：php, function, field, required

嗨，我需要一些帮助。我有一个功能来验证表单的必填字段，我在其中传递了 req. 数组中的字段，因此如果为空，例如 first_name 返回错误消息：“First_name 为空。” . 问题是我想让消息中的字段名称看起来对用户更“友好”，没有驼峰或“_”。我怎样才能做到这一点？

ps这是我的代码：

```
$required_fields = array('first_name', 'last_name', 'email', 'profileInfo', 'message');
$errors = array_merge($errors, check_required_fields($required_fields)); 
```

现在，输出错误消息看起来像：“需要名字”或“需要 profileInfo”。功能是这样的：

```
function check_required_fields($required_fields) {
$field_errors = array();
foreach($_POST as $field=>$value){
    if(empty($value) && in_array($field, $required_fields) === true){
        $field_errors[] = "the " . $field . " is required.";
        //break 1;
    }
}
return $field_errors; 
```

}

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-04T14:11:10.820

您可以给每个必填字段一个标签...

```
$required_fields = array(
        'first_name' => 'First Name',
        'last_name' => 'Last name',
        'email' => 'Email Address',
        'profileInfo' => 'Profile information',
        'message' => 'Message'
    );
$errors = array_merge($errors, check_required_fields($required_fields)); 
```

您将需要更改`check_required_fields`方法以`$required_fields`正确处理数组，如下所示：

```
function check_required_fields($required_fields)
{
    $field_errors = array();
    foreach ($_POST as $field => $value)
    {
        if (empty($value) && array_key_exists($field, $required_fields) === true)
        {
            $field_errors[] = "the " . $required_fields[$field] . " is required.";
            //break 1;
        }
    }
    return $field_errors;
} 
```

编辑：我刚刚注意到，`$_POST`如果设置了字段，您的循环只会按预期工作。尝试以下操作：

```
function check_required_fields($required_fields)
{
    $field_errors = array();
    foreach ($required_fields as $field => $label)
    {
        $value = $_POST[$field];

        if (empty($value))
        {
            $field_errors[] = "the " . $label . " is required.";
            //break 1;
        }
    }
    return $field_errors;
} 
```

# php - If else on text element

> ID：12265229
> 
> 赞同：0
> 
> 时间：2012-09-04T14:06:42.897
> 
> 标签：php

Hello would appreciate any help having problems with this code.

```
 value="<?phpif($_GET['level']== "Grade 2"){ echo "Grade 3";}?>" 
```

My idea is having an if else on this text element so it may check the level of the student and once its checks it should progress the student by a certain level so far i have this error.

Parse error: syntax error, unexpected '{' in C:\xampp\htdocs\Thesis\enrollpage.php on line 212

Also i have this problem, It cannot retrieve $_GET['level'] i tried using get to retrieve from this from and post from the previous from but still not working.

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-04T14:07:37.430

您需要在`<?php`和您的第一条语句之间留一个空格：

```
<?php if($_GET['level']== "Grade 2"){ echo "Grade 3";}?> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-04T14:08:55.690

```
 value="<?php if($_GET['level'] == 'Grade 2'){ echo 'Grade 3';} ?>" 
```

# c# - How to pass arguments to NSAction?

> ID：12265232
> 
> 赞同：7
> 
> 时间：2012-09-04T14:06:46.360
> 
> 标签：c#, ios, xamarin.ios, uikit, uiviewanimation

Well, everyone knows that in ObjC we have

```
+ (void)animateWithDuration:(NSTimeInterval)duration delay:(NSTimeInterval)delay options:(UIViewAnimationOptions)options animations:(void (^)(void))animations completion:(void (^)(BOOL finished))completion 
```

Notice that `completion` block has a BOOL argument. Now let's look at Monotouch:

```
public static void Animate (double duration, double delay, UIViewAnimationOptions options, NSAction animation, NSAction completion) 
```

NSAction is:

```
public delegate void NSAction (); 
```

Just the delegate without any arguments. Moreover, in Monotouch "internals" we can see:

```
public static void Animate (double duration, double delay, UIViewAnimationOptions options, 
NSAction animation, NSAction completion)
{
    UIView.AnimateNotify (duration, delay, options, animation, delegate (bool x)
    {
        if (completion != null)
        {
            completion ();
        }
    });
} 
```

Notice `delegate (bool x)`, It calls the function just like I need. Now, how can I pass `Action<bool>` as completion to `UIView.Animate` ?

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-04T16:05:35.140

那是一个*旧*的绑定错误（错误类型），出于兼容性原因，`Animate`仍然使用`NSAction`完成处理程序。

为了解决这个问题`AnimateNotify`，MonoTouch 中添加了一种新方法。这个版本接受一个`UICompletionHandler`这样定义的：

```
public delegate void UICompletionHandler (bool finished); 
```

因此，您的问题的解决方案是使用较新的`AnimateNotify`API。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-01-29T07:43:09.803

所以应该看起来像：

```
UIView.AnimateNotify(duration, 0, UIViewAnimationOptions.CurveEaseInOut, delegate () {

}, delegate (bool finished) {

}); 
```

或者使用 lambda 语法：

```
UIView.AnimateNotify(duration, 0, UIViewAnimationOptions.CurveEaseInOut, () => {

}, (finished) => {

}); 
```

# android - Dynamic .APK from GooglePlay store / Android

> ID：12265233
> 
> 赞同：0
> 
> 时间：2012-09-04T14:06:50.250
> 
> 标签：android, dynamic-data, google-play

My issue is very related with [**this**](https://stackoverflow.com/questions/11407019/dynamic-apk-in-android) question. I'm working in a app that must implement a very uncommon behavior and, in my current overview, I don't know if it is a possible implementation. The main sequence of my desired behavior is:

1.  The user is navigating in a browser, that can be either Android's browser or a desktop/remote browser, in a webpage (let's say "[http://somewebpage.com](http://somewebpage.com)");
2.  The user access my dynamic website, that has a button to redirect him to GooglePlay store;
3.  The user downloads my Android app from GooglePlay;
4.  When the app download finish, in the first open of the Adroid app, it has a reference to the first visited page in item 1 ("[http://somewebpage.com](http://somewebpage.com)").

So, how can I properly implement this? Does GooglePlay store provide a way to pass dynamic arguments to downloaded apps? Is it possible to pass a dynamic configuration file coupled with the .apk in app download-time? I've already spent lots of time in this, but I'm still with no solutions.

Thanks in advance!

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-04T14:18:47.710

替代解决方案：尝试获取浏览器历史记录以查找您网站上访问的最后一页。请参阅[Browser.HISTORY_PROJECTION](http://developer.android.com/reference/android/provider/Browser.html#HISTORY_PROJECTION)和[这个线程](https://stackoverflow.com/questions/2577084/android-read-browser-history)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-04T14:18:50.567

只是一个想法......您可以操纵 Google Analytics（分析）引荐来源参数并通过接收器自己阅读它们并执行`com.android.vending.INSTALL_REFERRER`操作。从来没有尝试过...当我不得不创建一个动态 APK 时，我做了很多技巧和操作（通过脚本编译、签名等）来创建动态 APK，它是直接从我们的网站下载的。

# python - How to plot 2d math vectors with matplotlib?

> ID：12265234
> 
> 赞同：21
> 
> 时间：2012-09-04T14:06:55.377
> 
> 标签：python, math, matplotlib, visualization

How can we plot 2D math vectors with `matplotlib`? Does anyone have an example or suggestion about that?

I have a couple of vectors stored as 2D `numpy` arrays, and I would like to plot them as directed edges.

The vectors to be plotted are constructed as below:

```
import numpy as np
# a list contains 3 vectors;
# each list is constructed as the tail and the head of the vector
a = np.array([[0, 0, 3, 2], [0, 0, 1, 1], [0, 0, 9, 9]]) 
```

* * *

**Edit:**

I just added the plot of the final answer of `tcaswell` for anyone interested in the output and want to plot 2d vectors with matplotlib: ![enter image description here](../Images/8aa6f968fc7108bf4620f7554fde8c24.png)

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2012-09-04T16:13:59.293

halex 评论中的建议是正确的，您想使用 quiver ( [doc](http://matplotlib.sourceforge.net/api/pyplot_api.html#matplotlib.pyplot.quiver) )，但您需要稍微调整一下属性。

```
import numpy as np
import matplotlib.pyplot as plt

soa = np.array([[0, 0, 3, 2], [0, 0, 1, 1], [0, 0, 9, 9]])
X, Y, U, V = zip(*soa)
plt.figure()
ax = plt.gca()
ax.quiver(X, Y, U, V, angles='xy', scale_units='xy', scale=1)
ax.set_xlim([-1, 10])
ax.set_ylim([-1, 10])
plt.draw()
plt.show() 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-04T14:15:21.473

这很简单。希望这个例子有所帮助。

```
import matplotlib.pyplot as plt
import numpy as np
x = np.random.normal(10,5,100)
y = 3 + .5*x + np.random.normal(0,1,100)
myvec = np.array([x,y])
plt.plot(myvec[0,],myvec[1,],'ro')
plt.show() 
```

将产生：

![在此处输入图像描述](../Images/dee38af1fe8cf8ef67f3cede5bafda1a.png)

要绘制数组，您可以将它们切成一维向量并绘制它们。我已经阅读了 matplotlib 的所有不同选项的完整文档。但是对于大多数示例，您可以将 numpy 向量视为普通元组。

# azure - Remote Desktop Services in Azure

> ID：12265235
> 
> 赞同：0
> 
> 时间：2012-09-04T14:06:57.597
> 
> 标签：azure

I'm in the proccess for deploying a RDS environment for a customer, and I've thought it could be better (faster, cheaper and more secure) for my client if I could implement it using Windows Azure hosted Virtual machines than having onpremise hardware.

Then, my questions are:

· Is it possible technically? I mean, will the virtual machine give good service for, let's say, +-100 concurrent users? Will it be a consistent connection without break-downs?

· Is it possible legally? That is, can I do it? I suppose I should buy RDS licenses... but I don't know how nor where to do it.

· I'm I right? I mean, is this the best solution to use Azure?

I've found some information so far (here, for example: [http://oakleafblog.blogspot.com.es/2012/07/enabling-remote-desktop-services-in.html](http://oakleafblog.blogspot.com.es/2012/07/enabling-remote-desktop-services-in.html)) but I'm not sure about the "official" answer for theese questions

Thanks in advance for your help,

luis

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-04T14:35:24.007

*   *技术上可行*：是
*   *为 +/- 100 个并发用户提供良好的服务？*这将取决于您的虚拟机的大小。大型 VM 具有更高的带宽。更多信息：[关于 Windows Azure 容量的 7 件事](http://technet.microsoft.com/en-us/cloud/gg663909.aspx)
*   *它会是一个没有故障的一致连接吗？*将取决于实例大小...如果您选择一个小型实例并且它始终处于 100% CPU 和网络 I/O 状态，那么您将没有一个稳定的环境。除此之外，您必须知道，今天“虚拟机”仍然是没有 SLA 的预览功能。
*   *合法可行吗？*实际上我不确定...看一下许可条款：[MICROSOFT WINDOWS SERVER 2008 R2 (FOR USE WITH WINDOWS AZURE)](http://go.microsoft.com/fwlink/?LinkID=206791)。这些声明如下：

> 您不得在软件中使用以下功能：
> 
> *   远程桌面服务
> *   权限管理服务

*   *我想我应该购买 RDS 许可证？*您应该[联系支持](http://www.windowsazure.com/en-us/support/contact/)并询问您是否可以在 Windows Azure 中使用 RDS，如果允许，您只需从 Microsoft 合作伙伴处购买这些许可证 (CAL)。
*   *这是使用 Azure 的最佳解决方案吗？*这取决于。如果您的客户今天想要这个，我会拒绝（今天亚马逊可能是一个更好的选择）。原因很简单，虚拟机仍然是一个预览功能，恕我直言，这还不适合生产部署。

# javascript - FadeIn/FadeOut Two backgrounds for website

> ID：12265237
> 
> 赞同：1
> 
> 时间：2012-09-04T14:07:01.077
> 
> 标签：javascript, jquery

I have found one really nice thing on themeforest. However I am not interested in anything but that jquery background shuffle.

[http://themeforest.net/item/launch-pad-full-screen-image-under-construction/full_screen_preview/473421](http://themeforest.net/item/launch-pad-full-screen-image-under-construction/full_screen_preview/473421)

I thought to buy it but then I've noticed that guy put all scripts into one .js so I wouldnt understand quite mutch to remove all of these.

However... I was wondering if anyone can help me to make something like that without any of the options like on preview website.

I just want to have this fadeIn, fadeOut effect and two images to shuffle between 6 seconds. Sounds quite easy to make, but not without knowledge.

I will keep searching if something like that exists, thanks in advance. Cheers.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-04T14:19:10.260

JQuery 的淡入功能记录在这里： [http ://api.jquery.com/fadeIn/](http://api.jquery.com/fadeIn/)

我会这样做：

1.  创建新图像
2.  使用 JQuery 隐藏它 .hide
3.  将其插入文档中与旧图像完全相同的位置，使其位于其上方。
4.  在新图像上调用 .fadeIn
5.  在我传递给 .fadeIn 的回调例程中，我删除了下面的图像，这样图像就不会无限堆叠并占用浏览器资源

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-06-01T07:46:01.223

这是一个旧答案，但对于现在正在寻找它的人，您可以尝试 bgshuffle 脚本。它使用 JqueryUI。您必须在页面中的某处包含 JqueryUI。该脚本发布在 github 上，如果您喜欢，请随时扩展它：

[https://github.com/vikaskumarsingh123/bgshuffle/](https://github.com/vikaskumarsingh123/bgshuffle/)

**您可以简单地将其称为**：

```
shuffleBG( ['1.jpg','2.jpg','3.jpg','4.jpg','5.jpg'] );//the array of wallpapers 
```

**或高级用法：**

```
shuffleBG(['1.jpg','2.jpg','3.jpg','4.jpg','5.jpg'], //the array of wallpapers
        '10000', //time between wallpaper change, defaults to 10000ms (10secs)
        '1000', //fade in fade out animation speed, defaults to 1000ms
        'white' //color to fade in and out of, defaults to body backgroundColor or white
); 
```

您通常会在 document.load 上调用此函数。

# mysql - setting the correct table structure to prevent duplicate entries

> ID：12265239
> 
> 赞同：0
> 
> 时间：2012-09-04T14:07:03.283
> 
> 标签：mysql, database, primary-key, unique

im doing a quite simple database in which i need to connect people as friends.

In my first column i have user_id and in the second one i have friend_id. What i want to achieve is to prevent a duplicate entry.

for example i want to have something like this:

user_id ; friend_id

1 ; 2

1 ; 3

1 ; 4

and so on

and prevent this:

1 ; 2

1 ; 3

**1 ; 3**

1 ; 4

**1 ; 4**

iv tried everything. If i set user_id as primary or unique, it wont allow me 2 entries with user_id = 1;

any help? thanks

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-04T14:45:41.937

正如此[答案](https://stackoverflow.com/questions/1110349/how-can-define-a-composite-primary-key-in-sql)所述，如果您仅查询，则复合主键（例如）`(user_id, friend_id)`将不允许您使用索引`friend_id`。您也可以`UNIQUE`在`(user_id, friend_id)`.

# java - could someone please give me step by step instructions on how to get a java applet properly signed

> ID：12265240
> 
> 赞同：2
> 
> 时间：2012-09-04T14:07:02.540
> 
> 标签：java, applet, signed

i need help with signing a java applet properly. the reason why iam saying 'properly' is that i have already tried generating a key using keytool and then signing the .jar file with it but it just doesnt work.iam using java 1.7\. Any help will be greatly appreciated ...

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-04T14:09:47.290

你的意思是，你想要某种用于签署 JAR 文件的教程？

[http://docs.oracle.com/javase/tutorial/deployment/jar/signindex.html](http://docs.oracle.com/javase/tutorial/deployment/jar/signindex.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-06T10:34:59.723

```
AccessController.doPrivileged(new PrivilegedAction() 
     { 
         public Object run() 
         { // It will work if your applet is signed 
            readfile(); 
            return null; 
         } 
     }
); 
```

......... 这个小程序代码解决了我的问题。现在在特权代码部分下运行我的代码可以获得我需要的所有安全许可！

# c# - 如何检查一个数据集是否属于另一个数据集

> ID：12265244
> 
> 赞同：1
> 
> 时间：2012-09-04T14:07:11.313
> 
> 标签：c#, .net, sql

我有一个数据集，其中包含单个 FeeID 的学生费用结构，如下所述：

```
 FeeID   Amount    FeeItem             Type
      *---------------------------------------------*
        10      7500      Admission Fee        T
        10      900       Annual Fee           T
        10      150       Application Fee      T
        10      850       Boy's Uniform        T
        10      50        Computer Fee         R 
```

例如，我有另一个包含以下数据的数据集：

```
 FeeID   Amount    FeeItem             Type
      *---------------------------------------------*
        9       8500      Admission Fee        T
        9       950       Annual Fee           T
        9       150       Application Fee      T
        9       850       Boy's Uniform        T
        9       50        Computer Fee         R
        11      7500      Admission Fee        T
        11      900       Annual Fee           T
        11      150       Application Fee      T
        11      850       Boy's Uniform        T
        11      50        Computer Fee         R 
```

我想检查由最后三列组成的集合是否属于另一个数据集，该数据集包含所有费用结构的数据，其中费用 ID 可能会有所不同。实际我想检索具有相同费用结构的匹配费用 ID。

在上面的示例中，如果我在第二个中搜索第一个，它将返回**True**并且匹配的 FeeID 将是**11**。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-04T14:12:14.640

你可以使用[这个](http://social.msdn.microsoft.com/Forums/en/csharpgeneral/thread/fb7bfe7f-2315-4107-ada1-7fb3396959d4)技巧

```
Dataset ds1
DataSet ds2
DataSet dest;
dest.Merge(ds1);
dest.AcceptChanges();
dest.Merge(ds2);
diff = destination.GetChanges() 
```

并检查 diff 是否为空

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-04T14:28:43.000

**编辑**：我对下面的代码做了一些改进。以下`DataTable.IndexOf(otherTable)`扩展方法检查一个表是否是另一个表的子集。

您可以传递要在比较中忽略的列名。列的顺序无关紧要，但顺序`DataRows`（子集必须具有相同的行顺序）。

`DataRows`当没有找到相等的子集或主表（`this`在扩展中）中相等子集开始的第一个索引时，它返回 -1 。

```
public static class DataTableExtensions
{
    public static int IndexOf(this DataTable tblMain, DataTable tblSub, params String[] ignoreColumns)
    {
        if (tblMain == null)
            throw new ArgumentNullException("tblMain");
        if (tblSub.Rows.Count == 0)
            throw new ArgumentException("tblSub must not be empty", "tblSub");

        if (tblSub.Rows.Count > tblMain.Rows.Count)
            return -1;

        IEnumerable<String> relevantColumnNames = tblSub.Columns.Cast<DataColumn>()
            .Select(c => c.ColumnName)
            .Except(ignoreColumns)
            .ToArray();

        foreach (String colName in relevantColumnNames)
            if (!tblMain.Columns.Contains(colName))
                return -1;

        for (int mainRowIndex = 0; tblMain.Rows.Count - mainRowIndex >= tblSub.Rows.Count; mainRowIndex++)
        {
            // check if current window is equal to tblSub
            bool allRowsAreEqual = true;
            for (int windowIndex = mainRowIndex; windowIndex < tblSub.Rows.Count + mainRowIndex; windowIndex++)
            {
                DataRow currentMain = tblMain.Rows[windowIndex];
                DataRow currentSub = tblSub.Rows[windowIndex - mainRowIndex];
                bool allFieldsAreEqual = relevantColumnNames.All(colName =>
                    Object.Equals(currentMain[colName], currentSub[colName]));
                if (!allFieldsAreEqual)
                {
                    allRowsAreEqual = false;
                    break; // continue with next window in main-table
                }
            }
            if (allRowsAreEqual)
                return mainRowIndex;
        }
        // no equal window found in main-table
        return -1;
    }
} 
```

您的样本数据：

```
var TblSub = new DataTable();
var TblMain = new DataTable();
TblSub.Columns.Add("FeeID", typeof(int));
TblSub.Columns.Add("Amount", typeof(int));
TblSub.Columns.Add("FeeItem", typeof(string));
TblSub.Columns.Add("Type", typeof(char));
TblMain.Columns.Add("FeeID", typeof(int));
TblMain.Columns.Add("Amount", typeof(int));
TblMain.Columns.Add("FeeItem", typeof(string));
TblMain.Columns.Add("Type", typeof(char));

TblSub.Rows.Add(10, 7500, "Admission Free", 'T');
TblSub.Rows.Add(10, 900, "Annual Fee", 'T');
TblSub.Rows.Add(10, 150, "Application Free", 'T');
TblSub.Rows.Add(10, 850, "Boy's Uniform", 'T');
TblSub.Rows.Add(10, 50, "Computer Free", 'R');

TblMain.Rows.Add(9, 8500, "Admission Free", 'T');
TblMain.Rows.Add(9, 950, "Annual Fee", 'T');
TblMain.Rows.Add(9, 150, "Application Free", 'T');
TblMain.Rows.Add(9, 850, "Boy's Uniform", 'T');
TblMain.Rows.Add(9, 50, "Computer Free", 'R');
TblMain.Rows.Add(10, 7500, "Admission Free", 'T');
TblMain.Rows.Add(11, 900, "Annual Fee", 'T');
TblMain.Rows.Add(11, 150, "Application Free", 'T');
TblMain.Rows.Add(11, 850, "Boy's Uniform", 'T');
TblMain.Rows.Add(11, 50, "Computer Free", 'R'); 
```

你可以这样使用它：

```
int firstIndex = TblMain.IndexOf(TblSub, "FeeID");
if (firstIndex == -1)
    Console.Write("Second table does not contain first table");
else
    Console.Write("Second table does contain first table at row-index " + firstIndex); 
```

输出是：

> 第二个表确实包含行索引 5 处的第一个表

* * *

**旧方法**：

您可以使用以下方法检查两个 DataTables 是否相等。

您需要添加`using System.Linq`. [`Enumerable.SequenceEqual`](http://msdn.microsoft.com/en-us/library/bb348567.aspx)如果您不能使用 Linq，请使用循环。

```
static bool TablesEqual(DataTable table1, DataTable table2, params int[] skipColumns)
{
    if (table1.Rows.Count != table2.Rows.Count)
        return false;

    for (int i = 0; i < table1.Rows.Count; i++)
    {
        var array1 = table1.Rows[i].ItemArray
            .Where((obj, index) => !skipColumns.Contains(index));
        var array2 = table2.Rows[i].ItemArray
            .Where((obj, index) => !skipColumns.Contains(index)); ;
        if (!array1.SequenceEqual(array2))
        {
            return false;
        }
    }
    return true;
} 
```

您只需传递要忽略的列的索引，例如：

```
bool allEqual = TablesEqual(t1, t2); // all equal
bool equalIgnore0 = TablesEqual(t1, t2, 0); // ignore first column
bool equalIgnore0and2 = TablesEqual(t1, t2, 0, 2); // ignore first and third column 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-04T19:46:24.050

最后我能够解决这个问题。以下是我的功能。我正在使用**Tim Schmelter**提供的函数**TablesEqual**。该函数将返回一个有效的**FeeID**，它是一个正整数，如果没有找到匹配项，则返回 -1。

 ****```
private int MatchFeeID(DataTable Dt)
{
  DataTable mainDt = bl.GetDataSet("Select * From FeeMaster"); //assume this is a function that will return all the fee structures from database.

  var fids = (from row in mainDt.AsEnumerable().Distinct()
            group row by row.Field<string>("fid") into rowGroup
            select new
            {
              fid = rowGroup.Key
            });

  foreach (var fid in fids)
  {
    string id = fid.fid;

    DataTable t1 = new DataTable();
    DataTable t2 = new DataTable();

    DataRow[] dr1 = mainDt.Select(String.Format("fid = '{0}'", id));

    t1 = dr1.CopyToDataTable();
    t2 = Dt;

    bool res = TablesEqual(t1, t2, 0, 1);
    if (res) return Convert.ToInt32(id);
  }

  return -1;
} 
```****

# html - Link tag not getting dimensions of child image

> ID：12265254
> 
> 赞同：0
> 
> 时间：2012-09-04T14:07:29.420
> 
> 标签：html, css

I have a few link tags that contain images:

```
<div id="product-pics">
    <a href="#"><div class="overlay"><span>meer ></span></div><img src="img/dummy/282x282.png" alt="" class="tile" /></a>
    <a href="#"><div class="overlay"><span>meer ></span></div><img src="img/dummy/566x282.png" alt="" class="tile" /></a>
    <a href="#"><div class="overlay"><span>meer ></span></div><img src="img/dummy/282x282.png" alt="" class="tile" /></a>
    <a href="#"><div class="overlay"><span>meer ></span></div><img src="img/dummy/282x282.png" alt="" class="tile" /></a>
    <a href="#"><div class="overlay"><span>meer ></span></div><img src="img/dummy/282x566.png" alt="" class="tile" /></a>
    <a href="#"><div class="overlay"><span>meer ></span></div><img src="img/dummy/282x282.png" alt="" class="tile" /></a>
    <a href="#"><div class="overlay"><span>meer ></span></div><img src="img/dummy/282x282.png" alt="" class="tile" /></a>
    <a href="#"><div class="overlay"><span>meer ></span></div><img src="img/dummy/282x282.png" alt="" class="tile" /></a>
    <a href="#"><div class="overlay"><span>meer ></span></div><img src="img/dummy/566x282.png" alt="" class="tile" /></a>
</div> 
```

They are floated to the left and with masonry (jquery plugin) made to form a grid.

```
.tile {
    margin: 1px;
    float: left;
} 
```

I'm trying to create an overlay for the image, but it's just the size of the span, not the size i give in css. So the overlay isn't working, how can I fix this ?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-04T17:05:15.420

您需要对`display:inline-block`链接使用样式。

这是整个 HTML：

```
<html>
<head>   
<style>
#product-pics a {
  display: inline-block;
}
#product-pics .overlay {
  position: absolute;
}
/* below style can be omitted, but the "product-pics" contents layout
   won't be properly displayed until the image dimensions are known */
#product-pics img {
  min-width: 282px;
  min-height: 282px;
}
</style>
</head>
<body>
<div id="product-pics">
    <a href="#"><div class="overlay"><span>meer1</span></div><img src="img/dummy/282x282.png" alt="" class="tile" /></a>
    <a href="#"><div class="overlay"><span>meer2</span></div><img src="img/dummy/566x282.png" alt="" class="tile" /></a>
    <a href="#"><div class="overlay"><span>meer3</span></div><img src="img/dummy/282x282.png" alt="" class="tile" /></a>
    <a href="#"><div class="overlay"><span>meer4</span></div><img src="img/dummy/282x282.png" alt="" class="tile" /></a>
    <a href="#"><div class="overlay"><span>meer5</span></div><img src="img/dummy/282x566.png" alt="" class="tile" /></a>
    <a href="#"><div class="overlay"><span>meer6</span></div><img src="img/dummy/282x282.png" alt="" class="tile" /></a>
    <a href="#"><div class="overlay"><span>meer7</span></div><img src="img/dummy/282x282.png" alt="" class="tile" /></a>
    <a href="#"><div class="overlay"><span>meer8</span></div><img src="img/dummy/282x282.png" alt="" class="tile" /></a>
    <a href="#"><div class="overlay"><span>meer9</span></div><img src="img/dummy/566x282.png" alt="" class="tile" /></a>
</div>
</body>
</html> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-04T14:10:50.410

尝试这个

```
.overlay span {display:inline-block; width:your input; height:your input} 
```

# python - Getting signalparam of Event in simpy

> ID：12265256
> 
> 赞同：1
> 
> 时间：2012-09-04T14:07:32.127
> 
> 标签：python, simpy

I am using SimPy for a time-based simulation.

I have a Messager process which listens for a specific event, and returns the parameters of that event when it occurs:

```
class Messager(Process):
    def __init__(self):
        Process.__init__(self,'messager')

    def monitor(self):
        while True:
            yield waitevent, self, messageEvent
            print messageEvent.signalparam

messager = Messager()
activate(messager,messager.monitor()) 
```

this works fine. However, in reality there is more than one Event which should be handled by the Messager, and I want the Messager to return the signalparam for the causative Event in a list of events:

```
messageEvents = [Event1,Event2,Event3]

class Messager(Process):
    def __init__(self):
        Process.__init__(self,'messager')

    def monitor(self):
        while True:
            yield waitevent, self, messageEvents
            ..... 
```

how do I access the signalparam of the Event which has occurred?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-25T07:00:24.433

查看 simpy 的源代码，特别是 Simevent 类，如果您可以以某种方式将事件转换为 Simevent 类，那么您应该能够从中获取属性信号参数。不确定这是否可行，但希望您知道一种方法。祝你好运。

编辑：也想到了这一点，您可以编辑您的 simpy 并使 Simevent 类具有获取信号参数的功能。仅供参考，如果您想这样做，simevent 类位于 lib.py 文件中。

# java - 启动 Spring WebFlow2 转换的 Javascript 代码

> ID：12265260
> 
> 赞同：0
> 
> 时间：2012-09-04T14:07:41.533
> 
> 标签：java, javascript, spring, spring-webflow

有谁知道我可以放在一个单选按钮上的任何 javascript 代码，它将启动 Spring WebFlow2 Transition 事件？

如果用户单击单选按钮，我希望开始转换以将值加载到下拉列表中...有人可以告诉我您是否看到这样做。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-04T15:25:58.637

在您的情况下，我认为您想使用 Ajax 仅刷新页面的一部分。我使用的是全局 js 文件中的一个函数：

```
function ajaxWebFlowSubmitGet(divID,pars,view) {
    new Ajax.Updater({success:divID},
                        view+"&date="+new Date().getTime(),
                        {   method:'get',
                            parameters:pars,
                            evalScripts:true,
                            onFailure:reportError,
                            requestHeaders: ['Accept','text/html;type=ajax']    
                        });
} 
```

然后你可以在你的代码中使用它

```
ajaxWebFlowSubmitGet('dropdownListDiv','_eventId=eventID&fragments=dropDownFragment',${flowExecutionUrl}); 
```

只需将“ajaxWebFlowSubmitGet”函数放在您的页面中，然后从您的单选按钮调用它。

*   'dropdownListDiv' 是您要更新的 div
*   eventID 是您要执行的网络流的转换名称
*   dropDownFragment 是您希望作为响应接收的片段的名称（并放在您的“dropdownListDiv”中）

# c# - 需要将函数包装在 c# 中的标准 try/catch 函数中

> ID：12265262
> 
> 赞同：3
> 
> 时间：2012-09-04T14:07:46.877
> 
> 标签：c#, asp.net, delegates, anonymous-function

我知道有很多委托/函数示例，但我找不到任何适合我的示例，或者我只是不理解它们。

我正在将 asp.net MVC 用于网站，并且该网站需要一些 Web 服务调用以使外部应用程序与我的应用程序交互。这些都需要一个函数来执行（去 db 等等），并且每次都返回一个相似的数据模型。我想将每个调用包装在 try/catch 中并填充模型。

这是每次调用都会发生的通用代码。

```
var model = new ResponseDataModel();
try
{
     //execute different code here
}
catch (Exception ex)
{
    model.Error = true;
    model.Message = ex.ToString();
}
return View(model); // will return JSON or XML depending on what the caller specifies 
```

这是我正在使用的控制器方法/功能之一

```
public ActionResult MillRequestCoil()
{
    var model = new ResponseDataModel();
    try
    {
        /* edit */
        //specific code
        string coilId = "CC12345";

        //additional code
        model.Data = dataRepository.doSomethingToCoil(coilId);

        //replaced code
        //model.Data = new { Coil = coilId, M3 = "m3 message", M5 = "m5 message" };
        model.Message = string.Format("Coil {0} sent successfully", coilId);
    }
    catch (Exception ex)
    {
         model.Error = true;
         model.Message = ex.ToString();
    }
    return View(model);
} 
```

我希望能够以某种方式将特定函数转换为变量以传递给通用代​​码。我看过代表和匿名函数，但在你自己做之前，这很令人困惑。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-04T14:15:02.863

将以下内容放在可访问的地方：

```
public static ActionResult SafeViewFromModel(
    Action<ResponseDataModel> setUpModel)
{
    var model = new ResponseDataModel();
    try
    {
        setUpModel(model);
    }
    catch (Exception ex)
    {
        model.Error = true;
        model.Message = ex.ToString();
    }
    return View(model); 
} 
```

然后像这样称呼它：

```
public ActionResult MillRequestCoil()
{
    return MyHelperClass.SafeViewFromModel(model =>
    {
        string coilId = "CC12345";
        model.Data = new {
            Coil = coilId,
            M3 = "m3 message",
            M5 = "m5 message" };
        model.Message = string.Format("Coil {0} sent successfully", coilId);
    });
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-04T14:22:38.143

```
public interface IAction{
    public void doAction(ResponseDataModel model);
}

public class Action1 : IAction
{
    public void doAction(ResponseDataModel model)
    {
        string coilId = "CC12345";
        model.Data = new { Coil = coilId, M3 = "m3 message", M5 = "m5 message" };
        model.Message = string.Format("Coil {0} sent successfully", coilId);
    }
}

class Class1
{
    public ActionResult MillRequestCoil(IAction action)
    {
        var model = new ResponseDataModel();
        try
        {
            //specific code
            action.doAction(model);
        }
        catch (Exception ex)
        {
            model.Error = true;
            model.Message = ex.ToString();
        }
        return View(model);
    }
} 
```

采用：

```
var result = MillRequestCoil(new Action1()); 
```

或执行其他代码

```
var result = MillRequestCoil(new ActionXY()); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-04T15:03:43.277

这是 Rawling 答案的变体，我认为它具有更好的可读性：

```
public ActionResult MillRequestCoil()
{
    var model = CreateResponseDataModel(RunSpecificCode);

    return View(model);
}

public ActionResult MillDoSomethingElse ()
{
    var model = CreateResponseDataModel(RunOtherCode);

    return View(model);
}

private ResponseDataModel CreateResponseDataModel(Action<ResponseDataModel> action)
{
    var model = new ResponseDataModel();
    try
    {
        action(model);
    }
    catch (Exception ex)
    {
        model.Error = true;
        model.Message = ex.ToString();
    }
    return model;
}

private void RunSpecificCode(ResponseDataModel model)
{
    /* edit */
    //specific code
    const string coilId = "CC12345";

    //additional code
    model.Data = _dataRepository.DoSomethingToCoil(coilId);

    //replaced code
    //model.Data = new { Coil = coilId, M3 = "m3 message", M5 = "m5 message" };
    model.Message = string.Format("Coil {0} sent successfully", coilId);
}

private void RunOtherCode(ResponseDataModel obj)
{
    // some other piece of code
} 
```

没有 lambda，并且您的特定代码和模板代码之间的关注点很好地分离，用于 try/catch 和模型构建的东西。

# ssh - 如何为不同主机上的 SSH 隧道配置 JMeter

> ID：12265265
> 
> 赞同：3
> 
> 时间：2012-09-04T14:08:08.013
> 
> 标签：ssh, jmeter

我在设置 JMeter 客户端以通过中间跳转主机连接到远程 JMeter 服务器时遇到问题。

特别是需要打开哪些端口并将其转发到哪个主机以及如何为此配置 JMeter。显然有一些关于类似设置的博客文章，但既没有详细描述端口，也没有通过外部主机进行连接（都使用本地主机？）。

设置是：

JMeter GUI（客户端）<-> Jumphost <-> JMeter 服务器

我需要在 Jumphost 上设置一个或多个 SSH 隧道，并告诉客户端和服务器连接到该主机。

帮助将不胜感激！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-09T16:05:53.617

[http://rolfje.wordpress.com/2012/02/16/distributed-jmeter-through-vpn-and-ssl/](http://goo.gl/8uGdh)

在这里我看到文章中的端口：

> -A RH-Firewall-1-INPUT -p udp -m udp --dport 1099 -j ACCEPT
> 
> -A RH-Firewall-1-INPUT -p tcp -m tcp --dport 1099 -j ACCEPT
> 
> -A RH-Firewall-1-INPUT -p udp -m udp --dport 50000 -j ACCEPT
> 
> -A RH-Firewall-1-INPUT -p tcp -m tcp --dport 50000 -j ACCEPT

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-12-22T14:26:21.943

## **尝试使用 Java 8**

## 1.客户端-修改`jmeter.properties`文件添加：

```
remote_hosts=127.0.0.1:55511
client.rmi.localport=55512 
```

## 2.服务器-修改`jmeter.properties`文件添加：

```
server_port=55511
server.rmi.localhostname=127.0.0.1
server.rmi.localport=55511 
```

## 3\. 使用以下方式连接到服务器：

*   Linux 和 Mac 用户

    `ssh solr@server -L 55511:127.0.0.1:55511 -R 55512:127.0.0.1:55512`

*   Windows 用户

    `putty.exe -ssh user@server -L 55511:127.0.0.1:55511 -R 55512:127.0.0.1:55512`

## 4.服务器——启动jmeter

```
cd apache-jmeter-2.13/bin/
./jmeter-server -Djava.rmi.server.hostname=127.0.0.1 
```

## 5.客户端——启动jmeter

```
cd apache-jmeter-2.13/bin/
./jmeter.sh -Djava.rmi.server.hostname=127.0.0.1 -t test.jmx 
```

# fonts - Verdana 字体在每个浏览器中的工作方式都不相同

> ID：12265267
> 
> 赞同：2
> 
> 时间：2012-09-04T14:08:19.147
> 
> 标签：fonts, cross-browser

我在我的网站中使用了 verdana 字体。Firefox 和 chrome 浏览器之间存在一些差异。以前问过这个问题，但不幸的是我没有得到答案。现在，当我在 Firefox 中看到字体时，它的间距大于 chrome。有没有更好的解决方案来解决问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-04T14:17:40.240

你能为字母间距做某种css重置吗？

尝试：

```
* { letter-spacing:0px; } 
```

如果使用，在您的 css 顶部或“css reset”文件中

# javascript - 谷歌可以抓取 javascript 生成的链接吗？

> ID：12265273
> 
> 赞同：2
> 
> 时间：2012-09-04T14:08:37.727
> 
> 标签：javascript, seo, indexing, search-engine

我知道这个问题已经被问过很多次了（但有不同的变化），但我完全糊涂了......

我有一个网站，右侧面板显示一些内容 - 一组指向新闻/内部文章的链接。这是所有站点页面的相同列表。因此，每次新闻部分有新的链接/行时，我都必须手动浏览所有站点的页面并更新它们。这真的很烦人而且很耗时。

我想的方法是：

在应该是新闻/链接的地方添加一个 div：

```
<div class"news"></div> 
```

并在所有文件中加载一个 JS 文件。之后`window.onload()`，JS 会做的是写新闻：

```
document.getElementByID('news').innerHTML=.... 
```

因此，每次有新的链接/新闻时，我都会将其添加到 JS 文件中，并将其写入所有站点的页面（因为它们都会加载此脚本）。

我的问题是：这种方法可以吗？(Goggle) 会看到以这种方式生成的新闻/链接吗？

PS 我读过很多文章，例如 [https://stackoverflow.com/questions/11989908/can-google-crawl-links-generated-on-the-clientside-eg-knockout](https://stackoverflow.com/questions/11989908/can-google-crawl-links-generated-on-the-clientside-e-g-knockout)

[Googlebot 看不到 jquery 生成的内容](https://stackoverflow.com/questions/6248651/googlebot-doesnt-see-jquery-generated-content?lq=1)

[http://support.google.com/webmasters/bin/answer.py?hl=en&answer=174992](http://support.google.com/webmasters/bin/answer.py?hl=en&answer=174992)

[谷歌会抓取 JavaScript 吗？](https://stackoverflow.com/questions/9711762/does-google-crawl-javascript)

[https://developers.google.com/webmasters/ajax-crawling/docs/getting-started](https://developers.google.com/webmasters/ajax-crawling/docs/getting-started)

等等......但是真的很困惑......我没有使用任何 AJAX 或服务器端编程。只想`.innerHTML ="..."`用预定义的新闻列表做一个简单的，节省大量时间。谷歌会索引并查看此内容吗？

非常感谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-04T14:14:11.083

一般来说，没有。Google（和其他机器人）不会看到您动态添加的内容。

他们当然正在学习搜索引擎以了解越来越多的内容，并且它可能已经识别了一些向页面添加内容的特定方法，但是为了能够看到任何动态内容，它必须在沙盒环境中实际执行脚本，或模拟脚本执行，以了解它的作用。

即使它确实看到了一些动态内容，它也可能会降低该内容的优先级，因此将重要内容作为页面中的实际元素放置总是会更好。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-05T10:53:05.177

当您在浏览器中检查源代码时，任何搜索引擎爬虫都只会爬取 HTML 代码。现在，当您使用 Javascript 获取内容时，它肯定不会获取源代码。（这取决于您如何获取内容）。

为了测试您网页的爬虫可见性，谷歌在网站管理员指南中推荐了 LYNX 工具。

[http://support.google.com/webmasters/bin/answer.py?hl=en&answer=35769#2](http://support.google.com/webmasters/bin/answer.py?hl=en&answer=35769#2)

希望它会有所帮助！

# android - Android Fb2png 原生编译问题

> ID：12265274
> 
> 赞同：0
> 
> 时间：2012-09-04T14:08:43.267
> 
> 标签：android, android-ndk

我试图使用 jni 编译 android fb2png 本机源代码。但我面临以下问题。我已经搜索过了，但没有找到任何解决方案。请帮我 。添加了ndk问题。

问题 **

```
** /cygdrive/d/Android_NDK/android-ndk-r5/ndk-build
ompile thumb  : fb2png <= fb2png.c
ompile thumb  : fb2png <= img_process.c
ompile thumb  : fb2png <= fb.c
xecutable     : fb2png
:/RAJESH-ANDROID/Rajesh-workspace/ZT/obj/local/armeabi/objs/fb2png/img_process.o: In function `save_png':
:/RAJESH-ANDROID/Rajesh-workspace/ZT/jni/img_process.c:182: undefined reference to `png_create_write_struct'
:/RAJESH-ANDROID/Rajesh-workspace/ZT/jni/img_process.c:188: undefined reference to `png_create_info_struct'
:/RAJESH-ANDROID/Rajesh-workspace/ZT/jni/img_process.c:192: undefined reference to `png_set_write_fn'
:/RAJESH-ANDROID/Rajesh-workspace/ZT/jni/img_process.c:193: undefined reference to `png_set_IHDR'
:/RAJESH-ANDROID/Rajesh-workspace/ZT/jni/img_process.c:208: undefined reference to `png_set_bKGD'
:/RAJESH-ANDROID/Rajesh-workspace/ZT/jni/img_process.c:209: undefined reference to `png_write_info'
:/RAJESH-ANDROID/Rajesh-workspace/ZT/jni/img_process.c:211: undefined reference to `png_write_image'
:/RAJESH-ANDROID/Rajesh-workspace/ZT/jni/img_process.c:212: undefined reference to `png_write_end'
:/RAJESH-ANDROID/Rajesh-workspace/ZT/jni/img_process.c:214: undefined reference to `png_destroy_write_struct'
:/RAJESH-ANDROID/Rajesh-workspace/ZT/obj/local/armeabi/objs/fb2png/img_process.o: In function `stdio_write_func':
:/RAJESH-ANDROID/Rajesh-workspace/ZT/jni/img_process.c:132: undefined reference to `png_get_io_ptr'
ollect2: ld returned 1 exit status
ake: *** [/cygdrive/D/RAJESH-ANDROID/Rajesh-workspace/ZT/obj/local/armeabi/fb2png] Error 1 ** 
```

**

[http://code.google.com/p/android-fb2png/source/browse/](http://code.google.com/p/android-fb2png/source/browse/)

我的 libpng 源。 ![我的项目](../Images/5073e38bf14a630d9ca7fb7be0d1a196.png)

谢谢，拉杰什K

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-04T14:44:03.633

您缺少 libpng：请注意，来自 repo 的 libpng 的静态副本包含[在此处](http://code.google.com/p/android-fb2png/source/browse/#git/libpng/lib)。检查您的目录中是否有 libpng.a 文件，或者您是否提取了 libpng 源代码并为其设置了 makefile。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-08-05T10:57:51.170

将所有这些 png.h pngconf.h pngusr.h 文件从 include 移动到 jni 文件夹。

# java - 索引期间的 SOLR RuntimeException：如何将文档 ID 写入日志？

> ID：12265277
> 
> 赞同：2
> 
> 时间：2012-09-04T14:08:55.253
> 
> 标签：java, solr, jetty

我们正在索引数百万份文档。我们使用 Solr 3.1 和 Jetty。我启用了 Jetty 的登录，如下所述：[http ://wiki.apache.org/solr/LoggingInDefaultJettySetup](http://wiki.apache.org/solr/LoggingInDefaultJettySetup)

对于某些全文，我们会遇到异常，因此会记录这样的日志：

```
<record>
  <date>2012-09-04T15:55:16</date>
  <millis>1346766916578</millis>
  <sequence>0</sequence>
  <logger>org.apache.solr.core.SolrCore</logger>
  <level>SEVERE</level>
  <class>org.apache.solr.common.SolrException</class>
  <method>log</method>
  <thread>10</thread>
  <message>java.lang.RuntimeException: [was class java.io.CharConversionException] Invalid UTF-8 character 0xd835(a surrogate character)  at c
har #1144, byte #127)
        at com.ctc.wstx.util.ExceptionUtil.throwRuntimeException(ExceptionUtil.java:18)
        at com.ctc.wstx.sr.StreamScanner.throwLazyError(StreamScanner.java:731)
        at com.ctc.wstx.sr.BasicStreamReader.safeFinishToken(BasicStreamReader.java:3657)
        at com.ctc.wstx.sr.BasicStreamReader.getText(BasicStreamReader.java:809)
        at org.apache.solr.handler.XMLLoader.readDoc(XMLLoader.java:287)
        at org.apache.solr.handler.XMLLoader.processUpdate(XMLLoader.java:146)
        at org.apache.solr.handler.XMLLoader.load(XMLLoader.java:77)
        at org.apache.solr.handler.ContentStreamHandlerBase.handleRequestBody(ContentStreamHandlerBase.java:55)
        at org.apache.solr.handler.RequestHandlerBase.handleRequest(RequestHandlerBase.java:129)
        at org.apache.solr.core.SolrCore.execute(SolrCore.java:1360)
        at org.apache.solr.servlet.SolrDispatchFilter.execute(SolrDispatchFilter.java:356)
        at org.apache.solr.servlet.SolrDispatchFilter.doFilter(SolrDispatchFilter.java:252)
        at org.mortbay.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1212)
        at org.mortbay.jetty.servlet.ServletHandler.handle(ServletHandler.java:399)
        at org.mortbay.jetty.security.SecurityHandler.handle(SecurityHandler.java:216)
        at org.mortbay.jetty.servlet.SessionHandler.handle(SessionHandler.java:182)
        at org.mortbay.jetty.handler.ContextHandler.handle(ContextHandler.java:766)
        at org.mortbay.jetty.webapp.WebAppContext.handle(WebAppContext.java:450)
        at org.mortbay.jetty.handler.ContextHandlerCollection.handle(ContextHandlerCollection.java:230)
        at org.mortbay.jetty.handler.HandlerCollection.handle(HandlerCollection.java:114)
        at org.mortbay.jetty.handler.HandlerWrapper.handle(HandlerWrapper.java:152)
        at org.mortbay.jetty.Server.handle(Server.java:326)

</message>
</record> 
```

最好也记录发送的文档 ID。我们应该怎么做？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-25T07:24:49.400

您是在问如何让 Jetty 记录 ID？您不太可能通过 Jetty 记录它，因为无法解析请求中的 XML 以获得 ID 值。请注意堆栈跟踪通知 XMLLoader.readDoc() 方法永远不会超过第 287 行。这是该类的代码（适用于您的版本）：http: [//svn.apache.org/viewvc/lucene/dev/tags/lucene_solr_3_1 /solr/src/java/org/apache/solr/handler/XMLLoader.java?revision=1086927&view=markup](http://svn.apache.org/viewvc/lucene/dev/tags/lucene_solr_3_1/solr/src/java/org/apache/solr/handler/XMLLoader.java?revision=1086927&view=markup)

相关部分：

```
 SolrInputDocument readDoc(XMLStreamReader parser) throws XMLStreamException {
264     SolrInputDocument doc = new SolrInputDocument();
265     
266     String attrName = "";
267     for (int i = 0; i < parser.getAttributeCount(); i++) {
268     attrName = parser.getAttributeLocalName(i);
269     if ("boost".equals(attrName)) {
270     doc.setDocumentBoost(Float.parseFloat(parser.getAttributeValue(i)));
271     } else {
272     XmlUpdateRequestHandler.log.warn("Unknown attribute doc/@" + attrName);
273     }
274     }
275     
276     StringBuilder text = new StringBuilder();
277     String name = null;
278     float boost = 1.0f;
279     boolean isNull = false;
280     while (true) {
281     int event = parser.next();
282     switch (event) {
283     // Add everything to the text
284     case XMLStreamConstants.SPACE:
285     case XMLStreamConstants.CDATA:
286     case XMLStreamConstants.CHARACTERS:
287     text.append(parser.getText()); 
```

Solr 文档尚未构建，因此没有真正的方法可以访问记录 ID 字段。

解决方法是让您的索引器脚本检查 Solr 响应的状态代码，如果状态不为 0（成功），则将记录 ID 写入日志。同样，如果您使用 Java 或 PHP 或可以捕获异常的语言，您也可以捕获这些异常并写出日志。

希望这会有所帮助，祝你好运。

# c++ - 通过基类指针C++访问派生类的成员

> ID：12265280
> 
> 赞同：4
> 
> 时间：2012-09-04T14:08:59.950
> 
> 标签：c++, inheritance

有没有办法通过基类指针让派生类的通用代码访问成员？或者任何其他方式解决这个问题？

假设我有一个 Shape 类。我有继承它的类 Square 和 Triangle。两者都有自己的私有成员，它们彼此无关，因此将它们放在基类中毫无意义。**现在，如果我需要将一个类写入文件，但直到我需要将其写入文件时才知道该类是方形还是三角形，该怎么办？**

我一直在试图弄清楚如何解决这个问题。最坏情况的解决方案是将 Square 和 Triangle 的数据写入文件，为读写添加一个标识符（Triangle 或 Square），并在加载数据时让一个小型解析器将类放在一起。这将是低效且浪费时间的。

我想知道是否有一些技巧或设计模式或任何可以帮助解决这种情况的方法。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-04T14:13:52.823

这种序列化应该使用虚函数来完成。在应序列化对象的基类中定义一个函数。三角形和正方形覆盖了这个函数并写

*   标识符
*   所有应该序列化的数据

如果合适，您可以在基类中实现公共部分。

当您要加载文件时，您将需要创建与标识符对应的类实例的工厂方法。必须调用新的实例虚拟反序列化方法来加载实际数据。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-04T14:12:06.167

您可以在基类中有一个纯虚拟吸气剂。并且您的所有派生类都将覆盖它。像这样

```
class Shape{
  public:
    virtual int data() const = 0;
};
class Square: public Shape{
  private:
     int _member;
  public:
    virtual int data() const{
     //do something with private members and return it
     return _member;
    };
}; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-04T15:51:46.607

我认为没有直接的方法可以消除这种开销。通常这是通过两件事来完成的。首先，对象需要一个序列化机制：

要序列化事物，需要一个位置来序列化。在这种情况下，我们将使用数据容器来执行此操作，但这也可以是文件流或容器类。序列化可以从对象内部或外部进行，现在最简单的实现是从内部进行：

简单的序列化部分：

```
class Shape{
public:
  virtual void serialize( Datacontainer &o ) const = 0;
};

class Triangle: public Shape{
  void serialize( Datacontainer &o ) const{
    o.add('T');
    o.add(corners);
  }
  std::vector<point> corners;
}

class Circle: public Shape{
  void serialize( Datacontainer &o ) const{
    o.add('C');
    o.add(center);
    o.add(radius);
  }
  point center;
  double radius;
} 
```

在序列化过程中，您可以使用基本类 Shape 来做到这一点：

```
Shape *tri = new Triangle;
tri->serialize( dataContainer or file ); 
```

反序列化并不容易，因为您需要知道类型。一个很好的模式是**Builder 模式**。尽管如此，我们可以实现一个更可能的 C++ 方式来做到这一点：

将以下内容添加到您的所有课程中：

```
static Shape* createFrom( Datacontainer &o ); 
```

例如。圈子实现：

```
Shape* Circle::createFrom( Datacontainer &o )
{
  Circle *c = new Circle()
  c->center = o.get();
  c->radius = o.get();
} 
```

这使我们能够创建一个**具体**的实例，但我们有该方法的通用函数足迹。现在可以实现一个非常简单的构建器，如下所示：

```
class ShapeBuilder
{
public:
  static Shape* createShape( Datacontainer& o )
  {
    char id = o.get();
    swith(id){
    case 'T':
      return Triangle::createFrom(o);
    case 'C':
      return Circle::createFrom(o);
    }        
  }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-04T14:11:36.563

您需要在基类中声明虚拟方法，并让派生类定义它们。但是，如果您想将它们保存到文件中 - 您将需要一种方法来识别文件中的特定类实例，因为它们可能具有不同的内存布局。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-04T14:28:47.950

可能最好的方法是做这样的事情。基本模式是您可以将公共代码（保证对于每个派生类始终相同）放在基类中。需要不同的东西，放入派生类各自实现不同的虚函数。

```
class Shape {
    virtual void writeSerialData(std::ostream &) const = 0;
  public:
    void writeToFile(const std::string &filename) const {
        std::ofstream outfile(filename); // filename.c_str() in C++03
        writeSerialData(outfile);
        if (!outfile.close()) {
            // report the error
        }
    }
    virtual ~Shape() {}
};

class Square : public Shape {
    double length;
    virtual void writeSerialData(std::ostream &out) const {
        out << "Square{" << length << '}';
    }
  public:
    Square(double l) : length(l) {}
}; 
```

现在你有下一个问题——你如何从文件中读回一个对象，而不事先知道它是哪个派生类？为此，您需要一种查看文本的方法，`Square`并且 (a) 调用`Square`知道如何解释数据的类的静态函数，或者 (b) 通过向其提供要解释的数据来实例化类 Square。在您走得太远之前，值得研究 Boost Serialization 或其他序列化库。

# html - 为什么 google.com 无法在 iFrame 中加载

> ID：12265298
> 
> 赞同：1
> 
> 时间：2012-09-04T14:09:52.717
> 
> 标签：html, iframe, web

> **可能重复：**
> [如何在 iframe 中显示 google.com？](https://stackoverflow.com/questions/8700636/how-to-show-google-com-in-an-iframe)

我正在研究为学校项目运行代理服务器的可能方法。

我考虑过使用 iframe 将一个网页加载到另一个网页中，所以我做了一个测试。

这是我的 HTML：

```
<html>
  <body>
    <IFRAME SRC="http://google.com" WIDTH=1024 HEIGHT=768>
      Not loaded
    </IFRAME>
  </body>
</html> 
```

但是， http: [//google.com](http://google.com)不会加载，而是 iframe 保持白色。

经进一步检查，谷歌浏览器加载 google.com 的 GET 请求已被取消。

我怀疑谷歌阻止人们在 iframe 中加载他们的网站，但为什么会这样，它的影响是什么？

* * *

**编辑：** 我忘了提，其他网站（比如我[自己的](http://todddavies.co.uk)）工作正常。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-04T14:11:48.660

因为它具有 X-Frame-Options 标头策略，并且浏览器倾向于尊重这些策略。

[在这里](https://developer.mozilla.org/en-US/docs/The_X-FRAME-OPTIONS_response_header)和[这里阅读](https://datatracker.ietf.org/doc/html/draft-ietf-websec-x-frame-options-00#page-3)

> “X-Frame-Options”允许来自主机 B 的安全网页声明其内容（例如按钮、链接、文本等）不得显示在另一个页面的框架中（例如来自主机 A） . 原则上，这是由 HTTP 标头中声明的策略完成的，并由符合浏览器实现的遵循。

# sql - 从 SQL 行中的字符串中检索第一封电子邮件

> ID：12265300
> 
> 赞同：0
> 
> 时间：2012-09-04T14:10:02.383
> 
> 标签：sql, string

早上好，我在表格中有一个电子邮件列，其中**某些行**包含多个电子邮件，用分号分隔。实际上我正在尝试使用此查询检索电子邮件

```
-- cdu_mail is the column

select
    ltrim(rtrim(cdu_mail)),
    substring(ltrim(RTRIM(cdu_mail)), 0, charindex(';',ltrim(RTRIM(cdu_mail)))) 
FROM Clientes 
```

如果我在该行中有多个邮件，则查询会正确检索第一封电子邮件，但如果该行中只有一封电子邮件，则结果为空白。

![在此处输入图像描述](../Images/a2570339b8b758f1e9b8e11bd7691148.png)

我需要更改什么才能正确接收所有邮件？

谢谢你。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-04T14:15:24.680

您还可以在列末尾添加分号以保证分号始终存在，并避免使用 case 表达式：

```
select     ltrim(rtrim(cdu_mail)),     
    substring(ltrim(RTRIM(cdu_mail)), 0, charindex(';',ltrim(RTRIM(cdu_mail + ';')))) 
FROM #Clientes 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-04T14:12:37.817

您可以将其放入 case 语句中：

```
select (case when cdu_email like '%;'
             then ltrim(rtrim(cdu_mail)), substring(ltrim(RTRIM(cdu_mail)), 0,
                                                    charindex(';',ltrim(RTRIM(cdu_mail))))
             else cdu_email
        end) as firstEmail
from Clientes 
```

问题是一封电子邮件不以“;”结尾，因此 charindex() 返回 0。

我意识到，您也可以通过为该特定搜索附加分号来解决此问题：

```
select ltrim(rtrim(cdu_mail)), substring(ltrim(RTRIM(cdu_mail)), 0,
                                         charindex(';',ltrim(RTRIM(cdu_mail+';'))))
from Clientes 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-04T14:14:51.457

```
 select  case when charindex(';', cdu_mail) = 0 then cdu_mail else
                    substring(cdu_mail,1, charindex(';', cdu_mail) - 1) end
    from    clientes 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-04T14:26:06.230

我不知道您使用的是什么版本的 SQL 语法，但在 MySQL 中您可以执行以下操作：

```
SELECT 
    IF( LOCATE(  ";", TRIM( cdu_mail ) ) >1, LEFT( TRIM( cdu_mail ), 
    LOCATE(  ";", TRIM( cdu_mail ) ) -1 ), 
    TRIM( cdu_mail ) ) AS email
FROM Clientes 
```

有效地如果有“;”，则选择第一封电子邮件，否则只需获取该字段的值（因为只有一封电子邮件）。

您可能还想引入使用 WHERE 子句检查 NULL 值。

高温高压

# r - 组合来自 plyr 的“引用”对象

> ID：12265307
> 
> 赞同：2
> 
> 时间：2012-09-04T14:10:25.637
> 
> 标签：r, plyr

我真的是 plyr 的`quoted`课；我希望能够组合两个引用对象并获得一个新对象。例如，我如何定义`mult(a,b)`这样

```
q1 <- as.quoted("x+y")
q2 <- as.quoted("y+z")
mult <- function(a, b) {?????}

## mult(q1, q2) returns as.quoted("(x+y)*(y+z)") 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-04T14:16:56.387

您需要`eval`引用的公式，然后将`paste`它们放在一起：

```
mult <- function(a, b) {
  as.quoted(paste(eval(a), '*', eval(b)))
}

> mult(q1, q2)
List of 1
 $ x + y * y + z: language x + y * y + z
 - attr(*, "env")=<environment: 0x2920980> 
 - attr(*, "class")= chr "quoted"
> 
```

# objective-c - 将对象添加到 NSView

> ID：12265308
> 
> 赞同：2
> 
> 时间：2012-09-04T14:10:27.103
> 
> 标签：objective-c, cocoa, nsview

我的项目窗口中有一个 NSView ，如下图所示：

![](../Images/bbdb1ff695d68ee38d9d0343e4d3903c.png)

如何将 NSImageViews 添加到此“自定义视图”的子视图中，使其显示在那里而不是直接显示在应用程序的主窗口中？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-04T15:38:50.720

以编程方式，您将访问要添加子视图的视图，然后在其上调用 -addSubView: 方法。您可以将其作为连接到界面构建器的 IBOutlet 来访问，也可以通过标识符访问它（在界面构建器检查器的“身份”部分中设置标识符字符串）。遍历窗口控制器视图的子视图（您的自定义视图将是一个）并测试“标识符”的字符串值

这是最近一个项目的简化代码片段，用于以编程方式将额外的“属性”框添加到已经在 xib 中定义的框的视图中。我正在将一个新的框视图 ( `propertiesBoxView`) 添加到现有的`NSView`（由 IBOutlet-ed 引用`_detailsView`）中，并将其相对于另一个同级框（其标识符设置为“UI_DETAILSBOX”）定位。NSImageView 的行为方式应该与框视图相同：

```
_propsViewController = [[MySpecialViewController alloc] initWithThings:...];
/* snip */

NSView *propertiesBoxView = [_propsViewController view];
NSView *detailsBox = nil;
// find the details box
for (NSView *sibling in [_detailsView subviews]) {
  if ([[sibling identifier] isEqualToString:@"UI_DETAILSBOX"]) {
    detailsBox = sibling;
    break;
  }
}
if (detailsBox == nil) {
  return;
}

[_detailsView addSubview:propertiesBoxView];
NSDictionary *viewsDictionary = NSDictionaryOfVariableBindings(propertiesBoxView, detailsBox);
NSArray *verticalConstraints = [NSLayoutConstraint constraintsWithVisualFormat:@"V:[detailsBox]-9-[propertiesBoxView]-(>=9)-|"
                                                             options:0
                                                             metrics:nil
                                                               views:viewsDictionary];
NSArray *horizontalConstraints = [NSLayoutConstraint constraintsWithVisualFormat:@"H:|-9-[propertiesBoxView]-(>=9)-|"
                                                             options:0
                                                             metrics:nil
                                                               views:viewsDictionary];
[_detailsView addConstraints:verticalConstraints];
[_detailsView addConstraints:horizontalConstraints]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-04T14:14:50.243

将 NSImageViews 拖放到 NSView 上，这会将 NSImageViews 作为接口生成器中的子视图添加到 NSView

# javascript - Ember 可折叠容器

> ID：12265316
> 
> 赞同：3
> 
> 时间：2012-09-04T14:10:53.860
> 
> 标签：javascript, html, css, ember.js, handlebars.js

我正在使用带有把手的 Ember.js，我需要在我的页面中创建一个 div，单击时折叠/展开。我知道如何在 jQuery 中做到这一点，但我不能使用任何 jQuery。有谁知道如何做到这一点？此外，我不想只切换隐藏属性，我需要完整的上下滑动功能来折叠。如果有人有任何想法，我将不胜感激。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-04T14:44:35.063

单击您的视图将导致触发单击事件。您可以在视图中的单击事件处理程序中以任何您想要的方式对动画进行编码：

```
CollapsableView = Ember.View.extend({
   click : function(event) {
      this.$().toggle('fast');
   }
}) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-05-14T14:00:34.660

在 Ember 中执行此操作的正确方法是通过出色的[Liquid Fire](http://ef4.github.io/liquid-fire/#/)插件。

大纲：

1.  将 Liquid Fire 安装到您的项目中。
2.  像这样定义一个过渡：

    ```
    this.transition(
      this.hasClass('transition-spoiler'),
      this.toValue(true),
      this.use('toDown'),
      this.reverse('toUp')
    ); 
    ```

3.  在您的控制器/组件中，创建一个属性`spoilerIsVisible`和一个`toggleSpoiler`属性：

    ```
    spoilerIsVisible: false,

    actions: {
      toggleSpoiler: function() {
        this.toggleProperty('spoilerIsVisible');
      }
    } 
    ```

4.  在您的页面/组件模板中，创建一个按钮和一个扰流器包装器，如下所示：

    ```
    <button {{action 'toggleSpoiler'}}>
      {{if spoilerIsVisible 'Show spoiler' 'Hide spoiler'}}
    </button>

    {{#liquid-if spoilerIsVisible class="transition-spoiler"}}
      <p>Dumbledore dies</p>
    {{/liquid-if}} 
    ```

请注意，您可以将步骤 3-4 包装到`x-spoiler`组件或其他东西中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-04T15:25:19.990

我做了类似的事情，但使用了树结构。我以前在这里写过一篇关于这个的博客文章：http: [//haagen-software.no/blog/post/2012-05-05-Ember_tree](http://haagen-software.no/blog/post/2012-05-05-Ember_tree)

它具有您需要的功能，因为它会在单击节点时从 DOM 中添加和删除元素。

在我目前正在这里构建的应用程序中可以看到一个工作示例：[https ://github.com/joachimhs/EurekaJ/tree/netty-ember/EurekaJ.View/src/main/webapp](https://github.com/joachimhs/EurekaJ/tree/netty-ember/EurekaJ.View/src/main/webapp)

# java - HttpURLConnection 通过代理访问时返回 503 错误

> ID：12265319
> 
> 赞同：5
> 
> 时间：2012-09-04T14:11:07.697
> 
> 标签：java, http-status-code-503, brightcove

我正在为在 Brightcove 视频云上托管视频的网站创建视频站点地图。为了从该站点获取所有视频信息，Brightcove 建议从以下表单的 url 中读取响应

```
http://api.brightcove.com/services/library?token="+accountToken+"&page_size=1&command=find_all_videos&output=JSON&get_item_count=true 
```

url 的输出是 JSON，其中`accountToken`只是帐户的标识符。

当我在浏览器中使用 Token 访问上述 url 时，它给了我正确的响应。

我写了下面的程序片段以从该 url 中读取

```
URL jsonURL = new URL("http://api.brightcove.com/services/library?token="+accountToken+"&page_size=1&command=find_all_videos&output=JSON&get_item_count=true");
        HttpURLConnection connection = (HttpURLConnection) jsonURL.openConnection();
        connection.setRequestMethod("GET");
        connection.connect();
        BufferedReader reader = new BufferedReader(
                new InputStreamReader(connection.getInputStream()));
        String lineRead = "";
        while (reader.ready()) {
            lineRead = lineRead + reader.readLine();
        } 
```

由于我的浏览器使用代理，我添加了以下代码以包含代理设置

```
 System.setProperty("http.proxyHost", "my.proxyurl.com");
        System.setProperty("http.proxyPort", "80"); 
```

不使用代理设置，它会返回`java.net.ConnectException: Connection refused: connect`并使用代理它给我`java.io.IOException: Server returned HTTP response code: 503`

所以我的问题是，为什么它给我一个 503（服务不可用）错误？从浏览器它工作正常。

**更新 1：** 这似乎是网络的问题。我 ping 了域，它说“请求超时”。虽然通过 HTTP 工作。看起来是防火墙的问题。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-06T16:23:22.440

我认为，这可能是由于您的互联网连接，我尝试了您的代码但没有得到任何`503(Service Unavailable)`. 检查不同的连接连接（没有代理），它应该可以工作。或者您可以尝试使用稍微不同的方法：

```
Proxy proxy = new Proxy(Proxy.Type.HTTP, new InetSocketAddress("host", "port));
conn = new URL(jsonURL).openConnection(proxy); 
```

如果您有 SOCKS 类型代理，请将`Proxy`的构造函数参数更改为`Proxy.Type.SOCKS`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-07-14T07:19:39.997

对 Jamas 代码的小幅修正

```
String host="myproxy.com";
int port=8080;
Proxy proxy = new Proxy(Proxy.Type.HTTP, new InetSocketAddress(host, port)); 
```

# grails - Grails 在运行时更改数据源（JDBC URL）

> ID：12265321
> 
> 赞同：1
> 
> 时间：2012-09-04T14:11:14.900
> 
> 标签：grails, jdbc

我想在视图中更改我的默认（也是唯一的）数据源（jdbc url、用户名、密码）。这些更改应立即影响连接。

目前没有适合我需要的答案。

我被困在我的控制器中使用它：

```
dataSourceUnproxied.with {
  url = params.jdbc
  username = params.user
  password = params.password
} 
```

但连接仍然指向旧数据源。

如何重置当前数据源并使用新属性（使用 Grails 1.3.7）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-04T14:23:13.573

您可以使用[数据源插件](http://www.grails.org/plugin/datasources)为该视图创建一个新的数据源，并在需要时动态更改它。检查它：[grails 如何在运行时从另一个数据库获取数据](https://stackoverflow.com/questions/12235656/grails-how-to-get-data-from-another-data-base-in-runtime/12236129#12236129)

# ruby - (?m:\s*) 在正则表达式行话中是什么意思？

> ID：12265325
> 
> 赞同：0
> 
> 时间：2012-09-04T14:11:26.340
> 
> 标签：ruby, regex

这在表达式中意味着什么？

```
(?m:.*?) 
```

或这个

```
(?m:\s*) 
```

我的意思是，它似乎与空白有关，但我不确定。

附加细节：
我正在查看的完整表达式是：

```
\A((?m:\s*)((\/\*(?m:.*?)\*\/)|(\#\#\# (?m:.*?)\#\#\#)|(\/\/ .* \n?)+|(\# .* \n?)+))+ 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-04T14:15:08.007

模式`.*?`将匹配任何字符串，但字符串尽可能短，因为有一个惰性运算符`?`。

模式`\s*`将匹配空白字符（零个或多个）。

`(?m)`启用“多行模式”。在这种模式下，插入符号和美元在主题字符串中的换行符之前和之后匹配。要将此模式仅应用于某些子模式，请`(?m:...)`使用 sytax，其中`...`是匹配模式。

有关更多信息，请阅读[http://www.regular-expressions.info/modifiers.html](http://www.regular-expressions.info/modifiers.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-04T14:31:25.813

`(?...)`是一种对括号内的正则表达式应用修饰符的方法。

`(?:...)`允许您将括号之间的部分视为一个组，而不会影响匹配引擎捕获的字符串集。`?`但是您可以在和之间添加选项字母`:`，在这种情况下，括号之间的正则表达式部分的行为就像您在创建正则表达式时包含了这些选项字母一样。也就是说，`/(?m:...)/`行为与 相同`/.../m`。

反过来`m`，启用“多行”模式。

**更正：**

这是我在原始答案中感到困惑的地方，因为此选项在不同的环境中具有不同的含义。

这个问题被标记为 Ruby，其中“多行模式”导致点字符 ( `.`) 匹配换行符，而通常这是它不匹配的一个字符：

```
irb(main):001:0> "a\nb" =~ /a.b/
=> nil
irb(main):002:0> "a\nb" =~ /a.b/m
=> 0
irb(main):003:0> "a\nb" =~ /(?m:a.b)/
=> 0 
```

因此，您的第一个正则表达式`(?m:.*?)`将匹配任何数字（包括零）的任何字符（包括换行符）。基本上，它会匹配任何东西，包括什么都不匹配。

在第二个正则表达式中`(?m:\s*)`，修饰符根本没有任何作用，因为包含的表达式中没有点可以修改。

回到第一个表达式。正如 Ωmega 所说，`?`后面的`*`意味着它是非贪婪匹配。如果这就是整个表情，或者如果没有捕获，那就无所谓了。但是，当该部分之后有某些内容并且有捕获时，您会得到不同的结果。没有`?`，最长的匹配获胜：

```
irb(main):001:0> /<(.*)>/.match("<a><b>")[1]
=> "a><b" 
```

使用`?`，您将获得最短的：

```
irb(main):002:0> /<(.*?)>/.match("<a><b>")[1]
=> "a" 
```

最后，关于上面提到的`/m`困惑（虽然如果你想避免自己困惑，这可能是一个停止阅读的好地方）：

在 Perl 5 中（这是基本语法之外的大多数正则表达式扩展的来源），`/m`在 Ruby 中触发的行为是由`/s`选项触发的（Ruby 没有，尽管如果你在你的正则表达式上放一个，它会默默地忽略它）。在 Perl 中`/m`，尽管仍被称为“多行模式”，但它具有完全不同的效果：它使`^`和`$`锚点分别匹配字符串中的换行符以及整个字符串的开头和结尾。但在 Ruby 中，这种行为是默认行为，甚至没有选项可以更改它。

# javascript - 我可以通过回调验证 Twitter 推文的内容吗？

> ID：12265328
> 
> 赞同：1
> 
> 时间：2012-09-04T14:11:34.343
> 
> 标签：javascript, twitter

我正在尝试以某种方式将 twitter 集成到我的网站中，这样我就可以为我的网站成员提供关于该网站的推文的“积分”。到目前为止一切正常，除了我不知道如何确保用户实际上在说与我的网站相关的内容。

基本上，一旦用户提交推文，我想验证推文是否包含我的主题标签。文本的其余部分可以是他们喜欢的任何内容，但如果他们从推文中删除主题标签，我不想给他们积分。

我正在使用 javascript 推文按钮，并将用于分配点的代码放在

twttr.events.bind('tweet', function(event) { ... });

如何查看用户发的推文？

谢谢！

# linux - CPanel 电子邮件管道到 linux 中的 shell 脚本，语法

> ID：12265333
> 
> 赞同：1
> 
> 时间：2012-09-04T14:11:49.917
> 
> 标签：linux, shell, cpanel

我正在尝试编写一个 shell 脚本，将电子邮件传送到其中（通过 cpanel 中的电子邮件转发）。

然后，shell 脚本将使用 curl 将整个电子邮件发布到 url。

脚本如下所示：

```
curl -d "param=$1" http://localhost/stuff/ 
```

前锋看起来像这样：

```
|/home/usr/script/curlthis.sh 
```

这只是一种工作。

即使 curl 成功发布到 url，电子邮件也会被退回。（看起来只有部分电子邮件被发布，但我不是 100% 确定）

我被告知电子邮件退回，因为我没有阅读标准输入，但我不知道为什么我需要这样做以及为什么我不能使用 1 美元？

如何读取管道的全部内容（然后使用 curl 发布），这会阻止邮件服务器将其退回吗？

**编辑**

在这里使用下面的答案是我想出的：

```
#!/bin/bash
m=$(cat -) 
escapedm="$(perl -MURI::Escape -e 'print uri_escape($ARGV[0]);' "$m")"
curl -silent -G -d "param=$escapedm" http://localhost/stuff/ 2>&1 >/dev/null 
```

这部分：

```
2>&1 >/dev/null 
```

非常重要。如果您不将 stdout/err 重定向为 null，那么无论出于何种原因，电子邮件都会被退回。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-04T14:15:37.783

您的邮件作为标准输入上的*流传*递给脚本，而不是作为参数 ( `$1`)。请注意，您的转发脚本以管道开头，这就是将邮件传递到您的脚本的机制。

因此，您应该能够使用该`read`语句在您的 shell（bash？）中读取它。有关更多详细信息，请参阅[此 SO 答案](https://stackoverflow.com/questions/2746553/bash-script-read-values-from-stdin-pipe)。

# wpf - 在内容中制作带有矢量图形的按钮

> ID：12265336
> 
> 赞同：5
> 
> 时间：2012-09-04T14:12:05.387
> 
> 标签：wpf, expression-blend

我对 WPF 设计（和一般设计）非常陌生，我需要帮助完成一项任务。

我有一个按钮样式，其中包含路径中的一些数据，它在其上绘制一个图标（基本上简单的添加新图标）。现在我想用它制作一个复制图标。

我找不到使用 Blend 中的 Path 进行操作的方法，所以我想到的是：

1）复制路径数据，以便我们可以绘制两个图标（在内容中有两个路径对象） 2）首先向左和顶部移动一点 3）将第二个向右和底部移动一点 4）使第二个与第一个重叠

这就是我所做的：因为我们不能为 Content 设置两个元素，所以我添加了一个 Grid 元素，并在里面复制了两次 Path 元素。然后我重新定位了两条路径以模拟重复数据。

```
<Setter Property="Content">
    <Setter.Value>
    <Grid>
            <Path Data="..." Margin="10" Stretch="Fill" Fill="{StaticResource IconBrush}" RenderTransformOrigin="0.5,0.4">
                <Path.RenderTransform>
                    <TransformGroup>
                <ScaleTransform />
                <SkewTransform />
                <RotateTransform Angle="-90" />
                <TranslateTransform />
            </TransformGroup>
        </Path.RenderTransform>
    </Path>
    <Path Data="..." Margin="10" Stretch="Fill" Fill="{StaticResource IconBrush}" RenderTransformOrigin="0.5,0.6">
                <Path.RenderTransform>
            <TransformGroup>
                <ScaleTransform />
                <SkewTransform />
                <RotateTransform Angle="-90" />
                <TranslateTransform />
            </TransformGroup>
        </Path.RenderTransform>
    </Path>                                 
    </Grid>
    </Setter.Value>
</Setter> 
```

问题：我没有与第二个图标重叠（基本上一切都是透明的。这意味着我可能需要删除第一个图标上的一些点，但我无法在 Blend 中实现这一点？

任何人都可以分享一些如何实现我需要的东西吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-04T14:56:02.967

不确定您的图标应该是什么样子，但下面的 XAML 将显示两个重叠的加号`Path`，两者使用相同的数据，但用一个简单`TranslateTransform`的偏移第二个加号。

```
 <Grid>
        <Path Fill="#FF008000" >
            <Path.Data>
                <PathGeometry Figures="m 30 25.362188 0 30.000001 -30 0 0 20 30 0 0 29.999991 20 0 0 -29.999991 30 0 0 -20 -30 0 0 -30.000001 -20 0 z" FillRule="nonzero"/>
            </Path.Data>
        </Path>
        <Path Fill="#FF92D050" >
            <Path.Data>
                <PathGeometry Figures="m 30 25.362188 0 30.000001 -30 0 0 20 30 0 0 29.999991 20 0 0 -29.999991 30 0 0 -20 -30 0 0 -30.000001 -20 0 z" FillRule="nonzero"/>
            </Path.Data>
            <Path.RenderTransform>
                <TranslateTransform X="25" Y="-25"/>
            </Path.RenderTransform>
        </Path>
    </Grid> 
```

我建议不要在您的实际路径对象中放置边距或“拉伸”属性。如果您需要放大或缩小它们，请在它们所在的 Grid 容器或包含的 Viewbox 中处理它。

**编辑**

如果您实际上使用对象的`Fill`属性`Path`来绘制图标几何图形，就像使用`VisualBrush`对象一样，而不是`Path.Data`，那么您首先不想使用 a `Path`。只需使用两个`Rectangle`对象，用您的“IconBrush”填充网格并`TranslateTransform`在其中一个上执行，以便它们重叠到所需的数量。请记住，使用 XAML，列表中最后出现的对象呈现在顶部。

**编辑 2**

```
 <Grid>
        <Path Fill="#FFFFFFFF">
            <Path.Data>
                <PathGeometry Figures="m 13.123027 65.796864 0 81.448876 133.750213 0 0 -133.778725 -67.192062 0 z" FillRule="NonZero"/>
            </Path.Data>
        </Path>
        <Path Fill="#FFB3B3B3">
            <Path.Data>
                <PathGeometry Figures="M 79.624708 0.36218262 0 62.950511 l 0 97.411669 160 0 0 -159.99999738 -80.375292 0 z m 2.28303 16.89635038 61.172792 0 0 126.207297 -126.161061 0 0 -76.829978 0.187646 -0.156158 64.800623 0 0 -49.221161 z" FillRule="NonZero"/>
            </Path.Data>
        </Path>
        <Path Fill="#FFFFFFFF">
            <Path.Data>
                <PathGeometry Figures="m 13.123027 65.796864 0 81.448876 133.750213 0 0 -133.778725 -67.192062 0 z" FillRule="NonZero"/>
            </Path.Data>
            <Path.RenderTransform>
                <TranslateTransform X="30" Y="30"/>
            </Path.RenderTransform>
        </Path>
        <Path Fill="#FFB3B3B3">
            <Path.Data>
                <PathGeometry Figures="M 79.624708 0.36218262 0 62.950511 l 0 97.411669 160 0 0 -159.99999738 -80.375292 0 z m 2.28303 16.89635038 61.172792 0 0 126.207297 -126.161061 0 0 -76.829978 0.187646 -0.156158 64.800623 0 0 -49.221161 z" FillRule="NonZero"/>
            </Path.Data>
            <Path.RenderTransform>
                <TranslateTransform X="30" Y="30"/>
            </Path.RenderTransform>
        </Path>
    </Grid> 
```

上面的 XAML 可能对您的需求来说太大了。您可以将整个网格放在 a 中`Viewbox`，然后设置 的`Height`和`Width`属性`Viewbox`以使其达到您需要的大小。

* * *

* * *

**编辑 3**

自定义按钮样式：

```
<Style x:Key="btnCustom" TargetType="{x:Type Button}">
    <Setter Property="Content">
        <Setter.Value>
            <Viewbox>
                <Grid Margin="0,0,30,30">
                    <Path Fill="#FFFFFFFF">
                        <Path.Data>
                            <PathGeometry Figures="m 13.123027 65.796864 0 81.448876 133.750213 0 0 -133.778725 -67.192062 0 z" FillRule="NonZero"/>
                        </Path.Data>
                    </Path>
                    <Path Fill="#FFB3B3B3">
                        <Path.Data>
                            <PathGeometry Figures="M 79.624708 0.36218262 0 62.950511 l 0 97.411669 160 0 0 -159.99999738 -80.375292 0 z m 2.28303 16.89635038 61.172792 0 0 126.207297 -126.161061 0 0 -76.829978 0.187646 -0.156158 64.800623 0 0 -49.221161 z" FillRule="NonZero"/>
                        </Path.Data>
                    </Path>
                    <Path Fill="#FFFFFFFF">
                        <Path.Data>
                            <PathGeometry Figures="m 13.123027 65.796864 0 81.448876 133.750213 0 0 -133.778725 -67.192062 0 z" FillRule="NonZero"/>
                        </Path.Data>
                        <Path.RenderTransform>
                            <TranslateTransform X="30" Y="30"/>
                        </Path.RenderTransform>
                    </Path>
                    <Path Fill="#FFB3B3B3">
                        <Path.Data>
                            <PathGeometry Figures="M 79.624708 0.36218262 0 62.950511 l 0 97.411669 160 0 0 -159.99999738 -80.375292 0 z m 2.28303 16.89635038 61.172792 0 0 126.207297 -126.161061 0 0 -76.829978 0.187646 -0.156158 64.800623 0 0 -49.221161 z" FillRule="NonZero"/>
                        </Path.Data>
                        <Path.RenderTransform>
                            <TranslateTransform X="30" Y="30"/>
                        </Path.RenderTransform>
                    </Path>
                </Grid>
            </Viewbox>
        </Setter.Value>
    </Setter>
</Style> 
```

按钮实现：

```
 <Button HorizontalAlignment="Right" Style="{StaticResource btnCustom}"
            Height="30" Width="100"/> 
```

它在 WPF 窗口中的外观：

![在此处输入图像描述](../Images/34caa4cd62b51fa42d8ee6f846f18ecc.png)

# c# - 如何计算网页的刷新次数

> ID：12265339
> 
> 赞同：0
> 
> 时间：2012-09-04T14:12:07.117
> 
> 标签：c#, javascript

我有一个 Web 形式的 Asp.Net，我希望 JavaScript 计算我刷新页面的次数。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-04T14:14:25.233

你想计算每个用户的数量吗？还是整个应用程序？

如果您正在为整个应用程序做，您可以在每个页面请求上使用 Global.asax 中的应用程序变量。但是，如果您的应用程序循环使用，这可能会丢失。

如果你想为每个用户做你可以在客户端使用服务器端会话或 cookie。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-04T14:17:43.140

如果您想在客户端执行此操作，只需保存（并检索）`localstorage`每次 `load`事件发生时的信息

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-04T14:27:00.263

您可以使用 js 或 asp 在[cookie](http://msdn.microsoft.com/fr-fr/library/78c837bd%28v=vs.80%29.aspx)中设置值，或者在会话值（单个用户）或应用程序值（所有用户）中设置值，不需要 javascript。

您必须将此代码服务器端放在页面[加载](http://msdn.microsoft.com/en-us/library/system.web.ui.control.onload%28v=vs.100%29.aspx)上。

对于所有用户：

```
Application["refresh_count"] =
 Convert.ToInt64(HttpContext.Current.Application["refresh_count"]) + 1; 
```

对于具有会话的单个用户：

```
Session["refresh_count"] = Convert.ToInt64(Session["refresh_count"]) + 1; 
```

或者

```
Response.Cookies["UserSettings"]["refresh_count"] = Convert.ToInt64(Response.Cookies["UserSettings"]["refresh_count"]) + 1;
Response.Cookies["UserSettings"].Expires = DateTime.Now.AddDays(1d); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-04T14:14:38.277

您可以将其保存在[会话](http://msdn.microsoft.com/en-EN/library/87069683%28v=vs.80%29.aspx)对象中。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-04T14:18:04.607

您可以使用 jQuery 调用准备好的地址。例如：

```
$.ajax({
  url: ".../countPageRefreshes.aspx",
  data: { page: "thisPageAddress" }
}) 
```

然后，在 countPageRefreshes 中，您可以增加页面刷新的次数并将其保存在某处。

# javascript - 为什么我在基于 Canvas 的游戏中的 IE 中出现无法拖动图像符号

> ID：12265343
> 
> 赞同：0
> 
> 时间：2012-09-04T14:12:15.970
> 
> 标签：javascript, html, canvas, drag-and-drop

我正在使用 HTML5 画布制作游戏。在 Internet Explorer 中拖放时有一些奇怪的行为。它在大多数情况下都有效，但大约十分之一的时间会显示无法拖动图像符号（带有十字的小圆圈）。发生这种情况后，当我松开鼠标按钮时，图像将跳到适当的位置，然后尽管鼠标按钮向上，但它仍会跟随鼠标，就像`mouseup`事件从未发生过一样。这在任何其他浏览器中都不会发生，这让我认为这不是我实现拖放的方式。

即使我的拖放代码有问题，我也不明白为什么它会显示这个符号。它怎么会知道我正在尝试拖动图像？以前有没有人经历过这种情况，您对此做了什么？

我认为没有必要发布任何代码，因为它只是标准的拖放，虽然我有自己的输入类，所以它可能看起来很混乱。但我现在要谈谈一些细节。

如果在该帧按下鼠标，我会检查它是否在其中一个可拖动的图像上。如果是下一次在鼠标按钮仍然按下时移动鼠标，则图像将移动到鼠标的新位置减去偏移量。

每次释放鼠标时我都会删除鼠标移动事件侦听器，并在每次按下鼠标按钮时添加事件侦听器。我将每个 mousedown 和 mouseup 事件存储在一个数组中，并在每一帧上循环这些事件以设置适当的标志。( `wasPressed`, `wasReleased`, `isDown`, 等等) 我只存储最近的 mousemove 事件。然后我从我的游戏循环中查询这些标志。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-04T17:07:21.447

确保你没有让任何事件冒泡，通常这意味着调用`e.preventDefault();`你的 mouseodwn/move/up 事件

此外，您应该防止在画布上进行选择，这应该会阻止一些拖动和双击错误：

`canvas.addEventListener('selectstart', function(e) { e.preventDefault(); return false; }, false);`

# iphone - DDMathParser 导致内存泄漏

> ID：12265348
> 
> 赞同：0
> 
> 时间：2012-09-04T14:12:28.290
> 
> 标签：iphone, ios, objective-c, ddmathparser

我在我的 Xcode 项目中使用 DDMathParser。我有内存泄漏，我无法解决它。

Instruments 给了我以下泄露的对象：
_DDNumberExpression
_DDFunctionExpression

谁能帮我？

我使用 ddmathparser 的代码：

```
NSString *result = [NSString stringWithFormat:@"%@", [string numberByEvaluatingString]]; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-04T22:07:43.713

DDMathParser 作者在这里。

我当然希望这不是我的代码中的泄漏，但是如果复制案例像你说的那样简单，那么它肯定是可能的。静态分析器没有向我显示代码有任何问题，但静态分析器也不完美。

这是我需要调试的内容：

1.  是什么`string`？明明是`NSString`变量，但我需要知道内容
2.  您是在用 做其他事情`DDMathParser`，还是只是这一行？

* * *

**编辑**

从您的[另一个问题](https://stackoverflow.com/q/12271473/115730)中，我看到您正在使用字符串`@"1+2"`。当我在 Instruments 中运行该代码时，我没有泄漏（使用 ARC 和不使用 ARC）。所以，是的，我需要更多信息。

# google-apps - Google Apps 管理员在我的收件箱中获取每封传入/传出邮件的副本

> ID：12265353
> 
> 赞同：2
> 
> 时间：2012-09-04T14:12:40.520
> 
> 标签：google-apps

我有一个域，并且我已经通过 Google Apps 成功配置了电子邮件服务。我也创建了 5 个电子邮件帐户。

现在我想跟踪所有传入/传出的电子邮件。有什么办法吗，如果任何人（在这 5 个人中）发送或接收电子邮件，我也希望在我的收件箱中自动收到该电子邮件的副本。

提前致谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-23T20:43:44.247

您可以使用 GAM 和审计监视器来获取发送和接收的用户邮件的副本。您还将通过电子邮件监视器看到聊天和草稿消息：

[http://code.google.com/p/google-apps-manager/wiki/ExamplesAccountAuditing#Create_a_Audit_Monitor](http://code.google.com/p/google-apps-manager/wiki/ExamplesAccountAuditing#Create_a_Audit_Monitor)

此功能需要 Google Apps for Business 或 Education。

周杰伦

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-04T19:05:42.200

我不确定您是否可以在另一个帐户中收到副本，但您可以配置每个帐户以委派对您帐户的访问权限，以便您可以查看他们发送/接收的消息。但是，它比您想要的更手动。

*   [http://support.google.com/mail/bin/answer.py?hl=en&answer=138350](http://support.google.com/mail/bin/answer.py?hl=en&answer=138350)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-21T17:43:29.987

在不进入 GAM 并使用审计的情况下，最好的方法是通过进入 gmail 帐户界面为每封电子邮件配置邮件转发。

可以使用的另一种解决方案是创建外部 gmail 电子邮件，并使用 google 应用程序电子邮件路由将所有电子邮件发送到外部电子邮件。在外部邮件上，您可以对电子邮件做任何您想做的事情，例如按收件人过滤并将其转发到您选择的目的地。

希望我的回答有点帮助。

# php - PostageApp 电子邮件，是否已发送

> ID：12265355
> 
> 赞同：0
> 
> 时间：2012-09-04T14:12:47.723
> 
> 标签：php, postageapp

使用 PHP 如何获得返回状态。消息是否已收到。我找到了这个文档，但是在使用 PHP 时它不是很有帮助：

[http://blog.postageapp.com/tag/php/](http://blog.postageapp.com/tag/php/)

我不确定，但这是否有效：

```
if($this->postageapp->send()==true){ # returns JSON response from the server

//do something, 

}else{

//otherwise

} 
```

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-17T08:56:10.367

无论调用是否成功，send 方法都会返回一个 JSON 对象。我认为 PHP 总是将这个返回值评估为 true。

因此，您需要检查返回的对象。

```
$retVal = $this->postageapp->send();
$success = retVal->response->status == 'ok'; 
```

# android - FragmentDialog 不同的UI设计

> ID：12265360
> 
> 赞同：0
> 
> 时间：2012-09-04T14:13:17.337
> 
> 标签：android, android-layout

[我尝试将此链接](http://android-developers.blogspot.com/2012/05/using-dialogfragments.html)作为启动示例，但我有不同的 UI 设计。我有这个：

![在此处输入图像描述](../Images/1bd36724de9fb1f25bd8c2ee317e125e.png)

但我想要这样的新设计：

![在此处输入图像描述](../Images/bb5a60812b747e3a5a7b29e48ba18904.png)

我使用 android api 14 在模拟器上启动我的项目。

如何将新设计用作最后一张图片？

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-09-04T14:25:42.767

@WebnetMobile.com 朋友您可以通过使用列表视图然后使用样式来获得此视图，这样 editText 元素必须具有宽度填充父元素，并且提示必须具有样式元素，并且此元素样式的重力应为 1 和左上角根据您的需要，文本大小较小（继续查看您的 xml 并相应地调整它）。也为文本颜色使用颜色：# 十六进制代码，你可以在互联网上看到你想要的答案的十六进制代码

# c# - 在没有 System.Drawing 的情况下设置字体样式

> ID：12265362
> 
> 赞同：0
> 
> 时间：2012-09-04T14:13:27.387
> 
> 标签：c#, silverlight, system.drawing

我面临一个尴尬的问题。我无法设置文本的 FontStyle。这让我很烦，因为直到现在我无法理解为什么`System. Drawing`丢失，为什么我不能导入她（至少我认为我不应该）。

上下文是我在一个 silverlight 应用程序中，设置动态树的字体颜色和样式。

我正在使用`System.Windows.Media.SolidColorBrush`前景，但我试图设置 FontStyle 没有成功。我尝试的所有谷歌都回答了简单的问题：'使用 System.Drawing'

我在这里缺少什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-04T14:26:10.143

您不应尝试创建新的 FontStyle 结构，而应使用 FontStyles:`FontStyles.Italic`或的静态属性`FontStyles.Normal`。

# ruby - 从不同位置运行 ruby 文件时加载错误

> ID：12265370
> 
> 赞同：1
> 
> 时间：2012-09-04T14:13:44.913
> 
> 标签：ruby

我有以下问题：

我的 ruby​​ 项目结构：Ruby_Source\ file1.rb file2.rb file3.rb

在 file1.rb 中，需要 'file2' 需要 'file3'

现在，如果我从 Ruby_Source 运行 file1.rb，我不会收到任何错误。

但是，当我从不同的系统位置运行相同的程序时，例如（c :)

错误是加载错误。

有人能帮助我吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-04T14:44:02.010

您可能想使用[`require_relative`](http://extensions.rubyforge.org/rdoc/classes/Kernel.html)：

> require_relative 通过允许您加载与包含 require_relative 语句的文件相关的文件来补充内置方法 require。

见进一步讨论：

[Ruby 中的 require_relative 和 require 有什么区别？](https://stackoverflow.com/questions/3672586/what-is-require-relative-in-ruby)

如果你运行 Ruby 1.8：

[Ruby：require vs require_relative - 在 Ruby <1.9.2 和 >=1.9.2 中运行的解决方法的最佳实践](https://stackoverflow.com/questions/4333286/ruby-require-vs-require-relative-best-practice-to-workaround-running-in-both)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-04T14:43:40.297

尝试这个：

```
require_relative 'file2' 
```

在 Ruby 1.9.x 中。它将`file2`在目录中搜索`file1`。

在旧版本中，您可能会尝试以下操作：

```
$: << File.dirname($0) 
```

这会将当前程序的路径添加到`require`-search 路径。

# wordpress - 如何将完整帖子更改为内部博客页面 WordPress 上的摘录

> ID：12265371
> 
> 赞同：0
> 
> 时间：2012-09-04T14:13:47.217
> 
> 标签：wordpress

在 WordPress 中，我有一个名为“博客”的内部页面，在设置->阅读中，我将该页面指定为博客文章的页面。我希望该页面是摘录而不是完整的帖子。在主题 page.php 用于博客页面的（页面）循环，但这被博客帖子分配到该页面所覆盖，我不能简单地将 page.php 中的“the_content”更改为“the_excerpt”使这项工作。

我需要一些条件标记代码才能在 page.php 中发生这种情况（或者这甚至可以工作吗？），还是有另一种方法来实现这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-04T14:26:28.057

Wordpress 模板层次结构图将帮助您 - [Wordpress Hierarchy](http://codex.wordpress.org/Template_Hierarchy#Visual_Overview)

您的`page.php`模板显示一个单独的页面，它不会生成您要编辑的博客存档页面。取决于你的主题，要么是`category.php`，`archive.php`要么`index.php`。

只需更改相关文件即可更改博客页面上的摘录。

# android - 如何在 Android 上使用画布保存视频文件？

> ID：12265374
> 
> 赞同：1
> 
> 时间：2012-09-04T14:13:54.507
> 
> 标签：android, android-layout

目前，我正在研究热、单声道等视频效果。为此，我正在使用带有画布内容的预览回调。

谁能告诉我如何保存这个视频？

下面我有我的回调代码：

```
mCamera.setPreviewCallback(new PreviewCallback() {
                public void onPreviewFrame(byte[] data1, Camera _camera) 
                {
                    Camera.Parameters parameters = _camera.getParameters();
                    parameters.setColorEffect(Camera.Parameters.EFFECT_NONE);
                    previewSize = parameters.getPreviewSize();
                    int frameSize = previewSize.width * previewSize.height;
                    int height = previewSize.height;
                    int width = previewSize.width;
                    int pixel;  
                    int A, R, G, B;
                    final double GS_RED = 0.299;
                    final double GS_GREEN = 0.587;
                    final double GS_BLUE = 0.114;
                    int[] rgba = new int[frameSize+1];

                    data = data1;

                         for (int i = 0; i < height; i++) 
                             for(int j = 0; j < width; j++) 
                             { 
                                 int y = (0xff & ((int) data[i * previewSize.width + j])); 
                                 int u = (0xff & ((int) data[frameSize + (i >> 1) * previewSize.width + (j & ~1) + 0])); 
                                 int v = (0xff & ((int) data[frameSize + (i >> 1) * previewSize.width + (j & ~1) + 1])); 

                                 y = y < 16 ? 16 : y;

                                 int r = Math.round(1.164f * (y - 16) + 1.596f * (v - 128)); 
                                 int g = Math.round(1.164f * (y - 16) - 0.813f * (v - 128) - 0.391f * (u - 128)); 
                                 int b = Math.round(1.164f * (y - 16) + 2.018f * (u - 128));

                                 r = r < 0 ? 0 : (r > 255 ? 255 : r); 
                                 g = g < 0 ? 0 : (g > 255 ? 255 : g); 
                                 b = b < 0 ? 0 : (b > 255 ? 255 : b);

                                rgba[i * previewSize.width + j] = 0xff000000 + (b << 16) + (g<< 8) + r;
                         }

                      Bitmap bmp = Bitmap.createBitmap(width, height,
                      Bitmap.Config.RGB_565);
                      bmp.setPixels(rgba, 0 , width , 0, 0, width, height);

                    // scan through every single pixel
                        for(int x = 0; x < width; ++x) {
                            for(int y = 0; y < height; ++y) {
                                // get one pixel color
                                pixel = bmp.getPixel(x, y);
                                // retrieve color of all channels
                                A = Color.alpha(pixel);
                                R = Color.red(pixel);
                                G = Color.green(pixel);
                                B = Color.blue(pixel);
                                // take conversion up to one single value
                                R = G = B = (int)(GS_RED * R + GS_GREEN * G + GS_BLUE * B);
                                // set new pixel color to output bitmap
                                bmp.setPixel(x, y, Color.argb(A, R, G, B));
                            }
                        }

                      canvas = mHolder.lockCanvas(); 
                      if (canvas != null) 
                      {
                          canvas.drawBitmap(bmp, (canvas.getWidth() - width) / 4, (canvas.getHeight() - height) / 4, null);
                          mHolder.unlockCanvasAndPost(canvas); 
                      } 
                      bmp.recycle();
                }
            }); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-17T11:38:24.590

您可以保存每个帧，然后可以将它们与 ffmpeg 合并以进行编码，以创建视频文件。

# php - PhoneGap API Curl 从命令行到 php

> ID：12265375
> 
> 赞同：1
> 
> 时间：2012-09-04T14:14:05.453
> 
> 标签：php, cordova, curl, command-line

我想使用[https://build.phonegap.com/docs/api上的 API 构建 phonegap 应用程序](https://build.phonegap.com/docs/api)

它需要运行以下 curl 命令，该命令将返回一个令牌。

```
$ curl -u andrew.lunny@nitobi.com -X POST "" https://build.phonegap.com/token 
```

这个 curl 语句在命令行上为我工作。我想在 php 中使用它。我尝试了下面给出的 php 代码，但它不起作用。

```
$username = "USERNAME@gmail.com";
$password = "PASSWORD";
$target_url = "https://build.phonegap.com/token"

$ch = curl_init();
curl_setopt($ch, CURLOPT_URL, $target_url);
curl_setopt($ch, CURLOPT_RETURNTRANSFER, TRUE);
curl_setopt($ch, CURLOPT_FOLLOWLOCATION, TRUE);
curl_setopt($ch, CURLOPT_POST, TRUE);
curl_setopt($ch, CURLOPT_POSTFIELDS, '');
curl_setopt($ch, CURLOPT_HTTPHEADER, array('Content-Type: application/x-www-form-urlencoded'));
curl_setopt($ch, CURLOPT_HTTPAUTH, CURLAUTH_ANY);
curl_setopt($ch, CURLOPT_USERPWD, "$username:$password");

$result = curl_exec($ch);
curl_close ($ch);
echo $result; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-26T14:31:24.580

你也可以试试这个`shell_exec()`功能：

```
$cmd = "curl -u andrew.lunny@nitobi.com -X POST "" https://build.phonegap.com/token";
$out = shell_exec($cmd);
$data = json_decode($out); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-04T22:20:28.613

我找到了解决方案。

我的本地主机设置有一些问题。当我在网络服务器上上传代码时，它开始工作。

# xslt - XSLT 计算，其中对孙子进行分组

> ID：12265382
> 
> 赞同：1
> 
> 时间：2012-09-04T14:14:32.723
> 
> 标签：xslt, xslt-grouping, muenchian-grouping

我有一个来自我想使用 xslt 呈现的数据库的 XML 数据转储。对于我想要的布局，数据的结构不是“直截了当”的（我也将 XML 数据用于另一个报告）。

我想要的是对来自 A 级的数据进行一些计算，我需要对 C 级儿童进行分组。

我知道我可能可以再次将数据选择到一个 XML 文件中，该文件的结构对于我的报告来说是“简单的”，但这是我最后的手段，因为我觉得它也可以在 XSLT 本身中完成。很可能我需要一些“Muenchian”技巧来完成它，但由于我是一个“Muenchian Virgin”，所以我每次尝试都会陷入困境（我试图“偷窃”并改变......）。

有人知道 Muenchian 是否是前进的道路，有人可以帮助我走上正确的道路吗？我做了一些阅读（包括 Jeni Tennison 的），但据我所知，到目前为止我所看到的内容并没有涵盖我的问题......

下面是一个简化的 XML 结构，它（或多或少）代表了我的实际问题。

有任何想法吗？

亲切的问候，亨克

# 简化的 XML：

```
<data>
  <a>
    <a_id>A1</a_id>
    <a_desc>A one</a_desc>
    <a_val>1</a_val>
    <b>
      <c>
        <c_id>C2</c_id>
        <c_desc>C two</c_desc>
      </c>
    </b>
  </a>
  <a>
    <a_id>A2</a_id>
    <a_desc>A two</a_desc>
    <a_val>2</a_val>
    <b>
      <c>
        <c_id>C2</c_id>
        <c_desc>C two</c_desc>
      </c>
    </b>
  </a>
  <a>
    <a_id>A3</a_id>
    <a_desc>A three</a_desc>
    <a_val>3</a_val>
    <b>
      <c>
        <c_id>C1</c_id>
        <c_desc>C one</c_desc>
      </c>
    </b>
  </a>
  <a>
    <a_id>A4</a_id>
    <a_desc>A four</a_desc>
    <a_val>7</a_val>
    <b>
      <c>
        <c_id>C3</c_id>
        <c_desc>C three</c_desc>
      </c>
    </b>
  </a>
  <a>
    <a_id>A5</a_id>
    <a_desc>A five</a_desc>
    <a_val>11</a_val>
    <b>
      <c>
        <c_id>C1</c_id>
        <c_desc>C one</c_desc>
      </c>
    </b>
  </a>
</data> 
```

# 所需的输出应该是这样的：

```
C_desc  Count() Sum(a_val)  Avg(a_val) 
------  ------- ----------  ----------
C one       3       15          5
C two       1       2           2
C three     1       7           7 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-04T14:52:58.930

正如您所提到的，Muenchian 分组是要走的路（在 XSLT1.0 中）。您说要使用**c**元素中的值对元素**进行**分组。因此，您将像这样定义一个键：

 **```
<xsl:key name="a" match="a" use="b/c/c_desc" /> 
```

然后，您需要获得“不同”**的**元素，这是通过为给定键选择恰好是组中第一个元素的元素来**完成的。**你用这个相当可怕的表情来做这件事

```
<xsl:apply-templates 
     select="//a[generate-id() = generate-id(key('a', b/c/c_desc)[1])]" /> 
```

在这里，`key('a', b/c/c_desc)[1]`将找到键所在组中的第一个元素，然后您使用它`generate-id`来比较这些元素。

然后，您将拥有一个模板来匹配不同**的 a**元素，然后您可以在其中对组进行计算。例如，要获得总和：

```
<xsl:value-of select="sum(key('a', b/c/c_desc)/a_val)" /> 
```

这是完整的 XSLT

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform" xmlns:exsl="urn:schemas-microsoft-com:xslt" exclude-result-prefixes="exsl">
   <xsl:output method="html" indent="yes"/>
   <xsl:key name="a" match="a" use="b/c/c_desc" />
   <xsl:template match="/">
      <table>
         <tr>
            <td>C_desc</td>
            <td>Count</td>
            <td>Sum</td>
            <td>Avg</td>
         </tr>
      <xsl:apply-templates select="//a[generate-id() = generate-id(key('a', b/c/c_desc)[1])]" />
      </table>
   </xsl:template>

   <xsl:template match="a">
      <xsl:variable name="c_desc" select="b/c/c_desc" />
      <tr>
         <td><xsl:value-of select="count(key('a', $c_desc))" /></td>
         <td><xsl:value-of select="sum(key('a', $c_desc)/a_val)" /></td>
         <td><xsl:value-of select="sum(key('a', $c_desc)/a_val) div count(key('a', $c_desc))" /></td>
      </tr>
   </xsl:template>
</xsl:stylesheet> 
```

应用于您的示例 XML 时，将输出以下内容

```
<table>
   <tr>
      <td>C_desc</td>
      <td>Count</td>
      <td>Sum</td>
      <td>Avg</td>
   </tr>
   <tr>
      <td>3</td>
      <td>15</td>
      <td>5</td>
   </tr>
   <tr>
      <td>1</td>
      <td>2</td>
      <td>2</td>
   </tr>
   <tr>
      <td>1</td>
      <td>7</td>
      <td>7</td>
   </tr>
</table> 
```**

# php - 使用php仅将txt文件中的某些行加载到mysql表中

> ID：12265383
> 
> 赞同：0
> 
> 时间：2012-09-04T14:14:31.917
> 
> 标签：php, mysql

我有一个记录一些信息的 .txt 文件。我想将它加载到 MySQL 表，但我有以下问题： .txt 日志文件不统一，这意味着它看起来像这样：

```
04092012 16:07:34.988 stuff1 stuff2 username1 importantStuff
04092012 16:08:12.145 stuff1 stuff2 stuff3 username2 stuff4 importantStuff 
```

重要的是，所有用户名都以相同的字符开头，就像这里一样。我知道我应该使用类似的东西：

```
$lines=file(log.txt);

foreach($lines as $v) {
  $values = explode(' ',$v);
  ... 
```

但我不知道如何仅将日期、时间、用户名和重要信息传输到 MySQL 表中。

我很感激我能得到的任何帮助。提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-04T14:17:34.333

```
$file = file_get_contents('log.txt');
$lines = explode("\n", $file);
foreach($lines as $v) {
   $values = explode(' ',$v);
   $all = count($values);
   $user = preg_match_all('/(user\w+\b)/', $v, $matches); // it will match all usernames that start with "user"
   $time = $values[1];
   $username = $matches[0][0];
   $stuff = $values[($all-1)];
   $date = $values[0];

   $query = "INSERT INTO `MyTable` ('".$date."', '".$time."', '".$username."', '".$stuff."')";
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-04T14:23:02.750

如果您确定东西部分不包含与用户名部分相同的模式，您可以使用如下内容：

```
$lines=file(log.txt);

foreach($lines as $v) {
    $values = explode(' ',$v);
    $date = "";
    $time = "";
    $important = "";
    $username = "";
    foreach($values as $cnt => $val){
        if($cnt == 0){
            $date = $val;
        } else if($cnt == 1){
            $time = $val;
        } else if(substr($val, 0, 8) == 'username'){
            $username = $val;
        }
        $important = $val;
   }
   $query = "INSERT INTO logtable VALUES ('$date', $time', '$username', '$important')";
} 
```

# javascript - 从 FullCalender 中删除/删除条目

> ID：12265390
> 
> 赞同：0
> 
> 时间：2012-09-04T14:15:09.177
> 
> 标签：javascript, jquery, fullcalendar

关于[http://arshaw.com/js/fullcalendar-1.5.3/demos/external-dragging.html](http://arshaw.com/js/fullcalendar-1.5.3/demos/external-dragging.html)上的演示的问题：当我将事件拖到某个日期时，如何再次从该日期删除它？例如，如果用户犯了错误。谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-04T14:16:10.170

使用`.fullCalendar( 'removeEvent', id )`

来源：[http ://arshaw.com/fullcalendar/docs/removed/removeEvent/](http://arshaw.com/fullcalendar/docs/removed/removeEvent/)

例如获取事件 ID 并遵循文档..

# sql - 如何在 SQLAlchemy 中使用 query.filter 和 .filter_by？

> ID：12265392
> 
> 赞同：1
> 
> 时间：2012-09-04T14:15:16.320
> 
> 标签：sql, django, sqlalchemy

使用 Django，可以使用带有关键字参数的过滤器方法来查找模型，如下所示：

```
MyModel.objects.filter(serialNo_gt=10) 
```

给出序列号大于 10 的所有型号。

是否可以在 sql-alchemy 中使用类似的查询语言？我知道可以编写类似的东西`MyModel.seriealNO < 10`，但是使用此构造的代码需要导入`MyModel`，我想在外部创建关键字/查询参数而不导入`MyModel`（对于外观模式）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-08T01:20:20.613

SQLAlchemy 的查询中没有内置的概念`"<attributename>_<operatorname>=<value>"`，但是效果很容易重现。这是 Flask 的作者完成的一个快速示例：[https ://github.com/mitsuhiko/sqlalchemy-django-query/blob/master/sqlalchemy_django_query.py](https://github.com/mitsuhiko/sqlalchemy-django-query/blob/master/sqlalchemy_django_query.py)

# parsing - FB.XFBML.parse 不重新解析 FB 小部件

> ID：12265393
> 
> 赞同：1
> 
> 时间：2012-09-04T14:15:18.303
> 
> 标签：parsing, facebook-like, xfbml

我有一个函数回调，`auth.login`并想重新解析我的`fb:like`元素。在回调期间执行其他操作`auth.login`，它们执行得很好，但`.parse`没有！我尝试`FB.XFBML.parse();`在控制台中执行它并显示`undefined`，然后在三秒钟后显示一条控制台消息`2 XFBML tags failed to render in 30000ms.`

有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-05T02:21:28.353

对于碰巧遇到这个问题的任何人，我遇到了同样的问题......

基本上我想做的是在用户登录我的网站后，我想刷新“喜欢”按钮 iFrame 以反映这一点。`FB.XFBML.parse();`只会导致错误......所以我想“也许我会刷新 iFrame？” 因为我使用 jQuery 作为我的框架 - 我想我会坚持下去。

所以，这就是我最终做的事情：

```
FB.Event.subscribe('auth.login', function(response) {
    if(response.status == 'connected') {
        $("#login_fb").hide(); // was already doing this part
        $('#like_fb > span > iframe').attr('src', function(i,val) { return val; }); // this is what I wanted to refresh
        //FB.XFBML.parse(); -- THIS WAS GENERATING AN ERROR
    }
}); 
```

希望这对其他人有帮助！

# python - 在 PyQt 中呈现 PDF 时 CPU 出现峰值，然后冻结

> ID：12265399
> 
> 赞同：1
> 
> 时间：2012-09-04T14:15:28.453
> 
> 标签：python, mysql, pdf, pyqt

有一次，我的应用程序查询 MySQL 数据库，并使用以下代码获取 300 行：

```
cur.execute('''
    select 
        ime, brPredmeta, statusStr, sudskiBr, sudija,
        datumRasprave,statusPredmeta, zaduzen,datumZaduzenja
    from predmeti
    order by ime
    ''')
for row in cur: #extract data from variables
    ime, brPredmeta, statusStr, sudskiBr, sudija, datumRasprave, statusPredmeta, zaduzen, datumZaduzenja = row 
```

`print(row)`几乎立即在控制台窗口中显示元组。数据提取后，我使用简单的 HTML 创建了 3 个部分的 PDF 页面；页眉、正文和页脚。所有 3 个都是具有 8-10 列的简单表。然而，正文有 300 行，因为我像这样附加它们：

```
#we are still in FOR LOOP that iterates rows in cursor
body = ('<html><head><title></title>'
    '<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>'
    '<style></style>'
    '</head>'
    '<body>'
    '<table align ="center" border="0" width="100%" style="table-layout:fixed">'
    '<tr height="10%">'
    '<td align="left" width="20">'+str(brojac)+'.</td>'
    '<td align="left" width="180">'+ime+'</td>'
    '<td align="left" width="100">'+str(brPredmeta)+'</td>'
    '<td align="left" width="80">'+statusStr+'</td>'
    '<td align="left" width="80">'+str(sudskiBr)+'</td>'
    '<td align="left" width="140">'+sudija+'</td>'
    '<td align="left" width="150">'+zaduzen+'</td>'
    '<td align="left">'+datumZaduzenja+'</td>'
    '<td align="right"> '+statusPredmeta+' </td>'
    '</tr>')

  self.ui.printHTML.append(body) 
```

这个完全相同的代码在 SQLite 上运行顺利。由于我今天切换到 MySQL，它只是冻结了我的整个程序。CPU 达到 100%（4 核 i3）并且 RAM 使用量超过 100MB（从启动时的 24MB）。一分钟后，我终止了该过程。

当我将此函数与其他参数（查询略有不同）一起使用时，这些参数会产生更少的行（从 60 到 120），一切都很顺利。

**如果我跳过“打印预览”对话框，直接打印 PDF，一切正常，没有冻结，什么都没有。**

我将添加您可能需要的任何其他信息。感谢您的阅读。

# asp.net - ASP.NET MVC 多个自定义 AuthorizeAttribute

> ID：12265402
> 
> 赞同：2
> 
> 时间：2012-09-04T14:15:37.977
> 
> 标签：asp.net, asp.net-mvc, asp.net-mvc-3, asp.net-membership

我正在使用 ASP.NET MVC 4 开发一个 Web 应用程序，并创建了几个自定义 MembershipProvider 和 RoleProvider，如下所示：

```
# Custom MembershipProviders
<membership defaultProvider="myMembershipProvider">
  <providers>
    <clear />
    <add name="myMembershipProvider" type="WebApp1.Business.Auth.MyMembershipProvider" />
    <add name="adminMembershipProvider" type="WebApp1.Business.Auth.AdminMembershipProvider" />
  </providers>
</membership>

# Custom RoleProviders
<roleManager enabled="true" defaultProvider="MyRoleProvider">
  <providers>
    <clear />
    <add name="MyRoleProvider" type="WebApp1.Business.Auth.MyRoleProvider" />
    <add name="AdminRoleProvider" type="WebApp1.Business.Auth.AdminRoleProvider" />
  </providers>
</roleManager> 
```

我的意图是创建一个名为 Logon 的自定义 AuthorizeAttribute，它将使用“myMembershipProvider”和“MyRoleProvider”；并创建另一个名为 AdminLogon 的将使用“adminMembershipProvider”和“AdminRoleProvider”。

我创建两个自定义 AuthorizeAttributes 的原因是因为我想分离一些获得每个角色权限的方法。

问题是，如何在自定义 AuthorizeAttribute 中动态设置默认 MembershipProvider 和 RoleProviders。

例如：

```
// Set the default MembershipProvider as adminMembershipProvider
// Set the default RoleProvidersas as AdminRoleProvider
[AdminLogon(Roles = "Administrador")]
public ActionResult Funcionarios()
{
    return View();
}

// Set the default MembershipProvider as myMembershipProvider
// Set the default RoleProvidersas as MyRoleProvider
[Logon(Roles = "Administrador")]
public ActionResult Funcionarios()
{
    return View();
} 
```

# google-chrome - 将消息从 background.js 传递到 popup.js

> ID：12265403
> 
> 赞同：30
> 
> 时间：2012-09-04T14:15:42.780
> 
> 标签：google-chrome, google-chrome-extension, messaging, message-passing

我正在尝试实现我自己的 chrome 扩展，在某个事件上，创建浏览器通知并使用在 background.js 中计算的数据填充弹出窗口

这是我的`manifest.json`文件：

```
{
    "name": "Dummy name",
    "description": "Description",
    "manifest_version": 2,
    "version": "1.1.3",
    "icons": {
        "16": "icon_16.png",
        "48": "icon_48.png",
        "128": "icon_128.png",
        "256": "icon_256.png"
    },
    "browser_action": {
        "default_icon": "icon_48.png",
        "default_title": "Test",
        "default_popup": "popup.html"
    },
    "permissions": ["background","webRequest","webRequestBlocking","webNavigation","tabs","notifications"],
    "background": {
        "scripts":["jquery-1.8.1.min.js","classy.js","background.js"]
    }
} 
```

我的`sendMessage`呼唤`background.js`

```
show : function(result) {
    var that = this;
    chrome.extension.sendMessage({greeting: "hello"}, function(response) {
        console.log(response);
    });

    if(window.webkitNotifications) {
        var notification = webkitNotifications.createHTMLNotification('notification.html');
        notification.show();
        setTimeout(function(){
            notification.cancel();
            }, '7000');
        }
    } 
```

我的消息监听器`popup.js`（来自 chrome 扩展示例）

```
chrome.extension.onMessage.addListener(
  function(request, sender, sendResponse) {
    console.log(sender.tab ?
                "from a content script:" + sender.tab.url :
                "from the extension");
    if (request.greeting == "hello")
      sendResponse({farewell: "goodbye"});
  }); 
```

我得到的唯一错误是

> 端口错误：无法建立连接。接收端不存在。

谢谢您的帮助！

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2017-04-19T03:25:33.363

弹出窗口没有标签 ID，因此您会收到错误消息。

在这种情况下，您可以使用`chrome.runtime.sendMessage`and `chrome.runtime.onMessage.addListener`。

所以在**background.js**

```
chrome.runtime.sendMessage({
    msg: "something_completed", 
    data: {
        subject: "Loading",
        content: "Just completed!"
    }
}); 
```

在**popup.js中**

```
chrome.runtime.onMessage.addListener(
    function(request, sender, sendResponse) {
        if (request.msg === "something_completed") {
            //  To do something
            console.log(request.data.subject)
            console.log(request.data.content)
        }
    }
); 
```

我希望它对你有帮助。

谢谢，

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2016-08-22T08:44:14.830

要解决这个问题，您需要首先向 background.js 发送握手消息，然后将实际数据从 background.js 发送到 popup.js 例如：在我的情况下，我所做的是

popup.js

```
chrome.runtime.sendMessage({data:"Handshake"},function(response){

			});
chrome.runtime.onMessage.addListener(function(message,sender,sendResponse){
	str = JSON.stringify(message.data);
});
```

背景.js

```
chrome.runtime.onMessage.addListener(function(message,sender,sendResponse){
//alert(message.data);
	chrome.runtime.sendMessage({data:datax},function(response){
			});
			});
```

我想要做的是，只要我们点击图标，握手消息就会发送到 background.js，当它收到它时，我们可以发送变量或我们想要发送到 popup.js 的任何数据来渲染它在 popup.html 上。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2020-11-07T21:00:38.170

这是我发现将数据从 background.js 发送到 popup.js 的两种最简单的方法：

***1）使用存储***

将值保存到存储中，一旦打开弹出窗口，它会从存储中获取值并将它们显示在弹出窗口中。

**背景.js**

```
chrome.storage.sync.set({ 'dataValue1': 'Some data 1.' });
chrome.storage.sync.set({ 'dataValue2': 'Some data 2.' }); 
```

**popup.js**

```
function updatePopup() {
    chrome.storage.sync.get(['dataValue1', 'dataValue2'], function (data) {
        document.getElementById("popupElement1").innerText = data.dataValue1;
        document.getElementById("popupElement2").innerText = data.dataValue2;
    });
}    
document.addEventListener('DOMContentLoaded', updatePopup); 
```

**popup.html**

```
<html>    
<head>
    <script src="popup.js"></script>
</head>    
<body>
    <p id="popupElement1"></p>
    <p id="popupElement2"></p>
</body>    
</html> 
```

**清单.json**

```
{
    "name": "Background2popup",
    "version": "1.0",
    "manifest_version": 2,
    "description": "This is a demo",
    "browser_action": {
        "default_popup": "popup.html"
    },
    "background": {
        "scripts": [
            "background.js"
        ]
    },
    "permissions": [
        "<all_urls>",
        "storage",
        "tabs"
    ]
} 
```

***2) 使用 chrome.runtime.sendMessage()***

弹出窗口打开后，您会从弹出窗口向后台发送一条消息以建立连接/握手（否则，如果您尝试发送消息，您将收到“未检查的 runtime.lastError：无法建立连接。接收端不存在。”从背景到弹出窗口和弹出窗口未打开）。建立连接后，您首先使用后台的 sendResponse 将要发送的数据发送到弹出窗口。

**背景.js**

```
chrome.runtime.onMessage.addListener(function (request, sender, sendResponse) {
    if (request.method == "getStatus") {
        console.log(request.data)
        sendResponse({ method: "peepee", data: "poopoo" })
    }
}); 
```

**popup.js**

```
chrome.runtime.sendMessage({ method: "getStatus", data: "xxx" }, function (res) {
    document.getElementById("popupElement1").innerText = res.method;
    document.getElementById("popupElement2").innerText = res.data;
return true;
}); 
```

**popup.html & manifest.json**和第一个例子一样

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-01-26T15:09:40.487

用于`runtime.sendMessage`将消息发送到后台脚本，以及`tabs.sendMessage`从后台到内容脚本。

请注意，您需要指定标签 ID：

```
chrome.tabs.query({ active: true }, (tabs) => {
    chrome.tabs.sendMessage(tabs[0].id, { greeting: 'hello' }, (response) => {
        console.log(response);
    });
}); 
```

您可以在此处找到完整的示例和文档：[https ://developer.chrome.com/extensions/messaging#simple](https://developer.chrome.com/extensions/messaging#simple)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-06-22T07:53:50.443

## 本地存储解决方案

因为弹出窗口没有持久状态，您可能希望使用 localStorage 来存储弹出窗口状态并在弹出窗口打开时预加载它，并在弹出窗口打开时`storage`跟踪状态更改。

背景：

```
localStorage.setItem('popupData', JSON.stringify({ tabReady: true })); 
```

弹出：

```
// Load the state from localStorage when popup opens
let popupData = JSON.parse(localStorage.getItem('popupData'));

// Keep track of changes to the popup state while the popup is open
window.addEventListener('storage', (e) => {
  if (e.key === 'popupData') {
    popupData = JSON.parse(e.newValue);
    console.log(popupData.tabReady);
  } 
}); 
```

# amazon-s3 - 使用 s3cmd 递归设置元数据

> ID：12265406
> 
> 赞同：0
> 
> 时间：2012-09-04T14:15:54.953
> 
> 标签：amazon-s3, amazon-web-services, s3cmd

我正在编写一个 shell 脚本来将 html 文件的网站树同步到 s3。

我想将任何文件的元数据设置为不带 text/html 扩展名的文件。是否可以递归使用 s3cmd -m ？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-04T14:20:52.487

-m 修饰符在将文件夹同步到存储桶时递归工作：

```
s3cmd sync -m text/html folder/ s3://bucket 
```

# cordova - Phonegap和移动商务

> ID：12265407
> 
> 赞同：1
> 
> 时间：2012-09-04T14:15:56.893
> 
> 标签：cordova

phonegap 应用程序如何处理交易？一切都包含在应用程序中吗？如果有，它如何进行信用卡交易？我假设您需要一个有效的网络连接来进行付款，或者当用户点击“结帐”时，它是否会在用户网站上加载页面？我必须为我的老板在 jquerymobile 应用程序中实现一个 ecommere 元素，但不知道从哪里开始。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-04T14:41:25.737

phonegap 应用程序只是一个特殊*的网站*，它由嵌入式 Web 浏览器（webview & co）呈现以充当应用程序。

从常规使用（又名在 PC 上）您可以将其视为：电子商务系统是网站，而您的手机应用程序是浏览器。

如果您将信用卡数据输入应用程序，它将简单地连接到电子商务并提交信息。电子商务将执行销售交易并返回结果。无论如何，它必须是这样。

# sql - 如何判断 VARCHAR 变量是否包含子字符串？

> ID：12265411
> 
> 赞同：68
> 
> 时间：2012-09-04T14:16:14.360
> 
> 标签：sql, string, contains, sql-server-2012

我以为是`CONTAINS`，但这对我不起作用。

我正在寻找这样做：

```
IF CONTAINS(@stringVar, 'thisstring')
   ... 
```

我必须运行一个`select`或另一个，具体取决于该变量是否包含字符串，我不知道如何让它工作。我看到的所有示例都使用包含中的列。

提前致谢。

* * *

## 回答 #1

> 赞同：93
> 
> 时间：2012-09-04T14:17:17.080

标准的 SQL 方法是使用如下：

```
where @stringVar like '%thisstring%' 
```

那是在查询语句中。您也可以在 TSQL 中执行此操作：

```
if @stringVar like '%thisstring%' 
```

* * *

## 回答 #2

> 赞同：29
> 
> 时间：2012-09-04T14:29:52.413

而不是`LIKE`（正如其他评论者所建议的那样），您可以选择使用`CHARINDEX`：

```
declare @full varchar(100) = 'abcdefg'
declare @find varchar(100) = 'cde'
if (charindex(@find, @full) > 0)
    print 'exists' 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2012-09-04T14:18:58.287

`CONTAINS`用于全文索引字段 - 如果不是，则使用`LIKE`

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2015-12-16T10:34:23.970

```
 IF CHARINDEX('TextToSearch',@TextWhereISearch, 0) > 0 => TEXT EXISTS

    IF PATINDEX('TextToSearch', @TextWhereISearch) > 0 => TEXT EXISTS

    Additionally we can also use LIKE but I usually don't use LIKE. 
```

# report - 查看 Cognos 7 中的现有过滤器（即兴）

> ID：12265414
> 
> 赞同：1
> 
> 时间：2012-09-04T14:16:19.350
> 
> 标签：report, cognos

我正在通过从头开始重新创建一些 Cognos 7 Impromptu 报告来将它们转换为 Cognos 8。

我不确定的一件事是过滤器；当我查看 Cognos 8 过滤器时，我可以清楚地看到现有过滤器的位置。但是查看 Cognos 7 中的 Query -> Filter 选项卡，我不知道在哪里可以找到现有的过滤器。我可以看到如何创建它们，但看不到它们：

![在此处输入图像描述](../Images/c319322182d40826d0b130226db9b2a6.png)

我在哪里可以检查 Cognos 7 中的现有过滤器及其定义？我不需要添加/更改它们，我只需要查看哪些存在（并且能够判断什么时候不存在）并查看它们的相应定义。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-07T16:19:56.873

看起来就是这个框，Cognos 7 中的所有过滤器似乎总是在同一个文本框中。多个条件必须链接在一个文本字段中。

![Cognos 7 过滤器](../Images/b16f1f9f3602002c9e335eea58876e88.png)

我很困惑，因为 Cognos 8 将过滤器拆分为可以具有多个条件的“事物”：

![Cognos 8 过滤器](../Images/685f7786c6817e4736ae7262faa11b66.png)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-01-02T15:46:19.060

您可能还想检查 Impromptu 中的摘要过滤器 - 将过滤器类型下拉列表更改为“摘要”。

# iphone - 适用于 iPhone 的 OpenCV

> ID：12265415
> 
> 赞同：0
> 
> 时间：2012-09-04T14:16:23.377
> 
> 标签：iphone, opencv

> **可能重复：**
> [iPhone 上的人脸识别](https://stackoverflow.com/questions/10272129/face-recognition-on-the-iphone)

我正在为我的 iphone 应用程序使用 OpenCV。我想知道如何检测图像中的人脸，然后我想将其与其他人脸进行比较以了解照片中的人如何？OpenCV可以吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-04T14:19:20.580

可能是的......但它只能在某些角度工作，并且无论如何都需要你的部分进行大量编码......

此外，iPhone 可能会运行得非常、非常、非常慢！（我的意思是，尝试将 1 个人与 100 张照片的数据库匹配可能已经需要几个小时了）

# javascript - 使用 javascript 更新部分视图 mvc3

> ID：12265417
> 
> 赞同：1
> 
> 时间：2012-09-04T14:16:31.587
> 
> 标签：javascript, asp.net-mvc-3

我有用于更新部分视图的 javascript 函数。现在我需要更新取一个值的局部视图，但我做不到:(

这是我的有效功能：

```
function clearData() {
    var urlclear = '@Url.Action("Clear", "Cart")';
    $.ajax({
        cache: false,
        type: 'POST',
        url: urlclear,
        success: function (data) {
            $('#AjaxUpdate').html(data);
        }
    });
} 
```

如果我说：

```
function clearData(id) {
    var urlclear = '@Url.Action("Clear", "Cart", new {ID = id})';
    $.ajax({
        cache: false,
        type: 'POST',
        url: urlclear,
        success: function (data) {
            $('#AjaxUpdate').html(data);
        }
    });
} 
```

它告诉我 id 未定义。

有人可以告诉我我做错了什么。

提前谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-04T14:39:44.443

代替

```
var urlclear = '@Url.Action("Clear", "Cart", new {ID = id})'; 
```

和

```
var urlclear = "@Url.Action("Clear", "Cart")/"+id; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-04T14:47:37.290

```
var urlclear = '@Url.Action("Clear", "Cart")' + "?ID=" + id; 
```

或者

```
var urlclear = '@Url.Action("Clear", "Cart")' + "/" + id; 
```

# c# - 回文 - 错误

> ID：12265419
> 
> 赞同：2
> 
> 时间：2012-09-04T14:16:36.970
> 
> 标签：c#, palindrome

我对 C# 很陌生，我正在制作一个小应用程序来检查控制台的输入是否是回文。我一个人走了很远，但我遇到了一个错误。

代码：

```
class Program
{
    static void Main(string[] args)
    {
        string str;
        Console.WriteLine("Voer uw woord in:");
        str = Console.ReadLine();

        if (isPalindroom(str) == true)
        {
            Console.WriteLine(str + " is een palindroom");
        }
        else
        {
            Console.WriteLine(str + " is geen palindroom");
        }

    }

    bool isPalindroom(String str)
    {
        string reversedString = "";
        for (int i = str.Length - 1; i >= 0; i--)
        {
            reversedString += str[i];
        }
        if (reversedString == str)
        {
            return true;
        }
        else
        {
            return false;
        }
    }
} 
```

我收到此错误：

> 错误 1 ​​非静态字段、方法或属性“ConsoleApplication2.Program.isPalindroom(string)”需要对象引用 *snap* 17 17 ConsoleApplication2

位于：

```
if (isPalindroom(str) == true) 
```

如果你能帮助我一点，我会很高兴:)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-04T14:18:48.947

只需将`static`修饰符添加到您的`isPalindroom`方法中。

如果不这样做，`isPalindroom`将是一个“实例”方法，可以在`Program`实例上调用。

简单来说，由于您没有 Program 类型的变量（主方法本身是静态的），因此您不能调用非静态方法。

可以在类型本身（`Program.isPalydroom(xxx)`或从类中的任何其他方法）调用静态方法。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-04T14:18:07.743

使函数静态：

```
static bool isPalindrome(String str)
{
} 
```

该`Main()`方法是静态的（根据要求），因此它只能调用静态成员。

而且因为你`bool isPalindrome()`是一个“纯”函数，即它只需要来自其参数的数据，它可以是静态的。

小挑剔：总是使用 PascalCasing 作为方法名称，IsPalindrome

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-04T14:18:36.650

“isPalindrome”的声明需要修改为“static bool isPalindrome(String str)”，或者你需要把它作为一个类实例的方法放入你可以在Main中实例化并从那里调用。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-04T14:18:50.050

主要是静态的..你的功能

```
 bool isPalindroom(String str) 
```

应该

```
static  bool isPalindroom(String str) 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-09-04T14:19:36.307

做了;

```
static bool isPalindroom(String str)
{
 ....
} 
```

Main 例程是静态的，因此您不在程序类的实例中并且不能调用实例方法。将 isPalindroom 设为静态例程将解决此问题。

有关静态方法和类的更多信息，请参阅；

[http://msdn.microsoft.com/en-us/library/79b3xss3(v=vs.80).aspx](http://msdn.microsoft.com/en-us/library/79b3xss3(v=vs.80).aspx)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-09-04T14:18:14.770

改变 `bool isPalindroom(String str)`

至`static bool isPalindroom(String str)`

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-09-04T14:26:42.373

正如其他人已经提到的，您应该将`isPalindroom()`方法设为静态。

这里有一个关于你反转字符串的方式的快速说明：

C# 中的字符串是不可变的，这意味着每次将新字符串（或字符）连接到现有字符串时，都会生成一个全新的对象。因此，为了使反向例程更有效，您可能需要使用`StringBuilder`and `StringBuilder.Append()`。

除此之外，而不是：

```
string reversedString = "";
for (int i = str.Length - 1; i >= 0; i--)
{
    reversedString += str[i];
} 
```

你可以简单地输入：

```
string reversedString = new string(str.Reverse().ToArray()) 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2014-12-11T12:35:56.307

给你，一个更好的文化/大小写/规范化不敏感版本

```
using System.Globalization;

bool IsPalindrome(string value, StringComparer comparer = null)
{
    if (s == null)
    {
        throw new ArgumentNullException("value");
    }

    if (comparer == null)
    {
        comparer = StringComparer.CurrentCultureIgnoreCase;
    }

    var elements = new List<string>();
    var m = StringInfo.GetTextElementEnumerator(value);
    while (m.MoveNext())
    {
        elements.Add(m.GetTextElement());
    }

    var i = 0;
    var j = elements.Count - 1;
    var limit = elements.Count / 2;
    for(; i <= limit; i++, j--)
    {
        if (!comparer.Equals(elements[i], elements[j]))
        {
            return false;
        }
    }

    return true;
} 
```

# ruby - 如何用密码保护我的 /sidekiq 路由（即需要对 Sidekiq::Web 工具进行身份验证）？

> ID：12265421
> 
> 赞同：60
> 
> 时间：2012-09-04T14:16:46.963
> 
> 标签：ruby, ruby-on-rails-3, redis, rescue, sidekiq

我在我的 rails 应用程序中使用 sidekiq。默认情况下，任何人都可以通过在 URL 后附加“/sidekiq”来访问 Sidekiq。我只想对 sidekiq 部分进行密码保护/身份验证。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：116
> 
> 时间：2012-11-16T02:15:16.997

将以下内容放入您的 sidekiq 初始化程序

```
require 'sidekiq'
require 'sidekiq/web'

Sidekiq::Web.use(Rack::Auth::Basic) do |user, password|
  # Protect against timing attacks:
  # - See https://codahale.com/a-lesson-in-timing-attacks/
  # - See https://thisdata.com/blog/timing-attacks-against-string-comparison/
  # - Use & (do not use &&) so that it doesn't short circuit.
  # - Use digests to stop length information leaking
  Rack::Utils.secure_compare(::Digest::SHA256.hexdigest(user), ::Digest::SHA256.hexdigest(ENV["SIDEKIQ_USER"])) &
  Rack::Utils.secure_compare(::Digest::SHA256.hexdigest(password), ::Digest::SHA256.hexdigest(ENV["SIDEKIQ_PASSWORD"]))
end 
```

在路由文件中：

```
mount Sidekiq::Web => '/sidekiq' 
```

* * *

## 回答 #2

> 赞同：29
> 
> 时间：2017-10-23T14:19:18.163

很抱歉迟到了，但[Sidekiq 的 wiki](https://github.com/mperham/sidekiq/wiki/Monitoring)为 Devise 推荐以下内容：

允许任何经过身份验证的`User`：

```
# config/routes.rb
authenticate :user do
  mount Sidekiq::Web => '/sidekiq'
end 
```

限制访问`User.admin?`

```
# config/routes.rb
authenticate :user, lambda { |u| u.admin? } do
  mount Sidekiq::Web => '/sidekiq'
end 
```

[此 wiki 帖子](https://github.com/mperham/sidekiq/wiki/Monitoring)还有许多其他安全方案。

这是使用 Rails 5.1.3、Devise 4.3 和 Sidekiq 5.0 测试的

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2012-09-04T15:30:45.510

[请参阅https://github.com/mperham/sidekiq/wiki/Monitoring](https://github.com/mperham/sidekiq/wiki/Monitoring)下的“安全性”

> Sidekiq::Web 使用[Rack::Protection](https://github.com/sinatra/rack-protection)来保护您的应用程序免受典型的 Web 攻击（例如[CSRF](https://en.wikipedia.org/wiki/Cross-site_request_forgery)、[XSS](https://en.wikipedia.org/wiki/Cross-site_scripting)等）。`Forbidden`如果发现您的请求不满足安全要求，Rack::Protection 将使您的会话无效并引发错误。一种可能的情况是让您的应用程序在反向代理后面工作，并且没有将重要的标头传递给它（`X-Forwarded-For`，`X-Forwarded-Proto`）。这种情况和解决方案可以[在这篇文章](http://www.sourcediver.org/blog/2015/07/01/rack-protection-and-nginx/)和[问题#2560](https://github.com/mperham/sidekiq/issues/2560)中找到......

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2015-02-17T21:36:30.593

如果您使用的是 Devise（或其他基于 Warden 的身份验证），则可以这样做，假设您的应用程序中有一个 AdminUser 模型。

```
# config/routes.rb
# This defines the authentication constraint
constraint = lambda do |request|
               request.env['warden'].authenticate!({ scope: :admin_user })
             end

# This mounts the route using the constraint.
# You could use any other path to make it less obvious
constraints constraint do
  mount Sidekiq::Web => '/sidekiq'
end 
```

* * *

## 回答 #5

> 赞同：11
> 
> 时间：2016-09-14T18:08:07.367

如果您正在滚动自己的自定义身份验证，则可以使用[此处](https://github.com/mperham/sidekiq/wiki/Monitoring#restful-authentication-or-sorcery)文档中引用的以下示例。

```
# lib/admin_constraint.rb
class AdminConstraint
  def matches?(request)
    return false unless request.session[:user_id]
    user = User.find request.session[:user_id]
    user && user.admin?
  end
end

# config/routes.rb
require 'sidekiq/web'
require 'admin_constraint'
mount Sidekiq::Web => '/sidekiq', :constraints => AdminConstraint.new 
```

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2019-01-25T17:53:51.667

公认的答案很好，但我认为它可以更安全地实施，正如[Sidekiq 文档所提到](https://github.com/mperham/sidekiq/wiki/Monitoring#rails-http-basic-auth-from-routes) 的（在我发布后它被编辑以展示正确的解决方案）。

要保护您的应用免受计时攻击，请使用`ActiveSupport::SecurityUtils.secure_compare`.

*   见[https://codahale.com/a-lesson-in-timing-attacks/](https://codahale.com/a-lesson-in-timing-attacks/)
*   见[https://thisdata.com/blog/timing-attacks-against-string-comparison/](https://thisdata.com/blog/timing-attacks-against-string-comparison/)

另外，使用`&`（不要使用`&&`）以免短路。

最后，使用摘要来阻止长度信息泄漏（`secure_compare`Active Support 5 中的默认值）。

因此，在初始化文件中，通常在`config/initializers/sidekiq.rb`Rails 项目中，根据您的 Active Support/Rails 版本，编写以下内容。

**Active Support 5+**：感谢[Rails PR #24510](https://github.com/rails/rails/pull/24510) ，默认情况下传递给`secure_compare`的参数。`Digest::SHA256.hexdigest`

```
require 'active_support/security_utils'
require 'sidekiq'
require 'sidekiq/web'

Sidekiq::Web.use(Rack::Auth::Basic) do |user, password|
  # Protect against timing attacks:
  # - See https://codahale.com/a-lesson-in-timing-attacks/
  # - See https://thisdata.com/blog/timing-attacks-against-string-comparison/
  # - Use & (do not use &&) so that it doesn't short circuit.
  # - Use digests to stop length information leaking
  ActiveSupport::SecurityUtils.secure_compare(user, ENV["SIDEKIQ_ADMIN_USER"]) &
    ActiveSupport::SecurityUtils.secure_compare(password, ENV["SIDEKIQ_ADMIN_PASSWORD"])
end 
```

**主动支持 4**：

```
require 'active_support/security_utils'
require 'sidekiq'
require 'sidekiq/web'

Sidekiq::Web.use(Rack::Auth::Basic) do |user, password|
  # Protect against timing attacks:
  # - See https://codahale.com/a-lesson-in-timing-attacks/
  # - See https://thisdata.com/blog/timing-attacks-against-string-comparison/
  # - Use & (do not use &&) so that it doesn't short circuit.
  # - Use digests to stop length information leaking
  ActiveSupport::SecurityUtils.secure_compare(
    ::Digest::SHA256.hexdigest(user),
    ::Digest::SHA256.hexdigest(ENV["SIDEKIQ_ADMIN_USER"])
  ) &
    ActiveSupport::SecurityUtils.secure_compare(
      ::Digest::SHA256.hexdigest(password),
      ::Digest::SHA256.hexdigest(ENV["SIDEKIQ_ADMIN_PASSWORD"])
    )
end 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2015-05-07T15:28:35.180

如果您使用[Sorcery](https://github.com/NoamB/sorcery)进行身份验证，以下是[如何使用 Rails 路由约束](https://github.com/NoamB/sorcery/wiki/Routes-Constraints)来保护某些路由。

* * *

从巫术维基复制这里冗余：

本教程展示了如何将 Rails 路由约束与 Sorcery gem 一起使用。感谢[@anthonator](https://github.com/anthonator)编写它！

首先，定义`UserConstraint`将用于所有约束的模块：

```
module RouteConstraints::UserConstraint
  def current_user(request)
    User.find_by_id(request.session[:user_id])
  end
end 
```

然后，定义了该模块，您可以指定特定的约束类。在这些示例中，第一个路由仅在没有用户登录的情况下有效，第二个路由仅适用于作为管理员的登录用户：

```
class RouteConstraints::NoUserRequiredConstraint
  include RouteConstraints::UserConstraint

  def matches?(request)
    !current_user(request).present?
  end
end

class RouteConstraints::AdminRequiredConstraint
  include RouteConstraints::UserConstraint

  def matches?(request)
    user = current_user(request)
    user.present? && user.is_admin?
  end
end 
```

最后，您可以将约束添加到`config/routes.rb`：

```
MyApp::Application.routes.draw do

  # other routes …

  root :to => 'admin#dashboard', :constraints => RouteConstraints::AdminRequiredConstraint.new
  root :to => 'home#welcome', :constraints => RouteConstraints::NoUserRequiredConstraint.new

end 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2015-04-07T17:19:48.803

另一种选择是添加 CanCan 之类的内容和基于角色的特殊访问权限。

# php - 如何使用 PHP 或 MySql 生成有特殊要求的发票编号

> ID：12265423
> 
> 赞同：-2
> 
> 时间：2012-09-04T14:16:52.540
> 
> 标签：php, mysql

如何生成发票编号，如下所示：

```
Invoice Number = MC1200001 

MC : Company name
12 : current year (Flexibel)
00001 : auto increment (Flexibel - auto increment and will reset to 00001 again if year is 2013) 
```

预期结果 ：

```
current year 2012 :

MC1200001
MC1200002
MC1200003
.....

year 2013

MC1300001
MC1300002
MC1300003
..... 
```

需要您对此问题的想法或解决方案。

谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-04T14:38:06.913

您可以使用三列来表示数字的不同部分，并使用视图或简单的 CONCAT 表达式来获取每张发票的整个数字。

然后要获得一个新数字，您将使用一个返回实际行 ID 或连接数字的函数插入一条记录。

我会做这样的事情：（为简洁起见，省略前导零）

```
DROP TABLE IF EXISTS invoces;

CREATE TABLE invoices (
   id INT NOT NULL UNIQUE AUTO_INCREMENT
  ,company CHAR(2)
  ,number INT
  ,fiscal_year INT
 , PRIMARY KEY (company, number, fiscal_year)
);

DROP PROCEDURE IF EXISTS spCreateInvoice;
DELIMITER $$

CREATE PROCEDURE spCreateInvoice
(
   pCompany CHAR(2)
  ,pFiscalYear INT
)
BEGIN
  INSERT INTO invoices (
    company, fiscal_year, number
  ) SELECT
        pCompany
      , pFiscalYear
      , 1+MAX(number) 
    FROM invoices 
    WHERE 
        fiscal_year=pFiscalYear;

  SET @id = LAST_INSERT_ID();

  SELECT CONCAT(i.company, i.number, i.fiscal_year) invoice_number, i.* from invoices i WHERE id = @id;
END;
$$
DELIMITER ;

CALL spCreateInvoice('MC', 12);
CALL spCreateInvoice('MC', 12);
CALL spCreateInvoice('MC', 12);
CALL spCreateInvoice('MC', 12);

CALL spCreateInvoice('MC', 13);
CALL spCreateInvoice('MC', 13);
CALL spCreateInvoice('MC', 13);
CALL spCreateInvoice('MC', 13); 
```

您可以将其作为脚本针对您的 mysql 测试数据库运行，并查看以下输出：

```
invoice_number  id  company number  fiscal_year
MC012           1   MC      0       12

invoice_number  id  company number  fiscal_year
MC112           2   MC      1       12

invoice_number  id  company number  fiscal_year
MC212           3   MC      2       12

invoice_number  id  company number  fiscal_year
MC312           4   MC      3       12

invoice_number  id  company number  fiscal_year
MC013           5   MC      0       13

invoice_number  id  company number  fiscal_year
MC113           6   MC      1       13

invoice_number  id  company number  fiscal_year
MC213           7   MC      2       13

invoice_number  id  company number  fiscal_year
MC313           8   MC          3   13 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-04T14:21:31.167

```
<?php
// after save to database 
$invoiceCode = 'My Company Logo'.date("y").mysql_insert_id() ;
?> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-01-01T10:50:42.763

试试这个..

$compcode = "MC";
$result = $compcode.date('y').str_pad($runningnumber, 5, "0", STR_PAD_LEFT);

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2012-09-05T04:57:22.053

是的，下面是我的最终解决方案及其工作：

```
<?php
@mysql_connect('localhost','root','') or die('Database error!');
echo "mysql_connect : Connected!</br>";   // if connected show 'Connected!'
echo '</br>';
mysql_select_db("invoice") or die('could not select');

$result4 = mysql_query("SELECT * FROM `order` ORDER BY id desc") or die('could not select');   //Select last transaction
$row4 = mysql_fetch_array($result4);

$invoice4 = $row4['invoice_number'];
$inc_number = $row4['inc_number'];
$year = $row4['year'];

//Setting Invoice Format
$brand = 'GB';
$cur_date = date('y');  // date('y')
$invoice = $brand.$cur_date.'00001';
$customer_id = rand(5487 , 9854);

if($cur_date == $year) {   //if current year equal to last year in transaction 

    if($invoice4 == $invoice && $inc_number == '1') {
        //IF EXIST 

        //add inc_number 
        $inc_number_add = $inc_number + 1; // Increment by 1

        //invoice_number
        $inc = str_pad($inc_number_add, 5, '0', STR_PAD_LEFT); //Format with leading 0 eg: 00001
        $invoice_number_db = $brand.$cur_date.$inc;

        //create new order
        mysql_query("INSERT INTO `order` (customer_id,invoice_number,inc_number,year) VALUES ($customer_id, '$invoice_number_db' ,$inc_number_add,$cur_date)") 
        or die('Cannot Insert into database!');
        echo "<br/>Insert Success!</br>";

    }
    else {
        //IF NOT EXIST 
            mysql_query("INSERT INTO `order` (customer_id,year) VALUES ($customer_id,$cur_date)") or die('Cannot Insert into database!');
            echo "Insert customer_id Success!";

            echo '</br>';

            // Retrieve data again after create
            $result = mysql_query("SELECT * FROM `order` WHERE customer_id='$customer_id'") or die('could not select');
            $row = mysql_fetch_array($result);

            //var
            $id_val = $row['id'];
            $inc_number_add = $inc_number + 1;  // Increment by 1
            $inc = str_pad($inc_number_add, 5, '0', STR_PAD_LEFT); //Format with leading 0 eg: 00001
            $invoice = $brand.$cur_date.$inc;

            //Update invoice
            mysql_query("UPDATE `order` SET invoice_number='$invoice' , inc_number='$inc_number_add' WHERE customer_id=$customer_id") or die('error 89');
            echo "</br>UPDATE invoice_number Success!</br>";
    }

}
    else {

        //IF TODAY IS NEW YEAR RESET INVOICE NUMBER
        mysql_query("INSERT INTO `order` (customer_id,invoice_number,inc_number,year) VALUES ($customer_id, '$invoice' , '1' ,$cur_date)") 
        or die('Cannot Insert into database!');
        echo "<br/>Insert customer_id Success!</br>";

    }

        echo "<br/><br/>FINAL OUTPUT <br/>";
        $result_3 = mysql_query("SELECT * FROM `order` WHERE customer_id='$customer_id' ") or die('could not select');
            $row_3 = mysql_fetch_array($result_3);

            $id3 = $row_3['id'];
            $customer_id3 = $row_3['customer_id'];
            $inc_number = $row_3['inc_number'];
            $invoice3 = $row_3['invoice_number'];

            echo 'id '.$id3.' - ';
            echo 'customer_id '.$customer_id3.' - ';
            echo 'inc_number '.$inc_number.' - ';
            echo 'invoice '.$invoice3\. '<br/>';

?> 
```

# asp.net - 文本框没有显示所有文本？

> ID：12265440
> 
> 赞同：0
> 
> 时间：2012-09-04T14:17:45.017
> 
> 标签：asp.net, css, textbox, telerik, radtextbox

我有一个telerik RadTextBox，我想在其中显示一行，问题是内容有点滚动并且不显示所有文本，我该如何解决。提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-06T05:35:47.723

尝试使用 textmode="singleline"

```
<telerik:RadTextBox runat="server" ID="txtbox1" TextMode="SingleLine"></telerik:RadTextBox> 
```

# php - Farbtastic 坏了，不会更新我的输入字段

> ID：12265446
> 
> 赞同：0
> 
> 时间：2012-09-04T14:18:08.053
> 
> 标签：php, jquery, wordpress

所以，我有一个 foreach 循环创建一堆表单字段，以允许用户使用 farbtastic 为字体等选择颜色。该循环为大约 60 个字段创建字段，而颜色选择工作，无论出于何种原因，在 20 个字段之后 farbtastic 停止使用十六进制代码更新输入字段。它会更改输入字段的背景颜色，但不会更新字段。

更奇怪的是，所有这些字段都在单独的选项卡中，而 wordpress 处理选项卡的方式是将每个选项卡放在一个新页面上。所以页面必须重新加载。因此，一旦您进入后面的选项卡（以及后面的字段），其中两个字段之一将正常工作，但大多数都不能正常工作。就像，一个选项卡上的字段 2 可以正常工作，但不同选项卡上的相同字段不能。

现在我有一个控制颜色选择器的 jQuery 方法：

```
// Color Picker for js file
jQuery('.pickcolor').click( function(e) {
      colorPicker = jQuery(this).next('div');
      input = jQuery(this).prev('input');
      jQuery(colorPicker).farbtastic(input);
      colorPicker.show();
      e.preventDefault();
      jQuery(document).mousedown( function() {
          jQuery(colorPicker).hide();
      });
}); 
```

表单字段几乎都像这样：$name 是部分名称，$element 是选择颜色的形式（嵌套的 foreach 循环）

```
<div class="color_option option" style="position: relative;">
    <label for="<?php echo $name; ?>_fonts"><?php echo $elementName;?> Color</label>

    <input class="link_color" type="text" id="<?php echo $name; ?>_fonts" 
name="kjd_<?php echo $name;?>_settings[kjd_<?php echo $name; ?>_fonts][<?php echo $element; ?>]" 
value="<?php echo $options['kjd_'.$name.'_fonts'][$element] ? $options['kjd_'.$name.'_fonts'][$element] : ''; ?>"

style="background:<?php echo $options['kjd_'.$name.'_fonts'][$element]?>; color:<?php echo $options['kjd_'.$name.'_fonts'][$element]?>;"   
/>

    <input type='button' class='pickcolor button-secondary' value='Select Color'>
    <div style="position: absolute;" class="colorpicker"></div> 
```

所以 jQuery 看起来不错，但我想知道是否应该在 foreach 循环中动态创建 jquery 以按 ID 定位每个字段

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-05T13:16:36.347

我解决了它。

```
value="<?php echo $options['kjd_'.$name.'_fonts'][$element] ? $options['kjd_'.$name.'_fonts'][$element] : ''; ?> 
```

该 if 语句的最后一部分不能为空，它必须是 ' '（空格），相反，为了让 farbtastic 更新输入，其中必须有一些值。所以我用'none'来避免混淆用户。

我的代码现在说

```
value="<?php echo $options['kjd_'.$name.'_fonts'][$element] ? $options['kjd_'.$name.'_fonts'][$element] : 'none'; ?> 
```

# jquery - 加载数据后，jQuery添加空格btw大写的不间断词

> ID：12265448
> 
> 赞同：0
> 
> 时间：2012-09-04T14:18:12.383
> 
> 标签：jquery

```
<script type="text/javascript">
var CountryVal;
var StateVal;
$(document).ready(function(){
    $('#ItemCountry').change(function(){
        CountryVal = this.value; // value of the select element
        $("#StateFeeder").html('<img src="/images/mapCountry/AU/ajax-loader.gif" class="IMG-Loading" />');
        $('#StateFeeder').load('/StateFeeder/StateFeeder-Buy.html #StateFeeder-'+CountryVal, function(){
            $('#ItemState').change(function(){
                StateVal = this.value; // value of the select element
                $("#CityFeeder").html('<img src="/images/mapCountry/AU/ajax-loader.gif" class="IMG-Loading" />');
                $('#CityFeeder').load('/Country/'+CountryVal+'/_'+CountryVal+'_suburbs.html #Suburbs-'+StateVal, function(){
                    $('#CityFeeder select').attr('size', '5');
                    $('#CityFeeder select').change(function(){  
                        this.form['CAT_Custom_221342'].value=$(this).val();
                    }); 
                });        
            })
        });
    });
});           
</script> 
```

上面的 Jquery 将从其他页面加载下拉菜单到当前页面，并在用户进行选择时将值传递到另一个输入字段。问题是，从远程页面中的#StateFeeder 获取的选项值包含以下格式：

```
<option value="Kabardino-BalkarRepublic">Kabardino-Balkar Republic</option>
<option value="Karachay-CherkessRepublic">Karachay-Cherkess Republic</option>
<option value="KareliaRepublic">Karelia Republic</option>
<option value="KomiRepublic">Komi Republic</option>
<option value="MariElRepublic">Mari El Republic</option>
<option value="MordoviaRepublic">Mordovia Republic</option> 
```

上面的值是不间断的大写单词，我希望它们在加载到当前页面时在大写单词之间使用空格进行格式化（请保留“-”btw单词），**特别关注#ItemState部分：当城市值被加载到#ItemState 菜单中，例如“KareliaRepublic” 值（没有空格“KareliaRepublic”）被视为 id，以便可以正确加载远程菜单，请格式化它直到此加载过程完成然后处理添加空间操作。**非常感谢你：

```
<option value="Kabardino-Balkar Republic">Kabardino-Balkar Republic</option>
<option value="Karachay-Cherkess Republic">Karachay-Cherkess Republic</option>
<option value="Karelia Republic">Karelia Republic</option>
<option value="Komi Republic">Komi Republic</option>
<option value="Mari El Republic">Mari El Republic</option>
<option value="Mordovia Republic">Mordovia Republic</option> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-04T14:24:50.330

这应该有效：

```
value = value.​​replace(/([^-])([A-Z])/g, "$1 $2"); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-04T14:24:56.587

使用正则表达式来操作值字符串：

```
var stateVal = this.value.replace(/([a-z])([A-Z])/g, '$1 $2'); 
```

[http://jsfiddle.net/mblase75/BgUFm/](http://jsfiddle.net/mblase75/BgUFm/)

[更多关于使用正则表达式`.replace()`](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/String/replace)

# wpf - Image.Source 使用代理

> ID：12265450
> 
> 赞同：2
> 
> 时间：2012-09-04T14:18:17.023
> 
> 标签：wpf, image, url, webproxy

例如，在我的 WPF 页面上，我有一个像这样的图像（一个或多个）：

```
<Image Source="{Binding Path=PicURL}"/> 
```

此外，我有一个*设置*页面，其中包含一个选项，可以在我的整个*应用程序*中全局**打开/关闭****Internet 代理设置**的使用。如果要谈论手动 Web 请求，我可以解决它，例如，像这样：

 *```
HttpWebRequest request = ( HttpWebRequest )WebRequest.Create( ... );
if( UseProxy ) request.Proxy.Credentials = CredentialCache.DefaultCredentials; 
               else req.Proxy = null; 
```

但它不适用于 WPF 控件（如*Image*），其中内容基于 URL 并使用**Internet 代理设置**。

有没有办法**在运行时***在整个应用程序内全局* 切换代理？

 *** * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-04T18:41:38.957

您也许可以修改`WebRequest.DefaultWebProxy`

*   [我应该如何设置默认代理以使用默认凭据？](https://stackoverflow.com/questions/299940/how-should-i-set-the-default-proxy-to-use-default-credentials)

*   [system.net 默认代理 c# .Net 4](https://stackoverflow.com/questions/3620232/system-net-default-proxy-c-sharp-net-4)

如果这些在您的情况下不起作用，那么解决方法是您可以使用带有/或不带有代理设置的 WebRequest 自己从 Web 下载“资源”。

您可以使用 Web 请求返回的数据作为流来初始化 BitmapImage，然后您可以将其设置到 Source 中，或者您可以保存到临时文件并使 Source 指向该本地文件。

*   [使用 http:\\ URL 的 WPF 图像 UriSource 和数据绑定](https://stackoverflow.com/questions/3148163/wpf-image-urisource-and-data-binding-using-http-url)

您将在 Binding 上编写并使用“转换器”，它可以将图像 Url 下载/转换为 BitmapImage，或者根据您的情况可能会使用 MarkupExtension。

您可能希望使用异步绑定，因为图像资源的下载可能需要一段时间，而且您不希望这会阻塞您的主 UI 线程。

*   [使用 WPF 在线程中加载图像](https://stackoverflow.com/questions/1738978/loading-image-in-thread-with-wpf)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-01-08T04:10:10.323

如果您希望代理设置为配置文件，请尝试此操作

```
<?xml version="1.0" encoding="utf-8" ?>
     <configuration>
          <system.net>
              <defaultProxy enabled="true" useDefaultCredentials="true">
                <proxy proxyaddress="http://proxyaddress:port" 
                       usesystemdefault="False" 
                       bypassonlocal="True" 
                       autoDetect="False" />
              </defaultProxy>
          </system.net>
</configuration> 
```

干杯***

# python - “请求宽恕而不是许可” - 解释

> ID：12265451
> 
> 赞同：86
> 
> 时间：2012-09-04T14:18:18.930
> 
> 标签：python

我不是在要求关于这种哲学的个人“宗教”观点，而是更多技术性的观点。

我知道这句话是几个试金石之一，看看你的代码是否是“pythonic”。但对我来说，pythonic 意味着干净、简单和直观，没有加载用于糟糕编码的异常处理程序。

所以，实际的例子。我定义了一个类：

```
class foo(object):
    bar = None

    def __init__(self):
        # a million lines of code
        self.bar = "Spike is my favorite vampire."
        # a million more lines of code 
```

现在，来自程序背景，在另一个功能中我想这样做：

```
if foo.bar:
    # do stuff 
```

如果我不耐烦并且*没有*执行初始的 foo = None，我会得到一个属性异常。所以，“请求宽恕而不是许可”建议我应该这样做吗？

```
try:
    if foo.bar:
        # do stuff
except:
    # this runs because my other code was sloppy? 
```

为什么我最好在 try 块中添加额外的逻辑，这样我就可以让我的类定义*更加模糊*？为什么不首先定义所有内容，然后明确*授予权限*？

（不要因为使用 try/except 块而责备我……我在任何地方都使用它们。我只是不认为使用它们来捕获我自己的错误是正确的，因为我不是一个彻底的程序员。）

或者……我完全误解了“请求原谅”的咒语吗？

* * *

## 回答 #1

> 赞同：82
> 
> 时间：2012-09-04T19:49:28.693

“请求宽恕，而不是许可”反对两种编程风格。“请求许可”是这样的：

```
if can_do_operation():
    perform_operation()
else:
    handle_error_case() 
```

“请求原谅”是这样的：

```
try:
    perform_operation()
except Unable_to_perform:
    handle_error_case() 
```

在这种情况下，预计尝试执行操作可能会失败，您必须以一种或另一种方式处理无法执行操作的情况。例如，如果操作正在访问文件，则该文件可能不存在。

请求宽恕的原因主要有两个：

*   在并发世界中（在多线程程序中，或者如果操作涉及程序外部的对象，例如文件、其他进程、网络资源等），情况可能会在运行`can_do_operation()`时间和运行时间之间发生变化。你跑`perform_operation()`。所以无论如何你都必须处理错误。
*   您需要使用完全正确的标准来请求许可。如果您弄错了，您将无法执行您可以执行的操作，或者因为您根本无法执行该操作而发生错误。例如，如果您在打开文件之前测试它是否存在，则可能该文件确实存在，但您无法打开它，因为您没有权限。相反，也许该文件是在您打开它时创建的（例如，因为它来自一个仅在您实际打开文件时才出现的网络连接，而不是当您只戳看它是否存在时）。

请求宽恕情况的共同点是您正在尝试执行一项操作，并且您知道该操作可能会失败。

当你写`foo.bar`的时候，不存在`bar`通常不会被认为是对象的失败`foo`。这通常是程序员的错误：试图以非设计的方式使用对象。Python 中程序员错误的后果是*未处理*的异常（如果幸运的话：当然，一些程序员错误无法自动检测到）。所以 if`bar`是对象的一个​​可选部分，处理这个问题的正常方法是有一个`bar`初始化为 的字段，`None`如果可选部分存在，则设置为其他值。要测试是否`bar`存在，请编写

```
if foo.bar is not None:
     handle_optional_part(foo.bar)
else:
     default_handling() 
```

当解释为布尔值时，您可以缩写`if foo.bar is not None:`为`if foo.bar:`only if will always be true — 如果可以是 0 、或任何其他具有错误真值的对象，则需要. 如果您正在测试可选部分（而不是在 and 之间进行测试），这也更清楚。`bar``bar``[]``{}``is not None``True``False`

此时你可能会问：为什么不省略初始化`bar`时它不存在，并用处理程序测试它的存在`hasattr`或捕获它`AttributeError`？因为您的代码仅在两种情况下才有意义：

*   该对象没有`bar`场；
*   该对象有一个`bar`字段，表示您认为它的含义。

因此在编写或决定使用该对象时，您需要确保它没有具有`bar`不同含义的字段。如果您需要使用一些没有`bar`字段的不同对象，那可能不是您需要适应的唯一事情，因此您可能希望创建一个派生类或将对象封装在另一个类中。

* * *

## 回答 #2

> 赞同：80
> 
> 时间：2012-09-04T14:40:16.803

经典的“请求宽恕而不是许可”示例是访问`dict`可能不存在的值。例如：

```
names = { 'joe': 'Joe Nathan', 'jo': 'Jo Mama', 'joy': 'Joy Full' }
name = 'hikaru'

try:
    print names[name]
except KeyError:
    print "Sorry, don't know this '{}' person".format(name) 
```

此处说明了可能发生的异常 ( `KeyError`)，因此您不会为可能发生的每个错误请求宽恕，而只是针对自然发生的错误请求宽恕。相比之下，“先请求许可”的方法可能如下所示：

```
if name in names:
    print names[name]
else:
    print "Sorry, don't know this '{}' person".format(name) 
```

或者

```
real_name = names.get(name, None)
if real_name:
    print real_name
else:
    print "Sorry, don't know this '{}' person".format(name) 
```

这种“请求原谅”的例子往往过于简单。IMO 不清楚`try`/`except`块本质上优于`if`/ `else`。当执行可能以各种方式失败的操作时，真正的价值要清晰得多——比如解析；使用`eval()`；访问操作系统、中间件、数据库或网络资源；或执行复杂的数学。当存在多种潜在的失败模式时，准备好获得宽恕是非常有价值的。

关于您的代码示例的其他说明：

您不需要在每个变量使用情况周围盛装`try`/阻塞。`except`那将是可怕的。而且你不需要设置`self.bar`你的，`__init__()`因为它是在你`class`上面的定义中设置的。通常在类中定义它（如果它的数据可能在类的所有实例之间共享）或在`__init__()`（如果它是实例数据，特定于每个实例）。

顺便说一句，的值`None`不是未定义的，也不是错误的。它是一个特定且合法的值，表示 none、nil、null 或无。许多语言都有这样的值，因此程序员不会“重载” `0`, `-1`, `''`（空字符串）或类似的有用值。

* * *

## 回答 #3

> 赞同：19
> 
> 时间：2017-07-26T03:33:28.963

这里有很多很好的答案，我只是想我会添加一个到目前为止我还没有提到的观点。

通常请求宽恕而不是许可可以提高性能。

*   当您请求许可时，您必须执行额外的操作以**每次**请求许可。
*   **当请求宽恕时，您只需要在某些时候**执行额外的操作，即当它失败时。

通常失败的情况很少见，这意味着如果你只是请求许可，那么你几乎不需要做任何额外的操作。是的，当它失败时，它会抛出异常，并执行额外的操作，但是 python 中的异常非常快。你可以在这里看到一些时间：[https ://jeffknupp.com/blog/2013/02/06/write-cleaner-python-use-exceptions/](https://jeffknupp.com/blog/2013/02/06/write-cleaner-python-use-exceptions/)

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2012-09-04T14:21:50.600

你是对的——目的`try`不是`except`为了掩盖你草率的编码。这只会导致更草率的编码。

异常处理应该用于处理*异常情况*（马虎编码不是异常情况）。但是，通常很容易预测可能会发生哪些异常情况。（例如，您的程序接受用户输入并使用它来访问字典，但用户的输入不是字典中的键......）

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2012-09-04T14:28:09.450

我个人的非宗教观点是，所说的口头禅主要适用于*记录在案*且*易于理解*的退出条件和边缘情况（例如 I/O 错误），并且永远不应该用作草率编程的越狱卡。

也就是说，`try/except`通常在存在“更好”的替代方案时使用。例如：

```
# Do this    
value = my_dict.get("key", None)

# instead of this
try:
  value = my_dict["key"]
except KeyError:
  value = None 
```

至于您的示例，`if hasattr(foo, "bar")`如果您无法控制`foo`并需要检查是否符合您的期望，请使用，否则只需使用`foo.bar`并让结果错误成为您识别和修复草率代码的指南。

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2018-01-05T02:19:21.050

虽然已经有许多高质量的答案，但主要是从风格的角度来讨论这个问题，与功能性的观点相对应。

在某些情况下，我们需要请求宽恕，而不是允许确保正确的代码（在多线程程序之外）。

一个典型的例子是，

```
if file_exists: 
    open_it() 
```

在此示例中，文件可能已在检查和尝试实际打开文件之间被删除。这可以通过使用来避免`try`：

```
try:
    open_it()
except FileNotFoundException:
    pass # file doesn't exist 
```

这出现在很多地方，通常与文件系统或外部 API 一起使用。

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2012-09-04T14:38:55.087

在 Python 上下文中，“请求宽恕而不是许可”意味着一种编程风格，在这种风格中，您不会事先检查事情是否符合您的预期，而是处理如果错误导致的错误。经典示例不是检查字典是否包含给定键，如下所示：

```
d = {}
k = "k"
if k in d.keys():
  print d[k]
else:
  print "key \"" + k + "\" missing" 
```

而是在缺少密钥时处理由此产生的错误：

```
d = {}
k = "k"
try:
  print d[k]
except KeyError:
  print "key \"" + k + "\" missing" 
```

但是，重点不是用/替换`if`代码中的every ；这会让你的代码更加混乱。相反，您应该只捕获真正可以对它们做些什么的错误。理想情况下，这将减少代码中的整体错误处理量，使其实际目的更加明显。`try``except`

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2012-09-04T14:22:14.883

请求宽恕而不是许可旨在简化代码。`.bar`当存在可能触发 AttributeError的合理预期时，它意味着要像这样编写代码。

```
 try:
     print foo.bar
 except AttributeError as e
     print "No Foo!" 
```

您的代码似乎要求许可和宽恕:)

问题是，如果您有理由预期某些事情会失败，请使用 try/catch。如果您不期望某些事情会失败，并且无论如何都会失败，那么抛出的异常就相当于其他语言中的失败断言。您会看到发生意外异常的位置并相应地调整您的代码/假设。

# image - 使用 Magmi 进行批量图像导入

> ID：12265452
> 
> 赞同：0
> 
> 时间：2012-09-04T14:18:19.357
> 
> 标签：image, magento, plugins, import, magmi

我的问题：您如何使用 Magmi 将批量图像导入 Magento？

我已经安装了它，还有“图像属性处理器”插件。怎么办？sourceforge 上的文档很薄，我似乎在谷歌上也找不到太多。'如何'将不胜感激，或者嘿，甚至是教程的链接。

谢谢你。干杯!

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-05T07:09:09.840

为了转换到 Magento，我开始使用 Magmi 以及导入产品数据和图像。半天后，我在图像方面停下来，因为我无法让它正常工作。

做了一些调查和谷歌搜索，并遇到了一个脚本来导入图像。不知道从哪里来，但是基地的创造者的道具！

看到你的问题，想起了我的挣扎，我想和你分享。希望它也能帮助你；）

该脚本使用 Magento-db 中的一个表，其中包含图像路径和 sku。它从路径中提取图像，将它们直接导入 Magento db。

在实际站点上触发之前，请小心并在测试环境中进行测试。彻底测试它以确保它不会弄乱您的 magento 数据库。您可能还想检查 image_attribute_id 是否正确，因为我注意到的每个 Magento 版本都不同。

希望能帮助到你：）

```
############################################################################
#
#  Change these variables to suit your store!
#
$_mediaBase = realpath('../media/catalog/product').'/';
$_imagesSrc = realpath('../media/import/_osc_media').'/';
// Image attribute_id's: image=79, small_image=80, thumbnail=81, gallery=82
$imgAttrIds = array(79,80,81,88);
$imageGalId = array(82);
require_once '../app/Mage.php';
#
############################################################################
#
#  Debug (true/false)
#
    $debug = false;
#
############################################################################

umask(0);
error_reporting(E_ALL);
ini_set('display_errors', '1');
Mage::setIsDeveloperMode(true);
Mage::app()->setCurrentStore(Mage_Core_Model_App::ADMIN_STORE_ID);
$conn = Mage::getSingleton('core/resource')->getConnection('core_read');
$connW = Mage::getSingleton('core/resource')->getConnection('core_write');
//$images = scandir($_imagesSrc);
/*
*    Relocate the images into Magento friendly format
*/
$imgArr = array();
$imgSkuArr[] = array();
$imgSrcArr[] = array();

$sql = "SELECT sku, image_path
          FROM aa_image_paths";
$images = $conn->fetchAll($sql);
/**
 * $images =
 * [8] =&gt; Array(
 *   [sku] =&gt; ST-P006
 *   [image_path] =&gt; 47/ST-P006/Carying bag Heli P005A.jpg
 * )
 */
#debug
if($debug == true){
    echo '<p>Images: <pre>';
    print_r($images);
    echo '</pre>';
}//end: debug

//iterator
$y = $z = 0;

foreach($images as $image)
{
    $pathChunks = explode('/', $image['image_path']);
    $imgFile = end($pathChunks);

    $firstDir = strtolower($_mediaBase . substr($imgFile,0,1));
    $secondDir = strtolower($firstDir.'/' . substr($imgFile,1,1));
    $imageEntityDir = strtolower('/' . substr($imgFile,0,1) . '/' . substr($imgFile,1,1) . '/' . $imgFile);

    #debug
    if($debug == true){
        echo '<p>imgFile: ' . $imgFile . '<br />imageEntityDir: ' . $imageEntityDir  . '</p>';
    }//end: debug

    /**
     * Get the product_entity details
     */
    $sql = "SELECT *
          FROM catalog_product_entity
          WHERE sku = '" . $image['sku'] . "'";
    $_products = $conn->fetchAll($sql);

    #debug
    if($debug == true){
        echo '<p>SQL: ' . $sql . '<br />';
        echo '_products:<br />';
        echo '<pre>';
        print_r($_products);
        echo '</pre></p>';

        echo (isset($_products)) ? '<h6>products isset() = true</h6>' : '<h6>products isset() = false</h6>';
        echo (!empty($_products))? '<h6>products empty() = false</h6>' : '<h6>products empty() = true</h6>';
    }//end:debug

    if(!empty($_products))
    {
        if(file_exists($_imagesSrc . $image['image_path'])){

            $path = strtolower($secondDir . '/' . $imgFile);
            if(!file_exists($path)) {
                echo "Making $secondDir and copying to $path";
                /**
                 * If NOT debug than do copy and mkdir stuff!
                 */
                if($debug == false)
                {
                    if (!file_exists($secondDir)){
                        mkdir($secondDir, 0777, true);
                    }
                    copy($_imagesSrc . $image['image_path'], $path);

                }//end: debug FALSE

            }//end:if(!file_exists($path)) {

            #debug
            if($debug == true){
                echo '<p>_imagesSrc + image_path: ' . $_imagesSrc . $image['image_path'] . '<br />';
                echo 'image[image_path]' . $image['image_path'] . '<br />';
                echo 'path: ' . $path . '<br />';
                echo 'image[sku]: ' . $image['sku'] . '<br />';
                echo 'imgEntDir: ' . $imageEntityDir . '<br />';
                echo '</p>';
            }//end: debug

            /**
             * Create the array for the product with the data.
             * @var $product
             */
            $productData = array();
            $productData['sku'] = $image['sku'];
            $productData['entity_id'] = $_products[0]['entity_id'];
            $productData['imgSrc'] = $imageEntityDir;

            #debug
            if($debug == true){
                echo 'productData: ' .             $productData . '<br />';
                echo 'productData[sku]: ' .        $productData['sku'] . '<br />';
                echo 'productData[entity_id]: ' .  $productData['entity_id'] . '<br />';
                echo 'productData[imgSrc]: ' .     $productData['imgSrc'] . '<br />';
                echo 'productData: <pre>';
                var_dump($productData);
                echo '</pre></p>';
            }//end:debug

            /**
             *    Check the existing images
             */
            // General Base, small and thumb images
            $sql = "SELECT *
                FROM catalog_product_entity_varchar
                WHERE entity_id = '" . $productData['entity_id'] . "'
                AND attribute_id IN (".implode(",",$imgAttrIds).")";
            $_imageAssoc = $conn->fetchAll($sql);

            $existingImgs = array();
            foreach($_imageAssoc as $img)
            {
                $existingImgs[$img['entity_id']][$img['attribute_id']] = $img;
            }

            // Gallery Images
            $sql = "SELECT *
                    FROM catalog_product_entity_media_gallery
                    WHERE entity_id = '" . $productData['entity_id'] . "'";
            $_galleryImgs = $conn->fetchAll($sql);

            $existingGall = array();
            foreach($_galleryImgs as $img)
            {
                $existingGall[$img['entity_id']][$img['attribute_id']] = $img;

                #debug
                if($debug == true){
                    echo '<p>img print_r: <br /><pre>';
                    print_r($img);
                    echo '</pre></p>';
                }//end:debug
            }

            #debug
            if($debug == true){
                # print existingImg
                echo '<p>existingImgs print_r: <br /><pre>';
                print_r($existingImgs);
                echo '</pre></p>';
                # print existingGal
                echo '<p>existingImgs print_r: <br /><pre>';
                print_r($existingImgs);
                echo '</pre></p>';
            }//end:debug

            /**
             *    Then associate to the product itself.
             */
            //$insertData = array();
            //$skusToInsert = array();
            foreach($_products as $productArrId=>$product) {
                $missingImgs = $imgAttrIds;

                //$imageName = strtolower('/'.$product['sku'][0].'/'.$product['sku'][1].'/'.$product['sku'].'.jpg');
                $imageName = $productData['imgSrc'];

                #debug
                if($debug == true){
                    echo '<p>Imagename print_r: <br /><pre>';
                    print_r($imageName);
                    echo '</pre></p>';
                }//end:debug

                // Check if it has an image associated already ...
                if ( array_key_exists( $productData['entity_id'], $existingImgs) ) {
                    // Check which images exists and remove those already set
                    foreach ($imgAttrIds as $id=>$val) {
                        if ( array_key_exists( $val , $existingImgs[$productData['entity_id']] ) ) {
                            //if ( $existingImgs[$productData['entity_id']][$val]['value'] == "no_selection" ) {
                                $sql = "DELETE FROM catalog_product_entity_varchar WHERE value_id = '".$existingImgs[$productData['entity_id']][$val]['value_id']."'";

                                #debug
                                if($debug == true)
                                {
                                    echo 'SQL base images: <pre>' . $sql . '</pre>';
                                }
                                else
                                {
                                    //Execute the Query
                                    $connW->query($sql);
                                }

                            //} else {
                                unset($missingImgs[$id]);
                            //}

                        }//end:f ( array_key_exists( $val

                    }//end: foreach ($imgAttrIds as $id=>$val) {

                }//end;if ( array_key_exists( $productData['entity_id'], $existingImgs) ) {

                // Check if it has Gallery images associated already ...
                if ( array_key_exists( $productData['entity_id'], $existingGall) ) {
                    // Check which images exists and remove those already set
                    foreach ($imageGalId as $id=>$val) {
                        if ( array_key_exists( $val , $existingGall[$productData['entity_id']] ) ) {
                            //if ( $existingImgs[$productData['entity_id']][$val]['value'] == "no_selection" ) {
                            $sql = "DELETE FROM catalog_product_entity_media_gallery_value WHERE value_id = '".$existingGall[$productData['entity_id']][$val]['value_id']."'";

                            #debug
                            if($debug == true)
                            {
                                echo 'SQL gallery Value: <pre>' . $sql . '</pre>';
                            }
                            else
                            {
                                //Execute the Query
                                $connW->query($sql);
                            }

                            $sql = "DELETE FROM catalog_product_entity_media_gallery WHERE value_id = '".$existingGall[$productData['entity_id']][$val]['value_id']."'";

                            #debug
                            if($debug == true)
                            {
                                echo 'SQL gallery: <pre>' . $sql . '</pre>';
                            }
                            else
                            {
                                //Execute the Query
                                $connW->query($sql);
                            }

                            //} else {
                            unset($missingImgs[$id]);
                            //}

                        }//end:f ( array_key_exists( $val

                    }//end: foreach ($imgAttrIds as $id=>$val) {

                }//end;if ( array_key_exists( $productData['entity_id'], $existingImgs) ) {

                foreach ($imgAttrIds as $id=>$val) {

                    //Update the Media gallery items in DB
                    $sql = "INSERT INTO catalog_product_entity_varchar (entity_type_id, attribute_id, store_id, entity_id, value) VALUES " .
                           "(4, " . $val . ", 0, " . $productData['entity_id'] . ", '" . $imageName . "')";

                    #debug
                    if($debug == true)
                    {
                        echo 'SQL Insert1: <pre>' . $sql . '</pre>';
                    }
                    else
                    {
                        //Execute the Query
                        $connW->query($sql);
                    }
                    $y++;
                }//end:foreach ($imgAttrIds as $id=>$val) {

                foreach ($imageGalId as $id=>$val) {
                    //Update the
                    $sql = "INSERT INTO catalog_product_entity_media_gallery (attribute_id, entity_id, value) VALUES " .
                           "(".$val.", ".$productData['entity_id'].", '".$imageName."')";
                        //implode(",",$skusToInsert) . ";";

                    #debug
                    if($debug == true)
                    {
                        echo 'SQL Insert1: <pre>' . $sql . '</pre>';
                    }
                    else
                    {
                        //Execute the Query
                        $connW->query($sql);
                    }

                    //Update the Gallery value
                    /*
                    $sql = "INSERT INTO catalog_product_entity_media_gallery_value (value_id, store_id, position, disabled) VALUES " .
                            "((SELECT value_id FROM catalog_product_entity_media_gallery
                                WHERE attribute_id = '".$imageGalId."'
                                AND entity_id = '".$productData['entity_id']."'
                                AND value = '".$imageName."'),0, 1, 0)";
                    */
                    $sql = "INSERT INTO catalog_product_entity_media_gallery_value (value_id, store_id, position, disabled) " .
                            "SELECT value_id, 0 store_id, 1 position, 0 disabled
                                FROM catalog_product_entity_media_gallery
                                WHERE attribute_id = '".$val."'
                                AND entity_id = '".$productData['entity_id']."'
                                AND value = '".$imageName."'";
                    #debug
                    if($debug == true)
                    {
                        echo 'SQL Insert1: <pre>' . $sql . '</pre>';
                    }
                    else
                    {
                        //Execute the Query
                        $connW->query($sql);
                    }
                    $z++;
                }//end:foreach ($imgAttrIds as $id=>$val) {

            }//end:foreach($_products as $productArrId=>$product) {

        }//end: if(file_exists($_imagesSrc . $image['image_path']))

    }//end: if(!empty($_products))

    #debug
    if($debug == true){
        echo '<hr>';
    }//end:debug

}//end:foreach($images as $image)

echo "<h5>Updated ". $y ." images for products. </h5>";
echo "<h5>Updated ". $z ." images in MediaGallery</h5>"; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-07-09T12:42:28.997

我遇到过同样的问题。它很脆。我意识到它已经创建了一个新`./magento`文件夹，并将图像转储在那里。我将它合并到我真正的 magento 文件夹中并运行重新索引来修复它。

然后我看到“通往 Magento 的路径”设置是`../../magento/`，将其更改为`../../../magento/`.

我的设置是这样的：

```
./magento/...files..
./magmi/...files... 
```

它已将图像转储到一个文件夹中，`./magmi/magento/media/`因为我`../`在告诉 magmi 到我的 Magento 文件夹的路径时丢失了一个。这不起作用，因为现在它说它无法在`./media/import`. 唯一可行的解​​决方案是在每次导入后手动将 magento 文件夹相互合并。真是一团糟。

`/image.jpg`仅供参考在我的电子表格中，我像前面的斜线一样放入了图像列。

# java - EWS Java API 1.1 和 https://podxxxxx.outlook.com/ews/Exchange.asmx 之间的随机连接错误

> ID：12265459
> 
> 赞同：2
> 
> 时间：2012-09-04T14:18:40.957
> 
> 标签：java, exchangewebservices, office365, ewsjavaapi

我正在使用主题中的连接设置发送电子邮件。我必须发送附件。代码有效，但我随机收到两个错误：

```
[java] INFO: Failure authenticating with BASIC ''@podxxxxx.outlook.com:443
[java] Error occured while sending the mail for: x@y.com
[java] microsoft.exchange.webservices.data.HttpErrorException: The remote server returned an error: (401)Unauthorized
[java] at microsoft.exchange.webservices.data.ServiceRequestBase.validateAndEmitRequest(Unknown Source) 
```

或更经常：

```
[java] microsoft.exchange.webservices.data.ServiceResponseException: An internal server error occurred. Try again later.
[java] microsoft.exchange.webservices.data.ServiceResponse.internalThrowIfNecessary(Unknown Source) 
```

有什么建议么？

# html - HTML 表格单元格宽度 - 标题全球化问题

> ID：12265461
> 
> 赞同：0
> 
> 时间：2012-09-04T14:18:45.497
> 
> 标签：html, html-table

我有下表：

```
<table>
    <tr>
        <td width="10%">Heading1</td>
        <td width="15%">Heading2</td>
        ....
        <td width="5%">Heading3</td>
    </tr>
    ....
</table> 
```

单元格的宽度由第一行单元格的宽度定义。到目前为止，一切都很好。

如果我将标题翻译成其他语言 - 单元格中的文本改变了它的长度，结果是看起来很糟糕的表格 - 一些单元格有很多空间，而对于其他单元格来说，没有足够的空间来显示其中的文本。

我应该怎么办？

我尝试了很多不同的变化 - 宽度 - 它们的自动/百分比/组合，但没有任何效果。

有没有人知道如何设置宽度以动态处理上下文？

我也考虑了一些 JavaScript 函数——我可以在构建 html 之前获取每个标题的文本，并根据它的长度来设置表格的宽度？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-04T14:27:14.467

所有行的列宽都相同，您无法更改此行为。您可以省略宽度参数，表格会自动调整。如果您不希望列太薄，可以尝试设置“最小宽度”css 属性。

# php - 使用 PDO 写入 SQLite 数据库

> ID：12265468
> 
> 赞同：1
> 
> 时间：2012-09-04T14:18:53.747
> 
> 标签：php, sqlite, pdo

我正在尝试在我的 Linux/Apache 服务器上使用 PHP 和 sqlite 实现一个简单的数据库。

我可以很容易地从中读取，但我无法执行任何 UPDATE、DELETE 或 INSERT 操作。我得到的致命错误是：

```
General error: 5 database is locked 
```

举个简单的例子：

```
$pdo=new PDO('sqlite:test.sqlite');
$pdo->exec("INSERT INTO menus(id,name,description) VALUES(6,'test','this is a test')"); 
```

这等待了很长时间（大约一分钟），然后报上面的错误。

我已经阅读了很多建议，其中许多建议数据库或其包含的文件夹应该是可写的。他们是。（或者是。我让它们在世界范围内可写以供测试，并在失败时恢复更合理的权限。）

使用其他技术（例如 Linux 中的 sqlite3 命令和 Firefox 中的 SQLite 管理器插件）写入数据库时​​我没有遇到任何问题。

我欢迎任何关于如何完成这项工作的评论。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-04T14:51:12.827

请尝试为数据库文件授予 777 权限，然后重试。我怀疑它与权限有关，因为您可以使用 sqlite3 程序修改数据库。

如果失败，请尝试查看此[问题](https://stackoverflow.com/questions/151026/how-do-i-unlock-a-sqlite-database)的答案。

# php - 同一文件夹中 PHP 脚本读取的 htaccess 保护文件夹中的文件

> ID：12265474
> 
> 赞同：1
> 
> 时间：2012-09-04T14:19:24.283
> 
> 标签：php, .htaccess, curl, directory, protected

我有一个受 .htaccess 保护的文件夹（摘要身份验证）。我需要使用 file_get_contents 读取位于该文件夹子文件夹中的一些脚本的输出。此阅读脚本位于受保护的文件夹根目录中。由于文件夹保护，它无法执行 file_get_contents 功能。有什么方法可以让某些 PHP 脚本通过一些 htaccess 设置在文件夹中运行，这样我就不必在脚本中创建一些基于 cURL 的登录会话了？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-04T14:44:09.863

您可以根据用户代理字符串创建重写规则。然后在您的 curl 请求中，您需要设置 htaccess 文件中允许的 usearagent 字符串。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-04T17:35:43.463

似乎最简单的方法是以与此处所述相同的方式使用 cURL [https://stackoverflow.com/a/5872712/965748](https://stackoverflow.com/a/5872712/965748) ，只需将 CURLOPT_HTTPAUTH 更改为 CURLAUTH_DIGEST 并可选择删除一些特定选项。

# c - 这段代码到底发生了什么？

> ID：12265477
> 
> 赞同：3
> 
> 时间：2012-09-04T14:19:35.670
> 
> 标签：c, function, recursion

我有一个包含递归函数的代码。我在递归上浪费了很多时间，但我仍然无法真正理解：

```
#include<stdio.h>
void count(int);

int main()
{
    int x=10,z;
    count(x);
}

void count(int m)
{
    if(m>0)
        count(m-1);
    printf("%d",m);
} 
```

当第一次`count`调用参数为 10 时，它满足条件，然后在这里开始递归部分。当函数调用自身时会发生什么？我不明白。请参考堆栈进行解释。

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2012-09-04T14:26:05.383

While`m`大于 0，我们称`count`. 这是堆栈调用的表示：

```
 count (m = 10)  
   count (m = 9)  
     count (m = 8)  
       count (m = 7)  
         count (m = 6)    
           count (m = 5)     
             count (m = 4)     
               count (m = 3)     
                 count (m = 2)     
                   count (m = 1)
                     count (m = 0)
                     printf 0
                   printf 1
                 printf 2
               printf 3
             printf 4
           printf 5
         printf 6
       printf 7
     printf 8
   printf 9
 printf 10 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-04T14:25:51.997

下次它调用自己时，它的值较小

```
count(int m)
{
 if(m>0)
 count(m-1); // now it is calling the method "count" again, except m is one less
 printf("%d",m);
} 
```

所以首先它会用 10 调用 count，然后它会用 9，然后 8，然后 7 ......一直调用它，直到这个 if 语句不正确：

```
if(m>0) 
```

可能让您感到困惑的是 if 语句仅适用于下一行（printf 不是 if 语句的一部分）

所以你有了：

```
count(int m)
    {
     if(m>0)
     {
         count(m-1); // now it is calling the method "count" again, except m is one less
     }
     printf("%d",m);
    } 
```

因此，一旦 m 不 > 0，递归调用将停止，然后它将调用 printf。

当 m 为 0 时调用 printf 后，它将从那个 'count' 调用返回，（返回到 m 等于 1 的位置），然后它会在 m 为 1 时调用 printf，然后当 m 为 2 时，……

所以输出应该是：

```
"0 1 2 3 4 5 6 7 8 9 10" 
```

编辑：就堆栈而言：

这就是堆栈正在做的事情：

```
count(10) // push count(10) 
```

->

```
count(9) // push count(9)
count (10) 
```

->

...

->

```
count(0) // push count(0)
count(1)
count(2)
count(3)
count(4)
count(5)
count(6)
count(7)
count(8)
count(9)
count(10) 
```

-> （然后它开始打印并将方法从堆栈中弹出）

```
// pop count(0), and printf(0)
count(1)
count(2)
count(3)
count(4)
count(5)
count(6)
count(7)
count(8)
count(9)
count(10) 
```

->

```
// pop count(1), and printf(1)
count(2)
count(3)
count(4)
count(5)
count(6)
count(7)
count(8)
count(9)
count(10) 
```

->

...

->

```
// pop count(9), and printf(9)
count(10) 
```

->

```
// pop count(10), and printf(10) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-04T14:31:56.563

当一个函数被调用时，返回地址（下一个要执行的代码）连同它的当前参数一起存储在堆栈中。一旦函数完成，地址和参数就会弹出，这样 CPU 就会知道在哪里继续执行代码。

让我们写下函数的地址（仅出于本示例的目的）

```
count(int m)
{
(address = 100)  if(m>0)
(address = 101)     count(m-1); // now it is calling the method "count" again, except m is one less
(address = 102)  printf("%d",m);
} 
```

对于 m = 1：

是全`if`域，所以我们在`address 101`with处执行代码`m = 1`。`address 102`并被推入堆栈，并从with`m = 1`再次执行该函数。因为我们在控制台上执行并打印 0。函数结束并弹出最后一个返回值和参数，并执行 at 行，在屏幕上打印 1。`address 100``m = 0``m = 0``address 102``address (102)``m = 1``address 102`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-04T14:32:00.670

1.  `count`使用整数参数调用该函数`10`。
2.  由于大于函数的函数参数调用自身，其整数参数`m`为负，等于。`10``0``count``m``10``1``9`
3.  步骤 2 使用不同的参数重复，`(m-1)`直到`m`不大于`0`并且程序在该点打印 的值`m`。

递归函数只是修改给它的参数并使用修改后的值调用自身，直到返回所需的结果（在这种情况下`m`不大于`0`）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-04T14:33:25.233

每个数字指的是行号。

```
#include<stdio.h>
count(int);
main()
{
1int x=10,z;
2count(x);
}  
count(int m)
{
3if(m>0)
4   count(m-1);
5printf("%d",m);
} 
```

执行是这样发生的（x=3）-

行号|x的值

1 3

2 3

3 3

4 2

3 2

4 1

3 1

4 0

5 0

5 1

5 2

5 3

屏幕上打印的数字 0 1 2 3

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-09-10T07:55:19.897

如果你想要一个更具体的答案，那么你必须研究编译器是如何工作的。但一般来说，编译器会为包含前导码的函数创建机器代码，在此代码中，在堆栈上分配了足够的内存（通过递减堆栈指针），可以将函数变量的副本放在堆栈上（我们可以存储函数的状态）。

该函数的值将存储在寄存器和内存中，并且必须为每个（递归）调用将这些值存储在堆栈中，否则新调用将覆盖宝贵的数据！所以基本上机器代码看起来像这样（伪代码）

```
//store m on the stack 
store m,stack_pntr+m_offset
//put input values in designated register
a0 = m
//allocate memory on the stack
stackPntr -= stack_size_of(count_vars)
//store return address in allocated register
//jump to the first instruction of count
.
. 
```

通过更改一些用于计算的数据，我们可以返回并再次读取相同的指令并获得不同的结果。递归函数的抽象允许我们以一种很好的“按值调用”方式操作我们想要更改的数据，这样我们就不会无意中覆盖它。

这是由编译器在将调用函数的状态存储在堆栈上时完成的，因此我们不必手动存储它。

# testing - 当缺陷具有关键优先级时，为什么不应该继续测试？

> ID：12265478
> 
> 赞同：1
> 
> 时间：2012-09-04T14:19:45.060
> 
> 标签：testing, theory

我正在尝试理解测试理论，但我几次看到以下与优先级有关的内容：

```
1\. Critical : Bugs at this level must be resolved as soon as possible. Testing
should not progress until a known critical defect is fixed. 
```

或者

```
1.Immediate fix, blocks further testing, very visible 
```

但老实说，我不知道为什么。为什么在修复关键优先级错误之前我不能测试系统的另一部分？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-05T13:21:41.467

如果可以测试其他东西，那么错误不是优先级/严重性 1。就这么简单。:-) 优先级 1 错误往往是“代码无法编译”或“系统在启动时崩溃并且没有解决方法”之类的东西。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-05T11:13:03.203

我预计这种设计背后的原因是这些错误旨在标记关键部分与系统其他部分的大量相互依赖性。

例如，如果您有一个广泛处理货币的应用程序，您可能会在系统的基础上进行测试，以确定货币是否准确表示。如果它们不是，并且您继续测试系统的其他部分，您可能会发现其他数值测试在其他地方报告错误结果。不幸的是，**您还可能会浪费时间**寻找数学或算法中的错误，并花时间修复这些数值测试，而事实上，**他们正在用错误的货币做正确的事情**。

# perforce - Perforce 二进制文件 - 随机同步的错误版本

> ID：12265481
> 
> 赞同：1
> 
> 时间：2012-09-04T14:19:55.120
> 
> 标签：perforce

我有一组文件是文本文件，但包含 ASCII 0 SOH 字符。

Perforce 将这些文件视为二进制文件。现在，老实说，我不在乎它对它们的看法，然而，最近我们已经有几次 Perforce 在集成新分支后为不同的人提供不同的版本。

GUI 在两个人的工作空间上显示版本 #2/#2（两个中的两个），但它们有不同的版本。当这些文件被右键单击并与最新的文件进行比较时（在弹出窗口中选择了字符集以将它们视为文本），它显示文件存在差异。但是，选择“获取最新版本”或执行“p4 同步...”不会更新文件。

我尝试将文件类型设置为“文本”并提交，它们保持文本状态，直到它们恢复为二进制时分支。

有没有人见过这种行为？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T05:35:23.790

> 我尝试将文件类型设置为“文本”并提交，它们保持文本状态，直到它们恢复为二进制时分支。

如果集成/分支的目标尚不存在，它将获取原始文件类型（在您的情况下为文本）。如果它已经存在（在您的情况下可能是二进制），则源文件的文件类型更改不会被集成 - 在您的情况下，目标仍然具有文件类型“二进制”。

为了将源文件的文件类型更改集成到目标文件中，您需要在调用“p4 集成”时使用“-t”选项。最好始终使用选项“-t”调用“p4 集成”。

# wcf - 有没有办法从 WCF 方法中检索请求的 Windows 用户名

> ID：12265483
> 
> 赞同：1
> 
> 时间：2012-09-04T14:20:09.120
> 
> 标签：wcf, wcf-security

我在我的 WCF 服务和代理中使用自定义绑定。我通过从 DuplexClientbase 继承来创建代理。WCF 中是否有一个选项可以帮助我获取调用该方法的用户名？

这是我的绑定

```
<bindings>
    <customBinding>
        <binding name="CustomPipeBinding" maxConnections="10" openTimeout="01:20:00" receiveTimeout="20.00:00:00" sendTimeout="01:20:00" closeTimeout="01:20:00">
            <windowsStreamSecurity protectionLevel="None" />
            <namedPipeTransport maxBufferPoolSize="2147483647" maxReceivedMessageSize="2147483647" maxBufferSize="2147483647" />
        </binding>
        <binding name="CustomTcpBinding" maxConnections="10" openTimeout="01:20:00" receiveTimeout="20.00:00:00" sendTimeout="00:05:00" closeTimeout="01:20:00">
            <windowsStreamSecurity protectionLevel="None" />
            <reliableSession />
            <tcpTransport maxBufferPoolSize="2147483647" maxReceivedMessageSize="2147483647" maxBufferSize="2147483647"/>
        </binding>
    </customBinding>
</bindings> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-04T18:54:39.993

您需要将您的服务配置为需要模拟[，如此 MSDN 文章中所述。](http://msdn.microsoft.com/en-us/library/ms730088%28v=vs.100%29.aspx)由于您正在定义自定义绑定，因此您需要添加所需的安全元素配置以允许 WCF 将 Windows 凭据从客户端传递到服务。

在您的服务代码中，您需要访问`ServiceSecurityContext.Current.WindowsIdentity`静态属性来获得所需的内容。

# routing - 在 Cisco 路由器上，是否可以有等价的多路径静态路由？

> ID：12265485
> 
> 赞同：-1
> 
> 时间：2012-09-04T14:20:12.363
> 
> 标签：routing, load-balancing, cisco

在 Cisco 路由器上，是否可以有等价的多路径静态路由？

如果是这样，如何？

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-08T11:36:54.470

是的。IOS 路由器将在静态/默认路由之间进行负载共享。只需输入两条指向同一目的地的静态路由，指向不同的下一跳：（

`ip route 10.3.1.1 255.255.255.255 10.0.0.2`
`ip route 10.3.1.1 255.255.255.255 10.0.0.6`

这些下一跳当然应该知道通往目标地址/网络的路径）
负载分担行为取决于用于某些特定流的数据包交换方法。

使用 IOS 快速切换 - 您只能负载共享`per-destination`（ip-src - ip-dst 对）。
使用 CEF，您可以使用两种负载共享算法 -`per-packet`和`per-destination`.

使用此全局配置命令打开 CEF：

`ip cef`

在传入接口上使用这些命令来更改 CEF 负载共享算法：

`ip load-sharing per-packet`
`ip load-sharing per-destination`

使用此命令检查某些特定前缀的负载共享状态：

`sho ip cef <prefix> detail`

# javascript - JQuery：从多个锚绑定中获取特定值？

> ID：12265488
> 
> 赞同：0
> 
> 时间：2012-09-04T14:20:27.180
> 
> 标签：javascript, jquery, html

```
var myCode = {};

(function( global ) {
     global.print = function(value){
                   alert("Values: " + value);
                }
            })(myCode);

$(document).ready(function(e) {
    $('[id^=el]').bind("click", function(e) {
        myCode.print("Value");
    });

}); 
```

我有这个锚元素列表：

```
<li>
    <a id="el1"><h3>header 1</h3><p>paragraph 1</p></a>
</li>
<li>
    <a id="el2"><h3>header 2</h3><p>paragraph 2</p></a>
</li>
<li>
    <a id="el3"><h3>header 3</h3><p>paragraph 3</p></a>
</li>
<li>
    <a id="el4"><h3>header 4</h3><p>paragraph 4</p></a>
</li> 
```

如何在不编写绑定的情况下绑定多个元素如果`el4`单击锚点我想打印`Values: header 4, paragraph 4` 那么我怎样才能进入`Jquery`单击的相应锚点的标题或段落？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-04T14:22:08.147

看起来这样就可以了，您需要在您单击的每个锚点内获取 h3 和段落标签的文本值。

```
$('[id^="el"]').bind("click", function(e) {
    myCode.print($(this).find('h3').text() + ', ' + $(this).find('p').text());
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-04T14:26:08.520

试试这个

***HTML***

```
<li>
    <a id="el1"><h3>header 1</h3><p>paragraph 1</p></a>
</li>
<li>
    <a id="el2"><h3>header 2</h3><p>paragraph 2</p></a>
</li>
<li>
    <a id="el3"><h3>header 3</h3><p>paragraph 3</p></a>
</li>
<li>
    <a id="el4"><h3>header 4</h3><p>paragraph 4</p></a>
</li> 
```

***JS代码***

```
var myCode = {};

(function( global ) {
     global.print = function(value){
                   alert("Values: " + value);
                }
            })(myCode);

$(document).ready(function(e) {
    $('[id^=el]').bind("click", function(e) {
        myCode.print($(this).find('h3').text()+ '  '+ $(this).find('p').text());
    });

}); 
```

# windows-phone-7 - 创建带有不可见边框的网格

> ID：12265489
> 
> 赞同：0
> 
> 时间：2012-09-04T14:20:29.523
> 
> 标签：windows-phone-7

我正在开发一个 Windows 手机应用程序。我需要创建一个 3X3 网格状结构。我希望边框最初是不可见的。当用户触摸边框时，它应该变得可见。请给我一些指导如何开始。我是 Windows Phone 框架的新手。另外，它可以在 silverlight 中完成还是我需要 xna ？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-04T16:09:39.683

银光不错。添加一个 3 列和 3 行和列的网格

```
<Grid Name="grid">
    <Grid.ColumnDefinitions>
        <ColumnDefinition />
        <ColumnDefinition />
        <ColumnDefinition />
    </Grid.ColumnDefinitions>
    <Grid.RowDefinitions>
        <RowDefinition />
        <RowDefinition />
        <RowDefinition />
    </Grid.RowDefinitions>
</Grid> 
```

然后将边框元素添加到每一行*列，如下所示：

```
public MainPage()
    {
        InitializeComponent();
        var borders = new Border[3,3];
        var handler = new EventHandler<GestureEventArgs>(MainPage_Tap);
        for (int i = 0; i < 3; i++)
            for (int j = 0; j < 3; j++)
            {
                borders[i,j] = new Border()
                                {
                                    BorderThickness = new Thickness(4),
                                    Opacity = 0,
                                    BorderBrush = new SolidColorBrush(Colors.White)
                                };
                borders[i, j].Tap += handler;

                Grid.SetRow(borders[i,j], i);
                Grid.SetColumn(borders[i,j], j);
                grid.Children.Add(borders[i, j]);
            }
    }

    void MainPage_Tap(object sender, GestureEventArgs e)
    {
        var snd = sender as Border;
        snd.Opacity = 1;
    } 
```

我使用了一系列边框，因此您以后可以轻松地操纵它们，但这并不是真正需要的。

编辑：如果您想在整个网格周围设置边框，请对点击事件执行相同的操作，但像这样在 XAML 中设置边框

```
<Grid Name="grid">
    <Grid.ColumnDefinitions>
        <ColumnDefinition />
        <ColumnDefinition />
        <ColumnDefinition />
    </Grid.ColumnDefinitions>
    <Grid.RowDefinitions>
        <RowDefinition />
        <RowDefinition />
        <RowDefinition />
    </Grid.RowDefinitions>
    <Border Grid.RowSpan="3" Grid.ColumnSpan="3" Opacity="0" Tap="handler" />
</Grid> 
```

# asp.net - ASP.NET MVC：如何防止会话锁定？

> ID：12265490
> 
> 赞同：6
> 
> 时间：2012-09-04T14:20:32.110
> 
> 标签：asp.net, asp.net-mvc, session, session-state

我有一个应用程序，它有一些控制器的动作调用慢的第 3 方网络服务。使用页面中的 AJAX 调用来调用这些操作。

我可以使用异步控制器来释放 ASP.NET 线程池，这很棒。但是会话呢？如果我使用 InProc 会话并请求“慢动作”，则特定用户无法向应用程序发出任何请求，因为他的会话被第一次“慢”调用锁定。

在 PHP 中有一个方法[`session_write_close()`](http://php.net/manual/ru/function.session-write-close.php)，我可以使用如下：

1.  接受用户的慢动作请求
2.  根据会话数据检查用户访问控制器/操作的权限
3.  如果需要，在会话中写一些东西
4.  打电话`session_write_close()`。**从此请求关闭会话，来自同一用户的任何其他请求都可以访问它**
5.  打慢电话（也许以某种异步方式）

我知道我可以使用`[SessionState]`属性在控制器级别禁用会话状态，但这不是解决方案。

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-04T14:41:38.160

我认为这可能是几种情况。

1）在控制器工厂中进行更改并将其更改为在没有会话或一些客户会话实现的情况下生成控制器

2）尝试阅读[这篇关于无会话控制器的文章](http://volaresystems.com/Blog/post/2011/01/20/Sessionless-MVC-3.aspx)

# asp.net - 如何从 YSOD 中删除完整的文件路径？

> ID：12265492
> 
> 赞同：0
> 
> 时间：2012-09-04T14:20:42.333
> 
> 标签：asp.net, asp.net-mvc, visual-studio-2010, publishing, ysod

在下面的 YSOD 中，堆栈跟踪（和源文件行）包含源文件的完整路径。不幸的是，源文件名的完整路径包含我的用户名，即`firstname.lastname`.

我想保留 YSOD 以及堆栈跟踪，包括文件名和行号（这是一个演示和测试系统），但用户名应该从源文件路径中消失。看文件的路径也是可以的，但是路径要在解决方案根目录下截断。

（在发布之前，我不必每次都将解决方案复制粘贴到另一条路径......）

有没有办法做到这一点？

注意：自定义错误页面不是一个选项。

![在此处输入图像描述](../Images/4c4f94db04b431cdc188e4d0f288296c.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-04T14:30:43.980

路径嵌入在`.pdb`编译器生成的文件中。改变这一点的唯一方法是在其他位置构建您的项目，最好是在构建服务器附近的某个地方。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-04T15:15:14.393

没关系，我自己发现的。
感谢 Anton Gogolev 声明路径在 pdb 文件中，我意识到这是可能的。

可以对 pdb 文件进行二进制搜索和替换，然后将用户名替换为其他内容。

我很快尝试使用这个：
[https](https://codereview.stackexchange.com/questions/3226/replace-sequence-of-strings-in-binary-file)
://codereview.stackexchange.com/questions/3226/replace-sequence-of-strings-in-binary-file 并且它有效（在 50% 的 pdb 文件上）。所以请注意废话，链接中的代码片段似乎有问题。

但这个概念似乎奏效了。

我现在使用这段代码：

```
 public static void SizeUnsafeReplaceTextInFile(string strPath, string strTextToSearch, string strTextToReplace)
    {
        byte[] baBuffer = System.IO.File.ReadAllBytes(strPath);
        List<int> lsReplacePositions = new List<int>();

        System.Text.Encoding enc = System.Text.Encoding.UTF8;

        byte[] baSearchBytes = enc.GetBytes(strTextToSearch);
        byte[] baReplaceBytes = enc.GetBytes(strTextToReplace);

        var matches = SearchBytePattern(baSearchBytes, baBuffer, ref lsReplacePositions);

        if (matches != 0)
        {

            foreach (var iReplacePosition in lsReplacePositions)
            {

                for (int i = 0; i < baReplaceBytes.Length; ++i)
                {
                    baBuffer[iReplacePosition + i] = baReplaceBytes[i];
                } // Next i

            } // Next iReplacePosition

        } // End if (matches != 0)

        System.IO.File.WriteAllBytes(strPath, baBuffer);

        Array.Clear(baBuffer, 0, baBuffer.Length);
        Array.Clear(baSearchBytes, 0, baSearchBytes.Length);
        Array.Clear(baReplaceBytes, 0, baReplaceBytes.Length);

        baBuffer = null;
        baSearchBytes = null;
        baReplaceBytes = null;
    } // End Sub ReplaceTextInFile 
```

替换`firstname.lastname`为具有相同数量字符的内容，例如“Poltergeist”。

现在我只需要弄清楚如何运行二进制搜索并将替换作为构建后操作。

# c# - “用户的应用程序数据文件夹”；是否可以在 SpecialFolder.ApplicationData 和 SpecialFolder.LocalApplicationData 之间强制

> ID：12265498
> 
> 赞同：0
> 
> 时间：2012-09-04T14:20:57.560
> 
> 标签：c#, .net, deployment, installation

我有一个需要以正常权限运行的应用程序。因此它安装在 Environment.SpecialFolder.ProgramFiles 中，但将 conf/logging/history 详细信息存储在 Environment.SpecialFolder.LocalApplicationData 中。

问题是在设置/部署项目中，在文件系统部分中，我无法区分 ApplicationData（漫游）或 LocalApplicationData，只有“用户的应用程序数据文件夹”，这可能取决于谁将它安装在什么机器上.

是否可以强制“用户的应用程序数据”为其中之一？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-04T15:18:21.707

MSI*确实*支持本地[应用程序数据文件夹](http://msdn.microsoft.com/en-us/library/aa369768%28v=vs.85%29.aspx)。如果您正在谈论安装和部署项目，那么可能需要切换到另一个安装程序框架（如[WiX](http://wix.codeplex.com/)）。（无论如何，Visual Studio 2012 中不再存在安装和部署）。WiX 有一个名为[Dark](http://wix.sourceforge.net/manual-wix2/dark.htm)的工具，可以将 MSI 转换为 WiX XML 文件，因此您可以简单地编辑它们或快速轻松地添加到它们。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-04-27T11:20:08.790

安装项目在 Visual Studio 2015 中卷土重来。以下适用于 VS 2015：

*   在文件系统视图中，添加一个“自定义”类型的特殊文件夹。
*   在此文件夹的属性中，设置以下值：
    *   名称：本地应用数据文件夹
    *   始终创建：真
    *   条件：（留空）
    *   默认位置：[LocalAppDataFolder]
    *   属性：SOMEPROPERTYNAME

The magic happen thanks to *DefaultLocation* property value: [LocalAppDataFolder].
I suppose any system folder variable as defined in the following link should work: [https://msdn.microsoft.com/en-us/library/windows/desktop/aa370905(v=vs.85).aspx#system_folder_properties](https://msdn.microsoft.com/en-us/library/windows/desktop/aa370905(v=vs.85).aspx#system_folder_properties)

# asp.net-mvc-3 - MVC3 RenderPage 从不渲染内容

> ID：12265499
> 
> 赞同：1
> 
> 时间：2012-09-04T14:21:01.113
> 
> 标签：asp.net-mvc-3, razor

所以我有这个带有 WebGrid 的主/详细信息设置。一切都很好，直到我尝试使用 RenderPage 在单击记录时显示详细信息：

```
<div class="innerbox">
    @{
        if(gdEligibility.HasSelection){
             @RenderPage("~/Views/Eligibility/EligibilityPolicyDetailView.cshtml",
                 new { Customer = gdEligibility.SelectedRow })
        }
    }
</div> 
```

一切正常，如果我设置一个断点，我可以单步执行详细视图的 cshtml 文件，没有问题，没有错误。但是在外部 div 之间没有渲染任何内容。曾经。为什么 RenderPage 不返回任何内容？我什至尝试在行尾添加 .ToHtmlString() 但仍然没有。

详细cshtml：

```
@{ foreach(TravelInsurance.Models.Policy p in Page.Customer.Policies){

<fieldset>
    <legend>Policy</legend>

    <div class="display-label">Policy Number</div>
    <div class="display-field">
        @Html.DisplayFor(model => p.PolicyNumber)
    </div>

    <div class="display-label">Premium</div>
    <div class="display-field">
        @Html.DisplayFor(model => p.Premium)
    </div>
</fieldset>
}} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-05T01:55:05.333

[这个](https://stackoverflow.com/questions/4501736/razor-html-partial-vs-renderpage)问题表明 RenderPage 将使用父模型...

也许尝试使用

```
@{Html.RenderPartial("EligibilityPolicyDetailView", new { Customer = gdEligibility.SelectedRow });} 
```

或者

```
@Html.Partial("EligibilityPolicyDetailView" ,new { Customer = gdEligibility.SelectedRow }) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-11-20T16:29:26.607

PL。通过删除网格定义中的属性“ajaxUpdateContainerId”重试，它应该可以工作。

# java - 使用 Bloomberg Java API 获取日期和时间的 VWAP 量

> ID：12265504
> 
> 赞同：4
> 
> 时间：2012-09-04T14:21:11.547
> 
> 标签：java, bloomberg

我正在尝试使用开放的 Bloomberg API 来收集特定日期特定时间范围内的 VWAP 交易量。例如，如何获取 8 月 27 日上午 11 点到 11:15 之间的 VWAP_VOLUME？

使用 Excel，我可以使用

`BDP("MSFT US Equity", "VWAP_VOLUME", "VWAP_START_TIME=11:00:00", "VWAP_END_TIME=11:15:00", "VWAP_START_DT=20120827", "VWAP_END_DT=20120827")`

因为我可以在 Excel 中完成，所以我应该能够在 Java 中做同样的事情。我尝试使用 ReferenceDataRequest 覆盖日期和时间字段。我还尝试使用带有在时间字段上设置的覆盖的 HistoricalDataRequest。两者都不返回任何数据。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-04T16:10:15.127

你在哪个时区？我在英国，如果我使用 15:00 作为开始时间并使用 15:15 作为结束时间（我的参数为 0），它适用于我，并使用以下元素，使用“ReferenceDataRequest”：

*   证券：MSFT US Equity
*   字段：VWAP_VOLUME
*   覆盖：
    *   fieldId=VWAP_START_TIME：值=15:00:00
    *   fieldId=VWAP_END_TIME：值=15:15:00
    *   fieldId=VWAP_START_DT：值=20120827
    *   fieldId=VWAP_END_DT：值=20120827

# c# - 将参数传递给 COM 接口

> ID：12265505
> 
> 赞同：2
> 
> 时间：2012-09-04T14:21:15.340
> 
> 标签：c#, com

我正在尝试编写一个小型 c# 应用程序来测试 COM 接口（也是用 c# 编写的）。该接口包含一个接受单个字符串作为参数的方法。

我在下面包含了几个代码示例。我使用以下内容来执行调用：

```
public class CreateObject
{
    private Type comType;
    public object comObject;

    public CreateObject(string ProgID)
    {
        comType = Type.GetTypeFromProgID(ProgID);
        comObject = Activator.CreateInstance(comType);
    }
    public void Execute(string Method, params object[] Parameters)
    {
        comType.InvokeMember(Method, BindingFlags.InvokeMethod, null, comObject, Parameters);
    }
} 
```

然后我使用以下命令执行：

```
String sParam = "test";
CreateObject obj = new CreateObject("Namespace.Class");          
obj.Execute("Method", sParam ); 
```

在 COM 内部，界面如下所示：

```
[InterfaceType(ComInterfaceType.InterfaceIsDual), Guid("xxxxxx-xxxx-xxxx-xxxx-xxxxxx")]
public interface Interface
{
    void Method(String sParam);
} 
```

方法（字符串）的简化实现：

```
[ClassInterface(ClassInterfaceType.None), Guid("xxxxxx-xxxx-xxxx-xxxx-xxxxxxxxx"), ProgId("Namespace.Class")]
public class Class: Interface
{
    public void Method(String sParam)
    {
        XmlDocument xml = new XmlDocument();
        xml.LoadXml(sParam);
        XmlWriter writer = XmlWriter.Create("result.xml");

        *** other code used to create the xml ***
    }
} 
```

即使没有返回错误，COM 似乎实际上也没有执行。但是，当我从测试应用程序和 COM 中取出字符串参数时，我确实得到了正确的输出（COM 接口在磁盘上创建了一个 XML 文件）。任何人都可以看到我使用参数的错误吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-10T11:02:09.403

我发现类库不使用 app.config，这意味着我的 COM 无法访问它的任何设置（连接字符串等）并且抛出了我无法看到的错误，直到我将它们作为尝试/捕捉。

所以答案是在这种情况下使用参数是正确的。

# c# - 正确使用 MS SQL

> ID：12265506
> 
> 赞同：0
> 
> 时间：2012-09-04T14:21:23.777
> 
> 标签：c#, database, dataadapter

我有一个从 SQL Server 表中获取数据的程序。代码如下：

```
SqlConnection conn=new SqlConnection(...);//correct
conn.Open();
DataTable dt=new DataTable();
SqlCommand selectCMD = new SqlCommand("SELECT * FROM TABLE WHERE Condition", conn);
SqlDataAdapter custDA = new SqlDataAdapter();
custDA.SelectCommand = selectCMD;
custDA.Fill(dt);
Datagridview1.DataSource=dt;
Datagridview1.DataBind(); 
```

但问题是，在 SQL Server Management Studio 中执行相同的查询时，执行时间不到一秒。同时在使用程序时，需要半分钟才能得到结果。使用调试器，我看到，程序“思考”很多时间的主行是数据适配器填充 DataTable 的时候。有什么建议可以减少时间吗？我的代码有什么问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-04T14:27:23.870

Management studio 只显示文本结果。 `SqlDataAdapter`必须将每个结果列值映射到`DataGridView`列值。一个将比另一个花费更多的时间。使用 Management Studio，它还可以虚拟化结果——当您向下滚动查看大型结果集时，它不会一次显示所有结果，检索到更多数据。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-04T14:28:34.177

您可以创建索引并设置选项以加速查询执行。您可以使用这种方法来加载数据[SqlDataAdapter.Fill - 异步方法](https://stackoverflow.com/questions/2108917/sqldataadapter-fill-asynchronous-approach)

```
create index condition_idx on table (condition)

new SqlCommand("set nocount on;SELECT * FROM TABLE WHERE Condition", conn); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-04T14:28:43.417

检查您可能需要对所需列进行正确索引。当您从 SQL 运行查询时，它可能使用的执行计划比 .Fill 方法执行时更优化。

您可以尝试使用 SSMS 清除过程缓存和内存缓冲区吗：

```
DBCC DROPCLEANBUFFERS
DBCC FREEPROCCACHE 
```

在测试查询之前这样做可以防止使用缓存的执行计划和以前的结果缓存。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-04T15:05:52.163

感谢大家的帮助。`SqlCommand`我在对象中使用了参数。不幸的是，我没有提到这一点，所以你无法帮助我。但是正如[詹姆斯](https://stackoverflow.com/users/82586/james)发布的链接，我发现当`SqlCommand`使用参数时，执行是使用存储过程进行的`sp_execute`。因为服务器必须编译它，这就是它需要这么长时间的原因。删除参数后，一切正常。另一种方法是您可以在每次执行存储过程时关闭自动重新编译。再次感谢大家。为所有人+1。

# jquery - jQuery animate() 2个元素之间的奇怪空间

> ID：12265507
> 
> 赞同：1
> 
> 时间：2012-09-04T14:21:26.283
> 
> 标签：jquery, jquery-animate, slider

我正在用 jQuery 编写一个滑块。

它有效，但我有一个问题，当我的滑块与我的 2 个元素一起滑动时，我在这 2 个元素之间有一个空白区域和一个“滞后”（滞后，小运动..），我不知道如何删除它。

在这里，html代码：

```
 <div class="wrapperActusSlide">
<div class="numActusSlide"><span class="rien">20</span></div>
<div class="imgActusSlide"><img src="bamboo_orchestra_act.jpg" alt="Le Quintette Bamboo Orchestra" width="385px" height="254px" /></div>
   <div class="wrapperInnerImgActuSlide">
      <span class="goToEvt"><a href="quintette_bamboo_orchestra.html">Aller à l'évènement</a></span>
      <div class="resume">
         <h3><a href="quintette_bamboo_orchestra.html">Quintette Bamboo Orchestra</a></h3>
         <p>Samedi 29 septembre</p>
   </div>
</div>

</div><div class="wrapperActusSlide">
<div class="numActusSlide"><span class="rien">18</span></div>
<div class="imgActusSlide"><img src="bateau_nino_act.jpg" alt="Le Bateau de Nino" width="385px" height="254px" /></div>
   <div class="wrapperInnerImgActuSlide">
      <span class="goToEvt"><a href="le_bateau_de_nino.html">Aller à l'évènement</a></span>
      <div class="resume">
         <h3><a href="le_bateau_de_nino.html">Le Bateau de Nino</a></h3>
         <p>Vendredi 12 octobre</p>
   </div>
</div>

</div><div class="wrapperActusSlide">
<div class="numActusSlide"><span class="rien">20</span></div>
<div class="imgActusSlide"><img src="clan_des_divorcees_act.jpg" alt="Le Clan des divorcées" width="385px" height="254px" /></div>
   <div class="wrapperInnerImgActuSlide">
      <span class="goToEvt"><a href="le_clan_des_divorcees.html">Aller à l'évènement</a></span>
      <div class="resume">
         <h3><a href="le_clan_des_divorcees.html">Le Clan des divorcées</a></h3>
         <p>Vendredi 19 octobre</p>
   </div>
</div>

</div> 
```

在这里，jQuery 代码：

```
var timer;

$(document).ready(function() {
  //On fait floater
  $(".wrapperActusSlide").css("float","left"); 

  fermeTout();
  affichePremier();  
  timer = setTimeout('afficheTime()',5000);

  //Click sur une actu
  $('.numActusSlide').click(function(){
    if($(this).parent().attr('class') == "wrapperActusSlide actif"){
        fermeActif();      
    }
    else{
        fermeActif();
        afficheClick($(this).parent());
    }     
  });   
}); 

function afficheTime(){ 
    afficheSuivant();
    timer = setTimeout('afficheTime()',5000);
}

function afficheClick(element){
  //on affiche l'élement cliqué
  element.stop().animate({"width": "384px"}, 1000);
  element.children(".imgActusSlide").stop().animate({"width": "384px"}, 1000).css('display','block');
  ouvre(element);
  window.clearTimeout(timer);
}

function afficheSuivant(){
    var indice = 99;
    var indiceMax = $(".wrapperActusSlide").size();

    //on affiche le suivant
    $(".wrapperActusSlide").each(function(index){       
        if($(this).attr('id') == "actif"){ 
            indice = index+1;
        }       
        if(indice >= indiceMax){
            indice = 0;
        }
    });

    $(".wrapperActusSlide").each(function(index){       
        if(indice == index){ 
            fermeActif();
            $(this).stop().animate({"width": "384px"}, 2000);
            $(this).children(".imgActusSlide").stop().animate({"width": "384px"}, 2000).css('display','block');
            ouvre($(this));
        }            
    });
}

function affichePremier(){
  //on affiche le premier
  $(".wrapperActusSlide").each( function(index){
    if(index == 0){
        $(this).stop().animate({"width": "384px"}, 1000);
        $(this).children(".imgActusSlide").stop().animate({"width": "384px"}, 1000).css('display','block');
        ouvre($(this));
    }
  });  
}

function fermeTout(){
    //on retrecit les autres
    $(".wrapperActusSlide").each( function(){
    $(this).css('width','28px');
    $(this).children(".imgActusSlide").css('width', "28px").css('overflow','hidden');
    ferme($(this));
  });
}

function fermeActif(){
    //on retrecit les autres
    $("#actif").css('width','28px');
    $("#actif").children(".imgActusSlide").css('width','28px').css('overflow','hidden');
    ferme($("#actif"));
}

function ferme(mon_div){
  //On fait disparaitre les textes
  $(mon_div).children(".wrapperInnerImgActuSlide").css('display','none');
  $(mon_div).children(".numActusSlide").show();
  $(mon_div).removeClass('actif');
  $(mon_div).removeAttr('id');
}

function ouvre(mon_div){
  //On fait apparaitre les textes
  $(mon_div).children(".wrapperInnerImgActuSlide").css('display','block').fadeIn(2000);
  $(mon_div).children(".numActusSlide").hide();
  $(mon_div).addClass('actif');
  $(mon_div).attr('id','actif');
} 
```

如果你能重现这个问题，你能帮我吗？

# java - 如果每个用户的 putty.exe 路径不同，如何从 java 打开 putty？

> ID：12265508
> 
> 赞同：1
> 
> 时间：2012-09-04T14:21:26.783
> 
> 标签：java, putty

我正在开发一个需要在用户身份验证后将 shell 脚本传递给 putty 的 java web 应用程序。putty.exe 应该仅在身份验证成功并且脚本已开始成功运行时启动。

此外，由于不同的用户可能在其系统的不同位置安装了 putty。有什么方法可以在不需要用户手动配置路径的情况下启动 putty.exe。或者是否可以以编程方式找到路径并启动腻子？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-04T14:34:36.033

我同意楼上的人。同样在您的应用程序中，您可以提供用户设置 putty.exe 完整路径并将它们存储在 cookie 中的功能。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-04T14:43:33.883

我将首先说不让用户将 putty 添加到路径最容易通过为每个用户创建一个配置文件来解决，其中一个参数将是 putty 可执行文件的位置。如果 putty 无法打开，则使用默认值和对话框正确处理此问题对于大多数用户来说既简单又熟悉。

两种简单的情况可能会完全影响您搜索可执行文件的方式：用户重命名 putty 可执行文件或用户拥有多个版本的 putty。

为了避免被第一种情况难住，您将不得不要求新名称并以某种方式将其保存在配置中。

为了避免被第二次难住，您将不得不询问他们想要的 putty 版本，存储该版本，并以某种方式进行版本检查，如果您只想查找 putty.exe（也许您有一个文件每个版本的校验和）。

这与仅仅要求他们指向可执行文件相比，即使不是让用户更烦人（而且对您来说肯定更烦人）。还有更多可能出错的方法。

基本上，可以搜索可执行文件，但它不会为任何人节省任何麻烦，只会为您带来更多收益。让用户配置路径并不是很棘手，但如果你想避免它，那么最简单的方法是让每个用户的配置文件与你的程序保存在其中的 putty 路径。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-04T14:26:35.083

一种方法是编辑用户计算机的 PATH 系统变量并添加 Putty.exe 位置的完整路径。

另一种解决方案是在每台用户机器的默认文件夹中创建一个指向 Putty.exe 的链接，以便 Java 可以访问此链接而不会出现问题。

第三种解决方案可能是将 Putty.exe 与您的应用程序安装程序一起提供。Putty.exe 不需要自定义 DLL 即可工作（至少我还不需要）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-04T14:28:14.267

从理论上讲，如果您搜索用户计算机上的每个目录以找到 putty.exe 是可能的。但实际上，您应该要求将文件放在一些熟悉的目录中或使用环境变量。

# c# - 我应该在哪里找到 MVC Razor 中的共享 @helper 函数

> ID：12265512
> 
> 赞同：47
> 
> 时间：2012-09-04T14:21:45.473
> 
> 标签：c#, asp.net-mvc, razor

我有一个辅助函数，可以将分钟变成小时/分钟。我目前在我的 layout.cshtml 中有它，但每个页面都看不到该功能。我应该把帮助函数放在哪里，这样每个页面都可以看到它？

```
@helper DisplayElapsedTime(int timeInMins){
    String timeStr = "";
    if (timeInMins >= 60) {
        int hours = timeInMins/60;
        timeInMins -= hours * 60;
        timeStr = hours + "h ";
    }
    if (timeInMins > 0){
        timeStr += timeInMins + "m";
    }
    @timeStr;
} 
```

* * *

## 回答 #1

> 赞同：45
> 
> 时间：2012-09-04T14:23:52.907

您应该将其放入**App_Code**文件夹中。有一篇很棒的文章供您阅读[ASP.NET MVC Helpers](http://weblogs.asp.net/scottgu/archive/2011/05/12/asp-net-mvc-3-and-the-helper-syntax-within-razor.aspx)

# php - PHP foreach 循环

> ID：12265515
> 
> 赞同：0
> 
> 时间：2012-09-04T14:21:51.037
> 
> 标签：php, foreach, preg-replace

我正在尝试编写脚本，但一直卡住。

我有一个变量`$message`。我想解析它。这样 * 和 * 之间包含的所有内容都可以是不同的颜色。例如：

```
This is message * 1 
```

不会受到影响。但

```
This is a *message* see how it works *again here*. 
```

会有不同的颜色`message`。`again here`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-04T14:28:34.700

使用正则表达式：

```
$in = 'This is a *message* see how it works *again here*.';
$out = preg_replace('/\*([^*]+)\*/', '<span class="color">$1</span>', $in);
print $out; 
```

比非贪婪匹配快一点。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-04T14:23:58.017

用于`explode`拆分星号上的字符串。之后，您可以输出数组中的每个元素，中间使用正确的标记来更改颜色。

像这样的东西：

```
$parts = explode('*', $message);

$italic = false;
for ($part in $parts)
{
  if ($italic) 
    echo '<i>' . $part . '</i>';
  else 
    echo $part;

  $italic = !$italic;
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-04T14:27:41.127

我建议使用`preg_replace()`：

```
$message = preg_replace("#\*(.*?)\*#", "<span class=\"color-red\">\\1</span>", $message); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-04T15:43:23.477

```
$message = 'This is a *message* see how it works *again here*.';
$colorMessage =  preg_replace('/\*([^\*]+|[\w]+)\*/', "<span class='color2'>$0</span>", $message); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-04T14:26:32.493

```
$output = preg_replace('/\*([^*]+)\*/', '<em>$1</em>', $message); 
```

或者

```
$output = preg_replace('/\*(.+?)\*/', '<em>$1</em>', $message); 
```

# php - 修改分页脚本以在第一页上显示与其他页面不同的行数

> ID：12265516
> 
> 赞同：0
> 
> 时间：2012-09-04T14:21:52.173
> 
> 标签：php, pagination

我有一个简单的分页脚本：

```
$product_nr = count($query); // counts the number of products
$totalpages = ceil($product_nr / $rowsperpage);  
if ($currentpage > $totalpages){ $currentpage = $totalpages; } 
$offset = (($currentpage - 1) * $rowsperpage); 
```

代码设置为每页显示 20 行 -> $rowsperpage = 20;

我需要一个关于如何**仅在第一页上仅显示 18 行**并将其余 2 行添加到 $product_nr 的想法，这样它就不会破坏其他页面的每页 20 行分页。

基本上：

```
1st page - 18 rows;
the other pages would show 20 rows per page from the remaining rows. 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-04T14:41:09.903

如果可能的话，你可以设置。$rowsperpage 在第一页时单独设置，即如果 $currentpage == 1 然后 $rowperpage=18 并且对于所有其他页面，您必须设置偏移量 -2 即

> if($currentpage != 1){ $offset = ((($currentpage - 1) * $rowsperpage)) - 2 ; }

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-04T14:33:38.277

```
if($currentpage == 1)
$rowsperpage = 18;
else
$rowsperpage = 20; 
```

# android - Android诡异动作“程序”

> ID：12265519
> 
> 赞同：0
> 
> 时间：2012-09-04T14:22:00.317
> 
> 标签：android

该程序绘制两个数字和符号。IF 语句检查它是否已绘制 + / -。如果它绘制+加，如果-是减法。

画作品。

然后给用户任务的结果。这就是问题所在。

如果您给出“结果”中的结果。如果某事起作用。如果您输入的答案不正确，则会显示 Toast: Try Again。

**问题是有时会显示“重试”，以提供良好的结果。**

如何消除这个问题？可能不同的检查？

代码：

```
private String sign;
    private int numberOne, numberTwo, result = 0;
    private int charsEntered = 0;
    private EditText et;
    private Button ok;
    String[] CHAR = { "+", "-" };
    Random intGen = new Random();
    CaptchaInterface.OnCorrectListener mCorrectListener;

    public void setOnCorrectListener(CaptchaInterface.OnCorrectListener listener) {
        mCorrectListener = listener;
    }

    public EasyMathCaptcha(Context context) {
        super(context);
        getWindow().requestFeature(Window.FEATURE_NO_TITLE);
    }

    public static int randomOne() {
        Random generator = new Random();
        int x = generator.nextInt(10);
        return x;
    }

    public static int randomTwo() {
        Random generator = new Random();
        int x = generator.nextInt(10);
        return x;
    }

    public void onCreate(Bundle icicle) {
        setContentView(R.layout.all_math_captcha);

        sign = (CHAR[Math.abs(intGen.nextInt() % 2)]);
        numberOne = randomOne();
        numberTwo = randomTwo();

        TextView display = (TextView) findViewById(R.id.tvRandomTask);
        display.setText(numberOne + " " + sign + " " + numberTwo);

        if ((CHAR[Math.abs(intGen.nextInt() % 2)]).equals("+")) {
            result = (numberOne + numberTwo);
        } else if ((CHAR[Math.abs(intGen.nextInt() % 2)]).equals("-")) {
            result = (numberOne - numberTwo);
        }

        et = (EditText) findViewById(R.id.etTask);
        ok = (Button) findViewById(R.id.btAgree);
        ok.setOnClickListener(this);

    }

    public void onClick(View arg0) {
        // TODO Auto-generated method stub
        try {
            charsEntered = Integer.parseInt(et.getText().toString());
        } catch (NumberFormatException nfe) {
            Toast.makeText(et.getContext(), "That's not a number!",
                    Toast.LENGTH_SHORT).show();
        }

        if (charsEntered == result) {
            if (mCorrectListener != null)
                mCorrectListener.onCorrect();
            dismiss();

        } else if (charsEntered != result) {
            Toast.makeText(et.getContext(), "Try again!", Toast.LENGTH_SHORT)
                    .show();
        }

    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-04T14:26:27.820

错误在以下代码中：

```
 if ((CHAR[Math.abs(intGen.nextInt() % 2)]).equals("+")) {
        result = (numberOne + numberTwo);
    } else if ((CHAR[Math.abs(intGen.nextInt() % 2)]).equals("-")) {
        result = (numberOne - numberTwo);
    } 
```

您正在使用随机数生成器，它可以为您提供与第一次不同的结果。

将其更改为：

```
 if (sign.equals("+")) {
        result = (numberOne + numberTwo);
    } else if (sign.equals("-")) {
        result = (numberOne - numberTwo);
    } 
```

# ios - QLPreviewController 未打开下载的文件

> ID：12265520
> 
> 赞同：0
> 
> 时间：2012-09-04T14:22:01.253
> 
> 标签：ios, download, preview, qlpreviewcontroller

我正在尝试将下载的文件预览到系统，并且在执行名为 previewController:previewItemAtIndex: 的方法时程序崩溃。我假设是在显示之前释放预览控制器，但是当文件已经在文档文件夹中时，不会发生此错误。只有在下载文件后立即尝试打开文件时才会发生这种情况。

这是代码：

```
- (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath
{

NSUInteger row = [indexPath row];
NSUInteger count = [listSessionsST count];

[tableView deselectRowAtIndexPath:indexPath animated:YES];

    Signature *object = [listSessionsST objectAtIndex:row];

        UITableViewCell *cell = [tableView cellForRowAtIndexPath:indexPath];
        UILabel *lblInComplete = (UILabel*)[cell viewWithTag:4];
        UIImageView *imgCheck = (UIImageView*)[cell viewWithTag:3];

        //Sets the File Name
        self.File = [[[NSString stringWithFormat:@"%@_%@.%@",object.FileName,object.ModDate,object.Extension] 
                         componentsSeparatedByCharactersInSet: [NSCharacterSet whitespaceCharacterSet]] componentsJoinedByString: @""];

        //Shows the loading screen while the file is being downloaded
        [DejalBezelActivityView activityViewForView:self.view withLabel:@"Downloading" width:0 LoadingType:@"Full"];
        [DejalActivityView currentActivityView].showNetworkActivityIndicator = YES;

        //Calls the method that will begin downloading the file 
        [self performSelector:@selector(startDownload:) withObject:object.Location afterDelay:0.2];

}

- (void)startDownload:(NSString *)strLocation{

NSString *filePath = [NSString stringWithFormat:@"%@/tmp/%@", NSHomeDirectory(),self.File];
BOOL fileExists = [[NSFileManager defaultManager] fileExistsAtPath:filePath];

if (fileExists)
{
    [DejalBezelActivityView removeViewAnimated:YES];
    //QuickLook APIs directly to preview the document 
    QLPreviewController *previewController = [[QLPreviewController alloc] init];
    previewController.dataSource = self;
    previewController.delegate = self;
    [[self navigationController] pushViewController:previewController animated:YES];
    [previewController release];
}
else
{
    NSDictionary *dictionary = [Signature downloadFile:self.File Path:strLocation];

    if ([dictionary valueForKey:@"Error"] == nil)
    {
        //If no error has occurred while downloading then preview the file.

        //QuickLook APIs directly to preview the document 
        QLPreviewController *previewController = [[QLPreviewController alloc] init];
        previewController.dataSource = self;
        previewController.delegate = self;
        [[self navigationController] pushViewController:previewController animated:YES];
        [previewController release];
        [DejalBezelActivityView removeViewAnimated:YES];
    }
    else 
    {
        //If an error occurred while downloading then display message to user.
        [DejalBezelActivityView removeViewAnimated:YES];
        UIAlertView *alert = [[UIAlertView alloc]                        
                              initWithTitle:@"" 
                              message:[dictionary valueForKey:@"Response"]
                              delegate:self 
                              cancelButtonTitle:@"Ok" 
                              otherButtonTitles:nil];
        [alert show];
        [alert release];
    }
  }
}

// Returns the number of items that the preview controller should preview
- (NSInteger)numberOfPreviewItemsInPreviewController:(QLPreviewController *)previewController{
    return 1;
}

// returns the item that the preview controller should preview
- (id)previewController:(QLPreviewController *)controller previewItemAtIndex:(NSInteger)index{

     NSString *path = [NSString stringWithFormat:@"%@/tmp/%@", NSHomeDirectory(),self.File];
    return [NSURL fileURLWithPath:path];
}

The method that downloads the file and saves it to the tmp folder 
---------------------------------------------------------------
+ (NSDictionary *)downloadFile:(NSString *)strFile Path:(NSString *)strPath{

float freeSpace = 0.0f;  
NSError *error = nil;  
NSDictionary *dictionary = [[NSFileManager defaultManager] attributesOfFileSystemForPath:[NSString stringWithFormat:@"%@/tmp", NSHomeDirectory()]
                                                                                   error: &error];  
if (dictionary) 
{  
    NSNumber *fileSystemFreeSizeInBytes = [dictionary objectForKey: NSFileSystemFreeSize];  
    freeSpace = [fileSystemFreeSizeInBytes floatValue];  
}
else
{ 
    //Handle error
    NSLog(@"Error;%@",error);
    return [NSDictionary dictionaryWithObjectsAndKeys:@"An error has occurred while downloading the file.",@"Response",@"Y",@"Error", nil];
}  

if (freeSpace > 0.0f)
{
    NSDictionary *dict = nil;
    BOOL blnHasErroroccurred = NO;

    AppDelegate *appDelegate = (AppDelegate *)[[UIApplication sharedApplication] delegate];

    NSString *encoded = (NSString *)CFURLCreateStringByAddingPercentEscapes(NULL,
                                                                            (CFStringRef)strPath,
                                                                            NULL,
                                                                            (CFStringRef)@"!*'\"();:@&=+$,/?%#[]%",
                                                                            kCFStringEncodingUTF8 );

    NSString *strURL = [NSString stringWithFormat:@"%@/DataTransfer/DownloadFile?EMP_ID=%@&FilePath=%@", 
                        appDelegate.ServerAddress,
                        appDelegate.UserId,
                        encoded];

    [encoded release];

    NSURL *url = [NSURL URLWithString:strURL];

    NSMutableURLRequest *request = [NSMutableURLRequest requestWithURL:url 
                                                           cachePolicy: NSURLRequestUseProtocolCachePolicy 
                                                       timeoutInterval:20.0];

    [request setHTTPMethod:@"POST"];
    [request setValue:@"application/x-www-form-urlencoded" forHTTPHeaderField:@"Content-Type"];

    NSURLResponse* response = nil;
    NSError* resultError = nil;

    NSData* dataResult = [NSURLConnection sendSynchronousRequest:request 
                                         returningResponse:&response 
                                                     error:&resultError];

    NSHTTPURLResponse* httpResponse = (NSHTTPURLResponse*)response;

    if ([httpResponse statusCode] == 200) 
    {
        @try 
        {
            if (dataResult.length < freeSpace) 
            {
                //Get the tmp directory
                NSFileManager *fileManager =[NSFileManager defaultManager];
                NSString *fileName = [NSString stringWithFormat:@"%@/tmp/%@", NSHomeDirectory(),strFile];

                //Write the data to using the tmp directory
                BOOL filecreationSuccess = [fileManager createFileAtPath:fileName contents:dataResult attributes:nil];       

                if(filecreationSuccess == YES)
                {
                    dict = [NSDictionary dictionaryWithObjectsAndKeys:@"",@"Response",nil,@"Error", nil];
                }   
                else
                {
                    blnHasErroroccurred = YES;
                }
            }
        }
        @catch (NSException *exception)
        {
            blnHasErroroccurred = YES;
        }
    }
    else 
    {
        blnHasErroroccurred = YES;
    }

    if(blnHasErroroccurred == YES)
    {
        dict  = [NSDictionary dictionaryWithObjectsAndKeys:@"An error has occurred while downloading the file.", @"Response", @"Yes",@"Error",nil];
    }

    [dataResult release];
    return dict;
}
else
{
    return [NSDictionary dictionaryWithObjectsAndKeys:@"Not enough disk space to download file.",@"Response",@"Y",@"Error", nil];
}
} 
```

# objective-c - 如何将绘图 uiview 作为模型视图弹出仅一半的屏幕

> ID：12265524
> 
> 赞同：1
> 
> 时间：2012-09-04T14:22:13.557
> 
> 标签：objective-c, ios

我用 xib 创建了新的 viewcontroller 类，然后创建了 uiview 继承类，并在 xib 文件自定义类中我写了 uiview 继承类名（PaintView）。

我正在尝试在我的应用程序中实现一个简单的绘图功能，我创建了一个简单的绘图代码，它使用 PaintView 类中的 touchbegain、thouchmoves、drawrect 方法在 uiview 上进行绘制。

直到这里一切正常，现在我想弹出这个视图的模型，但我希望它显示一半屏幕，我在界面生成器中调整它的大小，但它仍然全屏显示。

其他帖子说创建一个透明视图在下半部分添加内容，这就是你将如何获得半模型视图，但这不是我的问题的解决方案。

如何正确弹出模型视图但只有一半的屏幕。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-04T14:45:08.190

很简单，不要以模态方式呈现它。

```
UIViewController *controller = [[UIViewController alloc] initWithNibName:@"myXib" bundle:[NSBundle mainBundle]];
[controller.view setFrame:CGRectMake(0, 480, 320, 320)];
[self.view addSubview:controller.view];
[UIView animateWithDuration:0.5 animations:^{
    [controller.view setTransform:CGAffineTransformMakeTranslation(0, -320)];
}]; 
```

要更改颜色，我建议您将颜色色调的整数值存储到一个数组中，这样您就可以从数组中某个对象的整数值稳定地分配色调：

```
arrayOfColors = [[NSArray alloc] initWithObjects:@"0.0", @"0.1", @"0.2", @"0.3", @"0.4", @"0.5", @"0.6", @"0.7", @"0.8", @"0.9", nil];

[[UIColor colorWithHue:[[arrayOfColors objectAtIndex:someIndex]floatValue] saturation:1.0 brightness:1.0 alpha:1.0]setStroke]; 
```

# javascript - 将javascript中的JSON输出为不带jquery的列表

> ID：12265526
> 
> 赞同：4
> 
> 时间：2012-09-04T14:22:14.980
> 
> 标签：javascript, html, json

我有一个 JSON 对象：

```
var txt = '{"employees":[' +
'{"firstName":"John","lastName":"Doe","time":"9:15am","email":"john_doe@gmail.com" },' +
'{"firstName":"Anna","lastName":"Smith","time":"9:15am","email":"anna@gmail.com" },' +
'{"firstName":"Peter","lastName":"Jones" ,"time":"9:15am","email":"peter@gmail.com"}]}'; 
```

我想在 div 语句之间打印为列表：

*   约翰·多伊
*   上午 9 点 15 分
*   john_doe@gmail.com

*   安娜史密斯

*   上午 9 点 15 分
*   anna@gmail.com

*   彼得·琼斯

*   上午 9 点 15 分
*   peter@gmail.com

我试图填充的 HTML 如下所示：

```
 <div class="info">
        <ul>
            <li id="name"></li>
            <li id="time"></li>
            <li id="email"></li>
        </ul>
    </div> 
```

我该如何做到这一点？

```
<!DOCTYPE html>
<html>
<body>
<h2>Create Object from JSON String</h2>
<div id="output">

</div> 
<script type="text/javascript">
var txt = '{"employees":[' +
'{"firstName":"John","lastName":"Doe","time":"9:15am","email":"john_doe@gmail.com" },' +
'{"firstName":"Anna","lastName":"Smith","time":"9:15am","email":"anna@gmail.com" },' +
'{"firstName":"Peter","lastName":"Jones" ,"time":"9:15am","email":"peter@gmail.com"}]}';

var employees=JSON.parse(txt).employees;
var container=document.getElementById("output");

for (i=0;i<employees.length;i++) { //Loops for the length of the list
    var info=document.createElement('div');
    info.className='info'; //Creates a new <div> element and adds the class info to it

    var ul=document.createElement('div'); //Creates <ul> element
    info.appendChild(ul); //Adds the <ul> to the newly created <div>

    var name=document.createElement('li');
    name.className='name'; //Should use class, not id, as ID must be unique
    name.innerHTML=employees[i].firstName+' '+employees[i].lastName; //Adds name
    ul.appendChild(name);

    var time=document.createElement('li');
    time.className='time';
    time.innerHTML=employees[i].time;
    ul.appendChild(time);

    var email=document.createElement('li');
    email.className='email';
    email.innerHTML=employees[i].email;
    ul.appendChild(email);

    container.appendChild(info); //Adds the final generated HTML to the page

} //Will repeat for each item in list.

</script>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-04T14:36:51.517

首先，把你的字符串变成一个对象：

```
var employees=JSON.parse(txt).employees; 
```

然后，设置一个循环来构造 HTML

```
var container=//Link to the containing element using getElementById or similar

for (i=0;i<employees.length;i++) { //Loops for the length of the list
    var info=document.createElement('div');
    info.className='info'; //Creates a new <div> element and adds the class info to it

    var ul=document.createElement('div'); //Creates <ul> element
    info.appendChild(ul); //Adds the <ul> to the newly created <div>

    var name1=document.createElement('li'); //Chrome seems not to like the variable "name" in this instance
    name1.className='name'; //Should use class, not id, as ID must be unique
    name1.innerHTML=employees[i].firstName+' '+employees[i].lastName; //Adds name
    ul.appendChild(name1);

    var time=document.createElement('li');
    time.className='time';
    time.innerHTML=employees[i].time;
    ul.appendChild(time);

    var email=document.createElement('li');
    email.className='email';
    email.innerHTML=employees[i].email;
    ul.appendChild(email);

    container.appendChild(info); //Displays the elements on the page

} //Will repeat for each item in list. 
```

这也可以`container.innerHTML`使用`document.createTextNode()`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-04T14:29:13.053

首先，您通过解析获取 JSON 字符串中的数组：

```
var employees = JSON.parse(txt).employees 
```

然后你像这样创建 HTML 元素

```
var element = document.createElement('div'); // creates an empty div 
```

然后将 HTML 树与

```
someElement.append(otherElement); // makes otherElement a child of someElement 
```

# ruby-on-rails - RAILS3：to_JSON 具有多个对象并包括

> ID：12265530
> 
> 赞同：2
> 
> 时间：2012-09-04T14:22:26.933
> 
> 标签：ruby-on-rails, ruby-on-rails-3, json, activerecord, jsonp

```
def list
    @rings = Ring.order("RAND()")
    #JSON RENDERING
    render :json => @rings.to_json(:include => [:variations, :stones]), :callback => params[:callback]
end

def show
    @showring = Ring.includes(:stones, :variations).find(params[:id])
    @other_rings = Ring.select([:id, :stone_count]).where(:style_number => @showring.style_number).reject{ |ring| ring == @showring}
    #JSON RENDERING
    render :json => {@showring.to_json(:include =>[:variations, :stones]), :other_rings => @other_rings}, :callback => params[:callback]
end 
```

我的列表视图渲染工作正常，但是当我想做一个显示视图时，有两个对象，并且显示包含不会呈现正确的 JSON。它引用了对象中的所有内容，包括...

JSON 输出如下所示：

显示 => "{"available":"yes","eng...9","stone_y":"149.4"}]}"

other_rings => 正确渲染的对象

* * *

另外，如果我已经将包含添加到@rings 对象，为什么我还要在“to_json”方法中添加关联？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-09-04T14:46:27.813

当你这样做

```
render :json => {:show_ring => @showring.to_json(:include =>[:variations, :stones]), :other_rings => @other_rings} 
```

Rails 正在将@showring 转换为json（即取回字符串表示），即值是字符串文字。而是做

```
render :json => {:show_ring => @showring.as_json(:include =>[:variations, :stones]), :other_rings => @other_rings} 
```

`as_json`完成将对象转换为哈希的所有工作，但没有转换为字符串的最后一步

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-05T16:30:13.543

如果您打算投入更多时间来构建更多 JSON 对象，您应该研究一个名为 rabl 的 gem。它使构建 JSON 变得非常简单，有利于自定义，然后有利于构建 API。

# ios - 验证多 uitextfield

> ID：12265531
> 
> 赞同：1
> 
> 时间：2012-09-04T14:22:27.507
> 
> 标签：ios

我使用此代码检查文本字段是否为空。第一次，它会起作用，但是当我更改文本字段值时，警报不起作用。

```
 -(void)sendclick {
        NSString *msg;
        if(firstnametextfield.text==NULL) {
            msg=@"enter first name";
            NSLog(@"%@",firstnametextfield.text);
        }
        else if(lastnametextfield.text==NULL) {
            msg=@"enter last name"; 
            NSLog(@"%@",lastnametextfield.text);
        }

       else if(emailtextfield.text==NULL) {
             msg=@"enter email address";
            NSLog(@"%@",emailtextfield.text);
        }

       else if(companytextfield.text==NULL) {
            msg=@"enter company name";
            NSLog(@"%@",companytextfield.text);
        }

       else if(phonetextfield.text==NULL) {
            msg=@"enter phone numper"; 
            NSLog(@"%@",phonetextfield.text);
        }
     else {
        msg=@"register success fully";
        UIAlertView *alert = [[UIAlertView alloc] initWithTitle:@"Error" message:msg delegate:self cancelButtonTitle:nil otherButtonTitles:@"OK", nil];
        [alert show];
        [alert release];
     }

    } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-04T15:02:56.633

关于这段代码，有几件事需要考虑：

1.  正如其他人指出的那样，这不是检查空字符串的正确方法。
    一种。首先，如果您确实要检查未分配的字符串，则应该检查`nil`and not `NULL`。
    湾。其次，字符串也可以分配，但没有字符，所以你应该检查它是否是一个空字符串。
    C。请注意，您通常希望检查这两个条件，并执行相同的操作，因为通常情况下，就业务逻辑而言，nil 字符串和空字符串之间没有区别。
    d。最简单的方法是简单地检查`length`字符串。这是可行的，因为如果将消息发送到`nil`对象，它将返回 0，如果它是一个没有字符的实际字符串，它也将返回 0。

    **因此，类似于此的检查将起作用：**

    ```
    if([firstnametextfield.text length] == 0) 
    ```

2.  您通常**不**想像这样直接检查文本字段的值以进行表单验证。这是因为，在某些情况下（例如，当文本字段位于表格视图单元格中并滚动出屏幕时）文本字段不可用，您将无法访问存储在文本字段中的数据。

相反，您应该在输入文本后立即收集文本，方法是将文本字段的委托设置为视图控制器并实现以下功能：

```
- (void)textFieldDidEndEditing:(UITextField *)textField {
    if (textField == firstnametextfield) {
        // Store the first name in a property, or array, or something.
    }
} 
```

然后，当您准备好验证输入的信息时，请使用上面 #1 中的技术检查您存储的值，而不是实际的文本字段值本身。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-04T14:24:34.730

您不应将文本字段值与`NULL`. 而是将其与`@""`. 您也可以修剪空白字符：

```
[string stringByTrimmingCharactersInSet:[NSCharacterSet whitespaceAndNewlineCharacterSet]]; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-04T14:43:26.017

```
- (BOOL)isEmptyOrNull:(NSString*)string {
    if (string) {
        if ([string isEqualToString:@""]) {
            return YES;
        }
        return NO;
    }
    return YES;
}

-(void)sendclick {
    NSString *msg;
    if([self isEmptyOrNull:firstnametextfield.text]) {
        msg=@"enter first name";
        NSLog(@"%@",firstnametextfield.text);
    }
    .....
    .....
    ..... 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-04T14:40:25.740

尝试使用

```
if([lastnameTextField.text isEqualToString:@""])
{
 msg = @"Enter last name";
 NSLog(@"%@",lastnametextfield.text);
} 
```

这是您检查 NSString 是否为空的方式。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-04T14:41:02.587

您不能使用 == 或 != 运算符比较字符串对象。所以这里是正确的：

```
 -(void)sendclick
{
     NSString *msg;
    if([firstnametextfield.text isEqualToString:@""])
    {
        msg=@"enter first name";
        NSLog(@"%@",firstnametextfield.text);
    }
    else
        if([lastnametextfield.text isEqualToString:@""])
    {
        msg=@"enter last name"; 
        NSLog(@"%@",lastnametextfield.text);
    }

   else if([emailtextfield.text isEqualToString:@""])
    {
         msg=@"enter email address";
        NSLog(@"%@",emailtextfield.text);
    }

   else if([companytextfield.text isEqualToString:@""])
    {
        msg=@"enter company name";
        NSLog(@"%@",companytextfield.text);
    }

   else if([phonetextfield.text isEqualToString:@""])
    {
        msg=@"enter phone numper"; 
        NSLog(@"%@",phonetextfield.text);
    }
  else
  {

    msg=@"register success fully";
    UIAlertView *alert = [[UIAlertView alloc] initWithTitle:@"Error" message:msg delegate:self cancelButtonTitle:nil otherButtonTitles:@"OK", nil];
    [alert show];
    [alert release];
 }

} 
```

我希望这对你有帮助。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-12-24T12:20:09.220

```
 -(void)sendclick 
    {
        if ([self ControlValidation]==YES)
        {

 UIAlertView *alert = [[UIAlertView alloc] initWithTitle:@"Sucess" message:@"Registration done successfully" delegate: nil  cancelButtonTitle:@"OK" otherButtonTitles:nil];
            [alert  show];
        }
    }
    -(BOOL)ControlValidation
    {
        if ([self isEmpty:firstnametextfield.text ]==YES)

        {
            UIAlertView *alert = [[UIAlertView alloc] initWithTitle:@"Sorry" message:@"First Name is    empty" delegate: nil  cancelButtonTitle:@"OK" otherButtonTitles:nil];
            [alert  show];
            return NO;
        }
        if ([self isEmpty:lasttnametextfield.text ]==YES)

        {
            UIAlertView *alert = [[UIAlertView alloc] initWithTitle:@"Sorry" message:@"Last Name is empty" delegate: nil  cancelButtonTitle:@"OK" otherButtonTitles:nil];
            [alert  show];

            return NO;
        }
        return YES;
    }

    -(BOOL)isEmpty:(NSString *)str

    {
        if (str == nil || str == (id)[NSNull null] || [[NSString stringWithFormat:@"%@",str] length] == 0 || [[[NSString stringWithFormat:@"%@",str] stringByTrimmingCharactersInSet:[NSCharacterSet whitespaceAndNewlineCharacterSet]] length] == 0)
        {
            return YES;

        }

        return NO;
    } 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2016-03-23T11:34:48.320

```
 -(void)validateTextFields
        {
            if ([self Validation]==YES)
            {

 UIAlertView *alert = [[UIAlertView alloc] initWithTitle:@"Sucess" message:@"Registration done successfully" delegate: nil  cancelButtonTitle:@"OK" otherButtonTitles:nil];
            [alert  show];
        }
    }
    -(BOOL)Validation
    {
        if ([self isEmpty:firstnametextfield.text ]==YES)

    {
        UIAlertView *alert = [[UIAlertView alloc] initWithTitle:@"Sorry" message:@"First Name is    empty" delegate: nil  cancelButtonTitle:@"OK" otherButtonTitles:nil];
        [alert  show];
        return NO;
    }
    if ([self isEmpty:lasttnametextfield.text ]==YES)

    {
        UIAlertView *alert = [[UIAlertView alloc] initWithTitle:@"Sorry" message:@"Last Name is empty" delegate: nil  cancelButtonTitle:@"OK" otherButtonTitles:nil];
        [alert  show];

        return NO;
    }
if ([self isEmpty:Usernametextfield.text ]==YES)

    {
        UIAlertView *alert = [[UIAlertView alloc] initWithTitle:@"Sorry" message:@"First Name is    empty" delegate: nil  cancelButtonTitle:@"OK" otherButtonTitles:nil];
        [alert  show];
        return NO;
    }
    if ([self isEmpty:phonetextfield.text ]==YES)

    {
        UIAlertView *alert = [[UIAlertView alloc] initWithTitle:@"Sorry" message:@"Last Name is empty" delegate: nil  cancelButtonTitle:@"OK" otherButtonTitles:nil];
        [alert  show];

        return NO;
if ([self isEmpty:emailtextfield.text ]==YES)

    {
        UIAlertView *alert = [[UIAlertView alloc] initWithTitle:@"Sorry" message:@"First Name is    empty" delegate: nil  cancelButtonTitle:@"OK" otherButtonTitles:nil];
        [alert  show];
        return NO;
    }
    if ([self isEmpty:passwordtextfield.text ]==YES)

    {
        UIAlertView *alert = [[UIAlertView alloc] initWithTitle:@"Sorry" message:@"Last Name is empty" delegate: nil  cancelButtonTitle:@"OK" otherButtonTitles:nil];
        [alert  show];

        return NO;
    }
    }
    return YES;
}

-(BOOL)isEmpty:(NSString *)str

{
    if (str == nil || str == (id)[NSNull null] || [[NSString stringWithFormat:@"%@",str] length] == 0 || [[[NSString stringWithFormat:@"%@",str] stringByTrimmingCharactersInSet:[NSCharacterSet whitespaceAndNewlineCharacterSet]] length] == 0)
    {
        return YES;

    } 
```

# jquery - 通过免责声明/跟踪页面自动重定向站点上的所有出站链接，而无需单独编辑它们

> ID：12265534
> 
> 赞同：0
> 
> 时间：2012-09-04T14:22:37.197
> 
> 标签：jquery

我找到了一个代码片段，可以将出站链接传递到此链接上的免责声明脚本中：

[http://snipplr.com/view/28917/](http://snipplr.com/view/28917/)

```
$(document).ready(function() {

   // BEGIN redirect all outbound links through tracker page
   $("a").click(function(){ 

      // if it's a full URL...
      if ($(this).attr("href").indexOf("http")==0) {

         // if it doesn't go to our site
         if (!/^http(s){0,1}(.){0,3}(www){0,3}(\.){0,1}testando\.br/.test($(this).attr("href"))){

            // send it through the linkout page
            $(this).attr("href","/linkoutpage.php?p=" + $(this).attr("href"))

         }
      } 
   })
   // END redirect all outbound links through tracker page

}; 
```

但它正在通过脚本重定向所有链接。有人可以帮我吗？我正在使用域“www.testando.br”进行测试。

编辑：我试图通过脚本传递所有外部链接，而无需手动将“linkoutpage.php?p=THEURL”添加到所有链接。找到了这个脚本，但不知何故所有的链接都通过它

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-04T14:50:23.293

好吧，我会将这个脚本重写为更清晰的内容：

```
$(document).ready(function() {
  $("a").click(function() {
    var href = this.href;
    var ourDomainRegex = /^https?:\/\/(www[.])?testando[.]br/;
    // those seeking flexibility, consider this: 
    // new RegExp('^https?:\\/\\/(www[.])?'  +  ourDomain)

    if (href.indexOf("http") === 0   &&   ! ourDomainRegex.test(href) )
    {
      this.href = "/linkoutpage.php?p=" + href;
    }
  });
}); 
```

这是一个可以玩的[小提琴。](http://jsfiddle.net/j4Zts/)

不过，我找不到与您提供的代码有任何意义的区别。您确定没有 JavaScript 错误（您检查控制台是否有错误）？

# java - PropertyDescriptor 与返回值的 setter

> ID：12265537
> 
> 赞同：1
> 
> 时间：2012-09-04T14:22:55.077
> 
> 标签：java, reflection, javabeans, java-7, introspection

我必须将大量代码从 java6 移植到 java7。Java6 在设置器、返回值方面没有问题。所以这个示例代码：

```
public class Main {
public static class MyDummy {
    private String payload;

    public String getPayload() {
        return payload;
    }

    public boolean setPayload(String payload) {
        this.payload = payload;
        return true;
    }
}
public static void main(String[] args) {
    System.out.println("JAVA: " + System.getProperty("java.version") + " (" + System.getProperty("java.vm.name") + ")");
    MyDummy d = new MyDummy();
    d.setPayload("init");
    System.out.println("Value before: " + d.getPayload());

    try {
        PropertyDescriptor pd = new PropertyDescriptor("payload", MyDummy.class);
        pd.getWriteMethod().invoke(d, "hello introspection");
    } catch (Exception e) {
        System.out.println("Exception: " + e);
    }
    System.out.println("Value after: " + d.getPayload());

}
} 
```

结果在 java 6 处等待输出：

```
JAVA: 1.6.0_24 (OpenJDK 64-Bit Server VM)
Value before: init
Value after: hello introspection 
```

不幸的是（对我来说）在 java 7 输出是：

```
JAVA: 1.7.0_06 (Java HotSpot(TM) 64-Bit Server VM)
Value before: init
Exception: java.beans.IntrospectionException: Method not found: setPayload
Value after: init 
```

因此，对于 setter 来说，内省不再起作用，它返回的东西除了 void 之外的任何东西。我的问题是我该怎么办？第一个想法是将 setter 包装在 void-setter 中。像这样：

```
public void setPayload(String payload) {
    setPayloadImpl(payload); // ignoring return value
}
public boolean setPayloadImpl(String payload) {
    this.payload = payload;
    return true;
} 
```

但是这种解决方案会强制更改 setter-name（不可能通过重新运行类型重载方法）并使用此类 setter-wrappers 使源代码膨胀。你能提出一个更好的解决方案吗？

PS奇怪，它没有在[java7兼容性列表](http://www.oracle.com/technetwork/java/javase/compatibility-417013.html)中提到。

# android - 动画仅在我触摸屏幕时开始

> ID：12265552
> 
> 赞同：0
> 
> 时间：2012-09-04T14:24:04.023
> 
> 标签：android, list, animation

我有一个列表视图，其中的条目在用户删除\编辑列表中的条目时具有淡出动画。

出于某种原因，在我执行操作（编辑\删除）之后，动画将不会开始，直到我再次按下屏幕。只有他们才能真正执行动画。

从此方法调用动画：

```
public void replace(View view, long position) {
    int hoursSum = 0;
    int minuteSum = 0;
    boolean hoursIssue = false;

    if (finsihIntMinutes >= startIntMinutes) {
        minuteSum = finsihIntMinutes - startIntMinutes;

    } else if (finsihIntMinutes < startIntMinutes) {
        minuteSum = (finsihIntMinutes + Utility.MINUTES_TIME_UNIT)
                - startIntMinutes;
        hoursIssue = true;
    }

    if (finishIntHours >= startIntHours) {
        hoursSum = finishIntHours - startIntHours;
        if (hoursIssue == true) {
            --hoursSum;
        }
    } else if (finishIntHours < startIntHours) {

        hoursSum = (finishIntHours + Utility.HOURS_TIME_UNIT)
                - startIntHours;
    }

    double salper = (minuteSum * Main.sal) / 60;
    double salper2 = hoursSum * (Main.sal);
    String madeSoFar = ""
            + String.valueOf(formatter.format(salper2 + salper));
    String edited = "**Edited**";

    String totalTime = "" + hoursSum + ":" + minuteSum;

    DB.edit(position, Shifts.editDate, Shifts.editStartTime,
            Shifts.editEndTime, Shifts.dayString, totalTime, minuteSum,
            madeSoFar, edited, totalHours, totalMinutes);

    moneySummary = getMoney();
    hoursSummary = "Total Hours: " + getHours();
    summary.setText(moneySummary);

    **FastScrollAdapter.animate(Shifts.view);**

} 
```

这是动画代码：

```
public static void animate(final View v) {

    Animation out = new AlphaAnimation(1, 0);
    out.setInterpolator(new DecelerateInterpolator());
    out.setDuration(350);
    v.setAnimation(out);
    out.start();
    out.setAnimationListener(new AnimationListener() {

        @Override
        public void onAnimationStart(Animation animation) {
            Log.i("Animation", "Started");
        }

        @Override
        public void onAnimationRepeat(Animation animation) {

            // Shifts.setSummaryCursor.requery();
            Shifts.getMoneyCursor.requery();
            FastScrollAdapter.cursor.requery();
            Shifts.CA.notifyDataSetChanged();

        }

        @Override
        public void onAnimationEnd(Animation animation) {

            // Shifts.setSummaryCursor.requery();
            Shifts.getMoneyCursor.requery();
            FastScrollAdapter.cursor.requery();
            Shifts.CA.notifyDataSetChanged();
            Log.i("Animation", "Ended");

        }
    });

} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-06-12T00:04:45.867

我遇到了完全相同的问题，我通过调用解决了它

```
view.clearAnimation(); 
```

就在之前

```
view.startAnimation(animation); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-17T15:37:44.837

我有一个类似的问题：动画没有在 UE 线程中执行。尝试运行在 UE 主题中发布的动画：

```
 mHandler.post(new Runnable() {
                @Override
                public void run() {
                    yourView.startAnimation(yourAnimation));
                }
            }); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-04T14:59:48.320

我认为您需要更改订单

```
1\. v.setAnimation(out);
2\. out.setAnimationListener(new AnimationListener()); 
3\. v.startAnimation(out); 
```

# jquery - jQuery 和 CSS 将绝对 div 设置为屏幕中心（检测屏幕分辨率）

> ID：12265553
> 
> 赞同：1
> 
> 时间：2012-09-04T14:24:06.510
> 
> 标签：jquery, css, position

我想创建一个包含登录表单（或其他功能）的新层，并且我想将它显示在屏幕的中心（取决于屏幕的分辨率和内容）。

**这是代码：**

```
 function new_layer() {
    $('#frameContainer, #showbox').show();
    $('#showbox').load('includes/login.php');
    $(document).ready(function(){
        var hei = eval($(window).height()/2 - $('#showbox > *').outerHeight()/2);
        var wid = eval($(window).width()/2 - $('#showbox > *').outerWidth()/2);
        $('#showbox').css({
          top: hei + "px",
          left: wid + "px"
        }).show();
    });

    // .................. 
```

第一次不行，文件`login.php`内容居中 :( ，但是当我点击外面隐藏它，然后再次点击，它工作。当我刷新页面时，问题再次出现。

有什么问题，我该如何解决？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-04T14:31:31.527

您不需要为此进行 JS 计算：

```
#loginDialog {
    height: 300px;
    width: 400px;
    position: absolute;
    top: 50%;
    left: 50%;
    margin-top: -150px; /* half of the height */
    margin-left: -200px; /* half of the width */
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-04T14:27:56.033

```
$(function(){
var loginDialog = $('#loginDialog');

    $.blockUI();
    var dlgWidth = loginDialog.outerWidth();
    var viewPortWidth = $(window).width();
    var pos = (viewPortWidth - dlgWidth ) / 2;
    loginDialog.css({

        'position', 'absolute',
        'left' :  pos + 'px',
        'z-index' : '1999' //greater than setting for blockUI
    });

}); 
```

更多关于[blockUI 的信息在这里](http://www.malsup.com/jquery/block/)

# python-2.7 - 在 Python 中计算总成本

> ID：12265558
> 
> 赞同：0
> 
> 时间：2012-09-04T14:24:19.657
> 
> 标签：python-2.7

我正在尝试在 python 中创建一个旅行计划器，但是在我定义了所有函数之后，我无法在最后一个函数中调用和计算它们`tripCost()`。

在tripCost 中，我想输入日期和旅行目的地（城市），程序运行这些函数并为我提供先前定义的所有3 个函数的确切结果。

**代码：**

```
def hotelCost(): 
    days = raw_input ("How many nights will you stay at the hotel?")
    total = 140 * int(days) print "The total cost is",total,"dollars"

def planeRideCost(): 
    city = raw_input ("Wich city will you travel to\n")
    if city == 'Charlotte':
        return "The cost is 183$"
    elif city == 'Tampa':
        return "The cost is 220$"
    elif city == 'Pittsburgh':
        return "The cost is 222$"
    elif city == 'Los Angeles':
        return "The cost is 475$"
    else:
        return "That's not a valid destination"

def rentalCarCost(): 
    rental_days = raw_input ("How many days will you rent the car\n")   
    discount_3 = 40 * int(rental_days) * 0.2 
    discount_7 = 40 * int(rental_days) * 0.5 
    total_rent3 = 40 * int(rental_days) - discount_3
    total_rent7 = 40 * int(rental_days) - discount_7
    cost_day = 40 * int(rental_days) 

    if int(rental_days) >= 3: 
        print "The total cost is", total_rent3, "dollars"
    elif int(rental_days) >= 7: 
        print "The total cost is", total_rent7, "dollars"
    else: 
        print "The total cost is", cost_day, "dollars"

def tripCost():
    travel_city = raw_input ("What's our destination\n")
    days_travel = raw_input ("\nHow many days will you stay\n")
    total_trip_cost = hotelCost(int(day_travel)) + planeRideCost (str(travel_city)) + rentalCost (int(days_travel))
    return "The total cost with the trip is", total_trip_cost

tripCost() 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-04T14:29:34.837

1.  你 `def rentalCarCost():`什么都没回来..
2.  `rentalCost (int(days_travel))`我看不到这样的功能。

更新：

```
def hotelCost(): 
    days = raw_input ("How many nights will you stay at the hotel?")
    total = 140 * int(days) print "The total cost is",total,"dollars"
    return total

def planeRideCost(): 
    city = raw_input ("Wich city will you travel to\n")
    if city == 'Charlotte':
        return 183
    elif city == 'Tampa':
        return 220
    elif city == 'Pittsburgh':
        return 222
    elif city == 'Los Angeles':
        return 475
    else:
        print "That's not a valid destination"

def rentalCarCost(): 
    rental_days = raw_input ("How many days will you rent the car\n")   
    discount_3 = 40 * int(rental_days) * 0.2 
    discount_7 = 40 * int(rental_days) * 0.5 
    total_rent3 = 40 * int(rental_days) - discount_3
    total_rent7 = 40 * int(rental_days) - discount_7
    cost_day = 40 * int(rental_days) 

    if int(rental_days) >= 3: 
        print "The total cost is", total_rent3, "dollars"
        return total_rent3
    elif int(rental_days) >= 7: 
        print "The total cost is", total_rent7, "dollars"
        return total_rent7
    else: 
        print "The total cost is", cost_day, "dollars"
        return cost_day

def tripCost():
    travel_city = raw_input ("What's our destination\n")
    days_travel = raw_input ("\nHow many days will you stay\n")
    total_trip_cost = hotelCost(int(day_travel)) + planeRideCost () + rentalCarCost(int(days_travel))
    return "The total cost with the trip is", total_trip_cost

tripCost() 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-12-22T13:04:07.920

我建议您将用户交互与计算分开。我做了一些更改，并将其粘贴为示例，我并不是说这段代码对您的问题做了正确的事情，只是为了说明这种分离。您还可以将 cost_table 用作字典：

```
cost_table = {
    'Charlotte':183,
    'Tampa':220,
    'Pittsburgh':222,
    'Los Angeles':475
    }

def hotel_cost(nights): 
    cost = 140 * int(nights)
    return cost

def plane_ride_cost(city):
    return cost_table[city]

def rental_car_cost(days): 
    discount_3 = 40 * days * 0.2 
    discount_7 = 40 * days * 0.5 
    total_rent3 = 40 * days - discount_3
    total_rent7 = 40 * days - discount_7
    cost_day = 40 * days 

    if days >= 3:
        return total_rent3
    elif days >= 7:
        return total_rent7
    else: 
        return cost_day

def trip_cost(city, nights, car_days):
    total = hotel_cost(nights) + plane_ride_cost(city) +\
            rental_car_cost(car_days)
    return total

city = None
while True:
    city = raw_input ("What's our destination?\n")
    if city not in cost_table:
        print "That's not a valid destination."
    else:
        break

hotel_nights = raw_input ("\nHow many nights will you stay?\n")
car_days = raw_input ("How many days will you rent the car?\n")   

total_trip_cost = hotel_cost(int(hotel_nights)) +\
                  plane_ride_cost(city) +\
                  rental_car_cost(int(car_days))

print "The total cost with the trip is", total_trip_cost, "dollars." 
```

# php - Mysql 与 LIMIT 函数混淆

> ID：12265559
> 
> 赞同：1
> 
> 时间：2012-09-04T14:24:23.763
> 
> 标签：php, mysql, codeigniter

我在 MySQL 中使用以下 SQL 查询。

```
"SELECT SUBSTRING(invoices.dateCreated, 1, 7) AS month, 
        account.name AS accountName, 
        account.id AS accountId, 
        invoices.invId AS invoiceId, 
        productType.title AS productTitle, 
        sum(invoiceItems.cost*invoiceItems.quantity) AS totalValue,
        sum(invoiceItems.quantity) AS totalQuantity
 FROM account LEFT JOIN invoices ON invoices.accountId = account.id
          LEFT JOIN invoiceItems ON invoices.id = invoiceItems.invoiceId
      LEFT JOIN productType ON invoiceItems.productTypeId = productType.id
 WHERE invoices.statusId != 'S62FD452B1D4'
 GROUP BY invoiceItems.productTypeId, invoices.invId   
 ORDER BY month DESC, accountName ASC, invoices.id ASC    
 LIMIT ".$start_limit.", ".$records_per_page.";" 
```

如果没有限制查询的部分，这可以正常工作。但是，当我添加限制部分时，变量`$start_limit`&`$records_per_page`没有值，而如果我将变量周围的线插入到查询中。当我将变量周围的引号更改为`'.$start_limit.'`. 但是，查询似乎不适用于此。

任何关于我做错了什么的建议或帮助将不胜感激。

这两个变量的值是 100% 肯定被传入的。在这个例子中，它们很简单，开始限制 = 0 和结束限制（每页） = 50。我检查过，50 远低于限制。

问题是当我看到 SQL 错误弹出时它说：

```
SELECT SUBSTRING(invoices.dateCreated, 1, 7) AS month, 
       account.name AS accountName, 
       account.id AS accountId, 
       invoices.invId AS invoiceId, 
       productType.title AS productTitle, 
       sum(invoiceItems.cost*invoiceItems.quantity) AS totalValue,
       sum(invoiceItems.quantity) AS totalQuantity 
FROM account LEFT JOIN invoices ON invoices.accountId = account.id 
             LEFT JOIN invoiceItems ON invoices.id = invoiceItems.invoiceId 
             LEFT JOIN productType ON invoiceItems.productTypeId = productType.id 
WHERE invoices.statusId != 'S62FD452B1D4' 
GROUP BY invoiceItems.productTypeId, invoices.invId 
ORDER BY month DESC, accountName ASC, invoices.id ASC 
LIMIT , ; 
```

如果我改变周围的东西，看看变量是否在那里，我们会得到：

```
SELECT SUBSTRING(invoices.dateCreated, 1, 7) AS month, 
       account.name AS accountName, 
       account.id AS accountId, 
       invoices.invId AS invoiceId, 
       productType.title AS productTitle, 
       sum(invoiceItems.cost*invoiceItems.quantity) AS totalValue, 
       sum(invoiceItems.quantity) AS totalQuantity 
FROM account LEFT JOIN invoices ON invoices.accountId = account.id 
             LEFT JOIN invoiceItems ON invoices.id = invoiceItems.invoiceId 
             LEFT JOIN productType ON invoiceItems.productTypeId = productType.id 
WHERE invoices.statusId != 'S62FD452B1D4' 
GROUP BY invoiceItems.productTypeId, invoices.invId 
ORDER BY month DESC, accountName ASC, invoices.id ASC 
LIMIT '.0.', '.50.' ; 
```

这些值都不是用户提供的。所以这不是太大的问题。我不确定为什么变量在这个来自数百个类似 1 的查询中表现异常，我已经做了同样的事情。唯一的区别是分组和排序的数量。这会有所作为吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-04T14:28:12.177

如果`$start_limit`和/或`$records_per_page`无人居住，您将遇到问题。但是，如果您希望在将它们放入查询之前将它们默认为标准值：

```
// default them values to 0 and 50
$start_limit = empty($start_limit) ? 0 : $start_limit;
$records_per_page = empty($records_per_page) ? 50 : $records_per_page;
// may also want to check (empty(...) || $var < 0 || $var > $threshold) as well. 
```

然后开始你的业务：

```
$sql = "SELECT " . /* ... */ " LIMIT " . $start_limit . "," . $records_per_page; 
```

我应该注意，如果其中一个（或两者）是用户提供的（或者用户有机会更改这些值），我会先对它们进行清理，然后再将它们放入查询中。例如

```
$start_limit = (int) $_REQUEST['start_limit'];
if ($start_limit < 0) // can't be <0
  $start_limit = 0;

$records_per_page = (int) $_REQUEST['records_per_page'];
if ($records_per_page < 10) // can't be <10
  $records_per_page = 10;
else if ($records_per_page > 100) // can't be >100
  $records_per_page = 100; 
```

然后，您要确保`$start_limit`不包含任何具有威胁性的内容，例如`;SELECT password FROM admin_table;`. （[SQL注入](http://en.wikipedia.org/wiki/SQL_injection)）

*不过，您的问题有点模棱两可，因此，如果我偏离轨道，请更新问题，我的回答也会如此*

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-04T14:27:45.523

`$start_limit`和的值`$records_per_page`可能无效或超出范围。也许尝试记录它们以确定。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-04T14:33:28.773

您可以为此使用 PDO 扩展吗？

您的代码容易发生 SQL 注入。使用 PDO 或 MySQLi 扩展。

使用 PDO 扩展的示例：

```
<?php

    $query = "SELECT SUBSTRING(invoices.dateCreated, 1, 7) AS month, account.name AS accountName, account.id AS accountId, invoices.invId AS invoiceId, productType.title AS productTitle, sum(invoiceItems.cost*invoiceItems.quantity) AS totalValue, sum(invoiceItems.quantity) AS totalQuantity
             FROM account
             LEFT JOIN invoices ON invoices.accountId = account.id
             LEFT JOIN invoiceItems ON invoices.id = invoiceItems.invoiceId
             LEFT JOIN productType ON invoiceItems.productTypeId = productType.id
             WHERE invoices.statusId != 'S62FD452B1D4'
             GROUP BY invoiceItems.productTypeId, invoices.invId   
             ORDER BY month DESC, accountName ASC, invoices.id ASC    
             LIMIT ?, ?;"

    $stmt = $dbh->prepare($query);
    $stmt->bindParam(1, $start_limit, PDO::PARAM_INT);
    $stmt->bindParam(2, $records_per_page, PDO::PARAM_INT);

    $stmt->execute();
    // other codes here

?> 
```

# python - 限制 websocket 连接的首选方法是什么？

> ID：12265561
> 
> 赞同：1
> 
> 时间：2012-09-04T14:24:28.973
> 
> 标签：python, websocket, eventlet

我有一个网络应用程序，我在其中将模型更改流式传输到 chrome 客户端中的主干集合。有一些主干视图可能会或可能不会呈现页面的某些部分，具体取决于更新的类型和正在查看的内容。例如，对模型的某些更改会导致重新渲染集合的视图，并且可能会或可能不会为正在更新的模型打开详细信息面板视图。这些模型更改可能发生得非常快，因为服务器端工作流程涉及对模型的非常冗长和快速的更改。

这是问题所在：当向客户端发送消息时，我在网络服务器的进程中收到大量 errno 32 管道损坏消息，尽管 websocket 连接仍然处于打开状态并且它`readyState`仍然是 1（打开）。

我怀疑正在发生的事情是，`onmessage`当下一条消息进来时，各种视图还没有在回调中完成渲染。在我在标准输出中获得这些回溯后，websocket 连接仍然可以工作，并且 UI 仍然会更新。

如果我放入`eventlet.sleep(0.02)`从消息队列中读取模型更改并将它们发送到 websocket 的循环中，那么损坏的管道消息就会消失，但这不是一个真正的解决方案，感觉就像一个讨厌的 hack。

有没有人对 websocket 的功能有类似的问题，`onmessage`试图做太多的工作并且在下一条消息进来时仍然很忙？有人有解决方案吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-04T15:12:55.190

我认为最有效的方法是客户端应用程序告诉服务器它们正在显示什么。服务器对此进行跟踪并仅将更改发送到当前查看的对象，仅发送给相关的客户端。

一种方法是使用“谁看什么”项目列表。项目以两种方式编制索引。从客户端 ID 和每个数据对象内部的 isVievedBy 链表（我知道将它与数据混合看起来并不干净，但它非常有效）。您还需要每个数据对象的 lastupdate 时间戳。

当客户端更改视图时，它会向服务器发送“我正在查看这个，我有版本-时间戳-”消息。服务器检查时间戳并在需要时发回对象。它还删除过时的“Who Watch What”（通过客户端 ID 访问它们）项目并创建新项目。

当一个数据对象被更新时，遍历这个对象的 isVievedBy 链表来知道应该更新哪个客户端。将其放入每个客户端的消息缓冲区并手动刷新这些缓冲区（如果您同时更新多个项目，它将发送一条大消息）。

这是很多工作，但您的应用程序将是高效的并且可以优雅地扩展，即使有很多对象和很多客户端。它只发送有用的消息，而且不太可能有太多的消息。

对于您的 onMessage 问题，我会将数据存储在队列中并异步处理它们。

# php - 如何使用 ORACLE(OCI) 在 SQL/PHP 中进行更新查询

> ID：12265562
> 
> 赞同：3
> 
> 时间：2012-09-04T14:24:30.020
> 
> 标签：php, sql, ajax, oracle, oracle-call-interface

我是 Oracle 的新手，并且将 OCI 与 PHP 一起使用。在我尝试做一个更新声明之前，我一直做得很好。

```
include("ORCLconfig.php");

$updateTitleInserted = oci_parse($conn, "UPDATE insured SET INSURED_TITLE=
'$updateTitle' WHERE INSURED_ID='$INSURED_ID'");

oci_execute($updateTitleInserted, OCI_COMMIT_ON_SUCCESS); 

oci_free_statement($updateTitleInserted); 

oci_close($conn); 
```

我要做的就是更新语句，以便用户可以更改一个人的标题。我正在使用 AJAX 异步执行此操作，当用户尝试将标题更改为当前值时，它会很好地处理函数，但如果新值不同，它会卡在更新语句中并且没有进行任何更改。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-07-09T14:27:59.657

```
$c = oci_connect($userName, $password, "(DESCRIPTION=(ADDRESS_LIST = (ADDRESS = (PROTOCOL = TCP)(HOST =$serverName)(PORT = 1521)))(CONNECT_DATA=(SID=$databaseName)))");
$strQuery = "UPDATE table SET field = :xx WHERE ID = 123"
  $stmt = OCIParse($c, $strQuery);

    OCIBindByName($stmt, ':xx', $fieldval);

      $ok = OCIExecute($stmt); 
```

试试这个

# javascript - AngularJS 承诺在数据加载之前解决

> ID：12265565
> 
> 赞同：9
> 
> 时间：2012-09-04T14:24:41.017
> 
> 标签：javascript, ajax, angularjs

在我的应用程序中，我必须在页面加载之前获取一些 JSON 数据并将其分配给一个数组。这是我使用 CardService 服务获取 JSON 的代码：

```
cards = [];

var cs = {
...
fetchCards: function() {
      var d = $q.defer();
      $http.get("data/cards.php").success(function(data) {
                      cards = data;
                      d.resolve();
                }).error(function(data, status) {
                      d.reject(status);        
                 });
               return d.promise;
      },
getCards: function() { return cards; };
...
} 
```

在控制器的解析块中，我有以下内容：

```
WalletController.resolve = {
        getCards: function(CardService) {
                CardService.fetchCards().then(loadView, showError);
        }
} 
```

在实际控制器中，我有以下内容：

```
function WalletController($scope, CardService) {
    $scope.cards = CardService.getCards();
} 
```

问题是，服务中的 fetchCards 函数似乎在将 JSON 数据分配给卡变量之前解决了承诺。这导致我的视​​图加载空白数据，直到我刷新几次并走运。

我可以确认延迟加载，因为当我在控制台中记录卡变量时，我在第 122 行（加载我的视图时）得到一个空数组，在第 57 行（当 JSON 调用成功时）得到一个完整数组。第 57 行的代码在视图加载*后以某种方式执行。*

我该如何解决？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-09-05T18:11:35.887

我没有使用过`resolve`，但我把它扔在那里以防万一您遇到的问题与绑定到从服务返回的数组有关。

如果您`cards`从服务返回数组并在 UI 中绑定到它，您可能希望尝试填充相同的数组而不是设置`cards = data;`（这将使用未绑定到 UI 的新数组覆盖本地卡片）。

就像是：

```
fetchCards: function() {
      var d = $q.defer();
      $http.get("data/cards.php").success(function(data) {
                      cards.length = 0;
                      for(var i = 0; i < data.length; i++){
                          cards.push(data[i]);
                      }
                      d.resolve();
                }).error(function(data, status) {
                      d.reject(status);        
                 });
               return d.promise;
      }, 
```

请参阅[此小提琴](http://jsfiddle.net/Gloopy/76fVm/)以获取我要描述的工作示例。多次单击第一个按钮将更新视图，但是一旦单击第二个按钮，绑定将被破坏。

两者的主要区别在于：

1.  第一个按钮使用`data.length = 0`并`data.push()`保留原始数组的引用
2.  `data`第二个按钮使用新的数组引用覆盖原始数组引用`data = newArray`

* * *

**更新：**另外，正如下面提到的 Mark Rajcok，您可以使用[angular.copy](http://docs.angularjs.org/api/angular.copy)来保留原始数组的引用，方法是清空它并从源中添加新的引用，如下所示：

```
fetchCards: function() {
      var d = $q.defer();
      $http.get("data/cards.php").success(function(data) {
                      angular.copy(data, cards);
                      d.resolve();
                }).error(function(data, status) {
                      d.reject(status);        
                 });
               return d.promise;
      }, 
```

# java - 寻找java .pdb 文件，分析一个crash hdmp 文件

> ID：12265573
> 
> 赞同：2
> 
> 时间：2012-09-04T14:24:56.613
> 
> 标签：java, windbg, crash-dumps, jvm-crash

我正在尝试分析包含 java 崩溃的 .hdmp 文件（Windows 崩溃转储）。我看到堆栈转储崩溃和所有 dll/模块，但不是 java 的，例如（jvm、nio 等）。

当我使用 windbg 或 Visual Studio 时，它会提示缺少 jdk/jre 中不存在的 java 符号/.pdb 文件。我在互联网上看到了一些关于获得我找不到的**调试jdk 版本的答案。**

任何人都知道我怎样才能获得 java .pdb 文件？或者在没有这些的情况下以其他方式分析这个文件？

**这是分析 -v**

```
windbg -z foo.hdmp
SRV*c:\symbols*http://msdl.microsoft.com/download/symbols
The stored exception information can be accessed via .ecxr.
!analyze -v
APPLICATION_FAULT_STATUS_HEAP_CORRUPTION_AFTER_CALL

Microsoft (R) Windows Debugger Version 6.2.8400.0 AMD64
Copyright (c) Microsoft Corporation. All rights reserved.

Loading Dump File [D:\oded\appcrash\WER24CD.tmp.hdmp]
User Mini Dump File: Only registers, stack and portions of memory are available

Symbol search path is: SRV*c:\symbols*http://msdl.microsoft.com/download/symbols
Executable search path is:
Windows 7 Version 7600 MP (8 procs) Free x64
Product: Server, suite: Enterprise TerminalServer SingleUserTS
Machine Name:
Debug session time: Mon Jun  4 22:42:31.000 2012 (UTC + 3:00)
System Uptime: 76 days 3:25:16.239
Process Uptime: 0 days 8:44:33.000
.............................................
This dump file has an exception of interest stored in it.
The stored exception information can be accessed via .ecxr.
(25c8.12b0): Unknown exception - code c0000374 (first/second chance not available)
ntdll!NtWaitForSingleObject+0xa:
00000000`77a5f6fa c3              ret
0:077> !analyze -v
*******************************************************************************
*                                                                             *
*                        Exception Analysis                                   *
*                                                                             *
*******************************************************************************

*** ERROR: Symbol file could not be found.  Defaulted to export symbols for nio.dll -
*** ERROR: Symbol file could not be found.  Defaulted to export symbols for jvm.dll -
*** ERROR: Module load completed but symbols could not be loaded for java.exe
*** ERROR: Symbol file could not be found.  Defaulted to export symbols for net.dll -
*** ERROR: Symbol file could not be found.  Defaulted to export symbols for java.dll -

FAULTING_IP:
ntdll!RtlReportCriticalFailure+62
00000000`77ad6ab2 eb00            jmp     ntdll!RtlReportCriticalFailure+0x64 (00000000`77ad6ab4)

EXCEPTION_RECORD:  ffffffffffffffff -- (.exr 0xffffffffffffffff)
ExceptionAddress: 0000000077ad6ab2 (ntdll!RtlReportCriticalFailure+0x0000000000000062)
   ExceptionCode: c0000374
  ExceptionFlags: 00000001
NumberParameters: 1
   Parameter[0]: 0000000077b4d430

PROCESS_NAME:  java.exe

ERROR_CODE: (NTSTATUS) 0xc0000374 - A heap has been corrupted.

EXCEPTION_CODE: (NTSTATUS) 0xc0000374 - A heap has been corrupted.

EXCEPTION_PARAMETER1:  0000000077b4d430

NTGLOBALFLAG:  0

APPLICATION_VERIFIER_FLAGS:  0

APP:  java.exe

LAST_CONTROL_TRANSFER:  from 0000000077ad7176 to 0000000077ad6ab2

FAULTING_THREAD:  ffffffffffffffff

BUGCHECK_STR:  APPLICATION_FAULT_STATUS_HEAP_CORRUPTION_AFTER_CALL

PRIMARY_PROBLEM_CLASS:  STATUS_HEAP_CORRUPTION_AFTER_CALL

DEFAULT_BUCKET_ID:  STATUS_HEAP_CORRUPTION_AFTER_CALL

STACK_TEXT: 
00000000`59fef390 00000000`77ad7176 : 00000000`00000002 00000008`00000023 00000000`00000000 00000007`00000003 : ntdll!RtlReportCriticalFailure+0x62
00000000`59fef460 00000000`77ad84a2 : 00000000`5578d000 00000000`5578d000 00000007`1e5a91c8 00000000`59fef660 : ntdll!RtlpReportHeapFailure+0x26
00000000`59fef490 00000000`77ad9e34 : 00000000`525d0000 00000000`00000000 00000000`00000000 00000008`00000003 : ntdll!RtlpHeapHandleError+0x12
00000000`59fef4c0 00000000`77a7c05d : 00000000`66ff4fc0 00000000`525d0000 00000000`66ff4fd0 00000000`5578d000 : ntdll!RtlpLogHeapFailure+0xa4
00000000`59fef4f0 000007fe`ff306db6 : 00000000`0000225c 00000000`66ff4fd0 00000000`66ff4fd0 000007fe`ff30353b : ntdll! ?? ::FNODOBFM::`string'+0x11e74
00000000`59fef570 000007fe`ff306d93 : 00000000`00000007 00000000`8004667e 00000000`0000225c 00000000`00000004 : ws2_32!DSOCKET::`scalar deleting destructor'+0x16
00000000`59fef5a0 000007fe`ff310ad3 : 00000000`0000225c 00000000`526472a0 00000000`59fef718 00000000`00000004 : ws2_32!DSOCKET::DestroyDSocket+0x13
00000000`59fef5d0 000007fe`ff305312 : 00000007`1e5a9200 00000000`59fef760 00000000`5578d1d0 00000000`0000225c : ws2_32!alloca_probe+0x46e0
00000000`59fef660 00000000`6d6c28e3 : 00000002`1907e440 00000000`007083d7 00000001`00000401 00000001`00000000 : ws2_32!ioctlsocket+0x32
00000000`59fef6c0 00000000`029575f3 : 00000007`1e5a91c8 00000002`19081008 00000001`18c2c480 00000000`00000001 : nio!Java_sun_nio_ch_IOUtil_configureBlocking+0x5b
00000000`59fef700 00000007`1e5a91c8 : 00000002`19081008 00000001`18c2c480 00000000`00000001 00000007`1e5a9198 : 0x29575f3
00000000`59fef708 00000002`19081008 : 00000001`18c2c480 00000000`00000001 00000007`1e5a9198 00000000`02def73c : 0x00000007`1e5a91c8
00000000`59fef710 00000001`18c2c480 : 00000000`00000001 00000007`1e5a9198 00000000`02def73c 00000000`000003e8 : 0x00000002`19081008
00000000`59fef718 00000000`00000001 : 00000007`1e5a9198 00000000`02def73c 00000000`000003e8 00000000`02634ed5 : 0x00000001`18c2c480
00000000`59fef720 00000007`1e5a9198 : 00000000`02def73c 00000000`000003e8 00000000`02634ed5 00000002`19498520 : 0x1
00000000`59fef728 00000000`02def73c : 00000000`000003e8 00000000`02634ed5 00000002`19498520 00000000`59fef7a0 : 0x00000007`1e5a9198
00000000`59fef730 00000000`000003e8 : 00000000`02634ed5 00000002`19498520 00000000`59fef7a0 00000001`18c2c480 : 0x2def73c
00000000`59fef738 00000000`02634ed5 : 00000002`19498520 00000000`59fef7a0 00000001`18c2c480 00000002`1907bca8 : 0x3e8
00000000`59fef740 00000002`19498520 : 00000000`59fef7a0 00000001`18c2c480 00000002`1907bca8 00000007`1e5a9218 : 0x2634ed5
00000000`59fef748 00000000`59fef7a0 : 00000001`18c2c480 00000002`1907bca8 00000007`1e5a9218 00000000`02d514e4 : 0x00000002`19498520
00000000`59fef750 00000001`18c2c480 : 00000002`1907bca8 00000007`1e5a9218 00000000`02d514e4 00000002`1907bbd0 : 0x59fef7a0
00000000`59fef758 00000002`1907bca8 : 00000007`1e5a9218 00000000`02d514e4 00000002`1907bbd0 00000002`4320f795 : 0x00000001`18c2c480
00000000`59fef760 00000007`1e5a9218 : 00000000`02d514e4 00000002`1907bbd0 00000002`4320f795 00000000`4320f7ba : 0x00000002`1907bca8
00000000`59fef768 00000000`02d514e4 : 00000002`1907bbd0 00000002`4320f795 00000000`4320f7ba 00000007`1e5a8f90 : 0x00000007`1e5a9218
00000000`59fef770 00000002`1907bbd0 : 00000002`4320f795 00000000`4320f7ba 00000007`1e5a8f90 00000007`00000000 : 0x2d514e4
00000000`59fef778 00000002`4320f795 : 00000000`4320f7ba 00000007`1e5a8f90 00000007`00000000 00000007`1e5a92a8 : 0x00000002`1907bbd0
00000000`59fef780 00000000`4320f7ba : 00000007`1e5a8f90 00000007`00000000 00000007`1e5a92a8 00000000`e3cb5255 : 0x00000002`4320f795
00000000`59fef788 00000007`1e5a8f90 : 00000007`00000000 00000007`1e5a92a8 00000000`e3cb5255 00000007`1e5a9218 : 0x4320f7ba
00000000`59fef790 00000007`00000000 : 00000007`1e5a92a8 00000000`e3cb5255 00000007`1e5a9218 00000000`00000001 : 0x00000007`1e5a8f90
00000000`59fef798 00000007`1e5a92a8 : 00000000`e3cb5255 00000007`1e5a9218 00000000`00000001 00000000`4329305b : 0x00000007`00000000
00000000`59fef7a0 00000000`e3cb5255 : 00000007`1e5a9218 00000000`00000001 00000000`4329305b 00000002`19497a88 : 0x00000007`1e5a92a8
00000000`59fef7a8 00000007`1e5a9218 : 00000000`00000001 00000000`4329305b 00000002`19497a88 00000000`01d189f8 : 0xe3cb5255
00000000`59fef7b0 00000000`00000001 : 00000000`4329305b 00000002`19497a88 00000000`01d189f8 01cd428a`2c12330a : 0x00000007`1e5a9218
00000000`59fef7b8 00000000`4329305b : 00000002`19497a88 00000000`01d189f8 01cd428a`2c12330a 00000000`00000000 : 0x1
00000000`59fef7c0 00000002`19497a88 : 00000000`01d189f8 01cd428a`2c12330a 00000000`00000000 00000002`19497bc0 : 0x4329305b
00000000`59fef7c8 00000000`01d189f8 : 01cd428a`2c12330a 00000000`00000000 00000002`19497bc0 00000007`18038448 : 0x00000002`19497a88
00000000`59fef7d0 01cd428a`2c12330a : 00000000`00000000 00000002`19497bc0 00000007`18038448 4320f726`3f400000 : 0x1d189f8
00000000`59fef7d8 00000000`00000000 : 00000002`19497bc0 00000007`18038448 4320f726`3f400000 00000007`1e5a9170 : 0x01cd428a`2c12330a

FOLLOWUP_IP:
ws2_32!DSOCKET::DestroyDSocket+13
000007fe`ff306d93 4883c428        add     rsp,28h

SYMBOL_STACK_INDEX:  2

SYMBOL_NAME:  ws2_32!DSOCKET::DestroyDSocket+13

FOLLOWUP_NAME:  MachineOwner

MODULE_NAME: ws2_32

IMAGE_NAME:  ws2_32.dll

DEBUG_FLR_IMAGE_TIMESTAMP:  4a5be095

STACK_COMMAND:  ~77s; .ecxr ; kb

FAILURE_BUCKET_ID:  STATUS_HEAP_CORRUPTION_AFTER_CALL_c0000374_ws2_32.dll!DSOCKET::DestroyDSocket

BUCKET_ID:  X64_APPLICATION_FAULT_STATUS_HEAP_CORRUPTION_AFTER_CALL_ws2_32!DSOCKET::DestroyDSocket+13

WATSON_STAGEONE_URL:  http://watson.microsoft.com/StageOne/java_exe/6_0_270_7/4e253d37/ntdll_dll/6_1_7600_16695/4cc7b325/c0000374/000c6ab2.htm?Retriage=1 
```

我怀疑 NIO 或 Jetty 是导致此崩溃的原因，我希望能够读取丢失的堆栈行（位于此行下：nio！Java_sun_nio_ch_IOUtil_configureBlocking+0x5b），以了解哪个类/函数正在调用它，请参阅: 错误: 找不到符号文件..

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-01-26T16:51:41.010

您可以尝试[OpenJDK](http://openjdk.java.net/)的调试版本。它有用于 Windows 构建的*[pdb文件。](http://en.wikipedia.org/wiki/Program_database)*但是，这些构建不是官方的，可能无法重现您得到的确切错误。

[https://github.com/alexkasko/openjdk-unofficial-builds](https://github.com/alexkasko/openjdk-unofficial-builds)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-08-13T06:15:35.707

您可以使用 IBM SDK 获取 java pdb 文件并将 JAVA_HOME 设置为从 IBM SDK 指向 JDK

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-09T09:43:39.173

您只能联系 Oracle 支持，看看他们是否可以提供帮助，

[https://forums.oracle.com/forums/thread.jspa?messageID=10080305](https://forums.oracle.com/forums/thread.jspa?messageID=10080305)

似乎没有可用的公共符号文件。

# django - 当多类用户扩展 BaseProfile 时如何在模板中访问 Django 注册数据

> ID：12265576
> 
> 赞同：1
> 
> 时间：2012-09-04T14:25:04.293
> 
> 标签：django, django-templates, django-registration, django-users

好的，所以我是 Django 的新手（并且通常进行编程，并且我正在构建一个需要多种用户类型的网站。我创建了一个我在 AUTH_PROFILE_MODULE 中拥有的基类，并且从基类继承了不同的用户类型。我的问题是如何访问从模板中继承自基类的类保存的数据。我知道我可以将 user.get_profile.field 用于基类中的任何内容，但它不适用于字段我在基类之外。如果你能看到我的代码，可能会更容易理解......

模型.py

```
class BaseProfile(models.Model):
    user = models.ForeignKey(User, unique=True)
    #Other common fields
    ...

class StudentProfile(BaseProfile):
    user_type = models.CharField(max_length=20, default="student")
    #Other student specific fields
    ...

class InstructorProfile(BaseProfile):
    user_type = models.CharField(max_length=20, default="instructor")
    #Other instructor specific fields
    ... 
```

设置.py

```
AUTH_PROFILE_MODULE = 'signup.BaseProfile' 
```

我有针对教师和学生的单独表格，并且每个表格中都有 user_type 作为 HiddenInput 字段，因此用户无法更改它，因此它默认为我想要的。我还设置了我的信号以适应我需要的不同表单信息。我可以在管理员中看到我的信号将成功地将 user_type 分别保存为“instructor”或“student”，具体取决于使用的表单，但我不知道如何在我的模板中检索它。我尝试了几种变体，包括：

模板.html

```
{% if user.get_profile.user_type == "instructor" %}
{% if user.user_type == "instructor" %}
{% if user.InstructorProfile.user_type == "instructor" %} 
```

再说一次，我对一般编程很陌生，而不仅仅是 Python，所以如果我没有提供足够的信息或解释清楚，请原谅我。提前感谢您的帮助。如果我需要提供任何其他信息，请告诉我。我无法通过搜索找到答案。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-04T15:21:47.700

The first variation would be the right one, but the problem is that your user_type field is on the subclass, not the base class. When you do `get_profile`, you only get the base class, as Django has no way of knowing simply from the database what sort of subclass you are expecting.

Rather than putting the user_type field on the subclass and setting a default, put it in the base class, and override your `save` method to set it appropriately.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-13T19:25:49.047

You could look at [django-polymorphic](https://github.com/bconstantin/django_polymorphic). It provides a nice mechanism for this sort of thing.

# entity-framework-4 - Entity Framework 4 函数导入没有行返回错误

> ID：12265580
> 
> 赞同：0
> 
> 时间：2012-09-04T14:25:24.607
> 
> 标签：entity-framework-4

在 EF4 中，我正在对返回字符串标量集合的存储过程进行函数导入。但是，有时存储过程可能不会返回任何值。我不拥有存储过程，也无法更改它。如果存储过程未返回任何值，我的代码将引发异常“数据存储提供程序返回的数据读取器没有足够的列用于请求的查询”。有没有比尝试捕获异常并假设没有行条件是导致它的原因更优雅的方法来处理这种情况？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-22T09:20:01.337

One workaround could be returning a dummy row if there are no matching records.

# php - 这个表单在做什么导致错误？

> ID：12265587
> 
> 赞同：0
> 
> 时间：2012-09-04T14:25:46.413
> 
> 标签：php, html

从以下代码中的表单链接的任何文件都会导致页面抛出此错误：

> 禁止的
> 
> 您无权访问此服务器上的 /savetodb.php。
> 
> 此外，在尝试使用 ErrorDocument 处理请求时遇到 404 Not Found 错误。

代码：

```
<div id="form">
<?php
$result = mysql_query("SELECT * FROM textdb WHERE id=1") 
or die(mysql_error());  
$fields = mysql_fetch_assoc($result);
?>
<form action="savetodb.php" method="post">
<p><a href="#">Text from DB One</a><br></p>
<br /><?php echo"<input name=\"one\" type=\"text\" id=\"one\" value=\"" .$fields['one']. "\"/>"; ?>
<br /><br />
<p><a href="#">Text from DB 2</a><br></p><br />
  <?php echo"<input name=\"two\" type=\"text\" id=\"two\" value=\"" .$fields['two']. "\">"; ?>
<br /><br />
<p><a href="#">Text from DB 3</a><br></p><br /><?php echo"<input name=\"three\" type=\"text\" id=\"three\" value=\"" .$fields['three']. "\">"; ?>
<br /><br />
<input name="submit" type="submit" value="Save"></form>
</div> 
```

我是否错过了代码中可能导致此问题的某些内容？文件权限设置为 655（我的服务器的默认设置，不允许 777）。

该表单将数据库中的数据导入到可编辑字段中，然后当您单击保存时，它应该将该信息保存回数据库。当您单击保存时，浏览器会显示 Forbidden 错误。

请不要指出我应该使用 PDO 语句，我还在学习：/

**问题不在于代码，而在于名为 modsecurity 的服务器插件。它现在已被我的主机禁用并且运行良好！如果您遇到类似的错误，请联系您的主机，为您节省几天的故障排除时间！**

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-04T14:29:11.480

这有一些可能的原因：

*   文件 /savetodb.php 不存在
*   文件权限不允许网络服务器进程访问该文件
*   您已经以无法访问此文件的方式配置了 .htaccess 或虚拟主机。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-04T14:28:16.070

错误 404 表示找不到文件。

确保路径正确并检查 .htaccess 中的重写规则

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-04T15:01:15.777

抱歉，这是 modsecurity 的问题，因为表单中有 HTML，它阻止了文件工作。

非常奇怪的问题，我的主人现在已经解决了。

我会把它留在这里，以防将来有人遇到同样的问题。谢谢你的帮助！

# maven - Maven模块和Maven项目有什么区别

> ID：12265589
> 
> 赞同：24
> 
> 时间：2012-09-04T14:25:55.543
> 
> 标签：maven, maven-2, maven-3

我试图了解 Maven 模块和 Maven 项目之间的区别。哪个是什么，我应该在哪里？谢谢

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-09-04T14:28:23.653

一个 Maven 模块就像一个 Maven 的“子项目”。一个 Maven 项目包含 1 个或多个模块。更多信息[在这里](http://maven.apache.org/guides/mini/guide-multiple-modules.html)。

通常，一个模块会生成单个工件（jar、war、zip 等），尽管并非总是如此。

# php - wordpress wp_insert_user 函数

> ID：12265595
> 
> 赞同：5
> 
> 时间：2012-09-04T14:26:15.120
> 
> 标签：php, wordpress

我正在为 WordPress 创建自定义注册表单。
我的问题是添加自定义用户元。我相信该功能`wp_insert_user`只允许您在 WordPress 用户表中添加默认字段。

这是我当前的测试代码：

```
$username = '12344';
$password = '1111';
$user_data = array(
'ID' => '',
'user_pass' => $password,
'user_login' => $username,
'display_name' => $loginName,
'first_name' => $firstName,
'last_name' => $lastName,
'role' => get_option('default_role') ,
'user_secondry_email' => 'test@tst.com'// Use default role or another role, e.g. 'editor'
);
$user_id = wp_insert_user( $user_data );
wp_hash_password( $password ); 
```

我找到了该`add_user_meta`功能，但这需要一个 ID 才能添加元数据。显然用户还没有被创建，所以他们不会有一个 ID。关于如何解决这个问题的任何想法？

谢谢，丹

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-04T14:56:07.443

据我从[Wordpress 文档](http://codex.wordpress.org/Function_Reference/wp_insert_user)中了解到的，该`ID`字段是可选的。

如果存在，则更新用户，如果不存在，则创建它`ID`并由函数返回新用户的 。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-12-03T10:51:28.163

如果我正确理解您的问题，您想将新的 user_meta 添加到当前注册用户。

这就是我的做法。

```
// this code insert the user, same on your code above just remove the ID field :)
$new_userid = wp_insert_user( $user_data );

$is_success = add_user_meta( $new_userid, 'position', 'programmer', true );
if( $is_success  ) {
   echo 'Successfully added';
} else {
   echo 'Error on user creation';
}

**NOTE:**
$new_userid = Is the return value from adding our new user and use that ID in adding new user meta 
```

希望此帮助和其他寻找相同解决方案的用户。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-07-12T00:31:55.753

从数组中完全删除 ID 值，它应该可以工作。（例如删除 'ID' => ''）

另外，我不认为“user_secondary_email”是新用户数组的允许字段。字段列表在这里：[http ://codex.wordpress.org/Function_Reference/wp_insert_user](http://codex.wordpress.org/Function_Reference/wp_insert_user)

（在您的示例中，“user_secondry_email”缺少“a”）

祝你好运！

# javascript - HTML SELECT - 使用 JavaScript 按 VALUE 更改所选选项

> ID：12265596
> 
> 赞同：84
> 
> 时间：2012-09-04T14:26:15.213
> 
> 标签：javascript, html, html-select

SELECT 下拉菜单中可以有许多选项。

```
<select id="sel">
    <option value="car">1</option>
    <option value="bike">2</option>
    <option value="cycle">3</option>
    ...
</select> 
```

我正在创建一个*更新配置文件*页面，其中从数据库中检索用户的配置文件，并显示带有这些值的表单。说到`SELECT`下拉菜单，有很多选择。所以，它繁琐的测试所有值

```
if (value == '1')
    echo "<option selected value='car'>1</option>";` 
```

所以，我想从它的值中选择相应的选项。就像当我做类似`sel.value = 'bike'`使用 JavaScript 之类的事情时，应该选择选项**2 。**

* * *

## 回答 #1

> 赞同：128
> 
> 时间：2012-09-04T14:28:59.300

您可以使用 javascript 选择值：

```
document.getElementById('sel').value = 'bike'; 
```

[演示](http://jsfiddle.net/xkqTR/)

* * *

## 回答 #2

> 赞同：38
> 
> 时间：2012-09-04T14:29:48.217

如果您使用的是 jQuery：

```
$('#sel').val('bike'); 
```

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2013-10-12T10:22:31.970

试试这个....

[**JSFIDDEL 演示**](http://jsfiddle.net/xkqTR/257/)

使用 javascript

```
​document.getElementById('sel').value = 'car';​​​​​​​​​​ 
```

使用 jQuery

```
$('#sel').val('car'); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2016-05-25T19:13:43.420

```
document.getElementById('drpSelectSourceLibrary').value = 'Seven'; 
```

# c# - 使用 GC.Collect() 是正确的；GC.WaitForPendingFinalizers();?

> ID：12265598
> 
> 赞同：38
> 
> 时间：2012-09-04T14:26:18.630
> 
> 标签：c#, .net, garbage-collection

我已经开始查看项目中的一些代码，发现如下内容：

```
GC.Collect();
GC.WaitForPendingFinalizers(); 
```

这些行通常出现在旨在提高效率的基本原理下破坏对象的方法上。我做了这样的评论：

1.  在销毁每个对象时显式调用垃圾回收会降低性能，因为这样做没有考虑到 CLR 性能是否绝对必要。
2.  仅当其他对象正在完成时，按该顺序调用这些指令会导致每个对象被销毁。因此，一个可以独立销毁的对象必须等待另一个对象的销毁，而没有真正的必要性。
3.  它可以产生死锁（见：[this question](https://stackoverflow.com/questions/4386585/can-you-deadlock-on-calling-gc-collect-and-gc-waitforpendingfinalizers)）

1、2和3是真的吗？你能提供一些参考来支持你的答案吗？

虽然我几乎可以肯定我的言论，但我需要在我的论点中明确，以便向我的团队解释为什么这是一个问题。这就是我要求确认和参考的原因。

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2012-09-04T14:42:16.320

简短的回答是：把它拿出来。该代码几乎*永远不会*提高性能或长期内存使用。

你所有的观点都是真实的。（它*会*产生死锁；但这并不意味着它总是*会*。）调用`GC.Collect()`将收集所有 GC 代的内存。这有两件事。

*   *它每次都*收集所有代- 而不是默认情况下 GC 将执行的操作，即仅在已满时收集一代。典型的使用将看到 Gen0 的收集频率（大约）是 Gen1 的十倍，而 Gen1 的收集频率（大约）是 Gen2 的十倍。这段代码每次都会收集所有的世代。Gen0 收集通常低于 100 毫秒；Gen2 可以更长。
*   它将不可收集的物品推广到下一代。也就是说，每次你强制一个集合并且你仍然有对某个对象的引用时，那个对象将被提升到下一代。通常这会相对很少发生，但像下面这样的代码会更频繁地强制这样做：

    ```
    void SomeMethod()
    { 
     object o1 = new Object();
     object o2 = new Object();

     o1.ToString();
     GC.Collect(); // this forces o2 into Gen1, because it's still referenced
     o2.ToString();
    } 
    ```

如果没有`GC.Collect()`，这两个项目将在下一次机会时收集。 *随着*集合的写入，`o2`最终将出现在 Gen1 - 这意味着自动 Gen0 集合*不会*释放该内存。

还值得注意的是更大的恐怖：在 DEBUG 模式下，GC 的功能不同，并且不会回收仍在范围内的任何变量（即使在当前方法中稍后未使用它）。`o1`所以在 DEBUG 模式下，上面的代码在调用 时甚至不会被收集`GC.Collect`，因此两者`o1`都会`o2`被提升。在调试代码时，这可能会导致一些非常不稳定和意外的内存使用。（诸如此类的文章[强调](http://www.bryancook.net/2008/05/net-garbage-collection-behavior-for.html)了这种行为。）

**编辑：**刚刚测试了这种行为，有些讽刺的是：如果你有这样的方法：

```
void CleanUp(Thing someObject)
{
    someObject.TidyUp();
    someObject = null;
    GC.Collect();
    GC.WaitForPendingFinalizers(); 
} 
```

...然后它将明确地不释放 someObject 的内存，即使在 RELEASE 模式下：它会将其提升到下一代 GC 中。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-09-04T14:41:24.837

有一点可以很容易理解：每次运行 GC 会自动清理许多对象（比如 10000 个）。在每次销毁后调用它每次运行都会清理大约一个对象。

因为 GC 有很高的开销（需要停止和启动线程，需要扫描所有存活的对象）批处理调用是非常可取的。

此外，在每个对象之后清理有什么*好处？*这怎么能比批处理更有效呢？

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2012-09-05T00:10:31.787

您的第 3 点在技术上是正确的，但只有在决赛期间有人锁定时才会发生。

即使没有这种调用，锁定在 finaliser 中也比你这里的更糟糕。

有几次调用`GC.Collect()`确实有助于提高性能。

到目前为止，在我的职业生涯中，我已经这样做了 2 次，也许 3 次。（或者如果你包括我做的那些，测量结果，然后再拿出来，可能大约 5 或 6 次 - 这是你应该在做完之后**总是**测量的东西）。

如果您在短时间内处理数百或数千兆内存，然后在很长一段时间内切换到较少密集使用的内存，这可能是一个巨大甚至至关重要的改进明确收集。这就是这里发生的事情吗？

在其他任何地方，他们充其量只会让它变慢并使用更多内存。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2012-09-04T14:42:59.340

在这里查看我的另一个答案：

**[GC.Collect 与否？](https://stackoverflow.com/questions/5248838/to-gc-collect-or-not/5249211#5249211)**

> 当您自己调用 GC.Collect() 时，可能会发生两件事：您最终会花费*更多*时间进行收集（因为除了手动 GC.Collect() 之外，正常的后台收集仍然会发生）并且您将继续使用内存*更长*（因为你强迫一些东西进入不需要去那里的高阶生成）。换句话说，自己使用 GC.Collect() 几乎总是一个坏主意。

大约只有一次你想自己调用 GC.Collect() 是当你有垃圾收集器很难知道的关于你的程序的特定信息时。典型示例是一个长时间运行的程序，具有明显的繁忙和轻负载周期。您可能希望在繁忙周期之前的轻负载周期快结束时强制收集，以确保资源在繁忙周期中尽可能空闲。但即使在这里，您可能会发现通过重新思考您的应用程序是如何构建的（即计划任务会更好地工作吗？），您会做得更好。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2017-11-06T19:28:47.963

我们遇到了与@Grzenio 类似的问题，但是我们正在使用更大的二维数组，按 1000x1000 到 3000x3000 的顺序，这是在 web 服务中。

添加更多内存并不总是正确的答案，您必须了解您的代码和用例。如果没有 GC 收集，我们需要 16-32gb 的内存（取决于客户大小）。如果没有它，我们将需要 32-64gb 的内存，即使这样也不能保证系统不会受到影响。.NET 垃圾收集器并不完美。

我们的 Web 服务有一个内存缓存，大小为 5-5000 万个字符串（每个键/值对约 80-140 个字符，具体取决于配置），此外，对于每个客户端请求，我们将构建 2 个矩阵，一个是双精度，一个是布尔值，然后传递给另一个服务来完成工作。对于 1000x1000 “矩阵”（二维数组），**每个请求**约为 25mb 。布尔值会说明我们需要哪些元素（基于我们的缓存）。每个缓存条目代表“矩阵”中的一个“单元”。

当服务器由于分页而具有 > 80% 的内存利用率时，缓存性能会显着降低。

我们发现，除非我们明确地 GC，.net 垃圾收集器永远不会“清理”临时变量，直到我们处于 90-95% 的范围内，此时缓存性能已急剧下降。

由于下游过程通常需要很长时间（3-900 秒），GC 收集的性能影响可以忽略不计（每次收集 3-10 秒）。在我们已经将响应返回给客户端**后，**我们启动了此收集。

最终，我们使 GC 参数可配置，在 .net 4.6 中还有更多选项。这是我们使用的 .net 4.5 代码。

```
if (sinceLastGC.Minutes > Service.g_GCMinutes)
{
     Service.g_LastGCTime = DateTime.Now;
     var sw = Stopwatch.StartNew();
     long memBefore = System.GC.GetTotalMemory(false);
     context.Response.Flush();
     context.ApplicationInstance.CompleteRequest();
     System.GC.Collect( Service.g_GCGeneration, Service.g_GCForced ? System.GCCollectionMode.Forced : System.GCCollectionMode.Optimized);
     System.GC.WaitForPendingFinalizers();
     long memAfter = System.GC.GetTotalMemory(true);
     var elapsed = sw.ElapsedMilliseconds;
     Log.Info(string.Format("GC starts with {0} bytes, ends with {1} bytes, GC time {2} (ms)", memBefore, memAfter, elapsed));
} 
```

在使用 .net 4.6 重写后，我们将垃圾收集分为两个步骤 - 一个简单的收集和一个压缩收集。

```
 public static RunGC(GCParameters param = null)
    {
        lock (GCLock)
        {
            var theParams = param ?? GCParams;
            var sw = Stopwatch.StartNew();
            var timestamp = DateTime.Now;
            long memBefore = GC.GetTotalMemory(false);
            GC.Collect(theParams.Generation, theParams.Mode, theParams.Blocking, theParams.Compacting);
            GC.WaitForPendingFinalizers();
            //GC.Collect(); // may need to collect dead objects created by the finalizers
            var elapsed = sw.ElapsedMilliseconds;
            long memAfter = GC.GetTotalMemory(true);
            Log.Info($"GC starts with {memBefore} bytes, ends with {memAfter} bytes, GC time {elapsed} (ms)");

        }
    }

    // https://msdn.microsoft.com/en-us/library/system.runtime.gcsettings.largeobjectheapcompactionmode.aspx
    public static RunCompactingGC()
    {
        lock (CompactingGCLock)
        {
            var sw = Stopwatch.StartNew();
            var timestamp = DateTime.Now;
            long memBefore = GC.GetTotalMemory(false);

            GCSettings.LargeObjectHeapCompactionMode = GCLargeObjectHeapCompactionMode.CompactOnce;
            GC.Collect();
            var elapsed = sw.ElapsedMilliseconds;
            long memAfter = GC.GetTotalMemory(true);
            Log.Info($"Compacting GC starts with {memBefore} bytes, ends with {memAfter} bytes, GC time {elapsed} (ms)");
        }
    } 
```

希望这对其他人有帮助，因为我们花了很多时间研究这个。

[编辑] 在此之后，我们发现大型矩阵存在一些额外的问题。我们已经开始遇到沉重的内存压力并且应用程序突然无法分配数组，即使进程/服务器有足够的内存（24gb 可用）。经过深入调查，我们发现该进程的备用内存几乎是“正在使用的内存”的 100%（24gb 正在使用，24gb 备用，1gb 空闲）。当“空闲”内存达到 0 时，应用程序将暂停 10 多秒，而待机被重新分配为空闲，然后它可以开始响应请求。

根据我们的研究，这似乎是由于大对象堆的碎片造成的。

为了解决这个问题，我们采取了两种方法：

1.  We are going to change to jagged array vs multi-dimensional arrays. This will reduce the amount of **continuous** memory required, and ideally keep more of these arrays out of the Large Object Heap.
2.  We are going to implement the arrays using the ArrayPool class.

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2016-08-24T21:21:32.317

我只用过一次：清理 Crystal Report 文档的服务器端缓存。请参阅我在 Crystal Reports 异常中的回复[：已达到系统管理员配置的最大报表处理作业限制](https://stackoverflow.com/questions/9579914/crystal-reports-exception-the-maximum-report-processing-jobs-limit-configured-b/39107479#39107479)

WaitForPendingFinalizers 对我特别有帮助，因为有时对象没有被正确清理。考虑到网页中报告的相对缓慢的性能 - 任何轻微的 GC 延迟都可以忽略不计，内存管理的改进为我提供了一个整体更快乐的服务器。

# spring-mvc - 两个 DispatcherServlets 和 DelegatingFilterProxy 不能一起工作

> ID：12265600
> 
> 赞同：2
> 
> 时间：2012-09-04T14:26:23.823
> 
> 标签：spring-mvc, spring-security

我的应用程序中有两个 DispatcherServlet。一种是用于 jsp 服务并调度管理员的地址。

```
<servlet>
    <servlet-name>adminServlet</servlet-name>
    <servlet-class>org.springframework.web.servlet.DispatcherServlet</servlet-class>
    <init-param>
        <param-name>contextConfigLocation</param-name>
        <param-value>/WEB-INF/spring/appServlet/adminServlet-context.xml</param-value>
    </init-param>
    <load-on-startup>1</load-on-startup>
</servlet>

<servlet-mapping>
    <servlet-name>adminServlet</servlet-name>
    <url-pattern>/</url-pattern>
</servlet-mapping> 
```

第二个 DispatcherServlet 调度发送 xml 或 json 的地址。

```
<servlet>
    <servlet-name>userServlet</servlet-name>
    <servlet-class>org.springframework.web.servlet.DispatcherServlet</servlet-class>
    <init-param>
        <param-name>contextConfigLocation</param-name>
        <param-value>/WEB-INF/spring/appServlet/userServlet-context.xml</param-value>
    </init-param>
    <load-on-startup>1</load-on-startup>
</servlet>

<servlet-mapping>
    <servlet-name>userServlet</servlet-name>
    <url-pattern>/user/*</url-pattern>
</servlet-mapping> 
```

还有 DelegatingFilterProxy 保证安全

```
<filter>
    <filter-name>springSecurityFilterChain</filter-name>
    <filter-class>org.springframework.web.filter.DelegatingFilterProxy</filter-class>
</filter>
<filter-mapping>
    <filter-name>springSecurityFilterChain</filter-name>
    <url-pattern>/*</url-pattern>
</filter-mapping> 
```

安全上下文配置文件：

```
<http auto-config="true" use-expressions="true">
    <intercept-url pattern="/login.do"
        access="permitAll" requires-channel="http" />
    <intercept-url pattern="/*"
        access="hasRole('ROLE_USER')" requires-channel="http" />
    <intercept-url pattern="/admin/*"
        access="hasRole('ROLE_ADMIN')" requires-channel="http" />
    <form-login login-page="/login.do"
        login-processing-url="/loginProcess" username-parameter="user"
        password-parameter="password" default-target-url="/admin" />
    <logout logout-url="/logout.do"
        invalidate-session="true" />
    <remember-me key="secCh4"
        token-validity-seconds="3600" data-source-ref="dataSource" />
    <session-management
        session-fixation-protection="newSession">
    </session-management>
    <intercept-url pattern="/user/*" access="hasRole('ROLE_USER')" />
</http> 
```

由 adminServlet 调度的服务部分需要认证并且是安全的，而由 userServlet 调度的部分是完全不安全的，不需要任何认证。我不知道为什么，我将 DelegatingFilterProxy 中的 url-pattern 设置为 /* 并且我也设置了

```
<intercept-url pattern="/user/*" access="hasRole('ROLE_USER')" /> 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-04T14:34:38.070

`DelegatingFilterProxy`无关`DispatcherServlet`。实际上，不需要**Spring MVC ，您可以使用任何其他框架，例如****Struts**。

使用您的规则`<intercept-url pattern="/user/*" access="hasRole('ROLE_USER')" />`，您指定拦截诸如`/user/list/`or之类的 url `/user/4`，但不是`/user/4/save`。如果你想拦截所有以`/user/`try开头的 url `<intercept-url pattern="/user/**" access="hasRole('ROLE_USER')" />`。[您可以在这里](http://static.springsource.org/spring/docs/current/javadoc-api/org/springframework/util/AntPathMatcher.html?is-external=true)阅读更多内容。

无论如何，请记住`intercept-url`顺序也很重要。

# actionscript-3 - 从 textarea flex3 中保存空格和换行符

> ID：12265606
> 
> 赞同：0
> 
> 时间：2012-09-04T14:26:34.173
> 
> 标签：actionscript-3, apache-flex, textarea, flex3

我有一个用户类型的文本区域，它的文本进入数据库。

如何在数据库中为用户类型应用空格和换行符，然后在 html 页面中显示？

```
mytext.condesnseWhite = false; 
```

还

```
mytext.text= mytext.text.replace('&#13','<br/>'); 
```

没有结果。请问有什么建议吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-05T13:04:32.127

这很好用

```
txt.text = txt.text.replace(/\r+/g,'<br/>'); 
```

# security - 出于安全原因，对 REST API 中的每个 HTTP 动词使用 POST 是否很好？

> ID：12265608
> 
> 赞同：0
> 
> 时间：2012-09-04T14:26:41.157
> 
> 标签：security, api, rest, standards

我正在开发一个企业网络应用程序。我们的应用程序将仅在 https 中部署到生产环境。我们正在编写仅由我们的 html 5 客户端使用的 REST API（不适用于其他客户端）

我的团队已决定对所有休息动词使用 POST，因为 GET、PUT、DELETE 会在 url 中公开 id。

我的团队认为，在 url 中暴露任何类型的数据都不是一个好主意，即使 id 不是直接的数据库 id。

每个人似乎都同意使用 POST http 方法进行 GET、PUT、DELETE 并将 http_method 作为参数传递，并使用参数决定要执行的操作。

这是我们计划为 REST API 做的唯一区别。你怎么看？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-04T14:36:11.360

通过避免使用 GET，您失去了使用缓存的能力。在正文中隐藏资源的 id 很可能会导致您违反“资源标识”约束。这将使链接/超媒体变得更加困难。

我会断言，如果您将自己限制为 POST，那么几乎不可能获得 RESTful 系统的好处。话虽如此，考虑到您只针对 HTML5 客户端，您可能不需要大多数 REST 优势。执行 Json-RPC 可能足以满足您的需求。

但是，我仍然认为为了虚假的安全感而放弃 GET 是一个坏主意。您的帖子正文就像 URI 中的 id 一样容易被某些中介访问。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-04T14:49:19.257

您应该按照预期使用 HTTP，以便获得堆栈的全部好处。不同的动词有不同的语义是有原因的。

您可能会觉得 POST 比 GET all you want 更安全，但这是一个错误的前提。

你从谁那里保护这些数据？中间人？这就是 HTTPS 解决的问题。

您是否从最终用户那里保护它？那些可以随时下载您的整个应用程序并在空闲时研究源代码的人？或者通过右键单击查看页面的源代码并查看您的有效负载的全部布局？或者只是打开浏览器调试器并查看您的所有流量？你想从那些人那里保护它？

POST 不会向任何人隐瞒任何事情。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-04T14:46:49.020

您可能应该看看[这篇文章](https://stackoverflow.com/questions/499591/are-https-urls-encrypted)，因为它几乎解释了 https 为您做了什么。所以问题是：你想保护谁的 URL？它可能在浏览器历史记录中或对站在用户身后的人可见，但对在线收听的任何人都看不到。

# android - DialogFragment：NullPointerException（支持库）

> ID：12265611
> 
> 赞同：16
> 
> 时间：2012-09-04T14:26:56.913
> 
> 标签：android, nullpointerexception, fragment, android-support-library

我正在使用优秀的[ACRA](http://code.google.com/p/acra/)库来接收来自我的应用程序的错误报告。

我从客户那里收到了很多关于 DialogFragment 中的 NPE 的报告，但我无法重现它：

```
java.lang.NullPointerException
at android.support.v4.app.DialogFragment.onActivityCreated(SourceFile:366)
at android.support.v4.app.FragmentManagerImpl.moveToState(SourceFile:892)
at android.support.v4.app.FragmentManagerImpl.moveToState(SourceFile:1083)
at android.support.v4.app.FragmentManagerImpl.moveToState(SourceFile:1065)
at android.support.v4.app.FragmentManagerImpl.dispatchActivityCreated(SourceFile:1844)
at android.support.v4.app.FragmentActivity.onStart(SourceFile:519)
at android.app.Instrumentation.callActivityOnStart(Instrumentation.java:1133)
at android.app.Activity.performStart(Activity.java:4475)
at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1929)
at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:1981)
at android.app.ActivityThread.access$600(ActivityThread.java:123)
at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1147)
at android.os.Handler.dispatchMessage(Handler.java:99)
at android.os.Looper.loop(Looper.java:137)
at android.app.ActivityThread.main(ActivityThread.java:4424)
at java.lang.reflect.Method.invokeNative(Native Method)
at java.lang.reflect.Method.invoke(Method.java:511)
at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:784)
at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:551)
at dalvik.system.NativeStart.main(Native Method) 
```

NPE 发生在**支持库**中（@line 366）：

```
353    @Override
354    public void onActivityCreated(Bundle savedInstanceState) {
           (...)
361        View view = getView();
362        if (view != null) {
363            if (view.getParent() != null) {
364                throw new IllegalStateException("DialogFragment can not be attached             to a container view");
365            }
366            mDialog.setContentView(view);
367        } 
```

我无法在我的任何设备（从 2.2 到 4.1.1）上重现该问题。由于没有引用我的任何代码，这是一个库错误吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-04-11T12:42:59.547

我不得不在一个项目中调试同样的问题。

通常对话框片段的使用如下

```
@Override
public Dialog onCreateDialog (Bundle savedInstanceState)
{
  //Create custom dialog
  return dialog;
} 
```

尝试将其更新为以下

```
@Override
public Dialog onCreateDialog (Bundle savedInstanceState)
{
  //Create custom dialog
  if (dialog == null)
    super.setShowsDialog (false);

  return dialog;
} 
```

这将阻止 DialogFragment.onAtivityCreated() 对 null 成员变量 mDialog 执行方法。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2014-11-23T01:20:25.533

这是我在 StackOverflow 中看到的比较常见的崩溃，这是由于未正确创建对话框，导致 mDialog 为空。我最初用来防止崩溃的蛮力方法：

```
@Override
public void onActivityCreated(Bundle arg0) {
    if (getDialog() == null ) {  // Returns mDialog
        // Tells DialogFragment to not use the fragment as a dialog, and so won't try to use mDialog
        setShowsDialog( false ); 
    } 
    super.onActivityCreated(arg0);  // Will now complete and not crash 
```

}

虽然上述情况可能比崩溃要好，但这并不能解决无法创建对话框的根本原因。这可能有很多原因，这就是需要调试的原因。

在我的情况下，我发现我需要实现 DialogFragment 的 onCreateDialog()*而不是*onCreateView() 才能 100% 正确地创建对话框。（onCreateView() 几乎总是可以创建对话框，但我证明存在可重现的极端情况，其中 onCreateView() 无法工作，导致 mDialog 变为 null。另一方面，我总是发现 onCreateDialog() 正确创建了 DialogFragment对话。）

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2018-04-11T13:17:12.683

`DialogFragment.mDialog``DialogFragment.dismiss()`如果在被调用之前被调用，则可以为 null `onActivityCreated()`。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-19T14:49:13.393

我有NPE。

但是`super.OnActivityCreated`用a包围`try/catch`并没有帮助。

有帮助的是删除了复制示例留下的静态字段。因此，被覆盖的 DialogFragment 中没有静态字段。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-04T15:08:27.957

不，这不对。这是 SetContentView 崩溃时的常见错误。setContentView 调用视图控件的构造函数。一个抛出了 nullPointerException。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2017-09-14T00:44:41.030

如果您要覆盖 onCreateView(..) 来实例化 DialogFragment 的视图，则需要使用片段事务显示它并将 setShowsDialog 设置为 false 以避免此错误。IE：

```
 //Instantiate your DialogFragment and fragmentManager previously and then just do this:
            dialogFragment.setShowsDialog(false);
            FragmentTransaction fT = fragmentManager.beginTransaction();
            fT.add(0, dialogFragment, TAG);
            fT.commit(); 
```

# javascript - Adobe Captivate：在 SCORM 模块中使用 GET/POST 进行服务器端计算

> ID：12265620
> 
> 赞同：0
> 
> 时间：2012-09-04T14:27:30.983
> 
> 标签：javascript, ajax, post, scorm, adobe-captivate

Captivate 6 是否可以通过 POST/GET 与 PHP 脚本交换数据，同时保持我们将模块打包到 SCORM 中的能力？我们的模块需要从用户那里交换数据并发送到我们的服务器场进行一些计算量大的计算，然后在模块中使用这些计算来修改显示给用户的信息。这与 SCORM 功能无关。

我见过一些示例，其中人们将其模块的报告选项设置为“电子邮件”（与 SCORM 相对），然后修改 Captivate 提供的电子邮件报告 JavaScript 函数，以使用 XMLHttpRequest 通过 GET/POST 发送数据。在我们的例子中，这不起作用，因为我仍然需要通过 SCORM 进行报告。但是，我还需要访问我们 Web 服务器上的一些服务器端资源来驱动 Captivate 演示。

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-05T20:10:11.943

您可以使用 JavaScript 在 Captivate 中获取/设置变量。

1.  使用 JavaScript 从 Captivate 中提取数据（我的开源[CaptivateController](http://pipwerks.com/2009/06/07/introducing-the-captivatecontroller/)实用程序旨在简化此操作）。
2.  使用 xmlhttprequest（又名 AJAX）将数据传递到您的 PHP 页面。*
3.  使用 JavaScript 将任何返回值发送到 Captivate（CaptivateController 再次让这变得简单）。

然后对 Captivate 中的数据做任何你想做的事情。

这完全独立于 SCORM。请记住，真正的 SCORM 包不依赖于外部 PHP 脚本，但没有技术原因导致它无法工作。

`*` *尝试将数据从课程传递到 PHP 文件并返回时，请注意跨域脚本问题。如果遇到问题，请搜索 StackOverflow——有很多 StackOverflow 帖子涉及跨域脚本问题。*

# windows-8 - Windows 8 javascript 应用程序的分析解决方案？

> ID：12265624
> 
> 赞同：0
> 
> 时间：2012-09-04T14:27:36.803
> 
> 标签：windows-8

Windows 8 Javascript 应用程序的首选分析方法（例如跟踪应用程序使用情况）是什么？我可以以某种方式集成 Google Analytics 吗？或者我可以使用其他方法（例如 Pikwik、Clicky 等）吗？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-04T14:51:48.943

刚刚找到了最合适的解决方案：Google Analytics server-side tracking（无需更新服务 XML 内容的客户端应用程序）

[http://gadotnet.codeplex.com/](http://gadotnet.codeplex.com/)

# iphone - UITextField 限制字符的数量和类型

> ID：12265625
> 
> 赞同：12
> 
> 时间：2012-09-04T14:27:38.423
> 
> 标签：iphone, objective-c, ios

我有两个文本字段，我想限制字符的数量和类型。我已经使用以下代码分别执行每个功能，但找不到在同一个功能中同时执行这两个功能的方法。

限制字符类型：

```
- (BOOL)textField:(UITextField *)textField shouldChangeCharactersInRange:(NSRange)range replacementString:(NSString *)string
{
    // Only characters in the NSCharacterSet you choose will insertable.
    NSCharacterSet *invalidCharSet = [[NSCharacterSet characterSetWithCharactersInString:@"abcdefgABCDEFG"] invertedSet];
    NSString *filtered = [[string componentsSeparatedByCharactersInSet:invalidCharSet] componentsJoinedByString:@""];
    return [string isEqualToString:filtered];
} 
```

并限制字符数：

```
- (BOOL)textField:(UITextField *)textField shouldChangeCharactersInRange:(NSRange)range replacementString:(NSString *)string
{
 if (textField.text.length >= 10 && range.length == 0)
 return NO;
return YES;
} 
```

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-09-04T14:30:52.527

```
- (BOOL)textField:(UITextField *)textField shouldChangeCharactersInRange:(NSRange)range replacementString:(NSString *)string
{
    if (textField.text.length >= 10 && range.length == 0)
       return NO;
    // Only characters in the NSCharacterSet you choose will insertable.
    NSCharacterSet *invalidCharSet = [[NSCharacterSet characterSetWithCharactersInString:@"abcdefgABCDEFG"] invertedSet];
    NSString *filtered = [[string componentsSeparatedByCharactersInSet:invalidCharSet] componentsJoinedByString:@""];
    return [string isEqualToString:filtered];
} 
```

* * *

**已编辑**

如果您想为第三个文本字段添加不同的条件，那么您可以这样做。
为第三个文本字段创建参考说`thirdField`

然后用这个

```
- (BOOL)textField:(UITextField *)textField shouldChangeCharactersInRange:(NSRange)range replacementString:(NSString *)string
{
    if (textField == thirdField) {
        //your contion e.g
        if (textField.text.length < 7) {
            return YES;
        } else {
            return NO;
        }        
    }
    else {
        if (textField.text.length >= 10 && range.length == 0)
            return NO;
        // Only characters in the NSCharacterSet you choose will insertable.
        NSCharacterSet *invalidCharSet = [[NSCharacterSet characterSetWithCharactersInString:@"abcdefgABCDEFG"] invertedSet];
        NSString *filtered = [[string componentsSeparatedByCharactersInSet:invalidCharSet] componentsJoinedByString:@""];
        return [string isEqualToString:filtered];
    }
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-07-25T14:08:53.953

这是限制在 UITextField 中输入的字符的最简洁的方法之一。这种方法允许使用多个预定义的 NSCharacterSet。

```
-(BOOL)textField:(UITextField *)textField shouldChangeCharactersInRange:(NSRange)range replacementString:(NSString *)string{

    NSMutableCharacterSet *allowedCharacters = [NSMutableCharacterSet alphanumericCharacterSet];
    [allowedCharacters formUnionWithCharacterSet:[NSCharacterSet whitespaceCharacterSet]];
    [allowedCharacters formUnionWithCharacterSet:[NSCharacterSet symbolCharacterSet]];
    [allowedCharacters addCharactersInString:@":./"];  //allow arbitrary characters

    if([string rangeOfCharacterFromSet:allowedCharacters.invertedSet].location == NSNotFound){

        return YES;

    }

    return NO;

} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-04T14:29:46.960

这是这样的：

```
 - (BOOL)textField:(UITextField *)textField shouldChangeCharactersInRange:(NSRange)range replacementString:(NSString *)string
    {
        // Only characters in the NSCharacterSet you choose will insertable.
        NSCharacterSet *invalidCharSet = [[NSCharacterSet characterSetWithCharactersInString:@"abcdefgABCDEFG"] invertedSet];
        NSString *filtered = [[string componentsSeparatedByCharactersInSet:invalidCharSet] componentsJoinedByString:@""];
        bool cond1 = [string isEqualToString:filtered];

     if (textField.text.length >= 10 && range.length == 0){
          return NO;
     }else{
          return (cond1);
     }

    } 
```

# c# - Line not visible in zedgraph - 如何使用 zedgraph 创建重叠的填充线图，以使所有曲线及其填充可见？

> ID：12265629
> 
> 赞同：1
> 
> 时间：2012-09-04T14:27:46.123
> 
> 标签：c#, zedgraph

我正在使用 zedgraph 创建一个折线图，其中包含多条线，并且所有这些线都填充有显示数据点的标签。有时其中一条线根本不可见，但只有该线的数据点标签可见。我认为当数据使得一条线在覆盖区域方面完全包围另一条线并且线的呈现顺序使得内部线在容器线之前呈现时，就会发生这种情况。我认为这使内线除了其数据点外不可见。

所以我的问题是：

*   如何使用 zedgraph 确保填充曲线的所有部分连同它们的线都被正确渲染，而不管它们填充的重叠区域是彼此的子集以及曲线的渲染顺序如何？

*   如何使用 zedgrapgh 我可以强制曲线的重叠部分显示填充颜色，该填充颜色是曲线的单个填充颜色的结果，就像我在下面的谷歌图表演示页面上找到的图表图像中一样？

![重叠区域填充颜色不同于单个曲线填充颜色](../Images/49000151fd16ee760cccb62413d9ddf9.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-06T09:27:50.850

解决了！！- 唯一要做的就是将 alpha 通道透明度添加到我的线条曲线填充中，其他所有内容都会自动排序。希望这可以帮助某人。

# api - 在 redmine [1.4.4.stable] 中通过 API 创建非公开项目

> ID：12265631
> 
> 赞同：1
> 
> 时间：2012-09-04T14:27:58.533
> 
> 标签：api, project, redmine

我找不到任何相关信息。我把它留给了几代人；）

解决方案：

```
172     custom_json = {
173             "project": {
174                 "name": project.name,
175                 "identifier": identifier,
176                 "parent_id": parent_id,
177                 "description": project.description,
178                 **"is_public": False,**
179                 } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-04T14:34:48.247

```
172     custom_json = {
173             "project": {
174                 "name": project.name,
175                 "identifier": identifier,
176                 "parent_id": parent_id,
177                 "description": project.description,
178                 "is_public": False,
179                 } 
```

# php - 使用 sphinx 对结果进行排序

> ID：12265637
> 
> 赞同：0
> 
> 时间：2012-09-04T14:28:16.760
> 
> 标签：php, sphinx

我正在使用狮身人面像 2.0.5。

狮身人面像配置：

```
index test
{
    type      = mysql
    sql_host  = host
    sql_user  = user
    sql_pass  = pass
    sql_db    = db

    sql_query = SELECT id, string \
                FROM table
} 
```

狮身人面像.php：

```
$sphinx = new SphinxClient();

$sphinx->SetServer('localhost', 3312);
$sphinx->SetConnectTimeout(1);

$sphinx->SetLimits(0, 15);

$sphinx->SetMatchMode(SPH_MATCH_ALL);
$ret = $sphinx->query($query, 'index'); 
```

在“字符串”中有类似的行

```
"mouse, screen, keyboard, green house"
"green house, computer, keyboard, green house" 
```

我想按以下方式排序：
1-在该行中找到的不同关键字的数量
2-在该行中找到的关键字总数

例如，如果我搜索“温室”，我想首先获得“温室、计算机、键盘、温室”。但如果我搜索“温室屏幕”，“鼠标、屏幕、键盘、温室”应该在第一位。

你知道我应该使用什么样的排序吗？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-05T12:10:17.117

我个人会将 , 放入phrase_boundary [http://sphinxsearch.com/docs/current.html#conf-phrase-boundary](http://sphinxsearch.com/docs/current.html#conf-phrase-boundary)

它将短语分成不同的边界。现在可以使用 primoxy 来影响结果。

然后会写搜索类似

```
$cl->setMatchMode(SPH_MATCH_EXTENDED);
$cl->setRankingMode(SPH_RANK_WORDCOUNT);
$cl->Query('"green house"~10 | "green house" | (green house)',$index); 
```

可以准确地选择你喜欢的因素，来影响结果。使用 3 个（或更多！）单词查询变得更加复杂，因为必须将所有组合扩展到查询中。

（我不确定这是否会导致您的确切规格 - 老实说他们并不清楚 - 但这是这种情况的一般解决方案 - 匹配标签列表）

# jquery - 字符数为 250 的 jQuery 显示/隐藏按钮

> ID：12265639
> 
> 赞同：0
> 
> 时间：2012-09-04T14:28:22.313
> 
> 标签：jquery, show-hide

假设我有一段文字有 500 个左右的单词。但我只想显示 250 个字符并显示一个显示按钮来扩大区域以显示其余部分。这是可能的，但将字符四舍五入到最完整的单词（所以我们没有切断单词）。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-04T14:33:25.170

由于没有尝试过的代码...我只是在证明伪代码，因为我不同意为他们工作..-获取长度

*   如果长度 > 250 编辑内容以显示其余部分

这很容易完成..试一试..做一个小提琴然后也许更多的人会帮忙？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-04T14:39:15.243

当您使用 jquery 时，我建议为此使用插件

许多“省略号”插件只显示三个点，根据之前关于同一主题的答案，不允许显示其余部分。

另一方面，我发现了这个：[http](http://plugins.learningjquery.com/expander/) ://plugins.learningjquery.com/expander/看起来不错，至少演示页面显示了您期望的行为

# c# - 访问冲突

> ID：12265644
> 
> 赞同：5
> 
> 时间：2012-09-04T14:28:31.173
> 
> 标签：c#, string, pinvoke, dllimport, access-violation

从外部 C DLL 调用以下命令时，我不断收到 AccessViolationException：

```
short get_device_list(char ***device_list, int *number_of_devices); 
```

我这样设置了一个 DLLImport 声明：

```
[DLLImport("mydll.dll")]
static public extern short get_device_list([MarshalAs(UnmanagedType.LPArray)] ref string[] devices, ref int number_of_devices); 
```

我的 C# 应用程序代码：

```
{
string[] devices = new string[20];
int i = 0;
short ret = 0;
ret = get_device_list(ref devices, ref i); // I receive the AccessViolation Exception here
// devices[0] = "2255f796e958f7f31a7d2e6b833d2d426c634621" which is correct.
} 
```

虽然我收到了异常，但设备数组被连接的设备的 2 个 UUID 正确填充（并且也被调整为 size = 2；i 也是 2；）。

怎么了？

PS：经过长时间的研究，我也尝试过：

```
[DLLImport("mydll.dll")]
static public extern short get_device_list(ref IntPtr devices, ref int number_of_devices); 
```

和

```
{
IntPtr devices = new IntPtr();
int i = 0;
short ret = 0;
ret = get_device_list(ref devices, ref i); // No AccessViolation Exception here
string b = Marshal.PtrToStringAuto(devices); // b = "歀ׄ", which is incorrect
} 
```

但这对我没有帮助。

提前致谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-04T15:50:09.823

```
[DLLImport("mydll.dll")]
static public extern short get_device_list(out IntPtr devices, 
    out int number_of_devices); 
```

是解决这个问题的最好方法。内存在接口的本机端分配和拥有。诀窍是如何做到这一点。像这样的东西应该工作。

```
static public string[] getDevices()
{
    IntPtr devices;
    int deviceCount;
    short ret = get_device_list(out devices, out deviceCount);
    //need to test ret in case of error

    string[] result = new string[deviceCount];
    for (int i=0; i<deviceCount; i++)
    {
        IntPtr ptr = (IntPtr)Marshal.PtrToStructure(devices, typeof(IntPtr));
        result[i] = Marshal.PtrToStringAnsi(ptr);
        devices += IntPtr.Size;//move to next element of array
    }
    return result;
} 
```

您的代码正在使用[`PtrToStringAuto`](https://msdn.microsoft.com/en-us/library/ewyktcaa)，但这会将数据解释为已`UTF-16`编码。但是您的 C++ 代码使用`char*`的是 8 位 ANSI。所以你需要[`PtrToStringAnsi`](https://msdn.microsoft.com/en-us/library/7b620dhe). 好的，这里假设编码不是 UTF-8，但这是我无法提供的细节。将其适应 UTF-8 很容易。

您还应该仔细检查本机代码是否使用`stdcall`调用约定并且没有使用`cdecl`.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-04T14:34:30.800

编辑：

好的，我想我知道您第二次尝试的问题。

```
{
IntPtr devices = new IntPtr();
int i = 0;
short ret = 0;
ret = get_device_list(ref devices, ref i); // No AccessViolation Exception here
string b = Marshal.PtrToStringAuto(devices); // b = "歀ׄ", which is incorrect
} 
```

您尝试将指向字符串数组的指针转换为字符串。你必须先尊重它。请检查这是否适合您：

```
 IntPtr devices = new IntPtr();
  int numDevices = 0;      
  short ret = get_device_list(ref devices, ref numDevices); // No AccessViolation Exception here
  for (int i=0; i<numDevices; i++)
  {
    IntPtr ptrToString = Marshal.ReadIntPtr(devices);
    string deviceString = Marshal.PtrToStringAnsi(ptrToString);
    devices += IntPtr.size;
    Console.WriteLine(deviceString);
  } 
```

# iframe - iframe 在尝试更改其 src 值时关闭

> ID：12265645
> 
> 赞同：1
> 
> 时间：2012-09-04T14:28:32.823
> 
> 标签：iframe, uri, src

在这种情况下，我完全不知所措。我尝试使用纯 JS 和 jQuery 更改 iframe 的 src 值，但两种尝试都只是关闭 iframe 对象！

我在定义的 HTML 中有一个 iframe：

```
<body>
<div id="divBody">
   <img src="images/test.gif" onClick="...see_below..." />
   <iframe name="ifTarget" id="ifTarget" src="http://www.yahoo.com" allowtransparency="true" scrolling="auto"></iframe>
</div>
</body> 
```

我在页面上还有一个 img，当点击它时，应该按照定义更改该 iframe 的 src：

```
document.getElementById('ifTarget').setAttribute('src', 'http://www.google.com'); 
```

或者通过jQuery：

```
$('#ifTarget').attr('src','http://www.google.com'); 
```

在这两种情况下，iframe 都会关闭，我通过 FF 错误控制台留下以下错误：

```
Security Error: Content at https://www.google.com/ may not load data from http://127.0.0.1/. 
```

我从本地计算机运行它，但如果从托管公司运行，我会收到相同的消息（相应地调整了试用 URI）。有什么想法吗？

谢谢，戴夫

# ruby-on-rails - Mini Magick、GraphicMagick 和 Carrierwave

> ID：12265649
> 
> 赞同：0
> 
> 时间：2012-09-04T14:28:38.223
> 
> 标签：ruby-on-rails, upload, carrierwave, image-uploading, minimagick

我正在尝试让我的上传器文件在使用以下代码上传图像时调整它们的大小：

```
 version :thumb do
  process :resize_to_limit => [230, 230]
 end 
```

我已经安装了 Carrierwave 来处理上传以及 GraphicMagick 来处理图像（正确安装）和 MiniMagick（使用成功安装`gem install Mini_magick`）

我一直收到以下错误：

`No such file or directory - identify -ping C:/Users/THOMAS~1/AppData/Local/Temp/mini_magick20120904-4644-1jvulye.jpg`

```
Request

Parameters:

{"utf8"=>"✓",
"authenticity_token"=>"yzrsjbr91do/8kpk7R67A7MMNfHu+6+BRQlTlBfPssw=",
"profile"=>{"name"=>"test2",
"image"=>#<ActionDispatch::Http::UploadedFile:0x4946e68 
@original_filename="centaur.JPG",
@content_type="image/jpeg",
@headers="Content-Disposition: form-data; name=\"profile[image]\";  filename=\"centaur.JPG\"\r\nContent-Type: image/jpeg\r\n",
@tempfile=#<File:C:/Users/THOMAS~1/AppData/Local/Temp/RackMultipart20120904-4644-4abl14>>}, "commit"=>"Submit"} 
```

我设法让它在另一台 Windows 7 计算机上工作，但无论出于何种原因，我一直收到此错误。

如果有人能指出我正确的方向来解决这个问题，我将不胜感激！:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-06-01T20:04:18.037

尝试 require 'mini_gmagick' 而不是 require 'mini_magick'，graphics magick 只有一个可执行的 gm，默认情况下 mini_magick 使用 image magick，它有多个二进制文件，并且 identify 是其中之一。

# css - mouseleave 上的悬停动画变换

> ID：12265652
> 
> 赞同：2
> 
> 时间：2012-09-04T14:28:43.427
> 
> 标签：css, animation, hover, transition

我为一个 div 创建了一个动画，所以当鼠标悬停在 div 上时它会跳动。但是当我用鼠标离开 div 时，div 会恢复到原始状态。是否有可能将其顺利变回原点？

[http://jsfiddle.net/ninerian/npN89/](http://jsfiddle.net/ninerian/npN89/)

我尝试了填充和字体大小的过渡，但它看起来不太平滑，并且原点不像变换那样居中。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-04T08:33:43.530

你想要的是 -webkit-animation-fill-mode: forwards; 由于某种原因，我无法让它在 jsfiddle 中工作，但这应该允许动画在停止后完成，如果它在动画中间停止。

# r - R图例中多种颜色的有趣行为

> ID：12265654
> 
> 赞同：1
> 
> 时间：2012-09-04T14:28:53.060
> 
> 标签：r, legend, legend-properties

我正在添加到情节中的图例中的颜色出现一些有趣的行为。该图很难重现，但可以从下面的示例中重现该行为：

```
mod3.cor.spo = 10
mod2.cor.spo = 10
mod1.cor.spo = 10
mod1.MBE.spo = 10
mod2.MBE.spo = 10
mod3.MBE.spo = 10
plot(1:10)
legend("bottomleft", 
       c(paste("r = ", sprintf("%1.3g", mod1.cor.spo)," MBE = ", sprintf("%1.3g", mod1.MBE.spo), "%", sep=""), 
                       paste("r = ",sprintf("%1.3g", mod2.cor.spo)," MBE = ", sprintf("%1.3g", mod2.MBE.spo), "%", sep=""), 
                       paste("r = ",sprintf("%1.3g", mod3.cor.spo)," MBE = ", sprintf("%1.3g", mod3.MBE.spo), "%", sep="")), 
       cex=0.6, col=c("red","blue","orange"), bty="n" ) 
```

希望如果您尝试此操作，您应该会看到图例中的文本全部打印为黑色。我期望（并希望）发生的是图例（打印成三行）的第一行文本为红色，第二行为蓝色，底部为橙色。

我在这里做错了什么吗？是否归结为使用组合大量字符串？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-04T14:37:16.177

你必须写`text.col=c("red","blue","orange")`而不是`col=c("red","blue","orange")`看`?legend`

# python - 多线程必然会减少运行时间吗？

> ID：12265658
> 
> 赞同：3
> 
> 时间：2012-09-04T14:29:02.397
> 
> 标签：python, multithreading, numpy

如果我有一系列 CPU 密集型操作，多线程我的程序是否必然会减少它的运行时间？这样做的权衡是什么？在这种情况下，我试图计算一个非常大的矩阵的零空间。我正在使用 Python，特别是 numpy 包：

```
def nullspace(A, eps=1e-15):
    """Computes the null space of the real matrix A."""
    n, m = shape(A)
    if n > m :
        return nullspace(transpose(A), eps)
    _, s, vh = linalg.svd(A)
    s = append(s, zeros(m))[0:m]
    null_mask = (s <= eps)
    null_space = compress(null_mask, vh, axis=0)
    return null_space.tolist() 
```

另外，我很想知道*如何*对这样的功能进行多线程处理。提前致谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-04T14:40:42.590

Python 具有全局解释器锁 (GIL)，它一次只允许一个线程与解释器交互——实际上，这意味着您一次只能运行一个 Python 线程。当尝试运行多个线程时，这是一个严重的缺点。

**但是**，`numpy`它建立在一个高度优化的数值线性代数库 LAPACK 之上。如果您为您的系统安装了正确版本的 LAPACK，它将为您并行计算。然后，您可以安装`numpy`在 LAPACK 之上，Python 计算将被并行化。

这也意味着许多`numpy`操作会释放 GIL，因此您可以`numpy`在 Python 线程中启动长时间计算并同时执行其他 Python。[谢谢@JFSebastian。]

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-04T14:32:06.410

不。一方面，由于全局解释器锁，CPU 密集型程序很少从 Python 中的线程中受益。

此外，在单核机器上，线程根本不会减少运行时间。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-04T14:53:27.113

通常，GIL 是获得多线程优势的障碍，除非您的计算是从您的 python 解释器中进行的（例如 C 实现）。我不确定这是否与`numpy`.

如果你运行的线程不多，你应该看看[multiprocessing](http://docs.python.org/library/multiprocessing.html)模块。您将拥有一个单独的系统进程而不是 python 线程。

# javascript - window.setInterval() 的 dojo.hitch() 范围

> ID：12265661
> 
> 赞同：3
> 
> 时间：2012-09-04T14:29:14.853
> 
> 标签：javascript, dojo, scope

我正在尝试使用 dojo fadeIn/Out 产生闪烁效果。

以下代码片段在小部件类的声明中定义：

```
 _startHighlightEffect : function() {
      var blinkInterval = 5000; //Scope here is that of the parent widget
      window.setInterval ( function() {
              dojo.fadeOut(
              {
                      node: this._headerDiv.domNode,
                      onEnd: function() {
                              dojo.fadeIn({node: this._headerDiv.domNode},3000).play();
                      }
              },3000).play();
      }, blinkInterval);
  },

_highlightEffect : function() {
    this.func = dojo.hitch(this,this._startHighlightEffect);
    this.func();
} 
```

我面临的问题是它说“this._headerDiv 未定义”。在使用 firebug 检查时，范围`this._headerDiv`是 Window 而不是父小部件。

请帮助我了解我在这里缺少什么。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-04T14:38:09.343

@jbabey 描述的内容会起作用，但就 而言`dojo.hitch`，您在错误的功能上使用了它。您需要连接传入的函数`setInterval`。

```
_startHighlightEffect : function() {
  var blinkInterval = 5000; //Scope here is that of the parent widget

  // hitch the function that will be executed by the setInterval call *********
  window.setInterval (dojo.hitch(this, function() {
          dojo.fadeOut(
          {
                  node: this._headerDiv.domNode,
                  onEnd: dojo.hitch(this, function() {
                          dojo.fadeIn(
                                {node: this._headerDiv.domNode},3000).play();
                  })
          },3000).play();
  }, blinkInterval));
},

_highlightEffect : function() {
  this._startHighlightEffect();
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-04T14:32:55.490

当它是你想要的上下文时，你可以保存上下文，并在以后使用它：

```
_startHighlightEffect : function() {
      var blinkInterval = 5000; //Scope here is that of the parent widget
      var that = this; // save the scope
      window.setInterval ( function() {
              dojo.fadeOut(
              {
                      node: that._headerDiv.domNode, // use the saved scope
                      onEnd: function() {
                              dojo.fadeIn({node: that._headerDiv.domNode},3000).play();
                      }
              },3000).play();
      }, blinkInterval);
  } 
```

# image-processing - 用于边缘检测的蚁群算法

> ID：12265666
> 
> 赞同：1
> 
> 时间：2012-09-04T14:29:26.677
> 
> 标签：image-processing

我是图像处理的新手，目前正在研究蚁群算法如何用于特征检测。我浏览了 Wiki 中的文章，我了解了它们如何追踪从一个节点到另一个节点的最短路径。但是 some1 可以告诉我这在边缘检测中有何用处吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-04T14:54:02.970

对您的蚂蚁进行编程，以便它们在图像梯度上沉积更多的信息素。一段时间后，它们将倾向于跟随图像边缘。经过多次迭代，您的信息素图就是您的边缘图。在我看来，ACO 可能不是目前最快的算法，但它的行为很有趣。

# c# - 使用实体框架在关系表中插入数据时出错

> ID：12265671
> 
> 赞同：2
> 
> 时间：2012-09-04T14:29:39.580
> 
> 标签：c#, entity-framework

我是 entityframework 的新手，并试图将数据插入到关系表中。以下是我的代码的描述以及发生了什么错误。

我有两张桌子，

*   产品

*   产品信息

我为这两个表设计了实体，如下所示：

产品实体：

```
public class Product
{
    public int Id { get; set; }
    public string Name { get; set; }

    public virtual ICollection<ProductInfomation> ProductInformations { get; set; }
} 
```

ProductInformation-实体：

```
public class ProductInfomation
{
    public int Id { get; set; }
    public string Description { get; set; }
    public string BatchNumber { get; set; }
    public DateTime ProductedOn { get; set; }

    public virtual Product Product { get; set; }
} 
```

实体上下文类：

```
public class EF : DbContext
{
    public DbSet<Product> Products { get; set; }
    public DbSet<ProductInfomation> ProductInformations { get; set; }
} 
```

要将数据插入关系表，我遵循以下过程：

```
EF objEf = new EF();

        ProductInfomation pi = new ProductInfomation();
        pi.Description = "Best product in XYZ-Segment";
        pi.BatchNumber = "B001";
        pi.ProductedOn = DateTime.Now;

        Product prod = new Product();
        prod.Name = "Product-A";
        prod.ProductInformations.Add(pi); // This code throws exception.(Object reference not set to an instance of an object)

        objEf.Products.Add(prod);
        objEf.SaveChanges(); 
```

数据库架构：

```
Product:
Id           INT        IDENTITY        PRIMARY KEY,
Name         VARCHAR(200)
------------------------------------------------------
ProductInformation:
Id           INT        IDENTITY        PRIMARY KEY,
Description  VARCHAR(500),
BatchNumber  VARCHAR(200),
ProductedOn  DATETIME,
Product_Id   INT        REFERENCES      Product(Id)
------------------------------------------------------ 
```

运行上述代码后，出现以下错误：**对象引用未设置为对象的实例。**

我哪里错了？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-04T14:33:40.550

这是空的

```
prod.ProductInformations 
```

当您尝试向其中添加项目时。请更正：

```
prod.Name = "Product-A";
prod.ProductInformations = new Collection<ProductInfomation>();
prod.ProductInformations.Add(pi); 
```

# javascript - MVC JsonResult 不适用于 chrome？

> ID：12265672
> 
> 赞同：-1
> 
> 时间：2012-09-04T14:29:40.667
> 
> 标签：javascript, jquery, asp.net-mvc, json

我希望 jquery 从我的 MVC 控制器中获取 JsonResult，但它没有收到任何数据！

如果我将输出放入一个文本文件并输入它的链接它的工作，所以我认为我的 jQuery 很好。

然后我正在使用其他浏览器（如 chrome）进行测试，但我什么也没看到。请求的页面只是 emtpy.. 没有错误。此外，IE 似乎在接收我的字符串时遇到问题。只有 firefox 显示字符串，但为什么呢？

```
 public JsonResult jsonLastRequests()
    {
        List<Request> requests = new List<Request>();
        while (r.Read())
        {
            requests.Add(new Models.Request()
            {
                ID = (int)r[0],
                SiteID = r[1].ToString(),
                Lat = r[2].ToString(),
                City = r[4].ToString(),
                CreationTime = (DateTime)r[5]
            });
        }
        r.Close();
        return Json(requests);
    } 
```

我发现如果我想将 JSON 作为字符串返回它也不起作用！它现在在所有浏览器中都可以使用字符串.. 但是 jQuery 仍然没有加载任何东西

```
 var url = "http://../jsonLastRequests";
        var source =
        {
            datatype: "json",
            datafields: [
                { name: 'ID' },
                { name: 'SiteID' },
                { name: 'Lat' },
                { name: 'CreationTime' },
                { name: 'City' },
            ],
            id: 'id',
            url: url
        };
        var dataAdapter = new $.jqx.dataAdapter(source, {
            downloadComplete: function (data, status, xhr) { },
            loadComplete: function (data) { },
            loadError: function (xhr, status, error) { }
        }); 
```

我通过添加解决了我的问题： access-control-allow-origin:*

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-04T15:08:00.077

```
 public HtmlString jsonLastRequests()
    {
        List<Request> requests = new List<Request>();
        while (r.Read())
        {
            requests.Add(new Models.Request()
            {
                ID = (int)r[0],
                SiteID = r[1].ToString(),
                Lat = r[2].ToString(),
                City = r[4].ToString(),
                CreationTime = (DateTime)r[5]
            });
        }  r.Close();
 System.Web.Script.Serialization.JavaScriptSerializer jSerializer = new System.Web.Script.Serialization.JavaScriptSerializer();

            return new HtmlString(jSerializer.Serialize(requests ));} 
```

我做了同样的方法

```
 $.ajax({
        type: 'POST',
        url: '/home/GetSurvey',
        data: {
            XmlPath: $("#xmlpath").val()
        },
        dataType: 'json',
        success: function (jsonData) {
            jsonStringQuestionaire = jsonData;
            LoadSurvey();
        },
        error: function () {
            alert('Error loading ' + id);
        }
    });
 questionaireJsonList = eval(jsonStringQuestionaire); 
```

# qt - 使用创建的向量作为 QDoubleSpinBox 和 QSlider 的范围

> ID：12265684
> 
> 赞同：1
> 
> 时间：2012-09-04T14:30:37.893
> 
> 标签：qt, range, qslider, qspinbox

我创建了一个向量 v ，其中包含从 -3000 到 3000 的 128 个元素，我想将它与 a`QDoubleSpinBox`和 a相关联`QSlider`，因为将 6000 划分为 128 并设置`QDoubleSpinBox`我们总是有圆形问题。那么我们可以将范围和步长都设置为 a`QDoubleSpinBox`和`QSlider`这样的向量吗？

```
 std::vector<double> v(128);

  for (int i = 0; i < 128; ++i)
  {
      v[i] = -3000.0 + 6000.0 * (i) / 127.0;
  } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-04T17:13:41.443

`QSlider`仅`int`按步骤操作，因此您只需要自己进行计算：

```
#include <QtGui>
#include <cmath>

class MyWidget : public QWidget {
  Q_OBJECT

public:
  MyWidget() : QWidget() {
    slider_ = new QSlider;
    slider_->setRange(0, 127);
    connect(slider_, SIGNAL(valueChanged(int)), SLOT(ChangeSpinBox(int)));

    box_ = new QDoubleSpinBox;
    box_->setRange(-3000.0, 3000.0);
    connect(box_, SIGNAL(valueChanged(double)), SLOT(ChangeSlider(double)));

    QVBoxLayout *layout = new QVBoxLayout;
    layout->addWidget(slider_);
    layout->addWidget(box_);

    setLayout(layout);
  }
private slots:
  void ChangeSpinBox(int sliderValue) {
    if (convertSpinBoxValueToSlider(box_->value()) != sliderValue) {
        box_->setValue((6000.0 * sliderValue / 127.0) - 3000.0);
    }
  }

  void ChangeSlider(double spinBoxValue) {
    slider_->setValue(convertSpinBoxValueToSlider(spinBoxValue));
  }

private:
  QSlider *slider_;
  QDoubleSpinBox *box_;

  static int convertSpinBoxValueToSlider(double value) {
    return qRound((value + 3000.0) * 127.0 / 6000.0);
  }

};

int main(int argc, char **argv) {
  QApplication app(argc, argv);
  MyWidget w;
  w.show();
  return app.exec();
}

#include "main.moc" 
```

还是我不明白你的问题？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-04T20:20:36.417

首先，您的向量计算中有一个错误。如果要将范围划分为 X 部分，则向量的大小必须为 X+1 而不是 X。**示例：**您要将范围 0-10 拆分为 5 个部分。您需要多少物品？您的代码建议 5。但答案是 [0,2,4,6,8,10] = 6。所以有向量 129 并除以 128。

因此，您希望步长为 6000/128 = 48.875。你可以这样做`QDoubleSpinBox`

```
QDoubleSpinBox::setRange(-3000.0,3000.0);
QDoubleSpinBox::setSingleStep(48.875); 
```

但不是 with `QSlider`which 只需要整数。您可以通过将范围乘以 1000 来避免舍入误差。

```
QSlider::setRange(-3000000,3000000);
QSlider::setSingleStep(48875); 
```

要将选择的结果设置为旋转框，当然需要再次除以 1000。

# jquery - 带有文件的动作struts响应不使用ajax

> ID：12265692
> 
> 赞同：0
> 
> 时间：2012-09-04T14:31:02.193
> 
> 标签：jquery, ajax, file, struts

我有一个 struts 动作，它有一个文档作为响应，这是代码：

```
public class GenerateBlame extends Action
{ 

    public ActionForward execute(ActionMapping mapping, ActionForm form,
            HttpServletRequest request, HttpServletResponse response) throws IOException {
        System.out.println("it's ok!");
        POIFSFileSystem fs = new POIFSFileSystem(new FileInputStream("C:\\Users\\free\\Desktop\\myworkspace\\gestionRH\\WebRoot\\fiches\\decisionRetraitSanction.doc"));
        HWPFDocument doc = new HWPFDocument(fs);
        Range r = doc.getRange();
        r.replaceText("<dateDemande>", "test");

        doc.write(new FileOutputStream("C:\\Users\\free\\Desktop\\myworkspace\\gestionRH\\WebRoot\\fiches\\decision.doc"));
        OutputStream out = response.getOutputStream();
        response.setContentType("application/rtf");
        response.setHeader("Content-Disposition","attachment; filename=Decision");
        FileInputStream in = new FileInputStream("C:\\Users\\free\\Desktop\\myworkspace\\gestionRH\\WebRoot\\fiches\\decision.doc");
        byte[] buffer = new byte[4096];
        int length;
    /*  while ((length = in.read(buffer)) > 0){
            out.write(buffer, 0, length);
        }
        in.close();
        out.flush();*/
        return null;
    }
} 
```

我想通过 ajax id 调用此操作，如下所示：

```
$.ajax({
  type: "POST",
  url: "../generateBlame.do",
 }); 
```

我无法像使用表格那样下载文件

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-04T15:42:47.250

您需要使用类似[这个 jQuery 下载插件](http://johnculviner.com/post/2012/03/22/Ajax-like-feature-rich-file-downloads-with-jQuery-File-Download.aspx)或等效的东西。

# multithreading - 读取：读取错误：0：在 bash 脚本中 mpirun 后资源暂时不可用

> ID：12265694
> 
> 赞同：0
> 
> 时间：2012-09-04T14:31:07.013
> 
> 标签：multithreading, bash

我试图在网上找到我的问题的解决方案。我已将其范围缩小到导致问题的 mpirun，因为仅调用可执行文件不会返回问题。我试图重定向输出，但没有运气。

在运行 mpirun 后，每次尝试阅读时，我都会收到标题中的错误。这是相关的代码行。

```
 mpirun -np $numcores  $dir/vasp 
```

起作用的是./vasp，但是只有一个核心它要慢得多。无论出于何种原因，调用上述内容都会破坏这一点，并导致以下要求用户输入值的读取命令失败。

# python - python - 返回一个默认值

> ID：12265695
> 
> 赞同：11
> 
> 时间：2012-09-04T14:31:12.897
> 
> 标签：python, return-value, default-value

`getattr`我希望模仿允许用户指定“默认”返回值的内置函数（如 ）的行为。我最初的尝试是这样做

```
def myfunc(foo, default=None):
    # do stuff
    if (default is not None):
        return default
    raise SomeException() 
```

问题是如果用户想`None`成为他们的返回值，这个函数反而会引发异常。第二次尝试：

```
def myfunc(foo, **kwargs):
    # do stuff
    if ('default' in kwargs):
        return kwargs['default']
    raise SomeException() 
```

这解决了上述问题并允许用户指定任意值，但引入了用户必须始终`default=bar`在其函数调用中指定的烦恼；他们不能只`bar`在最后提供。同样，`*args`可以使用，但`default=bar`如果用户更喜欢该语法，则阻止他们使用。

结合`*args`并`**kwargs`提供了一个可行的解决方案，但感觉这需要很多努力。它还可能掩盖不正确的函数调用（例如`bar = myfunc(foo, baz, default=qux)`）

```
def myfunc(foo, *args, **kwargs):
    # do stuff
    if (len(args) == 1):
        return args[0]
    if ('default' in kwargs):
        return kwargs['default']
    raise SomeException() 
```

有没有更简单的解决方案？（如果重要的话，python 3.2）

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-09-04T14:33:23.930

您需要使用哨兵来检测未设置默认值：

```
sentinel = object()

def func(someparam, default=sentinel):
    if default is not sentinel:
        print("You passed in something else!") 
```

这是有效的，因为一个实例`object()`将始终拥有它自己的内存 ID，因此`is`只有在保留确切值的情况下才会返回 True。*任何其他值*都不会注册为同一个对象，包括`None`.

您将在各种不同的 python 项目中看到上述技巧的不同变体。以下任何哨兵也可以工作：

```
sentinel = []
sentinel = {} 
```

# c - 压缩列存储中的稀疏矩阵与列向量的乘法

> ID：12265698
> 
> 赞同：-1
> 
> 时间：2012-09-04T14:31:23.690
> 
> 标签：c, opencl

我必须将压缩列存储中的稀疏矩阵与列向量相乘（我必须在开放 cl 中将其并行化）。我在互联网上搜索了很多天。花了这么多天但找不到任何东西。（我被允许搜索互联网因为我必须将其转换为并行）。但我只能找到压缩行存储的代码。

```
spmv_csr_serial(const int num_rows ,
                const int * ptr ,
                const int * indices ,
                const float * data ,
                const float * x,
                float * y)
{
    for(int row = 0; i < num_rows; i++){
        float dot = 0;
        int row_start = ptr[row];
        int row_end = ptr[row+1];

        for (int jj = row_start; jj < row_end; jj++)
            dot += data[jj] * x[indices[jj]];

        y[row] += dot;
    }
} 
```

压缩列存储没有行 ptr。那么如何将它与向量相乘呢？我只需要串行代码，我会自己将其转换为并行代码。

这是我的这个项目的 OpenCL 内核

```
enter code here
__kernel void mykernel(__global const int* val,__global const int* index,__global const int * ptr,__global const int* x,__global int* y) 
{ 
    int id=get_global_id(0); 
    int colstart=ptr[id]; 
    int colend=ptr[id+1]; 
    for(int j=colstart;j<colend;j++) 
    { 
        y[index[j]]=val[j]*x[index[j]]; 
    } 
} 
```

此代码在 open cl 内核中返回垃圾值。这是我的序列号。

```
 spmv_csr_serial(const int num_rows ,
                const int * ptr ,
                const int * indices ,
                const float * data ,
                const float * x,
                float * y)
{
    for(int row = 0; i < num_rows; i++){
        float dot = 0;
        int colstart = ptr[row];
        int colend = ptr[row+1];

      for(int j=colstart;j<colend;j++) 
    { 
        y[index[j]]=val[j]*x[index[j]]; 
    }

    }
} 
```

密集矩阵向量乘法算法

```
For(int i=0;i<A.RowLength;i++) 
{
    For(int j=0;j<vector.length;j++) 
    { 
        Result[i]=Result[i]+A[i][j]*vector[j];
    }
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-04T15:13:24.587

一般来说，进行矩阵向量计算的算法如下

```
y = 0
for i = 0 : Nr - 1
    for j = 0 : Nc - 1
        y[i] += M[i,j] * x[j] 
```

### 压缩行存储：

我们不是对所有列进行普通循环，而是仅对非零条目进行循环：

```
y = 0
for i = 0 : Nr - 1
    for j = 0 : numElementsInRow(i) - 1
        y[i] += M[i, columnIndex(i,j)] * x[columnIndex(i,j)] 
```

where`numElementsInRow(i)`返回第 - 行中非零的数量，`i`并`columnIndex(i,j)`给出第 - 行`j`中的第 - 列索引`i`。

在您上面的实现中，您的`columnIndex(i,j)`映射由两个数组`ptr`和完成`indices`，即 `columnIndex(i,j) == indices[ptr[i] + j]`元素的数量由 给出 `numElementsInRow(i) == ptr[i+1] - ptr[i]`。不需要索引矩阵，因为您只存储它的**压缩**版本。

### 压缩列存储：

现在更改两个循环的顺序并遍历行中的非零：

```
y = 0
for j = 0 : Nc - 1
    for i = 0 : numElementsInColumn(j) - 1
        y[rowIndex(j,i)] += M[rowIndex(j,i), j] * x[j] 
```

其余的类似于 CRS 格式。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-04T14:56:57.043

1.  写出一个密集矩阵向量乘法的算法。如果您不知道如何做到这一点，请查看任何基本的线性代数教科书，或询问您的教授。
2.  您的算法将遍历矩阵的行和列；如有必要，重新安排算法，使内部循环位于列之上。
3.  修改算法以使用密集存储方案来访问矩阵。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-04T16:40:35.293

CCS 与 CRS 类似，只是转置了。您没有行指针，但有类似的列指针。因此，您的顺序循环应该是

```
for(int col=0; col<num_cols; col++){
  for(int j=ptr[col];j<ptr[col+1]; j++) { 
    y[indices[j]] += val[j]*x[col]; 
  }
} 
```

记得在之前将 y 向量归零。

你觉得哪一个更快？CCS还是CRS？

# php - 我想自定义zend表单的标记

> ID：12265701
> 
> 赞同：0
> 
> 时间：2012-09-04T14:31:33.300
> 
> 标签：php, html, zend-framework, zend-form

我有一个表单，我想为其自定义标记。我在课堂底部使用装饰器。但是，我不断收到错误消息：

表单捕获的异常：未找到文件装饰器。

我想知道是否有人可以给我看一个例子。我基本上想将表单输出为并取消标准布局。也许还添加一些自定义类。

**更新**

```
class Application_Form_Admin extends Zend_Form
{

    public function init()
    {
        // Set the method for the display form to POST
        $this->setMethod('post');

        // set the data format
        $this->setAttrib('enctype', 'multipart/form-data');

        // Add the entry id
        $this->addElement('hidden', 'id', array(
            'required'   => false
        ));

        // Add the title
        $this->addElement('text', 'title', array(
            'label'      => 'Project Title',
            'required'   => false,
            'validators' => array(
                    array('validator' => 'StringLength', 'options' => array(0, 60))
                )
        ));

        // Add the title
        $this->addElement('text', 'appid', array(
            'label'      => 'App Id',
            'required'   => true,
            'validators' => array(
                    array('validator' => 'StringLength', 'options' => array(0, 60))
                )
        ));

        // Add the title
        $this->addElement('text', 'appsecret', array(
            'label'      => 'App Secret',
            'required'   => true,
            'validators' => array(
                    array('validator' => 'StringLength', 'options' => array(0, 60))
                )
        ));

        // Add the title
        $this->addElement('text', 'namespace', array(
            'label'      => 'Namespace',
            'required'   => false,
            'validators' => array(
                    array('validator' => 'StringLength', 'options' => array(0, 60))
                )
        ));

        // Add the title
        $this->addElement('text', 'applink', array(
            'label'      => 'App Link',
            'required'   => false,
            'validators' => array(
                    array('validator' => 'StringLength', 'options' => array(0, 255))
                )
        ));

        // Facebook Only?
        $this->addElement('checkbox', 'fbonly', array(
            'label'      => 'Facebook Only',
            'required'   => false,
            'value'      => 1
        ));

        // general app data group
        $this->addDisplayGroup(array('title', 'appid', 'appsecret', 'namespace', 'applink', 'fbonly'), 'general', array('legend' => 'General Optons'));

        // Facebook Only?
        $this->addElement('checkbox', 'fangate', array(
            'label'      => 'Fangate Page',
            'required'   => false,
            'value'      => 1
        ));

        // Facebook Only?
        $this->addElement('checkbox', 'welcome', array(
            'label'      => 'Welcome Page',
            'required'   => false,
            'value'      => 1
        ));

        // Facebook Only?
        $this->addElement('checkbox', 'help', array(
            'label'      => 'Help Page',
            'required'   => false,
            'value'      => 1
        ));

        // Facebook Only?
        $this->addElement('checkbox', 'entries', array(
            'label'      => 'Entries Page',
            'required'   => false,
            'value'      => 1
        ));

        // pages enabled group
        $this->addDisplayGroup(array('fangate', 'welcome', 'help', 'entries'), 'page', array('legend' => 'Page Optons'));

        // Add the title
        $this->addElement('text', 'ogtype', array(
            'label'      => 'Default Open Graph Type',
            'required'   => false,
            'validators' => array(
                    array('validator' => 'StringLength', 'options' => array(0, 60))
                )
        ));

        // Add the title
        $this->addElement('text', 'ogtitle', array(
            'label'      => 'Default Open Graph Title',
            'required'   => false,
            'validators' => array(
                    array('validator' => 'StringLength', 'options' => array(0, 60))
                )
        ));

        // Add the title
        $this->addElement('text', 'ogdesc', array(
            'label'      => 'Default Open Graph Description',
            'required'   => false,
            'validators' => array(
                    array('validator' => 'StringLength', 'options' => array(0, 60))
                )
        ));

        // Add the title
        $this->addElement('file', 'ogimage', array(
            'label'      => 'Default App Image',
            'required'   => false
        ));

        // generic open graph data
        $this->addDisplayGroup(array('ogtype', 'ogtitle', 'ogdesc', 'ogimage'), 'og', array('legend' => 'Generic Open Graph data'));

        // Add the wall title
        $this->addElement('text', 'apptitle', array(
            'label'      => 'App Title',
            'required'   => false,
            'validators' => array(
                    array('validator' => 'StringLength', 'options' => array(0, 60))
                )
        ));

        // Add the wall caption
        $this->addElement('text', 'appcaption', array(
            'label'      => 'App Caption',
            'required'   => false,
            'validators' => array(
                    array('validator' => 'StringLength', 'options' => array(0, 60))
                )
        ));

        // Add the wall message
        $this->addElement('text', 'appdesc', array(
            'label'      => 'App Description',
            'required'   => false,
            'validators' => array(
                    array('validator' => 'StringLength', 'options' => array(0, 255))
                )
        ));

        // app message details
        $this->addDisplayGroup(array('apptitle', 'appcaption', 'appdesc'), 'appdetails', array('legend' => 'App deatils (Used when sharing)'));

        // Add the wall title
        $this->addElement('text', 'wallmsg', array(
            'label'      => 'Wall Message',
            'required'   => false,
            'validators' => array(
                    array('validator' => 'StringLength', 'options' => array(0, 255))
                )
        ));

        // Add the wall title
        $this->addElement('text', 'friendmsg', array(
            'label'      => 'Friends Wall Message',
            'required'   => false,
            'validators' => array(
                    array('validator' => 'StringLength', 'options' => array(0, 255))
                )
        ));

        // app message details
        $this->addDisplayGroup(array('wallmsg', 'friendmsg'), 'wallmessages', array('legend' => 'Wall post messages'));

        // Add the submit button
        $this->addElement('submit', 'submit', array(
            'ignore'   => true,
            'label'    => 'Submit',
        ));

        // And finally add some CSRF protection
        $this->addElement('hash', 'csrf', array(
            'ignore' => true,
        ));

        // change markup of elements
        $this->setElementDecorators(array(
            'ViewHelper',
            array(
                'Description',
                array(
                    'tag'    => 'div',
                    'class'  => 'submit-button',
                    'escape' => false
                )
            ),
            array(
                array(
                    'data' => 'HtmlTag'
                ),
                array(
                    'tag'   => 'span',
                    'class' => 'element'
                )
            ),
            array(
                'Label',
                array(
                    'tag'    => 'label',
                    'class' => 'elementLabel',
                    'escape' => false
                )
            ),
            'File',
            array(
                array(
                    'data' => 'HtmlTag'
                ),
                array(
                    'tag'   => 'span',
                    'class' => 'element'
                )
            ),
            array(
                array(
                    'row' => 'HtmlTag'
                ),
                array(
                    'tag'   => 'li',
                    'class' => 'element-row'
                ),
            ),
            'Errors'
        ));

        // change markup of form
        $this->setDecorators(array(
            'FormElements',
            array(
                'HtmlTag',
                array(
                    'tag' => 'div',
                    'id'  => $this->_containerId
                )
            ),
            'Form',
            'Errors'
        ));

    }

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-04T14:46:08.140

您的表单中至少有一个“*文件”*元素，您调用`setDecorators`但没有包含*“文件”*装饰器，这是*“文件”元素***必需**的装饰器：

 *> **35.6.4。Zend_Form_Element_File**
> 
> File 表单元素提供了一种向表单提供文件上传字段的机制。它在内部使用 Zend_File_Transfer 来提供此功能，并使用 FormFile 视图助手作为**文件装饰器**来显示表单元素。*

# java - 在 Struts-2 中使用 iText 生成 PDF：结果类型流不起作用

> ID：12265702
> 
> 赞同：4
> 
> 时间：2012-09-04T14:31:33.753
> 
> 标签：java, jakarta-ee, pdf, struts2, itext

我的要求是使用 iText 生成 PDF 文件，我使用以下代码创建示例 PDF

```
Document document = new Document();
ByteArrayOutputStream baos = new ByteArrayOutputStream();
PdfWriter.getInstance(document, baos);
document.open();
document.add(new Paragraph("success PDF FROM STRUTS"));
document.close();
ServletOutputStream outputStream = response.getOutputStream() ;
baos.writeTo(outputStream);
response.setHeader("Content-Disposition", "attachment; filename=\"stuReport.pdf\"");
response.setContentType("application/pdf");
outputStream.flush();
outputStream.close(); 
```

如果您在上面的代码中看到，iText 没有使用任何 inputStream 参数，而是直接写入响应的输出流。而 struts-2 要求我们使用 InputStream 参数（见下面的配置）

```
<action name="exportReport" class="com.export.ExportReportAction">
    <result name="pdf" type="stream">
        <param name="inputName">inputStream</param>
        <param name="contentType">application/pdf</param>
        <param name="contentDisposition">attachment;filename="sample.pdf"</param>
        <param name="bufferSize">1024</param>
    </result>
</action> 
```

我知道我的类应该有 inputStream 的 getter 和 setter，我在 struts-configuration 中提到的类中也有

```
private InputStream inputStream;
public InputStream getInputStream() {
    return inputStream;
}

public void setInputStream(InputStream inputStream) {
    this.inputStream = inputStream;
} 
```

但是由于 iText 并不真正需要输入流，而是直接写入响应的输出流，因此我得到了异常，因为我没有为 inputStream 参数设置任何内容。

请让我知道如何在 struts-2 中使用 iText 代码，并将 resultType 作为流

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-04T15:19:29.250

找到了解决方案。

执行此 PDF 导出的操作中的方法可以是无效的。当我们直接写入响应的输出流时，不需要结果类型配置

例如，以这种方式让你的动作课

```
Class ExportReportAction extends ActionSupport {
  public void exportToPdf() { // no return type
    try {
        Document document = new Document();
        ByteArrayOutputStream baos = new ByteArrayOutputStream();
        PdfWriter.getInstance(document, baos);
        document.open();
        document.add(new Paragraph("success PDF FROM STRUTS"));
        document.close(); 
        ServletOutputStream outputStream = response.getOutputStream() ; 
        baos.writeTo(outputStream); 
        response.setHeader("Content-Disposition", "attachment; filename=\"stuReport.pdf\""); 
        response.setContentType("application/pdf"); 
        outputStream.flush(); 
        outputStream.close(); 
    }catch (Exception e) {
        //catch
    }

  } 
} 
```

并以这种方式进行您的 struts 配置

```
<action name="exportReport" class="com.export.ExportReportAction"> 
 <!-- NO NEED TO HAVE RESULT TYPE STREAM CONFIGURATION-->
</action> 
```

这很酷！

感谢所有试图回答这个问题的人

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-12-01T06:10:12.287

## 主要答案：

您也可以**`return NONE`**或**`return null`**按照 Apache 文档中的说明：

> 从操作类方法返回**ActionSupport.NONE（或 null）会导致结果处理被跳过。**如果操作完全处理结果处理，例如直接写入 HttpServletResponse OutputStream，这将很有用。
> 
> ***来源：*** [http ://struts.apache.org/release/2.2.x/docs/result-configuration.html](http://struts.apache.org/release/2.2.x/docs/result-configuration.html)

* * *

## 例子：

O'Reilly 提供了关于使用 Servlet[在 Web 应用程序中动态创建 PDF](http://www.onjava.com/pub/a/onjava/2003/06/18/dynamic_files.html?page=1)的教程（SC Sullivan，2003）。它可以转换为 Struts2 动作类，如下所示。

最好有一个帮助类，比如`PDFGenerator`为您创建 PDF 并将其作为`ByteArrayOutputStream`.

**`PDFGenerator`类**：

```
import java.io.ByteArrayOutputStream;
import com.itextpdf.text.*;
import com.itextpdf.text.pdf.*;

public class PDFGenerator {

    public ByteArrayOutputStream generatePDF() throws DocumentException {

        Document doc = new Document();
        ByteArrayOutputStream baosPDF = new ByteArrayOutputStream();            
        PdfWriter pdfWriter = PdfWriter.getInstance(doc, baosPDF);

        try {           
            doc.open();         

            // create pdf here
            doc.add(new Paragraph("Hello World"));

        } catch(DocumentException de) {
            baosPDF.reset();
            throw de;

        } finally {
            if(doc != null) {
                doc.close();
            }

            if(pdfWriter != null) {
                pdfWriter.close();
            }
        }

        return baosPDF;
    }
} 
```

您现在可以在您的操作类中调用它。

**`ViewPDFAction`类**：

```
import java.io.ByteArrayOutputStream;
import java.io.OutputStream;
import javax.servlet.http.HttpServletResponse;
import org.apache.struts2.interceptor.ServletResponseAware;
import com.yoursite.helper.PDFGenerator;
import com.opensymphony.xwork2.ActionSupport;

public class ViewPDFAction extends ActionSupport
    implements ServletResponseAware {

    private static final long serialVersionUID = 1L;    
    private HttpServletResponse response;

    @Override
    public String execute() throws Exception {

        ByteArrayOutputStream baosPDF = new PDFGenerator().generatePDF();    
        String filename = "Your_Filename.pdf"; 

        response.setContentType("application/pdf");
        response.setHeader("Content-Disposition",
            "inline; filename=" + filename); // open in new tab or window           
        response.setContentLength(baosPDF.size());

        OutputStream os = response.getOutputStream();
        os.write(baosPDF.toByteArray());
        os.flush();
        os.close();
        baosPDF.reset();

        return NONE; // or return null
    }

    @Override
    public void setServletResponse(HttpServletResponse response) {
        this.response = response;       
    }
} 
```

**`web.xml`**：

```
<mime-mapping>
    <extension>pdf</extension>
    <mime-type>application/pdf</mime-type>
</mime-mapping> 
```

**`struts.xml`：**

```
<action name="viewpdf" class="com.yoursite.action.ViewPDFAction">
    <!-- NO CONFIGURATION FOR RESULT NONE -->
</action> 
```

# java - 我已经为已经在 BEA 8 上运行的 Weblogic 10 ( BEA 10 ) 修改了一个 EAR。 部署 EAR 时出现以下错误。 [HTTP:101163] 无法加载用户定义的侦听器：com.xxx.xxxx.jmx.LifecycleListener java 问问题 问问题 2012-09-04T14:31:35.917 5853 次 This question shows research effort; it is useful and clear 1 This question does not show any research effort; it is unclear or not useful Bookmark this question. Show activity on this post. 我已经为已经在 BEA 8 上运行的 Weblogic 10 ( BEA 10 ) 修改了一个 EAR。 部署 EAR 时出现以下错误。 [HTTP:101163] 无法加载用户定义的侦听器：com.xxx.xxxx.jmx.LifecycleListener java.lang.NoClassDefFoundError: com/tibco/sdk/MException at java.lang.Class.getDeclaredConstructors0(Native Method) at java.lang .Class.privateGetDeclaredConstructors(Class.java:2357) 在 java.lang.Class.getConstructor0(Class.java:2671) 在 java.lang.Class.newInstance0(Class.java:321) 在 java.lang.Class.newInstance( Class.java:303) 在 weblogic.servlet.internal.WebComponentContributor.getNewInstance(WebComponentContributor.java:187) 在 weblogic.servlet.internal.WebComponentContributor.createListenerInstance 你遇到过这个错误吗？请帮助我... 如何防止 SQL 返回多个结果集 我面临的问题是我有一个存储过程（我们称之为 sp_one），它在运行期间调用另一个存储过程（我们称之为 sp_two）。 我只希望最后返回 sp_one 的结果集，而不是 sp_two 的结果集。我想有一种方法可以从 sp_two 捕获结果，这将阻止它们也被返回，但无法弄清楚它的语法。 有任何想法吗？ 一些捕捉正在发生的事情本质的伪代码（不是我的实际代码）： CREATE PROCEDURE sp_two AS BEGIN update Users set is_valid = 0 select * from Users END CREATE PROCEDURE sp_one AS BEGIN exec sp_two select * from Users END exec sp_one 运行 exec sp_one 的结果是 sp_two 的结果集，然后是 sp_one 的结果。（例如，用户表两次）。 javaweblogic 4 1 回答 1 This answer is useful 1 从异常看来，您的 ear 文件中缺少某些库。确保 com.xxx.xxxx.jmx.LifecycleListener 是一个有效的包并正确地包含在您的耳朵中。 如果您正在使用 JDeveloper 开发和构建 ear，请确保将这个库添加到您的应用程序资源中。如果您手动执行此操作，请确保此库存在于您的 WEB-INF/lib 文件夹中 于 2012-09-04T15:11:04.170 回答 Related 1 java - JDK 1.4 的 SSLEngine 的实现？ 2 ios - 使用场景坐标的 SKSpriteNode zPosition 问题 1 web-services - JAX WS wsdl 生成 - 如何更改服务名称 1 eclipse - 在eclipse中安装git插件 2 python - Flask-WTForms 为 IntegerField 引发错误，而不是验证失败 0 jquery - 使用 Ipad 在 iframe 中查找 PDF 的高度 1 ios - convert multiple EAGLView to UIImage 1 vb.net - 使用 vb.net 替换文本文件中的多个字符 2 java - CardDav 服务器库 7 php - PHP计算财政年度的开始 Reference php × 1429865 c/c++ × 756500 nginx × 49975 mongodb × 159057 mybatis × 3233 anaconda × 13410 pycharm × 14671 python × 1902243 vscode × 56040 docker × 110988 github × 49000 flask × 49129 ffmpeg × 24037 jmeter × 16910 matplotlib × 63493 bootstrap × 54641

> ID：12265704
> 
> 赞同：1
> 
> 时间：
> 
> 标签：java, weblogic

我已经为已经在 BEA 8 上运行的 Weblogic 10 ( BEA 10 ) 修改了一个 EAR。

部署 EAR 时出现以下错误。

*[HTTP:101163] 无法加载用户定义的侦听器：com.xxx.xxxx.jmx.LifecycleListener java.lang.NoClassDefFoundError: com/tibco/sdk/MException at java.lang.Class.getDeclaredConstructors0(Native Method) at java.lang .Class.privateGetDeclaredConstructors(Class.java:2357) 在 java.lang.Class.getConstructor0(Class.java:2671) 在 java.lang.Class.newInstance0(Class.java:321) 在 java.lang.Class.newInstance( Class.java:303) 在 weblogic.servlet.internal.WebComponentContributor.getNewInstance(WebComponentContributor.java:187) 在 weblogic.servlet.internal.WebComponentContributor.createListenerInstance*

你遇到过这个错误吗？请帮助我...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-04T15:11:04.170

从异常看来，您的 ear 文件中缺少某些库。确保 com.xxx.xxxx.jmx.LifecycleListener 是一个有效的包并正确地包含在您的耳朵中。

如果您正在使用 JDeveloper 开发和构建 ear，请确保将这个库添加到您的应用程序资源中。如果您手动执行此操作，请确保此库存在于您的 WEB-INF/lib 文件夹中

# sql - 如何防止 SQL 返回多个结果集

> ID：12265705
> 
> 赞同：3
> 
> 时间：2012-09-04T14:31:38.557
> 
> 标签：sql, tsql, resultset, multiple-resultsets

我面临的问题是我有一个存储过程（我们称之为 sp_one），它在运行期间调用另一个存储过程（我们称之为 sp_two）。

我只希望最后返回 sp_one 的结果集，而不是 sp_two 的结果集。我想有一种方法可以从 sp_two 捕获结果，这将阻止它们也被返回，但无法弄清楚它的语法。

有任何想法吗？

一些捕捉正在发生的事情本质的伪代码（不是我的实际代码）：

```
CREATE PROCEDURE sp_two AS 
BEGIN
  update Users
  set is_valid = 0

  select * from Users
END

CREATE PROCEDURE sp_one
AS
BEGIN
  exec sp_two
  select * from Users
END

exec sp_one 
```

运行 exec sp_one 的结果是 sp_two 的结果集，然后是 sp_one 的结果。（例如，用户表两次）。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-04T14:53:59.550

首先，这是一个[类似的问题](https://stackoverflow.com/questions/605996/ms-sql-suppress-return-value-of-stored-procedure-called-in-stored-procedure)

我不建议使用这种解决方案，因为它很容易成为瓶颈。我想说您应该专注于以更清晰的方式进行数据处理（但是我知道您的问题示例只是一个理论示例）

但是如果你真的想使用这样的东西，我会说测量返回行的危险：

1：返回多少行？

2：返回集有多宽？

如果您认为“好吧，这没什么大不了的”，那么我会说使用内存表而不是临时表（不要进行物理写入）：

```
DECLARE @users TABLE (...fields here...)
INSERT INTO @users
EXEC sp_two 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-04T14:35:18.977

在`sp_one`中，您可以使用

```
CREATE TABLE #temporaryusers (Usertable fields here)
INSERT INTO #temporaryusers 
EXEC sp_two 

DROP TABLE #temporaryusers 
```

吞下你的结果。

# android - new File(uri.toString()) 返回文件未找到

> ID：12265706
> 
> 赞同：3
> 
> 时间：2012-09-04T14:31:44.427
> 
> 标签：android, file, uri

我有一个 URI，我想从这个 URI 创建一个文件：

```
fileUri = file:///mnt/sdcard/20120904_162830.png;

File fichero = new File(fileUri.toString(); 
```

这工作正常但是当我尝试创建使用或`fichero.exist() = false`

如何从中创建文件`fileUri`？

解决方案：

```
fichero = new File(fileUri.getPath());//for camera
                    if (!fichero.exists()) {
                        fichero = new File(getRealPathFromURI(fileUri));//for gallery
                    }

public String getRealPathFromURI(Uri contentUri) {
        String[] proj = { MediaStore.Images.Media.DATA };
        @SuppressWarnings("deprecation")
        Cursor cursor = managedQuery(contentUri, proj, null, null, null);
        int column_index = cursor.getColumnIndexOrThrow(MediaStore.Images.Media.DATA);
        cursor.moveToFirst();
        return cursor.getString(column_index);
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-04T14:37:05.777

尝试这个：

```
File fichero = new File(fileUri.getPath()); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-04T14:34:54.147

```
File dir = Environment.getExternalStoragePublicDirectory(Environment.DIRECTORY_DCIM);
File output = new File(dir,"20120904_162830.png"); 
```

将此权限添加到清单...

```
<uses-permission android:name="android.permission.WRITE_EXTERNAL_STORAGE" /> 
```

**编辑 ：**

```
String filename= output.getAbsolutePath();
filename= str.subString(str.indexOf("/"),str.length()); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-04T14:40:51.980

这是解决方案

```
fileUri = "file:///mnt/sdcard/20120904_162830.png";

URI fUri = new URI(fileUri);

File fichero = new File(fileUri.getPath()); 
```

仅当您未在 fileUri 中提供任何网址时，此方法才有效

# javascript - 如何重置搜索表单中的特定表单元素？

> ID：12265708
> 
> 赞同：0
> 
> 时间：2012-09-04T14:31:46.083
> 
> 标签：javascript, jquery

我有一个搜索表单，其中包含不同的元素、复选框、选择、文本字段等。每次更改都伴随着一个 ajax 调用，该调用将结果数作为一种计数器。我只想重置导致计数器返回值 0 的前一个元素。

我正在考虑跟踪变量中的每个更改，并且每次计数器评估为 0 时，我都会重置导致更改的元素。然而，我担心这可能会迫使我用大量代码和跳跃来以不同的方式处理所有不同的元素。

对于任何人都可以想到的问题，是否有可能更优雅的解决方案？我将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-04T14:56:04.597

我无法评论您的问题，但是：如果我理解正确，则有一个很大的表单，并且*任何*元素的每次更改都会触发一个 ajax 调用，该调用会返回一个结果集。

如果此结果集大小为零，则您希望表单重置为以前的值。

这意味着，只有最后更改的值必须被追踪并重置？

在这种情况下，您的`onchange`事件回调应该使用`this`value 来获取当前表单元素的值和 ID。然后，当结果集返回时，如果没有行，则将存储的值设置回该元素。

否则，如果表单是全局管理的，您总是可以通过`.clone()`调用来存储它，然后如果结果集为空，则`.remove()`它和克隆返回。`.insert()`

PS：我知道这个解决方案不是很*优雅*:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-04T14:36:00.087

您的 AJAX 模块可以返回一个 JSON 编码的字符串，其中包含导致此事件发生的数据（PHP 函数：JSON_encode），然后您可以循环通过错误值重置它们并显示更多信息。即“您的电子邮件似乎无效”。

PHP：请参阅 JSON_encode JavaScript：请参阅 getElementsByTagName('input')（或 textarea 或 select） 注意：如果是选择项，您可能更愿意更改属性“selectedIndex”而不是“value”。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-06T15:12:39.680

我通过记录对表单的每次更改来解决问题

```
$("#form_id").on("change", function(event) {
  //Event bubbling
  type = $(event.target).get(0).type;
  selector = $(event.target);
} 
```

然后使用策略设计模式[（Javascript 策略设计模式）](http://weblog.bocoup.com/the-strategy-pattern-in-javascript/)，我相应地重置了每个可能的字段类型。文本字段的示例，

```
var Fields = {
  "text": {
    resetAction: function(fieldSelector) {
      fieldSelector.val('');
    }
  }
};

//To call the reset action for the type of field,
Fields[type].resetAction(selector); 
```

我必须触发隐藏字段的更改事件才能使其更改也冒泡。

# php - 从管理页面重定向到前端的 postAction

> ID：12265714
> 
> 赞同：0
> 
> 时间：2012-09-04T14:32:07.470
> 
> 标签：php, magento, redirect, magento-1.7

**编辑后的代码：**现在我没有收到 404 错误，但另一方面，数据库或异常日志中没有添加任何内容。

我需要从我的模型 php 文件中调用第三方模块（[来自 aheadWorks 的 VideoTestimonials](http://ecommerce.aheadworks.com/magento-extensions/video-testimonials.html)）上的 postAction 函数，以便重用他们的所有代码以获得所需的功能并避免将来出现错误，如果我只是复制代码并随意修改。

在上一个[问题](https://stackoverflow.com/questions/12217308/extending-overriding-extension-in-magento)上，我猜想，通过使用`setRedirect`. 这是我在我的 php 模型文件中使用的代码，用于尝试重定向到前端的 postAction：

```
<?php
class Dts_Videotestimonials_Model_SearchVideo extends Mage_Core_Model_Abstract
{

    function printVideoEntry($videoEntry, $_product, $tabs = "")
    {
        # get user data
        $user = Mage::getSingleton('admin/session');
        $userName = $user->getUser()->getFirstname();
        $userEmail = $user->getUser()->getEmail();
        $data = array(
            "ProductId" => $_product->getId(),
                        "AuthorEmail" => $userEmail,
                        "AuthorName" => $userName,
                        "VideoLink" => $videoEntry->getVideoWatchPageUrl(),
                        "VideoType"  => "link",
                        "Title" => $videoEntry->getVideoTitle(),
                        "Comment" => "this is a comment"
        );
        $actionUrl = Mage::getUrl('vidtest/youtube/post', $data);
        Mage::app()->getResponse()->setRedirect($actionUrl);
    }
} 
```

一步一步地进行所有修改（在@Francesco的帮助下）我到了这一点。但是当我拨打这个电话时，我收到了一个`404 Error`. 怎么了？

我正在研究这个[SO 问题/答案](https://stackoverflow.com/questions/11792962/magento-module-with-frontend-and-admin-functionality)以及[Magento 论坛上的这篇文章，](http://www.magentocommerce.com/boards/viewthread/281412/#t398311)但我无法明确自己。第二个是来自事件观察者的重定向，我不知道它是否有帮助。

这是此错误的完整异常日志：

```
2012-09-04T14:25:17+00:00 ERR (3): 
exception 'Zend_Controller_Response_Exception' with message 'Invalid HTTP response code' in C:\wamp\www\magento\lib\Zend\Controller\Response\Abstract.php:286
Stack trace:
#0 C:\wamp\www\magento\lib\Zend\Controller\Response\Abstract.php(150): Zend_Controller_Response_Abstract->setHttpResponseCode(Array)
#1 C:\wamp\www\magento\app\code\core\Mage\Core\Controller\Response\Http.php(106): Zend_Controller_Response_Abstract->setRedirect('http://127.0.0....', Array)
#2 C:\wamp\www\magento\app\code\local\Dts\Videotestimonials\Model\SearchVideo.php(64): Mage_Core_Controller_Response_Http->setRedirect('http://127.0.0....', Array)
#3 C:\wamp\www\magento\app\code\local\Dts\Videotestimonials\Model\SearchVideo.php(198): Dts_Videotestimonials_Model_SearchVideo->printVideoEntry(Object(Zend_Gdata_YouTube_VideoEntry), Object(Mage_Catalog_Model_Product))
#4 C:\wamp\www\magento\app\code\local\Dts\Videotestimonials\Model\SearchVideo.php(244): Dts_Videotestimonials_Model_SearchVideo->printVideoFeed(Object(Zend_Gdata_YouTube_VideoFeed), Object(Mage_Catalog_Model_Product), 'Search results ...')
#5 C:\wamp\www\magento\app\code\local\Dts\Videotestimonials\controllers\Adminhtml\VideotestimonialsbackendController.php(28): Dts_Videotestimonials_Model_SearchVideo->searchAndPrint('s')
#6 C:\wamp\www\magento\app\code\core\Mage\Core\Controller\Varien\Action.php(419): Dts_Videotestimonials_Adminhtml_VideotestimonialsbackendController->postAction()
#7 C:\wamp\www\magento\app\code\core\Mage\Core\Controller\Varien\Router\Standard.php(250): Mage_Core_Controller_Varien_Action->dispatch('post')
#8 C:\wamp\www\magento\app\code\core\Mage\Core\Controller\Varien\Front.php(176): Mage_Core_Controller_Varien_Router_Standard->match(Object(Mage_Core_Controller_Request_Http))
#9 C:\wamp\www\magento\app\code\core\Mage\Core\Model\App.php(354): Mage_Core_Controller_Varien_Front->dispatch()
#10 C:\wamp\www\magento\app\Mage.php(683): Mage_Core_Model_App->run(Array)
#11 C:\wamp\www\magento\index.php(87): Mage::run('', 'store')
#12 {main} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-04T14:54:44.763

您使用 getUrl 和 getBaseUrl 是一回事，您可以使用以下代码：

```
$this->_redirect('module/controller/action','parameters'); 
```

但是你在你的班级上扩展了 Mage_Adminhtml_Controller_Action。这是最好的方法。如果不是控制器，所以你不应该做这个重定向。

# java - 如何设置摆动组件的大小

> ID：12265715
> 
> 赞同：1
> 
> 时间：2012-09-04T14:32:09.417
> 
> 标签：java, swing, customization, jtextfield

我想自定义 JTextField 对象的高度和宽度。我尝试过使用 setSize 方法，将宽度和高度作为维度和 int 传递。但它们似乎都不起作用。我是否遗漏了一些东西，比如面板上的一些强制性方法调用或一些东西，以便尺寸自定义有效？请帮忙。提前致谢。

编辑：这是一些代码：

```
public class WestPanel extends JPanel{
private JLabel dateL;
private JTextField date;
public WestPanel(){
setBackground(Color.white);
setLayout(new GridLayout(1,2,0,0));
dateL=new JLabel("Date: ");
date=new JTextField("dd/mm/yyyy");
date.setSize(60,10);
add(dateL);
add(date);
//....remaining code....// 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-04T14:34:41.090

让布局管理器处理您的 Swing 组件的尺寸，但如果您绝对必须，请`setPreferredSize`与尊重该属性的布局管理器结合使用。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-09-04T15:56:03.407

我不确定这是否能回答原始发帖者的问题，但希望它对其他 Swing 开发人员有所帮助。

大多数人希望标签和组件对齐，就像我创建的以下对话框一样。

![在此处输入图像描述](../Images/ca7cb51e2a5b6d63fa8a9680a944fe44.png)

我使用 Swing 布局管理器 GridBagLayout 来创建这种类型的布局。这里没有大量解释，而是创建此对话框的代码。

```
package com.ggl.business.planner.view;

import java.awt.Component;
import java.awt.Container;
import java.awt.Dialog;
import java.awt.Dimension;
import java.awt.FlowLayout;
import java.awt.Font;
import java.awt.GridBagConstraints;
import java.awt.GridBagLayout;
import java.awt.Insets;
import java.awt.Rectangle;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;

import javax.swing.JButton;
import javax.swing.JLabel;
import javax.swing.JPanel;
import javax.swing.JSpinner;
import javax.swing.SpinnerNumberModel;
import javax.swing.SwingConstants;

import com.ggl.business.planner.model.BusinessPlannerModel;
import com.ggl.business.planner.view.extended.EscapeDialog;
import com.ggl.business.planner.view.extended.JFontChooser;

public class OptionsDialog {

    protected static final Insets entryInsets = new Insets(0, 10, 4, 10);
    protected static final Insets spaceInsets = new Insets(10, 10, 4, 10);
    protected static final Insets noInsets    = new Insets(0, 0, 0, 0);
    protected static final Insets iconInsets  = new Insets(0, 4, 0, 0);

    protected BusinessPlannerFrame frame;

    protected BusinessPlannerModel model;

    protected EscapeDialog dialog;

    protected JButton activityTextFontButton;
    protected JButton connectorTextFontButton;

    protected JSpinner borderSizeSpinner;

    protected SpinnerNumberModel spinnerNumberModel;

    protected boolean okPressed;

    public OptionsDialog(BusinessPlannerModel model, BusinessPlannerFrame frame) {
        this.model = model;
        this.frame = frame;
        createPartControl();
    }

    protected void createPartControl() {
        dialog = new EscapeDialog();
        dialog.setTitle("Business Planner Options");
        dialog.setLayout(new GridBagLayout());

        int gridy = 0;
        gridy = createBorderFields(gridy);
        gridy = createFontFields(gridy);
        gridy = createButtonFields(gridy);

        dialog.pack();
        dialog.setBounds(dialogBounds());
        dialog.setModalityType(Dialog.ModalityType.APPLICATION_MODAL);
        dialog.setVisible(true);
    }

    protected int createBorderFields(int gridy) {
        JLabel borderSizeLabel = new JLabel("Border size:");
        borderSizeLabel.setHorizontalAlignment(SwingConstants.LEFT);
        addComponent(dialog, borderSizeLabel, 0, gridy, 1, 1, spaceInsets,
                GridBagConstraints.LINE_START, GridBagConstraints.HORIZONTAL);

        spinnerNumberModel = new SpinnerNumberModel(model.getActivityBorder(), 1, 5, 1);
        borderSizeSpinner = new JSpinner(spinnerNumberModel);
        addComponent(dialog, borderSizeSpinner, 1, gridy++, 4, 1, spaceInsets,
                GridBagConstraints.LINE_START, GridBagConstraints.HORIZONTAL);

        return gridy;
    }

    protected int createFontFields(int gridy) {
        JLabel boxtextFontLabel = new JLabel("Activity text font:");
        boxtextFontLabel.setHorizontalAlignment(SwingConstants.LEFT);
        addComponent(dialog, boxtextFontLabel, 0, gridy, 1, 1, spaceInsets,
                GridBagConstraints.LINE_START, GridBagConstraints.HORIZONTAL);

        Font font = model.getActivityFont();
        activityTextFontButton = new JButton(getFontText(font));
        activityTextFontButton.setFont(font);
        activityTextFontButton.addActionListener(new ActionListener() {
            @Override
            public void actionPerformed(ActionEvent event) {
                JFontChooser fontChooser = new JFontChooser();
                fontChooser.setSelectedFont(model.getActivityFont());
                int result = fontChooser.showDialog(dialog);
                if (result == JFontChooser.OK_OPTION) {
                    Font font = fontChooser.getSelectedFont();
                    String text = getFontText(font);
                    model.setActivityFont(font);
                    activityTextFontButton.setText(text);
                    activityTextFontButton.setFont(font);
                    JButton dummy = new JButton(text);
                    setButtonSizes(activityTextFontButton, 
                            connectorTextFontButton, dummy);
                    dialog.validate();
                    dialog.pack();
                }
            }
        });
        addComponent(dialog, activityTextFontButton, 1, gridy++, 4, 1, spaceInsets,
                GridBagConstraints.LINE_START, GridBagConstraints.HORIZONTAL);

        JLabel connectortextFontLabel = new JLabel("Connector text font:");
        connectortextFontLabel.setHorizontalAlignment(SwingConstants.LEFT);
        addComponent(dialog, connectortextFontLabel, 0, gridy, 1, 1, spaceInsets,
                GridBagConstraints.LINE_START, GridBagConstraints.HORIZONTAL);

        font = model.getConnectorFont();
        connectorTextFontButton = new JButton(getFontText(font));
        connectorTextFontButton.setFont(font);
        connectorTextFontButton.addActionListener(new ActionListener() {
            @Override
            public void actionPerformed(ActionEvent event) {
                JFontChooser fontChooser = new JFontChooser();
                fontChooser.setSelectedFont(model.getConnectorFont());
                int result = fontChooser.showDialog(dialog);
                if (result == JFontChooser.OK_OPTION) {
                    Font font = fontChooser.getSelectedFont();
                    String text = getFontText(font);
                    model.setConnectorFont(font);
                    connectorTextFontButton.setText(text);
                    connectorTextFontButton.setFont(font);
                    JButton dummy = new JButton(text);
                    setButtonSizes(activityTextFontButton, 
                            connectorTextFontButton, dummy);
                    dialog.validate();
                    dialog.pack();
                }
            }
        });
        addComponent(dialog, connectorTextFontButton, 1, gridy++, 4, 1, spaceInsets,
                GridBagConstraints.LINE_START, GridBagConstraints.HORIZONTAL);

        setButtonSizes(activityTextFontButton, connectorTextFontButton);

        return gridy;
    }

    protected String getFontText(Font font) {
        StringBuilder builder = new StringBuilder();

        builder.append(font.getName());
        builder.append(", ");
        builder.append(font.getSize());
        builder.append(" points, ");

        if (font.isPlain()) {
            builder.append("plain");
        } else if (font.isBold()) {
            builder.append("bold ");
        } else if (font.isItalic()) {
            builder.append("italic");
        } 

        return builder.toString();
    }

    protected int createButtonFields(int gridy) {
        JPanel buttondrawingPanel = new JPanel();
        buttondrawingPanel.setLayout(new FlowLayout());

        JButton okButton = new JButton("OK");
        okButton.addActionListener(new ActionListener() {
            @Override
            public void actionPerformed(ActionEvent event) {
                //TODO Add edits to make sure fields are filled correctly
                setModel();
                okPressed = true;
                dialog.setVisible(false);
            }       
        });
        dialog.setOkButton(okButton);
        buttondrawingPanel.add(okButton);

        JButton cancelButton = new JButton("Cancel");
        cancelButton.addActionListener(new ActionListener() {
            @Override
            public void actionPerformed(ActionEvent event) {
                okPressed = false;
                dialog.setVisible(false);
            }
        });
        buttondrawingPanel.add(cancelButton);

        setButtonSizes(okButton, cancelButton);

        addComponent(dialog, buttondrawingPanel, 0, gridy++, 5, 1, spaceInsets,
                GridBagConstraints.LINE_START, GridBagConstraints.HORIZONTAL);

        return gridy;
    }

    protected void addComponent(Container container, Component component,
            int gridx, int gridy, int gridwidth, int gridheight, 
            Insets insets, int anchor, int fill) {
        GridBagConstraints gbc = new GridBagConstraints(gridx, gridy,
                gridwidth, gridheight, 1.0D, 1.0D, anchor, fill, insets, 0, 0);
        container.add(component, gbc);
    }

    protected void setButtonSizes(JButton ... buttons) {
        Dimension preferredSize = new Dimension();
        for (JButton button : buttons) {
            Dimension d = button.getPreferredSize();
            preferredSize = setLarger(preferredSize, d);
        }
        for (JButton button : buttons) {
            button.setPreferredSize(preferredSize);
        }
    }

    protected Dimension setLarger(Dimension a, Dimension b) {
        Dimension d = new Dimension();
        d.height = Math.max(a.height, b.height);
        d.width = Math.max(a.width, b.width);
        return d;
    }

    protected void setModel() {
        model.setActivityBorder(spinnerNumberModel.getNumber().intValue()); 
    }

    protected Rectangle dialogBounds() {
        int margin = 200;
        Rectangle bounds = dialog.getBounds();
        Rectangle f = frame.getFrame().getBounds();

        bounds.x = f.x + margin;
        bounds.y = f.y + margin;

        return bounds;
    }

    public boolean isOkPressed() {
        return okPressed;
    }

} 
```

我扩展的 EscapeDialog 类只允许我使用 Esc 键关闭对话框，就像我左键单击取消按钮一样。

有两点我要注意。第一个是 addComponent 方法，它简化了向 GridBagLayout 添加组件的过程。

第二个是 setButtonSizes 方法，它使所有按钮大小统一。即使它们是 JButton 组件，而不是 JTextField 组件，如果您想让 JTextField 组件大小相同，您也可以执行类似的操作。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-09-04T14:33:25.937

该`setSize()`方法仅在将布局管理器设置为 null 时有效。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-09-04T15:55:08.147

正如评论中所建议的，在文本字段构造函数中使用大小提示，以及适当的布局管理器。

![西面板](../Images/0eedb463cb14d1d0a870ef9e05e2c144.png)

```
import java.awt.*;
import javax.swing.*;

public class WestPanel extends JPanel {

    private JLabel dateL;
    private JTextField date;

    public WestPanel(){
        setBackground(Color.white);
        setLayout(new FlowLayout());
        dateL=new JLabel("Date: ");
        date=new JTextField("dd/mm/yyyy",6);
        add(dateL);
        add(date);
    }

    public static void main(String[] args) {
        Runnable r = new Runnable() {
            @Override
            public void run() {
                JPanel gui = new JPanel(new BorderLayout());
                gui.add(new WestPanel(), BorderLayout.LINE_START);
                gui.setBackground(Color.ORANGE);
                JOptionPane.showMessageDialog(null, gui);
            }
        };
        SwingUtilities.invokeLater(r);
    }
} 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-09-04T14:33:15.663

Swing 中组件的大小取决于您使用的布局管理器的类型。如果你想完全控制 UI，你可以使用 Freeflow 布局。

在此处阅读完整的故事：http: [//docs.oracle.com/javase/tutorial/uiswing/layout/using.html](http://docs.oracle.com/javase/tutorial/uiswing/layout/using.html)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-09-04T14:36:48.553

JTextField 不能设置大小，事实上，你应该使用 JTextArea 来代替。

# c# - 将 WCF 添加到现有网站或有新服务？

> ID：12265719
> 
> 赞同：1
> 
> 时间：2012-09-04T14:32:36.740
> 
> 标签：c#, asp.net, wcf, visual-studio, wcf-data-services

我是 WCF 世界的新手。我有一个 ASP.net (v4) 网站在我们专用的 windows 2008 服务器上运行。我将网站称为 webisteA.com

我正在创建一个新网站 websiteB.com.au，我想将 WebsiteA.com 中的功能公开给新网站。比如登录，在数据库中注册等。

我认为最好的方法是创建一个位于 WebsiteA.com 中的 WCF 服务 - 但我正在努力寻找有关如何做到这一点的任何教程。有很多关于创建新项目的内容，但关于将 WCF 服务添加到现有网站的内容并不多。

这是最好的方法吗？将来我也想在未来将这项服务用于移动应用程序 - 不确定这是否会有所作为。

或者 - 我是否在完全独立于 websiteA.com 和 websiteB.com 的新应用程序中创建新服务并将其托管为 website0.com 并通过它公开数据库？

我没有答案的问题是……安静吗？我使用 XML 还是 JSON？

Baiscally，我希望能够像 API 一样使用它——例如，说“向我展示所有符合标准 X 的成员”。

感谢您提供任何信息。

ps）我有visual studio express 2010 c#（和studio pro的试用版）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-04T15:59:17.823

您当然可以在网站 A 项目中包含 WCF - 但您是否考虑过[ASP.NET Web API](http://www.asp.net/web-api)？我还没有使用它——但确实使用了产生它的早期 WCF Web API。

简洁的功能包括[内容协商](http://www.strathweb.com/2012/07/everything-you-want-to-know-about-asp-net-web-api-content-negotation/)（如果客户端要求 XML，API 发送 XML。如果它要求 JSON，则获取 JSON）和更少的配置（WCF web.configs 是可怕的并且完全过于复杂的 IMO）

使用 ASP.NET Web API 制作 RESTy API 可能比使用标准 WCF 容易得多。

[NancyFX](http://nancyfx.org/)是一个很棒的开源 .NET 解决方案，它也非常值得一看。

# php - 将 magento 迁移到新服务器会导致模板不完整

> ID：12265720
> 
> 赞同：0
> 
> 时间：2012-09-04T14:32:40.063
> 
> 标签：php, mysql, magento, magento-1.6

我正在本地安装 Magento，当我尝试将源上传到生产服务器时，它开始发生一些非常令人沮丧的事情：主页输出不完整，我只看到页面的一部分而不是看到整个页面。

我压缩了本地副本并使用*scp*传输，所以我认为它不会是一些丢失的文件，我唯一更新的是*媒体*目录，但据我所知，它与媒体资产有关，与模板无关。 ..我上传了好几次源码，都没有...

数据库也是同一个副本，所以这不是问题。输出 HTML 是不同的（例如，它还缺少结束 body 和 html 标记。

有什么问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-04T15:04:05.867

尝试这个：

[http://www.magentocommerce.com/_media/magento-check.zip](http://www.magentocommerce.com/_media/magento-check.zip)

[http://www.magentocommerce.com/system-requirements](http://www.magentocommerce.com/system-requirements)

由于唯一的区别是服务器，您需要确保它检查了所有这些先决条件。

# android - 为什么Android 2.3.3 7寸平板使用xlarge资源？

> ID：12265721
> 
> 赞同：5
> 
> 时间：2012-09-04T14:32:40.747
> 
> 标签：android, android-layout

我的应用程序具有不同的 xlarge 屏幕布局和样式。这很重要，因为在手机上它只用于纵向，而在平板电脑上它只用于横向。

几天前，一位用户联系了我，因为自从我发布了带有平板电脑布局的更新后，他在我的主要活动中看不到一些对象（在此更新之前，我只有纵向布局 - 也在平板电脑上）。他使用的是运行 Android 2.3.3 的 7 英寸平板电脑，出于某种奇怪的原因，它使用了 xlarge 目录中的布局和样式，即使它应该使用默认布局和样式。

我在模拟器上测试过，也遇到了同样的问题。然后我只将 android 版本更改为 3.1（没有更改宽度、高度和密度），它按预期工作 - 使用了默认布局。

我不想使用版本限定符（layout-xlarge-v13），因为这样使用具有 xlarge 屏幕的旧 android 版本的用户会得到错误的布局。对于 android 3.2 及更高版本，我可以使用 sw720dp 但旧版本不会使用这个，所以问题仍然存在。

我可以在运行时判断设备对于 xlarge 布局来说不够大，但在这种情况下我该怎么办？有没有办法让它使用默认资源？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-04T14:54:54.673

自 Honeycomb 发布以来，Android 并没有为任何运行 Gingerbread 或更低版本的 7 英寸平板电脑提供支持。这意味着您的设备必须是旧设备或不符合 CTS 标准。您正在查看一个极小的设备池，它们是：API 级别 7-10（大约），尺寸为 7-10 英寸，位于主要 Android 生态系统之外。

如果您想支持此类设备，我建议您制作 layout-large-v7 和 layout-large-v11。假设这些非标准平板电脑将选择第一个，并设计用于低密度或中等密度的 1024x600 像素显示器。

# php - 此 url 的 mod-rewrite 规则

> ID：12265723
> 
> 赞同：0
> 
> 时间：2012-09-04T14:32:46.587
> 
> 标签：php, mod-rewrite

你能帮我为这个网址创建一个修改重写规则吗？

```
http://localhost/view.php?item_id=28&sef=2009-bristol-blenheim-in-west-yorkshire 
```

我想让它去

```
http://localhost/view.php?item_id=28 
```

我希望我的链接看起来像这样

```
http://localhost/view/28/2009-bristol-blenheim-in-west-yorkshire 
```

我目前正在将此规则用于另一个页面

```
RewriteRule ^category/[!/.]*([A-Za-z]+)/?$ /browse.php?cat=$1    [NC,L] 
```

但似乎无法更新它以适用于这个..

**当前的 htaccess**

```
RewriteEngine On
Options +FollowSymLinks

# Browse Category
RewriteRule ^category/[!/.]*([A-Za-z]+)/?$ /browse.php?cat=$1    [NC,L]

# View Item
RewriteRule ^view/([0-9]+)/([a-zA-Z0-9-]+)$ /view.php?item_id=$1&sef=$2 [NC] 
```

浏览类别有效，查看项目无效

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-04T19:35:39.333

如果您想要一个请求，例如

```
http://localhost/view/28/2009-bristol-blenheim-in-west-yorkshire 
```

默默地成为服务器请求

```
http://localhost/view.php?item_id=28&sef=2009-bristol-blenheim-in-west-yorkshire 
```

然后试试这个：

```
RewriteRule ^view/([0-9]+)/([a-zA-Z0-9-]+)$ /view.php?item_id=$1&sef=$2 [NC] 
```

# solr - Solr 数据导入错误日志

> ID：12265726
> 
> 赞同：1
> 
> 时间：2012-09-04T14:32:57.500
> 
> 标签：solr, lucene, dataimporthandler

我在我维护的一个 Wordpress 网站上安装了 Solr 3.6 支持搜索，今天早上我看到 Sorl 无法执行数据导入。我试图运行[http://example.com:9393/solr/wordpress/dataimport?command=full-import](http://example.com:9393/solr/wordpress/dataimport?command=full-import)。直到今天，导入会愉快地进行，现在我只收到消息，`Indexing failed. Rolled back all changes.`

我可能遗漏了一些明显的东西，但是 Solr 将数据导入日志保存在哪里？我想检查它们以了解问题所在，但我无法找到正确的日志。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-04T16:30:11.020

Solr 没有用于数据导入的专用日志文件，与数据导入过程相关的日志语句将写入 Solr 写入的标准日志文件。如果您使用的是 Tomcat，它应该是`../logs/catalina.out`.

错误可能是由 Solr、数据源之间的任何数量的问题引起的，也许是数据本身。您可能还想检查以下问题

[索引失败。回滚所有更改。(Solr 数据导入)](https://stackoverflow.com/questions/11990015/indexing-failed-rolled-back-all-changes-solr-dataimport)

[solr 数据导入错误：索引失败。回滚所有更改](https://stackoverflow.com/questions/8234598/solr-dataimport-error-indexing-failed-rolled-back-all-changes)

# git - 在 Git 中使用 receive.denyCurrentBranch 有什么后果？

> ID：12265729
> 
> 赞同：53
> 
> 时间：2012-09-04T14:33:09.227
> 
> 标签：git, git-push, git-config, git-non-bare-repository

我有一个 Git 存储库。我已经克隆了存储库并且可以提交我的本地更改。当我将更改推送到服务器时，它可以工作。

一旦我创建了一个分支，我就签出该分支，提交我的工作，然后签出 master 分支。然后我将本地更改合并到主分支中。当我尝试推送到服务器时，出现以下异常：

```
Welcome to Git (version 1.7.11-preview20120620)

Run 'git help git' to display the help index.
Run 'git help <command>' to display help for specific commands.

$ git push origin master:master
 Counting objects: 9, done.
 Delta compression using up to 4 threads.
 Compressing objects: 100% (7/7), done.
 Writing objects: 100% (8/8), 13.68 KiB, done.
 Total 8 (delta 2), reused 1 (delta 0)
 Unpacking objects: 100% (8/8), done.
 remote: error: refusing to update checked out branch: refs/heads/master
 remote: error: By default, updating the current branch in a non-bare repository
 remote: error: is denied, because it will make the index and work tree inconsistent
 remote: error: with what you pushed, and will require 'git reset --hard' to match
 remote: error: the work tree to HEAD.
 remote: error:
 remote: error: You can set 'receive.denyCurrentBranch' configuration variable to

 remote: error: 'ignore' or 'warn' in the remote repository to allow pushing into

 remote: error: its current branch; however, this is not recommended unless you
 remote: error: arranged to update its work tree to match what you pushed in some

 remote: error: other way.
 remote: error:
 remote: error: To squelch this message and still keep the default behaviour, set

 remote: error: 'receive.denyCurrentBranch' configuration variable to 'refuse'.
 To c:/jGit
 ! [remote rejected] master -> master (branch is currently checked out)
 error: failed to push some refs to 'c:/gitRepository' 
```

一种解决方案是运行以​​下命令：

```
git config receive.denyCurrentBranch ignore 
```

**在此之后它可以工作，但我想知道为什么我需要使用这个选项。这是唯一的选择吗？这样做的后果是什么？**

我真正想做的是创建分支，将它们合并到主分支中，然后将我的更改推送到服务器。

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2014-07-30T18:17:03.073

## 为什么 Git 不允许你推送到非裸仓库

原海报说：

> 一种解决方案是运行以​​下命令：
> 
> ```
> git config receive.denyCurrentBranch ignore 
> ```
> 
> 在此之后它可以工作，但我想知道为什么我需要使用这个选项。这是唯一的选择吗？这样做的后果是什么？

[正如我在回答类似问题](https://stackoverflow.com/a/24987631/456814)时指出的那样，从 Git 版本 1.6.2 开始，[Git 默认不会让您推送到非裸存储库](https://github.com/git/git/blob/v1.6.2/Documentation/RelNotes-1.6.2.txt#L4-L7)。这是因为该`git push`命令仅更新远程存储库上的分支和`HEAD`引用。它*不做*的也是更新该非裸远程中的工作副本和暂存区域。

因此，当您`git status`在远程仓库中使用时，您会看到该仓库的先前状态仍然存在于工作副本中（并暂存在索引中）：

```
$ git status
On branch master
Changes to be committed:
  (use "git reset HEAD <file>..." to unstage)

        new file:   previous-state.txt 
```

`receive.denyCurrentBranch`如果您查看当您第一次尝试将设置设置为默认值的情况下推送到非裸远程仓库时收到的错误消息，`refuse`您会看到该消息告诉您基本相同的事情：

```
error: refusing to update checked out branch: refs/heads/master
error: By default, updating the current branch in a non-bare repository
error: is denied, because it will make the index and work tree inconsistent
error: with what you pushed, and will require 'git reset --hard' to match
error: the work tree to HEAD.
error:
error: You can set 'receive.denyCurrentBranch' configuration variable to
error: 'ignore' or 'warn' in the remote repository to allow pushing into
error: its current branch; however, this is not recommended unless you
error: arranged to update its work tree to match what you pushed in some
error: other way. 
```

## 你真的应该只推送到裸 Git 存储库

正如在其他一些答案中所指出的那样，由于[我](https://stackoverflow.com/a/12266187/456814)[在](https://stackoverflow.com/a/12266232/456814)上面指出的原因以及 Git 本身告诉您的原因，您不应该真正推送到非裸存储库。

因此，就像[这个答案](https://stackoverflow.com/a/2199939/456814)所说的那样，将现有的非裸仓库转换为裸仓库的一种简单方法是将其重新克隆为裸仓库：

```
git clone --bare old-repo 
```

或者您可以尝试弄乱`core.bare`配置设置，如[本答案](https://stackoverflow.com/a/2200662/456814)中所述。

* * *

## 回答 #2

> 赞同：30
> 
> 时间：2012-09-04T14:57:15.920

您推送到的服务器应该使用裸存储库。

[如何将普通的 Git 存储库转换为裸存储库？](https://stackoverflow.com/questions/2199897/how-to-convert-a-git-repository-from-normal-to-bare)

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2017-02-17T07:06:07.067

我遇到了同样的错误，需要将存储库作为在线开发测试页面运行（也就是说，我猜是为了保留一个非裸仓库）。希望我通过使用这一系列命令（从 gi​​t 2.3 开始）启动存储库来解决它：

```
git init
git config --global user.email "your@mail.here"
git config --global user.name "Your Name"
git commit
git config receive.denyCurrentBranch updateInstead 
```

如此处所示： [无法推送到 git 存储库](https://stackoverflow.com/questions/3221859/cannot-push-into-git-repository)

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2012-09-04T15:00:18.227

您应该在服务器上有一个裸存储库，而不是一个带有签出工作树的存储库。Git 告诉您它拒绝覆盖当前在服务器上签出的分支。

有关如何将服务器上的非裸存储库转换为裸存储库的信息，请参阅[此答案。](https://stackoverflow.com/questions/2199897/how-to-convert-a-git-repository-from-normal-to-bare)

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2014-12-03T03:47:40.253

问题的尸检

当一个分支被签出时，提交将添加一个以当前分支的头部作为其父分支的新提交，并将分支的头部移动到该新提交。

所以

```
A ← B
    ↑
[HEAD,branch1] 
```

变成

```
A ← B ← C
        ↑
    [HEAD,branch1] 
```

但是如果有人可以在中间推送到那个分支，用户就会进入 git 所说的分离头模式：

```
A ← B ← X
    ↑   ↑
[HEAD] [branch1] 
```

现在用户不再在 branch1 中，没有明确要求签出另一个分支。更糟糕的是，用户现在在任何分支之外，任何新的提交都只是悬空：

```
 [HEAD]
        ↓
        C
      ↙
A ← B ← X
        ↑
       [branch1] 
```

假设，如果此时用户签出另一个分支，那么这个悬空提交对于 Git 的**垃圾收集器**来说是公平的游戏。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-01-04T16:32:51.293

*我认为当 man 配置 git update 挂钩*以在推送发生后从存储库本身进行部署时，非裸存储库会很有用。只是不要忘记重置存储库。如果您错过了该步骤文件将不会跟踪实际状态...

# c# - 从 PATH 环境变量运行位于目录中的应用程序

> ID：12265734
> 
> 赞同：2
> 
> 时间：2012-09-04T14:33:21.450
> 
> 标签：c#, .net, vb.net, command-line, environment-variables

我有一个应用程序位于 PATH 环境变量中包含的目录中。因此，如果使用 DOS 命令行从任何目录调用，启动都会成功。

在 .NET 应用程序中实现相同目标的最简单方法是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-04T14:35:18.470

您可以尝试使用此语法的 CMD 命令

```
Process.Start("CMD", "/C you_app_name.exe"); 
```

这是一个静态方法，需要两个参数：

*   第一个是要启动的程序的名称
*   第二个是传递给启动程序的一个或多个参数

使用 CMD /C your_app_name.exe 我们启动命令解释器的另一个实例，要求它运行您的应用程序然后退出。

# java - 使用图像制作自定义 JScrollBar

> ID：12265740
> 
> 赞同：7
> 
> 时间：2012-09-04T14:33:27.370
> 
> 标签：java, swing, custom-controls, jscrollpane, jscrollbar

所以我使用 Java Swing 为我的应用程序构建 UI，并使用自定义图像来替换丑陋的 Java 图像，自定义图像具有样式并且很容易集成到 Java Swing 中。

现在我的问题是我需要在应用程序中使用 a`JScrollBar`并且`JScrollPane`我真的不想使用默认的 Java 滚动条甚至本机 OS 滚动条。

我只想能够有一个自定义图像作为滚动条的背景和一个图像作为滚动条的拇指。

如何使用图像制作自定义 JScrollBar？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-09-04T16:32:25.993

我写了一个示例，展示了如何为滚动条的拇指和背景（称为轨道）设置自定义图像。您需要这两个文件`thumb.png`和`track.png`自定义图像，它们位于您的类文件所在的同一位置。我还对图像进行了一些缩放以适应滚动条。只需对这段代码进行一些试验。我更改了滚动条 ( `setPreferredSize`) 的宽度以更好地查看图像。

要点是您必须创建自己的类`MyUi`来扩展`BasicScrollBarUI`和覆盖`paintThumb`and `paintTrack`，并使用以下内容个性化您的滚动条`setUI(new MyUI)`：

```
import java.awt.*;
import java.io.FileReader;
import java.io.IOException;
import javax.swing.*;
import javax.swing.plaf.metal.MetalScrollBarUI;
import javax.imageio.ImageIO;
import java.io.File;
import java.awt.geom.AffineTransform;

public class CustomScrollbarUIExample {
  public static void main(String[] args) {
    JScrollPane before = makeExamplePane();
    JScrollPane after = makeExamplePane();  

    JScrollBar sb=after.getVerticalScrollBar();
    sb.setPreferredSize(new Dimension(50, Integer.MAX_VALUE));
    sb.setUI(new MyScrollbarUI());

    JFrame f = new JFrame();
    f.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);

    Container c = f.getContentPane();
    c.setLayout(new GridLayout(2, 1, 0, 1));
    c.add(before);
    c.add(after);
    f.setSize(450, 400);
    f.setVisible(true);
  }

  private static JScrollPane makeExamplePane() {
    String exampleText= "Lorem ipsum dolor sit amet,\n consetetur sadipscing elitr,\n sed diam nonumy eirmod \ntempor invidunt ut labore et dolore \nmagna aliquyam erat,\n sed diam voluptua. At vero eos et accusam et \njusto duo dolores et ea rebum. Stet clita\n kasd gubergren, no sea\n takimata sanctus est Lorem ipsum dolor sit amet.\n Lorem ipsum dolor sit amet,\n consetetur sadipscing elitr, sed diam\n nonumy eirmod tempor invidunt \nut labore et dolore\n magna aliquyam erat, sed diam voluptua.\n At vero eos et accusam et justo \nduo\n dolores et ea rebum. Stet clita kasd gubergren, no sea\n takimata sanctus est Lorem\n ipsum dolor sit amet. Lorem ipsum dolor\n sit amet, consetetur sadipscing elitr,\n sed diam nonumy\n eirmod tempor invidunt ut labore et dolore magna aliquyam erat, sed diam voluptua. At vero eos\n et accusam et justo duo dolores et ea rebum. Stet clita kasd gubergren, no sea takimata sanctus est \nLorem ipsum dolor sit amet.Duis\n autem vel eum iriure dolor in hendrerit in vulputate velit esse molestie consequat, vel\n illum dolore eu feugiat nulla facilisis at vero eros et \naccumsan et iusto odio \ndignissim qui blandit praesent luptatum zzril delenit augue\n duis dolore te feugait nulla facilisi. Lorem ipsum dolor sit amet, consectetuer\n adipiscing elit, sed diam nonummy nibh euismod \ntincidunt ut laoreet\n dolore magna aliquam erat volutpat. Ut wisi enim ad minim veniam,\n quis nostrud exerci tation ullamcorper suscipit lobortis nisl ut aliquip ex ea\n commodo consequat. Duis autem vel eum iriure \ndolor in hendrerit in vulputate velit esse molestie consequat, vel illum dolore eu feugiat nulla \nfacilisis at vero eros et accumsan et iusto odio dignissim qui blandit\n praesent luptatum zzril delenit augue duis dolore \nte feugait nulla facilisi.";
    JTextArea text = new JTextArea(exampleText);
    JScrollPane scroll = new JScrollPane(text);
    return scroll;
  }

  static class MyScrollbarUI extends MetalScrollBarUI {
    private Image imageThumb, imageTrack;
    MyScrollbarUI() {
        try {
            imageThumb = ImageIO.read(new File("thumb.png"));
            imageTrack = ImageIO.read(new File("track.png"));
        } catch (IOException e){}
    }

    @Override
    protected void paintThumb(Graphics g, JComponent c, Rectangle thumbBounds) {        
        g.translate(thumbBounds.x, thumbBounds.y);
        g.setColor( Color.red );
        g.drawRect( 0, 0, thumbBounds.width - 2, thumbBounds.height - 1 );
        AffineTransform transform = AffineTransform.getScaleInstance((double)thumbBounds.width/imageThumb.getWidth(null),(double)thumbBounds.height/imageThumb.getHeight(null));
        ((Graphics2D)g).drawImage(imageThumb, transform, null);
        g.translate( -thumbBounds.x, -thumbBounds.y );
    }

    @Override
    protected void paintTrack(Graphics g, JComponent c, Rectangle trackBounds) {        
        g.translate(trackBounds.x, trackBounds.y);
        ((Graphics2D)g).drawImage(imageTrack,AffineTransform.getScaleInstance(1,(double)trackBounds.height/imageTrack.getHeight(null)),null);
        g.translate( -trackBounds.x, -trackBounds.y );
    }

  }
} 
```

有关更多信息，请参阅源文件`MetalScrollBarUI.java`。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-09-04T19:26:30.063

> 按钮所在的位置仍然是一个小的灰色区域，但我不知道如何删除它。

这是@halex 示例的变体，它删除了按钮并让图形上下文进行缩放。我添加了一个人造图像以使示例独立。

![在此处输入图像描述](../Images/b1dc55bc0e2f4ef93aa0816bfbbc23e7.png)

```
import java.awt.*;
import java.awt.image.BufferedImage;
import javax.swing.*;
import javax.swing.plaf.metal.MetalScrollBarUI;

/** @see http://stackoverflow.com/a/12270067/230513 */
public class CustomScrollbarUIExample {

    public static void main(String[] args) {
        JScrollPane before = makeExamplePane();
        JScrollPane after = makeExamplePane();
        JScrollBar sb = after.getVerticalScrollBar();
        sb.setUI(new MyScrollbarUI());
        JFrame f = new JFrame();
        f.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        f.setLayout(new GridLayout(0,1));
        f.add(before);
        f.add(after);
        f.pack();
        f.setSize(320, 240);
        f.setVisible(true);
    }

    private static JScrollPane makeExamplePane() {
        JTextArea text = new JTextArea(16, 16);
        text.append("Lorem ipsum dolor sit amet…");
        JScrollPane scroll = new JScrollPane(text);
        return scroll;
    }

    static class MyScrollbarUI extends MetalScrollBarUI {

        private Image imageThumb, imageTrack;
        private JButton b = new JButton() {

            @Override
            public Dimension getPreferredSize() {
                return new Dimension(0, 0);
            }

        };

        MyScrollbarUI() {
            imageThumb = FauxImage.create(32, 32, Color.blue.darker());
            imageTrack = FauxImage.create(32, 32, Color.lightGray);
        }

        @Override
        protected void paintThumb(Graphics g, JComponent c, Rectangle r) {
            g.setColor(Color.blue);
            ((Graphics2D) g).drawImage(imageThumb,
                r.x, r.y, r.width, r.height, null);
        }

        @Override
        protected void paintTrack(Graphics g, JComponent c, Rectangle r) {
            ((Graphics2D) g).drawImage(imageTrack,
                r.x, r.y, r.width, r.height, null);
        }

        @Override
        protected JButton createDecreaseButton(int orientation) {
            return b;
        }

        @Override
        protected JButton createIncreaseButton(int orientation) {
            return b;
        }
    }

    private static class FauxImage {

        static public Image create(int w, int h, Color c) {
            BufferedImage bi = new BufferedImage(
                w, h, BufferedImage.TYPE_INT_ARGB);
            Graphics2D g2d = bi.createGraphics();
            g2d.setPaint(c);
            g2d.fillRect(0, 0, w, h);
            g2d.dispose();
            return bi;
        }
    }
} 
```

# c++ - 双打向量的排序向量

> ID：12265742
> 
> 赞同：0
> 
> 时间：2012-09-04T14:33:36.160
> 
> 标签：c++, opencv

我有先前集群的向量和当前集群的向量。一个簇有一个 2D Point2F 的向量，我想根据每个簇之间的距离向上排序这些簇，它存储在距离向量中，或者你能建议一个更好的方法来排序簇向量吗？

```
 distances.resize(previousClusters.size()*currentClusters.size());
         for (int i=0; i<previousClusters.size()*currentClusters.size(); i++)
         {
             distances[i].resize(previousClusters.size()*currentClusters.size());
         }

         for (int i=0; i< previousClusters.size(); i++)
         {

             for(int j=0; j < currentClusters.size(); j++)
             {

                 distances[i][j] = cv::norm(previousClusters[i].m_Properties.m_Center - currentClusters[j].m_Properties.m_Center );
             }
         } 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-04T14:41:11.030

注意：这回答了最初写的问题（并且仍然写在标题中）。问题的主体已更改为使其无效，但答案对于对向量向量进行排序可能仍然有用。

首先，您需要确定将一个向量排在另一个向量之前意味着什么，并编写一个比较器：

```
struct compare_distance_vectors {
    bool operator()(std::vector<double> const & v1, std::vector<double> const & v2) {
        // implement your comparison here.
        // return "true" if v1 should come before v2.
    }
}; 
```

然后`std::sort`根据该顺序使用排序：

```
std::sort(vectors.begin(), vectors.end(), compare_distance_vectors()); 
```

如果您想要*字典*顺序（即按第一个元素排序，如果相等则按第二个元素排序，依此类推），那么您可以使用默认比较器（即`std::less<value_type>`, 并用于`<`比较）：

```
std::sort(vectors.begin(), vectors.end()); 
```

通常，要根据任何顺序对任何类型（例如`std::vector<cv::Point2f>`）的序列进行排序，请编写一个类似的比较器来指定顺序，然后`std::sort`与该比较器一起使用。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-09-04T14:41:54.900

您可以先尝试在“上”向量上使用[std::sort](http://cplusplus.com/reference/algorithm/sort/)（第二个原型允许您定义“下”向量的排序方式），然后每次调用函数对象 Comp 时，使用 std： :对每个“较低”方法再次排序（这次第一个原型就足够了）。

这也适用于您的第二个问题。

# c# - windows服务中方法的同步执行

> ID：12265744
> 
> 赞同：1
> 
> 时间：2012-09-04T14:33:39.010
> 
> 标签：c#, .net

我正在编写一个 Windows 服务以每 x 分钟执行一次方法，但我希望该方法相对于计时器本身同步执行。Windows 服务有一个 Timer 对象 (System.Timers.Timer)，它每 x 分钟启动并调用某个方法“DoWork”，但计时器必须在“DoWork”执行时“停止”，并在方法完成后再次启动。

我知道使用 System.Windows.Forms.Timer 类会给我想要的行为，但我不想向我的服务项目添加 System.Windows.Forms dll 引用。

这是“工作”代码的示例：

```
 private System.Timers.Timer timer1;

    public void MainMethod()
    {
        timer1 = new System.Timers.Timer();
        timer1.Interval = 1000;
        timer1.Elapsed += new ElapsedEventHandler(timer1_Elapsed);
        timer1.Start();
    }

    void timer1_Elapsed(object sender, ElapsedEventArgs e)
    {
        timer1.Stop();
        DoWork();
        timer1.Start();
    }

    private void DoWork()
    {
        Thread.Sleep(2000);
        Console.WriteLine("found!");
    } 
```

在上面的控制台应用程序中运行（作为编写 Windows 服务之前的模型），预期的行为应该是控制台写“找到！” 每 3 秒。

只是一个旁注：我只是使用 'Thread.Sleep(2000)' 来模拟延迟，但它不会构成实际代码库的一部分。

是否有任何其他/“更好”的方式来实现这一点而不是我上面的方式？

感谢您阅读我的问题，任何输入将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-04T14:38:55.797

您不能`System.Forms.Timer`在 Windows 服务中使用，因为这需要消息泵，并且 Windows 服务没有提供可能非常大的消息泵堆栈（而且您必须调用`Application.Run`才能启动）。

你现在拥有它的方式就是我实现周期性事件的方式。我会添加一些东西来监控你的事件是否比这个时间长；但除此之外...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-04T15:07:58.423

我认为这取决于您是否只是希望调用该方法之间的 X 秒延迟为常数，或者您是否希望每 X 秒调用一次该方法，但如果该方法花费的时间超过 X 秒，则可以允许执行。

您上面的代码将执行前者，其中方法调用之间有一秒钟的延迟，但如果您希望每 X 秒调用一次您的方法，您可能需要考虑使用时间戳`DateTime.Now`并`DateTime.Subtract`查看自最后一个方法调用。如果系统时钟发生更改，这可能会导致异常行为，例如在夏令时，该方法可能不会运行一个小时，但在您的情况下，这种异常行为可能会被您认为是可以接受的。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-09-04T14:41:38.293

似乎您遇到的主要问题被描述为“计时器必须在 'DoWork' 执行时'停止'，并在方法完成后重新启动”。简而言之，服务需要是多线程的。您应该考虑使用线程池。使用线程池将允许您的执行线程继续计算时间，而后台线程会执行其他一些工作。在此处查看 ThreadPool 文档：http: [//msdn.microsoft.com/en-us/library/3dasc8as%28v=vs.80%29.aspx](http://msdn.microsoft.com/en-us/library/3dasc8as%28v=vs.80%29.aspx)。

# visual-c++ - sprintf 小数分隔符

> ID：12265747
> 
> 赞同：2
> 
> 时间：2012-09-04T14:33:50.173
> 
> 标签：visual-c++

我需要函数 sprintf 来使用默认的 Windows 小数分隔符。以下代码始终在输出中打印 12.5：

```
double d=12.5;
char buffer [50];
sprintf (buffer, "%0.2f",d);
printf("%s", buffer); 
```

处理这个问题的最佳方法是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-04T20:55:00.487

只要您的语言环境设置正确，那么这应该按预期运行。要设置您的语言环境，请使用[setlocale()](http://linux.die.net/man/3/setlocale)。

# javascript - 在 AJAX“成功”回调中使用 window.location.replace 是不好的做法吗？

> ID：12265749
> 
> 赞同：1
> 
> 时间：2012-09-04T14:33:53.203
> 
> 标签：javascript, jquery, ajax

在 jQuery AJAX 请求中执行重定向是不好的做法吗？

```
$.ajax({
    url: "myurl",       
    success : function(response) {  
        window.location.replace('MYNEWPAGE');
    },
    error: function (xhr) {

    } 
```

我在应用程序中遇到了一些奇怪的行为，我认为这就是问题所在。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-04T14:36:55.853

`location.replace()`不会将当前页面存储到浏览器历史记录中，用户不能使用后退按钮返回页面。您应该使用`location.assign(URL)`或`location.href = URL`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-04T14:35:05.080

应该只用于`window.location.href = "whatever"`更改 url。请注意，这将导致您回发整个页面，奇怪的行为可能来自您在新页面上意外触发的加载事件，包括其他可能也设置 window.location.href 的 ajax 事件 - 从理论上讲，您可能会因为继续发生的事情而陷入僵局将您发送到新页面（小心）。

# python - 元组作为多维数组的索引

> ID：12265751
> 
> 赞同：7
> 
> 时间：2012-09-04T14:34:01.733
> 
> 标签：python, arrays, numpy, scipy, tuples

我发现了一个与我的问题非常相似的问题，但并不完全相同。这个：[here](https://stackoverflow.com/questions/2444923/unpacking-tuples-arrays-lists-as-indices-for-numpy-arrays) 但是在 ntimes 的情况下，数组的大小与元组所指向的维数相匹配。在我的例子中，我有一个 4 维数组和一个 2 维元组，就像这样：

```
from numpy.random import rand
big_array=rand(3,3,4,5)
tup=(2,2) 
```

我想使用元组作为前两个维度的索引，并手动索引最后两个。就像是：

```
big_array[tup,3,2] 
```

但是，我沿着第四维获得了索引 = 2 的第一维的重复（因为它在技术上尚未被索引）。那是因为这个索引解释了对第一个维度的双重索引，而不是每个维度的一个值，

```
eg. 
| dim 0:(index 2 AND index 2) , dim 1:(index 3), dim 2:(index 2), dim 3:(no index)|
instead of 
|dim 0(index 2), dim 1(index 2), dim 2:(index 3), dim 3:(index 2)|. 
```

那我该如何“解包”这个元组呢？有任何想法吗？谢谢！

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-09-04T14:38:28.043

由于您使用的是`numpy`：

```
big_array[tup+(3,2)] 
```

应该管用。当您调用`__getitem__`（通过方括号）时，这些内容将`__getitem__`作为元组传递给。您只需要在`tuple`此处显式构造（将元组添加在一起并连接成一个新元组），然后`numpy`就可以执行您想要的操作。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-04T14:47:32.793

你也可以单独传入你的第一个元组来获取感兴趣的切片，然后单独索引它：

```
from numpy.random import rand
big_array=rand(3,3,4,5)
chosen_slice = (2,2)

>>> big_array[ chosen_slice ]
array([[ 0.96281602,  0.38296561,  0.59362615,  0.74032818,  0.88169483],
       [ 0.54893771,  0.33640089,  0.53352849,  0.75534718,  0.38815883],
       [ 0.85247424,  0.9441886 ,  0.74682007,  0.87371017,  0.68644639],
       [ 0.52858188,  0.74717948,  0.76120181,  0.08314177,  0.99557654]])

>>> chosen_part = (1,1)

>>> big_array[ chosen_slice ][ chosen_part ]
0.33640088565877657 
```

对于某些用户来说，这可能更具可读性，但否则我会倾向于 mgilson 的解决方案。

# c# - IIS7 上的 DirectoryServicesCOMException 与 System.DirectoryServices.AccountManagement 但不在开发中

> ID：12265753
> 
> 赞同：2
> 
> 时间：2012-09-04T14:34:12.693
> 
> 标签：c#, iis-7, active-directory, windows-server-2008, directoryservices

以下代码在我的开发 PC 上运行良好，但在部署到服务器时崩溃：

```
using System.DirectoryServices.AccountManagement;

using (var ctx = new PrincipalContext(ContextType.Domain, domainName))
using (GroupPrincipal grp = GroupPrincipal.FindByIdentity(ctx, IdentityType.Name, groupName))
{
    if (grp == null) return new string[0];

    return grp.GetMembers(true).Select(m => m.SamAccountName).ToArray();
} 
```

崩溃如下：

```
[DirectoryServicesCOMException (0x80072020): An operations error occurred.]
   System.DirectoryServices.DirectoryEntry.Bind(Boolean throwIfFail) +439513
   System.DirectoryServices.DirectoryEntry.Bind() +36
   System.DirectoryServices.DirectoryEntry.get_AdsObject() +31
   System.DirectoryServices.PropertyValueCollection.PopulateList() +22
   System.DirectoryServices.PropertyValueCollection..ctor(DirectoryEntry entry, String propertyName) +96
   System.DirectoryServices.PropertyCollection.get_Item(String propertyName) +141
   System.DirectoryServices.AccountManagement.PrincipalContext.DoLDAPDirectoryInitNoContainer() +1134
   System.DirectoryServices.AccountManagement.PrincipalContext.DoDomainInit() +37
   System.DirectoryServices.AccountManagement.PrincipalContext.Initialize() +124
   System.DirectoryServices.AccountManagement.PrincipalContext.get_QueryCtx() +31
   System.DirectoryServices.AccountManagement.Principal.FindByIdentityWithTypeHelper(PrincipalContext context, Type principalType, Nullable`1 identityType, String identityValue, DateTime refDate) +14
   System.DirectoryServices.AccountManagement.Principal.FindByIdentityWithType(PrincipalContext context, Type principalType, IdentityType identityType, String identityValue) +86
   System.DirectoryServices.AccountManagement.GroupPrincipal.FindByIdentity(PrincipalContext context, IdentityType identityType, String identityValue) +29
   WebApp.WebForm1.Test() in C:\MyProject\trunk\WebApp\WebForm1.aspx.cs:30 
```

设想：

*   已加入域的 Windows Server 2008 x64 上的 IIS7
*   ASP.NET 4 内网应用程序
*   IIS 中除集成 Windows 身份验证外的所有身份验证模式均已关闭
*   配置为以域用户身份运行的应用程序池

Web.config 如下：

```
<authentication mode="Windows" />
<authorization>
  <deny users="?"/>
</authorization>
<identity impersonate="true" > 
```

`System.Security.Principal.WindowsIdentity.GetCurrent().Name`在生产中正确返回我的 AD 用户名，所以我认为这意味着模拟工作正常。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-21T11:46:57.490

我有一个非常相似的问题。通过将我的应用程序池作为 NetworkService 运行来解决它。我也像你一样使用 Windows 身份验证。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-08T06:36:22.760

我遇到了类似的问题。

我只有在部署到网络服务器后才收到此错误，它在我的机器上运行良好。

我发现，在服务器上，在 IIS 中，Impersonation 仍然使用 Window Authentication 检查。

并通过**在 IIS 中删除此模拟，错误消失了...**

# git - 提交中作者的 git 电子邮件是否可以公开阅读？

> ID：12265754
> 
> 赞同：24
> 
> 时间：2012-09-04T14:34:15.513
> 
> 标签：git, github

我注意到在我对 github 的提交中有我的电子邮件地址。

我在 github 上的任何地方都找不到这个电子邮件地址，但我想知道它是否会出现在任何地方并被机器人抓取以获取垃圾邮件？

如果是这样，是否可以删除电子邮件地址并且不再将其包含在提交中？

注意：项目在github上是公开的（不是私有仓库）

* * *

## 回答 #1

> 赞同：72
> 
> 时间：2012-09-04T14:43:10.497

克隆 git 存储库的任何人都将能够看到您进行提交的电子邮件地址。

如果您添加`.patch`到任何提交 URL，您将看到原始提交数据（包括提交者的电子邮件）。例如：[https ://github.com/kennethreitz/requests/commit/c8f166f696327d.patch](https://github.com/kennethreitz/requests/commit/c8f166f696327d.patch)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-04T14:49:06.850

您的电子邮件地址可能在您的个人资料中是公开的，就像我在这里一样：[https](https://github.com/noahc) ://github.com/noahc 。

你可以在这里看到：[https](https://github.com/search?q=John&repo=&langOverride=&start_value=1&type=Users&language=) ://github.com/search?q=John&repo=&langOverride=&start_value=1&type=Users&language=收集常用名称的电子邮件地址非常容易。

在我看来，这应该是你最关心的两个问题。显然，如果有人把它拉下来，他们也可以看到电子邮件地址。

# arm - 如何从 Cortex-A9 上 CPU1 的 CPU0 SP 寄存器中读取值？

> ID：12265755
> 
> 赞同：0
> 
> 时间：2012-09-04T14:34:24.987
> 
> 标签：arm, cpu-registers

我需要清除 cpu1 在 cpu0 挂起期间在做什么。

我正在调试启动 linux 内核的早期阶段，因此没有启动驱动程序或应用程序。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-26T12:30:25.453

这个任务可以通过 Cortex-A9 的 ETM 特性来解决。

# python - C Python：在上下文中运行 Python 代码

> ID：12265756
> 
> 赞同：15
> 
> 时间：2012-09-04T14:34:30.193
> 
> 标签：python, c, python-3.x, python-c-api, cpython

Python C API 函数`PyEval_EvalCode`让您可以执行编译后的 Python 代码。我想执行一个 Python 代码块，**就好像它在函数的范围内执行一样**，这样它就有自己的局部变量字典，不会影响全局状态。

这似乎很容易做到，因为`PyEval_EvalCode`允许您提供全局和本地字典：

`PyObject* PyEval_EvalCode(PyCodeObject *co, PyObject *globals, PyObject *locals)`

我遇到的问题与 Python 如何查找变量名有关。考虑以下代码，我使用以下代码执行`PyEval_EvalCode`：

```
myvar = 300
def func():
    return myvar

func() 
```

这个简单的代码实际上引发了一个错误，因为 Python 无法`myvar`从`func`. 即使`myvar`在外部范围的本地字典中，Python 也不会将其复制到内部范围的本地字典中。原因如下：

每当 Python 查找变量名时，首先检查`locals`，然后检查`globals`，最后检查`builtins`。在*模块范围内*，`locals`并且`globals`是相同的字典对象。所以`x = 5`模块范围内的语句将放在`x`字典中`locals`，字典也是`globals`字典。现在，在模块范围内定义的需要查找的函数`x`不会`x`在函数范围内找到`locals`，因为 Python 不会将模块范围的本地变量复制到函数范围的本地变量中。但这通常不是问题，因为它可以`x`在`globals`.

```
x = 5
def foo():
   print(x) # This works because 'x' in globals() == True 
```

只有*嵌套*函数，Python 似乎将外部范围的局部变量复制到内部范围的局部变量中。（它似乎也懒惰地这样做，只有在内部范围内需要它们时。）

```
def foo():
   x = 5
   def bar():
      print(x) # Now 'x' in locals() == True
   bar() 
```

所以这一切的结果是，在*模块范围内*执行代码时，您必须确保全局字典和本地字典是相同的对象，否则模块范围函数将无法访问模块范围变量。

但就我而言，我不希望全局字典和本地字典相同。所以我需要一些方法来告诉 Python 解释器我正在函数范围内执行代码。有没有办法做到这一点？我查看了`PyCompileFlags`以及其他参数，`PyEval_EvalCodeEx`但找不到任何方法来做到这一点。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-04T15:37:50.530

Python 实际上并没有将外部范围的局部变量复制到内部范围的局部变量中。国家文件[`locals`](http://docs.python.org/dev/library/functions.html#locals)：

> 自由变量在函数块中调用时由 locals() 返回，而不是在类块中。

这里的“自由”变量是指被嵌套函数封闭的变量。这是一个重要的区别。

对于您的情况，最简单的解决方法是传递与and*相同*的dict 对象：`globals``locals`

```
code = """
myvar = 300
def func():
    return myvar

func()
"""
d = {}
eval(compile(code, "<str>", "exec"), d, d) 
```

否则，您可以将代码包装在一个函数中并从编译对象中提取它：

```
s = 'def outer():\n    ' + '\n    '.join(code.strip().split('\n'))
exec(compile(s, '<str>', 'exec').co_consts[0], {}, {}) 
```

# datagrid - 如何在 Flex dataGrid 中转置数据

> ID：12265758
> 
> 赞同：1
> 
> 时间：2012-09-04T14:34:33.500
> 
> 标签：datagrid, flex4, arraycollection

我有一个包含 3 列的 arrayCollection：

Col1 Col2 Col3 a 1 X b 2 Y c 3 Z d 4 W

我想转置这组数据并将其显示在 Flex DataGrid 中。

我已经到这里了，我的函数在下面，网格显示（a，b，c，d 等）为列，但行没有填充。例如，第一列应显示“a”作为标题，第一行显示“1”，第二行显示“X”。

有人可以帮我弄这个吗。

这是我的功能。

```
public function createColumns(myArrayColl:ArrayCollection):void{
    var advancedDataGridColumn:AdvancedDataGridColumn;
    var i:int;
    var columnsArray:Array = new Array();
    for(i=0;i< myArrayColl.length;i++){                                          
        advancedDataGridColumn=new AdvancedDataGridColumn();            
        advancedDataGridColumn.headerText= getFormattedPeriod(myArrayColl[i].Col1.toString());
        advancedDataGridColumn.dataField=myArrayColl[i].Col2.toString();   
                advancedDataGridColumn.dataField=myArrayColl[i].Col2.toString();
                advancedDataGridColumn.dataField=myArrayColl[i].Col3.toString();

        columnsArray.push(advancedDataGridColumn);
    }
    adg1.columns = columnsArray;
    adg1.invalidateDisplayList();
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-05T15:10:25.047

我遇到了同样的问题，并使用带有水平布局的[Spark DataGroup解决了：](http://help.adobe.com/en_US/flex/using/WS64909091-7042-4fb8-A243-8FD4E2990264.html)

```
<?xml version="1.0" encoding="utf-8"?>
<s:Application xmlns:fx="http://ns.adobe.com/mxml/2009" 
               xmlns:s="library://ns.adobe.com/flex/spark" 
               xmlns:mx="library://ns.adobe.com/flex/mx">
    <fx:Script>
        <![CDATA[
            import mx.collections.ArrayCollection;
            [Bindable] private var array : ArrayCollection = new ArrayCollection([
                {Col1:"a",Col2:"1",Col3:"X"},
                {Col1:"b",Col2:"2",Col3:"Y"},
                {Col1:"c",Col2:"3",Col3:"Z"},
                {Col1:"d",Col2:"4",Col3:"W"},
            ]);
        ]]>
    </fx:Script>
    <s:HGroup x="225" y="49">
        <!--the VGroup below it's a kind of a 'vertical header'. If you, like use it.-->
        <s:VGroup width="50" id="vHeader">
            <s:Label text="Col 1" fontWeight="bold"/>
            <s:Label text="Col 2"/>
            <s:Label text="Col 3"/>
        </s:VGroup>
        <!--the DataGroup with Horizontal layout and a itemRenderer using a VGroup-->
        <s:DataGroup id="dataGroup" clipAndEnableScrolling="true"
                     dataProvider="{array}" width="100">
            <s:layout>
                <s:HorizontalLayout gap="1" useVirtualLayout="true"/>
            </s:layout>
            <s:itemRenderer>
                <fx:Component>
                    <s:ItemRenderer width="49">
                        <fx:Script>
                            <![CDATA[
                            ]]>
                        </fx:Script>
                        <s:VGroup>
                            <s:Label text="{data.Col1}" fontWeight="bold"/>
                            <s:Label text="{data.Col2}"/>
                            <s:Label text="{data.Col3}"/>
                        </s:VGroup>
                    </s:ItemRenderer>
                </fx:Component>
            </s:itemRenderer>
        </s:DataGroup>
    </s:HGroup>
    <!--the HSCrollBar positioned above the dataGroup-->
    <s:HScrollBar x="276" y="27" width="100" pageSize="50" stepSize="50"
                  viewport="{dataGroup}"/>
</s:Application> 
```

# c# - 使用自定义组件包装器而不是继承来扩展 WinForm 控件是常见的做法吗？

> ID：12265762
> 
> 赞同：2
> 
> 时间：2012-09-04T14:34:43.280
> 
> 标签：c#, winforms, controls

我最近一直在通过创建自定义`Component`派生类来为一些不同的 WinForms 控件添加自定义功能，这些派生类只是包装`Control`，挂钩到所需的事件以执行额外的功能。

例如，我想在我的应用程序中为几个不同的控件添加拖放功能`ListBox`，所以我创建了一个`DragAndDropListBoxComponent`继承自`Component`该类的控件，然后将此新组件添加到我需要添加功能的表单中，设置`DragAndDropListBoxComponent`的`ListBox`属性到我想添加功能的列表框。

我喜欢这种扩展标准功能的方法，因为我可以为相同`Control`的内容创建多个自定义行为类型并将它们混合在一起以获得一些有趣的效果。这也有利于组合优于继承的原则。`Component``Control`

我似乎花了一些时间来实现使用 Component 类列表这个。这部分是由于从未在网上看到它以这种方式使用 - 因此我的问题。自定义组件类是否常用这种方式？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-04T14:47:53.630

还有其他选项，您选择哪个选项并不重要，只要它能达到预期的结果，并且您不会觉得您的解决方案每时每刻都对您不利。

一种可能的替代方法是使用[`Extender Provider`](http://msdn.microsoft.com/en-us/library/f6b055wc%28v=vs.71%29.aspx). Extender Provider 的一个优点是您似乎将“AllowDragAndDrop”属性添加到每个控件。（在您的情况下，该属性将仅添加到`ListBox`实例中）此新属性在设计时可见，因此其他使用者不必知道 DragAndDrop 功能的实现或位置详细信息，他们只需在`PropertyGrid`.

另一种可能的选择是使用[装饰器模式](http://en.wikipedia.org/wiki/Decorator_pattern)。这例如在 .NET 流中使用：您有一个流，然后通过创建一个将旧流作为构造函数参数的新流来添加其他行为（缓冲、（解）压缩、加密......）。在您的情况下，您将 a 包裹`ListBox`在 a 中`DragAndDropListBox`。不过要小心，在这种特殊情况下，这种方法可能会给您带来更多麻烦而不是优势。

另一种可能的替代方法是从您要扩展的控件继承并将“CustomBehaviors”列表添加到控件。CustomBehaviors 将实现一些接口，允许您通过将接口的具体实例添加到集合中来向控件添加新行为。

# ios - 设置 ZBar iOS SDK 界面方向？

> ID：12265763
> 
> 赞同：0
> 
> 时间：2012-09-04T14:34:44.053
> 
> 标签：ios, cocoa-touch, ios5, uiinterfaceorientation, zbar-sdk

有谁知道如何设置 ZBar SDK 的界面方向？我需要它在横向视图而不是纵向视图中工作。我尝试添加`[reader shouldAutorotateToInterfaceOrientation:UIInterfaceOrientationLandscapeRight];`，但没有奏效。有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-03T17:49:33.137

我遇到了同样的问题并简单地解决了！

我只需要打电话：

```
[reader willRotateToInterfaceOrientation: toInterfaceOrientation duration: duration]; 
```

在包含 ZbarReaderView 的视图控制器的 willRotate... 中。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-30T17:55:25.137

围绕 ZBarReaderView 创建一个包装类并添加 iOS 6 方法：

```
-(BOOL) shouldAutorotate
{
    return NO;
}

-(NSUInteger) supportedInterfaceOrientations
{
    return UIInterfaceOrientationMaskLandscape;
} 
```

然后使用您在内置 ZBar 上创建的类，确保将旧的 iOS 5 方法保留在同一个控制器中：

```
- (BOOL)shouldAutorotateToInterfaceOrientation (UIInterfaceOrientation)interfaceOrientation
{
    return (interfaceOrientation == UIInterfaceOrientationLandscape);
} 
```

并且：

```
 self.reader.supportedOrientationsMask = ZBarOrientationMask(UIInterfaceOrientationMaskLandscape); 
```

我知道已经很晚了，但我刚刚开始为 iOS 6 自己做这件事。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-26T14:31:22.543

我不确定你的意思，但也许这对你有帮助......

```
[[UIApplication sharedApplication] setStatusBarOrientation: UIInterfaceOrientationLandscapeLeft animated:NO]; 
```

或者

```
[[UIDevice currentDevice] setOrientation:UIInterfaceOrientationLandscapeLeft]; 
```

# jquery - IE9 打破 jquery 和 fancybox

> ID：12265764
> 
> 赞同：1
> 
> 时间：2012-09-04T14:34:45.893
> 
> 标签：jquery, internet-explorer-9, fancybox

我的 IE9 有问题；它没有打开`fancybox`。我收到 2 个错误（已翻译）：

> **SCRIPT5：访问被拒绝**
> 
> jquery.min.js?1345532875，第 2 行字符 68522

和：

> **SCRIPT5007：属性“触发器”没有值：对象为空或未定义**
> 
> jquery.fancybox.pack.js?1342011870，第 28 行字符 117

希望有人知道解决方案。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-05T06:44:56.353

这是我的代码：

```
<script src="fileadmin/templates/js/libs/jquery.min.js?1345532875" type="text/javascript"></script>
<script src="fileadmin/templates/js/fancybox/jquery.fancybox.pack.js?1342011870" type="text/javascript"></script>
<script type="text/javascript">
  $(document).ready(function(){
    $('.fblang').fancybox({
      padding: 0,
      openEffect : 'elastic',
      openSpeed  : 150,
      closeEffect : 'elastic',
      closeSpeed  : 150,
      helpers : {
        overlay:{ opacity : 0.3 }
      }
    });
});
</script> 
```

jQuery 版本是 1.8.0 和 fancybox 2.0.6。整个事情都在 Typo3 CMS 中运行（如果这很重要）

**编辑：**我让它工作了。[我只包含来自https://ajax.googleapis.com](https://ajax.googleapis.com)的外部 jquery 文件

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-04T14:40:27.553

欢迎来到 StackOverflow！

为了帮助您，我们不仅需要您的错误消息，还需要您的代码。仅凭错误，很难猜测。

您能否发布您尝试使用 Fancybox 的网页的 JavaScript？另外，请告诉我们您包含哪些 js 库。

# perl - 如何使用当前文本行中的关键字在 Perl 中已阅读文本的前几行中搜索？

> ID：12265770
> 
> 赞同：1
> 
> 时间：2012-09-04T14:34:57.987
> 
> 标签：perl, text-parsing

我从 Perl 开始，并在一个 while 循环中逐行解析一些文本，但在这个特定问题上找不到帮助。我想在当前文本行中使用来自先前阅读的文本行的信息。

我的代码如下：

```
while(<data>){

    my $message = substr $_, 0, 1;

    if ($message eq 'A'){

        my $order_ref  = substr $_,  1, 9;
        my $order_book = substr $_, 20, 6;

        push @add_orders, $_;
        print add_order_file "$order_ref,$order_book\n";
    }
    if ($message eq 'X'){

        my $order_ref = substr $_, 1, 9;
        #now I would like to use order_ref to look up order_book from a previous line of text 
        # where the message is equal to A, 
        my $order_book = LOOKED UP VALUE FROM PREVIOUS TEXT;

        push @add_orders, $_;
        print add_order_file "$order_ref,$order_book\n";
    }
} 
```

“A”消息总是在“X”消息之前，所以我确定如果我看到带有 order_ref 编号的 X 条目，我会向后滚动并找到关联的 A 消息，我可以在其中提取 order_book 变量。我意识到这将涉及某种正则表达式，但我不知道如何让 Perl 只搜索前几行。谢谢！

编辑：我应该更清楚这一点。“A”消息在“X”消息之前，但它们都可以有不同的 order_refs，因此数据如下所示：

```
A order_ref1, order_book1
A order_ref2,order_book2
A order_ref3,order_book1
X order_ref2 
X order_ref1 
```

对于 X 订单，我想使用 order_ref2 和 order_ref1 查找 order_book。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-04T14:40:58.497

随着您对整个问题的重新定义，需要一个新的答案。

您需要将 order_refs 存储在哈希中，以供以后查找。这个变量需要在`while`循环外声明。

请注意，我已更改您`substr`呼叫中的数字以匹配您的示例输入。如果您分享有关如何构造输入行的一些信息，可能会有更好的方法来提取不同的值。使用`substr`假定固定宽度类型的数据。

```
use strict;
use warnings;

my %order_book;  # your lookup hash
my @add_orders;
while (<DATA>) {
    chomp;
    my $message = substr $_, 0, 1;

    if ($message eq 'A' or $message eq 'X') {

        my $order_ref = substr $_, 2, 10;
        if ($message eq 'A') {

            $order_book{$order_ref} = substr $_, 13;
        }
        push @add_orders, $_;
        print "$order_ref,$order_book{$order_ref}\n";
    }
}

__DATA__
A order_ref1,order_book1
A order_ref2,order_book2
A order_ref3,order_book1
X order_ref2 
X order_ref1
X order_ref3 
```

输出：

```
order_ref1,order_book1
order_ref2,order_book2
order_ref3,order_book1
order_ref2,order_book2
order_ref1,order_book1
order_ref3,order_book1 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-04T14:54:30.737

TLP 的答案已经是正确的。以下是对您的代码的更多建议：

```
use strict; use warnings;
my @add_orders;
my $last_order_book;
while (my $line = <DATA>) {
  my $message = substr $line, 0, 1;

  if ( $message eq "A" ) {
    my $order_ref  = substr $line, 1,  9;
    my $order_book = $last_order_book = substr $line, 20, 6;

    push( @add_orders, $line );
    print "$order_ref,$order_book\n";
  }
  elsif ( $message eq "Q" ) {
    # Stuff happening ...
  }
  elsif ( $message eq "X" ) {
    my $order_ref = substr $line, 1, 9;

    my $order_book = $last_order_book;

    push( @add_orders, $line );
    print "$order_ref,$order_book\n";
  }
}

__DATA__
A123456789012345678901234567890
XLine XLine XLine XLine XABCDEF 
```

我已经更改了代码中的一些内容。

首先，**让我们回答您的问题**`$order_book`：如果您不想使用循环内的变量，您可以添加一个范围在块之外的变量来存储您的变量。我命名它`$last_order_book`。它会记住零件的最后一次看到的值`"A"`。请注意，您可以通过像`my $foo = my $bar = "baz"`.

现在我的建议：

*   总是`use strict`和`use warnings`。我不知道你有没有，但我会说，以防万一。
*   你用`$_`了很多。我相信，如果您必须经常明确地使用它，那么您实际上应该给它一个名称并改用它。它将使您免于理解以后发生的事情的麻烦。
*   每行只能有一种，因此拥有多个构造`$message`没有意义。`if {}`相反，使用`if {} elsif {}`它们并按每种行出现的次数对其进行排序。`if`这将节省时间，因为一旦找到条件之一，它就会停止执行整个-construct。如果您要处理大量数据，这很有用，但始终以这种方式处理并没有什么坏处。为了更清楚，我添加了一个`$message eq "Q"`案例。

# java - java createText 没有 Ctrl C, Ctrl V

> ID：12265771
> 
> 赞同：0
> 
> 时间：2012-09-04T14:34:59.100
> 
> 标签：java, hotkeys, shortcuts

我试图创建一个文本框

```
protected FormToolkit toolkit = new FormToolkit(parent.getDisplay());
Text idInput = toolkit.createText(parent, " ", SWT.BORDER); 
```

那么，只有`Ctrl+A`, 但没有`Ctrl+C`,`Ctrl+V`和`Ctrl+X`函数，我怎样才能得到这些`HotKey`函数呢？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-04T14:41:49.160

您可以使用系统剪贴板。这也将允许您从 Java 应用程序复制和粘贴到本机应用程序！

创建一个`ActionListener`使用`Clipboard`.

```
public class ClipboardActionListener implements ActionListener
{
    private final JTextField;

    public ClipboardActionListener(JTextField text)
    {
        this.text= text;
    }

    @Override
    public void actionPerformed(ActionEvent e)
    {
        Clipboard system = Toolkit.getDefaultToolkit().getSystemClipboard();
        StringSelection selection = new StringSelection(text.getText());
        system.setContents(selection, selection)
    }
} 
```

并在创建文本字段时注册击键。

```
KeyStroke copy = KeyStroke.getKeyStroke(KeyEvent.VK_C, ActionEvent.CTRL_MASK, false);
textField.registerKeyboardAction(new ClipboardActionListener(textField), copy, JComponent.WHEN_FOCUSED); 
```

# asp.net-mvc - 在 LINQ 分组后返回原始数据类型

> ID：12265773
> 
> 赞同：0
> 
> 时间：2012-09-04T14:35:09.500
> 
> 标签：asp.net-mvc, asp.net-mvc-3, linq, entity-framework, linq-to-entities

分组后，我需要我的 LINQ 查询返回产品数据类型。它似乎被包裹在一个匿名的伪家庭中。

我在 Product 中有一些我不关心的属性，只需要 p.ID 和 p.Name 等。

我目前遇到的错误是：

```
The entity or complex type 'DatabaseModel.Product' cannot be constructed in a LINQ to Entities query. 
```

这是我的方法：

```
 public static List<Product> GetSellableSpecialOffers(DatabaseEntities db)
    {

        var query = from p in db.Products
                    where (p.Visible == true && p.Active == true)
                    && p.ShowInSpecialOffers == true
                    group p by p.FamilyID == null ? 0 : p.FamilyID into f
                    select new Product {
                    ID = f.First().ID,
                    Name = f.First().Name,
                    Cost = f.First().Cost,
                    RRP = f.First().RRP
                    };

        return query.ToList();
    } 
```

问题是什么？有没有更好的方法来解决这个问题？SQL 将始终返回 1 条记录，而不是将对象封装在辅助数据类型中，我不明白。

非常感谢，

**编辑1：**

我很抱歉扩展规范，但我需要以编程方式生成返回的产品，例如

```
select new Product {
                    ID = f.First().ID,
                    Name = f.First().Name,
                    Cost = f.OrderBy(p => p.NowCost).FirstOrDefault(),
                    RRP = f.First().RRP
                    } 
```

*或者*如果我可以强烈键入家庭类：

```
 public partial class ProductFamily
{
    public Product GroupedProduct 
    {
        get
        {
            return this.Products.OrderBy(p => p.NowCost).FirstOrDefault();
        }
    }
} 
```

然后我会这样做：

```
 var query = (from p in db.Products
                    where (p.Visible == true && p.Active == true)
                    && p.ShowInSpecialOffers == true
                    group p by p.ProductFamily == null ? null : p.ProductFamily into f
                     select f.GroupedProduct).ToList<Product>(); 
```

但是我无法使用我所拥有的解决方案。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-04T14:39:59.080

你可以试试（无聊，但不确定你有选择）

```
var query = from p in db.Products
                    where (p.Visible == true && p.Active == true)
                    && p.ShowInSpecialOffers == true
                    group p by p.FamilyID == null ? 0 : p.FamilyID into f
                    select new {
                    ID = f.First().ID,
                    Name = f.First().Name,
                    Cost = f.OrderBy(m => m.NowCost).First().Cost,
                    RRP = f.First().RRP
                    };

return query.ToList().Select(m => 
new Product {
    ID = m.ID,
    Name = m.Name, 
    Cost = m.Cost,
    RRP = m.RRP
}; 
```

**编辑** 或如Master Skeet所指出的（与您尝试的不完全相同，但更容易）

```
var query = from p in db.Products
                    where (p.Visible == true && p.Active == true)
                    && p.ShowInSpecialOffers == true
                    group p by p.FamilyID == null ? 0 : p.FamilyID into f
                    select f.OrderBy(m => m.NowCost).First(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-04T14:49:44.373

您可以简单地`select f.First()`返回结果数据，如下所示：

```
var query = from p in db.Products
            where (p.Visible == true && p.Active == true)
            && p.ShowInSpecialOffers == true
            group p by p.FamilyID == null ? 0 : p.FamilyID into f
            select f.First(); 
```

然后在方法之外使用您需要的任何属性，忽略您不关心的内容（您*正在*处理`Product`对象，即使您不需要属性*也应该在那里）。*

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-04T14:38:32.157

删除“产品”一词

```
select new Product{} 
```

“选择新”本身将创建一个匿名类型，而您将其指定为产品。

# ios - CLGeocoder 总是在设备上失败，但在模拟器中工作

> ID：12265777
> 
> 赞同：1
> 
> 时间：2012-09-04T14:35:22.967
> 
> 标签：ios, location, reverse-geocoding

我正在使用 CLGeocoder 对设备的当前位置进行反向地理编码。它在模拟器上运行良好，但`kCLErrorNetwork`在设备（iPhone 4 和 iPad 3）上总是失败并出现错误。

代码非常简单：

```
if ( geocoder == nil ) geocoder = [[CLGeocoder alloc] init];
[geocoder reverseGeocodeLocation:self.location completionHandler:^(NSArray *placemarks, NSError *error) {

    if ( error == nil ) {

        // Do good stuff with the placemark...

    } else {

        NSLog(@"unable to reverse geocode location %@ due to error: %@", self.location, error);
    }
}]; 
```

打印的错误信息是：

```
unable to reverse geocode location <[redacted],[redacted]> +/- 69.94m (speed -1.00 mps / course -1.00) @ 9/4/12 10:30:19 AM Eastern Daylight Time due to error: Error Domain=kCLErrorDomain Code=2 "The operation couldn’t be completed. (kCLErrorDomain error 2. 
```

此方法仅在 CLLocationManager 提供位置后调用，因此该方法始终传递一个有效位置。

我已经在几个 Wi-Fi 网络和 3G 网络上尝试过。它永远不会在设备上运行。

任何帮助将不胜感激！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-08-20T23:36:15.363

这可能不是您的问题，但我猜设备上的网络层崩溃了，这意味着它没有连接到互联网。关闭和打开飞行模式为我解决了这个问题。

# jgroups - JGroups中TCP的编程配置

> ID：12265780
> 
> 赞同：1
> 
> 时间：2012-09-04T14:35:24.663
> 
> 标签：jgroups

如何设置字段

```
thread_pool.enabled
thread_pool.queue_max_size
thread_pool.rejection_policy 
```

Java代码中的TCP协议？通用方法 setValue(...) 不接受这些字符串作为有效的属性名称，而提供的 tcp.xml 确实包含这些。JGroups API 也没有针对这些的直接设置器。

谢谢！卡塔林

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-05T06:19:42.647

Protocol.setValue("thread_pool_enabled", true);

# css - 带有完整链接的响应式导航栏

> ID：12265782
> 
> 赞同：0
> 
> 时间：2012-09-04T14:35:27.833
> 
> 标签：css, html, layout

这是我在此的头一篇博文。如果我做错了什么，请不要犹豫告诉我。

我已经建立了一个看起来不错的导航栏：

我的 HTML：

```
<div style="width: 864px; margin: 0 auto;"> 
    <nav id="main-navigation">
        <ul>
                <li id="nav1"><a href="#">Lorem ipsum dolor sit ametzu</a></li>
                <li id="nav2"><a href="#">Lorem ipsum dolor sit am</a></li>
                <li id="nav3"><a href="#">Lorem ipsum dolor sitd</a></li>
                <li id="nav4"><a href="#">Lorem ipsum dolo</a></li>
                <li id="nav5"><a href="#">Lorem ipsum do</a></li>
        </ul>
    </nav>
</div> 
```

这就是它现在的样子：

![在此处输入图像描述](../Images/352d191dcd1253ba8fe9846c727fb4d8.png)

请注意，每个导航项的宽度都应与其内容相关。我设法使用静态宽度值（幻数）来构建它，如下面的css：

```
body{background-color: gray;}

ul{
    margin: 0;
    padding: 0;
}

nav#main-navigation li{
    float: left;
    padding: 15px 0;
    text-align: center;
    margin: 0;
    background-color: white;
    border-right: 1px dotted #222;
    color: #222;
}

nav#main-navigation li:last-child  { border: 0; }

nav#main-navigation li a{
    font: 11px/12px sans-serif;
    text-transform: uppercase;
    text-decoration: none;

}

#nav1{width: 218px;}
#nav2 {width: 198px;}
#nav3 {width: 178px;}
#nav4 {width: 138px;}
#nav5 {width: 128px;} 
```

我有两个问题：

1.  是否可以让整个 li-tag 用链接标签填充？你能给我一个提示吗？**解决了！！！**
2.  我想让这个响应。计算宽度的百分比是最佳做法吗？然后将它们放入媒体查询中？或者甚至可以使 li 元素与其内容相关（例如 display:inline; 通常应该做什么）？

如果有人更有经验的帮助会非常好:-) 干杯

* * *

## 编辑：

根据要求，这是我现在的状态（感谢冷冻豌豆的罗迪）：

[http://jsfiddle.net/0xsven/rbz72/](http://jsfiddle.net/0xsven/rbz72/)

我想让这个响应，以便在小于 960 像素（这是我的最大值）的较小显示器上显示。我希望导航栏延伸到包含它的 div 的整个长度。感谢您的帮助。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-04T14:53:11.463

第二个问题的答案是让你的`<li>`元素显示`inline-block`并移除浮动。这样，菜单项将响应项目的内容大小`inline`。

```
nav#main-navigation li{
    display:inline-block;
    padding:15px 10px;
    margin-right: -4px;
} 
```

负右边距是克服行内块元素之间的原生间隙[的技巧。](http://css-tricks.com/fighting-the-space-between-inline-block-elements/)

为了使可点击区域更大，解决方案是[这样](http://v3.thewatchmakerproject.com/journal/154/simple-css-how-to-make-clickable-areas-bigger)的。本质上，您需要做的是放置`display: block`元素`li a`并告诉它占用所有可用空间。然而，这意味着将 li 的填充转移到`a`。

这是此代码的[有效 JSFiddle 演示](http://jsfiddle.net/xDFx7/)。我添加了灰色`:hover`背景颜色，`<a>`以便您可以看到效果。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-04T14:48:38.467

**#2**

我所做的是将 UL 中的 LI 设置为 display:block 当屏幕宽度开始影响菜单的外观和感觉时。

例如：

```
@media only screen and (min-width:0px) and (max-width:960px)
{
    nav#main-navigation li { display:block; width:100%; }
} 
```

最终效果应该是菜单项的垂直列表。大多数时候，我会将菜单项的外观更改为按钮。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-04T14:49:43.900

部分答案：

1.  要使可点击区域更大，请添加

    nav#main-navigation ul li a { 显示：块；文字装饰：无；填充：10px，20px；}

将标签的显示属性设置为“block”使链接扩展以填充它的容器。填充会增加可点击区域的大小，因此请调整值以满足您的需要。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-04T14:46:06.093

对于第一个问题，一种方法是通过 JQuery。就像是：

```
$("#main-navigation li").click(function () {
    window.location = $(this).find("a").attr("href");
});

$("#main-navigation a").click(function (e) {
    e.preventDefault();
}); 
```

会做的。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-04T14:50:39.067

1.我在这里并不完全理解你（`<li>`'s 不能是`<a>`元素），但我认为你想要的是`<li>`'s 的样式与标签相同。有几种方法可以做到这一点，例如将 s 的 :hover 状态设置为与`<li>`s 相同`<a>`。将指针设置为光标可能是一个好的开始。

2.如果你想让你的设计适应veiwport的宽度，你不一定需要使用@media。@media 用于在设计中设置断点，其中元素可以在这些点之上和之下重排，其余部分可以用百分比来完成。我只是在这里使用了液体设计：http: [//jsfiddle.net/ucbEe/](http://jsfiddle.net/ucbEe/)我删除了所有固定宽度并在 li 上放置了 20% 的宽度（5/100=20% 宽度）。

这足够有意义吗？

# c# - 如何通过 MSBuild 为 Windows 服务和 Windows 应用程序创建基于文件的简单分发

> ID：12265784
> 
> 赞同：2
> 
> 时间：2012-09-04T14:35:33.610
> 
> 标签：c#, .net, msbuild, package, publish

首先，感谢您花时间阅读并可能评论这个问题。

**概括**

如何使用 MSBuild 自动将 MS Visual Studio Windows 服务和 Windows 应用程序打包成简单的（包括 dll、exe、配置等的文件目录），我可以将其发布到我们的 Dev-Ops 部门。我不希望以 MSI 安装程序或 setup.exe 或某些 Web 部署格式分发，这些格式似乎是 MS Visual Studio 发布中的默认设置。

**我的环境**

*   Windows XP SP3（32 位）、Window Server 2008 R2（64 位）
*   .NET 4.0（32 位）
*   MS Visual Studio 2010（32 位）
*   NAnt 0.91（32 位）

**我的情景**

目前，我们有大约 5 种类型的 MS Visual Studio 项目，对于前 3 种类型（Web 服务、Web 应用程序、网站），我们可以使用 MSBuild 根据内容将源打包到一个简单的文件目录（分发）中csproj 文件使用：

msbuild my.component.csproj /p:Configuration=Release /t:Package /p:_PackageTempDir="C:\temp\some\dir"

对于后两种类型（Windows 服务、Windows 应用程序），我们不能像上面那样使用 MSBuild。通过 Visual Studio 中的 Publish 命令进行调查，看来我可以为 Windows 服务和 Windows 应用程序创建 setup.exe 安装程序，但这不是我想要的 - 我只想能够创建一个简单的文件目录（分发) 就像我为其他项目类型所做的那样。我接受这可能是不可能的，但我只想确定。

**结论**

到目前为止，对于 Windows 服务和 Windows 应用程序，我得出以下结论，前两者并不理想：

*   使用 MSBuild 编译代码并使用 NAnt 创建简单的文件目录（分发）。
*   使用 MSBuild 编译代码并创建构建后事件以创建分发。
*   您的建议在这里（非常感谢）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-04T14:55:40.940

首先，.Net 托管的 Windows 服务，就像它们的非托管服务一样，必须通过名为 InstallUtil 的命令行工具向 Windows 服务控制器注册。对于各种 .Net Framework 版本，此实用程序有不同的版本。您会在安装 .Net 框架的位置找到它们。例如，在我的开发框中，它们位于 C:\Windows\Microsoft.NET\Framework 的各个框架子文件夹下。

其次，也许您可​​以澄清您在 Windows 应用程序发行版中看到的具体问题。这些通常与网站和 Web 服务一样简单的文件分发一样容易完成。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-05T13:54:07.237

你可以运行 MSBuild 来获得你想要的，你只需要指定一个不同于`Package`. 我相信您想要“构建”：

```
msbuild my.component.csproj /p:Configuration=Release /t:Build 
```

您可以通过属性自定义构建输出目录，但我不记得该属性名称是什么。如果你破解打开你的 csproj 文件，你应该可以看到它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-13T11:06:50.660

根据我在 StackOverflow 上的在线研究 (MSDN) 和有限的本地实验，似乎无法以类似于 MSBuild 的 package 命令的分发输出的方式快速或轻松地构建 Windows 服务和 Windows 应用程序，即基于本地文件的分发。

对于 Windows 应用程序，正如 Splattered Bits 所建议的，在项目编译后，release bin 目录的内容可以用作简单的基于文件的分发。

对于 Windows 服务，可以执行我们上面对 Windows 应用程序所做的操作，并使用 release bin 目录的输出。

在这两种情况下，可能需要更改 CSPROJ 文件以禁止创建 PDB 文件或进一步配置编译输出。

# html - 3 列 div 不完全居中

> ID：12265793
> 
> 赞同：0
> 
> 时间：2012-09-04T14:36:07.847
> 
> 标签：html, css

我将 3 个 div 居中，但分组偏离中心约 10-20 像素。为什么会这样，我该如何解决？我正在使用谷歌浏览器。

这是代码： [jsbin](http://jsbin.com/agicit/2/)

或者您可以查看以下代码：
HTML：

```
<!DOCTYPE html>
<html>
<head>
<meta charset=utf-8 />
<title>JS Bin</title>
</head>
<body>
    <div id="container">
    <div class="csect"></div>
    <div class="csect"></div>
    <div class="csect"></div>

    </div>
</body>
</html> 
```

CSS：

```
#container
{
    width: 800px;
    margin-top: 20px;
    margin-left: auto;
    margin-right: auto;
}

.csect
{
    display: inline;
    float: left;
    margin-left: 25px;
    margin-right: 25px;
    background-color: #E0E0E0;
    width: 200px;
    height: 200px;

} 
```

提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-04T14:43:57.927

不完全是您正在寻找的答案，但最能帮助您的答案：

*   在 firefox 中安装 firebug 以了解为什么会有这种差异。
*   你遇到的问题，别人已经遇到了。你不需要重新发明轮子。在 Twitter Bootstrap 或 960.gs 上掠夺

现在你想要的答案：

你的#container 有 800 像素。.csect 有 25px + 200px + 25px = 250px。250 x 3 = 750 像素。您缺少 50px :) 如果您将 #container 更改为 750px 或为第一个 csect 添加更多边距，您将使其居中。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-04T14:40:22.163

250 像素 x 3 = 800 像素容器中的 750 像素。
所以当然，它不是居中的。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-04T14:41:58.533

您的问题在于容器的宽度。

(25*2)+200 = 250

250*3 = 750，所以右边有 50px 的间隙，它们在左边对齐。

只需将容器更改`width: 800px;`为`width: 750px;`，就可以了。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-04T14:40:01.800

我通常将 margin-left 值设置为 div 宽度的一半像素，以使其在所有浏览器中看起来都相同。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-09-04T14:40:48.980

它们没有完全居中，因为您没有将它们完全居中。

容器的总宽度为 800 像素。三个 csect 元素中的每一个都是 200 px + 2 x 25 px 宽，因此三个元素的总宽度为 750 px。

将容器宽度设置为 750 像素，它们应该正好在中心。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-09-04T14:41:40.360

尝试在容器上使用`display: inline-block`with`text-align: center`

示例[http://jsbin.com/ibufoc/1/edit](http://jsbin.com/ibufoc/1/edit)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-09-04T14:43:20.923

试试这个：

```
.csect {
    background-color: #E0E0E0;
    display: inline-block;
    height: 200px;
    margin-left: 25px;
    margin-right: 25px;
    width: 200px;
} 
```

# vb.net - Textbox.Text 返回旧值而不是新值

> ID：12265802
> 
> 赞同：0
> 
> 时间：2012-09-04T14:36:54.213
> 
> 标签：vb.net, winforms

我的程序中有以下功能。带有 的线`**`是出错的地方。Textbox.Text 的值返回旧值而不是新值。文本框的`.Text`属性设置为不同的功能。然后用户可以更改它们并运行此功能。但是该`Textbox.Text`字段仍然具有旧值并且没有更新。有谁知道我该如何解决这个问题？

谢谢。

```
Private Function saveListFromEditor()
    Dim newpartialfunctionlist As New List(Of Te)
    For Each Tab As TabPage In TabControl1.TabPages
        For Each TObj In Tab.Controls
            If TObj.GetType.ToString.ToLower = "system.windows.forms.flowlayoutpanel" Then
                Dim flowlayout As FlowLayoutPanel = CType(TObj, FlowLayoutPanel)

                Dim values As NameValueCollection = New NameValueCollection
                For Each obj In flowlayout.Controls
                    If (obj.GetType.ToString.ToLower = "system.windows.forms.textbox") Then
                        Dim textbox As TextBox = CType(obj, TextBox)
                        If (textbox.Name.ToString.ToLower = "display") Then
                            newfunction.display = textbox.Text
                        Else
                            **values.Add(textbox.Name, textbox.Text)**
                        End If
                    End If
                Next
            End If
        Next
    Next
    Return values
End Function 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-05T08:51:26.280

问题已解决。问题不是这段代码的一部分。无论如何，感谢您的评论和帮助。主题可以关闭。

# java - java中的滑动图像转换

> ID：12265805
> 
> 赞同：1
> 
> 时间：2012-09-04T14:37:01.203
> 
> 标签：java

我想为我正在编写的一个小 2D Hunt the Wumpus 游戏添加一个过渡效果。它有一个以当前房间为中心的俯视图，玩家可以在其中移动。房间的每面墙上都有一扇门，它是方形的。

例如，如果玩家穿过北门，我想让房间向下滑动，将房间向北显示。我应该怎么做才能实现这一点？我真的不知道从哪里开始。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-04T14:40:26.783

您可以将中心房间作为一个图像，当玩家进入北门时，北房间图像将 y 更改为较小的值，以便北房间向下滑动，而中心房间也必须通过将 y 更改为 a 来向下滑动较小的值。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-04T14:46:18.097

您正在寻找的是运动插值。基本上，您想一点一点地改变房间的垂直位置，以创建幻灯片效果。或者，您可能希望应用一些加速/减速效果来美化过渡，而不是使用线性方法。

这种效果是众所周知的，并且在 Flash 及其 Tweens 中很流行。补间是在给定时间内从起始值运行到结束值的插值。许多 javascript 框架现在到处都使用补间，比如 jQuery。这种过渡效果很受欢迎。

![在此处输入图像描述](../Images/8d7e3b6f3341b33142fc4794930a8872.png)

为了防止你重新发明轮子，我曾经构建了一个通用动画引擎，[通用补间引擎](http://www.aurelienribon.com/blog/projects/universal-tween-engine/)。[您可以在这里](http://www.aurelienribon.com/universal-tween-engine/gwt/demo.html)看到它的演示（需要启用 webgl 的浏览器），这里有[一些带有代码的](http://www.aurelienribon.com/universal-tween-engine/applets/applet-tween.html) [小程序](http://www.aurelienribon.com/universal-tween-engine/applets/applet-timeline.html)。它最初是为在 android 游戏中创建动画而设计的，但现在它能够为任何 java 项目中的所有内容制作动画。

该库在 apache2 许可下是完全开源的。

# java - javax.smartcardio 无卡传输到 NFC USB 读卡器

> ID：12265807
> 
> 赞同：3
> 
> 时间：2012-09-04T14:37:08.747
> 
> 标签：java, nfc

是否可以在没有实际卡“连接”的情况下使用 javax.smartcardio 将 APDU 发送到 NFC 读卡器（例如 ACR1222L）？根据我的 API 调查，您只能使用从 Card 获得的 CardChannel 以及从 CardTerminal 上的 connect 获得的 CardChannel 发送 APDU。但是，如果您在 NFC 读卡器中没有卡时尝试连接，则会收到 CardException。在某些阅读器上，外围设备使用标准 APDU 进行控制。这样看来，您似乎无法控制 ACR1222 先前卡的任何外围设备。还是我在 javax.smartcardio 中遗漏了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-05T18:41:09.937

根据我的调查，我会为自己部分回答。Card类有方法transmitControlCommand。不知道如何将 APDU 转换为“controlCode”和“command”字节数组。即使没有连接卡，您也可以使用“直接”作为协议的连接方法从 CardTerminal 获取 Card 对象。出于某种原因，“直接”适用于 Windows JVM 1.6，但不适用于 Mac，据报道不适用于 Linux JVM。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-10T07:14:11.397

好的，伙计们，我们快到了。这是下一代的消息:-) 方法传输控制命令需要与您要访问的“功能”相关的 controlCode。根据 ACS 规范，我控制 ACS 外围设备的功能是 ESCAPE，代码为 3500（十进制）。然而，控制代码是由以下组成的：

FILE_DEVICE_SMARTCARD = 0x310000 命令 = 3500 * 4

例如产生的 IOCTL_SMARTCARD_ESCAPE_COMMAND controlCode = 0x310000 + 3500 * 4

现在，您的 ACS 122x 终端将接受该命令。注意，每个终端可能有不同的命令来控制外围设备。

致谢：Adrian Stabiszewski (https://github.com/grundid/nfctools)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-09T17:51:07.830

Another observation indicates, controlCode should be 3500 for ESCAPE command. According documentation for ACR 1222 L escape command is usefull for controlling peripherals of the reader even if there is no card attached. Command byte sequence is then "plain-old" APDU. This is up to theory proven to function using Android USB library provided by ACS. Odd thing is, standard PCSC drivers do not like 3500 (0xDAC) command. Mac's PCSC driver from ACS does not even like connect("direct"). So for now java applet to control ACR1222L is not going to happen. :(

# python - numpy数组中的索引日期时间

> ID：12265809
> 
> 赞同：0
> 
> 时间：2012-09-04T14:37:10.960
> 
> 标签：python, datetime, numpy, recarray

我有一个大致如下的numpy数组：

```
data    
array([(datetime.datetime(2009, 1, 6, 2, 30), 17924.0, 0.0),....
           (datetime.datetime(2009, 1, 29, 16, 30), 35249.2, 521.25], 
         dtype=[('timestamp', '|O4'), ('x1', '<f8'), ('x2', '<f8')]) 
```

我希望能够根据第一列（即使用日期时间对象）对数据进行索引，这样我就可以访问特定年/月/日的数据，如下所示：

```
data[data['timestamp'].year == 2009] 
```

这显然是行不通的。我唯一能想到的就是添加额外的列（例如“年”列），所以这会起作用：

```
data[data['year'] == 2009] 
```

似乎是一种相当低效的做事方式（并且会复制大量数据） - 特别是如果我想对所有其他时间间隔进行索引......有没有更好的方法来做到这一点？

提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-04T14:49:12.943

使用[熊猫](http://pandas.pydata.org/)。“pandas 是一个开源的、获得 BSD 许可的库，为 Python 编程语言提供高性能、易于使用的数据结构和数据分析工具。”

文档中有大量示例，但您可以像这样做您想做的事情：

```
import pandas
import numpy as np
import datetime as dt

# example values
dates = np.asarray(pandas.date_range('1/1/2000', periods=8))

# create a dataframe
df = pandas.DataFrame(np.random.randn(8, 4), index=dates, columns=['A', 'B', 'C', 'D'])

# date you want
date=dt.datetime(2000,1,2)

# magic :)
print df.xs(date) 
```

我建议尽快学习这个模块。这绝对是例外。这是一个非常简单的例子。查看非常详尽的文档。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-05T04:44:19.900

好的，所以我想我解决了这个问题（使用 pandas，如上面 strimp099 所建议的那样），特别是使用“GroupBy”对象[（pandas：Group By：split-apply-combine）](http://pandas.pydata.org/pandas-docs/stable/groupby.html)

详细说明上面使用的示例：

```
import pandas
import numpy as np
import datetime as dt

# example values
dates = np.asarray(pandas.DateRange('1/1/2000', periods=200))

# create a dataframe
df = pandas.DataFrame(np.random.randn(200, 4), index=dates, columns=['A', 'B', 'C', 'D'])

# create a GroupBy object
grouped_data = df.groupby(lambda x: x.month)

#magic
grouped_data.mean()
              A         B         C         D
month                                        
1     -0.492648 -0.038257 -0.224924  0.130182
2     -0.178995  0.236042 -0.471791 -0.369913
3     -0.261866 -0.024680 -0.107211 -0.195742
4      0.215505  0.077079 -0.057511  0.146193
5     -0.097043 -0.335736  0.302811  0.120170
6      0.187583  0.221954 -0.290655 -0.077800
7     -0.134988  0.013719 -0.094334 -0.107402
8     -0.229138  0.056588 -0.156174 -0.067655
9      0.043746  0.077781  0.230035  0.344440
10    -0.533137 -0.683788  0.395286 -0.957894 
```

（即按月分组的数据平均值）

此外，要进行多个分组（即在我的情况下是年和月），这可能会有所帮助：

```
grouped_data = df.groupby(lambda x: (x.year,x.month)) 
```

干杯!

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-05T16:15:59.840

您还可以在 numpy.xml 中使用 datetime dtype。我没有对这两种方法进行基准测试，但它们可能非常接近。这是一个例子：

```
import datetime
import numpy as np

def data_in(dates, year=2009):
    """ Return the dates within the given year. 
    Works only with dates being a numpy array with a datetime dtype.
    """

    from_date = np.array(('{}-01-01'.format(year), ), dtype='M8')
    to_date = np.array(('{}-12-31'.format(year),), dtype='M8')

    return dates[(dates > from_date) & (dates < to_date)]

if __name__ == '__main__':

    data = np.array(
        [
            (datetime.datetime(2009, 1, 6, 2, 30), 17924.0, 0.0),
            (datetime.datetime(2009, 1, 29, 16, 30), 35249.2, 521.25),
            (datetime.datetime(2011, 1, 29, 16, 30), 35249.2, 521.25),
        ], 
        dtype=[('timestamp', 'M8'), ('x1', '<f8'), ('x2', '<f8')]
    )

    for year in [2009, 2010, 2011]:
        print ' Timestamps in {}:\n {}'.format( year, data_in(data['timestamp'], year)) 
```

# xml - 根据属性过滤 xsl

> ID：12265811
> 
> 赞同：0
> 
> 时间：2012-09-04T14:37:17.113
> 
> 标签：xml, xslt, xpath

这是我的 xml 文件中的一个片段

```
 <uformrecord>
          <state>Submitted</state>
          <created>2012-06-19T11:31:54</created>
          <updated>2012-06-19T11:32:13</updated>
          <id>53225sas3c1-d727-42cd-93a6-97cd778e5ee9</id>
          <ip>123.45.3.60</ip>
          <pageid url="/blah.aspx" name="Vacancy Application">1873</pageid>
          <memberkey emaillogin=""></memberkey>
          <fields>

            <ifyouhavetickedyeshowwouldyoudescribeyourdisabilitytickallthatapplytoyou record="532253c1-d727-42cd-93a6-97cd778e5ee9" sortorder="1" pageindex="2" fieldsetindex="0">
              <key>73b9150d-c65c-4ec0-9c8f-8d334b0495bf</key>
              <fieldKey>07a8ade7-ae13-41e6-bc3a-fe8444bcf9b0</fieldKey>
              <caption>If you have ticked 'Yes', how would you describe your disability (Tick all that apply to you.)</caption>
              <datatype>String</datatype>
              <values>
                <value key="c6de1932-9bba-4691-b19e-a44b5bb68c6c">I have a hearing problem</value>
                <value key="dd902bdb-89d7-4f14-ab60-4e69e803f321">I use a wheelchair</value>
                <value key="322c8e15-f722-406c-9d10-1769a2fb306e">I am dyslexic</value>
              </values>
            </ifyouhavetickedyeshowwouldyoudescribeyourdisabilitytickallthatapplytoyou>

    <anotherfieldblaf record="532253c1-d727-42cd-93a6-97cd778e5ee9" sortorder="1" pageindex="1" fieldsetindex="0">
              <key>73b9150d-c65c-4ec0-9c8f-8d334b0495bf</key>
              <fieldKey>07a8ade7-ae13-41e6-bc3a-fe8444bcf9b0</fieldKey>
              <caption>If you have ticked 'Yes', how would you describe your disability (Tick all that apply to you.)</caption>
              <datatype>String</datatype>
              <values>
                <value key="c6de1932-9bba-4691-b19e-a44b5bb68c6c">I have a hearing problem</value>
                <value key="dd902bdb-89d7-4f14-ab60-4e69e803f321">I use a wheelchair</value>
                <value key="322c8e15-f722-406c-9d10-1769a2fb306e">I am dyslexic</value>
              </values>
            </anotherfieldblaf>
.
.
.
.//many more fields
          </fields>
        </uformrecord> 
```

我使用这样的 xpath 来获取字段。

```
<xsl:for-each select="$records//fields/child::*"> 
```

这将返回所有字段，但是我只想获取该字段的 pageindex=2 的字段。

我该怎么做？谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-04T14:47:28.810

你需要做的就是这个...

```
<xsl:for-each select="$records//fields/child::*[@pageindex='2']"> 
```

# go - 使用golang的goroutine时如何实现计数器？

> ID：12265813
> 
> 赞同：8
> 
> 时间：2012-09-04T14:37:20.547
> 
> 标签：go

我正在尝试制作一个具有推送和弹出功能的队列结构。

我需要使用 10 个线程推送和另外 10 个线程弹出数据，就像我在下面的代码中所做的那样。

问题：

1.  我需要打印出我推/弹出了多少，但我不知道该怎么做。
2.  反正有没有加快我的代码？代码对我来说太慢了。

```
package main

import (
    "runtime"
    "time"
)

const (
    DATA_SIZE_PER_THREAD = 10000000
)

type Queue struct {
    records string
}

func (self Queue) push(record chan interface{}) {
    // need push counter
    record <- time.Now()
}

func (self Queue) pop(record chan interface{}) {
    // need pop counter
    <- record
}

func main() {
    runtime.GOMAXPROCS(runtime.NumCPU())
    //record chan
    record := make(chan interface{},1000000)
    //finish flag chan
    finish := make(chan bool)
    queue := new(Queue)
    for i:=0; i<10; i++ {
        go func() {
            for j:=0; j<DATA_SIZE_PER_THREAD; j++ {
                queue.push(record)
            }
            finish<-true
        }()
    }
    for i:=0; i<10; i++ {
        go func() {
            for j:=0; j<DATA_SIZE_PER_THREAD; j++ {
                queue.pop(record)
            }
            finish<-true
        }()
    }
    for i:=0; i<20; i++ {
        <-finish
    }
} 
```

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-09-04T15:37:20.453

您应该解决一些问题。

*   Queue 类型的方法应该有指针接收器。否则，每个方法调用都将创建当前队列类型的副本，并且对队列字段的任何更改都不会持续到方法调用本身之外。

*   等待所有例程完成，可以使用`sync.WaitGroup`. 这正是它的设计目的。

*   在队列类型中维护一个线程安全的推送/弹出计数器可以通过使用`sync/atomic`包来完成。

就速度而言，从您的示例来看，我不太确定您要达到的目标。如果您稍微详细说明一下，可能会出现任何优化。

这是我从您的代码中修改的示例：

```
package main

import (
    "log"
    "runtime"
    "sync"
    "sync/atomic"
    "time"
)

const SizePerThread = 10000000

type Queue struct {
    records string
    count   int64
}

func (q *Queue) push(record chan interface{}) {
    record <- time.Now()

    newcount := atomic.AddInt64(&q.count, 1)
    log.Printf("Push: %d", newcount)
}

func (q *Queue) pop(record chan interface{}) {
    <-record

    newcount := atomic.AddInt64(&q.count, -1)
    log.Printf("Pop: %d", newcount)
}

func main() {
    var wg sync.WaitGroup

    runtime.GOMAXPROCS(runtime.NumCPU())

    record := make(chan interface{}, 1000000)
    queue := new(Queue)

    // We are launching 20 goroutines.
    // Let the waitgroup know it should wait for as many
    // of them to finish.
    wg.Add(20)

    for i := 0; i < 10; i++ {
        go func() {
            defer wg.Done()

            for j := 0; j < SizePerThread; j++ {
                queue.push(record)
            }
        }()

        go func() {
            defer wg.Done()

            for j := 0; j < SizePerThread; j++ {
                queue.pop(record)
            }
        }()
    }

    // Wait for all goroutines to finish.
    wg.Wait()
} 
```

* * *

## 回答 #2

> 赞同：-5
> 
> 时间：2012-09-09T20:18:46.567

对问题 1 的回答：正如 jimt 所建议的，sync/atomic 具有自动更新计数器的功能，这可能对您有用。

问题 2 的答案：减小 DATA_SIZE_PER_THREAD 的值，或者更好的是，使用程序

```
package main
func main() {} 
```

它以更有效的方式产生与您的程序相同的输出。

不过说真的，我知道您编写了一个小程序来探索一些概念。但是，您的程序包含许多问题。现在不是担心速度的时候，而是学习一些基本概念的时候。

# java - 有没有办法使用 JMeter 测量服务器处理时间？

> ID：12265817
> 
> 赞同：2
> 
> 时间：2012-09-04T14:37:50.080
> 
> 标签：java, jmeter, load-testing, qa, performance-testing

有什么方法可以测量 JMeter 中的服务器处理时间是否需要手动计算。我能够测量请求的（响应时间/延迟）和（经过时间），但无法获得处理时间。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-05T17:18:13.127

我认为使用 JMeter 不可能做到这一点。

因为要做到这一点，你需要服务器发送第一个字节和客户端接收它之间的时间（网络时间），因为你没有它......

即使这样，我也不确定它是否准确，因为服务器可以在开始在响应缓冲区中写入字节的同时继续处理。

所以我的回答是单独使用 JMeter 是不可能的。

# jquery - 等高插件没有计算正确的高度

> ID：12265821
> 
> 赞同：1
> 
> 时间：2012-09-04T14:38:03.740
> 
> 标签：jquery, css, page-refresh, equal-heights

[http://www.tmla.org/new_site/](http://www.tmla.org/new_site/)

那是相关的链接。刷新页面时会出现此问题。从浏览器或缓存中正常加载页面似乎没问题。不知道为什么会这样。任何人都可以帮助阐明这一点吗？任何帮助，将不胜感激。要遵循的代码：

```
 (function($) {
        $.fn.equalHeights = function(minHeight, maxHeight) {
            column1 = 0;
            column2 = 0;
            column3 = 0;

            //FIND THE TOTAL HEIGHT OF EACH COLUMN BY ADDING UP EACH WIDGET, SORTING BY UNIQUE COLUMN CLASS
            this.each(function() {
                if($(this).hasClass('column1')) {
                    column1 = column1 + $(this).height();
                } else if($(this).hasClass('column2')) {
                    column2 = column2 + $(this).height();
                } else if($(this).hasClass('column3')) {
                    column3 = column3 + $(this).height();
                }
            });

            //alert(column1);
            //alert(column2);
            //alert(column3);

            //FIND THE TALLEST COLUMN
            tallest = Math.max(column1, column2, column3);

            //alert(tallest);

            //SIMPLE MATH TO DETERMINE HOW MUCH HEIGHT TO MAKE THE LAST WIDGET OF EACH COLUMN SO THEY LINE UP NICE AND NEAT
            column1 = tallest - column1 + $('#left_sidebar .widget').last().height();
            column2 = tallest - column2 + $('#center_sidebar .widget').last().height();
            column3 = tallest - column3 + $('#right_sidebar .widget').last().height();

            //alert('Add how much to Column 1: ' + column1);
            //alert('Add how much to Column 2: ' + column2);
            //alert('Add how much to Column 3: ' + column3);

            //alert('Left' + $('#left_sidebar .widget').last().css('height'));
            //alert('Center' + $('#center_sidebar .widget').last().css('height'));
            //alert('Right' + $('#right_sidebar .widget').last().css('height'));

            if(column1 != '0px') {
                $('#left_sidebar .widget').last().css('height', column1 + 'px');
            }

            if(column2 != '0px') {
                $('#center_sidebar .widget').last().css('height', column2 + 'px');
            }

            if(column3 != '0px') {
                $('#right_sidebar .widget').last().css('height', column3 + 'px');
            }
        } 
    })(jQuery); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-04T15:12:05.347

只是出于好奇，您能否将宽度和高度属性添加到“TMLA You deverve to be here”的图像中。应用 equalHeight 时，我有时会遇到这个问题......取决于图像是否加载，equalheight 不会得到正确的高度......实际上它是正确的高度，但不是你所期望的。

所以我的猜测是应用了equalHeights，然后加载了这个图像，这就是为什么你在第一列上多了166px。

您没有在其他列上看到这一点，因为所有图像都具有宽度和高度属性！

* * *

仅供参考：为列设置相同高度的最简单方法来自[Paul Irish](http://paulirish.com)。抱歉找不到原始帖子，所以这里是代码。

```
$.fn.setAllToMaxHeight = function(){
    return this.height( Math.max.apply(this, $.map( this , function(e){ return $(e).height() }) ) );
} 
```

用法

```
$('.selector').setAllToMaxHeight(); 
```

# azure - 命名空间中的多个中继端点用于通过服务总线公开服务？

> ID：12265822
> 
> 赞同：2
> 
> 时间：2012-09-04T14:38:05.290
> 
> 标签：azure, servicebus, azureservicebus

我无法激活由同一 NAMESPACE 中的两个不同中继端点公开但地址不同的服务。如果我删除其中一个服务激活正常，所以配置很好。我尝试更改绑定的类型，更改名称空间，添加两个行为配置而不是仅添加一个，但我总是得到相同的错误（在底部）。

有人知道我是否遗漏了什么吗？我可以在同一个命名空间中有两个中继端点吗？

```
<service name="Service">    
        <endpoint contract="IService"  binding="basicHttpRelayBinding" name="b1 "
                  address="http://**NAMESPACE**.servicebus.windows.net/s1"  behaviorConfiguration="credentials"/>    
        <endpoint contract="IService" binding="webHttpRelayBinding" name="wh1"
                  address="https://**NAMESPACE**.servicebus.windows.net/s2"  behaviorConfiguration="credentials"/>                                       
</service>    
<behavior name="credentials">
            <serviceRegistrySettings discoveryMode="Public" displayName="Auxiliar" />
            <transportClientEndpointBehavior>
                <tokenProvider>
                    <sharedSecret issuerName="owner" issuerSecret="**KEY**" />
                </tokenProvider>
            </transportClientEndpointBehavior>
   </behavior> 
```

错误是：

> 一个 ExceptionDetail，可能由 IncludeExceptionDetailInFaults=true 创建，其值为：System.ArgumentException：该值无法添加到集合中，因为集合已包含相同类型的项：“Microsoft.ServiceBus.NameSettings”。此集合仅支持每种类型的一个实例。参数名称：System.Collections.Generic.KeyedByTypeCollection 处的项`1.InsertItem(Int32 index, TItem item) at Microsoft.ServiceBus.ServiceRegistrySettings.System.ServiceModel.Description.IEndpointBehavior.AddBindingParameters(ServiceEndpoint endpoint, BindingParameterCollection bindingParameters) at System.ServiceModel.Description.DispatcherBuilder.AddBindingParameters(ServiceEndpoint endpoint, BindingParameterCollection parameters) at System.ServiceModel.Description.DispatcherBuilder.GetBindingParameters(ServiceHostBase serviceHost, Collection`1 个端点）在 System.ServiceModel.Description.ServiceMetadataExtension.EnsureInitialized() 在 System.ServiceModel.Description.ServiceMetadataExtension.HttpGetImpl.InitializationData.InitializeFrom(ServiceMetadataExtension extension) 在 System.ServiceModel.Description.ServiceMetadataBehavior.MetadataExtensionInitializer.GenerateMetadata()。 ServiceModel.Description.ServiceMetadataExtension.HttpGetImpl.GetInitData() 在 System.ServiceModel.Description.ServiceMetadataExtension.HttpGetImpl.TryHandleDocumentationRequest(Message httpGetRequest, String[] 查询, Message& replyMessage) 在 System.ServiceModel.Description.ServiceMetadataExtension.HttpGetImpl.ProcessHttpRequest(Message httpGetRequest ) 在 System.ServiceModel.Dispatcher.SyncMethodInvoker 的 SyncInvokeGet(Object , Object[] , Object[] )。在 System.ServiceModel.Dispatcher.ImmutableDispatchRuntime.ProcessMessage5(MessageRpc& rpc) 在 System.ServiceModel.Dispatcher .ImmutableDispatchRuntime.ProcessMessage31(MessageRpc& rpc) 在 System.ServiceModel.Dispatcher.MessageRpc.Process(Boolean isOperationContextSet)进程（布尔 isOperationContextSet）进程（布尔 isOperationContextSet）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-04T16:47:27.937

您发现的问题是[`/behavior/serviceRegistrySettings/@displayName`](http://msdn.microsoft.com/en-us/library/microsoft.servicebus.serviceregistrysettings.displayname.aspx)两个服务定义发生冲突。如果您想控制`displayName`每个端点，那么您需要创建单独的命名行为。在复制端点合同时，您需要确保**显示名称是唯一的。**

### 选项 #1 - 移除`displayName`

```
 <behavior name="credentials">
     <serviceRegistrySettings discoveryMode="Public" />
       <transportClientEndpointBehavior>
         <tokenProvider>
           <sharedSecret issuerName="owner" issuerSecret="**KEY**" />
         </tokenProvider>
       </transportClientEndpointBehavior>
   </behavior> 
```

### 选项 #2 - 创建重复的行为配置

```
 <service name="Service">    
        <endpoint contract="IService"  binding="basicHttpRelayBinding" name="b1 "
                  address="http://**NAMESPACE**.servicebus.windows.net/s1"  behaviorConfiguration="basicCredentials"/>    
        <endpoint contract="IService" binding="webHttpRelayBinding" name="wh1"
                  address="https://**NAMESPACE**.servicebus.windows.net/s2"  behaviorConfiguration="webHttpCredentials"/>                                       
   </service>   
   <behavior name="basicCredentials">
     <serviceRegistrySettings discoveryMode="Public" displayName="AuxiliarBasic"/>
       <transportClientEndpointBehavior>
         <tokenProvider>
           <sharedSecret issuerName="owner" issuerSecret="**KEY**" />
         </tokenProvider>
       </transportClientEndpointBehavior>
   </behavior>
   <behavior name="webHttpCredentials">
     <serviceRegistrySettings discoveryMode="Public" displayName="AuxiliarWebHttp"/>
       <transportClientEndpointBehavior>
         <tokenProvider>
           <sharedSecret issuerName="owner" issuerSecret="**KEY**" />
         </tokenProvider>
       </transportClientEndpointBehavior>
   </behavior> 
```

# asp.net - 带有 WebAPI 安全问题的 CORS/JSONP

> ID：12265826
> 
> 赞同：2
> 
> 时间：2012-09-04T14:38:16.327
> 
> 标签：asp.net, asp.net-web-api, wcf-security, wcf-web-api

我想知道是否*有人*为我的场景提供简化的解决方案，我现在没有想法。

我有一个 WebAPI 服务，我想在另一个域上而不是我的站点调用它。此服务已得到保护，因此需要基本身份验证。

我想从 jQuery 中调用它，在其中你不能发送“jsonp”请求，因为你不能设置请求头，我不能使用 json，因为我必须使用 CORS，其中不是' t 受 IE6/7 支持，所以这也不可行。

是否有任何其他选项可供我使我的方案正常工作？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-04T15:22:49.053

如果您要在 Javascript 中创建身份验证标头，那将使您的身份验证/安全性毫无意义（客户端 = 任何客户端都可以看到凭据）。

您还可以在 url（而不是标头）中发送*基本身份验证凭据：* [http://user:pass@my_domain.com](http://user:pass@my_domain.com)（**不是**您应该这样做的）。

您可以在实际执行此操作的调用应用程序中创建/调用服务器端“代理” `http request`- 您可以完全控制所需的任何标头。

由于您正在实施基本身份验证明文，因此希望您也使用 SSL。您的凭据对客户端不可见（调用是服务器端的）。

然后，该调用将是您的 Javascript/jQuery 的“本地”。

问题：除非您过滤/验证对代理的请求，否则它几乎使身份验证毫无意义（也）。

嗯……

# php - json_encode 可以触发 catch 块吗？

> ID：12265830
> 
> 赞同：6
> 
> 时间：2012-09-04T14:38:41.063
> 
> 标签：php, json

这可能是一个非常简单的问题，但我找不到任何关于它的信息。

我使用的系统聚合了来自各种来源的大量数据，然后将这些数据存储在数据库中。在大多数情况下，系统运行良好，但有时我们会遇到系统不喜欢的数据可能具有笨拙的字符编码（例如，当数据是另一种语言，如法语时）的问题。

数据被传递到我们的处理服务器（我们使用 Gearman），并确保所有与源有关的信息都被传递，我们用我们需要的一切对数组进行 json_encode。我的问题是：如果我将 json_encode 包装在 try/catch 块中，导致“PHP 警告：json_encode(): Invalid UTF-8 sequence in argument”消息的事情会触发 catch 块激活吗？

谢谢！

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-09-04T14:47:48.277

不，但您可以在函数中检查它的返回值，并在出现问题时抛出异常。您还可以使用[`json_last_error`](http://www.php.net/manual/en/function.json-last-error.php)来获取有关错误的详细信息

例子：

```
function my_json_encode($data) {
    if( json_encode($data) === false ) {
        throw new Exception( json_last_error() );
    }
}

try {
    my_json_encode($data);
}
catch(Exception $e ) {
    // do something
} 
```

我确实觉得很烦人，要获得实际的错误消息，您必须检查从`json_last_error()`. 过去，我使用 switch / case 语句来实现这一点，但您可以根据错误抛出不同的异常。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-04T14:42:24.720

不是本机，您将需要设置一些自定义错误处理。

```
<?php

function exception_error_handler($errno, $errstr, $errfile, $errline)
{
    throw new ErrorException($errstr, $errno, 0, $errfile, $errline);
}

set_error_handler('exception_error_handler'); 
```

然后你可以这样做：

```
try
{
    json_encode(...);
}
catch (ErrorException $e)
{
    // do some thing with $e->getMessage()
} 
```

但请记住，这将导致所有 PHP 错误引发异常，因此您应该根据需要对其进行微调。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-08-25T07:27:49.027

您还可以根据错误输出错误或显示异常。就像见下面的代码。

```
<?php

protected static $_messages = array(
    JSON_ERROR_NONE => 'No error has occurred',
    JSON_ERROR_DEPTH => 'The maximum stack depth has been exceeded',
    JSON_ERROR_STATE_MISMATCH => 'Invalid or malformed JSON',
    JSON_ERROR_CTRL_CHAR => 'Control character error, possibly incorrectly encoded',
    JSON_ERROR_SYNTAX => 'Syntax error',
    JSON_ERROR_UTF8 => 'Malformed UTF-8 characters, possibly incorrectly encoded'
);

public static function encode($value, $options = 0) {
    $result = json_encode($value, $options);

    if($result)  {
        return $result;
    }

    throw new RuntimeException(static::$_messages[json_last_error()]);
}

public static function decode($json, $assoc = false) {
    $result = json_decode($json, $assoc);

    if($result) {
        return $result;
    }

    throw new RuntimeException(static::$_messages[json_last_error()]);
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-08-22T18:59:43.987

从 PHP 7.3 开始，您可以使用该`JSON_THROW_ON_ERROR`选项。在 PHP 5.5 中，他们将错误的返回值`json_encode`从 from`null`更改为`false`。这是一个涵盖各种 PHP 版本的解决方案。

```
function callJSONFunc($jsonFuncName, $args) {
    if (defined('JSON_THROW_ON_ERROR')) {
        $args[1] = $args || JSON_THROW_ON_ERROR;
    }
    $ret = call_user_func_array($jsonFuncName, $args);
    if (!defined('JSON_THROW_ON_ERROR')) {
        if ($ret === false || $ret === null) {
            throw new JSONException(json_last_error_msg());
        }
    }
    return $ret;
}

class JSONException extends Exception {}

function decodeJSON() { return callJSONFunc('json_decode', func_get_args()); }
function encodeJSON() { return callJSONFunc('json_encode', func_get_args()); } 
```

# ios - 用路径提取 UIImage

> ID：12265834
> 
> 赞同：2
> 
> 时间：2012-09-04T14:38:57.700
> 
> 标签：ios, objective-c, ios5

如何提取带有路径的 UIImage？

我需要将路径内的内容放入新的 UIImage 中。我需要的是旋转矩形的内容。这是我用来获取矩形角的代码。（x，y = 图像中心。图像的宽度、高度）。

```
UIBezierPath* aPath = [UIBezierPath bezierPath];

//1
[aPath moveToPoint:CGPointMake(
                               x+(width/2)*cosf(A)-(height/2)*sinf(A),
                               y+(height/2)*cosf(A)+(width/2)*sinf(A))];

NSLog(@"%f, %f", x+(width/2)*cosf(A)-(height/2)*sinf(A),
      y+(height/2)*cosf(A)+(width/2)*sinf(A));

//2
[aPath moveToPoint:CGPointMake(
                               x-(width/2)*cosf(A)-(height/2)*sinf(A),
                               y+(height/2)*cosf(A)-(width/2)*sinf(A))];

NSLog(@"%f, %f", x-(width/2)*cosf(A)-(height/2)*sinf(A),
      y+(height/2)*cosf(A)-(width/2)*sinf(A));

//3
[aPath moveToPoint:CGPointMake(
                               x-(width/2)*cosf(A)+(height/2)*sinf(A),
                               y-(height/2)*cosf(A)-(width/2)*sinf(A))];

NSLog(@"%f, %f", x-(width/2)*cosf(A)+(height/2)*sinf(A),
      y-(height/2)*cosf(A)-(width/2)*sinf(A));

//4
[aPath moveToPoint:CGPointMake(
                               x+(width/2)*cosf(A)+(height/2)*sinf(A),
                               y-(height/2)*cosf(A)+(width/2)*sinf(A))];

NSLog(@"%f, %f", x+(width/2)*cosf(A)+(height/2)*sinf(A),
      y-(height/2)*cosf(A)+(width/2)*sinf(A));

//5
[aPath moveToPoint:CGPointMake(
                               x+(width/2)*cosf(A)-(height/2)*sinf(A),
                               y+(height/2)*cosf(A)+(width/2)*sinf(A))];

NSLog(@"%f, %f", x+(width/2)*cosf(A)-(height/2)*sinf(A),
      y+(height/2)*cosf(A)+(width/2)*sinf(A));
[aPath closePath]; 
```

我在想这样的事情：[问题的图片。](http://i50.tinypic.com/30nhpnb.png) （这里的形状不同。）我希望那个黄色部分是一个新的 UIImage。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-04T14:44:33.440

使用您的`UIBezierPath`作为剪切路径。有这样的`addClip`方法。

请参阅[Quartz2D Programming Guide](https://developer.apple.com/library/ios/#documentation/graphicsimaging/conceptual/drawingwithquartz2d/dq_paths/dq_paths.html)，尤其是[这部分](https://developer.apple.com/library/ios/documentation/graphicsimaging/conceptual/drawingwithquartz2d/dq_paths/dq_paths.html#//apple_ref/doc/uid/TP30001066-CH211-TPXREF126)了解详细信息。

这个想法是创建一个新的位图上下文，使用您的路径应用剪辑，然后在此位图上下文上绘制图像（因此将被剪辑），最后从中生成一个 UIImage 。

*此外，与其自己做一些数学运算来旋转`CGRect`你想要用于剪辑的东西，你应该创建一个`CGRect`没有任何旋转的，并使用`CGAffineTransform`它来旋转它。这将避免需要自己使用`cos`/`sin`函数进行计算，并使您的代码更易于阅读。*

* * *

[编辑] 这是一个完整的例子：

*   生成贝塞尔路径并对其应用 CGAffineTransform 旋转
*   使用此贝塞尔路径剪辑图像

我确实检查了它并且像一个魅力一样工作。

```
// Generate a UIBezierPath of a rounded rect rotated by angle radians
-(UIBezierPath*)computePathWithRect:(CGRect)rect
                       cornerRadius:(CGFloat)cornerRadius
                              angle:(CGFloat)radians;
{
  // Compute basic path
  UIBezierPath* path = [UIBezierPath bezierPathWithRoundedRect:rect cornerRadius:cornerRadius];

  // Apply rotation.
  // Don't forget that rotations are around origin 0,0 so if you want to rotate around the rect's center,
  // you need to apply a translation so that the rect's center is at 0,0, then rotate, and translate it back at its original position.
  CGAffineTransform restoreCenterPosition = CGAffineTransformMakeTranslation(CGRectGetMidX(rect), CGRectGetMidY(rect));
  CGAffineTransform rotateFromOrigin = CGAffineTransformRotate(restoreCenterPosition,radians);
  CGAffineTransform rotateFromRectCenter = CGAffineTransformTranslate(rotateFromOrigin, -CGRectGetMidX(rect), -CGRectGetMidY(rect));
  [path applyTransform:rotateFromRectCenter];

  return path;
}

// Generate a new image from srcImage but clipped with the given path
-(UIImage*)clipImage:(UIImage*)srcImage withPath:(UIBezierPath*)path
{
  UIGraphicsBeginImageContextWithOptions(srcImage.size, NO, 0.0);

  // Add clipping path
  // Actually UIBezierPath has a method for that, that is equivalent to CGContextClip(currentContext, bezierPath.CGPath), so better use it
  [path addClip];

  // Flip coordinates before drawing image as UIKit and CoreGraphics have inverted coordinate system
  CGContextTranslateCTM(UIGraphicsGetCurrentContext(), 0, srcImage.size.height);
  CGContextScaleCTM(UIGraphicsGetCurrentContext(), 1, -1);
  // Draw image, that will thus be clipped, on the bitmap context
  CGContextDrawImage(UIGraphicsGetCurrentContext(), CGRectMake(0, 0, srcImage.size.width, srcImage.size.height), srcImage.CGImage);

  // Generate final (clipped) image
  UIImage* clippedImage = UIGraphicsGetImageFromCurrentImageContext();
  UIGraphicsEndImageContext();

  return clippedImage;
}

// Usage example
- (void)doClipping
{
  UIImage* originalImage = ...
  UIBezierPath* path = [self computePathWithRect:CGRectMake(100,100,184,94)
                                    cornerRadius:10.f
                                           angle:30*M_PI/180.f];
  UIImage* clippedImage = [self clipImage:originalImage withPath:path];
  self.resultImageView.image = clippedImage;
} 
```

# jquery - Wordpress Jquery Colorbox 删除重复项

> ID：12265836
> 
> 赞同：0
> 
> 时间：2012-09-04T14:38:59.673
> 
> 标签：jquery, wordpress, colorbox

我在这里有这个 wordpress 电子商务网站 /products-page/rings/product-1-2/ 我正在使用一个名为 jquery-colorbox 的插件，正如你从页面链接中看到的那样，我有 4 个图像，2 个是相同的，当您单击任何图像时，它会说画廊有 3 张图像（这是真的），但其中 1 张是重复的。是否可以从 jquery-colorbox 中删除重复项？我试图用谷歌搜索它，但一无所获:(

如果有人能让我朝着正确的方向前进，我将不胜感激。

这是我的代码，如果有帮助

```
<div class="imagecol">
<a class="preview_link cboxElement" style="text-decoration:none;" href="/wp-content/uploads/2012/07/DSC_0118.jpg" rel="Teardrop Druzy Amethyst Ring">
<img id="product_image_736" class="product_image colorbox-736" width="400" src="/wp-content/uploads/2012/07/DSC_0118.jpg" title="Teardrop Druzy Amethyst Ring" alt="Teardrop Druzy Amethyst Ring">
<br>
<div style="text-align:center; color:#F39B91;">Click To Enlarge</div>
</a>
<div class="wpcart_gallery" style="text-align:center; padding-top:5px;">
<a class="thickbox cboxElement" title="DSC_0118" href="/wp-content/uploads/2012/07/DSC_0118.jpg" rel="Teardrop Druzy Amethyst Ring" rev="/wp-content/uploads/2012/07/DSC_0118.jpg">
<img class="attachment-gold-thumbnails colorbox-736" width="50" height="50" title="DSC_0118" alt="DSC_0118" src="/wp-content/uploads/2012/07/DSC_0118-50x50.jpg">
</a>
<a class="thickbox cboxElement" title="P7230376" href="/wp-content/uploads/2012/07/P7230376.jpg" rel="Teardrop Druzy Amethyst Ring" rev="/wp-content/uploads/2012/07/P7230376.jpg">
<img class="attachment-gold-thumbnails colorbox-736" width="50" height="50" title="P7230376" alt="P7230376" src="/wp-content/uploads/2012/07/P7230376-50x50.jpg">
</a>
<a class="thickbox cboxElement" title="P7230378" href="/wp-content/uploads/2012/07/P7230378.jpg" rel="Teardrop Druzy Amethyst Ring" rev="/wp-content/uploads/2012/07/P7230378.jpg">
<img class="attachment-gold-thumbnails colorbox-736" width="50" height="50" title="P7230378" alt="P7230378" src="/wp-content/uploads/2012/07/P7230378-50x50.jpg">
</a>
</div>
</div> 
```

我将此添加到我的`<head></head>`部分

```
<script type="text/javascript">

    $(document).ready(function(){
        var srcs = [],
            temp;
        $(".attachment-gold-thumbnails img").filter(function(){
            temp = $(this).attr("src");
            if($.inArray(temp, srcs) < 0){
                srcs.push(temp);   
                return false;
            }
            return true;
        }).remove();
    });

    </script> 
```

它仍然没有工作:(

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-04T14:46:19.020

复制了代码，但在这里仍然如此：

```
$(function(){
    var srcs = [],
        temp;
    $(".attachment-gold-thumbnails img").filter(function(){
        temp = $(this).attr("src");
        if($.inArray(temp, srcs) < 0){
            srcs.push(temp);   
            return false;
        }
        return true;
    }).remove();
}); 
```

详情请查看[来源](https://stackoverflow.com/questions/8415910/filtering-duplicate-img-src-with-jquery-unique-or-remove)：

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-11-08T15:56:34.270

你可以使用这个 jQuery 代码来达到这个目的：

```
var arrayImgsColorbox = new Array();

$('.cboxElement').each(function(i, obj){
    if($.inArray($(obj).attr('href'), arrayImgsColorbox ) > -1)
        $(obj).removeClass('cboxElement');
    else
        arrayImgsColorbox[i] = $(obj).attr('href');
}); 
```

# android - 如何在android上滑动页面时播放短声音

> ID：12265839
> 
> 赞同：0
> 
> 时间：2012-09-04T14:39:08.313
> 
> 标签：android, media-player, android-viewpager

我想播放一个简短的声音文件（例如mp3，wav）。如何在滑动页面时播放简短的声音。如何更改我的代码，我想添加媒体播放器。请帮助我。（原始文件夹中的声音）

非常感谢，

```
package ro.ovidiuconeac.horizontalviewswiping; 
import ro.ovidiuconeac.horizontalviewswiping.R; 
import android.app.Activity; 
import android.support.v4.view.ViewPager.OnPageChangeListener; 
import android.view.View; 
import android.view.View.OnClickListener; 
import android.widget.Button; 
import android.widget.Toast; 

public class CustomPageChangeListener implements OnPageChangeListener,OnClickListener { 

private Button buttonBlue   =   null; 
private Button buttonYellow =   null; 
private Button buttonRed    =   null; 
private Activity context    =   null; 

/** 
 * Constructor 
 */  

public CustomPageChangeListener(Activity context) { 
this.context = context; 

} 

public void onPageScrollStateChanged(int arg0) { 
// TODO Auto-generated method stub 

} 

public void onPageScrolled(int arg0, float arg1, int arg2) { 
// TODO Auto-generated method stub 

} 

public void onPageSelected(int position) { 

switch (position) { 
case 0 : { 
    buttonBlue = (Button)    context.findViewById(R.id.buttonBlue); 
    buttonBlue.setOnClickListener(this); 

    break; 
    } 
    case 1 : { 
    buttonYellow = (Button) context.findViewById(R.id.buttonYellow); 
    buttonYellow.setOnClickListener(this); 
    break; 
} 
case 2 : { 
    buttonRed = (Button) context.findViewById(R.id.buttonRed); 
    buttonRed.setOnClickListener(this); 
    break; 
} 
}    
} 

public void onClick(View v) { 

// Click button blue 
if (buttonBlue != null && v.getId() == buttonBlue.getId()) { 
Toast.makeText(context, "Blue screen", Toast.LENGTH_SHORT).show(); 

} 

// Click button yellow 
if (buttonYellow != null && v.getId() == buttonYellow.getId()) { 
 //  Toast.makeText(context, "Yellow screen",   Toast.LENGTH_SHORT).show(); 
} 

// Click button red 
if (buttonRed != null && v.getId() == buttonRed.getId()) { 
Toast.makeText(context, "Red screen", Toast.LENGTH_SHORT).show(); 

}    
} 

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-04T14:47:28.967

首先你应该把 pagescroll.mp3 文件放在 assets 文件夹中，然后你可以使用下面的代码：

```
public static void pageScrollSound(Context context) {
private static MediaPlayer player;
private static AssetFileDescriptor assetFileDescriptor;
    try {
        assetFileDescriptor = context.getResources().getAssets().openFd("pagescroll.mp3");
    } catch (IOException e) {
        Log.e(Constant.LOG_TAG, "IOException", e);
    }
    try {
        player = new MediaPlayer();
        player.setDataSource(assetFileDescriptor.getFileDescriptor(),
                assetFileDescriptor.getStartOffset(),
                assetFileDescriptor.getLength());
        player.prepare();
        player.start();
    } catch (IllegalArgumentException e) {
        Log.e(Constant.LOG_TAG, "IllegalArgumentException", e);
    } catch (IllegalStateException e) {
        Log.e(Constant.LOG_TAG, "IllegalStateException", e);
    } catch (IOException e) {
        Log.e(Constant.LOG_TAG, "IOException", e);
    }
} 
```

# oop - OOP 设计：将责任放在哪里？

> ID：12265841
> 
> 赞同：2
> 
> 时间：2012-09-04T14:39:16.440
> 
> 标签：oop, design-patterns

我有一个简单的对象列表。我想**为每个对象计算一种哈希值**，用于对列表进行排序。

我的问题是：**谁负责计算哈希？**

1/ 名单

因为哈希方法是特定于列表的，并且应用于每个对象。对象只是对象，它们不知道排序和散列。

2/ 每个对象

因为该对象是最佳候选对象，因为他拥有所有数据来执行此操作。这可以根据其他人无法访问的内部数据来计算。

3/ 另一个挑战者？就像列表和对象之间的控制器？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-04T15:07:50.290

定义使用的等价概念的类。

如果一个对象定义了一个通用的相等概念，那么它应该定义一个与之对应的哈希码，作为该工作的一部分。

毕竟，正是那个类“知道”如何定义`Equals()`, `isEqual()`,`areEqual`或`==`其他任何东西。有必要 when `a == b`that `hash(a) == hash(b)`，所以它是唯一可以这样做的类。

但是，如果另一个类定义了一个相等的概念，（可能以不同的方式使用不同的概念，其中人们可能认为字符串相等或不相等的不同方式是一个经典示例），那么该类必须出于类似的原因定义哈希码。

作为示例，.NET 表达了这种责任联系。在 .NET 中，所有对象都有一个`Equals()`. 这是否是一件好事是有争议的（有些人更喜欢 C++ 方法，其中一个对象不需要有任何与另一个相等的感觉），但一旦完成，所有对象也有一个`GetHashCode()`，因为之间的联系一个和另一个。.NET 也有`IEqualityComparer<T>`并且`IEqualityComparer`它定义了一个类对特定的非内置平等感负责的方法。在这里，要对一个人负责，就需要对另一个人负责。

现在。哪个更好？

好吧，如果在给定的情况下对“等于”的含义有一种非常明显的感觉，那么它可能应该由类来处理：相同坐标或相同复数或引用相同实数的两个表示- world 对象，在大多数情况下应该被认为是相等的。所以这给出了默认使用。

如果在给定容器类型的上下文中，对于 equals 的含义有非常明显的意义，那么应该在此处应用。

否则应该有一个定义它的连接器。因此，我们可以很好地分离关注点。

但是，我们可以将这三者巧妙地结合在一起。我们定义了一个默认连接器。它的实现只是传递调用以获取哈希码或测试与对象上定义的相等性。

我们定义任何通用哈希表、哈希集等以始终使用连接器，并在构造时使用默认值或默认模板参数（如果语言具有允许这样做的通用/模板方法，例如 C++会，而 C# 例如不会），因此默认情况下我们使用此默认连接器。

在定义依赖于特定概念视图来实现其目的的特殊用途集合类型时，我们从这些集合之一构建它，覆盖连接器。

这条规则的另一面是，如果您没有为所有可相等的对象提供哈希码的定义方法（例如，您有一个`==`覆盖机制，但没有对 a 的深度支持`GetHashCode()`），那么您**必须**使用连接器方法。请注意，虽然 C++ 例如确实有`==`，但它没有那种知道如何拥有给定对象的支持。因此，STL 必须有一个`hash_map`并且对其开箱即用的默认设置只有非常有限的支持。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-04T17:04:37.483

您的对象应包含计算哈希码值的方法。

在 java 中，Object 是所有类的父类，它具有 hashCode() 方法[（Java Object）](http://docs.oracle.com/javase/1.5.0/docs/api/java/lang/Object.html)。这意味着Java中的每个对象都有这个方法来计算这个方法。背后的原因纯粹是对信息的封装。hashCode() 是在类属性上执行的，因此它应该放在那个特定的类中。

# c++ - 输出 GLfloat 值会给出正确的值，但将其存储在另一个变量中并输出该变量会给出错误的值

> ID：12265842
> 
> 赞同：2
> 
> 时间：2012-09-04T14:39:21.407
> 
> 标签：c++, opengl

我正在使用 freeglut 和 glew 开发一个项目，尽管我认为这与我的问题无关。这些第一行输出我期望的值。(-1, -1)。注意：mikesVertices[0].x 和 mikesVertices[0].y 属于 GLfloat 类型。

```
std::cout << "(" << mikesVertices[0].x << ", " << mikesVertices[0].y << ")" << endl; 
```

但是，这两行（紧随其后..

```
GLfloat x = mikesVertices[0].x;
std::cout << "x: " << x << endl; 
```

为 x 输出不正确的值。(1.92749e-039)

我尝试这样做的原因是因为我想将值传递给函数，但函数也得到了错误的值。任何帮助，将不胜感激。

编辑： mikesVertices 是一个指向 vec2 对象的指针（由 Angel 编写，我已经展示了我认为必要的部分）

```
struct vec2 {

GLfloat  x;
GLfloat  y;

//
//  --- Constructors and Destructors ---
//

vec2( GLfloat s = GLfloat(0.0) ) :
x(s), y(s) {}

vec2( GLfloat x, GLfloat y ) :
x(x), y(y) {}

vec2( const vec2& v )
{ x = v.x;  y = v.y;  }

//
//  --- Insertion and Extraction Operators ---
//

friend std::ostream& operator << ( std::ostream& os, const vec2& v ) {
return os << "( " << v.x << ", " << v.y <<  " )";
}

friend std::istream& operator >> ( std::istream& is, vec2& v )
{ return is >> v.x >> v.y ; }

//
//  --- Conversion Operators ---
//

operator const GLfloat* () const
{ return static_cast<const GLfloat*>( &x ); }

operator GLfloat* ()
{ return static_cast<GLfloat*>( &x ); } 
```

# spring - Spring 3 中的多客户端（Java swings desktop + mobile + web）

> ID：12265843
> 
> 赞同：-1
> 
> 时间：2012-09-04T14:39:24.340
> 
> 标签：spring, gwt, web-applications

我对 Web 东西很陌生....我正在使用 Spring3 MVC 编写一个带有多个客户端的 RESTful Web 应用程序，如桌面（java Swings、JavaFX）、Web 客户端和移动设备等......请帮助并建议如何以及使用哪个我设计服务器的方式以及我使用哪些技术在桌面客户端和 Spring Web 服务器之间进行通信？公共 HTTPClient 怎么样？？？？我打算将 GWT 用于 Web 客户端。推荐 GWT 吗？

对于桌面客户端，哪个是好的 JavaFX 或 Swings？

以上都有意义吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-05T10:09:53.663

你的问题有点令人困惑。由于您选择了 Spring 来实现 RESTful 服务，因此您的服务器端已经设置好了。我会选择 JSON 进行通信。JSON 是轻量级的，并且受您列出的所有客户端技术的支持。

Spring 框架中有一些客户端类，您可以在桌面应用程序中使用它们。

GWT 提供了与服务器通信的 RequestBuilder 机制。

至于移动客户端，为什么不在移动设备上使用您的 GWT Web 应用程序。例如，请参阅[PhoneGap](http://phonegap.com/)。

# java - Java中的数字金字塔

> ID：12265849
> 
> 赞同：6
> 
> 时间：2012-09-04T14:39:38.497
> 
> 标签：java, loops, nested-loops, conditional-operator, ascii-art

我正在尝试用 Java 打印一个看起来像这样的金字塔：

```
 9
              8 9 8
            7 8 9 8 7
          6 7 8 9 8 7 6
        5 6 7 8 9 8 7 6 5
      4 5 6 7 8 9 8 7 6 5 4
    3 4 5 6 7 8 9 8 7 6 5 4 3
  2 3 4 5 6 7 8 9 8 7 6 5 4 3 2
1 2 3 4 5 6 7 8 9 8 7 6 5 4 3 2 1 
```

我正在寻找在互联网上解决这个问题的方法，我偶然发现了这个：

```
class Pyramid {
    public static void main(String[] args) {
        int x = 7;
        for (int i = 1; i <= x; i++) {
            for (int j = 1; j <= x - i; j++)
                System.out.print("   ");
            for (int k = i; k >= 1; k--)
                System.out.print((k >= 10) ? +k : "  " + k);
            for (int k = 2; k <= i; k++)
                System.out.print((k >= 10) ? +k : "  " + k);
            System.out.println();
        }
    }
} 
```

谁能帮我理解这一点？这里'我已经弄清楚了：- 外循环递增到 7，同时内部 j 循环递增到 x - i，对于外循环的第一次迭代，它是 6，然后是 5 ...等等。 . 所以基本上金字塔的左边只是一个倒三角形的空白。

我无法弄清楚其他两个嵌套循环中发生了什么以及打印语句中看起来很奇怪的 if - else 部分。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-09-04T17:41:21.797

由于任务看起来很复杂，实际上很容易。一开始可能看起来很难。因为您考虑的是最终结果，而不是引导结果的路线。

要改变这一点，我们可以使用旧的编码规则，[分而](http://en.wikipedia.org/wiki/Divide_and_conquer_algorithm)治之。这种方法教会我们，在复杂问题中找到相似之处，可以将主要问题简化为我们能够执行的简单任务。换句话说，我们将我们的大问题分成几个更小的问题，这可以很容易地解决，最后我们将小结果组合成一个大问题。

所以不要从你的问题开始。

Q1：如何打印数字金字塔？

由于我们不知道，让我们专注于其他事情。

为了改善我们的观察，我们可以添加一些背景细节

```
 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7
0 _ _ _ _ _ _ _ _ 9 _ _ _ _ _ _ _ _
1 _ _ _ _ _ _ _ 8 9 8 _ _ _ _ _ _ _
2 _ _ _ _ _ _ 7 8 9 8 7 _ _ _ _ _ _
3 _ _ _ _ _ 6 7 8 9 8 7 6 _ _ _ _ _
4 _ _ _ _ 5 6 7 8 9 8 7 6 5 _ _ _ _
5 _ _ _ 4 5 6 7 8 9 8 7 6 5 4 _ _ _
6 _ _ 3 4 5 6 7 8 9 8 7 6 5 4 3 _ _
7 _ 2 3 4 5 6 7 8 9 8 7 6 5 4 3 2 _
8 1 2 3 4 5 6 7 8 9 8 7 6 5 4 3 2 1 
```

现在是观察的时候了。

从那个观察我们可以想出以下想法。

想法：金字塔是两个三角形的结构。

结论：写出那个金字塔的一半比较容易。因此，让我们重新表述酸问题。

Q2：如何写出一个三角形的序号？

这真的很简单，我们只需要两个循环，第一个循环负责列，另一个循环负责行。

```
for (int column = 1; column <= 9; column++) {
    for (int row = 1; row <= 9; row++) {
        // Observe what will happen if
        // we use == or <= or > or <>
        if (column ## row) {
            System.out.print(row);
        } else {
            System.out.print(" ");
        }
    }
    System.out.println(' ');
} 
```

当您完成第一个任务时，您将能够在屏幕上打印正方形、三角形、数字行。

所以当我们知道如何打印这样的三角形时：

```
 r
c    1 2 3 4 5 6 7 8 9 
   1 _ _ _ _ _ _ _ _ 9 
   2 _ _ _ _ _ _ _ 8 9 
   3 _ _ _ _ _ _ 7 8 9 
   4 _ _ _ _ _ 6 7 8 9 
   5 _ _ _ _ 5 6 7 8 9 
   6 _ _ _ 4 5 6 7 8 9 
   7 _ _ 3 4 5 6 7 8 9 
   8 _ 2 3 4 5 6 7 8 9 
   9 1 2 3 4 5 6 7 8 9 
```

我们应该修改您的代码，使其更合适，通常计算机世界中的操作从零开始，而不是从一开始。

```
 r
c    0 1 2 3 4 5 6 7 8  
   0 _ _ _ _ _ _ _ _ 9 
   1 _ _ _ _ _ _ _ 8 9 
   2 _ _ _ _ _ _ 7 8 9 
   3 _ _ _ _ _ 6 7 8 9 
   4 _ _ _ _ 5 6 7 8 9 
   5 _ _ _ 4 5 6 7 8 9 
   6 _ _ 3 4 5 6 7 8 9 
   7 _ 2 3 4 5 6 7 8 9 
   8 1 2 3 4 5 6 7 8 9 
```

当您成功时，我们会暂时停下来思考。

为什么我们必须为每一行重复所有这些操作？如果我们可以将值放在某个地方，我们就不必再思考和计算它们，只需专注于将整个结果写入屏幕即可。

这个问题的解决方案是数组和被称为[动态规划](http://en.wikipedia.org/wiki/Dynamic_programming)的方法概念。在这种方法中，我们尝试在某处记住将用于未来操作的东西。

因此，作为蠕虫，我们只需将数字分配给数组而不是打印它们。

```
[ ] [ ] [ ] [ ] [ ] [ ] [ ] [ ] [9]
[ ] [ ] [ ] [ ] [ ] [ ] [ ] [8] [9]
[ ] [ ] [ ] [ ] [ ] [ ] [7] [8] [9]
[ ] [ ] [ ] [ ] [ ] [6] [7] [8] [9]
[ ] [ ] [ ] [ ] [5] [6] [7] [8] [9]
[ ] [ ] [ ] [4] [5] [6] [7] [8] [9]
[ ] [ ] [3] [4] [5] [6] [7] [8] [9]
[ ] [2] [3] [4] [5] [6] [7] [8] [9]
[1] [2] [3] [4] [5] [6] [7] [8] [9] 
```

你应该想出这样的代码

```
int[] array = new int[9];

for (int column = array.length; column > 0; column--) {
    for (int row = 0; row <= array.length; row++) {
        if (column == row) {
            array[row - 1] = column;
        }
    }
    System.out.println(Arrays.toString(array));
} 
```

因此，从该代码中可以清楚地看出，我们为每个步骤使用只设置一个值。如下所示

```
9  [ ] [ ] [ ] [ ] [ ] [ ] [ ] [ ] [9] - Step one we put nine
8  [ ] [ ] [ ] [ ] [ ] [ ] [ ] [8] [ ] - Step two we put eight
7  [ ] [ ] [ ] [ ] [ ] [ ] [7] [ ] [ ]
6  [ ] [ ] [ ] [ ] [ ] [6] [ ] [ ] [ ]
5  [ ] [ ] [ ] [ ] [5] [ ] [ ] [ ] [ ]
4  [ ] [ ] [ ] [4] [ ] [ ] [ ] [ ] [ ]
3  [ ] [ ] [3] [ ] [ ] [ ] [ ] [ ] [ ]
2  [ ] [2] [ ] [ ] [ ] [ ] [ ] [ ] [ ]
1  [1] [ ] [ ] [ ] [ ] [ ] [ ] [ ] [ ] 
```

九步之后，我们将用数字填充整个数组。

我们仍然缺少的是屏幕上的结果。为此，我们应该在每个步骤中打印整个数组。首先，我们应该从左到右打印它，然后从前端打印到开头。

做魔术的代码应该是这样的

```
public static void pyramide(int levels) {
    int[] tab = new int[levels];
    for (int row = tab.length; row > 0; row--) {
        tab[row - 1] = row;
        //Print left
        for (int i = 0; i < tab.length; i++) {
            if (tab[i] != 0) {
                System.out.print(tab[i]);
            } else {
                System.out.print(' ');
            }
        }
        //Print right
        for (int i = tab.length - 2; i >= row - 1; i--) {
            if (tab[i] != 0) {
                System.out.print(tab[i]);
            }
        }
        System.out.println("");
    }
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-09-04T14:46:58.227

让我们一步一步来。正如您已经知道的那样，x 是一个表示金字塔高度的变量。

然后，正如您也正确发现的那样，第一个循环创建当前数字行的缩进

第二个循环现在将写入数字的左半部分，但如果我做对了，它将从最高数字开始并递减，然后第三个循环将再次增加数字，创建一个与您的金字塔略有不同的金字塔'正在寻找。

现在，看起来很奇怪的 if-else 部分，正如您所说的那样，是三元条件运算符，它们在此代码中实现的唯一目的是在金字塔包含数字 >= 10 时通过省略数字的前导空格。:)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-09-04T14:57:09.440

这是家庭作业。自己做会学到更多，而不是盲目抄袭别人的作品。

从一个类似但更简单的问题开始：

```
 *
   ***
  *****
 ******* 
```

你能打印那个三角形吗？编写您自己的代码，并测试它是否正常工作。

现在修改您的代码以打印数字而不是星号：

```
 1
   123
  12345
 1234567 
```

你能打印那个三角形吗？编写您自己的代码，并测试它是否正常工作。

现在再次修改您的代码以解决最终问题。通过首先解决类似但更容易的问题来解决难题通常更容易。通过重用代码，您可以从一个简单问题的解决方案构建到一个更复杂问题的解决方案。

一定要结合你找到的代码中的想法和技术，但不要盲目地复制它。使用他们代码中的优点编写您*自己的代码。*

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-04T15:31:08.303

开始了

```
public class Pyramid {
    public static void main(String[] args) {
        int[] arry = new int[10];
        for (int i = 1; i <= 9; i++)
            arry[i] = i;
        int index = 0;
        for (int i = 9; i > 0; i--) {
            int loop = 1, tempLoop = 0;

            for (int k = 0; k < 9; k++) {
                if (k < (9 - index))
                    System.out.print(" ");
                else
                    System.out.print(arry[k] + " ");
            }

            for (int k = 9; k >= i && (tempLoop++) <= index; k--) {
                System.out.print(arry[k] + " ");
            }
            index++;
            System.out.println();
        }
    }
} 
```

输出：

```
 9 
        8 9 8 
       7 8 9 8 7 
      6 7 8 9 8 7 6 
     5 6 7 8 9 8 7 6 5 
    4 5 6 7 8 9 8 7 6 5 4 
   3 4 5 6 7 8 9 8 7 6 5 4 3 
  2 3 4 5 6 7 8 9 8 7 6 5 4 3 2 
 1 2 3 4 5 6 7 8 9 8 7 6 5 4 3 2 1 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-09T19:57:43.617

在其他两个嵌套循环中：

```
for (int k = i; k >= 1; k--)
System.out.print((k >= 10) ?+ k : "  " + k);

for (int k = 2; k <=i; k++)
System.out.print((k >= 10) ?+ k : "  " + k); 
```

如果条件`k>=10`为真，则 k 的值将不带空格地显示。如果为假，则将 k 的值带空格地显示。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-01-29T09:10:24.763

```
public class PrintInterviewPyramid {
    public static void main(String[] args) {
        int n = 8;
        for (int i = 1; i < n; i = i + 2) {
            for (int j = 1; j < i + 1; j++) {
                System.out.println(" " + j);
            }
        }
        System.out.println("");
    }
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-07-10T05:52:48.763

```
for (int i = length - 1; i >= 1; i--) {
    String front = "";
    String back = "";
    int space = (length - i) - 1;
    while (space >= 0) {
        System.out.print(" ");
        space--;
    }
    for (int j = i; j != 0; j--) {
        front = j + front;
        if (j != i) {
            back = back + j;
        }
    }
    System.out.println(front + back);
} 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2015-06-14T01:03:21.407

想想两种模式。

第一个图案，左右打印。

第二个 Pattern ，打印每一行并检查打印起点的间隙。

```
public class NumberPyramid {
    public static void main(String[] args) {
        int part = 2;
        int stage = 5; // set tree stage.
        if (part == 2) {
            int cnt = 0;
            // thinking two part.
            for (int i = stage; i > 0; i--) {
                for (int j = 1; j <= stage; j++) {
                    if (stage - j <= cnt) {
                        System.out.print(j + " ");
                    } else {
                        System.out.print("  ");
                    }
                }
                for (int k = stage; k > 0; k--) {
                    if (k != stage) {
                        if (stage - cnt <= k) {
                            System.out.print(k + " ");
                        } else {
                            System.out.print("  ");
                        }
                    }
                }
                System.out.println("");
                cnt++;
            }
        } else if (part == 1) {// think whole lines.
            int gap = 0;
            for (int j = 0; j < stage; j++) {
                for (int i = 1; i <= stage * 2; i++) {
                    if (Math.abs(i - stage) <= gap) {
                        System.out.print(stage - gap + " ");
                    } else
                        System.out.print("  ");
                }
                System.out.println("");
                gap++;
            }
        }
    }
} 
```

输出：

```
 5         
      4 5 4       
    3 4 5 4 3     
  2 3 4 5 4 3 2   
1 2 3 4 5 4 3 2 1 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2016-03-28T19:46:12.920

将此视为面试的潜在问题，并想尝试使用 Java 8 的流方法来实现它。解决方案如下：

```
import java.util.ArrayList;
import java.util.List;
import java.util.stream.IntStream;

public class App {
    public static void main(String[] args) {
        int min = 1;
        int max = 9;
        List<List<String>> pyramid = new ArrayList<>();
        IntStream.iterate(max, i -> i - 1).limit(max)
            .forEach(s -> {
                List<String> pyramidRow = new ArrayList<>();
                IntStream.rangeClosed(min, max)
                    .forEach(j -> {
                        if (j < s) pyramidRow.add(" ");
                        else pyramidRow.add(String.valueOf(j));
                    });
                IntStream.iterate(max - 1, i -> i - 1).limit(max - 1)
                    .forEach(j -> {
                        if (j < s) pyramidRow.add(" ");
                        else pyramidRow.add(String.valueOf(j));
                    });
                pyramid.add(pyramidRow);
            });
        pyramid.stream()
            .forEach(pyra -> {
                pyra.forEach(System.out::print);
                System.out.println();
            });
    }
} 
```

输出：

```
 9        
       898       
      78987      
     6789876     
    567898765    
   45678987654   
  3456789876543  
 234567898765432 
12345678987654321 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2021-07-13T05:00:18.767

想象一个以上中点为原点的坐标平面：

```
class CoordinatePlane {
    public static void main(String[] args) {
        int n = 8;
        // vertical axis
        for (int i = 0; i <= n; i++) {
            // horizontal axis
            for (int j = 1 - n; j <= n - 1; j++)
                // print axes, otherwise whitespaces
                System.out.printf("%2s", i == 0 ? j : j == 0 ? i : "");
            // print a new line
            System.out.println();
        }
    }
} 
```

坐标平面：

```
-7-6-5-4-3-2-1 0 1 2 3 4 5 6 7
               1              
               2              
               3              
               4              
               5              
               6              
               7              
               8 
```

稍作修改，您将得到一个数字金字塔：

```
class Pyramid {
    public static void main(String[] args) {
        int n = 8;
        // vertical axis
        for (int i = 1; i <= n; i++) {
            // horizontal axis
            for (int j = 1 - n; j <= n - 1; j++) {
                // absolute value - the distance from the zero point
                int jAbs = Math.abs(j);
                // print numbers, otherwise whitespaces
                System.out.printf("%2s", jAbs < i ? n - jAbs : "");
            }
            // print a new line
            System.out.println();
        }
    }
} 
```

数字金字塔：

```
 8              
             7 8 7            
           6 7 8 7 6          
         5 6 7 8 7 6 5        
       4 5 6 7 8 7 6 5 4      
     3 4 5 6 7 8 7 6 5 4 3    
   2 3 4 5 6 7 8 7 6 5 4 3 2  
 1 2 3 4 5 6 7 8 7 6 5 4 3 2 1 
```

* * *

^(另请参阅：[如何获得以下格式化输出？](https://stackoverflow.com/a/66301854/16436544))

# android - 如何在 .NET 上序列化并在 WP、Win8、iOS 和 Android 上反序列化并保留引用

> ID：12265857
> 
> 赞同：1
> 
> 时间：2012-09-04T14:40:03.420
> 
> 标签：android, ios, serialization, odata, windows-phone

TL;博士; 是否有一个库或协议允许我从 .NET 应用程序序列化一些数据并在 WP、Win8、iOS 和 Android 上反序列化，同时保留对象之间的引用，就像它们在代码中一样，即如果单个实例 X 是 Y 的成员并且Z 当 Y 和 Z 被反序列化时，应该只有一个 X 对象。

详细版本：

我希望能够序列化 A 和 B 类型的一些对象，其中 A 具有 B 类型的成员，而 B 的一个实例可以是 A 的许多实例的成员。我应该能够在 WP、Win8、iOS 和反序列化数据时应保持与Android相同的关系。遗憾的是，我现在无法在 Android 和 iOS 上进行测试。

序列化机制的要求

*   反序列化时保留对象引用
*   序列化的开销并不重要，因为设备将获得新数据，例如每三个月一次
*   虽然开销并不重要，但重要的是对同一对象的引用不要序列化一次，因为这可能会导致非常大的序列化数据。
*   能够使用 .NET 进行序列化。不需要在其他平台上进行序列化。
*   能够在 WP、Win8、iOS、Android 上反序列化

```
 [DataContract(IsReference = true)]
public class A
{
    [DataMember]
    public string Name { get; set; }
    [DataMember]
    public B MemberB { get; set; }
}

[DataContract(IsReference = true)]
public class B
{
    [DataMember]
    public string Name { get; set; }
} 
```

示例对象图：

```
 var b1 = new B { Name = "B1" };
var aa = new List { new A { MemberB = b1, Name = "A1" }, new A { MemberB = b1, Name = "A2" } }; 
```

我尝试使用 DataContract 序列化并将 IsReference = true 添加到 DataContract 属性。这就像桌面 .NET 和 WP 之间的一种魅力，我认为它可以在 Windows 8 上运行，但我什至找不到在 iOS 和 Android 上反序列化 DataContractSerialization 的方法，而无需编写自己的反序列化器，更不用说开箱即用的支持保留引用了. 如果有一个库可以在 iOS 和 Android 上提供反序列化而无需额外的努力，那么 DataContract 序列化对我来说将是完美的。

我还尝试了 OData 服务。OData 具有适用于 iOS 和 Android 的[客户端库](http://www.odata.org/libraries)，但它是否按预期工作。似乎实体引用上是否有 PK 将被保留。我在 WP 和 .NET 控制台应用程序上进行了测试，如下所示：

```
DemoService service = new DemoService(new Uri("http://services.odata.org/OData/OData.svc/"));
var productsQuery = (DataServiceQuery<Product>)
                    (from p in service.Products.Expand("Category")
                     where p.Category.ID == 1
                     select p);

productsQuery.BeginExecute(
    (result) =>
        {
            var actualProducts = productsQuery.EndExecute(result).ToList();
            System.Diagnostics.Debug.WriteLine(actualProducts[2].Category == actualProducts[4].Category); //outputs true because both categories are the same
        },
    null); 
```

它似乎有效，但我是否正确地进行了测试，它是否适用于 iOS 和 Android 客户端？我想避免使用 OData，因为它对我的情况来说似乎太重了。

我意识到我可以给每个对象一个 ID，并且只使用 ID 来建模对象图，但我希望有一个更清洁的解决方案。我还想避免编写自己的序列化代码。

子问题：

1.  有没有办法在 iOS 和 Android 上反序列化 DataContract 序列化而不编写我自己的反序列化器
2.  iOS 和 Android 的 OData 客户端是否保留对象引用？他们容易相处吗
3.  iOS 版 Mono 和 Android 版 Mono 是否支持 DataContract 反序列化，同时保留对象引用？

谢谢你的时间。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-04T14:44:39.533

我会使用谷歌的[协议缓冲区](http://code.google.com/p/protobuf/)。其他语言还有其他实现，包括 Objective C 和 C#。

**更新：**

如果我这样做，我会开始在所有地方使用 .NET，包括在 Android 上（通过使用 MonoDroid）和（在 iOS 上使用 MonoTouch）。是的，您现在可以在任何平台上共享 C# 代码！

我希望序列化的每个对象都有一个定义为 Protocol-Buffer 对象的等效对象。每个对象都有一个序列化的哈希值作为它的 ID。对象中的每个引用都将被定义为一个哈希值。

然后，您在每个对象中都有一些代码来遍历它下面的对象，并在您进行时序列化到协议缓冲区对象。填充哈希值引用。

如果不存在，每个对象引用都会被查找并存储在对象的字典（哈希值/地址）中。这也是序列化的。这会阻止您对对象进行两次序列化，因为该对象在整个操作中仅被序列化/反序列化一次。这是通过设置/清除字典中对象的地址来完成的。

在这没什么大不了之前，我已经写了这些东西。

# sql - 如何在 SQL Server 中的现有行上执行新的插入/更新触发器？

> ID：12265858
> 
> 赞同：0
> 
> 时间：2012-09-04T14:40:10.253
> 
> 标签：sql, sql-server, triggers

我已经向已经有一些行的表添加了插入/更新触发器。在现有行上执行新的插入/更新触发器的最干净的方法是什么？

（肮脏的想法是修改某些列并在事务中将其还原。或者临时添加一列以更改其数据。）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-04T14:41:44.980

运行类似于触发器中的内容的更新语句，但不加入`inserted`. 如果您在触发器中显示代码，我们可以更具体地为您提供帮助。

此外，如果您能解释为什么无更新更新仍不会触发触发器，那就太好了。如果您当前检查值的实际变化，您总是可以暂时更改触发器以不打扰进行该检查。

# php - Facebook API：getUser() 总是返回 0

> ID：12265859
> 
> 赞同：0
> 
> 时间：2012-09-04T14:40:13.063
> 
> 标签：php, facebook, api

这是我的代码：

```
<html>
    <head>
    <body>
        <?php
        require_once 'facebook-php-sdk/src/facebook.php';

        $appapikey = '453976824647366';
        $appsecret = 'fe86f3b0b34b3ed6eb39bbce717b8062';

        $facebook = new Facebook($appapikey, $appsecret);

        $user_id = $facebook->getUser();
        echo $user_id;

        echo "<p>Hello <fb:name uid=\"$user_id\" useyou=\"false\" linked=\"false\" firstnameonly=\"true\"></fb:name>";
        ?>

    </body>

</head>
</html> 
```

一些很简单的事情，但我无法找到为什么 getUser 总是返回 0 我会很感激你的帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-04T14:43:38.173

用户必须先登录。

用户登录（使用 Facebook 登录您的网站）后，将显示他的 ID。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-04T14:49:58.673

我相信 a) 构造函数需要一个包含应用程序 ID 和密钥的数组，并且 b) 您需要先让用户登录。

如果您在 GitHub 上查看 Facebook PHP SDK 的页面，您会在调用后注意到`$facebook->getUser();`他们有一个关于进行 API 调用的部分，以及另一个关于生成登录或注销 URL 的部分，具体取决于用户是否登录或不是。

流程是这样的：

1.  检查会话中是否有用户
2.  尝试获取用户详细信息
3.  如果没有用户，则重定向到登录 URL

当用户回到您的应用程序时，用户将处于会话状态。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-04T15:45:16.517

首先要检查的是

```
require_once 'facebook-php-sdk/src/facebook.php'; 
```

确保它与您的 php 代码所在的位置有关，而不是与服务器结构有关。

为了测试这段代码，我可能只使用 Facebook sdk 提供的现有示例，这样您首先可以自信地知道它确实有效，然后可以根据您的需要对其进行调整。只是从这个链接粘贴它 [https://github.com/facebook/facebook-php-sdk/blob/master/examples/example.php](https://github.com/facebook/facebook-php-sdk/blob/master/examples/example.php)

```
<?php
/**
 * Copyright 2011 Facebook, Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License"); you may
 * not use this file except in compliance with the License. You may obtain
 * a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS, WITHOUT
 * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the
 * License for the specific language governing permissions and limitations
 * under the License.
 */

require '../src/facebook.php';

// Create our Application instance (replace this with your appId and secret).
$facebook = new Facebook(array(
  'appId'  => '344617158898614',
  'secret' => '6dc8ac871858b34798bc2488200e503d',
));

// Get User ID
$user = $facebook->getUser();

// We may or may not have this data based on whether the user is logged in.
//
// If we have a $user id here, it means we know the user is logged into
// Facebook, but we don't know if the access token is valid. An access
// token is invalid if the user logged out of Facebook.

if ($user) {
  try {
    // Proceed knowing you have a logged in user who's authenticated.
    $user_profile = $facebook->api('/me');
  } catch (FacebookApiException $e) {
    error_log($e);
    $user = null;
  }
}

// Login or logout url will be needed depending on current user state.
if ($user) {
  $logoutUrl = $facebook->getLogoutUrl();
} else {
  $loginUrl = $facebook->getLoginUrl();
}

// This call will always work since we are fetching public data.
$naitik = $facebook->api('/naitik');

?>
<!doctype html>
<html xmlns:fb="http://www.facebook.com/2008/fbml">
  <head>
    <title>php-sdk</title>
    <style>
      body {
        font-family: 'Lucida Grande', Verdana, Arial, sans-serif;
      }
      h1 a {
        text-decoration: none;
        color: #3b5998;
      }
      h1 a:hover {
        text-decoration: underline;
      }
    </style>
  </head>
  <body>
    <h1>php-sdk</h1>

    <?php if ($user): ?>
      <a href="<?php echo $logoutUrl; ?>">Logout</a>
    <?php else: ?>
      <div>
        Login using OAuth 2.0 handled by the PHP SDK:
        <a href="<?php echo $loginUrl; ?>">Login with Facebook</a>
      </div>
    <?php endif ?>

    <h3>PHP Session</h3>
    <pre><?php print_r($_SESSION); ?></pre>

    <?php if ($user): ?>
      <h3>You</h3>
      <img src="https://graph.facebook.com/<?php echo $user; ?>/picture">

      <h3>Your User Object (/me)</h3>
      <pre><?php print_r($user_profile); ?></pre>
    <?php else: ?>
      <strong><em>You are not Connected.</em></strong>
    <?php endif ?>

    <h3>Public profile of Naitik</h3>
    <img src="https://graph.facebook.com/naitik/picture">
    <?php echo $naitik['name']; ?>
  </body>
</html> 
```

# php - 如何制作我自己的 facebook 课程

> ID：12265864
> 
> 赞同：0
> 
> 时间：2012-09-04T14:40:21.327
> 
> 标签：php, facebook, class

我想创建自己的课程，以使我的代码有用且简单。我想替换（例如）

```
$facebook->api('/me'); 
```

到

```
$myclass->me(); 
```

例如，在墙上张贴我需要写

```
$facebook->api('/me/feed','post',$atch); 
```

我想成功

```
$myclass->msg($msg); 
```

我如何使用 facebook 类创建自己的类（并且我使用另一个 DB 类）

谢谢你暂停

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-04T14:43:16.910

**选项 #1** - 快速、简单、常见的 OOP 实践

```
class myFacebook extends facebook {
  public function me() {
    return $this->api('/me');
  }
  public function msg($msg) {
    return $this->api('/me/feed','post',$msg);
  }
} 
```

**选项#2（替代）** - 更易于维护，不会与基类属性冲突，易于扩展。这就像 API 的 API :)

```
class myFacebook {
  public $api;
  public function __construct() {
    $this->api = new facebook(); // your base class
  }
  public function me() {
    return $this->api->api('/me');
  }
  public function msg($msg) {
    return $this->api->api('/me/feed','post',$msg);
  }
  public function api() {
    // more difficult to declare that function in #1 option
  }
} 
```

当您的类使用大量关键字并且可能与基础 API 类发生冲突时，第二个选项会更好。更易于维护，更易于扩展。

* * *

**我曾经使用过许多 API（ebay、paypal、amazon、fb 等）。** 我通常创建 2-3 个类：

1.  第一个只是发送和下载数据。例如带有缓存的 SOAP 类。
2.  第二类是创建适当的请求，并使用 1\. 类。
3.  最简化的一个（就像你的一样） - 只需简单快捷地请求类（这是你的基类）

我知道使用`extend`是最常见的做法，但我个人更喜欢选项#2。

# android - JSONObject.getString() 返回 nulll

> ID：12265873
> 
> 赞同：0
> 
> 时间：2012-09-04T14:40:56.387
> 
> 标签：android

我有一个 JSONObject 并具有如下值：

```
{
    "Success": true,
    "City": {
        "1": "noida",
        "2": "Delhi",
        "3": "Kanpur",
        "4": "Gurgaon",
        "5": "Mumbai",
        "7": "Noida",
        "8": "NEWYORK",
        "9": "Patna"
    }
} 
```

我对每个值都有一个键值，但键“6”没有值。所以它返回“No value for 6”异常。我试图通过使用此代码来删除它，但失败了......请记住，城市将以字符串 [] 的形式在微调器中呈现。

代码如下：

```
JSONObject jsonCities = jsonObject.getJSONObject("City");
                        int len = jsonCities.length();
                        Log.i("Length of jsonCities is :", ""+len);
                        for(int i=1;i<=len;i++)
                        {    
                            if(jsonCities.get(""+i)==null)
                        {
                                Log.i("NULL VALUE", "NULL VALUE");
                                continue;
                        }
                            else
                        {
                            Log.i("Cities :",""+jsonCities.getString(""+i));
                            cities_hashmap.put(""+i, ""+jsonCities.getString(""+i));
                            Log.i("cities_hashmap", ""+cities_hashmap);
                        }

                    }

                    cities = new String[cities_hashmap.size()];

                    for(int j=1;j<=cities_hashmap.size();j++)
                    {
                        Log.i("CITY IS :", cities_hashmap.get(""+j));

                        cities[j-1] = cities_hashmap.get(""+j);
                        Log.i("City Array in String form is :", ""+cities);

                    }

context.runOnUiThread(new Runnable() {

                            public void run() {
                                // TODO Auto-generated method stub

                                ArrayAdapter<String> adapter = new ArrayAdapter<String>(Registration.this, android.R.layout.simple_spinner_item, cities);
                                country.setAdapter(adapter);

                            }
                        }); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-04T14:46:01.733

像这样使用：

```
String value = jsonCities.getString(Integer.toString(i)); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-04T14:50:40.330

您可以使用 JsonObject 的 has() 方法找到密钥是否可用，如果找到密钥则返回 true，否则返回 false。

```
if(jsonCities.has(""+i)){
   // do the thing
} 
```

从此链接检查更多方法

[http://www.json.org/javadoc/org/json/JSONObject.html](http://www.json.org/javadoc/org/json/JSONObject.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-04T14:57:59.253

跳过**6**作为

```
 for(int i=1;i<=len;i++)
    {    
          if(i == 6 )
          {
               i += 1;
          }
          if(jsonCities.get(""+i)==null)
          {
               Log.i("NULL VALUE", "NULL VALUE");
               continue;
          }
          else
          {
               Log.i("Cities :",""+jsonCities.getString(""+i));
               cities_hashmap.put(""+i, ""+jsonCities.getString(""+i));
               Log.i("cities_hashmap", ""+cities_hashmap);
          }
          ...
          ... 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-04T14:58:02.020

您可以更改此“for”循环

```
for(int i=1;i<=len;i++) 
```

和

```
Iterator it = jsonCities.keys();
while(it.hasNext())
{
    String key = it.next().toString();
    ...
} 
```

# android - 生命周期配置未涵盖插件执行：com.jayway.maven.plugins.android.generation2

> ID：12265878
> 
> 赞同：1
> 
> 时间：2012-09-04T14:41:08.817
> 
> 标签：android, maven

我遇到以下错误：

生命周期配置未涵盖插件执行：com.jayway.maven.plugins.android.generation2:android-maven-plugin:3.3.0:generate-sources（执行：default-generate-sources，阶段：generate-sources）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-05T06:56:39.863

我重新安装了 STS，该错误消失了。

# php - PHP：检查进程是否使用 pid 运行

> ID：12265882
> 
> 赞同：0
> 
> 时间：2012-09-04T14:41:13.990
> 
> 标签：php, linux

我想用 php 验证一个进程，比如“gedit”，是否正在 Linux 上运行。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-04T14:51:44.027

如果您的系统没有`pidof`您可以使用`ps aux | grep gedit`which 如果它返回多于一行的输出，则意味着您有一个活动进程。我说不止一行，因为您总是会看到`ps aux | grep gedit`流程本身的一行输出。请注意，如果您需要正则表达式类型的搜索执行过程，这也可能更有用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-04T14:41:13.990

使用`pidof gedit`并检查返回的 Array 的第一个值是否为整数：

```
exec("pidof gedit",$response);
if (is_numeric($response[0])){
    echo $response[0];
} 
else {
    echo "no response";
} 
```

# android - 在 Android 中，如何使用已知比例的权重垂直缩放布局？

> ID：12265886
> 
> 赞同：1
> 
> 时间：2012-09-04T14:41:16.287
> 
> 标签：android, xml, layout, android-linearlayout

我有一个 320x480 的现有图像，并设置为 LinearLayout 的背景属性。我知道对于不同的设备，这将垂直/水平不均匀地拉伸，但这是可以接受的。

图像分为 3 个部分，页眉、按钮网格和页脚。页眉为 184 像素，网格为 240 像素，页脚为 56 像素。

如果我将父 LinearLayout 的 weightSum 属性设置为 480，然后将每个部分的 layout_weight 属性设置为适当的像素量，则布局非常不对齐。

所有部分的宽度都为“fill_parent”，高度为“0dp”，并且顶级 LinearLayout 的 3 个子项中的任何一个都没有填充或边距属性。

理想情况下，宽度将始终延伸到整个屏幕，高度将按比例缩放，以便按钮与背景中的网格对齐。

我无法将背景图像（否则我会）重新切成多块。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-04T16:54:32.537

找出问题所在：IntelliJ（可能是 Eclipse）中的预览器显示的内容与真实设备显示的内容不同。事实证明，我的策略一直运行良好 - 预览器在这个特定策略上做得并不好。

# javascript - 用于访问下一个 html 页面的静态 4 位密码

> ID：12265890
> 
> 赞同：0
> 
> 时间：2012-09-04T14:41:26.837
> 
> 标签：javascript, jquery, ios, html, cordova

我搜索了谷歌，试图找到一个做过我想做的事情但似乎找不到任何东西的人，我想也许我只是没有以正确的方式说明我想要的东西。

无论如何...

我有一个使用 PhoneGap 创建的 iPad 应用程序，它是一个简单的离线表单应用程序，它由三个 html 页面组成。我想要实现的是从第 2 页到第 3 页，假设用户在单击下一页锚标记按钮时需要输入一个 4 位数的代码，如果他们得到不正确的代码，所有发生的事情就是它没有移动到下一页，如果他们理解正确，他们会继续到下一页，就这么简单。只有一个正确的代码，例如用户没有注册并且有用户名和密码。

我很高兴使用 html5、javascript、jquery。

任何想法，如果这是可能的，我会怎么做？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-04T14:43:58.013

我知道注意 iPad 开发或 phonegap，但你不能这样做：

```
<script>
    if(prompt("What is the number?") == "1234") { // Prompt for a number, check if its correct
        window.location.href = "/thenextpage.html"; // redirect them if it is
    }
</script> 
```

或者：

```
<form name="myform" action="newpage.html"><input name="number"/></form>
<script>
    jQuery('[name=myform]').submit(
        function(evt) {
            // get the number from the form
            var numberVal = jQuery(evt.target).find('[name=number]').val();

            // Check the number's correct
            if(numberVal != "1234") {
                evt.preventDefault(); // Stop the form submitting
            }
        }
    );
</script> 
```

抱歉，如果我误解了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-04T14:46:18.973

您可以使用 jQuery 并添加输入文本（或密码）来执行此类操作。

```
var code = "1234";

$('a').click(function(e) {
    if($('input[type="text"]').val() != code) {
        e.preventDefault();
    }
}); 
```

# asp.net-mvc - 在 ASP.NET MVC 3 中更新模型

> ID：12265891
> 
> 赞同：0
> 
> 时间：2012-09-04T14:41:31.000
> 
> 标签：asp.net-mvc, asp.net-mvc-3, entity-framework, razor, asp.net-mvc-3-areas

在使用 Web 表单将近 6 年之后，我在尝试扩展我的 asp.net 知识时，我是 MVC 的新手。

到目前为止，MVC 对我来说真的很抽象，但我喜欢的是使用的干净编码。我正在阅读“Pro ASP.NET MVC 3 Framework”一书，现在我陷入了困境，我不知道如何诚实地继续下去。

这是我得到的错误：

> 自数据库创建以来，支持“EfDbContext”上下文的模型已更改。考虑使用 Code First 迁移来更新数据库。

这发生在我尝试更新一个产品之后。该页面已发回，但数据库中没有任何更新。

浏览网页我找到了这个临时解决方案，将这一行放在 global.asax 文件中解决了这个问题：`Database.SetInitializer<SportsStore.Domain.Concrete.EFDbContext>(null);` 但现在出现了空白页面，而不是充满数据的页面。

我想知道如何才能继续前进，我需要做些什么来解决这个问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-04T14:48:08.883

网上有很多解释迁移的博客和文章，我会使用以下两个链接作为参考。简而言之，您更改了模型，但数据库中的表尚未更新。您可以删除数据库中的表，并允许 EF 重新创建它们，撤消对模型的更改，或者（仅限 MVC 4？）运行“迁移”，这或多或少是一种奇特的说法，即允许 EF创建一个 SQL 脚本来更新您的 SQL 表以匹配您的模型的当前版本。

[http://blogs.msdn.com/b/adonet/archive/2012/02/09/ef-4-3-code-based-migrations-walkthrough.aspx](http://blogs.msdn.com/b/adonet/archive/2012/02/09/ef-4-3-code-based-migrations-walkthrough.aspx)

[http://coding.abel.nu/2012/03/ef-migrations-command-reference/](http://coding.abel.nu/2012/03/ef-migrations-command-reference/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-04T14:50:03.280

首先使用代码，数据库有一个校验和表来跟踪您的类（称为`EdmMetaData`）的更改，并且您的错误表明 Entity Framework 已检测到此类更改。如果您想手动处理它，请删除提到的表，并手动更新数据库以符合类规范。

正如您提到的，另一种方法是让框架删除并重新创建更改的表。

有关详细说明和演示，请参阅[Pluralsight 视频教程](http://pluralsight.com/training/Courses/TableOfContents?courseName=aspdotnet-mvc3-intro)中的第 4 章。

# javascript - JavaScript 检查值

> ID：12265897
> 
> 赞同：2
> 
> 时间：2012-09-04T14:41:52.233
> 
> 标签：javascript

```
var it = doc.findItem('toy_total');
it.value = parseFloat(total_due) + parseFloat(sales_tax);
fixMoney(it); 
```

我正在尝试添加total_due + sales_tax，我可以毫无问题地做到这一点，但有时没有销售税，当它出现时我得到一个NaN。我不确定如何检查空值有人可以展示如何做到这一点吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-04T14:44:12.483

尝试：

```
it.value = (+total_due) + (+sales_tax); 
```

`parseFloat("")`返回 NaN，`+""`返回 0；

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-04T14:44:34.370

```
var it = doc.findItem('toy_total');
if(total_due && sales_tax){
  it.value = parseFloat(total_due) + parseFloat(sales_tax);
  fixMoney(it);
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-04T14:45:11.600

查看[IsNaN](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/isNaN)函数，应该是您需要的。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-04T14:45:56.693

```
it.value = parseFloat(total_due || 0) + parseFloat(sales_tax || 0); 
```

# python - Get random element by given priority

> ID：12265899
> 
> 赞同：2
> 
> 时间：2012-09-04T14:41:57.613
> 
> 标签：python, random

> **Possible Duplicate:**
> [Weighted random selection with and without replacement](https://stackoverflow.com/questions/352670/weighted-random-selection-with-and-without-replacement)

I tired to make all decisions what to do next by myself. I want computer to do it. I only write things and give priority to each, computer selects one by these priorities with random element.

So, I made this file (tsv):

```
3   work A
2   work B
1   work C
1   laundry
1   nothing 
```

"Work A" should happens with 38% probability. "nothing" - 13%, etc.
Computer should count all this and say to me: `do ___`

I can read it and get percents for each thing. But I cannot figure out how should I select one thing with these percents.

```
import csv

# reading
file = open('do.txt', mode='r', encoding='utf-8')
tsv_file = csv.reader(file, delimiter='\t')

# total priority
priority_total = 0
for work in tsv_file:
    priority_total = priority_total + int(work[0])

?????

print(do_this) 
```

What is the way to do this? Is there a function for random selection with given probabilities?

I really need this to stop procrastinating and start doing things.

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-04T14:45:34.743

Well, a simple approach would be to create a list of your tasks, but add each task a number of times to the list equal to its priority.

So after loading your file, the list would look like this:

```
['work A', 'work A', 'work A', 'work B', 'work B', 'work C', 'laundry', 'nothing'] 
```

and then you can use [random.choice](http://docs.python.org/library/random.html#random.choice) to select a random element.

```
task_list = []
for prio, work in tsv_file:
    task_list += [work] * int(prio)

do_this = random.choice(task_list) 
```

# iphone - 为 UIButton 设置 titleLabel

> ID：12265905
> 
> 赞同：5
> 
> 时间：2012-09-04T14:42:11.743
> 
> 标签：iphone, objective-c, uibutton, uilabel

今天我有点困惑地发现，在尝试更改`UIButton`.

```
// 001
[[[self button] titleLabel] setText:@"Peanuts"]; 
```

我想我知道为什么，但我只是想在这里确认一下我的想法。001 确实设置了 titleLabel 文本属性，但作为它的一个`UILabel`（的子视图`UIButton`）它不会导致 UI 被重绘。这会导致`UILabel`text 属性发生内部变化，但遗憾的是 UI 中没有视觉变化。

```
// 002
[[self button]setTitle:@"Peanuts" forState:UIControlStateNormal]; 
```

似乎 setTitle:forState 方法是正确的方法，它具有需要状态的额外开销，但确实会调用 UI 重绘，因为它是在`UIButton`. 我的问题是，002 是正确的方法吗，除非我做错了什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-04T14:48:58.833

你是对的。

```
[[self button]setTitle:@"Peanuts" forState:UIControlStateNormal]; 
```

是应该设置按钮标题的方式。这使您可以控制按钮在其所有不同控制状态下的外观。

从文档：

> 通常，如果未为状态指定属性，则默认使用 UIControlStateNormal 值。如果未设置 UIControlStateNormal 的值，则该属性默认为系统值。因此，您至少应该设置正常状态的值。

# visual-studio - 为什么当我关闭浏览器窗口时 Silverlight 5 不停止我的调试会话？

> ID：12265911
> 
> 赞同：1
> 
> 时间：2012-09-04T14:42:38.377
> 
> 标签：visual-studio, silverlight, debugging, silverlight-5.0

使用 Visual Studio 调试 Silverlight 3 或 4 应用程序时，当我关闭浏览器窗口时，调试会话停止。在 VS 2008、2010 和 2012 中确实如此。

使用 Silverlight 5 运行时，我的调试会话在我关闭浏览器窗口后保持打开状态，我必须明确停止调试。

我用过的 IE8 和 IE9 遇到了同样的行为。

任何人都知道这是为什么以及如何恢复到原来的行为？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-06T07:26:42.760

I run into this kinda problems all the time. Worse if IE does not clear cache and still loading old version of XAP **even if you made** a small change in code. So the solution I found it to install Fiddler2 run it with VS and everytime I start debugging (or even in the middle of debugging) I switch to Fiddler2 and press Ctrl+Shift+X (Clear cache). This action guarantee to clear cache and load IE with actual SL app that you debugging. May be there's a way to automate it but it suits me for now...

Is this was helpful for you ?

# .net - Gridview 数据源的有效选项是什么？

> ID：12265914
> 
> 赞同：1
> 
> 时间：2012-09-04T14:42:46.517
> 
> 标签：.net, gridview

我知道我可以将 Gridview 数据源设置为数据集或对象集合。还有其他选择吗？

这似乎是一个非常基本的问题，就像我应该能够去微软文档，查找“gridview / properties / datasource”，它会说，“你可以将它设置为......”和一个列表有效的数据类型。但我找不到任何这样的东西。有人可以指点我参考吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-04T14:46:04.193

DataSource 必须是以下接口之一：

*   IListSource
*   IEnumerable
*   数据源

[来源](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.databoundcontrol.validatedatasource.aspx)

# c - 宏 VA_ARGS 到 VS2010 VC

> ID：12265916
> 
> 赞同：2
> 
> 时间：2012-09-04T14:42:58.413
> 
> 标签：c, visual-studio-2010, macros, gnu

在带有 Linux 的 GNU-GCC 中，这是 `#define sprintfc(string, ...) sprintf(string+strlen(string), ##__VA_ARGS__)` 有效的。对于 Visual Studio 2010 是否有具有相同效果的定义？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-04T15:30:09.110

Microsoft Visual C 编译器[确实支持可变参数宏](http://msdn.microsoft.com/en-us/library/ms177415%28v=vs.80%29.aspx)。但是，问题在于[GCC 扩展 ##](http://gcc.gnu.org/onlinedocs/gcc-4.6.1/gcc/Variadic-Macros.html)，如果没有传递参数，它会删除前导逗号。

因为 sprintf() 永远不会在没有第二个参数的情况下被调用，所以如果你只删除##，你的代码应该可以正常工作。

# ajax - 为什么 ExtJS 向同一个域发送 OPTIONS 请求？

> ID：12265921
> 
> 赞同：8
> 
> 时间：2012-09-04T14:43:09.870
> 
> 标签：ajax, extjs, options

我正在将我的脚本加载到一个域上，并将一些数据发送到同一个域`POST`并使用`Ext.Ajax.request()`它们。

不知何故，开发工具向我展示了一个失败的`OPTIONS`请求。

```
Request URL : myurl-internal.com:8090/some/rest/api.php

Request Headers
  Access-Control-Request-Headers : origin, x-requested-with, content-type
  Access-Control-Request-Method  : POST
  Origin                         : http://myurl-internal.com:8090 
```

它既是 HTTP 又不是 HTTPS。相同的端口，相同的主机......我不知道它为什么这样做。服务器无法处理这些东西，因此请求失败，整个系统停止工作。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-09-27T05:50:16.547

它并不是 Ext JS 所特有的——在其他框架中查看[这些相关线程。](https://stackoverflow.com/search?q=options%20request)它是正确执行[CORS](http://en.wikipedia.org/wiki/Cross-origin_resource_sharing)标准的服务器：

> 对于可能对用户数据造成副作用的 HTTP 请求方法（特别是对于 GET 以外的 HTTP 方法，或者对于某些 MIME 类型的 POST 使用），规范要求浏览器“预检”请求，从带有 HTTP OPTIONS 请求标头的服务器，然后，在服务器“批准”后，使用实际的 HTTP 请求方法发送实际请求。

如果要使用 CORS，则需要能够正确处理或忽略服务器上的这些请求。Ext JS 本身并不关心 OPTIONS 请求——您将按预期收到响应，但除非您对它们执行某些操作，否则它们将被忽略（假设服务器实际上允许您尝试执行的任何操作）。

如果您不打算使用 CORS（听起来您不是故意跨域），那么您需要弄清楚为什么服务器认为原始域不同（我不确定）。您还可以通过使用 JsonP（通过 Ext 的 JsonP 代理）完全绕过 CORS。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-22T08:49:16.793

使用相对 url 而不是绝对，那么你会得到预期的结果。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2016-10-14T07:56:53.977

在请求之前使用

```
Ext.Ajax.useDefaultXhrHeader = false 
```

# delphi - 搜索表单和用途

> ID：12265926
> 
> 赞同：0
> 
> 时间：2012-09-04T14:43:22.683
> 
> 标签：delphi, delphi-xe2

我们正在创建一个组件，并希望模仿 Designer.GetComponentNames 背后的概念，在这里我们可以获取表单上可用组件的列表或使用中的任何表单。我们无法到达 GetComponentNames 的根目录。任何输入将不胜感激。

LE：实际上我收回了这一点。我从设计时方面需要这个。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-04T15:02:44.417

运行？您拥有所有显示表单的 Vcl.Forms.TScreen.Forms 数组，并且您拥有包含所有表单 IIRC 的 Vcl.Forms.Application.Components。然后，每个表单都有一个 Components 数组。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-05T04:53:32.540

如果我理解您问题的第一部分，您希望在设计时获取表单（按名称）拥有的组件列表。

作为背景，我有一个非可视组件（称为 TColorEdits。），它在运行时管理窗体上选定 TWinControls 的颜色。该组件有一个 TStrings 属性，该属性包含窗体上选定 TWinControls 的名称。可以在设计时使用包含几个列表框的对话框 (dlgEditColors) 选择要管理的 TWinControls 的名称，其中一个名为 DstList 并显示所有可用于 TColorEdits 管理的 TWinControls。

因此，这里有一些（简化的）代码，我用来在设计时获取表单上的 TWinControl 名称并将 TWinControl 名称加载到 DstList 中。

```
 { Load names of TWinControls owned by a form into TListBox DstList }
    for i := 0 to TColorEdits(GetComponent(0)).Owner.ComponentCount - 1 do
      if ((TColorEdits(GetComponent(0)).Owner.Components[i] is TWinControl) then
        dlgEditColors.DstList.Items.Add(TColorEdits(GetComponent(0)).Owner.Components[i].Name); 
```

您应该能够将上述代码作为组件自定义属性编辑器的一部分进行调整。希望这对您问题的第一部分有所帮助。

# moodle - 如何编辑上传到 Moodle 的文件？

> ID：12265927
> 
> 赞同：2
> 
> 时间：2012-09-04T14:43:22.140
> 
> 标签：moodle, scorm, scorm2004, scorm1.2

我想要一个更好的工作流程来调试上传的 SCO。事实上，我必须在活动中编辑一个文件，重新打包，上传和测试。通常，我只需要更改一行代码。能够在服务器上编辑该文件、那行代码将是非常好的。到目前为止，我所发现的只是 Moodle 管理文件，因此在上传后定位和破译重命名的文件似乎是不切实际的。

有没有办法配置 Moodle，使其在提取时不会重命名和重新定位 SCO 中的文件？实际上，我愿意接受有关调试 SCO 的最佳、最快工作流程的任何建议。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-08T13:35:29.637

## 问题背景

从 Moodle 2.0 开始，文件不再以传统`/this/is/the/path/to/my.file`方式存储在服务器上。相反，文件被重新散列并存储在存储库中（即`moodledata`作为看似随机数据的集合分布在整个文件夹中）。这提高了安全性和跨操作系统兼容性，但对于那些想通过 FTP 简单地上传 SCORM zip 包的人来说，事情变得复杂了。以下是有关[Moodle 2.0 中文件处理的更多信息](http://docs.moodle.org/20/en/File_handling)

## 解决方案的路径

让我们找到您要更新的文件，然后更新它。

1.  运行 phpmyadmin，转到`mdl_files`表，在字段中按名称查找文件`filename`（假设是`portrait.jpg`）
2.  看看`contenthash`场，它看起来像`abcde1234567890`。这意味着您的文件存储在`moodledata/filedir/ab/cd/`名称下的文件夹中`abcde1234567890`。
3.  将更新的内容重命名`portrait.jpg`为`abcde1234567890`、上传和覆盖。
4.  返回 phpmyadmin 并使用更新文件的大小更新`filesize`记录中的字段。`portrait.jpg`

显然，这个过程可以自动化。您必须编写一个允许您上传文件的脚本，然后它将在 mdl_files 中搜索该文件，将其保存到正确的文件夹并相应地更新所有字段。

## 另类的想法

启用外部包类型（并启用“每次启动时更新”）。转到站点管理/插件/活动/SCORM，然后选中下面的框。现在您将能够直接从另一台服务器启动 SCORM 包，这样 Moodle 就不会搞砸了。当然，您可以运行其他（可能与跨域相关的）问题。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2015-11-06T19:47:20.613

Sergey 的回答非常好，有一个警告：在他的 contenthash 的示例中`abcde1234567890`，文件存储在`moodledata/filedir/ab/cd/`name 下的文件夹中**`abcde1234567890`**。Moodle 使用完整的 contenthash 来命名文件。

# macros - 如何在 common lisp 中修改此宏以将 collect 集成到循环中？

> ID：12265931
> 
> 赞同：1
> 
> 时间：2012-09-04T14:43:29.280
> 
> 标签：macros, common-lisp, sbcl

我在下面有一个宏，它沿着整数中的位迭代。我想像这样集成循环的收集功能：

```
 (loop for x in '(a b c d e)
      for y in '(1 2 3 4 5)
      collect (list x y) ) 
```

我应该如何修改下面的宏来完成上述操作？

```
(defmacro do-bits ((var x) &rest body)
  "Evaluates [body] forms after binding [var] to each set bit in [x]"
  (let ((k (gensym)))
    `(do ((,k ,x (logand ,k (1- ,k))))
         ((= ,k 0))
       (let ((,var (logand ,k (- ,k))))
         ,@body)))) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-04T15:49:30.037

这是一个简单的宏`with-collector`，应该可以解决问题：

```
(defmacro with-collector ((&optional (collector-name 'collect)) &body body)
  (let ((result (gensym)))
    `(let ((,result (list)))
       (flet ((,collector-name (arg) (push arg ,result)))
         (progn ,@body)
         (when ,result
           (nreverse ,result))))) 
```

它`collect`默认使用名称：

```
(with-collector ()
  (collect 'a)
  (collect 'b)); => (A B) 
```

但如果您愿意，您可以使用其他名称（例如，用于嵌套或解决符号冲突）

```
(with-collector (foo)
  (foo 'bar)
  (foo 'baz)); => (BAR BAZ) 
```

要将它与您的宏集成，只需包装`do`表单：

```
(defmacro do-bits ((var x) &rest body)
  "Evaluates [body] forms after binding [var] to each set bit in [x]"
  (let ((k (gensym)))
    `(with-collector ()
       (do ((,k ,x (logand ,k (1- ,k))))
           ((= ,k 0))
         (let ((,var (logand ,k (- ,k))))
           ,@body))))) 
```

并将`collect`在正文中可用：

```
(do-bits (x 255) (collect x))
; => (1 2 4 8 16 32 64 128)
(do-bits (x 256) (collect x))
; => (256) 
```

# c# - 连接时出现 Npgsql 异常

> ID：12265932
> 
> 赞同：5
> 
> 时间：2012-09-04T14:43:33.183
> 
> 标签：c#, npgsql

我在 C# .NET 4.0 应用程序中使用 Npgsql 2.0.11.94 连接到 PostgreSql 数据库。我已经根据他们网站上的示例形成了连接字符串，当我使用 NpgsqlConnection 对象调用 connect 时，会抛出此异常：

```
A first chance exception of type 'Npgsql.NpgsqlException' occurred in Npgsql.dll

Additional information: ERROR: 22023: 3 is outside the valid range for parameter "extra_float_digits" (-15 .. 2) 
```

抛出异常后代码将正确执行。也就是说，确实建立了与数据库的连接，并且查询返回了正确的数据。有谁知道它为什么抛出这个异常？这是我连接到数据库的代码：

```
string strConnection = "Server=192.168.253.20;Port=5432;User Id=alex;Password=asdf;Database=mydatabase;";
NpgsqlConnection conn = null;
try
{
    conn = new NpgsqlConnection(strConnection);
    conn.Open();
}
catch (Exception e)
{
} 
```

任何帮助将非常感激。

谢谢，亚历克斯

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-04T23:56:42.860

这是建立连接时初始设置的错误。

在第一次打开的每个连接上都会执行一些不同的命令（但在重新使用池连接时不会重复），这个命令试图处理浮点数格式允许的不同精度在不同版本的 PostgreSQL 之间。

很明显，事情并没有按计划进行。

快速查看源代码，似乎该调用已被包装并且应该吃掉任何此类异常，但也许那是在最后一个版本之后。如果是这样，那么从源代码构建可能会解决您的问题。

或者你可以返回一个版本，或者只是用 try-catch 包装，直到下一个版本。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-09-21T19:53:29.693

Jon Hanna 正确地解释了为什么我们有这样的 try-catch 以及为什么会抛出异常。问题是 VS.net 会显示*任何*抛出的异常，即使是像 Npgsql 那样被 try-catch 异常处理吃掉的异常。

我认为 vs.net 的行为是正确的，向您表明尽管正在处理它们，但仍然有异常被抛出，并且在这种特定情况下，只是被忽略了。

您可以检查此异常是否仅在您使用 vs.net 调试代码时出现。此外，您还注意到，您的代码继续工作，就好像没有发生任何错误一样。所以，你不必担心这一点。

我希望它有所帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-23T11:58:35.107

我想您在管理 Visual Studio 项目时遇到了这个异常，因此请尝试在 MainMenu -> Debug -> Exceptions 中取消选中 Common Language Runtime Exceptions 和 Managed Debugging Assistans 列表。祝你好运！:))) 保罗

# xcode - Xcode 离线安装

> ID：12265940
> 
> 赞同：1
> 
> 时间：2012-09-04T14:43:48.513
> 
> 标签：xcode, macos, xcode4

现在 XCode 可通过应用商店获得。

我有一个大约 20 个 iMac 的实验室设置，XCode 大小约为 4 GB。有什么方法可以让我安装一次并使用 pendrive 或驱动器将其复制到其他 mac 并在各自的 mac 上连接/激活/授权。

一定有什么东西。在某个线程中，我看到我们可以从 connect.apple.com 下载它。我登录并看到了.DMG。但是 Xcode 4.4.1.dmg 是“1.81GB”。怎么可能。

我没有那么多带宽。10 个系统上的 4 GB 意味着 40 GB，所花费的时间也很重要。

请指导。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-04T14:59:28.600

在过去一年左右的时间里，他们设法显着压缩了 Xcode，您从开发人员门户获得的 .dmg 将是您想要的方式。它仅重 1.81GB，可以复制到任意数量的计算机（前提是它们旨在供开发程序的成员使用）。我刚刚查看了 Mac App Store，他们正在分发 Xcode 4.4.1 @ 1.6GB。

此外，这个问题将作为题外话关闭。Stack Overflow 专门针对与编程相关的问题。检查[常见问题解答](https://stackoverflow.com/faq)。以后，如果您有类似的问题，您将在[超级用户上得到更好的答复](https://superuser.com/)

# c# - 获取值类型 C# 的引用

> ID：12265945
> 
> 赞同：1
> 
> 时间：2012-09-04T14:44:01.993
> 
> 标签：c#, unsafe, value-type

> **可能重复：**
> [如何通过“引用”分配给 c# 中的类字段？](https://stackoverflow.com/questions/2980463/how-do-i-assign-by-reference-to-a-class-field-in-c)

我想将我的值类型的引用复制到另一个值类型。不使用`unsafe`范式有可能吗？

```
int a = 10;
int b = 15;
a = b; // BUT I WANT TO SET REFERENCE OF b ! 
```

这是我的真实例子。我创建枚举值类型并通过引用将其作为参数发送：

```
 public enum Test
{
    test1,
    test2,
    test3
}

public class MyTestClass1
{
    private Test _test;

    public MyTestClass1(ref Test test)
    {
        _test = test;
    }
}

public class Content
{
    public void Method()
    {
        Test e = Test.test1;
        /*some code*/
        var omyTestClass1 = new MyTestClass1(ref e);
        /*some code*/
        e = Test.test2;
        /*some code*/
        e = Test.test3;
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-04T14:45:06.117

`unsafe`如果不使用或将值类型包装在结构/类中，您将无法做到这一点。

来自[MSDN](http://msdn.microsoft.com/en-us/library/s1ax56ch.aspx)：

> 将一个值类型变量分配给另一个会复制包含的值。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-04T14:47:33.967

在同一方法中，不可能有一个包含对另一个局部变量的引用的局部变量。可能的类似情况*是*方法参数在调用方法中具有对局部变量的引用：

```
void CallingMethod()
{
    int a = 10;
    SomeMethod(ref a);
    ...
}

void SomeMethod(ref int b)
{
    // here, the variable b holds a reference to CallingMethod's local variable "a". 
```

请注意，它`b`可能包含对局部变量以外的其他内容的引用。例如，您可以像这样调用 SomeMethod，在这种情况下，引用将指向堆上对象的字段：

```
class MyClass
{
    private int _a;
    public void AnotherCaller()
    {
        SomeMethod(ref _a);
        ...
    }
} 
```

更新：Eric Lippert 偶尔会写关于您所询问的功能，因为 CLR 确实支持它，而 C#*可以*支持它。请参阅此答案，例如：[https ://stackoverflow.com/a/4923772/385844](https://stackoverflow.com/a/4923772/385844)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-04T15:29:03.743

我不确定我是否完全理解你，但你可以将你的引用类型包含`int`在一些引用类型中，比如一个`int[]`length`1`或一个 1-tuple, `Tuple<int>`。

所以：

```
var a = Tuple.Create(10);
var b = Tuple.Create(15);
a = b; 
```

由于`Tuple<>`is **immutable**，因此这是毫无意义的。

但随后：

```
var a = new[] { 10 };
var b = new[] { 15 };
a = b;
// a and b reference the same object, and that'a a mutable object!
b[0] = 17;
// now a and b are still the same object, so also a[0] == 17 
```

`ref`注意：这与您使用的关键字无关。你似乎`ref`无缘无故地使用。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-04T23:40:04.263

如果您的方法实际上是：

```
public MyTestClass1 Method()
{
    Test e = Test.test1;
    /*some code*/
    var omyTestClass1 = new MyTestClass1(ref e);
    /*some code*/
    e = Test.test2;
    /*some code*/
    e = Test.test3;
    return omyTestClass1;
} 
```

返回的值包含对已在堆栈上但现在不在堆栈上的值类型的引用。现在，如果您尝试访问该字段，您可以获得任何东西。

更糟糕的是，如果你写信给那个参考怎么办？如果该引用已存储在实际的调用堆栈中，而不是将其所有时间都花在寄存器中（并且我们可以安全地假设在一个类中有一个字段引用它的事实意味着它必须是那里），那么现在那里有什么？它可能是对对象的引用。它可能是一个返回地址。写入它可能会导致一些奇怪的 fandango-on-the-core 错误，很可能是在写入之后的一段时间，因此很难调试。

我们会失去一些我们拥有的基本保证。在您写入该值之后，几乎任何地方的任何代码都可能以某种奇怪的方式失败。

在这一点上值得注意的是，C++ 和 .NET 本身（也就是说，你可以在 .NET 中做的所有事情，包括一些你在 C# 中不能做的事情）都允许本地引用和 ref 的返回值不允许 ref字段。

最接近的方法是使用 lambdas 和匿名方法进行捕获。在这里，locals 不是存储在堆栈中，而是存储在堆中，以允许它们与生命捕获的 lambda 一样长（并在它们中的最后一个被收集时被收集）。您当然可以使用它来维护对对象中作为本地开始的内容的引用。

或者，您可以使用执行必要工作的类来包装值类型。例如，当我有足够类似的需求时，我使用了一个：

```
public sealed class SharedInt
{
  private int _value;
  /// <summary>Creates a new SharedInt with a value of zero.</summary>
  public SharedInt(){}
  /// <summary>Creates a new SharedInt.</summary>
  /// <param name="value">The initial value of the object.</param>
  public SharedInt(int value)
  {
    _value = value;
  }
  /// <summary>Returns the value of the SharedInt.</summary>
  public int Value
  {
    get { return _value; }
  }
  /// <summary>Returns the value of the SharedInt.</summary>
  /// <param name="ri">The SharedInt to cast.</param>
  /// <returns>An integer of the same value as the SharedInt.</returns>
  public static implicit operator int(SharedInt ri)
  {
    return ri._value;
  }
  /// <summary>Atomically increment the value of the SharedInt by one.</summary>
  /// <returns>The new value.</returns>
  public int Increment()
  {
    return Interlocked.Increment(ref _value);
  }
  /// <summary>Atomically decrement the value of the SharedInt by one.</summary>
  /// <returns>The new value.</returns>
  public int Decrement()
  {
    return Interlocked.Decrement(ref _value);
  }
  /// <summary>Atomically add a value to the SharedInt.</summary>
  /// <param name="addend">The number to add to the SharedInt.</param>
  /// <returns>The new value.</returns>
  public int Add(int addend)
  {
    return Interlocked.Add(ref _value, addend);
  }
  /// <summary>Atomically replace the value of the SharedInt, returning the previous value.</summary>
  /// <param name="value">The number to set the SharedInt to.</param>
  /// <returns>The old value.</returns>
  public int Exchange(int value)
  {
    return Interlocked.Exchange(ref _value, value);
  }
  /// <summary>Atomically subtract a value from the SharedInt.</summary>
  /// <param name="subtrahend">The number to subtract from the SharedInt.</param>
  /// <returns>The new value.</returns>
  public int Subtract(int subtrahend)
  {
    return Interlocked.Add(ref _value, -subtrahend);
  }
} 
```

我需要一些原子性保证，你可能不需要，同样可能不需要一些你确实需要的东西，但它可以很好地作为一种能够处理`int`不同类中相同值的方法。

如果你不介意每次都检查一个属性，你可以做一个更通用的版本。

```
public class TypedBox<T> where T : struct
{
  public T Value;
} 
```

公开一个字段有相当大的缺点（这就是为什么我们通常从不这样做），但大多数都不适用于这种情况（我们*希望*能够从外部完全操纵它），这意味着你甚至可以通过作为`Value`一个`ref`或`out`参数。

# php - Vimeo API 错误 708

> ID：12265951
> 
> 赞同：0
> 
> 时间：2012-09-04T14:44:12.010
> 
> 标签：php, vimeo

使用 Vimeo API 将视频 (mp4) 上传到我的 Vimeo 帐户。Uinsg vimeo.php 文件稍作修改（当它们应该是数组时使用对象）我正在调用

```
$video_id = $vimeo->upload 
```

我能够跟踪 getQuota、getTicket、verifyChunks 但它失败了：

```
$this->call('vimeo.videos.upload.complete', array('ticket_id' => $ticket, 'filename' => $file_name)); 
```

出现以下错误：

```
stdClass Object(
[generated_in] => 1.0675
[stat] => fail
[err] => stdClass Object
    (
        [code] => 708
        [expl] => The file could not be saved. Try again.
        [msg] => File error
    )) 
```

有什么帮助吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-07-25T20:58:08.823

如果有任何帮助，我遇到了完全相同的错误，从**endpoint_secure**切换到**endpoint**解决了上传表单中的问题。

# c - PostgreSQL ecpg 程序不保存对数据库的更改

> ID：12265954
> 
> 赞同：4
> 
> 时间：2012-09-04T14:44:14.787
> 
> 标签：c, database, postgresql, ecpg

我在笔记本电脑上使用 postgresql 服务器，并尝试使用 epcg 通过我的 C 程序连接数据库。我编写了以下命令来预编译、编译和运行我的`.pgc`程序。

```
PRE-COMPIILE - epcg sql.pgc  
COMPILE -   gcc -c sql.c -I/usr/include/postgresql   
RUN -  gcc -o sql sql.o -L/usr/lib -lecpg 
```

我的程序正在编译并成功运行，即它没有显示任何错误。
但是，当我尝试在命令行提示符下检索我的数据库时，使用命令
COMMAND - `psql`database

表中没有更新，即我在程序中编写的命令没有在数据库中更新。

以下是`.pgc`文件中的代码：

```
#include<stdio.h>

int main()
{

    EXEC SQL CONNECT TO database;

    EXEC SQL create table player(player_id int,player_name varchar(255),team varchar(10));
    EXEC SQL create table player1(player_id int,player_name varchar(255),team varchar(10));
    EXEC SQL INSERT INTO player VALUES(1,'ram','a');

    EXEC SQL COMMIT;

    EXEC SQL DISCONNECT database;

    return 0;
} 
```

以下是预编译后的 C 代码：

```
/* Processed by ecpg (4.7.0) */
/* These include files are added by the preprocessor */
#include <ecpglib.h>
#include <ecpgerrno.h>
#include <sqlca.h>
/* End of automatic include section */

#line 1 "sql.pgc"
#include<stdio.h>

int main()
{
    { ECPGconnect(__LINE__, 0, "vidisha@localhost:5432" , NULL, NULL , NULL, 0); }
#line 8 "sql.pgc"
    { ECPGdo(__LINE__, 0, 1, NULL, 0, ECPGst_normal, "create table player ( player_id int , player_name varchar ( 255 ) , team varchar ( 10 ) )", ECPGt_EOIT, ECPGt_EORT);}
#line 10 "sql.pgc"
    { ECPGdo(__LINE__, 0, 1, NULL, 0, ECPGst_normal, "create table player1 ( player_id int , player_name varchar ( 255 ) , team varchar ( 10 ) )", ECPGt_EOIT, ECPGt_EORT);}
#line 11 "sql.pgc"
    { ECPGdo(__LINE__, 0, 1, NULL, 0, ECPGst_normal, "insert into player values ( 1 , 'ram' , 'a' )", ECPGt_EOIT, ECPGt_EORT);}
#line 12 "sql.pgc"
    { ECPGtrans(__LINE__, NULL, "commit");}
#line 14 "sql.pgc"
    { ECPGdisconnect(__LINE__, "vidisha");}
#line 16 "sql.pgc"
    return 0;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-04T15:52:16.123

使用您编写的脚本，我的测试数据库也没有任何变化。

因此，使用@vector 建议，如果我提供了我的测试数据库的用户名，一切正常：

使用这个`makefile`：

```
default:
    ecpg sql.pgc
    gcc -c sql.c -I/usr/include/postgresql
    gcc -o sql sql.o -L/usr/lib -lecpg 
```

而且，作为一个例子，我将使用：

*   `testdb`作为数据库名称
*   `9876`作为港口
*   `testuser`作为用户名
*   `testpass`作为密码

有了这个`sql.pgc`：

```
#include <stdio.h>

int main() {
    EXEC SQL CONNECT TO testdb@localhost:9876 USER 'testuser' IDENTIFIED BY 'testpass';

    EXEC SQL create table player(player_id int,player_name varchar(255),team varchar(10));
    EXEC SQL create table player1(player_id int,player_name varchar(255),team varchar(10));
    EXEC SQL INSERT INTO player VALUES(1,'ram','a');

    EXEC SQL COMMIT;

    EXEC SQL DISCONNECT;

    return 0;
} 
```

一切运作良好。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-04T19:04:16.560

You also have to provide the password and the default port is 5432. This code works fine for me. `testdb- databaseName, postgres - username, 123321 - password`

_*Also after once executing this program you have to remove both the create table lines else your code will not work (as the tables are alredy created). You will get no error as you have not done error handling. To learn about error handling and more click [here](http://www.postgresql.org/docs/9.1/static/ecpg.html). _*

```
#include<stdio.h>

int main()
{

    EXEC SQL CONNECT TO testdb@localhost:5432 USER 'postgres' USING '123321';

    EXEC SQL create table player(player_id int,player_name varchar(255),team varchar(10));
    EXEC SQL create table player1(player_id int,player_name varchar(255),team varchar(10));
    EXEC SQL INSERT INTO player VALUES(1,'ram','a');

    EXEC SQL COMMIT;

    EXEC SQL DISCONNECT database;

    return 0;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-04-14T15:45:39.547

您必须将搜索路径设置为当前数据库。

```
EXEC SQL SET SEARCH_PATH TO "your database"; 
```

另外，最后不要忘记提交。

```
EXEC SQL COMMIT; 
```

# typo3 - 内容元素开头的链接

> ID：12265957
> 
> 赞同：1
> 
> 时间：2012-09-04T14:44:21.023
> 
> 标签：typo3, typoscript, templavoila

TYPO3 几乎在每个元素的开头添加了这些链接：

```
<a id="c1427"></a> 
```

我猜，其中 number 是元素的 UID。

TYPO3 如何呈现此链接，是否可以为特定的 FCE 禁用它？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-04T15:18:27.510

这取决于您的 TYPO3 版本。在 4.5 中，它通过以下方式定义：

```
tt_content.stdWrap.innerWrap.cObject.default.10.value = <div id="c{field:uid}" 
```

如果您使用 TS-Objectbrowser，您应该在 tt_content.stdWrap 的某个地方找到它。*

根据您使用的渲染，您可以添加一个 if 语句，例如：

```
tt_content.stdWrap.innerWrap.cObject.default.10 {
   # check the uid of the content element which is rendered
   if.isInList.field = uid 
   # do not render if content element uid is 1,2 or 44
   if.value = 1,2,44
} 
```

当然，这取决于您的配置，因此您无法复制和粘贴。而且我没有测试这段代码！但它应该表明要走的路:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-10-24T15:05:19.177

我认为您的问题在于 tt_content.stdWrap.prepend 对于与默认语言不同的任何语言都不同。

试着把这个打字稿放在你的模板中：

tt_content.stdWrap.prepend >

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-02-10T10:24:26.727

```
tt_content.stdWrap.wrap = <div class="content-element">|</div> 
```

# ruby-on-rails - Ruby 模块中的访问方法

> ID：12265959
> 
> 赞同：3
> 
> 时间：2012-09-04T14:44:26.630
> 
> 标签：ruby-on-rails, ruby, oop

我正在编写我的第一个 Ruby 模块，我有这个：

/app/module/test_modules/test.rb

test.rb 看起来类似于：

```
module TestModules
  module Test

    def test
      puts 'this is a test'
    end
  end
end 
```

当我从控制台调用以下命令时，我得到：

```
(main)> TestModule::Test.test
//NoMethodError: private method `test' called for TestModules::Test:Module 
```

如何使 test() 可见？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-04T14:49:59.877

您正在调用一个类方法，而您定义`test`为一个实例方法。如果您通过`include`或使用模块，您可以按照您想要的方式调用它`extend`。[这篇文章](http://railstips.org/blog/archives/2009/05/11/class-and-instance-methods-in-ruby/)很好地解释了。

```
module TestModules
  module Test
    def self.test
      puts 'this is a test'
    end
  end
end 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-04T14:51:09.820

还，

1)

```
module TestModules
  module Test
    def test
      puts 'this is a test'
    end

    module_function :test
  end
end 
```

2)

```
module TestModules
  module Test
    extend self
    def test
      puts 'this is a test'
    end
  end
end 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-04T14:51:28.737

您定义方法的方式，它是一个实例上的方法`Test`- 因此，如果您这样做，它将起作用：

```
blah = TestModule::Test.new
blah.test 
```

*注意*- 并以这种方式使用它，您需要将其定义`Test`为 a `class`not a`module`

如果您希望该函数在类本身上工作，那么您需要像这样定义它：

```
def self.test
    ....
end 
```

然后你可以做`TestModules::Test.test`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-04T14:49:29.157

您定义的测试方法是实例方法...试试这个

```
module TestModules
  module Test
    def self.test
      puts 'this is a test'
    end
  end
end 
```

现在您可以通过此 TestModules::Test.test 调用该方法

# javascript - 如何使用 jQuery 实现取消

> ID：12265967
> 
> 赞同：1
> 
> 时间：2012-09-04T14:44:46.077
> 
> 标签：javascript, jquery

我正在使用 JavaScript 和 jQuery 构建一个非常复杂的 UI——它有下拉菜单、按钮、jQuery 插件等元素。在 UI 的底部，有两个按钮 Ok 和 Cancel。我的问题是关于取消 - 有没有*简单*的方法可以将 UI 重置为原始状态。

我的一个想法是使用 $.extend 创建我的 UI 的深层副本，对副本进行所有更改，然后在单击 Ok 时使​​用容器 div 的 .html() 来“提交”副本。听起来可行吗？

有没有更好的方法来实现“取消”功能？

谢谢。

# c# - 在 IIS 中发生变异的不可变值？

> ID：12265969
> 
> 赞同：2
> 
> 时间：2012-09-04T14:45:05.650
> 
> 标签：c#, iis, des

所以，在过去的几周里，我一直在试图找出以下问题，此时我几乎用尽了我的选择，因为情况看起来多么矛盾。

我有一个在 SharePoint 下开发的应用程序，但它基本上是 ASP.NET 代码。我有一个加密的连接字符串，我将其解密在内存中并将其存储在配置对象中以访问数据库。我的配置对象是静态的（可通过`Service Locator`模式访问），我稍后会使用它来播种 LINQ-to-SQL 数据上下文。

我用于解密的内部密钥私下存储在一个类中`private static readonly string myPassword = "MyPassword";`（仅作为示例，实际密码更复杂且更有效）。在任何地方都没有引用该字段的单一语句，除了静态方法上的一个语句，它使用它作为另一种解密方法（实例方法）的参数，该方法用它实例化一个新方法`DESCryptoServiceProvider`。

而且，我的生产服务器日志中不时出现以下异常：

```
Exception type: CryptographicException
Exception message: Specified key is a known weak key for 'DES' and cannot be used. 
```

因此，连接字符串解密失败，当然，数据库不再被访问。噗，申请下来了。

这怎么可能？

**免责声明**：这是我正在维护的旧应用程序。我在此处提供的描述是为了帮助排除故障，但我无法更改它在内部的工作方式。有些人会同意这不是最好的方法，但该应用程序已经运行了 2 年多没有问题，突然这些异常正在取消它。

**更新**：我被要求用异常的堆栈跟踪来澄清，但由于 NDA 的原因我不能提供一个完整的堆栈跟踪。我*能*说的是以下几点：

*   抛出异常的对象是`System.Security.DESCryptoServiceProvider.CreateDecryptor(Byte[] rgbKey, Byte[] rgbIV)`方法
*   原始密钥（我们实际使用的密钥）会验证并且不会产生异常。尽管如此，我们还是不时（并非总是）得到这个异常，不知道哪个是不验证的当前值
*   的实例`DESCryptoServiceProvider`被静态、私有地存储在一个辅助类中
*   这都是由 , 触发的`System.Web.HttpApplication.InitModulesCommon()`，以初始化应用程序内部部分

此外，这是一个模糊的堆栈跟踪：

```
at System.Security.Cryptography.DESCryptoServiceProvider.CreateDecryptor(Byte[] rgbKey, Byte[] rgbIV)
at SymmetricEncryption.Decrypt(String contents, String key)
// our helper, just a wrapper, based from this class: http://www.codeproject.com/Articles/1967/Encryption-Decryption-with-NET
at EncryptedConnectionStringHelper.DecryptUserAndPass(String connectionString)\
// our container for parsing the connection string and decrypting the user and password, not the full connstring is encrypted
at OurModule.Init(OurConfigurationSection config)
at OurModule.Boot(OurConfigurationSection config)
at OurModule.Boot()
at OurModule.Init(HttpApplication context)
at System.Web.HttpApplication.InitModulesCommon()
at System.Web.HttpApplication.InitInternal(HttpContext context, HttpApplicationState state, MethodInfo[] handlers)
at System.Web.HttpApplicationFactory.GetNormalApplicationInstance(HttpContext context)
at System.Web.HttpApplicationFactory.GetApplicationInstance(HttpContext context)
at System.Web.HttpRuntime.ProcessRequestInternal(HttpWorkerRequest wr) 
```

我们的应用程序通过以下方式注册此模块：

```
public class OurModule : IHttpModule
{
    public static bool initialized = false;

    public void Init(HttpApplication context)
    { 
        if (!initialized) {
            subscribe(context);
            OurModule.Boot();
            initialized = true;
        }
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-04T16:21:25.033

看看你的包装`SymmetricEncryption.Decrypt`。我的猜测是问题就在那里。它如何从您的密码创建密钥。它是否使用[PasswordDeriveBytes](http://msdn.microsoft.com/en-us/library/system.security.cryptography.passwordderivebytes.aspx "密码驱动字节")或其他一些半生不熟的解决方案？

失败了，也许您可​​以尝试获得比“MyPassword”更好的密钥。

失败了，也许你可以使用 web.config 加密。[Scott Gu 在这里写过。](http://weblogs.asp.net/scottgu/archive/2006/01/09/434893.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-04T14:47:25.260

听起来好像没有任何东西在*改变*对象。听起来“某事”（如果您发布了堆栈跟踪会更清楚）正在*验证*DES 密钥......并抱怨它是一个已知的弱密钥。

理想情况下，您当然应该更改密码以更安全 - 但如果您不能，您应该查看该异常的确切来源，并查看某处是否有控制验证方式和时间的设置。

如果您还没有记录完整的堆栈跟踪（而不仅仅是异常消息），那是您应该做的*第一*件事。

# erlang - 在恒定时间内查找 Mnesia 中列的最大值/最小值

> ID：12265974
> 
> 赞同：4
> 
> 时间：2012-09-04T14:45:13.473
> 
> 标签：erlang, mnesia

如何在恒定时间内（或最接近的时间）找到 Mnesia 表中索引列的最大值或最小值？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-05T19:05:27.117

我会在 Mnesia 数据库之外进行。每当有插入到表中时，通过一个学习这些值的过程来保持显式最小值和显式最大值。这使您可以非常快速地对值进行恒定时间查找。

如果您可以使用 O(lg n) 时间，那么您可以将表设为有序集。从那里开始，`first/1`应该`last/1`给你你想要的，因为密钥包含你订购的东西。但这通常也会将其他查询减慢到 O(lg n)。

第三个技巧是使用近似值。有时您会扫描表格并记下最大值和最小值。然后这会变成您想要的，但如果距离您上次扫描很长时间，则该值可能不是最新的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-04T19:01:59.687

好问题，但我认为这是不可能的。快速浏览一下 mnesia 和 qlc 文档并没有给我任何关于这个主题的线索。

在我看来，mnesia 中的辅助密钥设施不完整，因此功能非常有限。更不用说加载索引表时可怕的 mnesia 启动时间。

我认为在您的情况下最可靠的解决方案是进行显式索引。例如，在主键上创建并与表保持同步，主键实际上是您想要索引的值。

# python - 如何在python中使用正则表达式在标签中映射多个标签

> ID：12265976
> 
> 赞同：0
> 
> 时间：2012-09-04T14:45:19.673
> 
> 标签：python, regex, python-2.7

> **可能重复：**
> [正则表达式匹配打开的标签，XHTML 自包含标签除外](https://stackoverflow.com/questions/1732348/regex-match-open-tags-except-xhtml-self-contained-tags)

我必须在 python`<td>`中使用正则表达式映射多个数据`<tr>`

例如

```
<tr>
  <td>data 1</td>
  <td>data 2</td>
  <td>data 3</td>
</tr> 
```

我想使用单个正则表达式提取 data1、data2、data3。并且可以有任意数量的`<td>`标签。

目前我正在使用多个正则表达式，即首先我正在映射`<tr></tr>`，然后`<td></td>`

我可以用单一的表达吗？

我想使用正则表达式来实现这一点，所以我不能使用漂亮的汤或其他 html 解析器。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-04T18:52:10.877

尽管正如其他人所建议的那样，您应该使用为该任务设计的东西来解析您的 HTML，但以下内容适用于部分情况：

```
re.findall(r'(?i)<td.*?>([^<]+)</td.*?>', input_str) 
```

根据 HTML 输入的格式，您可能需要在使用`re.findall()`. 以下内容将从名为 的列表中读取`file.html`并存储任何匹配项`data`：

```
import re

fh = open('file.html', 'r')
input_str = fh.read()
data = re.findall(r'(?i)<td.*?>([^<]+)</td.*?>', input_str)
fh.close() 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-04T15:43:48.500

**编辑：**我明白了，小马，他来了。我也时不时地传播这个词，因为我完全同意这种观点。但这种观点似乎在上面的评论中得到了充分表达，所以我的目的只是**回答字面上的问题**，“我可以用 [a] 单一的表达方式做到吗？” 简单地说：“不，除了在 .NET 中，所以继续前进。”

* * *

要回答您的实际问题：

不，您不能在单个表达式中执行此操作，除非您使用的是 .NET，据我所知，它为量化表达式中匹配的每个实例提供捕获。

你能做的最好的就是有限的、非任意的重复，例如

```
 /<tr>(?:\s*<td>(.*?)</td>)?(?:\s*<td>(.*?)</td>)?(?:\s*<td>(.*?)</td>)?(?:\s*<td>(.*?)</td>)?\s*</tr>/ 
```

当然，以上是粗略的，没有考虑任何其他的标签、评论等。我只是为了举例说明“有限的、非任意的”部分。

# php - 防止 XSS 附加到 php 脚本示例

> ID：12265977
> 
> 赞同：0
> 
> 时间：2012-09-04T14:45:27.703
> 
> 标签：php, javascript

我有以下 php pahe，它接受用户的名字和密码来访问受密码保护的站点。

```
 <?php
    /**
     * ****************************************************************************
     * Micro Protector
     * 
     * Version: 1.0
     * Release date: 2007-09-10
     * 
     * USAGE:
     *   Define your requested password below and inset the following code
     *   at the beginning of your page:
     *   <?php require_once("microProtector.php"); ?>
     * 
     *   See the attached example.php.
     * 
     ******************************************************************************/

    $Password = 'testpass'; // Set your password here

    /******************************************************************************/
       if (isset($_POST['submit_pwd'])){
          $pass = isset($_POST['passwd']) ? $_POST['passwd'] : '';

          if ($pass != $Password) {
             showForm("Wrong password");
             exit();     
          }
       } else {
          showForm();
          exit();
       }

    function showForm($error="LOGIN"){
    ?>
    <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "DTD/xhtml1-transitional.dtd">
    <html>
    <head>
    <META HTTP-EQUIV="PRAGMA" CONTENT="NO-CACHE">
    <META HTTP-EQUIV="CACHE-CONTROL" CONTENT="NO-CACHE">
       <title>IMC - Authentication</title>
       <link href="style/style.css" rel="stylesheet" type="text/css" />
    <Script>
    <!--
    function capitalize(form) {
        value = form.value;
        newValue = '';
        value = value.split(' ');
        for(var i = 0; i < value.length; i++) {
            newValue += value[i].substring(0,1).toUpperCase() +
            value[i].substring(1,value[i].length) + '';
        }
    newValue = newValue.replace(/(<([^>]+)>)/ig,"");
    form.value = newValue;
    }
    -->
    </Script>
    </head>
    <body>
    <center><a href="http://www.test.com"><img src="http://www.test.com/topLogo.png" border=0 /></a></center>
    <br><br><br>
        <div id="main">
          <div class="caption"><?php echo $error; ?></div>
          <div id="icon">&nbsp;</div>
          <form action="<?php echo $_SERVER['PHP_SELF']; ?>" method="post" name="pwd">
        Your Name:
            <table>
              <tr><td><input class="text" name="name" onBlur="capitalize(this);" maxlength=12 type="text" /></td></tr>
            </table> 
            Password:
            <table>
              <tr><td><input class="text" name="passwd" maxlength=8 type="password" /></td></tr>
              <tr><td align="center"><br/>
                 <input class="text" type="submit" name="submit_pwd" value="Login" />
              </td></tr>
            </table>  
          </form>
       </div>
    </body>
    </html>

    <?php   
    }
    ?> 
```

目前它没有验证任何 XSS 或任何类型的恶意攻击。在我的联系我们页面上，我有以下代码，可确保用户无法输入任何 XSS 或任何类型的恶意代码：

```
// Clean up the input values 
foreach($_POST as $key => $value) { 
  if(ini_get('magic_quotes_gpc')) 
    $_POST[$key] = stripslashes($_POST[$key]); 

  $_POST[$key] = htmlspecialchars(strip_tags($_POST[$key])); 
} 
```

谁能告诉我在我的 php 页面中插入上述代码的位置，以确保没有插入恶意代码。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-04T15:23:53.727

我建议使用[HTMLPurifier 之](http://htmlpurifier.org)类的库。它非常易于使用，并且可以过滤用户输入，防止 XSS 攻击。

```
$filter = new HTMLPurifier();

foreach($_POST as $key => $value) { 
  $_POST[$key] = $filter->purify($_POST[$key])); 
} 
```

然后您可以根据数据库或其他存储机制中的密码检查密码

高温高压

# oop - 各种查询生成器

> ID：12265978
> 
> 赞同：0
> 
> 时间：2012-09-04T14:45:28.347
> 
> 标签：oop, design-patterns, activerecord

我正在创建一个框架 MVC 来构建我的应用程序。在我的应用程序中，我需要使用几个 DBMS，我需要为此做好准备。

我正在考虑使用 Active Record 模式，它具有关联的“连接”（抽象）。Active Record 不知道要使用哪个 DBMS。所以，我使用工厂方法来抽象使用了哪个 DBMS。

我将如何构建各种查询（CRUD）？因为每个 DBMS 都需要特定的查询。

我认为创建可以解决的各种类“QueryBuilder”（每个 DBMS 一个类）。

怎么想？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-04T17:09:18.390

要解决此问题，您可以使用 DAO 层模式。此模式对客户端隐藏了数据库特定的详细信息。您可以为您的 DAO 将实现的 CRUD 操作定义接口。

这样，即使你的 DB 将来发生变化，DAO 层的客户端也不必担心这些变化。

有关此模式的更多详细信息，请参阅下面的 wiki 页面。

[http://en.wikipedia.org/wiki/Data_access_object](http://en.wikipedia.org/wiki/Data_access_object)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-05T12:18:52.317

我假设目的是将各种 ActiveRecord 对象与数据库之间的 SQL 语法差异隔离开来？

您没有通过查询 bulder 的设计定义您的确切意图，但我已经使用 , 等方法完成过一次`AddSelection(colName)`。`AddCriteria(colName, ComparisonEnum, value)`如果这是您的方法，那么如果您的查询足够小/简单，那么查询构建器就可以了. 但是，一旦您需要构建复杂连接或内部子查询的能力，那么您可能会用这种方法碰壁。

如果您需要处理任意困难的查询，那么另一种选择是创建转换器或翻译器。如果您要定义规范查询格式，那么每个特定于 DBMS 的转换都知道如何从该规范格式转换为特定于 DB 的语法。不过，您确实需要此功能才能使其值得付出努力。

最后，您的另一个方法是为每个 DB 子类化 ActiveRecord。因此，如果您有一个 EmployeeRecord 类，您可以使用 OracleEmployeeRecord、MySqlEmployeeRecord、MsSqlServerEmployeeRecord 等对其进行子类化。然后使用抽象工厂创建适当的 ActiveRecord 对象。

# php - Closure Tables - 这是足够的数据来显示树视图吗？

> ID：12265979
> 
> 赞同：1
> 
> 时间：2012-09-04T14:45:29.197
> 
> 标签：php, mysql, tree, directed-acyclic-graphs, transitive-closure-table

这是我通过测试闭包表方法创建的表。

```
|    id    |    parentId    |    childId    |    hops
|          |                |               |
|    270   |       6        |       6       |      0
|    271   |       7        |       7       |      0
|    272   |       8        |       8       |      0
|    273   |       9        |       9       |      0
|    276   |       10       |       10      |      0
|    281   |       9        |       10      |      1
|    282   |       7        |       9       |      1
|    283   |       7        |       10      |      2
|    285   |       7        |       8       |      1
|    286   |       6        |       7       |      1
|    287   |       6        |       9       |      2
|    288   |       6        |       10      |      3
|    289   |       6        |       8       |      2
|    293   |       6        |       9       |      1
|    294   |       6        |       10      |      2 
```

我正在尝试使用 PHP 创建一个简单的树。似乎没有足够的数据来创建表。例如，当我纯粹看 parentId = 6 时：

```
-Part 6 
 -Part 7
  - ?
   - ?
 -Part 9 
   - ?
    - ? 
```

我们知道第 8 部分和第 10 部分存在于第 7 部分或第 9 部分之下，但不是哪个。我们知道第 10 部分存在于 3 和 4 个节点深处，但在哪里？

如果我查看表中的其他数据，可以判断它应该是：

```
- Part 6 
 - Part 7
  - Part 9
   - Part 10
 - Part 9
  - Part 10 
```

我认为闭包表的好处之一是不需要递归查询？你能帮忙解释一下我做错了什么吗？

编辑：为澄清起见，这是一个映射表。还有另一个名为“parts”的表，其中有一个名为 part_id 的列，该列与“closure”表中的 parentId 和 childId 列相关。上表（闭包）中的“id”列仅用于维护主键。这不是真的必要。我用来创建此闭包表的方法在以下文章中进行了描述：http: [//dirtsimple.org/2010/11/simplest-way-to-do-tree-based-queries.html](http://dirtsimple.org/2010/11/simplest-way-to-do-tree-based-queries.html)

EDIT2：它可以有两跳和三跳。我将通过为项目分配名称来更容易地解释。

```
Part 6 = Bicycle
Part 7 = Gears
Part 8 = Chain
Part 9 = Bolt
Part 10 = Nut 
```

螺母是螺栓的一部分。螺栓和螺母组合直接存在于 Bicycle 和作为 Bicycle 一部分的 Gears 中。

关于使用什么方法，我查看了邻接、边、枚举路径、闭包、DAGS（网络）和嵌套集模型。我仍在尝试弄清楚什么是什么，但这是一个极其复杂的组件数据库，其中有多个父级，并且对子树的任何修改都必须通过其他树传播。更重要的是会有插入、删除和树视图，我希望在一般使用期间避免递归，即使以数据库空间和进入期间的查询时间为代价。

# wpf - 为什么 UserControl 会导致序列化错误？

> ID：12265981
> 
> 赞同：0
> 
> 时间：2012-09-04T14:45:34.740
> 
> 标签：wpf, xaml, serialization, user-controls

我的 MainWindow.xaml 中有以下 ComboBox：

```
<ComboBox ItemsSource="{Binding ComboItemsProperty}" /> 
```

在 MainWindow.xaml.cs 中：

```
ObservableCollection<string> ComboItemsField = 
    new ObservableCollection<string>();
public ObservableCollection<string> ComboItemsProperty
{
    get { return ComboItemsField; }
    set { ComboItemsField = value; }
} 
```

这完美！我可以将项目添加到属性并成功序列化 ComboBox 元素。

我的问题是，为什么当我在 UserControl.xaml 和 UserControl.xaml.cs 中有这个 EXACT 代码时，我在尝试序列化控件时收到以下错误：

无法序列化泛型类型'System.Collections.ObjectModel.ObservaleCollection'1 [System.String]'

有什么想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-04T14:59:50.110

你没有说你是如何“成功地序列化（ing）组合框元素”，但错误是用户控件的预期行为。

`XamlWriter`（我假设您正在使用）无法序列化绑定，这意味着它将尝试序列化绑定的实际值。由于您有一个泛型集合绑定，因此它会失败，因为`XamlWriter`无法序列化泛型。

您有两个选择：告诉`XamlWriter`您不想序列化该属性：

```
[DesignerSerializationVisibility(DesignerSerializationVisibility.Hidden)]
public ObservableCollection<string> ComboItemsProperty
{
    get { return ComboItemsField; }
    set { ComboItemsField = value; }
} 
```

或者，如果您确实需要绑定项目，则通过创建自己的从泛型派生的具体类来消除泛型问题。有关详细信息，请参阅[此问题](https://stackoverflow.com/questions/11538761/cannot-serialize-a-generic-type-system-windows-freezablecollection)。

# java - Spring WebFlow，我找不到流外文件的路径？

> ID：12265984
> 
> 赞同：0
> 
> 时间：2012-09-04T14:45:46.443
> 
> 标签：java, spring, spring-webflow

Spring WebFlow，我找不到流外文件的路径？

我正在开发一个 Spring Webflow2 项目，有时我必须访问不在我的流程中的 JavaScript 和图像文件。我找不到放入 JSP 页面的正确路径。

例子：

这是在我的 JSP 中：

```
function ShowCalendar(CONTROL,START_YEAR,END_YEAR,FORMAT){
alert("Loading Calendar js/HTMLCalendar.jsp" );
ControlToSet = eval(CONTROL);
StartYear = START_YEAR;
EndYear = END_YEAR;
FormatAs = FORMAT;

var strFeatures = "width=" + CalWidth + ",height=140" + ",left=" + LEFT + ",top=" + TOP;
var CalWindow = window.open("../calendar.jsp","Calendar", strFeatures)
CalWindow.focus();
} 
```

我收到警报，但我的项目从未找到位于 WebContent 根目录中的 calendar.jsp？有人可以帮帮我吗？我也在尝试加载图像

src="/images/cal.bmp"

哪个在 WebContent/images 中，但也没有找到？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-04T17:44:24.667

这两个都是客户端对内容的请求。也就是说，从您的浏览器。所以它们真的与 WebFlow 没有任何关系，它们将与浏览器用来加载当前页面的 URL 相关（除非您的 JSP 也有 HTML`base href`标记）。

如果您的`window.open()`URL 或者`img src`是与服务器相关的（以 / 开头），您将需要在它们前面放置您的 Web 应用程序的上下文根。例如`/myapplication/images`。

# javascript - jQuery validate 插件验证具有相似名称的输入？

> ID：12265993
> 
> 赞同：1
> 
> 时间：2012-09-04T14:46:12.060
> 
> 标签：javascript, jquery, validation

我正在使用 jQuery validate 在提交之前检查我的表单。在我的 HTML 中，我有类似名称、ID 的输入。我想知道如何在不一一写出的情况下验证具有相似名称的输入（类似于具有相似名称的 jQuery 选择元素）？

```
HTML
<form id="form1">
<table>
<tr><th>Input 1:</th><td><input type="text" name="input1" id="id_input1"/></td></tr>
<tr><th>Input 2:</th><td><input type="text" name="input2" id="id_input2"/></td></tr>
<tr><th>Input 3:</th><td><input type="text" name="input3" id="id_input3"/></td></tr>
</table>
</form>

Javascript

$("#form1").validate({
submitHandler:function(form) {
SubmittingForm()
},
rules: {                    //I am thinking if there has similar stuffs like
                            //$('th[name^="input"]')
input1: "required",     
input2:"required",
input3:"required",                      
    },
messages: {
    input1: "Please finish the table.",                 
    input2: "Please finish the table.",
        input3: "Please finish the table."  
          }
}) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-04T15:04:20.063

对于验证部分，您只能将 class="required" 添加到您的文本字段，它会自动验证它。

至于消息，你可以参考这个[帖子](https://stackoverflow.com/a/2457053/244537)

# c - 这段代码给出了一个荒谬的答案

> ID：12265994
> 
> 赞同：-3
> 
> 时间：2012-09-04T14:46:12.503
> 
> 标签：c, function, recursion

> **可能重复：**
> [这段代码中到底发生了什么？](https://stackoverflow.com/questions/12265477/what-is-really-happening-in-this-code)

我有一个包含递归函数的代码。我在递归上浪费了很多时间，但我仍然无法得到它，真的：

```
#include<stdio.h>

count(int);

 main(){
   int x=10,z;
   z=count(x);
}  
count(int m){
   if(m>0)
      return count(m-1);
} 
```

当`count`第一次使用参数调用时`10`，它满足条件并开始递归。当函数调用自身时会发生什么？我不明白。声明`return count(m-1)`是什么意思？它将控制权转移到哪里？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-04T14:50:31.827

函数的返回值`count`是未定义的，因为如果`(m <= 0)`为真则没有默认返回。

> **C11, § 6.9.1 函数定义**
> 
> 如果`}`到达终止函数的 ，并且调用者使用函数调用的值，则行为未定义。

此外，要了解递归函数的工作原理，您必须阅读论文并尝试自己执行代码（另请参见[此处](https://stackoverflow.com/questions/12265477/what-is-really-happening-in-this-code)）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-04T14:50:01.403

您需要`count`在`m <= 0`. 您应该声明返回类型`count`并进行编译，`-Wall`以便编译器帮助您发现代码中的错误。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-04T14:51:10.470

*递归*意味着该函数将调用自身，如果它是尾递归，则主要是在自身的末尾。

因此，您的 count 函数会检查输入参数是否 > 0，如果是，它将调用`count(m-1)`. `count` 现在它从m=9的顶部开始。它做同样的事情，然后用 m=8 调用 count 等。

直到达到结束条件，通常应该在您的功能中明确满足，例如`if (m == 0) return m;` 或一些这样的事情。此时递归结束，函数终止。

另外，`count` 应该有一个返回类型，例如`int count (int m)`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-04T14:51:24.663

> 语句 return count(m-1) 是什么意思？它在哪里转移控制权？

这似乎是你唯一的问题。

这意味着它正在调用值为 m-1 的“count”。所以如果 m 是 10，那么它用 9 调用“count”。

它将控制递归地转移到计数方法。

在“count”方法中，您也没有返回每个可能的路径。如果 m <= 0 会发生什么？