# StackOverflow 问答 000912000-000912999

# iphone - 在 Objective C 中声明、属性、合成和实现 int[] 数组

> ID：912016
> 
> 赞同：7
> 
> 时间：2009-05-26T18:23:22.023
> 
> 标签：iphone, objective-c, arrays, primitive

如何在 Objective C 中声明、设置属性、合成和实现一个大小为 5 的 int 数组？我正在为 iphone 应用程序编写此代码。谢谢。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-26T19:41:56.297

我认为“Cocoa-y”要做的事情是隐藏 int 数组，即使您在内部使用它也是如此。就像是：

```
@interface Lottery : NSObject {
    int numbers[5];
}

- (int)numberAtIndex:(int)index;
- (void)setNumber:(int)number atIndex:(int)index;
@end

@implementation Lottery

- (int)numberAtIndex:(int)index {
    if (index > 4)
        [[NSException exceptionWithName:NSRangeException reason:[NSString stringWithFormat:@"Index %d is out of range", index] userInfo:nil] raise];
    return numbers[index];
}

- (void)setNumber:(int)number atIndex:(int)index {
    if (index > 4)
        [[NSException exceptionWithName:NSRangeException reason:[NSString stringWithFormat:@"Index %d is out of range", index] userInfo:nil] raise];
    numbers[index] = number;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2011-11-17T21:20:01.903

这里有一些东西可以尝试。在 .h 文件中：

```
@property int* myIntArray; 
```

然后，在 .m 文件中：

```
@synthesize myIntArray; 
```

如果您使用@synthesize，您可能需要自己 malloc/calloc 数组，可能在 init() 期间。

或者，您可以编写自己的访问器函数，如果在分配数组之前调用它们，则使用 malloc/calloc。

无论哪种方式，您都需要在 dealloc() 方法中释放数组。

这可能是天真和错误的，因为我自己只是在学习 Objective C，但到目前为止它似乎对我有用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-26T18:59:14.417

如果要使用数组，则不应在这种情况下使用 int 。使用 NSNumber 并将这 5 个 NSNumber 放入 NSMutableArray。

```
@interface testClass: NSObject {
     NSMutableArray* numbers;
}
@property (nonatomic, retain) NSMutableArray* numbers;
-(id)initWithValue:(NSNumber *)initialValue;
@end

@implementation testClass
@synthesize numbers;
-(id)initWithValue:(NSNumber *)initialValue {
     numbers = [[NSMutableArray alloc] initWithCapacity:5];
     [numbers addObject:initialValue];
     return self;
 }
@end 
```

是带有合成的接口和实现的代码（未测试 BTW）。你想达到什么目的？

[很好的快速介绍](http://www.otierney.net/objective-c.html)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-10-04T23:02:35.723

我有一个类变量：

```
NSInteger myInt[5]; 
```

为了在代码中使用正常的 myInt[1]=0 语法，我创建了一个返回整数指针的属性：

```
@property (nonatomic, readonly) NSInteger *myInt; 
```

然后创建了以下getter方法：

```
-(NSInteger *) myInt {
  return myInt
} 
```

现在我可以使用类似 class.myInt[1]=0;

好吧，我不确定这是否有效，但似乎可以。我只是想如果其他人想尝试的话，我会把它放在那里。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-02-20T18:34:18.890

无论你做什么，你都必须意识到后果。

整数数组不进行引用计数。你不知道有多少人在访问它。你不知道谁应该在什么时候释放它。所以你可以很容易地拥有一个 int* 类型的属性。setter 将获取一个指针并将其存储到实例变量中。getter 将返回实例变量的内容。它只是工作。

但是您不知道何时应该分配或释放数组。如果您有一些静态数组（例如四个包含数字的不同表），没问题。但是如果你用 malloc() 创建一个整数数组，就应该有人 free() 它。那么这会发生在什么时候呢？

Because having to handle the lifetime of an array manually is rubbish, I'd recommend that you either just use an NSArray of NSNumber, or you look at NSPointerArray which can be abused to store arrays of integers with reference counting, or you create your own class like the Lottery class in a previous answer, just a bit more flexible.

# .net - Linq 和 DB 关系

> ID：912017
> 
> 赞同：0
> 
> 时间：2009-05-26T18:23:39.853
> 
> 标签：.net, sql-server, linq-to-sql

在这里快速提问。

我正在使用一个较旧的数据库，该数据库没有任何关系，现在正试图使其尽可能一致。

我移植的代码有一些怪癖，导致我无法强制执行关系（PK <-> FK）。我想知道这种强制关系是否是 Linq to SQL 的要求？

谢谢你的帮助:)

* * *

正如我评论其中一个可能的答案...

问题要简单得多：

linq 是否允许获取未强制执行一致性的关系上的数据？我不是在谈论添加更多道具...

这意味着我认为确实具有正确 PK<->FK 关系的值的功能（正如我所说的，我没有对此进行测试，也许你们中的一些人有？）。这对不存在的值有什么作用？提出一个空引用？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-26T18:29:55.130

自动生成的 LINQ to SQL 类（位于 dbml 下的 .cs 文件中）是[部分](http://msdn.microsoft.com/en-us/library/wa80x488(VS.80).aspx)的，因此您可以根据需要添加其他属性和功能。

LINQ 使用 SQL 中的显式关系来添加属性 - 例如，如果您有一个 Customers 表和一个具有显式关系的 Orders 表，则 LINQ 将能够将强类型 Orders 集合作为 Customer 对象的属性。没有它，它只能将 CustomerID（int 或其他）放在 Order 对象上。

在没有显式关系的情况下，您可以手动将属性和属性装饰添加到自动生成的实体类中。我强烈建议在部分类中尽可能多地放置，这样在重新生成实体类时更改不会丢失。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-26T18:57:53.030

数据库中的关系不是必需的。设计器使用它来推断您自动获得的关系“属性”，但您可以添加自己的并指示哪些标量属性标识两个表中的关系。（右键单击设计器，选择“添加关系”并识别表和列，或使用“关系”工具拖放）

不过要小心。如果您的问题是应用程序存储“占位符值”以识别“无关系”（例如在主键表中没有对应项的零值），那么如果您尝试访问相应的成员，最终可能会引发异常编码。

如果问题是原始应用程序以错误的顺序存储内容（因此阻止您强制执行 FK 约束），但是当一切都说完之后，您拥有一致的数据，那么您应该没有问题。

# keyboard-shortcuts - Web 应用程序中的快捷键

> ID：912018
> 
> 赞同：19
> 
> 时间：2009-05-26T18:23:42.007
> 
> 标签：keyboard-shortcuts

我正在考虑在我的 Web 应用程序中创建一些键盘快捷键。但是，大多数重要的快捷方式已经附加到浏览器本身（如`F1`, `F2`, `Fn`; `Ctrl`+ `N`; `Ctrl`+ `P`, `Alt`+ `P`, `Alt`+`A`等...）

我注意到浏览器不使用任何`Shift`组合。但是，`Shift`已经保留输入大写字母，所以，我认为使用`Shift`+`Key`组合不是一个好主意。

**是否有一些指导方针可以在网络上编写键盘快捷键？**

或者，我应该放弃使用它吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-26T18:37:39.593

如果它是一个很多人每天都在使用的内部应用程序，那么键盘快捷键可以极大地提高工作效率。

它们是什么并不重要，因为高级用户无论如何都会学习它们。然而，最安全的使用是箭头键。另外，`Ctrl`+`⇧</kbd> + `ANY LETTER` are usually safe.`

如果它是一个内部应用程序，您还可以（通常）为一组浏览器/配置/版本进行开发。这也可以更容易地映射键绑定。

# python - 如何在 Python 中查找所有子模块？

> ID：912025
> 
> 赞同：13
> 
> 时间：2009-05-26T18:25:15.937
> 
> 标签：python, module, package, python-import

虽然在 Python 中将“子”模块导入另一个模块并列出其属性相当简单，但当您想要导入*所有*子模块时会变得稍微困难​​一些。

我正在为现有的 3D 应用程序构建一个工具库。每个工具都有自己的菜单项和子菜单。我希望该工具负责创建自己的菜单，因为其中许多菜单会根据上下文和模板而变化。我希望我的基本模块能够找到所有子模块并检查一个`create_menu()`函数并在找到它时调用它。

发现所有子模块的最简单方法是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2011-09-06T13:44:00.340

我认为做这种插件的最好方法是使用[`entry_points`](http://pythonhosted.org/setuptools/setuptools.html#dynamic-discovery-of-services-and-plugins)API[来查询它们](http://pythonhosted.org/setuptools/pkg_resources.html#convenience-api)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-26T18:37:09.343

当我还是一个刚开始用 Python 编程的人时，我已经为我的模块化 IRC 机器人编写了这个：

```
 # Load plugins

    _plugins = []

    def ifName(name):
        try:
            return re.match('([^_.].+)\.[^.]+', a).group(1)
        except:
            return None

    def isValidPlugin(obj):
        from common.base import PluginBase
        try:
            if obj.__base__ == PluginBase:
                return True
            else:
                return False
        except:
            return False

    plugin_names = set(ifilter(lambda a: a!=None, [ifName(a) for a in os.listdir(os.path.join(os.getcwd(), 'plugins'))]))
    for plugin_name in plugin_names:
        try:
            plugin = __import__('plugins.'+plugin_name, fromlist=['plugins'])
            valid_plugins = filter(lambda a: isValidPlugin(a), [plugin.__getattribute__(a) for a in dir(plugin)])
            _plugins.extend(valid_plugins)
        except Exception, e:
            logger.exception('Error loading plugin %s', plugin_name)

    # Run plugins

    _plugins = [klass() for klass in _plugins] 
```

这不是安全或“正确”的方式，但也许它仍然有用。这是**非常**古老的代码，所以请不要打败我。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-09-07T17:48:02.477

只要您将每个插件实现为基于文件系统的模块，上述遍历文件系统以查找子模块的解决方案就可以了。

一种更灵活的方法是在主模块中显式地列出插件列表，并让每个插件（无论是由文件创建的模块、动态创建的模块，还是类的实例）都显式地将自身添加到该列表中。也许通过 registerPlugin 函数。

请记住：“显式胜于隐式”是 python 禅宗的一部分。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-09-04T17:30:33.557

[`pkgutil.walk_packages()`](https://docs.python.org/3/library/pkgutil.html#pkgutil.walk_packages)似乎是这样做的正确方法。以下是我如何找到可用模块列表，然后导入其中一个：

```
$ mkdir foo
$ touch foo/__init__.py
$ touch foo/bar.py
$ python
Python 3.8.2 (default, Jul 16 2020, 14:00:26) 
[GCC 9.3.0] on linux
Type "help", "copyright", "credits" or "license" for more information.
>>> import foo
>>> from pkgutil import walk_packages
>>> list(walk_packages(foo.__path__))
[ModuleInfo(module_finder=FileFinder('/home/don/git/zero-play/zero_play/foo'), name='bar', ispkg=False)]
>>> from importlib import import_module
>>> bar = import_module('foo.bar') 
```

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2009-05-26T18:41:25.047

您可以尝试`glob`bing 目录：

```
import os
import glob

modules = glob.glob(os.path.join('/some/path/to/modules', '*.py')) 
```

然后你可以尝试导入它们：

```
checked_modules
for module in modules:
    try:
        __import__(module, globals(), locals()) # returns module object
    except ImportError:
        pass
    else:
        checked_modules.append(module) 
```

* * *

## 回答 #6

> 赞同：-2
> 
> 时间：2009-05-26T18:34:05.670

使用[dir()](http://docs.python.org/library/functions.html#dir)和[imp 模块](http://docs.python.org/library/imp.html)

# visual-studio - 将 .SQL 文件与 VS T-SQL 编辑器重新关联

> ID：912028
> 
> 赞同：1
> 
> 时间：2009-05-26T18:25:45.093
> 
> 标签：visual-studio, tsql, editor

我似乎失去了从 .sql 文件到默认 VS T-SQL 编辑器的关联。我正在使用 Visual Studio 2008。当我打开一个 .sql 文件时，它使用文本编辑器打开，没有语法高亮显示。在 Visual Studio 中，如何将所有 .sql 文件与默认的 T-SQL 编辑器重新关联？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-07-08T11:23:30.443

编辑注册表，从键中复制 GUID

```
HKLM\SOFTWARE\Microsoft\VWDExpress\9.0\Languages\Language Services\T-SQL\Default 
```

在中创建新密钥 .sql

`HKLM\SOFTWARE\Microsoft\VWDExpress\9.0\Languages\File Extensions`

并且默认值从第一步设置为 GUID。

重启VS

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-02T16:26:29.807

If you are not in a "SQL Server Project" you don't have the T-SQL Editor (Default Project Editor), just the default one. You can always use the default text editor which is not much different.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-01T08:01:32.197

您需要从 ISO 安装或重新安装一些 SQL 文件，我只花了 2 分钟。即：

探索 ISO 并进入 WCU 文件夹，然后进入 DAC 文件夹并安装以下文件：

DACFramework_enu DACProjectSystemSetup_enu TSqlLanguageService_enu

这对我有用。我正在使用 VS 2010 和 SQL Server 2008 R2

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-08-14T22:23:59.547

谢谢帕维尔，就像一个魅力。就我而言，我从

> HKLM\SOFTWARE\Microsoft\VisualStudio\9.0\Languages\Language Services\T-SQL90\Default

并创建了一个新的 .sql 键

> HKLM\SOFTWARE\Microsoft\VisualStudio\9.0\Languages\文件扩展名

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-26T18:29:23.573

在文件资源管理器中，右键单击 .sql 文件，选择“打开方式”然后“选择程序...”，选择 VS 并选中“始终使用...”

# sql-server-2005 - 我可以使用 DTUTIL 将 SSIS 包部署到文件系统吗？

> ID：912035
> 
> 赞同：1
> 
> 时间：2009-05-26T18:27:28.850
> 
> 标签：sql-server-2005, ssis

我有一个名为 Extract.dtsx 的 SSIS 包。我想将它部署到 F:\SQL2005\MSSQL\Package\Extract 中的文件系统。

包安装向导很简单。我只需要选择“文件系统部署”并选择路径，然后单击几次下一步即可完成。我无法确定是否可以使用 DTUTIL 来做同样的事情。

有人知道这是否可能吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-27T13:28:26.910

是的，这是可能的。我不确定我做错了什么。

如果您有 SSIS 包 C:\temp\Extract.dtsx，则可以使用以下命令将其部署到 F:\SQL2005\MSSQL\Package\Extract 中的文件系统：

```
c:\temp\md F:\sql2005\mssql\package\Extract
c:\temp\dtutil /file Extract.dtsx /Copy FILE;F:\sql2005\mssql\package\Extract\Extract.dtsx 
```

目标文件夹必须已经存在。

您可以通过连接到服务器上的 SSIS 在 SQL 企业管理器中查看包，打开存储包 > SSIS 应用程序包 > 提取。

# php - .htaccess ModReWrite 帮助

> ID：912037
> 
> 赞同：0
> 
> 时间：2009-05-26T18:28:17.380
> 
> 标签：php, .htaccess, mod-rewrite, friendly-url

我的重写代码遇到了一些问题。请注意，.htaccess 文件位于子域文件夹 (...public_html/subdomain/ )

我只是想重写一个页面请求：

```
http://subdomain.mysite.com/home
http://subdomain.mysite.com/index.php?page=home 
```

我的 .htaccess 文件看起来像这样......

```
RewriteEngine On
RewriteRule ^/([A-Za-z0-9\-\_])$ /index.php?page=$1 
```

有什么东西冲着你跳出来吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-26T18:29:58.720

您当前的规则可能适用于一个字符长的网址（斜线之后）！

添加 a`+`来表示一个或多个字符，或添加 a 来表示`*`零个或多个

尝试

```
RewriteEngine On
RewriteRule ^/([A-Za-z0-9\-\_]*)$ /index.php?page=$1 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-26T18:38:33.647

如果要在 .htaccess 文件中使用规则，则需要从`RewriteRule`模式中去除上下文的每个目录路径前缀。如果 .htaccess 文件位于文档根目录`/`中，则需要去掉前导`/`。

此外，您需要量化字符集。否则它只会描述*一个*字符。

所以试试这个规则：

```
RewriteRule ^([A-Za-z0-9-_]+)$ index.php?page=$1 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-11-22T19:48:35.930

我认为

```
RewriteRule ^([^/]*)$ /index.php?page=$1 [L] 
```

没关系；）

# c# - 如何使用 System.DirectoryServices.AccountManagement 将用户添加到 AD？

> ID：912040
> 
> 赞同：4
> 
> 时间：2009-05-26T18:28:31.717
> 
> 标签：c#, vb.net, active-directory, directoryservices

使用 .net 3.5 框架和 C# 我正在尝试从 C# 向 AD 添加新用户，但找不到任何示例。我看到 PrincipalCollection 对象有一个重载的“添加”方法，但似乎无法弄清楚它是如何工作的。任何人都可以帮忙吗？

如何创建一个新的用户对象，将其添加到 AD 中。

其次，将要添加新人的用户实际上可能没有这样做的安全性。有没有一种方法可以模拟另一个具有权限的用户帐户并以这种方式添加帐户？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2016-06-01T09:52:28.447

您可以像这样添加用户：

```
using (var context = new PrincipalContext(ContextType.Domain))
using (var user = new UserPrincipal(context)
{
    UserPrincipalName = "username",
    Enabled = true
})
{
    user.SetPassword("password");
    user.Save();
} 
```

回复：安全性，您可以将应用程序池标识设置为使用有权写入 Active Directory 的特权服务帐户。或者，您可以使用构造函数重载来`PrincipalContext`获取 LDAP 连接的用户名和密码。

# .net - LINQ 实体作为业务对象 - 优点/缺点

> ID：912054
> 
> 赞同：3
> 
> 时间：2009-05-26T18:30:33.040
> 
> 标签：.net, linq, entity, domain-model

Visual Studio (sqlmetal) 生成的 dbml 文件带有映射到数据库表的实体。在您看来，这些类适合用作领域模型类吗？还是我们应该避免它们并将它们仅隔离到数据访问层？

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-26T18:40:01.537

在大多数情况下，实体对象和编写 SQL 之间的甜蜜层*是*您的 DAL。LINQ 的全部目的是允许您的 DAL 比过去更富有表现力的构造。

如果没有 LINQ，在您的 BL 中，您可能仅限于方法调用，例如`GetCustomersByLastName(string)`针对您的 DAL。您编写该方法的唯一原因是因为在您的 BL 中的某个地方，您需要按姓氏获取客户。这意味着您的 DAL 合同明确由 BL 的需求驱动。而使用 LINQ，您可以摆脱 BL 需求和 DAL 合同之间的具体依赖关系。DAL 可以完全不知道具体的用途；它只是暴露了实体的合同及其关系，BL随意使用它们，而不关心它们的数据实现。这才是**真正**的关注点分离。

如果您将 LINQ 的强大功能隐藏在传统 DAL 后面，那么使用 LINQ 有什么意义呢？

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-26T18:39:56.827

对于一个足够简单的应用程序，直接使用 LINQ 实体的最大优点是 - 简单。您可以避免在代码中包含又一层，您可以避免编写大量样板逻辑来从业务对象映射到 LINQ 实体（尽管有像[AutoMapper](http://www.codeplex.com/AutoMapper)这样的工具在这里可以提供很大帮助）。

另一方面，正如您所说 - 您的数据库可能不是您的域模型的吐痰图像。再说一次，如果您需要这种能力在给定的物理数据库模型和逻辑域模型之间进行映射，也许您应该看看实体框架？这正是 EF 的支柱——这两个模型以及它们之间的映射层。

马克

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-26T18:39:05.220

**这取决于**

如果您的领域对象非常**简单**并且您的项目很小，那么使用这些类不是问题。编写一个仅重复这些类的整个额外层将是浪费时间。

如果对象很**复杂**并且不以一种严格的方式映射，那么另一个层对于将这些细节与数据访问层分开是必不可少的。

如果你真的不确定，你可以直接开始使用它们，然后在你明显需要它时添加另一个层。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-02-02T10:25:22.257

我认为这取决于场景。

我现在正在编写一个 WCF 服务，我的数据模型不是很复杂，但是所有表都有外键，并且表之间的关系使 linq 创建了一个非常复杂的对象树。

从客户端的角度来看，检索所有这些对象树是没有意义的，而且返回的 xml 消息也会很重（所以如果我不更改消息大小最大允许值，我会出错）。

在这种情况下，我必须在 LINQ 对象上创建自定义视图，以仅返回客户端期望检索的数据。这很痛苦，因为我不得不重新编写大部分实体，但最终我可以完全控制与客户的沟通。

# sql - 如何创建一个对 PGSQL 中的键唯一的自动递增修订号？

> ID：912057
> 
> 赞同：2
> 
> 时间：2009-05-26T18:31:58.903
> 
> 标签：sql, postgresql, sequence, constraints

假设我有以下表格。

```
PARENT: PARENT_ID serial, DESCRIPTION character varying(50)

CHILD: PARENT_ID integer, CHILD_ID integer, DESCRIPTION character varying(50) 
```

我想看到的是 CHILD 中的每一行都有一个 CHILD_ID，它从 1 开始并以 1 递增，每个 PARENT_ID 都是唯一的。它类似于修订号。例如..

```
PARENT_ID 1, CHILD_ID 1
PARENT_ID 1, CHILD_ID 2
PARENT_ID 1, CHILD_ID 3
PARENT_ID 2, CHILD_ID 1
PARENT_ID 3, CHILD_ID 1
PARENT_ID 3, CHILD_ID 2 
```

有没有办法自动分配 CHILD_ID 值，例如序列或约束，只有能够重用已删除的 CHILD_ID？我能弄清楚的唯一方法是影响这个 SQL 的效果。

```
INSERT INTO child SELECT parent_id, MAX(child_id)+1, 'description' FROM child WHERE parent_id = :PARENT_ID GROUP BY parent_id 
```

不过，这有点骇人听闻。我意识到数据库规范化表明您不应该将一个密钥与另一个密钥相关联，但由于其他一些原因，我没有该选项。有任何想法吗？

**编辑：**标题很难看。如果有高分的人能想到一个更准确的，请随时更改。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-27T08:35:02.383

我建议使用：

```
CHILD: PARENT_ID integer, CHILD_ID serial, DESCRIPTION character varying(50) 
```

当你需要得到想要的结果时：

*   您可以在客户端计算行数。

*   选择 PARENT_ID=? 的行时 您可以使用临时序列。

*   在即将发布的 Postgresql 8.4 中，您可以使用如下窗口函数：

    ```
    $ create table child (parent_id integer, child_id serial);
    NOTICE:  CREATE TABLE will create implicit sequence "child_child_id_seq" for serial column "child.child_id"
    CREATE TABLE

    $ insert into child (parent_id) values (1), (1), (1), (2), (3), (3);

    $ select * from child;
     parent_id | child_id 
    -----------+----------
             1 |        1
             1 |        2
             1 |        3
             2 |        4
             3 |        5
             3 |        6
    (6 rows)

    $ select parent_id, row_number() over (partition by parent_id order by child_id) from child;
     parent_id | row_number 
    -----------+------
             1 |          1
             1 |          2
             1 |          3
             2 |          1
             3 |          1
             3 |          2
    (6 rows) 
    ```

它非常快速，易于实现，并且可以很好地扩展，因为不会担心并发问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-26T19:46:45.257

不过，该插页并不是故事的全部。如果您真的希望数字是连续的，您还需要处理删除以缩小创建的差距。

我的建议是根据需要得出这个值。什么决定了数字的顺序？如果它是输入系统的日期，然后将该日期添加到您的表中，并将您的 PK 放在 parent_id 和该日期上，那么您可以很容易地通过 SQL 或根据需要在前端找到数字。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-26T20:24:20.377

您可以在父表上使用递增的版本号，并将子 id 设置为该值并递增它。您可能需要更新父行并在单个事务中插入子行。

```
BEGIN
-- Get and hold onto parent_id and version values.
SELECT PARENT_ID, VERSION FROM PARENT WHERE PARENT_ID = :PARENT_ID;
-- Use the values to insert into the child table
INSERT INTO CHILD (PARENT_ID, CHILD_ID) VALUES (:PARENT_ID, :VERSION);
-- Update the version using an optimistic lock.
UPDATE PARENT SET VERSION = VERSION + 1 WHERE PARENT_ID = :PARENT_ID AND 
                                              VERSION = :VERSION_ID
-- If no rows are updated rollback the transaction and try again.
END 
```

这将确保子 id 严格升序，但不会在删除后重用 id 值。如果您可以避免重用旧 id 的限制，它将简化您的解决方案（并且解决方案将更有效）。如果您**必须**重用 id，那么您有 2 个选项，首先是您在上面指定的解决方案，但在删除时重新编号在您删除的值之后出现的所有值。另一种选择是使用某种函数按顺序扫描子 ID，并将它们与一组序列号进行比较，并在未找到第一个时返回该值。这两种解决方案都更复杂并且速度很慢，因为您需要取出行锁以防止并发更新，并且插入或插入和删除都会导致 O(n) 损失。

# oracle - 从哪个 CEP 产品开始？

> ID：912059
> 
> 赞同：12
> 
> 时间：2009-05-26T18:32:05.017
> 
> 标签：oracle, esper, complex-event-processing

我想了解有关如何构建基于 CEP 的应用程序的更多信息。所以我环顾四周，发现了几个产品（在这里找到概述：[http](http://rulecore.com/CEPblog/?page_id=47) ://rulecore.com/CEPblog/?page_id=47 ）。

但由于目前有很多，我不知道哪个是最好的开始。总的来说，我只会考虑免费提供的那个。其余的对于私人使用来说有点贵；）

Esper 是免费的，但是没有 Esper 工作室，开发一个 cep 应用程序似乎很乏味。Streambase 提供免费试用，但我不知道您可以使用多长时间（如果只有一个月，对更长时间的研究没有帮助）。Oracle CEP 套件似乎相当完整，但在 cep 场景中——据我所知——与 Esper 或 Streambase 相比，它是最不被认可的。

那么您对开始 cep 开发的最佳方式有什么提示吗？花时间研究 oracle 文档是否值得，还是从 Esper 或 Streambase 开始更好？

干杯，

安德烈亚斯

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-11-23T15:57:06.523

Microsoft 的 CEP 提供的[StreamInsight](http://msdn.microsoft.com/en-us/library/ee391416%28SQL.105%29.aspx)非常类似于[Rx 框架](http://msdn.microsoft.com/en-us/devlabs/ee794896.aspx)和 LINQ 的反应式编程模型。

[StreamInsight 查询的漫游指南](http://go.microsoft.com/fwlink/?LinkID=196346&clcid=0x409)是一个很好的起点。

[一些代码示例](http://streaminsight.codeplex.com/releases/view/90143)

我建议使用可以连接到 Stream Insight 的[LINQPad](http://www.linqpad.net/)作为查询的画布。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-05-27T12:19:56.517

当前的 CEP 工具不能解决相同的问题！因此，根据您喜欢做什么，您会喜欢使用不同的工具。简而言之，我个人的选择是：

为了构建数据驱动的算法，使用一种带有扩展的 SQL 进行编码 - Aleri 的 Coral8 引擎。免费进行测试和开发（无论如何在被 Aleri 收购之前）

用于检测事件模式（情况），无需编码（声明式），但使用 XML 进行配置 - RuleCore，免费测试订阅（Web）服务

混合使用 Java 中的低级控制和编码 - Esper，GPL。

用于使用 GUI 的图形框和箭头样式创建数据驱动的计算逻辑：StreamBase。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-26T22:21:39.047

我认为最好的选择是比较免费提供的解决方案，然后用它们做点什么。

我不确定你的最终目标是什么，如果是学习你在工作中使用的技术，或者只是为了玩一些很酷的东西，但对我来说，在这样的项目中，决定因素是我可以使用哪种工具做一些我可以与世界分享的东西。

在这种情况下，我的选择可能是 Esper 或 OpenESB。这样，我可以将项目放在简历上（尤其是当我申请使用 CEP 工具的工作时）并与全世界分享。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-27T07:01:05.493

您可以阅读 Curt Monash 的博客 ( [http://www.dbms2.com](http://www.dbms2.com) )，他写了有关 CEP 之类的内容。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-27T09:51:47.830

是否有兴趣免费订阅 ruleCore（云、SaaS 或今天所称的任何东西）服务？它将在更小、更不可靠（无集群）的硬件上运行，并且可能仅可用于测试小型低性能类型的东西。如果 support@rulecore.com 收到一些此类请求，我确信它已被列入待办事项列表......

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2010-02-17T06:39:12.397

对于检测事件模式，我发现 rulecore 非常易于使用。我只尝试检测低复杂度和中等复杂度的模式，并且效果很好。习惯这些概念需要一些时间，但它实际上是一个非常小的系统，所以还不错。而且您需要喜欢 XML，因为一切都是使用 XML 完成的。

如果您正在尝试创建一个交易应用程序，那么 StreamBase 会更好。但是对于监控东西，rulecore 感觉更好。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2014-09-11T06:05:21.453

如果您有连续的流（市场信息、物联网传感器、Twitter、新闻等），那么流处理技术是您的正确选择。流处理/流分析只是不同 CEP 解决方案（流、规则、模式等）的一部分。

同时，有几个用于流处理的开源选项，例如 Apache Storm、Apache Spark 或 Apache Samza，还有强大的专有产品，例如 IBM InfoSphere Streams、TIBCO StreamBase 或 Software AG 的 Apama。

请分别查看我的博客文章，了解有关不同流处理和流分析解决方案（开源和专有）的更多详细信息：

[流处理和流分析替代方案的比较（Apache Storm、Spark、IBM InfoSphere Streams、TIBCO StreamBase、Software AG Apama）](http://www.kai-waehner.de/blog/2014/09/10/comparison-stream-processing-streaming-analytics-alternatives-apache-storm-spark-ibm-infosphere-streams-tibco-streambase-sag-apama/)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2010-05-24T07:24:55.803

我将从 Aleri Coral8（目前是 Sybase）的免费试用开始

# c# - 如何将图片保存在数据库中？

> ID：912062
> 
> 赞同：3
> 
> 时间：2009-05-26T18:34:30.333
> 
> 标签：c#, .net, wpf, linq

我正在研究 Linq To Sql、WPF 并且我有一个数据库现在我需要在数据库中保存一些图片但我不知道哪个是保存图片的正确数据类型数据库（该数据库将由 10 个用户连接在同一时间）。你能指出我克服这一步的正确方法吗？如果我没记错的话，将图片保存在数据库中不是一个好主意，但如果你能建议我一个更好的方法，我会应用它。非常感谢您的宝贵时间。

很好的问候

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-26T18:43:26.337

您可以使用 'varbinary(MAX)' 或 'image' 列类型。Linq2Sql 将自动生成一个使用 Binary 对象来包装图像的类。Binary 对象只是一个字节[] 的包装器。

```
myObject.Image = new Binary(imageByteArray); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-26T18:38:19.390

将图片存储为 blob，包含图像的类中定义的变量可以是 byte[] 流。或者，您只需将图片的引用存储在数据库中并将图像存储在文件服务器上。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-26T18:45:00.593

通常，您将在数据库端使用 varbinary(max) - 或小于 max- 并且您将在您的类中使用 byte[] 类型。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-27T14:59:42.107

当人们谈论这个时会发生很多激烈的辩论，我想指出您可能需要考虑将该路径存储到数据库中的网络文件夹中。

将实际图像存储在数据库中的缺点是所有这些字节都必须通过 sql 查询来回发送，如果这些图像很大，您将大大增加数据库的大小。以及上面提到的奇怪的事情。

无论如何，我不想打开一罐蠕虫，只是想展示一个替代方案。

更新：

像这样的东西：

```
public partial class LinqClass
{
    public string ImagePath { get; set; }

    public System.Drawing.Image Picture
    {
        get
        {
            return System.Drawing.Image.FromFile(ImagePath);
        }
    }
} 
```

其中 ImagePath 是将文件路径保存到的数据库中的实际列。这没有保存文件的代码（例如 File.Save(ImagePath) 等，但这是一个开始。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-26T18:39:31.990

我从来没有用 Linq 做过，但我们对图像使用了 b64 转换，然后是 clob 数据类型。然后在要查看图像时反转 b64。

# .net - Visual Studio 的 JUnit Max 等效工具

> ID：912064
> 
> 赞同：10
> 
> 时间：2009-05-26T18:36:29.110
> 
> 标签：.net, visual-studio, unit-testing

我一直在尝试寻找类似于[JUnit Max](http://www.junitmax.com/junitmax/subscribe.html) for Visual Studio 的工具。

该工具最好与 Visual Studio 2008 Professional 和 NUnit 一起使用。

对于那些显然无法点击进入 JUnit Max 站点的人，这里是描述。

> JUnit Max 是 Eclipse 的一个持续测试插件，它通过智能地运行测试和不显眼地报告结果来帮助程序员专注于编码。每次保存 Java 文件时，Max 都会运行您的测试并以与编译错误相同的格式报告错误。
> 
> Max 快速失败，运行最有可能首先失败的测试。即使您有一个长时间运行的测试套件，您也只需在返回编码之前密切关注测试结果一秒钟（字面意思）

试着这样想……

Visual Studio 检测并突出显示语法错误。我希望看到 IDE 中突出显示的单元测试错误，就像语法错误一样。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-01T20:16:36.070

它不是一个插件解决方案，但 NUnit GUI 运行器可以满足您的需求。您可以更改设置，以便在修改测试程序集时重新运行上次测试运行。因此，当您重新编译时，所有测试都将再次运行（假设您的最后一次测试运行当然会运行每个测试）。

如果你已经在使用 NUnit，你可能已经有了这个设置，但你也可以将 GUI 运行器作为外部工具添加到 Visual Studio，这样你就可以在 Visual Studio 中打开它，并且已经加载了你的测试程序集。同样，这种集成可以从 GUI 运行器的设置对话框中实例化。

NUnit 网站上提供了更多信息，我会链接它，但我太新用户了！

**编辑：**另一个解决方案是向您的项目添加一个构建后事件，将您的测试程序集传递给 NUnit 运行器。[如此处](http://www.csharptocsharp.com/visual-studio-automate-unit-testing)所述。不过，我很欣赏这仍然没有解决测试优先级方面的问题。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2011-09-16T08:21:07.990

是的，有一个！

看看[NCrunch](http://www.ncrunch.net/)。它在后台运行您的测试，甚至在您输入时更新覆盖率信息。

他们的网页上有屏幕投屏。目前它处于测试阶段并且是免费的；但我想，他们很快就会收费。不过，我很确定它物有所值。

**NCrunch** （供应商信息！）

> NCrunch 是 Visual Studio .NET 的自动化并行连续测试工具。它智能地负责运行自动化测试，因此您不必这样做，并且在您工作时，它会在您的 IDE 中为您提供大量有用的测试信息（例如代码覆盖率）。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2010-09-13T22:24:28.687

自从看到 junitmax 在 Eclipse 上运行以来，我一直在寻找同样的东西，据我所知，.net 平台还没有类似的东西:(

最好的可用解决方案似乎是“在编译时运行测试”。有一篇关于[“极端持续集成”](http://www.chrisedwards.dreamhosters.com/blog/2010/06/13/extreme-continuous-integration-a-personal-ci-build-for-visual-studio-part-1/)的有趣博客文章。您至少可以通过这种方式在单独的机器上运行测试。

还要留意[强大的驼鹿](http://www.continuoustests.com/)

一些关于它的博客文章在[这里](http://skillsmatter.com/podcast/design-architecture/mighty-moose)和[这里](http://abdullin.com/journal/2010/11/11/mighty-moose-smart-continuous-unit-tests-for-net-and-mono.html)它有一个更正式的名称，但我不记得它现在是什么了。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2010-12-01T08:53:45.650

这方面有很多项目：

[http://ox.no/software/continuoustesting](http://ox.no/software/continuoustesting)

[http://quicktest.codeplex.com/](http://quicktest.codeplex.com/)

和别的 ：）

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-02T19:17:08.017

Team City 将允许您运行个人构建，因此它不会签入损坏的代码。只有在所有单元测试通过后，它才会检查代码。这就是你所追求的吗？

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-26T18:42:06.293

我认为您想自动从存储库中检出您的代码，编译它，运行所有单元测试并通过电子邮件向所有项目成员发送报告？对？

如果是这样，您正在搜索错误的术语。您正在寻找“持续集成”。

尝试以下产品： [CruiseControl.NET](http://confluence.public.thoughtworks.org/display/CCNET/Welcome+to+CruiseControl.NET)或[TeamCity](http://www.jetbrains.com/teamcity/index.html)。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-06-09T02:10:06.550

我知道没有等效的 Visual Studio，但如果您是 IntelliJ 用户，则可以使用[Infinitest](http://infinitest.org)。Infinitest 也是免费的，这是一个不错的福利。

* * *

## 回答 #8

> 赞同：-2
> 
> 时间：2009-05-26T18:42:12.453

你看过[CruiseControl](http://cruisecontrol.sourceforge.net/)

我没有亲自使用过它，但我以前工作的另一个开发团队将它用于他们项目的持续集成/持续构建。

有一篇关于 CodeProject 的好文章 re：[Continuous Integration with CruiseControl.net](http://www.codeproject.com/KB/testing/ContinuousIntegration.aspx)也涵盖了 NUnit 测试和 CHM 文档构建

* * *

## 回答 #9

> 赞同：-2
> 
> 时间：2009-06-02T18:43:03.547

如果我理解正确，您正在寻找类似 ReSharper 的东西。ReSharper 有一个非常好的集成单元测试运行程序，可让您运行完整的套件或单独的测试。它有一个很好的测试结果浏览器，可以很容易地跳到导致异常和诸如此类的代码。ReSharper 不是免费的，但除了集成单元测试之外，它还提供了大量与 Visual Studio 集成的其他可用性功能和改进。

如果 TestDriven.NET 不够好，ReSharper 肯定会满足您的需求。

* * *

## 回答 #10

> 赞同：-2
> 
> 时间：2009-06-09T10:52:21.220

我认为您正在使用 NUnit 搜索[MSBuild](http://www.zorched.net/2006/11/28/msbuild-with-nunit/)，

# jquery - 如何使用 jQuery 访问 API

> ID：912066
> 
> 赞同：1
> 
> 时间：2009-05-26T18:36:55.257
> 
> 标签：jquery, ajax

jQuery 有很酷的方法，比如 getJSON、get 和 load。然而，他们最终都进行了 AJAX 调用。

我正在尝试访问 API www.eventsinindia.com/cities/mumbai/events.js?month=2009-05 。

此 API 调用以 JSON 格式返回数据。

我找不到任何从 jQuery 调用此 API 并以 JSON 格式获取输出数据的方法。我不断收到拒绝访问受限 URI”代码：“1012 错误，因为 jQuery 正在尝试进行 AJAX 调用。禁止从独立页面到服务器的 AJAX 调用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-26T18:40:00.727

由于它位于不同的域中，您是否使用 JSONP 回调？

[http://docs.jquery.com/Ajax/jQuery.getJSON](http://docs.jquery.com/Ajax/jQuery.getJSON)

> 从 jQuery 1.2 开始，如果指定 JSONP 回调，则可以加载位于另一个域中的 JSON 数据，可以像这样：“myurl?callback=?”。jQuery 自动替换 ? 使用正确的方法名称调用，调用您指定的回调。此回调参数可能因 API 而异，例如 Yahoo Pipes 需要“_callback=?”

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-26T19:21:01.517

如果不是跨域请求，只需要：

```
jQuery.getJSON("/cities/mumbai/events.js?month=2009-05", function(json) {
    alert(json[0]);
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-26T18:50:49.050

正如@ceejayoz 建议的，必须使用[JSONP技术来访问不同域上的数据。](http://ajaxian.com/archives/jsonp-json-with-padding)但为了使其工作，服务器端脚本必须启用 JSONP，这意味着它必须接受一个参数，该参数将定义客户端回发函数名称以添加到 JSON 数据之前。如果不是这种情况，您需要在托管您的客户端脚本的域上编写一个服务器脚本，作为到外部域的桥梁。

# asp.net - 对解决方案中的项目进行排序

> ID：912070
> 
> 赞同：2
> 
> 时间：2009-05-26T18:37:56.393
> 
> 标签：asp.net, visual-studio-2008, solution

这对我来说真的很烦人，搜索还没有得到明确的解决方案。

Visual Studio 2008 的相同 .sln 文件以不同的方式对项目进行排序。在我的办公室里，我的 Web 项目位于顶部，而我的 3 个网站位于下方（似乎是默认的字母顺序，这很好！）。

在家里，安装了相同版本的 VS 和 SP，但其中一个 Web 项目出现在列表的底部。订单不同只是一种痛苦，我可能在这里遇到了一些个人完美主义问题，但我希望以相同的方式订购相同的解决方案。

我试过这个：http: [//solutionsorter.codeplex.com](http://solutionsorter.codeplex.com)

但它会在打开 .sln 文件时爆炸。

有什么想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-26T19:25:22.663

只是一个想法，但您是否曾经使用解决方案文件夹来组织您的解决方案？我有一个共同的顺序，我喜欢列出我的项目，所以我开始创建以数字开头的根解决方案文件夹，并在其中添加子解决方案文件夹，按特定类型对每个项目进行分组。例如：

```
1\. Clients
   App
   Web
   Lib
   Tst
   Doc
2\. API
   Lib
   Tst
   Doc
3\. Domain
   Lib
   Tst
   Doc
4\. Data Access
   Lib
   Tst
   Doc
5\. Framework
   Lib
   Tst
   Doc 
```

这效果很好，并且可以使大型解决方案井井有条，但如果您的解决方案中只有几个项目，则可能会有点矫枉过正。你可以试试根文件夹，按照你喜欢的顺序编号。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-26T19:17:53.350

您是否尝试过删除两个 .suo 文件？或者如何删除然后重新添加。据我所知，项目应该按字母顺序排列。

[在连接](http://connect.microsoft.com/VisualStudio/feedback/ViewFeedback.aspx?FeedbackID=455035)中编辑它也许你应该投票支持 vs10

编辑2：

如果您的项目是文件系统网站，您机器上的路径可能会有所不同，

例如

如果在工作中你有

```
D:\ThatProject\MyWebsite1 
```

和 D:\ThatProject\MyWebsite2

在家里你有

```
D:\ThatProject\MyWebsite1 
```

和

```
D:\Project\Website2 
```

这将导致不同的顺序

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-26T19:17:56.377

它是否以不同的情况保存在每台计算机上？有时 ProjectA 与 projectA 不同。

否则，告诉我们更多，我们需要更多线索:)

# mysql - MySQL：如何为基于范围而不是外键的关系编写查询？

> ID：912078
> 
> 赞同：2
> 
> 时间：2009-05-26T18:39:28.823
> 
> 标签：mysql

我在 MySQL 中有三个相关的表，但在技术上并没有通过外键相互链接。它们是：**用户**、**级别**和**类**。

users 表有一个业力列，一个数字类型。根据这个**业力**数字，我想知道用户的**level**，我从 levels 表中检索到。这不是一个硬性关系，因为一个级别与**一系列**业力值相关联，如下所示：

*   1级（最低业力：0）
*   2级（最低业力：100）
*   3级（最低业力：500）
*   ...

因此，如果用户的业力为 400，则返回值应为 2。为了使事情稍微复杂一点，级别编号表示用户的**类别**，其定义存储在类别表中。这又是一个**范围**关系：

*   蚂蚁级（最低 1 级）
*   类猫头鹰（最低5级）
*   狮级（最低100级）
*   ...

总而言之，我们正在讨论三个基于范围值彼此具有隐式关系的表。我的问题与如何有效地查询这些表有关。我的一个非常常见的需求是根据条件获取一个或多个用户的信息，结果集应该包含用户详细信息，还应该包含用户的级别和类别。

对于单个用户，我设法编写了这个运行良好的查询：

```
SELECT u.*,  lv.num as level, lvc.title as class, lvc.id as classid
FROM user as u, level as lv, levelclass as lvc
WHERE u.id = ? AND lv.min_karma <= u.karma AND lv.num <= lvc.minlevel_num
ORDER BY lv.num DESC LIMIT 1; 
```

但是，如果我通过离开 WHERE u.id = 来扩大结果集？并删除 LIMIT 1，从而查询用户**列表**，我得到了所有三个表的组合。通常，您会通过对键进行内部联接来降低行，但由于这是范围检查，因此不起作用。我尝试在内部连接条件中使用范围检查，但这带来了相同的结果。即使使用分组我也无法得到我想要的结果。

在绝望的尝试中，我想出了这个查询，它有效：

```
SELECT usr.*, 
(SELECT lv.num as level
FROM user as u, level as lv, levelclass as lvc
WHERE u.id = usr.id AND lv.min_karma <= u.karma AND lv.num <= lvc.minlevel_num
ORDER BY lv.num DESC LIMIT 1) as level,
(SELECT lvc.title as class
FROM user as u, level as lv, levelclass as lvc
WHERE u.id = usr.id AND lv.min_karma <= u.karma AND lv.num <= lvc.minlevel_num
ORDER BY lv.num DESC LIMIT 1) as class,
(SELECT lvc.image as class_image
FROM user as u, level as lv, levelclass as lvc
WHERE u.id = usr.id AND lv.min_karma <= u.karma AND lv.num <= lvc.minlevel_num
ORDER BY lv.num DESC LIMIT 1) as class_image,
(SELECT lvc.id as classid
FROM user as u, level as lv, levelclass as lvc
WHERE u.id = usr.id AND lv.min_karma <= u.karma AND lv.num <= lvc.minlevel_num
ORDER BY lv.num DESC LIMIT 1) as classid
FROM user as usr
ORDER BY usr.$sortby $direction LIMIT ?,? 
```

但是，这对我来说似乎效率很低。基本上我在这里所做的是为我需要从级别表和类表中的每一**列（！）编写一个子查询。**如果我在一个子查询中查询级别或类表的多个列，它会再次返回所有值的组合。我觉得我的数据库技能存在差距，我明显缺少一些东西，我不知道的功能......

**你能帮助我吗？如何为一组行编写一个有效的查询，该查询组合了三个表中的列，但不通过键（而不是范围）链接？**

**PS：**我知道如果我将这个模式非规范化以将级别和类组合到用户表中，我可以大大简化场景，但是我需要这个有一个特定的原因，相信我。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-26T18:47:30.790

如果您可以修改 Level 和 Class 表以在行中具有实际范围（即在 Level 表中有 minkarma 和 maxkarma，在 Class 表中有 minlevel 和 maxlevel），您应该能够在连接条件中使用它并且它只会为每个用户返回一行。

例子：

```
SELECT * FROM user as u
INNER JOIN level as lv on
    u.karma >= lv.min_karma AND u.karma <= lv.max_karma
INNER JOIN levelclass as lvc on
    lv.num >= lvc.min_level AND lv.num <= lvc.max_level 
```

您获得多行的原因是您通过仅过滤最小值来匹配多个级别和类。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-26T18:55:39.697

我需要查看您的确切数据结构才能确定，但​​是这样的事情怎么样？

```
SELECT
    *
FROM
    [User] u
LEFT OUTER JOIN
    [Level] lv
ON
    lv.num =
(
    SELECT
        MAX(lv2.num)
    FROM
        [Level] lv2
    WHERE
        lv2.min_karma <= u.karma
)
LEFT OUTER JOIN
    [LevelClass] lvc
ON
    lvc.id =
(
    SELECT
        MAX(lvc2.id)
    FROM
        [LevelClass] lvc2
    WHERE
        lvc2.minlevel_num <= lv.num
) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-26T18:58:02.953

您想在案例 statemnet 上使用联接

```
SELECT 
 * 
FROM 
 users u
JOIN 
 levels l
ON 
 l.id = 
CASE 
    WHEN u.karma <= 10
    THEN 1
    WHEN u.karma > 11 & u.karma <= 100
    THEN 2
    WHEN u.karma > 100 & u.karma <= 1000
    THEN 3
    WHEN u.karma > 1000 
    THEN 4
END
JOIN 
 class c
ON 
 c.id is
CASE 
    WHEN l.id <= 5
    THEN 'owl'
    WHEN l.id > 5 & u.karma <= 10
    THEN 'lion'
END 
```

调味。

# java - 让 Java EE InitialContext 找到一个合格的主机名？（针对 JBoss EJB 服务器）

> ID：912090
> 
> 赞同：2
> 
> 时间：2009-05-26T18:40:34.330
> 
> 标签：java, jakarta-ee, jboss, jndi

如何在传递给（Java EE）InitialContext 类的“env”参数中为“java.naming.provider.url”属性使用完全限定的主机名。无论我传入一个 IP 地址，还是一个完全限定的（host.domain ...）主机名，lookup(name) 调用都会失败，说它找不到主机名，其中主机名只是没有其域的主机。例如 - 假设 mypc.somedomain.net 是 1.2.3.4，输入“1.2.3.4”或“mypc.somedomain.net”将失败，如下所示：

javax.naming.CommunicationException java.rmi.UnknownHostException: mypc

我需要将 DNS 服务器传递到 InitialContext 吗？让底层操作系统完成这项工作还不够聪明吗？（如“ping mypc.somedomain.net”，它只是工作）

客户端和服务器既不在同一台机器上，也不在同一个子网中，所以我必须使用完全限定的主机名。为了对“Robin”进行一些改进，我们通常在单独的 JVM 中运行客户端进程，该 JVM 通常会访问 localhost 上的服务器，或者有时在同一子网/域（例如 - “testbox”）上的另一个主机上，这不需要一个完全限定的名称。

另外，我尝试添加“jns://”前缀和“:1099”后缀（例如-“jns://mypc.somedomain.net:1099”），并不是说这些是使“testbox”工作所必需的，并且得到了同样的例外。

我搜索了一下，发现了这个错误的几个实例（InitialContext / JBoss -> UnknownHostException）或类似的问题，但没有答案。哎哟。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-26T21:45:05.877

经过仔细检查，这是以下内容的副本：

[在不同的网络上时出现 JBoss UnknownHostException](https://stackoverflow.com/questions/840292/jboss-unknownhostexception-when-on-different-network)

EJB 客户端无法访问 JBoss EJB 服务器，除非 JBoss 服务器以服务器知道自己的（完全限定的）名称的方式启动。

我的 Windows XP PC 知道它的“短”名称，但您必须使用引用问题中提到的 -b 参数（绑定）为 jboss 提供完全限定的名称。关于 JNDI（或 EJB？）协议的某些内容需要某种“双重查找”，在找到主机后，查询它的名称，然后再次查找（或不查找）。去搞清楚。反欺骗保护？？？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-26T19:31:08.207

您的最后一条语句意味着您正在将客户端作为独立应用程序运行。如果是这种情况，它没有在 Java EE 容器中运行，您必须进行适当的配置以运行*瘦客户端*，这应该在您的应用服务器文档中的某处进行定义。

简单地尝试从完全限定名称中查找 InitialContext 是行不通的。我从来没有为 JBoss 做过这个，但我为 WAS 做过。您必须找出需要哪些 JBoss jar 和配置才能使其工作。

与 WAS 一样，它们可能有一些创建客户端容器的方法，然后允许您以正常方式完全访问 Java EE 资源。

# java - 有没有办法为 Hibernate 管理的对象声明最终字段？

> ID：912093
> 
> 赞同：24
> 
> 时间：2009-05-26T18:41:17.090
> 
> 标签：java, hibernate, final, pojo

我刚刚开始使用 Hibernate，到目前为止我看到的所有示例都非常类似于 Hibernate 文档中的教程：

```
package org.hibernate.tutorial.domain;
import java.util.Date;

public class Event {

    private Long id;
    private String title;
    private Date date;

    public Event() {}

    /* Accessor methods... */
} 
```

具体来说：没有一个字段被声明为`final`，并且必须有一个无参数的构造函数，以便 Hibernate 框架可以实例化该类并设置其字段。

但事情是这样的——我**真的**不喜欢让我的类以任何方式可变，只要我可以避免它（Java 实践：不可变对象为此做了一个非常有力的论据）。那么*，即使我将每个字段都声明为“final”，是否有任何方法可以让 Hibernate 正常工作*？

我知道 Hibernate 使用反射来实例化它的类，因此需要能够调用某种构造函数，而不会冒险选择错误的构造函数或将错误的值传递给它的参数之一，所以它可能更安全调用无参数构造函数并一次将每个字段设置为一个。但是，难道不能向 Hibernate 提供必要的信息，以便它可以安全地实例化不可变对象吗？

```
public class Event {

    private final Long id;
    private final String title;
    private final Date date;

    public Event(@SetsProperty("id") Long id,
        @SetsProperty("title") String title,
        @SetsProperty("date") Date date) {

        this.id = id;
        this.title = title;
        this.date = new Date(date.getTime());
    }

    /* Accessor methods... */
} 
```

注释当然是虚构的`@SetsProperty`，但似乎不应该是遥不可及的。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-05-28T11:19:54.470

不可变对象是指没有修改其状态（即其字段）的方法的对象。字段不必是最终的。因此，您可以删除所有修改器并将 Hibernate 配置为使用字段访问而不是访问器，或者您可以将无参数构造函数和修改器标记为已弃用。这有点解决方法，但总比没有好。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2010-09-10T09:18:11.480

实际上，在 JDK 1.5+ 中，hibernate 可以处理（通过反射）更改最终字段。创建一个受保护的默认构造函数（），将字段设置为一些默认值/空等... Hibernate 可以并且将在实例化对象时覆盖这些值。

这一切都是可能的，这要归功于 Java 1.5 内存模型的更改——为了启用序列化/反序列化而进行的感兴趣的更改（允许 final 不是那么最终）。

```
public class Event {

private final Long id;
private final String title;
private final Date date;

// Purely for serialization/deserialization
protected Event() {
    id = null;
    title = null;
    date = null;
}

public Event(Long id, String title, Data date) {
    this.id = id;
    this.title = title;
    this.date = date;
}

/* Accessor methods... */ 
```

}

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-05-28T10:34:49.243

听起来这不是 Hibernate 的用例，因为它执行的许多操作都涉及可变状态：

*   合并对象
*   脏状态检查
*   冲洗变化

话虽如此，如果您担心不可变性，您可以选择使用复制构造函数为对象提供包装器：

```
public class FinalEvent {
    private final Integer id;

    public FinalEvent(Event event) {
        id = event.id;
    }
} 
```

但这确实意味着额外的工作。

* * *

现在我正在考虑它，休眠会话通常是线程绑定的，这至少使最终字段的好处之一无效 - 安全发布。

您还在寻找 final 字段的其他好处吗？

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-12-24T15:50:29.270

这个也困扰了我很久。我最近一直在尝试的一个想法是 - 为您的模型类定义只读接口，并让您的 DAO 和任何工厂在对象上返回这些接口。这意味着即使实现是可变的，一旦离开 DAO/工厂对象，就不能再对其进行调整。

像这样：

```
public interface Grape {
  public Color getColor();
}

public class HibernateGrapeDao {
  public Grape findGrape(int grapeId) {
    HibernateGrape grape = hibernate.find(...
    return grape;
  }
}

class HibernateGrape implements Grape {
 ....
} 
```

甚至可能希望将实现类包私有到 dao 包，所以没有人可以直接摆弄它们。多做一些工作，但从长远来看可能有助于保持清洁。而且，显然，要小心整个平等/身份事务。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-28T14:56:54.033

您可以通过使用 Builder 模式来实现所需的结果。我不久前在 Hibernate 论坛上阅读了一篇讨论这个想法的[帖子](https://forum.hibernate.org/viewtopic.php?f=9&t=992649&view=next)（尽管我自己从未实现过它......）

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-08-13T13:37:40.677

使用 @Access(AccessType.FIELD) 注释您的类，然后您可以使您的字段最终确定。像这样：

```
@Access(AccessType.FIELD)
public final class Event {

    private final Long id;
    private final String title;
    private final Date date;

    private Event() {
        id = null;
        title = null;
        date = null;
    }

    public Event(Long id, String title, Date date) {
        this.id = id;
        this.title = title;
        this.date = date;
    }
} 
```

# java - 我在我的 web 应用程序中所做的事情可以很容易地被黑客入侵或闯入吗？

> ID：912097
> 
> 赞同：0
> 
> 时间：2009-05-26T18:42:12.733
> 
> 标签：java, struts2, weblogic

我正在向用户展示一些考试。用户在通过此考试之前不得进入实际站点。但是，将有一些用户可以选择在某个日期（例如从当前日期开始的月份）之前绕过考试。所以这些用户有一个月的时间参加考试。在那之前，他们可以点击考试页面上的“继续”进入网站。

我的逻辑：当普通用户在考试表单页面上单击提交时，我正在执行所有逻辑并向数据库提交信息。当这些“特殊”用户单击继续时，如果他们仍在那个一个月的窗口中，我将只是将“真”编码到“didPassExam()”方法。

我的问题是：要检查用户单击了哪个按钮，我正在执行以下操作（Struts 2 代码）

私人字符串提交；

```
public void setSubmit(String submit) {
    this.submit = submit;
} 
```

在 JSP 中：

```
 <s:submit name="submit" value="Submit" />

 <s:submit name="submit" value="Proceed" /> 
```

所以基本上当用户点击一个按钮时，我的动作类会知道点击了哪个按钮。但是，一些黑客是否可以故意将“提交”按钮的值更改为“继续”，然后即使是普通用户也能绕过考试？

有人会以不同且更安全的方式执行此操作吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-26T18:46:18.560

是的，任何用户都可以通过特殊的“继续”并获得访问权限。

由于您可以（并且确实）已经分辨出用户类型之间的区别，因此您应该基于此*在服务器上验证他们的按钮。*总是可以绕过客户端检查。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-05-26T18:47:29.447

一般来说，您不应该相信来自客户端的输入。您应该在服务器端验证特定用户有权跳过考试。大概，您从登录过程中知道用户是谁，并且您知道确定他们是否可以跳过考试的正确逻辑。所以没有理由相信客户告诉你的。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-26T18:48:25.407

是的，这很容易被黑客入侵。每当您需要保护此类内容时，请在服务器端进行检查。也就是说，检查服务器端的用户类型（这就像用语中的“角色”）。

始终假设任何客户端代码都可以并且将被恶意用户替换。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-27T02:12:46.397

您将需要捕获按下的按钮，然后针对用户进行验证。假设您的用户被实例化为类变量用户，并为公共方法 isSpecialUser() 返回布尔值：

```
public void setSubmit(String submit) {
    if (user.isSpecialUser() && submit == "Proceed") {
        // Only Special Users can set this to Proceed
        this.submit = submit;
    } else {
        // Sets itself to the remaining valid option (to prevent evilness)
        this.submit = "Submit";
    }
} 
```

# php - PHP 会话文件的权限

> ID：912098
> 
> 赞同：0
> 
> 时间：2009-05-26T18:42:19.787
> 
> 标签：php, apache, file, session

我有一个域 domain.com 和子域 sub.domain.com 这两个域有不同的 ftp 用户（user1、user2），它们在 linux 环境中属于同一个组（usergroup）。最后，我有相同的 PHP 应用程序，它在两个域上都使用会话（一个是实时的，另一个是测试环境）。

当我去 domain.com 而不先去 sub.domain.com 时，PHP 会话文件在默认文件夹 /tmp/ 中创建，具有适当的权限 600 和 user1:usergroup，当我访问 sub.domain.com 而不先去域时.com，创建一个具有权限 600 和 user2:usergroup 的文件。

一切都适用于所有浏览器，但 IE 除外（请不要专注于此）。我发现当我访问 sub.domain.com 然后尝试 domain.com PHP 尝试读取相同的会话文件但没有权限并且页面无限期加载。将文件的所有权更改为 user1 会使 domain.com 工作，但会阻止 sub.domain.com 工作。

如何使 Apache 或 PHP 为会话创建不同的文件或使它们可以从两个域访问。

PS 就像我说的出于某种奇怪的原因，这只发生在 IE 上，并且来自 PHP 的错误消息是：未捕获的 PHP 错误：session_start() [function.session-start]: open(/tmp/sess_t1..., O_RDWR) failed: Permission denied (13) in file xxx.php on line 46 on line on line 46 is session_start();

感谢您对此的任何建议。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-26T19:15:00.360

不确定这是否是解决您的问题的最佳方法，但您可以尝试让 PHP 将会话文件保存在每个域的不同目录中。

查看[session_save_path()](http://www.php.net/manual/en/function.session-save-path.php)文档。

请记住，您必须在初始化会话之前设置它。
理想情况下，这应该是您的脚本首先要做的事情之一。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-26T19:43:25.887

你确定是 IE 触发了这个问题吗？

浏览器不能直接访问会话文件，只有 PHP (HTTPD) 进程可以访问会话文件。

我不明白为什么一个浏览器应该在 PHP 日志中给出与另一个不同的错误消息。

我认为您可能正在处理两个不同的问题。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-26T19:59:02.440

一种解决方案是将其添加到每个子域的 .htaccess 文件中：

```
php_value session.save_path '/path/to/a/writeable/folder' 
```

然后确保每个子域都有权写入自己的文件夹。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-12-22T16:28:33.730

我刚遇到同样的问题。这似乎是 Apache 返回 IE7 和 IE8 会话数据的方式的问题，但很可能是因为 IE7 和 IE8 有不正确的方式来宣布他们请求会话数据的域。

这是我的场景：

使用两个域运行 Apache 1.3，每个域都有自己的帐户和自己的用户：

```
Domain: mycompany.com 
Session path: /tmp/
Webserver user: mycompanycom

Domain: support.mycompany.com 
Session path: /tmp/
Webserver user: nobody 
```

以下是使用 Firefox/Safari/Chrome 正常访问期间发生的情况：

1.  `/tmp/`我访问 mycompany.com 并在用户拥有的会话文件中创建`mycompanycom`。
2.  然后我访问 support.mycompany.com，第二个会话文件`/tmp/`由 user创建`nobody`。
3.  Apache 不会混淆并返回正确的会话文件

但是，在访问 IE7 和 IE8 期间会发生以下情况：

1.  `/tmp/`我访问 mycompany.com 并在用户拥有的会话文件中创建`mycompanycom`。
2.  然后我访问 support.mycompany.com，而不是创建`/tmp/`用户拥有的第二个会话文件`nobody`，Apache 尝试返回 mycompany.com 的会话文件。
3.  mycompany.com 的会话文件归用户所有`mycompanycom`，因此以用户身份运行的 Web 服务器`nobody`无法访问它。权限被拒绝。

正如其他人所建议的那样，解决方案是创建一个单独的目录`/tmp/`来分离 support.mycompany.com 的存储会话数据：

```
mkdir /tmp/mycompany
chown nobody:nobody /tmp/mycompany 
```

然后，我将以下内容添加到`.htaccess`support.mycompany.com 的根 Web 目录中的文件中：

```
php_value session.save_path '/tmp/mycompany' 
```

最后，我删除了所有现有的会话数据，`/tmp/`以确保立即使用新的会话路径：

```
rm -f /tmp/sess_* 
```

就是这样！现在 IE7 和 IE8 可以正常工作。

我相当肯定这个问题与 IE7 和 IE8 如何从 Apache 请求会话数据有关。他们可能首先为 mycompany.com 请求会话数据，然后为 support.mycompany.com 请求会话数据，即使后者是在地址栏中输入的唯一域。

# visual-studio - 可以同时使用 AnkhSVN 和 VisualSVN 吗？

> ID：912103
> 
> 赞同：6
> 
> 时间：2009-05-26T18:43:20.690
> 
> 标签：visual-studio, svn, visualsvn, ankhsvn

我想在不完全卸载 VisualSVN 的情况下尝试 AnkhSVN 的一个功能（即与 Red Gate SQL Changeset 工具的集成）。感觉很狡猾，所以我想看看是否有其他人有经验可以减轻或证实我的恐惧。

**更新**
所以我尝试卸载 VisualSVN 并放入 Ankh。就 VSS 本身的工作而言，更改是完全透明的。可悲的是，SQLChangeset 不适用于这个插件，所以它的一部分是徒劳的。

切换回来也很轻松，甚至不必重新输入我的执照。因此，知识渊博，但对长期目标不满意。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-07-21T20:35:11.400

有点。我已经能够同时在 Visual Studio 上*安装*VisualSVN 和 AnkhSVN。但是，您将无法同时*使用*两者。VisualSVN 是一个插件，而 AnkhSVN 是一个真正的源代码控制插件。要使用其中一个，您只需禁用源代码控制绑定（对于 AnkhSVN）或禁用插件（对于 VisualSVN）。

不过，根据我的经验，我发现 VisualSVN 是比 AnkhSVN 更好的客户端。VisualSVN 可以非常有效地处理忽略用户文件 (*.suo) 并将项目添加到 Subversion。另一方面，AnkhSVN 给我带来了一些困难。

希望这可以帮助！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-26T18:52:10.030

我没有尝试过，但我知道 Visual Studio 支持多个源代码控制插件。您只需从选项中选择哪个是活动的，方法是`Tools->Options`从菜单中选择，然后`Source Control->Plug-in Selection`在打开的窗口左侧的树控件中找到页面。

只需安装 Ankh 并在那里选择它进行测试，然后在完成后设置回 VisualSVN。当然，这假设一切都很好。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-26T19:04:14.517

您可能可以在工具 -> 插件管理器中关闭/禁用 VisualSvn，然后选择 AnkhSvn 作为当前 SCC 提供程序。

你能描述一下这个变更集工具是如何工作的，以及它应该如何与 AnkhSvn 集成吗？

# asp.net - 实现自定义 MembershipUser

> ID：912121
> 
> 赞同：10
> 
> 时间：2009-05-26T18:49:25.497
> 
> 标签：asp.net, membership

我正在兜圈子，需要一些帮助来实现自定义 MembershipUser，以便我可以将自己的自定义属性添加到 MembershipUser。

我一直在关注此站点上的示例：[如何：实现自定义成员资格用户](http://msdn.microsoft.com/en-us/library/ms366730.aspx)

**我认为，我遇到的问题出在 CustomMembershipUser 的构造函数中。**

我的 CustomMembershipUser 有这三个附加属性：firstName、middleName、lastName。

```
public class CustomMembershipProvider : MembershipProvider
{
  public override MembershipUser GetUser(string username, bool userIsOnline)
    {
       //.... Get data from database
       MembershipUser baseUser = new MembershipUser(this.Name,
                                               username,
                                               userId,
                                               email,
                                               "",
                                               comment,
                                               isApproved,
                                               isLockedOut,
                                               dtCreate,
                                               dtLastLogin,
                                               dtLastActivity,
                                               DateTime.Now,
                                               dtLastLockoutDate);
                    return new CustomMembershipUser(baseUser, firstName, middleName, lastName)
    }
}

public class CustomMembershipUser : MembershipUser
{
  private string _firstName;
    public string FirstName { get { return _firstName; } set { _firstName = value; } }

    private string _middleName;
    public string MiddleName { get { return _middleName; } set { _middleName = value; } }

    private string _lastName;
    public string LastName { get { return _lastName; } set { _lastName = value; } }

 public CustomMembershipUser(MembershipUser baseuser, string firstname, string middlename, string lastname)
    {
        _firstName = firstname;
        _middleName = middlename;
        _lastName = lastname;

        new CustomMembershipUser(baseuser); // DO I NEED THIS?? HOW TO IMPLEMENT??

    }
} 
```

我这样称呼它：

```
 MembershipUser mu = Membership.GetUser(UserName);

    CustomMembershipProvider p = (CustomMembershipProvider)Membership.Provider;

    MembershipUser memUser = p.GetUser(UserName, true);

    object userId = memUser.ProviderUserKey; 
```

ProviderUserKey 为空，其他值也是如此。

如何获得我添加的附加属性？

谢谢

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-05-26T19:01:39.093

根据我自己尝试做很多相同的经验，尝试使用 MembershipProvider 来做这件事最终将是一种令人沮丧和违反直觉的体验。

会员提供者模型的想法不是改变或增加用户的定义，正如您正在尝试做的那样 - 它是允许框架以替代方式访问已被定义为属于的信息到“会员用户”。

我认为您真正要寻找的是用户个人资料。使用 ASP.NET 配置文件比实现您自己的提供程序更容易。[您可以在此处找到概述](http://msdn.microsoft.com/en-us/library/2y3fs9xs.aspx)。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-05-26T19:39:06.257

这对我有用：

```
public class CustomMembershipUser : MembershipUser
{
    public CustomMembershipUser(
        string providerName,
        string name,
        object providerUserKey,
        string email,
        string passwordQuestion,
        string comment,
        bool isApproved,
        bool isLockedOut,
        DateTime creationDate,
        DateTime lastLoginDate,
        DateTime lastActivityDate,
        DateTime lastPasswordChangedDate,
        DateTime lastLockoutDate
        )
        : base(providerName, name, providerUserKey, email, passwordQuestion,
        comment, isApproved, isLockedOut, creationDate, lastLoginDate,
        lastActivityDate, lastPasswordChangedDate, lastLockoutDate)
    {
    }

    // Add additional properties
    public string CustomerNumber { get; set; }

}

public class CustomMembershipProvider : MembershipProvider
{

    public override MembershipUser GetUser(string username, bool userIsOnline)
    {
        if (string.IsNullOrEmpty(username))
        {
            // No user signed in
            return null;
        }

        // ...get data from db

        CustomMembershipUser user = new CustomMembershipUser(
                    "CustomMembershipProvider",
                    db.Username,
                    db.UserId,
                    db.Email,
                    "",
                    "",
                    true,
                    false,
                    db.CreatedAt,
                    DateTime.MinValue,
                    DateTime.MinValue,
                    DateTime.MinValue,
                    DateTime.MinValue);

        // Fill additional properties
        user.CustomerNumber = db.CustomerNumber;

        return user;

    }

}

// Get custom user (if allready logged in)
CustomMembershipUser user = Membership.GetUser(true) as CustomMembershipUser;

// Access custom property
user.CustomerNumber 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-26T19:05:30.380

只是让你知道，我以前尝试过 MembershipProvider 路径，而且它是一条漫长而多风的路径。您可能会看到仅创建实现 IPrincipal 和 IIdentity 的类是否会满足您的需求，因为它们需要的开销要少得多。

# java - 在 J2ME 中发出 http 请求

> ID：912131
> 
> 赞同：3
> 
> 时间：2009-05-26T18:52:30.623
> 
> 标签：java, http, java-me, httpwebrequest, midp

我正在维护一个 J2ME 应用程序，在该应用程序初始化中发现了对[http://www.google.com的 http 请求。](http://www.google.com)我问开发者为什么会有谷歌的请求。他说这样应用程序发出的其他请求会更快。

我将此请求删除到 google.com，其他请求变慢了。

谁能解释为什么会这样？如何在不发出先前请求的情况下更快地发出另一个请求？

**编辑：**

在初始化时向谷歌发出请求：

*   第一次请求（初始化后）= 20 秒
*   重复第一个请求 = 5sec

没有在初始化中提出请求：

*   第一个请求 = 40 秒
*   重复第一个请求 = 5sec

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-10T15:31:49.113

在移动设备上启动 Web 连接需要一些时间，并且 JVM 通常会在 MIDlet 运行期间保持连接打开（大多数现代连接按字节收费 - Edge、GPRS、WiFi）。因此，如果在 startApp 上建立了连接，您可能会发现连接将保持打开状态，并且所有进一步的通信都不需要打开连接，只需发送数据。如此快速，更可靠！

这种行为是特定于平台的，MIDP2 没有规定这是真的（因此诺基亚可能与三星等不同）。

连接到 127.0.0.1 可能不会欺骗 JVM，它可能会决定它不需要为此打开 GPRS 连接。再次特定于平台。

詹姆士

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-26T19:05:28.180

...也许第一个请求会初始化设备中的网络层（*），也可能是 jvm。

我相信它也适用于 www.microsoft.com :-)

*）我怀疑这取决于您运行的设备。我不知道发生了什么，但可能有什么。例如：启动无线电设备，与网络运营商建立会话，在 jvm 中加载和启动类。

尝试连接到 127.0.0.1 而不是 google，看看这是否会使以后的尝试更快。

如果应用程序在进行第一次真正的连接尝试之前需要一段时间进行大量初始化，您可以提前启动一个新线程来进行连接尝试。也许这会减少总的等待时间。

# audio - MPEG-4 文件中的多个音频流

> ID：912132
> 
> 赞同：2
> 
> 时间：2009-05-26T18:52:30.810
> 
> 标签：audio, file-format, mp4, vlc, mpeg

MPEG-4 文件格式允许在一个文件中存在多个流。这对于包含多语言音频的视频很有用。在这种视频的情况下，音频流与视频同步。

是否可以创建一个包含去同步音频流的 MPEG-4 文件，即音轨一个接一个地播放？

我想设计一个包含音乐专辑的 MPEG-4 文件，因此[VLC](http://www.videolan.org/)等媒体播放器依次播放曲目至关重要。当我使用 MP4Box（来自[GPAC](http://gpac.sourceforge.net/)框架）时，VLC 将生成的文件识别为具有同步的音频流。MPEG-4 文件格式的哪个框对此负责？或者我怎么能告诉 VLC 这些音频流不同步？

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-26T20:48:12.370

我可以想出两种方法来做到这一点，而且都会有一些问题。

您可以将所有音频流连接到 MP4 文件中的一个音轨中。由于某些明显的原因，这并不理想。一方面，这并不完全符合您的要求。

您也可以将曲目存储为同步的音频流，但设置时间信息，使第二个曲目的第一个样本在第一个曲目播放完毕之前不会开始播放，等等。

我不知道有任何工具可以做到这一点，但文件格式将支持这种方案。由于将音频存储在 MP4 文件中是一种不寻常的方式，因此我希望玩家也会遇到此问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-28T20:51:38.983

连接所有流将起作用，并且可以通过添加章节来解决各个轨道。它至少适用于 VLC。

```
    MP4Box -new -cat track1.m4a -cat track2.m4a -chap chapters.txt album.m4a

```

`chapters.txt`看起来像这样：

```
    第 1 章=00:00:00.00
    CHAPTER1NAME=曲目 1
    第 2 章=00:03:40.00
    CHAPTER2NAME=曲目 2

```

但这只是一个技巧。我正在寻找的解决方案应该将曲目保留为单独的流。

# jsp - JSP 表达式语言错误行为？

> ID：912135
> 
> 赞同：5
> 
> 时间：2009-05-26T18:53:27.953
> 
> 标签：jsp, tomcat, el

我在 Linux 上运行 Tomcat 6.0.18。

我有一个使用这样的 bean 的 JSP：

```
<jsp:useBean id="helper"
             type="com.example.SomeType"
             scope="request"/> 
```

`helper`该页面使用如下表达式语言引用 的属性：

```
<!-- This works properly, but could fail silently if the bean name is incorrect. -->
<div><p>Here's some stuff: ${helper.stuff}</div> 
```

在一些我错过了 name 的重构过程中`helper`，我注意到如果 name写入不正确，**不会引发错误。**`helper`不在屏幕上，也不在我的日志文件中。输出中没有为表达式语言片段生成任何内容：

```
<!-- Wrong name! "foo" should be "helper" but no error is observed (other than missing ouput)! -->
<div><p>Here's some stuff: ${foo.stuff}</div> 
```

现在，如果我使用以下 JSP 语法且名称不正确，*则会*引发错误（显示我的自定义错误页面，并且我在日志文件中看到异常）`helper`：

```
<!-- Wrong name, but an error is raised. -->
<div><p>Here's some stuff: <jsp:getProperty name="foo" property="stuff"/></div> 
```

在这种情况下，日志会记录以下条目：

```
SEVERE: requestURI: /some.jsp servletName: jsp statusCode: 500
org.apache.jasper.JasperException: Attempted a bean operation on a null object. 
```

为了完整`jsp:getProperty`起见，当 bean 名称正确时，语法可以正常工作：

```
<!-- Works properly, protects me from an incorrect name, but is more verbose than EL. -->
<div><p>Here's some stuff: <jsp:getProperty name="helper" property="stuff"/></div> 
```

**为什么我在编写 ${foo.stuff} 时没有看到错误？在这种情况下是否有一些配置选项可以控制错误报告？**

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-26T19:17:45.377

此行为在[表达式语言规范版本 2.1](http://jcp.org/aboutJava/communityprocess/final/jsr245/index.html)的第 1.6 节中进行了介绍。

> 评估 expr-a[expr-b]：
> 
> 如果 value-a 为空：
> 
> *   如果 expr-a[expr-b] 是最后被解析的属性：
>     *   如果表达式是值表达式并且调用了 ValueExpression.getValue(context) 来启动此表达式评估，则返回 null。
>     *   否则，抛出 PropertyNotFoundException。*试图为左值取消引用 null*
> *   否则，返回空值。

（EL 统一了 . 和 [] 运算符）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-26T19:10:15.207

这就是 EL 的工作方式。

${helper} 计算结果为 null，因此 EL 只返回 "" 并且不尝试计算表达式的其余部分。

在某些情况下，这是一个方便的功能：

```
${myBean.property1.name} 
```

即使property1为null也会起作用，因此我不必仅仅为了防止NPE而写：

```
<c:if test="${not empty myBean.property1}">${myBean.property1.name}</c:if> 
```

# java - Swing 组件如何在内部创建、布局、重新绘制、事件通知……？

> ID：912137
> 
> 赞同：5
> 
> 时间：2009-05-26T18:54:29.417
> 
> 标签：java, user-interface, swing, graphics, awt

**我想知道是否有关于Swing 组件生命周期的**好的文档（或（可查看的）电子书）。

*无论如何，“生命周期”是正确的术语吗？*

我希望找到以下问题的答案：

*   如何，何时，以何种顺序调用**绘画方法**？
*   如何，何时，由谁调用哪些**事件？**
*   创建组件的方法调用的确切**顺序是什么？**

我不时遇到我的应用程序的奇怪行为，例如：

*   ComponentListener 的**resize 事件在****setVisible(true)**之前调用
    （因此根窗格具有负尺寸！）
*   某些组件只有在**手动调整 JFrame 大小后才能正确布局**
*   将超类从 JPanel 更改为 JLayeredPane 会导致我的类在另一个容器中的布局不同。
*   还有很多其他奇怪的事情......

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-26T19:21:59.520

很久以前我也有同样的问题。

我无法相信在互联网上找到关于这个主题的好资源是多么困难。

幸运的是，我找到了这个链接，现在我把它放在带有金色标签的书签中。:)

[Swing 架构概述](http://www.oracle.com/technetwork/java/architecture-142923.html)

一旦你很好地掌握了它们在概念上的工作原理，你将能够解决你提到的大部分问题。

我希望它有所帮助。

# ruby - 有效地截断 Ruby Time 对象

> ID：912139
> 
> 赞同：4
> 
> 时间：2009-05-26T18:54:38.730
> 
> 标签：ruby, date, time, truncate

我正在尝试提出一种有效的方法来根据给定的分辨率截断 Ruby Time 对象。

```
class Time
  def truncate resolution
    t = to_a
    case resolution
    when :min   
      t[0] = 0
    when :hour
      t[0] = t[1] = 0
    when :day
      t[0] = t[1] = 0
      t[2] = 1
    when :month 
      t[0] = t[1] = 0
      t[2] = t[3] = 1
    when :week  
      t[0] = t[1] = 0
      t[2] = 1
      t[3] -= t[6] - 1
    when :year
      t[0] = t[1] = 0
      t[2] = t[3] = t[4] = 1
    end

    Time.local *t
  end
end 
```

有谁知道实现相同任务的更快版本？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-26T19:14:32.000

这已经在 Rails 的 ActiveSupport 库的[Time extensions](http://api.rubyonrails.org/classes/ActiveSupport/CoreExtensions/Time/Calculations.html)中为您实现。查看`change`方法，以及各种`at_beginning_of_*`方法。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-26T20:51:11.773

感谢你们俩。因为我不使用 Rails，所以我复制了代码来执行性能基准测试。

```
require 'benchmark'

class Time
  def truncate resolution
    t = to_a
    case resolution
    when :min   
      t[0] = 0
    when :hour
      t[0] = t[1] = 0
    when :day
      t[0] = t[1] = t[2] = 0
    when :week  
      t[0] = t[1] = t[2] = 0
      t[3] -= t[6] - 1
    when :month 
      t[0] = t[1] = t[2] = 0
      t[3] = 1
    when :year
      t[0] = t[1] = t[2] = 0
      t[3] = t[4] = 1
    end

    Time.local *t 
  end

  def truncate2 resolution
    opts = {}

    case resolution
    when :min   
      opts[:sec] = 0
    when :hour
      opts[:sec] = opts[:min] = 0
    when :day
      opts[:sec] = opts[:min] = opts[:hour] = 0
    when :week  
      opts[:sec] = opts[:min] = opts[:hour] = 0
      opts[:day] = wday - 1 if wday != 1
    when :month 
      opts[:sec] = opts[:min] = opts[:hour] = 0
      opts[:day] = 1
    when :year
      opts[:sec] = opts[:min] = opts[:hour] = 0
      opts[:day] = opts[:month] = 1
    end

    change opts 
  end

  def truncate3 resolution
    t = to_a
    if resolution == :week
      t[0] = t[1] = 0
      t[2] = 1
      t[3] -= t[6] - 1
    else
      len = [:sec, :min, :hour, :day, :month, :year].index(resolution)
      t.fill(0, 0, len)
      t.fill(1, 3, len-3)
    end

    Time.local *t
  end    

  def change opts 
    Time.local(
      opts[:year]  || year,
      opts[:month] || month,
      opts[:day]   || day,
      opts[:hour]  || hour,
      opts[:min]   || (opts[:hour] ? 0 : min),
      opts[:sec]   || ((opts[:hour] || opts[:min]) ? 0 : sec),
    )
  end
end

Resolutions = [:sec, :min, :hour, :day, :week, :month, :year]

# Correctness check.
puts Resolutions.map { |r| "#{r}: #{Time.now.truncate r}" } << "\n"
puts Resolutions.map { |r| "#{r}: #{Time.now.truncate2 r}" } << "\n"
puts Resolutions.map { |r| "#{r}: #{Time.now.truncate3 r}" } << "\n"

n = 100000
now = Time.now

Benchmark.bm(10) do |x|
  x.report("truncate") { n.times { Resolutions.each { |r| now.truncate  r } } }
  x.report("truncate2") { n.times { Resolutions.each { |r| now.truncate2 r } } }
  x.report("truncate3") { n.times { Resolutions.each { |r| now.truncate3 r } } }
end

Benchmark.bm(10) do |x|
  Resolutions.each do |unit| 
    x.report("#{unit}") { n.times { now.truncate unit } }
    x.report("#{unit}2") { n.times { now.truncate2 unit } }
    x.report("#{unit}3") { n.times { now.truncate3 unit } }
  end
end 
```

结果如下：

```
sec: 2009-05-26 13:44:20 -0700
min: 2009-05-26 13:44:00 -0700
hour: 2009-05-26 13:00:00 -0700
day: 2009-05-26 00:00:00 -0700
week: 2009-05-25 00:00:00 -0700
month: 2009-05-01 00:00:00 -0700
year: 2008-12-31 23:00:00 -0800

sec: 2009-05-26 13:44:20 -0700
min: 2009-05-26 13:44:00 -0700
hour: 2009-05-26 13:00:00 -0700
day: 2009-05-26 00:00:00 -0700
week: 2009-05-01 00:00:00 -0700
month: 2009-05-01 00:00:00 -0700
year: 2009-01-01 00:00:00 -0800

sec: 2009-05-26 13:44:20 -0700
min: 2009-05-26 13:44:00 -0700
hour: 2009-05-26 13:00:00 -0700
day: 2009-05-26 00:00:00 -0700
week: 2009-05-25 01:00:00 -0700
month: 2009-05-01 00:00:00 -0700
year: 2008-12-31 23:00:00 -0800

                user     system      total        real
truncate    5.910000   0.020000   5.930000 (  5.947453)
truncate2   6.180000   0.020000   6.200000 (  6.232918)
truncate3   6.150000   0.020000   6.170000 (  6.253931)
                user     system      total        real
sec         0.720000   0.000000   0.720000 (  0.749040)
sec2        0.830000   0.010000   0.840000 (  0.863029)
sec3        0.800000   0.000000   0.800000 (  0.820477)
min         0.700000   0.000000   0.700000 (  0.709238)
min2        0.860000   0.010000   0.870000 (  0.860168)
min3        0.770000   0.000000   0.770000 (  0.795734)
hour        0.680000   0.000000   0.680000 (  0.705306)
hour2       0.850000   0.010000   0.860000 (  0.867235)
hour3       0.740000   0.000000   0.740000 (  0.746338)
day         0.720000   0.000000   0.720000 (  0.724324)
day2        0.890000   0.010000   0.900000 (  0.894312)
day3        0.780000   0.000000   0.780000 (  0.788007)
week        0.730000   0.000000   0.730000 (  0.736604)
week2       0.910000   0.000000   0.910000 (  0.910925)
week3       0.600000   0.000000   0.600000 (  0.611683)
month       0.720000   0.000000   0.720000 (  0.719515)
month2      0.880000   0.010000   0.890000 (  0.888045)
month3      0.780000   0.000000   0.780000 (  0.789726)
year        1.540000   0.010000   1.550000 (  1.565335)
year2       0.830000   0.000000   0.830000 (  0.849737)
year3       1.600000   0.010000   1.610000 (  1.644958) 
```

似乎我的第一个截断版本仍然是最有效的，除了 year 案例。一年中有一个小`truncate`怪癖`truncate3`。它显示为

```
2008-12-31 23:00:00 -0800 
```

而不是

```
2009-01-01 00:00:00 -0700 
```

任何想法为什么？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-26T19:44:55.633

如果你不想要 Greg 建议的 ActiveSupport，我认为你可以做这样的事情

```
t = to_a
if resolution==:week
  t[0] = t[1] = 0
  t[2] = 1
  t[3] -= t[6] - 1
else
  len = [:sec, :min, :hour, :day, :month, :year].index(resolution)
  t.fill(0, 0,len)
  t.fill(1, 3,len-3)
end
Time.local *t 
```

不知道是不是更快...

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-28T15:14:31.600

您不必使用 Rails 来使用 ActiveSupport 好东西。除了想要使用诸如**1.day**或**3.minutes**或**Time.now.beginning__of__day 之类的东西之外，我还遇到了这个确切的问题**

```
irb(main):001:0> require 'rubygems'
=> true
irb(main):002:0> require 'activesupport'
=> true
irb(main):003:0> 1.day
=> 1 day
irb(main):004:0> 3.minutes
=> 180 seconds
irb(main):005:0> Time.now.beginning_of_day
=> Sun Jun 28 00:00:00 -0400 2009
irb(main):006:0> 
```

# asp.net - 将网站置于维护模式？

> ID：912142
> 
> 赞同：16
> 
> 时间：2009-05-26T18:55:54.517
> 
> 标签：asp.net, maintenance

我开发了我的第一个 Web 应用程序，令人惊讶的是，它变得非常流行。

由于该网站现已上线，我很难进行一些更改，因为担心有些人仍然登录并正在使用该应用程序。

我希望避免使用重复的 Web 应用程序实例进行测试。

有没有办法让网站进入“维护模式”，只有我可以访问它？就像重定向到包含一些信息的页面，告诉它处于维护模式。

谢谢。:-)

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2009-05-26T18:59:44.540

> 我希望避免使用重复的 Web 应用程序实例进行测试。

**那是你的问题**。除了最琐碎的站点之外，您应该有一个登台或开发实例。您应该使用源代码管理并有一个脚本来更新主实例。

* * *

## 回答 #2

> 赞同：27
> 
> 时间：2009-05-26T18:58:02.890

*`app_offline.htm`*您可以简单地在您网站的根目录中放置一个名为的文件，ASP.NET 会自动将所有流量路由到该页面。该文件可以包含任何您希望表明您的站点由于维护而在短时间内关闭的 HTML。

有关更多信息，请阅读[App_Offline.htm 并解决“IE 友好错误”功能](http://weblogs.asp.net/scottgu/archive/2006/04/09/442332.aspx)：

> app_offline.htm 的工作方式是将此文件放在应用程序的根目录中。当 ASP.NET 看到它时，它将关闭应用程序的应用程序域（而不是为请求重新启动它），而是发回 app_offline.htm 文件的内容以响应应用程序的所有新动态请求。完成网站更新后，只需删除文件，它就会重新上线。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2011-07-05T10:25:16.860

这是您问题的答案：http: [//www.codeproject.com/Tips/219637/Put-the-website-in-Maintanance-Mode-Under-Construc](http://www.codeproject.com/Tips/219637/Put-the-website-in-Maintanance-Mode-Under-Construc)

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-05-26T18:59:42.480

在 ASP.NET 中没有这样的内置功能，除了[app_offline.htm](http://weblogs.asp.net/scottgu/archive/2005/10/06/426755.aspx)，它不能完全满足您的需求，因为即使您也会被拒绝访问该站点。您必须自己构建它，但最好在路由器和负载均衡器级别而不是在应用程序级别完成。当然，这取决于您的网络架构。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-26T20:54:24.857

除了构建您网站的开发副本以构建补丁和修复之外，您不能提前几天宣布站点关闭进行维护吗？我不是网络程序员，但您可能想了解[Hattrick](http://www.hattrick.org)，一个流行的在线足球管理，用于维护他们的网站。他们在用户登录后使用主页上的通知系统，宣布何时进行维护（通常在欧洲的深夜，大部分玩家和所有开发人员都位于），然后他们关闭了网站大概几个小时。当他们关闭网站时，他们会发布一个页面，使用与网站其余部分相同的样式，并提供它何时会重新启动和运行的估计。简单、优雅，再加上长期的预警，它似乎可以很好地安抚用户群。

让用户提前知道计划进行维护，并让他们了解它的用途，大多数人将能够适应停机时间。没有什么比故意访问一个在 10 到 20 分钟前启动并运行的网络应用程序发现它突然不可用并停止维护更令人沮丧的了。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-26T18:58:51.390

试试[app_offline.htm](http://weblogs.asp.net/scottgu/archive/2005/10/06/426755.aspx) ??

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-26T18:58:31.890

什么版本的 ASP.NET？我敢肯定还有一百万种更优雅的方法可以做到这一点，但是您可以更改 IIS 中的默认文档以重定向到 Maint.html（或类似的）。

# regex - MS Word中的正则表达式获取找到的单词之前的单词？

> ID：912143
> 
> 赞同：0
> 
> 时间：2009-05-26T18:55:59.820
> 
> 标签：regex, ms-word

基本上我正在使用 MS Word 的查找和替换功能（通配符：true）

但我必须编辑的文本包含扰乱搜索的内容：

```
//more text in different format above

<file name="london_bitmap" bits="24", owner="sergio"> 1 2 3 </file>
<file name="paris_bitmap" bits="24", owner="sergio"> 1 2 3 </file>
<file name="moscow_bitmap" bits="24", owner="sergio"> 1 2 3 </file> 
```

我想用 bmp 前缀替换位图，所以：

```
<file name="bmp_london" bits="24", owner="sergio"> 1 2 3 </file> 
```

当我使用这样的东西时：

```
(<*>)_(<bitmap>) 
```

它捕获的不是 1 行，而是它可以找到的所有内容，直到它点击“位图”

关于如何解决这个问题的任何想法？也许但是在“位图”之前得到这个词？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-26T19:28:09.663

以下作品（在 Word 2003 中）作为搜索字符串

```
([!"]@)_(<bitmap>) 
```

[!"] 部分表示：匹配任何**不是**双引号字符的单个字符，@ 限定符表示“至少找到前面的一个”。替换表达式（我希望您已经知道 :) 是

```
bmp_\1 
```

希望这可以帮助！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-26T19:22:14.307

不确定 word 是否支持惰性求值，但您可以尝试将 * 替换为 *？

# asp.net - ASp.Net Gridview 比父 DIV 更宽

> ID：912145
> 
> 赞同：1
> 
> 时间：2009-05-26T18:56:51.207
> 
> 标签：asp.net, gridview, html

问题页面：http://www。韦伯相信。com/ShowThread.aspx?ID=521

如果您将浏览器设置为 1024x768，您将看到 GridView 表将延伸到 div“postbody”之外。我不知道如何阻止这种情况发生。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-26T19:08:27.113

由于表格的性质，有一个最小宽度不能低于此宽度，该宽度由每个表格行中项目的宽度决定。我假设您已经为 GridView 控件指定了宽度，但由于数据太大，它仍然溢出。您可以尝试将 GridView 添加到另一个 div 并为该 div 指定 css 属性以控制溢出，如下所示：

```
<div style="overflow: scroll; width: 800px; Height: 300px;">
   <asp:GridView id="GridView1" runat="server"  />
</div> 
```

现在，如果您的 GridView 超出了包含 div 的尺寸，则 div 的大小将保持静态，并且任何溢出都会提示出现滚动条。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-26T19:10:22.040

从 div 本身中删除任何固定宽度，而是通过 CSS 将边距应用于 div 并填充到数据网格。

这应该允许数据网格始终包含在具有相同数量的空白的 div 中，无论数据网格的大小如何。

# linux - “rsyslogd”消耗170M内存正常吗？

> ID：912171
> 
> 赞同：5
> 
> 时间：2009-05-26T19:04:09.820
> 
> 标签：linux, bash

我的一个网站运行速度极慢，

我使用`top`命令查看“rsyslogd”花费了 170M 内存，

这正常吗？

如果没有，我该如何限制内存“rsyslogd”成本的大小，或“rsyslogd”的频率

运行？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2015-10-07T20:05:00.653

是和否。通常您使用的是文件/磁盘队列模式。它将写入缓存到缓冲区并一次写出一个块，而不是一次一行地一行一行地打开和关闭；减少不必要的小磁盘访问。

问题在于它为每个记录的文件创建了一个 10MB 的缓冲区。20 个日志文件意味着 200+MB。日志文件的数量总是可以减少的，但如果您没有运行 raid（大块）或高需求系统，也可以减少缓冲区大小。文档在这里：[http](http://www.rsyslog.com/doc/v8-stable/concepts/queues.html#disk-queues) : //www.rsyslog.com/doc/v8-stable/concepts/queues.html#disk-queues，“$<object>QueueMaxFileSize”来减小每个缓冲区的大小。4MB 可以减少到 70MB

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-26T19:23:16.007

听起来你有一些进程记录太多信息。你可能只看日志，看看谁在写所有的东西，看看你能不能让他们停下来。当某些程序出现反复出现的错误导致它每秒记录数千次相同的错误消息时，我已经看到日志达到千兆字节大小。认真检查日志，看看到底是谁在敲打 rsyslogd。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-26T19:35:38.523

不能有““rsyslogd”运行的频率”，因为它是一个守护进程，提供日志记录工具。正如 Robert S.Barnes 指出的那样，您最好检查日志以确定应用程序，即阻塞 rsyslogd（哈！）。日志的名称是特定于操作系统的，但很有可能它们位于 /var/log 及其子目录中。我见过 rsyslogd 消耗相对大量的内存，但是 170Mb 太多了，根本不正常。

无耻的题外话编辑：我有 serverfault 和 stackoverflow 选项卡并排，老实说，在我实际提交答案之前，我 100% 确定我正在发布到 serverfault（这应该是给你的提示）：P

# macos - 如何在 MacO 的终端中找出正在执行的命令

> ID：912183
> 
> 赞同：0
> 
> 时间：2009-05-26T19:06:06.900
> 
> 标签：macos

在我运行一个 shell 脚本（根据条件调用一堆其他脚本。这太复杂而难以理解）之后，我可以在我的 MacOS 终端上执行命令“gdbclient”。

但是当我执行“which gdbclient”和“alias gdbclient”时，它什么也没显示。无论如何我要找出'gdbclient'实际上在做什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-26T19:16:46.753

您可以使用活动监视器非常彻底地检查事情。要获得正确的权限以查看正在发生的*一切*，您可以执行以下操作：

```
sudo open /Applications/Utilities/Activity\ Monitor.app/ 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-26T19:20:12.080

Dtrace 可以为您提供一些有用的信息：[dtrace](http://www.macosxhints.com/article.php?story=20071031121823710)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-26T19:09:46.220

您可以打开另一个终端窗口并输入：**ps**

这将列出所有正在运行的进程。

如果您的脚本以与当前用户不同的用户身份运行，则可以使用**ps -ef**列出所有正在运行的进程。

如果您知道运行脚本的进程的 PID，则可以使用**ps -f |通过父 PID 找到所有子进程。grep [pid]**

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-27T15:39:44.197

查找进程“gdbclient”：

```
ps aux | grep gdbclient 
```

这不会告诉你它在“做什么”，但它正在运行

# c# - Linq Distinct() 按名称填充带有名称和值的下拉列表

> ID：912188
> 
> 赞同：33
> 
> 时间：2009-05-26T19:08:50.747
> 
> 标签：c#, linq-to-sql, distinct

我正在尝试用拜耳、Medley 等制药公司填充下拉列表。而且，我从 DB 中获取这些名称，并且这些名称在 DB 中重复，但具有不同的 id。

我正在尝试使用 Linq Distinct()，但我不想使用相等比较器。还有其他方法吗？

我的下拉列表必须填写公司的 ID 和名称。

我正在尝试类似的东西：

```
var x = _partnerService
           .SelectPartners()
           .Select(c => new {codPartner = c.codPartner, name = c.name})
           .Distinct(); 
```

这显示了 ddl 中的重复公司。

谢谢！

* * *

## 回答 #1

> 赞同：76
> 
> 时间：2009-05-26T19:29:11.983

以下表达式将仅选择不同的公司并返回第一次出现的公司及其 id。

```
partnerService.SelectPartners().GroupBy(p => p.Name).Select(g => g.First()); 
```

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2009-05-26T19:24:29.123

```
var distinctCompanies = Companies
  .GroupBy(c => c.CompanyName)
  .Select(g => g.First()); 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-26T19:13:17.337

Distinct 适用于整个选择。如果您在选择中包含 c.codPartner，并且对于相同的 c.name 有两个不同的 c.codPartner 值，那么您将看到具有相同 c.name 的两行。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-26T19:19:24.877

我不认为你可以用匿名类来做到这一点，但如果你创建了一个像这样的数据对象

```
 class Foo
{
    private int _ID;

    public int ID
    {
        get { return _ID; }
        set { _ID = value; }
    }
    private string _Name;

    public string Name
    {
        get { return _Name; }
        set { _Name = value; }
    }

} 
```

您可以创建一个比较器对象，例如

```
 class FooComparer : IEqualityComparer<Foo>
{

    public bool Equals(Foo x, Foo y)
    {
        return x.Name == y.Name;
    }

    public int GetHashCode(Foo obj)
    {
        return obj.GetHashCode();
    }

} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-26T19:17:30.417

如果您没有指定 IEqualityComparer 参数，那么它将只使用 Object.ReferenceEquals，它查看对象的 GetHashKey 值。对于匿名类型，它们是唯一的。

现在解决这个问题有点棘手，因为您不能为匿名类型编写 IEqualityComparer。所以你必须为这个问题创建一个真实的类型：

```
class Partner
{
    public int codPartner {get; set;}
    public string name {get; set;}
    public override int GetHashCode() { return name .GetHashCode();}
}

var x = _partnerService.SelectPartners()
        .Select(c => new Partner {codPartner = c.codPartner, name = c.name})
        .Distinct(); 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-26T19:28:18.867

如果您不告诉 Distinc（通过 IEqualityComparer）使用另一种方法，则 Distinc 将使用 GetHashCode。您可以使用通用的相等比较器，如下所示：

```
public class GenericEqualityComparer<T> : IEqualityComparer<T>
{    
    private Func<T, T, Boolean> comparer;    

    public GenericEqualityComparer(Func<T, T, Boolean> comparer)    
    {        
        this.comparer = comparer;    
    }    

    #region IEqualityComparer<T> Implementation

    public bool Equals(T x, T y)    
    {        
        return comparer(x, y);    
    }    

    public int GetHashCode(T obj)    
    {
        return obj.GetHashCode();  
    }    

    #endregion
} 
```

然后像这样使用（种类）

```
public static IEqualityComparer<YourType> MyComparer
{
   get
     {
      return new GenericEqualityComparer<YourType>((x, y) =>
       {
          return x.name.Equals(y.name);
        });
      }
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-26T19:15:25.117

只需使用其他重载之一将您自己的比较器传递给 Distinct 方法。

```
(extension) IQueryable<T> IQueryable<T>.Distinct( IEqualityComparer<T> comparer ) 
```

# java - 通用最大 jstl 函数

> ID：912189
> 
> 赞同：1
> 
> 时间：2009-05-26T19:08:56.037
> 
> 标签：java, generics

我的 jstl 中需要一个 max 函数，因此我正在编写一个静态函数并将其作为 jstl 函数在 tld 中公开。

问题是，我不知道参数是什么类型，int、long、double 等。我必须为每种数据类型创建一个函数吗？或者也许我可以只为双打编写函数，并祈祷 jstl 会为我做转换？

**edit2**：没关系，我认为 tld 定义就像 T max(T,T) 一样简单，但事实并非如此。我不知道如何为泛型方法定义顶级域名。我想我只是祈祷 jsp 能正确转换我的类型并使用 Math.max(double, double)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-26T19:17:13.460

它是一个 max 函数，比如`Math.max()`（取两个参数，返回较大的），还是类似的`Arrays.sort()`（取一个数组，返回最大的）。

在第一种情况下，如果可能，JSP EL 将强制将参数转换为正确的类型。

在第二种情况下，您想要支持的每个原始数组组件类型都需要一个不同的方法。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-26T19:33:35.610

试试这个：

```
public static <T extends Comparable<? super T>> T max(T a, T b) {
    if (a.compareTo(b) > 0) {
        return a;
    } else {
        return b;
    }
}

public static void main(String[] args) {
    System.out.println(max(20, 10));
    System.out.println(max(103.2, 120.2));
    // it works even on strings...
    System.out.println(max("aaa", "bbb"));  
    // ... and booleans...
    System.out.println(max(true, false));  
} 
```

或者，您可以使用标准 Java 类，例如`Collections`and `Arrays`：

```
Collections.max(Arrays.asList(10, 20, 30, 40, 50)); 
```

# xml - 基于兄弟节点的值与 XPath 匹配节点

> ID：912194
> 
> 赞同：92
> 
> 时间：2009-05-26T19:10:33.817
> 
> 标签：xml, xpath

拥有这样的 XML 文档：

```
<?xml version="1.0" encoding="UTF-8"?>
<records type="array">
  <record>
    <name>svn</name>
    <record-type>A</record-type>
    <ttl type="integer">86400</ttl>
    <zone-id type="integer">69075</zone-id>
    <aux type="integer">0</aux>
    <id type="integer">xxx</id>
    <active>Y</active>
    <data>xxx.xxx.xxx.xxx</data>
  </record>
  <record>
    <name>domain.tld.</name>
    <record-type>NS</record-type>
    <ttl type="integer">86400</ttl>
    <zone-id type="integer">xxx</zone-id>
    <aux type="integer">0</aux>
    <id type="integer">xxx</id>
    <active>Y</active>
    <data>domain.tld.</data>
  </record>
  <record>
    <name>blog</name>
    <record-type>A</record-type>
    <ttl type="integer">86400</ttl>
    <zone-id type="integer">xxx</zone-id>
    <aux type="integer">0</aux>
    <id type="integer">xxx</id>
    <active>Y</active>
    <data>xxx.xxx.xxx.xxx</data>
  </record>
</records> 
```

如何将所有`/records/record/name`具有兄弟姐妹`/records/record/record-type`的价值与价值相匹配`A`？

* * *

## 回答 #1

> 赞同：107
> 
> 时间：2009-05-26T19:29:20.347

找到了：

```
/records/record/name[../record-type/text() = "A"] 
```

* * *

## 回答 #2

> 赞同：62
> 
> 时间：2015-06-29T14:50:04.650

*令人惊讶的是，迄今为止关于这个老问题的答案都没有提供**最简单**的XPath 解决方案。*

**这个简单的 XPath**

```
/records/record[record-type = "A"]/name 
```

**选择**

```
<name>svn</name>
<name>blog</name> 
```

**按照要求。**

* * *

## 回答 #3

> 赞同：38
> 
> 时间：2012-07-19T12:16:57.067

您还可以通过子元素过滤父元素：

`/records/record[record-type[text()='A']]/name`

# ruby-on-rails - 如何根据当前语言环境渲染不同的部分

> ID：912197
> 
> 赞同：3
> 
> 时间：2009-05-26T19:11:10.180
> 
> 标签：ruby-on-rails, ruby

我得到了 index.erb 和 index-de.erb，在某个地方我看到了一个示例，当 I18n.locale 为 :de 时，这导致 index-de 被渲染，但我只是尝试过，但它不起作用，我找不到任何关于这个主题的文档。那么这真的有效还是我需要一个额外的插件呢？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-27T05:28:09.740

它们必须被命名为 index.LOCALE.EXTENSION 所以例如 index.de.erb 或 index.de.html.erb 用于 de locale (I18n.locale)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-26T19:15:19.033

从 2.2 开始，本地化已内置到 rails；您可能需要查看[i18n 截屏视频](http://railscasts.com/episodes/138-i18n)和/或[指南](http://guides.rubyonrails.org/i18n.html)。

编辑：特别是查看指南的第 3.3 节“本地化视图”。简短的回答是正确的文件名是 index.de.html.erb。

# c# - IIS7 添加新网站/主机头 ASP.NET Web 表单

> ID：912198
> 
> 赞同：1
> 
> 时间：2009-05-26T19:11:39.727
> 
> 标签：c#, asp.net, vb.net, iis-7

如何从代码创建新网站或将主机标头添加到现有 IIS 7 服务器？

我已经看过并且无法找到一个有效的例子？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-26T19:30:22.513

一种解决方案是创建一个为您完成工作的自定义 HttpModule，但它确实需要您拥有一个支持通配符 (*) 的 DNS。如果您的 DNS 不支持，您可能会考虑管理自己的 DNS。

也就是说，这是一篇关于创建 HttpModule 的好帖子，它解析传入的“子域”并将流量转发到适当的位置。他正在使用一种搜索机制[查找与子域匹配的关键字的内容]，但可以根据您自己的需要进行修改。

[http://codebetter.com/blogs/brendan.tompkins/archive/2006/06/27/146875.aspx](http://codebetter.com/blogs/brendan.tompkins/archive/2006/06/27/146875.aspx)

[编辑] 另一种解决方案是找到一个提供可编程 DNS 服务的 DNS 提供商，可能通过 Web 服务。然后，您可以在应用程序需要时以编程方式将子域添加到该 DNS。这是一个超级简化的解释，并没有考虑到您的业务需求。我个人更喜欢在应用程序中添加子域的 HttpModule 选项，因为它需要对所涉及的服务器进行较少的修改。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-26T20:26:46.190

您使用的是什么版本的 .Net？

如果您使用的是 .Net 3.0 或 3.5，并且您只需要配置 IIS7（不是 6 或 5），请查看 Microsoft.Web.Administration 命名空间——它应该有您需要的一切。

如果您使用的是旧版本的 .net，请查看 WMI。

我没有 IIS 7 的任何 WMI 代码（我们有一个 Intranet 应用程序的设置，但它使用与 IIS 6 兼容的 WMI）。但是，这里有一个工具的链接，您可以使用它来找出 WMI 的东西：[http](http://www.microsoft.com/downloads/details.aspx?familyid=2cc30a64-ea15-4661-8da4-55bbc145c30e&displaylang=en) ://www.microsoft.com/downloads/details.aspx?familyid=2cc30a64-ea15-4661-8da4-55bbc145c30e&displaylang=en 它实际上会生成用于操作 WMI 的 c#（或 vb.net）代码。对于 IIS 7，我认为根 WMI 命名空间是 root\WebAdministration。

另外，请查看此链接，它可能有助于[使用 CIM Studio 了解 IIS 7.0 WMI 提供程序](http://learn.iis.net/page.aspx/265/get-to-know-the-iis7-wmi-provider-using-cim-studio/)

# vb6 - 如何在 vb6 中更改 DCOM 的 guid？

> ID：912199
> 
> 赞同：0
> 
> 时间：2009-05-26T19:12:18.447
> 
> 标签：vb6, guid, dcom

我有一个 Windows 服务，它使用某个 guid A 实例化一个 dcom 对象。

我需要用新版本替换那个 dcom 对象。当我创建和编译我的替换 dcom 对象时，它是使用 guid B 创建的。

如何将替换 dcom 对象的 guid 从 guid B 更改为 guidA？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-26T19:17:42.303

如果您尝试更改“服务器”端的 ID（发布该特定类的 DLL 或应用程序），当您在项目属性的“组件”选项卡中选择“不兼容”时，VB 会为您执行此操作。

如果您尝试更改在“客户端”（使用由另一个 dll/app 发布的类的 DLL 或应用程序）中实例化的对象，则需要更改引用（通过引用或组件，具体取决于我们正在谈论什么样的对象），以便您指向新版本的服务器（使用更新的 GUID 发布他的类的那个）。这意味着删除当前引用并添加对新服务器的引用。如果名称没有改变，其他一切都应该像以前一样工作，显然类的接口有微小的变化。

据我所知，您无法直接访问 VB6 中的 GUID。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-26T19:51:47.557

我设法重新编译了我的替换 DCOM 对象并让它使用 Guid A...

1.  从注册表中删除所有对 Guid B 的引用
2.  删除我的替换 DCOM 对象 exe 文件
3.  复制原DCOM exe文件
4.  将原来的 DCOM exe 文件重命名为替换名称
5.  重新编译vb项目

我猜当 VB 替换 exe 文件时，它会查找 GUID，然后将其重用于重新编译的版本。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-29T07:36:44.970

您应该将您的应用程序（替换 DCOM 对象）编译为与现有 dll 二进制兼容，这样它将继承相同的 GUID 并且版本号将增加。如果你用替换覆盖现有的 DCOM dll，一切都应该工作。

例如，在 VB6 中，您可以在项目对话设置中指定二进制兼容性。不确定你在哪里为 C++ 设置它，我认为 GUID 嵌入在源代码中。

# fiddler - 如何让 Fiddler 报告本地 PC 上的 HTTP 连接

> ID：912202
> 
> 赞同：1
> 
> 时间：2009-05-26T19:13:03.593
> 
> 标签：fiddler

我有一个客户端和一个服务器，它们都在本地机器上，并且它们使用 Web 服务。如何让 Fiddler 报告这些连接？

它似乎只想报告与其他 PC 的连接。

注意：我实际上找到了答案。 [http://www.fiddler2.com/Fiddler/help/hookup.asp#Q-LocalTraffic](http://www.fiddler2.com/Fiddler/help/hookup.asp#Q-LocalTraffic)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-26T19:16:44.490

您必须在 localhost 之后添加句点 (.) 或使用机器名称作为要在浏览器中查看流量的站点的 URL。

例如：

```
http://localhost./foo.html 
```

或者：

```
http://mymachinename/foo.html 
```

有关提琴手的已知记录问题，请参见[此处](http://www.fiddler2.com/Fiddler/help/knownissues.asp)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-26T19:20:55.730

有一个名为“过滤器”的选项卡，您可以在其中设置要忽略的主机列表。

希望这可以帮助！

# php - 我可以在 PHP 中使用 twitter 或 myspace 之类的直接 URL

> ID：912217
> 
> 赞同：3
> 
> 时间：2009-05-26T19:15:57.923
> 
> 标签：php, html, url

我可以做 twitter 和许多其他网站在 url 显示用户页面的地方做的事情吗？

www.mysite.com/the_user_name

在 php 中......或者如何做到这一点？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-26T19:18:54.173

查看如何[在 .htaccess 中使用 mod_rewrite 模块](https://stackoverflow.com/questions/623161/help-with-basic-htaccess-modrewrite)。

这里有一些 ALA 的优点：

1.  [如何使用 URL 取得成功](http://www.alistapart.com/articles/succeed/)
2.  [网址！网址！网址！](http://www.alistapart.com/articles/urls/)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-26T19:20:04.250

最简单的方法是[`mod_rewrite`](http://httpd.apache.org/docs/1.3/mod/mod_rewrite.html)在 Apache 中使用（而不是在 PHP 中使用）。这是一个很好[的初学者指南](http://www.workingwith.me.uk/articles/scripting/mod_rewrite)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-26T19:19:19.510

我知道的最简单的方法是在打开 RewriteEngine 的情况下为网站创建一个 .htaccess 文件。

例如

```
RewriteEngine On

RewriteRule ^(.+) /index.php?user=$1 
```

谷歌搜索 .htaccess 和 RewriteEngine 以更好地掌握流程或创建 .htaccess 文件。

# jquery - Round speedometer with Jquery / CSS in a browser

> ID：912245
> 
> 赞同：0
> 
> 时间：2009-05-26T19:22:26.913
> 
> 标签：jquery, iphone, rounding, jquery-1.3

I need to make a round object much like a speedometer (with moving needle inside indicating a value) in a browser. currently for all other items on this page iam using jquery. I rather not use flash as it needs to be ipod / iphone usable.

Any experience others have had doing this is greatly appreciated.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-26T20:09:30.297

Check out this **[speedometer](http://windyroad.org/2007/04/13/javascript-speedometer-poc/)** created using Javascript/css and some **[analog clocks](http://randomibis.com/coolclock/)** in Javascript/css as well.

You can use the source in those as a starting point for what you are trying to accomplish.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-26T20:15:44.403

You might consider using [Processing.js](http://processingjs.org/), which was ported to JS by John Resig, the same guy who invented jQuery. It allows you to draw any sort of primitive on an HTML Canvas. It supports all major browsers (from the website):

> Processing.js runs in FireFox, Safari, Opera, Chrome and will also work with Internet Explorer, using Explorer Canvas.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-01-24T09:36:49.070

There is also now a specific 'speedomiter' plug in for jquery - looks nice and simple also appears to have good cross browser compatability.

[http://plugins.jquery.com/node/14397/release](http://plugins.jquery.com/node/14397/release)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-04-25T03:59:27.177

You encountered the same requirement as I did. I've written a flot plugin by modifying the flot.pie.js, here is the code effect

[http://dl.iteye.com/upload/attachment/469925/a6d6c376-d661-3fa5-bc23-ed15b803da10.jpg](http://dl.iteye.com/upload/attachment/469925/a6d6c376-d661-3fa5-bc23-ed15b803da10.jpg)

and you can retrieve the source from: [http://georgezeng.iteye.com/admin/blogs/1014349](http://georgezeng.iteye.com/admin/blogs/1014349)

note: You should use this js with flot.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-02-23T18:05:32.827

Here is a speedometer which may work you. [http://dejapong.com/?p=138](http://dejapong.com/?p=138). It does require raphael.js, but that is not a large library (61k).

The plugin allows you to adjust lighting, and face colors, along with a couple other features.

# c++ - (x < 0) 或 (x == -1) 哪个更快？

> ID：912256
> 
> 赞同：35
> 
> 时间：2009-05-26T19:26:02.570
> 
> 标签：c++, c, performance, optimization, cpu

变量`x`是具有可能值的 int `-1, 0, 1, 2, 3`：。哪个表达式会更快（在 CPU 滴答声中）：

```
1\. (x < 0)
2\. (x == -1) 
```

语言：C/C++，但我想所有其他语言都一样。

PS我个人认为答案是`(x < 0)`。

对大师来说更广泛：如果`x`从`-1`到`2^30`怎么办？

* * *

## 回答 #1

> 赞同：80
> 
> 时间：2009-05-26T19:37:28.647

这完全取决于您正在为其编译的 ISA，以及编译器优化器的质量。不要过早地优化：**首先分析以找到您的瓶颈**。

也就是说，在 x86 中，您会发现在大多数情况下两者都同样快。在这两种情况下，您都会有比较 ( `cmp`) 和条件跳转 ( `jCC`) 指令。但是，对于`(x < 0)`某些情况，编译器可能会省略`cmp`指令，从而将您的代码加速*一个完整的周期*。

具体来说，如果该值`x`存储在寄存器中，并且是最近在 EFLAGS 寄存器中设置符号标志 SF 的算术运算（例如`add`、 或`sub`，但还有更多可能性）的结果，则不需要该`cmp`指令，编译器只能发出一条`js`指令。当输入为 -1 时，没有简单的`jCC`指令会跳转。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-05-26T19:34:19.040

试试看！做一百万，或者更好，每个十亿，然后计时。我敢打赌，您的结果没有统计意义，但谁知道——也许在您的平台和编译器上，您可能会找到结果。

这是一个很好的实验，可以让自己相信过早的优化可能不值得你花时间——而且很可能是“[万恶之源——至少在编程中](http://en.wikiquote.org/wiki/Donald_Knuth)”。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-05-26T19:27:38.697

这两个操作都可以在一个 CPU 步骤中完成，因此它们的性能应该相同。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2009-05-27T04:10:27.093

x < 0 会更快。如果没有别的，它会阻止获取常量 -1 作为操作数。大多数架构都有与零进行比较的特殊说明，因此这也会有所帮助。

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2009-05-26T20:59:42.397

它可能取决于比较之前或之后的操作。例如，如果您在进行比较之前为 x 分配了一个值，那么检查符号标志可能比与特定值进行比较更快。或者 CPU 的分支预测性能可能会受到您选择的比较的影响。

但是，正如其他人所说，这取决于 CPU 架构、内存架构、编译器和许多其他东西，所以没有一般​​的答案。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-05-26T19:32:39.873

无论如何，重要的考虑因素是哪个实际上可以准确地指导您的程序流程，而哪个恰好产生相同的结果？

如果 x 实际上是索引或枚举中的值，那么 -1 将始终是您想要的，或者任何负值都有效？目前，-1 是唯一的负面因素，但这可能会改变。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-05-26T19:34:41.897

你甚至不能断章取义地回答这个问题。如果您尝试一个微不足道的微基准测试，优化器完全有可能将您的代码飘入以太：

```
// Get time
int x = -1;
for (int i = 0; i < ONE_JILLION; i++) {
    int dummy = (x < 0); // Poof!  Dummy is ignored.
}
// Compute time difference - in the presence of good optimization
// expect this time difference to be close to useless. 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-05-26T19:27:01.863

同样，这两个操作通常在 1 个时钟内完成。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-05-27T09:01:58.773

这取决于架构，但 x == -1 更容易出错。x < 0 是要走的路。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-05-28T16:41:08.223

正如其他人所说，可能没有任何区别。比较是 CPU 中的基本操作，芯片设计人员希望尽可能快地进行比较。

但是您可以考虑其他一些事情。分析每个值的频率并按该顺序进行比较。这可以为您节省不少周期。当然，您仍然需要将代码编译为 asm 来验证这一点。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-05-28T19:42:08.263

我相信你相信这是一个真正的耗时。

我想问机器会给出比我们任何人都更可靠的答案。

我发现，即使在你所说的代码中，我的假设也不是很正确。例如，如果这是在一个内部循环中，如果有任何类型的函数调用，即使是编译器插入的不可见的，该调用的成本将占主导地位。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2009-08-25T06:38:07.230

尼古拉，你写道：

> 它实际上是高负载程序中的瓶颈算子。这 1-2 个字符串的性能比可读性更有价值......
> 
> 所有的瓶颈通常都这么小，即使在完美的设计和完美的算法中（尽管没有这样的）。我进行高负荷 DNA 处理，并且非常了解我的领域和算法

如果是这样，为什么不做下一步：

1.  获取计时器，将其设置为 0；
2.  **用(x < 0)**编译你的高负载程序；
3.  启动您的程序和计时器；
4.  在程序结束时查看计时器并记住结果1。
5.  同1；
6.  **用(x == -1)**编译你的高负载程序；
7.  同3；
8.  在程序结束时查看计时器并记住结果2。
9.  比较结果 1 和结果 2。

你会得到答案。

# spring - 从字符串转换为 Spring MVC 表单数据绑定的自定义对象？

> ID：912257
> 
> 赞同：22
> 
> 时间：2009-05-26T19:26:46.110
> 
> 标签：spring, data-binding, forms, spring-mvc, persistence

我将 Spring MVC 的 SimpleFormController 与 Spring MVC 的表单 JTL 结合使用来创建一个表单来编辑通用对象。

在我的表单上，我有一个下拉菜单，用户可以通过下拉菜单指定服务器。

```
<form:form commandName="generic">
    <form:select path="server">
        <form:options items="${servers}" itemValue="id" itemLabel="name"/>
    </form:select>
</form:form> 
```

此处的服务器通过对所有可用服务器的数据库调用进行传播。server 是一个 Server ORM pojo，它是另一个 ORM pojo（通用）的子对象，用作我的表单支持对象。

我的目标是更改 Generic 的服务器引用，它在数据库级别表示为服务器表的外键。

我使用 JPA 作为我的持久层，并使用 JPA 生成的实体类作为我的 ORM pojos。

**不幸的是，当我的表单提交时，这似乎没有正确绑定，因为它无法从字符串转换为服务器。**

```
Field error in object 'generic' on field 'server': rejected value [1]; codes [typeMismatch.generic.server,typeMismatch.server,typeMismatch.com.generic.orm.jpa.Server,typeMismatch]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [generic.server,server]; arguments []; default message [server]]; default message [Failed to convert property value of type [java.lang.String] to required type [com.generic.orm.jpa.Server] for property 'server'; nested exception is java.lang.IllegalArgumentException: Cannot convert value of type [java.lang.String] to required type [com.generic.orm.jpa.Server] for property 'server': no matching editors or conversion strategy found], generic=com.generic.orm.jpa.generic[id=3]} and static attributes {} 
```

我一直在寻找一个如何在没有运气的情况下完成此任务的示例。我相信我需要覆盖 SimpleFormController 中的某些内容，就像我在[这个问题](https://stackoverflow.com/questions/706660/spring-mvc-formselect-tag-multiple-selections-not-binding-correctly)中所做的那样，但是 Spring MVC 的文档对细节很清楚。有谁可以帮我离开这里吗？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-05-28T16:08:31.923

作为对马克回答的补充，这就是我最终在控制器中所做的事情。

```
@Override
protected void initBinder(HttpServletRequest request, ServletRequestDataBinder binder) throws Exception {
    binder.registerCustomEditor(Server.class, "serverId", new PropertyEditorSupport() {
        @Override
        public void setAsText(String text) {
            Server type = (Server) em.createNamedQuery("Server.findById")
                .setParameter("id", Short.parseShort(text)).getSingleResult();
            setValue(type);
        }
    });
} 
```

您也可以使用 Spring 注入来执行此操作，而不是匿名类。马克的答案中的[链接](http://static.springframework.org/spring/docs/2.5.x/reference/validation.html#beans-beans-conversion-customeditor-registration)概述了这一点。

您还可以扩展 ClassEditor（见下文）而不是 PropertyEditorSupport。Javadoc 状态；

> java.lang.Class 的属性编辑器，可以直接填充 Class 属性，而无需使用 String 类名属性作为桥梁。

不知道我是否完全理解这样做的好处，但要记住一些事情。

## 有用的 Javadocs

*   [属性编辑器支持](http://java.sun.com/j2se/1.5.0/docs/api/java/beans/PropertyEditorSupport.html)
*   [Spring 数据绑定器](http://static.springframework.org/spring/docs/2.5.x/api/org/springframework/validation/DataBinder.html)
*   [Spring 属性编辑器](http://static.springframework.org/spring/docs/2.5.x/api/org/springframework/beans/propertyeditors/package-summary.html)
*   [Spring 类编辑器](http://static.springframework.org/spring/docs/2.5.x/api/org/springframework/beans/propertyeditors/ClassEditor.html)

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2012-04-20T05:47:02.330

使用“server.id”可能是一种可能的解决方案。所以spring会自动绑定选定的值，反之亦然。

```
<form:form commandName="generic">
    <form:select path="server.id">
        <form:options items="${servers}" itemValue="id" itemLabel="name"/>
    </form:select>
</form:form> 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-05-26T20:55:11.203

我认为你是对的。您需要像以前一样在活页夹上注册自定义编辑器，以便将字符串转换为服务器实例。Spring 参考文档中有一个自定义 PropertyEditor 的示例[，](http://static.springframework.org/spring/docs/2.5.x/reference/validation.html#beans-beans-conversion-customeditor-registration)可以帮助您入门。

我同意 MVC 文档不是最好的。我不得不在 Spring 论坛上进行大量的谷歌搜索和搜索。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-01-30T11:49:16.610

另一个例子：

[http://empire5.com/development/binding-a-custom-object-in-spring-3/](http://empire5.com/development/binding-a-custom-object-in-spring-3/)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2017-03-22T00:04:25.473

答案的注释版本，在您的控制器中：

```
@org.springframework.web.bind.annotation.InitBinder("yourFormName")
protected void initBinder(
             org.springframework.web.bind.WebDataBinder binder) {
    binder.registerCustomEditor(Server.class, "serverId", new PropertyEditorSupport() {
        @Override
        public void setAsText(String text) {
            Server s = ...; // do whatever needed to convert
            setValue(s);
        }
    }); 
```

# jquery - ("span:last-child") 和 arguments.callee 做什么？

> ID：912261
> 
> 赞同：2
> 
> 时间：2009-05-26T19:27:31.037
> 
> 标签：jquery

```
$("span:last-child").hide("fast", function () {
        $(this).prev().hide("fast", arguments.callee); 
    }); 
```

我无法理解代码中的这一点：

1.  `("span:last-child")`： 这是什么？

2.  `arguments.callee`： 这是什么？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-26T19:36:18.787

`$`是主要的 jQuery 函数。

`$("span:last-child")`搜索作为`<span>`其父级的最后一个子级的任何标签。

发现：

```
<div><span>some data </span> something else <span>testing</span></div> 
```

它将找到包含`testing`但不包含`some data`.

然后它隐藏它找到的那些跨度。hide的第二个参数是动画后的回调。该回调转到“前一个”子节点（“其他”文本节点），将其隐藏并将“被调用函数”（arguments.callee）作为回调传递。这使其成为“递归”功能。

`<span>`这将隐藏所有以 a作为最后一个孩子的块的全部内容。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-05-26T19:32:31.870

1.  [`("span:last-child")`表示“如果此跨度是其父级的最后一个子级](http://www.quirksmode.org/css/firstchild.html)
2.  [`arguments.callee`允许函数调用自身](http://arguments.callee.info/category/arguments.callee/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-26T19:35:18.353

`("span:last-child")`返回作为其父级的最后一个子级的所有 span 元素。arguments.callee 看起来像是试图将函数本身传递给下一个函数。本质上它传递了一个函数指针。看起来它所做的是找到 span 对象，然后递归地隐藏所有先前的兄弟姐妹。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-26T19:35:43.703

`span:last-child`选择每个跨度中的最后一个子元素。

`arguments.callee`是对其调用的函数的引用，甚至适用于未命名的函数。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-26T19:36:19.257

("span:last-child") 将匹配作为其父级的最后一个子级的跨度。

arguments.callee 是对被调用的“实际”函数的引用。在这种情况下，只是将相同的隐藏功能分配给最前面的兄弟。实际上创建了一个“新的”最后一个跨度。

# sql-server - SSMS 可以将空格显示为字符吗？

> ID：912263
> 
> 赞同：0
> 
> 时间：2009-05-26T19:28:04.780
> 
> 标签：sql-server, tsql, ssms

现在我正在处理一个数据集，我想返回某个字段不为空的记录。数据集是表连接的结果。

我的结果集仍在返回我告诉不返回 NULL 的字段看起来为空的记录。我想看看这些记录中的真正价值是什么，因为它们似乎不是真正的 NULL。

有没有办法让 Management Studio 将空间显示为一个字符，这样我就可以看到里面有什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-26T19:35:25.780

不是直接的。

您必须修改查询。使用替换将空格变成别的东西？

```
REPLACE(MyCol, ' ', '#') 
```

# c++ - C++ 中具有共享内存的远程代理

> ID：912269
> 
> 赞同：0
> 
> 时间：2009-05-26T19:28:53.810
> 
> 标签：c++, linux, embedded, shared-memory

假设我有一个守护进程，它通过共享内存将其内部状态共享给各种应用程序。进程可以将 IPC 消息发送到命名管道上的守护进程以执行各种操作。在这种情况下，我想为客户端创建一个 C++ 包装类，它充当一种“远程代理”，以隐藏客户端的一些血腥细节（同步、消息传递等），并更容易隔离代码单元测试。

我有三个问题：

*   一般来说，这是一个好主意/方法吗？
*   您在此设置中是否有任何同步技巧或陷阱，或者使用标准的读写器互斥体设置是否足够？
*   有什么我应该考虑的框架吗？

所讨论的目标是具有 2.18 内核的嵌入式 linux 系统，因此内存和编译器功能存在限制。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-26T20:36:26.577

Herb Sutter 有一篇文章[分享是所有争论的根源](http://www.ddj.com/architect/214100002 "分享是一切争论的根源")，我大体同意；如果您使用的是共享内存架构，那么您将面临很多潜在的线程问题。

客户端/服务器模型可以使事情变得非常简单，客户端写入指定的服务器管道，服务器在唯一的客户端管道上写回（或使用套接字）。它还将使单元测试更简单（因为您不必担心测试共享内存），可以避免互斥等。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-26T19:42:15.233

有[Boost.Interprocess](http://www.boost.org/doc/libs/1_39_0/doc/html/interprocess.html)库，但我无法评论它对嵌入式系统的适用性。

# c# - ASP.NET Membership：如何将用户设置为已登录

> ID：912276
> 
> 赞同：32
> 
> 时间：2009-05-26T19:29:43.340
> 
> 标签：c#, asp.net, asp.net-membership, membership

我正在尝试让会员提供者工作。

到目前为止，我有：

```
 <asp:Login ID="Login1" runat="server" OnAuthenticate="Login1_Authenticate">
 </asp:Login> 
```

调用：

```
protected void Login1_Authenticate(object sender, AuthenticateEventArgs e)
{
    if(Membership.ValidateUser(Login1.UserName, Login1.Password))
    {
        Response.Redirect("/admin/default.aspx");
        // Set the user as logged in?
    }
} 
```

如果我输入正确的登录名/密码，ValidateUser 函数将返回 true。所以我的问题是：如何将用户设置为已登录？

我正在我的页面中对此进行测试：

```
protected void Page_Load(object sender, EventArgs e)
{
    if ( Membership.GetUser()==null)
    {
        Response.Redirect("/admin/login.aspx");
    }
    // else "you are logged in, congratulations"                
} 
```

*我会使用默认功能，但它只是不起作用，谷歌搜索让我认为我可以通过自己重新编码来节省时间。*

任何事情都会有所帮助！

**编辑**：关于接受的答案，它是“如何将用户设置为已登录”的正确答案，并且工作正常。它没有解决我的具体问题，但只是其中的一部分。想如果你看一下评论，你会发现有趣的指针。

编辑 2 和解决方案：好的，感谢所有评论，我终于解决了。这是我所做的，它比我预期的要简单：

检查登录状态的页面：

```
 protected void Page_Load(object sender, EventArgs e)
 {
     if ( !Request.IsAuthenticated)
     {
         Response.Redirect("/admin/login.aspx");
     } 
```

登出：

```
 protected void LoginStatus1_Logout(object sender, LoginCancelEventArgs e)
   {
       FormsAuthentication.SignOut();
       Response.Redirect("/admin/login.aspx");
   }
} 
```

网络配置：

```
<authentication mode="Forms" /> 
```

登录：

```
protected void Login1_Authenticate(object sender, AuthenticateEventArgs e)
{
    if(Membership.ValidateUser(Login1.UserName, Login1.Password))
    {
        FormsAuthentication.SetAuthCookie(Login1.UserName, true);
        Response.Redirect("/admin/default.aspx");

    }
} 
```

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2009-05-26T19:32:25.597

`Login1_Authenticate`在打电话之前把这个放进去`Response.Redirect("/admin/default.aspx");`

```
FormsAuthentication.SetAuthCookie("username", true); 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-05-26T19:41:52.740

尝试将您的代码和 Gromer 的建议移至 LoggedIn 事件。

```
protected void Login1_LoggedIn(object sender, EventArgs e)
    {
        if(Membership.ValidateUser(Login1.UserName, Login1.Password))
        {
            FormsAuthentication.SetAuthCookie(Login1.UserName, true);
            Response.Redirect("/admin/default.aspx");
        }

    } 
```

编辑：就像格罗默说的那样，只有在用户登录之后和他/她被重定向之前必须执行一些业务代码时才这样做。

编辑编辑：Visual Studio 将 Authenticate 事件描述为“调用以对用户进行身份验证”，这意味着在调用事件之前未对用户进行身份验证。因此，您无法确认用户已登录，因为他/她尚未通过身份验证。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-26T20:02:00.437

虽然我不知道这会有多大帮助，但这是我用来区分管理员用户或普通用户的样板代码。对我很有用。

在您的登录页面上，可能 onclick 创建您的用户对象并使用此代码调用一些函数（UserRole 是具有您角色的枚举）：

```
If admin Then 
            If role = UserRole.Admin Then
                RedirectFromLoginPage(username & "|" & userid, False)
                Return True
            Else
                Return False
            End If
        Else
            If String.IsNullOrEmpty(Current.Request.QueryString("ReturnUrl")) Then
                SetAuthCookie(username & "|" & userid, True)
            Else
                RedirectFromLoginPage(username & "|" & userid, True)
            End If
            Return True
        End If 
```

在您的 web.config 中：

```
<location path="admin">
    <system.web>
        <authorization>
            <allow roles="Admin"/>
            <deny users="*"/>
        </authorization>
    </system.web>
</location>
.....
<system.web>
<authentication mode="Forms">
        <forms loginUrl="/registration/login.aspx" timeout="129600"/>
    </authentication>
    <authorization>
        <allow users="*"/>
    </authorization>
</system.web> 
```

...如果你真的想要，在你的 Global.asax 页面中：

```
 Sub Application_AuthenticateRequest(ByVal sender As Object, ByVal e As EventArgs)
    If Request.IsAuthenticated Then
''
'get your roles for the current user'
''
 Dim userRoles() As String = Split(roles, "|")
        'Add the roles to the User Principal'
        HttpContext.Current.User = New GenericPrincipal(User.Identity, userRoles)
    End If
End Sub 
```

# svn - SVN“PROPFIND 请求失败...”

> ID：912277
> 
> 赞同：22
> 
> 时间：2009-05-26T19:29:44.417
> 
> 标签：svn

在进行其他一些提交/更新时，我正在从 SVN 签出一个存储库（比如 foo）。我的服务器死了，我的结帐不完整。美好的。问题是当我返回访问 foo 存储库时，但我无法访问。它只是永远挂起。

所以，我去了[http://subversion.apache.org/faq.html#bdb-recovery](http://subversion.apache.org/faq.html#bdb-recovery)并运行了`svnadmin recover`. 我收到一个错误，所以我最终不得不使用 db_recover 并且命令说它成功完成。

现在，当我尝试访问存储库时，我得到：

```
svn: PROPFIND request failed on '/foo'
svn: PROPFIND of '/foo': 500 Internal Server Error (https://svn.foobar.com) 
```

此外，如果我导航到[https://svn.foobar.com/foo](https://svn.foobar.com/foo)我会看到：

```
<D:error>
<C:error/>
<m:human-readable errcode="160029">
Could not open the requested SVN filesystem
</m:human-readable>
</D:error> 
```

有人有什么想法吗？

注意：所有其他存储库都可以使用。就是这个。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-27T09:08:39.650

您是否以通常使用存储库（例如 apache 帐户）的用户身份运行“svnadmin recover”？

如果不是，原因可能是某些文件现在归运行 'svnadmin recover' 的用户所有，导致 apache 帐户无权更改存储库文件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-12-29T13:43:27.467

我收到了这个 propfind 错误，因为电源坏了，我忘记重新启动 svnserve 和 Apache 实例 =)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-11-17T04:49:02.583

有时安装不同的 Java 版本可能会导致 Eclipse SVN 插件（我的情况是 Subversive 1.7）无法工作。

我使用了 JVM 1.6，但我的环境路径指向了一个更新的版本（由于安装了 Oracle Java web start 或其他东西）。

所以我重新回到旧的 Java 1.6 版本，它工作。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-10-18T16:18:27.120

如果您是通过 HTTP(S) 设置 SVN 服务器的人，这可能只是 Apache 服务器说它不理解 PROPFIND。

在我的情况下，当我在 Apache HTTPD 配置中设置“位置”时发生这种情况，而没有将其指定为 SVN WebDAV 实现（SVN mod 是 WebDAV 的扩展）：

```
 <Location /svn>
       SVNParentPath /data/scm/repositories/
       SVNPathAuthz off
       AuthType Basic
       AuthName "xxxxx"
       AuthBasicProvider ldap
       AuthLDAPURL ldap://xxx.yy:389/DC=aaaa,DC=bbbb?sAMAccountName?sub
       Require valid-user
   </Location> 
```

而不是这个：

```
 <Location /svn>
   DAV svn
   SVNParentPath /data/scm/repositories/
   SVNPathAuthz off
   AuthType Basic
   AuthName "xxxxx"
   AuthBasicProvider ldap
   AuthLDAPURL ldap://xxx.yy:389/DC=aaaa,DC=bbbb?sAMAccountName?sub
   Require valid-user
 </Location> 
```

在我发现它之后似乎是一个逻辑错误，但我花了很长时间才找到错误......

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-02-24T22:49:05.017

就我而言，我需要一个不同的协议：

```
svn co svn+ssh://svn.xyz.com/directory 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-04-19T12:29:37.080

如果具体的错误信息是“permature end of file”... httpd 的 error_log 显示：

```
[error] PHP Parse error:  syntax error, unexpected T_STRING in /var/www/repos/... 
```

但没有语法错误。

似乎 .php 文件被解释而不是被视为文本 - 显然与 MIME 类型配置有关......

好吧，答案很简单：

```
AddType text/plain .php 
```

只需将其添加到您的虚拟主机配置文件中，apache2 就会停止在该存储库中解释 PHP。 [资源](http://www.codefx.biz/2012/04/svn-propfind-failed-solved)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2015-06-30T15:45:18.553

在我的情况下，我可以解决它，将“提交到”值从“ [https://localserver/svn/project](https://localserver/svn/project) ”更改为“file:///F:/Repositories/project”。

更改 HTTPS 端口后开始失败，因为我在本地 IIS 中安装了证书，并且与 SVN Apache 服务器冲突。

# c++ - 将数字附加到 int 而不转换为字符串？

> ID：912279
> 
> 赞同：10
> 
> 时间：2009-05-26T19:29:55.040
> 
> 标签：c++, variables, append

有没有一种安全的方法可以在整数末尾添加一个数字而不将其转换为字符串并且不使用 stringstreams ？

我试图用谷歌搜索这个答案，大多数解决方案都建议将其转换为字符串并使用字符串流，但我想将其保留为整数以确保数据完整性并避免转换类型。
我还阅读了一个解决方案，该解决方案建议将 int 乘以 10，然后添加数字，但这可能会导致整数溢出。
这是安全的还是有更好的方法来做到这一点？如果我这样做乘以 10 并添加数字解决方案，我应该采取哪些预防措施？

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2009-05-26T19:32:46.220

您最好的选择是乘以 10 并加上该值。您可以像这样[进行天真的检查](https://www.securecoding.cert.org/confluence/display/seccode/INT32-C.+Ensure+that+operations+on+signed+integers+do+not+result+in+overflow)：

```
assert(digit >= 0 && digit < 10);
newValue = (oldValue * 10) + digit;
if (newValue < oldValue)
{
    // overflow
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-26T20:23:47.367

为防止溢出：

```
if ((0 <= value) && (value <= ((MAX_INT - 9) / 10))) {
    return (value * 10) + digit;
} 
```

代替 MAX_INT，您可以使用`std::numeric_limits<typeof(value)>::max()`或类似的方法来支持除 int 以外的类型。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-26T20:35:26.593

```
  断言（数字 >= 0 && 数字 < 10）；
  新值 = 10 * 旧值；
  如果（旧值 < 0）{
    新值-=数字；
  } 别的 {
    新值 += 数字；
  }

  // 检查溢出 SGN(oldvalue) == 0 || SGN(新值) == SGN(旧值)

```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2010-01-28T05:24:02.303

这是一个比被接受为也很快的答案的更好和更防弹的实现：

```
#include <climits>
#include <cassert>

unsigned int add_digit(unsigned int val, unsigned int digit)
{
   // These should be computed at compile time and never even be given a memory location
   static const unsigned int max_no_overflow = (UINT_MAX - 9) / 10U;
   static const unsigned int max_maybe_overflow = UINT_MAX / 10U;
   static const unsigned int last_digit = UINT_MAX % 10;

   assert(digit >= 0 && digit < 10);
   if ((val > max_no_overflow) && ((val > max_maybe_overflow) || (digit > last_digit))) {
      // handle overflow
   } else {
      return val * 10 + digit;
   }
   assert(false);
} 
```

您还应该能够将其变成内联函数。溢出检查几乎总是在第一次比较后短路。后面的子句`&&`很简单，您可以（在 32 位二进制补码整数的情况下）将 5 添加到 429496729 的末尾，而不是 6。

# delphi - Delphi 中 MainForm 的 OnShow 事件的 ExitProcess

> ID：912280
> 
> 赞同：8
> 
> 时间：2009-05-26T19:30:03.713
> 
> 标签：delphi, winapi

我有一个应用程序，它在启动时检查一些条件并在主窗体的 OnShow 事件中启动一个外部程序。问题是如果启动外部程序时出现错误，我希望应用程序立即终止。但是有一个问题，因为 EurekaLog 捕获了我的异常，并通过否定所有调用`Application.Teminate`和任何其他正常的关闭方法来以某种方式破坏那里的消息循环。

所以这是我的问题，当这种情况存在时，ExitProcess 是否是立即终止我的应用程序的最佳途径？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-05-26T22:02:59.257

到时间`OnShow`已经触发时，您已经进入程序太远了，无法决定您真的不希望程序运行。你应该早点做出这个决定。`OnShow`不是决定不应该显示表单的地方。

这是您在创建主表单之前应该检查的事情。将您的检查放入 DPR 文件中，如果您确定该程序不应运行，则只需调用`exit`.

```
begin
  Application.Initialize;
  if not ApplicationShouldReallyStart then
    exit;
  Application.CreateForm(TMainAppForm, MainAppForm);
  Application.Run;
end. 
```

填写您自己的`ApplicationShouldReallyStart`. （它确实应该是一个单独的函数，而不是内嵌在 DPR 文件中。如果 DPR 文件中的`begin`-`end`块变得太复杂，IDE 会感到困惑。）

除此之外，不要调用`ExitProcess`. `Halt`改为打电话。`Halt`调用`ExitProcess`，但它也调用单元完成部分和其他特定于 Delphi 的进程关闭任务。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-27T01:30:50.303

*与*系统一起工作，而不是*反对*它！你不能简单地死在事情的中间。如果你想死，请在规则内执行——WM_CLOSE 或者你自己的例程，说明它为什么会死，然后发送 WM_CLOSE。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-26T19:33:04.317

您最好向窗口发送一条 wmClose 消息。否则，由于其他消息发送到表单，您很有可能陷入麻烦。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-26T21:19:14.837

我写了一个小应用程序来测试一个理论，这就是我的建议。

调用 CLOSE 方法。

以下示例单元关闭应用程序，在 D2009 中没有错误。

```
unit Unit1;

interface

uses
  Windows, Messages, SysUtils, Variants, Classes, Graphics, Controls, Forms,
  Dialogs;

type
  TForm1 = class(TForm)
    procedure FormShow(Sender: TObject);
  private
    { Private declarations }
  public
    { Public declarations }
  end;

var
  Form1: TForm1;

implementation

{$R *.dfm}

procedure TForm1.FormShow(Sender: TObject);
begin
   close;
end;

end. 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-27T05:30:18.180

虽然我完全同意 Rob Kennedy 的观点，但我想指出，您可以使用 EurekaLog 的例程来控制错误对话框行为。例如：

```
uses
  ExceptionLog, ECore;
...
begin
  ForceApplicationTermination(tbTerminate);
  // ... <- Bad code goes there
end; 
```

这样，应用程序将在显示错误对话框后立即关闭。

# mysql - mysql联合问题

> ID：912285
> 
> 赞同：1
> 
> 时间：2009-05-26T19:31:42.650
> 
> 标签：mysql

```
mysql> select job_desc_title from postings where id=194582; 
```

```
+------------------------------+
| job_desc_title |
+------------------------------+
| 言语/语言病理学家 |
+------------------------------+
一组中的 1 行（0.00 秒）

```

```
mysql> select email_address,first_name,last_name,home_phone_area,home_phone_num from accounts
->  left join profiles on profiles.account_id=accounts.id  
->  where accounts.id=5; 
```

```
+--------------------+------------+-----------+--- --------------+----------------+
| 电子邮件地址 | 名字 | 姓氏 | home_phone_area | home_phone_num |
+--------------------+------------+-----------+--- --------------+----------------+
| newhjh@hotmail.com | 建华 | 他 | 425 | 3584396 |
+--------------------+------------+-----------+--- --------------+----------------+
一组中的 1 行（0.00 秒）

```

我需要合并上述两个查询，但我的试验失败了：

```
mysql> select job_desc_title from postings where id=194582
->                           union all
->                     select email_address,first_name,last_name,home_phone_area,home_phone_num from accounts
->                      left join profiles on profiles.account_id=accounts.id
->                      where accounts.id=5; 
```

> ERROR 1222 (21000): 使用的 SELECT 语句有不同的列数

做这项工作的正确版本是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-26T19:42:10.850

您从第一个中选择 job_desc_title，然后从第二个中选择电子邮件地址、名字、姓氏等。这不是工会。

您要做的是加入，我建议您阅读这些内容。联合获取两个查询的结果并将它们垂直组合。连接获取两个表的结果并将它们水平组合。联合添加行，连接添加列。您要做的是添加一列（job_desc_title），而不是行。组合行（即联合）需要相同的列才能工作。

我还认为，当您应该使用内部联接时，您正在使用左联接。

```
select 
    a.email_address,
    a.first_name,
    a.last_name,
    a.home_phone_area,
    a.home_phone_num,
    post.job_desc_title
from 
    accounts a
    inner join profiles p on 
        a.id=p.account_id
    inner join postings post on
        --I have no idea what the relationship is here, so I'm guessing
        p.posting_id = post.id
where 
    a.id=5 
```

希望这将使您接近正确的轨道。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-26T19:34:26.950

您联合在一起的两个查询必须具有相同数量的输出列。您的第一个选择包含一列，您的第一个选择包含五列。

如果您愿意，可以使用空值填充第一个选择，如下所示：

```
select job_desc_title, null, null, null, null from postings where id=194582 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-26T19:38:42.543

是的

```
select job_desc_title from postings where id=194582 
```

和

```
select email_address,first_name,last_name,home_phone_area,home_phone_num from accounts 
```

不会因为需要相同数量的列而合并

见[http://dev.mysql.com/doc/refman/5.0/en/union.html](http://dev.mysql.com/doc/refman/5.0/en/union.html)

> UNION 用于将多个 SELECT 语句的结果组合成一个结果集。第一个 SELECT 语句中的列名用作返回结果的列名。在每个 SELECT 语句的相应位置列出的选定列应具有相同的数据类型。（例如，第一个语句选择的第一列应该与其他语句选择的第一列具有相同的类型。）

正如罗伯特哈维所说，您可以在不匹配的行中添加空白

```
select 
    job_desc_title,
    '' AS email_address,
    '' AS first_name,
    '' AS last_name,
    '' AS home_phone_area,
    '' AS home_phone_num 
from 
    postings 
where id=194582
union
select 
    '' AS job_desc_title,
    email_address,
    first_name,
    last_name,
    home_phone_area,
    home_phone_num 
from 
    accounts 
```

但这将为每个匹配返回 2 行。

更有可能的情况是，您希望连接两个数据集以形成一行，假设一对一的关系。

# java - 分页/过滤数据的缓存策略

> ID：912288
> 
> 赞同：2
> 
> 时间：2009-05-26T19:32:17.907
> 
> 标签：java, .net, memcached, theory

我目前正在考虑缓存策略，更重要的是避免缓存内的任何数据重复。我的查询与语言无关，但与编程非常相关。

我的问题是关于分页或过滤数据的有效缓存，但更重要的是分布式缓存。后者我决定使用 memcached，更具体地说是它的 .NET 端口。我已经看到了 NCache 形式的另一种商业选择，但 memcached 对我来说似乎完全可以接受，并且显然用于 facebook、myspace 等......

然后，我的查询是一种策略，您可以在缓存中包含对象，也可以使用分页数据引用它们。如果我有 100 个项目并对其进行分页，那么我可以将产品 1-10 的 ID 缓存在缓存中，并分别缓存每个产品。如果我在哪里对项目进行降序排序，那么项目 1-10 将是不同的产品，所以我不想在每次分页数据/排序/过滤更改时存储实际对象，而是存储对象的 id，这样我就可以如果其中一些在缓存中不存在或无效，则在数据库中执行 trabsactional 查找。

我最初的想法是这个缓存键。

```
paged_<pageNumber><pageSize><sort><sortDirection>[<filter>] 
```

然后，我将遍历缓存键并删除以“paged_”开头的任何内容不止一次缓存。

memcached 是本机代码，按照我上面所说的方式清除缓存不会有问题，但很明显的事实是缓存中的项目越多，花费的时间就越多。如果有人知道目前正在使用的此类问题的任何解决方案或理论，我很感兴趣。我相信会有。感谢您的时间

TIA

安德鲁

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-26T21:07:03.597

我曾经尝试过，我认为是一种类似的缓存策略，但发现它很笨拙。我最终只是缓存了构成页面的对象并为每个请求生成页面。构建页面的 10 次缓存命中将是（希望）亚秒级响应时间，对您的服务用户来说几乎是即时的。

如果您必须缓存整个页面（我认为它们是结果集），那么也许您可以通过哈希运行用户请求并将其用作缓存键。用一个具体的例子或代码来可视化是一个难题（至少对我来说）。

# autocomplete - 可折叠的自动完成

> ID：912297
> 
> 赞同：1
> 
> 时间：2009-05-26T19:33:10.090
> 
> 标签：autocomplete, collapsable

我如何在 Jquery 中实现可折叠的自动完成功能。我有一个组，一个组可以有零个或多个项目。我如何在 Jquery 中实现这一点。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-16T05:30:44.680

自动完成输入字段，使用户能够利用搜索和过滤快速查找和选择一些值。

通过提供自动完成的字段焦点或在其中输入内容，插件开始搜索匹配的条目并显示可供选择的值列表。通过输入更多字符，用户可以过滤列表以更好地匹配。

这可用于输入先前选择的值，例如。对于标签，完成地址，例如。输入城市名称并获取邮政编码，或者输入地址簿中的电子邮件地址。

[有关详细信息，请参阅文档。](http://docs.jquery.com/Plugins/Autocomplete)

# c# - Windows 图像采集 - 在 C# 中设置设备属性

> ID：912303
> 
> 赞同：5
> 
> 时间：2009-05-26T19:34:54.203
> 
> 标签：c#, wia

我有一个支持使用 WIA 进行扫描的 C# (WinForm) 程序。我正在尝试在扫描一个或多个文档之前设置设备属性。首先我想为扫描仪设置纸张尺寸。以下是代码片段：

```
foreach (Property property in selectedDevice.Properties)
{
   //WiaProperties.WiaDpsHorizontalBedSize is my constant
   if (property.PropertyID == WiaProperties.WiaDpsHorizontalBedSize)
   {
       //Set property value here...             
   }
} 
```

我正在查找 Horizo​​ntal Bed Size 属性，但问题是如何将其设置为一个值？属性之外有一个 set_Value 属性，但这似乎对结果对象进行了引用。所以我不知道如何在设备上设置属性？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-06-22T22:20:07.580

我也在做一个扫描项目，WIA 的例子很少。此代码是您正在寻找的设置床尺寸、DPI 等的代码。查看 SetProperty 方法以及如何处理 set_Value 的示例。

```
class Scan
{
    // Scanner only device properties (DPS)
    public const int WIA_RESERVED_FOR_NEW_PROPS = 1024;
    public const int WIA_DIP_FIRST = 2;
    public const int WIA_DPA_FIRST = WIA_DIP_FIRST + WIA_RESERVED_FOR_NEW_PROPS;
    public const int WIA_DPC_FIRST = WIA_DPA_FIRST + WIA_RESERVED_FOR_NEW_PROPS;
    public const int WIA_DPS_FIRST = WIA_DPC_FIRST + WIA_RESERVED_FOR_NEW_PROPS;
    public const int WIA_DPS_DOCUMENT_HANDLING_STATUS = WIA_DPS_FIRST + 13;
    public const int WIA_DPS_DOCUMENT_HANDLING_SELECT = WIA_DPS_FIRST + 14;
    public const int FEEDER = 1;
    public const int FLATBED = 2;
    public const int DUPLEX = 4;
    public const int FEED_READY = 1;

    WIA.CommonDialog _dialog = new WIA.CommonDialog();
    WIA.Device _scanner;

    public void ADFScan()
    {

        _dialog = new CommonDialogClass();
        _scanner = _dialog.ShowSelectDevice(WIA.WiaDeviceType.ScannerDeviceType, false, false);

        foreach (Property item in _scanner.Items[1].Properties)
        {
            switch (item.PropertyID)
            {
                case 6146: //4 is Black-white,gray is 2, color 1
                    SetProperty(item, 2);
                    break;
                case 6147: //dots per inch/horizontal 
                    SetProperty(item, 100);
                    break;
                case 6148: //dots per inch/vertical 
                    SetProperty(item, 100);
                    break;
                case 6149: //x point where to start scan 
                    SetProperty(item, 0);
                    break;
                case 6150: //y-point where to start scan 
                    SetProperty(item, 0);
                    break;
                case 6151: //horizontal exent 
                    SetProperty(item, (int)(8.5 * 100));
                    break;
                case 6152: //vertical extent 
                    SetProperty(item, 11 * 100);
                    break;
            }
        }
        ImageFile image = (ImageFile)_scanner.Items[1].Transfer(FormatID.wiaFormatPNG);
        System.IO.File.Delete("tmp.png");
        image.SaveFile("tmp.png");
    }

    private void SetProperty(Property property, int value)
    {
        IProperty x = (IProperty)property;
        Object val = value;
        x.set_Value(ref val);
    }

    public void test()
    {
        bool WantsToScan = true;
        while (WantsToScan) ScanAndSaveOnePage();

    }

    static void Main(string[] args)
    {
        new Scan().test();
    }
} 
```

# .net - 当内存仍然可用时抛出 OutOfMemoryException

> ID：912309
> 
> 赞同：7
> 
> 时间：2009-05-26T19:35:54.967
> 
> 标签：.net, memory

我需要构建一个大字符串列表并将其保存在内存中，但是在构建它时会抛出 OutOfMemoryException。根据资源监视器，我仍然有 1GB 的可用内存。我发现[这篇知识库文章](http://support.microsoft.com/kb/825680)解决了这个问题，但它似乎应该在框架 1.1 SP1 中得到修复（我使用的是 3.5 sp1）。

任何人都可以了解幕后发生的事情吗？.net 框架是否限制单个进程（在 32 位系统上）可以使用多少内存？如果是这样，我可以明白为什么，但没有意义的是该应用程序仅使用 1.6GB 并且系统还剩下约 1GB。

**编辑 - 对于那些在这里问的人，有一些更深入的信息：**

我有一个列表（是的，我可以使用其他东西，但我现在只是在制作原型。），我通过执行 Guid.NewGuid().ToString() 生成一个随机字符串，并将其放入列表中。我要做的是生成一个包含尽可能多的项目的列表，并测试查找特定项目的不同方法。我的第一个猜测是一些碎片正在发生，但我放弃了除了下面的代码之外的所有内容，它仍然会发生。我不认为这个小片段会造成很多碎片，但我可能错了。

```
 List<string> blah = new List<string>();

        for (int i = 0; i < 50000000; i++)
        {
            blah.Add(Guid.NewGuid().ToString());
        } 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-26T19:46:42.557

问题可能不在于您没有“可用”内存，而更可能是您将内存碎片化得如此之多，以至于当您尝试将项目添加到列表中并且必须调整其大小时，没有单个块可用内存可以容纳它。

这也会导致 OutOfMemoryException。

列表有多大，换句话说，当你得到异常时，你有多少字符串，准确或粗略？

你是如何填充列表的？您是否提前知道要添加的项目数量？如果是这样，您在构建列表时是否指定容量？

如果您不知道，是否有可能弄清楚，因此您可以指定该容量？

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-05-26T19:50:49.757

Win32 每个进程的内存限制为 2GB。嗯，实际上是 4GB，但 2GB 是为内核模式保留的，除非您设置了[/3GB](http://msdn.microsoft.com/en-us/library/ms791558.aspx)操作系统启动选项。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-26T20:49:32.463

List<T> 的默认构造函数以一个空数组作为内部存储开始。调用 Add(T item) 检查是否需要调整数组大小，并将容量属性**加倍**（通过 EnsureCapacity 方法）。设置容量属性时...

1.  创建一个具有新大小的新数组（原来的两倍！）
2.  将旧元素中的元素复制到新元素中。
3.  将内部参考更改为新参考。

因此，假设容量为 n 意味着在调整大小期间您的总内存使用量为 3n。

失败时您的 List 包含多少项？如果您知道将添加多少项，请尝试使用接受容量的构造函数。这避免了可能需要进行的任何调整大小（如果您需要巨大的内存块，可能会直接抛出 OutOfMemoryException）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-28T19:08:46.070

忘记碎片、LargeAddressAware 或 gcAllowVeryLargeObjects... 我的问题通过在我的控制台项目的“属性”页面中的“构建”下取消选中“首选 32 位”复选框来解决。这是默认设置的……为什么？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-26T19:42:59.943

我真的不知道这个错误的细节，但几年前我确实遇到了这个，或者非常类似的东西。重要的是，我们发现您的应用程序绑定到的 GDI 句柄数量存在硬性限制。大概是 9,999。当您达到此限制时，无论有多少可用内存，应用程序都会因内存不足异常而崩溃。

所以你可能会做类似的事情，但既然你提到你正在使用字符串，我想你正在分割堆并超出其容量。如果您的字符串足够大，它们可能在大对象堆上。我认为 LOH 的实现在框架的早期版本中非常糟糕。如果内存正确地为我服务，对象没有被正确地释放，这使得只有 LOH 上的空间很容易用完。

有关更多信息，请参阅这些链接

[http://www.simple-talk.com/dotnet/.net-framework/the-dangers-of-the-large-object-heap/](http://www.simple-talk.com/dotnet/.net-framework/the-dangers-of-the-large-object-heap/) [http://msdn.microsoft.com/en-us/magazine/cc534993 .aspx](http://msdn.microsoft.com/en-us/magazine/cc534993.aspx) [http://blogs.msdn.com/maoni/archive/2006/04/18/large-object-heap.aspx](http://blogs.msdn.com/maoni/archive/2006/04/18/large-object-heap.aspx) [http://social.msdn.microsoft.com/Forums/en-US/clr/thread /08e6bd5f-613e-41ae-9ab1-b05c7ff2710f](http://social.msdn.microsoft.com/Forums/en-US/clr/thread/08e6bd5f-613e-41ae-9ab1-b05c7ff2710f)

# php - 为什么在 PHP 中引用同一类中的方法或变量时必须使用 $this？

> ID：912312
> 
> 赞同：1
> 
> 时间：2009-05-26T19:36:52.703
> 
> 标签：php, oop, this

我正在向 Java 开发人员解释为什么他的方法调用不起作用。他只需要添加`$this->method_name();`

然后他问我，*“为什么我需要在同一个类中声明的方法中添加**$this**？”*

我真的不知道该怎么回答。也许是因为 PHP 有一个全局命名空间，你需要明确告诉它你要查找的方法属于当前类？但是为什么 PHP 在查看全局命名空间之前不检查当前类的方法呢？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-26T20:48:58.533

问题还在于，如果您声明 a`function foo()`和 a method `foo()`，php 将很难弄清楚您的意思 - 考虑这个例子：

```
<?php
function foo()
{
    echo 'blah';
}

class bar
{
    function foo()
    {
         echo 'bleh';
    }
    function bar()
    {
         // Here, foo() would be ambigious if $this-> wasn't needed.
    }
}
?> 
```

所以基本上你可以说 PHP——因为它的“非 100% 面向对象”（意味着你也可以在类之外有函数）——有这个“特性”:)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-26T19:42:11.320

如果我不得不猜测：因为它比其他选择更容易。PHP 中的面向对象支持一直是一个 hack。我隐约记得读过一篇关于即将出现在 PHP 5.3 中的闭包支持的讨论。显然，由于它的作用域规则，在 PHP 中实现词法闭包非常非常困难。可能是因为您可以将一个类嵌套在另一个类的函数中，诸如此类。所有这些自由可能会让这样的事情变得异常困难。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-26T19:49:23.427

这并不罕见。Python、Javascript、Perl（和其他）都让你在处理对象时引用一个`this`或。`self`

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-26T20:58:00.403

这就是作用域在 PHP 中的工作方式。`$obj->f()`指`$foo`在函数范围内。如果要在 中获取类属性`$obj->foo`，`f()`则为`$this->foo`.

```
global $foo;
$foo = 99;

class myclass
{
    public $foo;

    function f()
    {
        $this->foo = 12;
        $foo = 7;

        // $this->foo != $foo != $GLOBALS['foo']
    }
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-26T20:46:43.513

$this 指的是调用对象。[PHP 文档](http://jm.php.net/manual/en/language.oop5.basic.php)有很好的例子和更多细节。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2022-02-08T08:35:53.353

似乎 PHP 没有被正确地 OOPed。在 Java 和 C++ 中，对当前对象 ('this') 的引用是隐式的，即不需要明确提及，从而使代码更加简洁。也许有一些原因这对 PHP 实现很困难？

# java - 如何在移动精灵时重新绘制小程序？

> ID：912321
> 
> 赞同：1
> 
> 时间：2009-05-26T19:38:12.513
> 
> 标签：java, multithreading, paint

我有一个小的 Java 小程序，在其中创建 2 个线程，一个线程重绘，另一个将图像从一个点移动到用户单击的位置。问题是，当我调用 move 函数时，它会循环直到图像是用户单击的位置，但是即使执行移动的线程和执行绘画的线程是分开的，在我跳出循环之前它也不会重新绘制。

关键点的缩短版：

*   我的程序是一个使用paint() 方法的小程序

*   我有 2 个线程，一个移动图像，另一个绘制该图像

*   当我移动图像时，它处于一个while循环中

*   绘画线程仍在调用 repaint() 但就调用而言，它永远不会重新绘制

感谢您的时间。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-26T19:56:41.930

阅读Java的AWT框架的绘画系统介绍可能会很有用。以 Sun 的例子为例：http: [//java.sun.com/products/jfc/tsc/articles/painting/index.html](http://java.sun.com/products/jfc/tsc/articles/painting/index.html)

在您的情况下，您不需要 2 个线程。负责重新绘制小程序的线程是由 AWT 创建的。它被称为事件调度线程或 EDT。因此，您只需要更改图像的位置，并在每次更改时调用 applet 上的 repaint 方法。

# c++ - 如何从二进制文件中查找静态分配的大小？

> ID：912322
> 
> 赞同：6
> 
> 时间：2009-05-26T19:38:16.507
> 
> 标签：c++, c, linux

是否可以从二进制文件中确定专用于静态和全局变量的内存总量？我正在寻找一个 Linux 实用程序，它可以读取一个 elf 文件并计算出为变量预分配了多少内存。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-05-26T19:53:30.080

该`size`实用程序将在“数据”下报告。

```
> size ./my_program 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-26T19:53:58.737

是的。利用...

```
objdump -h progfile 
```

这将列出“标题”。找到`.data`标题并检查大小列。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-26T19:49:11.977

您可以使用该`nm`命令（或`objdump`按照@sharth 的建议）。Using`nm`更“便携”，因为它也可以在非 Linux Unix 系统上使用；它的可移植性并不高，因为输出格式没有完全标准化（尽管它是由 POSIX 定义的，但输出格式有几种常见的变体）。

# asp.net - ASP.NET AJAX Toolkit 通信问题

> ID：912326
> 
> 赞同：0
> 
> 时间：2009-05-26T19:38:28.877
> 
> 标签：asp.net, ajax, asp.net-ajax, updatepanel

我们有一个用户通过 3G 使用我们的网站。asp.net 2.0 应用程序使用 AJAX 工具包更新面板来提供一些数据的视图。我收到一些抱怨，有时更新面板中的元素会丢失。我认为这归因于 ajax 调用的通信问题，但在重复该问题时遇到了麻烦。

您如何建议我们解决这些问题？有没有办法增加超时？有什么方法可以捕获“错误”或在 ajax 工具包中添加一些调试以找出到底发生了什么？

用户正在笔记本电脑上通过 3G 链接在 IE7 上运行...

编辑：经过更多研究，这个问题*可能*归结为线程死亡。每个单独的组件都由一个函数填充到一个线程中，以加快速度。IIS有时会杀死线程吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-27T13:08:35.030

让你老板给你买个3G usb key来调试吧^^

或者您可以要求 3G 用户设置 IE 以显示 Javascript 错误： [http ://www.testingreflections.com/node/view/4009](http://www.testingreflections.com/node/view/4009)

然后向您发送附加信息（错误消息、文件、行号等）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-26T20:04:14.597

您的问题引发了许多其他问题。

AJAX Toolkit 组件是否“在”一些其他 AJAX 组件（可能是标准的 .NET AJAX 组件或其他第三方组件）“内部”？

我遇到了组件问题，例如 Telerik，当卡在其他非 Telerik 组件中时无法工作。虽然它也应该影响其他用户，而不仅仅是 3G 用户。但是，它可能存在一些时间问题，只会导致连接速度变慢来体现问题。

这会随机影响所有组件，还是仅影响特定组件（如数据库或图形意图组件）？这显示在什么样的设备上 - 带有 3G 调制解调器的笔记本电脑，或一些手持设备？正在使用什么浏览器和版本？

而且，当然，您还需要问自己“我们真的需要关心吗？” 如果只有一个用户，在非常特殊的情况下遇到问题，那么“浪费”时间在经济上是否合理？

# .net - 在 WinForm 中的按钮单击上切换所有控件只读

> ID：912331
> 
> 赞同：2
> 
> 时间：2009-05-26T19:39:02.120
> 
> 标签：.net, winforms, controls, loops, toggle

我希望能够通过单击按钮将表单上的一组控件设置为只读并返回。有没有办法遍历它们？`this.Controls`也许......

谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-26T19:42:05.593

如果要将所有控件设置为只读，可以执行以下操作：

```
foreach(Control currentControl in this.Controls)
{
    currentControl.Enabled = false;
} 
```

如果您真正想要做的是将某些控件设置为只读，我建议保留相关控件的列表，然后在该列表上执行 ForEach，而不是全部。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-26T19:49:26.577

将它们设置为启用/禁用很容易，请参阅 GWLIosa'a 答案。

但是，并非所有控件都具有只读属性。你可以使用类似的东西：

```
foreach (Control c in this.Controls)
{
  if (c is TextBox)
    (c as TextBox).Readonly = newValue;
  else if (c is ListBox)
    (c as ListBox).Readonly = newValue;
  // etc
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-26T19:52:17.383

就个人而言，我会将我想要影响的所有控件（和子控件）放入`Panel`- 然后只需更改单个`Panel`. 这意味着您不必开始存储旧值（例如，将它们放回去 - 您可能不想假设它们都开始启用）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-26T20:08:05.057

我建议您使用 GWLlosa 建议的 Enabled 属性，但如果您想要或需要使用 ReadOnly 属性，请尝试以下操作：

```
 foreach (Control ctrl in this.Controls)
        {
            Type t = ctrl.GetType();

            PropertyInfo propInfo = t.GetProperty("ReadOnly");

            if (propInfo != null)
                propInfo.SetValue(ctrl, true, null);
        } 
```

# asp.net - Linq to Entities：左连接以获取连接中未找到的项目

> ID：912333
> 
> 赞同：0
> 
> 时间：2009-05-26T19:39:09.033
> 
> 标签：asp.net, entity-framework

我有两个不相关的（没有定义 FK）表。第一个表包含一些用户可能无权访问的任务。我需要找到所有这些任务——在这种情况下，连接表将包含空值。我如何得到它们？

这是设置：

```
TimeData table 
- userID 
- taskID 
- hours 
```

```
ApprovedTasks table (the one that should contain nulls)
- taskID 
- userID 
```

SQL 查询如下所示：

```
select * from TimeData td 
left join ApprovedTasks at
 on at.taskID = td.taskID and at.userID = td.userID
where at.taskID is null 
```

有什么方法可以使用 LINQ to Entity 查询来解决这个问题？

TIA

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-26T19:54:43.510

查看... [LINQ 中的不相交联合](https://stackoverflow.com/questions/801757/disjoint-union-in-linq)

这应该工作...

```
var approvedTaks = from at in ApprovedTasks.Except(
                                        from at2 in ApprovedTasks
                                        where at2.userID == userId and at2.taskID==taskId
                                        select at2)
                    where at.userID == userId and at.taskID==taskId
                    select at; 
```

但很抱歉没有方便的数据库来测试它。

# java - 异常与错误的区别

> ID：912334
> 
> 赞同：199
> 
> 时间：2009-05-26T19:39:19.577
> 
> 标签：java, exception, throwable

我正在尝试了解有关基本 Java 和不同类型的 Throwables 的更多信息，有人可以让我知道异常和错误之间的区别吗？

* * *

## 回答 #1

> 赞同：193
> 
> 时间：2009-05-26T19:43:38.337

不应捕获或处理错误（极少数情况除外）。异常是异常处理的基础。[Javadoc](http://java.sun.com/javase/6/docs/api/java/lang/Error.html)很好地解释了它：

> Error 是 Throwable 的子类，表示合理的应用程序不应尝试捕获的严重问题。大多数此类错误是异常情况。

查看 的一些子类`Error`，获取它们的一些 JavaDoc 注释：

*   `AnnotationFormatError`- 当注释解析器尝试从类文件中读取注释并确定注释格式错误时抛出。
*   `AssertionError`- 抛出表示断言失败。
*   `LinkageError`- LinkageError 的子类表明一个类对另一个类有一些依赖；但是，后一个类在前一个类编译后发生了不兼容的变化。
*   `VirtualMachineError`- 抛出表示 Java 虚拟机已损坏或已用完继续运行所需的资源。

实际上有三个重要的子类别`Throwable`：

*   `Error`- 出现了足够严重的问题，大多数应用程序应该崩溃而不是尝试处理问题，
*   未经检查的异常 (aka `RuntimeException`) - 经常是编程错误，例如一个`NullPointerException`或一个非法参数。应用程序有时可以处理或从这个`Throwable`类别中恢复——或者至少在 Thread 的`run()`方法中捕获它，记录投诉并继续运行。
*   Checked Exception (aka Everything else) - 应用程序应该能够捕获并有意义地对其余部分做一些事情，例如`FileNotFoundException`和`TimeoutException`......

* * *

## 回答 #2

> 赞同：47
> 
> 时间：2016-10-24T18:28:40.670

这张幻灯片由[@georgios-gousios](https://stackoverflow.com/users/51681/georgios-gousios)[展示了 Java 的异常层次结构](https://speakerdeck.com/gousiosg/exception-handling-bug-hazards-on-android?slide=8)，简明地解释了 Java 中的错误和异常之间的区别。

[![Java 异常层次结构](https://i.stack.imgur.com/v2NAj.png)](https://i.stack.imgur.com/v2NAj.png)

* * *

## 回答 #3

> 赞同：19
> 
> 时间：2009-05-26T19:47:15.350

如您所知，错误往往表明您的应用程序结束。它通常无法从中恢复，并且应该会导致您的 VM 退出。除了可能在退出之前记录或显示和适当的消息外，不应捕获它们。

**示例：OutOfMemoryError** - 您无能为力，因为您的程序无法再运行。

异常通常是可恢复的，即使不是，它们通常只是意味着尝试的操作失败，但您的程序仍然可以继续。

**示例：IllegalArgumentException** - 将无效数据传递给方法，导致方法调用失败，但不影响以后的操作。

这些都是简单的例子，还有关于仅例外的其他丰富信息。

* * *

## 回答 #4

> 赞同：13
> 
> 时间：2017-09-15T06:19:09.687

**[错误](http://grepcode.com/file/repository.grepcode.com/java/root/jdk/openjdk/6-b14/java/lang/Error.java)-**

1.  `Error`java 中的 s 属于`java.lang.Error`.
2.  java中的所有错误都是未经检查的类型。
3.  `Error`s 发生在运行时。编译器不会知道它们。
4.  从错误中恢复是不可能的。
5.  `Error`s主要是由应用程序运行的环境引起的。
6.  **例子：** `java.lang.StackOverflowError`，`java.lang.OutOfMemoryError`

**[例外](http://grepcode.com/file/repository.grepcode.com/java/root/jdk/openjdk/6-b14/java/lang/Exception.java)-**

1.  `Exception`java 中的 s 属于`java.lang.Exception`.
2.  `Exception`s 包括已检查和未检查的类型。
3.  编译器知道已检查的异常，而编译器不知道未检查的异常，因为它们发生在运行时。
4.  您可以通过`try-catch`块处理异常来从异常中恢复。
5.  `Exception`s主要是应用程序本身造成的。
6.  **示例：**已检查的异常：`SQLException`、`IOException`
    未检查的异常：`ArrayIndexOutOfBoundException`、、`ClassCastException``NullPointerException`

进一步阅读：http: [//javaconceptoftheday.com/difference-between-error-vs-exception-in-java/](http://javaconceptoftheday.com/difference-between-error-vs-exception-in-java/) [![http://javaconceptoftheday.com/wp-content/uploads/2015/04/ErrorVsException.png](https://i.stack.imgur.com/fXBer.png)](https://i.stack.imgur.com/fXBer.png)

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2009-05-26T19:48:18.280

孙[说得最好](http://java.sun.com/javase/6/docs/api/java/lang/Error.html)：

> Error 是 Throwable 的子类，表示合理的应用程序不应尝试捕获的严重问题。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-05-26T19:50:02.630

类的描述`Error`很清楚：

> An`Error`是它的子类，`Throwable` 它指示合理的应用程序不应尝试捕获的严重问题。大多数此类错误是异常情况。该`ThreadDeath` 错误虽然是“正常”情况，但也是 的子类，`Error`因为大多数应用程序不应尝试捕获它。
> 
> 方法不需要在其 throws 子句中声明在 `Error`方法执行期间可能抛出但未被捕获的任何子类，因为这些错误是不应该发生的异常情况。

引用自 Java 自己[的类文档`Error`](http://java.sun.com/javase/6/docs/api/java/lang/Error.html)。

简而言之，你不应该抓住`Error`s，除非你有充分的理由这样做。（例如，如果 servlet 内存不足或类似情况，防止 Web 服务器的实现崩溃。）

`Exception`另一方面，与任何其他现代语言一样，An只是一个正常的例外。您可以在 Java API 文档或任何在线或离线资源中找到详细说明。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2016-05-04T14:59:32.237

`java.lang.Exception`类和类之间有几个相同点和不同点`java.lang.Error`。

**相似之处：**

*   首先 - 两个类都扩展`java.lang.Throwable`并因此继承了许多在处理错误时常用的方法，例如：`getMessage`、`getStackTrace`等`printStackTrace`。

*   其次，作为它们的子类，`java.lang.Throwable`它们都继承了以下属性：

    *   Throwable 本身及其任何子类（包括`java.lang.Error`）可以使用`throws`关键字在方法异常列表中声明。此类声明仅适用于`java.lang.Exception`和子类，对于`java.lang.Throwable`和`java.lang.Error`及其`java.lang.RuntimeException`子类是可选的。

    *   只有`java.lang.Throwable`和子类允许在`catch`子句中使用。

    *   只有`java.lang.Throwable`和子类可以与关键字 - 一起使用`throw`。

从这个属性得出的结论是遵循两者`java.lang.Error`，`java.lang.Exception`可以在方法头中声明，可以在`catch`子句中，可以与关键字一起使用`throw`。

**差异：**

*   首先 - 概念上的区别：`java.lang.Error`设计为由 JVM 抛出并指示严重问题，并旨在停止程序执行而不是被捕获（但对于任何其他`java.lang.Throwable`继任者都是可能的）。

    [javadoc](https://docs.oracle.com/javase/8/docs/api/java/lang/Error.html)描述中的一段关于`java.lang.Error`：

    > ...表示合理的应用程序不应尝试捕获的严重问题。

    相反`java.lang.Exception`，旨在表示程序员可以在不终止程序执行的情况下预期和处理的错误。

    [javadoc](https://docs.oracle.com/javase/8/docs/api/java/lang/Exception.html)描述中的一段关于`java.lang.Exception`：

    > ...表示合理的应用程序可能想要捕获的条件。

*   `java.lang.Error`和`java.lang.Exception`第一个被认为是编译时异常检查的**未经检查**的异常之间的第二个区别。由于结果代码抛出`java.lang.Error`或其子类不需要在方法头中声明此错误。在方法头中抛出`java.lang.Exception`所需的声明。

Throwable 及其后继类图（省略了属性和方法）。 [![在此处输入图像描述](https://i.stack.imgur.com/Nq40r.png)](https://i.stack.imgur.com/Nq40r.png)

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-05-26T19:50:58.477

IMO 错误是可能导致您的应用程序失败且不应处理的错误。异常是可能导致不可预知的结果，但可以从中恢复的东西。

例子：

如果程序内存不足，这是一个错误，因为应用程序无法继续。但是，如果程序接受了不正确的输入类型，则这是一个异常，因为程序可以处理它并重定向以接收正确的输入类型。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2015-04-27T14:10:28.687

错误主要是由应用程序运行的环境引起的。例如，当 JVM 内存不足时会发生 OutOfMemoryError，或者堆栈溢出时会发生 StackOverflowError。

异常主要是由应用程序本身引起的。例如，当应用程序尝试访问空对象时会发生 NullPointerException，或者当应用程序尝试强制转换不兼容的类类型时会发生 ClassCastException。

资料来源：[Java中错误与异常之间的区别](http://javaconceptoftheday.com/difference-between-error-vs-exception-in-java/)

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-05-26T19:50:29.197

这是 Java API 的一个很好的总结，错误和异常代表什么：

> Error 是 Throwable 的子类，表示合理的应用程序不应尝试捕获的严重问题。大多数此类错误是异常情况。ThreadDeath 错误虽然是“正常”情况，但也是 Error 的子类，因为大多数应用程序不应该尝试捕获它。
> 
> 方法不需要在其 throws 子句中声明任何可能在方法执行期间抛出但未被捕获的 Error 子类，因为这些错误是不应该发生的异常情况。

OTOH，对于异常，Java API 说：

> 类 Exception 及其子类是 Throwable 的一种形式，它指示合理的应用程序可能想要捕获的条件。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2020-05-19T10:12:33.187

错误是由您的应用程序或程序运行的环境引起的。大多数情况下，您可能无法从中恢复，因为这会结束您的应用程序或程序。Javadoc 建议您不要费心去捕捉此类错误，因为 JVM 等环境无论如何都会退出此类错误。

示例： `VirtualMachineError`- 抛出表明 Java 虚拟机已损坏或已用完继续运行所需的资源。 `OutOfMemoryError`当 JVM 内存不足或 `StackOverflowError`堆栈溢出时发生。

异常是由您的应用程序或程序本身引起的；也许是因为你自己的错误。大多数情况下，您可以从中恢复，并且您的应用程序仍将继续运行。建议您捕获此类错误以防止应用程序或程序异常终止和/或能够自定义异常消息，以便用户看到格式良好的消息，而不是散布在各处的默认丑陋异常消息。

示例： `NullPointerException`当应用程序尝试访问空对象时发生。或尝试访问具有不存在索引的数组或调用具有错误数据或参数的函数。

# asp.net-mvc - 授权视图或将视图配置为已授权？

> ID：912336
> 
> 赞同：5
> 
> 时间：2009-05-26T19:39:30.653
> 
> 标签：asp.net-mvc, views, authorization

即使授权视图中不会有很多附加信息，是否最好为授权和未授权创建单独的视图？还是应该有一个视图并相应地调整模型数据？

编辑：在 MVC 中，我认为最好有 2 个视图，然后对重复信息使用部分视图。同意？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-27T12:39:07.710

我对经过身份验证/未经身份验证的状态都使用一个视图。我有视图**部分**的助手，仅适用于经过身份验证的用户。

例如：如果我有一个“新联系人”链接需要渲染到视图上，但它应该只对经过身份验证的用户可见，那么我将使用我的助手（类似这样）：

```
<% =Html.RenderNewLink() %> 
```

..那个助手会`IsAuthenticated`在渲染任何东西之前首先检查用户是否。

我将这些类型的助手分散在我的视图中，对于经过身份验证的用户，需要更多标记的地方。因此，对于未经身份验证的用户，这些地方是空白/空的。

我希望这是有道理的..可能不是解释它的最佳方式。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-26T20:58:33.740

没有“最好的”解决方案。这一切都取决于情况。至于我，我过去不会在没有重要原因的情况下创建“几乎相同”的视图。

**更新：**

我认为首先你应该尝试“调整”Controller 中的**ViewModel**，然后将其传递给 View。这使您的意见“更普遍”

# ruby-on-rails - Amazon-ecs如何获取产品的顶级分类？

> ID：912338
> 
> 赞同：2
> 
> 时间：2009-05-26T19:40:42.803
> 
> 标签：ruby-on-rails, ruby, amazon-web-services, amazon

我正在使用 amazon-ecs gem 从亚马逊获取产品详细信息，使用 itemlookup 函数（传递 ASIN）。虽然我可以从此功能获取所有产品详细信息，但我不确定如何获取产品的顶级类别 - 例如，如果我有一本儿童书，我希望类别为“书”而不是小说或儿童书等

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-27T02:18:03.593

我不确定这是如何在 amazon-ecs gem 中公开的，但亚马逊的文档指出 BrowseNodes 响应组将返回祖先节点列表，其中最深的将是顶级类别。

```
 <Item>
  <ASIN>0976925524</ASIN> 
  <BrowseNodes>
    <BrowseNode>
      <BrowseNodeId>69825</BrowseNodeId> 
      <Name>High School</Name> 
      <Ancestors>
        <BrowseNode>
          <BrowseNodeId>10605</BrowseNodeId> 
          <Name>Education</Name> 
          <Ancestors>
            <BrowseNode>
            <BrowseNodeId>53</BrowseNodeId> 
            <Name>Nonfiction</Name> 
            <Ancestors>
              <BrowseNode>
              <BrowseNodeId>1000</BrowseNodeId> 
              <Name>Subjects</Name> 
              <Ancestors>
                <BrowseNode>
                <BrowseNodeId>283155</BrowseNodeId> 
                <Name>Books</Name> 
```

您可以在这里查看： [http ://docs.amazonwebservices.com/AWSECommerceService/latest/DG/index.html?FindingBrowseNodes.html](http://docs.amazonwebservices.com/AWSECommerceService/latest/DG/index.html?FindingBrowseNodes.html)

# php - 有没有办法将 VML 文档转换为位图图像？

> ID：912340
> 
> 赞同：2
> 
> 时间：2009-05-26T19:40:49.810
> 
> 标签：php, javascript, internet-explorer, bitmap, vml

我一直在寻找一种从 VML 文档中获取位图的方法。事实上，我正在研究一些使用该标签的库，所以除了 IE（当然）之外我没有任何问题，因为我在 IE 中使用 ExCanvas，但我想从生成的“位图”画布”（实际上是 VML）。

我一直在寻找一些方法来从 VML 中获取 JS 中的位图，但我放弃了这个想法，现在我想找到一个能够获取 VML 字符串并将其转换为位图的服务器端库图片。我的首选语言是 PHP，但如果这种语言没有，那也没关系。我还查看了一个可以做到这一点的 Java 小程序，但实际上没有签名是不可能的，这是不可能的。

感谢你的回复 ！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-29T00:16:15.450

您可以使用像[CutyCapt](http://cutycapt.sourceforge.net/)这样的东西来允许浏览器渲染它并将其捕获到图像中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-01-28T21:24:08.430

我找到了一个看起来像我的问题的最佳解决方案的库：[VectorConverter](http://vitali.web.cs.unibo.it/Progetti/VectorConverter)。然而，它有一些问题：

*   它只支持规范中非常有限的部分
*   它不再维护
*   代码写得不是很好，它没有为 VML 使用现有的 DOM 解析器
*   我没时间加强它！

因此，如果任何有很多时间并且对这个项目感兴趣的人都可以参与其中，也许可以分叉它。如果你打算在这方面工作，请联系我，我可以帮助你。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-03-17T17:34:38.160

简单的可能性是使用 C# 在 ie webbrowser 控件中显示加载 vml 页面的窗口，并使用 this.webBrowser.Navigate("file.html") 加载包含在 html 中的 vml 页面，然后通过捕获进行快照使用graphic.CopyFromScreen函数自动生成图像

# javascript - 即使使用 javascript 更改 html 页面且没有框架，也可以连续播放视频

> ID：912350
> 
> 赞同：0
> 
> 时间：2009-05-26T19:43:03.830
> 
> 标签：javascript, video

即使 html 页面发生变化，我也希望继续播放视频。新的谷歌视频页面以这种方式工作。我的页面使用 javascript。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-26T19:45:07.693

只有在更改 DOM 的部分时才能继续播放视频，而不是在页面位置更改时。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-26T19:46:31.077

使用 AJAX 重新加载页面的某些部分怎么样。

然后你避免重新加载会停止视频播放。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-26T19:47:06.113

我认为您想检查[AJAX](http://en.wikipedia.org/wiki/Ajax_(programming))（异步 JavaScript 和 XML）。这允许您通过 JavaScript 使用对服务器的回调来操作页面的某些部分（通常是整个 HTML DOM）。这正是 YouTube/Google 视频在观看视频的同时允许投票/反馈的方式，因为任何页面重新加载都会强制浏览器停止播放视频并重新启动。

根据您使用的 Web 框架，AJAX 库有多种不同的选择。例如微软已经创建了自己的[ASP.NET AJAX]]( [http://www.asp.net/ajax/](http://www.asp.net/ajax/) )，现在已经非常成熟了。

# syntax - 如何在 elisp 'if' 语句中编写多个语句？

> ID：912355
> 
> 赞同：73
> 
> 时间：2009-05-26T19:44:44.667
> 
> 标签：syntax, elisp

在 elisp 中，有一个“如果”的情况，我想执行许多不同的事情：

```
(if condition
    (do-something)
    (do-something-else)
    ...) 
```

但是， (do-something-else) 仅在 else-case 中执行。如何指定要执行的指令块？例如：

```
(if condition
    (begin
        (do-something)
        (do-something-else)
        ...)) 
```

* * *

## 回答 #1

> 赞同：97
> 
> 时间：2009-05-26T19:53:30.470

使用`progn`：

```
(if condition
    (progn
        (do-something)
        (do-something-else))) 
```

* * *

## 回答 #2

> 赞同：50
> 
> 时间：2009-05-26T20:30:32.593

如果`else`不需要，使用它可能更具可读性：

```
(when condition
    (do-something)
    (do-something-else)) 
```

而且，反过来

```
(unless (not condition)
    (do-something)
    (do-something-else)) 
```

查看[Emacs Lisp 手册以了解条件](http://www.gnu.org/s/emacs/manual/html_node/elisp/Conditionals.html)。

# .net - 从 .net 代码播放 MP3

> ID：912356
> 
> 赞同：4
> 
> 时间：2009-05-26T19:44:55.527
> 
> 标签：.net, audio, mp3

我将在即将到来的星期六（2009 年 5 月 30 日）结婚。我们很穷。因此，我不想聘请 DJ，而是希望我的朋友从笔记本电脑上启动 mp3 播放列表，然后通过 PA 系统播放。

好吧，我对一些完美的软件有一个愿景。这是愿景： ![替代文字](https://lh3.ggpht.com/_1RtF2lqDv2g/ShxExPnO1FI/AAAAAAAAFg0/wW_pnSNT-bY/s800/may30mediaplayer.jpg)

我希望这样做，这样我的朋友就不会搞砸了，我认为如果我的愿景成为现实，那么就不会搞砸了。

现在是编程问题？如何从 .net 代码播放 mp3？我目前正在尝试使用 NAudio，但我不知道我是否可以让它淡入/淡出文件。

还有其他可以帮助我的免费图书馆吗？感谢您的任何意见。时间就是生命。

# 人们！

专注于编程问题！如果我将来需要使用音频，您的回答可能是我命运的关键。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-05-26T19:49:30.757

您所描述的内容听起来像是 iTunes 和 Windows Media Player 等功能程序已经拥有多年的功能，我建议您只使用这两个程序之一。但是，如果您确实想从 .NET 播放 MP3，Google 搜索找到了我这个：http: [//www.codeproject.com/KB/audio-video/mp3player.aspx](http://www.codeproject.com/KB/audio-video/mp3player.aspx)和这个：[http://www.codeproject。 com/KB/audio-video/ManWMF.aspx](http://www.codeproject.com/KB/audio-video/ManWMF.aspx)

此外，如果您的婚礼在 4 天内举行，这可能不是最好的主意。我不会浪费您的时间编写媒体播放器。如果你想让它变得精致和防白痴，请使用 iTunes。如果您想编写媒体播放器，请在婚礼后进行。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-05-26T19:52:55.807

到目前为止，这里最简单的解决方案是使用**Windows Media Player COM 控件**。[此页面](http://grouplab.cpsc.ucalgary.ca/cookbook/index.php/VisualStudio/HowToUseWindowsMediaPlayerToPlayAudioAndVideo)提供了开始使用此方法的良好指南。只需使用计时器调整音量即可产生淡入/淡出效果。

如果您想完全控制播放，那么总有[**DirectShow.NET**](http://directshownet.sourceforge.net/)选项，尽管这对于您的任务来说可能是多余的。更重要的是，除非您已经对非托管 DirectShow API 有一定的经验，否则使用起来非常痛苦。但是，正如我所说，如果可能的话，我会尽量远离这种情况。

**编辑：**我现在也意识到[`Microsoft.Xna.Framework.Media`](http://msdn.microsoft.com/en-us/library/microsoft.xna.framework.media.aspx)命名空间可以为您的任务提供一个很好的托管解决方案。它当然应该比 WMP 控件提供更多的控制权（作为奖励，它是纯粹的 .NET 而不是 COM）。唯一的小缺点是它需要引用 XNA Framework 3.0。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-26T19:50:33.970

下载[MediaMonkey](http://www.mediamonkey.com/)。在婚礼前一周你有比写另一个 MP3 播放器更好的事情要做。MediaMonkey 甚至有一个 DJ 模式，可以锁定您的系统，这样您的客人就无法更改您的播放列表。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-02T16:45:47.607

正如我之前所说，

> “有很多关于图书馆帮助播放音频的好建议，这就是我真正想要的。我不会真的尝试编写程序。感谢您的好评。”

仅针对那些好奇的人：对于我的婚礼，我使用了 Winamp 5.whatever，并为婚礼的不同部分保存了播放列表，并在文件名前加上 01、02……，这样它们就会按顺序显示在文件系统中。

为了规范音频，我下载了一个名为[RockSteady](http://www.winamp.com/plugins/details/1099)的插件，效果很好。对于停止/暂停/歌曲之间的淡入淡出，在选项 -> 首选项 -> 插件 -> 输出 -> Nullsoft DirectSound 输出配置 -> 淡入淡出选项卡中，我将“歌曲结束”设置为 6000 毫秒，将“暂停/停止”设置为15000 毫秒。然后在另一个选项卡上，我选中了“对数渐变”复选框。

这些设置使音频听起来不错且专业。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-26T19:52:04.933

你在重新发明轮子。如果“时间至关重要”，只需为您的朋友创建播放列表文件并将它们全部放在同一个目录中。将它们标记为 00 - 前奏，01 - 游行等。

有关更多信息，请参阅[有关 M3U 格式的这篇文章。](http://en.wikipedia.org/wiki/M3U)您可以列出要以这种基于文本的格式播放的文件。或者只是使用媒体播放器（如 winamp 或 windows 媒体播放器）来创建播放列表文件。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-26T20:04:08.467

我同意这里的大多数其他人。我认为你真的应该尝试通过使用另一个已经构建的免费选项（如 iTunes、Winamp 或 WMP）来简化事情。如果你真的想学习新东西，那么在你不会承受如此大的压力让它发挥作用之后，这样做只是为了好玩。

但是，如果您真的想完成此操作，我认为[http://code.google.com/p/ffmpeg-sharp/](http://code.google.com/p/ffmpeg-sharp/)应该做您想做的事。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-26T20:04:29.357

真的很有趣，但我认为您应该使用已经存在的解决方案。

但是，您可以查看以下链接：

*   [http://www.codeproject.com/KB/audio-video/cswavplay.aspx?df=100&forumid=13779&exp=0&fr=26&select=736865](http://www.codeproject.com/KB/audio-video/cswavplay.aspx?df=100&forumid=13779&exp=0&fr=26&select=736865)
*   [http://www.csharphelp.com/archives/archive264.html](http://www.csharphelp.com/archives/archive264.html)

此外，Windows 媒体播放器 com 控件应该是一个不错的选择。

PS：我不知道我是否可以在答案中包含一个问题，但是您是如何制作该图形的？

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-31T04:38:38.287

我同意其他人的观点，制作几个播放列表，然后使用 Windows 媒体播放器加载/播放它们。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2010-08-24T19:49:24.603

我包装了 mp3 解码器库，并将其提供给 .net 开发人员。你可以在这里找到它：

[http://sourceforge.net/projects/mpg123net/](http://sourceforge.net/projects/mpg123net/)

包括将 mp3 文件转换为 PCM 和读取 ID3 标签的示例。

你需要像 waveOut 包装器这样的东西，我知道它存在，然后就可以了！

# php - MAMP：主机设置问题

> ID：912368
> 
> 赞同：1
> 
> 时间：2009-05-26T19:47:38.033
> 
> 标签：php, zend-framework, mamp

我只是设置我的测试环境，几个问题。

*   我正在使用 MAMP，我的文档根目录是否应该指向 MAMP 中的 htdocs 文件夹？
*   MAMP 当前使用 .:Applications/MAMP/conf/php5/php.ini 中的 php.ini 文件，如何让它使用我的 /var/www/projectname/ 文件夹中的 php.ini 文件？
*   我收到以下错误，仅仅是因为我没有设置任何控制器吗？

    致命错误：在 /Users/kieransenior/Development/reformsoft_dietron/trunk/var/www/dietron/include/Zend/Controller/Dispatcher/Standard.php:241 中未捕获的异常“Zend_Controller_Dispatcher_Exception”和消息“指定的控制器无效（错误）”跟踪：#0 /Users/kieransenior/Development/reformsoft_dietron/trunk/var/www/dietron/include/Zend/Controller/Front.php(934): Zend_Controller_Dispatcher_Standard->dispatch(Object(Zend_Controller_Request_Http), Object(Zend_Controller_Response_Http)) # 1 /Users/kieransenior/Development/reformsoft_dietron/trunk/var/www/dietron/htdocs/index.php(7): Zend_Controller_Front->dispatch() #2 {main} 抛出 /Users/kieransenior/Development/reformsoft_dietron/trunk /var/www/dietron/include/Zend/Controller/Dispatcher/Standard.php 在第 241 行

有没有聪明的人愿意伸出援手？

编辑：

这是我的 httpd.conf，位于我的 var/www/proj 文件夹中

```
<VirtualHost *:*>
    ServerName localhost
    DocumentRoot /Users/kieransenior/Development/reformsoft_dietron/trunk/var/www/dietron/htdocs

    <Directory /Users/kieransenior/Development/reformsoft_dietron/trunk/var/www/dietron/htdocs>
        AllowOverride All
        Options All
    </Directory>

    php_value include_path .:/Users/kieransenior/Development/reformsoft_dietron/trunk/var/www/dietron/include:/usr/local/lib/pear
    php_value magic_quotes_gpc off
    php_value register_globals off
</VirtualHost> 
```

但这不起作用，所以在我的 php.ini 文件中，我有以下内容：

```
include_path = ".:/Applications/MAMP/bin/php5/lib/php:/Users/kieransenior/Development/reformsoft_dietron/trunk/var/www/dietron/include" 
```

但我不想那样做，我希望能够使用 httpd.conf。这只是实现同一件事的两种方法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-26T23:03:06.967

抛出此错误是因为尝试分派请求时在引导程序（index.php 第 7 行）中发生错误，另外您没有定义 ErrorController。

在文件 ErrorController.php 中在 IndexController 旁边创建一个名为 ErrorController 的控制器

ZF 参考指南有一个关于[ErrorController](http://framework.zend.com/manual/en/zend.controller.plugins.html#zend.controller.plugins.standard.errorhandler)的部分（向下滚动一点代码）

这至少应该允许您使用 ErrorController 来显示问题的根本原因！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-26T20:55:18.973

1.  老实说，我不记得了，因为我使用的是 MAMP PRO。在 MAMP PRO（和我记得的 MAMP）中，您将能够更改文档根目录。在 MAMP PRO（仅限）中，您可以创建多个虚拟主机。

2.  不要将 MAMP 指向另一个文件，而是编辑 MAMP 文件，因为 MAMP 会对文件进行一些更改，以便您拥有更大的灵活性。尝试查看文件 > 编辑模板 > PHP5 php.ini

3.  您尚未在 Zend Framework 安装中创建任何控制器。因为没有异常捕获设置公关。默认情况下，您会收到“致命错误：未捕获的异常”错误。

希望我的回答对您有所帮助。

# c# - .net 控制台应用程序在连续打印出大量字符时停止响应

> ID：912373
> 
> 赞同：2
> 
> 时间：2009-05-26T19:48:52.040
> 
> 标签：c#, .net, console-application

我试图弄清楚为什么当我要求我正在处理的程序向它正在运行的控制台输出大量字符时，它会进入“无响应”模式。

我尝试创建一个仅打印字符的小示例，这确实会在大约 10-20 秒后对我“无响应”：

```
static void Main(string[] args)
{
    for (int i = 0; i < 255; i = (i+1) % 255)
    {
        Console.Write(((char)i));

    }
} 
```

该程序仍在运行，即使控制台窗口“没有响应”，我仍然可以暂停调试器并继续它，但控制台窗口已损坏。

问题是，控制台不介意吐出无穷无尽的整数：

```
static void Main(string[] args)
{
    for (int i = 0; i < 255; i = (i+1) % 255)
    {
        Console.Write(i);            
    }
} 
```

任何想法都非常受欢迎。谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-26T19:52:49.940

当您将其转换为字符时，您还将控制字符发送到控制台以获得一些较低的`i`. 我猜这与重复输出其中一些控制字符有关。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-26T19:55:51.713

好吧，它会吐出很多废话（并且会发出很多哔哔声，除非你掩盖了字符 7，这是一个铃铛），但它永远不会对我没有反应。

这将取决于您的控制台如何处理控制字符 - 您使用的是哪个控制台，在哪个操作系统上以及使用哪种语言？

此外，为什么*要向*控制台发送不可打印的字符？如果将循环保持为 ASCII (32-126) 会发生什么？例如：

```
using System;

class Test
{   
    static void Main(string[] args)
    {
        int i=32;
        while (true)
        {
            Console.Write((char)i);
            i++;
            if (i == 127)
            {
                i = 32;
            }
        }
    }
} 
```

那仍然表现出相同的行为吗？

你提到了调试器——如果你在调试器之外运行，你会得到相同的行为吗？（到目前为止，我只从命令行进行了测试。）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-27T07:16:50.757

顺便说一句，您可以省略`i<255`并简单地写： `for (int i = 0; ;i = (i+1) % 255 )`

或与乔恩的回答一起去，你可以像这样简化

```
using System;

class Test
{   
    static void Main(string[] args)
    {

        for(var i=0;;i=(i+1) % 126)
        {
            Console.Write((char)(i+32));
        }
    }
} 
```

# extjs - extjsGirdPanel.getView().getRowClass 第二次不起作用

> ID：912379
> 
> 赞同：0
> 
> 时间：2009-05-26T19:49:35.547
> 
> 标签：extjs

extjsAction 按钮的处理程序使用以下代码调用函数。

```
 Add: function() {
        var window = Ext.getCmp('wndAdd');
        window.items.items[0].getStore().reload;
        var Grid1 = Ext.getCmp('grdAll');

        var grdStore2 = Ext.getCmp('grid2').getStore();
        var i = 0;
        var IDList = new Array();
        for (i = 0; i < grdStore2.data.length; i++) {

               IDList[i] =
               grdStore2.data.items[i].data['ID'];

        }

        Grid1.getView().getRowClass = function(record, index) {

            if (IDList.contains(record.data["ID"])) {
                return 'disabled-row';
            }
        };

        window.show();

    } 
```

但是 getRowClass 函数仅在第一次单击按钮时起作用。不会禁用添加的行。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-27T05:35:18.053

getRowClass 只需要分配一次。它不是您调用的函数，它是每次呈现一行时网格在内部调用的函数。与其在事件处理函数中分配它，不如在应用程序级别的某个地方分配一次（例如，Grid1 本身第一次配置的地方是最合乎逻辑的地方）。这可能是您的问题，也可能不是您的问题，具体取决于您的 Add 函数是如何被调用的，这一点尚不清楚。请记住，由于您依赖于 getRowClass 中的 IDList，因此您还必须引用该函数所在范围内的变量，并且您可能还必须添加检查以确保它在访问之前有效它。

您也没有显示 Grid1 重新渲染的位置。如上所述，getRowClass 仅在呈现行时执行，因此除非您在代码中未显示的某处刷新 Grid1，否则永远不会调用 getRowClass。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-12T19:55:25.447

仅供参考，虽然我很高兴您找到了适合您的解决方案，但我不确定您是否仍然了解 getRowClass。它不会只被调用一次——每次重新渲染网格行时都会调用它（即任何时候数据更改）。它只在您的代码中被调用一次，因为您的代码设置不正确。

我不完全理解您的用例，但无论显示的窗口如何，只有在网格的基础数据实际发生变化时，行条带才需要更改。当您正确设置 getRowClass 函数时，网格会在需要时自动为您调用它，并且它应该“正常工作”。应该不需要您编写的迭代代码，这只会增加额外的开销。

再次，仅供参考。:)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-12T18:42:38.493

是的，配置网格时 getRowClass 只被调用一次。但我想要每次window.show() 被解雇时都会触发的东西。我在 window.onshow 事件中使用了以下代码。

```
for (var i = 0; i < Grid1.getStore().data.length; i++) {
    var element = Ext.get(Grid1.getView().getRow(i));
    var record = Grid1.getStore().getAt(i);
    if (IdList.contains(record.data.ID)) {
        element.addClass('disabled-row')
    } else {
        element.removeClass('disabled-row')
    }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-27T04:06:06.303

一旦提供更多信息，我将使用适当的答案编辑我的回复。

你什么时候触发getRowClass？似乎您正在创建函数，但从未真正调用响应。

函数是否出错，被调用，或者只是没有做你想做的事？

# django - Django 内容类型和装饰器

> ID：912386
> 
> 赞同：1
> 
> 时间：2009-05-26T19:51:32.547
> 
> 标签：django, django-models, content-type, decorator

该站点使用 2 个对象 - 文章和博客。每次查看文章或博客时，相关计数器应增加一。

这个想法是有一个“前十”的应用程序来衡量文章和条目的“流行度”。

因为我使用了多个对象，所以我希望 Tracker 模型对相关对象使用 genericForeignKey。

```
#models.py
class Tracker(models.Model):
    count = models.PositiveIntegerField(default=1)
    content_type = models.ForeignKey(ContentType)
    object_id = models.PositiveIntegerField()
    content_object = generic.GenericForeignKey('content_type', 'object_id')
    def hit(self):
        self.count += 1 
```

我想编写一个包装视图函数的装饰器，但这可能不是必需的。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-26T22:28:31.390

如果我理解正确，您想计算每个对象的每个实例化。我会使用[post_init](http://docs.djangoproject.com/en/dev/ref/signals/#post-init) [信号](http://docs.djangoproject.com/en/dev/topics/signals/#topics-signals)来做到这一点——如果你不介意它不是装饰器的话。

这是我写的代码 - 使用 post_save 而不是 post_init：

```
def thumb_init(sender, **kwargs):
    kwargs['instance'].process()
    kwargs['instance'].make_thumbnail()

post_init.connect(thumb_init, sender=Thumbnail) 
post_init.connect(thumb_init, sender=<otherModel here>) 
```

# c# - ASP.NET 自定义配置文件 serializeAs 属性

> ID：912387
> 
> 赞同：4
> 
> 时间：2009-05-26T19:51:34.687
> 
> 标签：c#, asp.net, serialization, profile

我正在尝试在 C# 中实现一个继承 System.Web.Profile.ProfileBase 的自定义配置文件类。我有一些 System.Collections.Generic.List 类型的属性需要序列化为二进制而不是默认的 XML。但是，我不确定如何在 Profile 类中标记该设置。

例如，我有一个名为“SavedReports”的属性，它的类型为 List。如果我要使用 web.config 方法，我会简单地写：

```
<code>
<profile>
 <providers>
  <add name="SavedReports" serializeAs="Binary" type="System.Collections.Generic.List`1[MyNamespace.SavedReports]"/>
<code> 
```

但是，我不确定如何在 C# 中为自定义实现添加 serializeAs="Binary" 属性：

`[SettingsAllowAnonymous(false)]`

 ````
 public List<SavedReport> SavedReports
    {
        get { return base["SavedReports"] as List<SavedReport>; }
        set { base["SavedReport"] = value; }
    } 
````  `任何帮助都会很棒。

谢谢，克里斯

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-26T19:57:57.840

我发现了这个：

[SettingsSerializeAsAttribute](http://msdn.microsoft.com/en-us/library/system.configuration.settingsserializeasattribute.aspx)

> 使用 SettingsSerializeAsAttribute，您可以指定应该为给定的应用程序设置类或属性使用哪种序列化机制。此属性被视为对设置提供程序的请求。如果提供者或单个属性类型不支持指定的序列化方案，它可能会被忽略或导致错误。如果这个属性不存在，提供者通常会提供一个默认的序列化机制，最常见的是纯文本。

# c# - 反射器和自动属性的问题

> ID：912402
> 
> 赞同：0
> 
> 时间：2009-05-26T19:55:07.003
> 
> 标签：c#, reverse-engineering, decompiling, reflector, disassembly

我刚刚反汇编了一个项目以使用[Reflector](http://www.red-gate.com/products/reflector/)对其进行调试，但它似乎不愿解码自动属性的“编译结果”，例如下一行给了我一个语法错误。我试过手动修复这些，但每次我修复一个，都会出现更多。

```
private string <GLDescription>k__BackingField; 
```

对此我能做些什么吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-26T19:57:20.570

编译器生成具有“不可描述的名称”的字段——即在 C# 本身中是非法的但是有效的 IL 的字段。

没有将 IL 完全准确地翻译成“普通”C#（没有自动属性）。您可以替换`<`and`>`与`_`which 将给出合法代码，但当然它不再是*完全相同*的代码。但是，如果您只追求调试能力，那将不是问题。

如果您反编译迭代器（即使用`yield`语句的方法），您会发现更多相同的内容，包括块的使用`fault`，这些块类似于`finally`块，但它们仅在发生异常时运行（但不捕获异常）。其他各种构造也会生成难以描述的名称，包括匿名方法、lambda 表达式和匿名类型。

更广泛地说，您是否有权反编译此代码？如果作者不介意您这样做，他们可能愿意为您提供源代码，让您的生活更轻松。如果他们*不*希望您从调试他们的源代码开始，您应该考虑反编译代码的道德（和潜在的法律）后果。这可能因地点而异：请咨询真正的律师以获得更明确的指导。

编辑：看到你自己的答案，这很有意义。我将把它留在这里作为背景材料。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-26T20:00:00.253

哈！愚蠢的我：我所要做的就是将 Reflector 选项中的反汇编优化设置为 .NET 3.5。我的是2.0。

# php - upload_max_filesize 不变

> ID：912410
> 
> 赞同：1
> 
> 时间：2009-05-26T19:57:00.197
> 
> 标签：php, forms, ini

我正在尝试将upload_max_filesize 的值增加到10485760（10M）。

我在用：

```
ini_set('upload_max_filesize',10485760); 
```

这总是返回 false 并且 upload_max_filesize 继续为 2M。我在 Windows 上使用 php 5.2.8，我没有禁用 ini_set，也没有开启安全模式。

任何人都知道为什么这不起作用？谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-26T21:26:11.763

在您的 PHP 脚本开始运行*之前，*将检查 upload_max_size 设置。因此，当您更改设置时，上传已经失败。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-26T20:01:08.113

尝试编辑 php.ini 文件而不是 PHP 脚本中的值。您的脚本可能出于某种原因没有权限覆盖 php.ini。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-27T14:30:51.027

检查变量`[post_max_size][1]`。

> 设置允许的帖子数据的最大大小。此设置也会影响文件上传。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-01-02T21:41:56.140

尝试这个：

```
ini_set('upload_max_filesize','100M'); 
```

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2009-05-26T21:41:16.727

它在 apache (mod_php) 中运行吗？如果是这样的话，apache中的设置也会影响这一点。

> apache 网络服务器有一个 LimitRequestBody 配置指令，该指令限制所有 POST 数据的大小，而与使用的 Web 脚本语言无关。某些 RPM 安装将限制请求正文设置为 512Kb。您需要将其更改为更大的值或完全删除该条目。

# python - 具有“计算”名称的类属性

> ID：912412
> 
> 赞同：3
> 
> 时间：2009-05-26T19:57:28.043
> 
> 标签：python, exec, class-attributes

通过“计算”名称定义类属性时，如下所示：

```
class C(object):
    for name in (....):
        exec("%s = ..." % (name,...)) 
```

是否有与使用 exec 不同的方式来处理众多属性定义？getattr(C, name) 不起作用，因为在类构造期间未定义 C...

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-05-26T20:03:41.027

怎么样：

```
class C(object):
    blah blah

for name in (...):
    setattr(C, name, "....") 
```

即在定义后进行属性设置。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-26T21:13:02.930

```
class C (object):
    pass

c = C()
c.__dict__['foo'] = 42
c.foo # returns 42 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-27T06:28:22.083

如果您的整个班级都是“计算的”，那么我可以建议`type`可调用的。如果您的原始容器是 dict，这将特别有用：

```
d = dict(('member-%d' % k, k*100) for k in range(10))
C = type('C', (), d) 
```

这会给你相同的结果

```
class C(object):
    member-0 = 0
    member-1 = 100
    ... 
```

如果您的需求非常复杂，请考虑元类。（其实`type` *就是*一个元类=）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-26T20:59:58.293

为此目的使用元类怎么样？

查看[问题 100003：什么是 Python 中的元类？](https://stackoverflow.com/questions/100003/what-is-a-metaclass-in-python).

# sql - SSRS - 生成大小非动态的报告

> ID：912416
> 
> 赞同：1
> 
> 时间：2009-05-26T19:58:43.750
> 
> 标签：sql, reporting-services, reporting

我想建立一个大小和形状完全静态的报告。我试图模仿我组织中的某个人多年来一直在使用 word doc 构建的手动输入报告。

关键部分似乎是修复填充页面的各种表格网格中生成的行数。我希望它们始终包含一定数量的行，无论数据是否存在。似乎如果我可以固定我的表格的大小，那么所有其他元素都不会因为拉伸中继器部分而被迫移动。

我所有的网格都由存储过程支持，所以我也对 SQL 技巧持开放态度。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-27T11:59:13.597

抱歉，我确实错过了这个问题。

如果您知道需要返回多少行（比如 20 行），也许您可​​以将一些虚假信息填充到从存储过程返回的记录中。您可以在发回之前计算您的查询返回的记录，如果少于 20 条，请在记录集中添加一些虚假记录，在其中添加类似“NonDisp”之类的内容。

然后在报告中将 iif 语句放入检查此虚假信息的单元格中，如果发现则将单元格更改为不显示任何内容，否则显示有效值

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-27T12:18:52.447

不是直接的答案，但也许是您可能考虑的解决方法：也许您可以在具有动态大小的表格网格之后插入分页符，以便其后面的所有元素都有固定位置（相对于页面顶部）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-10-06T04:51:40.490

使用 =Ceiling((RowNumber(Nothing)) / 10000) 表达式将父组添加到 tablix。（10000 或任何所需的行数）

在组的分页符属性中，用于在组之间插入分页符的复选框，不选中底部的框。

或者，我们可以选择将隐藏属性设置为由于新父组而添加的文本框。

在 tablix 属性中，选中“在一页上保持在一起”的复选框。

# math - 将屏幕上的点取消投影到等距投影的世界

> ID：912418
> 
> 赞同：7
> 
> 时间：2009-05-26T19:59:04.593
> 
> 标签：math, 3d, linear-algebra, matrix, isometric

我正在做一个幕后 3d 模拟，同时在我的 2d 等距引擎中渲染世界。我以前从未做过等距引擎，而且我的矩阵数学一般都生锈了，所以我遇到了问题。

我有一个投影矩阵，它最简单的形式是：

```
 0.7       0.35     0
 0        -0.87     0
-0.71      0.35     1 
```

几个标志被翻转了，因为我的引擎坐标系在左上角是 0,0，+X 在右/东，+Z 在南。

现在，它的反面是：

```
1.4080  0.5670   0.0000
0.0000 -1.1490   0.0000
1.0000  0.8050   1.0000 
```

现在，这些矩阵**大部分都**有效。

例如

**WC：** 500,0,500 =**屏幕：** -1.44、350、500（X 和 Y 正确）

**WC：** 0,0,500 =**屏幕：** -355、175、500 （X 和 Y 再次正确）

但是，现在如果你需要走另一条路，你不再有那个方便的 Z 值，所以

**屏幕：** -1.44、350、0 = **WC：** -2、-402.97、0（所以，垃圾。）

还有更多——一旦我不再拥有那个 Z 值，我就无法从屏幕坐标中检索世界坐标。

这里有什么解决方法？

**编辑**

我应该指出，取消项目的目的是为鼠标拾取获得光线..

似乎只是我对自己所做的事情的误解让我在这里搞砸了。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-26T20:09:05.057

正如您所发现的，您转换回 3D 空间需要某种 Z 坐标才有意义。

我建议你做*两次*反向转换。一次在屏幕附近使用 Z 坐标（最靠近观察者），一次在 3D 场景后面使用 Z 坐标。这两个 3D 点将为您提供一条 3D 线，它将占据该 2D 点“后面”的所有位置。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-26T20:05:58.883

你不能。您正在投影到丢失信息的屏幕上。

如果您考虑一下，几个 3d 坐标会投影到屏幕上的同一点上，仅知道屏幕坐标不足以检索原始坐标。

[编辑] 查看您的屏幕坐标，您将它们的 z 值全部设为 0。这意味着您的投影矩阵的最后一列应该全为零，从而使该矩阵不可逆。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-26T20:32:24.820

屏幕上的每个像素都代表着从旁观者的眼睛到屏幕后面想象中的 3D 世界的一条线。为了获得 3D 坐标，您必须将这条线与该世界中可能潜伏的任何物体相交。

# html - 在 HTML Webforms 中屏蔽用户密码

> ID：912419
> 
> 赞同：0
> 
> 时间：2009-05-26T19:59:15.077
> 
> 标签：html, webforms, passwords

我正在使用 php 和 javascript 开发一个博客应用程序。我使用 windows live ID 进行身份验证。用户需要为 windows live writer 提供密码，因为 live writer 不能使用 live id。

我想让用户在 html 网络表单中编辑他的密码。尽管密码被输入到仅显示 * 的密码字段中，但该值在 html 中清晰可见。有什么方法可以隐藏或屏蔽 html 中的密码？我不能使用输入旧密码/输入新密码的原则，因为不需要密码。有任何想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-26T20:08:07.757

如果他们除了“*”字符之外什么都看不到，他们就不能编辑现有的密码，所以不要费心设置那个输入字段的值。让他们从头开始输入一个新的。

此外，通过 HTTPS 而不是 HTTP 提供密码更改表单和 POSTed 响应，以保护新值。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-26T20:55:17.880

在大多数应用程序中，无法将密码返回给用户以供他们编辑。我和大多数有安全意识的程序员都会对他们的密码进行哈希处理，这样就无法得出原始密码，应用程序只存储哈希值。当有人登录该站点时，他们会获取提供的密码，对其进行哈希处理，并将其与存储的哈希值进行比较以查看是否匹配。这实际上保证了用户的密码不会被 SQL 注入窃取。

# .net - 使用自定义堆栈跟踪引发异常

> ID：912420
> 
> 赞同：10
> 
> 时间：2009-05-26T19:59:55.073
> 
> 标签：.net, language-agnostic, exception

是否可以使用自定义堆栈跟踪引发异常（可能是任何异常）？

作为一个具体的例子：假设我有一组可能引发异常的小型静态实用程序方法。但是，我希望异常似乎源自先前的方法而不是实用程序方法（我想忽略跟踪的第一帧）。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-05-26T20:09:05.460

StackTrace 属性是虚拟的 - 创建您自己的派生 Exception 类并让该属性返回您想要的任何内容。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-26T20:09:51.623

搞乱堆栈跟踪真的听起来不是一个好主意，即使它是可能的（我对此表示怀疑）。告诉我，你为什么要这样做？.NET 框架本身（BCL）通常使用静态实用程序方法以您建议的方式引发异常（`ThrowHelper`至少在框架的某些部分中是它的名称），并且它确实隐藏了堆栈跟踪中的任何内容。

这是我刚刚运行的测试的示例堆栈跟踪：

```
   在 System.ThrowHelper.ThrowArgumentOutOfRangeException（ExceptionArgument 参数，ExceptionResource 资源）
   在 System.ThrowHelper.ThrowArgumentOutOfRangeException()
   在 System.Collections.Generic.List`1.get_Item（Int32 索引）
   在 C:\...\Program.cs:line 23 中的 HelloWorld.Program.Main(String[] args)
   在 System.AppDomain._nExecuteAssembly（程序集程序集，字符串 [] 参数）
   在 System.AppDomain.ExecuteAssembly（字符串 assemblyFile，证据 assemblySecurity，String [] args）
   在 Microsoft.VisualStudio.HostingProcess.HostProc.RunUsersAssembly()
   在 System.Threading.ThreadHelper.ThreadStart_Context（对象状态）
   在 System.Threading.ExecutionContext.Run（ExecutionContext executionContext，ContextCallback 回调，对象状态）
   在 System.Threading.ThreadHelper.ThreadStart()

```

如您所见，BCL 使用了该`ThrowArgumentOutOfRangeException`方法，并且在堆栈跟踪中清晰可见。如果您想用`DebuggerNonUserCode`属性标记辅助方法，那么这对我来说似乎很公平（尽管在 BCL 中没有这样做）。

# jquery - 使用 jquery 更新表格单元格

> ID：912424
> 
> 赞同：0
> 
> 时间：2009-05-26T20:00:57.303
> 
> 标签：jquery

好的，所以我有一张桌子，上面有以下内容：

```
<table id="servertable">
        <tr>
        <th scope="col">Server Name</th><th scope="col">Location</th><th scope="col">Status</th>
        </tr><tr><td>servername1</td><td>pathtoserver1</td><td>Unknown</td></tr>
        <tr><td>servername2</td><td>pathtoserver2</td><td>Unknown</td></tr>
        <tr><td>servername3</td><td>pathtoserver3</td><td>offline</td>
        </tr>
    </table> 
```

并尝试根据“pathtoserver”更新服务器的状态（使用 jquery），例如，javascript 函数接收“pathtoserver2”和“online”。我想在表中定位服务器并将值“未知”或任何可能存在的值替换为“在线”。

我试过这样的东西： $('#servertable td').find("#" + server); - 找到服务器，但这是在寻找 id，所以，我不确定是否需要为包含“pathtoserver”值的内容分配一个 id，或者是否有某种方法可以使用“.each(function(.. )" 构造来定位它并因此更新它。

所以我用了这个：`$('#servertable td:contains(' + server + ')')`

这几乎可以工作，除了我需要找到完全匹配，所以我将其更改为：

```
$('#servertable td:eq(' + server + ')') 
```

但是现在，它只找到第一个（我认为），我如何找到所有完全匹配的？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-26T20:04:33.583

这应该找到带有服务器名称的 td，假设变量被称为“服务器”：

```
$('#servertable td:contains(' + server + ')') 
```

要获得下一个 td，您只需添加`.next()`它。

# asp.net-mvc - 带有数据库查找的 URL 路由？

> ID：912427
> 
> 赞同：3
> 
> 时间：2009-05-26T20:02:43.977
> 
> 标签：asp.net-mvc, routing

我想构建一个 ASP.NET MVC 站点，以便将特定 url 的控制器存储在数据库中，而不是存储在 URL 中。

原因是我正在构建一个 CMS 系统，用户应该能够在不更改 URL 的情况下更改模板（控制器）。我还认为控制器的名称与最终用户无关，我想要干净的 URL：s。

我意识到我可以在应用程序启动时添加所有路由，但对于一个有 100 000 个页面的系统来说，这感觉是个坏主意。

是否可以将 url:s 存储在数据库中并查找每个请求，然后将该请求映射到特定控制器？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-26T20:57:13.197

基本上你必须实现你自己的 IRouteHandler。

部分答案和一些示例代码在此问题答案的选项 3 中： [ASP.NET MVC custom routing for search](https://stackoverflow.com/questions/379558/mvcnet-routing)

更多信息： [http ://weblogs.asp.net/fredriknormen/archive/2007/11/18/asp-net-mvc-framework-create-your-own-iroutehandler.aspx](http://weblogs.asp.net/fredriknormen/archive/2007/11/18/asp-net-mvc-framework-create-your-own-iroutehandler.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-26T20:57:35.083

为什么你不能做这样的事情：

-- Global.asax.cs --

```
 routes.MapRoute(null,              // Route name
                 "content/{id}",    // URL with parameters               
                 new { Controller = "Content", Action = "Show", Id = (string) null });  // Parameter defaults 
```

-- /Controllers/ContentController.cs --

```
public class ContentController : Controller
{
    public ActionResult Show(string id)
    {
        // Lookup the 'content' (article, page, blog post, etc) in the repository (database, xml file, etc)
        ContentRepository repository = new ContentRepository();
        Content content = repository.FindContent(id);
        return View(content);
    }
} 
```

这样对您的网站 www.yoursite.com/content/welcome-to-my-first-blog-post 的请求将调用 ContentController.Show("welcome-to-my-first-blog-post")。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-05-26T20:18:06.723

我想 ASP.NET 可以做许多与 PHP 相同的事情。如果是这样，有一个简单的方法。

使用重写规则，您可以轻松地将任何流量发送到 100K 的任何 URL 到同一个地方。在该目的地，您可以简单地使用包含客户端请求的 URL 的服务器变量并提取位置。在数据库中查找它并将该 URL 的相应数据即时发送回客户端。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-05-26T20:45:31.863

**“对于一个有 100,000 页的系统来说，这感觉是个坏主意。”**

如果您正在创建一个无法重用的路由系统，这是一个坏主意。基本的 {controller}/{action}/{id} 模式为您指明了重用的方向。可以根据您的需要扩展/修改/重新创建此架构。

而不是考虑您有多少页面，而是考虑如何对您的资源进行分组。

与其创建繁重的路由系统，不如创建一个允许用户仅添加有效内部链接的锚链接控件 (ascx)。在模板及其控制器的数据库中保留一个表格，以使用它填充控件。

# c# - C#：应该如何处理 TCP 套接字缓冲区数据？作为字节还是转换为 ascii 字符串？

> ID：912433
> 
> 赞同：0
> 
> 时间：2009-05-26T20:04:46.813
> 
> 标签：c#, .net, sockets

C#：应该如何处理 TCP 套接字缓冲区数据？作为字节还是转换为 ascii 字符串？

我正在使用涉及从返回的 tcp 套接字缓冲区解析特定数据的方法，哪种做法最好？

我应该以原始字节形式处理/解析我的数据吗？或者我应该在将其转换为 ascii 字符串后对其进行处理，因为字符串数据类型具有更好的文本操作？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-26T20:10:46.160

一般来说，以字节为单位。它基本上是二进制数据——由 TCP 之上的协议来适当地*解释*二进制数据。

现在，你的数据*是什么？*你能控制协议吗？如果是这样，它是否*意味着*是文本数据？将图像的二进制数据（例如）转换为 ASCII 可能是灾难性的……但如果它是真正的纯 ASCII 协议，那么它可能是正确的方法。

如果您不了解协议，请不要执行任何转换：除非您非常小心，否则它们很可能会丢失信息（例如，使用 base64 而不仅仅是 ASCII 编码）。

如果您*确实*知道协议，那应该决定您如何处理数据。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-26T20:10:53.883

实际上，缓冲区数据是“原始”字节，因此如果要解析内容，则必须将 byte[] 转换为字符串。举个例子：

```
string myString = Encoding.ASCII.GetString(myBufferData); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-26T20:15:25.807

我认为这取决于缓冲区中包含的数据。如果是字符串，将缓冲区转换为字符串会很方便。

另请注意，您应该在发送字符串之前添加一些标头数据。像数据有效负载的长度、校验和/奇偶校验等。网络是一个不确定的环境，你不能确定谁在指定端口上发送了什么，如果你只是转换，你可能会遇到难以追踪的崩溃将接收到的缓冲区直接转换成字符串。

# java - 有一个可以动态更改顺序的Java比较器可以吗？

> ID：912436
> 
> 赞同：4
> 
> 时间：2009-05-26T20:05:29.383
> 
> 标签：java, collections, comparator

我有一组带时间戳的值，我想将它们放在一个排序集中。

```
public class TimedValue {
    public Date time;
    public double value;

    public TimedValue(Date time, double value) {
        this.time = time;
        this.value = value;
    }
} 
```

对这个集合进行排序的业务逻辑表明，值必须按值降序排列，*除非它比最新值早 7 天以上*。

所以作为一个测试，我想出了下面的代码......

```
DateFormat dateFormatter = new SimpleDateFormat("MM/dd/yyyy");
TreeSet<TimedValue> mySet = new TreeSet<TimedValue>(new DateAwareComparator());
mySet.add(new TimedValue(dateFormatter.parse("01/01/2009"), 4.0 )); // too old
mySet.add(new TimedValue(dateFormatter.parse("01/03/2009"), 3.0)); // Most relevant
mySet.add(new TimedValue(dateFormatter.parse("01/09/2009"), 2.0)); 
```

如您所见，最初第一个值比第二个值更相关，但是一旦将最终值添加到集合中，第一个值已经过期并且应该是最不相关的。

我最初的测试表明这应该可以工作......随着更多值的添加，TreeSet 将动态地重新排序整个列表。

但即使我看到它，我也不确定我是否相信它。

添加每个元素时，排序集合是否会重新排序整个集合？以这种方式使用排序集合是否有任何问题（即性能）？在添加所有值之后手动对列表进行排序会更好吗（我猜会是这样）？

**追问：** 正如很多人（甚至在某种程度上我）怀疑的那样，排序的集合不支持这种“动态重新排序”的方式。我相信我最初的测试是偶然的。当我向集合中添加更多元素时，“顺序”很快就崩溃了。感谢所有伟大的回应，我重构了我的代码以使用你们许多人建议的方法。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-26T20:13:57.963

我看不到您的比较器如何甚至检测到更改，除非它记得它当前看到的最新值 - 这听起来像是一种注定会以眼泪收场的方法。

我建议你按照以下方式做一些事情：

*   在无序集（或列表）中收集数据
*   查找最新值
*   *根据该值*创建一个比较器，这样使用该比较器的所有比较都将是固定的（即，它永远不会基于相同的输入值返回不同的结果；比较器本身是不可变的，尽管它取决于构造函数中最初提供的值)
*   使用该比较器创建一个排序集合（以任何看起来最好的方式，具体取决于您想用它做什么）

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-26T20:23:43.310

我建议不要这样做，原因如下：

1.  由于它基本上是幕后的红黑树（不一定必须在每次插入时从头开始重建），因此您可能很容易在树的错误部分得到值（使大部分 TreeSet API 无效） .
2.  该行为未在规范中定义，因此即使它现在正在工作，以后也可能会改变。
3.  将来，当远程接触此代码时出现任何奇怪的错误时，您会花时间怀疑这就是原因。

我建议在搜索之前重新创建/重新排序 TreeSet，或者（我的偏好）在搜索之前迭代集合并删除任何太旧的对象。如果您想用一些内存换取速度，您甚至可以保留第二个按日期排序并由相同对象支持的列表，这样您过滤 TreeSet 所需要做的就是根据时间从 TreeSet 中删除对象-排序列表。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-26T20:08:01.157

我不相信 JDK 库甚至 3rd 方库是为了处理结果不一致的比较器而编写的。我不会依赖这个工作。如果您的 Comparator 在一次调用时可以为两个值返回不等于并且如果稍后调用可以为相同的两个值返回相等的值，我会更担心。

仔细阅读合同[`Comparator.compare()`](http://java.sun.com/javase/6/docs/api/java/util/Comparator.html#compare(T,%20T))。您的 Comparator 是否满足这些约束？

详细地说，如果您的 Comparator 在您调用一次时返回两个值不相等，但后来又返回这两个值相等，因为后来将一个值添加到集合中并更改了 Comparator 的输出，则定义“设置”（无重复）变为撤销。

Jon Skeet 在他的回答中的[建议](https://stackoverflow.com/questions/912436/is-it-ok-to-have-a-java-comparator-where-order-can-change-dynamically/912488#912488)是很好的建议，并且可以避免担心这类问题。确实，如果您的 Comparator 没有返回一致的值，`equals()`那么您可能会遇到大问题。每次添加某些内容时，已排序的集合是否会重新排序，我不会依赖，但是更改*顺序*会发生的最糟糕的事情是您的集合不会保持排序状态。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-26T20:13:38.307

我有 99% 的把握这不会奏效。如果 Set 中的一个值突然改变了它的比较行为，它有可能（实际上很可能）再也找不到了；ie`set.contains(value)`将返回`false`，因为搜索算法将在某一时刻进行比较并在错误的子树中继续，因为该比较现在返回的结果与插入值时的结果不同。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-26T20:15:15.947

不，这行不通。

如果您在集合中使用可比较的键，则两个键之间的比较结果必须随着时间的推移保持相同。

在二叉树中存储键时，选择路径中的每个分支作为比较操作的结果。如果后面的比较返回了不同的结果，就会采用不同的fork，并且不会找到之前存储的key。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-26T20:13:41.083

我认为 Comparator 的不变性质应该是基于每个排序的，所以只要你在给定排序操作的持续时间内保持一致，你就可以（只要没有任何项目跨越7 天边界中间排序）。

但是，您可能希望更清楚地表明您正在专门询问 TreeSet，我想它会在您添加新项目时重用以前排序的信息以节省时间，所以这有点特殊。TreeSet javadocs 专门遵循 Comparator 语义，因此您可能不受官方支持，但您必须阅读代码才能很好地了解您是否安全。

我认为，当您需要对数据进行排序时，最好进行一次完整的排序，将单个时间用作“现在”，这样如果您的排序需要足够长的时间使其成为可能，您就不会冒险跳过该边界。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-05-26T20:27:53.317

记录可能会在排序过程中从 <7 天更改为 >7 天，因此您所做的事情违反了比较器的规则。当然，这并不意味着它不会起作用：如果您确切地知道内部发生的事情，许多被记录为“不可预测”的事情实际上会起作用。

我认为教科书的答案是：内置排序不可靠。您必须编写自己的排序函数。

至少，我会说当日期超出边界时，您不能依赖 TreeSet 或任何“排序结构”神奇地自行恢复。如果您在显示之前重新排序，充其量这可能会起作用，并且不要依赖更新之间保持正确的任何内容。

在最坏的情况下，不一致的比较可能会严重破坏排序。你无法保证这不会让你陷入无限循环或其他致命的黑洞。

所以我想说：阅读 Sun 的源代码，了解您计划使用的任何类或函数，看看您是否能弄清楚会发生什么。测试是好的，但是有一些潜在的棘手的情况很难测试。最明显的是：如果在排序过程中，一条记录超出了日期边界怎么办？也就是说，它可能会查看记录一次并说它 <7，但下一次它看到它是 >7。这可能是个坏消息。

我想到了一个明显的技巧：在将记录添加到结构时将日期转换为年龄，而不是动态地。这样它就不能在排序内改变。如果结构的寿命超过几分钟，请在适当的时间重新计算年龄，然后重新排序。我怀疑有人会说您的程序不正确，因为您说记录不到 7 天，而实际上它是 7 天、0 小时、0 分钟和 2 秒。即使有人注意到，他们的手表有多准确？

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-05-26T20:59:06.577

如前所述，比较器无法为您执行此操作，因为违反了传递性。基本上，为了能够对项目进行排序，您必须能够比较它们中的每一个（独立于其余部分），这显然是您无法做到的。因此，您的方案基本上要么不起作用，要么会产生不一致的结果。

也许更简单的东西对你来说就足够了：

*   根据需要应用使用值的简单比较器
*   并从您的列表/集合中删除所有比最新早 7 天的元素。基本上，每当添加一个新项目时，您都会检查它是否是最新的，如果是，则删除那些比这个大 7 天的项目。

如果您还从列表中删除项目，这将不起作用，在这种情况下，您需要将所有已删除的项目保留在单独的列表中（顺便说一下，您将按日期排序）并将它们添加回原始列表如果删除后 MAX(date) 较小。

# asp.net - 重构设计模式：根据状态显示/隐藏不同的控件组合

> ID：912437
> 
> 赞同：2
> 
> 时间：2009-05-26T20:05:40.053
> 
> 标签：asp.net, vb.net, design-patterns

假设您有控件 A、B、C、D 和 E，它们都具有 Visibility 属性。您还有状态 1、2、3、4、5 和 6，其中将显示您的控件的各种组合。

目前这是由每个状态的 switch 语句处理的：即

```
Select Case PageState
    case "1"
      a.visible = false
      b.visible = true
      c.visible = false 
      d.visible = true
      e.visible = false
   case "2"
      a.visible = true
      b.visible = true
      c.visible = false 
      d.visible = true
      e.visible = false
  case ... 
 End Select 
```

正如您可以想象的那样，这变得很痛苦，因为每个状态都需要每个控件的显示/隐藏语句。我怎样才能重构它，以便添加控件和/或状态变得微不足道？

我的第一直觉是扩展控件并添加它应该显示的状态集合，但这听起来有点矫枉过正。

**编辑** 我故意在我的问题中含糊不清，以防这有其他含义。在我当前的实例中，有问题的“控件”是 ASP 面板。这有什么改变吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-26T20:07:00.350

使用[状态模式](http://en.wikipedia.org/wiki/State_pattern)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-26T20:13:51.490

使用状态模式。让每个状态在您的页面上运行（抽象为接口）：

```
public interface IControlSituationPage // your page implements this
{
    void SetAvisibility(bool visibility);
    void SetBVisibility(bool visibility);
    ...
} 
```

……

```
public interface PageState // each state implements this
{
    void ApplyState(IControlSituationPage page);
} 
```

..然后，在确定您处于哪个状态（可能是工厂模式）之后，调用该方法：

```
// ... somewhere..
_state.ApplyState(this); 
```

当然，这代替了实际使用更健壮的表示模式，如 MVC 或 MVP。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-01T21:28:08.267

[注意：我是一个 java 人，所以我下面的实现是用 Java 实现的——它应该与 C# 或您想使用的任何其他语言非常相似]

Rob 指出了上述解决方案的问题——它确实不可维护。

它也非常冗长（GoF 状态模式通常是......）。

有时状态模式并不是你真正应该使用的。

您如何将问题彻底解决，让数据驱动它呢？

将其视为“应为哪些状态显示 X？”

尝试以下操作：

1.  创建一个代表您的状态的枚举
2.  为每个控件创建一个 EnumSet（它们非常有效）
3.  在每个 EnumSet 中，添加该控件应该可见的状态
4.  当状态改变时，检查每个控件的可见性

粗略的实现（未编译/测试）

```
public enum MyStates {State1, State2, State3...}

public class VisibilityManager {
    private Map<Component, Set<MyStates>> managedComponents =
        new HashMap<Component, Set<MyStates>>();
    private Component component;
    public void setVisibility(Component component, MyStates... states) {
        Set<MyStates> visibleStates = EnumSet.of(states);
        managedComponents.put(component, states);
    }
    public void update(MyStates currentState) {
        for (Map.Entry<Component, Set<MyStates>> e : managedComponents.entrySet())
            e.getKey().setVisible(e.getValue().contains(currentState));
    }
}

// then in your GUI setup

VisibilityManager v = new VisibilityManager();
v.setVisibility(comp1, MyStates.State1, MyStates.State2);
v.setVisibility(comp1, MyStates.State3);
v.setVisibility(comp1, MyStates.State1, MyStates.State3, MyStates.State5);
...

// and when you change the state
v.update(newState); 
```

希望这可以帮助！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-01-23T02:33:03.263

斯科特明白了这一点——对于这种微不足道的情况（当你只需要控制可见性时），使用相反的逻辑是有意义的。如果您需要执行状态转换并使您的 UI 从业务逻辑中抽象出来，状态模式将变得非常有用。

# c# - XDocument 无法在 C# LINQ 中加载 1.1 版的 xml？

> ID：912440
> 
> 赞同：11
> 
> 时间：2009-05-26T20:06:52.877
> 
> 标签：c#, xml, linq, linq-to-xml

`XDocument.Load`使用版本为 1.1 而不是 1.0 的 XML 文件时引发异常：

```
未处理的异常：System.Xml.XmlException：版本号“1.1”无效。第 1 行，第 16 位。

```

任何解决错误（没有正则表达式）并加载文档的干净解决方案？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-26T20:22:03.733

最初的反应，只是为了确认我可以重现这个：

```
using System;
using System.Xml.Linq;

class Test
{   
    static void Main(string[] args)
    {
        string xml = "<?xml version=\"1.1\" ?><root><sub /></root>";
        XDocument doc = XDocument.Parse(xml);
        Console.WriteLine(doc);
    }
} 
```

导致此异常：

```
Unhandled Exception: System.Xml.XmlException: Version number '1.1' is invalid. Line 1, position 16.
   at System.Xml.XmlTextReaderImpl.Throw(Exception e)
   at System.Xml.XmlTextReaderImpl.Throw(String res, String arg)
   at System.Xml.XmlTextReaderImpl.ParseXmlDeclaration(Boolean isTextDecl)
   at System.Xml.XmlTextReaderImpl.Read()
   at System.Xml.Linq.XDocument.Load(XmlReader reader, LoadOptions options)
   at System.Xml.Linq.XDocument.Parse(String text, LoadOptions options)
   at System.Xml.Linq.XDocument.Parse(String text)
   at Test.Main(String[] args) 
```

从 .NET 4.6 开始，它仍然失败。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-26T20:40:52.917

“1.0 版”在标准 .NET XML 库的不同位置进行了硬编码。例如，您的代码似乎违反了 System.Xml.XmlTextReaderImpl.ParseXmlDeclaration(bool) 中的这一行：

```
 if (!XmlConvert.StrEqual(this.ps.chars, this.ps.charPos, charPos - this.ps.charPos, "1.0")) 
```

我遇到了与 XDocument.Save 拒绝保留 1.1 类似的问题。这是同一类型的东西 - System.Xml 方法中的硬编码“1.0”。

我无论如何都找不到它仍然使用标准库。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-03-29T05:06:49.470

您可以跳过第一行，然后使用 XDocument.Parse 加载 XML。像这样：

```
 var lines = File.ReadAllLines(xmlFilename).ToList();
                lines[0] = String.Empty;
                var xdoc = XDocument.Parse(string.Join("", lines)); 
```

# c# - 如何从 C# 中的完整路径中获取一部分？

> ID：912443
> 
> 赞同：5
> 
> 时间：2009-05-26T20:07:38.303
> 
> 标签：c#, string, directory

我有一个完整的路径，如下所示。

```
C:\Users\Ronny\Desktop\Sources\Danny\kawas\trunk\csharp\ImportME\XukMe\bin\Debug\DannyGoXuk.DTDs.xhtml-math-svg-flat.dtd 
```

如何从整个部分中获取 DTD“部分”？

期望的输出：

```
C:\Users\Ronny\Desktop\Sources\Danny\kawas\trunk\csharp\ImportME\XukMe\bin\Debug‌​\DannyGoXuk.DTDs 
```

我可以`String`为此使用 's 方法吗？
如果是，那么如何获取它？

* * *

## 回答 #1

> 赞同：76
> 
> 时间：2009-05-26T20:09:11.357

用于`System.IO.Path.GetDirectoryName()`整个路径，或`new DirectoryInfo(path).Parent.Name`仅用于该文件夹的名称。

* * *

**您发布的路径中没有名为“DTD”的目录。** 看起来有一个名为的*文件*`"DannyGoXuk.DTDs.xhtml-math-svg-flat.dtd"`，但该路径中的句点 (.) 不是有效的目录分隔符。你的意思是`"DannyGoXuk\DTDs\xhtml-math-svg-flat.dtd"`？

如果是这种情况，*鉴于整个新路径*，您希望这样的内容返回文件`DTDs`夹中的文件列表：

```
string path = @"C:\Users\Ronny\Desktop\Sources\Danny\kawas\trunk\csharp\ImportME\XukMe\bin\Debug\DannyGoXuk\DTDs\xhtml-math-svg-flat.dtd";
string[] files = new DirectoryInfo(path).Parent.GetFiles(); 
```

* * *

> 在属性窗口中，我选择构建类型作为嵌入式资源。

现在我们终于明白了。当您选择“嵌入式资源”时，该项目将捆绑到您的可执行程序文件中。 *没有直接的路径了*。相反，将您的构建类型设置为“内容”并将“复制到输出目录”设置为“始终复制”或“如果更新则复制”。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-05-26T20:09:32.997

打电话

```
System.IO.Path.GetFileName 
```

使用完整目录路径返回路径的最后一部分，即目录名称。`GetDirectoryName`返回不需要的父目录的整个路径。

如果您有一个文件名并且您只想要父目录的名称：

```
var directoryFullPath = Path.GetDirectoryName(@"C:\DTDs\mydtd.dtd");  // C:\DTDs
var directoryName = Path.GetFileName(directoryFullPath);  // DTDs 
```

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2011-09-27T21:41:55.897

您还可以使用[Directory](http://msdn.microsoft.com/en-us/library/system.io.directory.aspx)从完整文件路径中获取目录：

```
Directory.GetParent(path).FullName 
```

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2009-05-27T00:21:23.767

编辑：在对此进行投票之前，请仔细阅读 OP 的问题和她的所有评论。OP 的标题问题并不是她想要的。我的回答给了她解决问题所需的东西。这就是为什么她投票给它的答案。是的，如果专门回答标题问题，乔尔的答案是正确的。但在阅读了她的评论后，你会发现这并不是她想要的。谢谢。

用这个 ...

```
string strFullPath = @"C:\Users\Ronny\Desktop\Sources\Danny\kawas\trunk\csharp\ImportME\XukMe\bin\Debug\DannyGoXuk.DTDs.xhtml-math-svg-flat.dtd";
string strDirName; 
int intLocation, intLength;

intLength = strFullPath.Length;
intLocation = strFullPath.IndexOf("DTDs");

strDirName = strFullPath.Substring(0, intLocation); 

textBox2.Text = strDirName; 
```

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-05-26T20:09:35.320

```
System.IO.Path.GetFileName( System.IO.Path.GetDirectoryName( fullPath ) ) 
```

这将只返回包含该文件的文件夹的名称。

为了

```
C:\windows\system32\user32.dll 
```

这将返回

```
system32 
```

我推断这就是你想要的。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2011-01-26T23:17:09.800

采用：

```
string dirName = new DirectoryInfo(fullPath).name; 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-05-26T20:09:51.373

您可以使用：

```
System.IO.Path.GetDirectoryName(path); 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-05-26T20:10:23.680

您可以使用[路径](http://msdn.microsoft.com/en-us/library/system.io.path.aspx)...

```
Path.GetDirectoryName(myStr); 
```

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-05-26T20:10:44.600

不要直接使用字符串操作。而是使用`GetDirectoryName`Path 类：

```
System.IO.Path.GetDirectoryName(myPath); 
```

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2009-05-26T20:11:19.233

使用 FileInfo 对象...

```
FileInfo info = new FileInfo(@"C:\Users\Ronny\Desktop\Sources\Danny\kawas\trunk\csharp\ImportME\XukMe\bin\Debug\DannyGoXuk.DTDs.xhtml-math-svg-flat.dtd");
string directoryName = info.Directory.FullName; 
```

该文件甚至不必真正存在。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-05-26T20:14:59.053

`Path.GetDirectory`在您指定的路径上返回：

"C:\Users\Ronny\Desktop\Sources\Danny\kawas\trunk\csharp\ImportME\XukMe\bin\Debug"

自己试试：

```
var path = Path.GetDirectoryName(@"C:\Users\Ronny\Desktop\Sources\Danny\kawas\trunk\csharp\ImportME\XukMe\bin\Debug\DannyGoXuk.DTDs.xhtml-math-svg-flat.dtd"); 
```

你的问题有点奇怪 - 没有名为 DTDs 的目录。

# macos - 无法通过 MacPorts 安装 Meld

> ID：912450
> 
> 赞同：5
> 
> 时间：2009-05-26T20:09:07.943
> 
> 标签：macos, installation, macports, meld

我发现其他人在通过 MacPorts 将 Meld 安装到 Mac 时也遇到了麻烦。

我跑

```
sudo port install meld 
```

我明白了

```
sudo port install meld  
 --->  Activating shared-mime-info @0.60_0
Error: Target org.macports.activate returned: Image error: /opt/local/bin/update-mime-database already exists and does not belong to a registered port.  Unable to activate port shared-mime-info.
Error: The following dependencies failed to build: py25-gnome gconf gtk2 shared-mime-info orbit2 libidl gnome-vfs desktop-file-utils gnome-mime-data libbonobo libbonoboui libglade2 libgnome esound audiofile libgnomecanvas libart_lgpl libgnomeui gnome-icon-theme hicolor-icon-theme icon-naming-utils p5-xml-simple p5-xml-namespacesupport p5-xml-sax gnome-keyring libtasn1 py25-gtk py25-cairo py25-numpy py25-nose py25-gobject py25-orbit
Error: Status 1 encountered during processing. 
```

**如何将 Meld 安装到 Mac？**

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-26T20:20:16.470

正如 rspeed 所说，您可能有一个错误的安装或升级创建了该文件。或者，您将 macports 之外的一些东西安装到 /opt/local 树中（尽管我不确定您最终会如何做到这一点）。我建议只强制激活 shared-mime-info 端口，然后尝试重新安装 meld。

```
sudo port activate -f shared-mime-info
sudo port install meld 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2014-03-15T23:39:41.780

我发现 MacPorts 可以安装 meld，但并没有像宣传的那样立即工作。

运行并安装所有依赖项后，它失败了，并给出了一个类似于这个问题的神秘日志消息（但不完全相同）。

经过一番挖掘后，我发现我必须执行以下操作：

确保我已正确同意 XCode 的许可

```
xcodebuild -license 
```

安装 Xcode 命令行工具

```
xcode-select --install 
```

安装 rarian（它似乎是 MacPorts 无法识别的依赖项）

```
sudo port install rarian 
```

后面的说明来自这里： http: [//www.codez.co.uk/2014/02/meld-on-mac-osx-mavericks-10-9/](http://www.codez.co.uk/2014/02/meld-on-mac-osx-mavericks-10-9/) 这是我能够得到它之前的最后一步在职的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-26T20:13:26.373

不知何故，该文件已经存在，可能来自错误的卸载或升级。

如果您强制安装，它*可能*不会破坏任何东西。

```
sudo port install --force meld 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-03-25T19:17:11.227

在 OS X 10.10 上安装融合。为了增加难度，必须使用 OS X 的石英显示服务器（而不是 X11 显示服务器）：

```
$ sudo port install python27
$ sudo port select --set python python27
$ sudo port install rarian
$ sudo port install pango +no_x11
$ sudo port install gtk2 +quartz
$ sudo port install py27-pygtk +quartz
$ sudo port uninstall --follow-dependents gtk3
$ sudo port install gtk3
$ sudo port uninstall py27-pygtksourceview
$ sudo port install py27-pygtksourceview +quartz
$ sudo port install gnome-desktop
$ sudo port install meld +quartz

$ sudo launchctl load -w /Library/LaunchDaemons/org.freedesktop.dbus-system.plist
$ sudo launchctl load -w /Library/LaunchAgents/org.freedesktop.dbus-session.plist

<reboot system...>

$ meld 
```

哇，它有效！

# c# - 参数错误 c#

> ID：912461
> 
> 赞同：1
> 
> 时间：2009-05-26T20:10:21.310
> 
> 标签：c#

我正在做书中的一个例子：Herbert Schildt 的 The Complete Reference C# 3.0。这是关于在 Console.WriteLine 中使用参数编写的。这是示例：我尝试了此操作，但出现错误：

```
Project1.exe 遇到问题，需要关闭。对此造成的不便，我们表示歉意。请将此问题告知微软。发送错误报告或不发送。如果我单击，我会在命令提示符中收到另一个错误。“未处理的异常：System.Format.Exception 输入字符串的格式不正确。
在 System.Text.StringBuilder.AppendFormatError()
在 System.Text.StringBuilder.AppendFormat（IFormatProvider 提供程序，字符串格式，对象 []args）
在 System.IO.TextWriter.WriteLine（字符串格式，对象 arg0）
在 System.IO.TextWriter.SyncTextWriter.WriteLine（字符串格式，对象 arg0）
在 D:\myPath 中的 Example2.Main()
```

我不确定这本书是否有错误或者是我的代码？我会很感激你的帮助。谢谢

> 指定格式的最简单方法之一是描述 WriteLine( ) 将使用的模板。为此，请显示所需格式的示例，使用#s 标记数字位置。您还可以指定小数点和逗号。例如，这是显示 10 除以 3 的更好方法：
> Console.WriteLine("Here is 10/3: {0:#.##}", 10.0/3.0);
> 此语句的输出如下所示： Here is 10/3: 3.33

顺便说一句，这是我的代码看起来像：

```
 static void Main()
    { 
   Console.WriteLine("Here is 10/3: {0:#.##)", 10);
    } 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-26T20:12:54.783

您为格式参数使用了错误的结束括号。

注意#.## 之后的结束括号 )，它应该是一个 } （花括号）。

另请注意，您已经省略了除法，如果您只是将代码更改为此（也更正了大括号）：

```
static void Main()
{ 
    Console.WriteLine("Here is 10/3: {0:#.##}", 10/3);
} 
```

然后你也会有另一个问题，因为结果将是：

```
Here is 10/3: 3.00 
```

原因是10/3是整数除法，看10中有多少次3完全上升，也就是3次。

如果你想要浮点除法，将 10 除以 3 得到 3 和 1/3，那么你需要确保至少有一个数字是浮点数，因此 10.0/3 就可以了。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-26T20:13:38.603

你的代码是错误的。您在字符串文字中使用了括号而不是花括号。试试这个：

```
static void Main()
    { 
       Console.WriteLine("Here is 10/3: {0:#.##}", 10);
    } 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-26T20:13:24.143

更改`)`为`}`- 似乎只是一个错字。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-26T20:13:37.073

您的格式字符串错误。你有一个`{`配对`)`

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-26T20:14:03.953

它应该是 ：

```
Console.WriteLine("Here is 10/3: {0:#.##}", 10); 
```

当你使用格式时，你应该把它放在 { 和 }

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-26T20:14:13.797

更正代码如下：

```
static void Main()    
{    
Console.WriteLine("Here is 10/3: {0:#.##}", 10.0/3);    
} 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-05-26T20:14:18.367

在你的字符串的末尾你有一个 ) 而不是一个 }

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-26T20:41:55.300

让我也无缘无故地向其他所有人发布相同的答案！

将代码中的 ##) 替换为 ##}。

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2009-05-26T20:12:44.550

那是因为**你的**代码不正确。

超过1个地方！

（大括号和缺少的 '/3.0' 部分）

# mysql - 为什么此 SQL INSERT 语句会返回语法错误？

> ID：912466
> 
> 赞同：2
> 
> 时间：2009-05-26T20:10:55.987
> 
> 标签：mysql, sql

好的，我有一个非常简单的 mysql 数据库，但是当我尝试通过 mysql-admin 运行此查询时，我得到了奇怪的错误

> INSERT INTO customreports (study, type, mode, select, description) VALUES ('1', '2', '3', '4', '5');

错误：

> 1064 - 您的 SQL 语法有错误；检查与您的 MySQL 服务器版本相对应的手册，以在第 1 行的 'select, description) VALUES ('1', '2', '3', '4', '5')' 附近使用正确的语法

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-05-26T20:12:41.693

您遇到问题是因为您使用 SQL 保留字作为列名而不是转义它们。试试这样：

```
INSERT INTO `customreports`
(`study`, `type`, `mode`, `select`, `description`)
VALUES
('1', '2', '3', '4', '5'); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-26T20:14:52.797

是的，我会重写为：

插入 [customreports] ([study], [type], [mode], [select], [description]) VALUES ('1', '2', '3', '4', '5');

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-26T20:13:32.193

只是一个猜测，但是保留字“select”（列为列名）是否会导致问题？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-26T20:13:35.327

“SELECT”是 SQL 中的保留字...使用与“select”不同的字

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-26T20:14:05.810

'select' 这个词在 sql 中是保留的。解释器认为您正在尝试在 INSERT INTO 语句中使用 SELECT 语句。您需要将字段名称括起来，以便解释器不会将它们作为命令读取。

MySQL的更新：

```
insert into customreports ('study','type','mode','select','description') values... 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-26T20:15:34.043

正确每个混乱...但要记住的关键是您应该尽最大努力不要使用保留字作为表中的列名...例如 SELECT 和 TYPE.... 不是其他三个的积极因素，但那是你的冲突在哪里。是的，通过在字段周围加上引号将告诉 SQL 您指的是其中的字段，但最好知道它为什么会失败，而不仅仅是解决方法......有助于防止将来出现类似问题。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-26T20:31:17.430

同上，但我相信你需要在列名周围加上双引号，而不是单引号。也许某些 SQL 风格会正确处理单引号，但我认为标准规定字段名称为双引号，字段值为单引号。

# c++ - 以下代码使用 std::set “合法”吗？

> ID：912469
> 
> 赞同：3
> 
> 时间：2009-05-26T20:11:40.590
> 
> 标签：c++, stl, iterator, set

我有这个代码：

```
set<int>::iterator new_end = 
                   set_difference(set1.begin(), set1.end(),
                                  set2.begin(), set2.end(),
                                  set1.begin());
set1.erase(new_end, set1.end); 
```

它在 Visual Studio 中编译并运行良好。但是，在[之前的问题](https://stackoverflow.com/questions/908949/what-happens-when-you-modify-an-element-of-an-stdset)中，人们说 a`set`的迭代器应该是`const`. 我在标准中没有看到类似的东西。有人可以告诉我它在哪里说的，或者这是否是明确定义的行为？

如果不是，请提供我需要的代码。有没有办法在不创建临时集的情况下做到这一点？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-26T20:45:42.953

您的代码违反了`set_difference`. 从[Josuttis Book](http://www.josuttis.com/libbook/)的第 420 页开始：

*   调用者必须确保目标范围足够大或使用插入迭代器。
*   目标范围不应与源范围重叠。

您正在尝试回写第一组，这是不允许的。您需要在源范围以外的地方编写 - 为此我们可以使用第三组：

```
std::set<int> set3;
std::set_difference(set1.begin(), set1.end(),
                    set2.begin(), set2.end(),
                    std::inserter(set3, set3.begin())); 
```

to 的第二个参数`std::inserter`是提示元素应该插入的位置。这只是一个提示，但是请放心，这些元素最终会出现在正确的位置。 `set3`最初是空的，所以`begin()`是我们可以给出的唯一提示。

调用后`set_difference`，`set3`将包含您试图`set1`在原始代码中包含的内容。如果您愿意，您可以继续使用`set3`或使用`swap`它。`set1`

**更新：**

我不确定这个的性能，但如果你只想删除`set1`出现在的所有元素`set2`，你可以尝试：

```
for (std::set<int>::iterator i = set2.begin(); i != set2.end(); ++i)
{
    set1.erase(*i);
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-26T20:39:00.487

解决它的一个建议：

```
std::set<int> tmp;
std::set_difference(set1.begin(), set1.end(),
                    set2.begin(), set2.end(),
                    std::inserter(tmp, tmp.begin()));
std::swap(tmp, set1); 
```

我想不出不使用临时集的方法（除了遍历容器并对单个元素进行擦除）。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-26T20:24:41.390

不，这不对。来自[SGI STL 参考](http://www.sgi.com/tech/stl/set_difference.html)

1.  [first1, last1) 和 [result, result + n) 不重叠。
2.  [first2, last2) 和 [result, result + n) 不重叠。

另外，正如 Nikolai N Fetissov 指出的那样，我不确定 begin() 是否可以用作 OutputIterator。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-26T20:17:20.437

的第五个参数`set_difference`应该是一个`OutputIterator`，见[文档](http://www.sgi.com/tech/stl/set_difference.html)。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-26T20:46:43.107

C++ 标准没有明确表示不允许分配给 set 迭代器，但它确实为 set_difference 指定“结果范围不应与任何一个原始范围重叠”（25.3.5.3）。

到目前为止，它可能对你有用，只是因为你对 set1 和 set2 的内容很幸运。

# perl - 如何从 Perl 中的数组引用优雅地创建散列？

> ID：912475
> 
> 赞同：2
> 
> 时间：2009-05-26T20:13:18.353
> 
> 标签：perl, arrays, hash, reference

我正在寻找一种更优雅的方法来创建包含我从配置文件中读取的列表的哈希。这是我的代码：

```
read_config($config_file => my %config);

my $extension_list_reference = $config{extensions}{ext};

my @ext;

# Store each item of the list into an array

for my $i ( 0 .. (@$extension_list_reference - 1) ) {
    $ext[$i] = $extension_list_reference->[$i];
}

# Create hash with the array elements as the keys

foreach my $entry (@ext) {
    $extensions{$entry} = "include";
 } 
```

谢谢。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-05-26T20:26:37.097

`my %hash = map { $_ => 'include' } @list;`

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-05-26T20:19:24.207

尝试使用地图： http: [//perldoc.perl.org/functions/map.html](http://perldoc.perl.org/functions/map.html)

这是您的新代码应如下所示：

```
my %extensions = map { $_ => "include" } @{ $config{extensions}{ext} }; 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-26T20:26:40.107

如果我理解你的问题，这就是你如何在一行中做到的：

```
@extensions{@$extension_list_reference} = (); 
```

注意：哈希的每个值都是空的，但你仍然可以使用函数**exists**检查哈希中是否存在key ，如下所示：

```
if(exists $extensions{$some_key}) {... 
```

PS如果由于某种原因你真的需要这些字符串'include'作为值，你也可以拥有它们：

```
@extensions{@$extension_list_reference} = ('include') x @$extension_list_reference; 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-26T21:30:55.623

这边走：

```
read_config($config_file => my %config);
%extensions = map +($_ => "include"), @{$config{extensions}{ext}}; 
```

或者这样：

```
read_config($config_file => my %config);
@extensions{@{$config{extensions}{ext}}} = ("include") x @{$config{extensions}{ext}}; 
```

# javascript - JavaScript 和 ECMAScript 有什么区别？

> ID：912479
> 
> 赞同：520
> 
> 时间：2009-05-26T20:13:31.130
> 
> 标签：javascript, ecma262

ECMAScript 和 JavaScript 有什么区别？根据我的推断，ECMAScript 是标准，JavaScript 是实现。这个对吗？

* * *

## 回答 #1

> 赞同：675
> 
> 时间：2015-05-07T23:13:07.680

我认为应该上一点历史课。

JavaScript 最初被命名为 Mocha，后来改为 Livescript，但最终变成了 JavaScript。

重要的是要注意 JavaScript 出现在 ECMAscript 之前，历史会告诉你原因。

一开始，JavaScript 的名字来源于 Java，最初 Brendan Eich（JS 的创建者）被要求为 Netscape 开发一种类似于 Java 的语言。

然而，Eich 认为 Java 的所有规则都过于复杂，因此着手创建一种更简单的语言，即使是初学者也可以编写代码。这在诸如放宽对分号的需求之类的事情中很明显。

该语言完成后，Netscape 的营销团队要求 Sun 允许他们将其命名为 JavaScript 作为营销噱头，因此大多数从未使用过 JavaScript 的人认为它与 Java 有关。

JavaScript 在浏览器中发布大约一两年后，微软的 IE 采用了这种语言并开始制作自己的实现，例如 JScript。与此同时，IE 在市场上占据主导地位，不久之后 Netscape 不得不关闭其项目。

在 Netscape 倒闭之前，他们决定启动一个标准来指导 JavaScript 的发展，名为 ECMAScript。

ECMAScript 有几个版本，在 1999 年他们发布了他们的最后一个版本（ECMAScript 3），然后它们进入休眠状态 10 年。在这 10 年里，微软占据了主导地位，但同时他们并没有改进他们的产品，因此 Firefox 诞生了（由 Eich 领导）和一大堆其他浏览器，如 Chrome、Opera。

ECMAScript 于 2009 年发布了它的第 5 版（第 4 版被废弃），具有严格模式等功能。从那时起，ECMAScript 获得了很大的动力，并计划在几个月后发布其第 6 版，这是迄今为止最大的变化。

[您可以在此处http://kangax.github.io/es5-compat-table/es6/](http://kangax.github.io/es5-compat-table/es6/)使用 ECMAScript 6 的功能列表以及浏览器支持。您甚至可以像使用 CoffeeScript 一样开始编写 Ecmascript 6，并使用编译器编译成 Ecmascript 5。

ECMAScript 是语言还是 JavaScript 是方言是有争议的，但并不重要。如果你继续这样想，你可能会感到困惑。没有编译器可以运行 ECMAScript，我相信 JavaScript 被认为是实现称为 ECMAScript 标准的语言。

还有其他值得注意的语言实现了 ECMAScript，例如 ActionScript（用于 Flash）

* * *

## 回答 #2

> 赞同：195
> 
> 时间：2009-05-26T22:21:34.850

ECMAScript 是语言，而 JavaScript、JScript 甚至 ActionScript 3 被称为“方言”。[维基百科](http://en.wikipedia.org/wiki/ECMAScript)对此有所了解。

* * *

## 回答 #3

> 赞同：181
> 
> 时间：2015-11-17T03:00:01.883

**ECMAScript = ES：**

*   ECMAScript 是脚本语言的标准。

*   Javascript 等语言基于 ECMAScript 标准。

*   ECMA 标准基于多种原始技术，最著名的是 JavaScript (Netscape) 和 JScript (Microsoft)。

*   ECMA 是指欧洲计算机制造商协会

**JavaScript = JS：**

*   JavaScript 是 ECMAScript 标准最流行的实现。

*   Javascript 的核心功能基于 ECMAScript 标准，但 Javascript 还具有其他不在 ECMA 规范/标准中的附加功能。

*   ActionScript 和 JScript 是实现 ECMAScript 的其他语言。

*   JavaScript 已提交给 ECMA 进行标准化，但由于名称 Javascript 的商标问题，该标准被称为 ECMAScript。

*   每个浏览器都有一个 JavaScript 解释器。

**ES5 = ECMAScript 5：**

*   ES5 是 ECMAScript 的一个版本（旧/当前版本）。

*   ES5 是您今天在浏览器中了解和使用的 JavaScript。

*   ES5 不需要构建步骤（转译器）将其转换为可以在当今浏览器中运行的东西。

*   ECMAScript 版本 5 于 2009 年 12 月完成，所有主流浏览器（Chrome、Safari、Firefox 和 IE）的最新版本都实现了版本 5。

*   5.1 版于 2011 年 6 月完成。

**ES6 = ECMAScript 6 = ES2015 = ECMAScript 2015：**

*   ES2015 是 ECMAScript 的一个版本（新的/未来的版本）。

*   正式名称应该使用 ES2015 而不是 ES6。

*   ES6 将解决 TypeScript 和 CoffeeScript 中解决的许多核心语言缺陷。

*   ES6 是 JavaScript 的下一次迭代，但它不能在当今的浏览器中运行。

*   有很多转译器会导出 ES5 以在浏览器中运行。

**巴别塔：**

*   BabelJS 是将新的 JavaScript ES6 转换为旧的 JavaScript ES5 的最流行的转译器。

*   BabelJS 使今天编写下一代 JavaScript（即 ES2015）成为可能。

*   BabelJS 简单地将 ES2015 文件转换为 ES5 文件。

*   当前的浏览器版本现在可以理解新的 JavaScript 代码 (ES2015)，即使它们还不支持它。

**TypeScript 和 CoffeeScript：**

*   两者都在 ES5 之上提供语法糖，然后被转编译成 ES5 兼容的 JavaScript。 

*   您编写 TypeScript 或 CoffeeScript，然后转译器将其转换为 ES5 JavaScript。

* * *

## 回答 #4

> 赞同：64
> 
> 时间：2015-04-27T13:34:58.537

> JavaScript = [ECMAScript](http://www.ecma-international.org/publications/standards/Ecma-262.htm) + [DOM](http://www.w3.org/html/wg/drafts/html/master/dom.html#dom) + [BOM](https://en.wikipedia.org/wiki/Browser_Object_Model)；

*   ECMAScript® 语言规范定义了用于创建和编辑对象、数组、数字等的所有逻辑......

*   DOM（**文档**对象模型**）**使得与 HTML/XML 文档（例如 ）进行通信成为**可能**`document.getElementById('id');`。

*   BOM（**B** rowser Object **M****模型**）是浏览器对象的层次结构（例如位置对象、历史对象、表单元素）。

JavaScript 命名的历史：

> Mocha ► LiveScript ► JavaScript ►（部分 JS 产生）ECMA-262 ► ECMAScript ► JavaScript（由 ECMAScript + DOM + BOM 组成）

* * *

## 回答 #5

> 赞同：44
> 
> 时间：2009-05-26T22:08:06.500

从技术上讲，ECMAScript 是每个人都在使用和实现的语言——它是多年前 Netscape 和 Microsoft 坐下来尝试标准化 JavaScript（Netscape 的脚本语言）和 JScript（Microsoft 的）之间的脚本时创建的规范。

随后，所有这些引擎表面上都在实现 ECMAScript，但是 JavaScript（名称）现在由于传统命名原因以及 Mozilla 对其各种非标准扩展的营销术语（他们希望能够真正“版本” )

* * *

## 回答 #6

> 赞同：31
> 
> 时间：2016-06-06T14:23:11.950

**什么是 ECMAScript 即 ES？**

> ECMAScript 是脚本语言的标准，Javascript 语言基于 ECMAScript 标准。

**Javascript 与 ECMAScript 完全一样吗？**

*   不，Javascript 并不完全等同于 ECMAScript。
*   Javascript 的核心功能基于 ECMAScript 标准，但 Javascript 还具有其他不在 ECMA 规范/标准中的附加功能。

> JavaScript = ECMAScript + DOM API；

DOM API 像：`document.getElementById('id');`

**其他语言是否使用 ECMAScript 标准？**

*   是的，除了 JavaScript 之外，还有其他语言也将 ECMAScript 标准作为其核心。
*   ActionScript（由 Adob​​e Flash 使用）和 JScript（由 Microsoft 使用）都是实现 ECMAScript 标准的语言。

**为什么叫 ECMAScript？**

*   Javascript 最初是在 Netscape 创建的，他们希望将语言标准化。**因此，他们将该语言**提交给欧洲计算机制造商协会**(** **ECMA** **)**进行标准化。
*******   但是，Javascript 的名称存在商标问题，该标准被称为 ECMAScript，这也是它今天的名称。*   由于商标问题，微软的语言版本被称为 JScript——尽管 JScript 的核心是与 Javascript 相同的语言。******

 ******* * *

## 回答 #7

> 赞同：17
> 
> 时间：2009-05-26T20:18:41.620

各种 JavaScript 版本都是 ECMAScript 标准的实现。

* * *

## 回答 #8

> 赞同：12
> 
> 时间：2013-12-18T17:19:51.327

在我的理解中，ECMAScript 是“理论”或“规范”，而 Javascript 是“实践”或“实现”。

* * *

## 回答 #9

> 赞同：11
> 
> 时间：2012-11-09T21:29:04.087

我知道这是一个旧帖子，但希望这会对某人有所帮助。

在 1990 年代不同版本的 js 开始出现，例如 netscape 的 javascript，Microsoft 的 Js script。因此 ecmascript 作为标准被引入。但是 ecmascript 只是 javascript 的一部分，它指定了它的核心语法、类型、对象等。这可能解释了 javascript 跨 diff 的不一致实现。浏览器

参考 - Wrox（面向 Web 开发人员的专业 Javascript）

* * *

## 回答 #10

> 赞同：10
> 
> 时间：2009-05-26T20:45:32.627

JavaScript**是一种**ECMAScript 语言。

ECMAScript**不一定是**JavaScript。

* * *

## 回答 #11

> 赞同：8
> 
> 时间：2015-04-08T17:56:03.567

现有的答案很好地解释了要点。

要点是 ECMAScript 是一种纯粹的抽象语言，没有任何特定领域的扩展，它本身是无用的。[规范](http://www.ecma-international.org/publications/standards/Ecma-262.htm)只定义了语言和它的核心对象。

虽然 JavaScript 和 ActionScript 以及其他方言将特定领域的库添加到其中，但您可以将其用于有意义的事情。

有许多[ECMAScript 引擎](http://en.wikipedia.org/wiki/List_of_ECMAScript_engines)，其中一些是开源的，另一些是专有的。您可以将它们链接到您的程序中，然后将您的本机函数添加到全局对象中，这样您的程序就可以编写脚本了。尽管它们最常用于浏览器。

* * *

## 回答 #12

> 赞同：5
> 
> 时间：2009-05-26T20:15:42.610

Javascript 是最初的名称，旨在利用 java 的流行。ECMA 是监督最终实施的标准的标准机构，因此名称大致相同。

实现有其他名称，如 V8 或 Rhino 等。

* * *

## 回答 #13

> 赞同：5
> 
> 时间：2017-06-05T13:06:39.297

**ECMAScript**是**JavaScrip** t 的标准，请查看**MDN**中的这些语句：

[![在此处输入图像描述](https://i.stack.imgur.com/0C1wM.jpg)](https://i.stack.imgur.com/0C1wM.jpg)

## JavaScript

> **JavaScript (JS)**是一种轻量级的解释型或 JIT 编译型编程语言，具有一流的功能。虽然它是最著名的网页脚本语言，但许多非浏览器环境也使用它，例如 node.js、Apache CouchDB 和 Adob​​e Acrobat。JavaScript 是一种基于原型的、多范式的动态语言，支持面向对象、命令式和声明式（例如函数式编程）风格。阅读有关 JavaScript 的更多信息。

* * *

## ECMAScript

> JavaScript 的标准是**ECMAScript**。截至 2012 年，所有现代浏览器都完全支持 ECMAScript 5.1。旧版浏览器至少支持 ECMAScript 3。2015 年 6 月 17 日，ECMA International 发布了 ECMAScript 的第六个主要版本，正式名称为 ECMAScript 2015，最初称为 ECMAScript 6 或 ES6。从那时起，ECMAScript 标准每年发布一次。本文档引用了最新的草稿版本，目前是 ECMAScript 2018。

欲了解更多信息，请访问[此处](https://developer.mozilla.org/en-US/docs/Web/JavaScript)

* * *

## 回答 #14

> 赞同：5
> 
> 时间：2018-05-11T21:20:47.463

以下是我的发现：

[由 David Flanagan 编写的JavaScript: The Definitive Guide](https://rads.stackoverflow.com/amzn/click/com/0596805527)提供了非常简洁的解释：

> JavaScript 是在 Web 早期由 Netscape 创建的，从技术上讲，“JavaScript”是 Sun Microsystems（现为 Oracle）许可的商标，用于描述 Netscape（现为 Mozilla）对该语言的实现。Netscape 将该语言提交给 ECMA 进行标准化，但由于商标问题，该语言的标准化版本被困在了尴尬的名称“ECMAScript”上。出于同样的商标原因，微软的语言版本正式称为“JScript”。实际上，几乎每个人都将语言称为 JavaScript。

微软的一篇[博文](https://blogs.windows.com/msedgedev/2015/05/12/javascript-moves-forward-in-microsoft-edge-with-ecmascript-6-and-beyond/)似乎同意弗拉纳根所说的解释。

> ECMAScript 是我们都知道和喜爱的 JavaScript 语言的正式名称。

[..这让我认为这篇](https://docs.microsoft.com/en-us/scripting/javascript/javascript-language-reference)`JavaScript`参考文章中所有出现的（再次由微软）都必须替换为. 他们实际上似乎很小心只在[这个](https://msdn.microsoft.com/en-us/library/mt828900(v=vs.85).aspx)、更新和更多技术文档页面中使用。`ECMASCript``ECMAScript`

[w3schools.com](https://www.w3schools.com/js/js_versions.asp)似乎同意上述定义：

> JavaScript 由 Brendan Eich 于 1995 年发明，并于 1997 年成为 ECMA 标准。ECMA-262 是该标准的正式名称。ECMAScript 是该语言的正式名称。

这里的关键是：**语言的正式名称**。

如果你查看[Mozilla 的 JavaScript 版本页面](https://developer.mozilla.org/en-US/docs/Web/JavaScript/New_in_JavaScript#JavaScript_versions)，你会遇到如下语句：

> 已弃用。语言功能的明确版本控制和选择加入是 Mozilla 特有的，并且正在被删除。Firefox 4 是最后一个引用 JavaScript 版本 (1.8.5) 的版本。随着新的 ECMA 标准，JavaScript 语言功能现在经常在 ECMA-262 版本（例如 ECMAScript 2015）中以其初始定义被提及。

当您查看最近的发行说明时，您将始终看到对 ECMAScript 标准的引用，例如：

> *   已实现 ES2015 Symbol.toStringTag 属性（错误 1114580）。
>     
>     
> *   ES2015 TypedArray.prototype.toString() 和 TypedArray.prototype.toLocaleString() 方法已经实现（bug 1121938）。

Mozilla Web Docs 还有一个[页面](https://developer.mozilla.org/en-US/docs/Web/JavaScript/JavaScript_technologies_overview)解释了 ECMAScript 和 JavaScript 之间的区别：

> 但是，在 Web 浏览器上下文中理解的总称“JavaScript”包含几个非常不同的元素。其中一个是核心语言（ECMAScript），另一个是 Web API 的集合，包括 DOM（文档对象模型）。

**结论**

据我了解，人们使用 JavaScript 一词来指代核心的 ECMAScript 规范有些宽泛。

我想说，所有现代 JavaScript 实现（或 JavaScript 引擎）实际上都是 ECMAScript 实现。查看 Google 对[V8 引擎](https://developers.google.com/v8/)的定义，例如：

> V8 是 Google 的开源高性能 JavaScript 引擎，用 C++ 编写并用于 Google Chrome（Google 的开源浏览器）和 Node.js 等。它实现了 ECMA-262 中指定的 ECMAScript。

他们似乎可以互换使用 JavaScript 和 ECMAScript 这个词，我会说它实际上是一个 ECMAScript 引擎？

因此，大多数 JavaScript 引擎实际上都在实现 ECMAScript 标准，但它们不称它们为 ECMAScript 引擎，而是称自己为 JavaScript 引擎。[这个](https://stackoverflow.com/a/50296636)答案也支持我看待情况的方式。

* * *

## 回答 #15

> 赞同：3
> 
> 时间：2009-05-26T20:42:57.250

如果不是因为“JavaScript”这个名字归 Sun 拥有，我怀疑我们是否会使用“ECMAScript”这个词。出于所有意图和目的，该语言是 JavaScript。您不会去书店寻找 ECMAScript 书籍，是吗？

说“JavaScript”是实现有点太简单了。JScript 是微软的实现。

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2009-05-26T22:21:34.163

JavaScript 是围绕 ECMAScript 标准形成的语言分支之一。我相信 ECMA 是欧洲计算机制造商协会，并不是说这真的相关或任何东西。

不要忘记围绕 ECMA 脚本标准形成的另一种流行语言是用于 Adob​​e Flash/Flex 的 ActionScript。

# visual-studio - 有什么好的源代码拼写检查器吗？

> ID：912486
> 
> 赞同：2
> 
> 时间：2009-05-26T20:13:50.600
> 
> 标签：visual-studio, add-in, spelling

我经常在我的项目中输入拼写错误（谷歌已经正式毁掉了我的拼写）。有人知道 VS 的插件或通用拼写检查器，它将检查引号中的字符串值（双引号和单引号），最好是免费的？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-26T20:15:45.400

谷歌搜索产生了这个[VS 拼写检查插件](http://blogs.msdn.com/webdevtools/archive/2007/12/13/spell-checker-for-html-asp-net-jscript-vb-c-css-and-c-for-visual-studio-2005-and-2008.aspx)

# javascript - 使用 javascript 获取嵌入对象的事件

> ID：912492
> 
> 赞同：0
> 
> 时间：2009-05-26T20:14:07.433
> 
> 标签：javascript, flash

我试图在单击 Flash 对象时注册事件，但我似乎无法让它工作。在下面的链接中，单击所有其他文本字段/按钮会注册某些内容，但不会注册 Flash 对象。有任何想法吗？

[http://dl.getdropbox.com/u/139980/flash%20events/flash_events.htm](http://dl.getdropbox.com/u/139980/flash%20events/flash_events.htm)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-26T20:17:01.373

您可以在 Flash 中捕获事件，然后将其发送到 JS。您还可以在您的 flash 元素（位置：绝对）前面放置一个 div 并获取有关此的事件。

编辑：我不是 100% 确定我有你的问题。如果你能更具体一点，那会有所帮助

# asp.net - ASP.NET 加载时间

> ID：912495
> 
> 赞同：1
> 
> 时间：2009-05-26T20:14:18.883
> 
> 标签：asp.net

我有一个 ASP.NET 项目，VB.NET 中的 v3.5，我正在处理。在我的家用计算机上，页面在单击某些东西时几乎会立即加载，但在我的工作计算机（这是一台速度更快的计算机）上，所有页面都需要大约一秒钟的时间来加载，无论生成的内容如何（比如它在计时器上或其他东西上） . 为什么会这样，或者我该如何弄清楚为什么我的工作计算机上的加载时间会延迟？

*   两者都运行带有 VB.NET 和 SQL Server 2008 的 ASP.NET v3.5
*   具有相同数据库的相同项目（从comp复制到另一个）
*   两者都打开了调试
*   家用电脑是 Windows XP Pro，3GHz Intel，1.5 Gigs RAM
*   工作电脑是 Windows Vista Home，Core2 Duo 2.40 Ghz，3 Gigs RAM
*   两者都在 ASP.NET 开发服务器上运行
*   除计算机本身外，完全相同的设置

感谢您的输入。

*已解决*- 问题是 FireFox 的 IPv6 问题。我把它关掉了，现在一切都很好。感谢大家的投入，对于追踪更严重的性能问题绝对是很好的建议，稍后会派上用场，只是不适用于这个问题。谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-26T20:17:15.977

假设您使用的是 Firefox，它可能与[FF 中的 IPv6 支持问题](http://blog.codeville.net/2008/11/07/speeding-up-communication-between-firefox-and-visual-studios-built-in-web-server/)有关。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-26T20:19:18.873

SQL Server 在这两种情况下都是本地的吗？

您可以做的一件事是运行 Trace 以查看延迟（如果有）在实际 ASP.NET 进程中的位置......

```
<configuration>
    <appSettings/>
    <connectionStrings/>
    <system.web>
        <compilation debug="false" />
        <authentication mode="Windows" />
      <trace enabled ="true" pageOutput ="false" requestLimit ="20" traceMode ="SortByTime " />        
    </system.web>
</configuration> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-26T20:21:48.277

您可以做很多事情来调查性能问题/差异：

1.  您提到了“完全相同的数据库”。如果它是家里的本地数据库，并且您正在从工作机器访问您的家庭数据库，这可能会导致延迟。
2.  使用[Fiddler](http://www.fiddler2.com/fiddler2/)测量网络流量。这可以帮助确定是服务器问题还是客户端问题。
3.  将[Firebug 与 Firefox 一起](http://getfirebug.com/)使用。查看 NET 选项卡和/或控制台选项卡上的 javascript 分析以确定它是 javascript 问题还是服务器问题。
4.  在 web.config 中打开 ASP.NET 跟踪以检查服务器端代码中的时间。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-26T20:21:57.900

在我工作的地方，我们在连接到 crl.microsoft.com 时遇到了防火墙问题。

尝试将此添加到您的主机文件中：

127.0.0.1 crl.microsoft.com

然后重新启动 IIS。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-26T20:35:41.633

使用 Firebug 会减慢网页的加载速度，尤其是 CSS 渲染。尝试禁用 Firebug 以查看是否可以解决您的问题。

# content-management-system - Ektron 用户更改密码？

> ID：912507
> 
> 赞同：2
> 
> 时间：2009-05-26T20:16:24.590
> 
> 标签：content-management-system, asp.net-membership, membership, ektron

我有一个安装了 Ektron 的 Ektron 客户端。他们想添加将密码更改为所需内容的功能。我需要关注 ektron 部分还是继续进行编辑？

有没有简单的方法可以做到这一点？任何信息链接将不胜感激。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-26T20:28:14.173

如果您谈论的是 Ektron CMS400 会员用户，您可以使用 Web 服务方法：

[User.ResetMembershipUserPassword](http://www.ektron.com/manuals/cms400/v76/API_Help/frames.html?frmname=topic&frmfile=%21%21OVERLOADED_ResetMembershipUserPassword_Ektron_Services_User.html)

如果您尝试为常规 CMS400 用户设置它，那么您就不走运了。管理员需要重设密码（如果他们忘记了密码），用户需要重新登录工作区并在那里更改密码。

更新

该方法将密码重置为随机值。要将密码设置为所需的值，您必须使用：

**Ektron.Cms.BusinessApi.dll**

```
Ektron.Cms.UserAPI.ResetMembershipUserPassword(string Username, 
                                               string oldPassword, 
                                               string newPassword) 
```

# sql - 如何使用 T-SQL 的 Exists 关键字？

> ID：912513
> 
> 赞同：34
> 
> 时间：2009-05-26T20:17:21.420
> 
> 标签：sql, sql-server, tsql

我有一个要作为子查询运行的查询，它将返回一组 FK。有了它们，我只想返回具有匹配键的行。

### 子查询：

```
SELECT ID 
FROM tblTenantTransCode 
WHERE
    tblTenantTransCode.CheckbookCode = 
      (SELECT ID FROM tblCheckbookCode WHERE Description = 'Rent Income') 
```

这将返回具有与租金收入匹配的支票簿代码的所有交易代码

现在我想选择其事务代码与子查询中返回的 ID 匹配的所有事务。我已经做到了这一点，但是 SQL Server 抱怨语法错误。我怎样才能做到这一点？

### 完整查询：

```
SELECT * 
FROM tblTransaction
WHERE
    tblTransaction.TransactionCode IN 
      (SELECT ID FROM tblTenantTransCode 
       WHERE tblTenantTransCode.CheckbookCode = 
           (SELECT ID FROM tblCheckbookCode WHERE Description = 'Rent Income')) 
```

### 表：

```
tblCheckbookCode  
   ID  
   描述  
   其他信息  

tblTenantTransCode  
   ID  
   CheckbookCode <-- 我们正在寻找的 fk   
                     在 tblCheckbookCode 中。   
                     我们只选择支票簿代码   
                     具有“租金收入”描述的  
   其他信息  

tblTransactions  
   ID  
   TransactionCode <-- fk 到租户交易代码。   
                       我们正在寻找返回的 ID   
                       在上面的查询/加入  

```

* * *

## 回答 #1

> 赞同：68
> 
> 时间：2009-05-26T21:21:44.800

为了回答您关于使用**EXISTS**关键字的问题，这里是一个使用 EXISTS 谓词的示例查询，基于您问题中当前给出的查询。

```
    选择 t.*
      FROM tblTransaction t
     存在于何处
           (
             选择 1
               FROM tblTenantTransCode ttc
               加入 tblCheckbookCode cc
                 开（cc.ID = ttc.CheckbookCode AND cc.Description='租金收入'）
              WHERE ttc.ID = t.TransactionCode
           )

```

* * *

**额外细节：**

我们都认识到，有多种 SQL 语句会返回满足指定要求的结果集。这些查询的观察性能可能会有所不同。性能特别依赖于 DBMS、优化器模式、查询计划和统计信息（行数和数据值分布）。

的一个优点`EXISTS`是它清楚地表明我们不感兴趣从子查询中的表中返回任何表达式。它以 a`JOIN`没有的方式在逻辑上将子查询与外部查询分开。

使用的另一个优点`EXISTS`是避免返回如果我们改为使用 a 会（可能）返回的重复行`JOIN`。

谓词可`EXISTS`用于测试子表中是否存在任何相关行，而无需连接。例如，以下查询返回一组至少具有一个关联 line_item 的所有订单：

```
    选择 o.*
      FROM 订单
     存在于何处
           （选择 1
               FROM line_item li
              WHERE li.order_id = o.id
           )

```

请注意，子查询不需要找到所有匹配的行项目，它只需要找到一行即可满足条件。（如果我们将此查询编写为`JOIN`，那么只要订单有多个订单项，我们就会返回重复的行。）

`NOT EXISTS`谓词也很有用，例如，返回一组没有**任何**关联 line_items 的订单。

```
    选择 o.*
      FROM 订单
     不存在的地方
           （选择 1
               FROM line_item li
              WHERE li.order_id = o.id
           )

```

当然，`NOT EXISTS`这只是一种选择。使用 OUTER 连接和 IS NULL 测试可以获得等效的结果集（假设我们从 line_item 表中至少有一个可用的表达式不是 NULL）

```
    选择 o.*
      FROM 订单
      剩下
      加入 line_item li ON (li.order_id = o.id)
     li.id 为空

```

似乎有很多关于需要使用`IN`谓词或需要使用`JOIN`.

这些构造是替代方案，但不是必需的。查询可以返回所需的结果集，`IN`而无需使用 a 和不使用`JOIN`. 结果集可以通过使用`EXISTS`谓词的查询返回。（请注意，OP 问题的标题确实询问了如何使用`EXISTS`关键字。）

这是另一个替代查询（这不是我的首选），但返回的结果集确实满足指定的要求：

```
    选择 t.*
      FROM tblTransaction t
     存在于何处
           (
             选择 1
               FROM tblTenantTransCode ttc
              WHERE ttc.ID = t.TransactionCode
                并且存在
                    (
                      选择 1
                        FROM tblCheckbookCode cc
                       WHERE cc.ID = ttc.CheckbookCode
                         AND cc.Description = '租金收入'
                    )
           )

```

最重要的是，查询应该返回一个正确的结果集，一个满足指定要求的结果集，给定所有可能的条件集。

此处显示为答案的某些查询*不会*返回请求的结果集，或者如果返回，它们恰好是偶然返回的。如果我们预先假设有关数据的某些内容，例如某些列是`UNIQUE`and ，则某些查询将起作用`NOT NULL`。

**性能差异**

有时带有谓词的查询不会像带有 a或谓词`EXISTS`的查询那样执行 。在某些情况下，它可能会表现得更好。（使用谓词，子查询只需找到满足条件的一行，而不是像 a 所要求的那样找到所有匹配的行。）`JOIN``IN``EXISTS``JOIN`

各种查询选项的性能最好通过观察来衡量。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-26T20:20:09.823

您正在描述内部连接。

```
select tc.id 
from tblTenantTransCode tc 
   inner join tblCheckbookCode cc on tc.CheckbookCode = cc.CheckbookCode 
```

编辑：它仍然是一个内部连接。我看不出有任何理由使用 IN 子句。

```
select *
from tblTransaction t
   inner join tblTenantTransCode tc on tc.id = t.TransactionCode
   inner join tblCheckbookCode cc on cc.id = tc.CheckbookCode
where cc.description = 'Rent Income' 
```

编辑：如果您必须使用 EXISTS 谓词来解决此问题，请参阅@spencer7953 的答案。但是，据我所见，上面的解决方案更简单，并且基于“子查询”对您有效这一事实假设唯一性（如果该表中没有唯一性，则不会 100% ）。我也在致辞

> 现在我想选择其事务代码与子查询中返回的 ID**匹配的所有事务**

在我的回答中。如果请求是这样的：

> **现在，当任何**事务代码与子查询中返回的 ID 匹配时，我想选择所有 事务。

我会使用 EXISTS 来查看子表中是否存在任何事务代码，并根据需要返回每一行或无。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-26T21:07:13.393

鉴于您的完整查询，此查询将使用单个联接将您带到您需要去的地方。

该联接过滤掉任何没有交易代码“租金收入”的交易。它将从第一个表中获取所有记录，构建第二个表的子集（WHERE 子句限制记录），然后过滤这些表计算连接条件的第一个表。

```
SELECT 
    t.* 
FROM 
    tblTransaction t
    INNER JOIN tblTenantTransCode c ON
        t.TransactionCode = c.ID
    INNER JOIN tblCheckbookCode chk ON
        c.CheckbookCode = chk.ID
WHERE
    chk.Description = 'Rent Income' 
```

编辑：另一个注意事项：避免使用 SELECT * - 始终指定列。编辑Dos：我错过了三张桌子。已更正！谢谢，斯宾塞！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-26T20:18:27.143

试试这个：

```
SELECT
    tblTenantTransCode.ID 
    FROM tblCheckbookCode 
        INNER JOIN tblTenantTransCode ON tblCheckbookCode.ID=tblTenantTransCode.CheckbookCode
    WHERE tblCheckbookCode.Description = 'Rent Income' 
```

确保索引`tblCheckbookCode.Description`.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-26T20:20:10.370

您需要使用“IN”子句：

```
select id from tblTenantTransCode
where tblTenantTransCode.CheckbookCode in
    (select id from tblCheckbookCode
     where description = 'rent income') 
```

不过，内部连接可能是一个更好的解决方案......

```
select ttc.id from tblTenantTransCode as ttc
inner join tblCheckbookCode as tcc
    on ttc.CheckBookId = tcc.id
where tcc.description = 'rent income' 
```

# c# - 在结构上使用它的开销

> ID：912514
> 
> 赞同：0
> 
> 时间：2009-05-26T20:17:26.413
> 
> 标签：c#, .net, performance, struct

当您拥有自动属性时，C# 编译器会要求您在您拥有的任何构造函数上调用`this`构造函数，以确保在访问它们之前初始化所有内容。

如果您不使用自动属性，而只是简单地声明值，则可以避免使用`this`构造函数。

`this`在结构中使用构造函数的开销是什么？它与双重初始化值相同吗？

如果性能是这种特定类型的首要问题，您会建议不要使用它吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-26T20:42:55.393

我建议不要对结构使用自动属性，因为这意味着它们将是可变的——如果只是私下的话。

使用只读字段和公共属性在适当的情况下提供对它们的访问。可变结构几乎总是一个坏主意，并且有各种讨厌的小问题。

不过，您肯定需要首先创建自己的值类型吗？根据我的经验，*很难*找到创建结构而不是类的充分理由。可能你有一个，但值得检查。

回到您最初的问题：如果您关心性能，请*衡量它*。总是。在这种情况下，它真的很容易——您可以使用自动属性编写结构，然后在没有的情况下重新实现它。您可以使用`#if`块来保持这两个选项可用。然后您可以测量典型情况并查看差异是否显着。当然，我认为无论如何设计含义可能更重要:)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-26T20:20:02.070

是的，这些值将被初始化两次，如果不进行分析，很难说这种性能影响是否会显着。

a 的默认构造函数`struct`将所有成员初始化为其默认值。发生这种情况后，您的构造函数将运行，您无疑会再次设置这些属性的值。

我想这与 CLR 在实例化时初始化引用类型的所有字段的做法没有什么不同。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-26T20:24:30.127

`: this()`当使用自动实现的属性时，C# 编译器要求您链接到默认构造函数（即附加到构造函数声明）的原因是，*所有变量都需要在退出构造函数之前分配*。现在，自动实现的属性有点搞砸了，因为*它们不允许您直接访问支持属性的变量*。编译器用来解决这个问题的方法是自动将所有变量分配给它们的默认值，并且为了确保这一点，您必须链接到默认构造函数。这不是一个特别聪明的方法，但它可以很好地完成这项工作。

所以确实，这意味着一些变量最终会被初始化两次。但是，我认为这不会是一个很大的性能问题。如果编译器（或者至少是 JIT）没有简单地删除在构造函数中设置两次的任何变量的第一个初始化语句，我会感到非常惊讶。一个快速的基准测试应该会为您确认这一点，尽管我很确定您会得到可疑的结果。（如果您碰巧不这样做，并且您绝对需要避免重复初始化提供的微小性能提升，您可以以正常方式定义您的属性，即使用支持变量。）

老实说，我的建议甚至是不要打扰结构中的自动实现属性。使用公共变量代替它们是完全可以接受的，并且它们提供的功能不亚于自动实现的属性。当然，类是另一种情况，但我真的会毫不犹豫地在结构中使用公共变量。（如果需要，任何复杂的属性都可以正常定义。）

希望有帮助。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-29T17:01:12.777

不要对结构类型使用自动属性。只需直接公开字段。如果一个结构有一个公开的类型的公共字段`Foo`，那么它是一个公开的类型字段`Bar`这一事实（可以从 Intellisense 轻松获得的信息）告诉人们几乎所有关于它的信息。相比之下，结构具有暴露的读写属性这一事实并没有说明写入是否会改变结构中的字段，或者它是否会改变一些持有引用的对象。直接公开字段将提供更清晰的语义，并且通常还会导致运行速度更快的代码。`Foo``Bar``Foo``Boz``Boz``Boz`

# mysql - MySQL：查询前 n 个聚合

> ID：912515
> 
> 赞同：1
> 
> 时间：2009-05-26T20:17:31.683
> 
> 标签：mysql, limit, aggregation

我有一个表，它计算不同用户在不同对象上发生的一个特定操作：

```
CREATE TABLE `Actions` (
    `object_id` int(10) unsigned NOT NULL,
    `user_id` int(10) unsigned NOT NULL,
    `actionTime` datetime
); 
```

每次用户执行此操作时，都会插入一行。我可以计算对每个对象执行了多少操作，并按“活动”对对象进行排序：

```
SELECT object_id, count(object_id) AS action_count 
FROM `Actions` 
GROUP BY object_id 
ORDER BY action_count; 
```

如何将结果限制为前 n 个对象？LIMIT 子句在聚合之前应用，因此会导致错误的结果。该表可能很大（数百万行），我可能需要每分钟计算数十次，所以我想尽可能高效地执行此操作。

**编辑**：实际上，机器是对的，而我在应用 LIMIT 的时间上是错误的。我的查询返回了正确的结果，但是将它们呈现给我的 GUI 让我失望了……这让这个问题变得毫无意义。对不起！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-26T20:26:37.687

实际上... LIMIT 最后应用，在最终的 HAVING 子句之后。所以它不应该给你不正确的结果。但是，由于 LIMIT 是最后应用的，它不会提供更快的查询执行速度，因为在截断结果之前，必须创建一个临时表并按照操作计数的顺序进行排序。另外，请记住按降序排序：

```
SELECT object_id, count(object_id) AS action_count 
FROM `Actions` 
GROUP BY object_id 
ORDER BY action_count DESC
LIMIT 10; 
```

您可以尝试向 object_id 添加索引以进行优化。这样，只需要扫描索引而不是*Actions*表。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-03-03T00:47:12.783

我知道这个线程已有 2 年历史，但 stackflow 仍然认为它是相关的，所以这里是我的 0.02 美元。ORDER BY 子句在计算上非常昂贵，因此在大型表中应避免使用它们。我使用的一个技巧（部分来自 Joe Celko 为 Smarties 编写的 SQL）类似于：

```
SELECT COUNT(*) AS counter, t0.object_id FROM (SELECT COUNT(*), actions.object_id FROM actions GROUP BY id) AS t0, (SELECT COUNT(*), actions.object_id FROM actions GROUP BY id) AS t1 WHERE t0.object_id < t1.object_id  GROUP BY object_id HAVING counter < 15 
```

将为您提供前 15 个编辑过的对象，无需排序。请注意，从 v5 开始，mysql 只会缓存完全重复（包括空格）查询的结果集，因此不会缓存嵌套查询。使用视图可以解决这个问题。

是的，它是三个查询而不是两个，唯一的好处是不必对分组查询进行排序，但如果你有很多组，它会更快。

旁注：查询对于没有排序的中值函数非常方便

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-26T20:20:46.297

怎么样：

```
SELECT * FROM
(
SELECT object_id, count(object_id) AS action_count 
FROM `Actions` 
GROUP BY object_id 
ORDER BY action_count
)
LIMIT 15 
```

此外，如果您对必须包含的最小操作数有一定的衡量标准（例如，前 n 个肯定超过 1000 个），您可以通过添加 HAVING 子句来提高效率：

```
SELECT * FROM
(
SELECT object_id, count(object_id) AS action_count 
FROM `Actions` 
GROUP BY object_id 
HAVING action_count > 1000
ORDER BY action_count
)
LIMIT 15 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-26T20:20:44.673

```
SELECT * FROM (SELECT object_id, count(object_id) AS action_count 
        FROM `Actions` 
        GROUP BY object_id 
        ORDER BY action_count) LIMIT 10; 
```

# c# - 将datagridview导出到excel的问题

> ID：912519
> 
> 赞同：0
> 
> 时间：2009-05-26T20:18:29.593
> 
> 标签：c#, asp.net

我正在尝试将数据网格导出到 Excel。由于某种原因，已知的工作方法不起作用。导出是从用户控件完成的。我的页面 (default.aspx) 使用母版页，并且该页面有一个用户控件，该控件实际上具有我要导出的数据网格。

这是我在 ascx 上的代码：

```
Response.ClearContent();
 Response.AddHeader("content-disposition", "attachment; filename=MyExcelFile.xls");
Response.ContentType = "application/excel";
 StringWriter sw = new StringWriter();
 HtmlTextWriter htw = new HtmlTextWriter(sw);
_gvwResults.RenderControl(htw);
Response.Write(sw.ToString());
Response.End(); 
```

在我的 default.aspx（包含 ascx 的页面）上是以下代码：

```
public override void VerifyRenderingInServerForm(Control control)
{
    /* Confirms that an HtmlForm control is rendered for the specified ASP.NET
       server control at run time. - required to export file */
} 
```

这是我收到的错误：Sys.Webforms.pagerequestmanagerparsererrorexception。无法解析从服务器接收到的消息。此错误的常见原因是通过调用 Response.Write()、响应过滤器、httpmodules 或启用服务器跟踪来修改响应。

有任何想法吗？此代码应该可以工作，但几乎就像响应对象没有被清除一样。想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-29T22:04:51.580

事实证明，由于组合框被 ajaxified，导出没有发生。该事件正在触发，但正如错误消息所述，它是 response.writing 到现有页面上，因此引发错误，这将不允许呈现新文档（在本例中为 xls）。将组合框设置为在页面上进行回发并取消 ajaxifying 后，导出开始工作..

# java - 仅使用 ant 运行 NetBeans 项目

> ID：912522
> 
> 赞同：20
> 
> 时间：2009-05-26T20:19:03.960
> 
> 标签：java, netbeans, ant, sample

我有一个使用 Netbeans 构建的示例代码。

它有一个 build.xml 文件，所以我下载了 ant 并尝试运行它。

我收到此错误消息：

```
...... nbproject\build-impl.xml:76: Platform is not correctly set up 
```

就我所见，这是通过“简单地”下载 Netbeans 并从那里运行示例来解决的，但是......我不想安装它来运行 10 个文件的示例。

是否有使用 Java 运行 Netbeans 项目的解决方法？我必须修改的正确 .properties 文件是什么？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-05-27T01:00:41.130

可以**直接**从 Java/ANT 运行 NetBeans 生成的项目，但您可能需要手动设置一些属性和/或添加 jar 文件的路径。

不幸的是，NetBeans 倾向于使用他们自己的 JAR 文件和仅在文件中定义的引用属性包含 taskdef，这些属性`/nbproject/private/private.properties`通常在您第一次打开 NetBeans 项目时设置或在您在 IDE 中编辑项目时进行修改。

如果您检查，`build-impl.xml`您应该能够找到该属性并得出需要设置的值（OS 平台），然后：

*   在 `/nbproject/private.properties`
*   在父级中添加该属性定义`build.xml`
*   使用调用你的 ant 目标时传入命令行`-DPlatform=Foo`

就个人而言，我喜欢 NetBeans 生成的 ANT 文件和目标的结构，但讨厌它们塞入了多少自定义/专有的东西，这使得没有 NetBeans 就很难运行。

例如：

```
ant -Dplatforms.JDK_1.7.home=/opt/jdk 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-08-29T10:06:52.077

我刚刚用 ant 成功构建了 NetBeans 项目。这些是我必须做的事情：

*   将`<NetBeans-folder>`/java2/ant 复制到“Netbeanless”机器
*   将 nbproject/project.properties 复制到 ant.properties
*   将 ant.properties 中的每个 ${} 表达式替换为它的值
*   添加平台。`<platform-name>`.home=`<path to platform>`
*   添加 libs.CopyLibs.classpath= `<path to nb-ant>`/extra/org-netbeans-modules-java-j2seproject-copylibtask.jar
*   将其他需要的类路径添加到 javac.classpath 中（例如 servlet-api.jar 的路径）
*   `ant -propertyfile ant.properties`

它有效，但不会让我开心。我想找到重用 project.properties 的方法，或者自动将其转换为“已解决”版本（第 3 步）。然后可以自动化构建。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-09-19T19:19:55.460

我刚刚使用我的 NetBeans 7.0 项目完成了这个练习。我能够做的是从我的 Windows 系统上的 .netbeans\7.0 目录中复制我的 build.properties 文件，并为我的构建服务器创建一个 server.properties 文件。这并不难，因为每个开发人员的 build.properties 可能会有所不同，因此需要为服务器提供另一个文件。然后，我整理了一个简单的 server-build.xml 文件，该文件引用了该文件，并且只执行了 init、compile、dist 和 clean 的基本操作。我将这两个文件提交到我的项目目录顶层的 CVS 存储库，因为它们不与其他项目文件冲突，并且在需要更新的情况下用作提醒。现在我可以使用“ant -f server-build.xml”在我的 CI 服务器上构建我的项目，一切正常。

我的整个初始化部分看起来像这样，优先考虑我的服务器路径，但包括来自 NetBeans 项目属性的必要信息。

```
<target name="init">
    <property file="server.properties"/>
    <property file="nbproject/project.properties"/>
</target> 
```

在为我的嵌套项目定义 ant 任务时，我还必须做类似的事情：

```
<target name="compile">
    <ant antfile="${project.MyProj-common}/build.xml" inheritall="false" target="jar">
        <property location="${build.dir}" name="dist.ear.dir"/>
        <property file="server.properties"/>
        <property file="${project.MyProj-common}/nbproject/project.properties"/>
    </ant>
    ...
</target> 
```

我必须将 j2ee.platform.classpath 从 project.properties 复制到我的 server.properties 文件，以确保根据需要解析对 j2ee.server.home 的引用。我没想到必须这样做，但否则类路径是错误的，导致构建失败。

感谢您提供有关此问题的信息，因为它帮助指导我找到此解决方案。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-11-17T18:57:18.397

我刚刚遇到了同样的问题。我希望我可以摆脱 netbeans 去 eclipse 和 maven，就为了这个。

但是[这里有一个很好的链接](http://weblogs.java.net/blog/fabriziogiudici/archive/2006/11/setting_up_netb.html)，可以将 ant 构建的项目从 netbeans 导出到持续集成服务器（或者也可以导出到任何其他 IDE）。

技术进展得很顺利。这是一个摘要：

1.  在 CI 服务器上安装 netbeans（有一个选项可以在没有 gui 的情况下进行，`-silent`在 netbeans 安装程序上使用）
2.  包含`nbproject`在 SVN 中
3.  添加到忽略列表的私人文件夹
4.  在 CI 服务器上创建您自己的私有文件夹
5.  使其指向 CI 服务器的文件夹（模仿用于 CI 的帐户中的私有用户文件夹）
6.  将用户的真实文件夹复制到该文件夹​​并更改每个路径（替换字符串）以指向您在 CI 服务器上安装的 netbeans。

它应该工作。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-10-15T14:50:58.880

我正在使用 Netbeans 6.8，使用 Netbeans 创建的 java 项目可以从 Netbeans 自动生成的构建文件中运行，而 cli 上只有 ant。所有常规目标，如`ant compile`, `ant run`,`ant clean`等都“正常工作”。（如果这很重要，我正在使用 Fedora 13）

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-27T15:36:08.680

只是为了添加到[Mads 的](https://stackoverflow.com/questions/912522/run-netbeans-project-just-with-ant/913513#913513)答案......通常，您需要在目标计算机上至少安装和打开一次 Netbeans。ANT 项目还依赖于 USERDIR/.netbeans/... 目录中的一些设置。这可能会随着 6.5+ 而改变。

这将配置一些基本设置并将类路径定义为 netbeans jar。如果自上次在 Netbeans 中打开项目以来，您的依赖项（即库）或项目正在从不同的目录运行，您将需要调整 private.properties 文件中的一些设置，如 Mads 所述。

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2017-06-27T20:19:00.137

你可以使用这个 repo 只是为了那个[https://github.com/albfan/ant-netbeans](https://github.com/albfan/ant-netbeans)

它克服了 netbeans 包装的 ant 配置的所有奇怪之处，因此您只需要：

编译：

```
$ ant.sh compile 
```

跑步：

```
$ ant.sh run 
```

到任何东西（自动完成）：

```
$ ant.sh <tab><tab> 
```

# python - 如何在 Python 中将大量变量传入和传出函数？

> ID：912526
> 
> 赞同：5
> 
> 时间：2009-05-26T20:20:05.080
> 
> 标签：python, pass-by-reference, pass-by-value

我做科学编程，经常想给用户显示提示和变量对，让他们编辑变量，然后用新变量进行计算。我经常这样做，所以我编写了一个 wxPython 类来将此代码移出主程序。您为每个变量设置一个列表，其中包含变量的类型（字符串、浮点数、整数）、提示符和变量的当前值。然后将所有这些列表放在一个大列表中，我的实用程序会创建一个格式整齐的 wxPython 面板，其中包含提示和可以编辑的当前值。

当我开始时，我只有几个变量，所以我会写出每个变量。

```
s='this is a string'; i=1; f=3.14
my_list=[ ['s','your string here',s], ['i','your int here',i], ['f','your float here'],]
input_panel = Input(my_list)

 # the rest of the window is created, the input_panel is added to the window, the user is
 # allowed to make  choices, and control returns when the user hits the calculate button

s,i,f = input_panel.results()     # the .results() function returns the values in a list 
```

现在我想将这个例程用于很多变量（10-30），这种方法正在崩溃。我可以使用 list.append() 语句在多行上创建函数的输入列表。但是，当代码从函数返回时，我得到了这个需要解压缩到正确变量中的巨大列表。这很难管理，看起来很容易让输入列表和输出列表不同步。更糟糕的是，它看起来很笨拙。

将大量变量传递给带有额外信息的 Python 函数以便可以编辑它们，然后取回变量以便我可以在程序的其余部分中使用它们的最佳方法是什么？

如果我可以通过引用将变量传递给函数，那么用户可以更改或不更改它们，一旦程序从函数返回，我将使用这些值。我只需要在多行上构建输入列表，并且输入列表不会与输出列表不同步。但是 Python 不允许这样做。

我应该将大列表分解成较小的列表，然后组合成大列表以传入和传出函数吗？或者这只是增加了更多出错的地方？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-05-26T20:25:40.000

最简单的做法是创建一个类。该类将具有属性，而不是处理变量列表。然后，您只需使用该类的单个实例。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-05-26T20:29:08.743

我想到了两个不错的选择。

第一种是使用字典将所有变量收集在一个地方：

```
d = {}
d['var1'] = [1,2,3]
d['var2'] = 'asdf'
foo(d) 
```

第二种是使用一个类来捆绑所有参数。这可能很简单：

```
class Foo(object):
    pass
f = Foo()
f.var1 = [1,2,3]
f.var2 = 'asdf'
foo(f) 
```

在这种情况下，我更喜欢类而不是字典，因为您最终可以为类提供定义以使其使用更清晰，或者提供处理一些打包和解包工作的方法。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-26T20:29:25.403

对我来说，理想的解决方案是使用这样的类：

```
>>> class Vars(object):
...     def __init__(self, **argd):
...             self.__dict__.update(argd)
...
>>> x = Vars(x=1, y=2)
>>> x.x
1
>>> x.y
2 
```

您还可以构建一个字典并像这样传递它：

```
>>> some_dict = {'x' : 1, 'y' : 2}
>>> #the two stars below mean to pass the dict as keyword arguments
>>> x = Vars(**some_dict)  
>>> x.x
1
>>> x.y
2 
```

然后，您可以在将数据传递给函数时根据需要获取或更改数据：

```
>>> def foo(some_vars):
...     some_vars.z = 3 #note that we're creating the member z
...
>>> foo(x)
>>> x.z
3 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-26T20:27:47.607

> 如果我可以通过引用将变量传递给函数，那么用户可以更改或不更改它们，一旦程序从函数返回，我将使用这些值。

您可以通过传递 a 获得与“通过引用传递”大致相同的效果`dict`（或者为了语法方便 a `Bunch`，请参阅[http://code.activestate.com/recipes/52308/](http://code.activestate.com/recipes/52308/)）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-26T20:26:20.137

如果您有一组有限的这些案例，您可以为每个案例编写特定的包装函数。每个包装器都将完成构建和解包列表的工作，并将其传递给内部函数。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-27T01:18:09.487

1.  我建议使用字典或类来累积有关变量的所有详细信息
    *   价值
    *   提示文字
2.  存储您希望它们显示的顺序的列表
3.  然后使用良好的旧迭代来准备输入并收集输出

这样，您只会一次又一次地修改一小部分可管理的代码。当然，如果您喜欢使用类，您应该将所有这些封装到一个类中。

```
"""Store all variables
"""
vars = {}
"""Store the order of display
"""
order = []

"""Define a function that will store details and order of the variable definitions
"""
def makeVar(parent, order, name, value, prompt):
    parent[name] = dict(zip(('value', 'prompt'), (value, prompt)))
    order.append(name)

"""Create your variable definitions in order
"""
makeVar(vars, order, 's', 'this is a string', 'your string here')
makeVar(vars, order, 'i', 1, 'your int here')
makeVar(vars, order, 'f', 3.14, 'your float here')

"""Use a list comprehension to prepare your input
"""
my_list = [[name, vars[name]['prompt'], vars[name]['value']] for name in order]
input_panel = Input(my_list)

out_list = input_panel.results();
"""Collect your output
"""
for i in range(0, len(order)):
    vars[order[i]]['value'] = out_list[i]; 
```

# c# - Internet Explorer 中的下拉列表宽度

> ID：912529
> 
> 赞同：1
> 
> 时间：2009-05-26T20:20:16.127
> 
> 标签：c#, asp.net, internet-explorer

我有一个内容相当广泛的 ASP.NET DropDownList，而由于站点上的空间限制，封闭列表的宽度必须非常小。这就是为什么我需要能够在列表关闭时为其设置特定宽度，但希望它在打开时与内容一样宽。

默认情况下，Firefox 在打开时会自动使 DropDownLists 与其内容一样宽。另一方面，Internet Explorer 没有。

有什么方法可以告诉 IE 在打开时使打开的 DDL 与内容一样宽，但在关闭时使其尺寸更小？最好不使用javascript。

编辑：好的，我在第一篇文章中还不够清楚。重点是打开*时*。*我想要列表关闭时的特定宽度，但我希望它与打开时*的内容一样宽。正如我所说，Firefox 会这样做，而 IE 不会。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-26T20:35:24.300

我建议不要使用下拉列表，而是像这样对 JavaScript 更友好的列表

[http://jquery.sanchezsalvador.com/samples/example.htm](http://jquery.sanchezsalvador.com/samples/example.htm)

这将允许您的内容扩展超过选择的宽度。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-26T20:24:53.510

IE 默认与内容一样宽。

设置一个 CSSClass 并给它一个指定的宽度，你就可以改变它。

你也可以去

```
select{
  width:42px;
} 
```

**编辑**：从你现在所说的来看，我觉得你需要做一些 javascript，因为 IE 不会处理。尝试查看 jquery

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-26T20:24:12.280

默认情况下，IE 将使其与内容一样宽。如果您在 DDL 上指定宽度或通过在父容器中的某处放置宽度来约束 DDL，则会更改此行为。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-26T20:24:38.067

我会说你最好的选择是找出最大宽度，并将其设置在下拉列表中。这样，无论内容如何，​​您都可以获得一致的外观，并且您还可以绕过这个问题。

# javascript - How to: jQuery cycle lite plugin (image rotator plugin) 手动按ID设置图片

> ID：912531
> 
> 赞同：0
> 
> 时间：2009-05-26T20:20:33.643
> 
> 标签：javascript, jquery, jquery-ui, jquery-plugins, image-rotation

您好，我正在使用[jQuery cycle lite 插件（图像旋转器插件）](http://malsup.com/jquery/cycle/lite/)，我想使用中间示例（单击触发器），但我不想设置上一个和下一个按钮的 ID，而是手动设置图像 ID。

我的目标是在页面底部有一个拇指列表，当拇指单击时，将大图像设置在“幻灯片”div 中。

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-26T20:38:51.050

如果您升级到[完整的循环插件](http://malsup.com/jquery/cycle/)，您[将免费获得此功能](http://malsup.com/jquery/cycle/pager2.html)

# git - 自定义 git diff 忽略一些冲突

> ID：912534
> 
> 赞同：4
> 
> 时间：2009-05-26T20:21:01.677
> 
> 标签：git, merge, diff

我开始测试从 cvs 转移到 git，我的所有测试都有问题。

我们维护一个 FreeBSD 源代码的自定义副本，因此在 cvs 中，当发布新的 FreeBSD 版本时，我们会执行以下操作：

1.  导入新的 freebsd src 作为供应商分支
2.  合并 HEAD 上的更改

我试着用 git 做同样的事情，它工作了，但几乎所有的 FreeBSD 文件都有一个这样的自定义 ID：

`$FreeBSD: release/7.0.0/COPYRIGHT 175036 2008-01-01 09:36:30Z imp $`

这些行总是在变化，并且由于它们存储在 svn 存储库（release/7.0.0、7.1.0、7.2.0）中的位置，git 会产生很多需要手动修复的冲突。

我想知道是否有一种方法可以将 git 配置为忽略这些行上的差异并使用新的而不询问。

我可以使用 diff 命令忽略这些行，如下所示：

`diff -q -I'[$]FreeBSD:.*$'`

先感谢您。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-26T20:34:40.947

由于这些更改，我不确定您是否可以在合并期间避免冲突。

但是，您可以做的是一个小脚本，它能够列出要合并的所有文件，`diff -q -I'[$]FreeBSD:.*$'`对每个文件执行您的操作，对于那些没有差异的文件，执行

```
git checkout --theirs theFreeBSDFile 
```

然后合并的恢复将能够完成冲突的合并。

' `git checkout --theirs`' 签出阶段 #3（他们的）以获取未合并的路径。

实际上，a[`git mergetool`](https://stackoverflow.com/questions/585844/merging-with-git-mergetool)非常适合这项工作：就在涉及 FreeBSD 文件的合并之前，将您的 mergetool 实用程序设置为该脚本，如问题中所述[git-merge 是否可以忽略行尾差异？](https://stackoverflow.com/questions/861995/is-it-possible-for-git-merge-to-ignore-line-ending-differences/862920#862920).
如果您将 mergetool 配置设置为信任该脚本的退出代码，则除 FreeBSD 自定义行之外不显示任何差异的任何文件都将是 ' `git checkout --theirs`' 并且据报道“合并”，另一个不会被同一脚本合并。
最后，如果简历仍然显示冲突文件，请将您的合并工具重置为您最喜欢的 difftool，并解决剩余的冲突文件。

# oracle - 使用 Oracle 10 监控哪些语句更新（以及何时）某个表行

> ID：912538
> 
> 赞同：0
> 
> 时间：2009-05-26T20:21:59.757
> 
> 标签：oracle, row, monitoring

我正在使用（必须）一个设计糟糕的 Oracle(10) DB，我没有管理员权限（尽管我可以在我的方案中创建表、触发器等）。

现在我遇到了一个问题：这个数据库连接了几个用户/程序。我必须找出谁更新了某一行，何时更新，如果可能的话：**用什么样的语句**。可能吗？

提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-26T20:42:39.107

如果您具有启用审核的管理员权限，则执行此操作会更容易。如果没有审计的能力，您就只能使用触发器来处理插入/更新/删除的日志记录。在您的情况下，由于您只对更新感兴趣，因此您可以在表上放置一个触发器以在更新后触发，该触发器将记录到另一个表的更改内容、更改内容、更改对象、从何处以及在哪一天更改。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-26T20:26:35.957

我会为您正在使用的表创建一个日志表。它将向您显示操作类型和 oracle 用户……以及一堆其他数据（如果您需要）。

# django - Django 对象多个 exclude()

> ID：912540
> 
> 赞同：28
> 
> 时间：2009-05-26T20:22:06.900
> 
> 标签：django, django-queryset

有没有办法进行查询并排除事物列表，而不是多次调用排除？

* * *

## 回答 #1

> 赞同：51
> 
> 时间：2009-05-26T21:28:09.623

根据您对 Ned 的回复，您似乎只想排除标签列表。所以你可以只使用`in`过滤器：

```
names_to_exclude = [o.name for o in objects_to_exclude] 
Foo.objects.exclude(name__in=names_to_exclude) 
```

这样做是你想要的吗？

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-05-26T20:27:36.437

多次调用 exclude 有什么问题？查询是惰性的，除非您尝试从中提取数据，否则不会发生任何事情，因此多次使用 .exclude() 没有任何缺点。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2017-10-10T07:23:53.543

你也可以试试这个。

`exclude_list = ['A', 'B', 'C'] qs = Foo.objects.exclude(items__in=exclude_list)`

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-05-26T21:06:50.773

[你可以用Q 对象](http://docs.djangoproject.com/en/dev/topics/db/queries/#complex-lookups-with-q-objects)很容易地做到这一点：

```
from django.db.models import Q

excludes = None
for tag in ignored_tags:
    q = Q(tag=tag)
    excludes = (excludes and (excludes | q)) or q # makes sure excludes is set properly
set_minus_excluded = Foo.objects.exclude(excludes) 
```

您还应该能够使用 exclude() 动态执行此操作：

```
qs = Foo.objects.all()
for tag in ignored_tags:
    qs = qs.exclude(tag=tag) 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2017-01-20T06:47:00.317

为了改进 Daniel Roseman 的回答，我认为最好直接从查询集中获取所需的值，而不是在大型数据集上可能很昂贵的 for 循环，即

```
names_to_exclude = objects_to_exclude.values_list('name')
Foo.objects.exclude(name__in=names_to_exclude) 
```

# nhibernate - 如何使 Nhibernate 生成带有文本字段而不是 nvarchar 的表（255）

> ID：912541
> 
> 赞同：5
> 
> 时间：2009-05-26T20:22:19.333
> 
> 标签：nhibernate, nhibernate-mapping

我试图让 NHibernate 生成我的模式/SQL 2008，并使用下面的映射，它一直想要创建一个 nvarchar(255) 列而不是文本......有什么想法吗？

```
 <property name="AnnouncementText" column="AnnouncementText" type="StringClob">
  <column name="AnnouncementText" sql-type="NTEXT"/>
</property> 
```

谢谢！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-26T21:15:07.543

问题是两次指定列的名称......一旦我把它和它的属性元素的长度完美地工作

```
 <property name="AnnouncementText" type="StringClob">
  <column name="AnnouncementText" sql-type="text"/>
</property> 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-05-26T20:33:20.640

我已经习惯了 SQL Server 2005 和它使用的方言，但我认为你可以做类似的事情。由于 nvarchar(n) 允许 n 最大为 4000，因此高于此的值将使用 nvarchar(max)。

我*认为*SQL Server 2000 听起来像是您正在使用的，一旦您达到限制，它就会执行类似的操作。如果我正确阅读了 NHibernate 代码（NHibernate.Dialect.MsSql2000Dialect..ctor()），一旦传递 0xFA0 = 4000 个字符，就会得到 ntext。

```
<property name="AnnouncementText" column="AnnouncementText" type="string" length="10000"/> 
```

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2009-05-26T21:02:46.367

这根本无济于事，但我记得过去的美好时光；-)...

```
create table YourTable
(
    ...
    AnnouncementText     text null
    ...

) 
```

# java - 如何在 Hibernate 中使用 mappedBy 更新集合类型关系？

> ID：912542
> 
> 赞同：1
> 
> 时间：2009-05-26T20:22:27.197
> 
> 标签：java, hibernate, session-cache

我有两个相关的实体，比如说

```
@Entity
public class Book {
    @ManyToOne
    Shelf shelf;
}

@Entity
public class Shelf {
    @OneToMany(mappedBy="shelf")
    Set<Book> books;
} 
```

如果我取一个空书架（没有书），创建一本新书并将其持久保存到书架上，然后再次获取该书架，它的藏书是空的。当我使用调试日志运行它时，我看到 Hibernate 没有第二次搜索书架，它只是从会话缓存中返回它，它不知道它的书籍集合已更新。

我怎样才能摆脱效果并获得货架的更新状态？

谢谢，
阿尔特姆。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-08-24T13:52:34.207

似乎您必须在单个会话（事务）的范围内手动维护它。@Cascade 和 EAGER 都不会影响会话缓存

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-27T15:53:41.390

尝试为 Shelf 中的书籍设置获取类型 EAGER：

```
@Entity
public class Shelf {
    @OneToMany(mappedBy="shelf",fetch=FetchType.EAGER)
    Set<Book> books;
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-12T05:35:16.840

@Cascade 是您要找的吗？

# java - 应用挂起调用 DefaultCellEditor 构造函数

> ID：912547
> 
> 赞同：0
> 
> 时间：2009-05-26T20:23:45.197
> 
> 标签：java, user-interface

我可以控制在 Eclipse 上构建的一小部分应用程序，但在创建 DefaultCellEditor 时遇到问题。该代码实际上使用了 DefaultCellEditor 的子类，但我可以使用 DefaultCellEditor 重新创建问题，所以这就是我要问的问题，希望它能解决实际类的问题。我已经在 J​​DK 1.5 和 1.6 上都试过了，并且在两者中都得到了相同的行为。

调用 DefaultCellEditor 的构造函数时会出现问题：

```
log.debug("Trying construction.");
currentCellEditor = new DefaultCellEditor(new JTextField());
log.debug("Constructed OK."); 
```

当这段代码运行时，可能有 20% 的时间，应用程序挂起，并且 CPU 被固定在 100% - 看起来某处有一个无限循环，但我不知道在哪里。打印第一行日志，但不打印第二行。

我尝试复制 DefaultCellEditor 类并在其中插入 System.out.println 语句，看看是否能找出问题发生的位置；在代码正确运行期间，我的所有调试语句都被打印出来，但是当它没有正确运行时，没有任何语句被打印出来，几乎就像在调用构造函数之前发生挂起一样。任何想法可能会发生什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-26T21:24:16.013

关于这个问题的两条评论都很有帮助。我能够使用线程转储并找出导致循环的原因（我最终使用了[StackTrace](http://www.adaptj.com/main/stacktrace)）。我的另一个问题是，当我早些时候在 EDT 上时，当这段代码实际运行时，它不再在 EDT 上 - 所以现在我必须追踪它，但一些早期测试表明将它放在 EDT 上可能解决问题。谢谢！

# iphone - 如何动态创建类的实例？

> ID：912553
> 
> 赞同：3
> 
> 时间：2009-05-26T20:24:31.780
> 
> 标签：iphone, objective-c, cocoa-touch, uikit

例子：

我有 10 个视图控制器，它们都以相同的方式分配和初始化：

```
UIViewController *controller = [[MyViewController alloc] initWithNib]; 
```

（注意 -initWithNib 是 UIViewController 子类的自定义方法）

下一个视图控制器类是 OtherViewController，依此类推。我想懒洋洋地加载视图控制器，就在我需要它们的时候。但要做到这一点，我需要某种“数组”来为给定索引提供相应的类，以便我可以初始化它。

我最终创建了一个带有大开关语句的方法，它只会为每个视图控制器分别进行讨厌的分配和初始化。我对此不满意。如果我可以将适当的类分配给变量，然后在 switch 语句的末尾分配并从变量初始化该类，那会好得多。

有没有办法做到这一点？

编辑：我找到了一个功能

```
id class_createInstance(Class cls, size_t extraBytes) 
```

每个类似乎都有一个属性“类”。但我不能将它分配给实例变量。这不起作用：

```
Class cls = [UIImage class];
cls *image = [cls imageNamed:@"avatar.png"]; 
```

第一行编译。但是第二个给出了一个错误：“图像未声明”。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-05-26T20:39:11.657

如果您在编译时知道类的名称，则可以将类分配给 Class 变量。例如：

```
static Class factory[2];

factory[0] = [MyViewController1 class];
factory[1] = [MyViewController2 class];
... 
```

然后你可以有 (classid 将是一个在编译时已知的常量，它将映射到所需的类：

```
-(UIViewController*)createViewController:(int)classid
{
    return [[factory[classid] alloc] init];
} 
```

假设该方法是在名为 MyFactory 的类中定义的，那么您可以执行以下操作：

```
MyFactory * fac = [[MyFactory alloc] init];
UIViewController * v1 = [fac createViewController: 0]; // typed
id v2 = [fac createViewController: 1]; // untyped 
```

如果您没有类的编译时名称，您可以简单地执行以下操作：

```
#include <objc/objc-runtime.h>

id object = [[NSClassFromString(@"TheClassName") alloc] init]; 
```

由于您最初的问题涉及一组 UIViewControllers，因此没有理由使用后一种方法失去类型安全性。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-05-26T20:34:09.467

你想使用反射：

```
 id controller = class_createInstance(NSClassFromString(@"your class name"), 0/*extra bytes*/); 
```

[Objective-C 运行时参考](http://developer.apple.com/documentation/Cocoa/Reference/ObjCRuntimeRef/Reference/reference.html#//apple_ref/c/func/class_createInstance)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-15T00:45:29.570

我上个月在博客上写过这个：http: [//igotosoft.blogspot.com/2009/05/dynamically-creating-viewscontrollers.html](http://igotosoft.blogspot.com/2009/05/dynamically-creating-viewscontrollers.html) 本质上，它涉及一个我称为 ClassConstructor 的新类，它采用类名、init 方法名, 和逗号分隔的参数。当您需要创建该类的实例时，只需使用您的 [myClassConstructor create];

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-26T20:29:11.817

你想要的是反射。虽然没有objective-c的概念 - 但该术语可能会帮助您更好地搜索您的答案。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-26T20:34:46.673

Objective C Reference 也将是寻找调用的好地方。尝试搜索 Objective-C 2.0 运行时参考，因为我无法添加链接

# asp.net - 我们如何改进我们的部署和构建系统？

> ID：912560
> 
> 赞同：1
> 
> 时间：2009-05-26T20:26:18.860
> 
> 标签：asp.net, tfs, build-process

我们有 4 种不同的环境：

*   分期
*   开发
*   用户接受
*   居住

我们使用 TFS，拉下最新的代码，然后把代码拿走。
当他们完成一项功能时，开发人员会单独将他们的更改上传到 Staging。如果站点是稳定的（由非常松散的测试确定），我们将更改上传到 Dev，然后是 UserAcceptance，然后再上线。

我们根本没有在源代码控制中使用构建/标签。

我应该告诉管理层什么？据我所知，他们似乎不认为有问题。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-26T20:46:42.420

如果这对您有好处，您可以成为您公司的[持续集成](http://www.martinfowler.com/articles/continuousIntegration.html)冠军。[您可以对使用 TFS 的 CI](http://msdn.microsoft.com/en-us/library/ms364045.aspx)的良好流程进行一些研究，编写一个建议的解决方案，将其传播给您的开发人员和直接经理，根据他们的意见对其进行修改并将其推销给管理层。或者你可以坐在那里什么也不做。

我从事管理工作很长时间了。我总是很欣赏那些发现问题并提出深思熟虑的解决方案的人。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-26T20:38:40.753

谁的管理？他们离你有多远？

即，如果您只是普通开发人员，而您的经理是高级开发人员，则另找工作。如果您是高级开发人员，而您的经理是 CIO 类型，即实际经营业务……那么改变它是您的工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-26T20:34:03.647

告诉他们，如果您使用他们花费大量资金购买的非常昂贵软件的关键功能，那么知道什么时候推出的代码将是微不足道的。这意味着如果引入了一个通过用户验收测试的细微错误，则只需区分两个版本以找出发生了什么变化。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-26T20:39:18.380

使用 TAGS 最重要的部分之一是您可以回滚到特定时间点。将其视为图像备份。如果部署了不好的东西，您可以放心地假设您可以“回滚”回以前的工作版本。

此外，开发人员可以快速获取 TAG（开发、产品或其他）并部署到他们的开发 PC 上……这是我一直用来调试生产问题的功能。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-27T14:25:33.520

我至少看到两个大问题：1）开发人员自己加载更改。所有更改都应来自源代码控制。您是否遇到过有人进行了更改，但从未进入源代码控制，然后在下一次部署时被意外删除？花了多少时间（金钱）试图弄清楚那里出了什么问题？

2）缺乏明确的推广模式。看起来你们是在环境之间移动变化而不是“构建”。关键区别在于，如果两个更改由于它们的交互方式而在 UAT 中运行良好，那么如果只有一个更改被提升到生产环境，它可能会在那里中断。促进一致的代码——无论是通过标记它还是通过压缩整个 Web 应用程序并提升 zip 文件——应该会导致更少的问题。

我从事持续集成和部署解决方案[AnthillPro](http://www.anthillpro.com)的工作。我们如何使用 TFS 解决这个问题是根据日期时间戳（当有人按下“交付到舞台”按钮时）从 TFS 检索新代码。

这为您提供了大多数（全部？）使用标签的可追溯性，而无需实际标记事物。系统只记录时间戳，并且通过测试环境的每次推送代码都与已知的代码快照相关联。我们也有客户在构建过程中放置​​标签。正如第一张海报提到的那样——CI 是一件好事——更少的工作，更多的可追溯性。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-26T21:23:25.420

*有*什么问题？正如您所说，您无法判断管理层是否看到了问题。也许他们没有！告诉他们您认为当前存在的问题以及解决问题的建议。问题的性质必须是“我们当前的流程失败了十分之三，而实施这个新流程会将这些失败减少到十分之一”。

管理层需要看到以下方面的改进：降低成本、增加利润、减少时间、减少资源使用。“因为它是广泛使用的最佳实践”是不够的。也不是，“因为它让我的工作更轻松”。

管理层通常没有意识到问题，因为每个人都不敢说什么，或者认为他们不可能看不到问题。但是你的世界和他们的世界不同。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-26T20:49:40.777

因此，您需要有人告诉其他开发人员，他们必须在每次构建完成时标记他们的代码并增加版本计数器。为什么你不能这样做？

您还需要告诉管理层您认为已完成的测试水平还不够。这对于一个组织来说并不是一个独特的问题，他们可能会说他们已经知道了。与其等待一个重大问题的到来，不如提及它并没有什么坏处。

至于进行构建或自动构建过程的个人，这取决于您是否真的需要它，这取决于有多少开发人员以及您进行构建的频率。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-28T23:13:25.217

如果您已经拥有 TFS，那么您就快到了。

我所在的地方仅将 TFS 用于源代码控制。我们对 Dev/Stage/Prod 有类似的设置。我自己安装了构建服务器。完成后，我为我的一个项目添加了自动部署到 dev 的功能，并告诉了其他几个人。最初的接待是不冷不热的。

后来我添加了 TFS Deployer 并将其设置为自动将好的开发构建部署到阶段。

在这段时间里，主要的开发者群体一直在争论“你在部署到阶段或生产之前得到了最新的吗？” 问题; 我的东西工作顺利。相信我，管理层和其他开发人员注意到了。

现在（6 个月后），我们有一个书面规则，你甚至不能在 Visual Studio 中使用 Publish 命令。一切都经过 CI 构建和部署。当迁移到 prod 时，我们的生产组会从构建服务器中提取适当的副本。我什至对我们的 QA 小组进行了如何进行 Web 测试的培训，我们正在慢慢地将自动化测试集成到整个 shebang 中。

这次闲逛的重点是它花了一段时间。但更重要的是，这只是因为我愿意跟着它跑并展示结果。

我建议你这样做。开始使用它，然后展示让其他人参与其中的好处。

# c# - WCF Web 服务中的安全上下文令牌无效或过期

> ID：912580
> 
> 赞同：6
> 
> 时间：2009-05-26T20:29:11.943
> 
> 标签：c#, wcf, iis, active-directory, wcf-security

全部，

我有一个使用服务帐户（VM，Windows 2003 SP2）在 IIS 下托管的 WCF Web 服务（我们称为服务“B”）。该服务公开了一个使用默认值的 WSHttpBinding 的端点，除了 maxReceivedMessageSize、maxBufferPoolSize、maxBufferSize 和一些已增加的超时。

Web 服务已使用 Visual Studio 负载测试框架对大约 800 个并发用户进行了负载测试，并成功通过了所有测试，没有引发异常。单元测试中的代理是从配置中创建的。

有一个 sharepoint 应用程序使用 Office Sharepoint Server Search 服务来调用 Web 服务“A”和“B”。应用程序将从服务“A”获取数据以创建将发送到服务“B”的请求。来自服务“B”的响应被编入索引以供搜索。代理是使用 ChannelFactory 以编程方式创建的。

当服务“A”花费不到 10 分钟时，对服务“B”的调用成功。但是，当服务“A”需要更多时间（约 20 分钟）时，对服务“B”的调用会引发以下异常：

异常消息：从另一方收到不安全或不正确安全的故障。有关故障代码和详细信息，请参见内部 FaultException 内部异常消息：无法处理消息。这很可能是因为操作 'namespace/OperationName' 不正确，或者因为消息包含无效或过期的安全上下文令牌，或者因为绑定之间存在不匹配。如果服务由于不活动而中止通道，则安全上下文令牌将无效。为了防止服务过早中止空闲会话，请增加服务端点绑定的接收超时。

绑定设置相同，客户端服务器和 Web 服务服务器的时间与 Windows 时间服务同步，时区相同。

当我查看托管 Web 服务“B”的服务器时，我可以看到正在记录以下安全错误：

资料来源：安全

类别：登录/注销

事件编号：537

用户 NT AUTHORITY\SYSTEM

登录失败：

原因：登录时出错

登录类型：3

登录过程：Kerberos

身份验证包：Kerberos

状态码：0xC000006D

子状态码：0xC0000133

在网上看了一些博客后，状态码表示STATUS_LOGON_FAILURE，子状态码表示STATUS_TIME_DIFFERENCE_AT_DC。但我已经检查了服务器和客户端时钟，它们是同步的。

我还注意到安全令牌似乎缓存在客户端服务器的某个位置，因为它们有另一个进程使用相同的服务帐户调用 Web 服务“B”并在第一次调用时成功获取数据。然后他们开始更新办公室共享点服务器搜索服务索引的过程，但它失败了。然后，如果他们再次调用第一个进程，它也会失败。

有没有人遇到过此类问题或有任何想法？

问候，

——达米安

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-07-02T19:07:15.533

10 分钟是默认接收超时。如果您的代理闲置超过 10 分钟，则该代理的安全会话将被服务器中止。启用日志记录，您将在服务器的诊断日志中看到这一点。您报告的错误消息适合此行为。在系统诊断文件中搜索“SessionIdleManager”。如果你找到它，上面就是你的问题。

试一试，为客户端和服务器设置建立安全上下文=“假”。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2010-06-03T17:02:33.263

不要在 using 语句中调用服务操作。而是使用诸如...的模式

```
client = new ServiceClient("Ws<binding>")
try
{
    client.Operation(x,y);
    client.Close();
}
catch ()
{
    client.Abort();
} 
```

我不明白为什么会这样，但我猜当代理超出 using 语句的范围时，不会调用 Close。然后服务等待直到 receiveTimeout（在绑定上）过期，然后中止连接，导致后续调用失败。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-27T07:50:43.567

我相信这里发生的是您的频道正在超时（正如您所怀疑的那样）。

如果我理解正确，在您调用操作之前，不是对服务 A 的调用超时，*而是***对**服务**B的调用。**

 *我猜您是在调用服务**A***之前*创建频道，而不是*及时*（即在调用服务**B**之前）。您应该在使用它之前创建通道（代理，服务客户端），例如：

 *****```
AResponse aResp = null;
BResponse bResp = null;
using (ServiceAProxy proxyA = new ServiceAProxy())
{
   aResp = proxyA.DoServiceAWork();
   using (ServiceBProxy proxyB = new ServiceBProxy())
   {
      bResp = proxyB.DoOtherork(aResp);
   }
}
return bResp; 
```

但是，我相信，一旦您解决了*该*问题（服务 B 超时），您将意识到共享点应用程序的代理（称为服务**A**）将超时。为了解决这个问题，您可能希望将服务模型从请求-响应更改为发布-订阅模型。

对于长期运行的服务，您将希望您的 sharepoint 应用程序订阅服务 A，并让服务 A 在准备就绪时发布其结果 - 无论需要多长时间。

Juval Lowey 的 Programming WCF Services (O'Reilly) 有一个很好的解释，IDesign（Juval 的公司）发布[了一套很棒的 WCF 编码标准](http://idesign.net/idesign/download/IDesign%20WCF%20Coding%20Standard.zip)，以及一个很棒的[Publish-Subscribe Framework](http://idesign.net/idesign/DesktopDefault.aspx?tabindex=-1&tabid=19&download=225)的代码。

希望这会有所帮助，阿萨夫。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-09-08T01:59:01.570

我刚才实际上是通过做一些愚蠢的事情触发了这个错误。我有一个修改系统日期的单元测试，以测试一些基于时间的功能。而且我猜我创建上下文和调用我的方法之间的明显时间差（由于系统日期的更改）导致某些内容过期。

# objective-c - 委托、出口和鼠标事件的类设计

> ID：912583
> 
> 赞同：0
> 
> 时间：2009-05-26T20:29:37.400
> 
> 标签：objective-c, cocoa

这是一个简化：

我有一个带有几个按钮的应用程序。如果是第一次启动应用程序，我想做一些特别的事情。在作为 NSApp 委托的 AppController 类中，我使用委托方法 -applicationDidFinishLaunching: 来执行测试。在我检测到这是第一次之后，我首先想访问一些 IBOutlets。然后，我希望能够为每个按钮获取鼠标事件，以便我可以做其他事情。

我想不通想要做的类。我想为第一次启动创建一个新类（FirstLaunch），但我不确定从 AppDelegate 调用什么。另外，为了获得鼠标事件，我不应该是按钮的子类，考虑到我有多个按钮，我很困惑。我可能可以一个一个地解决这些问题，但总的来说，它们让我感到困惑。

分解后，我需要访问和操作我在 IB 中设置的 IBOutlets，确定何时单击按钮（以及单击了哪个按钮）。我希望能够从另一个班级做到这一点，以免弄乱 AppDelegate。

谢谢您的帮助！

更清楚地说，我实际上想要做的是使用 Matt Gemmel 的 MAAttachedWindow 通过按钮放置一个帮助气泡。单击按钮时，气泡消失，另一个气泡被放在其他地方。气泡将附加到主窗口中的控件。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-26T21:48:26.167

我猜你想在第一次启动时显示一些额外的用户界面？如果它是一个单独的窗口，我建议创建一个`NSWindowController`. 为项目的首次运行用户界面添加一个新的 NIB 文件，并将 File's Owner 对象的类更改为`FirstLaunch`. 按住 Control 键将文件所有者委托的电线拖到窗口上以将其与`window`插座连接。

您可以通过向类添加实例变量来创建`IBOutlet`s。如果您的应用程序只能在 Leopard 或更高版本上运行，最好像这样声明您的 outlet：

```
@interface FirstLaunch : NSWindowController {
    NSTextField *myTextField;
}

@property (nonatomic, retain) IBOutlet NSTextField *myTextField;

@end 
```

在 Interface Builder 中，您将从 File's Owner 控制并拖动一条线到控件上，以将其与该插座相关联。确保`IBOutlet`在类的`dealloc`方法中释放对每个方法的引用（如果您不使用垃圾收集），否则您的应用程序将泄漏内存。

按钮在单击时会发送操作消息，因此您需要为按钮提供调用方法。你可以通过声明一个带有这样签名的方法来做到这一点：

```
- (IBAction)myButtonClicked:(id)sender; 
```

在 Interface Builder 中，您将从按钮控制拖拽一条线到您的窗口控制器并选择`myButtonClicked:`方法。

为了使所有这些工作，您需要创建窗口控制器的实例并告诉它在运行时加载 NIB 文件。因此，在您的`AppDelegate`课堂上，当您确定这是第一次发布时，您将执行以下操作：

```
FirstLaunch *firstLaunchController = [[FirstLaunch alloc] initWithWindowNibName:@"nameOfNibFile"];
[firstLaunchController show:self]; 
```

您可能希望将对窗口控制器的引用保留在实例变量中，而不是像我在这里所做的那样的局部变量。而且，根据您的应用程序，将其显示为工作表可能更有意义。但是，一旦您做到了这一点，您将能够自己弄清楚如何做到这一点。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-26T23:18:47.467

> 然后，我希望能够为每个按钮获取鼠标事件，以便我可以做其他事情。

不用担心鼠标。甚至可能没有*鼠标*（想想曾经流行的平板电脑-Mac 谣言）。

> 我想为第一次启动创建一个新类（FirstLaunch），但我不确定从 AppDelegate 调用什么。

你在这里制定自己的方法。你可能会把它变成一个单例*；然后，您将实现一个名为 的方法`runFirstLaunchPanel:`，这将是一个操作方法（稍后会详细介绍）：

```
- (IBAction) runFirstLaunchPanel:(id)sender; 
```

实例化 nib 中的对象，然后，从您的应用程序委托中，`nil`以发送者的身份调用操作方法。

将对象放入您的 nib 并使该方法成为操作方法的原因是，这样可以很容易地将菜单项连接到它，以便用户可以在以后重新运行首次启动面板。（例如，如果它是“起点”窗口，您可以将“新建”菜单项连接到此操作而不是默认操作。）

*是的，我看过关于单身人士的文章，我同意他们的看法。在这种情况下，没关系。

> 此外，要获取鼠标事件，

这是错误的思考方式。您需要做的是设置您的按钮以*向您的控制器发送消息，*以使控制器（可能`AppDelegate`）*执行某些操作*。您希望按钮发送的消息是操作消息。

在拥有包含带有按钮的窗口的 nib 的对象中实现一个操作方法。在类的标题中声明此方法，然后在 IB 中通过右键单击您的控制器并从正确的操作方法的圆圈拖动到按钮将按钮连接到它。

这被称为目标-动作范式，它将控制器职责（做事）与订购它们的视图隔离开来。因为每个动作方法只做一件事，你可以让一个按钮、一个菜单项，甚至另一个控制器（你的应用程序委托，上面）发送相同的动作消息，接收控制器不必关心哪个控件正在发送行动，因为它已经知道它必须做什么。

> 我不应该是纽扣的下属吗，

不。你很少在 Cocoa 中创建 NSObject（或者，对于 Core Data 中的模型对象，NSManagedObject）以外的任何东西的子类。

请注意，我说的是“很少”，而不是“从不”。您将不得不偶尔创建子类，特别是如果您想创建自定义或自定义视图和单元格（也许还有自定义窗口）。然而，在 Cocoa 中，子类化并不是*必要*的，就像（我听说）在其他平台上的其他框架中那样。

> 考虑到我有多个按钮，我很困惑。

目标动作范例意味着您不必为每个按钮创建一个按钮子类。一个控制器类实现了所有的动作，而股票按钮，因为您已经在 IB 中连接了它们，所以只需告诉控制器“执行此操作”。

> 崩溃了，我需要访问和操作我在 IB 中设置的 IBOutlets，

可能不是。至少，没有你想象的那么多。

> 确定何时单击按钮（以及单击了哪个按钮）。

没有。按钮会担心被点击；您只需担心将它们设置为发送然后响应它们的操作消息。

# macos - 无法在 Mac 的 FileMerge 中区分点文件

> ID：912589
> 
> 赞同：0
> 
> 时间：2009-05-26T20:30:11.923
> 
> 标签：macos, diff, filemerge

我已将 FileMerge 设置为不忽略任何文件。但是，它忽略了我的 dotFiles。

**如何使 FileMerge 区分 dotFiles？**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-28T14:14:49.203

您需要使用 opendiff -Mac 的内置命令在 FileMerge 中启动 dotFiles。您可以在[线程](https://stackoverflow.com/questions/916822/unable-to-diff-files-in-two-separate-branches-in-git/917557#917557)中找到解决方案。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2009-05-26T20:31:51.983

由于前导点只是向操作系统提示文件已隐藏（从 UNIX 继承）的常规提示，我想从文件名中删除前导点将允许实用程序查看和区分文件。

# .net - 如何在代码中创建 WF 规则？

> ID：912595
> 
> 赞同：0
> 
> 时间：2009-05-26T20:30:58.180
> 
> 标签：.net, workflow-foundation, rule-engine

我正在为 WF 中的自定义 Activity 创建一个**ActivityToolboxItem**。我正在尝试在 CreateComponentsCore 方法中为设计人员做尽可能多的工作。我想要结束的是以下内容：

1）我的自定义活动（**TriggerActivity**，一个*SequenceActivity*），包含以下内容：
2）一个**TriggerEvaluatorActivity**（一个简单的*Activity*），它绑定到 TriggerActivity 上的一个属性
3）一个**IfElseActivity**，它有两个分支
4）一个**IfElseBranchActivity**，它包含
5) **TerminateActivity**和
6) 为空的**IfElseBranchActivity**，当 TriggerEvaluatorActivity 评估为真时，执行流经它。

设计人员使用一个或多个针对执行上下文执行复杂评估的实现来 切换**TriggerEvaluatorActivity 。**

在代码中设置它非常简单，但我完全不知道如何启动将添加到*IfElseBranchActivity*以控制执行流程的**ActivityCondition 。**

 *我需要做的就是评估**TriggerEvaluatorActivity**上的属性。我已经通过代码 dom 创建了一个漂亮可爱的规则，但我不能直接在*IfElseBranchActivity*上设置它，我必须将规则存储在某处并在活动中引用它。

所以，我想我的问题是，一旦我在代码中创建了规则，如何从自定义 ActivityToolboxItem 中将规则添加到工作流中，以便我在代码中构建的活动可以引用它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-27T10:17:14.520

根据[MSDN 上的这个问题](http://social.msdn.microsoft.com/Forums/en-US/windowsworkflowfoundation/thread/a75acf90-83f5-4d78-be66-30491606f134/)，它存储在根 Activity 下的依赖属性中。不确定代码示例是否正确。

* * *

作品。这是一些示例代码：

```
protected override System.ComponentModel.IComponent[] 
    CreateComponentsCore(System.ComponentModel.Design.IDesignerHost host)
{
    var trigger = new Trigger() { Name = "Trigger" };
    var never = new Never() { Name = "NeverTrigger" };
    var ifelse = new IfElseActivity() { Name = "IfElse" };
    var stop = new TerminateActivity() { Name = "StopJob" };
    var failed = new IfElseBranchActivity() { Name = "NotTriggered" };
    var succeeded = new IfElseBranchActivity() { Name = "Triggered" };
    // build tree
    failed.Activities.Add(stop);
    ifelse.Activities.Add(failed);
    ifelse.Activities.Add(succeeded);
    trigger.Activities.Add(never);
    trigger.Activities.Add(ifelse);
    // create rule if it doesn't already exist
    var ruleDefinitions = GetRuleDefinitions
        (host.RootComponent as DependencyObject);
    if (!ruleDefinitions.Conditions.Contains(RuleName))
    {
        var neverTrigger = 
            new CodePropertyReferenceExpression
                (new CodeThisReferenceExpression(), 
                "NeverTrigger");
        var triggered = 
            new CodePropertyReferenceExpression
                (neverTrigger, 
                "Triggered");
        var falseSide = new CodeBinaryOperatorExpression();
        falseSide.Left = triggered;
        falseSide.Right = new CodePrimitiveExpression(false);
        falseSide.Operator = CodeBinaryOperatorType.ValueEquality;

        var ruleCondition = new RuleExpressionCondition
            (RuleName, falseSide);

        ruleDefinitions.Conditions.Add(ruleCondition);
    }
    // add rule to the failed branch; 
    // don't need a rule for the succeeded branch
    failed.Condition = new RuleConditionReference() 
        { ConditionName = RuleName };

    return new IComponent[] { trigger };
}

private RuleDefinitions GetRuleDefinitions
    (DependencyObject rootComponent)
{
    var ruleDefinitions = rootComponent.GetValue
        (RuleDefinitions.RuleDefinitionsProperty) as RuleDefinitions;
    if (ruleDefinitions == null)
    {
        ruleDefinitions = new RuleDefinitions();
        rootComponent.SetValue(RuleDefinitions.RuleDefinitionsProperty, 
            ruleDefinitions);
    }
    return ruleDefinitions;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-06-21T22:24:45.580

将要 -

新规则可能会被标记，直到它们被验证。您是否看到是否可以在添加它们后立即直接验证它们？

# javascript - 如何将字符串转换为 JavaScript 函数调用？

> ID：912596
> 
> 赞同：277
> 
> 时间：2009-05-26T20:31:03.670
> 
> 标签：javascript, function

我有一个字符串，如：

```
settings.functionName + '(' + t.parentNode.id + ')'; 
```

我想翻译成这样的函数调用：

```
clickedOnItem(IdofParent); 
```

这当然必须在 JavaScript 中完成。当我发出警报时`settings.functionName + '(' + t.parentNode.id + ')';`，似乎一切都正确。我只需要调用它将转换为的函数。

传奇：

```
settings.functionName = clickedOnItem

t.parentNode.id = IdofParent 
```

* * *

## 回答 #1

> 赞同：380
> 
> 时间：2009-05-26T20:39:46.443

看到我讨厌 eval，我[并不孤单](https://ericlippert.com/2003/11/01/eval-is-evil-part-one-2/)：

```
var fn = window[settings.functionName];
if(typeof fn === 'function') {
    fn(t.parentNode.id);
} 
```

**编辑：**回复@Mahan 的评论：在这种特殊情况下，`settings.functionName`将是`"clickedOnItem"`. 这将在运行时转换`var fn = window[settings.functionName];`为`var fn = window["clickedOnItem"]`，从而获得对 的引用`function clickedOnItem (nodeId) {}`。一旦我们在变量中引用了一个函数，我们就可以通过“调用变量”来调用这个函数，即`fn(t.parentNode.id)`等于`clickedOnItem(t.parentNode.id)`，这正是 OP 想要的。

更完整的例子：

```
/* Somewhere: */
window.settings = {
  /* [..] Other settings */
  functionName: 'clickedOnItem'
  /* , [..] More settings */
};

/* Later */
function clickedOnItem (nodeId) {
  /* Some cool event handling code here */
}

/* Even later */
var fn = window[settings.functionName]; 
/* note that settings.functionName could also be written
   as window.settings.functionName. In this case, we use the fact that window
   is the implied scope of global variables. */
if(typeof fn === 'function') {
    fn(t.parentNode.id);
} 
```

* * *

## 回答 #2

> 赞同：77
> 
> 时间：2009-05-26T20:37:50.660

```
window[settings.functionName](t.parentNode.id); 
```

不需要 eval()

* * *

## 回答 #3

> 赞同：70
> 
> 时间：2012-09-12T02:17:57.077

这是一种更通用的方法，同时支持范围：

```
// Get function from string, with or without scopes (by Nicolas Gauthier)
window.getFunctionFromString = function(string)
{
    var scope = window;
    var scopeSplit = string.split('.');
    for (i = 0; i < scopeSplit.length - 1; i++)
    {
        scope = scope[scopeSplit[i]];

        if (scope == undefined) return;
    }

    return scope[scopeSplit[scopeSplit.length - 1]];
} 
```

希望它可以帮助一些人。

* * *

## 回答 #4

> 赞同：16
> 
> 时间：2009-05-26T20:33:10.327

JavaScript 有一个[`eval`](http://www.w3schools.com/jsref/jsref_eval.asp)函数可以计算字符串并将其作为代码执行：

```
eval(settings.functionName + '(' + t.parentNode.id + ')'); 
```

* * *

## 回答 #5

> 赞同：14
> 
> 时间：2009-05-26T20:47:25.307

eval() 是您需要执行此操作的函数，但我建议尝试其中一种方法以尽量减少 eval 的使用。希望其中之一对您有意义。

**存储函数**

将函数存储为函数，而不是字符串，稍后将其用作函数。您实际存储功能的位置取决于您。

```
var funcForLater = clickedOnItem;

// later is now
funcForLater(t.parentNode.id); 
```

或者

```
someObject.funcForLater = clickedOnItem;    
// later is now    
(someObject.funcForLater)(t.parentNode.id); 
```

**存储函数名称**

即使您必须将函数名称存储为字符串，您也可以通过以下方式最小化复杂性

```
(eval(settings.functionName))(t.parentNode.id); 
```

这最大限度地减少了您必须构建和评估的 Javascript 数量。

**处理程序字典**

将您可能需要的所有操作函数放入一个对象中，并使用字符串将它们称为字典样式。

```
// global
itemActions = { click: clickedOnItem, rightClick: rightClickedOnItem /* etc */ };

// Later...
var actionName = "click"; // Or wherever you got the action name
var actionToDo = itemActions[actionName];
actionToDo(t.parentNode.id); 
```

（次要注意：如果您在这里使用语法`itemActions[actionName](t.parentNode.id);`，则该函数将被称为 的方法`itemActions`。）

* * *

## 回答 #6

> 赞同：11
> 
> 时间：2011-12-20T02:45:13.337

虽然我喜欢第一个答案并且讨厌 eval，但我想补充一点，还有另一种方法（类似于 eval），所以如果你可以绕过它而不使用它，你最好这样做。但在某些情况下，您可能希望在某些 ajax 调用之前或之后调用一些 javascript 代码，并且如果您在自定义属性而不是 ajax 中有此代码，则可以使用以下代码：

```
 var executeBefore = $(el).attr("data-execute-before-ajax");
    if (executeBefore != "") {
        var fn = new Function(executeBefore);
        fn();
    } 
```

如果您可能需要多次调用它，或者最终将其存储在函数缓存中。

同样 - 如果您有其他方法，请不要使用 eval 或此方法。

* * *

## 回答 #7

> 赞同：9
> 
> 时间：2014-02-19T03:24:25.687

我希望能够将函数名作为字符串，调用它，并将参数传递给函数。我无法得到这个问题的选定答案来做到这一点，但这个[答案](https://stackoverflow.com/questions/5818313/javascript-equivalent-of-phps-call-user-func)准确地解释了它，这里有一个简短的演示。

```
function test_function(argument)    {
    alert('This function ' + argument); 
}

functionName = 'test_function';

window[functionName]('works!'); 
```

This also works with multiple arguments.

* * *

## 回答 #8

> 赞同：8
> 
> 时间：2009-05-26T20:34:54.583

如果`settings.functionName`已经是一个函数，你可以这样做：

```
settings.functionName(t.parentNode.id); 
```

否则，如果`settings.functionName`只是函数的名称，这也应该起作用：

```
if (typeof window[settings.functionName] == "function") {
    window[settings.functionName](t.parentNode.id);
} 
```

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2012-02-26T00:16:07.160

我花了一段时间才弄清楚，因为传统的`window['someFunctionName']()`方法起初对我不起作用。我的函数名称作为 AJAX 响应从数据库中提取。此外，无论出于何种原因，我的函数被声明在窗口范围之外，所以为了解决这个问题，我必须重写我调用的函数

```
function someFunctionName() {} 
```

到

```
window.someFunctionName = function() {} 
```

从那里我可以`window['someFunctionName']()`轻松地打电话。我希望这可以帮助别人！

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2012-03-05T15:29:07.820

我更喜欢使用这样的东西：

```
window.callbackClass['newFunctionName'] = function(data) { console.log(data) };
...
window.callbackClass['newFunctionName'](data); 
```

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2012-08-24T22:51:28.080

在使用 CommonJS 规范的 javascript 中，例如 node.js，您可以执行我在下面显示的操作。这对于通过字符串访问变量非常方便，即使它没有在`window`对象上定义。如果有一个名为 的类，则`MyClass`在名为 MyClass.js 的 CommonJS 模块中定义

```
// MyClass.js
var MyClass = function() {
    // I do stuff in here. Probably return an object
    return {
       foo: "bar"
    }
}

module.exports = MyClass; 
```

然后，您可以从另一个名为 MyOtherFile.js 的文件中执行此操作

```
// MyOtherFile.js

var myString = "MyClass";

var MyClass = require('./' + myString);
var obj = new MyClass();

console.log(obj.foo); // returns "bar" 
```

CommonJS 如此令人愉快的另一个原因。

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2013-04-09T20:13:35.400

基于 Nicolas Gauthier 的回答：

```
var strng = 'someobj.someCallback';
var data = 'someData';

var func = window;
var funcSplit = strng.split('.');
for(i = 0;i < funcSplit.length;i++){
   //We maybe can check typeof and break the bucle if typeof != function
   func = func[funcSplit[i]];
}
func(data); 
```

* * *

## 回答 #13

> 赞同：-7
> 
> 时间：2009-05-26T20:34:07.937

```
eval("javascript code"); 
```

它在处理[JSON](http://www.json.org/js.html)时被广泛使用。

# c# - 获取活跃用户的访问权限

> ID：912601
> 
> 赞同：0
> 
> 时间：2009-05-26T20:31:59.567
> 
> 标签：c#, search

我有一个搜索算法，试图解析本地驱动器上目录的位置。如果该目录正在搜索其中一个目录的子目录，则该目录显然需要访问系统上存在的其他目录。但是，在这样做时，我不断收到 UnauthorizedAccessException。

我想在搜索机制运行时提供活动用户的访问权限，我该如何实现。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-26T20:51:47.200

在大多数情况下，正确的答案是您不应该这样做。

您的算法应该捕获 UnauthorizedAccessException，接受不允许在该文件夹下进一步导航，并表现得像该文件夹是空的一样。

这意味着有时您会得到一个答案，即您要查找的目录在技术上确实存在时不存在。没关系。这是它应该的方式。如果你没有权限，它对你来说不存在。

受某些其他用户权限保护的文件夹是“私有的”。“Joe”运行的程序不应该查看属于“Mary”的文件夹。这就是权限的全部意义。

该规则很少有受控例外。众所周知，磁盘备份和防病毒应用程序需要能够导航整个磁盘，而不管文件夹权限如何。他们通过设置一个在高特权帐户下运行的服务来做到这一点（可能是“SYSTEM”，也可能是其他帐户）。它可能是拥有 SeBackupPrivilege 的帐户。

如果您**确实**需要扫描整个磁盘，您可以为您的程序执行此操作，但对于大多数应用程序场景，您确实不应该这样做。只有像防病毒或备份程序这样的机器范围的维护应用程序才应该被授予这种权限。

并不是说它“矫枉过正”；那是它“错误”。它不按规则行事。

# java - 将 sqlitejdbc 与多个进程一起使用

> ID：912617
> 
> 赞同：1
> 
> 时间：2009-05-26T20:35:14.817
> 
> 标签：java, sqlite, jdbc

我正在尝试运行程序的几个实例来访问 java 中的 sqlite 数据库（始终是同一个文件），实际上我不知道是否有可能多个作业访问同一个数据库....

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-27T17:49:22.250

事实上，SQLite 会处理锁定问题，您不应该期待并发问题。无论如何，不​​是任何源自 SQLite 的东西。

但是，请注意，此解决方案完全**不可扩展**。如果这是与您的应用程序有关的问题，您应该查看其他数据库解决方案。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-27T17:39:35.453

尝试从不同进程访问单个 SQLite 数据库非常好（无论您使用什么语言），因为 SQLite 会注意确保正确锁定。但是，请注意 SQLite 不能很好地处理锁争用 - 因此，如果您有多个进程不断地同时访问数据库，您可能需要考虑使用不同的数据库或使用单个服务器来访问数据库。

# java - 如何加快 Java DatagramSocket 的性能？

> ID：912623
> 
> 赞同：4
> 
> 时间：2009-05-26T20:35:43.193
> 
> 标签：java, sockets

我正在使用 Java DatagramSocket 类将 UDP 数据报发送到端点。数据报必须以 60ms 的间隔到达端点。

我发现 DatagramSocket.Send 通常需要 > 1 ms（接近 2）来打包和发送不超过 56 个字节的数据包。这导致我的数据包以 62 毫秒的间隔发送，而不是 60 毫秒的间隔。

这是在 Windows Vista 机器上。这是我测量时间的方法：

```
 DatagramPacket d = new DatagramPacket(out, out.length, address, port);
              long nanoTime = System.nanoTime();
    socket.send(d);
    long diff = System.nanoTime() - nanoTime;
    System.out.println( out.length + " in " + diff + "ms." ); 
```

有没有人有加快这个过程的提示或技巧？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-26T21:09:46.697

您可以使用 Timer 类来安排事件。

```
 Timer timer = new Timer();
    TimerTask task = new TimerTask() {
        public void run() {
            //send packet here
        }};
    timer.scheduleAtFixedRate(task, 0, 60); 
```

这将每 60 毫秒创建一个重复事件以执行“运行”命令。在所有条件相同的情况下，数据包应该每 60 毫秒发送一次（尽管第一个数据包会延迟一定量，垃圾收集/其他任务/等可能会稍微延迟这个数字）。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-26T20:47:35.087

您会看到将数据从用户空间复制到内核空间所花费的时间。通过 UDP、IP 和以太网层发送甚至需要更长的时间，并且数据报通过物理网络到达其目的地可能需要可变的时间。

假设您的网络没有抖动（每个数据包传输时间的差异）并且您的进程以实时优先级运行，并且没有其他任何东西与它竞争 CPU...

无论 send() 方法执行需要多长时间，您都需要每 60 毫秒调用一次。您不能在两次通话之间等待 60 毫秒。您需要测量执行循环主体（send() 和其他任何内容）所需的时间，并将其从 60 毫秒中减去以获得等待时间。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-27T20:09:12.733

正如 James Van Huis 所说，使用计时器。这样，您至少会得到正确的平均频率。

引用 javadoc ：

> 如果由于任何原因（例如垃圾收集或其他后台活动）延迟了执行，则会快速连续发生两次或更多执行以“赶上”。从长远来看，执行频率将恰好是指定周期的倒数（假设 Object.wait(long) 底层的系统时钟是准确的）。

另外，要回答您实际但可能有点误导的问题：在我的机器上重用实例 DatagramPacket 并设置一个新的输出缓冲区平均“大量”微秒...

```
 datagram.setData(out);
    socket.send(datagram); 
```

它略微减少了 gc 上的负载，因此如果您以高速率发送可能是个好主意。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-26T20:56:51.123

除了“仅等待 59 毫秒”这种明显而聪明的响应之外，您实际上并没有太多可以做的事情。您进行的任何操作都将花费一些时间，这不太可能是一致的。因此，无法保证您的数据包将以精确的 60 毫秒间隔传送。

请记住，将您的 56 字节小消息包装在 UDP 和 IP 层所需的标头中需要时间，并且需要更多时间将其分流到您的网卡并在途中发送。这为 UDP 层增加了另外 8 个字节，为 IP 层增加了 20 个字节，并且对于链路层需要的任何内容都增加了更多。您无法采取任何措施来避免这种情况。

此外，由于您使用的是 UDP，因此无法保证您的数据包实际到达，或者如果他们这样做，它们会按顺序到达。TCP 可以做出这些保证，但两者都不能保证它们实际上会准时到达。特别是，网络拥塞可能会减慢您在到达目的地的途中的数据速度，从而导致数据延迟，即使与您的其他数据相比也是如此。因此，尝试使用远程应用程序以精确的间隔控制另一个应用程序是不合理的。如果您的信号在您希望的 2 毫秒内真正到达，您应该认为自己很幸运。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2011-01-25T18:53:51.147

我和你有同样的问题。我找到了解决方案。长话短说，这里是：

查找 Java 类`ScheduledThreadPoolExecutor`，它位于 Java 5 JDK/JRE 中。（我只能发布一个链接，因为我刚刚发现，否则我会指向 Oracle JavaDoc）

```
ScheduledThreadPoolExecutor schedThPoolExec = new ScheduledThreadPoolExecutor(1);   

/*
 * 
 * cue a byte buffer for sending in equal segments on the udp port with a inter-pkt-delay
 * 
 */
public void send(byte[] data, String destinationHost, int destinationPort, double interPacketDelayMs) {

        long interDelayNanos = (long) ( interPacketDelayMs * 1000000.0 );

        schedThPoolExec.scheduleAtFixedRate( new SendPacketsTimerTask(data, destinationHost, destinationPort), 0, interDelayNanos , TimeUnit.NANOSECONDS);

}

/*
 * 
 *
 * 
 */

class SendPacketsTimerTask implements Runnable {

    int offset = 0;
    byte[] buffer;
    String host;
    int port;

    public SendPacketsTimerTask(byte[] buffer, String destinationHost, int destinationPort) {

        this.buffer = buffer;
        host = destinationHost;
        port = destinationPort;
    }

    @Override
    public void run() {

        if(offset + PKT_SIZE < buffer.length) {

            //copy from cue to packet               
            byte[] tmp_pkt_buffer = new byte[PKT_SIZE];
            System.arraycopy(buffer, offset, tmp_pkt_buffer, 0, PKT_SIZE);

            try {
                //send packet       
                socket.send( new DatagramPacket(tmp_pkt_buffer, tmp_pkt_buffer.length, InetAddress.getByName(host), port) );
                //increment offset
                offset += tmp_pkt_buffer.length;

            } catch (UnknownHostException e) {
                e.printStackTrace();
            } catch (IOException e) {
                e.printStackTrace();
            } 

        }
    }
} 
```

除了`TimerTask`课程（如上所述）之外，您还可以定期安排活动。现在您只需要编写将发送您的消息的 TimerTask，或者在我的例子中是一个数据缓冲区。

我的问题实际上是我正在处理实时媒体流，并且我需要 15 Mbits+（视频数据）的吞吐量。因此，您将获得 0.5 毫秒的数据包间延迟。因此，该`Thread.sleep`方法的粒度（纳秒参数为真，但仍具有毫秒粒度 - 也为真）。所以我被困在 6 mbit 的发送速率上。当我检查`Timer`课程时，我以为我找到了解决方案。最后发现这门课也没有处理我的低执行期。寻找有类似问题的人，我发现[这篇文章](http://www.sagui.org/~gustavo/blog/code) 非常有帮助。而不是`Timer`类，您可以使用上述线程调度程序类，该类相应地绑定到本机代码，使用您的完整系统性能定期以可能的最高分辨率运行发送方法。

注意：Java 的一般含义（也在我的雇主那里）是“太慢”、“时间不精确”）来执行时间关键应用程序和高网络数据吞吐量最终被认为是错误的。这是真的。最后，使用 Java 5，我们可以实现全部可能的计时功能，从而提高应用程序性能 :)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-26T20:40:44.227

以 58 毫秒为间隔发送数据包怎么样？

无论您如何优化（实际上没有任何机会这样做；使用面向通道的 NIO 将完成相同的工作），发送数据都需要一些时间，并且可能存在一些可变性。如果需要精确的定时，则需要一些确认传输时间的策略。

另外，关于测量的注意事项：确保在执行数千次迭代之前不要测量延迟。这使优化器有机会完成其工作并给出更具代表性的时间安排。

* * *

曾经，Windows 上的时间分辨率很差。然而，1 毫秒的分辨率现在很常见。试试下面的测试，看看你的机器有多精确。

```
 public static void main(String... argv)
    throws InterruptedException
  {
    final int COUNT = 1000;
    long time = System.nanoTime();
    for (int i = 0; i < COUNT; ++i) {
      Thread.sleep(57);
    }
    time = System.nanoTime() - time;
    System.out.println("Average wait: " + (time / (COUNT * 1000000F)) + " ms");
  } 
```

在我的 Windows XP 机器上，平均等待时间是 57.7 毫秒。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-05-04T08:48:32.803

You are measuring nanoTime, so it will give you nano seconds instead of milli seconds.

> long diff = System.nanoTime() - nanoTime; System.out.println( out.length + " in " + diff + "ms." );

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-26T21:24:30.833

如果您以 60 毫秒的间隔发送数据包，那么理论上数据包将以 60 毫秒的间隔到达目的地，但这并不能保证。一旦数据包到达链接，它们就会成为网络链接的摆布，其中可能包括网络流量，甚至会沿着路由路径丢弃数据包。

是否有理由必须以 60 毫秒的间隔接收数据包？如果是这样，还有其他协议可以帮助您实现这一目标。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-05-26T22:11:04.140

由于您没有使用实时 Java，因此无法确保始终每 60 毫秒发送一个数据包。我将设置一个计时器线程，该线程将对实际发送数据包的其他两个等待线程执行“通知”。您可以只发送一个线程来解决问题，但我有点担心有备份以防万一出现问题。

# joomla - Joomla 的简单邮件列表（不是时事通讯）？

> ID：912624
> 
> 赞同：1
> 
> 时间：2009-05-26T20:35:44.660
> 
> 标签：joomla, mailing-list

有没有办法让 joomla 执行以下操作：

我有几个应该充当讨论邮件列表的邮件帐户。管理员（并且只有管理员）维护属于特定讨论组邮件地址的客户电子邮件地址列表。每当将邮件发送到例如 specialinterestdiscussion(at)mydomain.com 时，该邮件将自动转发给属于该列表的所有客户。如果发件人是该邮件列表的一部分，它将不会再次转发给他。发件人不一定必须是维护列表的一部分。

所以基本上它是一个简单的邮件列表。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2010-10-14T17:33:41.343

实际上有一种方法 - 通过集成在站点上运行的插件在后台刷新并检查邮件。

我可以推荐[Mailster](http://extensions.joomla.org/extensions/content-sharing/mailing-a-distribution-lists/14070)，它是 Joomla 的免费和开源邮件列表组件。从功能列表中，它完全可以完成您需要做的工作：

> *   可用于任何 POP3/IMAP 电子邮件帐户
> *   收件人由后台管理员管理
> *   用户可以（取消）订阅前端插件（可选）
> *   可以选择所有 Joomla 用户作为收件人，可以存储其他用户
> *   可以将用户组织在组中 单个用户或整个组可以
>     添加为邮件列表的收件人
> *   对邮件列表帖子的回复可以转发给所有收件人
> *   用于浏览邮件的后端邮件存档
> *   完整的附件支持
> *   [... 更多的...]

我在自己的网页上使用 Mailster 和 GMail 帐户，它就像一个魅力。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-07T06:03:09.070

我自己还没有找到一个很好的完全集成的解决方案，但是你可以搜索一个基本的 MailMan 集成。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-07T21:08:11.680

由于 Joomla 是一个基于 php 的引擎，它根本不可能。Joomla 本身不能在后台运行邮件列表所需的服务。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-11-09T11:53:50.390

我同意，Joomla 本身不能在后台运行服务。

但是像[Mailster](http://www.brandt-oss.com/products/mailster)或 LazyBackup2 这样的插件的工作方式可以实现类似服务的行为。如果您的网站没有足够的访问量，您必须注意这一点。例如，通过使用 cron 作业，只需每 X 分钟通过 wget 打开网页。

我刚开始使用 Mailster 并就相同的问题联系了开发人员，他回复了 cron 工作建议，还说他计划为 cronjobs 添加一个特定的 PHP 文件。当它准备好时，您甚至不需要再拥有插件，同时仍然能够管理 Joomla 中的所有内容。

# mysql - 显示计算中的所有行？

> ID：912627
> 
> 赞同：1
> 
> 时间：2009-05-26T20:36:24.110
> 
> 标签：mysql

我有一个需要提取的相关数据的 MySQL 表。我正在运行此查询以查找给定 id 的 x 和 y 之间的相关性；但是，我需要针对 y.id=2, 3, 4, 5 运行 x.id=1 ... 目前，我只是为每个配对多次运行以下命令。有没有办法加快查询速度，这样我就可以像第二个等式一样运行一次查询？

```
SELECT @correlation := (COUNT(x.value)*SUM(x.value*y.value) -
  sum(x.value)*sum(y.value))/SQRT((COUNT(x.value)*SUM(x.value*x.value) -
  sum(x.value)*sum(x.value))*(COUNT(y.value)*SUM(y.value*y.value) -
  sum(y.value)*sum(y.value))) AS correlation 
FROM tbl_expressions x, tbl_expressions y 
WHERE x.id=1 AND y.id=2 AND x.expressionnumber=y.expressionnumber;

SELECT @correlation := (COUNT(x.value)*SUM(x.value*y.value) -
  sum(x.value)*sum(y.value))/SQRT((COUNT(x.value)*SUM(x.value*x.value) -
  sum(x.value)*sum(x.value))*(COUNT(y.value)*SUM(y.value*y.value) -
  sum(y.value)*sum(y.value))) AS correlation 
FROM tbl_expressions x, tbl_expressions y 
WHERE x.id=1 AND y.id IN (2, 3, 4, 5, 6, 7) AND x.expressionnumber=y.expressionnumber; 
```

我希望结果是这样的：
相关性
.83
.82
.74
.64
...

但现在查询只输出一行（x.id 和最后一个 y.id 之间的相关性）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-26T20:41:18.063

如果您使用的是 MySQL 5.0 及更高版本，您可能需要考虑存储过程来处理其中的一些内容......

另外，您是否考虑过子查询？[http://dev.mysql.com/doc/refman/5.1/en/subqueries.html](http://dev.mysql.com/doc/refman/5.1/en/subqueries.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-26T20:48:32.573

很难回答这个问题，因为从您的描述中不清楚您需要查询做什么。

但我猜你也许可以用它`GROUP BY`来实现你想要的。很抱歉，我无法展示示例，因为我无法说出您想要的结果。

# zend-form - Zend_Form 装饰器排序（表单元素问题之前的错误）

> ID：912630
> 
> 赞同：2
> 
> 时间：2009-05-26T20:37:44.983
> 
> 标签：zend-form, decorator

我有以下 Zend_Form 代码可应用于表单元素装饰器：

```
$decorators = array(
        'ViewHelper', 
        'Description',
        array('break' => 'HtmlTag', array('tag' => 'br', 'openOnly'=>true)),
        array('Label', array('class' => 'formLabel', 'separator'=>' ', 'requiredSuffix' => ' <em class="requiredFormElement">(requried)</em>', 'escape'=>false)),
        array('Errors', array('class' => 'formErrors')),
        array(array('row' => 'HtmlTag'), array('tag' => 'div')),
    ); 
```

似乎无论我做什么，我似乎都无法让错误出现在表单元素（和标签）本身之前。我错过了什么吗？其他一切似乎都正确订购。这只能通过自定义装饰器来完成吗？

先感谢您。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-26T20:54:38.363

尝试以下方法，不知道它是否会起作用，因为我目前没有笔记本电脑：

```
array('Errors', array('class' => 'formErrors', 'placement' => 'prepend')) 
```

# gtk - 为什么新添加的小部件没有分配？

> ID：912633
> 
> 赞同：1
> 
> 时间：2009-05-26T20:37:57.383
> 
> 标签：gtk, pygtk

我想在滚动窗口的底部添加一个小部件，然后滚动到该窗口的底部。但是，窗口认为它已经在底部，因为小部件还没有被分配。即，这返回-1：

```
widget.get_allocation().y 
```

为什么是这样？有什么方法可以强制立即分配小部件，以便我可以相应地调整窗口？还是有更好的解决方案？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-06T19:11:49.290

更好的解决方案是连接到小部件的[size-allocate](http://www.pygtk.org/pygtk2reference/class-gtkwidget.html#signal-gtkwidget--size-allocate)信号并将滚动计算推迟到那时。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-29T08:45:17.547

我不是 100% 确定我理解你想要做什么，但仍然：至少，你需要[实现](http://library.gnome.org/devel/gtk/stable/GtkWidget.html#gtk-widget-realize)小部件以让它计算这些东西。但是请参阅链接到文档中的注释，并调查这些方法是否效果更好。

# c# - 如何为不可变类型创建 const 成员？

> ID：912636
> 
> 赞同：0
> 
> 时间：2009-05-26T20:38:52.717
> 
> 标签：c#, .net, struct, immutability

如果您有这样的不可变类型：

```
struct Point3
{

} 
```

和内部的成员，如起源：

```
public static const Point3 Origin = new Point3 (0,0,0); 
```

你应该使用：

```
new Point3 (0,0,0) 
```

?

在我看来，既然类型不能改变，为什么会有许多本质上相同的起源？就像我们永远不会改变 0，对吧？

如何为不可变类型实现相同的目标？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-26T20:40:21.233

```
public static readonly Point3 Origin = new Point3(0,0,0); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-26T20:45:46.153

正如 Andrew 所提到的，您不能使用`const`它，因为它不是编译时常量。

请注意，如果您*要*重复使用构造函数，最好（从性能的角度）调用

```
new Point3() 
```

比

```
new Point3(0, 0, 0) 
```

编译器知道第一个版本只是清空内存，不需要调用任何代码。

However, I'd go along with providing an `Origin` member and using that everywhere instead, where possible :)

# iphone - NSMutableArray addObject 使 iPhone 应用程序崩溃

> ID：912641
> 
> 赞同：2
> 
> 时间：2009-05-26T20:39:19.347
> 
> 标签：iphone, objective-c, cocoa-touch

我有一个类 XMLParser。只要我不删除将节点添加到 NSMutableArray 的行的注释，它就可以正常工作：

```
[nodes addObject:self.currentNode]; 
```

如果我这样做了，应用程序就会崩溃——在调试日志中不会留下任何痕迹。怎么会这样？

**XMLParser.m：**

```
#import "XMLParser.h"
#import "MyViewController.h"
#import "Node.h"

@implementation XMLParser
@synthesize currentNode, currentProperty, currentAddress, nodes;

- (NSMutableArray *)parseNodeData:(NSString *)url {
    NSURL *urlObj = [[NSURL alloc] initWithString:url];
    NSXMLParser *parser = [[NSXMLParser alloc] initWithContentsOfURL:urlObj];

    self.nodes = [[NSMutableArray alloc] init];

    [parser setDelegate:self];
    [parser setShouldProcessNamespaces:NO];
    [parser setShouldReportNamespacePrefixes:NO];
    [parser setShouldResolveExternalEntities:NO];
    [parser parse];
    NSLog(@"Proceeded from parser.");

    NSLog(@"Returning %@ rows", [nodes count]);
    //[parser release];
    return self.nodes;
}

- (void)parser:(NSXMLParser *)parser foundCharacters:(NSString *)string
{
    if (self.currentProperty) {
        [currentProperty appendString:string];
    }
}

- (void)parser:(NSXMLParser *)parser didStartElement:(NSString *)elementName namespaceURI:(NSString *)namespaceURI qualifiedName:(NSString *)qName attributes:(NSDictionary *)attributeDict {
    if (qName) {
        elementName = qName;
    }

    NSLog(@"<%@>", elementName);

    if(self.currentNode)
    {
        if ([elementName isEqualToString:@"id"] || [elementName isEqualToString:@"name"])
        {
            self.currentProperty = [NSMutableString string];
        }
    } else {
        // We are outside of everything, so we need a
        // Check for deeper nested node
        if ([elementName isEqualToString:@"node"]) {
            self.currentNode = [[Node alloc] init];
            NSLog(@"Initialized new node...");
        }
    }
}

- (void)parser:(NSXMLParser *)parser didEndElement:(NSString *)elementName namespaceURI:(NSString *)namespaceURI qualifiedName:(NSString *)qName
{
    if(self.currentNode)
    {
        if ([elementName isEqualToString:@"id"]) {
            NSLog(@"Tried setting node id: %@", self.currentProperty);
            self.currentNode.nodeId = self.currentProperty;

        } else if ([elementName isEqualToString:@"name"]) {
            NSLog(@"Tried setting node name: %@", self.currentProperty);
            self.currentNode.name = self.currentProperty;
        } else if ([elementName isEqualToString:@"node"]) {
            NSLog(@"Adding node to array");
            //[nodes addObject:self.currentNode];
            self.currentNode = nil;
        }
    }

    NSLog(@"</%@>", elementName);

    self.currentProperty = nil;
}

- (void) dealloc {
    [currentNode release];
    [currentAddress release];
    [currentProperty release];
    [super dealloc];
}

@end 
```

**XMLParser.h：**

```
#import <UIKit/UIKit.h>
#import "Address.h"
#import "Node.h"

@class XMLAppDelegate;

@interface XMLParser : NSObject {
    NSMutableString *currentProperty;
    Address *currentAddress;
    Node *currentNode;
    NSMutableArray *nodes;

}

@property (nonatomic, retain) NSMutableString *currentProperty;
@property (nonatomic, retain) Address *currentAddress;
@property (nonatomic, retain) Node *currentNode;
@property (nonatomic, retain) NSMutableArray *nodes;

- (NSMutableArray *)parseNodeData:(NSString *)data;

@end 
```

**编辑：调试日志的输出**

```
[Session started at 2009-05-26 23:31:26 +0200.]
2009-05-26 23:31:28.352 HelloWorld[6914:20b] <response>
2009-05-26 23:31:28.353 HelloWorld[6914:20b] <nodesearchresult>
2009-05-26 23:31:28.354 HelloWorld[6914:20b] <resultsreturned>
2009-05-26 23:31:28.354 HelloWorld[6914:20b] </resultsreturned>
2009-05-26 23:31:28.354 HelloWorld[6914:20b] <resultsfound>
2009-05-26 23:31:28.354 HelloWorld[6914:20b] </resultsfound>
2009-05-26 23:31:28.355 HelloWorld[6914:20b] <nodes>
2009-05-26 23:31:28.355 HelloWorld[6914:20b] <node>
2009-05-26 23:31:28.356 HelloWorld[6914:20b] Initialized new node...
2009-05-26 23:31:28.356 HelloWorld[6914:20b] <id>
2009-05-26 23:31:28.356 HelloWorld[6914:20b] Tried setting node id: 614
2009-05-26 23:31:28.356 HelloWorld[6914:20b] </id>
2009-05-26 23:31:28.357 HelloWorld[6914:20b] <name>
2009-05-26 23:31:28.357 HelloWorld[6914:20b] Tried setting node name: Roberts coffee
2009-05-26 23:31:28.357 HelloWorld[6914:20b] </name>
2009-05-26 23:31:28.358 HelloWorld[6914:20b] <address>
2009-05-26 23:31:28.358 HelloWorld[6914:20b] <street>
2009-05-26 23:31:28.358 HelloWorld[6914:20b] </street>
2009-05-26 23:31:28.358 HelloWorld[6914:20b] <zipcode>
2009-05-26 23:31:28.359 HelloWorld[6914:20b] </zipcode>
2009-05-26 23:31:28.359 HelloWorld[6914:20b] </address>
2009-05-26 23:31:28.359 HelloWorld[6914:20b] <position>
2009-05-26 23:31:28.359 HelloWorld[6914:20b] <latitude>
2009-05-26 23:31:28.360 HelloWorld[6914:20b] </latitude>
2009-05-26 23:31:28.360 HelloWorld[6914:20b] <longitude>
2009-05-26 23:31:28.360 HelloWorld[6914:20b] </longitude>
2009-05-26 23:31:28.361 HelloWorld[6914:20b] </position>
2009-05-26 23:31:28.361 HelloWorld[6914:20b] <phone>
2009-05-26 23:31:28.361 HelloWorld[6914:20b] </phone>
2009-05-26 23:31:28.363 HelloWorld[6914:20b] <nodetypes>
2009-05-26 23:31:28.363 HelloWorld[6914:20b] <nodetype>
2009-05-26 23:31:28.363 HelloWorld[6914:20b] </nodetype>
2009-05-26 23:31:28.364 HelloWorld[6914:20b] </nodetypes>
2009-05-26 23:31:28.364 HelloWorld[6914:20b] <rating>
2009-05-26 23:31:28.364 HelloWorld[6914:20b] <score>
2009-05-26 23:31:28.365 HelloWorld[6914:20b] </score>
2009-05-26 23:31:28.365 HelloWorld[6914:20b] <votes>
2009-05-26 23:31:28.366 HelloWorld[6914:20b] </votes>
2009-05-26 23:31:28.366 HelloWorld[6914:20b] </rating>
2009-05-26 23:31:28.366 HelloWorld[6914:20b] <teaser>
2009-05-26 23:31:28.367 HelloWorld[6914:20b] </teaser>
2009-05-26 23:31:28.367 HelloWorld[6914:20b] Adding node to array
2009-05-26 23:31:28.367 HelloWorld[6914:20b] </node>
2009-05-26 23:31:28.367 HelloWorld[6914:20b] <node>
2009-05-26 23:31:28.368 HelloWorld[6914:20b] Initialized new node...
2009-05-26 23:31:28.368 HelloWorld[6914:20b] <id>
2009-05-26 23:31:28.368 HelloWorld[6914:20b] Tried setting node id: 326
2009-05-26 23:31:28.368 HelloWorld[6914:20b] </id>
2009-05-26 23:31:28.369 HelloWorld[6914:20b] <name>
2009-05-26 23:31:28.369 HelloWorld[6914:20b] Tried setting node name: Sort kaffe & vinyl
2009-05-26 23:31:28.369 HelloWorld[6914:20b] </name>
2009-05-26 23:31:28.369 HelloWorld[6914:20b] <address>
2009-05-26 23:31:28.370 HelloWorld[6914:20b] <street>
2009-05-26 23:31:28.370 HelloWorld[6914:20b] </street>
2009-05-26 23:31:28.371 HelloWorld[6914:20b] <zipcode>
2009-05-26 23:31:28.371 HelloWorld[6914:20b] </zipcode>
2009-05-26 23:31:28.372 HelloWorld[6914:20b] </address>
2009-05-26 23:31:28.372 HelloWorld[6914:20b] <position>
2009-05-26 23:31:28.372 HelloWorld[6914:20b] <latitude>
2009-05-26 23:31:28.373 HelloWorld[6914:20b] </latitude>
2009-05-26 23:31:28.373 HelloWorld[6914:20b] <longitude>
2009-05-26 23:31:28.373 HelloWorld[6914:20b] </longitude>
2009-05-26 23:31:28.374 HelloWorld[6914:20b] </position>
2009-05-26 23:31:28.374 HelloWorld[6914:20b] <phone>
2009-05-26 23:31:28.375 HelloWorld[6914:20b] </phone>
2009-05-26 23:31:28.375 HelloWorld[6914:20b] <nodetypes>
2009-05-26 23:31:28.375 HelloWorld[6914:20b] <nodetype>
2009-05-26 23:31:28.375 HelloWorld[6914:20b] </nodetype>
2009-05-26 23:31:28.376 HelloWorld[6914:20b] <nodetype>
2009-05-26 23:31:28.376 HelloWorld[6914:20b] </nodetype>
2009-05-26 23:31:28.376 HelloWorld[6914:20b] </nodetypes>
2009-05-26 23:31:28.376 HelloWorld[6914:20b] <rating>
2009-05-26 23:31:28.377 HelloWorld[6914:20b] <score>
2009-05-26 23:31:28.377 HelloWorld[6914:20b] </score>
2009-05-26 23:31:28.377 HelloWorld[6914:20b] <votes>
2009-05-26 23:31:28.377 HelloWorld[6914:20b] </votes>
2009-05-26 23:31:28.378 HelloWorld[6914:20b] </rating>
2009-05-26 23:31:28.378 HelloWorld[6914:20b] <teaser>
2009-05-26 23:31:28.379 HelloWorld[6914:20b] </teaser>
2009-05-26 23:31:28.379 HelloWorld[6914:20b] Adding node to array
2009-05-26 23:31:28.379 HelloWorld[6914:20b] </node>
2009-05-26 23:31:28.380 HelloWorld[6914:20b] </nodes>
2009-05-26 23:31:28.380 HelloWorld[6914:20b] </nodesearchresult>
2009-05-26 23:31:28.381 HelloWorld[6914:20b] </response>
2009-05-26 23:31:28.381 HelloWorld[6914:20b] Proceeded from parser.

[Session started at 2009-05-26 23:31:28 +0200.]
Loading program into debugger…
GNU gdb 6.3.50-20050815 (Apple version gdb-962) (Sat Jul 26 08:14:40 UTC 2008)
Copyright 2004 Free Software Foundation, Inc.
GDB is free software, covered by the GNU General Public License, and you are
welcome to change it and/or distribute copies of it under certain conditions.
Type "show copying" to see the conditions.
There is absolutely no warranty for GDB.  Type "show warranty" for details.
This GDB was configured as "i386-apple-darwin".warning: Unable to read symbols for "/System/Library/Frameworks/UIKit.framework/UIKit" (file not found).
warning: Unable to read symbols from "UIKit" (not yet mapped into memory).
warning: Unable to read symbols for "/System/Library/Frameworks/CoreLocation.framework/Versions/A/CoreLocation" (file not found).
warning: Unable to read symbols from "CoreLocation" (not yet mapped into memory).
warning: Unable to read symbols for "/System/Library/Frameworks/CoreGraphics.framework/CoreGraphics" (file not found).
warning: Unable to read symbols from "CoreGraphics" (not yet mapped into memory).
Program loaded.
sharedlibrary apply-load-rules all
Attaching to program: `/Users/philipdahlstrm/Library/Application Support/iPhone Simulator/User/Applications/6BD1CC99-F133-4B97-A041-1D210851B6C6/HelloWorld.app/HelloWorld', process 6914.
(gdb) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-27T04:55:24.890

您的错误在最终的 NSLog 中：

```
NSLog(@"Returning %@ rows", [nodes count]); 
```

`%@`接受一个指向对象的指针。`[nodes count]`返回一个无符号整数，然后您将其作为指针取消引用。如果nodes为空也没关系，因为然后`-count`返回0，也就是nil，这样解引用是安全的。你应该在`%d`这里使用而不是`%@`.

调试器堆栈应该向您显示发生这种情况的确切位置。我通过查看日志的最后一行并查看之后立即发生的事情找到了它。

顺便说一句，您在这里泄漏了大量内存。如果您在分配给保留访问器（如）的任务中使用[三个魔术词](http://robnapier.net/blog/three-magic-words-6)`self.nodes =...`之一，则需要`autorelease`.

```
self.currentNode = [[Node alloc] init]; 
```

应该：

```
self.currentNode = [[[Node alloc] init] autorelease]; 
```

并且您应该始终对 ivars 使用访问器。永远不要以你的方式直接访问节点（除了它们的访问器和 in `dealloc`）。

# .net - Gridview 自动换行

> ID：912658
> 
> 赞同：6
> 
> 时间：2009-05-26T20:43:28.980
> 
> 标签：.net, asp.net, vb.net, visual-studio-2008, gridview

我尝试更改 RowStyle Wrap 属性和网格中的每个 Wrap 属性。无论行的文本长度是多少，如何在 Gridview 中停止自动换行？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2010-01-17T14:14:17.957

这不是 RowStyle。您需要在列下设置单个 Item 的 wrap 设置。

```
<asp:GridView ID="GridView1" runat="server">
    <Columns>
        <asp:BoundField>
        <ItemStyle Wrap="False" />
        </asp:BoundField>
        <asp:BoundField>
        <ItemStyle Wrap="False" />
        </asp:BoundField>
    </Columns>
</asp:GridView> 
```

这需要对每个单独的列进行。不过，您可以在代码隐藏中设置一个方法来为您执行此操作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-26T20:52:04.517

杰森在[这篇博](http://www.velocityreviews.com/forums/t121857-gridview-control-limiting-width-and-overflow.html)文中写道：

从数据库加载长文本时，我遇到了与 Gridview 相同的问题。我尝试了 DIV 方法来获得 CSS 样式以阻止表格一直向右扩展。我现在可以使用省略号显示文本是否太长。但是，这意味着我无法在 gridview 中显示整个文本，这可能会误导用户。

所以我添加了另一种名为“word-break : break-all”的样式来将文本分成适合表格的块并得到我想要的结果。以下是我的代码的部分：

```
<style type="text/css">
    .DisplayDesc { width:500px; word-break: break-all; }
    .DisplayDiv  { width:500px; OVERFLOW:hidden; TEXT-OVERFLOW:ellipsis;}
</style> 

<asp:TemplateField HeaderText="Log Description">
    <ItemStyle Font-Names="Tahoma" Font-Size="X-Small" 
               HorizontalAlign="Left" Wrap="True" />
    <ItemTemplate>
        <div class="DisplayDiv">
            <asp:Label CssClass="DisplayDesc" ID="Label1" runat="server" 
                       Text='<%# Bind("TransText") %>'></asp:Label>
        </div>
    </ItemTemplate>
</asp:TemplateField> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-01-07T06:12:28.317

只需在 css 类中设置 nowrap，然后将该类应用于 span 标签，然后将标签放在该 span 标签内，

span class="yourclassname" 你的 asp 标签标签 /span

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-12T14:48:36.647

这对我有用

```
<asp:GridView ID="SomeGridView"  CssClass="gridtext" > 

.gridtext  
{
    white-space: nowrap;
}

.gridtext table
{
    white-space: nowrap;
}
.gridtext tr
{
    white-space: nowrap;
}
.gridtext td
{
    white-space: nowrap;
}

.gridtext th
{
    white-space: nowrap;
} 
```

# java - 在 Hibernate 中重新附加分离对象的正确方法是什么？

> ID：912659
> 
> 赞同：204
> 
> 时间：2009-05-26T20:43:51.290
> 
> 标签：java, hibernate, spring, session, detach

我有一种情况，我需要将分离的对象重新附加到休眠会话，尽管会话中可能已经存在相同标识的对象，这会导致错误。

现在，我可以做两件事之一。

1.  `getHibernateTemplate().update( obj )` 当且仅当对象在休眠会话中不存在时才有效。当我以后需要它时，会抛出异常，说明会话中已经存在具有给定标识符的对象。

2.  `getHibernateTemplate().merge( obj )` 当且仅当休眠会话中存在对象时，此方法才有效。如果我使用它，稍后我需要对象在会话中时会引发异常。

鉴于这两种情况，我一般如何将会话附加到对象？我不想使用异常来控制这个问题的解决方案的流程，因为必须有一个更优雅的解决方案......

* * *

## 回答 #1

> 赞同：189
> 
> 时间：2010-12-14T10:50:32.087

因此，似乎没有办法在 JPA 中重新附加过时的分离实体。

`merge()`会将陈旧状态推送到数据库，并覆盖任何干预更新。

`refresh()`不能在分离的实体上调用。

`lock()`不能在分离的实体上调用，即使它可以，并且它确实重新连接了实体，使用参数“LockMode.NONE”调用“lock”暗示您正在锁定，但不是锁定，是 API 设计中最违反直觉的部分我见过的。

所以你被卡住了。有一种`detach()`方法，但没有`attach()`or `reattach()`。您无法使用对象生命周期中的明显步骤。

从关于 JPA 的类似问题的数量来看，似乎即使 JPA 确实声称有一个连贯的模型，它也肯定与大多数程序员的心智模型不匹配，他们被诅咒浪费很多时间试图理解如何获得JPA 做最简单的事情，并最终在其应用程序中使用缓存管理代码。

似乎唯一的方法是丢弃陈旧的分离实体并使用相同的 id 进行查找查询，这将命中 L2 或 DB。

米克

* * *

## 回答 #2

> 赞同：36
> 
> 时间：2012-05-17T21:26:01.277

所有这些答案都忽略了一个重要的区别。update() 用于（重新）将您的对象图附加到会话。您传递给它的对象是被管理的对象。

merge() 实际上不是一个（重新）附件 API。注意 merge() 有返回值吗？那是因为它会返回托管图，这可能不是您传递给它的图。merge() 是一个 JPA API，其行为受 JPA 规范的约束。如果您传递给 merge() 的对象已经被管理（已经与会话相关联），那么这就是 Hibernate 使用的图形；传入的对象与从 merge() 返回的对象相同。但是，如果您传递给 merge() 的对象是分离的，Hibernate 会创建一个新的托管对象图，并将状态从您的分离图复制到新的托管图上。同样，这一切都由 JPA 规范规定和管理。

就“确保该实体受管理或使其受管理”的通用策略而言，它有点取决于您是否还想考虑尚未插入的数据。假设你这样做，使用类似的东西

```
if ( session.contains( myEntity ) ) {
    // nothing to do... myEntity is already associated with the session
}
else {
    session.saveOrUpdate( myEntity );
} 
```

请注意，我使用了 saveOrUpdate() 而不是 update()。如果您不想在此处处理尚未插入的数据，请改用 update() ...

* * *

## 回答 #3

> 赞同：24
> 
> 时间：2020-03-12T20:02:18.003

## 实体状态

JPA 定义了以下实体状态：

## 新（瞬态）

从未与 Hibernate `Session`(aka `Persistence Context`) 关联且未映射到任何数据库表行的新创建的对象被视为处于 New (Transient) 状态。

要持久化，我们需要显式调用该`EntityManager#persist`方法或使用传递持久性机制。

## 持久（托管）

持久性实体已与数据库表行相关联，并由当前运行的持久性上下文管理。对此类实体所做的任何更改都将被检测到并传播到数据库（在会话刷新期间）。

使用 Hibernate，我们不再需要执行 INSERT/UPDATE/DELETE 语句。Hibernate 采用事务性后写工作方式，并且在当前`Session`刷新时间期间的最后一个负责时刻同步更改。

## 分离式

一旦当前运行的持久性上下文关闭，所有以前管理的实体都将被分离。将不再跟踪连续的更改，也不会发生自动数据库同步。

## 实体状态转换

您可以使用接口定义的各种方法更改实体状态`EntityManager`。

为了更好地理解 JPA 实体状态转换，请考虑下图：

[![JPA 实体状态转换](https://i.stack.imgur.com/Hez6p.png)](https://i.stack.imgur.com/Hez6p.png)

使用 JPA 时，要将分离的实体重新关联到活动`EntityManager`，您可以使用**合并**操作。

使用本机 Hibernate API 时，除了`merge`，您可以使用更新方法将分离的实体重新附加到活动的 Hibernate 会话，如下图所示：

[![Hibernate 实体状态转换](https://i.stack.imgur.com/CpfAe.png)](https://i.stack.imgur.com/CpfAe.png)

## 合并分离的实体

合并会将分离的实体状态（源）复制到托管实体实例（目标）。

考虑我们已经持久化了以下`Book`实体，现在该实体已分离，`EntityManager`因为用于持久化实体的实体已关闭：

```
Book _book = doInJPA(entityManager -> {
    Book book = new Book()
    .setIsbn("978-9730228236")
    .setTitle("High-Performance Java Persistence")
    .setAuthor("Vlad Mihalcea");

    entityManager.persist(book);

    return book;
}); 
```

当实体处于分离状态时，我们对其进行如下修改：

```
_book.setTitle(
    "High-Performance Java Persistence, 2nd edition"
); 
```

现在，我们要将更改传播到数据库，因此我们可以调用该`merge`方法：

```
doInJPA(entityManager -> {
    Book book = entityManager.merge(_book);

    LOGGER.info("Merging the Book entity");

    assertFalse(book == _book);
}); 
```

Hibernate 将执行以下 SQL 语句：

```
SELECT
    b.id,
    b.author AS author2_0_,
    b.isbn AS isbn3_0_,
    b.title AS title4_0_
FROM
    book b
WHERE
    b.id = 1

-- Merging the Book entity

UPDATE
    book
SET
    author = 'Vlad Mihalcea',
    isbn = '978-9730228236',
    title = 'High-Performance Java Persistence, 2nd edition'
WHERE
    id = 1 
```

如果合并实体在 current 中没有等价物，`EntityManager`则将从数据库中获取新的实体快照。

一旦存在托管实体，JPA 会将分离实体的状态复制到当前托管的实体上，并且在 Persistence Context 期间`flush`，如果脏检查机制发现托管实体已更改，则会生成 UPDATE。

> 因此，当使用 时`merge`，即使在合并操作之后，分离的对象实例也将继续保持分离状态。

## 重新附加分离的实体

Hibernate，但 JPA 不支持通过该`update`方法重新附加。

Hibernate`Session`只能为给定的数据库行关联一个实体对象。这是因为持久性上下文充当内存缓存（一级缓存），并且只有一个值（实体）与给定的键（实体类型和数据库标识符）相关联。

仅当没有其他 JVM 对象（匹配同一数据库行）与当前 Hibernate 关联时，才能重新附加实体`Session`。

考虑到我们已经持久化了`Book`实体并且我们在`Book`实体处于分离状态时对其进行了修改：

```
Book _book = doInJPA(entityManager -> {
    Book book = new Book()
    .setIsbn("978-9730228236")
    .setTitle("High-Performance Java Persistence")
    .setAuthor("Vlad Mihalcea");

    entityManager.persist(book);

    return book;
});

_book.setTitle(
    "High-Performance Java Persistence, 2nd edition"
); 
```

我们可以像这样重新附加分离的实体：

```
doInJPA(entityManager -> {
    Session session = entityManager.unwrap(Session.class);

    session.update(_book);

    LOGGER.info("Updating the Book entity");
}); 
```

Hibernate 将执行以下 SQL 语句：

```
-- Updating the Book entity

UPDATE
    book
SET
    author = 'Vlad Mihalcea',
    isbn = '978-9730228236',
    title = 'High-Performance Java Persistence, 2nd edition'
WHERE
    id = 1 
```

> 该`update`方法需要你`unwrap`到`EntityManager`一个 Hibernate `Session`。

与 不同`merge`的是，提供的分离实体将与当前持久性上下文重新关联，并且无论实体是否已修改，都会在刷新期间安排更新。

为了防止这种情况，您可以使用`@SelectBeforeUpdate`Hibernate 注释，该注释将触发一个 SELECT 语句，该语句获取加载状态，然后由脏检查机制使用。

```
@Entity(name = "Book")
@Table(name = "book")
@SelectBeforeUpdate
public class Book {

    //Code omitted for brevity
} 
```

### 当心 NonUniqueObjectException

可能发生的一个问题`update`是，如果持久性上下文已经包含一个具有相同 id 和相同类型的实体引用，如下例所示：

```
Book _book = doInJPA(entityManager -> {
    Book book = new Book()
    .setIsbn("978-9730228236")
    .setTitle("High-Performance Java Persistence")
    .setAuthor("Vlad Mihalcea");

    Session session = entityManager.unwrap(Session.class);
    session.saveOrUpdate(book);

    return book;
});

_book.setTitle(
    "High-Performance Java Persistence, 2nd edition"
);

try {
    doInJPA(entityManager -> {
        Book book = entityManager.find(
            Book.class,
            _book.getId()
        );

        Session session = entityManager.unwrap(Session.class);
        session.saveOrUpdate(_book);
    });
} catch (NonUniqueObjectException e) {
    LOGGER.error(
        "The Persistence Context cannot hold " +
        "two representations of the same entity",
        e
    );
} 
```

现在，在执行上面的测试用例时，Hibernate 将抛出 a`NonUniqueObjectException`因为第二个`EntityManager`已经包含一个`Book` 与我们传递给的具有相同标识符的实体`update`，并且持久性上下文不能包含同一实体的两个表示。

```
org.hibernate.NonUniqueObjectException:
    A different object with the same identifier value was already associated with the session : [com.vladmihalcea.book.hpjp.hibernate.pc.Book#1]
    at org.hibernate.engine.internal.StatefulPersistenceContext.checkUniqueness(StatefulPersistenceContext.java:651)
    at org.hibernate.event.internal.DefaultSaveOrUpdateEventListener.performUpdate(DefaultSaveOrUpdateEventListener.java:284)
    at org.hibernate.event.internal.DefaultSaveOrUpdateEventListener.entityIsDetached(DefaultSaveOrUpdateEventListener.java:227)
    at org.hibernate.event.internal.DefaultSaveOrUpdateEventListener.performSaveOrUpdate(DefaultSaveOrUpdateEventListener.java:92)
    at org.hibernate.event.internal.DefaultSaveOrUpdateEventListener.onSaveOrUpdate(DefaultSaveOrUpdateEventListener.java:73)
    at org.hibernate.internal.SessionImpl.fireSaveOrUpdate(SessionImpl.java:682)
    at org.hibernate.internal.SessionImpl.saveOrUpdate(SessionImpl.java:674) 
```

## 结论

如果您使用乐观锁定，则首选该`merge`方法，因为它可以防止丢失更新。

有`update`利于批量更新，因为它可以防止`merge`操作生成额外的 SELECT 语句，从而减少批量更新执行时间。

* * *

## 回答 #4

> 赞同：19
> 
> 时间：2009-05-29T00:41:17.397

**不礼貌的回答：**您可能正在寻找扩展的持久性上下文。[这是Seam 框架](http://www.seamframework.org)背后的主要原因之一……如果您特别在 Spring 中难以使用 Hibernate，请查看Seam 的[这篇](http://docs.jboss.com/seam/2.1.2.CR2/reference/en-US/html/spring.html#spring-persistence)文档。

**外交回答：**这在[Hibernate docs](http://docs.jboss.org/hibernate/stable/core/reference/en/html/objectstate-detached.html)中有描述。如果您需要更多说明，请查看[Java Persistence with Hibernate](http://my.safaribooksonline.com/9781932394887)的第 9.3.2 节，称为“使用分离的对象”。如果您使用 Hibernate 做的不仅仅是 CRUD，我**强烈建议您阅读这本书。**

* * *

## 回答 #5

> 赞同：16
> 
> 时间：2010-09-10T09:04:06.607

如果您确定您的实体没有被修改（或者如果您同意任何修改都将丢失），那么您可以将其重新附加到带锁的会话中。

```
session.lock(entity, LockMode.NONE); 
```

它不会锁定任何内容，但它会从会话缓存中获取实体，或者（如果没有找到）从数据库中读取它。

当您从“旧”（例如来自 HttpSession）实体导航关系时，防止 LazyInitException 非常有用。您首先“重新附加”实体。

使用 get 也可以工作，除非你得到继承映射（这已经在 getId() 上抛出异常）。

```
entity = session.get(entity.getClass(), entity.getId()); 
```

* * *

## 回答 #6

> 赞同：10
> 
> 时间：2012-12-15T14:43:13.550

我回到 JavaDoc`org.hibernate.Session`并发现以下内容：

> 瞬态实例可以通过调用`save()`或`persist()`来 持久化`saveOrUpdate()`。持久实例可以通过调用`delete()`. `get()`or`load()`方法返回的任何实例都是持久的。可以通过调用 、 或 使分离的实例`update()`持久`saveOrUpdate()`化。瞬态或分离实例的状态也可以通过调用.`lock()``replicate()``merge()`

因此`update()`, `saveOrUpdate()`, `lock()`,`replicate()`和`merge()`是候选选项。

`update()`：如果存在具有相同标识符的持久实例，将抛出异常。

`saveOrUpdate()`: 保存或更新

`lock()`: 已弃用

`replicate()`：保持给定分离实例的状态，重用当前标识符值。

`merge()`：返回具有相同标识符的持久对象。给定的实例不会与会话关联。

因此，`lock()`不应直接使用，并且可以根据功能要求选择其中的一个或多个。

* * *

## 回答 #7

> 赞同：7
> 
> 时间：2012-08-21T07:02:08.177

我用 NHibernate 在 C# 中这样做了，但它在 Java 中应该以相同的方式工作：

```
public virtual void Attach()
{
    if (!HibernateSessionManager.Instance.GetSession().Contains(this))
    {
        ISession session = HibernateSessionManager.Instance.GetSession();
        using (ITransaction t = session.BeginTransaction())
        {
            session.Lock(this, NHibernate.LockMode.None);
            t.Commit();
        }
    }
} 
```

对每个对象都调用了 First Lock，因为 Contains 始终为 false。问题是 NHibernate 按数据库 id 和类型比较对象。Contains 使用该`equals`方法，如果没有被覆盖，该方法通过引用进行比较。使用该`equals`方法，它可以正常工作，没有任何异常：

```
public override bool Equals(object obj)
{
    if (this == obj) { 
        return true;
    } 
    if (GetType() != obj.GetType()) {
        return false;
    }
    if (Id != ((BaseObject)obj).Id)
    {
        return false;
    }
    return true;
} 
```

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2014-07-15T00:06:58.197

`Session.contains(Object obj)`检查引用并且不会检测到表示同一行且已附加到该行的不同实例。

这是我对具有标识符属性的实体的通用解决方案。

```
public static void update(final Session session, final Object entity)
{
    // if the given instance is in session, nothing to do
    if (session.contains(entity))
        return;

    // check if there is already a different attached instance representing the same row
    final ClassMetadata classMetadata = session.getSessionFactory().getClassMetadata(entity.getClass());
    final Serializable identifier = classMetadata.getIdentifier(entity, (SessionImplementor) session);

    final Object sessionEntity = session.load(entity.getClass(), identifier);
    // override changes, last call to update wins
    if (sessionEntity != null)
        session.evict(sessionEntity);
    session.update(entity);
} 
```

*这是我喜欢的 .Net EntityFramework 的少数几个方面之一，关于更改的实体及其属性的不同附加选项。*

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2012-05-17T20:52:26.720

我想出了一个解决方案来“刷新”持久存储中的一个对象，该对象将解释可能已经附加到会话的其他对象：

```
public void refreshDetached(T entity, Long id)
{
    // Check for any OTHER instances already attached to the session since
    // refresh will not work if there are any.
    T attached = (T) session.load(getPersistentClass(), id);
    if (attached != entity)
    {
        session.evict(attached);
        session.lock(entity, LockMode.NONE);
    }
    session.refresh(entity);
} 
```

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2013-11-24T06:44:17.257

抱歉，似乎无法添加评论（还没有？）。

使用 Hibernate 3.5.0-Final

尽管该`Session#lock`方法已弃用，但 javadoc*确实*建议使用`Session#buildLockRequest(LockOptions)#lock(entity)`，并且如果您确保关联具有`cascade=lock`，则延迟加载也不是问题。

所以，我的附加方法看起来有点像

```
MyEntity attach(MyEntity entity) {
    if(getSession().contains(entity)) return entity;
    getSession().buildLockRequest(LockOptions.NONE).lock(entity);
    return entity; 
```

初步测试表明它是一种享受。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2015-10-25T18:15:48.997

也许它在 Eclipselink 上的行为略有不同。为了在不获取陈旧数据的情况下重新附加分离的对象，我通常会这样做：

```
Object obj = em.find(obj.getClass(), id); 
```

作为可选的第二步（使缓存失效）：

```
em.refresh(obj) 
```

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2009-05-28T05:58:48.397

尝试 getHibernateTemplate().replicate(entity,ReplicationMode.LATEST_VERSION)

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2011-02-24T18:17:19.440

`update(obj)`在原始帖子中，有两种方法`merge(obj)`被提到可以工作，但在相反的情况下。如果真的是这样，那为什么不先测试一下对象是否已经在会话中，`update(obj)`如果是则调用，否则调用`merge(obj)`。

会话中存在的测试是`session.contains(obj)`。因此，我认为以下伪代码会起作用：

```
if (session.contains(obj))
{
    session.update(obj);
}
else 
{
    session.merge(obj);
} 
```

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2016-10-19T13:43:18.043

要重新附加此对象，您必须使用 merge();

此方法在参数中接受您的实体分离并返回一个实体将被附加并从数据库重新加载。

```
Example :
    Lot objAttach = em.merge(oldObjDetached);
    objAttach.setEtat(...);
    em.persist(objAttach); 
```

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2011-01-05T16:45:41.887

调用第一个 merge() （更新持久实例），然后调用 lock(LockMode.NONE) （附加当前实例，而不是 merge() 返回的实例）似乎适用于某些用例。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2019-12-11T11:44:07.680

财产`hibernate.allow_refresh_detached_entity`为我做了伎俩。但这是一个通用规则，所以如果你只想在某些情况下这样做，它不是很合适。我希望它有所帮助。

在休眠 5.4.9 上测试

[SessionFactoryOptionsBuilder](https://github.com/hibernate/hibernate-orm/blob/master/hibernate-core/src/main/java/org/hibernate/boot/internal/SessionFactoryOptionsBuilder.java)

* * *

## 回答 #17

> 赞同：-1
> 
> 时间：2019-11-01T03:06:35.000

Hibernate 支持通过多种方式重新附加分离的实体，请参阅[Hibernate 用户指南](https://docs.jboss.org/hibernate/orm/5.4/userguide/html_single/Hibernate_User_Guide.html#pc-detach-reattach)。

* * *

## 回答 #18

> 赞同：-6
> 
> 时间：2009-05-26T21:01:15.637

```
try getHibernateTemplate().saveOrUpdate() 
```

# c++ - 根据项目的调试/发布状态两次定义简单的内联方法是否有好处？

> ID：912660
> 
> 赞同：0
> 
> 时间：2009-05-26T20:44:27.543
> 
> 标签：c++, optimization, class-design

我一直想知道，两次定义琐碎的方法是好还是坏的做法，这取决于
项目是否处于调试/发布状态。这是为了内联它们。例如，Foo.h：

```
 class Foo
{
        public:
                ...

                const bool& IsBoolean() const;

        private:
                bool _boolean;
};

#ifndef _DEBUG

/** We're in release, so let's advice compiler to inline this...
  *
  *
  */

inline const bool& Foo::IsBoolean() const
{
        return _boolean;
}

#endif 
```

现在，在 Foo.cpp 中：

```
 #include "Foo.h"

...

#ifdef _DEBUG

/** We're debugging this, no need for inlining...
  *
  *
  */

const bool& Foo::IsBoolean() const
{
        return _boolean;
}

#endif 
```

这完全没用吗？例如，由于编译器（MSVC）本身内联/优化方法的能力？

尽管如此，这是我多年来一直在使用的东西。请纠正我，如果我在这里完全错了......

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-26T20:57:37.423

这是浪费时间，有几个原因。

inline 关键字是编译器可以随意忽略的*提示。*就像即使没有指定关键字也可以自由内联。因此，无论您是否添加它都可能不会改变编译器的任何内容

此外，在类定义中定义的任何函数都是隐式内联的。这就是为什么像 getter 和 setter 这样的短函数几乎总是在类定义中定义。

接下来，如果您想将函数标记为内联，也没有理由不在调试版本中执行此操作。

该`inline`关键字几乎与编译器实际上内联函数无关。它们是不同的概念。程序员标记`inline`的函数意味着链接器在看到多个相同的定义时不必担心。如果函数在标头中定义，通常会发生这种情况，该标头包含在多个编译单元中。如果函数被标记为内联，链接器会将定义合并在一起。如果不是，则会出现错误。换句话说，添加和删除此关键字将导致编译器错误。这可能不是你想要的。

C++ 关键字和编译器优化之间有一点重叠的唯一原因`inline`是，如果一个函数被标记`inline`，那么在每个编译单元中 #include 它是安全的，这意味着当函数被调用时定义总是可见的. 这使得*编译*器更容易内联对函数的调用。

最后，内联并不总是一种性能改进。很容易造成这样的情况：内联只会使代码大小爆炸，导致更多的缓存未命中，并且总体上会减慢代码的速度。`inline`这就是优化器（充其量）将其视为提示的原因之一。在最坏的情况下，它会被完全忽略。

因此，您所做的将 1）在调试模式下导致发布版本中不存在的编译器错误，以及 2）对性能没有影响。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-26T20:48:03.463

看起来像浪费空间和不必要的代码重复。通常，编译器非常有能力自行确定哪些函数需要内联，哪些不能。如果您使用的是具有`/LTCG`（链接时间代码生成）开关的 MSVC，则更是如此，这意味着您的琐碎方法即使在 cpp 中也会被内联。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-26T20:47:53.573

重复是不好的。即使你正在处理一个脑残的编译器，你也可以很容易地避免这种重复，最坏的情况是，通过使用**在一个地方**`INLINE`定义的宏来要么要么不做，要么什么都不做。**`inline`**

 *** * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-26T20:53:02.020

做你想做的最简单的事情是将代码放入它自己的文件*filename.inl*中，然后有条件地将文件包含到头文件或源文件中。您还应该为*.inl*文件中的函数添加一个条件宏前缀，如果文件包含在标题中，则该条件宏扩展为*内联*，否则为空宏。

# c# - 将文件名传递给方法时，我应该使用 FileInfo 还是纯文件名？

> ID：912662
> 
> 赞同：12
> 
> 时间：2009-05-26T20:45:19.663
> 
> 标签：c#, fileinfo

好吧，标题说明了一切。将文件名传递给方法时，我应该使用 FileInfo 对象还是纯文件名（字符串）？为什么我更喜欢其中之一？

我的一些同事喜欢这样写方法：

*   无效导出（文件信息文件信息）

是否优于：

*   无效导出（字符串文件名）

谢谢！

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-05-26T20:48:44.010

我通常只使用`string`- 在大多数情况下更简单。否则，您很可能首先`FileInfo`从字符串创建一个新的。

如果您正在创建该方法，则始终可以提供重载以允许两者。

当然，如果你知道你打算在哪里调用它，你通常*有*a`FileInfo`而不是 a `string`，那是另一回事。

我可以看到您同事的观点-在某些方面， a`FileInfo`是表达参数的“更干净”的方式。我认为这`string`是更务实的方法:)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-05-26T20:50:34.287

通常我会传递字符串。**但是，您可以重载该方法以使每个人都开心。**

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-05-26T20:52:34.937

不同之处主要在于进行了一些检查。FileInfo 构造函数对 null 或明显无效的参数进行一些检查。它还有其他一些功能；采用 FileInfo 基本上只是将处理来自 FileInfo 构造函数的异常的责任放在调用代码上，而不是您的代码。

这是 FileInfo 构造函数的 MSDN 参考，它显示了构造函数可以抛出的内容：

[http://msdn.microsoft.com/en-us/library/system.io.fileinfo.fileinfo.aspx](http://msdn.microsoft.com/en-us/library/system.io.fileinfo.fileinfo.aspx)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-26T20:48:52.417

我会说这取决于:) File 类上的许多静态文件操作允许使用文件名进行许多操作。File 的抽象在 .NET Framework 中并不经常有用，因此我倾向于使用字符串并在参数名称中表示它是什么。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-26T20:57:29.420

如果您正在编写涉及这些同事的代码，我会使用 FileInfo。这实际上并不重要，但按照其他人期望的方式编写代码会减少维护，提高一致性，并且通常会让人们开心。

`FileInfo`正如 McWafflestix 所指出的，我会指出，我不喜欢为了检查调用函数的有效性而使用的想法。如果调用函数和被调用函数之间出现中断，则不会被捕获。如果您使用字符串，它不一定会被捕获......但至少它清楚地表明问题可能发生在哪里。无论如何，您都希望在被调用的方法中捕获此类异常。当然，在您使用实际功能之前，您不会打开文件并开始读/写（如果您是，FileInfo 和 string 可能都是错误的选择，但 Stream 是有意义的，正如 TheSean 建议的那样）。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-05-26T21:01:14.343

FileInfo 确实比字符串更能显示数据类型的意图。这几乎总是一件好事。但是，当然有很多将文件名作为字符串传递的先例，包括大多数 .NET 框架本身。文件名是一个字符串。大概，您会让调用者使用 FileInfo 对象来强制调用代码验证文件名（即处理异常），而不是让自己负担传回异常的负担。

当然，只要您验证传入的文件名，包括方法重载就可以消除所有疑问。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-05-26T20:49:28.483

我认为如果它正在做同样的事情，文件名就足够了。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-05-30T11:38:52.370

1.  字符串不是 PATH。所以字符串不是表示路径的最佳方式。
2.  FileInfo 也不是 PATH，语义上它代表 FILE。

因此，如果 MS 将提供 Path 对象会更好：) 或者您可以自己制作，特别是如果这是您的内部代码。通过这种方式，您无需在每次使用 PATH 参数时检查它们。我经常有很多表示不同字符串的结构，NonNullString、IdString（不区分大小写），我相信这使代码变得简单。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-05-26T20:55:40.407

我会遵循使用 Steam 的惯例。这就是我看到大多数 I/O 执行的方式。对于我，这说得通：

```
void Export(string s) 
{ 
  Stream fs = new FileStream(s); //think this is correct
  Export(fs); 
}
void Export(Stream s) 
{
  s.Write ( ... );
  ...
} 
```

我同意，FileInfo 对我来说从未如此有用。坚持使用字符串或使用流，可以是 FileStream、MemoryStream 等。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-05-26T21:09:12.283

像往常一样，这取决于。除了最基本的情况外，我想说的是，使用 FileInfo 会给您带来很多好处，而且几乎没有负面影响。严格的 OO 教条会说有关文件的信息（路径、创建日期、修改日期等）应该封装在 FileInfo 之类的类中。如果您需要更复杂的行为，这将为您提供更大的灵活性。如果您针对 FileInfo 编写代码，如果您需要进行更改，它几乎总是更干净且不易出错。

如果您绝对想不出需要更复杂行为的场景，并且它真的会让您失望，那么请继续使用字符串。

# php - 是否可以解码由 zend 保护编码的文件？

> ID：912668
> 
> 赞同：1
> 
> 时间：2009-05-26T20:45:58.117
> 
> 标签：php, zend-guard

我一直在寻找 php 编码器并找到了一个 zend 保护措施。我用谷歌搜索了安全防护，发现有很多用于 zend 安全防护的解码器。

Zend 告诉我不可能解码 zend 编码的文件，但互联网上的用户不同意。

我似乎无法为我的情况找到明确的答案。

你们有什么感想？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-26T20:49:27.143

简而言之，必须对其进行解码才能运行它。在某些时候，加密数据在正常操作期间被解密为 PHP 字节码，这意味着有人可以捕获该字节码并将其存储，但未加密。

但是，可能无法通过反编译 .exe 文件来检索原始 PHP 源代码，就像您无法获取原始 C++ 代码、注释等一样。

所以，最后，对于“解码”的具体含义，双方都是对的。

而像 Zend Guard 这样的工具永远不会阻止坚定的攻击者，这使得它们的价值值得怀疑。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-31T13:59:12.080

可以将源代码解码回有效的 PHP，那里有一些信誉不佳的服务..

然而，不编码你的源代码通常可以正常工作，因为它允许人们破解他们自己的代码来制作一个稍微定制的版本

# design-patterns - 域类中的 HTML 格式

> ID：912669
> 
> 赞同：2
> 
> 时间：2009-05-26T20:46:06.027
> 
> 标签：design-patterns, architecture, domain-driven-design

我的域中有一个简单的地址对象，它有一个`ToString()`返回地址的方法，如下所示：

123 Test Ave
Appt 1A
斯波坎, WA 99201

我们将在几个不同的场合在网页中显示它，因此在某处添加功能以显示具有 Html 格式的地址是有意义的，但是当我想向`ToStringHtmlFormat()`我的域类添加一个时，它开始闻起来很有趣。

我可能有点挑剔，但是您建议在哪里或如何完成此操作以使我的域类没有任何 Html 内容？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-26T20:53:10.020

您可以拥有一个能够“访问”域类并打印出内容的 HTMLWriter。然后，您的域类需要一个 Accept 方法来接受访问者（访问者模式）。

在灵活性和可维护性方面，尽管我会选择一些包含您的 HTML 和访问您想要打印出来的属性的模板引擎。通常更复杂的网站还会引入一种称为 ViewModel 的东西，它准备以一种 UI HTML 引擎可以轻松访问的方式显示数据。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-31T16:06:10.247

您可以添加一个扩展方法：

```
public static class AddressHelpers
{
  public static string ToStringHtmlFormat (this Address address)
  {
      string result = address.Address1;
      // snip..
      return result;
  }
} 
```

现在您可以控制扩展方法何时何地包含在您的项目中（例如：仅在您的 Web 应用程序中）。

# php - 在 Emacs 中编辑 PHP 的好设置是什么？

> ID：912671
> 
> 赞同：39
> 
> 时间：2009-05-26T20:46:40.877
> 
> 标签：php, emacs, editor, autocomplete

今年夏天我将为我的工作做一些 PHP 编辑，并且正在寻找一个有效的 Emacs 设置来编辑它。我已经在 Emacs 上投入了大量资金，因此不值得切换到另一个编辑器。

现在，我有[nXhtml-mode](http://ourcomments.org/Emacs/nXhtml/doc/nxhtml.html)，它提供了一个带有语法高亮的 PHP 模式（至少有三种不同的模式），以及用于编辑嵌入在 HTML 中的 PHP 的 MuMaMo。我刚刚开始分别使用[Auto-Complete](http://www.emacswiki.org/emacs/AutoComplete)和[任何东西](http://www.emacswiki.org/emacs/Anything)来进行编程和一般的 Emacs 东西。

我真正在寻找的是一种让 Emacs 真正理解项目的有效方法，而不仅仅是突出显示。[Etags](http://www.emacswiki.org/emacs/EmacsTags)看起来是一个不错的选择，但看起来生成新标签的过程有点费力和手动（或者至少不是隐形的）。Etags 的好处是它们与任何东西和自动完成都很好地集成在一起。其他可能的选项是[gtags](http://www.emacswiki.org/emacs/GnuGlobal)（虽然我对安装非 elisp 文件犹豫不决，只是为了复杂性）、[vtags](http://www.emacswiki.org/cgi-bin/wiki/VTags)或[Semantic](http://www.emacswiki.org/emacs/SemanticBovinator)，我以前搞砸过，设置起来似乎很复杂，而且看起来不像它支持 PHP。

另一个选项是[Imenu](http://www.emacswiki.org/emacs/ImenuMode)，但它只适用于当前缓冲区，我希望能够跳转到其他文件中的函数定义（最好使用任何东西来完成名称）。

我将从事的项目并没有那么大（总共大约 30,000 行），所以 Etags 的开销可能不会是那么大的问题，但如果有更好的解决方案，我宁愿不使用它。

那么您首选的 PHP 编辑系统是什么？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2009-05-28T05:39:12.593

除了您已经熟悉的功能外，我建议您进行以下操作。

### 电子标签

我不使用 ETags，但是关于 SO *[How to programmatically create/update a TAGS file with emacs](https://stackoverflow.com/questions/548414/how-to-programmatically-create-update-a-tags-file-with-emacs)*已经有一个问题。不过，没有发布好的答案，但这可能是一个很好的切入点。

### 调试

[Flymake](http://www.emacswiki.org/emacs/FlyMake)是一种进行动态语法检查的模式。它也支持 PHP。它会在您键入时立即提示语法错误。Emacs 23 附带的 Flymake 版本包含 PHP 支持。如果您有以前的版本，请查看 Sacha Chua 在*[Emacs 和 PHP 上的帖子：使用 Flymake 进行动态语法检查](http://sachachua.com/wp/2008/07/31/emacs-and-php-on-the-fly-syntax-checking-with-flymake/)*。

另一个有用的包是[Geben](http://code.google.com/p/geben-on-emacs/)，它允许您以交互方式调试脚本。对于 PHP，您可以使用 XDebug。有一个关于如何做到这一点的详细教程，请参阅*[Debug php in emacs with geben](http://blog.local.ch/archive/2008/08/08/debug-php-in-emacs-with-geben.html)*。

### 文档查找

`M-x php-search-documentation`PHP 模式有一个很好的功能，可以在您的 Web 浏览器 (或`C-c C-f`)中查找 PHP 手册中的函数定义。您可以将它与[Emacs-W3M](http://emacs-w3m.namazu.org/)结合使用，无需离开 Emacs 即可获得相关的手册页。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2014-09-17T08:39:01.733

web-model.el（可在[web-mode.org](http://web-mode.org)上获得）可以很好地处理嵌入在 html 文档中的 php 块。这个主要模式也会突出显示 js 和 css 部分。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2010-08-15T17:14:12.073

作为 ETags 的替代方案，请考虑 GNU Global，又名“GTags”。Global 在查找标签表方面要聪明得多，并且更新速度相当快。Emacs-fu 有一篇关于[即时执行此操作](http://emacs-fu.blogspot.com/2009/01/navigating-through-source-code-using.html)的好文章。

顺便说一句，如果您在 Windows Emacs 构建中使用 GNU Global 的 Windows 端口，请使用 DJGPP（“DOS”）版本。MinGW（“Win32”）构建似乎有路径名问题。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2021-05-08T18:26:20.540

除了 09 年 5 月 28 日给出的答案之外，我想我可以添加一些包来增强我在 Emacs 上的 PHP 体验。

## 自动完成

[ac-php](https://github.com/xcwen/ac-php)在我看来是对 Etags 的一个很好的补充。所有对标签的引用都可以用 etags 找到，但定义用 ac-php。ac-php 也可配置为应包含哪些目录。例如，在开发 wordpress 插件时，您可以添加对包含 wordpress 文件的目录`.ac-php-conf.json`（位于项目根目录中）的引用，它会自动完成、跳转到引用等。这个包支持`company-mode`和`auto-complete`.

这是 ac-php 的示例配置：

```
(use-package ac-php
  :ensure t
  :bind (:map
         php-mode-map
         ("M-+" . ac-php-find-symbol-at-point)
         ("M-]" . ac-php-location-stack-back)
         ("<menu> r" . ac-php-remake-tags)
         ("<menu> R" . ac-php-remake-tags-all))) 
```

另一种选择是使用[phpactor](https://phpactor.readthedocs.io/en/master/)，但 Emacs 接口在撰写本文时仍处于 alpha 阶段，我也几乎没有任何经验 - 除了构造函数完成，它工作得很好。

## 错误检查

除了语法错误，Flycheck 还支持开箱即用的[phpMessDetector](https://github.com/phpmd/phpmd)和[phpCodeSniffer](https://github.com/squizlabs/PHP_CodeSniffer)。这使您能够根据支持的编码标准和最佳实践获得更多增强的通知/警告/错误报告。

我喜欢用于静态分析的另一个包是[PHPStan Emacs interface](https://github.com/emacs-php/phpstan.el)，它报告代码中的潜在错误（包括不正确的类型提示）。

### 附加格式

我也使用[phpcbf](https://github.com/nishimaki10/emacs-phpcbf)（显然已存档）。此包将缓冲区格式化为所需的编码标准。

## 语义

对于任何不了解的人来说，Semantic 是一个内置的 Emacs 包，并提供类似 IDE 的功能。这是一个如何为 php-mode 包含语义的示例：

```
(add-hook 'php-mode-hook (lambda ()
                           (require 'semantic/symref/grep)
                           (add-to-list 'semantic-symref-filepattern-alist '(php-mode "*.php" "*.inc"))
                           (semantic-mode))) 
```

### 菜单

对于包含 imenu 跳转到定义，另一个示例配置：

这是用于跳转到**文件内**方法和函数的侧边栏。

```
(use-package imenu-list
  :ensure t
  :config
  (setq imenu-list-focus-after-activation t)
  :bind (:map php-map
         ("<menu> \\" . imenu-list-smart-toggle))) 
```

helm 支持跳转到**所有项目文件中的定义的**示例配置：

```
(use-package imenu-anywhere
  :ensure t
  :after helm
  :bind (:map php-map
         ("<menu> |" . helm-imenu-anywhere))) 
```

## 附加调试

除了 geben，我还喜欢使用[psysh](https://github.com/emacs-php/psysh.el)，它通过`eval(\Psy\sh());`插入在该代码行上给出一个 repl 并允许访问所有定义以及任何其他人可以访问的内容（当然，在 composer 中要求它之后）。

## 更一般的方便的包

### 片段

对于已经使用过 Emacs 的每个人来说，这可能有点明显，但是[yasnippet](https://github.com/joaotavora/yasnippet)对于编写自己的模板也非常方便。还有一些包包含许多针对各种语言的预定义模板，但我自己编写以使 Emacs 比我的设置不那么臃肿，这也有助于我更容易记住它们。

### 项目管理

再次原谅显而易见，但 Projectile 也是一个非常好的包，默认情况下包括 git 支持来确定项目的范围。

### 离线文档

如果您使用 Zeal 进行离线文档浏览，还有`zeal-at-point`. 示例配置，如果您使用，可以说：PHP、CodeIgniter 和 WordPress：

```
(use-package zeal-at-point
  :ensure t
  :bind (("<menu> z" . zeal-at-point))
  :config
  (add-to-list 'zeal-at-point-mode-alist '(php-mode . ("codeigniter" "wordpress" "php")))) 
```

# iphone - 旋转时防止 iPhone 缩放

> ID：912681
> 
> 赞同：6
> 
> 时间：2009-05-26T20:48:19.190
> 
> 标签：iphone, mobile-safari

当我将 iPhone 旋转到横向模式时，iPhone 会自动增大文本大小。

防止这种情况的最佳方法是什么？我想旋转给访问者更多的文本来阅读，而不是更大的字体。[像这样](http://www.iphonemicrosites.com/articles/6-tips-to-optimize-your-current-site-for-the-iphone/)的JavaScript是唯一的出路吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-05-26T21:10:15.493

你可以使用这个 CSS 属性

```
-webkit-text-size-adjust: none; 
```

# javascript - 如何将事件从 VB.Net ClassLibrary/UserControl (ActiveX) 引发到 JavaScript？

> ID：912683
> 
> 赞同：3
> 
> 时间：2009-05-26T20:48:35.040
> 
> 标签：javascript, vb.net, events, activex, user-controls

我创建了一个带有 UserControl 的 VB.Net ClassLibrary。我可以从 HTML 页面加载它并调用我创建的方法。这按预期工作。我已经尝试了几个如何从 VB 代码向 js 调用者引发事件的示例，但它们似乎都不起作用（我使用的是 IE7）。

我在做什么：

```
Public Class ctrlABC
   Public Event TestEvent() 
```

然后当我想引发这个事件时，我调用：

```
RaiseEvent TestEvent() 
```

在我的 JS 文件中，我尝试了以下操作：

```
<OBJECT id="myControl1" name="myControl1" classid="ABC.dll#ABC.ctrlABC" width=400 height=400></OBJECT>

<SCRIPT LANGUAGE=javascript FOR=myControl1 EVENT=TestEvent> 
    myControl1_TestEvent()  
</SCRIPT>

<script>
function myControl1_TestEvent(){
    alert("raised");
}
</script> 
```

================== 然后我尝试了===================

```
<OBJECT id="myControl1" name="myControl1" classid="ABC.dll#ABC.ctrlABC" width=400 height=400></OBJECT>

<script>
function myControl1::TestEvent(){
    alert("raised");
}
</script> 
```

============================

但似乎都没有得到这个事件。有没有人有任何想法？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-11-23T02:05:10.117

我没有像那样使用 <object>，所以我不能确定，但​​我希望你像 Javascript 中的常规事件一样声明事件处理程序。

在元素属性中：

`<object id="myControl1" .... onTestEvent="functionName"></object>`

或作为对象中的函数：（可能不是正确的术语）

`document.getElementById("myControl1").onTestEvent = functionName`

或使用事件注册功能： `document.getElementById("myControl1").addEventListener("TestEvent", functionName, false);`

（这些是特定于浏览器的，这个是针对 Firefox 的，其他的不确定）

这些“functionName”中的每一个都是您在 <head> 中声明的函数。

可能想看看[Quirksmode - 高级活动注册](http://www.quirksmode.org/js/events_advanced.html)

# apache-flex - flex datagrid 在检索数据时冻结

> ID：912684
> 
> 赞同：0
> 
> 时间：2009-05-26T20:48:36.723
> 
> 标签：apache-flex, datagrid

我有一个数据网格，它的大小取决于对我的数据库的调用结果。对数据库的调用返回一个对象，每行有 30 多个值。当返回的行数超过大约 80-90 时，数据网格呈现奇数。它可以很好地显示前 50-60 行，但随后会显示空白行，它们甚至会继续显示在数据网格的边框之外。

有人知道发生了什么吗？我使用 mxml webservice 来检索数据。

```
<mx:DataGrid dataProvider="{resultsData}" rowCount="{resultsData.length}" allowDragSelection="false" 
    id = "confRoomLookupResults" width="948" 
    variableRowHeight="true" draggableColumns="false" wordWrap="true" resizableColumns="false"  
    borderColor="#E0E3E5" borderStyle="inset" x="10" top="35" 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-26T21:52:17.173

您希望将行数设置为返回数据的长度是否有特定的原因？

如果您只是尝试将数据网格的高度设置为 100%，这将用数据网格填充可视区域，并且任何行溢出都会导致出现垂直滚动条。

希望这可以帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-27T00:14:16.403

[Flash 电影 ( http://kb2.adobe.com/cps/144/tn_14437.html](http://kb2.adobe.com/cps/144/tn_14437.html) )的尺寸限制为 2880 像素。也许您的数据网格超出了这些限制，导致呈现错误。是否有任何异常被抛出？

无论如何，我都会接受 JustFoo 的建议，只使用滚动条。这是有道理的，因为 flash 只需要渲染可见的内容，这对客户端来说将是一个很大的性能提升。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-27T02:35:26.180

听起来有两个问题：

1) rowCount 超出了数据网格的可视区域的显示范围。

2）似乎您使用的是数组而不是自定义对象，因此对数组的更改（例如长度）将不明显......

来自 Adob​​e 网站： http://livedocs.adobe.com/flex/3/html/help.html?content= [about_dataproviders_2.html](http://livedocs.adobe.com/flex/3/html/help.html?content=about_dataproviders_2.html)

如果您使用原始数据对象（例如数组）作为控件的数据提供者，Flex 会自动将对象包装在集合包装器中。该控件不会自动检测直接对原始对象所做的更改。例如，数组长度的变化不会导致控件的更新。但是，您可以使用对象代理、侦听器接口或 itemUpdated 属性来通知视图某些更改。

# iphone - 如何在应用委托之外监听 didRegisterForRemoteNotificationsWithDeviceToken

> ID：912701
> 
> 赞同：2
> 
> 时间：2009-05-26T20:51:45.873
> 
> 标签：iphone, objective-c, uikit

我希望我的对象在 DeviceToken 可用时接收通知。有没有办法只将 UIApplication 中的某些功能委托给我的班级？

更新：

我对从应用程序委托访问它不太感兴趣，我已经有一个应用程序委托，但是如果可能的话，我想通过回调或一些观察者方法来响应事件。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-27T10:45:30.547

尽管在文档中没有这样标记，但*所有* `UIApplicationDelegate`方法都是可选的，因此您可以简单地实现您需要的方法，而忽略不需要的方法。

但是，您可能希望实现所有三种 APS 方法，而不仅仅是指示注册成功的方法！

# web-services - 如何让 QA 测试我的 Web 服务而不是强迫我测试他们的 Web 服务客户端？

> ID：912710
> 
> 赞同：2
> 
> 时间：2009-05-26T20:53:19.117
> 
> 标签：web-services, qa

我在许多 Web 服务上工作，几乎每次我生成主要版本时，QA 都会开始抛出错误，我经常发现这些错误与服务器端代码无关，而是与他们的垃圾客户端库有关。我已经尝试至少制定政策，即他们不会在没有他们推送到服务器的 XML 的情况下提交错误，但他们经常忽略这个要求。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-26T20:57:13.587

这可能更多地与您的工作政策和程序有关，而不是与编程有关。

但在最简单的形式中，举证责任在 QA 身上，在被证明有罪之前，你是无辜的。如果 QA 向您抛出错误，他们应该使用最大的可用数据这样做，证明确实存在错误，而不仅仅是他们一方的一些假阴性。任何低于这一点的都是他们缺乏专业精神。

您应该制定政策并遵守这些政策，以确保尽可能减少浪费的时间。你调试他们的测试是**不可接受**的，这也不是你的工作。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-26T20:56:15.087

这个问题可能会在更广泛的概括下提出

*“我怎样才能让我的同事做好他们的工作？”*

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-05-26T21:14:12.960

记录、记录、准备您的案件。您会记录他们出错的次数、诊断问题所花费的时间以及他们解决问题所花费的时间。然后您将问题上报给管理层：在过去的 5 个工作日中，我不得不总共分配 15 个小时来诊断问题 X、Y 和 Z，这些问题是在没有 QA 考虑的情况下打开的。他们必须在测试中检查 A、B 和 C 以缓解问题。这是他们之前发送的 XML，这是之后的 XML。与任何公司丛林一样，记录您的投诉：一个人的日常收入受到威胁，他会反击您。QA 人比你有更多的松懈，所以他会更加努力。你必须能够证明你的主张。要么 QA 修复他们的态度，要么你有额外的时间来修复他们的烂摊子，

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-26T21:05:50.230

也许他们只能通过客户端访问您的 Web 服务。如果你向他们展示了一些工具，比如soapUI，并让他们使用这些工具直接测试你的服务呢？

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-26T21:32:25.107

将其标记为“不会修复 - 不是错误”并将其扔回 QA。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-26T21:10:13.590

处理此类问题的标准方法是**升级**。向上级报告问题给*他们的*上级。确保你有很好的案例描述和论据，为什么他们需要改变他们的方法。

由于升级级别的人很可能是很少/没有编程经验的经理，所以用“商业语言”写下你的论点：*增值*、*收入损失*、*潜在节省*（我最喜欢的！）等。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-11-03T22:28:52.877

两个不同的东西。
第一个 QA 应该在错误报告中包含 XML。他们知道的任何相关信息都应该在错误报告中。如果需要，请按照其他人的建议将其升级。

第二件事，如果他们的客户有问题，请检查用户是否将使用相同的库。如果不要求 QA 更改他们检查服务的客户端/库/方式。如果询问无助于升级显示它花费了多少时间和金钱。如果是，您需要弄清楚如何使您的服务与该库一起使用。

可能需要这种或另一种升级。

# javascript - JQuery动态加载Javascript文件

> ID：912711
> 
> 赞同：138
> 
> 时间：2009-05-26T20:53:36.743
> 
> 标签：javascript, jquery, jquery-plugins, tinymce, lazy-loading

我有一个非常大的 javascript 文件，我只想在用户单击某个按钮时才加载。我使用 jQuery 作为我的框架。是否有内置方法或插件可以帮助我做到这一点？

更多细节：我有一个“添加评论”按钮，它应该加载 TinyMCE javascript 文件（我已将所有 TinyMCE 内容归结为一个 JS 文件），然后调用 tinyMCE.init(...)。

我不想在初始页面加载时加载它，因为不是每个人都会点击“添加评论”。

我知道我可以这样做：

```
$("#addComment").click(function(e) { document.write("<script...") }); 
```

但有更好/封装的方式吗？

* * *

## 回答 #1

> 赞同：204
> 
> 时间：2009-05-26T20:54:32.763

是的，使用[getScript](http://api.jquery.com/jQuery.getScript)而不是 document.write - 一旦文件加载，它甚至允许回调。

不过，您可能希望在包含 TinyMCE 之前检查是否定义了它（用于后续调用“添加评论”），因此代码可能如下所示：

```
$('#add_comment').click(function() {
    if(typeof TinyMCE == "undefined") {
        $.getScript('tinymce.js', function() {
            TinyMCE.init();
        });
    }
}); 
```

假设你只需要调用`init`一次，就是这样。如果没有，你可以从这里弄清楚:)

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2014-05-02T19:30:15.133

我意识到我在这里有点晚了（5年左右），但我认为有一个比公认的更好的答案，如下所示：

```
$("#addComment").click(function() {
    if(typeof TinyMCE === "undefined") {
        $.ajax({
            url: "tinymce.js",
            dataType: "script",
            cache: true,
            success: function() {
                TinyMCE.init();
            }
        });
    }
}); 
```

该[`getScript()`](http://api.jquery.com/jQuery.getScript/)功能实际上***可以防止浏览器缓存***。如果您运行跟踪，您将看到脚本加载了一个包含时间戳参数的 URL：

```
http://www.yoursite.com/js/tinymce.js?_=1399055841840 
```

如果用户`#addComment`多次单击链接，`tinymce.js`将从不同时间戳的 URL 重新加载。这违背了浏览器缓存的目的。

===

或者，在[`getScript()`](http://api.jquery.com/jQuery.getScript/)文档中有一些示例代码演示了如何通过创建自定义`cachedScript()`函数来启用缓存，如下所示：

```
jQuery.cachedScript = function( url, options ) {

    // Allow user to set any option except for dataType, cache, and url
    options = $.extend( options || {}, {
        dataType: "script",
        cache: true,
        url: url
    });

    // Use $.ajax() since it is more flexible than $.getScript
    // Return the jqXHR object so we can chain callbacks
    return jQuery.ajax( options );
};

// Usage
$.cachedScript( "ajax/test.js" ).done(function( script, textStatus ) {
    console.log( textStatus );
}); 
```

===

或者，如果要全局禁用缓存，可以使用[`ajaxSetup()`](http://api.jquery.com/jQuery.ajaxSetup/)以下方法：

```
$.ajaxSetup({
    cache: true
}); 
```

# .net - 亚音速 MySQL 版本

> ID：912722
> 
> 赞同：0
> 
> 时间：2009-05-26T20:56:16.287
> 
> 标签：.net, mysql, subsonic, mysql-connector

我了解 Subsonic 2.2 需要 MySQL.data 5.2.3 dll。我正在尝试为 Visual Studio 中的 VB 项目集成亚音速 DAL。该项目已经使用了很多数据集。因此，Visual Studio 要求我安装 MySQL NET 连接器软件，它会自动将自己的 MySQL dll 深入到我的系统中。

问题是在我的系统上安装了 MySQl NET 连接器后，我无法在我的项目中包含 MySql.data 5.2.3 dll，因为它抱怨我有同一个 dll 的两个冲突版本。

我能找到安装的最接近的 Net Connector 版本是 5.2.6。亚音速要求 5.2.3。我似乎无法在项目中同时使用两者。我到底该怎么办？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-27T03:20:49.553

您可以尝试使用您在项目中使用的 MySql.dll 从源代码构建 SubSonic。这就是我曾经做过的。

# .net - .NET File.Exists 在 Windows\System32\Drivers 文件夹中不起作用？

> ID：912726
> 
> 赞同：7
> 
> 时间：2009-05-26T20:57:18.797
> 
> 标签：.net, windows-vista, 64-bit, drivers

该过程被提升，我确保在 VS 调试器中路径是正确的（我使用的是 Environment.GetFolderPath(Environment.SpecialFolder.System) 而不是硬编码它），但 File.Exists 仍然返回 false。

我需要这个的原因是确保安装某些 3rd 方驱动程序的解决方法，因为它们的注册表设置在卸载时不会被删除。

我知道写入是通过虚拟化重定向的，但这对于检查文件是否存在也是如此？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-26T21:04:13.807

是的，虚拟化发生在非常低​​的水平。File.Exists 方法基本上调用 Win32 CreateFile 方法并检查错误。CreateFile 由 WOW 子系统重定向。

您可以在调用之前暂时禁用虚拟化。

```
[DllImport( "kernel32", CharSet=CharSet.Unicode, SetLastError=true )]
public static extern bool Wow64DisableWow64FsRedirection( ref IntPtr oldValue );

[DllImport( "kernel32", CharSet=CharSet.Unicode, SetLastError=true )]
public static extern bool Wow64RevertWow64FsRedirection( IntPtr oldValue ); 
```

当然，要完整，您必须在虚拟化打开和关闭的情况下检查文件是否存在。这同样适用于检查注册表项。

```
public static bool FileExists( string path )
{
    if( File.Exists( path ) ) return true;
    IntPtr oldValue = IntPtr.Zero;
    try
    {
        if( Environment.GetEnvironmentVariable( "PROCESSOR_ARCHITEW6432" ) == null )
            return false;

        Wow64DisableWow64FsRedirection( ref oldValue );
        if( File.Exists( path ) ) return true;

        return false;
    }
    finally
    {
        if( oldValue != IntPtr.Zero )
            Wow64RevertWow64FsRedirection( ref oldValue );            
    }   
} 
```

**更新：**您可能还需要在禁用 WOW 重定向之前检查操作系统版本，因为早期版本的 XP（我相信是 Pre SP2）不公开这些方法。

**更新 2：**添加了 64 位操作系统检查。所有 64 位版本的操作系统都实现了这些方法，如果在 64 位操作系统上运行，您只需禁用状态即可。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-26T21:00:56.667

您的进程是 32 位还是 64 位？驱动程序是 64 还是 32？我要说的是，您的主机操作系统可能会将您重定向到 Wow64 文件夹。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-26T21:10:26.790

您是否尝试过为您的应用[禁用文件夹虚拟化？](http://www.codeproject.com/KB/vista-security/MakingAppsUACAware.aspx)您需要添加一个清单文件，其中包含：

```
<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
    <assembly xmlns="urn:schemas-microsoft-com:asm.v1" manifestVersion="1.0">
    <trustInfo xmlns="urn:schemas-microsoft-com:asm.v3">
        <security>
            <requestedPrivileges>
                <requestedExecutionLevel level="asInvoker" uiAccess="false"/>
            </requestedPrivileges>
        </security>
    </trustInfo>
</assembly> 
```

但是，如果您需要写入这些文件夹，则必须[请求管理员](http://msdn.microsoft.com/en-us/library/bb756929.aspx)权限。为此，请在 xml 中更改`level="asInvoker"`为。`level="requireAdministrator"`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-26T21:02:42.467

这是一个虚拟化问题 - 文件不存在。您必须在包含虚拟化文件的文件夹中查找它。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-26T21:03:32.840

如果您有权限，为什么不尝试在代码中的相同位置创建一个文件，然后看看它在哪里结束？正如另一个人所建议的那样，Windows 可能会根据一些设置重定向您的呼叫。

此外，您可以尝试执行 DirectoryInfo 并枚举其中包含的文件，看看是否有任何熟悉的内容。

# c - Eclipse 交叉编译...我该怎么做？

> ID：912735
> 
> 赞同：3
> 
> 时间：2009-05-26T20:59:06.373
> 
> 标签：c, windows, linux, eclipse, cross-compiling

我正在使用 C 代码中的 Eclipse 在 Windows 机器上进行开发。所有文件物理上都位于 Linux 服务器上。我只使用 Eclipse 进行编辑和代码浏览。当我想编译时，我打开一个终端并远程登录到 Linux 服务器，我从中调用一个文件，该文件设置了一些变量并最终调用“make”命令。

服务器很忙..然后我希望能够在本地编译 [然后只需将这些可执行文件 ftp 回 Linux 机器，以便我可以执行它们.. 除非 Eclipse 可以自己做到这一点:)]。 ...知道怎么做吗？我不精通 Eclipse 或操作系统的使用......所以如果你能回答并解释我应该做什么......我真的很感激......

我通过调用服务器上的脚本文件更改了项目属性菜单下的构建命令，我通常调用它来编译...这看起来相当简单......嗯......这太好了，难以置信......当然。 .它没有工作！如果我使用默认的“make”（无法运行程序“make”：启动失败），我会收到此错误......如果我尝试调用我的（无法运行程序“T：\ compile”：启动失败）我用来编译的脚本文件...

谢谢，

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-27T19:33:45.673

您应该看看在[cygwin](http://cygwin.com/)内的 windows 框中运行[crosstool-ng](http://ymorin.is-a-geek.org/dokuwiki/projects/crosstool)设置。然后让eclipse使用那个编译器。这将允许您轻松地为您的目标 Linux 平台进行开发。

这是一些[幻灯片](http://www.appinf.com/download/EclipseEmbeddedLinuxSlides.pdf)

听起来您正在为桌面/服务器平台开发，因此您必须确保使用与服务器相同版本的标准库（libc、libstdc++ 等）设置您的 crosstool-ng。您还需要确保您的 crosstool-ng 也与目标具有相同版本的 gcc。

如果您不想弄乱所有这些设置，您可以随时将 Linux 作为虚拟机安装在您的 Windows 机器上并在其中工作。

# tortoisesvn - Svn Move 不显示在上下文菜单中

> ID：912740
> 
> 赞同：0
> 
> 时间：2009-05-26T21:00:02.643
> 
> 标签：tortoisesvn

我已提交更改并更新，我的目录看起来不错。但是当我右键单击要移动到另一个文件夹的文件时，我会看到除 svn move 之外的所有选项，例如 svn delete 等。我不知道为什么我没有看到移动选项。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-26T21:02:29.987

如果要移动文件，只需右键单击并将文件拖动到新位置即可。当您释放文件时，您将获得一个菜单，您可以从中选择 svn move 和 svn copy。

# c# - 如何从 windows.form 中删除 Cookie？

> ID：912741
> 
> 赞同：24
> 
> 时间：2009-05-26T21:00:10.897
> 
> 标签：c#, cookies, webbrowser-control

我正在使用 C# 编写的 windows.form 应用程序上的 Webbrowser 控件。我想写一个方法，在访问某个站点后从 Webbrowers 控件中删除 cookie。不幸的是，我不知道该怎么做，也没有在互联网上找到很多帮助。

如果有人有实际这样做的经验，而不仅仅是假设的，因为它可能比看起来更棘手，我不知道。

```
int count = webBrowser2.Document.Cookie.Length;
webBrowser2.Document.Cookie.Remove(0,count); 
```

我只是假设上面的代码可以工作，但我想它不会。任何人都可以对这整个饼干的事情有所了解吗？

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2009-08-05T16:24:18.780

如果您启用了 JavaScript，您可以使用此代码片段来清除以清除网络浏览器当前所在站点的 cookie。

```
webBrowser.Navigate("javascript:void((function(){var a,b,c,e,f;f=0;a=document.cookie.split('; ');for(e=0;e<a.length&&a[e];e++){f++;for(b='.'+location.host;b;b=b.replace(/^(?:%5C.|[^%5C.]+)/,'')){for(c=location.pathname;c;c=c.replace(/.$/,'')){document.cookie=(a[e]+'; domain='+b+'; path='+c+'; expires='+new Date((new Date()).getTime()-1e11).toGMTString());}}}})())") 
```

它源自此用于清除 cookie的[书签。](http://ostermiller.org/bookmarklets/cookies.html)

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2016-02-25T14:42:47.177

我从这里修改了解决方案：http: [//mdb-blog.blogspot.ru/2013/02/c-winforms-webbrowser-clear-all-cookies.html](http://mdb-blog.blogspot.ru/2013/02/c-winforms-webbrowser-clear-all-cookies.html)

实际上，您不需要不安全的代码。这是对我有用的助手类：

```
public static class WinInetHelper
{
    public static bool SupressCookiePersist()
    {
        // 3 = INTERNET_SUPPRESS_COOKIE_PERSIST 
        // 81 = INTERNET_OPTION_SUPPRESS_BEHAVIOR
        return SetOption(81, 3);
    }

    public static bool EndBrowserSession()
    {
        // 42 = INTERNET_OPTION_END_BROWSER_SESSION 
        return SetOption(42, null);
    }

    static bool SetOption(int settingCode, int? option)
    {
        IntPtr optionPtr = IntPtr.Zero;
        int size = 0;
        if (option.HasValue)
        {
            size = sizeof (int);
            optionPtr = Marshal.AllocCoTaskMem(size);
            Marshal.WriteInt32(optionPtr, option.Value);
        }

        bool success = InternetSetOption(0, settingCode, optionPtr, size);

        if (optionPtr != IntPtr.Zero) Marshal.Release(optionPtr);
        return success;
    }

    [DllImport("wininet.dll", CharSet = CharSet.Auto, SetLastError = true)]
    private static extern bool InternetSetOption(
        int hInternet,
        int dwOption,
        IntPtr lpBuffer,
        int dwBufferLength
    );
} 
```

您在进程开始时调用 SupressCookiePersist 并在浏览器关闭时调用 EndBrowserSession 以清除 cookie，如下所述： [Facebook 多帐户](https://stackoverflow.com/questions/23206199/facebook-multi-account)

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2013-02-17T14:05:30.523

我找到了一个解决方案，用于删除所有 cookie。在 url 上找到的示例会在应用程序（进程）启动时删除 cookie。

> [http://mdb-blog.blogspot.com/2013/02/c-winforms-webbrowser-clear-all-cookies.html](http://mdb-blog.blogspot.com/2013/02/c-winforms-webbrowser-clear-all-cookies.html)

解决方案是使用[InternetSetOption](http://msdn.microsoft.com/en-us/library/windows/desktop/aa385114%28v=vs.85%29.aspx) 函数宣布 WEBBROWSER 以清除其所有内容。

```
int option = (int)3/* INTERNET_SUPPRESS_COOKIE_PERSIST*/;
int* optionPtr = &option;

bool success = InternetSetOption(0, 81/*INTERNET_OPTION_SUPPRESS_BEHAVIOR*/, new IntPtr(optionPtr), sizeof(int));
if (!success)
{
    MessageBox.Show("Something went wrong !>?");
} 
```

请注意，这只会清除特定 PROCESS 的 cookie，如 MSDN [INTERNET_OPTION_SUPPRESS_BEHAVIOR](http://msdn.microsoft.com/en-us/library/windows/desktop/aa385328%28v=vs.85%29.aspx#INTERNET_OPTION_SUPPRESS_BEHAVIOR)上所写：

> 一个通用选项，用于在整个流程范围内抑制行为。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2016-09-20T16:44:58.060

其他建议答案的变体，不需要不安全的代码或手动编组：

```
 private static void SuppressCookiePersistence()
    {
        int flag = INTERNET_SUPPRESS_COOKIE_PERSIST;
        if (!InternetSetOption(IntPtr.Zero, INTERNET_OPTION_SUPPRESS_BEHAVIOR, ref flag, sizeof(int)))
        {
            var ex = Marshal.GetExceptionForHR(Marshal.GetHRForLastWin32Error());
            throw ex;
        }
    }

    const int INTERNET_OPTION_SUPPRESS_BEHAVIOR = 81;
    const int INTERNET_SUPPRESS_COOKIE_PERSIST = 3;

    [DllImport("wininet.dll", CharSet = CharSet.Auto, SetLastError = true)]
    public static extern bool InternetSetOption(IntPtr hInternet, int dwOption, ref int flag, int dwBufferLength); 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2017-08-14T11:04:29.957

基于 Internet Explorer 的网络浏览器控制，所以当我们删除 IE cookie 时，网络浏览器 cookie 也会被删除。所以通过[这个](https://stackoverflow.com/a/21863770/6899111)答案你可以试试这个：

```
System.Diagnostics.Process.Start("CMD.exe","/C RunDll32.exe InetCpl.cpl,ClearMyTracksByProcess 2"); 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-10-23T08:05:14.020

尝试使用这个：

```
System.IO.File.Delete(Environment.SpecialFolder.Cookies.ToString() + "cookiename"); 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-05-26T21:21:56.297

Webbrowser 控件是否显示页面形成了您作为开发人员无法控制的多个站点，或者您只是使用 Web 浏览器控件查看在您的应用程序中创建的自定义 HTML 页面？

如果是前者，cookie 直接与设置它们的域相关联，因此要删除这些 cookie，您需要监控用户的 cookie 目录并删除任何创建的新 cookie，跟踪现有 cookie 的更改。

如果是后者，您始终可以将 webbrowser 控件发送到自定义页面，该页面使用服务器端脚本（如果在您的应用程序中可用）或 JavaScript 来删除 cookie。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-08-28T08:18:33.047

```
webBrowser.Navigate("javascript:void((function(){var a,b,c,e,f;f=0;a=document.cookie.split('; ');for(e=0;e<a.length&&a[e];e++){f++;for(b='.'+location.host;b;b=b.replace(/^(?:%5C.|[^%5C.]+)/,'')){for(c=location.pathname;c;c=c.replace(/.$/,'')){document.cookie=(a[e]+'; domain='+b+'; path='+c+'; expires='+new Date((new Date()).getTime()-1e11).toGMTString());}}}})())") 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-11-11T14:14:56.893

我正在使用这段代码，它在没有 JavaScript 的情况下工作。它与 JavaScript 做同样的事情，但在 VB.NET 中。此外，不需要导航。

```
For Each cookie As String In Document.Cookie.Split(";"c)
    Dim domain As String = "." + url.Host
    While domain.Length > 0
        Dim path As String = url.LocalPath
        While path.Length > 0
            Document.Cookie = cookie.Split("="c)(0).Trim & "= ;expires=Thu, 30-Oct-1980 16:00:00 GMT;path=" & path & ";domain=" & domain
            path = path.Substring(0, path.Length - 1)
        End While
        Select Case domain.IndexOf(".")
            Case 0
                domain = domain.Substring(1)
            Case -1
                domain = ""
            Case Else
                domain = domain.Substring(domain.IndexOf("."))
        End Select
    End While
Next 
```

与 JavaScript 唯一真正的区别是`cookie=value`，我在哪里专门搜索`=`和 expire而不是 expiring `cookie=`。这对于过期的没有价值的 cookie 很重要。

陷阱：

*   您只能删除您浏览过的网站的 cookie。
*   如果页面被重定向到不同的域，您删除的 cookie 可能来自重定向的域。与否，这是重定向和您的代码之间的竞赛。
*   不要访问`Document`until `ReadyState = WebBrowserReadyState.Complete`，否则 Document 将是 Nothing 并且取消引用将引发异常。
*   可能还有很多其他人，但这段代码对我很有用。

[带有View Cookies Add-On](https://addons.mozilla.org/en-US/firefox/addon/315)的Firefox 对调试特定网页有很大帮助。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2013-09-18T20:04:38.453

在找到如何在 webbrowser C# 中销毁会话之后，我已经成功使用代码：

```
webBrowser.Navigate("javascript:void((function(){var a,b,c,e,f;f=0;a=document.cookie.split('; ');for(e=0;e<a.length&&a[e];e++){f++;for(b='.'+location.host;b;b=b.replace(/^(?:%5C.|[^%5C.]+)/,'')){for(c=location.pathname;c;c=c.replace(/.$/,'')){document.cookie=(a[e]+'; domain='+b+'; path='+c+'; expires='+new Date((new Date()).getTime()-1e11).toGMTString());}}}})())") 
```

在上面的这个话题中，乔丹·米尔恩怎么说。

在我的应用程序中，我需要使用 webbrowser1.navigate("xxx");

如果您使用 C# 属性，则此处不起作用。

我希望您发现此信息对您有用。

# java - 执行 JSP 页面时可能会出现什么样的问题？

> ID：912746
> 
> 赞同：0
> 
> 时间：2009-05-26T21:01:17.650
> 
> 标签：java, jsp

所以我有一个示例问题如下：

```
Explain how a JSP page is executed and what kind of problems may occur. 
```

我对第一部分很好，将静态 html 和 scriptlet 编译为 java 以供 servlet 等服务。

但我很困惑可能会出现什么问题？JSP 页面保存在内存中......所以也许这可能会耗尽内存？我在这里有点抓稻草...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-26T21:17:38.210

许多人在编写 JSP 页面时忽略的一个潜在问题是 JSP 声明这一事实，即：

```
<%! String foo = "bar" %> 
```

在它们被编译成 servlet 时创建实例变量，这会破坏 JSP 的线程安全。

更一般地说，常见问题包括在表达式末尾使用分号，或者在 scriptlet 中不使用分号；试图检索为空或类型错误的参数或属性或会话值；尝试访问变量时使用了错误的范围。各种好玩的东西。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-26T21:17:59.893

JSP 标记中的语法或 scriptlet 中的 Java 代码可能会导致 JSP 文件无法正确编译。

此外，可能还有未包含的标记库或 Java 源文件导入。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-26T21:36:59.793

我必须说这个问题对我来说有点尴尬。一般来说，当您有一个 JSP 页面（已执行）时，它应该处理可能因使用 scriptlet、表达式或其他 JSP 事物而产生的任何异常。当您没有通过指定 Web 容器在发生异常时将控制权转发到错误页面来处理这些问题时，事情可能会出错:)。当然，总是会出现无法预料的错误，但也可以使用“处理未处理的异常”来处理这个错误。

所以答案是，根据您的代码在 JSP 页面中的内容，可能会发生无限多的错误。问题是您可以预测它们并提前处理它们吗？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-26T22:44:32.637

客户端可能会关闭连接，例如，如果他们点击后退按钮，如果您从页面流式传输数据（pdf、word doc、二进制文件），这是一个问题。

# winapi - 你推荐什么反汇编程序？

> ID：912750
> 
> 赞同：2
> 
> 时间：2009-05-26T21:02:01.017
> 
> 标签：winapi, assembly

我遇到了黑客挑战（例如 rankk.com），其中一些挑战需要对 PE 文件进行反汇编和少量修改。

我正在寻找能够转储字符串、遍历汇编代码并允许修改的反汇编器/调试器。

我在这个领域的知识非常有限，所以我正在寻找相对容易使用并且最好是免费的东西。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-26T21:03:12.997

IDA，没有什么比这更接近了。 [国际开发协会专业版](http://www.hex-rays.com/idapro/)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-26T21:09:57.633

我喜欢[OllyDbg。](http://www.ollydbg.de/)（有个好[伙伴](https://rads.stackoverflow.com/amzn/click/com/0764574817)：）

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-27T11:11:25.563

IDA Pro 有一个很好的图表，可以更好地理解代码流，反汇编器非常棒。虽然我使用 OllyDbg 作为 MASM 的 JIT 调试器和通用调试器。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-26T21:12:20.733

IDA 现在也有他们以前版本的免费版本。对于轻度或介绍性倒车或入门来说，它是一个很好的工具。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-26T21:13:47.407

IDA Pro 用于常见情况，SoftIce 用于特殊情况（例如当您需要反向高度保护的应用程序时，您可以使用特殊的 SoftIce 插件等）。我在学生时代是一个经验丰富的饼干:)

# javascript - 在部分视图中包含 JavaScript 文件

> ID：912755
> 
> 赞同：71
> 
> 时间：2009-05-26T21:03:03.403
> 
> 标签：javascript, jquery, asp.net-mvc, partial-views

我想知道在部分视图中包含 javascript 文件的最佳做法是什么。一旦呈现，这将最终成为我页面 html 中间的一个 js 包含标记。从我的角度来看，这不是一个很好的方法。它们属于 head 标签，因此不应阻止浏览器一次性渲染 html。

**一个例子：** 我在一个'PictureGallery'部分视图中使用一个jquery图片库插件，因为这个部分视图将在几个页面上使用。仅在使用此视图时才需要加载此插件，并且**我不想知道每个部分视图正在使用哪些插件...**

感谢您的回答。

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2009-05-26T22:01:53.533

似乎与这个问题非常相似：[Linking JavaScript Libraries in User Controls](https://stackoverflow.com/questions/885990/linking-javascript-libraries-in-user-controls/886184#886184)

我将在此处重新发布该问题的答案。

出于您提到的原因，我绝对建议不要将它们放在局部中。一个视图很有可能会拉入两个都引用同一个 js 文件的部分。在加载 html 的其余部分之前，您还获得了加载 js 的性能影响。

我不知道最佳实践，但我选择在母版页中包含任何常见的 js 文件，然后为特定于特定或少量视图的一些附加 js 文件定义一个单独的 ContentPlaceHolder。

这是一个示例母版页 - 它非常不言自明。

```
<%@ Master Language="C#" Inherits="System.Web.Mvc.ViewMasterPage" %>
<head runat="server">
    ... BLAH ...
    <asp:ContentPlaceHolder ID="AdditionalHead" runat="server" />
    ... BLAH ...
    <%= Html.CSSBlock("/styles/site.css") %>
    <%= Html.CSSBlock("/styles/ie6.css", 6) %>
    <%= Html.CSSBlock("/styles/ie7.css", 7) %>
    <asp:ContentPlaceHolder ID="AdditionalCSS" runat="server" />
</head>
<body>
    ... BLAH ...
    <%= Html.JSBlock("/scripts/jquery-1.3.2.js", "/scripts/jquery-1.3.2.min.js") %>
    <%= Html.JSBlock("/scripts/global.js", "/scripts/global.min.js") %>
    <asp:ContentPlaceHolder ID="AdditionalJS" runat="server" />
</body> 
```

Html.CSSBlock 和 Html.JSBlock 显然是我自己的扩展，但同样，它们的作用是不言自明的。

然后在说我会有一个 SignUp.aspx 视图

```
<asp:Content ID="signUpContent" ContentPlaceHolderID="AdditionalJS" runat="server">
    <%= Html.JSBlock("/scripts/pages/account.signup.js", "/scripts/pages/account.signup.min.js") %>
</asp:Content> 
```

HTH，查尔斯

附言。这是我询问的关于缩小和连接 js 文件的后续问题： [Concatenate & Minify JS on the fly OR at build time - ASP.NET MVC](https://stackoverflow.com/questions/890561/concatenate-minify-js-on-the-fly-or-at-build-time-asp-net-mvc)

**编辑：**根据我的其他答案的要求，我按要求实现 .JSBlock(a, b)

```
public static MvcHtmlString JSBlock(this HtmlHelper html, string fileName)
{
    return html.JSBlock(fileName, string.Empty);
}

public static MvcHtmlString JSBlock(this HtmlHelper html, string fileName, string releaseFileName)
{
    if (string.IsNullOrEmpty(fileName))
        throw new ArgumentNullException("fileName");

    string jsTag = string.Format("<script type=\"text/javascript\" src=\"{0}\"></script>",
                                 html.MEDebugReleaseString(fileName, releaseFileName));

    return MvcHtmlString.Create(jsTag);
} 
```

然后魔法发生的地方......

```
 public static MvcHtmlString MEDebugReleaseString(this HtmlHelper html, string debugString, string releaseString)
    {
        string toReturn = debugString;
#if DEBUG
#else
        if (!string.IsNullOrEmpty(releaseString))
            toReturn = releaseString;
#endif
        return MvcHtmlString.Create(toReturn);
    } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-06-05T00:22:39.137

您将脚本放在页面底部的原因是确保在尝试任何操作之前已加载 dom。这也可以通过类似 $(document).ready(callback); 的方式实现。jQuery 方法。

我同意不将嵌入式 JavaScript 放入 html 的观点。相反，我使用 Html 助手创建一个空 div 以用作服务器指令。助手 sig 是 Html.ServerData(String name, Object data);

我使用这个 ServerData 方法来获取从服务器到客户端的指令。div 标签保持干净，“data-”属性是有效的 html5。

对于 loadScript 指令，我可以在我的 ascx 或 aspx 中执行类似的操作：

```
<%= Html.ServerData("loadScript", new { url: "pathTo.js" }) %>

```

或者添加另一个看起来更干净的助手来执行此操作：

```
<%= Html.LoadScript("~/path/to.js") %>
```

html 输出将是：

```
<div name="loadScript" data-server="encoded json string">
```

然后我有一个可以找到任何服务器数据标签的 jQuery 方法： $(containingElement).serverData("loadScript"); // 返回解码后的 json 对象的类似 jQuery 的数组。

客户端可能看起来像这样：

```
var script = $(containingelement").serverData("loadScript");
$.getScript(script.url, function () {
    // 脚本已经加载 - 现在可以用它做事了
});

```

这种技术非常适合需要在 ajax 加载的内容中加载的用户控件或脚本。我写的版本更多地涉及处理缓存脚本，因此它们在每次完整页面加载时仅加载一次，并包含回调和 jQuery 触发器，因此您可以在它准备好时挂钩它。

如果有人对此的完整版本感兴趣（从 MVC 到 jQuery 扩展），我很乐意更详细地展示这种技术。否则 - 希望它给某人一种解决这个棘手问题的新方法。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-11-04T11:02:36.803

今天，我创建了自己的解决方案，完全符合要求。不管它是不是好的设计，都由你们来决定，但我认为我应该分享任何一种方式！

下面是我的 HtmlExtensions 类，它允许您在母版页中执行此操作：

```
<%=Html.RenderJScripts() %> 
```

我的 HtmlExtensions 类：

```
public static class HtmlExtensions
{
    private const string JSCRIPT_VIEWDATA = "__js";

    #region Javascript Inclusions

    public static void JScript(this HtmlHelper html, string scriptLocation)
    {
        html.JScript(scriptLocation, string.Empty);
    }

    public static void JScript(this HtmlHelper html, string scriptLocationDebug, string scriptLocationRelease)
    {
        if (string.IsNullOrEmpty(scriptLocationDebug))
            throw new ArgumentNullException("fileName");

        string jsTag = "<script type=\"text/javascript\" src=\"{0}\"></script>";

#if DEBUG
        jsTag = string.Format(jsTag, scriptLocationDebug);
#else
        jsTag = string.Format(jsTag, !string.IsNullOrEmpty(scriptLocationRelease) ? scriptLocationRelease : scriptLocationDebug);
#endif

        registerJScript(html, jsTag);
    }

    public static MvcHtmlString RenderJScripts(this HtmlHelper html)
    {
        List<string> jscripts = html.ViewContext.TempData[JSCRIPT_VIEWDATA] as List<string>;
        string result = string.Empty; ;
        if(jscripts != null)
        {
            result = string.Join("\r\n", jscripts);
        }
        return MvcHtmlString.Create(result);
    }

    private static void registerJScript(HtmlHelper html, string jsTag)
    {
        List<string> jscripts = html.ViewContext.TempData[JSCRIPT_VIEWDATA] as List<string>;
        if(jscripts == null) jscripts = new List<string>();

        if(!jscripts.Contains(jsTag))
            jscripts.Add(jsTag);

        html.ViewContext.TempData[JSCRIPT_VIEWDATA] = jscripts;
    }

    #endregion

} 
```

**到底是怎么回事？**
上面的类将使用方法扩展 HtmlHelper，以将 javascript 链接添加到由集合存储的`HtmlHelper.ViewContext.TempData`集合。在母版页的末尾，我`<%=Html.RenderJScripts() %>`将循环 jscripts 集合放入其中`HtmlHelper.ViewContext.TempData`并将这些呈现到输出。

然而，有一个缺点，.. 您必须确保在添加脚本之前不渲染脚本。例如，如果您想对 css 链接执行此操作，则它不会起作用，因为您必须将它们放在`<head>`页面的标记中，并且 htmlhelper 会在您添加链接之前呈现输出。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-26T21:14:55.140

这似乎是一个类似（尽管不完全）的问题。 [返回包含 javascript 的部分视图是不好的做法吗？](https://stackoverflow.com/questions/863436/is-it-bad-practice-to-return-partial-views-that-contain-javascript/863465#863465)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-26T21:16:20.023

我的偏好是创建一个从您的主 Site.master 继承的 plugin.master 页面。这个想法是你把这些插件塞进plugin.master 并制作8 个左右的页面，这些页面将使用这个部分视图从plugin.master 继承。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-26T21:23:25.360

首选方法是[将脚本放在底部](http://developer.yahoo.com/performance/rules.html#js_bottom)，但是，如果您无法避免，那么将它们放在中间是合理的。

浏览器通常并行加载各种页面元素，但是，当浏览器下载 Javascript 文件时，它不会并行下载任何其他页面元素，直到 Javascript 完成下载。这意味着您的图像和其他图像将不得不等待，因此通常认为将脚本移动到底部会更好，但如果您的脚本很小，那么我不会担心。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2010-12-02T10:56:39.450

海迪格。

使用 Aspnetmvc3 我决定，现在，只在部分中包含我的 javascript 文件

<script src="@Url.Content("~/Scripts/User/List.js")" type="text/javascript"></script>

然后，此 js 文件特定于我的 /user/List.schtml 文件。

/的

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2020-05-28T14:55:18.983

所以，这是一个老问题，但我在尝试解决最近的问题时发现了它。我问了一个问题并[在这里](https://stackoverflow.com/q/62030856/6022098)回答了。这是该答案的副本。它类似于 OP 的答案，但避免使用 TempData。

一种解决方案是实现一个 Html 助手扩展功能，它只会加载一次脚本。见下文。（这也适用于 CSS 和其他包含的文件）。

实现 HtmlHelper 类的扩展和私有支持类作为每个 HttpContext 的单例。

```
public static class YourHtmlHelperExtensionClass 
{
    private class TagSrcAttrTracker
    {
        private TagSrcAttrTracker() { }

        public Dictionary<string, string> sources { get; } = new Dictionary<string, string>();

        public static TagSrcAttrTrackerInstance {
            get {
                IDictionary items = HttpContext.Current.Items;
                const string instanceName = "YourClassInstanceNameMakeSureItIsUniqueInThisDictionary";

                if(!items.Contains(instanceName)) 
                    items[instanceName] = new TagSrcAttrTracker();

                return items[instanceName] as TagSrcAttrTracker;
            }
        }
    }

    public static MvcHtmlString IncludeScriptOnlyOnce(this HtmlHelper helper, string urlOfScript) 
    {
        if(TagSrcAttrTracker.Instance.sources.ContainsKey(urlOfScript))
            return null;

        TagSrcAttrTracker.Instance.sources[urlOfScript] = urlOfScript;

        TagBuilder script = new TagBuilder("script");
        scriptTag.MergeAttribute("src", urlOfScript);

        return MvcHtmlString.Create(script.ToString());
    }
} 
```

然后，将 JavaScript 和其他代码分离到单独的文件中。

示例 .js 文件内容

```
class MyClass{
    myFunction() {
        constructor(divId){
            this._divId = divId
        }

        doSomething() {
            // do something with a div with id == divId
        }
    }
} 
```

局部视图的示例 .cshtml 文件内容

```
<link rel="stylesheet" type="text/css" href="~/Content/CustomCSS/MyPartialView.css"/>

<div id="@ViewBag.id">
    Some content!  Yay!
</div>

@Html.IncludeScriptOnlyOnce("/Scripts/CustomScripts/MyPartialView.js") 
```

使用局部视图的示例 .cshtml 文件

```
...
<body>
    <h1>Here is some content!</h1>
    @Html.Partial("/Views/MyPartial.cshtml", new ViewDataDictionary() { { "id", "id_1"} })
    @Html.Partial("/Views/MyPartial.cshtml", new ViewDataDictionary() { { "id", "id_2"} })
    @Html.Partial("/Views/MyPartial.cshtml", new ViewDataDictionary() { { "id", "id_3"} })
</body>
<script>
$().ready(
    const id1Functionality = new MyClass("id_1") // forgive the poor naming :-)
    const id2Functionality = new MyClass("id_3")
    const id3Functionality = new MyClass("id_2")

    id1Functionality.doSomething();
    id2Functionality.doSomething();
    id3Functionality.doSomething();
)
</script> 
```

部分视图可能被多次包含，并且 JavaScript 与部分视图一起打包，但 .js 文件只包含在页面中一次，因此浏览器不会抱怨 MyClass 被多次声明。

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2009-05-26T21:09:53.763

MVC 的设计者费了很大的劲阻止我们使用代码隐藏，但是通过创建一个名为 <viewname>.aspx.cs 的文件并相应地修改 aspx 页面的继承属性，仍然可以得到它们.

我想说，放置包含的最佳位置是代码隐藏中的 Page_Load 处理程序（使用 Page.ClientScript.RegisterClientScriptInclude）。

# grails - Grails Acegi 插件 - PersonController.groovy - 请解释一下！

> ID：912760
> 
> 赞同：0
> 
> 时间：2009-05-26T21:04:27.300
> 
> 标签：grails

person.properties = params 有什么作用？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-27T00:20:06.733

好吧，简短的回答是，它将 params 映射中的任何键与 person 对象的属性相匹配，将 params 映射中的值分配给匹配的属性。

示例：假设 params.id=156 并且 person 有一个名为 id 的成员属性。在此调用之后，person.id 将等于 156。

一些注意事项：

*   如果 params 中的键与属性不匹配，那没关系，它不会对这些键做任何事情。
*   如果个人的属性没有参数中的键？也可以，它也会跳过那些。
*   这也非常类似于通过“new Person(params)”或调用“bindData(person, params)”创建一个新 Person。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-04T14:16:12.570

[Grails 网站](http://grails.org/doc/1.1/guide/6.%20The%20Web%20Layer.html#6.1.6%20Data%20Binding)上有全面的文档

在幕后，Groovy/Grails 对象的属性是域类属性的映射。params 对象也是请求参数的映射 - 基本上是 HttpServletRequest 对象 CGI 参数。因此，分配将使用参数映射中的值更新属性映射，仅在它们匹配的地方。

如果您要使用直接的 Servlet 和 JSP 来执行此操作，那么您基本上是在编写：

```
public void doGet(HttpServletRequest request, HttpServletResponse response)
      throws ServletException, IOException {

    Person person = new Person();
    person.firstName = request.getParameter('firstname');
    person.lastName =  request.getParameter('lastname');
    person.password = request.getParameter('password');
    ...
} 
```

使用 Grails，您基本上只需在 PersonController.groovy 中编写以下代码：

```
def save = {
        def person = new Person()
        person.properties = params
        ...
    } 
```

因此，使用 Grails，您无需过多担心参数名称是什么，因为您应该使用 grails 标签来输出它们，然后使用 params 映射将它们返回到对象中。这减少了当您拼错参数名称时遇到的愚蠢错误。

您还可以向 Person 域对象添加更多属性，而不必编写更多 getter/setter 类型语句。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-27T11:50:48.060

`person`它使用提供的请求参数更新对象的属性值。这称为数据绑定，并[在此处](http://grails.org/doc/1.1/guide/6.%20The%20Web%20Layer.html#6.1.6%20Data%20Binding)记录。

# facebook - 设计用于确认客户端游戏结果的安全、“低成本”方法的想法

> ID：912761
> 
> 赞同：3
> 
> 时间：2009-05-26T21:04:57.813
> 
> 标签：facebook, security

这更像是一个系统设计问题/挑战，而不是一个编码问题。

基本上，我正在考虑使用 HTML、CSS 和 javascript 在 Facebook 上制作一个[Bejeweled风格的游戏。](http://www.popcap.com/games/free/bejeweled)这主要是出于希望通过一个不平凡的项目来了解 FBJS 的所有小注意事项。

所以这是交易。在为 Facebook 开发时，实际的 API 调用非常昂贵；不仅有一个额外的 POST 到 Facebook 服务器，还有 api 调用限制和节流需要担心。简而言之，对 Facebook 的调用越少越好。将这与即使是这个简单的益智游戏的时间问题结合起来，一般来说也有充分的理由积极减少回调的数量。

不是安全专家，这是我想出的设计：

1.  在游戏页面中嵌入随机种子。
2.  使用该种子创建游戏板（以及需要的其他部分）。
3.  在每个玩家移动之后，根据自上次移动以来的时间调整种子（异或、连接和散列，类似的东西）。编辑：我可能还应该包括在变异种子中采取的实际行动。
4.  游戏完成后发回以下信息：游戏开始时间、采取的每一步动作和时间，以及客户端结果。
5.  在服务器上，使用给定的数据重新运行游戏，检查开始时间和移动时间，然后确认结果匹配。
6.  为了缓解拒绝服务，游戏本身将被调整为通过 X 回合获胜的条件。
7.  为了阻止服务器被用作某种“预言机”，发回无效游戏的用户将被禁止一段时间 X（X 大约为分钟）。

这种设计要求每个游戏玩三个 Facebook 调用：一个在游戏开始前存储随机种子，一个在游戏结束后获取它，另一个在游戏有效时更新玩家的分数。

我试图证明系统反对的是直接分数欺骗（[http://...?myscore=999999999](http://...?myscore=999999999)或类似的）。我还想减轻“前瞻”攻击，其中用户可以知道接下来会出现哪些棋子。还应防止对托管服务器的拒绝服务攻击（有意或无意）。

实际的问题是，任何人都可以看到这个设计的缺陷吗？同样，是否有更简单的设计符合我的标准？

注意：我知道这可能是多么不必要，但它仍然是一个有趣的问题。

* * *

我将尝试在这里抛出一些数字以进一步说明我的推理，这些非常粗略，但我希望有所帮助。

假设一个 10x10 的棋盘，有大约 200 个潜在的移动（交换两个相邻的棋子），其中大部分是无效的。假设每个“回合”平均有 5 个有效动作。如果我们将玩家动作限制在 50 到 30,000 毫秒的帧内，那么在“调整”算法不丢弃位的情况下，就有 149,750 个潜在的新哈希值；我有信心说至少有 10,000 个潜在的新哈希值必须由攻击者计算，假设使用了加密安全的哈希值。如果你在这个时候抛出一个最小-最大算法，你的决策树会很快爆炸。在这个时候抛出一个游戏会话到期，比如 30 分钟，我相信这种攻击，因为它的复杂性相当于编写一个小机器人程序来为你玩，而无法合理地防御它。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-26T21:14:38.963

如果客户端代码计算下一块，而你不能很好地隐藏这个算法，那么一些无聊的大学生会想出来的。结果，他们将能够产生巨大的分数并破坏您的意图。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-26T21:20:08.970

我倾向于说这是不可能的。为什么？你不能信任客户端——我可以分析并完全重写客户端代码并返回我喜欢的任何值。保护您免受作弊和各种攻击的唯一方法是在服务器上执行逻辑 - 客户端只会收集用户输入并显示服务器输出。但这完全违背了您尽量减少服务器调用次数的设计目标。

# java - 获取前一天

> ID：912762
> 
> 赞同：16
> 
> 时间：2009-05-26T21:05:26.893
> 
> 标签：java, datetime, date

> **可能重复：**
> [如何确定Java中给定日期前一天的日期？](https://stackoverflow.com/questions/745443/how-to-determine-the-date-one-day-prior-to-a-given-date-in-java)

如果我有一个 Java.Util.Date 对象，那么获取表示过去 24 小时的对象的最佳方法是什么？

* * *

## 回答 #1

> 赞同：48
> 
> 时间：2009-05-26T21:10:11.673

使用 Java 1.6 [java.util.Calendar.add](http://java.sun.com/javase/6/docs/api/java/util/Calendar.html#add(int,%20int))：

```
public static Date subtractDay(Date date) {

    Calendar cal = Calendar.getInstance();
    cal.setTime(date);
    cal.add(Calendar.DAY_OF_MONTH, -1);
    return cal.getTime();
} 
```

其他人建议使用[Joda Time](http://joda-time.sourceforge.net/)，目前是[JSR 310](http://jcp.org/en/jsr/detail?id=310)，以后应该包含在 Java 本身中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-27T00:03:32.570

要记住的重要一点是 Date 类应该代表任何时间点，而 Calendar 类用于操作这些时间点。最后，SimpleDateFormat 将它们表示为字符串。

因此，最好的方法是使用 Calendar 类为您计算新的 Date。这将确保考虑到任何变幻莫测（夏令时、闰年等）。

我假设您真的不想找到“前 24 小时”，但实际上确实想要一个表示“昨天这个时间”的新 Date 实例 - 无论哪种方式，您都可以向 Calendar 实例询问另一个前 24 小时的 Date 或1 天前。

夏令时就是一个很好的例子。英国在 2009 年 3 月 26 日“突飞猛进”。因此，2009 年 3 月 26 日凌晨 3 点前 1 天应该会产生 2009 年 3 月 25 日凌晨 3 点，但 24 小时前会产生 2 点

```
public class DateTests extends TestCase {
  private static String EXPECTED_SUMMER_TIME = "2009.Mar.29 03:00:00";
  private static String EXPECTED_SUMMER_TIME_LESS_DAY = "2009.Mar.28 03:00:00";
  private static String EXPECTED_SUMMER_TIME_LESS_24_HRS = "2009.Mar.28 02:00:00";
  private static String EXPECTED_SUMMER_TIME_LESS_FURTHER_24_HRS = "2009.Mar.27 02:00:00";

  public void testSubtractDayOr24Hours() {

    SimpleDateFormat formatter = new SimpleDateFormat("yyyy.MMM.dd HH:mm:SS");

    Calendar calendar = Calendar.getInstance();

    // Create our reference date, 3.00 a.m. on the day the clocks go forward (they 'went' forward at 02.00)
    calendar.clear();
    calendar.set(2009, 2, 29, 3, 0);

    Date summerTime = calendar.getTime(); // Sun Mar 29 03:00:00 BST 2009
    String formattedSummerTime = formatter.format(summerTime);
    calendar.add(Calendar.DAY_OF_MONTH, -1);

    // Our reference date less 'a day'
    Date summerTimeLessADay = calendar.getTime(); // Sat Mar 28 03:00:00 GMT 2009
    String formattedSummerTimeLessADay = formatter.format(summerTimeLessADay);

    // reset the calendar instance to the reference day
    calendar.setTime(summerTime);

    // Our reference date less '24 hours' (is not quite 24 hours)
    calendar.add(Calendar.HOUR, -24);
    Date summerTimeLess24Hrs = calendar.getTime(); // Sat Mar 28 02:00:00 GMT 2009
    String formattedSummerTimeLess24Hrs = formatter.format(summerTimeLess24Hrs);

    // Third date shows that taking a further 24 hours from yields expected result
    calendar.add(Calendar.HOUR, -24);
    Date summerTimeLessFurther24Hrs = calendar.getTime(); // Fri Mar 27 02:00:00 GMT 2009
    String formattedSummerTimeLessFurther24Hrs = formatter.format(summerTimeLessFurther24Hrs);

    // reset the calendar once more to the day before
    calendar.setTime(summerTimeLess24Hrs);

    // Take a 'day' from the Sat will yield the same result as date 03 because Daylight Saving is not a factor
    calendar.add(Calendar.DAY_OF_MONTH, -1);
    Date summerTimeLessFurtherDay = calendar.getTime(); // Fri Mar 27 02:00:00 GMT 2009
    String formattedSummerTimeLessFurtherDay = formatter.format(summerTimeLessFurtherDay);

    assert(formattedSummerTime.equals(EXPECTED_SUMMER_TIME));
    assert(formattedSummerTimeLessADay.equals(EXPECTED_SUMMER_TIME_LESS_DAY));
    assert(formattedSummerTimeLess24Hrs.equals(EXPECTED_SUMMER_TIME_LESS_24_HRS));

    assert(formattedSummerTimeLessFurther24Hrs.equals(EXPECTED_SUMMER_TIME_LESS_FURTHER_24_HRS));

    // This last test proves that taking 24 hors vs. A Day usually yields the same result
    assert(formattedSummerTimeLessFurther24Hrs.equals(formattedSummerTimeLessFurtherDay));

  }
} 
```

对于测试日期函数，wwwdot-timeanddate-dot-com 是一个很好的资源。

* * *

## 回答 #3

> 赞同：-4
> 
> 时间：2009-05-26T21:09:11.893

从时间中减去 1000*60*60*24 并创建一个新日期。

```
Date yesterday = new Date(d.getTime() - (1000*60*60*24)); 
```

* * *

## 回答 #4

> 赞同：-4
> 
> 时间：2009-05-26T21:11:41.420

```
 int dayInMs = 1000 * 60 * 60 * 24;
    Date previousDay = new Date(olddate.getTime() - dayInMs); 
```

就个人而言，如果有很多时间/日期计算，我会选择[Joda-time](http://joda-time.sourceforge.net/)。

# shell - 无法安全地将点文件转换为非点文件

> ID：912770
> 
> 赞同：2
> 
> 时间：2009-05-26T21:09:08.600
> 
> 标签：shell, mv

我在 Mac 中运行失败

```
mv .* * 
```

和

```
mv .* ./* 
```

我的文件消失得无影无踪。

**如何安全地将点文件转换为非点文件？**

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-26T21:17:42.017

```
for i in `ls -d .*`; do mv $i "`echo $i | sed 's/^.//'`"; done 
```

或者，更容易，

```
rename 's/^.//' `ls -d .*` 
```

如果你的系统有它。

在 zsh 中，您可以安全地使用 .*，但在 bash 中，您必须使用`ls -d .*`

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-26T21:17:08.163

您不能`mv`像这样重命名多个文件。你想要的是[mmv](http://tldp.org/LDP/GNU-Linux-Tools-Summary/html/mass-rename.html)（在[这里](http://linux.maruhn.com/sec/mmv.html)获取）。

```
mmv .\* \#1 
```

您必须转义星号以防止 bash 扩展它。使用 -n 标志进行测试运行，以确保将发生的事情是您想要的。

您也可以在 shell 脚本中执行此操作，但我更喜欢`mmv`，因为 -n 标志显示了它会做什么。您必须将脚本更改为 echo 而不是 mv，这似乎比删除 -n 标志更危险（尤其是当您变得更复杂时。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-26T21:52:25.597

棘手的部分是选择点文件而不选择“。” 和 ”..”。

*   `ls .??*`有时用于此目的，因为它强制文件名长度为三个或更多字符。但是，存在忽略具有短名称（例如“.x”）的点文件的风险
*   `ls -d .*`防止目录被扩展，但它不会过滤掉“。” 或者 ”..”
*   `find`可以使用该命令，如`find . -maxdepth 1 -type f -name '.*'`. maxdepth 将其限制为当前目录而不是子目录。-type f 将其限制为文件，消除诸如“.”之类的目录。和 ”..”。再说一次，也许您想将 .ssh 目录重命名为 ssh。

这是一种选择点文件同时避免“。”的替代方法。和 ”..”。

```
ls -A | sed -n 's/^\.\(.*\)/mv ".\1" "\1"/p' | bash 
```

-A 列出所有文件和点文件，但消除“。” 和“..”对我们来说。然后 sed 命令只选择那些带有 "." 的行。作为第一个字符，并打印出适当的“mv”命令，并加上引号，以防你有一个奇怪的点文件名，其中有一个空格。

先在不带“| bash”的情况下运行它，看看生成了哪些 mv 命令。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-26T21:18:21.577

我不知道你使用的是什么类型的系统，但它看起来像 unix，我会的

ls -1 .?* | 切-b1- | xargs -i{} mv .{} {}

这列出了以 . 开头但不是 . 的所有内容。或..，然后切断第一列，然后将该列表传递给移动命令

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-27T09:59:58.547

在 Linux 中，通常有一个可用的`rename`实用程序（如果我没记错的话，一个 perl 脚本）：

```
rename 's/^.//' .* 
```

它在 Mac 上可用。您可以按照[此处](http://www.macosxhints.com/article.php?story=20050630022203488)的提示进行安装。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-08-02T06:38:51.510

更简单：

```
对于 x in .*; 做 mv $x ${x/./}; 完毕    

```

# regex - 用 ActionScript 3 中的不同文本替换每个 RegExp 匹配项

> ID：912780
> 
> 赞同：0
> 
> 时间：2009-05-26T21:10:17.867
> 
> 标签：regex, actionscript-3, replace

我想知道如何用**不同**的文本替换**每个匹配项？**假设源文本是：

 **```
var strSource:String = "find it and replace what you find."; 
```

..我们有一个正则表达式，例如：

```
var re:RegExp = /\bfind\b/g; 
```

现在，我需要用不同的文本替换每个匹配项（例如）：

```
var replacement:String = "replacement_" + increment.toString(); 
```

所以输出会是这样的：

```
output = "replacement_1 it and replace what you replacement_2"; 
```

任何帮助表示赞赏..

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-07-18T10:04:16.540

您还可以使用替换功能，如下所示：

```
var increment : int = -1; // start at -1 so the first replacement will be 0
strSource.replace( /(\b_)(.*?_ID\b)/gim , function() {
    return arguments[1] + "replacement_" + (increment++).toString();
} ); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-26T22:30:21.137

我终于想出了一个解决方案。如果有人需要，就在这里：

```
var re:RegExp = /(\b_)(.*?_ID\b)/gim;
var increment:int = 0;
var output:Object = re.exec(strSource);
while (output != null)
{
    var replacement:String = output[1] + "replacement_" + increment.toString();
    strSource = strSource.substring(0, output.index) + replacement + strSource.substring(re.lastIndex, strSource.length);
    output = re.exec(strSource);
    increment++;
} 
```

不管怎么说，还是要谢谢你...

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-26T21:23:35.483

离开 g （全局）标志并使用适当的替换字符串重复搜索。循环直到搜索失败

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-26T21:31:26.870

不确定actionscript，但在许多其他正则表达式实现中，您通常可以传递一个回调函数，该函数将为每个匹配和替换执行逻辑。

# apache-flex - 尝试调试 Flex 应用程序时出错

> ID：912793
> 
> 赞同：1
> 
> 时间：2009-05-26T21:13:57.030
> 
> 标签：apache-flex, flex3

我正在使用 Windows XP 和 flex builder 3。这是我收到的错误：

![错误截图](https://i.stack.imgur.com/Tpw5t.jpg)

我正在尝试通过切换断点来调试 flex 应用程序。当我尝试调试时，出现上述错误。

到目前为止，我唯一安装的是 flex builder 3。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-26T23:26:02.367

按此顺序安装，您将能够缓解此问题。我花了一点点试错。

第 1 步：http: [//get.adobe.com/flashplayer/](http://get.adobe.com/flashplayer/)

第 2 步：http: [//download.macromedia.com/pub/flashplayer/updaters/10/flashplayer_10_ax_debug.exe](http://download.macromedia.com/pub/flashplayer/updaters/10/flashplayer_10_ax_debug.exe)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-26T21:19:17.160

您给我们的内容不多 - 您是否尝试过安装[Flash 10 调试播放器](http://www.adobe.com/support/flashplayer/downloads.html)？

# .net - .NET 中的 ListView.ItemCheck 与 ListView.ItemChecked

> ID：912798
> 
> 赞同：14
> 
> 时间：2009-05-26T21:14:41.397
> 
> 标签：.net, events, listview

ListView 有什么区别。[ItemCheck](http://msdn.microsoft.com/en-us/library/system.windows.forms.listview.itemcheck.aspx)和 ListView。[.NET 中的ItemChecked](http://msdn.microsoft.com/en-us/library/system.windows.forms.listview.itemchecked.aspx)事件？

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2009-05-26T21:46:22.410

*当项目的选中状态即将更改*`ItemCheck`时触发该事件，允许您检查旧值和新值，并根据需要取消更改（通过分配 eventargs 参数的 NewValue 属性）。*在检查（或取消检查）完成后*触发。*`ItemChecked`*

 **代码示例：

```
private void ListView_ItemCheck(object sender, ItemCheckEventArgs e)
{
    // the checked state of an item is about to change
    if (e.NewValue == CheckState.Checked)
    {
        // perform some check if this is allowed, and if not...
        e.NewValue = e.CurrentValue;
    }
}

private void ListView_ItemChecked(object sender, ItemCheckedEventArgs e)
{
    // the checked state of an item has changed
} 
```

# jquery - JQuery BlockUI 没有解除对页面的阻塞

> ID：912804
> 
> 赞同：0
> 
> 时间：2009-05-26T21:17:35.353
> 
> 标签：jquery

我遇到了一个非常奇怪的问题！我在我的一个页面中使用了 blockUI JQuery 插件，它运行良好。我对另一个页面做了同样的事情，当调用 $unblockUI 时它并没有解除阻止页面。

这是代码：

```
function showCommentBox() 
{      

    $("#commentBox").addClass("modalPopup");   

    alert($("#commentBox").hasClass("modalPopup")); 

    $.blockUI( { message: $("#commentBox") } );     
}

function cancelComment() 
{    
    alert($("#commentBox").hasClass("modalPopup")); 

    $.unblockUI();   
} 
```

当在 cancelComment 函数中评估 $("#commentBox").hasClass("modalPopup") 时，不工作的页面返回“false”，而正常工作的页面返回 true。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-27T19:53:03.747

**@Azam -**您在上面发布的代码没有任何问题。没有理由不应该工作。我直接复制了帖子中的代码，并在这个**[jsbin页面](http://jsbin.com/uloye)**中进行了测试。自己看吧。

为了使其尽可能简单，这就是我用于 HTML 正文的全部内容。

```
 <input type="button" value="Show Comment" onclick="showCommentBox()" /> 
  <div id="commentBox" style="display:none"><br/>  
    This is the text from the CommentBox Div<br/> 
    <input type="button" value="Cancel" onclick="cancelComment()" /> 
  </div> 
```

**编辑：**在阅读了您的其他一些帖子后，我意识到问题的真正原因是您在 GridView 的 ItemTemplate 中添加了“commentBox”div。这会导致创建具有相同 ID 的相同 div 乘以 gridview 中的行数。通常，在多个 HTML 元素中使用相同的 id 是不好的，但这就是 gridview 的作用。

这是我测试过的解决方法，它有效。将您的两个功能更改为：

```
function showCommentBox() {
    $.currentBox = $("#commentBox");
    $.currentBox.addClass("modalPopup");   
    alert($.currentBox.hasClass("modalPopup")); 
    $.blockUI( { message: $.currentBox } );     
}

function cancelComment() {    
    alert($.currentBox.hasClass("modalPopup")); 
    $.unblockUI();   
} 
```

在这里，我使用 jQuery 变量来存储对 commentBox DIV 的引用并将其传递给 $.blockUI，这样对 $.unblockUI() 的调用将正常工作。

# debugging - 在 Qt 中设置断点后，gdb 说：“访问内存地址时出错”

> ID：912808
> 
> 赞同：7
> 
> 时间：2009-05-26T21:18:01.157
> 
> 标签：debugging, qt, qt4, gdb, breakpoints

**我在这里写了一个非常简单的 Qt 程序：**

```
int main(int argc, char* argv[])
{
    QApplication app(argc, argv);

    QTableView table(&frame);
    table.resize(100, 100);
    table.show();

    return app.exec();
} 
```

**当我尝试在单击表的位置设置断点时，我从 gdb 收到此错误：**

```
(gdb) symbol-file /usr/lib/libQtGui.so.4.4.3.debug 
Load new symbol table from "/usr/lib/libQtGui.so.4.4.3.debug"? (y or n) y
Reading symbols from /usr/lib/libQtGui.so.4.4.3.debug...done.
(gdb) br 'QAbstractItemView::clicked(QModelIndex const&)'
Breakpoint 1 at 0x5fc660: file .moc/release-shared/moc_qabstractitemview.cpp, line 313.
(gdb) run
Starting program: ./qt-test
Warning:
Cannot insert breakpoint 1.
Error accessing memory address 0x5fc660: Input/output error. 
```

**有谁知道为什么不能插入断点？**

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-05-26T21:31:07.557

不要使用 gdb 命令*`symbol-file`*加载外部符号。断点地址将是错误的，因为它们没有重新定位。

相反，在 中放置一个断点`main`，运行程序，然后设置你的断点：

```
gdb ./program
GNU gdb 6.8-debian blah blah blah
(gdb) br main
Breakpoint 1 at 0x80489c1
(gdb) run
Starting program: ./program
Breakpoint 1, 0x080489c1 in main ()
(gdb) br 'QAbstractItemView::clicked(QModelIndex const&)'
Breakpoint 2 at 0xb7d24664
(gdb) continue
Continuing. 
```

然后让你的断点发生。

*确保在要设置断点的函数中指定参数列表，没有这些参数的名称，只是它们的类型。*

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2010-09-09T01:33:32.190

实际错误：

> 访问内存地址 0x5fc660 时出错：输入/输出错误。

可能是由 32/64 位混淆引起的。例如，检查您没有附加到具有 64 位进程 ID 的 32 位二进制文​​件，反之亦然。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-28T20:57:20.670

如果您想在不设置断点的情况下自动中断 main，您也可以使用该`start`命令。
如果您需要为程序提供任何参数，您可以使用：
`start argument1 argument2`

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2015-08-26T18:10:35.170

对我来说好吧，我在使用 mingw-w64（本机或交叉编译器）构建时得到了这个。我不确定确切的问题是什么，但如果我使用 gcc mingw-w64 i686-5.1.0-posix-sjlj-rt_v4-rev0 构建它，那么它会创建（最终）可调试的构建。除此以外

```
(gdb) break main
...
(gdb) r
...
Cannot insert breakpoint 1.
Cannot access memory at address 0x42445c
<process basically hangs> 
```

20 次中有 19 次消息，尽管有时它确实有效（很少）。

gdb 7.8.1 和 7.9.1 似乎能够调试创建的 exe。所以可能不是 gdb 的版本有所作为。

我目前的理论/怀疑是它是 gcc 的版本，或者可能是编译器的 sljl 与 dwarf2“方面”[？]（i686-492-posix-dwarf-rt_v3-rev1 不起作用，并与某种形式的 gcc 4.9.2 也没有）。没有尝试其他版本的 gcc。

更新：较新的 gcc (5.1.0) 但交叉编译我仍然遇到此故障。*在这种*情况下，原因是我的构建（FFmpeg）通过链接（在这种情况下为libgme）使用的依赖库，它正在导出一些错误的“共享”符号（当我构建静态可执行文件时）。正因为如此，“共享”构建了刹车（[https://trac.ffmpeg.org/ticket/282](https://trac.ffmpeg.org/ticket/282)）并且不知何故它也搞砸了 gdb。例如，可能链接到 SDL 也可以对您执行此操作。我的想法可能是一个`ld`错误[？]

# unicode - URL 编码 Unicode 字符的正确方法是什么？

> ID：912811
> 
> 赞同：115
> 
> 时间：2009-05-26T21:18:56.740
> 
> 标签：unicode, utf-8, character-encoding, urlencode, web-standards

我知道非标准的 %uxxxx 方案，但这似乎不是一个明智的选择，因为该方案已被 W3C 拒绝。

一些有趣的例子：

心脏字符。如果我在浏览器中输入：

```
http://www.google.com/search?q=♥ 
```

然后复制粘贴，我看到了这个网址

```
http://www.google.com/search?q=%E2%99%A5 
```

这看起来像是 Firefox（或 Safari）正在这样做。

```
urllib.quote_plus(x.encode("latin-1"))
'%E2%99%A5' 
```

这是有道理的，除了不能用 Latin-1 编码的东西，比如三点字符。

```
… 
```

如果我输入网址

```
http://www.google.com/search?q=… 
```

进入我的浏览器然后复制并粘贴，我得到

```
http://www.google.com/search?q=%E2%80%A6 
```

背部。这似乎是做的结果

```
urllib.quote_plus(x.encode("utf-8")) 
```

这是有道理的，因为……不能用 Latin-1 编码。

但是我不清楚浏览器如何知道是用 UTF-8 还是 Latin-1 解码。

因为这似乎是模棱两可的：

```
In [67]: u"…".encode('utf-8').decode('latin-1')
Out[67]: u'\xc3\xa2\xc2\x80\xc2\xa6' 
```

有效，所以我不知道浏览器如何确定是用 UTF-8 还是 Latin-1 解码。

处理我需要处理的特殊字符的正确做法是什么？

* * *

## 回答 #1

> 赞同：69
> 
> 时间：2009-05-27T02:18:55.170

我总是用 UTF-8 编码。从[百分比编码的维基百科页面](http://en.wikipedia.org/wiki/Percent-encoding#Percent-encoding_in_a_URI)：

> 通用 URI 语法要求提供 URI 中字符数据表示的新 URI 方案实际上必须表示来自未保留集中的字符而无需翻译，并且应该根据 UTF-8 将所有其他字符转换为字节，然后百分比编码这些值。该要求是在 2005 年 1 月随[RFC 3986](https://www.rfc-editor.org/rfc/rfc3986)的发布而引入的。在此日期之前引入的 URI 方案不受影响。

似乎因为过去还有其他公认的 URL 编码方法，浏览器尝试了几种解码 URI 的方法，但如果你是编码的人，你应该使用 UTF-8。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-05-27T22:13:03.387

一般规则似乎是浏览器根据提供表单的页面的内容类型对表单响应进行编码。这是一个猜测，如果服务器向我们发送“text/xml; charset=iso-8859-1”，那么他们期望以相同格式返回响应。

如果您只是在 URL 栏中输入 URL，则浏览器没有可处理的基本页面，因此只能猜测。因此，在这种情况下，它似乎一直在执行 utf-8（因为您的两个输入都产生了三个八位字节形式的值）。

可悲的事实是，AFAIK 对于查询字符串中的值或 URL 中的任何字符应该解释为什么字符集没有标准。至少在查询字符串中的值的情况下，没有理由假设它们一定*对应*于字符。

这是一个已知问题，您必须告诉服务器框架您希望查询字符串编码为哪个字符集——例如，在 Tomcat 中，您必须先调用 request.setEncoding() （或一些类似的方法*）*调用任何 request.getParameter() 方法。关于这个主题的文档缺乏可能反映了许多开发人员对这个问题缺乏认识。（我经常问 Java 面试者 Reader 和 InputStream 的区别是什么，而且经常会得到空白）

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-06-19T22:22:23.377

IRI ( [RFC 3987](http://www.ietf.org/rfc/rfc3987.txt) ) 是取代 URI/URL（[RFC 3986](http://www.ietf.org/rfc/rfc3986.txt)和更早版本）标准的最新标准。URI/URL 本身并不支持 Unicode（好吧，[RFC 3986](http://www.ietf.org/rfc/rfc3986.txt)增加了未来基于 URI/URL 的协议的规定以支持它，但不更新过去的 RFC）。"%uXXXX" 方案是在某些情况下允许 Unicode 的非标准扩展，但并非所有人都普遍实施。另一方面，IRI 完全支持 Unicode，并要求在进行百分比编码之前将文本编码为 UTF-8。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2010-04-14T05:31:36.433

IRI 不会替换 URI，因为在某些情况下（包括 HTTP）只允许使用 URI（实际上是 ASCII）。

取而代之的是，您指定一个 IRI，它会在上网时转换为一个 URI。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-27T16:08:32.577

第一个问题是你的需求是什么？UTF-8 编码是使用廉价编辑器创建的文本和支持多种语言之间的一个很好的折衷。关于识别编码的浏览器，响应（来自网络服务器）应该告诉浏览器编码。大多数浏览器仍然会尝试猜测，因为在很多情况下这要么是缺失的，要么是错误的。他们通过读取一些结果流来猜测是否存在不适合默认编码的字符。目前所有浏览器（？我没有检查这个，但它非常接近真实）使用 utf-8 作为默认值。

因此，请使用 utf-8，除非您有令人信服的理由使用许多其他编码方案之一。

# c# - 正则表达式获取字符串中的最后一个冒号及其后的所有内容

> ID：912812
> 
> 赞同：2
> 
> 时间：2009-05-26T21:19:08.940
> 
> 标签：c#, regex

我正在尝试编写一个正则表达式，它将获得最后一个 ':' 以及它之后的所有内容。这是我在 C# 中的正则表达式：

```
Regex rx5 = new Regex(@"[A-Za-z.][^\s][^:]{1,}$",RegexOptions.Singleline); 
```

它可以工作，只是其中包含“：”。我怎样才能得到'：'之后的所有内容，不包括'：'？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-05-26T21:28:27.657

通过不使用正则表达式，而是使用 String.LastIndexOf 和 Substring()

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-26T21:24:08.617

我会使用这个正则表达式：

```
^(?:[^:]*:)+([^:]*)$ 
```

然后第一个匹配组将包含最后一个匹配组之后的其余部分`:`。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-27T16:28:33.833

你最好做 str.Substring(str.LastIndexOf(':')+1)。

正则表达式很强大，但是当有更简单的方法时不要尝试使用它们。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-26T21:38:41.740

或者您可以只使用以下模式：

```
Regex rx5 = new Regex("[^:]+)$",RegexOptions.Singleline); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-26T21:42:33.027

使用lookbehind不包括最后一个“：”

```
 Regex rx5 = new Regex("(?<=:)([^:]*)$",RegexOptions.Singleline); 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-26T21:25:14.060

使用组，您还可以将正则表达式重写为更简单的内容：

```
Regex rx5 = new Regex(":([^:]*)$",RegexOptions.Singleline); 
```

然后你有：

```
Match ma = rx5.Match("test:1:2:3");
if (ma.Success)
{
    // your content is in ma.Groups[1].Value
} 
```

# c# - 从用户输入裁剪图像

> ID：912817
> 
> 赞同：1
> 
> 时间：2009-05-26T21:19:33.883
> 
> 标签：c#, user-interface, image-processing

我正在构建 ac# 应用程序来为访客拍照以获取 ID 徽章。我找到了用于网络摄像头的 ac# 包装器，因此可以轻松拍摄快照，但是我需要将图像设置为一定数量的像素，理想情况下，人的头部会占据大部分区域。

我想最好的方法是允许最终用户在初始图像上拖出一个矩形，其中固定的 x 和 y 比率覆盖人脸。这将裁剪图像并进行必要的分辨率调整。

有谁知道类似的例子吗？我想我知道如何制作矩形并获得图像裁剪的坐标，而不是固定 x 和 y 比率。显然，一个例子比我自己写一个例子要快。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-27T04:12:46.207

从 .Net 3.0 开始，System.Windows.Media.Imaging 提供了一个`CroppedBitmap`继承自`BitmapSource`. 它的构造函数接受 a`BitmapSource`和 a `Int32Rect`。如果您将原始图像和矩形传递给它，它将以`BitmapSource`.

# eclipse - Ubuntu Eclipse 版本

> ID：912821
> 
> 赞同：3
> 
> 时间：2009-05-26T21:20:50.077
> 
> 标签：eclipse, ubuntu

我有一个基本问题，适用于 Ubuntu 9.04 的最新版本的 Eclipse 是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-26T21:28:55.253

官方存储库中的版本是 3.2.2， [这是](https://launchpad.net/~eclipse-team/+archive/ppa)一个版本为 3.4.1 的 PPA，如果您愿意，没有理由不能从[eclipse.org下载最新版本。](http://eclipse.org/downloads)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-26T21:25:51.283

[我想说3.2。](https://help.ubuntu.com/community/EclipseIDE)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-26T21:27:34.070

我最近刚刚在我的 Ubuntu 9.04 系统上下载并安装了 Eclipse 3.4.2 Ganymede。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-26T22:04:12.903

这是一篇旧文章，但它仍然适用。它通过从 eclipse.org 安装 Ubuntu

[http://flurdy.com/docs/eclipse/install.html](http://flurdy.com/docs/eclipse/install.html)

它还谈到了安装 Tomcat，但您不需要它。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-17T20:41:32.640

Ubuntu 存储库中通常有一个相当新的 Eclipse 版本。但是，如果您想要最先进的技术，[askubuntu](https://askubuntu.com/questions/68018/how-do-i-install-eclipse-indigo-3-7-1)上的这个问题详细说明了如何将 eclipse 提取到目录中（例如，Windows 上的首选方法）以及之后如何修复所有链接和快捷方式。

就个人而言，我更喜欢将 eclipse 提取到 Ubuntu 上的用户目录，这适用于 Eclipse 3.7.2

# c# - FCKEditor 文件上传 - 在生产服务器上不起作用 - “无效文件”

> ID：912822
> 
> 赞同：0
> 
> 时间：2009-05-26T21:20:53.773
> 
> 标签：c#, fckeditor

我有 FCKEditor (2.6.4) 在我的开发机器上使用 aspx 连接器进行文件上传（它是一个 asp.net 网站），但我不知道如何让它在生产机器上工作。啊。在这上面花了 4 个小时，却一无所获。

从表面上看，这似乎是一个权限问题，但是：

*   我已经双重和三重检查了IUSR和ASPNET和网络服务（现在甚至是“所有人”）有权在作为上传目标的“userfiles”文件夹中写入文件。
*   我在设置 fckconfig.js 时遵循了法律条文

症状：

*   编辑器工作正常。用户可以输入文字等。
*   用户可以单击插入图像按钮，这会调出图像选择器。可以插入服务器上已经存在的图像就好了。
*   可以进入文件上传对话框并通过 fckeditor UI 在服务器上成功创建一个新文件夹。
*   但是，每当用户尝试上传一个小的且有效的 .png、.jpg、.gif、任何图像（在我的本地主机上可以正常工作）时，Firefox 都会给我一个“无效文件”消息。（我已经尝试了许多不同大小和格式的有效图像文件。没有工作。图像没有上传到服务器。）

fckconfig.js 中的相关代码：

` var _FileBrowserLanguage = 'aspx' ;
var _QuickUploadLanguage = 'aspx' ;

// 不要关心以下两行。它只是计算正确的连接器 // 用于默认文件浏览器的扩展名（Perl 使用“cgi”）。var _FileBrowserExtension = _FileBrowserLanguage == 'perl' ？'cgi' : _FileBrowserLanguage ; var _QuickUploadExtension = _QuickUploadLanguage == 'perl' ？'cgi' : _QuickUploadLanguage ; `

来自 fckeditor\editor\filemanager\connectors\aspx\config.ascx 的代码：

`UserFilesPath = "~/userfiles/";

```
 // The connector tries to resolve the above UserFilesPath automatically.
    // Use the following setting it you prefer to explicitely specify the
    // absolute path. Examples: 'C:\\MySite\\userfiles\\' or '/root/mysite/userfiles/'.
    // Attention: The above 'UserFilesPath' URL must point to the same directory.

    string ap = HttpContext.Current.Server.MapPath("~/userfiles/");
    UserFilesAbsolutePath = ap;

    //UserFilesAbsolutePath = "C:\\inetpub\\wwwroot\\hot-bigoven\\userfiles\\";
    //UserFilesAbsolutePath = "C:\\inetpub\\wwwroot\\bigovenwebapp\\bigovenwebapp\\userfiles\\";

    // Due to security issues with Apache modules, it is recommended to leave the
    // following setting enabled.

    //ForceSingleExtension = true;

    // Allowed Resource Types
    AllowedTypes = new string[] { "File", "Image", "Flash", "Media" };

    // For security, HTML is allowed in the first Kb of data for files having the
    // following extensions only.
    HtmlExtensions = new string[] { "html", "htm", "xml", "xsd", "txt", "js" };

    TypeConfig[ "File" ].AllowedExtensions          = new string[] { "7z", "aiff", "asf", "avi", "bmp", "csv", "doc", "fla", "flv", "gif", "gz", "gzip", "jpeg", "jpg", "mid", "mov", "mp3", "mp4", "mpc", "mpeg", "mpg", "ods", "odt", "pdf", "png", "ppt", "pxd", "qt", "ram", "rar", "rm", "rmi", "rmvb", "rtf", "sdc", "sitd", "swf", "sxc", "sxw", "tar", "tgz", "tif", "tiff", "txt", "vsd", "wav", "wma", "wmv", "xls", "xml", "zip" };
    TypeConfig[ "File" ].DeniedExtensions           = new string[] { };
    TypeConfig[ "File" ].FilesPath                  = "%UserFilesPath%file/";
    TypeConfig[ "File" ].FilesAbsolutePath          = ( UserFilesAbsolutePath == "" ? "" : "%UserFilesAbsolutePath%file/" );
    TypeConfig[ "File" ].QuickUploadPath            = "%UserFilesPath%";
    TypeConfig[ "File" ].QuickUploadAbsolutePath    = ( UserFilesAbsolutePath == "" ? "" : "%UserFilesAbsolutePath%" );

    TypeConfig[ "Image" ].AllowedExtensions         = new string[] { "bmp", "gif", "jpeg", "jpg", "png" };
    TypeConfig[ "Image" ].DeniedExtensions          = new string[] { };
    TypeConfig[ "Image" ].FilesPath                 = "%UserFilesPath%image/";
    TypeConfig[ "Image" ].FilesAbsolutePath         = ( UserFilesAbsolutePath == "" ? "" : "%UserFilesAbsolutePath%image/" );
    TypeConfig[ "Image" ].QuickUploadPath           = "%UserFilesPath%";
    TypeConfig[ "Image" ].QuickUploadAbsolutePath   = ( UserFilesAbsolutePath == "" ? "" : "%UserFilesAbsolutePath%" );

    TypeConfig[ "Flash" ].AllowedExtensions         = new string[] { "swf", "flv" };
    TypeConfig[ "Flash" ].DeniedExtensions          = new string[] { };
    TypeConfig[ "Flash" ].FilesPath                 = "%UserFilesPath%flash/";
    TypeConfig[ "Flash" ].FilesAbsolutePath         = ( UserFilesAbsolutePath == "" ? "" : "%UserFilesAbsolutePath%flash/" );
    TypeConfig[ "Flash" ].QuickUploadPath           = "%UserFilesPath%";
    TypeConfig[ "Flash" ].QuickUploadAbsolutePath   = ( UserFilesAbsolutePath == "" ? "" : "%UserFilesAbsolutePath%" );

    TypeConfig[ "Media" ].AllowedExtensions         = new string[] { "aiff", "asf", "avi", "bmp", "fla", "flv", "gif", "jpeg", "jpg", "mid", "mov", "mp3", "mp4", "mpc", "mpeg", "mpg", "png", "qt", "ram", "rm", "rmi", "rmvb", "swf", "tif", "tiff", "wav", "wma", "wmv" };
    TypeConfig[ "Media" ].DeniedExtensions          = new string[] { };
    TypeConfig[ "Media" ].FilesPath                 = "%UserFilesPath%media/";
    TypeConfig[ "Media" ].FilesAbsolutePath         = ( UserFilesAbsolutePath == "" ? "" : "%UserFilesAbsolutePath%media/" );
    TypeConfig[ "Media" ].QuickUploadPath           = "%UserFilesPath%";
    TypeConfig[ "Media" ].QuickUploadAbsolutePath   = ( UserFilesAbsolutePath == "" ? "" : "%UserFilesAbsolutePath%" ); 
```

`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-27T02:24:01.400

我已经切换到使用“ASP”连接器，它工作得很好。出于某种原因，.aspx 连接器在我的生产站点上不起作用（但在开发机器上工作），但 ASP 连接器工作正常。

不是一个“答案”，而是一个有效的解决方法。

# php - PHP 使用 XSLT 生成 Doctype 问题

> ID：912823
> 
> 赞同：0
> 
> 时间：2009-05-26T21:21:08.263
> 
> 标签：php, xml, xslt, doctype

我正在使用 XSLT 将 XHTML 转换为 XHTML，而 Doctype 部分给我带来了问题

```
<?xml version="1.0" encoding="ISO-8859-1"?>
<?xml-stylesheet type="text/xsl" href="LimeSurvey.xslt"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
...
</html> 
```

根据 IE8，FF3，这不是有效的 xml。有什么方法可以防止从 php 引擎生成 DOCType、xmlns 吗？或者有什么方法可以让 XSLT 忽略 DOCTYPE 和 xmlns？

谢谢，埃贝

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-27T16:08:07.867

您需要将 DOCTYPE 插入到 CDATA 块[中，如此处所示。](http://www.dpawson.co.uk/xsl/sect2/N2281.html#d4160e19)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-08-17T02:49:41.807

好的，那是 7 年前，所以现在是 HTML 5：

```
<xsl:output doctype-public="html" /> 
```

给出所需的 html 5 输出...

# asp-classic - 使用 adodb 检索时间戳字段的值 - 如何从经典 asp 中读取字节数组

> ID：912827
> 
> 赞同：0
> 
> 时间：2009-05-26T21:21:50.137
> 
> 标签：asp-classic, binary, timestamp, ado, bytearray

我正在使用 asp 和 adodb，查询数据库（ms sql 2005）

我有一个名为 stamp 的字段，类型为 timestamp

在asp我得到以下

field.ActualSize: 8 field.DefinedSize: field.Name: Stamp field.Type: adBinary (128)

field.Attributes: 528 (adFldFixed (16) + adFldRowVersion (512) ) （所以 adFldLong 没有打开，所以我不能使用 getchunk 方法！） [http://msdn.microsoft.com/en-us/library/ ms676678(VS.85).aspx](http://msdn.microsoft.com/en-us/library/ms676678(VS.85).aspx)

在调试器中，如果我输入 field.value 我会得到以下信息

```
? 字段值
{...}
    (0): 0
    (1): 0
    (2): 0
    (3): 0
    (4): 0
    (5): 35
    (6): 163
    (7): 124

```

这就是我想要得到的！！！！但我不知道该怎么做...

我可以将它分配给一个变量，但我无法获取每个元素

我试过了

```
? cstr（字段.值）
“”

```

```
? 字段值（0）
Número de argumentos erróneo o asignación de propiedad no valida: 'field.value'

```

（参数数量错误）

```
? 变量类型（字段。值）
8209 (8192-vbArray + 17-vbByte)

```

所以，问题是我有一个字节数组，好吧，我怎么读它？？？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-26T22:24:38.310

嗯，我找到了...

[http://www.ureader.com/msg/16755039.aspx](http://www.ureader.com/msg/16755039.aspx)

我不得不使用

h = 十六进制（ascb（midb（barray，c，1）））

将其转换为十六进制...

所以我做了这样的东西

```
    s = ""

    对于 c = lbound( barray ) + 1 到 ubound( barray ) + 1
        h = 十六进制（ascb（midb（barray，c，1）））
        h = padl( h, 2, "0" )
        s = s & h & " "
    下一个

```

# iphone - 如何修复 Cocoa 错误 513？

> ID：912828
> 
> 赞同：6
> 
> 时间：2009-05-26T21:21:54.050
> 
> 标签：iphone, cocoa-touch

我有一个 iPhone 应用程序，其中许多域对象都填充了用户输入的数据。为了在中断后恢复状态，这些对象实现了 NSCoding 协议，并在 applicationWillTerminate 消息中写入磁盘（Documents 目录）。然后，当应用程序再次启动时，数据字节被加载并重新填充域对象。获取文档目录的代码如下：

```
 NSArray *paths = NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES);
NSString *documentsDirectory = [paths objectAtIndex:0]; 
```

这在模拟器中效果很好，但是一旦我将应用程序部署到 iPhone 上它就停止工作了。原因是 iPhone 错误代码 513 - 这显然意味着“权限被拒绝”。iPhone 开发文档中有一条注释解释了更多信息 -

> 在设备上，返回的路径（documentsDirectory）类似于以下内容：/var/mobile/Applications/30B51836-D2DD-43AA-BCB4-9D4DADFED6A2/Documents
> 
> 但是，在模拟器上，返回的路径采用以下形式：
> 
> /Volumes/Stuff/Users/johnDoe/Library/Application Support/iPhone Simulator/User/Applications/118086A0-FAAF-4CD4-9A0F-CD5E8D287270/Documents

这是我看到的确切行为。我不确定这与获取权限被拒绝错误以及我能做些什么来修复它有什么关系。它确实在下面说-

> 要读取和写入用户首选项，请使用 NSUserDefaults 类或 CFPreferences API。这些接口使您无需构建到 Library/Preferences/ 目录的路径并直接读写首选项文件。有关使用这些接口的更多信息，请参阅“添加设置包”。</p>
> 
> 如果您的应用程序在应用程序包中包含声音、图像或其他资源，您应该使用 NSBundle 类或 CFBundle 不透明类型来加载这些资源。Bundles 对资源在应用程序中的位置有固有的了解。此外，捆绑包了解用户的语言偏好，并能够自动选择本地化资源而不是默认资源。有关捆绑包的更多信息，请参阅“应用程序捆绑包”。</p>

不过，我看不到如何使用 Application Bundle 来加载数据字节。有什么帮助或例子吗？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-05-27T18:08:58.670

不确定这是如何工作的，但显然使用 stringByAppendingPathComponent 而不是 stringByAppendingString 来创建路径解决了这个问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-27T04:49:16.327

与应用程序捆绑相关的段落是指：

```
NSString *path = [[NSBundle mainBundle] pathForResource:@"somefile" ofType:@"png"]; 
```

NSBundle 中的这种方法和其他方法允许您从应用程序包中引用资源，而无需实际知道应用程序包的位置。

*免责声明：我没有使用过 iPhone。*

考虑到免责声明，在普通的 OS X 中，在应用程序包中编写东西被认为是不好的形式。您将内容保存在用户的*应用程序支持*目录下 -> 请参阅 NSApplicationSupportDirectory。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-06-27T23:24:30.927

我收到此错误（513），因为路径错误。仔细检查我的路径解决了问题:)

# python - 使用子进程在 Windows 上运行 Python 脚本

> ID：912830
> 
> 赞同：49
> 
> 时间：2009-05-26T21:22:12.897
> 
> 标签：python, windows, subprocess

有没有一种简单的方法可以在 Windows/Linux/OS X 上运行 Python 脚本？

在后两者上`subprocess.Popen("/the/script.py")`有效，但在 Windows 上出现以下错误：

```
Traceback (most recent call last):
  File "test_functional.py", line 91, in test_functional
    log = tvnamerifiy(tmp)
  File "test_functional.py", line 49, in tvnamerifiy
    stdout = PIPE
  File "C:\Python26\lib\subprocess.py", line 595, in __init__
    errread, errwrite)
  File "C:\Python26\lib\subprocess.py", line 804, in _execute_child
    startupinfo)
WindowsError: [Error 193] %1 is not a valid Win32 application 
```

* * *

> *[蒙库特的](https://stackoverflow.com/users/24718/monkut)评论*：用例不清楚。为什么要使用 subprocess 来运行 python 脚本？是否有什么东西阻止您导入脚本并调用必要的函数？

我正在编写一个快速脚本来测试 Python 命令行工具的整体功能（在各种平台上进行测试）。基本上它必须在一个临时文件夹中创建一堆文件，在这个文件夹上运行脚本并检查文件是否被正确重命名。

我本可以导入脚本并调用该函数，但由于它依赖`sys.argv`并使用`sys.exit()`，我需要执行类似..

```
import sys
import tvnamer
sys.argv.append("-b", "/the/folder")
try:
    tvnamer.main()
except BaseException, errormsg:
    print type(errormsg) 
```

另外，我想捕获 stdout 和 stderr 以进行调试，以防出现问题。

当然，更好的方法是以更可单元测试的方式编写脚本，但脚本基本上是“完成”的，我正在做最后一批测试，然后再发布“1.0”版本（之后我要去进行重写/重组，这将更加整洁和可测试）

基本上，在找到`sys.executable`变量后，将脚本作为一个进程简单地运行要容易得多。我会把它写成一个 shell 脚本，但这不会是跨平台的。最终脚本可以在[这里找到](http://github.com/dbr/tvdb_api/blob/c8d7b356cd1a7bb2ab22b510ea74e03a7d27fad6/tests/test_functional.py)

* * *

## 回答 #1

> 赞同：70
> 
> 时间：2009-05-26T21:26:10.983

刚刚找到[`sys.executable`](https://docs.python.org/library/sys.html#sys.executable)- 当前 Python 可执行文件的完整路径，可用于运行脚本（而不是依赖 shbang，这显然不适用于 Windows）

```
import sys
import subprocess

theproc = subprocess.Popen([sys.executable, "myscript.py"])
theproc.communicate() 
```

* * *

## 回答 #2

> 赞同：25
> 
> 时间：2009-06-24T01:48:17.893

这个怎么样：

```
import sys
import subprocess

theproc = subprocess.Popen("myscript.py", shell = True)
theproc.communicate()                   # ^^^^^^^^^^^^ 
```

这告诉`subprocess`使用 OS shell 打开您的脚本，并适用于您可以在 cmd.exe 中运行的任何内容。

此外，这将在 PATH 中搜索“myscript.py”——这可能是可取的。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2011-06-13T10:15:57.697

是`subprocess.Popen(cmd, ..., shell=True)`的，它就像一个魅力。在 Windows 上，`.py`文件扩展名被识别，因此调用 Python 来处理它（在 *NIX 上只是通常的 shebang）。路径环境控制事物是否被看到。所以第一个 arg to`Popen`只是*脚本的名称*。

```
subprocess.Popen(['myscript.py', 'arg1', ...], ..., shell=True) 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-05-26T21:29:03.070

看起来 Windows 尝试使用自己的 EXE 框架运行脚本，而不是像这样调用它

```
python /the/script.py 
```

尝试，

```
subprocess.Popen(["python", "/the/script.py"]) 
```

编辑：“python”需要在你的路径上。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2014-07-15T07:40:06.250

例如，要使用命令提示符或 BATCH 文件执行以下操作，我们可以使用它：

```
C:\Python27\python.exe "C:\Program files(x86)\dev_appserver.py" --host 0.0.0.0 --post 8080 "C:\blabla\" 
```

与 Python 一样，我们可以这样做：

```
subprocess.Popen(['C:/Python27/python.exe', 'C:\\Program files(x86)\\dev_appserver.py', '--host', '0.0.0.0', '--port', '8080', 'C:\\blabla'], shell=True) 
```

或者

```
subprocess.Popen(['C:/Python27/python.exe', 'C:/Program files(x86)/dev_appserver.py', '--host', '0.0.0.0', '--port', '8080', 'C:/blabla'], shell=True) 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-05-27T08:08:52.547

您正在使用依赖于平台的路径名分隔符。Windows 使用“\”，Unix 使用“/”。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-05-26T21:26:41.250

当您在子进程中的 windows 上运行 python 脚本时，您应该在脚本名称前使用 python。尝试：

```
process = subprocess.Popen("python /the/script.py") 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2021-11-19T09:23:04.080

*补充信息*：值得注意的是，`shell=True`如果您使用 dos shell 命令，则文档说明您需要使用`dir`

没有它你会得到这样的东西。

```
>>> import subprocess
>>> subprocess.run(['dir'])
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
  File "C:\Users\foo\AppData\Local\Programs\Python\Python38\lib\subprocess.py", line 489, in run
    with Popen(*popenargs, **kwargs) as process:
  File "C:\Users\foo\AppData\Local\Programs\Python\Python38\lib\subprocess.py", line 854, in __ini
t__
    self._execute_child(args, executable, preexec_fn, close_fds,
  File "C:\Users\foo\AppData\Local\Programs\Python\Python38\lib\subprocess.py", line 1307, in _exe
cute_child
    hp, ht, pid, tid = _winapi.CreateProcess(executable, args,
FileNotFoundError: [WinError 2] The system cannot find the file specified
>>> subprocess.run(['dir'], shell=True)
 Volume in drive J is garbage
 Volume Serial Number is 5EE7-B084 
```

您也可以对最近添加的 args 使用类似路径的对象。

```
from pathlib import Path 
subprocess.run(Path('c:/proj/myfile.bat')) 
```

另外值得注意的是，有一整套[特定于 Windows 的控件](https://docs.python.org/3.8/library/subprocess.html#windows-popen-helpers)，可让您控制进程的生成方式，哪些并发操作可以使用。

所以在windows上控制子进程并不像posix风格那么简单。

# customization - 如何从 StyleCop 规则 SA1600 中排除私人成员

> ID：912831
> 
> 赞同：32
> 
> 时间：2009-05-26T21:22:15.393
> 
> 标签：customization, static-analysis, stylecop

有谁知道如何更改 StyleCop 规则 SA1600，即必须记录元素，以便它仅适用于属性而不适用于私有成员？

我们的 ORM (DevExpress XPO) 要求您拥有所有公共属性的私有成员（因为您必须在 setter 中调用一个函数来将其持久化并将其存储在私有成员中），并评论公共属性和私有考虑到一些表有超过 50 个字段，有同样事情的成员正在杀死我。

* * *

## 回答 #1

> 赞同：48
> 
> 时间：2009-05-27T15:50:52.520

在 Visual Studio 中右键单击您的项目节点，选择 StyleCop 设置。在规则选项卡上，选择文档规则节点。在右侧窗格中，选中 Ignore privates 复选框，然后/或取消选中 Include fields 框。这些中的任何一个都将达到预期的效果。

# networking - 如何连接两个 tcpdump 文件（pcap 文件）

> ID：912843
> 
> 赞同：21
> 
> 时间：2009-05-26T21:24:42.297
> 
> 标签：networking, tcp, wireshark, pcap, tcpdump

如何拼接两个tcpdump文件，让一个流量一个接一个地出现在文件中？具体来说，我想“倍增”一个 tcpdump 文件，以便所有会话将依次重复几次。

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2012-01-18T09:30:48.500

mergecap 可以解决您的问题，但您必须将它与“-a”选项一起使用，否则它会临时重新排序数据包。然后： **mergecap -a file_1.pcap file_1.pcap file_1.cap -w output_file.pcap**

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-05-26T21:42:45.710

正如其他答案所说，您可以在 Wireshark、tcpslice 或 mergecap 中使用 File->Merge。您还可以将文件拖到 Wireshark 的主窗口中。如果 Wireshark/tcpdump/snort/Ntop/etc 支持 pcap-ng，您可以简单地连接您的捕获文件。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-26T21:32:26.120

Wireshark 有 File -> Merge 命令可以执行此操作。

我还记得 mergecap 是一个这样做的工具，但我有一段时间没有使用它了。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-12-06T02:55:27.697

使用 Wireshark 的 mergecap：

合并帽 ... -w output.cap

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2016-08-29T07:44:54.383

要加入多个 pcap，请使用此批处理脚本

所有 pcap 文件必须位于批处理脚本所在的同一文件夹中，并且当您 dir 目录时，第一个 pcap 文件必须命名为 01.pcap，第二个必须命名为 02.pcap，没有其他限制。

```
@echo off
@setlocal enableextensions enabledelayedexpansion

set /a var1=1
set mergecapL="C:\Program Files\Wireshark"

dir /b *.pcap > list.txt
%mergecapL%\mergecap.exe -w %cd%\out%var1%.pcap %cd%\01.pcap %cd%\02.pcap
FOR /F "skip=2 delims=" %%A IN (list.txt) DO (
    set var2=!var1!
    set /a var1+=1
    %mergecapL%\mergecap.exe -w %cd%\out!var1!.pcap %cd%\out!var2!.pcap "%cd%\%%A"
    del out!var2!.pcap
)
del list.txt 
```

* * *

## 回答 #6

> 赞同：-4
> 
> 时间：2011-11-08T18:44:55.780

尝试[pcapjoiner](https://sites.google.com/site/matricview/windowsapps)（商业，演示限制为 1000 个数据包）。

# c++ - C++ 知识产权保护/反逆转

> ID：912850
> 
> 赞同：6
> 
> 时间：2009-05-26T21:26:39.627
> 
> 标签：c++, obfuscation, copy-protection

我在这里看到了很多关于复制保护的讨论。我对防倒车和知识产权保护更感兴趣。

有一些解决方案，如 Safenet 和 HASP，声称可以加密二进制文件，但是当与有效密钥一起使用时，这些解决方案是否可以防止反转？

可以使用哪些策略来混淆代码并摆脱逆向者？有没有像样的商业实现？

我知道大多数保护方案都可以被破解，但这里的目标是延迟逆转相关软件的能力，如果另一家公司试图实施这些方法，它会变得更加明目张胆。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-26T21:59:49.263

> 有一些解决方案，如 Safenet 和 HASP，声称可以加密二进制文件，但是当与有效密钥一起使用时，这些解决方案是否可以防止反转？

不会。专门的逆向工程师可以解密它，因为操作系统必须能够解密它才能运行它。

就个人而言，我不会担心。诚然，我对您的业务一无所知，但在我看来，逆向工程 C++ 与 Java 或 .NET 等语言相比相对困难。这将足以保护除最坚定的攻击者之外的所有攻击者。

然而，一个坚定的攻击者总是能够通过你实现的任何东西，因为在某些时候它必须变成一堆 CPU 指令并执行。你不能阻止他们阅读。

但对于一个不平凡的程序来说，这是一个*很大的努力。*在我看来，更有可能有人在看到你的程序运行后（或者甚至只是从你的营销材料中）创建了一个竞争对手。这可能比尝试逆向工程更容易，并且避免了任何潜在的法律问题。这不是您可以（或应该）阻止的事情。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-05-26T21:31:17.947

雇用一些我多年来共事过的人，他们会完全混淆源代码！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-26T21:37:21.290

读这个

[http://discuss.joelonsoftware.com/default.asp?joel.3.598266.61](http://discuss.joelonsoftware.com/default.asp?joel.3.598266.61)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-26T21:41:16.243

以完全不可能进行逆向工程的方式真正混淆代码几乎是不可能的。

如果有可能，那么计算机病毒将是绝对不可阻挡的，没有人能够知道它们是如何工作的，它们是做什么的。在我们能够运行加密代码之前，加密在某个时刻被解密并“可读”（例如，可以读取机器代码的人），然后才能由 cpu 执行。

现在考虑到这一点，您可以放心地假设廉价的保护将抵御廉价的黑客。像“不好”一样阅读便宜，它与您支付的价格完全无关。伟大的保护将抵御伟大的黑客，但终极保护并不存在。

通常，您的解决方案越商业化，攻击向量就越“知名”。

此外，请注意加密应用程序等内容会带来额外开销并会惹恼用户。USB 加密狗也让用户烦恼，因为他们必须随身携带，而且要花一大笔钱来更换。因此，这也成为您很高兴自己受到保护免受少数黑客攻击和您的所有客户之间的权衡，这些客户将不得不承担您的保护方法所承受的障碍。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-26T21:44:53.833

这有两个主要领域：

1.  混淆 - 通常意味着重命名和剥离符号。有些还可能通过等效的代码转换重新排列代码。可执行打包器通常还采用反调试逻辑。
2.  较低级别的保护 - 这意味着内核或硬件级别的编程。见于 Sony、nProtect、CD/DVD 复制保护等 rootkit。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-26T22:08:40.243

当然，您可以竭尽全力尝试击败/延迟调试器和逆向工程。正如其他人所说，你不会阻止一个坚定的攻击者，期间......一旦你的应用程序被黑客入侵，你可以期望它可以免费在线使用。

您陈述了您想要的保护计划的两个目标：

1）使逆向工程变得困难。2）让它明目张胆地有人在敲诈你。

对于#1，任何混淆器/调试检测器/等方案都会产生至少一些影响。然而，坦率地说，曾经深入研究编译器输出的工程师比例正在减少，这意味着编译后的 C/C++ 代码对许多人来说是混淆了的代码。

对于#2，除非你有一个特定的、受法律保护的算法/过程，否则一旦应用程序被逆向工程，你就会沉没。如果它受到法律保护，您已经发布了受保护的详细信息，那么您想要获得什么？

总的来说，我认为这是一种很难“取胜”的方式，而且你最好在“业务方面”解决这个问题——也就是说，让你的应用成为订阅，或者收取维护/支持费用……但是具体情况显然取决于您的情况。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-07-23T00:54:55.170

您需要设置一个限制，以保护您的代码。查看市场以及您为解决方案收取的费用。您永远不会 100% 保护您的产品，因此您应该评估哪种方法可以为您提供最佳保护。在大多数情况下，一个简单的许可证密钥和没有混淆就足够了。

延迟逆向工程只会“延迟”不可避免的事情。您需要关注的是阻止最初尝试违反版权/IP 的行为。“关于”页面上的良好法律条款和条件通知，或粗体版权通知警告，任何对代码进行逆向工程的尝试都将导致通过脊柱的镐...

如果有机会为他们提供一些法律诉讼，大多数人会放弃试图扯掉一些东西。

We use SafeNet and our clients see it as 'official' protection. That in itself is a good deterrent.

# c# - 列出 NotifyPropertyChanging

> ID：912853
> 
> 赞同：1
> 
> 时间：2009-05-26T21:27:08.317
> 
> 标签：c#, collections

那么 BindingList 和 ObservableCollection 可以很好地保持数据更新并在其中一个对象发生更改时发出通知。但是，当通知某个属性即将更改时，我认为这些选项不是很好。

我现在必须做的是解决这个问题（我警告这一点都不优雅），是在列表的类型对象上实现 INotifyPropertyChanging，然后将其绑定到保存列表 PropertyChanging 事件的对象，或类似以下内容：

```
// this object will be the type of the BindingList
public class SomeObject : INotifyPropertyChanging, INotifyPropertyChanged
{
    private int _intProperty = 0;
    private string _strProperty = String.Empty;

    public int IntProperty
    {
        get { return this._intProperty; }
        set
        {
            if (this._intProperty != value)
            {
                NotifyPropertyChanging("IntProperty");
                this._intProperty = value;
                NotifyPropertyChanged("IntProperty");
            }
        }
    }

    public string StrProperty
    {
        get { return this._strProperty; }
        set
        {
            if (this._strProperty != value)
            {
                NotifyPropertyChanging("StrProperty");
                this._strProperty = value;
                NotifyPropertyChanged("StrProperty");
            }
        }
    }

    #region INotifyPropertyChanging Members

    public event PropertyChangingEventHandler PropertyChanging;

    #endregion

    #region INotifyPropertyChanged Members

    public event PropertyChangedEventHandler PropertyChanged;

    #endregion

    public void NotifyPropertyChanging(string propertyName)
    {
        if (this.PropertyChanging != null)
            PropertyChanging(this, new PropertyChangingEventArgs(propertyName));
    }

    public void NotifyPropertyChanged(string propertyName)
    {
        if (this.PropertyChanged != null)
            PropertyChanged(this, new PropertyChangedEventArgs(propertyName));
    }
}

public class ObjectThatHoldsTheList : INotifyPropertyChanging, INotifyPropertyChanged
{
    public BindingList<SomeObject> BindingList { get; set; }

    public ObjectThatHoldsTheList()
    {
        this.BindingList = new BindingList<SomeObject>();
    }

    // this helps notifie Changing and Changed on Add
    private void AddItem(SomeObject someObject)
    {
        // this will tie the PropertyChanging and PropertyChanged events of SomeObject to this object
        // so it gets notifies because the BindingList does not notify PropertyCHANGING
        someObject.PropertyChanging += new PropertyChangingEventHandler(someObject_PropertyChanging);
        someObject.PropertyChanged += new PropertyChangedEventHandler(someObject_PropertyChanged);

        this.NotifyPropertyChanging("BindingList");
        this.BindingList.Add(someObject);
        this.NotifyPropertyChanged("BindingList");
    }

    // this helps notifies Changing and Changed on Delete
    private void DeleteItem(SomeObject someObject)
    {
        if (this.BindingList.IndexOf(someObject) > 0)
        {
            // this unlinks the handlers so the garbage collector can clear the objects
            someObject.PropertyChanging -= new PropertyChangingEventHandler(someObject_PropertyChanging);
            someObject.PropertyChanged -= new PropertyChangedEventHandler(someObject_PropertyChanged);
        }

        this.NotifyPropertyChanging("BindingList");
        this.BindingList.Remove(someObject);
        this.NotifyPropertyChanged("BindingList");
    }

    // this notifies an item in the list is about to change
    void someObject_PropertyChanging(object sender, PropertyChangingEventArgs e)
    {
        NotifyPropertyChanging("BindingList." + e.PropertyName);
    }

    // this notifies an item in the list has changed
    void someObject_PropertyChanged(object sender, PropertyChangedEventArgs e)
    {
        NotifyPropertyChanged("BindingList." + e.PropertyName);
    }

    #region INotifyPropertyChanging Members

    public event PropertyChangingEventHandler PropertyChanging;

    #endregion

    #region INotifyPropertyChanged Members

    public event PropertyChangedEventHandler PropertyChanged;

    #endregion

    public void NotifyPropertyChanging(string propertyName)
    {
        if (this.PropertyChanging != null)
            PropertyChanging(this, new PropertyChangingEventArgs(propertyName));
    }

    public void NotifyPropertyChanged(string propertyName)
    {
        if (this.PropertyChanged != null)
            PropertyChanged(this, new PropertyChangedEventArgs(propertyName));
    }
} 
```

对不起，我知道这是很多代码，这让我回到了我的主要观点，实现它需要很多代码。所以我的问题是，有人知道更好、更短、更优雅的解决方案吗？

感谢您的时间和建议。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-26T21:45:52.800

您可以创建一个实现 ICustomTypeDescriptor 的包装类。此包装器还将实现必要的接口（例如 INotifyPropertyChanging），拦截对底层对象的属性读取/写入，并且您将能够调用包装器实现的 NotifyPropertyChanging() 和 NotifyPropertyChanged() 方法。数据消费者将使用与使用原始对象相同的包装对象。

但是，如果您不是经验丰富的开发人员，那么实现这样的包装器并不容易。

这是这种包装器的可能*但尚未完成*的实现。它已经支持 INotifyPropertyChanged，并且很容易理解如何实现 INotifyPropertyChanging。

```
public class Wrapper : ICustomTypeDescriptor, INotifyPropertyChanged, IEditableObject, IChangeTracking
{
    private bool _isChanged;

    public object DataSource { get; set; }

    public Wrapper(object dataSource)
    {
        if (dataSource == null)
            throw new ArgumentNullException("dataSource");
        DataSource = dataSource;
    }

    #region ICustomTypeDescriptor Members

    public AttributeCollection GetAttributes()
    {
        return new AttributeCollection(
                DataSource.GetType()
                                    .GetCustomAttributes(true)
                                    .OfType<Attribute>()
                                    .ToArray());
    }

    public string GetClassName()
    {
        return DataSource.GetType().Name;
    }

    public string GetComponentName()
    {
        return DataSource.ToString();
    }

    public TypeConverter GetConverter()
    {
        return new TypeConverter();
    }

    public EventDescriptor GetDefaultEvent()
    {
        return null;
    }

    public PropertyDescriptor GetDefaultProperty()
    {
        return null;
    }

    public object GetEditor(Type editorBaseType)
    {
        return Activator.CreateInstance(editorBaseType);
    }

    public EventDescriptorCollection GetEvents(Attribute[] attributes)
    {
        return TypeDescriptor.GetEvents(DataSource, attributes);
    }

    public EventDescriptorCollection GetEvents()
    {
        return TypeDescriptor.GetEvents(DataSource);
    }

    public PropertyDescriptorCollection GetProperties(Attribute[] attributes)
    {
        return GetProperties();
    }

    private IEnumerable<PropertyDescriptor> _Properties;

    public IEnumerable<PropertyDescriptor> Properties
    {
        get
        {
            if (_Properties == null)
                _Properties = TypeDescriptor.GetProperties(DataSource)
                .Cast<PropertyDescriptor>()
                .Select(pd => new WrapperPropertyDescriptor(pd) as PropertyDescriptor)
                .ToList();
            return _Properties;
        }

    }

    public PropertyDescriptorCollection GetProperties()
    {
        return new PropertyDescriptorCollection(Properties.ToArray());
    }

    public object GetPropertyOwner(PropertyDescriptor pd)
    {
        return this;
    }

    #endregion ICustomTypeDescriptor

    #region ToString, Equals, GetHashCode
    public override string ToString()
    {
        return DataSource.ToString();
    }

    public override bool Equals(object obj)
    {
        var wrapper = obj as Wrapper;
        if (wrapper == null)
            return base.Equals(obj);
        else
            return DataSource.Equals(wrapper.DataSource);
    }

    public override int GetHashCode()
    {
        return DataSource.GetHashCode();
    }
    #endregion

    #region INotifyPropertyChanged
    public event PropertyChangedEventHandler PropertyChanged;

    public void OnPropertyChanged(string propertyName)
    {
        if (String.IsNullOrEmpty(propertyName))
            throw new ArgumentNullException("propertyName");

        _isChanged = true;

        if (PropertyChanged != null)
            PropertyChanged(this, new PropertyChangedEventArgs(propertyName));
    }
    #endregion

    public IDictionary<string, object> MakeDump()
    {
        var result = new Dictionary<String, object>();
        foreach (var item in Properties)
            result[item.Name] = item.GetValue(this);

        return result;
    }

    #region IEditableObject Members

    private IDictionary<string, object> LastDump;

    public void BeginEdit()
    {
        LastDump = MakeDump();
    }

    public void CancelEdit()
    {
        if (LastDump != null)
        {
            foreach (var item in Properties)
                item.SetValue(this, LastDump[item.Name]);
            _isChanged = false;
        }
    }

    public void EndEdit()
    {
        AcceptChanges();
    }

    #endregion IEditableObject

    #region IChangeTracking
    public void AcceptChanges()
    {
        LastDump = null;
        _isChanged = false;
    }

    public bool IsChanged
    {
        get { return _isChanged;  }
    }
    #endregion IChangeTracking
}

public class WrapperPropertyDescriptor : PropertyDescriptor
{
    private Wrapper _wrapper;
    private readonly PropertyDescriptor SourceDescriptor;

    public WrapperPropertyDescriptor(PropertyDescriptor sourceDescriptor) :
        base(sourceDescriptor)
    {
        if (sourceDescriptor == null)
            throw new ArgumentNullException("sourceDescriptor");
        SourceDescriptor = sourceDescriptor;
    }

    public override Type ComponentType
    {
        get
        {
            return SourceDescriptor.ComponentType;
        }
    }

    public override bool IsReadOnly
    {
        get
        {
            return SourceDescriptor.IsReadOnly;
        }
    }

    public override Type PropertyType
    {
        get
        {
            return SourceDescriptor.PropertyType;
        }
    }

    public override object GetValue(object component)
    {
        var wrapper = component as Wrapper;
        if (wrapper == null)
            throw new ArgumentException("Unexpected component", "component");

        var value = SourceDescriptor.GetValue(wrapper.DataSource);
        if (value == null)
            return value;

        var type = value.GetType();

        // If value is user class or structure it should 
        // be wrapped before return.
        if (type.Assembly != typeof(String).Assembly)
        {
            if (typeof(IEnumerable).IsAssignableFrom(type))
                throw new NotImplementedException("Here we should construct and return wrapper for collection");

            if (_wrapper == null) 
                _wrapper = new Wrapper(value);
            else 
                _wrapper.DataSource = value; 

            return _wrapper;
        }

        return value;
    }

    public override void SetValue(object component, object value)
    {
        var wrapper = component as Wrapper;
        if (wrapper == null)
            throw new ArgumentException("Unexpected component", "component");

        var actualValue = value;

        var valueWrapper = value as Wrapper;
        if (valueWrapper != null)
            actualValue = valueWrapper.DataSource;

        // Make dump of data source's previous values
        var dump = wrapper.MakeDump();

        SourceDescriptor.SetValue(wrapper.DataSource, actualValue);

        foreach (var item in wrapper.Properties)
        {
            var itemValue = item.GetValue(wrapper);
            if (!itemValue.Equals(dump[item.Name]))
                wrapper.OnPropertyChanged(item.Name);
        }
    }

    public override void ResetValue(object component)
    {
        var wrapper = component as Wrapper;
        if (wrapper == null)
            throw new ArgumentException("Unexpected component", "component");
        SourceDescriptor.ResetValue(wrapper.DataSource);
    }

    public override bool ShouldSerializeValue(object component)
    {
        var wrapper = component as Wrapper;
        if (wrapper == null)
            throw new ArgumentException("Unexpected component", "component");
        return SourceDescriptor.ShouldSerializeValue(wrapper.DataSource);
    }

    public override bool CanResetValue(object component)
    {
        var wrapper = component as Wrapper;
        if (wrapper == null)
            throw new ArgumentException("Unexpected component", "component");
        return SourceDescriptor.CanResetValue(wrapper.DataSource);
    }
} 
```

同样，这不是一个完整的版本，但它已经可以在简单的场景中使用。可能的用法如下所示：

```
IList<Customer> customers = CustomerRepository.GetAllCustomers();  
IList<Wrapper> wrappedCustomers = customers.Select(c => new Wrapper(c)).ToList();
/* If you don't like LINQ in the line above you can use foreach to transform
list of Customer object to a list of Wrapper<Customer> objects */
comboBoxCustomers.DataSource = wrappedCustomers;
// or
dataGridViewCustomers.DataSource = wrappedCustomers; 
```

因此，只需一行简单的代码，您就拥有一组支持 INotifyPropertyChanged、IEditableObject、IChangeTracking 接口的对象！

祝你好运！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-27T00:00:19.300

这是一个典型的横切关注点的例子，它呼唤着 AOP 方法。[面向方面的编程](http://en.wikipedia.org/wiki/Aspect-oriented_programming)是一种扩展经典 OOP 的范例，让您可以解决诸如“我希望记录此对象上的所有方法调用”之类的问题。

在 .NET 中有几种方法可以做到这一点，这是其中大部分的一个很好的列表：

[http://ayende.com/Blog/archive/2007/07/02/7-Approaches-for-AOP-in-.Net.aspx](http://ayende.com/Blog/archive/2007/07/02/7-Approaches-for-AOP-in-.Net.aspx)

列出的方法之一是 PostSharp，IL 重写器，它可以让您非常轻松地执行 AOP。这是使用此工具实现 INotifyPropertyChanged 的​​示例（我认为 PostSharp 附带了另一个示例）：

[http://thetreeknowseverything.net/2009/01/21/auto-implement-inotifypropertychanged-with-aspects/](http://thetreeknowseverything.net/2009/01/21/auto-implement-inotifypropertychanged-with-aspects/)

# c# - 不变性的真正定义？

> ID：912858
> 
> 赞同：8
> 
> 时间：2009-05-26T21:28:25.847
> 
> 标签：c#, .net, immutability

我想知道如何定义不变性？如果这些值没有公开，所以不能修改，那么就足够了吗？

可以在类型内部修改值，而不是由该类型的客户修改吗？

还是只能将它们设置在构造函数中？如果是这样，在双重初始化的情况下（`this`在结构上使用关键字等）对于不可变类型仍然可以吗？

如何保证类型是 100% 不可变的？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2009-05-26T21:31:29.647

> 如果这些值没有公开，所以不能修改，那么就足够了吗？

不，因为您需要读取权限。

> 可以在类型内部修改值，而不是由该类型的客户修改吗？

不，因为那仍然是突变。

> 还是只能将它们设置在构造函数中？

叮叮叮！另外一点，不可变类型通常具有构造和返回新实例的方法，并且通常还具有`internal`专门标记为供这些方法使用的额外构造函数。

> 如何保证类型是 100% 不可变的？

在 .Net 中，获得这样的保证很棘手，因为您可以使用反射来修改（变异）私有成员。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-05-26T21:36:44.503

之前的海报已经声明你应该在构造函数中为你的字段赋值，然后不要动手。但这有时说起来容易做起来难。假设您的不可变对象公开了 type 的属性`List<string>`。该列表是否允许更改？如果没有，你将如何控制它？

Eric Lippert 在他的博客中写了一系列关于 C# 中的不变性的文章，您可能会觉得有趣：[您可以在这里找到第一部分](http://blogs.msdn.com/ericlippert/archive/2007/11/13/immutability-in-c-part-one-kinds-of-immutability.aspx)。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-05-27T00:35:34.627

我认为在所有这些答案中可能会遗漏的一件事是，我认为即使对象的内部状态发生变化，对象也可以被认为是不可变的——只要这些内部更改对“客户端”代码不可见。

例如，`System.String`该类是不可变的，但我认为允许缓存实例的哈希码，因此仅在第一次调用`GetHashCode()`. 请注意，据我所知，`System.String`该类不*这样*做，但我认为它可以并且仍然被认为是不可变的。当然，这些更改中的任何一个都必须以线程安全的方式处理（与更改的不可观察方面保持一致）。

不过老实说，我想不出很多人可能想要或需要这种“隐形可变性”的原因。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-26T21:32:03.000

这是维基百科中不变性的定义（[链接](http://en.wikipedia.org/wiki/Immutable_object)）

“在面向对象和函数式编程中，不可变对象是在创建后状态无法修改的对象。”

本质上，一旦创建了对象，就不能更改其任何属性。一个例子是 String 类。一旦创建了 String 对象，它就无法更改。对其进行的任何操作实际上都会创建一个新的 String 对象。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-05-26T21:36:04.287

那里有很多问题。我将尝试分别回答每个问题：

*   “我想知道不变性是如何定义的？” - 直接来自[维基百科页面](http://en.wikipedia.org/wiki/Immutable_object)（以及完全准确/简洁的定义）

    > 不可变对象是创建后状态不能修改的对象

*   “如果这些值不公开，所以不能修改，就够了吗？” - 不完全的。它不能以*任何方式*修改，因此您必须确保方法/函数不会改变对象的状态，并且如果执行操作，请始终返回一个新实例。

*   “可以在类型内部修改值，而不是由该类型的客户修改吗？” - 从技术上讲，它不能在内部或由该类型的消费者修改。在实践中，存在诸如`System.String`（事物的引用类型）之类的类型，尽管在理论上不是这样，但对于几乎所有实际目的而言，它们都可以被认为是可变的。

*   “或者只能将它们设置在构造函数中？” - 是的，理论上这是*唯一*可以设置状态（变量）的地方。

*   “如果是这样，在双重初始化的情况下（在结构上使用 this 关键字等）对于不可变类型仍然可以吗？” - 是的，这仍然很好，因为它都是初始化（创建）过程的一部分，并且实例在完成之前不会返回。

*   “我如何保证类型是 100% 不可变的？” - 以下条件应确保这一点。（如果我错过了，请有人指出。）

    1.  不要暴露任何变量。它们都应该保留`private`（甚至`protected`不可接受，因为派生类可以修改状态）。
    2.  不允许任何实例方法修改状态（变量）。这应该只在构造函数中完成，而如果方法需要返回“修改”对象，则应该使用特定的构造函数创建新实例。
    3.  所有公开（只读）的成员或方法返回的对象*本身必须*是不可变的。

    注意：您不能确保派生类型的不变性，因为它们可以定义新变量。这是标记任何您不想确保它不可变的类型的原因，`sealed`以便在代码中的任何地方都不能将派生类视为您的基本不可变类型。

希望有帮助。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-26T21:32:47.663

我了解到，不变性是指您在构造函数中设置了所有内容，并且以后无法在对象的生命周期内对其进行修改。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-05-26T21:33:49.970

不变性的定义可以在[Google](http://www.google.com/search?q=define:%20immutability)上找到。

例子：

> 不可变 - 从字面上看，无法改变。
> www.filosofia.net/materiales/rec/glosaen.htm

就不可变数据结构而言，典型的定义是一次写入多次读取，也就是说，正如你所说，一旦创建，就无法更改。

有些情况稍微处于灰色区域。例如，.NET 字符串被认为是不可变的，因为它们不能更改，但是 StringBuilder 在内部修改了一个 String 对象。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-05-26T21:34:27.520

不可变的本质上是一个类，它在自己的代码中强制自己成为最终的。一旦它在那里，什么都不能改变。据我所知，事情是在构造函数中设置的，然后就是这样。我看不出有什么东西是不可变的。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-05-27T06:06:58.280

不幸的是，c#/vb.net 中没有不可变的关键字，尽管它一直在争论，但是如果没有自动属性并且所有字段都用只读（只读字段只能在构造函数中分配）modfier 声明并且所有字段都声明为一个不可变的类型，你将确保你的自我不变性。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2012-08-14T22:59:33.027

不可变对象是其可观察状态永远不会被任何合理的代码执行序列改变的对象。不可变类型是一种保证暴露给外部世界的任何实例都是不可变的（这个要求通常被声明为要求对象的状态只能在其构造函数中设置；这对于具有私有构造函数，对于在构造过程中调用自身外部方法的对象来说也是不够的）。

然而，其他答案忽略的一点是对象状态的定义。如果`Foo`是一个类，则 a 的状态由其中包含的*对象身份*`List<Foo>`序列组成。如果对特定实例的唯一引用由既不会导致该序列更改，也不会将其暴露给可能这样做的代码的代码持有，那么该实例将是不可变的，无论其中引用的对象是可变的还是不可变的。*`List<Foo>``Foo`*

 *打个比方，如果一个人在防篡改纸上打印了一份汽车 VIN（车辆识别码）列表，那么即使汽车不是，该列表本身也是不可变的。即使列表今天包含 10 辆红色汽车，明天也可能包含 10 辆蓝色汽车；*然而，它们仍然是同样的十辆汽车*。

# iphone - 披露指标消失？

> ID：912860
> 
> 赞同：2
> 
> 时间：2009-05-26T21:28:50.480
> 
> 标签：iphone, cocoa-touch, user-interface

我有一个`UITableView`使用 custom`UITableViewCell`来显示一些信息的。我想`UITableViewCellAccessoryDisclosureIndicator`在单元格中添加一个。

我尝试的每种方法都成功添加了 V 形，但是一旦表格视图向下滚动，它们就会消失。我正在使用标准`dequeueReusableCellWithIdentifier`方法，当我转储对单元格的引用时，它会正确地重新使用它们。所有其他数据都显示正常，只有 V 字形消失了。

我尝试过的事情：

1.  `cell.accessoryType = UITableViewCellAccessoryDisclosureIndicator];`
2.  `[cell setAccessoryType:UITableViewCellAccessoryDisclosureIndicator];`
3.  `accessoryTypeForRowWithIndexPath:`

有人遇到过这种情况吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-26T21:39:16.373

这可能是因为您在缓存单元测试之外设置附件类型：

```
 static NSString *CellIdentifier = @"UIDocumentationCell";
        cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier];
        if (cell == nil) {
            cell = [[[UITableViewCell alloc] initWithFrame:CGRectZero reuseIdentifier:CellIdentifier] autorelease];
        }
cell.accessoryType = UITableViewCellAccessoryDisclosureIndicator;
        [cell setText:mytext]; 
```

更好的方法，恕我直言是这样的：

```
 static NSString *CellIdentifier = @"UIDocumentationCell";
        cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier];
        if (cell == nil) {
            cell = [[[UITableViewCell alloc] initWithFrame:CGRectZero reuseIdentifier:CellIdentifier] autorelease];
cell.accessoryType = UITableViewCellAccessoryDisclosureIndicator;
        }
        [cell setText:mytext]; 
```

Cocoa Touch 似乎不想修改单元格（子视图）的缓存实例，在单元格集方法中设置公开指示符会导致指示符被缓存，并在单元格再次出现时重新绘制。

# http - 发送带有 204 No Content 响应的 Content-Length 或 Transfer-Encoding 的 HTTP 应用程序是否损坏？

> ID：912863
> 
> 赞同：7
> 
> 时间：2009-05-26T21:29:23.083
> 
> 标签：http, networking, rfc2616

我无法从[RFC 2616](http://www.w3.org/Protocols/rfc2616/rfc2616.html)判断 HTTP 客户端是否应该接受包含 Content-Length: 0 或 Transfer-Encoding: 分块标头的 204 No Content 响应。这些标头似乎破坏了一些 HTTP 客户端和代理，它们显然试图读取空的响应正文，但[规范显示](http://www.w3.org/Protocols/rfc2616/rfc2616-sec4.html#sec4.4)：

> 1.  任何“不得”包含消息体的响应消息（例如 1xx、204 和 304 响应以及对 HEAD 请求的任何响应）始终以标头字段之后的第一个空行终止，无论实体如何-消息中存在的标头字段。

对我来说，“无论实体标题字段如何”都意味着客户应该容忍这种情况。[Erlang HTTP 库](http://erlang.org/pipermail/erlang-bugs/2007-November/000504.html)选择了这种解释。然而，[lighthttpd](http://redmine.lighttpd.net/issues/1002)和[IBM](http://www-01.ibm.com/support/docview.wss?rs=180&uid=swg1PK27903)选择了相反的解释——服务器不应该包含这些响应头，因为这些响应被禁止有正文。

那么 Web 应用程序是否应该从响应中删除这些标头，或者网络基础设施和客户端是否应该容忍 204 No Content、304 Not Modified 等的标头？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2015-02-10T12:23:30.687

根据第 29 页末尾的 RFC7230（请参阅[https://www.rfc-editor.org/rfc/rfc7230#section-3.3.1 ），它指出：](https://www.rfc-editor.org/rfc/rfc7230#section-3.3.1)

> 服务器不得在任何状态码为 1xx（信息）或 204（无内容）的响应中发送 Transfer-Encoding 头域。

因此，Web 应用程序不应将这些标头与响应一起发送。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-26T21:42:16.630

我不能告诉你什么是正确的，因为我不知道 HTTP 协议的细节。

但是，您必须问自己：

1.  我可以更改我的应用程序以删除这些标头吗？
2.  或者我可以更改我的应用程序的消费者以忽略这些标头吗？

在我看来，在这种情况下，应用程序不应该发送这些标头。

# c# - 检查非数组变量时“索引超出数组范围”

> ID：912874
> 
> 赞同：0
> 
> 时间：2009-05-26T21:31:32.283
> 
> 标签：c#

我有一个具有以下检查的“地址”类：

```
if(thisAddress == null)
   thisAddress = new Address(); 
```

运行代码时，我在第一行得到“索引超出数组范围”。如果我删除 IF 语句，我会在第二行得到错误。

该类来自Linq to SQL，但我已对其进行了扩展。这以前有效，我不确定为什么它突然开始发生。thisAddress 是 UserControl 中的私有变量。

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-26T21:34:20.907

代码与二进制文件不同步。
尝试重新编译包含用户控件的程序集。

数据库中是否有任何您认为会破坏 LINQ 到 SQL 映射的更改？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-26T21:46:27.277

通常 linq 语句是延迟执行的，或者在使用它们时而不是在您编写链接时执行。因此，完全有可能在 If 语句后面执行的代码实际上是错误所在。

如果是这种情况，那么您可以尝试单步执行该语句（它可能在 thisAddress 类上使用相等性检查）并且调试器应该向您显示正在执行的 linq。

另一种方法也是我最常使用的方法是将调试器设置为在抛出异常而不是未处理异常时中断，这是跟踪此类问题的一种很好的方法。（在 VS 中抛出时，调试器/异常会打勾）。

希望有帮助

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-26T22:06:50.607

弄清楚了。显然我遗漏了一条重要信息。代码位于控件属性的 get {} 部分中。错误是代码中的另一行（我使用的是 split()），但调试器指向 get{} 语句的第一行。

# c# - 使用 C# winforms 在 Windows 中与其他桌面应用程序交互

> ID：912879
> 
> 赞同：6
> 
> 时间：2009-05-26T21:32:57.227
> 
> 标签：c#, windows, winapi, desktop-application, interaction

我想知道是否可以通过我的程序与其他程序进行交互。例如，单击另一个程序上的按钮等。我不确定这是否可能，但是否有人可以在 C# 中提供一些示例代码。

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-26T21:42:13.073

您可以创建消息并将消息发送到其他进程。为此，您必须从 C# 代码中使用 P/Invoke。

[这](http://social.msdn.microsoft.com/forums/en-US/winforms/thread/345d85e8-cc5f-4508-b3f2-74ee43521169/)是一些应该为您指明正确方向的代码。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-26T22:03:03.140

您可以使用[UI 自动化](http://en.wikipedia.org/wiki/Microsoft_UI_Automation)与其他应用程序进行交互。

# sql-server - 如何跨多个 Sql Server 实例进行联合？

> ID：912882
> 
> 赞同：2
> 
> 时间：2009-05-26T21:33:18.943
> 
> 标签：sql-server

我有两个结构相同的 Sql Server（两个不同的数据库，（即两台机器））。有没有办法执行 SELECT * FROM (SELECT * FROM TableOnServerA Union SELECT * FROM TableOnServerB)？

谢谢

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-26T21:36:10.607

是的，只需将它们设置为[链接服务器](http://msdn.microsoft.com/en-us/library/ms188279.aspx)，然后以以下形式完全限定名称`LinkName.DatabaseName.SchemaName(dbo).TableName`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-26T21:36:09.297

```
SELECT * FROM serverA.database.owner.TableName
Union 
SELECT * FROM serverB.database.owner.Tablename 
```

假设它们被设置为链接服务器，请在线使用书籍并转到“链接”

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-26T21:43:11.840

[您可以通过sp_addlinkedserver](http://msdn.microsoft.com/en-us/library/ms190479.aspx)存储过程运行与添加一台计算机的两台不同计算机相关的查询。您在要执行查询的数据库服务器实例中运行它（或者如果您想在任何服务器中执行查询，则在两者上运行），如下所示

```
use master
go
exec sp_addlinkedserver 
@server='AnotherServer',
@provider='SQL Server' 
```

你可以运行

select * from AnotherServer.database.dbo.table t1 join database.dbo.table t2 on (t1.id = t2.id)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-26T21:44:04.740

顺便说一句，如果它们位于两台不同的服务器上，并且您确定数据没有重复，请使用 union all，它会快得多。也永远不要使用 select *，指定字段名称。否则，如果有人将列添加到 A 而不是 B（或重新排列 B 中的列而不是 A），它将中断相同的 ID 号，但附加到不同的数据（如果您使用自动生成的 ID，可能会发生这种情况）。这可以省去无穷无尽的麻烦。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-26T21:36:52.647

您可以创建链接服务器或使用 OPENROWSET 连接到其他 SQL 数据库。

# c# - IsPostBack 总是返回 false

> ID：912888
> 
> 赞同：4
> 
> 时间：2009-05-26T21:35:07.800
> 
> 标签：c#, asp.net, html

每次我在 PageLoad() 中测试 IsPostBack 时，无论是否存在发布数据，都会返回 false。我的第一反应是检查表单或提交按钮中是否缺少 runat="server" 标记。但是，它们都被添加了，WriteEmail.aspx 页面仍然总是为 IsPostBack 返回 false。我也尝试过使用 IsCrossPagePostBack 代替 IsPostBack。

ListInstructors.aspx：

```
<form runat="server" method="post" action="WriteEmail.aspx">
      ...
      <input type="submit" id="writeEmail" value="Write Email" runat="server" />
</form> 
```

写电子邮件.aspx：

```
protected void Page_Load(object sender, EventArgs e)
{
    if (!IsPostBack)
    {
        Response.Redirect("ListInstructors.aspx");
    }
} 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-05-26T21:38:25.797

**发布！=回发。** 回发是指您回发到*同一*页面。表单上的操作正在发布到*新*页面。

看起来您所做的只是使用 WriteEmail.aspx 页面发送消息，然后返回到您刚才所在的位置。你甚至没有显示一个表单来收集那里的文本。这是一种非常......经典的 ASP 风格......处理事情的方式。

相反，将用于发送消息的代码放在单独的类中，如果需要，将类放在 App_Code 文件夹中。还将提交按钮更改为`<asp:button ... />` 然后您可以将服务器的 Click 事件中的代码调用为您的按钮，并且永远不要离开您的`ListInstructors.aspx`页面。

* * *

回复您的评论：不。来自[MSDN](http://msdn.microsoft.com/en-us/library/system.web.ui.page.iscrosspagepostback.aspx)：

> ...通过将页面 URL 分配给实现 IButtonControl 接口的按钮控件的 PostBackUrl 属性来发出跨页请求。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-26T21:38:43.003

不正确，`IsPostBack`因为表单不是从`WriteEmail.aspx`页面提交的；从同一页面提交表单是导致`PostBack`. 如果您从`WriteEmail.aspx`页面提交表单，它将是`PostBack`; 事实上，它只是一个帖子。

您可能会发现此 MSDN 参考很有用：

[http://msdn.microsoft.com/en-us/library/ms178141.aspx](http://msdn.microsoft.com/en-us/library/ms178141.aspx)

# java - 如何将中断键序列发送到 Java 进程？

> ID：912889
> 
> 赞同：12
> 
> 时间：2009-05-26T21:35:16.707
> 
> 标签：java, process, stream, break, copy-paste

我有一个 Java Process 实例及其关联流的句柄。这是一个控制台程序。我想模拟一个休息序列。在 Windows 上，这是 Ctrl-C。没有本地人这可能吗？

这样做的原因：控制台程序本身就是一个命令行控制台，控制着另一种语言的虚拟机。用户可以从这个控制台程序运行另一个程序。在程序运行时，中断序列将中断底层程序的执行并导致控制台程序进入调试模式。

我们正在对这个控制台调试器进行 Java 包装，以便可以通过 IDE (Eclipse) 驱动它。发送中断序列相当于在 Eclipse 调试器中按“暂停”。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-26T21:45:07.577

您可能想查看[SendSignal](http://www.latenighthacking.com/projects/2003/sendSignal/)。这会将 ctrl-Break 发送到 Java 进程。我假设您的目标是导致堆栈转储，CTRL-C（信号 3 又名 SIGQUIT）将为正在运行的 Java 进程做些什么？

# math - 在 LaTeX 中垂直和水平对齐矩阵

> ID：912893
> 
> 赞同：0
> 
> 时间：2009-05-26T21:35:41.403
> 
> 标签：math, latex, vertical-alignment, alignment

我正在尝试在 LaTeX 中完成此操作：

```
⎡a⎤ ⎡b …  n⎤
⎢⁞⎢ ⎢⁞ ⋱ ⁞⎢
⎣x⎦ ⎣y …  z⎦

      [a  … x] 
```

我能够在一行上获得一个向量 + 一个矩阵，但我不确定如何对齐下面的向量，使其完美地位于大矩阵下方。

这是上面“绘图”的较少 unicode 文本表示：

```
[a] [ b c ]
[d] [ e f ]
    [ g h ] 
```

请注意，最后一行 ([ gh ]) 是一个单行矩阵，与上面的 2x2 矩阵分开。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-26T21:42:13.823

如果一切都失败了，[PGF/TikZ](http://www.ctan.org/tex-archive/help/Catalogue/entries/pgf.html)可以做到这一点。请参阅[此示例](http://www.texample.net/tikz/examples/matrix-multiplication/)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-26T21:42:47.597

将东西包裹起来`\begin{align*} ... \end{align*}`并`&`用作公式中的对齐标记。

例子：

```
 `\begin{align*}
        \begin{pmatrix} ... vector here \end{pmatrix}
        &\begin{pmatrix} ... first matrix here \end{pmatrix}\\
        &\begin{pmatrix} ... second matrix here \end{pmatrix}
    \end{align*}` 
```

* * *

 `## 回答 #3

> 赞同：1
> 
> 时间：2009-05-26T22:09:53.300

\edit2
**最终答案：**

```
\begin{align*}
        \begin{vmatrix} 1 \\ 2 \end{vmatrix} &\begin{vmatrix} 1 & 2 & 3 \\ 3 & 4 & 5 \end{vmatrix} \\[6px]
        &\begin{vmatrix} 2 & 3 & 4 \end{vmatrix} 
\end{align*} 
```

完全符合您的要求，请阅读下文以获取有关放置等的更多信息。“&”符号通常用于对齐。忘记了第一行有 2 个矩阵，但现在你有了它:)。

**间距等信息**
\begin{align*} &\begin{pmatrix} 1 & 2 & 3 \ 3 & 4 & 5 \end{pmatrix} \[6px] &\hspace{2px}\begin{pmatrix} 2 & 3 & 4 \end{pmatrix} \end{align*}

会做的工作。出于某种奇怪的原因，在省略第一个“&”符号时对齐会出错，并且它给出了 2px 的偏移量。如果不离开 [6px]，我认为您希望两者之间有一些空间。您始终可以使用**\hspace{amount of whitespace}**将第二个矩阵放置在您想要的位置。这可以在 pt's、px's（我做了）等中给出。

//edit
Hm 我注意到 \hspace{} 实际上不需要，但可以在**pmatrix**的情况下使用。发生的情况是 pmatrix 括号给出了矩阵的有偏差的图像。使用**vmatrix**时，如：

```
\begin{align*}
        &\begin{vmatrix} 1 & 2 & 3 \\ 3 & 4 & 5 \end{vmatrix} \\[6px]
        &\begin{vmatrix} 2 & 3 & 4 \end{vmatrix} 
\end{align*} 
```

一切顺利:)。所以基本上，修复它的最简单方法可能是使用其他括号使其看起来不错，或者使用 \hspace 来对齐你喜欢的。

# java - 当 SQL 进行排序时，如何启用用于排序 JTable 的 GUI 行为？

> ID：912900
> 
> 赞同：1
> 
> 时间：2009-05-26T21:36:56.300
> 
> 标签：java, sql, swing, jdbc, jtable

如何启用 JTable 图标和行为以按列对表行进行排序，而不让它使用比较谓词进行排序？也就是说，如何告诉表头在正在使用的列中显示升序/降序排序的箭头，并在排序顺序/列更改时让它调用适当的方法？

我正在尝试创建一个由 SQL 查询或视图支持的（可编辑、可过滤、可排序的）JTable。这些行可能不适合内存，并且可能无法干净地映射到 java 对象，所以我想在 SQL 中进行所有排序/过滤。我已经编写了用于更改查询以适应按列排序、按值过滤和可见列的代码。

`TYPE_SCROLL_SENSITIVE,`为了使用它，我计划使用and编写基于 ResultSet 的 JTableModel `CONCUR_UPDATABLE`，因此对 DB 的更改会传播到 ResultSet。我将定期（每秒几次）强制刷新 ResultSet 中的可见 JTable，因此对数据库的更改对用户可见。用户对表的更改将在验证后传递给可更新的 ResultSet。

我已经稍微了解了排序是如何正常进行的，但大多数实现似乎都依赖于 JTable 创建一个带有 Comparator 谓词的 javax.swing.RowSorter，或者依赖于维护一个在更改时触发事件的排序行列表。所以，我的问题：

**ORM 框架不是这个问题的答案，因为数据不能很好地映射到实体对象。另外，我使用的 DBMS 是 H2。**

**编辑：不幸的是，基于应用比较器或对行对象排序谓词的可排序 JTable 库也不合适。我不相信我能够将所有对象保存在内存中以执行排序。这个问题使我无法使用 SwingX JXTables、GlazedLists 或类似的库。我希望我能，但我不能。时期。**

** 我将处理数千行，可能是数百万行，以及许多列。是的，我确实需要使用 SQL 来进行排序和过滤。**

**问题：（按重要性递减）**

1.  如何显示用于对行进行排序的列的指标？
2.  当左键单击列标题以更改排序顺序时，如何让 JTable 触发适当的事件？
3.  有没有更简单的方法可以在数据库更改时强制 JTable 更新？
4.  是否有一个库可以使这一切变得相当容易（连接数据库查询或视图和 JTables）？
5.  当我设计这样的系统时，我会遇到可怕的、可怕的问题吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-26T21:59:12.667

在回答 1 和 2 时，请查看[SwingX](https://swingx.dev.java.net/)，它已经包含一个带有内置排序（和过滤）的表类。您也许可以适应这一点。

> 当我设计这样的系统时，我会遇到可怕的、可怕的问题吗？

从经验来看，是的。我从事的项目几乎与此完全相同，有人设计了一个据称“神奇地”绑定到数据库表的 JTable。这种将显示逻辑和数据库访问耦合在一起形成了一个可怕的混乱局面，我们完全用反射驱动的表模型和单独的记录 CRUD 操作来替换它。

你说ORM不是答案......

*   如果数据的格式没有改变，那么无论如何都值得考虑。您的“实体”类不需要代表真实世界的实体。

*   如果（我怀疑）您的实体格式发生变化，则可能值得考虑：

    *   一个灵活的基于地图的`Record`类，将记录存储为键值对；

    *   为您的显示逻辑动态构建的表模型，通过查询记录键构建，插入 SwingX 表以免费进行排序和过滤；

    *   一个类似设计的`Repository`类，它将您的数据库访问与表本身分开封装，负责加载和保存`Record`s。这充当了可更新`ResultSet`和视图之间的适配器（尽管我会检查使用`ResultSet`这种方式是否需要在数据可见时打开数据库连接......）。

    这种分离为“显示和排序记录的表”和“管理数据的存储库”意味着：

    *   您可以将表重用于非数据库绑定数据；
    *   您可以在表格以外的其他事物中显示数据库绑定的记录；
    *   你不会因为试图构建和测试这个东西而发疯:)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-27T08:38:36.387

我自己从未使用过它，但[JIDE Data Grids](http://www.jidesoft.com/products/data.htm)提供了一个 DatabaseTableModel，它使用 SQL WHERE 和 ORDER BY 提供过滤和排序支持。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-08T11:28:16.823

您应该能够继承 javax.swing.RowSorter 以创建在数据库中进行排序的行排序器。从 API 文档：

*“RowSorter 实现通常没有与底层模型的一对一映射，但它们可以。例如，如果数据库进行排序，toggleSortOrder 可能会调用数据库（在后台线程上），并覆盖映射方法以返回传入的参数。”*

[http://docs.oracle.com/javase/6/docs/api/javax/swing/RowSorter.html](http://docs.oracle.com/javase/6/docs/api/javax/swing/RowSorter.html)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-26T22:08:52.630

撇开数据库的东西不谈，有一个名为[SortableTable](http://www.jidesoft.com/products/grids.htm)的类，它是 JIDE Grids 的一部分。它在表格标题中显示带有一点 ^ 或 v 的排序，并支持按 1 列以上（1v、2v 等）排序。

![替代文字](https://www.jidesoft.com/images/sortabletable.png)

# xml - 使用 xsl 绑定

> ID：912906
> 
> 赞同：1
> 
> 时间：2009-05-26T21:37:52.473
> 
> 标签：xml, xslt, xhtml

我开始认为问题不在于条带代码。不知何故，计数不正确。它可以在xml中吗，我有大约。150 个案例研究节点？或者它可以按照我做for-each和if的顺序吗？

```
<!-- XML -->
<case-studies>

    <case-study>    
        <name>Company A</name>
        <solutionType>Mobility</solutionType>
        <solutionType>Convergence</solutionType>
              <solution category="Business services">Product</solution>     
        <solution category="Business services">Industry</solution>      
        <solution category="#">A-Z</solution>       
        <product>Product 1</product> 
    </case-study>
</case-studies> 
```

我正在尝试创建一个在 for-each 中交替灰色行的表。下面的代码返回一个 eratic 效果。

谢谢

```
 <xsl:sort select="../name" />
    <xsl:if test="@category[. = $solName]">

        <tr>
        <xsl:if test="(position() mod 2 = 1)">
            <xsl:attribute name="bgcolor">#e7e7e7</xsl:attribute>                
        </xsl:if>    

          <td class="cell1">

            <img src="/images/icons/infoWhite.gif" style="margin:3px 3px 0 0px;" id="{../name}" onmouseover="xstooltip_show('{../url}', '{../name}', 0, 10);" onmouseout="xstooltip_hide('{../url}');" />
            <div id="{../url}" class="xstooltip" style="margin:10px 0 0 10px;">
              <div class="floatLeft"><strong>Product(s):</strong></div> 
              <div class="margLeft10 floatLeft">
                <xsl:for-each select="../product/prodName">     
                    <div class="clearRight"><xsl:value-of select="."/></div>
                </xsl:for-each>             
                </div>
            </div> 
          </td> 
          <td class="cell2" style="padding-top:2px;">» <a href="{../url}"><xsl:value-of select="../name"/></a></td>
          <td class="cell3">
            <xsl:for-each select="../solutionType">         
                <div class="clearRight"><xsl:value-of select="."/></div>
            </xsl:for-each>                
          </td>
        </tr>
    </xsl:if>        
</xsl:for-each> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-26T21:54:58.570

[这可能有效](http://aspadvice.com/blogs/andrewmooney/archive/2005/05/11/2481.aspx)：

```
<xsl:for-each select="NewDataSet/authors">
<xsl:sort select="au_lname"/>

<xsl:if test="position()  mod 2 = 1">
<tr bgcolor="#aaccff">
    <td><xsl:value-of select="au_lname"/></td>
    <td><xsl:value-of select="au_fname"/></td>
    <td><xsl:value-of select="phone"/></td>
</tr>
</xsl:if>

<xsl:if test="position()  mod 2 = 0">
<tr bgcolor="#ffccaa">
    <td><xsl:value-of select="au_lname"/></td>
    <td><xsl:value-of select="au_fname"/></td>
    <td><xsl:value-of select="phone"/></td>
</tr>
</xsl:if>

</xsl:for-each> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-28T08:24:23.530

查看您的 XSLT，它表明您正在迭代 . 这个对吗？

我认为问题在于，当您检查 position() 时，它将考虑所有先前的解决方案元素，而不管先前的元素是否已被条件忽略。

我可以提出两种解决这个问题的可能性。

首先，尝试将对 position() 的测试更改为对匹配先前元素数量的 count()。例如：

```
<xsl:if test="(count(preceding-sibling::solution[@category=$solName]) mod 2 = 0)"> 
```

或者，您可以尝试将@category 上的测试添加到并删除条件。例如：

```
<xsl:for-each select="solution[@category = $solName]">
    <xsl:sort select="../name" />
    <tr>
        <xsl:if test="(position() mod 2 = 1)"> 
```

我希望这是有道理的！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-29T05:48:41.220

问题是您需要使用`xsl:element`get`xsl:attribute`才能正常运行。您不能设置静态元素的属性。您必须获取 xslt 才能为您生成元素。

```
<xsl:sort select="../name" />
  <xsl:if test="@category[. = $solName]">
    <!-- use xsl:element to create an element -->
    <xsl:element name="tr">
      <xsl:if test="position() mod 2 = 1">
        <!-- then xsl:attribute will function as expected -->
        <xsl:attribute name="bgcolor">#e7e7e7</xsl:attribute>
      </xsl:if>

      <!-- snip -->

    </xsl:element>
  </xsl:if>
</xsl:for-each> 
```

我建议您使用类名和 css（背景颜色）而不是内联样式：

```
<xsl:sort select="../name" />
  <xsl:if test="@category[. = $solName]">
    <!-- use xsl:element to create an element -->
    <xsl:element name="tr">
      <xsl:if test="position() mod 2 = 1">
        <!-- then xsl:attribute will function as expected -->
        <xsl:attribute name="class">alternateRow</xsl:attribute>
      </xsl:if>

      <!-- snip -->

    </xsl:element>
  </xsl:if> 
```

示例 CSS（用于我的替代解决方案）：

```
.alternateRow { background-color: #e7e7e7; } 
```

此外，您不需要在测试周围加上括号。如果我有多个测试，为了便于阅读，我将它们括在括号中，但只有一个条件，通常不添加括号。

# c# - 如何将数据绑定到字符串数组？

> ID：912931
> 
> 赞同：0
> 
> 时间：2009-05-26T21:44:12.603
> 
> 标签：c#, asp.net

如何将字符串数组 ( `string[]`) 数据绑定到`dropdownlist`?

它执行`iEnumerable`吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-26T21:45:27.233

是的，是的。所有数组都实现`IEnumerable<T>`，因此是数据绑定的有效数据源。

# c++ - 预处理器忽略

> ID：912946
> 
> 赞同：0
> 
> 时间：2009-05-26T21:50:46.847
> 
> 标签：c++, visual-studio, winapi, c-preprocessor

我正在从 Visual Studio 6 迁移到 Visual Studio 2008，并且我有一个我正在使用的组件的功能，名为`SetDefaultPrinter`.

不幸的是，现在有一个 Windows 库函数，[`SetDefaultPrinter`](http://msdn.microsoft.com/en-us/library/2ccwwdct%28VS.85%29.aspx)同名。与它相关的宏妨碍了我使用我的函数。

这是我必须调用我的函数的解决方法：

```
#undef SetDefaultPrinter
    pNova->SetDefaultPrinter();
#ifdef UNICODE
#define SetDefaultPrinter  SetDefaultPrinterW
#else
#define SetDefaultPrinter  SetDefaultPrinterA
#endif // !UNICODE 
```

有没有更丑陋的方法来解决这个问题？不，我无法控制该外部组件来更改函数的名称。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-26T22:00:01.133

这就是 C++ 添加命名空间的原因；太糟糕了，Windows 定义不能使用它们。

在另一个源模块中，您不包含 windows.h 或任何其他 Windows 包含文件，生成一个存根函数来调用您的冲突函数。

```
void MySetDefaultPrinter(CNova * pNova)
{
    pNova->SetDefaultPrinter();
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-26T21:58:05.007

您可以在外部组件周围使用包装器。这有时被称为[“适配器”模式](http://en.wikipedia.org/wiki/Adapter_pattern)。

```
// header file
class NovaWrapper
{
  Nova *_nova;
  public:
    void setDefaultPrinter();
};

// implementation file - this file does not include windows.h - you need to make sure it
// does not have visibility of the "bad" SetDefaultPrinter macro
void NovaWrapper::setDefaultPrinter()
{
  _nova->SetDefaultPrinter();
} 
```

现在，修改您的客户端代码以使用 NovaWrapper 而不是底层实例。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-27T17:01:44.983

最后，通过简单地交换包含的顺序来解决这个问题。显然，这个组件的开发人员在我之前就意识到了这个问题，所以他们`SetDefaultPrinterA`在`SetDefaultPrinterW`组件中包含了`SetDefaultPrinter`. 因此，如果 windows.h 重命名函数，这不是问题。

# javascript - 在 Javascript 中从外部源导入 JSON 提要

> ID：912947
> 
> 赞同：0
> 
> 时间：2009-05-26T21:50:52.823
> 
> 标签：javascript, jquery, json, curl, file-get-contents

我想使用 Javascript 从外部源加载 JSON 提要；最好的方法是什么？我在 PHP 中做了很多工作，使用 file_get_contents 或 cURL 很容易做到这一点。Javascript中是否有相关的功能或过程？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-27T02:38:22.367

获取一些 JSON 数据的 jQuery 可能如下所示：

```
$.getJSON("http://pathtodata.js", function(json){
  alert(json.dot.notation);
}); 
```

源与回调函数一起指定。阅读 jQuery JSON 文档： [http ://api.jquery.com/jQuery.getJSON/](http://api.jquery.com/jQuery.getJSON/)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-26T21:54:21.833

Javascript XMLHTTPRequest 具有同域源策略，因此您将被限制为仅从加载脚本的同一域的 URL 加载数据。JSONP 是解决此问题的一种方法。另一种方法是在您的域上使用代理脚本，它会依次为您执行自己的 HTTP 调用。有关 JSONP 的更多信息，请查看这篇文章：

[http://www.ibm.com/developerworks/library/wa-aj-jsonp1/](http://www.ibm.com/developerworks/library/wa-aj-jsonp1/)

# c# - SqlDataReader - 如何将当前行转换为字典

> ID：912948
> 
> 赞同：33
> 
> 时间：2009-05-26T21:51:12.027
> 
> 标签：c#, sql-server, linq, sqldatareader

有没有一种简单的方法可以将 SqlDataReader 的当前行的所有列转换为字典？

```
using (SqlDataReader opReader = command.ExecuteReader())
{
// Convert the current row to a dictionary
} 
```

谢谢

* * *

## 回答 #1

> 赞同：72
> 
> 时间：2010-11-26T14:23:36.330

You can use LINQ:

```
return Enumerable.Range(0, reader.FieldCount)
                 .ToDictionary(reader.GetName, reader.GetValue); 
```

* * *

## 回答 #2

> 赞同：28
> 
> 时间：2009-05-26T21:56:39.923

比这更容易吗？：

```
// Need to read the row in, usually in a while ( opReader.Read ) {} loop...
opReader.Read();

// Convert current row into a dictionary
Dictionary<string, object> dict = new Dictionary<string, object>();
for( int lp = 0 ; lp < opReader.FieldCount ; lp++ ) {
    dict.Add(opReader.GetName(lp), opReader.GetValue(lp));
} 
```

我仍然不确定为什么您需要从一种类型的集合到另一种类型的这种特殊转换。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2016-03-09T19:26:45.183

I came across this question on 3/9/2016 and ended up using the answer provided by SLaks. However, I needed to slightly modify it to:

```
dataRowDictionary = Enumerable.Range(0, reader.FieldCount).ToDictionary(i => reader.GetName(i), i=> reader.GetValue(i).ToString()); 
```

I found guidance from this StackOverflow question: [convert dataReader to Dictionary](https://stackoverflow.com/questions/11842651/convert-datareader-to-dictionary)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-26T22:00:37.157

它已经是一个`IDataRecord`.

这应该为您提供与字典几乎相同的访问权限（按键）。由于行通常不会超过几列，因此查找的性能应该没有那么不同。唯一重要的区别是“有效负载”的类型，即使在那里你的字典也必须使用对象作为值类型，所以我给 IDataRecord 的优势。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-26T21:59:30.043

GetValues 方法接受并放入一维数组中的所有值。
这有帮助吗？

# ssis - 在 SQL 作业中作为步骤调用时 SSIS 包未运行

> ID：912950
> 
> 赞同：3
> 
> 时间：2009-05-26T21:51:35.160
> 
> 标签：ssis, permissions, sql-server-agent

我有一个 .dtsx 文件（一个 SSIS 包），它从 FTP 服务器下载文件并导入数据。每当我手动运行它时它运行良好。但是，当我计划调用包作为 SQL Server 代理作业中的一个步骤时，它会失败。它失败的步骤是我调用 .bat 文件的步骤。作业历史查看器中的错误说明如下：

> 错误：2009-05-26 12:52:25.64
> 代码：0xC0029151 来源：执行批处理文件执行进程任务
> 描述：在执行“D:\xxx\import.bat”“”中“”，进程退出代码为“1 ”，而预期为“0”。结束错误 DTExec：包执行返回 DTSER_FAILURE (1)。

我认为这是一个权限问题，但我不知道如何解决这个问题。作业所有者是管理员用户，因此我已验证他们有权访问 .bat 文件所在的目录。我已经尝试进入服务并更改 SQL Server 代理的“登录身份”选项，但这两个选项都不起作用（本地系统帐户和此帐户）。有没有人知道需要调整哪些其他权限才能使其正常工作？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T14:25:22.787

对我来说，这是一个权限问题。转到环境 --> 目录，然后将本地目录更改为 SQLAgentUser 可以访问的目录。我使用了 C:\temp。单击保存下拉菜单，然后选择“设置默认值”。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-27T01:38:48.947

您是在批处理文件中执行 SSIS 作业，还是批处理文件是 SSIS 控制流中的一个步骤？

我假设后者是这个答案。您使用什么任务来执行批处理文件（例如简单的执行程序任务或脚本任务）。如果是后者，看起来您的批处理文件实际上在某个步骤上失败了，而不是 SSIS 脚本。我会检查你的批处理文件试图访问的权限

事实上，将批处理文件重写为 SSIS 中的脚本任务可能是一个更好的主意，因为您将获得更好的错误报告（它会告诉您脚本中的哪个步骤失败）。

您可以尝试在命令窗口中使用 runas 命令执行批处理文件。如果您尝试在本地系统或网络系统帐户下执行它，它应该会给您一个更好的错误。如果确实出错，您可以通过“echo %ERRORLEVEL%”检查错误级别。

如果不是后者，并且您正在通过批处理文件执行 SSIS 包，为什么？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-28T00:00:51.300

我尝试将批处理文件作为 SQL 作业步骤执行，它提供了更多细节。它表明当我尝试调用可执行文件时失败，该可执行文件与我的 .bat 文件位于同一目录中，但不在执行它的 windows/system32 目录中。

我将可执行文件移动到 system32 目录，但后来我不知道我的文件被下载到哪里。然后我发现Execute Process Task（执行.bat 的那个）有一个名为WorkingDirectory 的属性。我将其设置为 bat 所在的目录，将可执行文件移回与 .bat 文件相同的目录，现在它按预期工作。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-27T01:45:44.610

您是否可能访问 .bat 文件中的映射驱动器？如果是这样，您不能依赖服务中的映射驱动器，因此您必须使用 UNC 路径。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-02-29T07:08:07.013

我遇到了同样的错误，我通过登录到运行该作业的用户帐户来解决它，在那里打开有问题的 Coreftp 站点，测试站点访问，在那里进行更改（在我的情况下，我必须重新输入新密码）现在它可以工作了。所以是的，这是文件访问的问题。这是对相关 coreftp 站点的文件访问。

# wpf - 我必须建立一个 ControlTemplate 吗？还是有替代方案？

> ID：912953
> 
> 赞同：1
> 
> 时间：2009-05-26T21:51:56.923
> 
> 标签：wpf, treeview, controltemplate

我有一个`TreeView`并且想要显示嵌套的数据（不是分层的）。第一级数据被称为`TaskViewModel`，第二级数据是`ArtifactViewModel`。我想要`ArtifactViewModel`a 内的水平线，`GroupBox`它代表`TaskViewModel`. 我尝试了不同的方法，这是我的最后一个：

```
<TreeView Name="tvTasks" ItemsSource="{Binding Tasks}">
    <TreeView.Resources>
        <HierarchicalDataTemplate DataType="{x:Type vm:TaskViewModel}">
            <GroupBox Header="{Binding Name, UpdateSourceTrigger=PropertyChanged}">
                <StackPanel Orientation="Vertical">
                    <ListView ItemsSource="{Binding Children}"/>
                    <TextBlock Text="{Binding Description, UpdateSourceTrigger=PropertyChanged}" TextWrapping="Wrap"/>
                </StackPanel>
            </GroupBox>
        </HierarchicalDataTemplate>
        <DataTemplate DataType="{x:Type vm:ArtifactViewModel}">
            <Border Background="{Binding Type,Converter={StaticResource Type2Background}}"
                    Margin="5" BorderBrush="Black" BorderThickness="2" CornerRadius="2">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="80"/>
                        <RowDefinition Height="20"/>
                    </Grid.RowDefinitions>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="100"/>
                    </Grid.ColumnDefinitions>
                    <TextBlock Text="{Binding Name, UpdateSourceTrigger=PropertyChanged}"
                               TextAlignment="Center" Background="Black" Foreground="White"
                               Opacity="0.75" Grid.Column="0" Grid.Row="1"/>
                </Grid>
            </Border>
        </DataTemplate>                                          
    </TreeView.Resources>
</TreeView> 
```

这看起来很像我想要的，除了`ArtifactViewModel`s 是垂直显示的。如果我点击`ArtifactViewModel`tvTasks.SelectedItem 不会改变，因为`ListView`处理这个事件。我知道这种方法不是最聪明的，但这只是一种尝试。
我看了[这篇文章](http://www.codeproject.com/KB/WPF/CustomTreeViewLayout.aspx)，但我不知道如何处理我想放入的不同对象`TreeView`。那么......我如何构建这样的用户界面？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-29T07:45:59.710

您在这里遇到的主要问题是您嵌套了多个控件，每个控件都有自己的选定项。

如果您打算将数据显示为嵌套但不分层，请不要使用 TreeView。如果您希望在任何给定时间点都可以选择一个项目，请改用 ListBox。

现在棘手的部分是玩弄你想如何布置物品。看看 Bea Stollnitz 的示例[，](http://bea.stollnitz.com/blog/?p=40)她将 ListBox 重绘为 Canvas。您可以在 ItemsPanelTemplate 是 Canvas 的情况下执行类似的操作，然后计算 x,y 坐标。或者，您可以使用 Grid，并确定 Grid.Row 和 Grid.Column 值。

# xslt - XSLT - 如何匹配任何非文本节点子节点？

> ID：912954
> 
> 赞同：1
> 
> 时间：2009-05-26T21:52:04.223
> 
> 标签：xslt, match, children

我是 XSLT 的新手，我不知道如何获得一个 xsl:if 在没有子标签的情况下匹配。

我希望这个匹配：

```
<context>
    howdy
</context> 
```

这不是：

```
<context>
    <child>
        howdy
    </child>
</context> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-26T21:54:41.020

相关的 xpath 表达式应如下所示：

```
//context[not(./*)] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-27T04:56:03.017

您还可以指定 `count(child::*) = 0 .`

# powershell - 如何防止每 1 年或 2 年需要重新签署我的代码？

> ID：912955
> 
> 赞同：13
> 
> 时间：2009-05-26T21:52:06.580
> 
> 标签：powershell, certificate, code-signing, trusted-timestamp

我正在阅读[代码签名证书过期时会发生什么 - 堆栈溢出](https://stackoverflow.com/questions/329396/what-happens-when-a-code-signing-certificate-expires)并想知道一个更可靠的答案。提供的答案更多是关于设置您自己的 CA。即使使用您自己的 CA，您仍然需要处理过期的代码证书。

如果您在未使用时间戳服务的情况下对代码进行了签名，则在证书过期后，您的代码将不再受信任，并且根据安全设置，它可能无法运行。您需要每 1 年或 2 年使用新证书或更新证书重新签署所有代码。

可信（数字）时间戳允许数字签名即使在证书本身过期后仍然有效。仅当您进行了更改时，您才需要使用新证书重新签署代码。

这一切听起来正确吗？如果是这样，我需要关于使用什么时间戳服务的建议，最好是来自实际使用过的人。我还想知道是否有任何内部解决方案，类似于成为您自己的 CA。

现在这适用于 PowerShell 脚本，但我最终会对其他代码有同样的问题。

**更新**：如何使用时间戳签署 PS 脚本的示例（您可以为此制作脚本）：

```
Set-AuthenticodeSignature -filepath "D:\Projects\A Sample\MyFile.ps1" 
  -cert gci cert:\CurrentUser\My -codesigning 
  | where -Filter {$_.FriendlyName -eq "Thawte Code Signing"}
  -IncludeChain All 
  -TimeStampServer "http://timestamp.verisign.com/scripts/timstamp.dll" 
```

然后，要查看签名者证书和时间戳记证书，您可以执行以下操作：

```
Get-AuthenticodeSignature MyFile.ps1 | fl * 
```

它为您的证书和时间戳记的证书提供主题（CN、OU 等）、颁发者、之前/之后日期和指纹。您还会收到一条指示签名状态的消息。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-26T22:00:51.600

您最好选择一个受信任的证书提供商（Verisign、Thawte、Comodo 等）。这允许您在用户不明确信任您的私有根 CA 的情况下签署您的软件。我们使用了 Verisign 和 Thawte，Comodo 甚至 GoDaddy 都带有时间戳，即使在证书过期数年后，软件也不会失效。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-05-27T22:03:57.463

时间戳是一项免费服务——它实际上只是一个受信任的提供商，用于验证您是否在给定时间签署了文件。Verisign 的时间戳服务是标准服务。Set-AuthenticodeSignature 帮助中的最后一个示例演示了如何使用它。

Lee Holmes [MSFT] Windows PowerShell 开发 Microsoft Corporation

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-04-30T16:51:41.547

你无法真正逃避最终不得不辞职的代码。运行您自己的 CA 的优势在于，您可以选择以比默认更长的生命周期颁发代码签名证书，从而允许您等待更长的时间，然后才不得不辞职。缺点当然是要处理另一个服务或服务器（您的 CA）。

# gwt - 如何将 gwt 复合小部件更改事件分组为一个更改事件

> ID：912958
> 
> 赞同：5
> 
> 时间：2009-05-26T21:52:21.260
> 
> 标签：gwt

如果我有一个带有三个文本框（如 SSN）的 GWT 复合小部件，并且只有当整个小部件（而不是单个文本框）失去焦点时，我才需要触发更改事件，该怎么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-27T00:46:27.197

如果您只想要整个小部件失去焦点时的事件（而不是文本框），则将小部件的顶层设置为 FocusPanel，并公开它为您提供的事件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-29T21:48:07.243

你不能用计时器吗？在文本框失去焦点时，启动一个 5 毫秒（或一些小的）计时器，当它命中时，将检查所有 3 个 TextBox 实例的焦点。如果没有焦点，那么您手动通知您的观察者。如果一个人有焦点，什么都不做。

把它放在你的 Composite 类中：

```
private Map<Widget, Boolean> m_hasFocus = new HashMap<Widget, Boolean>(); 
```

然后将其添加到您的每个 TextBox 实例中：

```
new FocusListener() {
  public void onFocus(Widget sender) {
    m_hasFocus.put(sender, Boolean.TRUE);
  }

  public void onLostFocus(Widget sender) {
    m_hasFocus.put(sender, Boolean.FALSE);
    new Timer() {
      public void run() {
        for (Boolean bool : m_hasFocus.values()) {
          if (bool) { return; }
        }
        notifyObservers();
      }
    };
  }
}; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-26T22:06:14.680

你需要在你的组合上实现观察者模式，并且每次触发一个新的通知：

*   焦点在特定文本框上丢失并且
*   焦点未转移到任何其他文本框。

# c# - 检查异常的优缺点是什么？

> ID：912965
> 
> 赞同：12
> 
> 时间：2009-05-26T21:55:24.950
> 
> 标签：c#, java, exception

您喜欢 Java 中的已检查异常处理还是 C# 中的未检查异常处理，为什么？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-05-26T21:57:48.080

嗯。

如果使用得当，受检查的异常是一件好事，但通常它们会导致以下情况：

```
doSomething();
try
{
  somethingThrowsCheckedException();
}
catch(ThatCheckedException)
{ }
doSomethingElse(); 
```

而且，坦率地说，这是错误的。你应该让你不处理的异常冒泡。

**正确**使用已检查的异常可能会很好。但很多时候，正确执行检查异常的结果是这样的方法签名：

```
public void itMightThrow() throws Exception1, Exception2, Exception3, Exception4, // ...
Exception12, Exception13, /* ... */ Exception4499379874
{
  // body
} 
```

我夸大其词了吗？只是轻微。

**编辑：**

也就是说，当涉及到异常处理时，我更喜欢 C# 而不是 Java 的一件事与检查的异常无关（如果我使用 Spec# 无论如何我都可以做到这一点）。不，我喜欢 C# 中的堆栈跟踪在您*抛出*异常时填充，而不是像在 Java 中那样*实例化一个异常时填充。*

**编辑 2：**这是给评论者@Yishai、@Eddie、@Bill K：

首先，您应该查看[此线程](https://stackoverflow.com/questions/531695/how-to-print-the-current-stack-trace-in-net-without-any-exception)以获取有关如何在不实例化异常的情况下获取堆栈跟踪的信息。请记住，遍历堆栈是一个繁重的过程，不应定期进行。

其次，我喜欢在抛出而不是在实例化时填充 C# 的异常堆栈跟踪的*原因是您可以执行以下操作：*

```
private MyException NewException(string message)
{
   MyException e = new MyException(message);
   Logger.LogException(message, e);
   return e;
}

// and elsewhere...
if(mustThrow)
{
   throw NewException("WHOOOOPSIEE!");
} 
```

`NewException`如果没有将方法包含在堆栈跟踪中，这是您在 Java 中无法做到的技巧。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2009-05-26T22:21:49.000

我认为检查异常是一个失败的实验。异常的最初目标是消除验证每个函数调用返回的需要，这导致程序[*程序难以阅读，并且可能效率低下，从而阻止程序员发出信号和处理异常。*](http://ieeexplore.ieee.org/iel5/32/35913/01702672.pdf)

虽然在纸面上很好，但在实践中，检查的异常重新引入了同样的问题异常应该首先消除。它们在应用程序层之间添加了紧密耦合。它们使库无法在后续版本中更改其实现。[crausher 发布](http://www.artima.com/intv/handcuffsP.html)的链接详细介绍了这些问题，并且比我以往任何时候都更好地解释了这些问题。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2009-05-26T22:10:04.703

对于您无法提前预测的可能出错的事情，我更喜欢检查异常。例如，IOException 或 SQLException。它告诉程序员他们必须考虑一些不可预测的错误，他们无法编写不会抛出异常的健壮代码，无论他们尝试多少。

太多时候，程序员将检查的异常视为需要处理的语言。它不是（或不会出现在设计良好的 API 中）——这表明操作中存在不可预知的行为，您应该依赖操作的确定性结果，在相同输入的情况下始终以相同的方式工作.

话虽这么说，在实践中，检查异常会遇到两件事：

1.  并非所有用 Java 编写的应用程序都需要这种健壮性。~~关闭检查异常的编译器级别标志会很好 - 尽管当开发人员使用设置关闭检查异常的标志时，这可能会导致 API 滥用检查异常。~~在考虑了这里更好的妥协之后，我目前的想法是编译器警告是这里最好的平衡。如果检查的异常是编译器警告，包括一个编译器警告，如果一个被忽略了几层（所以一个被忽略的事实将被编译到类中），这样调用者至少会知道即使他不能捕获异常'不知道是哪一个，那么那些不关心的人会忽略编译器警告，而那些不知道的人不会，没有任何人被迫编写他们不关心的错误处理代码来编译他们的代码。
2.  引入异常链（1.4 版）的时间太长了。异常链的缺乏导致很多坏习惯很早就养成了，而不是每个人都在做：

    抛出新的 RuntimeException(e);

当他们不知道该怎么做的时候。

此外，已检查的异常是另一个可能出错的 API 设计元素，API 的用户不得不忍受设计缺陷。

编辑：另一个答案指出了促使 C# 设计决定不检查异常的两个问题。在我看来，这两个论点都非常糟糕，所以我认为它们值得解决/平衡。

1.  版本控制。论据是，如果您更改 API 实现并想要添加额外的检查异常，那么您会破坏现有的客户端代码。
2.  可扩展性。在不知不觉中，您有一个抛出 15 个检查异常的方法。

我认为这两个版本都存在一个未解决的问题，即当做出这些评论时，已经接受了将检查异常提升到下一个级别的正确方法是包装一个适合您 API 抽象的不同检查异常. 例如，如果您有一个可以处理 IOException、SQLException 或 XML 相关异常的存储 API，则设计正确的 API 会将这些差异隐藏在一般 PersistanceException 或类似的东西后面。

除了一般的设计指导之外，具体的论点确实导致了很多关于替代方案的问题：

1.  版本控制。因此，开发人员针对您的数据库 API 进行开发，认为他们捕获并处理了相关异常（例如 DatabaseException），然后您决定在下一个版本中添加 NetworkException 以捕获与数据库的网络级通信问题。现在您只是破坏了与现有代码的所有兼容性，编译器甚至不会抱怨它。如果幸运的话，每个人都可以在回归测试中发现它。
2.  可扩展性。在 C# 解决方案中，如果向下三个 API 级别有可能访问易失性资源，则您完全依赖 API 文档，因为编译器不会告诉您这一点。

对于 Web 应用程序来说，这是一个很棒的设计，其中死亡并向用户显示一个不错的错误 500 页面是关于任何人都在做的事情（因为无论如何事务都是由容器处理的）。但并非所有应用程序都考虑到这些要求。

争论最终归结为（无论如何对我来说）：不要担心异常，任何事情都可能出错，只需建立一个包罗万象的东西。

好的。这是检查和未经检查的异常方法之间的核心区别。已检查的异常会提醒程序员注意易变的不可预测的调用。未经检查的异常方法只是假设所有错误条件都属于同一类，它们只是具有不同的名称，并且它们是未经检查的，因此没有人四处捕捉它们。

现在，这些论点在 CLR 级别上确实有价值。我同意所有检查的异常都应该在编译器级别，而不是运行时级别。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2009-05-26T21:59:27.500

我从未使用过 Java，但自从我阅读

*   [为什么 C# 没有异常规范？](http://msdn.microsoft.com/en-us/vcsharp/aa336812.aspx)
*   [Java 需要检查异常吗？](http://www.mindview.net/Etc/Discussions/CheckedExceptions)
*   [检查异常的问题](http://www.artima.com/intv/handcuffs.html)

我很确定我不喜欢检查异常（在当前实现中）。

提到的两个要点如下。

**版本性**

> Anders Hejlsberg：让我们从版本控制开始，因为那里的问题很容易看出。假设我创建了一个方法 foo，它声明它抛出异常 A、B 和 C。在 foo 的第二版中，我想添加一堆功能，现在 foo 可能会抛出异常 D。这对我来说是一个重大变化将 D 添加到该方法的 throws 子句中，因为该方法的现有调用者几乎肯定不会处理该异常。
> 
> 在新版本中向 throws 子句添加新异常会破坏客户端代码。这就像向接口添加方法一样。发布接口后，它实际上是不可变的，因为它的任何实现都可能具有您想要在下一个版本中添加的方法。所以你必须创建一个新界面。与异常类似，您要么必须创建一个名为 foo2 的全新方法来引发更多异常，要么必须在新的 foo 中捕获异常 D，并将 D 转换为 A、B 或 C。

**可扩展性**

> Anders Hejlsberg：可扩展性问题在某种程度上与版本问题有关。在小的，检查的异常是非常诱人的。举个小例子，您可以证明您实际上已经检查到是否捕获了 FileNotFoundException，这不是很好吗？好吧，当您只调用一个 API 时，这很好。当您开始构建与四五个不同子系统通信的大型系统时，麻烦就开始了。每个子系统抛出四到十个异常。现在，每次你走上聚合阶梯时，你都会在你下面有这个指数级的层次结构，你必须处理的异常。你最终不得不声明 40 个你可能抛出的异常。一旦你将它与另一个子系统聚合在一起，你的 throws 子句中就会出现 80 个异常。它只是气球失控。
> 
> 在大的情况下，检查异常变得如此令人讨厌，以至于人们完全规避了该功能。他们要么到处说“抛出异常”；或者——我不能告诉你我看过多少次——他们说，“试试，哒哒哒哒哒，抓住卷发。” 他们认为，“哦，我稍后会回来处理这些空的 catch 子句”，然后他们当然不会这样做。在这些情况下，检查异常实际上大大降低了系统的质量。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-05-27T00:41:34.803

好的，我不打算回复，但这需要很长时间才能关闭，并且在围栏的一侧得到了很多答案，所以我觉得有必要在另一侧权衡。

我支持检查的异常——如果使用得当——并且相信它们是一件好事。我已经多次听到上述所有论点，其中一些反对检查异常的论点有一些优点。但在网上，我认为他们是积极的。在使用 C# 和 Java 编程后，我发现 C# 程序更难以稳定地应对异常。检查异常的好处是 JavaDoc 可以**保证**告诉您可以从该方法中抛出异常。使用 C#，您依靠编码器记住告诉您任何给定方法可能会引发哪些异常，以及该方法调用的任何方法可能会引发哪些异常，等等。

如果你想创建 5-9 的可靠代码，你需要知道你调用的代码会抛出什么异常，这样你就可以推断出什么可以恢复，什么必须导致你放弃你正在做的事情。如果是 C#，您可以这样做，但是在您看到所有可能引发的异常之前，它需要进行大量的试验和错误。或者你只是抓住异常并尽力而为。

Java 和 C# 这两种方法各有利弊。合理的论据可以支持两者，也可以反对两者。同样，在网上，我更喜欢 Java 选择的方法，但是如果我今天要重写 Java，我会更改 API 以将一些已检查的异常更改为运行时异常。Java API 在使用检查异常方面并不一致。正如其他人所说，异常链接作为标准 API 功能和 JVM 的一部分出现的时间太长了。

然而，被检查异常的指控往往落入“懒惰的程序员滥用这种语言特性”的范畴。确实如此。但对于许多语言及其特性来说都是如此。“懒惰的程序员”论点是一个弱论点。

让我们解决不属于“懒惰程序员”桶的主要抱怨：

1.  **版本**性——是的，在你的代码的新版本中抛出一个新的异常会破坏那些盲目地放入你的新 JAR 文件的客户的编译。IMO，这是一件**好事**（只要您有充分的理由进行额外的*检查*例外），因为您的图书馆的客户必须推理他们需要对这种行为改变做些什么。如果一切都未检查，那么您的客户不一定有任何线索（直到发生异常）您的行为已经改变。如果您正在更改代码的行为，那么您的客户必须知道这一点是合理的。您是否曾经更新到 3rd 方库的新版本，却发现它的行为发生了无形的变化，而现在您的程序已损坏？如果您在库中进行破坏性行为更改，*则应该*破坏与使用早期版本库的客户端的自动兼容性。

2.  **可扩展性**- 如果您通过将已检查异常转换为适合您的 API 层的特定已检查（或未检查）异常来正确处理它们，则这不是问题。也就是说，如果你编码正确，这个问题就会消失。这样做，您就可以正确地隐藏您的实现细节，而您的调用者无论如何都不应该关心这些细节。

很多时候，这只是人们的宗教问题，这就是为什么我（不必要地，我知道）恼火的原因。如果你对检查的异常有一种宗教上的厌恶，那没关系。如果您对检查的异常有合理的论据，那没关系。我见过有充分理由的论点（我大多不同意，但仍然......）。但大多数情况下，我看到反对检查异常的不好论点，包括在谈论 Java 1.0 时公平合理的论点，但考虑到现代 Java 版本，这些论点不再适用。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-05-26T21:59:33.147

在实践中，最好使用检查异常处理，因为当您的应用程序在凌晨 2 点开始淹没错误日志并且您接到电话进行一些调试时，它可以提供更详细的信息......

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-05-26T22:13:14.697

在我看来，存在适合检查异常的情况。可能有一些特性可以在 Java 中以不同的方式完成以更好地支持它们。这并非没有困难（例如，在某些情况下，您可能需要检查异常，而在其他情况下则不需要）。当然，Java 也支持未经检查的异常类型。

通常应记录适合检查的异常类型。记录的最佳位置是在代码中。民粹主义的做法就是搞砸它，只考虑幸福的情况。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-26T22:15:15.800

受检查的异常非常好，只要它们是可恢复的，或者由于编程错误（如对 ResultSet 的无效索引访问）而无法恢复。否则，它们往往会通过强制编码器在许多方法签名中声明诸如 IOException 之类的东西而对客户端代码没有任何真正有用的东西，从而污染代码层和 API。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-05-26T22:25:42.283

我认为在大多数情况下，检查异常是浪费时间。它们陷入了诸如 randolpho 提到的反模式或大量创建自定义异常以将您的实现与使用的库分离之类的东西。摆脱这个“功能”可以让你专注于你想做的事情。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-06-26T09:12:13.653

我唯一希望编译器为我检查的是**函数是否抛出异常**。可以抛出什么特定的异常并不重要。问题是，根据我的经验，有很多函数不会抛出任何东西，如果在函数规范中记录了这一点会很好。对于这些功能，您不必担心异常处理。

# algorithm - 非分叉 Web 服务器如何工作？

> ID：912974
> 
> 赞同：9
> 
> 时间：2009-05-26T21:58:50.560
> 
> 标签：algorithm

像 lighttpd 或 nginx 这样的非分叉（又名单线程或`select()`基于 - 的）网络服务器越来越受欢迎。

虽然有大量解释分叉服务器的文档（在不同的详细程度），但非分叉服务器的文档很少。

我正在寻找关于**非分叉网络服务器****如何**工作的**鸟瞰**图。（伪）代码或状态机图，精简到最低限度，会很棒。

 ****我知道以下资源并发现它们很有帮助。

> *   [SELECT() 的世界](http://www.lowtek.com/sockets/select.html)
> *   [thttpd 源代码](http://www.acme.com/software/thttpd)
> *   [Lighttpd 内部状态](http://redmine.lighttpd.net/projects/1/wiki/Docs:InternalHTTPStates)

但是，我对原理感兴趣，而不是实现细节。

具体来说：

*   为什么这种类型的服务器有时被称为非阻塞，而`select()`实际上是阻塞的？

*   处理请求可能需要一些时间。在没有特定侦听器线程或进程的这段时间内，新请求会发生什么情况？请求处理是否以某种方式中断或时间切片？

**编辑：** 据我了解，在处理请求（例如文件读取或 CGI 脚本运行）时，服务器无法接受新连接。这是否意味着如果 CGI 脚本运行 2 秒左右，这样的服务器可能会丢失很多新连接？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-26T22:19:30.660

基本伪代码：

```
setup
while true
    select/poll/kqueue
    with fd needing action do
        read/write fd
        if fd was read and well formed request in buffer
            service request
        other stuff 
```

*   虽然`select()`&friends 阻塞了，但套接字 I/O 并没有阻塞。只有在您有有趣的事情可做时，您才会被阻止。
*   处理单个请求通常涉及从文件（静态资源）或进程（动态资源）读取文件描述符，然后写入套接字。这可以轻松完成而无需保留太多状态。
*   所以`service request`上面通常意味着打开一个文件，将它添加到列表中`select`，并注意从那里读取的内容会输出到某个套接字。适当时用 FastCGI 代替文件。

编辑：

*   不确定其他的，但 nginx 有 2 个进程：一个主进程和一个工作进程。master 进行监听，然后将接受的连接提供给 worker 进行处理。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-26T23:27:04.237

**select() PLUS 非阻塞 I/O**本质上允许您在单个线程（**多路复用**）中管理/响应多个连接，而不是让多个线程/进程分别处理一个套接字。目标是最小化服务器占用空间与连接数的比率。

它是高效的，因为这个单线程利用了达到饱和所需的高级活动套接字连接（因为我们可以对多个文件描述符进行非阻塞 I/O）。

基本原理是确认字节可用、解释它们、然后决定将适当的字节放入输出流中需要很少的时间。实际的 I/O 工作是在不阻塞此服务器线程的情况下处理的。

这种类型的服务器总是通过阻塞 select() 来等待连接。一旦它得到一个，它就会处理连接，然后在无限循环中重新访问 select()。在最简单的情况下，该服务器线程除了设置 I/O 时不会阻塞任何其他时间。

如果有第二个连接进来，它将在下一次服务器到达 select() 时处理。此时，第一个连接可能仍在接收，我们可以开始从同一个服务器线程发送到第二个连接。这是目标。

搜索“[多路复用网络套接字](http://www.google.com/search?ie=UTF-8&q=multiplexing+network+sockets)”以获取更多资源。

或者试试 Stevens, Fenner, Rudoff 的 Unix Network Programming

# unit-testing - Valgrind 自动测试——它们在某处使用过吗？

> ID：912976
> 
> 赞同：3
> 
> 时间：2009-05-26T21:59:19.077
> 
> 标签：unit-testing, profiling, code-analysis, valgrind

你认为基于 valgrind 的工具套件运行一组自动测试有意义吗？您听说过或看到过这样的设置吗？这种设置可以执行哪些自动（不受人类直觉影响）操作？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-26T22:19:31.487

如果您在单元测试或最终构建测试中检查内存问题/错误代码，这将是有意义的。可能有两种方法：

1.  编写一个测试工具，将通过其库使用**valgrind 的 API**，几乎创建了一个自定义前端来替换 valgrind 可执行文件（看起来很头疼）
2.  Valgrind 还可以为 memcheck 输出 XML（ --xml=yes 选项）
3.  使用**Expect** [http://en.wikipedia.org/wiki/Expect](http://en.wikipedia.org/wiki/Expect)自动执行命令行 valgrind 操作并检查输出
4.  编写运行 valgrind 并 grep 输出的 shell 脚本
5.  也许考虑将此功能添加到使用 expect 和 tcl的**DejaGNU 之类的东西中**

也许这些工具可以自动在您的跟踪器中创建错误项目（尽管它可能会很快填满）。

我自己什么都没看到，但作为一个 valgrind 用户，它会很方便。如果你创造了一些很酷的东西，也许可以将它作为一个开源项目启动！

**经过一番谷歌搜索后**编辑我发现**[http://www.redhat.com/f/summitfiles/presentation/June2/Developer%20Tools/Cox,Malcom_Automated%20Testing.pdf](http://www.redhat.com/f/summitfiles/presentation/June2/Developer%20Tools/Cox,Malcom_Automated%20Testing.pdf)**

 **正如我上面建议的那样，这似乎涵盖了使用 DejaGNU 和 Valgrind 进行的自动化测试

**祝你好运！**

# windows - 使用 Ruby 永久（即在注册表中）设置环境变量？

> ID：912982
> 
> 赞同：4
> 
> 时间：2009-05-26T22:00:13.100
> 
> 标签：windows, ruby, registry, environment, win32ole

在 Windows 上，如何使用 Ruby 永久设置环境变量？我知道我需要更改注册表（通过 win32ole 模块？），但在编写注册表脚本方面我是新手。

我知道我可以说为会话`ENV['FOO'] = "c:\bar\baz"`设置环境变量`FOO`。但是，我对全局和永久设置环境变量感兴趣。

我确实找到了 patheditor gem，它非常适合永久更改 Windows `PATH`。但我想设置其他环境变量，例如`JAVA_HOME`.

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-28T03:19:14.283

[过去](https://stackoverflow.com/questions/190168/persisting-an-environment-variable-through-ruby)有一个关于此的问题。基本要点是通过 Win32::Registry 在注册表中设置变量（如 runako 所说）。然后您可以广播 WM_SETTINGCHANGE 消息来更改环境。当然，您也可以在此期间注销/登录，但不是很有用。

注册码：

```
require 'win32/registry.rb'

Win32::Registry::HKEY_CURRENT_USER.open('Environment', Win32::Registry::KEY_WRITE) do |reg|
  reg['ABC'] = '123'
end 
```

WM_SETTINGCHANGE 代码：

```
require 'Win32API'  

    SendMessageTimeout = Win32API.new('user32', 'SendMessageTimeout', 'LLLPLLP', 'L') 
    HWND_BROADCAST = 0xffff
    WM_SETTINGCHANGE = 0x001A
    SMTO_ABORTIFHUNG = 2
    result = 0
    SendMessageTimeout.call(HWND_BROADCAST, WM_SETTINGCHANGE, 0, 'Environment', SMTO_ABORTIFHUNG, 5000, result) 
```

感谢 Alexander Prokofyev[的回答](https://stackoverflow.com/questions/190168/persisting-an-environment-variable-through-ruby/190437#190437)。

另请参阅有关 Windows 环境变量的一般[讨论](http://www.wilsonmar.com/1envvars.htm)，包括如何为整个机器设置它们而不是仅当前用户（在 HKEY_LOCAL_MACHINE\ SYSTEM\ CurrentControlSet\ Control\ Session Manager\ Environment 中）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-26T22:05:20.187

您正在寻找 Win32::Registry ：

[http://www.ruby-doc.org/stdlib/libdoc/Win32API/rdoc/classes/Win32/Registry.html](http://www.ruby-doc.org/stdlib/libdoc/Win32API/rdoc/classes/Win32/Registry.html)

作为参考，这是我找到它的方式：

[http://www.google.com/search?client=safari&rls=en-us&q=ruby+registry&ie=UTF-8&oe=UTF-8](http://www.google.com/search?client=safari&rls=en-us&q=ruby+registry&ie=UTF-8&oe=UTF-8)

无论如何，你会想要做类似的事情：

```
registry.open("HKEY_WINDOWS_GUNK/path/to/your/key", Win32::Registry::KEY_WRITE) do |reg|
   reg[regentry, Win32::Registry::REG_DWORD]=value
end 
```

如果密钥尚不存在，您可能必须先创建密钥。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-09-21T14:06:49.540

很高兴看到这么全面的答案！

还应注意，在使用 Win32::Registry::KEY_WRITE 和 Win32::Registry 等常量标志创建/写入保留/系统键下的条目时（例如 64 位 Windows 操作系统上的 HKEY_LOCAL_MACHINE\SOFTWARE\Wow6432Node） ::KEY_ALL_ACCESS 不会表现出期望的行为，除非 MRI（Ruby 解释器）实例是从“管理员”内核上下文启动的。通过右键单击可执行文件并选择“以管理员身份运行”来启动 cmd.exe（Windows shell 程序）允许这样做。

# iphone - NSString 到 C 风格的字符数组在第二次调用 drawRect 时崩溃

> ID：912983
> 
> 赞同：0
> 
> 时间：2009-05-26T22:00:18.420
> 
> 标签：iphone, objective-c

我正在尝试使用 Core Graphics 上下文编写文本。我第一次可以做到，没问题，但第二次我的 iPhone 应用程序崩溃了。这是一个代码片段：

```
NSString *name = [MyClass getName];
const char *cname = [name UTF8String];
[self drawText:context text:cname]; 
```

`MyClass`并且`drawText`是自定义类/方法，但你明白了。这三行住在`drawRect:`

第一次`drawRect:`执行，我看到了预期的文本。但是，在drawRect: 的*任何*刷新时，该行：

```
const char *cname = [name UTF8String]; 
```

导致我的应用程序因神秘的`"GDB: Program loaded."`状态消息而崩溃。

即使我使用该`getCString:`方法，我也会得到类似的响应。我想我可能缺少对 NSString 到 char 数组转换的基本理解。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-26T22:05:14.167

最可能的原因是您保留了对先前返回的 char* 的引用，并且您在第二次调用时取消了它的引用。根据规范，指针存储无效：[返回的 C 字符串被自动释放，就像返回的对象将被释放一样；如果需要将 C 字符串存储在创建 C 字符串的自动释放上下文之外，则应该复制它。](http://developer.apple.com/documentation/Cocoa/Reference/Foundation/Classes/NSString_Class/Reference/NSString.html#//apple_ref/occ/instm/NSString/UTF8String)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-26T22:14:15.240

听起来您正在尝试调用已被释放的对象上的方法。该[`UTF8String`](http://developer.apple.com/documentation/Cocoa/Reference/Foundation/Classes/NSString_Class/Reference/NSString.html#//apple_ref/occ/instm/NSString/UTF8String)消息的问题是您无法保留返回的指针，因为在释放字符串时它可能会失效——如果您需要保留该字符串，则必须复制该字符串。不过，`getCString:maxLength:encoding:`不存在这个问题。

确保您遵循正确的内存管理协议。请参阅[Cocoa 的内存管理编程指南](http://developer.apple.com/documentation/Cocoa/Conceptual/MemoryMgmt/MemoryMgmt.html)，并仔细检查您是否在正确的时间向正确的对象发送`retain`、`release`和消息。`autorelease`您可能会发送额外的`release`或`autorelease`不应该发送的，或者您忘记了`retain`某个地方的字符串。

# c# - 使用 C# 修改 XMP 数据

> ID：912985
> 
> 赞同：1
> 
> 时间：2009-05-26T22:00:40.260
> 
> 标签：c#, asp.net, image-processing, xmp

我在 ASP.NET 版本 2 中使用 C#。我正在尝试打开一个图像文件，读取（并更改）XMP 标头，然后再次将其关闭。我无法升级 ASP，所以 WIC 已经失效，我只是不知道如何让它工作。

这是我到目前为止所拥有的：

```
Bitmap bmp = new Bitmap(Server.MapPath(imageFile));

MemoryStream ms = new MemoryStream();

StreamReader sr = new StreamReader(Server.MapPath(imageFile));

*[stuff with find and replace here]*

byte[] data = ToByteArray(sr.ReadToEnd());

ms = new MemoryStream(data);

originalImage = System.Drawing.Image.FromStream(ms); 
```

有什么建议么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-27T06:40:29.520

这种事怎么办？

```
byte[] data = File.ReadAllBytes(path);
... find & replace bit here ...
File.WriteAllBytes(path, data); 
```

另外，我真的建议不要在 asp.net 进程中使用 System.Bitmap，因为它会泄漏内存并且会时不时地崩溃/随机失败（甚至 MS 也承认这一点）

*下面是 MS 关于 System.Drawing.Bitmap 不稳定的原因：*

 *[http://msdn.microsoft.com/en-us/library/system.drawing.aspx](http://msdn.microsoft.com/en-us/library/system.drawing.aspx)* 

*“警告：System.Drawing 命名空间中的类不支持在 Windows 或 ASP.NET 服务中使用。尝试从这些应用程序类型之一中使用这些类可能会产生意外问题，例如降低服务性能和运行时间例外。”*

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-01-19T22:20:20.110

[XMP 规范 2012 的第 1 部分，第 10 页](http://www.adobe.com/devnet/xmp.html)专门讨论了如何在不需要了解周围格式的情况下就地编辑文件（尽管他们确实建议将此作为最后的手段）。嵌入的 XMP 数据包如下所示：

```
<?xpacket begin="■" id="W5M0MpCehiHzreSzNTczkc9d"?>
    ... the serialized XMP as described above: ...
    <x:xmpmeta xmlns:x="adobe:ns:meta/">
    <rdf:RDF xmlns:rdf= ...>
        ...
    </rdf:RDF>
    </x:xmpmeta>
    ... XML whitespace as padding ...
<?xpacket end="w"?> 
```

> 在此示例中，“■”表示用作字节顺序标记的 Unicode“零宽度不间断空格字符”(U+FEFF)。

(XMP Spec 2010, Part 3, Page 12) 还提供了在扫描字节时要查找的特定字节模式（UTF-8、UTF16、大/小端）。这将补充克里斯关于将文件作为巨型字节流读取的答案。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-26T22:20:10.470

您可以使用以下函数来读取/写入二进制数据：

```
 public byte[] GetBinaryData(string path, int bufferSize)
    {
        MemoryStream ms = new MemoryStream();
        using (FileStream fs = File.Open(path, FileMode.Open, FileAccess.Read))
        {
            int bytesRead;
            byte[] buffer = new byte[bufferSize];
            while((bytesRead = fs.Read(buffer,0,bufferSize))>0)
            {
                ms.Write(buffer,0,bytesRead);
            }
        }
        return(ms.ToArray());
    }

    public void SaveBinaryData(string path, byte[] data, int bufferSize)
    {
        using (FileStream fs = File.Open(path, FileMode.Create, FileAccess.Write))
        {
            int totalBytesSaved = 0;
            while (totalBytesSaved<data.Length)
            {
                int remainingBytes = Math.Min(bufferSize, data.Length - totalBytesSaved);
                fs.Write(data, totalBytesSaved, remainingBytes);
                totalBytesSaved += remainingBytes;
            }
        }
    } 
```

但是，将整个图像加载到内存中会占用大量 RAM。我对 XMP 标头了解不多，但如果可能的话，您应该：

*   仅加载内存中的标头
*   操作内存中的标头
*   将标头写入新文件
*   从原始文件中复制剩余数据

# ios - 以编程方式在 iPhone 应用程序上显示键盘

> ID：912987
> 
> 赞同：6
> 
> 时间：2009-05-26T22:01:10.493
> 
> 标签：ios, iphone, cocoa-touch, keyboard

我有一个只有一个 UITextView 用于输入值的视图。我希望当视图显示时，文本视图成为第一响应者（这是最简单的部分），并且默认键盘也会出现。我尝试在 speca 中搜索此内容，但无济于事。有很多关于如何*关闭*键盘的帖子，但我想要的是*显示*键盘而不等待用户触摸我的文本视图。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-05-26T22:19:22.640

只需将文本字段设置为 firstResponder 就可以了。

在你的内部`-viewDidLoad`：

```
[myTextField becomeFirstResponder]; 
```

# c++ - 具有 2 个或 1 个模板参数的同一类

> ID：912993
> 
> 赞同：2
> 
> 时间：2009-05-26T22:04:01.377
> 
> 标签：c++, templates, specialization

如何制作带有 2 个参数而不是普通 1 个参数的模板特化？我正在构建一个指针类，现在我考虑扩展以创建一个数组，但如果我尝试这样的事情：

```
template<class T,int s> class pointer{};
template<class T> class pointer{};

class mama{};
int main(){
    pointer<mama> m;
} 
```

它给了我一个错误。模板...用 1 个参数重新声明。

我需要它是专门的，因为它`pointer<mama,10>`有 size() 和 operator[] 而`pointer<mama>`没有，它有 operator-> 和 *。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-26T22:21:41.263

您可以为数组案例制作一个通用模板：

```
template <class TElem, int size = 0>
class pointer
{
    // stuff to represent an array pointer
}; 
```

然后是部分专业化：

```
template <class TElem>
class pointer<TElem, 0>
{
    // completely different stuff for a non-array pointer
}; 
```

通过为 size=0 的情况定义一个专门的版本，您实际上可以给它一个完全不同的实现，但具有相同的名称。

但是，只是给它一个不同的名称可能会更清楚。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-26T22:17:20.930

您的代码中有类模板重新声明，这将导致编译时错误。您可以有默认模板参数和模板模板参数。

```
template<class T,int s=10> class pointer{};

class mama{};
int main(){
    pointer<mama> m;
} 
```

> 我需要它专门因为指针有 size() 和 operator[] 而指针没有，它有 operator-> 和 *。

看起来好像您需要为您的班级提供不同的设计。我不确定模板专业化是否可行。从您的问题的外观来看，您确实应该考虑基于特征进行专业化。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-26T22:08:54.550

您可以为第二个参数设置一个默认值，可能是这样的：

```
template <class T, int N=0>
class moo {
        T *foo;
public:
        moo() {
                if (N > 0) {
                        foo = new T[N];
                }
                else
                {
                        foo = new T;
                }
        }
}; 
```******`********************`